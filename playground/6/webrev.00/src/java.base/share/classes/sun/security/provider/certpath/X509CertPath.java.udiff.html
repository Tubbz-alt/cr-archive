<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.base/share/classes/sun/security/provider/certpath/X509CertPath.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="CertId.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../rsa/PSSParameters.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/provider/certpath/X509CertPath.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -287,35 +287,29 @@</span>
       * @exception CertificateEncodingException if an exception occurs
       */
      private byte[] encodePKIPATH() throws CertificateEncodingException {
  
          ListIterator&lt;X509Certificate&gt; li = certs.listIterator(certs.size());
<span class="udiff-line-modified-removed">-         try {</span>
<span class="udiff-line-modified-removed">-             DerOutputStream bytes = new DerOutputStream();</span>
<span class="udiff-line-modified-removed">-             // encode certs in reverse order (trust anchor to target)</span>
<span class="udiff-line-modified-removed">-             // according to PkiPath format</span>
<span class="udiff-line-modified-removed">-             while (li.hasPrevious()) {</span>
<span class="udiff-line-modified-removed">-                 X509Certificate cert = li.previous();</span>
<span class="udiff-line-modified-removed">-                 // check for duplicate cert</span>
<span class="udiff-line-modified-removed">-                 if (certs.lastIndexOf(cert) != certs.indexOf(cert)) {</span>
<span class="udiff-line-modified-removed">-                     throw new CertificateEncodingException</span>
<span class="udiff-line-removed">-                         (&quot;Duplicate Certificate&quot;);</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-                 // get encoded certificates</span>
<span class="udiff-line-removed">-                 byte[] encoded = cert.getEncoded();</span>
<span class="udiff-line-removed">-                 bytes.write(encoded);</span>
<span class="udiff-line-modified-added">+         DerOutputStream bytes = new DerOutputStream();</span>
<span class="udiff-line-modified-added">+         // encode certs in reverse order (trust anchor to target)</span>
<span class="udiff-line-modified-added">+         // according to PkiPath format</span>
<span class="udiff-line-modified-added">+         while (li.hasPrevious()) {</span>
<span class="udiff-line-modified-added">+             X509Certificate cert = li.previous();</span>
<span class="udiff-line-modified-added">+             // check for duplicate cert</span>
<span class="udiff-line-modified-added">+             if (certs.lastIndexOf(cert) != certs.indexOf(cert)) {</span>
<span class="udiff-line-modified-added">+                 throw new CertificateEncodingException</span>
<span class="udiff-line-modified-added">+                     (&quot;Duplicate Certificate&quot;);</span>
              }
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-             // Wrap the data in a SEQUENCE</span>
<span class="udiff-line-modified-removed">-             DerOutputStream derout = new DerOutputStream();</span>
<span class="udiff-line-removed">-             derout.write(DerValue.tag_SequenceOf, bytes);</span>
<span class="udiff-line-removed">-             return derout.toByteArray();</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         } catch (IOException ioe) {</span>
<span class="udiff-line-removed">-            throw new CertificateEncodingException(&quot;IOException encoding &quot; +</span>
<span class="udiff-line-removed">-                    &quot;PkiPath data: &quot; + ioe, ioe);</span>
<span class="udiff-line-modified-added">+             // get encoded certificates</span>
<span class="udiff-line-modified-added">+             byte[] encoded = cert.getEncoded();</span>
<span class="udiff-line-modified-added">+             bytes.write(encoded);</span>
          }
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // Wrap the data in a SEQUENCE</span>
<span class="udiff-line-added">+         DerOutputStream derout = new DerOutputStream();</span>
<span class="udiff-line-added">+         derout.write(DerValue.tag_SequenceOf, bytes);</span>
<span class="udiff-line-added">+         return derout.toByteArray();</span>
      }
  
      /**
       * Encode the CertPath using PKCS#7 format.
       *
</pre>
<center><a href="CertId.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../rsa/PSSParameters.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>