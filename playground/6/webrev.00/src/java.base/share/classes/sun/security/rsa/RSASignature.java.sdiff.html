<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/sun/security/rsa/RSASignature.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="PSSParameters.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../timestamp/TSRequest.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/rsa/RSASignature.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
219         } catch (javax.crypto.BadPaddingException e) {
220             // occurs if the app has used the wrong RSA public key
221             // or if sigBytes is invalid
222             // return false rather than propagating the exception for
223             // compatibility/ease of use
224             return false;
225         } catch (IOException e) {
226             throw new SignatureException(&quot;Signature encoding error&quot;, e);
227         } finally {
228             resetDigest();
229         }
230     }
231 
232     /**
233      * Encode the digest, return the to-be-signed data.
234      * Also used by the PKCS#11 provider.
235      */
236     public static byte[] encodeSignature(ObjectIdentifier oid, byte[] digest)
237             throws IOException {
238         DerOutputStream out = new DerOutputStream();
<span class="line-modified">239         new AlgorithmId(oid).encode(out);</span>
240         out.putOctetString(digest);
241         DerValue result =
242             new DerValue(DerValue.tag_Sequence, out.toByteArray());
243         return result.toByteArray();
244     }
245 
246     /**
247      * Decode the signature data. Verify that the object identifier matches
248      * and return the message digest.
249      */
250     public static byte[] decodeSignature(ObjectIdentifier oid, byte[] sig)
251             throws IOException {
252         // Enforce strict DER checking for signatures
253         DerInputStream in = new DerInputStream(sig, 0, sig.length, false);
254         DerValue[] values = in.getSequence(2);
255         if ((values.length != 2) || (in.available() != 0)) {
256             throw new IOException(&quot;SEQUENCE length error&quot;);
257         }
258         AlgorithmId algId = AlgorithmId.parse(values[0]);
259         if (algId.getOID().equals(oid) == false) {
</pre>
</td>
<td>
<hr />
<pre>
219         } catch (javax.crypto.BadPaddingException e) {
220             // occurs if the app has used the wrong RSA public key
221             // or if sigBytes is invalid
222             // return false rather than propagating the exception for
223             // compatibility/ease of use
224             return false;
225         } catch (IOException e) {
226             throw new SignatureException(&quot;Signature encoding error&quot;, e);
227         } finally {
228             resetDigest();
229         }
230     }
231 
232     /**
233      * Encode the digest, return the to-be-signed data.
234      * Also used by the PKCS#11 provider.
235      */
236     public static byte[] encodeSignature(ObjectIdentifier oid, byte[] digest)
237             throws IOException {
238         DerOutputStream out = new DerOutputStream();
<span class="line-modified">239         new AlgorithmId(oid).derEncode(out);</span>
240         out.putOctetString(digest);
241         DerValue result =
242             new DerValue(DerValue.tag_Sequence, out.toByteArray());
243         return result.toByteArray();
244     }
245 
246     /**
247      * Decode the signature data. Verify that the object identifier matches
248      * and return the message digest.
249      */
250     public static byte[] decodeSignature(ObjectIdentifier oid, byte[] sig)
251             throws IOException {
252         // Enforce strict DER checking for signatures
253         DerInputStream in = new DerInputStream(sig, 0, sig.length, false);
254         DerValue[] values = in.getSequence(2);
255         if ((values.length != 2) || (in.available() != 0)) {
256             throw new IOException(&quot;SEQUENCE length error&quot;);
257         }
258         AlgorithmId algId = AlgorithmId.parse(values[0]);
259         if (algId.getOID().equals(oid) == false) {
</pre>
</td>
</tr>
</table>
<center><a href="PSSParameters.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../timestamp/TSRequest.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>