<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/com/sun/crypto/provider/DHPrivateKey.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> <a href="DHPublicKey.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/com/sun/crypto/provider/DHPrivateKey.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 202,50 ***</span>
      /**
       * Get the encoding of the key.
       */
      public synchronized byte[] getEncoded() {
          if (this.encodedKey == null) {
<span class="line-modified">!             try {</span>
<span class="line-removed">-                 DerOutputStream tmp = new DerOutputStream();</span>
  
<span class="line-modified">!                 //</span>
<span class="line-modified">!                 // version</span>
<span class="line-modified">!                 //</span>
<span class="line-modified">!                 tmp.putInteger(PKCS8_VERSION);</span>
<span class="line-removed">- </span>
<span class="line-removed">-                 //</span>
<span class="line-removed">-                 // privateKeyAlgorithm</span>
<span class="line-removed">-                 //</span>
<span class="line-removed">-                 DerOutputStream algid = new DerOutputStream();</span>
  
<span class="line-modified">!                 // store OID</span>
<span class="line-modified">!                 algid.putOID(DHPublicKey.DH_OID);</span>
<span class="line-modified">!                 // encode parameters</span>
<span class="line-modified">!                 DerOutputStream params = new DerOutputStream();</span>
<span class="line-modified">!                 params.putInteger(this.p);</span>
<span class="line-modified">!                 params.putInteger(this.g);</span>
<span class="line-modified">!                 if (this.l != 0) {</span>
<span class="line-modified">!                     params.putInteger(this.l);</span>
<span class="line-modified">!                 }</span>
<span class="line-modified">!                 // wrap parameters into SEQUENCE</span>
<span class="line-modified">!                 DerValue paramSequence = new DerValue(DerValue.tag_Sequence,</span>
<span class="line-modified">!                                                       params.toByteArray());</span>
<span class="line-modified">!                 // store parameter SEQUENCE in algid</span>
<span class="line-modified">!                 algid.putDerValue(paramSequence);</span>
<span class="line-modified">!                 // wrap algid into SEQUENCE</span>
<span class="line-modified">!                 tmp.write(DerValue.tag_Sequence, algid);</span>
  
<span class="line-modified">!                 // privateKey</span>
<span class="line-modified">!                 tmp.putOctetString(this.key);</span>
  
<span class="line-modified">!                 // make it a SEQUENCE</span>
<span class="line-modified">!                 DerOutputStream derKey = new DerOutputStream();</span>
<span class="line-modified">!                 derKey.write(DerValue.tag_Sequence, tmp);</span>
<span class="line-modified">!                 this.encodedKey = derKey.toByteArray();</span>
<span class="line-removed">-             } catch (IOException e) {</span>
<span class="line-removed">-                 return null;</span>
<span class="line-removed">-             }</span>
          }
          return this.encodedKey.clone();
      }
  
      /**
<span class="line-new-header">--- 202,46 ---</span>
      /**
       * Get the encoding of the key.
       */
      public synchronized byte[] getEncoded() {
          if (this.encodedKey == null) {
<span class="line-modified">!             DerOutputStream tmp = new DerOutputStream();</span>
  
<span class="line-modified">!             //</span>
<span class="line-modified">!             // version</span>
<span class="line-modified">!             //</span>
<span class="line-modified">!             tmp.putInteger(PKCS8_VERSION);</span>
  
<span class="line-modified">!             //</span>
<span class="line-modified">!             // privateKeyAlgorithm</span>
<span class="line-modified">!             //</span>
<span class="line-modified">!             DerOutputStream algid = new DerOutputStream();</span>
<span class="line-modified">! </span>
<span class="line-modified">!             // store OID</span>
<span class="line-modified">!             algid.putOID(DHPublicKey.DH_OID);</span>
<span class="line-modified">!             // encode parameters</span>
<span class="line-modified">!             DerOutputStream params = new DerOutputStream();</span>
<span class="line-modified">!             params.putInteger(this.p);</span>
<span class="line-modified">!             params.putInteger(this.g);</span>
<span class="line-modified">!             if (this.l != 0) {</span>
<span class="line-modified">!                 params.putInteger(this.l);</span>
<span class="line-modified">!             }</span>
<span class="line-modified">!             // wrap parameters into SEQUENCE</span>
<span class="line-modified">!             DerValue paramSequence = new DerValue(DerValue.tag_Sequence,</span>
<span class="line-added">+                     params.toByteArray());</span>
<span class="line-added">+             // store parameter SEQUENCE in algid</span>
<span class="line-added">+             algid.putDerValue(paramSequence);</span>
<span class="line-added">+             // wrap algid into SEQUENCE</span>
<span class="line-added">+             tmp.write(DerValue.tag_Sequence, algid);</span>
  
<span class="line-modified">!             // privateKey</span>
<span class="line-modified">!             tmp.putOctetString(this.key);</span>
  
<span class="line-modified">!             // make it a SEQUENCE</span>
<span class="line-modified">!             DerOutputStream derKey = new DerOutputStream();</span>
<span class="line-modified">!             derKey.write(DerValue.tag_Sequence, tmp);</span>
<span class="line-modified">!             this.encodedKey = derKey.toByteArray();</span>
          }
          return this.encodedKey.clone();
      }
  
      /**
</pre>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> <a href="DHPublicKey.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>