<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/sun/security/x509/NameConstraintsExtension.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="IssuingDistributionPointExtension.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="PolicyConstraintsExtension.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/x509/NameConstraintsExtension.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
160     /**
161      * Create the extension from the passed DER encoded value.
162      *
163      * @param critical true if the extension is to be treated as critical.
164      * @param value an array of DER encoded bytes of the actual value.
165      * @exception ClassCastException if value is not an array of bytes
166      * @exception IOException on error.
167      */
168     public NameConstraintsExtension(Boolean critical, Object value)
169     throws IOException {
170         this.extensionId = PKIXExtensions.NameConstraints_Id;
171         this.critical = critical.booleanValue();
172 
173         this.extensionValue = (byte[]) value;
174         DerValue val = new DerValue(this.extensionValue);
175         if (val.tag != DerValue.tag_Sequence) {
176             throw new IOException(&quot;Invalid encoding for&quot; +
177                                   &quot; NameConstraintsExtension.&quot;);
178         }
179 
<span class="line-modified">180         // NB. this is always encoded with the IMPLICIT tag</span>
<span class="line-modified">181         // The checks only make sense if we assume implicit tagging,</span>
<span class="line-modified">182         // with explicit tagging the form is always constructed.</span>
<span class="line-modified">183         // Note that all the fields in NameConstraints are defined as</span>
<span class="line-modified">184         // being OPTIONAL, i.e., there could be an empty SEQUENCE, resulting</span>
<span class="line-modified">185         // in val.data being null.</span>
<span class="line-modified">186         if (val.data == null)</span>
<span class="line-modified">187             return;</span>
<span class="line-modified">188         while (val.data.available() != 0) {</span>
<span class="line-modified">189             DerValue opt = val.data.getDerValue();</span>
<span class="line-removed">190 </span>
<span class="line-removed">191             if (opt.isContextSpecific(TAG_PERMITTED) &amp;&amp; opt.isConstructed()) {</span>
<span class="line-removed">192                 if (permitted != null) {</span>
<span class="line-removed">193                     throw new IOException(&quot;Duplicate permitted &quot; +</span>
<span class="line-removed">194                          &quot;GeneralSubtrees in NameConstraintsExtension.&quot;);</span>
<span class="line-removed">195                 }</span>
<span class="line-removed">196                 opt.resetTag(DerValue.tag_Sequence);</span>
<span class="line-removed">197                 permitted = new GeneralSubtrees(opt);</span>
<span class="line-removed">198 </span>
<span class="line-removed">199             } else if (opt.isContextSpecific(TAG_EXCLUDED) &amp;&amp;</span>
<span class="line-removed">200                        opt.isConstructed()) {</span>
<span class="line-removed">201                 if (excluded != null) {</span>
<span class="line-removed">202                     throw new IOException(&quot;Duplicate excluded &quot; +</span>
<span class="line-removed">203                              &quot;GeneralSubtrees in NameConstraintsExtension.&quot;);</span>
<span class="line-removed">204                 }</span>
<span class="line-removed">205                 opt.resetTag(DerValue.tag_Sequence);</span>
<span class="line-removed">206                 excluded = new GeneralSubtrees(opt);</span>
<span class="line-removed">207             } else</span>
<span class="line-removed">208                 throw new IOException(&quot;Invalid encoding of &quot; +</span>
<span class="line-removed">209                                       &quot;NameConstraintsExtension.&quot;);</span>
210         }



211         minMaxValid = false;
212     }
213 
214     /**
215      * Return the printable string.
216      */
217     public String toString() {
218         StringBuilder sb = new StringBuilder();
219         sb.append(super.toString())
220             .append(&quot;NameConstraints: [&quot;);
221         if (permitted != null) {
222             sb.append(&quot;\n    Permitted:&quot;)
223                 .append(permitted);
224         }
225         if (excluded != null) {
226             sb.append(&quot;\n    Excluded:&quot;)
227                 .append(excluded);
228         }
229         sb.append(&quot;   ]\n&quot;);
230         return sb.toString();
</pre>
</td>
<td>
<hr />
<pre>
160     /**
161      * Create the extension from the passed DER encoded value.
162      *
163      * @param critical true if the extension is to be treated as critical.
164      * @param value an array of DER encoded bytes of the actual value.
165      * @exception ClassCastException if value is not an array of bytes
166      * @exception IOException on error.
167      */
168     public NameConstraintsExtension(Boolean critical, Object value)
169     throws IOException {
170         this.extensionId = PKIXExtensions.NameConstraints_Id;
171         this.critical = critical.booleanValue();
172 
173         this.extensionValue = (byte[]) value;
174         DerValue val = new DerValue(this.extensionValue);
175         if (val.tag != DerValue.tag_Sequence) {
176             throw new IOException(&quot;Invalid encoding for&quot; +
177                                   &quot; NameConstraintsExtension.&quot;);
178         }
179 
<span class="line-modified">180         var v = val.data.getOptionalImplicitContextSpecific(</span>
<span class="line-modified">181                 TAG_PERMITTED, DerValue.tag_Sequence);</span>
<span class="line-modified">182         if (v.isPresent()) {</span>
<span class="line-modified">183             permitted = new GeneralSubtrees(v.get());</span>
<span class="line-modified">184         }</span>
<span class="line-modified">185 </span>
<span class="line-modified">186         v = val.data.getOptionalImplicitContextSpecific(</span>
<span class="line-modified">187                 TAG_EXCLUDED, DerValue.tag_Sequence);</span>
<span class="line-modified">188         if (v.isPresent()) {</span>
<span class="line-modified">189             excluded = new GeneralSubtrees(v.get());</span>




















190         }
<span class="line-added">191 </span>
<span class="line-added">192         val.data.atEnd();</span>
<span class="line-added">193 </span>
194         minMaxValid = false;
195     }
196 
197     /**
198      * Return the printable string.
199      */
200     public String toString() {
201         StringBuilder sb = new StringBuilder();
202         sb.append(super.toString())
203             .append(&quot;NameConstraints: [&quot;);
204         if (permitted != null) {
205             sb.append(&quot;\n    Permitted:&quot;)
206                 .append(permitted);
207         }
208         if (excluded != null) {
209             sb.append(&quot;\n    Excluded:&quot;)
210                 .append(excluded);
211         }
212         sb.append(&quot;   ]\n&quot;);
213         return sb.toString();
</pre>
</td>
</tr>
</table>
<center><a href="IssuingDistributionPointExtension.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="PolicyConstraintsExtension.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>