<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff cli/src/main/java/org/openjdk/skara/cli/pr/GitPrCreate.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../JCheckCLIVisitor.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>cli/src/main/java/org/openjdk/skara/cli/pr/GitPrCreate.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
245 
246             if (closest != null) {
247                 targetBranch = closest.name().substring(remote.length() + 1);
248             } else {
249                 System.err.println(&quot;error: cannot automatically infer target branch&quot;);
250                 System.err.println(&quot;       use --branch to specify target branch&quot;);
251                 System.exit(1);
252             }
253         }
254 
255         var headRef = upstream.isEmpty() ? currentBranch.name() : upstream.get();
256         var commits = repo.commits(targetBranch + &quot;..&quot; + headRef).asList();
257         if (commits.isEmpty()) {
258             System.err.println(&quot;error: no difference between branches &quot; + targetBranch + &quot; and &quot; + headRef);
259             System.err.println(&quot;       Cannot create an empty pull request, have you committed?&quot;);
260             System.exit(1);
261         }
262 
263         var shouldRunJCheck = getSwitch(&quot;jcheck&quot;, &quot;create&quot;, arguments);
264         if (shouldRunJCheck) {
<span class="line-modified">265             var jcheckArgs = new String[]{ &quot;--pull-request&quot;, &quot;--rev&quot;, targetBranch + &quot;..&quot; + headRef };</span>
266             var err = GitJCheck.run(jcheckArgs);
267             if (err != 0) {
268                 System.exit(err);
269             }
270         }
271 
272         var project = jbsProjectFromJcheckConf(repo, targetBranch);
273         var issue = getIssue(currentBranch, project);
274         var file = Files.createTempFile(&quot;PULL_REQUEST_&quot;, &quot;.md&quot;);
275         if (issue.isPresent()) {
276             Files.writeString(file, format(issue.get()) + &quot;\n\n&quot;);
277         } else if (commits.size() == 1) {
278             var commit = commits.get(0);
279             issue = getIssue(commit, project);
280             if (issue.isPresent()) {
281                 Files.writeString(file, format(issue.get()) + &quot;\n\n&quot;);
282             } else {
283                 var message = CommitMessageParsers.v1.parse(commit.message());
284                 Files.writeString(file, message.title() + &quot;\n&quot;);
285                 if (!message.summaries().isEmpty()) {
</pre>
</td>
<td>
<hr />
<pre>
245 
246             if (closest != null) {
247                 targetBranch = closest.name().substring(remote.length() + 1);
248             } else {
249                 System.err.println(&quot;error: cannot automatically infer target branch&quot;);
250                 System.err.println(&quot;       use --branch to specify target branch&quot;);
251                 System.exit(1);
252             }
253         }
254 
255         var headRef = upstream.isEmpty() ? currentBranch.name() : upstream.get();
256         var commits = repo.commits(targetBranch + &quot;..&quot; + headRef).asList();
257         if (commits.isEmpty()) {
258             System.err.println(&quot;error: no difference between branches &quot; + targetBranch + &quot; and &quot; + headRef);
259             System.err.println(&quot;       Cannot create an empty pull request, have you committed?&quot;);
260             System.exit(1);
261         }
262 
263         var shouldRunJCheck = getSwitch(&quot;jcheck&quot;, &quot;create&quot;, arguments);
264         if (shouldRunJCheck) {
<span class="line-modified">265             var jcheckArgs = new String[]{ &quot;--ignore=branches,committer,reviewers,issues&quot;, &quot;--rev&quot;, targetBranch + &quot;..&quot; + headRef };</span>
266             var err = GitJCheck.run(jcheckArgs);
267             if (err != 0) {
268                 System.exit(err);
269             }
270         }
271 
272         var project = jbsProjectFromJcheckConf(repo, targetBranch);
273         var issue = getIssue(currentBranch, project);
274         var file = Files.createTempFile(&quot;PULL_REQUEST_&quot;, &quot;.md&quot;);
275         if (issue.isPresent()) {
276             Files.writeString(file, format(issue.get()) + &quot;\n\n&quot;);
277         } else if (commits.size() == 1) {
278             var commit = commits.get(0);
279             issue = getIssue(commit, project);
280             if (issue.isPresent()) {
281                 Files.writeString(file, format(issue.get()) + &quot;\n\n&quot;);
282             } else {
283                 var message = CommitMessageParsers.v1.parse(commit.message());
284                 Files.writeString(file, message.title() + &quot;\n&quot;);
285                 if (!message.summaries().isEmpty()) {
</pre>
</td>
</tr>
</table>
<center><a href="../JCheckCLIVisitor.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>