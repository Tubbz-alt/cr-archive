<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff bots/mlbridge/src/main/java/org/openjdk/skara/bots/mlbridge/ReviewArchive.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../test/java/org/openjdk/skara/bots/mlbridge/MailingListBridgeBotTests.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>bots/mlbridge/src/main/java/org/openjdk/skara/bots/mlbridge/ReviewArchive.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
167                 generated.add(reply);
168             }
169         }
170 
171         return generated;
172     }
173 
174     private Set&lt;String&gt; sentItemIds(List&lt;Email&gt; sentEmails) {
175         var primary = sentEmails.stream()
176                                 .map(email -&gt; getStableMessageId(email.id()));
177         var collapsed = sentEmails.stream()
178                                   .filter(email -&gt; email.hasHeader(&quot;PR-Collapsed-IDs&quot;))
179                                   .flatMap(email -&gt; Stream.of(email.headerValue(&quot;PR-Collapsed-IDs&quot;).split(&quot; &quot;)));
180         return Stream.concat(primary, collapsed)
181                      .collect(Collectors.toSet());
182     }
183 
184     private String parentAuthorPath(ArchiveItem item) {
185         var ret = new StringBuilder();
186         ret.append(item.author().id());



187         while (item.parent().isPresent()) {
188             item = item.parent().get();
189             ret.append(&quot;.&quot;);
190             ret.append(item.author().id());
191         }
192         return ret.toString();
193     }
194 
195     // Group items that has the same author and the same parent
196     private List&lt;List&lt;ArchiveItem&gt;&gt; collapsableItems(List&lt;ArchiveItem&gt; items) {
197         var grouped = items.stream()
198                            .collect(Collectors.groupingBy(this::parentAuthorPath,
199                                                           LinkedHashMap::new, Collectors.toList()));
200         return new ArrayList&lt;&gt;(grouped.values());
201     }
202 
203     private String quoteBody(String body) {
204         return Arrays.stream(body.strip().split(&quot;\\R&quot;))
205                      .map(line -&gt; line.length() &gt; 0 ? line.charAt(0) == &#39;&gt;&#39; ? &quot;&gt;&quot; + line : &quot;&gt; &quot; + line : &quot;&gt; &quot;)
206                      .collect(Collectors.joining(&quot;\n&quot;));
</pre>
</td>
<td>
<hr />
<pre>
167                 generated.add(reply);
168             }
169         }
170 
171         return generated;
172     }
173 
174     private Set&lt;String&gt; sentItemIds(List&lt;Email&gt; sentEmails) {
175         var primary = sentEmails.stream()
176                                 .map(email -&gt; getStableMessageId(email.id()));
177         var collapsed = sentEmails.stream()
178                                   .filter(email -&gt; email.hasHeader(&quot;PR-Collapsed-IDs&quot;))
179                                   .flatMap(email -&gt; Stream.of(email.headerValue(&quot;PR-Collapsed-IDs&quot;).split(&quot; &quot;)));
180         return Stream.concat(primary, collapsed)
181                      .collect(Collectors.toSet());
182     }
183 
184     private String parentAuthorPath(ArchiveItem item) {
185         var ret = new StringBuilder();
186         ret.append(item.author().id());
<span class="line-added">187         ret.append(&quot;:&quot;);</span>
<span class="line-added">188         ret.append(item.subject());</span>
<span class="line-added">189         ret.append(&quot;:&quot;);</span>
190         while (item.parent().isPresent()) {
191             item = item.parent().get();
192             ret.append(&quot;.&quot;);
193             ret.append(item.author().id());
194         }
195         return ret.toString();
196     }
197 
198     // Group items that has the same author and the same parent
199     private List&lt;List&lt;ArchiveItem&gt;&gt; collapsableItems(List&lt;ArchiveItem&gt; items) {
200         var grouped = items.stream()
201                            .collect(Collectors.groupingBy(this::parentAuthorPath,
202                                                           LinkedHashMap::new, Collectors.toList()));
203         return new ArrayList&lt;&gt;(grouped.values());
204     }
205 
206     private String quoteBody(String body) {
207         return Arrays.stream(body.strip().split(&quot;\\R&quot;))
208                      .map(line -&gt; line.length() &gt; 0 ? line.charAt(0) == &#39;&gt;&#39; ? &quot;&gt;&quot; + line : &quot;&gt; &quot; + line : &quot;&gt; &quot;)
209                      .collect(Collectors.joining(&quot;\n&quot;));
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../test/java/org/openjdk/skara/bots/mlbridge/MailingListBridgeBotTests.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>