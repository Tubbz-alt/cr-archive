<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff cli/src/main/java/org/openjdk/skara/cli/JCheckCLIVisitor.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="GitJCheck.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../jcheck/src/main/java/org/openjdk/skara/jcheck/IssuesCheck.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>cli/src/main/java/org/openjdk/skara/cli/JCheckCLIVisitor.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 31,19 ***</span>
  import java.util.stream.Collectors;
  
  class JCheckCLIVisitor implements IssueVisitor {
      private final Set&lt;String&gt; ignore;
      private final boolean isMercurial;
      private boolean hasDisplayedErrors;
  
      public JCheckCLIVisitor() {
<span class="line-modified">!         this(Set.of(), false);</span>
      }
  
<span class="line-modified">!     public JCheckCLIVisitor(Set&lt;String&gt; ignore, boolean isMercurial) {</span>
          this.ignore = ignore;
          this.isMercurial = isMercurial;
          this.hasDisplayedErrors = false;
      }
  
      private String println(Issue i, String message) {
          var prefix = &quot;[&quot; + i.check().name() + &quot;] &quot; + i.severity() + &quot;: &quot;;
<span class="line-new-header">--- 31,21 ---</span>
  import java.util.stream.Collectors;
  
  class JCheckCLIVisitor implements IssueVisitor {
      private final Set&lt;String&gt; ignore;
      private final boolean isMercurial;
<span class="line-added">+     private final boolean isLax;</span>
      private boolean hasDisplayedErrors;
  
      public JCheckCLIVisitor() {
<span class="line-modified">!         this(Set.of(), false, false);</span>
      }
  
<span class="line-modified">!     public JCheckCLIVisitor(Set&lt;String&gt; ignore, boolean isMercurial, boolean isLax) {</span>
          this.ignore = ignore;
          this.isMercurial = isMercurial;
<span class="line-added">+         this.isLax = isLax;</span>
          this.hasDisplayedErrors = false;
      }
  
      private String println(Issue i, String message) {
          var prefix = &quot;[&quot; + i.check().name() + &quot;] &quot; + i.severity() + &quot;: &quot;;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 74,11 ***</span>
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(TagIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name())) {</span>
              println(i, &quot;illegal tag name: &quot; + i.tag().name());
              hasDisplayedErrors = true;
          }
      }
  
<span class="line-new-header">--- 76,11 ---</span>
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(TagIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name()) &amp;&amp; !isLax) {</span>
              println(i, &quot;illegal tag name: &quot; + i.tag().name());
              hasDisplayedErrors = true;
          }
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 88,18 ***</span>
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(SelfReviewIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name())) {</span>
              println(i, &quot;self-reviews are not allowed&quot;);
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(TooFewReviewersIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name())) {</span>
              var required = i.numRequired();
              var actual = i.numActual();
              var reviewers = required == 1 ? &quot; reviewer&quot; : &quot; reviewers&quot;;
              println(i, required + reviewers + &quot; required, found &quot; + actual);
              hasDisplayedErrors = true;
<span class="line-new-header">--- 90,18 ---</span>
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(SelfReviewIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name()) &amp;&amp; !isLax) {</span>
              println(i, &quot;self-reviews are not allowed&quot;);
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(TooFewReviewersIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name()) &amp;&amp; !isLax) {</span>
              var required = i.numRequired();
              var actual = i.numActual();
              var reviewers = required == 1 ? &quot; reviewer&quot; : &quot; reviewers&quot;;
              println(i, required + reviewers + &quot; required, found &quot; + actual);
              hasDisplayedErrors = true;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 114,18 ***</span>
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(MergeMessageIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name())) {</span>
              println(i, &quot;merge commits should only use the commit message &#39;&quot; + i.expected() + &quot;&#39;&quot;);
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(HgTagCommitIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name())) {</span>
              hasDisplayedErrors = true;
              switch (i.error()) {
                  case TOO_MANY_LINES:
                      println(i, &quot;message should only be one line&quot;);
                      return;
<span class="line-new-header">--- 116,18 ---</span>
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(MergeMessageIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name()) &amp;&amp; !isLax) {</span>
              println(i, &quot;merge commits should only use the commit message &#39;&quot; + i.expected() + &quot;&#39;&quot;);
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(HgTagCommitIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name()) &amp;&amp; !isLax) {</span>
              hasDisplayedErrors = true;
              switch (i.error()) {
                  case TOO_MANY_LINES:
                      println(i, &quot;message should only be one line&quot;);
                      return;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 197,32 ***</span>
  
          return merged;
      }
  
      public void visit(WhitespaceIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name())) {</span>
              var pos = i.path() + &quot;:&quot; + i.row();
              var prefix = println(i, i.describe() + &quot; in &quot; + pos);
              var indent = prefix.replaceAll(&quot;.&quot;, &quot; &quot;);
              System.out.println(indent + i.escapeLine());
              System.out.println(indent + i.hints());
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(MessageIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name())) {</span>
              println(i, &quot;contains additional lines in commit message&quot;);
              for (var line : i.message().additional()) {
                  System.out.println(&quot;&gt; &quot; + line);
              }
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(MessageWhitespaceIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name())) {</span>
              String desc = null;
              if (i.kind().isTab()) {
                  desc = &quot;tab&quot;;
              } else if (i.kind().isCR()) {
                  desc = &quot;carriage-return&quot;;
<span class="line-new-header">--- 199,32 ---</span>
  
          return merged;
      }
  
      public void visit(WhitespaceIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name()) &amp;&amp; !isLax) {</span>
              var pos = i.path() + &quot;:&quot; + i.row();
              var prefix = println(i, i.describe() + &quot; in &quot; + pos);
              var indent = prefix.replaceAll(&quot;.&quot;, &quot; &quot;);
              System.out.println(indent + i.escapeLine());
              System.out.println(indent + i.hints());
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(MessageIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name()) &amp;&amp; !isLax) {</span>
              println(i, &quot;contains additional lines in commit message&quot;);
              for (var line : i.message().additional()) {
                  System.out.println(&quot;&gt; &quot; + line);
              }
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(MessageWhitespaceIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name()) &amp;&amp; !isLax) {</span>
              String desc = null;
              if (i.kind().isTab()) {
                  desc = &quot;tab&quot;;
              } else if (i.kind().isCR()) {
                  desc = &quot;carriage-return&quot;;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 234,11 ***</span>
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(IssuesIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name())) {</span>
              println(i, &quot;missing reference to JBS issue in commit message&quot;);
              for (var line : i.commit().message()) {
                  System.out.println(&quot;&gt; &quot; + line);
              }
              hasDisplayedErrors = true;
<span class="line-new-header">--- 236,11 ---</span>
              hasDisplayedErrors = true;
          }
      }
  
      public void visit(IssuesIssue i) {
<span class="line-modified">!         if (!ignore.contains(i.check().name()) &amp;&amp; !isLax) {</span>
              println(i, &quot;missing reference to JBS issue in commit message&quot;);
              for (var line : i.commit().message()) {
                  System.out.println(&quot;&gt; &quot; + line);
              }
              hasDisplayedErrors = true;
</pre>
<center><a href="GitJCheck.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../jcheck/src/main/java/org/openjdk/skara/jcheck/IssuesCheck.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>