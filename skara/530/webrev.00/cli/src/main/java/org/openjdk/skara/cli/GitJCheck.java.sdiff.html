<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff cli/src/main/java/org/openjdk/skara/cli/GitJCheck.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> <a href="JCheckCLIVisitor.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>cli/src/main/java/org/openjdk/skara/cli/GitJCheck.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
305                 return 1;
306             }
307 
308             var upstreamBranchNames = repo.remoteBranches(parentRepo.get().webUrl().toString())
309                                           .stream()
310                                           .map(r -&gt; r.name())
311                                           .collect(Collectors.toSet());
312 
313             var displayedError = false;
314             for (var branch : targetBranches) {
315                 if (upstreamBranchNames.contains(branch)) {
316                     System.err.println(&quot;error: should not push to branch in personal fork also present in upstream repository: &quot; + branch);
317                     displayedError = true;
318                 }
319             }
320             if (displayedError) {
321                 return 1;
322             }
323         }
324 
<span class="line-modified">325         var visitor = new JCheckCLIVisitor(ignore, isMercurial);</span>

326         lines = repo.config(&quot;jcheck.pre-push.commits&quot;);
327         var shouldCheckCommits = lines.size() == 1 &amp;&amp; lines.get(0).toLowerCase().equals(&quot;true&quot;);
328         var commitMessageParser = isMercurial ? CommitMessageParsers.v0 : CommitMessageParsers.v1;
329         if (!isPrePush || shouldCheckCommits) {
330             for (var range : ranges) {
331                 try (var errors = JCheck.check(repo, census, commitMessageParser, range, whitelist, blacklist)) {
332                     for (var error : errors) {
333                         error.accept(visitor);
334                     }
335                 }
336             }
337         }
338         return visitor.hasDisplayedErrors() ? 1 : 0;
339     }
340 
341     public static void main(String[] args) throws IOException {
342         var cwd = Paths.get(&quot;&quot;).toAbsolutePath();
343         var repository = Repository.get(cwd);
344         if (!repository.isPresent()) {
345             System.err.println(String.format(&quot;error: %s is not a repository&quot;, cwd.toString()));
</pre>
</td>
<td>
<hr />
<pre>
305                 return 1;
306             }
307 
308             var upstreamBranchNames = repo.remoteBranches(parentRepo.get().webUrl().toString())
309                                           .stream()
310                                           .map(r -&gt; r.name())
311                                           .collect(Collectors.toSet());
312 
313             var displayedError = false;
314             for (var branch : targetBranches) {
315                 if (upstreamBranchNames.contains(branch)) {
316                     System.err.println(&quot;error: should not push to branch in personal fork also present in upstream repository: &quot; + branch);
317                     displayedError = true;
318                 }
319             }
320             if (displayedError) {
321                 return 1;
322             }
323         }
324 
<span class="line-modified">325         var isLax = getSwitch(&quot;lax&quot;, arguments);</span>
<span class="line-added">326         var visitor = new JCheckCLIVisitor(ignore, isMercurial, isLax);</span>
327         lines = repo.config(&quot;jcheck.pre-push.commits&quot;);
328         var shouldCheckCommits = lines.size() == 1 &amp;&amp; lines.get(0).toLowerCase().equals(&quot;true&quot;);
329         var commitMessageParser = isMercurial ? CommitMessageParsers.v0 : CommitMessageParsers.v1;
330         if (!isPrePush || shouldCheckCommits) {
331             for (var range : ranges) {
332                 try (var errors = JCheck.check(repo, census, commitMessageParser, range, whitelist, blacklist)) {
333                     for (var error : errors) {
334                         error.accept(visitor);
335                     }
336                 }
337             }
338         }
339         return visitor.hasDisplayedErrors() ? 1 : 0;
340     }
341 
342     public static void main(String[] args) throws IOException {
343         var cwd = Paths.get(&quot;&quot;).toAbsolutePath();
344         var repository = Repository.get(cwd);
345         if (!repository.isPresent()) {
346             System.err.println(String.format(&quot;error: %s is not a repository&quot;, cwd.toString()));
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> <a href="JCheckCLIVisitor.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>