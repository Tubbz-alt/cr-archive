<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff forge/src/main/java/org/openjdk/skara/forge/github/GitHubApplication.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>forge/src/main/java/org/openjdk/skara/forge/github/GitHubApplication.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
159             var signature = Base64.getUrlEncoder().encode(signer.sign());
160 
161             var token = new ByteArrayOutputStream();
162             token.write(header);
163             token.write(separator);
164             token.write(claims);
165             token.write(separator);
166             token.write(signature);
167 
168             return token.toString(StandardCharsets.US_ASCII);
169         } catch (NoSuchAlgorithmException | SignatureException e) {
170             throw new RuntimeException(e);
171         } catch (InvalidKeyException e) {
172             throw new GitHubConfigurationError(&quot;Invalid private key&quot;);
173         } catch (IOException e) {
174             throw new UncheckedIOException(e);
175         }
176     }
177 
178     private String generateInstallationToken() throws Token.GeneratorError {
<span class="line-modified">179         var tokens = URIBuilder.base(apiBase).setPath(&quot;/installations/&quot; + id + &quot;/access_tokens&quot;).build();</span>
180 
181         try {
182             var response = client.send(
183                     HttpRequest.newBuilder()
184                                .uri(tokens)
185                                .timeout(Duration.ofSeconds(30))
186                                .header(&quot;Authorization&quot;, &quot;Bearer &quot; + jwt)
187                                .header(&quot;Accept&quot;, &quot;application/vnd.github.machine-man-preview+json&quot;)
188                                .POST(HttpRequest.BodyPublishers.noBody())
189                                .build(),
190                     HttpResponse.BodyHandlers.ofString()
191             );
192 
193             var data = JSON.parse(response.body());
194             if (!data.contains(&quot;token&quot;)) {
195                 throw new Token.GeneratorError(&quot;Unknown data returned: &quot; + data);
196             }
197             return data.get(&quot;token&quot;).asString();
198         } catch (IOException e) {
199             throw new UncheckedIOException(e);
</pre>
</td>
<td>
<hr />
<pre>
159             var signature = Base64.getUrlEncoder().encode(signer.sign());
160 
161             var token = new ByteArrayOutputStream();
162             token.write(header);
163             token.write(separator);
164             token.write(claims);
165             token.write(separator);
166             token.write(signature);
167 
168             return token.toString(StandardCharsets.US_ASCII);
169         } catch (NoSuchAlgorithmException | SignatureException e) {
170             throw new RuntimeException(e);
171         } catch (InvalidKeyException e) {
172             throw new GitHubConfigurationError(&quot;Invalid private key&quot;);
173         } catch (IOException e) {
174             throw new UncheckedIOException(e);
175         }
176     }
177 
178     private String generateInstallationToken() throws Token.GeneratorError {
<span class="line-modified">179         var tokens = URIBuilder.base(apiBase).setPath(&quot;/app/installations/&quot; + id + &quot;/access_tokens&quot;).build();</span>
180 
181         try {
182             var response = client.send(
183                     HttpRequest.newBuilder()
184                                .uri(tokens)
185                                .timeout(Duration.ofSeconds(30))
186                                .header(&quot;Authorization&quot;, &quot;Bearer &quot; + jwt)
187                                .header(&quot;Accept&quot;, &quot;application/vnd.github.machine-man-preview+json&quot;)
188                                .POST(HttpRequest.BodyPublishers.noBody())
189                                .build(),
190                     HttpResponse.BodyHandlers.ofString()
191             );
192 
193             var data = JSON.parse(response.body());
194             if (!data.contains(&quot;token&quot;)) {
195                 throw new Token.GeneratorError(&quot;Unknown data returned: &quot; + data);
196             }
197             return data.get(&quot;token&quot;).asString();
198         } catch (IOException e) {
199             throw new UncheckedIOException(e);
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>