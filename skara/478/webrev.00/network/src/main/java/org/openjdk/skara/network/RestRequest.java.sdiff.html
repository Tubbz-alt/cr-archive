<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff network/src/main/java/org/openjdk/skara/network/RestRequest.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>network/src/main/java/org/openjdk/skara/network/RestRequest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
182     }
183 
184     /**
185      * Creates a new request restricted to the given endpoint.
186      * @param endpoint
187      * @return
188      */
189     public RestRequest restrict(String endpoint) {
190         return new RestRequest(URIBuilder.base(apiBase).appendPath(endpoint).build(), authId, authGen);
191     }
192 
193     private URIBuilder getEndpointURI(String endpoint) {
194         return URIBuilder.base(apiBase)
195                          .appendPath(endpoint);
196     }
197 
198     private HttpRequest.Builder getHttpRequestBuilder(URI uri) {
199         var builder = HttpRequest.newBuilder()
200                                  .uri(uri)
201                                  .timeout(Duration.ofSeconds(30));
<span class="line-removed">202         if (authGen != null) {</span>
<span class="line-removed">203             builder.headers(authGen.getAuthHeaders().toArray(new String[0]));</span>
<span class="line-removed">204         }</span>
205         return builder;
206     }
207 
208     private void logRateLimit(HttpHeaders headers) {
209         if ((headers.firstValue(&quot;x-ratelimit-limit&quot;).isEmpty()) ||
210                 (headers.firstValue(&quot;x-ratelimit-remaining&quot;).isEmpty()) ||
211                 (headers.firstValue(&quot;x-ratelimit-reset&quot;).isEmpty())) {
212             return;
213         }
214 
215         var limit = Integer.parseInt(headers.firstValue(&quot;x-ratelimit-limit&quot;).get());
216         var remaining = Integer.parseInt(headers.firstValue(&quot;x-ratelimit-remaining&quot;).get());
217         var reset = Integer.parseInt(headers.firstValue(&quot;x-ratelimit-reset&quot;).get());
218         var timeToReset = Duration.between(Instant.now(), Instant.ofEpochSecond(reset));
219 
220         var level = Level.FINE;
221         var remainingPercentage = (remaining * 100) / limit;
222         if (remainingPercentage &lt; 10) {
223             level = Level.SEVERE;
224         } else if (remainingPercentage &lt; 20) {
</pre>
</td>
<td>
<hr />
<pre>
182     }
183 
184     /**
185      * Creates a new request restricted to the given endpoint.
186      * @param endpoint
187      * @return
188      */
189     public RestRequest restrict(String endpoint) {
190         return new RestRequest(URIBuilder.base(apiBase).appendPath(endpoint).build(), authId, authGen);
191     }
192 
193     private URIBuilder getEndpointURI(String endpoint) {
194         return URIBuilder.base(apiBase)
195                          .appendPath(endpoint);
196     }
197 
198     private HttpRequest.Builder getHttpRequestBuilder(URI uri) {
199         var builder = HttpRequest.newBuilder()
200                                  .uri(uri)
201                                  .timeout(Duration.ofSeconds(30));



202         return builder;
203     }
204 
205     private void logRateLimit(HttpHeaders headers) {
206         if ((headers.firstValue(&quot;x-ratelimit-limit&quot;).isEmpty()) ||
207                 (headers.firstValue(&quot;x-ratelimit-remaining&quot;).isEmpty()) ||
208                 (headers.firstValue(&quot;x-ratelimit-reset&quot;).isEmpty())) {
209             return;
210         }
211 
212         var limit = Integer.parseInt(headers.firstValue(&quot;x-ratelimit-limit&quot;).get());
213         var remaining = Integer.parseInt(headers.firstValue(&quot;x-ratelimit-remaining&quot;).get());
214         var reset = Integer.parseInt(headers.firstValue(&quot;x-ratelimit-reset&quot;).get());
215         var timeToReset = Duration.between(Instant.now(), Instant.ofEpochSecond(reset));
216 
217         var level = Level.FINE;
218         var remainingPercentage = (remaining * 100) / limit;
219         if (remainingPercentage &lt; 10) {
220             level = Level.SEVERE;
221         } else if (remainingPercentage &lt; 20) {
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>