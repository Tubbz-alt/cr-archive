<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff vcs/src/test/java/org/openjdk/skara/vcs/RepositoryTests.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../main/java/org/openjdk/skara/vcs/Repository.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>vcs/src/test/java/org/openjdk/skara/vcs/RepositoryTests.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
2207                 fail(&quot;Unexpected vcs: &quot; + vcs);
2208             }
2209         }
2210     }
2211 
2212     @ParameterizedTest
2213     @EnumSource(VCS.class)
2214     void testRangeExclusive(VCS vcs) throws IOException {
2215         try (var dir = new TemporaryDirectory()) {
2216             var repo = Repository.init(dir.path(), vcs);
2217             var range = repo.rangeExclusive(new Hash(&quot;01234&quot;), new Hash(&quot;56789&quot;));
2218             if (vcs == VCS.GIT) {
2219                 assertEquals(&quot;01234..56789&quot;, range);
2220             } else if (vcs == VCS.HG) {
2221                 assertEquals(&quot;01234:56789-01234&quot;, range);
2222             } else {
2223                 fail(&quot;Unexpected vcs: &quot; + vcs);
2224             }
2225         }
2226     }











































































2227 }
</pre>
</td>
<td>
<hr />
<pre>
2207                 fail(&quot;Unexpected vcs: &quot; + vcs);
2208             }
2209         }
2210     }
2211 
2212     @ParameterizedTest
2213     @EnumSource(VCS.class)
2214     void testRangeExclusive(VCS vcs) throws IOException {
2215         try (var dir = new TemporaryDirectory()) {
2216             var repo = Repository.init(dir.path(), vcs);
2217             var range = repo.rangeExclusive(new Hash(&quot;01234&quot;), new Hash(&quot;56789&quot;));
2218             if (vcs == VCS.GIT) {
2219                 assertEquals(&quot;01234..56789&quot;, range);
2220             } else if (vcs == VCS.HG) {
2221                 assertEquals(&quot;01234:56789-01234&quot;, range);
2222             } else {
2223                 fail(&quot;Unexpected vcs: &quot; + vcs);
2224             }
2225         }
2226     }
<span class="line-added">2227 </span>
<span class="line-added">2228     @Test</span>
<span class="line-added">2229     void testHgRepoNestedInGitRepo() throws IOException {</span>
<span class="line-added">2230         try (var gitDir = new TemporaryDirectory()) {</span>
<span class="line-added">2231             var gitRepo = Repository.init(gitDir.path(), VCS.GIT);</span>
<span class="line-added">2232             var gitFile = gitRepo.root().resolve(&quot;git-file.txt&quot;);</span>
<span class="line-added">2233             Files.write(gitFile, List.of(&quot;Hello, Git!&quot;));</span>
<span class="line-added">2234             gitRepo.add(gitFile);</span>
<span class="line-added">2235             var gitHash = gitRepo.commit(&quot;Added git-file.txt&quot;, &quot;duke&quot;, &quot;duke@openjdk.java.net&quot;);</span>
<span class="line-added">2236 </span>
<span class="line-added">2237             var hgDir = gitRepo.root().resolve(&quot;hg&quot;);</span>
<span class="line-added">2238             var hgRepo = Repository.init(hgDir, VCS.HG);</span>
<span class="line-added">2239             var hgFile = hgRepo.root().resolve(&quot;hg-file.txt&quot;);</span>
<span class="line-added">2240             Files.write(hgFile, List.of(&quot;Hello, Mercurial!&quot;));</span>
<span class="line-added">2241             hgRepo.add(hgFile);</span>
<span class="line-added">2242             var hgHash = hgRepo.commit(&quot;Added hg-file.txt&quot;, &quot;duke&quot;, &quot;duke@openjdk.java.net&quot;);</span>
<span class="line-added">2243 </span>
<span class="line-added">2244             var resolvedHgRepo = Repository.get(hgDir).orElseThrow();</span>
<span class="line-added">2245             var resolvedHgCommits = resolvedHgRepo.commits().asList();</span>
<span class="line-added">2246             assertEquals(1, resolvedHgCommits.size());</span>
<span class="line-added">2247             assertEquals(hgHash, resolvedHgCommits.get(0).hash());</span>
<span class="line-added">2248 </span>
<span class="line-added">2249             var resolvedGitRepo = Repository.get(gitDir.path()).orElseThrow();</span>
<span class="line-added">2250             var resolvedGitCommits = resolvedGitRepo.commits().asList();</span>
<span class="line-added">2251             assertEquals(1, resolvedGitCommits.size());</span>
<span class="line-added">2252             assertEquals(gitHash, resolvedGitCommits.get(0).hash());</span>
<span class="line-added">2253         }</span>
<span class="line-added">2254     }</span>
<span class="line-added">2255 </span>
<span class="line-added">2256     @Test</span>
<span class="line-added">2257     void testGitRepoNestedInHgRepo() throws IOException {</span>
<span class="line-added">2258         try (var hgDir = new TemporaryDirectory()) {</span>
<span class="line-added">2259             var hgRepo = Repository.init(hgDir.path(), VCS.HG);</span>
<span class="line-added">2260             var hgFile = hgRepo.root().resolve(&quot;hg-file.txt&quot;);</span>
<span class="line-added">2261             Files.write(hgFile, List.of(&quot;Hello, Mercurial!&quot;));</span>
<span class="line-added">2262             hgRepo.add(hgFile);</span>
<span class="line-added">2263             var hgHash = hgRepo.commit(&quot;Added hg-file.txt&quot;, &quot;duke&quot;, &quot;duke@openjdk.java.net&quot;);</span>
<span class="line-added">2264 </span>
<span class="line-added">2265             var gitDir = hgRepo.root().resolve(&quot;git&quot;);</span>
<span class="line-added">2266             var gitRepo = Repository.init(gitDir, VCS.GIT);</span>
<span class="line-added">2267             var gitFile = gitRepo.root().resolve(&quot;git-file.txt&quot;);</span>
<span class="line-added">2268             Files.write(gitFile, List.of(&quot;Hello, Git!&quot;));</span>
<span class="line-added">2269             gitRepo.add(gitFile);</span>
<span class="line-added">2270             var gitHash = gitRepo.commit(&quot;Added git-file.txt&quot;, &quot;duke&quot;, &quot;duke@openjdk.java.net&quot;);</span>
<span class="line-added">2271 </span>
<span class="line-added">2272             var resolvedHgRepo = Repository.get(hgDir.path()).orElseThrow();</span>
<span class="line-added">2273             var resolvedHgCommits = resolvedHgRepo.commits().asList();</span>
<span class="line-added">2274             assertEquals(1, resolvedHgCommits.size());</span>
<span class="line-added">2275             assertEquals(hgHash, resolvedHgCommits.get(0).hash());</span>
<span class="line-added">2276 </span>
<span class="line-added">2277             var resolvedGitRepo = Repository.get(gitDir).orElseThrow();</span>
<span class="line-added">2278             var resolvedGitCommits = resolvedGitRepo.commits().asList();</span>
<span class="line-added">2279             assertEquals(1, resolvedGitCommits.size());</span>
<span class="line-added">2280             assertEquals(gitHash, resolvedGitCommits.get(0).hash());</span>
<span class="line-added">2281         }</span>
<span class="line-added">2282     }</span>
<span class="line-added">2283 </span>
<span class="line-added">2284     @Test</span>
<span class="line-added">2285     void testGitAndHgRepoInSameDirectory() throws IOException {</span>
<span class="line-added">2286         try (var dir = new TemporaryDirectory()) {</span>
<span class="line-added">2287             var hgRepo = Repository.init(dir.path(), VCS.HG);</span>
<span class="line-added">2288             var hgFile = hgRepo.root().resolve(&quot;hg-file.txt&quot;);</span>
<span class="line-added">2289             Files.write(hgFile, List.of(&quot;Hello, Mercurial!&quot;));</span>
<span class="line-added">2290             hgRepo.add(hgFile);</span>
<span class="line-added">2291             var hgHash = hgRepo.commit(&quot;Added hg-file.txt&quot;, &quot;duke&quot;, &quot;duke@openjdk.java.net&quot;);</span>
<span class="line-added">2292 </span>
<span class="line-added">2293             var gitRepo = Repository.init(dir.path(), VCS.GIT);</span>
<span class="line-added">2294             var gitFile = gitRepo.root().resolve(&quot;git-file.txt&quot;);</span>
<span class="line-added">2295             Files.write(gitFile, List.of(&quot;Hello, Git!&quot;));</span>
<span class="line-added">2296             gitRepo.add(gitFile);</span>
<span class="line-added">2297             var gitHash = gitRepo.commit(&quot;Added git-file.txt&quot;, &quot;duke&quot;, &quot;duke@openjdk.java.net&quot;);</span>
<span class="line-added">2298 </span>
<span class="line-added">2299             assertThrows(IOException.class, () -&gt; Repository.get(dir.path()));</span>
<span class="line-added">2300         }</span>
<span class="line-added">2301     }</span>
2302 }
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../main/java/org/openjdk/skara/vcs/Repository.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>