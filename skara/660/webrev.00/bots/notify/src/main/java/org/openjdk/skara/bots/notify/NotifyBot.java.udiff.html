<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff bots/notify/src/main/java/org/openjdk/skara/bots/notify/NotifyBot.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="NotifyBotBuilder.java.udiff.html" target="_top">next &gt;</a></center>    <h2>bots/notify/src/main/java/org/openjdk/skara/bots/notify/NotifyBot.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -41,42 +41,38 @@</span>
      private final StorageBuilder&lt;UpdatedBranch&gt; branchStorageBuilder;
      private final StorageBuilder&lt;PullRequestState&gt; prStateStorageBuilder;
      private final List&lt;RepositoryListener&gt; repoListeners = new ArrayList&lt;&gt;();
      private final List&lt;PullRequestListener&gt; prListeners = new ArrayList&lt;&gt;();
      private final PullRequestUpdateCache updateCache;
<span class="udiff-line-removed">-     private final Set&lt;String&gt; readyLabels;</span>
      private final Map&lt;String, Pattern&gt; readyComments;
      private final String integratorId;
  
      private ZonedDateTime lastFullUpdate;
  
      NotifyBot(HostedRepository repository, Path storagePath, Pattern branches, StorageBuilder&lt;UpdatedTag&gt; tagStorageBuilder,
                StorageBuilder&lt;UpdatedBranch&gt; branchStorageBuilder, StorageBuilder&lt;PullRequestState&gt; prStateStorageBuilder,
<span class="udiff-line-modified-removed">-               Set&lt;String&gt; readyLabels, Map&lt;String, Pattern&gt; readyComments, String integratorId) {</span>
<span class="udiff-line-modified-added">+               Map&lt;String, Pattern&gt; readyComments, String integratorId) {</span>
          this.repository = repository;
          this.storagePath = storagePath;
          this.branches = branches;
          this.tagStorageBuilder = tagStorageBuilder;
          this.branchStorageBuilder = branchStorageBuilder;
          this.prStateStorageBuilder = prStateStorageBuilder;
          this.updateCache = new PullRequestUpdateCache();
<span class="udiff-line-removed">-         this.readyLabels = readyLabels;</span>
          this.readyComments = readyComments;
          this.integratorId = integratorId;
      }
  
      public static NotifyBotBuilder newBuilder() {
          return new NotifyBotBuilder();
      }
  
<span class="udiff-line-modified-removed">-     private boolean isReady(PullRequest pr) {</span>
<span class="udiff-line-modified-added">+     private boolean isOfInterest(PullRequest pr) {</span>
          var labels = new HashSet&lt;&gt;(pr.labels());
<span class="udiff-line-modified-removed">-         for (var readyLabel : readyLabels) {</span>
<span class="udiff-line-modified-removed">-             if (!labels.contains(readyLabel)) {</span>
<span class="udiff-line-modified-removed">-                 log.fine(&quot;PR is not yet ready - missing label &#39;&quot; + readyLabel + &quot;&#39;&quot;);</span>
<span class="udiff-line-removed">-                 return false;</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-modified-added">+         if (!(labels.contains(&quot;rfr&quot;) || labels.contains(&quot;integrated&quot;))) {</span>
<span class="udiff-line-modified-added">+             log.fine(&quot;PR is not yet ready - needs either &#39;rfr&#39; or &#39;integrated&#39; label&quot;);</span>
<span class="udiff-line-modified-added">+             return false;</span>
          }
  
          var comments = pr.comments();
          for (var readyComment : readyComments.entrySet()) {
              var commentFound = false;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -129,11 +125,11 @@</span>
          }
  
          // Pull request events
          for (var pr : prs) {
              if (updateCache.needsUpdate(pr)) {
<span class="udiff-line-modified-removed">-                 if (!isReady(pr)) {</span>
<span class="udiff-line-modified-added">+                 if (!isOfInterest(pr)) {</span>
                      continue;
                  }
                  ret.add(new PullRequestWorkItem(pr,
                                                  prStateStorageBuilder,
                                                  prListeners,
</pre>
<center>&lt; prev <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="NotifyBotBuilder.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>