<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff bots/pr/src/main/java/org/openjdk/skara/bots/pr/ReviewerCommand.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>bots/pr/src/main/java/org/openjdk/skara/bots/pr/ReviewerCommand.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 67     }
 68 
 69     @Override
 70     public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List&lt;Comment&gt; allComments, PrintWriter reply) {
 71         if (!command.user().equals(pr.author())) {
 72             reply.println(&quot;Only the author (@&quot; + pr.author().userName() + &quot;) is allowed to issue the `reviewer` command.&quot;);
 73             return;
 74         }
 75         if (bot.ignoreStaleReviews()) {
 76             reply.println(&quot;This project requires authenticated reviews - please ask your reviewer to flag this PR as reviewed.&quot;);
 77             return;
 78         }
 79 
 80         var matcher = commandPattern.matcher(command.args());
 81         if (!matcher.matches()) {
 82             showHelp(pr, reply);
 83             return;
 84         }
 85 
 86         var reviewers = new ArrayList&lt;Contributor&gt;();
<span class="line-modified"> 87         for (var entry : matcher.group(2).split(&quot; &quot;)) {</span>
 88             var reviewer = parseUser(entry, pr, censusInstance);
 89             if (reviewer.isEmpty()) {
 90                 reply.println(&quot;Could not parse `&quot; + entry + &quot;` as a valid reviewer.&quot;);
 91                 showHelp(pr, reply);
 92                 return;
 93             }
 94 
 95             reviewers.add(reviewer.get());
 96         }
 97 
 98         var namespace = censusInstance.namespace();
 99         var authenticatedReviewers = PullRequestUtils.reviewerNames(pr.reviews(), namespace);
100         var action = matcher.group(1);
101         if (action.equals(&quot;add&quot;)) {
102             for (var reviewer : reviewers) {
103                 if (!authenticatedReviewers.contains(reviewer.username())) {
104                     reply.println(Reviewers.addReviewerMarker(reviewer));
105                     reply.println(&quot;Reviewer `&quot; + reviewer.username() + &quot;` successfully added.&quot;);
106                 } else {
107                     reply.println(&quot;Reviewer `&quot; + reviewer.username() + &quot;` has already made an authenticated review of this PR, and does not need to be added manually.&quot;);
</pre>
</td>
<td>
<hr />
<pre>
 67     }
 68 
 69     @Override
 70     public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List&lt;Comment&gt; allComments, PrintWriter reply) {
 71         if (!command.user().equals(pr.author())) {
 72             reply.println(&quot;Only the author (@&quot; + pr.author().userName() + &quot;) is allowed to issue the `reviewer` command.&quot;);
 73             return;
 74         }
 75         if (bot.ignoreStaleReviews()) {
 76             reply.println(&quot;This project requires authenticated reviews - please ask your reviewer to flag this PR as reviewed.&quot;);
 77             return;
 78         }
 79 
 80         var matcher = commandPattern.matcher(command.args());
 81         if (!matcher.matches()) {
 82             showHelp(pr, reply);
 83             return;
 84         }
 85 
 86         var reviewers = new ArrayList&lt;Contributor&gt;();
<span class="line-modified"> 87         for (var entry : matcher.group(2).split(&quot;[\\s,]+&quot;)) {</span>
 88             var reviewer = parseUser(entry, pr, censusInstance);
 89             if (reviewer.isEmpty()) {
 90                 reply.println(&quot;Could not parse `&quot; + entry + &quot;` as a valid reviewer.&quot;);
 91                 showHelp(pr, reply);
 92                 return;
 93             }
 94 
 95             reviewers.add(reviewer.get());
 96         }
 97 
 98         var namespace = censusInstance.namespace();
 99         var authenticatedReviewers = PullRequestUtils.reviewerNames(pr.reviews(), namespace);
100         var action = matcher.group(1);
101         if (action.equals(&quot;add&quot;)) {
102             for (var reviewer : reviewers) {
103                 if (!authenticatedReviewers.contains(reviewer.username())) {
104                     reply.println(Reviewers.addReviewerMarker(reviewer));
105                     reply.println(&quot;Reviewer `&quot; + reviewer.username() + &quot;` successfully added.&quot;);
106                 } else {
107                     reply.println(&quot;Reviewer `&quot; + reviewer.username() + &quot;` has already made an authenticated review of this PR, and does not need to be added manually.&quot;);
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>