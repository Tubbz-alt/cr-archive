<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff cli/src/main/java/org/openjdk/skara/cli/GitWebrev.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>cli/src/main/java/org/openjdk/skara/cli/GitWebrev.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
186                     upstream = pullPath.toString();
187                 } else if (host != null &amp;&amp; host.equals(&quot;github.com&quot;)) {
188                     var path = pullPath.getPath();
189                     if (path != null &amp;&amp; path.startsWith(&quot;/openjdk/&quot;)) {
190                         upstream = pullPath.toString();
191                     }
192                 }
193             }
194         }
195         var upstreamURL = upstream;
196 
197         var noOutgoing = arguments.contains(&quot;no-outgoing&quot;);
198         if (!noOutgoing) {
199             var config = repo.config(&quot;webrev.no-outgoing&quot;);
200             if (config.size() == 1) {
201                 var enabled = Set.of(&quot;TRUE&quot;, &quot;ON&quot;, &quot;1&quot;, &quot;ENABLED&quot;);
202                 noOutgoing = enabled.contains(config.get(0).toUpperCase());
203             }
204         }
205 
<span class="line-modified">206         var rev = arguments.contains(&quot;rev&quot;) ?</span>
<span class="line-modified">207             resolve(repo, arguments.get(&quot;rev&quot;).asString()) :</span>
<span class="line-modified">208             noOutgoing ?</span>
<span class="line-modified">209                 resolve(repo, isMercurial ? &quot;tip&quot; : &quot;HEAD&quot;) :</span>
<span class="line-modified">210                 resolve(repo, isMercurial ? &quot;min(outgoing())^&quot; : &quot;origin&quot; + &quot;/&quot; + &quot;master&quot;);</span>








211 
212         var issue = arguments.contains(&quot;cr&quot;) ? arguments.get(&quot;cr&quot;).asString() : null;
213         if (issue != null) {
214             if (issue.startsWith(&quot;http&quot;)) {
215                 var uri = URI.create(issue);
216                 issue = Path.of(uri.getPath()).getFileName().toString();
217             } else if (isDigit(issue.charAt(0))) {
218                 issue = &quot;JDK-&quot; + issue;
219             }
220         }
221         if (issue == null) {
222             var pattern = Pattern.compile(&quot;(?:(JDK|CODETOOLS|JMC|SKARA)-)?([0-9]+).*&quot;);
223             var currentBranch = repo.currentBranch();
224             if (currentBranch.isPresent()) {
225                 var branchName = currentBranch.get().name().toUpperCase();
226                 var m = pattern.matcher(branchName);
227                 if (m.matches()) {
228                     var project = m.group(1);
229                     if (project == null) {
230                         project = &quot;JDK&quot;;
</pre>
</td>
<td>
<hr />
<pre>
186                     upstream = pullPath.toString();
187                 } else if (host != null &amp;&amp; host.equals(&quot;github.com&quot;)) {
188                     var path = pullPath.getPath();
189                     if (path != null &amp;&amp; path.startsWith(&quot;/openjdk/&quot;)) {
190                         upstream = pullPath.toString();
191                     }
192                 }
193             }
194         }
195         var upstreamURL = upstream;
196 
197         var noOutgoing = arguments.contains(&quot;no-outgoing&quot;);
198         if (!noOutgoing) {
199             var config = repo.config(&quot;webrev.no-outgoing&quot;);
200             if (config.size() == 1) {
201                 var enabled = Set.of(&quot;TRUE&quot;, &quot;ON&quot;, &quot;1&quot;, &quot;ENABLED&quot;);
202                 noOutgoing = enabled.contains(config.get(0).toUpperCase());
203             }
204         }
205 
<span class="line-modified">206         var rev = arguments.contains(&quot;rev&quot;) ? resolve(repo, arguments.get(&quot;rev&quot;).asString()) : null;</span>
<span class="line-modified">207         if (rev == null) {</span>
<span class="line-modified">208             if (isMercurial) {</span>
<span class="line-modified">209                 resolve(repo, noOutgoing ? &quot;tip&quot; : &quot;min(outgoing())^&quot;);</span>
<span class="line-modified">210             } else {</span>
<span class="line-added">211                 if (noOutgoing) {</span>
<span class="line-added">212                     rev = resolve(repo, &quot;HEAD&quot;);</span>
<span class="line-added">213                 } else {</span>
<span class="line-added">214                     var commits = repo.commitMetadata(&quot;origin..HEAD&quot;, true);</span>
<span class="line-added">215                     rev = resolve(repo, commits.get(0).hash().hex() + &quot;^&quot;);</span>
<span class="line-added">216                 }</span>
<span class="line-added">217             }</span>
<span class="line-added">218         }</span>
219 
220         var issue = arguments.contains(&quot;cr&quot;) ? arguments.get(&quot;cr&quot;).asString() : null;
221         if (issue != null) {
222             if (issue.startsWith(&quot;http&quot;)) {
223                 var uri = URI.create(issue);
224                 issue = Path.of(uri.getPath()).getFileName().toString();
225             } else if (isDigit(issue.charAt(0))) {
226                 issue = &quot;JDK-&quot; + issue;
227             }
228         }
229         if (issue == null) {
230             var pattern = Pattern.compile(&quot;(?:(JDK|CODETOOLS|JMC|SKARA)-)?([0-9]+).*&quot;);
231             var currentBranch = repo.currentBranch();
232             if (currentBranch.isPresent()) {
233                 var branchName = currentBranch.get().name().toUpperCase();
234                 var m = pattern.matcher(branchName);
235                 if (m.matches()) {
236                     var project = m.group(1);
237                     if (project == null) {
238                         project = &quot;JDK&quot;;
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>