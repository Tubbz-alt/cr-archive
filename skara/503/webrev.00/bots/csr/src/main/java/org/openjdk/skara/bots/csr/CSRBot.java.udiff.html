<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff bots/csr/src/main/java/org/openjdk/skara/bots/csr/CSRBot.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>bots/csr/src/main/java/org/openjdk/skara/bots/csr/CSRBot.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -100,24 +100,37 @@</span>
                      log.info(&quot;Found CSR for &quot; + describe(pr));
  
                      var csr = link.issue().orElseThrow(
                              () -&gt; new IllegalStateException(&quot;Link with title &#39;csr for&#39; does not contain issue&quot;)
                      );
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+                     log.info(&quot;CSR for &quot; + describe(pr) + &quot; has id &quot; + csr.id());</span>
<span class="udiff-line-added">+ </span>
                      var resolution = csr.properties().get(&quot;resolution&quot;);
                      if (resolution == null || resolution.isNull()) {
<span class="udiff-line-added">+                         log.info(&quot;CSR issue resolution is null for &quot; + describe(pr) + &quot;, not removing CSR label&quot;);</span>
                          continue;
                      }
                      var name = resolution.get(&quot;name&quot;);
                      if (name == null || name.isNull()) {
<span class="udiff-line-added">+                         log.info(&quot;CSR issue resolution name is null for &quot; + describe(pr) + &quot;, not removing CSR label&quot;);</span>
                          continue;
                      }
  
<span class="udiff-line-modified-removed">-                     if (csr.state() == Issue.State.CLOSED &amp;&amp; name.asString().equals(&quot;Approved&quot;)) {</span>
<span class="udiff-line-modified-removed">-                         log.info(&quot;CSR closed and approved for &quot; + repo.name() + &quot;#&quot; + pr.id() + &quot;, removing csr label&quot;);</span>
<span class="udiff-line-modified-removed">-                         pr.removeLabel(CSR_LABEL);</span>
<span class="udiff-line-removed">-                         hasCSRLabel.remove(pr.id());</span>
<span class="udiff-line-modified-added">+                     if (csr.state() != Issue.State.CLOSED) {</span>
<span class="udiff-line-modified-added">+                         log.info(&quot;CSR issue state is not closed for &quot; + describe(pr) + &quot;, not removing CSR label&quot;);</span>
<span class="udiff-line-modified-added">+                         continue;</span>
                      }
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+                     if (!name.asString().equals(&quot;Approved&quot;)) {</span>
<span class="udiff-line-added">+                         log.info(&quot;CSR issue resolution is not &#39;Approved&#39; for &quot; + describe(pr) + &quot;, not removing CSR label&quot;);</span>
<span class="udiff-line-added">+                         continue;</span>
<span class="udiff-line-added">+                     }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+                     log.info(&quot;CSR closed and approved for &quot; + describe(pr) + &quot;, removing CSR label&quot;);</span>
<span class="udiff-line-added">+                     pr.removeLabel(CSR_LABEL);</span>
<span class="udiff-line-added">+                     hasCSRLabel.remove(pr.id());</span>
                  }
              }
          }
      }
  
</pre>
<center>&lt; prev <a href="../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>