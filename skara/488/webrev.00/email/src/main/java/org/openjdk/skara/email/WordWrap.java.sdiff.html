<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff email/src/main/java/org/openjdk/skara/email/WordWrap.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../test/java/org/openjdk/skara/email/WordWrapTests.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>email/src/main/java/org/openjdk/skara/email/WordWrap.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 75     }
 76 
 77     private static String filterIndent(String indent) {
 78         return indent.replace(&#39;-&#39;, &#39; &#39;).replace(&#39;*&#39;, &#39; &#39;);
 79     }
 80 
 81     public static String wrapBody(String body, int lineLength) {
 82         var ret = new StringBuilder();
 83 
 84         var lines = new LinkedList&lt;String&gt;();
 85         body.lines().forEach(lines::add);
 86 
 87         while (!lines.isEmpty()) {
 88             var line = lines.pollFirst();
 89             var indentation = indentation(line);
 90             var split = split(line.substring(indentation.length()), lineLength);
 91             if (!split.getValue().isBlank()) {
 92                 var nextLine = lines.peekFirst();
 93                 if (nextLine != null) {
 94                     var nextIndent = indentation(nextLine);
<span class="line-modified"> 95                     if (!indentation.equals(filterIndent(nextIndent))) {</span>
 96                         lines.addFirst(filterIndent(indentation) + split.getValue());
 97                     } else {
 98                         lines.removeFirst();
 99                         lines.addFirst(filterIndent(indentation) + split.getValue() + &quot; &quot; + nextLine.substring(indentation.length()));
100                     }
101                 } else {
102                     lines.addFirst(filterIndent(indentation) + split.getValue());
103                 }
104             }
105             if (ret.length() &gt; 0) {
106                 ret.append(&quot;\n&quot;);
107             }
108             ret.append(indentation).append(split.getKey().stripTrailing());
109         }
110 
111         return ret.toString();
112     }
113 }
</pre>
</td>
<td>
<hr />
<pre>
 75     }
 76 
 77     private static String filterIndent(String indent) {
 78         return indent.replace(&#39;-&#39;, &#39; &#39;).replace(&#39;*&#39;, &#39; &#39;);
 79     }
 80 
 81     public static String wrapBody(String body, int lineLength) {
 82         var ret = new StringBuilder();
 83 
 84         var lines = new LinkedList&lt;String&gt;();
 85         body.lines().forEach(lines::add);
 86 
 87         while (!lines.isEmpty()) {
 88             var line = lines.pollFirst();
 89             var indentation = indentation(line);
 90             var split = split(line.substring(indentation.length()), lineLength);
 91             if (!split.getValue().isBlank()) {
 92                 var nextLine = lines.peekFirst();
 93                 if (nextLine != null) {
 94                     var nextIndent = indentation(nextLine);
<span class="line-modified"> 95                     if (nextLine.isBlank() || !indentation.equals(filterIndent(nextIndent))) {</span>
 96                         lines.addFirst(filterIndent(indentation) + split.getValue());
 97                     } else {
 98                         lines.removeFirst();
 99                         lines.addFirst(filterIndent(indentation) + split.getValue() + &quot; &quot; + nextLine.substring(indentation.length()));
100                     }
101                 } else {
102                     lines.addFirst(filterIndent(indentation) + split.getValue());
103                 }
104             }
105             if (ret.length() &gt; 0) {
106                 ret.append(&quot;\n&quot;);
107             }
108             ret.append(indentation).append(split.getKey().stripTrailing());
109         }
110 
111         return ret.toString();
112     }
113 }
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../test/java/org/openjdk/skara/email/WordWrapTests.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>