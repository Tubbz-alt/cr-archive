<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/RunTests.gmk</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../index.html" target="_top">index</a> next &gt;</center>    <h2>make/RunTests.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 843   # Make sure MaxRAMPercentage is high enough to not cause OOM or swapping since
 844   # we may end up with a lot of JVM&#39;s
 845   $1_JTREG_MAX_RAM_PERCENTAGE := $$(shell $$(EXPR) 25 / $$($1_JTREG_JOBS))
 846 
 847   # SPARC is in general slower per core so need to scale up timeouts a bit.
 848   ifeq ($(call isTargetCpuArch, sparc), true)
 849     JTREG_TIMEOUT_FACTOR ?= 8
 850   else
 851     JTREG_TIMEOUT_FACTOR ?= 4
 852   endif
 853   JTREG_VERBOSE ?= fail,error,summary
 854   JTREG_RETAIN ?= fail,error
 855   JTREG_RUN_PROBLEM_LISTS ?= false
 856   JTREG_RETRY_COUNT ?= 0
 857 
 858   ifneq ($$($1_JTREG_MAX_MEM), 0)
 859     $1_JTREG_BASIC_OPTIONS += -vmoption:-Xmx$$($1_JTREG_MAX_MEM)
 860     $1_JTREG_LAUNCHER_OPTIONS += -Xmx$$($1_JTREG_MAX_MEM)
 861   endif
 862 









 863   $1_JTREG_BASIC_OPTIONS += -$$($1_JTREG_TEST_MODE) \
 864       -verbose:$$(JTREG_VERBOSE) -retain:$$(JTREG_RETAIN) \
 865       -concurrency:$$($1_JTREG_JOBS) -timeoutFactor:$$(JTREG_TIMEOUT_FACTOR) \
 866       -vmoption:-XX:MaxRAMPercentage=$$($1_JTREG_MAX_RAM_PERCENTAGE)
 867 
 868   $1_JTREG_BASIC_OPTIONS += -automatic -ignore:quiet
 869 
 870   # Make it possible to specify the JIB_DATA_DIR for tests using the
 871   # JIB Artifact resolver
 872   $1_JTREG_BASIC_OPTIONS += -e:JIB_DATA_DIR
 873   # Some tests needs to find a boot JDK using the JDK8_HOME variable.
 874   $1_JTREG_BASIC_OPTIONS += -e:JDK8_HOME=$$(BOOT_JDK)
 875   # If running on Windows, propagate the _NT_SYMBOL_PATH to enable
 876   # symbol lookup in hserr files
 877   ifeq ($$(call isTargetOs, windows), true)
 878     $1_JTREG_BASIC_OPTIONS += -e:_NT_SYMBOL_PATH
 879   endif
 880 
 881   $1_JTREG_BASIC_OPTIONS += \
 882       $$(addprefix -javaoption:, $$(JTREG_JAVA_OPTIONS)) \
</pre>
</td>
<td>
<hr />
<pre>
 843   # Make sure MaxRAMPercentage is high enough to not cause OOM or swapping since
 844   # we may end up with a lot of JVM&#39;s
 845   $1_JTREG_MAX_RAM_PERCENTAGE := $$(shell $$(EXPR) 25 / $$($1_JTREG_JOBS))
 846 
 847   # SPARC is in general slower per core so need to scale up timeouts a bit.
 848   ifeq ($(call isTargetCpuArch, sparc), true)
 849     JTREG_TIMEOUT_FACTOR ?= 8
 850   else
 851     JTREG_TIMEOUT_FACTOR ?= 4
 852   endif
 853   JTREG_VERBOSE ?= fail,error,summary
 854   JTREG_RETAIN ?= fail,error
 855   JTREG_RUN_PROBLEM_LISTS ?= false
 856   JTREG_RETRY_COUNT ?= 0
 857 
 858   ifneq ($$($1_JTREG_MAX_MEM), 0)
 859     $1_JTREG_BASIC_OPTIONS += -vmoption:-Xmx$$($1_JTREG_MAX_MEM)
 860     $1_JTREG_LAUNCHER_OPTIONS += -Xmx$$($1_JTREG_MAX_MEM)
 861   endif
 862 
<span class="line-added"> 863   # With tsan enabled, process reaper often causes SOE. it makes jtreg test failure.</span>
<span class="line-added"> 864   ifeq ($(INCLUDE_TSAN), true)</span>
<span class="line-added"> 865     ifeq ($(call isTargetCpuArch, aarch64), true)</span>
<span class="line-added"> 866       $1_JTREG_BASIC_OPTIONS += -vmoption:-Djdk.lang.processReaperUseDefaultStackSize=true</span>
<span class="line-added"> 867       $1_JTREG_LAUNCHER_OPTIONS += -Djdk.lang.processReaperUseDefaultStackSize=true</span>
<span class="line-added"> 868       $$(info tsan enabled, process reaper will use default JVM stack size.)</span>
<span class="line-added"> 869     endif</span>
<span class="line-added"> 870   endif</span>
<span class="line-added"> 871 </span>
 872   $1_JTREG_BASIC_OPTIONS += -$$($1_JTREG_TEST_MODE) \
 873       -verbose:$$(JTREG_VERBOSE) -retain:$$(JTREG_RETAIN) \
 874       -concurrency:$$($1_JTREG_JOBS) -timeoutFactor:$$(JTREG_TIMEOUT_FACTOR) \
 875       -vmoption:-XX:MaxRAMPercentage=$$($1_JTREG_MAX_RAM_PERCENTAGE)
 876 
 877   $1_JTREG_BASIC_OPTIONS += -automatic -ignore:quiet
 878 
 879   # Make it possible to specify the JIB_DATA_DIR for tests using the
 880   # JIB Artifact resolver
 881   $1_JTREG_BASIC_OPTIONS += -e:JIB_DATA_DIR
 882   # Some tests needs to find a boot JDK using the JDK8_HOME variable.
 883   $1_JTREG_BASIC_OPTIONS += -e:JDK8_HOME=$$(BOOT_JDK)
 884   # If running on Windows, propagate the _NT_SYMBOL_PATH to enable
 885   # symbol lookup in hserr files
 886   ifeq ($$(call isTargetOs, windows), true)
 887     $1_JTREG_BASIC_OPTIONS += -e:_NT_SYMBOL_PATH
 888   endif
 889 
 890   $1_JTREG_BASIC_OPTIONS += \
 891       $$(addprefix -javaoption:, $$(JTREG_JAVA_OPTIONS)) \
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>