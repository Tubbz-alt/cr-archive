<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff make/jdk/src/classes/build/tools/classlist/HelloClasslist.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../charsetmapping/SBCS.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../cldrconverter/AbstractLDMLHandler.java.udiff.html" target="_top">next &gt;</a></center>    <h2>make/jdk/src/classes/build/tools/classlist/HelloClasslist.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2016, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2016, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -29,11 +29,15 @@</span>
   *
   * The classlist is produced by adding -XX:DumpLoadedClassList=classlist
   */
  package build.tools.classlist;
  
<span class="udiff-line-added">+ import java.lang.invoke.MethodHandle;</span>
<span class="udiff-line-added">+ import java.lang.invoke.MethodHandles;</span>
<span class="udiff-line-added">+ import java.lang.invoke.MethodType;</span>
  import java.net.InetAddress;
<span class="udiff-line-added">+ import java.nio.file.FileSystems;</span>
  import java.time.LocalDateTime;
  import java.time.ZoneId;
  import java.time.format.DateTimeFormatter;
  import java.util.stream.Stream;
  import java.util.logging.*;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -52,37 +56,82 @@</span>
   */
  public class HelloClasslist {
  
      private static final Logger LOGGER = Logger.getLogger(&quot;Hello&quot;);
  
<span class="udiff-line-modified-removed">-     public static void main(String ... args) {</span>
<span class="udiff-line-modified-added">+     public static void main(String ... args) throws Throwable {</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         FileSystems.getDefault();</span>
  
          List&lt;String&gt; strings = Arrays.asList(&quot;Hello&quot;, &quot;World!&quot;, &quot;From: &quot;,
<span class="udiff-line-modified-removed">-               InetAddress.getLoopbackAddress().toString());</span>
<span class="udiff-line-modified-added">+                 InetAddress.getLoopbackAddress().toString());</span>
  
          String helloWorld = strings.parallelStream()
<span class="udiff-line-modified-removed">-               .map(s -&gt; s.toLowerCase(Locale.ROOT))</span>
<span class="udiff-line-modified-removed">-               .collect(joining(&quot;,&quot;));</span>
<span class="udiff-line-modified-added">+                 .map(s -&gt; s.toLowerCase(Locale.ROOT))</span>
<span class="udiff-line-modified-added">+                 .collect(joining(&quot;,&quot;));</span>
  
<span class="udiff-line-modified-removed">-         Stream.of(helloWorld.split(&quot;,&quot;))</span>
<span class="udiff-line-modified-removed">-               .forEach(System.out::println);</span>
<span class="udiff-line-modified-added">+         Stream.of(helloWorld.split(&quot;([,x-z]{1,3})([\\s]*)&quot;))</span>
<span class="udiff-line-modified-added">+                 .map(String::toString)</span>
<span class="udiff-line-added">+                 .forEach(System.out::println);</span>
  
          // Common concatenation patterns
<span class="udiff-line-modified-removed">-         String const_I = &quot;string&quot; + args.length;</span>
<span class="udiff-line-modified-removed">-         String const_S = &quot;string&quot; + String.valueOf(args.length);</span>
<span class="udiff-line-modified-removed">-         String S_const = String.valueOf(args.length) + &quot;string&quot;;</span>
<span class="udiff-line-modified-removed">-         String S_S     = String.valueOf(args.length) + String.valueOf(args.length);</span>
<span class="udiff-line-modified-removed">-         String const_J = &quot;string&quot; + System.currentTimeMillis();</span>
<span class="udiff-line-modified-removed">-         String I_const = args.length + &quot;string&quot;;</span>
<span class="udiff-line-modified-removed">-         String J_const = System.currentTimeMillis() + &quot;string&quot;;</span>
<span class="udiff-line-modified-added">+         String SS     = String.valueOf(args.length) + String.valueOf(args.length);</span>
<span class="udiff-line-modified-added">+         String CS     = &quot;string&quot; + String.valueOf(args.length);</span>
<span class="udiff-line-modified-added">+         String SC     = String.valueOf(args.length) + &quot;string&quot;;</span>
<span class="udiff-line-modified-added">+         String SCS    = String.valueOf(args.length) + &quot;string&quot; + String.valueOf(args.length);</span>
<span class="udiff-line-modified-added">+         String CSS    = &quot;string&quot; + String.valueOf(args.length) + String.valueOf(args.length);</span>
<span class="udiff-line-modified-added">+         String CSC    = &quot;string&quot; + String.valueOf(args.length) + &quot;string&quot;;</span>
<span class="udiff-line-modified-added">+         String SSC    = String.valueOf(args.length) + String.valueOf(args.length) + &quot;string&quot;;</span>
<span class="udiff-line-added">+         String CSCS   = &quot;string&quot; + String.valueOf(args.length) + &quot;string&quot; + String.valueOf(args.length);</span>
<span class="udiff-line-added">+         String SCSC   = String.valueOf(args.length) + &quot;string&quot; + String.valueOf(args.length) + &quot;string&quot;;</span>
<span class="udiff-line-added">+         String CSCSC  = &quot;string&quot; + String.valueOf(args.length) + &quot;string&quot; + String.valueOf(args.length) + &quot;string&quot;;</span>
<span class="udiff-line-added">+         String SCSCS  = String.valueOf(args.length) + &quot;string&quot; + String.valueOf(args.length) + &quot;string&quot; + String.valueOf(args.length);</span>
<span class="udiff-line-added">+         String CI     = &quot;string&quot; + args.length;</span>
<span class="udiff-line-added">+         String IC     = args.length + &quot;string&quot;;</span>
<span class="udiff-line-added">+         String SI     = String.valueOf(args.length) + args.length;</span>
<span class="udiff-line-added">+         String IS     = args.length + String.valueOf(args.length);</span>
<span class="udiff-line-added">+         String CIS    = &quot;string&quot; + args.length + String.valueOf(args.length);</span>
<span class="udiff-line-added">+         String CSCI   = &quot;string&quot; + String.valueOf(args.length) + &quot;string&quot; + args.length;</span>
<span class="udiff-line-added">+         String CIC    = &quot;string&quot; + args.length + &quot;string&quot;;</span>
<span class="udiff-line-added">+         String CICI   = &quot;string&quot; + args.length + &quot;string&quot; + args.length;</span>
<span class="udiff-line-added">+         String CJ     = &quot;string&quot; + System.currentTimeMillis();</span>
<span class="udiff-line-added">+         String JC     = System.currentTimeMillis() + &quot;string&quot;;</span>
<span class="udiff-line-added">+         String CD     = &quot;string&quot; + (args.length/2.0);</span>
<span class="udiff-line-added">+         String CJC    = &quot;string&quot; + System.currentTimeMillis() + &quot;string&quot;;</span>
<span class="udiff-line-added">+         String CJCJ   = &quot;string&quot; + System.currentTimeMillis() + &quot;string&quot; + System.currentTimeMillis();</span>
<span class="udiff-line-added">+         String CJCJC  = &quot;string&quot; + System.currentTimeMillis() + &quot;string&quot; + System.currentTimeMillis() + &quot;string&quot;;</span>
  
          String newDate = DateTimeFormatter.ISO_LOCAL_DATE_TIME.format(
                  LocalDateTime.now(ZoneId.of(&quot;GMT&quot;)));
  
          String oldDate = String.format(&quot;%s%n&quot;,
                  DateFormat.getDateInstance(DateFormat.DEFAULT, Locale.ROOT)
                          .format(new Date()));
  
<span class="udiff-line-modified-removed">-         LOGGER.log(Level.INFO, &quot;New Date: &quot; + newDate + &quot; - old: &quot; + oldDate);</span>
<span class="udiff-line-modified-added">+         // A selection of trivial and relatively common MH operations</span>
<span class="udiff-line-added">+         invoke(MethodHandles.identity(double.class), 1.0);</span>
<span class="udiff-line-added">+         invoke(MethodHandles.identity(int.class), 1);</span>
<span class="udiff-line-added">+         invoke(MethodHandles.identity(String.class), &quot;x&quot;);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         invoke(handle(&quot;staticMethod_V&quot;, MethodType.methodType(void.class)));</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         LOGGER.log(Level.FINE, &quot;New Date: &quot; + newDate + &quot; - old: &quot; + oldDate);</span>
      }
  
<span class="udiff-line-added">+     public static void staticMethod_V() {}</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     private static MethodHandle handle(String name, MethodType type) throws Throwable {</span>
<span class="udiff-line-added">+         return MethodHandles.lookup().findStatic(HelloClasslist.class, name, type);</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     private static Object invoke(MethodHandle mh, Object ... args) throws Throwable {</span>
<span class="udiff-line-added">+         try {</span>
<span class="udiff-line-added">+             for (Object o : args) {</span>
<span class="udiff-line-added">+                 mh = MethodHandles.insertArguments(mh, 0, o);</span>
<span class="udiff-line-added">+             }</span>
<span class="udiff-line-added">+             return mh.invoke();</span>
<span class="udiff-line-added">+         } catch (Throwable t) {</span>
<span class="udiff-line-added">+             LOGGER.warning(&quot;Failed to find, link and/or invoke &quot; + mh.toString() + &quot;: &quot; + t.getMessage());</span>
<span class="udiff-line-added">+             throw t;</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+     }</span>
  }
</pre>
<center><a href="../charsetmapping/SBCS.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../cldrconverter/AbstractLDMLHandler.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>