<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New make/jdk/src/classes/build/tools/jdwpgen/AltNode.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 1998, 2013, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package build.tools.jdwpgen;
 27 
 28 import java.util.*;
 29 import java.io.*;
 30 
 31 class AltNode extends AbstractGroupNode implements TypeNode {
 32 
 33     SelectNode select = null;
 34 
 35     void constrain(Context ctx) {
 36         super.constrain(ctx);
 37 
 38         if (!(nameNode instanceof NameValueNode)) {
 39             error(&quot;Alt name must have value: &quot; + nameNode);
 40         }
 41         if (parent instanceof SelectNode) {
 42             select = (SelectNode)parent;
 43         } else {
 44             error(&quot;Alt must be in Select&quot;);
 45         }
 46     }
 47 
 48     void document(PrintWriter writer) {
 49         writer.println(&quot;&lt;tr&gt;&quot;);
 50         writer.println(&quot;&lt;th colspan=\&quot;2\&quot; scope=\&quot;row\&quot;&gt;&quot;
 51                 + indentElement(structIndent,
 52                     &quot;Case &quot; + nameNode.name
 53                     + &quot; - if &lt;i&gt;&quot; + ((SelectNode)parent).typeNode.name + &quot;&lt;/i&gt;&quot; +
 54                     &quot; is &quot; + nameNode.value() + &quot;:&quot;));
 55         writer.println(&quot;&lt;td&gt;&quot; + comment() + &quot;&amp;nbsp;&quot;);
 56         writer.println(&quot;&lt;/tr&gt;&quot;);
 57 
 58         ++structIndent;
 59         super.document(writer);
 60         --structIndent;
 61     }
 62 
 63     String javaClassImplements() {
 64         return &quot; extends &quot; + select.commonBaseClass();
 65     }
 66 
 67     void genJavaClassSpecifics(PrintWriter writer, int depth) {
 68         indent(writer, depth);
 69         writer.print(&quot;static final &quot; + select.typeNode.javaType());
 70         writer.println(&quot; ALT_ID = &quot; + nameNode.value() + &quot;;&quot;);
 71         if (context.isWritingCommand()) {
 72             genJavaCreateMethod(writer, depth);
 73         } else {
 74             indent(writer, depth);
 75             writer.println(select.typeNode.javaParam() + &quot;() {&quot;);
 76             indent(writer, depth+1);
 77             writer.println(&quot;return ALT_ID;&quot;);
 78             indent(writer, depth);
 79             writer.println(&quot;}&quot;);
 80         }
 81         super.genJavaClassSpecifics(writer, depth);
 82     }
 83 
 84     void genJavaWriteMethod(PrintWriter writer, int depth) {
 85         genJavaWriteMethod(writer, depth, &quot;&quot;);
 86     }
 87 
 88     void genJavaReadsSelectCase(PrintWriter writer, int depth, String common) {
 89         indent(writer, depth);
 90         writer.println(&quot;case &quot; + nameNode.value() + &quot;:&quot;);
 91         indent(writer, depth+1);
 92         writer.println(common + &quot; = new &quot; + name + &quot;(vm, ps);&quot;);
 93         indent(writer, depth+1);
 94         writer.println(&quot;break;&quot;);
 95     }
 96 
 97     void genJavaCreateMethod(PrintWriter writer, int depth) {
 98         indent(writer, depth);
 99         writer.print(&quot;static &quot; + select.name() + &quot; create(&quot;);
100         writer.print(javaParams());
101         writer.println(&quot;) {&quot;);
102         indent(writer, depth+1);
103         writer.print(&quot;return new &quot; + select.name() + &quot;(&quot;);
104         writer.print(&quot;ALT_ID, new &quot; + javaClassName() + &quot;(&quot;);
105         for (Iterator&lt;Node&gt; it = components.iterator(); it.hasNext();) {
106             TypeNode tn = (TypeNode)it.next();
107             writer.print(tn.name());
108             if (it.hasNext()) {
109                 writer.print(&quot;, &quot;);
110             }
111         }
112         writer.println(&quot;));&quot;);
113         indent(writer, depth);
114         writer.println(&quot;}&quot;);
115     }
116 
117 }
    </pre>
  </body>
</html>