<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames make/jdk/src/classes/build/tools/jdwpgen/RepeatNode.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (c) 1998, 2013, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package build.tools.jdwpgen;
 27 
 28 import java.util.*;
 29 import java.io.*;
 30 
 31 class RepeatNode extends AbstractTypeNode {
 32 
 33     Node member = null;
 34 
 35     void constrain(Context ctx) {
 36         super.constrain(ctx);
 37         if (components.size() != 1) {
 38             error(&quot;Repeat must have exactly one member, use Group for more&quot;);
 39         }
 40         member = components.get(0);
 41         if (!(member instanceof TypeNode)) {
 42             error(&quot;Repeat member must be type specifier&quot;);
 43         }
 44     }
 45 
 46     void document(PrintWriter writer) {
<a name="1" id="anc1"></a><span class="line-modified"> 47         writer.println(&quot;&lt;tr&gt;&quot;);</span>
<span class="line-modified"> 48         writer.println(&quot;&lt;td&gt;&quot; + indentElement(structIndent, &quot;int&quot;));</span>
<span class="line-modified"> 49         writer.println(&quot;&lt;th scope=\&quot;row\&quot;&gt;&lt;i&gt;&quot; + name() + &quot;&lt;/i&gt;&quot;);</span>
<span class="line-modified"> 50         writer.println(&quot;&lt;td&gt;&quot; + comment() + &quot;&amp;nbsp;&quot;);</span>
<span class="line-modified"> 51         writer.println(&quot;&lt;/tr&gt;&quot;);</span>
<span class="line-modified"> 52 </span>
<span class="line-modified"> 53         writer.println(&quot;&lt;tr&gt;&quot;);</span>
<span class="line-modified"> 54         writer.println(&quot;&lt;th colspan=\&quot;3\&quot; scope=\&quot;rowgroup\&quot;&gt;&quot;</span>
<span class="line-modified"> 55                 + indentElement(structIndent, &quot;Repeated &lt;i&gt;&quot; + name() + &quot;&lt;/i&gt; times:&quot;));</span>
<span class="line-added"> 56         writer.println(&quot;&lt;/tr&gt;&quot;);</span>
<span class="line-added"> 57 </span>
 58         ++structIndent;
 59         member.document(writer);
 60         --structIndent;
 61     }
 62 
 63     String docType() {
 64         return &quot;-BOGUS-&quot;; // should never call this
 65     }
 66 
 67     String javaType() {
 68         return member.javaType() + &quot;[]&quot;;
 69     }
 70 
 71     public void genJavaWrite(PrintWriter writer, int depth,
 72                              String writeLabel) {
 73         genJavaDebugWrite(writer, depth, writeLabel, &quot;\&quot;\&quot;&quot;);
 74         indent(writer, depth);
 75         writer.println(&quot;ps.writeInt(&quot; + writeLabel + &quot;.length);&quot;);
 76         indent(writer, depth);
 77         writer.println(&quot;for (int i = 0; i &lt; &quot; + writeLabel + &quot;.length; i++) {;&quot;);
 78         ((TypeNode)member).genJavaWrite(writer, depth+1, writeLabel + &quot;[i]&quot;);
 79         indent(writer, depth);
 80         writer.println(&quot;}&quot;);
 81     }
 82 
 83     String javaRead() {
 84         error(&quot;Internal - Should not call RepeatNode.javaRead()&quot;);
 85         return &quot;&quot;;
 86     }
 87 
 88     public void genJavaRead(PrintWriter writer, int depth,
 89                             String readLabel) {
 90         genJavaDebugRead(writer, depth, readLabel, &quot;\&quot;\&quot;&quot;);
 91         String cntLbl = readLabel + &quot;Count&quot;;
 92         indent(writer, depth);
 93         writer.println(&quot;int &quot; + cntLbl + &quot; = ps.readInt();&quot;);
 94         indent(writer, depth);
 95         writer.println(readLabel + &quot; = new &quot; + member.javaType() +
 96                        &quot;[&quot; + cntLbl + &quot;];&quot;);
 97         indent(writer, depth);
 98         writer.println(&quot;for (int i = 0; i &lt; &quot; + cntLbl + &quot;; i++) {;&quot;);
 99         member.genJavaRead(writer, depth+1, readLabel + &quot;[i]&quot;);
100         indent(writer, depth);
101         writer.println(&quot;}&quot;);
102     }
103 }
<a name="2" id="anc2"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="2" type="hidden" />
</body>
</html>