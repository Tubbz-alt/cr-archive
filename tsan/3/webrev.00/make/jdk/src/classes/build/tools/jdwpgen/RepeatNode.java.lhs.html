<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames make/jdk/src/classes/build/tools/jdwpgen/RepeatNode.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (c) 1998, 2013, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package build.tools.jdwpgen;
 27 
 28 import java.util.*;
 29 import java.io.*;
 30 
 31 class RepeatNode extends AbstractTypeNode {
 32 
 33     Node member = null;
 34 
 35     void constrain(Context ctx) {
 36         super.constrain(ctx);
 37         if (components.size() != 1) {
 38             error(&quot;Repeat must have exactly one member, use Group for more&quot;);
 39         }
 40         member = components.get(0);
 41         if (!(member instanceof TypeNode)) {
 42             error(&quot;Repeat member must be type specifier&quot;);
 43         }
 44     }
 45 
 46     void document(PrintWriter writer) {
<a name="1" id="anc1"></a><span class="line-modified"> 47         docRowStart(writer);</span>
<span class="line-modified"> 48         writer.println(&quot;&lt;td colspan=&quot; +</span>
<span class="line-modified"> 49                        (maxStructIndent - structIndent) + &quot;&gt;&quot;);</span>
<span class="line-modified"> 50         writer.println(&quot;int&lt;td&gt;&lt;i&gt;&quot; + name + &quot;&lt;/i&gt;&lt;td&gt;&quot; +</span>
<span class="line-modified"> 51                        comment() + &quot;&amp;nbsp;&quot;);</span>
<span class="line-modified"> 52         docRowStart(writer);</span>
<span class="line-modified"> 53         writer.println(&quot;&lt;td colspan=&quot; +</span>
<span class="line-modified"> 54                        (maxStructIndent - structIndent + 2) + &quot;&gt;&quot;);</span>
<span class="line-modified"> 55         writer.println(&quot;Repeated &lt;i&gt;&quot; + name + &quot;&lt;/i&gt; times:&quot;);</span>


 56         ++structIndent;
 57         member.document(writer);
 58         --structIndent;
 59     }
 60 
 61     String docType() {
 62         return &quot;-BOGUS-&quot;; // should never call this
 63     }
 64 
 65     String javaType() {
 66         return member.javaType() + &quot;[]&quot;;
 67     }
 68 
 69     public void genJavaWrite(PrintWriter writer, int depth,
 70                              String writeLabel) {
 71         genJavaDebugWrite(writer, depth, writeLabel, &quot;\&quot;\&quot;&quot;);
 72         indent(writer, depth);
 73         writer.println(&quot;ps.writeInt(&quot; + writeLabel + &quot;.length);&quot;);
 74         indent(writer, depth);
 75         writer.println(&quot;for (int i = 0; i &lt; &quot; + writeLabel + &quot;.length; i++) {;&quot;);
 76         ((TypeNode)member).genJavaWrite(writer, depth+1, writeLabel + &quot;[i]&quot;);
 77         indent(writer, depth);
 78         writer.println(&quot;}&quot;);
 79     }
 80 
 81     String javaRead() {
 82         error(&quot;Internal - Should not call RepeatNode.javaRead()&quot;);
 83         return &quot;&quot;;
 84     }
 85 
 86     public void genJavaRead(PrintWriter writer, int depth,
 87                             String readLabel) {
 88         genJavaDebugRead(writer, depth, readLabel, &quot;\&quot;\&quot;&quot;);
 89         String cntLbl = readLabel + &quot;Count&quot;;
 90         indent(writer, depth);
 91         writer.println(&quot;int &quot; + cntLbl + &quot; = ps.readInt();&quot;);
 92         indent(writer, depth);
 93         writer.println(readLabel + &quot; = new &quot; + member.javaType() +
 94                        &quot;[&quot; + cntLbl + &quot;];&quot;);
 95         indent(writer, depth);
 96         writer.println(&quot;for (int i = 0; i &lt; &quot; + cntLbl + &quot;; i++) {;&quot;);
 97         member.genJavaRead(writer, depth+1, readLabel + &quot;[i]&quot;);
 98         indent(writer, depth);
 99         writer.println(&quot;}&quot;);
100     }
101 }
<a name="2" id="anc2"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="2" type="hidden" />
</body>
</html>