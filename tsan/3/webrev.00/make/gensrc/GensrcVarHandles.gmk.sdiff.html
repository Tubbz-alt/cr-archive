<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/gensrc/GensrcVarHandles.gmk</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="GensrcProperties.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="../hotspot/CopyToExplodedJdk.gmk.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/gensrc/GensrcVarHandles.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 #
<span class="line-modified">  2 # Copyright (c) 2015, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
142     $1_RawType := Long
143     $1_RawBoxType := Long
144 
145     $1_ARGS += -KCAS
146     $1_ARGS += -KfloatingPoint
147   endif
148 
149   $$($1_FILENAME): $(VARHANDLES_SRC_DIR)/X-VarHandleByteArrayView.java.template $(BUILD_TOOLS_JDK)
150 	$$(call MakeDir, $$(@D))
151 	$(RM) $$@
152 	$(TOOL_SPP) -nel -K$$($1_type) \
153 	    -Dtype=$$($1_type) -DType=$$($1_Type) -DBoxType=$$($1_BoxType) \
154 	    -DrawType=$$($1_rawType) -DRawType=$$($1_RawType) -DRawBoxType=$$($1_RawBoxType) \
155 	    $$($1_ARGS) -i$$&lt; -o$$@
156 
157   GENSRC_VARHANDLES += $$($1_FILENAME)
158 endef
159 
160 ################################################################################
161 






































































































162 # List the types to generate source for, with capitalized first letter
163 VARHANDLES_TYPES := Boolean Byte Short Char Int Long Float Double Reference
164 $(foreach t, $(VARHANDLES_TYPES), \
165   $(eval $(call GenerateVarHandle,VAR_HANDLE_$t,$t)))
166 
167 # List the types to generate source for, with capitalized first letter
168 VARHANDLES_BYTE_ARRAY_TYPES := Short Char Int Long Float Double
169 $(foreach t, $(VARHANDLES_BYTE_ARRAY_TYPES), \
170   $(eval $(call GenerateVarHandleByteArray,VAR_HANDLE_BYTE_ARRAY_$t,$t)))
171 





172 GENSRC_JAVA_BASE += $(GENSRC_VARHANDLES)
173 
174 # Include custom extension post hook
175 $(eval $(call IncludeCustomExtension, gensrc/GensrcVarHandles-post.gmk))
<span class="line-removed">176 </span>
</pre>
</td>
<td>
<hr />
<pre>
  1 #
<span class="line-modified">  2 # Copyright (c) 2015, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
142     $1_RawType := Long
143     $1_RawBoxType := Long
144 
145     $1_ARGS += -KCAS
146     $1_ARGS += -KfloatingPoint
147   endif
148 
149   $$($1_FILENAME): $(VARHANDLES_SRC_DIR)/X-VarHandleByteArrayView.java.template $(BUILD_TOOLS_JDK)
150 	$$(call MakeDir, $$(@D))
151 	$(RM) $$@
152 	$(TOOL_SPP) -nel -K$$($1_type) \
153 	    -Dtype=$$($1_type) -DType=$$($1_Type) -DBoxType=$$($1_BoxType) \
154 	    -DrawType=$$($1_rawType) -DRawType=$$($1_RawType) -DRawBoxType=$$($1_RawBoxType) \
155 	    $$($1_ARGS) -i$$&lt; -o$$@
156 
157   GENSRC_VARHANDLES += $$($1_FILENAME)
158 endef
159 
160 ################################################################################
161 
<span class="line-added">162 ################################################################################</span>
<span class="line-added">163 # Setup a rule for generating a VarHandleMemoryAddress java class</span>
<span class="line-added">164 # Param 1 - Variable declaration prefix</span>
<span class="line-added">165 # Param 2 - Type with first letter capitalized</span>
<span class="line-added">166 define GenerateVarHandleMemoryAddress</span>
<span class="line-added">167 </span>
<span class="line-added">168   $1_Type := $2</span>
<span class="line-added">169 </span>
<span class="line-added">170   $1_FILENAME := $(VARHANDLES_GENSRC_DIR)/VarHandleMemoryAddressAs$$($1_Type)s.java</span>
<span class="line-added">171 </span>
<span class="line-added">172   ifeq ($$($1_Type), Byte)</span>
<span class="line-added">173     $1_type := byte</span>
<span class="line-added">174     $1_BoxType := $$($1_Type)</span>
<span class="line-added">175 </span>
<span class="line-added">176     $1_rawType := $$($1_type)</span>
<span class="line-added">177     $1_RawType := $$($1_Type)</span>
<span class="line-added">178     $1_RawBoxType := $$($1_BoxType)</span>
<span class="line-added">179 </span>
<span class="line-added">180     $1_ARGS += -Kbyte</span>
<span class="line-added">181   endif</span>
<span class="line-added">182 </span>
<span class="line-added">183   ifeq ($$($1_Type), Short)</span>
<span class="line-added">184     $1_type := short</span>
<span class="line-added">185     $1_BoxType := $$($1_Type)</span>
<span class="line-added">186 </span>
<span class="line-added">187     $1_rawType := $$($1_type)</span>
<span class="line-added">188     $1_RawType := $$($1_Type)</span>
<span class="line-added">189     $1_RawBoxType := $$($1_BoxType)</span>
<span class="line-added">190   endif</span>
<span class="line-added">191 </span>
<span class="line-added">192   ifeq ($$($1_Type), Char)</span>
<span class="line-added">193     $1_type := char</span>
<span class="line-added">194     $1_BoxType := Character</span>
<span class="line-added">195 </span>
<span class="line-added">196     $1_rawType := $$($1_type)</span>
<span class="line-added">197     $1_RawType := $$($1_Type)</span>
<span class="line-added">198     $1_RawBoxType := $$($1_BoxType)</span>
<span class="line-added">199   endif</span>
<span class="line-added">200 </span>
<span class="line-added">201   ifeq ($$($1_Type), Int)</span>
<span class="line-added">202     $1_type := int</span>
<span class="line-added">203     $1_BoxType := Integer</span>
<span class="line-added">204 </span>
<span class="line-added">205     $1_rawType := $$($1_type)</span>
<span class="line-added">206     $1_RawType := $$($1_Type)</span>
<span class="line-added">207     $1_RawBoxType := $$($1_BoxType)</span>
<span class="line-added">208 </span>
<span class="line-added">209     $1_ARGS += -KCAS</span>
<span class="line-added">210     $1_ARGS += -KAtomicAdd</span>
<span class="line-added">211     $1_ARGS += -KBitwise</span>
<span class="line-added">212   endif</span>
<span class="line-added">213 </span>
<span class="line-added">214   ifeq ($$($1_Type), Long)</span>
<span class="line-added">215     $1_type := long</span>
<span class="line-added">216     $1_BoxType := $$($1_Type)</span>
<span class="line-added">217 </span>
<span class="line-added">218     $1_rawType := $$($1_type)</span>
<span class="line-added">219     $1_RawType := $$($1_Type)</span>
<span class="line-added">220     $1_RawBoxType := $$($1_BoxType)</span>
<span class="line-added">221 </span>
<span class="line-added">222     $1_ARGS += -KCAS</span>
<span class="line-added">223     $1_ARGS += -KAtomicAdd</span>
<span class="line-added">224     $1_ARGS += -KBitwise</span>
<span class="line-added">225   endif</span>
<span class="line-added">226 </span>
<span class="line-added">227   ifeq ($$($1_Type), Float)</span>
<span class="line-added">228     $1_type := float</span>
<span class="line-added">229     $1_BoxType := $$($1_Type)</span>
<span class="line-added">230 </span>
<span class="line-added">231     $1_rawType := int</span>
<span class="line-added">232     $1_RawType := Int</span>
<span class="line-added">233     $1_RawBoxType := Integer</span>
<span class="line-added">234 </span>
<span class="line-added">235     $1_ARGS += -KCAS</span>
<span class="line-added">236     $1_ARGS += -KfloatingPoint</span>
<span class="line-added">237   endif</span>
<span class="line-added">238 </span>
<span class="line-added">239   ifeq ($$($1_Type), Double)</span>
<span class="line-added">240     $1_type := double</span>
<span class="line-added">241     $1_BoxType := $$($1_Type)</span>
<span class="line-added">242 </span>
<span class="line-added">243     $1_rawType := long</span>
<span class="line-added">244     $1_RawType := Long</span>
<span class="line-added">245     $1_RawBoxType := Long</span>
<span class="line-added">246 </span>
<span class="line-added">247     $1_ARGS += -KCAS</span>
<span class="line-added">248     $1_ARGS += -KfloatingPoint</span>
<span class="line-added">249   endif</span>
<span class="line-added">250 </span>
<span class="line-added">251   $$($1_FILENAME): $(VARHANDLES_SRC_DIR)/X-VarHandleMemoryAddressView.java.template $(BUILD_TOOLS_JDK)</span>
<span class="line-added">252 	$$(call MakeDir, $$(@D))</span>
<span class="line-added">253 	$(RM) $$@</span>
<span class="line-added">254 	$(TOOL_SPP) -nel -K$$($1_type) \</span>
<span class="line-added">255 	    -Dtype=$$($1_type) -DType=$$($1_Type) -DBoxType=$$($1_BoxType) \</span>
<span class="line-added">256 	    -DrawType=$$($1_rawType) -DRawType=$$($1_RawType) -DRawBoxType=$$($1_RawBoxType) \</span>
<span class="line-added">257 	    $$($1_ARGS) -i$$&lt; -o$$@</span>
<span class="line-added">258 </span>
<span class="line-added">259   GENSRC_VARHANDLES += $$($1_FILENAME)</span>
<span class="line-added">260 endef</span>
<span class="line-added">261 </span>
<span class="line-added">262 ################################################################################</span>
<span class="line-added">263 </span>
264 # List the types to generate source for, with capitalized first letter
265 VARHANDLES_TYPES := Boolean Byte Short Char Int Long Float Double Reference
266 $(foreach t, $(VARHANDLES_TYPES), \
267   $(eval $(call GenerateVarHandle,VAR_HANDLE_$t,$t)))
268 
269 # List the types to generate source for, with capitalized first letter
270 VARHANDLES_BYTE_ARRAY_TYPES := Short Char Int Long Float Double
271 $(foreach t, $(VARHANDLES_BYTE_ARRAY_TYPES), \
272   $(eval $(call GenerateVarHandleByteArray,VAR_HANDLE_BYTE_ARRAY_$t,$t)))
273 
<span class="line-added">274 # List the types to generate source for, with capitalized first letter</span>
<span class="line-added">275 VARHANDLES_MEMORY_ADDRESS_TYPES := Byte Short Char Int Long Float Double</span>
<span class="line-added">276 $(foreach t, $(VARHANDLES_MEMORY_ADDRESS_TYPES), \</span>
<span class="line-added">277   $(eval $(call GenerateVarHandleMemoryAddress,VAR_HANDLE_MEMORY_ADDRESS_$t,$t)))</span>
<span class="line-added">278 </span>
279 GENSRC_JAVA_BASE += $(GENSRC_VARHANDLES)
280 
281 # Include custom extension post hook
282 $(eval $(call IncludeCustomExtension, gensrc/GensrcVarHandles-post.gmk))

</pre>
</td>
</tr>
</table>
<center><a href="GensrcProperties.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="../hotspot/CopyToExplodedJdk.gmk.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>