<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/gensrc/GensrcMisc.gmk</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="GensrcLocaleData.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="GensrcModuleInfo.gmk.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/gensrc/GensrcMisc.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 #
<span class="line-modified">  2 # Copyright (c) 2011, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 29 
 30 $(eval $(call SetupTextFileProcessing, BUILD_VERSION_JAVA, \
 31     SOURCE_FILES := $(TOPDIR)/src/java.base/share/classes/java/lang/VersionProps.java.template, \
 32     OUTPUT_FILE := $(SUPPORT_OUTPUTDIR)/gensrc/java.base/java/lang/VersionProps.java, \
 33     REPLACEMENTS := \
 34         @@LAUNCHER_NAME@@ =&gt; $(LAUNCHER_NAME) ; \
 35         @@RUNTIME_NAME@@ =&gt; $(RUNTIME_NAME) ; \
 36         @@VERSION_SHORT@@ =&gt; $(VERSION_SHORT) ; \
 37         @@VERSION_STRING@@ =&gt; $(VERSION_STRING) ; \
 38         @@VERSION_NUMBER@@ =&gt; $(VERSION_NUMBER) ; \
 39         @@VERSION_PRE@@ =&gt; $(VERSION_PRE) ; \
 40         @@VERSION_BUILD@@ =&gt; $(VERSION_BUILD) ; \
 41         @@VERSION_OPT@@ =&gt; $(VERSION_OPT) ; \
 42         @@VERSION_DATE@@ =&gt; $(VERSION_DATE) ; \
 43         @@VERSION_CLASSFILE_MAJOR@@ =&gt; $(VERSION_CLASSFILE_MAJOR) ; \
 44         @@VERSION_CLASSFILE_MINOR@@ =&gt; $(VERSION_CLASSFILE_MINOR) ; \
 45         @@VERSION_SPECIFICATION@@ =&gt; $(VERSION_SPECIFICATION) ; \
 46         @@VENDOR_VERSION_STRING@@ =&gt; $(VENDOR_VERSION_STRING) ; \
 47         @@VENDOR@@ =&gt; $(COMPANY_NAME) ; \
 48         @@VENDOR_URL@@ =&gt; $(VENDOR_URL) ; \
<span class="line-modified"> 49         @@VENDOR_URL_BUG@@ =&gt; $(VENDOR_URL_BUG), \</span>

 50 ))
 51 
 52 GENSRC_JAVA_BASE += $(BUILD_VERSION_JAVA)
 53 
 54 ################################################################################
 55 
 56 ifneq ($(filter $(TOOLCHAIN_TYPE), gcc clang), )
 57   # Need to specify language since the template file has a non standard
 58   # extension.
 59   CPP_FLAGS += -x c
 60 else ifeq ($(TOOLCHAIN_TYPE), microsoft)
 61   CPP_FLAGS += -nologo
 62 endif
 63 
 64 # Generate a java source file from a template through the C preprocessor for the
 65 # target system. First extract the copyright notice at the start of the file.
 66 # Run the preprocessor. Filter out the default compiler stderr output on
 67 # Windows. Filter out all the header files output. Remove all &quot;PREFIX_&quot; strings
 68 # that were added to variable references in the template files to avoid being
 69 # matched by the preprocessor. Remove any #line directives left by the
 70 # preprocessor.
 71 define generate-preproc-src
 72 	$(call MakeDir, $(@D))
<span class="line-modified"> 73 	( $(NAWK) &#39;/@@END_COPYRIGHT@@/{exit}1&#39; $&lt; &amp;&amp; \</span>
<span class="line-modified"> 74 	  $(CPP) $(CPP_FLAGS) $(SYSROOT_CFLAGS) $(CFLAGS_JDKLIB) $&lt; \</span>
<span class="line-modified"> 75 	      2&gt; &gt;($(GREP) -v &#39;^$(&lt;F)$$&#39; &gt;&amp;2) \</span>
<span class="line-modified"> 76 	      | $(NAWK) &#39;/@@START_HERE@@/,0&#39; \</span>
<span class="line-modified"> 77 	      |  $(SED) -e &#39;s/@@START_HERE@@/\/\/ AUTOMATICALLY GENERATED FILE - DO NOT EDIT/&#39; \</span>
<span class="line-modified"> 78 	      -e &#39;s/PREFIX_//&#39; -e &#39;s/^#.*//&#39; \</span>
<span class="line-modified"> 79 	) &gt; $@</span>


 80 endef
 81 
 82 GENSRC_SOR_FILE += $(SUPPORT_OUTPUTDIR)/gensrc/java.base/sun/nio/ch/SocketOptionRegistry.java
 83 
 84 $(GENSRC_SOR_FILE): \
 85     $(TOPDIR)/src/java.base/share/classes/sun/nio/ch/SocketOptionRegistry.java.template
 86 	$(generate-preproc-src)
 87 
 88 GENSRC_JAVA_BASE += $(GENSRC_SOR_FILE)
 89 
 90 ################################################################################
 91 
 92 ifeq ($(call isTargetOs, windows), false)
 93 
 94   GENSRC_UC_FILE := $(SUPPORT_OUTPUTDIR)/gensrc/java.base/sun/nio/fs/UnixConstants.java
 95 
 96   $(GENSRC_UC_FILE): \
 97       $(TOPDIR)/src/java.base/unix/classes/sun/nio/fs/UnixConstants.java.template
 98 	$(generate-preproc-src)
 99 
</pre>
</td>
<td>
<hr />
<pre>
  1 #
<span class="line-modified">  2 # Copyright (c) 2011, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 29 
 30 $(eval $(call SetupTextFileProcessing, BUILD_VERSION_JAVA, \
 31     SOURCE_FILES := $(TOPDIR)/src/java.base/share/classes/java/lang/VersionProps.java.template, \
 32     OUTPUT_FILE := $(SUPPORT_OUTPUTDIR)/gensrc/java.base/java/lang/VersionProps.java, \
 33     REPLACEMENTS := \
 34         @@LAUNCHER_NAME@@ =&gt; $(LAUNCHER_NAME) ; \
 35         @@RUNTIME_NAME@@ =&gt; $(RUNTIME_NAME) ; \
 36         @@VERSION_SHORT@@ =&gt; $(VERSION_SHORT) ; \
 37         @@VERSION_STRING@@ =&gt; $(VERSION_STRING) ; \
 38         @@VERSION_NUMBER@@ =&gt; $(VERSION_NUMBER) ; \
 39         @@VERSION_PRE@@ =&gt; $(VERSION_PRE) ; \
 40         @@VERSION_BUILD@@ =&gt; $(VERSION_BUILD) ; \
 41         @@VERSION_OPT@@ =&gt; $(VERSION_OPT) ; \
 42         @@VERSION_DATE@@ =&gt; $(VERSION_DATE) ; \
 43         @@VERSION_CLASSFILE_MAJOR@@ =&gt; $(VERSION_CLASSFILE_MAJOR) ; \
 44         @@VERSION_CLASSFILE_MINOR@@ =&gt; $(VERSION_CLASSFILE_MINOR) ; \
 45         @@VERSION_SPECIFICATION@@ =&gt; $(VERSION_SPECIFICATION) ; \
 46         @@VENDOR_VERSION_STRING@@ =&gt; $(VENDOR_VERSION_STRING) ; \
 47         @@VENDOR@@ =&gt; $(COMPANY_NAME) ; \
 48         @@VENDOR_URL@@ =&gt; $(VENDOR_URL) ; \
<span class="line-modified"> 49         @@VENDOR_URL_BUG@@ =&gt; $(VENDOR_URL_BUG) ; \</span>
<span class="line-added"> 50         @@VENDOR_URL_VM_BUG@@ =&gt; $(VENDOR_URL_VM_BUG), \</span>
 51 ))
 52 
 53 GENSRC_JAVA_BASE += $(BUILD_VERSION_JAVA)
 54 
 55 ################################################################################
 56 
 57 ifneq ($(filter $(TOOLCHAIN_TYPE), gcc clang), )
 58   # Need to specify language since the template file has a non standard
 59   # extension.
 60   CPP_FLAGS += -x c
 61 else ifeq ($(TOOLCHAIN_TYPE), microsoft)
 62   CPP_FLAGS += -nologo
 63 endif
 64 
 65 # Generate a java source file from a template through the C preprocessor for the
 66 # target system. First extract the copyright notice at the start of the file.
 67 # Run the preprocessor. Filter out the default compiler stderr output on
 68 # Windows. Filter out all the header files output. Remove all &quot;PREFIX_&quot; strings
 69 # that were added to variable references in the template files to avoid being
 70 # matched by the preprocessor. Remove any #line directives left by the
 71 # preprocessor.
 72 define generate-preproc-src
 73 	$(call MakeDir, $(@D))
<span class="line-modified"> 74 	$(call ExecuteWithLog, $(SUPPORT_OUTPUTDIR)/gensrc/java.base/_$(@F), \</span>
<span class="line-modified"> 75 	    ( $(NAWK) &#39;/@@END_COPYRIGHT@@/{exit}1&#39; $&lt; &amp;&amp; \</span>
<span class="line-modified"> 76 	      $(CPP) $(CPP_FLAGS) $(SYSROOT_CFLAGS) $(CFLAGS_JDKLIB) $&lt; \</span>
<span class="line-modified"> 77 	          2&gt; &gt;($(GREP) -v &#39;^$(&lt;F)$$&#39; &gt;&amp;2) \</span>
<span class="line-modified"> 78 	          | $(NAWK) &#39;/@@START_HERE@@/,0&#39; \</span>
<span class="line-modified"> 79 	          |  $(SED) -e &#39;s/@@START_HERE@@/\/\/ AUTOMATICALLY GENERATED FILE - DO NOT EDIT/&#39; \</span>
<span class="line-modified"> 80 	          -e &#39;s/PREFIX_//&#39; -e &#39;s/^#.*//&#39; \</span>
<span class="line-added"> 81 	    ) &gt; $@ \</span>
<span class="line-added"> 82 	)</span>
 83 endef
 84 
 85 GENSRC_SOR_FILE += $(SUPPORT_OUTPUTDIR)/gensrc/java.base/sun/nio/ch/SocketOptionRegistry.java
 86 
 87 $(GENSRC_SOR_FILE): \
 88     $(TOPDIR)/src/java.base/share/classes/sun/nio/ch/SocketOptionRegistry.java.template
 89 	$(generate-preproc-src)
 90 
 91 GENSRC_JAVA_BASE += $(GENSRC_SOR_FILE)
 92 
 93 ################################################################################
 94 
 95 ifeq ($(call isTargetOs, windows), false)
 96 
 97   GENSRC_UC_FILE := $(SUPPORT_OUTPUTDIR)/gensrc/java.base/sun/nio/fs/UnixConstants.java
 98 
 99   $(GENSRC_UC_FILE): \
100       $(TOPDIR)/src/java.base/unix/classes/sun/nio/fs/UnixConstants.java.template
101 	$(generate-preproc-src)
102 
</pre>
</td>
</tr>
</table>
<center><a href="GensrcLocaleData.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="GensrcModuleInfo.gmk.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>