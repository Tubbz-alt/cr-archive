<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff make/common/RMICompilation.gmk</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="ProcessMarkdown.gmk.udiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="SetupJavaCompilers.gmk.udiff.html" target="_top">next &gt;</a></center>    <h2>make/common/RMICompilation.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  #
<span class="udiff-line-modified-removed">- # Copyright (c) 2011, 2014, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+ # Copyright (c) 2011, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  #
  # This code is free software; you can redistribute it and/or modify it
  # under the terms of the GNU General Public License version 2 only, as
  # published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -33,10 +33,11 @@</span>
  #   CLASSES_DIR:=Directory where to look for classes
  #   STUB_CLASSES_DIR:=Directory in where to put stub classes
  #   RUN_V11:=Set to run rmic with -v1.1
  #   RUN_V12:=Set to run rmic with -v1.2
  #   KEEP_GENERATED:=Set to keep generated sources around
<span class="udiff-line-added">+ #   STUB_SOURCES_DIR:=Directory to put generated sources in</span>
  SetupRMICompilation = $(NamedParamsMacroTemplate)
  define SetupRMICompilationBody
  
    $1_DEP_FILE := $$($1_STUB_CLASSES_DIR)/_the.$1_rmic.generated
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -56,13 +57,20 @@</span>
  
    $1_TIE_BASE_FILES := $$(foreach f,$$($1_CLASSES_SLASH),$$(dir $$f)_$$(notdir $$f))
    $1_TIE_FILES := $$(addprefix $$($1_STUB_CLASSES_DIR)/org/omg/stub/,$$(addsuffix _Tie.class,$$($1_TIE_BASE_FILES)))
    $1_TIE_STDPKG_FILES := $$(addprefix $$($1_STUB_CLASSES_DIR)/,$$(addsuffix _Tie.class,$$($1_TIE_BASE_FILES)))
  
<span class="udiff-line-modified-removed">-   ifneq (,$$($1_KEEP_GENERATED))</span>
<span class="udiff-line-modified-added">+   ifneq ($$($1_KEEP_GENERATED), )</span>
      $1_ARGS += -keepgenerated
<span class="udiff-line-modified-removed">-     $1_TARGETS += $$(subst .class,.java,$$($1_TARGETS))</span>
<span class="udiff-line-modified-added">+     $1_JAVA_TARGETS := $$(subst .class,.java,$$($1_TARGETS))</span>
<span class="udiff-line-added">+     ifneq ($$($1_STUB_SOURCES_DIR), )</span>
<span class="udiff-line-added">+       # This is where the java files are created by rmic</span>
<span class="udiff-line-added">+       $1_JAVA_TARGETS_REL := $$(subst $$($1_STUB_CLASSES_DIR),, $$($1_JAVA_TARGETS))</span>
<span class="udiff-line-added">+       # This is where the caller wants the java files</span>
<span class="udiff-line-added">+       $1_JAVA_TARGETS := $$(addprefix $$($1_STUB_SOURCES_DIR), $$($1_JAVA_TARGETS_REL))</span>
<span class="udiff-line-added">+     endif</span>
<span class="udiff-line-added">+     $1_TARGETS += $$($1_JAVA_TARGETS)</span>
    endif
  
    $1_DOLLAR_SAFE_CLASSES := $$(subst $$$$,\$$$$,$$($1_CLASSES))
  
    $$($1_TARGETS): $$($1_DEP_FILE) $$($1_CLASS_FILES)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -70,15 +78,16 @@</span>
    $$($1_DEP_FILE): $$($1_CLASS_FILES)
  	$$(call LogInfo, Running rmic $$($1_ARGS) for $$($1_DOLLAR_SAFE_CLASSES))
  	$$(call MakeDir, $$($1_STUB_CLASSES_DIR))
  	$(RMIC) $$($1_ARGS) -classpath &quot;$$($1_CLASSES_DIR)&quot; \
  	    -d $$($1_STUB_CLASSES_DIR) $$($1_DOLLAR_SAFE_CLASSES); \
<span class="udiff-line-modified-removed">- 	if [ &quot;x$$($1_ARGS2)&quot; != &quot;x&quot; ]; then \</span>
<span class="udiff-line-modified-removed">- 	  $(ECHO) $(LOG_INFO) Running rmic $$($1_ARGS2) for $$($1_DOLLAR_SAFE_CLASSES) &amp;&amp; \</span>
<span class="udiff-line-modified-removed">- 	  $(RMIC) $$($1_ARGS2) -classpath &quot;$$($1_CLASSES_DIR)&quot; \</span>
<span class="udiff-line-modified-removed">- 	      -d $$($1_STUB_CLASSES_DIR) $$($1_DOLLAR_SAFE_CLASSES); \</span>
<span class="udiff-line-modified-removed">- 	fi; \</span>
<span class="udiff-line-modified-added">+ 	$$(if $$($1_STUB_SOURCES_DIR), \</span>
<span class="udiff-line-modified-added">+ 	  $$(foreach f, $$($1_JAVA_TARGETS_REL), \</span>
<span class="udiff-line-modified-added">+ 	    $(MKDIR) -p $$(dir $$($1_STUB_SOURCES_DIR)/$$f) ; \</span>
<span class="udiff-line-modified-added">+ 	    $(MV) $$($1_STUB_CLASSES_DIR)/$$f $$($1_STUB_SOURCES_DIR)/$$f ; \</span>
<span class="udiff-line-modified-added">+ 	  ) \</span>
<span class="udiff-line-added">+ 	) \</span>
  	$(TOUCH) $$@
  
  
    $1 := $$($1_TARGETS) $$($1_DEP_FILE)
  
</pre>
<center><a href="ProcessMarkdown.gmk.udiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="SetupJavaCompilers.gmk.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>