<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff make/CompileInterimLangtools.gmk</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
<body>
<center><a href="CompileDemos.gmk.udiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="CompileJavaModules.gmk.udiff.html" target="_top">next &gt;</a></center>    <h2>make/CompileInterimLangtools.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  #
<span class="udiff-line-modified-removed">- # Copyright (c) 2014, 2017, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+ # Copyright (c) 2014, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  #
  # This code is free software; you can redistribute it and/or modify it
  # under the terms of the GNU General Public License version 2 only, as
  # published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -47,10 +47,17 @@</span>
  	$(SED) $(INTERIM_MODULEINFO_PATTERN) $&lt; &gt; $@
  
  TARGETS += $(patsubst %, $(BUILDTOOLS_OUTPUTDIR)/gensrc/%/module-info.java, \
      $(INTERIM_LANGTOOLS_MODULES))
  
<span class="udiff-line-added">+ $(eval $(call SetupCopyFiles, COPY_PREVIEW_FEATURES, \</span>
<span class="udiff-line-added">+     FILES := $(TOPDIR)/src/java.base/share/classes/jdk/internal/PreviewFeature.java, \</span>
<span class="udiff-line-added">+     DEST := $(BUILDTOOLS_OUTPUTDIR)/gensrc/java.base.interim/jdk/internal/, \</span>
<span class="udiff-line-added">+ ))</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ TARGETS += $(COPY_PREVIEW_FEATURES)</span>
<span class="udiff-line-added">+ </span>
  ################################################################################
  # Setup the rules to build interim langtools, which is compiled by the boot
  # javac and can be run on the boot jdk. This will be used to compile the rest of
  # the product. Each module is compiled separately because a multi module setup
  # would require the source files to be copied into directories named after the
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -70,17 +77,20 @@</span>
        EXTRA_FILES := $(BUILDTOOLS_OUTPUTDIR)/gensrc/$1.interim/module-info.java, \
        COPY := .gif .png .xml .css .js javax.tools.JavaCompilerTool, \
        BIN := $(BUILDTOOLS_OUTPUTDIR)/interim_langtools_modules/$1.interim, \
        ADD_JAVAC_FLAGS := --module-path $(BUILDTOOLS_OUTPUTDIR)/interim_langtools_modules \
            $$(INTERIM_LANGTOOLS_ADD_EXPORTS) \
<span class="udiff-line-added">+           --patch-module java.base=$(BUILDTOOLS_OUTPUTDIR)/gensrc/java.base.interim \</span>
<span class="udiff-line-added">+           --add-exports java.base/jdk.internal=java.compiler.interim \</span>
<span class="udiff-line-added">+           --add-exports java.base/jdk.internal=jdk.compiler.interim \</span>
            -Xlint:-module, \
    ))
  
    $1_DEPS_INTERIM := $$(addsuffix .interim, $$(filter \
        $$(INTERIM_LANGTOOLS_BASE_MODULES), $$(call FindTransitiveDepsForModule, $1)))
  
<span class="udiff-line-modified-removed">-   $$(BUILD_$1.interim): $$(foreach d, $$($1_DEPS_INTERIM), $$(BUILD_$$d))</span>
<span class="udiff-line-modified-added">+   $$(BUILD_$1.interim): $$(foreach d, $$($1_DEPS_INTERIM), $$(BUILD_$$d)) $(COPY_PREVIEW_FEATURES)</span>
  
    TARGETS += $$(BUILD_$1.interim)
  endef
  
  $(foreach m, $(INTERIM_LANGTOOLS_BASE_MODULES), \
</pre>
<center><a href="CompileDemos.gmk.udiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="CompileJavaModules.gmk.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>