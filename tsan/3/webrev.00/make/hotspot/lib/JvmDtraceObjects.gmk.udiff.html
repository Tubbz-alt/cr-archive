<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff make/hotspot/lib/JvmDtraceObjects.gmk</title>
    <link rel="stylesheet" href="../../../style.css" />
  </head>
<body>
<center><a href="CompileJvm.gmk.udiff.html" target="_top">&lt; prev</a> <a href="../../../index.html" target="_top">index</a> <a href="JvmFeatures.gmk.udiff.html" target="_top">next &gt;</a></center>    <h2>make/hotspot/lib/JvmDtraceObjects.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  #
<span class="udiff-line-modified-removed">- # Copyright (c) 2013, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+ # Copyright (c) 2013, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  #
  # This code is free software; you can redistribute it and/or modify it
  # under the terms of the GNU General Public License version 2 only, as
  # published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -49,11 +49,13 @@</span>
          hotspot_jni.d \
          hotspot.d \
          hs_private.d \
      )
  
<span class="udiff-line-modified-removed">-     $(JVM_OUTPUTDIR)/objs/dtrace.d: $(DTRACE_SOURCE_FILES)</span>
<span class="udiff-line-modified-added">+     # *.d in the objs dir is used for generated make dependency files, so use</span>
<span class="udiff-line-added">+     # *.dt for dtrace files to avoid clashes.</span>
<span class="udiff-line-added">+     $(JVM_OUTPUTDIR)/objs/dtrace.dt: $(DTRACE_SOURCE_FILES)</span>
  	$(call LogInfo, Generating $(@F))
  	$(call MakeDir, $(@D))
  	$(CAT) $^ &gt; $@
  
      DTRACE_INSTRUMENTED_OBJS := $(addprefix $(JVM_OUTPUTDIR)/objs/, \
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -75,16 +77,10 @@</span>
          thread.o \
          unsafe.o \
          vmThread.o \
      )
  
<span class="udiff-line-removed">-     ifeq ($(call check-jvm-feature, cmsgc), true)</span>
<span class="udiff-line-removed">-       DTRACE_INSTRUMENTED_OBJS += $(addprefix $(JVM_OUTPUTDIR)/objs/, \</span>
<span class="udiff-line-removed">-           cmsVMOperations.o \</span>
<span class="udiff-line-removed">-       )</span>
<span class="udiff-line-removed">-     endif</span>
<span class="udiff-line-removed">- </span>
      ifeq ($(call check-jvm-feature, parallelgc), true)
        DTRACE_INSTRUMENTED_OBJS += $(addprefix $(JVM_OUTPUTDIR)/objs/, \
            psVMOperations.o \
        )
      endif
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -92,17 +88,17 @@</span>
      DTRACE_FLAGS := -64 -G
      DTRACE_CPP_FLAGS := -D_LP64
  
      # Make sure we run our selected compiler for preprocessing instead of letting
      # the dtrace tool pick it on it&#39;s own.
<span class="udiff-line-modified-removed">-     $(DTRACE_OBJ): $(JVM_OUTPUTDIR)/objs/dtrace.d $(DTRACE_INSTRUMENTED_OBJS)</span>
<span class="udiff-line-modified-added">+     $(DTRACE_OBJ): $(JVM_OUTPUTDIR)/objs/dtrace.dt $(DTRACE_INSTRUMENTED_OBJS)</span>
  	$(call LogInfo, Generating $(@F) from $(&lt;F) and object files)
  	$(call MakeDir, $(DTRACE_SUPPORT_DIR))
<span class="udiff-line-modified-removed">- 	$(call ExecuteWithLog, $(DTRACE_SUPPORT_DIR)/$(@F).d, \</span>
<span class="udiff-line-modified-removed">- 	    ($(CPP) $(DTRACE_CPP_FLAGS) $&lt; &gt; $(DTRACE_SUPPORT_DIR)/$(@F).d))</span>
<span class="udiff-line-modified-added">+ 	$(call ExecuteWithLog, $(DTRACE_SUPPORT_DIR)/$(@F).dt, \</span>
<span class="udiff-line-modified-added">+ 	    ($(CPP) $(DTRACE_CPP_FLAGS) $&lt; &gt; $(DTRACE_SUPPORT_DIR)/$(@F).dt))</span>
  	$(call ExecuteWithLog, $@, $(DTRACE) $(DTRACE_FLAGS) -xlazyload -o $@ \
<span class="udiff-line-modified-removed">- 	    -s $(DTRACE_SUPPORT_DIR)/$(@F).d $(sort $(DTRACE_INSTRUMENTED_OBJS)))</span>
<span class="udiff-line-modified-added">+ 	    -s $(DTRACE_SUPPORT_DIR)/$(@F).dt $(sort $(DTRACE_INSTRUMENTED_OBJS)))</span>
  
      ############################################################################
      # Generate DTRACE_JHELPER_OBJ which is linked with libjvm.so.
  
      JHELPER_DTRACE_SRC := $(TOPDIR)/src/hotspot/os/solaris/dtrace/jhelper.d
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -124,15 +120,15 @@</span>
      # Make sure we run our selected compiler for preprocessing instead of letting
      # the dtrace tool pick it on it&#39;s own.
      $(DTRACE_JHELPER_OBJ): $(JHELPER_DTRACE_SRC) $(JVM_OFFSETS_INDEX_H)
  	$(call LogInfo, Running dtrace for $(&lt;F))
  	$(call MakeDir, $(DTRACE_SUPPORT_DIR))
<span class="udiff-line-modified-removed">- 	$(call ExecuteWithLog, $(DTRACE_SUPPORT_DIR)/$(@F).d, \</span>
<span class="udiff-line-modified-added">+ 	$(call ExecuteWithLog, $(DTRACE_SUPPORT_DIR)/$(@F).dt, \</span>
  	    ($(CPP) $(DTRACE_CPP_FLAGS) -I$(DTRACE_GENSRC_DIR) $^ \
<span class="udiff-line-modified-removed">- 	    &gt; $(DTRACE_SUPPORT_DIR)/$(@F).d))</span>
<span class="udiff-line-modified-added">+ 	    &gt; $(DTRACE_SUPPORT_DIR)/$(@F).dt))</span>
  	$(call ExecuteWithLog, $@, $(DTRACE) $(DTRACE_FLAGS) -o $@ \
<span class="udiff-line-modified-removed">- 	    -s $(DTRACE_SUPPORT_DIR)/$(@F).d)</span>
<span class="udiff-line-modified-added">+ 	    -s $(DTRACE_SUPPORT_DIR)/$(@F).dt)</span>
          ifeq ($(call isTargetCpuArch, sparc), true)
  	  $(call ExecuteWithLog, $@.elfedit, $(ELFEDIT) $(call GetElfeditCommands) $@)
          endif
  
    endif
</pre>
<center><a href="CompileJvm.gmk.udiff.html" target="_top">&lt; prev</a> <a href="../../../index.html" target="_top">index</a> <a href="JvmFeatures.gmk.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>