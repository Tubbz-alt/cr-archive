<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff make/hotspot/lib/CompileJvm.gmk</title>
    <link rel="stylesheet" href="../../../style.css" />
  </head>
<body>
<center><a href="CompileGtest.gmk.udiff.html" target="_top">&lt; prev</a> <a href="../../../index.html" target="_top">index</a> <a href="JvmDtraceObjects.gmk.udiff.html" target="_top">next &gt;</a></center>    <h2>make/hotspot/lib/CompileJvm.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  #
<span class="udiff-line-modified-removed">- # Copyright (c) 2013, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+ # Copyright (c) 2013, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  #
  # This code is free software; you can redistribute it and/or modify it
  # under the terms of the GNU General Public License version 2 only, as
  # published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -45,19 +45,21 @@</span>
      $(SHARED_LIBRARY_FLAGS) \
      $(JVM_LDFLAGS_FEATURES) \
      $(EXTRA_LDFLAGS) \
      #
  
<span class="udiff-line-added">+ JVM_ASFLAGS += $(EXTRA_ASFLAGS)</span>
<span class="udiff-line-added">+ </span>
  JVM_LIBS += \
      $(JVM_LIBS_FEATURES) \
      #
  
  # These files and directories are always excluded
  JVM_EXCLUDE_FILES += args.cc
  JVM_EXCLUDES += adlc
  
<span class="udiff-line-modified-removed">- # Needed by vm_version.cpp</span>
<span class="udiff-line-modified-added">+ # Needed by abstract_vm_version.cpp</span>
  ifeq ($(call isTargetCpu, x86_64), true)
    OPENJDK_TARGET_CPU_VM_VERSION := amd64
  else ifeq ($(call isTargetCpu, sparcv9), true)
    OPENJDK_TARGET_CPU_VM_VERSION := sparc
  else
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -74,31 +76,31 @@</span>
      #
  
  ################################################################################
  # Disabled warnings
  
<span class="udiff-line-modified-removed">- DISABLED_WARNINGS_gcc := extra parentheses comment unknown-pragmas address \</span>
<span class="udiff-line-modified-added">+ DISABLED_WARNINGS_gcc := parentheses comment unknown-pragmas address \</span>
      delete-non-virtual-dtor char-subscripts array-bounds int-in-bool-context \
      ignored-qualifiers  missing-field-initializers implicit-fallthrough \
      empty-body strict-overflow sequence-point maybe-uninitialized \
<span class="udiff-line-modified-removed">-     misleading-indentation</span>
<span class="udiff-line-modified-added">+     misleading-indentation cast-function-type invalid-offsetof</span>
  
  ifeq ($(call check-jvm-feature, zero), true)
<span class="udiff-line-modified-removed">-   DISABLED_WARNINGS_gcc += return-type switch</span>
<span class="udiff-line-modified-added">+   DISABLED_WARNINGS_gcc += return-type switch clobbered</span>
  endif
  
  DISABLED_WARNINGS_clang := tautological-compare \
      undefined-var-template sometimes-uninitialized unknown-pragmas \
      delete-non-virtual-dtor missing-braces char-subscripts \
<span class="udiff-line-modified-removed">-     ignored-qualifiers missing-field-initializers mismatched-tags</span>
<span class="udiff-line-modified-added">+     ignored-qualifiers missing-field-initializers mismatched-tags \</span>
<span class="udiff-line-added">+     invalid-offsetof</span>
  
  DISABLED_WARNINGS_solstudio := labelnotused hidef w_novirtualdescr inlafteruse \
      unknownpragma doubunder w_enumnotused w_toomanyenumnotused \
      wvarhidenmem wunreachable wnoretvalue notemsource
  
<span class="udiff-line-modified-removed">- DISABLED_WARNINGS_xlc := 1540-0216 1540-0198 1540-1090 1540-1639 1540-1088 \</span>
<span class="udiff-line-removed">-     1500-010</span>
<span class="udiff-line-modified-added">+ DISABLED_WARNINGS_xlc := tautological-compare shift-negative-value</span>
  
  DISABLED_WARNINGS_microsoft :=
  
  
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -165,11 +167,11 @@</span>
  # parameter to SetupNativeCompilation allows an empty value to override the
  # default.
  JVM_STRIPFLAGS ?= $(STRIPFLAGS)
  
  # This source set is reused so save in cache.
<span class="udiff-line-modified-removed">- $(eval $(call FillCacheFind, $(JVM_SRC_DIRS)))</span>
<span class="udiff-line-modified-added">+ $(call FillFindCache, $(JVM_SRC_DIRS))</span>
  
  ################################################################################
  # Now set up the actual compilation of the main hotspot native library
  
  $(eval $(call SetupNativeCompilation, BUILD_LIBJVM, \
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -180,11 +182,11 @@</span>
      EXCLUDES := $(JVM_EXCLUDES), \
      EXCLUDE_FILES := $(JVM_EXCLUDE_FILES), \
      EXCLUDE_PATTERNS := $(JVM_EXCLUDE_PATTERNS), \
      EXTRA_OBJECT_FILES := $(DTRACE_EXTRA_OBJECT_FILES), \
      CFLAGS := $(JVM_CFLAGS), \
<span class="udiff-line-modified-removed">-     vm_version.cpp_CXXFLAGS := $(CFLAGS_VM_VERSION), \</span>
<span class="udiff-line-modified-added">+     abstract_vm_version.cpp_CXXFLAGS := $(CFLAGS_VM_VERSION), \</span>
      arguments.cpp_CXXFLAGS := $(CFLAGS_VM_VERSION), \
      DISABLED_WARNINGS_gcc := $(DISABLED_WARNINGS_gcc), \
      DISABLED_WARNINGS_clang := $(DISABLED_WARNINGS_clang), \
      DISABLED_WARNINGS_solstudio := $(DISABLED_WARNINGS_solstudio), \
      DISABLED_WARNINGS_xlc := $(DISABLED_WARNINGS_xlc), \
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -200,17 +202,18 @@</span>
      EMBED_MANIFEST := true, \
      RC_FLAGS := $(JVM_RCFLAGS), \
      VERSIONINFO_RESOURCE := $(TOPDIR)/src/hotspot/os/windows/version.rc, \
      PRECOMPILED_HEADER := $(JVM_PRECOMPILED_HEADER), \
      PRECOMPILED_HEADER_EXCLUDE := $(JVM_PRECOMPILED_HEADER_EXCLUDE), \
<span class="udiff-line-added">+     DEFINE_THIS_FILE := false, \</span>
  ))
  
<span class="udiff-line-modified-removed">- # Always recompile vm_version.cpp if libjvm needs to be relinked. This ensures</span>
<span class="udiff-line-modified-added">+ # Always recompile abstract_vm_version.cpp if libjvm needs to be relinked. This ensures</span>
  # that the internal vm version is updated as it relies on __DATE__ and __TIME__
  # macros.
<span class="udiff-line-modified-removed">- VM_VERSION_OBJ := $(JVM_OUTPUTDIR)/objs/vm_version$(OBJ_SUFFIX)</span>
<span class="udiff-line-modified-removed">- $(VM_VERSION_OBJ): $(filter-out $(VM_VERSION_OBJ) $(JVM_MAPFILE), \</span>
<span class="udiff-line-modified-added">+ ABSTRACT_VM_VERSION_OBJ := $(JVM_OUTPUTDIR)/objs/abstract_vm_version$(OBJ_SUFFIX)</span>
<span class="udiff-line-modified-added">+ $(ABSTRACT_VM_VERSION_OBJ): $(filter-out $(ABSTRACT_VM_VERSION_OBJ) $(JVM_MAPFILE), \</span>
      $(BUILD_LIBJVM_TARGET_DEPS))
  
  ifneq ($(GENERATE_COMPILE_COMMANDS_ONLY), true)
    ifeq ($(call isTargetOs, windows), true)
      # It doesn&#39;t matter which jvm.lib file gets exported, but we need
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -257,10 +260,19 @@</span>
  # -S print source code, intermixed with disassembly
  # -l include filenames and line numbers
  #
  # Search the output for the operator(s) of interest, to see where they are
  # referenced.
<span class="udiff-line-added">+ #</span>
<span class="udiff-line-added">+ # When a reference to the global &#39;operator delete&#39; is reported, it might be</span>
<span class="udiff-line-added">+ # due to a &quot;deleting destructor&quot;.  In this case, objdump may show the</span>
<span class="udiff-line-added">+ # reference to be associated with but not actually in a destructor.  A</span>
<span class="udiff-line-added">+ # deleting destructor is automatically generated for a class whose destructor</span>
<span class="udiff-line-added">+ # is virtual.  A deleting destructor requires an accessible &#39;operator delete&#39;</span>
<span class="udiff-line-added">+ # for the associated class.  If the class doesn&#39;t provide a more specific</span>
<span class="udiff-line-added">+ # declaration (either directly or by inheriting from a class that provides</span>
<span class="udiff-line-added">+ # one) then the global definition will be used, triggering this check.</span>
  
  ifneq ($(GENERATE_COMPILE_COMMANDS_ONLY), true)
    ifneq ($(filter $(TOOLCHAIN_TYPE), gcc clang solstudio), )
  
      DEMANGLED_REGEXP := [^:]operator (new|delete)
</pre>
<center><a href="CompileGtest.gmk.udiff.html" target="_top">&lt; prev</a> <a href="../../../index.html" target="_top">index</a> <a href="JvmDtraceObjects.gmk.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>