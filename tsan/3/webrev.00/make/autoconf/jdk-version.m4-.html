<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old make/autoconf/jdk-version.m4</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
  <body>
    <pre>
  1 #
  2 # Copyright (c) 2015, 2018, Oracle and/or its affiliates. All rights reserved.
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
 23 # questions.
 24 #
 25 
 26 ###############################################################################
 27 #
 28 # Setup version numbers
 29 #
 30 
 31 # Verify that a given string represents a valid version number, and assign it
 32 # to a variable.
 33 
 34 # Argument 1: the variable to assign to
 35 # Argument 2: the value given by the user
 36 AC_DEFUN([JDKVER_CHECK_AND_SET_NUMBER],
 37 [
 38   # Additional [] needed to keep m4 from mangling shell constructs.
 39   if [ ! [[ &quot;$2&quot; =~ ^0*([1-9][0-9]*)|(0)$ ]] ] ; then
 40     AC_MSG_ERROR([&quot;$2&quot; is not a valid numerical value for $1])
 41   fi
 42   # Extract the version number without leading zeros.
 43   cleaned_value=${BASH_REMATCH[[1]]}
 44   if test &quot;x$cleaned_value&quot; = x; then
 45     # Special case for zero
 46     cleaned_value=${BASH_REMATCH[[2]]}
 47   fi
 48 
 49   if test $cleaned_value -gt 255; then
 50     AC_MSG_ERROR([$1 is given as $2. This is greater than 255 which is not allowed.])
 51   fi
 52   if test &quot;x$cleaned_value&quot; != &quot;x$2&quot;; then
 53     AC_MSG_WARN([Value for $1 has been sanitized from &#39;$2&#39; to &#39;$cleaned_value&#39;])
 54   fi
 55   $1=$cleaned_value
 56 ])
 57 
 58 AC_DEFUN_ONCE([JDKVER_SETUP_JDK_VERSION_NUMBERS],
 59 [
 60   # Source the version numbers file
 61   . $AUTOCONF_DIR/version-numbers
 62 
 63   # Some non-version number information is set in that file
 64   AC_SUBST(LAUNCHER_NAME)
 65   AC_SUBST(PRODUCT_NAME)
 66   AC_SUBST(PRODUCT_SUFFIX)
 67   AC_SUBST(JDK_RC_PLATFORM_NAME)
 68   AC_SUBST(HOTSPOT_VM_DISTRO)
 69   AC_SUBST(MACOSX_BUNDLE_NAME_BASE)
 70   AC_SUBST(MACOSX_BUNDLE_ID_BASE)
 71 
 72   # The vendor name, if any
 73   AC_ARG_WITH(vendor-name, [AS_HELP_STRING([--with-vendor-name],
 74       [Set vendor name. Among others, used to set the &#39;java.vendor&#39;
 75        and &#39;java.vm.vendor&#39; system properties. @&lt;:@not specified@:&gt;@])])
 76   if test &quot;x$with_vendor_name&quot; = xyes; then
 77     AC_MSG_ERROR([--with-vendor-name must have a value])
 78   elif [ ! [[ $with_vendor_name =~ ^[[:print:]]*$ ]] ]; then
 79     AC_MSG_ERROR([--with-vendor-name contains non-printing characters: $with_vendor_name])
 80   elif test &quot;x$with_vendor_name&quot; != x; then
 81     # Only set COMPANY_NAME if &#39;--with-vendor-name&#39; was used and is not empty.
 82     # Otherwise we will use the value from &quot;version-numbers&quot; included above.
 83     COMPANY_NAME=&quot;$with_vendor_name&quot;
 84   fi
 85   AC_SUBST(COMPANY_NAME)
 86 
 87   # The vendor URL, if any
 88   AC_ARG_WITH(vendor-url, [AS_HELP_STRING([--with-vendor-url],
 89       [Set the &#39;java.vendor.url&#39; system property @&lt;:@not specified@:&gt;@])])
 90   if test &quot;x$with_vendor_url&quot; = xyes; then
 91     AC_MSG_ERROR([--with-vendor-url must have a value])
 92   elif [ ! [[ $with_vendor_url =~ ^[[:print:]]*$ ]] ]; then
 93     AC_MSG_ERROR([--with-vendor-url contains non-printing characters: $with_vendor_url])
 94   elif test &quot;x$with_vendor_url&quot; != x; then
 95     # Only set VENDOR_URL if &#39;--with-vendor-url&#39; was used and is not empty.
 96     # Otherwise we will use the value from &quot;version-numbers&quot; included above.
 97     VENDOR_URL=&quot;$with_vendor_url&quot;
 98   fi
 99   AC_SUBST(VENDOR_URL)
100 
101   # The vendor bug URL, if any
102   AC_ARG_WITH(vendor-bug-url, [AS_HELP_STRING([--with-vendor-bug-url],
103       [Set the &#39;java.vendor.url.bug&#39; system property @&lt;:@not specified@:&gt;@])])
104   if test &quot;x$with_vendor_bug_url&quot; = xyes; then
105     AC_MSG_ERROR([--with-vendor-bug-url must have a value])
106   elif [ ! [[ $with_vendor_bug_url =~ ^[[:print:]]*$ ]] ]; then
107     AC_MSG_ERROR([--with-vendor-bug-url contains non-printing characters: $with_vendor_bug_url])
108   elif test &quot;x$with_vendor_bug_url&quot; != x; then
109     # Only set VENDOR_URL_BUG if &#39;--with-vendor-bug-url&#39; was used and is not empty.
110     # Otherwise we will use the value from &quot;version-numbers&quot; included above.
111     VENDOR_URL_BUG=&quot;$with_vendor_bug_url&quot;
112   fi
113   AC_SUBST(VENDOR_URL_BUG)
114 
115   # The vendor VM bug URL, if any
116   AC_ARG_WITH(vendor-vm-bug-url, [AS_HELP_STRING([--with-vendor-vm-bug-url],
117       [Sets the bug URL which will be displayed when the VM crashes @&lt;:@not specified@:&gt;@])])
118   if test &quot;x$with_vendor_vm_bug_url&quot; = xyes; then
119     AC_MSG_ERROR([--with-vendor-vm-bug-url must have a value])
120   elif [ ! [[ $with_vendor_vm_bug_url =~ ^[[:print:]]*$ ]] ]; then
121     AC_MSG_ERROR([--with-vendor-vm-bug-url contains non-printing characters: $with_vendor_vm_bug_url])
122   else
123     VENDOR_URL_VM_BUG=&quot;$with_vendor_vm_bug_url&quot;
124   fi
125   AC_SUBST(VENDOR_URL_VM_BUG)
126 
127   # Override version from arguments
128 
129   # If --with-version-string is set, process it first. It is possible to
130   # override parts with more specific flags, since these are processed later.
131   AC_ARG_WITH(version-string, [AS_HELP_STRING([--with-version-string],
132       [Set version string @&lt;:@calculated@:&gt;@])])
133   if test &quot;x$with_version_string&quot; = xyes; then
134     AC_MSG_ERROR([--with-version-string must have a value])
135   elif test &quot;x$with_version_string&quot; != x; then
136     # Additional [] needed to keep m4 from mangling shell constructs.
137     if [ [[ $with_version_string =~ ^([0-9]+)(\.([0-9]+))?(\.([0-9]+))?(\.([0-9]+))?(\.([0-9]+))?(\.([0-9]+))?(\.([0-9]+))?(-([a-zA-Z]+))?((\+)([0-9]+)?(-([-a-zA-Z0-9.]+))?)?$ ]] ]; then
138       VERSION_FEATURE=${BASH_REMATCH[[1]]}
139       VERSION_INTERIM=${BASH_REMATCH[[3]]}
140       VERSION_UPDATE=${BASH_REMATCH[[5]]}
141       VERSION_PATCH=${BASH_REMATCH[[7]]}
142       VERSION_EXTRA1=${BASH_REMATCH[[9]]}
143       VERSION_EXTRA2=${BASH_REMATCH[[11]]}
144       VERSION_EXTRA3=${BASH_REMATCH[[13]]}
145       VERSION_PRE=${BASH_REMATCH[[15]]}
146       version_plus_separator=${BASH_REMATCH[[17]]}
147       VERSION_BUILD=${BASH_REMATCH[[18]]}
148       VERSION_OPT=${BASH_REMATCH[[20]]}
149       # Unspecified numerical fields are interpreted as 0.
150       if test &quot;x$VERSION_INTERIM&quot; = x; then
151         VERSION_INTERIM=0
152       fi
153       if test &quot;x$VERSION_UPDATE&quot; = x; then
154         VERSION_UPDATE=0
155       fi
156       if test &quot;x$VERSION_PATCH&quot; = x; then
157         VERSION_PATCH=0
158       fi
159       if test &quot;x$VERSION_EXTRA1&quot; = x; then
160         VERSION_EXTRA1=0
161       fi
162       if test &quot;x$VERSION_EXTRA2&quot; = x; then
163         VERSION_EXTRA2=0
164       fi
165       if test &quot;x$VERSION_EXTRA3&quot; = x; then
166         VERSION_EXTRA3=0
167       fi
168       if test &quot;x$version_plus_separator&quot; != x \
169           &amp;&amp; test &quot;x$VERSION_BUILD$VERSION_OPT&quot; = x; then
170         AC_MSG_ERROR([Version string contains + but both &#39;BUILD&#39; and &#39;OPT&#39; are missing])
171       fi
172       # Stop the version part process from setting default values.
173       # We still allow them to explicitly override though.
174       NO_DEFAULT_VERSION_PARTS=true
175     else
176       AC_MSG_ERROR([--with-version-string fails to parse as a valid version string: $with_version_string])
177     fi
178   fi
179 
180   AC_ARG_WITH(version-pre, [AS_HELP_STRING([--with-version-pre],
181       [Set the base part of the version &#39;PRE&#39; field (pre-release identifier) @&lt;:@&#39;internal&#39;@:&gt;@])],
182       [with_version_pre_present=true], [with_version_pre_present=false])
183 
184   if test &quot;x$with_version_pre_present&quot; = xtrue; then
185     if test &quot;x$with_version_pre&quot; = xyes; then
186       AC_MSG_ERROR([--with-version-pre must have a value])
187     elif test &quot;x$with_version_pre&quot; = xno; then
188       # Interpret --without-* as empty string instead of the literal &quot;no&quot;
189       VERSION_PRE=
190     else
191       # Only [a-zA-Z] is allowed in the VERSION_PRE. Outer [ ] to quote m4.
192       [ VERSION_PRE=`$ECHO &quot;$with_version_pre&quot; | $TR -c -d &#39;[a-z][A-Z]&#39;` ]
193       if test &quot;x$VERSION_PRE&quot; != &quot;x$with_version_pre&quot;; then
194         AC_MSG_WARN([--with-version-pre value has been sanitized from &#39;$with_version_pre&#39; to &#39;$VERSION_PRE&#39;])
195       fi
196     fi
197   else
198     if test &quot;x$NO_DEFAULT_VERSION_PARTS&quot; != xtrue; then
199       # Default is to use &quot;internal&quot; as pre
200       VERSION_PRE=&quot;internal&quot;
201     fi
202   fi
203 
204   AC_ARG_WITH(version-opt, [AS_HELP_STRING([--with-version-opt],
205       [Set version &#39;OPT&#39; field (build metadata) @&lt;:@&lt;timestamp&gt;.&lt;user&gt;.&lt;dirname&gt;@:&gt;@])],
206       [with_version_opt_present=true], [with_version_opt_present=false])
207 
208   if test &quot;x$with_version_opt_present&quot; = xtrue; then
209     if test &quot;x$with_version_opt&quot; = xyes; then
210       AC_MSG_ERROR([--with-version-opt must have a value])
211     elif test &quot;x$with_version_opt&quot; = xno; then
212       # Interpret --without-* as empty string instead of the literal &quot;no&quot;
213       VERSION_OPT=
214     else
215       # Only [-.a-zA-Z0-9] is allowed in the VERSION_OPT. Outer [ ] to quote m4.
216       [ VERSION_OPT=`$ECHO &quot;$with_version_opt&quot; | $TR -c -d &#39;[a-z][A-Z][0-9].-&#39;` ]
217       if test &quot;x$VERSION_OPT&quot; != &quot;x$with_version_opt&quot;; then
218         AC_MSG_WARN([--with-version-opt value has been sanitized from &#39;$with_version_opt&#39; to &#39;$VERSION_OPT&#39;])
219       fi
220     fi
221   else
222     if test &quot;x$NO_DEFAULT_VERSION_PARTS&quot; != xtrue; then
223       # Default is to calculate a string like this &#39;adhoc.&lt;username&gt;.&lt;base dir name&gt;&#39;
224       # Outer [ ] to quote m4.
225       [ basedirname=`$BASENAME &quot;$TOPDIR&quot; | $TR -d -c &#39;[a-z][A-Z][0-9].-&#39;` ]
226       VERSION_OPT=&quot;adhoc.$USERNAME.$basedirname&quot;
227     fi
228   fi
229 
230   AC_ARG_WITH(version-build, [AS_HELP_STRING([--with-version-build],
231       [Set version &#39;BUILD&#39; field (build number) @&lt;:@not specified@:&gt;@])],
232       [with_version_build_present=true], [with_version_build_present=false])
233 
234   if test &quot;x$with_version_build_present&quot; = xtrue; then
235     if test &quot;x$with_version_build&quot; = xyes; then
236       AC_MSG_ERROR([--with-version-build must have a value])
237     elif test &quot;x$with_version_build&quot; = xno; then
238       # Interpret --without-* as empty string instead of the literal &quot;no&quot;
239       VERSION_BUILD=
240     elif test &quot;x$with_version_build&quot; = x; then
241       VERSION_BUILD=
242     else
243       JDKVER_CHECK_AND_SET_NUMBER(VERSION_BUILD, $with_version_build)
244     fi
245   else
246     if test &quot;x$NO_DEFAULT_VERSION_PARTS&quot; != xtrue; then
247       # Default is to not have a build number.
248       VERSION_BUILD=&quot;&quot;
249       # FIXME: Until all code can cope with an empty VERSION_BUILD, set it to 0.
250       VERSION_BUILD=0
251     fi
252   fi
253 
254   AC_ARG_WITH(version-feature, [AS_HELP_STRING([--with-version-feature],
255       [Set version &#39;FEATURE&#39; field (first number) @&lt;:@current source value@:&gt;@])],
256       [with_version_feature_present=true], [with_version_feature_present=false])
257 
258   if test &quot;x$with_version_feature_present&quot; = xtrue; then
259     if test &quot;x$with_version_feature&quot; = xyes; then
260       AC_MSG_ERROR([--with-version-feature must have a value])
261     else
262       JDKVER_CHECK_AND_SET_NUMBER(VERSION_FEATURE, $with_version_feature)
263     fi
264   else
265     if test &quot;x$NO_DEFAULT_VERSION_PARTS&quot; != xtrue; then
266       # Default is to get value from version-numbers
267       VERSION_FEATURE=&quot;$DEFAULT_VERSION_FEATURE&quot;
268     fi
269   fi
270 
271   AC_ARG_WITH(version-interim, [AS_HELP_STRING([--with-version-interim],
272       [Set version &#39;INTERIM&#39; field (second number) @&lt;:@current source value@:&gt;@])],
273       [with_version_interim_present=true], [with_version_interim_present=false])
274 
275   if test &quot;x$with_version_interim_present&quot; = xtrue; then
276     if test &quot;x$with_version_interim&quot; = xyes; then
277       AC_MSG_ERROR([--with-version-interim must have a value])
278     elif test &quot;x$with_version_interim&quot; = xno; then
279       # Interpret --without-* as empty string (i.e. 0) instead of the literal &quot;no&quot;
280       VERSION_INTERIM=0
281     elif test &quot;x$with_version_interim&quot; = x; then
282       VERSION_INTERIM=0
283     else
284       JDKVER_CHECK_AND_SET_NUMBER(VERSION_INTERIM, $with_version_interim)
285     fi
286   else
287     if test &quot;x$NO_DEFAULT_VERSION_PARTS&quot; != xtrue; then
288       # Default is 0, if unspecified
289       VERSION_INTERIM=$DEFAULT_VERSION_INTERIM
290     fi
291   fi
292 
293   AC_ARG_WITH(version-update, [AS_HELP_STRING([--with-version-update],
294       [Set version &#39;UPDATE&#39; field (third number) @&lt;:@current source value@:&gt;@])],
295       [with_version_update_present=true], [with_version_update_present=false])
296 
297   if test &quot;x$with_version_update_present&quot; = xtrue; then
298     if test &quot;x$with_version_update&quot; = xyes; then
299       AC_MSG_ERROR([--with-version-update must have a value])
300     elif test &quot;x$with_version_update&quot; = xno; then
301       # Interpret --without-* as empty string (i.e. 0) instead of the literal &quot;no&quot;
302       VERSION_UPDATE=0
303     elif test &quot;x$with_version_update&quot; = x; then
304       VERSION_UPDATE=0
305     else
306       JDKVER_CHECK_AND_SET_NUMBER(VERSION_UPDATE, $with_version_update)
307     fi
308   else
309     if test &quot;x$NO_DEFAULT_VERSION_PARTS&quot; != xtrue; then
310       # Default is 0, if unspecified
311       VERSION_UPDATE=$DEFAULT_VERSION_UPDATE
312     fi
313   fi
314 
315   AC_ARG_WITH(version-patch, [AS_HELP_STRING([--with-version-patch],
316       [Set version &#39;PATCH&#39; field (fourth number) @&lt;:@not specified@:&gt;@])],
317       [with_version_patch_present=true], [with_version_patch_present=false])
318 
319   if test &quot;x$with_version_patch_present&quot; = xtrue; then
320     if test &quot;x$with_version_patch&quot; = xyes; then
321       AC_MSG_ERROR([--with-version-patch must have a value])
322     elif test &quot;x$with_version_patch&quot; = xno; then
323       # Interpret --without-* as empty string (i.e. 0) instead of the literal &quot;no&quot;
324       VERSION_PATCH=0
325     elif test &quot;x$with_version_patch&quot; = x; then
326       VERSION_PATCH=0
327     else
328       JDKVER_CHECK_AND_SET_NUMBER(VERSION_PATCH, $with_version_patch)
329     fi
330   else
331     if test &quot;x$NO_DEFAULT_VERSION_PARTS&quot; != xtrue; then
332       # Default is 0, if unspecified
333       VERSION_PATCH=$DEFAULT_VERSION_PATCH
334     fi
335   fi
336 
337   # The 1st version extra number, if any
338   AC_ARG_WITH(version-extra1, [AS_HELP_STRING([--with-version-extra1],
339       [Set 1st version extra number @&lt;:@not specified@:&gt;@])],
340       [with_version_extra1_present=true], [with_version_extra1_present=false])
341 
342   if test &quot;x$with_version_extra1_present&quot; = xtrue; then
343     if test &quot;x$with_version_extra1&quot; = xyes; then
344       AC_MSG_ERROR([--with-version-extra1 must have a value])
345     elif test &quot;x$with_version_extra1&quot; = xno; then
346       # Interpret --without-* as empty string (i.e. 0) instead of the literal &quot;no&quot;
347       VERSION_EXTRA1=0
348     elif test &quot;x$with_version_extra1&quot; = x; then
349       VERSION_EXTRA1=0
350     else
351       JDKVER_CHECK_AND_SET_NUMBER(VERSION_EXTRA1, $with_version_extra1)
352     fi
353   else
354     if test &quot;x$NO_DEFAULT_VERSION_PARTS&quot; != xtrue; then
355       VERSION_EXTRA1=$DEFAULT_VERSION_EXTRA1
356     fi
357   fi
358 
359   # The 2nd version extra number, if any
360   AC_ARG_WITH(version-extra2, [AS_HELP_STRING([--with-version-extra2],
361       [Set 2nd version extra number @&lt;:@not specified@:&gt;@])],
362       [with_version_extra2_present=true], [with_version_extra2_present=false])
363 
364   if test &quot;x$with_version_extra2_present&quot; = xtrue; then
365     if test &quot;x$with_version_extra2&quot; = xyes; then
366       AC_MSG_ERROR([--with-version-extra2 must have a value])
367     elif test &quot;x$with_version_extra2&quot; = xno; then
368       # Interpret --without-* as empty string (i.e. 0) instead of the literal &quot;no&quot;
369       VERSION_EXTRA2=0
370     elif test &quot;x$with_version_extra2&quot; = x; then
371       VERSION_EXTRA2=0
372     else
373       JDKVER_CHECK_AND_SET_NUMBER(VERSION_EXTRA2, $with_version_extra2)
374     fi
375   else
376     if test &quot;x$NO_DEFAULT_VERSION_PARTS&quot; != xtrue; then
377       VERSION_EXTRA2=$DEFAULT_VERSION_EXTRA2
378     fi
379   fi
380 
381   # The 3rd version extra number, if any
382   AC_ARG_WITH(version-extra3, [AS_HELP_STRING([--with-version-extra3],
383       [Set 3rd version extra number @&lt;:@not specified@:&gt;@])],
384       [with_version_extra3_present=true], [with_version_extra3_present=false])
385 
386   if test &quot;x$with_version_extra3_present&quot; = xtrue; then
387     if test &quot;x$with_version_extra3&quot; = xyes; then
388       AC_MSG_ERROR([--with-version-extra3 must have a value])
389     elif test &quot;x$with_version_extra3&quot; = xno; then
390       # Interpret --without-* as empty string (i.e. 0) instead of the literal &quot;no&quot;
391       VERSION_EXTRA3=0
392     elif test &quot;x$with_version_extra3&quot; = x; then
393       VERSION_EXTRA3=0
394     else
395       JDKVER_CHECK_AND_SET_NUMBER(VERSION_EXTRA3, $with_version_extra3)
396     fi
397   else
398     if test &quot;x$NO_DEFAULT_VERSION_PARTS&quot; != xtrue; then
399       VERSION_EXTRA3=$DEFAULT_VERSION_EXTRA3
400     fi
401   fi
402 
403   # Calculate derived version properties
404 
405   # Set VERSION_IS_GA based on if VERSION_PRE has a value
406   if test &quot;x$VERSION_PRE&quot; = x; then
407     VERSION_IS_GA=true
408   else
409     VERSION_IS_GA=false
410   fi
411 
412   # VERSION_NUMBER but always with exactly 4 positions, with 0 for empty positions.
413   VERSION_NUMBER_FOUR_POSITIONS=$VERSION_FEATURE.$VERSION_INTERIM.$VERSION_UPDATE.$VERSION_PATCH
414 
415   # VERSION_NUMBER but always with all positions, with 0 for empty positions.
416   VERSION_NUMBER_ALL_POSITIONS=$VERSION_NUMBER_FOUR_POSITIONS.$VERSION_EXTRA1.$VERSION_EXTRA2.$VERSION_EXTRA3
417 
418   stripped_version_number=$VERSION_NUMBER_ALL_POSITIONS
419   # Strip trailing zeroes from stripped_version_number
420   for i in 1 2 3 4 5 6 ; do stripped_version_number=${stripped_version_number%.0} ; done
421   VERSION_NUMBER=$stripped_version_number
422 
423   # The complete version string, with additional build information
424   if test &quot;x$VERSION_BUILD$VERSION_OPT&quot; = x; then
425     VERSION_STRING=$VERSION_NUMBER${VERSION_PRE:+-$VERSION_PRE}
426   else
427     # If either build or opt is set, we need a + separator
428     VERSION_STRING=$VERSION_NUMBER${VERSION_PRE:+-$VERSION_PRE}+$VERSION_BUILD${VERSION_OPT:+-$VERSION_OPT}
429   fi
430 
431   # The short version string, just VERSION_NUMBER and PRE, if present.
432   VERSION_SHORT=$VERSION_NUMBER${VERSION_PRE:+-$VERSION_PRE}
433 
434   # The version date
435   AC_ARG_WITH(version-date, [AS_HELP_STRING([--with-version-date],
436       [Set version date @&lt;:@current source value@:&gt;@])])
437   if test &quot;x$with_version_date&quot; = xyes; then
438     AC_MSG_ERROR([--with-version-date must have a value])
439   elif test &quot;x$with_version_date&quot; != x; then
440     if [ ! [[ $with_version_date =~ ^[0-9]{4}-[0-9]{2}-[0-9]{2}$ ]] ]; then
441       AC_MSG_ERROR([&quot;$with_version_date&quot; is not a valid version date])
442     else
443       VERSION_DATE=&quot;$with_version_date&quot;
444     fi
445   else
446     VERSION_DATE=&quot;$DEFAULT_VERSION_DATE&quot;
447   fi
448 
449   # The vendor version string, if any
450   AC_ARG_WITH(vendor-version-string, [AS_HELP_STRING([--with-vendor-version-string],
451       [Set vendor version string @&lt;:@not specified@:&gt;@])])
452   if test &quot;x$with_vendor_version_string&quot; = xyes; then
453     AC_MSG_ERROR([--with-vendor-version-string must have a value])
454   elif [ ! [[ $with_vendor_version_string =~ ^[[:graph:]]*$ ]] ]; then
455     AC_MSG_ERROR([--with--vendor-version-string contains non-graphical characters: $with_vendor_version_string])
456   else
457     VENDOR_VERSION_STRING=&quot;$with_vendor_version_string&quot;
458   fi
459 
460   # We could define --with flags for these, if really needed
461   VERSION_CLASSFILE_MAJOR=&quot;$DEFAULT_VERSION_CLASSFILE_MAJOR&quot;
462   VERSION_CLASSFILE_MINOR=&quot;$DEFAULT_VERSION_CLASSFILE_MINOR&quot;
463 
464   AC_MSG_CHECKING([for version string])
465   AC_MSG_RESULT([$VERSION_STRING])
466 
467   AC_SUBST(VERSION_FEATURE)
468   AC_SUBST(VERSION_INTERIM)
469   AC_SUBST(VERSION_UPDATE)
470   AC_SUBST(VERSION_PATCH)
471   AC_SUBST(VERSION_EXTRA1)
472   AC_SUBST(VERSION_EXTRA2)
473   AC_SUBST(VERSION_EXTRA3)
474   AC_SUBST(VERSION_PRE)
475   AC_SUBST(VERSION_BUILD)
476   AC_SUBST(VERSION_OPT)
477   AC_SUBST(VERSION_NUMBER)
478   AC_SUBST(VERSION_NUMBER_FOUR_POSITIONS)
479   AC_SUBST(VERSION_STRING)
480   AC_SUBST(VERSION_SHORT)
481   AC_SUBST(VERSION_IS_GA)
482   AC_SUBST(VERSION_DATE)
483   AC_SUBST(VENDOR_VERSION_STRING)
484   AC_SUBST(VERSION_CLASSFILE_MAJOR)
485   AC_SUBST(VERSION_CLASSFILE_MINOR)
486 
487 ])
    </pre>
  </body>
</html>