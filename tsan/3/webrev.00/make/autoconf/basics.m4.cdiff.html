<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff make/autoconf/basics.m4</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="../ZipSource.gmk.cdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="basics_windows.m4.cdiff.html" target="_top">next &gt;</a></center>    <h2>make/autoconf/basics.m4</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 203,10 ***</span>
<span class="line-new-header">--- 203,38 ---</span>
        $1=&quot;$2:[$]$1&quot;
      fi
    fi
  ])
  
<span class="line-added">+ ################################################################################</span>
<span class="line-added">+ # This will make a path absolute. Assumes it&#39;s already a unix path. Also</span>
<span class="line-added">+ # resolves ~ to homedir.</span>
<span class="line-added">+ AC_DEFUN([BASIC_ABSOLUTE_PATH],</span>
<span class="line-added">+ [</span>
<span class="line-added">+   if test &quot;x[$]$1&quot; != x; then</span>
<span class="line-added">+     new_path=&quot;[$]$1&quot;</span>
<span class="line-added">+ </span>
<span class="line-added">+     # Use eval to expand a potential ~. This technique does not work if there</span>
<span class="line-added">+     # are spaces in the path (which is valid at this point on Windows), so only</span>
<span class="line-added">+     # try to apply it if there is an actual ~ first in the path.</span>
<span class="line-added">+     if [ [[ &quot;$new_path&quot; = &quot;~&quot;* ]] ]; then</span>
<span class="line-added">+       eval new_path=&quot;$new_path&quot;</span>
<span class="line-added">+       if test ! -f &quot;$new_path&quot; &amp;&amp; test ! -d &quot;$new_path&quot;; then</span>
<span class="line-added">+         AC_MSG_ERROR([The new_path of $1, which resolves as &quot;$new_path&quot;, is not found.])</span>
<span class="line-added">+       fi</span>
<span class="line-added">+     fi</span>
<span class="line-added">+ </span>
<span class="line-added">+     if test -d &quot;$new_path&quot;; then</span>
<span class="line-added">+       $1=&quot;`cd &quot;$new_path&quot;; $THEPWDCMD -L`&quot;</span>
<span class="line-added">+     else</span>
<span class="line-added">+       dir=&quot;`$DIRNAME &quot;$new_path&quot;`&quot;</span>
<span class="line-added">+       base=&quot;`$BASENAME &quot;$new_path&quot;`&quot;</span>
<span class="line-added">+       $1=&quot;`cd &quot;$dir&quot;; $THEPWDCMD -L`/$base&quot;</span>
<span class="line-added">+     fi</span>
<span class="line-added">+   fi</span>
<span class="line-added">+ ])</span>
<span class="line-added">+ </span>
  ###############################################################################
  # This will make sure the given variable points to a full and proper
  # path. This means:
  # 1) There will be no spaces in the path. On unix platforms,
  #    spaces in the path will result in an error. On Windows,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 215,11 ***</span>
  #     cygwin).
  # $1: The name of the variable to fix
  AC_DEFUN([BASIC_FIXUP_PATH],
  [
    # Only process if variable expands to non-empty
<span class="line-removed">- </span>
    if test &quot;x[$]$1&quot; != x; then
      if test &quot;x$OPENJDK_BUILD_OS_ENV&quot; = &quot;xwindows.cygwin&quot;; then
        BASIC_FIXUP_PATH_CYGWIN($1)
      elif test &quot;x$OPENJDK_BUILD_OS_ENV&quot; = &quot;xwindows.msys&quot;; then
        BASIC_FIXUP_PATH_MSYS($1)
<span class="line-new-header">--- 243,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 232,23 ***</span>
        if test &quot;x$has_space&quot; != x; then
          AC_MSG_NOTICE([The path of $1, which resolves as &quot;$path&quot;, is invalid.])
          AC_MSG_ERROR([Spaces are not allowed in this path.])
        fi
  
<span class="line-modified">!       # Use eval to expand a potential ~</span>
<span class="line-modified">!       eval path=&quot;$path&quot;</span>
<span class="line-removed">-       if test ! -f &quot;$path&quot; &amp;&amp; test ! -d &quot;$path&quot;; then</span>
<span class="line-removed">-         AC_MSG_ERROR([The path of $1, which resolves as &quot;$path&quot;, is not found.])</span>
<span class="line-removed">-       fi</span>
<span class="line-removed">- </span>
<span class="line-removed">-       if test -d &quot;$path&quot;; then</span>
<span class="line-removed">-         $1=&quot;`cd &quot;$path&quot;; $THEPWDCMD -L`&quot;</span>
<span class="line-removed">-       else</span>
<span class="line-removed">-         dir=&quot;`$DIRNAME &quot;$path&quot;`&quot;</span>
<span class="line-removed">-         base=&quot;`$BASENAME &quot;$path&quot;`&quot;</span>
<span class="line-removed">-         $1=&quot;`cd &quot;$dir&quot;; $THEPWDCMD -L`/$base&quot;</span>
<span class="line-removed">-       fi</span>
      fi
    fi
  ])
  
  ###############################################################################
<span class="line-new-header">--- 259,12 ---</span>
        if test &quot;x$has_space&quot; != x; then
          AC_MSG_NOTICE([The path of $1, which resolves as &quot;$path&quot;, is invalid.])
          AC_MSG_ERROR([Spaces are not allowed in this path.])
        fi
  
<span class="line-modified">!       BASIC_ABSOLUTE_PATH(path)</span>
<span class="line-modified">!       $1=&quot;$path&quot;</span>
      fi
    fi
  ])
  
  ###############################################################################
</pre>
<hr />
<pre>
<span class="line-old-header">*** 409,11 ***</span>
    # AUTOCONF might be set in the environment by the user. Preserve for &quot;make reconfigure&quot;.
    AC_SUBST(AUTOCONF)
    # Save the path variable before it gets changed
    ORIGINAL_PATH=&quot;$PATH&quot;
    AC_SUBST(ORIGINAL_PATH)
<span class="line-modified">!   DATE_WHEN_CONFIGURED=`LANG=C date`</span>
    AC_SUBST(DATE_WHEN_CONFIGURED)
    AC_MSG_NOTICE([Configuration created at $DATE_WHEN_CONFIGURED.])
  ])
  
  ###############################################################################
<span class="line-new-header">--- 425,11 ---</span>
    # AUTOCONF might be set in the environment by the user. Preserve for &quot;make reconfigure&quot;.
    AC_SUBST(AUTOCONF)
    # Save the path variable before it gets changed
    ORIGINAL_PATH=&quot;$PATH&quot;
    AC_SUBST(ORIGINAL_PATH)
<span class="line-modified">!   DATE_WHEN_CONFIGURED=`date`</span>
    AC_SUBST(DATE_WHEN_CONFIGURED)
    AC_MSG_NOTICE([Configuration created at $DATE_WHEN_CONFIGURED.])
  ])
  
  ###############################################################################
</pre>
<hr />
<pre>
<span class="line-old-header">*** 471,35 ***</span>
  
        # First remove it from the list of overridden variables, so we can test
        # for unknown variables in the end.
        CONFIGURE_OVERRIDDEN_VARIABLES=&quot;$try_remove_var&quot;
  
        # Check if we try to supply an empty value
<span class="line-modified">!       if test &quot;x[$]$1&quot; = x; then</span>
<span class="line-removed">-         AC_MSG_NOTICE([Setting user supplied tool $1= (no value)])</span>
          AC_MSG_CHECKING([for $1])
          AC_MSG_RESULT([disabled])
        else
          # Check if the provided tool contains a complete path.
<span class="line-modified">!         tool_specified=&quot;[$]$1&quot;</span>
<span class="line-modified">!         tool_basename=&quot;${tool_specified##*/}&quot;</span>
<span class="line-removed">-         if test &quot;x$tool_basename&quot; = &quot;x$tool_specified&quot;; then</span>
            # A command without a complete path is provided, search $PATH.
<span class="line-modified">!           AC_MSG_NOTICE([Will search for user supplied tool $1=$tool_basename])</span>
            AC_PATH_PROG($1, $tool_basename)
            if test &quot;x[$]$1&quot; = x; then
<span class="line-modified">!             AC_MSG_ERROR([User supplied tool $tool_basename could not be found])</span>
            fi
          else
            # Otherwise we believe it is a complete path. Use it as it is.
<span class="line-modified">!           AC_MSG_NOTICE([Will use user supplied tool $1=$tool_specified])</span>
<span class="line-modified">!           AC_MSG_CHECKING([for $1])</span>
<span class="line-modified">!           if test ! -x &quot;$tool_specified&quot;; then</span>
              AC_MSG_RESULT([not found])
<span class="line-modified">!             AC_MSG_ERROR([User supplied tool $1=$tool_specified does not exist or is not executable])</span>
            fi
<span class="line-modified">!           AC_MSG_RESULT([$tool_specified])</span>
          fi
        fi
      fi
      $3
    fi
<span class="line-new-header">--- 487,47 ---</span>
  
        # First remove it from the list of overridden variables, so we can test
        # for unknown variables in the end.
        CONFIGURE_OVERRIDDEN_VARIABLES=&quot;$try_remove_var&quot;
  
<span class="line-added">+       tool_override=[$]$1</span>
<span class="line-added">+       AC_MSG_NOTICE([User supplied override $1=&quot;$tool_override&quot;])</span>
<span class="line-added">+ </span>
        # Check if we try to supply an empty value
<span class="line-modified">!       if test &quot;x$tool_override&quot; = x; then</span>
          AC_MSG_CHECKING([for $1])
          AC_MSG_RESULT([disabled])
        else
<span class="line-added">+         # Split up override in command part and argument part</span>
<span class="line-added">+         tool_and_args=($tool_override)</span>
<span class="line-added">+         [ tool_command=${tool_and_args[0]} ]</span>
<span class="line-added">+         [ unset &#39;tool_and_args[0]&#39; ]</span>
<span class="line-added">+         [ tool_args=${tool_and_args[@]} ]</span>
<span class="line-added">+ </span>
          # Check if the provided tool contains a complete path.
<span class="line-modified">!         tool_basename=&quot;${tool_command##*/}&quot;</span>
<span class="line-modified">!         if test &quot;x$tool_basename&quot; = &quot;x$tool_command&quot;; then</span>
            # A command without a complete path is provided, search $PATH.
<span class="line-modified">!           AC_MSG_NOTICE([Will search for user supplied tool &quot;$tool_basename&quot;])</span>
            AC_PATH_PROG($1, $tool_basename)
            if test &quot;x[$]$1&quot; = x; then
<span class="line-modified">!             AC_MSG_ERROR([User supplied tool $1=&quot;$tool_basename&quot; could not be found])</span>
            fi
          else
            # Otherwise we believe it is a complete path. Use it as it is.
<span class="line-modified">!           AC_MSG_NOTICE([Will use user supplied tool &quot;$tool_command&quot;])</span>
<span class="line-modified">!           AC_MSG_CHECKING([for $tool_command])</span>
<span class="line-modified">!           if test ! -x &quot;$tool_command&quot;; then</span>
              AC_MSG_RESULT([not found])
<span class="line-modified">!             AC_MSG_ERROR([User supplied tool $1=&quot;$tool_command&quot; does not exist or is not executable])</span>
            fi
<span class="line-modified">!            $1=&quot;$tool_command&quot;</span>
<span class="line-added">+           AC_MSG_RESULT([found])</span>
<span class="line-added">+         fi</span>
<span class="line-added">+         if test &quot;x$tool_args&quot; != x; then</span>
<span class="line-added">+           # If we got arguments, re-append them to the command after the fixup.</span>
<span class="line-added">+           $1=&quot;[$]$1 $tool_args&quot;</span>
          fi
        fi
      fi
      $3
    fi
</pre>
<hr />
<pre>
<span class="line-old-header">*** 543,10 ***</span>
<span class="line-new-header">--- 571,30 ---</span>
  [
    BASIC_SETUP_TOOL($1, [$2])
    BASIC_CHECK_NONEMPTY($1)
  ])
  
<span class="line-added">+ ###############################################################################</span>
<span class="line-added">+ # Like BASIC_REQUIRE_PROGS but also allows for bash built-ins</span>
<span class="line-added">+ # $1: variable to set</span>
<span class="line-added">+ # $2: executable name (or list of names) to look for</span>
<span class="line-added">+ # $3: [path]</span>
<span class="line-added">+ AC_DEFUN([BASIC_REQUIRE_BUILTIN_PROGS],</span>
<span class="line-added">+ [</span>
<span class="line-added">+   BASIC_SETUP_TOOL($1, [AC_PATH_PROGS($1, $2, , $3)])</span>
<span class="line-added">+   if test &quot;x[$]$1&quot; = x; then</span>
<span class="line-added">+     AC_MSG_NOTICE([Required tool $2 not found in PATH, checking built-in])</span>
<span class="line-added">+     if help $2 &gt; /dev/null 2&gt;&amp;1; then</span>
<span class="line-added">+       AC_MSG_NOTICE([Found $2 as shell built-in. Using it])</span>
<span class="line-added">+       $1=&quot;$2&quot;</span>
<span class="line-added">+     else</span>
<span class="line-added">+       AC_MSG_ERROR([Required tool $2 also not found as built-in.])</span>
<span class="line-added">+     fi</span>
<span class="line-added">+   fi</span>
<span class="line-added">+   BASIC_CHECK_NONEMPTY($1)</span>
<span class="line-added">+ ])</span>
<span class="line-added">+ </span>
  ###############################################################################
  # Setup the most fundamental tools that relies on not much else to set up,
  # but is used by much of the early bootstrap code.
  AC_DEFUN_ONCE([BASIC_SETUP_FUNDAMENTAL_TOOLS],
  [
</pre>
<hr />
<pre>
<span class="line-old-header">*** 625,11 ***</span>
  ###############################################################################
  # Setup basic configuration paths, and platform-specific stuff related to PATHs.
  AC_DEFUN_ONCE([BASIC_SETUP_PATHS],
  [
    # Save the current directory this script was started from
<span class="line-modified">!   CURDIR=&quot;$PWD&quot;</span>
  
    # We might need to rewrite ORIGINAL_PATH, if it includes &quot;#&quot;, to quote them
    # for make. We couldn&#39;t do this when we retrieved ORIGINAL_PATH, since SED
    # was not available at that time.
    REWRITTEN_PATH=`$ECHO &quot;$ORIGINAL_PATH&quot; | $SED -e &#39;s/#/\\\\#/g&#39;`
<span class="line-new-header">--- 673,11 ---</span>
  ###############################################################################
  # Setup basic configuration paths, and platform-specific stuff related to PATHs.
  AC_DEFUN_ONCE([BASIC_SETUP_PATHS],
  [
    # Save the current directory this script was started from
<span class="line-modified">!   CONFIGURE_START_DIR=&quot;$PWD&quot;</span>
  
    # We might need to rewrite ORIGINAL_PATH, if it includes &quot;#&quot;, to quote them
    # for make. We couldn&#39;t do this when we retrieved ORIGINAL_PATH, since SED
    # was not available at that time.
    REWRITTEN_PATH=`$ECHO &quot;$ORIGINAL_PATH&quot; | $SED -e &#39;s/#/\\\\#/g&#39;`
</pre>
<hr />
<pre>
<span class="line-old-header">*** 651,13 ***</span>
  
    # We get the top-level directory from the supporting wrappers.
    AC_MSG_CHECKING([for top-level directory])
    AC_MSG_RESULT([$TOPDIR])
    AC_SUBST(TOPDIR)
  
    # We can only call BASIC_FIXUP_PATH after BASIC_CHECK_PATHS_WINDOWS.
<span class="line-modified">!   BASIC_FIXUP_PATH(CURDIR)</span>
    BASIC_FIXUP_PATH(TOPDIR)
  
    # Locate the directory of this script.
    AUTOCONF_DIR=$TOPDIR/make/autoconf
  
<span class="line-new-header">--- 699,14 ---</span>
  
    # We get the top-level directory from the supporting wrappers.
    AC_MSG_CHECKING([for top-level directory])
    AC_MSG_RESULT([$TOPDIR])
    AC_SUBST(TOPDIR)
<span class="line-added">+   AC_SUBST(CONFIGURE_START_DIR)</span>
  
    # We can only call BASIC_FIXUP_PATH after BASIC_CHECK_PATHS_WINDOWS.
<span class="line-modified">!   BASIC_FIXUP_PATH(CONFIGURE_START_DIR)</span>
    BASIC_FIXUP_PATH(TOPDIR)
  
    # Locate the directory of this script.
    AUTOCONF_DIR=$TOPDIR/make/autoconf
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 866,40 ***</span>
        [use this as the name of the configuration @&lt;:@generated from important configuration options@:&gt;@])],
        [ CONF_NAME=${with_conf_name} ])
  
    # Test from where we are running configure, in or outside of src root.
    AC_MSG_CHECKING([where to store configuration])
<span class="line-modified">!   if test &quot;x$CURDIR&quot; = &quot;x$TOPDIR&quot; || test &quot;x$CURDIR&quot; = &quot;x$CUSTOM_ROOT&quot; \</span>
<span class="line-modified">!       || test &quot;x$CURDIR&quot; = &quot;x$TOPDIR/make/autoconf&quot; \</span>
<span class="line-modified">!       || test &quot;x$CURDIR&quot; = &quot;x$TOPDIR/make&quot; ; then</span>
      # We are running configure from the src root.
      # Create a default ./build/target-variant-debuglevel output root.
      if test &quot;x${CONF_NAME}&quot; = x; then
        AC_MSG_RESULT([in default location])
        CONF_NAME=&quot;${OPENJDK_TARGET_OS}-${OPENJDK_TARGET_CPU}-${JVM_VARIANTS_WITH_AND}-${DEBUG_LEVEL}&quot;
      else
        AC_MSG_RESULT([in build directory with custom name])
      fi
  
      if test &quot;x$CUSTOM_ROOT&quot; != x; then
<span class="line-modified">!       OUTPUTDIR=&quot;${CUSTOM_ROOT}/build/${CONF_NAME}&quot;</span>
      else
<span class="line-modified">!       OUTPUTDIR=&quot;${TOPDIR}/build/${CONF_NAME}&quot;</span>
      fi
      $MKDIR -p &quot;$OUTPUTDIR&quot;
      if test ! -d &quot;$OUTPUTDIR&quot;; then
        AC_MSG_ERROR([Could not create build directory $OUTPUTDIR])
      fi
    else
      # We are running configure from outside of the src dir.
      # Then use the current directory as output dir!
      # If configuration is situated in normal build directory, just use the build
      # directory name as configuration name, otherwise use the complete path.
      if test &quot;x${CONF_NAME}&quot; = x; then
<span class="line-modified">!       CONF_NAME=`$ECHO $CURDIR | $SED -e &quot;s!^${TOPDIR}/build/!!&quot;`</span>
      fi
<span class="line-modified">!     OUTPUTDIR=&quot;$CURDIR&quot;</span>
      AC_MSG_RESULT([in current directory])
  
      # WARNING: This might be a bad thing to do. You need to be sure you want to
      # have a configuration in this directory. Do some sanity checks!
  
<span class="line-new-header">--- 915,42 ---</span>
        [use this as the name of the configuration @&lt;:@generated from important configuration options@:&gt;@])],
        [ CONF_NAME=${with_conf_name} ])
  
    # Test from where we are running configure, in or outside of src root.
    AC_MSG_CHECKING([where to store configuration])
<span class="line-modified">!   if test &quot;x$CONFIGURE_START_DIR&quot; = &quot;x$TOPDIR&quot; \</span>
<span class="line-modified">!       || test &quot;x$CONFIGURE_START_DIR&quot; = &quot;x$CUSTOM_ROOT&quot; \</span>
<span class="line-modified">!       || test &quot;x$CONFIGURE_START_DIR&quot; = &quot;x$TOPDIR/make/autoconf&quot; \</span>
<span class="line-added">+       || test &quot;x$CONFIGURE_START_DIR&quot; = &quot;x$TOPDIR/make&quot; ; then</span>
      # We are running configure from the src root.
      # Create a default ./build/target-variant-debuglevel output root.
      if test &quot;x${CONF_NAME}&quot; = x; then
        AC_MSG_RESULT([in default location])
        CONF_NAME=&quot;${OPENJDK_TARGET_OS}-${OPENJDK_TARGET_CPU}-${JVM_VARIANTS_WITH_AND}-${DEBUG_LEVEL}&quot;
      else
        AC_MSG_RESULT([in build directory with custom name])
      fi
  
      if test &quot;x$CUSTOM_ROOT&quot; != x; then
<span class="line-modified">!       WORKSPACE_ROOT=&quot;${CUSTOM_ROOT}&quot;</span>
      else
<span class="line-modified">!       WORKSPACE_ROOT=&quot;${TOPDIR}&quot;</span>
      fi
<span class="line-added">+     OUTPUTDIR=&quot;${WORKSPACE_ROOT}/build/${CONF_NAME}&quot;</span>
      $MKDIR -p &quot;$OUTPUTDIR&quot;
      if test ! -d &quot;$OUTPUTDIR&quot;; then
        AC_MSG_ERROR([Could not create build directory $OUTPUTDIR])
      fi
    else
      # We are running configure from outside of the src dir.
      # Then use the current directory as output dir!
      # If configuration is situated in normal build directory, just use the build
      # directory name as configuration name, otherwise use the complete path.
      if test &quot;x${CONF_NAME}&quot; = x; then
<span class="line-modified">!       CONF_NAME=`$ECHO $CONFIGURE_START_DIR | $SED -e &quot;s!^${TOPDIR}/build/!!&quot;`</span>
      fi
<span class="line-modified">!     OUTPUTDIR=&quot;$CONFIGURE_START_DIR&quot;</span>
      AC_MSG_RESULT([in current directory])
  
      # WARNING: This might be a bad thing to do. You need to be sure you want to
      # have a configuration in this directory. Do some sanity checks!
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 915,18 ***</span>
                -e &#39;s/confdefs.h//g&#39; \
                -e &#39;s/configure-support//g&#39; \
                -e &#39;s/ //g&#39; \
            | $TR -d &#39;\n&#39;`
        if test &quot;x$filtered_files&quot; != x; then
<span class="line-modified">!         AC_MSG_NOTICE([Current directory is $CURDIR.])</span>
          AC_MSG_NOTICE([Since this is not the source root, configure will output the configuration here])
          AC_MSG_NOTICE([(as opposed to creating a configuration in &lt;src_root&gt;/build/&lt;conf-name&gt;).])
          AC_MSG_NOTICE([However, this directory is not empty. This is not allowed, since it could])
          AC_MSG_NOTICE([seriously mess up just about everything.])
          AC_MSG_NOTICE([Try &#39;cd $TOPDIR&#39; and restart configure])
          AC_MSG_NOTICE([(or create a new empty directory and cd to it).])
<span class="line-modified">!         AC_MSG_ERROR([Will not continue creating configuration in $CURDIR])</span>
        fi
      fi
    fi
    AC_MSG_CHECKING([what configuration name to use])
    AC_MSG_RESULT([$CONF_NAME])
<span class="line-new-header">--- 966,18 ---</span>
                -e &#39;s/confdefs.h//g&#39; \
                -e &#39;s/configure-support//g&#39; \
                -e &#39;s/ //g&#39; \
            | $TR -d &#39;\n&#39;`
        if test &quot;x$filtered_files&quot; != x; then
<span class="line-modified">!         AC_MSG_NOTICE([Current directory is $CONFIGURE_START_DIR.])</span>
          AC_MSG_NOTICE([Since this is not the source root, configure will output the configuration here])
          AC_MSG_NOTICE([(as opposed to creating a configuration in &lt;src_root&gt;/build/&lt;conf-name&gt;).])
          AC_MSG_NOTICE([However, this directory is not empty. This is not allowed, since it could])
          AC_MSG_NOTICE([seriously mess up just about everything.])
          AC_MSG_NOTICE([Try &#39;cd $TOPDIR&#39; and restart configure])
          AC_MSG_NOTICE([(or create a new empty directory and cd to it).])
<span class="line-modified">!         AC_MSG_ERROR([Will not continue creating configuration in $CONFIGURE_START_DIR])</span>
        fi
      fi
    fi
    AC_MSG_CHECKING([what configuration name to use])
    AC_MSG_RESULT([$CONF_NAME])
</pre>
<hr />
<pre>
<span class="line-old-header">*** 938,10 ***</span>
<span class="line-new-header">--- 989,11 ---</span>
  
    SPEC=&quot;$OUTPUTDIR/spec.gmk&quot;
    AC_SUBST(SPEC)
    AC_SUBST(CONF_NAME)
    AC_SUBST(OUTPUTDIR)
<span class="line-added">+   AC_SUBST(WORKSPACE_ROOT)</span>
    AC_SUBST(CONFIGURESUPPORT_OUTPUTDIR)
  
    # The spec.gmk file contains all variables for the make system.
    AC_CONFIG_FILES([$OUTPUTDIR/spec.gmk:$AUTOCONF_DIR/spec.gmk.in])
    # The bootcycle-spec.gmk file contains support for boot cycle builds.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1128,10 ***</span>
<span class="line-new-header">--- 1180,12 ---</span>
      TAR_TYPE=&quot;bsd&quot;
    elif test &quot;x$($TAR -v | $GREP &quot;bsdtar&quot;)&quot; != &quot;x&quot;; then
      TAR_TYPE=&quot;bsd&quot;
    elif test &quot;x$OPENJDK_BUILD_OS&quot; = &quot;xsolaris&quot;; then
      TAR_TYPE=&quot;solaris&quot;
<span class="line-added">+   elif test &quot;x$OPENJDK_BUILD_OS&quot; = &quot;xaix&quot;; then</span>
<span class="line-added">+     TAR_TYPE=&quot;aix&quot;</span>
    fi
    AC_MSG_CHECKING([what type of tar was found])
    AC_MSG_RESULT([$TAR_TYPE])
  
    TAR_CREATE_FILE_PARAM=&quot;&quot;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1141,10 ***</span>
<span class="line-new-header">--- 1195,15 ---</span>
      TAR_SUPPORTS_TRANSFORM=&quot;true&quot;
      if test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xsolaris&quot;; then
        # When using gnu tar for Solaris targets, need to use compatibility mode
        TAR_CREATE_EXTRA_PARAM=&quot;--format=ustar&quot;
      fi
<span class="line-added">+   elif test &quot;x$TAR_TYPE&quot; = &quot;aix&quot;; then</span>
<span class="line-added">+     # -L InputList of aix tar: name of file listing the files and directories</span>
<span class="line-added">+     # that need to be   archived or extracted</span>
<span class="line-added">+     TAR_INCLUDE_PARAM=&quot;L&quot;</span>
<span class="line-added">+     TAR_SUPPORTS_TRANSFORM=&quot;false&quot;</span>
    else
      TAR_INCLUDE_PARAM=&quot;I&quot;
      TAR_SUPPORTS_TRANSFORM=&quot;false&quot;
    fi
    AC_SUBST(TAR_TYPE)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1226,16 ***</span>
    if test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xmacosx&quot;; then
      BASIC_REQUIRE_PROGS(DSYMUTIL, dsymutil)
      BASIC_REQUIRE_PROGS(MIG, mig)
      BASIC_REQUIRE_PROGS(XATTR, xattr)
      BASIC_PATH_PROGS(CODESIGN, codesign)
      if test &quot;x$CODESIGN&quot; != &quot;x&quot;; then
<span class="line-modified">!       # Verify that the openjdk_codesign certificate is present</span>
<span class="line-modified">!       AC_MSG_CHECKING([if openjdk_codesign certificate is present])</span>
        $RM codesign-testfile
        $TOUCH codesign-testfile
<span class="line-modified">!       $CODESIGN -s openjdk_codesign codesign-testfile 2&gt;&amp;AS_MESSAGE_LOG_FD &gt;&amp;AS_MESSAGE_LOG_FD || CODESIGN=</span>
        $RM codesign-testfile
        if test &quot;x$CODESIGN&quot; = x; then
          AC_MSG_RESULT([no])
        else
          AC_MSG_RESULT([yes])
<span class="line-new-header">--- 1285,27 ---</span>
    if test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xmacosx&quot;; then
      BASIC_REQUIRE_PROGS(DSYMUTIL, dsymutil)
      BASIC_REQUIRE_PROGS(MIG, mig)
      BASIC_REQUIRE_PROGS(XATTR, xattr)
      BASIC_PATH_PROGS(CODESIGN, codesign)
<span class="line-added">+ </span>
      if test &quot;x$CODESIGN&quot; != &quot;x&quot;; then
<span class="line-modified">!       # Check for user provided code signing identity.</span>
<span class="line-modified">!       # If no identity was provided, fall back to &quot;openjdk_codesign&quot;.</span>
<span class="line-added">+       AC_ARG_WITH([macosx-codesign-identity], [AS_HELP_STRING([--with-macosx-codesign-identity],</span>
<span class="line-added">+         [specify the code signing identity])],</span>
<span class="line-added">+         [MACOSX_CODESIGN_IDENTITY=$with_macosx_codesign_identity],</span>
<span class="line-added">+         [MACOSX_CODESIGN_IDENTITY=openjdk_codesign]</span>
<span class="line-added">+       )</span>
<span class="line-added">+ </span>
<span class="line-added">+       AC_SUBST(MACOSX_CODESIGN_IDENTITY)</span>
<span class="line-added">+ </span>
<span class="line-added">+       # Verify that the codesign certificate is present</span>
<span class="line-added">+       AC_MSG_CHECKING([if codesign certificate is present])</span>
        $RM codesign-testfile
        $TOUCH codesign-testfile
<span class="line-modified">!       $CODESIGN -s &quot;$MACOSX_CODESIGN_IDENTITY&quot; codesign-testfile 2&gt;&amp;AS_MESSAGE_LOG_FD &gt;&amp;AS_MESSAGE_LOG_FD || CODESIGN=</span>
        $RM codesign-testfile
        if test &quot;x$CODESIGN&quot; = x; then
          AC_MSG_RESULT([no])
        else
          AC_MSG_RESULT([yes])
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1243,10 ***</span>
<span class="line-new-header">--- 1313,13 ---</span>
      fi
      BASIC_REQUIRE_PROGS(SETFILE, SetFile)
    elif test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xsolaris&quot;; then
      BASIC_REQUIRE_PROGS(ELFEDIT, elfedit)
    fi
<span class="line-added">+   if ! test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xwindows&quot;; then</span>
<span class="line-added">+     BASIC_REQUIRE_BUILTIN_PROGS(ULIMIT, ulimit)</span>
<span class="line-added">+   fi</span>
  ])
  
  ###############################################################################
  # Check if build directory is on local disk. If not possible to determine,
  # we prefer to claim it&#39;s local.
</pre>
<center><a href="../ZipSource.gmk.cdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="basics_windows.m4.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>