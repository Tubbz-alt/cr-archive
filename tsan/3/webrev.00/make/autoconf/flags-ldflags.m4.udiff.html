<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff make/autoconf/flags-ldflags.m4</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="flags-cflags.m4.udiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="flags-other.m4.udiff.html" target="_top">next &gt;</a></center>    <h2>make/autoconf/flags-ldflags.m4</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  #
<span class="udiff-line-modified-removed">- # Copyright (c) 2011, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+ # Copyright (c) 2011, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  #
  # This code is free software; you can redistribute it and/or modify it
  # under the terms of the GNU General Public License version 2 only, as
  # published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -68,14 +68,22 @@</span>
        BASIC_LDFLAGS=&quot;-Wl,--hash-style=both&quot;
        LIBJSIG_HASHSTYLE_LDFLAGS=&quot;-Wl,--hash-style=both&quot;
      fi
  
      # Add -z defs, to forbid undefined symbols in object files.
<span class="udiff-line-modified-removed">-     BASIC_LDFLAGS=&quot;$BASIC_LDFLAGS -Wl,-z,defs&quot;</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-     BASIC_LDFLAGS_JVM_ONLY=&quot;-Wl,-O1 -Wl,-z,relro&quot;</span>
<span class="udiff-line-modified-added">+     # add relro (mark relocations read only) for all libs</span>
<span class="udiff-line-modified-added">+     BASIC_LDFLAGS=&quot;$BASIC_LDFLAGS -Wl,-z,defs -Wl,-z,relro&quot;</span>
<span class="udiff-line-modified-added">+     # Linux : remove unused code+data in link step</span>
<span class="udiff-line-added">+     if test &quot;x$ENABLE_LINKTIME_GC&quot; = xtrue; then</span>
<span class="udiff-line-added">+       if test &quot;x$OPENJDK_TARGET_CPU&quot; = xs390x; then</span>
<span class="udiff-line-added">+         BASIC_LDFLAGS=&quot;$BASIC_LDFLAGS -Wl,--gc-sections -Wl,--print-gc-sections&quot;</span>
<span class="udiff-line-added">+       else</span>
<span class="udiff-line-added">+         BASIC_LDFLAGS_JDK_ONLY=&quot;$BASIC_LDFLAGS_JDK_ONLY -Wl,--gc-sections&quot;</span>
<span class="udiff-line-added">+       fi</span>
<span class="udiff-line-added">+     fi</span>
  
<span class="udiff-line-added">+     BASIC_LDFLAGS_JVM_ONLY=&quot;-Wl,-O1&quot;</span>
  
    elif test &quot;x$TOOLCHAIN_TYPE&quot; = xclang; then
      BASIC_LDFLAGS_JVM_ONLY=&quot;-mno-omit-leaf-frame-pointer -mstack-alignment=16 \
          -fPIC&quot;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -86,11 +94,11 @@</span>
  
      BASIC_LDFLAGS_JDK_ONLY=&quot;-ztext&quot;
      BASIC_LDFLAGS_JVM_ONLY=&quot;-library=%none -mt -z noversion&quot;
  
    elif test &quot;x$TOOLCHAIN_TYPE&quot; = xxlc; then
<span class="udiff-line-modified-removed">-     BASIC_LDFLAGS=&quot;-b64 -brtl -bnolibpath -bexpall -bernotok -btextpsize:64K \</span>
<span class="udiff-line-modified-added">+     BASIC_LDFLAGS=&quot;-b64 -brtl -bnorwexec -bnolibpath -bexpall -bernotok -btextpsize:64K \</span>
          -bdatapsize:64K -bstackpsize:64K&quot;
      # libjvm.so has gotten too large for normal TOC size; compile with qpic=large and link with bigtoc
      BASIC_LDFLAGS_JVM_ONLY=&quot;-Wl,-lC_r -bbigtoc&quot;
  
    elif test &quot;x$TOOLCHAIN_TYPE&quot; = xmicrosoft; then
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -118,13 +126,10 @@</span>
    # Setup debug level-dependent LDFLAGS
    if test &quot;x$TOOLCHAIN_TYPE&quot; = xgcc; then
      if test &quot;x$OPENJDK_TARGET_OS&quot; = xlinux; then
        if test x$DEBUG_LEVEL = xrelease; then
          DEBUGLEVEL_LDFLAGS_JDK_ONLY=&quot;$DEBUGLEVEL_LDFLAGS_JDK_ONLY -Wl,-O1&quot;
<span class="udiff-line-removed">-       else</span>
<span class="udiff-line-removed">-         # mark relocations read only on (fast/slow) debug builds</span>
<span class="udiff-line-removed">-         DEBUGLEVEL_LDFLAGS_JDK_ONLY=&quot;-Wl,-z,relro&quot;</span>
        fi
        if test x$DEBUG_LEVEL = xslowdebug; then
          # do relocations at load
          DEBUGLEVEL_LDFLAGS=&quot;-Wl,-z,now&quot;
        fi
</pre>
<center><a href="flags-cflags.m4.udiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="flags-other.m4.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>