<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames make/lib/Awt2dLibraries.gmk</title>
    <link rel="stylesheet" href="../../style.css" />
    <script type="text/javascript" src="../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 #
  2 # Copyright (c) 2011, 2019, Oracle and/or its affiliates. All rights reserved.
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
 23 # questions.
 24 #
 25 
 26 $(eval $(call IncludeCustomExtension, lib/Awt2dLibraries-pre.gmk))
 27 
 28 WIN_AWT_LIB := $(SUPPORT_OUTPUTDIR)/native/$(MODULE)/libawt/awt.lib
 29 
 30 LIBAWT_DEFAULT_HEADER_DIRS := \
 31     libawt/awt/image \
 32     libawt/awt/image/cvutils \
 33     libawt/java2d \
 34     libawt/java2d/loops \
 35     libawt/java2d/pipe \
 36     #
 37 
 38 ################################################################################
 39 
 40 # We must not include java.desktop/unix/native/libmlib_image, which is only
 41 # for usage by solaris-sparc in libmlib_image_v.
<a name="1" id="anc1"></a><span class="line-modified"> 42 BUILD_LIBMLIB_EXCLUDE_SRC_PATTERNS := unix</span>
 43 
 44 BUILD_LIBMLIB_CFLAGS := -D__USE_J2D_NAMES -D__MEDIALIB_OLD_NAMES -DMLIB_NO_LIBSUNMATH
 45 
 46 ifeq ($(call isTargetCpuBits, 64), true)
 47   BUILD_LIBMLIB_CFLAGS += -DMLIB_OS64BIT
 48 endif
 49 
 50 $(eval $(call SetupJdkLibrary, BUILD_LIBMLIB_IMAGE, \
 51     NAME := mlib_image, \
 52     EXTRA_SRC := common/awt/medialib, \
 53     EXCLUDE_FILES := mlib_c_ImageBlendTable.c, \
 54     EXCLUDE_SRC_PATTERNS := $(BUILD_LIBMLIB_EXCLUDE_SRC_PATTERNS), \
 55     OPTIMIZATION := HIGHEST, \
 56     CFLAGS := $(CFLAGS_JDKLIB) \
 57         $(BUILD_LIBMLIB_CFLAGS), \
 58     DISABLED_WARNINGS_gcc := unused-function, \
 59     LDFLAGS := $(LDFLAGS_JDKLIB) \
 60         $(call SET_SHARED_LIBRARY_ORIGIN), \
 61     LIBS := $(JDKLIB_LIBS), \
 62     LIBS_unix := $(LIBM) $(LIBDL), \
 63 ))
 64 
 65 $(BUILD_LIBMLIB_IMAGE): $(call FindLib, java.base, java)
 66 
 67 TARGETS += $(BUILD_LIBMLIB_IMAGE)
 68 
 69 ################################################################################
 70 
 71 ifeq ($(call And, $(call isTargetOs, solaris) $(call isTargetCpuArch, sparc)), true)
 72 
 73   # libmlib_image_v is basically built from mlib_image sources, with some additions
 74   # and some exclusions.
 75   LIBMLIB_IMAGE_V_SRC := \
 76      libmlib_image \
 77      common/awt/medialib \
 78      #
 79 
 80   LIBMLIB_IMAGE_V_CFLAGS := -xarch=sparcvis -D__USE_J2D_NAMES -D__MEDIALIB_OLD_NAMES \
 81       $(TOPDIR)/src/$(MODULE)/unix/native/libmlib_image/vis_$(OPENJDK_TARGET_CPU_BITS).il
 82 
 83   ifeq ($(call isTargetCpuBits, 64), true)
 84     LIBMLIB_IMAGE_V_CFLAGS += -DMLIB_OS64BIT
 85   endif
 86 
 87   BUILD_LIBMLIB_IMAGE_V_EXFILES := \
 88       awt_ImagingLib.c \
 89       mlib_c_ImageAffine_BC.c \
 90       mlib_c_ImageAffine_BC_S16.c \
 91       mlib_c_ImageAffine_BC_U16.c \
 92       mlib_c_ImageAffine_BL.c \
 93       mlib_c_ImageAffine_BL_S16.c \
 94       mlib_c_ImageAffine_BL_U16.c \
 95       mlib_c_ImageAffine_NN.c \
 96       mlib_c_ImageConvClearEdge.c \
 97       mlib_c_ImageConvCopyEdge.c \
 98       mlib_c_ImageConv_f.c \
 99       mlib_c_ImageConvVersion.c \
100       mlib_c_ImageCopy.c \
101       mlib_c_ImageLookUp.c \
102       mlib_c_ImageLookUp_f.c \
103       #
104 
105   $(eval $(call SetupJdkLibrary, BUILD_LIBMLIB_IMAGE_V, \
106       NAME := mlib_image_v, \
107       SRC := $(LIBMLIB_IMAGE_V_SRC), \
108       EXCLUDE_FILES := $(BUILD_LIBMLIB_IMAGE_V_EXFILES), \
109       OPTIMIZATION := HIGHEST, \
110       CFLAGS := $(CFLAGS_JDKLIB) \
111           $(LIBMLIB_IMAGE_V_CFLAGS), \
112       LDFLAGS := $(LDFLAGS_JDKLIB) \
113           $(call SET_SHARED_LIBRARY_ORIGIN), \
114       LIBS := -ljava -ljvm $(LIBM) $(LIBDL), \
115   ))
116 
117   $(BUILD_LIBMLIB_IMAGE_V): $(call FindLib, java.base, java)
118 
119   TARGETS += $(BUILD_LIBMLIB_IMAGE_V)
120 
121 endif
122 
123 ################################################################################
124 
125 LIBAWT_EXTRA_SRC := \
126     common/awt/debug \
127     $(TOPDIR)/src/$(MODULE)/$(OPENJDK_TARGET_OS_TYPE)/native/common/awt \
128     #
129 
130 ifeq ($(call And, $(call isTargetOs, solaris) $(call isTargetCpuArch, sparc)), true)
131   LIBAWT_EXTRA_SRC += $(TOPDIR)/src/$(MODULE)/share/native/common/awt/medialib
132 endif
133 
134 ifeq ($(call isTargetOs, windows), true)
135   LIBAWT_EXTRA_SRC += \
136       $(TOPDIR)/src/$(MODULE)/share/native/common/awt/utility \
137       $(TOPDIR)/src/$(MODULE)/share/native/common/font \
138       $(TOPDIR)/src/$(MODULE)/share/native/common/java2d/opengl \
139       $(TOPDIR)/src/$(MODULE)/$(OPENJDK_TARGET_OS_TYPE)/native/common/awt/systemscale \
140       #
141 endif
142 
143 ifeq ($(call isTargetOs, solaris linux macosx aix), true)
144   LIBAWT_EXFILES += awt_Font.c CUPSfuncs.c fontpath.c X11Color.c
145 endif
146 
147 ifeq ($(call isTargetOs, macosx), true)
148   LIBAWT_EXFILES += initIDs.c awt/image/cvutils/img_colors.c
149 endif
150 
151 ifeq ($(call isTargetOs, windows), true)
152   LIBAWT_EXFILES += \
153       java2d/d3d/D3DShaderGen.c \
154       awt/image/cvutils/img_colors.c \
155       #
156 endif
157 
158 ifeq ($(call And, $(call isTargetOs, solaris) $(call isTargetCpu, sparcv9)), true)
159   LIBAWT_EXFILES += java2d/loops/MapAccelFunc.c
160 else
161   LIBAWT_EXCLUDES += \
162       $(TOPDIR)/src/$(MODULE)/unix/native/libawt/awt/medialib \
163       $(TOPDIR)/src/$(MODULE)/unix/native/libawt/java2d/loops \
164       $(TOPDIR)/src/$(MODULE)/unix/native/common/awt/medialib \
165       #
166 endif
167 
168 LIBAWT_EXTRA_HEADER_DIRS := \
169     $(LIBAWT_DEFAULT_HEADER_DIRS) \
170     $(call GetJavaHeaderDir, java.base) \
171     libawt/awt/medialib \
172     libawt/java2d/d3d \
173     libawt/java2d/opengl \
174     libawt/java2d/windows \
175     libawt/windows \
176     common/awt/medialib \
177     libmlib_image \
178     include \
179     java.base:libjava \
180     java.base:include \
181     #
182 
183 LIBAWT_CFLAGS += -D__MEDIALIB_OLD_NAMES -D__USE_J2D_NAMES $(X_CFLAGS)
184 
185 ifeq ($(call And, $(call isTargetOs, solaris) $(call isTargetCpu, sparcv9)), true)
186   LIBAWT_CFLAGS += -xarch=sparcvis -DMLIB_ADD_SUFF \
187       $(TOPDIR)/src/$(MODULE)/unix/native/libmlib_image/vis_$(OPENJDK_TARGET_CPU_BITS).il
188 
189   LIBAWT_ASFLAGS = -P -xarch=v9a
190 endif
191 
192 ifeq ($(call isTargetOs, solaris), false)
193   LIBAWT_CFLAGS += -DMLIB_NO_LIBSUNMATH
194 endif
195 
196 ifeq ($(call isTargetOs, windows), true)
197   LIBAWT_CFLAGS += -EHsc -DUNICODE -D_UNICODE
198   ifeq ($(call isTargetCpuBits, 64), true)
199     LIBAWT_CFLAGS += -DMLIB_OS64BIT
200   endif
201 
202   LIBAWT_RC_FLAGS ?= -I $(TOPDIR)/src/java.base/windows/native/launcher/icons
203   LIBAWT_VERSIONINFO_RESOURCE := $(TOPDIR)/src/$(MODULE)/windows/native/libawt/windows/awt.rc
204 endif
205 
206 ifeq ($(call isTargetOs, linux), true)
207   # FIXME: This is probably not what we want to do, but keep it now for compatibility.
208   LIBAWT_CFLAGS += $(EXPORT_ALL_SYMBOLS)
209 endif
210 
211 # Turn off all warnings for debug_mem.c This is needed because the specific warning
212 # about initializing a declared &#39;extern&#39; cannot be turned off individually. Only
213 # applies to debug builds.
214 ifeq ($(TOOLCHAIN_TYPE), gcc)
215   BUILD_LIBAWT_debug_mem.c_CFLAGS := -w
216   # This option improves performance of MaskFill in Java2D by 20% for some gcc
217   LIBAWT_CFLAGS += -fgcse-after-reload
218 endif
219 
220 $(eval $(call SetupJdkLibrary, BUILD_LIBAWT, \
221     NAME := awt, \
222     EXTRA_SRC := $(LIBAWT_EXTRA_SRC), \
223     EXCLUDES := $(LIBAWT_EXCLUDES), \
224     EXCLUDE_FILES := $(LIBAWT_EXFILES), \
225     OPTIMIZATION := LOW, \
226     CFLAGS := $(CFLAGS_JDKLIB) $(LIBAWT_CFLAGS), \
227     EXTRA_HEADER_DIRS := $(LIBAWT_EXTRA_HEADER_DIRS), \
228     DISABLED_WARNINGS_gcc := sign-compare unused-result maybe-uninitialized \
229         format-nonliteral parentheses unused-value unused-function, \
230     DISABLED_WARNINGS_clang := logical-op-parentheses extern-initializer \
231         sign-compare format-nonliteral, \
<a name="2" id="anc2"></a><span class="line-removed">232     DISABLED_WARNINGS_solstudio := E_DECLARATION_IN_CODE, \</span>
233     DISABLED_WARNINGS_microsoft := 4244 4267 4996, \
234     ASFLAGS := $(LIBAWT_ASFLAGS), \
235     LDFLAGS := $(LDFLAGS_JDKLIB) $(call SET_SHARED_LIBRARY_ORIGIN), \
236     LDFLAGS_macosx := -L$(INSTALL_LIBRARIES_HERE), \
237     LDFLAGS_windows := -delayload:user32.dll -delayload:gdi32.dll \
238         -delayload:shell32.dll -delayload:winmm.dll \
239         -delayload:winspool.drv -delayload:imm32.dll \
240         -delayload:ole32.dll -delayload:comdlg32.dll \
241         -delayload:comctl32.dll -delayload:shlwapi.dll, \
242     LIBS_unix := -ljvm -ljava $(LIBM), \
243     LIBS_linux :=  $(LIBDL), \
244     LIBS_solaris := $(LIBDL), \
245     LIBS_aix := $(LIBDL),\
246     LIBS_macosx := -lmlib_image \
247         -framework Cocoa \
248         -framework OpenGL \
249         -framework JavaNativeFoundation \
250         -framework JavaRuntimeSupport \
251         -framework ApplicationServices \
252         -framework AudioToolbox, \
253     LIBS_windows := kernel32.lib user32.lib gdi32.lib winspool.lib \
254         imm32.lib ole32.lib uuid.lib shell32.lib \
255         comdlg32.lib winmm.lib comctl32.lib shlwapi.lib \
256         delayimp.lib jvm.lib $(WIN_JAVA_LIB) advapi32.lib, \
257     VERSIONINFO_RESOURCE := $(LIBAWT_VERSIONINFO_RESOURCE), \
258     RC_FLAGS := $(RC_FLAGS) $(LIBAWT_RC_FLAGS) \
259         -D &quot;JDK_FNAME=awt.dll&quot; \
260         -D &quot;JDK_INTERNAL_NAME=awt&quot; \
261         -D &quot;JDK_FTYPE=0x2L&quot;, \
262 ))
263 
264 $(BUILD_LIBAWT): $(call FindLib, java.base, java)
265 
266 ifeq ($(call isTargetOs, macosx), true)
267   $(BUILD_LIBAWT): $(BUILD_LIBMLIB_IMAGE)
268 endif
269 
270 TARGETS += $(BUILD_LIBAWT)
271 
272 ################################################################################
273 
274 ifeq ($(call isTargetOs, windows macosx), false)
275   ifeq ($(ENABLE_HEADLESS_ONLY), false)
276 
277     LIBAWT_XAWT_EXTRA_SRC := \
278         common/awt \
279         common/java2d \
280         common/font \
281         #
282 
283     LIBAWT_XAWT_EXCLUDES := medialib debug
284 
285     LIBAWT_XAWT_EXTRA_HEADER_DIRS := \
286         $(LIBAWT_DEFAULT_HEADER_DIRS) \
287         libawt_xawt/awt \
288         include \
289         common/awt/debug \
290         common/awt/systemscale \
291         common/font \
292         common/java2d/opengl \
293         common/java2d/x11 \
294         #
295 
296     LIBAWT_XAWT_CFLAGS += -DXAWT -DXAWT_HACK \
297         $(FONTCONFIG_CFLAGS) \
298         $(CUPS_CFLAGS)
299 
300     ifeq ($(call isTargetOs, solaris), true)
301       LIBAWT_XAWT_CFLAGS += -DFUNCPROTO=15
302     endif
303 
304     ifeq ($(call isTargetOs, linux), true)
305       ifeq ($(DISABLE_XRENDER), true)
306         LIBAWT_XAWT_CFLAGS += -DDISABLE_XRENDER_BY_DEFAULT=true
307       endif
308     endif
309 
310     LIBAWT_XAWT_LIBS := $(LIBM) -lawt -lXext -lX11 -lXrender $(LIBDL) -lXtst -lXi -ljava -ljvm
311 
312     ifeq ($(call isTargetOs, linux), true)
313       LIBAWT_XAWT_LIBS += -lpthread
314     endif
315 
316     ifeq ($(TOOLCHAIN_TYPE), gcc)
317       # Turn off all warnings for the following files since they contain warnings
318       # that cannot be turned of individually.
319       # redefining a macro
320       BUILD_LIBAWT_XAWT_gtk2_interface.c_CFLAGS := -w
321       # comparison between pointer and integer
322       BUILD_LIBAWT_XAWT_awt_Font.c_CFLAGS := -w
323       # initializing a declared &#39;extern&#39;
324       BUILD_LIBAWT_XAWT_debug_mem.c_CFLAGS := -w
325     endif
326 
327     $(eval $(call SetupJdkLibrary, BUILD_LIBAWT_XAWT, \
328         NAME := awt_xawt, \
329         EXTRA_SRC := $(LIBAWT_XAWT_EXTRA_SRC), \
330         EXTRA_HEADER_DIRS := $(LIBAWT_XAWT_EXTRA_HEADER_DIRS), \
331         EXCLUDES := $(LIBAWT_XAWT_EXCLUDES), \
332         OPTIMIZATION := LOW, \
333         CFLAGS := $(CFLAGS_JDKLIB) $(LIBAWT_XAWT_CFLAGS) \
334             $(X_CFLAGS), \
335         WARNINGS_AS_ERRORS_xlc := false, \
336         DISABLED_WARNINGS_gcc := type-limits pointer-to-int-cast \
337             unused-result maybe-uninitialized format \
338             format-security int-to-pointer-cast parentheses \
339             implicit-fallthrough undef unused-function, \
340         DISABLED_WARNINGS_clang := parentheses format undef \
341             logical-op-parentheses format-nonliteral int-conversion, \
<a name="3" id="anc3"></a><span class="line-modified">342         DISABLED_WARNINGS_solstudio := E_DECLARATION_IN_CODE \</span>
<span class="line-modified">343             E_ASSIGNMENT_TYPE_MISMATCH E_NON_CONST_INIT, \</span>
344         LDFLAGS := $(LDFLAGS_JDKLIB) \
345             $(call SET_SHARED_LIBRARY_ORIGIN) \
346             -L$(INSTALL_LIBRARIES_HERE), \
347         LIBS :=  $(X_LIBS) $(LIBAWT_XAWT_LIBS), \
348     ))
349 
350     $(BUILD_LIBAWT_XAWT): $(call FindLib, java.base, java)
351 
352     $(BUILD_LIBAWT_XAWT): $(BUILD_LIBAWT)
353 
354     TARGETS += $(BUILD_LIBAWT_XAWT)
355 
356   endif
357 endif
358 
359 ################################################################################
360 
361 # The fast floor code loses precision.
362 LCMS_CFLAGS=-DCMS_DONT_USE_FAST_FLOOR
363 
364 ifeq ($(USE_EXTERNAL_LCMS), true)
365   # If we&#39;re using an external library, we&#39;ll just need the wrapper part.
366   # By including it explicitly, all other files will be excluded.
367   BUILD_LIBLCMS_INCLUDE_FILES := LCMS.c
368   # If we&#39;re using an external library, we can&#39;t include our own SRC path
369   # as includes, instead the system headers should be used.
370   LIBLCMS_HEADERS_FROM_SRC := false
371 else
372   BUILD_LIBLCMS_INCLUDE_FILES :=
373 endif
374 
375 $(eval $(call SetupJdkLibrary, BUILD_LIBLCMS, \
376     NAME := lcms, \
377     INCLUDE_FILES := $(BUILD_LIBLCMS_INCLUDE_FILES), \
378     OPTIMIZATION := HIGHEST, \
379     CFLAGS := $(CFLAGS_JDKLIB) \
380         $(LCMS_CFLAGS), \
<a name="4" id="anc4"></a><span class="line-removed">381     CFLAGS_solaris := -xc99=no_lib, \</span>
382     CFLAGS_windows := -DCMS_IS_WINDOWS_, \
383     EXTRA_HEADER_DIRS := \
384         common/awt/debug \
385         libawt/java2d, \
386     HEADERS_FROM_SRC := $(LIBLCMS_HEADERS_FROM_SRC), \
387     DISABLED_WARNINGS_gcc := format-nonliteral type-limits \
<a name="5" id="anc5"></a><span class="line-modified">388         misleading-indentation undef unused-function, \</span>
389     DISABLED_WARNINGS_clang := tautological-compare format-nonliteral undef, \
390     DISABLED_WARNINGS_solstudio := E_STATEMENT_NOT_REACHED, \
391     DISABLED_WARNINGS_microsoft := 4819, \
392     LDFLAGS := $(LDFLAGS_JDKLIB) \
393         $(call SET_SHARED_LIBRARY_ORIGIN), \
394     LDFLAGS_unix := -L$(INSTALL_LIBRARIES_HERE), \
395     LIBS_unix := -lawt -ljvm -ljava $(LCMS_LIBS) $(LIBM), \
396     LIBS_windows := $(WIN_AWT_LIB) $(WIN_JAVA_LIB), \
397 ))
398 
399 TARGETS += $(BUILD_LIBLCMS)
400 
401 $(BUILD_LIBLCMS): $(BUILD_LIBAWT)
402 
403 ################################################################################
404 
405 # &quot;DISABLED_WARNINGS_gcc := clobbered&quot; rationale:
406 # Suppress gcc warnings like &quot;variable might be clobbered by &#39;longjmp&#39;
407 # or &#39;vfork&#39;&quot;: this warning indicates that some variable is placed to
408 # a register by optimized compiler and it&#39;s value might be lost on longjmp().
409 # Recommended way to avoid such warning is to declare the variable as
410 # volatile to prevent the optimization. However, this approach does not
411 # work because we have to declare all variables as volatile in result.
412 
413 ifeq ($(USE_EXTERNAL_LIBJPEG), true)
414   LIBJPEG_LIBS := -ljpeg
415   BUILD_LIBJAVAJPEG_INCLUDE_FILES := \
416       imageioJPEG.c \
417       jpegdecoder.c
418   # If we&#39;re using an external library, we can&#39;t include our own SRC path
419   # as includes, instead the system headers should be used.
420   LIBJPEG_HEADERS_FROM_SRC := false
421 else
422   LIBJPEG_LIBS :=
423   BUILD_LIBJAVAJPEG_INCLUDE_FILES :=
424 endif
425 
426 $(eval $(call SetupJdkLibrary, BUILD_LIBJAVAJPEG, \
427     NAME := javajpeg, \
428     INCLUDE_FILES := $(BUILD_LIBJAVAJPEG_INCLUDE_FILES), \
429     OPTIMIZATION := HIGHEST, \
430     CFLAGS := $(CFLAGS_JDKLIB), \
431     HEADERS_FROM_SRC := $(LIBJPEG_HEADERS_FROM_SRC), \
432     DISABLED_WARNINGS_gcc := clobbered implicit-fallthrough shift-negative-value, \
433     LDFLAGS := $(LDFLAGS_JDKLIB) \
434         $(call SET_SHARED_LIBRARY_ORIGIN), \
435     LIBS := $(LIBJPEG_LIBS) $(JDKLIB_LIBS), \
436     LIBS_windows := $(WIN_JAVA_LIB) jvm.lib, \
437 ))
438 
439 $(BUILD_LIBJAVAJPEG): $(call FindLib, java.base, java)
440 
441 TARGETS += $(BUILD_LIBJAVAJPEG)
442 
443 ################################################################################
444 
445 # Mac and Windows only use the native AWT lib, do not build libawt_headless
446 ifeq ($(call isTargetOs, windows macosx), false)
447 
448   LIBAWT_HEADLESS_EXTRA_SRC := \
449       common/font \
450       common/java2d \
451       $(TOPDIR)/src/$(MODULE)/$(OPENJDK_TARGET_OS_TYPE)/native/common/awt \
452       #
453 
454   LIBAWT_HEADLESS_EXCLUDES := medialib
455 
456   LIBAWT_HEADLESS_EXTRA_HEADER_DIRS := \
457       $(LIBAWT_DEFAULT_HEADER_DIRS) \
458       common/awt/debug \
459       common/font \
460       common/java2d/opengl \
461       #
462 
463   LIBAWT_HEADLESS_CFLAGS := $(CUPS_CFLAGS) $(FONTCONFIG_CFLAGS) $(X_CFLAGS) \
464       -DHEADLESS=true
465 
466   $(eval $(call SetupJdkLibrary, BUILD_LIBAWT_HEADLESS, \
467       NAME := awt_headless, \
468       EXTRA_SRC := $(LIBAWT_HEADLESS_EXTRA_SRC), \
469       EXCLUDES := $(LIBAWT_HEADLESS_EXCLUDES), \
470       OPTIMIZATION := LOW, \
471       CFLAGS := $(CFLAGS_JDKLIB) \
472           $(LIBAWT_HEADLESS_CFLAGS), \
473       EXTRA_HEADER_DIRS := $(LIBAWT_HEADLESS_EXTRA_HEADER_DIRS), \
474       DISABLED_WARNINGS_gcc := unused-function, \
<a name="6" id="anc6"></a><span class="line-removed">475       DISABLED_WARNINGS_xlc := 1506-356, \</span>
476       DISABLED_WARNINGS_solstudio := E_EMPTY_TRANSLATION_UNIT, \
477       LDFLAGS := $(LDFLAGS_JDKLIB) \
478           $(call SET_SHARED_LIBRARY_ORIGIN), \
479       LDFLAGS_unix := -L$(INSTALL_LIBRARIES_HERE), \
480       LIBS_unix := -lawt -ljvm -ljava, \
481       LIBS_linux := $(LIBM) $(LIBDL), \
482       LIBS_solaris := $(LIBM) $(LIBDL) $(LIBCXX), \
483   ))
484 
<a name="7" id="anc7"></a><span class="line-removed">485   # AIX warning explanation:</span>
<span class="line-removed">486   # 1506-356 : (W) Compilation unit is empty.</span>
<span class="line-removed">487   #            This happens during the headless build</span>
<span class="line-removed">488 </span>
489   $(BUILD_LIBAWT_HEADLESS): $(BUILD_LIBAWT)
490 
491   TARGETS += $(BUILD_LIBAWT_HEADLESS)
492 
493 endif
494 
495 ################################################################################
496 
497 ifeq ($(FREETYPE_TO_USE), system)
498   # For use by libfontmanager:
499   LIBFREETYPE_CFLAGS := $(FREETYPE_CFLAGS)
500   LIBFREETYPE_LIBS := $(FREETYPE_LIBS)
501 else
502   BUILD_LIBFREETYPE_HEADER_DIRS := $(TOPDIR)/src/$(MODULE)/share/native/libfreetype/include
503   BUILD_LIBFREETYPE_CFLAGS := -DFT2_BUILD_LIBRARY $(EXPORT_ALL_SYMBOLS)
504 
505   # For use by libfontmanager:
506   LIBFREETYPE_CFLAGS := -I$(BUILD_LIBFREETYPE_HEADER_DIRS)
507   ifeq ($(call isTargetOs, windows), true)
508     LIBFREETYPE_LIBS := $(SUPPORT_OUTPUTDIR)/native/$(MODULE)/libfreetype/freetype.lib
<a name="8" id="anc8"></a>

509   else
510     LIBFREETYPE_LIBS := -lfreetype
511   endif
512 
513   $(eval $(call SetupJdkLibrary, BUILD_LIBFREETYPE, \
514       NAME := freetype, \
515       OPTIMIZATION := HIGHEST, \
516       CFLAGS := $(CFLAGS_JDKLIB) \
517           $(BUILD_LIBFREETYPE_CFLAGS), \
518       EXTRA_HEADER_DIRS := $(BUILD_LIBFREETYPE_HEADER_DIRS), \
519       DISABLED_WARNINGS_solstudio := \
520          E_STATEMENT_NOT_REACHED \
521          E_END_OF_LOOP_CODE_NOT_REACHED, \
<a name="9" id="anc9"></a><span class="line-modified">522       DISABLED_WARNINGS_microsoft := 4267 4244 4312 4819, \</span>
<span class="line-modified">523       DISABLED_WARNINGS_gcc := implicit-fallthrough, \</span>
524       LDFLAGS := $(LDFLAGS_JDKLIB) \
525           $(call SET_SHARED_LIBRARY_ORIGIN), \
526   ))
527 
528   TARGETS += $(BUILD_LIBFREETYPE)
529 endif
530 
531 ###########################################################################
532 
533 #### Begin harfbuzz configuration
534 
535 HARFBUZZ_CFLAGS := -DHAVE_OT -DHAVE_FALLBACK -DHAVE_UCDN -DHAVE_ROUND
536 
537 ifeq ($(call isTargetOs, windows), false)
538   HARFBUZZ_CFLAGS += -DGETPAGESIZE -DHAVE_MPROTECT -DHAVE_PTHREAD \
<a name="10" id="anc10"></a><span class="line-modified">539                       -DHAVE_SYSCONF -DHAVE_SYS_MMAN_H -DHAVE_UNISTD_H</span>

540 endif
541 ifeq ($(call isTargetOs, linux macosx), true)
542   HARFBUZZ_CFLAGS += -DHAVE_INTEL_ATOMIC_PRIMITIVES
543 endif
544 ifeq ($(call isTargetOs, solaris), true)
545   HARFBUZZ_CFLAGS += -DHAVE_SOLARIS_ATOMIC_OPS
546 endif
547 ifeq ($(call isTargetOs, macosx), true)
548   HARFBUZZ_CFLAGS += -DHAVE_CORETEXT
549 endif
550 ifeq ($(call isTargetOs, macosx), false)
551   LIBFONTMANAGER_EXCLUDE_FILES += harfbuzz/hb-coretext.cc
552 endif
553 # hb-ft.cc is not presently needed, and requires freetype 2.4.2 or later.
554 LIBFONTMANAGER_EXCLUDE_FILES += harfbuzz/hb-ft.cc
555 
556 LIBFONTMANAGER_CFLAGS += $(HARFBUZZ_CFLAGS)
557 
558 #### End harfbuzz configuration
559 
560 LIBFONTMANAGER_EXTRA_HEADER_DIRS := \
561     libfontmanager/harfbuzz \
562     libfontmanager/harfbuzz/hb-ucdn \
563     common/awt \
564     common/font \
565     libawt/java2d \
566     libawt/java2d/pipe \
567     libawt/java2d/loops \
568     #
569 
570 LIBFONTMANAGER_CFLAGS += $(LIBFREETYPE_CFLAGS)
571 BUILD_LIBFONTMANAGER_FONTLIB += $(LIBFREETYPE_LIBS)
572 
573 LIBFONTMANAGER_OPTIMIZATION := HIGH
574 
575 ifeq ($(call isTargetOs, windows), true)
576   LIBFONTMANAGER_EXCLUDE_FILES += X11FontScaler.c \
577       X11TextRenderer.c
578   LIBFONTMANAGER_OPTIMIZATION := HIGHEST
579 else ifeq ($(call isTargetOs, macosx), true)
580   LIBFONTMANAGER_EXCLUDE_FILES += X11FontScaler.c \
581       X11TextRenderer.c \
582       fontpath.c \
583       lcdglyph.c
584 else
585   LIBFONTMANAGER_EXCLUDE_FILES += fontpath.c \
586       lcdglyph.c
587 endif
588 
589 LIBFONTMANAGER_CFLAGS += $(X_CFLAGS) -DLE_STANDALONE -DHEADLESS
590 
591 ifeq ($(TOOLCHAIN_TYPE), gcc)
592   # Turn off all warnings for sunFont.c. This is needed because the specific warning
593   # about discarding &#39;const&#39; qualifier cannot be turned off individually.
594   BUILD_LIBFONTMANAGER_sunFont.c_CFLAGS := -w
595 endif
596 
597 # LDFLAGS clarification:
598 #   Filter relevant linker flags disallowing unresolved symbols as we cannot
599 #   build-time decide to which library to link against (libawt_headless or
600 #   libawt_xawt). See JDK-8196516 for details.
601 $(eval $(call SetupJdkLibrary, BUILD_LIBFONTMANAGER, \
602     NAME := fontmanager, \
603     EXCLUDE_FILES := $(LIBFONTMANAGER_EXCLUDE_FILES) \
604         AccelGlyphCache.c, \
605     TOOLCHAIN := TOOLCHAIN_LINK_CXX, \
606     CFLAGS := $(CFLAGS_JDKLIB) $(LIBFONTMANAGER_CFLAGS), \
607     CXXFLAGS := $(CXXFLAGS_JDKLIB) $(LIBFONTMANAGER_CFLAGS), \
608     OPTIMIZATION := $(LIBFONTMANAGER_OPTIMIZATION), \
609     CFLAGS_windows = -DCC_NOEX, \
610     EXTRA_HEADER_DIRS := $(LIBFONTMANAGER_EXTRA_HEADER_DIRS), \
611     WARNINGS_AS_ERRORS_xlc := false, \
612     DISABLED_WARNINGS_gcc := sign-compare int-to-pointer-cast \
613         type-limits missing-field-initializers implicit-fallthrough \
614         strict-aliasing undef unused-function, \
615     DISABLED_WARNINGS_CXX_gcc := reorder delete-non-virtual-dtor strict-overflow \
<a name="11" id="anc11"></a><span class="line-modified">616         maybe-uninitialized \</span>
<span class="line-removed">617         missing-attributes class-memaccess, \</span>
618     DISABLED_WARNINGS_clang := unused-value incompatible-pointer-types \
619         tautological-constant-out-of-range-compare int-to-pointer-cast \
620         sign-compare undef missing-field-initializers, \
621     DISABLED_WARNINGS_C_solstudio = \
622         E_INTEGER_OVERFLOW_DETECTED \
623         E_ARG_INCOMPATIBLE_WITH_ARG_L \
624         E_ENUM_VAL_OVERFLOWS_INT_MAX, \
625     DISABLED_WARNINGS_CXX_solstudio := \
626         truncwarn wvarhidenmem wvarhidemem wbadlkginit identexpected \
<a name="12" id="anc12"></a><span class="line-modified">627         hidevf w_novirtualdescr arrowrtn2, \</span>
<span class="line-modified">628     DISABLED_WARNINGS_microsoft := 4267 4244 4018 4090 4996 4146 4334 4819 4101, \</span>

629     LDFLAGS := $(subst -Xlinker -z -Xlinker defs,, \
630         $(subst -Wl$(COMMA)-z$(COMMA)defs,,$(LDFLAGS_JDKLIB))) $(LDFLAGS_CXX_JDK) \
631         $(call SET_SHARED_LIBRARY_ORIGIN), \
632     LDFLAGS_unix := -L$(INSTALL_LIBRARIES_HERE), \
633     LDFLAGS_aix := -Wl$(COMMA)-berok, \
634     LIBS := $(BUILD_LIBFONTMANAGER_FONTLIB), \
635     LIBS_unix := -lawt -ljava -ljvm $(LIBM) $(LIBCXX), \
636     LIBS_macosx := -lawt_lwawt -framework CoreText -framework CoreFoundation \
637         -framework CoreGraphics, \
638     LIBS_windows := $(WIN_JAVA_LIB) advapi32.lib user32.lib gdi32.lib \
639         $(WIN_AWT_LIB), \
640 ))
641 
642 $(BUILD_LIBFONTMANAGER): $(BUILD_LIBAWT)
643 
644 ifeq ($(call isTargetOs, macosx), true)
645   $(BUILD_LIBFONTMANAGER): $(call FindLib, $(MODULE), awt_lwawt)
646 endif
647 
648 ifeq ($(FREETYPE_TO_USE), bundled)
649   $(BUILD_LIBFONTMANAGER): $(BUILD_LIBFREETYPE)
650 endif
651 
652 TARGETS += $(BUILD_LIBFONTMANAGER)
653 
654 ################################################################################
655 
656 ifeq ($(call isTargetOs, windows), true)
657 
658   LIBJAWT_CFLAGS := -EHsc -DUNICODE -D_UNICODE
659 
660   LIBJAWT_EXTRA_HEADER_DIRS := \
661       include \
662       common/awt/debug \
663       libawt/awt/image/cvutils \
664       libawt/java2d \
665       libawt/java2d/windows \
666       libawt/windows \
667       java.base:include \
668       java.base:libjava \
669       #
670 
671   ifeq ($(call isTargetCpu, x86), true)
672     KERNEL32_LIB := kernel32.lib
673   endif
674 
675   $(eval $(call SetupJdkLibrary, BUILD_LIBJAWT, \
676       NAME := jawt, \
677       OPTIMIZATION := LOW, \
678       CFLAGS := $(CXXFLAGS_JDKLIB) \
679           $(LIBJAWT_CFLAGS), \
680       EXTRA_HEADER_DIRS := $(LIBJAWT_EXTRA_HEADER_DIRS), \
681       LDFLAGS := $(LDFLAGS_JDKLIB) $(LDFLAGS_CXX_JDK), \
682       LIBS := $(JDKLIB_LIBS) $(KERNEL32_LIB) advapi32.lib $(WIN_AWT_LIB), \
683   ))
684 
685   $(BUILD_LIBJAWT): $(BUILD_LIBAWT)
686 
687   $(eval $(call SetupCopyFiles, COPY_JAWT_LIB, \
688       FILES := $(BUILD_LIBJAWT_IMPORT_LIBRARY), \
689       DEST := $(SUPPORT_OUTPUTDIR)/modules_libs/$(MODULE), \
690   ))
691 
692   $(COPY_JAWT_LIB): $(BUILD_LIBJAWT)
693 
694   TARGETS += $(COPY_JAWT_LIB)
695 
696 else # not windows
697 
698   ifeq ($(call isTargetOs, macosx), true)
699     # libjawt on macosx do not use the unix code
<a name="13" id="anc13"></a><span class="line-modified">700     LIBJAWT_EXCLUDE_SRC_PATTERNS := unix</span>
701   endif
702 
703   ifeq ($(call isTargetOs, macosx), true)
704     JAWT_LIBS := -lawt_lwawt
705   else
706     JAWT_LIBS :=
707     ifeq ($(call isTargetOs, solaris), false)
708       JAWT_LIBS += -lawt
709     endif
710     ifeq ($(ENABLE_HEADLESS_ONLY), false)
711       JAWT_LIBS += -lawt_xawt
712     else
713       JAWT_LIBS += -lawt_headless
714       ifeq ($(call isTargetOs, linux), true)
715         JAWT_CFLAGS += -DHEADLESS
716       endif
717     endif
718   endif
719 
720   $(eval $(call SetupJdkLibrary, BUILD_LIBJAWT, \
721       NAME := jawt, \
722       EXCLUDE_SRC_PATTERNS := $(LIBJAWT_EXCLUDE_SRC_PATTERNS), \
723       INCLUDE_FILES := $(JAWT_FILES), \
724       OPTIMIZATION := LOW, \
725       CFLAGS := $(CFLAGS_JDKLIB) \
726           $(JAWT_CFLAGS), \
727       DISABLED_WARNINGS_clang := sign-compare, \
728       EXTRA_HEADER_DIRS := \
729           include \
730           common/awt, \
731       LDFLAGS := $(LDFLAGS_JDKLIB) \
732           $(call SET_SHARED_LIBRARY_ORIGIN), \
733       LDFLAGS_unix := -L$(INSTALL_LIBRARIES_HERE), \
734       LDFLAGS_macosx := -Wl$(COMMA)-rpath$(COMMA)@loader_path, \
735       LIBS_unix := $(JAWT_LIBS) $(JDKLIB_LIBS), \
736       LIBS_solaris := $(X_LIBS) -lXrender, \
737       LIBS_macosx := -framework Cocoa, \
738   ))
739 
740   ifeq ($(ENABLE_HEADLESS_ONLY), false)
741     $(BUILD_LIBJAWT): $(BUILD_LIBAWT_XAWT)
742   else
743     $(BUILD_LIBJAWT): $(call FindLib, $(MODULE), awt_headless)
744   endif
745 
746   ifeq ($(call isTargetOs, macosx), true)
747    $(BUILD_LIBJAWT): $(call FindLib, $(MODULE), awt_lwawt)
748   endif
749 
750 endif
751 
752 TARGETS += $(BUILD_LIBJAWT)
753 
754 ################################################################################
755 
756 ifeq ($(ENABLE_HEADLESS_ONLY), false)
757 
758   LIBSPLASHSCREEN_EXTRA_SRC := \
759       common/awt/systemscale \
760       #
761 
762   ifeq ($(USE_EXTERNAL_LIBGIF), false)
763     LIBSPLASHSCREEN_HEADER_DIRS += libsplashscreen/giflib
764   else
765     LIBSPLASHSCREEN_EXCLUDES := giflib
766     GIFLIB_LIBS := -lgif
767   endif
768 
769   ifeq ($(USE_EXTERNAL_LIBJPEG), false)
770     # While the following ought to work, it will currently pull in the closed
771     # additions to this library, and this was not done previously in the build.
772     # LIBSPLASHSCREEN_EXTRA_SRC += libjavajpeg
773     LIBSPLASHSCREEN_EXTRA_SRC += $(TOPDIR)/src/java.desktop/share/native/libjavajpeg
774   else
775     LIBJPEG_LIBS := -ljpeg
776   endif
777 
778   ifeq ($(USE_EXTERNAL_LIBPNG), false)
779     LIBSPLASHSCREEN_HEADER_DIRS += libsplashscreen/libpng
780   else
781     LIBSPLASHSCREEN_EXCLUDES += libpng
782   endif
783 
784   ifeq ($(USE_EXTERNAL_LIBZ), false)
785     LIBSPLASHSCREEN_EXTRA_SRC += java.base:libzip/zlib
786   endif
787 
788   ifeq ($(call isTargetOs, macosx), true)
789     # libsplashscreen on macosx do not use the unix code
<a name="14" id="anc14"></a><span class="line-modified">790     LIBSPLASHSCREEN_EXCLUDE_SRC_PATTERNS := unix</span>
791   endif
792 
<a name="15" id="anc15"></a><span class="line-modified">793   LIBSPLASHSCREEN_CFLAGS += -DSPLASHSCREEN -DPNG_NO_MMX_CODE -DPNG_ARM_NEON_OPT=0</span>

794 
795   ifeq ($(call isTargetOs, linux), true)
796     ifeq ($(call isTargetCpuArch, ppc), true)
797       LIBSPLASHSCREEN_CFLAGS += -DPNG_POWERPC_VSX_OPT=0
798     endif
799   endif
800 
801   ifeq ($(call isTargetOs, macosx), true)
802     LIBSPLASHSCREEN_CFLAGS += -DWITH_MACOSX
803 
804     BUILD_LIBSPLASHSCREEN_java_awt_SplashScreen.c_CFLAGS := -x objective-c -O0
805     BUILD_LIBSPLASHSCREEN_splashscreen_gfx_impl.c_CFLAGS := -x objective-c -O0
806     BUILD_LIBSPLASHSCREEN_splashscreen_gif.c_CFLAGS := -x objective-c -O0
807     BUILD_LIBSPLASHSCREEN_splashscreen_impl.c_CFLAGS := -x objective-c -O0
808     BUILD_LIBSPLASHSCREEN_splashscreen_jpeg.c_CFLAGS := -x objective-c -O0
809     BUILD_LIBSPLASHSCREEN_splashscreen_png.c_CFLAGS := -x objective-c -O0
810     BUILD_LIBSPLASHSCREEN_splashscreen_sys.m_CFLAGS := -O0
811 
812   else ifeq ($(call isTargetOs, windows), true)
813     LIBSPLASHSCREEN_CFLAGS += -DWITH_WIN32
814   else
815     LIBSPLASHSCREEN_CFLAGS += -DWITH_X11 $(X_CFLAGS)
816   endif
817 
818   LIBSPLASHSCREEN_LIBS :=
819 
820   ifeq ($(call isTargetOs, macosx), true)
821     LIBSPLASHSCREEN_LIBS += \
822         $(LIBM) -lpthread -liconv -losxapp \
823         -framework ApplicationServices \
824         -framework Foundation \
<a name="16" id="anc16"></a>
825         -framework Cocoa \
826         -framework JavaNativeFoundation
827   else ifeq ($(call isTargetOs, windows), true)
828     LIBSPLASHSCREEN_LIBS += kernel32.lib user32.lib gdi32.lib delayimp.lib $(WIN_JAVA_LIB) jvm.lib
829   else
830     LIBSPLASHSCREEN_LIBS += $(X_LIBS) -lX11 -lXext $(LIBM) -lpthread -ldl
831   endif
832 
833   LIBSPLASHSCREEN_HEADER_DIRS += \
834       libosxapp \
835       java.base:include \
836       java.base:libjava \
837       #
838 
839   $(eval $(call SetupJdkLibrary, BUILD_LIBSPLASHSCREEN, \
840       NAME := splashscreen, \
841       EXTRA_SRC := $(LIBSPLASHSCREEN_EXTRA_SRC), \
842       EXCLUDE_SRC_PATTERNS := $(LIBSPLASHSCREEN_EXCLUDE_SRC_PATTERNS), \
843       EXCLUDE_FILES := imageioJPEG.c jpegdecoder.c pngtest.c, \
844       EXCLUDES := $(LIBSPLASHSCREEN_EXCLUDES), \
845       OPTIMIZATION := LOW, \
846       CFLAGS := $(CFLAGS_JDKLIB) $(LIBSPLASHSCREEN_CFLAGS) \
847           $(GIFLIB_CFLAGS) $(LIBJPEG_CFLAGS) $(PNG_CFLAGS) $(LIBZ_CFLAGS), \
848       EXTRA_HEADER_DIRS := $(LIBSPLASHSCREEN_HEADER_DIRS), \
849       DISABLED_WARNINGS_gcc := sign-compare type-limits unused-result \
850           maybe-uninitialized shift-negative-value implicit-fallthrough \
851           unused-function, \
852       DISABLED_WARNINGS_clang := incompatible-pointer-types sign-compare, \
<a name="17" id="anc17"></a><span class="line-modified">853       DISABLED_WARNINGS_solstudio := E_NEWLINE_NOT_LAST E_DECLARATION_IN_CODE \</span>
<span class="line-removed">854           E_STATEMENT_NOT_REACHED, \</span>
855       DISABLED_WARNINGS_microsoft := 4018 4244 4267, \
856       LDFLAGS := $(LDFLAGS_JDKLIB) \
857           $(call SET_SHARED_LIBRARY_ORIGIN), \
858       LDFLAGS_macosx := -L$(INSTALL_LIBRARIES_HERE), \
859       LDFLAGS_windows := -delayload:user32.dll, \
860       LIBS := $(JDKLIB_LIBS) $(LIBSPLASHSCREEN_LIBS) $(LIBZ_LIBS) \
861           $(GIFLIB_LIBS) $(LIBJPEG_LIBS) $(PNG_LIBS), \
862       LIBS_aix := -liconv, \
863   ))
864 
865   TARGETS += $(BUILD_LIBSPLASHSCREEN)
866 
867   ifeq ($(call isTargetOs, macosx), true)
868     $(BUILD_LIBSPLASHSCREEN): $(call FindLib, $(MODULE), osxapp)
869   endif
870 
871 endif
872 
873 ################################################################################
874 
875 ifeq ($(call isTargetOs, macosx), true)
876 
877   LIBAWT_LWAWT_EXTRA_SRC := \
878       $(TOPDIR)/src/$(MODULE)/unix/native/common/awt \
879       $(TOPDIR)/src/$(MODULE)/share/native/common/font \
880       $(TOPDIR)/src/$(MODULE)/share/native/common/java2d \
881       #
882 
883   LIBAWT_LWAWT_EXTRA_HEADER_DIRS := \
884       $(LIBAWT_DEFAULT_HEADER_DIRS) \
885       libawt_lwawt/awt \
886       libawt_lwawt/font \
887       libawt_lwawt/java2d/opengl \
888       include \
889       common/awt/debug \
890       common/java2d/opengl \
891       libosxapp \
892       #
893 
894   LIBAWT_LWAWT_CFLAGS := $(X_CFLAGS) $(X_LIBS)
895 
896   LIBAWT_LWAWT_EXFILES := fontpath.c awt_Font.c X11Color.c
897   LIBAWT_LWAWT_EXCLUDES := $(TOPDIR)/src/$(MODULE)/unix/native/common/awt/medialib
898 
899   $(eval $(call SetupJdkLibrary, BUILD_LIBAWT_LWAWT, \
900       NAME := awt_lwawt, \
901       EXTRA_SRC := $(LIBAWT_LWAWT_EXTRA_SRC), \
902       INCLUDE_FILES := $(LIBAWT_LWAWT_FILES), \
903       EXCLUDE_FILES := $(LIBAWT_LWAWT_EXFILES), \
904       EXCLUDES := $(LIBAWT_LWAWT_EXCLUDES), \
905       OPTIMIZATION := LOW, \
906       CFLAGS := $(CFLAGS_JDKLIB) \
907           $(LIBAWT_LWAWT_CFLAGS), \
908       EXTRA_HEADER_DIRS := $(LIBAWT_LWAWT_EXTRA_HEADER_DIRS), \
909       DISABLED_WARNINGS_clang := incomplete-implementation enum-conversion \
910           deprecated-declarations objc-method-access bitwise-op-parentheses \
911           incompatible-pointer-types parentheses-equality extra-tokens \
912           sign-compare semicolon-before-method-body format-nonliteral undef \
913           pointer-arith, \
914       LDFLAGS := $(LDFLAGS_JDKLIB) \
915           $(call SET_SHARED_LIBRARY_ORIGIN) \
916           -L$(INSTALL_LIBRARIES_HERE), \
917       LIBS := -lawt -lmlib_image -losxapp -ljvm $(LIBM) \
918           -framework Accelerate \
919           -framework ApplicationServices \
920           -framework AudioToolbox \
921           -framework Carbon \
922           -framework Cocoa \
923           -framework Security \
924           -framework ExceptionHandling \
925           -framework JavaNativeFoundation \
926           -framework JavaRuntimeSupport \
927           -framework OpenGL \
928           -framework QuartzCore -ljava, \
929   ))
930 
931   TARGETS += $(BUILD_LIBAWT_LWAWT)
932 
933   $(BUILD_LIBAWT_LWAWT): $(BUILD_LIBAWT)
934 
935   $(BUILD_LIBAWT_LWAWT): $(BUILD_LIBMLIB_IMAGE)
936 
937   $(BUILD_LIBAWT_LWAWT): $(call FindLib, $(MODULE), osxapp)
938 
939   $(BUILD_LIBAWT_LWAWT): $(call FindLib, java.base, java)
940 
941 endif
942 
943 ################################################################################
944 
945 ifeq ($(call isTargetOs, macosx), true)
946 
947   $(eval $(call SetupJdkLibrary, BUILD_LIBOSXUI, \
948       NAME := osxui, \
949       OPTIMIZATION := LOW, \
950       CFLAGS := $(CFLAGS_JDKLIB), \
951       EXTRA_HEADER_DIRS := \
952           libawt_lwawt/awt \
953           libosxapp, \
954       DISABLED_WARNINGS_clang := deprecated-declarations sign-compare, \
955       LDFLAGS := $(LDFLAGS_JDKLIB) \
956           $(call SET_SHARED_LIBRARY_ORIGIN) \
957           -Wl$(COMMA)-rpath$(COMMA)@loader_path \
958           -L$(INSTALL_LIBRARIES_HERE), \
959       LIBS := -lawt -losxapp -lawt_lwawt \
960           -framework Cocoa \
961           -framework Carbon \
962           -framework ApplicationServices \
963           -framework JavaNativeFoundation \
964           -framework JavaRuntimeSupport \
965           -ljava -ljvm, \
966   ))
967 
968   TARGETS += $(BUILD_LIBOSXUI)
969 
970   $(BUILD_LIBOSXUI): $(BUILD_LIBAWT)
971 
972   $(BUILD_LIBOSXUI): $(call FindLib, $(MODULE), osxapp)
973 
974   $(BUILD_LIBOSXUI): $(BUILD_LIBAWT_LWAWT)
975 
976 endif
977 
978 ################################################################################
979 
980 # Hook to include the corresponding custom file, if present.
981 $(eval $(call IncludeCustomExtension, lib/Awt2dLibraries.gmk))
<a name="18" id="anc18"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="18" type="hidden" />
</body>
</html>