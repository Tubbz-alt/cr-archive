<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff make/lib/Awt2dLibraries.gmk</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="../launcher/LauncherCommon.gmk.udiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="CoreLibraries.gmk.udiff.html" target="_top">next &gt;</a></center>    <h2>make/lib/Awt2dLibraries.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -37,11 +37,11 @@</span>
  
  ################################################################################
  
  # We must not include java.desktop/unix/native/libmlib_image, which is only
  # for usage by solaris-sparc in libmlib_image_v.
<span class="udiff-line-modified-removed">- BUILD_LIBMLIB_EXCLUDE_SRC_PATTERNS := unix</span>
<span class="udiff-line-modified-added">+ BUILD_LIBMLIB_EXCLUDE_SRC_PATTERNS := /unix/</span>
  
  BUILD_LIBMLIB_CFLAGS := -D__USE_J2D_NAMES -D__MEDIALIB_OLD_NAMES -DMLIB_NO_LIBSUNMATH
  
  ifeq ($(call isTargetCpuBits, 64), true)
    BUILD_LIBMLIB_CFLAGS += -DMLIB_OS64BIT
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -227,11 +227,10 @@</span>
      EXTRA_HEADER_DIRS := $(LIBAWT_EXTRA_HEADER_DIRS), \
      DISABLED_WARNINGS_gcc := sign-compare unused-result maybe-uninitialized \
          format-nonliteral parentheses unused-value unused-function, \
      DISABLED_WARNINGS_clang := logical-op-parentheses extern-initializer \
          sign-compare format-nonliteral, \
<span class="udiff-line-removed">-     DISABLED_WARNINGS_solstudio := E_DECLARATION_IN_CODE, \</span>
      DISABLED_WARNINGS_microsoft := 4244 4267 4996, \
      ASFLAGS := $(LIBAWT_ASFLAGS), \
      LDFLAGS := $(LDFLAGS_JDKLIB) $(call SET_SHARED_LIBRARY_ORIGIN), \
      LDFLAGS_macosx := -L$(INSTALL_LIBRARIES_HERE), \
      LDFLAGS_windows := -delayload:user32.dll -delayload:gdi32.dll \
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -337,12 +336,12 @@</span>
              unused-result maybe-uninitialized format \
              format-security int-to-pointer-cast parentheses \
              implicit-fallthrough undef unused-function, \
          DISABLED_WARNINGS_clang := parentheses format undef \
              logical-op-parentheses format-nonliteral int-conversion, \
<span class="udiff-line-modified-removed">-         DISABLED_WARNINGS_solstudio := E_DECLARATION_IN_CODE \</span>
<span class="udiff-line-modified-removed">-             E_ASSIGNMENT_TYPE_MISMATCH E_NON_CONST_INIT, \</span>
<span class="udiff-line-modified-added">+         DISABLED_WARNINGS_solstudio := E_ASSIGNMENT_TYPE_MISMATCH \</span>
<span class="udiff-line-modified-added">+              E_NON_CONST_INIT, \</span>
          LDFLAGS := $(LDFLAGS_JDKLIB) \
              $(call SET_SHARED_LIBRARY_ORIGIN) \
              -L$(INSTALL_LIBRARIES_HERE), \
          LIBS :=  $(X_LIBS) $(LIBAWT_XAWT_LIBS), \
      ))
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -376,18 +375,17 @@</span>
      NAME := lcms, \
      INCLUDE_FILES := $(BUILD_LIBLCMS_INCLUDE_FILES), \
      OPTIMIZATION := HIGHEST, \
      CFLAGS := $(CFLAGS_JDKLIB) \
          $(LCMS_CFLAGS), \
<span class="udiff-line-removed">-     CFLAGS_solaris := -xc99=no_lib, \</span>
      CFLAGS_windows := -DCMS_IS_WINDOWS_, \
      EXTRA_HEADER_DIRS := \
          common/awt/debug \
          libawt/java2d, \
      HEADERS_FROM_SRC := $(LIBLCMS_HEADERS_FROM_SRC), \
      DISABLED_WARNINGS_gcc := format-nonliteral type-limits \
<span class="udiff-line-modified-removed">-         misleading-indentation undef unused-function, \</span>
<span class="udiff-line-modified-added">+         misleading-indentation undef unused-function stringop-truncation, \</span>
      DISABLED_WARNINGS_clang := tautological-compare format-nonliteral undef, \
      DISABLED_WARNINGS_solstudio := E_STATEMENT_NOT_REACHED, \
      DISABLED_WARNINGS_microsoft := 4819, \
      LDFLAGS := $(LDFLAGS_JDKLIB) \
          $(call SET_SHARED_LIBRARY_ORIGIN), \
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -470,24 +468,19 @@</span>
        OPTIMIZATION := LOW, \
        CFLAGS := $(CFLAGS_JDKLIB) \
            $(LIBAWT_HEADLESS_CFLAGS), \
        EXTRA_HEADER_DIRS := $(LIBAWT_HEADLESS_EXTRA_HEADER_DIRS), \
        DISABLED_WARNINGS_gcc := unused-function, \
<span class="udiff-line-removed">-       DISABLED_WARNINGS_xlc := 1506-356, \</span>
        DISABLED_WARNINGS_solstudio := E_EMPTY_TRANSLATION_UNIT, \
        LDFLAGS := $(LDFLAGS_JDKLIB) \
            $(call SET_SHARED_LIBRARY_ORIGIN), \
        LDFLAGS_unix := -L$(INSTALL_LIBRARIES_HERE), \
        LIBS_unix := -lawt -ljvm -ljava, \
        LIBS_linux := $(LIBM) $(LIBDL), \
        LIBS_solaris := $(LIBM) $(LIBDL) $(LIBCXX), \
    ))
  
<span class="udiff-line-removed">-   # AIX warning explanation:</span>
<span class="udiff-line-removed">-   # 1506-356 : (W) Compilation unit is empty.</span>
<span class="udiff-line-removed">-   #            This happens during the headless build</span>
<span class="udiff-line-removed">- </span>
    $(BUILD_LIBAWT_HEADLESS): $(BUILD_LIBAWT)
  
    TARGETS += $(BUILD_LIBAWT_HEADLESS)
  
  endif
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -504,10 +497,12 @@</span>
  
    # For use by libfontmanager:
    LIBFREETYPE_CFLAGS := -I$(BUILD_LIBFREETYPE_HEADER_DIRS)
    ifeq ($(call isTargetOs, windows), true)
      LIBFREETYPE_LIBS := $(SUPPORT_OUTPUTDIR)/native/$(MODULE)/libfreetype/freetype.lib
<span class="udiff-line-added">+     # freetype now requires you to manually define this (see ftconfig.h)</span>
<span class="udiff-line-added">+     BUILD_LIBFREETYPE_CFLAGS += -DDLL_EXPORT</span>
    else
      LIBFREETYPE_LIBS := -lfreetype
    endif
  
    $(eval $(call SetupJdkLibrary, BUILD_LIBFREETYPE, \
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -517,12 +512,12 @@</span>
            $(BUILD_LIBFREETYPE_CFLAGS), \
        EXTRA_HEADER_DIRS := $(BUILD_LIBFREETYPE_HEADER_DIRS), \
        DISABLED_WARNINGS_solstudio := \
           E_STATEMENT_NOT_REACHED \
           E_END_OF_LOOP_CODE_NOT_REACHED, \
<span class="udiff-line-modified-removed">-       DISABLED_WARNINGS_microsoft := 4267 4244 4312 4819, \</span>
<span class="udiff-line-modified-removed">-       DISABLED_WARNINGS_gcc := implicit-fallthrough, \</span>
<span class="udiff-line-modified-added">+       DISABLED_WARNINGS_microsoft := 4018 4267 4244 4312 4819, \</span>
<span class="udiff-line-modified-added">+       DISABLED_WARNINGS_gcc := implicit-fallthrough cast-function-type bad-function-cast, \</span>
        LDFLAGS := $(LDFLAGS_JDKLIB) \
            $(call SET_SHARED_LIBRARY_ORIGIN), \
    ))
  
    TARGETS += $(BUILD_LIBFREETYPE)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -534,11 +529,12 @@</span>
  
  HARFBUZZ_CFLAGS := -DHAVE_OT -DHAVE_FALLBACK -DHAVE_UCDN -DHAVE_ROUND
  
  ifeq ($(call isTargetOs, windows), false)
    HARFBUZZ_CFLAGS += -DGETPAGESIZE -DHAVE_MPROTECT -DHAVE_PTHREAD \
<span class="udiff-line-modified-removed">-                       -DHAVE_SYSCONF -DHAVE_SYS_MMAN_H -DHAVE_UNISTD_H</span>
<span class="udiff-line-modified-added">+                       -DHAVE_SYSCONF -DHAVE_SYS_MMAN_H -DHAVE_UNISTD_H \</span>
<span class="udiff-line-added">+                       -DHB_NO_PRAGMA_GCC_DIAGNOSTIC</span>
  endif
  ifeq ($(call isTargetOs, linux macosx), true)
    HARFBUZZ_CFLAGS += -DHAVE_INTEL_ATOMIC_PRIMITIVES
  endif
  ifeq ($(call isTargetOs, solaris), true)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -611,23 +607,23 @@</span>
      WARNINGS_AS_ERRORS_xlc := false, \
      DISABLED_WARNINGS_gcc := sign-compare int-to-pointer-cast \
          type-limits missing-field-initializers implicit-fallthrough \
          strict-aliasing undef unused-function, \
      DISABLED_WARNINGS_CXX_gcc := reorder delete-non-virtual-dtor strict-overflow \
<span class="udiff-line-modified-removed">-         maybe-uninitialized \</span>
<span class="udiff-line-removed">-         missing-attributes class-memaccess, \</span>
<span class="udiff-line-modified-added">+         maybe-uninitialized class-memaccess, \</span>
      DISABLED_WARNINGS_clang := unused-value incompatible-pointer-types \
          tautological-constant-out-of-range-compare int-to-pointer-cast \
          sign-compare undef missing-field-initializers, \
      DISABLED_WARNINGS_C_solstudio = \
          E_INTEGER_OVERFLOW_DETECTED \
          E_ARG_INCOMPATIBLE_WITH_ARG_L \
          E_ENUM_VAL_OVERFLOWS_INT_MAX, \
      DISABLED_WARNINGS_CXX_solstudio := \
          truncwarn wvarhidenmem wvarhidemem wbadlkginit identexpected \
<span class="udiff-line-modified-removed">-         hidevf w_novirtualdescr arrowrtn2, \</span>
<span class="udiff-line-modified-removed">-     DISABLED_WARNINGS_microsoft := 4267 4244 4018 4090 4996 4146 4334 4819 4101, \</span>
<span class="udiff-line-modified-added">+         hidevf w_novirtualdescr arrowrtn2 refmemnoconstr_aggr unknownpragma \</span>
<span class="udiff-line-modified-added">+         doubunder wunreachable, \</span>
<span class="udiff-line-added">+     DISABLED_WARNINGS_microsoft := 4267 4244 4018 4090 4996 4146 4334 4819 4101 4068 4805 4138, \</span>
      LDFLAGS := $(subst -Xlinker -z -Xlinker defs,, \
          $(subst -Wl$(COMMA)-z$(COMMA)defs,,$(LDFLAGS_JDKLIB))) $(LDFLAGS_CXX_JDK) \
          $(call SET_SHARED_LIBRARY_ORIGIN), \
      LDFLAGS_unix := -L$(INSTALL_LIBRARIES_HERE), \
      LDFLAGS_aix := -Wl$(COMMA)-berok, \
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -695,11 +691,11 @@</span>
  
  else # not windows
  
    ifeq ($(call isTargetOs, macosx), true)
      # libjawt on macosx do not use the unix code
<span class="udiff-line-modified-removed">-     LIBJAWT_EXCLUDE_SRC_PATTERNS := unix</span>
<span class="udiff-line-modified-added">+     LIBJAWT_EXCLUDE_SRC_PATTERNS := /unix/</span>
    endif
  
    ifeq ($(call isTargetOs, macosx), true)
      JAWT_LIBS := -lawt_lwawt
    else
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -785,14 +781,15 @@</span>
      LIBSPLASHSCREEN_EXTRA_SRC += java.base:libzip/zlib
    endif
  
    ifeq ($(call isTargetOs, macosx), true)
      # libsplashscreen on macosx do not use the unix code
<span class="udiff-line-modified-removed">-     LIBSPLASHSCREEN_EXCLUDE_SRC_PATTERNS := unix</span>
<span class="udiff-line-modified-added">+     LIBSPLASHSCREEN_EXCLUDE_SRC_PATTERNS := /unix/</span>
    endif
  
<span class="udiff-line-modified-removed">-   LIBSPLASHSCREEN_CFLAGS += -DSPLASHSCREEN -DPNG_NO_MMX_CODE -DPNG_ARM_NEON_OPT=0</span>
<span class="udiff-line-modified-added">+   LIBSPLASHSCREEN_CFLAGS += -DSPLASHSCREEN -DPNG_NO_MMX_CODE \</span>
<span class="udiff-line-added">+                             -DPNG_ARM_NEON_OPT=0 -DPNG_ARM_NEON_IMPLEMENTATION=0</span>
  
    ifeq ($(call isTargetOs, linux), true)
      ifeq ($(call isTargetCpuArch, ppc), true)
        LIBSPLASHSCREEN_CFLAGS += -DPNG_POWERPC_VSX_OPT=0
      endif
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -820,10 +817,11 @@</span>
    ifeq ($(call isTargetOs, macosx), true)
      LIBSPLASHSCREEN_LIBS += \
          $(LIBM) -lpthread -liconv -losxapp \
          -framework ApplicationServices \
          -framework Foundation \
<span class="udiff-line-added">+         -framework Security \</span>
          -framework Cocoa \
          -framework JavaNativeFoundation
    else ifeq ($(call isTargetOs, windows), true)
      LIBSPLASHSCREEN_LIBS += kernel32.lib user32.lib gdi32.lib delayimp.lib $(WIN_JAVA_LIB) jvm.lib
    else
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -848,12 +846,11 @@</span>
        EXTRA_HEADER_DIRS := $(LIBSPLASHSCREEN_HEADER_DIRS), \
        DISABLED_WARNINGS_gcc := sign-compare type-limits unused-result \
            maybe-uninitialized shift-negative-value implicit-fallthrough \
            unused-function, \
        DISABLED_WARNINGS_clang := incompatible-pointer-types sign-compare, \
<span class="udiff-line-modified-removed">-       DISABLED_WARNINGS_solstudio := E_NEWLINE_NOT_LAST E_DECLARATION_IN_CODE \</span>
<span class="udiff-line-removed">-           E_STATEMENT_NOT_REACHED, \</span>
<span class="udiff-line-modified-added">+       DISABLED_WARNINGS_solstudio := E_STATEMENT_NOT_REACHED, \</span>
        DISABLED_WARNINGS_microsoft := 4018 4244 4267, \
        LDFLAGS := $(LDFLAGS_JDKLIB) \
            $(call SET_SHARED_LIBRARY_ORIGIN), \
        LDFLAGS_macosx := -L$(INSTALL_LIBRARIES_HERE), \
        LDFLAGS_windows := -delayload:user32.dll, \
</pre>
<center><a href="../launcher/LauncherCommon.gmk.udiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="CoreLibraries.gmk.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>