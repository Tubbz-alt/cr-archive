<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff make/RunTestsPrebuilt.gmk</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
<body>
<center><a href="RunTests.gmk.cdiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="RunTestsPrebuiltSpec.gmk.cdiff.html" target="_top">next &gt;</a></center>    <h2>make/RunTestsPrebuilt.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  #
<span class="line-modified">! # Copyright (c) 2017, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  #
  # This code is free software; you can redistribute it and/or modify it
  # under the terms of the GNU General Public License version 2 only, as
  # published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  #
<span class="line-modified">! # Copyright (c) 2017, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  #
  # This code is free software; you can redistribute it and/or modify it
  # under the terms of the GNU General Public License version 2 only, as
  # published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 228,11 ***</span>
    )
  else ifeq ($(OPENJDK_TARGET_OS), macosx)
    NUM_CORES := $(shell /usr/sbin/sysctl -n hw.ncpu)
    MEMORY_SIZE := $(shell $(EXPR) `/usr/sbin/sysctl -n hw.memsize` / 1024 / 1024)
  else ifeq ($(OPENJDK_TARGET_OS), solaris)
<span class="line-modified">!   NUM_CORES := $(shell LC_MESSAGES=C /usr/sbin/psrinfo -v | $(GREP) -c on-line)</span>
    MEMORY_SIZE := $(shell \
        /usr/sbin/prtconf 2&gt; /dev/null | $(GREP) &quot;^Memory [Ss]ize&quot; | $(AWK) &#39;{print $$3}&#39; \
    )
  else ifeq ($(OPENJDK_TARGET_OS), windows)
    NUM_CORES := $(NUMBER_OF_PROCESSORS)
<span class="line-new-header">--- 228,11 ---</span>
    )
  else ifeq ($(OPENJDK_TARGET_OS), macosx)
    NUM_CORES := $(shell /usr/sbin/sysctl -n hw.ncpu)
    MEMORY_SIZE := $(shell $(EXPR) `/usr/sbin/sysctl -n hw.memsize` / 1024 / 1024)
  else ifeq ($(OPENJDK_TARGET_OS), solaris)
<span class="line-modified">!   NUM_CORES := $(shell /usr/sbin/psrinfo -v | $(GREP) -c on-line)</span>
    MEMORY_SIZE := $(shell \
        /usr/sbin/prtconf 2&gt; /dev/null | $(GREP) &quot;^Memory [Ss]ize&quot; | $(AWK) &#39;{print $$3}&#39; \
    )
  else ifeq ($(OPENJDK_TARGET_OS), windows)
    NUM_CORES := $(NUMBER_OF_PROCESSORS)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 334,13 ***</span>
  
  SPEC := $(NEW_SPEC)
  
  default: all
  
<span class="line-modified">! run-test-prebuilt:</span>
  	@$(RM) -f $(MAKESUPPORT_OUTPUTDIR)/exit-with-error
  	@cd $(TOPDIR) &amp;&amp; $(MAKE) $(MAKE_ARGS) -f make/RunTests.gmk run-test \
  	    TEST=&quot;$(TEST)&quot;
  
<span class="line-modified">! all: run-test-prebuilt</span>
  
<span class="line-modified">! .PHONY: default all</span>
<span class="line-new-header">--- 334,23 ---</span>
  
  SPEC := $(NEW_SPEC)
  
  default: all
  
<span class="line-modified">! test-prebuilt:</span>
<span class="line-added">+         # Need to make sure the failure logs output dir exists since</span>
<span class="line-added">+         # ExecuteWithLog is called in RunTests.gmk. The PrepareFailureLogs macro</span>
<span class="line-added">+         # is unfortunately not available at this point.</span>
<span class="line-added">+ 	$(call MakeDir, $(MAKESUPPORT_OUTPUTDIR)/failure-logs)</span>
  	@$(RM) -f $(MAKESUPPORT_OUTPUTDIR)/exit-with-error
<span class="line-added">+         # The lazy initialization of the cache file in FindTests.gmk does not</span>
<span class="line-added">+         # always work with RunTests.gmk. To guarantee that the jtreg test groups</span>
<span class="line-added">+         # are always found and parsed, call FindTests.gmk stand alone once</span>
<span class="line-added">+         # before calling RunTests.gmk.</span>
<span class="line-added">+ 	@cd $(TOPDIR) &amp;&amp; $(MAKE) $(MAKE_ARGS) -f make/common/FindTests.gmk \</span>
<span class="line-added">+ 	    SPEC=$(SPEC) FINDTESTS_STAND_ALONE=true</span>
  	@cd $(TOPDIR) &amp;&amp; $(MAKE) $(MAKE_ARGS) -f make/RunTests.gmk run-test \
  	    TEST=&quot;$(TEST)&quot;
  
<span class="line-modified">! all: test-prebuilt</span>
  
<span class="line-modified">! .PHONY: default all test-prebuilt</span>
</pre>
<center><a href="RunTests.gmk.cdiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="RunTestsPrebuiltSpec.gmk.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>