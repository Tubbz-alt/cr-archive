<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/jdk.security.auth/share/classes/com/sun/security/auth/module/NTSystem.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package com.sun.security.auth.module;
 27 
 28 /**
 29  * This class implementation retrieves and makes available NT
 30  * security information for the current user.
 31  *
 32  */
 33 public class NTSystem {
 34 
 35     private native void getCurrent(boolean debug);
 36     private native long getImpersonationToken0();
 37 
 38     // Warning: the next 6 fields are used by nt.c
 39     private String userName;
 40     private String domain;
 41     private String domainSID;
 42     private String userSID;
 43     private String[] groupIDs;
 44     private String primaryGroupID;
 45 
 46     private long   impersonationToken;
 47 
 48     /**
 49      * Instantiate an {@code NTSystem} and load
 50      * the native library to access the underlying system information.
 51      */
 52     public NTSystem() {
 53         this(false);
 54     }
 55 
 56     /**
 57      * Instantiate an {@code NTSystem} and load
 58      * the native library to access the underlying system information.
 59      */
 60     NTSystem(boolean debug) {
 61         loadNative();
 62         getCurrent(debug);
 63     }
 64 
 65     /**
 66      * Get the username for the current NT user.
 67      *
 68      * @return the username for the current NT user.
 69      */
 70     public String getName() {
 71         return userName;
 72     }
 73 
 74     /**
 75      * Get the domain for the current NT user.
 76      *
 77      * @return the domain for the current NT user.
 78      */
 79     public String getDomain() {
 80         return domain;
 81     }
 82 
 83     /**
 84      * Get a printable SID for the current NT user&#39;s domain.
 85      *
 86      * @return a printable SID for the current NT user&#39;s domain.
 87      */
 88     public String getDomainSID() {
 89         return domainSID;
 90     }
 91 
 92     /**
 93      * Get a printable SID for the current NT user.
 94      *
 95      * @return a printable SID for the current NT user.
 96      */
 97     public String getUserSID() {
 98         return userSID;
 99     }
100 
101     /**
102      * Get a printable primary group SID for the current NT user.
103      *
104      * @return the primary group SID for the current NT user.
105      */
106     public String getPrimaryGroupID() {
107         return primaryGroupID;
108     }
109 
110     /**
111      * Get the printable group SIDs for the current NT user.
112      *
113      * @return the group SIDs for the current NT user.
114      */
115     public String[] getGroupIDs() {
116         return groupIDs == null ? null : groupIDs.clone();
117     }
118 
119     /**
120      * Get an impersonation token for the current NT user.
121      *
122      * @return an impersonation token for the current NT user.
123      */
124     public synchronized long getImpersonationToken() {
125         if (impersonationToken == 0) {
126             impersonationToken = getImpersonationToken0();
127         }
128         return impersonationToken;
129     }
130 
131 
132     private void loadNative() {
133         System.loadLibrary(&quot;jaas&quot;);
134     }
135 }
    </pre>
  </body>
</html>