<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.jartool/share/man/jarsigner.1</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="jar.1.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../../jdk.javadoc/share/classes/jdk/javadoc/doclet/Doclet.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.jartool/share/man/jarsigner.1</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
<span class="line-modified">   1 &#39;\&quot; t</span>
<span class="line-modified">   2 .\&quot; Copyright (c) 1998, 2013, Oracle and/or its affiliates. All rights reserved.</span>
   3 .\&quot; DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4 .\&quot;
   5 .\&quot; This code is free software; you can redistribute it and/or modify it
   6 .\&quot; under the terms of the GNU General Public License version 2 only, as
   7 .\&quot; published by the Free Software Foundation.
   8 .\&quot;
   9 .\&quot; This code is distributed in the hope that it will be useful, but WITHOUT
  10 .\&quot; ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
<span class="line-modified">  11 .\&quot; FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License</span>
  12 .\&quot; version 2 for more details (a copy is included in the LICENSE file that
  13 .\&quot; accompanied this code).
  14 .\&quot;
  15 .\&quot; You should have received a copy of the GNU General Public License version
  16 .\&quot; 2 along with this work; if not, write to the Free Software Foundation,
  17 .\&quot; Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18 .\&quot;
  19 .\&quot; Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20 .\&quot; or visit www.oracle.com if you need additional information or have any
  21 .\&quot; questions.
  22 .\&quot;
<span class="line-modified">  23 .\&quot;     Arch: generic</span>
<span class="line-removed">  24 .\&quot;     Software: JDK 8</span>
<span class="line-removed">  25 .\&quot;     Date: 21 November 2013</span>
<span class="line-removed">  26 .\&quot;     SectDesc: Security Tools</span>
<span class="line-removed">  27 .\&quot;     Title: jarsigner.1</span>
  28 .\&quot;
<span class="line-modified">  29 .if n .pl 99999</span>
<span class="line-modified">  30 .TH jarsigner 1 &quot;21 November 2013&quot; &quot;JDK 8&quot; &quot;Security Tools&quot;</span>
<span class="line-modified">  31 .\&quot; -----------------------------------------------------------------</span>
<span class="line-modified">  32 .\&quot; * Define some portability stuff</span>
<span class="line-modified">  33 .\&quot; -----------------------------------------------------------------</span>
<span class="line-modified">  34 .\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="line-modified">  35 .\&quot; http://bugs.debian.org/507673</span>
<span class="line-modified">  36 .\&quot; http://lists.gnu.org/archive/html/groff/2009-02/msg00013.html</span>
<span class="line-modified">  37 .\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="line-modified">  38 .ie \n(.g .ds Aq \(aq</span>
<span class="line-modified">  39 .el       .ds Aq &#39;</span>
<span class="line-modified">  40 .\&quot; -----------------------------------------------------------------</span>
<span class="line-modified">  41 .\&quot; * set default formatting</span>
<span class="line-modified">  42 .\&quot; -----------------------------------------------------------------</span>
<span class="line-modified">  43 .\&quot; disable hyphenation</span>
<span class="line-modified">  44 .nh</span>
<span class="line-modified">  45 .\&quot; disable justification (adjust text to left margin only)</span>
<span class="line-modified">  46 .ad l</span>
<span class="line-modified">  47 .\&quot; -----------------------------------------------------------------</span>
<span class="line-modified">  48 .\&quot; * MAIN CONTENT STARTS HERE *</span>
<span class="line-modified">  49 .\&quot; -----------------------------------------------------------------</span>
<span class="line-modified">  50 </span>
<span class="line-modified">  51 .SH NAME    </span>
<span class="line-modified">  52 jarsigner \- Signs and verifies Java Archive (JAR) files\&amp;.</span>
<span class="line-modified">  53 .SH SYNOPSIS    </span>
<span class="line-modified">  54 .sp     </span>
<span class="line-modified">  55 .nf     </span>
<span class="line-modified">  56 </span>
<span class="line-modified">  57 \fBjarsigner\fR [ \fIoptions\fR ] \fIjar\-file\fR \fIalias\fR</span>
<span class="line-modified">  58 .fi     </span>
<span class="line-modified">  59 .nf     </span>
<span class="line-modified">  60 </span>
<span class="line-modified">  61 \fBjarsigner\fR \fB\-verify\fR [ \fIoptions\fR ] \fIjar\-file\fR [\fIalias \&amp;.\&amp;.\&amp;.\fR]</span>
<span class="line-modified">  62 .fi     </span>
<span class="line-modified">  63 .sp     </span>
<span class="line-modified">  64 .TP     </span>
<span class="line-modified">  65 \fIoptions\fR</span>
<span class="line-modified">  66 The command-line options\&amp;. See Options\&amp;.</span>
<span class="line-modified">  67 .TP</span>
<span class="line-modified">  68 -verify</span>
<span class="line-modified">  69 .br</span>
<span class="line-modified">  70 The \f3-verify\fR option can take zero or more keystore alias names after the JAR file name\&amp;. When the \f3-verify\fR option is specified, the \f3jarsigner\fR command checks that the certificate used to verify each signed entry in the JAR file matches one of the keystore aliases\&amp;. The aliases are defined in the keystore specified by \f3-keystore\fR or the default keystore\&amp;.</span>
<span class="line-modified">  71 </span>
<span class="line-modified">  72 If you also specified the \f3-strict\fR option, and the \f3jarsigner\fR command detected severe warnings, the message, &quot;jar verified, with signer errors&quot; is displayed\&amp;.</span>
<span class="line-modified">  73 .TP     </span>
<span class="line-modified">  74 \fIjar-file\fR</span>
<span class="line-modified">  75 The JAR file to be signed\&amp;.</span>
<span class="line-modified">  76 </span>
<span class="line-modified">  77 If you also specified the \f3-strict\fR option, and the \f3jarsigner\fR command detected severe warnings, the message, &quot;jar signed, with signer errors&quot; is displayed\&amp;.</span>
<span class="line-modified">  78 .TP     </span>
<span class="line-modified">  79 \fIalias\fR</span>
<span class="line-modified">  80 The aliases are defined in the keystore specified by \f3-keystore\fR or the default keystore\&amp;.</span>
<span class="line-modified">  81 .SH DESCRIPTION    </span>
<span class="line-modified">  82 The \f3jarsigner\fR tool has two purposes:</span>
<span class="line-modified">  83 .TP 0.2i    </span>
<span class="line-modified">  84 \(bu</span>
<span class="line-modified">  85 To sign Java Archive (JAR) files\&amp;.</span>
<span class="line-modified">  86 .TP 0.2i    </span>
<span class="line-modified">  87 \(bu</span>
<span class="line-modified">  88 To verify the signatures and integrity of signed JAR files\&amp;.</span>
<span class="line-modified">  89 .PP</span>
<span class="line-modified">  90 The JAR feature enables the packaging of class files, images, sounds, and other digital data in a single file for faster and easier distribution\&amp;. A tool named \f3jar\fR enables developers to produce JAR files\&amp;. (Technically, any zip file can also be considered a JAR file, although when created by the \f3jar\fR command or processed by the \f3jarsigner\fR command, JAR files also contain a \f3META-INF/MANIFEST\&amp;.MF\fR file\&amp;.)</span>
<span class="line-modified">  91 .PP</span>
<span class="line-modified">  92 A digital signature is a string of bits that is computed from some data (the data being signed) and the private key of an entity (a person, company, and so on)\&amp;. Similar to a handwritten signature, a digital signature has many useful characteristics:</span>
<span class="line-modified">  93 .TP 0.2i    </span>
<span class="line-modified">  94 \(bu</span>
<span class="line-modified">  95 Its authenticity can be verified by a computation that uses the public key corresponding to the private key used to generate the signature\&amp;.</span>
<span class="line-modified">  96 .TP 0.2i    </span>
<span class="line-modified">  97 \(bu</span>
<span class="line-modified">  98 It cannot be forged, assuming the private key is kept secret\&amp;.</span>
<span class="line-modified">  99 .TP 0.2i    </span>
<span class="line-modified"> 100 \(bu</span>
<span class="line-modified"> 101 It is a function of the data signed and thus cannot be claimed to be the signature for other data as well\&amp;.</span>
<span class="line-modified"> 102 .TP 0.2i    </span>
<span class="line-modified"> 103 \(bu</span>
<span class="line-modified"> 104 The signed data cannot be changed\&amp;. If the data is changed, then the signature cannot be verified as authentic\&amp;.</span>
<span class="line-modified"> 105 .PP</span>
<span class="line-modified"> 106 To generate an entity\&amp;&#39;s signature for a file, the entity must first have a public/private key pair associated with it and one or more certificates that authenticate its public key\&amp;. A certificate is a digitally signed statement from one entity that says that the public key of another entity has a particular value\&amp;.</span>
<span class="line-modified"> 107 .PP</span>
<span class="line-modified"> 108 The \f3jarsigner\fR command uses key and certificate information from a keystore to generate digital signatures for JAR files\&amp;. A keystore is a database of private keys and their associated X\&amp;.509 certificate chains that authenticate the corresponding public keys\&amp;. The \f3keytool\fR command is used to create and administer keystores\&amp;.</span>
<span class="line-modified"> 109 .PP</span>
<span class="line-modified"> 110 The \f3jarsigner\fR command uses an entity\&amp;&#39;s private key to generate a signature\&amp;. The signed JAR file contains, among other things, a copy of the certificate from the keystore for the public key corresponding to the private key used to sign the file\&amp;. The \f3jarsigner\fR command can verify the digital signature of the signed JAR file using the certificate inside it (in its signature block file)\&amp;.</span>
<span class="line-modified"> 111 .PP</span>
<span class="line-modified"> 112 The \f3jarsigner\fR command can generate signatures that include a time stamp that lets a systems or deployer (including Java Plug-in) to check whether the JAR file was signed while the signing certificate was still valid\&amp;. In addition, APIs allow applications to obtain the timestamp information\&amp;.</span>
<span class="line-modified"> 113 .PP</span>
<span class="line-modified"> 114 At this time, the \f3jarsigner\fR command can only sign JAR files created by the \f3jar\fR command or zip files\&amp;. JAR files are the same as zip files, except they also have a \f3META-INF/MANIFEST\&amp;.MF\fR file\&amp;. A \f3META-INF/MANIFEST\&amp;.MF\fR file is created when the \f3jarsigner\fR command signs a zip file\&amp;.</span>
<span class="line-modified"> 115 .PP</span>
<span class="line-modified"> 116 The default \f3jarsigner\fR command behavior is to sign a JAR or zip file\&amp;. Use the \f3-verify\fR option to verify a signed JAR file\&amp;.</span>
<span class="line-modified"> 117 .PP</span>
<span class="line-modified"> 118 The \f3jarsigner\fR command also attempts to validate the signer\&amp;&#39;s certificate after signing or verifying\&amp;. If there is a validation error or any other problem, the command generates warning messages\&amp;. If you specify the \f3-strict\fR option, then the command treats severe warnings as errors\&amp;. See Errors and Warnings\&amp;.</span>
<span class="line-modified"> 119 .SS KEYSTORE\ ALIASES    </span>
<span class="line-modified"> 120 All keystore entities are accessed with unique aliases\&amp;.</span>
<span class="line-modified"> 121 .PP</span>
<span class="line-modified"> 122 When you use the \f3jarsigner\fR command to sign a JAR file, you must specify the alias for the keystore entry that contains the private key needed to generate the signature\&amp;. For example, the following command signs the JAR file named \f3MyJARFile\&amp;.jar\fR with the private key associated with the alias \f3duke\fR in the keystore named \f3mystore\fR in the \f3working\fR directory\&amp;. Because no output file is specified, it overwrites \f3MyJARFile\&amp;.jar\fR with the signed JAR file\&amp;.</span>
<span class="line-modified"> 123 .sp     </span>
<span class="line-modified"> 124 .nf     </span>
<span class="line-modified"> 125 \f3jarsigner \-keystore /working/mystore \-storepass &lt;keystore password&gt;\fP</span>
<span class="line-modified"> 126 .fi     </span>
<span class="line-modified"> 127 .nf     </span>
<span class="line-modified"> 128 \f3      \-keypass &lt;private key password&gt; MyJARFile\&amp;.jar duke\fP</span>
<span class="line-modified"> 129 .fi     </span>
<span class="line-modified"> 130 .nf     </span>
<span class="line-modified"> 131 \f3\fR</span>
<span class="line-modified"> 132 .fi     </span>
<span class="line-modified"> 133 .sp     </span>
<span class="line-modified"> 134 Keystores are protected with a password, so the store password must be specified\&amp;. You are prompted for it when you do not specify it on the command line\&amp;. Similarly, private keys are protected in a keystore with a password, so the private key\&amp;&#39;s password must be specified, and you are prompted for the password when you do not specify it on the command line and it is not the same as the store password\&amp;.</span>
<span class="line-modified"> 135 .SS KEYSTORE\ LOCATION    </span>
<span class="line-modified"> 136 The \f3jarsigner\fR command has a \f3-keystore\fR option for specifying the URL of the keystore to be used\&amp;. The keystore is by default stored in a file named \f3\&amp;.keystore\fR in the user\&amp;&#39;s home directory, as determined by the \f3user\&amp;.home\fR system property\&amp;.</span>
<span class="line-modified"> 137 .PP</span>
<span class="line-modified"> 138 On Oracle Solaris systems, \f3user\&amp;.home\fR defaults to the user\&amp;&#39;s home directory\&amp;.</span>
<span class="line-modified"> 139 .PP</span>
<span class="line-modified"> 140 The input stream from the \f3-keystore\fR option is passed to the \f3KeyStore\&amp;.load\fR method\&amp;. If \f3NONE\fR is specified as the URL, then a null stream is passed to the \f3KeyStore\&amp;.load\fR method\&amp;. \f3NONE\fR should be specified when the \f3KeyStore\fR class is not file based, for example, when it resides on a hardware token device\&amp;.</span>
<span class="line-modified"> 141 .SS KEYSTORE\ IMPLEMENTATION    </span>
<span class="line-modified"> 142 The \f3KeyStore\fR class provided in the \f3java\&amp;.security\fR package supplies a number of well-defined interfaces to access and modify the information in a keystore\&amp;. You can have multiple different concrete implementations, where each implementation is for a particular type of keystore\&amp;.</span>
<span class="line-modified"> 143 .PP</span>
<span class="line-modified"> 144 Currently, there are two command-line tools that use keystore implementations (\f3keytool\fR and \f3jarsigner\fR), and a GUI-based tool named Policy Tool\&amp;. Because the \f3KeyStore\fR class is publicly available, JDK users can write additional security applications that use it\&amp;.</span>
<span class="line-modified"> 145 .PP</span>
<span class="line-modified"> 146 There is a built-in default implementation provided by Oracle that implements the keystore as a file, that uses a proprietary keystore type (format) named JKS\&amp;. The built-in implementation protects each private key with its individual password and protects the integrity of the entire keystore with a (possibly different) password\&amp;.</span>
<span class="line-modified"> 147 .PP</span>
<span class="line-modified"> 148 Keystore implementations are provider-based, which means the application interfaces supplied by the \f3KeyStore\fR class are implemented in terms of a Service Provider Interface (SPI)\&amp;. There is a corresponding abstract \f3KeystoreSpi\fR class, also in the \f3java\&amp;.security package\fR, that defines the Service Provider Interface methods that providers must implement\&amp;. The term provider refers to a package or a set of packages that supply a concrete implementation of a subset of services that can be accessed by the Java Security API\&amp;. To provide a keystore implementation, clients must implement a provider and supply a \f3KeystoreSpi\fR subclass implementation, as described in How to Implement a Provider in the Java Cryptography Architecture at http://docs\&amp;.oracle\&amp;.com/javase/8/docs/technotes/guides/security/crypto/HowToImplAProvider\&amp;.html</span>
<span class="line-modified"> 149 .PP</span>
<span class="line-modified"> 150 Applications can choose different types of keystore implementations from different providers, with the \f3getInstance\fR factory method in the \f3KeyStore\fR class\&amp;. A keystore type defines the storage and data format of the keystore information and the algorithms used to protect private keys in the keystore and the integrity of the keystore itself\&amp;. Keystore implementations of different types are not compatible\&amp;.</span>
<span class="line-modified"> 151 .PP</span>
<span class="line-modified"> 152 The \f3jarsigner\fR command can read file-based keystores from any location that can be specified using a URL\&amp;. In addition, the command can read non-file-based keystores such as those provided by MSCAPI on Windows and PKCS11 on all platforms\&amp;.</span>
<span class="line-modified"> 153 .PP</span>
<span class="line-modified"> 154 For the \f3jarsigner\fR and \f3keytool\fR commands, you can specify a keystore type at the command line with the \f3-storetype\fR option\&amp;. For Policy Tool, you can specify a keystore type with the \fIEdit\fR command in the \fIKeyStore\fR menu\&amp;.</span>
<span class="line-modified"> 155 .PP</span>
<span class="line-modified"> 156 If you do not explicitly specify a keystore type, then the tools choose a keystore implementation based on the value of the \f3keystore\&amp;.type\fR property specified in the security properties file\&amp;. The security properties file is called \f3java\&amp;.security\fR, and it resides in the JDK security properties directory, \f3java\&amp;.home/lib/security\fR, where \f3java\&amp;.home\fR is the runtime environment\&amp;&#39;s directory\&amp;. The \f3jre\fR directory in the JDK or the top-level directory of the Java Runtime Environment (JRE)\&amp;.</span>
<span class="line-modified"> 157 .PP</span>
<span class="line-modified"> 158 Each tool gets the \f3keystore\&amp;.type\fR value and then examines all the installed providers until it finds one that implements keystores of that type\&amp;. It then uses the keystore implementation from that provider\&amp;.</span>
<span class="line-modified"> 159 .PP</span>
<span class="line-modified"> 160 The \f3KeyStore\fR class defines a static method named \f3getDefaultType\fR that lets applications and applets retrieve the value of the \f3keystore\&amp;.type\fR property\&amp;. The following line of code creates an instance of the default keystore type as specified in the \f3keystore\&amp;.type property\fR:</span>
<span class="line-modified"> 161 .sp     </span>
<span class="line-modified"> 162 .nf     </span>
<span class="line-modified"> 163 \f3KeyStore keyStore = KeyStore\&amp;.getInstance(KeyStore\&amp;.getDefaultType());\fP</span>
<span class="line-modified"> 164 .fi     </span>
<span class="line-modified"> 165 .nf     </span>
<span class="line-modified"> 166 \f3\fR</span>
<span class="line-modified"> 167 .fi     </span>
<span class="line-modified"> 168 .sp     </span>
<span class="line-modified"> 169 The default keystore type is \f3jks\fR (the proprietary type of the keystore implementation provided by Oracle)\&amp;. This is specified by the following line in the security properties file:</span>
<span class="line-modified"> 170 .sp     </span>
<span class="line-modified"> 171 .nf     </span>
<span class="line-modified"> 172 \f3keystore\&amp;.type=jks\fP</span>
<span class="line-modified"> 173 .fi     </span>
<span class="line-modified"> 174 .nf     </span>
<span class="line-modified"> 175 \f3\fR</span>
<span class="line-modified"> 176 .fi     </span>
<span class="line-modified"> 177 .sp     </span>
<span class="line-modified"> 178 Case does not matter in keystore type designations\&amp;. For example, \f3JKS\fR is the same as \f3jks\fR\&amp;.</span>
<span class="line-modified"> 179 .PP</span>
<span class="line-modified"> 180 To have the tools use a keystore implementation other than the default, change that line to specify a different keystore type\&amp;. For example, if you have a provider package that supplies a keystore implementation for a keystore type called \f3pkcs12\fR, then change the line to the following:</span>
<span class="line-modified"> 181 .sp     </span>
<span class="line-modified"> 182 .nf     </span>
<span class="line-modified"> 183 \f3keystore\&amp;.type=pkcs12\fP</span>
<span class="line-modified"> 184 .fi     </span>
<span class="line-modified"> 185 .nf     </span>
<span class="line-modified"> 186 \f3\fR</span>
<span class="line-modified"> 187 .fi     </span>
<span class="line-modified"> 188 .sp     </span>
<span class="line-modified"> 189 \fINote:\fR If you use the PKCS 11 provider package, then see &quot;KeyTool&quot; and &quot;JarSigner&quot; in Java PKCS #11 Reference Guide at http://docs\&amp;.oracle\&amp;.com/javase/8/docs/technotes/guides/security/p11guide\&amp;.html</span>
<span class="line-modified"> 190 .SS SUPPORTED\ ALGORITHMS    </span>
<span class="line-modified"> 191 By default, the \f3jarsigner\fR command signs a JAR file using one of the following algorithms:</span>
<span class="line-modified"> 192 .TP 0.2i    </span>
<span class="line-modified"> 193 \(bu</span>
<span class="line-modified"> 194 Digital Signature Algorithm (DSA) with the SHA1 digest algorithm</span>
<span class="line-modified"> 195 .TP 0.2i    </span>
<span class="line-modified"> 196 \(bu</span>
<span class="line-modified"> 197 RSA algorithm with the SHA256 digest algorithm</span>
<span class="line-modified"> 198 .TP 0.2i    </span>
<span class="line-modified"> 199 \(bu</span>
<span class="line-modified"> 200 Elliptic Curve (EC) cryptography algorithm with the SHA256 with Elliptic Curve Digital Signature Algorithm (ECDSA)\&amp;.</span>
<span class="line-modified"> 201 .PP</span>
<span class="line-modified"> 202 If the signer\&amp;&#39;s public and private keys are DSA keys, then \f3jarsigner\fR signs the JAR file with the \f3SHA1withDSA\fR algorithm\&amp;. If the signer\&amp;&#39;s keys are RSA keys, then \f3jarsigner\fR attempts to sign the JAR file with the \f3SHA256withRSA\fR algorithm\&amp;. If the signer\&amp;&#39;s keys are EC keys, then \f3jarsigner\fR signs the JAR file with the \f3SHA256withECDSA\fR algorithm\&amp;.</span>
<span class="line-modified"> 203 .PP</span>
<span class="line-modified"> 204 These default signature algorithms can be overridden using the \f3-sigalg\fR option\&amp;.</span>
<span class="line-modified"> 205 .SS THE\ SIGNED\ JAR\ FILE    </span>
<span class="line-modified"> 206 When the \f3jarsigner\fR command is used to sign a JAR file, the output signed JAR file is exactly the same as the input JAR file, except that it has two additional files placed in the META-INF directory:</span>
<span class="line-modified"> 207 .TP 0.2i    </span>
<span class="line-modified"> 208 \(bu</span>
<span class="line-modified"> 209 A signature file with an \f3\&amp;.SF\fR extension</span>
<span class="line-modified"> 210 .TP 0.2i    </span>
<span class="line-modified"> 211 \(bu</span>
<span class="line-modified"> 212 A signature block file with a \f3\&amp;.DSA\fR, \f3\&amp;.RSA\fR, or \f3\&amp;.EC\fR extension</span>
<span class="line-modified"> 213 .PP</span>
<span class="line-modified"> 214 The base file names for these two files come from the value of the \f3-sigFile\fR option\&amp;. For example, when the option is \f3-sigFile MKSIGN\fR, the files are named \f3MKSIGN\&amp;.SF\fR and \f3MKSIGN\&amp;.DSA\fR</span>
<span class="line-modified"> 215 .PP</span>
<span class="line-modified"> 216 If no \f3-sigfile\fR option appears on the command line, then the base file name for the \f3\&amp;.SF\fR and \f3\&amp;.DSA\fR files is the first 8 characters of the alias name specified on the command line, all converted to uppercase\&amp;. If the alias name has fewer than 8 characters, then the full alias name is used\&amp;. If the alias name contains any characters that are not allowed in a signature file name, then each such character is converted to an underscore (_) character in forming the file name\&amp;. Valid characters include letters, digits, underscores, and hyphens\&amp;.</span>
<span class="line-modified"> 217 .PP</span>
<span class="line-modified"> 218 Signature File</span>
<span class="line-modified"> 219 </span>
<span class="line-modified"> 220 A signature file (\f3\&amp;.SF\fR file) looks similar to the manifest file that is always included in a JAR file when the \f3jarsigner\fR command is used to sign the file\&amp;. For each source file included in the JAR file, the \f3\&amp;.SF\fR file has three lines, such as in the manifest file, that list the following:</span>
<span class="line-modified"> 221 .TP 0.2i    </span>
<span class="line-modified"> 222 \(bu</span>





























































































































































































 223 File name
<span class="line-modified"> 224 .TP 0.2i    </span>
<span class="line-removed"> 225 \(bu</span>
 226 Name of the digest algorithm (SHA)
<span class="line-modified"> 227 .TP 0.2i    </span>
<span class="line-removed"> 228 \(bu</span>
 229 SHA digest value
 230 .PP
<span class="line-modified"> 231 In the manifest file, the SHA digest value for each source file is the digest (hash) of the binary data in the source file\&amp;. In the \f3\&amp;.SF\fR file, the digest value for a specified source file is the hash of the three lines in the manifest file for the source file\&amp;.</span>
 232 .PP
<span class="line-modified"> 233 The signature file, by default, includes a header with a hash of the whole manifest file\&amp;. The header also contains a hash of the manifest header\&amp;. The presence of the header enables verification optimization\&amp;. See JAR File Verification\&amp;.</span>

 234 .PP
<span class="line-modified"> 235 Signature Block File</span>
<span class="line-modified"> 236 </span>
<span class="line-modified"> 237 The \f3\&amp;.SF\fR file is signed and the signature is placed in the signature block file\&amp;. This file also contains, encoded inside it, the certificate or certificate chain from the keystore that authenticates the public key corresponding to the private key used for signing\&amp;. The file has the extension \f3\&amp;.DSA\fR, \f3\&amp;.RSA\fR, or \f3\&amp;.EC\fR, depending on the digest algorithm used\&amp;.</span>
<span class="line-modified"> 238 .SS SIGNATURE\ TIME\ STAMP    </span>
<span class="line-modified"> 239 The \f3jarsigner\fR command can generate and store a signature time stamp when signing a JAR file\&amp;. In addition, \f3jarsigner\fR supports alternative signing mechanisms\&amp;. This behavior is optional and is controlled by the user at the time of signing through these options\&amp;. See Options\&amp;.</span>
<span class="line-modified"> 240 .sp     </span>
<span class="line-modified"> 241 .nf     </span>
<span class="line-modified"> 242 \f3\-tsa \fIurl\fR\fP</span>
<span class="line-modified"> 243 .fi     </span>
<span class="line-modified"> 244 .nf     </span>
<span class="line-modified"> 245 \f3\-tsacert \fIalias\fR\fP</span>
<span class="line-modified"> 246 .fi     </span>
<span class="line-modified"> 247 .nf     </span>
<span class="line-modified"> 248 \f3\-altsigner \fIclass\fR\fP</span>
<span class="line-modified"> 249 .fi     </span>
<span class="line-modified"> 250 .nf     </span>
<span class="line-modified"> 251 \f3\-altsignerpath \fIclasspathlist\fR\fP</span>
<span class="line-modified"> 252 .fi     </span>
<span class="line-modified"> 253 .nf     </span>
<span class="line-modified"> 254 \f3\-tsapolicyid \fIpolicyid\fR\fP</span>
<span class="line-modified"> 255 .fi     </span>
<span class="line-modified"> 256 .nf     </span>
<span class="line-modified"> 257 \f3\fR</span>
<span class="line-modified"> 258 .fi     </span>
<span class="line-modified"> 259 .sp     </span>
<span class="line-modified"> 260 .SS JAR\ FILE\ VERIFICATION    </span>
<span class="line-modified"> 261 A successful JAR file verification occurs when the signatures are valid, and none of the files that were in the JAR file when the signatures were generated have changed since then\&amp;. JAR file verification involves the following steps:</span>
<span class="line-modified"> 262 .TP 0.4i    </span>
<span class="line-modified"> 263 1\&amp;.</span>
<span class="line-modified"> 264 Verify the signature of the \f3\&amp;.SF\fR file\&amp;.</span>
<span class="line-modified"> 265 </span>
<span class="line-modified"> 266 The verification ensures that the signature stored in each signature block (\f3\&amp;.DSA\fR) file was generated using the private key corresponding to the public key whose certificate (or certificate chain) also appears in the \f3\&amp;.DSA\fR file\&amp;. It also ensures that the signature is a valid signature of the corresponding signature (\f3\&amp;.SF\fR) file, and thus the \f3\&amp;.SF\fR file was not tampered with\&amp;.</span>
<span class="line-modified"> 267 .TP 0.4i    </span>
<span class="line-modified"> 268 2\&amp;.</span>
<span class="line-modified"> 269 Verify the digest listed in each entry in the \f3\&amp;.SF\fR file with each corresponding section in the manifest\&amp;.</span>
<span class="line-modified"> 270 </span>
<span class="line-modified"> 271 The \f3\&amp;.SF\fR file by default includes a header that contains a hash of the entire manifest file\&amp;. When the header is present, the verification can check to see whether or not the hash in the header matches the hash of the manifest file\&amp;. If there is a match, then verification proceeds to the next step\&amp;.</span>
<span class="line-modified"> 272 </span>
<span class="line-modified"> 273 If there is no match, then a less optimized verification is required to ensure that the hash in each source file information section in the \f3\&amp;.SF\fR file equals the hash of its corresponding section in the manifest file\&amp;. See Signature File\&amp;.</span>
<span class="line-modified"> 274 </span>
<span class="line-modified"> 275 One reason the hash of the manifest file that is stored in the \f3\&amp;.SF\fR file header might not equal the hash of the current manifest file is that one or more files were added to the JAR file (with the \f3jar\fR tool) after the signature and \f3\&amp;.SF\fR file were generated\&amp;. When the \f3jar\fR tool is used to add files, the manifest file is changed by adding sections to it for the new files, but the \f3\&amp;.SF\fR file is not changed\&amp;. A verification is still considered successful when none of the files that were in the JAR file when the signature was generated have been changed since then\&amp;. This happens when the hashes in the non-header sections of the \f3\&amp;.SF\fR file equal the hashes of the corresponding sections in the manifest file\&amp;.</span>
<span class="line-modified"> 276 .TP 0.4i    </span>
<span class="line-modified"> 277 3\&amp;.</span>
<span class="line-modified"> 278 Read each file in the JAR file that has an entry in the \f3\&amp;.SF\fR file\&amp;. While reading, compute the file\&amp;&#39;s digest and compare the result with the digest for this file in the manifest section\&amp;. The digests should be the same or verification fails\&amp;.</span>
<span class="line-modified"> 279 </span>
<span class="line-modified"> 280 If any serious verification failures occur during the verification process, then the process is stopped and a security exception is thrown\&amp;. The \f3jarsigner\fR command catches and displays the exception\&amp;.</span>
<span class="line-modified"> 281 .PP</span>
<span class="line-modified"> 282 \fINote:\fR You should read any addition warnings (or errors if you specified the \f3-strict\fR option), as well as the content of the certificate (by specifying the \f3-verbose\fR and \f3-certs\fR options) to determine if the signature can be trusted\&amp;.</span>
<span class="line-modified"> 283 .SS MULTIPLE\ SIGNATURES\ FOR\ A\ JAR\ FILE    </span>
<span class="line-modified"> 284 A JAR file can be signed by multiple people by running the \f3jarsigner\fR command on the file multiple times and specifying the alias for a different person each time, as follows:</span>
<span class="line-modified"> 285 .sp     </span>
<span class="line-modified"> 286 .nf     </span>
<span class="line-modified"> 287 \f3jarsigner myBundle\&amp;.jar susan\fP</span>
<span class="line-modified"> 288 .fi     </span>
<span class="line-modified"> 289 .nf     </span>
<span class="line-modified"> 290 \f3jarsigner myBundle\&amp;.jar kevin\fP</span>
<span class="line-modified"> 291 .fi     </span>
<span class="line-modified"> 292 .nf     </span>
<span class="line-modified"> 293 \f3\fR</span>
<span class="line-modified"> 294 .fi     </span>
<span class="line-modified"> 295 .sp     </span>
<span class="line-modified"> 296 When a JAR file is signed multiple times, there are multiple \f3\&amp;.SF\fR and \f3\&amp;.DSA\fR files in the resulting JAR file, one pair for each signature\&amp;. In the previous example, the output JAR file includes files with the following names:</span>
<span class="line-modified"> 297 .sp     </span>
<span class="line-modified"> 298 .nf     </span>
<span class="line-modified"> 299 \f3SUSAN\&amp;.SF\fP</span>
<span class="line-modified"> 300 .fi     </span>
<span class="line-modified"> 301 .nf     </span>
<span class="line-modified"> 302 \f3SUSAN\&amp;.DSA\fP</span>
<span class="line-modified"> 303 .fi     </span>
<span class="line-modified"> 304 .nf     </span>
<span class="line-modified"> 305 \f3KEVIN\&amp;.SF\fP</span>
<span class="line-modified"> 306 .fi     </span>
<span class="line-modified"> 307 .nf     </span>
<span class="line-modified"> 308 \f3KEVIN\&amp;.DSA\fP</span>
<span class="line-modified"> 309 .fi     </span>
<span class="line-modified"> 310 .sp     </span>
<span class="line-modified"> 311 .SH OPTIONS    </span>
<span class="line-modified"> 312 The following sections describe the various \f3jarsigner\fR options\&amp;. Be aware of the following standards:</span>
<span class="line-modified"> 313 .TP 0.2i    </span>
<span class="line-modified"> 314 \(bu</span>
<span class="line-modified"> 315 All option names are preceded by a minus sign (-)\&amp;.</span>
<span class="line-modified"> 316 .TP 0.2i    </span>
<span class="line-modified"> 317 \(bu</span>
<span class="line-modified"> 318 The options can be provided in any order\&amp;.</span>
<span class="line-modified"> 319 .TP 0.2i    </span>
<span class="line-modified"> 320 \(bu</span>
<span class="line-modified"> 321 Items that are in italics or underlined (option values) represent the actual values that must be supplied\&amp;.</span>
<span class="line-modified"> 322 .TP 0.2i    </span>
<span class="line-modified"> 323 \(bu</span>
<span class="line-modified"> 324 The \f3-storepass\fR, \f3-keypass\fR, \f3-sigfile\fR, \f3-sigalg\fR, \f3-digestalg\fR, \f3-signedjar\fR, and TSA-related options are only relevant when signing a JAR file; they are not relevant when verifying a signed JAR file\&amp;. The \f3-keystore\fR option is relevant for signing and verifying a JAR file\&amp;. In addition, aliases are specified when signing and verifying a JAR file\&amp;.</span>
<span class="line-modified"> 325 .TP</span>
<span class="line-modified"> 326 -keystore \fIurl\fR</span>
<span class="line-modified"> 327 .br</span>
<span class="line-modified"> 328 Specifies the URL that tells the keystore location\&amp;. This defaults to the file \f3\&amp;.keystore\fR in the user\&amp;&#39;s home directory, as determined by the \f3user\&amp;.home\fR system property\&amp;.</span>
<span class="line-modified"> 329 </span>
<span class="line-modified"> 330 A keystore is required when signing\&amp;. You must explicitly specify a keystore when the default keystore does not exist or if you want to use one other than the default\&amp;.</span>
<span class="line-modified"> 331 </span>
<span class="line-modified"> 332 A keystore is not required when verifying, but if one is specified or the default exists and the \f3-verbose\fR option was also specified, then additional information is output regarding whether or not any of the certificates used to verify the JAR file are contained in that keystore\&amp;.</span>
<span class="line-modified"> 333 </span>
<span class="line-modified"> 334 The \f3-keystore\fR argument can be a file name and path specification rather than a URL, in which case it is treated the same as a file: URL, for example, the following are equivalent:</span>
<span class="line-modified"> 335 .sp     </span>
<span class="line-modified"> 336 .nf     </span>
<span class="line-modified"> 337 \f3\-keystore \fIfilePathAndName\fR\fP</span>
<span class="line-modified"> 338 .fi     </span>
<span class="line-modified"> 339 .nf     </span>
<span class="line-modified"> 340 \f3\-keystore file:\fIfilePathAndName\fR\fP</span>
<span class="line-modified"> 341 .fi     </span>
<span class="line-modified"> 342 .nf     </span>
<span class="line-modified"> 343 \f3\fR</span>
<span class="line-modified"> 344 .fi     </span>
<span class="line-modified"> 345 .sp     </span>
<span class="line-modified"> 346 </span>
<span class="line-modified"> 347 </span>
<span class="line-modified"> 348 If the Sun PKCS #11 provider was configured in the \f3java\&amp;.security\fR security properties file (located in the JRE\&amp;&#39;s \f3$JAVA_HOME/lib/security directory\fR), then the \f3keytool\fR and \f3jarsigner\fR tools can operate on the PKCS #11 token by specifying these options:</span>
<span class="line-modified"> 349 .sp     </span>
<span class="line-modified"> 350 .nf     </span>
<span class="line-modified"> 351 \f3\-keystore NONE\fP</span>
<span class="line-modified"> 352 .fi     </span>
<span class="line-modified"> 353 .nf     </span>
<span class="line-modified"> 354 \f3\-storetype PKCS11\fP</span>
<span class="line-modified"> 355 .fi     </span>
<span class="line-modified"> 356 .nf     </span>
<span class="line-modified"> 357 \f3\fR</span>
<span class="line-modified"> 358 .fi     </span>
<span class="line-modified"> 359 .sp     </span>
<span class="line-modified"> 360 </span>
<span class="line-modified"> 361 </span>
<span class="line-modified"> 362 For example, the following command lists the contents of the configured PKCS#11 token:</span>
<span class="line-modified"> 363 .sp     </span>
<span class="line-modified"> 364 .nf     </span>
<span class="line-modified"> 365 \f3keytool \-keystore NONE \-storetype PKCS11 \-list\fP</span>
<span class="line-modified"> 366 .fi     </span>
<span class="line-modified"> 367 .nf     </span>
<span class="line-modified"> 368 \f3\fR</span>
<span class="line-modified"> 369 .fi     </span>
<span class="line-modified"> 370 .sp     </span>
<span class="line-modified"> 371 </span>















 372 .TP
<span class="line-modified"> 373 -storetype \fIstoretype\fR</span>
<span class="line-modified"> 374 .br</span>
<span class="line-modified"> 375 Specifies the type of keystore to be instantiated\&amp;. The default keystore type is the one that is specified as the value of the \f3keystore\&amp;.type\fR property in the security properties file, which is returned by the static \f3getDefaultType\fR method in \f3java\&amp;.security\&amp;.KeyStore\fR\&amp;.</span>
<span class="line-modified"> 376 </span>
<span class="line-modified"> 377 The PIN for a PCKS #11 token can also be specified with the \f3-storepass\fR option\&amp;. If none is specified, then the \f3keytool\fR and \f3jarsigner\fR commands prompt for the token PIN\&amp;. If the token has a protected authentication path (such as a dedicated PIN-pad or a biometric reader), then the \f3-protected\fR option must be specified and no password options can be specified\&amp;.</span>




































 378 .TP
<span class="line-modified"> 379 -storepass[:env | :file] \fIargument\fR</span>
<span class="line-modified"> 380 .br</span>
<span class="line-modified"> 381 Specifies the password that is required to access the keystore\&amp;. This is only needed when signing (not verifying) a JAR file\&amp;. In that case, if a \f3-storepass\fR option is not provided at the command line, then the user is prompted for the password\&amp;.</span>
<span class="line-modified"> 382 </span>
<span class="line-modified"> 383 If the modifier \f3env\fR or \f3file\fR is not specified, then the password has the value \fIargument\fR\&amp;. Otherwise, the password is retrieved as follows:</span>
<span class="line-modified"> 384 .RS     </span>
<span class="line-modified"> 385 .TP 0.2i    </span>
<span class="line-modified"> 386 \(bu</span>
<span class="line-modified"> 387 \f3env\fR: Retrieve the password from the environment variable named \f3argument\fR\&amp;.</span>
<span class="line-modified"> 388 .TP 0.2i    </span>
<span class="line-modified"> 389 \(bu</span>
<span class="line-modified"> 390 \f3file\fR: Retrieve the password from the file named \f3argument\fR\&amp;.</span>
<span class="line-modified"> 391 .RE     </span>
<span class="line-modified"> 392 </span>
<span class="line-modified"> 393 </span>
<span class="line-modified"> 394 \fINote:\fR The password should not be specified on the command line or in a script unless it is for testing purposes, or you are on a secure system\&amp;.</span>






 395 .TP
<span class="line-modified"> 396 -keypass [:env | :file] \fIargument\fR</span>
<span class="line-modified"> 397 .br</span>
<span class="line-modified"> 398 Specifies the password used to protect the private key of the keystore entry addressed by the alias specified on the command line\&amp;. The password is required when using \f3jarsigner\fR to sign a JAR file\&amp;. If no password is provided on the command line, and the required password is different from the store password, then the user is prompted for it\&amp;.</span>
<span class="line-modified"> 399 </span>
<span class="line-modified"> 400 If the modifier \f3env\fR or \f3file\fR is not specified, then the password has the value \f3argument\fR\&amp;. Otherwise, the password is retrieved as follows:</span>
<span class="line-modified"> 401 .RS     </span>
<span class="line-modified"> 402 .TP 0.2i    </span>
<span class="line-modified"> 403 \(bu</span>
<span class="line-modified"> 404 \f3env\fR: Retrieve the password from the environment variable named \f3argument\fR\&amp;.</span>
<span class="line-modified"> 405 .TP 0.2i    </span>
<span class="line-modified"> 406 \(bu</span>
<span class="line-modified"> 407 \f3file\fR: Retrieve the password from the file named \f3argument\fR\&amp;.</span>
<span class="line-modified"> 408 .RE     </span>
<span class="line-modified"> 409 </span>
<span class="line-modified"> 410 </span>
<span class="line-modified"> 411 \fINote:\fR The password should not be specified on the command line or in a script unless it is for testing purposes, or you are on a secure system\&amp;.</span>
 412 .TP
<span class="line-modified"> 413 -sigfile \fIfile\fR</span>
<span class="line-modified"> 414 .br</span>
<span class="line-modified"> 415 Specifies the base file name to be used for the generated \f3\&amp;.SF\fR and \f3\&amp;.DSA\fR files\&amp;. For example, if file is \f3DUKESIGN\fR, then the generated \f3\&amp;.SF\fR and \f3\&amp;.DSA\fR files are named \f3DUKESIGN\&amp;.SF\fR and \f3DUKESIGN\&amp;.DSA\fR, and placed in the \f3META-INF\fR directory of the signed JAR file\&amp;.</span>
<span class="line-modified"> 416 </span>
<span class="line-modified"> 417 The characters in the file must come from the set \f3a-zA-Z0-9_-\fR\&amp;. Only letters, numbers, underscore, and hyphen characters are allowed\&amp;. All lowercase characters are converted to uppercase for the \f3\&amp;.SF\fR and \f3\&amp;.DSA\fR file names\&amp;.</span>
<span class="line-modified"> 418 </span>
<span class="line-modified"> 419 If no \f3-sigfile\fR option appears on the command line, then the base file name for the \f3\&amp;.SF\fR and \f3\&amp;.DSA\fR files is the first 8 characters of the alias name specified on the command line, all converted to upper case\&amp;. If the alias name has fewer than 8 characters, then the full alias name is used\&amp;. If the alias name contains any characters that are not valid in a signature file name, then each such character is converted to an underscore (_) character to form the file name\&amp;.</span>


















 420 .TP
<span class="line-modified"> 421 -sigalg \fIalgorithm\fR</span>
<span class="line-modified"> 422 .br</span>
<span class="line-modified"> 423 Specifies the name of the signature algorithm to use to sign the JAR file\&amp;.</span>
<span class="line-modified"> 424 </span>
<span class="line-modified"> 425 For a list of standard signature algorithm names, see &quot;Appendix A: Standard Names&quot; in the Java Cryptography Architecture (JCA) Reference Guide at http://docs\&amp;.oracle\&amp;.com/javase/8/docs/technotes/guides/security/crypto/CryptoSpec\&amp;.html#AppA</span>
<span class="line-modified"> 426 </span>
<span class="line-modified"> 427 This algorithm must be compatible with the private key used to sign the JAR file\&amp;. If this option is not specified, then \f3SHA1withDSA\fR, \f3SHA256withRSA\fR, or \f3SHA256withECDSA\fR are used depending on the type of private key\&amp;. There must either be a statically installed provider supplying an implementation of the specified algorithm or the user must specify one with the \f3-providerClass\fR option; otherwise, the command will not succeed\&amp;.</span>






 428 .TP
<span class="line-modified"> 429 -digestalg \fIalgorithm\fR</span>
<span class="line-modified"> 430 .br</span>
<span class="line-modified"> 431 Specifies the name of the message digest algorithm to use when digesting the entries of a JAR file\&amp;.</span>
<span class="line-modified"> 432 </span>
<span class="line-modified"> 433 For a list of standard message digest algorithm names, see &quot;Appendix A: Standard Names&quot; in the Java Cryptography Architecture (JCA) Reference Guide at http://docs\&amp;.oracle\&amp;.com/javase/8/docs/technotes/guides/security/crypto/CryptoSpec\&amp;.html#AppA</span>
<span class="line-modified"> 434 </span>
<span class="line-modified"> 435 If this option is not specified, then \f3SHA256\fR is used\&amp;. There must either be a statically installed provider supplying an implementation of the specified algorithm or the user must specify one with the \f3-providerClass\fR option; otherwise, the command will not succeed\&amp;.</span>


















 436 .TP
<span class="line-modified"> 437 -certs</span>
<span class="line-modified"> 438 .br</span>
<span class="line-modified"> 439 If the \f3-certs\fR option appears on the command line with the \f3-verify\fR and \f3-verbose\fR options, then the output includes certificate information for each signer of the JAR file\&amp;. This information includes the name of the type of certificate (stored in the \f3\&amp;.DSA\fR file) that certifies the signer\&amp;&#39;s public key, and if the certificate is an X\&amp;.509 certificate (an instance of the \f3java\&amp;.security\&amp;.cert\&amp;.X509Certificate\fR), then the distinguished name of the signer\&amp;.</span>
<span class="line-modified"> 440 </span>
<span class="line-modified"> 441 The keystore is also examined\&amp;. If no keystore value is specified on the command line, then the default keystore file (if any) is checked\&amp;. If the public key certificate for a signer matches an entry in the keystore, then the alias name for the keystore entry for that signer is displayed in parentheses\&amp;.</span>














 442 .TP
<span class="line-modified"> 443 -certchain \fIfile\fR</span>
<span class="line-modified"> 444 .br</span>
<span class="line-modified"> 445 Specifies the certificate chain to be used when the certificate chain associated with the private key of the keystore entry that is addressed by the alias specified on the command line is not complete\&amp;. This can happen when the keystore is located on a hardware token where there is not enough capacity to hold a complete certificate chain\&amp;. The file can be a sequence of concatenated X\&amp;.509 certificates, or a single PKCS#7 formatted data block, either in binary encoding format or in printable encoding format (also known as Base64 encoding) as defined by the Internet RFC 1421 standard\&amp;. See Internet RFC 1421 Certificate Encoding Standard and http://tools\&amp;.ietf\&amp;.org/html/rfc1421\&amp;.</span>


















































 446 .TP
<span class="line-modified"> 447 -verbose</span>
<span class="line-modified"> 448 .br</span>
<span class="line-modified"> 449 When the \f3-verbose\fR option appears on the command line, it indicates verbose mode, which causes \f3jarsigner\fR to output extra information about the progress of the JAR signing or verification\&amp;.</span>















 450 .TP
<span class="line-modified"> 451 -internalsf</span>
<span class="line-modified"> 452 .br</span>
<span class="line-modified"> 453 In the past, the \f3\&amp;.DSA\fR (signature block) file generated when a JAR file was signed included a complete encoded copy of the \f3\&amp;.SF\fR file (signature file) also generated\&amp;. This behavior has been changed\&amp;. To reduce the overall size of the output JAR file, the \f3\&amp;.DSA\fR file by default does not contain a copy of the \f3\&amp;.SF\fR file anymore\&amp;. If \f3-internalsf\fR appears on the command line, then the old behavior is utilized\&amp;. This option is useful for testing\&amp;. In practice, do not use the \f3-internalsf\fR option because it incurs higher overhead\&amp;.</span>













 454 .TP
<span class="line-modified"> 455 -sectionsonly</span>
<span class="line-modified"> 456 .br</span>
<span class="line-modified"> 457 If the \f3-sectionsonly\fR option appears on the command line, then the \f3\&amp;.SF\fR file (signature file) generated when a JAR file is signed does not include a header that contains a hash of the whole manifest file\&amp;. It contains only the information and hashes related to each individual source file included in the JAR file\&amp;. See Signature File\&amp;.</span>
<span class="line-modified"> 458 </span>
<span class="line-modified"> 459 By default, this header is added, as an optimization\&amp;. When the header is present, whenever the JAR file is verified, the verification can first check to see whether the hash in the header matches the hash of the whole manifest file\&amp;. When there is a match, verification proceeds to the next step\&amp;. When there is no match, it is necessary to do a less optimized verification that the hash in each source file information section in the \f3\&amp;.SF\fR file equals the hash of its corresponding section in the manifest file\&amp;. See JAR File Verification\&amp;.</span>
<span class="line-modified"> 460 </span>
<span class="line-modified"> 461 The \f3-sectionsonly\fR option is primarily used for testing\&amp;. It should not be used other than for testing because using it incurs higher overhead\&amp;.</span>





























































































































































































































































































































































 462 .TP
<span class="line-modified"> 463 -protected</span>
<span class="line-modified"> 464 .br</span>
<span class="line-modified"> 465 Values can be either \f3true\fR or \f3false\fR\&amp;. Specify \f3true\fR when a password must be specified through a protected authentication path such as a dedicated PIN reader\&amp;.</span>







 466 .TP
<span class="line-modified"> 467 -providerClass \fIprovider-class-name\fR</span>
<span class="line-modified"> 468 .br</span>
<span class="line-modified"> 469 Used to specify the name of cryptographic service provider\&amp;&#39;s master class file when the service provider is not listed in the \f3java\&amp;.security\fR security properties file\&amp;.</span>












































































 470 
<span class="line-modified"> 471 Used with the \f3-providerArg ConfigFilePath\fR option, the \f3keytool\fR and \f3jarsigner\fR tools install the provider dynamically and use \fIConfigFilePath\fR for the path to the token configuration file\&amp;. The following example shows a command to list a \f3PKCS #11\fR keystore when the Oracle PKCS #11 provider was not configured in the security properties file\&amp;.</span>
<span class="line-modified"> 472 .sp     </span>
<span class="line-modified"> 473 .nf     </span>
<span class="line-modified"> 474 \f3jarsigner \-keystore NONE \-storetype PKCS11 \e\fP</span>
<span class="line-modified"> 475 .fi     </span>
<span class="line-modified"> 476 .nf     </span>
<span class="line-modified"> 477 \f3          \-providerClass sun\&amp;.security\&amp;.pkcs11\&amp;.SunPKCS11 \e\fP</span>
<span class="line-modified"> 478 .fi     </span>
<span class="line-modified"> 479 .nf     </span>
<span class="line-modified"> 480 \f3          \-providerArg /mydir1/mydir2/token\&amp;.config \e\fP</span>
<span class="line-modified"> 481 .fi     </span>
<span class="line-modified"> 482 .nf     </span>
<span class="line-removed"> 483 \f3          \-list\fP</span>
<span class="line-removed"> 484 .fi     </span>
<span class="line-removed"> 485 .nf     </span>
<span class="line-removed"> 486 \f3\fR</span>
<span class="line-removed"> 487 .fi     </span>
<span class="line-removed"> 488 .sp     </span>
 489 
<span class="line-modified"> 490 .TP</span>
<span class="line-modified"> 491 -providerName \fIproviderName\fR</span>
<span class="line-modified"> 492 .br</span>
<span class="line-removed"> 493 If more than one provider was configured in the \f3java\&amp;.security\fR security properties file, then you can use the \f3-providerName\fR option to target a specific provider instance\&amp;. The argument to this option is the name of the provider\&amp;.</span>
 494 
<span class="line-modified"> 495 For the Oracle PKCS #11 provider, \fIproviderName\fR is of the form \f3SunPKCS11-\fR\fITokenName\fR, where \fITokenName\fR is the name suffix that the provider instance has been configured with, as detailed in the configuration attributes table\&amp;. For example, the following command lists the contents of the \f3PKCS #11\fR keystore provider instance with name suffix \f3SmartCard\fR:</span>
<span class="line-modified"> 496 .sp     </span>
<span class="line-modified"> 497 .nf     </span>
<span class="line-modified"> 498 \f3jarsigner \-keystore NONE \-storetype PKCS11 \e\fP</span>
<span class="line-modified"> 499 .fi     </span>
<span class="line-modified"> 500 .nf     </span>
<span class="line-removed"> 501 \f3        \-providerName SunPKCS11\-SmartCard \e\fP</span>
<span class="line-removed"> 502 .fi     </span>
<span class="line-removed"> 503 .nf     </span>
<span class="line-removed"> 504 \f3        \-list\fP</span>
<span class="line-removed"> 505 .fi     </span>
<span class="line-removed"> 506 .nf     </span>
<span class="line-removed"> 507 \f3\fR</span>
<span class="line-removed"> 508 .fi     </span>
<span class="line-removed"> 509 .sp     </span>
 510 
<span class="line-modified"> 511 .TP</span>
<span class="line-removed"> 512 -J\fIjavaoption\fR</span>
<span class="line-removed"> 513 .br</span>
<span class="line-removed"> 514 Passes through the specified \fIjavaoption\fR string directly to the Java interpreter\&amp;. The \f3jarsigner\fR command is a wrapper around the interpreter\&amp;. This option should not contain any spaces\&amp;. It is useful for adjusting the execution environment or memory usage\&amp;. For a list of possible interpreter options, type \f3java -h\fR or \f3java -X\fR at the command line\&amp;.</span>
<span class="line-removed"> 515 .TP</span>
<span class="line-removed"> 516 -tsa \fIurl\fR</span>
<span class="line-removed"> 517 .br</span>
<span class="line-removed"> 518 If \f3-tsa http://example\&amp;.tsa\&amp;.url\fR appears on the command line when signing a JAR file then a time stamp is generated for the signature\&amp;. The URL, \f3http://example\&amp;.tsa\&amp;.url\fR, identifies the location of the Time Stamping Authority (TSA) and overrides any URL found with the \f3-tsacert\fR option\&amp;. The \f3-tsa\fR option does not require the TSA public key certificate to be present in the keystore\&amp;.</span>
 519 
<span class="line-modified"> 520 To generate the time stamp, \f3jarsigner\fR communicates with the TSA with the Time-Stamp Protocol (TSP) defined in RFC 3161\&amp;. When successful, the time stamp token returned by the TSA is stored with the signature in the signature block file\&amp;.</span>
<span class="line-modified"> 521 .TP</span>
<span class="line-modified"> 522 -tsacert \fIalias\fR</span>
<span class="line-modified"> 523 .br</span>
<span class="line-modified"> 524 When \f3-tsacert alias\fR appears on the command line when signing a JAR file, a time stamp is generated for the signature\&amp;. The alias identifies the TSA public key certificate in the keystore that is in effect\&amp;. The entry\&amp;&#39;s certificate is examined for a Subject Information Access extension that contains a URL identifying the location of the TSA\&amp;.</span>











 525 
<span class="line-modified"> 526 The TSA public key certificate must be present in the keystore when using the \f3-tsacert\fR option\&amp;.</span>
<span class="line-removed"> 527 .TP</span>
<span class="line-removed"> 528 -tsapolicyid \fIpolicyid\fR</span>
<span class="line-removed"> 529 .br</span>
<span class="line-removed"> 530 Specifies the object identifier (OID) that identifies the policy ID to be sent to the TSA server\&amp;. If this option is not specified, no policy ID is sent and the TSA server will choose a default policy ID\&amp;.</span>
 531 
<span class="line-modified"> 532 Object identifiers are defined by X\&amp;.696, which is an ITU Telecommunication Standardization Sector (ITU-T) standard\&amp;. These identifiers are typically period-separated sets of non-negative digits like \f31\&amp;.2\&amp;.3\&amp;.4\fR, for example\&amp;.</span>
<span class="line-modified"> 533 .TP</span>
<span class="line-modified"> 534 -altsigner \fIclass\fR</span>
<span class="line-modified"> 535 .br</span>
<span class="line-modified"> 536 This option specifies an alternative signing mechanism\&amp;. The fully qualified class name identifies a class file that extends the \f3com\&amp;.sun\&amp;.jarsigner\&amp;.ContentSigner\fR abstract class\&amp;. The path to this class file is defined by the \f3-altsignerpath\fR option\&amp;. If the \f3-altsigner\fR option is used, then the \f3jarsigner\fR command uses the signing mechanism provided by the specified class\&amp;. Otherwise, the \f3jarsigner\fR command uses its default signing mechanism\&amp;.</span>







 537 
<span class="line-modified"> 538 For example, to use the signing mechanism provided by a class named \f3com\&amp;.sun\&amp;.sun\&amp;.jarsigner\&amp;.AuthSigner\fR, use the jarsigner option \f3-altsigner com\&amp;.sun\&amp;.jarsigner\&amp;.AuthSigner\fR\&amp;.</span>
<span class="line-modified"> 539 .TP</span>
<span class="line-modified"> 540 -altsignerpath \fIclasspathlist\fR</span>
<span class="line-modified"> 541 .br</span>
<span class="line-modified"> 542 Specifies the path to the class file and any JAR file it depends on\&amp;. The class file name is specified with the \f3-altsigner\fR option\&amp;. If the class file is in a JAR file, then this option specifies the path to that JAR file\&amp;.</span>

 543 
<span class="line-modified"> 544 An absolute path or a path relative to the current directory can be specified\&amp;. If \fIclasspathlist\fR contains multiple paths or JAR files, then they should be separated with a colon (:) on Oracle Solaris and a semicolon (;) on Windows\&amp;. This option is not necessary when the class is already in the search path\&amp;.</span>












 545 
<span class="line-modified"> 546 The following example shows how to specify the path to a JAR file that contains the class file\&amp;. The JAR file name is included\&amp;.</span>
<span class="line-modified"> 547 .sp     </span>
<span class="line-modified"> 548 .nf     </span>
<span class="line-modified"> 549 \f3\-altsignerpath /home/user/lib/authsigner\&amp;.jar\fP</span>
<span class="line-modified"> 550 .fi     </span>
<span class="line-modified"> 551 .nf     </span>
<span class="line-modified"> 552 \f3\fR</span>
<span class="line-modified"> 553 .fi     </span>
<span class="line-modified"> 554 .sp     </span>

 555 



 556 
<span class="line-modified"> 557 The following example shows how to specify the path to the JAR file that contains the class file\&amp;. The JAR file name is omitted\&amp;.</span>
<span class="line-modified"> 558 .sp     </span>
<span class="line-modified"> 559 .nf     </span>
<span class="line-modified"> 560 \f3\-altsignerpath /home/user/classes/com/sun/tools/jarsigner/\fP</span>
<span class="line-modified"> 561 .fi     </span>
<span class="line-modified"> 562 .nf     </span>
<span class="line-removed"> 563 \f3\fR</span>
<span class="line-removed"> 564 .fi     </span>
<span class="line-removed"> 565 .sp     </span>
 566 
<span class="line-modified"> 567 .TP</span>
<span class="line-modified"> 568 -strict</span>
<span class="line-modified"> 569 .br</span>
<span class="line-modified"> 570 During the signing or verifying process, the command may issue warning messages\&amp;. If you specify this option, the exit code of the tool reflects the severe warning messages that this command found\&amp;. See Errors and Warnings\&amp;.</span>
<span class="line-modified"> 571 .TP</span>
<span class="line-modified"> 572 -verbose \fIsuboptions\fR</span>
<span class="line-modified"> 573 .br</span>
<span class="line-modified"> 574 For the verifying process, the \f3-verbose\fR option takes suboptions to determine how much information is shown\&amp;. If the \f3-certs\fR option is also specified, then the default mode (or suboption \f3all\fR) displays each entry as it is being processed, and after that, the certificate information for each signer of the JAR file\&amp;. If the \f3-certs\fR and the \f3-verbose:grouped\fR suboptions are specified, then entries with the same signer info are grouped and displayed together with their certificate information\&amp;. If \f3-certs\fR and the \f3-verbose:summary\fR suboptions are specified, then entries with the same signer information are grouped and displayed together with their certificate information\&amp;. Details about each entry are summarized and displayed as \fIone entry (and more)\fR\&amp;. See Examples\&amp;.</span>
<span class="line-modified"> 575 .SH ERRORS\ AND\ WARNINGS    </span>
<span class="line-modified"> 576 During the signing or verifying process, the \f3jarsigner\fR command may issue various errors or warnings\&amp;.</span>
<span class="line-modified"> 577 .PP</span>
<span class="line-removed"> 578 If there is a failure, the \f3jarsigner\fR command exits with code 1\&amp;. If there is no failure, but there are one or more severe warnings, the \f3jarsigner\fR command exits with code 0 when the \f3-strict\fR option is \fInot\fR specified, or exits with the OR-value of the warning codes when the \f3-strict\fR is specified\&amp;. If there is only informational warnings or no warning at all, the command always exits with code 0\&amp;.</span>
<span class="line-removed"> 579 .PP</span>
<span class="line-removed"> 580 For example, if a certificate used to sign an entry is expired and has a KeyUsage extension that does not allow it to sign a file, the \f3jarsigner\fR command exits with code 12 (=4+8) when the \f3-strict\fR option is specified\&amp;.</span>
<span class="line-removed"> 581 .PP</span>
<span class="line-removed"> 582 \fINote:\fR Exit codes are reused because only the values from 0 to 255 are legal on Unix-based operating systems\&amp;.</span>
<span class="line-removed"> 583 .PP</span>
<span class="line-removed"> 584 The following sections describes the names, codes, and descriptions of the errors and warnings that the \f3jarsigner\fR command can issue\&amp;.</span>
<span class="line-removed"> 585 .SS FAILURE    </span>
<span class="line-removed"> 586 Reasons why the \f3jarsigner\fR command fails include (but are not limited to) a command line parsing error, the inability to find a keypair to sign the JAR file, or the verification of a signed JAR fails\&amp;.</span>
<span class="line-removed"> 587 .TP     </span>
<span class="line-removed"> 588 failure</span>
<span class="line-removed"> 589 Code 1\&amp;. The signing or verifying fails\&amp;.</span>
<span class="line-removed"> 590 .SS SEVERE\ WARNINGS    </span>
<span class="line-removed"> 591 \fINote:\fR Severe warnings are reported as errors if you specify the \f3-strict\fR option\&amp;.</span>
<span class="line-removed"> 592 .PP</span>
<span class="line-removed"> 593 Reasons why the \f3jarsigner\fR command issues a severe warning include the certificate used to sign the JAR file has an error or the signed JAR file has other problems\&amp;.</span>
<span class="line-removed"> 594 .TP     </span>
<span class="line-removed"> 595 hasExpiredCert</span>
<span class="line-removed"> 596 Code 4\&amp;. This jar contains entries whose signer certificate has expired\&amp;.</span>
<span class="line-removed"> 597 .TP     </span>
<span class="line-removed"> 598 notYetValidCert</span>
<span class="line-removed"> 599 Code 4\&amp;. This jar contains entries whose signer certificate is not yet valid\&amp;.</span>
<span class="line-removed"> 600 .TP     </span>
<span class="line-removed"> 601 chainNotValidated</span>
<span class="line-removed"> 602 Code 4\&amp;. This jar contains entries whose certificate chain cannot be correctly validated\&amp;.</span>
<span class="line-removed"> 603 .TP     </span>
<span class="line-removed"> 604 badKeyUsage</span>
<span class="line-removed"> 605 Code 8\&amp;. This jar contains entries whose signer certificate\&amp;&#39;s KeyUsage extension doesn\&amp;&#39;t allow code signing\&amp;.</span>
<span class="line-removed"> 606 .TP     </span>
<span class="line-removed"> 607 badExtendedKeyUsage</span>
<span class="line-removed"> 608 Code 8\&amp;. This jar contains entries whose signer certificate\&amp;&#39;s ExtendedKeyUsage extension doesn\&amp;&#39;t allow code signing\&amp;.</span>
<span class="line-removed"> 609 .TP     </span>
<span class="line-removed"> 610 badNetscapeCertType</span>
<span class="line-removed"> 611 Code 8\&amp;. This jar contains entries whose signer certificate\&amp;&#39;s NetscapeCertType extension doesn\&amp;&#39;t allow code signing\&amp;.</span>
<span class="line-removed"> 612 .TP     </span>
<span class="line-removed"> 613 hasUnsignedEntry</span>
<span class="line-removed"> 614 Code 16\&amp;. This jar contains unsigned entries which have not been integrity-checked\&amp;.</span>
<span class="line-removed"> 615 .TP     </span>
<span class="line-removed"> 616 notSignedByAlias</span>
<span class="line-removed"> 617 Code 32\&amp;. This jar contains signed entries which are not signed by the specified alias(es)\&amp;.</span>
<span class="line-removed"> 618 .TP     </span>
<span class="line-removed"> 619 aliasNotInStore</span>
<span class="line-removed"> 620 Code 32\&amp;. This jar contains signed entries that are not signed by alias in this keystore\&amp;.</span>
<span class="line-removed"> 621 .SS INFORMATIONAL\ WARNINGS    </span>
<span class="line-removed"> 622 Informational warnings include those that are not errors but regarded as bad practice\&amp;. They do not have a code\&amp;.</span>
<span class="line-removed"> 623 .TP     </span>
<span class="line-removed"> 624 hasExpiringCert</span>
<span class="line-removed"> 625 This jar contains entries whose signer certificate will expire within six months\&amp;.</span>
<span class="line-removed"> 626 .TP     </span>
<span class="line-removed"> 627 noTimestamp</span>
<span class="line-removed"> 628 This jar contains signatures that does not include a timestamp\&amp;. Without a timestamp, users may not be able to validate this JAR file after the signer certificate\&amp;&#39;s expiration date (\f3YYYY-MM-DD\fR) or after any future revocation date\&amp;.</span>
<span class="line-removed"> 629 .SH EXAMPLES    </span>
<span class="line-removed"> 630 .SS SIGN\ A\ JAR\ FILE    </span>
<span class="line-removed"> 631 Use the following command to sign bundle\&amp;.jar with the private key of a user whose keystore alias is \f3jane\fR in a keystore named \f3mystore\fR in the \f3working\fR directory and name the signed JAR file \f3sbundle\&amp;.jar\fR:</span>
<span class="line-removed"> 632 .sp     </span>
<span class="line-removed"> 633 .nf     </span>
<span class="line-removed"> 634 \f3jarsigner \-keystore /working/mystore\fP</span>
<span class="line-removed"> 635 .fi     </span>
<span class="line-removed"> 636 .nf     </span>
<span class="line-removed"> 637 \f3    \-storepass &lt;keystore password&gt;\fP</span>
<span class="line-removed"> 638 .fi     </span>
<span class="line-removed"> 639 .nf     </span>
<span class="line-removed"> 640 \f3    \-keypass &lt;private key password&gt;\fP</span>
<span class="line-removed"> 641 .fi     </span>
<span class="line-removed"> 642 .nf     </span>
<span class="line-removed"> 643 \f3    \-signedjar sbundle\&amp;.jar bundle\&amp;.jar jane\fP</span>
<span class="line-removed"> 644 .fi     </span>
<span class="line-removed"> 645 .nf     </span>
<span class="line-removed"> 646 \f3\fR</span>
<span class="line-removed"> 647 .fi     </span>
<span class="line-removed"> 648 .sp     </span>
<span class="line-removed"> 649 There is no \f3-sigfile\fR specified in the previous command so the generated \f3\&amp;.SF\fR and \f3\&amp;.DSA\fR files to be placed in the signed JAR file have default names based on the alias name\&amp;. They are named \f3JANE\&amp;.SF\fR and \f3JANE\&amp;.DSA\fR\&amp;.</span>
<span class="line-removed"> 650 .PP</span>
<span class="line-removed"> 651 If you want to be prompted for the store password and the private key password, then you could shorten the previous command to the following:</span>
<span class="line-removed"> 652 .sp     </span>
<span class="line-removed"> 653 .nf     </span>
<span class="line-removed"> 654 \f3jarsigner \-keystore /working/mystore\fP</span>
<span class="line-removed"> 655 .fi     </span>
<span class="line-removed"> 656 .nf     </span>
<span class="line-removed"> 657 \f3    \-signedjar sbundle\&amp;.jar bundle\&amp;.jar jane\fP</span>
<span class="line-removed"> 658 .fi     </span>
<span class="line-removed"> 659 .nf     </span>
<span class="line-removed"> 660 \f3\fR</span>
<span class="line-removed"> 661 .fi     </span>
<span class="line-removed"> 662 .sp     </span>
<span class="line-removed"> 663 If the keystore is the default keystore (\&amp;.keystore in your home directory), then you do not need to specify a keystore, as follows:</span>
<span class="line-removed"> 664 .sp     </span>
<span class="line-removed"> 665 .nf     </span>
<span class="line-removed"> 666 \f3jarsigner \-signedjar sbundle\&amp;.jar bundle\&amp;.jar jane\fP</span>
<span class="line-removed"> 667 .fi     </span>
<span class="line-removed"> 668 .nf     </span>
<span class="line-removed"> 669 \f3\fR</span>
<span class="line-removed"> 670 .fi     </span>
<span class="line-removed"> 671 .sp     </span>
<span class="line-removed"> 672 If you want the signed JAR file to overwrite the input JAR file (bundle\&amp;.jar), then you do not need to specify a \f3-signedjar\fR option, as follows:</span>
<span class="line-removed"> 673 .sp     </span>
<span class="line-removed"> 674 .nf     </span>
<span class="line-removed"> 675 \f3jarsigner bundle\&amp;.jar jane\fP</span>
<span class="line-removed"> 676 .fi     </span>
<span class="line-removed"> 677 .nf     </span>
<span class="line-removed"> 678 \f3\fR</span>
<span class="line-removed"> 679 .fi     </span>
<span class="line-removed"> 680 .sp     </span>
<span class="line-removed"> 681 .SS VERIFY\ A\ SIGNED\ JAR\ FILE    </span>
<span class="line-removed"> 682 To verify a signed JAR file to ensure that the signature is valid and the JAR file was not been tampered with, use a command such as the following:</span>
<span class="line-removed"> 683 .sp     </span>
<span class="line-removed"> 684 .nf     </span>
<span class="line-removed"> 685 \f3jarsigner \-verify sbundle\&amp;.jar\fP</span>
<span class="line-removed"> 686 .fi     </span>
<span class="line-removed"> 687 .nf     </span>
<span class="line-removed"> 688 \f3\fR</span>
<span class="line-removed"> 689 .fi     </span>
<span class="line-removed"> 690 .sp     </span>
<span class="line-removed"> 691 When the verification is successful, \f3jar verified\fR is displayed\&amp;. Otherwise, an error message is displayed\&amp;. You can get more information when you use the \f3-verbose\fR option\&amp;. A sample use of \f3jarsigner\fR with the\f3-verbose\fR option follows:</span>
<span class="line-removed"> 692 .sp     </span>
<span class="line-removed"> 693 .nf     </span>
<span class="line-removed"> 694 \f3jarsigner \-verify \-verbose sbundle\&amp;.jar\fP</span>
<span class="line-removed"> 695 .fi     </span>
<span class="line-removed"> 696 .nf     </span>
<span class="line-removed"> 697 \f3\fR</span>
<span class="line-removed"> 698 .fi     </span>
<span class="line-removed"> 699 .nf     </span>
<span class="line-removed"> 700 \f3           198 Fri Sep 26 16:14:06 PDT 1997 META\-INF/MANIFEST\&amp;.MF\fP</span>
<span class="line-removed"> 701 .fi     </span>
<span class="line-removed"> 702 .nf     </span>
<span class="line-removed"> 703 \f3           199 Fri Sep 26 16:22:10 PDT 1997 META\-INF/JANE\&amp;.SF\fP</span>
<span class="line-removed"> 704 .fi     </span>
<span class="line-removed"> 705 .nf     </span>
<span class="line-removed"> 706 \f3          1013 Fri Sep 26 16:22:10 PDT 1997 META\-INF/JANE\&amp;.DSA\fP</span>
<span class="line-removed"> 707 .fi     </span>
<span class="line-removed"> 708 .nf     </span>
<span class="line-removed"> 709 \f3    smk   2752 Fri Sep 26 16:12:30 PDT 1997 AclEx\&amp;.class\fP</span>
<span class="line-removed"> 710 .fi     </span>
<span class="line-removed"> 711 .nf     </span>
<span class="line-removed"> 712 \f3    smk    849 Fri Sep 26 16:12:46 PDT 1997 test\&amp;.class\fP</span>
<span class="line-removed"> 713 .fi     </span>
<span class="line-removed"> 714 .nf     </span>
<span class="line-removed"> 715 \f3\fR</span>
<span class="line-removed"> 716 .fi     </span>
<span class="line-removed"> 717 .nf     </span>
<span class="line-removed"> 718 \f3      s = signature was verified\fP</span>
<span class="line-removed"> 719 .fi     </span>
<span class="line-removed"> 720 .nf     </span>
<span class="line-removed"> 721 \f3      m = entry is listed in manifest\fP</span>
<span class="line-removed"> 722 .fi     </span>
<span class="line-removed"> 723 .nf     </span>
<span class="line-removed"> 724 \f3      k = at least one certificate was found in keystore\fP</span>
<span class="line-removed"> 725 .fi     </span>
<span class="line-removed"> 726 .nf     </span>
<span class="line-removed"> 727 \f3\fR</span>
<span class="line-removed"> 728 .fi     </span>
<span class="line-removed"> 729 .nf     </span>
<span class="line-removed"> 730 \f3    jar verified\&amp;.\fP</span>
<span class="line-removed"> 731 .fi     </span>
<span class="line-removed"> 732 .nf     </span>
<span class="line-removed"> 733 \f3\fR</span>
<span class="line-removed"> 734 .fi     </span>
<span class="line-removed"> 735 .sp     </span>
<span class="line-removed"> 736 .SS VERIFICATION\ WITH\ CERTIFICATE\ INFORMATION    </span>
<span class="line-removed"> 737 If you specify the \f3-certs\fR option with the \f3-verify\fR and \f3-verbose\fR options, then the output includes certificate information for each signer of the JAR file\&amp;. The information includes the certificate type, the signer distinguished name information (when it is an X\&amp;.509 certificate), and in parentheses, the keystore alias for the signer when the public key certificate in the JAR file matches the one in a keystore entry, for example:</span>
<span class="line-removed"> 738 .sp     </span>
<span class="line-removed"> 739 .nf     </span>
<span class="line-removed"> 740 \f3jarsigner \-keystore /working/mystore \-verify \-verbose \-certs myTest\&amp;.jar\fP</span>
<span class="line-removed"> 741 .fi     </span>
<span class="line-removed"> 742 .nf     </span>
<span class="line-removed"> 743 \f3\fR</span>
<span class="line-removed"> 744 .fi     </span>
<span class="line-removed"> 745 .nf     </span>
<span class="line-removed"> 746 \f3           198 Fri Sep 26 16:14:06 PDT 1997 META\-INF/MANIFEST\&amp;.MF\fP</span>
<span class="line-removed"> 747 .fi     </span>
<span class="line-removed"> 748 .nf     </span>
<span class="line-removed"> 749 \f3           199 Fri Sep 26 16:22:10 PDT 1997 META\-INF/JANE\&amp;.SF\fP</span>
<span class="line-removed"> 750 .fi     </span>
<span class="line-removed"> 751 .nf     </span>
<span class="line-removed"> 752 \f3          1013 Fri Sep 26 16:22:10 PDT 1997 META\-INF/JANE\&amp;.DSA\fP</span>
<span class="line-removed"> 753 .fi     </span>
<span class="line-removed"> 754 .nf     </span>
<span class="line-removed"> 755 \f3           208 Fri Sep 26 16:23:30 PDT 1997 META\-INF/JAVATEST\&amp;.SF\fP</span>
<span class="line-removed"> 756 .fi     </span>
<span class="line-removed"> 757 .nf     </span>
<span class="line-removed"> 758 \f3          1087 Fri Sep 26 16:23:30 PDT 1997 META\-INF/JAVATEST\&amp;.DSA\fP</span>
<span class="line-removed"> 759 .fi     </span>
<span class="line-removed"> 760 .nf     </span>
<span class="line-removed"> 761 \f3    smk   2752 Fri Sep 26 16:12:30 PDT 1997 Tst\&amp;.class\fP</span>
<span class="line-removed"> 762 .fi     </span>
<span class="line-removed"> 763 .nf     </span>
<span class="line-removed"> 764 \f3\fR</span>
<span class="line-removed"> 765 .fi     </span>
<span class="line-removed"> 766 .nf     </span>
<span class="line-removed"> 767 \f3      X\&amp;.509, CN=Test Group, OU=Java Software, O=Oracle, L=CUP, S=CA, C=US (javatest)\fP</span>
<span class="line-removed"> 768 .fi     </span>
<span class="line-removed"> 769 .nf     </span>
<span class="line-removed"> 770 \f3      X\&amp;.509, CN=Jane Smith, OU=Java Software, O=Oracle, L=cup, S=ca, C=us (jane)\fP</span>
<span class="line-removed"> 771 .fi     </span>
<span class="line-removed"> 772 .nf     </span>
<span class="line-removed"> 773 \f3\fR</span>
<span class="line-removed"> 774 .fi     </span>
<span class="line-removed"> 775 .nf     </span>
<span class="line-removed"> 776 \f3      s = signature was verified\fP</span>
<span class="line-removed"> 777 .fi     </span>
<span class="line-removed"> 778 .nf     </span>
<span class="line-removed"> 779 \f3      m = entry is listed in manifest\fP</span>
<span class="line-removed"> 780 .fi     </span>
<span class="line-removed"> 781 .nf     </span>
<span class="line-removed"> 782 \f3      k = at least one certificate was found in keystore\fP</span>
<span class="line-removed"> 783 .fi     </span>
<span class="line-removed"> 784 .nf     </span>
<span class="line-removed"> 785 \f3\fR</span>
<span class="line-removed"> 786 .fi     </span>
<span class="line-removed"> 787 .nf     </span>
<span class="line-removed"> 788 \f3    jar verified\&amp;.\fP</span>
<span class="line-removed"> 789 .fi     </span>
<span class="line-removed"> 790 .nf     </span>
<span class="line-removed"> 791 \f3\fR</span>
<span class="line-removed"> 792 .fi     </span>
<span class="line-removed"> 793 .sp     </span>
<span class="line-removed"> 794 If the certificate for a signer is not an X\&amp;.509 certificate, then there is no distinguished name information\&amp;. In that case, just the certificate type and the alias are shown\&amp;. For example, if the certificate is a PGP certificate, and the alias is \f3bob\fR, then you would get: \f3PGP, (bob)\fR\&amp;.</span>
<span class="line-removed"> 795 .SH SEE\ ALSO    </span>
<span class="line-removed"> 796 .TP 0.2i    </span>
<span class="line-removed"> 797 \(bu</span>
<span class="line-removed"> 798 jar(1)</span>
<span class="line-removed"> 799 .TP 0.2i    </span>
<span class="line-removed"> 800 \(bu</span>
<span class="line-removed"> 801 keytool(1)</span>
<span class="line-removed"> 802 .TP 0.2i    </span>
<span class="line-removed"> 803 \(bu</span>
<span class="line-removed"> 804 Trail: Security Features in Java SE at http://docs\&amp;.oracle\&amp;.com/javase/tutorial/security/index\&amp;.html</span>
<span class="line-removed"> 805 .RE</span>
<span class="line-removed"> 806 .br</span>
<span class="line-removed"> 807 &#39;pl 8.5i</span>
<span class="line-removed"> 808 &#39;bp</span>
</pre>
</td>
<td>
<hr />
<pre>
<span class="line-modified">   1 .\&quot;t</span>
<span class="line-modified">   2 .\&quot; Copyright (c) 1994, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   3 .\&quot; DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4 .\&quot;
   5 .\&quot; This code is free software; you can redistribute it and/or modify it
   6 .\&quot; under the terms of the GNU General Public License version 2 only, as
   7 .\&quot; published by the Free Software Foundation.
   8 .\&quot;
   9 .\&quot; This code is distributed in the hope that it will be useful, but WITHOUT
  10 .\&quot; ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
<span class="line-modified">  11 .\&quot; FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License</span>
  12 .\&quot; version 2 for more details (a copy is included in the LICENSE file that
  13 .\&quot; accompanied this code).
  14 .\&quot;
  15 .\&quot; You should have received a copy of the GNU General Public License version
  16 .\&quot; 2 along with this work; if not, write to the Free Software Foundation,
  17 .\&quot; Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18 .\&quot;
  19 .\&quot; Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20 .\&quot; or visit www.oracle.com if you need additional information or have any
  21 .\&quot; questions.
  22 .\&quot;
<span class="line-modified">  23 .\&quot; Automatically generated by Pandoc 2.3.1</span>




  24 .\&quot;
<span class="line-modified">  25 .TH &quot;JARSIGNER&quot; &quot;1&quot; &quot;2020&quot; &quot;JDK 14&quot; &quot;JDK Commands&quot;</span>
<span class="line-modified">  26 .hy</span>
<span class="line-modified">  27 .SH NAME</span>
<span class="line-modified">  28 .PP</span>
<span class="line-modified">  29 jarsigner \- sign and verify Java Archive (JAR) files</span>
<span class="line-modified">  30 .SH SYNOPSIS</span>
<span class="line-modified">  31 .PP</span>
<span class="line-modified">  32 \f[CB]jarsigner\f[R] [\f[I]options\f[R]] \f[I]jar\-file\f[R] \f[I]alias\f[R]</span>
<span class="line-modified">  33 .PP</span>
<span class="line-modified">  34 \f[CB]jarsigner\f[R] \f[CB]\-verify\f[R] [\f[I]options\f[R]]</span>
<span class="line-modified">  35 \f[I]jar\-file\f[R] [\f[I]alias\f[R] ...]</span>
<span class="line-modified">  36 .TP</span>
<span class="line-modified">  37 .B \f[I]options\f[R]</span>
<span class="line-modified">  38 The command\-line options.</span>
<span class="line-modified">  39 See \f[B]Options for jarsigner\f[R].</span>
<span class="line-modified">  40 .RS</span>
<span class="line-modified">  41 .RE</span>
<span class="line-modified">  42 .TP</span>
<span class="line-modified">  43 .B \f[CB]\-verify\f[R]</span>
<span class="line-modified">  44 The \f[CB]\-verify\f[R] option can take zero or more keystore alias names</span>
<span class="line-modified">  45 after the JAR file name.</span>
<span class="line-modified">  46 When the \f[CB]\-verify\f[R] option is specified, the \f[CB]jarsigner\f[R]</span>
<span class="line-modified">  47 command checks that the certificate used to verify each signed entry in</span>
<span class="line-modified">  48 the JAR file matches one of the keystore aliases.</span>
<span class="line-modified">  49 The aliases are defined in the keystore specified by \f[CB]\-keystore\f[R]</span>
<span class="line-modified">  50 or the default keystore.</span>
<span class="line-modified">  51 .RS</span>
<span class="line-modified">  52 .PP</span>
<span class="line-modified">  53 If you also specify the \f[CB]\-strict\f[R] option, and the</span>
<span class="line-modified">  54 \f[CB]jarsigner\f[R] command detects severe warnings, the message, &quot;jar</span>
<span class="line-modified">  55 verified, with signer errors&quot; is displayed.</span>
<span class="line-modified">  56 .RE</span>
<span class="line-modified">  57 .TP</span>
<span class="line-modified">  58 .B \f[I]jar\-file\f[R]</span>
<span class="line-modified">  59 The JAR file to be signed.</span>
<span class="line-modified">  60 .RS</span>
<span class="line-modified">  61 .PP</span>
<span class="line-modified">  62 If you also specified the \f[CB]\-strict\f[R] option, and the</span>
<span class="line-modified">  63 \f[CB]jarsigner\f[R] command detected severe warnings, the message, &quot;jar</span>
<span class="line-modified">  64 signed, with signer errors&quot; is displayed.</span>
<span class="line-modified">  65 .RE</span>
<span class="line-modified">  66 .TP</span>
<span class="line-modified">  67 .B \f[I]alias\f[R]</span>
<span class="line-modified">  68 The aliases are defined in the keystore specified by \f[CB]\-keystore\f[R]</span>
<span class="line-modified">  69 or the default keystore.</span>
<span class="line-modified">  70 .RS</span>
<span class="line-modified">  71 .RE</span>
<span class="line-modified">  72 .SH DESCRIPTION</span>
<span class="line-modified">  73 .PP</span>
<span class="line-modified">  74 The \f[CB]jarsigner\f[R] tool has two purposes:</span>
<span class="line-modified">  75 .IP \[bu] 2</span>
<span class="line-modified">  76 To sign Java Archive (JAR) files.</span>
<span class="line-modified">  77 .IP \[bu] 2</span>
<span class="line-modified">  78 To verify the signatures and integrity of signed JAR files.</span>
<span class="line-modified">  79 .PP</span>
<span class="line-modified">  80 The JAR feature enables the packaging of class files, images, sounds,</span>
<span class="line-modified">  81 and other digital data in a single file for faster and easier</span>
<span class="line-modified">  82 distribution.</span>
<span class="line-modified">  83 A tool named \f[CB]jar\f[R] enables developers to produce JAR files.</span>
<span class="line-modified">  84 (Technically, any ZIP file can also be considered a JAR file, although</span>
<span class="line-modified">  85 when created by the \f[CB]jar\f[R] command or processed by the</span>
<span class="line-modified">  86 \f[CB]jarsigner\f[R] command, JAR files also contain a</span>
<span class="line-modified">  87 \f[CB]META\-INF/MANIFEST.MF\f[R] file.)</span>
<span class="line-modified">  88 .PP</span>
<span class="line-modified">  89 A digital signature is a string of bits that is computed from some data</span>
<span class="line-modified">  90 (the data being signed) and the private key of an entity (a person,</span>
<span class="line-modified">  91 company, and so on).</span>
<span class="line-modified">  92 Similar to a handwritten signature, a digital signature has many useful</span>
<span class="line-modified">  93 characteristics:</span>
<span class="line-modified">  94 .IP \[bu] 2</span>
<span class="line-modified">  95 Its authenticity can be verified by a computation that uses the public</span>
<span class="line-modified">  96 key corresponding to the private key used to generate the signature.</span>
<span class="line-modified">  97 .IP \[bu] 2</span>
<span class="line-modified">  98 It can\[aq]t be forged, assuming the private key is kept secret.</span>
<span class="line-modified">  99 .IP \[bu] 2</span>
<span class="line-modified"> 100 It is a function of the data signed and thus can\[aq]t be claimed to be</span>
<span class="line-modified"> 101 the signature for other data as well.</span>
<span class="line-modified"> 102 .IP \[bu] 2</span>
<span class="line-modified"> 103 The signed data can\[aq]t be changed.</span>
<span class="line-modified"> 104 If the data is changed, then the signature can\[aq]t be verified as</span>
<span class="line-modified"> 105 authentic.</span>
<span class="line-modified"> 106 .PP</span>
<span class="line-modified"> 107 To generate an entity\[aq]s signature for a file, the entity must first</span>
<span class="line-modified"> 108 have a public/private key pair associated with it and one or more</span>
<span class="line-modified"> 109 certificates that authenticate its public key.</span>
<span class="line-modified"> 110 A certificate is a digitally signed statement from one entity that says</span>
<span class="line-modified"> 111 that the public key of another entity has a particular value.</span>
<span class="line-modified"> 112 .PP</span>
<span class="line-modified"> 113 The \f[CB]jarsigner\f[R] command uses key and certificate information from</span>
<span class="line-modified"> 114 a keystore to generate digital signatures for JAR files.</span>
<span class="line-modified"> 115 A keystore is a database of private keys and their associated X.509</span>
<span class="line-modified"> 116 certificate chains that authenticate the corresponding public keys.</span>
<span class="line-modified"> 117 The \f[CB]keytool\f[R] command is used to create and administer keystores.</span>
<span class="line-modified"> 118 .PP</span>
<span class="line-modified"> 119 The \f[CB]jarsigner\f[R] command uses an entity\[aq]s private key to</span>
<span class="line-modified"> 120 generate a signature.</span>
<span class="line-modified"> 121 The signed JAR file contains, among other things, a copy of the</span>
<span class="line-modified"> 122 certificate from the keystore for the public key corresponding to the</span>
<span class="line-modified"> 123 private key used to sign the file.</span>
<span class="line-modified"> 124 The \f[CB]jarsigner\f[R] command can verify the digital signature of the</span>
<span class="line-modified"> 125 signed JAR file using the certificate inside it (in its signature block</span>
<span class="line-modified"> 126 file).</span>
<span class="line-modified"> 127 .PP</span>
<span class="line-modified"> 128 The \f[CB]jarsigner\f[R] command can generate signatures that include a</span>
<span class="line-modified"> 129 time stamp that enables a systems or deployer to check whether the JAR</span>
<span class="line-modified"> 130 file was signed while the signing certificate was still valid.</span>
<span class="line-modified"> 131 .PP</span>
<span class="line-modified"> 132 In addition, APIs allow applications to obtain the timestamp</span>
<span class="line-modified"> 133 information.</span>
<span class="line-modified"> 134 .PP</span>
<span class="line-modified"> 135 At this time, the \f[CB]jarsigner\f[R] command can only sign JAR files</span>
<span class="line-modified"> 136 created by the \f[CB]jar\f[R] command or zip files.</span>
<span class="line-modified"> 137 JAR files are the same as zip files, except they also have a</span>
<span class="line-modified"> 138 \f[CB]META\-INF/MANIFEST.MF\f[R] file.</span>
<span class="line-modified"> 139 A \f[CB]META\-INF/MANIFEST.MF\f[R] file is created when the</span>
<span class="line-modified"> 140 \f[CB]jarsigner\f[R] command signs a zip file.</span>
<span class="line-modified"> 141 .PP</span>
<span class="line-modified"> 142 The default \f[CB]jarsigner\f[R] command behavior is to sign a JAR or zip</span>
<span class="line-modified"> 143 file.</span>
<span class="line-modified"> 144 Use the \f[CB]\-verify\f[R] option to verify a signed JAR file.</span>
<span class="line-modified"> 145 .PP</span>
<span class="line-modified"> 146 The \f[CB]jarsigner\f[R] command also attempts to validate the</span>
<span class="line-modified"> 147 signer\[aq]s certificate after signing or verifying.</span>
<span class="line-modified"> 148 If there is a validation error or any other problem, the command</span>
<span class="line-modified"> 149 generates warning messages.</span>
<span class="line-modified"> 150 If you specify the \f[CB]\-strict\f[R] option, then the command treats</span>
<span class="line-modified"> 151 severe warnings as errors.</span>
<span class="line-modified"> 152 See \f[B]Errors and Warnings\f[R].</span>
<span class="line-modified"> 153 .SH KEYSTORE ALIASES</span>
<span class="line-modified"> 154 .PP</span>
<span class="line-modified"> 155 All keystore entities are accessed with unique aliases.</span>
<span class="line-modified"> 156 .PP</span>
<span class="line-modified"> 157 When you use the \f[CB]jarsigner\f[R] command to sign a JAR file, you must</span>
<span class="line-modified"> 158 specify the alias for the keystore entry that contains the private key</span>
<span class="line-modified"> 159 needed to generate the signature.</span>
<span class="line-modified"> 160 If no output file is specified, it overwrites the original JAR file with</span>
<span class="line-modified"> 161 the signed JAR file.</span>
<span class="line-modified"> 162 .PP</span>
<span class="line-modified"> 163 Keystores are protected with a password, so the store password must be</span>
<span class="line-modified"> 164 specified.</span>
<span class="line-modified"> 165 You are prompted for it when you don\[aq]t specify it on the command</span>
<span class="line-modified"> 166 line.</span>
<span class="line-modified"> 167 Similarly, private keys are protected in a keystore with a password, so</span>
<span class="line-modified"> 168 the private key\[aq]s password must be specified, and you are prompted</span>
<span class="line-modified"> 169 for the password when you don\[aq]t specify it on the command line and</span>
<span class="line-modified"> 170 it isn\[aq]t the same as the store password.</span>
<span class="line-modified"> 171 .SH KEYSTORE LOCATION</span>
<span class="line-modified"> 172 .PP</span>
<span class="line-modified"> 173 The \f[CB]jarsigner\f[R] command has a \f[CB]\-keystore\f[R] option for</span>
<span class="line-modified"> 174 specifying the URL of the keystore to be used.</span>
<span class="line-modified"> 175 The keystore is by default stored in a file named \f[CB]\&amp;.keystore\f[R]</span>
<span class="line-modified"> 176 in the user\[aq]s home directory, as determined by the</span>
<span class="line-modified"> 177 \f[CB]user.home\f[R] system property.</span>
<span class="line-modified"> 178 .PP</span>
<span class="line-modified"> 179 \f[B]Oracle Solaris, Linux, and OS X:\f[R] \f[CB]user.home\f[R] defaults to</span>
<span class="line-modified"> 180 the user\[aq]s home directory.</span>
<span class="line-modified"> 181 .PP</span>
<span class="line-modified"> 182 The input stream from the \f[CB]\-keystore\f[R] option is passed to the</span>
<span class="line-modified"> 183 \f[CB]KeyStore.load\f[R] method.</span>
<span class="line-modified"> 184 If \f[CB]NONE\f[R] is specified as the URL, then a null stream is passed</span>
<span class="line-modified"> 185 to the \f[CB]KeyStore.load\f[R] method.</span>
<span class="line-modified"> 186 \f[CB]NONE\f[R] should be specified when the \f[CB]KeyStore\f[R] class</span>
<span class="line-modified"> 187 isn\[aq]t file based, for example, when it resides on a hardware token</span>
<span class="line-modified"> 188 device.</span>
<span class="line-modified"> 189 .SH KEYSTORE IMPLEMENTATION</span>
<span class="line-modified"> 190 .PP</span>
<span class="line-modified"> 191 The \f[CB]KeyStore\f[R] class provided in the \f[CB]java.security\f[R]</span>
<span class="line-modified"> 192 package supplies a number of well\-defined interfaces to access and</span>
<span class="line-modified"> 193 modify the information in a keystore.</span>
<span class="line-modified"> 194 You can have multiple different concrete implementations, where each</span>
<span class="line-modified"> 195 implementation is for a particular type of keystore.</span>
<span class="line-modified"> 196 .PP</span>
<span class="line-modified"> 197 Currently, there are two command\-line tools that use keystore</span>
<span class="line-modified"> 198 implementations (\f[CB]keytool\f[R] and \f[CB]jarsigner\f[R]).</span>
<span class="line-modified"> 199 .PP</span>
<span class="line-modified"> 200 The default keystore implementation is \f[CB]PKCS12\f[R].</span>
<span class="line-modified"> 201 This is a cross platform keystore based on the RSA PKCS12 Personal</span>
<span class="line-modified"> 202 Information Exchange Syntax Standard.</span>
<span class="line-modified"> 203 This standard is primarily meant for storing or transporting a</span>
<span class="line-modified"> 204 user\[aq]s private keys, certificates, and miscellaneous secrets.</span>
<span class="line-modified"> 205 There is another built\-in implementation, provided by Oracle.</span>
<span class="line-modified"> 206 It implements the keystore as a file with a proprietary keystore type</span>
<span class="line-modified"> 207 (format) named \f[CB]JKS\f[R].</span>
<span class="line-modified"> 208 It protects each private key with its individual password, and also</span>
<span class="line-modified"> 209 protects the integrity of the entire keystore with a (possibly</span>
<span class="line-modified"> 210 different) password.</span>
<span class="line-modified"> 211 .PP</span>
<span class="line-modified"> 212 Keystore implementations are provider\-based, which means the</span>
<span class="line-modified"> 213 application interfaces supplied by the \f[CB]KeyStore\f[R] class are</span>
<span class="line-modified"> 214 implemented in terms of a Service Provider Interface (SPI).</span>
<span class="line-modified"> 215 There is a corresponding abstract \f[CB]KeystoreSpi\f[R] class, also in</span>
<span class="line-modified"> 216 the \f[CB]java.security\ package\f[R], that defines the Service Provider</span>
<span class="line-modified"> 217 Interface methods that providers must implement.</span>
<span class="line-modified"> 218 The term provider refers to a package or a set of packages that supply a</span>
<span class="line-added"> 219 concrete implementation of a subset of services that can be accessed by</span>
<span class="line-added"> 220 the Java Security API.</span>
<span class="line-added"> 221 To provide a keystore implementation, clients must implement a provider</span>
<span class="line-added"> 222 and supply a \f[CB]KeystoreSpi\f[R] subclass implementation, as described</span>
<span class="line-added"> 223 in \f[B]How to Implement a Provider in the Java Cryptography</span>
<span class="line-added"> 224 Architecture\f[R]</span>
<span class="line-added"> 225 [https://www.oracle.com/pls/topic/lookup?ctx=en/java/javase/11/tools&amp;id=JSSEC\-GUID\-2BCFDD85\-D533\-4E6C\-8CE9\-29990DEB0190].</span>
<span class="line-added"> 226 .PP</span>
<span class="line-added"> 227 Applications can choose different types of keystore implementations from</span>
<span class="line-added"> 228 different providers, with the \f[CB]getInstance\f[R] factory method in the</span>
<span class="line-added"> 229 \f[CB]KeyStore\f[R] class.</span>
<span class="line-added"> 230 A keystore type defines the storage and data format of the keystore</span>
<span class="line-added"> 231 information and the algorithms used to protect private keys in the</span>
<span class="line-added"> 232 keystore and the integrity of the keystore itself.</span>
<span class="line-added"> 233 Keystore implementations of different types aren\[aq]t compatible.</span>
<span class="line-added"> 234 .PP</span>
<span class="line-added"> 235 The \f[CB]jarsigner\f[R] commands can read file\-based keystores from any</span>
<span class="line-added"> 236 location that can be specified using a URL.</span>
<span class="line-added"> 237 In addition, these commands can read non\-file\-based keystores such as</span>
<span class="line-added"> 238 those provided by MSCAPI on Windows and PKCS11 on all platforms.</span>
<span class="line-added"> 239 .PP</span>
<span class="line-added"> 240 For the \f[CB]jarsigner\f[R] and \f[CB]keytool\f[R] commands, you can</span>
<span class="line-added"> 241 specify a keystore type at the command line with the</span>
<span class="line-added"> 242 \f[CB]\-storetype\f[R] option.</span>
<span class="line-added"> 243 .PP</span>
<span class="line-added"> 244 If you don\[aq]t explicitly specify a keystore type, then the tools</span>
<span class="line-added"> 245 choose a keystore implementation based on the value of the</span>
<span class="line-added"> 246 \f[CB]keystore.type\f[R] property specified in the security properties</span>
<span class="line-added"> 247 file.</span>
<span class="line-added"> 248 The security properties file is called \f[CB]java.security\f[R], and it</span>
<span class="line-added"> 249 resides in the JDK security properties directory,</span>
<span class="line-added"> 250 \f[CB]java.home/conf/security\f[R].</span>
<span class="line-added"> 251 .PP</span>
<span class="line-added"> 252 Each tool gets the \f[CB]keystore.type\f[R] value and then examines all</span>
<span class="line-added"> 253 the installed providers until it finds one that implements keystores of</span>
<span class="line-added"> 254 that type.</span>
<span class="line-added"> 255 It then uses the keystore implementation from that provider.</span>
<span class="line-added"> 256 .PP</span>
<span class="line-added"> 257 The \f[CB]KeyStore\f[R] class defines a static method named</span>
<span class="line-added"> 258 \f[CB]getDefaultType\f[R] that lets applications retrieve the value of the</span>
<span class="line-added"> 259 \f[CB]keystore.type\f[R] property.</span>
<span class="line-added"> 260 The following line of code creates an instance of the default keystore</span>
<span class="line-added"> 261 type as specified in the \f[CB]keystore.type\f[R] property:</span>
<span class="line-added"> 262 .RS</span>
<span class="line-added"> 263 .PP</span>
<span class="line-added"> 264 \f[CB]KeyStore\ keyStore\ =\ KeyStore.getInstance(KeyStore.getDefaultType());\f[R]</span>
<span class="line-added"> 265 .RE</span>
<span class="line-added"> 266 .PP</span>
<span class="line-added"> 267 The default keystore type is \f[CB]pkcs12\f[R], which is a cross platform</span>
<span class="line-added"> 268 keystore based on the RSA PKCS12 Personal Information Exchange Syntax</span>
<span class="line-added"> 269 Standard.</span>
<span class="line-added"> 270 This is specified by the following line in the security properties file:</span>
<span class="line-added"> 271 .RS</span>
<span class="line-added"> 272 .PP</span>
<span class="line-added"> 273 \f[CB]keystore.type=pkcs12\f[R]</span>
<span class="line-added"> 274 .RE</span>
<span class="line-added"> 275 .PP</span>
<span class="line-added"> 276 Case doesn\[aq]t matter in keystore type designations.</span>
<span class="line-added"> 277 For example, \f[CB]JKS\f[R] is the same as \f[CB]jks\f[R].</span>
<span class="line-added"> 278 .PP</span>
<span class="line-added"> 279 To have the tools utilize a keystore implementation other than the</span>
<span class="line-added"> 280 default, you can change that line to specify a different keystore type.</span>
<span class="line-added"> 281 For example, if you want to use the Oracle\[aq]s \f[CB]jks\f[R] keystore</span>
<span class="line-added"> 282 implementation, then change the line to the following:</span>
<span class="line-added"> 283 .RS</span>
<span class="line-added"> 284 .PP</span>
<span class="line-added"> 285 \f[CB]keystore.type=jks\f[R]</span>
<span class="line-added"> 286 .RE</span>
<span class="line-added"> 287 .SH SUPPORTED ALGORITHMS</span>
<span class="line-added"> 288 .PP</span>
<span class="line-added"> 289 By default, the \f[CB]jarsigner\f[R] command signs a JAR file using one of</span>
<span class="line-added"> 290 the following algorithms files depending on the type and size of the</span>
<span class="line-added"> 291 private key:</span>
<span class="line-added"> 292 .PP</span>
<span class="line-added"> 293 .TS</span>
<span class="line-added"> 294 tab(@);</span>
<span class="line-added"> 295 l l l.</span>
<span class="line-added"> 296 T{</span>
<span class="line-added"> 297 keyalg</span>
<span class="line-added"> 298 T}@T{</span>
<span class="line-added"> 299 keysize</span>
<span class="line-added"> 300 T}@T{</span>
<span class="line-added"> 301 default sigalg</span>
<span class="line-added"> 302 T}</span>
<span class="line-added"> 303 _</span>
<span class="line-added"> 304 T{</span>
<span class="line-added"> 305 DSA</span>
<span class="line-added"> 306 T}@T{</span>
<span class="line-added"> 307 any size</span>
<span class="line-added"> 308 T}@T{</span>
<span class="line-added"> 309 SHA256withDSA</span>
<span class="line-added"> 310 T}</span>
<span class="line-added"> 311 T{</span>
<span class="line-added"> 312 RSA</span>
<span class="line-added"> 313 T}@T{</span>
<span class="line-added"> 314 &lt;= 3072</span>
<span class="line-added"> 315 T}@T{</span>
<span class="line-added"> 316 SHA256withRSA</span>
<span class="line-added"> 317 T}</span>
<span class="line-added"> 318 T{</span>
<span class="line-added"> 319 T}@T{</span>
<span class="line-added"> 320 &lt;= 7680</span>
<span class="line-added"> 321 T}@T{</span>
<span class="line-added"> 322 SHA384withRSA</span>
<span class="line-added"> 323 T}</span>
<span class="line-added"> 324 T{</span>
<span class="line-added"> 325 T}@T{</span>
<span class="line-added"> 326 &gt; 7680</span>
<span class="line-added"> 327 T}@T{</span>
<span class="line-added"> 328 SHA512withRSA</span>
<span class="line-added"> 329 T}</span>
<span class="line-added"> 330 T{</span>
<span class="line-added"> 331 EC</span>
<span class="line-added"> 332 T}@T{</span>
<span class="line-added"> 333 &lt; 384</span>
<span class="line-added"> 334 T}@T{</span>
<span class="line-added"> 335 SHA256withECDSA</span>
<span class="line-added"> 336 T}</span>
<span class="line-added"> 337 T{</span>
<span class="line-added"> 338 T}@T{</span>
<span class="line-added"> 339 &lt; 512</span>
<span class="line-added"> 340 T}@T{</span>
<span class="line-added"> 341 SHA384withECDSA</span>
<span class="line-added"> 342 T}</span>
<span class="line-added"> 343 T{</span>
<span class="line-added"> 344 T}@T{</span>
<span class="line-added"> 345 = 512</span>
<span class="line-added"> 346 T}@T{</span>
<span class="line-added"> 347 SHA512withECDSA</span>
<span class="line-added"> 348 T}</span>
<span class="line-added"> 349 .TE</span>
<span class="line-added"> 350 .PP</span>
<span class="line-added"> 351 These default signature algorithms can be overridden by using the</span>
<span class="line-added"> 352 \f[CB]\-sigalg\f[R] option.</span>
<span class="line-added"> 353 .PP</span>
<span class="line-added"> 354 Signed JAR file algorithms are checked against the</span>
<span class="line-added"> 355 \f[CB]jdk.jar.disabledAlgorithms\f[R] security property during</span>
<span class="line-added"> 356 verification (\f[CB]\-verify\f[R]).</span>
<span class="line-added"> 357 If the JAR file was signed with any algorithms that are disabled, it</span>
<span class="line-added"> 358 will be treated as an unsigned JAR file.</span>
<span class="line-added"> 359 For detailed verification output, include</span>
<span class="line-added"> 360 \f[CB]\-J\-Djava.security.debug=jar\f[R].</span>
<span class="line-added"> 361 The default value for the \f[CB]jdk.jar.disabledAlgorithms\f[R] security</span>
<span class="line-added"> 362 property is defined in the \f[CB]java.security\f[R] file (located in the</span>
<span class="line-added"> 363 JRE\[aq]s \f[CB]$JAVA_HOME/conf/security\f[R] directory).</span>
<span class="line-added"> 364 .PP</span>
<span class="line-added"> 365 \f[B]Note:\f[R]</span>
<span class="line-added"> 366 .PP</span>
<span class="line-added"> 367 In order to improve out of the box security, default key size and</span>
<span class="line-added"> 368 signature algorithm names are periodically updated to stronger values</span>
<span class="line-added"> 369 with each release of the JDK.</span>
<span class="line-added"> 370 If interoperability with older releases of the JDK is important, please</span>
<span class="line-added"> 371 make sure the defaults are supported by those releases, or alternatively</span>
<span class="line-added"> 372 use the \f[CB]\-sigalg\f[R] option to override the default values at your</span>
<span class="line-added"> 373 own risk.</span>
<span class="line-added"> 374 .SH THE SIGNED JAR FILE</span>
<span class="line-added"> 375 .PP</span>
<span class="line-added"> 376 When the \f[CB]jarsigner\f[R] command is used to sign a JAR file, the</span>
<span class="line-added"> 377 output signed JAR file is exactly the same as the input JAR file, except</span>
<span class="line-added"> 378 that it has two additional files placed in the META\-INF directory:</span>
<span class="line-added"> 379 .IP \[bu] 2</span>
<span class="line-added"> 380 A signature file with an \f[CB]\&amp;.SF\f[R] extension</span>
<span class="line-added"> 381 .IP \[bu] 2</span>
<span class="line-added"> 382 A signature block file with a \f[CB]\&amp;.DSA\f[R], \f[CB]\&amp;.RSA\f[R], or</span>
<span class="line-added"> 383 \f[CB]\&amp;.EC\f[R] extension</span>
<span class="line-added"> 384 .PP</span>
<span class="line-added"> 385 The base file names for these two files come from the value of the</span>
<span class="line-added"> 386 \f[CB]\-sigfile\f[R] option.</span>
<span class="line-added"> 387 For example, when the option is \f[CB]\-sigfile\ MKSIGN\f[R], the files</span>
<span class="line-added"> 388 are named \f[CB]MKSIGN.SF\f[R] and \f[CB]MKSIGN.DSA\f[R]</span>
<span class="line-added"> 389 .PP</span>
<span class="line-added"> 390 If no \f[CB]\-sigfile\f[R] option appears on the command line, then the</span>
<span class="line-added"> 391 base file name for the \f[CB]\&amp;.SF\f[R] and \f[CB]\&amp;.DSA\f[R] files is the</span>
<span class="line-added"> 392 first 8 characters of the alias name specified on the command line, all</span>
<span class="line-added"> 393 converted to uppercase.</span>
<span class="line-added"> 394 If the alias name has fewer than 8 characters, then the full alias name</span>
<span class="line-added"> 395 is used.</span>
<span class="line-added"> 396 If the alias name contains any characters that aren\[aq]t allowed in a</span>
<span class="line-added"> 397 signature file name, then each such character is converted to an</span>
<span class="line-added"> 398 underscore (_) character in forming the file name.</span>
<span class="line-added"> 399 Valid characters include letters, digits, underscores, and hyphens.</span>
<span class="line-added"> 400 .SH SIGNATURE FILE</span>
<span class="line-added"> 401 .PP</span>
<span class="line-added"> 402 A signature file (\f[CB]\&amp;.SF\f[R] file) looks similar to the manifest</span>
<span class="line-added"> 403 file that is always included in a JAR file when the \f[CB]jarsigner\f[R]</span>
<span class="line-added"> 404 command is used to sign the file.</span>
<span class="line-added"> 405 For each source file included in the JAR file, the \f[CB]\&amp;.SF\f[R] file</span>
<span class="line-added"> 406 has two lines, such as in the manifest file, that list the following:</span>
<span class="line-added"> 407 .IP \[bu] 2</span>
 408 File name
<span class="line-modified"> 409 .IP \[bu] 2</span>

 410 Name of the digest algorithm (SHA)
<span class="line-modified"> 411 .IP \[bu] 2</span>

 412 SHA digest value
 413 .PP
<span class="line-modified"> 414 \f[B]Note:\f[R]</span>
 415 .PP
<span class="line-modified"> 416 The name of the digest algorithm (SHA) and the SHA digest value are on</span>
<span class="line-added"> 417 the same line.</span>
 418 .PP
<span class="line-modified"> 419 In the manifest file, the SHA digest value for each source file is the</span>
<span class="line-modified"> 420 digest (hash) of the binary data in the source file.</span>
<span class="line-modified"> 421 In the \f[CB]\&amp;.SF\f[R] file, the digest value for a specified source file</span>
<span class="line-modified"> 422 is the hash of the two lines in the manifest file for the source file.</span>
<span class="line-modified"> 423 .PP</span>
<span class="line-modified"> 424 The signature file, by default, includes a header with a hash of the</span>
<span class="line-modified"> 425 whole manifest file.</span>
<span class="line-modified"> 426 The header also contains a hash of the manifest header.</span>
<span class="line-modified"> 427 The presence of the header enables verification optimization.</span>
<span class="line-modified"> 428 See \f[B]JAR File Verification\f[R].</span>
<span class="line-modified"> 429 .SH SIGNATURE BLOCK FILE</span>
<span class="line-modified"> 430 .PP</span>
<span class="line-modified"> 431 The \f[CB]\&amp;.SF\f[R] file is signed and the signature is placed in the</span>
<span class="line-modified"> 432 signature block file.</span>
<span class="line-modified"> 433 This file also contains, encoded inside it, the certificate or</span>
<span class="line-modified"> 434 certificate chain from the keystore that authenticates the public key</span>
<span class="line-modified"> 435 corresponding to the private key used for signing.</span>
<span class="line-modified"> 436 The file has the extension \f[CB]\&amp;.DSA\f[R], \f[CB]\&amp;.RSA\f[R], or</span>
<span class="line-modified"> 437 \f[CB]\&amp;.EC\f[R], depending on the digest algorithm used.</span>
<span class="line-modified"> 438 .SH SIGNATURE TIME STAMP</span>
<span class="line-modified"> 439 .PP</span>
<span class="line-modified"> 440 The \f[CB]jarsigner\f[R] command used with the following options generates</span>
<span class="line-modified"> 441 and stores a signature time stamp when signing a JAR file:</span>
<span class="line-modified"> 442 .IP \[bu] 2</span>
<span class="line-modified"> 443 \f[CB]\-tsa\f[R] \f[I]url\f[R]</span>
<span class="line-modified"> 444 .IP \[bu] 2</span>
<span class="line-modified"> 445 \f[CB]\-tsacert\f[R] \f[I]alias\f[R]</span>
<span class="line-modified"> 446 .IP \[bu] 2</span>
<span class="line-modified"> 447 \f[CB]\-tsapolicyid\f[R] \f[I]policyid\f[R]</span>
<span class="line-modified"> 448 .IP \[bu] 2</span>
<span class="line-modified"> 449 \f[CB]\-tsadigestalg\f[R] \f[I]algorithm\f[R]</span>
<span class="line-modified"> 450 .PP</span>
<span class="line-modified"> 451 See \f[B]Options for jarsigner\f[R].</span>
<span class="line-modified"> 452 .SH JAR FILE VERIFICATION</span>
<span class="line-modified"> 453 .PP</span>
<span class="line-modified"> 454 A successful JAR file verification occurs when the signatures are valid,</span>
<span class="line-modified"> 455 and none of the files that were in the JAR file when the signatures were</span>
<span class="line-modified"> 456 generated have changed since then.</span>
<span class="line-modified"> 457 JAR file verification involves the following steps:</span>
<span class="line-modified"> 458 .IP &quot;1.&quot; 3</span>
<span class="line-modified"> 459 Verify the signature of the \f[CB]\&amp;.SF\f[R] file.</span>
<span class="line-modified"> 460 .RS 4</span>
<span class="line-modified"> 461 .PP</span>
<span class="line-modified"> 462 The verification ensures that the signature stored in each signature</span>
<span class="line-modified"> 463 block (\f[CB]\&amp;.DSA\f[R]) file was generated using the private key</span>
<span class="line-modified"> 464 corresponding to the public key whose certificate (or certificate chain)</span>
<span class="line-modified"> 465 also appears in the \f[CB]\&amp;.DSA\f[R] file.</span>
<span class="line-modified"> 466 It also ensures that the signature is a valid signature of the</span>
<span class="line-modified"> 467 corresponding signature (\f[CB]\&amp;.SF\f[R]) file, and thus the</span>
<span class="line-modified"> 468 \f[CB]\&amp;.SF\f[R] file wasn\[aq]t tampered with.</span>
<span class="line-modified"> 469 .RE</span>
<span class="line-modified"> 470 .IP &quot;2.&quot; 3</span>
<span class="line-modified"> 471 Verify the digest listed in each entry in the \f[CB]\&amp;.SF\f[R] file with</span>
<span class="line-modified"> 472 each corresponding section in the manifest.</span>
<span class="line-modified"> 473 .RS 4</span>
<span class="line-modified"> 474 .PP</span>
<span class="line-modified"> 475 The \f[CB]\&amp;.SF\f[R] file by default includes a header that contains a</span>
<span class="line-modified"> 476 hash of the entire manifest file.</span>
<span class="line-modified"> 477 When the header is present, the verification can check to see whether or</span>
<span class="line-modified"> 478 not the hash in the header matches the hash of the manifest file.</span>
<span class="line-modified"> 479 If there is a match, then verification proceeds to the next step.</span>
<span class="line-modified"> 480 .PP</span>
<span class="line-modified"> 481 If there is no match, then a less optimized verification is required to</span>
<span class="line-modified"> 482 ensure that the hash in each source file information section in the</span>
<span class="line-modified"> 483 \f[CB]\&amp;.SF\f[R] file equals the hash of its corresponding section in the</span>
<span class="line-modified"> 484 manifest file.</span>
<span class="line-modified"> 485 See Signature File.</span>
<span class="line-modified"> 486 .PP</span>
<span class="line-modified"> 487 One reason the hash of the manifest file that is stored in the</span>
<span class="line-modified"> 488 \f[CB]\&amp;.SF\f[R] file header might not equal the hash of the current</span>
<span class="line-modified"> 489 manifest file is that one or more files were added to the JAR file (with</span>
<span class="line-modified"> 490 the \f[CB]jar\f[R] tool) after the signature and \f[CB]\&amp;.SF\f[R] file were</span>
<span class="line-modified"> 491 generated.</span>
<span class="line-modified"> 492 When the \f[CB]jar\f[R] tool is used to add files, the manifest file is</span>
<span class="line-modified"> 493 changed by adding sections to it for the new files, but the</span>
<span class="line-modified"> 494 \f[CB]\&amp;.SF\f[R] file isn\[aq]t changed.</span>
<span class="line-modified"> 495 A verification is still considered successful when none of the files</span>
<span class="line-modified"> 496 that were in the JAR file when the signature was generated have been</span>
<span class="line-modified"> 497 changed since then.</span>
<span class="line-modified"> 498 This happens when the hashes in the non\-header sections of the</span>
<span class="line-modified"> 499 \f[CB]\&amp;.SF\f[R] file equal the hashes of the corresponding sections in</span>
<span class="line-modified"> 500 the manifest file.</span>
<span class="line-modified"> 501 .RE</span>
<span class="line-modified"> 502 .IP &quot;3.&quot; 3</span>
<span class="line-modified"> 503 Read each file in the JAR file that has an entry in the \f[CB]\&amp;.SF\f[R]</span>
<span class="line-modified"> 504 file.</span>
<span class="line-modified"> 505 While reading, compute the file\[aq]s digest and compare the result with</span>
<span class="line-modified"> 506 the digest for this file in the manifest section.</span>
<span class="line-modified"> 507 The digests should be the same or verification fails.</span>
<span class="line-modified"> 508 .RS 4</span>
<span class="line-modified"> 509 .PP</span>
<span class="line-modified"> 510 If any serious verification failures occur during the verification</span>
<span class="line-modified"> 511 process, then the process is stopped and a security exception is thrown.</span>
<span class="line-modified"> 512 The \f[CB]jarsigner\f[R] command catches and displays the exception.</span>
<span class="line-modified"> 513 .RE</span>
<span class="line-modified"> 514 .IP &quot;4.&quot; 3</span>
<span class="line-modified"> 515 Check for disabled algorithm usage.</span>
<span class="line-modified"> 516 See \f[B]Supported Algorithms\f[R].</span>
<span class="line-modified"> 517 .PP</span>
<span class="line-modified"> 518 \f[B]Note:\f[R]</span>
<span class="line-modified"> 519 .PP</span>
<span class="line-modified"> 520 You should read any addition warnings (or errors if you specified the</span>
<span class="line-modified"> 521 \f[CB]\-strict\f[R] option), as well as the content of the certificate (by</span>
<span class="line-modified"> 522 specifying the \f[CB]\-verbose\f[R] and \f[CB]\-certs\f[R] options) to</span>
<span class="line-modified"> 523 determine if the signature can be trusted.</span>
<span class="line-modified"> 524 .SH MULTIPLE SIGNATURES FOR A JAR FILE</span>
<span class="line-modified"> 525 .PP</span>
<span class="line-modified"> 526 A JAR file can be signed by multiple people by running the</span>
<span class="line-modified"> 527 \f[CB]jarsigner\f[R] command on the file multiple times and specifying the</span>
<span class="line-modified"> 528 alias for a different person each time, as follows:</span>
<span class="line-modified"> 529 .IP</span>
<span class="line-modified"> 530 .nf</span>
<span class="line-modified"> 531 \f[CB]</span>
<span class="line-modified"> 532 jarsigner\ myBundle.jar\ susan</span>
<span class="line-modified"> 533 jarsigner\ myBundle.jar\ kevin</span>
<span class="line-modified"> 534 \f[R]</span>
<span class="line-modified"> 535 .fi</span>
<span class="line-modified"> 536 .PP</span>
<span class="line-modified"> 537 When a JAR file is signed multiple times, there are multiple</span>
<span class="line-modified"> 538 \f[CB]\&amp;.SF\f[R] and \f[CB]\&amp;.DSA\f[R] files in the resulting JAR file, one</span>
<span class="line-modified"> 539 pair for each signature.</span>
<span class="line-modified"> 540 In the previous example, the output JAR file includes files with the</span>
<span class="line-modified"> 541 following names:</span>
<span class="line-modified"> 542 .IP</span>
<span class="line-modified"> 543 .nf</span>
<span class="line-modified"> 544 \f[CB]</span>
<span class="line-modified"> 545 SUSAN.SF</span>
<span class="line-modified"> 546 SUSAN.DSA</span>
<span class="line-modified"> 547 KEVIN.SF</span>
<span class="line-modified"> 548 KEVIN.DSA</span>
<span class="line-modified"> 549 \f[R]</span>
<span class="line-modified"> 550 .fi</span>
<span class="line-modified"> 551 .SH OPTIONS FOR JARSIGNER</span>
<span class="line-modified"> 552 .PP</span>
<span class="line-modified"> 553 The following sections describe the options for the \f[CB]jarsigner\f[R].</span>
<span class="line-modified"> 554 Be aware of the following standards:</span>
<span class="line-modified"> 555 .IP \[bu] 2</span>
<span class="line-added"> 556 All option names are preceded by a hyphen sign (\-).</span>
<span class="line-added"> 557 .IP \[bu] 2</span>
<span class="line-added"> 558 The options can be provided in any order.</span>
<span class="line-added"> 559 .IP \[bu] 2</span>
<span class="line-added"> 560 Items that are in italics or underlined (option values) represent the</span>
<span class="line-added"> 561 actual values that must be supplied.</span>
<span class="line-added"> 562 .IP \[bu] 2</span>
<span class="line-added"> 563 The \f[CB]\-storepass\f[R], \f[CB]\-keypass\f[R], \f[CB]\-sigfile\f[R],</span>
<span class="line-added"> 564 \f[CB]\-sigalg\f[R], \f[CB]\-digestalg\f[R], \f[CB]\-signedjar\f[R], and</span>
<span class="line-added"> 565 TSA\-related options are only relevant when signing a JAR file; they</span>
<span class="line-added"> 566 aren\[aq]t relevant when verifying a signed JAR file.</span>
<span class="line-added"> 567 The \f[CB]\-keystore\f[R] option is relevant for signing and verifying a</span>
<span class="line-added"> 568 JAR file.</span>
<span class="line-added"> 569 In addition, aliases are specified when signing and verifying a JAR</span>
<span class="line-added"> 570 file.</span>
 571 .TP
<span class="line-modified"> 572 .B \f[CB]\-keystore\f[R] \f[I]url\f[R]</span>
<span class="line-modified"> 573 Specifies the URL that tells the keystore location.</span>
<span class="line-modified"> 574 This defaults to the file \f[CB]\&amp;.keystore\f[R] in the user\[aq]s home</span>
<span class="line-modified"> 575 directory, as determined by the \f[CB]user.home\f[R] system property.</span>
<span class="line-modified"> 576 .RS</span>
<span class="line-added"> 577 .PP</span>
<span class="line-added"> 578 A keystore is required when signing.</span>
<span class="line-added"> 579 You must explicitly specify a keystore when the default keystore</span>
<span class="line-added"> 580 doesn\[aq]t exist or if you want to use one other than the default.</span>
<span class="line-added"> 581 .PP</span>
<span class="line-added"> 582 A keystore isn\[aq]t required when verifying, but if one is specified or</span>
<span class="line-added"> 583 the default exists and the \f[CB]\-verbose\f[R] option was also specified,</span>
<span class="line-added"> 584 then additional information is output regarding whether or not any of</span>
<span class="line-added"> 585 the certificates used to verify the JAR file are contained in that</span>
<span class="line-added"> 586 keystore.</span>
<span class="line-added"> 587 .PP</span>
<span class="line-added"> 588 The \f[CB]\-keystore\f[R] argument can be a file name and path</span>
<span class="line-added"> 589 specification rather than a URL, in which case it is treated the same as</span>
<span class="line-added"> 590 a file: URL, for example, the following are equivalent:</span>
<span class="line-added"> 591 .IP \[bu] 2</span>
<span class="line-added"> 592 \f[CB]\-keystore\f[R] \f[I]filePathAndName\f[R]</span>
<span class="line-added"> 593 .IP \[bu] 2</span>
<span class="line-added"> 594 \f[CB]\-keystore\ file:\f[R]\f[I]filePathAndName\f[R]</span>
<span class="line-added"> 595 .PP</span>
<span class="line-added"> 596 If the Sun PKCS #11 provider was configured in the</span>
<span class="line-added"> 597 \f[CB]java.security\f[R] security properties file (located in the</span>
<span class="line-added"> 598 JRE\[aq]s \f[CB]$JAVA_HOME/conf/security\f[R] directory), then the</span>
<span class="line-added"> 599 \f[CB]keytool\f[R] and \f[CB]jarsigner\f[R] tools can operate on the PKCS</span>
<span class="line-added"> 600 #11 token by specifying these options:</span>
<span class="line-added"> 601 .RS</span>
<span class="line-added"> 602 .PP</span>
<span class="line-added"> 603 \f[CB]\-keystore\ NONE\ \-storetype\ PKCS11\f[R]</span>
<span class="line-added"> 604 .RE</span>
<span class="line-added"> 605 .PP</span>
<span class="line-added"> 606 For example, the following command lists the contents of the configured</span>
<span class="line-added"> 607 PKCS#11 token:</span>
<span class="line-added"> 608 .RS</span>
<span class="line-added"> 609 .PP</span>
<span class="line-added"> 610 \f[CB]keytool\ \-keystore\ NONE\ \-storetype\ PKCS11\ \-list\f[R]</span>
<span class="line-added"> 611 .RE</span>
<span class="line-added"> 612 .RE</span>
 613 .TP
<span class="line-modified"> 614 .B \f[CB]\-storepass\f[R] [\f[CB]:env\f[R] | \f[CB]:file\f[R]] \f[I]argument\f[R]</span>
<span class="line-modified"> 615 Specifies the password that is required to access the keystore.</span>
<span class="line-modified"> 616 This is only needed when signing (not verifying) a JAR file.</span>
<span class="line-modified"> 617 In that case, if a \f[CB]\-storepass\f[R] option isn\[aq]t provided at the</span>
<span class="line-modified"> 618 command line, then the user is prompted for the password.</span>
<span class="line-modified"> 619 .RS</span>
<span class="line-modified"> 620 .PP</span>
<span class="line-modified"> 621 If the modifier \f[CB]env\f[R] or \f[CB]file\f[R] isn\[aq]t specified, then</span>
<span class="line-modified"> 622 the password has the value \f[CB]argument\f[R].</span>
<span class="line-modified"> 623 Otherwise, the password is retrieved as follows:</span>
<span class="line-modified"> 624 .IP \[bu] 2</span>
<span class="line-modified"> 625 \f[CB]env\f[R]: Retrieve the password from the environment variable named</span>
<span class="line-modified"> 626 \f[I]argument\f[R].</span>
<span class="line-modified"> 627 .IP \[bu] 2</span>
<span class="line-modified"> 628 \f[CB]file\f[R]: Retrieve the password from the file named</span>
<span class="line-modified"> 629 \f[I]argument\f[R].</span>
<span class="line-added"> 630 .PP</span>
<span class="line-added"> 631 \f[B]Note:\f[R]</span>
<span class="line-added"> 632 .PP</span>
<span class="line-added"> 633 The password shouldn\[aq]t be specified on the command line or in a</span>
<span class="line-added"> 634 script unless it is for testing purposes, or you are on a secure system.</span>
<span class="line-added"> 635 .RE</span>
 636 .TP
<span class="line-modified"> 637 .B \f[CB]\-storetype\f[R] \f[I]storetype\f[R]</span>
<span class="line-modified"> 638 Specifies the type of keystore to be instantiated.</span>
<span class="line-modified"> 639 The default keystore type is the one that is specified as the value of</span>
<span class="line-modified"> 640 the \f[CB]keystore.type\f[R] property in the security properties file,</span>
<span class="line-modified"> 641 which is returned by the static \f[CB]getDefaultType\f[R] method in</span>
<span class="line-modified"> 642 \f[CB]java.security.KeyStore\f[R].</span>
<span class="line-modified"> 643 .RS</span>
<span class="line-modified"> 644 .PP</span>
<span class="line-modified"> 645 The PIN for a PKCS #11 token can also be specified with the</span>
<span class="line-modified"> 646 \f[CB]\-storepass\f[R] option.</span>
<span class="line-modified"> 647 If none is specified, then the \f[CB]keytool\f[R] and \f[CB]jarsigner\f[R]</span>
<span class="line-modified"> 648 commands prompt for the token PIN.</span>
<span class="line-modified"> 649 If the token has a protected authentication path (such as a dedicated</span>
<span class="line-modified"> 650 PIN\-pad or a biometric reader), then the \f[CB]\-protected\f[R] option</span>
<span class="line-modified"> 651 must be specified and no password options can be specified.</span>
<span class="line-modified"> 652 .RE</span>
 653 .TP
<span class="line-modified"> 654 .B \f[CB]\-keypass\f[R] [\f[CB]:env\f[R] | \f[CB]:file\f[R]] \f[I]argument\f[R] \f[CB]\-certchain\f[R] \f[I]file\f[R]</span>
<span class="line-modified"> 655 Specifies the password used to protect the private key of the keystore</span>
<span class="line-modified"> 656 entry addressed by the alias specified on the command line.</span>
<span class="line-modified"> 657 The password is required when using \f[CB]jarsigner\f[R] to sign a JAR</span>
<span class="line-modified"> 658 file.</span>
<span class="line-modified"> 659 If no password is provided on the command line, and the required</span>
<span class="line-modified"> 660 password is different from the store password, then the user is prompted</span>
<span class="line-added"> 661 for it.</span>
<span class="line-added"> 662 .RS</span>
<span class="line-added"> 663 .PP</span>
<span class="line-added"> 664 If the modifier \f[CB]env\f[R] or \f[CB]file\f[R] isn\[aq]t specified, then</span>
<span class="line-added"> 665 the password has the value \f[CB]argument\f[R].</span>
<span class="line-added"> 666 Otherwise, the password is retrieved as follows:</span>
<span class="line-added"> 667 .IP \[bu] 2</span>
<span class="line-added"> 668 \f[CB]env\f[R]: Retrieve the password from the environment variable named</span>
<span class="line-added"> 669 \f[I]argument\f[R].</span>
<span class="line-added"> 670 .IP \[bu] 2</span>
<span class="line-added"> 671 \f[CB]file\f[R]: Retrieve the password from the file named</span>
<span class="line-added"> 672 \f[I]argument\f[R].</span>
<span class="line-added"> 673 .PP</span>
<span class="line-added"> 674 \f[B]Note:\f[R]</span>
<span class="line-added"> 675 .PP</span>
<span class="line-added"> 676 The password shouldn\[aq]t be specified on the command line or in a</span>
<span class="line-added"> 677 script unless it is for testing purposes, or you are on a secure system.</span>
<span class="line-added"> 678 .RE</span>
 679 .TP
<span class="line-modified"> 680 .B \f[CB]\-certchain\f[R] \f[I]file\f[R]</span>
<span class="line-modified"> 681 Specifies the certificate chain to be used when the certificate chain</span>
<span class="line-modified"> 682 associated with the private key of the keystore entry that is addressed</span>
<span class="line-modified"> 683 by the alias specified on the command line isn\[aq]t complete.</span>
<span class="line-modified"> 684 This can happen when the keystore is located on a hardware token where</span>
<span class="line-modified"> 685 there isn\[aq]t enough capacity to hold a complete certificate chain.</span>
<span class="line-modified"> 686 The file can be a sequence of concatenated X.509 certificates, or a</span>
<span class="line-added"> 687 single PKCS#7 formatted data block, either in binary encoding format or</span>
<span class="line-added"> 688 in printable encoding format (also known as Base64 encoding) as defined</span>
<span class="line-added"> 689 by \f[B]Internet RFC 1421 Certificate Encoding Standard\f[R]</span>
<span class="line-added"> 690 [http://tools.ietf.org/html/rfc1421].</span>
<span class="line-added"> 691 .RS</span>
<span class="line-added"> 692 .RE</span>
 693 .TP
<span class="line-modified"> 694 .B \f[CB]\-sigfile\f[R] \f[I]file\f[R]</span>
<span class="line-modified"> 695 Specifies the base file name to be used for the generated \f[CB]\&amp;.SF\f[R]</span>
<span class="line-modified"> 696 and \f[CB]\&amp;.DSA\f[R] files.</span>
<span class="line-modified"> 697 For example, if file is \f[CB]DUKESIGN\f[R], then the generated</span>
<span class="line-modified"> 698 \f[CB]\&amp;.SF\f[R] and \f[CB]\&amp;.DSA\f[R] files are named \f[CB]DUKESIGN.SF\f[R]</span>
<span class="line-modified"> 699 and \f[CB]DUKESIGN.DSA\f[R], and placed in the \f[CB]META\-INF\f[R]</span>
<span class="line-modified"> 700 directory of the signed JAR file.</span>
<span class="line-added"> 701 .RS</span>
<span class="line-added"> 702 .PP</span>
<span class="line-added"> 703 The characters in the file must come from the set</span>
<span class="line-added"> 704 \f[CB]a\-zA\-Z0\-9_\-\f[R].</span>
<span class="line-added"> 705 Only letters, numbers, underscore, and hyphen characters are allowed.</span>
<span class="line-added"> 706 All lowercase characters are converted to uppercase for the</span>
<span class="line-added"> 707 \f[CB]\&amp;.SF\f[R] and \f[CB]\&amp;.DSA\f[R] file names.</span>
<span class="line-added"> 708 .PP</span>
<span class="line-added"> 709 If no \f[CB]\-sigfile\f[R] option appears on the command line, then the</span>
<span class="line-added"> 710 base file name for the \f[CB]\&amp;.SF\f[R] and \f[CB]\&amp;.DSA\f[R] files is the</span>
<span class="line-added"> 711 first 8 characters of the alias name specified on the command line, all</span>
<span class="line-added"> 712 converted to upper case.</span>
<span class="line-added"> 713 If the alias name has fewer than 8 characters, then the full alias name</span>
<span class="line-added"> 714 is used.</span>
<span class="line-added"> 715 If the alias name contains any characters that aren\[aq]t valid in a</span>
<span class="line-added"> 716 signature file name, then each such character is converted to an</span>
<span class="line-added"> 717 underscore (_) character to form the file name.</span>
<span class="line-added"> 718 .RE</span>
 719 .TP
<span class="line-modified"> 720 .B \f[CB]\-signedjar\f[R] \f[I]file\f[R]</span>
<span class="line-modified"> 721 Specifies the name of signed JAR file.</span>
<span class="line-modified"> 722 .RS</span>
<span class="line-modified"> 723 .RE</span>
<span class="line-modified"> 724 .TP</span>
<span class="line-added"> 725 .B \f[CB]\-digestalg\f[R] \f[I]algorithm\f[R]</span>
<span class="line-added"> 726 Specifies the name of the message digest algorithm to use when digesting</span>
<span class="line-added"> 727 the entries of a JAR file.</span>
<span class="line-added"> 728 .RS</span>
<span class="line-added"> 729 .PP</span>
<span class="line-added"> 730 For a list of standard message digest algorithm names, see Java Security</span>
<span class="line-added"> 731 Standard Algorithm Names.</span>
<span class="line-added"> 732 .PP</span>
<span class="line-added"> 733 If this option isn\[aq]t specified, then \f[CB]SHA256\f[R] is used.</span>
<span class="line-added"> 734 There must either be a statically installed provider supplying an</span>
<span class="line-added"> 735 implementation of the specified algorithm or the user must specify one</span>
<span class="line-added"> 736 with the \f[CB]\-addprovider\f[R] or \f[CB]\-providerClass\f[R] options;</span>
<span class="line-added"> 737 otherwise, the command will not succeed.</span>
<span class="line-added"> 738 .RE</span>
 739 .TP
<span class="line-modified"> 740 .B \f[CB]\-sigalg\f[R] \f[I]algorithm\f[R]</span>
<span class="line-modified"> 741 Specifies the name of the signature algorithm to use to sign the JAR</span>
<span class="line-modified"> 742 file.</span>
<span class="line-added"> 743 .RS</span>
<span class="line-added"> 744 .PP</span>
<span class="line-added"> 745 This algorithm must be compatible with the private key used to sign the</span>
<span class="line-added"> 746 JAR file.</span>
<span class="line-added"> 747 If this option isn\[aq]t specified, then use a default algorithm</span>
<span class="line-added"> 748 matching the private key as described in the \f[B]Supported</span>
<span class="line-added"> 749 Algorithms\f[R] section.</span>
<span class="line-added"> 750 There must either be a statically installed provider supplying an</span>
<span class="line-added"> 751 implementation of the specified algorithm or you must specify one with</span>
<span class="line-added"> 752 the \f[CB]\-addprovider\f[R] or \f[CB]\-providerClass\f[R] option;</span>
<span class="line-added"> 753 otherwise, the command doesn\[aq]t succeed.</span>
<span class="line-added"> 754 .PP</span>
<span class="line-added"> 755 For a list of standard message digest algorithm names, see Java Security</span>
<span class="line-added"> 756 Standard Algorithm Names.</span>
<span class="line-added"> 757 .RE</span>
<span class="line-added"> 758 .TP</span>
<span class="line-added"> 759 .B \f[CB]\-verify\f[R]</span>
<span class="line-added"> 760 Verifies a signed JAR file.</span>
<span class="line-added"> 761 .RS</span>
<span class="line-added"> 762 .RE</span>
<span class="line-added"> 763 .TP</span>
<span class="line-added"> 764 .B \f[CB]\-verbose\f[R][\f[CB]:\f[R]\f[I]suboptions\f[R]]</span>
<span class="line-added"> 765 When the \f[CB]\-verbose\f[R] option appears on the command line, it</span>
<span class="line-added"> 766 indicates that the \f[CB]jarsigner\f[R] use the verbose mode when signing</span>
<span class="line-added"> 767 or verifying with the suboptions determining how much information is</span>
<span class="line-added"> 768 shown.</span>
<span class="line-added"> 769 This causes the , which causes \f[CB]jarsigner\f[R] to output extra</span>
<span class="line-added"> 770 information about the progress of the JAR signing or verification.</span>
<span class="line-added"> 771 The \f[I]suboptions\f[R] can be \f[CB]all\f[R], \f[CB]grouped\f[R], or</span>
<span class="line-added"> 772 \f[CB]summary\f[R].</span>
<span class="line-added"> 773 .RS</span>
<span class="line-added"> 774 .PP</span>
<span class="line-added"> 775 If the \f[CB]\-certs\f[R] option is also specified, then the default mode</span>
<span class="line-added"> 776 (or suboption \f[CB]all\f[R]) displays each entry as it is being</span>
<span class="line-added"> 777 processed, and after that, the certificate information for each signer</span>
<span class="line-added"> 778 of the JAR file.</span>
<span class="line-added"> 779 .PP</span>
<span class="line-added"> 780 If the \f[CB]\-certs\f[R] and the \f[CB]\-verbose:grouped\f[R] suboptions</span>
<span class="line-added"> 781 are specified, then entries with the same signer info are grouped and</span>
<span class="line-added"> 782 displayed together with their certificate information.</span>
<span class="line-added"> 783 .PP</span>
<span class="line-added"> 784 If \f[CB]\-certs\f[R] and the \f[CB]\-verbose:summary\f[R] suboptions are</span>
<span class="line-added"> 785 specified, then entries with the same signer information are grouped and</span>
<span class="line-added"> 786 displayed together with their certificate information.</span>
<span class="line-added"> 787 .PP</span>
<span class="line-added"> 788 Details about each entry are summarized and displayed as \f[I]one entry</span>
<span class="line-added"> 789 (and more)\f[R].</span>
<span class="line-added"> 790 See \f[B]Example of Verifying a Signed JAR File\f[R] and \f[B]Example of</span>
<span class="line-added"> 791 Verification with Certificate Information\f[R].</span>
<span class="line-added"> 792 .RE</span>
 793 .TP
<span class="line-modified"> 794 .B \f[CB]\-certs\f[R]</span>
<span class="line-modified"> 795 If the \f[CB]\-certs\f[R] option appears on the command line with the</span>
<span class="line-modified"> 796 \f[CB]\-verify\f[R] and \f[CB]\-verbose\f[R] options, then the output</span>
<span class="line-added"> 797 includes certificate information for each signer of the JAR file.</span>
<span class="line-added"> 798 This information includes the name of the type of certificate (stored in</span>
<span class="line-added"> 799 the \f[CB]\&amp;.DSA\f[R] file) that certifies the signer\[aq]s public key,</span>
<span class="line-added"> 800 and if the certificate is an X.509 certificate (an instance of the</span>
<span class="line-added"> 801 \f[CB]java.security.cert.X509Certificate\f[R]), then the distinguished</span>
<span class="line-added"> 802 name of the signer.</span>
<span class="line-added"> 803 .RS</span>
<span class="line-added"> 804 .PP</span>
<span class="line-added"> 805 The keystore is also examined.</span>
<span class="line-added"> 806 If no keystore value is specified on the command line, then the default</span>
<span class="line-added"> 807 keystore file (if any) is checked.</span>
<span class="line-added"> 808 If the public key certificate for a signer matches an entry in the</span>
<span class="line-added"> 809 keystore, then the alias name for the keystore entry for that signer is</span>
<span class="line-added"> 810 displayed in parentheses.</span>
<span class="line-added"> 811 .RE</span>
 812 .TP
<span class="line-modified"> 813 .B \f[CB]\-tsa\f[R] \f[I]url\f[R]</span>
<span class="line-modified"> 814 If \f[CB]\-tsa\ http://example.tsa.url\f[R] appears on the command line</span>
<span class="line-modified"> 815 when signing a JAR file then a time stamp is generated for the</span>
<span class="line-added"> 816 signature.</span>
<span class="line-added"> 817 The URL, \f[CB]http://example.tsa.url\f[R], identifies the location of the</span>
<span class="line-added"> 818 Time Stamping Authority (TSA) and overrides any URL found with the</span>
<span class="line-added"> 819 \f[CB]\-tsacert\f[R] option.</span>
<span class="line-added"> 820 The \f[CB]\-tsa\f[R] option doesn\[aq]t require the TSA public key</span>
<span class="line-added"> 821 certificate to be present in the keystore.</span>
<span class="line-added"> 822 .RS</span>
<span class="line-added"> 823 .PP</span>
<span class="line-added"> 824 To generate the time stamp, \f[CB]jarsigner\f[R] communicates with the TSA</span>
<span class="line-added"> 825 with the Time\-Stamp Protocol (TSP) defined in RFC 3161.</span>
<span class="line-added"> 826 When successful, the time stamp token returned by the TSA is stored with</span>
<span class="line-added"> 827 the signature in the signature block file.</span>
<span class="line-added"> 828 .RE</span>
 829 .TP
<span class="line-modified"> 830 .B \f[CB]\-tsacert\f[R] \f[I]alias\f[R]</span>
<span class="line-modified"> 831 When \f[CB]\-tsacert\f[R] \f[I]alias\f[R] appears on the command line when</span>
<span class="line-modified"> 832 signing a JAR file, a time stamp is generated for the signature.</span>
<span class="line-modified"> 833 The alias identifies the TSA public key certificate in the keystore that</span>
<span class="line-modified"> 834 is in effect.</span>
<span class="line-modified"> 835 The entry\[aq]s certificate is examined for a Subject Information Access</span>
<span class="line-modified"> 836 extension that contains a URL identifying the location of the TSA.</span>
<span class="line-added"> 837 .RS</span>
<span class="line-added"> 838 .PP</span>
<span class="line-added"> 839 The TSA public key certificate must be present in the keystore when</span>
<span class="line-added"> 840 using the \f[CB]\-tsacert\f[R] option.</span>
<span class="line-added"> 841 .RE</span>
<span class="line-added"> 842 .TP</span>
<span class="line-added"> 843 .B \f[CB]\-tsapolicyid\f[R] \f[I]policyid\f[R]</span>
<span class="line-added"> 844 Specifies the object identifier (OID) that identifies the policy ID to</span>
<span class="line-added"> 845 be sent to the TSA server.</span>
<span class="line-added"> 846 If this option isn\[aq]t specified, no policy ID is sent and the TSA</span>
<span class="line-added"> 847 server will choose a default policy ID.</span>
<span class="line-added"> 848 .RS</span>
<span class="line-added"> 849 .PP</span>
<span class="line-added"> 850 Object identifiers are defined by X.696, which is an ITU</span>
<span class="line-added"> 851 Telecommunication Standardization Sector (ITU\-T) standard.</span>
<span class="line-added"> 852 These identifiers are typically period\-separated sets of non\-negative</span>
<span class="line-added"> 853 digits like \f[CB]1.2.3.4\f[R], for example.</span>
<span class="line-added"> 854 .RE</span>
<span class="line-added"> 855 .TP</span>
<span class="line-added"> 856 .B \f[CB]\-tsadigestalg\f[R] \f[I]algorithm\f[R]</span>
<span class="line-added"> 857 Specifies the message digest algorithm that is used to generate the</span>
<span class="line-added"> 858 message imprint to be sent to the TSA server.</span>
<span class="line-added"> 859 If this option isn\[aq]t specified, SHA\-256 will be used.</span>
<span class="line-added"> 860 .RS</span>
<span class="line-added"> 861 .PP</span>
<span class="line-added"> 862 See \f[B]Supported Algorithms\f[R].</span>
<span class="line-added"> 863 .PP</span>
<span class="line-added"> 864 For a list of standard message digest algorithm names, see Java Security</span>
<span class="line-added"> 865 Standard Algorithm Names.</span>
<span class="line-added"> 866 .RE</span>
<span class="line-added"> 867 .TP</span>
<span class="line-added"> 868 .B \f[CB]\-internalsf\f[R]</span>
<span class="line-added"> 869 In the past, the \f[CB]\&amp;.DSA\f[R] (signature block) file generated when a</span>
<span class="line-added"> 870 JAR file was signed included a complete encoded copy of the</span>
<span class="line-added"> 871 \f[CB]\&amp;.SF\f[R] file (signature file) also generated.</span>
<span class="line-added"> 872 This behavior has been changed.</span>
<span class="line-added"> 873 To reduce the overall size of the output JAR file, the \f[CB]\&amp;.DSA\f[R]</span>
<span class="line-added"> 874 file by default doesn\[aq]t contain a copy of the \f[CB]\&amp;.SF\f[R] file</span>
<span class="line-added"> 875 anymore.</span>
<span class="line-added"> 876 If \f[CB]\-internalsf\f[R] appears on the command line, then the old</span>
<span class="line-added"> 877 behavior is utilized.</span>
<span class="line-added"> 878 This option is useful for testing.</span>
<span class="line-added"> 879 In practice, don\[aq]t use the \f[CB]\-internalsf\f[R] option because it</span>
<span class="line-added"> 880 incurs higher overhead.</span>
<span class="line-added"> 881 .RS</span>
<span class="line-added"> 882 .RE</span>
<span class="line-added"> 883 .TP</span>
<span class="line-added"> 884 .B \f[CB]\-sectionsonly\f[R]</span>
<span class="line-added"> 885 If the \f[CB]\-sectionsonly\f[R] option appears on the command line, then</span>
<span class="line-added"> 886 the \f[CB]\&amp;.SF\f[R] file (signature file) generated when a JAR file is</span>
<span class="line-added"> 887 signed doesn\[aq]t include a header that contains a hash of the whole</span>
<span class="line-added"> 888 manifest file.</span>
<span class="line-added"> 889 It contains only the information and hashes related to each individual</span>
<span class="line-added"> 890 source file included in the JAR file.</span>
<span class="line-added"> 891 See Signature File.</span>
<span class="line-added"> 892 .RS</span>
<span class="line-added"> 893 .PP</span>
<span class="line-added"> 894 By default, this header is added, as an optimization.</span>
<span class="line-added"> 895 When the header is present, whenever the JAR file is verified, the</span>
<span class="line-added"> 896 verification can first check to see whether the hash in the header</span>
<span class="line-added"> 897 matches the hash of the whole manifest file.</span>
<span class="line-added"> 898 When there is a match, verification proceeds to the next step.</span>
<span class="line-added"> 899 When there is no match, it is necessary to do a less optimized</span>
<span class="line-added"> 900 verification that the hash in each source file information section in</span>
<span class="line-added"> 901 the \f[CB]\&amp;.SF\f[R] file equals the hash of its corresponding section in</span>
<span class="line-added"> 902 the manifest file.</span>
<span class="line-added"> 903 See \f[B]JAR File Verification\f[R].</span>
<span class="line-added"> 904 .PP</span>
<span class="line-added"> 905 The \f[CB]\-sectionsonly\f[R] option is primarily used for testing.</span>
<span class="line-added"> 906 It shouldn\[aq]t be used other than for testing because using it incurs</span>
<span class="line-added"> 907 higher overhead.</span>
<span class="line-added"> 908 .RE</span>
<span class="line-added"> 909 .TP</span>
<span class="line-added"> 910 .B \f[CB]\-protected\f[R]</span>
<span class="line-added"> 911 Values can be either \f[CB]true\f[R] or \f[CB]false\f[R].</span>
<span class="line-added"> 912 Specify \f[CB]true\f[R] when a password must be specified through a</span>
<span class="line-added"> 913 protected authentication path such as a dedicated PIN reader.</span>
<span class="line-added"> 914 .RS</span>
<span class="line-added"> 915 .RE</span>
<span class="line-added"> 916 .TP</span>
<span class="line-added"> 917 .B \f[CB]\-providerName\f[R] \f[I]providerName\f[R]</span>
<span class="line-added"> 918 If more than one provider was configured in the \f[CB]java.security\f[R]</span>
<span class="line-added"> 919 security properties file, then you can use the \f[CB]\-providerName\f[R]</span>
<span class="line-added"> 920 option to target a specific provider instance.</span>
<span class="line-added"> 921 The argument to this option is the name of the provider.</span>
<span class="line-added"> 922 .RS</span>
<span class="line-added"> 923 .PP</span>
<span class="line-added"> 924 For the Oracle PKCS #11 provider, \f[I]providerName\f[R] is of the form</span>
<span class="line-added"> 925 \f[CB]SunPKCS11\-\f[R]\f[I]TokenName\f[R], where \f[I]TokenName\f[R] is the</span>
<span class="line-added"> 926 name suffix that the provider instance has been configured with, as</span>
<span class="line-added"> 927 detailed in the configuration attributes table.</span>
<span class="line-added"> 928 For example, the following command lists the contents of the</span>
<span class="line-added"> 929 \f[CB]PKCS\ #11\f[R] keystore provider instance with name suffix</span>
<span class="line-added"> 930 \f[CB]SmartCard\f[R]:</span>
<span class="line-added"> 931 .RS</span>
<span class="line-added"> 932 .PP</span>
<span class="line-added"> 933 \f[CB]jarsigner\ \-keystore\ NONE\ \-storetype\ PKCS11\ \-providerName\ SunPKCS11\-SmartCard\ \-list\f[R]</span>
<span class="line-added"> 934 .RE</span>
<span class="line-added"> 935 .RE</span>
<span class="line-added"> 936 .TP</span>
<span class="line-added"> 937 .B \f[CB]\-addprovider\f[R] \f[I]name\f[R] [\f[CB]\-providerArg\f[R] \f[I]arg\f[R]]</span>
<span class="line-added"> 938 Adds a security provider by name (such as SunPKCS11) and an optional</span>
<span class="line-added"> 939 configure argument.</span>
<span class="line-added"> 940 The value of the security provider is the name of a security provider</span>
<span class="line-added"> 941 that is defined in a module.</span>
<span class="line-added"> 942 .RS</span>
<span class="line-added"> 943 .PP</span>
<span class="line-added"> 944 Used with the \f[CB]\-providerArg\ ConfigFilePath\f[R] option, the</span>
<span class="line-added"> 945 \f[CB]keytool\f[R] and \f[CB]jarsigner\f[R] tools install the provider</span>
<span class="line-added"> 946 dynamically and use \f[CB]ConfigFilePath\f[R] for the path to the token</span>
<span class="line-added"> 947 configuration file.</span>
<span class="line-added"> 948 The following example shows a command to list a \f[CB]PKCS\ #11\f[R]</span>
<span class="line-added"> 949 keystore when the Oracle PKCS #11 provider wasn\[aq]t configured in the</span>
<span class="line-added"> 950 security properties file.</span>
<span class="line-added"> 951 .RS</span>
<span class="line-added"> 952 .PP</span>
<span class="line-added"> 953 \f[CB]jarsigner\ \-keystore\ NONE\ \-storetype\ PKCS11\ \-addprovider\ SunPKCS11\ \-providerArg\ /mydir1/mydir2/token.config\f[R]</span>
<span class="line-added"> 954 .RE</span>
<span class="line-added"> 955 .RE</span>
<span class="line-added"> 956 .TP</span>
<span class="line-added"> 957 .B \f[CB]\-providerClass\f[R] \f[I]provider\-class\-name\f[R] [\f[CB]\-providerArg\f[R] \f[I]arg\f[R]]</span>
<span class="line-added"> 958 Used to specify the name of cryptographic service provider\[aq]s master</span>
<span class="line-added"> 959 class file when the service provider isn\[aq]t listed in the</span>
<span class="line-added"> 960 \f[CB]java.security\f[R] security properties file.</span>
<span class="line-added"> 961 Adds a security provider by fully\-qualified class name and an optional</span>
<span class="line-added"> 962 configure argument.</span>
<span class="line-added"> 963 .RS</span>
<span class="line-added"> 964 .PP</span>
<span class="line-added"> 965 \f[B]Note:\f[R]</span>
<span class="line-added"> 966 .PP</span>
<span class="line-added"> 967 The preferred way to load PKCS11 is by using modules.</span>
<span class="line-added"> 968 See \f[CB]\-addprovider\f[R].</span>
<span class="line-added"> 969 .RE</span>
<span class="line-added"> 970 .TP</span>
<span class="line-added"> 971 .B \f[CB]\-J\f[R]\f[I]javaoption\f[R]</span>
<span class="line-added"> 972 Passes through the specified \f[I]javaoption\f[R] string directly to the</span>
<span class="line-added"> 973 Java interpreter.</span>
<span class="line-added"> 974 The \f[CB]jarsigner\f[R] command is a wrapper around the interpreter.</span>
<span class="line-added"> 975 This option shouldn\[aq]t contain any spaces.</span>
<span class="line-added"> 976 It is useful for adjusting the execution environment or memory usage.</span>
<span class="line-added"> 977 For a list of possible interpreter options, type \f[CB]java\ \-h\f[R] or</span>
<span class="line-added"> 978 \f[CB]java\ \-X\f[R] at the command line.</span>
<span class="line-added"> 979 .RS</span>
<span class="line-added"> 980 .RE</span>
<span class="line-added"> 981 .TP</span>
<span class="line-added"> 982 .B \f[CB]\-strict\f[R]</span>
<span class="line-added"> 983 During the signing or verifying process, the command may issue warning</span>
<span class="line-added"> 984 messages.</span>
<span class="line-added"> 985 If you specify this option, the exit code of the tool reflects the</span>
<span class="line-added"> 986 severe warning messages that this command found.</span>
<span class="line-added"> 987 See \f[B]Errors and Warnings\f[R].</span>
<span class="line-added"> 988 .RS</span>
<span class="line-added"> 989 .RE</span>
<span class="line-added"> 990 .TP</span>
<span class="line-added"> 991 .B \f[CB]\-conf\f[R] \f[I]url\f[R]</span>
<span class="line-added"> 992 Specifies a pre\-configured options file.</span>
<span class="line-added"> 993 Read the \f[B]keytool documentation\f[R] for details.</span>
<span class="line-added"> 994 The property keys supported are &quot;jarsigner.all&quot; for all actions,</span>
<span class="line-added"> 995 &quot;jarsigner.sign&quot; for signing, and &quot;jarsigner.verify&quot; for verification.</span>
<span class="line-added"> 996 \f[CB]jarsigner\f[R] arguments including the JAR file name and alias</span>
<span class="line-added"> 997 name(s) cannot be set in this file.</span>
<span class="line-added"> 998 .RS</span>
<span class="line-added"> 999 .RE</span>
<span class="line-added">1000 .SH DEPRECATED OPTIONS</span>
<span class="line-added">1001 .PP</span>
<span class="line-added">1002 The following \f[CB]jarsigner\f[R] options are deprecated as of JDK 9 and</span>
<span class="line-added">1003 might be removed in a future JDK release.</span>
<span class="line-added">1004 .TP</span>
<span class="line-added">1005 .B \f[CB]\-altsigner\f[R] \f[I]class\f[R]</span>
<span class="line-added">1006 This option specifies an alternative signing mechanism.</span>
<span class="line-added">1007 The fully qualified class name identifies a class file that extends the</span>
<span class="line-added">1008 \f[CB]com.sun.jarsigner.ContentSigner\f[R] abstract class.</span>
<span class="line-added">1009 The path to this class file is defined by the \f[CB]\-altsignerpath\f[R]</span>
<span class="line-added">1010 option.</span>
<span class="line-added">1011 If the \f[CB]\-altsigner\f[R] option is used, then the \f[CB]jarsigner\f[R]</span>
<span class="line-added">1012 command uses the signing mechanism provided by the specified class.</span>
<span class="line-added">1013 Otherwise, the \f[CB]jarsigner\f[R] command uses its default signing</span>
<span class="line-added">1014 mechanism.</span>
<span class="line-added">1015 .RS</span>
<span class="line-added">1016 .PP</span>
<span class="line-added">1017 For example, to use the signing mechanism provided by a class named</span>
<span class="line-added">1018 \f[CB]com.sun.sun.jarsigner.AuthSigner\f[R], use the \f[CB]jarsigner\f[R]</span>
<span class="line-added">1019 option \f[CB]\-altsigner\ com.sun.jarsigner.AuthSigner\f[R].</span>
<span class="line-added">1020 .RE</span>
<span class="line-added">1021 .TP</span>
<span class="line-added">1022 .B \f[CB]\-altsignerpath\f[R] \f[I]classpathlist\f[R]</span>
<span class="line-added">1023 Specifies the path to the class file and any JAR file it depends on.</span>
<span class="line-added">1024 The class file name is specified with the \f[CB]\-altsigner\f[R] option.</span>
<span class="line-added">1025 If the class file is in a JAR file, then this option specifies the path</span>
<span class="line-added">1026 to that JAR file.</span>
<span class="line-added">1027 .RS</span>
<span class="line-added">1028 .PP</span>
<span class="line-added">1029 An absolute path or a path relative to the current directory can be</span>
<span class="line-added">1030 specified.</span>
<span class="line-added">1031 If \f[I]classpathlist\f[R] contains multiple paths or JAR files, then</span>
<span class="line-added">1032 they should be separated with a:</span>
<span class="line-added">1033 .IP \[bu] 2</span>
<span class="line-added">1034 Colon (\f[CB]:\f[R]) on Oracle Solaris, Linux, and macOS</span>
<span class="line-added">1035 .IP \[bu] 2</span>
<span class="line-added">1036 Semicolon (\f[CB];\f[R]) on Windows</span>
<span class="line-added">1037 .PP</span>
<span class="line-added">1038 This option isn\[aq]t necessary when the class is already in the search</span>
<span class="line-added">1039 path.</span>
<span class="line-added">1040 .PP</span>
<span class="line-added">1041 The following example shows how to specify the path to a JAR file that</span>
<span class="line-added">1042 contains the class file.</span>
<span class="line-added">1043 The JAR file name is included.</span>
<span class="line-added">1044 .RS</span>
<span class="line-added">1045 .PP</span>
<span class="line-added">1046 \f[CB]\-altsignerpath\ /home/user/lib/authsigner.jar\f[R]</span>
<span class="line-added">1047 .RE</span>
<span class="line-added">1048 .PP</span>
<span class="line-added">1049 The following example shows how to specify the path to the JAR file that</span>
<span class="line-added">1050 contains the class file.</span>
<span class="line-added">1051 The JAR file name is omitted.</span>
<span class="line-added">1052 .RS</span>
<span class="line-added">1053 .PP</span>
<span class="line-added">1054 \f[CB]\-altsignerpath\ /home/user/classes/com/sun/tools/jarsigner/\f[R]</span>
<span class="line-added">1055 .RE</span>
<span class="line-added">1056 .RE</span>
<span class="line-added">1057 .SH ERRORS AND WARNINGS</span>
<span class="line-added">1058 .PP</span>
<span class="line-added">1059 During the signing or verifying process, the \f[CB]jarsigner\f[R] command</span>
<span class="line-added">1060 may issue various errors or warnings.</span>
<span class="line-added">1061 .PP</span>
<span class="line-added">1062 If there is a failure, the \f[CB]jarsigner\f[R] command exits with code 1.</span>
<span class="line-added">1063 If there is no failure, but there are one or more severe warnings, the</span>
<span class="line-added">1064 \f[CB]jarsigner\f[R] command exits with code 0 when the \f[CB]\-strict\f[R]</span>
<span class="line-added">1065 option is \f[B]not\f[R] specified, or exits with the OR\-value of the</span>
<span class="line-added">1066 warning codes when the \f[CB]\-strict\f[R] is specified.</span>
<span class="line-added">1067 If there is only informational warnings or no warning at all, the</span>
<span class="line-added">1068 command always exits with code 0.</span>
<span class="line-added">1069 .PP</span>
<span class="line-added">1070 For example, if a certificate used to sign an entry is expired and has a</span>
<span class="line-added">1071 KeyUsage extension that doesn\[aq]t allow it to sign a file, the</span>
<span class="line-added">1072 \f[CB]jarsigner\f[R] command exits with code 12 (=4+8) when the</span>
<span class="line-added">1073 \f[CB]\-strict\f[R] option is specified.</span>
<span class="line-added">1074 .PP</span>
<span class="line-added">1075 \f[B]Note:\f[R] Exit codes are reused because only the values from 0 to</span>
<span class="line-added">1076 255 are legal on Oracle Solaris, Linux, and OS X.</span>
<span class="line-added">1077 .PP</span>
<span class="line-added">1078 The following sections describes the names, codes, and descriptions of</span>
<span class="line-added">1079 the errors and warnings that the \f[CB]jarsigner\f[R] command can issue.</span>
<span class="line-added">1080 .SH FAILURE</span>
<span class="line-added">1081 .PP</span>
<span class="line-added">1082 Reasons why the \f[CB]jarsigner\f[R] command fails include (but aren\[aq]t</span>
<span class="line-added">1083 limited to) a command line parsing error, the inability to find a</span>
<span class="line-added">1084 keypair to sign the JAR file, or the verification of a signed JAR fails.</span>
<span class="line-added">1085 .TP</span>
<span class="line-added">1086 .B failure</span>
<span class="line-added">1087 Code 1.</span>
<span class="line-added">1088 The signing or verifying fails.</span>
<span class="line-added">1089 .RS</span>
<span class="line-added">1090 .RE</span>
<span class="line-added">1091 .SH SEVERE WARNINGS</span>
<span class="line-added">1092 .PP</span>
<span class="line-added">1093 \f[B]Note:\f[R]</span>
<span class="line-added">1094 .PP</span>
<span class="line-added">1095 Severe warnings are reported as errors if you specify the</span>
<span class="line-added">1096 \f[CB]\-strict\f[R] option.</span>
<span class="line-added">1097 .PP</span>
<span class="line-added">1098 Reasons why the \f[CB]jarsigner\f[R] command issues a severe warning</span>
<span class="line-added">1099 include the certificate used to sign the JAR file has an error or the</span>
<span class="line-added">1100 signed JAR file has other problems.</span>
<span class="line-added">1101 .TP</span>
<span class="line-added">1102 .B hasExpiredCert</span>
<span class="line-added">1103 Code 4.</span>
<span class="line-added">1104 This JAR contains entries whose signer certificate has expired.</span>
<span class="line-added">1105 .RS</span>
<span class="line-added">1106 .RE</span>
<span class="line-added">1107 .TP</span>
<span class="line-added">1108 .B hasExpiredTsaCert</span>
<span class="line-added">1109 Code 4.</span>
<span class="line-added">1110 The timestamp has expired.</span>
<span class="line-added">1111 .RS</span>
<span class="line-added">1112 .RE</span>
<span class="line-added">1113 .TP</span>
<span class="line-added">1114 .B notYetValidCert</span>
<span class="line-added">1115 Code 4.</span>
<span class="line-added">1116 This JAR contains entries whose signer certificate isn\[aq]t yet valid.</span>
<span class="line-added">1117 .RS</span>
<span class="line-added">1118 .RE</span>
<span class="line-added">1119 .TP</span>
<span class="line-added">1120 .B chainNotValidated</span>
<span class="line-added">1121 Code 4.</span>
<span class="line-added">1122 This JAR contains entries whose certificate chain isn\[aq]t validated.</span>
<span class="line-added">1123 .RS</span>
<span class="line-added">1124 .RE</span>
<span class="line-added">1125 .TP</span>
<span class="line-added">1126 .B tsaChainNotValidated</span>
<span class="line-added">1127 Code 64.</span>
<span class="line-added">1128 The timestamp is invalid.</span>
<span class="line-added">1129 .RS</span>
<span class="line-added">1130 .RE</span>
<span class="line-added">1131 .TP</span>
<span class="line-added">1132 .B signerSelfSigned</span>
<span class="line-added">1133 Code 4.</span>
<span class="line-added">1134 This JAR contains entries whose signer certificate is self signed.</span>
<span class="line-added">1135 .RS</span>
<span class="line-added">1136 .RE</span>
<span class="line-added">1137 .TP</span>
<span class="line-added">1138 .B weakAlg</span>
<span class="line-added">1139 Code 4.</span>
<span class="line-added">1140 An algorithm specified on the command line is considered a security</span>
<span class="line-added">1141 risk.</span>
<span class="line-added">1142 .RS</span>
<span class="line-added">1143 .RE</span>
<span class="line-added">1144 .TP</span>
<span class="line-added">1145 .B badKeyUsage</span>
<span class="line-added">1146 Code 8.</span>
<span class="line-added">1147 This JAR contains entries whose signer certificate\[aq]s KeyUsage</span>
<span class="line-added">1148 extension doesn\[aq]t allow code signing.</span>
<span class="line-added">1149 .RS</span>
<span class="line-added">1150 .RE</span>
<span class="line-added">1151 .TP</span>
<span class="line-added">1152 .B badExtendedKeyUsage</span>
<span class="line-added">1153 Code 8.</span>
<span class="line-added">1154 This JAR contains entries whose signer certificate\[aq]s</span>
<span class="line-added">1155 ExtendedKeyUsage extension doesn\[aq]t allow code signing.</span>
<span class="line-added">1156 .RS</span>
<span class="line-added">1157 .RE</span>
<span class="line-added">1158 .TP</span>
<span class="line-added">1159 .B badNetscapeCertType</span>
<span class="line-added">1160 Code 8.</span>
<span class="line-added">1161 This JAR contains entries whose signer certificate\[aq]s</span>
<span class="line-added">1162 NetscapeCertType extension doesn\[aq]t allow code signing.</span>
<span class="line-added">1163 .RS</span>
<span class="line-added">1164 .RE</span>
<span class="line-added">1165 .TP</span>
<span class="line-added">1166 .B hasUnsignedEntry</span>
<span class="line-added">1167 Code 16.</span>
<span class="line-added">1168 This JAR contains unsigned entries which haven\[aq]t been</span>
<span class="line-added">1169 integrity\-checked.</span>
<span class="line-added">1170 .RS</span>
<span class="line-added">1171 .RE</span>
<span class="line-added">1172 .TP</span>
<span class="line-added">1173 .B notSignedByAlias</span>
<span class="line-added">1174 Code 32.</span>
<span class="line-added">1175 This JAR contains signed entries which aren\[aq]t signed by the</span>
<span class="line-added">1176 specified alias(es).</span>
<span class="line-added">1177 .RS</span>
<span class="line-added">1178 .RE</span>
<span class="line-added">1179 .TP</span>
<span class="line-added">1180 .B aliasNotInStore</span>
<span class="line-added">1181 Code 32.</span>
<span class="line-added">1182 This JAR contains signed entries that aren\[aq]t signed by alias in this</span>
<span class="line-added">1183 keystore.</span>
<span class="line-added">1184 .RS</span>
<span class="line-added">1185 .RE</span>
1186 .TP
<span class="line-modified">1187 .B tsaChainNotValidated</span>
<span class="line-modified">1188 Code 64.</span>
<span class="line-modified">1189 This JAR contains entries whose TSA certificate chain is invalid.</span>
<span class="line-added">1190 .RS</span>
<span class="line-added">1191 .RE</span>
<span class="line-added">1192 .SH INFORMATIONAL WARNINGS</span>
<span class="line-added">1193 .PP</span>
<span class="line-added">1194 Informational warnings include those that aren\[aq]t errors but regarded</span>
<span class="line-added">1195 as bad practice.</span>
<span class="line-added">1196 They don\[aq]t have a code.</span>
1197 .TP
<span class="line-modified">1198 .B hasExpiringCert</span>
<span class="line-modified">1199 This JAR contains entries whose signer certificate expires within six</span>
<span class="line-modified">1200 months.</span>
<span class="line-added">1201 .RS</span>
<span class="line-added">1202 .RE</span>
<span class="line-added">1203 .TP</span>
<span class="line-added">1204 .B hasExpiringTsaCert</span>
<span class="line-added">1205 The timestamp will expire within one year on \f[CB]YYYY\-MM\-DD\f[R].</span>
<span class="line-added">1206 .RS</span>
<span class="line-added">1207 .RE</span>
<span class="line-added">1208 .TP</span>
<span class="line-added">1209 .B noTimestamp</span>
<span class="line-added">1210 This JAR contains signatures that doesn\[aq]t include a timestamp.</span>
<span class="line-added">1211 Without a timestamp, users may not be able to validate this JAR file</span>
<span class="line-added">1212 after the signer certificate\[aq]s expiration date</span>
<span class="line-added">1213 (\f[CB]YYYY\-MM\-DD\f[R]) or after any future revocation date.</span>
<span class="line-added">1214 .RS</span>
<span class="line-added">1215 .RE</span>
<span class="line-added">1216 .SH EXAMPLE OF SIGNING A JAR FILE</span>
<span class="line-added">1217 .PP</span>
<span class="line-added">1218 Use the following command to sign \f[CB]bundle.jar\f[R] with the private</span>
<span class="line-added">1219 key of a user whose keystore alias is \f[CB]jane\f[R] in a keystore named</span>
<span class="line-added">1220 \f[CB]mystore\f[R] in the \f[CB]working\f[R] directory and name the signed</span>
<span class="line-added">1221 JAR file \f[CB]sbundle.jar\f[R]:</span>
<span class="line-added">1222 .RS</span>
<span class="line-added">1223 .PP</span>
<span class="line-added">1224 \f[CB]jarsigner\ \-keystore\ /working/mystore\ \-storepass\f[R]</span>
<span class="line-added">1225 \f[I]keystore_password\f[R] \f[CB]\-keypass\f[R]</span>
<span class="line-added">1226 \f[I]private_key_password\f[R]</span>
<span class="line-added">1227 \f[CB]\-signedjar\ sbundle.jar\ bundle.jar\ jane\f[R]</span>
<span class="line-added">1228 .RE</span>
<span class="line-added">1229 .PP</span>
<span class="line-added">1230 There is no \f[CB]\-sigfile\f[R] specified in the previous command so the</span>
<span class="line-added">1231 generated \f[CB]\&amp;.SF\f[R] and \f[CB]\&amp;.DSA\f[R] files to be placed in the</span>
<span class="line-added">1232 signed JAR file have default names based on the alias name.</span>
<span class="line-added">1233 They are named \f[CB]JANE.SF\f[R] and \f[CB]JANE.DSA\f[R].</span>
<span class="line-added">1234 .PP</span>
<span class="line-added">1235 If you want to be prompted for the store password and the private key</span>
<span class="line-added">1236 password, then you could shorten the previous command to the following:</span>
<span class="line-added">1237 .RS</span>
<span class="line-added">1238 .PP</span>
<span class="line-added">1239 \f[CB]jarsigner\ \-keystore\ /working/mystore\ \-signedjar\ sbundle.jar\ bundle.jar\ jane\f[R]</span>
<span class="line-added">1240 .RE</span>
<span class="line-added">1241 .PP</span>
<span class="line-added">1242 If the \f[CB]keystore\f[R] is the default \f[CB]keystore\f[R]</span>
<span class="line-added">1243 (\f[CB]\&amp;.keystore\f[R] in your home directory), then you don\[aq]t need</span>
<span class="line-added">1244 to specify a \f[CB]keystore\f[R], as follows:</span>
<span class="line-added">1245 .RS</span>
<span class="line-added">1246 .PP</span>
<span class="line-added">1247 \f[CB]jarsigner\ \-signedjar\ sbundle.jar\ bundle.jar\ jane\f[R]</span>
<span class="line-added">1248 .RE</span>
<span class="line-added">1249 .PP</span>
<span class="line-added">1250 If you want the signed JAR file to overwrite the input JAR file</span>
<span class="line-added">1251 (\f[CB]bundle.jar\f[R]), then you don\[aq]t need to specify a</span>
<span class="line-added">1252 \f[CB]\-signedjar\f[R] option, as follows:</span>
<span class="line-added">1253 .RS</span>
<span class="line-added">1254 .PP</span>
<span class="line-added">1255 \f[CB]jarsigner\ bundle.jar\ jane\f[R]</span>
<span class="line-added">1256 .RE</span>
<span class="line-added">1257 .SH EXAMPLE OF VERIFYING A SIGNED JAR FILE</span>
<span class="line-added">1258 .PP</span>
<span class="line-added">1259 To verify a signed JAR file to ensure that the signature is valid and</span>
<span class="line-added">1260 the JAR file wasn\[aq]t been tampered with, use a command such as the</span>
<span class="line-added">1261 following:</span>
<span class="line-added">1262 .RS</span>
<span class="line-added">1263 .PP</span>
<span class="line-added">1264 \f[CB]jarsigner\ \-verify\ ButtonDemo.jar\f[R]</span>
<span class="line-added">1265 .RE</span>
<span class="line-added">1266 .PP</span>
<span class="line-added">1267 When the verification is successful, \f[CB]jar\ verified\f[R] is</span>
<span class="line-added">1268 displayed.</span>
<span class="line-added">1269 Otherwise, an error message is displayed.</span>
<span class="line-added">1270 You can get more information when you use the \f[CB]\-verbose\f[R] option.</span>
<span class="line-added">1271 A sample use of \f[CB]jarsigner\f[R] with the \f[CB]\-verbose\f[R] option</span>
<span class="line-added">1272 follows:</span>
<span class="line-added">1273 .IP</span>
<span class="line-added">1274 .nf</span>
<span class="line-added">1275 \f[CB]</span>
<span class="line-added">1276 jarsigner\ \-verify\ \-verbose\ ButtonDemo.jar</span>
1277 
<span class="line-modified">1278 s\ \ \ \ \ \ \ 866\ Tue\ Sep\ 12\ 20:08:48\ EDT\ 2017\ META\-INF/MANIFEST.MF</span>
<span class="line-modified">1279 \ \ \ \ \ \ \ \ 825\ Tue\ Sep\ 12\ 20:08:48\ EDT\ 2017\ META\-INF/ORACLE_C.SF</span>
<span class="line-modified">1280 \ \ \ \ \ \ \ 7475\ Tue\ Sep\ 12\ 20:08:48\ EDT\ 2017\ META\-INF/ORACLE_C.RSA</span>
<span class="line-modified">1281 \ \ \ \ \ \ \ \ \ \ 0\ Tue\ Sep\ 12\ 20:07:54\ EDT\ 2017\ META\-INF/</span>
<span class="line-modified">1282 \ \ \ \ \ \ \ \ \ \ 0\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/</span>
<span class="line-modified">1283 \ \ \ \ \ \ \ \ \ \ 0\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/images/</span>
<span class="line-modified">1284 sm\ \ \ \ \ \ 523\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/ButtonDemo$1.class</span>
<span class="line-modified">1285 sm\ \ \ \ \ 3440\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/ButtonDemo.class</span>
<span class="line-modified">1286 sm\ \ \ \ \ 2346\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/ButtonDemo.jnlp</span>
<span class="line-modified">1287 sm\ \ \ \ \ \ 172\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/images/left.gif</span>
<span class="line-modified">1288 sm\ \ \ \ \ \ 235\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/images/middle.gif</span>
<span class="line-modified">1289 sm\ \ \ \ \ \ 172\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/images/right.gif</span>






1290 
<span class="line-modified">1291 \ \ s\ =\ signature\ was\ verified</span>
<span class="line-modified">1292 \ \ m\ =\ entry\ is\ listed\ in\ manifest</span>
<span class="line-modified">1293 \ \ k\ =\ at\ least\ one\ certificate\ was\ found\ in\ keystore</span>

1294 
<span class="line-modified">1295 \-\ Signed\ by\ &quot;CN=&quot;Oracle\ America,\ Inc.&quot;,\ OU=Software\ Engineering,\ O=&quot;Oracle\ America,\ Inc.&quot;,\ L=Redwood\ City,\ ST=California,\ C=US&quot;</span>
<span class="line-modified">1296 \ \ \ \ Digest\ algorithm:\ SHA\-256</span>
<span class="line-modified">1297 \ \ \ \ Signature\ algorithm:\ SHA256withRSA,\ 2048\-bit\ key</span>
<span class="line-modified">1298 \ \ Timestamped\ by\ &quot;CN=Symantec\ Time\ Stamping\ Services\ Signer\ \-\ G4,\ O=Symantec\ Corporation,\ C=US&quot;\ on\ Tue\ Sep\ 12\ 20:08:49\ UTC\ 2017</span>
<span class="line-modified">1299 \ \ \ \ Timestamp\ digest\ algorithm:\ SHA\-1</span>
<span class="line-modified">1300 \ \ \ \ Timestamp\ signature\ algorithm:\ SHA1withRSA,\ 2048\-bit\ key</span>









1301 
<span class="line-modified">1302 jar\ verified.</span>







1303 
<span class="line-modified">1304 The\ signer\ certificate\ expired\ on\ 2018\-02\-01.\ However,\ the\ JAR\ will\ be\ valid\ until\ the\ timestamp\ expires\ on\ 2020\-12\-29.</span>
<span class="line-modified">1305 \f[R]</span>
<span class="line-modified">1306 .fi</span>
<span class="line-modified">1307 .SH EXAMPLE OF VERIFICATION WITH CERTIFICATE INFORMATION</span>
<span class="line-modified">1308 .PP</span>
<span class="line-added">1309 If you specify the \f[CB]\-certs\f[R] option with the \f[CB]\-verify\f[R]</span>
<span class="line-added">1310 and \f[CB]\-verbose\f[R] options, then the output includes certificate</span>
<span class="line-added">1311 information for each signer of the JAR file.</span>
<span class="line-added">1312 The information includes the certificate type, the signer distinguished</span>
<span class="line-added">1313 name information (when it is an X.509 certificate), and in parentheses,</span>
<span class="line-added">1314 the keystore alias for the signer when the public key certificate in the</span>
<span class="line-added">1315 JAR file matches the one in a keystore entry, for example:</span>
<span class="line-added">1316 .IP</span>
<span class="line-added">1317 .nf</span>
<span class="line-added">1318 \f[CB]</span>
<span class="line-added">1319 jarsigner\ \-keystore\ $JAVA_HOME/lib/security/cacerts\ \-verify\ \-verbose\ \-certs\ ButtonDemo.jar</span>
1320 
<span class="line-modified">1321 s\ k\ \ \ \ \ 866\ Tue\ Sep\ 12\ 20:08:48\ EDT\ 2017\ META\-INF/MANIFEST.MF</span>




1322 
<span class="line-modified">1323 \ \ \ \ \ \ &gt;&gt;&gt;\ Signer</span>
<span class="line-modified">1324 \ \ \ \ \ \ X.509,\ CN=&quot;Oracle\ America,\ Inc.&quot;,\ OU=Software\ Engineering,\ O=&quot;Oracle\ America,\ Inc.&quot;,\ L=Redwood\ City,\ ST=California,\ C=US</span>
<span class="line-modified">1325 \ \ \ \ \ \ [certificate\ is\ valid\ from\ 2017\-01\-30,\ 7:00\ PM\ to\ 2018\-02\-01,\ 6:59\ PM]</span>
<span class="line-modified">1326 \ \ \ \ \ \ X.509,\ CN=Symantec\ Class\ 3\ SHA256\ Code\ Signing\ CA,\ OU=Symantec\ Trust\ Network,\ O=Symantec\ Corporation,\ C=US</span>
<span class="line-modified">1327 \ \ \ \ \ \ [certificate\ is\ valid\ from\ 2013\-12\-09,\ 7:00\ PM\ to\ 2023\-12\-09,\ 6:59\ PM]</span>
<span class="line-added">1328 \ \ \ \ \ \ X.509,\ CN=VeriSign\ Class\ 3\ Public\ Primary\ Certification\ Authority\ \-\ G5,\ OU=&quot;(c)\ 2006\ VeriSign,\ Inc.\ \-\ For\ authorized\ use\ only&quot;,\ OU=VeriSign\ Trust\ Network,\ O=&quot;VeriSign,\ Inc.&quot;,\ C=US\ (verisignclass3g5ca\ [jdk])</span>
<span class="line-added">1329 \ \ \ \ \ \ [trusted\ certificate]</span>
<span class="line-added">1330 \ \ \ \ \ \ &gt;&gt;&gt;\ TSA</span>
<span class="line-added">1331 \ \ \ \ \ \ X.509,\ CN=Symantec\ Time\ Stamping\ Services\ Signer\ \-\ G4,\ O=Symantec\ Corporation,\ C=US</span>
<span class="line-added">1332 \ \ \ \ \ \ [certificate\ is\ valid\ from\ 2012\-10\-17,\ 8:00\ PM\ to\ 2020\-12\-29,\ 6:59\ PM]</span>
<span class="line-added">1333 \ \ \ \ \ \ X.509,\ CN=Symantec\ Time\ Stamping\ Services\ CA\ \-\ G2,\ O=Symantec\ Corporation,\ C=US</span>
<span class="line-added">1334 \ \ \ \ \ \ [certificate\ is\ valid\ from\ 2012\-12\-20,\ 7:00\ PM\ to\ 2020\-12\-30,\ 6:59\ PM]</span>
1335 
<span class="line-modified">1336 \ \ \ \ \ \ \ \ 825\ Tue\ Sep\ 12\ 20:08:48\ EDT\ 2017\ META\-INF/ORACLE_C.SF</span>
<span class="line-modified">1337 \ \ \ \ \ \ \ 7475\ Tue\ Sep\ 12\ 20:08:48\ EDT\ 2017\ META\-INF/ORACLE_C.RSA</span>
<span class="line-modified">1338 \ \ \ \ \ \ \ \ \ \ 0\ Tue\ Sep\ 12\ 20:07:54\ EDT\ 2017\ META\-INF/</span>
<span class="line-modified">1339 \ \ \ \ \ \ \ \ \ \ 0\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/</span>
<span class="line-modified">1340 \ \ \ \ \ \ \ \ \ \ 0\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/images/</span>
<span class="line-added">1341 smk\ \ \ \ \ 523\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/ButtonDemo$1.class</span>
1342 
<span class="line-modified">1343 \ \ \ \ \ \ [entry\ was\ signed\ on\ 2017\-09\-12,\ 4:08\ PM]</span>
<span class="line-added">1344 \ \ \ \ \ \ &gt;&gt;&gt;\ Signer</span>
<span class="line-added">1345 \ \ \ \ \ \ X.509,\ CN=&quot;Oracle\ America,\ Inc.&quot;,\ OU=Software\ Engineering,\ O=&quot;Oracle\ America,\ Inc.&quot;,\ L=Redwood\ City,\ ST=California,\ C=US</span>
<span class="line-added">1346 \ \ \ \ \ \ [certificate\ is\ valid\ from\ 2017\-01\-30,\ 7:00\ PM\ to\ 2018\-02\-01,\ 6:59\ PM]</span>
<span class="line-added">1347 \ \ \ \ \ \ X.509,\ CN=Symantec\ Class\ 3\ SHA256\ Code\ Signing\ CA,\ OU=Symantec\ Trust\ Network,\ O=Symantec\ Corporation,\ C=US</span>
<span class="line-added">1348 \ \ \ \ \ \ [certificate\ is\ valid\ from\ 2013\-12\-09,\ 7:00\ PM\ to\ 2023\-12\-09,\ 6:59\ PM]</span>
<span class="line-added">1349 \ \ \ \ \ \ X.509,\ CN=VeriSign\ Class\ 3\ Public\ Primary\ Certification\ Authority\ \-\ G5,\ OU=&quot;(c)\ 2006\ VeriSign,\ Inc.\ \-\ For\ authorized\ use\ only&quot;,\ OU=VeriSign\ Trust\ Network,\ O=&quot;VeriSign,\ Inc.&quot;,\ C=US\ (verisignclass3g5ca\ [jdk])</span>
<span class="line-added">1350 \ \ \ \ \ \ [trusted\ certificate]</span>
<span class="line-added">1351 \ \ \ \ \ \ &gt;&gt;&gt;\ TSA</span>
<span class="line-added">1352 \ \ \ \ \ \ X.509,\ CN=Symantec\ Time\ Stamping\ Services\ Signer\ \-\ G4,\ O=Symantec\ Corporation,\ C=US</span>
<span class="line-added">1353 \ \ \ \ \ \ [certificate\ is\ valid\ from\ 2012\-10\-17,\ 8:00\ PM\ to\ 2020\-12\-29,\ 6:59\ PM]</span>
<span class="line-added">1354 \ \ \ \ \ \ X.509,\ CN=Symantec\ Time\ Stamping\ Services\ CA\ \-\ G2,\ O=Symantec\ Corporation,\ C=US</span>
<span class="line-added">1355 \ \ \ \ \ \ [certificate\ is\ valid\ from\ 2012\-12\-20,\ 7:00\ PM\ to\ 2020\-12\-30,\ 6:59\ PM]</span>
1356 
<span class="line-modified">1357 smk\ \ \ \ 3440\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/ButtonDemo.class</span>
<span class="line-modified">1358 \&amp;...</span>
<span class="line-modified">1359 smk\ \ \ \ 2346\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/ButtonDemo.jnlp</span>
<span class="line-modified">1360 \&amp;...</span>
<span class="line-modified">1361 smk\ \ \ \ \ 172\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/images/left.gif</span>
<span class="line-modified">1362 \&amp;...</span>
<span class="line-modified">1363 smk\ \ \ \ \ 235\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/images/middle.gif</span>
<span class="line-modified">1364 \&amp;...</span>
<span class="line-modified">1365 smk\ \ \ \ \ 172\ Tue\ Sep\ 12\ 20:07:16\ EDT\ 2017\ components/images/right.gif</span>
<span class="line-added">1366 \&amp;...</span>
1367 
<span class="line-added">1368 \ \ s\ =\ signature\ was\ verified</span>
<span class="line-added">1369 \ \ m\ =\ entry\ is\ listed\ in\ manifest</span>
<span class="line-added">1370 \ \ k\ =\ at\ least\ one\ certificate\ was\ found\ in\ keystore</span>
1371 
<span class="line-modified">1372 \-\ Signed\ by\ &quot;CN=&quot;Oracle\ America,\ Inc.&quot;,\ OU=Software\ Engineering,\ O=&quot;Oracle\ America,\ Inc.&quot;,\ L=Redwood\ City,\ ST=California,\ C=US&quot;</span>
<span class="line-modified">1373 \ \ \ \ Digest\ algorithm:\ SHA\-256</span>
<span class="line-modified">1374 \ \ \ \ Signature\ algorithm:\ SHA256withRSA,\ 2048\-bit\ key</span>
<span class="line-modified">1375 \ \ Timestamped\ by\ &quot;CN=Symantec\ Time\ Stamping\ Services\ Signer\ \-\ G4,\ O=Symantec\ Corporation,\ C=US&quot;\ on\ Tue\ Sep\ 12\ 20:08:49\ UTC\ 2017</span>
<span class="line-modified">1376 \ \ \ \ Timestamp\ digest\ algorithm:\ SHA\-1</span>
<span class="line-modified">1377 \ \ \ \ Timestamp\ signature\ algorithm:\ SHA1withRSA,\ 2048\-bit\ key</span>



1378 
<span class="line-modified">1379 jar\ verified.</span>
<span class="line-modified">1380 </span>
<span class="line-modified">1381 The\ signer\ certificate\ expired\ on\ 2018\-02\-01.\ However,\ the\ JAR\ will\ be\ valid\ until\ the\ timestamp\ expires\ on\ 2020\-12\-29.</span>
<span class="line-modified">1382 \f[R]</span>
<span class="line-modified">1383 .fi</span>
<span class="line-modified">1384 .PP</span>
<span class="line-modified">1385 If the certificate for a signer isn\[aq]t an X.509 certificate, then</span>
<span class="line-modified">1386 there is no distinguished name information.</span>
<span class="line-modified">1387 In that case, just the certificate type and the alias are shown.</span>
<span class="line-modified">1388 For example, if the certificate is a PGP certificate, and the alias is</span>
<span class="line-modified">1389 \f[CB]bob\f[R], then you would get: \f[CB]PGP,\ (bob)\f[R].</span>







































































































































































































































</pre>
</td>
</tr>
</table>
<center><a href="jar.1.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../../jdk.javadoc/share/classes/jdk/javadoc/doclet/Doclet.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>