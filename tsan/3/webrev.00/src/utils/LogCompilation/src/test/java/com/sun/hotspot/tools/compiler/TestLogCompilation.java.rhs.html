<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/utils/LogCompilation/src/test/java/com/sun/hotspot/tools/compiler/TestLogCompilation.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 2018, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  *
 23  */
 24 package com.sun.hotspot.tools.compiler;
 25 
 26 import java.util.Arrays;
 27 import java.util.Collection;
 28 import org.junit.BeforeClass;
 29 import org.junit.Test;
 30 import org.junit.runner.RunWith;
 31 import org.junit.runners.Parameterized;
 32 import org.junit.runners.Parameterized.Parameters;
 33 
 34 @RunWith(value = Parameterized.class)
 35 public class TestLogCompilation {
 36 
 37     String logFile;
 38 
 39     static final String setupArgsTieredVersion[] = {
 40         &quot;java&quot;,
 41         &quot;-XX:+UnlockDiagnosticVMOptions&quot;,
 42         &quot;-XX:+LogCompilation&quot;,
 43         &quot;-XX:LogFile=target/tiered_version.log&quot;,
 44         &quot;-version&quot;
 45     };
 46 
 47     static final String setupArgsTiered[] = {
 48         &quot;java&quot;,
 49         &quot;-XX:+UnlockDiagnosticVMOptions&quot;,
 50         &quot;-XX:+LogCompilation&quot;,
 51         &quot;-XX:LogFile=target/tiered_short.log&quot;
 52     };
 53 
 54     static final String setupArgsTieredBatch[] = {
 55         &quot;java&quot;,
 56         &quot;-XX:+UnlockDiagnosticVMOptions&quot;,
 57         &quot;-XX:+LogCompilation&quot;,
 58         &quot;-XX:LogFile=target/tiered_short_batch.log&quot;,
 59         &quot;-Xbatch&quot;
 60     };
 61 
 62     static final String setupArgsNoTiered[] = {
 63         &quot;java&quot;,
 64         &quot;-XX:-TieredCompilation&quot;,
 65         &quot;-XX:+UnlockDiagnosticVMOptions&quot;,
 66         &quot;-XX:+LogCompilation&quot;,
 67         &quot;-XX:LogFile=target/no_tiered_short.log&quot;
 68     };
 69 
 70     static final String setupArgsNoTieredBatch[] = {
 71         &quot;java&quot;,
 72         &quot;-XX:-TieredCompilation&quot;,
 73         &quot;-XX:+UnlockDiagnosticVMOptions&quot;,
 74         &quot;-XX:+LogCompilation&quot;,
 75         &quot;-XX:LogFile=target/no_tiered_short_batch.log&quot;,
 76         &quot;-Xbatch&quot;
 77     };
 78 
 79     static final String allSetupArgs[][] = {
 80         setupArgsTieredVersion,
 81         setupArgsTiered,
 82         setupArgsTieredBatch,
 83         setupArgsNoTiered,
 84         setupArgsNoTieredBatch
 85     };
 86 
 87     @Parameters
 88     public static Collection data() {
 89         Object[][] data = new Object[][]{
 90             // Take care these match whats created in the setup method
 91             {&quot;./target/tiered_version.log&quot;},
 92             {&quot;./target/tiered_short.log&quot;},
 93             {&quot;./target/tiered_short_batch.log&quot;},
 94             {&quot;./target/no_tiered_short.log&quot;},
 95             {&quot;./target/no_tiered_short_batch.log&quot;}
 96         };
 97         assert data.length == allSetupArgs.length : &quot;Files dont match args.&quot;;
 98         return Arrays.asList(data);
 99     }
100 
101     @BeforeClass
102     public static void setup() {
103         try {
104             for (String[] setupArgs : allSetupArgs) {
105                 Process p = Runtime.getRuntime().exec(setupArgs);
106                 p.waitFor();
107             }
108         } catch (Exception e) {
109             System.out.println(e + &quot;: exec failed:&quot; + setupArgsNoTiered[0]);
110         }
111     }
112 
113     public TestLogCompilation(String logFile) {
114         this.logFile = logFile;
115     }
116 
117     @Test
118     public void testDashi() throws Exception {
119         String[] args = {&quot;-i&quot;,
120             logFile
121         };
122 
123         LogCompilation.main(args);
124     }
125 
126     @Test
127     public void testDashiDasht() throws Exception {
128         String[] args = {&quot;-i&quot;,
129             &quot;-t&quot;,
130             logFile
131         };
132 
133         LogCompilation.main(args);
134     }
135 
136     @Test
137     public void testDefault() throws Exception {
138         String[] args = {
139             logFile
140         };
141 
142         LogCompilation.main(args);
143     }
144 
145     @Test
146     public void testDashS() throws Exception {
147         String[] args = {&quot;-S&quot;,
148             logFile
149         };
150 
151         LogCompilation.main(args);
152     }
153 
154     @Test
155     public void testDashU() throws Exception {
156         String[] args = {&quot;-U&quot;,
157             logFile
158         };
159 
160         LogCompilation.main(args);
161     }
162 
163     @Test
164     public void testDashe() throws Exception {
165         String[] args = {&quot;-e&quot;,
166             logFile
167         };
168 
169         LogCompilation.main(args);
170     }
171 
172     @Test
173     public void testDashn() throws Exception {
174         String[] args = {&quot;-n&quot;,
175             logFile
176         };
177 
178         LogCompilation.main(args);
179     }
180 }
<a name="2" id="anc2"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="2" type="hidden" />
</body>
</html>