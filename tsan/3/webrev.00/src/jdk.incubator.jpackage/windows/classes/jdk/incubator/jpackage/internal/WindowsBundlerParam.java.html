<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/jdk.incubator.jpackage/windows/classes/jdk/incubator/jpackage/internal/WindowsBundlerParam.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2014, 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package jdk.incubator.jpackage.internal;
 27 
 28 import java.text.MessageFormat;
 29 import java.util.Map;
 30 import java.util.ResourceBundle;
 31 import java.util.function.BiFunction;
 32 import java.util.function.Function;
 33 
 34 class WindowsBundlerParam&lt;T&gt; extends StandardBundlerParam&lt;T&gt; {
 35 
 36     private static final ResourceBundle I18N = ResourceBundle.getBundle(
 37             &quot;jdk.incubator.jpackage.internal.resources.WinResources&quot;);
 38 
 39     WindowsBundlerParam(String id, Class&lt;T&gt; valueType,
 40             Function&lt;Map&lt;String, ? super Object&gt;, T&gt; defaultValueFunction,
 41             BiFunction&lt;String,
 42             Map&lt;String, ? super Object&gt;, T&gt; stringConverter) {
 43         super(id, valueType, defaultValueFunction, stringConverter);
 44     }
 45 
 46     static final BundlerParamInfo&lt;String&gt; INSTALLER_FILE_NAME =
 47             new StandardBundlerParam&lt;&gt; (
 48             &quot;win.installerName&quot;,
 49             String.class,
 50             params -&gt; {
 51                 String nm = APP_NAME.fetchFrom(params);
 52                 if (nm == null) return null;
 53 
 54                 String version = VERSION.fetchFrom(params);
 55                 if (version == null) {
 56                     return nm;
 57                 } else {
 58                     return nm + &quot;-&quot; + version;
 59                 }
 60             },
 61             (s, p) -&gt; s);
 62 
 63     static final StandardBundlerParam&lt;String&gt; MENU_GROUP =
 64             new StandardBundlerParam&lt;&gt;(
 65                     Arguments.CLIOptions.WIN_MENU_GROUP.getId(),
 66                     String.class,
 67                     params -&gt; I18N.getString(&quot;param.menu-group.default&quot;),
 68                     (s, p) -&gt; s
 69             );
 70 
 71     static final BundlerParamInfo&lt;Boolean&gt; INSTALLDIR_CHOOSER =
 72             new StandardBundlerParam&lt;&gt; (
 73             Arguments.CLIOptions.WIN_DIR_CHOOSER.getId(),
 74             Boolean.class,
 75             params -&gt; Boolean.FALSE,
 76             (s, p) -&gt; Boolean.valueOf(s)
 77     );
 78 
 79     static final BundlerParamInfo&lt;String&gt; WINDOWS_INSTALL_DIR =
 80             new StandardBundlerParam&lt;&gt;(
 81             &quot;windows-install-dir&quot;,
 82             String.class,
 83             params -&gt; {
 84                  String dir = INSTALL_DIR.fetchFrom(params);
 85                  if (dir != null) {
 86                      if (dir.contains(&quot;:&quot;) || dir.contains(&quot;..&quot;)) {
 87                          Log.error(MessageFormat.format(I18N.getString(
 88                                 &quot;message.invalid.install.dir&quot;), dir,
 89                                 APP_NAME.fetchFrom(params)));
 90                      } else {
 91                         if (dir.startsWith(&quot;\\&quot;)) {
 92                              dir = dir.substring(1);
 93                         }
 94                         if (dir.endsWith(&quot;\\&quot;)) {
 95                              dir = dir.substring(0, dir.length() - 1);
 96                         }
 97                         return dir;
 98                      }
 99                  }
100                  return APP_NAME.fetchFrom(params); // Default to app name
101              },
102             (s, p) -&gt; s
103     );
104 }
    </pre>
  </body>
</html>