<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/jdk.jfr/share/classes/jdk/jfr/internal/tool/EventPrintWriter.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Disassemble.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="Metadata.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.jfr/share/classes/jdk/jfr/internal/tool/EventPrintWriter.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -28,10 +28,11 @@</span>
  import java.io.FileNotFoundException;
  import java.io.IOException;
  import java.io.PrintWriter;
  import java.nio.file.Path;
  import java.util.ArrayList;
<span class="udiff-line-added">+ import java.util.Collections;</span>
  import java.util.HashMap;
  import java.util.List;
  import java.util.Map;
  import java.util.function.Predicate;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -40,20 +41,21 @@</span>
  import jdk.jfr.Timestamp;
  import jdk.jfr.ValueDescriptor;
  import jdk.jfr.consumer.RecordedEvent;
  import jdk.jfr.consumer.RecordedObject;
  import jdk.jfr.consumer.RecordingFile;
<span class="udiff-line-modified-removed">- import jdk.jfr.internal.consumer.RecordingInternals;</span>
<span class="udiff-line-modified-added">+ import jdk.jfr.internal.consumer.JdkJfrConsumer;</span>
  
  abstract class EventPrintWriter extends StructuredWriter {
  
      enum ValueType {
          TIMESPAN, TIMESTAMP, OTHER
      }
  
      protected static final String STACK_TRACE_FIELD = &quot;stackTrace&quot;;
      protected static final String EVENT_THREAD_FIELD = &quot;eventThread&quot;;
<span class="udiff-line-added">+     private static final JdkJfrConsumer PRIVATE_ACCESS = JdkJfrConsumer.instance();</span>
  
      private Predicate&lt;EventType&gt; eventFilter = x -&gt; true;
      private int stackDepth;
  
      // cach that will speed up annotation lookup
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -72,12 +74,12 @@</span>
              while (file.hasMoreEvents()) {
                  RecordedEvent event = file.readEvent();
                  if (acceptEvent(event)) {
                      events.add(event);
                  }
<span class="udiff-line-modified-removed">-                 if (RecordingInternals.INSTANCE.isLastEventInChunk(file)) {</span>
<span class="udiff-line-modified-removed">-                     RecordingInternals.INSTANCE.sort(events);</span>
<span class="udiff-line-modified-added">+                 if (PRIVATE_ACCESS.isLastEventInChunk(file)) {</span>
<span class="udiff-line-modified-added">+                     Collections.sort(events, PRIVATE_ACCESS.eventComparator());</span>
                      print(events);
                      events.clear();
                  }
              }
          }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -119,11 +121,11 @@</span>
          }
          switch (valueType) {
          case TIMESPAN:
              return object.getDuration(v.getName());
          case TIMESTAMP:
<span class="udiff-line-modified-removed">-             return RecordingInternals.INSTANCE.getOffsetDataTime(object, v.getName());</span>
<span class="udiff-line-modified-added">+             return PRIVATE_ACCESS.getOffsetDataTime(object, v.getName());</span>
          default:
              return object.getValue(v.getName());
          }
      }
      // It&#39;s expensive t check
</pre>
<center><a href="Disassemble.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="Metadata.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>