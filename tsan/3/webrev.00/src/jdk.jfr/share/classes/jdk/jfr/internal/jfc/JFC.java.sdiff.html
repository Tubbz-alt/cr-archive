<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.jfr/share/classes/jdk/jfr/internal/jfc/JFC.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../instrument/SocketOutputStreamInstrumentor.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../management/ManagementSupport.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.jfr/share/classes/jdk/jfr/internal/jfc/JFC.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
110      *
111      * @throws SecurityException if a security manager exists and its
112      *         &lt;code&gt;checkRead&lt;/code&gt; method denies read access to the file.
113      * @see java.io.File#getPath()
114      * @see java.lang.SecurityManager#checkRead(java.lang.String)
115      */
116     public static Configuration create(String name, Reader reader) throws IOException, ParseException {
117         return JFCParser.createConfiguration(name, reader);
118     }
119 
120     private static String nullSafeFileName(Path file) throws IOException {
121         Path filename = file.getFileName();
122         if (filename == null) {
123             throw new IOException(&quot;Path has no file name&quot;);
124         }
125         return filename.toString();
126     }
127 
128     public static String nameFromPath(Path file) throws IOException {
129         String f = nullSafeFileName(file);
<span class="line-modified">130         return f.substring(0, f.length() - JFCParser.FILE_EXTENSION.length());</span>




131     }
132 
133     // Invoked by DCmdStart
134     public static Configuration createKnown(String name) throws IOException, ParseException {
135         // Known name, no need for permission
136         for (KnownConfiguration known : getKnownConfigurations()) {
137             if (known.isNamed(name)) {
138                 return known.getConfigurationFile();
139             }
140         }
141         // Check JFC directory
142         SafePath path = SecuritySupport.JFC_DIRECTORY;
143         if (path != null &amp;&amp; SecuritySupport.exists(path)) {
144             for (String extension : Arrays.asList(&quot;&quot;, JFCParser.FILE_EXTENSION)) {
145                 SafePath file = new SafePath(path.toPath().resolveSibling(name + extension));
146                 if (SecuritySupport.exists(file) &amp;&amp; !SecuritySupport.isDirectory(file)) {
147                     try (Reader r = SecuritySupport.newFileReader(file)) {
148                         String jfcName = nameFromPath(file.toPath());
149                         return JFCParser.createConfiguration(jfcName, r);
150                     }
</pre>
</td>
<td>
<hr />
<pre>
110      *
111      * @throws SecurityException if a security manager exists and its
112      *         &lt;code&gt;checkRead&lt;/code&gt; method denies read access to the file.
113      * @see java.io.File#getPath()
114      * @see java.lang.SecurityManager#checkRead(java.lang.String)
115      */
116     public static Configuration create(String name, Reader reader) throws IOException, ParseException {
117         return JFCParser.createConfiguration(name, reader);
118     }
119 
120     private static String nullSafeFileName(Path file) throws IOException {
121         Path filename = file.getFileName();
122         if (filename == null) {
123             throw new IOException(&quot;Path has no file name&quot;);
124         }
125         return filename.toString();
126     }
127 
128     public static String nameFromPath(Path file) throws IOException {
129         String f = nullSafeFileName(file);
<span class="line-modified">130         if (f.endsWith(JFCParser.FILE_EXTENSION)) {</span>
<span class="line-added">131             return f.substring(0, f.length() - JFCParser.FILE_EXTENSION.length());</span>
<span class="line-added">132         } else  {</span>
<span class="line-added">133             return f;</span>
<span class="line-added">134         }</span>
135     }
136 
137     // Invoked by DCmdStart
138     public static Configuration createKnown(String name) throws IOException, ParseException {
139         // Known name, no need for permission
140         for (KnownConfiguration known : getKnownConfigurations()) {
141             if (known.isNamed(name)) {
142                 return known.getConfigurationFile();
143             }
144         }
145         // Check JFC directory
146         SafePath path = SecuritySupport.JFC_DIRECTORY;
147         if (path != null &amp;&amp; SecuritySupport.exists(path)) {
148             for (String extension : Arrays.asList(&quot;&quot;, JFCParser.FILE_EXTENSION)) {
149                 SafePath file = new SafePath(path.toPath().resolveSibling(name + extension));
150                 if (SecuritySupport.exists(file) &amp;&amp; !SecuritySupport.isDirectory(file)) {
151                     try (Reader r = SecuritySupport.newFileReader(file)) {
152                         String jfcName = nameFromPath(file.toPath());
153                         return JFCParser.createConfiguration(jfcName, r);
154                     }
</pre>
</td>
</tr>
</table>
<center><a href="../instrument/SocketOutputStreamInstrumentor.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../management/ManagementSupport.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>