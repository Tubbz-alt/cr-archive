<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/jdk.charsets/share/classes/sun/nio/cs/ext/ExtendedCharsets.java.template</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.
  3  *
  4  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  5  *
  6  * This code is free software; you can redistribute it and/or modify it
  7  * under the terms of the GNU General Public License version 2 only, as
  8  * published by the Free Software Foundation.  Oracle designates this
  9  * particular file as subject to the &quot;Classpath&quot; exception as provided
 10  * by Oracle in the LICENSE file that accompanied this code.
 11  *
 12  * This code is distributed in the hope that it will be useful, but WITHOUT
 13  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 14  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 15  * version 2 for more details (a copy is included in the LICENSE file that
 16  * accompanied this code).
 17  *
 18  * You should have received a copy of the GNU General Public License version
 19  * 2 along with this work; if not, write to the Free Software Foundation,
 20  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 21  *
 22  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 23  * or visit www.oracle.com if you need additional information or have any
 24  * questions.
 25  *
 26  */
 27 
 28 // -- This file was mechanically generated: Do not edit! -- //
 29 
 30 package sun.nio.cs.ext;
 31 
 32 import java.lang.ref.SoftReference;
 33 import java.nio.charset.Charset;
 34 import java.nio.charset.spi.CharsetProvider;
 35 import java.security.AccessController;
 36 import java.security.PrivilegedAction;
 37 
 38 /**
 39  * Provider for extended charsets.
 40  */
 41 
 42 public class ExtendedCharsets extends AbstractCharsetProvider {
 43 
 44     static volatile ExtendedCharsets instance = null;
 45 
 46     public ExtendedCharsets() {
 47 
 48         super(&quot;sun.nio.cs.ext&quot;);  // identify provider pkg name.
 49 
 50         _CHARSETS_DEF_LIST_
 51 
 52         instance = this;
 53 
 54     }
 55 
 56     private boolean initialized = false;
 57 
 58     // If the sun.nio.cs.map property is defined on the command line we won&#39;t
 59     // see it in the system-properties table until after the charset subsystem
 60     // has been initialized.  We therefore delay the effect of this property
 61     // until after the JRE has completely booted.
 62     //
 63     // At the moment following values for this property are supported, property
 64     // value string is case insensitive.
 65     //
 66     // (1)&quot;Windows-31J/Shift_JIS&quot;
 67     // In 1.4.1 we added a correct implementation of the Shift_JIS charset
 68     // but in previous releases this charset name had been treated as an alias
 69     // for Windows-31J, aka MS932. Users who have existing code that depends
 70     // upon this alias can restore the previous behavior by defining this
 71     // property to have this value.
 72     //
 73     // (2)&quot;x-windows-50221/ISO-2022-JP&quot;
 74     //    &quot;x-windows-50220/ISO-2022-JP&quot;
 75     //    &quot;x-windows-iso2022jp/ISO-2022-JP&quot;
 76     // The charset ISO-2022-JP is a &quot;standard based&quot; implementation by default,
 77     // which supports ASCII, JIS_X_0201 and JIS_X_0208 mappings based encoding
 78     // and decoding only.
 79     // There are three Microsoft iso-2022-jp variants, namely x-windows-50220,
 80     // x-windows-50221 and x-windows-iso2022jp which behaves &quot;slightly&quot; differently
 81     // compared to the &quot;standard based&quot; implementation. See ISO2022_JP.java for
 82     // detailed description. Users who prefer the behavior of MS iso-2022-jp
 83     // variants should use these names explicitly instead of using &quot;ISO-2022-JP&quot;
 84     // and its aliases. However for those who need the ISO-2022-JP charset behaves
 85     // exactly the same as MS variants do, above properties can be defined to
 86     // switch.
 87     //
 88     // If we need to define other charset-alias mappings in the future then
 89     // this property could be further extended, the general idea being that its
 90     // value should be of the form
 91     //
 92     //     new-charset-1/old-charset-1,new-charset-2/old-charset-2,...
 93     //
 94     // where each charset named to the left of a slash is intended to replace
 95     // (most) uses of the charset named to the right of the slash.
 96     //
 97     protected void init() {
 98         if (initialized)
 99             return;
100         if (!jdk.internal.misc.VM.isBooted())
101             return;
102 
103         String map = getProperty(&quot;sun.nio.cs.map&quot;);
104         boolean sjisIsMS932 = false;
105         boolean iso2022jpIsMS50221 = false;
106         boolean iso2022jpIsMS50220 = false;
107         boolean iso2022jpIsMSISO2022JP = false;
108         if (map != null) {
109             String[] maps = map.split(&quot;,&quot;);
110             for (int i = 0; i &lt; maps.length; i++) {
111                 if (maps[i].equalsIgnoreCase(&quot;Windows-31J/Shift_JIS&quot;)) {
112                     sjisIsMS932 = true;
113                 } else if (maps[i].equalsIgnoreCase(&quot;x-windows-50221/ISO-2022-JP&quot;)) {
114                     iso2022jpIsMS50221 = true;
115                 } else if (maps[i].equalsIgnoreCase(&quot;x-windows-50220/ISO-2022-JP&quot;)) {
116                     iso2022jpIsMS50220 = true;
117                 } else if (maps[i].equalsIgnoreCase(&quot;x-windows-iso2022jp/ISO-2022-JP&quot;)) {
118                     iso2022jpIsMSISO2022JP = true;
119                 }
120             }
121         }
122         if (sjisIsMS932 &amp;&amp; hasCharset(&quot;Shift_JIS&quot;)) {
123             deleteCharset(&quot;Shift_JIS&quot;,
124                           new String[] {
125                               // IANA aliases
126                               &quot;sjis&quot;, // historical
127                               &quot;shift_jis&quot;,
128                               &quot;shift-jis&quot;,
129                               &quot;ms_kanji&quot;,
130                               &quot;x-sjis&quot;,
131                               &quot;csShiftJIS&quot;
132                           });
133             deleteCharset(&quot;windows-31j&quot;,
134                           new String[] {
135                               &quot;MS932&quot;, // JDK historical
136                               &quot;windows-932&quot;,
137                               &quot;csWindows31J&quot;
138                           });
139             charset(&quot;Shift_JIS&quot;, &quot;SJIS&quot;,
140                     new String[] {
141                         // IANA aliases
142                         &quot;sjis&quot;          // JDK historical
143                     });
144             charset(&quot;windows-31j&quot;, &quot;MS932&quot;,
145                     new String[] {
146                         &quot;MS932&quot;,        // JDK historical
147                         &quot;windows-932&quot;,
148                         &quot;csWindows31J&quot;,
149                         &quot;shift-jis&quot;,
150                         &quot;ms_kanji&quot;,
151                         &quot;x-sjis&quot;,
152                         &quot;csShiftJIS&quot;,
153                         // This alias takes precedence over the actual
154                         // Shift_JIS charset itself since aliases are always
155                         // resolved first, before looking up canonical names.
156                         &quot;shift_jis&quot;
157                     });
158         }
159         if (iso2022jpIsMS50221 ||
160             iso2022jpIsMS50220 ||
161             iso2022jpIsMSISO2022JP) {
162             deleteCharset(&quot;ISO-2022-JP&quot;,
163                           new String[] {
164                               &quot;iso2022jp&quot;,
165                                 &quot;jis&quot;,
166                                 &quot;csISO2022JP&quot;,
167                                 &quot;jis_encoding&quot;,
168                                 &quot;csjisencoding&quot;
169                           });
170             if (iso2022jpIsMS50221) {
171                 deleteCharset(&quot;x-windows-50221&quot;,
172                               new String[] {
173                                   &quot;cp50221&quot;,
174                                   &quot;ms50221&quot;
175                               });
176                 charset(&quot;x-windows-50221&quot;, &quot;MS50221&quot;,
177                         new String[] {
178                             &quot;cp50221&quot;,
179                             &quot;ms50221&quot;,
180                             &quot;iso-2022-jp&quot;,
181                             &quot;iso2022jp&quot;,
182                             &quot;jis&quot;,
183                             &quot;csISO2022JP&quot;,
184                             &quot;jis_encoding&quot;,
185                             &quot;csjisencoding&quot;
186                         });
187             } else if (iso2022jpIsMS50220) {
188                 deleteCharset(&quot;x-windows-50220&quot;,
189                               new String[] {
190                                   &quot;cp50220&quot;,
191                                   &quot;ms50220&quot;
192                               });
193                 charset(&quot;x-windows-50220&quot;, &quot;MS50220&quot;,
194                         new String[] {
195                             &quot;cp50220&quot;,
196                             &quot;ms50220&quot;,
197                             &quot;iso-2022-jp&quot;,
198                             &quot;iso2022jp&quot;,
199                             &quot;jis&quot;,
200                             &quot;csISO2022JP&quot;,
201                             &quot;jis_encoding&quot;,
202                             &quot;csjisencoding&quot;
203                         });
204             } else {
205                 deleteCharset(&quot;x-windows-iso2022jp&quot;,
206                               new String[] {
207                                   &quot;windows-iso2022jp&quot;
208                               });
209                 charset(&quot;x-windows-iso2022jp&quot;, &quot;MSISO2022JP&quot;,
210                         new String[] {
211                             &quot;windows-iso2022jp&quot;,
212                             &quot;iso-2022-jp&quot;,
213                             &quot;iso2022jp&quot;,
214                             &quot;jis&quot;,
215                             &quot;csISO2022JP&quot;,
216                             &quot;jis_encoding&quot;,
217                             &quot;csjisencoding&quot;
218                         });
219 
220 
221             }
222         }
223         initialized = true;
224     }
225 
226     private static String getProperty(String key) {
227         // this method may be called during initialization of
228         // system class loader and thus not using lambda
229         return AccessController.doPrivileged(
230             new PrivilegedAction&lt;String&gt;() {
231                 @Override
232                 public String run() {
233                     return System.getProperty(key);
234                 }
235             });
236     }
237 
238     public static String[] aliasesFor(String charsetName) {
239         if (instance == null)
240             return null;
241         return instance.aliases(charsetName);
242     }
243 
244 }
    </pre>
  </body>
</html>