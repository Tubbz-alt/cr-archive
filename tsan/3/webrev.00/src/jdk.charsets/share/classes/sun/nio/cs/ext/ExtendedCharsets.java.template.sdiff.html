<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.charsets/share/classes/sun/nio/cs/ext/ExtendedCharsets.java.template</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../../jdk.attach/windows/classes/sun/tools/attach/VirtualMachineImpl.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../jdk.compiler/share/classes/com/sun/source/doctree/package-info.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.charsets/share/classes/sun/nio/cs/ext/ExtendedCharsets.java.template</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.</span>
  3  *
  4  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  5  *
  6  * This code is free software; you can redistribute it and/or modify it
  7  * under the terms of the GNU General Public License version 2 only, as
  8  * published by the Free Software Foundation.  Oracle designates this
  9  * particular file as subject to the &quot;Classpath&quot; exception as provided
 10  * by Oracle in the LICENSE file that accompanied this code.
 11  *
 12  * This code is distributed in the hope that it will be useful, but WITHOUT
 13  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 14  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 15  * version 2 for more details (a copy is included in the LICENSE file that
 16  * accompanied this code).
 17  *
 18  * You should have received a copy of the GNU General Public License version
 19  * 2 along with this work; if not, write to the Free Software Foundation,
 20  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 21  *
 22  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 23  * or visit www.oracle.com if you need additional information or have any
 24  * questions.
 25  *
 26  */
 27 
 28 // -- This file was mechanically generated: Do not edit! -- //
 29 
 30 package sun.nio.cs.ext;
 31 
<span class="line-removed"> 32 import java.lang.ref.SoftReference;</span>
 33 import java.nio.charset.Charset;
 34 import java.nio.charset.spi.CharsetProvider;
<span class="line-removed"> 35 import java.security.AccessController;</span>
<span class="line-removed"> 36 import java.security.PrivilegedAction;</span>
 37 
 38 /**
 39  * Provider for extended charsets.
 40  */
 41 
 42 public class ExtendedCharsets extends AbstractCharsetProvider {
 43 
 44     static volatile ExtendedCharsets instance = null;
 45 
 46     public ExtendedCharsets() {
 47 
 48         super(&quot;sun.nio.cs.ext&quot;);  // identify provider pkg name.
 49 
 50         _CHARSETS_DEF_LIST_
 51 
 52         instance = this;
 53 
 54     }
 55 
<span class="line-removed"> 56     private boolean initialized = false;</span>
<span class="line-removed"> 57 </span>
<span class="line-removed"> 58     // If the sun.nio.cs.map property is defined on the command line we won&#39;t</span>
<span class="line-removed"> 59     // see it in the system-properties table until after the charset subsystem</span>
<span class="line-removed"> 60     // has been initialized.  We therefore delay the effect of this property</span>
<span class="line-removed"> 61     // until after the JRE has completely booted.</span>
<span class="line-removed"> 62     //</span>
<span class="line-removed"> 63     // At the moment following values for this property are supported, property</span>
<span class="line-removed"> 64     // value string is case insensitive.</span>
<span class="line-removed"> 65     //</span>
<span class="line-removed"> 66     // (1)&quot;Windows-31J/Shift_JIS&quot;</span>
<span class="line-removed"> 67     // In 1.4.1 we added a correct implementation of the Shift_JIS charset</span>
<span class="line-removed"> 68     // but in previous releases this charset name had been treated as an alias</span>
<span class="line-removed"> 69     // for Windows-31J, aka MS932. Users who have existing code that depends</span>
<span class="line-removed"> 70     // upon this alias can restore the previous behavior by defining this</span>
<span class="line-removed"> 71     // property to have this value.</span>
<span class="line-removed"> 72     //</span>
<span class="line-removed"> 73     // (2)&quot;x-windows-50221/ISO-2022-JP&quot;</span>
<span class="line-removed"> 74     //    &quot;x-windows-50220/ISO-2022-JP&quot;</span>
<span class="line-removed"> 75     //    &quot;x-windows-iso2022jp/ISO-2022-JP&quot;</span>
<span class="line-removed"> 76     // The charset ISO-2022-JP is a &quot;standard based&quot; implementation by default,</span>
<span class="line-removed"> 77     // which supports ASCII, JIS_X_0201 and JIS_X_0208 mappings based encoding</span>
<span class="line-removed"> 78     // and decoding only.</span>
<span class="line-removed"> 79     // There are three Microsoft iso-2022-jp variants, namely x-windows-50220,</span>
<span class="line-removed"> 80     // x-windows-50221 and x-windows-iso2022jp which behaves &quot;slightly&quot; differently</span>
<span class="line-removed"> 81     // compared to the &quot;standard based&quot; implementation. See ISO2022_JP.java for</span>
<span class="line-removed"> 82     // detailed description. Users who prefer the behavior of MS iso-2022-jp</span>
<span class="line-removed"> 83     // variants should use these names explicitly instead of using &quot;ISO-2022-JP&quot;</span>
<span class="line-removed"> 84     // and its aliases. However for those who need the ISO-2022-JP charset behaves</span>
<span class="line-removed"> 85     // exactly the same as MS variants do, above properties can be defined to</span>
<span class="line-removed"> 86     // switch.</span>
<span class="line-removed"> 87     //</span>
<span class="line-removed"> 88     // If we need to define other charset-alias mappings in the future then</span>
<span class="line-removed"> 89     // this property could be further extended, the general idea being that its</span>
<span class="line-removed"> 90     // value should be of the form</span>
<span class="line-removed"> 91     //</span>
<span class="line-removed"> 92     //     new-charset-1/old-charset-1,new-charset-2/old-charset-2,...</span>
<span class="line-removed"> 93     //</span>
<span class="line-removed"> 94     // where each charset named to the left of a slash is intended to replace</span>
<span class="line-removed"> 95     // (most) uses of the charset named to the right of the slash.</span>
<span class="line-removed"> 96     //</span>
<span class="line-removed"> 97     protected void init() {</span>
<span class="line-removed"> 98         if (initialized)</span>
<span class="line-removed"> 99             return;</span>
<span class="line-removed">100         if (!jdk.internal.misc.VM.isBooted())</span>
<span class="line-removed">101             return;</span>
<span class="line-removed">102 </span>
<span class="line-removed">103         String map = getProperty(&quot;sun.nio.cs.map&quot;);</span>
<span class="line-removed">104         boolean sjisIsMS932 = false;</span>
<span class="line-removed">105         boolean iso2022jpIsMS50221 = false;</span>
<span class="line-removed">106         boolean iso2022jpIsMS50220 = false;</span>
<span class="line-removed">107         boolean iso2022jpIsMSISO2022JP = false;</span>
<span class="line-removed">108         if (map != null) {</span>
<span class="line-removed">109             String[] maps = map.split(&quot;,&quot;);</span>
<span class="line-removed">110             for (int i = 0; i &lt; maps.length; i++) {</span>
<span class="line-removed">111                 if (maps[i].equalsIgnoreCase(&quot;Windows-31J/Shift_JIS&quot;)) {</span>
<span class="line-removed">112                     sjisIsMS932 = true;</span>
<span class="line-removed">113                 } else if (maps[i].equalsIgnoreCase(&quot;x-windows-50221/ISO-2022-JP&quot;)) {</span>
<span class="line-removed">114                     iso2022jpIsMS50221 = true;</span>
<span class="line-removed">115                 } else if (maps[i].equalsIgnoreCase(&quot;x-windows-50220/ISO-2022-JP&quot;)) {</span>
<span class="line-removed">116                     iso2022jpIsMS50220 = true;</span>
<span class="line-removed">117                 } else if (maps[i].equalsIgnoreCase(&quot;x-windows-iso2022jp/ISO-2022-JP&quot;)) {</span>
<span class="line-removed">118                     iso2022jpIsMSISO2022JP = true;</span>
<span class="line-removed">119                 }</span>
<span class="line-removed">120             }</span>
<span class="line-removed">121         }</span>
<span class="line-removed">122         if (sjisIsMS932 &amp;&amp; hasCharset(&quot;Shift_JIS&quot;)) {</span>
<span class="line-removed">123             deleteCharset(&quot;Shift_JIS&quot;,</span>
<span class="line-removed">124                           new String[] {</span>
<span class="line-removed">125                               // IANA aliases</span>
<span class="line-removed">126                               &quot;sjis&quot;, // historical</span>
<span class="line-removed">127                               &quot;shift_jis&quot;,</span>
<span class="line-removed">128                               &quot;shift-jis&quot;,</span>
<span class="line-removed">129                               &quot;ms_kanji&quot;,</span>
<span class="line-removed">130                               &quot;x-sjis&quot;,</span>
<span class="line-removed">131                               &quot;csShiftJIS&quot;</span>
<span class="line-removed">132                           });</span>
<span class="line-removed">133             deleteCharset(&quot;windows-31j&quot;,</span>
<span class="line-removed">134                           new String[] {</span>
<span class="line-removed">135                               &quot;MS932&quot;, // JDK historical</span>
<span class="line-removed">136                               &quot;windows-932&quot;,</span>
<span class="line-removed">137                               &quot;csWindows31J&quot;</span>
<span class="line-removed">138                           });</span>
<span class="line-removed">139             charset(&quot;Shift_JIS&quot;, &quot;SJIS&quot;,</span>
<span class="line-removed">140                     new String[] {</span>
<span class="line-removed">141                         // IANA aliases</span>
<span class="line-removed">142                         &quot;sjis&quot;          // JDK historical</span>
<span class="line-removed">143                     });</span>
<span class="line-removed">144             charset(&quot;windows-31j&quot;, &quot;MS932&quot;,</span>
<span class="line-removed">145                     new String[] {</span>
<span class="line-removed">146                         &quot;MS932&quot;,        // JDK historical</span>
<span class="line-removed">147                         &quot;windows-932&quot;,</span>
<span class="line-removed">148                         &quot;csWindows31J&quot;,</span>
<span class="line-removed">149                         &quot;shift-jis&quot;,</span>
<span class="line-removed">150                         &quot;ms_kanji&quot;,</span>
<span class="line-removed">151                         &quot;x-sjis&quot;,</span>
<span class="line-removed">152                         &quot;csShiftJIS&quot;,</span>
<span class="line-removed">153                         // This alias takes precedence over the actual</span>
<span class="line-removed">154                         // Shift_JIS charset itself since aliases are always</span>
<span class="line-removed">155                         // resolved first, before looking up canonical names.</span>
<span class="line-removed">156                         &quot;shift_jis&quot;</span>
<span class="line-removed">157                     });</span>
<span class="line-removed">158         }</span>
<span class="line-removed">159         if (iso2022jpIsMS50221 ||</span>
<span class="line-removed">160             iso2022jpIsMS50220 ||</span>
<span class="line-removed">161             iso2022jpIsMSISO2022JP) {</span>
<span class="line-removed">162             deleteCharset(&quot;ISO-2022-JP&quot;,</span>
<span class="line-removed">163                           new String[] {</span>
<span class="line-removed">164                               &quot;iso2022jp&quot;,</span>
<span class="line-removed">165                                 &quot;jis&quot;,</span>
<span class="line-removed">166                                 &quot;csISO2022JP&quot;,</span>
<span class="line-removed">167                                 &quot;jis_encoding&quot;,</span>
<span class="line-removed">168                                 &quot;csjisencoding&quot;</span>
<span class="line-removed">169                           });</span>
<span class="line-removed">170             if (iso2022jpIsMS50221) {</span>
<span class="line-removed">171                 deleteCharset(&quot;x-windows-50221&quot;,</span>
<span class="line-removed">172                               new String[] {</span>
<span class="line-removed">173                                   &quot;cp50221&quot;,</span>
<span class="line-removed">174                                   &quot;ms50221&quot;</span>
<span class="line-removed">175                               });</span>
<span class="line-removed">176                 charset(&quot;x-windows-50221&quot;, &quot;MS50221&quot;,</span>
<span class="line-removed">177                         new String[] {</span>
<span class="line-removed">178                             &quot;cp50221&quot;,</span>
<span class="line-removed">179                             &quot;ms50221&quot;,</span>
<span class="line-removed">180                             &quot;iso-2022-jp&quot;,</span>
<span class="line-removed">181                             &quot;iso2022jp&quot;,</span>
<span class="line-removed">182                             &quot;jis&quot;,</span>
<span class="line-removed">183                             &quot;csISO2022JP&quot;,</span>
<span class="line-removed">184                             &quot;jis_encoding&quot;,</span>
<span class="line-removed">185                             &quot;csjisencoding&quot;</span>
<span class="line-removed">186                         });</span>
<span class="line-removed">187             } else if (iso2022jpIsMS50220) {</span>
<span class="line-removed">188                 deleteCharset(&quot;x-windows-50220&quot;,</span>
<span class="line-removed">189                               new String[] {</span>
<span class="line-removed">190                                   &quot;cp50220&quot;,</span>
<span class="line-removed">191                                   &quot;ms50220&quot;</span>
<span class="line-removed">192                               });</span>
<span class="line-removed">193                 charset(&quot;x-windows-50220&quot;, &quot;MS50220&quot;,</span>
<span class="line-removed">194                         new String[] {</span>
<span class="line-removed">195                             &quot;cp50220&quot;,</span>
<span class="line-removed">196                             &quot;ms50220&quot;,</span>
<span class="line-removed">197                             &quot;iso-2022-jp&quot;,</span>
<span class="line-removed">198                             &quot;iso2022jp&quot;,</span>
<span class="line-removed">199                             &quot;jis&quot;,</span>
<span class="line-removed">200                             &quot;csISO2022JP&quot;,</span>
<span class="line-removed">201                             &quot;jis_encoding&quot;,</span>
<span class="line-removed">202                             &quot;csjisencoding&quot;</span>
<span class="line-removed">203                         });</span>
<span class="line-removed">204             } else {</span>
<span class="line-removed">205                 deleteCharset(&quot;x-windows-iso2022jp&quot;,</span>
<span class="line-removed">206                               new String[] {</span>
<span class="line-removed">207                                   &quot;windows-iso2022jp&quot;</span>
<span class="line-removed">208                               });</span>
<span class="line-removed">209                 charset(&quot;x-windows-iso2022jp&quot;, &quot;MSISO2022JP&quot;,</span>
<span class="line-removed">210                         new String[] {</span>
<span class="line-removed">211                             &quot;windows-iso2022jp&quot;,</span>
<span class="line-removed">212                             &quot;iso-2022-jp&quot;,</span>
<span class="line-removed">213                             &quot;iso2022jp&quot;,</span>
<span class="line-removed">214                             &quot;jis&quot;,</span>
<span class="line-removed">215                             &quot;csISO2022JP&quot;,</span>
<span class="line-removed">216                             &quot;jis_encoding&quot;,</span>
<span class="line-removed">217                             &quot;csjisencoding&quot;</span>
<span class="line-removed">218                         });</span>
<span class="line-removed">219 </span>
<span class="line-removed">220 </span>
<span class="line-removed">221             }</span>
<span class="line-removed">222         }</span>
<span class="line-removed">223         initialized = true;</span>
<span class="line-removed">224     }</span>
<span class="line-removed">225 </span>
<span class="line-removed">226     private static String getProperty(String key) {</span>
<span class="line-removed">227         // this method may be called during initialization of</span>
<span class="line-removed">228         // system class loader and thus not using lambda</span>
<span class="line-removed">229         return AccessController.doPrivileged(</span>
<span class="line-removed">230             new PrivilegedAction&lt;String&gt;() {</span>
<span class="line-removed">231                 @Override</span>
<span class="line-removed">232                 public String run() {</span>
<span class="line-removed">233                     return System.getProperty(key);</span>
<span class="line-removed">234                 }</span>
<span class="line-removed">235             });</span>
<span class="line-removed">236     }</span>
<span class="line-removed">237 </span>
238     public static String[] aliasesFor(String charsetName) {
239         if (instance == null)
240             return null;
241         return instance.aliases(charsetName);
242     }
243 
244 }
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  *
  4  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  5  *
  6  * This code is free software; you can redistribute it and/or modify it
  7  * under the terms of the GNU General Public License version 2 only, as
  8  * published by the Free Software Foundation.  Oracle designates this
  9  * particular file as subject to the &quot;Classpath&quot; exception as provided
 10  * by Oracle in the LICENSE file that accompanied this code.
 11  *
 12  * This code is distributed in the hope that it will be useful, but WITHOUT
 13  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 14  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 15  * version 2 for more details (a copy is included in the LICENSE file that
 16  * accompanied this code).
 17  *
 18  * You should have received a copy of the GNU General Public License version
 19  * 2 along with this work; if not, write to the Free Software Foundation,
 20  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 21  *
 22  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 23  * or visit www.oracle.com if you need additional information or have any
 24  * questions.
 25  *
 26  */
 27 
 28 // -- This file was mechanically generated: Do not edit! -- //
 29 
 30 package sun.nio.cs.ext;
 31 

 32 import java.nio.charset.Charset;
 33 import java.nio.charset.spi.CharsetProvider;


 34 
 35 /**
 36  * Provider for extended charsets.
 37  */
 38 
 39 public class ExtendedCharsets extends AbstractCharsetProvider {
 40 
 41     static volatile ExtendedCharsets instance = null;
 42 
 43     public ExtendedCharsets() {
 44 
 45         super(&quot;sun.nio.cs.ext&quot;);  // identify provider pkg name.
 46 
 47         _CHARSETS_DEF_LIST_
 48 
 49         instance = this;
 50 
 51     }
 52 






















































































































































































 53     public static String[] aliasesFor(String charsetName) {
 54         if (instance == null)
 55             return null;
 56         return instance.aliases(charsetName);
 57     }
 58 
 59 }
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../../jdk.attach/windows/classes/sun/tools/attach/VirtualMachineImpl.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../jdk.compiler/share/classes/com/sun/source/doctree/package-info.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>