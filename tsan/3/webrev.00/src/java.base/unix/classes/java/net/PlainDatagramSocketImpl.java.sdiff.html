<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/unix/classes/java/net/PlainDatagramSocketImpl.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="DefaultDatagramSocketImplFactory.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="PlainSocketImpl.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/unix/classes/java/net/PlainDatagramSocketImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 package java.net;
 26 
 27 import java.io.IOException;
 28 import java.util.Set;
 29 import java.util.HashSet;
 30 import sun.net.ext.ExtendedSocketOptions;
 31 
 32 /*
 33  * On Unix systems we simply delegate to native methods.
 34  *
 35  * @author Chris Hegarty
 36  */
 37 
 38 class PlainDatagramSocketImpl extends AbstractPlainDatagramSocketImpl
 39 {
<span class="line-modified"> 40     static {</span>
<span class="line-modified"> 41         init();</span>
<span class="line-removed"> 42     }</span>
<span class="line-removed"> 43 </span>
<span class="line-removed"> 44     static final ExtendedSocketOptions extendedOptions =</span>
<span class="line-removed"> 45             ExtendedSocketOptions.getInstance();</span>
<span class="line-removed"> 46 </span>
<span class="line-removed"> 47     protected &lt;T&gt; void setOption(SocketOption&lt;T&gt; name, T value) throws IOException {</span>
<span class="line-removed"> 48         if (isClosed()) {</span>
<span class="line-removed"> 49             throw new SocketException(&quot;Socket closed&quot;);</span>
<span class="line-removed"> 50         }</span>
<span class="line-removed"> 51         if (supportedOptions().contains(name)) {</span>
<span class="line-removed"> 52             if (extendedOptions.isOptionSupported(name)) {</span>
<span class="line-removed"> 53                 extendedOptions.setOption(fd, name, value);</span>
<span class="line-removed"> 54             } else {</span>
<span class="line-removed"> 55                 super.setOption(name, value);</span>
<span class="line-removed"> 56             }</span>
<span class="line-removed"> 57         } else {</span>
<span class="line-removed"> 58             throw new UnsupportedOperationException(&quot;unsupported option&quot;);</span>
<span class="line-removed"> 59         }</span>
 60     }
 61 
<span class="line-modified"> 62     @SuppressWarnings(&quot;unchecked&quot;)</span>
<span class="line-modified"> 63     protected &lt;T&gt; T getOption(SocketOption&lt;T&gt; name) throws IOException {</span>
<span class="line-removed"> 64         if (isClosed()) {</span>
<span class="line-removed"> 65             throw new SocketException(&quot;Socket closed&quot;);</span>
<span class="line-removed"> 66         }</span>
<span class="line-removed"> 67         if (supportedOptions().contains(name)) {</span>
<span class="line-removed"> 68             if (extendedOptions.isOptionSupported(name)) {</span>
<span class="line-removed"> 69                 return (T) extendedOptions.getOption(fd, name);</span>
<span class="line-removed"> 70             } else {</span>
<span class="line-removed"> 71                 return super.getOption(name);</span>
<span class="line-removed"> 72             }</span>
<span class="line-removed"> 73         } else {</span>
<span class="line-removed"> 74             throw new UnsupportedOperationException(&quot;unsupported option&quot;);</span>
<span class="line-removed"> 75         }</span>
<span class="line-removed"> 76     }</span>
<span class="line-removed"> 77 </span>
<span class="line-removed"> 78     protected Set&lt;SocketOption&lt;?&gt;&gt; supportedOptions() {</span>
<span class="line-removed"> 79         HashSet&lt;SocketOption&lt;?&gt;&gt; options = new HashSet&lt;&gt;(super.supportedOptions());</span>
<span class="line-removed"> 80         options.addAll(ExtendedSocketOptions.datagramSocketOptions());</span>
<span class="line-removed"> 81         return options;</span>
 82     }
 83 
 84     protected void socketSetOption(int opt, Object val) throws SocketException {
 85         if (opt == SocketOptions.SO_REUSEPORT &amp;&amp;
 86             !supportedOptions().contains(StandardSocketOptions.SO_REUSEPORT)) {
 87             throw new UnsupportedOperationException(&quot;unsupported option&quot;);
 88         }
 89         try {
 90             socketSetOption0(opt, val);
 91         } catch (SocketException se) {
 92             if (!connected)
 93                 throw se;
 94         }
 95     }
 96 
 97     protected synchronized native void bind0(int lport, InetAddress laddr)
 98         throws SocketException;
 99 
<span class="line-modified">100     protected native void send(DatagramPacket p) throws IOException;</span>
101 
102     protected synchronized native int peek(InetAddress i) throws IOException;
103 
104     protected synchronized native int peekData(DatagramPacket p) throws IOException;
105 
106     protected synchronized native void receive0(DatagramPacket p)
107         throws IOException;
108 
109     protected native void setTimeToLive(int ttl) throws IOException;
110 
111     protected native int getTimeToLive() throws IOException;
112 
113     @Deprecated
114     protected native void setTTL(byte ttl) throws IOException;
115 
116     @Deprecated
117     protected native byte getTTL() throws IOException;
118 
119     protected native void join(InetAddress inetaddr, NetworkInterface netIf)
120         throws IOException;
</pre>
</td>
<td>
<hr />
<pre>
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 package java.net;
 26 
 27 import java.io.IOException;
 28 import java.util.Set;
 29 import java.util.HashSet;
 30 import sun.net.ext.ExtendedSocketOptions;
 31 
 32 /*
 33  * On Unix systems we simply delegate to native methods.
 34  *
 35  * @author Chris Hegarty
 36  */
 37 
 38 class PlainDatagramSocketImpl extends AbstractPlainDatagramSocketImpl
 39 {
<span class="line-modified"> 40     PlainDatagramSocketImpl(boolean isMulticast) {</span>
<span class="line-modified"> 41         super(isMulticast);</span>


















 42     }
 43 
<span class="line-modified"> 44     static {</span>
<span class="line-modified"> 45         init();</span>


















 46     }
 47 
 48     protected void socketSetOption(int opt, Object val) throws SocketException {
 49         if (opt == SocketOptions.SO_REUSEPORT &amp;&amp;
 50             !supportedOptions().contains(StandardSocketOptions.SO_REUSEPORT)) {
 51             throw new UnsupportedOperationException(&quot;unsupported option&quot;);
 52         }
 53         try {
 54             socketSetOption0(opt, val);
 55         } catch (SocketException se) {
 56             if (!connected)
 57                 throw se;
 58         }
 59     }
 60 
 61     protected synchronized native void bind0(int lport, InetAddress laddr)
 62         throws SocketException;
 63 
<span class="line-modified"> 64     protected native void send0(DatagramPacket p) throws IOException;</span>
 65 
 66     protected synchronized native int peek(InetAddress i) throws IOException;
 67 
 68     protected synchronized native int peekData(DatagramPacket p) throws IOException;
 69 
 70     protected synchronized native void receive0(DatagramPacket p)
 71         throws IOException;
 72 
 73     protected native void setTimeToLive(int ttl) throws IOException;
 74 
 75     protected native int getTimeToLive() throws IOException;
 76 
 77     @Deprecated
 78     protected native void setTTL(byte ttl) throws IOException;
 79 
 80     @Deprecated
 81     protected native byte getTTL() throws IOException;
 82 
 83     protected native void join(InetAddress inetaddr, NetworkInterface netIf)
 84         throws IOException;
</pre>
</td>
</tr>
</table>
<center><a href="DefaultDatagramSocketImplFactory.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="PlainSocketImpl.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>