<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/unix/native/libjava/java_props_md.c</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="io_util_md.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../libjli/java_md_common.c.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/unix/native/libjava/java_props_md.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
377     char *v; /* tmp var */
378 
379     if (sprops.user_dir) {
380         return &amp;sprops;
381     }
382 
383     /* tmp dir */
384     sprops.tmp_dir = P_tmpdir;
385 #ifdef MACOSX
386     /* darwin has a per-user temp dir */
387     static char tmp_path[PATH_MAX];
388     int pathSize = confstr(_CS_DARWIN_USER_TEMP_DIR, tmp_path, PATH_MAX);
389     if (pathSize &gt; 0 &amp;&amp; pathSize &lt;= PATH_MAX) {
390         sprops.tmp_dir = tmp_path;
391     }
392 #endif /* MACOSX */
393 
394     /* patches/service packs installed */
395     sprops.patch_level = NULL;      // leave it undefined
396 
<span class="line-removed">397     /* Java 2D/AWT properties */</span>
<span class="line-removed">398 #ifdef MACOSX</span>
<span class="line-removed">399     // Always the same GraphicsEnvironment and Toolkit on Mac OS X</span>
<span class="line-removed">400     sprops.graphics_env = &quot;sun.awt.CGraphicsEnvironment&quot;;</span>
<span class="line-removed">401     sprops.awt_toolkit = &quot;sun.lwawt.macosx.LWCToolkit&quot;;</span>
<span class="line-removed">402 </span>
<span class="line-removed">403     // check if we&#39;re in a GUI login session and set java.awt.headless=true if not</span>
<span class="line-removed">404     sprops.awt_headless = isInAquaSession() ? NULL : &quot;true&quot;;</span>
<span class="line-removed">405 #else</span>
<span class="line-removed">406     sprops.graphics_env = &quot;sun.awt.X11GraphicsEnvironment&quot;;</span>
<span class="line-removed">407     sprops.awt_toolkit = &quot;sun.awt.X11.XToolkit&quot;;</span>
<span class="line-removed">408 #endif</span>
<span class="line-removed">409 </span>
410 #ifdef SI_ISALIST
411     /* supported instruction sets */
412     {
413         char list[258];
414         sysinfo(SI_ISALIST, list, sizeof(list));
415         sprops.cpu_isalist = strdup(list);
416     }
417 #else
418     sprops.cpu_isalist = NULL;
419 #endif
420 
421     /* endianness of platform */
422     {
423         unsigned int endianTest = 0xff000000;
424         if (((char*)(&amp;endianTest))[0] != 0)
425             sprops.cpu_endian = &quot;big&quot;;
426         else
427             sprops.cpu_endian = &quot;little&quot;;
428     }
429 
</pre>
<hr />
<pre>
435         struct utsname name;
436         uname(&amp;name);
437         sprops.os_name = strdup(name.sysname);
438 #ifdef _AIX
439         {
440             char *os_version = malloc(strlen(name.version) +
441                                       strlen(name.release) + 2);
442             if (os_version != NULL) {
443                 strcpy(os_version, name.version);
444                 strcat(os_version, &quot;.&quot;);
445                 strcat(os_version, name.release);
446             }
447             sprops.os_version = os_version;
448         }
449 #else
450         sprops.os_version = strdup(name.release);
451 #endif /* _AIX   */
452 #endif /* MACOSX */
453 
454         sprops.os_arch = ARCHPROPNAME;
<span class="line-removed">455 </span>
<span class="line-removed">456         if (getenv(&quot;GNOME_DESKTOP_SESSION_ID&quot;) != NULL) {</span>
<span class="line-removed">457             sprops.desktop = &quot;gnome&quot;;</span>
<span class="line-removed">458         }</span>
<span class="line-removed">459         else {</span>
<span class="line-removed">460             sprops.desktop = NULL;</span>
<span class="line-removed">461         }</span>
462     }
463 
464     /* ABI property (optional) */
465 #ifdef JDK_ARCH_ABI_PROP_NAME
466     sprops.sun_arch_abi = JDK_ARCH_ABI_PROP_NAME;
467 #endif
468 
469     /* Determine the language, country, variant, and encoding from the host,
470      * and store these in the user.language, user.country, user.variant and
471      * file.encoding system properties. */
472     setlocale(LC_ALL, &quot;&quot;);
473     if (ParseLocale(env, LC_CTYPE,
474                     &amp;(sprops.format_language),
475                     &amp;(sprops.format_script),
476                     &amp;(sprops.format_country),
477                     &amp;(sprops.format_variant),
478                     &amp;(sprops.encoding))) {
479         ParseLocale(env, LC_MESSAGES,
480                     &amp;(sprops.display_language),
481                     &amp;(sprops.display_script),
</pre>
</td>
<td>
<hr />
<pre>
377     char *v; /* tmp var */
378 
379     if (sprops.user_dir) {
380         return &amp;sprops;
381     }
382 
383     /* tmp dir */
384     sprops.tmp_dir = P_tmpdir;
385 #ifdef MACOSX
386     /* darwin has a per-user temp dir */
387     static char tmp_path[PATH_MAX];
388     int pathSize = confstr(_CS_DARWIN_USER_TEMP_DIR, tmp_path, PATH_MAX);
389     if (pathSize &gt; 0 &amp;&amp; pathSize &lt;= PATH_MAX) {
390         sprops.tmp_dir = tmp_path;
391     }
392 #endif /* MACOSX */
393 
394     /* patches/service packs installed */
395     sprops.patch_level = NULL;      // leave it undefined
396 













397 #ifdef SI_ISALIST
398     /* supported instruction sets */
399     {
400         char list[258];
401         sysinfo(SI_ISALIST, list, sizeof(list));
402         sprops.cpu_isalist = strdup(list);
403     }
404 #else
405     sprops.cpu_isalist = NULL;
406 #endif
407 
408     /* endianness of platform */
409     {
410         unsigned int endianTest = 0xff000000;
411         if (((char*)(&amp;endianTest))[0] != 0)
412             sprops.cpu_endian = &quot;big&quot;;
413         else
414             sprops.cpu_endian = &quot;little&quot;;
415     }
416 
</pre>
<hr />
<pre>
422         struct utsname name;
423         uname(&amp;name);
424         sprops.os_name = strdup(name.sysname);
425 #ifdef _AIX
426         {
427             char *os_version = malloc(strlen(name.version) +
428                                       strlen(name.release) + 2);
429             if (os_version != NULL) {
430                 strcpy(os_version, name.version);
431                 strcat(os_version, &quot;.&quot;);
432                 strcat(os_version, name.release);
433             }
434             sprops.os_version = os_version;
435         }
436 #else
437         sprops.os_version = strdup(name.release);
438 #endif /* _AIX   */
439 #endif /* MACOSX */
440 
441         sprops.os_arch = ARCHPROPNAME;







442     }
443 
444     /* ABI property (optional) */
445 #ifdef JDK_ARCH_ABI_PROP_NAME
446     sprops.sun_arch_abi = JDK_ARCH_ABI_PROP_NAME;
447 #endif
448 
449     /* Determine the language, country, variant, and encoding from the host,
450      * and store these in the user.language, user.country, user.variant and
451      * file.encoding system properties. */
452     setlocale(LC_ALL, &quot;&quot;);
453     if (ParseLocale(env, LC_CTYPE,
454                     &amp;(sprops.format_language),
455                     &amp;(sprops.format_script),
456                     &amp;(sprops.format_country),
457                     &amp;(sprops.format_variant),
458                     &amp;(sprops.encoding))) {
459         ParseLocale(env, LC_MESSAGES,
460                     &amp;(sprops.display_language),
461                     &amp;(sprops.display_script),
</pre>
</td>
</tr>
</table>
<center><a href="io_util_md.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../libjli/java_md_common.c.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>