<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/native/libjli/splashscreen_stubs.c</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="splashscreen.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../libnet/Inet6Address.c.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/native/libjli/splashscreen_stubs.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
16  *
17  * You should have received a copy of the GNU General Public License version
18  * 2 along with this work; if not, write to the Free Software Foundation,
19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
20  *
21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
22  * or visit www.oracle.com if you need additional information or have any
23  * questions.
24  */
25 
26 #include &lt;stdio.h&gt;
27 #include &quot;splashscreen.h&quot;
28 #include &quot;jni.h&quot;
29 extern void* SplashProcAddress(const char* name); /* in java_md.c */
30 
31 /*
32  * Prototypes of pointers to functions in splashscreen shared lib
33  */
34 typedef int (*SplashLoadMemory_t)(void* pdata, int size);
35 typedef int (*SplashLoadFile_t)(const char* filename);
<span class="line-modified">36 typedef void (*SplashInit_t)(void);</span>
37 typedef void (*SplashClose_t)(void);
38 typedef void (*SplashSetFileJarName_t)(const char* fileName,
39                                        const char* jarName);
40 typedef void (*SplashSetScaleFactor_t)(float scaleFactor);
41 typedef jboolean (*SplashGetScaledImageName_t)(const char* fileName,
42                         const char* jarName, float* scaleFactor,
43                         char *scaleImageName, const size_t scaleImageNameLength);
44 typedef int (*SplashGetScaledImgNameMaxPstfixLen_t)(const char* filename);
45 
46 /*
47  * This macro invokes a function from the shared lib.
48  * it locates a function with SplashProcAddress on demand.
49  * if SplashProcAddress fails, def value is returned.
50  *
51  * it is further wrapped with INVOKEV (works with functions which return
52  * void and INVOKE (for all other functions). INVOKEV looks a bit ugly,
53  * that&#39;s due being unable to return a value of type void in C. INVOKEV
54  * works around this by using semicolon instead of return operator.
55  */
56 #define _INVOKE(name,def,ret) \
57     static void* proc = NULL; \
58     if (!proc) { proc = SplashProcAddress(#name); } \
59     if (!proc) { return def; } \
60     ret ((name##_t)proc)
61 
62 #define INVOKE(name,def) _INVOKE(name,def,return)
63 #define INVOKEV(name) _INVOKE(name, ,;)
64 
65 
66 int     DoSplashLoadMemory(void* pdata, int size) {
67     INVOKE(SplashLoadMemory, 0)(pdata, size);
68 }
69 
70 int     DoSplashLoadFile(const char* filename) {
71     INVOKE(SplashLoadFile, 0)(filename);
72 }
73 
<span class="line-modified">74 void    DoSplashInit(void) {</span>
<span class="line-modified">75     INVOKEV(SplashInit)();</span>
76 }
77 
78 void    DoSplashClose(void) {
79     INVOKEV(SplashClose)();
80 }
81 
82 void    DoSplashSetFileJarName(const char* fileName, const char* jarName) {
83     INVOKEV(SplashSetFileJarName)(fileName, jarName);
84 }
85 
86 void    DoSplashSetScaleFactor(float scaleFactor) {
87     INVOKEV(SplashSetScaleFactor)(scaleFactor);
88 }
89 
90 jboolean DoSplashGetScaledImageName(const char* fileName, const char* jarName,
91            float* scaleFactor, char *scaledImageName, const size_t scaledImageNameLength) {
92         INVOKE(SplashGetScaledImageName, 0)(fileName, jarName, scaleFactor,
93                                             scaledImageName, scaledImageNameLength);
94 }
95 
</pre>
</td>
<td>
<hr />
<pre>
16  *
17  * You should have received a copy of the GNU General Public License version
18  * 2 along with this work; if not, write to the Free Software Foundation,
19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
20  *
21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
22  * or visit www.oracle.com if you need additional information or have any
23  * questions.
24  */
25 
26 #include &lt;stdio.h&gt;
27 #include &quot;splashscreen.h&quot;
28 #include &quot;jni.h&quot;
29 extern void* SplashProcAddress(const char* name); /* in java_md.c */
30 
31 /*
32  * Prototypes of pointers to functions in splashscreen shared lib
33  */
34 typedef int (*SplashLoadMemory_t)(void* pdata, int size);
35 typedef int (*SplashLoadFile_t)(const char* filename);
<span class="line-modified">36 typedef int (*SplashInit_t)(void);</span>
37 typedef void (*SplashClose_t)(void);
38 typedef void (*SplashSetFileJarName_t)(const char* fileName,
39                                        const char* jarName);
40 typedef void (*SplashSetScaleFactor_t)(float scaleFactor);
41 typedef jboolean (*SplashGetScaledImageName_t)(const char* fileName,
42                         const char* jarName, float* scaleFactor,
43                         char *scaleImageName, const size_t scaleImageNameLength);
44 typedef int (*SplashGetScaledImgNameMaxPstfixLen_t)(const char* filename);
45 
46 /*
47  * This macro invokes a function from the shared lib.
48  * it locates a function with SplashProcAddress on demand.
49  * if SplashProcAddress fails, def value is returned.
50  *
51  * it is further wrapped with INVOKEV (works with functions which return
52  * void and INVOKE (for all other functions). INVOKEV looks a bit ugly,
53  * that&#39;s due being unable to return a value of type void in C. INVOKEV
54  * works around this by using semicolon instead of return operator.
55  */
56 #define _INVOKE(name,def,ret) \
57     static void* proc = NULL; \
58     if (!proc) { proc = SplashProcAddress(#name); } \
59     if (!proc) { return def; } \
60     ret ((name##_t)proc)
61 
62 #define INVOKE(name,def) _INVOKE(name,def,return)
63 #define INVOKEV(name) _INVOKE(name, ,;)
64 
65 
66 int     DoSplashLoadMemory(void* pdata, int size) {
67     INVOKE(SplashLoadMemory, 0)(pdata, size);
68 }
69 
70 int     DoSplashLoadFile(const char* filename) {
71     INVOKE(SplashLoadFile, 0)(filename);
72 }
73 
<span class="line-modified">74 int     DoSplashInit(void) {</span>
<span class="line-modified">75     INVOKE(SplashInit, 0)();</span>
76 }
77 
78 void    DoSplashClose(void) {
79     INVOKEV(SplashClose)();
80 }
81 
82 void    DoSplashSetFileJarName(const char* fileName, const char* jarName) {
83     INVOKEV(SplashSetFileJarName)(fileName, jarName);
84 }
85 
86 void    DoSplashSetScaleFactor(float scaleFactor) {
87     INVOKEV(SplashSetScaleFactor)(scaleFactor);
88 }
89 
90 jboolean DoSplashGetScaledImageName(const char* fileName, const char* jarName,
91            float* scaleFactor, char *scaledImageName, const size_t scaledImageNameLength) {
92         INVOKE(SplashGetScaledImageName, 0)(fileName, jarName, scaleFactor,
93                                             scaledImageName, scaledImageNameLength);
94 }
95 
</pre>
</td>
</tr>
</table>
<center><a href="splashscreen.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../libnet/Inet6Address.c.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>