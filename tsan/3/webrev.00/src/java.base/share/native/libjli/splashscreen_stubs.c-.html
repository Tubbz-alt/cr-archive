<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/java.base/share/native/libjli/splashscreen_stubs.c</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
  <body>
    <pre>
 1 /*
 2  * Copyright (c) 2005, 2015, Oracle and/or its affiliates. All rights reserved.
 3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 4  *
 5  * This code is free software; you can redistribute it and/or modify it
 6  * under the terms of the GNU General Public License version 2 only, as
 7  * published by the Free Software Foundation.  Oracle designates this
 8  * particular file as subject to the &quot;Classpath&quot; exception as provided
 9  * by Oracle in the LICENSE file that accompanied this code.
10  *
11  * This code is distributed in the hope that it will be useful, but WITHOUT
12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
14  * version 2 for more details (a copy is included in the LICENSE file that
15  * accompanied this code).
16  *
17  * You should have received a copy of the GNU General Public License version
18  * 2 along with this work; if not, write to the Free Software Foundation,
19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
20  *
21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
22  * or visit www.oracle.com if you need additional information or have any
23  * questions.
24  */
25 
26 #include &lt;stdio.h&gt;
27 #include &quot;splashscreen.h&quot;
28 #include &quot;jni.h&quot;
29 extern void* SplashProcAddress(const char* name); /* in java_md.c */
30 
31 /*
32  * Prototypes of pointers to functions in splashscreen shared lib
33  */
34 typedef int (*SplashLoadMemory_t)(void* pdata, int size);
35 typedef int (*SplashLoadFile_t)(const char* filename);
36 typedef void (*SplashInit_t)(void);
37 typedef void (*SplashClose_t)(void);
38 typedef void (*SplashSetFileJarName_t)(const char* fileName,
39                                        const char* jarName);
40 typedef void (*SplashSetScaleFactor_t)(float scaleFactor);
41 typedef jboolean (*SplashGetScaledImageName_t)(const char* fileName,
42                         const char* jarName, float* scaleFactor,
43                         char *scaleImageName, const size_t scaleImageNameLength);
44 typedef int (*SplashGetScaledImgNameMaxPstfixLen_t)(const char* filename);
45 
46 /*
47  * This macro invokes a function from the shared lib.
48  * it locates a function with SplashProcAddress on demand.
49  * if SplashProcAddress fails, def value is returned.
50  *
51  * it is further wrapped with INVOKEV (works with functions which return
52  * void and INVOKE (for all other functions). INVOKEV looks a bit ugly,
53  * that&#39;s due being unable to return a value of type void in C. INVOKEV
54  * works around this by using semicolon instead of return operator.
55  */
56 #define _INVOKE(name,def,ret) \
57     static void* proc = NULL; \
58     if (!proc) { proc = SplashProcAddress(#name); } \
59     if (!proc) { return def; } \
60     ret ((name##_t)proc)
61 
62 #define INVOKE(name,def) _INVOKE(name,def,return)
63 #define INVOKEV(name) _INVOKE(name, ,;)
64 
65 
66 int     DoSplashLoadMemory(void* pdata, int size) {
67     INVOKE(SplashLoadMemory, 0)(pdata, size);
68 }
69 
70 int     DoSplashLoadFile(const char* filename) {
71     INVOKE(SplashLoadFile, 0)(filename);
72 }
73 
74 void    DoSplashInit(void) {
75     INVOKEV(SplashInit)();
76 }
77 
78 void    DoSplashClose(void) {
79     INVOKEV(SplashClose)();
80 }
81 
82 void    DoSplashSetFileJarName(const char* fileName, const char* jarName) {
83     INVOKEV(SplashSetFileJarName)(fileName, jarName);
84 }
85 
86 void    DoSplashSetScaleFactor(float scaleFactor) {
87     INVOKEV(SplashSetScaleFactor)(scaleFactor);
88 }
89 
90 jboolean DoSplashGetScaledImageName(const char* fileName, const char* jarName,
91            float* scaleFactor, char *scaledImageName, const size_t scaledImageNameLength) {
92         INVOKE(SplashGetScaledImageName, 0)(fileName, jarName, scaleFactor,
93                                             scaledImageName, scaledImageNameLength);
94 }
95 
96 int     DoSplashGetScaledImgNameMaxPstfixLen(const char *fileName) {
97     INVOKE(SplashGetScaledImgNameMaxPstfixLen, 0)(fileName);
98 }
99 
    </pre>
  </body>
</html>