<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/native/libjava/jni_util.h</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="jni_util.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../libjli/args.c.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/native/libjava/jni_util.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 1997, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 44  * must check for exception themselves.
 45  */
 46 
 47 /* Throw a Java exception by name. Similar to SignalError. */
 48 JNIEXPORT void JNICALL
 49 JNU_ThrowByName(JNIEnv *env, const char *name, const char *msg);
 50 
 51 /* Throw common exceptions */
 52 JNIEXPORT void JNICALL
 53 JNU_ThrowNullPointerException(JNIEnv *env, const char *msg);
 54 
 55 JNIEXPORT void JNICALL
 56 JNU_ThrowArrayIndexOutOfBoundsException(JNIEnv *env, const char *msg);
 57 
 58 JNIEXPORT void JNICALL
 59 JNU_ThrowOutOfMemoryError(JNIEnv *env, const char *msg);
 60 
 61 JNIEXPORT void JNICALL
 62 JNU_ThrowIllegalArgumentException(JNIEnv *env, const char *msg);
 63 
<span class="line-removed"> 64 JNIEXPORT void JNICALL</span>
<span class="line-removed"> 65 JNU_ThrowIllegalAccessError(JNIEnv *env, const char *msg);</span>
<span class="line-removed"> 66 </span>
<span class="line-removed"> 67 JNIEXPORT void JNICALL</span>
<span class="line-removed"> 68 JNU_ThrowIllegalAccessException(JNIEnv *env, const char *msg);</span>
<span class="line-removed"> 69 </span>
 70 JNIEXPORT void JNICALL
 71 JNU_ThrowInternalError(JNIEnv *env, const char *msg);
 72 
 73 JNIEXPORT void JNICALL
 74 JNU_ThrowIOException(JNIEnv *env, const char *msg);
 75 
<span class="line-removed"> 76 JNIEXPORT void JNICALL</span>
<span class="line-removed"> 77 JNU_ThrowNoSuchFieldException(JNIEnv *env, const char *msg);</span>
<span class="line-removed"> 78 </span>
<span class="line-removed"> 79 JNIEXPORT void JNICALL</span>
<span class="line-removed"> 80 JNU_ThrowNoSuchMethodException(JNIEnv *env, const char *msg);</span>
<span class="line-removed"> 81 </span>
 82 JNIEXPORT void JNICALL
 83 JNU_ThrowClassNotFoundException(JNIEnv *env, const char *msg);
 84 
<span class="line-removed"> 85 JNIEXPORT void JNICALL</span>
<span class="line-removed"> 86 JNU_ThrowNumberFormatException(JNIEnv *env, const char *msg);</span>
<span class="line-removed"> 87 </span>
<span class="line-removed"> 88 JNIEXPORT void JNICALL</span>
<span class="line-removed"> 89 JNU_ThrowNoSuchFieldError(JNIEnv *env, const char *msg);</span>
<span class="line-removed"> 90 </span>
<span class="line-removed"> 91 JNIEXPORT void JNICALL</span>
<span class="line-removed"> 92 JNU_ThrowNoSuchMethodError(JNIEnv *env, const char *msg);</span>
<span class="line-removed"> 93 </span>
<span class="line-removed"> 94 JNIEXPORT void JNICALL</span>
<span class="line-removed"> 95 JNU_ThrowStringIndexOutOfBoundsException(JNIEnv *env, const char *msg);</span>
<span class="line-removed"> 96 </span>
<span class="line-removed"> 97 JNIEXPORT void JNICALL</span>
<span class="line-removed"> 98 JNU_ThrowInstantiationException(JNIEnv *env, const char *msg);</span>
<span class="line-removed"> 99 </span>
100 /* Throw an exception by name, using the string returned by
101  * getLastErrorString for the detail string. If the last-error
102  * string is NULL, use the given default detail string.
103  */
104 JNIEXPORT void JNICALL
105 JNU_ThrowByNameWithLastError(JNIEnv *env, const char *name,
106                              const char *defaultDetail);
107 
108 /* Throw an exception by name, using a given message and the string
109  * returned by getLastErrorString to construct the detail string.
110  */
111 JNIEXPORT void JNICALL
112 JNU_ThrowByNameWithMessageAndLastError
113   (JNIEnv *env, const char *name, const char *message);
114 
115 /* Throw an IOException, using the last-error string for the detail
116  * string. If the last-error string is NULL, use the given default
117  * detail string.
118  */
119 JNIEXPORT void JNICALL
120 JNU_ThrowIOExceptionWithLastError(JNIEnv *env, const char *defaultDetail);
121 
122 /* Convert between Java strings and i18n C strings */
<span class="line-removed">123 JNIEXPORT jstring</span>
<span class="line-removed">124 NewStringPlatform(JNIEnv *env, const char *str);</span>
<span class="line-removed">125 </span>
126 JNIEXPORT const char *
127 GetStringPlatformChars(JNIEnv *env, jstring jstr, jboolean *isCopy);
128 
129 JNIEXPORT jstring JNICALL
130 JNU_NewStringPlatform(JNIEnv *env, const char *str);
131 
132 JNIEXPORT const char * JNICALL
133 JNU_GetStringPlatformChars(JNIEnv *env, jstring jstr, jboolean *isCopy);
134 
135 JNIEXPORT void JNICALL
136 JNU_ReleaseStringPlatformChars(JNIEnv *env, jstring jstr, const char *str);
137 
138 /* Class constants */
139 JNIEXPORT jclass JNICALL
140 JNU_ClassString(JNIEnv *env);
141 
<span class="line-removed">142 JNIEXPORT jclass JNICALL</span>
<span class="line-removed">143 JNU_ClassClass(JNIEnv *env);</span>
<span class="line-removed">144 </span>
<span class="line-removed">145 JNIEXPORT jclass JNICALL</span>
<span class="line-removed">146 JNU_ClassObject(JNIEnv *env);</span>
<span class="line-removed">147 </span>
<span class="line-removed">148 JNIEXPORT jclass JNICALL</span>
<span class="line-removed">149 JNU_ClassThrowable(JNIEnv *env);</span>
<span class="line-removed">150 </span>
151 /* Copy count number of arguments from src to dst. Array bounds
152  * and ArrayStoreException are checked.
153  */
154 JNIEXPORT jint JNICALL
155 JNU_CopyObjectArray(JNIEnv *env, jobjectArray dst, jobjectArray src,
156                     jint count);
157 
158 /* Invoke a object-returning static method, based on class name,
159  * method name, and signature string.
160  *
161  * The caller should check for exceptions by setting hasException
162  * argument. If the caller is not interested in whether an exception
163  * has occurred, pass in NULL.
164  */
165 JNIEXPORT jvalue JNICALL
166 JNU_CallStaticMethodByName(JNIEnv *env,
167                            jboolean *hasException,
168                            const char *class_name,
169                            const char *name,
170                            const char *signature,
</pre>
<hr />
<pre>
191 /* Construct a new object of class, specifying the class by name,
192  * and specififying which constructor to run and what arguments to
193  * pass to it.
194  *
195  * The method will return an initialized instance if successful.
196  * It will return NULL if an error has occurred (for example if
197  * it ran out of memory) and the appropriate Java exception will
198  * have been thrown.
199  */
200 JNIEXPORT jobject JNICALL
201 JNU_NewObjectByName(JNIEnv *env, const char *class_name,
202                     const char *constructor_sig, ...);
203 
204 /* returns:
205  * 0: object is not an instance of the class named by classname.
206  * 1: object is an instance of the class named by classname.
207  * -1: the class named by classname cannot be found. An exception
208  * has been thrown.
209  */
210 JNIEXPORT jint JNICALL
<span class="line-modified">211 JNU_IsInstanceOfByName(JNIEnv *env, jobject object, char *classname);</span>
212 
213 
214 /* Get or set class and instance fields.
215  * Note that set functions take a variable number of arguments,
216  * but only one argument of the appropriate type can be passed.
217  * For example, to set an integer field i to 100:
218  *
219  * JNU_SetFieldByName(env, &amp;exc, obj, &quot;i&quot;, &quot;I&quot;, 100);
220  *
221  * To set a float field f to 12.3:
222  *
223  * JNU_SetFieldByName(env, &amp;exc, obj, &quot;f&quot;, &quot;F&quot;, 12.3);
224  *
225  * The caller should check for exceptions by setting hasException
226  * argument. If the caller is not interested in whether an exception
227  * has occurred, pass in NULL.
228  */
229 JNIEXPORT jvalue JNICALL
230 JNU_GetFieldByName(JNIEnv *env,
231                    jboolean *hasException,
232                    jobject obj,
233                    const char *name,
234                    const char *sig);
235 JNIEXPORT void JNICALL
236 JNU_SetFieldByName(JNIEnv *env,
237                    jboolean *hasException,
238                    jobject obj,
239                    const char *name,
240                    const char *sig,
241                    ...);
242 
243 JNIEXPORT jvalue JNICALL
244 JNU_GetStaticFieldByName(JNIEnv *env,
245                          jboolean *hasException,
246                          const char *classname,
247                          const char *name,
248                          const char *sig);
<span class="line-removed">249 JNIEXPORT void JNICALL</span>
<span class="line-removed">250 JNU_SetStaticFieldByName(JNIEnv *env,</span>
<span class="line-removed">251                          jboolean *hasException,</span>
<span class="line-removed">252                          const char *classname,</span>
<span class="line-removed">253                          const char *name,</span>
<span class="line-removed">254                          const char *sig,</span>
<span class="line-removed">255                          ...);</span>
<span class="line-removed">256 </span>
<span class="line-removed">257 </span>
<span class="line-removed">258 /*</span>
<span class="line-removed">259  * Calls the .equals method.</span>
<span class="line-removed">260  */</span>
<span class="line-removed">261 JNIEXPORT jboolean JNICALL</span>
<span class="line-removed">262 JNU_Equals(JNIEnv *env, jobject object1, jobject object2);</span>
<span class="line-removed">263 </span>
<span class="line-removed">264 </span>
<span class="line-removed">265 /************************************************************************</span>
<span class="line-removed">266  * Thread calls</span>
<span class="line-removed">267  *</span>
<span class="line-removed">268  * Convenience thread-related calls on the java.lang.Object class.</span>
<span class="line-removed">269  */</span>
<span class="line-removed">270 </span>
<span class="line-removed">271 JNIEXPORT void JNICALL</span>
<span class="line-removed">272 JNU_MonitorWait(JNIEnv *env, jobject object, jlong timeout);</span>
<span class="line-removed">273 </span>
<span class="line-removed">274 JNIEXPORT void JNICALL</span>
<span class="line-removed">275 JNU_Notify(JNIEnv *env, jobject object);</span>
<span class="line-removed">276 </span>
<span class="line-removed">277 JNIEXPORT void JNICALL</span>
<span class="line-removed">278 JNU_NotifyAll(JNIEnv *env, jobject object);</span>
279 
280 
281 /************************************************************************
282  * Miscellaneous utilities used by the class libraries
283  */
284 
285 #define IS_NULL(obj) ((obj) == NULL)
286 #define JNU_IsNull(env,obj) ((obj) == NULL)
287 
288 /************************************************************************
289  * Miscellaneous utilities used by the class libraries to return from
290  * a function if a value is NULL or an exception is pending.
291  */
292 
293 #define CHECK_NULL(x)                           \
294     do {                                        \
295         if ((x) == NULL) {                      \
296             return;                             \
297         }                                       \
298     } while (0)                                 \
</pre>
<hr />
<pre>
332     do {                                        \
333         if ((env)-&gt;ExceptionCheck()) {          \
334             return (y);                         \
335         }                                       \
336     } while (0)
337 #else
338 #define JNU_CHECK_EXCEPTION(env)                \
339     do {                                        \
340         if ((*env)-&gt;ExceptionCheck(env)) {      \
341             return;                             \
342         }                                       \
343     } while (0)                                 \
344 
345 #define JNU_CHECK_EXCEPTION_RETURN(env, y)      \
346     do {                                        \
347         if ((*env)-&gt;ExceptionCheck(env)) {      \
348             return (y);                         \
349         }                                       \
350     } while (0)
351 #endif /* __cplusplus */

352 /************************************************************************
353  * Debugging utilities
354  */
355 
<span class="line-removed">356 JNIEXPORT void JNICALL</span>
<span class="line-removed">357 JNU_PrintString(JNIEnv *env, char *hdr, jstring string);</span>
<span class="line-removed">358 </span>
<span class="line-removed">359 JNIEXPORT void JNICALL</span>
<span class="line-removed">360 JNU_PrintClass(JNIEnv *env, char *hdr, jobject object);</span>
<span class="line-removed">361 </span>
362 JNIEXPORT jstring JNICALL
363 JNU_ToString(JNIEnv *env, jobject object);
364 

365 /*
366  * Package shorthand for use by native libraries
367  */
368 #define JNU_JAVAPKG         &quot;java/lang/&quot;
369 #define JNU_JAVAIOPKG       &quot;java/io/&quot;
370 #define JNU_JAVANETPKG      &quot;java/net/&quot;
371 
372 /*
373  * Check if the current thread is attached to the VM, and returns
374  * the JNIEnv of the specified version if the thread is attached.
375  *
376  * If the current thread is not attached, this function returns 0.
377  *
378  * If the current thread is attached, this function returns the
379  * JNI environment, or returns (void *)JNI_ERR if the specified
380  * version is not supported.
381  */
382 JNIEXPORT void * JNICALL
383 JNU_GetEnv(JavaVM *vm, jint version);
384 
385 /*
386  * Warning free access to pointers stored in Java long fields.
387  */
388 #define JNU_GetLongFieldAsPtr(env,obj,id) \
389     (jlong_to_ptr((*(env))-&gt;GetLongField((env),(obj),(id))))
390 #define JNU_SetLongFieldFromPtr(env,obj,id,val) \
391     (*(env))-&gt;SetLongField((env),(obj),(id),ptr_to_jlong(val))
392 
393 /*
394  * Internal use only.
395  */
396 enum {
397     NO_ENCODING_YET = 0,        /* &quot;sun.jnu.encoding&quot; not yet set */
398     NO_FAST_ENCODING,           /* Platform encoding is not fast */
399     FAST_8859_1,                /* ISO-8859-1 */
400     FAST_CP1252,                /* MS-DOS Cp1252 */
401     FAST_646_US,                /* US-ASCII : ISO646-US */
402     FAST_UTF_8
403 };
404 
<span class="line-removed">405 int getFastEncoding();</span>
<span class="line-removed">406 </span>
407 JNIEXPORT void InitializeEncoding(JNIEnv *env, const char *name);
408 
409 void* getProcessHandle();
410 
411 void buildJniFunctionName(const char *sym, const char *cname,
412                           char *jniEntryName);
413 
414 JNIEXPORT size_t JNICALL
415 getLastErrorString(char *buf, size_t len);
416 
417 JNIEXPORT int JNICALL
418 getErrorString(int err, char *buf, size_t len);
419 
420 #ifdef STATIC_BUILD
421 /* Macros for handling declaration of static/dynamic
422  * JNI library Load/Unload functions
423  *
424  * Use DEF_JNI_On{Un}Load when you want a static and non-static entry points.
425  * Use DEF_STATIC_JNI_On{Un}Load when you only want a static one.
426  *
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 44  * must check for exception themselves.
 45  */
 46 
 47 /* Throw a Java exception by name. Similar to SignalError. */
 48 JNIEXPORT void JNICALL
 49 JNU_ThrowByName(JNIEnv *env, const char *name, const char *msg);
 50 
 51 /* Throw common exceptions */
 52 JNIEXPORT void JNICALL
 53 JNU_ThrowNullPointerException(JNIEnv *env, const char *msg);
 54 
 55 JNIEXPORT void JNICALL
 56 JNU_ThrowArrayIndexOutOfBoundsException(JNIEnv *env, const char *msg);
 57 
 58 JNIEXPORT void JNICALL
 59 JNU_ThrowOutOfMemoryError(JNIEnv *env, const char *msg);
 60 
 61 JNIEXPORT void JNICALL
 62 JNU_ThrowIllegalArgumentException(JNIEnv *env, const char *msg);
 63 






 64 JNIEXPORT void JNICALL
 65 JNU_ThrowInternalError(JNIEnv *env, const char *msg);
 66 
 67 JNIEXPORT void JNICALL
 68 JNU_ThrowIOException(JNIEnv *env, const char *msg);
 69 






 70 JNIEXPORT void JNICALL
 71 JNU_ThrowClassNotFoundException(JNIEnv *env, const char *msg);
 72 















 73 /* Throw an exception by name, using the string returned by
 74  * getLastErrorString for the detail string. If the last-error
 75  * string is NULL, use the given default detail string.
 76  */
 77 JNIEXPORT void JNICALL
 78 JNU_ThrowByNameWithLastError(JNIEnv *env, const char *name,
 79                              const char *defaultDetail);
 80 
 81 /* Throw an exception by name, using a given message and the string
 82  * returned by getLastErrorString to construct the detail string.
 83  */
 84 JNIEXPORT void JNICALL
 85 JNU_ThrowByNameWithMessageAndLastError
 86   (JNIEnv *env, const char *name, const char *message);
 87 
 88 /* Throw an IOException, using the last-error string for the detail
 89  * string. If the last-error string is NULL, use the given default
 90  * detail string.
 91  */
 92 JNIEXPORT void JNICALL
 93 JNU_ThrowIOExceptionWithLastError(JNIEnv *env, const char *defaultDetail);
 94 
 95 /* Convert between Java strings and i18n C strings */



 96 JNIEXPORT const char *
 97 GetStringPlatformChars(JNIEnv *env, jstring jstr, jboolean *isCopy);
 98 
 99 JNIEXPORT jstring JNICALL
100 JNU_NewStringPlatform(JNIEnv *env, const char *str);
101 
102 JNIEXPORT const char * JNICALL
103 JNU_GetStringPlatformChars(JNIEnv *env, jstring jstr, jboolean *isCopy);
104 
105 JNIEXPORT void JNICALL
106 JNU_ReleaseStringPlatformChars(JNIEnv *env, jstring jstr, const char *str);
107 
108 /* Class constants */
109 JNIEXPORT jclass JNICALL
110 JNU_ClassString(JNIEnv *env);
111 









112 /* Copy count number of arguments from src to dst. Array bounds
113  * and ArrayStoreException are checked.
114  */
115 JNIEXPORT jint JNICALL
116 JNU_CopyObjectArray(JNIEnv *env, jobjectArray dst, jobjectArray src,
117                     jint count);
118 
119 /* Invoke a object-returning static method, based on class name,
120  * method name, and signature string.
121  *
122  * The caller should check for exceptions by setting hasException
123  * argument. If the caller is not interested in whether an exception
124  * has occurred, pass in NULL.
125  */
126 JNIEXPORT jvalue JNICALL
127 JNU_CallStaticMethodByName(JNIEnv *env,
128                            jboolean *hasException,
129                            const char *class_name,
130                            const char *name,
131                            const char *signature,
</pre>
<hr />
<pre>
152 /* Construct a new object of class, specifying the class by name,
153  * and specififying which constructor to run and what arguments to
154  * pass to it.
155  *
156  * The method will return an initialized instance if successful.
157  * It will return NULL if an error has occurred (for example if
158  * it ran out of memory) and the appropriate Java exception will
159  * have been thrown.
160  */
161 JNIEXPORT jobject JNICALL
162 JNU_NewObjectByName(JNIEnv *env, const char *class_name,
163                     const char *constructor_sig, ...);
164 
165 /* returns:
166  * 0: object is not an instance of the class named by classname.
167  * 1: object is an instance of the class named by classname.
168  * -1: the class named by classname cannot be found. An exception
169  * has been thrown.
170  */
171 JNIEXPORT jint JNICALL
<span class="line-modified">172 JNU_IsInstanceOfByName(JNIEnv *env, jobject object, const char *classname);</span>
173 
174 
175 /* Get or set class and instance fields.
176  * Note that set functions take a variable number of arguments,
177  * but only one argument of the appropriate type can be passed.
178  * For example, to set an integer field i to 100:
179  *
180  * JNU_SetFieldByName(env, &amp;exc, obj, &quot;i&quot;, &quot;I&quot;, 100);
181  *
182  * To set a float field f to 12.3:
183  *
184  * JNU_SetFieldByName(env, &amp;exc, obj, &quot;f&quot;, &quot;F&quot;, 12.3);
185  *
186  * The caller should check for exceptions by setting hasException
187  * argument. If the caller is not interested in whether an exception
188  * has occurred, pass in NULL.
189  */
190 JNIEXPORT jvalue JNICALL
191 JNU_GetFieldByName(JNIEnv *env,
192                    jboolean *hasException,
193                    jobject obj,
194                    const char *name,
195                    const char *sig);
196 JNIEXPORT void JNICALL
197 JNU_SetFieldByName(JNIEnv *env,
198                    jboolean *hasException,
199                    jobject obj,
200                    const char *name,
201                    const char *sig,
202                    ...);
203 
204 JNIEXPORT jvalue JNICALL
205 JNU_GetStaticFieldByName(JNIEnv *env,
206                          jboolean *hasException,
207                          const char *classname,
208                          const char *name,
209                          const char *sig);






























210 
211 
212 /************************************************************************
213  * Miscellaneous utilities used by the class libraries
214  */
215 
216 #define IS_NULL(obj) ((obj) == NULL)
217 #define JNU_IsNull(env,obj) ((obj) == NULL)
218 
219 /************************************************************************
220  * Miscellaneous utilities used by the class libraries to return from
221  * a function if a value is NULL or an exception is pending.
222  */
223 
224 #define CHECK_NULL(x)                           \
225     do {                                        \
226         if ((x) == NULL) {                      \
227             return;                             \
228         }                                       \
229     } while (0)                                 \
</pre>
<hr />
<pre>
263     do {                                        \
264         if ((env)-&gt;ExceptionCheck()) {          \
265             return (y);                         \
266         }                                       \
267     } while (0)
268 #else
269 #define JNU_CHECK_EXCEPTION(env)                \
270     do {                                        \
271         if ((*env)-&gt;ExceptionCheck(env)) {      \
272             return;                             \
273         }                                       \
274     } while (0)                                 \
275 
276 #define JNU_CHECK_EXCEPTION_RETURN(env, y)      \
277     do {                                        \
278         if ((*env)-&gt;ExceptionCheck(env)) {      \
279             return (y);                         \
280         }                                       \
281     } while (0)
282 #endif /* __cplusplus */
<span class="line-added">283 </span>
284 /************************************************************************
285  * Debugging utilities
286  */
287 






288 JNIEXPORT jstring JNICALL
289 JNU_ToString(JNIEnv *env, jobject object);
290 
<span class="line-added">291 </span>
292 /*
293  * Package shorthand for use by native libraries
294  */
295 #define JNU_JAVAPKG         &quot;java/lang/&quot;
296 #define JNU_JAVAIOPKG       &quot;java/io/&quot;
297 #define JNU_JAVANETPKG      &quot;java/net/&quot;
298 
299 /*
300  * Check if the current thread is attached to the VM, and returns
301  * the JNIEnv of the specified version if the thread is attached.
302  *
303  * If the current thread is not attached, this function returns 0.
304  *
305  * If the current thread is attached, this function returns the
306  * JNI environment, or returns (void *)JNI_ERR if the specified
307  * version is not supported.
308  */
309 JNIEXPORT void * JNICALL
310 JNU_GetEnv(JavaVM *vm, jint version);
311 
312 /*
313  * Warning free access to pointers stored in Java long fields.
314  */
315 #define JNU_GetLongFieldAsPtr(env,obj,id) \
316     (jlong_to_ptr((*(env))-&gt;GetLongField((env),(obj),(id))))
317 #define JNU_SetLongFieldFromPtr(env,obj,id,val) \
318     (*(env))-&gt;SetLongField((env),(obj),(id),ptr_to_jlong(val))
319 
320 /*
321  * Internal use only.
322  */
323 enum {
324     NO_ENCODING_YET = 0,        /* &quot;sun.jnu.encoding&quot; not yet set */
325     NO_FAST_ENCODING,           /* Platform encoding is not fast */
326     FAST_8859_1,                /* ISO-8859-1 */
327     FAST_CP1252,                /* MS-DOS Cp1252 */
328     FAST_646_US,                /* US-ASCII : ISO646-US */
329     FAST_UTF_8
330 };
331 


332 JNIEXPORT void InitializeEncoding(JNIEnv *env, const char *name);
333 
334 void* getProcessHandle();
335 
336 void buildJniFunctionName(const char *sym, const char *cname,
337                           char *jniEntryName);
338 
339 JNIEXPORT size_t JNICALL
340 getLastErrorString(char *buf, size_t len);
341 
342 JNIEXPORT int JNICALL
343 getErrorString(int err, char *buf, size_t len);
344 
345 #ifdef STATIC_BUILD
346 /* Macros for handling declaration of static/dynamic
347  * JNI library Load/Unload functions
348  *
349  * Use DEF_JNI_On{Un}Load when you want a static and non-static entry points.
350  * Use DEF_STATIC_JNI_On{Un}Load when you only want a static one.
351  *
</pre>
</td>
</tr>
</table>
<center><a href="jni_util.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../libjli/args.c.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>