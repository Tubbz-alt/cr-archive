<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.base/share/native/libnet/net_util.c</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="Inet6Address.c.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="net_util.h.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/native/libnet/net_util.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 1998, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 1998, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -25,16 +25,23 @@</span>
  
  #include &quot;net_util.h&quot;
  
  #include &quot;java_net_InetAddress.h&quot;
  
<span class="udiff-line-added">+ int IPv4_supported();</span>
  int IPv6_supported();
  int reuseport_supported();
  
<span class="udiff-line-added">+ static int IPv4_available;</span>
  static int IPv6_available;
  static int REUSEPORT_available;
  
<span class="udiff-line-added">+ JNIEXPORT jint JNICALL ipv4_available()</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     return IPv4_available;</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
  JNIEXPORT jint JNICALL ipv6_available()
  {
      return IPv6_available;
  }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -66,10 +73,11 @@</span>
      /*
       * Since we have initialized and loaded the socket library we will
       * check now whether we have IPv6 on this platform and if the
       * supporting socket APIs are available
       */
<span class="udiff-line-added">+     IPv4_available = IPv4_supported();</span>
      IPv6_available = IPv6_supported() &amp; (!preferIPv4Stack);
  
      /* check if SO_REUSEPORT is supported on this platform */
      REUSEPORT_available = reuseport_supported();
      platformInit();
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -105,29 +113,17 @@</span>
  /**
   * set_ methods return JNI_TRUE on success JNI_FALSE on error
   * get_ methods that return +ve int return -1 on error
   * get_ methods that return objects return NULL on error.
   */
<span class="udiff-line-removed">- jobject getInet6Address_scopeifname(JNIEnv *env, jobject iaObj) {</span>
<span class="udiff-line-removed">-     jobject holder = (*env)-&gt;GetObjectField(env, iaObj, ia6_holder6ID);</span>
<span class="udiff-line-removed">-     CHECK_NULL_RETURN(holder, NULL);</span>
<span class="udiff-line-removed">-     return (*env)-&gt;GetObjectField(env, holder, ia6_scopeifnameID);</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
  jboolean setInet6Address_scopeifname(JNIEnv *env, jobject iaObj, jobject scopeifname) {
      jobject holder = (*env)-&gt;GetObjectField(env, iaObj, ia6_holder6ID);
      CHECK_NULL_RETURN(holder, JNI_FALSE);
      (*env)-&gt;SetObjectField(env, holder, ia6_scopeifnameID, scopeifname);
      return JNI_TRUE;
  }
  
<span class="udiff-line-removed">- jboolean getInet6Address_scopeid_set(JNIEnv *env, jobject iaObj) {</span>
<span class="udiff-line-removed">-     jobject holder = (*env)-&gt;GetObjectField(env, iaObj, ia6_holder6ID);</span>
<span class="udiff-line-removed">-     CHECK_NULL_RETURN(holder, JNI_FALSE);</span>
<span class="udiff-line-removed">-     return (*env)-&gt;GetBooleanField(env, holder, ia6_scopeidsetID);</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
  unsigned int getInet6Address_scopeid(JNIEnv *env, jobject iaObj) {
      jobject holder = (*env)-&gt;GetObjectField(env, iaObj, ia6_holder6ID);
      CHECK_NULL_RETURN(holder, 0);
      return (unsigned int)(*env)-&gt;GetIntField(env, holder, ia6_scopeidID);
  }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -198,16 +194,10 @@</span>
      jobject holder = (*env)-&gt;GetObjectField(env, iaObj, ia_holderID);
      CHECK_NULL_THROW_NPE_RETURN(env, holder, &quot;InetAddress holder is null&quot;, -1);
      return (*env)-&gt;GetIntField(env, holder, iac_familyID);
  }
  
<span class="udiff-line-removed">- jobject getInetAddress_hostName(JNIEnv *env, jobject iaObj) {</span>
<span class="udiff-line-removed">-     jobject holder = (*env)-&gt;GetObjectField(env, iaObj, ia_holderID);</span>
<span class="udiff-line-removed">-     CHECK_NULL_THROW_NPE_RETURN(env, holder, &quot;InetAddress holder is null&quot;, NULL);</span>
<span class="udiff-line-removed">-     return (*env)-&gt;GetObjectField(env, holder, iac_hostNameID);</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
  JNIEXPORT jobject JNICALL
  NET_SockaddrToInetAddress(JNIEnv *env, SOCKETADDRESS *sa, int *port) {
      jobject iaObj;
      if (sa-&gt;sa.sa_family == AF_INET6) {
          jbyte *caddr = (jbyte *)&amp;sa-&gt;sa6.sin6_addr;
</pre>
<center><a href="Inet6Address.c.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="net_util.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>