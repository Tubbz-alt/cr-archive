<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/java.base/share/man/keytool.1</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
  <body>
    <pre>
   1 &#39;\&quot; t
   2 .\&quot; Copyright (c) 1998, 2015, Oracle and/or its affiliates. All rights reserved.
   3 .\&quot; DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4 .\&quot;
   5 .\&quot; This code is free software; you can redistribute it and/or modify it
   6 .\&quot; under the terms of the GNU General Public License version 2 only, as
   7 .\&quot; published by the Free Software Foundation.
   8 .\&quot;
   9 .\&quot; This code is distributed in the hope that it will be useful, but WITHOUT
  10 .\&quot; ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11 .\&quot; FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  12 .\&quot; version 2 for more details (a copy is included in the LICENSE file that
  13 .\&quot; accompanied this code).
  14 .\&quot;
  15 .\&quot; You should have received a copy of the GNU General Public License version
  16 .\&quot; 2 along with this work; if not, write to the Free Software Foundation,
  17 .\&quot; Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18 .\&quot;
  19 .\&quot; Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20 .\&quot; or visit www.oracle.com if you need additional information or have any
  21 .\&quot; questions.
  22 .\&quot;
  23 .\&quot;     Arch: generic
  24 .\&quot;     Software: JDK 8
  25 .\&quot;     Date: 03 March 2015
  26 .\&quot;     SectDesc: Security Tools
  27 .\&quot;     Title: keytool.1
  28 .\&quot;
  29 .if n .pl 99999
  30 .TH keytool 1 &quot;03 March 2015&quot; &quot;JDK 8&quot; &quot;Security Tools&quot;
  31 .\&quot; -----------------------------------------------------------------
  32 .\&quot; * Define some portability stuff
  33 .\&quot; -----------------------------------------------------------------
  34 .\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  35 .\&quot; http://bugs.debian.org/507673
  36 .\&quot; http://lists.gnu.org/archive/html/groff/2009-02/msg00013.html
  37 .\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  38 .ie \n(.g .ds Aq \(aq
  39 .el       .ds Aq &#39;
  40 .\&quot; -----------------------------------------------------------------
  41 .\&quot; * set default formatting
  42 .\&quot; -----------------------------------------------------------------
  43 .\&quot; disable hyphenation
  44 .nh
  45 .\&quot; disable justification (adjust text to left margin only)
  46 .ad l
  47 .\&quot; -----------------------------------------------------------------
  48 .\&quot; * MAIN CONTENT STARTS HERE *
  49 .\&quot; -----------------------------------------------------------------
  50 
  51 .SH NAME    
  52 keytool \- Manages a keystore (database) of cryptographic keys, X\&amp;.509 certificate chains, and trusted certificates\&amp;.
  53 .SH SYNOPSIS    
  54 .sp     
  55 .nf     
  56 
  57 \fBkeytool\fR [\fIcommands\fR]
  58 .fi     
  59 .sp     
  60 .TP     
  61 \fIcommands\fR
  62 See Commands\&amp;. These commands are categorized by task as follows:
  63 .RS     
  64 .TP 0.2i    
  65 \(bu
  66 Create or Add Data to the Keystore
  67 .RS     
  68 .TP 0.2i    
  69 \(bu
  70 -gencert
  71 .TP 0.2i    
  72 \(bu
  73 -genkeypair
  74 .TP 0.2i    
  75 \(bu
  76 -genseckey
  77 .TP 0.2i    
  78 \(bu
  79 -importcert
  80 .TP 0.2i    
  81 \(bu
  82 -importpassword
  83 .RE     
  84 
  85 .TP 0.2i    
  86 \(bu
  87 Import Contents From Another Keystore
  88 .RS     
  89 .TP 0.2i    
  90 \(bu
  91 -importkeystore
  92 .RE     
  93 
  94 .TP 0.2i    
  95 \(bu
  96 Generate Certificate Request
  97 .RS     
  98 .TP 0.2i    
  99 \(bu
 100 -certreq
 101 .RE     
 102 
 103 .TP 0.2i    
 104 \(bu
 105 Export Data
 106 .RS     
 107 .TP 0.2i    
 108 \(bu
 109 -exportcert
 110 .RE     
 111 
 112 .TP 0.2i    
 113 \(bu
 114 Display Data
 115 .RS     
 116 .TP 0.2i    
 117 \(bu
 118 -list
 119 .TP 0.2i    
 120 \(bu
 121 -printcert
 122 .TP 0.2i    
 123 \(bu
 124 -printcertreq
 125 .TP 0.2i    
 126 \(bu
 127 -printcrl
 128 .RE     
 129 
 130 .TP 0.2i    
 131 \(bu
 132 Manage the Keystore
 133 .RS     
 134 .TP 0.2i    
 135 \(bu
 136 -storepasswd
 137 .TP 0.2i    
 138 \(bu
 139 -keypasswd
 140 .TP 0.2i    
 141 \(bu
 142 -delete
 143 .TP 0.2i    
 144 \(bu
 145 -changealias
 146 .RE     
 147 
 148 .TP 0.2i    
 149 \(bu
 150 Get Help
 151 .RS     
 152 .TP 0.2i    
 153 \(bu
 154 -help
 155 .RE     
 156 
 157 .RE     
 158 
 159 .SH DESCRIPTION    
 160 The \f3keytool\fR command is a key and certificate management utility\&amp;. It enables users to administer their own public/private key pairs and associated certificates for use in self-authentication (where the user authenticates himself or herself to other users and services) or data integrity and authentication services, using digital signatures\&amp;. The \f3keytool\fR command also enables users to cache the public keys (in the form of certificates) of their communicating peers\&amp;.
 161 .PP
 162 A certificate is a digitally signed statement from one entity (person, company, and so on\&amp;.), that says that the public key (and some other information) of some other entity has a particular value\&amp;. (See Certificate\&amp;.) When data is digitally signed, the signature can be verified to check the data integrity and authenticity\&amp;. Integrity means that the data has not been modified or tampered with, and authenticity means the data comes from whoever claims to have created and signed it\&amp;.
 163 .PP
 164 The \f3keytool\fR command also enables users to administer secret keys and passphrases used in symmetric encryption and decryption (DES)\&amp;.
 165 .PP
 166 The \f3keytool\fR command stores the keys and certificates in a keystore\&amp;. See KeyStore aliases\&amp;.
 167 .SH COMMAND\ AND\ OPTION\ NOTES    
 168 See Commands for a listing and description of the various commands\&amp;.
 169 .TP 0.2i    
 170 \(bu
 171 All command and option names are preceded by a minus sign (-)\&amp;.
 172 .TP 0.2i    
 173 \(bu
 174 The options for each command can be provided in any order\&amp;.
 175 .TP 0.2i    
 176 \(bu
 177 All items not italicized or in braces or brackets are required to appear as is\&amp;.
 178 .TP 0.2i    
 179 \(bu
 180 Braces surrounding an option signify that a default value will be used when the option is not specified on the command line\&amp;. See Option Defaults\&amp;. Braces are also used around the \f3-v\fR, \f3-rfc\fR, and \f3-J\fR options, which only have meaning when they appear on the command line\&amp;. They do not have any default values other than not existing\&amp;.
 181 .TP 0.2i    
 182 \(bu
 183 Brackets surrounding an option signify that the user is prompted for the values when the option is not specified on the command line\&amp;. For the \f3-keypass\fR option, if you do not specify the option on the command line, then the \f3keytool\fR command first attempts to use the keystore password to recover the private/secret key\&amp;. If this attempt fails, then the \f3keytool\fR command prompts you for the private/secret key password\&amp;.
 184 .TP 0.2i    
 185 \(bu
 186 Items in italics (option values) represent the actual values that must be supplied\&amp;. For example, here is the format of the \f3-printcert\fR command:
 187 .sp     
 188 .nf     
 189 \f3keytool \-printcert {\-file \fIcert_file\fR} {\-v}\fP
 190 .fi     
 191 .sp     
 192 
 193 
 194 
 195 
 196 When you specify a \f3-printcert\fR command, replace \fIcert_file\fR with the actual file name, as follows: \f3keytool -printcert -file VScert\&amp;.cer\fR
 197 .TP 0.2i    
 198 \(bu
 199 Option values must be put in quotation marks when they contain a blank (space)\&amp;.
 200 .TP 0.2i    
 201 \(bu
 202 The \f3-help\fR option is the default\&amp;. The \f3keytool\fR command is the same as \f3keytool -help\fR\&amp;.
 203 .SH OPTION\ DEFAULTS    
 204 The following examples show the defaults for various option values\&amp;.
 205 .sp     
 206 .nf     
 207 \f3\-alias &quot;mykey&quot;\fP
 208 .fi     
 209 .nf     
 210 \f3\fP
 211 .fi     
 212 .nf     
 213 \f3\-keyalg\fP
 214 .fi     
 215 .nf     
 216 \f3    &quot;DSA&quot; (when using \-genkeypair)\fP
 217 .fi     
 218 .nf     
 219 \f3    &quot;DES&quot; (when using \-genseckey)\fP
 220 .fi     
 221 .nf     
 222 \f3\fP
 223 .fi     
 224 .nf     
 225 \f3\-keysize\fP
 226 .fi     
 227 .nf     
 228 \f3    2048 (when using \-genkeypair and \-keyalg is &quot;RSA&quot;)\fP
 229 .fi     
 230 .nf     
 231 \f3    1024 (when using \-genkeypair and \-keyalg is &quot;DSA&quot;)\fP
 232 .fi     
 233 .nf     
 234 \f3    256 (when using \-genkeypair and \-keyalg is &quot;EC&quot;)\fP
 235 .fi     
 236 .nf     
 237 \f3    56 (when using \-genseckey and \-keyalg is &quot;DES&quot;)\fP
 238 .fi     
 239 .nf     
 240 \f3    168 (when using \-genseckey and \-keyalg is &quot;DESede&quot;)\fP
 241 .fi     
 242 .nf     
 243 \f3\fP
 244 .fi     
 245 .nf     
 246 \f3\-validity 90\fP
 247 .fi     
 248 .nf     
 249 \f3\fP
 250 .fi     
 251 .nf     
 252 \f3\-keystore &lt;the file named \&amp;.keystore in the user\&amp;&#39;s home directory&gt;\fP
 253 .fi     
 254 .nf     
 255 \f3\fP
 256 .fi     
 257 .nf     
 258 \f3\-storetype &lt;the value of the &quot;keystore\&amp;.type&quot; property in the\fP
 259 .fi     
 260 .nf     
 261 \f3    security properties file, which is returned by the static\fP
 262 .fi     
 263 .nf     
 264 \f3    getDefaultType method in java\&amp;.security\&amp;.KeyStore&gt;\fP
 265 .fi     
 266 .nf     
 267 \f3\fP
 268 .fi     
 269 .nf     
 270 \f3\-file\fP
 271 .fi     
 272 .nf     
 273 \f3    stdin (if reading)\fP
 274 .fi     
 275 .nf     
 276 \f3    stdout (if writing)\fP
 277 .fi     
 278 .nf     
 279 \f3\fP
 280 .fi     
 281 .nf     
 282 \f3\-protected false\fP
 283 .fi     
 284 .nf     
 285 \f3\fP
 286 .fi     
 287 .sp     
 288 In generating a public/private key pair, the signature algorithm (\f3-sigalg\fR option) is derived from the algorithm of the underlying private key:
 289 .TP 0.2i    
 290 \(bu
 291 If the underlying private key is of type DSA, then the \f3-sigalg\fR option defaults to SHA1withDSA\&amp;.
 292 .TP 0.2i    
 293 \(bu
 294 If the underlying private key is of type RSA, then the \f3-sigalg\fR option defaults to SHA256withRSA\&amp;.
 295 .TP 0.2i    
 296 \(bu
 297 If the underlying private key is of type EC, then the \f3-sigalg\fR option defaults to SHA256withECDSA\&amp;.
 298 .PP
 299 For a full list of \f3-keyalg\fR and \f3-sigalg\fR arguments, see Java Cryptography Architecture (JCA) Reference Guide at http://docs\&amp;.oracle\&amp;.com/javase/8/docs/technotes/guides/security/crypto/CryptoSpec\&amp;.html#AppA
 300 .SH COMMON\ OPTIONS    
 301 The \f3-v\fR option can appear for all commands except \f3-help\fR\&amp;. When the \f3-v\fR option appears, it signifies verbose mode, which means that more information is provided in the output\&amp;.
 302 .PP
 303 There is also a \f3-Jjavaoption\fR argument that can appear for any command\&amp;. When the \f3-Jjavaoption\fR appears, the specified \f3javaoption\fR string is passed directly to the Java interpreter\&amp;. This option does not contain any spaces\&amp;. It is useful for adjusting the execution environment or memory usage\&amp;. For a list of possible interpreter options, type \f3java -h\fR or \f3java -X\fR at the command line\&amp;.
 304 .PP
 305 These options can appear for all commands operating on a keystore:
 306 .TP
 307 -storetype \fIstoretype\fR
 308 .br
 309 This qualifier specifies the type of keystore to be instantiated\&amp;.
 310 .TP
 311 -keystore \fIkeystore\fR
 312 .br
 313 The keystore location\&amp;.
 314 
 315 If the JKS \f3storetype\fR is used and a keystore file does not yet exist, then certain \f3keytool\fR commands can result in a new keystore file being created\&amp;. For example, if \f3keytool -genkeypair\fR is called and the \f3-keystore\fR option is not specified, the default keystore file named \f3\&amp;.keystore\fR in the user\&amp;&#39;s home directory is created when it does not already exist\&amp;. Similarly, if the \f3-keystore ks_file\fR option is specified but ks_file does not exist, then it is created\&amp;. For more information on the JKS \f3storetype\fR, see the \fIKeyStore Implementation\fR section in KeyStore aliases\&amp;.
 316 
 317 Note that the input stream from the \f3-keystore\fR option is passed to the \f3KeyStore\&amp;.load\fR method\&amp;. If \f3NONE\fR is specified as the URL, then a null stream is passed to the \f3KeyStore\&amp;.load\fR method\&amp;. \f3NONE\fR should be specified if the keystore is not file-based\&amp;. For example, when it resides on a hardware token device\&amp;.
 318 .TP
 319 -storepass[:\fIenv\fR| :\fIfile\fR] argument
 320 .br
 321 The password that is used to protect the integrity of the keystore\&amp;.
 322 
 323 If the modifier \f3env\fR or \f3file\fR is not specified, then the password has the \f3value\fR argument, which must be at least 6 characters long\&amp;. Otherwise, the password is retrieved as follows:
 324 .RS     
 325 .TP 0.2i    
 326 \(bu
 327 \f3env\fR: Retrieve the password from the environment variable named \f3argument\fR\&amp;.
 328 .TP 0.2i    
 329 \(bu
 330 \f3file\fR: Retrieve the password from the file named argument\&amp;.
 331 .RE     
 332 
 333 
 334 \fINote:\fR All other options that require passwords, such as \f3-keypass\fR, \f3-srckeypass\fR, -\f3destkeypass\fR, \f3-srcstorepass\fR, and \f3-deststorepass\fR, accept the \fIenv\fR and \fIfile\fR modifiers\&amp;. Remember to separate the password option and the modifier with a colon (:)\&amp;.
 335 
 336 The password must be provided to all commands that access the keystore contents\&amp;. For such commands, when the \f3-storepass\fR option is not provided at the command line, the user is prompted for it\&amp;.
 337 
 338 When retrieving information from the keystore, the password is optional\&amp;. If no password is specified, then the integrity of the retrieved information cannot be verified and a warning is displayed\&amp;.
 339 .TP
 340 -providerName \fIprovider_name\fR
 341 .br
 342 Used to identify a cryptographic service provider\&amp;&#39;s name when listed in the security properties file\&amp;.
 343 .TP
 344 -providerClass \fIprovider_class_name\fR
 345 .br
 346 Used to specify the name of a cryptographic service provider\&amp;&#39;s master class file when the service provider is not listed in the security properties file\&amp;.
 347 .TP
 348 -providerArg \fIprovider_arg\fR
 349 .br
 350 Used with the \f3-providerClass\fR option to represent an optional string input argument for the constructor of \f3provider_class_name\fR\&amp;.
 351 .TP
 352 -protected
 353 .br
 354 Either \f3true\fR or \f3false\fR\&amp;. This value should be specified as \f3true\fR when a password must be specified by way of a protected authentication path such as a dedicated PIN reader\&amp;.Because there are two keystores involved in the \f3-importkeystore\fR command, the following two options \f3-srcprotected\fR and -\f3destprotected\fR are provided for the source keystore and the destination keystore respectively\&amp;.
 355 .TP
 356 -ext \fI{name{:critical} {=value}}\fR
 357 .br
 358 Denotes an X\&amp;.509 certificate extension\&amp;. The option can be used in \f3-genkeypair\fR and \f3-gencert\fR to embed extensions into the certificate generated, or in \f3-certreq\fR to show what extensions are requested in the certificate request\&amp;. The option can appear multiple times\&amp;. The \f3name\fR argument can be a supported extension name (see Named Extensions) or an arbitrary OID number\&amp;. The \f3value\fR argument, when provided, denotes the argument for the extension\&amp;. When \fIvalue\fR is omitted, that means that the default value of the extension or the extension requires no argument\&amp;. The \f3:critical\fR modifier, when provided, means the extension\&amp;&#39;s \f3isCritical\fR attribute is \f3true\fR; otherwise, it is \f3false\fR\&amp;. You can use \f3:c\fR in place of \f3:critical\fR\&amp;.
 359 .SH NAMED\ EXTENSIONS    
 360 The \f3keytool\fR command supports these named extensions\&amp;. The names are not case-sensitive)\&amp;.
 361 .TP     
 362 BC or BasicContraints
 363 \fIValues\fR: The full form is: \f3ca:{true|false}[,pathlen:&lt;len&gt;]\fR or \f3&lt;len&gt;\fR, which is short for \f3ca:true,pathlen:&lt;len&gt;\fR\&amp;. When &lt;\f3len\fR&gt; is omitted, you have \f3ca:true\fR\&amp;.
 364 .TP     
 365 KU or KeyUsage
 366 \fIValues\fR: \f3usage\fR(,\f3usage\fR)*, where \fIusage\fR can be one of \f3digitalSignature\fR, \f3nonRepudiation\fR (contentCommitment), \f3keyEncipherment\fR, \f3dataEncipherment\fR, \f3keyAgreement\fR, \f3keyCertSign\fR, \f3cRLSign\fR, \f3encipherOnly\fR, \f3decipherOnly\fR\&amp;. The \fIusage\fR argument can be abbreviated with the first few letters (\f3dig\fR for \f3digitalSignature\fR) or in camel-case style (\f3dS\fR for \f3digitalSignature\fR or \f3cRLS\fR for \f3cRLSign\fR), as long as no ambiguity is found\&amp;. The \f3usage\fR values are case-sensitive\&amp;.
 367 .TP     
 368 EKU or ExtendedKeyUsage
 369 \fIValues\fR: \f3usage\fR(,\f3usage\fR)*, where \fIusage\fR can be one of \f3anyExtendedKeyUsage\fR, \f3serverAuth\fR, \f3clientAuth\fR, \f3codeSigning\fR, \f3emailProtection\fR, \f3timeStamping\fR, \f3OCSPSigning\fR, or any \fIOID string\fR\&amp;. The \fIusage\fR argument can be abbreviated with the first few letters or in camel-case style, as long as no ambiguity is found\&amp;. The \f3usage\fR values are case-sensitive\&amp;.
 370 .TP     
 371 SAN or SubjectAlternativeName
 372 \fIValues\fR: \f3type\fR:\f3value\fR(,t\f3ype:value\fR)*, where \f3type\fR can be \f3EMAIL\fR, \f3URI\fR, \f3DNS\fR, \f3IP\fR, or \f3OID\fR\&amp;. The \f3value\fR argument is the string format value for the \f3type\fR\&amp;.
 373 .TP     
 374 IAN or IssuerAlternativeName
 375 \fIValues\fR: Same as \f3SubjectAlternativeName\fR\&amp;.
 376 .TP     
 377 SIA or SubjectInfoAccess
 378 \fIValues\fR: \f3method\fR:\f3location-type\fR:\f3location-value\fR (,\f3method:location-type\fR:\f3location-value\fR)*, where \f3method\fR can be \f3timeStamping\fR, \f3caRepository\fR or any OID\&amp;. The \f3location-type\fR and \f3location-value\fR arguments can be any \f3type\fR:\f3value\fR supported by the \f3SubjectAlternativeName\fR extension\&amp;.
 379 .TP     
 380 AIA or AuthorityInfoAccess
 381 \fIValues\fR: Same as \f3SubjectInfoAccess\fR\&amp;. The \f3method\fR argument can be \f3ocsp\fR,\f3caIssuers\fR, or any OID\&amp;.
 382 .PP
 383 When \f3name\fR is OID, the value is the hexadecimal dumped DER encoding of the \f3extnValue\fR for the extension excluding the OCTET STRING type and length bytes\&amp;. Any extra character other than standard hexadecimal numbers (0-9, a-f, A-F) are ignored in the HEX string\&amp;. Therefore, both 01:02:03:04 and 01020304 are accepted as identical values\&amp;. When there is no value, the extension has an empty value field\&amp;.
 384 .PP
 385 A special name \f3honored\fR, used in \f3-gencert\fR only, denotes how the extensions included in the certificate request should be honored\&amp;. The value for this name is a comma separated list of \f3all\fR (all requested extensions are honored), \f3name{:[critical|non-critical]}\fR (the named extension is honored, but using a different \f3isCritical\fR attribute) and \f3-name\fR (used with \f3all\fR, denotes an exception)\&amp;. Requested extensions are not honored by default\&amp;.
 386 .PP
 387 If, besides the\f3-ext honored\fR option, another named or OID \f3-ext\fR option is provided, this extension is added to those already honored\&amp;. However, if this name (or OID) also appears in the honored value, then its value and criticality overrides the one in the request\&amp;.
 388 .PP
 389 The \f3subjectKeyIdentifier\fR extension is always created\&amp;. For non-self-signed certificates, the \f3authorityKeyIdentifier\fR is created\&amp;.
 390 .PP
 391 \fINote:\fR Users should be aware that some combinations of extensions (and other certificate fields) may not conform to the Internet standard\&amp;. See Certificate Conformance Warning\&amp;.
 392 .SH COMMANDS    
 393 .TP     
 394 -gencert
 395 .sp     
 396 .nf     
 397 \f3{\-rfc} {\-infile \fIinfile\fR} {\-outfile \fIoutfile\fR} {\-alias \fIalias\fR} {\-sigalg \fIsigalg\fR}\fP
 398 .fi     
 399 .sp     
 400 .sp     
 401 .nf     
 402 \f3{\-dname \fIdname\fR} {\-startdate \fIstartdate\fR {\-ext \fIext\fR}* {\-validity \fIvalDays\fR}\fP
 403 .fi     
 404 .sp     
 405 .sp     
 406 .nf     
 407 \f3[\-keypass \fIkeypass\fR] {\-keystore \fIkeystore\fR} [\-storepass \fIstorepass\fR]\fP
 408 .fi     
 409 .sp     
 410 .sp     
 411 .nf     
 412 \f3{\-storetype \fIstoretype\fR} {\-providername \fIprovider_name\fR}\fP
 413 .fi     
 414 .sp     
 415 .sp     
 416 .nf     
 417 \f3{\-providerClass \fIprovider_class_name\fR {\-providerArg \fIprovider_arg\fR}}\fP
 418 .fi     
 419 .sp     
 420 .sp     
 421 .nf     
 422 \f3{\-v} {\-protected} {\-Jjavaoption}\fP
 423 .fi     
 424 .sp     
 425 
 426 
 427 Generates a certificate as a response to a certificate request file (which can be created by the \f3keytool\fR\f3-certreq\fR command)\&amp;. The command reads the request from \fIinfile\fR (if omitted, from the standard input), signs it using alias\&amp;&#39;s private key, and outputs the X\&amp;.509 certificate into \fIoutfile\fR (if omitted, to the standard output)\&amp;. When\f3-rfc\fR is specified, the output format is Base64-encoded PEM; otherwise, a binary DER is created\&amp;.
 428 
 429 The \f3sigalg\fR value specifies the algorithm that should be used to sign the certificate\&amp;. The \f3startdate\fR argument is the start time and date that the certificate is valid\&amp;. The \f3valDays\fR argument tells the number of days for which the certificate should be considered valid\&amp;.
 430 
 431 When \f3dname\fR is provided, it is used as the subject of the generated certificate\&amp;. Otherwise, the one from the certificate request is used\&amp;.
 432 
 433 The \f3ext\fR value shows what X\&amp;.509 extensions will be embedded in the certificate\&amp;. Read Common Options for the grammar of \f3-ext\fR\&amp;.
 434 
 435 The \f3-gencert\fR option enables you to create certificate chains\&amp;. The following example creates a certificate, \f3e1\fR, that contains three certificates in its certificate chain\&amp;.
 436 
 437 The following commands creates four key pairs named \f3ca\fR, \f3ca1\fR, \f3ca2\fR, and \f3e1\fR:
 438 .sp     
 439 .nf     
 440 \f3keytool \-alias ca \-dname CN=CA \-genkeypair\fP
 441 .fi     
 442 .nf     
 443 \f3keytool \-alias ca1 \-dname CN=CA \-genkeypair\fP
 444 .fi     
 445 .nf     
 446 \f3keytool \-alias ca2 \-dname CN=CA \-genkeypair\fP
 447 .fi     
 448 .nf     
 449 \f3keytool \-alias e1 \-dname CN=E1 \-genkeypair\fP
 450 .fi     
 451 .nf     
 452 \f3\fP
 453 .fi     
 454 .sp     
 455 
 456 
 457 The following two commands create a chain of signed certificates; \f3ca\fR signs \f3ca1\fR and \f3ca1\fR signs \f3ca2\fR, all of which are self-issued:
 458 .sp     
 459 .nf     
 460 \f3keytool \-alias ca1 \-certreq |\fP
 461 .fi     
 462 .nf     
 463 \f3    keytool \-alias ca \-gencert \-ext san=dns:ca1 |\fP
 464 .fi     
 465 .nf     
 466 \f3    keytool \-alias ca1 \-importcert\fP
 467 .fi     
 468 .nf     
 469 \f3\fP
 470 .fi     
 471 .nf     
 472 \f3keytool \-alias ca2 \-certreq |\fP
 473 .fi     
 474 .nf     
 475 \f3    $KT \-alias ca1 \-gencert \-ext san=dns:ca2 |\fP
 476 .fi     
 477 .nf     
 478 \f3    $KT \-alias ca2 \-importcert\fP
 479 .fi     
 480 .nf     
 481 \f3\fP
 482 .fi     
 483 .sp     
 484 
 485 
 486 The following command creates the certificate \f3e1\fR and stores it in the file \f3e1\&amp;.cert\fR, which is signed by \f3ca2\fR\&amp;. As a result, \f3e1\fR should contain \f3ca\fR, \f3ca1\fR, and \f3ca2\fR in its certificate chain:
 487 .sp     
 488 .nf     
 489 \f3keytool \-alias e1 \-certreq | keytool \-alias ca2 \-gencert &gt; e1\&amp;.cert\fP
 490 .fi     
 491 .nf     
 492 \f3\fP
 493 .fi     
 494 .sp     
 495 
 496 .TP     
 497 -genkeypair
 498 .sp     
 499 .nf     
 500 \f3{\-alias \fIalias\fR} {\-keyalg \fIkeyalg\fR} {\-keysize \fIkeysize\fR} {\-sigalg \fIsigalg\fR}\fP
 501 .fi     
 502 .sp     
 503 .sp     
 504 .nf     
 505 \f3[\-dname \fIdname\fR] [\-keypass \fIkeypass\fR] {\-startdate \fIvalue\fR} {\-ext \fIext\fR}*\fP
 506 .fi     
 507 .sp     
 508 .sp     
 509 .nf     
 510 \f3{\-validity \fIvalDays\fR} {\-storetype \fIstoretype\fR} {\-keystore \fIkeystore\fR}\fP
 511 .fi     
 512 .sp     
 513 .sp     
 514 .nf     
 515 \f3[\-storepass \fIstorepass\fR]\fP
 516 .fi     
 517 .sp     
 518 .sp     
 519 .nf     
 520 \f3{\-providerClass \fIprovider_class_name\fR {\-providerArg \fIprovider_arg\fR}}\fP
 521 .fi     
 522 .sp     
 523 .sp     
 524 .nf     
 525 \f3{\-v} {\-protected} {\-Jjavaoption}\fP
 526 .fi     
 527 .sp     
 528 
 529 
 530 Generates a key pair (a public key and associated private key)\&amp;. Wraps the public key into an X\&amp;.509 v3 self-signed certificate, which is stored as a single-element certificate chain\&amp;. This certificate chain and the private key are stored in a new keystore entry identified by alias\&amp;.
 531 
 532 The \f3keyalg\fR value specifies the algorithm to be used to generate the key pair, and the \f3keysize\fR value specifies the size of each key to be generated\&amp;. The \f3sigalg\fR value specifies the algorithm that should be used to sign the self-signed certificate\&amp;. This algorithm must be compatible with the \f3keyalg\fR value\&amp;.
 533 
 534 The \f3dname\fR value specifies the X\&amp;.500 Distinguished Name to be associated with the value of \f3alias\fR, and is used as the issuer and subject fields in the self-signed certificate\&amp;. If no distinguished name is provided at the command line, then the user is prompted for one\&amp;.
 535 
 536 The value of \f3keypass\fR is a password used to protect the private key of the generated key pair\&amp;. If no password is provided, then the user is prompted for it\&amp;. If you press \fIthe Return key\fR at the prompt, then the key password is set to the same password as the keystore password\&amp;. The \f3keypass\fR value must be at least 6 characters\&amp;.
 537 
 538 The value of \f3startdate\fR specifies the issue time of the certificate, also known as the &quot;Not Before&quot; value of the X\&amp;.509 certificate\&amp;&#39;s Validity field\&amp;.
 539 
 540 The option value can be set in one of these two forms:
 541 
 542 \f3([+-]nnn[ymdHMS])+\fR
 543 
 544 \f3[yyyy/mm/dd] [HH:MM:SS]\fR
 545 
 546 With the first form, the issue time is shifted by the specified value from the current time\&amp;. The value is a concatenation of a sequence of subvalues\&amp;. Inside each subvalue, the plus sign (+) means shift forward, and the minus sign (-) means shift backward\&amp;. The time to be shifted is \f3nnn\fR units of years, months, days, hours, minutes, or seconds (denoted by a single character of \f3y\fR, \f3m\fR, \f3d\fR, \f3H\fR, \f3M\fR, or \f3S\fR respectively)\&amp;. The exact value of the issue time is calculated using the \f3java\&amp;.util\&amp;.GregorianCalendar\&amp;.add(int field, int amount)\fR method on each subvalue, from left to right\&amp;. For example, by specifying, the issue time will be:
 547 .sp     
 548 .nf     
 549 \f3Calendar c = new GregorianCalendar();\fP
 550 .fi     
 551 .nf     
 552 \f3c\&amp;.add(Calendar\&amp;.YEAR, \-1);\fP
 553 .fi     
 554 .nf     
 555 \f3c\&amp;.add(Calendar\&amp;.MONTH, 1);\fP
 556 .fi     
 557 .nf     
 558 \f3c\&amp;.add(Calendar\&amp;.DATE, \-1);\fP
 559 .fi     
 560 .nf     
 561 \f3return c\&amp;.getTime()\fP
 562 .fi     
 563 .nf     
 564 \f3\fP
 565 .fi     
 566 .sp     
 567 
 568 
 569 With the second form, the user sets the exact issue time in two parts, year/month/day and hour:minute:second (using the local time zone)\&amp;. The user can provide only one part, which means the other part is the same as the current date (or time)\&amp;. The user must provide the exact number of digits as shown in the format definition (padding with 0 when shorter)\&amp;. When both the date and time are provided, there is one (and only one) space character between the two parts\&amp;. The hour should always be provided in 24 hour format\&amp;.
 570 
 571 When the option is not provided, the start date is the current time\&amp;. The option can be provided at most once\&amp;.
 572 
 573 The value of \f3valDays\fR specifies the number of days (starting at the date specified by \f3-startdate\fR, or the current date when \f3-startdate\fR is not specified) for which the certificate should be considered valid\&amp;.
 574 
 575 This command was named \f3-genkey\fR in earlier releases\&amp;. The old name is still supported in this release\&amp;. The new name, \f3-genkeypair\fR, is preferred going forward\&amp;.
 576 .TP     
 577 -genseckey
 578 .sp     
 579 .nf     
 580 \f3{\-alias \fIalias\fR} {\-keyalg \fIkeyalg\fR} {\-keysize \fIkeysize\fR} [\-keypass \fIkeypass\fR]\fP
 581 .fi     
 582 .sp     
 583 .sp     
 584 .nf     
 585 \f3{\-storetype \fIstoretype\fR} {\-keystore \fIkeystore\fR} [\-storepass \fIstorepass\fR]\fP
 586 .fi     
 587 .sp     
 588 .sp     
 589 .nf     
 590 \f3{\-providerClass \fIprovider_class_name\fR {\-providerArg \fIprovider_arg\fR}} {\-v}\fP
 591 .fi     
 592 .sp     
 593 .sp     
 594 .nf     
 595 \f3{\-protected} {\-Jjavaoption}\fP
 596 .fi     
 597 .sp     
 598 
 599 
 600 Generates a secret key and stores it in a new \f3KeyStore\&amp;.SecretKeyEntry\fR identified by \f3alias\fR\&amp;.
 601 
 602 The value of \f3keyalg\fR specifies the algorithm to be used to generate the secret key, and the value of \f3keysize\fR specifies the size of the key to be generated\&amp;. The \f3keypass\fR value is a password that protects the secret key\&amp;. If no password is provided, then the user is prompted for it\&amp;. If you press the Return key at the prompt, then the key password is set to the same password that is used for the \f3keystore\fR\&amp;. The \f3keypass\fR value must be at least 6 characters\&amp;.
 603 .TP     
 604 -importcert
 605 .sp     
 606 .nf     
 607 \f3{\-alias \fIalias\fR} {\-file \fIcert_file\fR} [\-keypass \fIkeypass\fR] {\-noprompt} {\-trustcacerts}\fP
 608 .fi     
 609 .sp     
 610 .sp     
 611 .nf     
 612 \f3{\-storetype \fIstoretype\fR} {\-keystore \fIkeystore\fR} [\-storepass \fIstorepass\fR]\fP
 613 .fi     
 614 .sp     
 615 .sp     
 616 .nf     
 617 \f3{\-providerName \fIprovider_name\fR}\fP
 618 .fi     
 619 .sp     
 620 .sp     
 621 .nf     
 622 \f3{\-providerClass \fIprovider_class_name\fR {\-providerArg \fIprovider_arg\fR}}\fP
 623 .fi     
 624 .sp     
 625 .sp     
 626 .nf     
 627 \f3{\-v} {\-protected} {\-Jjavaoption}\fP
 628 .fi     
 629 .sp     
 630 
 631 
 632 Reads the certificate or certificate chain (where the latter is supplied in a PKCS#7 formatted reply or a sequence of X\&amp;.509 certificates) from the file \f3cert_file\fR, and stores it in the \f3keystore\fR entry identified by \f3alias\fR\&amp;. If no file is specified, then the certificate or certificate chain is read from \f3stdin\fR\&amp;.
 633 
 634 The \f3keytool\fR command can import X\&amp;.509 v1, v2, and v3 certificates, and PKCS#7 formatted certificate chains consisting of certificates of that type\&amp;. The data to be imported must be provided either in binary encoding format or in printable encoding format (also known as Base64 encoding) as defined by the Internet RFC 1421 standard\&amp;. In the latter case, the encoding must be bounded at the beginning by a string that starts with \f3-\fR\f3----BEGIN\fR, and bounded at the end by a string that starts with \f3-----END\fR\&amp;.
 635 
 636 You import a certificate for two reasons: To add it to the list of trusted certificates, and to import a certificate reply received from a certificate authority (CA) as the result of submitting a Certificate Signing Request to that CA (see the \f3-certreq\fR option in Commands)\&amp;.
 637 
 638 Which type of import is intended is indicated by the value of the \f3-alias\fR option\&amp;. If the alias does not point to a key entry, then the \f3keytool\fR command assumes you are adding a trusted certificate entry\&amp;. In this case, the alias should not already exist in the keystore\&amp;. If the alias does already exist, then the \f3keytool\fR command outputs an error because there is already a trusted certificate for that alias, and does not import the certificate\&amp;. If the alias points to a key entry, then the \f3keytool\fR command assumes you are importing a certificate reply\&amp;.
 639 .TP     
 640 -importpassword
 641 .sp     
 642 .nf     
 643 \f3{\-alias \fIalias\fR} [\-keypass \fIkeypass\fR] {\-storetype \fIstoretype\fR} {\-keystore \fIkeystore\fR}\fP
 644 .fi     
 645 .sp     
 646 .sp     
 647 .nf     
 648 \f3[\-storepass \fIstorepass\fR]\fP
 649 .fi     
 650 .sp     
 651 .sp     
 652 .nf     
 653 \f3{\-providerClass \fIprovider_class_name\fR {\-providerArg \fIprovider_arg\fR}}\fP
 654 .fi     
 655 .sp     
 656 .sp     
 657 .nf     
 658 \f3{\-v} {\-protected} {\-Jjavaoption}\fP
 659 .fi     
 660 .sp     
 661 
 662 
 663 Imports a passphrase and stores it in a new \f3KeyStore\&amp;.SecretKeyEntry\fR identified by \f3alias\fR\&amp;. The passphrase may be supplied via the standard input stream; otherwise the user is prompted for it\&amp;. \f3keypass\fR is a password used to protect the imported passphrase\&amp;. If no password is provided, the user is prompted for it\&amp;. If you press the Return key at the prompt, the key password is set to the same password as that used for the \f3keystore\fR\&amp;. \f3keypass\fR must be at least 6 characters long\&amp;.
 664 .TP     
 665 -importkeystore
 666 .sp     
 667 .nf     
 668 \f3{\-srcstoretype \fIsrcstoretype\fR} {\-deststoretype \fIdeststoretype\fR}\fP
 669 .fi     
 670 .sp     
 671 .sp     
 672 .nf     
 673 \f3[\-srcstorepass \fIsrcstorepass\fR] [\-deststorepass \fIdeststorepass\fR] {\-srcprotected}\fP
 674 .fi     
 675 .sp     
 676 .sp     
 677 .nf     
 678 \f3{\-destprotected} \fP
 679 .fi     
 680 .sp     
 681 .sp     
 682 .nf     
 683 \f3{\-srcalias \fIsrcalias\fR {\-destalias \fIdestalias\fR} [\-srckeypass \fIsrckeypass\fR]} \fP
 684 .fi     
 685 .sp     
 686 .sp     
 687 .nf     
 688 \f3[\-destkeypass \fIdestkeypass\fR] {\-noprompt}\fP
 689 .fi     
 690 .sp     
 691 .sp     
 692 .nf     
 693 \f3{\-srcProviderName \fIsrc_provider_name\fR} {\-destProviderName \fIdest_provider_name\fR}\fP
 694 .fi     
 695 .sp     
 696 .sp     
 697 .nf     
 698 \f3{\-providerClass \fIprovider_class_name\fR {\-providerArg \fIprovider_arg\fR}} {\-v}\fP
 699 .fi     
 700 .sp     
 701 .sp     
 702 .nf     
 703 \f3{\-protected} {\-Jjavaoption}\fP
 704 .fi     
 705 .sp     
 706 
 707 
 708 Imports a single entry or all entries from a source keystore to a destination keystore\&amp;.
 709 
 710 When the \f3-srcalias\fR option is provided, the command imports the single entry identified by the alias to the destination keystore\&amp;. If a destination alias is not provided with \f3destalias\fR, then \f3srcalias\fR is used as the destination alias\&amp;. If the source entry is protected by a password, then \f3srckeypass\fR is used to recover the entry\&amp;. If \fIsrckeypass\fR is not provided, then the \f3keytool\fR command attempts to use \f3srcstorepass\fR to recover the entry\&amp;. If \f3srcstorepass\fR is either not provided or is incorrect, then the user is prompted for a password\&amp;. The destination entry is protected with \f3destkeypass\fR\&amp;. If \f3destkeypass\fR is not provided, then the destination entry is protected with the source entry password\&amp;. For example, most third-party tools require \f3storepass\fR and \f3keypass\fR in a PKCS #12 keystore to be the same\&amp;. In order to create a PKCS #12 keystore for these tools, always specify a \f3-destkeypass\fR to be the same as \f3-deststorepass\fR\&amp;.
 711 
 712 If the \f3-srcalias\fR option is not provided, then all entries in the source keystore are imported into the destination keystore\&amp;. Each destination entry is stored under the alias from the source entry\&amp;. If the source entry is protected by a password, then \f3srcstorepass\fR is used to recover the entry\&amp;. If \f3srcstorepass\fR is either not provided or is incorrect, then the user is prompted for a password\&amp;. If a source keystore entry type is not supported in the destination keystore, or if an error occurs while storing an entry into the destination keystore, then the user is prompted whether to skip the entry and continue or to quit\&amp;. The destination entry is protected with the source entry password\&amp;.
 713 
 714 If the destination alias already exists in the destination keystore, then the user is prompted to either overwrite the entry or to create a new entry under a different alias name\&amp;.
 715 
 716 If the \f3-noprompt\fR option is provided, then the user is not prompted for a new destination alias\&amp;. Existing entries are overwritten with the destination alias name\&amp;. Entries that cannot be imported are skipped and a warning is displayed\&amp;.
 717 .TP     
 718 -printcertreq
 719 .sp     
 720 .nf     
 721 \f3{\-file \fIfile\fR}\fP
 722 .fi     
 723 .sp     
 724 
 725 
 726 Prints the content of a PKCS #10 format certificate request, which can be generated by the \f3keytool\fR\f3-certreq\fR command\&amp;. The command reads the request from file\&amp;. If there is no file, then the request is read from the standard input\&amp;.
 727 .TP     
 728 -certreq
 729 .sp     
 730 .nf     
 731 \f3{\-alias \fIalias\fR} {\-dname \fIdname\fR} {\-sigalg \fIsigalg\fR} {\-file \fIcertreq_file\fR}\fP
 732 .fi     
 733 .sp     
 734 .sp     
 735 .nf     
 736 \f3[\-keypass \fIkeypass\fR] {\-storetype \fIstoretype\fR} {\-keystore \fIkeystore\fR}\fP
 737 .fi     
 738 .sp     
 739 .sp     
 740 .nf     
 741 \f3[\-storepass \fIstorepass\fR] {\-providerName \fIprovider_name\fR}\fP
 742 .fi     
 743 .sp     
 744 .sp     
 745 .nf     
 746 \f3{\-providerClass \fIprovider_class_name\fR {\-providerArg \fIprovider_arg\fR}}\fP
 747 .fi     
 748 .sp     
 749 .sp     
 750 .nf     
 751 \f3{\-v} {\-protected} {\-Jjavaoption}\fP
 752 .fi     
 753 .sp     
 754 
 755 
 756 Generates a Certificate Signing Request (CSR) using the PKCS #10 format\&amp;.
 757 
 758 A CSR is intended to be sent to a certificate authority (CA)\&amp;. The CA authenticates the certificate requestor (usually off-line) and will return a certificate or certificate chain, used to replace the existing certificate chain (which initially consists of a self-signed certificate) in the keystore\&amp;.
 759 
 760 The private key associated with alias is used to create the PKCS #10 certificate request\&amp;. To access the private key, the correct password must be provided\&amp;. If \f3keypass\fR is not provided at the command line and is different from the password used to protect the integrity of the keystore, then the user is prompted for it\&amp;. If \f3dname\fR is provided, then it is used as the subject in the CSR\&amp;. Otherwise, the X\&amp;.500 Distinguished Name associated with alias is used\&amp;.
 761 
 762 The \f3sigalg\fR value specifies the algorithm that should be used to sign the CSR\&amp;.
 763 
 764 The CSR is stored in the file certreq_file\&amp;. If no file is specified, then the CSR is output to \f3stdout\fR\&amp;.
 765 
 766 Use the \f3importcert\fR command to import the response from the CA\&amp;.
 767 .TP     
 768 -exportcert
 769 .sp     
 770 .nf     
 771 \f3{\-alias \fIalias\fR} {\-file \fIcert_file\fR} {\-storetype \fIstoretype\fR} {\-keystore \fIkeystore\fR}\fP
 772 .fi     
 773 .sp     
 774 .sp     
 775 .nf     
 776 \f3[\-storepass \fIstorepass\fR] {\-providerName \fIprovider_name\fR}\fP
 777 .fi     
 778 .sp     
 779 .sp     
 780 .nf     
 781 \f3{\-providerClass \fIprovider_class_name\fR {\-providerArg \fIprovider_arg\fR}}\fP
 782 .fi     
 783 .sp     
 784 .sp     
 785 .nf     
 786 \f3{\-rfc} {\-v} {\-protected} {\-Jjavaoption}\fP
 787 .fi     
 788 .sp     
 789 
 790 
 791 Reads from the keystore the certificate associated with \fIalias\fR and stores it in the cert_file file\&amp;. When no file is specified, the certificate is output to \f3stdout\fR\&amp;.
 792 
 793 The certificate is by default output in binary encoding\&amp;. If the \f3-rfc\fR option is specified, then the output in the printable encoding format defined by the Internet RFC 1421 Certificate Encoding Standard\&amp;.
 794 
 795 If \f3alias\fR refers to a trusted certificate, then that certificate is output\&amp;. Otherwise, \f3alias\fR refers to a key entry with an associated certificate chain\&amp;. In that case, the first certificate in the chain is returned\&amp;. This certificate authenticates the public key of the entity addressed by \f3alias\fR\&amp;.
 796 
 797 This command was named \f3-export\fR in earlier releases\&amp;. The old name is still supported in this release\&amp;. The new name, \f3-exportcert\fR, is preferred going forward\&amp;.
 798 .TP     
 799 -list
 800 .sp     
 801 .nf     
 802 \f3{\-alias \fIalias\fR} {\-storetype \fIstoretype\fR} {\-keystore \fIkeystore\fR} [\-storepass \fIstorepass\fR]\fP
 803 .fi     
 804 .sp     
 805 .sp     
 806 .nf     
 807 \f3{\-providerName \fIprovider_name\fR}\fP
 808 .fi     
 809 .sp     
 810 .sp     
 811 .nf     
 812 \f3{\-providerClass \fIprovider_class_name\fR {\-providerArg \fIprovider_arg\fR}}\fP
 813 .fi     
 814 .sp     
 815 .sp     
 816 .nf     
 817 \f3{\-v | \-rfc} {\-protected} {\-Jjavaoption}\fP
 818 .fi     
 819 .sp     
 820 
 821 
 822 Prints to \f3stdout\fR the contents of the keystore entry identified by \f3alias\fR\&amp;. If no \f3alias\fR is specified, then the contents of the entire keystore are printed\&amp;.
 823 
 824 This command by default prints the SHA1 fingerprint of a certificate\&amp;. If the \f3-v\fR option is specified, then the certificate is printed in human-readable format, with additional information such as the owner, issuer, serial number, and any extensions\&amp;. If the \f3-rfc\fR option is specified, then the certificate contents are printed using the printable encoding format, as defined by the Internet RFC 1421 Certificate Encoding Standard\&amp;.
 825 
 826 You cannot specify both \f3-v\fR and \f3-rfc\fR\&amp;.
 827 .TP     
 828 -printcert
 829 .sp     
 830 .nf     
 831 \f3{\-file \fIcert_file\fR | \-sslserver \fIhost\fR[:\fIport\fR]} {\-jarfile \fIJAR_file\fR {\-rfc} {\-v}\fP
 832 .fi     
 833 .sp     
 834 .sp     
 835 .nf     
 836 \f3{\-Jjavaoption}\fP
 837 .fi     
 838 .sp     
 839 
 840 
 841 Reads the certificate from the file cert_file, the SSL server located at host:port, or the signed JAR file \f3JAR_file\fR (with the \f3-jarfile\fR option and prints its contents in a human-readable format\&amp;. When no port is specified, the standard HTTPS port 443 is assumed\&amp;. Note that \f3-sslserver\fR and -file options cannot be provided at the same time\&amp;. Otherwise, an error is reported\&amp;. If neither option is specified, then the certificate is read from \f3stdin\fR\&amp;.
 842 
 843 When\f3-rfc\fR is specified, the \f3keytool\fR command prints the certificate in PEM mode as defined by the Internet RFC 1421 Certificate Encoding standard\&amp;. See Internet RFC 1421 Certificate Encoding Standard\&amp;.
 844 
 845 If the certificate is read from a file or \f3stdin\fR, then it might be either binary encoded or in printable encoding format, as defined by the RFC 1421 Certificate Encoding standard\&amp;.
 846 
 847 If the SSL server is behind a firewall, then the \f3-J-Dhttps\&amp;.proxyHost=proxyhost\fR and \f3-J-Dhttps\&amp;.proxyPort=proxyport\fR options can be specified on the command line for proxy tunneling\&amp;. See Java Secure Socket Extension (JSSE) Reference Guide at http://docs\&amp;.oracle\&amp;.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide\&amp;.html
 848 
 849 \fINote:\fR This option can be used independently of a keystore\&amp;.
 850 .TP     
 851 -printcrl
 852 .sp     
 853 .nf     
 854 \f3\-file \fIcrl_\fR {\-v}\fP
 855 .fi     
 856 .sp     
 857 
 858 
 859 Reads the Certificate Revocation List (CRL) from the file \f3crl_\fR\&amp;. A CRL is a list of digital certificates that were revoked by the CA that issued them\&amp;. The CA generates the \f3crl_\fR file\&amp;.
 860 
 861 \fINote:\fR This option can be used independently of a keystore\&amp;.
 862 .TP     
 863 -storepasswd
 864 .sp     
 865 .nf     
 866 \f3[\-new \fInew_storepass\fR] {\-storetype \fIstoretype\fR} {\-keystore \fIkeystore\fR}\fP
 867 .fi     
 868 .sp     
 869 .sp     
 870 .nf     
 871 \f3[\-storepass \fIstorepass\fR] {\-providerName \fIprovider_name\fR}\fP
 872 .fi     
 873 .sp     
 874 .sp     
 875 .nf     
 876 \f3{\-providerClass \fIprovider_class_name\fR {\-providerArg \fIprovider_arg\fR}}\fP
 877 .fi     
 878 .sp     
 879 .sp     
 880 .nf     
 881 \f3{\-v} {\-Jjavaoption}\fP
 882 .fi     
 883 .sp     
 884 
 885 
 886 Changes the password used to protect the integrity of the keystore contents\&amp;. The new password is \f3new_storepass\fR, which must be at least 6 characters\&amp;.
 887 .TP     
 888 -keypasswd
 889 .sp     
 890 .nf     
 891 \f3{\-alias \fIalias\fR} [\-keypass \fIold_keypass\fR] [\-new \fInew_keypass\fR] {\-storetype \fIstoretype\fR}\fP
 892 .fi     
 893 .sp     
 894 .sp     
 895 .nf     
 896 \f3{\-keystore \fIkeystore\fR} [\-storepass \fIstorepass\fR] {\-providerName \fIprovider_name\fR}\fP
 897 .fi     
 898 .sp     
 899 .sp     
 900 .nf     
 901 \f3{\-providerClass \fIprovider_class_name\fR {\-providerArg \fIprovider_arg\fR}} {\-v}\fP
 902 .fi     
 903 .sp     
 904 .sp     
 905 .nf     
 906 \f3{\-Jjavaoption}\fP
 907 .fi     
 908 .sp     
 909 
 910 
 911 Changes the password under which the private/secret key identified by \f3alias\fR is protected, from \f3old_keypass\fR to \f3new_keypass\fR, which must be at least 6 characters\&amp;.
 912 
 913 If the \f3-keypass\fR option is not provided at the command line, and the key password is different from the keystore password, then the user is prompted for it\&amp;.
 914 
 915 If the \f3-new\fR option is not provided at the command line, then the user is prompted for it
 916 .TP     
 917 -delete
 918 .sp     
 919 .nf     
 920 \f3[\-alias \fIalias\fR] {\-storetype \fIstoretype\fR} {\-keystore \fIkeystore\fR} [\-storepass \fIstorepass\fR]\fP
 921 .fi     
 922 .sp     
 923 .sp     
 924 .nf     
 925 \f3{\-providerName \fIprovider_name\fR}  \fP
 926 .fi     
 927 .sp     
 928 .sp     
 929 .nf     
 930 \f3{\-providerClass \fIprovider_class_name\fR {\-providerArg \fIprovider_arg\fR}}\fP
 931 .fi     
 932 .sp     
 933 .sp     
 934 .nf     
 935 \f3{\-v} {\-protected} {\-Jjavaoption}\fP
 936 .fi     
 937 .sp     
 938 
 939 
 940 Deletes from the keystore the entry identified by \f3alias\fR\&amp;. The user is prompted for the alias, when no alias is provided at the command line\&amp;.
 941 .TP     
 942 -changealias
 943 .sp     
 944 .nf     
 945 \f3{\-alias \fIalias\fR} [\-destalias \fIdestalias\fR] [\-keypass \fIkeypass\fR] {\-storetype \fIstoretype\fR}\fP
 946 .fi     
 947 .sp     
 948 .sp     
 949 .nf     
 950 \f3{\-keystore \fIkeystore\fR} [\-storepass \fIstorepass\fR] {\-providerName \fIprovider_name\fR}\fP
 951 .fi     
 952 .sp     
 953 .sp     
 954 .nf     
 955 \f3{\-providerClass \fIprovider_class_name\fR {\-providerArg \fIprovider_arg\fR}} {\-v}\fP
 956 .fi     
 957 .sp     
 958 .sp     
 959 .nf     
 960 \f3{\-protected} {\-Jjavaoption}\fP
 961 .fi     
 962 .sp     
 963 
 964 
 965 Move an existing keystore entry from the specified \f3alias\fR to a new alias, \f3destalias\fR\&amp;. If no destination alias is provided, then the command prompts for one\&amp;. If the original entry is protected with an entry password, then the password can be supplied with the \f3-keypass\fR option\&amp;. If no key password is provided, then the \f3storepass\fR (if provided) is attempted first\&amp;. If the attempt fails, then the user is prompted for a password\&amp;.
 966 .TP
 967 -help
 968 .br
 969 Lists the basic commands and their options\&amp;.
 970 
 971 For more information about a specific command, enter the following, where \f3command_name\fR is the name of the command: \f3keytool -command_name -help\fR\&amp;.
 972 .SH EXAMPLES    
 973 This example walks through the sequence of steps to create a keystore for managing public/private key pair and certificates from trusted entities\&amp;.
 974 .SS GENERATE\ THE\ KEY\ PAIR    
 975 First, create a keystore and generate the key pair\&amp;. You can use a command such as the following typed as a single line:
 976 .sp     
 977 .nf     
 978 \f3keytool \-genkeypair \-dname &quot;cn=Mark Jones, ou=Java, o=Oracle, c=US&quot;\fP
 979 .fi     
 980 .nf     
 981 \f3    \-alias business \-keypass &lt;new password for private key&gt;\fP
 982 .fi     
 983 .nf     
 984 \f3    \-keystore /working/mykeystore\fP
 985 .fi     
 986 .nf     
 987 \f3    \-storepass &lt;new password for keystore&gt; \-validity 180\fP
 988 .fi     
 989 .nf     
 990 \f3\fP
 991 .fi     
 992 .sp     
 993 The command creates the keystore named \f3mykeystore\fR in the working directory (assuming it does not already exist), and assigns it the password specified by \f3&lt;new password for keystore&gt;\fR\&amp;. It generates a public/private key pair for the entity whose distinguished name has a common name of Mark Jones, organizational unit of Java, organization of Oracle and two-letter country code of US\&amp;. It uses the default DSA key generation algorithm to create the keys; both are 1024 bits\&amp;.
 994 .PP
 995 The command uses the default SHA1withDSA signature algorithm to create a self-signed certificate that includes the public key and the distinguished name information\&amp;. The certificate is valid for 180 days, and is associated with the private key in a keystore entry referred to by the alias \f3business\fR\&amp;. The private key is assigned the password specified by \f3&lt;new password for private key&gt;\fR\&amp;.
 996 .PP
 997 The command is significantly shorter when the option defaults are accepted\&amp;. In this case, no options are required, and the defaults are used for unspecified options that have default values\&amp;. You are prompted for any required values\&amp;. You could have the following:
 998 .sp     
 999 .nf     
1000 \f3keytool \-genkeypair\fP
1001 .fi     
1002 .nf     
1003 \f3\fP
1004 .fi     
1005 .sp     
1006 In this case, a keystore entry with the alias \f3mykey\fR is created, with a newly generated key pair and a certificate that is valid for 90 days\&amp;. This entry is placed in the keystore named \f3\&amp;.keystore\fR in your home directory\&amp;. The keystore is created when it does not already exist\&amp;. You are prompted for the distinguished name information, the keystore password, and the private key password\&amp;.
1007 .PP
1008 The rest of the examples assume you executed the \f3-genkeypair\fR command without options specified, and that you responded to the prompts with values equal to those specified in the first \f3-genkeypair\fR command\&amp;. For example, a distinguished name of \f3cn=Mark Jones\fR, \f3ou=Java\fR, \f3o=Oracle\fR, \f3c=US\fR)\&amp;.
1009 .SS REQUEST\ A\ SIGNED\ CERTIFICATE\ FROM\ A\ CA    
1010 Generating the key pair created a self-signed certificate\&amp;. A certificate is more likely to be trusted by others when it is signed by a Certification Authority (CA)\&amp;. To get a CA signature, first generate a Certificate Signing Request (CSR), as follows:
1011 .sp     
1012 .nf     
1013 \f3keytool \-certreq \-file MarkJ\&amp;.csr\fP
1014 .fi     
1015 .nf     
1016 \f3\fP
1017 .fi     
1018 .sp     
1019 This creates a CSR for the entity identified by the default alias \f3mykey\fR and puts the request in the file named MarkJ\&amp;.csr\&amp;. Submit this file to a CA, such as VeriSign\&amp;. The CA authenticates you, the requestor (usually off-line), and returns a certificate, signed by them, authenticating your public key\&amp;. In some cases, the CA returns a chain of certificates, each one authenticating the public key of the signer of the previous certificate in the chain\&amp;.
1020 .SS IMPORT\ A\ CERTIFICATE\ FOR\ THE\ CA    
1021 You now need to replace the self-signed certificate with a certificate chain, where each certificate in the chain authenticates the public key of the signer of the previous certificate in the chain, up to a root CA\&amp;.
1022 .PP
1023 Before you import the certificate reply from a CA, you need one or more trusted certificates in your keystore or in the \f3cacerts\fR keystore file\&amp;. See \f3-importcert\fR in Commands\&amp;.
1024 .TP 0.2i    
1025 \(bu
1026 If the certificate reply is a certificate chain, then you need the top certificate of the chain\&amp;. The root CA certificate that authenticates the public key of the CA\&amp;.
1027 .TP 0.2i    
1028 \(bu
1029 If the certificate reply is a single certificate, then you need a certificate for the issuing CA (the one that signed it)\&amp;. If that certificate is not self-signed, then you need a certificate for its signer, and so on, up to a self-signed root CA certificate\&amp;.
1030 .PP
1031 The \f3cacerts\fR keystore file ships with several VeriSign root CA certificates, so you probably will not need to import a VeriSign certificate as a trusted certificate in your keystore\&amp;. But if you request a signed certificate from a different CA, and a certificate authenticating that CA\&amp;&#39;s public key was not added to \f3cacerts\fR, then you must import a certificate from the CA as a trusted certificate\&amp;.
1032 .PP
1033 A certificate from a CA is usually either self-signed or signed by another CA, in which case you need a certificate that authenticates that CA\&amp;&#39;s public key\&amp;. Suppose company ABC, Inc\&amp;., is a CA, and you obtain a file named A\f3BCCA\&amp;.cer\fR that is supposed to be a self-signed certificate from ABC, that authenticates that CA\&amp;&#39;s public key\&amp;. Be careful to ensure the certificate is valid before you import it as a trusted certificate\&amp;. View it first with the \f3keytool -printcert\fR command or the \f3keytool -importcert\fR command without the \f3-noprompt\fR option, and make sure that the displayed certificate fingerprints match the expected ones\&amp;. You can call the person who sent the certificate, and compare the fingerprints that you see with the ones that they show or that a secure public key repository shows\&amp;. Only when the fingerprints are equal is it guaranteed that the certificate was not replaced in transit with somebody else\&amp;&#39;s (for example, an attacker\&amp;&#39;s) certificate\&amp;. If such an attack takes place, and you did not check the certificate before you imported it, then you would be trusting anything the attacker has signed\&amp;.
1034 .PP
1035 If you trust that the certificate is valid, then you can add it to your keystore with the following command:
1036 .sp     
1037 .nf     
1038 \f3keytool \-importcert \-alias abc \-file ABCCA\&amp;.cer\fP
1039 .fi     
1040 .nf     
1041 \f3\fP
1042 .fi     
1043 .sp     
1044 This command creates a trusted certificate entry in the keystore, with the data from the file ABCCA\&amp;.cer, and assigns the alias \f3abc\fR to the entry\&amp;.
1045 .SS IMPORT\ THE\ CERTIFICATE\ REPLY\ FROM\ THE\ CA    
1046 After you import a certificate that authenticates the public key of the CA you submitted your certificate signing request to (or there is already such a certificate in the cacerts file), you can import the certificate reply and replace your self-signed certificate with a certificate chain\&amp;. This chain is the one returned by the CA in response to your request (when the CA reply is a chain), or one constructed (when the CA reply is a single certificate) using the certificate reply and trusted certificates that are already available in the keystore where you import the reply or in the \f3cacerts\fR keystore file\&amp;.
1047 .PP
1048 For example, if you sent your certificate signing request to VeriSign, then you can import the reply with the following, which assumes the returned certificate is named VSMarkJ\&amp;.cer:
1049 .sp     
1050 .nf     
1051 \f3keytool \-importcert \-trustcacerts \-file VSMarkJ\&amp;.cer\fP
1052 .fi     
1053 .nf     
1054 \f3\fP
1055 .fi     
1056 .sp     
1057 .SS EXPORT\ A\ CERTIFICATE\ THAT\ AUTHENTICATES\ THE\ PUBLIC\ KEY    
1058 If you used the \f3jarsigner\fR command to sign a Java Archive (JAR) file, then clients that want to use the file will want to authenticate your signature\&amp;. One way the clients can authenticate you is by first importing your public key certificate into their keystore as a trusted entry\&amp;.
1059 .PP
1060 You can export the certificate and supply it to your clients\&amp;. As an example, you can copy your certificate to a file named MJ\&amp;.cer with the following command that assumes the entry has an alias of \f3mykey\fR:
1061 .sp     
1062 .nf     
1063 \f3keytool \-exportcert \-alias mykey \-file MJ\&amp;.cer\fP
1064 .fi     
1065 .nf     
1066 \f3\fP
1067 .fi     
1068 .sp     
1069 With the certificate and the signed JAR file, a client can use the \f3jarsigner\fR command to authenticate your signature\&amp;.
1070 .SS IMPORT\ KEYSTORE    
1071 The command \f3importkeystore\fR is used to import an entire keystore into another keystore, which means all entries from the source keystore, including keys and certificates, are all imported to the destination keystore within a single command\&amp;. You can use this command to import entries from a different type of keystore\&amp;. During the import, all new entries in the destination keystore will have the same alias names and protection passwords (for secret keys and private keys)\&amp;. If the \f3keytool\fR command cannot recover the private keys or secret keys from the source keystore, then it prompts you for a password\&amp;. If it detects alias duplication, then it asks you for a new alias, and you can specify a new alias or simply allow the \f3keytool\fR command to overwrite the existing one\&amp;.
1072 .PP
1073 For example, to import entries from a typical JKS type keystore key\&amp;.jks into a PKCS #11 type hardware-based keystore, use the command:
1074 .sp     
1075 .nf     
1076 \f3keytool \-importkeystore\fP
1077 .fi     
1078 .nf     
1079 \f3    \-srckeystore key\&amp;.jks \-destkeystore NONE\fP
1080 .fi     
1081 .nf     
1082 \f3    \-srcstoretype JKS \-deststoretype PKCS11\fP
1083 .fi     
1084 .nf     
1085 \f3    \-srcstorepass &lt;src keystore password&gt;\fP
1086 .fi     
1087 .nf     
1088 \f3    \-deststorepass &lt;destination keystore pwd&gt;\fP
1089 .fi     
1090 .nf     
1091 \f3\fP
1092 .fi     
1093 .sp     
1094 The \f3importkeystore\fR command can also be used to import a single entry from a source keystore to a destination keystore\&amp;. In this case, besides the options you see in the previous example, you need to specify the alias you want to import\&amp;. With the \f3-srcalias\fR option specified, you can also specify the destination alias name in the command line, as well as protection password for a secret/private key and the destination protection password you want\&amp;. The following command demonstrates this:
1095 .sp     
1096 .nf     
1097 \f3keytool \-importkeystore\fP
1098 .fi     
1099 .nf     
1100 \f3    \-srckeystore key\&amp;.jks \-destkeystore NONE\fP
1101 .fi     
1102 .nf     
1103 \f3    \-srcstoretype JKS \-deststoretype PKCS11\fP
1104 .fi     
1105 .nf     
1106 \f3    \-srcstorepass &lt;src keystore password&gt;\fP
1107 .fi     
1108 .nf     
1109 \f3    \-deststorepass &lt;destination keystore pwd&gt;\fP
1110 .fi     
1111 .nf     
1112 \f3    \-srcalias myprivatekey \-destalias myoldprivatekey\fP
1113 .fi     
1114 .nf     
1115 \f3    \-srckeypass &lt;source entry password&gt;\fP
1116 .fi     
1117 .nf     
1118 \f3    \-destkeypass &lt;destination entry password&gt;\fP
1119 .fi     
1120 .nf     
1121 \f3    \-noprompt\fP
1122 .fi     
1123 .nf     
1124 \f3\fP
1125 .fi     
1126 .sp     
1127 .SS GENERATE\ CERTIFICATES\ FOR\ AN\ SSL\ SERVER    
1128 The following are \f3keytool\fR commands to generate key pairs and certificates for three entities: Root CA (\f3root\fR), Intermediate CA (\f3ca\fR), and SSL server (\f3server\fR)\&amp;. Ensure that you store all the certificates in the same keystore\&amp;. In these examples, RSA is the recommended the key algorithm\&amp;.
1129 .sp     
1130 .nf     
1131 \f3keytool \-genkeypair \-keystore root\&amp;.jks \-alias root \-ext bc:c\fP
1132 .fi     
1133 .nf     
1134 \f3keytool \-genkeypair \-keystore ca\&amp;.jks \-alias ca \-ext bc:c\fP
1135 .fi     
1136 .nf     
1137 \f3keytool \-genkeypair \-keystore server\&amp;.jks \-alias server\fP
1138 .fi     
1139 .nf     
1140 \f3\fP
1141 .fi     
1142 .nf     
1143 \f3keytool \-keystore root\&amp;.jks \-alias root \-exportcert \-rfc &gt; root\&amp;.pem\fP
1144 .fi     
1145 .nf     
1146 \f3\fP
1147 .fi     
1148 .nf     
1149 \f3keytool \-storepass &lt;storepass&gt; \-keystore ca\&amp;.jks \-certreq \-alias ca |\fP
1150 .fi     
1151 .nf     
1152 \f3    keytool \-storepass &lt;storepass&gt; \-keystore root\&amp;.jks\fP
1153 .fi     
1154 .nf     
1155 \f3    \-gencert \-alias root \-ext BC=0 \-rfc &gt; ca\&amp;.pem\fP
1156 .fi     
1157 .nf     
1158 \f3keytool \-keystore ca\&amp;.jks \-importcert \-alias ca \-file ca\&amp;.pem\fP
1159 .fi     
1160 .nf     
1161 \f3\fP
1162 .fi     
1163 .nf     
1164 \f3keytool \-storepass &lt;storepass&gt; \-keystore server\&amp;.jks \-certreq \-alias server |\fP
1165 .fi     
1166 .nf     
1167 \f3    keytool \-storepass &lt;storepass&gt; \-keystore ca\&amp;.jks \-gencert \-alias ca\fP
1168 .fi     
1169 .nf     
1170 \f3    \-ext ku:c=dig,kE \-rfc &gt; server\&amp;.pem\fP
1171 .fi     
1172 .nf     
1173 \f3cat root\&amp;.pem ca\&amp;.pem server\&amp;.pem |\fP
1174 .fi     
1175 .nf     
1176 \f3    keytool \-keystore server\&amp;.jks \-importcert \-alias server\fP
1177 .fi     
1178 .nf     
1179 \f3\fP
1180 .fi     
1181 .sp     
1182 .SH TERMS    
1183 .TP     
1184 Keystore
1185 A keystore is a storage facility for cryptographic keys and certificates\&amp;.
1186 .TP     
1187 Keystore entries
1188 Keystores can have different types of entries\&amp;. The two most applicable entry types for the \f3keytool\fR command include the following:
1189 
1190 \fIKey entries\fR: Each entry holds very sensitive cryptographic key information, which is stored in a protected format to prevent unauthorized access\&amp;. Typically, a key stored in this type of entry is a secret key, or a private key accompanied by the certificate chain for the corresponding public key\&amp;. See Certificate Chains\&amp;. The \f3keytool\fR command can handle both types of entries, while the \f3jarsigner\fR tool only handles the latter type of entry, that is private keys and their associated certificate chains\&amp;.
1191 
1192 \fITrusted certificate entries\fR: Each entry contains a single public key certificate that belongs to another party\&amp;. The entry is called a trusted certificate because the keystore owner trusts that the public key in the certificate belongs to the identity identified by the subject (owner) of the certificate\&amp;. The issuer of the certificate vouches for this, by signing the certificate\&amp;.
1193 .TP     
1194 KeyStore aliases
1195 All keystore entries (key and trusted certificate entries) are accessed by way of unique aliases\&amp;.
1196 
1197 An alias is specified when you add an entity to the keystore with the \f3-genseckey\fR command to generate a secret key, the \f3-genkeypair\fR command to generate a key pair (public and private key), or the \f3-importcert\fR command to add a certificate or certificate chain to the list of trusted certificates\&amp;. Subsequent \f3keytool\fR commands must use this same alias to refer to the entity\&amp;.
1198 
1199 For example, you can use the alias \f3duke\fR to generate a new public/private key pair and wrap the public key into a self-signed certificate with the following command\&amp;. See Certificate Chains\&amp;.
1200 .sp     
1201 .nf     
1202 \f3keytool \-genkeypair \-alias duke \-keypass dukekeypasswd\fP
1203 .fi     
1204 .nf     
1205 \f3\fP
1206 .fi     
1207 .sp     
1208 
1209 
1210 This example specifies an initial password of \f3dukekeypasswd\fR required by subsequent commands to access the private key associated with the alias \f3duke\fR\&amp;. If you later want to change Duke\&amp;&#39;s private key password, use a command such as the following:
1211 .sp     
1212 .nf     
1213 \f3keytool \-keypasswd \-alias duke \-keypass dukekeypasswd \-new newpass\fP
1214 .fi     
1215 .nf     
1216 \f3\fP
1217 .fi     
1218 .sp     
1219 
1220 
1221 This changes the password from \f3dukekeypasswd\fR to \f3newpass\fR\&amp;. A password should not be specified on a command line or in a script unless it is for testing purposes, or you are on a secure system\&amp;. If you do not specify a required password option on a command line, then you are prompted for it\&amp;.
1222 .TP     
1223 KeyStore implementation
1224 The \f3KeyStore\fR class provided in the \f3java\&amp;.security\fR package supplies well-defined interfaces to access and modify the information in a keystore\&amp;. It is possible for there to be multiple different concrete implementations, where each implementation is that for a particular type of keystore\&amp;.
1225 
1226 Currently, two command-line tools (\f3keytool\fR and \f3jarsigner\fR) and a GUI-based tool named Policy Tool make use of keystore implementations\&amp;. Because the \f3KeyStore\fR class is \f3public\fR, users can write additional security applications that use it\&amp;.
1227 
1228 There is a built-in default implementation, provided by Oracle\&amp;. It implements the keystore as a file with a proprietary keystore type (format) named JKS\&amp;. It protects each private key with its individual password, and also protects the integrity of the entire keystore with a (possibly different) password\&amp;.
1229 
1230 Keystore implementations are provider-based\&amp;. More specifically, the application interfaces supplied by \f3KeyStore\fR are implemented in terms of a Service Provider Interface (SPI)\&amp;. That is, there is a corresponding abstract \f3KeystoreSpi\fR class, also in the \f3java\&amp;.security package\fR, which defines the Service Provider Interface methods that providers must implement\&amp;. The term \fIprovider\fR refers to a package or a set of packages that supply a concrete implementation of a subset of services that can be accessed by the Java Security API\&amp;. To provide a keystore implementation, clients must implement a provider and supply a \f3KeystoreSpi\fR subclass implementation, as described in How to Implement a Provider in the Java Cryptography Architecture at http://docs\&amp;.oracle\&amp;.com/javase/8/docs/technotes/guides/security/crypto/HowToImplAProvider\&amp;.html
1231 
1232 Applications can choose different types of keystore implementations from different providers, using the \f3getInstance\fR factory method supplied in the \f3KeyStore\fR class\&amp;. A keystore type defines the storage and data format of the keystore information, and the algorithms used to protect private/secret keys in the keystore and the integrity of the keystore\&amp;. Keystore implementations of different types are not compatible\&amp;.
1233 
1234 The \f3keytool\fR command works on any file-based keystore implementation\&amp;. It treats the keystore location that is passed to it at the command line as a file name and converts it to a \f3FileInputStream\fR, from which it loads the keystore information\&amp;.)The \f3jarsigner\fR command can read a keystore from any location that can be specified with a URL\&amp;.
1235 
1236 For \f3keytool\fR and \f3jarsigner\fR, you can specify a keystore type at the command line, with the \f3-storetype\fR option\&amp;. For Policy Tool, you can specify a keystore type with the \fIKeystore\fR menu\&amp;.
1237 
1238 If you do not explicitly specify a keystore type, then the tools choose a keystore implementation based on the value of the \f3keystore\&amp;.type\fR property specified in the security properties file\&amp;. The security properties file is called \f3java\&amp;.security\fR, and resides in the security properties directory, \f3java\&amp;.home\elib\esecurity\fR on Windows and \f3java\&amp;.home/lib/security\fR on Oracle Solaris, where \f3java\&amp;.home\fR is the runtime environment directory\&amp;. The \f3jre\fR directory in the SDK or the top-level directory of the Java Runtime Environment (JRE)\&amp;.
1239 
1240 Each tool gets the \f3keystore\&amp;.type\fR value and then examines all the currently installed providers until it finds one that implements a keystores of that type\&amp;. It then uses the keystore implementation from that provider\&amp;.The \f3KeyStore\fR class defines a static method named \f3getDefaultType\fR that lets applications and applets retrieve the value of the \f3keystore\&amp;.type\fR property\&amp;. The following line of code creates an instance of the default keystore type as specified in the \f3keystore\&amp;.type\fR property:
1241 .sp     
1242 .nf     
1243 \f3KeyStore keyStore = KeyStore\&amp;.getInstance(KeyStore\&amp;.getDefaultType());\fP
1244 .fi     
1245 .nf     
1246 \f3\fP
1247 .fi     
1248 .sp     
1249 
1250 
1251 The default keystore type is \f3jks\fR, which is the proprietary type of the keystore implementation provided by Oracle\&amp;. This is specified by the following line in the security properties file:
1252 .sp     
1253 .nf     
1254 \f3keystore\&amp;.type=jks\fP
1255 .fi     
1256 .nf     
1257 \f3\fP
1258 .fi     
1259 .sp     
1260 
1261 
1262 To have the tools utilize a keystore implementation other than the default, you can change that line to specify a different keystore type\&amp;. For example, if you have a provider package that supplies a keystore implementation for a keystore type called \f3pkcs12\fR, then change the line to the following:
1263 .sp     
1264 .nf     
1265 \f3keystore\&amp;.type=pkcs12\fP
1266 .fi     
1267 .nf     
1268 \f3\fP
1269 .fi     
1270 .sp     
1271 
1272 
1273 \fINote:\fR Case does not matter in keystore type designations\&amp;. For example, JKS would be considered the same as jks\&amp;.
1274 .TP     
1275 Certificate
1276 A certificate (or public-key certificate) is a digitally signed statement from one entity (the issuer), saying that the public key and some other information of another entity (the subject) has some specific value\&amp;. The following terms are related to certificates:
1277 
1278 \fIPublic Keys\fR: These are numbers associated with a particular entity, and are intended to be known to everyone who needs to have trusted interactions with that entity\&amp;. Public keys are used to verify signatures\&amp;.
1279 
1280 \fIDigitally Signed\fR: If some data is digitally signed, then it is stored with the identity of an entity and a signature that proves that entity knows about the data\&amp;. The data is rendered unforgeable by signing with the entity\&amp;&#39;s private key\&amp;.
1281 
1282 \fIIdentity\fR: A known way of addressing an entity\&amp;. In some systems, the identity is the public key, and in others it can be anything from an Oracle Solaris UID to an email address to an X\&amp;.509 distinguished name\&amp;.
1283 
1284 \fISignature\fR: A signature is computed over some data using the private key of an entity\&amp;. The signer, which in the case of a certificate is also known as the issuer\&amp;.
1285 
1286 \fIPrivate Keys\fR: These are numbers, each of which is supposed to be known only to the particular entity whose private key it is (that is, it is supposed to be kept secret)\&amp;. Private and public keys exist in pairs in all public key cryptography systems (also referred to as public key crypto systems)\&amp;. In a typical public key crypto system, such as DSA, a private key corresponds to exactly one public key\&amp;. Private keys are used to compute signatures\&amp;.
1287 
1288 \fIEntity\fR: An entity is a person, organization, program, computer, business, bank, or something else you are trusting to some degree\&amp;.
1289 
1290 Public key cryptography requires access to users\&amp;&#39; public keys\&amp;. In a large-scale networked environment, it is impossible to guarantee that prior relationships between communicating entities were established or that a trusted repository exists with all used public keys\&amp;. Certificates were invented as a solution to this public key distribution problem\&amp;. Now a Certification Authority (CA) can act as a trusted third party\&amp;. CAs are entities such as businesses that are trusted to sign (issue) certificates for other entities\&amp;. It is assumed that CAs only create valid and reliable certificates because they are bound by legal agreements\&amp;. There are many public Certification Authorities, such as VeriSign, Thawte, Entrust, and so on\&amp;.
1291 
1292 You can also run your own Certification Authority using products such as Microsoft Certificate Server or the Entrust CA product for your organization\&amp;. With the \f3keytool\fR command, it is possible to display, import, and export certificates\&amp;. It is also possible to generate self-signed certificates\&amp;.
1293 
1294 The \f3keytool\fR command currently handles X\&amp;.509 certificates\&amp;.
1295 .TP     
1296 X\&amp;.509 Certificates
1297 The X\&amp;.509 standard defines what information can go into a certificate and describes how to write it down (the data format)\&amp;. All the data in a certificate is encoded with two related standards called ASN\&amp;.1/DER\&amp;. Abstract Syntax Notation 1 describes data\&amp;. The Definite Encoding Rules describe a single way to store and transfer that data\&amp;.
1298 
1299 All X\&amp;.509 certificates have the following data, in addition to the signature:
1300 
1301 \fIVersion\fR: This identifies which version of the X\&amp;.509 standard applies to this certificate, which affects what information can be specified in it\&amp;. Thus far, three versions are defined\&amp;. The \f3keytool\fR command can import and export v1, v2, and v3 certificates\&amp;. It generates v3 certificates\&amp;.
1302 
1303 X\&amp;.509 Version 1 has been available since 1988, is widely deployed, and is the most generic\&amp;.
1304 
1305 X\&amp;.509 Version 2 introduced the concept of subject and issuer unique identifiers to handle the possibility of reuse of subject or issuer names over time\&amp;. Most certificate profile documents strongly recommend that names not be reused and that certificates should not make use of unique identifiers\&amp;. Version 2 certificates are not widely used\&amp;.
1306 
1307 X\&amp;.509 Version 3 is the most recent (1996) and supports the notion of extensions where anyone can define an extension and include it in the certificate\&amp;. Some common extensions are: KeyUsage (limits the use of the keys to particular purposes such as \f3signing-only\fR) and AlternativeNames (allows other identities to also be associated with this public key, for example\&amp;. DNS names, email addresses, IP addresses)\&amp;. Extensions can be marked critical to indicate that the extension should be checked and enforced or used\&amp;. For example, if a certificate has the KeyUsage extension marked critical and set to \f3keyCertSign\fR, then when this certificate is presented during SSL communication, it should be rejected because the certificate extension indicates that the associated private key should only be used for signing certificates and not for SSL use\&amp;.
1308 
1309 \fISerial number\fR: The entity that created the certificate is responsible for assigning it a serial number to distinguish it from other certificates it issues\&amp;. This information is used in numerous ways\&amp;. For example, when a certificate is revoked its serial number is placed in a Certificate Revocation List (CRL)\&amp;.
1310 
1311 \fISignature algorithm identifier\fR: This identifies the algorithm used by the CA to sign the certificate\&amp;.
1312 
1313 \fIIssuer name\fR: The X\&amp;.500 Distinguished Name of the entity that signed the certificate\&amp;. See X\&amp;.500 Distinguished Names\&amp;. This is typically a CA\&amp;. Using this certificate implies trusting the entity that signed this certificate\&amp;. In some cases, such as root or top-level CA certificates, the issuer signs its own certificate\&amp;.
1314 
1315 \fIValidity period\fR: Each certificate is valid only for a limited amount of time\&amp;. This period is described by a start date and time and an end date and time, and can be as short as a few seconds or almost as long as a century\&amp;. The validity period chosen depends on a number of factors, such as the strength of the private key used to sign the certificate, or the amount one is willing to pay for a certificate\&amp;. This is the expected period that entities can rely on the public value, when the associated private key has not been compromised\&amp;.
1316 
1317 \fISubject name\fR: The name of the entity whose public key the certificate identifies\&amp;. This name uses the X\&amp;.500 standard, so it is intended to be unique across the Internet\&amp;. This is the X\&amp;.500 Distinguished Name (DN) of the entity\&amp;. See X\&amp;.500 Distinguished Names\&amp;. For example,
1318 .sp     
1319 .nf     
1320 \f3CN=Java Duke, OU=Java Software Division, O=Oracle Corporation, C=US\fP
1321 .fi     
1322 .nf     
1323 \f3\fP
1324 .fi     
1325 .sp     
1326 
1327 
1328 These refer to the subject\&amp;&#39;s common name (CN), organizational unit (OU), organization (O), and country (C)\&amp;.
1329 
1330 \fISubject public key information\fR: This is the public key of the entity being named with an algorithm identifier that specifies which public key crypto system this key belongs to and any associated key parameters\&amp;.
1331 .TP     
1332 Certificate Chains
1333 The \f3keytool\fR command can create and manage keystore key entries that each contain a private key and an associated certificate chain\&amp;. The first certificate in the chain contains the public key that corresponds to the private key\&amp;.
1334 
1335 When keys are first generated, the chain starts off containing a single element, a self-signed certificate\&amp;. See \f3-genkeypair\fR in Commands\&amp;. A self-signed certificate is one for which the issuer (signer) is the same as the subject\&amp;. The subject is the entity whose public key is being authenticated by the certificate\&amp;. Whenever the \f3-genkeypair\fR command is called to generate a new public/private key pair, it also wraps the public key into a self-signed certificate\&amp;.
1336 
1337 Later, after a Certificate Signing Request (CSR) was generated with the \f3-certreq\fR command and sent to a Certification Authority (CA), the response from the CA is imported with \f3-importcert\fR, and the self-signed certificate is replaced by a chain of certificates\&amp;. See the \f3-certreq\fR and \f3-importcert\fR options in Commands\&amp;. At the bottom of the chain is the certificate (reply) issued by the CA authenticating the subject\&amp;&#39;s public key\&amp;. The next certificate in the chain is one that authenticates the CA\&amp;&#39;s public key\&amp;.
1338 
1339 In many cases, this is a self-signed certificate, which is a certificate from the CA authenticating its own public key, and the last certificate in the chain\&amp;. In other cases, the CA might return a chain of certificates\&amp;. In this case, the bottom certificate in the chain is the same (a certificate signed by the CA, authenticating the public key of the key entry), but the second certificate in the chain is a certificate signed by a different CA that authenticates the public key of the CA you sent the CSR to\&amp;. The next certificate in the chain is a certificate that authenticates the second CA\&amp;&#39;s key, and so on, until a self-signed root certificate is reached\&amp;. Each certificate in the chain (after the first) authenticates the public key of the signer of the previous certificate in the chain\&amp;.
1340 
1341 Many CAs only return the issued certificate, with no supporting chain, especially when there is a flat hierarchy (no intermediates CAs)\&amp;. In this case, the certificate chain must be established from trusted certificate information already stored in the keystore\&amp;.
1342 
1343 A different reply format (defined by the PKCS #7 standard) includes the supporting certificate chain in addition to the issued certificate\&amp;. Both reply formats can be handled by the \f3keytool\fR command\&amp;.
1344 
1345 The top-level (root) CA certificate is self-signed\&amp;. However, the trust into the root\&amp;&#39;s public key does not come from the root certificate itself, but from other sources such as a newspaper\&amp;. This is because anybody could generate a self-signed certificate with the distinguished name of, for example, the VeriSign root CA\&amp;. The root CA public key is widely known\&amp;. The only reason it is stored in a certificate is because this is the format understood by most tools, so the certificate in this case is only used as a vehicle to transport the root CA\&amp;&#39;s public key\&amp;. Before you add the root CA certificate to your keystore, you should view it with the \f3-printcert\fR option and compare the displayed fingerprint with the well-known fingerprint obtained from a newspaper, the root CA\&amp;&#39;s Web page, and so on\&amp;.
1346 .TP     
1347 The cacerts Certificates File
1348 A certificates file named \f3cacerts\fR resides in the security properties directory, \f3java\&amp;.home\elib\esecurity\fR on Windows and \f3java\&amp;.home/lib/security\fR on Oracle Solaris, where \f3java\&amp;.home\fR is the runtime environment\&amp;&#39;s directory, which would be the \f3jre\fR directory in the SDK or the top-level directory of the JRE\&amp;.
1349 
1350 The \f3cacerts\fR file represents a system-wide keystore with CA certificates\&amp;. System administrators can configure and manage that file with the \f3keytool\fR command by specifying \f3jks\fR as the keystore type\&amp;. The \f3cacerts\fR keystore file ships with a default set of root CA certificates\&amp;. You can list the default certificates with the following command:
1351 .sp     
1352 .nf     
1353 \f3keytool \-list \-keystore java\&amp;.home/lib/security/cacerts\fP
1354 .fi     
1355 .nf     
1356 \f3\fP
1357 .fi     
1358 .sp     
1359 
1360 
1361 The initial password of the \f3cacerts\fR keystore file is \f3changeit\fR\&amp;. System administrators should change that password and the default access permission of that file upon installing the SDK\&amp;.
1362 
1363 \fINote:\fR It is important to verify your \f3cacerts\fR file\&amp;. Because you trust the CAs in the \f3cacerts\fR file as entities for signing and issuing certificates to other entities, you must manage the \f3cacerts\fR file carefully\&amp;. The \f3cacerts\fR file should contain only certificates of the CAs you trust\&amp;. It is your responsibility to verify the trusted root CA certificates bundled in the \f3cacerts\fR file and make your own trust decisions\&amp;.
1364 
1365 To remove an untrusted CA certificate from the \f3cacerts\fR file, use the \f3delete\fR option of the \f3keytool\fR command\&amp;. You can find the \f3cacerts\fR file in the JRE installation directory\&amp;. Contact your system administrator if you do not have permission to edit this file
1366 .TP     
1367 Internet RFC 1421 Certificate Encoding Standard
1368 Certificates are often stored using the printable encoding format defined by the Internet RFC 1421 standard, instead of their binary encoding\&amp;. This certificate format, also known as Base64 encoding, makes it easy to export certificates to other applications by email or through some other mechanism\&amp;.
1369 
1370 Certificates read by the \f3-importcert\fR and \f3-printcert\fR commands can be in either this format or binary encoded\&amp;. The \f3-exportcert\fR command by default outputs a certificate in binary encoding, but will instead output a certificate in the printable encoding format, when the \f3-rfc\fR option is specified\&amp;.
1371 
1372 The \f3-list\fR command by default prints the SHA1 fingerprint of a certificate\&amp;. If the \f3-v\fR option is specified, then the certificate is printed in human-readable format\&amp;. If the \f3-rfc\fR option is specified, then the certificate is output in the printable encoding format\&amp;.
1373 
1374 In its printable encoding format, the encoded certificate is bounded at the beginning and end by the following text:
1375 .sp     
1376 .nf     
1377 \f3\-\-\-\-\-BEGIN CERTIFICATE\-\-\-\-\-\fP
1378 .fi     
1379 .nf     
1380 \f3\fP
1381 .fi     
1382 .nf     
1383 \f3encoded certificate goes here\&amp;. \fP
1384 .fi     
1385 .nf     
1386 \f3\fP
1387 .fi     
1388 .nf     
1389 \f3\-\-\-\-\-END CERTIFICATE\-\-\-\-\-\fP
1390 .fi     
1391 .nf     
1392 \f3\fP
1393 .fi     
1394 .sp     
1395 
1396 .TP     
1397 X\&amp;.500 Distinguished Names
1398 X\&amp;.500 Distinguished Names are used to identify entities, such as those that are named by the \f3subject\fR and \f3issuer\fR (signer) fields of X\&amp;.509 certificates\&amp;. The \f3keytool\fR command supports the following subparts:
1399 
1400 \fIcommonName\fR: The common name of a person such as Susan Jones\&amp;.
1401 
1402 \fIorganizationUnit\fR: The small organization (such as department or division) name\&amp;. For example, Purchasing\&amp;.
1403 
1404 \fIlocalityName\fR: The locality (city) name, for example, Palo Alto\&amp;.
1405 
1406 \fIstateName\fR: State or province name, for example, California\&amp;.
1407 
1408 \fIcountry\fR: Two-letter country code, for example, CH\&amp;.
1409 
1410 When you supply a distinguished name string as the value of a \f3-dname\fR option, such as for the \f3-genkeypair\fR command, the string must be in the following format:
1411 .sp     
1412 .nf     
1413 \f3CN=cName, OU=orgUnit, O=org, L=city, S=state, C=countryCode\fP
1414 .fi     
1415 .nf     
1416 \f3\fP
1417 .fi     
1418 .sp     
1419 
1420 
1421 All the italicized items represent actual values and the previous keywords are abbreviations for the following:
1422 .sp     
1423 .nf     
1424 \f3CN=commonName\fP
1425 .fi     
1426 .nf     
1427 \f3OU=organizationUnit\fP
1428 .fi     
1429 .nf     
1430 \f3O=organizationName\fP
1431 .fi     
1432 .nf     
1433 \f3L=localityName\fP
1434 .fi     
1435 .nf     
1436 \f3S=stateName\fP
1437 .fi     
1438 .nf     
1439 \f3C=country\fP
1440 .fi     
1441 .nf     
1442 \f3\fP
1443 .fi     
1444 .sp     
1445 
1446 
1447 A sample distinguished name string is:
1448 .sp     
1449 .nf     
1450 \f3CN=Mark Smith, OU=Java, O=Oracle, L=Cupertino, S=California, C=US\fP
1451 .fi     
1452 .nf     
1453 \f3\fP
1454 .fi     
1455 .sp     
1456 
1457 
1458 A sample command using such a string is:
1459 .sp     
1460 .nf     
1461 \f3keytool \-genkeypair \-dname &quot;CN=Mark Smith, OU=Java, O=Oracle, L=Cupertino,\fP
1462 .fi     
1463 .nf     
1464 \f3S=California, C=US&quot; \-alias mark\fP
1465 .fi     
1466 .nf     
1467 \f3\fP
1468 .fi     
1469 .sp     
1470 
1471 
1472 Case does not matter for the keyword abbreviations\&amp;. For example, CN, cn, and Cn are all treated the same\&amp;.
1473 
1474 Order matters; each subcomponent must appear in the designated order\&amp;. However, it is not necessary to have all the subcomponents\&amp;. You can use a subset, for example:
1475 .sp     
1476 .nf     
1477 \f3CN=Steve Meier, OU=Java, O=Oracle, C=US\fP
1478 .fi     
1479 .nf     
1480 \f3\fP
1481 .fi     
1482 .sp     
1483 
1484 
1485 If a distinguished name string value contains a comma, then the comma must be escaped by a backslash (\e) character when you specify the string on a command line, as in:
1486 .sp     
1487 .nf     
1488 \f3cn=Peter Schuster, ou=Java\e, Product Development, o=Oracle, c=US\fP
1489 .fi     
1490 .nf     
1491 \f3\fP
1492 .fi     
1493 .sp     
1494 
1495 
1496 It is never necessary to specify a distinguished name string on a command line\&amp;. When the distinguished name is needed for a command, but not supplied on the command line, the user is prompted for each of the subcomponents\&amp;. In this case, a comma does not need to be escaped by a backslash (\e)\&amp;.
1497 .SH WARNINGS    
1498 .SS IMPORTING\ TRUSTED\ CERTIFICATES\ WARNING    
1499 \fIImportant\fR: Be sure to check a certificate very carefully before importing it as a trusted certificate\&amp;.
1500 .PP
1501 Windows Example:
1502 
1503 View the certificate first with the \f3-printcert\fR command or the \f3-importcert\fR command without the \f3-noprompt\fR option\&amp;. Ensure that the displayed certificate fingerprints match the expected ones\&amp;. For example, suppose sends or emails you a certificate that you put it in a file named \f3\etmp\ecert\fR\&amp;. Before you consider adding the certificate to your list of trusted certificates, you can execute a \f3-printcert\fR command to view its fingerprints, as follows:
1504 .sp     
1505 .nf     
1506 \f3  keytool \-printcert \-file \etmp\ecert\fP
1507 .fi     
1508 .nf     
1509 \f3    Owner: CN=ll, OU=ll, O=ll, L=ll, S=ll, C=ll\fP
1510 .fi     
1511 .nf     
1512 \f3    Issuer: CN=ll, OU=ll, O=ll, L=ll, S=ll, C=ll\fP
1513 .fi     
1514 .nf     
1515 \f3    Serial Number: 59092b34\fP
1516 .fi     
1517 .nf     
1518 \f3    Valid from: Thu Sep 25 18:01:13 PDT 1997 until: Wed Dec 24 17:01:13 PST 1997\fP
1519 .fi     
1520 .nf     
1521 \f3    Certificate Fingerprints:\fP
1522 .fi     
1523 .nf     
1524 \f3         MD5:  11:81:AD:92:C8:E5:0E:A2:01:2E:D4:7A:D7:5F:07:6F\fP
1525 .fi     
1526 .nf     
1527 \f3         SHA1: 20:B6:17:FA:EF:E5:55:8A:D0:71:1F:E8:D6:9D:C0:37:13:0E:5E:FE\fP
1528 .fi     
1529 .nf     
1530 \f3         SHA256: 90:7B:70:0A:EA:DC:16:79:92:99:41:FF:8A:FE:EB:90:\fP
1531 .fi     
1532 .nf     
1533 \f3                 17:75:E0:90:B2:24:4D:3A:2A:16:A6:E4:11:0F:67:A4\fP
1534 .fi     
1535 .sp     
1536 
1537 .PP
1538 Oracle Solaris Example:
1539 
1540 View the certificate first with the \f3-printcert\fR command or the \f3-importcert\fR command without the \f3-noprompt\fR option\&amp;. Ensure that the displayed certificate fingerprints match the expected ones\&amp;. For example, suppose someone sends or emails you a certificate that you put it in a file named \f3/tmp/cert\fR\&amp;. Before you consider adding the certificate to your list of trusted certificates, you can execute a \f3-printcert\fR command to view its fingerprints, as follows:
1541 .sp     
1542 .nf     
1543 \f3  keytool \-printcert \-file /tmp/cert\fP
1544 .fi     
1545 .nf     
1546 \f3    Owner: CN=ll, OU=ll, O=ll, L=ll, S=ll, C=ll\fP
1547 .fi     
1548 .nf     
1549 \f3    Issuer: CN=ll, OU=ll, O=ll, L=ll, S=ll, C=ll\fP
1550 .fi     
1551 .nf     
1552 \f3    Serial Number: 59092b34\fP
1553 .fi     
1554 .nf     
1555 \f3    Valid from: Thu Sep 25 18:01:13 PDT 1997 until: Wed Dec 24 17:01:13 PST 1997\fP
1556 .fi     
1557 .nf     
1558 \f3    Certificate Fingerprints:\fP
1559 .fi     
1560 .nf     
1561 \f3         MD5:  11:81:AD:92:C8:E5:0E:A2:01:2E:D4:7A:D7:5F:07:6F\fP
1562 .fi     
1563 .nf     
1564 \f3         SHA1: 20:B6:17:FA:EF:E5:55:8A:D0:71:1F:E8:D6:9D:C0:37:13:0E:5E:FE\fP
1565 .fi     
1566 .nf     
1567 \f3         SHA256: 90:7B:70:0A:EA:DC:16:79:92:99:41:FF:8A:FE:EB:90:\fP
1568 .fi     
1569 .nf     
1570 \f3                 17:75:E0:90:B2:24:4D:3A:2A:16:A6:E4:11:0F:67:A4\fP
1571 .fi     
1572 .nf     
1573 \f3\fP
1574 .fi     
1575 .sp     
1576 Then call or otherwise contact the person who sent the certificate and compare the fingerprints that you see with the ones that they show\&amp;. Only when the fingerprints are equal is it guaranteed that the certificate was not replaced in transit with somebody else\&amp;&#39;s certificate such as an attacker\&amp;&#39;s certificate\&amp;. If such an attack took place, and you did not check the certificate before you imported it, then you would be trusting anything the attacker signed, for example, a JAR file with malicious class files inside\&amp;.
1577 .PP
1578 \fINote:\fR It is not required that you execute a \f3-printcert\fR command before importing a certificate\&amp;. This is because before you add a certificate to the list of trusted certificates in the keystore, the \f3-importcert\fR command prints out the certificate information and prompts you to verify it\&amp;. You can then stop the import operation\&amp;. However, you can do this only when you call the \f3-importcert\fR command without the \f3-noprompt\fR option\&amp;. If the \f3-noprompt\fR option is specified, then there is no interaction with the user\&amp;.
1579 .SS PASSWORDS\ WARNING    
1580 Most commands that operate on a keystore require the store password\&amp;. Some commands require a private/secret key password\&amp;. Passwords can be specified on the command line in the \f3-storepass\fR and \f3-keypass\fR options\&amp;. However, a password should not be specified on a command line or in a script unless it is for testing, or you are on a secure system\&amp;. When you do not specify a required password option on a command line, you are prompted for it\&amp;.
1581 .SS CERTIFICATE\ CONFORMANCE\ WARNING    
1582 The Internet standard RFC 5280 has defined a profile on conforming X\&amp;.509 certificates, which includes what values and value combinations are valid for certificate fields and extensions\&amp;. See the standard at http://tools\&amp;.ietf\&amp;.org/rfc/rfc5280\&amp;.txt
1583 .PP
1584 The \f3keytool\fR command does not enforce all of these rules so it can generate certificates that do not conform to the standard\&amp;. Certificates that do not conform to the standard might be rejected by JRE or other applications\&amp;. Users should ensure that they provide the correct options for \f3-dname\fR, \f3-ext\fR, and so on\&amp;.
1585 .SH NOTES    
1586 .SS IMPORT\ A\ NEW\ TRUSTED\ CERTIFICATE    
1587 Before you add the certificate to the keystore, the \f3keytool\fR command verifies it by attempting to construct a chain of trust from that certificate to a self-signed certificate (belonging to a root CA), using trusted certificates that are already available in the keystore\&amp;.
1588 .PP
1589 If the \f3-trustcacerts\fR option was specified, then additional certificates are considered for the chain of trust, namely the certificates in a file named \f3cacerts\fR\&amp;.
1590 .PP
1591 If the \f3keytool\fR command fails to establish a trust path from the certificate to be imported up to a self-signed certificate (either from the keystore or the \f3cacerts\fR file), then the certificate information is printed, and the user is prompted to verify it by comparing the displayed certificate fingerprints with the fingerprints obtained from some other (trusted) source of information, which might be the certificate owner\&amp;. Be very careful to ensure the certificate is valid before importing it as a trusted certificate\&amp;. See Importing Trusted Certificates Warning\&amp;. The user then has the option of stopping the import operation\&amp;. If the \f3-noprompt\fR option is specified, then there is no interaction with the user\&amp;.
1592 .SS IMPORT\ A\ CERTIFICATE\ REPLY    
1593 When you import a certificate reply, the certificate reply is validated with trusted certificates from the keystore, and optionally, the certificates configured in the \f3cacerts\fR keystore file when the \f3-trustcacert\fR\f3s\fR option is specified\&amp;. See The cacerts Certificates File\&amp;.
1594 .PP
1595 The methods of determining whether the certificate reply is trusted are as follows:
1596 .TP 0.2i    
1597 \(bu
1598 If the reply is a single X\&amp;.509 certificate, then the \f3keytool\fR command attempts to establish a trust chain, starting at the certificate reply and ending at a self-signed certificate (belonging to a root CA)\&amp;. The certificate reply and the hierarchy of certificates is used to authenticate the certificate reply from the new certificate chain of aliases\&amp;. If a trust chain cannot be established, then the certificate reply is not imported\&amp;. In this case, the \f3keytool\fR command does not print the certificate and prompt the user to verify it, because it is very difficult for a user to determine the authenticity of the certificate reply\&amp;.
1599 .TP 0.2i    
1600 \(bu
1601 If the reply is a PKCS #7 formatted certificate chain or a sequence of X\&amp;.509 certificates, then the chain is ordered with the user certificate first followed by zero or more CA certificates\&amp;. If the chain ends with a self-signed root CA certificate and the\f3-trustcacerts\fR option was specified, the \f3keytool\fR command attempts to match it with any of the trusted certificates in the keystore or the \f3cacerts\fR keystore file\&amp;. If the chain does not end with a self-signed root CA certificate and the \f3-trustcacerts\fR option was specified, the \f3keytool\fR command tries to find one from the trusted certificates in the keystore or the \f3cacerts\fR keystore file and add it to the end of the chain\&amp;. If the certificate is not found and the \f3-noprompt\fR option is not specified, the information of the last certificate in the chain is printed, and the user is prompted to verify it\&amp;.
1602 .PP
1603 If the public key in the certificate reply matches the user\&amp;&#39;s public key already stored with \f3alias\fR, then the old certificate chain is replaced with the new certificate chain in the reply\&amp;. The old chain can only be replaced with a valid \f3keypass\fR, and so the password used to protect the private key of the entry is supplied\&amp;. If no password is provided, and the private key password is different from the keystore password, the user is prompted for it\&amp;.
1604 .PP
1605 This command was named \f3-import\fR in earlier releases\&amp;. This old name is still supported in this release\&amp;. The new name, \f3-importcert\fR, is preferred going forward\&amp;.
1606 .SH SEE\ ALSO    
1607 .TP 0.2i    
1608 \(bu
1609 jar(1)
1610 .TP 0.2i    
1611 \(bu
1612 jarsigner(1)
1613 .TP 0.2i    
1614 \(bu
1615 Trail: Security Features in Java SE at http://docs\&amp;.oracle\&amp;.com/javase/tutorial/security/index\&amp;.html
1616 .RE
1617 .br
1618 &#39;pl 8.5i
1619 &#39;bp
    </pre>
  </body>
</html>