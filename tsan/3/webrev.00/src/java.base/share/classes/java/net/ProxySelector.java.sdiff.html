<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/java/net/ProxySelector.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="ProtocolException.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="ServerSocket.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/net/ProxySelector.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2003, 2013, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 68     private static ProxySelector theProxySelector;
 69 
 70     static {
 71         try {
 72             Class&lt;?&gt; c = Class.forName(&quot;sun.net.spi.DefaultProxySelector&quot;);
 73             if (c != null &amp;&amp; ProxySelector.class.isAssignableFrom(c)) {
 74                 @SuppressWarnings(&quot;deprecation&quot;)
 75                 ProxySelector tmp = (ProxySelector) c.newInstance();
 76                 theProxySelector = tmp;
 77             }
 78         } catch (Exception e) {
 79             theProxySelector = null;
 80         }
 81     }
 82 
 83     /**
 84      * Gets the system-wide proxy selector.
 85      *
 86      * @throws  SecurityException
 87      *          If a security manager has been installed and it denies
<span class="line-modified"> 88      * {@link NetPermission}{@code (&quot;getProxySelector&quot;)}</span>
<span class="line-modified"> 89      * @see #setDefault(ProxySelector)</span>
<span class="line-modified"> 90      * @return the system-wide {@code ProxySelector}</span>
<span class="line-modified"> 91      * @since 1.5</span>
 92      */
 93     public static ProxySelector getDefault() {
 94         SecurityManager sm = System.getSecurityManager();
 95         if (sm != null) {
 96             sm.checkPermission(SecurityConstants.GET_PROXYSELECTOR_PERMISSION);
 97         }
 98         return theProxySelector;
 99     }
100 
101     /**
102      * Sets (or unsets) the system-wide proxy selector.
103      *
104      * Note: non-standard protocol handlers may ignore this setting.
105      *
106      * @param ps The HTTP proxy selector, or
107      *          {@code null} to unset the proxy selector.
108      *
109      * @throws  SecurityException
110      *          If a security manager has been installed and it denies
<span class="line-modified">111      * {@link NetPermission}{@code (&quot;setProxySelector&quot;)}</span>
112      *
113      * @see #getDefault()
114      * @since 1.5
115      */
116     public static void setDefault(ProxySelector ps) {
117         SecurityManager sm = System.getSecurityManager();
118         if (sm != null) {
119             sm.checkPermission(SecurityConstants.SET_PROXYSELECTOR_PERMISSION);
120         }
121         theProxySelector = ps;
122     }
123 
124     /**
125      * Selects all the applicable proxies based on the protocol to
126      * access the resource with and a destination address to access
127      * the resource at.
128      * The format of the URI is defined as follow:
129      * &lt;UL&gt;
130      * &lt;LI&gt;http URI for http connections&lt;/LI&gt;
131      * &lt;LI&gt;https URI for https connections
132      * &lt;LI&gt;{@code socket://host:port}&lt;br&gt;
133      *     for tcp client sockets connections&lt;/LI&gt;
134      * &lt;/UL&gt;
135      *
136      * @param   uri
137      *          The URI that a connection is required to
138      *
139      * @return  a List of Proxies. Each element in
140      *          the List is of type
141      *          {@link java.net.Proxy Proxy};
142      *          when no proxy is available, the list will
143      *          contain one element of type
144      *          {@link java.net.Proxy Proxy}
145      *          that represents a direct connection.
<span class="line-modified">146      * @throws IllegalArgumentException if the argument is null</span>


147      */
148     public abstract List&lt;Proxy&gt; select(URI uri);
149 
150     /**
151      * Called to indicate that a connection could not be established
152      * to a proxy/socks server. An implementation of this method can
153      * temporarily remove the proxies or reorder the sequence of
154      * proxies returned by {@link #select(URI)}, using the address
155      * and the IOException caught when trying to connect.
156      *
157      * @param   uri
158      *          The URI that the proxy at sa failed to serve.
159      * @param   sa
160      *          The socket address of the proxy/SOCKS server
161      *
162      * @param   ioe
163      *          The I/O exception thrown when the connect failed.
<span class="line-modified">164      * @throws IllegalArgumentException if either argument is null</span>
165      */
166     public abstract void connectFailed(URI uri, SocketAddress sa, IOException ioe);
167 
168     /**
169      * Returns a ProxySelector which uses the given proxy address for all HTTP
170      * and HTTPS requests. If proxy is {@code null} then proxying is disabled.
171      *
172      * @param proxyAddress
173      *        The address of the proxy
174      *
175      * @return a ProxySelector
176      *
177      * @since 9
178      */
179     public static ProxySelector of(InetSocketAddress proxyAddress) {
180         return new StaticProxySelector(proxyAddress);
181     }
182 
183     static class StaticProxySelector extends ProxySelector {
184         private static final List&lt;Proxy&gt; NO_PROXY_LIST = List.of(Proxy.NO_PROXY);
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 68     private static ProxySelector theProxySelector;
 69 
 70     static {
 71         try {
 72             Class&lt;?&gt; c = Class.forName(&quot;sun.net.spi.DefaultProxySelector&quot;);
 73             if (c != null &amp;&amp; ProxySelector.class.isAssignableFrom(c)) {
 74                 @SuppressWarnings(&quot;deprecation&quot;)
 75                 ProxySelector tmp = (ProxySelector) c.newInstance();
 76                 theProxySelector = tmp;
 77             }
 78         } catch (Exception e) {
 79             theProxySelector = null;
 80         }
 81     }
 82 
 83     /**
 84      * Gets the system-wide proxy selector.
 85      *
 86      * @throws  SecurityException
 87      *          If a security manager has been installed and it denies
<span class="line-modified"> 88      *          {@link NetPermission}{@code (&quot;getProxySelector&quot;)}</span>
<span class="line-modified"> 89      * @see     #setDefault(ProxySelector)</span>
<span class="line-modified"> 90      * @return  the system-wide {@code ProxySelector}</span>
<span class="line-modified"> 91      * @since   1.5</span>
 92      */
 93     public static ProxySelector getDefault() {
 94         SecurityManager sm = System.getSecurityManager();
 95         if (sm != null) {
 96             sm.checkPermission(SecurityConstants.GET_PROXYSELECTOR_PERMISSION);
 97         }
 98         return theProxySelector;
 99     }
100 
101     /**
102      * Sets (or unsets) the system-wide proxy selector.
103      *
104      * Note: non-standard protocol handlers may ignore this setting.
105      *
106      * @param ps The HTTP proxy selector, or
107      *          {@code null} to unset the proxy selector.
108      *
109      * @throws  SecurityException
110      *          If a security manager has been installed and it denies
<span class="line-modified">111      *          {@link NetPermission}{@code (&quot;setProxySelector&quot;)}</span>
112      *
113      * @see #getDefault()
114      * @since 1.5
115      */
116     public static void setDefault(ProxySelector ps) {
117         SecurityManager sm = System.getSecurityManager();
118         if (sm != null) {
119             sm.checkPermission(SecurityConstants.SET_PROXYSELECTOR_PERMISSION);
120         }
121         theProxySelector = ps;
122     }
123 
124     /**
125      * Selects all the applicable proxies based on the protocol to
126      * access the resource with and a destination address to access
127      * the resource at.
128      * The format of the URI is defined as follow:
129      * &lt;UL&gt;
130      * &lt;LI&gt;http URI for http connections&lt;/LI&gt;
131      * &lt;LI&gt;https URI for https connections
132      * &lt;LI&gt;{@code socket://host:port}&lt;br&gt;
133      *     for tcp client sockets connections&lt;/LI&gt;
134      * &lt;/UL&gt;
135      *
136      * @param   uri
137      *          The URI that a connection is required to
138      *
139      * @return  a List of Proxies. Each element in
140      *          the List is of type
141      *          {@link java.net.Proxy Proxy};
142      *          when no proxy is available, the list will
143      *          contain one element of type
144      *          {@link java.net.Proxy Proxy}
145      *          that represents a direct connection.
<span class="line-modified">146      * @throws IllegalArgumentException if the argument is null or if</span>
<span class="line-added">147      *         the protocol or host cannot be determined from the provided</span>
<span class="line-added">148      *         {@code uri}</span>
149      */
150     public abstract List&lt;Proxy&gt; select(URI uri);
151 
152     /**
153      * Called to indicate that a connection could not be established
154      * to a proxy/socks server. An implementation of this method can
155      * temporarily remove the proxies or reorder the sequence of
156      * proxies returned by {@link #select(URI)}, using the address
157      * and the IOException caught when trying to connect.
158      *
159      * @param   uri
160      *          The URI that the proxy at sa failed to serve.
161      * @param   sa
162      *          The socket address of the proxy/SOCKS server
163      *
164      * @param   ioe
165      *          The I/O exception thrown when the connect failed.
<span class="line-modified">166      * @throws  IllegalArgumentException if either argument is null</span>
167      */
168     public abstract void connectFailed(URI uri, SocketAddress sa, IOException ioe);
169 
170     /**
171      * Returns a ProxySelector which uses the given proxy address for all HTTP
172      * and HTTPS requests. If proxy is {@code null} then proxying is disabled.
173      *
174      * @param proxyAddress
175      *        The address of the proxy
176      *
177      * @return a ProxySelector
178      *
179      * @since 9
180      */
181     public static ProxySelector of(InetSocketAddress proxyAddress) {
182         return new StaticProxySelector(proxyAddress);
183     }
184 
185     static class StaticProxySelector extends ProxySelector {
186         private static final List&lt;Proxy&gt; NO_PROXY_LIST = List.of(Proxy.NO_PROXY);
</pre>
</td>
</tr>
</table>
<center><a href="ProtocolException.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="ServerSocket.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>