<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/java/util/Optional.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="Objects.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="PriorityQueue.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/util/Optional.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 44  *
 45  * &lt;p&gt;This is a &lt;a href=&quot;../lang/doc-files/ValueBased.html&quot;&gt;value-based&lt;/a&gt;
 46  * class; use of identity-sensitive operations (including reference equality
 47  * ({@code ==}), identity hash code, or synchronization) on instances of
 48  * {@code Optional} may have unpredictable results and should be avoided.
 49  *
 50  * @apiNote
 51  * {@code Optional} is primarily intended for use as a method return type where
 52  * there is a clear need to represent &quot;no result,&quot; and where using {@code null}
 53  * is likely to cause errors. A variable whose type is {@code Optional} should
 54  * never itself be {@code null}; it should always point to an {@code Optional}
 55  * instance.
 56  *
 57  * @param &lt;T&gt; the type of value
 58  * @since 1.8
 59  */
 60 public final class Optional&lt;T&gt; {
 61     /**
 62      * Common instance for {@code empty()}.
 63      */
<span class="line-modified"> 64     private static final Optional&lt;?&gt; EMPTY = new Optional&lt;&gt;();</span>
 65 
 66     /**
 67      * If non-null, the value; if null, indicates no value is present
 68      */
 69     private final T value;
 70 
<span class="line-removed"> 71     /**</span>
<span class="line-removed"> 72      * Constructs an empty instance.</span>
<span class="line-removed"> 73      *</span>
<span class="line-removed"> 74      * @implNote Generally only one empty instance, {@link Optional#EMPTY},</span>
<span class="line-removed"> 75      * should exist per VM.</span>
<span class="line-removed"> 76      */</span>
<span class="line-removed"> 77     private Optional() {</span>
<span class="line-removed"> 78         this.value = null;</span>
<span class="line-removed"> 79     }</span>
<span class="line-removed"> 80 </span>
 81     /**
 82      * Returns an empty {@code Optional} instance.  No value is present for this
 83      * {@code Optional}.
 84      *
 85      * @apiNote
 86      * Though it may be tempting to do so, avoid testing if an object is empty
 87      * by comparing with {@code ==} against instances returned by
 88      * {@code Optional.empty()}.  There is no guarantee that it is a singleton.
 89      * Instead, use {@link #isPresent()}.
 90      *
 91      * @param &lt;T&gt; The type of the non-existent value
 92      * @return an empty {@code Optional}
 93      */
 94     public static&lt;T&gt; Optional&lt;T&gt; empty() {
 95         @SuppressWarnings(&quot;unchecked&quot;)
 96         Optional&lt;T&gt; t = (Optional&lt;T&gt;) EMPTY;
 97         return t;
 98     }
 99 
100     /**
101      * Constructs an instance with the described value.
102      *
<span class="line-modified">103      * @param value the non-{@code null} value to describe</span>
<span class="line-modified">104      * @throws NullPointerException if value is {@code null}</span>

105      */
106     private Optional(T value) {
<span class="line-modified">107         this.value = Objects.requireNonNull(value);</span>
108     }
109 
110     /**
111      * Returns an {@code Optional} describing the given non-{@code null}
112      * value.
113      *
114      * @param value the value to describe, which must be non-{@code null}
115      * @param &lt;T&gt; the type of the value
116      * @return an {@code Optional} with the value present
117      * @throws NullPointerException if value is {@code null}
118      */
119     public static &lt;T&gt; Optional&lt;T&gt; of(T value) {
<span class="line-modified">120         return new Optional&lt;&gt;(value);</span>
121     }
122 
123     /**
124      * Returns an {@code Optional} describing the given value, if
125      * non-{@code null}, otherwise returns an empty {@code Optional}.
126      *
127      * @param value the possibly-{@code null} value to describe
128      * @param &lt;T&gt; the type of the value
129      * @return an {@code Optional} with a present value if the specified value
130      *         is non-{@code null}, otherwise an empty {@code Optional}
131      */

132     public static &lt;T&gt; Optional&lt;T&gt; ofNullable(T value) {
<span class="line-modified">133         return value == null ? empty() : of(value);</span>

134     }
135 
136     /**
137      * If a value is present, returns the value, otherwise throws
138      * {@code NoSuchElementException}.
139      *
140      * @apiNote
141      * The preferred alternative to this method is {@link #orElseThrow()}.
142      *
143      * @return the non-{@code null} value described by this {@code Optional}
144      * @throws NoSuchElementException if no value is present
145      */
146     public T get() {
147         if (value == null) {
148             throw new NoSuchElementException(&quot;No value present&quot;);
149         }
150         return value;
151     }
152 
153     /**
</pre>
</td>
<td>
<hr />
<pre>
 44  *
 45  * &lt;p&gt;This is a &lt;a href=&quot;../lang/doc-files/ValueBased.html&quot;&gt;value-based&lt;/a&gt;
 46  * class; use of identity-sensitive operations (including reference equality
 47  * ({@code ==}), identity hash code, or synchronization) on instances of
 48  * {@code Optional} may have unpredictable results and should be avoided.
 49  *
 50  * @apiNote
 51  * {@code Optional} is primarily intended for use as a method return type where
 52  * there is a clear need to represent &quot;no result,&quot; and where using {@code null}
 53  * is likely to cause errors. A variable whose type is {@code Optional} should
 54  * never itself be {@code null}; it should always point to an {@code Optional}
 55  * instance.
 56  *
 57  * @param &lt;T&gt; the type of value
 58  * @since 1.8
 59  */
 60 public final class Optional&lt;T&gt; {
 61     /**
 62      * Common instance for {@code empty()}.
 63      */
<span class="line-modified"> 64     private static final Optional&lt;?&gt; EMPTY = new Optional&lt;&gt;(null);</span>
 65 
 66     /**
 67      * If non-null, the value; if null, indicates no value is present
 68      */
 69     private final T value;
 70 










 71     /**
 72      * Returns an empty {@code Optional} instance.  No value is present for this
 73      * {@code Optional}.
 74      *
 75      * @apiNote
 76      * Though it may be tempting to do so, avoid testing if an object is empty
 77      * by comparing with {@code ==} against instances returned by
 78      * {@code Optional.empty()}.  There is no guarantee that it is a singleton.
 79      * Instead, use {@link #isPresent()}.
 80      *
 81      * @param &lt;T&gt; The type of the non-existent value
 82      * @return an empty {@code Optional}
 83      */
 84     public static&lt;T&gt; Optional&lt;T&gt; empty() {
 85         @SuppressWarnings(&quot;unchecked&quot;)
 86         Optional&lt;T&gt; t = (Optional&lt;T&gt;) EMPTY;
 87         return t;
 88     }
 89 
 90     /**
 91      * Constructs an instance with the described value.
 92      *
<span class="line-modified"> 93      * @param value the value to describe; it&#39;s the caller&#39;s responsibility to</span>
<span class="line-modified"> 94      *        ensure the value is non-{@code null} unless creating the singleton</span>
<span class="line-added"> 95      *        instance returned by {@code empty()}.</span>
 96      */
 97     private Optional(T value) {
<span class="line-modified"> 98         this.value = value;</span>
 99     }
100 
101     /**
102      * Returns an {@code Optional} describing the given non-{@code null}
103      * value.
104      *
105      * @param value the value to describe, which must be non-{@code null}
106      * @param &lt;T&gt; the type of the value
107      * @return an {@code Optional} with the value present
108      * @throws NullPointerException if value is {@code null}
109      */
110     public static &lt;T&gt; Optional&lt;T&gt; of(T value) {
<span class="line-modified">111         return new Optional&lt;&gt;(Objects.requireNonNull(value));</span>
112     }
113 
114     /**
115      * Returns an {@code Optional} describing the given value, if
116      * non-{@code null}, otherwise returns an empty {@code Optional}.
117      *
118      * @param value the possibly-{@code null} value to describe
119      * @param &lt;T&gt; the type of the value
120      * @return an {@code Optional} with a present value if the specified value
121      *         is non-{@code null}, otherwise an empty {@code Optional}
122      */
<span class="line-added">123     @SuppressWarnings(&quot;unchecked&quot;)</span>
124     public static &lt;T&gt; Optional&lt;T&gt; ofNullable(T value) {
<span class="line-modified">125         return value == null ? (Optional&lt;T&gt;) EMPTY</span>
<span class="line-added">126                              : new Optional&lt;&gt;(value);</span>
127     }
128 
129     /**
130      * If a value is present, returns the value, otherwise throws
131      * {@code NoSuchElementException}.
132      *
133      * @apiNote
134      * The preferred alternative to this method is {@link #orElseThrow()}.
135      *
136      * @return the non-{@code null} value described by this {@code Optional}
137      * @throws NoSuchElementException if no value is present
138      */
139     public T get() {
140         if (value == null) {
141             throw new NoSuchElementException(&quot;No value present&quot;);
142         }
143         return value;
144     }
145 
146     /**
</pre>
</td>
</tr>
</table>
<center><a href="Objects.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="PriorityQueue.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>