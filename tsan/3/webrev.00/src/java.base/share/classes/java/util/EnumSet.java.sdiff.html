<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/java/util/EnumSet.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="EnumMap.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="Enumeration.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/util/EnumSet.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2003, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 59  * method.  This is best done at creation time, to prevent accidental
 60  * unsynchronized access:
 61  *
 62  * &lt;pre&gt;
 63  * Set&amp;lt;MyEnum&amp;gt; s = Collections.synchronizedSet(EnumSet.noneOf(MyEnum.class));
 64  * &lt;/pre&gt;
 65  *
 66  * &lt;p&gt;Implementation note: All basic operations execute in constant time.
 67  * They are likely (though not guaranteed) to be much faster than their
 68  * {@link HashSet} counterparts.  Even bulk operations execute in
 69  * constant time if their argument is also an enum set.
 70  *
 71  * &lt;p&gt;This class is a member of the
 72  * &lt;a href=&quot;{@docRoot}/java.base/java/util/package-summary.html#CollectionsFramework&quot;&gt;
 73  * Java Collections Framework&lt;/a&gt;.
 74  *
 75  * @author Josh Bloch
 76  * @since 1.5
 77  * @see EnumMap
 78  */
<span class="line-removed"> 79 @SuppressWarnings(&quot;serial&quot;) // No serialVersionUID due to usage of</span>
<span class="line-removed"> 80                             // serial proxy pattern</span>
 81 public abstract class EnumSet&lt;E extends Enum&lt;E&gt;&gt; extends AbstractSet&lt;E&gt;
 82     implements Cloneable, java.io.Serializable
 83 {




 84     /**
 85      * The class of all the elements of this set.
 86      */
 87     final transient Class&lt;E&gt; elementType;
 88 
 89     /**
 90      * All of the values comprising E.  (Cached for performance.)
 91      */
 92     final transient Enum&lt;?&gt;[] universe;
 93 
 94     EnumSet(Class&lt;E&gt;elementType, Enum&lt;?&gt;[] universe) {
 95         this.elementType = elementType;
 96         this.universe    = universe;
 97     }
 98 
 99     /**
100      * Creates an empty enum set with the specified element type.
101      *
102      * @param &lt;E&gt; The class of the elements in the set
103      * @param elementType the class object of the element type for this enum
</pre>
<hr />
<pre>
431         /**
432          * The elements contained in this enum set.
433          *
434          * @serial
435          */
436         private final Enum&lt;?&gt;[] elements;
437 
438         SerializationProxy(EnumSet&lt;E&gt; set) {
439             elementType = set.elementType;
440             elements = set.toArray(ZERO_LENGTH_ENUM_ARRAY);
441         }
442 
443         /**
444          * Returns an {@code EnumSet} object with initial state
445          * held by this proxy.
446          *
447          * @return a {@code EnumSet} object with initial state
448          * held by this proxy
449          */
450         @SuppressWarnings(&quot;unchecked&quot;)

451         private Object readResolve() {
452             // instead of cast to E, we should perhaps use elementType.cast()
453             // to avoid injection of forged stream, but it will slow the
454             // implementation
455             EnumSet&lt;E&gt; result = EnumSet.noneOf(elementType);
456             for (Enum&lt;?&gt; e : elements)
457                 result.add((E)e);
458             return result;
459         }
460 

461         private static final long serialVersionUID = 362491234563181265L;
462     }
463 
464     /**
465      * Returns a
466      * &lt;a href=&quot;{@docRoot}/serialized-form.html#java.util.EnumSet.SerializationProxy&quot;&gt;
467      * SerializationProxy&lt;/a&gt;
468      * representing the state of this instance.
469      *
470      * @return a {@link SerializationProxy}
471      * representing the state of this instance
472      */

473     Object writeReplace() {
474         return new SerializationProxy&lt;&gt;(this);
475     }
476 
477     /**
478      * @param s the stream
479      * @throws java.io.InvalidObjectException always
480      */

481     private void readObject(java.io.ObjectInputStream s)
482         throws java.io.InvalidObjectException {
483         throw new java.io.InvalidObjectException(&quot;Proxy required&quot;);
484     }
485 }
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 59  * method.  This is best done at creation time, to prevent accidental
 60  * unsynchronized access:
 61  *
 62  * &lt;pre&gt;
 63  * Set&amp;lt;MyEnum&amp;gt; s = Collections.synchronizedSet(EnumSet.noneOf(MyEnum.class));
 64  * &lt;/pre&gt;
 65  *
 66  * &lt;p&gt;Implementation note: All basic operations execute in constant time.
 67  * They are likely (though not guaranteed) to be much faster than their
 68  * {@link HashSet} counterparts.  Even bulk operations execute in
 69  * constant time if their argument is also an enum set.
 70  *
 71  * &lt;p&gt;This class is a member of the
 72  * &lt;a href=&quot;{@docRoot}/java.base/java/util/package-summary.html#CollectionsFramework&quot;&gt;
 73  * Java Collections Framework&lt;/a&gt;.
 74  *
 75  * @author Josh Bloch
 76  * @since 1.5
 77  * @see EnumMap
 78  */


 79 public abstract class EnumSet&lt;E extends Enum&lt;E&gt;&gt; extends AbstractSet&lt;E&gt;
 80     implements Cloneable, java.io.Serializable
 81 {
<span class="line-added"> 82     // declare EnumSet.class serialization compatibility with JDK 8</span>
<span class="line-added"> 83     @java.io.Serial</span>
<span class="line-added"> 84     private static final long serialVersionUID = 1009687484059888093L;</span>
<span class="line-added"> 85 </span>
 86     /**
 87      * The class of all the elements of this set.
 88      */
 89     final transient Class&lt;E&gt; elementType;
 90 
 91     /**
 92      * All of the values comprising E.  (Cached for performance.)
 93      */
 94     final transient Enum&lt;?&gt;[] universe;
 95 
 96     EnumSet(Class&lt;E&gt;elementType, Enum&lt;?&gt;[] universe) {
 97         this.elementType = elementType;
 98         this.universe    = universe;
 99     }
100 
101     /**
102      * Creates an empty enum set with the specified element type.
103      *
104      * @param &lt;E&gt; The class of the elements in the set
105      * @param elementType the class object of the element type for this enum
</pre>
<hr />
<pre>
433         /**
434          * The elements contained in this enum set.
435          *
436          * @serial
437          */
438         private final Enum&lt;?&gt;[] elements;
439 
440         SerializationProxy(EnumSet&lt;E&gt; set) {
441             elementType = set.elementType;
442             elements = set.toArray(ZERO_LENGTH_ENUM_ARRAY);
443         }
444 
445         /**
446          * Returns an {@code EnumSet} object with initial state
447          * held by this proxy.
448          *
449          * @return a {@code EnumSet} object with initial state
450          * held by this proxy
451          */
452         @SuppressWarnings(&quot;unchecked&quot;)
<span class="line-added">453         @java.io.Serial</span>
454         private Object readResolve() {
455             // instead of cast to E, we should perhaps use elementType.cast()
456             // to avoid injection of forged stream, but it will slow the
457             // implementation
458             EnumSet&lt;E&gt; result = EnumSet.noneOf(elementType);
459             for (Enum&lt;?&gt; e : elements)
460                 result.add((E)e);
461             return result;
462         }
463 
<span class="line-added">464         @java.io.Serial</span>
465         private static final long serialVersionUID = 362491234563181265L;
466     }
467 
468     /**
469      * Returns a
470      * &lt;a href=&quot;{@docRoot}/serialized-form.html#java.util.EnumSet.SerializationProxy&quot;&gt;
471      * SerializationProxy&lt;/a&gt;
472      * representing the state of this instance.
473      *
474      * @return a {@link SerializationProxy}
475      * representing the state of this instance
476      */
<span class="line-added">477     @java.io.Serial</span>
478     Object writeReplace() {
479         return new SerializationProxy&lt;&gt;(this);
480     }
481 
482     /**
483      * @param s the stream
484      * @throws java.io.InvalidObjectException always
485      */
<span class="line-added">486     @java.io.Serial</span>
487     private void readObject(java.io.ObjectInputStream s)
488         throws java.io.InvalidObjectException {
489         throw new java.io.InvalidObjectException(&quot;Proxy required&quot;);
490     }
491 }
</pre>
</td>
</tr>
</table>
<center><a href="EnumMap.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="Enumeration.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>