<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/java/lang/invoke/MethodHandleStatics.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="MethodHandleProxies.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="MethodHandles.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/lang/invoke/MethodHandleStatics.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package java.lang.invoke;
 27 
 28 import jdk.internal.misc.Unsafe;
 29 import sun.security.action.GetPropertyAction;
 30 
 31 import java.util.Properties;
 32 
 33 /**
 34  * This class consists exclusively of static names internal to the
 35  * method handle implementation.
 36  * Usage:  {@code import static java.lang.invoke.MethodHandleStatics.*}
 37  * @author John Rose, JSR 292 EG
 38  */
<span class="line-modified"> 39 /*non-public*/ class MethodHandleStatics {</span>

 40 
 41     private MethodHandleStatics() { }  // do not instantiate
 42 
 43     static final Unsafe UNSAFE = Unsafe.getUnsafe();
 44 
 45     static final boolean DEBUG_METHOD_HANDLE_NAMES;
 46     static final boolean DUMP_CLASS_FILES;
 47     static final boolean TRACE_INTERPRETER;
 48     static final boolean TRACE_METHOD_LINKAGE;
 49     static final boolean TRACE_RESOLVE;
 50     static final int COMPILE_THRESHOLD;
 51     static final boolean LOG_LF_COMPILATION_FAILURE;
 52     static final int DONT_INLINE_THRESHOLD;
 53     static final int PROFILE_LEVEL;
 54     static final boolean PROFILE_GWT;
 55     static final int CUSTOMIZE_THRESHOLD;
 56     static final boolean VAR_HANDLE_GUARDS;
 57     static final int MAX_ARITY;
 58 
 59     static {
</pre>
<hr />
<pre>
 78                 props.getProperty(&quot;java.lang.invoke.MethodHandle.PROFILE_LEVEL&quot;, &quot;0&quot;));
 79         PROFILE_GWT = Boolean.parseBoolean(
 80                 props.getProperty(&quot;java.lang.invoke.MethodHandle.PROFILE_GWT&quot;, &quot;true&quot;));
 81         CUSTOMIZE_THRESHOLD = Integer.parseInt(
 82                 props.getProperty(&quot;java.lang.invoke.MethodHandle.CUSTOMIZE_THRESHOLD&quot;, &quot;127&quot;));
 83         VAR_HANDLE_GUARDS = Boolean.parseBoolean(
 84                 props.getProperty(&quot;java.lang.invoke.VarHandle.VAR_HANDLE_GUARDS&quot;, &quot;true&quot;));
 85 
 86         // Do not adjust this except for special platforms:
 87         MAX_ARITY = Integer.parseInt(
 88                 props.getProperty(&quot;java.lang.invoke.MethodHandleImpl.MAX_ARITY&quot;, &quot;255&quot;));
 89 
 90         if (CUSTOMIZE_THRESHOLD &lt; -1 || CUSTOMIZE_THRESHOLD &gt; 127) {
 91             throw newInternalError(&quot;CUSTOMIZE_THRESHOLD should be in [-1...127] range&quot;);
 92         }
 93     }
 94 
 95     /** Tell if any of the debugging switches are turned on.
 96      *  If this is the case, it is reasonable to perform extra checks or save extra information.
 97      */
<span class="line-modified"> 98     /*non-public*/ static boolean debugEnabled() {</span>

 99         return (DEBUG_METHOD_HANDLE_NAMES |
100                 DUMP_CLASS_FILES |
101                 TRACE_INTERPRETER |
102                 TRACE_METHOD_LINKAGE |
103                 LOG_LF_COMPILATION_FAILURE);
104     }
105 
106     // handy shared exception makers (they simplify the common case code)
<span class="line-modified">107     /*non-public*/ static InternalError newInternalError(String message) {</span>

108         return new InternalError(message);
109     }
<span class="line-modified">110     /*non-public*/ static InternalError newInternalError(String message, Exception cause) {</span>

111         return new InternalError(message, cause);
112     }
<span class="line-modified">113     /*non-public*/ static InternalError newInternalError(Exception cause) {</span>

114         return new InternalError(cause);
115     }
<span class="line-modified">116     /*non-public*/ static RuntimeException newIllegalStateException(String message) {</span>

117         return new IllegalStateException(message);
118     }
<span class="line-modified">119     /*non-public*/ static RuntimeException newIllegalStateException(String message, Object obj) {</span>

120         return new IllegalStateException(message(message, obj));
121     }
<span class="line-modified">122     /*non-public*/ static RuntimeException newIllegalArgumentException(String message) {</span>

123         return new IllegalArgumentException(message);
124     }
<span class="line-modified">125     /*non-public*/ static RuntimeException newIllegalArgumentException(String message, Object obj) {</span>

126         return new IllegalArgumentException(message(message, obj));
127     }
<span class="line-modified">128     /*non-public*/ static RuntimeException newIllegalArgumentException(String message, Object obj, Object obj2) {</span>

129         return new IllegalArgumentException(message(message, obj, obj2));
130     }
131     /** Propagate unchecked exceptions and errors, but wrap anything checked and throw that instead. */
<span class="line-modified">132     /*non-public*/ static Error uncaughtException(Throwable ex) {</span>

133         if (ex instanceof Error)  throw (Error) ex;
134         if (ex instanceof RuntimeException)  throw (RuntimeException) ex;
135         throw new InternalError(&quot;uncaught exception&quot;, ex);
136     }
137     private static String message(String message, Object obj) {
138         if (obj != null)  message = message + &quot;: &quot; + obj;
139         return message;
140     }
141     private static String message(String message, Object obj, Object obj2) {
142         if (obj != null || obj2 != null)  message = message + &quot;: &quot; + obj + &quot;, &quot; + obj2;
143         return message;
144     }
<span class="line-modified">145     /*non-public*/ static void rangeCheck2(int start, int end, int size) {</span>

146         if (0 &gt; start || start &gt; end || end &gt; size)
147             throw new IndexOutOfBoundsException(start+&quot;..&quot;+end);
148     }
<span class="line-modified">149     /*non-public*/ static int rangeCheck1(int index, int size) {</span>

150         if (0 &gt; index || index &gt;= size)
151             throw new IndexOutOfBoundsException(index);
152         return index;
153     }
154 }
</pre>
</td>
<td>
<hr />
<pre>
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package java.lang.invoke;
 27 
 28 import jdk.internal.misc.Unsafe;
 29 import sun.security.action.GetPropertyAction;
 30 
 31 import java.util.Properties;
 32 
 33 /**
 34  * This class consists exclusively of static names internal to the
 35  * method handle implementation.
 36  * Usage:  {@code import static java.lang.invoke.MethodHandleStatics.*}
 37  * @author John Rose, JSR 292 EG
 38  */
<span class="line-modified"> 39 /*non-public*/</span>
<span class="line-added"> 40 class MethodHandleStatics {</span>
 41 
 42     private MethodHandleStatics() { }  // do not instantiate
 43 
 44     static final Unsafe UNSAFE = Unsafe.getUnsafe();
 45 
 46     static final boolean DEBUG_METHOD_HANDLE_NAMES;
 47     static final boolean DUMP_CLASS_FILES;
 48     static final boolean TRACE_INTERPRETER;
 49     static final boolean TRACE_METHOD_LINKAGE;
 50     static final boolean TRACE_RESOLVE;
 51     static final int COMPILE_THRESHOLD;
 52     static final boolean LOG_LF_COMPILATION_FAILURE;
 53     static final int DONT_INLINE_THRESHOLD;
 54     static final int PROFILE_LEVEL;
 55     static final boolean PROFILE_GWT;
 56     static final int CUSTOMIZE_THRESHOLD;
 57     static final boolean VAR_HANDLE_GUARDS;
 58     static final int MAX_ARITY;
 59 
 60     static {
</pre>
<hr />
<pre>
 79                 props.getProperty(&quot;java.lang.invoke.MethodHandle.PROFILE_LEVEL&quot;, &quot;0&quot;));
 80         PROFILE_GWT = Boolean.parseBoolean(
 81                 props.getProperty(&quot;java.lang.invoke.MethodHandle.PROFILE_GWT&quot;, &quot;true&quot;));
 82         CUSTOMIZE_THRESHOLD = Integer.parseInt(
 83                 props.getProperty(&quot;java.lang.invoke.MethodHandle.CUSTOMIZE_THRESHOLD&quot;, &quot;127&quot;));
 84         VAR_HANDLE_GUARDS = Boolean.parseBoolean(
 85                 props.getProperty(&quot;java.lang.invoke.VarHandle.VAR_HANDLE_GUARDS&quot;, &quot;true&quot;));
 86 
 87         // Do not adjust this except for special platforms:
 88         MAX_ARITY = Integer.parseInt(
 89                 props.getProperty(&quot;java.lang.invoke.MethodHandleImpl.MAX_ARITY&quot;, &quot;255&quot;));
 90 
 91         if (CUSTOMIZE_THRESHOLD &lt; -1 || CUSTOMIZE_THRESHOLD &gt; 127) {
 92             throw newInternalError(&quot;CUSTOMIZE_THRESHOLD should be in [-1...127] range&quot;);
 93         }
 94     }
 95 
 96     /** Tell if any of the debugging switches are turned on.
 97      *  If this is the case, it is reasonable to perform extra checks or save extra information.
 98      */
<span class="line-modified"> 99     /*non-public*/</span>
<span class="line-added">100     static boolean debugEnabled() {</span>
101         return (DEBUG_METHOD_HANDLE_NAMES |
102                 DUMP_CLASS_FILES |
103                 TRACE_INTERPRETER |
104                 TRACE_METHOD_LINKAGE |
105                 LOG_LF_COMPILATION_FAILURE);
106     }
107 
108     // handy shared exception makers (they simplify the common case code)
<span class="line-modified">109     /*non-public*/</span>
<span class="line-added">110     static InternalError newInternalError(String message) {</span>
111         return new InternalError(message);
112     }
<span class="line-modified">113     /*non-public*/</span>
<span class="line-added">114     static InternalError newInternalError(String message, Exception cause) {</span>
115         return new InternalError(message, cause);
116     }
<span class="line-modified">117     /*non-public*/</span>
<span class="line-added">118     static InternalError newInternalError(Exception cause) {</span>
119         return new InternalError(cause);
120     }
<span class="line-modified">121     /*non-public*/</span>
<span class="line-added">122     static RuntimeException newIllegalStateException(String message) {</span>
123         return new IllegalStateException(message);
124     }
<span class="line-modified">125     /*non-public*/</span>
<span class="line-added">126     static RuntimeException newIllegalStateException(String message, Object obj) {</span>
127         return new IllegalStateException(message(message, obj));
128     }
<span class="line-modified">129     /*non-public*/</span>
<span class="line-added">130     static RuntimeException newIllegalArgumentException(String message) {</span>
131         return new IllegalArgumentException(message);
132     }
<span class="line-modified">133     /*non-public*/</span>
<span class="line-added">134     static RuntimeException newIllegalArgumentException(String message, Object obj) {</span>
135         return new IllegalArgumentException(message(message, obj));
136     }
<span class="line-modified">137     /*non-public*/</span>
<span class="line-added">138     static RuntimeException newIllegalArgumentException(String message, Object obj, Object obj2) {</span>
139         return new IllegalArgumentException(message(message, obj, obj2));
140     }
141     /** Propagate unchecked exceptions and errors, but wrap anything checked and throw that instead. */
<span class="line-modified">142     /*non-public*/</span>
<span class="line-added">143     static Error uncaughtException(Throwable ex) {</span>
144         if (ex instanceof Error)  throw (Error) ex;
145         if (ex instanceof RuntimeException)  throw (RuntimeException) ex;
146         throw new InternalError(&quot;uncaught exception&quot;, ex);
147     }
148     private static String message(String message, Object obj) {
149         if (obj != null)  message = message + &quot;: &quot; + obj;
150         return message;
151     }
152     private static String message(String message, Object obj, Object obj2) {
153         if (obj != null || obj2 != null)  message = message + &quot;: &quot; + obj + &quot;, &quot; + obj2;
154         return message;
155     }
<span class="line-modified">156     /*non-public*/</span>
<span class="line-added">157     static void rangeCheck2(int start, int end, int size) {</span>
158         if (0 &gt; start || start &gt; end || end &gt; size)
159             throw new IndexOutOfBoundsException(start+&quot;..&quot;+end);
160     }
<span class="line-modified">161     /*non-public*/</span>
<span class="line-added">162     static int rangeCheck1(int index, int size) {</span>
163         if (0 &gt; index || index &gt;= size)
164             throw new IndexOutOfBoundsException(index);
165         return index;
166     }
167 }
</pre>
</td>
</tr>
</table>
<center><a href="MethodHandleProxies.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="MethodHandles.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>