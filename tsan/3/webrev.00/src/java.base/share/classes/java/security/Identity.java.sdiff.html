<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/java/security/Identity.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="GuardedObject.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="IdentityScope.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/security/Identity.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 1996, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 45  *
 46  * &lt;p&gt;An Identity can be subclassed, to include postal and email addresses,
 47  * telephone numbers, images of faces and logos, and so on.
 48  *
 49  * @see IdentityScope
 50  * @see Signer
 51  * @see Principal
 52  *
 53  * @author Benjamin Renaud
 54  * @since 1.1
 55  * @deprecated This class is deprecated and subject to removal in a future
 56  *     version of Java SE. It has been replaced by
 57  *     {@code java.security.KeyStore}, the {@code java.security.cert} package,
 58  *     and {@code java.security.Principal}.
 59  */
 60 @Deprecated(since=&quot;1.2&quot;, forRemoval=true)
 61 @SuppressWarnings(&quot;removal&quot;)
 62 public abstract class Identity implements Principal, Serializable {
 63 
 64     /** use serialVersionUID from JDK 1.1.x for interoperability */

 65     private static final long serialVersionUID = 3609922007826600659L;
 66 
 67     /**
 68      * The name for this identity.
 69      *
 70      * @serial
 71      */
 72     private String name;
 73 
 74     /**
 75      * The public key for this identity.
 76      *
 77      * @serial
 78      */
 79     private PublicKey publicKey;
 80 
 81     /**
 82      * Generic, descriptive information about the identity.
 83      *
 84      * @serial
</pre>
<hr />
<pre>
 95     /**
 96      * The certificates for this identity.
 97      *
 98      * @serial
 99      */
100     Vector&lt;Certificate&gt; certificates;
101 
102     /**
103      * Constructor for serialization only.
104      */
105     protected Identity() {
106         this(&quot;restoring...&quot;);
107     }
108 
109     /**
110      * Constructs an identity with the specified name and scope.
111      *
112      * @param name the identity name.
113      * @param scope the scope of the identity.
114      *
<span class="line-modified">115      * @exception KeyManagementException if there is already an identity</span>
116      * with the same name in the scope.
117      */
118     public Identity(String name, IdentityScope scope) throws
119     KeyManagementException {
120         this(name);
121         if (scope != null) {
122             scope.addIdentity(this);
123         }
124         this.scope = scope;
125     }
126 
127     /**
128      * Constructs an identity with the specified name and no scope.
129      *
130      * @param name the identity name.
131      */
132     public Identity(String name) {
133         this.name = name;
134     }
135 
</pre>
<hr />
<pre>
155      * Returns this identity&#39;s public key.
156      *
157      * @return the public key for this identity.
158      *
159      * @see #setPublicKey
160      */
161     public PublicKey getPublicKey() {
162         return publicKey;
163     }
164 
165     /**
166      * Sets this identity&#39;s public key. The old key and all of this
167      * identity&#39;s certificates are removed by this operation.
168      *
169      * &lt;p&gt;First, if there is a security manager, its {@code checkSecurityAccess}
170      * method is called with {@code &quot;setIdentityPublicKey&quot;}
171      * as its argument to see if it&#39;s ok to set the public key.
172      *
173      * @param key the public key for this identity.
174      *
<span class="line-modified">175      * @exception KeyManagementException if another identity in the</span>
176      * identity&#39;s scope has the same public key, or if another exception occurs.
177      *
<span class="line-modified">178      * @exception  SecurityException  if a security manager exists and its</span>
179      * {@code checkSecurityAccess} method doesn&#39;t allow
180      * setting the public key.
181      *
182      * @see #getPublicKey
183      * @see SecurityManager#checkSecurityAccess
184      */
185     /* Should we throw an exception if this is already set? */
186     public void setPublicKey(PublicKey key) throws KeyManagementException {
187 
188         check(&quot;setIdentityPublicKey&quot;);
189         this.publicKey = key;
190         certificates = new Vector&lt;&gt;();
191     }
192 
193     /**
194      * Specifies a general information string for this identity.
195      *
196      * &lt;p&gt;First, if there is a security manager, its {@code checkSecurityAccess}
197      * method is called with {@code &quot;setIdentityInfo&quot;}
198      * as its argument to see if it&#39;s ok to specify the information string.
199      *
200      * @param info the information string.
201      *
<span class="line-modified">202      * @exception  SecurityException  if a security manager exists and its</span>
203      * {@code checkSecurityAccess} method doesn&#39;t allow
204      * setting the information string.
205      *
206      * @see #getInfo
207      * @see SecurityManager#checkSecurityAccess
208      */
209     public void setInfo(String info) {
210         check(&quot;setIdentityInfo&quot;);
211         this.info = info;
212     }
213 
214     /**
215      * Returns general information previously specified for this identity.
216      *
217      * @return general information about this identity.
218      *
219      * @see #setInfo
220      */
221     public String getInfo() {
222         return info;
223     }
224 
225     /**
226      * Adds a certificate for this identity. If the identity has a public
227      * key, the public key in the certificate must be the same, and if
228      * the identity does not have a public key, the identity&#39;s
229      * public key is set to be that specified in the certificate.
230      *
231      * &lt;p&gt;First, if there is a security manager, its {@code checkSecurityAccess}
232      * method is called with {@code &quot;addIdentityCertificate&quot;}
233      * as its argument to see if it&#39;s ok to add a certificate.
234      *
235      * @param certificate the certificate to be added.
236      *
<span class="line-modified">237      * @exception KeyManagementException if the certificate is not valid,</span>
238      * if the public key in the certificate being added conflicts with
239      * this identity&#39;s public key, or if another exception occurs.
240      *
<span class="line-modified">241      * @exception  SecurityException  if a security manager exists and its</span>
242      * {@code checkSecurityAccess} method doesn&#39;t allow
243      * adding a certificate.
244      *
245      * @see SecurityManager#checkSecurityAccess
246      */
247     public void addCertificate(Certificate certificate)
248     throws KeyManagementException {
249 
250         check(&quot;addIdentityCertificate&quot;);
251 
252         if (certificates == null) {
253             certificates = new Vector&lt;&gt;();
254         }
255         if (publicKey != null) {
256             if (!keyEquals(publicKey, certificate.getPublicKey())) {
257                 throw new KeyManagementException(
258                     &quot;public key different from cert public key&quot;);
259             }
260         } else {
261             publicKey = certificate.getPublicKey();
</pre>
<hr />
<pre>
268         String anotherKeyFormat = anotherKey.getFormat();
269         if ((aKeyFormat == null) ^ (anotherKeyFormat == null))
270             return false;
271         if (aKeyFormat != null &amp;&amp; anotherKeyFormat != null)
272             if (!aKeyFormat.equalsIgnoreCase(anotherKeyFormat))
273                 return false;
274         return java.util.Arrays.equals(aKey.getEncoded(),
275                                      anotherKey.getEncoded());
276     }
277 
278 
279     /**
280      * Removes a certificate from this identity.
281      *
282      * &lt;p&gt;First, if there is a security manager, its {@code checkSecurityAccess}
283      * method is called with {@code &quot;removeIdentityCertificate&quot;}
284      * as its argument to see if it&#39;s ok to remove a certificate.
285      *
286      * @param certificate the certificate to be removed.
287      *
<span class="line-modified">288      * @exception KeyManagementException if the certificate is</span>
289      * missing, or if another exception occurs.
290      *
<span class="line-modified">291      * @exception  SecurityException  if a security manager exists and its</span>
292      * {@code checkSecurityAccess} method doesn&#39;t allow
293      * removing a certificate.
294      *
295      * @see SecurityManager#checkSecurityAccess
296      */
297     public void removeCertificate(Certificate certificate)
298     throws KeyManagementException {
299         check(&quot;removeIdentityCertificate&quot;);
300         if (certificates != null) {
301             certificates.removeElement(certificate);
302         }
303     }
304 
305     /**
306      * Returns a copy of all the certificates for this identity.
307      *
308      * @return a copy of all the certificates for this identity.
309      */
310     public Certificate[] certificates() {
311         if (certificates == null) {
</pre>
<hr />
<pre>
382      */
383     String fullName() {
384         String parsable = name;
385         if (scope != null) {
386             parsable += &quot;.&quot; + scope.getName();
387         }
388         return parsable;
389     }
390 
391     /**
392      * Returns a short string describing this identity, telling its
393      * name and its scope (if any).
394      *
395      * &lt;p&gt;First, if there is a security manager, its {@code checkSecurityAccess}
396      * method is called with {@code &quot;printIdentity&quot;}
397      * as its argument to see if it&#39;s ok to return the string.
398      *
399      * @return information about this identity, such as its name and the
400      * name of its scope (if any).
401      *
<span class="line-modified">402      * @exception  SecurityException  if a security manager exists and its</span>
403      * {@code checkSecurityAccess} method doesn&#39;t allow
404      * returning a string describing this identity.
405      *
406      * @see SecurityManager#checkSecurityAccess
407      */
408     public String toString() {
409         check(&quot;printIdentity&quot;);
410         String printable = name;
411         if (scope != null) {
412             printable += &quot;[&quot; + scope.getName() + &quot;]&quot;;
413         }
414         return printable;
415     }
416 
417     /**
418      * Returns a string representation of this identity, with
419      * optionally more details than that provided by the
420      * {@code toString} method without any arguments.
421      *
422      * &lt;p&gt;First, if there is a security manager, its {@code checkSecurityAccess}
423      * method is called with {@code &quot;printIdentity&quot;}
424      * as its argument to see if it&#39;s ok to return the string.
425      *
426      * @param detailed whether or not to provide detailed information.
427      *
428      * @return information about this identity. If {@code detailed}
429      * is true, then this method returns more information than that
430      * provided by the {@code toString} method without any arguments.
431      *
<span class="line-modified">432      * @exception  SecurityException  if a security manager exists and its</span>
433      * {@code checkSecurityAccess} method doesn&#39;t allow
434      * returning a string describing this identity.
435      *
436      * @see #toString
437      * @see SecurityManager#checkSecurityAccess
438      */
439     public String toString(boolean detailed) {
440         String out = toString();
441         if (detailed) {
442             out += &quot;\n&quot;;
443             out += printKeys();
444             out += &quot;\n&quot; + printCertificates();
445             if (info != null) {
446                 out += &quot;\n\t&quot; + info;
447             } else {
448                 out += &quot;\n\tno additional information available.&quot;;
449             }
450         }
451         return out;
452     }
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 1996, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 45  *
 46  * &lt;p&gt;An Identity can be subclassed, to include postal and email addresses,
 47  * telephone numbers, images of faces and logos, and so on.
 48  *
 49  * @see IdentityScope
 50  * @see Signer
 51  * @see Principal
 52  *
 53  * @author Benjamin Renaud
 54  * @since 1.1
 55  * @deprecated This class is deprecated and subject to removal in a future
 56  *     version of Java SE. It has been replaced by
 57  *     {@code java.security.KeyStore}, the {@code java.security.cert} package,
 58  *     and {@code java.security.Principal}.
 59  */
 60 @Deprecated(since=&quot;1.2&quot;, forRemoval=true)
 61 @SuppressWarnings(&quot;removal&quot;)
 62 public abstract class Identity implements Principal, Serializable {
 63 
 64     /** use serialVersionUID from JDK 1.1.x for interoperability */
<span class="line-added"> 65     @java.io.Serial</span>
 66     private static final long serialVersionUID = 3609922007826600659L;
 67 
 68     /**
 69      * The name for this identity.
 70      *
 71      * @serial
 72      */
 73     private String name;
 74 
 75     /**
 76      * The public key for this identity.
 77      *
 78      * @serial
 79      */
 80     private PublicKey publicKey;
 81 
 82     /**
 83      * Generic, descriptive information about the identity.
 84      *
 85      * @serial
</pre>
<hr />
<pre>
 96     /**
 97      * The certificates for this identity.
 98      *
 99      * @serial
100      */
101     Vector&lt;Certificate&gt; certificates;
102 
103     /**
104      * Constructor for serialization only.
105      */
106     protected Identity() {
107         this(&quot;restoring...&quot;);
108     }
109 
110     /**
111      * Constructs an identity with the specified name and scope.
112      *
113      * @param name the identity name.
114      * @param scope the scope of the identity.
115      *
<span class="line-modified">116      * @throws    KeyManagementException if there is already an identity</span>
117      * with the same name in the scope.
118      */
119     public Identity(String name, IdentityScope scope) throws
120     KeyManagementException {
121         this(name);
122         if (scope != null) {
123             scope.addIdentity(this);
124         }
125         this.scope = scope;
126     }
127 
128     /**
129      * Constructs an identity with the specified name and no scope.
130      *
131      * @param name the identity name.
132      */
133     public Identity(String name) {
134         this.name = name;
135     }
136 
</pre>
<hr />
<pre>
156      * Returns this identity&#39;s public key.
157      *
158      * @return the public key for this identity.
159      *
160      * @see #setPublicKey
161      */
162     public PublicKey getPublicKey() {
163         return publicKey;
164     }
165 
166     /**
167      * Sets this identity&#39;s public key. The old key and all of this
168      * identity&#39;s certificates are removed by this operation.
169      *
170      * &lt;p&gt;First, if there is a security manager, its {@code checkSecurityAccess}
171      * method is called with {@code &quot;setIdentityPublicKey&quot;}
172      * as its argument to see if it&#39;s ok to set the public key.
173      *
174      * @param key the public key for this identity.
175      *
<span class="line-modified">176      * @throws    KeyManagementException if another identity in the</span>
177      * identity&#39;s scope has the same public key, or if another exception occurs.
178      *
<span class="line-modified">179      * @throws     SecurityException  if a security manager exists and its</span>
180      * {@code checkSecurityAccess} method doesn&#39;t allow
181      * setting the public key.
182      *
183      * @see #getPublicKey
184      * @see SecurityManager#checkSecurityAccess
185      */
186     /* Should we throw an exception if this is already set? */
187     public void setPublicKey(PublicKey key) throws KeyManagementException {
188 
189         check(&quot;setIdentityPublicKey&quot;);
190         this.publicKey = key;
191         certificates = new Vector&lt;&gt;();
192     }
193 
194     /**
195      * Specifies a general information string for this identity.
196      *
197      * &lt;p&gt;First, if there is a security manager, its {@code checkSecurityAccess}
198      * method is called with {@code &quot;setIdentityInfo&quot;}
199      * as its argument to see if it&#39;s ok to specify the information string.
200      *
201      * @param info the information string.
202      *
<span class="line-modified">203      * @throws     SecurityException  if a security manager exists and its</span>
204      * {@code checkSecurityAccess} method doesn&#39;t allow
205      * setting the information string.
206      *
207      * @see #getInfo
208      * @see SecurityManager#checkSecurityAccess
209      */
210     public void setInfo(String info) {
211         check(&quot;setIdentityInfo&quot;);
212         this.info = info;
213     }
214 
215     /**
216      * Returns general information previously specified for this identity.
217      *
218      * @return general information about this identity.
219      *
220      * @see #setInfo
221      */
222     public String getInfo() {
223         return info;
224     }
225 
226     /**
227      * Adds a certificate for this identity. If the identity has a public
228      * key, the public key in the certificate must be the same, and if
229      * the identity does not have a public key, the identity&#39;s
230      * public key is set to be that specified in the certificate.
231      *
232      * &lt;p&gt;First, if there is a security manager, its {@code checkSecurityAccess}
233      * method is called with {@code &quot;addIdentityCertificate&quot;}
234      * as its argument to see if it&#39;s ok to add a certificate.
235      *
236      * @param certificate the certificate to be added.
237      *
<span class="line-modified">238      * @throws    KeyManagementException if the certificate is not valid,</span>
239      * if the public key in the certificate being added conflicts with
240      * this identity&#39;s public key, or if another exception occurs.
241      *
<span class="line-modified">242      * @throws     SecurityException  if a security manager exists and its</span>
243      * {@code checkSecurityAccess} method doesn&#39;t allow
244      * adding a certificate.
245      *
246      * @see SecurityManager#checkSecurityAccess
247      */
248     public void addCertificate(Certificate certificate)
249     throws KeyManagementException {
250 
251         check(&quot;addIdentityCertificate&quot;);
252 
253         if (certificates == null) {
254             certificates = new Vector&lt;&gt;();
255         }
256         if (publicKey != null) {
257             if (!keyEquals(publicKey, certificate.getPublicKey())) {
258                 throw new KeyManagementException(
259                     &quot;public key different from cert public key&quot;);
260             }
261         } else {
262             publicKey = certificate.getPublicKey();
</pre>
<hr />
<pre>
269         String anotherKeyFormat = anotherKey.getFormat();
270         if ((aKeyFormat == null) ^ (anotherKeyFormat == null))
271             return false;
272         if (aKeyFormat != null &amp;&amp; anotherKeyFormat != null)
273             if (!aKeyFormat.equalsIgnoreCase(anotherKeyFormat))
274                 return false;
275         return java.util.Arrays.equals(aKey.getEncoded(),
276                                      anotherKey.getEncoded());
277     }
278 
279 
280     /**
281      * Removes a certificate from this identity.
282      *
283      * &lt;p&gt;First, if there is a security manager, its {@code checkSecurityAccess}
284      * method is called with {@code &quot;removeIdentityCertificate&quot;}
285      * as its argument to see if it&#39;s ok to remove a certificate.
286      *
287      * @param certificate the certificate to be removed.
288      *
<span class="line-modified">289      * @throws    KeyManagementException if the certificate is</span>
290      * missing, or if another exception occurs.
291      *
<span class="line-modified">292      * @throws     SecurityException  if a security manager exists and its</span>
293      * {@code checkSecurityAccess} method doesn&#39;t allow
294      * removing a certificate.
295      *
296      * @see SecurityManager#checkSecurityAccess
297      */
298     public void removeCertificate(Certificate certificate)
299     throws KeyManagementException {
300         check(&quot;removeIdentityCertificate&quot;);
301         if (certificates != null) {
302             certificates.removeElement(certificate);
303         }
304     }
305 
306     /**
307      * Returns a copy of all the certificates for this identity.
308      *
309      * @return a copy of all the certificates for this identity.
310      */
311     public Certificate[] certificates() {
312         if (certificates == null) {
</pre>
<hr />
<pre>
383      */
384     String fullName() {
385         String parsable = name;
386         if (scope != null) {
387             parsable += &quot;.&quot; + scope.getName();
388         }
389         return parsable;
390     }
391 
392     /**
393      * Returns a short string describing this identity, telling its
394      * name and its scope (if any).
395      *
396      * &lt;p&gt;First, if there is a security manager, its {@code checkSecurityAccess}
397      * method is called with {@code &quot;printIdentity&quot;}
398      * as its argument to see if it&#39;s ok to return the string.
399      *
400      * @return information about this identity, such as its name and the
401      * name of its scope (if any).
402      *
<span class="line-modified">403      * @throws     SecurityException  if a security manager exists and its</span>
404      * {@code checkSecurityAccess} method doesn&#39;t allow
405      * returning a string describing this identity.
406      *
407      * @see SecurityManager#checkSecurityAccess
408      */
409     public String toString() {
410         check(&quot;printIdentity&quot;);
411         String printable = name;
412         if (scope != null) {
413             printable += &quot;[&quot; + scope.getName() + &quot;]&quot;;
414         }
415         return printable;
416     }
417 
418     /**
419      * Returns a string representation of this identity, with
420      * optionally more details than that provided by the
421      * {@code toString} method without any arguments.
422      *
423      * &lt;p&gt;First, if there is a security manager, its {@code checkSecurityAccess}
424      * method is called with {@code &quot;printIdentity&quot;}
425      * as its argument to see if it&#39;s ok to return the string.
426      *
427      * @param detailed whether or not to provide detailed information.
428      *
429      * @return information about this identity. If {@code detailed}
430      * is true, then this method returns more information than that
431      * provided by the {@code toString} method without any arguments.
432      *
<span class="line-modified">433      * @throws     SecurityException  if a security manager exists and its</span>
434      * {@code checkSecurityAccess} method doesn&#39;t allow
435      * returning a string describing this identity.
436      *
437      * @see #toString
438      * @see SecurityManager#checkSecurityAccess
439      */
440     public String toString(boolean detailed) {
441         String out = toString();
442         if (detailed) {
443             out += &quot;\n&quot;;
444             out += printKeys();
445             out += &quot;\n&quot; + printCertificates();
446             if (info != null) {
447                 out += &quot;\n\t&quot; + info;
448             } else {
449                 out += &quot;\n\tno additional information available.&quot;;
450             }
451         }
452         return out;
453     }
</pre>
</td>
</tr>
</table>
<center><a href="GuardedObject.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="IdentityScope.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>