<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/java/util/zip/ZipEntry.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="ZipCoder.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ZipError.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/util/zip/ZipEntry.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 1995, 2017, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 1995, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 39,12 ***</span>
   * This class is used to represent a ZIP file entry.
   *
   * @author      David Connelly
   * @since 1.1
   */
<span class="line-modified">! public</span>
<span class="line-removed">- class ZipEntry implements ZipConstants, Cloneable {</span>
  
      String name;        // entry name
      long xdostime = -1; // last modification time (in extended DOS time,
                          // where milliseconds lost in conversion might
                          // be encoded into the upper half)
<span class="line-new-header">--- 39,11 ---</span>
   * This class is used to represent a ZIP file entry.
   *
   * @author      David Connelly
   * @since 1.1
   */
<span class="line-modified">! public class ZipEntry implements ZipConstants, Cloneable {</span>
  
      String name;        // entry name
      long xdostime = -1; // last modification time (in extended DOS time,
                          // where milliseconds lost in conversion might
                          // be encoded into the upper half)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 520,22 ***</span>
       *         extra field data is greater than 0xFFFF bytes
       *
       * @see #getExtra()
       */
      public void setExtra(byte[] extra) {
<span class="line-modified">!         setExtra0(extra, false);</span>
      }
  
      /**
       * Sets the optional extra field data for the entry.
       *
       * @param extra
       *        the extra field data bytes
       * @param doZIP64
       *        if true, set size and csize from ZIP64 fields if present
       */
<span class="line-modified">!     void setExtra0(byte[] extra, boolean doZIP64) {</span>
          if (extra != null) {
              if (extra.length &gt; 0xFFFF) {
                  throw new IllegalArgumentException(&quot;invalid extra field length&quot;);
              }
              // extra fields are in &quot;HeaderID(2)DataSize(2)Data... format
<span class="line-new-header">--- 519,25 ---</span>
       *         extra field data is greater than 0xFFFF bytes
       *
       * @see #getExtra()
       */
      public void setExtra(byte[] extra) {
<span class="line-modified">!         setExtra0(extra, false, true);</span>
      }
  
      /**
       * Sets the optional extra field data for the entry.
       *
       * @param extra
       *        the extra field data bytes
       * @param doZIP64
       *        if true, set size and csize from ZIP64 fields if present
<span class="line-added">+      * @param isLOC</span>
<span class="line-added">+      *        true if setting the extra field for a LOC, false if for</span>
<span class="line-added">+      *        a CEN</span>
       */
<span class="line-modified">!     void setExtra0(byte[] extra, boolean doZIP64, boolean isLOC) {</span>
          if (extra != null) {
              if (extra.length &gt; 0xFFFF) {
                  throw new IllegalArgumentException(&quot;invalid extra field length&quot;);
              }
              // extra fields are in &quot;HeaderID(2)DataSize(2)Data... format
</pre>
<hr />
<pre>
<span class="line-old-header">*** 548,19 ***</span>
                  if (off + sz &gt; len)         // invalid data
                      break;
                  switch (tag) {
                  case EXTID_ZIP64:
                      if (doZIP64) {
<span class="line-modified">!                         // LOC extra zip64 entry MUST include BOTH original</span>
<span class="line-modified">!                         // and compressed file size fields.</span>
<span class="line-modified">!                         // If invalid zip64 extra fields, simply skip. Even</span>
<span class="line-modified">!                         // it&#39;s rare, it&#39;s possible the entry size happens to</span>
<span class="line-modified">!                         // be the magic value and it &quot;accidently&quot; has some</span>
<span class="line-modified">!                         // bytes in extra match the id.</span>
<span class="line-modified">!                         if (sz &gt;= 16) {</span>
<span class="line-modified">!                             size = get64(extra, off);</span>
<span class="line-modified">!                             csize = get64(extra, off + 8);</span>
                          }
                      }
                      break;
                  case EXTID_NTFS:
                      if (sz &lt; 32) // reserved  4 bytes + tag 2 bytes + size 2 bytes
<span class="line-new-header">--- 550,33 ---</span>
                  if (off + sz &gt; len)         // invalid data
                      break;
                  switch (tag) {
                  case EXTID_ZIP64:
                      if (doZIP64) {
<span class="line-modified">!                         if (isLOC) {</span>
<span class="line-modified">!                             // LOC extra zip64 entry MUST include BOTH original</span>
<span class="line-modified">!                             // and compressed file size fields.</span>
<span class="line-modified">!                             // If invalid zip64 extra fields, simply skip. Even</span>
<span class="line-modified">!                             // it&#39;s rare, it&#39;s possible the entry size happens to</span>
<span class="line-modified">!                             // be the magic value and it &quot;accidently&quot; has some</span>
<span class="line-modified">!                             // bytes in extra match the id.</span>
<span class="line-modified">!                             if (sz &gt;= 16) {</span>
<span class="line-modified">!                                 size = get64(extra, off);</span>
<span class="line-added">+                                 csize = get64(extra, off + 8);</span>
<span class="line-added">+                             }</span>
<span class="line-added">+                         } else {</span>
<span class="line-added">+                             // CEN extra zip64</span>
<span class="line-added">+                             if (size == ZIP64_MAGICVAL) {</span>
<span class="line-added">+                                 if (off + 8 &gt; len)  // invalid zip64 extra</span>
<span class="line-added">+                                     break;          // fields, just skip</span>
<span class="line-added">+                                 size = get64(extra, off);</span>
<span class="line-added">+                             }</span>
<span class="line-added">+                             if (csize == ZIP64_MAGICVAL) {</span>
<span class="line-added">+                                 if (off + 16 &gt; len)  // invalid zip64 extra</span>
<span class="line-added">+                                     break;           // fields, just skip</span>
<span class="line-added">+                                 csize = get64(extra, off + 8);</span>
<span class="line-added">+                             }</span>
                          }
                      }
                      break;
                  case EXTID_NTFS:
                      if (sz &lt; 32) // reserved  4 bytes + tag 2 bytes + size 2 bytes
</pre>
<center><a href="ZipCoder.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ZipError.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>