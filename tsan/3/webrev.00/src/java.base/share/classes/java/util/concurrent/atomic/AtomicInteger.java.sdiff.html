<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/java/util/concurrent/atomic/AtomicInteger.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../ThreadPoolExecutor.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="AtomicLong.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/util/concurrent/atomic/AtomicInteger.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 21  * or visit www.oracle.com if you need additional information or have any
 22  * questions.
 23  */
 24 
 25 /*
 26  * This file is available under and governed by the GNU General Public
 27  * License version 2 only, as published by the Free Software Foundation.
 28  * However, the following notice accompanied the original version of this
 29  * file:
 30  *
 31  * Written by Doug Lea with assistance from members of JCP JSR-166
 32  * Expert Group and released to the public domain, as explained at
 33  * http://creativecommons.org/publicdomain/zero/1.0/
 34  */
 35 
 36 package java.util.concurrent.atomic;
 37 
 38 import java.lang.invoke.VarHandle;
 39 import java.util.function.IntBinaryOperator;
 40 import java.util.function.IntUnaryOperator;

 41 
 42 /**
 43  * An {@code int} value that may be updated atomically.  See the
 44  * {@link VarHandle} specification for descriptions of the properties
 45  * of atomic accesses. An {@code AtomicInteger} is used in
 46  * applications such as atomically incremented counters, and cannot be
 47  * used as a replacement for an {@link java.lang.Integer}. However,
 48  * this class does extend {@code Number} to allow uniform access by
 49  * tools and utilities that deal with numerically-based classes.
 50  *
 51  * @since 1.5
 52  * @author Doug Lea
 53  */
 54 public class AtomicInteger extends Number implements java.io.Serializable {
 55     private static final long serialVersionUID = 6214790243416807050L;
 56 
 57     /*
 58      * This class intended to be implemented using VarHandles, but there
 59      * are unresolved cyclic startup dependencies.
 60      */
<span class="line-modified"> 61     private static final jdk.internal.misc.Unsafe U = jdk.internal.misc.Unsafe.getUnsafe();</span>
<span class="line-modified"> 62     private static final long VALUE = U.objectFieldOffset(AtomicInteger.class, &quot;value&quot;);</span>

 63 
 64     private volatile int value;
 65 
 66     /**
 67      * Creates a new AtomicInteger with the given initial value.
 68      *
 69      * @param initialValue the initial value
 70      */
 71     public AtomicInteger(int initialValue) {
 72         value = initialValue;
 73     }
 74 
 75     /**
 76      * Creates a new AtomicInteger with initial value {@code 0}.
 77      */
 78     public AtomicInteger() {
 79     }
 80 
 81     /**
 82      * Returns the current value,
</pre>
<hr />
<pre>
343      */
344     public String toString() {
345         return Integer.toString(get());
346     }
347 
348     /**
349      * Returns the current value of this {@code AtomicInteger} as an
350      * {@code int},
351      * with memory effects as specified by {@link VarHandle#getVolatile}.
352      *
353      * Equivalent to {@link #get()}.
354      */
355     public int intValue() {
356         return get();
357     }
358 
359     /**
360      * Returns the current value of this {@code AtomicInteger} as a
361      * {@code long} after a widening primitive conversion,
362      * with memory effects as specified by {@link VarHandle#getVolatile}.
<span class="line-modified">363      * @jls 5.1.2 Widening Primitive Conversions</span>
364      */
365     public long longValue() {
366         return (long)get();
367     }
368 
369     /**
370      * Returns the current value of this {@code AtomicInteger} as a
371      * {@code float} after a widening primitive conversion,
372      * with memory effects as specified by {@link VarHandle#getVolatile}.
<span class="line-modified">373      * @jls 5.1.2 Widening Primitive Conversions</span>
374      */
375     public float floatValue() {
376         return (float)get();
377     }
378 
379     /**
380      * Returns the current value of this {@code AtomicInteger} as a
381      * {@code double} after a widening primitive conversion,
382      * with memory effects as specified by {@link VarHandle#getVolatile}.
<span class="line-modified">383      * @jls 5.1.2 Widening Primitive Conversions</span>
384      */
385     public double doubleValue() {
386         return (double)get();
387     }
388 
389     // jdk9
390 
391     /**
392      * Returns the current value, with memory semantics of reading as
393      * if the variable was declared non-{@code volatile}.
394      *
395      * @return the value
396      * @since 9
397      */
398     public final int getPlain() {
399         return U.getInt(this, VALUE);
400     }
401 
402     /**
403      * Sets the value to {@code newValue}, with memory semantics
</pre>
</td>
<td>
<hr />
<pre>
 21  * or visit www.oracle.com if you need additional information or have any
 22  * questions.
 23  */
 24 
 25 /*
 26  * This file is available under and governed by the GNU General Public
 27  * License version 2 only, as published by the Free Software Foundation.
 28  * However, the following notice accompanied the original version of this
 29  * file:
 30  *
 31  * Written by Doug Lea with assistance from members of JCP JSR-166
 32  * Expert Group and released to the public domain, as explained at
 33  * http://creativecommons.org/publicdomain/zero/1.0/
 34  */
 35 
 36 package java.util.concurrent.atomic;
 37 
 38 import java.lang.invoke.VarHandle;
 39 import java.util.function.IntBinaryOperator;
 40 import java.util.function.IntUnaryOperator;
<span class="line-added"> 41 import jdk.internal.misc.Unsafe;</span>
 42 
 43 /**
 44  * An {@code int} value that may be updated atomically.  See the
 45  * {@link VarHandle} specification for descriptions of the properties
 46  * of atomic accesses. An {@code AtomicInteger} is used in
 47  * applications such as atomically incremented counters, and cannot be
 48  * used as a replacement for an {@link java.lang.Integer}. However,
 49  * this class does extend {@code Number} to allow uniform access by
 50  * tools and utilities that deal with numerically-based classes.
 51  *
 52  * @since 1.5
 53  * @author Doug Lea
 54  */
 55 public class AtomicInteger extends Number implements java.io.Serializable {
 56     private static final long serialVersionUID = 6214790243416807050L;
 57 
 58     /*
 59      * This class intended to be implemented using VarHandles, but there
 60      * are unresolved cyclic startup dependencies.
 61      */
<span class="line-modified"> 62     private static final Unsafe U = Unsafe.getUnsafe();</span>
<span class="line-modified"> 63     private static final long VALUE</span>
<span class="line-added"> 64         = U.objectFieldOffset(AtomicInteger.class, &quot;value&quot;);</span>
 65 
 66     private volatile int value;
 67 
 68     /**
 69      * Creates a new AtomicInteger with the given initial value.
 70      *
 71      * @param initialValue the initial value
 72      */
 73     public AtomicInteger(int initialValue) {
 74         value = initialValue;
 75     }
 76 
 77     /**
 78      * Creates a new AtomicInteger with initial value {@code 0}.
 79      */
 80     public AtomicInteger() {
 81     }
 82 
 83     /**
 84      * Returns the current value,
</pre>
<hr />
<pre>
345      */
346     public String toString() {
347         return Integer.toString(get());
348     }
349 
350     /**
351      * Returns the current value of this {@code AtomicInteger} as an
352      * {@code int},
353      * with memory effects as specified by {@link VarHandle#getVolatile}.
354      *
355      * Equivalent to {@link #get()}.
356      */
357     public int intValue() {
358         return get();
359     }
360 
361     /**
362      * Returns the current value of this {@code AtomicInteger} as a
363      * {@code long} after a widening primitive conversion,
364      * with memory effects as specified by {@link VarHandle#getVolatile}.
<span class="line-modified">365      * @jls 5.1.2 Widening Primitive Conversion</span>
366      */
367     public long longValue() {
368         return (long)get();
369     }
370 
371     /**
372      * Returns the current value of this {@code AtomicInteger} as a
373      * {@code float} after a widening primitive conversion,
374      * with memory effects as specified by {@link VarHandle#getVolatile}.
<span class="line-modified">375      * @jls 5.1.2 Widening Primitive Conversion</span>
376      */
377     public float floatValue() {
378         return (float)get();
379     }
380 
381     /**
382      * Returns the current value of this {@code AtomicInteger} as a
383      * {@code double} after a widening primitive conversion,
384      * with memory effects as specified by {@link VarHandle#getVolatile}.
<span class="line-modified">385      * @jls 5.1.2 Widening Primitive Conversion</span>
386      */
387     public double doubleValue() {
388         return (double)get();
389     }
390 
391     // jdk9
392 
393     /**
394      * Returns the current value, with memory semantics of reading as
395      * if the variable was declared non-{@code volatile}.
396      *
397      * @return the value
398      * @since 9
399      */
400     public final int getPlain() {
401         return U.getInt(this, VALUE);
402     }
403 
404     /**
405      * Sets the value to {@code newValue}, with memory semantics
</pre>
</td>
</tr>
</table>
<center><a href="../ThreadPoolExecutor.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="AtomicLong.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>