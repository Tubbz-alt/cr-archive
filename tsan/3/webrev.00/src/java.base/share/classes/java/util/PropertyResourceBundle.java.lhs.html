<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.base/share/classes/java/util/PropertyResourceBundle.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 1996, 2016, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 /*
 27  * (C) Copyright Taligent, Inc. 1996, 1997 - All Rights Reserved
 28  * (C) Copyright IBM Corp. 1996 - 1998 - All Rights Reserved
 29  *
 30  * The original version of this source code and documentation
 31  * is copyrighted and owned by Taligent, Inc., a wholly-owned
 32  * subsidiary of IBM. These materials are provided under terms
 33  * of a License Agreement between Taligent and Sun. This technology
 34  * is protected by multiple US and International patents.
 35  *
 36  * This notice and attribution to Taligent may not be removed.
 37  * Taligent is a registered trademark of Taligent, Inc.
 38  */
 39 
 40 package java.util;
 41 
 42 import java.io.InputStream;
 43 import java.io.InputStreamReader;
 44 import java.io.Reader;
 45 import java.io.IOException;
 46 import java.nio.charset.MalformedInputException;
<a name="2" id="anc2"></a><span class="line-removed"> 47 import java.nio.charset.StandardCharsets;</span>
 48 import java.nio.charset.UnmappableCharacterException;
<a name="3" id="anc3"></a>
 49 import sun.security.action.GetPropertyAction;
 50 import sun.util.PropertyResourceBundleCharset;
 51 import sun.util.ResourceBundleEnumeration;
 52 
 53 /**
<a name="4" id="anc4"></a><span class="line-modified"> 54  * &lt;code&gt;PropertyResourceBundle&lt;/code&gt; is a concrete subclass of</span>
<span class="line-modified"> 55  * &lt;code&gt;ResourceBundle&lt;/code&gt; that manages resources for a locale</span>
 56  * using a set of static strings from a property file. See
 57  * {@link ResourceBundle ResourceBundle} for more information about resource
 58  * bundles.
 59  *
 60  * &lt;p&gt;
 61  * Unlike other types of resource bundle, you don&#39;t subclass
<a name="5" id="anc5"></a><span class="line-modified"> 62  * &lt;code&gt;PropertyResourceBundle&lt;/code&gt;.  Instead, you supply properties</span>
<span class="line-modified"> 63  * files containing the resource data.  &lt;code&gt;ResourceBundle.getBundle&lt;/code&gt;</span>
 64  * will automatically look for the appropriate properties file and create a
<a name="6" id="anc6"></a><span class="line-modified"> 65  * &lt;code&gt;PropertyResourceBundle&lt;/code&gt; that refers to it. See</span>
 66  * {@link ResourceBundle#getBundle(String, Locale, ClassLoader) ResourceBundle.getBundle}
 67  * for a complete description of the search and instantiation strategy.
 68  *
 69  * &lt;p&gt;
 70  * The following &lt;a id=&quot;sample&quot;&gt;example&lt;/a&gt; shows a member of a resource
 71  * bundle family with the base name &quot;MyResources&quot;.
 72  * The text defines the bundle &quot;MyResources_de&quot;,
 73  * the German member of the bundle family.
<a name="7" id="anc7"></a><span class="line-modified"> 74  * This member is based on &lt;code&gt;PropertyResourceBundle&lt;/code&gt;, and the text</span>
 75  * therefore is the content of the file &quot;MyResources_de.properties&quot;
 76  * (a related &lt;a href=&quot;ListResourceBundle.html#sample&quot;&gt;example&lt;/a&gt; shows
 77  * how you can add bundles to this family that are implemented as subclasses
<a name="8" id="anc8"></a><span class="line-modified"> 78  * of &lt;code&gt;ListResourceBundle&lt;/code&gt;).</span>
 79  * The keys in this example are of the form &quot;s1&quot; etc. The actual
 80  * keys are entirely up to your choice, so long as they are the same as
 81  * the keys you use in your program to retrieve the objects from the bundle.
 82  * Keys are case-sensitive.
 83  * &lt;blockquote&gt;
 84  * &lt;pre&gt;
 85  * # MessageFormat pattern
 86  * s1=Die Platte \&quot;{1}\&quot; enth&amp;auml;lt {0}.
 87  *
 88  * # location of {0} in pattern
 89  * s2=1
 90  *
 91  * # sample disk name
 92  * s3=Meine Platte
 93  *
 94  * # first ChoiceFormat choice
 95  * s4=keine Dateien
 96  *
 97  * # second ChoiceFormat choice
 98  * s5=eine Datei
 99  *
100  * # third ChoiceFormat choice
101  * s6={0,number} Dateien
102  *
103  * # sample date
104  * s7=3. M&amp;auml;rz 1996
105  * &lt;/pre&gt;
106  * &lt;/blockquote&gt;
107  *
108  * @apiNote
109  * {@code PropertyResourceBundle} can be constructed either
110  * from an {@code InputStream} or a {@code Reader}, which represents a property file.
111  * Constructing a {@code PropertyResourceBundle} instance from an {@code InputStream}
112  * requires that the input stream be encoded in {@code UTF-8}. By default, if a
113  * {@link java.nio.charset.MalformedInputException} or an
114  * {@link java.nio.charset.UnmappableCharacterException} occurs on reading the
115  * input stream, then the {@code PropertyResourceBundle} instance resets to the state
116  * before the exception, re-reads the input stream in {@code ISO-8859-1}, and
117  * continues reading. If the system property
118  * {@systemProperty java.util.PropertyResourceBundle.encoding} is set to either
119  * &quot;ISO-8859-1&quot; or &quot;UTF-8&quot;, the input stream is solely read in that encoding,
120  * and throws the exception if it encounters an invalid sequence.
121  * If &quot;ISO-8859-1&quot; is specified, characters that cannot be represented in
122  * ISO-8859-1 encoding must be represented by Unicode Escapes as defined in section
123  * 3.3 of &lt;cite&gt;The Java&amp;trade; Language Specification&lt;/cite&gt;
124  * whereas the other constructor which takes a {@code Reader} does not have that limitation.
125  * Other encoding values are ignored for this system property.
126  * The system property is read and evaluated when initializing this class.
127  * Changing or removing the property has no effect after the initialization.
128  *
129  * @implSpec
130  * The implementation of a {@code PropertyResourceBundle} subclass must be
131  * thread-safe if it&#39;s simultaneously used by multiple threads. The default
132  * implementations of the non-abstract methods in this class are thread-safe.
133  *
134  * @see ResourceBundle
135  * @see ListResourceBundle
136  * @see Properties
137  * @since 1.1
138  */
139 public class PropertyResourceBundle extends ResourceBundle {
140 
141     // Check whether the strict encoding is specified.
142     // The possible encoding is either &quot;ISO-8859-1&quot; or &quot;UTF-8&quot;.
143     private static final String encoding = GetPropertyAction
144         .privilegedGetProperty(&quot;java.util.PropertyResourceBundle.encoding&quot;, &quot;&quot;)
145         .toUpperCase(Locale.ROOT);
146 
147     /**
148      * Creates a property resource bundle from an {@link java.io.InputStream
149      * InputStream}. This constructor reads the property file in UTF-8 by default.
150      * If a {@link java.nio.charset.MalformedInputException} or an
151      * {@link java.nio.charset.UnmappableCharacterException} occurs on reading the
152      * input stream, then the PropertyResourceBundle instance resets to the state
153      * before the exception, re-reads the input stream in {@code ISO-8859-1} and
154      * continues reading. If the system property
155      * {@code java.util.PropertyResourceBundle.encoding} is set to either
156      * &quot;ISO-8859-1&quot; or &quot;UTF-8&quot;, the input stream is solely read in that encoding,
157      * and throws the exception if it encounters an invalid sequence. Other
158      * encoding values are ignored for this system property.
159      * The system property is read and evaluated when initializing this class.
160      * Changing or removing the property has no effect after the initialization.
161      *
162      * @param stream an InputStream that represents a property file
163      *        to read from.
164      * @throws IOException if an I/O error occurs
<a name="9" id="anc9"></a><span class="line-modified">165      * @throws NullPointerException if &lt;code&gt;stream&lt;/code&gt; is null</span>
166      * @throws IllegalArgumentException if {@code stream} contains a
167      *     malformed Unicode escape sequence.
168      * @throws MalformedInputException if the system property
169      *     {@code java.util.PropertyResourceBundle.encoding} is set to &quot;UTF-8&quot;
170      *     and {@code stream} contains an invalid UTF-8 byte sequence.
171      * @throws UnmappableCharacterException if the system property
172      *     {@code java.util.PropertyResourceBundle.encoding} is set to &quot;UTF-8&quot;
173      *     and {@code stream} contains an unmappable UTF-8 byte sequence.
174      */
175     @SuppressWarnings({&quot;unchecked&quot;, &quot;rawtypes&quot;})
176     public PropertyResourceBundle (InputStream stream) throws IOException {
177         this(new InputStreamReader(stream,
178             &quot;ISO-8859-1&quot;.equals(encoding) ?
<a name="10" id="anc10"></a><span class="line-modified">179                 StandardCharsets.ISO_8859_1.newDecoder() :</span>
180                 new PropertyResourceBundleCharset(&quot;UTF-8&quot;.equals(encoding)).newDecoder()));
181     }
182 
183     /**
184      * Creates a property resource bundle from a {@link java.io.Reader
185      * Reader}.  Unlike the constructor
186      * {@link #PropertyResourceBundle(java.io.InputStream) PropertyResourceBundle(InputStream)},
187      * there is no limitation as to the encoding of the input property file.
188      *
189      * @param reader a Reader that represents a property file to
190      *        read from.
191      * @throws IOException if an I/O error occurs
<a name="11" id="anc11"></a><span class="line-modified">192      * @throws NullPointerException if &lt;code&gt;reader&lt;/code&gt; is null</span>
193      * @throws IllegalArgumentException if a malformed Unicode escape sequence appears
194      *     from {@code reader}.
195      * @since 1.6
196      */
197     @SuppressWarnings({&quot;unchecked&quot;, &quot;rawtypes&quot;})
198     public PropertyResourceBundle (Reader reader) throws IOException {
199         Properties properties = new Properties();
200         properties.load(reader);
201         lookup = new HashMap(properties);
202     }
203 
204     // Implements java.util.ResourceBundle.handleGetObject; inherits javadoc specification.
205     public Object handleGetObject(String key) {
206         if (key == null) {
207             throw new NullPointerException();
208         }
209         return lookup.get(key);
210     }
211 
212     /**
<a name="12" id="anc12"></a><span class="line-modified">213      * Returns an &lt;code&gt;Enumeration&lt;/code&gt; of the keys contained in</span>
<span class="line-modified">214      * this &lt;code&gt;ResourceBundle&lt;/code&gt; and its parent bundles.</span>
215      *
<a name="13" id="anc13"></a><span class="line-modified">216      * @return an &lt;code&gt;Enumeration&lt;/code&gt; of the keys contained in</span>
<span class="line-modified">217      *         this &lt;code&gt;ResourceBundle&lt;/code&gt; and its parent bundles.</span>
218      * @see #keySet()
219      */
220     public Enumeration&lt;String&gt; getKeys() {
221         ResourceBundle parent = this.parent;
222         return new ResourceBundleEnumeration(lookup.keySet(),
223                 (parent != null) ? parent.getKeys() : null);
224     }
225 
226     /**
<a name="14" id="anc14"></a><span class="line-modified">227      * Returns a &lt;code&gt;Set&lt;/code&gt; of the keys contained</span>
<span class="line-modified">228      * &lt;em&gt;only&lt;/em&gt; in this &lt;code&gt;ResourceBundle&lt;/code&gt;.</span>
229      *
<a name="15" id="anc15"></a><span class="line-modified">230      * @return a &lt;code&gt;Set&lt;/code&gt; of the keys contained only in this</span>
<span class="line-modified">231      *         &lt;code&gt;ResourceBundle&lt;/code&gt;</span>
232      * @since 1.6
233      * @see #keySet()
234      */
235     protected Set&lt;String&gt; handleKeySet() {
236         return lookup.keySet();
237     }
238 
239     // ==================privates====================
240 
241     private final Map&lt;String,Object&gt; lookup;
242 }
<a name="16" id="anc16"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="16" type="hidden" />
</body>
</html>