<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.base/share/classes/java/net/SocketPermission.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="SocketOutputStream.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="SocketTimeoutException.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/net/SocketPermission.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 1997, 2017, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -148,10 +148,11 @@</span>
   */
  
  public final class SocketPermission extends Permission
      implements java.io.Serializable
  {
<span class="udiff-line-added">+     @java.io.Serial</span>
      private static final long serialVersionUID = -7204263841984476862L;
  
      /**
       * Connect to host:port
       */
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -284,10 +285,15 @@</span>
       * &lt;/pre&gt;
       *
       * @param host the hostname or IP address of the computer, optionally
       * including a colon followed by a port or port range.
       * @param action the action string.
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * @throws NullPointerException if any parameters are null</span>
<span class="udiff-line-added">+      * @throws IllegalArgumentException if the format of {@code host} is</span>
<span class="udiff-line-added">+      *         invalid, or if the {@code action} string is empty, malformed, or</span>
<span class="udiff-line-added">+      *         contains an action other than the specified possible actions</span>
       */
      public SocketPermission(String host, String action) {
          super(getHost(host));
          // name initialized to getHost(host); NPE detected in getHost()
          init(getName(), getMask(action));
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -586,18 +592,19 @@</span>
  
              // make sure we didn&#39;t just match the tail of a word
              // like &quot;ackbarfaccept&quot;.  Also, skip to the comma.
              boolean seencomma = false;
              while (i &gt;= matchlen &amp;&amp; !seencomma) {
<span class="udiff-line-modified-removed">-                 switch(a[i-matchlen]) {</span>
<span class="udiff-line-removed">-                 case &#39;,&#39;:</span>
<span class="udiff-line-removed">-                     seencomma = true;</span>
<span class="udiff-line-removed">-                     break;</span>
<span class="udiff-line-modified-added">+                 switch (c = a[i-matchlen]) {</span>
                  case &#39; &#39;: case &#39;\r&#39;: case &#39;\n&#39;:
                  case &#39;\f&#39;: case &#39;\t&#39;:
                      break;
                  default:
<span class="udiff-line-added">+                     if (c == &#39;,&#39; &amp;&amp; i &gt; matchlen) {</span>
<span class="udiff-line-added">+                         seencomma = true;</span>
<span class="udiff-line-added">+                         break;</span>
<span class="udiff-line-added">+                     }</span>
                      throw new IllegalArgumentException(
                              &quot;invalid permission: &quot; + action);
                  }
                  i--;
              }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1184,10 +1191,11 @@</span>
      /**
       * WriteObject is called to save the state of the SocketPermission
       * to a stream. The actions are serialized, and the superclass
       * takes care of the name.
       */
<span class="udiff-line-added">+     @java.io.Serial</span>
      private synchronized void writeObject(java.io.ObjectOutputStream s)
          throws IOException
      {
          // Write out the actions. The superclass takes care of the name
          // call getActions to make sure actions field is initialized
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1198,10 +1206,11 @@</span>
  
      /**
       * readObject is called to restore the state of the SocketPermission from
       * a stream.
       */
<span class="udiff-line-added">+     @java.io.Serial</span>
      private synchronized void readObject(java.io.ObjectInputStream s)
           throws IOException, ClassNotFoundException
      {
          // Read in the action, then initialize the rest
          s.defaultReadObject();
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1356,14 +1365,14 @@</span>
       * Adds a permission to the SocketPermissions. The key for the hash is
       * the name in the case of wildcards, or all the IP addresses.
       *
       * @param permission the Permission object to add.
       *
<span class="udiff-line-modified-removed">-      * @exception IllegalArgumentException - if the permission is not a</span>
<span class="udiff-line-modified-added">+      * @throws    IllegalArgumentException   if the permission is not a</span>
       *                                       SocketPermission
       *
<span class="udiff-line-modified-removed">-      * @exception SecurityException - if this SocketPermissionCollection object</span>
<span class="udiff-line-modified-added">+      * @throws    SecurityException   if this SocketPermissionCollection object</span>
       *                                has been marked readonly
       */
      @Override
      public void add(Permission permission) {
          if (! (permission instanceof SocketPermission))
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1428,11 +1437,11 @@</span>
              if (((needed &amp; x.getMask()) != 0) &amp;&amp; x.impliesIgnoreMask(np)) {
                  effective |=  x.getMask();
                  if ((effective &amp; desired) == desired) {
                      return true;
                  }
<span class="udiff-line-modified-removed">-                 needed = (desired ^ effective);</span>
<span class="udiff-line-modified-added">+                 needed = (desired &amp; ~effective);</span>
              }
          }
          return false;
      }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1446,10 +1455,11 @@</span>
      @SuppressWarnings(&quot;unchecked&quot;)
      public Enumeration&lt;Permission&gt; elements() {
          return (Enumeration)Collections.enumeration(perms.values());
      }
  
<span class="udiff-line-added">+     @java.io.Serial</span>
      private static final long serialVersionUID = 2787186408602843674L;
  
      // Need to maintain serialization interoperability with earlier releases,
      // which had the serializable field:
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1461,10 +1471,11 @@</span>
  
      /**
       * @serialField permissions java.util.Vector
       *     A list of the SocketPermissions for this set.
       */
<span class="udiff-line-added">+     @java.io.Serial</span>
      private static final ObjectStreamField[] serialPersistentFields = {
          new ObjectStreamField(&quot;permissions&quot;, Vector.class),
      };
  
      /**
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1472,10 +1483,11 @@</span>
       */
      /*
       * Writes the contents of the perms field out as a Vector for
       * serialization compatibility with earlier releases.
       */
<span class="udiff-line-added">+     @java.io.Serial</span>
      private void writeObject(ObjectOutputStream out) throws IOException {
          // Don&#39;t call out.defaultWriteObject()
  
          // Write out Vector
          Vector&lt;SocketPermission&gt; permissions = new Vector&lt;&gt;(perms.values());
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1486,10 +1498,11 @@</span>
      }
  
      /*
       * Reads in a Vector of SocketPermissions and saves them in the perms field.
       */
<span class="udiff-line-added">+     @java.io.Serial</span>
      private void readObject(ObjectInputStream in)
          throws IOException, ClassNotFoundException
      {
          // Don&#39;t call in.defaultReadObject()
  
</pre>
<center><a href="SocketOutputStream.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="SocketTimeoutException.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>