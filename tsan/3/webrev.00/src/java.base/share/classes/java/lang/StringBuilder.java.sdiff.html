<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/java/lang/StringBuilder.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="StringBuffer.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="StringCoding.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/lang/StringBuilder.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 71  *
 72  * @apiNote
 73  * {@code StringBuilder} implements {@code Comparable} but does not override
 74  * {@link Object#equals equals}. Thus, the natural ordering of {@code StringBuilder}
 75  * is inconsistent with equals. Care should be exercised if {@code StringBuilder}
 76  * objects are used as keys in a {@code SortedMap} or elements in a {@code SortedSet}.
 77  * See {@link Comparable}, {@link java.util.SortedMap SortedMap}, or
 78  * {@link java.util.SortedSet SortedSet} for more information.
 79  *
 80  * @author      Michael McCloskey
 81  * @see         java.lang.StringBuffer
 82  * @see         java.lang.String
 83  * @since       1.5
 84  */
 85 public final class StringBuilder
 86     extends AbstractStringBuilder
 87     implements java.io.Serializable, Comparable&lt;StringBuilder&gt;, CharSequence
 88 {
 89 
 90     /** use serialVersionUID for interoperability */

 91     static final long serialVersionUID = 4383685877147921099L;
 92 
 93     /**
 94      * Constructs a string builder with no characters in it and an
 95      * initial capacity of 16 characters.
 96      */
 97     @HotSpotIntrinsicCandidate
 98     public StringBuilder() {
 99         super(16);
100     }
101 
102     /**
103      * Constructs a string builder with no characters in it and an
104      * initial capacity specified by the {@code capacity} argument.
105      *
106      * @param      capacity  the initial capacity.
107      * @throws     NegativeArraySizeException  if the {@code capacity}
108      *               argument is less than {@code 0}.
109      */
110     @HotSpotIntrinsicCandidate
111     public StringBuilder(int capacity) {
112         super(capacity);
113     }
114 
115     /**
116      * Constructs a string builder initialized to the contents of the
117      * specified string. The initial capacity of the string builder is
118      * {@code 16} plus the length of the string argument.
119      *
120      * @param   str   the initial contents of the buffer.
121      */
122     @HotSpotIntrinsicCandidate
123     public StringBuilder(String str) {
<span class="line-modified">124         super(str.coder(), str.length(), 16);</span>
<span class="line-removed">125         append(str);</span>
126     }
127 
128     /**
129      * Constructs a string builder that contains the same characters
130      * as the specified {@code CharSequence}. The initial capacity of
131      * the string builder is {@code 16} plus the length of the
132      * {@code CharSequence} argument.
133      *
134      * @param      seq   the sequence to copy.
135      */
136     public StringBuilder(CharSequence seq) {
<span class="line-modified">137         super(String.LATIN1, seq.length(), 16);</span>
<span class="line-removed">138         append(seq);</span>
139     }
140 
141     /**
142      * Compares two {@code StringBuilder} instances lexicographically. This method
143      * follows the same rules for lexicographical comparison as defined in the
144      * {@linkplain java.lang.CharSequence#compare(java.lang.CharSequence,
145      * java.lang.CharSequence)  CharSequence.compare(this, another)} method.
146      *
147      * &lt;p&gt;
148      * For finer-grained, locale-sensitive String comparison, refer to
149      * {@link java.text.Collator}.
150      *
151      * @param another the {@code StringBuilder} to be compared with
152      *
153      * @return  the value {@code 0} if this {@code StringBuilder} contains the same
154      * character sequence as that of the argument {@code StringBuilder}; a negative integer
155      * if this {@code StringBuilder} is lexicographically less than the
156      * {@code StringBuilder} argument; or a positive integer if this {@code StringBuilder}
157      * is lexicographically greater than the {@code StringBuilder} argument.
158      *
</pre>
<hr />
<pre>
443 
444     @Override
445     @HotSpotIntrinsicCandidate
446     public String toString() {
447         // Create a copy, don&#39;t share the array
448         return isLatin1() ? StringLatin1.newString(value, 0, count)
449                           : StringUTF16.newString(value, 0, count);
450     }
451 
452     /**
453      * Save the state of the {@code StringBuilder} instance to a stream
454      * (that is, serialize it).
455      *
456      * @serialData the number of characters currently stored in the string
457      *             builder ({@code int}), followed by the characters in the
458      *             string builder ({@code char[]}).   The length of the
459      *             {@code char} array may be greater than the number of
460      *             characters currently stored in the string builder, in which
461      *             case extra characters are ignored.
462      */

463     private void writeObject(java.io.ObjectOutputStream s)
464         throws java.io.IOException {
465         s.defaultWriteObject();
466         s.writeInt(count);
467         char[] val = new char[capacity()];
468         if (isLatin1()) {
469             StringLatin1.getChars(value, 0, count, val, 0);
470         } else {
471             StringUTF16.getChars(value, 0, count, val, 0);
472         }
473         s.writeObject(val);
474     }
475 
476     /**
477      * readObject is called to restore the state of the StringBuffer from
478      * a stream.
479      */

480     private void readObject(java.io.ObjectInputStream s)
481         throws java.io.IOException, ClassNotFoundException {
482         s.defaultReadObject();
483         count = s.readInt();
484         char[] val = (char[]) s.readObject();
485         initBytes(val, 0, val.length);
486     }
487 
488 }
</pre>
</td>
<td>
<hr />
<pre>
 71  *
 72  * @apiNote
 73  * {@code StringBuilder} implements {@code Comparable} but does not override
 74  * {@link Object#equals equals}. Thus, the natural ordering of {@code StringBuilder}
 75  * is inconsistent with equals. Care should be exercised if {@code StringBuilder}
 76  * objects are used as keys in a {@code SortedMap} or elements in a {@code SortedSet}.
 77  * See {@link Comparable}, {@link java.util.SortedMap SortedMap}, or
 78  * {@link java.util.SortedSet SortedSet} for more information.
 79  *
 80  * @author      Michael McCloskey
 81  * @see         java.lang.StringBuffer
 82  * @see         java.lang.String
 83  * @since       1.5
 84  */
 85 public final class StringBuilder
 86     extends AbstractStringBuilder
 87     implements java.io.Serializable, Comparable&lt;StringBuilder&gt;, CharSequence
 88 {
 89 
 90     /** use serialVersionUID for interoperability */
<span class="line-added"> 91     @java.io.Serial</span>
 92     static final long serialVersionUID = 4383685877147921099L;
 93 
 94     /**
 95      * Constructs a string builder with no characters in it and an
 96      * initial capacity of 16 characters.
 97      */
 98     @HotSpotIntrinsicCandidate
 99     public StringBuilder() {
100         super(16);
101     }
102 
103     /**
104      * Constructs a string builder with no characters in it and an
105      * initial capacity specified by the {@code capacity} argument.
106      *
107      * @param      capacity  the initial capacity.
108      * @throws     NegativeArraySizeException  if the {@code capacity}
109      *               argument is less than {@code 0}.
110      */
111     @HotSpotIntrinsicCandidate
112     public StringBuilder(int capacity) {
113         super(capacity);
114     }
115 
116     /**
117      * Constructs a string builder initialized to the contents of the
118      * specified string. The initial capacity of the string builder is
119      * {@code 16} plus the length of the string argument.
120      *
121      * @param   str   the initial contents of the buffer.
122      */
123     @HotSpotIntrinsicCandidate
124     public StringBuilder(String str) {
<span class="line-modified">125         super(str);</span>

126     }
127 
128     /**
129      * Constructs a string builder that contains the same characters
130      * as the specified {@code CharSequence}. The initial capacity of
131      * the string builder is {@code 16} plus the length of the
132      * {@code CharSequence} argument.
133      *
134      * @param      seq   the sequence to copy.
135      */
136     public StringBuilder(CharSequence seq) {
<span class="line-modified">137         super(seq);</span>

138     }
139 
140     /**
141      * Compares two {@code StringBuilder} instances lexicographically. This method
142      * follows the same rules for lexicographical comparison as defined in the
143      * {@linkplain java.lang.CharSequence#compare(java.lang.CharSequence,
144      * java.lang.CharSequence)  CharSequence.compare(this, another)} method.
145      *
146      * &lt;p&gt;
147      * For finer-grained, locale-sensitive String comparison, refer to
148      * {@link java.text.Collator}.
149      *
150      * @param another the {@code StringBuilder} to be compared with
151      *
152      * @return  the value {@code 0} if this {@code StringBuilder} contains the same
153      * character sequence as that of the argument {@code StringBuilder}; a negative integer
154      * if this {@code StringBuilder} is lexicographically less than the
155      * {@code StringBuilder} argument; or a positive integer if this {@code StringBuilder}
156      * is lexicographically greater than the {@code StringBuilder} argument.
157      *
</pre>
<hr />
<pre>
442 
443     @Override
444     @HotSpotIntrinsicCandidate
445     public String toString() {
446         // Create a copy, don&#39;t share the array
447         return isLatin1() ? StringLatin1.newString(value, 0, count)
448                           : StringUTF16.newString(value, 0, count);
449     }
450 
451     /**
452      * Save the state of the {@code StringBuilder} instance to a stream
453      * (that is, serialize it).
454      *
455      * @serialData the number of characters currently stored in the string
456      *             builder ({@code int}), followed by the characters in the
457      *             string builder ({@code char[]}).   The length of the
458      *             {@code char} array may be greater than the number of
459      *             characters currently stored in the string builder, in which
460      *             case extra characters are ignored.
461      */
<span class="line-added">462     @java.io.Serial</span>
463     private void writeObject(java.io.ObjectOutputStream s)
464         throws java.io.IOException {
465         s.defaultWriteObject();
466         s.writeInt(count);
467         char[] val = new char[capacity()];
468         if (isLatin1()) {
469             StringLatin1.getChars(value, 0, count, val, 0);
470         } else {
471             StringUTF16.getChars(value, 0, count, val, 0);
472         }
473         s.writeObject(val);
474     }
475 
476     /**
477      * readObject is called to restore the state of the StringBuffer from
478      * a stream.
479      */
<span class="line-added">480     @java.io.Serial</span>
481     private void readObject(java.io.ObjectInputStream s)
482         throws java.io.IOException, ClassNotFoundException {
483         s.defaultReadObject();
484         count = s.readInt();
485         char[] val = (char[]) s.readObject();
486         initBytes(val, 0, val.length);
487     }
488 
489 }
</pre>
</td>
</tr>
</table>
<center><a href="StringBuffer.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="StringCoding.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>