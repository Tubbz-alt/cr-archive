<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.base/share/classes/java/io/SequenceInputStream.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="Reader.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="Serializable.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/io/SequenceInputStream.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 1994, 2011, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 1994, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -28,11 +28,11 @@</span>
  import java.io.InputStream;
  import java.util.Enumeration;
  import java.util.Vector;
  
  /**
<span class="udiff-line-modified-removed">-  * A &lt;code&gt;SequenceInputStream&lt;/code&gt; represents</span>
<span class="udiff-line-modified-added">+  * A {@code SequenceInputStream} represents</span>
   * the logical concatenation of other input
   * streams. It starts out with an ordered
   * collection of input streams and reads from
   * the first one until end of file is reached,
   * whereupon it reads from the second one,
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -40,27 +40,26 @@</span>
   * on the last of the contained input streams.
   *
   * @author  Author van Hoff
   * @since   1.0
   */
<span class="udiff-line-modified-removed">- public</span>
<span class="udiff-line-removed">- class SequenceInputStream extends InputStream {</span>
<span class="udiff-line-modified-added">+ public class SequenceInputStream extends InputStream {</span>
      Enumeration&lt;? extends InputStream&gt; e;
      InputStream in;
  
      /**
<span class="udiff-line-modified-removed">-      * Initializes a newly created &lt;code&gt;SequenceInputStream&lt;/code&gt;</span>
<span class="udiff-line-modified-added">+      * Initializes a newly created {@code SequenceInputStream}</span>
       * by remembering the argument, which must
<span class="udiff-line-modified-removed">-      * be an &lt;code&gt;Enumeration&lt;/code&gt;  that produces</span>
<span class="udiff-line-modified-removed">-      * objects whose run-time type is &lt;code&gt;InputStream&lt;/code&gt;.</span>
<span class="udiff-line-modified-added">+      * be an {@code Enumeration}  that produces</span>
<span class="udiff-line-modified-added">+      * objects whose run-time type is {@code InputStream}.</span>
       * The input streams that are  produced by
       * the enumeration will be read, in order,
       * to provide the bytes to be read  from this
<span class="udiff-line-modified-removed">-      * &lt;code&gt;SequenceInputStream&lt;/code&gt;. After</span>
<span class="udiff-line-modified-added">+      * {@code SequenceInputStream}. After</span>
       * each input stream from the enumeration
       * is exhausted, it is closed by calling its
<span class="udiff-line-modified-removed">-      * &lt;code&gt;close&lt;/code&gt; method.</span>
<span class="udiff-line-modified-added">+      * {@code close} method.</span>
       *
       * @param   e   an enumeration of input streams.
       * @see     java.util.Enumeration
       */
      public SequenceInputStream(Enumeration&lt;? extends InputStream&gt; e) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -68,15 +67,15 @@</span>
          peekNextStream();
      }
  
      /**
       * Initializes a newly
<span class="udiff-line-modified-removed">-      * created &lt;code&gt;SequenceInputStream&lt;/code&gt;</span>
<span class="udiff-line-modified-added">+      * created {@code SequenceInputStream}</span>
       * by remembering the two arguments, which
<span class="udiff-line-modified-removed">-      * will be read in order, first &lt;code&gt;s1&lt;/code&gt;</span>
<span class="udiff-line-modified-removed">-      * and then &lt;code&gt;s2&lt;/code&gt;, to provide the</span>
<span class="udiff-line-modified-removed">-      * bytes to be read from this &lt;code&gt;SequenceInputStream&lt;/code&gt;.</span>
<span class="udiff-line-modified-added">+      * will be read in order, first {@code s1}</span>
<span class="udiff-line-modified-added">+      * and then {@code s2}, to provide the</span>
<span class="udiff-line-modified-added">+      * bytes to be read from this {@code SequenceInputStream}.</span>
       *
       * @param   s1   the first input stream to read.
       * @param   s2   the second input stream to read.
       */
      public SequenceInputStream(InputStream s1, InputStream s2) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -86,11 +85,11 @@</span>
          e = v.elements();
          peekNextStream();
      }
  
      /**
<span class="udiff-line-modified-removed">-      *  Continues reading in the next stream if an EOF is reached.</span>
<span class="udiff-line-modified-added">+      * Continues reading in the next stream if an EOF is reached.</span>
       */
      final void nextStream() throws IOException {
          if (in != null) {
              in.close();
          }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -116,42 +115,42 @@</span>
       * many bytes will not block, but may read or skip fewer bytes.
       * &lt;p&gt;
       * This method simply calls {@code available} of the current underlying
       * input stream and returns the result.
       *
<span class="udiff-line-modified-removed">-      * @return an estimate of the number of bytes that can be read (or</span>
<span class="udiff-line-modified-removed">-      *         skipped over) from the current underlying input stream</span>
<span class="udiff-line-modified-removed">-      *         without blocking or {@code 0} if this input stream</span>
<span class="udiff-line-modified-removed">-      *         has been closed by invoking its {@link #close()} method</span>
<span class="udiff-line-modified-removed">-      * @exception  IOException  if an I/O error occurs.</span>
<span class="udiff-line-modified-added">+      * @return   an estimate of the number of bytes that can be read (or</span>
<span class="udiff-line-modified-added">+      *           skipped over) from the current underlying input stream</span>
<span class="udiff-line-modified-added">+      *           without blocking or {@code 0} if this input stream</span>
<span class="udiff-line-modified-added">+      *           has been closed by invoking its {@link #close()} method</span>
<span class="udiff-line-modified-added">+      * @throw    IOException  if an I/O error occurs.</span>
       *
<span class="udiff-line-modified-removed">-      * @since   1.1</span>
<span class="udiff-line-modified-added">+      * @since    1.1</span>
       */
      public int available() throws IOException {
          if (in == null) {
              return 0; // no way to signal EOF from available()
          }
          return in.available();
      }
  
      /**
       * Reads the next byte of data from this input stream. The byte is
<span class="udiff-line-modified-removed">-      * returned as an &lt;code&gt;int&lt;/code&gt; in the range &lt;code&gt;0&lt;/code&gt; to</span>
<span class="udiff-line-modified-removed">-      * &lt;code&gt;255&lt;/code&gt;. If no byte is available because the end of the</span>
<span class="udiff-line-modified-removed">-      * stream has been reached, the value &lt;code&gt;-1&lt;/code&gt; is returned.</span>
<span class="udiff-line-modified-added">+      * returned as an {@code int} in the range {@code 0} to</span>
<span class="udiff-line-modified-added">+      * {@code 255}. If no byte is available because the end of the</span>
<span class="udiff-line-modified-added">+      * stream has been reached, the value {@code -1} is returned.</span>
       * This method blocks until input data is available, the end of the
       * stream is detected, or an exception is thrown.
       * &lt;p&gt;
       * This method
       * tries to read one character from the current substream. If it
<span class="udiff-line-modified-removed">-      * reaches the end of the stream, it calls the &lt;code&gt;close&lt;/code&gt;</span>
<span class="udiff-line-modified-added">+      * reaches the end of the stream, it calls the {@code close}</span>
       * method of the current substream and begins reading from the next
       * substream.
       *
<span class="udiff-line-modified-removed">-      * @return     the next byte of data, or &lt;code&gt;-1&lt;/code&gt; if the end of the</span>
<span class="udiff-line-modified-added">+      * @return     the next byte of data, or {@code -1} if the end of the</span>
       *             stream is reached.
<span class="udiff-line-modified-removed">-      * @exception  IOException  if an I/O error occurs.</span>
<span class="udiff-line-modified-added">+      * @throws     IOException  if an I/O error occurs.</span>
       */
      public int read() throws IOException {
          while (in != null) {
              int c = in.read();
              if (c != -1) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -161,31 +160,31 @@</span>
          }
          return -1;
      }
  
      /**
<span class="udiff-line-modified-removed">-      * Reads up to &lt;code&gt;len&lt;/code&gt; bytes of data from this input stream</span>
<span class="udiff-line-modified-removed">-      * into an array of bytes.  If &lt;code&gt;len&lt;/code&gt; is not zero, the method</span>
<span class="udiff-line-modified-added">+      * Reads up to {@code len} bytes of data from this input stream</span>
<span class="udiff-line-modified-added">+      * into an array of bytes.  If {@code len} is not zero, the method</span>
       * blocks until at least 1 byte of input is available; otherwise, no
<span class="udiff-line-modified-removed">-      * bytes are read and &lt;code&gt;0&lt;/code&gt; is returned.</span>
<span class="udiff-line-modified-added">+      * bytes are read and {@code 0} is returned.</span>
       * &lt;p&gt;
<span class="udiff-line-modified-removed">-      * The &lt;code&gt;read&lt;/code&gt; method of &lt;code&gt;SequenceInputStream&lt;/code&gt;</span>
<span class="udiff-line-modified-added">+      * The {@code read} method of {@code SequenceInputStream}</span>
       * tries to read the data from the current substream. If it fails to
       * read any characters because the substream has reached the end of
<span class="udiff-line-modified-removed">-      * the stream, it calls the &lt;code&gt;close&lt;/code&gt; method of the current</span>
<span class="udiff-line-modified-added">+      * the stream, it calls the {@code close} method of the current</span>
       * substream and begins reading from the next substream.
       *
       * @param      b     the buffer into which the data is read.
<span class="udiff-line-modified-removed">-      * @param      off   the start offset in array &lt;code&gt;b&lt;/code&gt;</span>
<span class="udiff-line-modified-added">+      * @param      off   the start offset in array {@code b}</span>
       *                   at which the data is written.
       * @param      len   the maximum number of bytes read.
       * @return     int   the number of bytes read.
<span class="udiff-line-modified-removed">-      * @exception  NullPointerException If &lt;code&gt;b&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;.</span>
<span class="udiff-line-modified-removed">-      * @exception  IndexOutOfBoundsException If &lt;code&gt;off&lt;/code&gt; is negative,</span>
<span class="udiff-line-modified-removed">-      * &lt;code&gt;len&lt;/code&gt; is negative, or &lt;code&gt;len&lt;/code&gt; is greater than</span>
<span class="udiff-line-modified-removed">-      * &lt;code&gt;b.length - off&lt;/code&gt;</span>
<span class="udiff-line-modified-removed">-      * @exception  IOException  if an I/O error occurs.</span>
<span class="udiff-line-modified-added">+      * @throws     NullPointerException If {@code b} is {@code null}.</span>
<span class="udiff-line-modified-added">+      * @throws     IndexOutOfBoundsException If {@code off} is negative,</span>
<span class="udiff-line-modified-added">+      *             {@code len} is negative, or {@code len} is</span>
<span class="udiff-line-modified-added">+      *             greater than {@code b.length - off}</span>
<span class="udiff-line-modified-added">+      * @throws     IOException  if an I/O error occurs.</span>
       */
      public int read(byte b[], int off, int len) throws IOException {
          if (in == null) {
              return -1;
          } else if (b == null) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -206,22 +205,35 @@</span>
      }
  
      /**
       * Closes this input stream and releases any system resources
       * associated with the stream.
<span class="udiff-line-modified-removed">-      * A closed &lt;code&gt;SequenceInputStream&lt;/code&gt;</span>
<span class="udiff-line-modified-added">+      * A closed {@code SequenceInputStream}</span>
       * cannot  perform input operations and cannot
       * be reopened.
       * &lt;p&gt;
       * If this stream was created
       * from an enumeration, all remaining elements
       * are requested from the enumeration and closed
<span class="udiff-line-modified-removed">-      * before the &lt;code&gt;close&lt;/code&gt; method returns.</span>
<span class="udiff-line-modified-added">+      * before the {@code close} method returns.</span>
       *
<span class="udiff-line-modified-removed">-      * @exception  IOException  if an I/O error occurs.</span>
<span class="udiff-line-modified-added">+      * @throws     IOException  if an I/O error occurs.</span>
       */
      public void close() throws IOException {
<span class="udiff-line-modified-removed">-         do {</span>
<span class="udiff-line-modified-removed">-             nextStream();</span>
<span class="udiff-line-modified-removed">-         } while (in != null);</span>
<span class="udiff-line-modified-added">+         IOException ioe = null;</span>
<span class="udiff-line-modified-added">+         while (in != null) {</span>
<span class="udiff-line-modified-added">+             try {</span>
<span class="udiff-line-added">+                 in.close();</span>
<span class="udiff-line-added">+             } catch (IOException e) {</span>
<span class="udiff-line-added">+                 if (ioe == null) {</span>
<span class="udiff-line-added">+                     ioe = e;</span>
<span class="udiff-line-added">+                 } else {</span>
<span class="udiff-line-added">+                     ioe.addSuppressed(e);</span>
<span class="udiff-line-added">+                 }</span>
<span class="udiff-line-added">+             }</span>
<span class="udiff-line-added">+             peekNextStream();</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+         if (ioe != null) {</span>
<span class="udiff-line-added">+             throw ioe;</span>
<span class="udiff-line-added">+         }</span>
      }
  }
</pre>
<center><a href="Reader.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="Serializable.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>