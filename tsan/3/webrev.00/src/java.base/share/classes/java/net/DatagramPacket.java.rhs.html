<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.base/share/classes/java/net/DatagramPacket.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 1995, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package java.net;
 27 
 28 /**
 29  * This class represents a datagram packet.
 30  * &lt;p&gt;
 31  * Datagram packets are used to implement a connectionless packet
 32  * delivery service. Each message is routed from one machine to
 33  * another based solely on information contained within that packet.
 34  * Multiple packets sent from one machine to another might be routed
 35  * differently, and might arrive in any order. Packet delivery is
 36  * not guaranteed.
 37  *
<a name="2" id="anc2"></a><span class="line-added"> 38  * &lt;p&gt;</span>
<span class="line-added"> 39  * Unless otherwise specified, passing a {@code null} argument causes</span>
<span class="line-added"> 40  * a {@link NullPointerException NullPointerException} to be thrown.</span>
<span class="line-added"> 41  *</span>
<span class="line-added"> 42  * &lt;p&gt;</span>
<span class="line-added"> 43  * Methods and constructors of {@code DatagramPacket} accept parameters</span>
<span class="line-added"> 44  * of type {@link SocketAddress}. {@code DatagramPacket} supports</span>
<span class="line-added"> 45  * {@link InetSocketAddress}, and may support additional {@code SocketAddress}</span>
<span class="line-added"> 46  * sub-types.</span>
<span class="line-added"> 47  *</span>
 48  * @author  Pavani Diwanji
 49  * @author  Benjamin Renaud
 50  * @since   1.0
 51  */
 52 public final
 53 class DatagramPacket {
 54 
 55     /**
 56      * Perform class initialization
 57      */
 58     static {
<a name="3" id="anc3"></a><span class="line-modified"> 59         jdk.internal.loader.BootLoader.loadLibrary(&quot;net&quot;);</span>






 60         init();
 61     }
 62 
 63     /*
 64      * The fields of this class are package-private since DatagramSocketImpl
 65      * classes needs to access them.
 66      */
 67     byte[] buf;
 68     int offset;
 69     int length;
 70     int bufLength;
 71     InetAddress address;
 72     int port;
 73 
 74     /**
 75      * Constructs a {@code DatagramPacket} for receiving packets of
 76      * length {@code length}, specifying an offset into the buffer.
 77      * &lt;p&gt;
 78      * The {@code length} argument must be less than or equal to
 79      * {@code buf.length}.
 80      *
<a name="4" id="anc4"></a><span class="line-modified"> 81      * @param   buf     buffer for holding the incoming datagram.</span>
<span class="line-modified"> 82      * @param   offset  the offset for the buffer</span>
<span class="line-modified"> 83      * @param   length  the number of bytes to read.</span>
 84      *
<a name="5" id="anc5"></a><span class="line-modified"> 85      * @throws  IllegalArgumentException    if the length or offset</span>
<span class="line-added"> 86      *          is negative, or if the length plus the offset is</span>
<span class="line-added"> 87      *          greater than the length of the packet&#39;s given buffer.</span>
<span class="line-added"> 88      *</span>
<span class="line-added"> 89      * @since   1.2</span>
 90      */
 91     public DatagramPacket(byte buf[], int offset, int length) {
 92         setData(buf, offset, length);
 93         this.address = null;
 94         this.port = -1;
 95     }
 96 
 97     /**
 98      * Constructs a {@code DatagramPacket} for receiving packets of
 99      * length {@code length}.
100      * &lt;p&gt;
101      * The {@code length} argument must be less than or equal to
102      * {@code buf.length}.
103      *
<a name="6" id="anc6"></a><span class="line-modified">104      * @param   buf     buffer for holding the incoming datagram.</span>
<span class="line-modified">105      * @param   length  the number of bytes to read.</span>
<span class="line-added">106      *</span>
<span class="line-added">107      * @throws  IllegalArgumentException    if the length is negative</span>
<span class="line-added">108      *          or if the length is greater than the length of the</span>
<span class="line-added">109      *          packet&#39;s given buffer.</span>
110      */
111     public DatagramPacket(byte buf[], int length) {
112         this (buf, 0, length);
113     }
114 
115     /**
116      * Constructs a datagram packet for sending packets of length
117      * {@code length} with offset {@code offset} to the
118      * specified port number on the specified host. The
119      * {@code length} argument must be less than or equal to
120      * {@code buf.length}.
121      *
<a name="7" id="anc7"></a><span class="line-modified">122      * @param   buf     the packet data.</span>
<span class="line-modified">123      * @param   offset  the packet data offset.</span>
<span class="line-modified">124      * @param   length  the packet data length.</span>
<span class="line-modified">125      * @param   address the destination address, or {@code null}.</span>
<span class="line-modified">126      * @param   port    the destination port number.</span>

127      *
<a name="8" id="anc8"></a><span class="line-modified">128      * @throws  IllegalArgumentException    if the length or offset</span>
<span class="line-added">129      *          is negative, or if the length plus the offset is</span>
<span class="line-added">130      *          greater than the length of the packet&#39;s given buffer,</span>
<span class="line-added">131      *          or if the port is out of range.</span>
<span class="line-added">132      *</span>
<span class="line-added">133      * @see     java.net.InetAddress</span>
<span class="line-added">134      *</span>
<span class="line-added">135      * @since   1.2</span>
136      */
137     public DatagramPacket(byte buf[], int offset, int length,
138                           InetAddress address, int port) {
139         setData(buf, offset, length);
140         setAddress(address);
141         setPort(port);
142     }
143 
144     /**
145      * Constructs a datagram packet for sending packets of length
146      * {@code length} with offset {@code offset} to the
147      * specified port number on the specified host. The
148      * {@code length} argument must be less than or equal to
149      * {@code buf.length}.
150      *
<a name="9" id="anc9"></a><span class="line-modified">151      * @param   buf     the packet data.</span>
<span class="line-modified">152      * @param   offset  the packet data offset.</span>
<span class="line-modified">153      * @param   length  the packet data length.</span>
<span class="line-modified">154      * @param   address the destination socket address.</span>
<span class="line-modified">155      *</span>
<span class="line-modified">156      * @throws  IllegalArgumentException    if address is null or its</span>
<span class="line-added">157      *          type is not supported, or if the length or offset is</span>
<span class="line-added">158      *          negative, or if the length plus the offset is greater</span>
<span class="line-added">159      *          than the length of the packet&#39;s given buffer.</span>
<span class="line-added">160      *</span>
<span class="line-added">161      * @see     java.net.InetAddress</span>
162      *
<a name="10" id="anc10"></a><span class="line-modified">163      * @since   1.4</span>
164      */
165     public DatagramPacket(byte buf[], int offset, int length, SocketAddress address) {
166         setData(buf, offset, length);
167         setSocketAddress(address);
168     }
169 
170     /**
171      * Constructs a datagram packet for sending packets of length
172      * {@code length} to the specified port number on the specified
173      * host. The {@code length} argument must be less than or equal
174      * to {@code buf.length}.
175      *
<a name="11" id="anc11"></a><span class="line-modified">176      * @param   buf     the packet data.</span>
<span class="line-modified">177      * @param   length  the packet length.</span>
<span class="line-modified">178      * @param   address the destination address, or {@code null}.</span>
<span class="line-modified">179      * @param   port    the destination port number.</span>
<span class="line-added">180      *</span>
<span class="line-added">181      * @throws  IllegalArgumentException    if the length is negative,</span>
<span class="line-added">182      *          or if the length is greater than the length of the</span>
<span class="line-added">183      *          packet&#39;s given buffer, or if the port is out of range.</span>
<span class="line-added">184      *</span>
185      * @see     java.net.InetAddress
186      */
187     public DatagramPacket(byte buf[], int length,
188                           InetAddress address, int port) {
189         this(buf, 0, length, address, port);
190     }
191 
192     /**
193      * Constructs a datagram packet for sending packets of length
194      * {@code length} to the specified port number on the specified
195      * host. The {@code length} argument must be less than or equal
196      * to {@code buf.length}.
197      *
<a name="12" id="anc12"></a><span class="line-modified">198      * @param   buf     the packet data.</span>
<span class="line-modified">199      * @param   length  the packet length.</span>
<span class="line-modified">200      * @param   address the destination address.</span>
<span class="line-modified">201      *</span>
<span class="line-modified">202      * @throws  IllegalArgumentException    if address is null or its type is</span>
<span class="line-added">203      *          not supported, or if the length is negative, or if the length</span>
<span class="line-added">204      *          is greater than the length of the packet&#39;s given buffer, or</span>
<span class="line-added">205      *          if the port is out of range.</span>
<span class="line-added">206      *</span>
207      * @see     java.net.InetAddress
<a name="13" id="anc13"></a><span class="line-added">208      *</span>
<span class="line-added">209      * @since   1.4</span>
210      */
211     public DatagramPacket(byte buf[], int length, SocketAddress address) {
212         this(buf, 0, length, address);
213     }
214 
215     /**
216      * Returns the IP address of the machine to which this datagram is being
217      * sent or from which the datagram was received.
218      *
219      * @return  the IP address of the machine to which this datagram is being
220      *          sent or from which the datagram was received.
221      * @see     java.net.InetAddress
222      * @see #setAddress(java.net.InetAddress)
223      */
224     public synchronized InetAddress getAddress() {
225         return address;
226     }
227 
228     /**
229      * Returns the port number on the remote host to which this datagram is
230      * being sent or from which the datagram was received.
231      *
232      * @return  the port number on the remote host to which this datagram is
233      *          being sent or from which the datagram was received.
234      * @see #setPort(int)
235      */
236     public synchronized int getPort() {
237         return port;
238     }
239 
240     /**
241      * Returns the data buffer. The data received or the data to be sent
242      * starts from the {@code offset} in the buffer,
243      * and runs for {@code length} long.
244      *
245      * @return  the buffer used to receive or  send data
246      * @see #setData(byte[], int, int)
247      */
248     public synchronized byte[] getData() {
249         return buf;
250     }
251 
252     /**
253      * Returns the offset of the data to be sent or the offset of the
254      * data received.
255      *
256      * @return  the offset of the data to be sent or the offset of the
257      *          data received.
258      *
259      * @since 1.2
260      */
261     public synchronized int getOffset() {
262         return offset;
263     }
264 
265     /**
266      * Returns the length of the data to be sent or the length of the
267      * data received.
268      *
269      * @return  the length of the data to be sent or the length of the
270      *          data received.
271      * @see #setLength(int)
272      */
273     public synchronized int getLength() {
274         return length;
275     }
276 
277     /**
278      * Set the data buffer for this packet. This sets the
279      * data, length and offset of the packet.
280      *
<a name="14" id="anc14"></a><span class="line-modified">281      * @param   buf     the buffer to set for this packet</span>
<span class="line-modified">282      * @param   offset  the offset into the data</span>
<span class="line-modified">283      * @param   length  the length of the data</span>
<span class="line-modified">284      *          and/or the length of the buffer used to receive data</span>


285      *
<a name="15" id="anc15"></a><span class="line-modified">286      * @throws  IllegalArgumentException    if the length or offset</span>
<span class="line-added">287      *          is negative, or if the length plus the offset is</span>
<span class="line-added">288      *          greater than the length of the packet&#39;s given buffer.</span>
289      *
<a name="16" id="anc16"></a><span class="line-modified">290      * @see     #getData</span>
<span class="line-modified">291      * @see     #getOffset</span>
<span class="line-modified">292      * @see     #getLength</span>
293      *
<a name="17" id="anc17"></a><span class="line-modified">294      * @since   1.2</span>
295      */
296     public synchronized void setData(byte[] buf, int offset, int length) {
297         /* this will check to see if buf is null */
298         if (length &lt; 0 || offset &lt; 0 ||
299             (length + offset) &lt; 0 ||
300             ((length + offset) &gt; buf.length)) {
301             throw new IllegalArgumentException(&quot;illegal length or offset&quot;);
302         }
303         this.buf = buf;
304         this.length = length;
305         this.bufLength = length;
306         this.offset = offset;
307     }
308 
309     /**
310      * Sets the IP address of the machine to which this datagram
311      * is being sent.
<a name="18" id="anc18"></a><span class="line-modified">312      *</span>
<span class="line-added">313      * @param   iaddr   the {@code InetAddress}, or {@code null}.</span>
<span class="line-added">314      *</span>
<span class="line-added">315      * @see     #getAddress()</span>
<span class="line-added">316      *</span>
317      * @since   1.1
<a name="19" id="anc19"></a>
318      */
319     public synchronized void setAddress(InetAddress iaddr) {
320         address = iaddr;
321     }
322 
323     /**
324      * Sets the port number on the remote host to which this datagram
325      * is being sent.
<a name="20" id="anc20"></a><span class="line-modified">326      *</span>
<span class="line-added">327      * @param   iport   the port number</span>
<span class="line-added">328      *</span>
<span class="line-added">329      * @throws  IllegalArgumentException    if the port is out of range</span>
<span class="line-added">330      *</span>
<span class="line-added">331      * @see     #getPort()</span>
<span class="line-added">332      *</span>
333      * @since   1.1
<a name="21" id="anc21"></a>
334      */
335     public synchronized void setPort(int iport) {
336         if (iport &lt; 0 || iport &gt; 0xFFFF) {
337             throw new IllegalArgumentException(&quot;Port out of range:&quot;+ iport);
338         }
339         port = iport;
340     }
341 
342     /**
343      * Sets the SocketAddress (usually IP address + port number) of the remote
344      * host to which this datagram is being sent.
345      *
<a name="22" id="anc22"></a><span class="line-modified">346      * @param   address the {@code SocketAddress}</span>
<span class="line-modified">347      *</span>
<span class="line-modified">348      * @throws  IllegalArgumentException    if address is null or is a</span>
<span class="line-added">349      *          SocketAddress subclass not supported.</span>
350      *
<a name="23" id="anc23"></a><span class="line-modified">351      * @see     #getSocketAddress</span>
<span class="line-modified">352      *</span>
<span class="line-added">353      * @since   1.4</span>
354      */
355     public synchronized void setSocketAddress(SocketAddress address) {
356         if (address == null || !(address instanceof InetSocketAddress))
357             throw new IllegalArgumentException(&quot;unsupported address type&quot;);
358         InetSocketAddress addr = (InetSocketAddress) address;
359         if (addr.isUnresolved())
360             throw new IllegalArgumentException(&quot;unresolved address&quot;);
361         setAddress(addr.getAddress());
362         setPort(addr.getPort());
363     }
364 
365     /**
366      * Gets the SocketAddress (usually IP address + port number) of the remote
367      * host that this packet is being sent to or is coming from.
368      *
<a name="24" id="anc24"></a><span class="line-modified">369      * @return  the {@code SocketAddress}</span>
<span class="line-modified">370      *</span>
<span class="line-modified">371      * @see     #setSocketAddress</span>
<span class="line-added">372      *</span>
<span class="line-added">373      * @since   1.4</span>
374      */
375     public synchronized SocketAddress getSocketAddress() {
376         return new InetSocketAddress(getAddress(), getPort());
377     }
378 
379     /**
380      * Set the data buffer for this packet. With the offset of
381      * this DatagramPacket set to 0, and the length set to
382      * the length of {@code buf}.
383      *
<a name="25" id="anc25"></a><span class="line-modified">384      * @param   buf     the buffer to set for this packet.</span>


385      *
<a name="26" id="anc26"></a><span class="line-modified">386      * @see     #getLength</span>
<span class="line-modified">387      * @see     #getData</span>
388      *
<a name="27" id="anc27"></a><span class="line-modified">389      * @since   1.1</span>
390      */
391     public synchronized void setData(byte[] buf) {
392         if (buf == null) {
393             throw new NullPointerException(&quot;null packet buffer&quot;);
394         }
395         this.buf = buf;
396         this.offset = 0;
397         this.length = buf.length;
398         this.bufLength = buf.length;
399     }
400 
401     /**
402      * Set the length for this packet. The length of the packet is
403      * the number of bytes from the packet&#39;s data buffer that will be
404      * sent, or the number of bytes of the packet&#39;s data buffer that
405      * will be used for receiving data. The length must be lesser or
406      * equal to the offset plus the length of the packet&#39;s buffer.
407      *
<a name="28" id="anc28"></a><span class="line-modified">408      * @param   length      the length to set for this packet.</span>
409      *
<a name="29" id="anc29"></a><span class="line-modified">410      * @throws  IllegalArgumentException    if the length is negative,</span>
<span class="line-modified">411      *          or if the length plus the offset is greater than the</span>
<span class="line-modified">412      *          length of the packet&#39;s data buffer.</span>
413      *
<a name="30" id="anc30"></a><span class="line-modified">414      * @see     #getLength</span>
<span class="line-modified">415      * @see     #setData</span>
416      *
<a name="31" id="anc31"></a><span class="line-modified">417      * @since   1.1</span>
418      */
419     public synchronized void setLength(int length) {
420         if ((length + offset) &gt; buf.length || length &lt; 0 ||
421             (length + offset) &lt; 0) {
422             throw new IllegalArgumentException(&quot;illegal length&quot;);
423         }
424         this.length = length;
425         this.bufLength = this.length;
426     }
427 
428     /**
429      * Perform class load-time initializations.
430      */
431     private static native void init();
432 }
<a name="32" id="anc32"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="32" type="hidden" />
</body>
</html>