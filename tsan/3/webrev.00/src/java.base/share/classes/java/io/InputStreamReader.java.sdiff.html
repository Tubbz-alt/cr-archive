<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/java/io/InputStreamReader.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="InputStream.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="InterruptedIOException.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/io/InputStreamReader.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 1996, 2013, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 53  *
 54  * @see BufferedReader
 55  * @see InputStream
 56  * @see java.nio.charset.Charset
 57  *
 58  * @author      Mark Reinhold
 59  * @since       1.1
 60  */
 61 
 62 public class InputStreamReader extends Reader {
 63 
 64     private final StreamDecoder sd;
 65 
 66     /**
 67      * Creates an InputStreamReader that uses the default charset.
 68      *
 69      * @param  in   An InputStream
 70      */
 71     public InputStreamReader(InputStream in) {
 72         super(in);
<span class="line-modified"> 73         try {</span>
<span class="line-modified"> 74             sd = StreamDecoder.forInputStreamReader(in, this, (String)null); // ## check lock object</span>
<span class="line-removed"> 75         } catch (UnsupportedEncodingException e) {</span>
<span class="line-removed"> 76             // The default encoding should always be available</span>
<span class="line-removed"> 77             throw new Error(e);</span>
<span class="line-removed"> 78         }</span>
 79     }
 80 
 81     /**
 82      * Creates an InputStreamReader that uses the named charset.
 83      *
 84      * @param  in
 85      *         An InputStream
 86      *
 87      * @param  charsetName
 88      *         The name of a supported
 89      *         {@link java.nio.charset.Charset charset}
 90      *
<span class="line-modified"> 91      * @exception  UnsupportedEncodingException</span>
 92      *             If the named charset is not supported
 93      */
 94     public InputStreamReader(InputStream in, String charsetName)
 95         throws UnsupportedEncodingException
 96     {
 97         super(in);
 98         if (charsetName == null)
 99             throw new NullPointerException(&quot;charsetName&quot;);
100         sd = StreamDecoder.forInputStreamReader(in, this, charsetName);
101     }
102 
103     /**
104      * Creates an InputStreamReader that uses the given charset.
105      *
106      * @param  in       An InputStream
107      * @param  cs       A charset
108      *
109      * @since 1.4
110      * @spec JSR-51
111      */
</pre>
<hr />
<pre>
124      *
125      * @since 1.4
126      * @spec JSR-51
127      */
128     public InputStreamReader(InputStream in, CharsetDecoder dec) {
129         super(in);
130         if (dec == null)
131             throw new NullPointerException(&quot;charset decoder&quot;);
132         sd = StreamDecoder.forInputStreamReader(in, this, dec);
133     }
134 
135     /**
136      * Returns the name of the character encoding being used by this stream.
137      *
138      * &lt;p&gt; If the encoding has an historical name then that name is returned;
139      * otherwise the encoding&#39;s canonical name is returned.
140      *
141      * &lt;p&gt; If this instance was created with the {@link
142      * #InputStreamReader(InputStream, String)} constructor then the returned
143      * name, being unique for the encoding, may differ from the name passed to
<span class="line-modified">144      * the constructor. This method will return &lt;code&gt;null&lt;/code&gt; if the</span>
145      * stream has been closed.
146      * &lt;/p&gt;
147      * @return The historical name of this encoding, or
<span class="line-modified">148      *         &lt;code&gt;null&lt;/code&gt; if the stream has been closed</span>
149      *
150      * @see java.nio.charset.Charset
151      *
152      * @revised 1.4
153      * @spec JSR-51
154      */
155     public String getEncoding() {
156         return sd.getEncoding();
157     }
158 
159     /**
160      * Reads a single character.
161      *
162      * @return The character read, or -1 if the end of the stream has been
163      *         reached
164      *
<span class="line-modified">165      * @exception  IOException  If an I/O error occurs</span>
166      */
167     public int read() throws IOException {
168         return sd.read();
169     }
170 
171     /**
172      * Reads characters into a portion of an array.
173      *
174      * @param      cbuf     Destination buffer
175      * @param      offset   Offset at which to start storing characters
176      * @param      length   Maximum number of characters to read
177      *
178      * @return     The number of characters read, or -1 if the end of the
179      *             stream has been reached
180      *
<span class="line-modified">181      * @exception  IOException  If an I/O error occurs</span>
<span class="line-modified">182      * @exception  IndexOutOfBoundsException {@inheritDoc}</span>
183      */
184     public int read(char cbuf[], int offset, int length) throws IOException {
185         return sd.read(cbuf, offset, length);
186     }
187 
188     /**
189      * Tells whether this stream is ready to be read.  An InputStreamReader is
190      * ready if its input buffer is not empty, or if bytes are available to be
191      * read from the underlying byte stream.
192      *
<span class="line-modified">193      * @exception  IOException  If an I/O error occurs</span>
194      */
195     public boolean ready() throws IOException {
196         return sd.ready();
197     }
198 
199     public void close() throws IOException {
200         sd.close();
201     }
202 }
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 1996, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 53  *
 54  * @see BufferedReader
 55  * @see InputStream
 56  * @see java.nio.charset.Charset
 57  *
 58  * @author      Mark Reinhold
 59  * @since       1.1
 60  */
 61 
 62 public class InputStreamReader extends Reader {
 63 
 64     private final StreamDecoder sd;
 65 
 66     /**
 67      * Creates an InputStreamReader that uses the default charset.
 68      *
 69      * @param  in   An InputStream
 70      */
 71     public InputStreamReader(InputStream in) {
 72         super(in);
<span class="line-modified"> 73         sd = StreamDecoder.forInputStreamReader(in, this,</span>
<span class="line-modified"> 74                 Charset.defaultCharset()); // ## check lock object</span>




 75     }
 76 
 77     /**
 78      * Creates an InputStreamReader that uses the named charset.
 79      *
 80      * @param  in
 81      *         An InputStream
 82      *
 83      * @param  charsetName
 84      *         The name of a supported
 85      *         {@link java.nio.charset.Charset charset}
 86      *
<span class="line-modified"> 87      * @throws     UnsupportedEncodingException</span>
 88      *             If the named charset is not supported
 89      */
 90     public InputStreamReader(InputStream in, String charsetName)
 91         throws UnsupportedEncodingException
 92     {
 93         super(in);
 94         if (charsetName == null)
 95             throw new NullPointerException(&quot;charsetName&quot;);
 96         sd = StreamDecoder.forInputStreamReader(in, this, charsetName);
 97     }
 98 
 99     /**
100      * Creates an InputStreamReader that uses the given charset.
101      *
102      * @param  in       An InputStream
103      * @param  cs       A charset
104      *
105      * @since 1.4
106      * @spec JSR-51
107      */
</pre>
<hr />
<pre>
120      *
121      * @since 1.4
122      * @spec JSR-51
123      */
124     public InputStreamReader(InputStream in, CharsetDecoder dec) {
125         super(in);
126         if (dec == null)
127             throw new NullPointerException(&quot;charset decoder&quot;);
128         sd = StreamDecoder.forInputStreamReader(in, this, dec);
129     }
130 
131     /**
132      * Returns the name of the character encoding being used by this stream.
133      *
134      * &lt;p&gt; If the encoding has an historical name then that name is returned;
135      * otherwise the encoding&#39;s canonical name is returned.
136      *
137      * &lt;p&gt; If this instance was created with the {@link
138      * #InputStreamReader(InputStream, String)} constructor then the returned
139      * name, being unique for the encoding, may differ from the name passed to
<span class="line-modified">140      * the constructor. This method will return {@code null} if the</span>
141      * stream has been closed.
142      * &lt;/p&gt;
143      * @return The historical name of this encoding, or
<span class="line-modified">144      *         {@code null} if the stream has been closed</span>
145      *
146      * @see java.nio.charset.Charset
147      *
148      * @revised 1.4
149      * @spec JSR-51
150      */
151     public String getEncoding() {
152         return sd.getEncoding();
153     }
154 
155     /**
156      * Reads a single character.
157      *
158      * @return The character read, or -1 if the end of the stream has been
159      *         reached
160      *
<span class="line-modified">161      * @throws     IOException  If an I/O error occurs</span>
162      */
163     public int read() throws IOException {
164         return sd.read();
165     }
166 
167     /**
168      * Reads characters into a portion of an array.
169      *
170      * @param      cbuf     Destination buffer
171      * @param      offset   Offset at which to start storing characters
172      * @param      length   Maximum number of characters to read
173      *
174      * @return     The number of characters read, or -1 if the end of the
175      *             stream has been reached
176      *
<span class="line-modified">177      * @throws     IOException  If an I/O error occurs</span>
<span class="line-modified">178      * @throws     IndexOutOfBoundsException {@inheritDoc}</span>
179      */
180     public int read(char cbuf[], int offset, int length) throws IOException {
181         return sd.read(cbuf, offset, length);
182     }
183 
184     /**
185      * Tells whether this stream is ready to be read.  An InputStreamReader is
186      * ready if its input buffer is not empty, or if bytes are available to be
187      * read from the underlying byte stream.
188      *
<span class="line-modified">189      * @throws     IOException  If an I/O error occurs</span>
190      */
191     public boolean ready() throws IOException {
192         return sd.ready();
193     }
194 
195     public void close() throws IOException {
196         sd.close();
197     }
198 }
</pre>
</td>
</tr>
</table>
<center><a href="InputStream.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="InterruptedIOException.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>