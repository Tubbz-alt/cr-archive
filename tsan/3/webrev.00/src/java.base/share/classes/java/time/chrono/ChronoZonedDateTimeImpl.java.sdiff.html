<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/java/time/chrono/ChronoZonedDateTimeImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="ChronoZonedDateTime.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="Chronology.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/time/chrono/ChronoZonedDateTimeImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2012, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 90  * This class stores all date and time fields, to a precision of nanoseconds,
 91  * as well as a time-zone and zone offset.
 92  * &lt;p&gt;
 93  * The purpose of storing the time-zone is to distinguish the ambiguous case where
 94  * the local time-line overlaps, typically as a result of the end of daylight time.
 95  * Information about the local-time can be obtained using methods on the time-zone.
 96  *
 97  * @implSpec
 98  * This class is immutable and thread-safe.
 99  *
100  * @serial Document the delegation of this class in the serialized-form specification.
101  * @param &lt;D&gt; the concrete type for the date of this date-time
102  * @since 1.8
103  */
104 final class ChronoZonedDateTimeImpl&lt;D extends ChronoLocalDate&gt;
105         implements ChronoZonedDateTime&lt;D&gt;, Serializable {
106 
107     /**
108      * Serialization version.
109      */

110     private static final long serialVersionUID = -5261813987200935591L;
111 
112     /**
113      * The local date-time.
114      */
115     private final transient ChronoLocalDateTimeImpl&lt;D&gt; dateTime;
116     /**
117      * The zone offset.
118      */
119     private final transient ZoneOffset offset;
120     /**
121      * The zone ID.
122      */
123     private final transient ZoneId zone;
124 
125     //-----------------------------------------------------------------------
126     /**
127      * Obtains an instance from a local date-time using the preferred offset if possible.
128      *
129      * @param localDateTime  the local date-time, not null
</pre>
<hr />
<pre>
316             return dateTime.until(end.toLocalDateTime(), unit);
317         }
318         Objects.requireNonNull(unit, &quot;unit&quot;);
319         return unit.between(this, end);
320     }
321 
322     //-----------------------------------------------------------------------
323     /**
324      * Writes the ChronoZonedDateTime using a
325      * &lt;a href=&quot;{@docRoot}/serialized-form.html#java.time.chrono.Ser&quot;&gt;dedicated serialized form&lt;/a&gt;.
326      * @serialData
327      * &lt;pre&gt;
328      *  out.writeByte(3);                  // identifies a ChronoZonedDateTime
329      *  out.writeObject(toLocalDateTime());
330      *  out.writeObject(getOffset());
331      *  out.writeObject(getZone());
332      * &lt;/pre&gt;
333      *
334      * @return the instance of {@code Ser}, not null
335      */

336     private Object writeReplace() {
337         return new Ser(Ser.CHRONO_ZONE_DATE_TIME_TYPE, this);
338     }
339 
340     /**
341      * Defend against malicious streams.
342      *
343      * @param s the stream to read
344      * @throws InvalidObjectException always
345      */

346     private void readObject(ObjectInputStream s) throws InvalidObjectException {
347         throw new InvalidObjectException(&quot;Deserialization via serialization delegate&quot;);
348     }
349 
350     void writeExternal(ObjectOutput out) throws IOException {
351         out.writeObject(dateTime);
352         out.writeObject(offset);
353         out.writeObject(zone);
354     }
355 
356     static ChronoZonedDateTime&lt;?&gt; readExternal(ObjectInput in) throws IOException, ClassNotFoundException {
357         ChronoLocalDateTime&lt;?&gt; dateTime = (ChronoLocalDateTime&lt;?&gt;) in.readObject();
358         ZoneOffset offset = (ZoneOffset) in.readObject();
359         ZoneId zone = (ZoneId) in.readObject();
360         return dateTime.atZone(offset).withZoneSameLocal(zone);
361         // TODO: ZDT uses ofLenient()
362     }
363 
364     //-------------------------------------------------------------------------
365     @Override
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2012, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 90  * This class stores all date and time fields, to a precision of nanoseconds,
 91  * as well as a time-zone and zone offset.
 92  * &lt;p&gt;
 93  * The purpose of storing the time-zone is to distinguish the ambiguous case where
 94  * the local time-line overlaps, typically as a result of the end of daylight time.
 95  * Information about the local-time can be obtained using methods on the time-zone.
 96  *
 97  * @implSpec
 98  * This class is immutable and thread-safe.
 99  *
100  * @serial Document the delegation of this class in the serialized-form specification.
101  * @param &lt;D&gt; the concrete type for the date of this date-time
102  * @since 1.8
103  */
104 final class ChronoZonedDateTimeImpl&lt;D extends ChronoLocalDate&gt;
105         implements ChronoZonedDateTime&lt;D&gt;, Serializable {
106 
107     /**
108      * Serialization version.
109      */
<span class="line-added">110     @java.io.Serial</span>
111     private static final long serialVersionUID = -5261813987200935591L;
112 
113     /**
114      * The local date-time.
115      */
116     private final transient ChronoLocalDateTimeImpl&lt;D&gt; dateTime;
117     /**
118      * The zone offset.
119      */
120     private final transient ZoneOffset offset;
121     /**
122      * The zone ID.
123      */
124     private final transient ZoneId zone;
125 
126     //-----------------------------------------------------------------------
127     /**
128      * Obtains an instance from a local date-time using the preferred offset if possible.
129      *
130      * @param localDateTime  the local date-time, not null
</pre>
<hr />
<pre>
317             return dateTime.until(end.toLocalDateTime(), unit);
318         }
319         Objects.requireNonNull(unit, &quot;unit&quot;);
320         return unit.between(this, end);
321     }
322 
323     //-----------------------------------------------------------------------
324     /**
325      * Writes the ChronoZonedDateTime using a
326      * &lt;a href=&quot;{@docRoot}/serialized-form.html#java.time.chrono.Ser&quot;&gt;dedicated serialized form&lt;/a&gt;.
327      * @serialData
328      * &lt;pre&gt;
329      *  out.writeByte(3);                  // identifies a ChronoZonedDateTime
330      *  out.writeObject(toLocalDateTime());
331      *  out.writeObject(getOffset());
332      *  out.writeObject(getZone());
333      * &lt;/pre&gt;
334      *
335      * @return the instance of {@code Ser}, not null
336      */
<span class="line-added">337     @java.io.Serial</span>
338     private Object writeReplace() {
339         return new Ser(Ser.CHRONO_ZONE_DATE_TIME_TYPE, this);
340     }
341 
342     /**
343      * Defend against malicious streams.
344      *
345      * @param s the stream to read
346      * @throws InvalidObjectException always
347      */
<span class="line-added">348     @java.io.Serial</span>
349     private void readObject(ObjectInputStream s) throws InvalidObjectException {
350         throw new InvalidObjectException(&quot;Deserialization via serialization delegate&quot;);
351     }
352 
353     void writeExternal(ObjectOutput out) throws IOException {
354         out.writeObject(dateTime);
355         out.writeObject(offset);
356         out.writeObject(zone);
357     }
358 
359     static ChronoZonedDateTime&lt;?&gt; readExternal(ObjectInput in) throws IOException, ClassNotFoundException {
360         ChronoLocalDateTime&lt;?&gt; dateTime = (ChronoLocalDateTime&lt;?&gt;) in.readObject();
361         ZoneOffset offset = (ZoneOffset) in.readObject();
362         ZoneId zone = (ZoneId) in.readObject();
363         return dateTime.atZone(offset).withZoneSameLocal(zone);
364         // TODO: ZDT uses ofLenient()
365     }
366 
367     //-------------------------------------------------------------------------
368     @Override
</pre>
</td>
</tr>
</table>
<center><a href="ChronoZonedDateTime.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="Chronology.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>