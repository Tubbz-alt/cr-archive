<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/java/util/TreeMap.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="TooManyListenersException.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TreeSet.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/util/TreeMap.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 1997, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 116,10 ***</span>
<span class="line-new-header">--- 116,11 ---</span>
       * The comparator used to maintain order in this tree map, or
       * null if it uses the natural ordering of its keys.
       *
       * @serial
       */
<span class="line-added">+     @SuppressWarnings(&quot;serial&quot;) // Conditionally serializable</span>
      private final Comparator&lt;? super K&gt; comparator;
  
      private transient Entry&lt;K,V&gt; root;
  
      /**
</pre>
<hr />
<pre>
<span class="line-old-header">*** 309,12 ***</span>
       *         permit null keys
       */
      public void putAll(Map&lt;? extends K, ? extends V&gt; map) {
          int mapSize = map.size();
          if (size==0 &amp;&amp; mapSize!=0 &amp;&amp; map instanceof SortedMap) {
<span class="line-modified">!             Comparator&lt;?&gt; c = ((SortedMap&lt;?,?&gt;)map).comparator();</span>
<span class="line-removed">-             if (c == comparator || (c != null &amp;&amp; c.equals(comparator))) {</span>
                  ++modCount;
                  try {
                      buildFromSorted(mapSize, map.entrySet().iterator(),
                                      null, null);
                  } catch (java.io.IOException | ClassNotFoundException cannotHappen) {
<span class="line-new-header">--- 310,11 ---</span>
       *         permit null keys
       */
      public void putAll(Map&lt;? extends K, ? extends V&gt; map) {
          int mapSize = map.size();
          if (size==0 &amp;&amp; mapSize!=0 &amp;&amp; map instanceof SortedMap) {
<span class="line-modified">!             if (Objects.equals(comparator, ((SortedMap&lt;?,?&gt;)map).comparator())) {</span>
                  ++modCount;
                  try {
                      buildFromSorted(mapSize, map.entrySet().iterator(),
                                      null, null);
                  } catch (java.io.IOException | ClassNotFoundException cannotHappen) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1337,10 ***</span>
<span class="line-new-header">--- 1337,11 ---</span>
      /**
       * @serial include
       */
      abstract static class NavigableSubMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt;
          implements NavigableMap&lt;K,V&gt;, java.io.Serializable {
<span class="line-added">+         @java.io.Serial</span>
          private static final long serialVersionUID = -2102997345730753016L;
          /**
           * The backing map.
           */
          final TreeMap&lt;K,V&gt; m;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1351,11 ***</span>
           * true, then the low (absolute) bound is the start of the
           * backing map, and the other values are ignored. Otherwise,
           * if loInclusive is true, lo is the inclusive bound, else lo
           * is the exclusive bound. Similarly for the upper bound.
           */
<span class="line-modified">!         final K lo, hi;</span>
          final boolean fromStart, toEnd;
          final boolean loInclusive, hiInclusive;
  
          NavigableSubMap(TreeMap&lt;K,V&gt; m,
                          boolean fromStart, K lo, boolean loInclusive,
<span class="line-new-header">--- 1352,14 ---</span>
           * true, then the low (absolute) bound is the start of the
           * backing map, and the other values are ignored. Otherwise,
           * if loInclusive is true, lo is the inclusive bound, else lo
           * is the exclusive bound. Similarly for the upper bound.
           */
<span class="line-modified">!         @SuppressWarnings(&quot;serial&quot;) // Conditionally serializable</span>
<span class="line-added">+         final K lo;</span>
<span class="line-added">+         @SuppressWarnings(&quot;serial&quot;) // Conditionally serializable</span>
<span class="line-added">+         final K hi;</span>
          final boolean fromStart, toEnd;
          final boolean loInclusive, hiInclusive;
  
          NavigableSubMap(TreeMap&lt;K,V&gt; m,
                          boolean fromStart, K lo, boolean loInclusive,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1842,10 ***</span>
<span class="line-new-header">--- 1846,11 ---</span>
  
      /**
       * @serial include
       */
      static final class AscendingSubMap&lt;K,V&gt; extends NavigableSubMap&lt;K,V&gt; {
<span class="line-added">+         @java.io.Serial</span>
          private static final long serialVersionUID = 912986545866124060L;
  
          AscendingSubMap(TreeMap&lt;K,V&gt; m,
                          boolean fromStart, K lo, boolean loInclusive,
                          boolean toEnd,     K hi, boolean hiInclusive) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1925,17 ***</span>
<span class="line-new-header">--- 1930,19 ---</span>
  
      /**
       * @serial include
       */
      static final class DescendingSubMap&lt;K,V&gt;  extends NavigableSubMap&lt;K,V&gt; {
<span class="line-added">+         @java.io.Serial</span>
          private static final long serialVersionUID = 912986545866120460L;
          DescendingSubMap(TreeMap&lt;K,V&gt; m,
                          boolean fromStart, K lo, boolean loInclusive,
                          boolean toEnd,     K hi, boolean hiInclusive) {
              super(m, fromStart, lo, loInclusive, toEnd, hi, hiInclusive);
          }
  
<span class="line-added">+         @SuppressWarnings(&quot;serial&quot;) // Conditionally serializable</span>
          private final Comparator&lt;? super K&gt; reverseComparator =
              Collections.reverseOrder(m.comparator);
  
          public Comparator&lt;? super K&gt; comparator() {
              return reverseComparator;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2017,13 ***</span>
       *
       * @serial include
       */
      private class SubMap extends AbstractMap&lt;K,V&gt;
          implements SortedMap&lt;K,V&gt;, java.io.Serializable {
          private static final long serialVersionUID = -6520786458950516097L;
          private boolean fromStart = false, toEnd = false;
<span class="line-modified">!         private K fromKey, toKey;</span>
          private Object readResolve() {
              return new AscendingSubMap&lt;&gt;(TreeMap.this,
                                           fromStart, fromKey, true,
                                           toEnd, toKey, false);
          }
<span class="line-new-header">--- 2024,18 ---</span>
       *
       * @serial include
       */
      private class SubMap extends AbstractMap&lt;K,V&gt;
          implements SortedMap&lt;K,V&gt;, java.io.Serializable {
<span class="line-added">+         @java.io.Serial</span>
          private static final long serialVersionUID = -6520786458950516097L;
          private boolean fromStart = false, toEnd = false;
<span class="line-modified">!         @SuppressWarnings(&quot;serial&quot;) // Conditionally serializable</span>
<span class="line-added">+         private K fromKey;</span>
<span class="line-added">+         @SuppressWarnings(&quot;serial&quot;) // Conditionally serializable</span>
<span class="line-added">+         private K toKey;</span>
<span class="line-added">+         @java.io.Serial</span>
          private Object readResolve() {
              return new AscendingSubMap&lt;&gt;(TreeMap.this,
                                           fromStart, fromKey, true,
                                           toEnd, toKey, false);
          }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2404,10 ***</span>
<span class="line-new-header">--- 2416,11 ---</span>
          }
  
          setColor(x, BLACK);
      }
  
<span class="line-added">+     @java.io.Serial</span>
      private static final long serialVersionUID = 919286545866124006L;
  
      /**
       * Save the state of the {@code TreeMap} instance to a stream (i.e.,
       * serialize it).
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2418,10 ***</span>
<span class="line-new-header">--- 2431,11 ---</span>
       *             by the TreeMap. The key-value mappings are emitted in
       *             key-order (as determined by the TreeMap&#39;s Comparator,
       *             or by the keys&#39; natural ordering if the TreeMap has no
       *             Comparator).
       */
<span class="line-added">+     @java.io.Serial</span>
      private void writeObject(java.io.ObjectOutputStream s)
          throws java.io.IOException {
          // Write out the Comparator and any hidden stuff
          s.defaultWriteObject();
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2437,10 ***</span>
<span class="line-new-header">--- 2451,11 ---</span>
  
      /**
       * Reconstitute the {@code TreeMap} instance from a stream (i.e.,
       * deserialize it).
       */
<span class="line-added">+     @java.io.Serial</span>
      private void readObject(final java.io.ObjectInputStream s)
          throws java.io.IOException, ClassNotFoundException {
          // Read in the Comparator and any hidden stuff
          s.defaultReadObject();
  
</pre>
<center><a href="TooManyListenersException.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TreeSet.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>