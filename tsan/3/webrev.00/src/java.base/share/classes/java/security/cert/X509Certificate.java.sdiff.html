<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/java/security/cert/X509Certificate.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="X509CertSelector.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../interfaces/DSAKeyPairGenerator.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/security/cert/X509Certificate.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 1997, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 91  * an example of how to instantiate an X.509 certificate:
 92  * &lt;pre&gt;
 93  * try (InputStream inStream = new FileInputStream(&quot;fileName-of-cert&quot;)) {
 94  *     CertificateFactory cf = CertificateFactory.getInstance(&quot;X.509&quot;);
 95  *     X509Certificate cert = (X509Certificate)cf.generateCertificate(inStream);
 96  * }
 97  * &lt;/pre&gt;
 98  *
 99  * @author Hemma Prafullchandra
100  * @since 1.2
101  *
102  *
103  * @see Certificate
104  * @see CertificateFactory
105  * @see X509Extension
106  */
107 
108 public abstract class X509Certificate extends Certificate
109 implements X509Extension {
110 

111     private static final long serialVersionUID = -2491127588187038216L;
112 
113     private transient X500Principal subjectX500Principal, issuerX500Principal;
114 
115     /**
116      * Constructor for X.509 certificates.
117      */
118     protected X509Certificate() {
119         super(&quot;X.509&quot;);
120     }
121 
122     /**
123      * Checks that the certificate is currently valid. It is if
124      * the current date and time are within the validity period given in the
125      * certificate.
126      * &lt;p&gt;
127      * The validity period consists of two date/time values:
128      * the first and last dates (and times) on which the certificate
129      * is valid. It is defined in
130      * ASN.1 as:
131      * &lt;pre&gt;
132      * validity             Validity
133      *
134      * Validity ::= SEQUENCE {
135      *     notBefore      CertificateValidityDate,
136      *     notAfter       CertificateValidityDate }
137      *
138      * CertificateValidityDate ::= CHOICE {
139      *     utcTime        UTCTime,
140      *     generalTime    GeneralizedTime }
141      * &lt;/pre&gt;
142      *
<span class="line-modified">143      * @exception CertificateExpiredException if the certificate has expired.</span>
<span class="line-modified">144      * @exception CertificateNotYetValidException if the certificate is not</span>
145      * yet valid.
146      */
147     public abstract void checkValidity()
148         throws CertificateExpiredException, CertificateNotYetValidException;
149 
150     /**
151      * Checks that the given date is within the certificate&#39;s
152      * validity period. In other words, this determines whether the
153      * certificate would be valid at the given date/time.
154      *
155      * @param date the Date to check against to see if this certificate
156      *        is valid at that date/time.
157      *
<span class="line-modified">158      * @exception CertificateExpiredException if the certificate has expired</span>
159      * with respect to the {@code date} supplied.
<span class="line-modified">160      * @exception CertificateNotYetValidException if the certificate is not</span>
161      * yet valid with respect to the {@code date} supplied.
162      *
163      * @see #checkValidity()
164      */
165     public abstract void checkValidity(Date date)
166         throws CertificateExpiredException, CertificateNotYetValidException;
167 
168     /**
169      * Gets the {@code version} (version number) value from the
170      * certificate.
171      * The ASN.1 definition for this is:
172      * &lt;pre&gt;
173      * version  [0] EXPLICIT Version DEFAULT v1
174      *
175      * Version ::=  INTEGER  {  v1(0), v2(1), v3(2)  }
176      * &lt;/pre&gt;
177      * @return the version number, i.e. 1, 2 or 3.
178      */
179     public abstract int getVersion();
180 
</pre>
<hr />
<pre>
316      * @see #checkValidity
317      */
318     public abstract Date getNotBefore();
319 
320     /**
321      * Gets the {@code notAfter} date from the validity period of
322      * the certificate. See {@link #getNotBefore() getNotBefore}
323      * for relevant ASN.1 definitions.
324      *
325      * @return the end date of the validity period.
326      * @see #checkValidity
327      */
328     public abstract Date getNotAfter();
329 
330     /**
331      * Gets the DER-encoded certificate information, the
332      * {@code tbsCertificate} from this certificate.
333      * This can be used to verify the signature independently.
334      *
335      * @return the DER-encoded certificate information.
<span class="line-modified">336      * @exception CertificateEncodingException if an encoding error occurs.</span>
337      */
338     public abstract byte[] getTBSCertificate()
339         throws CertificateEncodingException;
340 
341     /**
342      * Gets the {@code signature} value (the raw signature bits) from
343      * the certificate.
344      * The ASN.1 definition for this is:
345      * &lt;pre&gt;
346      * signature     BIT STRING
347      * &lt;/pre&gt;
348      *
349      * @return the signature.
350      */
351     public abstract byte[] getSignature();
352 
353     /**
354      * Gets the signature algorithm name for the certificate
355      * signature algorithm. An example is the string &quot;SHA256withRSA&quot;.
356      * The ASN.1 definition for this is:
</pre>
<hr />
<pre>
648     public Collection&lt;List&lt;?&gt;&gt; getIssuerAlternativeNames()
649         throws CertificateParsingException {
650         return X509CertImpl.getIssuerAlternativeNames(this);
651     }
652 
653     /**
654      * Verifies that this certificate was signed using the
655      * private key that corresponds to the specified public key.
656      * This method uses the signature verification engine
657      * supplied by the specified provider. Note that the specified
658      * Provider object does not have to be registered in the provider list.
659      *
660      * This method was added to version 1.8 of the Java Platform Standard
661      * Edition. In order to maintain backwards compatibility with existing
662      * service providers, this method is not {@code abstract}
663      * and it provides a default implementation.
664      *
665      * @param key the PublicKey used to carry out the verification.
666      * @param sigProvider the signature provider.
667      *
<span class="line-modified">668      * @exception NoSuchAlgorithmException on unsupported signature</span>
669      * algorithms.
<span class="line-modified">670      * @exception InvalidKeyException on incorrect key.</span>
<span class="line-modified">671      * @exception SignatureException on signature errors.</span>
<span class="line-modified">672      * @exception CertificateException on encoding errors.</span>
<span class="line-modified">673      * @exception UnsupportedOperationException if the method is not supported</span>
674      * @since 1.8
675      */
676     public void verify(PublicKey key, Provider sigProvider)
677         throws CertificateException, NoSuchAlgorithmException,
678         InvalidKeyException, SignatureException {

679         Signature sig = (sigProvider == null)
<span class="line-modified">680             ? Signature.getInstance(getSigAlgName())</span>
<span class="line-modified">681             : Signature.getInstance(getSigAlgName(), sigProvider);</span>
682 
<span class="line-removed">683         sig.initVerify(key);</span>
<span class="line-removed">684 </span>
<span class="line-removed">685         // set parameters after Signature.initSign/initVerify call,</span>
<span class="line-removed">686         // so the deferred provider selections occur when key is set</span>
687         try {
<span class="line-modified">688             SignatureUtil.specialSetParameter(sig, getSigAlgParams());</span>

689         } catch (ProviderException e) {
690             throw new CertificateException(e.getMessage(), e.getCause());
691         } catch (InvalidAlgorithmParameterException e) {
692             throw new CertificateException(e);
693         }
694 
695         byte[] tbsCert = getTBSCertificate();
696         sig.update(tbsCert, 0, tbsCert.length);
697 
698         if (sig.verify(getSignature()) == false) {
699             throw new SignatureException(&quot;Signature does not match.&quot;);
700         }
701     }
702 }
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 91  * an example of how to instantiate an X.509 certificate:
 92  * &lt;pre&gt;
 93  * try (InputStream inStream = new FileInputStream(&quot;fileName-of-cert&quot;)) {
 94  *     CertificateFactory cf = CertificateFactory.getInstance(&quot;X.509&quot;);
 95  *     X509Certificate cert = (X509Certificate)cf.generateCertificate(inStream);
 96  * }
 97  * &lt;/pre&gt;
 98  *
 99  * @author Hemma Prafullchandra
100  * @since 1.2
101  *
102  *
103  * @see Certificate
104  * @see CertificateFactory
105  * @see X509Extension
106  */
107 
108 public abstract class X509Certificate extends Certificate
109 implements X509Extension {
110 
<span class="line-added">111     @java.io.Serial</span>
112     private static final long serialVersionUID = -2491127588187038216L;
113 
114     private transient X500Principal subjectX500Principal, issuerX500Principal;
115 
116     /**
117      * Constructor for X.509 certificates.
118      */
119     protected X509Certificate() {
120         super(&quot;X.509&quot;);
121     }
122 
123     /**
124      * Checks that the certificate is currently valid. It is if
125      * the current date and time are within the validity period given in the
126      * certificate.
127      * &lt;p&gt;
128      * The validity period consists of two date/time values:
129      * the first and last dates (and times) on which the certificate
130      * is valid. It is defined in
131      * ASN.1 as:
132      * &lt;pre&gt;
133      * validity             Validity
134      *
135      * Validity ::= SEQUENCE {
136      *     notBefore      CertificateValidityDate,
137      *     notAfter       CertificateValidityDate }
138      *
139      * CertificateValidityDate ::= CHOICE {
140      *     utcTime        UTCTime,
141      *     generalTime    GeneralizedTime }
142      * &lt;/pre&gt;
143      *
<span class="line-modified">144      * @throws    CertificateExpiredException if the certificate has expired.</span>
<span class="line-modified">145      * @throws    CertificateNotYetValidException if the certificate is not</span>
146      * yet valid.
147      */
148     public abstract void checkValidity()
149         throws CertificateExpiredException, CertificateNotYetValidException;
150 
151     /**
152      * Checks that the given date is within the certificate&#39;s
153      * validity period. In other words, this determines whether the
154      * certificate would be valid at the given date/time.
155      *
156      * @param date the Date to check against to see if this certificate
157      *        is valid at that date/time.
158      *
<span class="line-modified">159      * @throws    CertificateExpiredException if the certificate has expired</span>
160      * with respect to the {@code date} supplied.
<span class="line-modified">161      * @throws    CertificateNotYetValidException if the certificate is not</span>
162      * yet valid with respect to the {@code date} supplied.
163      *
164      * @see #checkValidity()
165      */
166     public abstract void checkValidity(Date date)
167         throws CertificateExpiredException, CertificateNotYetValidException;
168 
169     /**
170      * Gets the {@code version} (version number) value from the
171      * certificate.
172      * The ASN.1 definition for this is:
173      * &lt;pre&gt;
174      * version  [0] EXPLICIT Version DEFAULT v1
175      *
176      * Version ::=  INTEGER  {  v1(0), v2(1), v3(2)  }
177      * &lt;/pre&gt;
178      * @return the version number, i.e. 1, 2 or 3.
179      */
180     public abstract int getVersion();
181 
</pre>
<hr />
<pre>
317      * @see #checkValidity
318      */
319     public abstract Date getNotBefore();
320 
321     /**
322      * Gets the {@code notAfter} date from the validity period of
323      * the certificate. See {@link #getNotBefore() getNotBefore}
324      * for relevant ASN.1 definitions.
325      *
326      * @return the end date of the validity period.
327      * @see #checkValidity
328      */
329     public abstract Date getNotAfter();
330 
331     /**
332      * Gets the DER-encoded certificate information, the
333      * {@code tbsCertificate} from this certificate.
334      * This can be used to verify the signature independently.
335      *
336      * @return the DER-encoded certificate information.
<span class="line-modified">337      * @throws    CertificateEncodingException if an encoding error occurs.</span>
338      */
339     public abstract byte[] getTBSCertificate()
340         throws CertificateEncodingException;
341 
342     /**
343      * Gets the {@code signature} value (the raw signature bits) from
344      * the certificate.
345      * The ASN.1 definition for this is:
346      * &lt;pre&gt;
347      * signature     BIT STRING
348      * &lt;/pre&gt;
349      *
350      * @return the signature.
351      */
352     public abstract byte[] getSignature();
353 
354     /**
355      * Gets the signature algorithm name for the certificate
356      * signature algorithm. An example is the string &quot;SHA256withRSA&quot;.
357      * The ASN.1 definition for this is:
</pre>
<hr />
<pre>
649     public Collection&lt;List&lt;?&gt;&gt; getIssuerAlternativeNames()
650         throws CertificateParsingException {
651         return X509CertImpl.getIssuerAlternativeNames(this);
652     }
653 
654     /**
655      * Verifies that this certificate was signed using the
656      * private key that corresponds to the specified public key.
657      * This method uses the signature verification engine
658      * supplied by the specified provider. Note that the specified
659      * Provider object does not have to be registered in the provider list.
660      *
661      * This method was added to version 1.8 of the Java Platform Standard
662      * Edition. In order to maintain backwards compatibility with existing
663      * service providers, this method is not {@code abstract}
664      * and it provides a default implementation.
665      *
666      * @param key the PublicKey used to carry out the verification.
667      * @param sigProvider the signature provider.
668      *
<span class="line-modified">669      * @throws    NoSuchAlgorithmException on unsupported signature</span>
670      * algorithms.
<span class="line-modified">671      * @throws    InvalidKeyException on incorrect key.</span>
<span class="line-modified">672      * @throws    SignatureException on signature errors.</span>
<span class="line-modified">673      * @throws    CertificateException on encoding errors.</span>
<span class="line-modified">674      * @throws    UnsupportedOperationException if the method is not supported</span>
675      * @since 1.8
676      */
677     public void verify(PublicKey key, Provider sigProvider)
678         throws CertificateException, NoSuchAlgorithmException,
679         InvalidKeyException, SignatureException {
<span class="line-added">680         String sigName = getSigAlgName();</span>
681         Signature sig = (sigProvider == null)
<span class="line-modified">682             ? Signature.getInstance(sigName)</span>
<span class="line-modified">683             : Signature.getInstance(sigName, sigProvider);</span>
684 




685         try {
<span class="line-modified">686             SignatureUtil.initVerifyWithParam(sig, key,</span>
<span class="line-added">687                 SignatureUtil.getParamSpec(sigName, getSigAlgParams()));</span>
688         } catch (ProviderException e) {
689             throw new CertificateException(e.getMessage(), e.getCause());
690         } catch (InvalidAlgorithmParameterException e) {
691             throw new CertificateException(e);
692         }
693 
694         byte[] tbsCert = getTBSCertificate();
695         sig.update(tbsCert, 0, tbsCert.length);
696 
697         if (sig.verify(getSignature()) == false) {
698             throw new SignatureException(&quot;Signature does not match.&quot;);
699         }
700     }
701 }
</pre>
</td>
</tr>
</table>
<center><a href="X509CertSelector.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../interfaces/DSAKeyPairGenerator.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>