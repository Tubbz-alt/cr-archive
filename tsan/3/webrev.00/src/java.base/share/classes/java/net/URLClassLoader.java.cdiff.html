<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/java/net/URLClassLoader.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="URL.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="URLConnection.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/net/URLClassLoader.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 1997, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 50,11 ***</span>
  import java.util.jar.JarFile;
  import java.util.jar.Manifest;
  
  import jdk.internal.loader.Resource;
  import jdk.internal.loader.URLClassPath;
<span class="line-removed">- import jdk.internal.access.JavaNetURLClassLoaderAccess;</span>
  import jdk.internal.access.SharedSecrets;
  import jdk.internal.perf.PerfCounter;
  import sun.net.www.ParseUtil;
  import sun.security.util.SecurityConstants;
  
<span class="line-new-header">--- 50,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 98,16 ***</span>
       *
       * &lt;p&gt;If there is a security manager, this method first
       * calls the security manager&#39;s {@code checkCreateClassLoader} method
       * to ensure creation of a class loader is allowed.
       *
<span class="line-modified">!      * @param urls the URLs from which to load classes and resources</span>
<span class="line-modified">!      * @param parent the parent class loader for delegation</span>
<span class="line-modified">!      * @exception  SecurityException  if a security manager exists and its</span>
       *             {@code checkCreateClassLoader} method doesn&#39;t allow
       *             creation of a class loader.
<span class="line-modified">!      * @exception  NullPointerException if {@code urls} or any of its</span>
       *             elements is {@code null}.
       * @see SecurityManager#checkCreateClassLoader
       */
      public URLClassLoader(URL[] urls, ClassLoader parent) {
          super(parent);
<span class="line-new-header">--- 97,16 ---</span>
       *
       * &lt;p&gt;If there is a security manager, this method first
       * calls the security manager&#39;s {@code checkCreateClassLoader} method
       * to ensure creation of a class loader is allowed.
       *
<span class="line-modified">!      * @param      urls the URLs from which to load classes and resources</span>
<span class="line-modified">!      * @param      parent the parent class loader for delegation</span>
<span class="line-modified">!      * @throws     SecurityException  if a security manager exists and its</span>
       *             {@code checkCreateClassLoader} method doesn&#39;t allow
       *             creation of a class loader.
<span class="line-modified">!      * @throws     NullPointerException if {@code urls} or any of its</span>
       *             elements is {@code null}.
       * @see SecurityManager#checkCreateClassLoader
       */
      public URLClassLoader(URL[] urls, ClassLoader parent) {
          super(parent);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 133,16 ***</span>
       *
       * &lt;p&gt;If there is a security manager, this method first
       * calls the security manager&#39;s {@code checkCreateClassLoader} method
       * to ensure creation of a class loader is allowed.
       *
<span class="line-modified">!      * @param urls the URLs from which to load classes and resources</span>
       *
<span class="line-modified">!      * @exception  SecurityException  if a security manager exists and its</span>
       *             {@code checkCreateClassLoader} method doesn&#39;t allow
       *             creation of a class loader.
<span class="line-modified">!      * @exception  NullPointerException if {@code urls} or any of its</span>
       *             elements is {@code null}.
       * @see SecurityManager#checkCreateClassLoader
       */
      public URLClassLoader(URL[] urls) {
          super();
<span class="line-new-header">--- 132,16 ---</span>
       *
       * &lt;p&gt;If there is a security manager, this method first
       * calls the security manager&#39;s {@code checkCreateClassLoader} method
       * to ensure creation of a class loader is allowed.
       *
<span class="line-modified">!      * @param      urls the URLs from which to load classes and resources</span>
       *
<span class="line-modified">!      * @throws     SecurityException  if a security manager exists and its</span>
       *             {@code checkCreateClassLoader} method doesn&#39;t allow
       *             creation of a class loader.
<span class="line-modified">!      * @throws     NullPointerException if {@code urls} or any of its</span>
       *             elements is {@code null}.
       * @see SecurityManager#checkCreateClassLoader
       */
      public URLClassLoader(URL[] urls) {
          super();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 165,19 ***</span>
       *
       * &lt;p&gt;If there is a security manager, this method first
       * calls the security manager&#39;s {@code checkCreateClassLoader} method
       * to ensure creation of a class loader is allowed.
       *
<span class="line-modified">!      * @param urls the URLs from which to load classes and resources</span>
<span class="line-modified">!      * @param parent the parent class loader for delegation</span>
<span class="line-modified">!      * @param factory the URLStreamHandlerFactory to use when creating URLs</span>
       *
<span class="line-modified">!      * @exception  SecurityException  if a security manager exists and its</span>
<span class="line-modified">!      *             {@code checkCreateClassLoader} method doesn&#39;t allow</span>
<span class="line-modified">!      *             creation of a class loader.</span>
<span class="line-modified">!      * @exception  NullPointerException if {@code urls} or any of its</span>
<span class="line-modified">!      *             elements is {@code null}.</span>
       * @see SecurityManager#checkCreateClassLoader
       */
      public URLClassLoader(URL[] urls, ClassLoader parent,
                            URLStreamHandlerFactory factory) {
          super(parent);
<span class="line-new-header">--- 164,19 ---</span>
       *
       * &lt;p&gt;If there is a security manager, this method first
       * calls the security manager&#39;s {@code checkCreateClassLoader} method
       * to ensure creation of a class loader is allowed.
       *
<span class="line-modified">!      * @param  urls the URLs from which to load classes and resources</span>
<span class="line-modified">!      * @param  parent the parent class loader for delegation</span>
<span class="line-modified">!      * @param  factory the URLStreamHandlerFactory to use when creating URLs</span>
       *
<span class="line-modified">!      * @throws SecurityException  if a security manager exists and its</span>
<span class="line-modified">!      *         {@code checkCreateClassLoader} method doesn&#39;t allow</span>
<span class="line-modified">!      *         creation of a class loader.</span>
<span class="line-modified">!      * @throws NullPointerException if {@code urls} or any of its</span>
<span class="line-modified">!      *         elements is {@code null}.</span>
       * @see SecurityManager#checkCreateClassLoader
       */
      public URLClassLoader(URL[] urls, ClassLoader parent,
                            URLStreamHandlerFactory factory) {
          super(parent);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 325,17 ***</span>
      * The method makes a best effort attempt to close all opened files,
      * by catching {@link IOException}s internally. Unchecked exceptions
      * and errors are not caught. Calling close on an already closed
      * loader has no effect.
      *
<span class="line-modified">!     * @exception IOException if closing any file opened by this class loader</span>
      * resulted in an IOException. Any such exceptions are caught internally.
      * If only one is caught, then it is re-thrown. If more than one exception
      * is caught, then the second and following exceptions are added
      * as suppressed exceptions of the first one caught, which is then re-thrown.
      *
<span class="line-modified">!     * @exception SecurityException if a security manager is set, and it denies</span>
      *   {@link RuntimePermission}{@code (&quot;closeClassLoader&quot;)}
      *
      * @since 1.7
      */
      public void close() throws IOException {
<span class="line-new-header">--- 324,17 ---</span>
      * The method makes a best effort attempt to close all opened files,
      * by catching {@link IOException}s internally. Unchecked exceptions
      * and errors are not caught. Calling close on an already closed
      * loader has no effect.
      *
<span class="line-modified">!     * @throws    IOException if closing any file opened by this class loader</span>
      * resulted in an IOException. Any such exceptions are caught internally.
      * If only one is caught, then it is re-thrown. If more than one exception
      * is caught, then the second and following exceptions are added
      * as suppressed exceptions of the first one caught, which is then re-thrown.
      *
<span class="line-modified">!     * @throws    SecurityException if a security manager is set, and it denies</span>
      *   {@link RuntimePermission}{@code (&quot;closeClassLoader&quot;)}
      *
      * @since 1.7
      */
      public void close() throws IOException {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 400,15 ***</span>
      /**
       * Finds and loads the class with the specified name from the URL search
       * path. Any URLs referring to JAR files are loaded and opened as needed
       * until the class is found.
       *
<span class="line-modified">!      * @param name the name of the class</span>
<span class="line-modified">!      * @return the resulting class</span>
<span class="line-modified">!      * @exception ClassNotFoundException if the class could not be found,</span>
       *            or if the loader is closed.
<span class="line-modified">!      * @exception NullPointerException if {@code name} is {@code null}.</span>
       */
      protected Class&lt;?&gt; findClass(final String name)
          throws ClassNotFoundException
      {
          final Class&lt;?&gt; result;
<span class="line-new-header">--- 399,15 ---</span>
      /**
       * Finds and loads the class with the specified name from the URL search
       * path. Any URLs referring to JAR files are loaded and opened as needed
       * until the class is found.
       *
<span class="line-modified">!      * @param     name the name of the class</span>
<span class="line-modified">!      * @return    the resulting class</span>
<span class="line-modified">!      * @throws    ClassNotFoundException if the class could not be found,</span>
       *            or if the loader is closed.
<span class="line-modified">!      * @throws    NullPointerException if {@code name} is {@code null}.</span>
       */
      protected Class&lt;?&gt; findClass(final String name)
          throws ClassNotFoundException
      {
          final Class&lt;?&gt; result;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 627,11 ***</span>
      /**
       * Returns an Enumeration of URLs representing all of the resources
       * on the URL search path having the specified name.
       *
       * @param name the resource name
<span class="line-modified">!      * @exception IOException if an I/O exception occurs</span>
       * @return An {@code Enumeration} of {@code URL}s.
       *         If the loader is closed, the Enumeration contains no elements.
       */
      public Enumeration&lt;URL&gt; findResources(final String name)
          throws IOException
<span class="line-new-header">--- 626,11 ---</span>
      /**
       * Returns an Enumeration of URLs representing all of the resources
       * on the URL search path having the specified name.
       *
       * @param name the resource name
<span class="line-modified">!      * @throws    IOException if an I/O exception occurs</span>
       * @return An {@code Enumeration} of {@code URL}s.
       *         If the loader is closed, the Enumeration contains no elements.
       */
      public Enumeration&lt;URL&gt; findResources(final String name)
          throws IOException
</pre>
<hr />
<pre>
<span class="line-old-header">*** 695,11 ***</span>
       * that directory.
       * &lt;p&gt;
       * If the protocol is not &quot;file&quot;, then permission
       * to connect to and accept connections from the URL&#39;s host is granted.
       * @param codesource the codesource
<span class="line-modified">!      * @exception NullPointerException if {@code codesource} is {@code null}.</span>
       * @return the permissions granted to the codesource
       */
      protected PermissionCollection getPermissions(CodeSource codesource)
      {
          PermissionCollection perms = super.getPermissions(codesource);
<span class="line-new-header">--- 694,11 ---</span>
       * that directory.
       * &lt;p&gt;
       * If the protocol is not &quot;file&quot;, then permission
       * to connect to and accept connections from the URL&#39;s host is granted.
       * @param codesource the codesource
<span class="line-modified">!      * @throws    NullPointerException if {@code codesource} is {@code null}.</span>
       * @return the permissions granted to the codesource
       */
      protected PermissionCollection getPermissions(CodeSource codesource)
      {
          PermissionCollection perms = super.getPermissions(codesource);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 775,11 ***</span>
       * {@code SecurityManager.checkPackageAccess} method before
       * loading the class.
       *
       * @param urls the URLs to search for classes and resources
       * @param parent the parent class loader for delegation
<span class="line-modified">!      * @exception  NullPointerException if {@code urls} or any of its</span>
       *             elements is {@code null}.
       * @return the resulting class loader
       */
      public static URLClassLoader newInstance(final URL[] urls,
                                               final ClassLoader parent) {
<span class="line-new-header">--- 774,11 ---</span>
       * {@code SecurityManager.checkPackageAccess} method before
       * loading the class.
       *
       * @param urls the URLs to search for classes and resources
       * @param parent the parent class loader for delegation
<span class="line-modified">!      * @throws     NullPointerException if {@code urls} or any of its</span>
       *             elements is {@code null}.
       * @return the resulting class loader
       */
      public static URLClassLoader newInstance(final URL[] urls,
                                               final ClassLoader parent) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 802,11 ***</span>
       * returned by this method will invoke the
       * {@code SecurityManager.checkPackageAccess} before
       * loading the class.
       *
       * @param urls the URLs to search for classes and resources
<span class="line-modified">!      * @exception  NullPointerException if {@code urls} or any of its</span>
       *             elements is {@code null}.
       * @return the resulting class loader
       */
      public static URLClassLoader newInstance(final URL[] urls) {
          // Save the caller&#39;s context
<span class="line-new-header">--- 801,11 ---</span>
       * returned by this method will invoke the
       * {@code SecurityManager.checkPackageAccess} before
       * loading the class.
       *
       * @param urls the URLs to search for classes and resources
<span class="line-modified">!      * @throws     NullPointerException if {@code urls} or any of its</span>
       *             elements is {@code null}.
       * @return the resulting class loader
       */
      public static URLClassLoader newInstance(final URL[] urls) {
          // Save the caller&#39;s context
</pre>
<hr />
<pre>
<span class="line-old-header">*** 820,18 ***</span>
              });
          return ucl;
      }
  
      static {
<span class="line-removed">-         SharedSecrets.setJavaNetURLClassLoaderAccess(</span>
<span class="line-removed">-             new JavaNetURLClassLoaderAccess() {</span>
<span class="line-removed">-                 @Override</span>
<span class="line-removed">-                 public AccessControlContext getAccessControlContext(URLClassLoader u) {</span>
<span class="line-removed">-                     return u.acc;</span>
<span class="line-removed">-                 }</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-         );</span>
          ClassLoader.registerAsParallelCapable();
      }
  }
  
  final class FactoryURLClassLoader extends URLClassLoader {
<span class="line-new-header">--- 819,10 ---</span>
</pre>
<center><a href="URL.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="URLConnection.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>