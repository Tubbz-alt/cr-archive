<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.base/share/classes/javax/crypto/Cipher.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="BadPaddingException.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="CipherSpi.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/javax/crypto/Cipher.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 1997, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -145,14 +145,10 @@</span>
   * &lt;li&gt;{@code AES/CBC/NoPadding} (128)&lt;/li&gt;
   * &lt;li&gt;{@code AES/CBC/PKCS5Padding} (128)&lt;/li&gt;
   * &lt;li&gt;{@code AES/ECB/NoPadding} (128)&lt;/li&gt;
   * &lt;li&gt;{@code AES/ECB/PKCS5Padding} (128)&lt;/li&gt;
   * &lt;li&gt;{@code AES/GCM/NoPadding} (128)&lt;/li&gt;
<span class="udiff-line-removed">-  * &lt;li&gt;{@code DES/CBC/NoPadding} (56)&lt;/li&gt;</span>
<span class="udiff-line-removed">-  * &lt;li&gt;{@code DES/CBC/PKCS5Padding} (56)&lt;/li&gt;</span>
<span class="udiff-line-removed">-  * &lt;li&gt;{@code DES/ECB/NoPadding} (56)&lt;/li&gt;</span>
<span class="udiff-line-removed">-  * &lt;li&gt;{@code DES/ECB/PKCS5Padding} (56)&lt;/li&gt;</span>
   * &lt;li&gt;{@code DESede/CBC/NoPadding} (168)&lt;/li&gt;
   * &lt;li&gt;{@code DESede/CBC/PKCS5Padding} (168)&lt;/li&gt;
   * &lt;li&gt;{@code DESede/ECB/NoPadding} (168)&lt;/li&gt;
   * &lt;li&gt;{@code DESede/ECB/PKCS5Padding} (168)&lt;/li&gt;
   * &lt;li&gt;{@code RSA/ECB/PKCS1Padding} (1024, 2048)&lt;/li&gt;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -266,19 +262,22 @@</span>
       * Creates a Cipher object.
       *
       * @param cipherSpi the delegate
       * @param provider the provider
       * @param transformation the transformation
<span class="udiff-line-added">+      * @throws NullPointerException if {@code provider} is {@code null}</span>
<span class="udiff-line-added">+      * @throws IllegalArgumentException if the supplied arguments</span>
<span class="udiff-line-added">+      *         are deemed invalid for constructing the Cipher object</span>
       */
      protected Cipher(CipherSpi cipherSpi,
                       Provider provider,
                       String transformation) {
          // See bug 4341369 &amp; 4334690 for more info.
          // If the caller is trusted, then okay.
<span class="udiff-line-modified-removed">-         // Otherwise throw a NullPointerException.</span>
<span class="udiff-line-modified-added">+         // Otherwise throw an IllegalArgumentException.</span>
          if (!JceSecurityManager.INSTANCE.isCallerTrusted(provider)) {
<span class="udiff-line-modified-removed">-             throw new NullPointerException();</span>
<span class="udiff-line-modified-added">+             throw new IllegalArgumentException(&quot;Cannot construct cipher&quot;);</span>
          }
          this.spi = cipherSpi;
          this.provider = provider;
          this.transformation = transformation;
          this.cryptoPerm = CryptoAllPermission.INSTANCE;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -557,20 +556,20 @@</span>
              int canuse = tr.supportsModePadding(s);
              if (canuse == S_NO) {
                  // does not support mode or padding we need, ignore
                  continue;
              }
<span class="udiff-line-modified-removed">-             if (canuse == S_YES) {</span>
<span class="udiff-line-modified-added">+             // S_YES, S_MAYBE</span>
<span class="udiff-line-added">+             // even when mode and padding are both supported, they</span>
<span class="udiff-line-added">+             // may not be used together, try out and see if it works</span>
<span class="udiff-line-added">+             try {</span>
<span class="udiff-line-added">+                 CipherSpi spi = (CipherSpi)s.newInstance(null);</span>
<span class="udiff-line-added">+                 tr.setModePadding(spi);</span>
<span class="udiff-line-added">+                 // specify null instead of spi for delayed provider selection</span>
                  return new Cipher(null, s, t, transformation, transforms);
<span class="udiff-line-modified-removed">-             } else { // S_MAYBE, try out if it works</span>
<span class="udiff-line-modified-removed">-                 try {</span>
<span class="udiff-line-removed">-                     CipherSpi spi = (CipherSpi)s.newInstance(null);</span>
<span class="udiff-line-removed">-                     tr.setModePadding(spi);</span>
<span class="udiff-line-removed">-                     return new Cipher(spi, s, t, transformation, transforms);</span>
<span class="udiff-line-removed">-                 } catch (Exception e) {</span>
<span class="udiff-line-removed">-                     failure = e;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-modified-added">+             } catch (Exception e) {</span>
<span class="udiff-line-modified-added">+                 failure = e;</span>
              }
          }
          throw new NoSuchAlgorithmException
              (&quot;Cannot find any provider supporting &quot; + transformation, failure);
      }
</pre>
<center><a href="BadPaddingException.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="CipherSpi.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>