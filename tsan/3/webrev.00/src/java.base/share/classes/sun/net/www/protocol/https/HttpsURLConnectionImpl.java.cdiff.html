<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/sun/net/www/protocol/https/HttpsURLConnectionImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DelegateHttpsURLConnection.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../jar/Handler.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/net/www/protocol/https/HttpsURLConnectionImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 35,10 ***</span>
<span class="line-new-header">--- 35,11 ---</span>
  import java.security.Permission;
  import java.security.Principal;
  import java.util.Map;
  import java.util.List;
  import java.util.Optional;
<span class="line-added">+ import sun.net.util.IPAddressUtil;</span>
  import sun.net.www.http.HttpClient;
  
  /**
   * A class to represent an HTTP connection to a remote object.
   *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 55,12 ***</span>
   *
   */
  public class HttpsURLConnectionImpl
          extends javax.net.ssl.HttpsURLConnection {
  
<span class="line-modified">!     // NOTE: made protected for plugin so that subclass can set it.</span>
<span class="line-removed">-     protected DelegateHttpsURLConnection delegate;</span>
  
      HttpsURLConnectionImpl(URL u, Handler handler) throws IOException {
          this(u, null, handler);
      }
  
<span class="line-new-header">--- 56,11 ---</span>
   *
   */
  public class HttpsURLConnectionImpl
          extends javax.net.ssl.HttpsURLConnection {
  
<span class="line-modified">!     private final DelegateHttpsURLConnection delegate;</span>
  
      HttpsURLConnectionImpl(URL u, Handler handler) throws IOException {
          this(u, null, handler);
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 68,25 ***</span>
          if (u != null) {
              if (u.toExternalForm().indexOf(&#39;\n&#39;) &gt; -1) {
                  throw new MalformedURLException(&quot;Illegal character in URL&quot;);
              }
          }
          return u;
      }
  
      HttpsURLConnectionImpl(URL u, Proxy p, Handler handler) throws IOException {
          super(checkURL(u));
          delegate = new DelegateHttpsURLConnection(url, p, handler, this);
      }
  
<span class="line-removed">-     // NOTE: introduced for plugin</span>
<span class="line-removed">-     // subclass needs to overwrite this to set delegate to</span>
<span class="line-removed">-     // the appropriate delegatee</span>
<span class="line-removed">-     protected HttpsURLConnectionImpl(URL u) throws IOException {</span>
<span class="line-removed">-         super(u);</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      /**
       * Create a new HttpClient object, bypassing the cache of
       * HTTP client objects/connections.
       *
       * @param url       the URL being accessed
<span class="line-new-header">--- 68,22 ---</span>
          if (u != null) {
              if (u.toExternalForm().indexOf(&#39;\n&#39;) &gt; -1) {
                  throw new MalformedURLException(&quot;Illegal character in URL&quot;);
              }
          }
<span class="line-added">+         String s = IPAddressUtil.checkAuthority(u);</span>
<span class="line-added">+         if (s != null) {</span>
<span class="line-added">+             throw new MalformedURLException(s);</span>
<span class="line-added">+         }</span>
          return u;
      }
  
      HttpsURLConnectionImpl(URL u, Proxy p, Handler handler) throws IOException {
          super(checkURL(u));
          delegate = new DelegateHttpsURLConnection(url, p, handler, this);
      }
  
      /**
       * Create a new HttpClient object, bypassing the cache of
       * HTTP client objects/connections.
       *
       * @param url       the URL being accessed
</pre>
<hr />
<pre>
<span class="line-old-header">*** 217,15 ***</span>
       * - get input, [read input]
       * Disallowed:
       * - get input, [read input,] get output, [write output]
       */
  
<span class="line-modified">!     public synchronized OutputStream getOutputStream() throws IOException {</span>
          return delegate.getOutputStream();
      }
  
<span class="line-modified">!     public synchronized InputStream getInputStream() throws IOException {</span>
          return delegate.getInputStream();
      }
  
      public InputStream getErrorStream() {
          return delegate.getErrorStream();
<span class="line-new-header">--- 214,15 ---</span>
       * - get input, [read input]
       * Disallowed:
       * - get input, [read input,] get output, [write output]
       */
  
<span class="line-modified">!     public OutputStream getOutputStream() throws IOException {</span>
          return delegate.getOutputStream();
      }
  
<span class="line-modified">!     public InputStream getInputStream() throws IOException {</span>
          return delegate.getInputStream();
      }
  
      public InputStream getErrorStream() {
          return delegate.getErrorStream();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 295,11 ***</span>
       * existing values associated with the same key.
       *
       * @param   key     the keyword by which the request is known
       *                  (e.g., &quot;&lt;code&gt;accept&lt;/code&gt;&quot;).
       * @param   value  the value associated with it.
<span class="line-modified">!      * @see #getRequestProperties(java.lang.String)</span>
       * @since 1.4
       */
      public void addRequestProperty(String key, String value) {
          delegate.addRequestProperty(key, value);
      }
<span class="line-new-header">--- 292,11 ---</span>
       * existing values associated with the same key.
       *
       * @param   key     the keyword by which the request is known
       *                  (e.g., &quot;&lt;code&gt;accept&lt;/code&gt;&quot;).
       * @param   value  the value associated with it.
<span class="line-modified">!      * @see #getRequestProperty(java.lang.String)</span>
       * @since 1.4
       */
      public void addRequestProperty(String key, String value) {
          delegate.addRequestProperty(key, value);
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 462,20 ***</span>
  
      public void setDefaultUseCaches(boolean defaultusecaches) {
          delegate.setDefaultUseCaches(defaultusecaches);
      }
  
<span class="line-removed">-     /*</span>
<span class="line-removed">-      * finalize (dispose) the delegated object.  Otherwise</span>
<span class="line-removed">-      * sun.net.www.protocol.http.HttpURLConnection&#39;s finalize()</span>
<span class="line-removed">-      * would have to be made public.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     @SuppressWarnings(&quot;deprecation&quot;)</span>
<span class="line-removed">-     protected void finalize() throws Throwable {</span>
<span class="line-removed">-         delegate.dispose();</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      public boolean equals(Object obj) {
          return this == obj || ((obj instanceof HttpsURLConnectionImpl) &amp;&amp;
              delegate.equals(((HttpsURLConnectionImpl)obj).delegate));
      }
  
<span class="line-new-header">--- 459,10 ---</span>
</pre>
<center><a href="DelegateHttpsURLConnection.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../jar/Handler.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>