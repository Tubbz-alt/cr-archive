<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/sun/security/x509/X509Key.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="X509CertImpl.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../text/CollatorUtilities.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/x509/X509Key.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 1996, 2013, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 42 import sun.security.util.*;
 43 
 44 /**
 45  * Holds an X.509 key, for example a public key found in an X.509
 46  * certificate.  Includes a description of the algorithm to be used
 47  * with the key; these keys normally are used as
 48  * &quot;SubjectPublicKeyInfo&quot;.
 49  *
 50  * &lt;P&gt;While this class can represent any kind of X.509 key, it may be
 51  * desirable to provide subclasses which understand how to parse keying
 52  * data.   For example, RSA public keys have two members, one for the
 53  * public modulus and one for the prime exponent.  If such a class is
 54  * provided, it is used when parsing X.509 keys.  If one is not provided,
 55  * the key still parses correctly.
 56  *
 57  * @author David Brownell
 58  */
 59 public class X509Key implements PublicKey {
 60 
 61     /** use serialVersionUID from JDK 1.1. for interoperability */

 62     private static final long serialVersionUID = -5359250853002055002L;
 63 
 64     /* The algorithm information (name, parameters, etc). */
 65     protected AlgorithmId algid;
 66 
 67     /**
 68      * The key bytes, without the algorithm information.
 69      * @deprecated Use the BitArray form which does not require keys to
 70      * be byte aligned.
 71      * @see sun.security.x509.X509Key#setKey(BitArray)
 72      * @see sun.security.x509.X509Key#getKey()
 73      */
 74     @Deprecated
 75     protected byte[] key = null;
 76 
 77     /*
 78      * The number of bits unused in the last byte of the key.
 79      * Added to keep the byte[] key form consistent with the BitArray
 80      * form. Can de deleted when byte[] key is deleted.
 81      */
 82     @Deprecated
 83     private int unusedBits = 0;
 84 
 85     /* BitArray form of key */
<span class="line-modified"> 86     private BitArray bitStringKey = null;</span>
 87 
 88     /* The encoding for the key. */
 89     protected byte[] encodedKey;
 90 
 91     /**
 92      * Default constructor.  The key constructed must have its key
 93      * and algorithm initialized before it may be used, for example
 94      * by using &lt;code&gt;decode&lt;/code&gt;.
 95      */
 96     public X509Key() { }
 97 
 98     /*
 99      * Build and initialize as a &quot;default&quot; key.  All X.509 key
100      * data is stored and transmitted losslessly, but no knowledge
101      * about this particular algorithm is available.
102      */
103     private X509Key(AlgorithmId algid, BitArray key)
104     throws InvalidKeyException {
105         this.algid = algid;
106         setKey(key);
</pre>
<hr />
<pre>
388             algid = AlgorithmId.parse(val.data.getDerValue());
389             setKey(val.data.getUnalignedBitString());
390             parseKeyBits();
391             if (val.data.available() != 0)
392                 throw new InvalidKeyException (&quot;excess key data&quot;);
393 
394         } catch (IOException e) {
395             throw new InvalidKeyException(&quot;IOException: &quot; +
396                                           e.getMessage());
397         }
398     }
399 
400     public void decode(byte[] encodedKey) throws InvalidKeyException {
401         decode(new ByteArrayInputStream(encodedKey));
402     }
403 
404     /**
405      * Serialization write ... X.509 keys serialize as
406      * themselves, and they&#39;re parsed when they get read back.
407      */

408     private void writeObject(ObjectOutputStream stream) throws IOException {
409         stream.write(getEncoded());
410     }
411 
412     /**
413      * Serialization read ... X.509 keys serialize as
414      * themselves, and they&#39;re parsed when they get read back.
415      */

416     private void readObject(ObjectInputStream stream) throws IOException {
417         try {
418             decode(stream);
419         } catch (InvalidKeyException e) {
420             e.printStackTrace();
421             throw new IOException(&quot;deserialized key is invalid: &quot; +
422                                   e.getMessage());
423         }
424     }
425 
426     public boolean equals(Object obj) {
427         if (this == obj) {
428             return true;
429         }
430         if (obj instanceof Key == false) {
431             return false;
432         }
433         try {
434             byte[] thisEncoded = this.getEncodedInternal();
435             byte[] otherEncoded;
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 1996, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 42 import sun.security.util.*;
 43 
 44 /**
 45  * Holds an X.509 key, for example a public key found in an X.509
 46  * certificate.  Includes a description of the algorithm to be used
 47  * with the key; these keys normally are used as
 48  * &quot;SubjectPublicKeyInfo&quot;.
 49  *
 50  * &lt;P&gt;While this class can represent any kind of X.509 key, it may be
 51  * desirable to provide subclasses which understand how to parse keying
 52  * data.   For example, RSA public keys have two members, one for the
 53  * public modulus and one for the prime exponent.  If such a class is
 54  * provided, it is used when parsing X.509 keys.  If one is not provided,
 55  * the key still parses correctly.
 56  *
 57  * @author David Brownell
 58  */
 59 public class X509Key implements PublicKey {
 60 
 61     /** use serialVersionUID from JDK 1.1. for interoperability */
<span class="line-added"> 62     @java.io.Serial</span>
 63     private static final long serialVersionUID = -5359250853002055002L;
 64 
 65     /* The algorithm information (name, parameters, etc). */
 66     protected AlgorithmId algid;
 67 
 68     /**
 69      * The key bytes, without the algorithm information.
 70      * @deprecated Use the BitArray form which does not require keys to
 71      * be byte aligned.
 72      * @see sun.security.x509.X509Key#setKey(BitArray)
 73      * @see sun.security.x509.X509Key#getKey()
 74      */
 75     @Deprecated
 76     protected byte[] key = null;
 77 
 78     /*
 79      * The number of bits unused in the last byte of the key.
 80      * Added to keep the byte[] key form consistent with the BitArray
 81      * form. Can de deleted when byte[] key is deleted.
 82      */
 83     @Deprecated
 84     private int unusedBits = 0;
 85 
 86     /* BitArray form of key */
<span class="line-modified"> 87     private transient BitArray bitStringKey = null;</span>
 88 
 89     /* The encoding for the key. */
 90     protected byte[] encodedKey;
 91 
 92     /**
 93      * Default constructor.  The key constructed must have its key
 94      * and algorithm initialized before it may be used, for example
 95      * by using &lt;code&gt;decode&lt;/code&gt;.
 96      */
 97     public X509Key() { }
 98 
 99     /*
100      * Build and initialize as a &quot;default&quot; key.  All X.509 key
101      * data is stored and transmitted losslessly, but no knowledge
102      * about this particular algorithm is available.
103      */
104     private X509Key(AlgorithmId algid, BitArray key)
105     throws InvalidKeyException {
106         this.algid = algid;
107         setKey(key);
</pre>
<hr />
<pre>
389             algid = AlgorithmId.parse(val.data.getDerValue());
390             setKey(val.data.getUnalignedBitString());
391             parseKeyBits();
392             if (val.data.available() != 0)
393                 throw new InvalidKeyException (&quot;excess key data&quot;);
394 
395         } catch (IOException e) {
396             throw new InvalidKeyException(&quot;IOException: &quot; +
397                                           e.getMessage());
398         }
399     }
400 
401     public void decode(byte[] encodedKey) throws InvalidKeyException {
402         decode(new ByteArrayInputStream(encodedKey));
403     }
404 
405     /**
406      * Serialization write ... X.509 keys serialize as
407      * themselves, and they&#39;re parsed when they get read back.
408      */
<span class="line-added">409     @java.io.Serial</span>
410     private void writeObject(ObjectOutputStream stream) throws IOException {
411         stream.write(getEncoded());
412     }
413 
414     /**
415      * Serialization read ... X.509 keys serialize as
416      * themselves, and they&#39;re parsed when they get read back.
417      */
<span class="line-added">418     @java.io.Serial</span>
419     private void readObject(ObjectInputStream stream) throws IOException {
420         try {
421             decode(stream);
422         } catch (InvalidKeyException e) {
423             e.printStackTrace();
424             throw new IOException(&quot;deserialized key is invalid: &quot; +
425                                   e.getMessage());
426         }
427     }
428 
429     public boolean equals(Object obj) {
430         if (this == obj) {
431             return true;
432         }
433         if (obj instanceof Key == false) {
434             return false;
435         }
436         try {
437             byte[] thisEncoded = this.getEncodedInternal();
438             byte[] otherEncoded;
</pre>
</td>
</tr>
</table>
<center><a href="X509CertImpl.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../text/CollatorUtilities.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>