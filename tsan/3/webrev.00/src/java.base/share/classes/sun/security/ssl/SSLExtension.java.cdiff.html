<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/sun/security/ssl/SSLExtension.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="SSLEngineOutputRecord.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="SSLExtensions.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/ssl/SSLExtension.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2018, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 111,21 ***</span>
                                  CertStatusExtension.shOnLoadConsumer,
                                  null,
                                  null,
                                  null,
                                  CertStatusExtension.certStatusReqStringizer),
<span class="line-removed">- </span>
      CR_STATUS_REQUEST       (0x0005, &quot;status_request&quot;),
      CT_STATUS_REQUEST       (0x0005, &quot;status_request&quot;,
                                  SSLHandshake.CERTIFICATE,
                                  ProtocolVersion.PROTOCOLS_OF_13,
                                  CertStatusExtension.ctNetworkProducer,
                                  CertStatusExtension.ctOnLoadConsumer,
                                  null,
                                  null,
                                  null,
                                  CertStatusExtension.certStatusRespStringizer),
      // extensions defined in RFC 4681
      USER_MAPPING            (0x0006, &quot;user_mapping&quot;),
  
      // extensions defined in RFC 5878
      CLIENT_AUTHZ            (0x0007, &quot;client_authz&quot;),
<span class="line-new-header">--- 111,21 ---</span>
                                  CertStatusExtension.shOnLoadConsumer,
                                  null,
                                  null,
                                  null,
                                  CertStatusExtension.certStatusReqStringizer),
      CR_STATUS_REQUEST       (0x0005, &quot;status_request&quot;),
      CT_STATUS_REQUEST       (0x0005, &quot;status_request&quot;,
                                  SSLHandshake.CERTIFICATE,
                                  ProtocolVersion.PROTOCOLS_OF_13,
                                  CertStatusExtension.ctNetworkProducer,
                                  CertStatusExtension.ctOnLoadConsumer,
                                  null,
                                  null,
                                  null,
                                  CertStatusExtension.certStatusRespStringizer),
<span class="line-added">+ </span>
      // extensions defined in RFC 4681
      USER_MAPPING            (0x0006, &quot;user_mapping&quot;),
  
      // extensions defined in RFC 5878
      CLIENT_AUTHZ            (0x0007, &quot;client_authz&quot;),
</pre>
<hr />
<pre>
<span class="line-old-header">*** 307,12 ***</span>
      TOKEN_BINDING           (0x0018, &quot;token_binding &quot;),
  
      // extensions defined in RFC 7924
      CACHED_INFO             (0x0019, &quot;cached_info&quot;),
  
<span class="line-modified">!     // extensions defined in RFC 4507/5077</span>
<span class="line-modified">!     SESSION_TICKET          (0x0023, &quot;session_ticket&quot;),</span>
  
      // extensions defined in TLS 1.3
      CH_EARLY_DATA           (0x002A, &quot;early_data&quot;),
      EE_EARLY_DATA           (0x002A, &quot;early_data&quot;),
      NST_EARLY_DATA          (0x002A, &quot;early_data&quot;),
<span class="line-new-header">--- 307,32 ---</span>
      TOKEN_BINDING           (0x0018, &quot;token_binding &quot;),
  
      // extensions defined in RFC 7924
      CACHED_INFO             (0x0019, &quot;cached_info&quot;),
  
<span class="line-modified">!     // extensions defined in RFC 5077</span>
<span class="line-modified">!     CH_SESSION_TICKET       (0x0023, &quot;session_ticket&quot;,</span>
<span class="line-added">+             SSLHandshake.CLIENT_HELLO,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_10_12,</span>
<span class="line-added">+             SessionTicketExtension.chNetworkProducer,</span>
<span class="line-added">+             SessionTicketExtension.chOnLoadConsumer,</span>
<span class="line-added">+             null,</span>
<span class="line-added">+             null,</span>
<span class="line-added">+             null,</span>
<span class="line-added">+             SessionTicketExtension.steStringizer),</span>
<span class="line-added">+             //null),</span>
<span class="line-added">+ </span>
<span class="line-added">+     SH_SESSION_TICKET       (0x0023, &quot;session_ticket&quot;,</span>
<span class="line-added">+             SSLHandshake.SERVER_HELLO,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_10_12,</span>
<span class="line-added">+             SessionTicketExtension.shNetworkProducer,</span>
<span class="line-added">+             SessionTicketExtension.shOnLoadConsumer,</span>
<span class="line-added">+             null,</span>
<span class="line-added">+             null,</span>
<span class="line-added">+             null,</span>
<span class="line-added">+             SessionTicketExtension.steStringizer),</span>
<span class="line-added">+             //null),</span>
  
      // extensions defined in TLS 1.3
      CH_EARLY_DATA           (0x002A, &quot;early_data&quot;),
      EE_EARLY_DATA           (0x002A, &quot;early_data&quot;),
      NST_EARLY_DATA          (0x002A, &quot;early_data&quot;),
</pre>
<hr />
<pre>
<span class="line-old-header">*** 462,10 ***</span>
<span class="line-new-header">--- 482,29 ---</span>
  
      final int id;
      final SSLHandshake handshakeType;
      final String name;
      final ProtocolVersion[] supportedProtocols;
<span class="line-added">+ </span>
<span class="line-added">+     /*</span>
<span class="line-added">+      * networkProducer: produces outbound handshake data.</span>
<span class="line-added">+      *</span>
<span class="line-added">+      * onLoadConsumer:  parses inbound data.  It may not be appropriate</span>
<span class="line-added">+      *                  to act until all of the message inputs have</span>
<span class="line-added">+      *                  been parsed.  (e.g. parsing keyShares and choosing</span>
<span class="line-added">+      *                  a local value without having seen the SupportedGroups</span>
<span class="line-added">+      *                  extension.)</span>
<span class="line-added">+      *</span>
<span class="line-added">+      * onLoadAbsence:   if a missing message needs special handling</span>
<span class="line-added">+      *                  during the load phase.</span>
<span class="line-added">+      *</span>
<span class="line-added">+      * onTradeConsumer: act on the parsed message once all inbound data has</span>
<span class="line-added">+      *                  been traded and parsed.</span>
<span class="line-added">+      *</span>
<span class="line-added">+      * onTradeAbsence:  if a missing message needs special handling</span>
<span class="line-added">+      *                  during the trade phase.</span>
<span class="line-added">+      */</span>
      final HandshakeProducer networkProducer;
      final ExtensionConsumer onLoadConsumer;
      final HandshakeAbsence  onLoadAbsence;
      final HandshakeConsumer onTradeConsumer;
      final HandshakeAbsence  onTradeAbsence;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 513,10 ***</span>
<span class="line-new-header">--- 552,20 ---</span>
          }
  
          return null;
      }
  
<span class="line-added">+     static String nameOf(int extensionType) {</span>
<span class="line-added">+         for (SSLExtension ext : SSLExtension.values()) {</span>
<span class="line-added">+             if (ext.id == extensionType) {</span>
<span class="line-added">+                 return ext.name;</span>
<span class="line-added">+             }</span>
<span class="line-added">+         }</span>
<span class="line-added">+ </span>
<span class="line-added">+         return &quot;unknown extension&quot;;</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      static boolean isConsumable(int extensionType) {
          for (SSLExtension ext : SSLExtension.values()) {
              if (ext.id == extensionType &amp;&amp;
                      ext.onLoadConsumer != null) {
                  return true;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 655,12 ***</span>
              if (!enableExtension) {
                  extensions.remove(CH_SERVER_NAME);
              }
  
              // To switch off the max_fragment_length extension.
              enableExtension =
<span class="line-modified">!                 Utilities.getBooleanProperty(&quot;jsse.enableMFLExtension&quot;, false);</span>
              if (!enableExtension) {
                  extensions.remove(CH_MAX_FRAGMENT_LENGTH);
              }
  
              defaults = Collections.unmodifiableCollection(extensions);
<span class="line-new-header">--- 704,22 ---</span>
              if (!enableExtension) {
                  extensions.remove(CH_SERVER_NAME);
              }
  
              // To switch off the max_fragment_length extension.
<span class="line-added">+             //</span>
<span class="line-added">+             // Note that &quot;jsse.enableMFLNExtension&quot; is the CSR approved</span>
<span class="line-added">+             // property name.  However, &quot;jsse.enableMFLExtension&quot; was used</span>
<span class="line-added">+             // in the original implementation.  Temporarily, if either of</span>
<span class="line-added">+             // the two properties set to true, the extension is switch on.</span>
<span class="line-added">+             // We may remove the &quot;jsse.enableMFLExtension&quot; property in the</span>
<span class="line-added">+             // future.  Please don&#39;t continue to use the misspelling property.</span>
              enableExtension =
<span class="line-modified">!                 Utilities.getBooleanProperty(</span>
<span class="line-added">+                         &quot;jsse.enableMFLNExtension&quot;, false) ||</span>
<span class="line-added">+                 Utilities.getBooleanProperty(</span>
<span class="line-added">+                         &quot;jsse.enableMFLExtension&quot;, false);</span>
              if (!enableExtension) {
                  extensions.remove(CH_MAX_FRAGMENT_LENGTH);
              }
  
              defaults = Collections.unmodifiableCollection(extensions);
</pre>
<center><a href="SSLEngineOutputRecord.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="SSLExtensions.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>