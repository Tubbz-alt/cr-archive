<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/sun/security/ssl/CipherSuite.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="CertificateVerify.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ClientHello.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/ssl/CipherSuite.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2002, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
  25 
  26 package sun.security.ssl;
  27 
  28 import java.util.ArrayList;
  29 import java.util.Arrays;
  30 import java.util.Collection;
  31 import java.util.Collections;
  32 import java.util.LinkedList;
  33 import java.util.List;
  34 import static sun.security.ssl.CipherSuite.HashAlg.*;
  35 import static sun.security.ssl.CipherSuite.KeyExchange.*;
  36 import static sun.security.ssl.CipherSuite.MacAlg.*;
  37 import static sun.security.ssl.SSLCipher.*;
<span class="line-modified">  38 import sun.security.ssl.SupportedGroupsExtension.NamedGroupType;</span>
<span class="line-modified">  39 import static sun.security.ssl.SupportedGroupsExtension.NamedGroupType.*;</span>
  40 
  41 /**
  42  * Enum for SSL/(D)TLS cipher suites.
  43  *
  44  * Please refer to the &quot;TLS Cipher Suite Registry&quot; section for more details
  45  * about each cipher suite:
  46  *     https://www.iana.org/assignments/tls-parameters/tls-parameters.xml
  47  */
  48 enum CipherSuite {
  49     //
  50     // in preference order
  51     //
  52 
  53     // Definition of the CipherSuites that are enabled by default.
  54     //
  55     // They are listed in preference order, most preferred first, using
  56     // the following criteria:
  57     // 1. Prefer Suite B compliant cipher suites, see RFC6460 (To be
  58     //    changed later, see below).
<span class="line-modified">  59     // 2. Prefer the stronger bulk cipher, in the order of AES_256(GCM),</span>

  60     //    AES_128(GCM), AES_256, AES_128, 3DES-EDE.
<span class="line-modified">  61     // 3. Prefer the stronger MAC algorithm, in the order of SHA384,</span>
  62     //    SHA256, SHA, MD5.
<span class="line-modified">  63     // 4. Prefer the better performance of key exchange and digital</span>
  64     //    signature algorithm, in the order of ECDHE-ECDSA, ECDHE-RSA,
<span class="line-modified">  65     //    RSA, ECDH-ECDSA, ECDH-RSA, DHE-RSA, DHE-DSS.</span>
  66 
<span class="line-modified">  67     TLS_AES_128_GCM_SHA256(</span>
<span class="line-removed">  68             0x1301, true, &quot;TLS_AES_128_GCM_SHA256&quot;,</span>
<span class="line-removed">  69             ProtocolVersion.PROTOCOLS_OF_13, B_AES_128_GCM_IV, H_SHA256),</span>
  70     TLS_AES_256_GCM_SHA384(
  71             0x1302, true, &quot;TLS_AES_256_GCM_SHA384&quot;,
  72             ProtocolVersion.PROTOCOLS_OF_13, B_AES_256_GCM_IV, H_SHA384),



  73     TLS_CHACHA20_POLY1305_SHA256(
  74             0x1303, true, &quot;TLS_CHACHA20_POLY1305_SHA256&quot;,
  75             ProtocolVersion.PROTOCOLS_OF_13, B_CC20_P1305, H_SHA256),
  76 
  77     // Suite B compliant cipher suites, see RFC 6460.
  78     //
  79     // Note that, at present this provider is not Suite B compliant. The
  80     // preference order of the GCM cipher suites does not follow the spec
  81     // of RFC 6460.  In this section, only two cipher suites are listed
  82     // so that applications can make use of Suite-B compliant cipher
  83     // suite firstly.
  84     TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384(
  85             0xC02C, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,
  86             ProtocolVersion.PROTOCOLS_OF_12,
  87             K_ECDHE_ECDSA, B_AES_256_GCM, M_NULL, H_SHA384),
  88     TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256(
  89             0xC02B, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,
  90             ProtocolVersion.PROTOCOLS_OF_12,
  91             K_ECDHE_ECDSA, B_AES_128_GCM, M_NULL, H_SHA256),
  92 
  93     // Not suite B, but we want it to position the suite early in the list
  94     // of 1.2 suites.
  95     TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256(
  96             0xCCA9, true, &quot;TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256&quot;, &quot;&quot;,
  97             ProtocolVersion.PROTOCOLS_OF_12,
  98             K_ECDHE_ECDSA, B_CC20_P1305, M_NULL, H_SHA256),
  99 
<span class="line-modified"> 100     // AES_256(GCM)</span>




 101     TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384(
 102             0xC030, true, &quot;TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,
 103             ProtocolVersion.PROTOCOLS_OF_12,
 104             K_ECDHE_RSA, B_AES_256_GCM, M_NULL, H_SHA384),
 105     TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256(
 106             0xCCA8, true, &quot;TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256&quot;, &quot;&quot;,
 107             ProtocolVersion.PROTOCOLS_OF_12,
 108             K_ECDHE_RSA, B_CC20_P1305, M_NULL, H_SHA256),
<span class="line-modified"> 109     TLS_RSA_WITH_AES_256_GCM_SHA384(</span>
<span class="line-modified"> 110             0x009D, true, &quot;TLS_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,</span>
<span class="line-modified"> 111             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-modified"> 112             K_RSA, B_AES_256_GCM, M_NULL, H_SHA384),</span>
<span class="line-removed"> 113     TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384(</span>
<span class="line-removed"> 114             0xC02E, true, &quot;TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,</span>
<span class="line-removed"> 115             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed"> 116             K_ECDH_ECDSA, B_AES_256_GCM, M_NULL, H_SHA384),</span>
<span class="line-removed"> 117     TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384(</span>
<span class="line-removed"> 118             0xC032, true, &quot;TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,</span>
 119             ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified"> 120             K_ECDH_RSA, B_AES_256_GCM, M_NULL, H_SHA384),</span>


 121     TLS_DHE_RSA_WITH_AES_256_GCM_SHA384(
 122             0x009F, true, &quot;TLS_DHE_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,
 123             ProtocolVersion.PROTOCOLS_OF_12,
 124             K_DHE_RSA, B_AES_256_GCM, M_NULL, H_SHA384),
 125     TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256(
 126             0xCCAA, true, &quot;TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256&quot;, &quot;&quot;,
 127             ProtocolVersion.PROTOCOLS_OF_12,
 128             K_DHE_RSA, B_CC20_P1305, M_NULL, H_SHA256),
 129     TLS_DHE_DSS_WITH_AES_256_GCM_SHA384(
 130             0x00A3, true, &quot;TLS_DHE_DSS_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,
 131             ProtocolVersion.PROTOCOLS_OF_12,
 132             K_DHE_DSS, B_AES_256_GCM, M_NULL, H_SHA384),
 133 
<span class="line-modified"> 134     // AES_128(GCM)</span>
<span class="line-removed"> 135     TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-removed"> 136             0xC02F, true, &quot;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed"> 137             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed"> 138             K_ECDHE_RSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
<span class="line-removed"> 139     TLS_RSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-removed"> 140             0x009C, true, &quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed"> 141             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed"> 142             K_RSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
<span class="line-removed"> 143     TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-removed"> 144             0xC02D, true, &quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed"> 145             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed"> 146             K_ECDH_ECDSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
<span class="line-removed"> 147     TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-removed"> 148             0xC031, true, &quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed"> 149             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed"> 150             K_ECDH_RSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
 151     TLS_DHE_RSA_WITH_AES_128_GCM_SHA256(
 152             0x009E, true, &quot;TLS_DHE_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,
 153             ProtocolVersion.PROTOCOLS_OF_12,
 154             K_DHE_RSA, B_AES_128_GCM, M_NULL, H_SHA256),
 155     TLS_DHE_DSS_WITH_AES_128_GCM_SHA256(
 156             0x00A2, true, &quot;TLS_DHE_DSS_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,
 157             ProtocolVersion.PROTOCOLS_OF_12,
 158             K_DHE_DSS, B_AES_128_GCM, M_NULL, H_SHA256),
 159 
<span class="line-modified"> 160     // AES_256(CBC)</span>
 161     TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384(
 162             0xC024, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
 163             ProtocolVersion.PROTOCOLS_OF_12,
 164             K_ECDHE_ECDSA, B_AES_256, M_SHA384, H_SHA384),
 165     TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384(
 166             0xC028, true, &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
 167             ProtocolVersion.PROTOCOLS_OF_12,
 168             K_ECDHE_RSA, B_AES_256, M_SHA384, H_SHA384),
<span class="line-modified"> 169     TLS_RSA_WITH_AES_256_CBC_SHA256(</span>
<span class="line-modified"> 170             0x003D, true, &quot;TLS_RSA_WITH_AES_256_CBC_SHA256&quot;, &quot;&quot;,</span>


 171             ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified"> 172             K_RSA, B_AES_256, M_SHA256, H_SHA256),</span>


















































 173     TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384(
 174             0xC026, true, &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
 175             ProtocolVersion.PROTOCOLS_OF_12,
 176             K_ECDH_ECDSA, B_AES_256, M_SHA384, H_SHA384),
 177     TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384(
 178             0xC02A, true, &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
 179             ProtocolVersion.PROTOCOLS_OF_12,
 180             K_ECDH_RSA, B_AES_256, M_SHA384, H_SHA384),
<span class="line-modified"> 181     TLS_DHE_RSA_WITH_AES_256_CBC_SHA256(</span>
<span class="line-modified"> 182             0x006B, true, &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA256&quot;, &quot;&quot;,</span>


 183             ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified"> 184             K_DHE_RSA, B_AES_256, M_SHA256, H_SHA256),</span>
<span class="line-modified"> 185     TLS_DHE_DSS_WITH_AES_256_CBC_SHA256(</span>
<span class="line-modified"> 186             0x006A, true, &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA256&quot;, &quot;&quot;,</span>
 187             ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified"> 188             K_DHE_DSS, B_AES_256, M_SHA256, H_SHA256),</span>




 189 

 190     TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA(
 191             0xC00A, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
 192             ProtocolVersion.PROTOCOLS_TO_12,
 193             K_ECDHE_ECDSA, B_AES_256, M_SHA, H_SHA256),
 194     TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA(
 195             0xC014, true, &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
 196             ProtocolVersion.PROTOCOLS_TO_12,
 197             K_ECDHE_RSA, B_AES_256, M_SHA, H_SHA256),
<span class="line-modified"> 198     TLS_RSA_WITH_AES_256_CBC_SHA(</span>
<span class="line-modified"> 199             0x0035, true, &quot;TLS_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,</span>
<span class="line-modified"> 200             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-modified"> 201             K_RSA, B_AES_256, M_SHA, H_SHA256),</span>
<span class="line-removed"> 202     TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA(</span>
<span class="line-removed"> 203             0xC005, true, &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,</span>
 204             ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified"> 205             K_ECDH_ECDSA, B_AES_256, M_SHA, H_SHA256),</span>
<span class="line-modified"> 206     TLS_ECDH_RSA_WITH_AES_256_CBC_SHA(</span>
<span class="line-modified"> 207             0xC00F, true, &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,</span>
 208             ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified"> 209             K_ECDH_RSA, B_AES_256, M_SHA, H_SHA256),</span>


 210     TLS_DHE_RSA_WITH_AES_256_CBC_SHA(
 211             0x0039, true, &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
 212             ProtocolVersion.PROTOCOLS_TO_12,
 213             K_DHE_RSA, B_AES_256, M_SHA, H_SHA256),
 214     TLS_DHE_DSS_WITH_AES_256_CBC_SHA(
 215             0x0038, true, &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
 216             ProtocolVersion.PROTOCOLS_TO_12,
 217             K_DHE_DSS, B_AES_256, M_SHA, H_SHA256),
 218 
<span class="line-modified"> 219     // AES_128(CBC)</span>
<span class="line-modified"> 220     TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-modified"> 221             0xC023, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed"> 222             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed"> 223             K_ECDHE_ECDSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-removed"> 224     TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-removed"> 225             0xC027, true, &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed"> 226             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed"> 227             K_ECDHE_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-removed"> 228     TLS_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-removed"> 229             0x003C, true, &quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed"> 230             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed"> 231             K_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-removed"> 232     TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-removed"> 233             0xC025, true, &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed"> 234             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed"> 235             K_ECDH_ECDSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-removed"> 236     TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-removed"> 237             0xC029, true, &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed"> 238             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed"> 239             K_ECDH_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-removed"> 240     TLS_DHE_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-removed"> 241             0x0067, true, &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed"> 242             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed"> 243             K_DHE_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-removed"> 244     TLS_DHE_DSS_WITH_AES_128_CBC_SHA256(</span>
<span class="line-removed"> 245             0x0040, true, &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed"> 246             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed"> 247             K_DHE_DSS, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-removed"> 248 </span>
<span class="line-removed"> 249     TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-removed"> 250             0xC009, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
 251             ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified"> 252             K_ECDHE_ECDSA, B_AES_128, M_SHA, H_SHA256),</span>
<span class="line-modified"> 253     TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified"> 254             0xC013, true, &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
 255             ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified"> 256             K_ECDHE_RSA, B_AES_128, M_SHA, H_SHA256),</span>
<span class="line-modified"> 257     TLS_RSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified"> 258             0x002F, true, &quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>


 259             ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified"> 260             K_RSA, B_AES_128, M_SHA, H_SHA256),</span>






 261     TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA(
 262             0xC004, true, &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,
 263             ProtocolVersion.PROTOCOLS_TO_12,
 264             K_ECDH_ECDSA, B_AES_128, M_SHA, H_SHA256),
 265     TLS_ECDH_RSA_WITH_AES_128_CBC_SHA(
 266             0xC00E, true, &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,
 267             ProtocolVersion.PROTOCOLS_TO_12,
 268             K_ECDH_RSA, B_AES_128, M_SHA, H_SHA256),
<span class="line-modified"> 269     TLS_DHE_RSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified"> 270             0x0033, true, &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>






























 271             ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified"> 272             K_DHE_RSA, B_AES_128, M_SHA, H_SHA256),</span>
<span class="line-modified"> 273     TLS_DHE_DSS_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified"> 274             0x0032, true, &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>


 275             ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified"> 276             K_DHE_DSS, B_AES_128, M_SHA, H_SHA256),</span>
 277 
<span class="line-modified"> 278     // 3DES_EDE</span>
 279     TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA(
 280             0xC008, true, &quot;TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,
 281             ProtocolVersion.PROTOCOLS_TO_12,
 282             K_ECDHE_ECDSA, B_3DES, M_SHA, H_SHA256),
 283     TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA(
 284             0xC012, true, &quot;TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,
 285             ProtocolVersion.PROTOCOLS_TO_12,
 286             K_ECDHE_RSA, B_3DES, M_SHA, H_SHA256),
<span class="line-removed"> 287     SSL_RSA_WITH_3DES_EDE_CBC_SHA(</span>
<span class="line-removed"> 288             0x000A, true, &quot;SSL_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-removed"> 289                           &quot;TLS_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-removed"> 290             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-removed"> 291             K_RSA, B_3DES, M_SHA, H_SHA256),</span>
<span class="line-removed"> 292     TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA(</span>
<span class="line-removed"> 293             0xC003, true, &quot;TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,</span>
<span class="line-removed"> 294             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-removed"> 295             K_ECDH_ECDSA, B_3DES, M_SHA, H_SHA256),</span>
<span class="line-removed"> 296     TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA(</span>
<span class="line-removed"> 297             0xC00D, true, &quot;TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,</span>
<span class="line-removed"> 298             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-removed"> 299             K_ECDH_RSA, B_3DES, M_SHA, H_SHA256),</span>
 300     SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA(
 301             0x0016, true, &quot;SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;,
 302                           &quot;TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;,
 303             ProtocolVersion.PROTOCOLS_TO_12,
 304             K_DHE_RSA, B_3DES, M_SHA, H_SHA256),
 305     SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA(
 306             0x0013, true, &quot;SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA&quot;,
 307                           &quot;TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA&quot;,
 308             ProtocolVersion.PROTOCOLS_TO_12,
 309             K_DHE_DSS, B_3DES, M_SHA, H_SHA256),
 310 















 311     // Renegotiation protection request Signalling Cipher Suite Value (SCSV).
 312     TLS_EMPTY_RENEGOTIATION_INFO_SCSV(        //  RFC 5746, TLS 1.2 and prior
 313             0x00FF, true, &quot;TLS_EMPTY_RENEGOTIATION_INFO_SCSV&quot;, &quot;&quot;,
 314             ProtocolVersion.PROTOCOLS_TO_12,
 315             K_SCSV, B_NULL, M_NULL, H_NONE),
 316 
 317     // Definition of the CipherSuites that are supported but not enabled
 318     // by default.
 319     // They are listed in preference order, preferred first, using the
 320     // following criteria:
 321     // 1. If a cipher suite has been obsoleted, we put it at the end of
 322     //    the list.
 323     // 2. Prefer the stronger bulk cipher, in the order of AES_256,
 324     //    AES_128, 3DES-EDE, RC-4, DES, DES40, RC4_40, NULL.
 325     // 3. Prefer the stronger MAC algorithm, in the order of SHA384,
 326     //    SHA256, SHA, MD5.
 327     // 4. Prefer the better performance of key exchange and digital
 328     //    signature algorithm, in the order of ECDHE-ECDSA, ECDHE-RSA,
 329     //    RSA, ECDH-ECDSA, ECDH-RSA, DHE-RSA, DHE-DSS, anonymous.
 330     TLS_DH_anon_WITH_AES_256_GCM_SHA384(
</pre>
<hr />
<pre>
 389             K_ECDH_ECDSA, B_RC4_128, M_SHA, H_SHA256),
 390     TLS_ECDH_RSA_WITH_RC4_128_SHA(
 391             0xC00C, false, &quot;TLS_ECDH_RSA_WITH_RC4_128_SHA&quot;, &quot;&quot;,
 392             ProtocolVersion.PROTOCOLS_TO_TLS12,
 393             K_ECDH_RSA, B_RC4_128, M_SHA, H_SHA256),
 394     SSL_RSA_WITH_RC4_128_MD5(
 395             0x0004, false, &quot;SSL_RSA_WITH_RC4_128_MD5&quot;,
 396                            &quot;TLS_RSA_WITH_RC4_128_MD5&quot;,
 397             ProtocolVersion.PROTOCOLS_TO_TLS12,
 398             K_RSA, B_RC4_128, M_MD5, H_SHA256),
 399     TLS_ECDH_anon_WITH_RC4_128_SHA(
 400             0xC016, false, &quot;TLS_ECDH_anon_WITH_RC4_128_SHA&quot;, &quot;&quot;,
 401             ProtocolVersion.PROTOCOLS_TO_TLS12,
 402             K_ECDH_ANON, B_RC4_128, M_SHA, H_SHA256),
 403     SSL_DH_anon_WITH_RC4_128_MD5(
 404             0x0018, false, &quot;SSL_DH_anon_WITH_RC4_128_MD5&quot;,
 405                            &quot;TLS_DH_anon_WITH_RC4_128_MD5&quot;,
 406             ProtocolVersion.PROTOCOLS_TO_TLS12,
 407             K_DH_ANON, B_RC4_128, M_MD5, H_SHA256),
 408 
<span class="line-modified"> 409     // weak cipher suites obsoleted in TLS 1.2 [RFC 5246]</span>
 410     SSL_RSA_WITH_DES_CBC_SHA(
 411             0x0009, false, &quot;SSL_RSA_WITH_DES_CBC_SHA&quot;,
 412                            &quot;TLS_RSA_WITH_DES_CBC_SHA&quot;,
 413             ProtocolVersion.PROTOCOLS_TO_11,
 414             K_RSA, B_DES, M_SHA, H_NONE),
 415     SSL_DHE_RSA_WITH_DES_CBC_SHA(
 416             0x0015, false, &quot;SSL_DHE_RSA_WITH_DES_CBC_SHA&quot;,
 417                            &quot;TLS_DHE_RSA_WITH_DES_CBC_SHA&quot;,
 418             ProtocolVersion.PROTOCOLS_TO_11,
 419             K_DHE_RSA, B_DES, M_SHA, H_NONE),
 420     SSL_DHE_DSS_WITH_DES_CBC_SHA(
 421             0x0012, false, &quot;SSL_DHE_DSS_WITH_DES_CBC_SHA&quot;,
 422                            &quot;TLS_DHE_DSS_WITH_DES_CBC_SHA&quot;,
 423             ProtocolVersion.PROTOCOLS_TO_11,
 424             K_DHE_DSS, B_DES, M_SHA, H_NONE),
 425     SSL_DH_anon_WITH_DES_CBC_SHA(
 426             0x001A, false, &quot;SSL_DH_anon_WITH_DES_CBC_SHA&quot;,
 427                            &quot;TLS_DH_anon_WITH_DES_CBC_SHA&quot;,
 428             ProtocolVersion.PROTOCOLS_TO_11,
 429             K_DH_ANON, B_DES, M_SHA, H_NONE),
 430 
<span class="line-modified"> 431     // weak cipher suites obsoleted in TLS 1.1  [RFC 4346]</span>
 432     SSL_RSA_EXPORT_WITH_DES40_CBC_SHA(
 433             0x0008, false, &quot;SSL_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,
 434                            &quot;TLS_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,
 435             ProtocolVersion.PROTOCOLS_TO_10,
 436             K_RSA_EXPORT, B_DES_40, M_SHA, H_NONE),
 437     SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA(
 438             0x0014, false, &quot;SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,
 439                            &quot;TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,
 440             ProtocolVersion.PROTOCOLS_TO_10,
 441             K_DHE_RSA_EXPORT, B_DES_40, M_SHA, H_NONE),
 442     SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA(
 443             0x0011, false, &quot;SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA&quot;,
 444                            &quot;TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA&quot;,
 445             ProtocolVersion.PROTOCOLS_TO_10,
 446             K_DHE_DSS_EXPORT, B_DES_40, M_SHA, H_NONE),
 447     SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA(
 448             0x0019, false, &quot;SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA&quot;,
 449                            &quot;TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA&quot;,
 450             ProtocolVersion.PROTOCOLS_TO_10,
 451             K_DH_ANON_EXPORT, B_DES_40, M_SHA, H_NONE),
 452     SSL_RSA_EXPORT_WITH_RC4_40_MD5(
 453             0x0003, false, &quot;SSL_RSA_EXPORT_WITH_RC4_40_MD5&quot;,
 454                            &quot;TLS_RSA_EXPORT_WITH_RC4_40_MD5&quot;,
 455             ProtocolVersion.PROTOCOLS_TO_10,
 456             K_RSA_EXPORT, B_RC4_40, M_MD5, H_NONE),
 457     SSL_DH_anon_EXPORT_WITH_RC4_40_MD5(
 458             0x0017, false, &quot;SSL_DH_anon_EXPORT_WITH_RC4_40_MD5&quot;,
 459                            &quot;TLS_DH_anon_EXPORT_WITH_RC4_40_MD5&quot;,
 460             ProtocolVersion.PROTOCOLS_TO_10,
 461             K_DH_ANON, B_RC4_40, M_MD5, H_NONE),
 462 
<span class="line-modified"> 463     // no traffic encryption cipher suites</span>
 464     TLS_RSA_WITH_NULL_SHA256(
 465             0x003B, false, &quot;TLS_RSA_WITH_NULL_SHA256&quot;, &quot;&quot;,
 466             ProtocolVersion.PROTOCOLS_OF_12,
 467             K_RSA, B_NULL, M_SHA256, H_SHA256),
 468     TLS_ECDHE_ECDSA_WITH_NULL_SHA(
 469             0xC006, false, &quot;TLS_ECDHE_ECDSA_WITH_NULL_SHA&quot;, &quot;&quot;,
 470             ProtocolVersion.PROTOCOLS_TO_12,
 471             K_ECDHE_ECDSA, B_NULL, M_SHA, H_SHA256),
 472     TLS_ECDHE_RSA_WITH_NULL_SHA(
 473             0xC010, false, &quot;TLS_ECDHE_RSA_WITH_NULL_SHA&quot;, &quot;&quot;,
 474             ProtocolVersion.PROTOCOLS_TO_12,
 475             K_ECDHE_RSA, B_NULL, M_SHA, H_SHA256),
 476     SSL_RSA_WITH_NULL_SHA(
 477             0x0002, false, &quot;SSL_RSA_WITH_NULL_SHA&quot;,
 478                            &quot;TLS_RSA_WITH_NULL_SHA&quot;,
 479             ProtocolVersion.PROTOCOLS_TO_12,
 480             K_RSA, B_NULL, M_SHA, H_SHA256),
 481     TLS_ECDH_ECDSA_WITH_NULL_SHA(
 482             0xC001, false, &quot;TLS_ECDH_ECDSA_WITH_NULL_SHA&quot;, &quot;&quot;,
 483             ProtocolVersion.PROTOCOLS_TO_12,
 484             K_ECDH_ECDSA, B_NULL, M_SHA, H_SHA256),
 485     TLS_ECDH_RSA_WITH_NULL_SHA(
 486             0xC00B, false, &quot;TLS_ECDH_RSA_WITH_NULL_SHA&quot;, &quot;&quot;,
 487             ProtocolVersion.PROTOCOLS_TO_12,
 488             K_ECDH_RSA, B_NULL, M_SHA, H_SHA256),
 489     TLS_ECDH_anon_WITH_NULL_SHA(
 490             0xC015, false, &quot;TLS_ECDH_anon_WITH_NULL_SHA&quot;, &quot;&quot;,
 491             ProtocolVersion.PROTOCOLS_TO_12,
 492             K_ECDH_ANON, B_NULL, M_SHA, H_SHA256),
 493     SSL_RSA_WITH_NULL_MD5(
 494             0x0001, false, &quot;SSL_RSA_WITH_NULL_MD5&quot;,
 495                            &quot;TLS_RSA_WITH_NULL_MD5&quot;,
 496             ProtocolVersion.PROTOCOLS_TO_12,
 497             K_RSA, B_NULL, M_MD5, H_SHA256),
 498 
<span class="line-modified"> 499     // Definition of the CipherSuites that are not supported but the names</span>
 500     // are known.
 501     TLS_AES_128_CCM_SHA256(                          // TLS 1.3
 502             &quot;TLS_AES_128_CCM_SHA256&quot;, 0x1304),
 503     TLS_AES_128_CCM_8_SHA256(                        // TLS 1.3
 504             &quot;TLS_AES_128_CCM_8_SHA256&quot;, 0x1305),
 505 
<span class="line-modified"> 506     // remaining unsupported ciphersuites defined in RFC2246.</span>
 507     CS_0006(&quot;SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5&quot;,           0x0006),
 508     CS_0007(&quot;SSL_RSA_WITH_IDEA_CBC_SHA&quot;,                    0x0007),
 509     CS_000B(&quot;SSL_DH_DSS_EXPORT_WITH_DES40_CBC_SHA&quot;,         0x000b),
 510     CS_000C(&quot;SSL_DH_DSS_WITH_DES_CBC_SHA&quot;,                  0x000c),
 511     CS_000D(&quot;SSL_DH_DSS_WITH_3DES_EDE_CBC_SHA&quot;,             0x000d),
 512     CS_000E(&quot;SSL_DH_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,         0x000e),
 513     CS_000F(&quot;SSL_DH_RSA_WITH_DES_CBC_SHA&quot;,                  0x000f),
 514     CS_0010(&quot;SSL_DH_RSA_WITH_3DES_EDE_CBC_SHA&quot;,             0x0010),
 515 
<span class="line-modified"> 516     // SSL 3.0 Fortezza ciphersuites</span>
 517     CS_001C(&quot;SSL_FORTEZZA_DMS_WITH_NULL_SHA&quot;,               0x001c),
 518     CS_001D(&quot;SSL_FORTEZZA_DMS_WITH_FORTEZZA_CBC_SHA&quot;,       0x001d),
 519 
<span class="line-modified"> 520     // 1024/56 bit exportable ciphersuites from expired internet draft</span>
 521     CS_0062(&quot;SSL_RSA_EXPORT1024_WITH_DES_CBC_SHA&quot;,          0x0062),
 522     CS_0063(&quot;SSL_DHE_DSS_EXPORT1024_WITH_DES_CBC_SHA&quot;,      0x0063),
 523     CS_0064(&quot;SSL_RSA_EXPORT1024_WITH_RC4_56_SHA&quot;,           0x0064),
 524     CS_0065(&quot;SSL_DHE_DSS_EXPORT1024_WITH_RC4_56_SHA&quot;,       0x0065),
 525     CS_0066(&quot;SSL_DHE_DSS_WITH_RC4_128_SHA&quot;,                 0x0066),
 526 
<span class="line-modified"> 527     // Netscape old and new SSL 3.0 FIPS ciphersuites</span>
 528     // see http://www.mozilla.org/projects/security/pki/nss/ssl/fips-ssl-ciphersuites.html
 529     CS_FFE0(&quot;NETSCAPE_RSA_FIPS_WITH_3DES_EDE_CBC_SHA&quot;,      0xffe0),
 530     CS_FFE1(&quot;NETSCAPE_RSA_FIPS_WITH_DES_CBC_SHA&quot;,           0xffe1),
 531     CS_FEFE(&quot;SSL_RSA_FIPS_WITH_DES_CBC_SHA&quot;,                0xfefe),
 532     CS_FEFF(&quot;SSL_RSA_FIPS_WITH_3DES_EDE_CBC_SHA&quot;,           0xfeff),
 533 
 534     // Unsupported Kerberos cipher suites from RFC 2712
 535     CS_001E(&quot;TLS_KRB5_WITH_DES_CBC_SHA&quot;,                    0x001E),
 536     CS_001F(&quot;TLS_KRB5_WITH_3DES_EDE_CBC_SHA&quot;,               0x001F),
 537     CS_0020(&quot;TLS_KRB5_WITH_RC4_128_SHA&quot;,                    0x0020),
 538     CS_0021(&quot;TLS_KRB5_WITH_IDEA_CBC_SHA&quot;,                   0x0021),
 539     CS_0022(&quot;TLS_KRB5_WITH_DES_CBC_MD5&quot;,                    0x0022),
 540     CS_0023(&quot;TLS_KRB5_WITH_3DES_EDE_CBC_MD5&quot;,               0x0023),
 541     CS_0024(&quot;TLS_KRB5_WITH_RC4_128_MD5&quot;,                    0x0024),
 542     CS_0025(&quot;TLS_KRB5_WITH_IDEA_CBC_MD5&quot;,                   0x0025),
 543     CS_0026(&quot;TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA&quot;,          0x0026),
 544     CS_0027(&quot;TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA&quot;,          0x0027),
 545     CS_0028(&quot;TLS_KRB5_EXPORT_WITH_RC4_40_SHA&quot;,              0x0028),
 546     CS_0029(&quot;TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5&quot;,          0x0029),
 547     CS_002A(&quot;TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5&quot;,          0x002a),
</pre>
<hr />
<pre>
1031 
1032         return fragSize;
1033     }
1034 
1035     /**
1036      * An SSL/TLS key exchange algorithm.
1037      */
1038     static enum KeyExchange {
1039         K_NULL          (&quot;NULL&quot;,           false, true,   NAMED_GROUP_NONE),
1040         K_RSA           (&quot;RSA&quot;,            true,  false,  NAMED_GROUP_NONE),
1041         K_RSA_EXPORT    (&quot;RSA_EXPORT&quot;,     true,  false,  NAMED_GROUP_NONE),
1042         K_DH_RSA        (&quot;DH_RSA&quot;,         false, false,  NAMED_GROUP_NONE),
1043         K_DH_DSS        (&quot;DH_DSS&quot;,         false, false,  NAMED_GROUP_NONE),
1044         K_DHE_DSS       (&quot;DHE_DSS&quot;,        true,  false,  NAMED_GROUP_FFDHE),
1045         K_DHE_DSS_EXPORT(&quot;DHE_DSS_EXPORT&quot;, true,  false,  NAMED_GROUP_NONE),
1046         K_DHE_RSA       (&quot;DHE_RSA&quot;,        true,  false,  NAMED_GROUP_FFDHE),
1047         K_DHE_RSA_EXPORT(&quot;DHE_RSA_EXPORT&quot;, true,  false,  NAMED_GROUP_NONE),
1048         K_DH_ANON       (&quot;DH_anon&quot;,        true,  true,   NAMED_GROUP_FFDHE),
1049         K_DH_ANON_EXPORT(&quot;DH_anon_EXPORT&quot;, true,  true,   NAMED_GROUP_NONE),
1050 
<span class="line-modified">1051         K_ECDH_ECDSA    (&quot;ECDH_ECDSA&quot;,     true,  false,  NAMED_GROUP_ECDHE),</span>
<span class="line-modified">1052         K_ECDH_RSA      (&quot;ECDH_RSA&quot;,       true,  false,  NAMED_GROUP_ECDHE),</span>
<span class="line-modified">1053         K_ECDHE_ECDSA   (&quot;ECDHE_ECDSA&quot;,    true,  false,  NAMED_GROUP_ECDHE),</span>
<span class="line-modified">1054         K_ECDHE_RSA     (&quot;ECDHE_RSA&quot;,      true,  false,  NAMED_GROUP_ECDHE),</span>
<span class="line-modified">1055         K_ECDH_ANON     (&quot;ECDH_anon&quot;,      true,  true,   NAMED_GROUP_ECDHE),</span>







1056 
1057         // renegotiation protection request signaling cipher suite
1058         K_SCSV          (&quot;SCSV&quot;,           true,  true,   NAMED_GROUP_NONE);
1059 
1060         // name of the key exchange algorithm, e.g. DHE_DSS
1061         final String name;
1062         final boolean allowed;
<span class="line-modified">1063         final NamedGroupType groupType;</span>
1064         private final boolean alwaysAvailable;
1065         private final boolean isAnonymous;
1066 
1067         KeyExchange(String name, boolean allowed,
<span class="line-modified">1068                 boolean isAnonymous, NamedGroupType groupType) {</span>
1069             this.name = name;
<span class="line-modified">1070             if (groupType == NAMED_GROUP_ECDHE) {</span>
<span class="line-modified">1071                 this.allowed = JsseJce.ALLOW_ECC;</span>
<span class="line-modified">1072             } else {</span>
<span class="line-removed">1073                 this.allowed = allowed;</span>
<span class="line-removed">1074             }</span>
<span class="line-removed">1075             this.groupType = groupType;</span>
1076             this.alwaysAvailable = allowed &amp;&amp; (!name.startsWith(&quot;EC&quot;));
1077             this.isAnonymous = isAnonymous;
1078         }
1079 
1080         boolean isAvailable() {
1081             if (alwaysAvailable) {
1082                 return true;
1083             }
1084 
<span class="line-modified">1085             if (groupType == NAMED_GROUP_ECDHE) {</span>

1086                 return (allowed &amp;&amp; JsseJce.isEcAvailable());
1087             } else {
1088                 return allowed;
1089             }
1090         }
1091 
1092         @Override
1093         public String toString() {
1094             return name;
1095         }
1096     }
1097 
1098     /**
1099      * An SSL/TLS key MAC algorithm.
1100      *
1101      * Also contains a factory method to obtain an initialized MAC
1102      * for this algorithm.
1103      */
1104     static enum MacAlg {
1105         M_NULL      (&quot;NULL&quot;,     0,   0,   0),
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2002, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
  25 
  26 package sun.security.ssl;
  27 
  28 import java.util.ArrayList;
  29 import java.util.Arrays;
  30 import java.util.Collection;
  31 import java.util.Collections;
  32 import java.util.LinkedList;
  33 import java.util.List;
  34 import static sun.security.ssl.CipherSuite.HashAlg.*;
  35 import static sun.security.ssl.CipherSuite.KeyExchange.*;
  36 import static sun.security.ssl.CipherSuite.MacAlg.*;
  37 import static sun.security.ssl.SSLCipher.*;
<span class="line-modified">  38 import sun.security.ssl.NamedGroup.NamedGroupSpec;</span>
<span class="line-modified">  39 import static sun.security.ssl.NamedGroup.NamedGroupSpec.*;</span>
  40 
  41 /**
  42  * Enum for SSL/(D)TLS cipher suites.
  43  *
  44  * Please refer to the &quot;TLS Cipher Suite Registry&quot; section for more details
  45  * about each cipher suite:
  46  *     https://www.iana.org/assignments/tls-parameters/tls-parameters.xml
  47  */
  48 enum CipherSuite {
  49     //
  50     // in preference order
  51     //
  52 
  53     // Definition of the CipherSuites that are enabled by default.
  54     //
  55     // They are listed in preference order, most preferred first, using
  56     // the following criteria:
  57     // 1. Prefer Suite B compliant cipher suites, see RFC6460 (To be
  58     //    changed later, see below).
<span class="line-modified">  59     // 2. Prefer forward secrecy cipher suites.</span>
<span class="line-added">  60     // 3. Prefer the stronger bulk cipher, in the order of AES_256(GCM),</span>
  61     //    AES_128(GCM), AES_256, AES_128, 3DES-EDE.
<span class="line-modified">  62     // 4. Prefer the stronger MAC algorithm, in the order of SHA384,</span>
  63     //    SHA256, SHA, MD5.
<span class="line-modified">  64     // 5. Prefer the better performance of key exchange and digital</span>
  65     //    signature algorithm, in the order of ECDHE-ECDSA, ECDHE-RSA,
<span class="line-modified">  66     //    DHE-RSA, DHE-DSS, ECDH-ECDSA, ECDH-RSA, RSA.</span>
  67 
<span class="line-modified">  68     // TLS 1.3 cipher suites.</span>


  69     TLS_AES_256_GCM_SHA384(
  70             0x1302, true, &quot;TLS_AES_256_GCM_SHA384&quot;,
  71             ProtocolVersion.PROTOCOLS_OF_13, B_AES_256_GCM_IV, H_SHA384),
<span class="line-added">  72     TLS_AES_128_GCM_SHA256(</span>
<span class="line-added">  73             0x1301, true, &quot;TLS_AES_128_GCM_SHA256&quot;,</span>
<span class="line-added">  74             ProtocolVersion.PROTOCOLS_OF_13, B_AES_128_GCM_IV, H_SHA256),</span>
  75     TLS_CHACHA20_POLY1305_SHA256(
  76             0x1303, true, &quot;TLS_CHACHA20_POLY1305_SHA256&quot;,
  77             ProtocolVersion.PROTOCOLS_OF_13, B_CC20_P1305, H_SHA256),
  78 
  79     // Suite B compliant cipher suites, see RFC 6460.
  80     //
  81     // Note that, at present this provider is not Suite B compliant. The
  82     // preference order of the GCM cipher suites does not follow the spec
  83     // of RFC 6460.  In this section, only two cipher suites are listed
  84     // so that applications can make use of Suite-B compliant cipher
  85     // suite firstly.
  86     TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384(
  87             0xC02C, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,
  88             ProtocolVersion.PROTOCOLS_OF_12,
  89             K_ECDHE_ECDSA, B_AES_256_GCM, M_NULL, H_SHA384),
  90     TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256(
  91             0xC02B, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,
  92             ProtocolVersion.PROTOCOLS_OF_12,
  93             K_ECDHE_ECDSA, B_AES_128_GCM, M_NULL, H_SHA256),
  94 
  95     // Not suite B, but we want it to position the suite early in the list
  96     // of 1.2 suites.
  97     TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256(
  98             0xCCA9, true, &quot;TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256&quot;, &quot;&quot;,
  99             ProtocolVersion.PROTOCOLS_OF_12,
 100             K_ECDHE_ECDSA, B_CC20_P1305, M_NULL, H_SHA256),
 101 
<span class="line-modified"> 102     //</span>
<span class="line-added"> 103     // Forward secrecy cipher suites.</span>
<span class="line-added"> 104     //</span>
<span class="line-added"> 105 </span>
<span class="line-added"> 106     // AES_256(GCM) - ECDHE</span>
 107     TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384(
 108             0xC030, true, &quot;TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,
 109             ProtocolVersion.PROTOCOLS_OF_12,
 110             K_ECDHE_RSA, B_AES_256_GCM, M_NULL, H_SHA384),
 111     TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256(
 112             0xCCA8, true, &quot;TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256&quot;, &quot;&quot;,
 113             ProtocolVersion.PROTOCOLS_OF_12,
 114             K_ECDHE_RSA, B_CC20_P1305, M_NULL, H_SHA256),
<span class="line-modified"> 115 </span>
<span class="line-modified"> 116     // AES_128(GCM) - ECDHE</span>
<span class="line-modified"> 117     TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-modified"> 118             0xC02F, true, &quot;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>






 119             ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified"> 120             K_ECDHE_RSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
<span class="line-added"> 121 </span>
<span class="line-added"> 122     // AES_256(GCM) - DHE</span>
 123     TLS_DHE_RSA_WITH_AES_256_GCM_SHA384(
 124             0x009F, true, &quot;TLS_DHE_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,
 125             ProtocolVersion.PROTOCOLS_OF_12,
 126             K_DHE_RSA, B_AES_256_GCM, M_NULL, H_SHA384),
 127     TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256(
 128             0xCCAA, true, &quot;TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256&quot;, &quot;&quot;,
 129             ProtocolVersion.PROTOCOLS_OF_12,
 130             K_DHE_RSA, B_CC20_P1305, M_NULL, H_SHA256),
 131     TLS_DHE_DSS_WITH_AES_256_GCM_SHA384(
 132             0x00A3, true, &quot;TLS_DHE_DSS_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,
 133             ProtocolVersion.PROTOCOLS_OF_12,
 134             K_DHE_DSS, B_AES_256_GCM, M_NULL, H_SHA384),
 135 
<span class="line-modified"> 136     // AES_128(GCM) - DHE</span>
















 137     TLS_DHE_RSA_WITH_AES_128_GCM_SHA256(
 138             0x009E, true, &quot;TLS_DHE_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,
 139             ProtocolVersion.PROTOCOLS_OF_12,
 140             K_DHE_RSA, B_AES_128_GCM, M_NULL, H_SHA256),
 141     TLS_DHE_DSS_WITH_AES_128_GCM_SHA256(
 142             0x00A2, true, &quot;TLS_DHE_DSS_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,
 143             ProtocolVersion.PROTOCOLS_OF_12,
 144             K_DHE_DSS, B_AES_128_GCM, M_NULL, H_SHA256),
 145 
<span class="line-modified"> 146     // AES_256(CBC) - ECDHE</span>
 147     TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384(
 148             0xC024, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
 149             ProtocolVersion.PROTOCOLS_OF_12,
 150             K_ECDHE_ECDSA, B_AES_256, M_SHA384, H_SHA384),
 151     TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384(
 152             0xC028, true, &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
 153             ProtocolVersion.PROTOCOLS_OF_12,
 154             K_ECDHE_RSA, B_AES_256, M_SHA384, H_SHA384),
<span class="line-modified"> 155 </span>
<span class="line-modified"> 156     // AES_128(CBC) - ECDHE</span>
<span class="line-added"> 157     TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-added"> 158             0xC023, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
 159             ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified"> 160             K_ECDHE_ECDSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-added"> 161     TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-added"> 162             0xC027, true, &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added"> 163             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added"> 164             K_ECDHE_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-added"> 165 </span>
<span class="line-added"> 166     // AES_256(CBC) - DHE</span>
<span class="line-added"> 167     TLS_DHE_RSA_WITH_AES_256_CBC_SHA256(</span>
<span class="line-added"> 168             0x006B, true, &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added"> 169             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added"> 170             K_DHE_RSA, B_AES_256, M_SHA256, H_SHA256),</span>
<span class="line-added"> 171     TLS_DHE_DSS_WITH_AES_256_CBC_SHA256(</span>
<span class="line-added"> 172             0x006A, true, &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added"> 173             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added"> 174             K_DHE_DSS, B_AES_256, M_SHA256, H_SHA256),</span>
<span class="line-added"> 175 </span>
<span class="line-added"> 176     // AES_128(CBC) - DHE</span>
<span class="line-added"> 177     TLS_DHE_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-added"> 178             0x0067, true, &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added"> 179             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added"> 180             K_DHE_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-added"> 181     TLS_DHE_DSS_WITH_AES_128_CBC_SHA256(</span>
<span class="line-added"> 182             0x0040, true, &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added"> 183             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added"> 184             K_DHE_DSS, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-added"> 185 </span>
<span class="line-added"> 186     //</span>
<span class="line-added"> 187     // not forward secret cipher suites.</span>
<span class="line-added"> 188     //</span>
<span class="line-added"> 189 </span>
<span class="line-added"> 190     // AES_256(GCM)</span>
<span class="line-added"> 191     TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384(</span>
<span class="line-added"> 192             0xC02E, true, &quot;TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,</span>
<span class="line-added"> 193             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added"> 194             K_ECDH_ECDSA, B_AES_256_GCM, M_NULL, H_SHA384),</span>
<span class="line-added"> 195     TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384(</span>
<span class="line-added"> 196             0xC032, true, &quot;TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,</span>
<span class="line-added"> 197             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added"> 198             K_ECDH_RSA, B_AES_256_GCM, M_NULL, H_SHA384),</span>
<span class="line-added"> 199 </span>
<span class="line-added"> 200     // AES_128(GCM)</span>
<span class="line-added"> 201     TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-added"> 202             0xC02D, true, &quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added"> 203             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added"> 204             K_ECDH_ECDSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
<span class="line-added"> 205     TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-added"> 206             0xC031, true, &quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added"> 207             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added"> 208             K_ECDH_RSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
<span class="line-added"> 209 </span>
<span class="line-added"> 210     // AES_256(CBC)</span>
 211     TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384(
 212             0xC026, true, &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
 213             ProtocolVersion.PROTOCOLS_OF_12,
 214             K_ECDH_ECDSA, B_AES_256, M_SHA384, H_SHA384),
 215     TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384(
 216             0xC02A, true, &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
 217             ProtocolVersion.PROTOCOLS_OF_12,
 218             K_ECDH_RSA, B_AES_256, M_SHA384, H_SHA384),
<span class="line-modified"> 219 </span>
<span class="line-modified"> 220     // AES_128(CBC)</span>
<span class="line-added"> 221     TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-added"> 222             0xC025, true, &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
 223             ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified"> 224             K_ECDH_ECDSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-modified"> 225     TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-modified"> 226             0xC029, true, &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
 227             ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified"> 228             K_ECDH_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-added"> 229 </span>
<span class="line-added"> 230     //</span>
<span class="line-added"> 231     // Legacy, used for compatibility</span>
<span class="line-added"> 232     //</span>
 233 
<span class="line-added"> 234     // AES_256(CBC) - ECDHE - Using SHA</span>
 235     TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA(
 236             0xC00A, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
 237             ProtocolVersion.PROTOCOLS_TO_12,
 238             K_ECDHE_ECDSA, B_AES_256, M_SHA, H_SHA256),
 239     TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA(
 240             0xC014, true, &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
 241             ProtocolVersion.PROTOCOLS_TO_12,
 242             K_ECDHE_RSA, B_AES_256, M_SHA, H_SHA256),
<span class="line-modified"> 243 </span>
<span class="line-modified"> 244     // AES_128(CBC) - ECDHE - using SHA</span>
<span class="line-modified"> 245     TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified"> 246             0xC009, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>


 247             ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified"> 248             K_ECDHE_ECDSA, B_AES_128, M_SHA, H_SHA256),</span>
<span class="line-modified"> 249     TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified"> 250             0xC013, true, &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
 251             ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified"> 252             K_ECDHE_RSA, B_AES_128, M_SHA, H_SHA256),</span>
<span class="line-added"> 253 </span>
<span class="line-added"> 254     // AES_256(CBC) - DHE - Using SHA</span>
 255     TLS_DHE_RSA_WITH_AES_256_CBC_SHA(
 256             0x0039, true, &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
 257             ProtocolVersion.PROTOCOLS_TO_12,
 258             K_DHE_RSA, B_AES_256, M_SHA, H_SHA256),
 259     TLS_DHE_DSS_WITH_AES_256_CBC_SHA(
 260             0x0038, true, &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
 261             ProtocolVersion.PROTOCOLS_TO_12,
 262             K_DHE_DSS, B_AES_256, M_SHA, H_SHA256),
 263 
<span class="line-modified"> 264     // AES_128(CBC) - DHE - using SHA</span>
<span class="line-modified"> 265     TLS_DHE_RSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified"> 266             0x0033, true, &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>





























 267             ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified"> 268             K_DHE_RSA, B_AES_128, M_SHA, H_SHA256),</span>
<span class="line-modified"> 269     TLS_DHE_DSS_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified"> 270             0x0032, true, &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
 271             ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified"> 272             K_DHE_DSS, B_AES_128, M_SHA, H_SHA256),</span>
<span class="line-modified"> 273 </span>
<span class="line-modified"> 274     // AES_256(CBC) - using SHA, not forward secrecy</span>
<span class="line-added"> 275     TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA(</span>
<span class="line-added"> 276             0xC005, true, &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,</span>
 277             ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified"> 278             K_ECDH_ECDSA, B_AES_256, M_SHA, H_SHA256),</span>
<span class="line-added"> 279     TLS_ECDH_RSA_WITH_AES_256_CBC_SHA(</span>
<span class="line-added"> 280             0xC00F, true, &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,</span>
<span class="line-added"> 281             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-added"> 282             K_ECDH_RSA, B_AES_256, M_SHA, H_SHA256),</span>
<span class="line-added"> 283 </span>
<span class="line-added"> 284     // AES_128(CBC) - using SHA, not forward secrecy</span>
 285     TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA(
 286             0xC004, true, &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,
 287             ProtocolVersion.PROTOCOLS_TO_12,
 288             K_ECDH_ECDSA, B_AES_128, M_SHA, H_SHA256),
 289     TLS_ECDH_RSA_WITH_AES_128_CBC_SHA(
 290             0xC00E, true, &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,
 291             ProtocolVersion.PROTOCOLS_TO_12,
 292             K_ECDH_RSA, B_AES_128, M_SHA, H_SHA256),
<span class="line-modified"> 293 </span>
<span class="line-modified"> 294     //</span>
<span class="line-added"> 295     // deprecated, used for compatibility</span>
<span class="line-added"> 296     //</span>
<span class="line-added"> 297 </span>
<span class="line-added"> 298     // RSA, AES_256(GCM)</span>
<span class="line-added"> 299     TLS_RSA_WITH_AES_256_GCM_SHA384(</span>
<span class="line-added"> 300             0x009D, true, &quot;TLS_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,</span>
<span class="line-added"> 301             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added"> 302             K_RSA, B_AES_256_GCM, M_NULL, H_SHA384),</span>
<span class="line-added"> 303 </span>
<span class="line-added"> 304     // RSA, AES_128(GCM)</span>
<span class="line-added"> 305     TLS_RSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-added"> 306             0x009C, true, &quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added"> 307             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added"> 308             K_RSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
<span class="line-added"> 309 </span>
<span class="line-added"> 310     // RSA, AES_256(CBC)</span>
<span class="line-added"> 311     TLS_RSA_WITH_AES_256_CBC_SHA256(</span>
<span class="line-added"> 312             0x003D, true, &quot;TLS_RSA_WITH_AES_256_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added"> 313             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added"> 314             K_RSA, B_AES_256, M_SHA256, H_SHA256),</span>
<span class="line-added"> 315 </span>
<span class="line-added"> 316     // RSA, AES_128(CBC)</span>
<span class="line-added"> 317     TLS_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-added"> 318             0x003C, true, &quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added"> 319             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added"> 320             K_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-added"> 321 </span>
<span class="line-added"> 322     // RSA, AES_256(CBC) - using SHA, not forward secrecy</span>
<span class="line-added"> 323     TLS_RSA_WITH_AES_256_CBC_SHA(</span>
<span class="line-added"> 324             0x0035, true, &quot;TLS_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,</span>
 325             ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified"> 326             K_RSA, B_AES_256, M_SHA, H_SHA256),</span>
<span class="line-modified"> 327 </span>
<span class="line-modified"> 328     // RSA, AES_128(CBC) - using SHA, not forward secrecy</span>
<span class="line-added"> 329     TLS_RSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-added"> 330             0x002F, true, &quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
 331             ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified"> 332             K_RSA, B_AES_128, M_SHA, H_SHA256),</span>
 333 
<span class="line-modified"> 334     // 3DES_EDE, forward secrecy.</span>
 335     TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA(
 336             0xC008, true, &quot;TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,
 337             ProtocolVersion.PROTOCOLS_TO_12,
 338             K_ECDHE_ECDSA, B_3DES, M_SHA, H_SHA256),
 339     TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA(
 340             0xC012, true, &quot;TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,
 341             ProtocolVersion.PROTOCOLS_TO_12,
 342             K_ECDHE_RSA, B_3DES, M_SHA, H_SHA256),













 343     SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA(
 344             0x0016, true, &quot;SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;,
 345                           &quot;TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;,
 346             ProtocolVersion.PROTOCOLS_TO_12,
 347             K_DHE_RSA, B_3DES, M_SHA, H_SHA256),
 348     SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA(
 349             0x0013, true, &quot;SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA&quot;,
 350                           &quot;TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA&quot;,
 351             ProtocolVersion.PROTOCOLS_TO_12,
 352             K_DHE_DSS, B_3DES, M_SHA, H_SHA256),
 353 
<span class="line-added"> 354     // 3DES_EDE, not forward secrecy.</span>
<span class="line-added"> 355     TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA(</span>
<span class="line-added"> 356             0xC003, true, &quot;TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,</span>
<span class="line-added"> 357             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-added"> 358             K_ECDH_ECDSA, B_3DES, M_SHA, H_SHA256),</span>
<span class="line-added"> 359     TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA(</span>
<span class="line-added"> 360             0xC00D, true, &quot;TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,</span>
<span class="line-added"> 361             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-added"> 362             K_ECDH_RSA, B_3DES, M_SHA, H_SHA256),</span>
<span class="line-added"> 363     SSL_RSA_WITH_3DES_EDE_CBC_SHA(</span>
<span class="line-added"> 364             0x000A, true, &quot;SSL_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-added"> 365                           &quot;TLS_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-added"> 366             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-added"> 367             K_RSA, B_3DES, M_SHA, H_SHA256),</span>
<span class="line-added"> 368 </span>
 369     // Renegotiation protection request Signalling Cipher Suite Value (SCSV).
 370     TLS_EMPTY_RENEGOTIATION_INFO_SCSV(        //  RFC 5746, TLS 1.2 and prior
 371             0x00FF, true, &quot;TLS_EMPTY_RENEGOTIATION_INFO_SCSV&quot;, &quot;&quot;,
 372             ProtocolVersion.PROTOCOLS_TO_12,
 373             K_SCSV, B_NULL, M_NULL, H_NONE),
 374 
 375     // Definition of the CipherSuites that are supported but not enabled
 376     // by default.
 377     // They are listed in preference order, preferred first, using the
 378     // following criteria:
 379     // 1. If a cipher suite has been obsoleted, we put it at the end of
 380     //    the list.
 381     // 2. Prefer the stronger bulk cipher, in the order of AES_256,
 382     //    AES_128, 3DES-EDE, RC-4, DES, DES40, RC4_40, NULL.
 383     // 3. Prefer the stronger MAC algorithm, in the order of SHA384,
 384     //    SHA256, SHA, MD5.
 385     // 4. Prefer the better performance of key exchange and digital
 386     //    signature algorithm, in the order of ECDHE-ECDSA, ECDHE-RSA,
 387     //    RSA, ECDH-ECDSA, ECDH-RSA, DHE-RSA, DHE-DSS, anonymous.
 388     TLS_DH_anon_WITH_AES_256_GCM_SHA384(
</pre>
<hr />
<pre>
 447             K_ECDH_ECDSA, B_RC4_128, M_SHA, H_SHA256),
 448     TLS_ECDH_RSA_WITH_RC4_128_SHA(
 449             0xC00C, false, &quot;TLS_ECDH_RSA_WITH_RC4_128_SHA&quot;, &quot;&quot;,
 450             ProtocolVersion.PROTOCOLS_TO_TLS12,
 451             K_ECDH_RSA, B_RC4_128, M_SHA, H_SHA256),
 452     SSL_RSA_WITH_RC4_128_MD5(
 453             0x0004, false, &quot;SSL_RSA_WITH_RC4_128_MD5&quot;,
 454                            &quot;TLS_RSA_WITH_RC4_128_MD5&quot;,
 455             ProtocolVersion.PROTOCOLS_TO_TLS12,
 456             K_RSA, B_RC4_128, M_MD5, H_SHA256),
 457     TLS_ECDH_anon_WITH_RC4_128_SHA(
 458             0xC016, false, &quot;TLS_ECDH_anon_WITH_RC4_128_SHA&quot;, &quot;&quot;,
 459             ProtocolVersion.PROTOCOLS_TO_TLS12,
 460             K_ECDH_ANON, B_RC4_128, M_SHA, H_SHA256),
 461     SSL_DH_anon_WITH_RC4_128_MD5(
 462             0x0018, false, &quot;SSL_DH_anon_WITH_RC4_128_MD5&quot;,
 463                            &quot;TLS_DH_anon_WITH_RC4_128_MD5&quot;,
 464             ProtocolVersion.PROTOCOLS_TO_TLS12,
 465             K_DH_ANON, B_RC4_128, M_MD5, H_SHA256),
 466 
<span class="line-modified"> 467     // Weak cipher suites obsoleted in TLS 1.2 [RFC 5246]</span>
 468     SSL_RSA_WITH_DES_CBC_SHA(
 469             0x0009, false, &quot;SSL_RSA_WITH_DES_CBC_SHA&quot;,
 470                            &quot;TLS_RSA_WITH_DES_CBC_SHA&quot;,
 471             ProtocolVersion.PROTOCOLS_TO_11,
 472             K_RSA, B_DES, M_SHA, H_NONE),
 473     SSL_DHE_RSA_WITH_DES_CBC_SHA(
 474             0x0015, false, &quot;SSL_DHE_RSA_WITH_DES_CBC_SHA&quot;,
 475                            &quot;TLS_DHE_RSA_WITH_DES_CBC_SHA&quot;,
 476             ProtocolVersion.PROTOCOLS_TO_11,
 477             K_DHE_RSA, B_DES, M_SHA, H_NONE),
 478     SSL_DHE_DSS_WITH_DES_CBC_SHA(
 479             0x0012, false, &quot;SSL_DHE_DSS_WITH_DES_CBC_SHA&quot;,
 480                            &quot;TLS_DHE_DSS_WITH_DES_CBC_SHA&quot;,
 481             ProtocolVersion.PROTOCOLS_TO_11,
 482             K_DHE_DSS, B_DES, M_SHA, H_NONE),
 483     SSL_DH_anon_WITH_DES_CBC_SHA(
 484             0x001A, false, &quot;SSL_DH_anon_WITH_DES_CBC_SHA&quot;,
 485                            &quot;TLS_DH_anon_WITH_DES_CBC_SHA&quot;,
 486             ProtocolVersion.PROTOCOLS_TO_11,
 487             K_DH_ANON, B_DES, M_SHA, H_NONE),
 488 
<span class="line-modified"> 489     // Weak cipher suites obsoleted in TLS 1.1  [RFC 4346]</span>
 490     SSL_RSA_EXPORT_WITH_DES40_CBC_SHA(
 491             0x0008, false, &quot;SSL_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,
 492                            &quot;TLS_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,
 493             ProtocolVersion.PROTOCOLS_TO_10,
 494             K_RSA_EXPORT, B_DES_40, M_SHA, H_NONE),
 495     SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA(
 496             0x0014, false, &quot;SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,
 497                            &quot;TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,
 498             ProtocolVersion.PROTOCOLS_TO_10,
 499             K_DHE_RSA_EXPORT, B_DES_40, M_SHA, H_NONE),
 500     SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA(
 501             0x0011, false, &quot;SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA&quot;,
 502                            &quot;TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA&quot;,
 503             ProtocolVersion.PROTOCOLS_TO_10,
 504             K_DHE_DSS_EXPORT, B_DES_40, M_SHA, H_NONE),
 505     SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA(
 506             0x0019, false, &quot;SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA&quot;,
 507                            &quot;TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA&quot;,
 508             ProtocolVersion.PROTOCOLS_TO_10,
 509             K_DH_ANON_EXPORT, B_DES_40, M_SHA, H_NONE),
 510     SSL_RSA_EXPORT_WITH_RC4_40_MD5(
 511             0x0003, false, &quot;SSL_RSA_EXPORT_WITH_RC4_40_MD5&quot;,
 512                            &quot;TLS_RSA_EXPORT_WITH_RC4_40_MD5&quot;,
 513             ProtocolVersion.PROTOCOLS_TO_10,
 514             K_RSA_EXPORT, B_RC4_40, M_MD5, H_NONE),
 515     SSL_DH_anon_EXPORT_WITH_RC4_40_MD5(
 516             0x0017, false, &quot;SSL_DH_anon_EXPORT_WITH_RC4_40_MD5&quot;,
 517                            &quot;TLS_DH_anon_EXPORT_WITH_RC4_40_MD5&quot;,
 518             ProtocolVersion.PROTOCOLS_TO_10,
 519             K_DH_ANON, B_RC4_40, M_MD5, H_NONE),
 520 
<span class="line-modified"> 521     // No traffic encryption cipher suites</span>
 522     TLS_RSA_WITH_NULL_SHA256(
 523             0x003B, false, &quot;TLS_RSA_WITH_NULL_SHA256&quot;, &quot;&quot;,
 524             ProtocolVersion.PROTOCOLS_OF_12,
 525             K_RSA, B_NULL, M_SHA256, H_SHA256),
 526     TLS_ECDHE_ECDSA_WITH_NULL_SHA(
 527             0xC006, false, &quot;TLS_ECDHE_ECDSA_WITH_NULL_SHA&quot;, &quot;&quot;,
 528             ProtocolVersion.PROTOCOLS_TO_12,
 529             K_ECDHE_ECDSA, B_NULL, M_SHA, H_SHA256),
 530     TLS_ECDHE_RSA_WITH_NULL_SHA(
 531             0xC010, false, &quot;TLS_ECDHE_RSA_WITH_NULL_SHA&quot;, &quot;&quot;,
 532             ProtocolVersion.PROTOCOLS_TO_12,
 533             K_ECDHE_RSA, B_NULL, M_SHA, H_SHA256),
 534     SSL_RSA_WITH_NULL_SHA(
 535             0x0002, false, &quot;SSL_RSA_WITH_NULL_SHA&quot;,
 536                            &quot;TLS_RSA_WITH_NULL_SHA&quot;,
 537             ProtocolVersion.PROTOCOLS_TO_12,
 538             K_RSA, B_NULL, M_SHA, H_SHA256),
 539     TLS_ECDH_ECDSA_WITH_NULL_SHA(
 540             0xC001, false, &quot;TLS_ECDH_ECDSA_WITH_NULL_SHA&quot;, &quot;&quot;,
 541             ProtocolVersion.PROTOCOLS_TO_12,
 542             K_ECDH_ECDSA, B_NULL, M_SHA, H_SHA256),
 543     TLS_ECDH_RSA_WITH_NULL_SHA(
 544             0xC00B, false, &quot;TLS_ECDH_RSA_WITH_NULL_SHA&quot;, &quot;&quot;,
 545             ProtocolVersion.PROTOCOLS_TO_12,
 546             K_ECDH_RSA, B_NULL, M_SHA, H_SHA256),
 547     TLS_ECDH_anon_WITH_NULL_SHA(
 548             0xC015, false, &quot;TLS_ECDH_anon_WITH_NULL_SHA&quot;, &quot;&quot;,
 549             ProtocolVersion.PROTOCOLS_TO_12,
 550             K_ECDH_ANON, B_NULL, M_SHA, H_SHA256),
 551     SSL_RSA_WITH_NULL_MD5(
 552             0x0001, false, &quot;SSL_RSA_WITH_NULL_MD5&quot;,
 553                            &quot;TLS_RSA_WITH_NULL_MD5&quot;,
 554             ProtocolVersion.PROTOCOLS_TO_12,
 555             K_RSA, B_NULL, M_MD5, H_SHA256),
 556 
<span class="line-modified"> 557     // Definition of the cipher suites that are not supported but the names</span>
 558     // are known.
 559     TLS_AES_128_CCM_SHA256(                          // TLS 1.3
 560             &quot;TLS_AES_128_CCM_SHA256&quot;, 0x1304),
 561     TLS_AES_128_CCM_8_SHA256(                        // TLS 1.3
 562             &quot;TLS_AES_128_CCM_8_SHA256&quot;, 0x1305),
 563 
<span class="line-modified"> 564     // Remaining unsupported cipher suites defined in RFC2246.</span>
 565     CS_0006(&quot;SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5&quot;,           0x0006),
 566     CS_0007(&quot;SSL_RSA_WITH_IDEA_CBC_SHA&quot;,                    0x0007),
 567     CS_000B(&quot;SSL_DH_DSS_EXPORT_WITH_DES40_CBC_SHA&quot;,         0x000b),
 568     CS_000C(&quot;SSL_DH_DSS_WITH_DES_CBC_SHA&quot;,                  0x000c),
 569     CS_000D(&quot;SSL_DH_DSS_WITH_3DES_EDE_CBC_SHA&quot;,             0x000d),
 570     CS_000E(&quot;SSL_DH_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,         0x000e),
 571     CS_000F(&quot;SSL_DH_RSA_WITH_DES_CBC_SHA&quot;,                  0x000f),
 572     CS_0010(&quot;SSL_DH_RSA_WITH_3DES_EDE_CBC_SHA&quot;,             0x0010),
 573 
<span class="line-modified"> 574     // SSL 3.0 Fortezza cipher suites</span>
 575     CS_001C(&quot;SSL_FORTEZZA_DMS_WITH_NULL_SHA&quot;,               0x001c),
 576     CS_001D(&quot;SSL_FORTEZZA_DMS_WITH_FORTEZZA_CBC_SHA&quot;,       0x001d),
 577 
<span class="line-modified"> 578     // 1024/56 bit exportable cipher suites from expired internet draft</span>
 579     CS_0062(&quot;SSL_RSA_EXPORT1024_WITH_DES_CBC_SHA&quot;,          0x0062),
 580     CS_0063(&quot;SSL_DHE_DSS_EXPORT1024_WITH_DES_CBC_SHA&quot;,      0x0063),
 581     CS_0064(&quot;SSL_RSA_EXPORT1024_WITH_RC4_56_SHA&quot;,           0x0064),
 582     CS_0065(&quot;SSL_DHE_DSS_EXPORT1024_WITH_RC4_56_SHA&quot;,       0x0065),
 583     CS_0066(&quot;SSL_DHE_DSS_WITH_RC4_128_SHA&quot;,                 0x0066),
 584 
<span class="line-modified"> 585     // Netscape old and new SSL 3.0 FIPS cipher suites</span>
 586     // see http://www.mozilla.org/projects/security/pki/nss/ssl/fips-ssl-ciphersuites.html
 587     CS_FFE0(&quot;NETSCAPE_RSA_FIPS_WITH_3DES_EDE_CBC_SHA&quot;,      0xffe0),
 588     CS_FFE1(&quot;NETSCAPE_RSA_FIPS_WITH_DES_CBC_SHA&quot;,           0xffe1),
 589     CS_FEFE(&quot;SSL_RSA_FIPS_WITH_DES_CBC_SHA&quot;,                0xfefe),
 590     CS_FEFF(&quot;SSL_RSA_FIPS_WITH_3DES_EDE_CBC_SHA&quot;,           0xfeff),
 591 
 592     // Unsupported Kerberos cipher suites from RFC 2712
 593     CS_001E(&quot;TLS_KRB5_WITH_DES_CBC_SHA&quot;,                    0x001E),
 594     CS_001F(&quot;TLS_KRB5_WITH_3DES_EDE_CBC_SHA&quot;,               0x001F),
 595     CS_0020(&quot;TLS_KRB5_WITH_RC4_128_SHA&quot;,                    0x0020),
 596     CS_0021(&quot;TLS_KRB5_WITH_IDEA_CBC_SHA&quot;,                   0x0021),
 597     CS_0022(&quot;TLS_KRB5_WITH_DES_CBC_MD5&quot;,                    0x0022),
 598     CS_0023(&quot;TLS_KRB5_WITH_3DES_EDE_CBC_MD5&quot;,               0x0023),
 599     CS_0024(&quot;TLS_KRB5_WITH_RC4_128_MD5&quot;,                    0x0024),
 600     CS_0025(&quot;TLS_KRB5_WITH_IDEA_CBC_MD5&quot;,                   0x0025),
 601     CS_0026(&quot;TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA&quot;,          0x0026),
 602     CS_0027(&quot;TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA&quot;,          0x0027),
 603     CS_0028(&quot;TLS_KRB5_EXPORT_WITH_RC4_40_SHA&quot;,              0x0028),
 604     CS_0029(&quot;TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5&quot;,          0x0029),
 605     CS_002A(&quot;TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5&quot;,          0x002a),
</pre>
<hr />
<pre>
1089 
1090         return fragSize;
1091     }
1092 
1093     /**
1094      * An SSL/TLS key exchange algorithm.
1095      */
1096     static enum KeyExchange {
1097         K_NULL          (&quot;NULL&quot;,           false, true,   NAMED_GROUP_NONE),
1098         K_RSA           (&quot;RSA&quot;,            true,  false,  NAMED_GROUP_NONE),
1099         K_RSA_EXPORT    (&quot;RSA_EXPORT&quot;,     true,  false,  NAMED_GROUP_NONE),
1100         K_DH_RSA        (&quot;DH_RSA&quot;,         false, false,  NAMED_GROUP_NONE),
1101         K_DH_DSS        (&quot;DH_DSS&quot;,         false, false,  NAMED_GROUP_NONE),
1102         K_DHE_DSS       (&quot;DHE_DSS&quot;,        true,  false,  NAMED_GROUP_FFDHE),
1103         K_DHE_DSS_EXPORT(&quot;DHE_DSS_EXPORT&quot;, true,  false,  NAMED_GROUP_NONE),
1104         K_DHE_RSA       (&quot;DHE_RSA&quot;,        true,  false,  NAMED_GROUP_FFDHE),
1105         K_DHE_RSA_EXPORT(&quot;DHE_RSA_EXPORT&quot;, true,  false,  NAMED_GROUP_NONE),
1106         K_DH_ANON       (&quot;DH_anon&quot;,        true,  true,   NAMED_GROUP_FFDHE),
1107         K_DH_ANON_EXPORT(&quot;DH_anon_EXPORT&quot;, true,  true,   NAMED_GROUP_NONE),
1108 
<span class="line-modified">1109         // These KeyExchanges can use either ECDHE/XDH, so we&#39;ll use a</span>
<span class="line-modified">1110         // varargs here.</span>
<span class="line-modified">1111         K_ECDH_ECDSA    (&quot;ECDH_ECDSA&quot;,     JsseJce.ALLOW_ECC,  false,</span>
<span class="line-modified">1112                 NAMED_GROUP_ECDHE, NAMED_GROUP_XDH),</span>
<span class="line-modified">1113         K_ECDH_RSA      (&quot;ECDH_RSA&quot;,       JsseJce.ALLOW_ECC,  false,</span>
<span class="line-added">1114             NAMED_GROUP_ECDHE, NAMED_GROUP_XDH),</span>
<span class="line-added">1115         K_ECDHE_ECDSA   (&quot;ECDHE_ECDSA&quot;,    JsseJce.ALLOW_ECC,  false,</span>
<span class="line-added">1116             NAMED_GROUP_ECDHE, NAMED_GROUP_XDH),</span>
<span class="line-added">1117         K_ECDHE_RSA     (&quot;ECDHE_RSA&quot;,      JsseJce.ALLOW_ECC,  false,</span>
<span class="line-added">1118             NAMED_GROUP_ECDHE, NAMED_GROUP_XDH),</span>
<span class="line-added">1119         K_ECDH_ANON     (&quot;ECDH_anon&quot;,      JsseJce.ALLOW_ECC,  true,</span>
<span class="line-added">1120             NAMED_GROUP_ECDHE, NAMED_GROUP_XDH),</span>
1121 
1122         // renegotiation protection request signaling cipher suite
1123         K_SCSV          (&quot;SCSV&quot;,           true,  true,   NAMED_GROUP_NONE);
1124 
1125         // name of the key exchange algorithm, e.g. DHE_DSS
1126         final String name;
1127         final boolean allowed;
<span class="line-modified">1128         final NamedGroupSpec[] groupTypes;</span>
1129         private final boolean alwaysAvailable;
1130         private final boolean isAnonymous;
1131 
1132         KeyExchange(String name, boolean allowed,
<span class="line-modified">1133                 boolean isAnonymous, NamedGroupSpec... groupTypes) {</span>
1134             this.name = name;
<span class="line-modified">1135             this.groupTypes = groupTypes;</span>
<span class="line-modified">1136             this.allowed = allowed;</span>
<span class="line-modified">1137 </span>



1138             this.alwaysAvailable = allowed &amp;&amp; (!name.startsWith(&quot;EC&quot;));
1139             this.isAnonymous = isAnonymous;
1140         }
1141 
1142         boolean isAvailable() {
1143             if (alwaysAvailable) {
1144                 return true;
1145             }
1146 
<span class="line-modified">1147             if (NamedGroupSpec.arrayContains(groupTypes,</span>
<span class="line-added">1148                     NamedGroupSpec.NAMED_GROUP_ECDHE)) {</span>
1149                 return (allowed &amp;&amp; JsseJce.isEcAvailable());
1150             } else {
1151                 return allowed;
1152             }
1153         }
1154 
1155         @Override
1156         public String toString() {
1157             return name;
1158         }
1159     }
1160 
1161     /**
1162      * An SSL/TLS key MAC algorithm.
1163      *
1164      * Also contains a factory method to obtain an initialized MAC
1165      * for this algorithm.
1166      */
1167     static enum MacAlg {
1168         M_NULL      (&quot;NULL&quot;,     0,   0,   0),
</pre>
</td>
</tr>
</table>
<center><a href="CertificateVerify.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ClientHello.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>