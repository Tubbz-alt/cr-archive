<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/sun/security/ssl/SSLExtension.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="SSLEngineOutputRecord.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="SSLExtensions.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/ssl/SSLExtension.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 96     TRUNCATED_HMAC          (0x0004, &quot;truncated_hmac&quot;),
 97 
 98     CH_STATUS_REQUEST       (0x0005, &quot;status_request&quot;,
 99                                 SSLHandshake.CLIENT_HELLO,
100                                 ProtocolVersion.PROTOCOLS_TO_13,
101                                 CertStatusExtension.chNetworkProducer,
102                                 CertStatusExtension.chOnLoadConsumer,
103                                 null,
104                                 null,
105                                 null,
106                                 CertStatusExtension.certStatusReqStringizer),
107     SH_STATUS_REQUEST       (0x0005, &quot;status_request&quot;,
108                                 SSLHandshake.SERVER_HELLO,
109                                 ProtocolVersion.PROTOCOLS_TO_12,
110                                 CertStatusExtension.shNetworkProducer,
111                                 CertStatusExtension.shOnLoadConsumer,
112                                 null,
113                                 null,
114                                 null,
115                                 CertStatusExtension.certStatusReqStringizer),
<span class="line-removed">116 </span>
117     CR_STATUS_REQUEST       (0x0005, &quot;status_request&quot;),
118     CT_STATUS_REQUEST       (0x0005, &quot;status_request&quot;,
119                                 SSLHandshake.CERTIFICATE,
120                                 ProtocolVersion.PROTOCOLS_OF_13,
121                                 CertStatusExtension.ctNetworkProducer,
122                                 CertStatusExtension.ctOnLoadConsumer,
123                                 null,
124                                 null,
125                                 null,
126                                 CertStatusExtension.certStatusRespStringizer),

127     // extensions defined in RFC 4681
128     USER_MAPPING            (0x0006, &quot;user_mapping&quot;),
129 
130     // extensions defined in RFC 5878
131     CLIENT_AUTHZ            (0x0007, &quot;client_authz&quot;),
132     SERVER_AUTHZ            (0x0008, &quot;server_authz&quot;),
133 
134     // extensions defined in RFC 5081
135     CERT_TYPE               (0x0009, &quot;cert_type&quot;),
136 
137     // extensions defined in RFC 4492 (ECC)
138     CH_SUPPORTED_GROUPS     (0x000A, &quot;supported_groups&quot;,
139                                 SSLHandshake.CLIENT_HELLO,
140                                 ProtocolVersion.PROTOCOLS_TO_13,
141                                 SupportedGroupsExtension.chNetworkProducer,
142                                 SupportedGroupsExtension.chOnLoadConsumer,
143                                 null,
144                                 null,
145                                 null,
146                                 SupportedGroupsExtension.sgsStringizer),
</pre>
<hr />
<pre>
292                                 ExtendedMasterSecretExtension.chOnLoadAbsence,
293                                 null,
294                                 null,
295                                 ExtendedMasterSecretExtension.emsStringizer),
296     SH_EXTENDED_MASTER_SECRET  (0x0017, &quot;extended_master_secret&quot;,
297                                 SSLHandshake.SERVER_HELLO,
298                                 ProtocolVersion.PROTOCOLS_TO_12,
299                                 ExtendedMasterSecretExtension.shNetworkProducer,
300                                 ExtendedMasterSecretExtension.shOnLoadConsumer,
301                                 ExtendedMasterSecretExtension.shOnLoadAbsence,
302                                 null,
303                                 null,
304                                 ExtendedMasterSecretExtension.emsStringizer),
305 
306     // extensions defined in RFC draft-ietf-tokbind-negotiation
307     TOKEN_BINDING           (0x0018, &quot;token_binding &quot;),
308 
309     // extensions defined in RFC 7924
310     CACHED_INFO             (0x0019, &quot;cached_info&quot;),
311 
<span class="line-modified">312     // extensions defined in RFC 4507/5077</span>
<span class="line-modified">313     SESSION_TICKET          (0x0023, &quot;session_ticket&quot;),</span>




















314 
315     // extensions defined in TLS 1.3
316     CH_EARLY_DATA           (0x002A, &quot;early_data&quot;),
317     EE_EARLY_DATA           (0x002A, &quot;early_data&quot;),
318     NST_EARLY_DATA          (0x002A, &quot;early_data&quot;),
319 
320     CH_SUPPORTED_VERSIONS   (0x002B, &quot;supported_versions&quot;,
321                                 SSLHandshake.CLIENT_HELLO,
322                                 ProtocolVersion.PROTOCOLS_TO_13,
323                                 SupportedVersionsExtension.chNetworkProducer,
324                                 SupportedVersionsExtension.chOnLoadConsumer,
325                                 null,
326                                 null,
327                                 null,
328                                 SupportedVersionsExtension.chStringizer),
329     SH_SUPPORTED_VERSIONS   (0x002B, &quot;supported_versions&quot;,
330                                 SSLHandshake.SERVER_HELLO,
331                                         // and HelloRetryRequest
332                                 ProtocolVersion.PROTOCOLS_OF_13,
333                                 SupportedVersionsExtension.shNetworkProducer,
</pre>
<hr />
<pre>
447                                 ProtocolVersion.PROTOCOLS_OF_13,
448                                 PreSharedKeyExtension.chNetworkProducer,
449                                 PreSharedKeyExtension.chOnLoadConsumer,
450                                 PreSharedKeyExtension.chOnLoadAbsence,
451                                 PreSharedKeyExtension.chOnTradeConsumer,
452                                 null,
453                                 PreSharedKeyExtension.chStringizer),
454     SH_PRE_SHARED_KEY       (0x0029, &quot;pre_shared_key&quot;,
455                                 SSLHandshake.SERVER_HELLO,
456                                 ProtocolVersion.PROTOCOLS_OF_13,
457                                 PreSharedKeyExtension.shNetworkProducer,
458                                 PreSharedKeyExtension.shOnLoadConsumer,
459                                 PreSharedKeyExtension.shOnLoadAbsence,
460                                 null, null,
461                                 PreSharedKeyExtension.shStringizer);
462 
463     final int id;
464     final SSLHandshake handshakeType;
465     final String name;
466     final ProtocolVersion[] supportedProtocols;



















467     final HandshakeProducer networkProducer;
468     final ExtensionConsumer onLoadConsumer;
469     final HandshakeAbsence  onLoadAbsence;
470     final HandshakeConsumer onTradeConsumer;
471     final HandshakeAbsence  onTradeAbsence;
472     final SSLStringizer stringizer;
473 
474     // known but unsupported extension
475     private SSLExtension(int id, String name) {
476         this.id = id;
477         this.handshakeType = SSLHandshake.NOT_APPLICABLE;
478         this.name = name;
479         this.supportedProtocols = new ProtocolVersion[0];
480         this.networkProducer = null;
481         this.onLoadConsumer = null;
482         this.onLoadAbsence = null;
483         this.onTradeConsumer = null;
484         this.onTradeAbsence = null;
485         this.stringizer = null;
486     }
</pre>
<hr />
<pre>
498         this.supportedProtocols = supportedProtocols;
499         this.networkProducer = producer;
500         this.onLoadConsumer = onLoadConsumer;
501         this.onLoadAbsence = onLoadAbsence;
502         this.onTradeConsumer = onTradeConsumer;
503         this.onTradeAbsence = onTradeAbsence;
504         this.stringizer = stringize;
505     }
506 
507     static SSLExtension valueOf(SSLHandshake handshakeType, int extensionType) {
508         for (SSLExtension ext : SSLExtension.values()) {
509             if (ext.id == extensionType &amp;&amp;
510                     ext.handshakeType == handshakeType) {
511                 return ext;
512             }
513         }
514 
515         return null;
516     }
517 










518     static boolean isConsumable(int extensionType) {
519         for (SSLExtension ext : SSLExtension.values()) {
520             if (ext.id == extensionType &amp;&amp;
521                     ext.onLoadConsumer != null) {
522                 return true;
523             }
524         }
525 
526         return false;
527     }
528 
529     public byte[] produce(ConnectionContext context,
530             HandshakeMessage message) throws IOException {
531         if (networkProducer != null) {
532             return networkProducer.produce(context, message);
533         } else {
534             throw new UnsupportedOperationException(
535                     &quot;Not yet supported extension producing.&quot;);
536         }
537     }
</pre>
<hr />
<pre>
640     // Default enabled client extensions.
641     static final class ClientExtensions {
642         static final Collection&lt;SSLExtension&gt; defaults;
643 
644         static {
645             Collection&lt;SSLExtension&gt; extensions = new LinkedList&lt;&gt;();
646             for (SSLExtension extension : SSLExtension.values()) {
647                 if (extension.handshakeType != SSLHandshake.NOT_APPLICABLE) {
648                     extensions.add(extension);
649                 }
650             }
651 
652             // Switch off SNI extention?
653             boolean enableExtension =
654                 Utilities.getBooleanProperty(&quot;jsse.enableSNIExtension&quot;, true);
655             if (!enableExtension) {
656                 extensions.remove(CH_SERVER_NAME);
657             }
658 
659             // To switch off the max_fragment_length extension.







660             enableExtension =
<span class="line-modified">661                 Utilities.getBooleanProperty(&quot;jsse.enableMFLExtension&quot;, false);</span>



662             if (!enableExtension) {
663                 extensions.remove(CH_MAX_FRAGMENT_LENGTH);
664             }
665 
666             defaults = Collections.unmodifiableCollection(extensions);
667         }
668     }
669 
670     // Default enabled server extensions.
671     static final class ServerExtensions {
672         static final Collection&lt;SSLExtension&gt; defaults;
673 
674         static {
675             Collection&lt;SSLExtension&gt; extensions = new LinkedList&lt;&gt;();
676             for (SSLExtension extension : SSLExtension.values()) {
677                 if (extension.handshakeType != SSLHandshake.NOT_APPLICABLE) {
678                     extensions.add(extension);
679                 }
680             }
681 
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2018, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 96     TRUNCATED_HMAC          (0x0004, &quot;truncated_hmac&quot;),
 97 
 98     CH_STATUS_REQUEST       (0x0005, &quot;status_request&quot;,
 99                                 SSLHandshake.CLIENT_HELLO,
100                                 ProtocolVersion.PROTOCOLS_TO_13,
101                                 CertStatusExtension.chNetworkProducer,
102                                 CertStatusExtension.chOnLoadConsumer,
103                                 null,
104                                 null,
105                                 null,
106                                 CertStatusExtension.certStatusReqStringizer),
107     SH_STATUS_REQUEST       (0x0005, &quot;status_request&quot;,
108                                 SSLHandshake.SERVER_HELLO,
109                                 ProtocolVersion.PROTOCOLS_TO_12,
110                                 CertStatusExtension.shNetworkProducer,
111                                 CertStatusExtension.shOnLoadConsumer,
112                                 null,
113                                 null,
114                                 null,
115                                 CertStatusExtension.certStatusReqStringizer),

116     CR_STATUS_REQUEST       (0x0005, &quot;status_request&quot;),
117     CT_STATUS_REQUEST       (0x0005, &quot;status_request&quot;,
118                                 SSLHandshake.CERTIFICATE,
119                                 ProtocolVersion.PROTOCOLS_OF_13,
120                                 CertStatusExtension.ctNetworkProducer,
121                                 CertStatusExtension.ctOnLoadConsumer,
122                                 null,
123                                 null,
124                                 null,
125                                 CertStatusExtension.certStatusRespStringizer),
<span class="line-added">126 </span>
127     // extensions defined in RFC 4681
128     USER_MAPPING            (0x0006, &quot;user_mapping&quot;),
129 
130     // extensions defined in RFC 5878
131     CLIENT_AUTHZ            (0x0007, &quot;client_authz&quot;),
132     SERVER_AUTHZ            (0x0008, &quot;server_authz&quot;),
133 
134     // extensions defined in RFC 5081
135     CERT_TYPE               (0x0009, &quot;cert_type&quot;),
136 
137     // extensions defined in RFC 4492 (ECC)
138     CH_SUPPORTED_GROUPS     (0x000A, &quot;supported_groups&quot;,
139                                 SSLHandshake.CLIENT_HELLO,
140                                 ProtocolVersion.PROTOCOLS_TO_13,
141                                 SupportedGroupsExtension.chNetworkProducer,
142                                 SupportedGroupsExtension.chOnLoadConsumer,
143                                 null,
144                                 null,
145                                 null,
146                                 SupportedGroupsExtension.sgsStringizer),
</pre>
<hr />
<pre>
292                                 ExtendedMasterSecretExtension.chOnLoadAbsence,
293                                 null,
294                                 null,
295                                 ExtendedMasterSecretExtension.emsStringizer),
296     SH_EXTENDED_MASTER_SECRET  (0x0017, &quot;extended_master_secret&quot;,
297                                 SSLHandshake.SERVER_HELLO,
298                                 ProtocolVersion.PROTOCOLS_TO_12,
299                                 ExtendedMasterSecretExtension.shNetworkProducer,
300                                 ExtendedMasterSecretExtension.shOnLoadConsumer,
301                                 ExtendedMasterSecretExtension.shOnLoadAbsence,
302                                 null,
303                                 null,
304                                 ExtendedMasterSecretExtension.emsStringizer),
305 
306     // extensions defined in RFC draft-ietf-tokbind-negotiation
307     TOKEN_BINDING           (0x0018, &quot;token_binding &quot;),
308 
309     // extensions defined in RFC 7924
310     CACHED_INFO             (0x0019, &quot;cached_info&quot;),
311 
<span class="line-modified">312     // extensions defined in RFC 5077</span>
<span class="line-modified">313     CH_SESSION_TICKET       (0x0023, &quot;session_ticket&quot;,</span>
<span class="line-added">314             SSLHandshake.CLIENT_HELLO,</span>
<span class="line-added">315             ProtocolVersion.PROTOCOLS_10_12,</span>
<span class="line-added">316             SessionTicketExtension.chNetworkProducer,</span>
<span class="line-added">317             SessionTicketExtension.chOnLoadConsumer,</span>
<span class="line-added">318             null,</span>
<span class="line-added">319             null,</span>
<span class="line-added">320             null,</span>
<span class="line-added">321             SessionTicketExtension.steStringizer),</span>
<span class="line-added">322             //null),</span>
<span class="line-added">323 </span>
<span class="line-added">324     SH_SESSION_TICKET       (0x0023, &quot;session_ticket&quot;,</span>
<span class="line-added">325             SSLHandshake.SERVER_HELLO,</span>
<span class="line-added">326             ProtocolVersion.PROTOCOLS_10_12,</span>
<span class="line-added">327             SessionTicketExtension.shNetworkProducer,</span>
<span class="line-added">328             SessionTicketExtension.shOnLoadConsumer,</span>
<span class="line-added">329             null,</span>
<span class="line-added">330             null,</span>
<span class="line-added">331             null,</span>
<span class="line-added">332             SessionTicketExtension.steStringizer),</span>
<span class="line-added">333             //null),</span>
334 
335     // extensions defined in TLS 1.3
336     CH_EARLY_DATA           (0x002A, &quot;early_data&quot;),
337     EE_EARLY_DATA           (0x002A, &quot;early_data&quot;),
338     NST_EARLY_DATA          (0x002A, &quot;early_data&quot;),
339 
340     CH_SUPPORTED_VERSIONS   (0x002B, &quot;supported_versions&quot;,
341                                 SSLHandshake.CLIENT_HELLO,
342                                 ProtocolVersion.PROTOCOLS_TO_13,
343                                 SupportedVersionsExtension.chNetworkProducer,
344                                 SupportedVersionsExtension.chOnLoadConsumer,
345                                 null,
346                                 null,
347                                 null,
348                                 SupportedVersionsExtension.chStringizer),
349     SH_SUPPORTED_VERSIONS   (0x002B, &quot;supported_versions&quot;,
350                                 SSLHandshake.SERVER_HELLO,
351                                         // and HelloRetryRequest
352                                 ProtocolVersion.PROTOCOLS_OF_13,
353                                 SupportedVersionsExtension.shNetworkProducer,
</pre>
<hr />
<pre>
467                                 ProtocolVersion.PROTOCOLS_OF_13,
468                                 PreSharedKeyExtension.chNetworkProducer,
469                                 PreSharedKeyExtension.chOnLoadConsumer,
470                                 PreSharedKeyExtension.chOnLoadAbsence,
471                                 PreSharedKeyExtension.chOnTradeConsumer,
472                                 null,
473                                 PreSharedKeyExtension.chStringizer),
474     SH_PRE_SHARED_KEY       (0x0029, &quot;pre_shared_key&quot;,
475                                 SSLHandshake.SERVER_HELLO,
476                                 ProtocolVersion.PROTOCOLS_OF_13,
477                                 PreSharedKeyExtension.shNetworkProducer,
478                                 PreSharedKeyExtension.shOnLoadConsumer,
479                                 PreSharedKeyExtension.shOnLoadAbsence,
480                                 null, null,
481                                 PreSharedKeyExtension.shStringizer);
482 
483     final int id;
484     final SSLHandshake handshakeType;
485     final String name;
486     final ProtocolVersion[] supportedProtocols;
<span class="line-added">487 </span>
<span class="line-added">488     /*</span>
<span class="line-added">489      * networkProducer: produces outbound handshake data.</span>
<span class="line-added">490      *</span>
<span class="line-added">491      * onLoadConsumer:  parses inbound data.  It may not be appropriate</span>
<span class="line-added">492      *                  to act until all of the message inputs have</span>
<span class="line-added">493      *                  been parsed.  (e.g. parsing keyShares and choosing</span>
<span class="line-added">494      *                  a local value without having seen the SupportedGroups</span>
<span class="line-added">495      *                  extension.)</span>
<span class="line-added">496      *</span>
<span class="line-added">497      * onLoadAbsence:   if a missing message needs special handling</span>
<span class="line-added">498      *                  during the load phase.</span>
<span class="line-added">499      *</span>
<span class="line-added">500      * onTradeConsumer: act on the parsed message once all inbound data has</span>
<span class="line-added">501      *                  been traded and parsed.</span>
<span class="line-added">502      *</span>
<span class="line-added">503      * onTradeAbsence:  if a missing message needs special handling</span>
<span class="line-added">504      *                  during the trade phase.</span>
<span class="line-added">505      */</span>
506     final HandshakeProducer networkProducer;
507     final ExtensionConsumer onLoadConsumer;
508     final HandshakeAbsence  onLoadAbsence;
509     final HandshakeConsumer onTradeConsumer;
510     final HandshakeAbsence  onTradeAbsence;
511     final SSLStringizer stringizer;
512 
513     // known but unsupported extension
514     private SSLExtension(int id, String name) {
515         this.id = id;
516         this.handshakeType = SSLHandshake.NOT_APPLICABLE;
517         this.name = name;
518         this.supportedProtocols = new ProtocolVersion[0];
519         this.networkProducer = null;
520         this.onLoadConsumer = null;
521         this.onLoadAbsence = null;
522         this.onTradeConsumer = null;
523         this.onTradeAbsence = null;
524         this.stringizer = null;
525     }
</pre>
<hr />
<pre>
537         this.supportedProtocols = supportedProtocols;
538         this.networkProducer = producer;
539         this.onLoadConsumer = onLoadConsumer;
540         this.onLoadAbsence = onLoadAbsence;
541         this.onTradeConsumer = onTradeConsumer;
542         this.onTradeAbsence = onTradeAbsence;
543         this.stringizer = stringize;
544     }
545 
546     static SSLExtension valueOf(SSLHandshake handshakeType, int extensionType) {
547         for (SSLExtension ext : SSLExtension.values()) {
548             if (ext.id == extensionType &amp;&amp;
549                     ext.handshakeType == handshakeType) {
550                 return ext;
551             }
552         }
553 
554         return null;
555     }
556 
<span class="line-added">557     static String nameOf(int extensionType) {</span>
<span class="line-added">558         for (SSLExtension ext : SSLExtension.values()) {</span>
<span class="line-added">559             if (ext.id == extensionType) {</span>
<span class="line-added">560                 return ext.name;</span>
<span class="line-added">561             }</span>
<span class="line-added">562         }</span>
<span class="line-added">563 </span>
<span class="line-added">564         return &quot;unknown extension&quot;;</span>
<span class="line-added">565     }</span>
<span class="line-added">566 </span>
567     static boolean isConsumable(int extensionType) {
568         for (SSLExtension ext : SSLExtension.values()) {
569             if (ext.id == extensionType &amp;&amp;
570                     ext.onLoadConsumer != null) {
571                 return true;
572             }
573         }
574 
575         return false;
576     }
577 
578     public byte[] produce(ConnectionContext context,
579             HandshakeMessage message) throws IOException {
580         if (networkProducer != null) {
581             return networkProducer.produce(context, message);
582         } else {
583             throw new UnsupportedOperationException(
584                     &quot;Not yet supported extension producing.&quot;);
585         }
586     }
</pre>
<hr />
<pre>
689     // Default enabled client extensions.
690     static final class ClientExtensions {
691         static final Collection&lt;SSLExtension&gt; defaults;
692 
693         static {
694             Collection&lt;SSLExtension&gt; extensions = new LinkedList&lt;&gt;();
695             for (SSLExtension extension : SSLExtension.values()) {
696                 if (extension.handshakeType != SSLHandshake.NOT_APPLICABLE) {
697                     extensions.add(extension);
698                 }
699             }
700 
701             // Switch off SNI extention?
702             boolean enableExtension =
703                 Utilities.getBooleanProperty(&quot;jsse.enableSNIExtension&quot;, true);
704             if (!enableExtension) {
705                 extensions.remove(CH_SERVER_NAME);
706             }
707 
708             // To switch off the max_fragment_length extension.
<span class="line-added">709             //</span>
<span class="line-added">710             // Note that &quot;jsse.enableMFLNExtension&quot; is the CSR approved</span>
<span class="line-added">711             // property name.  However, &quot;jsse.enableMFLExtension&quot; was used</span>
<span class="line-added">712             // in the original implementation.  Temporarily, if either of</span>
<span class="line-added">713             // the two properties set to true, the extension is switch on.</span>
<span class="line-added">714             // We may remove the &quot;jsse.enableMFLExtension&quot; property in the</span>
<span class="line-added">715             // future.  Please don&#39;t continue to use the misspelling property.</span>
716             enableExtension =
<span class="line-modified">717                 Utilities.getBooleanProperty(</span>
<span class="line-added">718                         &quot;jsse.enableMFLNExtension&quot;, false) ||</span>
<span class="line-added">719                 Utilities.getBooleanProperty(</span>
<span class="line-added">720                         &quot;jsse.enableMFLExtension&quot;, false);</span>
721             if (!enableExtension) {
722                 extensions.remove(CH_MAX_FRAGMENT_LENGTH);
723             }
724 
725             defaults = Collections.unmodifiableCollection(extensions);
726         }
727     }
728 
729     // Default enabled server extensions.
730     static final class ServerExtensions {
731         static final Collection&lt;SSLExtension&gt; defaults;
732 
733         static {
734             Collection&lt;SSLExtension&gt; extensions = new LinkedList&lt;&gt;();
735             for (SSLExtension extension : SSLExtension.values()) {
736                 if (extension.handshakeType != SSLHandshake.NOT_APPLICABLE) {
737                     extensions.add(extension);
738                 }
739             }
740 
</pre>
</td>
</tr>
</table>
<center><a href="SSLEngineOutputRecord.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="SSLExtensions.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>