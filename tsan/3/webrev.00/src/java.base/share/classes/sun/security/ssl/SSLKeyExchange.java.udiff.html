<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.base/share/classes/sun/security/ssl/SSLKeyExchange.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="SSLHandshake.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="SSLLogger.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/ssl/SSLKeyExchange.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2015, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2015, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -28,14 +28,10 @@</span>
  import java.io.IOException;
  import java.util.AbstractMap.SimpleImmutableEntry;
  import java.util.Arrays;
  import java.util.HashMap;
  import java.util.Map;
<span class="udiff-line-removed">- import sun.security.ssl.DHKeyExchange.DHEPossession;</span>
<span class="udiff-line-removed">- import sun.security.ssl.ECDHKeyExchange.ECDHEPossession;</span>
<span class="udiff-line-removed">- import sun.security.ssl.SupportedGroupsExtension.NamedGroup;</span>
<span class="udiff-line-removed">- import sun.security.ssl.SupportedGroupsExtension.NamedGroupType;</span>
  import sun.security.ssl.SupportedGroupsExtension.SupportedGroups;
  import sun.security.ssl.X509Authentication.X509Possession;
  
  final class SSLKeyExchange implements SSLKeyAgreementGenerator,
          SSLHandshakeBinding {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -241,12 +237,11 @@</span>
  
      // TLS 1.3
      static SSLKeyExchange valueOf(NamedGroup namedGroup) {
          SSLKeyAgreement ka = T13KeyAgreement.valueOf(namedGroup);
          if (ka != null) {
<span class="udiff-line-modified-removed">-             return new SSLKeyExchange(</span>
<span class="udiff-line-removed">-                 null, T13KeyAgreement.valueOf(namedGroup));</span>
<span class="udiff-line-modified-added">+             return new SSLKeyExchange(null, ka);</span>
          }
  
          return null;
      }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -335,11 +330,11 @@</span>
          DHE_EXPORT      (&quot;dhe_export&quot;,  DHKeyExchange.poExportableGenerator,
                                          DHKeyExchange.kaGenerator),
          ECDH            (&quot;ecdh&quot;,        null,
                                          ECDHKeyExchange.ecdhKAGenerator),
          ECDHE           (&quot;ecdhe&quot;,       ECDHKeyExchange.poGenerator,
<span class="udiff-line-modified-removed">-                                         ECDHKeyExchange.ecdheKAGenerator);</span>
<span class="udiff-line-modified-added">+                                         ECDHKeyExchange.ecdheXdhKAGenerator);</span>
  
          final String name;
          final SSLPossessionGenerator possessionGenerator;
          final SSLKeyAgreementGenerator keyAgreementGenerator;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -568,29 +563,15 @@</span>
              return supportedKeyShares.get(namedGroup);
          }
  
          @Override
          public SSLPossession createPossession(HandshakeContext hc) {
<span class="udiff-line-modified-removed">-             if (namedGroup.type == NamedGroupType.NAMED_GROUP_ECDHE) {</span>
<span class="udiff-line-removed">-                 return new ECDHEPossession(</span>
<span class="udiff-line-removed">-                         namedGroup, hc.sslContext.getSecureRandom());</span>
<span class="udiff-line-removed">-             } else if (namedGroup.type == NamedGroupType.NAMED_GROUP_FFDHE) {</span>
<span class="udiff-line-removed">-                 return new DHEPossession(</span>
<span class="udiff-line-removed">-                         namedGroup, hc.sslContext.getSecureRandom());</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             return null;</span>
<span class="udiff-line-modified-added">+             return namedGroup.createPossession(hc.sslContext.getSecureRandom());</span>
          }
  
          @Override
          public SSLKeyDerivation createKeyDerivation(
                  HandshakeContext hc) throws IOException {
<span class="udiff-line-modified-removed">-             if (namedGroup.type == NamedGroupType.NAMED_GROUP_ECDHE) {</span>
<span class="udiff-line-removed">-                 return ECDHKeyExchange.ecdheKAGenerator.createKeyDerivation(hc);</span>
<span class="udiff-line-removed">-             } else if (namedGroup.type == NamedGroupType.NAMED_GROUP_FFDHE) {</span>
<span class="udiff-line-removed">-                 return DHKeyExchange.kaGenerator.createKeyDerivation(hc);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             return null;</span>
<span class="udiff-line-modified-added">+             return namedGroup.createKeyDerivation(hc);</span>
          }
      }
  }
</pre>
<center><a href="SSLHandshake.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="SSLLogger.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>