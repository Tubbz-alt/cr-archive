<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/sun/security/ssl/SSLCipher.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="PreSharedKeyExtension.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="SSLConfiguration.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/ssl/SSLCipher.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 29,10 ***</span>
<span class="line-new-header">--- 29,11 ---</span>
  import java.security.AccessController;
  import java.security.GeneralSecurityException;
  import java.security.InvalidAlgorithmParameterException;
  import java.security.InvalidKeyException;
  import java.security.Key;
<span class="line-added">+ import java.security.NoSuchAlgorithmException;</span>
  import java.security.PrivilegedAction;
  import java.security.SecureRandom;
  import java.security.Security;
  import java.security.spec.AlgorithmParameterSpec;
  import java.util.AbstractMap.SimpleImmutableEntry;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 40,10 ***</span>
<span class="line-new-header">--- 41,11 ---</span>
  import java.util.HashMap;
  import java.util.Map;
  import javax.crypto.BadPaddingException;
  import javax.crypto.Cipher;
  import javax.crypto.IllegalBlockSizeException;
<span class="line-added">+ import javax.crypto.NoSuchPaddingException;</span>
  import javax.crypto.SecretKey;
  import javax.crypto.ShortBufferException;
  import javax.crypto.spec.GCMParameterSpec;
  import javax.crypto.spec.IvParameterSpec;
  import sun.security.ssl.Authenticator.MAC;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 489,20 ***</span>
          this.expandedKeySize = expandedKeySize;
          this.exportable = exportable;
  
          // availability of this bulk cipher
          //
<span class="line-modified">!         // We assume all supported ciphers are always available since they are</span>
<span class="line-modified">!         // shipped with the SunJCE  provider.  However, AES/256 is unavailable</span>
<span class="line-modified">!         // when the default JCE policy jurisdiction files are installed because</span>
<span class="line-modified">!         // of key length restrictions.</span>
<span class="line-removed">-         this.isAvailable = allowed &amp;&amp; isUnlimited(keySize, transformation);</span>
  
          this.readCipherGenerators = readCipherGenerators;
          this.writeCipherGenerators = writeCipherGenerators;
      }
  
      SSLReadCipher createReadCipher(Authenticator authenticator,
              ProtocolVersion protocolVersion,
              SecretKey key, IvParameterSpec iv,
              SecureRandom random) throws GeneralSecurityException {
          if (readCipherGenerators.length == 0) {
<span class="line-new-header">--- 491,35 ---</span>
          this.expandedKeySize = expandedKeySize;
          this.exportable = exportable;
  
          // availability of this bulk cipher
          //
<span class="line-modified">!         // AES/256 is unavailable when the default JCE policy jurisdiction files</span>
<span class="line-modified">!         // are installed because of key length restrictions.</span>
<span class="line-modified">!         this.isAvailable = allowed &amp;&amp; isUnlimited(keySize, transformation) &amp;&amp;</span>
<span class="line-modified">!                 isTransformationAvailable(transformation);</span>
  
          this.readCipherGenerators = readCipherGenerators;
          this.writeCipherGenerators = writeCipherGenerators;
      }
  
<span class="line-added">+     private static boolean isTransformationAvailable(String transformation) {</span>
<span class="line-added">+         if (transformation.equals(&quot;NULL&quot;)) {</span>
<span class="line-added">+             return true;</span>
<span class="line-added">+         }</span>
<span class="line-added">+         try {</span>
<span class="line-added">+             Cipher.getInstance(transformation);</span>
<span class="line-added">+             return true;</span>
<span class="line-added">+         } catch (NoSuchAlgorithmException | NoSuchPaddingException e) {</span>
<span class="line-added">+             if (SSLLogger.isOn &amp;&amp; SSLLogger.isOn(&quot;ssl&quot;)) {</span>
<span class="line-added">+                 SSLLogger.fine(&quot;Transformation &quot; + transformation + &quot; is&quot; +</span>
<span class="line-added">+                         &quot; not available.&quot;);</span>
<span class="line-added">+             }</span>
<span class="line-added">+         }</span>
<span class="line-added">+         return false;</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      SSLReadCipher createReadCipher(Authenticator authenticator,
              ProtocolVersion protocolVersion,
              SecretKey key, IvParameterSpec iv,
              SecureRandom random) throws GeneralSecurityException {
          if (readCipherGenerators.length == 0) {
</pre>
<center><a href="PreSharedKeyExtension.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="SSLConfiguration.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>