<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/sun/security/provider/ConfigFile.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../pkcs12/PKCS12KeyStore.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="DRBG.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/provider/ConfigFile.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2000, 2014, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 29 import java.net.MalformedURLException;
 30 import java.net.URI;
 31 import java.net.URL;
 32 import java.security.AccessController;
 33 import java.security.PrivilegedAction;
 34 import java.security.PrivilegedActionException;
 35 import java.security.PrivilegedExceptionAction;
 36 import java.security.Security;
 37 import java.security.URIParameter;
 38 import java.text.MessageFormat;
 39 import java.util.*;
 40 import javax.security.auth.AuthPermission;
 41 import javax.security.auth.login.AppConfigurationEntry;
 42 import javax.security.auth.login.AppConfigurationEntry.LoginModuleControlFlag;
 43 import javax.security.auth.login.Configuration;
 44 import javax.security.auth.login.ConfigurationSpi;
 45 import sun.security.util.Debug;
 46 import sun.security.util.PropertyExpander;
 47 import sun.security.util.ResourcesMgr;
 48 


 49 /**
 50  * This class represents a default implementation for
 51  * {@code javax.security.auth.login.Configuration}.
 52  *
 53  * &lt;p&gt; This object stores the runtime login configuration representation,
 54  * and is the amalgamation of multiple static login configurations that
 55  * resides in files. The algorithm for locating the login configuration
 56  * file(s) and reading their information into this {@code Configuration}
 57  * object is:
 58  *
 59  * &lt;ol&gt;
 60  * &lt;li&gt;
 61  *   Loop through the security properties,
 62  *   &lt;i&gt;login.config.url.1&lt;/i&gt;, &lt;i&gt;login.config.url.2&lt;/i&gt;, ...,
 63  *   &lt;i&gt;login.config.url.X&lt;/i&gt;.
 64  *   Each property value specifies a {@code URL} pointing to a
 65  *   login configuration file to be loaded.  Read in and load
 66  *   each configuration.
 67  *
 68  * &lt;li&gt;
</pre>
<hr />
<pre>
308                 }
309                 config_url = System.getProperty(&quot;user.home&quot;);
310                 String userConfigFile = config_url + File.separatorChar +
311                                         &quot;.java.login.config&quot;;
312 
313                 // No longer throws an exception when there&#39;s no config file
314                 // at all. Returns an empty Configuration instead.
315                 if (new File(userConfigFile).exists()) {
316                     init(new File(userConfigFile).toURI().toURL(), newConfig);
317                 }
318             }
319 
320             configuration = newConfig;
321         }
322 
323         private void init(URL config,
324                           Map&lt;String, List&lt;AppConfigurationEntry&gt;&gt; newConfig)
325                           throws IOException {
326 
327             try (InputStreamReader isr
<span class="line-modified">328                     = new InputStreamReader(getInputStream(config), &quot;UTF-8&quot;)) {</span>
329                 readConfig(isr, newConfig);
330             } catch (FileNotFoundException fnfe) {
331                 if (debugConfig != null) {
332                     debugConfig.println(fnfe.toString());
333                 }
334                 throw new IOException(ResourcesMgr.getAuthResourceString
335                     (&quot;Configuration.Error.No.such.file.or.directory&quot;));
336             }
337         }
338 
339         /**
340          * Retrieve an entry from the Configuration using an application name
341          * as an index.
342          *
343          * @param applicationName the name used to index the Configuration.
344          * @return an array of AppConfigurationEntries which correspond to
345          *         the stacked configuration of LoginModules for this
346          *         application, or null if this application has no configured
347          *         LoginModules.
348          */
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 29 import java.net.MalformedURLException;
 30 import java.net.URI;
 31 import java.net.URL;
 32 import java.security.AccessController;
 33 import java.security.PrivilegedAction;
 34 import java.security.PrivilegedActionException;
 35 import java.security.PrivilegedExceptionAction;
 36 import java.security.Security;
 37 import java.security.URIParameter;
 38 import java.text.MessageFormat;
 39 import java.util.*;
 40 import javax.security.auth.AuthPermission;
 41 import javax.security.auth.login.AppConfigurationEntry;
 42 import javax.security.auth.login.AppConfigurationEntry.LoginModuleControlFlag;
 43 import javax.security.auth.login.Configuration;
 44 import javax.security.auth.login.ConfigurationSpi;
 45 import sun.security.util.Debug;
 46 import sun.security.util.PropertyExpander;
 47 import sun.security.util.ResourcesMgr;
 48 
<span class="line-added"> 49 import static java.nio.charset.StandardCharsets.UTF_8;</span>
<span class="line-added"> 50 </span>
 51 /**
 52  * This class represents a default implementation for
 53  * {@code javax.security.auth.login.Configuration}.
 54  *
 55  * &lt;p&gt; This object stores the runtime login configuration representation,
 56  * and is the amalgamation of multiple static login configurations that
 57  * resides in files. The algorithm for locating the login configuration
 58  * file(s) and reading their information into this {@code Configuration}
 59  * object is:
 60  *
 61  * &lt;ol&gt;
 62  * &lt;li&gt;
 63  *   Loop through the security properties,
 64  *   &lt;i&gt;login.config.url.1&lt;/i&gt;, &lt;i&gt;login.config.url.2&lt;/i&gt;, ...,
 65  *   &lt;i&gt;login.config.url.X&lt;/i&gt;.
 66  *   Each property value specifies a {@code URL} pointing to a
 67  *   login configuration file to be loaded.  Read in and load
 68  *   each configuration.
 69  *
 70  * &lt;li&gt;
</pre>
<hr />
<pre>
310                 }
311                 config_url = System.getProperty(&quot;user.home&quot;);
312                 String userConfigFile = config_url + File.separatorChar +
313                                         &quot;.java.login.config&quot;;
314 
315                 // No longer throws an exception when there&#39;s no config file
316                 // at all. Returns an empty Configuration instead.
317                 if (new File(userConfigFile).exists()) {
318                     init(new File(userConfigFile).toURI().toURL(), newConfig);
319                 }
320             }
321 
322             configuration = newConfig;
323         }
324 
325         private void init(URL config,
326                           Map&lt;String, List&lt;AppConfigurationEntry&gt;&gt; newConfig)
327                           throws IOException {
328 
329             try (InputStreamReader isr
<span class="line-modified">330                     = new InputStreamReader(getInputStream(config), UTF_8)) {</span>
331                 readConfig(isr, newConfig);
332             } catch (FileNotFoundException fnfe) {
333                 if (debugConfig != null) {
334                     debugConfig.println(fnfe.toString());
335                 }
336                 throw new IOException(ResourcesMgr.getAuthResourceString
337                     (&quot;Configuration.Error.No.such.file.or.directory&quot;));
338             }
339         }
340 
341         /**
342          * Retrieve an entry from the Configuration using an application name
343          * as an index.
344          *
345          * @param applicationName the name used to index the Configuration.
346          * @return an array of AppConfigurationEntries which correspond to
347          *         the stacked configuration of LoginModules for this
348          *         application, or null if this application has no configured
349          *         LoginModules.
350          */
</pre>
</td>
</tr>
</table>
<center><a href="../pkcs12/PKCS12KeyStore.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="DRBG.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>