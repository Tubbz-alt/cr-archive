<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/java.base/share/classes/sun/security/util/math/intpoly/P384OrderField.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2018, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 /*
 27  * This file is generated by FieldGen.jsh. Do not modify it directly.
 28  */
 29 
 30 package sun.security.util.math.intpoly;
 31 
 32 import java.math.BigInteger;
 33 public class P384OrderField extends IntegerPolynomial {
 34     private static final int BITS_PER_LIMB = 28;
 35     private static final int NUM_LIMBS = 14;
 36     private static final int MAX_ADDS = 1;
 37     public static final BigInteger MODULUS = evaluateModulus();
 38     private static final long CARRY_ADD = 1 &lt;&lt; 27;
 39     private static final int LIMB_MASK = -1 &gt;&gt;&gt; (64 - BITS_PER_LIMB);
 40     public P384OrderField() {
 41 
 42         super(BITS_PER_LIMB, NUM_LIMBS, MAX_ADDS, MODULUS);
 43 
 44     }
 45     private static BigInteger evaluateModulus() {
 46         BigInteger result = BigInteger.valueOf(2).pow(384);
 47         result = result.subtract(BigInteger.valueOf(54187661));
 48         result = result.subtract(BigInteger.valueOf(2).pow(28).multiply(BigInteger.valueOf(20867411)));
 49         result = result.add(BigInteger.valueOf(2).pow(56).multiply(BigInteger.valueOf(10975981)));
 50         result = result.add(BigInteger.valueOf(2).pow(84).multiply(BigInteger.valueOf(14361739)));
 51         result = result.subtract(BigInteger.valueOf(2).pow(112).multiply(BigInteger.valueOf(35694566)));
 52         result = result.subtract(BigInteger.valueOf(2).pow(140).multiply(BigInteger.valueOf(132168845)));
 53         result = result.subtract(BigInteger.valueOf(2).pow(168).multiply(BigInteger.valueOf(3710130)));
 54         return result;
 55     }
 56     @Override
 57     protected void finalCarryReduceLast(long[] limbs) {
 58         long c = limbs[13] &gt;&gt; 20;
 59         limbs[13] -= c &lt;&lt; 20;
 60         long t0 = 54187661 * c;
 61         limbs[0] += t0;
 62         t0 = 20867411 * c;
 63         limbs[1] += t0;
 64         t0 = -10975981 * c;
 65         limbs[2] += t0;
 66         t0 = -14361739 * c;
 67         limbs[3] += t0;
 68         t0 = 35694566 * c;
 69         limbs[4] += t0;
 70         t0 = 132168845 * c;
 71         limbs[5] += t0;
 72         t0 = 3710130 * c;
 73         limbs[6] += t0;
 74     }
 75     private void carryReduce(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9, long c10, long c11, long c12, long c13, long c14, long c15, long c16, long c17, long c18, long c19, long c20, long c21, long c22, long c23, long c24, long c25, long c26) {
 76         long c27 = 0;
 77         //carry from position 0
 78         long t0 = (c0 + CARRY_ADD) &gt;&gt; 28;
 79         c0 -= (t0 &lt;&lt; 28);
 80         c1 += t0;
 81         //carry from position 1
 82         t0 = (c1 + CARRY_ADD) &gt;&gt; 28;
 83         c1 -= (t0 &lt;&lt; 28);
 84         c2 += t0;
 85         //carry from position 2
 86         t0 = (c2 + CARRY_ADD) &gt;&gt; 28;
 87         c2 -= (t0 &lt;&lt; 28);
 88         c3 += t0;
 89         //carry from position 3
 90         t0 = (c3 + CARRY_ADD) &gt;&gt; 28;
 91         c3 -= (t0 &lt;&lt; 28);
 92         c4 += t0;
 93         //carry from position 4
 94         t0 = (c4 + CARRY_ADD) &gt;&gt; 28;
 95         c4 -= (t0 &lt;&lt; 28);
 96         c5 += t0;
 97         //carry from position 5
 98         t0 = (c5 + CARRY_ADD) &gt;&gt; 28;
 99         c5 -= (t0 &lt;&lt; 28);
100         c6 += t0;
101         //carry from position 6
102         t0 = (c6 + CARRY_ADD) &gt;&gt; 28;
103         c6 -= (t0 &lt;&lt; 28);
104         c7 += t0;
105         //carry from position 7
106         t0 = (c7 + CARRY_ADD) &gt;&gt; 28;
107         c7 -= (t0 &lt;&lt; 28);
108         c8 += t0;
109         //carry from position 8
110         t0 = (c8 + CARRY_ADD) &gt;&gt; 28;
111         c8 -= (t0 &lt;&lt; 28);
112         c9 += t0;
113         //carry from position 9
114         t0 = (c9 + CARRY_ADD) &gt;&gt; 28;
115         c9 -= (t0 &lt;&lt; 28);
116         c10 += t0;
117         //carry from position 10
118         t0 = (c10 + CARRY_ADD) &gt;&gt; 28;
119         c10 -= (t0 &lt;&lt; 28);
120         c11 += t0;
121         //carry from position 11
122         t0 = (c11 + CARRY_ADD) &gt;&gt; 28;
123         c11 -= (t0 &lt;&lt; 28);
124         c12 += t0;
125         //carry from position 12
126         t0 = (c12 + CARRY_ADD) &gt;&gt; 28;
127         c12 -= (t0 &lt;&lt; 28);
128         c13 += t0;
129         //carry from position 13
130         t0 = (c13 + CARRY_ADD) &gt;&gt; 28;
131         c13 -= (t0 &lt;&lt; 28);
132         c14 += t0;
133         //carry from position 14
134         t0 = (c14 + CARRY_ADD) &gt;&gt; 28;
135         c14 -= (t0 &lt;&lt; 28);
136         c15 += t0;
137         //carry from position 15
138         t0 = (c15 + CARRY_ADD) &gt;&gt; 28;
139         c15 -= (t0 &lt;&lt; 28);
140         c16 += t0;
141         //carry from position 16
142         t0 = (c16 + CARRY_ADD) &gt;&gt; 28;
143         c16 -= (t0 &lt;&lt; 28);
144         c17 += t0;
145         //carry from position 17
146         t0 = (c17 + CARRY_ADD) &gt;&gt; 28;
147         c17 -= (t0 &lt;&lt; 28);
148         c18 += t0;
149         //carry from position 18
150         t0 = (c18 + CARRY_ADD) &gt;&gt; 28;
151         c18 -= (t0 &lt;&lt; 28);
152         c19 += t0;
153         //carry from position 19
154         t0 = (c19 + CARRY_ADD) &gt;&gt; 28;
155         c19 -= (t0 &lt;&lt; 28);
156         c20 += t0;
157         //carry from position 20
158         t0 = (c20 + CARRY_ADD) &gt;&gt; 28;
159         c20 -= (t0 &lt;&lt; 28);
160         c21 += t0;
161         //carry from position 21
162         t0 = (c21 + CARRY_ADD) &gt;&gt; 28;
163         c21 -= (t0 &lt;&lt; 28);
164         c22 += t0;
165         //carry from position 22
166         t0 = (c22 + CARRY_ADD) &gt;&gt; 28;
167         c22 -= (t0 &lt;&lt; 28);
168         c23 += t0;
169         //carry from position 23
170         t0 = (c23 + CARRY_ADD) &gt;&gt; 28;
171         c23 -= (t0 &lt;&lt; 28);
172         c24 += t0;
173         //carry from position 24
174         t0 = (c24 + CARRY_ADD) &gt;&gt; 28;
175         c24 -= (t0 &lt;&lt; 28);
176         c25 += t0;
177         //carry from position 25
178         t0 = (c25 + CARRY_ADD) &gt;&gt; 28;
179         c25 -= (t0 &lt;&lt; 28);
180         c26 += t0;
181         //carry from position 26
182         t0 = (c26 + CARRY_ADD) &gt;&gt; 28;
183         c26 -= (t0 &lt;&lt; 28);
184         c27 += t0;
185 
186         carryReduce0(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20, c21, c22, c23, c24, c25, c26, c27);
187     }
188     void carryReduce0(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9, long c10, long c11, long c12, long c13, long c14, long c15, long c16, long c17, long c18, long c19, long c20, long c21, long c22, long c23, long c24, long c25, long c26, long c27) {
189         long t0;
190 
191         //reduce from position 27
192         t0 = 54187661 * c27;
193         c13 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
194         c14 += t0 &gt;&gt; 20;
195         t0 = 20867411 * c27;
196         c14 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
197         c15 += t0 &gt;&gt; 20;
198         t0 = -10975981 * c27;
199         c15 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
200         c16 += t0 &gt;&gt; 20;
201         t0 = -14361739 * c27;
202         c16 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
203         c17 += t0 &gt;&gt; 20;
204         t0 = 35694566 * c27;
205         c17 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
206         c18 += t0 &gt;&gt; 20;
207         t0 = 132168845 * c27;
208         c18 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
209         c19 += t0 &gt;&gt; 20;
210         t0 = 3710130 * c27;
211         c19 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
212         c20 += t0 &gt;&gt; 20;
213         //reduce from position 26
214         t0 = 54187661 * c26;
215         c12 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
216         c13 += t0 &gt;&gt; 20;
217         t0 = 20867411 * c26;
218         c13 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
219         c14 += t0 &gt;&gt; 20;
220         t0 = -10975981 * c26;
221         c14 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
222         c15 += t0 &gt;&gt; 20;
223         t0 = -14361739 * c26;
224         c15 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
225         c16 += t0 &gt;&gt; 20;
226         t0 = 35694566 * c26;
227         c16 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
228         c17 += t0 &gt;&gt; 20;
229         t0 = 132168845 * c26;
230         c17 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
231         c18 += t0 &gt;&gt; 20;
232         t0 = 3710130 * c26;
233         c18 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
234         c19 += t0 &gt;&gt; 20;
235         //reduce from position 25
236         t0 = 54187661 * c25;
237         c11 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
238         c12 += t0 &gt;&gt; 20;
239         t0 = 20867411 * c25;
240         c12 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
241         c13 += t0 &gt;&gt; 20;
242         t0 = -10975981 * c25;
243         c13 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
244         c14 += t0 &gt;&gt; 20;
245         t0 = -14361739 * c25;
246         c14 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
247         c15 += t0 &gt;&gt; 20;
248         t0 = 35694566 * c25;
249         c15 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
250         c16 += t0 &gt;&gt; 20;
251         t0 = 132168845 * c25;
252         c16 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
253         c17 += t0 &gt;&gt; 20;
254         t0 = 3710130 * c25;
255         c17 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
256         c18 += t0 &gt;&gt; 20;
257         //reduce from position 24
258         t0 = 54187661 * c24;
259         c10 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
260         c11 += t0 &gt;&gt; 20;
261         t0 = 20867411 * c24;
262         c11 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
263         c12 += t0 &gt;&gt; 20;
264         t0 = -10975981 * c24;
265         c12 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
266         c13 += t0 &gt;&gt; 20;
267         t0 = -14361739 * c24;
268         c13 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
269         c14 += t0 &gt;&gt; 20;
270         t0 = 35694566 * c24;
271         c14 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
272         c15 += t0 &gt;&gt; 20;
273         t0 = 132168845 * c24;
274         c15 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
275         c16 += t0 &gt;&gt; 20;
276         t0 = 3710130 * c24;
277         c16 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
278         c17 += t0 &gt;&gt; 20;
279         //reduce from position 23
280         t0 = 54187661 * c23;
281         c9 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
282         c10 += t0 &gt;&gt; 20;
283         t0 = 20867411 * c23;
284         c10 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
285         c11 += t0 &gt;&gt; 20;
286         t0 = -10975981 * c23;
287         c11 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
288         c12 += t0 &gt;&gt; 20;
289         t0 = -14361739 * c23;
290         c12 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
291         c13 += t0 &gt;&gt; 20;
292         t0 = 35694566 * c23;
293         c13 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
294         c14 += t0 &gt;&gt; 20;
295         t0 = 132168845 * c23;
296         c14 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
297         c15 += t0 &gt;&gt; 20;
298         t0 = 3710130 * c23;
299         c15 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
300         c16 += t0 &gt;&gt; 20;
301         //reduce from position 22
302         t0 = 54187661 * c22;
303         c8 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
304         c9 += t0 &gt;&gt; 20;
305         t0 = 20867411 * c22;
306         c9 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
307         c10 += t0 &gt;&gt; 20;
308         t0 = -10975981 * c22;
309         c10 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
310         c11 += t0 &gt;&gt; 20;
311         t0 = -14361739 * c22;
312         c11 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
313         c12 += t0 &gt;&gt; 20;
314         t0 = 35694566 * c22;
315         c12 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
316         c13 += t0 &gt;&gt; 20;
317         t0 = 132168845 * c22;
318         c13 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
319         c14 += t0 &gt;&gt; 20;
320         t0 = 3710130 * c22;
321         c14 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
322         c15 += t0 &gt;&gt; 20;
323         //reduce from position 21
324         t0 = 54187661 * c21;
325         c7 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
326         c8 += t0 &gt;&gt; 20;
327         t0 = 20867411 * c21;
328         c8 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
329         c9 += t0 &gt;&gt; 20;
330         t0 = -10975981 * c21;
331         c9 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
332         c10 += t0 &gt;&gt; 20;
333         t0 = -14361739 * c21;
334         c10 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
335         c11 += t0 &gt;&gt; 20;
336         t0 = 35694566 * c21;
337         c11 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
338         c12 += t0 &gt;&gt; 20;
339         t0 = 132168845 * c21;
340         c12 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
341         c13 += t0 &gt;&gt; 20;
342         t0 = 3710130 * c21;
343         c13 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
344         c14 += t0 &gt;&gt; 20;
345         //reduce from position 20
346         t0 = 54187661 * c20;
347         c6 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
348         c7 += t0 &gt;&gt; 20;
349         t0 = 20867411 * c20;
350         c7 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
351         c8 += t0 &gt;&gt; 20;
352         t0 = -10975981 * c20;
353         c8 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
354         c9 += t0 &gt;&gt; 20;
355         t0 = -14361739 * c20;
356         c9 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
357         c10 += t0 &gt;&gt; 20;
358         t0 = 35694566 * c20;
359         c10 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
360         c11 += t0 &gt;&gt; 20;
361         t0 = 132168845 * c20;
362         c11 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
363         c12 += t0 &gt;&gt; 20;
364         t0 = 3710130 * c20;
365         c12 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
366         c13 += t0 &gt;&gt; 20;
367         //reduce from position 19
368         t0 = 54187661 * c19;
369         c5 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
370         c6 += t0 &gt;&gt; 20;
371         t0 = 20867411 * c19;
372         c6 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
373         c7 += t0 &gt;&gt; 20;
374         t0 = -10975981 * c19;
375         c7 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
376         c8 += t0 &gt;&gt; 20;
377         t0 = -14361739 * c19;
378         c8 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
379         c9 += t0 &gt;&gt; 20;
380         t0 = 35694566 * c19;
381         c9 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
382         c10 += t0 &gt;&gt; 20;
383         t0 = 132168845 * c19;
384         c10 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
385         c11 += t0 &gt;&gt; 20;
386         t0 = 3710130 * c19;
387         c11 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
388         c12 += t0 &gt;&gt; 20;
389         //reduce from position 18
390         t0 = 54187661 * c18;
391         c4 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
392         c5 += t0 &gt;&gt; 20;
393         t0 = 20867411 * c18;
394         c5 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
395         c6 += t0 &gt;&gt; 20;
396         t0 = -10975981 * c18;
397         c6 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
398         c7 += t0 &gt;&gt; 20;
399         t0 = -14361739 * c18;
400         c7 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
401         c8 += t0 &gt;&gt; 20;
402         t0 = 35694566 * c18;
403         c8 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
404         c9 += t0 &gt;&gt; 20;
405         t0 = 132168845 * c18;
406         c9 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
407         c10 += t0 &gt;&gt; 20;
408         t0 = 3710130 * c18;
409         c10 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
410         c11 += t0 &gt;&gt; 20;
411         //reduce from position 17
412         t0 = 54187661 * c17;
413         c3 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
414         c4 += t0 &gt;&gt; 20;
415         t0 = 20867411 * c17;
416         c4 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
417         c5 += t0 &gt;&gt; 20;
418         t0 = -10975981 * c17;
419         c5 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
420         c6 += t0 &gt;&gt; 20;
421         t0 = -14361739 * c17;
422         c6 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
423         c7 += t0 &gt;&gt; 20;
424         t0 = 35694566 * c17;
425         c7 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
426         c8 += t0 &gt;&gt; 20;
427         t0 = 132168845 * c17;
428         c8 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
429         c9 += t0 &gt;&gt; 20;
430         t0 = 3710130 * c17;
431         c9 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
432         c10 += t0 &gt;&gt; 20;
433         //reduce from position 16
434         t0 = 54187661 * c16;
435         c2 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
436         c3 += t0 &gt;&gt; 20;
437         t0 = 20867411 * c16;
438         c3 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
439         c4 += t0 &gt;&gt; 20;
440         t0 = -10975981 * c16;
441         c4 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
442         c5 += t0 &gt;&gt; 20;
443         t0 = -14361739 * c16;
444         c5 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
445         c6 += t0 &gt;&gt; 20;
446         t0 = 35694566 * c16;
447         c6 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
448         c7 += t0 &gt;&gt; 20;
449         t0 = 132168845 * c16;
450         c7 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
451         c8 += t0 &gt;&gt; 20;
452         t0 = 3710130 * c16;
453         c8 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
454         c9 += t0 &gt;&gt; 20;
455         //reduce from position 15
456         t0 = 54187661 * c15;
457         c1 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
458         c2 += t0 &gt;&gt; 20;
459         t0 = 20867411 * c15;
460         c2 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
461         c3 += t0 &gt;&gt; 20;
462         t0 = -10975981 * c15;
463         c3 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
464         c4 += t0 &gt;&gt; 20;
465         t0 = -14361739 * c15;
466         c4 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
467         c5 += t0 &gt;&gt; 20;
468         t0 = 35694566 * c15;
469         c5 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
470         c6 += t0 &gt;&gt; 20;
471         t0 = 132168845 * c15;
472         c6 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
473         c7 += t0 &gt;&gt; 20;
474         t0 = 3710130 * c15;
475         c7 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
476         c8 += t0 &gt;&gt; 20;
477         //reduce from position 14
478         t0 = 54187661 * c14;
479         c0 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
480         c1 += t0 &gt;&gt; 20;
481         t0 = 20867411 * c14;
482         c1 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
483         c2 += t0 &gt;&gt; 20;
484         t0 = -10975981 * c14;
485         c2 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
486         c3 += t0 &gt;&gt; 20;
487         t0 = -14361739 * c14;
488         c3 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
489         c4 += t0 &gt;&gt; 20;
490         t0 = 35694566 * c14;
491         c4 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
492         c5 += t0 &gt;&gt; 20;
493         t0 = 132168845 * c14;
494         c5 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
495         c6 += t0 &gt;&gt; 20;
496         t0 = 3710130 * c14;
497         c6 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
498         c7 += t0 &gt;&gt; 20;
499         c14 = 0;
500 
501         carryReduce1(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20, c21, c22, c23, c24, c25, c26, c27);
502     }
503     void carryReduce1(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9, long c10, long c11, long c12, long c13, long c14, long c15, long c16, long c17, long c18, long c19, long c20, long c21, long c22, long c23, long c24, long c25, long c26, long c27) {
504         long t0;
505 
506         //carry from position 0
507         t0 = (c0 + CARRY_ADD) &gt;&gt; 28;
508         c0 -= (t0 &lt;&lt; 28);
509         c1 += t0;
510         //carry from position 1
511         t0 = (c1 + CARRY_ADD) &gt;&gt; 28;
512         c1 -= (t0 &lt;&lt; 28);
513         c2 += t0;
514         //carry from position 2
515         t0 = (c2 + CARRY_ADD) &gt;&gt; 28;
516         c2 -= (t0 &lt;&lt; 28);
517         c3 += t0;
518         //carry from position 3
519         t0 = (c3 + CARRY_ADD) &gt;&gt; 28;
520         c3 -= (t0 &lt;&lt; 28);
521         c4 += t0;
522         //carry from position 4
523         t0 = (c4 + CARRY_ADD) &gt;&gt; 28;
524         c4 -= (t0 &lt;&lt; 28);
525         c5 += t0;
526         //carry from position 5
527         t0 = (c5 + CARRY_ADD) &gt;&gt; 28;
528         c5 -= (t0 &lt;&lt; 28);
529         c6 += t0;
530         //carry from position 6
531         t0 = (c6 + CARRY_ADD) &gt;&gt; 28;
532         c6 -= (t0 &lt;&lt; 28);
533         c7 += t0;
534         //carry from position 7
535         t0 = (c7 + CARRY_ADD) &gt;&gt; 28;
536         c7 -= (t0 &lt;&lt; 28);
537         c8 += t0;
538         //carry from position 8
539         t0 = (c8 + CARRY_ADD) &gt;&gt; 28;
540         c8 -= (t0 &lt;&lt; 28);
541         c9 += t0;
542         //carry from position 9
543         t0 = (c9 + CARRY_ADD) &gt;&gt; 28;
544         c9 -= (t0 &lt;&lt; 28);
545         c10 += t0;
546         //carry from position 10
547         t0 = (c10 + CARRY_ADD) &gt;&gt; 28;
548         c10 -= (t0 &lt;&lt; 28);
549         c11 += t0;
550         //carry from position 11
551         t0 = (c11 + CARRY_ADD) &gt;&gt; 28;
552         c11 -= (t0 &lt;&lt; 28);
553         c12 += t0;
554         //carry from position 12
555         t0 = (c12 + CARRY_ADD) &gt;&gt; 28;
556         c12 -= (t0 &lt;&lt; 28);
557         c13 += t0;
558         //carry from position 13
559         t0 = (c13 + CARRY_ADD) &gt;&gt; 28;
560         c13 -= (t0 &lt;&lt; 28);
561         c14 += t0;
562 
563         carryReduce2(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20, c21, c22, c23, c24, c25, c26, c27);
564     }
565     void carryReduce2(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9, long c10, long c11, long c12, long c13, long c14, long c15, long c16, long c17, long c18, long c19, long c20, long c21, long c22, long c23, long c24, long c25, long c26, long c27) {
566         long t0;
567 
568         //reduce from position 14
569         t0 = 54187661 * c14;
570         c0 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
571         c1 += t0 &gt;&gt; 20;
572         t0 = 20867411 * c14;
573         c1 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
574         c2 += t0 &gt;&gt; 20;
575         t0 = -10975981 * c14;
576         c2 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
577         c3 += t0 &gt;&gt; 20;
578         t0 = -14361739 * c14;
579         c3 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
580         c4 += t0 &gt;&gt; 20;
581         t0 = 35694566 * c14;
582         c4 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
583         c5 += t0 &gt;&gt; 20;
584         t0 = 132168845 * c14;
585         c5 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
586         c6 += t0 &gt;&gt; 20;
587         t0 = 3710130 * c14;
588         c6 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
589         c7 += t0 &gt;&gt; 20;
590         //carry from position 0
591         t0 = (c0 + CARRY_ADD) &gt;&gt; 28;
592         c0 -= (t0 &lt;&lt; 28);
593         c1 += t0;
594         //carry from position 1
595         t0 = (c1 + CARRY_ADD) &gt;&gt; 28;
596         c1 -= (t0 &lt;&lt; 28);
597         c2 += t0;
598         //carry from position 2
599         t0 = (c2 + CARRY_ADD) &gt;&gt; 28;
600         c2 -= (t0 &lt;&lt; 28);
601         c3 += t0;
602         //carry from position 3
603         t0 = (c3 + CARRY_ADD) &gt;&gt; 28;
604         c3 -= (t0 &lt;&lt; 28);
605         c4 += t0;
606         //carry from position 4
607         t0 = (c4 + CARRY_ADD) &gt;&gt; 28;
608         c4 -= (t0 &lt;&lt; 28);
609         c5 += t0;
610         //carry from position 5
611         t0 = (c5 + CARRY_ADD) &gt;&gt; 28;
612         c5 -= (t0 &lt;&lt; 28);
613         c6 += t0;
614         //carry from position 6
615         t0 = (c6 + CARRY_ADD) &gt;&gt; 28;
616         c6 -= (t0 &lt;&lt; 28);
617         c7 += t0;
618         //carry from position 7
619         t0 = (c7 + CARRY_ADD) &gt;&gt; 28;
620         c7 -= (t0 &lt;&lt; 28);
621         c8 += t0;
622         //carry from position 8
623         t0 = (c8 + CARRY_ADD) &gt;&gt; 28;
624         c8 -= (t0 &lt;&lt; 28);
625         c9 += t0;
626         //carry from position 9
627         t0 = (c9 + CARRY_ADD) &gt;&gt; 28;
628         c9 -= (t0 &lt;&lt; 28);
629         c10 += t0;
630         //carry from position 10
631         t0 = (c10 + CARRY_ADD) &gt;&gt; 28;
632         c10 -= (t0 &lt;&lt; 28);
633         c11 += t0;
634         //carry from position 11
635         t0 = (c11 + CARRY_ADD) &gt;&gt; 28;
636         c11 -= (t0 &lt;&lt; 28);
637         c12 += t0;
638         //carry from position 12
639         t0 = (c12 + CARRY_ADD) &gt;&gt; 28;
640         c12 -= (t0 &lt;&lt; 28);
641         c13 += t0;
642 
643         r[0] = c0;
644         r[1] = c1;
645         r[2] = c2;
646         r[3] = c3;
647         r[4] = c4;
648         r[5] = c5;
649         r[6] = c6;
650         r[7] = c7;
651         r[8] = c8;
652         r[9] = c9;
653         r[10] = c10;
654         r[11] = c11;
655         r[12] = c12;
656         r[13] = c13;
657     }
658     private void carryReduce(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9, long c10, long c11, long c12, long c13) {
659         long c14 = 0;
660         //carry from position 0
661         long t0 = (c0 + CARRY_ADD) &gt;&gt; 28;
662         c0 -= (t0 &lt;&lt; 28);
663         c1 += t0;
664         //carry from position 1
665         t0 = (c1 + CARRY_ADD) &gt;&gt; 28;
666         c1 -= (t0 &lt;&lt; 28);
667         c2 += t0;
668         //carry from position 2
669         t0 = (c2 + CARRY_ADD) &gt;&gt; 28;
670         c2 -= (t0 &lt;&lt; 28);
671         c3 += t0;
672         //carry from position 3
673         t0 = (c3 + CARRY_ADD) &gt;&gt; 28;
674         c3 -= (t0 &lt;&lt; 28);
675         c4 += t0;
676         //carry from position 4
677         t0 = (c4 + CARRY_ADD) &gt;&gt; 28;
678         c4 -= (t0 &lt;&lt; 28);
679         c5 += t0;
680         //carry from position 5
681         t0 = (c5 + CARRY_ADD) &gt;&gt; 28;
682         c5 -= (t0 &lt;&lt; 28);
683         c6 += t0;
684         //carry from position 6
685         t0 = (c6 + CARRY_ADD) &gt;&gt; 28;
686         c6 -= (t0 &lt;&lt; 28);
687         c7 += t0;
688         //carry from position 7
689         t0 = (c7 + CARRY_ADD) &gt;&gt; 28;
690         c7 -= (t0 &lt;&lt; 28);
691         c8 += t0;
692         //carry from position 8
693         t0 = (c8 + CARRY_ADD) &gt;&gt; 28;
694         c8 -= (t0 &lt;&lt; 28);
695         c9 += t0;
696         //carry from position 9
697         t0 = (c9 + CARRY_ADD) &gt;&gt; 28;
698         c9 -= (t0 &lt;&lt; 28);
699         c10 += t0;
700         //carry from position 10
701         t0 = (c10 + CARRY_ADD) &gt;&gt; 28;
702         c10 -= (t0 &lt;&lt; 28);
703         c11 += t0;
704         //carry from position 11
705         t0 = (c11 + CARRY_ADD) &gt;&gt; 28;
706         c11 -= (t0 &lt;&lt; 28);
707         c12 += t0;
708         //carry from position 12
709         t0 = (c12 + CARRY_ADD) &gt;&gt; 28;
710         c12 -= (t0 &lt;&lt; 28);
711         c13 += t0;
712         //carry from position 13
713         t0 = (c13 + CARRY_ADD) &gt;&gt; 28;
714         c13 -= (t0 &lt;&lt; 28);
715         c14 += t0;
716 
717         carryReduce0(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14);
718     }
719     void carryReduce0(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9, long c10, long c11, long c12, long c13, long c14) {
720         long t0;
721 
722         //reduce from position 14
723         t0 = 54187661 * c14;
724         c0 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
725         c1 += t0 &gt;&gt; 20;
726         t0 = 20867411 * c14;
727         c1 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
728         c2 += t0 &gt;&gt; 20;
729         t0 = -10975981 * c14;
730         c2 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
731         c3 += t0 &gt;&gt; 20;
732         t0 = -14361739 * c14;
733         c3 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
734         c4 += t0 &gt;&gt; 20;
735         t0 = 35694566 * c14;
736         c4 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
737         c5 += t0 &gt;&gt; 20;
738         t0 = 132168845 * c14;
739         c5 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
740         c6 += t0 &gt;&gt; 20;
741         t0 = 3710130 * c14;
742         c6 += (t0 &lt;&lt; 8) &amp; LIMB_MASK;
743         c7 += t0 &gt;&gt; 20;
744         //carry from position 0
745         t0 = (c0 + CARRY_ADD) &gt;&gt; 28;
746         c0 -= (t0 &lt;&lt; 28);
747         c1 += t0;
748         //carry from position 1
749         t0 = (c1 + CARRY_ADD) &gt;&gt; 28;
750         c1 -= (t0 &lt;&lt; 28);
751         c2 += t0;
752         //carry from position 2
753         t0 = (c2 + CARRY_ADD) &gt;&gt; 28;
754         c2 -= (t0 &lt;&lt; 28);
755         c3 += t0;
756         //carry from position 3
757         t0 = (c3 + CARRY_ADD) &gt;&gt; 28;
758         c3 -= (t0 &lt;&lt; 28);
759         c4 += t0;
760         //carry from position 4
761         t0 = (c4 + CARRY_ADD) &gt;&gt; 28;
762         c4 -= (t0 &lt;&lt; 28);
763         c5 += t0;
764         //carry from position 5
765         t0 = (c5 + CARRY_ADD) &gt;&gt; 28;
766         c5 -= (t0 &lt;&lt; 28);
767         c6 += t0;
768         //carry from position 6
769         t0 = (c6 + CARRY_ADD) &gt;&gt; 28;
770         c6 -= (t0 &lt;&lt; 28);
771         c7 += t0;
772         //carry from position 7
773         t0 = (c7 + CARRY_ADD) &gt;&gt; 28;
774         c7 -= (t0 &lt;&lt; 28);
775         c8 += t0;
776         //carry from position 8
777         t0 = (c8 + CARRY_ADD) &gt;&gt; 28;
778         c8 -= (t0 &lt;&lt; 28);
779         c9 += t0;
780         //carry from position 9
781         t0 = (c9 + CARRY_ADD) &gt;&gt; 28;
782         c9 -= (t0 &lt;&lt; 28);
783         c10 += t0;
784         //carry from position 10
785         t0 = (c10 + CARRY_ADD) &gt;&gt; 28;
786         c10 -= (t0 &lt;&lt; 28);
787         c11 += t0;
788         //carry from position 11
789         t0 = (c11 + CARRY_ADD) &gt;&gt; 28;
790         c11 -= (t0 &lt;&lt; 28);
791         c12 += t0;
792         //carry from position 12
793         t0 = (c12 + CARRY_ADD) &gt;&gt; 28;
794         c12 -= (t0 &lt;&lt; 28);
795         c13 += t0;
796 
797         r[0] = c0;
798         r[1] = c1;
799         r[2] = c2;
800         r[3] = c3;
801         r[4] = c4;
802         r[5] = c5;
803         r[6] = c6;
804         r[7] = c7;
805         r[8] = c8;
806         r[9] = c9;
807         r[10] = c10;
808         r[11] = c11;
809         r[12] = c12;
810         r[13] = c13;
811     }
812     @Override
813     protected void mult(long[] a, long[] b, long[] r) {
814         long c0 = (a[0] * b[0]);
815         long c1 = (a[0] * b[1]) + (a[1] * b[0]);
816         long c2 = (a[0] * b[2]) + (a[1] * b[1]) + (a[2] * b[0]);
817         long c3 = (a[0] * b[3]) + (a[1] * b[2]) + (a[2] * b[1]) + (a[3] * b[0]);
818         long c4 = (a[0] * b[4]) + (a[1] * b[3]) + (a[2] * b[2]) + (a[3] * b[1]) + (a[4] * b[0]);
819         long c5 = (a[0] * b[5]) + (a[1] * b[4]) + (a[2] * b[3]) + (a[3] * b[2]) + (a[4] * b[1]) + (a[5] * b[0]);
820         long c6 = (a[0] * b[6]) + (a[1] * b[5]) + (a[2] * b[4]) + (a[3] * b[3]) + (a[4] * b[2]) + (a[5] * b[1]) + (a[6] * b[0]);
821         long c7 = (a[0] * b[7]) + (a[1] * b[6]) + (a[2] * b[5]) + (a[3] * b[4]) + (a[4] * b[3]) + (a[5] * b[2]) + (a[6] * b[1]) + (a[7] * b[0]);
822         long c8 = (a[0] * b[8]) + (a[1] * b[7]) + (a[2] * b[6]) + (a[3] * b[5]) + (a[4] * b[4]) + (a[5] * b[3]) + (a[6] * b[2]) + (a[7] * b[1]) + (a[8] * b[0]);
823         long c9 = (a[0] * b[9]) + (a[1] * b[8]) + (a[2] * b[7]) + (a[3] * b[6]) + (a[4] * b[5]) + (a[5] * b[4]) + (a[6] * b[3]) + (a[7] * b[2]) + (a[8] * b[1]) + (a[9] * b[0]);
824         long c10 = (a[0] * b[10]) + (a[1] * b[9]) + (a[2] * b[8]) + (a[3] * b[7]) + (a[4] * b[6]) + (a[5] * b[5]) + (a[6] * b[4]) + (a[7] * b[3]) + (a[8] * b[2]) + (a[9] * b[1]) + (a[10] * b[0]);
825         long c11 = (a[0] * b[11]) + (a[1] * b[10]) + (a[2] * b[9]) + (a[3] * b[8]) + (a[4] * b[7]) + (a[5] * b[6]) + (a[6] * b[5]) + (a[7] * b[4]) + (a[8] * b[3]) + (a[9] * b[2]) + (a[10] * b[1]) + (a[11] * b[0]);
826         long c12 = (a[0] * b[12]) + (a[1] * b[11]) + (a[2] * b[10]) + (a[3] * b[9]) + (a[4] * b[8]) + (a[5] * b[7]) + (a[6] * b[6]) + (a[7] * b[5]) + (a[8] * b[4]) + (a[9] * b[3]) + (a[10] * b[2]) + (a[11] * b[1]) + (a[12] * b[0]);
827         long c13 = (a[0] * b[13]) + (a[1] * b[12]) + (a[2] * b[11]) + (a[3] * b[10]) + (a[4] * b[9]) + (a[5] * b[8]) + (a[6] * b[7]) + (a[7] * b[6]) + (a[8] * b[5]) + (a[9] * b[4]) + (a[10] * b[3]) + (a[11] * b[2]) + (a[12] * b[1]) + (a[13] * b[0]);
828         long c14 = (a[1] * b[13]) + (a[2] * b[12]) + (a[3] * b[11]) + (a[4] * b[10]) + (a[5] * b[9]) + (a[6] * b[8]) + (a[7] * b[7]) + (a[8] * b[6]) + (a[9] * b[5]) + (a[10] * b[4]) + (a[11] * b[3]) + (a[12] * b[2]) + (a[13] * b[1]);
829         long c15 = (a[2] * b[13]) + (a[3] * b[12]) + (a[4] * b[11]) + (a[5] * b[10]) + (a[6] * b[9]) + (a[7] * b[8]) + (a[8] * b[7]) + (a[9] * b[6]) + (a[10] * b[5]) + (a[11] * b[4]) + (a[12] * b[3]) + (a[13] * b[2]);
830         long c16 = (a[3] * b[13]) + (a[4] * b[12]) + (a[5] * b[11]) + (a[6] * b[10]) + (a[7] * b[9]) + (a[8] * b[8]) + (a[9] * b[7]) + (a[10] * b[6]) + (a[11] * b[5]) + (a[12] * b[4]) + (a[13] * b[3]);
831         long c17 = (a[4] * b[13]) + (a[5] * b[12]) + (a[6] * b[11]) + (a[7] * b[10]) + (a[8] * b[9]) + (a[9] * b[8]) + (a[10] * b[7]) + (a[11] * b[6]) + (a[12] * b[5]) + (a[13] * b[4]);
832         long c18 = (a[5] * b[13]) + (a[6] * b[12]) + (a[7] * b[11]) + (a[8] * b[10]) + (a[9] * b[9]) + (a[10] * b[8]) + (a[11] * b[7]) + (a[12] * b[6]) + (a[13] * b[5]);
833         long c19 = (a[6] * b[13]) + (a[7] * b[12]) + (a[8] * b[11]) + (a[9] * b[10]) + (a[10] * b[9]) + (a[11] * b[8]) + (a[12] * b[7]) + (a[13] * b[6]);
834         long c20 = (a[7] * b[13]) + (a[8] * b[12]) + (a[9] * b[11]) + (a[10] * b[10]) + (a[11] * b[9]) + (a[12] * b[8]) + (a[13] * b[7]);
835         long c21 = (a[8] * b[13]) + (a[9] * b[12]) + (a[10] * b[11]) + (a[11] * b[10]) + (a[12] * b[9]) + (a[13] * b[8]);
836         long c22 = (a[9] * b[13]) + (a[10] * b[12]) + (a[11] * b[11]) + (a[12] * b[10]) + (a[13] * b[9]);
837         long c23 = (a[10] * b[13]) + (a[11] * b[12]) + (a[12] * b[11]) + (a[13] * b[10]);
838         long c24 = (a[11] * b[13]) + (a[12] * b[12]) + (a[13] * b[11]);
839         long c25 = (a[12] * b[13]) + (a[13] * b[12]);
840         long c26 = (a[13] * b[13]);
841 
842         carryReduce(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20, c21, c22, c23, c24, c25, c26);
843     }
844     @Override
845     protected void reduce(long[] a) {
846         carryReduce(a, a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13]);
847     }
848     @Override
849     protected void square(long[] a, long[] r) {
850         long c0 = (a[0] * a[0]);
851         long c1 = 2 * ((a[0] * a[1]));
852         long c2 = 2 * ((a[0] * a[2])) + (a[1] * a[1]);
853         long c3 = 2 * ((a[0] * a[3]) + (a[1] * a[2]));
854         long c4 = 2 * ((a[0] * a[4]) + (a[1] * a[3])) + (a[2] * a[2]);
855         long c5 = 2 * ((a[0] * a[5]) + (a[1] * a[4]) + (a[2] * a[3]));
856         long c6 = 2 * ((a[0] * a[6]) + (a[1] * a[5]) + (a[2] * a[4])) + (a[3] * a[3]);
857         long c7 = 2 * ((a[0] * a[7]) + (a[1] * a[6]) + (a[2] * a[5]) + (a[3] * a[4]));
858         long c8 = 2 * ((a[0] * a[8]) + (a[1] * a[7]) + (a[2] * a[6]) + (a[3] * a[5])) + (a[4] * a[4]);
859         long c9 = 2 * ((a[0] * a[9]) + (a[1] * a[8]) + (a[2] * a[7]) + (a[3] * a[6]) + (a[4] * a[5]));
860         long c10 = 2 * ((a[0] * a[10]) + (a[1] * a[9]) + (a[2] * a[8]) + (a[3] * a[7]) + (a[4] * a[6])) + (a[5] * a[5]);
861         long c11 = 2 * ((a[0] * a[11]) + (a[1] * a[10]) + (a[2] * a[9]) + (a[3] * a[8]) + (a[4] * a[7]) + (a[5] * a[6]));
862         long c12 = 2 * ((a[0] * a[12]) + (a[1] * a[11]) + (a[2] * a[10]) + (a[3] * a[9]) + (a[4] * a[8]) + (a[5] * a[7])) + (a[6] * a[6]);
863         long c13 = 2 * ((a[0] * a[13]) + (a[1] * a[12]) + (a[2] * a[11]) + (a[3] * a[10]) + (a[4] * a[9]) + (a[5] * a[8]) + (a[6] * a[7]));
864         long c14 = 2 * ((a[1] * a[13]) + (a[2] * a[12]) + (a[3] * a[11]) + (a[4] * a[10]) + (a[5] * a[9]) + (a[6] * a[8])) + (a[7] * a[7]);
865         long c15 = 2 * ((a[2] * a[13]) + (a[3] * a[12]) + (a[4] * a[11]) + (a[5] * a[10]) + (a[6] * a[9]) + (a[7] * a[8]));
866         long c16 = 2 * ((a[3] * a[13]) + (a[4] * a[12]) + (a[5] * a[11]) + (a[6] * a[10]) + (a[7] * a[9])) + (a[8] * a[8]);
867         long c17 = 2 * ((a[4] * a[13]) + (a[5] * a[12]) + (a[6] * a[11]) + (a[7] * a[10]) + (a[8] * a[9]));
868         long c18 = 2 * ((a[5] * a[13]) + (a[6] * a[12]) + (a[7] * a[11]) + (a[8] * a[10])) + (a[9] * a[9]);
869         long c19 = 2 * ((a[6] * a[13]) + (a[7] * a[12]) + (a[8] * a[11]) + (a[9] * a[10]));
870         long c20 = 2 * ((a[7] * a[13]) + (a[8] * a[12]) + (a[9] * a[11])) + (a[10] * a[10]);
871         long c21 = 2 * ((a[8] * a[13]) + (a[9] * a[12]) + (a[10] * a[11]));
872         long c22 = 2 * ((a[9] * a[13]) + (a[10] * a[12])) + (a[11] * a[11]);
873         long c23 = 2 * ((a[10] * a[13]) + (a[11] * a[12]));
874         long c24 = 2 * ((a[11] * a[13])) + (a[12] * a[12]);
875         long c25 = 2 * ((a[12] * a[13]));
876         long c26 = (a[13] * a[13]);
877 
878         carryReduce(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20, c21, c22, c23, c24, c25, c26);
879     }
880 }
881 
    </pre>
  </body>
</html>