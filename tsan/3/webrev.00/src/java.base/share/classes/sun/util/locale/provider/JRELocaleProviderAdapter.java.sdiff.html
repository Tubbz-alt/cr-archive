<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/sun/util/locale/provider/JRELocaleProviderAdapter.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="HostLocaleProviderAdapter.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="LocaleResources.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/util/locale/provider/JRELocaleProviderAdapter.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
474                     }
475                 }
476                 return tags.toString();
477             });
478 
479             if (nonBaseTags != null) {
480                 supportedLocaleString += &quot; &quot; + nonBaseTags;
481             }
482         } catch (PrivilegedActionException pae) {
483             throw new InternalError(pae.getCause());
484         }
485 
486         return supportedLocaleString;
487     }
488 
489     /**
490      * Lazy load available locales.
491      */
492     private static class AvailableJRELocales {
493         private static final Locale[] localeList = createAvailableLocales();
<span class="line-modified">494         private AvailableJRELocales() {</span>
<span class="line-removed">495         }</span>
496     }
497 
498     private static Locale[] createAvailableLocales() {
499         /*
500          * Gets the locale string list from LocaleDataMetaInfo classes and then
501          * contructs the Locale array and a set of language tags based on the
502          * locale string returned above.
503          */
504         String supportedLocaleString = createSupportedLocaleString(&quot;AvailableLocales&quot;);
505 
506         if (supportedLocaleString.isEmpty()) {
507             throw new InternalError(&quot;No available locales for JRE&quot;);
508         }
509 
510         StringTokenizer localeStringTokenizer = new StringTokenizer(supportedLocaleString);
511 
512         int length = localeStringTokenizer.countTokens();
513         Locale[] locales = new Locale[length + 1];
514         locales[0] = Locale.ROOT;
515         for (int i = 1; i &lt;= length; i++) {
</pre>
<hr />
<pre>
518                 case &quot;ja-JP-JP&quot;:
519                     locales[i] = JRELocaleConstants.JA_JP_JP;
520                     break;
521                 case &quot;no-NO-NY&quot;:
522                     locales[i] = JRELocaleConstants.NO_NO_NY;
523                     break;
524                 case &quot;th-TH-TH&quot;:
525                     locales[i] = JRELocaleConstants.TH_TH_TH;
526                     break;
527                 default:
528                     locales[i] = Locale.forLanguageTag(currentToken);
529             }
530         }
531         return locales;
532     }
533 
534     @Override
535     public boolean isSupportedProviderLocale(Locale locale,  Set&lt;String&gt; langtags) {
536         if (Locale.ROOT.equals(locale)) {
537             return true;
<span class="line-modified">538 }</span>
539 
540         locale = locale.stripExtensions();
541         if (langtags.contains(locale.toLanguageTag())) {
542             return true;
543         }
544 
545         String oldname = locale.toString().replace(&#39;_&#39;, &#39;-&#39;);
546         return langtags.contains(oldname) ||
547                    &quot;ja-JP-JP&quot;.equals(oldname) ||
548                    &quot;th-TH-TH&quot;.equals(oldname) ||
549                    &quot;no-NO-NY&quot;.equals(oldname);
550     }
551 }
</pre>
</td>
<td>
<hr />
<pre>
474                     }
475                 }
476                 return tags.toString();
477             });
478 
479             if (nonBaseTags != null) {
480                 supportedLocaleString += &quot; &quot; + nonBaseTags;
481             }
482         } catch (PrivilegedActionException pae) {
483             throw new InternalError(pae.getCause());
484         }
485 
486         return supportedLocaleString;
487     }
488 
489     /**
490      * Lazy load available locales.
491      */
492     private static class AvailableJRELocales {
493         private static final Locale[] localeList = createAvailableLocales();
<span class="line-modified">494         private AvailableJRELocales() {}</span>

495     }
496 
497     private static Locale[] createAvailableLocales() {
498         /*
499          * Gets the locale string list from LocaleDataMetaInfo classes and then
500          * contructs the Locale array and a set of language tags based on the
501          * locale string returned above.
502          */
503         String supportedLocaleString = createSupportedLocaleString(&quot;AvailableLocales&quot;);
504 
505         if (supportedLocaleString.isEmpty()) {
506             throw new InternalError(&quot;No available locales for JRE&quot;);
507         }
508 
509         StringTokenizer localeStringTokenizer = new StringTokenizer(supportedLocaleString);
510 
511         int length = localeStringTokenizer.countTokens();
512         Locale[] locales = new Locale[length + 1];
513         locales[0] = Locale.ROOT;
514         for (int i = 1; i &lt;= length; i++) {
</pre>
<hr />
<pre>
517                 case &quot;ja-JP-JP&quot;:
518                     locales[i] = JRELocaleConstants.JA_JP_JP;
519                     break;
520                 case &quot;no-NO-NY&quot;:
521                     locales[i] = JRELocaleConstants.NO_NO_NY;
522                     break;
523                 case &quot;th-TH-TH&quot;:
524                     locales[i] = JRELocaleConstants.TH_TH_TH;
525                     break;
526                 default:
527                     locales[i] = Locale.forLanguageTag(currentToken);
528             }
529         }
530         return locales;
531     }
532 
533     @Override
534     public boolean isSupportedProviderLocale(Locale locale,  Set&lt;String&gt; langtags) {
535         if (Locale.ROOT.equals(locale)) {
536             return true;
<span class="line-modified">537         }</span>
538 
539         locale = locale.stripExtensions();
540         if (langtags.contains(locale.toLanguageTag())) {
541             return true;
542         }
543 
544         String oldname = locale.toString().replace(&#39;_&#39;, &#39;-&#39;);
545         return langtags.contains(oldname) ||
546                    &quot;ja-JP-JP&quot;.equals(oldname) ||
547                    &quot;th-TH-TH&quot;.equals(oldname) ||
548                    &quot;no-NO-NY&quot;.equals(oldname);
549     }
550 }
</pre>
</td>
</tr>
</table>
<center><a href="HostLocaleProviderAdapter.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="LocaleResources.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>