<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/sun/security/provider/SunEntries.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="Sun.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="VerificationProvider.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/provider/SunEntries.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 1996, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 60  *   Aliases for DSA include the OID strings &quot;OID.1.3.14.3.2.12&quot;
 61  *   and &quot;OID.1.2.840.10040.4.1&quot;.
 62  *
 63  * - MD5 is the message digest scheme described in RFC 1321.
 64  *   There are no aliases for MD5.
 65  *
 66  * - X.509 is the certificate factory type for X.509 certificates
 67  *   and CRLs. Aliases for X.509 are X509.
 68  *
 69  * - PKIX is the certification path validation algorithm described
 70  *   in RFC 5280. The ValidationAlgorithm attribute notes the
 71  *   specification that this provider implements.
 72  *
 73  * - JavaPolicy is the default file-based Policy type.
 74  *
 75  * - JavaLoginConfig is the default file-based LoginModule Configuration type.
 76  */
 77 
 78 public final class SunEntries {
 79 



 80     // create an aliases List from the specified aliases
 81     public static List&lt;String&gt; createAliases(String ... aliases) {
 82         return Arrays.asList(aliases);
 83     }
 84 
 85     // create an aliases List from the specified oid followed by other aliases
 86     public static List&lt;String&gt; createAliasesWithOid(String ... oids) {
 87         String[] result = Arrays.copyOf(oids, oids.length + 1);
 88         result[result.length - 1] = &quot;OID.&quot; + oids[0];
 89         return Arrays.asList(result);
 90     }
 91 
<span class="line-removed"> 92     // extend LinkedHashSet to preserve the ordering (needed by SecureRandom?)</span>
 93     SunEntries(Provider p) {
 94         services = new LinkedHashSet&lt;&gt;(50, 0.9f);
 95 
 96         // start populating content using the specified provider
 97 
 98         // common attribute map
 99         HashMap&lt;String, String&gt; attrs = new HashMap&lt;&gt;(3);
100 
101         /*
<span class="line-modified">102          * SecureRandom</span>
<span class="line-removed">103          *</span>
<span class="line-removed">104          * Register these first to speed up &quot;new SecureRandom()&quot;,</span>
<span class="line-removed">105          * which iterates through the list of algorithms</span>
106          */
<span class="line-removed">107         // register the native PRNG, if available</span>
<span class="line-removed">108         // if user selected /dev/urandom, we put it before SHA1PRNG,</span>
<span class="line-removed">109         // otherwise after it</span>
<span class="line-removed">110         boolean nativeAvailable = NativePRNG.isAvailable();</span>
<span class="line-removed">111         boolean useNativePRNG = seedSource.equals(URL_DEV_URANDOM) ||</span>
<span class="line-removed">112             seedSource.equals(URL_DEV_RANDOM);</span>
<span class="line-removed">113 </span>
114         attrs.put(&quot;ThreadSafe&quot;, &quot;true&quot;);
<span class="line-modified">115         if (nativeAvailable &amp;&amp; useNativePRNG) {</span>
116             add(p, &quot;SecureRandom&quot;, &quot;NativePRNG&quot;,
<span class="line-modified">117                &quot;sun.security.provider.NativePRNG&quot;, null, attrs);</span>
<span class="line-modified">118         }</span>
<span class="line-removed">119         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="line-removed">120         add(p, &quot;SecureRandom&quot;, &quot;DRBG&quot;, &quot;sun.security.provider.DRBG&quot;, null, attrs);</span>
<span class="line-removed">121         add(p, &quot;SecureRandom&quot;, &quot;SHA1PRNG&quot;,</span>
<span class="line-removed">122             &quot;sun.security.provider.SecureRandom&quot;, null, attrs);</span>
<span class="line-removed">123         attrs.remove(&quot;ImplementedIn&quot;);</span>
<span class="line-removed">124         if (nativeAvailable &amp;&amp; !useNativePRNG) {</span>
<span class="line-removed">125             add(p, &quot;SecureRandom&quot;, &quot;NativePRNG&quot;, &quot;sun.security.provider.NativePRNG&quot;,</span>
<span class="line-removed">126                null, attrs);</span>
127         }
<span class="line-removed">128 </span>
129         if (NativePRNG.Blocking.isAvailable()) {
130             add(p, &quot;SecureRandom&quot;, &quot;NativePRNGBlocking&quot;,
<span class="line-modified">131                 &quot;sun.security.provider.NativePRNG$Blocking&quot;, null, attrs);</span>
132         }
133         if (NativePRNG.NonBlocking.isAvailable()) {
134             add(p, &quot;SecureRandom&quot;, &quot;NativePRNGNonBlocking&quot;,
<span class="line-modified">135                 &quot;sun.security.provider.NativePRNG$NonBlocking&quot;, null, attrs);</span>
136         }





137 
138         /*
139          * Signature engines
140          */
141         attrs.clear();
142         String dsaKeyClasses = &quot;java.security.interfaces.DSAPublicKey&quot; +
143                 &quot;|java.security.interfaces.DSAPrivateKey&quot;;
144         attrs.put(&quot;SupportedKeyClasses&quot;, dsaKeyClasses);
145         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);
146 
147         attrs.put(&quot;KeySize&quot;, &quot;1024&quot;); // for NONE and SHA1 DSA signatures
148 
149         add(p, &quot;Signature&quot;, &quot;SHA1withDSA&quot;,
150                 &quot;sun.security.provider.DSA$SHA1withDSA&quot;,
<span class="line-modified">151                 createAliasesWithOid(&quot;1.2.840.10040.4.3&quot;, &quot;DSA&quot;, &quot;DSS&quot;, &quot;SHA/DSA&quot;,</span>
<span class="line-modified">152                     &quot;SHA-1/DSA&quot;, &quot;SHA1/DSA&quot;, &quot;SHAwithDSA&quot;, &quot;DSAWithSHA1&quot;,</span>
<span class="line-modified">153                     &quot;1.3.14.3.2.13&quot;, &quot;1.3.14.3.2.27&quot;), attrs);</span>
154         add(p, &quot;Signature&quot;, &quot;NONEwithDSA&quot;, &quot;sun.security.provider.DSA$RawDSA&quot;,
155                 createAliases(&quot;RawDSA&quot;), attrs);
156 
157         attrs.put(&quot;KeySize&quot;, &quot;2048&quot;); // for SHA224 and SHA256 DSA signatures
158 
159         add(p, &quot;Signature&quot;, &quot;SHA224withDSA&quot;,
160                 &quot;sun.security.provider.DSA$SHA224withDSA&quot;,
161                 createAliasesWithOid(&quot;2.16.840.1.101.3.4.3.1&quot;), attrs);
162         add(p, &quot;Signature&quot;, &quot;SHA256withDSA&quot;,
163                 &quot;sun.security.provider.DSA$SHA256withDSA&quot;,
164                 createAliasesWithOid(&quot;2.16.840.1.101.3.4.3.2&quot;), attrs);
165 
166         attrs.remove(&quot;KeySize&quot;);
167 
168         add(p, &quot;Signature&quot;, &quot;SHA1withDSAinP1363Format&quot;,
169                 &quot;sun.security.provider.DSA$SHA1withDSAinP1363Format&quot;,
170                 null, null);
171         add(p, &quot;Signature&quot;, &quot;NONEwithDSAinP1363Format&quot;,
172                 &quot;sun.security.provider.DSA$RawDSAinP1363Format&quot;,
173                 null, null);
</pre>
<hr />
<pre>
178                 &quot;sun.security.provider.DSA$SHA256withDSAinP1363Format&quot;,
179                 null, null);
180 
181         /*
182          *  Key Pair Generator engines
183          */
184         attrs.clear();
185         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);
186         attrs.put(&quot;KeySize&quot;, &quot;2048&quot;); // for DSA KPG and APG only
187 
188         String dsaOid = &quot;1.2.840.10040.4.1&quot;;
189         List&lt;String&gt; dsaAliases = createAliasesWithOid(dsaOid, &quot;1.3.14.3.2.12&quot;);
190         String dsaKPGImplClass = &quot;sun.security.provider.DSAKeyPairGenerator$&quot;;
191         dsaKPGImplClass += (useLegacyDSA? &quot;Legacy&quot; : &quot;Current&quot;);
192         add(p, &quot;KeyPairGenerator&quot;, &quot;DSA&quot;, dsaKPGImplClass, dsaAliases, attrs);
193 
194         /*
195          * Algorithm Parameter Generator engines
196          */
197         add(p, &quot;AlgorithmParameterGenerator&quot;, &quot;DSA&quot;,
<span class="line-modified">198             &quot;sun.security.provider.DSAParameterGenerator&quot;, dsaAliases, attrs);</span>

199         attrs.remove(&quot;KeySize&quot;);
200 
201         /*
202          * Algorithm Parameter engines
203          */
204         add(p, &quot;AlgorithmParameters&quot;, &quot;DSA&quot;,
205                 &quot;sun.security.provider.DSAParameters&quot;, dsaAliases, attrs);
206 
207         /*
208          * Key factories
209          */
210         add(p, &quot;KeyFactory&quot;, &quot;DSA&quot;, &quot;sun.security.provider.DSAKeyFactory&quot;,
211                 dsaAliases, attrs);
212 
213         /*
214          * Digest engines
215          */
216         add(p, &quot;MessageDigest&quot;, &quot;MD2&quot;, &quot;sun.security.provider.MD2&quot;, null, attrs);
217         add(p, &quot;MessageDigest&quot;, &quot;MD5&quot;, &quot;sun.security.provider.MD5&quot;, null, attrs);
218         add(p, &quot;MessageDigest&quot;, &quot;SHA&quot;, &quot;sun.security.provider.SHA&quot;,
</pre>
<hr />
<pre>
290         /*
291          * CertPathBuilder and CertPathValidator
292          */
293         attrs.clear();
294         attrs.put(&quot;ValidationAlgorithm&quot;, &quot;RFC5280&quot;);
295         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);
296 
297         add(p, &quot;CertPathBuilder&quot;, &quot;PKIX&quot;,
298                 &quot;sun.security.provider.certpath.SunCertPathBuilder&quot;,
299                 null, attrs);
300         add(p, &quot;CertPathValidator&quot;, &quot;PKIX&quot;,
301                 &quot;sun.security.provider.certpath.PKIXCertPathValidator&quot;,
302                 null, attrs);
303     }
304 
305     Iterator&lt;Provider.Service&gt; iterator() {
306         return services.iterator();
307     }
308 
309     private void add(Provider p, String type, String algo, String cn,
<span class="line-modified">310              List&lt;String&gt; aliases, HashMap&lt;String, String&gt; attrs) {</span>
<span class="line-modified">311          services.add(new Provider.Service(p, type, algo, cn, aliases, attrs));</span>
312     }
313 
314     private LinkedHashSet&lt;Provider.Service&gt; services;
315 
316     // name of the *System* property, takes precedence over PROP_RNDSOURCE
317     private static final String PROP_EGD = &quot;java.security.egd&quot;;
318     // name of the *Security* property
319     private static final String PROP_RNDSOURCE = &quot;securerandom.source&quot;;
320 
321     private static final boolean useLegacyDSA =
322         Boolean.parseBoolean(GetPropertyAction.privilegedGetProperty
323             (&quot;jdk.security.legacyDSAKeyPairGenerator&quot;));
324 
325     static final String URL_DEV_RANDOM = &quot;file:/dev/random&quot;;
326     static final String URL_DEV_URANDOM = &quot;file:/dev/urandom&quot;;
327 
328     private static final String seedSource;
329 
330     static {
331         seedSource = AccessController.doPrivileged(
332                 new PrivilegedAction&lt;String&gt;() {
333 
334             @Override
335             public String run() {
336                 String egdSource = System.getProperty(PROP_EGD, &quot;&quot;);
337                 if (egdSource.length() != 0) {
338                     return egdSource;
339                 }
340                 egdSource = Security.getProperty(PROP_RNDSOURCE);
341                 if (egdSource == null) {
342                     return &quot;&quot;;
343                 }
344                 return egdSource;
345             }
346         });





347     }
348 
349     static String getSeedSource() {
350         return seedSource;
351     }
352 
353     /*
354      * Use a URI to access this File. Previous code used a URL
355      * which is less strict on syntax. If we encounter a
356      * URISyntaxException we make best efforts for backwards
357      * compatibility. e.g. space character in deviceName string.
358      *
359      * Method called within PrivilegedExceptionAction block.
360      *
361      * Moved from SeedGenerator to avoid initialization problems with
362      * signed providers.
363      */
364     static File getDeviceFile(URL device) throws IOException {
365         try {
366             URI deviceURI = device.toURI();
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 1996, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 60  *   Aliases for DSA include the OID strings &quot;OID.1.3.14.3.2.12&quot;
 61  *   and &quot;OID.1.2.840.10040.4.1&quot;.
 62  *
 63  * - MD5 is the message digest scheme described in RFC 1321.
 64  *   There are no aliases for MD5.
 65  *
 66  * - X.509 is the certificate factory type for X.509 certificates
 67  *   and CRLs. Aliases for X.509 are X509.
 68  *
 69  * - PKIX is the certification path validation algorithm described
 70  *   in RFC 5280. The ValidationAlgorithm attribute notes the
 71  *   specification that this provider implements.
 72  *
 73  * - JavaPolicy is the default file-based Policy type.
 74  *
 75  * - JavaLoginConfig is the default file-based LoginModule Configuration type.
 76  */
 77 
 78 public final class SunEntries {
 79 
<span class="line-added"> 80     // the default algo used by SecureRandom class for new SecureRandom() calls</span>
<span class="line-added"> 81     public static final String DEF_SECURE_RANDOM_ALGO;</span>
<span class="line-added"> 82 </span>
 83     // create an aliases List from the specified aliases
 84     public static List&lt;String&gt; createAliases(String ... aliases) {
 85         return Arrays.asList(aliases);
 86     }
 87 
 88     // create an aliases List from the specified oid followed by other aliases
 89     public static List&lt;String&gt; createAliasesWithOid(String ... oids) {
 90         String[] result = Arrays.copyOf(oids, oids.length + 1);
 91         result[result.length - 1] = &quot;OID.&quot; + oids[0];
 92         return Arrays.asList(result);
 93     }
 94 

 95     SunEntries(Provider p) {
 96         services = new LinkedHashSet&lt;&gt;(50, 0.9f);
 97 
 98         // start populating content using the specified provider
 99 
100         // common attribute map
101         HashMap&lt;String, String&gt; attrs = new HashMap&lt;&gt;(3);
102 
103         /*
<span class="line-modified">104          * SecureRandom engines</span>



105          */







106         attrs.put(&quot;ThreadSafe&quot;, &quot;true&quot;);
<span class="line-modified">107         if (NativePRNG.isAvailable()) {</span>
108             add(p, &quot;SecureRandom&quot;, &quot;NativePRNG&quot;,
<span class="line-modified">109                     &quot;sun.security.provider.NativePRNG&quot;,</span>
<span class="line-modified">110                     null, attrs);</span>








111         }

112         if (NativePRNG.Blocking.isAvailable()) {
113             add(p, &quot;SecureRandom&quot;, &quot;NativePRNGBlocking&quot;,
<span class="line-modified">114                     &quot;sun.security.provider.NativePRNG$Blocking&quot;, null, attrs);</span>
115         }
116         if (NativePRNG.NonBlocking.isAvailable()) {
117             add(p, &quot;SecureRandom&quot;, &quot;NativePRNGNonBlocking&quot;,
<span class="line-modified">118                     &quot;sun.security.provider.NativePRNG$NonBlocking&quot;, null, attrs);</span>
119         }
<span class="line-added">120         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);</span>
<span class="line-added">121         add(p, &quot;SecureRandom&quot;, &quot;DRBG&quot;, &quot;sun.security.provider.DRBG&quot;,</span>
<span class="line-added">122                null, attrs);</span>
<span class="line-added">123         add(p, &quot;SecureRandom&quot;, &quot;SHA1PRNG&quot;,</span>
<span class="line-added">124                 &quot;sun.security.provider.SecureRandom&quot;, null, attrs);</span>
125 
126         /*
127          * Signature engines
128          */
129         attrs.clear();
130         String dsaKeyClasses = &quot;java.security.interfaces.DSAPublicKey&quot; +
131                 &quot;|java.security.interfaces.DSAPrivateKey&quot;;
132         attrs.put(&quot;SupportedKeyClasses&quot;, dsaKeyClasses);
133         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);
134 
135         attrs.put(&quot;KeySize&quot;, &quot;1024&quot;); // for NONE and SHA1 DSA signatures
136 
137         add(p, &quot;Signature&quot;, &quot;SHA1withDSA&quot;,
138                 &quot;sun.security.provider.DSA$SHA1withDSA&quot;,
<span class="line-modified">139                 createAliasesWithOid(&quot;1.2.840.10040.4.3&quot;, &quot;DSA&quot;, &quot;DSS&quot;,</span>
<span class="line-modified">140                     &quot;SHA/DSA&quot;, &quot;SHA-1/DSA&quot;, &quot;SHA1/DSA&quot;, &quot;SHAwithDSA&quot;,</span>
<span class="line-modified">141                     &quot;DSAWithSHA1&quot;, &quot;1.3.14.3.2.13&quot;, &quot;1.3.14.3.2.27&quot;), attrs);</span>
142         add(p, &quot;Signature&quot;, &quot;NONEwithDSA&quot;, &quot;sun.security.provider.DSA$RawDSA&quot;,
143                 createAliases(&quot;RawDSA&quot;), attrs);
144 
145         attrs.put(&quot;KeySize&quot;, &quot;2048&quot;); // for SHA224 and SHA256 DSA signatures
146 
147         add(p, &quot;Signature&quot;, &quot;SHA224withDSA&quot;,
148                 &quot;sun.security.provider.DSA$SHA224withDSA&quot;,
149                 createAliasesWithOid(&quot;2.16.840.1.101.3.4.3.1&quot;), attrs);
150         add(p, &quot;Signature&quot;, &quot;SHA256withDSA&quot;,
151                 &quot;sun.security.provider.DSA$SHA256withDSA&quot;,
152                 createAliasesWithOid(&quot;2.16.840.1.101.3.4.3.2&quot;), attrs);
153 
154         attrs.remove(&quot;KeySize&quot;);
155 
156         add(p, &quot;Signature&quot;, &quot;SHA1withDSAinP1363Format&quot;,
157                 &quot;sun.security.provider.DSA$SHA1withDSAinP1363Format&quot;,
158                 null, null);
159         add(p, &quot;Signature&quot;, &quot;NONEwithDSAinP1363Format&quot;,
160                 &quot;sun.security.provider.DSA$RawDSAinP1363Format&quot;,
161                 null, null);
</pre>
<hr />
<pre>
166                 &quot;sun.security.provider.DSA$SHA256withDSAinP1363Format&quot;,
167                 null, null);
168 
169         /*
170          *  Key Pair Generator engines
171          */
172         attrs.clear();
173         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);
174         attrs.put(&quot;KeySize&quot;, &quot;2048&quot;); // for DSA KPG and APG only
175 
176         String dsaOid = &quot;1.2.840.10040.4.1&quot;;
177         List&lt;String&gt; dsaAliases = createAliasesWithOid(dsaOid, &quot;1.3.14.3.2.12&quot;);
178         String dsaKPGImplClass = &quot;sun.security.provider.DSAKeyPairGenerator$&quot;;
179         dsaKPGImplClass += (useLegacyDSA? &quot;Legacy&quot; : &quot;Current&quot;);
180         add(p, &quot;KeyPairGenerator&quot;, &quot;DSA&quot;, dsaKPGImplClass, dsaAliases, attrs);
181 
182         /*
183          * Algorithm Parameter Generator engines
184          */
185         add(p, &quot;AlgorithmParameterGenerator&quot;, &quot;DSA&quot;,
<span class="line-modified">186                 &quot;sun.security.provider.DSAParameterGenerator&quot;, dsaAliases,</span>
<span class="line-added">187                 attrs);</span>
188         attrs.remove(&quot;KeySize&quot;);
189 
190         /*
191          * Algorithm Parameter engines
192          */
193         add(p, &quot;AlgorithmParameters&quot;, &quot;DSA&quot;,
194                 &quot;sun.security.provider.DSAParameters&quot;, dsaAliases, attrs);
195 
196         /*
197          * Key factories
198          */
199         add(p, &quot;KeyFactory&quot;, &quot;DSA&quot;, &quot;sun.security.provider.DSAKeyFactory&quot;,
200                 dsaAliases, attrs);
201 
202         /*
203          * Digest engines
204          */
205         add(p, &quot;MessageDigest&quot;, &quot;MD2&quot;, &quot;sun.security.provider.MD2&quot;, null, attrs);
206         add(p, &quot;MessageDigest&quot;, &quot;MD5&quot;, &quot;sun.security.provider.MD5&quot;, null, attrs);
207         add(p, &quot;MessageDigest&quot;, &quot;SHA&quot;, &quot;sun.security.provider.SHA&quot;,
</pre>
<hr />
<pre>
279         /*
280          * CertPathBuilder and CertPathValidator
281          */
282         attrs.clear();
283         attrs.put(&quot;ValidationAlgorithm&quot;, &quot;RFC5280&quot;);
284         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);
285 
286         add(p, &quot;CertPathBuilder&quot;, &quot;PKIX&quot;,
287                 &quot;sun.security.provider.certpath.SunCertPathBuilder&quot;,
288                 null, attrs);
289         add(p, &quot;CertPathValidator&quot;, &quot;PKIX&quot;,
290                 &quot;sun.security.provider.certpath.PKIXCertPathValidator&quot;,
291                 null, attrs);
292     }
293 
294     Iterator&lt;Provider.Service&gt; iterator() {
295         return services.iterator();
296     }
297 
298     private void add(Provider p, String type, String algo, String cn,
<span class="line-modified">299             List&lt;String&gt; aliases, HashMap&lt;String, String&gt; attrs) {</span>
<span class="line-modified">300         services.add(new Provider.Service(p, type, algo, cn, aliases, attrs));</span>
301     }
302 
303     private LinkedHashSet&lt;Provider.Service&gt; services;
304 
305     // name of the *System* property, takes precedence over PROP_RNDSOURCE
306     private static final String PROP_EGD = &quot;java.security.egd&quot;;
307     // name of the *Security* property
308     private static final String PROP_RNDSOURCE = &quot;securerandom.source&quot;;
309 
310     private static final boolean useLegacyDSA =
311         Boolean.parseBoolean(GetPropertyAction.privilegedGetProperty
312             (&quot;jdk.security.legacyDSAKeyPairGenerator&quot;));
313 
314     static final String URL_DEV_RANDOM = &quot;file:/dev/random&quot;;
315     static final String URL_DEV_URANDOM = &quot;file:/dev/urandom&quot;;
316 
317     private static final String seedSource;
318 
319     static {
320         seedSource = AccessController.doPrivileged(
321                 new PrivilegedAction&lt;String&gt;() {
322 
323             @Override
324             public String run() {
325                 String egdSource = System.getProperty(PROP_EGD, &quot;&quot;);
326                 if (egdSource.length() != 0) {
327                     return egdSource;
328                 }
329                 egdSource = Security.getProperty(PROP_RNDSOURCE);
330                 if (egdSource == null) {
331                     return &quot;&quot;;
332                 }
333                 return egdSource;
334             }
335         });
<span class="line-added">336 </span>
<span class="line-added">337         DEF_SECURE_RANDOM_ALGO  = (NativePRNG.isAvailable() &amp;&amp;</span>
<span class="line-added">338             (seedSource.equals(URL_DEV_URANDOM) ||</span>
<span class="line-added">339              seedSource.equals(URL_DEV_RANDOM)) ?</span>
<span class="line-added">340             &quot;NativePRNG&quot; : &quot;DRBG&quot;);</span>
341     }
342 
343     static String getSeedSource() {
344         return seedSource;
345     }
346 
347     /*
348      * Use a URI to access this File. Previous code used a URL
349      * which is less strict on syntax. If we encounter a
350      * URISyntaxException we make best efforts for backwards
351      * compatibility. e.g. space character in deviceName string.
352      *
353      * Method called within PrivilegedExceptionAction block.
354      *
355      * Moved from SeedGenerator to avoid initialization problems with
356      * signed providers.
357      */
358     static File getDeviceFile(URL device) throws IOException {
359         try {
360             URI deviceURI = device.toURI();
</pre>
</td>
</tr>
</table>
<center><a href="Sun.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="VerificationProvider.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>