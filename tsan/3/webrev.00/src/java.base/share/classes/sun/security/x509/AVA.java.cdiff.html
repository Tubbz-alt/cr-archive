<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/sun/security/x509/AVA.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../validator/ValidatorException.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="AccessDescription.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/x509/AVA.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 1996, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 1996, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 31,10 ***</span>
<span class="line-new-header">--- 31,12 ---</span>
  import java.io.Reader;
  import java.security.AccessController;
  import java.text.Normalizer;
  import java.util.*;
  
<span class="line-added">+ import static java.nio.charset.StandardCharsets.UTF_8;</span>
<span class="line-added">+ </span>
  import sun.security.action.GetBooleanAction;
  import sun.security.util.*;
  import sun.security.pkcs.PKCS9Attribute;
  
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 523,18 ***</span>
              }
          }
          return null;
      }
  
<span class="line-modified">!     private static String getEmbeddedHexString(List&lt;Byte&gt; hexList)</span>
<span class="line-removed">-                                                 throws IOException {</span>
          int n = hexList.size();
          byte[] hexBytes = new byte[n];
          for (int i = 0; i &lt; n; i++) {
<span class="line-modified">!                 hexBytes[i] = hexList.get(i).byteValue();</span>
          }
<span class="line-modified">!         return new String(hexBytes, &quot;UTF8&quot;);</span>
      }
  
      private static boolean isTerminator(int ch, int format) {
          switch (ch) {
          case -1:
<span class="line-new-header">--- 525,17 ---</span>
              }
          }
          return null;
      }
  
<span class="line-modified">!     private static String getEmbeddedHexString(List&lt;Byte&gt; hexList) {</span>
          int n = hexList.size();
          byte[] hexBytes = new byte[n];
          for (int i = 0; i &lt; n; i++) {
<span class="line-modified">!             hexBytes[i] = hexList.get(i).byteValue();</span>
          }
<span class="line-modified">!         return new String(hexBytes, UTF_8);</span>
      }
  
      private static boolean isTerminator(int ch, int format) {
          switch (ch) {
          case -1:
</pre>
<hr />
<pre>
<span class="line-old-header">*** 596,11 ***</span>
          // Individual attribute value assertions are SEQUENCE of two values.
          // That&#39;d be a &quot;struct&quot; outside of ASN.1.
          if (derval.tag != DerValue.tag_Sequence) {
              throw new IOException(&quot;AVA not a sequence&quot;);
          }
<span class="line-modified">!         oid = X500Name.intern(derval.data.getOID());</span>
          value = derval.data.getDerValue();
  
          if (derval.data.available() != 0) {
              throw new IOException(&quot;AVA, extra bytes = &quot;
                  + derval.data.available());
<span class="line-new-header">--- 597,11 ---</span>
          // Individual attribute value assertions are SEQUENCE of two values.
          // That&#39;d be a &quot;struct&quot; outside of ASN.1.
          if (derval.tag != DerValue.tag_Sequence) {
              throw new IOException(&quot;AVA not a sequence&quot;);
          }
<span class="line-modified">!         oid = derval.data.getOID();</span>
          value = derval.data.getDerValue();
  
          if (derval.data.available() != 0) {
              throw new IOException(&quot;AVA, extra bytes = &quot;
                  + derval.data.available());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 750,11 ***</span>
               * NOTE: this implementation only emits DirectoryStrings of the
               * types returned by isDerString().
               */
              String valStr = null;
              try {
<span class="line-modified">!                 valStr = new String(value.getDataBytes(), &quot;UTF8&quot;);</span>
              } catch (IOException ie) {
                  throw new IllegalArgumentException(&quot;DER Value conversion&quot;);
              }
  
              /*
<span class="line-new-header">--- 751,11 ---</span>
               * NOTE: this implementation only emits DirectoryStrings of the
               * types returned by isDerString().
               */
              String valStr = null;
              try {
<span class="line-modified">!                 valStr = new String(value.getDataBytes(), UTF_8);</span>
              } catch (IOException ie) {
                  throw new IllegalArgumentException(&quot;DER Value conversion&quot;);
              }
  
              /*
</pre>
<hr />
<pre>
<span class="line-old-header">*** 802,17 ***</span>
  
                  } else if (debug != null &amp;&amp; Debug.isOn(&quot;ava&quot;)) {
  
                      // embed non-printable/non-escaped char
                      // as escaped hex pairs for debugging
<span class="line-modified">!                     byte[] valueBytes = null;</span>
<span class="line-removed">-                     try {</span>
<span class="line-removed">-                         valueBytes = Character.toString(c).getBytes(&quot;UTF8&quot;);</span>
<span class="line-removed">-                     } catch (IOException ie) {</span>
<span class="line-removed">-                         throw new IllegalArgumentException</span>
<span class="line-removed">-                                         (&quot;DER Value conversion&quot;);</span>
<span class="line-removed">-                     }</span>
                      for (int j = 0; j &lt; valueBytes.length; j++) {
                          sbuffer.append(&#39;\\&#39;);
                          char hexChar = Character.forDigit
                                  (0xF &amp; (valueBytes[j] &gt;&gt;&gt; 4), 16);
                          sbuffer.append(Character.toUpperCase(hexChar));
<span class="line-new-header">--- 803,11 ---</span>
  
                  } else if (debug != null &amp;&amp; Debug.isOn(&quot;ava&quot;)) {
  
                      // embed non-printable/non-escaped char
                      // as escaped hex pairs for debugging
<span class="line-modified">!                     byte[] valueBytes = Character.toString(c).getBytes(UTF_8);</span>
                      for (int j = 0; j &lt; valueBytes.length; j++) {
                          sbuffer.append(&#39;\\&#39;);
                          char hexChar = Character.forDigit
                                  (0xF &amp; (valueBytes[j] &gt;&gt;&gt; 4), 16);
                          sbuffer.append(Character.toUpperCase(hexChar));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 903,11 ***</span>
               * NOTE: this implementation only emits DirectoryStrings of the
               * types returned by isDerString().
               */
              String valStr = null;
              try {
<span class="line-modified">!                 valStr = new String(value.getDataBytes(), &quot;UTF8&quot;);</span>
              } catch (IOException ie) {
                  throw new IllegalArgumentException(&quot;DER Value conversion&quot;);
              }
  
              /*
<span class="line-new-header">--- 898,11 ---</span>
               * NOTE: this implementation only emits DirectoryStrings of the
               * types returned by isDerString().
               */
              String valStr = null;
              try {
<span class="line-modified">!                 valStr = new String(value.getDataBytes(), UTF_8);</span>
              } catch (IOException ie) {
                  throw new IllegalArgumentException(&quot;DER Value conversion&quot;);
              }
  
              /*
</pre>
<hr />
<pre>
<span class="line-old-header">*** 964,17 ***</span>
                      // embed non-printable/non-escaped char
                      // as escaped hex pairs for debugging
  
                      previousWhite = false;
  
<span class="line-modified">!                     byte[] valueBytes = null;</span>
<span class="line-removed">-                     try {</span>
<span class="line-removed">-                         valueBytes = Character.toString(c).getBytes(&quot;UTF8&quot;);</span>
<span class="line-removed">-                     } catch (IOException ie) {</span>
<span class="line-removed">-                         throw new IllegalArgumentException</span>
<span class="line-removed">-                                         (&quot;DER Value conversion&quot;);</span>
<span class="line-removed">-                     }</span>
                      for (int j = 0; j &lt; valueBytes.length; j++) {
                          sbuffer.append(&#39;\\&#39;);
                          sbuffer.append(Character.forDigit
                                          (0xF &amp; (valueBytes[j] &gt;&gt;&gt; 4), 16));
                          sbuffer.append(Character.forDigit
<span class="line-new-header">--- 959,11 ---</span>
                      // embed non-printable/non-escaped char
                      // as escaped hex pairs for debugging
  
                      previousWhite = false;
  
<span class="line-modified">!                     byte[] valueBytes = Character.toString(c).getBytes(UTF_8);</span>
                      for (int j = 0; j &lt; valueBytes.length; j++) {
                          sbuffer.append(&#39;\\&#39;);
                          sbuffer.append(Character.forDigit
                                          (0xF &amp; (valueBytes[j] &gt;&gt;&gt; 4), 16));
                          sbuffer.append(Character.forDigit
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1114,11 ***</span>
  
                          previousWhite = false;
  
                          // embed escaped hex pairs
                          byte[] valueBytes =
<span class="line-modified">!                                 Character.toString(c).getBytes(&quot;UTF8&quot;);</span>
                          for (int j = 0; j &lt; valueBytes.length; j++) {
                              sbuffer.append(&#39;\\&#39;);
                              char hexChar = Character.forDigit
                                          (0xF &amp; (valueBytes[j] &gt;&gt;&gt; 4), 16);
                              sbuffer.append(Character.toUpperCase(hexChar));
<span class="line-new-header">--- 1103,11 ---</span>
  
                          previousWhite = false;
  
                          // embed escaped hex pairs
                          byte[] valueBytes =
<span class="line-modified">!                                 Character.toString(c).getBytes(UTF_8);</span>
                          for (int j = 0; j &lt; valueBytes.length; j++) {
                              sbuffer.append(&#39;\\&#39;);
                              char hexChar = Character.forDigit
                                          (0xF &amp; (valueBytes[j] &gt;&gt;&gt; 4), 16);
                              sbuffer.append(Character.toUpperCase(hexChar));
</pre>
<center><a href="../validator/ValidatorException.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="AccessDescription.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>