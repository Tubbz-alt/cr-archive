<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/sun/security/util/DerOutputStream.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="DerInputStream.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="DerValue.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/util/DerOutputStream.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 1996, 2010, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 1996, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 26,18 ***</span>
  package sun.security.util;
  
  import java.io.ByteArrayOutputStream;
  import java.io.OutputStream;
  import java.io.IOException;
  import java.text.SimpleDateFormat;
  import java.util.Date;
  import java.util.TimeZone;
  import java.util.Comparator;
  import java.util.Arrays;
<span class="line-removed">- import java.math.BigInteger;</span>
  import java.util.Locale;
  
  
  /**
   * Output stream marshaling DER-encoded data.  This is eventually provided
   * in the form of a byte array; there is no advance limit on the size of
   * that byte array.
<span class="line-new-header">--- 26,20 ---</span>
  package sun.security.util;
  
  import java.io.ByteArrayOutputStream;
  import java.io.OutputStream;
  import java.io.IOException;
<span class="line-added">+ import java.math.BigInteger;</span>
<span class="line-added">+ import java.nio.charset.Charset;</span>
  import java.text.SimpleDateFormat;
  import java.util.Date;
  import java.util.TimeZone;
  import java.util.Comparator;
  import java.util.Arrays;
  import java.util.Locale;
  
<span class="line-added">+ import static java.nio.charset.StandardCharsets.*;</span>
  
  /**
   * Output stream marshaling DER-encoded data.  This is eventually provided
   * in the form of a byte array; there is no advance limit on the size of
   * that byte array.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 396,64 ***</span>
  
      /**
       * Marshals a string as a DER encoded UTF8String.
       */
      public void putUTF8String(String s) throws IOException {
<span class="line-modified">!         writeString(s, DerValue.tag_UTF8String, &quot;UTF8&quot;);</span>
      }
  
      /**
       * Marshals a string as a DER encoded PrintableString.
       */
      public void putPrintableString(String s) throws IOException {
<span class="line-modified">!         writeString(s, DerValue.tag_PrintableString, &quot;ASCII&quot;);</span>
      }
  
      /**
       * Marshals a string as a DER encoded T61String.
       */
      public void putT61String(String s) throws IOException {
          /*
           * Works for characters that are defined in both ASCII and
           * T61.
           */
<span class="line-modified">!         writeString(s, DerValue.tag_T61String, &quot;ISO-8859-1&quot;);</span>
      }
  
      /**
       * Marshals a string as a DER encoded IA5String.
       */
      public void putIA5String(String s) throws IOException {
<span class="line-modified">!         writeString(s, DerValue.tag_IA5String, &quot;ASCII&quot;);</span>
      }
  
      /**
       * Marshals a string as a DER encoded BMPString.
       */
      public void putBMPString(String s) throws IOException {
<span class="line-modified">!         writeString(s, DerValue.tag_BMPString, &quot;UnicodeBigUnmarked&quot;);</span>
      }
  
      /**
       * Marshals a string as a DER encoded GeneralString.
       */
      public void putGeneralString(String s) throws IOException {
<span class="line-modified">!         writeString(s, DerValue.tag_GeneralString, &quot;ASCII&quot;);</span>
      }
  
      /**
       * Private helper routine for writing DER encoded string values.
       * @param s the string to write
       * @param stringTag one of the DER string tags that indicate which
       * encoding should be used to write the string out.
       * @param enc the name of the encoder that should be used corresponding
       * to the above tag.
       */
<span class="line-modified">!     private void writeString(String s, byte stringTag, String enc)</span>
          throws IOException {
  
<span class="line-modified">!         byte[] data = s.getBytes(enc);</span>
          write(stringTag);
          putLength(data.length);
          write(data);
      }
  
<span class="line-new-header">--- 398,64 ---</span>
  
      /**
       * Marshals a string as a DER encoded UTF8String.
       */
      public void putUTF8String(String s) throws IOException {
<span class="line-modified">!         writeString(s, DerValue.tag_UTF8String, UTF_8);</span>
      }
  
      /**
       * Marshals a string as a DER encoded PrintableString.
       */
      public void putPrintableString(String s) throws IOException {
<span class="line-modified">!         writeString(s, DerValue.tag_PrintableString, US_ASCII);</span>
      }
  
      /**
       * Marshals a string as a DER encoded T61String.
       */
      public void putT61String(String s) throws IOException {
          /*
           * Works for characters that are defined in both ASCII and
           * T61.
           */
<span class="line-modified">!         writeString(s, DerValue.tag_T61String, ISO_8859_1);</span>
      }
  
      /**
       * Marshals a string as a DER encoded IA5String.
       */
      public void putIA5String(String s) throws IOException {
<span class="line-modified">!         writeString(s, DerValue.tag_IA5String, US_ASCII);</span>
      }
  
      /**
       * Marshals a string as a DER encoded BMPString.
       */
      public void putBMPString(String s) throws IOException {
<span class="line-modified">!         writeString(s, DerValue.tag_BMPString, UTF_16BE);</span>
      }
  
      /**
       * Marshals a string as a DER encoded GeneralString.
       */
      public void putGeneralString(String s) throws IOException {
<span class="line-modified">!         writeString(s, DerValue.tag_GeneralString, US_ASCII);</span>
      }
  
      /**
       * Private helper routine for writing DER encoded string values.
       * @param s the string to write
       * @param stringTag one of the DER string tags that indicate which
       * encoding should be used to write the string out.
       * @param enc the name of the encoder that should be used corresponding
       * to the above tag.
       */
<span class="line-modified">!     private void writeString(String s, byte stringTag, Charset charset)</span>
          throws IOException {
  
<span class="line-modified">!         byte[] data = s.getBytes(charset);</span>
          write(stringTag);
          putLength(data.length);
          write(data);
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 500,11 ***</span>
              pattern = &quot;yyyyMMddHHmmss&#39;Z&#39;&quot;;
          }
  
          SimpleDateFormat sdf = new SimpleDateFormat(pattern, Locale.US);
          sdf.setTimeZone(tz);
<span class="line-modified">!         byte[] time = (sdf.format(d)).getBytes(&quot;ISO-8859-1&quot;);</span>
  
          /*
           * Write the formatted date.
           */
  
<span class="line-new-header">--- 502,11 ---</span>
              pattern = &quot;yyyyMMddHHmmss&#39;Z&#39;&quot;;
          }
  
          SimpleDateFormat sdf = new SimpleDateFormat(pattern, Locale.US);
          sdf.setTimeZone(tz);
<span class="line-modified">!         byte[] time = (sdf.format(d)).getBytes(ISO_8859_1);</span>
  
          /*
           * Write the formatted date.
           */
  
</pre>
<center><a href="DerInputStream.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="DerValue.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>