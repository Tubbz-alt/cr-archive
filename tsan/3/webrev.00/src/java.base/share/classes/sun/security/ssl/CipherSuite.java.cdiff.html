<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/sun/security/ssl/CipherSuite.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="CertificateVerify.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ClientHello.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/ssl/CipherSuite.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2002, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2002, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 33,12 ***</span>
  import java.util.List;
  import static sun.security.ssl.CipherSuite.HashAlg.*;
  import static sun.security.ssl.CipherSuite.KeyExchange.*;
  import static sun.security.ssl.CipherSuite.MacAlg.*;
  import static sun.security.ssl.SSLCipher.*;
<span class="line-modified">! import sun.security.ssl.SupportedGroupsExtension.NamedGroupType;</span>
<span class="line-modified">! import static sun.security.ssl.SupportedGroupsExtension.NamedGroupType.*;</span>
  
  /**
   * Enum for SSL/(D)TLS cipher suites.
   *
   * Please refer to the &quot;TLS Cipher Suite Registry&quot; section for more details
<span class="line-new-header">--- 33,12 ---</span>
  import java.util.List;
  import static sun.security.ssl.CipherSuite.HashAlg.*;
  import static sun.security.ssl.CipherSuite.KeyExchange.*;
  import static sun.security.ssl.CipherSuite.MacAlg.*;
  import static sun.security.ssl.SSLCipher.*;
<span class="line-modified">! import sun.security.ssl.NamedGroup.NamedGroupSpec;</span>
<span class="line-modified">! import static sun.security.ssl.NamedGroup.NamedGroupSpec.*;</span>
  
  /**
   * Enum for SSL/(D)TLS cipher suites.
   *
   * Please refer to the &quot;TLS Cipher Suite Registry&quot; section for more details
</pre>
<hr />
<pre>
<span class="line-old-header">*** 54,24 ***</span>
      //
      // They are listed in preference order, most preferred first, using
      // the following criteria:
      // 1. Prefer Suite B compliant cipher suites, see RFC6460 (To be
      //    changed later, see below).
<span class="line-modified">!     // 2. Prefer the stronger bulk cipher, in the order of AES_256(GCM),</span>
      //    AES_128(GCM), AES_256, AES_128, 3DES-EDE.
<span class="line-modified">!     // 3. Prefer the stronger MAC algorithm, in the order of SHA384,</span>
      //    SHA256, SHA, MD5.
<span class="line-modified">!     // 4. Prefer the better performance of key exchange and digital</span>
      //    signature algorithm, in the order of ECDHE-ECDSA, ECDHE-RSA,
<span class="line-modified">!     //    RSA, ECDH-ECDSA, ECDH-RSA, DHE-RSA, DHE-DSS.</span>
  
<span class="line-modified">!     TLS_AES_128_GCM_SHA256(</span>
<span class="line-removed">-             0x1301, true, &quot;TLS_AES_128_GCM_SHA256&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_OF_13, B_AES_128_GCM_IV, H_SHA256),</span>
      TLS_AES_256_GCM_SHA384(
              0x1302, true, &quot;TLS_AES_256_GCM_SHA384&quot;,
              ProtocolVersion.PROTOCOLS_OF_13, B_AES_256_GCM_IV, H_SHA384),
      TLS_CHACHA20_POLY1305_SHA256(
              0x1303, true, &quot;TLS_CHACHA20_POLY1305_SHA256&quot;,
              ProtocolVersion.PROTOCOLS_OF_13, B_CC20_P1305, H_SHA256),
  
      // Suite B compliant cipher suites, see RFC 6460.
<span class="line-new-header">--- 54,26 ---</span>
      //
      // They are listed in preference order, most preferred first, using
      // the following criteria:
      // 1. Prefer Suite B compliant cipher suites, see RFC6460 (To be
      //    changed later, see below).
<span class="line-modified">!     // 2. Prefer forward secrecy cipher suites.</span>
<span class="line-added">+     // 3. Prefer the stronger bulk cipher, in the order of AES_256(GCM),</span>
      //    AES_128(GCM), AES_256, AES_128, 3DES-EDE.
<span class="line-modified">!     // 4. Prefer the stronger MAC algorithm, in the order of SHA384,</span>
      //    SHA256, SHA, MD5.
<span class="line-modified">!     // 5. Prefer the better performance of key exchange and digital</span>
      //    signature algorithm, in the order of ECDHE-ECDSA, ECDHE-RSA,
<span class="line-modified">!     //    DHE-RSA, DHE-DSS, ECDH-ECDSA, ECDH-RSA, RSA.</span>
  
<span class="line-modified">!     // TLS 1.3 cipher suites.</span>
      TLS_AES_256_GCM_SHA384(
              0x1302, true, &quot;TLS_AES_256_GCM_SHA384&quot;,
              ProtocolVersion.PROTOCOLS_OF_13, B_AES_256_GCM_IV, H_SHA384),
<span class="line-added">+     TLS_AES_128_GCM_SHA256(</span>
<span class="line-added">+             0x1301, true, &quot;TLS_AES_128_GCM_SHA256&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_OF_13, B_AES_128_GCM_IV, H_SHA256),</span>
      TLS_CHACHA20_POLY1305_SHA256(
              0x1303, true, &quot;TLS_CHACHA20_POLY1305_SHA256&quot;,
              ProtocolVersion.PROTOCOLS_OF_13, B_CC20_P1305, H_SHA256),
  
      // Suite B compliant cipher suites, see RFC 6460.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 95,31 ***</span>
      TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256(
              0xCCA9, true, &quot;TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_ECDHE_ECDSA, B_CC20_P1305, M_NULL, H_SHA256),
  
<span class="line-modified">!     // AES_256(GCM)</span>
      TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384(
              0xC030, true, &quot;TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_ECDHE_RSA, B_AES_256_GCM, M_NULL, H_SHA384),
      TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256(
              0xCCA8, true, &quot;TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_ECDHE_RSA, B_CC20_P1305, M_NULL, H_SHA256),
<span class="line-modified">!     TLS_RSA_WITH_AES_256_GCM_SHA384(</span>
<span class="line-modified">!             0x009D, true, &quot;TLS_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,</span>
<span class="line-modified">!             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-modified">!             K_RSA, B_AES_256_GCM, M_NULL, H_SHA384),</span>
<span class="line-removed">-     TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384(</span>
<span class="line-removed">-             0xC02E, true, &quot;TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed">-             K_ECDH_ECDSA, B_AES_256_GCM, M_NULL, H_SHA384),</span>
<span class="line-removed">-     TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384(</span>
<span class="line-removed">-             0xC032, true, &quot;TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified">!             K_ECDH_RSA, B_AES_256_GCM, M_NULL, H_SHA384),</span>
      TLS_DHE_RSA_WITH_AES_256_GCM_SHA384(
              0x009F, true, &quot;TLS_DHE_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_DHE_RSA, B_AES_256_GCM, M_NULL, H_SHA384),
      TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256(
<span class="line-new-header">--- 97,31 ---</span>
      TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256(
              0xCCA9, true, &quot;TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_ECDHE_ECDSA, B_CC20_P1305, M_NULL, H_SHA256),
  
<span class="line-modified">!     //</span>
<span class="line-added">+     // Forward secrecy cipher suites.</span>
<span class="line-added">+     //</span>
<span class="line-added">+ </span>
<span class="line-added">+     // AES_256(GCM) - ECDHE</span>
      TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384(
              0xC030, true, &quot;TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_ECDHE_RSA, B_AES_256_GCM, M_NULL, H_SHA384),
      TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256(
              0xCCA8, true, &quot;TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_ECDHE_RSA, B_CC20_P1305, M_NULL, H_SHA256),
<span class="line-modified">! </span>
<span class="line-modified">!     // AES_128(GCM) - ECDHE</span>
<span class="line-modified">!     TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-modified">!             0xC02F, true, &quot;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified">!             K_ECDHE_RSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
<span class="line-added">+ </span>
<span class="line-added">+     // AES_256(GCM) - DHE</span>
      TLS_DHE_RSA_WITH_AES_256_GCM_SHA384(
              0x009F, true, &quot;TLS_DHE_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_DHE_RSA, B_AES_256_GCM, M_NULL, H_SHA384),
      TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256(
</pre>
<hr />
<pre>
<span class="line-old-header">*** 129,176 ***</span>
      TLS_DHE_DSS_WITH_AES_256_GCM_SHA384(
              0x00A3, true, &quot;TLS_DHE_DSS_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_DHE_DSS, B_AES_256_GCM, M_NULL, H_SHA384),
  
<span class="line-modified">!     // AES_128(GCM)</span>
<span class="line-removed">-     TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-removed">-             0xC02F, true, &quot;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed">-             K_ECDHE_RSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
<span class="line-removed">-     TLS_RSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-removed">-             0x009C, true, &quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed">-             K_RSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
<span class="line-removed">-     TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-removed">-             0xC02D, true, &quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed">-             K_ECDH_ECDSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
<span class="line-removed">-     TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-removed">-             0xC031, true, &quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed">-             K_ECDH_RSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
      TLS_DHE_RSA_WITH_AES_128_GCM_SHA256(
              0x009E, true, &quot;TLS_DHE_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_DHE_RSA, B_AES_128_GCM, M_NULL, H_SHA256),
      TLS_DHE_DSS_WITH_AES_128_GCM_SHA256(
              0x00A2, true, &quot;TLS_DHE_DSS_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_DHE_DSS, B_AES_128_GCM, M_NULL, H_SHA256),
  
<span class="line-modified">!     // AES_256(CBC)</span>
      TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384(
              0xC024, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_ECDHE_ECDSA, B_AES_256, M_SHA384, H_SHA384),
      TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384(
              0xC028, true, &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_ECDHE_RSA, B_AES_256, M_SHA384, H_SHA384),
<span class="line-modified">!     TLS_RSA_WITH_AES_256_CBC_SHA256(</span>
<span class="line-modified">!             0x003D, true, &quot;TLS_RSA_WITH_AES_256_CBC_SHA256&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified">!             K_RSA, B_AES_256, M_SHA256, H_SHA256),</span>
      TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384(
              0xC026, true, &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_ECDH_ECDSA, B_AES_256, M_SHA384, H_SHA384),
      TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384(
              0xC02A, true, &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_ECDH_RSA, B_AES_256, M_SHA384, H_SHA384),
<span class="line-modified">!     TLS_DHE_RSA_WITH_AES_256_CBC_SHA256(</span>
<span class="line-modified">!             0x006B, true, &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA256&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified">!             K_DHE_RSA, B_AES_256, M_SHA256, H_SHA256),</span>
<span class="line-modified">!     TLS_DHE_DSS_WITH_AES_256_CBC_SHA256(</span>
<span class="line-modified">!             0x006A, true, &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA256&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified">!             K_DHE_DSS, B_AES_256, M_SHA256, H_SHA256),</span>
  
      TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA(
              0xC00A, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_ECDHE_ECDSA, B_AES_256, M_SHA, H_SHA256),
      TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA(
              0xC014, true, &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_ECDHE_RSA, B_AES_256, M_SHA, H_SHA256),
<span class="line-modified">!     TLS_RSA_WITH_AES_256_CBC_SHA(</span>
<span class="line-modified">!             0x0035, true, &quot;TLS_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,</span>
<span class="line-modified">!             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-modified">!             K_RSA, B_AES_256, M_SHA, H_SHA256),</span>
<span class="line-removed">-     TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA(</span>
<span class="line-removed">-             0xC005, true, &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified">!             K_ECDH_ECDSA, B_AES_256, M_SHA, H_SHA256),</span>
<span class="line-modified">!     TLS_ECDH_RSA_WITH_AES_256_CBC_SHA(</span>
<span class="line-modified">!             0xC00F, true, &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified">!             K_ECDH_RSA, B_AES_256, M_SHA, H_SHA256),</span>
      TLS_DHE_RSA_WITH_AES_256_CBC_SHA(
              0x0039, true, &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_DHE_RSA, B_AES_256, M_SHA, H_SHA256),
      TLS_DHE_DSS_WITH_AES_256_CBC_SHA(
              0x0038, true, &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_DHE_DSS, B_AES_256, M_SHA, H_SHA256),
  
<span class="line-modified">!     // AES_128(CBC)</span>
<span class="line-modified">!     TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-modified">!             0xC023, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed">-             K_ECDHE_ECDSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-removed">-     TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-removed">-             0xC027, true, &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed">-             K_ECDHE_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-removed">-     TLS_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-removed">-             0x003C, true, &quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed">-             K_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-removed">-     TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-removed">-             0xC025, true, &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed">-             K_ECDH_ECDSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-removed">-     TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-removed">-             0xC029, true, &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed">-             K_ECDH_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-removed">-     TLS_DHE_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-removed">-             0x0067, true, &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed">-             K_DHE_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-removed">-     TLS_DHE_DSS_WITH_AES_128_CBC_SHA256(</span>
<span class="line-removed">-             0x0040, true, &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-removed">-             K_DHE_DSS, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-removed">- </span>
<span class="line-removed">-     TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-removed">-             0xC009, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified">!             K_ECDHE_ECDSA, B_AES_128, M_SHA, H_SHA256),</span>
<span class="line-modified">!     TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified">!             0xC013, true, &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified">!             K_ECDHE_RSA, B_AES_128, M_SHA, H_SHA256),</span>
<span class="line-modified">!     TLS_RSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified">!             0x002F, true, &quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified">!             K_RSA, B_AES_128, M_SHA, H_SHA256),</span>
      TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA(
              0xC004, true, &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_ECDH_ECDSA, B_AES_128, M_SHA, H_SHA256),
      TLS_ECDH_RSA_WITH_AES_128_CBC_SHA(
              0xC00E, true, &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_ECDH_RSA, B_AES_128, M_SHA, H_SHA256),
<span class="line-modified">!     TLS_DHE_RSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified">!             0x0033, true, &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified">!             K_DHE_RSA, B_AES_128, M_SHA, H_SHA256),</span>
<span class="line-modified">!     TLS_DHE_DSS_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified">!             0x0032, true, &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified">!             K_DHE_DSS, B_AES_128, M_SHA, H_SHA256),</span>
  
<span class="line-modified">!     // 3DES_EDE</span>
      TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA(
              0xC008, true, &quot;TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_ECDHE_ECDSA, B_3DES, M_SHA, H_SHA256),
      TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA(
              0xC012, true, &quot;TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_ECDHE_RSA, B_3DES, M_SHA, H_SHA256),
<span class="line-removed">-     SSL_RSA_WITH_3DES_EDE_CBC_SHA(</span>
<span class="line-removed">-             0x000A, true, &quot;SSL_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-removed">-                           &quot;TLS_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-removed">-             K_RSA, B_3DES, M_SHA, H_SHA256),</span>
<span class="line-removed">-     TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA(</span>
<span class="line-removed">-             0xC003, true, &quot;TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-removed">-             K_ECDH_ECDSA, B_3DES, M_SHA, H_SHA256),</span>
<span class="line-removed">-     TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA(</span>
<span class="line-removed">-             0xC00D, true, &quot;TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,</span>
<span class="line-removed">-             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-removed">-             K_ECDH_RSA, B_3DES, M_SHA, H_SHA256),</span>
      SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA(
              0x0016, true, &quot;SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;,
                            &quot;TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_DHE_RSA, B_3DES, M_SHA, H_SHA256),
<span class="line-new-header">--- 131,217 ---</span>
      TLS_DHE_DSS_WITH_AES_256_GCM_SHA384(
              0x00A3, true, &quot;TLS_DHE_DSS_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_DHE_DSS, B_AES_256_GCM, M_NULL, H_SHA384),
  
<span class="line-modified">!     // AES_128(GCM) - DHE</span>
      TLS_DHE_RSA_WITH_AES_128_GCM_SHA256(
              0x009E, true, &quot;TLS_DHE_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_DHE_RSA, B_AES_128_GCM, M_NULL, H_SHA256),
      TLS_DHE_DSS_WITH_AES_128_GCM_SHA256(
              0x00A2, true, &quot;TLS_DHE_DSS_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_DHE_DSS, B_AES_128_GCM, M_NULL, H_SHA256),
  
<span class="line-modified">!     // AES_256(CBC) - ECDHE</span>
      TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384(
              0xC024, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_ECDHE_ECDSA, B_AES_256, M_SHA384, H_SHA384),
      TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384(
              0xC028, true, &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_ECDHE_RSA, B_AES_256, M_SHA384, H_SHA384),
<span class="line-modified">! </span>
<span class="line-modified">!     // AES_128(CBC) - ECDHE</span>
<span class="line-added">+     TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-added">+             0xC023, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified">!             K_ECDHE_ECDSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-added">+     TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-added">+             0xC027, true, &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added">+             K_ECDHE_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-added">+ </span>
<span class="line-added">+     // AES_256(CBC) - DHE</span>
<span class="line-added">+     TLS_DHE_RSA_WITH_AES_256_CBC_SHA256(</span>
<span class="line-added">+             0x006B, true, &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added">+             K_DHE_RSA, B_AES_256, M_SHA256, H_SHA256),</span>
<span class="line-added">+     TLS_DHE_DSS_WITH_AES_256_CBC_SHA256(</span>
<span class="line-added">+             0x006A, true, &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added">+             K_DHE_DSS, B_AES_256, M_SHA256, H_SHA256),</span>
<span class="line-added">+ </span>
<span class="line-added">+     // AES_128(CBC) - DHE</span>
<span class="line-added">+     TLS_DHE_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-added">+             0x0067, true, &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added">+             K_DHE_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-added">+     TLS_DHE_DSS_WITH_AES_128_CBC_SHA256(</span>
<span class="line-added">+             0x0040, true, &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added">+             K_DHE_DSS, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-added">+ </span>
<span class="line-added">+     //</span>
<span class="line-added">+     // not forward secret cipher suites.</span>
<span class="line-added">+     //</span>
<span class="line-added">+ </span>
<span class="line-added">+     // AES_256(GCM)</span>
<span class="line-added">+     TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384(</span>
<span class="line-added">+             0xC02E, true, &quot;TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added">+             K_ECDH_ECDSA, B_AES_256_GCM, M_NULL, H_SHA384),</span>
<span class="line-added">+     TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384(</span>
<span class="line-added">+             0xC032, true, &quot;TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added">+             K_ECDH_RSA, B_AES_256_GCM, M_NULL, H_SHA384),</span>
<span class="line-added">+ </span>
<span class="line-added">+     // AES_128(GCM)</span>
<span class="line-added">+     TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-added">+             0xC02D, true, &quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added">+             K_ECDH_ECDSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
<span class="line-added">+     TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-added">+             0xC031, true, &quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added">+             K_ECDH_RSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
<span class="line-added">+ </span>
<span class="line-added">+     // AES_256(CBC)</span>
      TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384(
              0xC026, true, &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_ECDH_ECDSA, B_AES_256, M_SHA384, H_SHA384),
      TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384(
              0xC02A, true, &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_ECDH_RSA, B_AES_256, M_SHA384, H_SHA384),
<span class="line-modified">! </span>
<span class="line-modified">!     // AES_128(CBC)</span>
<span class="line-added">+     TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-added">+             0xC025, true, &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified">!             K_ECDH_ECDSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-modified">!     TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-modified">!             0xC029, true, &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_OF_12,
<span class="line-modified">!             K_ECDH_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-added">+ </span>
<span class="line-added">+     //</span>
<span class="line-added">+     // Legacy, used for compatibility</span>
<span class="line-added">+     //</span>
  
<span class="line-added">+     // AES_256(CBC) - ECDHE - Using SHA</span>
      TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA(
              0xC00A, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_ECDHE_ECDSA, B_AES_256, M_SHA, H_SHA256),
      TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA(
              0xC014, true, &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_ECDHE_RSA, B_AES_256, M_SHA, H_SHA256),
<span class="line-modified">! </span>
<span class="line-modified">!     // AES_128(CBC) - ECDHE - using SHA</span>
<span class="line-modified">!     TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified">!             0xC009, true, &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified">!             K_ECDHE_ECDSA, B_AES_128, M_SHA, H_SHA256),</span>
<span class="line-modified">!     TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified">!             0xC013, true, &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified">!             K_ECDHE_RSA, B_AES_128, M_SHA, H_SHA256),</span>
<span class="line-added">+ </span>
<span class="line-added">+     // AES_256(CBC) - DHE - Using SHA</span>
      TLS_DHE_RSA_WITH_AES_256_CBC_SHA(
              0x0039, true, &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_DHE_RSA, B_AES_256, M_SHA, H_SHA256),
      TLS_DHE_DSS_WITH_AES_256_CBC_SHA(
              0x0038, true, &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_DHE_DSS, B_AES_256, M_SHA, H_SHA256),
  
<span class="line-modified">!     // AES_128(CBC) - DHE - using SHA</span>
<span class="line-modified">!     TLS_DHE_RSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified">!             0x0033, true, &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified">!             K_DHE_RSA, B_AES_128, M_SHA, H_SHA256),</span>
<span class="line-modified">!     TLS_DHE_DSS_WITH_AES_128_CBC_SHA(</span>
<span class="line-modified">!             0x0032, true, &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified">!             K_DHE_DSS, B_AES_128, M_SHA, H_SHA256),</span>
<span class="line-modified">! </span>
<span class="line-modified">!     // AES_256(CBC) - using SHA, not forward secrecy</span>
<span class="line-added">+     TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA(</span>
<span class="line-added">+             0xC005, true, &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified">!             K_ECDH_ECDSA, B_AES_256, M_SHA, H_SHA256),</span>
<span class="line-added">+     TLS_ECDH_RSA_WITH_AES_256_CBC_SHA(</span>
<span class="line-added">+             0xC00F, true, &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-added">+             K_ECDH_RSA, B_AES_256, M_SHA, H_SHA256),</span>
<span class="line-added">+ </span>
<span class="line-added">+     // AES_128(CBC) - using SHA, not forward secrecy</span>
      TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA(
              0xC004, true, &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_ECDH_ECDSA, B_AES_128, M_SHA, H_SHA256),
      TLS_ECDH_RSA_WITH_AES_128_CBC_SHA(
              0xC00E, true, &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_ECDH_RSA, B_AES_128, M_SHA, H_SHA256),
<span class="line-modified">! </span>
<span class="line-modified">!     //</span>
<span class="line-added">+     // deprecated, used for compatibility</span>
<span class="line-added">+     //</span>
<span class="line-added">+ </span>
<span class="line-added">+     // RSA, AES_256(GCM)</span>
<span class="line-added">+     TLS_RSA_WITH_AES_256_GCM_SHA384(</span>
<span class="line-added">+             0x009D, true, &quot;TLS_RSA_WITH_AES_256_GCM_SHA384&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added">+             K_RSA, B_AES_256_GCM, M_NULL, H_SHA384),</span>
<span class="line-added">+ </span>
<span class="line-added">+     // RSA, AES_128(GCM)</span>
<span class="line-added">+     TLS_RSA_WITH_AES_128_GCM_SHA256(</span>
<span class="line-added">+             0x009C, true, &quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added">+             K_RSA, B_AES_128_GCM, M_NULL, H_SHA256),</span>
<span class="line-added">+ </span>
<span class="line-added">+     // RSA, AES_256(CBC)</span>
<span class="line-added">+     TLS_RSA_WITH_AES_256_CBC_SHA256(</span>
<span class="line-added">+             0x003D, true, &quot;TLS_RSA_WITH_AES_256_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added">+             K_RSA, B_AES_256, M_SHA256, H_SHA256),</span>
<span class="line-added">+ </span>
<span class="line-added">+     // RSA, AES_128(CBC)</span>
<span class="line-added">+     TLS_RSA_WITH_AES_128_CBC_SHA256(</span>
<span class="line-added">+             0x003C, true, &quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_OF_12,</span>
<span class="line-added">+             K_RSA, B_AES_128, M_SHA256, H_SHA256),</span>
<span class="line-added">+ </span>
<span class="line-added">+     // RSA, AES_256(CBC) - using SHA, not forward secrecy</span>
<span class="line-added">+     TLS_RSA_WITH_AES_256_CBC_SHA(</span>
<span class="line-added">+             0x0035, true, &quot;TLS_RSA_WITH_AES_256_CBC_SHA&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified">!             K_RSA, B_AES_256, M_SHA, H_SHA256),</span>
<span class="line-modified">! </span>
<span class="line-modified">!     // RSA, AES_128(CBC) - using SHA, not forward secrecy</span>
<span class="line-added">+     TLS_RSA_WITH_AES_128_CBC_SHA(</span>
<span class="line-added">+             0x002F, true, &quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;, &quot;&quot;,</span>
              ProtocolVersion.PROTOCOLS_TO_12,
<span class="line-modified">!             K_RSA, B_AES_128, M_SHA, H_SHA256),</span>
  
<span class="line-modified">!     // 3DES_EDE, forward secrecy.</span>
      TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA(
              0xC008, true, &quot;TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_ECDHE_ECDSA, B_3DES, M_SHA, H_SHA256),
      TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA(
              0xC012, true, &quot;TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_ECDHE_RSA, B_3DES, M_SHA, H_SHA256),
      SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA(
              0x0016, true, &quot;SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;,
                            &quot;TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_DHE_RSA, B_3DES, M_SHA, H_SHA256),
</pre>
<hr />
<pre>
<span class="line-old-header">*** 306,10 ***</span>
<span class="line-new-header">--- 349,25 ---</span>
              0x0013, true, &quot;SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA&quot;,
                            &quot;TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_DHE_DSS, B_3DES, M_SHA, H_SHA256),
  
<span class="line-added">+     // 3DES_EDE, not forward secrecy.</span>
<span class="line-added">+     TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA(</span>
<span class="line-added">+             0xC003, true, &quot;TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-added">+             K_ECDH_ECDSA, B_3DES, M_SHA, H_SHA256),</span>
<span class="line-added">+     TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA(</span>
<span class="line-added">+             0xC00D, true, &quot;TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA&quot;, &quot;&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-added">+             K_ECDH_RSA, B_3DES, M_SHA, H_SHA256),</span>
<span class="line-added">+     SSL_RSA_WITH_3DES_EDE_CBC_SHA(</span>
<span class="line-added">+             0x000A, true, &quot;SSL_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-added">+                           &quot;TLS_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-added">+             ProtocolVersion.PROTOCOLS_TO_12,</span>
<span class="line-added">+             K_RSA, B_3DES, M_SHA, H_SHA256),</span>
<span class="line-added">+ </span>
      // Renegotiation protection request Signalling Cipher Suite Value (SCSV).
      TLS_EMPTY_RENEGOTIATION_INFO_SCSV(        //  RFC 5746, TLS 1.2 and prior
              0x00FF, true, &quot;TLS_EMPTY_RENEGOTIATION_INFO_SCSV&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_SCSV, B_NULL, M_NULL, H_NONE),
</pre>
<hr />
<pre>
<span class="line-old-header">*** 404,11 ***</span>
              0x0018, false, &quot;SSL_DH_anon_WITH_RC4_128_MD5&quot;,
                             &quot;TLS_DH_anon_WITH_RC4_128_MD5&quot;,
              ProtocolVersion.PROTOCOLS_TO_TLS12,
              K_DH_ANON, B_RC4_128, M_MD5, H_SHA256),
  
<span class="line-modified">!     // weak cipher suites obsoleted in TLS 1.2 [RFC 5246]</span>
      SSL_RSA_WITH_DES_CBC_SHA(
              0x0009, false, &quot;SSL_RSA_WITH_DES_CBC_SHA&quot;,
                             &quot;TLS_RSA_WITH_DES_CBC_SHA&quot;,
              ProtocolVersion.PROTOCOLS_TO_11,
              K_RSA, B_DES, M_SHA, H_NONE),
<span class="line-new-header">--- 462,11 ---</span>
              0x0018, false, &quot;SSL_DH_anon_WITH_RC4_128_MD5&quot;,
                             &quot;TLS_DH_anon_WITH_RC4_128_MD5&quot;,
              ProtocolVersion.PROTOCOLS_TO_TLS12,
              K_DH_ANON, B_RC4_128, M_MD5, H_SHA256),
  
<span class="line-modified">!     // Weak cipher suites obsoleted in TLS 1.2 [RFC 5246]</span>
      SSL_RSA_WITH_DES_CBC_SHA(
              0x0009, false, &quot;SSL_RSA_WITH_DES_CBC_SHA&quot;,
                             &quot;TLS_RSA_WITH_DES_CBC_SHA&quot;,
              ProtocolVersion.PROTOCOLS_TO_11,
              K_RSA, B_DES, M_SHA, H_NONE),
</pre>
<hr />
<pre>
<span class="line-old-header">*** 426,11 ***</span>
              0x001A, false, &quot;SSL_DH_anon_WITH_DES_CBC_SHA&quot;,
                             &quot;TLS_DH_anon_WITH_DES_CBC_SHA&quot;,
              ProtocolVersion.PROTOCOLS_TO_11,
              K_DH_ANON, B_DES, M_SHA, H_NONE),
  
<span class="line-modified">!     // weak cipher suites obsoleted in TLS 1.1  [RFC 4346]</span>
      SSL_RSA_EXPORT_WITH_DES40_CBC_SHA(
              0x0008, false, &quot;SSL_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,
                             &quot;TLS_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,
              ProtocolVersion.PROTOCOLS_TO_10,
              K_RSA_EXPORT, B_DES_40, M_SHA, H_NONE),
<span class="line-new-header">--- 484,11 ---</span>
              0x001A, false, &quot;SSL_DH_anon_WITH_DES_CBC_SHA&quot;,
                             &quot;TLS_DH_anon_WITH_DES_CBC_SHA&quot;,
              ProtocolVersion.PROTOCOLS_TO_11,
              K_DH_ANON, B_DES, M_SHA, H_NONE),
  
<span class="line-modified">!     // Weak cipher suites obsoleted in TLS 1.1  [RFC 4346]</span>
      SSL_RSA_EXPORT_WITH_DES40_CBC_SHA(
              0x0008, false, &quot;SSL_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,
                             &quot;TLS_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,
              ProtocolVersion.PROTOCOLS_TO_10,
              K_RSA_EXPORT, B_DES_40, M_SHA, H_NONE),
</pre>
<hr />
<pre>
<span class="line-old-header">*** 458,11 ***</span>
              0x0017, false, &quot;SSL_DH_anon_EXPORT_WITH_RC4_40_MD5&quot;,
                             &quot;TLS_DH_anon_EXPORT_WITH_RC4_40_MD5&quot;,
              ProtocolVersion.PROTOCOLS_TO_10,
              K_DH_ANON, B_RC4_40, M_MD5, H_NONE),
  
<span class="line-modified">!     // no traffic encryption cipher suites</span>
      TLS_RSA_WITH_NULL_SHA256(
              0x003B, false, &quot;TLS_RSA_WITH_NULL_SHA256&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_RSA, B_NULL, M_SHA256, H_SHA256),
      TLS_ECDHE_ECDSA_WITH_NULL_SHA(
<span class="line-new-header">--- 516,11 ---</span>
              0x0017, false, &quot;SSL_DH_anon_EXPORT_WITH_RC4_40_MD5&quot;,
                             &quot;TLS_DH_anon_EXPORT_WITH_RC4_40_MD5&quot;,
              ProtocolVersion.PROTOCOLS_TO_10,
              K_DH_ANON, B_RC4_40, M_MD5, H_NONE),
  
<span class="line-modified">!     // No traffic encryption cipher suites</span>
      TLS_RSA_WITH_NULL_SHA256(
              0x003B, false, &quot;TLS_RSA_WITH_NULL_SHA256&quot;, &quot;&quot;,
              ProtocolVersion.PROTOCOLS_OF_12,
              K_RSA, B_NULL, M_SHA256, H_SHA256),
      TLS_ECDHE_ECDSA_WITH_NULL_SHA(
</pre>
<hr />
<pre>
<span class="line-old-header">*** 494,39 ***</span>
              0x0001, false, &quot;SSL_RSA_WITH_NULL_MD5&quot;,
                             &quot;TLS_RSA_WITH_NULL_MD5&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_RSA, B_NULL, M_MD5, H_SHA256),
  
<span class="line-modified">!     // Definition of the CipherSuites that are not supported but the names</span>
      // are known.
      TLS_AES_128_CCM_SHA256(                          // TLS 1.3
              &quot;TLS_AES_128_CCM_SHA256&quot;, 0x1304),
      TLS_AES_128_CCM_8_SHA256(                        // TLS 1.3
              &quot;TLS_AES_128_CCM_8_SHA256&quot;, 0x1305),
  
<span class="line-modified">!     // remaining unsupported ciphersuites defined in RFC2246.</span>
      CS_0006(&quot;SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5&quot;,           0x0006),
      CS_0007(&quot;SSL_RSA_WITH_IDEA_CBC_SHA&quot;,                    0x0007),
      CS_000B(&quot;SSL_DH_DSS_EXPORT_WITH_DES40_CBC_SHA&quot;,         0x000b),
      CS_000C(&quot;SSL_DH_DSS_WITH_DES_CBC_SHA&quot;,                  0x000c),
      CS_000D(&quot;SSL_DH_DSS_WITH_3DES_EDE_CBC_SHA&quot;,             0x000d),
      CS_000E(&quot;SSL_DH_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,         0x000e),
      CS_000F(&quot;SSL_DH_RSA_WITH_DES_CBC_SHA&quot;,                  0x000f),
      CS_0010(&quot;SSL_DH_RSA_WITH_3DES_EDE_CBC_SHA&quot;,             0x0010),
  
<span class="line-modified">!     // SSL 3.0 Fortezza ciphersuites</span>
      CS_001C(&quot;SSL_FORTEZZA_DMS_WITH_NULL_SHA&quot;,               0x001c),
      CS_001D(&quot;SSL_FORTEZZA_DMS_WITH_FORTEZZA_CBC_SHA&quot;,       0x001d),
  
<span class="line-modified">!     // 1024/56 bit exportable ciphersuites from expired internet draft</span>
      CS_0062(&quot;SSL_RSA_EXPORT1024_WITH_DES_CBC_SHA&quot;,          0x0062),
      CS_0063(&quot;SSL_DHE_DSS_EXPORT1024_WITH_DES_CBC_SHA&quot;,      0x0063),
      CS_0064(&quot;SSL_RSA_EXPORT1024_WITH_RC4_56_SHA&quot;,           0x0064),
      CS_0065(&quot;SSL_DHE_DSS_EXPORT1024_WITH_RC4_56_SHA&quot;,       0x0065),
      CS_0066(&quot;SSL_DHE_DSS_WITH_RC4_128_SHA&quot;,                 0x0066),
  
<span class="line-modified">!     // Netscape old and new SSL 3.0 FIPS ciphersuites</span>
      // see http://www.mozilla.org/projects/security/pki/nss/ssl/fips-ssl-ciphersuites.html
      CS_FFE0(&quot;NETSCAPE_RSA_FIPS_WITH_3DES_EDE_CBC_SHA&quot;,      0xffe0),
      CS_FFE1(&quot;NETSCAPE_RSA_FIPS_WITH_DES_CBC_SHA&quot;,           0xffe1),
      CS_FEFE(&quot;SSL_RSA_FIPS_WITH_DES_CBC_SHA&quot;,                0xfefe),
      CS_FEFF(&quot;SSL_RSA_FIPS_WITH_3DES_EDE_CBC_SHA&quot;,           0xfeff),
<span class="line-new-header">--- 552,39 ---</span>
              0x0001, false, &quot;SSL_RSA_WITH_NULL_MD5&quot;,
                             &quot;TLS_RSA_WITH_NULL_MD5&quot;,
              ProtocolVersion.PROTOCOLS_TO_12,
              K_RSA, B_NULL, M_MD5, H_SHA256),
  
<span class="line-modified">!     // Definition of the cipher suites that are not supported but the names</span>
      // are known.
      TLS_AES_128_CCM_SHA256(                          // TLS 1.3
              &quot;TLS_AES_128_CCM_SHA256&quot;, 0x1304),
      TLS_AES_128_CCM_8_SHA256(                        // TLS 1.3
              &quot;TLS_AES_128_CCM_8_SHA256&quot;, 0x1305),
  
<span class="line-modified">!     // Remaining unsupported cipher suites defined in RFC2246.</span>
      CS_0006(&quot;SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5&quot;,           0x0006),
      CS_0007(&quot;SSL_RSA_WITH_IDEA_CBC_SHA&quot;,                    0x0007),
      CS_000B(&quot;SSL_DH_DSS_EXPORT_WITH_DES40_CBC_SHA&quot;,         0x000b),
      CS_000C(&quot;SSL_DH_DSS_WITH_DES_CBC_SHA&quot;,                  0x000c),
      CS_000D(&quot;SSL_DH_DSS_WITH_3DES_EDE_CBC_SHA&quot;,             0x000d),
      CS_000E(&quot;SSL_DH_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,         0x000e),
      CS_000F(&quot;SSL_DH_RSA_WITH_DES_CBC_SHA&quot;,                  0x000f),
      CS_0010(&quot;SSL_DH_RSA_WITH_3DES_EDE_CBC_SHA&quot;,             0x0010),
  
<span class="line-modified">!     // SSL 3.0 Fortezza cipher suites</span>
      CS_001C(&quot;SSL_FORTEZZA_DMS_WITH_NULL_SHA&quot;,               0x001c),
      CS_001D(&quot;SSL_FORTEZZA_DMS_WITH_FORTEZZA_CBC_SHA&quot;,       0x001d),
  
<span class="line-modified">!     // 1024/56 bit exportable cipher suites from expired internet draft</span>
      CS_0062(&quot;SSL_RSA_EXPORT1024_WITH_DES_CBC_SHA&quot;,          0x0062),
      CS_0063(&quot;SSL_DHE_DSS_EXPORT1024_WITH_DES_CBC_SHA&quot;,      0x0063),
      CS_0064(&quot;SSL_RSA_EXPORT1024_WITH_RC4_56_SHA&quot;,           0x0064),
      CS_0065(&quot;SSL_DHE_DSS_EXPORT1024_WITH_RC4_56_SHA&quot;,       0x0065),
      CS_0066(&quot;SSL_DHE_DSS_WITH_RC4_128_SHA&quot;,                 0x0066),
  
<span class="line-modified">!     // Netscape old and new SSL 3.0 FIPS cipher suites</span>
      // see http://www.mozilla.org/projects/security/pki/nss/ssl/fips-ssl-ciphersuites.html
      CS_FFE0(&quot;NETSCAPE_RSA_FIPS_WITH_3DES_EDE_CBC_SHA&quot;,      0xffe0),
      CS_FFE1(&quot;NETSCAPE_RSA_FIPS_WITH_DES_CBC_SHA&quot;,           0xffe1),
      CS_FEFE(&quot;SSL_RSA_FIPS_WITH_DES_CBC_SHA&quot;,                0xfefe),
      CS_FEFF(&quot;SSL_RSA_FIPS_WITH_3DES_EDE_CBC_SHA&quot;,           0xfeff),
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1046,45 ***</span>
          K_DHE_RSA       (&quot;DHE_RSA&quot;,        true,  false,  NAMED_GROUP_FFDHE),
          K_DHE_RSA_EXPORT(&quot;DHE_RSA_EXPORT&quot;, true,  false,  NAMED_GROUP_NONE),
          K_DH_ANON       (&quot;DH_anon&quot;,        true,  true,   NAMED_GROUP_FFDHE),
          K_DH_ANON_EXPORT(&quot;DH_anon_EXPORT&quot;, true,  true,   NAMED_GROUP_NONE),
  
<span class="line-modified">!         K_ECDH_ECDSA    (&quot;ECDH_ECDSA&quot;,     true,  false,  NAMED_GROUP_ECDHE),</span>
<span class="line-modified">!         K_ECDH_RSA      (&quot;ECDH_RSA&quot;,       true,  false,  NAMED_GROUP_ECDHE),</span>
<span class="line-modified">!         K_ECDHE_ECDSA   (&quot;ECDHE_ECDSA&quot;,    true,  false,  NAMED_GROUP_ECDHE),</span>
<span class="line-modified">!         K_ECDHE_RSA     (&quot;ECDHE_RSA&quot;,      true,  false,  NAMED_GROUP_ECDHE),</span>
<span class="line-modified">!         K_ECDH_ANON     (&quot;ECDH_anon&quot;,      true,  true,   NAMED_GROUP_ECDHE),</span>
  
          // renegotiation protection request signaling cipher suite
          K_SCSV          (&quot;SCSV&quot;,           true,  true,   NAMED_GROUP_NONE);
  
          // name of the key exchange algorithm, e.g. DHE_DSS
          final String name;
          final boolean allowed;
<span class="line-modified">!         final NamedGroupType groupType;</span>
          private final boolean alwaysAvailable;
          private final boolean isAnonymous;
  
          KeyExchange(String name, boolean allowed,
<span class="line-modified">!                 boolean isAnonymous, NamedGroupType groupType) {</span>
              this.name = name;
<span class="line-modified">!             if (groupType == NAMED_GROUP_ECDHE) {</span>
<span class="line-modified">!                 this.allowed = JsseJce.ALLOW_ECC;</span>
<span class="line-modified">!             } else {</span>
<span class="line-removed">-                 this.allowed = allowed;</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-             this.groupType = groupType;</span>
              this.alwaysAvailable = allowed &amp;&amp; (!name.startsWith(&quot;EC&quot;));
              this.isAnonymous = isAnonymous;
          }
  
          boolean isAvailable() {
              if (alwaysAvailable) {
                  return true;
              }
  
<span class="line-modified">!             if (groupType == NAMED_GROUP_ECDHE) {</span>
                  return (allowed &amp;&amp; JsseJce.isEcAvailable());
              } else {
                  return allowed;
              }
          }
<span class="line-new-header">--- 1104,50 ---</span>
          K_DHE_RSA       (&quot;DHE_RSA&quot;,        true,  false,  NAMED_GROUP_FFDHE),
          K_DHE_RSA_EXPORT(&quot;DHE_RSA_EXPORT&quot;, true,  false,  NAMED_GROUP_NONE),
          K_DH_ANON       (&quot;DH_anon&quot;,        true,  true,   NAMED_GROUP_FFDHE),
          K_DH_ANON_EXPORT(&quot;DH_anon_EXPORT&quot;, true,  true,   NAMED_GROUP_NONE),
  
<span class="line-modified">!         // These KeyExchanges can use either ECDHE/XDH, so we&#39;ll use a</span>
<span class="line-modified">!         // varargs here.</span>
<span class="line-modified">!         K_ECDH_ECDSA    (&quot;ECDH_ECDSA&quot;,     JsseJce.ALLOW_ECC,  false,</span>
<span class="line-modified">!                 NAMED_GROUP_ECDHE, NAMED_GROUP_XDH),</span>
<span class="line-modified">!         K_ECDH_RSA      (&quot;ECDH_RSA&quot;,       JsseJce.ALLOW_ECC,  false,</span>
<span class="line-added">+             NAMED_GROUP_ECDHE, NAMED_GROUP_XDH),</span>
<span class="line-added">+         K_ECDHE_ECDSA   (&quot;ECDHE_ECDSA&quot;,    JsseJce.ALLOW_ECC,  false,</span>
<span class="line-added">+             NAMED_GROUP_ECDHE, NAMED_GROUP_XDH),</span>
<span class="line-added">+         K_ECDHE_RSA     (&quot;ECDHE_RSA&quot;,      JsseJce.ALLOW_ECC,  false,</span>
<span class="line-added">+             NAMED_GROUP_ECDHE, NAMED_GROUP_XDH),</span>
<span class="line-added">+         K_ECDH_ANON     (&quot;ECDH_anon&quot;,      JsseJce.ALLOW_ECC,  true,</span>
<span class="line-added">+             NAMED_GROUP_ECDHE, NAMED_GROUP_XDH),</span>
  
          // renegotiation protection request signaling cipher suite
          K_SCSV          (&quot;SCSV&quot;,           true,  true,   NAMED_GROUP_NONE);
  
          // name of the key exchange algorithm, e.g. DHE_DSS
          final String name;
          final boolean allowed;
<span class="line-modified">!         final NamedGroupSpec[] groupTypes;</span>
          private final boolean alwaysAvailable;
          private final boolean isAnonymous;
  
          KeyExchange(String name, boolean allowed,
<span class="line-modified">!                 boolean isAnonymous, NamedGroupSpec... groupTypes) {</span>
              this.name = name;
<span class="line-modified">!             this.groupTypes = groupTypes;</span>
<span class="line-modified">!             this.allowed = allowed;</span>
<span class="line-modified">! </span>
              this.alwaysAvailable = allowed &amp;&amp; (!name.startsWith(&quot;EC&quot;));
              this.isAnonymous = isAnonymous;
          }
  
          boolean isAvailable() {
              if (alwaysAvailable) {
                  return true;
              }
  
<span class="line-modified">!             if (NamedGroupSpec.arrayContains(groupTypes,</span>
<span class="line-added">+                     NamedGroupSpec.NAMED_GROUP_ECDHE)) {</span>
                  return (allowed &amp;&amp; JsseJce.isEcAvailable());
              } else {
                  return allowed;
              }
          }
</pre>
<center><a href="CertificateVerify.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ClientHello.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>