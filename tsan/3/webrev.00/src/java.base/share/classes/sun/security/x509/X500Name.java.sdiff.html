<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/sun/security/x509/X500Name.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="PKIXExtensions.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="X509CRLImpl.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/x509/X500Name.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 1996, 2014, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
1080      * specified in the OID/keyword map.
1081      */
1082     private String generateRFC1779DN(Map&lt;String, String&gt; oidMap) {
1083         if (names.length == 1) {
1084             return names[0].toRFC1779String(oidMap);
1085         }
1086 
1087         if (names == null) {
1088             return &quot;&quot;;
1089         }
1090 
1091         StringJoiner sj = new StringJoiner(&quot;, &quot;);
1092         for (int i = names.length - 1; i &gt;= 0; i--) {
1093             sj.add(names[i].toRFC1779String(oidMap));
1094         }
1095         return sj.toString();
1096     }
1097 
1098     /****************************************************************/
1099 
<span class="line-removed">1100     /*</span>
<span class="line-removed">1101      * Maybe return a preallocated OID, to reduce storage costs</span>
<span class="line-removed">1102      * and speed recognition of common X.500 attributes.</span>
<span class="line-removed">1103      */</span>
<span class="line-removed">1104     static ObjectIdentifier intern(ObjectIdentifier oid) {</span>
<span class="line-removed">1105         ObjectIdentifier interned = internedOIDs.putIfAbsent(oid, oid);</span>
<span class="line-removed">1106         return (interned == null) ? oid : interned;</span>
<span class="line-removed">1107     }</span>
<span class="line-removed">1108 </span>
<span class="line-removed">1109     private static final Map&lt;ObjectIdentifier,ObjectIdentifier&gt; internedOIDs</span>
<span class="line-removed">1110                         = new HashMap&lt;ObjectIdentifier,ObjectIdentifier&gt;();</span>
<span class="line-removed">1111 </span>
1112     /*
1113      * Selected OIDs from X.520
1114      * Includes all those specified in RFC 5280 as MUST or SHOULD
1115      * be recognized
1116      */
<span class="line-removed">1117     private static final int[] commonName_data = { 2, 5, 4, 3 };</span>
<span class="line-removed">1118     private static final int[] SURNAME_DATA = { 2, 5, 4, 4 };</span>
<span class="line-removed">1119     private static final int[] SERIALNUMBER_DATA = { 2, 5, 4, 5 };</span>
<span class="line-removed">1120     private static final int[] countryName_data = { 2, 5, 4, 6 };</span>
<span class="line-removed">1121     private static final int[] localityName_data = { 2, 5, 4, 7 };</span>
<span class="line-removed">1122     private static final int[] stateName_data = { 2, 5, 4, 8 };</span>
<span class="line-removed">1123     private static final int[] streetAddress_data = { 2, 5, 4, 9 };</span>
<span class="line-removed">1124     private static final int[] orgName_data = { 2, 5, 4, 10 };</span>
<span class="line-removed">1125     private static final int[] orgUnitName_data = { 2, 5, 4, 11 };</span>
<span class="line-removed">1126     private static final int[] title_data = { 2, 5, 4, 12 };</span>
<span class="line-removed">1127     private static final int[] GIVENNAME_DATA = { 2, 5, 4, 42 };</span>
<span class="line-removed">1128     private static final int[] INITIALS_DATA = { 2, 5, 4, 43 };</span>
<span class="line-removed">1129     private static final int[] GENERATIONQUALIFIER_DATA = { 2, 5, 4, 44 };</span>
<span class="line-removed">1130     private static final int[] DNQUALIFIER_DATA = { 2, 5, 4, 46 };</span>
<span class="line-removed">1131 </span>
<span class="line-removed">1132     private static final int[] ipAddress_data = { 1, 3, 6, 1, 4, 1, 42, 2, 11, 2, 1 };</span>
<span class="line-removed">1133     private static final int[] DOMAIN_COMPONENT_DATA =</span>
<span class="line-removed">1134         { 0, 9, 2342, 19200300, 100, 1, 25 };</span>
<span class="line-removed">1135     private static final int[] userid_data =</span>
<span class="line-removed">1136         { 0, 9, 2342, 19200300, 100, 1, 1 };</span>
<span class="line-removed">1137 </span>
<span class="line-removed">1138 </span>
<span class="line-removed">1139     public static final ObjectIdentifier commonName_oid;</span>
<span class="line-removed">1140     public static final ObjectIdentifier countryName_oid;</span>
<span class="line-removed">1141     public static final ObjectIdentifier localityName_oid;</span>
<span class="line-removed">1142     public static final ObjectIdentifier orgName_oid;</span>
<span class="line-removed">1143     public static final ObjectIdentifier orgUnitName_oid;</span>
<span class="line-removed">1144     public static final ObjectIdentifier stateName_oid;</span>
<span class="line-removed">1145     public static final ObjectIdentifier streetAddress_oid;</span>
<span class="line-removed">1146     public static final ObjectIdentifier title_oid;</span>
<span class="line-removed">1147     public static final ObjectIdentifier DNQUALIFIER_OID;</span>
<span class="line-removed">1148     public static final ObjectIdentifier SURNAME_OID;</span>
<span class="line-removed">1149     public static final ObjectIdentifier GIVENNAME_OID;</span>
<span class="line-removed">1150     public static final ObjectIdentifier INITIALS_OID;</span>
<span class="line-removed">1151     public static final ObjectIdentifier GENERATIONQUALIFIER_OID;</span>
<span class="line-removed">1152     public static final ObjectIdentifier ipAddress_oid;</span>
<span class="line-removed">1153     public static final ObjectIdentifier DOMAIN_COMPONENT_OID;</span>
<span class="line-removed">1154     public static final ObjectIdentifier userid_oid;</span>
<span class="line-removed">1155     public static final ObjectIdentifier SERIALNUMBER_OID;</span>
<span class="line-removed">1156 </span>
<span class="line-removed">1157     static {</span>
<span class="line-removed">1158     /** OID for the &quot;CN=&quot; attribute, denoting a person&#39;s common name. */</span>
<span class="line-removed">1159         commonName_oid = intern(ObjectIdentifier.newInternal(commonName_data));</span>
<span class="line-removed">1160 </span>
<span class="line-removed">1161     /** OID for the &quot;SERIALNUMBER=&quot; attribute, denoting a serial number for.</span>
<span class="line-removed">1162         a name. Do not confuse with PKCS#9 issuerAndSerialNumber or the</span>
<span class="line-removed">1163         certificate serial number. */</span>
<span class="line-removed">1164         SERIALNUMBER_OID = intern(ObjectIdentifier.newInternal(SERIALNUMBER_DATA));</span>
<span class="line-removed">1165 </span>
<span class="line-removed">1166     /** OID for the &quot;C=&quot; attribute, denoting a country. */</span>
<span class="line-removed">1167         countryName_oid = intern(ObjectIdentifier.newInternal(countryName_data));</span>
<span class="line-removed">1168 </span>
<span class="line-removed">1169     /** OID for the &quot;L=&quot; attribute, denoting a locality (such as a city) */</span>
<span class="line-removed">1170         localityName_oid = intern(ObjectIdentifier.newInternal(localityName_data));</span>
<span class="line-removed">1171 </span>
<span class="line-removed">1172     /** OID for the &quot;O=&quot; attribute, denoting an organization name */</span>
<span class="line-removed">1173         orgName_oid = intern(ObjectIdentifier.newInternal(orgName_data));</span>
<span class="line-removed">1174 </span>
<span class="line-removed">1175     /** OID for the &quot;OU=&quot; attribute, denoting an organizational unit name */</span>
<span class="line-removed">1176         orgUnitName_oid = intern(ObjectIdentifier.newInternal(orgUnitName_data));</span>
<span class="line-removed">1177 </span>
<span class="line-removed">1178     /** OID for the &quot;S=&quot; attribute, denoting a state (such as Delaware) */</span>
<span class="line-removed">1179         stateName_oid = intern(ObjectIdentifier.newInternal(stateName_data));</span>
<span class="line-removed">1180 </span>
<span class="line-removed">1181     /** OID for the &quot;STREET=&quot; attribute, denoting a street address. */</span>
<span class="line-removed">1182         streetAddress_oid = intern(ObjectIdentifier.newInternal(streetAddress_data));</span>
<span class="line-removed">1183 </span>
<span class="line-removed">1184     /** OID for the &quot;T=&quot; attribute, denoting a person&#39;s title. */</span>
<span class="line-removed">1185         title_oid = intern(ObjectIdentifier.newInternal(title_data));</span>
<span class="line-removed">1186 </span>
<span class="line-removed">1187     /** OID for the &quot;DNQUALIFIER=&quot; or &quot;DNQ=&quot; attribute, denoting DN</span>
<span class="line-removed">1188         disambiguating information.*/</span>
<span class="line-removed">1189         DNQUALIFIER_OID = intern(ObjectIdentifier.newInternal(DNQUALIFIER_DATA));</span>
<span class="line-removed">1190 </span>
<span class="line-removed">1191     /** OID for the &quot;SURNAME=&quot; attribute, denoting a person&#39;s surname.*/</span>
<span class="line-removed">1192         SURNAME_OID = intern(ObjectIdentifier.newInternal(SURNAME_DATA));</span>
<span class="line-removed">1193 </span>
<span class="line-removed">1194     /** OID for the &quot;GIVENNAME=&quot; attribute, denoting a person&#39;s given name.*/</span>
<span class="line-removed">1195         GIVENNAME_OID = intern(ObjectIdentifier.newInternal(GIVENNAME_DATA));</span>
<span class="line-removed">1196 </span>
<span class="line-removed">1197     /** OID for the &quot;INITIALS=&quot; attribute, denoting a person&#39;s initials.*/</span>
<span class="line-removed">1198         INITIALS_OID = intern(ObjectIdentifier.newInternal(INITIALS_DATA));</span>
<span class="line-removed">1199 </span>
<span class="line-removed">1200     /** OID for the &quot;GENERATION=&quot; attribute, denoting Jr., II, etc.*/</span>
<span class="line-removed">1201         GENERATIONQUALIFIER_OID =</span>
<span class="line-removed">1202             intern(ObjectIdentifier.newInternal(GENERATIONQUALIFIER_DATA));</span>
<span class="line-removed">1203 </span>
<span class="line-removed">1204     /*</span>
<span class="line-removed">1205      * OIDs from other sources which show up in X.500 names we</span>
<span class="line-removed">1206      * expect to deal with often</span>
<span class="line-removed">1207      */</span>
<span class="line-removed">1208     /** OID for &quot;IP=&quot; IP address attributes, used with SKIP. */</span>
<span class="line-removed">1209         ipAddress_oid = intern(ObjectIdentifier.newInternal(ipAddress_data));</span>
1210 
<span class="line-modified">1211     /*</span>
<span class="line-modified">1212      * Domain component OID from RFC 1274, RFC 2247, RFC 5280</span>
<span class="line-modified">1213      */</span>
<span class="line-modified">1214 </span>
<span class="line-modified">1215     /*</span>
<span class="line-modified">1216      * OID for &quot;DC=&quot; domain component attributes, used with DNSNames in DN</span>
<span class="line-modified">1217      * format</span>
<span class="line-modified">1218      */</span>
<span class="line-modified">1219         DOMAIN_COMPONENT_OID =</span>
<span class="line-modified">1220             intern(ObjectIdentifier.newInternal(DOMAIN_COMPONENT_DATA));</span>
<span class="line-modified">1221 </span>
<span class="line-modified">1222     /** OID for &quot;UID=&quot; denoting a user id, defined in RFCs 1274 &amp; 2798. */</span>
<span class="line-modified">1223         userid_oid = intern(ObjectIdentifier.newInternal(userid_data));</span>
<span class="line-modified">1224     }</span>






























































1225 
1226     /**
1227      * Return constraint type:&lt;ul&gt;
1228      *   &lt;li&gt;NAME_DIFF_TYPE = -1: input name is different type from this name
1229      *       (i.e. does not constrain)
1230      *   &lt;li&gt;NAME_MATCH = 0: input name matches this name
1231      *   &lt;li&gt;NAME_NARROWS = 1: input name narrows this name
1232      *   &lt;li&gt;NAME_WIDENS = 2: input name widens this name
1233      *   &lt;li&gt;NAME_SAME_TYPE = 3: input name does not match or narrow this name,
1234      *       but is same type.
1235      * &lt;/ul&gt;
1236      * These results are used in checking NameConstraints during
1237      * certification path verification.
1238      *
1239      * @param inputName to be checked for being constrained
1240      * @return constraint type above
1241      * @throws UnsupportedOperationException if name is not exact match, but
1242      *         narrowing and widening are not supported for this name type.
1243      */
1244     public int constrains(GeneralNameInterface inputName)
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 1996, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
1080      * specified in the OID/keyword map.
1081      */
1082     private String generateRFC1779DN(Map&lt;String, String&gt; oidMap) {
1083         if (names.length == 1) {
1084             return names[0].toRFC1779String(oidMap);
1085         }
1086 
1087         if (names == null) {
1088             return &quot;&quot;;
1089         }
1090 
1091         StringJoiner sj = new StringJoiner(&quot;, &quot;);
1092         for (int i = names.length - 1; i &gt;= 0; i--) {
1093             sj.add(names[i].toRFC1779String(oidMap));
1094         }
1095         return sj.toString();
1096     }
1097 
1098     /****************************************************************/
1099 












1100     /*
1101      * Selected OIDs from X.520
1102      * Includes all those specified in RFC 5280 as MUST or SHOULD
1103      * be recognized
1104      */





























































































1105 
<span class="line-modified">1106     // OID for the &quot;CN=&quot; attribute, denoting a person&#39;s common name.</span>
<span class="line-modified">1107     public static final ObjectIdentifier commonName_oid =</span>
<span class="line-modified">1108             ObjectIdentifier.of(&quot;2.5.4.3&quot;);</span>
<span class="line-modified">1109 </span>
<span class="line-modified">1110     // OID for the &quot;SURNAME=&quot; attribute, denoting a person&#39;s surname.</span>
<span class="line-modified">1111     public static final ObjectIdentifier SURNAME_OID =</span>
<span class="line-modified">1112             ObjectIdentifier.of(&quot;2.5.4.4&quot;);</span>
<span class="line-modified">1113 </span>
<span class="line-modified">1114     // OID for the &quot;SERIALNUMBER=&quot; attribute, denoting a serial number for.</span>
<span class="line-modified">1115     // a name. Do not confuse with PKCS#9 issuerAndSerialNumber or the</span>
<span class="line-modified">1116     // certificate serial number.</span>
<span class="line-modified">1117     public static final ObjectIdentifier SERIALNUMBER_OID =</span>
<span class="line-modified">1118             ObjectIdentifier.of(&quot;2.5.4.5&quot;);</span>
<span class="line-modified">1119 </span>
<span class="line-added">1120     // OID for the &quot;C=&quot; attribute, denoting a country.</span>
<span class="line-added">1121     public static final ObjectIdentifier countryName_oid =</span>
<span class="line-added">1122             ObjectIdentifier.of(&quot;2.5.4.6&quot;);</span>
<span class="line-added">1123 </span>
<span class="line-added">1124     // OID for the &quot;L=&quot; attribute, denoting a locality (such as a city).</span>
<span class="line-added">1125     public static final ObjectIdentifier localityName_oid =</span>
<span class="line-added">1126             ObjectIdentifier.of(&quot;2.5.4.7&quot;);</span>
<span class="line-added">1127 </span>
<span class="line-added">1128     // OID for the &quot;S=&quot; attribute, denoting a state (such as Delaware).</span>
<span class="line-added">1129     public static final ObjectIdentifier stateName_oid =</span>
<span class="line-added">1130             ObjectIdentifier.of(&quot;2.5.4.8&quot;);</span>
<span class="line-added">1131 </span>
<span class="line-added">1132     // OID for the &quot;STREET=&quot; attribute, denoting a street address.</span>
<span class="line-added">1133     public static final ObjectIdentifier streetAddress_oid =</span>
<span class="line-added">1134             ObjectIdentifier.of(&quot;2.5.4.9&quot;);</span>
<span class="line-added">1135 </span>
<span class="line-added">1136     // OID for the &quot;O=&quot; attribute, denoting an organization name.</span>
<span class="line-added">1137     public static final ObjectIdentifier orgName_oid =</span>
<span class="line-added">1138             ObjectIdentifier.of(&quot;2.5.4.10&quot;);</span>
<span class="line-added">1139 </span>
<span class="line-added">1140     // OID for the &quot;OU=&quot; attribute, denoting an organizational unit name.</span>
<span class="line-added">1141     public static final ObjectIdentifier orgUnitName_oid =</span>
<span class="line-added">1142             ObjectIdentifier.of(&quot;2.5.4.11&quot;);</span>
<span class="line-added">1143 </span>
<span class="line-added">1144     // OID for the &quot;T=&quot; attribute, denoting a person&#39;s title.</span>
<span class="line-added">1145     public static final ObjectIdentifier title_oid =</span>
<span class="line-added">1146             ObjectIdentifier.of(&quot;2.5.4.12&quot;);</span>
<span class="line-added">1147 </span>
<span class="line-added">1148     // OID for the &quot;GIVENNAME=&quot; attribute, denoting a person&#39;s given name.</span>
<span class="line-added">1149     public static final ObjectIdentifier GIVENNAME_OID =</span>
<span class="line-added">1150             ObjectIdentifier.of(&quot;2.5.4.42&quot;);</span>
<span class="line-added">1151 </span>
<span class="line-added">1152     // OID for the &quot;INITIALS=&quot; attribute, denoting a person&#39;s initials.</span>
<span class="line-added">1153     public static final ObjectIdentifier INITIALS_OID =</span>
<span class="line-added">1154             ObjectIdentifier.of(&quot;2.5.4.43&quot;);</span>
<span class="line-added">1155 </span>
<span class="line-added">1156     // OID for the &quot;GENERATION=&quot; attribute, denoting Jr., II, etc.</span>
<span class="line-added">1157     public static final ObjectIdentifier GENERATIONQUALIFIER_OID =</span>
<span class="line-added">1158             ObjectIdentifier.of(&quot;2.5.4.44&quot;);</span>
<span class="line-added">1159 </span>
<span class="line-added">1160     // OID for the &quot;DNQUALIFIER=&quot; or &quot;DNQ=&quot; attribute, denoting DN</span>
<span class="line-added">1161     // disambiguating information.</span>
<span class="line-added">1162     public static final ObjectIdentifier DNQUALIFIER_OID =</span>
<span class="line-added">1163             ObjectIdentifier.of(&quot;2.5.4.46&quot;);</span>
<span class="line-added">1164 </span>
<span class="line-added">1165     // OIDs from other sources which show up in X.500 names we</span>
<span class="line-added">1166     // expect to deal with often.</span>
<span class="line-added">1167     //</span>
<span class="line-added">1168     // OID for &quot;IP=&quot; IP address attributes, used with SKIP.</span>
<span class="line-added">1169     public static final ObjectIdentifier ipAddress_oid =</span>
<span class="line-added">1170             ObjectIdentifier.of(&quot;1.3.6.1.4.1.42.2.11.2.1&quot;);</span>
<span class="line-added">1171 </span>
<span class="line-added">1172     // Domain component OID from RFC 1274, RFC 2247, RFC 5280.</span>
<span class="line-added">1173     //</span>
<span class="line-added">1174     // OID for &quot;DC=&quot; domain component attributes.used with DNSNames in DN</span>
<span class="line-added">1175     // format.</span>
<span class="line-added">1176     public static final ObjectIdentifier DOMAIN_COMPONENT_OID =</span>
<span class="line-added">1177             ObjectIdentifier.of(&quot;0.9.2342.19200300.100.1.25&quot;);</span>
<span class="line-added">1178 </span>
<span class="line-added">1179     // OID for &quot;UID=&quot; denoting a user id, defined in RFCs 1274 &amp; 2798.</span>
<span class="line-added">1180     public static final ObjectIdentifier userid_oid =</span>
<span class="line-added">1181             ObjectIdentifier.of(&quot;0.9.2342.19200300.100.1.1&quot;);</span>
1182 
1183     /**
1184      * Return constraint type:&lt;ul&gt;
1185      *   &lt;li&gt;NAME_DIFF_TYPE = -1: input name is different type from this name
1186      *       (i.e. does not constrain)
1187      *   &lt;li&gt;NAME_MATCH = 0: input name matches this name
1188      *   &lt;li&gt;NAME_NARROWS = 1: input name narrows this name
1189      *   &lt;li&gt;NAME_WIDENS = 2: input name widens this name
1190      *   &lt;li&gt;NAME_SAME_TYPE = 3: input name does not match or narrow this name,
1191      *       but is same type.
1192      * &lt;/ul&gt;
1193      * These results are used in checking NameConstraints during
1194      * certification path verification.
1195      *
1196      * @param inputName to be checked for being constrained
1197      * @return constraint type above
1198      * @throws UnsupportedOperationException if name is not exact match, but
1199      *         narrowing and widening are not supported for this name type.
1200      */
1201     public int constrains(GeneralNameInterface inputName)
</pre>
</td>
</tr>
</table>
<center><a href="PKIXExtensions.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="X509CRLImpl.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>