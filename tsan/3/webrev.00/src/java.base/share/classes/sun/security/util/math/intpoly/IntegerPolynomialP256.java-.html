<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/java.base/share/classes/sun/security/util/math/intpoly/IntegerPolynomialP256.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2018, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 /*
 27  * This file is generated by FieldGen.jsh. Do not modify it directly.
 28  */
 29 
 30 package sun.security.util.math.intpoly;
 31 
 32 import java.math.BigInteger;
 33 public class IntegerPolynomialP256 extends IntegerPolynomial {
 34     private static final int BITS_PER_LIMB = 26;
 35     private static final int NUM_LIMBS = 10;
 36     private static final int MAX_ADDS = 2;
 37     public static final BigInteger MODULUS = evaluateModulus();
 38     private static final long CARRY_ADD = 1 &lt;&lt; 25;
 39     private static final int LIMB_MASK = -1 &gt;&gt;&gt; (64 - BITS_PER_LIMB);
 40     public IntegerPolynomialP256() {
 41 
 42         super(BITS_PER_LIMB, NUM_LIMBS, MAX_ADDS, MODULUS);
 43 
 44     }
 45     private static BigInteger evaluateModulus() {
 46         BigInteger result = BigInteger.valueOf(2).pow(256);
 47         result = result.subtract(BigInteger.valueOf(2).pow(224));
 48         result = result.add(BigInteger.valueOf(2).pow(192));
 49         result = result.add(BigInteger.valueOf(2).pow(96));
 50         result = result.subtract(BigInteger.valueOf(1));
 51         return result;
 52     }
 53     @Override
 54     protected void finalCarryReduceLast(long[] limbs) {
 55         long c = limbs[9] &gt;&gt; 22;
 56         limbs[9] -= c &lt;&lt; 22;
 57         limbs[8] += (c &lt;&lt; 16) &amp; LIMB_MASK;
 58         limbs[9] += c &gt;&gt; 10;
 59         limbs[7] -= (c &lt;&lt; 10) &amp; LIMB_MASK;
 60         limbs[8] -= c &gt;&gt; 16;
 61         limbs[3] -= (c &lt;&lt; 18) &amp; LIMB_MASK;
 62         limbs[4] -= c &gt;&gt; 8;
 63         limbs[0] += c;
 64     }
 65     private void carryReduce(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9, long c10, long c11, long c12, long c13, long c14, long c15, long c16, long c17, long c18) {
 66         long c19 = 0;
 67         //reduce from position 18
 68         c16 += (c18 &lt;&lt; 20) &amp; LIMB_MASK;
 69         c17 += c18 &gt;&gt; 6;
 70         c15 -= (c18 &lt;&lt; 14) &amp; LIMB_MASK;
 71         c16 -= c18 &gt;&gt; 12;
 72         c11 -= (c18 &lt;&lt; 22) &amp; LIMB_MASK;
 73         c12 -= c18 &gt;&gt; 4;
 74         c8 += (c18 &lt;&lt; 4) &amp; LIMB_MASK;
 75         c9 += c18 &gt;&gt; 22;
 76         //reduce from position 17
 77         c15 += (c17 &lt;&lt; 20) &amp; LIMB_MASK;
 78         c16 += c17 &gt;&gt; 6;
 79         c14 -= (c17 &lt;&lt; 14) &amp; LIMB_MASK;
 80         c15 -= c17 &gt;&gt; 12;
 81         c10 -= (c17 &lt;&lt; 22) &amp; LIMB_MASK;
 82         c11 -= c17 &gt;&gt; 4;
 83         c7 += (c17 &lt;&lt; 4) &amp; LIMB_MASK;
 84         c8 += c17 &gt;&gt; 22;
 85         //reduce from position 16
 86         c14 += (c16 &lt;&lt; 20) &amp; LIMB_MASK;
 87         c15 += c16 &gt;&gt; 6;
 88         c13 -= (c16 &lt;&lt; 14) &amp; LIMB_MASK;
 89         c14 -= c16 &gt;&gt; 12;
 90         c9 -= (c16 &lt;&lt; 22) &amp; LIMB_MASK;
 91         c10 -= c16 &gt;&gt; 4;
 92         c6 += (c16 &lt;&lt; 4) &amp; LIMB_MASK;
 93         c7 += c16 &gt;&gt; 22;
 94         //reduce from position 15
 95         c13 += (c15 &lt;&lt; 20) &amp; LIMB_MASK;
 96         c14 += c15 &gt;&gt; 6;
 97         c12 -= (c15 &lt;&lt; 14) &amp; LIMB_MASK;
 98         c13 -= c15 &gt;&gt; 12;
 99         c8 -= (c15 &lt;&lt; 22) &amp; LIMB_MASK;
100         c9 -= c15 &gt;&gt; 4;
101         c5 += (c15 &lt;&lt; 4) &amp; LIMB_MASK;
102         c6 += c15 &gt;&gt; 22;
103         //reduce from position 14
104         c12 += (c14 &lt;&lt; 20) &amp; LIMB_MASK;
105         c13 += c14 &gt;&gt; 6;
106         c11 -= (c14 &lt;&lt; 14) &amp; LIMB_MASK;
107         c12 -= c14 &gt;&gt; 12;
108         c7 -= (c14 &lt;&lt; 22) &amp; LIMB_MASK;
109         c8 -= c14 &gt;&gt; 4;
110         c4 += (c14 &lt;&lt; 4) &amp; LIMB_MASK;
111         c5 += c14 &gt;&gt; 22;
112         //reduce from position 13
113         c11 += (c13 &lt;&lt; 20) &amp; LIMB_MASK;
114         c12 += c13 &gt;&gt; 6;
115         c10 -= (c13 &lt;&lt; 14) &amp; LIMB_MASK;
116         c11 -= c13 &gt;&gt; 12;
117         c6 -= (c13 &lt;&lt; 22) &amp; LIMB_MASK;
118         c7 -= c13 &gt;&gt; 4;
119         c3 += (c13 &lt;&lt; 4) &amp; LIMB_MASK;
120         c4 += c13 &gt;&gt; 22;
121         //reduce from position 12
122         c10 += (c12 &lt;&lt; 20) &amp; LIMB_MASK;
123         c11 += c12 &gt;&gt; 6;
124         c9 -= (c12 &lt;&lt; 14) &amp; LIMB_MASK;
125         c10 -= c12 &gt;&gt; 12;
126         c5 -= (c12 &lt;&lt; 22) &amp; LIMB_MASK;
127         c6 -= c12 &gt;&gt; 4;
128         c2 += (c12 &lt;&lt; 4) &amp; LIMB_MASK;
129         c3 += c12 &gt;&gt; 22;
130         //reduce from position 11
131         c9 += (c11 &lt;&lt; 20) &amp; LIMB_MASK;
132         c10 += c11 &gt;&gt; 6;
133         c8 -= (c11 &lt;&lt; 14) &amp; LIMB_MASK;
134         c9 -= c11 &gt;&gt; 12;
135         c4 -= (c11 &lt;&lt; 22) &amp; LIMB_MASK;
136         c5 -= c11 &gt;&gt; 4;
137         c1 += (c11 &lt;&lt; 4) &amp; LIMB_MASK;
138         c2 += c11 &gt;&gt; 22;
139         //reduce from position 10
140         c8 += (c10 &lt;&lt; 20) &amp; LIMB_MASK;
141         c9 += c10 &gt;&gt; 6;
142         c7 -= (c10 &lt;&lt; 14) &amp; LIMB_MASK;
143         c8 -= c10 &gt;&gt; 12;
144         c3 -= (c10 &lt;&lt; 22) &amp; LIMB_MASK;
145         c4 -= c10 &gt;&gt; 4;
146         c0 += (c10 &lt;&lt; 4) &amp; LIMB_MASK;
147         c1 += c10 &gt;&gt; 22;
148         c10 = 0;
149 
150         carryReduce0(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19);
151     }
152     void carryReduce0(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9, long c10, long c11, long c12, long c13, long c14, long c15, long c16, long c17, long c18, long c19) {
153 
154         //carry from position 8
155         long t0 = (c8 + CARRY_ADD) &gt;&gt; 26;
156         c8 -= (t0 &lt;&lt; 26);
157         c9 += t0;
158         //carry from position 9
159         t0 = (c9 + CARRY_ADD) &gt;&gt; 26;
160         c9 -= (t0 &lt;&lt; 26);
161         c10 += t0;
162         //reduce from position 10
163         c8 += (c10 &lt;&lt; 20) &amp; LIMB_MASK;
164         c9 += c10 &gt;&gt; 6;
165         c7 -= (c10 &lt;&lt; 14) &amp; LIMB_MASK;
166         c8 -= c10 &gt;&gt; 12;
167         c3 -= (c10 &lt;&lt; 22) &amp; LIMB_MASK;
168         c4 -= c10 &gt;&gt; 4;
169         c0 += (c10 &lt;&lt; 4) &amp; LIMB_MASK;
170         c1 += c10 &gt;&gt; 22;
171         //carry from position 0
172         t0 = (c0 + CARRY_ADD) &gt;&gt; 26;
173         c0 -= (t0 &lt;&lt; 26);
174         c1 += t0;
175         //carry from position 1
176         t0 = (c1 + CARRY_ADD) &gt;&gt; 26;
177         c1 -= (t0 &lt;&lt; 26);
178         c2 += t0;
179         //carry from position 2
180         t0 = (c2 + CARRY_ADD) &gt;&gt; 26;
181         c2 -= (t0 &lt;&lt; 26);
182         c3 += t0;
183         //carry from position 3
184         t0 = (c3 + CARRY_ADD) &gt;&gt; 26;
185         c3 -= (t0 &lt;&lt; 26);
186         c4 += t0;
187         //carry from position 4
188         t0 = (c4 + CARRY_ADD) &gt;&gt; 26;
189         c4 -= (t0 &lt;&lt; 26);
190         c5 += t0;
191         //carry from position 5
192         t0 = (c5 + CARRY_ADD) &gt;&gt; 26;
193         c5 -= (t0 &lt;&lt; 26);
194         c6 += t0;
195         //carry from position 6
196         t0 = (c6 + CARRY_ADD) &gt;&gt; 26;
197         c6 -= (t0 &lt;&lt; 26);
198         c7 += t0;
199         //carry from position 7
200         t0 = (c7 + CARRY_ADD) &gt;&gt; 26;
201         c7 -= (t0 &lt;&lt; 26);
202         c8 += t0;
203         //carry from position 8
204         t0 = (c8 + CARRY_ADD) &gt;&gt; 26;
205         c8 -= (t0 &lt;&lt; 26);
206         c9 += t0;
207 
208         r[0] = c0;
209         r[1] = c1;
210         r[2] = c2;
211         r[3] = c3;
212         r[4] = c4;
213         r[5] = c5;
214         r[6] = c6;
215         r[7] = c7;
216         r[8] = c8;
217         r[9] = c9;
218     }
219     private void carryReduce(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9) {
220         long c10 = 0;
221         //carry from position 8
222         long t0 = (c8 + CARRY_ADD) &gt;&gt; 26;
223         c8 -= (t0 &lt;&lt; 26);
224         c9 += t0;
225         //carry from position 9
226         t0 = (c9 + CARRY_ADD) &gt;&gt; 26;
227         c9 -= (t0 &lt;&lt; 26);
228         c10 += t0;
229         //reduce from position 10
230         c8 += (c10 &lt;&lt; 20) &amp; LIMB_MASK;
231         c9 += c10 &gt;&gt; 6;
232         c7 -= (c10 &lt;&lt; 14) &amp; LIMB_MASK;
233         c8 -= c10 &gt;&gt; 12;
234         c3 -= (c10 &lt;&lt; 22) &amp; LIMB_MASK;
235         c4 -= c10 &gt;&gt; 4;
236         c0 += (c10 &lt;&lt; 4) &amp; LIMB_MASK;
237         c1 += c10 &gt;&gt; 22;
238         //carry from position 0
239         t0 = (c0 + CARRY_ADD) &gt;&gt; 26;
240         c0 -= (t0 &lt;&lt; 26);
241         c1 += t0;
242         //carry from position 1
243         t0 = (c1 + CARRY_ADD) &gt;&gt; 26;
244         c1 -= (t0 &lt;&lt; 26);
245         c2 += t0;
246         //carry from position 2
247         t0 = (c2 + CARRY_ADD) &gt;&gt; 26;
248         c2 -= (t0 &lt;&lt; 26);
249         c3 += t0;
250         //carry from position 3
251         t0 = (c3 + CARRY_ADD) &gt;&gt; 26;
252         c3 -= (t0 &lt;&lt; 26);
253         c4 += t0;
254         //carry from position 4
255         t0 = (c4 + CARRY_ADD) &gt;&gt; 26;
256         c4 -= (t0 &lt;&lt; 26);
257         c5 += t0;
258         //carry from position 5
259         t0 = (c5 + CARRY_ADD) &gt;&gt; 26;
260         c5 -= (t0 &lt;&lt; 26);
261         c6 += t0;
262         //carry from position 6
263         t0 = (c6 + CARRY_ADD) &gt;&gt; 26;
264         c6 -= (t0 &lt;&lt; 26);
265         c7 += t0;
266         //carry from position 7
267         t0 = (c7 + CARRY_ADD) &gt;&gt; 26;
268         c7 -= (t0 &lt;&lt; 26);
269         c8 += t0;
270         //carry from position 8
271         t0 = (c8 + CARRY_ADD) &gt;&gt; 26;
272         c8 -= (t0 &lt;&lt; 26);
273         c9 += t0;
274 
275         r[0] = c0;
276         r[1] = c1;
277         r[2] = c2;
278         r[3] = c3;
279         r[4] = c4;
280         r[5] = c5;
281         r[6] = c6;
282         r[7] = c7;
283         r[8] = c8;
284         r[9] = c9;
285     }
286     @Override
287     protected void mult(long[] a, long[] b, long[] r) {
288         long c0 = (a[0] * b[0]);
289         long c1 = (a[0] * b[1]) + (a[1] * b[0]);
290         long c2 = (a[0] * b[2]) + (a[1] * b[1]) + (a[2] * b[0]);
291         long c3 = (a[0] * b[3]) + (a[1] * b[2]) + (a[2] * b[1]) + (a[3] * b[0]);
292         long c4 = (a[0] * b[4]) + (a[1] * b[3]) + (a[2] * b[2]) + (a[3] * b[1]) + (a[4] * b[0]);
293         long c5 = (a[0] * b[5]) + (a[1] * b[4]) + (a[2] * b[3]) + (a[3] * b[2]) + (a[4] * b[1]) + (a[5] * b[0]);
294         long c6 = (a[0] * b[6]) + (a[1] * b[5]) + (a[2] * b[4]) + (a[3] * b[3]) + (a[4] * b[2]) + (a[5] * b[1]) + (a[6] * b[0]);
295         long c7 = (a[0] * b[7]) + (a[1] * b[6]) + (a[2] * b[5]) + (a[3] * b[4]) + (a[4] * b[3]) + (a[5] * b[2]) + (a[6] * b[1]) + (a[7] * b[0]);
296         long c8 = (a[0] * b[8]) + (a[1] * b[7]) + (a[2] * b[6]) + (a[3] * b[5]) + (a[4] * b[4]) + (a[5] * b[3]) + (a[6] * b[2]) + (a[7] * b[1]) + (a[8] * b[0]);
297         long c9 = (a[0] * b[9]) + (a[1] * b[8]) + (a[2] * b[7]) + (a[3] * b[6]) + (a[4] * b[5]) + (a[5] * b[4]) + (a[6] * b[3]) + (a[7] * b[2]) + (a[8] * b[1]) + (a[9] * b[0]);
298         long c10 = (a[1] * b[9]) + (a[2] * b[8]) + (a[3] * b[7]) + (a[4] * b[6]) + (a[5] * b[5]) + (a[6] * b[4]) + (a[7] * b[3]) + (a[8] * b[2]) + (a[9] * b[1]);
299         long c11 = (a[2] * b[9]) + (a[3] * b[8]) + (a[4] * b[7]) + (a[5] * b[6]) + (a[6] * b[5]) + (a[7] * b[4]) + (a[8] * b[3]) + (a[9] * b[2]);
300         long c12 = (a[3] * b[9]) + (a[4] * b[8]) + (a[5] * b[7]) + (a[6] * b[6]) + (a[7] * b[5]) + (a[8] * b[4]) + (a[9] * b[3]);
301         long c13 = (a[4] * b[9]) + (a[5] * b[8]) + (a[6] * b[7]) + (a[7] * b[6]) + (a[8] * b[5]) + (a[9] * b[4]);
302         long c14 = (a[5] * b[9]) + (a[6] * b[8]) + (a[7] * b[7]) + (a[8] * b[6]) + (a[9] * b[5]);
303         long c15 = (a[6] * b[9]) + (a[7] * b[8]) + (a[8] * b[7]) + (a[9] * b[6]);
304         long c16 = (a[7] * b[9]) + (a[8] * b[8]) + (a[9] * b[7]);
305         long c17 = (a[8] * b[9]) + (a[9] * b[8]);
306         long c18 = (a[9] * b[9]);
307 
308         carryReduce(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18);
309     }
310     @Override
311     protected void reduce(long[] a) {
312         carryReduce(a, a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9]);
313     }
314     @Override
315     protected void square(long[] a, long[] r) {
316         long c0 = (a[0] * a[0]);
317         long c1 = 2 * ((a[0] * a[1]));
318         long c2 = 2 * ((a[0] * a[2])) + (a[1] * a[1]);
319         long c3 = 2 * ((a[0] * a[3]) + (a[1] * a[2]));
320         long c4 = 2 * ((a[0] * a[4]) + (a[1] * a[3])) + (a[2] * a[2]);
321         long c5 = 2 * ((a[0] * a[5]) + (a[1] * a[4]) + (a[2] * a[3]));
322         long c6 = 2 * ((a[0] * a[6]) + (a[1] * a[5]) + (a[2] * a[4])) + (a[3] * a[3]);
323         long c7 = 2 * ((a[0] * a[7]) + (a[1] * a[6]) + (a[2] * a[5]) + (a[3] * a[4]));
324         long c8 = 2 * ((a[0] * a[8]) + (a[1] * a[7]) + (a[2] * a[6]) + (a[3] * a[5])) + (a[4] * a[4]);
325         long c9 = 2 * ((a[0] * a[9]) + (a[1] * a[8]) + (a[2] * a[7]) + (a[3] * a[6]) + (a[4] * a[5]));
326         long c10 = 2 * ((a[1] * a[9]) + (a[2] * a[8]) + (a[3] * a[7]) + (a[4] * a[6])) + (a[5] * a[5]);
327         long c11 = 2 * ((a[2] * a[9]) + (a[3] * a[8]) + (a[4] * a[7]) + (a[5] * a[6]));
328         long c12 = 2 * ((a[3] * a[9]) + (a[4] * a[8]) + (a[5] * a[7])) + (a[6] * a[6]);
329         long c13 = 2 * ((a[4] * a[9]) + (a[5] * a[8]) + (a[6] * a[7]));
330         long c14 = 2 * ((a[5] * a[9]) + (a[6] * a[8])) + (a[7] * a[7]);
331         long c15 = 2 * ((a[6] * a[9]) + (a[7] * a[8]));
332         long c16 = 2 * ((a[7] * a[9])) + (a[8] * a[8]);
333         long c17 = 2 * ((a[8] * a[9]));
334         long c18 = (a[9] * a[9]);
335 
336         carryReduce(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18);
337     }
338 }
339 
    </pre>
  </body>
</html>