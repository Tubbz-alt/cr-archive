<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/sun/security/provider/certpath/URICertStore.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="SunCertPathBuilderException.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="X509CertPath.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/provider/certpath/URICertStore.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2006, 2015, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2006, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 121,27 ***</span>
  
      // Default maximum connect timeout in milliseconds (15 seconds)
      // allowed when downloading CRLs
      private static final int DEFAULT_CRL_CONNECT_TIMEOUT = 15000;
  
      /**
       * Integer value indicating the connect timeout, in seconds, to be
       * used for the CRL download. A timeout of zero is interpreted as
       * an infinite timeout.
       */
<span class="line-modified">!     private static final int CRL_CONNECT_TIMEOUT = initializeTimeout();</span>
  
      /**
<span class="line-modified">!      * Initialize the timeout length by getting the CRL timeout</span>
       * system property. If the property has not been set, or if its
<span class="line-modified">!      * value is negative, set the timeout length to the default.</span>
       */
<span class="line-modified">!     private static int initializeTimeout() {</span>
<span class="line-modified">!         Integer tmp = java.security.AccessController.doPrivileged(</span>
<span class="line-removed">-                 new GetIntegerAction(&quot;com.sun.security.crl.timeout&quot;));</span>
          if (tmp == null || tmp &lt; 0) {
<span class="line-modified">!             return DEFAULT_CRL_CONNECT_TIMEOUT;</span>
          }
          // Convert to milliseconds, as the system property will be
          // specified in seconds
          return tmp * 1000;
      }
<span class="line-new-header">--- 121,44 ---</span>
  
      // Default maximum connect timeout in milliseconds (15 seconds)
      // allowed when downloading CRLs
      private static final int DEFAULT_CRL_CONNECT_TIMEOUT = 15000;
  
<span class="line-added">+     // Default maximum read timeout in milliseconds (15 seconds)</span>
<span class="line-added">+     // allowed when downloading CRLs</span>
<span class="line-added">+     private static final int DEFAULT_CRL_READ_TIMEOUT = 15000;</span>
<span class="line-added">+ </span>
      /**
       * Integer value indicating the connect timeout, in seconds, to be
       * used for the CRL download. A timeout of zero is interpreted as
       * an infinite timeout.
       */
<span class="line-modified">!     private static final int CRL_CONNECT_TIMEOUT =</span>
<span class="line-added">+         initializeTimeout(&quot;com.sun.security.crl.timeout&quot;,</span>
<span class="line-added">+                           DEFAULT_CRL_CONNECT_TIMEOUT);</span>
  
      /**
<span class="line-modified">!      * Integer value indicating the read timeout, in seconds, to be</span>
<span class="line-added">+      * used for the CRL download. A timeout of zero is interpreted as</span>
<span class="line-added">+      * an infinite timeout.</span>
<span class="line-added">+      */</span>
<span class="line-added">+     private static final int CRL_READ_TIMEOUT =</span>
<span class="line-added">+         initializeTimeout(&quot;com.sun.security.crl.readtimeout&quot;,</span>
<span class="line-added">+                           DEFAULT_CRL_READ_TIMEOUT);</span>
<span class="line-added">+ </span>
<span class="line-added">+     /**</span>
<span class="line-added">+      * Initialize the timeout length by getting the specified CRL timeout</span>
       * system property. If the property has not been set, or if its
<span class="line-modified">!      * value is negative, set the timeout length to the specified default.</span>
       */
<span class="line-modified">!     private static int initializeTimeout(String prop, int def) {</span>
<span class="line-modified">!         Integer tmp = GetIntegerAction.privilegedGetProperty(prop);</span>
          if (tmp == null || tmp &lt; 0) {
<span class="line-modified">!             return def;</span>
<span class="line-added">+         }</span>
<span class="line-added">+         if (debug != null) {</span>
<span class="line-added">+             debug.println(prop + &quot; set to &quot; + tmp + &quot; seconds&quot;);</span>
          }
          // Convert to milliseconds, as the system property will be
          // specified in seconds
          return tmp * 1000;
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 362,10 ***</span>
<span class="line-new-header">--- 379,11 ---</span>
              if (lastModified != 0) {
                  connection.setIfModifiedSince(lastModified);
              }
              long oldLastModified = lastModified;
              connection.setConnectTimeout(CRL_CONNECT_TIMEOUT);
<span class="line-added">+             connection.setReadTimeout(CRL_READ_TIMEOUT);</span>
              try (InputStream in = connection.getInputStream()) {
                  lastModified = connection.getLastModified();
                  if (oldLastModified != 0) {
                      if (oldLastModified == lastModified) {
                          if (debug != null) {
</pre>
<center><a href="SunCertPathBuilderException.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="X509CertPath.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>