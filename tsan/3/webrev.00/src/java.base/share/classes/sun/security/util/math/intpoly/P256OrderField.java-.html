<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/java.base/share/classes/sun/security/util/math/intpoly/P256OrderField.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2018, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 /*
 27  * This file is generated by FieldGen.jsh. Do not modify it directly.
 28  */
 29 
 30 package sun.security.util.math.intpoly;
 31 
 32 import java.math.BigInteger;
 33 public class P256OrderField extends IntegerPolynomial {
 34     private static final int BITS_PER_LIMB = 26;
 35     private static final int NUM_LIMBS = 10;
 36     private static final int MAX_ADDS = 1;
 37     public static final BigInteger MODULUS = evaluateModulus();
 38     private static final long CARRY_ADD = 1 &lt;&lt; 25;
 39     private static final int LIMB_MASK = -1 &gt;&gt;&gt; (64 - BITS_PER_LIMB);
 40     public P256OrderField() {
 41 
 42         super(BITS_PER_LIMB, NUM_LIMBS, MAX_ADDS, MODULUS);
 43 
 44     }
 45     private static BigInteger evaluateModulus() {
 46         BigInteger result = BigInteger.valueOf(2).pow(256);
 47         result = result.add(BigInteger.valueOf(6497617));
 48         result = result.subtract(BigInteger.valueOf(2).pow(26).multiply(BigInteger.valueOf(26038081)));
 49         result = result.add(BigInteger.valueOf(2).pow(52).multiply(BigInteger.valueOf(32001852)));
 50         result = result.subtract(BigInteger.valueOf(2).pow(78).multiply(BigInteger.valueOf(21586850)));
 51         result = result.subtract(BigInteger.valueOf(2).pow(104).multiply(BigInteger.valueOf(4397317)));
 52         result = result.add(BigInteger.valueOf(2).pow(182).multiply(BigInteger.valueOf(1024)));
 53         result = result.subtract(BigInteger.valueOf(2).pow(208).multiply(BigInteger.valueOf(65536)));
 54         return result;
 55     }
 56     @Override
 57     protected void finalCarryReduceLast(long[] limbs) {
 58         long c = limbs[9] &gt;&gt; 22;
 59         limbs[9] -= c &lt;&lt; 22;
 60         long t0 = -6497617 * c;
 61         limbs[0] += t0;
 62         t0 = 26038081 * c;
 63         limbs[1] += t0;
 64         t0 = -32001852 * c;
 65         limbs[2] += t0;
 66         t0 = 21586850 * c;
 67         limbs[3] += t0;
 68         t0 = 4397317 * c;
 69         limbs[4] += t0;
 70         t0 = -1024 * c;
 71         limbs[7] += t0;
 72         t0 = 65536 * c;
 73         limbs[8] += t0;
 74     }
 75     private void carryReduce(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9, long c10, long c11, long c12, long c13, long c14, long c15, long c16, long c17, long c18) {
 76         long c19 = 0;
 77         //carry from position 0
 78         long t0 = (c0 + CARRY_ADD) &gt;&gt; 26;
 79         c0 -= (t0 &lt;&lt; 26);
 80         c1 += t0;
 81         //carry from position 1
 82         t0 = (c1 + CARRY_ADD) &gt;&gt; 26;
 83         c1 -= (t0 &lt;&lt; 26);
 84         c2 += t0;
 85         //carry from position 2
 86         t0 = (c2 + CARRY_ADD) &gt;&gt; 26;
 87         c2 -= (t0 &lt;&lt; 26);
 88         c3 += t0;
 89         //carry from position 3
 90         t0 = (c3 + CARRY_ADD) &gt;&gt; 26;
 91         c3 -= (t0 &lt;&lt; 26);
 92         c4 += t0;
 93         //carry from position 4
 94         t0 = (c4 + CARRY_ADD) &gt;&gt; 26;
 95         c4 -= (t0 &lt;&lt; 26);
 96         c5 += t0;
 97         //carry from position 5
 98         t0 = (c5 + CARRY_ADD) &gt;&gt; 26;
 99         c5 -= (t0 &lt;&lt; 26);
100         c6 += t0;
101         //carry from position 6
102         t0 = (c6 + CARRY_ADD) &gt;&gt; 26;
103         c6 -= (t0 &lt;&lt; 26);
104         c7 += t0;
105         //carry from position 7
106         t0 = (c7 + CARRY_ADD) &gt;&gt; 26;
107         c7 -= (t0 &lt;&lt; 26);
108         c8 += t0;
109         //carry from position 8
110         t0 = (c8 + CARRY_ADD) &gt;&gt; 26;
111         c8 -= (t0 &lt;&lt; 26);
112         c9 += t0;
113         //carry from position 9
114         t0 = (c9 + CARRY_ADD) &gt;&gt; 26;
115         c9 -= (t0 &lt;&lt; 26);
116         c10 += t0;
117         //carry from position 10
118         t0 = (c10 + CARRY_ADD) &gt;&gt; 26;
119         c10 -= (t0 &lt;&lt; 26);
120         c11 += t0;
121         //carry from position 11
122         t0 = (c11 + CARRY_ADD) &gt;&gt; 26;
123         c11 -= (t0 &lt;&lt; 26);
124         c12 += t0;
125         //carry from position 12
126         t0 = (c12 + CARRY_ADD) &gt;&gt; 26;
127         c12 -= (t0 &lt;&lt; 26);
128         c13 += t0;
129         //carry from position 13
130         t0 = (c13 + CARRY_ADD) &gt;&gt; 26;
131         c13 -= (t0 &lt;&lt; 26);
132         c14 += t0;
133         //carry from position 14
134         t0 = (c14 + CARRY_ADD) &gt;&gt; 26;
135         c14 -= (t0 &lt;&lt; 26);
136         c15 += t0;
137         //carry from position 15
138         t0 = (c15 + CARRY_ADD) &gt;&gt; 26;
139         c15 -= (t0 &lt;&lt; 26);
140         c16 += t0;
141         //carry from position 16
142         t0 = (c16 + CARRY_ADD) &gt;&gt; 26;
143         c16 -= (t0 &lt;&lt; 26);
144         c17 += t0;
145         //carry from position 17
146         t0 = (c17 + CARRY_ADD) &gt;&gt; 26;
147         c17 -= (t0 &lt;&lt; 26);
148         c18 += t0;
149         //carry from position 18
150         t0 = (c18 + CARRY_ADD) &gt;&gt; 26;
151         c18 -= (t0 &lt;&lt; 26);
152         c19 += t0;
153 
154         carryReduce0(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19);
155     }
156     void carryReduce0(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9, long c10, long c11, long c12, long c13, long c14, long c15, long c16, long c17, long c18, long c19) {
157         long t0;
158 
159         //reduce from position 19
160         t0 = -6497617 * c19;
161         c9 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
162         c10 += t0 &gt;&gt; 22;
163         t0 = 26038081 * c19;
164         c10 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
165         c11 += t0 &gt;&gt; 22;
166         t0 = -32001852 * c19;
167         c11 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
168         c12 += t0 &gt;&gt; 22;
169         t0 = 21586850 * c19;
170         c12 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
171         c13 += t0 &gt;&gt; 22;
172         t0 = 4397317 * c19;
173         c13 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
174         c14 += t0 &gt;&gt; 22;
175         t0 = -1024 * c19;
176         c16 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
177         c17 += t0 &gt;&gt; 22;
178         t0 = 65536 * c19;
179         c17 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
180         c18 += t0 &gt;&gt; 22;
181         //reduce from position 18
182         t0 = -6497617 * c18;
183         c8 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
184         c9 += t0 &gt;&gt; 22;
185         t0 = 26038081 * c18;
186         c9 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
187         c10 += t0 &gt;&gt; 22;
188         t0 = -32001852 * c18;
189         c10 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
190         c11 += t0 &gt;&gt; 22;
191         t0 = 21586850 * c18;
192         c11 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
193         c12 += t0 &gt;&gt; 22;
194         t0 = 4397317 * c18;
195         c12 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
196         c13 += t0 &gt;&gt; 22;
197         t0 = -1024 * c18;
198         c15 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
199         c16 += t0 &gt;&gt; 22;
200         t0 = 65536 * c18;
201         c16 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
202         c17 += t0 &gt;&gt; 22;
203         //reduce from position 17
204         t0 = -6497617 * c17;
205         c7 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
206         c8 += t0 &gt;&gt; 22;
207         t0 = 26038081 * c17;
208         c8 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
209         c9 += t0 &gt;&gt; 22;
210         t0 = -32001852 * c17;
211         c9 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
212         c10 += t0 &gt;&gt; 22;
213         t0 = 21586850 * c17;
214         c10 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
215         c11 += t0 &gt;&gt; 22;
216         t0 = 4397317 * c17;
217         c11 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
218         c12 += t0 &gt;&gt; 22;
219         t0 = -1024 * c17;
220         c14 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
221         c15 += t0 &gt;&gt; 22;
222         t0 = 65536 * c17;
223         c15 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
224         c16 += t0 &gt;&gt; 22;
225         //reduce from position 16
226         t0 = -6497617 * c16;
227         c6 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
228         c7 += t0 &gt;&gt; 22;
229         t0 = 26038081 * c16;
230         c7 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
231         c8 += t0 &gt;&gt; 22;
232         t0 = -32001852 * c16;
233         c8 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
234         c9 += t0 &gt;&gt; 22;
235         t0 = 21586850 * c16;
236         c9 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
237         c10 += t0 &gt;&gt; 22;
238         t0 = 4397317 * c16;
239         c10 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
240         c11 += t0 &gt;&gt; 22;
241         t0 = -1024 * c16;
242         c13 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
243         c14 += t0 &gt;&gt; 22;
244         t0 = 65536 * c16;
245         c14 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
246         c15 += t0 &gt;&gt; 22;
247         //reduce from position 15
248         t0 = -6497617 * c15;
249         c5 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
250         c6 += t0 &gt;&gt; 22;
251         t0 = 26038081 * c15;
252         c6 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
253         c7 += t0 &gt;&gt; 22;
254         t0 = -32001852 * c15;
255         c7 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
256         c8 += t0 &gt;&gt; 22;
257         t0 = 21586850 * c15;
258         c8 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
259         c9 += t0 &gt;&gt; 22;
260         t0 = 4397317 * c15;
261         c9 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
262         c10 += t0 &gt;&gt; 22;
263         t0 = -1024 * c15;
264         c12 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
265         c13 += t0 &gt;&gt; 22;
266         t0 = 65536 * c15;
267         c13 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
268         c14 += t0 &gt;&gt; 22;
269         //reduce from position 14
270         t0 = -6497617 * c14;
271         c4 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
272         c5 += t0 &gt;&gt; 22;
273         t0 = 26038081 * c14;
274         c5 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
275         c6 += t0 &gt;&gt; 22;
276         t0 = -32001852 * c14;
277         c6 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
278         c7 += t0 &gt;&gt; 22;
279         t0 = 21586850 * c14;
280         c7 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
281         c8 += t0 &gt;&gt; 22;
282         t0 = 4397317 * c14;
283         c8 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
284         c9 += t0 &gt;&gt; 22;
285         t0 = -1024 * c14;
286         c11 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
287         c12 += t0 &gt;&gt; 22;
288         t0 = 65536 * c14;
289         c12 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
290         c13 += t0 &gt;&gt; 22;
291         //reduce from position 13
292         t0 = -6497617 * c13;
293         c3 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
294         c4 += t0 &gt;&gt; 22;
295         t0 = 26038081 * c13;
296         c4 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
297         c5 += t0 &gt;&gt; 22;
298         t0 = -32001852 * c13;
299         c5 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
300         c6 += t0 &gt;&gt; 22;
301         t0 = 21586850 * c13;
302         c6 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
303         c7 += t0 &gt;&gt; 22;
304         t0 = 4397317 * c13;
305         c7 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
306         c8 += t0 &gt;&gt; 22;
307         t0 = -1024 * c13;
308         c10 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
309         c11 += t0 &gt;&gt; 22;
310         t0 = 65536 * c13;
311         c11 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
312         c12 += t0 &gt;&gt; 22;
313         //reduce from position 12
314         t0 = -6497617 * c12;
315         c2 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
316         c3 += t0 &gt;&gt; 22;
317         t0 = 26038081 * c12;
318         c3 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
319         c4 += t0 &gt;&gt; 22;
320         t0 = -32001852 * c12;
321         c4 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
322         c5 += t0 &gt;&gt; 22;
323         t0 = 21586850 * c12;
324         c5 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
325         c6 += t0 &gt;&gt; 22;
326         t0 = 4397317 * c12;
327         c6 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
328         c7 += t0 &gt;&gt; 22;
329         t0 = -1024 * c12;
330         c9 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
331         c10 += t0 &gt;&gt; 22;
332         t0 = 65536 * c12;
333         c10 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
334         c11 += t0 &gt;&gt; 22;
335         //reduce from position 11
336         t0 = -6497617 * c11;
337         c1 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
338         c2 += t0 &gt;&gt; 22;
339         t0 = 26038081 * c11;
340         c2 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
341         c3 += t0 &gt;&gt; 22;
342         t0 = -32001852 * c11;
343         c3 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
344         c4 += t0 &gt;&gt; 22;
345         t0 = 21586850 * c11;
346         c4 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
347         c5 += t0 &gt;&gt; 22;
348         t0 = 4397317 * c11;
349         c5 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
350         c6 += t0 &gt;&gt; 22;
351         t0 = -1024 * c11;
352         c8 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
353         c9 += t0 &gt;&gt; 22;
354         t0 = 65536 * c11;
355         c9 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
356         c10 += t0 &gt;&gt; 22;
357         //reduce from position 10
358         t0 = -6497617 * c10;
359         c0 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
360         c1 += t0 &gt;&gt; 22;
361         t0 = 26038081 * c10;
362         c1 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
363         c2 += t0 &gt;&gt; 22;
364         t0 = -32001852 * c10;
365         c2 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
366         c3 += t0 &gt;&gt; 22;
367         t0 = 21586850 * c10;
368         c3 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
369         c4 += t0 &gt;&gt; 22;
370         t0 = 4397317 * c10;
371         c4 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
372         c5 += t0 &gt;&gt; 22;
373         t0 = -1024 * c10;
374         c7 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
375         c8 += t0 &gt;&gt; 22;
376         t0 = 65536 * c10;
377         c8 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
378         c9 += t0 &gt;&gt; 22;
379         c10 = 0;
380 
381         carryReduce1(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19);
382     }
383     void carryReduce1(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9, long c10, long c11, long c12, long c13, long c14, long c15, long c16, long c17, long c18, long c19) {
384         long t0;
385 
386         //carry from position 0
387         t0 = (c0 + CARRY_ADD) &gt;&gt; 26;
388         c0 -= (t0 &lt;&lt; 26);
389         c1 += t0;
390         //carry from position 1
391         t0 = (c1 + CARRY_ADD) &gt;&gt; 26;
392         c1 -= (t0 &lt;&lt; 26);
393         c2 += t0;
394         //carry from position 2
395         t0 = (c2 + CARRY_ADD) &gt;&gt; 26;
396         c2 -= (t0 &lt;&lt; 26);
397         c3 += t0;
398         //carry from position 3
399         t0 = (c3 + CARRY_ADD) &gt;&gt; 26;
400         c3 -= (t0 &lt;&lt; 26);
401         c4 += t0;
402         //carry from position 4
403         t0 = (c4 + CARRY_ADD) &gt;&gt; 26;
404         c4 -= (t0 &lt;&lt; 26);
405         c5 += t0;
406         //carry from position 5
407         t0 = (c5 + CARRY_ADD) &gt;&gt; 26;
408         c5 -= (t0 &lt;&lt; 26);
409         c6 += t0;
410         //carry from position 6
411         t0 = (c6 + CARRY_ADD) &gt;&gt; 26;
412         c6 -= (t0 &lt;&lt; 26);
413         c7 += t0;
414         //carry from position 7
415         t0 = (c7 + CARRY_ADD) &gt;&gt; 26;
416         c7 -= (t0 &lt;&lt; 26);
417         c8 += t0;
418         //carry from position 8
419         t0 = (c8 + CARRY_ADD) &gt;&gt; 26;
420         c8 -= (t0 &lt;&lt; 26);
421         c9 += t0;
422         //carry from position 9
423         t0 = (c9 + CARRY_ADD) &gt;&gt; 26;
424         c9 -= (t0 &lt;&lt; 26);
425         c10 += t0;
426 
427         carryReduce2(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19);
428     }
429     void carryReduce2(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9, long c10, long c11, long c12, long c13, long c14, long c15, long c16, long c17, long c18, long c19) {
430         long t0;
431 
432         //reduce from position 10
433         t0 = -6497617 * c10;
434         c0 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
435         c1 += t0 &gt;&gt; 22;
436         t0 = 26038081 * c10;
437         c1 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
438         c2 += t0 &gt;&gt; 22;
439         t0 = -32001852 * c10;
440         c2 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
441         c3 += t0 &gt;&gt; 22;
442         t0 = 21586850 * c10;
443         c3 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
444         c4 += t0 &gt;&gt; 22;
445         t0 = 4397317 * c10;
446         c4 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
447         c5 += t0 &gt;&gt; 22;
448         t0 = -1024 * c10;
449         c7 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
450         c8 += t0 &gt;&gt; 22;
451         t0 = 65536 * c10;
452         c8 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
453         c9 += t0 &gt;&gt; 22;
454         //carry from position 0
455         t0 = (c0 + CARRY_ADD) &gt;&gt; 26;
456         c0 -= (t0 &lt;&lt; 26);
457         c1 += t0;
458         //carry from position 1
459         t0 = (c1 + CARRY_ADD) &gt;&gt; 26;
460         c1 -= (t0 &lt;&lt; 26);
461         c2 += t0;
462         //carry from position 2
463         t0 = (c2 + CARRY_ADD) &gt;&gt; 26;
464         c2 -= (t0 &lt;&lt; 26);
465         c3 += t0;
466         //carry from position 3
467         t0 = (c3 + CARRY_ADD) &gt;&gt; 26;
468         c3 -= (t0 &lt;&lt; 26);
469         c4 += t0;
470         //carry from position 4
471         t0 = (c4 + CARRY_ADD) &gt;&gt; 26;
472         c4 -= (t0 &lt;&lt; 26);
473         c5 += t0;
474         //carry from position 5
475         t0 = (c5 + CARRY_ADD) &gt;&gt; 26;
476         c5 -= (t0 &lt;&lt; 26);
477         c6 += t0;
478         //carry from position 6
479         t0 = (c6 + CARRY_ADD) &gt;&gt; 26;
480         c6 -= (t0 &lt;&lt; 26);
481         c7 += t0;
482         //carry from position 7
483         t0 = (c7 + CARRY_ADD) &gt;&gt; 26;
484         c7 -= (t0 &lt;&lt; 26);
485         c8 += t0;
486         //carry from position 8
487         t0 = (c8 + CARRY_ADD) &gt;&gt; 26;
488         c8 -= (t0 &lt;&lt; 26);
489         c9 += t0;
490 
491         r[0] = c0;
492         r[1] = c1;
493         r[2] = c2;
494         r[3] = c3;
495         r[4] = c4;
496         r[5] = c5;
497         r[6] = c6;
498         r[7] = c7;
499         r[8] = c8;
500         r[9] = c9;
501     }
502     private void carryReduce(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9) {
503         long c10 = 0;
504         //carry from position 0
505         long t0 = (c0 + CARRY_ADD) &gt;&gt; 26;
506         c0 -= (t0 &lt;&lt; 26);
507         c1 += t0;
508         //carry from position 1
509         t0 = (c1 + CARRY_ADD) &gt;&gt; 26;
510         c1 -= (t0 &lt;&lt; 26);
511         c2 += t0;
512         //carry from position 2
513         t0 = (c2 + CARRY_ADD) &gt;&gt; 26;
514         c2 -= (t0 &lt;&lt; 26);
515         c3 += t0;
516         //carry from position 3
517         t0 = (c3 + CARRY_ADD) &gt;&gt; 26;
518         c3 -= (t0 &lt;&lt; 26);
519         c4 += t0;
520         //carry from position 4
521         t0 = (c4 + CARRY_ADD) &gt;&gt; 26;
522         c4 -= (t0 &lt;&lt; 26);
523         c5 += t0;
524         //carry from position 5
525         t0 = (c5 + CARRY_ADD) &gt;&gt; 26;
526         c5 -= (t0 &lt;&lt; 26);
527         c6 += t0;
528         //carry from position 6
529         t0 = (c6 + CARRY_ADD) &gt;&gt; 26;
530         c6 -= (t0 &lt;&lt; 26);
531         c7 += t0;
532         //carry from position 7
533         t0 = (c7 + CARRY_ADD) &gt;&gt; 26;
534         c7 -= (t0 &lt;&lt; 26);
535         c8 += t0;
536         //carry from position 8
537         t0 = (c8 + CARRY_ADD) &gt;&gt; 26;
538         c8 -= (t0 &lt;&lt; 26);
539         c9 += t0;
540         //carry from position 9
541         t0 = (c9 + CARRY_ADD) &gt;&gt; 26;
542         c9 -= (t0 &lt;&lt; 26);
543         c10 += t0;
544 
545         carryReduce0(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10);
546     }
547     void carryReduce0(long[] r, long c0, long c1, long c2, long c3, long c4, long c5, long c6, long c7, long c8, long c9, long c10) {
548         long t0;
549 
550         //reduce from position 10
551         t0 = -6497617 * c10;
552         c0 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
553         c1 += t0 &gt;&gt; 22;
554         t0 = 26038081 * c10;
555         c1 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
556         c2 += t0 &gt;&gt; 22;
557         t0 = -32001852 * c10;
558         c2 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
559         c3 += t0 &gt;&gt; 22;
560         t0 = 21586850 * c10;
561         c3 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
562         c4 += t0 &gt;&gt; 22;
563         t0 = 4397317 * c10;
564         c4 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
565         c5 += t0 &gt;&gt; 22;
566         t0 = -1024 * c10;
567         c7 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
568         c8 += t0 &gt;&gt; 22;
569         t0 = 65536 * c10;
570         c8 += (t0 &lt;&lt; 4) &amp; LIMB_MASK;
571         c9 += t0 &gt;&gt; 22;
572         //carry from position 0
573         t0 = (c0 + CARRY_ADD) &gt;&gt; 26;
574         c0 -= (t0 &lt;&lt; 26);
575         c1 += t0;
576         //carry from position 1
577         t0 = (c1 + CARRY_ADD) &gt;&gt; 26;
578         c1 -= (t0 &lt;&lt; 26);
579         c2 += t0;
580         //carry from position 2
581         t0 = (c2 + CARRY_ADD) &gt;&gt; 26;
582         c2 -= (t0 &lt;&lt; 26);
583         c3 += t0;
584         //carry from position 3
585         t0 = (c3 + CARRY_ADD) &gt;&gt; 26;
586         c3 -= (t0 &lt;&lt; 26);
587         c4 += t0;
588         //carry from position 4
589         t0 = (c4 + CARRY_ADD) &gt;&gt; 26;
590         c4 -= (t0 &lt;&lt; 26);
591         c5 += t0;
592         //carry from position 5
593         t0 = (c5 + CARRY_ADD) &gt;&gt; 26;
594         c5 -= (t0 &lt;&lt; 26);
595         c6 += t0;
596         //carry from position 6
597         t0 = (c6 + CARRY_ADD) &gt;&gt; 26;
598         c6 -= (t0 &lt;&lt; 26);
599         c7 += t0;
600         //carry from position 7
601         t0 = (c7 + CARRY_ADD) &gt;&gt; 26;
602         c7 -= (t0 &lt;&lt; 26);
603         c8 += t0;
604         //carry from position 8
605         t0 = (c8 + CARRY_ADD) &gt;&gt; 26;
606         c8 -= (t0 &lt;&lt; 26);
607         c9 += t0;
608 
609         r[0] = c0;
610         r[1] = c1;
611         r[2] = c2;
612         r[3] = c3;
613         r[4] = c4;
614         r[5] = c5;
615         r[6] = c6;
616         r[7] = c7;
617         r[8] = c8;
618         r[9] = c9;
619     }
620     @Override
621     protected void mult(long[] a, long[] b, long[] r) {
622         long c0 = (a[0] * b[0]);
623         long c1 = (a[0] * b[1]) + (a[1] * b[0]);
624         long c2 = (a[0] * b[2]) + (a[1] * b[1]) + (a[2] * b[0]);
625         long c3 = (a[0] * b[3]) + (a[1] * b[2]) + (a[2] * b[1]) + (a[3] * b[0]);
626         long c4 = (a[0] * b[4]) + (a[1] * b[3]) + (a[2] * b[2]) + (a[3] * b[1]) + (a[4] * b[0]);
627         long c5 = (a[0] * b[5]) + (a[1] * b[4]) + (a[2] * b[3]) + (a[3] * b[2]) + (a[4] * b[1]) + (a[5] * b[0]);
628         long c6 = (a[0] * b[6]) + (a[1] * b[5]) + (a[2] * b[4]) + (a[3] * b[3]) + (a[4] * b[2]) + (a[5] * b[1]) + (a[6] * b[0]);
629         long c7 = (a[0] * b[7]) + (a[1] * b[6]) + (a[2] * b[5]) + (a[3] * b[4]) + (a[4] * b[3]) + (a[5] * b[2]) + (a[6] * b[1]) + (a[7] * b[0]);
630         long c8 = (a[0] * b[8]) + (a[1] * b[7]) + (a[2] * b[6]) + (a[3] * b[5]) + (a[4] * b[4]) + (a[5] * b[3]) + (a[6] * b[2]) + (a[7] * b[1]) + (a[8] * b[0]);
631         long c9 = (a[0] * b[9]) + (a[1] * b[8]) + (a[2] * b[7]) + (a[3] * b[6]) + (a[4] * b[5]) + (a[5] * b[4]) + (a[6] * b[3]) + (a[7] * b[2]) + (a[8] * b[1]) + (a[9] * b[0]);
632         long c10 = (a[1] * b[9]) + (a[2] * b[8]) + (a[3] * b[7]) + (a[4] * b[6]) + (a[5] * b[5]) + (a[6] * b[4]) + (a[7] * b[3]) + (a[8] * b[2]) + (a[9] * b[1]);
633         long c11 = (a[2] * b[9]) + (a[3] * b[8]) + (a[4] * b[7]) + (a[5] * b[6]) + (a[6] * b[5]) + (a[7] * b[4]) + (a[8] * b[3]) + (a[9] * b[2]);
634         long c12 = (a[3] * b[9]) + (a[4] * b[8]) + (a[5] * b[7]) + (a[6] * b[6]) + (a[7] * b[5]) + (a[8] * b[4]) + (a[9] * b[3]);
635         long c13 = (a[4] * b[9]) + (a[5] * b[8]) + (a[6] * b[7]) + (a[7] * b[6]) + (a[8] * b[5]) + (a[9] * b[4]);
636         long c14 = (a[5] * b[9]) + (a[6] * b[8]) + (a[7] * b[7]) + (a[8] * b[6]) + (a[9] * b[5]);
637         long c15 = (a[6] * b[9]) + (a[7] * b[8]) + (a[8] * b[7]) + (a[9] * b[6]);
638         long c16 = (a[7] * b[9]) + (a[8] * b[8]) + (a[9] * b[7]);
639         long c17 = (a[8] * b[9]) + (a[9] * b[8]);
640         long c18 = (a[9] * b[9]);
641 
642         carryReduce(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18);
643     }
644     @Override
645     protected void reduce(long[] a) {
646         carryReduce(a, a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9]);
647     }
648     @Override
649     protected void square(long[] a, long[] r) {
650         long c0 = (a[0] * a[0]);
651         long c1 = 2 * ((a[0] * a[1]));
652         long c2 = 2 * ((a[0] * a[2])) + (a[1] * a[1]);
653         long c3 = 2 * ((a[0] * a[3]) + (a[1] * a[2]));
654         long c4 = 2 * ((a[0] * a[4]) + (a[1] * a[3])) + (a[2] * a[2]);
655         long c5 = 2 * ((a[0] * a[5]) + (a[1] * a[4]) + (a[2] * a[3]));
656         long c6 = 2 * ((a[0] * a[6]) + (a[1] * a[5]) + (a[2] * a[4])) + (a[3] * a[3]);
657         long c7 = 2 * ((a[0] * a[7]) + (a[1] * a[6]) + (a[2] * a[5]) + (a[3] * a[4]));
658         long c8 = 2 * ((a[0] * a[8]) + (a[1] * a[7]) + (a[2] * a[6]) + (a[3] * a[5])) + (a[4] * a[4]);
659         long c9 = 2 * ((a[0] * a[9]) + (a[1] * a[8]) + (a[2] * a[7]) + (a[3] * a[6]) + (a[4] * a[5]));
660         long c10 = 2 * ((a[1] * a[9]) + (a[2] * a[8]) + (a[3] * a[7]) + (a[4] * a[6])) + (a[5] * a[5]);
661         long c11 = 2 * ((a[2] * a[9]) + (a[3] * a[8]) + (a[4] * a[7]) + (a[5] * a[6]));
662         long c12 = 2 * ((a[3] * a[9]) + (a[4] * a[8]) + (a[5] * a[7])) + (a[6] * a[6]);
663         long c13 = 2 * ((a[4] * a[9]) + (a[5] * a[8]) + (a[6] * a[7]));
664         long c14 = 2 * ((a[5] * a[9]) + (a[6] * a[8])) + (a[7] * a[7]);
665         long c15 = 2 * ((a[6] * a[9]) + (a[7] * a[8]));
666         long c16 = 2 * ((a[7] * a[9])) + (a[8] * a[8]);
667         long c17 = 2 * ((a[8] * a[9]));
668         long c18 = (a[9] * a[9]);
669 
670         carryReduce(r, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18);
671     }
672 }
673 
    </pre>
  </body>
</html>