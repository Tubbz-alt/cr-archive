<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.base/share/classes/sun/security/ssl/SupportedGroupsExtension.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="SunX509KeyManagerImpl.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="TransportContext.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/ssl/SupportedGroupsExtension.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -26,35 +26,25 @@</span>
  package sun.security.ssl;
  
  import java.io.IOException;
  import java.nio.ByteBuffer;
  import java.security.AlgorithmConstraints;
<span class="udiff-line-removed">- import java.security.AlgorithmParameters;</span>
<span class="udiff-line-removed">- import java.security.CryptoPrimitive;</span>
<span class="udiff-line-removed">- import java.security.NoSuchAlgorithmException;</span>
<span class="udiff-line-removed">- import java.security.spec.AlgorithmParameterSpec;</span>
<span class="udiff-line-removed">- import java.security.spec.ECGenParameterSpec;</span>
<span class="udiff-line-removed">- import java.security.spec.ECParameterSpec;</span>
<span class="udiff-line-removed">- import java.security.spec.InvalidParameterSpecException;</span>
  import java.text.MessageFormat;
  import java.util.ArrayList;
  import java.util.Collections;
<span class="udiff-line-removed">- import java.util.EnumSet;</span>
<span class="udiff-line-removed">- import java.util.HashMap;</span>
  import java.util.LinkedList;
  import java.util.List;
  import java.util.Locale;
<span class="udiff-line-removed">- import java.util.Map;</span>
<span class="udiff-line-removed">- import javax.crypto.spec.DHParameterSpec;</span>
  import javax.net.ssl.SSLProtocolException;
  import sun.security.action.GetPropertyAction;
<span class="udiff-line-added">+ import sun.security.ssl.NamedGroup.NamedGroupSpec;</span>
  import static sun.security.ssl.SSLExtension.CH_SUPPORTED_GROUPS;
  import static sun.security.ssl.SSLExtension.EE_SUPPORTED_GROUPS;
  import sun.security.ssl.SSLExtension.ExtensionConsumer;
  import sun.security.ssl.SSLExtension.SSLExtensionSpec;
  import sun.security.ssl.SSLHandshake.HandshakeMessage;
<span class="udiff-line-modified-removed">- import sun.security.util.ECUtil;</span>
<span class="udiff-line-modified-added">+ </span>
  
  /**
   * Pack of the &quot;supported_groups&quot; extensions [RFC 4492/7919].
   */
  final class SupportedGroupsExtension {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -156,324 +146,15 @@</span>
                  return ioe.getMessage();
              }
          }
      }
  
<span class="udiff-line-removed">-     static enum NamedGroupType {</span>
<span class="udiff-line-removed">-         NAMED_GROUP_ECDHE     (&quot;EC&quot;),</span>
<span class="udiff-line-removed">-         NAMED_GROUP_FFDHE     (&quot;DiffieHellman&quot;),</span>
<span class="udiff-line-removed">-         NAMED_GROUP_X25519    (&quot;x25519&quot;),</span>
<span class="udiff-line-removed">-         NAMED_GROUP_X448      (&quot;x448&quot;),</span>
<span class="udiff-line-removed">-         NAMED_GROUP_ARBITRARY (&quot;EC&quot;),</span>
<span class="udiff-line-removed">-         NAMED_GROUP_NONE      (&quot;&quot;);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         private final String algorithm;</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         private NamedGroupType(String algorithm) {</span>
<span class="udiff-line-removed">-             this.algorithm = algorithm;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         boolean isSupported(List&lt;CipherSuite&gt; cipherSuites) {</span>
<span class="udiff-line-removed">-             for (CipherSuite cs : cipherSuites) {</span>
<span class="udiff-line-removed">-                 if (cs.keyExchange == null ||</span>
<span class="udiff-line-removed">-                         cs.keyExchange.groupType == this) {</span>
<span class="udiff-line-removed">-                     return true;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             return false;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     static enum NamedGroup {</span>
<span class="udiff-line-removed">-         // Elliptic Curves (RFC 4492)</span>
<span class="udiff-line-removed">-         //</span>
<span class="udiff-line-removed">-         // See sun.security.util.CurveDB for the OIDs</span>
<span class="udiff-line-removed">-         // NIST K-163</span>
<span class="udiff-line-removed">-         SECT163_K1  (0x0001, &quot;sect163k1&quot;, &quot;1.3.132.0.1&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">-         SECT163_R1  (0x0002, &quot;sect163r1&quot;, &quot;1.3.132.0.2&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // NIST B-163</span>
<span class="udiff-line-removed">-         SECT163_R2  (0x0003, &quot;sect163r2&quot;, &quot;1.3.132.0.15&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">-         SECT193_R1  (0x0004, &quot;sect193r1&quot;, &quot;1.3.132.0.24&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">-         SECT193_R2  (0x0005, &quot;sect193r2&quot;, &quot;1.3.132.0.25&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // NIST K-233</span>
<span class="udiff-line-removed">-         SECT233_K1  (0x0006, &quot;sect233k1&quot;, &quot;1.3.132.0.26&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // NIST B-233</span>
<span class="udiff-line-removed">-         SECT233_R1  (0x0007, &quot;sect233r1&quot;, &quot;1.3.132.0.27&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">-         SECT239_K1  (0x0008, &quot;sect239k1&quot;, &quot;1.3.132.0.3&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // NIST K-283</span>
<span class="udiff-line-removed">-         SECT283_K1  (0x0009, &quot;sect283k1&quot;, &quot;1.3.132.0.16&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // NIST B-283</span>
<span class="udiff-line-removed">-         SECT283_R1  (0x000A, &quot;sect283r1&quot;, &quot;1.3.132.0.17&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // NIST K-409</span>
<span class="udiff-line-removed">-         SECT409_K1  (0x000B, &quot;sect409k1&quot;, &quot;1.3.132.0.36&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // NIST B-409</span>
<span class="udiff-line-removed">-         SECT409_R1  (0x000C, &quot;sect409r1&quot;, &quot;1.3.132.0.37&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // NIST K-571</span>
<span class="udiff-line-removed">-         SECT571_K1  (0x000D, &quot;sect571k1&quot;, &quot;1.3.132.0.38&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // NIST B-571</span>
<span class="udiff-line-removed">-         SECT571_R1  (0x000E, &quot;sect571r1&quot;, &quot;1.3.132.0.39&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">-         SECP160_K1  (0x000F, &quot;secp160k1&quot;, &quot;1.3.132.0.9&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">-         SECP160_R1  (0x0010, &quot;secp160r1&quot;, &quot;1.3.132.0.8&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">-         SECP160_R2  (0x0011, &quot;secp160r2&quot;, &quot;1.3.132.0.30&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">-         SECP192_K1  (0x0012, &quot;secp192k1&quot;, &quot;1.3.132.0.31&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // NIST P-192</span>
<span class="udiff-line-removed">-         SECP192_R1  (0x0013, &quot;secp192r1&quot;, &quot;1.2.840.10045.3.1.1&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">-         SECP224_K1  (0x0014, &quot;secp224k1&quot;, &quot;1.3.132.0.32&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">-         // NIST P-224</span>
<span class="udiff-line-removed">-         SECP224_R1  (0x0015, &quot;secp224r1&quot;, &quot;1.3.132.0.33&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">-         SECP256_K1  (0x0016, &quot;secp256k1&quot;, &quot;1.3.132.0.10&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // NIST P-256</span>
<span class="udiff-line-removed">-         SECP256_R1  (0x0017, &quot;secp256r1&quot;, &quot;1.2.840.10045.3.1.7&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_13),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // NIST P-384</span>
<span class="udiff-line-removed">-         SECP384_R1  (0x0018, &quot;secp384r1&quot;, &quot;1.3.132.0.34&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_13),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // NIST P-521</span>
<span class="udiff-line-removed">-         SECP521_R1  (0x0019, &quot;secp521r1&quot;, &quot;1.3.132.0.35&quot;,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ECDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_13),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // x25519 and x448</span>
<span class="udiff-line-removed">-         X25519      (0x001D, &quot;x25519&quot;, null,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_X25519,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_13),</span>
<span class="udiff-line-removed">-         X448        (0x001E, &quot;x448&quot;, null,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_X448,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_13),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // Finite Field Diffie-Hellman Ephemeral Parameters (RFC 7919)</span>
<span class="udiff-line-removed">-         FFDHE_2048  (0x0100, &quot;ffdhe2048&quot;, null,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_FFDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_13),</span>
<span class="udiff-line-removed">-         FFDHE_3072  (0x0101, &quot;ffdhe3072&quot;, null,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_FFDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_13),</span>
<span class="udiff-line-removed">-         FFDHE_4096  (0x0102, &quot;ffdhe4096&quot;, null,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_FFDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_13),</span>
<span class="udiff-line-removed">-         FFDHE_6144  (0x0103, &quot;ffdhe6144&quot;, null,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_FFDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_13),</span>
<span class="udiff-line-removed">-         FFDHE_8192  (0x0104, &quot;ffdhe8192&quot;, null,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_FFDHE,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_13),</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // Elliptic Curves (RFC 4492)</span>
<span class="udiff-line-removed">-         //</span>
<span class="udiff-line-removed">-         // arbitrary prime and characteristic-2 curves</span>
<span class="udiff-line-removed">-         ARBITRARY_PRIME  (0xFF01, &quot;arbitrary_explicit_prime_curves&quot;, null,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ARBITRARY,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12),</span>
<span class="udiff-line-removed">-         ARBITRARY_CHAR2  (0xFF02, &quot;arbitrary_explicit_char2_curves&quot;, null,</span>
<span class="udiff-line-removed">-                             NamedGroupType.NAMED_GROUP_ARBITRARY,</span>
<span class="udiff-line-removed">-                             ProtocolVersion.PROTOCOLS_TO_12);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         final int id;               // hash + signature</span>
<span class="udiff-line-removed">-         final NamedGroupType type;  // group type</span>
<span class="udiff-line-removed">-         final String name;          // literal name</span>
<span class="udiff-line-removed">-         final String oid;           // object identifier of the named group</span>
<span class="udiff-line-removed">-         final String algorithm;     // signature algorithm</span>
<span class="udiff-line-removed">-         final ProtocolVersion[] supportedProtocols;</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         private NamedGroup(int id, String name, String oid,</span>
<span class="udiff-line-removed">-                 NamedGroupType namedGroupType,</span>
<span class="udiff-line-removed">-                 ProtocolVersion[] supportedProtocols) {</span>
<span class="udiff-line-removed">-             this.id = id;</span>
<span class="udiff-line-removed">-             this.type = namedGroupType;</span>
<span class="udiff-line-removed">-             this.name = name;</span>
<span class="udiff-line-removed">-             this.oid = oid;</span>
<span class="udiff-line-removed">-             this.algorithm = namedGroupType.algorithm;</span>
<span class="udiff-line-removed">-             this.supportedProtocols = supportedProtocols;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         static NamedGroup valueOf(int id) {</span>
<span class="udiff-line-removed">-             for (NamedGroup group : NamedGroup.values()) {</span>
<span class="udiff-line-removed">-                 if (group.id == id) {</span>
<span class="udiff-line-removed">-                     return group;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             return null;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         static NamedGroup valueOf(ECParameterSpec params) {</span>
<span class="udiff-line-removed">-             String oid = ECUtil.getCurveName(null, params);</span>
<span class="udiff-line-removed">-             if ((oid != null) &amp;&amp; (!oid.isEmpty())) {</span>
<span class="udiff-line-removed">-                 for (NamedGroup group : NamedGroup.values()) {</span>
<span class="udiff-line-removed">-                     if ((group.type == NamedGroupType.NAMED_GROUP_ECDHE) &amp;&amp;</span>
<span class="udiff-line-removed">-                             oid.equals(group.oid)) {</span>
<span class="udiff-line-removed">-                         return group;</span>
<span class="udiff-line-removed">-                     }</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             return null;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         static NamedGroup valueOf(DHParameterSpec params) {</span>
<span class="udiff-line-removed">-             for (Map.Entry&lt;NamedGroup, AlgorithmParameters&gt; me :</span>
<span class="udiff-line-removed">-                     SupportedGroups.namedGroupParams.entrySet()) {</span>
<span class="udiff-line-removed">-                 NamedGroup ng = me.getKey();</span>
<span class="udiff-line-removed">-                 if (ng.type != NamedGroupType.NAMED_GROUP_FFDHE) {</span>
<span class="udiff-line-removed">-                     continue;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-                 DHParameterSpec ngParams = null;</span>
<span class="udiff-line-removed">-                 AlgorithmParameters aps = me.getValue();</span>
<span class="udiff-line-removed">-                 try {</span>
<span class="udiff-line-removed">-                     ngParams = aps.getParameterSpec(DHParameterSpec.class);</span>
<span class="udiff-line-removed">-                 } catch (InvalidParameterSpecException ipse) {</span>
<span class="udiff-line-removed">-                     // should be unlikely</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-                 if (ngParams == null) {</span>
<span class="udiff-line-removed">-                     continue;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-                 if (ngParams.getP().equals(params.getP()) &amp;&amp;</span>
<span class="udiff-line-removed">-                         ngParams.getG().equals(params.getG())) {</span>
<span class="udiff-line-removed">-                     return ng;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             return null;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         static NamedGroup nameOf(String name) {</span>
<span class="udiff-line-removed">-             for (NamedGroup group : NamedGroup.values()) {</span>
<span class="udiff-line-removed">-                 if (group.name.equals(name)) {</span>
<span class="udiff-line-removed">-                     return group;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             return null;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         static String nameOf(int id) {</span>
<span class="udiff-line-removed">-             for (NamedGroup group : NamedGroup.values()) {</span>
<span class="udiff-line-removed">-                 if (group.id == id) {</span>
<span class="udiff-line-removed">-                     return group.name;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             return &quot;UNDEFINED-NAMED-GROUP(&quot; + id + &quot;)&quot;;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         boolean isAvailable(List&lt;ProtocolVersion&gt; protocolVersions) {</span>
<span class="udiff-line-removed">-             for (ProtocolVersion pv : supportedProtocols) {</span>
<span class="udiff-line-removed">-                 if (protocolVersions.contains(pv)) {</span>
<span class="udiff-line-removed">-                     return true;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-             return false;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         boolean isAvailable(ProtocolVersion protocolVersion) {</span>
<span class="udiff-line-removed">-             for (ProtocolVersion pv : supportedProtocols) {</span>
<span class="udiff-line-removed">-                 if (protocolVersion == pv) {</span>
<span class="udiff-line-removed">-                     return true;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-             return false;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         boolean isSupported(List&lt;CipherSuite&gt; cipherSuites) {</span>
<span class="udiff-line-removed">-             for (CipherSuite cs : cipherSuites) {</span>
<span class="udiff-line-removed">-                 boolean isMatch = isAvailable(cs.supportedProtocols);</span>
<span class="udiff-line-removed">-                 if (isMatch &amp;&amp; (cs.keyExchange == null ||</span>
<span class="udiff-line-removed">-                         cs.keyExchange.groupType == type)) {</span>
<span class="udiff-line-removed">-                     return true;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-             return false;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // lazy loading of parameters</span>
<span class="udiff-line-removed">-         AlgorithmParameters getParameters() {</span>
<span class="udiff-line-removed">-             return SupportedGroups.namedGroupParams.get(this);</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         AlgorithmParameterSpec getParameterSpec() {</span>
<span class="udiff-line-removed">-             if (this.type == NamedGroupType.NAMED_GROUP_ECDHE) {</span>
<span class="udiff-line-removed">-                 return SupportedGroups.getECGenParamSpec(this);</span>
<span class="udiff-line-removed">-             } else if (this.type == NamedGroupType.NAMED_GROUP_FFDHE) {</span>
<span class="udiff-line-removed">-                 return SupportedGroups.getDHParameterSpec(this);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             return null;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">- </span>
      static class SupportedGroups {
          // To switch off the supported_groups extension for DHE cipher suite.
          static final boolean enableFFDHE =
                  Utilities.getBooleanProperty(&quot;jsse.enableFFDHE&quot;, true);
  
<span class="udiff-line-removed">-         // cache to speed up the parameters construction</span>
<span class="udiff-line-removed">-         static final Map&lt;NamedGroup,</span>
<span class="udiff-line-removed">-                     AlgorithmParameters&gt; namedGroupParams = new HashMap&lt;&gt;();</span>
<span class="udiff-line-removed">- </span>
          // the supported named groups
          static final NamedGroup[] supportedNamedGroups;
  
          static {
              // The value of the System Property defines a list of enabled named
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -500,11 +181,11 @@</span>
                  for (String group : groups) {
                      group = group.trim();
                      if (!group.isEmpty()) {
                          NamedGroup namedGroup = NamedGroup.nameOf(group);
                          if (namedGroup != null) {
<span class="udiff-line-modified-removed">-                             if (isAvailableGroup(namedGroup)) {</span>
<span class="udiff-line-modified-added">+                             if (namedGroup.isAvailable) {</span>
                                  groupList.add(namedGroup);
                              }
                          }   // ignore unknown groups
                      }
                  }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -514,35 +195,33 @@</span>
                              &quot;System property jdk.tls.namedGroups(&quot; +
                              property + &quot;) contains no supported named groups&quot;);
                  }
              } else {        // default groups
                  NamedGroup[] groups = new NamedGroup[] {
<span class="udiff-line-modified-removed">-                         // NIST curves first</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-added">+                         // Primary XDH (RFC 7748) curves</span>
<span class="udiff-line-added">+                         NamedGroup.X25519,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+                         // Primary NIST Suite B curves</span>
                          NamedGroup.SECP256_R1,
                          NamedGroup.SECP384_R1,
                          NamedGroup.SECP521_R1,
<span class="udiff-line-removed">-                         NamedGroup.SECT283_K1,</span>
<span class="udiff-line-removed">-                         NamedGroup.SECT283_R1,</span>
<span class="udiff-line-removed">-                         NamedGroup.SECT409_K1,</span>
<span class="udiff-line-removed">-                         NamedGroup.SECT409_R1,</span>
<span class="udiff-line-removed">-                         NamedGroup.SECT571_K1,</span>
<span class="udiff-line-removed">-                         NamedGroup.SECT571_R1,</span>
  
<span class="udiff-line-modified-removed">-                         // non-NIST curves</span>
<span class="udiff-line-modified-removed">-                         NamedGroup.SECP256_K1,</span>
<span class="udiff-line-modified-added">+                         // Secondary XDH curves</span>
<span class="udiff-line-modified-added">+                         NamedGroup.X448,</span>
  
<span class="udiff-line-modified-removed">-                         // FFDHE 2048</span>
<span class="udiff-line-modified-added">+                         // FFDHE (RFC 7919)</span>
                          NamedGroup.FFDHE_2048,
                          NamedGroup.FFDHE_3072,
                          NamedGroup.FFDHE_4096,
                          NamedGroup.FFDHE_6144,
                          NamedGroup.FFDHE_8192,
                      };
  
                  groupList = new ArrayList&lt;&gt;(groups.length);
                  for (NamedGroup group : groups) {
<span class="udiff-line-modified-removed">-                     if (isAvailableGroup(group)) {</span>
<span class="udiff-line-modified-added">+                     if (group.isAvailable) {</span>
                          groupList.add(group);
                      }
                  }
  
                  if (groupList.isEmpty() &amp;&amp;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -556,151 +235,23 @@</span>
              for (NamedGroup namedGroup : groupList) {
                  supportedNamedGroups[i++] = namedGroup;
              }
          }
  
<span class="udiff-line-removed">-         // check whether the group is supported by the underlying providers</span>
<span class="udiff-line-removed">-         private static boolean isAvailableGroup(NamedGroup namedGroup) {</span>
<span class="udiff-line-removed">-             AlgorithmParameters params = null;</span>
<span class="udiff-line-removed">-             AlgorithmParameterSpec spec = null;</span>
<span class="udiff-line-removed">-             if (namedGroup.type == NamedGroupType.NAMED_GROUP_ECDHE) {</span>
<span class="udiff-line-removed">-                 if (namedGroup.oid != null) {</span>
<span class="udiff-line-removed">-                     try {</span>
<span class="udiff-line-removed">-                         params = AlgorithmParameters.getInstance(&quot;EC&quot;);</span>
<span class="udiff-line-removed">-                         spec = new ECGenParameterSpec(namedGroup.oid);</span>
<span class="udiff-line-removed">-                     } catch (NoSuchAlgorithmException e) {</span>
<span class="udiff-line-removed">-                         return false;</span>
<span class="udiff-line-removed">-                     }</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             } else if (namedGroup.type == NamedGroupType.NAMED_GROUP_FFDHE) {</span>
<span class="udiff-line-removed">-                 try {</span>
<span class="udiff-line-removed">-                     params = AlgorithmParameters.getInstance(&quot;DiffieHellman&quot;);</span>
<span class="udiff-line-removed">-                     spec = getFFDHEDHParameterSpec(namedGroup);</span>
<span class="udiff-line-removed">-                 } catch (NoSuchAlgorithmException e) {</span>
<span class="udiff-line-removed">-                     return false;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }   // Otherwise, unsupported.</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             if ((params != null) &amp;&amp; (spec != null)) {</span>
<span class="udiff-line-removed">-                 try {</span>
<span class="udiff-line-removed">-                     params.init(spec);</span>
<span class="udiff-line-removed">-                 } catch (InvalidParameterSpecException e) {</span>
<span class="udiff-line-removed">-                     return false;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-                 // cache the parameters</span>
<span class="udiff-line-removed">-                 namedGroupParams.put(namedGroup, params);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-                 return true;</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             return false;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         private static DHParameterSpec getFFDHEDHParameterSpec(</span>
<span class="udiff-line-removed">-                 NamedGroup namedGroup) {</span>
<span class="udiff-line-removed">-             DHParameterSpec spec = null;</span>
<span class="udiff-line-removed">-             switch (namedGroup) {</span>
<span class="udiff-line-removed">-                 case FFDHE_2048:</span>
<span class="udiff-line-removed">-                     spec = PredefinedDHParameterSpecs.ffdheParams.get(2048);</span>
<span class="udiff-line-removed">-                     break;</span>
<span class="udiff-line-removed">-                 case FFDHE_3072:</span>
<span class="udiff-line-removed">-                     spec = PredefinedDHParameterSpecs.ffdheParams.get(3072);</span>
<span class="udiff-line-removed">-                     break;</span>
<span class="udiff-line-removed">-                 case FFDHE_4096:</span>
<span class="udiff-line-removed">-                     spec = PredefinedDHParameterSpecs.ffdheParams.get(4096);</span>
<span class="udiff-line-removed">-                     break;</span>
<span class="udiff-line-removed">-                 case FFDHE_6144:</span>
<span class="udiff-line-removed">-                     spec = PredefinedDHParameterSpecs.ffdheParams.get(6144);</span>
<span class="udiff-line-removed">-                     break;</span>
<span class="udiff-line-removed">-                 case FFDHE_8192:</span>
<span class="udiff-line-removed">-                     spec = PredefinedDHParameterSpecs.ffdheParams.get(8192);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             return spec;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         private static DHParameterSpec getPredefinedDHParameterSpec(</span>
<span class="udiff-line-removed">-                 NamedGroup namedGroup) {</span>
<span class="udiff-line-removed">-             DHParameterSpec spec = null;</span>
<span class="udiff-line-removed">-             switch (namedGroup) {</span>
<span class="udiff-line-removed">-                 case FFDHE_2048:</span>
<span class="udiff-line-removed">-                     spec = PredefinedDHParameterSpecs.definedParams.get(2048);</span>
<span class="udiff-line-removed">-                     break;</span>
<span class="udiff-line-removed">-                 case FFDHE_3072:</span>
<span class="udiff-line-removed">-                     spec = PredefinedDHParameterSpecs.definedParams.get(3072);</span>
<span class="udiff-line-removed">-                     break;</span>
<span class="udiff-line-removed">-                 case FFDHE_4096:</span>
<span class="udiff-line-removed">-                     spec = PredefinedDHParameterSpecs.definedParams.get(4096);</span>
<span class="udiff-line-removed">-                     break;</span>
<span class="udiff-line-removed">-                 case FFDHE_6144:</span>
<span class="udiff-line-removed">-                     spec = PredefinedDHParameterSpecs.definedParams.get(6144);</span>
<span class="udiff-line-removed">-                     break;</span>
<span class="udiff-line-removed">-                 case FFDHE_8192:</span>
<span class="udiff-line-removed">-                     spec = PredefinedDHParameterSpecs.definedParams.get(8192);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             return spec;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         static ECGenParameterSpec getECGenParamSpec(NamedGroup namedGroup) {</span>
<span class="udiff-line-removed">-             if (namedGroup.type != NamedGroupType.NAMED_GROUP_ECDHE) {</span>
<span class="udiff-line-removed">-                 throw new RuntimeException(</span>
<span class="udiff-line-removed">-                         &quot;Not a named EC group: &quot; + namedGroup);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             AlgorithmParameters params = namedGroupParams.get(namedGroup);</span>
<span class="udiff-line-removed">-             if (params == null) {</span>
<span class="udiff-line-removed">-                 throw new RuntimeException(</span>
<span class="udiff-line-removed">-                         &quot;Not a supported EC named group: &quot; + namedGroup);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             try {</span>
<span class="udiff-line-removed">-                 return params.getParameterSpec(ECGenParameterSpec.class);</span>
<span class="udiff-line-removed">-             } catch (InvalidParameterSpecException ipse) {</span>
<span class="udiff-line-removed">-                 // should be unlikely</span>
<span class="udiff-line-removed">-                 return new ECGenParameterSpec(namedGroup.oid);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         static DHParameterSpec getDHParameterSpec(NamedGroup namedGroup) {</span>
<span class="udiff-line-removed">-             if (namedGroup.type != NamedGroupType.NAMED_GROUP_FFDHE) {</span>
<span class="udiff-line-removed">-                 throw new RuntimeException(</span>
<span class="udiff-line-removed">-                         &quot;Not a named DH group: &quot; + namedGroup);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             AlgorithmParameters params = namedGroupParams.get(namedGroup);</span>
<span class="udiff-line-removed">-             if (params == null) {</span>
<span class="udiff-line-removed">-                 throw new RuntimeException(</span>
<span class="udiff-line-removed">-                         &quot;Not a supported DH named group: &quot; + namedGroup);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             try {</span>
<span class="udiff-line-removed">-                 return params.getParameterSpec(DHParameterSpec.class);</span>
<span class="udiff-line-removed">-             } catch (InvalidParameterSpecException ipse) {</span>
<span class="udiff-line-removed">-                 // should be unlikely</span>
<span class="udiff-line-removed">-                 return getPredefinedDHParameterSpec(namedGroup);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
          // Is there any supported group permitted by the constraints?
          static boolean isActivatable(
<span class="udiff-line-modified-removed">-                 AlgorithmConstraints constraints, NamedGroupType type) {</span>
<span class="udiff-line-modified-added">+                 AlgorithmConstraints constraints, NamedGroupSpec type) {</span>
  
              boolean hasFFDHEGroups = false;
              for (NamedGroup namedGroup : supportedNamedGroups) {
<span class="udiff-line-modified-removed">-                 if (namedGroup.type == type) {</span>
<span class="udiff-line-modified-removed">-                     if (constraints.permits(</span>
<span class="udiff-line-removed">-                             EnumSet.of(CryptoPrimitive.KEY_AGREEMENT),</span>
<span class="udiff-line-removed">-                             namedGroup.algorithm,</span>
<span class="udiff-line-removed">-                             namedGroupParams.get(namedGroup))) {</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-modified-added">+                 if (namedGroup.isAvailable &amp;&amp; namedGroup.spec == type) {</span>
<span class="udiff-line-modified-added">+                     if (namedGroup.isPermitted(constraints)) {</span>
                          return true;
                      }
  
                      if (!hasFFDHEGroups &amp;&amp;
<span class="udiff-line-modified-removed">-                             (type == NamedGroupType.NAMED_GROUP_FFDHE)) {</span>
<span class="udiff-line-modified-added">+                             (type == NamedGroupSpec.NAMED_GROUP_FFDHE)) {</span>
                          hasFFDHEGroups = true;
                      }
                  }
              }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -708,24 +259,21 @@</span>
              // compatible mode (using DHE cipher suite without FFDHE extension)
              // is allowed.
              //
              // Note that the constraints checking on DHE parameters will be
              // performed during key exchanging in a handshake.
<span class="udiff-line-modified-removed">-             return !hasFFDHEGroups &amp;&amp; type == NamedGroupType.NAMED_GROUP_FFDHE;</span>
<span class="udiff-line-modified-added">+             return !hasFFDHEGroups &amp;&amp; type == NamedGroupSpec.NAMED_GROUP_FFDHE;</span>
          }
  
          // Is the named group permitted by the constraints?
          static boolean isActivatable(
                  AlgorithmConstraints constraints, NamedGroup namedGroup) {
<span class="udiff-line-modified-removed">-             if (!isSupported(namedGroup)) {</span>
<span class="udiff-line-modified-added">+             if (!namedGroup.isAvailable || !isSupported(namedGroup)) {</span>
                  return false;
              }
  
<span class="udiff-line-modified-removed">-             return constraints.permits(</span>
<span class="udiff-line-removed">-                             EnumSet.of(CryptoPrimitive.KEY_AGREEMENT),</span>
<span class="udiff-line-removed">-                             namedGroup.algorithm,</span>
<span class="udiff-line-removed">-                             namedGroupParams.get(namedGroup));</span>
<span class="udiff-line-modified-added">+             return namedGroup.isPermitted(constraints);</span>
          }
  
          // Is the named group supported?
          static boolean isSupported(NamedGroup namedGroup) {
              for (NamedGroup group : supportedNamedGroups) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -737,37 +285,31 @@</span>
              return false;
          }
  
          static NamedGroup getPreferredGroup(
                  ProtocolVersion negotiatedProtocol,
<span class="udiff-line-modified-removed">-                 AlgorithmConstraints constraints, NamedGroupType type,</span>
<span class="udiff-line-modified-added">+                 AlgorithmConstraints constraints, NamedGroupSpec[] types,</span>
                  List&lt;NamedGroup&gt; requestedNamedGroups) {
              for (NamedGroup namedGroup : requestedNamedGroups) {
<span class="udiff-line-modified-removed">-                 if ((namedGroup.type == type) &amp;&amp;</span>
<span class="udiff-line-modified-added">+                 if ((NamedGroupSpec.arrayContains(types, namedGroup.spec)) &amp;&amp;</span>
                          namedGroup.isAvailable(negotiatedProtocol) &amp;&amp;
                          isSupported(namedGroup) &amp;&amp;
<span class="udiff-line-modified-removed">-                         constraints.permits(</span>
<span class="udiff-line-removed">-                                 EnumSet.of(CryptoPrimitive.KEY_AGREEMENT),</span>
<span class="udiff-line-removed">-                                 namedGroup.algorithm,</span>
<span class="udiff-line-removed">-                                 namedGroupParams.get(namedGroup))) {</span>
<span class="udiff-line-modified-added">+                         namedGroup.isPermitted(constraints)) {</span>
                      return namedGroup;
                  }
              }
  
              return null;
          }
  
          static NamedGroup getPreferredGroup(
                  ProtocolVersion negotiatedProtocol,
<span class="udiff-line-modified-removed">-                 AlgorithmConstraints constraints, NamedGroupType type) {</span>
<span class="udiff-line-modified-added">+                 AlgorithmConstraints constraints, NamedGroupSpec[] types) {</span>
              for (NamedGroup namedGroup : supportedNamedGroups) {
<span class="udiff-line-modified-removed">-                 if ((namedGroup.type == type) &amp;&amp;</span>
<span class="udiff-line-modified-added">+                 if ((NamedGroupSpec.arrayContains(types, namedGroup.spec)) &amp;&amp;</span>
                          namedGroup.isAvailable(negotiatedProtocol) &amp;&amp;
<span class="udiff-line-modified-removed">-                         constraints.permits(</span>
<span class="udiff-line-removed">-                                 EnumSet.of(CryptoPrimitive.KEY_AGREEMENT),</span>
<span class="udiff-line-removed">-                                 namedGroup.algorithm,</span>
<span class="udiff-line-removed">-                                 namedGroupParams.get(namedGroup))) {</span>
<span class="udiff-line-modified-added">+                         namedGroup.isPermitted(constraints)) {</span>
                      return namedGroup;
                  }
              }
  
              return null;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -803,19 +345,17 @@</span>
              // Produce the extension.
              ArrayList&lt;NamedGroup&gt; namedGroups =
                  new ArrayList&lt;&gt;(SupportedGroups.supportedNamedGroups.length);
              for (NamedGroup ng : SupportedGroups.supportedNamedGroups) {
                  if ((!SupportedGroups.enableFFDHE) &amp;&amp;
<span class="udiff-line-modified-removed">-                     (ng.type == NamedGroupType.NAMED_GROUP_FFDHE)) {</span>
<span class="udiff-line-modified-added">+                     (ng.spec == NamedGroupSpec.NAMED_GROUP_FFDHE)) {</span>
                      continue;
                  }
  
                  if (ng.isAvailable(chc.activeProtocols) &amp;&amp;
                          ng.isSupported(chc.activeCipherSuites) &amp;&amp;
<span class="udiff-line-modified-removed">-                         chc.algorithmConstraints.permits(</span>
<span class="udiff-line-removed">-                             EnumSet.of(CryptoPrimitive.KEY_AGREEMENT),</span>
<span class="udiff-line-removed">-                             ng.algorithm, namedGroupParams.get(ng))) {</span>
<span class="udiff-line-modified-added">+                         ng.isPermitted(chc.algorithmConstraints)) {</span>
                      namedGroups.add(ng);
                  } else if (SSLLogger.isOn &amp;&amp; SSLLogger.isOn(&quot;ssl,handshake&quot;)) {
                      SSLLogger.fine(
                          &quot;Ignore inactive or disabled named group: &quot; + ng.name);
                  }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -930,19 +470,17 @@</span>
              // they are currently supported by the client.
              ArrayList&lt;NamedGroup&gt; namedGroups = new ArrayList&lt;&gt;(
                      SupportedGroups.supportedNamedGroups.length);
              for (NamedGroup ng : SupportedGroups.supportedNamedGroups) {
                  if ((!SupportedGroups.enableFFDHE) &amp;&amp;
<span class="udiff-line-modified-removed">-                     (ng.type == NamedGroupType.NAMED_GROUP_FFDHE)) {</span>
<span class="udiff-line-modified-added">+                     (ng.spec == NamedGroupSpec.NAMED_GROUP_FFDHE)) {</span>
                      continue;
                  }
  
                  if (ng.isAvailable(shc.activeProtocols) &amp;&amp;
                          ng.isSupported(shc.activeCipherSuites) &amp;&amp;
<span class="udiff-line-modified-removed">-                         shc.algorithmConstraints.permits(</span>
<span class="udiff-line-removed">-                             EnumSet.of(CryptoPrimitive.KEY_AGREEMENT),</span>
<span class="udiff-line-removed">-                             ng.algorithm, namedGroupParams.get(ng))) {</span>
<span class="udiff-line-modified-added">+                         ng.isPermitted(shc.algorithmConstraints)) {</span>
                      namedGroups.add(ng);
                  } else if (SSLLogger.isOn &amp;&amp; SSLLogger.isOn(&quot;ssl,handshake&quot;)) {
                      SSLLogger.fine(
                          &quot;Ignore inactive or disabled named group: &quot; + ng.name);
                  }
</pre>
<center><a href="SunX509KeyManagerImpl.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="TransportContext.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>