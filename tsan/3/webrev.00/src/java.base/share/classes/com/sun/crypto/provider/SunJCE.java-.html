<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/java.base/share/classes/com/sun/crypto/provider/SunJCE.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 1997, 2018, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package com.sun.crypto.provider;
 27 
 28 import java.security.AccessController;
 29 import java.security.Provider;
 30 import java.security.SecureRandom;
 31 import java.security.PrivilegedAction;
 32 import java.util.HashMap;
 33 import java.util.List;
 34 import static sun.security.util.SecurityConstants.PROVIDER_VER;
 35 import static sun.security.provider.SunEntries.createAliases;
 36 import static sun.security.provider.SunEntries.createAliasesWithOid;
 37 
 38 /**
 39  * The &quot;SunJCE&quot; Cryptographic Service Provider.
 40  *
 41  * @author Jan Luehe
 42  * @author Sharon Liu
 43  */
 44 
 45 /**
 46  * Defines the &quot;SunJCE&quot; provider.
 47  *
 48  * Supported algorithms and their names:
 49  *
 50  * - RSA encryption (PKCS#1 v1.5 and raw)
 51  *
 52  * - DES
 53  *
 54  * - DES-EDE
 55  *
 56  * - AES
 57  *
 58  * - Blowfish
 59  *
 60  * - RC2
 61  *
 62  * - ARCFOUR (RC4 compatible)
 63  *
 64  * - ChaCha20 (Stream cipher only and in AEAD mode with Poly1305)
 65  *
 66  * - Cipher modes ECB, CBC, CFB, OFB, PCBC, CTR, and CTS for all block ciphers
 67  *   and mode GCM for AES cipher
 68  *
 69  * - Cipher padding ISO10126Padding for non-PKCS#5 block ciphers and
 70  *   NoPadding and PKCS5Padding for all block ciphers
 71  *
 72  * - Password-based Encryption (PBE)
 73  *
 74  * - Diffie-Hellman Key Agreement
 75  *
 76  * - HMAC-MD5, HMAC-SHA1, HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, HMAC-SHA-512
 77  *
 78  */
 79 
 80 public final class SunJCE extends Provider {
 81 
 82     private static final long serialVersionUID = 6812507587804302833L;
 83 
 84     private static final String info = &quot;SunJCE Provider &quot; +
 85     &quot;(implements RSA, DES, Triple DES, AES, Blowfish, ARCFOUR, RC2, PBE, &quot;
 86     + &quot;Diffie-Hellman, HMAC, ChaCha20)&quot;;
 87 
 88     /* Are we debugging? -- for developers */
 89     static final boolean debug = false;
 90 
 91     // Instance of this provider, so we don&#39;t have to call the provider list
 92     // to find ourselves or run the risk of not being in the list.
 93     private static volatile SunJCE instance;
 94 
 95     // lazy initialize SecureRandom to avoid potential recursion if Sun
 96     // provider has not been installed yet
 97     private static class SecureRandomHolder {
 98         static final SecureRandom RANDOM = new SecureRandom();
 99     }
100     static SecureRandom getRandom() { return SecureRandomHolder.RANDOM; }
101 
102     private void ps(String type, String algo, String cn,
103             List&lt;String&gt; aliases, HashMap&lt;String, String&gt; attrs) {
104         putService(new Provider.Service(this, type, algo, cn, aliases, attrs));
105     }
106 
107     public SunJCE() {
108         /* We are the &quot;SunJCE&quot; provider */
109         super(&quot;SunJCE&quot;, PROVIDER_VER, info);
110 
111         // if there is no security manager installed, put directly into
112         // the provider
113         if (System.getSecurityManager() == null) {
114             putEntries();
115         } else {
116             AccessController.doPrivileged(new PrivilegedAction&lt;Void&gt;() {
117                 @Override
118                 public Void run() {
119                     putEntries();
120                     return null;
121                 }
122             });
123         }
124         if (instance == null) {
125             instance = this;
126         }
127     }
128 
129     void putEntries() {
130         // common aliases and oids
131         List&lt;String&gt; aesAliases = createAliases(&quot;Rijndael&quot;);
132         List&lt;String&gt; desEdeAliases = createAliases(&quot;TripleDES&quot;);
133         List&lt;String&gt; arcFourAliases = createAliases(&quot;RC4&quot;);
134         List&lt;String&gt; sunTlsMSAliases = createAliases(
135             &quot;SunTls12MasterSecret&quot;, &quot;SunTlsExtendedMasterSecret&quot;
136         );
137         List&lt;String&gt; sunTlsKMAliases = createAliases(&quot;SunTls12KeyMaterial&quot;);
138         List&lt;String&gt; sunTlsRsaPMSAliases = createAliases(&quot;SunTls12RsaPremasterSecret&quot;);
139 
140         String aes128Oid = &quot;2.16.840.1.101.3.4.1.&quot;;
141         String aes192Oid = &quot;2.16.840.1.101.3.4.1.2&quot;;
142         String aes256Oid = &quot;2.16.840.1.101.3.4.1.4&quot;;
143 
144         List&lt;String&gt; pkcs12RC4_128Aliases =
145             createAliasesWithOid(&quot;1.2.840.113549.1.12.1.1&quot;);
146 
147         List&lt;String&gt; pkcs12RC4_40Aliases =
148             createAliasesWithOid(&quot;1.2.840.113549.1.12.1.2&quot;);
149 
150         List&lt;String&gt; pkcs12DESedeAliases =
151             createAliasesWithOid(&quot;1.2.840.113549.1.12.1.3&quot;);
152 
153         List&lt;String&gt; pkcs12RC2_128Aliases =
154             createAliasesWithOid(&quot;1.2.840.113549.1.12.1.5&quot;);
155 
156         List&lt;String&gt; pkcs12RC2_40Aliases =
157             createAliasesWithOid(&quot;1.2.840.113549.1.12.1.6&quot;);
158 
159         List&lt;String&gt; pkcs5MD5_DESAliases =
160             createAliasesWithOid(&quot;1.2.840.113549.1.5.3&quot;, &quot;PBE&quot;);
161 
162         List&lt;String&gt; pkcs5PBKDF2Aliases =
163             createAliasesWithOid(&quot;1.2.840.113549.1.5.12&quot;);
164 
165         List&lt;String&gt; pkcs5PBES2Aliases =
166             createAliasesWithOid(&quot;1.2.840.113549.1.5.13&quot;);
167 
168         List&lt;String&gt; diffieHellmanAliases =
169             createAliasesWithOid(&quot;1.2.840.113549.1.3.1&quot;, &quot;DH&quot;);
170 
171         List&lt;String&gt; chachaPolyAliases =
172             createAliasesWithOid(&quot;1.2.840.113549.1.9.16.3.18&quot;);
173 
174         String macOidBase = &quot;1.2.840.113549.2.&quot;;
175         List&lt;String&gt; macSHA1Aliases = createAliasesWithOid(macOidBase + &quot;7&quot;);
176         List&lt;String&gt; macSHA224Aliases = createAliasesWithOid(macOidBase + &quot;8&quot;);
177         List&lt;String&gt; macSHA256Aliases = createAliasesWithOid(macOidBase + &quot;9&quot;);
178         List&lt;String&gt; macSHA384Aliases = createAliasesWithOid(macOidBase + &quot;10&quot;);
179         List&lt;String&gt; macSHA512Aliases = createAliasesWithOid(macOidBase + &quot;11&quot;);
180 
181         // reuse attribute map and reset before each reuse
182         HashMap&lt;String, String&gt; attrs = new HashMap&lt;&gt;(3);
183         attrs.put(&quot;SupportedModes&quot;, &quot;ECB&quot;);
184         attrs.put(&quot;SupportedPaddings&quot;, &quot;NOPADDING|PKCS1PADDING|OAEPPADDING&quot;
185                 + &quot;|OAEPWITHMD5ANDMGF1PADDING&quot;
186                 + &quot;|OAEPWITHSHA1ANDMGF1PADDING&quot;
187                 + &quot;|OAEPWITHSHA-1ANDMGF1PADDING&quot;
188                 + &quot;|OAEPWITHSHA-224ANDMGF1PADDING&quot;
189                 + &quot;|OAEPWITHSHA-256ANDMGF1PADDING&quot;
190                 + &quot;|OAEPWITHSHA-384ANDMGF1PADDING&quot;
191                 + &quot;|OAEPWITHSHA-512ANDMGF1PADDING&quot;
192                 + &quot;|OAEPWITHSHA-512/224ANDMGF1PADDING&quot;
193                 + &quot;|OAEPWITHSHA-512/256ANDMGF1PADDING&quot;);
194         attrs.put(&quot;SupportedKeyClasses&quot;,
195                 &quot;java.security.interfaces.RSAPublicKey&quot; +
196                 &quot;|java.security.interfaces.RSAPrivateKey&quot;);
197         ps(&quot;Cipher&quot;, &quot;RSA&quot;,
198                 &quot;com.sun.crypto.provider.RSACipher&quot;, null, attrs);
199 
200         // common block cipher modes, pads
201         final String BLOCK_MODES = &quot;ECB|CBC|PCBC|CTR|CTS|CFB|OFB&quot; +
202             &quot;|CFB8|CFB16|CFB24|CFB32|CFB40|CFB48|CFB56|CFB64&quot; +
203             &quot;|OFB8|OFB16|OFB24|OFB32|OFB40|OFB48|OFB56|OFB64&quot;;
204         final String BLOCK_MODES128 = BLOCK_MODES +
205             &quot;|GCM|CFB72|CFB80|CFB88|CFB96|CFB104|CFB112|CFB120|CFB128&quot; +
206             &quot;|OFB72|OFB80|OFB88|OFB96|OFB104|OFB112|OFB120|OFB128&quot;;
207         final String BLOCK_PADS = &quot;NOPADDING|PKCS5PADDING|ISO10126PADDING&quot;;
208 
209         attrs.clear();
210         attrs.put(&quot;SupportedModes&quot;, BLOCK_MODES);
211         attrs.put(&quot;SupportedPaddings&quot;, BLOCK_PADS);
212         attrs.put(&quot;SupportedKeyFormats&quot;, &quot;RAW&quot;);
213         ps(&quot;Cipher&quot;, &quot;DES&quot;,
214                 &quot;com.sun.crypto.provider.DESCipher&quot;, null, attrs);
215         ps(&quot;Cipher&quot;, &quot;DESede&quot;, &quot;com.sun.crypto.provider.DESedeCipher&quot;,
216                 desEdeAliases, attrs);
217         ps(&quot;Cipher&quot;, &quot;Blowfish&quot;,
218                 &quot;com.sun.crypto.provider.BlowfishCipher&quot;, null, attrs);
219 
220         ps(&quot;Cipher&quot;, &quot;RC2&quot;,
221                 &quot;com.sun.crypto.provider.RC2Cipher&quot;, null, attrs);
222 
223         attrs.clear();
224         attrs.put(&quot;SupportedModes&quot;, BLOCK_MODES128);
225         attrs.put(&quot;SupportedPaddings&quot;, BLOCK_PADS);
226         attrs.put(&quot;SupportedKeyFormats&quot;, &quot;RAW&quot;);
227         ps(&quot;Cipher&quot;, &quot;AES&quot;, &quot;com.sun.crypto.provider.AESCipher$General&quot;,
228                 aesAliases, attrs);
229 
230         attrs.clear();
231         attrs.put(&quot;SupportedKeyFormats&quot;, &quot;RAW&quot;);
232         ps(&quot;Cipher&quot;, &quot;AES_128/ECB/NoPadding&quot;,
233                 &quot;com.sun.crypto.provider.AESCipher$AES128_ECB_NoPadding&quot;,
234                 createAliasesWithOid(aes128Oid+&quot;1&quot;), attrs);
235         ps(&quot;Cipher&quot;, &quot;AES_128/CBC/NoPadding&quot;,
236                 &quot;com.sun.crypto.provider.AESCipher$AES128_CBC_NoPadding&quot;,
237                 createAliasesWithOid(aes128Oid+&quot;2&quot;), attrs);
238         ps(&quot;Cipher&quot;, &quot;AES_128/OFB/NoPadding&quot;,
239                 &quot;com.sun.crypto.provider.AESCipher$AES128_OFB_NoPadding&quot;,
240                 createAliasesWithOid(aes128Oid+&quot;3&quot;), attrs);
241         ps(&quot;Cipher&quot;, &quot;AES_128/CFB/NoPadding&quot;,
242                 &quot;com.sun.crypto.provider.AESCipher$AES128_CFB_NoPadding&quot;,
243                 createAliasesWithOid(aes128Oid+&quot;4&quot;), attrs);
244         ps(&quot;Cipher&quot;, &quot;AES_128/GCM/NoPadding&quot;,
245                 &quot;com.sun.crypto.provider.AESCipher$AES128_GCM_NoPadding&quot;,
246                 createAliasesWithOid(aes128Oid+&quot;6&quot;), attrs);
247 
248         ps(&quot;Cipher&quot;, &quot;AES_192/ECB/NoPadding&quot;,
249                 &quot;com.sun.crypto.provider.AESCipher$AES192_ECB_NoPadding&quot;,
250                 createAliasesWithOid(aes192Oid+&quot;1&quot;), attrs);
251         ps(&quot;Cipher&quot;, &quot;AES_192/CBC/NoPadding&quot;,
252                 &quot;com.sun.crypto.provider.AESCipher$AES192_CBC_NoPadding&quot;,
253                 createAliasesWithOid(aes192Oid+&quot;2&quot;), attrs);
254         ps(&quot;Cipher&quot;, &quot;AES_192/OFB/NoPadding&quot;,
255                 &quot;com.sun.crypto.provider.AESCipher$AES192_OFB_NoPadding&quot;,
256                 createAliasesWithOid(aes192Oid+&quot;3&quot;), attrs);
257         ps(&quot;Cipher&quot;, &quot;AES_192/CFB/NoPadding&quot;,
258                 &quot;com.sun.crypto.provider.AESCipher$AES192_CFB_NoPadding&quot;,
259                 createAliasesWithOid(aes192Oid+&quot;4&quot;), attrs);
260         ps(&quot;Cipher&quot;, &quot;AES_192/GCM/NoPadding&quot;,
261                 &quot;com.sun.crypto.provider.AESCipher$AES192_GCM_NoPadding&quot;,
262                 createAliasesWithOid(aes192Oid+&quot;6&quot;), attrs);
263 
264         ps(&quot;Cipher&quot;, &quot;AES_256/ECB/NoPadding&quot;,
265                 &quot;com.sun.crypto.provider.AESCipher$AES256_ECB_NoPadding&quot;,
266                 createAliasesWithOid(aes256Oid+&quot;1&quot;), attrs);
267         ps(&quot;Cipher&quot;, &quot;AES_256/CBC/NoPadding&quot;,
268                 &quot;com.sun.crypto.provider.AESCipher$AES256_CBC_NoPadding&quot;,
269                 createAliasesWithOid(aes256Oid+&quot;2&quot;), attrs);
270         ps(&quot;Cipher&quot;, &quot;AES_256/OFB/NoPadding&quot;,
271                 &quot;com.sun.crypto.provider.AESCipher$AES256_OFB_NoPadding&quot;,
272                 createAliasesWithOid(aes256Oid+&quot;3&quot;), attrs);
273         ps(&quot;Cipher&quot;, &quot;AES_256/CFB/NoPadding&quot;,
274                 &quot;com.sun.crypto.provider.AESCipher$AES256_CFB_NoPadding&quot;,
275                 createAliasesWithOid(aes256Oid+&quot;4&quot;), attrs);
276         ps(&quot;Cipher&quot;, &quot;AES_256/GCM/NoPadding&quot;,
277                 &quot;com.sun.crypto.provider.AESCipher$AES256_GCM_NoPadding&quot;,
278                 createAliasesWithOid(aes256Oid+&quot;6&quot;), attrs);
279 
280         attrs.clear();
281         attrs.put(&quot;SupportedModes&quot;, &quot;CBC&quot;);
282         attrs.put(&quot;SupportedPaddings&quot;, &quot;NOPADDING&quot;);
283         attrs.put(&quot;SupportedKeyFormats&quot;, &quot;RAW&quot;);
284         ps(&quot;Cipher&quot;, &quot;DESedeWrap&quot;,
285                 &quot;com.sun.crypto.provider.DESedeWrapCipher&quot;, null, attrs);
286 
287         attrs.clear();
288         attrs.put(&quot;SupportedModes&quot;, &quot;ECB&quot;);
289         attrs.put(&quot;SupportedPaddings&quot;, &quot;NOPADDING&quot;);
290         attrs.put(&quot;SupportedKeyFormats&quot;, &quot;RAW&quot;);
291         ps(&quot;Cipher&quot;, &quot;ARCFOUR&quot;, &quot;com.sun.crypto.provider.ARCFOURCipher&quot;,
292                 arcFourAliases, attrs);
293         ps(&quot;Cipher&quot;, &quot;AESWrap&quot;, &quot;com.sun.crypto.provider.AESWrapCipher$General&quot;,
294                 null, attrs);
295         ps(&quot;Cipher&quot;, &quot;AESWrap_128&quot;,
296                 &quot;com.sun.crypto.provider.AESWrapCipher$AES128&quot;,
297                 createAliasesWithOid(aes128Oid+&quot;5&quot;), attrs);
298         ps(&quot;Cipher&quot;, &quot;AESWrap_192&quot;,
299                 &quot;com.sun.crypto.provider.AESWrapCipher$AES192&quot;,
300                 createAliasesWithOid(aes192Oid+&quot;5&quot;), attrs);
301         ps(&quot;Cipher&quot;, &quot;AESWrap_256&quot;,
302                 &quot;com.sun.crypto.provider.AESWrapCipher$AES256&quot;,
303                 createAliasesWithOid(aes256Oid+&quot;5&quot;), attrs);
304 
305         attrs.clear();
306         attrs.put(&quot;SupportedKeyFormats&quot;, &quot;RAW&quot;);
307         ps(&quot;Cipher&quot;,  &quot;ChaCha20&quot;,
308                 &quot;com.sun.crypto.provider.ChaCha20Cipher$ChaCha20Only&quot;,
309                 null, attrs);
310         ps(&quot;Cipher&quot;,  &quot;ChaCha20-Poly1305&quot;,
311                 &quot;com.sun.crypto.provider.ChaCha20Cipher$ChaCha20Poly1305&quot;,
312                 chachaPolyAliases, attrs);
313 
314         // PBES1
315         ps(&quot;Cipher&quot;, &quot;PBEWithMD5AndDES&quot;,
316                 &quot;com.sun.crypto.provider.PBEWithMD5AndDESCipher&quot;,
317                 pkcs5MD5_DESAliases, null);
318         ps(&quot;Cipher&quot;, &quot;PBEWithMD5AndTripleDES&quot;,
319                 &quot;com.sun.crypto.provider.PBEWithMD5AndTripleDESCipher&quot;,
320                 null, null);
321         ps(&quot;Cipher&quot;, &quot;PBEWithSHA1AndDESede&quot;,
322                 &quot;com.sun.crypto.provider.PKCS12PBECipherCore$PBEWithSHA1AndDESede&quot;,
323                 pkcs12DESedeAliases, null);
324         ps(&quot;Cipher&quot;, &quot;PBEWithSHA1AndRC2_40&quot;,
325                 &quot;com.sun.crypto.provider.PKCS12PBECipherCore$PBEWithSHA1AndRC2_40&quot;,
326                 pkcs12RC2_40Aliases, null);
327         ps(&quot;Cipher&quot;, &quot;PBEWithSHA1AndRC2_128&quot;,
328                 &quot;com.sun.crypto.provider.PKCS12PBECipherCore$PBEWithSHA1AndRC2_128&quot;,
329                 pkcs12RC2_128Aliases, null);
330         ps(&quot;Cipher&quot;, &quot;PBEWithSHA1AndRC4_40&quot;,
331                 &quot;com.sun.crypto.provider.PKCS12PBECipherCore$PBEWithSHA1AndRC4_40&quot;,
332                 pkcs12RC4_40Aliases, null);
333 
334         ps(&quot;Cipher&quot;, &quot;PBEWithSHA1AndRC4_128&quot;,
335                 &quot;com.sun.crypto.provider.PKCS12PBECipherCore$PBEWithSHA1AndRC4_128&quot;,
336                 pkcs12RC4_128Aliases, null);
337 
338         // PBES2
339         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA1AndAES_128&quot;,
340                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA1AndAES_128&quot;,
341                 null, null);
342 
343         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA224AndAES_128&quot;,
344                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA224AndAES_128&quot;,
345                 null, null);
346 
347         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA256AndAES_128&quot;,
348                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA256AndAES_128&quot;,
349                 null, null);
350 
351         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA384AndAES_128&quot;,
352                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA384AndAES_128&quot;,
353                 null, null);
354 
355         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA512AndAES_128&quot;,
356                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA512AndAES_128&quot;,
357                 null, null);
358 
359         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA1AndAES_256&quot;,
360                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA1AndAES_256&quot;,
361                 null, null);
362 
363         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA224AndAES_256&quot;,
364                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA224AndAES_256&quot;,
365                 null, null);
366 
367         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA256AndAES_256&quot;,
368                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA256AndAES_256&quot;,
369                 null, null);
370 
371         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA384AndAES_256&quot;,
372                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA384AndAES_256&quot;,
373                 null, null);
374 
375         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA512AndAES_256&quot;,
376                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA512AndAES_256&quot;,
377                 null, null);
378 
379         /*
380          * Key(pair) Generator engines
381          */
382         ps(&quot;KeyGenerator&quot;, &quot;DES&quot;,
383                 &quot;com.sun.crypto.provider.DESKeyGenerator&quot;,
384                 null, null);
385         ps(&quot;KeyGenerator&quot;, &quot;DESede&quot;,
386                 &quot;com.sun.crypto.provider.DESedeKeyGenerator&quot;,
387                 desEdeAliases, null);
388         ps(&quot;KeyGenerator&quot;, &quot;Blowfish&quot;,
389                 &quot;com.sun.crypto.provider.BlowfishKeyGenerator&quot;,
390                 null, null);
391         ps(&quot;KeyGenerator&quot;, &quot;AES&quot;,
392                 &quot;com.sun.crypto.provider.AESKeyGenerator&quot;,
393                 aesAliases, null);
394         ps(&quot;KeyGenerator&quot;, &quot;RC2&quot;,
395                 &quot;com.sun.crypto.provider.KeyGeneratorCore$RC2KeyGenerator&quot;,
396                 null, null);
397         ps(&quot;KeyGenerator&quot;, &quot;ARCFOUR&quot;,
398                 &quot;com.sun.crypto.provider.KeyGeneratorCore$ARCFOURKeyGenerator&quot;,
399                 arcFourAliases, null);
400         ps(&quot;KeyGenerator&quot;, &quot;ChaCha20&quot;,
401                 &quot;com.sun.crypto.provider.KeyGeneratorCore$ChaCha20KeyGenerator&quot;,
402                 null, null);
403         ps(&quot;KeyGenerator&quot;, &quot;HmacMD5&quot;,
404                 &quot;com.sun.crypto.provider.HmacMD5KeyGenerator&quot;,
405                 null, null);
406 
407         ps(&quot;KeyGenerator&quot;, &quot;HmacSHA1&quot;,
408                 &quot;com.sun.crypto.provider.HmacSHA1KeyGenerator&quot;,
409                 macSHA1Aliases, null);
410         ps(&quot;KeyGenerator&quot;, &quot;HmacSHA224&quot;,
411                 &quot;com.sun.crypto.provider.KeyGeneratorCore$HmacSHA2KG$SHA224&quot;,
412                 macSHA224Aliases, null);
413         ps(&quot;KeyGenerator&quot;, &quot;HmacSHA256&quot;,
414                 &quot;com.sun.crypto.provider.KeyGeneratorCore$HmacSHA2KG$SHA256&quot;,
415                 macSHA256Aliases, null);
416         ps(&quot;KeyGenerator&quot;, &quot;HmacSHA384&quot;,
417                 &quot;com.sun.crypto.provider.KeyGeneratorCore$HmacSHA2KG$SHA384&quot;,
418                 macSHA384Aliases, null);
419         ps(&quot;KeyGenerator&quot;, &quot;HmacSHA512&quot;,
420                 &quot;com.sun.crypto.provider.KeyGeneratorCore$HmacSHA2KG$SHA512&quot;,
421                 macSHA512Aliases, null);
422 
423         ps(&quot;KeyPairGenerator&quot;, &quot;DiffieHellman&quot;,
424                 &quot;com.sun.crypto.provider.DHKeyPairGenerator&quot;,
425                 diffieHellmanAliases, null);
426 
427         /*
428          * Algorithm parameter generation engines
429          */
430         ps(&quot;AlgorithmParameterGenerator&quot;,
431                 &quot;DiffieHellman&quot;, &quot;com.sun.crypto.provider.DHParameterGenerator&quot;,
432                 diffieHellmanAliases, null);
433 
434         /*
435          * Key Agreement engines
436          */
437         attrs.clear();
438         attrs.put(&quot;SupportedKeyClasses&quot;, &quot;javax.crypto.interfaces.DHPublicKey&quot; +
439                         &quot;|javax.crypto.interfaces.DHPrivateKey&quot;);
440         ps(&quot;KeyAgreement&quot;, &quot;DiffieHellman&quot;,
441                 &quot;com.sun.crypto.provider.DHKeyAgreement&quot;,
442                 diffieHellmanAliases, attrs);
443 
444         /*
445          * Algorithm Parameter engines
446          */
447         ps(&quot;AlgorithmParameters&quot;, &quot;DiffieHellman&quot;,
448                 &quot;com.sun.crypto.provider.DHParameters&quot;,
449                 diffieHellmanAliases, null);
450 
451         ps(&quot;AlgorithmParameters&quot;, &quot;DES&quot;,
452                 &quot;com.sun.crypto.provider.DESParameters&quot;,
453                 null, null);
454 
455         ps(&quot;AlgorithmParameters&quot;, &quot;DESede&quot;,
456                 &quot;com.sun.crypto.provider.DESedeParameters&quot;,
457                 desEdeAliases, null);
458 
459         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithMD5AndDES&quot;,
460                 &quot;com.sun.crypto.provider.PBEParameters&quot;,
461                 pkcs5MD5_DESAliases, null);
462 
463         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithMD5AndTripleDES&quot;,
464                 &quot;com.sun.crypto.provider.PBEParameters&quot;,
465                 null, null);
466 
467         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithSHA1AndDESede&quot;,
468                 &quot;com.sun.crypto.provider.PBEParameters&quot;,
469                 pkcs12DESedeAliases, null);
470 
471         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithSHA1AndRC2_40&quot;,
472                 &quot;com.sun.crypto.provider.PBEParameters&quot;,
473                 pkcs12RC2_40Aliases, null);
474 
475         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithSHA1AndRC2_128&quot;,
476                 &quot;com.sun.crypto.provider.PBEParameters&quot;,
477                 pkcs12RC2_128Aliases, null);
478 
479         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithSHA1AndRC4_40&quot;,
480                 &quot;com.sun.crypto.provider.PBEParameters&quot;,
481                 pkcs12RC4_40Aliases, null);
482 
483         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithSHA1AndRC4_128&quot;,
484                 &quot;com.sun.crypto.provider.PBEParameters&quot;,
485                 pkcs12RC4_128Aliases, null);
486 
487         ps(&quot;AlgorithmParameters&quot;, &quot;PBES2&quot;,
488                 &quot;com.sun.crypto.provider.PBES2Parameters$General&quot;,
489                 pkcs5PBES2Aliases, null);
490 
491         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA1AndAES_128&quot;,
492                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA1AndAES_128&quot;,
493                 null, null);
494 
495         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA224AndAES_128&quot;,
496                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA224AndAES_128&quot;,
497                 null, null);
498 
499         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA256AndAES_128&quot;,
500                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA256AndAES_128&quot;,
501                 null, null);
502 
503         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA384AndAES_128&quot;,
504                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA384AndAES_128&quot;,
505                 null, null);
506 
507         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA512AndAES_128&quot;,
508                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA512AndAES_128&quot;,
509                 null, null);
510 
511         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA1AndAES_256&quot;,
512                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA1AndAES_256&quot;,
513                 null, null);
514 
515         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA224AndAES_256&quot;,
516                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA224AndAES_256&quot;,
517                 null, null);
518 
519         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA256AndAES_256&quot;,
520                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA256AndAES_256&quot;,
521                 null, null);
522 
523         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA384AndAES_256&quot;,
524                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA384AndAES_256&quot;,
525                 null, null);
526 
527         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA512AndAES_256&quot;,
528                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA512AndAES_256&quot;,
529                 null, null);
530 
531         ps(&quot;AlgorithmParameters&quot;, &quot;Blowfish&quot;,
532                 &quot;com.sun.crypto.provider.BlowfishParameters&quot;,
533                 null, null);
534 
535         ps(&quot;AlgorithmParameters&quot;, &quot;AES&quot;,
536                 &quot;com.sun.crypto.provider.AESParameters&quot;,
537                 aesAliases, null);
538 
539         ps(&quot;AlgorithmParameters&quot;, &quot;GCM&quot;,
540                 &quot;com.sun.crypto.provider.GCMParameters&quot;,
541                 null, null);
542 
543         ps(&quot;AlgorithmParameters&quot;, &quot;RC2&quot;,
544                 &quot;com.sun.crypto.provider.RC2Parameters&quot;,
545                 null, null);
546 
547         ps(&quot;AlgorithmParameters&quot;, &quot;OAEP&quot;,
548                 &quot;com.sun.crypto.provider.OAEPParameters&quot;,
549                 null, null);
550 
551         ps(&quot;AlgorithmParameters&quot;, &quot;ChaCha20-Poly1305&quot;,
552                 &quot;com.sun.crypto.provider.ChaCha20Poly1305Parameters&quot;,
553                 chachaPolyAliases, null);
554 
555         /*
556          * Key factories
557          */
558         ps(&quot;KeyFactory&quot;, &quot;DiffieHellman&quot;,
559                 &quot;com.sun.crypto.provider.DHKeyFactory&quot;,
560                 diffieHellmanAliases, null);
561 
562         /*
563          * Secret-key factories
564          */
565         ps(&quot;SecretKeyFactory&quot;, &quot;DES&quot;,
566                 &quot;com.sun.crypto.provider.DESKeyFactory&quot;,
567                 null, null);
568 
569         ps(&quot;SecretKeyFactory&quot;, &quot;DESede&quot;,
570                 &quot;com.sun.crypto.provider.DESedeKeyFactory&quot;,
571                 desEdeAliases, null);
572 
573         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithMD5AndDES&quot;,
574                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithMD5AndDES&quot;,
575                 pkcs5MD5_DESAliases, null);
576 
577         /*
578          * Internal in-house crypto algorithm used for
579          * the JCEKS keystore type.  Since this was developed
580          * internally, there isn&#39;t an OID corresponding to this
581          * algorithm.
582          */
583         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithMD5AndTripleDES&quot;,
584                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithMD5AndTripleDES&quot;,
585                 null, null);
586 
587         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithSHA1AndDESede&quot;,
588                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithSHA1AndDESede&quot;,
589                 pkcs12DESedeAliases, null);
590 
591         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithSHA1AndRC2_40&quot;,
592                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithSHA1AndRC2_40&quot;,
593                 pkcs12RC2_40Aliases, null);
594 
595         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithSHA1AndRC2_128&quot;,
596                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithSHA1AndRC2_128&quot;,
597                 pkcs12RC2_128Aliases, null);
598 
599         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithSHA1AndRC4_40&quot;,
600                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithSHA1AndRC4_40&quot;,
601                 pkcs12RC4_40Aliases,null);
602 
603         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithSHA1AndRC4_128&quot;,
604                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithSHA1AndRC4_128&quot;,
605                 pkcs12RC4_128Aliases, null);
606 
607         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA1AndAES_128&quot;,
608                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA1AndAES_128&quot;,
609                 null, null);
610 
611         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA224AndAES_128&quot;,
612                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA224AndAES_128&quot;,
613                 null, null);
614 
615         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA256AndAES_128&quot;,
616                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA256AndAES_128&quot;,
617                 null, null);
618 
619         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA384AndAES_128&quot;,
620                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA384AndAES_128&quot;,
621                 null, null);
622 
623         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA512AndAES_128&quot;,
624                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA512AndAES_128&quot;,
625                 null, null);
626 
627         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA1AndAES_256&quot;,
628                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA1AndAES_256&quot;,
629                 null, null);
630 
631         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA224AndAES_256&quot;,
632                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA224AndAES_256&quot;,
633                 null, null);
634 
635         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA256AndAES_256&quot;,
636                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA256AndAES_256&quot;,
637                 null, null);
638 
639         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA384AndAES_256&quot;,
640                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA384AndAES_256&quot;,
641                 null, null);
642 
643         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA512AndAES_256&quot;,
644                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA512AndAES_256&quot;,
645                 null, null);
646 
647         // PBKDF2
648         ps(&quot;SecretKeyFactory&quot;, &quot;PBKDF2WithHmacSHA1&quot;,
649                 &quot;com.sun.crypto.provider.PBKDF2Core$HmacSHA1&quot;,
650                 pkcs5PBKDF2Aliases, null);
651         ps(&quot;SecretKeyFactory&quot;, &quot;PBKDF2WithHmacSHA224&quot;,
652                 &quot;com.sun.crypto.provider.PBKDF2Core$HmacSHA224&quot;,
653                 null, null);
654         ps(&quot;SecretKeyFactory&quot;, &quot;PBKDF2WithHmacSHA256&quot;,
655                 &quot;com.sun.crypto.provider.PBKDF2Core$HmacSHA256&quot;,
656                 null, null);
657         ps(&quot;SecretKeyFactory&quot;, &quot;PBKDF2WithHmacSHA384&quot;,
658                 &quot;com.sun.crypto.provider.PBKDF2Core$HmacSHA384&quot;,
659                 null, null);
660         ps(&quot;SecretKeyFactory&quot;, &quot;PBKDF2WithHmacSHA512&quot;,
661                 &quot;com.sun.crypto.provider.PBKDF2Core$HmacSHA512&quot;,
662                 null, null);
663 
664         /*
665          * MAC
666          */
667         attrs.clear();
668         attrs.put(&quot;SupportedKeyFormats&quot;, &quot;RAW&quot;);
669         ps(&quot;Mac&quot;, &quot;HmacMD5&quot;, &quot;com.sun.crypto.provider.HmacMD5&quot;, null, attrs);
670         ps(&quot;Mac&quot;, &quot;HmacSHA1&quot;, &quot;com.sun.crypto.provider.HmacSHA1&quot;,
671                 macSHA1Aliases, attrs);
672         ps(&quot;Mac&quot;, &quot;HmacSHA224&quot;, &quot;com.sun.crypto.provider.HmacCore$HmacSHA224&quot;,
673                 macSHA224Aliases, attrs);
674         ps(&quot;Mac&quot;, &quot;HmacSHA256&quot;, &quot;com.sun.crypto.provider.HmacCore$HmacSHA256&quot;,
675                 macSHA256Aliases, attrs);
676         ps(&quot;Mac&quot;, &quot;HmacSHA384&quot;, &quot;com.sun.crypto.provider.HmacCore$HmacSHA384&quot;,
677                 macSHA384Aliases, attrs);
678         ps(&quot;Mac&quot;, &quot;HmacSHA512&quot;, &quot;com.sun.crypto.provider.HmacCore$HmacSHA512&quot;,
679                 macSHA512Aliases, attrs);
680         // TODO: aliases with OIDs
681         ps(&quot;Mac&quot;, &quot;HmacSHA512/224&quot;,
682                 &quot;com.sun.crypto.provider.HmacCore$HmacSHA512_224&quot;,
683                 null, attrs);
684         ps(&quot;Mac&quot;, &quot;HmacSHA512/256&quot;,
685                 &quot;com.sun.crypto.provider.HmacCore$HmacSHA512_256&quot;,
686                 null, attrs);
687         ps(&quot;Mac&quot;, &quot;HmacPBESHA1&quot;,
688                 &quot;com.sun.crypto.provider.HmacPKCS12PBECore$HmacPKCS12PBE_SHA1&quot;,
689                 null, attrs);
690         ps(&quot;Mac&quot;, &quot;HmacPBESHA224&quot;,
691                 &quot;com.sun.crypto.provider.HmacPKCS12PBECore$HmacPKCS12PBE_SHA224&quot;,
692                 null, attrs);
693         ps(&quot;Mac&quot;, &quot;HmacPBESHA256&quot;,
694                 &quot;com.sun.crypto.provider.HmacPKCS12PBECore$HmacPKCS12PBE_SHA256&quot;,
695                 null, attrs);
696         ps(&quot;Mac&quot;, &quot;HmacPBESHA384&quot;,
697                 &quot;com.sun.crypto.provider.HmacPKCS12PBECore$HmacPKCS12PBE_SHA384&quot;,
698                 null, attrs);
699         ps(&quot;Mac&quot;, &quot;HmacPBESHA512&quot;,
700                 &quot;com.sun.crypto.provider.HmacPKCS12PBECore$HmacPKCS12PBE_SHA512&quot;,
701                 null, attrs);
702         ps(&quot;Mac&quot;, &quot;HmacPBESHA512/224&quot;,
703                 &quot;com.sun.crypto.provider.HmacPKCS12PBECore$HmacPKCS12PBE_SHA512_224&quot;,
704                 null, attrs);
705         ps(&quot;Mac&quot;, &quot;HmacPBESHA512/256&quot;,
706                 &quot;com.sun.crypto.provider.HmacPKCS12PBECore$HmacPKCS12PBE_SHA512_256&quot;,
707                 null, attrs);
708 
709 
710         // PBMAC1
711         ps(&quot;Mac&quot;, &quot;PBEWithHmacSHA1&quot;,
712                 &quot;com.sun.crypto.provider.PBMAC1Core$HmacSHA1&quot;, null, attrs);
713         ps(&quot;Mac&quot;, &quot;PBEWithHmacSHA224&quot;,
714                 &quot;com.sun.crypto.provider.PBMAC1Core$HmacSHA224&quot;, null, attrs);
715         ps(&quot;Mac&quot;, &quot;PBEWithHmacSHA256&quot;,
716                 &quot;com.sun.crypto.provider.PBMAC1Core$HmacSHA256&quot;, null, attrs);
717         ps(&quot;Mac&quot;, &quot;PBEWithHmacSHA384&quot;,
718                 &quot;com.sun.crypto.provider.PBMAC1Core$HmacSHA384&quot;, null, attrs);
719         ps(&quot;Mac&quot;, &quot;PBEWithHmacSHA512&quot;,
720                 &quot;com.sun.crypto.provider.PBMAC1Core$HmacSHA512&quot;, null, attrs);
721         ps(&quot;Mac&quot;, &quot;SslMacMD5&quot;,
722                 &quot;com.sun.crypto.provider.SslMacCore$SslMacMD5&quot;, null, attrs);
723         ps(&quot;Mac&quot;, &quot;SslMacSHA1&quot;,
724                 &quot;com.sun.crypto.provider.SslMacCore$SslMacSHA1&quot;, null, attrs);
725 
726         /*
727          * KeyStore
728          */
729         ps(&quot;KeyStore&quot;, &quot;JCEKS&quot;,
730                 &quot;com.sun.crypto.provider.JceKeyStore&quot;,
731                 null, null);
732 
733         /*
734          * SSL/TLS mechanisms
735          *
736          * These are strictly internal implementations and may
737          * be changed at any time.  These names were chosen
738          * because PKCS11/SunPKCS11 does not yet have TLS1.2
739          * mechanisms, and it will cause calls to come here.
740          */
741         ps(&quot;KeyGenerator&quot;, &quot;SunTlsPrf&quot;,
742                 &quot;com.sun.crypto.provider.TlsPrfGenerator$V10&quot;,
743                 null, null);
744         ps(&quot;KeyGenerator&quot;, &quot;SunTls12Prf&quot;,
745                 &quot;com.sun.crypto.provider.TlsPrfGenerator$V12&quot;,
746                 null, null);
747 
748         ps(&quot;KeyGenerator&quot;, &quot;SunTlsMasterSecret&quot;,
749                 &quot;com.sun.crypto.provider.TlsMasterSecretGenerator&quot;,
750                 createAliases(&quot;SunTls12MasterSecret&quot;,
751                     &quot;SunTlsExtendedMasterSecret&quot;), null);
752 
753         ps(&quot;KeyGenerator&quot;, &quot;SunTlsKeyMaterial&quot;,
754                 &quot;com.sun.crypto.provider.TlsKeyMaterialGenerator&quot;,
755                 createAliases(&quot;SunTls12KeyMaterial&quot;), null);
756 
757         ps(&quot;KeyGenerator&quot;, &quot;SunTlsRsaPremasterSecret&quot;,
758                 &quot;com.sun.crypto.provider.TlsRsaPremasterSecretGenerator&quot;,
759                 createAliases(&quot;SunTls12RsaPremasterSecret&quot;), null);
760     }
761 
762     // Return the instance of this class or create one if needed.
763     static SunJCE getInstance() {
764         if (instance == null) {
765             return new SunJCE();
766         }
767         return instance;
768     }
769 }
    </pre>
  </body>
</html>