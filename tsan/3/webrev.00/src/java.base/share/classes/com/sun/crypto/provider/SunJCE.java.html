<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/java.base/share/classes/com/sun/crypto/provider/SunJCE.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package com.sun.crypto.provider;
 27 
 28 import java.security.AccessController;
 29 import java.security.Provider;
 30 import java.security.SecureRandom;
 31 import java.security.PrivilegedAction;
 32 import java.util.HashMap;
 33 import java.util.List;
 34 import static sun.security.util.SecurityConstants.PROVIDER_VER;
 35 import static sun.security.provider.SunEntries.createAliases;
 36 import static sun.security.provider.SunEntries.createAliasesWithOid;
 37 
 38 /**
 39  * The &quot;SunJCE&quot; Cryptographic Service Provider.
 40  *
 41  * @author Jan Luehe
 42  * @author Sharon Liu
 43  */
 44 
 45 /**
 46  * Defines the &quot;SunJCE&quot; provider.
 47  *
 48  * Supported algorithms and their names:
 49  *
 50  * - RSA encryption (PKCS#1 v1.5 and raw)
 51  *
 52  * - DES
 53  *
 54  * - DES-EDE
 55  *
 56  * - AES
 57  *
 58  * - Blowfish
 59  *
 60  * - RC2
 61  *
 62  * - ARCFOUR (RC4 compatible)
 63  *
 64  * - ChaCha20 (Stream cipher only and in AEAD mode with Poly1305)
 65  *
 66  * - Cipher modes ECB, CBC, CFB, OFB, PCBC, CTR, and CTS for all block ciphers
 67  *   and mode GCM for AES cipher
 68  *
 69  * - Cipher padding ISO10126Padding for non-PKCS#5 block ciphers and
 70  *   NoPadding and PKCS5Padding for all block ciphers
 71  *
 72  * - Password-based Encryption (PBE)
 73  *
 74  * - Diffie-Hellman Key Agreement
 75  *
 76  * - HMAC-MD5, HMAC-SHA1, HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, HMAC-SHA-512
 77  *
 78  */
 79 
 80 public final class SunJCE extends Provider {
 81 
 82     @java.io.Serial
 83     private static final long serialVersionUID = 6812507587804302833L;
 84 
 85     private static final String info = &quot;SunJCE Provider &quot; +
 86     &quot;(implements RSA, DES, Triple DES, AES, Blowfish, ARCFOUR, RC2, PBE, &quot;
 87     + &quot;Diffie-Hellman, HMAC, ChaCha20)&quot;;
 88 
 89     /* Are we debugging? -- for developers */
 90     static final boolean debug = false;
 91 
 92     // Instance of this provider, so we don&#39;t have to call the provider list
 93     // to find ourselves or run the risk of not being in the list.
 94     private static volatile SunJCE instance;
 95 
 96     // lazy initialize SecureRandom to avoid potential recursion if Sun
 97     // provider has not been installed yet
 98     private static class SecureRandomHolder {
 99         static final SecureRandom RANDOM = new SecureRandom();
100     }
101     static SecureRandom getRandom() { return SecureRandomHolder.RANDOM; }
102 
103     private void ps(String type, String algo, String cn,
104             List&lt;String&gt; aliases, HashMap&lt;String, String&gt; attrs) {
105         putService(new Provider.Service(this, type, algo, cn, aliases, attrs));
106     }
107 
108     public SunJCE() {
109         /* We are the &quot;SunJCE&quot; provider */
110         super(&quot;SunJCE&quot;, PROVIDER_VER, info);
111 
112         // if there is no security manager installed, put directly into
113         // the provider
114         if (System.getSecurityManager() == null) {
115             putEntries();
116         } else {
117             AccessController.doPrivileged(new PrivilegedAction&lt;Void&gt;() {
118                 @Override
119                 public Void run() {
120                     putEntries();
121                     return null;
122                 }
123             });
124         }
125         if (instance == null) {
126             instance = this;
127         }
128     }
129 
130     void putEntries() {
131         // common aliases and oids
132         List&lt;String&gt; aesAliases = createAliases(&quot;Rijndael&quot;);
133         List&lt;String&gt; desEdeAliases = createAliases(&quot;TripleDES&quot;);
134         List&lt;String&gt; arcFourAliases = createAliases(&quot;RC4&quot;);
135         List&lt;String&gt; sunTlsMSAliases = createAliases(
136             &quot;SunTls12MasterSecret&quot;, &quot;SunTlsExtendedMasterSecret&quot;
137         );
138         List&lt;String&gt; sunTlsKMAliases = createAliases(&quot;SunTls12KeyMaterial&quot;);
139         List&lt;String&gt; sunTlsRsaPMSAliases = createAliases(&quot;SunTls12RsaPremasterSecret&quot;);
140 
141         String aes128Oid = &quot;2.16.840.1.101.3.4.1.&quot;;
142         String aes192Oid = &quot;2.16.840.1.101.3.4.1.2&quot;;
143         String aes256Oid = &quot;2.16.840.1.101.3.4.1.4&quot;;
144 
145         List&lt;String&gt; pkcs12RC4_128Aliases =
146             createAliasesWithOid(&quot;1.2.840.113549.1.12.1.1&quot;);
147 
148         List&lt;String&gt; pkcs12RC4_40Aliases =
149             createAliasesWithOid(&quot;1.2.840.113549.1.12.1.2&quot;);
150 
151         List&lt;String&gt; pkcs12DESedeAliases =
152             createAliasesWithOid(&quot;1.2.840.113549.1.12.1.3&quot;);
153 
154         List&lt;String&gt; pkcs12RC2_128Aliases =
155             createAliasesWithOid(&quot;1.2.840.113549.1.12.1.5&quot;);
156 
157         List&lt;String&gt; pkcs12RC2_40Aliases =
158             createAliasesWithOid(&quot;1.2.840.113549.1.12.1.6&quot;);
159 
160         List&lt;String&gt; pkcs5MD5_DESAliases =
161             createAliasesWithOid(&quot;1.2.840.113549.1.5.3&quot;, &quot;PBE&quot;);
162 
163         List&lt;String&gt; pkcs5PBKDF2Aliases =
164             createAliasesWithOid(&quot;1.2.840.113549.1.5.12&quot;);
165 
166         List&lt;String&gt; pkcs5PBES2Aliases =
167             createAliasesWithOid(&quot;1.2.840.113549.1.5.13&quot;);
168 
169         List&lt;String&gt; diffieHellmanAliases =
170             createAliasesWithOid(&quot;1.2.840.113549.1.3.1&quot;, &quot;DH&quot;);
171 
172         List&lt;String&gt; chachaPolyAliases =
173             createAliasesWithOid(&quot;1.2.840.113549.1.9.16.3.18&quot;);
174 
175         String macOidBase = &quot;1.2.840.113549.2.&quot;;
176         List&lt;String&gt; macSHA1Aliases = createAliasesWithOid(macOidBase + &quot;7&quot;);
177         List&lt;String&gt; macSHA224Aliases = createAliasesWithOid(macOidBase + &quot;8&quot;);
178         List&lt;String&gt; macSHA256Aliases = createAliasesWithOid(macOidBase + &quot;9&quot;);
179         List&lt;String&gt; macSHA384Aliases = createAliasesWithOid(macOidBase + &quot;10&quot;);
180         List&lt;String&gt; macSHA512Aliases = createAliasesWithOid(macOidBase + &quot;11&quot;);
181 
182         // reuse attribute map and reset before each reuse
183         HashMap&lt;String, String&gt; attrs = new HashMap&lt;&gt;(3);
184         attrs.put(&quot;SupportedModes&quot;, &quot;ECB&quot;);
185         attrs.put(&quot;SupportedPaddings&quot;, &quot;NOPADDING|PKCS1PADDING|OAEPPADDING&quot;
186                 + &quot;|OAEPWITHMD5ANDMGF1PADDING&quot;
187                 + &quot;|OAEPWITHSHA1ANDMGF1PADDING&quot;
188                 + &quot;|OAEPWITHSHA-1ANDMGF1PADDING&quot;
189                 + &quot;|OAEPWITHSHA-224ANDMGF1PADDING&quot;
190                 + &quot;|OAEPWITHSHA-256ANDMGF1PADDING&quot;
191                 + &quot;|OAEPWITHSHA-384ANDMGF1PADDING&quot;
192                 + &quot;|OAEPWITHSHA-512ANDMGF1PADDING&quot;
193                 + &quot;|OAEPWITHSHA-512/224ANDMGF1PADDING&quot;
194                 + &quot;|OAEPWITHSHA-512/256ANDMGF1PADDING&quot;);
195         attrs.put(&quot;SupportedKeyClasses&quot;,
196                 &quot;java.security.interfaces.RSAPublicKey&quot; +
197                 &quot;|java.security.interfaces.RSAPrivateKey&quot;);
198         ps(&quot;Cipher&quot;, &quot;RSA&quot;,
199                 &quot;com.sun.crypto.provider.RSACipher&quot;, null, attrs);
200 
201         // common block cipher modes, pads
202         final String BLOCK_MODES = &quot;ECB|CBC|PCBC|CTR|CTS|CFB|OFB&quot; +
203             &quot;|CFB8|CFB16|CFB24|CFB32|CFB40|CFB48|CFB56|CFB64&quot; +
204             &quot;|OFB8|OFB16|OFB24|OFB32|OFB40|OFB48|OFB56|OFB64&quot;;
205         final String BLOCK_MODES128 = BLOCK_MODES +
206             &quot;|GCM|CFB72|CFB80|CFB88|CFB96|CFB104|CFB112|CFB120|CFB128&quot; +
207             &quot;|OFB72|OFB80|OFB88|OFB96|OFB104|OFB112|OFB120|OFB128&quot;;
208         final String BLOCK_PADS = &quot;NOPADDING|PKCS5PADDING|ISO10126PADDING&quot;;
209 
210         attrs.clear();
211         attrs.put(&quot;SupportedModes&quot;, BLOCK_MODES);
212         attrs.put(&quot;SupportedPaddings&quot;, BLOCK_PADS);
213         attrs.put(&quot;SupportedKeyFormats&quot;, &quot;RAW&quot;);
214         ps(&quot;Cipher&quot;, &quot;DES&quot;,
215                 &quot;com.sun.crypto.provider.DESCipher&quot;, null, attrs);
216         ps(&quot;Cipher&quot;, &quot;DESede&quot;, &quot;com.sun.crypto.provider.DESedeCipher&quot;,
217                 desEdeAliases, attrs);
218         ps(&quot;Cipher&quot;, &quot;Blowfish&quot;,
219                 &quot;com.sun.crypto.provider.BlowfishCipher&quot;, null, attrs);
220 
221         ps(&quot;Cipher&quot;, &quot;RC2&quot;,
222                 &quot;com.sun.crypto.provider.RC2Cipher&quot;, null, attrs);
223 
224         attrs.clear();
225         attrs.put(&quot;SupportedModes&quot;, BLOCK_MODES128);
226         attrs.put(&quot;SupportedPaddings&quot;, BLOCK_PADS);
227         attrs.put(&quot;SupportedKeyFormats&quot;, &quot;RAW&quot;);
228         ps(&quot;Cipher&quot;, &quot;AES&quot;, &quot;com.sun.crypto.provider.AESCipher$General&quot;,
229                 aesAliases, attrs);
230 
231         attrs.clear();
232         attrs.put(&quot;SupportedKeyFormats&quot;, &quot;RAW&quot;);
233         ps(&quot;Cipher&quot;, &quot;AES_128/ECB/NoPadding&quot;,
234                 &quot;com.sun.crypto.provider.AESCipher$AES128_ECB_NoPadding&quot;,
235                 createAliasesWithOid(aes128Oid+&quot;1&quot;), attrs);
236         ps(&quot;Cipher&quot;, &quot;AES_128/CBC/NoPadding&quot;,
237                 &quot;com.sun.crypto.provider.AESCipher$AES128_CBC_NoPadding&quot;,
238                 createAliasesWithOid(aes128Oid+&quot;2&quot;), attrs);
239         ps(&quot;Cipher&quot;, &quot;AES_128/OFB/NoPadding&quot;,
240                 &quot;com.sun.crypto.provider.AESCipher$AES128_OFB_NoPadding&quot;,
241                 createAliasesWithOid(aes128Oid+&quot;3&quot;), attrs);
242         ps(&quot;Cipher&quot;, &quot;AES_128/CFB/NoPadding&quot;,
243                 &quot;com.sun.crypto.provider.AESCipher$AES128_CFB_NoPadding&quot;,
244                 createAliasesWithOid(aes128Oid+&quot;4&quot;), attrs);
245         ps(&quot;Cipher&quot;, &quot;AES_128/GCM/NoPadding&quot;,
246                 &quot;com.sun.crypto.provider.AESCipher$AES128_GCM_NoPadding&quot;,
247                 createAliasesWithOid(aes128Oid+&quot;6&quot;), attrs);
248 
249         ps(&quot;Cipher&quot;, &quot;AES_192/ECB/NoPadding&quot;,
250                 &quot;com.sun.crypto.provider.AESCipher$AES192_ECB_NoPadding&quot;,
251                 createAliasesWithOid(aes192Oid+&quot;1&quot;), attrs);
252         ps(&quot;Cipher&quot;, &quot;AES_192/CBC/NoPadding&quot;,
253                 &quot;com.sun.crypto.provider.AESCipher$AES192_CBC_NoPadding&quot;,
254                 createAliasesWithOid(aes192Oid+&quot;2&quot;), attrs);
255         ps(&quot;Cipher&quot;, &quot;AES_192/OFB/NoPadding&quot;,
256                 &quot;com.sun.crypto.provider.AESCipher$AES192_OFB_NoPadding&quot;,
257                 createAliasesWithOid(aes192Oid+&quot;3&quot;), attrs);
258         ps(&quot;Cipher&quot;, &quot;AES_192/CFB/NoPadding&quot;,
259                 &quot;com.sun.crypto.provider.AESCipher$AES192_CFB_NoPadding&quot;,
260                 createAliasesWithOid(aes192Oid+&quot;4&quot;), attrs);
261         ps(&quot;Cipher&quot;, &quot;AES_192/GCM/NoPadding&quot;,
262                 &quot;com.sun.crypto.provider.AESCipher$AES192_GCM_NoPadding&quot;,
263                 createAliasesWithOid(aes192Oid+&quot;6&quot;), attrs);
264 
265         ps(&quot;Cipher&quot;, &quot;AES_256/ECB/NoPadding&quot;,
266                 &quot;com.sun.crypto.provider.AESCipher$AES256_ECB_NoPadding&quot;,
267                 createAliasesWithOid(aes256Oid+&quot;1&quot;), attrs);
268         ps(&quot;Cipher&quot;, &quot;AES_256/CBC/NoPadding&quot;,
269                 &quot;com.sun.crypto.provider.AESCipher$AES256_CBC_NoPadding&quot;,
270                 createAliasesWithOid(aes256Oid+&quot;2&quot;), attrs);
271         ps(&quot;Cipher&quot;, &quot;AES_256/OFB/NoPadding&quot;,
272                 &quot;com.sun.crypto.provider.AESCipher$AES256_OFB_NoPadding&quot;,
273                 createAliasesWithOid(aes256Oid+&quot;3&quot;), attrs);
274         ps(&quot;Cipher&quot;, &quot;AES_256/CFB/NoPadding&quot;,
275                 &quot;com.sun.crypto.provider.AESCipher$AES256_CFB_NoPadding&quot;,
276                 createAliasesWithOid(aes256Oid+&quot;4&quot;), attrs);
277         ps(&quot;Cipher&quot;, &quot;AES_256/GCM/NoPadding&quot;,
278                 &quot;com.sun.crypto.provider.AESCipher$AES256_GCM_NoPadding&quot;,
279                 createAliasesWithOid(aes256Oid+&quot;6&quot;), attrs);
280 
281         attrs.clear();
282         attrs.put(&quot;SupportedModes&quot;, &quot;CBC&quot;);
283         attrs.put(&quot;SupportedPaddings&quot;, &quot;NOPADDING&quot;);
284         attrs.put(&quot;SupportedKeyFormats&quot;, &quot;RAW&quot;);
285         ps(&quot;Cipher&quot;, &quot;DESedeWrap&quot;,
286                 &quot;com.sun.crypto.provider.DESedeWrapCipher&quot;, null, attrs);
287 
288         attrs.clear();
289         attrs.put(&quot;SupportedModes&quot;, &quot;ECB&quot;);
290         attrs.put(&quot;SupportedPaddings&quot;, &quot;NOPADDING&quot;);
291         attrs.put(&quot;SupportedKeyFormats&quot;, &quot;RAW&quot;);
292         ps(&quot;Cipher&quot;, &quot;ARCFOUR&quot;, &quot;com.sun.crypto.provider.ARCFOURCipher&quot;,
293                 arcFourAliases, attrs);
294         ps(&quot;Cipher&quot;, &quot;AESWrap&quot;, &quot;com.sun.crypto.provider.AESWrapCipher$General&quot;,
295                 null, attrs);
296         ps(&quot;Cipher&quot;, &quot;AESWrap_128&quot;,
297                 &quot;com.sun.crypto.provider.AESWrapCipher$AES128&quot;,
298                 createAliasesWithOid(aes128Oid+&quot;5&quot;), attrs);
299         ps(&quot;Cipher&quot;, &quot;AESWrap_192&quot;,
300                 &quot;com.sun.crypto.provider.AESWrapCipher$AES192&quot;,
301                 createAliasesWithOid(aes192Oid+&quot;5&quot;), attrs);
302         ps(&quot;Cipher&quot;, &quot;AESWrap_256&quot;,
303                 &quot;com.sun.crypto.provider.AESWrapCipher$AES256&quot;,
304                 createAliasesWithOid(aes256Oid+&quot;5&quot;), attrs);
305 
306         attrs.clear();
307         attrs.put(&quot;SupportedKeyFormats&quot;, &quot;RAW&quot;);
308         ps(&quot;Cipher&quot;,  &quot;ChaCha20&quot;,
309                 &quot;com.sun.crypto.provider.ChaCha20Cipher$ChaCha20Only&quot;,
310                 null, attrs);
311         ps(&quot;Cipher&quot;,  &quot;ChaCha20-Poly1305&quot;,
312                 &quot;com.sun.crypto.provider.ChaCha20Cipher$ChaCha20Poly1305&quot;,
313                 chachaPolyAliases, attrs);
314 
315         // PBES1
316         ps(&quot;Cipher&quot;, &quot;PBEWithMD5AndDES&quot;,
317                 &quot;com.sun.crypto.provider.PBEWithMD5AndDESCipher&quot;,
318                 pkcs5MD5_DESAliases, null);
319         ps(&quot;Cipher&quot;, &quot;PBEWithMD5AndTripleDES&quot;,
320                 &quot;com.sun.crypto.provider.PBEWithMD5AndTripleDESCipher&quot;,
321                 null, null);
322         ps(&quot;Cipher&quot;, &quot;PBEWithSHA1AndDESede&quot;,
323                 &quot;com.sun.crypto.provider.PKCS12PBECipherCore$PBEWithSHA1AndDESede&quot;,
324                 pkcs12DESedeAliases, null);
325         ps(&quot;Cipher&quot;, &quot;PBEWithSHA1AndRC2_40&quot;,
326                 &quot;com.sun.crypto.provider.PKCS12PBECipherCore$PBEWithSHA1AndRC2_40&quot;,
327                 pkcs12RC2_40Aliases, null);
328         ps(&quot;Cipher&quot;, &quot;PBEWithSHA1AndRC2_128&quot;,
329                 &quot;com.sun.crypto.provider.PKCS12PBECipherCore$PBEWithSHA1AndRC2_128&quot;,
330                 pkcs12RC2_128Aliases, null);
331         ps(&quot;Cipher&quot;, &quot;PBEWithSHA1AndRC4_40&quot;,
332                 &quot;com.sun.crypto.provider.PKCS12PBECipherCore$PBEWithSHA1AndRC4_40&quot;,
333                 pkcs12RC4_40Aliases, null);
334 
335         ps(&quot;Cipher&quot;, &quot;PBEWithSHA1AndRC4_128&quot;,
336                 &quot;com.sun.crypto.provider.PKCS12PBECipherCore$PBEWithSHA1AndRC4_128&quot;,
337                 pkcs12RC4_128Aliases, null);
338 
339         // PBES2
340         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA1AndAES_128&quot;,
341                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA1AndAES_128&quot;,
342                 null, null);
343 
344         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA224AndAES_128&quot;,
345                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA224AndAES_128&quot;,
346                 null, null);
347 
348         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA256AndAES_128&quot;,
349                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA256AndAES_128&quot;,
350                 null, null);
351 
352         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA384AndAES_128&quot;,
353                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA384AndAES_128&quot;,
354                 null, null);
355 
356         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA512AndAES_128&quot;,
357                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA512AndAES_128&quot;,
358                 null, null);
359 
360         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA1AndAES_256&quot;,
361                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA1AndAES_256&quot;,
362                 null, null);
363 
364         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA224AndAES_256&quot;,
365                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA224AndAES_256&quot;,
366                 null, null);
367 
368         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA256AndAES_256&quot;,
369                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA256AndAES_256&quot;,
370                 null, null);
371 
372         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA384AndAES_256&quot;,
373                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA384AndAES_256&quot;,
374                 null, null);
375 
376         ps(&quot;Cipher&quot;, &quot;PBEWithHmacSHA512AndAES_256&quot;,
377                 &quot;com.sun.crypto.provider.PBES2Core$HmacSHA512AndAES_256&quot;,
378                 null, null);
379 
380         /*
381          * Key(pair) Generator engines
382          */
383         ps(&quot;KeyGenerator&quot;, &quot;DES&quot;,
384                 &quot;com.sun.crypto.provider.DESKeyGenerator&quot;,
385                 null, null);
386         ps(&quot;KeyGenerator&quot;, &quot;DESede&quot;,
387                 &quot;com.sun.crypto.provider.DESedeKeyGenerator&quot;,
388                 desEdeAliases, null);
389         ps(&quot;KeyGenerator&quot;, &quot;Blowfish&quot;,
390                 &quot;com.sun.crypto.provider.BlowfishKeyGenerator&quot;,
391                 null, null);
392         ps(&quot;KeyGenerator&quot;, &quot;AES&quot;,
393                 &quot;com.sun.crypto.provider.AESKeyGenerator&quot;,
394                 aesAliases, null);
395         ps(&quot;KeyGenerator&quot;, &quot;RC2&quot;,
396                 &quot;com.sun.crypto.provider.KeyGeneratorCore$RC2KeyGenerator&quot;,
397                 null, null);
398         ps(&quot;KeyGenerator&quot;, &quot;ARCFOUR&quot;,
399                 &quot;com.sun.crypto.provider.KeyGeneratorCore$ARCFOURKeyGenerator&quot;,
400                 arcFourAliases, null);
401         ps(&quot;KeyGenerator&quot;, &quot;ChaCha20&quot;,
402                 &quot;com.sun.crypto.provider.KeyGeneratorCore$ChaCha20KeyGenerator&quot;,
403                 null, null);
404         ps(&quot;KeyGenerator&quot;, &quot;HmacMD5&quot;,
405                 &quot;com.sun.crypto.provider.HmacMD5KeyGenerator&quot;,
406                 null, null);
407 
408         ps(&quot;KeyGenerator&quot;, &quot;HmacSHA1&quot;,
409                 &quot;com.sun.crypto.provider.HmacSHA1KeyGenerator&quot;,
410                 macSHA1Aliases, null);
411         ps(&quot;KeyGenerator&quot;, &quot;HmacSHA224&quot;,
412                 &quot;com.sun.crypto.provider.KeyGeneratorCore$HmacSHA2KG$SHA224&quot;,
413                 macSHA224Aliases, null);
414         ps(&quot;KeyGenerator&quot;, &quot;HmacSHA256&quot;,
415                 &quot;com.sun.crypto.provider.KeyGeneratorCore$HmacSHA2KG$SHA256&quot;,
416                 macSHA256Aliases, null);
417         ps(&quot;KeyGenerator&quot;, &quot;HmacSHA384&quot;,
418                 &quot;com.sun.crypto.provider.KeyGeneratorCore$HmacSHA2KG$SHA384&quot;,
419                 macSHA384Aliases, null);
420         ps(&quot;KeyGenerator&quot;, &quot;HmacSHA512&quot;,
421                 &quot;com.sun.crypto.provider.KeyGeneratorCore$HmacSHA2KG$SHA512&quot;,
422                 macSHA512Aliases, null);
423 
424         ps(&quot;KeyPairGenerator&quot;, &quot;DiffieHellman&quot;,
425                 &quot;com.sun.crypto.provider.DHKeyPairGenerator&quot;,
426                 diffieHellmanAliases, null);
427 
428         /*
429          * Algorithm parameter generation engines
430          */
431         ps(&quot;AlgorithmParameterGenerator&quot;,
432                 &quot;DiffieHellman&quot;, &quot;com.sun.crypto.provider.DHParameterGenerator&quot;,
433                 diffieHellmanAliases, null);
434 
435         /*
436          * Key Agreement engines
437          */
438         attrs.clear();
439         attrs.put(&quot;SupportedKeyClasses&quot;, &quot;javax.crypto.interfaces.DHPublicKey&quot; +
440                         &quot;|javax.crypto.interfaces.DHPrivateKey&quot;);
441         ps(&quot;KeyAgreement&quot;, &quot;DiffieHellman&quot;,
442                 &quot;com.sun.crypto.provider.DHKeyAgreement&quot;,
443                 diffieHellmanAliases, attrs);
444 
445         /*
446          * Algorithm Parameter engines
447          */
448         ps(&quot;AlgorithmParameters&quot;, &quot;DiffieHellman&quot;,
449                 &quot;com.sun.crypto.provider.DHParameters&quot;,
450                 diffieHellmanAliases, null);
451 
452         ps(&quot;AlgorithmParameters&quot;, &quot;DES&quot;,
453                 &quot;com.sun.crypto.provider.DESParameters&quot;,
454                 null, null);
455 
456         ps(&quot;AlgorithmParameters&quot;, &quot;DESede&quot;,
457                 &quot;com.sun.crypto.provider.DESedeParameters&quot;,
458                 desEdeAliases, null);
459 
460         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithMD5AndDES&quot;,
461                 &quot;com.sun.crypto.provider.PBEParameters&quot;,
462                 pkcs5MD5_DESAliases, null);
463 
464         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithMD5AndTripleDES&quot;,
465                 &quot;com.sun.crypto.provider.PBEParameters&quot;,
466                 null, null);
467 
468         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithSHA1AndDESede&quot;,
469                 &quot;com.sun.crypto.provider.PBEParameters&quot;,
470                 pkcs12DESedeAliases, null);
471 
472         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithSHA1AndRC2_40&quot;,
473                 &quot;com.sun.crypto.provider.PBEParameters&quot;,
474                 pkcs12RC2_40Aliases, null);
475 
476         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithSHA1AndRC2_128&quot;,
477                 &quot;com.sun.crypto.provider.PBEParameters&quot;,
478                 pkcs12RC2_128Aliases, null);
479 
480         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithSHA1AndRC4_40&quot;,
481                 &quot;com.sun.crypto.provider.PBEParameters&quot;,
482                 pkcs12RC4_40Aliases, null);
483 
484         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithSHA1AndRC4_128&quot;,
485                 &quot;com.sun.crypto.provider.PBEParameters&quot;,
486                 pkcs12RC4_128Aliases, null);
487 
488         ps(&quot;AlgorithmParameters&quot;, &quot;PBES2&quot;,
489                 &quot;com.sun.crypto.provider.PBES2Parameters$General&quot;,
490                 pkcs5PBES2Aliases, null);
491 
492         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA1AndAES_128&quot;,
493                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA1AndAES_128&quot;,
494                 null, null);
495 
496         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA224AndAES_128&quot;,
497                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA224AndAES_128&quot;,
498                 null, null);
499 
500         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA256AndAES_128&quot;,
501                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA256AndAES_128&quot;,
502                 null, null);
503 
504         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA384AndAES_128&quot;,
505                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA384AndAES_128&quot;,
506                 null, null);
507 
508         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA512AndAES_128&quot;,
509                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA512AndAES_128&quot;,
510                 null, null);
511 
512         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA1AndAES_256&quot;,
513                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA1AndAES_256&quot;,
514                 null, null);
515 
516         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA224AndAES_256&quot;,
517                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA224AndAES_256&quot;,
518                 null, null);
519 
520         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA256AndAES_256&quot;,
521                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA256AndAES_256&quot;,
522                 null, null);
523 
524         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA384AndAES_256&quot;,
525                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA384AndAES_256&quot;,
526                 null, null);
527 
528         ps(&quot;AlgorithmParameters&quot;, &quot;PBEWithHmacSHA512AndAES_256&quot;,
529                 &quot;com.sun.crypto.provider.PBES2Parameters$HmacSHA512AndAES_256&quot;,
530                 null, null);
531 
532         ps(&quot;AlgorithmParameters&quot;, &quot;Blowfish&quot;,
533                 &quot;com.sun.crypto.provider.BlowfishParameters&quot;,
534                 null, null);
535 
536         ps(&quot;AlgorithmParameters&quot;, &quot;AES&quot;,
537                 &quot;com.sun.crypto.provider.AESParameters&quot;,
538                 aesAliases, null);
539 
540         ps(&quot;AlgorithmParameters&quot;, &quot;GCM&quot;,
541                 &quot;com.sun.crypto.provider.GCMParameters&quot;,
542                 null, null);
543 
544         ps(&quot;AlgorithmParameters&quot;, &quot;RC2&quot;,
545                 &quot;com.sun.crypto.provider.RC2Parameters&quot;,
546                 null, null);
547 
548         ps(&quot;AlgorithmParameters&quot;, &quot;OAEP&quot;,
549                 &quot;com.sun.crypto.provider.OAEPParameters&quot;,
550                 null, null);
551 
552         ps(&quot;AlgorithmParameters&quot;, &quot;ChaCha20-Poly1305&quot;,
553                 &quot;com.sun.crypto.provider.ChaCha20Poly1305Parameters&quot;,
554                 chachaPolyAliases, null);
555 
556         /*
557          * Key factories
558          */
559         ps(&quot;KeyFactory&quot;, &quot;DiffieHellman&quot;,
560                 &quot;com.sun.crypto.provider.DHKeyFactory&quot;,
561                 diffieHellmanAliases, null);
562 
563         /*
564          * Secret-key factories
565          */
566         ps(&quot;SecretKeyFactory&quot;, &quot;DES&quot;,
567                 &quot;com.sun.crypto.provider.DESKeyFactory&quot;,
568                 null, null);
569 
570         ps(&quot;SecretKeyFactory&quot;, &quot;DESede&quot;,
571                 &quot;com.sun.crypto.provider.DESedeKeyFactory&quot;,
572                 desEdeAliases, null);
573 
574         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithMD5AndDES&quot;,
575                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithMD5AndDES&quot;,
576                 pkcs5MD5_DESAliases, null);
577 
578         /*
579          * Internal in-house crypto algorithm used for
580          * the JCEKS keystore type.  Since this was developed
581          * internally, there isn&#39;t an OID corresponding to this
582          * algorithm.
583          */
584         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithMD5AndTripleDES&quot;,
585                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithMD5AndTripleDES&quot;,
586                 null, null);
587 
588         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithSHA1AndDESede&quot;,
589                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithSHA1AndDESede&quot;,
590                 pkcs12DESedeAliases, null);
591 
592         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithSHA1AndRC2_40&quot;,
593                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithSHA1AndRC2_40&quot;,
594                 pkcs12RC2_40Aliases, null);
595 
596         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithSHA1AndRC2_128&quot;,
597                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithSHA1AndRC2_128&quot;,
598                 pkcs12RC2_128Aliases, null);
599 
600         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithSHA1AndRC4_40&quot;,
601                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithSHA1AndRC4_40&quot;,
602                 pkcs12RC4_40Aliases,null);
603 
604         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithSHA1AndRC4_128&quot;,
605                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithSHA1AndRC4_128&quot;,
606                 pkcs12RC4_128Aliases, null);
607 
608         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA1AndAES_128&quot;,
609                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA1AndAES_128&quot;,
610                 null, null);
611 
612         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA224AndAES_128&quot;,
613                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA224AndAES_128&quot;,
614                 null, null);
615 
616         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA256AndAES_128&quot;,
617                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA256AndAES_128&quot;,
618                 null, null);
619 
620         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA384AndAES_128&quot;,
621                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA384AndAES_128&quot;,
622                 null, null);
623 
624         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA512AndAES_128&quot;,
625                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA512AndAES_128&quot;,
626                 null, null);
627 
628         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA1AndAES_256&quot;,
629                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA1AndAES_256&quot;,
630                 null, null);
631 
632         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA224AndAES_256&quot;,
633                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA224AndAES_256&quot;,
634                 null, null);
635 
636         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA256AndAES_256&quot;,
637                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA256AndAES_256&quot;,
638                 null, null);
639 
640         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA384AndAES_256&quot;,
641                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA384AndAES_256&quot;,
642                 null, null);
643 
644         ps(&quot;SecretKeyFactory&quot;, &quot;PBEWithHmacSHA512AndAES_256&quot;,
645                 &quot;com.sun.crypto.provider.PBEKeyFactory$PBEWithHmacSHA512AndAES_256&quot;,
646                 null, null);
647 
648         // PBKDF2
649         ps(&quot;SecretKeyFactory&quot;, &quot;PBKDF2WithHmacSHA1&quot;,
650                 &quot;com.sun.crypto.provider.PBKDF2Core$HmacSHA1&quot;,
651                 pkcs5PBKDF2Aliases, null);
652         ps(&quot;SecretKeyFactory&quot;, &quot;PBKDF2WithHmacSHA224&quot;,
653                 &quot;com.sun.crypto.provider.PBKDF2Core$HmacSHA224&quot;,
654                 null, null);
655         ps(&quot;SecretKeyFactory&quot;, &quot;PBKDF2WithHmacSHA256&quot;,
656                 &quot;com.sun.crypto.provider.PBKDF2Core$HmacSHA256&quot;,
657                 null, null);
658         ps(&quot;SecretKeyFactory&quot;, &quot;PBKDF2WithHmacSHA384&quot;,
659                 &quot;com.sun.crypto.provider.PBKDF2Core$HmacSHA384&quot;,
660                 null, null);
661         ps(&quot;SecretKeyFactory&quot;, &quot;PBKDF2WithHmacSHA512&quot;,
662                 &quot;com.sun.crypto.provider.PBKDF2Core$HmacSHA512&quot;,
663                 null, null);
664 
665         /*
666          * MAC
667          */
668         attrs.clear();
669         attrs.put(&quot;SupportedKeyFormats&quot;, &quot;RAW&quot;);
670         ps(&quot;Mac&quot;, &quot;HmacMD5&quot;, &quot;com.sun.crypto.provider.HmacMD5&quot;, null, attrs);
671         ps(&quot;Mac&quot;, &quot;HmacSHA1&quot;, &quot;com.sun.crypto.provider.HmacSHA1&quot;,
672                 macSHA1Aliases, attrs);
673         ps(&quot;Mac&quot;, &quot;HmacSHA224&quot;, &quot;com.sun.crypto.provider.HmacCore$HmacSHA224&quot;,
674                 macSHA224Aliases, attrs);
675         ps(&quot;Mac&quot;, &quot;HmacSHA256&quot;, &quot;com.sun.crypto.provider.HmacCore$HmacSHA256&quot;,
676                 macSHA256Aliases, attrs);
677         ps(&quot;Mac&quot;, &quot;HmacSHA384&quot;, &quot;com.sun.crypto.provider.HmacCore$HmacSHA384&quot;,
678                 macSHA384Aliases, attrs);
679         ps(&quot;Mac&quot;, &quot;HmacSHA512&quot;, &quot;com.sun.crypto.provider.HmacCore$HmacSHA512&quot;,
680                 macSHA512Aliases, attrs);
681         // TODO: aliases with OIDs
682         ps(&quot;Mac&quot;, &quot;HmacSHA512/224&quot;,
683                 &quot;com.sun.crypto.provider.HmacCore$HmacSHA512_224&quot;,
684                 null, attrs);
685         ps(&quot;Mac&quot;, &quot;HmacSHA512/256&quot;,
686                 &quot;com.sun.crypto.provider.HmacCore$HmacSHA512_256&quot;,
687                 null, attrs);
688         ps(&quot;Mac&quot;, &quot;HmacPBESHA1&quot;,
689                 &quot;com.sun.crypto.provider.HmacPKCS12PBECore$HmacPKCS12PBE_SHA1&quot;,
690                 null, attrs);
691         ps(&quot;Mac&quot;, &quot;HmacPBESHA224&quot;,
692                 &quot;com.sun.crypto.provider.HmacPKCS12PBECore$HmacPKCS12PBE_SHA224&quot;,
693                 null, attrs);
694         ps(&quot;Mac&quot;, &quot;HmacPBESHA256&quot;,
695                 &quot;com.sun.crypto.provider.HmacPKCS12PBECore$HmacPKCS12PBE_SHA256&quot;,
696                 null, attrs);
697         ps(&quot;Mac&quot;, &quot;HmacPBESHA384&quot;,
698                 &quot;com.sun.crypto.provider.HmacPKCS12PBECore$HmacPKCS12PBE_SHA384&quot;,
699                 null, attrs);
700         ps(&quot;Mac&quot;, &quot;HmacPBESHA512&quot;,
701                 &quot;com.sun.crypto.provider.HmacPKCS12PBECore$HmacPKCS12PBE_SHA512&quot;,
702                 null, attrs);
703         ps(&quot;Mac&quot;, &quot;HmacPBESHA512/224&quot;,
704                 &quot;com.sun.crypto.provider.HmacPKCS12PBECore$HmacPKCS12PBE_SHA512_224&quot;,
705                 null, attrs);
706         ps(&quot;Mac&quot;, &quot;HmacPBESHA512/256&quot;,
707                 &quot;com.sun.crypto.provider.HmacPKCS12PBECore$HmacPKCS12PBE_SHA512_256&quot;,
708                 null, attrs);
709 
710 
711         // PBMAC1
712         ps(&quot;Mac&quot;, &quot;PBEWithHmacSHA1&quot;,
713                 &quot;com.sun.crypto.provider.PBMAC1Core$HmacSHA1&quot;, null, attrs);
714         ps(&quot;Mac&quot;, &quot;PBEWithHmacSHA224&quot;,
715                 &quot;com.sun.crypto.provider.PBMAC1Core$HmacSHA224&quot;, null, attrs);
716         ps(&quot;Mac&quot;, &quot;PBEWithHmacSHA256&quot;,
717                 &quot;com.sun.crypto.provider.PBMAC1Core$HmacSHA256&quot;, null, attrs);
718         ps(&quot;Mac&quot;, &quot;PBEWithHmacSHA384&quot;,
719                 &quot;com.sun.crypto.provider.PBMAC1Core$HmacSHA384&quot;, null, attrs);
720         ps(&quot;Mac&quot;, &quot;PBEWithHmacSHA512&quot;,
721                 &quot;com.sun.crypto.provider.PBMAC1Core$HmacSHA512&quot;, null, attrs);
722         ps(&quot;Mac&quot;, &quot;SslMacMD5&quot;,
723                 &quot;com.sun.crypto.provider.SslMacCore$SslMacMD5&quot;, null, attrs);
724         ps(&quot;Mac&quot;, &quot;SslMacSHA1&quot;,
725                 &quot;com.sun.crypto.provider.SslMacCore$SslMacSHA1&quot;, null, attrs);
726 
727         /*
728          * KeyStore
729          */
730         ps(&quot;KeyStore&quot;, &quot;JCEKS&quot;,
731                 &quot;com.sun.crypto.provider.JceKeyStore&quot;,
732                 null, null);
733 
734         /*
735          * SSL/TLS mechanisms
736          *
737          * These are strictly internal implementations and may
738          * be changed at any time.  These names were chosen
739          * because PKCS11/SunPKCS11 does not yet have TLS1.2
740          * mechanisms, and it will cause calls to come here.
741          */
742         ps(&quot;KeyGenerator&quot;, &quot;SunTlsPrf&quot;,
743                 &quot;com.sun.crypto.provider.TlsPrfGenerator$V10&quot;,
744                 null, null);
745         ps(&quot;KeyGenerator&quot;, &quot;SunTls12Prf&quot;,
746                 &quot;com.sun.crypto.provider.TlsPrfGenerator$V12&quot;,
747                 null, null);
748 
749         ps(&quot;KeyGenerator&quot;, &quot;SunTlsMasterSecret&quot;,
750                 &quot;com.sun.crypto.provider.TlsMasterSecretGenerator&quot;,
751                 createAliases(&quot;SunTls12MasterSecret&quot;,
752                     &quot;SunTlsExtendedMasterSecret&quot;), null);
753 
754         ps(&quot;KeyGenerator&quot;, &quot;SunTlsKeyMaterial&quot;,
755                 &quot;com.sun.crypto.provider.TlsKeyMaterialGenerator&quot;,
756                 createAliases(&quot;SunTls12KeyMaterial&quot;), null);
757 
758         ps(&quot;KeyGenerator&quot;, &quot;SunTlsRsaPremasterSecret&quot;,
759                 &quot;com.sun.crypto.provider.TlsRsaPremasterSecretGenerator&quot;,
760                 createAliases(&quot;SunTls12RsaPremasterSecret&quot;), null);
761     }
762 
763     // Return the instance of this class or create one if needed.
764     static SunJCE getInstance() {
765         if (instance == null) {
766             return new SunJCE();
767         }
768         return instance;
769     }
770 }
    </pre>
  </body>
</html>