<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/com/sun/crypto/provider/RSACipher.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="PBKDF2KeyImpl.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SealedObjectForKeyProtector.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/com/sun/crypto/provider/RSACipher.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
246 
247     // initialize this cipher
248     @SuppressWarnings(&quot;deprecation&quot;)
249     private void init(int opmode, Key key, SecureRandom random,
250             AlgorithmParameterSpec params)
251             throws InvalidKeyException, InvalidAlgorithmParameterException {
252         boolean encrypt;
253         switch (opmode) {
254         case Cipher.ENCRYPT_MODE:
255         case Cipher.WRAP_MODE:
256             encrypt = true;
257             break;
258         case Cipher.DECRYPT_MODE:
259         case Cipher.UNWRAP_MODE:
260             encrypt = false;
261             break;
262         default:
263             throw new InvalidKeyException(&quot;Unknown mode: &quot; + opmode);
264         }
265         RSAKey rsaKey = RSAKeyFactory.toRSAKey(key);
<span class="line-modified">266         if (key instanceof RSAPublicKey) {</span>
267             mode = encrypt ? MODE_ENCRYPT : MODE_VERIFY;
<span class="line-modified">268             publicKey = (RSAPublicKey)key;</span>
269             privateKey = null;
270         } else { // must be RSAPrivateKey per check in toRSAKey
271             mode = encrypt ? MODE_SIGN : MODE_DECRYPT;
<span class="line-modified">272             privateKey = (RSAPrivateKey)key;</span>
273             publicKey = null;
274         }
275         int n = RSACore.getByteLength(rsaKey.getModulus());
276         outputSize = n;
277         bufOfs = 0;
278         if (paddingType == PAD_NONE) {
279             if (params != null) {
280                 throw new InvalidAlgorithmParameterException
281                 (&quot;Parameters not supported&quot;);
282             }
283             padding = RSAPadding.getInstance(RSAPadding.PAD_NONE, n, random);
284             buffer = new byte[n];
285         } else if (paddingType == PAD_PKCS1) {
286             if (params != null) {
287                 if (!(params instanceof TlsRsaPremasterSecretParameterSpec)) {
288                     throw new InvalidAlgorithmParameterException(
289                             &quot;Parameters not supported&quot;);
290                 }
291 
292                 spec = params;
</pre>
</td>
<td>
<hr />
<pre>
246 
247     // initialize this cipher
248     @SuppressWarnings(&quot;deprecation&quot;)
249     private void init(int opmode, Key key, SecureRandom random,
250             AlgorithmParameterSpec params)
251             throws InvalidKeyException, InvalidAlgorithmParameterException {
252         boolean encrypt;
253         switch (opmode) {
254         case Cipher.ENCRYPT_MODE:
255         case Cipher.WRAP_MODE:
256             encrypt = true;
257             break;
258         case Cipher.DECRYPT_MODE:
259         case Cipher.UNWRAP_MODE:
260             encrypt = false;
261             break;
262         default:
263             throw new InvalidKeyException(&quot;Unknown mode: &quot; + opmode);
264         }
265         RSAKey rsaKey = RSAKeyFactory.toRSAKey(key);
<span class="line-modified">266         if (rsaKey instanceof RSAPublicKey) {</span>
267             mode = encrypt ? MODE_ENCRYPT : MODE_VERIFY;
<span class="line-modified">268             publicKey = (RSAPublicKey)rsaKey;</span>
269             privateKey = null;
270         } else { // must be RSAPrivateKey per check in toRSAKey
271             mode = encrypt ? MODE_SIGN : MODE_DECRYPT;
<span class="line-modified">272             privateKey = (RSAPrivateKey)rsaKey;</span>
273             publicKey = null;
274         }
275         int n = RSACore.getByteLength(rsaKey.getModulus());
276         outputSize = n;
277         bufOfs = 0;
278         if (paddingType == PAD_NONE) {
279             if (params != null) {
280                 throw new InvalidAlgorithmParameterException
281                 (&quot;Parameters not supported&quot;);
282             }
283             padding = RSAPadding.getInstance(RSAPadding.PAD_NONE, n, random);
284             buffer = new byte[n];
285         } else if (paddingType == PAD_PKCS1) {
286             if (params != null) {
287                 if (!(params instanceof TlsRsaPremasterSecretParameterSpec)) {
288                     throw new InvalidAlgorithmParameterException(
289                             &quot;Parameters not supported&quot;);
290                 }
291 
292                 spec = params;
</pre>
</td>
</tr>
</table>
<center><a href="PBKDF2KeyImpl.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SealedObjectForKeyProtector.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>