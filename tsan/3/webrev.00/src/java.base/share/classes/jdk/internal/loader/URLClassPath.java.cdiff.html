<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/jdk/internal/loader/URLClassPath.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="Resource.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../math/FDBigInteger.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/jdk/internal/loader/URLClassPath.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 101,14 ***</span>
  
          p = props.getProperty(&quot;jdk.net.URLClassPath.disableRestrictedPermissions&quot;);
          DISABLE_ACC_CHECKING = p != null ? p.equals(&quot;true&quot;) || p.isEmpty() : false;
  
          // This property will be removed in a later release
<span class="line-modified">!         p = props.getProperty(&quot;jdk.net.URLClassPath.disableClassPathURLCheck&quot;, &quot;true&quot;);</span>
<span class="line-removed">- </span>
          DISABLE_CP_URL_CHECK = p != null ? p.equals(&quot;true&quot;) || p.isEmpty() : false;
<span class="line-modified">!         DEBUG_CP_URL_CHECK = &quot;debug&quot;.equals(p);</span>
      }
  
      /* The original search path of URLs. */
      private final ArrayList&lt;URL&gt; path;
  
<span class="line-new-header">--- 101,17 ---</span>
  
          p = props.getProperty(&quot;jdk.net.URLClassPath.disableRestrictedPermissions&quot;);
          DISABLE_ACC_CHECKING = p != null ? p.equals(&quot;true&quot;) || p.isEmpty() : false;
  
          // This property will be removed in a later release
<span class="line-modified">!         p = props.getProperty(&quot;jdk.net.URLClassPath.disableClassPathURLCheck&quot;);</span>
          DISABLE_CP_URL_CHECK = p != null ? p.equals(&quot;true&quot;) || p.isEmpty() : false;
<span class="line-modified">! </span>
<span class="line-added">+         // Print a message for each Class-Path entry that is ignored (assuming</span>
<span class="line-added">+         // the check is not disabled).</span>
<span class="line-added">+         p = props.getProperty(&quot;jdk.net.URLClassPath.showIgnoredClassPathEntries&quot;);</span>
<span class="line-added">+         DEBUG_CP_URL_CHECK = p != null ? p.equals(&quot;true&quot;) || p.isEmpty() : false;</span>
      }
  
      /* The original search path of URLs. */
      private final ArrayList&lt;URL&gt; path;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 694,11 ***</span>
      }
  
      /*
       * Nested class used to represent a Loader of resources from a JAR URL.
       */
<span class="line-modified">!     static class JarLoader extends Loader {</span>
          private JarFile jar;
          private final URL csu;
          private JarIndex index;
          private URLStreamHandler handler;
          private final HashMap&lt;String, Loader&gt; lmap;
<span class="line-new-header">--- 697,11 ---</span>
      }
  
      /*
       * Nested class used to represent a Loader of resources from a JAR URL.
       */
<span class="line-modified">!     private static class JarLoader extends Loader {</span>
          private JarFile jar;
          private final URL csu;
          private JarIndex index;
          private URLStreamHandler handler;
          private final HashMap&lt;String, Loader&gt; lmap;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 709,13 ***</span>
  
          /*
           * Creates a new JarLoader for the specified URL referring to
           * a JAR file.
           */
<span class="line-modified">!         JarLoader(URL url, URLStreamHandler jarHandler,</span>
<span class="line-modified">!                   HashMap&lt;String, Loader&gt; loaderMap,</span>
<span class="line-modified">!                   AccessControlContext acc)</span>
              throws IOException
          {
              super(new URL(&quot;jar&quot;, &quot;&quot;, -1, url + &quot;!/&quot;, jarHandler));
              csu = url;
              handler = jarHandler;
<span class="line-new-header">--- 712,13 ---</span>
  
          /*
           * Creates a new JarLoader for the specified URL referring to
           * a JAR file.
           */
<span class="line-modified">!         private JarLoader(URL url, URLStreamHandler jarHandler,</span>
<span class="line-modified">!                           HashMap&lt;String, Loader&gt; loaderMap,</span>
<span class="line-modified">!                           AccessControlContext acc)</span>
              throws IOException
          {
              super(new URL(&quot;jar&quot;, &quot;&quot;, -1, url + &quot;!/&quot;, jarHandler));
              csu = url;
              handler = jarHandler;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1120,31 ***</span>
              }
          }
  
          /**
           * Attempt to return a file URL by resolving input against a base file
<span class="line-modified">!          * URL. The input is an absolute or relative file URL that encodes a</span>
<span class="line-removed">-          * file path.</span>
<span class="line-removed">-          *</span>
<span class="line-removed">-          * @apiNote Nonsensical input such as a Windows file path with a drive</span>
<span class="line-removed">-          * letter cannot be disambiguated from an absolute URL so will be rejected</span>
<span class="line-removed">-          * (by returning null) by this method.</span>
<span class="line-removed">-          *</span>
           * @return the resolved URL or null if the input is an absolute URL with
           *         a scheme other than file (ignoring case)
           * @throws MalformedURLException
           */
          static URL tryResolveFile(URL base, String input) throws MalformedURLException {
<span class="line-modified">!             int index = input.indexOf(&#39;:&#39;);</span>
<span class="line-modified">!             boolean isFile;</span>
<span class="line-modified">!             if (index &gt;= 0) {</span>
<span class="line-modified">!                 String scheme = input.substring(0, index);</span>
<span class="line-modified">!                 isFile = &quot;file&quot;.equalsIgnoreCase(scheme);</span>
<span class="line-modified">!             } else {</span>
<span class="line-modified">!                 isFile = true;</span>
              }
<span class="line-modified">!             return (isFile) ? new URL(base, input) : null;</span>
          }
  
          /**
           * Attempt to return a URL by resolving input against a base URL. Returns
           * null if the resolved URL is not contained by the base URL.
<span class="line-new-header">--- 1123,25 ---</span>
              }
          }
  
          /**
           * Attempt to return a file URL by resolving input against a base file
<span class="line-modified">!          * URL.</span>
           * @return the resolved URL or null if the input is an absolute URL with
           *         a scheme other than file (ignoring case)
           * @throws MalformedURLException
           */
          static URL tryResolveFile(URL base, String input) throws MalformedURLException {
<span class="line-modified">!             URL retVal = new URL(base, input);</span>
<span class="line-modified">!             if (input.indexOf(&#39;:&#39;) &gt;= 0 &amp;&amp;</span>
<span class="line-modified">!                     !&quot;file&quot;.equalsIgnoreCase(retVal.getProtocol())) {</span>
<span class="line-modified">!                 // &#39;input&#39; contains a &#39;:&#39;, which might be a scheme, or might be</span>
<span class="line-modified">!                 // a Windows drive letter.  If the protocol for the resolved URL</span>
<span class="line-modified">!                 // isn&#39;t &quot;file:&quot;, it should be ignored.</span>
<span class="line-modified">!                 return null;</span>
              }
<span class="line-modified">!             return retVal;</span>
          }
  
          /**
           * Attempt to return a URL by resolving input against a base URL. Returns
           * null if the resolved URL is not contained by the base URL.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1188,15 ***</span>
       */
      private static class FileLoader extends Loader {
          /* Canonicalized File */
          private File dir;
  
<span class="line-modified">!         FileLoader(URL url) throws IOException {</span>
              super(url);
<span class="line-removed">-             if (!&quot;file&quot;.equals(url.getProtocol())) {</span>
<span class="line-removed">-                 throw new IllegalArgumentException(&quot;url&quot;);</span>
<span class="line-removed">-             }</span>
              String path = url.getFile().replace(&#39;/&#39;, File.separatorChar);
              path = ParseUtil.decode(path);
              dir = (new File(path)).getCanonicalFile();
          }
  
<span class="line-new-header">--- 1185,15 ---</span>
       */
      private static class FileLoader extends Loader {
          /* Canonicalized File */
          private File dir;
  
<span class="line-modified">!         /*</span>
<span class="line-added">+          * Creates a new FileLoader for the specified URL with a file protocol.</span>
<span class="line-added">+          */</span>
<span class="line-added">+         private FileLoader(URL url) throws IOException {</span>
              super(url);
              String path = url.getFile().replace(&#39;/&#39;, File.separatorChar);
              path = ParseUtil.decode(path);
              dir = (new File(path)).getCanonicalFile();
          }
  
</pre>
<center><a href="Resource.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../math/FDBigInteger.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>