<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.base/share/classes/jdk/internal/util/StaticProperty.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="ArraysSupport.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="SystemProps.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/jdk/internal/util/StaticProperty.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2018, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -23,10 +23,12 @@</span>
   * questions.
   */
  
  package jdk.internal.util;
  
<span class="udiff-line-added">+ import java.util.Properties;</span>
<span class="udiff-line-added">+ </span>
  /**
   * System Property access for internal use only.
   * Read-only access to System property values initialized during Phase 1
   * are cached.  Setting, clearing, or modifying the value using
   * {@link System#setProperty) or {@link System#getProperties()} is ignored.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -36,25 +38,45 @@</span>
   */
  public final class StaticProperty {
  
      // The class static initialization is triggered to initialize these final
      // fields during init Phase 1 and before a security manager is set.
<span class="udiff-line-modified-removed">-     private static final String JAVA_HOME = initProperty(&quot;java.home&quot;);</span>
<span class="udiff-line-modified-removed">-     private static final String USER_HOME = initProperty(&quot;user.home&quot;);</span>
<span class="udiff-line-modified-removed">-     private static final String USER_DIR  = initProperty(&quot;user.dir&quot;);</span>
<span class="udiff-line-modified-removed">-     private static final String USER_NAME = initProperty(&quot;user.name&quot;);</span>
<span class="udiff-line-modified-added">+     private static final String JAVA_HOME;</span>
<span class="udiff-line-modified-added">+     private static final String USER_HOME;</span>
<span class="udiff-line-modified-added">+     private static final String USER_DIR;</span>
<span class="udiff-line-modified-added">+     private static final String USER_NAME;</span>
<span class="udiff-line-added">+     private static final String JAVA_LIBRARY_PATH;</span>
<span class="udiff-line-added">+     private static final String SUN_BOOT_LIBRARY_PATH;</span>
<span class="udiff-line-added">+     private static final String JDK_SERIAL_FILTER;</span>
  
      private StaticProperty() {}
  
<span class="udiff-line-modified-removed">-     private static String initProperty(String key) {</span>
<span class="udiff-line-modified-removed">-         String v = System.getProperty(key);</span>
<span class="udiff-line-modified-added">+     static {</span>
<span class="udiff-line-modified-added">+         Properties props = System.getProperties();</span>
<span class="udiff-line-added">+         JAVA_HOME = getProperty(props, &quot;java.home&quot;);</span>
<span class="udiff-line-added">+         USER_HOME = getProperty(props, &quot;user.home&quot;);</span>
<span class="udiff-line-added">+         USER_DIR  = getProperty(props, &quot;user.dir&quot;);</span>
<span class="udiff-line-added">+         USER_NAME = getProperty(props, &quot;user.name&quot;);</span>
<span class="udiff-line-added">+         JAVA_LIBRARY_PATH = getProperty(props, &quot;java.library.path&quot;, &quot;&quot;);</span>
<span class="udiff-line-added">+         SUN_BOOT_LIBRARY_PATH = getProperty(props, &quot;sun.boot.library.path&quot;, &quot;&quot;);</span>
<span class="udiff-line-added">+         JDK_SERIAL_FILTER = getProperty(props, &quot;jdk.serialFilter&quot;, null);</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     private static String getProperty(Properties props, String key) {</span>
<span class="udiff-line-added">+         String v = props.getProperty(key);</span>
          if (v == null) {
              throw new InternalError(&quot;null property: &quot; + key);
          }
          return v;
      }
  
<span class="udiff-line-added">+     private static String getProperty(Properties props, String key,</span>
<span class="udiff-line-added">+                                       String defaultVal) {</span>
<span class="udiff-line-added">+         String v = props.getProperty(key);</span>
<span class="udiff-line-added">+         return (v == null) ? defaultVal : v;</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
      /**
       * Return the {@code java.home} system property.
       *
       * &lt;strong&gt;{@link SecurityManager#checkPropertyAccess} is NOT checked
       * in this method. The caller of this method should take care to ensure
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -102,6 +124,46 @@</span>
       * @return the {@code user.name} system property
       */
      public static String userName() {
          return USER_NAME;
      }
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     /**</span>
<span class="udiff-line-added">+      * Return the {@code java.library.path} system property.</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * &lt;strong&gt;{@link SecurityManager#checkPropertyAccess} is NOT checked</span>
<span class="udiff-line-added">+      * in this method. The caller of this method should take care to ensure</span>
<span class="udiff-line-added">+      * that the returned property is not made accessible to untrusted code.&lt;/strong&gt;</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * @return the {@code java.library.path} system property</span>
<span class="udiff-line-added">+      */</span>
<span class="udiff-line-added">+     public static String javaLibraryPath() {</span>
<span class="udiff-line-added">+         return JAVA_LIBRARY_PATH;</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     /**</span>
<span class="udiff-line-added">+      * Return the {@code sun.boot.library.path} system property.</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * &lt;strong&gt;{@link SecurityManager#checkPropertyAccess} is NOT checked</span>
<span class="udiff-line-added">+      * in this method. The caller of this method should take care to ensure</span>
<span class="udiff-line-added">+      * that the returned property is not made accessible to untrusted code.&lt;/strong&gt;</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * @return the {@code sun.boot.library.path} system property</span>
<span class="udiff-line-added">+      */</span>
<span class="udiff-line-added">+     public static String sunBootLibraryPath() {</span>
<span class="udiff-line-added">+         return SUN_BOOT_LIBRARY_PATH;</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     /**</span>
<span class="udiff-line-added">+      * Return the {@code jdk.serialFilter} system property.</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * &lt;strong&gt;{@link SecurityManager#checkPropertyAccess} is NOT checked</span>
<span class="udiff-line-added">+      * in this method. The caller of this method should take care to ensure</span>
<span class="udiff-line-added">+      * that the returned property is not made accessible to untrusted code.&lt;/strong&gt;</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * @return the {@code user.name} system property</span>
<span class="udiff-line-added">+      */</span>
<span class="udiff-line-added">+     public static String jdkSerialFilter() {</span>
<span class="udiff-line-added">+         return JDK_SERIAL_FILTER;</span>
<span class="udiff-line-added">+     }</span>
  }
</pre>
<center><a href="ArraysSupport.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="SystemProps.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>