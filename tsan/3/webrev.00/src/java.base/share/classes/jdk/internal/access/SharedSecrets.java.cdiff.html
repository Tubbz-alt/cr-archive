<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/jdk/internal/access/SharedSecrets.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="JavaUtilJarAccess.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../event/EventHelper.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/jdk/internal/access/SharedSecrets.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 34,10 ***</span>
<span class="line-new-header">--- 34,11 ---</span>
  import java.io.FileDescriptor;
  import java.io.FilePermission;
  import java.io.ObjectInputStream;
  import java.io.RandomAccessFile;
  import java.security.ProtectionDomain;
<span class="line-added">+ import java.security.Signature;</span>
  import jdk.internal.misc.Unsafe;
  
  /** A repository of &quot;shared secrets&quot;, which are a mechanism for
      calling implementation-private methods in another package without
      using reflection. A package-private class implements a public
</pre>
<hr />
<pre>
<span class="line-old-header">*** 47,34 ***</span>
      This framework avoids the primary disadvantage of using reflection
      for this purpose, namely the loss of compile-time checking. */
  
  public class SharedSecrets {
      private static final Unsafe unsafe = Unsafe.getUnsafe();
<span class="line-modified">!     private static JavaUtilJarAccess javaUtilJarAccess;</span>
      private static JavaLangAccess javaLangAccess;
<span class="line-removed">-     private static JavaLangModuleAccess javaLangModuleAccess;</span>
      private static JavaLangInvokeAccess javaLangInvokeAccess;
      private static JavaLangRefAccess javaLangRefAccess;
      private static JavaIOAccess javaIOAccess;
      private static JavaNetInetAddressAccess javaNetInetAddressAccess;
      private static JavaNetHttpCookieAccess javaNetHttpCookieAccess;
<span class="line-removed">-     private static JavaNetSocketAccess javaNetSocketAccess;</span>
      private static JavaNetUriAccess javaNetUriAccess;
      private static JavaNetURLAccess javaNetURLAccess;
<span class="line-removed">-     private static JavaNetURLClassLoaderAccess javaNetURLClassLoaderAccess;</span>
      private static JavaNioAccess javaNioAccess;
<span class="line-modified">!     private static JavaIOFileDescriptorAccess javaIOFileDescriptorAccess;</span>
<span class="line-removed">-     private static JavaIOFilePermissionAccess javaIOFilePermissionAccess;</span>
<span class="line-removed">-     private static JavaSecurityAccess javaSecurityAccess;</span>
      private static JavaUtilZipFileAccess javaUtilZipFileAccess;
      private static JavaUtilResourceBundleAccess javaUtilResourceBundleAccess;
<span class="line-modified">!     private static JavaAWTAccess javaAWTAccess;</span>
<span class="line-modified">!     private static JavaAWTFontAccess javaAWTFontAccess;</span>
<span class="line-removed">-     private static JavaBeansAccess javaBeansAccess;</span>
<span class="line-removed">-     private static JavaObjectInputStreamAccess javaObjectInputStreamAccess;</span>
<span class="line-removed">-     private static JavaObjectInputFilterAccess javaObjectInputFilterAccess;</span>
<span class="line-removed">-     private static JavaIORandomAccessFileAccess javaIORandomAccessFileAccess;</span>
      private static JavaxCryptoSealedObjectAccess javaxCryptoSealedObjectAccess;
  
      public static JavaUtilJarAccess javaUtilJarAccess() {
          if (javaUtilJarAccess == null) {
              // Ensure JarFile is initialized; we know that this class
<span class="line-new-header">--- 48,35 ---</span>
      This framework avoids the primary disadvantage of using reflection
      for this purpose, namely the loss of compile-time checking. */
  
  public class SharedSecrets {
      private static final Unsafe unsafe = Unsafe.getUnsafe();
<span class="line-modified">!     private static JavaAWTAccess javaAWTAccess;</span>
<span class="line-added">+     private static JavaAWTFontAccess javaAWTFontAccess;</span>
<span class="line-added">+     private static JavaBeansAccess javaBeansAccess;</span>
      private static JavaLangAccess javaLangAccess;
      private static JavaLangInvokeAccess javaLangInvokeAccess;
<span class="line-added">+     private static JavaLangModuleAccess javaLangModuleAccess;</span>
      private static JavaLangRefAccess javaLangRefAccess;
<span class="line-added">+     private static JavaLangReflectAccess javaLangReflectAccess;</span>
      private static JavaIOAccess javaIOAccess;
<span class="line-added">+     private static JavaIOFileDescriptorAccess javaIOFileDescriptorAccess;</span>
<span class="line-added">+     private static JavaIOFilePermissionAccess javaIOFilePermissionAccess;</span>
<span class="line-added">+     private static JavaIORandomAccessFileAccess javaIORandomAccessFileAccess;</span>
<span class="line-added">+     private static JavaObjectInputStreamReadString javaObjectInputStreamReadString;</span>
<span class="line-added">+     private static JavaObjectInputStreamAccess javaObjectInputStreamAccess;</span>
<span class="line-added">+     private static JavaObjectInputFilterAccess javaObjectInputFilterAccess;</span>
      private static JavaNetInetAddressAccess javaNetInetAddressAccess;
      private static JavaNetHttpCookieAccess javaNetHttpCookieAccess;
      private static JavaNetUriAccess javaNetUriAccess;
      private static JavaNetURLAccess javaNetURLAccess;
      private static JavaNioAccess javaNioAccess;
<span class="line-modified">!     private static JavaUtilJarAccess javaUtilJarAccess;</span>
      private static JavaUtilZipFileAccess javaUtilZipFileAccess;
      private static JavaUtilResourceBundleAccess javaUtilResourceBundleAccess;
<span class="line-modified">!     private static JavaSecurityAccess javaSecurityAccess;</span>
<span class="line-modified">!     private static JavaSecuritySignatureAccess javaSecuritySignatureAccess;</span>
      private static JavaxCryptoSealedObjectAccess javaxCryptoSealedObjectAccess;
  
      public static JavaUtilJarAccess javaUtilJarAccess() {
          if (javaUtilJarAccess == null) {
              // Ensure JarFile is initialized; we know that this class
</pre>
<hr />
<pre>
<span class="line-old-header">*** 127,10 ***</span>
<span class="line-new-header">--- 129,18 ---</span>
  
      public static JavaLangRefAccess getJavaLangRefAccess() {
          return javaLangRefAccess;
      }
  
<span class="line-added">+     public static void setJavaLangReflectAccess(JavaLangReflectAccess jlra) {</span>
<span class="line-added">+         javaLangReflectAccess = jlra;</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
<span class="line-added">+     public static JavaLangReflectAccess getJavaLangReflectAccess() {</span>
<span class="line-added">+         return javaLangReflectAccess;</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      public static void setJavaNetUriAccess(JavaNetUriAccess jnua) {
          javaNetUriAccess = jnua;
      }
  
      public static JavaNetUriAccess getJavaNetUriAccess() {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 147,20 ***</span>
          if (javaNetURLAccess == null)
              unsafe.ensureClassInitialized(java.net.URL.class);
          return javaNetURLAccess;
      }
  
<span class="line-removed">-     public static void setJavaNetURLClassLoaderAccess(JavaNetURLClassLoaderAccess jnua) {</span>
<span class="line-removed">-         javaNetURLClassLoaderAccess = jnua;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     public static JavaNetURLClassLoaderAccess getJavaNetURLClassLoaderAccess() {</span>
<span class="line-removed">-         if (javaNetURLClassLoaderAccess == null)</span>
<span class="line-removed">-             unsafe.ensureClassInitialized(java.net.URLClassLoader.class);</span>
<span class="line-removed">-         return javaNetURLClassLoaderAccess;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      public static void setJavaNetInetAddressAccess(JavaNetInetAddressAccess jna) {
          javaNetInetAddressAccess = jna;
      }
  
      public static JavaNetInetAddressAccess getJavaNetInetAddressAccess() {
<span class="line-new-header">--- 157,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 177,20 ***</span>
          if (javaNetHttpCookieAccess == null)
              unsafe.ensureClassInitialized(java.net.HttpCookie.class);
          return javaNetHttpCookieAccess;
      }
  
<span class="line-removed">-     public static void setJavaNetSocketAccess(JavaNetSocketAccess jnsa) {</span>
<span class="line-removed">-         javaNetSocketAccess = jnsa;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     public static JavaNetSocketAccess getJavaNetSocketAccess() {</span>
<span class="line-removed">-         if (javaNetSocketAccess == null)</span>
<span class="line-removed">-             unsafe.ensureClassInitialized(java.net.ServerSocket.class);</span>
<span class="line-removed">-         return javaNetSocketAccess;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      public static void setJavaNioAccess(JavaNioAccess jna) {
          javaNioAccess = jna;
      }
  
      public static JavaNioAccess getJavaNioAccess() {
<span class="line-new-header">--- 177,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 292,10 ***</span>
<span class="line-new-header">--- 282,21 ---</span>
  
      public static void setJavaUtilResourceBundleAccess(JavaUtilResourceBundleAccess access) {
          javaUtilResourceBundleAccess = access;
      }
  
<span class="line-added">+     public static JavaObjectInputStreamReadString getJavaObjectInputStreamReadString() {</span>
<span class="line-added">+         if (javaObjectInputStreamReadString == null) {</span>
<span class="line-added">+             unsafe.ensureClassInitialized(ObjectInputStream.class);</span>
<span class="line-added">+         }</span>
<span class="line-added">+         return javaObjectInputStreamReadString;</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
<span class="line-added">+     public static void setJavaObjectInputStreamReadString(JavaObjectInputStreamReadString access) {</span>
<span class="line-added">+         javaObjectInputStreamReadString = access;</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      public static JavaObjectInputStreamAccess getJavaObjectInputStreamAccess() {
          if (javaObjectInputStreamAccess == null) {
              unsafe.ensureClassInitialized(ObjectInputStream.class);
          }
          return javaObjectInputStreamAccess;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 325,10 ***</span>
<span class="line-new-header">--- 326,21 ---</span>
              unsafe.ensureClassInitialized(RandomAccessFile.class);
          }
          return javaIORandomAccessFileAccess;
      }
  
<span class="line-added">+     public static void setJavaSecuritySignatureAccess(JavaSecuritySignatureAccess jssa) {</span>
<span class="line-added">+         javaSecuritySignatureAccess = jssa;</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
<span class="line-added">+     public static JavaSecuritySignatureAccess getJavaSecuritySignatureAccess() {</span>
<span class="line-added">+         if (javaSecuritySignatureAccess == null) {</span>
<span class="line-added">+             unsafe.ensureClassInitialized(Signature.class);</span>
<span class="line-added">+         }</span>
<span class="line-added">+         return javaSecuritySignatureAccess;</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      public static void setJavaxCryptoSealedObjectAccess(JavaxCryptoSealedObjectAccess jcsoa) {
          javaxCryptoSealedObjectAccess = jcsoa;
      }
  
      public static JavaxCryptoSealedObjectAccess getJavaxCryptoSealedObjectAccess() {
</pre>
<center><a href="JavaUtilJarAccess.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../event/EventHelper.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>