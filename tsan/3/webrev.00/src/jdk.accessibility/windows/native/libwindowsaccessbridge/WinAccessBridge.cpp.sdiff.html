<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.accessibility/windows/native/libwindowsaccessbridge/WinAccessBridge.cpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../libjavaaccessbridge/JavaAccessBridge.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../../../../jdk.aot/share/classes/jdk.tools.jaotc.binformat/src/jdk/tools/jaotc/binformat/BinaryContainer.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.accessibility/windows/native/libwindowsaccessbridge/WinAccessBridge.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2005, 2016, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 113         ;
 114     }
 115     return FALSE;
 116 }
 117 
 118 
 119 
 120 /* =========================================================================== */
 121 
 122 // ---------------------------------------------------------------------------
 123 
 124 extern &quot;C&quot; {
 125     /**
 126      * DllMain - where Windows executables will load/unload us
 127      *
 128      */
 129     BOOL WINAPI DllMain(HINSTANCE hinstDll, DWORD fdwReason, LPVOID lpvReserved) {
 130 
 131         switch (fdwReason) {
 132         case DLL_PROCESS_ATTACH:        // A Windows executable loaded us
<span class="line-modified"> 133             initializeFileLogger(&quot;_windows_access_bridge&quot;);</span>
 134             PrintDebugString(&quot;[INFO]: DLL_PROCESS_ATTACH&quot;);
 135             theWindowsAccessBridge = new WinAccessBridge(hinstDll);
 136             break;
 137 
 138         case DLL_PROCESS_DETACH:        // A Windows executable unloaded us
 139             if (theWindowsAccessBridge != (WinAccessBridge *) 0) {
 140                 PrintDebugString(&quot;[INFO]: *** AccessBridgeDialogProc -&gt; deleting theWindowsAccessBridge&quot;);
 141                 delete theWindowsAccessBridge;
 142             }
 143             break;
 144         }
 145 
 146         return(TRUE);
 147     }
 148 
 149     /**
 150      * Append debug info to dialog
 151      *
 152      * replaced with code to send output to debug file
 153      *
</pre>
<hr />
<pre>
 279 
 280     PrintDebugString(&quot;[INFO]: *****in WinAccessBridge::~WinAccessBridge()&quot;);
 281 
 282     // send a broadcast msg.; let other AccessBridge DLLs know we&#39;re going away
 283     AccessBridgeJavaVMInstance *current = javaVMs;
 284     while (current != (AccessBridgeJavaVMInstance *) 0) {
 285         PrintDebugString(&quot;[INFO]:   telling %p we&#39;re going away&quot;, current-&gt;javaAccessBridgeWindow);
 286         SendMessage(current-&gt;javaAccessBridgeWindow,
 287                     AB_DLL_GOING_AWAY, (WPARAM) dialogWindow, (LPARAM) 0);
 288         current = current-&gt;nextJVMInstance;
 289     }
 290 
 291     PrintDebugString(&quot;[INFO]:   finished telling JVMs about our demise&quot;);
 292 
 293     delete eventHandler;
 294     delete messageQueue;
 295     delete javaVMs;
 296 
 297     PrintDebugString(&quot;[INFO]:   finished deleting eventHandler, messageQueue, and javaVMs&quot;);
 298     PrintDebugString(&quot;[INFO]: GOODBYE CRUEL WORLD...&quot;);
<span class="line-modified"> 299 </span>
 300     DestroyWindow(theDialogWindow);
 301 }
 302 
 303 
 304 /**
 305  * Bring up our window; make a connection to the rest of the world
 306  *
 307  */
 308 BOOL
 309 WinAccessBridge::initWindow() {
 310     theDialogWindow = CreateDialog(windowsInstance,
 311                                    &quot;ACCESSBRIDGESTATUSWINDOW&quot;, NULL,
 312                                    (DLGPROC) AccessBridgeDialogProc);
 313 
 314     // If window could not be created, return &quot;failure&quot;.
 315     if (!theDialogWindow)
 316         return (FALSE);
 317 
 318     dialogWindow = theDialogWindow;
 319 
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2005, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 113         ;
 114     }
 115     return FALSE;
 116 }
 117 
 118 
 119 
 120 /* =========================================================================== */
 121 
 122 // ---------------------------------------------------------------------------
 123 
 124 extern &quot;C&quot; {
 125     /**
 126      * DllMain - where Windows executables will load/unload us
 127      *
 128      */
 129     BOOL WINAPI DllMain(HINSTANCE hinstDll, DWORD fdwReason, LPVOID lpvReserved) {
 130 
 131         switch (fdwReason) {
 132         case DLL_PROCESS_ATTACH:        // A Windows executable loaded us
<span class="line-modified"> 133             initializeFileLogger(&quot;windows_access_bridge&quot;);</span>
 134             PrintDebugString(&quot;[INFO]: DLL_PROCESS_ATTACH&quot;);
 135             theWindowsAccessBridge = new WinAccessBridge(hinstDll);
 136             break;
 137 
 138         case DLL_PROCESS_DETACH:        // A Windows executable unloaded us
 139             if (theWindowsAccessBridge != (WinAccessBridge *) 0) {
 140                 PrintDebugString(&quot;[INFO]: *** AccessBridgeDialogProc -&gt; deleting theWindowsAccessBridge&quot;);
 141                 delete theWindowsAccessBridge;
 142             }
 143             break;
 144         }
 145 
 146         return(TRUE);
 147     }
 148 
 149     /**
 150      * Append debug info to dialog
 151      *
 152      * replaced with code to send output to debug file
 153      *
</pre>
<hr />
<pre>
 279 
 280     PrintDebugString(&quot;[INFO]: *****in WinAccessBridge::~WinAccessBridge()&quot;);
 281 
 282     // send a broadcast msg.; let other AccessBridge DLLs know we&#39;re going away
 283     AccessBridgeJavaVMInstance *current = javaVMs;
 284     while (current != (AccessBridgeJavaVMInstance *) 0) {
 285         PrintDebugString(&quot;[INFO]:   telling %p we&#39;re going away&quot;, current-&gt;javaAccessBridgeWindow);
 286         SendMessage(current-&gt;javaAccessBridgeWindow,
 287                     AB_DLL_GOING_AWAY, (WPARAM) dialogWindow, (LPARAM) 0);
 288         current = current-&gt;nextJVMInstance;
 289     }
 290 
 291     PrintDebugString(&quot;[INFO]:   finished telling JVMs about our demise&quot;);
 292 
 293     delete eventHandler;
 294     delete messageQueue;
 295     delete javaVMs;
 296 
 297     PrintDebugString(&quot;[INFO]:   finished deleting eventHandler, messageQueue, and javaVMs&quot;);
 298     PrintDebugString(&quot;[INFO]: GOODBYE CRUEL WORLD...&quot;);
<span class="line-modified"> 299     finalizeFileLogger();</span>
 300     DestroyWindow(theDialogWindow);
 301 }
 302 
 303 
 304 /**
 305  * Bring up our window; make a connection to the rest of the world
 306  *
 307  */
 308 BOOL
 309 WinAccessBridge::initWindow() {
 310     theDialogWindow = CreateDialog(windowsInstance,
 311                                    &quot;ACCESSBRIDGESTATUSWINDOW&quot;, NULL,
 312                                    (DLGPROC) AccessBridgeDialogProc);
 313 
 314     // If window could not be created, return &quot;failure&quot;.
 315     if (!theDialogWindow)
 316         return (FALSE);
 317 
 318     dialogWindow = theDialogWindow;
 319 
</pre>
</td>
</tr>
</table>
<center><a href="../libjavaaccessbridge/JavaAccessBridge.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../../../../jdk.aot/share/classes/jdk.tools.jaotc.binformat/src/jdk/tools/jaotc/binformat/BinaryContainer.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>