<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/jdk.pack/share/native/common-unpack/defines.h</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2001, 2016, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 // random definitions
 27 
 28 #ifdef _MSC_VER
 29 #include &lt;windows.h&gt;
 30 #include &lt;winuser.h&gt;
 31 #else
 32 #include &lt;unistd.h&gt;
 33 #endif
 34 
 35 #ifndef NO_ZLIB
 36 #include &lt;zconf.h&gt;
 37 #endif
 38 
 39 #ifndef FULL
 40 #define FULL 1 /* Adds &lt;500 bytes to the zipped final product. */
 41 #endif
 42 
 43 #if FULL  // define this if you want debugging and/or compile-time attributes
 44 #define IF_FULL(x) x
 45 #else
 46 #define IF_FULL(x) /*x*/
 47 #endif
 48 
 49 #ifdef PRODUCT
 50 #define IF_PRODUCT(xxx) xxx
 51 #define NOT_PRODUCT(xxx)
 52 #define assert(p)
 53 #define PRINTCR(args)
 54 #define VERSION_STRING &quot;%s version %s\n&quot;
 55 #else
 56 #define IF_PRODUCT(xxx)
 57 #define NOT_PRODUCT(xxx) xxx
 58 #define assert(p) ((p) || assert_failed(#p))
 59 #define PRINTCR(args)  u-&gt;verbose &amp;&amp; u-&gt;printcr_if_verbose args
 60 #define VERSION_STRING &quot;%s version non-product %s\n&quot;
 61 extern &quot;C&quot; void breakpoint();
 62 extern int assert_failed(const char*);
 63 #define BREAK (breakpoint())
 64 #endif
 65 
 66 // Build-time control of some C++ inlining.
 67 // To make a slightly faster smaller binary, say &quot;CC -Dmaybe_inline=inline&quot;
 68 #ifndef maybe_inline
 69 #define maybe_inline /*inline*/
 70 #endif
 71 // By marking larger member functions inline, we remove external linkage.
 72 #ifndef local_inline
 73 #define local_inline inline
 74 #endif
 75 
 76 // Error messages that we have
 77 #define ERROR_ENOMEM    &quot;Native allocation failed&quot;
 78 #define ERROR_FORMAT    &quot;Corrupted pack file&quot;
 79 #define ERROR_RESOURCE  &quot;Cannot extract resource file&quot;
 80 #define ERROR_OVERFLOW  &quot;Internal buffer overflow&quot;
 81 #define ERROR_INTERNAL  &quot;Internal error&quot;
 82 #define ERROR_INIT      &quot;cannot init class members&quot;
 83 
 84 #define LOGFILE_STDOUT &quot;-&quot;
 85 #define LOGFILE_STDERR &quot;&quot;
 86 
 87 #define lengthof(array) (sizeof(array)/sizeof(array[0]))
 88 
 89 #define NEW(T, n)    (T*) must_malloc((int)(scale_size(n, sizeof(T))))
 90 #define U_NEW(T, n)  (T*) u-&gt;alloc(scale_size(n, sizeof(T)))
 91 #define T_NEW(T, n)  (T*) u-&gt;temp_alloc(scale_size(n, sizeof(T)))
 92 
 93 // Dealing with big-endian arch
 94 #ifdef _BIG_ENDIAN
 95 #define SWAP_INT(a) (((a&gt;&gt;24)&amp;0xff) | ((a&lt;&lt;8)&amp;0xff0000) | ((a&gt;&gt;8)&amp;0xff00) | ((a&lt;&lt;24)&amp;0xff000000))
 96 #else
 97 #define SWAP_INT(a) (a)
 98 #endif
 99 
100 // bytes and byte arrays
101 
102 typedef unsigned int uint;
103 #if defined(NO_ZLIB)
104 #ifdef _LP64
105 typedef unsigned int uLong; // Historical zlib, should be 32-bit.
106 #else
107 typedef unsigned long uLong;
108 #endif
109 #endif
110 #ifdef _MSC_VER
111 typedef LONGLONG        jlong;
112 typedef DWORDLONG       julong;
113 #define MKDIR(dir)      mkdir(dir)
114 #define getpid()        _getpid()
115 #define PATH_MAX        MAX_PATH
116 #define dup2(a,b)       _dup2(a,b)
117 #define strcasecmp(s1, s2) _stricmp(s1,s2)
118 #define tempname        _tempname
119 #define sleep           Sleep
120 #define snprintf        _snprintf
121 #define PATH_SEPARATOR &#39;\\&#39;
122 #else
123 typedef signed char byte;
124 #ifdef _LP64
125 typedef long jlong;
126 typedef long unsigned julong;
127 #else
128 typedef long long jlong;
129 typedef long long unsigned julong;
130 #endif
131 #define MKDIR(dir) mkdir(dir, 0777);
132 #define PATH_SEPARATOR &#39;/&#39;
133 #endif
134 
135 #ifdef OLDCC
136 typedef int bool;
137 enum { false, true };
138 #endif
139 
140 #define null (0)
141 
142 /* Must cast to void *, then size_t, then int. */
143 #define ptrlowbits(x)  ((int)(size_t)(void*)(x))
144 
145 /* Back and forth from jlong to pointer */
146 #define ptr2jlong(x)  ((jlong)(size_t)(void*)(x))
147 #define jlong2ptr(x)  ((void*)(size_t)(x))
148 
149 // Keys used by Java:
150 #define UNPACK_DEFLATE_HINT             &quot;unpack.deflate.hint&quot;
151 
152 #define COM_PREFIX                      &quot;com.sun.java.util.jar.pack.&quot;
153 #define UNPACK_MODIFICATION_TIME        COM_PREFIX&quot;unpack.modification.time&quot;
154 #define DEBUG_VERBOSE                   COM_PREFIX&quot;verbose&quot;
155 
156 #define ZIP_ARCHIVE_MARKER_COMMENT      &quot;PACK200&quot;
157 
158 // The following are not known to the Java classes:
159 #define UNPACK_LOG_FILE                 COM_PREFIX&quot;unpack.log.file&quot;
160 #define UNPACK_REMOVE_PACKFILE          COM_PREFIX&quot;unpack.remove.packfile&quot;
161 
162 
163 // Called from unpacker layers
164 #define _CHECK_DO(t,x)          { if (t) {x;} }
165 
166 #define CHECK                   _CHECK_DO(aborting(), return)
167 #define CHECK_(y)               _CHECK_DO(aborting(), return y)
168 #define CHECK_0                 _CHECK_DO(aborting(), return 0)
169 
170 #define CHECK_COUNT(t)          if (t &lt; 0){abort(&quot;bad value count&quot;);} CHECK
171 
172 #define STR_TRUE   &quot;true&quot;
173 #define STR_FALSE  &quot;false&quot;
174 
175 #define STR_TF(x)  ((x) ?  STR_TRUE : STR_FALSE)
176 #define BOOL_TF(x) (((x) != null &amp;&amp; strcmp((x),STR_TRUE) == 0) ? true : false)
177 
178 #define DEFAULT_ARCHIVE_MODTIME 1060000000 // Aug 04, 2003 5:26 PM PDT
    </pre>
  </body>
</html>