<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.compiler/share/classes/javax/tools/StandardJavaFileManager.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="JavaCompiler.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="ToolProvider.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.compiler/share/classes/javax/tools/StandardJavaFileManager.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package javax.tools;
 27 
 28 import java.io.File;
 29 import java.io.IOException;
 30 import java.nio.file.Path;

 31 import java.util.Arrays;
 32 import java.util.Collection;
 33 import java.util.Iterator;

 34 
 35 /**
 36  * File manager based on {@linkplain File java.io.File} and {@linkplain Path java.nio.file.Path}.
 37  *
 38  * A common way to obtain an instance of this class is using
 39  * {@linkplain JavaCompiler#getStandardFileManager getStandardFileManager}, for example:
 40  *
 41  * &lt;pre&gt;
 42  *   JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();
 43  *   {@code DiagnosticCollector&lt;JavaFileObject&gt;} diagnostics =
 44  *       new {@code DiagnosticCollector&lt;JavaFileObject&gt;()};
 45  *   StandardJavaFileManager fm = compiler.getStandardFileManager(diagnostics, null, null);
 46  * &lt;/pre&gt;
 47  *
 48  * This file manager creates file objects representing regular
 49  * {@linkplain File files},
 50  * {@linkplain java.util.zip.ZipEntry zip file entries}, or entries in
 51  * similar file system based containers.  Any file object returned
 52  * from a file manager implementing this interface must observe the
 53  * following behavior:
</pre>
<hr />
<pre>
167      * @return true if the given file objects represent the same
168      * canonical file, zip file entry or path; false otherwise
169      *
170      * @throws IllegalArgumentException if either of the arguments
171      * were created with another file manager implementation
172      */
173     @Override
174     boolean isSameFile(FileObject a, FileObject b);
175 
176     /**
177      * Returns file objects representing the given files.
178      *
179      * @param files a list of files
180      * @return a list of file objects
181      * @throws IllegalArgumentException if the list of files includes
182      * a directory
183      */
184     Iterable&lt;? extends JavaFileObject&gt; getJavaFileObjectsFromFiles(
185         Iterable&lt;? extends File&gt; files);
186 






















187     /**
188      * Returns file objects representing the given paths.
189      *
190      * @implSpec
191      * The default implementation converts each path to a file and calls
192      * {@link #getJavaFileObjectsFromFiles getJavaObjectsFromFiles}.
193      * IllegalArgumentException will be thrown if any of the paths
194      * cannot be converted to a file.
195      *
196      * @param paths a list of paths
197      * @return a list of file objects
198      * @throws IllegalArgumentException if the list of paths includes
199      * a directory or if this file manager does not support any of the
200      * given paths.
201      *
202      * @since 9






203      */

204     default Iterable&lt;? extends JavaFileObject&gt; getJavaFileObjectsFromPaths(
205             Iterable&lt;? extends Path&gt; paths) {
<span class="line-modified">206         return getJavaFileObjectsFromFiles(asFiles(paths));</span>
207     }
208 
209     /**
210      * Returns file objects representing the given files.
211      * Convenience method equivalent to:
212      *
213      * &lt;pre&gt;
214      *     getJavaFileObjectsFromFiles({@linkplain java.util.Arrays#asList Arrays.asList}(files))
215      * &lt;/pre&gt;
216      *
217      * @param files an array of files
218      * @return a list of file objects
219      * @throws IllegalArgumentException if the array of files includes
220      * a directory
221      * @throws NullPointerException if the given array contains null
222      * elements
223      */
224     Iterable&lt;? extends JavaFileObject&gt; getJavaFileObjects(File... files);
225 
226     /**
</pre>
<hr />
<pre>
467     private static Iterable&lt;File&gt; asFiles(final Iterable&lt;? extends Path&gt; paths) {
468         return () -&gt; new Iterator&lt;File&gt;() {
469             Iterator&lt;? extends Path&gt; iter = paths.iterator();
470 
471             @Override
472             public boolean hasNext() {
473                 return iter.hasNext();
474             }
475 
476             @Override
477             public File next() {
478                 Path p = iter.next();
479                 try {
480                     return p.toFile();
481                 } catch (UnsupportedOperationException e) {
482                     throw new IllegalArgumentException(p.toString(), e);
483                 }
484             }
485         };
486     }









487 }
</pre>
</td>
<td>
<hr />
<pre>
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package javax.tools;
 27 
 28 import java.io.File;
 29 import java.io.IOException;
 30 import java.nio.file.Path;
<span class="line-added"> 31 import java.util.ArrayList;</span>
 32 import java.util.Arrays;
 33 import java.util.Collection;
 34 import java.util.Iterator;
<span class="line-added"> 35 import java.util.List;</span>
 36 
 37 /**
 38  * File manager based on {@linkplain File java.io.File} and {@linkplain Path java.nio.file.Path}.
 39  *
 40  * A common way to obtain an instance of this class is using
 41  * {@linkplain JavaCompiler#getStandardFileManager getStandardFileManager}, for example:
 42  *
 43  * &lt;pre&gt;
 44  *   JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();
 45  *   {@code DiagnosticCollector&lt;JavaFileObject&gt;} diagnostics =
 46  *       new {@code DiagnosticCollector&lt;JavaFileObject&gt;()};
 47  *   StandardJavaFileManager fm = compiler.getStandardFileManager(diagnostics, null, null);
 48  * &lt;/pre&gt;
 49  *
 50  * This file manager creates file objects representing regular
 51  * {@linkplain File files},
 52  * {@linkplain java.util.zip.ZipEntry zip file entries}, or entries in
 53  * similar file system based containers.  Any file object returned
 54  * from a file manager implementing this interface must observe the
 55  * following behavior:
</pre>
<hr />
<pre>
169      * @return true if the given file objects represent the same
170      * canonical file, zip file entry or path; false otherwise
171      *
172      * @throws IllegalArgumentException if either of the arguments
173      * were created with another file manager implementation
174      */
175     @Override
176     boolean isSameFile(FileObject a, FileObject b);
177 
178     /**
179      * Returns file objects representing the given files.
180      *
181      * @param files a list of files
182      * @return a list of file objects
183      * @throws IllegalArgumentException if the list of files includes
184      * a directory
185      */
186     Iterable&lt;? extends JavaFileObject&gt; getJavaFileObjectsFromFiles(
187         Iterable&lt;? extends File&gt; files);
188 
<span class="line-added">189     /**</span>
<span class="line-added">190      * Returns file objects representing the given paths.</span>
<span class="line-added">191      *</span>
<span class="line-added">192      * @implSpec</span>
<span class="line-added">193      * The default implementation converts each path to a file and calls</span>
<span class="line-added">194      * {@link #getJavaFileObjectsFromFiles getJavaObjectsFromFiles}.</span>
<span class="line-added">195      * IllegalArgumentException will be thrown if any of the paths</span>
<span class="line-added">196      * cannot be converted to a file.</span>
<span class="line-added">197      *</span>
<span class="line-added">198      * @param paths a list of paths</span>
<span class="line-added">199      * @return a list of file objects</span>
<span class="line-added">200      * @throws IllegalArgumentException if the list of paths includes</span>
<span class="line-added">201      * a directory or if this file manager does not support any of the</span>
<span class="line-added">202      * given paths.</span>
<span class="line-added">203      *</span>
<span class="line-added">204      * @since 13</span>
<span class="line-added">205      */</span>
<span class="line-added">206     default Iterable&lt;? extends JavaFileObject&gt; getJavaFileObjectsFromPaths(</span>
<span class="line-added">207             Collection&lt;? extends Path&gt; paths) {</span>
<span class="line-added">208         return getJavaFileObjectsFromFiles(asFiles(paths));</span>
<span class="line-added">209     }</span>
<span class="line-added">210 </span>
211     /**
212      * Returns file objects representing the given paths.
213      *
214      * @implSpec
215      * The default implementation converts each path to a file and calls
216      * {@link #getJavaFileObjectsFromFiles getJavaObjectsFromFiles}.
217      * IllegalArgumentException will be thrown if any of the paths
218      * cannot be converted to a file.
219      *
220      * @param paths a list of paths
221      * @return a list of file objects
222      * @throws IllegalArgumentException if the list of paths includes
223      * a directory or if this file manager does not support any of the
224      * given paths.
225      *
226      * @since 9
<span class="line-added">227      * @deprecated use {@link #getJavaFileObjectsFromPaths(Collection)} instead,</span>
<span class="line-added">228      * to prevent the possibility of accidentally calling the method with a</span>
<span class="line-added">229      * single {@code Path} as such an argument. Although {@code Path} implements</span>
<span class="line-added">230      * {@code Iterable&lt;Path&gt;}, it would almost never be correct to pass a single</span>
<span class="line-added">231      * {@code Path} and have it be treated as an {@code Iterable} of its</span>
<span class="line-added">232      * components.</span>
233      */
<span class="line-added">234     @Deprecated(since = &quot;13&quot;)</span>
235     default Iterable&lt;? extends JavaFileObject&gt; getJavaFileObjectsFromPaths(
236             Iterable&lt;? extends Path&gt; paths) {
<span class="line-modified">237         return getJavaFileObjectsFromPaths(asCollection(paths));</span>
238     }
239 
240     /**
241      * Returns file objects representing the given files.
242      * Convenience method equivalent to:
243      *
244      * &lt;pre&gt;
245      *     getJavaFileObjectsFromFiles({@linkplain java.util.Arrays#asList Arrays.asList}(files))
246      * &lt;/pre&gt;
247      *
248      * @param files an array of files
249      * @return a list of file objects
250      * @throws IllegalArgumentException if the array of files includes
251      * a directory
252      * @throws NullPointerException if the given array contains null
253      * elements
254      */
255     Iterable&lt;? extends JavaFileObject&gt; getJavaFileObjects(File... files);
256 
257     /**
</pre>
<hr />
<pre>
498     private static Iterable&lt;File&gt; asFiles(final Iterable&lt;? extends Path&gt; paths) {
499         return () -&gt; new Iterator&lt;File&gt;() {
500             Iterator&lt;? extends Path&gt; iter = paths.iterator();
501 
502             @Override
503             public boolean hasNext() {
504                 return iter.hasNext();
505             }
506 
507             @Override
508             public File next() {
509                 Path p = iter.next();
510                 try {
511                     return p.toFile();
512                 } catch (UnsupportedOperationException e) {
513                     throw new IllegalArgumentException(p.toString(), e);
514                 }
515             }
516         };
517     }
<span class="line-added">518 </span>
<span class="line-added">519     private static &lt;T&gt; Collection&lt;T&gt; asCollection(Iterable&lt;T&gt; iterable) {</span>
<span class="line-added">520         if (iterable instanceof Collection) {</span>
<span class="line-added">521             return (Collection&lt;T&gt;) iterable;</span>
<span class="line-added">522         }</span>
<span class="line-added">523         List&lt;T&gt; result = new ArrayList&lt;&gt;();</span>
<span class="line-added">524         for (T item : iterable) result.add(item);</span>
<span class="line-added">525         return result;</span>
<span class="line-added">526     }</span>
527 }
</pre>
</td>
</tr>
</table>
<center><a href="JavaCompiler.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="ToolProvider.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>