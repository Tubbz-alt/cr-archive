<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/AbstractModuleIndexWriter.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2013, 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package jdk.javadoc.internal.doclets.formats.html;
 27 
 28 import java.util.Collection;
 29 import java.util.Map;
 30 import java.util.Set;
 31 import java.util.SortedMap;
 32 
 33 import javax.lang.model.element.ModuleElement;
 34 import javax.lang.model.element.PackageElement;
 35 
 36 import jdk.javadoc.internal.doclets.formats.html.markup.HtmlStyle;
 37 import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTag;
 38 import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTree;
 39 import jdk.javadoc.internal.doclets.formats.html.markup.Navigation;
 40 import jdk.javadoc.internal.doclets.formats.html.markup.Navigation.PageMode;
 41 import jdk.javadoc.internal.doclets.formats.html.markup.RawHtml;
 42 import jdk.javadoc.internal.doclets.toolkit.Content;
 43 import jdk.javadoc.internal.doclets.toolkit.util.DocFileIOException;
 44 import jdk.javadoc.internal.doclets.toolkit.util.DocPath;
 45 
 46 /**
 47  * Abstract class to generate the module overview files in
 48  * Frame and Non-Frame format. This will be sub-classed to
 49  * generate module-overview-frame.html as well as module-overview-summary.html.
 50  *
 51  *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
 52  *  If you write code that depends on this, you do so at your own risk.
 53  *  This code and its internal interfaces are subject to change or
 54  *  deletion without notice.&lt;/b&gt;
 55  *
 56  * @author Bhavesh Patel
 57  */
 58 public abstract class AbstractModuleIndexWriter extends HtmlDocletWriter {
 59 
 60     /**
 61      * Modules to be documented.
 62      */
 63     protected SortedMap&lt;ModuleElement, Set&lt;PackageElement&gt;&gt; modules;
 64 
 65     protected Navigation navBar;
 66 
 67     /**
 68      * Constructor. Also initializes the modules variable.
 69      *
 70      * @param configuration  The current configuration
 71      * @param filename Name of the module index file to be generated.
 72      */
 73     public AbstractModuleIndexWriter(HtmlConfiguration configuration,
 74                                       DocPath filename) {
 75         super(configuration, filename);
 76         modules = configuration.modulePackages;
 77         this.navBar = new Navigation(null, configuration, fixedNavDiv, PageMode.OVERVIEW, path);
 78     }
 79 
 80     /**
 81      * Adds the navigation bar header to the documentation tree.
 82      *
 83      * @param header the document tree to which the navigation bar header will be added
 84      */
 85     protected abstract void addNavigationBarHeader(Content header);
 86 
 87     /**
 88      * Adds the navigation bar footer to the documentation tree.
 89      *
 90      * @param footer the document tree to which the navigation bar footer will be added
 91      */
 92     protected abstract void addNavigationBarFooter(Content footer);
 93 
 94     /**
 95      * Adds the overview header to the documentation tree.
 96      *
 97      * @param main the document tree to which the overview header will be added
 98      */
 99     protected abstract void addOverviewHeader(Content main);
100 
101     /**
102      * Adds the modules list to the documentation tree.
103      *
104      * @param main the document tree to which the modules list will be added
105      */
106     protected abstract void addModulesList(Content main);
107 
108     /**
109      * Adds the module packages list to the documentation tree.
110      *
111      * @param modules the set of modules
112      * @param text caption for the table
113      * @param tableSummary summary for the table
114      * @param main the document tree to which the modules list will be added
115      * @param mdle the module being documented
116      */
117     protected abstract void addModulePackagesList(Map&lt;ModuleElement, Set&lt;PackageElement&gt;&gt; modules, String text,
118             String tableSummary, Content main, ModuleElement mdle);
119 
120     /**
121      * Generate and prints the contents in the module index file. Call appropriate
122      * methods from the sub-class in order to generate Frame or Non
123      * Frame format.
124      *
125      * @param title the title of the window
126      * @param description the content for the description META tag
127      * @param includeScript boolean set true if windowtitle script is to be included
128      * @throws DocFileIOException if there is a problem building the module index file
129      */
130     protected void buildModuleIndexFile(String title, String description, boolean includeScript)
131             throws DocFileIOException {
132         String windowOverview = resources.getText(title);
133         Content body = getBody(includeScript, getWindowTitle(windowOverview));
134         Content header = HtmlTree.HEADER();
135         addNavigationBarHeader(header);
136         Content main = HtmlTree.MAIN();
137         addOverviewHeader(main);
138         addIndex(header, main);
139         addOverview(main);
140         Content footer = HtmlTree.FOOTER();
141         addNavigationBarFooter(footer);
142         body.add(header);
143         body.add(main);
144         body.add(footer);
145         printHtmlDocument(
146                 configuration.metakeywords.getOverviewMetaKeywords(title, configuration.doctitle),
147                 description,
148                 body);
149     }
150 
151     /**
152      * Generate and prints the contents in the module packages index file. Call appropriate
153      * methods from the sub-class in order to generate Frame or Non
154      * Frame format.
155      *
156      * @param title the title of the window.
157      * @param description the content for the description META tag
158      * @param includeScript boolean set true if windowtitle script is to be included
159      * @param mdle the name of the module being documented
160      * @throws DocFileIOException if there is an exception building the module packages index file
161      */
162     protected void buildModulePackagesIndexFile(String title, String description,
163             boolean includeScript, ModuleElement mdle) throws DocFileIOException {
164         String windowOverview = resources.getText(title);
165         Content body = getBody(includeScript, getWindowTitle(windowOverview));
166         Content header = HtmlTree.HEADER();
167         addNavigationBarHeader(header);
168         Content main = HtmlTree.MAIN();
169         addOverviewHeader(main);
170         addModulePackagesIndex(header, main, mdle);
171         addOverview(main);
172         Content footer = HtmlTree.FOOTER();
173         addNavigationBarFooter(footer);
174         body.add(header);
175         body.add(main);
176         body.add(footer);
177         printHtmlDocument(
178                 configuration.metakeywords.getOverviewMetaKeywords(title, configuration.doctitle),
179                 description,
180                 body);
181     }
182 
183     /**
184      * Default to no overview, override to add overview.
185      *
186      * @param main the document tree to which the overview will be added
187      */
188     protected void addOverview(Content main) { }
189 
190     /**
191      * Adds the frame or non-frame module index to the documentation tree.
192      *
193      * @param header the document tree to which the navigational links will be added
194      * @param main the document tree to which the modules list will be added
195      */
196     protected void addIndex(Content header, Content main) {
197         addIndexContents(configuration.modules, &quot;doclet.Module_Summary&quot;,
198                 resources.getText(&quot;doclet.Member_Table_Summary&quot;,
199                 resources.getText(&quot;doclet.Module_Summary&quot;),
200                 resources.getText(&quot;doclet.modules&quot;)), header, main);
201     }
202 
203     /**
204      * Adds the frame or non-frame module packages index to the documentation tree.
205      *
206      * @param header the document tree to which the navigational links will be added
207      * @param main the document tree to which the module packages list will be added
208      * @param mdle the module being documented
209      */
210     protected void addModulePackagesIndex(Content header, Content main, ModuleElement mdle) {
211         addModulePackagesIndexContents(&quot;doclet.Module_Summary&quot;,
212                 resources.getText(&quot;doclet.Member_Table_Summary&quot;,
213                 resources.getText(&quot;doclet.Module_Summary&quot;),
214                 resources.getText(&quot;doclet.modules&quot;)), header, main, mdle);
215     }
216 
217     /**
218      * Adds module index contents. Call appropriate methods from
219      * the sub-classes. Adds it to the body HtmlTree
220      *
221      * @param modules the modules to be documented
222      * @param text string which will be used as the heading
223      * @param tableSummary summary for the table
224      * @param header the document tree to which the navigational links will be added
225      * @param main the document tree to which the modules list will be added
226      */
227     protected void addIndexContents(Collection&lt;ModuleElement&gt; modules, String text,
228             String tableSummary, Content header, Content main) {
229         HtmlTree htmlTree = HtmlTree.NAV();
230         htmlTree.setStyle(HtmlStyle.indexNav);
231         HtmlTree ul = new HtmlTree(HtmlTag.UL);
232         addAllClassesLink(ul);
233         addAllPackagesLink(ul);
234         htmlTree.add(ul);
235         header.add(htmlTree);
236         addModulesList(main);
237     }
238 
239     /**
240      * Adds module packages index contents. Call appropriate methods from
241      * the sub-classes. Adds it to the body HtmlTree
242      *
243      * @param text string which will be used as the heading
244      * @param tableSummary summary for the table
245      * @param header the document tree to which the navigational links will be added
246      * @param main the document tree to which the module packages list will be added
247      * @param mdle the module being documented
248      */
249     protected void addModulePackagesIndexContents(String text,
250             String tableSummary, Content header, Content main, ModuleElement mdle) {
251         HtmlTree htmlTree = HtmlTree.NAV();
252         htmlTree.setStyle(HtmlStyle.indexNav);
253         HtmlTree ul = new HtmlTree(HtmlTag.UL);
254         addAllClassesLink(ul);
255         addAllPackagesLink(ul);
256         addAllModulesLink(ul);
257         htmlTree.add(ul);
258         header.add(htmlTree);
259         addModulePackagesList(modules, text, tableSummary, main, mdle);
260     }
261 
262     /**
263      * Adds the doctitle to the documentation tree, if it is specified on the command line.
264      *
265      * @param body the document tree to which the title will be added
266      */
267     protected void addConfigurationTitle(Content body) {
268         if (configuration.doctitle.length() &gt; 0) {
269             Content title = new RawHtml(configuration.doctitle);
270             Content heading = HtmlTree.HEADING(Headings.PAGE_TITLE_HEADING,
271                     HtmlStyle.title, title);
272             Content div = HtmlTree.DIV(HtmlStyle.header, heading);
273             body.add(div);
274         }
275     }
276 
277     /**
278      * Do nothing. This will be overridden in ModuleIndexFrameWriter.
279      *
280      * @param div the document tree to which the all classes link will be added
281      */
282     protected void addAllClassesLink(Content div) { }
283 
284     /**
285      * Do nothing. This will be overridden in ModuleIndexFrameWriter.
286      *
287      * @param div the document tree to which the all packages link will be added
288      */
289     protected void addAllPackagesLink(Content div) { }
290 
291     /**
292      * Do nothing. This will be overridden in ModulePackageIndexFrameWriter.
293      *
294      * @param div the document tree to which the all modules link will be added
295      */
296     protected void addAllModulesLink(Content div) { }
297 }
    </pre>
  </body>
</html>