<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/PackageUseWriter.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="PackageTreeWriter.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="PackageWriterImpl.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/PackageUseWriter.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 23,25 ***</span>
   * questions.
   */
  
  package jdk.javadoc.internal.doclets.formats.html;
  
<span class="line-modified">! import jdk.javadoc.internal.doclets.formats.html.markup.Table;</span>
<span class="line-modified">! import jdk.javadoc.internal.doclets.formats.html.markup.TableHeader;</span>
<span class="line-modified">! </span>
<span class="line-modified">! import java.util.*;</span>
  
  import javax.lang.model.element.PackageElement;
  import javax.lang.model.element.TypeElement;
  
  import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlStyle;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTag;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTree;
  import jdk.javadoc.internal.doclets.formats.html.markup.Navigation;
  import jdk.javadoc.internal.doclets.formats.html.markup.Navigation.PageMode;
  import jdk.javadoc.internal.doclets.formats.html.markup.StringContent;
  import jdk.javadoc.internal.doclets.toolkit.Content;
  import jdk.javadoc.internal.doclets.toolkit.util.ClassUseMapper;
  import jdk.javadoc.internal.doclets.toolkit.util.DocFileIOException;
  import jdk.javadoc.internal.doclets.toolkit.util.DocPath;
  import jdk.javadoc.internal.doclets.toolkit.util.DocPaths;
<span class="line-new-header">--- 23,28 ---</span>
   * questions.
   */
  
  package jdk.javadoc.internal.doclets.formats.html;
  
<span class="line-modified">! import java.util.Set;</span>
<span class="line-modified">! import java.util.SortedMap;</span>
<span class="line-modified">! import java.util.TreeMap;</span>
<span class="line-modified">! import java.util.TreeSet;</span>
  
  import javax.lang.model.element.PackageElement;
  import javax.lang.model.element.TypeElement;
  
  import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;
<span class="line-added">+ import jdk.javadoc.internal.doclets.formats.html.markup.Entity;</span>
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlStyle;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTag;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTree;
  import jdk.javadoc.internal.doclets.formats.html.markup.Navigation;
  import jdk.javadoc.internal.doclets.formats.html.markup.Navigation.PageMode;
  import jdk.javadoc.internal.doclets.formats.html.markup.StringContent;
<span class="line-added">+ import jdk.javadoc.internal.doclets.formats.html.markup.Table;</span>
<span class="line-added">+ import jdk.javadoc.internal.doclets.formats.html.markup.TableHeader;</span>
  import jdk.javadoc.internal.doclets.toolkit.Content;
  import jdk.javadoc.internal.doclets.toolkit.util.ClassUseMapper;
  import jdk.javadoc.internal.doclets.toolkit.util.DocFileIOException;
  import jdk.javadoc.internal.doclets.toolkit.util.DocPath;
  import jdk.javadoc.internal.doclets.toolkit.util.DocPaths;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 51,19 ***</span>
   *
   *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
   *  If you write code that depends on this, you do so at your own risk.
   *  This code and its internal interfaces are subject to change or
   *  deletion without notice.&lt;/b&gt;
<span class="line-removed">-  *</span>
<span class="line-removed">-  * @author Robert G. Field</span>
<span class="line-removed">-  * @author Bhavesh Patel (Modified)</span>
   */
  public class PackageUseWriter extends SubWriterHolderWriter {
  
      final PackageElement packageElement;
      final SortedMap&lt;String, Set&lt;TypeElement&gt;&gt; usingPackageToUsedClasses = new TreeMap&lt;&gt;();
<span class="line-removed">-     protected HtmlTree mainTree = HtmlTree.MAIN();</span>
      final String packageUseTableSummary;
      private final Navigation navBar;
  
      /**
       * Constructor.
<span class="line-new-header">--- 54,15 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 99,11 ***</span>
              }
          }
  
          packageUseTableSummary = resources.getText(&quot;doclet.Use_Table_Summary&quot;,
                  resources.getText(&quot;doclet.packages&quot;));
<span class="line-modified">!         this.navBar = new Navigation(packageElement, configuration, fixedNavDiv, PageMode.USE, path);</span>
      }
  
      /**
       * Generate a class page.
       *
<span class="line-new-header">--- 98,11 ---</span>
              }
          }
  
          packageUseTableSummary = resources.getText(&quot;doclet.Use_Table_Summary&quot;,
                  resources.getText(&quot;doclet.packages&quot;));
<span class="line-modified">!         this.navBar = new Navigation(packageElement, configuration, PageMode.USE, path);</span>
      }
  
      /**
       * Generate a class page.
       *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 131,17 ***</span>
          if (usingPackageToUsedClasses.isEmpty()) {
              div.add(contents.getContent(&quot;doclet.ClassUse_No.usage.of.0&quot;, utils.getPackageName(packageElement)));
          } else {
              addPackageUse(div);
          }
<span class="line-modified">!         mainTree.add(div);</span>
<span class="line-removed">-         body.add(mainTree);</span>
          HtmlTree footer = HtmlTree.FOOTER();
          navBar.setUserFooter(getUserHeaderFooter(false));
          footer.add(navBar.getContent(false));
          addBottom(footer);
<span class="line-modified">!         body.add(footer);</span>
          printHtmlDocument(null,
                  getDescription(&quot;use&quot;, packageElement),
                  body);
      }
  
<span class="line-new-header">--- 130,17 ---</span>
          if (usingPackageToUsedClasses.isEmpty()) {
              div.add(contents.getContent(&quot;doclet.ClassUse_No.usage.of.0&quot;, utils.getPackageName(packageElement)));
          } else {
              addPackageUse(div);
          }
<span class="line-modified">!         bodyContents.addMainContent(div);</span>
          HtmlTree footer = HtmlTree.FOOTER();
          navBar.setUserFooter(getUserHeaderFooter(false));
          footer.add(navBar.getContent(false));
          addBottom(footer);
<span class="line-modified">!         bodyContents.setFooter(footer);</span>
<span class="line-added">+         body.add(bodyContents.toContent());</span>
          printHtmlDocument(null,
                  getDescription(&quot;use&quot;, packageElement),
                  body);
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 149,17 ***</span>
       * Add the package use information.
       *
       * @param contentTree the content tree to which the package use information will be added
       */
      protected void addPackageUse(Content contentTree) {
<span class="line-modified">!         HtmlTree ul = new HtmlTree(HtmlTag.UL);</span>
<span class="line-removed">-         ul.setStyle(HtmlStyle.blockList);</span>
          if (configuration.packages.size() &gt; 1) {
<span class="line-modified">!             addPackageList(ul);</span>
          }
<span class="line-modified">!         addClassList(ul);</span>
<span class="line-modified">!         contentTree.add(ul);</span>
      }
  
      /**
       * Add the list of packages that use the given package.
       *
<span class="line-new-header">--- 148,16 ---</span>
       * Add the package use information.
       *
       * @param contentTree the content tree to which the package use information will be added
       */
      protected void addPackageUse(Content contentTree) {
<span class="line-modified">!         Content content = new ContentBuilder();</span>
          if (configuration.packages.size() &gt; 1) {
<span class="line-modified">!             addPackageList(content);</span>
          }
<span class="line-modified">!         addClassList(content);</span>
<span class="line-modified">!         contentTree.add(content);</span>
      }
  
      /**
       * Add the list of packages that use the given package.
       *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 179,31 ***</span>
                      new StringContent(utils.getPackageName(pkg)));
              Content summary = new ContentBuilder();
              if (pkg != null &amp;&amp; !pkg.isUnnamed()) {
                  addSummaryComment(pkg, summary);
              } else {
<span class="line-modified">!                 summary.add(Contents.SPACE);</span>
              }
              table.addRow(packageLink, summary);
          }
<span class="line-modified">!         Content li = HtmlTree.LI(HtmlStyle.blockList, table.toContent());</span>
<span class="line-removed">-         contentTree.add(li);</span>
      }
  
      /**
       * Add the list of classes that use the given package.
       *
       * @param contentTree the content tree to which the class list will be added
       */
      protected void addClassList(Content contentTree) {
          TableHeader classTableHeader = new TableHeader(
                  contents.classLabel, contents.descriptionLabel);
          for (String packageName : usingPackageToUsedClasses.keySet()) {
              PackageElement usingPackage = utils.elementUtils.getPackageElement(packageName);
<span class="line-modified">!             HtmlTree li = new HtmlTree(HtmlTag.LI);</span>
<span class="line-modified">!             li.setStyle(HtmlStyle.blockList);</span>
<span class="line-removed">-             li.add(links.createAnchor(getPackageAnchorName(usingPackage)));</span>
              String tableSummary = resources.getText(&quot;doclet.Use_Table_Summary&quot;,
                                                          resources.getText(&quot;doclet.classes&quot;));
              Content caption = contents.getContent(
                      &quot;doclet.ClassUse_Classes.in.0.used.by.1&quot;,
                      getPackageLink(packageElement, utils.getPackageName(packageElement)),
<span class="line-new-header">--- 177,31 ---</span>
                      new StringContent(utils.getPackageName(pkg)));
              Content summary = new ContentBuilder();
              if (pkg != null &amp;&amp; !pkg.isUnnamed()) {
                  addSummaryComment(pkg, summary);
              } else {
<span class="line-modified">!                 summary.add(Entity.NO_BREAK_SPACE);</span>
              }
              table.addRow(packageLink, summary);
          }
<span class="line-modified">!         contentTree.add(table.toContent());</span>
      }
  
      /**
       * Add the list of classes that use the given package.
       *
       * @param contentTree the content tree to which the class list will be added
       */
      protected void addClassList(Content contentTree) {
          TableHeader classTableHeader = new TableHeader(
                  contents.classLabel, contents.descriptionLabel);
<span class="line-added">+         HtmlTree ul = new HtmlTree(HtmlTag.UL);</span>
<span class="line-added">+         ul.setStyle(HtmlStyle.blockList);</span>
          for (String packageName : usingPackageToUsedClasses.keySet()) {
              PackageElement usingPackage = utils.elementUtils.getPackageElement(packageName);
<span class="line-modified">!             HtmlTree section = HtmlTree.SECTION(HtmlStyle.detail)</span>
<span class="line-modified">!                     .setId(getPackageAnchorName(usingPackage));</span>
              String tableSummary = resources.getText(&quot;doclet.Use_Table_Summary&quot;,
                                                          resources.getText(&quot;doclet.classes&quot;));
              Content caption = contents.getContent(
                      &quot;doclet.ClassUse_Classes.in.0.used.by.1&quot;,
                      getPackageLink(packageElement, utils.getPackageName(packageElement)),
</pre>
<hr />
<pre>
<span class="line-old-header">*** 221,13 ***</span>
                  Content summary = new ContentBuilder();
                  addIndexComment(te, summary);
  
                  table.addRow(typeContent, summary);
              }
<span class="line-modified">!             li.add(table.toContent());</span>
<span class="line-modified">!             contentTree.add(li);</span>
          }
      }
  
      /**
       * Get the header for the package use listing.
       *
<span class="line-new-header">--- 219,15 ---</span>
                  Content summary = new ContentBuilder();
                  addIndexComment(te, summary);
  
                  table.addRow(typeContent, summary);
              }
<span class="line-modified">!             section.add(table.toContent());</span>
<span class="line-modified">!             ul.add(HtmlTree.LI(HtmlStyle.blockList, section));</span>
          }
<span class="line-added">+         Content li = HtmlTree.SECTION(HtmlStyle.packageUses, ul);</span>
<span class="line-added">+         contentTree.add(li);</span>
      }
  
      /**
       * Get the header for the package use listing.
       *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 235,25 ***</span>
       */
      private HtmlTree getPackageUseHeader() {
          String packageText = resources.getText(&quot;doclet.Package&quot;);
          String name = packageElement.isUnnamed() ? &quot;&quot; : utils.getPackageName(packageElement);
          String title = resources.getText(&quot;doclet.Window_ClassUse_Header&quot;, packageText, name);
<span class="line-modified">!         HtmlTree bodyTree = getBody(true, getWindowTitle(title));</span>
<span class="line-modified">!         HtmlTree htmlTree = HtmlTree.HEADER();</span>
<span class="line-modified">!         addTop(htmlTree);</span>
          Content linkContent = getModuleLink(utils.elementUtils.getModuleOf(packageElement),
                  contents.moduleLabel);
          navBar.setNavLinkModule(linkContent);
          navBar.setUserHeader(getUserHeaderFooter(true));
<span class="line-modified">!         htmlTree.add(navBar.getContent(true));</span>
<span class="line-modified">!         bodyTree.add(htmlTree);</span>
<span class="line-modified">!         ContentBuilder headContent = new ContentBuilder();</span>
<span class="line-modified">!         headContent.add(contents.getContent(&quot;doclet.ClassUse_Title&quot;, packageText));</span>
<span class="line-modified">!         headContent.add(new HtmlTree(HtmlTag.BR));</span>
<span class="line-removed">-         headContent.add(name);</span>
          Content heading = HtmlTree.HEADING(Headings.PAGE_TITLE_HEADING, true,
<span class="line-modified">!                 HtmlStyle.title, headContent);</span>
          Content div = HtmlTree.DIV(HtmlStyle.header, heading);
<span class="line-modified">!         mainTree.add(div);</span>
          return bodyTree;
      }
  }
<span class="line-new-header">--- 235,25 ---</span>
       */
      private HtmlTree getPackageUseHeader() {
          String packageText = resources.getText(&quot;doclet.Package&quot;);
          String name = packageElement.isUnnamed() ? &quot;&quot; : utils.getPackageName(packageElement);
          String title = resources.getText(&quot;doclet.Window_ClassUse_Header&quot;, packageText, name);
<span class="line-modified">!         HtmlTree bodyTree = getBody(getWindowTitle(title));</span>
<span class="line-modified">!         Content headerContent = new ContentBuilder();</span>
<span class="line-modified">!         addTop(headerContent);</span>
          Content linkContent = getModuleLink(utils.elementUtils.getModuleOf(packageElement),
                  contents.moduleLabel);
          navBar.setNavLinkModule(linkContent);
          navBar.setUserHeader(getUserHeaderFooter(true));
<span class="line-modified">!         headerContent.add(navBar.getContent(true));</span>
<span class="line-modified">!         ContentBuilder headingContent = new ContentBuilder();</span>
<span class="line-modified">!         headingContent.add(contents.getContent(&quot;doclet.ClassUse_Title&quot;, packageText));</span>
<span class="line-modified">!         headingContent.add(new HtmlTree(HtmlTag.BR));</span>
<span class="line-modified">!         headingContent.add(name);</span>
          Content heading = HtmlTree.HEADING(Headings.PAGE_TITLE_HEADING, true,
<span class="line-modified">!                 HtmlStyle.title, headingContent);</span>
          Content div = HtmlTree.DIV(HtmlStyle.header, heading);
<span class="line-modified">!         bodyContents.setHeader(headerContent)</span>
<span class="line-added">+                 .addMainContent(div);</span>
          return bodyTree;
      }
  }
</pre>
<center><a href="PackageTreeWriter.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="PackageWriterImpl.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>