<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/markup/Head.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="FixedStringContent.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="HtmlAttr.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/markup/Head.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 26,19 ***</span>
  package jdk.javadoc.internal.doclets.formats.html.markup;
  
  import java.text.SimpleDateFormat;
  import java.util.ArrayList;
  import java.util.Arrays;
<span class="line-removed">- import java.util.Calendar;</span>
  import java.util.Collections;
  import java.util.Date;
<span class="line-removed">- import java.util.GregorianCalendar;</span>
  import java.util.List;
<span class="line-removed">- import java.util.TimeZone;</span>
  
  import jdk.javadoc.internal.doclets.toolkit.Content;
<span class="line-removed">- import jdk.javadoc.internal.doclets.toolkit.util.DocFile;</span>
  import jdk.javadoc.internal.doclets.toolkit.util.DocPath;
  import jdk.javadoc.internal.doclets.toolkit.util.DocPaths;
  
  /**
   * A builder for HTML HEAD elements.
<span class="line-new-header">--- 26,15 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 50,40 ***</span>
   *  This code and its internal interfaces are subject to change or
   *  deletion without notice.&lt;/b&gt;
   */
  public class Head {
      private final String docletVersion;
      private final DocPath pathToRoot;
      private String title;
      private String charset;
      private final List&lt;String&gt; keywords;
      private String description;
      private String generator;
      private boolean showTimestamp;
<span class="line-modified">!     private boolean useModuleDirectories;</span>
<span class="line-modified">!     private DocFile mainStylesheetFile;</span>
<span class="line-removed">-     private List&lt;DocFile&gt; additionalStylesheetFiles = Collections.emptyList();</span>
      private boolean index;
      private Script mainBodyScript;
      private final List&lt;Script&gt; scripts;
      private final List&lt;Content&gt; extraContent;
      private boolean addDefaultScript = true;
      private DocPath canonicalLink;
  
<span class="line-removed">-     private static final Calendar calendar = new GregorianCalendar(TimeZone.getDefault());</span>
<span class="line-removed">- </span>
      /**
       * Creates a {@code Head} object, for a given file and HTML version.
       * The file is used to help determine the relative paths to stylesheet and script files.
       * The HTML version is used to determine the the appropriate form of a META element
       * recording the time the file was created.
       * The doclet version should also be provided for recording in the file.
       * @param path the path for the file that will include this HEAD element
       * @param docletVersion a string identifying the doclet version
       */
<span class="line-modified">!     public Head(DocPath path, String docletVersion) {</span>
          this.docletVersion = docletVersion;
          pathToRoot = path.parent().invert();
          keywords = new ArrayList&lt;&gt;();
          scripts = new ArrayList&lt;&gt;();
          extraContent = new ArrayList&lt;&gt;();
      }
<span class="line-new-header">--- 46,39 ---</span>
   *  This code and its internal interfaces are subject to change or
   *  deletion without notice.&lt;/b&gt;
   */
  public class Head {
      private final String docletVersion;
<span class="line-added">+     private final Date generatedDate;</span>
      private final DocPath pathToRoot;
      private String title;
      private String charset;
      private final List&lt;String&gt; keywords;
      private String description;
      private String generator;
      private boolean showTimestamp;
<span class="line-modified">!     private DocPath mainStylesheet;</span>
<span class="line-modified">!     private List&lt;DocPath&gt; additionalStylesheets = Collections.emptyList();</span>
      private boolean index;
      private Script mainBodyScript;
      private final List&lt;Script&gt; scripts;
      private final List&lt;Content&gt; extraContent;
      private boolean addDefaultScript = true;
      private DocPath canonicalLink;
  
      /**
       * Creates a {@code Head} object, for a given file and HTML version.
       * The file is used to help determine the relative paths to stylesheet and script files.
       * The HTML version is used to determine the the appropriate form of a META element
       * recording the time the file was created.
       * The doclet version should also be provided for recording in the file.
       * @param path the path for the file that will include this HEAD element
       * @param docletVersion a string identifying the doclet version
       */
<span class="line-modified">!     public Head(DocPath path, String docletVersion, Date generatedDate) {</span>
          this.docletVersion = docletVersion;
<span class="line-added">+         this.generatedDate = generatedDate;</span>
          pathToRoot = path.parent().invert();
          keywords = new ArrayList&lt;&gt;();
          scripts = new ArrayList&lt;&gt;();
          extraContent = new ArrayList&lt;&gt;();
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 147,38 ***</span>
       * element, depending on the HTML version specified when this object was created.
       *
       * @param timestamp true if timestamps should be be added.
       * @return this object
       */
<span class="line-modified">!     // For temporary backwards compatibiility, if this method is not called,</span>
      // no &#39;Generated by javadoc&#39; comment will be added.
      public Head setTimestamp(boolean timestamp) {
          showTimestamp = timestamp;
          return this;
      }
  
      /**
       * Sets the main and any additional stylesheets to be listed in the HEAD element.
       *
       * @param main the main stylesheet, or null to use the default
       * @param additional a list of any additional stylesheets to be included
       * @return  this object
       */
<span class="line-modified">!     public Head setStylesheets(DocFile main, List&lt;DocFile&gt; additional) {</span>
<span class="line-modified">!         this.mainStylesheetFile = main;</span>
<span class="line-modified">!         this.additionalStylesheetFiles = additional;</span>
<span class="line-removed">-         return this;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Sets whether the module directories should be used. This is used to set the JavaScript variable.</span>
<span class="line-removed">-      *</span>
<span class="line-removed">-      * @param useModuleDirectories true if the module directories should be used</span>
<span class="line-removed">-      * @return  this object</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public Head setUseModuleDirectories(boolean useModuleDirectories) {</span>
<span class="line-removed">-         this.useModuleDirectories = useModuleDirectories;</span>
          return this;
      }
  
      /**
       * Sets whether or not to include the supporting scripts and stylesheets for the
<span class="line-new-header">--- 142,29 ---</span>
       * element, depending on the HTML version specified when this object was created.
       *
       * @param timestamp true if timestamps should be be added.
       * @return this object
       */
<span class="line-modified">!     // For temporary backwards compatibility, if this method is not called,</span>
      // no &#39;Generated by javadoc&#39; comment will be added.
      public Head setTimestamp(boolean timestamp) {
          showTimestamp = timestamp;
          return this;
      }
  
      /**
       * Sets the main and any additional stylesheets to be listed in the HEAD element.
<span class="line-added">+      * The paths for the stylesheets must be relative to the root of the generated</span>
<span class="line-added">+      * documentation hierarchy.</span>
       *
       * @param main the main stylesheet, or null to use the default
       * @param additional a list of any additional stylesheets to be included
       * @return  this object
       */
<span class="line-modified">!     public Head setStylesheets(DocPath main, List&lt;DocPath&gt; additional) {</span>
<span class="line-modified">!         this.mainStylesheet = main;</span>
<span class="line-modified">!         this.additionalStylesheets = additional;</span>
          return this;
      }
  
      /**
       * Sets whether or not to include the supporting scripts and stylesheets for the
</pre>
<hr />
<pre>
<span class="line-old-header">*** 223,11 ***</span>
  
      /**
       * Specifies a value for a
       * &lt;a href=&quot;https://en.wikipedia.org/wiki/Canonical_link_element&quot;&gt;canonical link&lt;/a&gt;
       * in the {@code &lt;head&gt;} element.
<span class="line-modified">!      * @param link</span>
       */
      public void setCanonicalLink(DocPath link) {
          this.canonicalLink = link;
      }
  
<span class="line-new-header">--- 209,11 ---</span>
  
      /**
       * Specifies a value for a
       * &lt;a href=&quot;https://en.wikipedia.org/wiki/Canonical_link_element&quot;&gt;canonical link&lt;/a&gt;
       * in the {@code &lt;head&gt;} element.
<span class="line-modified">!      * @param link the value for the canonical link</span>
       */
      public void setCanonicalLink(DocPath link) {
          this.canonicalLink = link;
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 246,23 ***</span>
       * Returns the HTML for the HEAD element.
       *
       * @return the HTML
       */
      public Content toContent() {
<span class="line-removed">-         Date now = showTimestamp ? calendar.getTime() : null;</span>
<span class="line-removed">- </span>
          HtmlTree tree = new HtmlTree(HtmlTag.HEAD);
<span class="line-modified">!         tree.add(getGeneratedBy(showTimestamp, now));</span>
          tree.add(HtmlTree.TITLE(title));
  
          if (charset != null) { // compatibility; should this be allowed?
              tree.add(HtmlTree.META(&quot;Content-Type&quot;, &quot;text/html&quot;, charset));
          }
  
          if (showTimestamp) {
              SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);
<span class="line-modified">!             tree.add(HtmlTree.META(&quot;dc.created&quot;, dateFormat.format(now)));</span>
          }
  
          if (description != null) {
              tree.add(HtmlTree.META(&quot;description&quot;, description));
          }
<span class="line-new-header">--- 232,21 ---</span>
       * Returns the HTML for the HEAD element.
       *
       * @return the HTML
       */
      public Content toContent() {
          HtmlTree tree = new HtmlTree(HtmlTag.HEAD);
<span class="line-modified">!         tree.add(getGeneratedBy(showTimestamp, generatedDate));</span>
          tree.add(HtmlTree.TITLE(title));
  
          if (charset != null) { // compatibility; should this be allowed?
              tree.add(HtmlTree.META(&quot;Content-Type&quot;, &quot;text/html&quot;, charset));
          }
  
          if (showTimestamp) {
              SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);
<span class="line-modified">!             tree.add(HtmlTree.META(&quot;dc.created&quot;, dateFormat.format(generatedDate)));</span>
          }
  
          if (description != null) {
              tree.add(HtmlTree.META(&quot;description&quot;, description));
          }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 296,20 ***</span>
          }
          return new Comment(text);
      }
  
      private void addStylesheets(HtmlTree tree) {
<span class="line-modified">!         DocPath mainStylesheet;</span>
<span class="line-removed">-         if (mainStylesheetFile == null) {</span>
              mainStylesheet = DocPaths.STYLESHEET;
<span class="line-removed">-         } else {</span>
<span class="line-removed">-             mainStylesheet = DocPath.create(mainStylesheetFile.getName());</span>
          }
          addStylesheet(tree, mainStylesheet);
  
<span class="line-modified">!         for (DocFile file : additionalStylesheetFiles) {</span>
<span class="line-modified">!             addStylesheet(tree, DocPath.create(file.getName()));</span>
          }
  
          if (index) {
              addStylesheet(tree, DocPaths.JQUERY_FILES.resolve(DocPaths.JQUERY_STYLESHEET_FILE));
          }
<span class="line-new-header">--- 280,17 ---</span>
          }
          return new Comment(text);
      }
  
      private void addStylesheets(HtmlTree tree) {
<span class="line-modified">!         if (mainStylesheet == null) {</span>
              mainStylesheet = DocPaths.STYLESHEET;
          }
          addStylesheet(tree, mainStylesheet);
  
<span class="line-modified">!         for (DocPath path : additionalStylesheets) {</span>
<span class="line-modified">!             addStylesheet(tree, path);</span>
          }
  
          if (index) {
              addStylesheet(tree, DocPaths.JQUERY_FILES.resolve(DocPaths.JQUERY_STYLESHEET_FILE));
          }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 328,20 ***</span>
              if (pathToRoot != null &amp;&amp; mainBodyScript != null) {
                  String ptrPath = pathToRoot.isEmpty() ? &quot;.&quot; : pathToRoot.getPath();
                  mainBodyScript.append(&quot;var pathtoroot = &quot;)
                          .appendStringLiteral(ptrPath + &quot;/&quot;)
                          .append(&quot;;\n&quot;)
<span class="line-modified">!                         .append(&quot;var useModuleDirectories = &quot; + useModuleDirectories + &quot;;\n&quot;)</span>
<span class="line-removed">-                         .append(&quot;loadScripts(document, \&#39;script\&#39;);&quot;);</span>
              }
<span class="line-modified">!             addJQueryFile(tree, DocPaths.JSZIP_MIN);</span>
<span class="line-removed">-             addJQueryFile(tree, DocPaths.JSZIPUTILS_MIN);</span>
<span class="line-removed">-             tree.add(new RawHtml(&quot;&lt;!--[if IE]&gt;&quot;));</span>
<span class="line-removed">-             addJQueryFile(tree, DocPaths.JSZIPUTILS_IE_MIN);</span>
<span class="line-removed">-             tree.add(new RawHtml(&quot;&lt;![endif]--&gt;&quot;));</span>
<span class="line-removed">-             addJQueryFile(tree, DocPaths.JQUERY_JS_3_3);</span>
<span class="line-removed">-             addJQueryFile(tree, DocPaths.JQUERY_MIGRATE);</span>
              addJQueryFile(tree, DocPaths.JQUERY_JS);
          }
          for (Script script : scripts) {
              tree.add(script.asContent());
          }
<span class="line-new-header">--- 309,13 ---</span>
              if (pathToRoot != null &amp;&amp; mainBodyScript != null) {
                  String ptrPath = pathToRoot.isEmpty() ? &quot;.&quot; : pathToRoot.getPath();
                  mainBodyScript.append(&quot;var pathtoroot = &quot;)
                          .appendStringLiteral(ptrPath + &quot;/&quot;)
                          .append(&quot;;\n&quot;)
<span class="line-modified">!                         .append(&quot;loadScripts(document, &#39;script&#39;);&quot;);</span>
              }
<span class="line-modified">!             addJQueryFile(tree, DocPaths.JQUERY_JS_3_4);</span>
              addJQueryFile(tree, DocPaths.JQUERY_JS);
          }
          for (Script script : scripts) {
              tree.add(script.asContent());
          }
</pre>
<center><a href="FixedStringContent.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="HtmlAttr.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>