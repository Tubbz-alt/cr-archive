<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/builders/SerializedFormBuilder.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="PropertyBuilder.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../resources/doclets.properties.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/builders/SerializedFormBuilder.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 49,13 ***</span>
   *
   *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
   *  If you write code that depends on this, you do so at your own risk.
   *  This code and its internal interfaces are subject to change or
   *  deletion without notice.&lt;/b&gt;
<span class="line-removed">-  *</span>
<span class="line-removed">-  * @author Jamie Ho</span>
<span class="line-removed">-  * @author Bhavesh Patel (Modified)</span>
   */
  public class SerializedFormBuilder extends AbstractBuilder {
  
      /**
       * The writer for this builder.
<span class="line-new-header">--- 49,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 93,16 ***</span>
      /**
       * The current member being documented.
       */
      protected Element currentMember;
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * The content that will be added to the serialized form documentation tree.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     private Content contentTree;</span>
<span class="line-removed">- </span>
<span class="line-removed">- </span>
      /**
       * Construct a new SerializedFormBuilder.
       * @param context  the build context.
       */
      private SerializedFormBuilder(Context context) {
<span class="line-new-header">--- 90,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 135,45 ***</span>
          writer = configuration.getWriterFactory().getSerializedFormWriter();
          if (writer == null) {
              //Doclet does not support this output.
              return;
          }
<span class="line-modified">!         buildSerializedForm(contentTree);</span>
      }
  
      /**
       * Build the serialized form.
       *
<span class="line-removed">-      * @param serializedTree content tree to which the documentation will be added</span>
       * @throws DocletException if there is a problem while building the documentation
       */
<span class="line-modified">!     protected void buildSerializedForm(Content serializedTree) throws DocletException {</span>
<span class="line-modified">!         serializedTree = writer.getHeader(resources.getText(</span>
                  &quot;doclet.Serialized_Form&quot;));
  
<span class="line-modified">!         buildSerializedFormSummaries(serializedTree);</span>
  
<span class="line-modified">!         writer.addFooter(serializedTree);</span>
<span class="line-modified">!         writer.printDocument(serializedTree);</span>
      }
  
      /**
       * Build the serialized form summaries.
       *
<span class="line-removed">-      * @param serializedTree content tree to which the documentation will be added</span>
       * @throws DocletException if there is a problem while building the documentation
       */
<span class="line-modified">!     protected void buildSerializedFormSummaries(Content serializedTree)</span>
              throws DocletException {
          Content serializedSummariesTree = writer.getSerializedSummariesHeader();
          for (PackageElement pkg : configuration.packages) {
              currentPackage = pkg;
  
              buildPackageSerializedForm(serializedSummariesTree);
          }
<span class="line-modified">!         serializedTree.add(writer.getSerializedContent(</span>
<span class="line-removed">-                 serializedSummariesTree));</span>
      }
  
      /**
       * Build the package serialized form for the current package being processed.
       *
<span class="line-new-header">--- 126,42 ---</span>
          writer = configuration.getWriterFactory().getSerializedFormWriter();
          if (writer == null) {
              //Doclet does not support this output.
              return;
          }
<span class="line-modified">!         buildSerializedForm();</span>
      }
  
      /**
       * Build the serialized form.
       *
       * @throws DocletException if there is a problem while building the documentation
       */
<span class="line-modified">!     protected void buildSerializedForm() throws DocletException {</span>
<span class="line-modified">!         Content contentTree = writer.getHeader(resources.getText(</span>
                  &quot;doclet.Serialized_Form&quot;));
  
<span class="line-modified">!         buildSerializedFormSummaries();</span>
  
<span class="line-modified">!         writer.addFooter();</span>
<span class="line-modified">!         writer.printDocument(contentTree);</span>
      }
  
      /**
       * Build the serialized form summaries.
       *
       * @throws DocletException if there is a problem while building the documentation
       */
<span class="line-modified">!     protected void buildSerializedFormSummaries()</span>
              throws DocletException {
          Content serializedSummariesTree = writer.getSerializedSummariesHeader();
          for (PackageElement pkg : configuration.packages) {
              currentPackage = pkg;
  
              buildPackageSerializedForm(serializedSummariesTree);
          }
<span class="line-modified">!         writer.addSerializedContent(serializedSummariesTree);</span>
      }
  
      /**
       * Build the package serialized form for the current package being processed.
       *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 230,11 ***</span>
                  Content classTree = writer.getClassHeader(currentTypeElement);
  
                  buildSerialUIDInfo(classTree);
                  buildClassContent(classTree);
  
<span class="line-modified">!                 classSerializedTree.add(classTree);</span>
              }
          }
          packageSerializedTree.add(classSerializedTree);
      }
  
<span class="line-new-header">--- 218,11 ---</span>
                  Content classTree = writer.getClassHeader(currentTypeElement);
  
                  buildSerialUIDInfo(classTree);
                  buildClassContent(classTree);
  
<span class="line-modified">!                 classSerializedTree.add(writer.getMemberTree(classTree));</span>
              }
          }
          packageSerializedTree.add(classSerializedTree);
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 334,11 ***</span>
       *
       * @param methodsContentTree content tree to which the documentation will be added
       * @throws DocletException if there is a problem while building the documentation
       */
      protected void buildMethodInfo(Content methodsContentTree) throws DocletException  {
<span class="line-modified">!         if (configuration.nocomment) {</span>
              return;
          }
  
          buildMethodDescription(methodsContentTree);
          buildMethodTags(methodsContentTree);
<span class="line-new-header">--- 322,11 ---</span>
       *
       * @param methodsContentTree content tree to which the documentation will be added
       * @throws DocletException if there is a problem while building the documentation
       */
      protected void buildMethodInfo(Content methodsContentTree) throws DocletException  {
<span class="line-modified">!         if (options.noComment()) {</span>
              return;
          }
  
          buildMethodDescription(methodsContentTree);
          buildMethodTags(methodsContentTree);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 361,11 ***</span>
      protected void buildMethodTags(Content methodsContentTree) {
          methodWriter.addMemberTags((ExecutableElement)currentMember, methodsContentTree);
          ExecutableElement method = (ExecutableElement)currentMember;
          if (method.getSimpleName().toString().compareTo(&quot;writeExternal&quot;) == 0
                  &amp;&amp; utils.getSerialDataTrees(method).isEmpty()) {
<span class="line-modified">!             if (configuration.serialwarn) {</span>
                  TypeElement encl  = (TypeElement) method.getEnclosingElement();
                  messages.warning(currentMember,
                          &quot;doclet.MissingSerialDataTag&quot;, encl.getQualifiedName().toString(),
                          method.getSimpleName().toString());
              }
<span class="line-new-header">--- 349,11 ---</span>
      protected void buildMethodTags(Content methodsContentTree) {
          methodWriter.addMemberTags((ExecutableElement)currentMember, methodsContentTree);
          ExecutableElement method = (ExecutableElement)currentMember;
          if (method.getSimpleName().toString().compareTo(&quot;writeExternal&quot;) == 0
                  &amp;&amp; utils.getSerialDataTrees(method).isEmpty()) {
<span class="line-modified">!             if (options.serialWarn()) {</span>
                  TypeElement encl  = (TypeElement) method.getEnclosingElement();
                  messages.warning(currentMember,
                          &quot;doclet.MissingSerialDataTag&quot;, encl.getQualifiedName().toString(),
                          method.getSimpleName().toString());
              }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 396,11 ***</span>
              // information to be printed.
              if (fieldWriter.shouldPrintOverview(ve)) {
                  Content serializableFieldsTree = fieldWriter.getSerializableFieldsHeader();
                  Content fieldsOverviewContentTree = fieldWriter.getFieldsContentHeader(true);
                  fieldWriter.addMemberDeprecatedInfo(ve, fieldsOverviewContentTree);
<span class="line-modified">!                 if (!configuration.nocomment) {</span>
                      fieldWriter.addMemberDescription(ve, fieldsOverviewContentTree);
                      fieldWriter.addMemberTags(ve, fieldsOverviewContentTree);
                  }
                  serializableFieldsTree.add(fieldsOverviewContentTree);
                  classContentTree.add(fieldWriter.getSerializableFields(
<span class="line-new-header">--- 384,11 ---</span>
              // information to be printed.
              if (fieldWriter.shouldPrintOverview(ve)) {
                  Content serializableFieldsTree = fieldWriter.getSerializableFieldsHeader();
                  Content fieldsOverviewContentTree = fieldWriter.getFieldsContentHeader(true);
                  fieldWriter.addMemberDeprecatedInfo(ve, fieldsOverviewContentTree);
<span class="line-modified">!                 if (!options.noComment()) {</span>
                      fieldWriter.addMemberDescription(ve, fieldsOverviewContentTree);
                      fieldWriter.addMemberTags(ve, fieldsOverviewContentTree);
                  }
                  serializableFieldsTree.add(fieldsOverviewContentTree);
                  classContentTree.add(fieldWriter.getSerializableFields(
</pre>
<hr />
<pre>
<span class="line-old-header">*** 472,11 ***</span>
       * Build the serial field tags information.
       *
       * @param serializableFieldsTree content tree to which the documentation will be added
       */
      protected void buildSerialFieldTagsInfo(Content serializableFieldsTree) {
<span class="line-modified">!         if (configuration.nocomment) {</span>
              return;
          }
          VariableElement field = (VariableElement)currentMember;
          // Process Serializable Fields specified as array of
          // ObjectStreamFields. Print a member for each serialField tag.
<span class="line-new-header">--- 460,11 ---</span>
       * Build the serial field tags information.
       *
       * @param serializableFieldsTree content tree to which the documentation will be added
       */
      protected void buildSerialFieldTagsInfo(Content serializableFieldsTree) {
<span class="line-modified">!         if (options.noComment()) {</span>
              return;
          }
          VariableElement field = (VariableElement)currentMember;
          // Process Serializable Fields specified as array of
          // ObjectStreamFields. Print a member for each serialField tag.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 492,11 ***</span>
          CommentHelper ch = utils.getCommentHelper(field);
          for (SerialFieldTree tag : tags) {
              if (tag.getName() == null || tag.getType() == null)  // ignore malformed @serialField tags
                  continue;
              Content fieldsContentTree = fieldWriter.getFieldsContentHeader(tag.equals(tags.last()));
<span class="line-modified">!             TypeElement te = ch.getReferencedClass(configuration, tag);</span>
              String fieldType = ch.getReferencedMemberName(tag);
              if (te != null &amp;&amp; utils.isPrimitive(te.asType())) {
                  fieldType = utils.getTypeName(te.asType(), false);
                  te = null;
              }
<span class="line-new-header">--- 480,11 ---</span>
          CommentHelper ch = utils.getCommentHelper(field);
          for (SerialFieldTree tag : tags) {
              if (tag.getName() == null || tag.getType() == null)  // ignore malformed @serialField tags
                  continue;
              Content fieldsContentTree = fieldWriter.getFieldsContentHeader(tag.equals(tags.last()));
<span class="line-modified">!             TypeElement te = ch.getReferencedClass(tag);</span>
              String fieldType = ch.getReferencedMemberName(tag);
              if (te != null &amp;&amp; utils.isPrimitive(te.asType())) {
                  fieldType = utils.getTypeName(te.asType(), false);
                  te = null;
              }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 519,18 ***</span>
       * Build the field information.
       *
       * @param fieldsContentTree content tree to which the documentation will be added
       */
      protected void buildFieldInfo(Content fieldsContentTree) {
<span class="line-modified">!         if (configuration.nocomment) {</span>
              return;
          }
          VariableElement field = (VariableElement)currentMember;
          TypeElement te = utils.getEnclosingTypeElement(currentMember);
          // Process default Serializable field.
          if ((utils.getSerialTrees(field).isEmpty()) /*&amp;&amp; !field.isSynthetic()*/
<span class="line-modified">!                 &amp;&amp; configuration.serialwarn) {</span>
              messages.warning(field,
                      &quot;doclet.MissingSerialTag&quot;, utils.getFullyQualifiedName(te),
                      utils.getSimpleName(field));
          }
          fieldWriter.addMemberDescription(field, fieldsContentTree);
<span class="line-new-header">--- 507,18 ---</span>
       * Build the field information.
       *
       * @param fieldsContentTree content tree to which the documentation will be added
       */
      protected void buildFieldInfo(Content fieldsContentTree) {
<span class="line-modified">!         if (options.noComment()) {</span>
              return;
          }
          VariableElement field = (VariableElement)currentMember;
          TypeElement te = utils.getEnclosingTypeElement(currentMember);
          // Process default Serializable field.
          if ((utils.getSerialTrees(field).isEmpty()) /*&amp;&amp; !field.isSynthetic()*/
<span class="line-modified">!                 &amp;&amp; options.serialWarn()) {</span>
              messages.warning(field,
                      &quot;doclet.MissingSerialTag&quot;, utils.getFullyQualifiedName(te),
                      utils.getSimpleName(field));
          }
          fieldWriter.addMemberDescription(field, fieldsContentTree);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 598,14 ***</span>
          }
          return true;
      }
  
      /**
<span class="line-modified">!      * Return true if any of the given typeElements have a @serialinclude tag.</span>
       *
       * @param classes the typeElements to check.
<span class="line-modified">!      * @return true if any of the given typeElements have a @serialinclude tag.</span>
       */
      private boolean serialClassFoundToDocument(SortedSet&lt;TypeElement&gt; classes) {
          for (TypeElement aClass : classes) {
              if (serialClassInclude(utils, aClass)) {
                  return true;
<span class="line-new-header">--- 586,14 ---</span>
          }
          return true;
      }
  
      /**
<span class="line-modified">!      * Return true if any of the given typeElements have a {@code @serial include} tag.</span>
       *
       * @param classes the typeElements to check.
<span class="line-modified">!      * @return true if any of the given typeElements have a {@code @serial include} tag.</span>
       */
      private boolean serialClassFoundToDocument(SortedSet&lt;TypeElement&gt; classes) {
          for (TypeElement aClass : classes) {
              if (serialClassInclude(utils, aClass)) {
                  return true;
</pre>
<center><a href="PropertyBuilder.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../resources/doclets.properties.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>