<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/ConstantsSummaryWriterImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ClassWriterImpl.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="ConstructorWriterImpl.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/ConstantsSummaryWriterImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2001, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2001, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 23,27 ***</span>
   * questions.
   */
  
  package jdk.javadoc.internal.doclets.formats.html;
  
<span class="line-modified">! import jdk.javadoc.internal.doclets.formats.html.markup.Table;</span>
<span class="line-modified">! import jdk.javadoc.internal.doclets.formats.html.markup.TableHeader;</span>
<span class="line-removed">- </span>
<span class="line-removed">- import java.util.*;</span>
  
  import javax.lang.model.element.Modifier;
  import javax.lang.model.element.PackageElement;
  import javax.lang.model.element.TypeElement;
  import javax.lang.model.element.VariableElement;
  
  import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlStyle;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTag;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTree;
  import jdk.javadoc.internal.doclets.formats.html.markup.Navigation;
  import jdk.javadoc.internal.doclets.formats.html.markup.Navigation.PageMode;
  import jdk.javadoc.internal.doclets.formats.html.markup.StringContent;
  import jdk.javadoc.internal.doclets.toolkit.ConstantsSummaryWriter;
  import jdk.javadoc.internal.doclets.toolkit.Content;
  import jdk.javadoc.internal.doclets.toolkit.util.DocFileIOException;
  import jdk.javadoc.internal.doclets.toolkit.util.DocLink;
  import jdk.javadoc.internal.doclets.toolkit.util.DocPaths;
<span class="line-new-header">--- 23,29 ---</span>
   * questions.
   */
  
  package jdk.javadoc.internal.doclets.formats.html;
  
<span class="line-modified">! import java.util.Collection;</span>
<span class="line-modified">! import java.util.Set;</span>
  
  import javax.lang.model.element.Modifier;
  import javax.lang.model.element.PackageElement;
  import javax.lang.model.element.TypeElement;
  import javax.lang.model.element.VariableElement;
  
<span class="line-added">+ import jdk.javadoc.internal.doclets.formats.html.markup.BodyContents;</span>
  import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;
<span class="line-added">+ import jdk.javadoc.internal.doclets.formats.html.markup.Entity;</span>
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlStyle;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTag;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTree;
  import jdk.javadoc.internal.doclets.formats.html.markup.Navigation;
  import jdk.javadoc.internal.doclets.formats.html.markup.Navigation.PageMode;
  import jdk.javadoc.internal.doclets.formats.html.markup.StringContent;
<span class="line-added">+ import jdk.javadoc.internal.doclets.formats.html.markup.Table;</span>
<span class="line-added">+ import jdk.javadoc.internal.doclets.formats.html.markup.TableHeader;</span>
  import jdk.javadoc.internal.doclets.toolkit.ConstantsSummaryWriter;
  import jdk.javadoc.internal.doclets.toolkit.Content;
  import jdk.javadoc.internal.doclets.toolkit.util.DocFileIOException;
  import jdk.javadoc.internal.doclets.toolkit.util.DocLink;
  import jdk.javadoc.internal.doclets.toolkit.util.DocPaths;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 54,13 ***</span>
   *
   *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
   *  If you write code that depends on this, you do so at your own risk.
   *  This code and its internal interfaces are subject to change or
   *  deletion without notice.&lt;/b&gt;
<span class="line-removed">-  *</span>
<span class="line-removed">-  * @author Jamie Ho</span>
<span class="line-removed">-  * @author Bhavesh Patel (Modified)</span>
   */
  public class ConstantsSummaryWriterImpl extends HtmlDocletWriter implements ConstantsSummaryWriter {
  
      /**
       * The configuration used in this run of the standard doclet.
<span class="line-new-header">--- 56,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 72,61 ***</span>
       */
      private TypeElement currentTypeElement;
  
      private final TableHeader constantsTableHeader;
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * The HTML tree for main tag.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     private final HtmlTree mainTree = HtmlTree.MAIN();</span>
<span class="line-removed">- </span>
      /**
       * The HTML tree for constant values summary.
       */
      private HtmlTree summaryTree;
  
      private final Navigation navBar;
  
      /**
       * Construct a ConstantsSummaryWriter.
       * @param configuration the configuration used in this run
       *        of the standard doclet.
       */
      public ConstantsSummaryWriterImpl(HtmlConfiguration configuration) {
          super(configuration, DocPaths.CONSTANT_VALUES);
          this.configuration = configuration;
          constantsTableHeader = new TableHeader(
                  contents.modifierAndTypeLabel, contents.constantFieldLabel, contents.valueLabel);
<span class="line-modified">!         this.navBar = new Navigation(null, configuration, fixedNavDiv, PageMode.CONSTANTVALUES, path);</span>
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public Content getHeader() {
          String label = resources.getText(&quot;doclet.Constants_Summary&quot;);
<span class="line-modified">!         HtmlTree bodyTree = getBody(true, getWindowTitle(label));</span>
<span class="line-modified">!         HtmlTree htmlTree = HtmlTree.HEADER();</span>
<span class="line-modified">!         addTop(htmlTree);</span>
          navBar.setUserHeader(getUserHeaderFooter(true));
<span class="line-modified">!         htmlTree.add(navBar.getContent(true));</span>
<span class="line-modified">!         bodyTree.add(htmlTree);</span>
          return bodyTree;
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public Content getContentsHeader() {
          return new HtmlTree(HtmlTag.UL);
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public void addLinkToPackageContent(PackageElement pkg,
              Set&lt;PackageElement&gt; printedPackageHeaders, Content contentListTree) {
          //add link to summary
          Content link;
<span class="line-new-header">--- 71,49 ---</span>
       */
      private TypeElement currentTypeElement;
  
      private final TableHeader constantsTableHeader;
  
      /**
       * The HTML tree for constant values summary.
       */
      private HtmlTree summaryTree;
  
      private final Navigation navBar;
  
<span class="line-added">+     private final BodyContents bodyContents = new BodyContents();</span>
<span class="line-added">+ </span>
      /**
       * Construct a ConstantsSummaryWriter.
       * @param configuration the configuration used in this run
       *        of the standard doclet.
       */
      public ConstantsSummaryWriterImpl(HtmlConfiguration configuration) {
          super(configuration, DocPaths.CONSTANT_VALUES);
          this.configuration = configuration;
          constantsTableHeader = new TableHeader(
                  contents.modifierAndTypeLabel, contents.constantFieldLabel, contents.valueLabel);
<span class="line-modified">!         this.navBar = new Navigation(null, configuration, PageMode.CONSTANTVALUES, path);</span>
      }
  
      @Override
      public Content getHeader() {
          String label = resources.getText(&quot;doclet.Constants_Summary&quot;);
<span class="line-modified">!         HtmlTree bodyTree = getBody(getWindowTitle(label));</span>
<span class="line-modified">!         Content headerContent = new ContentBuilder();</span>
<span class="line-modified">!         addTop(headerContent);</span>
          navBar.setUserHeader(getUserHeaderFooter(true));
<span class="line-modified">!         headerContent.add(navBar.getContent(true));</span>
<span class="line-modified">!         bodyContents.setHeader(headerContent);</span>
          return bodyTree;
      }
  
      @Override
      public Content getContentsHeader() {
          return new HtmlTree(HtmlTag.UL);
      }
  
      @Override
      public void addLinkToPackageContent(PackageElement pkg,
              Set&lt;PackageElement&gt; printedPackageHeaders, Content contentListTree) {
          //add link to summary
          Content link;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 143,83 ***</span>
              printedPackageHeaders.add(abbrevPkg);
          }
          contentListTree.add(HtmlTree.LI(link));
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
<span class="line-modified">!     public void addContentsList(Content contentTree, Content contentListTree) {</span>
          Content titleContent = contents.constantsSummaryTitle;
          Content pHeading = HtmlTree.HEADING(Headings.PAGE_TITLE_HEADING, true,
                  HtmlStyle.title, titleContent);
          Content div = HtmlTree.DIV(HtmlStyle.header, pHeading);
          Content headingContent = contents.contentsHeading;
          Content heading = HtmlTree.HEADING(Headings.CONTENT_HEADING, true,
                  headingContent);
<span class="line-modified">!         HtmlTree section = HtmlTree.SECTION(heading);</span>
          section.add(contentListTree);
          div.add(section);
<span class="line-modified">!         mainTree.add(div);</span>
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public Content getConstantSummaries() {
          HtmlTree summariesDiv = new HtmlTree(HtmlTag.DIV);
          summariesDiv.setStyle(HtmlStyle.constantValuesContainer);
          return summariesDiv;
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public void addPackageName(PackageElement pkg, Content summariesTree, boolean first) {
          Content pkgNameContent;
          if (!first) {
              summariesTree.add(summaryTree);
          }
          if (pkg.isUnnamed()) {
<span class="line-modified">!             summariesTree.add(links.createAnchor(SectionName.UNNAMED_PACKAGE_ANCHOR));</span>
              pkgNameContent = contents.defaultPackageLabel;
          } else {
              String parsedPackageName = utils.parsePackageName(pkg);
<span class="line-modified">!             summariesTree.add(links.createAnchor(parsedPackageName));</span>
              pkgNameContent = getPackageLabel(parsedPackageName);
          }
          Content headingContent = new StringContent(&quot;.*&quot;);
          Content heading = HtmlTree.HEADING(Headings.ConstantsSummary.PACKAGE_HEADING, true,
                  pkgNameContent);
          heading.add(headingContent);
<span class="line-modified">!         summaryTree = HtmlTree.SECTION(heading);</span>
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public Content getClassConstantHeader() {
          HtmlTree ul = new HtmlTree(HtmlTag.UL);
          ul.setStyle(HtmlStyle.blockList);
          return ul;
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public void addClassConstant(Content summariesTree, Content classConstantTree) {
          summaryTree.add(classConstantTree);
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public void addConstantMembers(TypeElement typeElement, Collection&lt;VariableElement&gt; fields,
              Content classConstantTree) {
          currentTypeElement = typeElement;
  
<span class="line-new-header">--- 130,67 ---</span>
              printedPackageHeaders.add(abbrevPkg);
          }
          contentListTree.add(HtmlTree.LI(link));
      }
  
      @Override
<span class="line-modified">!     public void addContentsList(Content contentListTree) {</span>
          Content titleContent = contents.constantsSummaryTitle;
          Content pHeading = HtmlTree.HEADING(Headings.PAGE_TITLE_HEADING, true,
                  HtmlStyle.title, titleContent);
          Content div = HtmlTree.DIV(HtmlStyle.header, pHeading);
          Content headingContent = contents.contentsHeading;
          Content heading = HtmlTree.HEADING(Headings.CONTENT_HEADING, true,
                  headingContent);
<span class="line-modified">!         HtmlTree section = HtmlTree.SECTION(HtmlStyle.packages, heading);</span>
          section.add(contentListTree);
          div.add(section);
<span class="line-modified">!         bodyContents.addMainContent(div);</span>
      }
  
      @Override
      public Content getConstantSummaries() {
          HtmlTree summariesDiv = new HtmlTree(HtmlTag.DIV);
          summariesDiv.setStyle(HtmlStyle.constantValuesContainer);
          return summariesDiv;
      }
  
      @Override
      public void addPackageName(PackageElement pkg, Content summariesTree, boolean first) {
          Content pkgNameContent;
<span class="line-added">+         String anchorName;</span>
          if (!first) {
              summariesTree.add(summaryTree);
          }
          if (pkg.isUnnamed()) {
<span class="line-modified">!             anchorName = SectionName.UNNAMED_PACKAGE_ANCHOR.getName();</span>
              pkgNameContent = contents.defaultPackageLabel;
          } else {
              String parsedPackageName = utils.parsePackageName(pkg);
<span class="line-modified">!             anchorName = parsedPackageName;</span>
              pkgNameContent = getPackageLabel(parsedPackageName);
          }
          Content headingContent = new StringContent(&quot;.*&quot;);
          Content heading = HtmlTree.HEADING(Headings.ConstantsSummary.PACKAGE_HEADING, true,
                  pkgNameContent);
          heading.add(headingContent);
<span class="line-modified">!         summaryTree = HtmlTree.SECTION(HtmlStyle.constantsSummary, heading)</span>
<span class="line-added">+                 .setId(links.getName(anchorName));</span>
      }
  
      @Override
      public Content getClassConstantHeader() {
          HtmlTree ul = new HtmlTree(HtmlTag.UL);
          ul.setStyle(HtmlStyle.blockList);
          return ul;
      }
  
      @Override
      public void addClassConstant(Content summariesTree, Content classConstantTree) {
          summaryTree.add(classConstantTree);
      }
  
      @Override
      public void addConstantMembers(TypeElement typeElement, Collection&lt;VariableElement&gt; fields,
              Content classConstantTree) {
          currentTypeElement = typeElement;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 255,19 ***</span>
       *
       * @param member the field to be documented.
       * @return the type column of the constant table row
       */
      private Content getTypeColumn(VariableElement member) {
<span class="line-removed">-         Content anchor = links.createAnchor(</span>
<span class="line-removed">-                 currentTypeElement.getQualifiedName() + &quot;.&quot; + member.getSimpleName());</span>
          Content typeContent = new ContentBuilder();
<span class="line-modified">!         typeContent.add(anchor);</span>
<span class="line-modified">!         Content code = new HtmlTree(HtmlTag.CODE);</span>
          for (Modifier mod : member.getModifiers()) {
              Content modifier = new StringContent(mod.toString());
              code.add(modifier);
<span class="line-modified">!             code.add(Contents.SPACE);</span>
          }
          Content type = getLink(new LinkInfoImpl(configuration,
                  LinkInfoImpl.Kind.CONSTANT_SUMMARY, member.asType()));
          code.add(type);
          typeContent.add(code);
<span class="line-new-header">--- 226,17 ---</span>
       *
       * @param member the field to be documented.
       * @return the type column of the constant table row
       */
      private Content getTypeColumn(VariableElement member) {
          Content typeContent = new ContentBuilder();
<span class="line-modified">!         String id = currentTypeElement.getQualifiedName() + &quot;.&quot; + member.getSimpleName();</span>
<span class="line-modified">!         Content code = new HtmlTree(HtmlTag.CODE).setId(id);</span>
          for (Modifier mod : member.getModifiers()) {
              Content modifier = new StringContent(mod.toString());
              code.add(modifier);
<span class="line-modified">!             code.add(Entity.NO_BREAK_SPACE);</span>
          }
          Content type = getLink(new LinkInfoImpl(configuration,
                  LinkInfoImpl.Kind.CONSTANT_SUMMARY, member.asType()));
          code.add(type);
          typeContent.add(code);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 296,37 ***</span>
          String value = utils.constantValueExpresion(member);
          Content valueContent = new StringContent(value);
          return HtmlTree.CODE(valueContent);
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
<span class="line-modified">!     public void addConstantSummaries(Content contentTree, Content summariesTree) {</span>
          if (summaryTree != null) {
              summariesTree.add(summaryTree);
          }
<span class="line-modified">!         mainTree.add(summariesTree);</span>
<span class="line-removed">-         contentTree.add(mainTree);</span>
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
<span class="line-modified">!     public void addFooter(Content contentTree) {</span>
          Content htmlTree = HtmlTree.FOOTER();
          navBar.setUserFooter(getUserHeaderFooter(false));
          htmlTree.add(navBar.getContent(false));
          addBottom(htmlTree);
<span class="line-modified">!         contentTree.add(htmlTree);</span>
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public void printDocument(Content contentTree) throws DocFileIOException {
          printHtmlDocument(null, &quot;summary of constants&quot;, contentTree);
      }
  }
<span class="line-new-header">--- 265,28 ---</span>
          String value = utils.constantValueExpresion(member);
          Content valueContent = new StringContent(value);
          return HtmlTree.CODE(valueContent);
      }
  
      @Override
<span class="line-modified">!     public void addConstantSummaries(Content summariesTree) {</span>
          if (summaryTree != null) {
              summariesTree.add(summaryTree);
          }
<span class="line-modified">!         bodyContents.addMainContent(summariesTree);</span>
      }
  
      @Override
<span class="line-modified">!     public void addFooter() {</span>
          Content htmlTree = HtmlTree.FOOTER();
          navBar.setUserFooter(getUserHeaderFooter(false));
          htmlTree.add(navBar.getContent(false));
          addBottom(htmlTree);
<span class="line-modified">!         bodyContents.setFooter(htmlTree);</span>
      }
  
      @Override
      public void printDocument(Content contentTree) throws DocFileIOException {
<span class="line-added">+         contentTree.add(bodyContents.toContent());</span>
          printHtmlDocument(null, &quot;summary of constants&quot;, contentTree);
      }
  }
</pre>
<center><a href="ClassWriterImpl.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="ConstructorWriterImpl.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>