<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/taglets/ValueTaglet.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="UserTaglet.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="package-info.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/taglets/ValueTaglet.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2001, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package jdk.javadoc.internal.doclets.toolkit.taglets;
 27 
 28 import java.util.EnumSet;
 29 import javax.lang.model.element.Element;
 30 import javax.lang.model.element.VariableElement;
 31 
 32 import com.sun.source.doctree.DocTree;

 33 import jdk.javadoc.internal.doclets.toolkit.BaseConfiguration;
 34 import jdk.javadoc.internal.doclets.toolkit.Content;
 35 import jdk.javadoc.internal.doclets.toolkit.Messages;
 36 import jdk.javadoc.internal.doclets.toolkit.util.CommentHelper;
 37 import jdk.javadoc.internal.doclets.toolkit.util.Utils;
 38 
<span class="line-removed"> 39 import static com.sun.source.doctree.DocTree.Kind.VALUE;</span>
<span class="line-removed"> 40 </span>
 41 /**
 42  * An inline Taglet representing the value tag. This tag should only be used with
 43  * constant fields that have a value.  It is used to access the value of constant
 44  * fields.  This inline tag has an optional field name parameter.  If the name is
 45  * specified, the constant value is retrieved from the specified field.  A link
 46  * is also created to the specified field.  If a name is not specified, the value
<span class="line-modified"> 47  * is retrieved for the field that the inline tag appears on.  The name is specifed</span>
 48  * in the following format:  [fully qualified class name]#[constant field name].
 49  *
 50  *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
 51  *  If you write code that depends on this, you do so at your own risk.
 52  *  This code and its internal interfaces are subject to change or
 53  *  deletion without notice.&lt;/b&gt;
<span class="line-removed"> 54  *</span>
<span class="line-removed"> 55  * @author Jamie Ho</span>
 56  */
 57 
 58 public class ValueTaglet extends BaseTaglet {
 59 
 60     /**
 61      * Construct a new ValueTaglet.
 62      */
 63     public ValueTaglet() {
<span class="line-modified"> 64         super(VALUE.tagName, true, EnumSet.allOf(Site.class));</span>
 65     }
 66 
 67     /**
 68      * Returns the referenced field or a null if the value tag
 69      * is empty or the reference is invalid.
 70      *
 71      * @param holder the tag holder.
 72      * @param config the  configuration of the doclet.
 73      * @param tag the value tag.
 74      *
 75      * @return the referenced field or null.
 76      */
 77     private VariableElement getVariableElement(Element holder, BaseConfiguration config, DocTree tag) {
 78         CommentHelper ch = config.utils.getCommentHelper(holder);
 79         String signature = ch.getReferencedSignature(tag);
 80 
 81         Element e = signature == null
 82                 ? holder
<span class="line-modified"> 83                 : ch.getReferencedMember(config, tag);</span>
 84 
 85         return (e != null &amp;&amp; config.utils.isVariableElement(e))
 86                 ? (VariableElement) e
 87                 : null;
 88     }
 89 
 90     @Override
 91     public Content getTagletOutput(Element holder, DocTree tag, TagletWriter writer) {
 92         Utils utils = writer.configuration().utils;
 93         Messages messages = writer.configuration().getMessages();
 94         VariableElement field = getVariableElement(holder, writer.configuration(), tag);
 95         if (field == null) {
 96             if (tag.toString().isEmpty()) {
 97                 //Invalid use of @value
 98                 messages.warning(holder,
 99                         &quot;doclet.value_tag_invalid_use&quot;);
100             } else {
101                 //Reference is unknown.
102                 messages.warning(holder,
103                         &quot;doclet.value_tag_invalid_reference&quot;, tag.toString());
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2001, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package jdk.javadoc.internal.doclets.toolkit.taglets;
 27 
 28 import java.util.EnumSet;
 29 import javax.lang.model.element.Element;
 30 import javax.lang.model.element.VariableElement;
 31 
 32 import com.sun.source.doctree.DocTree;
<span class="line-added"> 33 import jdk.javadoc.doclet.Taglet.Location;</span>
 34 import jdk.javadoc.internal.doclets.toolkit.BaseConfiguration;
 35 import jdk.javadoc.internal.doclets.toolkit.Content;
 36 import jdk.javadoc.internal.doclets.toolkit.Messages;
 37 import jdk.javadoc.internal.doclets.toolkit.util.CommentHelper;
 38 import jdk.javadoc.internal.doclets.toolkit.util.Utils;
 39 


 40 /**
 41  * An inline Taglet representing the value tag. This tag should only be used with
 42  * constant fields that have a value.  It is used to access the value of constant
 43  * fields.  This inline tag has an optional field name parameter.  If the name is
 44  * specified, the constant value is retrieved from the specified field.  A link
 45  * is also created to the specified field.  If a name is not specified, the value
<span class="line-modified"> 46  * is retrieved for the field that the inline tag appears on.  The name is specified</span>
 47  * in the following format:  [fully qualified class name]#[constant field name].
 48  *
 49  *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
 50  *  If you write code that depends on this, you do so at your own risk.
 51  *  This code and its internal interfaces are subject to change or
 52  *  deletion without notice.&lt;/b&gt;


 53  */
 54 
 55 public class ValueTaglet extends BaseTaglet {
 56 
 57     /**
 58      * Construct a new ValueTaglet.
 59      */
 60     public ValueTaglet() {
<span class="line-modified"> 61         super(DocTree.Kind.VALUE, true, EnumSet.allOf(Location.class));</span>
 62     }
 63 
 64     /**
 65      * Returns the referenced field or a null if the value tag
 66      * is empty or the reference is invalid.
 67      *
 68      * @param holder the tag holder.
 69      * @param config the  configuration of the doclet.
 70      * @param tag the value tag.
 71      *
 72      * @return the referenced field or null.
 73      */
 74     private VariableElement getVariableElement(Element holder, BaseConfiguration config, DocTree tag) {
 75         CommentHelper ch = config.utils.getCommentHelper(holder);
 76         String signature = ch.getReferencedSignature(tag);
 77 
 78         Element e = signature == null
 79                 ? holder
<span class="line-modified"> 80                 : ch.getReferencedMember(tag);</span>
 81 
 82         return (e != null &amp;&amp; config.utils.isVariableElement(e))
 83                 ? (VariableElement) e
 84                 : null;
 85     }
 86 
 87     @Override
 88     public Content getTagletOutput(Element holder, DocTree tag, TagletWriter writer) {
 89         Utils utils = writer.configuration().utils;
 90         Messages messages = writer.configuration().getMessages();
 91         VariableElement field = getVariableElement(holder, writer.configuration(), tag);
 92         if (field == null) {
 93             if (tag.toString().isEmpty()) {
 94                 //Invalid use of @value
 95                 messages.warning(holder,
 96                         &quot;doclet.value_tag_invalid_use&quot;);
 97             } else {
 98                 //Reference is unknown.
 99                 messages.warning(holder,
100                         &quot;doclet.value_tag_invalid_reference&quot;, tag.toString());
</pre>
</td>
</tr>
</table>
<center><a href="UserTaglet.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="package-info.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>