<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/util/JavaScriptScanner.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (c) 2016, 2017, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 package jdk.javadoc.internal.doclets.toolkit.util;
 26 
 27 
 28 import java.util.List;
 29 import java.util.Locale;
 30 import java.util.function.Consumer;
 31 
 32 import com.sun.source.doctree.AttributeTree;
 33 import com.sun.source.doctree.DocCommentTree;
 34 import com.sun.source.doctree.DocTree;
 35 import com.sun.source.doctree.DocTree.Kind;
 36 import com.sun.source.doctree.StartElementTree;
 37 import com.sun.source.util.DocTreePath;
 38 import com.sun.source.util.DocTreePathScanner;
 39 import com.sun.source.util.TreePath;
 40 import com.sun.tools.javac.util.DefinedBy;
 41 import com.sun.tools.javac.util.DefinedBy.Api;
 42 
 43 /**
 44  * A DocTree scanner to detect use of JavaScript in a doc comment tree.
 45  */
 46 public class JavaScriptScanner extends DocTreePathScanner&lt;Void, Consumer&lt;DocTreePath&gt;&gt; {
 47 
 48     public Void scan(DocCommentTree tree, TreePath p, Consumer&lt;DocTreePath&gt; f) {
 49         return scan(new DocTreePath(p, tree), f);
 50     }
 51 
 52     @Override @DefinedBy(Api.COMPILER_TREE)
 53     public Void visitStartElement(StartElementTree tree, Consumer&lt;DocTreePath&gt; f) {
 54         String name = tree.getName().toString();
 55         if (name.equalsIgnoreCase(&quot;script&quot;))
 56             f.accept(getCurrentPath());
 57         return super.visitStartElement(tree, f);
 58     }
 59 
 60     @Override @DefinedBy(Api.COMPILER_TREE)
 61     public Void visitAttribute(AttributeTree tree, Consumer&lt;DocTreePath&gt; f) {
 62         String name = tree.getName().toString().toLowerCase(Locale.ENGLISH);
 63         switch (name) {
<a name="1" id="anc1"></a><span class="line-removed"> 64             // See https://www.w3.org/TR/html-markup/global-attributes.html#common.attrs.event-handler</span>
<span class="line-removed"> 65             case &quot;onabort&quot;:  case &quot;onblur&quot;:  case &quot;oncanplay&quot;:  case &quot;oncanplaythrough&quot;:</span>
<span class="line-removed"> 66             case &quot;onchange&quot;:  case &quot;onclick&quot;:  case &quot;oncontextmenu&quot;:  case &quot;ondblclick&quot;:</span>
<span class="line-removed"> 67             case &quot;ondrag&quot;:  case &quot;ondragend&quot;:  case &quot;ondragenter&quot;:  case &quot;ondragleave&quot;:</span>
<span class="line-removed"> 68             case &quot;ondragover&quot;:  case &quot;ondragstart&quot;:  case &quot;ondrop&quot;:  case &quot;ondurationchange&quot;:</span>
<span class="line-removed"> 69             case &quot;onemptied&quot;:  case &quot;onended&quot;:  case &quot;onerror&quot;:  case &quot;onfocus&quot;:  case &quot;oninput&quot;:</span>
<span class="line-removed"> 70             case &quot;oninvalid&quot;:  case &quot;onkeydown&quot;:  case &quot;onkeypress&quot;:  case &quot;onkeyup&quot;:</span>
<span class="line-removed"> 71             case &quot;onload&quot;:  case &quot;onloadeddata&quot;:  case &quot;onloadedmetadata&quot;:  case &quot;onloadstart&quot;:</span>
<span class="line-removed"> 72             case &quot;onmousedown&quot;:  case &quot;onmousemove&quot;:  case &quot;onmouseout&quot;:  case &quot;onmouseover&quot;:</span>
<span class="line-removed"> 73             case &quot;onmouseup&quot;:  case &quot;onmousewheel&quot;:  case &quot;onpause&quot;:  case &quot;onplay&quot;:</span>
<span class="line-removed"> 74             case &quot;onplaying&quot;:  case &quot;onprogress&quot;:  case &quot;onratechange&quot;:  case &quot;onreadystatechange&quot;:</span>
<span class="line-removed"> 75             case &quot;onreset&quot;:  case &quot;onscroll&quot;:  case &quot;onseeked&quot;:  case &quot;onseeking&quot;:</span>
<span class="line-removed"> 76             case &quot;onselect&quot;:  case &quot;onshow&quot;:  case &quot;onstalled&quot;:  case &quot;onsubmit&quot;:  case &quot;onsuspend&quot;:</span>
<span class="line-removed"> 77             case &quot;ontimeupdate&quot;:  case &quot;onvolumechange&quot;:  case &quot;onwaiting&quot;:</span>
<span class="line-removed"> 78 </span>
<span class="line-removed"> 79             // See https://www.w3.org/TR/html4/sgml/dtd.html</span>
<span class="line-removed"> 80             // Most of the attributes that take a %Script are also defined as event handlers</span>
<span class="line-removed"> 81             // in HTML 5. The one exception is onunload.</span>
<span class="line-removed"> 82             // case &quot;onchange&quot;:  case &quot;onclick&quot;:   case &quot;ondblclick&quot;:  case &quot;onfocus&quot;:</span>
<span class="line-removed"> 83             // case &quot;onkeydown&quot;:  case &quot;onkeypress&quot;:  case &quot;onkeyup&quot;:  case &quot;onload&quot;:</span>
<span class="line-removed"> 84             // case &quot;onmousedown&quot;:  case &quot;onmousemove&quot;:  case &quot;onmouseout&quot;:  case &quot;onmouseover&quot;:</span>
<span class="line-removed"> 85             // case &quot;onmouseup&quot;:  case &quot;onreset&quot;:  case &quot;onselect&quot;:  case &quot;onsubmit&quot;:</span>
<span class="line-removed"> 86             case &quot;onunload&quot;:</span>
<span class="line-removed"> 87                 f.accept(getCurrentPath());</span>
<span class="line-removed"> 88                 break;</span>
<span class="line-removed"> 89 </span>
 90             // See https://www.w3.org/TR/html4/sgml/dtd.html
<a name="2" id="anc2"></a><span class="line-modified"> 91             //     https://www.w3.org/TR/html5/</span>
 92             // These are all the attributes that take a %URI or a valid URL potentially surrounded
 93             // by spaces
 94             case &quot;action&quot;:  case &quot;cite&quot;:  case &quot;classid&quot;:  case &quot;codebase&quot;:  case &quot;data&quot;:
 95             case &quot;datasrc&quot;:  case &quot;for&quot;:  case &quot;href&quot;:  case &quot;longdesc&quot;:  case &quot;profile&quot;:
 96             case &quot;src&quot;:  case &quot;usemap&quot;:
 97                 List&lt;? extends DocTree&gt; value = tree.getValue();
 98                 if (value != null &amp;&amp; !value.isEmpty() &amp;&amp; value.get(0).getKind() == Kind.TEXT) {
 99                     String v = value.get(0).toString().trim().toLowerCase(Locale.ENGLISH);
100                     if (v.startsWith(&quot;javascript:&quot;)) {
101                         f.accept(getCurrentPath());
102                     }
103                 }
104                 break;
<a name="3" id="anc3"></a>







105         }
106         return super.visitAttribute(tree, f);
107     }
108 
109     /**
110      * Used to indicate a fault when parsing, typically used in
111      * lambda methods.
112      */
113     public static class Fault extends RuntimeException {
114         private static final long serialVersionUID = 0L;
115     }
116 }
<a name="4" id="anc4"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="4" type="hidden" />
</body>
</html>