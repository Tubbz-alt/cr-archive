<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/AnnotationTypeWriterImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="AnnotationTypeRequiredMemberWriterImpl.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="ClassUseWriter.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/AnnotationTypeWriterImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 30,20 ***</span>
<span class="line-new-header">--- 30,23 ---</span>
  import javax.lang.model.element.ModuleElement;
  import javax.lang.model.element.PackageElement;
  import javax.lang.model.element.TypeElement;
  
  import com.sun.source.doctree.DocTree;
<span class="line-added">+ import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;</span>
<span class="line-added">+ import jdk.javadoc.internal.doclets.formats.html.markup.Entity;</span>
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlStyle;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTag;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTree;
  import jdk.javadoc.internal.doclets.formats.html.markup.Navigation;
  import jdk.javadoc.internal.doclets.formats.html.markup.Navigation.PageMode;
  import jdk.javadoc.internal.doclets.formats.html.markup.StringContent;
  import jdk.javadoc.internal.doclets.toolkit.AnnotationTypeWriter;
  import jdk.javadoc.internal.doclets.toolkit.Content;
  import jdk.javadoc.internal.doclets.toolkit.util.CommentHelper;
  import jdk.javadoc.internal.doclets.toolkit.util.DocFileIOException;
<span class="line-added">+ import jdk.javadoc.internal.doclets.toolkit.util.DocPath;</span>
  
  /**
   * Generate the Class Information Page.
   *
   *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 53,14 ***</span>
   *
   * @see java.util.Collections
   * @see java.util.List
   * @see java.util.ArrayList
   * @see java.util.HashMap
<span class="line-removed">-  *</span>
<span class="line-removed">-  * @author Atul M Dambalkar</span>
<span class="line-removed">-  * @author Robert Field</span>
<span class="line-removed">-  * @author Bhavesh Patel (Modified)</span>
   */
  public class AnnotationTypeWriterImpl extends SubWriterHolderWriter
          implements AnnotationTypeWriter {
  
      protected TypeElement annotationType;
<span class="line-new-header">--- 56,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 74,111 ***</span>
      public AnnotationTypeWriterImpl(HtmlConfiguration configuration,
              TypeElement annotationType) {
          super(configuration, configuration.docPaths.forClass(annotationType));
          this.annotationType = annotationType;
          configuration.currentTypeElement = annotationType;
<span class="line-modified">!         this.navBar = new Navigation(annotationType, configuration, fixedNavDiv, PageMode.CLASS, path);</span>
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public Content getHeader(String header) {
<span class="line-modified">!         HtmlTree bodyTree = getBody(true, getWindowTitle(utils.getSimpleName(annotationType)));</span>
<span class="line-modified">!         HtmlTree htmlTree = HtmlTree.HEADER();</span>
<span class="line-removed">-         addTop(htmlTree);</span>
          Content linkContent = getModuleLink(utils.elementUtils.getModuleOf(annotationType),
                  contents.moduleLabel);
          navBar.setNavLinkModule(linkContent);
          navBar.setMemberSummaryBuilder(configuration.getBuilderFactory().getMemberSummaryBuilder(this));
          navBar.setUserHeader(getUserHeaderFooter(true));
<span class="line-modified">!         htmlTree.add(navBar.getContent(true));</span>
<span class="line-modified">!         bodyTree.add(htmlTree);</span>
<span class="line-removed">-         bodyTree.add(MarkerComments.START_OF_CLASS_DATA);</span>
          HtmlTree div = new HtmlTree(HtmlTag.DIV);
          div.setStyle(HtmlStyle.header);
          if (configuration.showModules) {
              ModuleElement mdle = configuration.docEnv.getElementUtils().getModuleOf(annotationType);
              Content typeModuleLabel = HtmlTree.SPAN(HtmlStyle.moduleLabelInType, contents.moduleLabel);
              Content moduleNameDiv = HtmlTree.DIV(HtmlStyle.subTitle, typeModuleLabel);
<span class="line-modified">!             moduleNameDiv.add(Contents.SPACE);</span>
              moduleNameDiv.add(getModuleLink(mdle, new StringContent(mdle.getQualifiedName())));
              div.add(moduleNameDiv);
          }
          PackageElement pkg = utils.containingPackage(annotationType);
          if (!pkg.isUnnamed()) {
              Content typePackageLabel = HtmlTree.SPAN(HtmlStyle.packageLabelInType, contents.packageLabel);
              Content pkgNameDiv = HtmlTree.DIV(HtmlStyle.subTitle, typePackageLabel);
<span class="line-modified">!             pkgNameDiv.add(Contents.SPACE);</span>
              Content pkgNameContent = getPackageLink(pkg, new StringContent(utils.getPackageName(pkg)));
              pkgNameDiv.add(pkgNameContent);
              div.add(pkgNameDiv);
          }
          LinkInfoImpl linkInfo = new LinkInfoImpl(configuration,
                  LinkInfoImpl.Kind.CLASS_HEADER, annotationType);
<span class="line-removed">-         Content headerContent = new StringContent(header);</span>
          Content heading = HtmlTree.HEADING(Headings.PAGE_TITLE_HEADING, true,
<span class="line-modified">!                 HtmlStyle.title, headerContent);</span>
          heading.add(getTypeParameterLinks(linkInfo));
          div.add(heading);
<span class="line-modified">!         mainTree.add(div);</span>
<span class="line-modified">!         return bodyTree;</span>
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public Content getAnnotationContentHeader() {
          return getContentHeader();
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
<span class="line-modified">!     public void addFooter(Content contentTree) {</span>
<span class="line-removed">-         contentTree.add(MarkerComments.END_OF_CLASS_DATA);</span>
          Content htmlTree = HtmlTree.FOOTER();
          navBar.setUserFooter(getUserHeaderFooter(false));
          htmlTree.add(navBar.getContent(false));
          addBottom(htmlTree);
<span class="line-modified">!         contentTree.add(htmlTree);</span>
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public void printDocument(Content contentTree) throws DocFileIOException {
          String description = getDescription(&quot;declaration&quot;, annotationType);
          PackageElement pkg = utils.containingPackage(this.annotationType);
<span class="line-modified">!         Content stylesheetContent = getLocalStylesheetContent(pkg);</span>
          printHtmlDocument(configuration.metakeywords.getMetaKeywords(annotationType),
<span class="line-modified">!                 description, stylesheetContent, contentTree);</span>
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public Content getAnnotationInfoTreeHeader() {
          return getMemberTreeHeader();
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public Content getAnnotationInfo(Content annotationInfoTree) {
<span class="line-modified">!         return getMemberTree(HtmlStyle.description, annotationInfoTree);</span>
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public void addAnnotationTypeSignature(String modifiers, Content annotationInfoTree) {
          Content hr = new HtmlTree(HtmlTag.HR);
          annotationInfoTree.add(hr);
          Content pre = new HtmlTree(HtmlTag.PRE);
<span class="line-new-header">--- 73,90 ---</span>
      public AnnotationTypeWriterImpl(HtmlConfiguration configuration,
              TypeElement annotationType) {
          super(configuration, configuration.docPaths.forClass(annotationType));
          this.annotationType = annotationType;
          configuration.currentTypeElement = annotationType;
<span class="line-modified">!         this.navBar = new Navigation(annotationType, configuration, PageMode.CLASS, path);</span>
      }
  
      @Override
      public Content getHeader(String header) {
<span class="line-modified">!         Content headerContent = new ContentBuilder();</span>
<span class="line-modified">!         addTop(headerContent);</span>
          Content linkContent = getModuleLink(utils.elementUtils.getModuleOf(annotationType),
                  contents.moduleLabel);
          navBar.setNavLinkModule(linkContent);
          navBar.setMemberSummaryBuilder(configuration.getBuilderFactory().getMemberSummaryBuilder(this));
          navBar.setUserHeader(getUserHeaderFooter(true));
<span class="line-modified">!         headerContent.add(navBar.getContent(true));</span>
<span class="line-modified">! </span>
          HtmlTree div = new HtmlTree(HtmlTag.DIV);
          div.setStyle(HtmlStyle.header);
          if (configuration.showModules) {
              ModuleElement mdle = configuration.docEnv.getElementUtils().getModuleOf(annotationType);
              Content typeModuleLabel = HtmlTree.SPAN(HtmlStyle.moduleLabelInType, contents.moduleLabel);
              Content moduleNameDiv = HtmlTree.DIV(HtmlStyle.subTitle, typeModuleLabel);
<span class="line-modified">!             moduleNameDiv.add(Entity.NO_BREAK_SPACE);</span>
              moduleNameDiv.add(getModuleLink(mdle, new StringContent(mdle.getQualifiedName())));
              div.add(moduleNameDiv);
          }
          PackageElement pkg = utils.containingPackage(annotationType);
          if (!pkg.isUnnamed()) {
              Content typePackageLabel = HtmlTree.SPAN(HtmlStyle.packageLabelInType, contents.packageLabel);
              Content pkgNameDiv = HtmlTree.DIV(HtmlStyle.subTitle, typePackageLabel);
<span class="line-modified">!             pkgNameDiv.add(Entity.NO_BREAK_SPACE);</span>
              Content pkgNameContent = getPackageLink(pkg, new StringContent(utils.getPackageName(pkg)));
              pkgNameDiv.add(pkgNameContent);
              div.add(pkgNameDiv);
          }
          LinkInfoImpl linkInfo = new LinkInfoImpl(configuration,
                  LinkInfoImpl.Kind.CLASS_HEADER, annotationType);
          Content heading = HtmlTree.HEADING(Headings.PAGE_TITLE_HEADING, true,
<span class="line-modified">!                 HtmlStyle.title, new StringContent(header));</span>
          heading.add(getTypeParameterLinks(linkInfo));
          div.add(heading);
<span class="line-modified">!         bodyContents.setHeader(headerContent)</span>
<span class="line-modified">!                 .addMainContent(MarkerComments.START_OF_CLASS_DATA)</span>
<span class="line-added">+                 .addMainContent(div);</span>
<span class="line-added">+         return getBody(getWindowTitle(utils.getSimpleName(annotationType)));</span>
      }
  
      @Override
      public Content getAnnotationContentHeader() {
          return getContentHeader();
      }
  
      @Override
<span class="line-modified">!     public void addFooter() {</span>
          Content htmlTree = HtmlTree.FOOTER();
          navBar.setUserFooter(getUserHeaderFooter(false));
          htmlTree.add(navBar.getContent(false));
          addBottom(htmlTree);
<span class="line-modified">!         bodyContents.addMainContent(MarkerComments.END_OF_CLASS_DATA)</span>
<span class="line-added">+                     .setFooter(htmlTree);</span>
      }
  
      @Override
      public void printDocument(Content contentTree) throws DocFileIOException {
          String description = getDescription(&quot;declaration&quot;, annotationType);
          PackageElement pkg = utils.containingPackage(this.annotationType);
<span class="line-modified">!         List&lt;DocPath&gt; localStylesheets = getLocalStylesheets(pkg);</span>
<span class="line-added">+         contentTree.add(bodyContents.toContent());</span>
          printHtmlDocument(configuration.metakeywords.getMetaKeywords(annotationType),
<span class="line-modified">!                 description, localStylesheets, contentTree);</span>
      }
  
      @Override
      public Content getAnnotationInfoTreeHeader() {
          return getMemberTreeHeader();
      }
  
      @Override
      public Content getAnnotationInfo(Content annotationInfoTree) {
<span class="line-modified">!         return HtmlTree.SECTION(HtmlStyle.description, annotationInfoTree);</span>
      }
  
      @Override
      public void addAnnotationTypeSignature(String modifiers, Content annotationInfoTree) {
          Content hr = new HtmlTree(HtmlTag.HR);
          annotationInfoTree.add(hr);
          Content pre = new HtmlTree(HtmlTag.PRE);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 186,67 ***</span>
          pre.add(modifiers);
          LinkInfoImpl linkInfo = new LinkInfoImpl(configuration,
                  LinkInfoImpl.Kind.CLASS_SIGNATURE, annotationType);
          Content annotationName = new StringContent(utils.getSimpleName(annotationType));
          Content parameterLinks = getTypeParameterLinks(linkInfo);
<span class="line-modified">!         if (configuration.linksource) {</span>
              addSrcLink(annotationType, annotationName, pre);
              pre.add(parameterLinks);
          } else {
              Content span = HtmlTree.SPAN(HtmlStyle.memberNameLabel, annotationName);
              span.add(parameterLinks);
              pre.add(span);
          }
          annotationInfoTree.add(pre);
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public void addAnnotationTypeDescription(Content annotationInfoTree) {
<span class="line-modified">!         if (!configuration.nocomment) {</span>
              if (!utils.getFullBody(annotationType).isEmpty()) {
                  addInlineComment(annotationType, annotationInfoTree);
              }
          }
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public void addAnnotationTypeTagInfo(Content annotationInfoTree) {
<span class="line-modified">!         if (!configuration.nocomment) {</span>
              addTagsInfo(annotationType, annotationInfoTree);
          }
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public void addAnnotationTypeDeprecationInfo(Content annotationInfoTree) {
          List&lt;? extends DocTree&gt; deprs = utils.getBlockTags(annotationType, DocTree.Kind.DEPRECATED);
          if (utils.isDeprecated(annotationType)) {
              CommentHelper ch = utils.getCommentHelper(annotationType);
              Content deprLabel = HtmlTree.SPAN(HtmlStyle.deprecatedLabel, getDeprecatedPhrase(annotationType));
              Content div = HtmlTree.DIV(HtmlStyle.deprecationBlock, deprLabel);
              if (!deprs.isEmpty()) {
  
<span class="line-modified">!                 List&lt;? extends DocTree&gt; commentTags = ch.getDescription(configuration, deprs.get(0));</span>
                  if (!commentTags.isEmpty()) {
                      addInlineDeprecatedComment(annotationType, deprs.get(0), div);
                  }
              }
              annotationInfoTree.add(div);
          }
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public TypeElement getAnnotationTypeElement() {
          return annotationType;
      }
  }
<span class="line-new-header">--- 164,61 ---</span>
          pre.add(modifiers);
          LinkInfoImpl linkInfo = new LinkInfoImpl(configuration,
                  LinkInfoImpl.Kind.CLASS_SIGNATURE, annotationType);
          Content annotationName = new StringContent(utils.getSimpleName(annotationType));
          Content parameterLinks = getTypeParameterLinks(linkInfo);
<span class="line-modified">!         if (options.linkSource()) {</span>
              addSrcLink(annotationType, annotationName, pre);
              pre.add(parameterLinks);
          } else {
              Content span = HtmlTree.SPAN(HtmlStyle.memberNameLabel, annotationName);
              span.add(parameterLinks);
              pre.add(span);
          }
          annotationInfoTree.add(pre);
      }
  
      @Override
      public void addAnnotationTypeDescription(Content annotationInfoTree) {
<span class="line-modified">!         if (!options.noComment()) {</span>
              if (!utils.getFullBody(annotationType).isEmpty()) {
                  addInlineComment(annotationType, annotationInfoTree);
              }
          }
      }
  
      @Override
      public void addAnnotationTypeTagInfo(Content annotationInfoTree) {
<span class="line-modified">!         if (!options.noComment()) {</span>
              addTagsInfo(annotationType, annotationInfoTree);
          }
      }
  
      @Override
      public void addAnnotationTypeDeprecationInfo(Content annotationInfoTree) {
          List&lt;? extends DocTree&gt; deprs = utils.getBlockTags(annotationType, DocTree.Kind.DEPRECATED);
          if (utils.isDeprecated(annotationType)) {
              CommentHelper ch = utils.getCommentHelper(annotationType);
              Content deprLabel = HtmlTree.SPAN(HtmlStyle.deprecatedLabel, getDeprecatedPhrase(annotationType));
              Content div = HtmlTree.DIV(HtmlStyle.deprecationBlock, deprLabel);
              if (!deprs.isEmpty()) {
  
<span class="line-modified">!                 List&lt;? extends DocTree&gt; commentTags = ch.getDescription(deprs.get(0));</span>
                  if (!commentTags.isEmpty()) {
                      addInlineDeprecatedComment(annotationType, deprs.get(0), div);
                  }
              }
              annotationInfoTree.add(div);
          }
      }
  
      @Override
      public TypeElement getAnnotationTypeElement() {
          return annotationType;
      }
<span class="line-added">+ </span>
<span class="line-added">+     @Override</span>
<span class="line-added">+     public Content getMemberDetailsTree(Content contentTree) {</span>
<span class="line-added">+         return HtmlTree.SECTION(HtmlStyle.details, contentTree)</span>
<span class="line-added">+                 .setId(SectionName.ANNOTATION_TYPE_ELEMENT_DETAIL.getName());</span>
<span class="line-added">+     }</span>
  }
</pre>
<center><a href="AnnotationTypeRequiredMemberWriterImpl.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="ClassUseWriter.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>