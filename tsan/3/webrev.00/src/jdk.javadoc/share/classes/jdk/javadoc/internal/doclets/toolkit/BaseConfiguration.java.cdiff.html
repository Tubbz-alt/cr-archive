<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/BaseConfiguration.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="AnnotationTypeWriter.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="ClassWriter.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/BaseConfiguration.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 1997, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 1997, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 30,11 ***</span>
  
  import javax.lang.model.element.Element;
  import javax.lang.model.element.ModuleElement;
  import javax.lang.model.element.PackageElement;
  import javax.lang.model.element.TypeElement;
<span class="line-modified">! import javax.lang.model.util.SimpleElementVisitor9;</span>
  import javax.tools.JavaFileManager;
  import javax.tools.JavaFileObject;
  
  import com.sun.source.util.DocTreePath;
  import com.sun.tools.javac.util.DefinedBy;
<span class="line-new-header">--- 30,11 ---</span>
  
  import javax.lang.model.element.Element;
  import javax.lang.model.element.ModuleElement;
  import javax.lang.model.element.PackageElement;
  import javax.lang.model.element.TypeElement;
<span class="line-modified">! import javax.lang.model.util.SimpleElementVisitor14;</span>
  import javax.tools.JavaFileManager;
  import javax.tools.JavaFileObject;
  
  import com.sun.source.util.DocTreePath;
  import com.sun.tools.javac.util.DefinedBy;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 48,36 ***</span>
  import jdk.javadoc.internal.doclets.toolkit.builders.BuilderFactory;
  import jdk.javadoc.internal.doclets.toolkit.taglets.TagletManager;
  import jdk.javadoc.internal.doclets.toolkit.util.DocFile;
  import jdk.javadoc.internal.doclets.toolkit.util.DocFileFactory;
  import jdk.javadoc.internal.doclets.toolkit.util.DocFileIOException;
<span class="line-removed">- import jdk.javadoc.internal.doclets.toolkit.util.DocletConstants;</span>
  import jdk.javadoc.internal.doclets.toolkit.util.Extern;
  import jdk.javadoc.internal.doclets.toolkit.util.Group;
  import jdk.javadoc.internal.doclets.toolkit.util.MetaKeywords;
  import jdk.javadoc.internal.doclets.toolkit.util.SimpleDocletException;
  import jdk.javadoc.internal.doclets.toolkit.util.TypeElementCatalog;
  import jdk.javadoc.internal.doclets.toolkit.util.Utils;
  import jdk.javadoc.internal.doclets.toolkit.util.Utils.Pair;
  import jdk.javadoc.internal.doclets.toolkit.util.VisibleMemberCache;
  import jdk.javadoc.internal.doclets.toolkit.util.VisibleMemberTable;
  
<span class="line-removed">- import static javax.tools.Diagnostic.Kind.*;</span>
<span class="line-removed">- </span>
  /**
   * Configure the output based on the options. Doclets should sub-class
   * BaseConfiguration, to configure and add their own options. This class contains
   * all user options which are supported by the standard doclet.
   * &lt;p&gt;
   * &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
   * If you write code that depends on this, you do so at your own risk.
   * This code and its internal interfaces are subject to change or
   * deletion without notice.&lt;/b&gt;
<span class="line-removed">-  *</span>
<span class="line-removed">-  * @author Robert Field.</span>
<span class="line-removed">-  * @author Atul Dambalkar.</span>
<span class="line-removed">-  * @author Jamie Ho</span>
   */
  public abstract class BaseConfiguration {
      /**
       * The doclet that created this configuration.
       */
<span class="line-new-header">--- 48,29 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 101,70 ***</span>
      /**
       * The default path to the builder XML.
       */
      public static final String DEFAULT_BUILDER_XML = &quot;resources/doclet.xml&quot;;
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * The path to Taglets</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public String tagletpath = null;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * This is true if option &quot;-serialwarn&quot; is used. Defualt value is false to</span>
<span class="line-removed">-      * suppress excessive warnings about serial tag.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean serialwarn = false;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * The specified amount of space between tab stops.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public int sourcetab;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     public String tabSpaces;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * True if we should generate browsable sources.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean linksource = false;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * True if command line option &quot;-nosince&quot; is used. Default value is</span>
<span class="line-removed">-      * false.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean nosince = false;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * True if we should recursively copy the doc-file subdirectories</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean copydocfilesubdirs = false;</span>
<span class="line-removed">- </span>
      /**
       * Maintain backward compatibility with previous javadoc version
       */
      public boolean backwardCompatibility = true;
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * True if user wants to add member names as meta keywords.</span>
<span class="line-removed">-      * Set to false because meta keywords are ignored in general</span>
<span class="line-removed">-      * by most Internet search engines.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean keywords = false;</span>
<span class="line-removed">- </span>
      /**
       * The meta tag keywords instance.
       */
<span class="line-modified">!     public final MetaKeywords metakeywords;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * The set of doc-file subdirectories to exclude</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     protected Set&lt;String&gt; excludedDocFileDirs;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * The set of qualifiers to exclude</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     protected Set&lt;String&gt; excludedQualifiers;</span>
  
      /**
       * The doclet environment.
       */
      public DocletEnvironment docEnv;
<span class="line-new-header">--- 94,19 ---</span>
      /**
       * The default path to the builder XML.
       */
      public static final String DEFAULT_BUILDER_XML = &quot;resources/doclet.xml&quot;;
  
      /**
       * Maintain backward compatibility with previous javadoc version
       */
      public boolean backwardCompatibility = true;
  
      /**
       * The meta tag keywords instance.
       */
<span class="line-modified">!     public MetaKeywords metakeywords;</span>
  
      /**
       * The doclet environment.
       */
      public DocletEnvironment docEnv;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 177,139 ***</span>
      /**
       * All the temporary accessors to javac internals.
       */
      public WorkArounds workArounds;
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Destination directory name, in which doclet will generate the entire</span>
<span class="line-removed">-      * documentation. Default is current directory.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public String destDirName = &quot;&quot;;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Destination directory name, in which doclet will copy the doc-files to.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public String docFileDestDirName = &quot;&quot;;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Encoding for this document. Default is default encoding for this</span>
<span class="line-removed">-      * platform.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public String docencoding = null;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * True if user wants to suppress descriptions and tags.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean nocomment = false;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Encoding for this document. Default is default encoding for this</span>
<span class="line-removed">-      * platform.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public String encoding = null;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Generate author specific information for all the classes if @author</span>
<span class="line-removed">-      * tag is used in the doc comment and if -author option is used.</span>
<span class="line-removed">-      * &lt;code&gt;showauthor&lt;/code&gt; is set to true if -author option is used.</span>
<span class="line-removed">-      * Default is don&#39;t show author information.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean showauthor = false;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Generate documentation for JavaFX getters and setters automatically</span>
<span class="line-removed">-      * by copying it from the appropriate property definition.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean javafx = false;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Generate version specific information for the all the classes</span>
<span class="line-removed">-      * if @version tag is used in the doc comment and if -version option is</span>
<span class="line-removed">-      * used. &lt;code&gt;showversion&lt;/code&gt; is set to true if -version option is</span>
<span class="line-removed">-      * used.Default is don&#39;t show version information.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean showversion = false;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Allow JavaScript in doc comments.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     private boolean allowScriptInComments = false;</span>
<span class="line-removed">- </span>
      /**
       * Sourcepath from where to read the source files. Default is classpath.
       */
      public String sourcepath = &quot;&quot;;
  
      /**
       * Generate modules documentation if more than one module is present.
       */
      public boolean showModules = false;
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Don&#39;t generate deprecated API information at all, if -nodeprecated</span>
<span class="line-removed">-      * option is used. &lt;code&gt;nodepracted&lt;/code&gt; is set to true if</span>
<span class="line-removed">-      * -nodeprecated option is used. Default is generate deprected API</span>
<span class="line-removed">-      * information.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean nodeprecated = false;</span>
<span class="line-removed">- </span>
      /**
       * The catalog of classes specified on the command-line
       */
      public TypeElementCatalog typeElementCatalog;
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * True if user wants to suppress time stamp in output.</span>
<span class="line-removed">-      * Default is false.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean notimestamp = false;</span>
<span class="line-removed">- </span>
      /**
       * The package grouping instance.
       */
      public final Group group = new Group(this);
  
      /**
       * The tracker of external package links.
       */
      public Extern extern;
  
<span class="line-modified">!     public Reporter reporter;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     public Locale locale;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Suppress all messages</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean quiet = false;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Specifies whether those methods that override a super-type&#39;s method</span>
<span class="line-removed">-      * with no changes to the API contract should be summarized in the</span>
<span class="line-removed">-      * footnote section.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean summarizeOverriddenMethods = false;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     // A list containing urls</span>
<span class="line-removed">-     private final List&lt;String&gt; linkList = new ArrayList&lt;&gt;();</span>
<span class="line-removed">- </span>
<span class="line-removed">-      // A list of pairs containing urls and package list</span>
<span class="line-removed">-     private final List&lt;Pair&lt;String, String&gt;&gt; linkOfflineList = new ArrayList&lt;&gt;();</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Flag to enable/disable use of module directories when generating docs for modules</span>
<span class="line-removed">-      * Default: on (module directories are enabled).</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean useModuleDirectories = true;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     public boolean dumpOnError = false;</span>
  
<span class="line-modified">!     private List&lt;Pair&lt;String, String&gt;&gt; groupPairs;</span>
  
      public abstract Messages getMessages();
  
<span class="line-modified">!     public abstract Resources getResources();</span>
  
      /**
       * Returns a string identifying the version of the doclet.
       *
       * @return a version string
<span class="line-new-header">--- 119,42 ---</span>
      /**
       * All the temporary accessors to javac internals.
       */
      public WorkArounds workArounds;
  
      /**
       * Sourcepath from where to read the source files. Default is classpath.
       */
      public String sourcepath = &quot;&quot;;
  
      /**
       * Generate modules documentation if more than one module is present.
       */
      public boolean showModules = false;
  
      /**
       * The catalog of classes specified on the command-line
       */
      public TypeElementCatalog typeElementCatalog;
  
      /**
       * The package grouping instance.
       */
      public final Group group = new Group(this);
  
      /**
       * The tracker of external package links.
       */
      public Extern extern;
  
<span class="line-modified">!     public final Reporter reporter;</span>
  
<span class="line-modified">!     public final Locale locale;</span>
  
      public abstract Messages getMessages();
  
<span class="line-modified">!     public abstract Resources getDocResources();</span>
  
      /**
       * Returns a string identifying the version of the doclet.
       *
       * @return a version string
</pre>
<hr />
<pre>
<span class="line-old-header">*** 348,48 ***</span>
      public SortedSet&lt;ModuleElement&gt; modules;
  
      protected static final String sharedResourceBundleName =
              &quot;jdk.javadoc.internal.doclets.toolkit.resources.doclets&quot;;
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Primarily used to disable strict checks in the regression</span>
<span class="line-removed">-      * tests allowing those tests to be executed successfully, for</span>
<span class="line-removed">-      * instance, with OpenJDK builds which may not contain FX libraries.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean disableJavaFxStrictChecks = false;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Show taglets (internal debug switch)</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean showTaglets = false;</span>
<span class="line-removed">- </span>
      VisibleMemberCache visibleMemberCache = null;
  
      public PropertyUtils propertyUtils = null;
  
      /**
<span class="line-modified">!      * Constructs the configurations needed by the doclet.</span>
       *
<span class="line-modified">!      * @apiNote</span>
<span class="line-modified">!      * The {@code doclet} parameter is used when {@link Taglet#init(DocletEnvironment, Doclet)</span>
<span class="line-modified">!      * initializing tags}.</span>
<span class="line-removed">-      * Some doclets (such as the {@link StandardDoclet), may delegate to another</span>
       * (such as the {@link HtmlDoclet}).  In such cases, the primary doclet (i.e
       * {@code StandardDoclet}) should be provided here, and not any internal
       * class like {@code HtmlDoclet}.
       *
<span class="line-modified">!      * @param doclet the doclet for this run of javadoc</span>
       */
<span class="line-modified">!     public BaseConfiguration(Doclet doclet) {</span>
          this.doclet = doclet;
<span class="line-modified">!         excludedDocFileDirs = new HashSet&lt;&gt;();</span>
<span class="line-modified">!         excludedQualifiers = new HashSet&lt;&gt;();</span>
<span class="line-removed">-         setTabWidth(DocletConstants.DEFAULT_TAB_STOP_LENGTH);</span>
<span class="line-removed">-         metakeywords = new MetaKeywords(this);</span>
<span class="line-removed">-         groupPairs = new ArrayList&lt;&gt;(0);</span>
      }
  
      private boolean initialized = false;
  
      protected void initConfiguration(DocletEnvironment docEnv) {
          if (initialized) {
              throw new IllegalStateException(&quot;configuration previously initialized&quot;);
<span class="line-new-header">--- 193,36 ---</span>
      public SortedSet&lt;ModuleElement&gt; modules;
  
      protected static final String sharedResourceBundleName =
              &quot;jdk.javadoc.internal.doclets.toolkit.resources.doclets&quot;;
  
      VisibleMemberCache visibleMemberCache = null;
  
      public PropertyUtils propertyUtils = null;
  
      /**
<span class="line-modified">!      * Constructs the format-independent configuration needed by the doclet.</span>
       *
<span class="line-modified">!      * @apiNote The {@code doclet} parameter is used when</span>
<span class="line-modified">!      * {@link Taglet#init(DocletEnvironment, Doclet) initializing tags}.</span>
<span class="line-modified">!      * Some doclets (such as the {@link StandardDoclet}), may delegate to another</span>
       * (such as the {@link HtmlDoclet}).  In such cases, the primary doclet (i.e
       * {@code StandardDoclet}) should be provided here, and not any internal
       * class like {@code HtmlDoclet}.
       *
<span class="line-modified">!      * @param doclet   the doclet for this run of javadoc</span>
<span class="line-added">+      * @param locale   the locale for the generated documentation</span>
<span class="line-added">+      * @param reporter the reporter to use for console messages</span>
       */
<span class="line-modified">!     public BaseConfiguration(Doclet doclet, Locale locale, Reporter reporter) {</span>
          this.doclet = doclet;
<span class="line-modified">!         this.locale = locale;</span>
<span class="line-modified">!         this.reporter = reporter;</span>
      }
  
<span class="line-added">+     public abstract BaseOptions getOptions();</span>
<span class="line-added">+ </span>
      private boolean initialized = false;
  
      protected void initConfiguration(DocletEnvironment docEnv) {
          if (initialized) {
              throw new IllegalStateException(&quot;configuration previously initialized&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 397,15 ***</span>
          initialized = true;
          this.docEnv = docEnv;
          // Utils needs docEnv, safe to init now.
          utils = new Utils(this);
  
<span class="line-modified">!         if (!javafx) {</span>
<span class="line-modified">!             javafx = isJavaFXMode();</span>
          }
  
          // Once docEnv and Utils have been initialized, others should be safe.
          cmtUtils = new CommentUtils(this);
          workArounds = new WorkArounds(this);
          visibleMemberCache = new VisibleMemberCache(this);
          propertyUtils = new PropertyUtils(this);
  
<span class="line-new-header">--- 230,17 ---</span>
          initialized = true;
          this.docEnv = docEnv;
          // Utils needs docEnv, safe to init now.
          utils = new Utils(this);
  
<span class="line-modified">!         BaseOptions options = getOptions();</span>
<span class="line-modified">!         if (!options.javafx()) {</span>
<span class="line-added">+             options.setJavaFX(isJavaFXMode());</span>
          }
  
          // Once docEnv and Utils have been initialized, others should be safe.
<span class="line-added">+         metakeywords = new MetaKeywords(this);</span>
          cmtUtils = new CommentUtils(this);
          workArounds = new WorkArounds(this);
          visibleMemberCache = new VisibleMemberCache(this);
          propertyUtils = new PropertyUtils(this);
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 495,13 ***</span>
                  s.add(p);
              }
          }
  
          // add entries for modules which may not have exported packages
<span class="line-modified">!         modules.forEach((ModuleElement mdle) -&gt; {</span>
<span class="line-removed">-             modulePackages.computeIfAbsent(mdle, m -&gt; Collections.emptySet());</span>
<span class="line-removed">-         });</span>
  
          modules.addAll(modulePackages.keySet());
          showModules = !modules.isEmpty();
          for (Set&lt;PackageElement&gt; pkgs : modulePackages.values()) {
              packages.addAll(pkgs);
<span class="line-new-header">--- 330,11 ---</span>
                  s.add(p);
              }
          }
  
          // add entries for modules which may not have exported packages
<span class="line-modified">!         modules.forEach(mdle -&gt; modulePackages.computeIfAbsent(mdle, m -&gt; Collections.emptySet()));</span>
  
          modules.addAll(modulePackages.keySet());
          showModules = !modules.isEmpty();
          for (Set&lt;PackageElement&gt; pkgs : modulePackages.values()) {
              packages.addAll(pkgs);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 512,276 ***</span>
          packages = new TreeSet&lt;&gt;(utils.makePackageComparator());
          // add all the included packages
          packages.addAll(includedPackageElements);
      }
  
<span class="line-removed">-     public Set&lt;Doclet.Option&gt; getSupportedOptions() {</span>
<span class="line-removed">-         Resources resources = getResources();</span>
<span class="line-removed">-         Doclet.Option[] options = {</span>
<span class="line-removed">-                 new Option(resources, &quot;-author&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         showauthor = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-d&quot;, 1) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         destDirName = addTrailingFileSep(args.get(0));</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-docencoding&quot;, 1) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         docencoding = args.get(0);</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-docfilessubdirs&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         copydocfilesubdirs = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Hidden(resources, &quot;-encoding&quot;, 1) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         encoding = args.get(0);</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-excludedocfilessubdir&quot;, 1) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         addToSet(excludedDocFileDirs, args.get(0));</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-group&quot;, 2) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         groupPairs.add(new Pair&lt;&gt;(args.get(0), args.get(1)));</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;--javafx -javafx&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         javafx = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-keywords&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         keywords = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-link&quot;, 1) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         linkList.add(args.get(0));</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-linksource&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         linksource = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-linkoffline&quot;, 2) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         linkOfflineList.add(new Pair&lt;&gt;(args.get(0), args.get(1)));</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-nocomment&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         nocomment = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-nodeprecated&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         nodeprecated = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-nosince&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         nosince = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-notimestamp&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         notimestamp = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-noqualifier&quot;, 1) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         addToSet(excludedQualifiers, args.get(0));</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;--override-methods&quot;, 1) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt,  List&lt;String&gt; args) {</span>
<span class="line-removed">-                         String o = args.get(0);</span>
<span class="line-removed">-                         switch (o) {</span>
<span class="line-removed">-                             case &quot;summary&quot;:</span>
<span class="line-removed">-                                 summarizeOverriddenMethods = true;</span>
<span class="line-removed">-                                 break;</span>
<span class="line-removed">-                             case &quot;detail&quot;:</span>
<span class="line-removed">-                                 summarizeOverriddenMethods = false;</span>
<span class="line-removed">-                                 break;</span>
<span class="line-removed">-                             default:</span>
<span class="line-removed">-                                 reporter.print(ERROR,</span>
<span class="line-removed">-                                         getResources().getText(&quot;doclet.Option_invalid&quot;,o, &quot;--override-methods&quot;));</span>
<span class="line-removed">-                                 return false;</span>
<span class="line-removed">-                         }</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Hidden(resources, &quot;-quiet&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         quiet = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-serialwarn&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         serialwarn = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-sourcetab&quot;, 1) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         linksource = true;</span>
<span class="line-removed">-                         try {</span>
<span class="line-removed">-                             setTabWidth(Integer.parseInt(args.get(0)));</span>
<span class="line-removed">-                         } catch (NumberFormatException e) {</span>
<span class="line-removed">-                             //Set to -1 so that warning will be printed</span>
<span class="line-removed">-                             //to indicate what is valid argument.</span>
<span class="line-removed">-                             sourcetab = -1;</span>
<span class="line-removed">-                         }</span>
<span class="line-removed">-                         if (sourcetab &lt;= 0) {</span>
<span class="line-removed">-                             getMessages().warning(&quot;doclet.sourcetab_warning&quot;);</span>
<span class="line-removed">-                             setTabWidth(DocletConstants.DEFAULT_TAB_STOP_LENGTH);</span>
<span class="line-removed">-                         }</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-tag&quot;, 1) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         ArrayList&lt;String&gt; list = new ArrayList&lt;&gt;();</span>
<span class="line-removed">-                         list.add(opt);</span>
<span class="line-removed">-                         list.add(args.get(0));</span>
<span class="line-removed">-                         customTagStrs.add(list);</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-taglet&quot;, 1) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         ArrayList&lt;String&gt; list = new ArrayList&lt;&gt;();</span>
<span class="line-removed">-                         list.add(opt);</span>
<span class="line-removed">-                         list.add(args.get(0));</span>
<span class="line-removed">-                         customTagStrs.add(list);</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-tagletpath&quot;, 1) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         tagletpath = args.get(0);</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;-version&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         showversion = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Hidden(resources, &quot;--dump-on-error&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         dumpOnError = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Option(resources, &quot;--allow-script-in-comments&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         allowScriptInComments = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Hidden(resources, &quot;--disable-javafx-strict-checks&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         disableJavaFxStrictChecks = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new Hidden(resources, &quot;--show-taglets&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String opt, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         showTaglets = true;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 },</span>
<span class="line-removed">-                 new XOption(resources, &quot;--no-module-directories&quot;) {</span>
<span class="line-removed">-                     @Override</span>
<span class="line-removed">-                     public boolean process(String option, List&lt;String&gt; args) {</span>
<span class="line-removed">-                         useModuleDirectories = false;</span>
<span class="line-removed">-                         return true;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                 }</span>
<span class="line-removed">-         };</span>
<span class="line-removed">-         Set&lt;Doclet.Option&gt; set = new TreeSet&lt;&gt;();</span>
<span class="line-removed">-         set.addAll(Arrays.asList(options));</span>
<span class="line-removed">-         return set;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     final LinkedHashSet&lt;List&lt;String&gt;&gt; customTagStrs = new LinkedHashSet&lt;&gt;();</span>
<span class="line-removed">- </span>
      /*
       * when this is called all the option have been set, this method,
       * initializes certain components before anything else is started.
       */
      protected boolean finishOptionSettings0() throws DocletException {
          extern = new Extern(this);
          initDestDirectory();
<span class="line-modified">!         for (String link : linkList) {</span>
              extern.link(link, reporter);
          }
<span class="line-modified">!         for (Pair&lt;String, String&gt; linkOfflinePair : linkOfflineList) {</span>
              extern.link(linkOfflinePair.first, linkOfflinePair.second, reporter);
          }
          typeElementCatalog = new TypeElementCatalog(includedTypeElements, this);
<span class="line-modified">!         initTagletManager(customTagStrs);</span>
<span class="line-modified">!         groupPairs.stream().forEach((grp) -&gt; {</span>
              if (showModules) {
                  group.checkModuleGroups(grp.first, grp.second);
              } else {
                  group.checkPackageGroups(grp.first, grp.second);
              }
<span class="line-new-header">--- 345,27 ---</span>
          packages = new TreeSet&lt;&gt;(utils.makePackageComparator());
          // add all the included packages
          packages.addAll(includedPackageElements);
      }
  
      /*
       * when this is called all the option have been set, this method,
       * initializes certain components before anything else is started.
       */
      protected boolean finishOptionSettings0() throws DocletException {
<span class="line-added">+         BaseOptions options = getOptions();</span>
          extern = new Extern(this);
          initDestDirectory();
<span class="line-modified">!         for (String link : options.linkList()) {</span>
              extern.link(link, reporter);
          }
<span class="line-modified">!         for (Pair&lt;String, String&gt; linkOfflinePair : options.linkOfflineList()) {</span>
              extern.link(linkOfflinePair.first, linkOfflinePair.second, reporter);
          }
          typeElementCatalog = new TypeElementCatalog(includedTypeElements, this);
<span class="line-modified">!         initTagletManager(options.customTagStrs());</span>
<span class="line-modified">!         options.groupPairs().forEach(grp -&gt; {</span>
              if (showModules) {
                  group.checkModuleGroups(grp.first, grp.second);
              } else {
                  group.checkPackageGroups(grp.first, grp.second);
              }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 789,11 ***</span>
          overviewElement = new OverviewElement(workArounds.getUnnamedPackage(), getOverviewPath());
          return true;
      }
  
      /**
<span class="line-modified">!      * Set the command line options supported by this configuration.</span>
       *
       * @return true if the options are set successfully
       * @throws DocletException if there is a problem while setting the options
       */
      public boolean setOptions() throws DocletException {
<span class="line-new-header">--- 373,11 ---</span>
          overviewElement = new OverviewElement(workArounds.getUnnamedPackage(), getOverviewPath());
          return true;
      }
  
      /**
<span class="line-modified">!      * Set the command-line options supported by this configuration.</span>
       *
       * @return true if the options are set successfully
       * @throws DocletException if there is a problem while setting the options
       */
      public boolean setOptions() throws DocletException {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 804,23 ***</span>
  
          return true;
      }
  
      private void initDestDirectory() throws DocletException {
          if (!destDirName.isEmpty()) {
<span class="line-modified">!             Resources resources = getResources();</span>
              DocFile destDir = DocFile.createFileForDirectory(this, destDirName);
              if (!destDir.exists()) {
                  //Create the output directory (in case it doesn&#39;t exist yet)
<span class="line-modified">!                 reporter.print(NOTE, resources.getText(&quot;doclet.dest_dir_create&quot;, destDirName));</span>
                  destDir.mkdirs();
              } else if (!destDir.isDirectory()) {
<span class="line-modified">!                 throw new SimpleDocletException(resources.getText(</span>
                          &quot;doclet.destination_directory_not_directory_0&quot;,
                          destDir.getPath()));
              } else if (!destDir.canWrite()) {
<span class="line-modified">!                 throw new SimpleDocletException(resources.getText(</span>
                          &quot;doclet.destination_directory_not_writable_0&quot;,
                          destDir.getPath()));
              }
          }
          DocFileFactory.getFactory(this).setDestDir(destDirName);
<span class="line-new-header">--- 388,24 ---</span>
  
          return true;
      }
  
      private void initDestDirectory() throws DocletException {
<span class="line-added">+         String destDirName = getOptions().destDirName();</span>
          if (!destDirName.isEmpty()) {
<span class="line-modified">!             Messages messages = getMessages();</span>
              DocFile destDir = DocFile.createFileForDirectory(this, destDirName);
              if (!destDir.exists()) {
                  //Create the output directory (in case it doesn&#39;t exist yet)
<span class="line-modified">!                 messages.notice(&quot;doclet.dest_dir_create&quot;, destDirName);</span>
                  destDir.mkdirs();
              } else if (!destDir.isDirectory()) {
<span class="line-modified">!                 throw new SimpleDocletException(messages.getResources().getText(</span>
                          &quot;doclet.destination_directory_not_directory_0&quot;,
                          destDir.getPath()));
              } else if (!destDir.canWrite()) {
<span class="line-modified">!                 throw new SimpleDocletException(messages.getResources().getText(</span>
                          &quot;doclet.destination_directory_not_writable_0&quot;,
                          destDir.getPath()));
              }
          }
          DocFileFactory.getFactory(this).setDestDir(destDirName);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 832,46 ***</span>
       *
       * @param customTagStrs the set two dimensional arrays of strings.  These arrays contain
       *                      either -tag or -taglet arguments.
       */
      private void initTagletManager(Set&lt;List&lt;String&gt;&gt; customTagStrs) {
<span class="line-modified">!         tagletManager = tagletManager == null ?</span>
<span class="line-modified">!                 new TagletManager(nosince, showversion, showauthor, javafx, this) :</span>
<span class="line-modified">!                 tagletManager;</span>
<span class="line-modified">!         for (List&lt;String&gt; args : customTagStrs) {</span>
<span class="line-modified">!             if (args.get(0).equals(&quot;-taglet&quot;)) {</span>
<span class="line-modified">!                 tagletManager.addCustomTag(args.get(1), getFileManager(), tagletpath);</span>
<span class="line-modified">!                 continue;</span>
<span class="line-modified">!             }</span>
<span class="line-modified">!             List&lt;String&gt; tokens = tokenize(args.get(1), TagletManager.SIMPLE_TAGLET_OPT_SEPARATOR, 3);</span>
<span class="line-modified">!             switch (tokens.size()) {</span>
<span class="line-modified">!                 case 1:</span>
<span class="line-modified">!                     String tagName = args.get(1);</span>
<span class="line-modified">!                     if (tagletManager.isKnownCustomTag(tagName)) {</span>
<span class="line-modified">!                         //reorder a standard tag</span>
<span class="line-modified">!                         tagletManager.addNewSimpleCustomTag(tagName, null, &quot;&quot;);</span>
<span class="line-modified">!                     } else {</span>
<span class="line-modified">!                         //Create a simple tag with the heading that has the same name as the tag.</span>
<span class="line-modified">!                         StringBuilder heading = new StringBuilder(tagName + &quot;:&quot;);</span>
<span class="line-modified">!                         heading.setCharAt(0, Character.toUpperCase(tagName.charAt(0)));</span>
<span class="line-modified">!                         tagletManager.addNewSimpleCustomTag(tagName, heading.toString(), &quot;a&quot;);</span>
<span class="line-modified">!                     }</span>
<span class="line-modified">!                     break;</span>
  
<span class="line-modified">!                 case 2:</span>
<span class="line-modified">!                     //Add simple taglet without heading, probably to excluding it in the output.</span>
<span class="line-modified">!                     tagletManager.addNewSimpleCustomTag(tokens.get(0), tokens.get(1), &quot;&quot;);</span>
<span class="line-modified">!                     break;</span>
  
<span class="line-modified">!                 case 3:</span>
<span class="line-modified">!                     tagletManager.addNewSimpleCustomTag(tokens.get(0), tokens.get(2), tokens.get(1));</span>
<span class="line-modified">!                     break;</span>
  
<span class="line-modified">!                 default:</span>
<span class="line-modified">!                     Messages messages = getMessages();</span>
<span class="line-modified">!                     messages.error(&quot;doclet.Error_invalid_custom_tag_argument&quot;, args.get(1));</span>
              }
          }
      }
  
      /**
       * Given a string, return an array of tokens.  The separator can be escaped
<span class="line-new-header">--- 417,52 ---</span>
       *
       * @param customTagStrs the set two dimensional arrays of strings.  These arrays contain
       *                      either -tag or -taglet arguments.
       */
      private void initTagletManager(Set&lt;List&lt;String&gt;&gt; customTagStrs) {
<span class="line-modified">!         tagletManager = tagletManager != null ? tagletManager : new TagletManager(this);</span>
<span class="line-modified">!         JavaFileManager fileManager = getFileManager();</span>
<span class="line-modified">!         Messages messages = getMessages();</span>
<span class="line-modified">!         try {</span>
<span class="line-modified">!             tagletManager.initTagletPath(fileManager);</span>
<span class="line-modified">!             tagletManager.loadTaglets(fileManager);</span>
<span class="line-modified">! </span>
<span class="line-modified">!             for (List&lt;String&gt; args : customTagStrs) {</span>
<span class="line-modified">!                 if (args.get(0).equals(&quot;-taglet&quot;)) {</span>
<span class="line-modified">!                     tagletManager.addCustomTag(args.get(1), fileManager);</span>
<span class="line-modified">!                     continue;</span>
<span class="line-modified">!                 }</span>
<span class="line-modified">!                 List&lt;String&gt; tokens = tokenize(args.get(1), TagletManager.SIMPLE_TAGLET_OPT_SEPARATOR, 3);</span>
<span class="line-modified">!                 switch (tokens.size()) {</span>
<span class="line-modified">!                     case 1:</span>
<span class="line-modified">!                         String tagName = args.get(1);</span>
<span class="line-modified">!                         if (tagletManager.isKnownCustomTag(tagName)) {</span>
<span class="line-modified">!                             //reorder a standard tag</span>
<span class="line-modified">!                             tagletManager.addNewSimpleCustomTag(tagName, null, &quot;&quot;);</span>
<span class="line-modified">!                         } else {</span>
<span class="line-modified">!                             //Create a simple tag with the heading that has the same name as the tag.</span>
<span class="line-modified">!                             StringBuilder heading = new StringBuilder(tagName + &quot;:&quot;);</span>
<span class="line-added">+                             heading.setCharAt(0, Character.toUpperCase(tagName.charAt(0)));</span>
<span class="line-added">+                             tagletManager.addNewSimpleCustomTag(tagName, heading.toString(), &quot;a&quot;);</span>
<span class="line-added">+                         }</span>
<span class="line-added">+                         break;</span>
  
<span class="line-modified">!                     case 2:</span>
<span class="line-modified">!                         //Add simple taglet without heading, probably to excluding it in the output.</span>
<span class="line-modified">!                         tagletManager.addNewSimpleCustomTag(tokens.get(0), tokens.get(1), &quot;&quot;);</span>
<span class="line-modified">!                         break;</span>
  
<span class="line-modified">!                     case 3:</span>
<span class="line-modified">!                         tagletManager.addNewSimpleCustomTag(tokens.get(0), tokens.get(2), tokens.get(1));</span>
<span class="line-modified">!                         break;</span>
  
<span class="line-modified">!                     default:</span>
<span class="line-modified">!                         messages.error(&quot;doclet.Error_invalid_custom_tag_argument&quot;, args.get(1));</span>
<span class="line-modified">!                 }</span>
              }
<span class="line-added">+         } catch (IOException e) {</span>
<span class="line-added">+             messages.error(&quot;doclet.taglet_could_not_set_location&quot;, e.toString());</span>
          }
      }
  
      /**
       * Given a string, return an array of tokens.  The separator can be escaped
</pre>
<hr />
<pre>
<span class="line-old-header">*** 911,103 ***</span>
              tokens.add(token.toString());
          }
          return tokens;
      }
  
<span class="line-removed">-     private void addToSet(Set&lt;String&gt; s, String str) {</span>
<span class="line-removed">-         StringTokenizer st = new StringTokenizer(str, &quot;:&quot;);</span>
<span class="line-removed">-         String current;</span>
<span class="line-removed">-         while (st.hasMoreTokens()) {</span>
<span class="line-removed">-             current = st.nextToken();</span>
<span class="line-removed">-             s.add(current);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Add a trailing file separator, if not found. Remove superfluous</span>
<span class="line-removed">-      * file separators if any. Preserve the front double file separator for</span>
<span class="line-removed">-      * UNC paths.</span>
<span class="line-removed">-      *</span>
<span class="line-removed">-      * @param path Path under consideration.</span>
<span class="line-removed">-      * @return String Properly constructed path string.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static String addTrailingFileSep(String path) {</span>
<span class="line-removed">-         String fs = System.getProperty(&quot;file.separator&quot;);</span>
<span class="line-removed">-         String dblfs = fs + fs;</span>
<span class="line-removed">-         int indexDblfs;</span>
<span class="line-removed">-         while ((indexDblfs = path.indexOf(dblfs, 1)) &gt;= 0) {</span>
<span class="line-removed">-             path = path.substring(0, indexDblfs) +</span>
<span class="line-removed">-                     path.substring(indexDblfs + fs.length());</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (!path.endsWith(fs))</span>
<span class="line-removed">-             path += fs;</span>
<span class="line-removed">-         return path;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * This checks for the validity of the options used by the user.</span>
<span class="line-removed">-      * As of this writing, this checks only docencoding.</span>
<span class="line-removed">-      *</span>
<span class="line-removed">-      * @return true if all the options are valid.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public boolean generalValidOptions() {</span>
<span class="line-removed">-         if (docencoding != null) {</span>
<span class="line-removed">-             if (!checkOutputFileEncoding(docencoding)) {</span>
<span class="line-removed">-                 return false;</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (docencoding == null &amp;&amp; (encoding != null &amp;&amp; !encoding.isEmpty())) {</span>
<span class="line-removed">-             if (!checkOutputFileEncoding(encoding)) {</span>
<span class="line-removed">-                 return false;</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         return true;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Check the validity of the given Source or Output File encoding on this</span>
<span class="line-removed">-      * platform.</span>
<span class="line-removed">-      *</span>
<span class="line-removed">-      * @param docencoding output file encoding.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     private boolean checkOutputFileEncoding(String docencoding) {</span>
<span class="line-removed">-         OutputStream ost = new ByteArrayOutputStream();</span>
<span class="line-removed">-         OutputStreamWriter osw = null;</span>
<span class="line-removed">-         try {</span>
<span class="line-removed">-             osw = new OutputStreamWriter(ost, docencoding);</span>
<span class="line-removed">-         } catch (UnsupportedEncodingException exc) {</span>
<span class="line-removed">-             reporter.print(ERROR, getResources().getText(&quot;doclet.Encoding_not_supported&quot;, docencoding));</span>
<span class="line-removed">-             return false;</span>
<span class="line-removed">-         } finally {</span>
<span class="line-removed">-             try {</span>
<span class="line-removed">-                 if (osw != null) {</span>
<span class="line-removed">-                     osw.close();</span>
<span class="line-removed">-                 }</span>
<span class="line-removed">-             } catch (IOException exc) {</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         return true;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      /**
       * Return true if the given doc-file subdirectory should be excluded and
       * false otherwise.
       *
       * @param docfilesubdir the doc-files subdirectory to check.
       * @return true if the directory is excluded.
       */
      public boolean shouldExcludeDocFileDir(String docfilesubdir) {
          return excludedDocFileDirs.contains(docfilesubdir);
      }
  
      /**
       * Return true if the given qualifier should be excluded and false otherwise.
       *
       * @param qualifier the qualifier to check.
       * @return true if the qualifier should be excluded
       */
      public boolean shouldExcludeQualifier(String qualifier) {
          if (excludedQualifiers.contains(&quot;all&quot;) ||
                  excludedQualifiers.contains(qualifier) ||
                  excludedQualifiers.contains(qualifier + &quot;.*&quot;)) {
              return true;
          } else {
<span class="line-new-header">--- 502,30 ---</span>
              tokens.add(token.toString());
          }
          return tokens;
      }
  
      /**
       * Return true if the given doc-file subdirectory should be excluded and
       * false otherwise.
       *
       * @param docfilesubdir the doc-files subdirectory to check.
       * @return true if the directory is excluded.
       */
      public boolean shouldExcludeDocFileDir(String docfilesubdir) {
<span class="line-added">+         Set&lt;String&gt; excludedDocFileDirs = getOptions().excludedDocFileDirs();</span>
          return excludedDocFileDirs.contains(docfilesubdir);
      }
  
      /**
       * Return true if the given qualifier should be excluded and false otherwise.
       *
       * @param qualifier the qualifier to check.
       * @return true if the qualifier should be excluded
       */
      public boolean shouldExcludeQualifier(String qualifier) {
<span class="line-added">+         Set&lt;String&gt; excludedQualifiers = getOptions().excludedQualifiers();</span>
          if (excludedQualifiers.contains(&quot;all&quot;) ||
                  excludedQualifiers.contains(qualifier) ||
                  excludedQualifiers.contains(qualifier + &quot;.*&quot;)) {
              return true;
          } else {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1043,10 ***</span>
<span class="line-new-header">--- 561,11 ---</span>
       *
       * @param te the TypeElement for which the page generation is checked
       * @return true if it is a generated doc.
       */
      public boolean isGeneratedDoc(TypeElement te) {
<span class="line-added">+         boolean nodeprecated = getOptions().noDeprecated();</span>
          if (!nodeprecated) {
              return true;
          }
          return !(utils.isDeprecated(te) || utils.isDeprecated(utils.containingPackage(te)));
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1089,147 ***</span>
       *
       * @return JavaFileManager
       */
      public abstract JavaFileManager getFileManager();
  
<span class="line-removed">-     private void setTabWidth(int n) {</span>
<span class="line-removed">-         sourcetab = n;</span>
<span class="line-removed">-         tabSpaces = String.format(&quot;%&quot; + n + &quot;s&quot;, &quot;&quot;);</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      public abstract boolean showMessage(DocTreePath path, String key);
  
      public abstract boolean showMessage(Element e, String key);
  
<span class="line-removed">-     public static abstract class Option implements Doclet.Option, Comparable&lt;Option&gt; {</span>
<span class="line-removed">-         private final String[] names;</span>
<span class="line-removed">-         private final String parameters;</span>
<span class="line-removed">-         private final String description;</span>
<span class="line-removed">-         private final int argCount;</span>
<span class="line-removed">- </span>
<span class="line-removed">-         protected Option(Resources resources, String name, int argCount) {</span>
<span class="line-removed">-             this(resources, null, name, argCount);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         protected Option(Resources resources, String keyBase, String name, int argCount) {</span>
<span class="line-removed">-             this.names = name.trim().split(&quot;\\s+&quot;);</span>
<span class="line-removed">-             if (keyBase == null) {</span>
<span class="line-removed">-                 keyBase = &quot;doclet.usage.&quot; + names[0].toLowerCase().replaceAll(&quot;^-+&quot;, &quot;&quot;);</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-             String desc = getOptionsMessage(resources, keyBase + &quot;.description&quot;);</span>
<span class="line-removed">-             if (desc.isEmpty()) {</span>
<span class="line-removed">-                 this.description = &quot;&lt;MISSING KEY&gt;&quot;;</span>
<span class="line-removed">-                 this.parameters = &quot;&lt;MISSING KEY&gt;&quot;;</span>
<span class="line-removed">-             } else {</span>
<span class="line-removed">-                 this.description = desc;</span>
<span class="line-removed">-                 this.parameters = getOptionsMessage(resources, keyBase + &quot;.parameters&quot;);</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-             this.argCount = argCount;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         protected Option(Resources resources, String name) {</span>
<span class="line-removed">-             this(resources, name, 0);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         private String getOptionsMessage(Resources resources, String key) {</span>
<span class="line-removed">-             try {</span>
<span class="line-removed">-                 return resources.getText(key);</span>
<span class="line-removed">-             } catch (MissingResourceException ignore) {</span>
<span class="line-removed">-                 return &quot;&quot;;</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         @Override</span>
<span class="line-removed">-         public String getDescription() {</span>
<span class="line-removed">-             return description;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         @Override</span>
<span class="line-removed">-         public Option.Kind getKind() {</span>
<span class="line-removed">-             return Doclet.Option.Kind.STANDARD;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         @Override</span>
<span class="line-removed">-         public List&lt;String&gt; getNames() {</span>
<span class="line-removed">-             return Arrays.asList(names);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         @Override</span>
<span class="line-removed">-         public String getParameters() {</span>
<span class="line-removed">-             return parameters;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         @Override</span>
<span class="line-removed">-         public String toString() {</span>
<span class="line-removed">-             return Arrays.toString(names);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         @Override</span>
<span class="line-removed">-         public int getArgumentCount() {</span>
<span class="line-removed">-             return argCount;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         public boolean matches(String option) {</span>
<span class="line-removed">-             for (String name : names) {</span>
<span class="line-removed">-                 boolean matchCase = name.startsWith(&quot;--&quot;);</span>
<span class="line-removed">-                 if (option.startsWith(&quot;--&quot;) &amp;&amp; option.contains(&quot;=&quot;)) {</span>
<span class="line-removed">-                     return name.equals(option.substring(option.indexOf(&quot;=&quot;) + 1));</span>
<span class="line-removed">-                 } else if (matchCase) {</span>
<span class="line-removed">-                     return name.equals(option);</span>
<span class="line-removed">-                 }</span>
<span class="line-removed">-                 return name.toLowerCase().equals(option.toLowerCase());</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-             return false;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         @Override</span>
<span class="line-removed">-         public int compareTo(Option that) {</span>
<span class="line-removed">-             return this.getNames().get(0).compareTo(that.getNames().get(0));</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     public abstract class XOption extends Option {</span>
<span class="line-removed">- </span>
<span class="line-removed">-         public XOption(Resources resources, String prefix, String name, int argCount) {</span>
<span class="line-removed">-             super(resources, prefix, name, argCount);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         public XOption(Resources resources, String name, int argCount) {</span>
<span class="line-removed">-             super(resources, name, argCount);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         public XOption(Resources resources, String name) {</span>
<span class="line-removed">-             this(resources, name, 0);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         @Override</span>
<span class="line-removed">-         public Option.Kind getKind() {</span>
<span class="line-removed">-             return Doclet.Option.Kind.EXTENDED;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     public abstract class Hidden extends Option {</span>
<span class="line-removed">- </span>
<span class="line-removed">-         public Hidden(Resources resources, String name, int argCount) {</span>
<span class="line-removed">-             super(resources, name, argCount);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         public Hidden(Resources resources, String name) {</span>
<span class="line-removed">-             this(resources, name, 0);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         @Override</span>
<span class="line-removed">-         public Option.Kind getKind() {</span>
<span class="line-removed">-             return Doclet.Option.Kind.OTHER;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      /*
       * Splits the elements in a collection to its individual
       * collection.
       */
<span class="line-modified">!     static private class Splitter {</span>
  
          final Set&lt;ModuleElement&gt; mset = new LinkedHashSet&lt;&gt;();
          final Set&lt;PackageElement&gt; pset = new LinkedHashSet&lt;&gt;();
          final Set&lt;TypeElement&gt; tset = new LinkedHashSet&lt;&gt;();
  
<span class="line-new-header">--- 608,20 ---</span>
       *
       * @return JavaFileManager
       */
      public abstract JavaFileManager getFileManager();
  
      public abstract boolean showMessage(DocTreePath path, String key);
  
      public abstract boolean showMessage(Element e, String key);
  
      /*
       * Splits the elements in a collection to its individual
       * collection.
       */
<span class="line-modified">!     @SuppressWarnings(&quot;preview&quot;)</span>
<span class="line-added">+     private static class Splitter {</span>
  
          final Set&lt;ModuleElement&gt; mset = new LinkedHashSet&lt;&gt;();
          final Set&lt;PackageElement&gt; pset = new LinkedHashSet&lt;&gt;();
          final Set&lt;TypeElement&gt; tset = new LinkedHashSet&lt;&gt;();
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1238,11 ***</span>
              Set&lt;? extends Element&gt; inset = included
                      ? docEnv.getIncludedElements()
                      : docEnv.getSpecifiedElements();
  
              for (Element e : inset) {
<span class="line-modified">!                 new SimpleElementVisitor9&lt;Void, Void&gt;() {</span>
                      @Override
                      @DefinedBy(Api.LANGUAGE_MODEL)
                      public Void visitModule(ModuleElement e, Void p) {
                          mset.add(e);
                          return null;
<span class="line-new-header">--- 630,11 ---</span>
              Set&lt;? extends Element&gt; inset = included
                      ? docEnv.getIncludedElements()
                      : docEnv.getSpecifiedElements();
  
              for (Element e : inset) {
<span class="line-modified">!                 new SimpleElementVisitor14&lt;Void, Void&gt;() {</span>
                      @Override
                      @DefinedBy(Api.LANGUAGE_MODEL)
                      public Void visitModule(ModuleElement e, Void p) {
                          mset.add(e);
                          return null;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1273,16 ***</span>
          }
      }
  
      /**
       * Returns whether or not to allow JavaScript in comments.
<span class="line-modified">!      * Default is off; can be set true from a command line option.</span>
       *
       * @return the allowScriptInComments
       */
      public boolean isAllowScriptInComments() {
<span class="line-modified">!         return allowScriptInComments;</span>
      }
  
      public synchronized VisibleMemberTable getVisibleMemberTable(TypeElement te) {
          return visibleMemberCache.getVisibleMemberTable(te);
      }
<span class="line-new-header">--- 665,16 ---</span>
          }
      }
  
      /**
       * Returns whether or not to allow JavaScript in comments.
<span class="line-modified">!      * Default is off; can be set true from a command-line option.</span>
       *
       * @return the allowScriptInComments
       */
      public boolean isAllowScriptInComments() {
<span class="line-modified">!         return getOptions().allowScriptInComments();</span>
      }
  
      public synchronized VisibleMemberTable getVisibleMemberTable(TypeElement te) {
          return visibleMemberCache.getVisibleMemberTable(te);
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1291,14 ***</span>
       * Determines if JavaFX is available in the compilation environment.
       * @return true if JavaFX is available
       */
      public boolean isJavaFXMode() {
          TypeElement observable = utils.elementUtils.getTypeElement(&quot;javafx.beans.Observable&quot;);
<span class="line-modified">!         if (observable != null) {</span>
<span class="line-modified">!             ModuleElement javafxModule = utils.elementUtils.getModuleOf(observable);</span>
<span class="line-removed">-             if (javafxModule == null || javafxModule.isUnnamed() || javafxModule.getQualifiedName().contentEquals(&quot;javafx.base&quot;)) {</span>
<span class="line-removed">-                 return true;</span>
<span class="line-removed">-             }</span>
          }
<span class="line-modified">!         return false;</span>
      }
  }
<span class="line-new-header">--- 683,14 ---</span>
       * Determines if JavaFX is available in the compilation environment.
       * @return true if JavaFX is available
       */
      public boolean isJavaFXMode() {
          TypeElement observable = utils.elementUtils.getTypeElement(&quot;javafx.beans.Observable&quot;);
<span class="line-modified">!         if (observable == null) {</span>
<span class="line-modified">!             return false;</span>
          }
<span class="line-modified">!         ModuleElement javafxModule = utils.elementUtils.getModuleOf(observable);</span>
<span class="line-added">+         return javafxModule == null</span>
<span class="line-added">+                 || javafxModule.isUnnamed()</span>
<span class="line-added">+                 || javafxModule.getQualifiedName().contentEquals(&quot;javafx.base&quot;);</span>
      }
  }
</pre>
<center><a href="AnnotationTypeWriter.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="ClassWriter.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>