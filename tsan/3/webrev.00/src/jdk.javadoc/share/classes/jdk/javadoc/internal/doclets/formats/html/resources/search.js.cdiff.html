<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/resources/search.js</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="script-dir/jquery-ui.structure.min.css.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="standard.properties.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/resources/search.js</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2015, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2015, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 28,46 ***</span>
  var catPackages = &quot;Packages&quot;;
  var catTypes = &quot;Types&quot;;
  var catMembers = &quot;Members&quot;;
  var catSearchTags = &quot;SearchTags&quot;;
  var highlight = &quot;&lt;span class=\&quot;resultHighlight\&quot;&gt;$&amp;&lt;/span&gt;&quot;;
<span class="line-modified">! var camelCaseRegexp = &quot;&quot;;</span>
<span class="line-modified">! var secondaryMatcher = &quot;&quot;;</span>
  function escapeHtml(str) {
      return str.replace(/&lt;/g, &quot;&amp;lt;&quot;).replace(/&gt;/g, &quot;&amp;gt;&quot;);
  }
<span class="line-modified">! function getHighlightedText(item) {</span>
<span class="line-removed">-     var ccMatcher = new RegExp(escapeHtml(camelCaseRegexp));</span>
      var escapedItem = escapeHtml(item);
<span class="line-modified">!     var label = escapedItem.replace(ccMatcher, highlight);</span>
<span class="line-removed">-     if (label === escapedItem) {</span>
<span class="line-removed">-         var secMatcher = new RegExp(escapeHtml(secondaryMatcher.source), &quot;i&quot;);</span>
<span class="line-removed">-         label = escapedItem.replace(secMatcher, highlight);</span>
<span class="line-removed">-     }</span>
<span class="line-removed">-     return label;</span>
  }
  function getURLPrefix(ui) {
      var urlPrefix=&quot;&quot;;
<span class="line-modified">!     if (useModuleDirectories) {</span>
<span class="line-modified">!         var slash = &quot;/&quot;;</span>
<span class="line-modified">!         if (ui.item.category === catModules) {</span>
<span class="line-modified">!             return ui.item.l + slash;</span>
<span class="line-modified">!         } else if (ui.item.category === catPackages &amp;&amp; ui.item.m) {</span>
<span class="line-modified">!             return ui.item.m + slash;</span>
<span class="line-modified">!         } else if ((ui.item.category === catTypes &amp;&amp; ui.item.p) || ui.item.category === catMembers) {</span>
<span class="line-modified">!             $.each(packageSearchIndex, function(index, item) {</span>
<span class="line-modified">!                 if (item.m &amp;&amp; ui.item.p == item.l) {</span>
<span class="line-modified">!                     urlPrefix = item.m + slash;</span>
<span class="line-modified">!                 }</span>
<span class="line-modified">!             });</span>
<span class="line-modified">!             return urlPrefix;</span>
<span class="line-modified">!         } else {</span>
<span class="line-removed">-             return urlPrefix;</span>
<span class="line-removed">-         }</span>
      }
      return urlPrefix;
  }
  var watermark = &#39;Search&#39;;
  $(function() {
      $(&quot;#search&quot;).val(&#39;&#39;);
      $(&quot;#search&quot;).prop(&quot;disabled&quot;, false);
      $(&quot;#reset&quot;).prop(&quot;disabled&quot;, false);
<span class="line-new-header">--- 28,67 ---</span>
  var catPackages = &quot;Packages&quot;;
  var catTypes = &quot;Types&quot;;
  var catMembers = &quot;Members&quot;;
  var catSearchTags = &quot;SearchTags&quot;;
  var highlight = &quot;&lt;span class=\&quot;resultHighlight\&quot;&gt;$&amp;&lt;/span&gt;&quot;;
<span class="line-modified">! var searchPattern = &quot;&quot;;</span>
<span class="line-modified">! var RANKING_THRESHOLD = 2;</span>
<span class="line-added">+ var NO_MATCH = 0xffff;</span>
<span class="line-added">+ var MAX_RESULTS_PER_CATEGORY = 500;</span>
  function escapeHtml(str) {
      return str.replace(/&lt;/g, &quot;&amp;lt;&quot;).replace(/&gt;/g, &quot;&amp;gt;&quot;);
  }
<span class="line-modified">! function getHighlightedText(item, matcher) {</span>
      var escapedItem = escapeHtml(item);
<span class="line-modified">!     return escapedItem.replace(matcher, highlight);</span>
  }
  function getURLPrefix(ui) {
      var urlPrefix=&quot;&quot;;
<span class="line-modified">!     var slash = &quot;/&quot;;</span>
<span class="line-modified">!     if (ui.item.category === catModules) {</span>
<span class="line-modified">!         return ui.item.l + slash;</span>
<span class="line-modified">!     } else if (ui.item.category === catPackages &amp;&amp; ui.item.m) {</span>
<span class="line-modified">!         return ui.item.m + slash;</span>
<span class="line-modified">!     } else if ((ui.item.category === catTypes &amp;&amp; ui.item.p) || ui.item.category === catMembers) {</span>
<span class="line-modified">!         $.each(packageSearchIndex, function(index, item) {</span>
<span class="line-modified">!             if (item.m &amp;&amp; ui.item.p == item.l) {</span>
<span class="line-modified">!                 urlPrefix = item.m + slash;</span>
<span class="line-modified">!             }</span>
<span class="line-modified">!         });</span>
<span class="line-modified">!         return urlPrefix;</span>
<span class="line-modified">!     } else {</span>
<span class="line-modified">!         return urlPrefix;</span>
      }
      return urlPrefix;
  }
<span class="line-added">+ function makeCamelCaseRegex(term) {</span>
<span class="line-added">+     var pattern = &quot;&quot;;</span>
<span class="line-added">+     var isWordToken = false;</span>
<span class="line-added">+     term.replace(/,\s*/g, &quot;, &quot;).trim().split(/\s+/).forEach(function(w, index) {</span>
<span class="line-added">+         if (index &gt; 0) {</span>
<span class="line-added">+             // whitespace between identifiers is significant</span>
<span class="line-added">+             pattern += (isWordToken &amp;&amp; /^\w/.test(w)) ? &quot;\\s+&quot; : &quot;\\s*&quot;;</span>
<span class="line-added">+         }</span>
<span class="line-added">+         var tokens = w.split(/(?=[A-Z,.()&lt;&gt;[\/])/);</span>
<span class="line-added">+         for (var i = 0; i &lt; tokens.length; i++) {</span>
<span class="line-added">+             var s = tokens[i];</span>
<span class="line-added">+             if (s === &quot;&quot;) {</span>
<span class="line-added">+                 continue;</span>
<span class="line-added">+             }</span>
<span class="line-added">+             pattern += $.ui.autocomplete.escapeRegex(s);</span>
<span class="line-added">+             isWordToken =  /\w$/.test(s);</span>
<span class="line-added">+             if (isWordToken) {</span>
<span class="line-added">+                 pattern += &quot;([a-z0-9_$&lt;&gt;\\[\\]]*?)&quot;;</span>
<span class="line-added">+             }</span>
<span class="line-added">+         }</span>
<span class="line-added">+     });</span>
<span class="line-added">+     return pattern;</span>
<span class="line-added">+ }</span>
<span class="line-added">+ function createMatcher(pattern, flags) {</span>
<span class="line-added">+     var isCamelCase = /[A-Z]/.test(pattern);</span>
<span class="line-added">+     return new RegExp(pattern, flags + (isCamelCase ? &quot;&quot; : &quot;i&quot;));</span>
<span class="line-added">+ }</span>
  var watermark = &#39;Search&#39;;
  $(function() {
      $(&quot;#search&quot;).val(&#39;&#39;);
      $(&quot;#search&quot;).prop(&quot;disabled&quot;, false);
      $(&quot;#reset&quot;).prop(&quot;disabled&quot;, false);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 75,11 ***</span>
      $(&quot;#search&quot;).blur(function() {
          if ($(this).val().length == 0) {
              $(this).val(watermark).addClass(&#39;watermark&#39;);
          }
      });
<span class="line-modified">!     $(&quot;#search&quot;).on(&#39;click keydown&#39;, function() {</span>
          if ($(this).val() == watermark) {
              $(this).val(&#39;&#39;).removeClass(&#39;watermark&#39;);
          }
      });
      $(&quot;#reset&quot;).click(function() {
<span class="line-new-header">--- 96,11 ---</span>
      $(&quot;#search&quot;).blur(function() {
          if ($(this).val().length == 0) {
              $(this).val(watermark).addClass(&#39;watermark&#39;);
          }
      });
<span class="line-modified">!     $(&quot;#search&quot;).on(&#39;click keydown paste&#39;, function() {</span>
          if ($(this).val() == watermark) {
              $(this).val(&#39;&#39;).removeClass(&#39;watermark&#39;);
          }
      });
      $(&quot;#reset&quot;).click(function() {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 93,12 ***</span>
      _create: function() {
          this._super();
          this.widget().menu(&quot;option&quot;, &quot;items&quot;, &quot;&gt; :not(.ui-autocomplete-category)&quot;);
      },
      _renderMenu: function(ul, items) {
<span class="line-modified">!         var rMenu = this,</span>
<span class="line-modified">!                 currentCategory = &quot;&quot;;</span>
          rMenu.menu.bindings = $();
          $.each(items, function(index, item) {
              var li;
              if (item.l !== noResult.l &amp;&amp; item.category !== currentCategory) {
                  ul.append(&quot;&lt;li class=\&quot;ui-autocomplete-category\&quot;&gt;&quot; + item.category + &quot;&lt;/li&gt;&quot;);
<span class="line-new-header">--- 114,12 ---</span>
      _create: function() {
          this._super();
          this.widget().menu(&quot;option&quot;, &quot;items&quot;, &quot;&gt; :not(.ui-autocomplete-category)&quot;);
      },
      _renderMenu: function(ul, items) {
<span class="line-modified">!         var rMenu = this;</span>
<span class="line-modified">!         var currentCategory = &quot;&quot;;</span>
          rMenu.menu.bindings = $();
          $.each(items, function(index, item) {
              var li;
              if (item.l !== noResult.l &amp;&amp; item.category !== currentCategory) {
                  ul.append(&quot;&lt;li class=\&quot;ui-autocomplete-category\&quot;&gt;&quot; + item.category + &quot;&lt;/li&gt;&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 114,24 ***</span>
              }
          });
      },
      _renderItem: function(ul, item) {
          var label = &quot;&quot;;
          if (item.category === catModules) {
<span class="line-modified">!             label = getHighlightedText(item.l);</span>
          } else if (item.category === catPackages) {
              label = (item.m)
<span class="line-modified">!                     ? getHighlightedText(item.m + &quot;/&quot; + item.l)</span>
<span class="line-modified">!                     : getHighlightedText(item.l);</span>
          } else if (item.category === catTypes) {
              label = (item.p)
<span class="line-modified">!                     ? getHighlightedText(item.p + &quot;.&quot; + item.l)</span>
<span class="line-modified">!                     : getHighlightedText(item.l);</span>
          } else if (item.category === catMembers) {
<span class="line-modified">!             label = getHighlightedText(item.p + &quot;.&quot; + (item.c + &quot;.&quot; + item.l));</span>
          } else if (item.category === catSearchTags) {
<span class="line-modified">!             label = getHighlightedText(item.l);</span>
          } else {
              label = item.l;
          }
          var li = $(&quot;&lt;li/&gt;&quot;).appendTo(ul);
          var div = $(&quot;&lt;div/&gt;&quot;).appendTo(li);
<span class="line-new-header">--- 135,25 ---</span>
              }
          });
      },
      _renderItem: function(ul, item) {
          var label = &quot;&quot;;
<span class="line-added">+         var matcher = createMatcher(escapeHtml(searchPattern), &quot;g&quot;);</span>
          if (item.category === catModules) {
<span class="line-modified">!             label = getHighlightedText(item.l, matcher);</span>
          } else if (item.category === catPackages) {
              label = (item.m)
<span class="line-modified">!                     ? getHighlightedText(item.m + &quot;/&quot; + item.l, matcher)</span>
<span class="line-modified">!                     : getHighlightedText(item.l, matcher);</span>
          } else if (item.category === catTypes) {
              label = (item.p)
<span class="line-modified">!                     ? getHighlightedText(item.p + &quot;.&quot; + item.l, matcher)</span>
<span class="line-modified">!                     : getHighlightedText(item.l, matcher);</span>
          } else if (item.category === catMembers) {
<span class="line-modified">!             label = getHighlightedText(item.p + &quot;.&quot; + (item.c + &quot;.&quot; + item.l), matcher);</span>
          } else if (item.category === catSearchTags) {
<span class="line-modified">!             label = getHighlightedText(item.l, matcher);</span>
          } else {
              label = item.l;
          }
          var li = $(&quot;&lt;li/&gt;&quot;).appendTo(ul);
          var div = $(&quot;&lt;div/&gt;&quot;).appendTo(li);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 146,132 ***</span>
              div.html(label);
          }
          return li;
      }
  });
  $(function() {
      $(&quot;#search&quot;).catcomplete({
          minLength: 1,
          delay: 300,
          source: function(request, response) {
<span class="line-modified">!             var result = new Array();</span>
<span class="line-modified">!             var presult = new Array();</span>
<span class="line-removed">-             var tresult = new Array();</span>
<span class="line-removed">-             var mresult = new Array();</span>
<span class="line-removed">-             var tgresult = new Array();</span>
<span class="line-removed">-             var secondaryresult = new Array();</span>
<span class="line-removed">-             var displayCount = 0;</span>
<span class="line-removed">-             var exactMatcher = new RegExp(&quot;^&quot; + $.ui.autocomplete.escapeRegex(request.term) + &quot;$&quot;, &quot;i&quot;);</span>
<span class="line-removed">-             camelCaseRegexp = ($.ui.autocomplete.escapeRegex(request.term)).split(/(?=[A-Z])/).join(&quot;([a-z0-9_$]*?)&quot;);</span>
<span class="line-removed">-             var camelCaseMatcher = new RegExp(&quot;^&quot; + camelCaseRegexp);</span>
<span class="line-removed">-             secondaryMatcher = new RegExp($.ui.autocomplete.escapeRegex(request.term), &quot;i&quot;);</span>
  
<span class="line-modified">!             // Return the nested innermost name from the specified object</span>
<span class="line-modified">!             function nestedName(e) {</span>
<span class="line-modified">!                 return e.l.substring(e.l.lastIndexOf(&quot;.&quot;) + 1);</span>
              }
  
              function concatResults(a1, a2) {
<span class="line-modified">!                 a1 = a1.concat(a2);</span>
                  a2.length = 0;
                  return a1;
              }
  
              if (moduleSearchIndex) {
<span class="line-removed">-                 var mdleCount = 0;</span>
                  $.each(moduleSearchIndex, function(index, item) {
                      item.category = catModules;
<span class="line-modified">!                     if (exactMatcher.test(item.l)) {</span>
<span class="line-modified">!                         result.push(item);</span>
<span class="line-modified">!                         mdleCount++;</span>
<span class="line-removed">-                     } else if (camelCaseMatcher.test(item.l)) {</span>
<span class="line-removed">-                         result.push(item);</span>
<span class="line-removed">-                     } else if (secondaryMatcher.test(item.l)) {</span>
<span class="line-removed">-                         secondaryresult.push(item);</span>
                      }
                  });
<span class="line-modified">!                 displayCount = mdleCount;</span>
<span class="line-removed">-                 result = concatResults(result, secondaryresult);</span>
              }
              if (packageSearchIndex) {
<span class="line-removed">-                 var pCount = 0;</span>
<span class="line-removed">-                 var pkg = &quot;&quot;;</span>
                  $.each(packageSearchIndex, function(index, item) {
                      item.category = catPackages;
<span class="line-modified">!                     pkg = (item.m)</span>
                              ? (item.m + &quot;/&quot; + item.l)
                              : item.l;
<span class="line-modified">!                     if (exactMatcher.test(item.l)) {</span>
<span class="line-modified">!                         presult.push(item);</span>
<span class="line-modified">!                         pCount++;</span>
<span class="line-removed">-                     } else if (camelCaseMatcher.test(pkg)) {</span>
<span class="line-removed">-                         presult.push(item);</span>
<span class="line-removed">-                     } else if (secondaryMatcher.test(pkg)) {</span>
<span class="line-removed">-                         secondaryresult.push(item);</span>
                      }
                  });
<span class="line-modified">!                 result = result.concat(concatResults(presult, secondaryresult));</span>
<span class="line-removed">-                 displayCount = (pCount &gt; displayCount) ? pCount : displayCount;</span>
              }
              if (typeSearchIndex) {
<span class="line-removed">-                 var tCount = 0;</span>
                  $.each(typeSearchIndex, function(index, item) {
                      item.category = catTypes;
<span class="line-modified">!                     var s = nestedName(item);</span>
<span class="line-modified">!                     if (exactMatcher.test(s)) {</span>
<span class="line-modified">!                         tresult.push(item);</span>
<span class="line-modified">!                         tCount++;</span>
<span class="line-modified">!                     } else if (camelCaseMatcher.test(s)) {</span>
<span class="line-modified">!                         tresult.push(item);</span>
<span class="line-removed">-                     } else if (secondaryMatcher.test(item.p + &quot;.&quot; + item.l)) {</span>
<span class="line-removed">-                         secondaryresult.push(item);</span>
                      }
                  });
<span class="line-modified">!                 result = result.concat(concatResults(tresult, secondaryresult));</span>
<span class="line-removed">-                 displayCount = (tCount &gt; displayCount) ? tCount : displayCount;</span>
              }
              if (memberSearchIndex) {
<span class="line-removed">-                 var mCount = 0;</span>
                  $.each(memberSearchIndex, function(index, item) {
                      item.category = catMembers;
<span class="line-modified">!                     var s = nestedName(item);</span>
<span class="line-modified">!                     if (exactMatcher.test(s)) {</span>
<span class="line-modified">!                         mresult.push(item);</span>
<span class="line-modified">!                         mCount++;</span>
<span class="line-modified">!                     } else if (camelCaseMatcher.test(s)) {</span>
<span class="line-modified">!                         mresult.push(item);</span>
<span class="line-removed">-                     } else if (secondaryMatcher.test(item.c + &quot;.&quot; + item.l)) {</span>
<span class="line-removed">-                         secondaryresult.push(item);</span>
                      }
                  });
<span class="line-modified">!                 result = result.concat(concatResults(mresult, secondaryresult));</span>
<span class="line-removed">-                 displayCount = (mCount &gt; displayCount) ? mCount : displayCount;</span>
              }
              if (tagSearchIndex) {
<span class="line-removed">-                 var tgCount = 0;</span>
                  $.each(tagSearchIndex, function(index, item) {
                      item.category = catSearchTags;
<span class="line-modified">!                     if (exactMatcher.test(item.l)) {</span>
<span class="line-modified">!                         tgresult.push(item);</span>
<span class="line-modified">!                         tgCount++;</span>
<span class="line-removed">-                     } else if (secondaryMatcher.test(item.l)) {</span>
<span class="line-removed">-                         secondaryresult.push(item);</span>
                      }
                  });
<span class="line-modified">!                 result = result.concat(concatResults(tgresult, secondaryresult));</span>
<span class="line-removed">-                 displayCount = (tgCount &gt; displayCount) ? tgCount : displayCount;</span>
              }
<span class="line-modified">!             displayCount = (displayCount &gt; 500) ? displayCount : 500;</span>
<span class="line-removed">-             var counter = function() {</span>
<span class="line-removed">-                 var count = {Modules: 0, Packages: 0, Types: 0, Members: 0, SearchTags: 0};</span>
<span class="line-removed">-                 var f = function(item) {</span>
<span class="line-removed">-                     count[item.category] += 1;</span>
<span class="line-removed">-                     return (count[item.category] &lt;= displayCount);</span>
<span class="line-removed">-                 };</span>
<span class="line-removed">-                 return f;</span>
<span class="line-removed">-             }();</span>
<span class="line-removed">-             response(result.filter(counter));</span>
          },
          response: function(event, ui) {
              if (!ui.content.length) {
                  ui.content.push(noResult);
              } else {
<span class="line-new-header">--- 168,141 ---</span>
              div.html(label);
          }
          return li;
      }
  });
<span class="line-added">+ function rankMatch(match, category) {</span>
<span class="line-added">+     if (!match) {</span>
<span class="line-added">+         return NO_MATCH;</span>
<span class="line-added">+     }</span>
<span class="line-added">+     var index = match.index;</span>
<span class="line-added">+     var input = match.input;</span>
<span class="line-added">+     var leftBoundaryMatch = 2;</span>
<span class="line-added">+     var periferalMatch = 0;</span>
<span class="line-added">+     var delta = 0;</span>
<span class="line-added">+     // make sure match is anchored on a left word boundary</span>
<span class="line-added">+     if (index === 0 || /\W/.test(input[index - 1]) || &quot;_&quot; === input[index - 1] || &quot;_&quot; === input[index]) {</span>
<span class="line-added">+         leftBoundaryMatch = 0;</span>
<span class="line-added">+     } else if (input[index] === input[index].toUpperCase() &amp;&amp; !/^[A-Z0-9_$]+$/.test(input)) {</span>
<span class="line-added">+         leftBoundaryMatch = 1;</span>
<span class="line-added">+     }</span>
<span class="line-added">+     var matchEnd = index + match[0].length;</span>
<span class="line-added">+     var leftParen = input.indexOf(&quot;(&quot;);</span>
<span class="line-added">+     // exclude peripheral matches</span>
<span class="line-added">+     if (category !== catModules &amp;&amp; category !== catSearchTags) {</span>
<span class="line-added">+         var endOfName = leftParen &gt; -1 ? leftParen : input.length;</span>
<span class="line-added">+         var delim = category === catPackages ? &quot;/&quot; : &quot;.&quot;;</span>
<span class="line-added">+         if (leftParen &gt; -1 &amp;&amp; leftParen &lt; index) {</span>
<span class="line-added">+             periferalMatch += 2;</span>
<span class="line-added">+         } else if (input.lastIndexOf(delim, endOfName) &gt;= matchEnd) {</span>
<span class="line-added">+             periferalMatch += 2;</span>
<span class="line-added">+         }</span>
<span class="line-added">+     }</span>
<span class="line-added">+     for (var i = 1; i &lt; match.length; i++) {</span>
<span class="line-added">+         // lower ranking if parts of the name are missing</span>
<span class="line-added">+         if (match[i])</span>
<span class="line-added">+             delta += match[i].length;</span>
<span class="line-added">+     }</span>
<span class="line-added">+     if (category === catTypes) {</span>
<span class="line-added">+         // lower ranking if a type name contains unmatched camel-case parts</span>
<span class="line-added">+         if (/[A-Z]/.test(input.substring(matchEnd)))</span>
<span class="line-added">+             delta += 5;</span>
<span class="line-added">+         if (/[A-Z]/.test(input.substring(0, index)))</span>
<span class="line-added">+             delta += 5;</span>
<span class="line-added">+     }</span>
<span class="line-added">+     return leftBoundaryMatch + periferalMatch + (delta / 200);</span>
<span class="line-added">+ </span>
<span class="line-added">+ }</span>
  $(function() {
      $(&quot;#search&quot;).catcomplete({
          minLength: 1,
          delay: 300,
          source: function(request, response) {
<span class="line-modified">!             var result = [];</span>
<span class="line-modified">!             var newResults = [];</span>
  
<span class="line-modified">!             searchPattern = makeCamelCaseRegex(request.term);</span>
<span class="line-modified">!             if (searchPattern === &quot;&quot;) {</span>
<span class="line-modified">!                 return this.close();</span>
              }
<span class="line-added">+             var camelCaseMatcher = createMatcher(searchPattern, &quot;&quot;);</span>
<span class="line-added">+             var boundaryMatcher = createMatcher(&quot;\\b&quot; + searchPattern, &quot;&quot;);</span>
  
              function concatResults(a1, a2) {
<span class="line-modified">!                 a2.sort(function(e1, e2) {</span>
<span class="line-added">+                     return e1.ranking - e2.ranking;</span>
<span class="line-added">+                 });</span>
<span class="line-added">+                 a1 = a1.concat(a2.map(function(e) { return e.item; }));</span>
                  a2.length = 0;
                  return a1;
              }
  
              if (moduleSearchIndex) {
                  $.each(moduleSearchIndex, function(index, item) {
                      item.category = catModules;
<span class="line-modified">!                     var ranking = rankMatch(boundaryMatcher.exec(item.l), catModules);</span>
<span class="line-modified">!                     if (ranking &lt; RANKING_THRESHOLD) {</span>
<span class="line-modified">!                         newResults.push({ ranking: ranking, item: item });</span>
                      }
<span class="line-added">+                     return newResults.length &lt; MAX_RESULTS_PER_CATEGORY;</span>
                  });
<span class="line-modified">!                 result = concatResults(result, newResults);</span>
              }
              if (packageSearchIndex) {
                  $.each(packageSearchIndex, function(index, item) {
                      item.category = catPackages;
<span class="line-modified">!                     var name = (item.m &amp;&amp; request.term.indexOf(&quot;/&quot;) &gt; -1)</span>
                              ? (item.m + &quot;/&quot; + item.l)
                              : item.l;
<span class="line-modified">!                     var ranking = rankMatch(boundaryMatcher.exec(name), catPackages);</span>
<span class="line-modified">!                     if (ranking &lt; RANKING_THRESHOLD) {</span>
<span class="line-modified">!                         newResults.push({ ranking: ranking, item: item });</span>
                      }
<span class="line-added">+                     return newResults.length &lt; MAX_RESULTS_PER_CATEGORY;</span>
                  });
<span class="line-modified">!                 result = concatResults(result, newResults);</span>
              }
              if (typeSearchIndex) {
                  $.each(typeSearchIndex, function(index, item) {
                      item.category = catTypes;
<span class="line-modified">!                     var name = request.term.indexOf(&quot;.&quot;) &gt; -1</span>
<span class="line-modified">!                         ? item.p + &quot;.&quot; + item.l</span>
<span class="line-modified">!                         : item.l;</span>
<span class="line-modified">!                     var ranking = rankMatch(camelCaseMatcher.exec(name), catTypes);</span>
<span class="line-modified">!                     if (ranking &lt; RANKING_THRESHOLD) {</span>
<span class="line-modified">!                         newResults.push({ ranking: ranking, item: item });</span>
                      }
<span class="line-added">+                     return newResults.length &lt; MAX_RESULTS_PER_CATEGORY;</span>
                  });
<span class="line-modified">!                 result = concatResults(result, newResults);</span>
              }
              if (memberSearchIndex) {
                  $.each(memberSearchIndex, function(index, item) {
                      item.category = catMembers;
<span class="line-modified">!                     var name = request.term.indexOf(&quot;.&quot;) &gt; -1</span>
<span class="line-modified">!                             ? item.p + &quot;.&quot; + item.c + &quot;.&quot; + item.l</span>
<span class="line-modified">!                             : item.l;</span>
<span class="line-modified">!                     var ranking = rankMatch(camelCaseMatcher.exec(name), catMembers);</span>
<span class="line-modified">!                     if (ranking &lt; RANKING_THRESHOLD) {</span>
<span class="line-modified">!                         newResults.push({ ranking: ranking, item: item });</span>
                      }
<span class="line-added">+                     return newResults.length &lt; MAX_RESULTS_PER_CATEGORY;</span>
                  });
<span class="line-modified">!                 result = concatResults(result, newResults);</span>
              }
              if (tagSearchIndex) {
                  $.each(tagSearchIndex, function(index, item) {
                      item.category = catSearchTags;
<span class="line-modified">!                     var ranking = rankMatch(boundaryMatcher.exec(item.l), catSearchTags);</span>
<span class="line-modified">!                     if (ranking &lt; RANKING_THRESHOLD) {</span>
<span class="line-modified">!                         newResults.push({ ranking: ranking, item: item });</span>
                      }
<span class="line-added">+                     return newResults.length &lt; MAX_RESULTS_PER_CATEGORY;</span>
                  });
<span class="line-modified">!                 result = concatResults(result, newResults);</span>
              }
<span class="line-modified">!             response(result);</span>
          },
          response: function(event, ui) {
              if (!ui.content.length) {
                  ui.content.push(noResult);
              } else {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 284,24 ***</span>
          },
          select: function(event, ui) {
              if (ui.item.l !== noResult.l) {
                  var url = getURLPrefix(ui);
                  if (ui.item.category === catModules) {
<span class="line-modified">!                     if (useModuleDirectories) {</span>
<span class="line-removed">-                         url += &quot;module-summary.html&quot;;</span>
<span class="line-removed">-                     } else {</span>
<span class="line-removed">-                         url = ui.item.l + &quot;-summary.html&quot;;</span>
<span class="line-removed">-                     }</span>
                  } else if (ui.item.category === catPackages) {
<span class="line-modified">!                     if (ui.item.url) {</span>
<span class="line-modified">!                         url = ui.item.url;</span>
                      } else {
<span class="line-modified">!                     url += ui.item.l.replace(/\./g, &#39;/&#39;) + &quot;/package-summary.html&quot;;</span>
                      }
                  } else if (ui.item.category === catTypes) {
<span class="line-modified">!                     if (ui.item.url) {</span>
<span class="line-modified">!                         url = ui.item.url;</span>
                      } else if (ui.item.p === &quot;&lt;Unnamed&gt;&quot;) {
                          url += ui.item.l + &quot;.html&quot;;
                      } else {
                          url += ui.item.p.replace(/\./g, &#39;/&#39;) + &quot;/&quot; + ui.item.l + &quot;.html&quot;;
                      }
<span class="line-new-header">--- 315,20 ---</span>
          },
          select: function(event, ui) {
              if (ui.item.l !== noResult.l) {
                  var url = getURLPrefix(ui);
                  if (ui.item.category === catModules) {
<span class="line-modified">!                     url += &quot;module-summary.html&quot;;</span>
                  } else if (ui.item.category === catPackages) {
<span class="line-modified">!                     if (ui.item.u) {</span>
<span class="line-modified">!                         url = ui.item.u;</span>
                      } else {
<span class="line-modified">!                         url += ui.item.l.replace(/\./g, &#39;/&#39;) + &quot;/package-summary.html&quot;;</span>
                      }
                  } else if (ui.item.category === catTypes) {
<span class="line-modified">!                     if (ui.item.u) {</span>
<span class="line-modified">!                         url = ui.item.u;</span>
                      } else if (ui.item.p === &quot;&lt;Unnamed&gt;&quot;) {
                          url += ui.item.l + &quot;.html&quot;;
                      } else {
                          url += ui.item.p.replace(/\./g, &#39;/&#39;) + &quot;/&quot; + ui.item.l + &quot;.html&quot;;
                      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 309,12 ***</span>
                      if (ui.item.p === &quot;&lt;Unnamed&gt;&quot;) {
                          url += ui.item.c + &quot;.html&quot; + &quot;#&quot;;
                      } else {
                          url += ui.item.p.replace(/\./g, &#39;/&#39;) + &quot;/&quot; + ui.item.c + &quot;.html&quot; + &quot;#&quot;;
                      }
<span class="line-modified">!                     if (ui.item.url) {</span>
<span class="line-modified">!                         url += ui.item.url;</span>
                      } else {
                          url += ui.item.l;
                      }
                  } else if (ui.item.category === catSearchTags) {
                      url += ui.item.u;
<span class="line-new-header">--- 336,12 ---</span>
                      if (ui.item.p === &quot;&lt;Unnamed&gt;&quot;) {
                          url += ui.item.c + &quot;.html&quot; + &quot;#&quot;;
                      } else {
                          url += ui.item.p.replace(/\./g, &#39;/&#39;) + &quot;/&quot; + ui.item.c + &quot;.html&quot; + &quot;#&quot;;
                      }
<span class="line-modified">!                     if (ui.item.u) {</span>
<span class="line-modified">!                         url += ui.item.u;</span>
                      } else {
                          url += ui.item.l;
                      }
                  } else if (ui.item.category === catSearchTags) {
                      url += ui.item.u;
</pre>
<center><a href="script-dir/jquery-ui.structure.min.css.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="standard.properties.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>