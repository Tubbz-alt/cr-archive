<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/HtmlConfiguration.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 1998, 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package jdk.javadoc.internal.doclets.formats.html;
 27 
 28 import java.net.*;
 29 import java.util.*;
 30 import java.util.stream.Collectors;
 31 
 32 import javax.lang.model.element.Element;
 33 import javax.lang.model.element.PackageElement;
 34 import javax.lang.model.element.TypeElement;
 35 import javax.tools.JavaFileManager;
 36 import javax.tools.JavaFileObject;
 37 import javax.tools.StandardJavaFileManager;
 38 
 39 import com.sun.source.util.DocTreePath;
 40 import com.sun.tools.doclint.DocLint;
 41 
 42 import jdk.javadoc.doclet.Doclet;
 43 import jdk.javadoc.doclet.DocletEnvironment;
 44 import jdk.javadoc.internal.doclets.toolkit.BaseConfiguration;
 45 import jdk.javadoc.internal.doclets.toolkit.DocletException;
 46 import jdk.javadoc.internal.doclets.toolkit.Messages;
 47 import jdk.javadoc.internal.doclets.toolkit.Resources;
 48 import jdk.javadoc.internal.doclets.toolkit.WriterFactory;
 49 import jdk.javadoc.internal.doclets.toolkit.util.DocFile;
 50 import jdk.javadoc.internal.doclets.toolkit.util.DocPath;
 51 import jdk.javadoc.internal.doclets.toolkit.util.DocPaths;
 52 
 53 import static javax.tools.Diagnostic.Kind.*;
 54 
 55 /**
 56  * Configure the output based on the command line options.
 57  * &lt;p&gt;
 58  * Also determine the length of the command line option. For example,
 59  * for a option &quot;-header&quot; there will be a string argument associated, then the
 60  * the length of option &quot;-header&quot; is two. But for option &quot;-nohelp&quot; no argument
 61  * is needed so it&#39;s length is 1.
 62  * &lt;/p&gt;
 63  * &lt;p&gt;
 64  * Also do the error checking on the options used. For example it is illegal to
 65  * use &quot;-helpfile&quot; option when already &quot;-nohelp&quot; option is used.
 66  * &lt;/p&gt;
 67  *
 68  *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
 69  *  If you write code that depends on this, you do so at your own risk.
 70  *  This code and its internal interfaces are subject to change or
 71  *  deletion without notice.&lt;/b&gt;
 72  *
 73  * @author Robert Field.
 74  * @author Atul Dambalkar.
 75  * @author Jamie Ho
 76  * @author Bhavesh Patel (Modified)
 77  */
 78 public class HtmlConfiguration extends BaseConfiguration {
 79 
 80     /**
 81      * Default charset for HTML.
 82      */
 83     public static final String HTML_DEFAULT_CHARSET = &quot;utf-8&quot;;
 84 
 85     /**
 86      * Argument for command line option &quot;-header&quot;.
 87      */
 88     public String header = &quot;&quot;;
 89 
 90     /**
 91      * Argument for command line option &quot;-packagesheader&quot;.
 92      */
 93     public String packagesheader = &quot;&quot;;
 94 
 95     /**
 96      * Argument for command line option &quot;-footer&quot;.
 97      */
 98     public String footer = &quot;&quot;;
 99 
100     /**
101      * Argument for command line option &quot;-doctitle&quot;.
102      */
103     public String doctitle = &quot;&quot;;
104 
105     /**
106      * Argument for command line option &quot;-windowtitle&quot;.
107      */
108     public String windowtitle = &quot;&quot;;
109 
110     /**
111      * Argument for command line option &quot;-top&quot;.
112      */
113     public String top = &quot;&quot;;
114 
115     /**
116      * Argument for command line option &quot;-bottom&quot;.
117      */
118     public String bottom = &quot;&quot;;
119 
120     /**
121      * Argument for command line option &quot;-helpfile&quot;.
122      */
123     public String helpfile = &quot;&quot;;
124 
125     /**
126      * Argument for command line option &quot;-stylesheetfile&quot;.
127      */
128     public String stylesheetfile = &quot;&quot;;
129 
130     /**
131      * Argument for command line option &quot;--add-stylesheet&quot;.
132      */
133     public List&lt;String&gt; additionalStylesheets = new ArrayList&lt;&gt;();
134 
135     /**
136      * Argument for command line option &quot;-Xdocrootparent&quot;.
137      */
138     public String docrootparent = &quot;&quot;;
139 
140     /**
141      * True if command line option &quot;-nohelp&quot; is used. Default value is false.
142      */
143     public boolean nohelp = false;
144 
145     /**
146      * True if command line option &quot;-splitindex&quot; is used. Default value is
147      * false.
148      */
149     public boolean splitindex = false;
150 
151     /**
152      * False if command line option &quot;-noindex&quot; is used. Default value is true.
153      */
154     public boolean createindex = true;
155 
156     /**
157      * True if command line option &quot;-use&quot; is used. Default value is false.
158      */
159     public boolean classuse = false;
160 
161     /**
162      * False if command line option &quot;-notree&quot; is used. Default value is true.
163      */
164     public boolean createtree = true;
165 
166     /**
167      * The META charset tag used for cross-platform viewing.
168      */
169     public String charset = null;
170 
171     /**
172      * True if command line option &quot;-nodeprecated&quot; is used. Default value is
173      * false.
174      */
175     public boolean nodeprecatedlist = false;
176 
177     /**
178      * True if command line option &quot;-nonavbar&quot; is used. Default value is false.
179      */
180     public boolean nonavbar = false;
181 
182     /**
183      * True if command line option &quot;-nooverview&quot; is used. Default value is
184      * false
185      */
186     private boolean nooverview = false;
187 
188     /**
189      * The overview path specified with &quot;-overview&quot; flag.
190      */
191     public String overviewpath = null;
192 
193     /**
194      * This is true if option &quot;-overview&quot; is used or option &quot;-overview&quot; is not
195      * used and number of packages is more than one.
196      */
197     public boolean createoverview = false;
198 
199     /**
200      * Specifies whether or not frames should be generated.
201      * Defaults to false; can be set to true by --frames; can be set to false by --no-frames; last one wins.
202      */
203     public boolean frames = false;
204 
205     /**
206      * Collected set of doclint options
207      */
208     public Map&lt;Doclet.Option, String&gt; doclintOpts = new LinkedHashMap&lt;&gt;();
209 
210     public final Resources resources;
211 
212     /**
213      * First file to appear in the right-hand frame in the generated
214      * documentation.
215      */
216     public DocPath topFile = DocPath.empty;
217 
218     /**
219      * The TypeElement for the class file getting generated.
220      */
221     public TypeElement currentTypeElement = null;  // Set this TypeElement in the ClassWriter.
222 
223     protected SortedSet&lt;SearchIndexItem&gt; memberSearchIndex;
224 
225     protected SortedSet&lt;SearchIndexItem&gt; moduleSearchIndex;
226 
227     protected SortedSet&lt;SearchIndexItem&gt; packageSearchIndex;
228 
229     protected SortedSet&lt;SearchIndexItem&gt; tagSearchIndex;
230 
231     protected SortedSet&lt;SearchIndexItem&gt; typeSearchIndex;
232 
233     protected Map&lt;Character,List&lt;SearchIndexItem&gt;&gt; tagSearchIndexMap = new HashMap&lt;&gt;();
234 
235     protected Set&lt;Character&gt; tagSearchIndexKeys;
236 
237     public final Contents contents;
238 
239     protected final Messages messages;
240 
241     public DocPaths docPaths;
242 
243     public Map&lt;Element, List&lt;DocPath&gt;&gt; localStylesheetMap = new HashMap&lt;&gt;();
244 
245     /**
246      * Creates an object to hold the configuration for a doclet.
247      *
248      * @param doclet the doclet
249      */
250     public HtmlConfiguration(Doclet doclet) {
251         super(doclet);
252         resources = new Resources(this,
253                 BaseConfiguration.sharedResourceBundleName,
254                 &quot;jdk.javadoc.internal.doclets.formats.html.resources.standard&quot;);
255 
256         messages = new Messages(this);
257         contents = new Contents(this);
258 
259         String v;
260         try {
261             ResourceBundle rb = ResourceBundle.getBundle(versionBundleName, getLocale());
262             try {
263                 v = rb.getString(&quot;release&quot;);
264             } catch (MissingResourceException e) {
265                 v = defaultDocletVersion;
266             }
267         } catch (MissingResourceException e) {
268             v = defaultDocletVersion;
269         }
270         docletVersion = v;
271     }
272 
273     private static final String versionBundleName = &quot;jdk.javadoc.internal.tool.resources.version&quot;;
274     private static final String defaultDocletVersion = System.getProperty(&quot;java.version&quot;);
275     public final String docletVersion;
276 
277     @Override
278     public String getDocletVersion() {
279         return docletVersion;
280     }
281 
282     @Override
283     public Resources getResources() {
284         return resources;
285     }
286 
287     public Contents getContents() {
288         return contents;
289     }
290 
291     @Override
292     public Messages getMessages() {
293         return messages;
294     }
295 
296     protected boolean validateOptions() {
297         // check shared options
298         if (!generalValidOptions()) {
299             return false;
300         }
301 
302         // check if helpfile exists
303         if (!helpfile.isEmpty()) {
304             DocFile help = DocFile.createFileForInput(this, helpfile);
305             if (!help.exists()) {
306                 reporter.print(ERROR, resources.getText(&quot;doclet.File_not_found&quot;, helpfile));
307                 return false;
308             }
309         }
310         // check if stylesheetfile exists
311         if (!stylesheetfile.isEmpty()) {
312             DocFile stylesheet = DocFile.createFileForInput(this, stylesheetfile);
313             if (!stylesheet.exists()) {
314                 reporter.print(ERROR, resources.getText(&quot;doclet.File_not_found&quot;, stylesheetfile));
315                 return false;
316             }
317         }
318         // check if additional stylesheets exists
319         for (String ssheet : additionalStylesheets) {
320             DocFile ssfile = DocFile.createFileForInput(this, ssheet);
321             if (!ssfile.exists()) {
322                 reporter.print(ERROR, resources.getText(&quot;doclet.File_not_found&quot;, ssheet));
323                 return false;
324             }
325         }
326 
327         // In a more object-oriented world, this would be done by methods on the Option objects.
328         // Note that -windowtitle silently removes any and all HTML elements, and so does not need
329         // to be handled here.
330         utils.checkJavaScriptInOption(&quot;-header&quot;, header);
331         utils.checkJavaScriptInOption(&quot;-footer&quot;, footer);
332         utils.checkJavaScriptInOption(&quot;-top&quot;, top);
333         utils.checkJavaScriptInOption(&quot;-bottom&quot;, bottom);
334         utils.checkJavaScriptInOption(&quot;-doctitle&quot;, doctitle);
335         utils.checkJavaScriptInOption(&quot;-packagesheader&quot;, packagesheader);
336 
337         return true;
338     }
339 
340 
341     @Override
342     public boolean finishOptionSettings() {
343         if (!validateOptions()) {
344             return false;
345         }
346         if (!getSpecifiedTypeElements().isEmpty()) {
347             Map&lt;String, PackageElement&gt; map = new HashMap&lt;&gt;();
348             PackageElement pkg;
349             for (TypeElement aClass : getIncludedTypeElements()) {
350                 pkg = utils.containingPackage(aClass);
351                 if (!map.containsKey(utils.getPackageName(pkg))) {
352                     map.put(utils.getPackageName(pkg), pkg);
353                 }
354             }
355         }
356         docPaths = new DocPaths(utils, useModuleDirectories);
357         setCreateOverview();
358         setTopFile(docEnv);
359         workArounds.initDocLint(doclintOpts.values(), tagletManager.getAllTagletNames());
360         return true;
361     }
362 
363     /**
364      * Decide the page which will appear first in the right-hand frame. It will
365      * be &quot;overview-summary.html&quot; if &quot;-overview&quot; option is used or no
366      * &quot;-overview&quot; but the number of packages is more than one. It will be
367      * &quot;package-summary.html&quot; of the respective package if there is only one
368      * package to document. It will be a class page(first in the sorted order),
369      * if only classes are provided on the command line.
370      *
371      * @param docEnv the doclet environment
372      */
373     protected void setTopFile(DocletEnvironment docEnv) {
374         if (!checkForDeprecation(docEnv)) {
375             return;
376         }
377         if (createoverview) {
378             topFile = DocPaths.overviewSummary(frames);
379         } else {
380             if (showModules) {
381                 topFile = DocPath.empty.resolve(docPaths.moduleSummary(modules.first()));
382             } else if (packages.size() == 1 &amp;&amp; packages.first().isUnnamed()) {
383                 List&lt;TypeElement&gt; classes = new ArrayList&lt;&gt;(getIncludedTypeElements());
384                 if (!classes.isEmpty()) {
385                     TypeElement te = getValidClass(classes);
386                     topFile = docPaths.forClass(te);
387                 }
388             } else if (!packages.isEmpty()) {
389                 topFile = docPaths.forPackage(packages.first()).resolve(DocPaths.PACKAGE_SUMMARY);
390             }
391         }
392     }
393 
394     protected TypeElement getValidClass(List&lt;TypeElement&gt; classes) {
395         if (!nodeprecated) {
396             return classes.get(0);
397         }
398         for (TypeElement te : classes) {
399             if (!utils.isDeprecated(te)) {
400                 return te;
401             }
402         }
403         return null;
404     }
405 
406     protected boolean checkForDeprecation(DocletEnvironment docEnv) {
407         for (TypeElement te : getIncludedTypeElements()) {
408             if (isGeneratedDoc(te)) {
409                 return true;
410             }
411         }
412         return false;
413     }
414 
415     /**
416      * Generate &quot;overview.html&quot; page if option &quot;-overview&quot; is used or number of
417      * packages is more than one. Sets {@link #createoverview} field to true.
418      */
419     protected void setCreateOverview() {
420         if (!nooverview) {
421             if (overviewpath != null
422                     || modules.size() &gt; 1
423                     || (modules.isEmpty() &amp;&amp; packages.size() &gt; 1)) {
424                 createoverview = true;
425             }
426         }
427     }
428 
429     /**
430      * {@inheritDoc}
431      */
432     @Override
433     public WriterFactory getWriterFactory() {
434         return new WriterFactoryImpl(this);
435     }
436 
437     /**
438      * {@inheritDoc}
439      */
440     @Override
441     public Locale getLocale() {
442         if (locale == null)
443             return Locale.getDefault();
444         return locale;
445     }
446 
447     /**
448      * Return the path of the overview file or null if it does not exist.
449      *
450      * @return the path of the overview file or null if it does not exist.
451      */
452     @Override
453     public JavaFileObject getOverviewPath() {
454         if (overviewpath != null &amp;&amp; getFileManager() instanceof StandardJavaFileManager) {
455             StandardJavaFileManager fm = (StandardJavaFileManager) getFileManager();
456             return fm.getJavaFileObjects(overviewpath).iterator().next();
457         }
458         return null;
459     }
460 
461     public DocFile getMainStylesheet() {
462         return stylesheetfile.isEmpty() ? null : DocFile.createFileForInput(this, stylesheetfile);
463     }
464 
465     public List&lt;DocFile&gt; getAdditionalStylesheets() {
466         return additionalStylesheets.stream()
467                 .map(ssf -&gt; DocFile.createFileForInput(this, ssf))
468                 .collect(Collectors.toList());
469     }
470 
471     /**
472      * {@inheritDoc}
473      */
474     @Override
475     public JavaFileManager getFileManager() {
476         return docEnv.getJavaFileManager();
477     }
478 
479     @Override
480     public boolean showMessage(DocTreePath path, String key) {
481         return (path == null || workArounds.haveDocLint());
482     }
483 
484     @Override
485     public boolean showMessage(Element e, String key) {
486         return (e == null || workArounds.haveDocLint());
487     }
488 
489     protected void buildSearchTagIndex() {
490         for (SearchIndexItem sii : tagSearchIndex) {
491             String tagLabel = sii.getLabel();
492             Character unicode = (tagLabel.length() == 0)
493                     ? &#39;*&#39;
494                     : Character.toUpperCase(tagLabel.charAt(0));
495             List&lt;SearchIndexItem&gt; list = tagSearchIndexMap.get(unicode);
496             if (list == null) {
497                 list = new ArrayList&lt;&gt;();
498                 tagSearchIndexMap.put(unicode, list);
499             }
500             list.add(sii);
501         }
502         tagSearchIndexKeys = tagSearchIndexMap.keySet();
503     }
504 
505     @Override
506     public Set&lt;Doclet.Option&gt; getSupportedOptions() {
507         Resources resources = getResources();
508         Doclet.Option[] options = {
509             new Option(resources, &quot;--add-stylesheet&quot;, 1) {
510                 @Override
511                 public boolean process(String opt, List&lt;String&gt; args) {
512                     additionalStylesheets.add(args.get(0));
513                     return true;
514                 }
515             },
516             new Option(resources, &quot;-bottom&quot;, 1) {
517                 @Override
518                 public boolean process(String opt,  List&lt;String&gt; args) {
519                     bottom = args.get(0);
520                     return true;
521                 }
522             },
523             new Option(resources, &quot;-charset&quot;, 1) {
524                 @Override
525                 public boolean process(String opt,  List&lt;String&gt; args) {
526                     charset = args.get(0);
527                     return true;
528                 }
529             },
530             new Option(resources, &quot;-doctitle&quot;, 1) {
531                 @Override
532                 public boolean process(String opt,  List&lt;String&gt; args) {
533                     doctitle = args.get(0);
534                     return true;
535                 }
536             },
537             new Option(resources, &quot;-footer&quot;, 1) {
538                 @Override
539                 public boolean process(String opt, List&lt;String&gt; args) {
540                     footer = args.get(0);
541                     return true;
542                 }
543             },
544             new Option(resources, &quot;-header&quot;, 1) {
545                 @Override
546                 public boolean process(String opt,  List&lt;String&gt; args) {
547                     header = args.get(0);
548                     return true;
549                 }
550             },
551             new Option(resources, &quot;-helpfile&quot;, 1) {
552                 @Override
553                 public boolean process(String opt,  List&lt;String&gt; args) {
554                     if (nohelp == true) {
555                         reporter.print(ERROR, resources.getText(&quot;doclet.Option_conflict&quot;,
556                                 &quot;-helpfile&quot;, &quot;-nohelp&quot;));
557                         return false;
558                     }
559                     if (!helpfile.isEmpty()) {
560                         reporter.print(ERROR, resources.getText(&quot;doclet.Option_reuse&quot;,
561                                 &quot;-helpfile&quot;));
562                         return false;
563                     }
564                     helpfile = args.get(0);
565                     return true;
566                 }
567             },
568             new Option(resources, &quot;-html5&quot;) {
569                 @Override
570                 public boolean process(String opt,  List&lt;String&gt; args) {
571                     return true;
572                 }
573             },
574             new Option(resources, &quot;-nohelp&quot;) {
575                 @Override
576                 public boolean process(String opt, List&lt;String&gt; args) {
577                     nohelp = true;
578                     if (!helpfile.isEmpty()) {
579                         reporter.print(ERROR, resources.getText(&quot;doclet.Option_conflict&quot;,
580                                 &quot;-nohelp&quot;, &quot;-helpfile&quot;));
581                         return false;
582                     }
583                     return true;
584                 }
585             },
586             new Option(resources, &quot;-nodeprecatedlist&quot;) {
587                 @Override
588                 public boolean process(String opt,  List&lt;String&gt; args) {
589                     nodeprecatedlist = true;
590                     return true;
591                 }
592             },
593             new Option(resources, &quot;-noindex&quot;) {
594                 @Override
595                 public boolean process(String opt,  List&lt;String&gt; args) {
596                     createindex = false;
597                     if (splitindex == true) {
598                         reporter.print(ERROR, resources.getText(&quot;doclet.Option_conflict&quot;,
599                                 &quot;-noindex&quot;, &quot;-splitindex&quot;));
600                         return false;
601                     }
602                     return true;
603                 }
604             },
605             new Option(resources, &quot;-nonavbar&quot;) {
606                 @Override
607                 public boolean process(String opt,  List&lt;String&gt; args) {
608                     nonavbar = true;
609                     return true;
610                 }
611             },
612             new Hidden(resources, &quot;-nooverview&quot;) {
613                 @Override
614                 public boolean process(String opt,  List&lt;String&gt; args) {
615                     nooverview = true;
616                     if (overviewpath != null) {
617                         reporter.print(ERROR, resources.getText(&quot;doclet.Option_conflict&quot;,
618                                 &quot;-nooverview&quot;, &quot;-overview&quot;));
619                         return false;
620                     }
621                     return true;
622                 }
623             },
624             new Option(resources, &quot;-notree&quot;) {
625                 @Override
626                 public boolean process(String opt,  List&lt;String&gt; args) {
627                     createtree = false;
628                     return true;
629                 }
630             },
631             new Option(resources, &quot;-overview&quot;, 1) {
632                 @Override
633                 public boolean process(String opt,  List&lt;String&gt; args) {
634                     overviewpath = args.get(0);
635                     if (nooverview == true) {
636                         reporter.print(ERROR, resources.getText(&quot;doclet.Option_conflict&quot;,
637                                 &quot;-overview&quot;, &quot;-nooverview&quot;));
638                         return false;
639                     }
640                     return true;
641                 }
642             },
643             new Option(resources, &quot;--frames&quot;) {
644                 @Override
645                 public boolean process(String opt,  List&lt;String&gt; args) {
646                     reporter.print(WARNING, resources.getText(&quot;doclet.Frames_specified&quot;, helpfile));
647                     frames = true;
648                     return true;
649                 }
650             },
651             new Option(resources, &quot;--no-frames&quot;) {
652                 @Override
653                 public boolean process(String opt,  List&lt;String&gt; args) {
654                     frames = false;
655                     return true;
656                 }
657             },
658             new Hidden(resources, &quot;-packagesheader&quot;, 1) {
659                 @Override
660                 public boolean process(String opt,  List&lt;String&gt; args) {
661                     packagesheader = args.get(0);
662                     return true;
663                 }
664             },
665             new Option(resources, &quot;-splitindex&quot;) {
666                 @Override
667                 public boolean process(String opt, List&lt;String&gt; args) {
668                     splitindex = true;
669                     if (createindex == false) {
670                         reporter.print(ERROR, resources.getText(&quot;doclet.Option_conflict&quot;,
671                                 &quot;-splitindex&quot;, &quot;-noindex&quot;));
672                         return false;
673                     }
674                     return true;
675                 }
676             },
677             new Option(resources, &quot;--main-stylesheet -stylesheetfile&quot;, 1) {
678                 @Override
679                 public boolean process(String opt,  List&lt;String&gt; args) {
680                     stylesheetfile = args.get(0);
681                     return true;
682                 }
683             },
684             new Option(resources, &quot;-top&quot;, 1) {
685                 @Override
686                 public boolean process(String opt,  List&lt;String&gt; args) {
687                     top = args.get(0);
688                     return true;
689                 }
690             },
691             new Option(resources, &quot;-use&quot;) {
692                 @Override
693                 public boolean process(String opt,  List&lt;String&gt; args) {
694                     classuse = true;
695                     return true;
696                 }
697             },
698             new Option(resources, &quot;-windowtitle&quot;, 1) {
699                 @Override
700                 public boolean process(String opt,  List&lt;String&gt; args) {
701                     windowtitle = args.get(0).replaceAll(&quot;\\&lt;.*?&gt;&quot;, &quot;&quot;);
702                     return true;
703                 }
704             },
705             new XOption(resources, &quot;-Xdoclint&quot;) {
706                 @Override
707                 public boolean process(String opt,  List&lt;String&gt; args) {
708                     doclintOpts.put(this, DocLint.XMSGS_OPTION);
709                     return true;
710                 }
711             },
712             new XOption(resources, &quot;-Xdocrootparent&quot;, 1) {
713                 @Override
714                 public boolean process(String opt, List&lt;String&gt; args) {
715                     docrootparent = args.get(0);
716                     try {
717                         URL ignored = new URL(docrootparent);
718                     } catch (MalformedURLException e) {
719                         reporter.print(ERROR, resources.getText(&quot;doclet.MalformedURL&quot;, docrootparent));
720                         return false;
721                     }
722                     return true;
723                 }
724             },
725             new XOption(resources, &quot;doclet.usage.xdoclint-extended&quot;, &quot;-Xdoclint:&quot;, 0) {
726                 @Override
727                 public boolean process(String opt,  List&lt;String&gt; args) {
728                     String dopt = opt.replace(&quot;-Xdoclint:&quot;, DocLint.XMSGS_CUSTOM_PREFIX);
729                     doclintOpts.put(this, dopt);
730                     if (dopt.contains(&quot;/&quot;)) {
731                         reporter.print(ERROR, resources.getText(&quot;doclet.Option_doclint_no_qualifiers&quot;));
732                         return false;
733                     }
734                     if (!DocLint.isValidOption(dopt)) {
735                         reporter.print(ERROR, resources.getText(&quot;doclet.Option_doclint_invalid_arg&quot;));
736                         return false;
737                     }
738                     return true;
739                 }
740             },
741             new XOption(resources, &quot;doclet.usage.xdoclint-package&quot;, &quot;-Xdoclint/package:&quot;, 0) {
742                 @Override
743                 public boolean process(String opt,  List&lt;String&gt; args) {
744                     String dopt = opt.replace(&quot;-Xdoclint/package:&quot;, DocLint.XCHECK_PACKAGE);
745                     doclintOpts.put(this, dopt);
746                     if (!DocLint.isValidOption(dopt)) {
747                         reporter.print(ERROR, resources.getText(&quot;doclet.Option_doclint_package_invalid_arg&quot;));
748                         return false;
749                     }
750                     return true;
751                 }
752             }
753         };
754         Set&lt;Doclet.Option&gt; oset = new TreeSet&lt;&gt;();
755         oset.addAll(Arrays.asList(options));
756         oset.addAll(super.getSupportedOptions());
757         return oset;
758     }
759 
760     @Override
761     protected boolean finishOptionSettings0() throws DocletException {
762         if (docencoding == null) {
763             if (charset == null) {
764                 docencoding = charset = (encoding == null) ? HTML_DEFAULT_CHARSET : encoding;
765             } else {
766                 docencoding = charset;
767             }
768         } else {
769             if (charset == null) {
770                 charset = docencoding;
771             } else if (!charset.equals(docencoding)) {
772                 reporter.print(ERROR, resources.getText(&quot;doclet.Option_conflict&quot;, &quot;-charset&quot;, &quot;-docencoding&quot;));
773                 return false;
774             }
775         }
776         return super.finishOptionSettings0();
777     }
778 
779     @Override
780     protected void initConfiguration(DocletEnvironment docEnv) {
781         super.initConfiguration(docEnv);
782         memberSearchIndex = new TreeSet&lt;&gt;(utils.makeGenericSearchIndexComparator());
783         moduleSearchIndex = new TreeSet&lt;&gt;(utils.makeGenericSearchIndexComparator());
784         packageSearchIndex = new TreeSet&lt;&gt;(utils.makeGenericSearchIndexComparator());
785         tagSearchIndex = new TreeSet&lt;&gt;(utils.makeGenericSearchIndexComparator());
786         typeSearchIndex = new TreeSet&lt;&gt;(utils.makeTypeSearchIndexComparator());
787     }
788 }
    </pre>
  </body>
</html>