<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/PackageWriterImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="PackageUseWriter.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="PropertyWriterImpl.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/PackageWriterImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 1997, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -23,31 +23,34 @@</span>
   * questions.
   */
  
  package jdk.javadoc.internal.doclets.formats.html;
  
<span class="udiff-line-modified-removed">- import jdk.javadoc.internal.doclets.formats.html.markup.Table;</span>
<span class="udiff-line-modified-removed">- import jdk.javadoc.internal.doclets.formats.html.markup.TableHeader;</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- import java.util.*;</span>
<span class="udiff-line-modified-added">+ import java.util.List;</span>
<span class="udiff-line-modified-added">+ import java.util.SortedSet;</span>
  
  import javax.lang.model.element.ModuleElement;
  import javax.lang.model.element.PackageElement;
  import javax.lang.model.element.TypeElement;
  
  import com.sun.source.doctree.DocTree;
<span class="udiff-line-added">+ import jdk.javadoc.internal.doclets.formats.html.markup.BodyContents;</span>
  import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;
<span class="udiff-line-added">+ import jdk.javadoc.internal.doclets.formats.html.markup.Entity;</span>
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlStyle;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTag;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTree;
  import jdk.javadoc.internal.doclets.formats.html.markup.Navigation;
  import jdk.javadoc.internal.doclets.formats.html.markup.Navigation.PageMode;
  import jdk.javadoc.internal.doclets.formats.html.markup.StringContent;
<span class="udiff-line-added">+ import jdk.javadoc.internal.doclets.formats.html.markup.Table;</span>
<span class="udiff-line-added">+ import jdk.javadoc.internal.doclets.formats.html.markup.TableHeader;</span>
  import jdk.javadoc.internal.doclets.toolkit.Content;
  import jdk.javadoc.internal.doclets.toolkit.PackageSummaryWriter;
  import jdk.javadoc.internal.doclets.toolkit.util.CommentHelper;
  import jdk.javadoc.internal.doclets.toolkit.util.DocFileIOException;
<span class="udiff-line-added">+ import jdk.javadoc.internal.doclets.toolkit.util.DocPath;</span>
  import jdk.javadoc.internal.doclets.toolkit.util.DocPaths;
  
  /**
   * Class to generate file for each package contents in the right-hand
   * frame. This will list all the Class Kinds in the package. A click on any
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -55,34 +58,28 @@</span>
   *
   *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
   *  If you write code that depends on this, you do so at your own risk.
   *  This code and its internal interfaces are subject to change or
   *  deletion without notice.&lt;/b&gt;
<span class="udiff-line-removed">-  *</span>
<span class="udiff-line-removed">-  * @author Atul M Dambalkar</span>
<span class="udiff-line-removed">-  * @author Bhavesh Patel (Modified)</span>
   */
  public class PackageWriterImpl extends HtmlDocletWriter
      implements PackageSummaryWriter {
  
      /**
       * The package being documented.
       */
      protected PackageElement packageElement;
  
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * The HTML tree for main tag.</span>
<span class="udiff-line-removed">-      */</span>
<span class="udiff-line-removed">-     protected HtmlTree mainTree = HtmlTree.MAIN();</span>
<span class="udiff-line-removed">- </span>
      /**
       * The HTML tree for section tag.
       */
<span class="udiff-line-modified-removed">-     protected HtmlTree sectionTree = HtmlTree.SECTION();</span>
<span class="udiff-line-modified-added">+     protected HtmlTree sectionTree = HtmlTree.SECTION(HtmlStyle.packageDescription, new ContentBuilder());</span>
  
      private final Navigation navBar;
  
<span class="udiff-line-added">+     private final BodyContents bodyContents = new BodyContents();</span>
<span class="udiff-line-added">+ </span>
      /**
       * Constructor to construct PackageWriter object and to generate
       * &quot;package-summary.html&quot; file in the respective package directory.
       * For example for package &quot;java.lang&quot; this will generate file
       * &quot;package-summary.html&quot; file in the &quot;java/lang&quot; directory. It will also
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -95,54 +92,48 @@</span>
      public PackageWriterImpl(HtmlConfiguration configuration, PackageElement packageElement) {
          super(configuration,
                  configuration.docPaths.forPackage(packageElement)
                  .resolve(DocPaths.PACKAGE_SUMMARY));
          this.packageElement = packageElement;
<span class="udiff-line-modified-removed">-         this.navBar = new Navigation(packageElement, configuration, fixedNavDiv, PageMode.PACKAGE, path);</span>
<span class="udiff-line-modified-added">+         this.navBar = new Navigation(packageElement, configuration, PageMode.PACKAGE, path);</span>
      }
  
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * {@inheritDoc}</span>
<span class="udiff-line-removed">-      */</span>
      @Override
      public Content getPackageHeader(String heading) {
<span class="udiff-line-modified-removed">-         HtmlTree bodyTree = getBody(true, getWindowTitle(utils.getPackageName(packageElement)));</span>
<span class="udiff-line-modified-removed">-         HtmlTree htmlTree = HtmlTree.HEADER();</span>
<span class="udiff-line-modified-removed">-         addTop(htmlTree);</span>
<span class="udiff-line-modified-added">+         HtmlTree bodyTree = getBody(getWindowTitle(utils.getPackageName(packageElement)));</span>
<span class="udiff-line-modified-added">+         Content headerContent = new ContentBuilder();</span>
<span class="udiff-line-modified-added">+         addTop(headerContent);</span>
          Content linkContent = getModuleLink(utils.elementUtils.getModuleOf(packageElement),
                  contents.moduleLabel);
          navBar.setNavLinkModule(linkContent);
          navBar.setUserHeader(getUserHeaderFooter(true));
<span class="udiff-line-modified-removed">-         htmlTree.add(navBar.getContent(true));</span>
<span class="udiff-line-removed">-         bodyTree.add(htmlTree);</span>
<span class="udiff-line-modified-added">+         headerContent.add(navBar.getContent(true));</span>
          HtmlTree div = new HtmlTree(HtmlTag.DIV);
          div.setStyle(HtmlStyle.header);
          if (configuration.showModules) {
              ModuleElement mdle = configuration.docEnv.getElementUtils().getModuleOf(packageElement);
              Content classModuleLabel = HtmlTree.SPAN(HtmlStyle.moduleLabelInPackage, contents.moduleLabel);
              Content moduleNameDiv = HtmlTree.DIV(HtmlStyle.subTitle, classModuleLabel);
<span class="udiff-line-modified-removed">-             moduleNameDiv.add(Contents.SPACE);</span>
<span class="udiff-line-modified-added">+             moduleNameDiv.add(Entity.NO_BREAK_SPACE);</span>
              moduleNameDiv.add(getModuleLink(mdle,
                      new StringContent(mdle.getQualifiedName().toString())));
              div.add(moduleNameDiv);
          }
          Content annotationContent = new HtmlTree(HtmlTag.P);
          addAnnotationInfo(packageElement, annotationContent);
          div.add(annotationContent);
          Content tHeading = HtmlTree.HEADING(Headings.PAGE_TITLE_HEADING, true,
                  HtmlStyle.title, contents.packageLabel);
<span class="udiff-line-modified-removed">-         tHeading.add(Contents.SPACE);</span>
<span class="udiff-line-modified-added">+         tHeading.add(Entity.NO_BREAK_SPACE);</span>
          Content packageHead = new StringContent(heading);
          tHeading.add(packageHead);
          div.add(tHeading);
<span class="udiff-line-modified-removed">-         mainTree.add(div);</span>
<span class="udiff-line-modified-added">+         bodyContents.setHeader(headerContent)</span>
<span class="udiff-line-added">+                 .addMainContent(div);</span>
          return bodyTree;
      }
  
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * {@inheritDoc}</span>
<span class="udiff-line-removed">-      */</span>
      @Override
      public Content getContentHeader() {
          HtmlTree div = new HtmlTree(HtmlTag.DIV);
          div.setStyle(HtmlStyle.contentContainer);
          return div;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -160,77 +151,62 @@</span>
              HtmlTree deprDiv = new HtmlTree(HtmlTag.DIV);
              deprDiv.setStyle(HtmlStyle.deprecationBlock);
              Content deprPhrase = HtmlTree.SPAN(HtmlStyle.deprecatedLabel, getDeprecatedPhrase(packageElement));
              deprDiv.add(deprPhrase);
              if (!deprs.isEmpty()) {
<span class="udiff-line-modified-removed">-                 List&lt;? extends DocTree&gt; commentTags = ch.getDescription(configuration, deprs.get(0));</span>
<span class="udiff-line-modified-added">+                 List&lt;? extends DocTree&gt; commentTags = ch.getDescription(deprs.get(0));</span>
                  if (!commentTags.isEmpty()) {
                      addInlineDeprecatedComment(packageElement, deprs.get(0), deprDiv);
                  }
              }
              div.add(deprDiv);
          }
      }
  
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * {@inheritDoc}</span>
<span class="udiff-line-removed">-      */</span>
      @Override
      public Content getSummaryHeader() {
          HtmlTree ul = new HtmlTree(HtmlTag.UL);
          ul.setStyle(HtmlStyle.blockList);
          return ul;
      }
  
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * {@inheritDoc}</span>
<span class="udiff-line-removed">-      */</span>
      @Override
      public void addInterfaceSummary(SortedSet&lt;TypeElement&gt; interfaces, Content summaryContentTree) {
          TableHeader tableHeader= new TableHeader(contents.interfaceLabel, contents.descriptionLabel);
          addClassesSummary(interfaces, resources.interfaceSummary, tableHeader, summaryContentTree);
      }
  
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * {@inheritDoc}</span>
<span class="udiff-line-removed">-      */</span>
      @Override
      public void addClassSummary(SortedSet&lt;TypeElement&gt; classes, Content summaryContentTree) {
          TableHeader tableHeader= new TableHeader(contents.classLabel, contents.descriptionLabel);
          addClassesSummary(classes, resources.classSummary, tableHeader, summaryContentTree);
      }
  
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * {@inheritDoc}</span>
<span class="udiff-line-removed">-      */</span>
      @Override
      public void addEnumSummary(SortedSet&lt;TypeElement&gt; enums, Content summaryContentTree) {
          TableHeader tableHeader= new TableHeader(contents.enum_, contents.descriptionLabel);
          addClassesSummary(enums, resources.enumSummary, tableHeader, summaryContentTree);
      }
  
<span class="udiff-line-modified-removed">-     /**</span>
<span class="udiff-line-modified-removed">-      * {@inheritDoc}</span>
<span class="udiff-line-modified-removed">-      */</span>
<span class="udiff-line-modified-added">+     @Override</span>
<span class="udiff-line-modified-added">+     public void addRecordSummary(SortedSet&lt;TypeElement&gt; records, Content summaryContentTree) {</span>
<span class="udiff-line-modified-added">+         TableHeader tableHeader= new TableHeader(contents.record, contents.descriptionLabel);</span>
<span class="udiff-line-added">+         addClassesSummary(records, resources.recordSummary, tableHeader, summaryContentTree);</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
      @Override
      public void addExceptionSummary(SortedSet&lt;TypeElement&gt; exceptions, Content summaryContentTree) {
          TableHeader tableHeader= new TableHeader(contents.exception, contents.descriptionLabel);
          addClassesSummary(exceptions, resources.exceptionSummary, tableHeader, summaryContentTree);
      }
  
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * {@inheritDoc}</span>
<span class="udiff-line-removed">-      */</span>
      @Override
      public void addErrorSummary(SortedSet&lt;TypeElement&gt; errors, Content summaryContentTree) {
          TableHeader tableHeader= new TableHeader(contents.error, contents.descriptionLabel);
          addClassesSummary(errors, resources.errorSummary, tableHeader, summaryContentTree);
      }
  
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * {@inheritDoc}</span>
<span class="udiff-line-removed">-      */</span>
      @Override
      public void addAnnotationTypeSummary(SortedSet&lt;TypeElement&gt; annoTypes, Content summaryContentTree) {
          TableHeader tableHeader= new TableHeader(contents.annotationType, contents.descriptionLabel);
          addClassesSummary(annoTypes, resources.annotationTypeSummary, tableHeader, summaryContentTree);
      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -264,60 +240,50 @@</span>
              Content li = HtmlTree.LI(HtmlStyle.blockList, table.toContent());
              summaryContentTree.add(li);
          }
      }
  
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * {@inheritDoc}</span>
<span class="udiff-line-removed">-      */</span>
      @Override
      public void addPackageDescription(Content packageContentTree) {
          if (!utils.getBody(packageElement).isEmpty()) {
<span class="udiff-line-modified-removed">-             Content tree = sectionTree;</span>
<span class="udiff-line-modified-removed">-             tree.add(links.createAnchor(SectionName.PACKAGE_DESCRIPTION));</span>
<span class="udiff-line-modified-added">+             HtmlTree tree = sectionTree;</span>
<span class="udiff-line-modified-added">+             tree.setId(SectionName.PACKAGE_DESCRIPTION.getName());</span>
              addDeprecationInfo(tree);
              addInlineComment(packageElement, tree);
          }
      }
  
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * {@inheritDoc}</span>
<span class="udiff-line-removed">-      */</span>
      @Override
      public void addPackageTags(Content packageContentTree) {
          Content htmlTree = sectionTree;
          addTagsInfo(packageElement, htmlTree);
          packageContentTree.add(sectionTree);
      }
  
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * {@inheritDoc}</span>
<span class="udiff-line-removed">-      */</span>
      @Override
<span class="udiff-line-modified-removed">-     public void addPackageContent(Content contentTree, Content packageContentTree) {</span>
<span class="udiff-line-modified-removed">-         mainTree.add(packageContentTree);</span>
<span class="udiff-line-removed">-         contentTree.add(mainTree);</span>
<span class="udiff-line-modified-added">+     public void addPackageContent(Content packageContentTree) {</span>
<span class="udiff-line-modified-added">+         bodyContents.addMainContent(packageContentTree);</span>
      }
  
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * {@inheritDoc}</span>
<span class="udiff-line-removed">-      */</span>
      @Override
<span class="udiff-line-modified-removed">-     public void addPackageFooter(Content contentTree) {</span>
<span class="udiff-line-modified-added">+     public void addPackageFooter() {</span>
          Content htmlTree = HtmlTree.FOOTER();
          navBar.setUserFooter(getUserHeaderFooter(false));
          htmlTree.add(navBar.getContent(false));
          addBottom(htmlTree);
<span class="udiff-line-modified-removed">-         contentTree.add(htmlTree);</span>
<span class="udiff-line-modified-added">+         bodyContents.setFooter(htmlTree);</span>
      }
  
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * {@inheritDoc}</span>
<span class="udiff-line-removed">-      */</span>
      @Override
      public void printDocument(Content contentTree) throws DocFileIOException {
          String description = getDescription(&quot;declaration&quot;, packageElement);
<span class="udiff-line-modified-removed">-         Content stylesheetContent = getLocalStylesheetContent(packageElement);</span>
<span class="udiff-line-modified-added">+         List&lt;DocPath&gt; localStylesheets = getLocalStylesheets(packageElement);</span>
<span class="udiff-line-added">+         contentTree.add(bodyContents.toContent());</span>
          printHtmlDocument(configuration.metakeywords.getMetaKeywords(packageElement),
<span class="udiff-line-modified-removed">-                 description, stylesheetContent, contentTree);</span>
<span class="udiff-line-modified-added">+                 description, localStylesheets, contentTree);</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     @Override</span>
<span class="udiff-line-added">+     public Content getPackageSummary(Content summaryContentTree) {</span>
<span class="udiff-line-added">+         return HtmlTree.SECTION(HtmlStyle.summary, summaryContentTree);</span>
      }
  }
</pre>
<center><a href="PackageUseWriter.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="PropertyWriterImpl.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>