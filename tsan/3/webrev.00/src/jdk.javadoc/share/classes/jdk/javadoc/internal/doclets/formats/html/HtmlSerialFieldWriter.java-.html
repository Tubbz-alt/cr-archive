<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/HtmlSerialFieldWriter.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 1998, 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package jdk.javadoc.internal.doclets.formats.html;
 27 
 28 import java.util.*;
 29 
 30 import javax.lang.model.element.TypeElement;
 31 import javax.lang.model.element.VariableElement;
 32 import javax.lang.model.type.TypeMirror;
 33 
 34 import com.sun.source.doctree.DocTree;
 35 
 36 import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;
 37 import jdk.javadoc.internal.doclets.formats.html.markup.HtmlStyle;
 38 import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTag;
 39 import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTree;
 40 import jdk.javadoc.internal.doclets.formats.html.markup.RawHtml;
 41 import jdk.javadoc.internal.doclets.formats.html.markup.StringContent;
 42 import jdk.javadoc.internal.doclets.toolkit.Content;
 43 import jdk.javadoc.internal.doclets.toolkit.SerializedFormWriter;
 44 import jdk.javadoc.internal.doclets.toolkit.taglets.TagletWriter;
 45 import jdk.javadoc.internal.doclets.toolkit.util.CommentHelper;
 46 
 47 /**
 48  * Generate serialized form for serializable fields.
 49  * Documentation denoted by the tags &lt;code&gt;serial&lt;/code&gt; and
 50  * &lt;code&gt;serialField&lt;/code&gt; is processed.
 51  *
 52  *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
 53  *  If you write code that depends on this, you do so at your own risk.
 54  *  This code and its internal interfaces are subject to change or
 55  *  deletion without notice.&lt;/b&gt;
 56  *
 57  * @author Joe Fialli
 58  * @author Bhavesh Patel (Modified)
 59  */
 60 public class HtmlSerialFieldWriter extends FieldWriterImpl
 61         implements SerializedFormWriter.SerialFieldWriter {
 62 
 63     public HtmlSerialFieldWriter(SubWriterHolderWriter writer, TypeElement typeElement) {
 64         super(writer, typeElement);
 65     }
 66 
 67     public SortedSet&lt;VariableElement&gt; members(TypeElement te) {
 68         return utils.serializableFields(te);
 69     }
 70 
 71     /**
 72      * Return the header for serializable fields section.
 73      *
 74      * @return a content tree for the header
 75      */
 76     public Content getSerializableFieldsHeader() {
 77         HtmlTree ul = new HtmlTree(HtmlTag.UL);
 78         ul.setStyle(HtmlStyle.blockList);
 79         return ul;
 80     }
 81 
 82     /**
 83      * Return the header for serializable fields content section.
 84      *
 85      * @param isLastContent true if the cotent being documented is the last content.
 86      * @return a content tree for the header
 87      */
 88     public Content getFieldsContentHeader(boolean isLastContent) {
 89         HtmlTree li = new HtmlTree(HtmlTag.LI);
 90         if (isLastContent)
 91             li.setStyle(HtmlStyle.blockListLast);
 92         else
 93             li.setStyle(HtmlStyle.blockList);
 94         return li;
 95     }
 96 
 97     /**
 98      * Add serializable fields.
 99      *
100      * @param heading the heading for the section
101      * @param serializableFieldsTree the tree to be added to the serializable fileds
102      *        content tree
103      * @return a content tree for the serializable fields content
104      */
105     public Content getSerializableFields(String heading, Content serializableFieldsTree) {
106         HtmlTree li = new HtmlTree(HtmlTag.LI);
107         li.setStyle(HtmlStyle.blockList);
108         if (serializableFieldsTree.isValid()) {
109             Content headingContent = new StringContent(heading);
110             Content serialHeading = HtmlTree.HEADING(Headings.SerializedForm.CLASS_SUBHEADING, headingContent);
111             li.add(serialHeading);
112             li.add(serializableFieldsTree);
113         }
114         return li;
115     }
116 
117     @Override
118     public void addMemberHeader(TypeElement fieldType, String fieldTypeStr,
119             String fieldDimensions, String fieldName, Content contentTree) {
120         Content nameContent = new StringContent(fieldName);
121         Content heading = HtmlTree.HEADING(Headings.SerializedForm.MEMBER_HEADING, nameContent);
122         contentTree.add(heading);
123         Content pre = new HtmlTree(HtmlTag.PRE);
124         if (fieldType == null) {
125             pre.add(fieldTypeStr);
126         } else {
127             Content fieldContent = writer.getLink(new LinkInfoImpl(
128                     configuration, LinkInfoImpl.Kind.SERIAL_MEMBER, fieldType));
129             pre.add(fieldContent);
130         }
131         pre.add(fieldDimensions + &quot; &quot;);
132         pre.add(fieldName);
133         contentTree.add(pre);
134     }
135 
136     @Override
137     public void addMemberHeader(TypeMirror fieldType, String fieldName, Content contentTree) {
138         Content nameContent = new StringContent(fieldName);
139         Content heading = HtmlTree.HEADING(HtmlTag.H5, nameContent);
140         contentTree.add(heading);
141         Content pre = new HtmlTree(HtmlTag.PRE);
142         Content fieldContent = writer.getLink(new LinkInfoImpl(
143                 configuration, LinkInfoImpl.Kind.SERIAL_MEMBER, fieldType));
144         pre.add(fieldContent);
145         pre.add(&quot; &quot;);
146         pre.add(fieldName);
147         contentTree.add(pre);
148     }
149 
150     /**
151      * Add the deprecated information for this member.
152      *
153      * @param field the field to document.
154      * @param contentTree the tree to which the deprecated info will be added
155      */
156     public void addMemberDeprecatedInfo(VariableElement field, Content contentTree) {
157         addDeprecatedInfo(field, contentTree);
158     }
159 
160     /**
161      * Add the description text for this member.
162      *
163      * @param field the field to document.
164      * @param contentTree the tree to which the deprecated info will be added
165      */
166     public void addMemberDescription(VariableElement field, Content contentTree) {
167         if (!utils.getFullBody(field).isEmpty()) {
168             writer.addInlineComment(field, contentTree);
169         }
170         List&lt;? extends DocTree&gt; tags = utils.getBlockTags(field, DocTree.Kind.SERIAL);
171         if (!tags.isEmpty()) {
172             writer.addInlineComment(field, tags.get(0), contentTree);
173         }
174     }
175 
176     /**
177      * Add the description text for this member represented by the tag.
178      *
179      * @param serialFieldTag the field to document (represented by tag)
180      * @param contentTree the tree to which the deprecated info will be added
181      */
182     public void addMemberDescription(VariableElement field, DocTree serialFieldTag, Content contentTree) {
183         CommentHelper ch = utils.getCommentHelper(field);
184         List&lt;? extends DocTree&gt; description = ch.getDescription(configuration, serialFieldTag);
185         if (!description.isEmpty()) {
186             Content serialFieldContent = new RawHtml(ch.getText(description));
187             Content div = HtmlTree.DIV(HtmlStyle.block, serialFieldContent);
188             contentTree.add(div);
189         }
190     }
191 
192     /**
193      * Add the tag information for this member.
194      *
195      * @param field the field to document.
196      * @param contentTree the tree to which the member tags info will be added
197      */
198     public void addMemberTags(VariableElement field, Content contentTree) {
199         Content tagContent = new ContentBuilder();
200         TagletWriter.genTagOutput(configuration.tagletManager, field,
201                 configuration.tagletManager.getBlockTaglets(field),
202                 writer.getTagletWriterInstance(false), tagContent);
203         Content dlTags = new HtmlTree(HtmlTag.DL);
204         dlTags.add(tagContent);
205         contentTree.add(dlTags);  // TODO: what if empty?
206     }
207 
208     /**
209      * Check to see if overview details should be printed. If
210      * nocomment option set or if there is no text to be printed
211      * for deprecation info, comment or tags, do not print overview details.
212      *
213      * @param field the field to check overview details for.
214      * @return true if overview details need to be printed
215      */
216     public boolean shouldPrintOverview(VariableElement field) {
217         if (!configuration.nocomment) {
218             if(!utils.getFullBody(field).isEmpty() ||
219                     writer.hasSerializationOverviewTags(field))
220                 return true;
221         }
222         if (utils.isDeprecated(field))
223             return true;
224         return false;
225     }
226 }
    </pre>
  </body>
</html>