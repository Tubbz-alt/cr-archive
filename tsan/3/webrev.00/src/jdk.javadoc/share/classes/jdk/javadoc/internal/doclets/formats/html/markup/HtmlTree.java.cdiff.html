<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/markup/HtmlTree.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="HtmlTag.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="Links.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/markup/HtmlTree.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2010, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2010, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 45,12 ***</span>
   *
   *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
   *  If you write code that depends on this, you do so at your own risk.
   *  This code and its internal interfaces are subject to change or
   *  deletion without notice.&lt;/b&gt;
<span class="line-removed">-  *</span>
<span class="line-removed">-  * @author Bhavesh Patel</span>
   */
  public class HtmlTree extends Content {
  
      public final HtmlTag htmlTag;
      private Map&lt;HtmlAttr,String&gt; attrs = Collections.emptyMap();
<span class="line-new-header">--- 45,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 98,11 ***</span>
       * @return this object
       */
      public HtmlTree put(HtmlAttr attrName, String attrValue) {
          if (attrs.isEmpty())
              attrs = new LinkedHashMap&lt;&gt;(3);
<span class="line-modified">!         attrs.put(nullCheck(attrName), escapeHtmlChars(attrValue));</span>
          return this;
      }
  
      /**
       * Sets the &quot;title&quot; attribute for this tag.
<span class="line-new-header">--- 96,22 ---</span>
       * @return this object
       */
      public HtmlTree put(HtmlAttr attrName, String attrValue) {
          if (attrs.isEmpty())
              attrs = new LinkedHashMap&lt;&gt;(3);
<span class="line-modified">!         attrs.put(nullCheck(attrName), Entity.escapeHtmlChars(attrValue));</span>
<span class="line-added">+         return this;</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
<span class="line-added">+     /**</span>
<span class="line-added">+      * Sets the &quot;id&quot; attribute for this tag.</span>
<span class="line-added">+      *</span>
<span class="line-added">+      * @param id the value for the id attribute</span>
<span class="line-added">+      * @return this object</span>
<span class="line-added">+      */</span>
<span class="line-added">+     public HtmlTree setId(String id) {</span>
<span class="line-added">+         put(HtmlAttr.ID, id);</span>
          return this;
      }
  
      /**
       * Sets the &quot;title&quot; attribute for this tag.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 175,50 ***</span>
          }
          else
              add(new StringContent(stringContent));
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public int charCount() {
          int n = 0;
          for (Content c : content)
              n += c.charCount();
          return n;
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Given a string, escape all special HTML characters and</span>
<span class="line-removed">-      * return the result.</span>
<span class="line-removed">-      *</span>
<span class="line-removed">-      * @param s The string to check.</span>
<span class="line-removed">-      * @return the original string with all of the HTML characters escaped.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     private static String escapeHtmlChars(String s) {</span>
<span class="line-removed">-         for (int i = 0; i &lt; s.length(); i++) {</span>
<span class="line-removed">-             char ch = s.charAt(i);</span>
<span class="line-removed">-             switch (ch) {</span>
<span class="line-removed">-                 // only start building a new string if we need to</span>
<span class="line-removed">-                 case &#39;&lt;&#39;: case &#39;&gt;&#39;: case &#39;&amp;&#39;:</span>
<span class="line-removed">-                     StringBuilder sb = new StringBuilder(s.substring(0, i));</span>
<span class="line-removed">-                     for ( ; i &lt; s.length(); i++) {</span>
<span class="line-removed">-                         ch = s.charAt(i);</span>
<span class="line-removed">-                         switch (ch) {</span>
<span class="line-removed">-                             case &#39;&lt;&#39;: sb.append(&quot;&amp;lt;&quot;);  break;</span>
<span class="line-removed">-                             case &#39;&gt;&#39;: sb.append(&quot;&amp;gt;&quot;);  break;</span>
<span class="line-removed">-                             case &#39;&amp;&#39;: sb.append(&quot;&amp;amp;&quot;); break;</span>
<span class="line-removed">-                             default:  sb.append(ch);      break;</span>
<span class="line-removed">-                         }</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                     return sb.toString();</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         return s;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      /*
       * The sets of ASCII URI characters to be left unencoded.
       * See &quot;Uniform Resource Identifier (URI): Generic Syntax&quot;
       * IETF RFC 3986. https://tools.ietf.org/html/rfc3986
       */
<span class="line-new-header">--- 184,18 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 296,39 ***</span>
          HtmlTree htmltree = new HtmlTree(HtmlTag.A, nullCheck(body));
          htmltree.put(HtmlAttr.HREF, encodeURL(ref));
          return htmltree;
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Generates an HTML anchor tag with id attribute and a body.</span>
<span class="line-removed">-      *</span>
<span class="line-removed">-      * @param id id for the anchor tag</span>
<span class="line-removed">-      * @param body body for the anchor tag</span>
<span class="line-removed">-      * @return an HtmlTree object</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static HtmlTree A_ID(String id, Content body) {</span>
<span class="line-removed">-         HtmlTree htmltree = new HtmlTree(HtmlTag.A);</span>
<span class="line-removed">-         htmltree.put(HtmlAttr.ID, nullCheck(id));</span>
<span class="line-removed">-         htmltree.add(nullCheck(body));</span>
<span class="line-removed">-         return htmltree;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Generates an HTML anchor tag with a style class, id attribute and a body.</span>
<span class="line-removed">-      *</span>
<span class="line-removed">-      * @param styleClass stylesheet class for the tag</span>
<span class="line-removed">-      * @param id id for the anchor tag</span>
<span class="line-removed">-      * @param body body for the anchor tag</span>
<span class="line-removed">-      * @return an HtmlTree object</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static HtmlTree A_ID(HtmlStyle styleClass, String id, Content body) {</span>
<span class="line-removed">-         HtmlTree htmltree = A_ID(id, body);</span>
<span class="line-removed">-         if (styleClass != null)</span>
<span class="line-removed">-             htmltree.setStyle(styleClass);</span>
<span class="line-removed">-         return htmltree;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      /**
       * Generates a CAPTION tag with some content.
       *
       * @param body content for the tag
       * @return an HtmlTree object for the CAPTION tag
<span class="line-new-header">--- 273,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 610,25 ***</span>
          HtmlTree htmltree = new HtmlTree(HtmlTag.MAIN, nullCheck(body));
          htmltree.setRole(Role.MAIN);
          return htmltree;
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Generates a MAIN tag with role attribute, style attribute and some content.</span>
<span class="line-removed">-      *</span>
<span class="line-removed">-      * @param styleClass style of the MAIN tag</span>
<span class="line-removed">-      * @param body content of the MAIN tag</span>
<span class="line-removed">-      * @return an HtmlTree object for the MAIN tag</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static HtmlTree MAIN(HtmlStyle styleClass, Content body) {</span>
<span class="line-removed">-         HtmlTree htmltree = HtmlTree.MAIN(body);</span>
<span class="line-removed">-         if (styleClass != null) {</span>
<span class="line-removed">-             htmltree.setStyle(styleClass);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         return htmltree;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      /**
       * Generates a META tag with the http-equiv, content and charset attributes.
       *
       * @param httpEquiv http equiv attribute for the META tag
       * @param content type of content
<span class="line-new-header">--- 558,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 715,30 ***</span>
          htmltree.put(HtmlAttr.SRC, nullCheck(src));
          return htmltree;
      }
  
      /**
<span class="line-modified">!      * Generates a SECTION tag with role attribute.</span>
       *
       * @return an HtmlTree object for the SECTION tag
       */
<span class="line-modified">!     public static HtmlTree SECTION() {</span>
<span class="line-modified">!         HtmlTree htmltree = new HtmlTree(HtmlTag.SECTION);</span>
<span class="line-modified">!         htmltree.setRole(Role.REGION);</span>
<span class="line-modified">!         return htmltree;</span>
      }
  
      /**
<span class="line-modified">!      * Generates a SECTION tag with role attribute and some content.</span>
       *
       * @param body content of the section tag
       * @return an HtmlTree object for the SECTION tag
       */
<span class="line-modified">!     public static HtmlTree SECTION(Content body) {</span>
<span class="line-modified">!         HtmlTree htmltree = new HtmlTree(HtmlTag.SECTION, nullCheck(body));</span>
<span class="line-modified">!         htmltree.setRole(Role.REGION);</span>
<span class="line-modified">!         return htmltree;</span>
      }
  
      /**
       * Generates a SMALL tag with some content.
       *
<span class="line-new-header">--- 648,34 ---</span>
          htmltree.put(HtmlAttr.SRC, nullCheck(src));
          return htmltree;
      }
  
      /**
<span class="line-modified">!      * Generates a SECTION tag with style class attribute.</span>
       *
<span class="line-added">+      * @param styleClass the style class for the tag</span>
       * @return an HtmlTree object for the SECTION tag
       */
<span class="line-modified">!     public static HtmlTree SECTION(HtmlStyle styleClass) {</span>
<span class="line-modified">!         HtmlTree htmlTree = new HtmlTree(HtmlTag.SECTION);</span>
<span class="line-modified">!         htmlTree.setStyle(styleClass);</span>
<span class="line-modified">!         return htmlTree;</span>
      }
  
      /**
<span class="line-modified">!      * Generates a SECTION tag with style class attribute and some content.</span>
       *
<span class="line-added">+      * @param styleClass the style class for the tag</span>
       * @param body content of the section tag
       * @return an HtmlTree object for the SECTION tag
       */
<span class="line-modified">!     public static HtmlTree SECTION(HtmlStyle styleClass, Content body) {</span>
<span class="line-modified">!         HtmlTree htmlTree = new HtmlTree(HtmlTag.SECTION, nullCheck(body));</span>
<span class="line-modified">!         if (styleClass != null) {</span>
<span class="line-modified">!             htmlTree.setStyle(styleClass);</span>
<span class="line-added">+         }</span>
<span class="line-added">+         return htmlTree;</span>
      }
  
      /**
       * Generates a SMALL tag with some content.
       *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 772,10 ***</span>
<span class="line-new-header">--- 709,23 ---</span>
          if (styleClass != null)
              htmltree.setStyle(styleClass);
          return htmltree;
      }
  
<span class="line-added">+     /**</span>
<span class="line-added">+      * Generates an SPAN tag with id attribute and a body.</span>
<span class="line-added">+      *</span>
<span class="line-added">+      * @param id id for the tag</span>
<span class="line-added">+      * @param body body for the tag</span>
<span class="line-added">+      * @return an HtmlTree object for the SPAN tag</span>
<span class="line-added">+      */</span>
<span class="line-added">+     public static HtmlTree SPAN_ID(String id, Content body) {</span>
<span class="line-added">+         HtmlTree htmltree = new HtmlTree(HtmlTag.SPAN, nullCheck(body));</span>
<span class="line-added">+         htmltree.put(HtmlAttr.ID, nullCheck(id));</span>
<span class="line-added">+         return htmltree;</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      /**
       * Generates a SPAN tag with id and style class attributes. It also encloses
       * a content.
       *
       * @param id the id for the tag
</pre>
<hr />
<pre>
<span class="line-old-header">*** 922,13 ***</span>
          }
          htmlTree.setStyle(nullCheck(styleClass));
          return htmlTree;
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public boolean isEmpty() {
          return (!hasContent() &amp;&amp; !hasAttrs());
      }
  
<span class="line-new-header">--- 872,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 986,10 ***</span>
<span class="line-new-header">--- 933,12 ---</span>
              case META :
                  return (hasAttr(HtmlAttr.CONTENT) &amp;&amp; !hasContent());
              case SCRIPT :
                  return ((hasAttr(HtmlAttr.TYPE) &amp;&amp; hasAttr(HtmlAttr.SRC) &amp;&amp; !hasContent()) ||
                          (hasAttr(HtmlAttr.TYPE) &amp;&amp; hasContent()));
<span class="line-added">+             case SPAN :</span>
<span class="line-added">+                 return (hasAttr(HtmlAttr.ID) || hasContent());</span>
              default :
                  return hasContent();
          }
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1000,13 ***</span>
       */
      public boolean isInline() {
          return (htmlTag.blockType == HtmlTag.BlockType.INLINE);
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      public boolean write(Writer out, boolean atNewline) throws IOException {
          if (!isInline() &amp;&amp; !atNewline)
              out.write(DocletConstants.NL);
          String tagString = htmlTag.toString();
<span class="line-new-header">--- 949,10 ---</span>
</pre>
<center><a href="HtmlTag.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="Links.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>