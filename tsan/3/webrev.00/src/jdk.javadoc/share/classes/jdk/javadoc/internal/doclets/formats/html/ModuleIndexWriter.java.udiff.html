<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/ModuleIndexWriter.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MethodWriterImpl.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="ModuleWriterImpl.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/ModuleIndexWriter.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2016, 2019, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2016, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -29,102 +29,72 @@</span>
  import jdk.javadoc.internal.doclets.formats.html.markup.TableHeader;
  
  import java.util.*;
  
  import javax.lang.model.element.ModuleElement;
<span class="udiff-line-removed">- import javax.lang.model.element.PackageElement;</span>
  
  import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlStyle;
<span class="udiff-line-removed">- import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTag;</span>
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTree;
  import jdk.javadoc.internal.doclets.formats.html.markup.StringContent;
  import jdk.javadoc.internal.doclets.toolkit.Content;
  import jdk.javadoc.internal.doclets.toolkit.util.DocFileIOException;
  import jdk.javadoc.internal.doclets.toolkit.util.DocPath;
  import jdk.javadoc.internal.doclets.toolkit.util.DocPaths;
  
  /**
<span class="udiff-line-modified-removed">-  * Generate the module index page &quot;overview-summary.html&quot; for the right-hand</span>
<span class="udiff-line-removed">-  * frame.</span>
<span class="udiff-line-modified-added">+  * Generate the module index page &quot;index.html&quot;.</span>
   *
   *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
   *  If you write code that depends on this, you do so at your own risk.
   *  This code and its internal interfaces are subject to change or
   *  deletion without notice.&lt;/b&gt;
<span class="udiff-line-removed">-  *</span>
<span class="udiff-line-removed">-  * @author Bhavesh Patel</span>
   */
<span class="udiff-line-modified-removed">- public class ModuleIndexWriter extends AbstractModuleIndexWriter {</span>
<span class="udiff-line-modified-added">+ public class ModuleIndexWriter extends AbstractOverviewIndexWriter {</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     /**</span>
<span class="udiff-line-added">+      * Modules to be documented.</span>
<span class="udiff-line-added">+      */</span>
<span class="udiff-line-added">+     protected SortedSet&lt;ModuleElement&gt; modules;</span>
  
      /**
       * Construct the ModuleIndexWriter.
<span class="udiff-line-added">+      *</span>
       * @param configuration the configuration object
       * @param filename the name of the generated file
       */
      public ModuleIndexWriter(HtmlConfiguration configuration, DocPath filename) {
          super(configuration, filename);
<span class="udiff-line-added">+         modules = configuration.modules;</span>
      }
  
      /**
<span class="udiff-line-modified-removed">-      * Generate the module index page for the right-hand frame.</span>
<span class="udiff-line-modified-added">+      * Generate the module index page.</span>
       *
       * @param configuration the current configuration of the doclet.
       * @throws DocFileIOException if there is a problem generating the module index page
       */
      public static void generate(HtmlConfiguration configuration) throws DocFileIOException {
<span class="udiff-line-modified-removed">-         DocPath filename = DocPaths.overviewSummary(configuration.frames);</span>
<span class="udiff-line-modified-added">+         DocPath filename = DocPaths.INDEX;</span>
          ModuleIndexWriter mdlgen = new ModuleIndexWriter(configuration, filename);
<span class="udiff-line-modified-removed">-         mdlgen.buildModuleIndexFile(&quot;doclet.Window_Overview_Summary&quot;, &quot;module index&quot;, true);</span>
<span class="udiff-line-modified-added">+         mdlgen.buildOverviewIndexFile(&quot;doclet.Window_Overview_Summary&quot;, &quot;module index&quot;);</span>
      }
  
      /**
<span class="udiff-line-modified-removed">-      * Add the module index.</span>
<span class="udiff-line-modified-added">+      * Adds the list of modules.</span>
       *
<span class="udiff-line-removed">-      * @param header the documentation tree to which the navigational links will be added</span>
       * @param main the documentation tree to which the modules list will be added
       */
      @Override
<span class="udiff-line-modified-removed">-     protected void addIndex(Content header, Content main) {</span>
<span class="udiff-line-removed">-         addIndexContents(header, main);</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * Adds module index contents.</span>
<span class="udiff-line-removed">-      *</span>
<span class="udiff-line-removed">-      * @param header the document tree to which the navigational links will be added</span>
<span class="udiff-line-removed">-      * @param main the document tree to which the modules list will be added</span>
<span class="udiff-line-removed">-      */</span>
<span class="udiff-line-removed">-     protected void addIndexContents(Content header, Content main) {</span>
<span class="udiff-line-removed">-         HtmlTree htmltree = HtmlTree.NAV();</span>
<span class="udiff-line-removed">-         htmltree.setStyle(HtmlStyle.indexNav);</span>
<span class="udiff-line-removed">-         HtmlTree ul = new HtmlTree(HtmlTag.UL);</span>
<span class="udiff-line-removed">-         addAllClassesLink(ul);</span>
<span class="udiff-line-removed">-         if (configuration.showModules) {</span>
<span class="udiff-line-removed">-             addAllModulesLink(ul);</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-         htmltree.add(ul);</span>
<span class="udiff-line-removed">-         header.add(htmltree);</span>
<span class="udiff-line-removed">-         addModulesList(main);</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * Add the list of modules.</span>
<span class="udiff-line-removed">-      *</span>
<span class="udiff-line-removed">-      * @param main the content tree to which the module list will be added</span>
<span class="udiff-line-removed">-      */</span>
<span class="udiff-line-removed">-     @Override</span>
<span class="udiff-line-removed">-     protected void addModulesList(Content main) {</span>
<span class="udiff-line-modified-added">+     protected void addIndex(Content main) {</span>
          Map&lt;String, SortedSet&lt;ModuleElement&gt;&gt; groupModuleMap
<span class="udiff-line-modified-removed">-                 = configuration.group.groupModules(configuration.modules);</span>
<span class="udiff-line-modified-added">+                 = configuration.group.groupModules(modules);</span>
  
          if (!groupModuleMap.keySet().isEmpty()) {
<span class="udiff-line-modified-removed">-             String tableSummary = resources.getText(&quot;doclet.Member_Table_Summary&quot;,</span>
<span class="udiff-line-removed">-                     resources.getText(&quot;doclet.Module_Summary&quot;), resources.getText(&quot;doclet.modules&quot;));</span>
<span class="udiff-line-removed">-             TableHeader header = new TableHeader(contents.moduleLabel, contents.descriptionLabel);</span>
<span class="udiff-line-modified-added">+             TableHeader tableHeader = new TableHeader(contents.moduleLabel, contents.descriptionLabel);</span>
              Table table =  new Table(HtmlStyle.overviewSummary)
<span class="udiff-line-modified-removed">-                     .setHeader(header)</span>
<span class="udiff-line-modified-added">+                     .setHeader(tableHeader)</span>
                      .setColumnStyles(HtmlStyle.colFirst, HtmlStyle.colLast)
                      .setDefaultTab(resources.getText(&quot;doclet.All_Modules&quot;))
                      .setTabScript(i -&gt; &quot;show(&quot; + i + &quot;);&quot;)
                      .setTabId(i -&gt; (i == 0) ? &quot;t0&quot; : (&quot;t&quot; + (1 &lt;&lt; (i - 1))));
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -134,13 +104,13 @@</span>
                  if (groupModules != null) {
                      table.addTab(groupName, groupModules::contains);
                  }
              }
  
<span class="udiff-line-modified-removed">-             for (ModuleElement mdle : configuration.modules) {</span>
<span class="udiff-line-modified-added">+             for (ModuleElement mdle : modules) {</span>
                  if (!mdle.isUnnamed()) {
<span class="udiff-line-modified-removed">-                     if (!(configuration.nodeprecated &amp;&amp; utils.isDeprecated(mdle))) {</span>
<span class="udiff-line-modified-added">+                     if (!(options.noDeprecated() &amp;&amp; utils.isDeprecated(mdle))) {</span>
                          Content moduleLinkContent = getModuleLink(mdle, new StringContent(mdle.getQualifiedName().toString()));
                          Content summaryContent = new ContentBuilder();
                          addSummaryComment(mdle, summaryContent);
                          table.addRow(mdle, moduleLinkContent, summaryContent);
                      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -153,69 +123,6 @@</span>
              if (table.needsScript()) {
                  mainBodyScript.append(table.getScript());
              }
          }
      }
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * Adds the overview summary comment for this documentation. Add one line</span>
<span class="udiff-line-removed">-      * summary at the top of the page and generate a link to the description,</span>
<span class="udiff-line-removed">-      * which is added at the end of this page.</span>
<span class="udiff-line-removed">-      *</span>
<span class="udiff-line-removed">-      * @param main the documentation tree to which the overview header will be added</span>
<span class="udiff-line-removed">-      */</span>
<span class="udiff-line-removed">-     @Override</span>
<span class="udiff-line-removed">-     protected void addOverviewHeader(Content main) {</span>
<span class="udiff-line-removed">-         addConfigurationTitle(main);</span>
<span class="udiff-line-removed">-         if (!utils.getFullBody(configuration.overviewElement).isEmpty()) {</span>
<span class="udiff-line-removed">-             HtmlTree div = new HtmlTree(HtmlTag.DIV);</span>
<span class="udiff-line-removed">-             div.setStyle(HtmlStyle.contentContainer);</span>
<span class="udiff-line-removed">-             addOverviewComment(div);</span>
<span class="udiff-line-removed">-             main.add(div);</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * Adds the overview comment as provided in the file specified by the</span>
<span class="udiff-line-removed">-      * &quot;-overview&quot; option on the command line.</span>
<span class="udiff-line-removed">-      *</span>
<span class="udiff-line-removed">-      * @param htmltree the documentation tree to which the overview comment will</span>
<span class="udiff-line-removed">-      *                 be added</span>
<span class="udiff-line-removed">-      */</span>
<span class="udiff-line-removed">-     protected void addOverviewComment(Content htmltree) {</span>
<span class="udiff-line-removed">-         if (!utils.getFullBody(configuration.overviewElement).isEmpty()) {</span>
<span class="udiff-line-removed">-             addInlineComment(configuration.overviewElement, htmltree);</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * Adds the top text (from the -top option), the upper</span>
<span class="udiff-line-removed">-      * navigation bar, and then the title (from the&quot;-title&quot;</span>
<span class="udiff-line-removed">-      * option), at the top of page.</span>
<span class="udiff-line-removed">-      *</span>
<span class="udiff-line-removed">-      * @param header the documentation tree to which the navigation bar header will be added</span>
<span class="udiff-line-removed">-      */</span>
<span class="udiff-line-removed">-     @Override</span>
<span class="udiff-line-removed">-     protected void addNavigationBarHeader(Content header) {</span>
<span class="udiff-line-removed">-         addTop(header);</span>
<span class="udiff-line-removed">-         navBar.setUserHeader(getUserHeaderFooter(true));</span>
<span class="udiff-line-removed">-         header.add(navBar.getContent(true));</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * Adds the lower navigation bar and the bottom text</span>
<span class="udiff-line-removed">-      * (from the -bottom option) at the bottom of page.</span>
<span class="udiff-line-removed">-      *</span>
<span class="udiff-line-removed">-      * @param footer the documentation tree to which the navigation bar footer will be added</span>
<span class="udiff-line-removed">-      */</span>
<span class="udiff-line-removed">-     @Override</span>
<span class="udiff-line-removed">-     protected void addNavigationBarFooter(Content footer) {</span>
<span class="udiff-line-removed">-         navBar.setUserFooter(getUserHeaderFooter(false));</span>
<span class="udiff-line-removed">-         footer.add(navBar.getContent(false));</span>
<span class="udiff-line-removed">-         addBottom(footer);</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     @Override</span>
<span class="udiff-line-removed">-     protected void addModulePackagesList(Map&lt;ModuleElement, Set&lt;PackageElement&gt;&gt; modules, String text,</span>
<span class="udiff-line-removed">-             String tableSummary, Content main, ModuleElement mdle) {</span>
<span class="udiff-line-removed">-     }</span>
  }
</pre>
<center><a href="MethodWriterImpl.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="ModuleWriterImpl.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>