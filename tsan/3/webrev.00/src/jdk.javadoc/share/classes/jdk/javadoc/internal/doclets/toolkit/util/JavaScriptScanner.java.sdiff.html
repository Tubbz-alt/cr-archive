<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/util/JavaScriptScanner.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="IndexBuilder.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="MetaKeywords.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/util/JavaScriptScanner.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 44  * A DocTree scanner to detect use of JavaScript in a doc comment tree.
 45  */
 46 public class JavaScriptScanner extends DocTreePathScanner&lt;Void, Consumer&lt;DocTreePath&gt;&gt; {
 47 
 48     public Void scan(DocCommentTree tree, TreePath p, Consumer&lt;DocTreePath&gt; f) {
 49         return scan(new DocTreePath(p, tree), f);
 50     }
 51 
 52     @Override @DefinedBy(Api.COMPILER_TREE)
 53     public Void visitStartElement(StartElementTree tree, Consumer&lt;DocTreePath&gt; f) {
 54         String name = tree.getName().toString();
 55         if (name.equalsIgnoreCase(&quot;script&quot;))
 56             f.accept(getCurrentPath());
 57         return super.visitStartElement(tree, f);
 58     }
 59 
 60     @Override @DefinedBy(Api.COMPILER_TREE)
 61     public Void visitAttribute(AttributeTree tree, Consumer&lt;DocTreePath&gt; f) {
 62         String name = tree.getName().toString().toLowerCase(Locale.ENGLISH);
 63         switch (name) {
<span class="line-removed"> 64             // See https://www.w3.org/TR/html-markup/global-attributes.html#common.attrs.event-handler</span>
<span class="line-removed"> 65             case &quot;onabort&quot;:  case &quot;onblur&quot;:  case &quot;oncanplay&quot;:  case &quot;oncanplaythrough&quot;:</span>
<span class="line-removed"> 66             case &quot;onchange&quot;:  case &quot;onclick&quot;:  case &quot;oncontextmenu&quot;:  case &quot;ondblclick&quot;:</span>
<span class="line-removed"> 67             case &quot;ondrag&quot;:  case &quot;ondragend&quot;:  case &quot;ondragenter&quot;:  case &quot;ondragleave&quot;:</span>
<span class="line-removed"> 68             case &quot;ondragover&quot;:  case &quot;ondragstart&quot;:  case &quot;ondrop&quot;:  case &quot;ondurationchange&quot;:</span>
<span class="line-removed"> 69             case &quot;onemptied&quot;:  case &quot;onended&quot;:  case &quot;onerror&quot;:  case &quot;onfocus&quot;:  case &quot;oninput&quot;:</span>
<span class="line-removed"> 70             case &quot;oninvalid&quot;:  case &quot;onkeydown&quot;:  case &quot;onkeypress&quot;:  case &quot;onkeyup&quot;:</span>
<span class="line-removed"> 71             case &quot;onload&quot;:  case &quot;onloadeddata&quot;:  case &quot;onloadedmetadata&quot;:  case &quot;onloadstart&quot;:</span>
<span class="line-removed"> 72             case &quot;onmousedown&quot;:  case &quot;onmousemove&quot;:  case &quot;onmouseout&quot;:  case &quot;onmouseover&quot;:</span>
<span class="line-removed"> 73             case &quot;onmouseup&quot;:  case &quot;onmousewheel&quot;:  case &quot;onpause&quot;:  case &quot;onplay&quot;:</span>
<span class="line-removed"> 74             case &quot;onplaying&quot;:  case &quot;onprogress&quot;:  case &quot;onratechange&quot;:  case &quot;onreadystatechange&quot;:</span>
<span class="line-removed"> 75             case &quot;onreset&quot;:  case &quot;onscroll&quot;:  case &quot;onseeked&quot;:  case &quot;onseeking&quot;:</span>
<span class="line-removed"> 76             case &quot;onselect&quot;:  case &quot;onshow&quot;:  case &quot;onstalled&quot;:  case &quot;onsubmit&quot;:  case &quot;onsuspend&quot;:</span>
<span class="line-removed"> 77             case &quot;ontimeupdate&quot;:  case &quot;onvolumechange&quot;:  case &quot;onwaiting&quot;:</span>
<span class="line-removed"> 78 </span>
<span class="line-removed"> 79             // See https://www.w3.org/TR/html4/sgml/dtd.html</span>
<span class="line-removed"> 80             // Most of the attributes that take a %Script are also defined as event handlers</span>
<span class="line-removed"> 81             // in HTML 5. The one exception is onunload.</span>
<span class="line-removed"> 82             // case &quot;onchange&quot;:  case &quot;onclick&quot;:   case &quot;ondblclick&quot;:  case &quot;onfocus&quot;:</span>
<span class="line-removed"> 83             // case &quot;onkeydown&quot;:  case &quot;onkeypress&quot;:  case &quot;onkeyup&quot;:  case &quot;onload&quot;:</span>
<span class="line-removed"> 84             // case &quot;onmousedown&quot;:  case &quot;onmousemove&quot;:  case &quot;onmouseout&quot;:  case &quot;onmouseover&quot;:</span>
<span class="line-removed"> 85             // case &quot;onmouseup&quot;:  case &quot;onreset&quot;:  case &quot;onselect&quot;:  case &quot;onsubmit&quot;:</span>
<span class="line-removed"> 86             case &quot;onunload&quot;:</span>
<span class="line-removed"> 87                 f.accept(getCurrentPath());</span>
<span class="line-removed"> 88                 break;</span>
<span class="line-removed"> 89 </span>
 90             // See https://www.w3.org/TR/html4/sgml/dtd.html
<span class="line-modified"> 91             //     https://www.w3.org/TR/html5/</span>
 92             // These are all the attributes that take a %URI or a valid URL potentially surrounded
 93             // by spaces
 94             case &quot;action&quot;:  case &quot;cite&quot;:  case &quot;classid&quot;:  case &quot;codebase&quot;:  case &quot;data&quot;:
 95             case &quot;datasrc&quot;:  case &quot;for&quot;:  case &quot;href&quot;:  case &quot;longdesc&quot;:  case &quot;profile&quot;:
 96             case &quot;src&quot;:  case &quot;usemap&quot;:
 97                 List&lt;? extends DocTree&gt; value = tree.getValue();
 98                 if (value != null &amp;&amp; !value.isEmpty() &amp;&amp; value.get(0).getKind() == Kind.TEXT) {
 99                     String v = value.get(0).toString().trim().toLowerCase(Locale.ENGLISH);
100                     if (v.startsWith(&quot;javascript:&quot;)) {
101                         f.accept(getCurrentPath());
102                     }
103                 }
104                 break;








105         }
106         return super.visitAttribute(tree, f);
107     }
108 
109     /**
110      * Used to indicate a fault when parsing, typically used in
111      * lambda methods.
112      */
113     public static class Fault extends RuntimeException {
114         private static final long serialVersionUID = 0L;
115     }
116 }
</pre>
</td>
<td>
<hr />
<pre>
 44  * A DocTree scanner to detect use of JavaScript in a doc comment tree.
 45  */
 46 public class JavaScriptScanner extends DocTreePathScanner&lt;Void, Consumer&lt;DocTreePath&gt;&gt; {
 47 
 48     public Void scan(DocCommentTree tree, TreePath p, Consumer&lt;DocTreePath&gt; f) {
 49         return scan(new DocTreePath(p, tree), f);
 50     }
 51 
 52     @Override @DefinedBy(Api.COMPILER_TREE)
 53     public Void visitStartElement(StartElementTree tree, Consumer&lt;DocTreePath&gt; f) {
 54         String name = tree.getName().toString();
 55         if (name.equalsIgnoreCase(&quot;script&quot;))
 56             f.accept(getCurrentPath());
 57         return super.visitStartElement(tree, f);
 58     }
 59 
 60     @Override @DefinedBy(Api.COMPILER_TREE)
 61     public Void visitAttribute(AttributeTree tree, Consumer&lt;DocTreePath&gt; f) {
 62         String name = tree.getName().toString().toLowerCase(Locale.ENGLISH);
 63         switch (name) {


























 64             // See https://www.w3.org/TR/html4/sgml/dtd.html
<span class="line-modified"> 65             //     https://www.w3.org/TR/html52/fullindex.html#attributes-table</span>
 66             // These are all the attributes that take a %URI or a valid URL potentially surrounded
 67             // by spaces
 68             case &quot;action&quot;:  case &quot;cite&quot;:  case &quot;classid&quot;:  case &quot;codebase&quot;:  case &quot;data&quot;:
 69             case &quot;datasrc&quot;:  case &quot;for&quot;:  case &quot;href&quot;:  case &quot;longdesc&quot;:  case &quot;profile&quot;:
 70             case &quot;src&quot;:  case &quot;usemap&quot;:
 71                 List&lt;? extends DocTree&gt; value = tree.getValue();
 72                 if (value != null &amp;&amp; !value.isEmpty() &amp;&amp; value.get(0).getKind() == Kind.TEXT) {
 73                     String v = value.get(0).toString().trim().toLowerCase(Locale.ENGLISH);
 74                     if (v.startsWith(&quot;javascript:&quot;)) {
 75                         f.accept(getCurrentPath());
 76                     }
 77                 }
 78                 break;
<span class="line-added"> 79             // See https://www.w3.org/TR/html52/webappapis.html#events-event-handlers</span>
<span class="line-added"> 80             // An event handler has a name, which always starts with &quot;on&quot; and is followed by</span>
<span class="line-added"> 81             // the name of the event for which it is intended.</span>
<span class="line-added"> 82             default:</span>
<span class="line-added"> 83                 if (name.startsWith(&quot;on&quot;)) {</span>
<span class="line-added"> 84                     f.accept(getCurrentPath());</span>
<span class="line-added"> 85                 }</span>
<span class="line-added"> 86                 break;</span>
 87         }
 88         return super.visitAttribute(tree, f);
 89     }
 90 
 91     /**
 92      * Used to indicate a fault when parsing, typically used in
 93      * lambda methods.
 94      */
 95     public static class Fault extends RuntimeException {
 96         private static final long serialVersionUID = 0L;
 97     }
 98 }
</pre>
</td>
</tr>
</table>
<center><a href="IndexBuilder.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="MetaKeywords.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>