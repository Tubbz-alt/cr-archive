<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/AbstractExecutableMemberWriter.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../api/JavadocTool.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="AbstractIndexWriter.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/AbstractExecutableMemberWriter.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 1997, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 33,33 ***</span>
  import javax.lang.model.element.ExecutableElement;
  import javax.lang.model.element.TypeElement;
  import javax.lang.model.element.VariableElement;
  import javax.lang.model.type.ArrayType;
  import javax.lang.model.type.DeclaredType;
  import javax.lang.model.type.TypeMirror;
  import javax.lang.model.type.TypeVariable;
  import javax.lang.model.util.SimpleTypeVisitor9;
  
  import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlStyle;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTree;
  import jdk.javadoc.internal.doclets.toolkit.Content;
  import jdk.javadoc.internal.doclets.toolkit.util.DocletConstants;
  
<span class="line-modified">! import static jdk.javadoc.internal.doclets.formats.html.LinkInfoImpl.Kind.*;</span>
  
  /**
   * Print method and constructor info.
   *
   *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
   *  If you write code that depends on this, you do so at your own risk.
   *  This code and its internal interfaces are subject to change or
   *  deletion without notice.&lt;/b&gt;
<span class="line-removed">-  *</span>
<span class="line-removed">-  * @author Robert Field</span>
<span class="line-removed">-  * @author Atul M Dambalkar</span>
<span class="line-removed">-  * @author Bhavesh Patel (Modified)</span>
   */
  public abstract class AbstractExecutableMemberWriter extends AbstractMemberWriter {
  
      public AbstractExecutableMemberWriter(SubWriterHolderWriter writer, TypeElement typeElement) {
          super(writer, typeElement);
<span class="line-new-header">--- 33,34 ---</span>
  import javax.lang.model.element.ExecutableElement;
  import javax.lang.model.element.TypeElement;
  import javax.lang.model.element.VariableElement;
  import javax.lang.model.type.ArrayType;
  import javax.lang.model.type.DeclaredType;
<span class="line-added">+ import javax.lang.model.type.ExecutableType;</span>
  import javax.lang.model.type.TypeMirror;
  import javax.lang.model.type.TypeVariable;
  import javax.lang.model.util.SimpleTypeVisitor9;
  
  import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;
<span class="line-added">+ import jdk.javadoc.internal.doclets.formats.html.markup.Entity;</span>
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlStyle;
  import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTree;
  import jdk.javadoc.internal.doclets.toolkit.Content;
  import jdk.javadoc.internal.doclets.toolkit.util.DocletConstants;
  
<span class="line-modified">! import static jdk.javadoc.internal.doclets.formats.html.LinkInfoImpl.Kind.EXECUTABLE_MEMBER_PARAM;</span>
<span class="line-added">+ import static jdk.javadoc.internal.doclets.formats.html.LinkInfoImpl.Kind.MEMBER;</span>
<span class="line-added">+ import static jdk.javadoc.internal.doclets.formats.html.LinkInfoImpl.Kind.MEMBER_TYPE_PARAMS;</span>
<span class="line-added">+ import static jdk.javadoc.internal.doclets.formats.html.LinkInfoImpl.Kind.RECEIVER_TYPE;</span>
  
  /**
   * Print method and constructor info.
   *
   *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
   *  If you write code that depends on this, you do so at your own risk.
   *  This code and its internal interfaces are subject to change or
   *  deletion without notice.&lt;/b&gt;
   */
  public abstract class AbstractExecutableMemberWriter extends AbstractMemberWriter {
  
      public AbstractExecutableMemberWriter(SubWriterHolderWriter writer, TypeElement typeElement) {
          super(writer, typeElement);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 67,23 ***</span>
  
      public AbstractExecutableMemberWriter(SubWriterHolderWriter writer) {
          super(writer);
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Add the type parameters for the executable member.</span>
<span class="line-removed">-      *</span>
<span class="line-removed">-      * @param member the member to write type parameters for.</span>
<span class="line-removed">-      * @param htmltree the content tree to which the parameters will be added.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     protected void addTypeParameters(ExecutableElement member, Content htmltree) {</span>
<span class="line-removed">-         Content typeParameters = getTypeParameters(member);</span>
<span class="line-removed">-         if (!typeParameters.isEmpty()) {</span>
<span class="line-removed">-             htmltree.add(typeParameters);</span>
<span class="line-removed">-             htmltree.add(Contents.SPACE);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-     }</span>
  
      /**
       * Get the type parameters for the executable member.
       *
       * @param member the member for which to get the type parameters.
<span class="line-new-header">--- 68,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 92,24 ***</span>
      protected Content getTypeParameters(ExecutableElement member) {
          LinkInfoImpl linkInfo = new LinkInfoImpl(configuration, MEMBER_TYPE_PARAMS, member);
          return writer.getTypeParameterLinks(linkInfo);
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * {@inheritDoc}</span>
<span class="line-removed">-      */</span>
      @Override
      protected Content getDeprecatedLink(Element member) {
          Content deprecatedLinkContent = new ContentBuilder();
          deprecatedLinkContent.add(utils.getFullyQualifiedName(member));
          if (!utils.isConstructor(member)) {
              deprecatedLinkContent.add(&quot;.&quot;);
              deprecatedLinkContent.add(member.getSimpleName());
          }
          String signature = utils.flatSignature((ExecutableElement) member);
          if (signature.length() &gt; 2) {
<span class="line-modified">!             deprecatedLinkContent.add(Contents.ZERO_WIDTH_SPACE);</span>
          }
          deprecatedLinkContent.add(signature);
  
          return writer.getDocLink(MEMBER, utils.getEnclosingTypeElement(member), member, deprecatedLinkContent);
      }
<span class="line-new-header">--- 80,21 ---</span>
      protected Content getTypeParameters(ExecutableElement member) {
          LinkInfoImpl linkInfo = new LinkInfoImpl(configuration, MEMBER_TYPE_PARAMS, member);
          return writer.getTypeParameterLinks(linkInfo);
      }
  
      @Override
      protected Content getDeprecatedLink(Element member) {
          Content deprecatedLinkContent = new ContentBuilder();
          deprecatedLinkContent.add(utils.getFullyQualifiedName(member));
          if (!utils.isConstructor(member)) {
              deprecatedLinkContent.add(&quot;.&quot;);
              deprecatedLinkContent.add(member.getSimpleName());
          }
          String signature = utils.flatSignature((ExecutableElement) member);
          if (signature.length() &gt; 2) {
<span class="line-modified">!             deprecatedLinkContent.add(Entity.ZERO_WIDTH_SPACE);</span>
          }
          deprecatedLinkContent.add(signature);
  
          return writer.getDocLink(MEMBER, utils.getEnclosingTypeElement(member), member, deprecatedLinkContent);
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 128,11 ***</span>
          ExecutableElement ee = (ExecutableElement)member;
          Content memberLink = HtmlTree.SPAN(HtmlStyle.memberNameLink,
                  writer.getDocLink(context, te, ee,
                  name(ee), false));
          Content code = HtmlTree.CODE(memberLink);
<span class="line-modified">!         addParameters(ee, false, code, name(ee).length() - 1);</span>
          tdSummary.add(code);
      }
  
      /**
       * Add the inherited summary link for the member.
<span class="line-new-header">--- 113,11 ---</span>
          ExecutableElement ee = (ExecutableElement)member;
          Content memberLink = HtmlTree.SPAN(HtmlStyle.memberNameLink,
                  writer.getDocLink(context, te, ee,
                  name(ee), false));
          Content code = HtmlTree.CODE(memberLink);
<span class="line-modified">!         addParameters(ee, code);</span>
          tdSummary.add(code);
      }
  
      /**
       * Add the inherited summary link for the member.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 152,142 ***</span>
       * @param member the member to write parameter for.
       * @param param the parameter that needs to be written.
       * @param isVarArg true if this is a link to var arg.
       * @param tree the content tree to which the parameter information will be added.
       */
<span class="line-modified">!     protected void addParam(ExecutableElement member, VariableElement param,</span>
              boolean isVarArg, Content tree) {
          Content link = writer.getLink(new LinkInfoImpl(configuration, EXECUTABLE_MEMBER_PARAM,
<span class="line-modified">!                 param.asType()).varargs(isVarArg));</span>
          tree.add(link);
          if(name(param).length() &gt; 0) {
<span class="line-modified">!             tree.add(Contents.SPACE);</span>
              tree.add(name(param));
          }
      }
  
      /**
       * Add the receiver annotations information.
       *
       * @param member the member to write receiver annotations for.
       * @param rcvrType the receiver type.
<span class="line-modified">!      * @param descList list of annotation description.</span>
       * @param tree the content tree to which the information will be added.
       */
      protected void addReceiverAnnotations(ExecutableElement member, TypeMirror rcvrType,
              List&lt;? extends AnnotationMirror&gt; annotationMirrors, Content tree) {
          writer.addReceiverAnnotationInfo(member, rcvrType, annotationMirrors, tree);
<span class="line-modified">!         tree.add(Contents.SPACE);</span>
          tree.add(utils.getTypeName(rcvrType, false));
          LinkInfoImpl linkInfo = new LinkInfoImpl(configuration, RECEIVER_TYPE, rcvrType);
          tree.add(writer.getTypeParameterLinks(linkInfo));
<span class="line-modified">!         tree.add(Contents.SPACE);</span>
          tree.add(&quot;this&quot;);
      }
  
  
      /**
       * Add all the parameters for the executable member.
       *
       * @param member the member to write parameters for.
       * @param htmltree the content tree to which the parameters information will be added.
       */
<span class="line-modified">!     protected void addParameters(ExecutableElement member, Content htmltree, int indentSize) {</span>
<span class="line-modified">!         addParameters(member, true, htmltree, indentSize);</span>
      }
  
      /**
       * Add all the parameters for the executable member.
       *
       * @param member the member to write parameters for.
       * @param includeAnnotations true if annotation information needs to be added.
<span class="line-modified">!      * @param htmltree the content tree to which the parameters information will be added.</span>
       */
<span class="line-modified">!     protected void addParameters(ExecutableElement member,</span>
<span class="line-removed">-             boolean includeAnnotations, Content htmltree, int indentSize) {</span>
          Content paramTree = new ContentBuilder();
          String sep = &quot;&quot;;
          List&lt;? extends VariableElement&gt; parameters = member.getParameters();
<span class="line-removed">-         CharSequence indent = makeSpace(indentSize + 1);</span>
          TypeMirror rcvrType = member.getReceiverType();
          if (includeAnnotations &amp;&amp; rcvrType != null &amp;&amp; utils.isAnnotated(rcvrType)) {
              List&lt;? extends AnnotationMirror&gt; annotationMirrors = rcvrType.getAnnotationMirrors();
              addReceiverAnnotations(member, rcvrType, annotationMirrors, paramTree);
<span class="line-modified">!             sep = &quot;,&quot; + DocletConstants.NL + indent;</span>
          }
          int paramstart;
          for (paramstart = 0; paramstart &lt; parameters.size(); paramstart++) {
              paramTree.add(sep);
              VariableElement param = parameters.get(paramstart);
  
              if (param.getKind() != ElementKind.INSTANCE_INIT) {
                  if (includeAnnotations) {
                      boolean foundAnnotations =
<span class="line-modified">!                             writer.addAnnotationInfo(indent.length(),</span>
<span class="line-removed">-                             member, param, paramTree);</span>
                      if (foundAnnotations) {
                          paramTree.add(DocletConstants.NL);
<span class="line-removed">-                         paramTree.add(indent);</span>
                      }
                  }
<span class="line-modified">!                 addParam(member, param,</span>
                      (paramstart == parameters.size() - 1) &amp;&amp; member.isVarArgs(), paramTree);
                  break;
              }
          }
  
          for (int i = paramstart + 1; i &lt; parameters.size(); i++) {
              paramTree.add(&quot;,&quot;);
              paramTree.add(DocletConstants.NL);
<span class="line-removed">-             paramTree.add(indent);</span>
              if (includeAnnotations) {
                  boolean foundAnnotations =
<span class="line-modified">!                         writer.addAnnotationInfo(indent.length(), member, parameters.get(i),</span>
                          paramTree);
                  if (foundAnnotations) {
                      paramTree.add(DocletConstants.NL);
<span class="line-removed">-                     paramTree.add(indent);</span>
                  }
              }
<span class="line-modified">!             addParam(member, parameters.get(i), (i == parameters.size() - 1) &amp;&amp; member.isVarArgs(),</span>
                      paramTree);
          }
<span class="line-modified">!         if (paramTree.isEmpty()) {</span>
<span class="line-modified">!             htmltree.add(&quot;()&quot;);</span>
<span class="line-removed">-         } else {</span>
<span class="line-removed">-             htmltree.add(Contents.ZERO_WIDTH_SPACE);</span>
<span class="line-removed">-             htmltree.add(&quot;(&quot;);</span>
<span class="line-removed">-             htmltree.add(paramTree);</span>
<span class="line-removed">-             paramTree.add(&quot;)&quot;);</span>
<span class="line-removed">-         }</span>
      }
  
      /**
<span class="line-modified">!      * Add exceptions for the executable member.</span>
       *
       * @param member the member to write exceptions for.
<span class="line-modified">!      * @param htmltree the content tree to which the exceptions information will be added.</span>
       */
<span class="line-modified">!     protected void addExceptions(ExecutableElement member, Content htmltree, int indentSize) {</span>
<span class="line-modified">!         List&lt;? extends TypeMirror&gt; exceptions = member.getThrownTypes();</span>
          if (!exceptions.isEmpty()) {
<span class="line-removed">-             CharSequence indent = makeSpace(indentSize + 1 - 7);</span>
<span class="line-removed">-             htmltree.add(DocletConstants.NL);</span>
<span class="line-removed">-             htmltree.add(indent);</span>
<span class="line-removed">-             htmltree.add(&quot;throws &quot;);</span>
<span class="line-removed">-             indent = makeSpace(indentSize + 1);</span>
              Content link = writer.getLink(new LinkInfoImpl(configuration, MEMBER, exceptions.get(0)));
              htmltree.add(link);
<span class="line-modified">!             for(int i = 1; i &lt; exceptions.size(); i++) {</span>
                  htmltree.add(&quot;,&quot;);
                  htmltree.add(DocletConstants.NL);
<span class="line-removed">-                 htmltree.add(indent);</span>
                  Content exceptionLink = writer.getLink(new LinkInfoImpl(configuration, MEMBER,
                          exceptions.get(i)));
                  htmltree.add(exceptionLink);
              }
          }
      }
  
      protected TypeElement implementsMethodInIntfac(ExecutableElement method,
                                                  List&lt;TypeElement&gt; intfacs) {
          for (TypeElement intf : intfacs) {
<span class="line-new-header">--- 137,137 ---</span>
       * @param member the member to write parameter for.
       * @param param the parameter that needs to be written.
       * @param isVarArg true if this is a link to var arg.
       * @param tree the content tree to which the parameter information will be added.
       */
<span class="line-modified">!     protected void addParam(ExecutableElement member, VariableElement param, TypeMirror paramType,</span>
              boolean isVarArg, Content tree) {
          Content link = writer.getLink(new LinkInfoImpl(configuration, EXECUTABLE_MEMBER_PARAM,
<span class="line-modified">!                 paramType).varargs(isVarArg));</span>
          tree.add(link);
          if(name(param).length() &gt; 0) {
<span class="line-modified">!             tree.add(Entity.NO_BREAK_SPACE);</span>
              tree.add(name(param));
          }
      }
  
      /**
       * Add the receiver annotations information.
       *
       * @param member the member to write receiver annotations for.
       * @param rcvrType the receiver type.
<span class="line-modified">!      * @param annotationMirrors list of annotation descriptions.</span>
       * @param tree the content tree to which the information will be added.
       */
      protected void addReceiverAnnotations(ExecutableElement member, TypeMirror rcvrType,
              List&lt;? extends AnnotationMirror&gt; annotationMirrors, Content tree) {
          writer.addReceiverAnnotationInfo(member, rcvrType, annotationMirrors, tree);
<span class="line-modified">!         tree.add(Entity.NO_BREAK_SPACE);</span>
          tree.add(utils.getTypeName(rcvrType, false));
          LinkInfoImpl linkInfo = new LinkInfoImpl(configuration, RECEIVER_TYPE, rcvrType);
          tree.add(writer.getTypeParameterLinks(linkInfo));
<span class="line-modified">!         tree.add(Entity.NO_BREAK_SPACE);</span>
          tree.add(&quot;this&quot;);
      }
  
  
      /**
       * Add all the parameters for the executable member.
       *
       * @param member the member to write parameters for.
       * @param htmltree the content tree to which the parameters information will be added.
       */
<span class="line-modified">!     protected void addParameters(ExecutableElement member, Content htmltree) {</span>
<span class="line-modified">!         Content paramTree = getParameters(member, false);</span>
<span class="line-added">+         if (paramTree.isEmpty()) {</span>
<span class="line-added">+             htmltree.add(&quot;()&quot;);</span>
<span class="line-added">+         } else {</span>
<span class="line-added">+             htmltree.add(Entity.ZERO_WIDTH_SPACE);</span>
<span class="line-added">+             htmltree.add(&quot;(&quot;);</span>
<span class="line-added">+             htmltree.add(paramTree);</span>
<span class="line-added">+             paramTree.add(&quot;)&quot;);</span>
<span class="line-added">+         }</span>
      }
  
      /**
       * Add all the parameters for the executable member.
       *
       * @param member the member to write parameters for.
       * @param includeAnnotations true if annotation information needs to be added.
<span class="line-modified">!      * @return the content tree containing the parameter information</span>
       */
<span class="line-modified">!     protected Content getParameters(ExecutableElement member, boolean includeAnnotations) {</span>
          Content paramTree = new ContentBuilder();
          String sep = &quot;&quot;;
          List&lt;? extends VariableElement&gt; parameters = member.getParameters();
          TypeMirror rcvrType = member.getReceiverType();
          if (includeAnnotations &amp;&amp; rcvrType != null &amp;&amp; utils.isAnnotated(rcvrType)) {
              List&lt;? extends AnnotationMirror&gt; annotationMirrors = rcvrType.getAnnotationMirrors();
              addReceiverAnnotations(member, rcvrType, annotationMirrors, paramTree);
<span class="line-modified">!             sep = &quot;,&quot; + DocletConstants.NL;</span>
          }
          int paramstart;
<span class="line-added">+         ExecutableType instMeth = utils.asInstantiatedMethodType(typeElement, member);</span>
          for (paramstart = 0; paramstart &lt; parameters.size(); paramstart++) {
              paramTree.add(sep);
              VariableElement param = parameters.get(paramstart);
<span class="line-added">+             TypeMirror paramType = instMeth.getParameterTypes().get(paramstart);</span>
  
              if (param.getKind() != ElementKind.INSTANCE_INIT) {
                  if (includeAnnotations) {
                      boolean foundAnnotations =
<span class="line-modified">!                             writer.addAnnotationInfo(param, paramTree);</span>
                      if (foundAnnotations) {
                          paramTree.add(DocletConstants.NL);
                      }
                  }
<span class="line-modified">!                 addParam(member, param, paramType,</span>
                      (paramstart == parameters.size() - 1) &amp;&amp; member.isVarArgs(), paramTree);
                  break;
              }
          }
  
          for (int i = paramstart + 1; i &lt; parameters.size(); i++) {
              paramTree.add(&quot;,&quot;);
              paramTree.add(DocletConstants.NL);
              if (includeAnnotations) {
                  boolean foundAnnotations =
<span class="line-modified">!                         writer.addAnnotationInfo(parameters.get(i),</span>
                          paramTree);
                  if (foundAnnotations) {
                      paramTree.add(DocletConstants.NL);
                  }
              }
<span class="line-modified">!             addParam(member, parameters.get(i), instMeth.getParameterTypes().get(i),</span>
<span class="line-added">+                     (i == parameters.size() - 1) &amp;&amp; member.isVarArgs(),</span>
                      paramTree);
          }
<span class="line-modified">! </span>
<span class="line-modified">!         return paramTree;</span>
      }
  
      /**
<span class="line-modified">!      * Get a content tree containing the exception information for the executable member.</span>
       *
       * @param member the member to write exceptions for.
<span class="line-modified">!      * @return the content tree containing the exceptions information.</span>
       */
<span class="line-modified">!     protected Content getExceptions(ExecutableElement member) {</span>
<span class="line-modified">!         List&lt;? extends TypeMirror&gt; exceptions = utils.asInstantiatedMethodType(typeElement, member).getThrownTypes();</span>
<span class="line-added">+         Content htmltree = new ContentBuilder();</span>
          if (!exceptions.isEmpty()) {
              Content link = writer.getLink(new LinkInfoImpl(configuration, MEMBER, exceptions.get(0)));
              htmltree.add(link);
<span class="line-modified">!             for (int i = 1; i &lt; exceptions.size(); i++) {</span>
                  htmltree.add(&quot;,&quot;);
                  htmltree.add(DocletConstants.NL);
                  Content exceptionLink = writer.getLink(new LinkInfoImpl(configuration, MEMBER,
                          exceptions.get(i)));
                  htmltree.add(exceptionLink);
              }
          }
<span class="line-added">+         return htmltree;</span>
      }
  
      protected TypeElement implementsMethodInIntfac(ExecutableElement method,
                                                  List&lt;TypeElement&gt; intfacs) {
          for (TypeElement intf : intfacs) {
</pre>
<center><a href="../../../api/JavadocTool.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="AbstractIndexWriter.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>