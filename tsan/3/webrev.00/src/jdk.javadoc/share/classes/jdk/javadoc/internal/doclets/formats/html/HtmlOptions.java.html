<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/HtmlOptions.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 1998, 2020, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package jdk.javadoc.internal.doclets.formats.html;
 27 
 28 import java.net.MalformedURLException;
 29 import java.net.URL;
 30 import java.util.ArrayList;
 31 import java.util.List;
 32 import java.util.Set;
 33 import java.util.TreeSet;
 34 
 35 import com.sun.tools.doclint.DocLint;
 36 import jdk.javadoc.internal.doclets.toolkit.BaseOptions;
 37 import jdk.javadoc.internal.doclets.toolkit.Messages;
 38 import jdk.javadoc.internal.doclets.toolkit.Resources;
 39 import jdk.javadoc.internal.doclets.toolkit.util.DocFile;
 40 import jdk.javadoc.internal.doclets.toolkit.util.Utils;
 41 
 42 /**
 43  * Storage for all options supported by the
 44  * {@link jdk.javadoc.doclet.StandardDoclet standard doclet},
 45  * including the format-independent options handled
 46  * by {@link BaseOptions}.
 47  *
 48  * &lt;p&gt;Some of the methods used to access the values of options
 49  * have names that begin with a verb, such as {@link #createOverview}
 50  * or {@link #splitIndex}. Unless otherwise stated,
 51  * these methods should all be taken as just accessing the value
 52  * of the associated option.
 53  *
 54  */
 55 public class HtmlOptions extends BaseOptions {
 56     //&lt;editor-fold desc=&quot;Option values&quot;&gt;
 57     /**
 58      * Argument for command-line option {@code --add-stylesheet}.
 59      */
 60     private List&lt;String&gt; additionalStylesheets = new ArrayList&lt;&gt;();
 61 
 62     /**
 63      * Argument for command-line option {@code -bottom}.
 64      */
 65     private String bottom = &quot;&quot;;
 66 
 67     /**
 68      * Argument for command-line option {@code -charset}.
 69      * The META charset tag used for cross-platform viewing.
 70      */
 71     private String charset = null;
 72 
 73     /**
 74      * Argument for command-line option {@code -use}.
 75      * True if command-line option &quot;-use&quot; is used. Default value is false.
 76      */
 77     private boolean classUse = false;
 78 
 79     /**
 80      * Argument for command-line option {@code -noindex}.
 81      * False if command-line option &quot;-noindex&quot; is used. Default value is true.
 82      */
 83     private boolean createIndex = true;
 84 
 85     /**
 86      * Argument for command-line option {@code -overview}.
 87      * This is true if option &quot;-overview&quot; is used or option &quot;-overview&quot; is not
 88      * used and number of packages is more than one.
 89      */
 90     private boolean createOverview = false;
 91 
 92     /**
 93      * Argument for command-line option {@code -notree}.
 94      * False if command-line option &quot;-notree&quot; is used. Default value is true.
 95      */
 96     private boolean createTree = true;
 97 
 98     /**
 99      * Arguments for command-line option {@code -Xdoclint} and friends.
100      * Collected set of doclint options.
101      */
102     private List&lt;String&gt; doclintOpts = new ArrayList&lt;&gt;();
103 
104     /**
105      * Argument for command-line option {@code -Xdocrootparent}.
106      */
107     private String docrootParent = &quot;&quot;;
108 
109     /**
110      * Argument for command-line option {@code -doctitle}.
111      */
112     private String docTitle = &quot;&quot;;
113 
114 
115     /**
116      * Argument for command-line option {@code -footer}.
117      */
118     private String footer = &quot;&quot;;
119 
120     /**
121      * Argument for command-line option {@code -header}.
122      */
123     private String header = &quot;&quot;;
124 
125     /**
126      * Argument for command-line option {@code -helpfile}.
127      */
128     private String helpFile = &quot;&quot;;
129 
130     /**
131      * Argument for command-line option {@code -nodeprecated}.
132      * True if command-line option &quot;-nodeprecated&quot; is used. Default value is
133      * false.
134      */
135     private boolean noDeprecatedList = false;
136 
137     /**
138      * Argument for command-line option {@code -nohelp}.
139      * True if command-line option &quot;-nohelp&quot; is used. Default value is false.
140      */
141     private boolean noHelp = false;
142 
143     /**
144      * Argument for command-line option {@code -nonavbar}.
145      * True if command-line option &quot;-nonavbar&quot; is used. Default value is false.
146      */
147     private boolean noNavbar = false;
148 
149     /**
150      * Argument for command-line option {@code -nooverview}.
151      * True if command-line option &quot;-nooverview&quot; is used. Default value is
152      * false
153      */
154     private boolean noOverview = false;
155 
156     /**
157      * Argument for command-line option {@code -overview}.
158      * The overview path specified with &quot;-overview&quot; flag.
159      */
160     private String overviewPath = null;
161 
162     /**
163      * Argument for command-line option {@code -packagesheader}.
164      */
165     private String packagesHeader = &quot;&quot;;
166 
167     /**
168      * Argument for command-line option {@code -splitindex}.
169      * True if command-line option &quot;-splitindex&quot; is used. Default value is
170      * false.
171      */
172     private boolean splitIndex = false;
173 
174     /**
175      * Argument for command-line option {@code -stylesheetfile}.
176      */
177     private String stylesheetFile = &quot;&quot;;
178 
179     /**
180      * Argument for command-line option {@code -top}.
181      */
182     private String top = &quot;&quot;;
183 
184     /**
185      * Argument for command-line option {@code -windowtitle}.
186      */
187     private String windowTitle = &quot;&quot;;
188     //&lt;/editor-fold&gt;
189 
190     private HtmlConfiguration config;
191 
192     HtmlOptions(HtmlConfiguration config) {
193         super(config);
194         this.config = config;
195     }
196 
197     @Override
198     public Set&lt;? extends Option&gt; getSupportedOptions() {
199         Messages messages = config.getMessages();
200         Resources resources = messages.getResources();
201 
202         List&lt;Option&gt; options = List.of(
203                 new Option(resources, &quot;--add-stylesheet&quot;, 1) {
204                     @Override
205                     public boolean process(String opt, List&lt;String&gt; args) {
206                         additionalStylesheets.add(args.get(0));
207                         return true;
208                     }
209                 },
210 
211                 new Option(resources, &quot;-bottom&quot;, 1) {
212                     @Override
213                     public boolean process(String opt,  List&lt;String&gt; args) {
214                         bottom = args.get(0);
215                         return true;
216                     }
217                 },
218 
219                 new Option(resources, &quot;-charset&quot;, 1) {
220                     @Override
221                     public boolean process(String opt,  List&lt;String&gt; args) {
222                         charset = args.get(0);
223                         return true;
224                     }
225                 },
226 
227                 new Option(resources, &quot;-doctitle&quot;, 1) {
228                     @Override
229                     public boolean process(String opt,  List&lt;String&gt; args) {
230                         docTitle = args.get(0);
231                         return true;
232                     }
233                 },
234 
235                 new Option(resources, &quot;-footer&quot;, 1) {
236                     @Override
237                     public boolean process(String opt, List&lt;String&gt; args) {
238                         footer = args.get(0);
239                         return true;
240                     }
241                 },
242 
243                 new Option(resources, &quot;-header&quot;, 1) {
244                     @Override
245                     public boolean process(String opt,  List&lt;String&gt; args) {
246                         header = args.get(0);
247                         return true;
248                     }
249                 },
250 
251                 new Option(resources, &quot;-helpfile&quot;, 1) {
252                     @Override
253                     public boolean process(String opt,  List&lt;String&gt; args) {
254                         if (noHelp) {
255                             messages.error(&quot;doclet.Option_conflict&quot;, &quot;-helpfile&quot;, &quot;-nohelp&quot;);
256                             return false;
257                         }
258                         if (!helpFile.isEmpty()) {
259                             messages.error(&quot;doclet.Option_reuse&quot;, &quot;-helpfile&quot;);
260                             return false;
261                         }
262                         helpFile = args.get(0);
263                         return true;
264                     }
265                 },
266 
267                 new Option(resources, &quot;-html5&quot;) {
268                     @Override
269                     public boolean process(String opt,  List&lt;String&gt; args) {
270                         return true;
271                     }
272                 },
273 
274                 new Option(resources, &quot;-nohelp&quot;) {
275                     @Override
276                     public boolean process(String opt, List&lt;String&gt; args) {
277                         noHelp = true;
278                         if (!helpFile.isEmpty()) {
279                             messages.error(&quot;doclet.Option_conflict&quot;, &quot;-nohelp&quot;, &quot;-helpfile&quot;);
280                             return false;
281                         }
282                         return true;
283                     }
284                 },
285 
286                 new Option(resources, &quot;-nodeprecatedlist&quot;) {
287                     @Override
288                     public boolean process(String opt,  List&lt;String&gt; args) {
289                         noDeprecatedList = true;
290                         return true;
291                     }
292                 },
293 
294                 new Option(resources, &quot;-noindex&quot;) {
295                     @Override
296                     public boolean process(String opt,  List&lt;String&gt; args) {
297                         createIndex = false;
298                         if (splitIndex) {
299                             messages.error(&quot;doclet.Option_conflict&quot;, &quot;-noindex&quot;, &quot;-splitindex&quot;);
300                             return false;
301                         }
302                         return true;
303                     }
304                 },
305 
306                 new Option(resources, &quot;-nonavbar&quot;) {
307                     @Override
308                     public boolean process(String opt,  List&lt;String&gt; args) {
309                         noNavbar = true;
310                         return true;
311                     }
312                 },
313 
314                 new Hidden(resources, &quot;-nooverview&quot;) {
315                     @Override
316                     public boolean process(String opt,  List&lt;String&gt; args) {
317                         noOverview = true;
318                         if (overviewPath != null) {
319                             messages.error(&quot;doclet.Option_conflict&quot;, &quot;-nooverview&quot;, &quot;-overview&quot;);
320                             return false;
321                         }
322                         return true;
323                     }
324                 },
325 
326                 new Option(resources, &quot;-notree&quot;) {
327                     @Override
328                     public boolean process(String opt,  List&lt;String&gt; args) {
329                         createTree = false;
330                         return true;
331                     }
332                 },
333 
334                 new Option(resources, &quot;-overview&quot;, 1) {
335                     @Override
336                     public boolean process(String opt,  List&lt;String&gt; args) {
337                         overviewPath = args.get(0);
338                         if (noOverview) {
339                             messages.error(&quot;doclet.Option_conflict&quot;, &quot;-overview&quot;, &quot;-nooverview&quot;);
340                             return false;
341                         }
342                         return true;
343                     }
344                 },
345 
346                 new Hidden(resources, &quot;-packagesheader&quot;, 1) {
347                     @Override
348                     public boolean process(String opt,  List&lt;String&gt; args) {
349                         packagesHeader = args.get(0);
350                         return true;
351                     }
352                 },
353 
354                 new Option(resources, &quot;-splitindex&quot;) {
355                     @Override
356                     public boolean process(String opt, List&lt;String&gt; args) {
357                         splitIndex = true;
358                         if (!createIndex) {
359                             messages.error(&quot;doclet.Option_conflict&quot;, &quot;-splitindex&quot;, &quot;-noindex&quot;);
360                             return false;
361                         }
362                         return true;
363                     }
364                 },
365 
366                 new Option(resources, &quot;--main-stylesheet -stylesheetfile&quot;, 1) {
367                     @Override
368                     public boolean process(String opt,  List&lt;String&gt; args) {
369                         stylesheetFile = args.get(0);
370                         return true;
371                     }
372                 },
373 
374                 new Option(resources, &quot;-top&quot;, 1) {
375                     @Override
376                     public boolean process(String opt,  List&lt;String&gt; args) {
377                         top = args.get(0);
378                         return true;
379                     }
380                 },
381 
382                 new Option(resources, &quot;-use&quot;) {
383                     @Override
384                     public boolean process(String opt,  List&lt;String&gt; args) {
385                         classUse = true;
386                         return true;
387                     }
388                 },
389 
390                 new Option(resources, &quot;-windowtitle&quot;, 1) {
391                     @Override
392                     public boolean process(String opt,  List&lt;String&gt; args) {
393                         windowTitle = args.get(0).replaceAll(&quot;&lt;.*?&gt;&quot;, &quot;&quot;);
394                         return true;
395                     }
396                 },
397 
398                 new XOption(resources, &quot;-Xdoclint&quot;) {
399                     @Override
400                     public boolean process(String opt,  List&lt;String&gt; args) {
401                         doclintOpts.add(DocLint.XMSGS_OPTION);
402                         return true;
403                     }
404                 },
405 
406                 new XOption(resources, &quot;doclet.usage.xdoclint-extended&quot;, &quot;-Xdoclint:&quot;, 0) {
407                     @Override
408                     public boolean process(String opt,  List&lt;String&gt; args) {
409                         String dopt = opt.replace(&quot;-Xdoclint:&quot;, DocLint.XMSGS_CUSTOM_PREFIX);
410                         if (dopt.contains(&quot;/&quot;)) {
411                             messages.error(&quot;doclet.Option_doclint_no_qualifiers&quot;);
412                             return false;
413                         }
414                         if (!DocLint.isValidOption(dopt)) {
415                             messages.error(&quot;doclet.Option_doclint_invalid_arg&quot;);
416                             return false;
417                         }
418                         doclintOpts.add(dopt);
419                         return true;
420                     }
421                 },
422 
423                 new XOption(resources, &quot;doclet.usage.xdoclint-package&quot;, &quot;-Xdoclint/package:&quot;, 0) {
424                     @Override
425                     public boolean process(String opt,  List&lt;String&gt; args) {
426                         String dopt = opt.replace(&quot;-Xdoclint/package:&quot;, DocLint.XCHECK_PACKAGE);
427                         if (!DocLint.isValidOption(dopt)) {
428                             messages.error(&quot;doclet.Option_doclint_package_invalid_arg&quot;);
429                             return false;
430                         }
431                         doclintOpts.add(dopt);
432                         return true;
433                     }
434                 },
435 
436                 new XOption(resources, &quot;-Xdocrootparent&quot;, 1) {
437                     @Override
438                     public boolean process(String opt, List&lt;String&gt; args) {
439                         docrootParent = args.get(0);
440                         try {
441                             new URL(docrootParent);
442                         } catch (MalformedURLException e) {
443                             messages.error(&quot;doclet.MalformedURL&quot;, docrootParent);
444                             return false;
445                         }
446                         return true;
447                     }
448                 },
449 
450                 new XOption(resources, &quot;--no-frames&quot;) {
451                     @Override
452                     public boolean process(String opt, List&lt;String&gt; args) {
453                         messages.warning(&quot;doclet.NoFrames_specified&quot;);
454                         return true;
455                     }
456                 }
457         );
458         Set&lt;BaseOptions.Option&gt; allOptions = new TreeSet&lt;&gt;();
459         allOptions.addAll(options);
460         allOptions.addAll(super.getSupportedOptions());
461         return allOptions;
462     }
463 
464     protected boolean validateOptions() {
465         // check shared options
466         if (!generalValidOptions()) {
467             return false;
468         }
469 
470         Messages messages = config.getMessages();
471 
472         // check if helpfile exists
473         if (!helpFile.isEmpty()) {
474             DocFile help = DocFile.createFileForInput(config, helpFile);
475             if (!help.exists()) {
476                 messages.error(&quot;doclet.File_not_found&quot;, helpFile);
477                 return false;
478             }
479         }
480         // check if stylesheetFile exists
481         if (!stylesheetFile.isEmpty()) {
482             DocFile stylesheet = DocFile.createFileForInput(config, stylesheetFile);
483             if (!stylesheet.exists()) {
484                 messages.error(&quot;doclet.File_not_found&quot;, stylesheetFile);
485                 return false;
486             }
487         }
488         // check if additional stylesheets exists
489         for (String ssheet : additionalStylesheets) {
490             DocFile ssfile = DocFile.createFileForInput(config, ssheet);
491             if (!ssfile.exists()) {
492                 messages.error(&quot;doclet.File_not_found&quot;, ssheet);
493                 return false;
494             }
495         }
496 
497         // In a more object-oriented world, this would be done by methods on the Option objects.
498         // Note that -windowtitle silently removes any and all HTML elements, and so does not need
499         // to be handled here.
500         Utils utils = config.utils;
501         utils.checkJavaScriptInOption(&quot;-header&quot;, header);
502         utils.checkJavaScriptInOption(&quot;-footer&quot;, footer);
503         utils.checkJavaScriptInOption(&quot;-top&quot;, top);
504         utils.checkJavaScriptInOption(&quot;-bottom&quot;, bottom);
505         utils.checkJavaScriptInOption(&quot;-doctitle&quot;, docTitle);
506         utils.checkJavaScriptInOption(&quot;-packagesheader&quot;, packagesHeader);
507 
508         return true;
509     }
510 
511     /**
512      * Argument for command-line option {@code --add-stylesheet}.
513      */
514     List&lt;String&gt; additionalStylesheets() {
515         return additionalStylesheets;
516     }
517 
518     /**
519      * Argument for command-line option {@code -bottom}.
520      */
521     String bottom() {
522         return bottom;
523     }
524 
525     /**
526      * Argument for command-line option {@code -charset}.
527      * The META charset tag used for cross-platform viewing.
528      */
529     String charset() {
530         return charset;
531     }
532 
533     void setCharset(String charset) {
534         this.charset = charset;
535     }
536 
537     /**
538      * Argument for command-line option {@code -use}.
539      * True if command-line option &quot;-use&quot; is used. Default value is false.
540      */
541     public boolean classUse() {
542         return classUse;
543     }
544 
545     /**
546      * Argument for command-line option {@code -noindex}.
547      * False if command-line option &quot;-noindex&quot; is used. Default value is true.
548      */
549     public boolean createIndex() {
550         return createIndex;
551     }
552 
553     /**
554      * Argument for command-line option {@code -overview}.
555      * This is true if option &quot;-overview&quot; is used or option &quot;-overview&quot; is not
556      * used and number of packages is more than one.
557      */
558     public boolean createOverview() {
559         return createOverview;
560     }
561 
562     public void setCreateOverview(boolean createOverview) {
563         this.createOverview = createOverview;
564     }
565 
566     /**
567      * Argument for command-line option {@code -notree}.
568      * False if command-line option &quot;-notree&quot; is used. Default value is true.
569      */
570     public boolean createTree() {
571         return createTree;
572     }
573 
574     /**
575      * Arguments for command-line option {@code -Xdoclint} and friends.
576      * Collected set of doclint options.
577      */
578     List&lt;String&gt; doclintOpts() {
579         return doclintOpts;
580     }
581 
582     /**
583      * Argument for command-line option {@code -Xdocrootparent}.
584      */
585     String docrootParent() {
586         return docrootParent;
587     }
588 
589     /**
590      * Argument for command-line option {@code -doctitle}.
591      */
592     String docTitle() {
593         return docTitle;
594     }
595 
596     /**
597      * Argument for command-line option {@code -footer}.
598      */
599     String footer() {
600         return footer;
601     }
602 
603     /**
604      * Argument for command-line option {@code -header}.
605      */
606     String header() {
607         return header;
608     }
609 
610     /**
611      * Argument for command-line option {@code -helpfile}.
612      */
613     public String helpFile() {
614         return helpFile;
615     }
616 
617     /**
618      * Argument for command-line option {@code -nodeprecated}.
619      * True if command-line option &quot;-nodeprecated&quot; is used. Default value is
620      * false.
621      */
622     public boolean noDeprecatedList() {
623         return noDeprecatedList;
624     }
625 
626     /**
627      * Argument for command-line option {@code -nohelp}.
628      * True if command-line option &quot;-nohelp&quot; is used. Default value is false.
629      */
630     public boolean noHelp() {
631         return noHelp;
632     }
633 
634     /**
635      * Argument for command-line option {@code -nonavbar}.
636      * True if command-line option &quot;-nonavbar&quot; is used. Default value is false.
637      */
638     public boolean noNavbar() {
639         return noNavbar;
640     }
641 
642     /**
643      * Argument for command-line option {@code -nooverview}.
644      * True if command-line option &quot;-nooverview&quot; is used. Default value is
645      * false
646      */
647     boolean noOverview() {
648         return noOverview;
649     }
650 
651     /**
652      * Argument for command-line option {@code -overview}.
653      * The overview path specified with &quot;-overview&quot; flag.
654      */
655     String overviewPath() {
656         return overviewPath;
657     }
658 
659     /**
660      * Argument for command-line option {@code -packagesheader}.
661      */
662     String packagesHeader() {
663         return packagesHeader;
664     }
665 
666     /**
667      * Argument for command-line option {@code -splitindex}.
668      * True if command-line option &quot;-splitindex&quot; is used. Default value is
669      * false.
670      */
671     public boolean splitIndex() {
672         return splitIndex;
673     }
674 
675     /**
676      * Argument for command-line option {@code -stylesheetfile}.
677      */
678     String stylesheetFile() {
679         return stylesheetFile;
680     }
681 
682     /**
683      * Argument for command-line option {@code -top}.
684      */
685     String top() {
686         return top;
687     }
688 
689     /**
690      * Argument for command-line option {@code -windowtitle}.
691      */
692     String windowTitle() {
693         return windowTitle;
694     }
695 }
    </pre>
  </body>
</html>