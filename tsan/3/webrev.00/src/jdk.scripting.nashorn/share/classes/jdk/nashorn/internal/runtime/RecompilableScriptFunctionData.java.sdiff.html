<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.scripting.nashorn/share/classes/jdk/nashorn/internal/runtime/RecompilableScriptFunctionData.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Property.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SharedPropertyMap.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.scripting.nashorn/share/classes/jdk/nashorn/internal/runtime/RecompilableScriptFunctionData.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2010, 2014, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 101      * Cached form of the AST. Either a {@code SerializedAst} object used by split functions as they can&#39;t be
 102      * reparsed from source, or a soft reference to a {@code FunctionNode} for other functions (it is safe
 103      * to be cleared as they can be reparsed).
 104      */
 105     private volatile transient Object cachedAst;
 106 
 107     /** Token of this function within the source. */
 108     private final long token;
 109 
 110     /**
 111      * Represents the allocation strategy (property map, script object class, and method handle) for when
 112      * this function is used as a constructor. Note that majority of functions (those not setting any this.*
 113      * properties) will share a single canonical &quot;default strategy&quot; instance.
 114      */
 115     private final AllocationStrategy allocationStrategy;
 116 
 117     /**
 118      * Opaque object representing parser state at the end of the function. Used when reparsing outer function
 119      * to help with skipping parsing inner functions.
 120      */

 121     private final Object endParserState;
 122 
 123     /** Code installer used for all further recompilation/specialization of this ScriptFunction */
 124     private transient CodeInstaller installer;
 125 

 126     private final Map&lt;Integer, RecompilableScriptFunctionData&gt; nestedFunctions;
 127 
 128     /** Id to parent function if one exists */
 129     private RecompilableScriptFunctionData parent;
 130 
 131     /** Copy of the {@link FunctionNode} flags. */
 132     private final int functionFlags;
 133 
 134     private static final MethodHandles.Lookup LOOKUP = MethodHandles.lookup();
 135 
 136     private transient DebugLogger log;
 137 

 138     private final Map&lt;String, Integer&gt; externalScopeDepths;
 139 

 140     private final Set&lt;String&gt; internalSymbols;
 141 
 142     private static final int GET_SET_PREFIX_LENGTH = &quot;*et &quot;.length();
 143 
 144     private static final long serialVersionUID = 4914839316174633726L;
 145 
 146     /**
 147      * Constructor - public as scripts use it
 148      *
 149      * @param functionNode        functionNode that represents this function code
 150      * @param installer           installer for code regeneration versions of this function
 151      * @param allocationStrategy  strategy for the allocation behavior when this function is used as a constructor
 152      * @param nestedFunctions     nested function map
 153      * @param externalScopeDepths external scope depths
 154      * @param internalSymbols     internal symbols to method, defined in its scope
 155      */
 156     public RecompilableScriptFunctionData(
 157         final FunctionNode functionNode,
 158         final CodeInstaller installer,
 159         final AllocationStrategy allocationStrategy,
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2010, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 101      * Cached form of the AST. Either a {@code SerializedAst} object used by split functions as they can&#39;t be
 102      * reparsed from source, or a soft reference to a {@code FunctionNode} for other functions (it is safe
 103      * to be cleared as they can be reparsed).
 104      */
 105     private volatile transient Object cachedAst;
 106 
 107     /** Token of this function within the source. */
 108     private final long token;
 109 
 110     /**
 111      * Represents the allocation strategy (property map, script object class, and method handle) for when
 112      * this function is used as a constructor. Note that majority of functions (those not setting any this.*
 113      * properties) will share a single canonical &quot;default strategy&quot; instance.
 114      */
 115     private final AllocationStrategy allocationStrategy;
 116 
 117     /**
 118      * Opaque object representing parser state at the end of the function. Used when reparsing outer function
 119      * to help with skipping parsing inner functions.
 120      */
<span class="line-added"> 121     @SuppressWarnings(&quot;serial&quot;) // Not statically typed as Serializable</span>
 122     private final Object endParserState;
 123 
 124     /** Code installer used for all further recompilation/specialization of this ScriptFunction */
 125     private transient CodeInstaller installer;
 126 
<span class="line-added"> 127     @SuppressWarnings(&quot;serial&quot;) // Not statically typed as Serializable</span>
 128     private final Map&lt;Integer, RecompilableScriptFunctionData&gt; nestedFunctions;
 129 
 130     /** Id to parent function if one exists */
 131     private RecompilableScriptFunctionData parent;
 132 
 133     /** Copy of the {@link FunctionNode} flags. */
 134     private final int functionFlags;
 135 
 136     private static final MethodHandles.Lookup LOOKUP = MethodHandles.lookup();
 137 
 138     private transient DebugLogger log;
 139 
<span class="line-added"> 140     @SuppressWarnings(&quot;serial&quot;) // Not statically typed as Serializable</span>
 141     private final Map&lt;String, Integer&gt; externalScopeDepths;
 142 
<span class="line-added"> 143     @SuppressWarnings(&quot;serial&quot;) // Not statically typed as Serializable</span>
 144     private final Set&lt;String&gt; internalSymbols;
 145 
 146     private static final int GET_SET_PREFIX_LENGTH = &quot;*et &quot;.length();
 147 
 148     private static final long serialVersionUID = 4914839316174633726L;
 149 
 150     /**
 151      * Constructor - public as scripts use it
 152      *
 153      * @param functionNode        functionNode that represents this function code
 154      * @param installer           installer for code regeneration versions of this function
 155      * @param allocationStrategy  strategy for the allocation behavior when this function is used as a constructor
 156      * @param nestedFunctions     nested function map
 157      * @param externalScopeDepths external scope depths
 158      * @param internalSymbols     internal symbols to method, defined in its scope
 159      */
 160     public RecompilableScriptFunctionData(
 161         final FunctionNode functionNode,
 162         final CodeInstaller installer,
 163         final AllocationStrategy allocationStrategy,
</pre>
</td>
</tr>
</table>
<center><a href="Property.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SharedPropertyMap.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>