<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.compiler/share/classes/com/sun/tools/javac/util/MandatoryWarningHandler.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Log.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="Name.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.compiler/share/classes/com/sun/tools/javac/util/MandatoryWarningHandler.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2005, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2005, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 24,10 ***</span>
<span class="line-new-header">--- 24,11 ---</span>
   */
  
  package com.sun.tools.javac.util;
  
  import java.util.HashSet;
<span class="line-added">+ import java.util.Objects;</span>
  import java.util.Set;
  import javax.tools.JavaFileObject;
  
  import com.sun.tools.javac.code.Lint.LintCategory;
  import com.sun.tools.javac.util.JCDiagnostic.DiagnosticPosition;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 145,11 ***</span>
                  }
                  deferredDiagnosticSource = currentSource;
                  deferredDiagnosticArg = currentSource;
              } else if ((deferredDiagnosticKind == DeferredDiagnosticKind.IN_FILE
                          || deferredDiagnosticKind == DeferredDiagnosticKind.ADDITIONAL_IN_FILE)
<span class="line-modified">!                        &amp;&amp; !equal(deferredDiagnosticSource, currentSource)) {</span>
                  // additional errors in more than one source file
                  deferredDiagnosticKind = DeferredDiagnosticKind.ADDITIONAL_IN_FILES;
                  deferredDiagnosticArg = null;
              }
          } else {
<span class="line-new-header">--- 146,11 ---</span>
                  }
                  deferredDiagnosticSource = currentSource;
                  deferredDiagnosticArg = currentSource;
              } else if ((deferredDiagnosticKind == DeferredDiagnosticKind.IN_FILE
                          || deferredDiagnosticKind == DeferredDiagnosticKind.ADDITIONAL_IN_FILE)
<span class="line-modified">!                        &amp;&amp; !Objects.equals(deferredDiagnosticSource, currentSource)) {</span>
                  // additional errors in more than one source file
                  deferredDiagnosticKind = DeferredDiagnosticKind.ADDITIONAL_IN_FILES;
                  deferredDiagnosticArg = null;
              }
          } else {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 157,11 ***</span>
                  // warnings in a single source
                  deferredDiagnosticKind = DeferredDiagnosticKind.IN_FILE;
                  deferredDiagnosticSource = currentSource;
                  deferredDiagnosticArg = currentSource;
              }  else if (deferredDiagnosticKind == DeferredDiagnosticKind.IN_FILE &amp;&amp;
<span class="line-modified">!                         !equal(deferredDiagnosticSource, currentSource)) {</span>
                  // warnings in multiple source files
                  deferredDiagnosticKind = DeferredDiagnosticKind.IN_FILES;
                  deferredDiagnosticArg = null;
              }
          }
<span class="line-new-header">--- 158,11 ---</span>
                  // warnings in a single source
                  deferredDiagnosticKind = DeferredDiagnosticKind.IN_FILE;
                  deferredDiagnosticSource = currentSource;
                  deferredDiagnosticArg = currentSource;
              }  else if (deferredDiagnosticKind == DeferredDiagnosticKind.IN_FILE &amp;&amp;
<span class="line-modified">!                         !Objects.equals(deferredDiagnosticSource, currentSource)) {</span>
                  // warnings in multiple source files
                  deferredDiagnosticKind = DeferredDiagnosticKind.IN_FILES;
                  deferredDiagnosticArg = null;
              }
          }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 180,32 ***</span>
              if (!verbose)
                  logMandatoryNote(deferredDiagnosticSource, prefix + &quot;.recompile&quot;);
          }
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Check two objects, each possibly null, are either both null or are equal.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     private static boolean equal(Object o1, Object o2) {</span>
<span class="line-removed">-         return ((o1 == null || o2 == null) ? (o1 == o2) : o1.equals(o2));</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      /**
       * The log to which to report warnings.
       */
<span class="line-modified">!     private Log log;</span>
  
      /**
       * Whether or not to report individual warnings, or simply to report a
       * single aggregate warning at the end of the compilation.
       */
<span class="line-modified">!     private boolean verbose;</span>
  
      /**
       * The common prefix for all I18N message keys generated by this handler.
       */
<span class="line-modified">!     private String prefix;</span>
  
      /**
       * A set containing the names of the source files for which specific
       * warnings have been generated -- i.e. in verbose mode.  If a source name
       * appears in this list, then deferred diagnostics will be phrased to
<span class="line-new-header">--- 181,25 ---</span>
              if (!verbose)
                  logMandatoryNote(deferredDiagnosticSource, prefix + &quot;.recompile&quot;);
          }
      }
  
      /**
       * The log to which to report warnings.
       */
<span class="line-modified">!     private final Log log;</span>
  
      /**
       * Whether or not to report individual warnings, or simply to report a
       * single aggregate warning at the end of the compilation.
       */
<span class="line-modified">!     private final boolean verbose;</span>
  
      /**
       * The common prefix for all I18N message keys generated by this handler.
       */
<span class="line-modified">!     private final String prefix;</span>
  
      /**
       * A set containing the names of the source files for which specific
       * warnings have been generated -- i.e. in verbose mode.  If a source name
       * appears in this list, then deferred diagnostics will be phrased to
</pre>
<hr />
<pre>
<span class="line-old-header">*** 266,6 ***</span>
<span class="line-new-header">--- 260,13 ---</span>
          if (enforceMandatory)
              log.mandatoryNote(file, new Note(&quot;compiler&quot;, msg, args));
          else
              log.note(file, new Note(&quot;compiler&quot;, msg, args));
      }
<span class="line-added">+ </span>
<span class="line-added">+     public void clear() {</span>
<span class="line-added">+         sourcesWithReportedWarnings = null;</span>
<span class="line-added">+         deferredDiagnosticKind = null;</span>
<span class="line-added">+         deferredDiagnosticSource = null;</span>
<span class="line-added">+         deferredDiagnosticArg = null;</span>
<span class="line-added">+     }</span>
  }
</pre>
<center><a href="Log.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="Name.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>