<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.compiler/share/classes/com/sun/tools/javac/file/Locations.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="JavacFileManager.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../jvm/CRTable.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.compiler/share/classes/com/sun/tools/javac/file/Locations.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 92,10 ***</span>
<span class="line-new-header">--- 92,11 ---</span>
  import com.sun.tools.javac.jvm.ModuleNameReader;
  import com.sun.tools.javac.util.Iterators;
  import com.sun.tools.javac.util.Pair;
  import com.sun.tools.javac.util.StringUtils;
  
<span class="line-added">+ import static javax.tools.StandardLocation.SYSTEM_MODULES;</span>
  import static javax.tools.StandardLocation.PLATFORM_CLASS_PATH;
  
  import static com.sun.tools.javac.main.Option.BOOT_CLASS_PATH;
  import static com.sun.tools.javac.main.Option.ENDORSEDDIRS;
  import static com.sun.tools.javac.main.Option.EXTDIRS;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 183,10 ***</span>
<span class="line-new-header">--- 184,16 ---</span>
          BootClassPathLocationHandler h
                  = (BootClassPathLocationHandler) getHandler(PLATFORM_CLASS_PATH);
          return h.isDefault();
      }
  
<span class="line-added">+     boolean isDefaultSystemModulesPath() {</span>
<span class="line-added">+         SystemModulesLocationHandler h</span>
<span class="line-added">+                 = (SystemModulesLocationHandler) getHandler(SYSTEM_MODULES);</span>
<span class="line-added">+         return !h.isExplicit();</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      /**
       * Split a search path into its elements. Empty path elements will be ignored.
       *
       * @param searchPath The search path to be split
       * @return The elements of the path
</pre>
<hr />
<pre>
<span class="line-old-header">*** 224,11 ***</span>
          }
          return entries;
      }
  
      public void setMultiReleaseValue(String multiReleaseValue) {
<span class="line-modified">!         fsEnv = Collections.singletonMap(&quot;multi-release&quot;, multiReleaseValue);</span>
      }
  
      private boolean contains(Collection&lt;Path&gt; searchPath, Path file) throws IOException {
  
          if (searchPath == null) {
<span class="line-new-header">--- 231,11 ---</span>
          }
          return entries;
      }
  
      public void setMultiReleaseValue(String multiReleaseValue) {
<span class="line-modified">!         fsEnv = Collections.singletonMap(&quot;releaseVersion&quot;, multiReleaseValue);</span>
      }
  
      private boolean contains(Collection&lt;Path&gt; searchPath, Path file) throws IOException {
  
          if (searchPath == null) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 271,21 ***</span>
      private class SearchPath extends LinkedHashSet&lt;Path&gt; {
  
          private static final long serialVersionUID = 0;
  
          private boolean expandJarClassPaths = false;
<span class="line-modified">!         private final Set&lt;Path&gt; canonicalValues = new HashSet&lt;&gt;();</span>
  
          public SearchPath expandJarClassPaths(boolean x) {
              expandJarClassPaths = x;
              return this;
          }
  
          /**
           * What to use when path element is the empty string
           */
<span class="line-modified">!         private Path emptyPathDefault = null;</span>
  
          public SearchPath emptyPathDefault(Path x) {
              emptyPathDefault = x;
              return this;
          }
<span class="line-new-header">--- 278,21 ---</span>
      private class SearchPath extends LinkedHashSet&lt;Path&gt; {
  
          private static final long serialVersionUID = 0;
  
          private boolean expandJarClassPaths = false;
<span class="line-modified">!         private final transient Set&lt;Path&gt; canonicalValues = new HashSet&lt;&gt;();</span>
  
          public SearchPath expandJarClassPaths(boolean x) {
              expandJarClassPaths = x;
              return this;
          }
  
          /**
           * What to use when path element is the empty string
           */
<span class="line-modified">!         private transient Path emptyPathDefault = null;</span>
  
          public SearchPath emptyPathDefault(Path x) {
              emptyPathDefault = x;
              return this;
          }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 377,11 ***</span>
                      &amp;&amp; !file.endsWith(&quot;modules&quot;)) {
                      if (!isArchive(file)) {
                          /* Not a recognized extension; open it to see if
                           it looks like a valid zip file. */
                          try {
<span class="line-modified">!                             FileSystems.newFileSystem(file, null).close();</span>
                              if (warn) {
                                  log.warning(Lint.LintCategory.PATH,
                                              Warnings.UnexpectedArchiveFile(file));
                              }
                          } catch (IOException | ProviderNotFoundException e) {
<span class="line-new-header">--- 384,11 ---</span>
                      &amp;&amp; !file.endsWith(&quot;modules&quot;)) {
                      if (!isArchive(file)) {
                          /* Not a recognized extension; open it to see if
                           it looks like a valid zip file. */
                          try {
<span class="line-modified">!                             FileSystems.newFileSystem(file, (ClassLoader)null).close();</span>
                              if (warn) {
                                  log.warning(Lint.LintCategory.PATH,
                                              Warnings.UnexpectedArchiveFile(file));
                              }
                          } catch (IOException | ProviderNotFoundException e) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 970,11 ***</span>
              return Locations.this.contains(searchPath, file);
          }
      }
  
      /**
<span class="line-modified">!      * A LocationHander to represent modules found from a module-oriented</span>
       * location such as MODULE_SOURCE_PATH, UPGRADE_MODULE_PATH,
       * SYSTEM_MODULES and MODULE_PATH.
       *
       * The Location can be specified to accept overriding classes from the
       * {@code --patch-module &lt;module&gt;=&lt;path&gt; } parameter.
<span class="line-new-header">--- 977,11 ---</span>
              return Locations.this.contains(searchPath, file);
          }
      }
  
      /**
<span class="line-modified">!      * A LocationHandler to represent modules found from a module-oriented</span>
       * location such as MODULE_SOURCE_PATH, UPGRADE_MODULE_PATH,
       * SYSTEM_MODULES and MODULE_PATH.
       *
       * The Location can be specified to accept overriding classes from the
       * {@code --patch-module &lt;module&gt;=&lt;path&gt; } parameter.
</pre>
<center><a href="JavacFileManager.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../jvm/CRTable.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>