<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/jdk.compiler/share/classes/com/sun/tools/javac/util/Log.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ForwardingDiagnosticFormatter.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="MandatoryWarningHandler.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.compiler/share/classes/com/sun/tools/javac/util/Log.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 1999, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 1999, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -417,10 +417,18 @@</span>
  
      /** The number of warnings encountered so far.
       */
      public int nwarnings = 0;
  
<span class="udiff-line-added">+     /** The number of errors encountered after MaxErrors was reached.</span>
<span class="udiff-line-added">+      */</span>
<span class="udiff-line-added">+     public int nsuppressederrors = 0;</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     /** The number of warnings encountered after MaxWarnings was reached.</span>
<span class="udiff-line-added">+      */</span>
<span class="udiff-line-added">+     public int nsuppressedwarns = 0;</span>
<span class="udiff-line-added">+ </span>
      /** A set of all errors generated so far. This is used to avoid printing an
       *  error message more than once. For each error, a pair consisting of the
       *  source file name and source code position of the error is added to the set.
       */
      protected Set&lt;Pair&lt;JavaFileObject, Integer&gt;&gt; recorded = new HashSet&lt;&gt;();
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -544,10 +552,17 @@</span>
                      getCodeRecursive(buf, (JCDiagnostic)o);
                  }
              }
          }
  
<span class="udiff-line-added">+     /**Is an error reported at the given pos (inside the current source)?*/</span>
<span class="udiff-line-added">+     public boolean hasErrorOn(DiagnosticPosition pos) {</span>
<span class="udiff-line-added">+         JavaFileObject file = source != null ? source.fileObject : null;</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         return file != null &amp;&amp; recorded.contains(new Pair&lt;&gt;(file, pos.getPreferredPosition()));</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
      /** Prompt user after an error.
       */
      public void prompt() {
          if (promptOnError) {
              System.err.println(localize(&quot;resume.abort&quot;));
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -706,20 +721,25 @@</span>
              case WARNING:
                  if (emitWarnings || diagnostic.isMandatory()) {
                      if (nwarnings &lt; MaxWarnings) {
                          writeDiagnostic(diagnostic);
                          nwarnings++;
<span class="udiff-line-added">+                     } else {</span>
<span class="udiff-line-added">+                         nsuppressedwarns++;</span>
                      }
                  }
                  break;
  
              case ERROR:
<span class="udiff-line-modified-removed">-                 if (nerrors &lt; MaxErrors &amp;&amp;</span>
<span class="udiff-line-modified-removed">-                     (diagnostic.isFlagSet(DiagnosticFlag.API) ||</span>
<span class="udiff-line-modified-removed">-                      shouldReport(diagnostic))) {</span>
<span class="udiff-line-modified-removed">-                     writeDiagnostic(diagnostic);</span>
<span class="udiff-line-modified-removed">-                     nerrors++;</span>
<span class="udiff-line-modified-added">+                 if (diagnostic.isFlagSet(DiagnosticFlag.API) ||</span>
<span class="udiff-line-modified-added">+                      shouldReport(diagnostic)) {</span>
<span class="udiff-line-modified-added">+                     if (nerrors &lt; MaxErrors) {</span>
<span class="udiff-line-modified-added">+                         writeDiagnostic(diagnostic);</span>
<span class="udiff-line-modified-added">+                         nerrors++;</span>
<span class="udiff-line-added">+                     } else {</span>
<span class="udiff-line-added">+                         nsuppressederrors++;</span>
<span class="udiff-line-added">+                     }</span>
                  }
                  break;
              }
              if (diagnostic.isFlagSet(JCDiagnostic.DiagnosticFlag.COMPRESSED)) {
                  compressedOutput = true;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -842,20 +862,26 @@</span>
          PrintWriter errWriter = writers.get(WriterKind.ERROR);
          if (nerrors &lt; MaxErrors &amp;&amp; shouldReport(currentSourceFile(), pos)) {
              printRawDiag(errWriter, &quot;error: &quot;, pos, msg);
              prompt();
              nerrors++;
<span class="udiff-line-added">+         } else {</span>
<span class="udiff-line-added">+             nsuppressederrors++;</span>
          }
          errWriter.flush();
      }
  
      /** report a warning:
       */
      public void rawWarning(int pos, String msg) {
          PrintWriter warnWriter = writers.get(WriterKind.ERROR);
<span class="udiff-line-modified-removed">-         if (nwarnings &lt; MaxWarnings &amp;&amp; emitWarnings) {</span>
<span class="udiff-line-modified-removed">-             printRawDiag(warnWriter, &quot;warning: &quot;, pos, msg);</span>
<span class="udiff-line-modified-added">+         if (emitWarnings) {</span>
<span class="udiff-line-modified-added">+             if (nwarnings &lt; MaxWarnings) {</span>
<span class="udiff-line-added">+                 printRawDiag(warnWriter, &quot;warning: &quot;, pos, msg);</span>
<span class="udiff-line-added">+             } else {</span>
<span class="udiff-line-added">+                 nsuppressedwarns++;</span>
<span class="udiff-line-added">+             }</span>
          }
          prompt();
          nwarnings++;
          warnWriter.flush();
      }
</pre>
<center><a href="ForwardingDiagnosticFormatter.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="MandatoryWarningHandler.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>