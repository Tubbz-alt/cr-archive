<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/jdk.compiler/share/classes/com/sun/tools/javac/code/Type.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Symtab.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="TypeAnnotations.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.compiler/share/classes/com/sun/tools/javac/code/Type.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -34,11 +34,14 @@</span>
  import javax.lang.model.type.*;
  
  import com.sun.tools.javac.code.Symbol.*;
  import com.sun.tools.javac.code.TypeMetadata.Entry;
  import com.sun.tools.javac.code.Types.TypeMapping;
<span class="udiff-line-added">+ import com.sun.tools.javac.code.Types.UniqueType;</span>
  import com.sun.tools.javac.comp.Infer.IncorporationAction;
<span class="udiff-line-added">+ import com.sun.tools.javac.jvm.ClassFile;</span>
<span class="udiff-line-added">+ import com.sun.tools.javac.jvm.PoolConstant;</span>
  import com.sun.tools.javac.util.*;
  import com.sun.tools.javac.util.DefinedBy.Api;
  
  import static com.sun.tools.javac.code.BoundKind.*;
  import static com.sun.tools.javac.code.Flags.*;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -71,11 +74,11 @@</span>
   *  This code and its internal interfaces are subject to change or
   *  deletion without notice.&lt;/b&gt;
   *
   *  @see TypeTag
   */
<span class="udiff-line-modified-removed">- public abstract class Type extends AnnoConstruct implements TypeMirror {</span>
<span class="udiff-line-modified-added">+ public abstract class Type extends AnnoConstruct implements TypeMirror, PoolConstant {</span>
  
      /**
       * Type metadata,  Should be {@code null} for the default value.
       *
       * Note: it is an invariant that for any {@code TypeMetadata}
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -123,10 +126,20 @@</span>
  
      /** The defining class / interface / package / type variable.
       */
      public TypeSymbol tsym;
  
<span class="udiff-line-added">+     @Override</span>
<span class="udiff-line-added">+     public int poolTag() {</span>
<span class="udiff-line-added">+         throw new AssertionError(&quot;Invalid pool entry&quot;);</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     @Override</span>
<span class="udiff-line-added">+     public Object poolKey(Types types) {</span>
<span class="udiff-line-added">+         return new UniqueType(this, types);</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
      /**
       * Checks if the current type tag is equal to the given tag.
       * @return true if tag is equal to the current type tag.
       */
      public boolean hasTag(TypeTag tag) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -462,11 +475,11 @@</span>
          return sb.toString();
      }
  
      /**
       * The Java source which this type list represents.  A List is
<span class="udiff-line-modified-removed">-      * represented as a comma-spearated listing of the elements in</span>
<span class="udiff-line-modified-added">+      * represented as a comma-separated listing of the elements in</span>
       * that list.
       */
      public static String toString(List&lt;Type&gt; ts) {
          if (ts.isEmpty()) {
              return &quot;&quot;;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -928,11 +941,11 @@</span>
          public &lt;R, P&gt; R accept(TypeVisitor&lt;R, P&gt; v, P p) {
              return v.visitWildcard(this, p);
          }
      }
  
<span class="udiff-line-modified-removed">-     public static class ClassType extends Type implements DeclaredType,</span>
<span class="udiff-line-modified-added">+     public static class ClassType extends Type implements DeclaredType, LoadableConstant,</span>
                                                            javax.lang.model.type.ErrorType {
  
          /** The enclosing type of this type. If this is the type of an inner
           *  class, outer_field refers to the type of its enclosing
           *  instance class, in all other cases it refers to noType.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -973,10 +986,14 @@</span>
              this.allparams_field = null;
              this.supertype_field = null;
              this.interfaces_field = null;
          }
  
<span class="udiff-line-added">+         public int poolTag() {</span>
<span class="udiff-line-added">+             return ClassFile.CONSTANT_Class;</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+ </span>
          @Override
          public ClassType cloneWithMetadata(TypeMetadata md) {
              return new ClassType(outer_field, typarams_field, tsym, md) {
                  @Override
                  public Type baseType() { return ClassType.this.baseType(); }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1275,11 +1292,11 @@</span>
              return v.visitIntersection(this, p);
          }
      }
  
      public static class ArrayType extends Type
<span class="udiff-line-modified-removed">-             implements javax.lang.model.type.ArrayType {</span>
<span class="udiff-line-modified-added">+             implements LoadableConstant, javax.lang.model.type.ArrayType {</span>
  
          public Type elemtype;
  
          public ArrayType(Type elemtype, TypeSymbol arrayClass) {
              this(elemtype, arrayClass, TypeMetadata.EMPTY);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1295,10 +1312,14 @@</span>
              //note: type metadata is deliberately shared here, as we want side-effects from annotation
              //processing to flow from original array to the cloned array.
              this(that.elemtype, that.tsym, that.getMetadata());
          }
  
<span class="udiff-line-added">+         public int poolTag() {</span>
<span class="udiff-line-added">+             return ClassFile.CONSTANT_Class;</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+ </span>
          @Override
          public ArrayType cloneWithMetadata(TypeMetadata md) {
              return new ArrayType(elemtype, tsym, md) {
                  @Override
                  public Type baseType() { return ArrayType.this.baseType(); }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1410,11 +1431,11 @@</span>
          public &lt;R, P&gt; R accept(TypeVisitor&lt;R, P&gt; v, P p) {
              return v.visitArray(this, p);
          }
      }
  
<span class="udiff-line-modified-removed">-     public static class MethodType extends Type implements ExecutableType {</span>
<span class="udiff-line-modified-added">+     public static class MethodType extends Type implements ExecutableType, LoadableConstant {</span>
  
          public List&lt;Type&gt; argtypes;
          public Type restype;
          public List&lt;Type&gt; thrown;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1477,10 +1498,15 @@</span>
              return
                  isErroneous(argtypes) ||
                  restype != null &amp;&amp; restype.isErroneous();
          }
  
<span class="udiff-line-added">+         @Override</span>
<span class="udiff-line-added">+         public int poolTag() {</span>
<span class="udiff-line-added">+             return ClassFile.CONSTANT_MethodType;</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+ </span>
          public boolean contains(Type elem) {
              return elem.equalsIgnoreMetadata(this) || contains(argtypes, elem) || restype.contains(elem) || contains(thrown, elem);
          }
  
          public MethodType asMethodType() { return this; }
</pre>
<center><a href="Symtab.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="TypeAnnotations.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>