<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.compiler/share/classes/com/sun/tools/javac/code/Source.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Scope.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="Symbol.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.compiler/share/classes/com/sun/tools/javac/code/Source.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2002, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 67     JDK5(&quot;5&quot;),
 68 
 69     /** 1.6 reports encoding problems as errors instead of warnings. */
 70     JDK6(&quot;6&quot;),
 71 
 72     /** 1.7 introduced try-with-resources, multi-catch, string switch, etc. */
 73     JDK7(&quot;7&quot;),
 74 
 75     /** 1.8 lambda expressions and default methods. */
 76     JDK8(&quot;8&quot;),
 77 
 78     /** 1.9 modularity. */
 79     JDK9(&quot;9&quot;),
 80 
 81     /** 1.10 local-variable type inference (var). */
 82     JDK10(&quot;10&quot;),
 83 
 84     /** 1.11 local-variable syntax for lambda parameters */
 85     JDK11(&quot;11&quot;),
 86 
<span class="line-modified"> 87     /** 12 covers the to be determined language features that will be added in JDK 12. */</span>
 88     JDK12(&quot;12&quot;),
 89 
<span class="line-modified"> 90     /** 13 covers the to be determined language features that will be added in JDK 13. */</span>
<span class="line-modified"> 91     JDK13(&quot;13&quot;);</span>














 92 
 93     private static final Context.Key&lt;Source&gt; sourceKey = new Context.Key&lt;&gt;();
 94 
 95     public static Source instance(Context context) {
 96         Source instance = context.get(sourceKey);
 97         if (instance == null) {
 98             Options options = Options.instance(context);
 99             String sourceString = options.get(SOURCE);
100             if (sourceString != null) instance = lookup(sourceString);
101             if (instance == null) instance = DEFAULT;
102             context.put(sourceKey, instance);
103         }
104         return instance;
105     }
106 
107     public final String name;
108 
109     private static final Map&lt;String,Source&gt; tab = new HashMap&lt;&gt;();
110     static {
111         for (Source s : values()) {
</pre>
<hr />
<pre>
122 
123     private Source(String name) {
124         this.name = name;
125     }
126 
127     public static final Source MIN = Source.JDK7;
128 
129     private static final Source MAX = values()[values().length - 1];
130 
131     public static final Source DEFAULT = MAX;
132 
133     public static Source lookup(String name) {
134         return tab.get(name);
135     }
136 
137     public boolean isSupported() {
138         return this.compareTo(MIN) &gt;= 0;
139     }
140 
141     public Target requiredTarget() {


142         if (this.compareTo(JDK13) &gt;= 0) return Target.JDK1_13;
143         if (this.compareTo(JDK12) &gt;= 0) return Target.JDK1_12;
144         if (this.compareTo(JDK11) &gt;= 0) return Target.JDK1_11;
145         if (this.compareTo(JDK10) &gt;= 0) return Target.JDK1_10;
146         if (this.compareTo(JDK9) &gt;= 0) return Target.JDK1_9;
147         if (this.compareTo(JDK8) &gt;= 0) return Target.JDK1_8;
148         if (this.compareTo(JDK7) &gt;= 0) return Target.JDK1_7;
149         if (this.compareTo(JDK6) &gt;= 0) return Target.JDK1_6;
150         if (this.compareTo(JDK5) &gt;= 0) return Target.JDK1_5;
151         if (this.compareTo(JDK1_4) &gt;= 0) return Target.JDK1_4;
152         return Target.JDK1_1;
153     }
154 
155     /**
156      * Models a feature of the Java programming language. Each feature can be associated with a
157      * minimum source level, a maximum source level and a diagnostic fragment describing the feature,
158      * which is used to generate error messages of the kind {@code feature XYZ not supported in source N}.
159      */
160     public enum Feature {
161 
</pre>
<hr />
<pre>
169         DEFAULT_METHODS(JDK8, Fragments.FeatureDefaultMethods, DiagKind.PLURAL),
170         STATIC_INTERFACE_METHODS(JDK8, Fragments.FeatureStaticIntfMethods, DiagKind.PLURAL),
171         STATIC_INTERFACE_METHODS_INVOKE(JDK8, Fragments.FeatureStaticIntfMethodInvoke, DiagKind.PLURAL),
172         STRICT_METHOD_CLASH_CHECK(JDK8),
173         EFFECTIVELY_FINAL_IN_INNER_CLASSES(JDK8),
174         TYPE_ANNOTATIONS(JDK8, Fragments.FeatureTypeAnnotations, DiagKind.PLURAL),
175         ANNOTATIONS_AFTER_TYPE_PARAMS(JDK8, Fragments.FeatureAnnotationsAfterTypeParams, DiagKind.PLURAL),
176         REPEATED_ANNOTATIONS(JDK8, Fragments.FeatureRepeatableAnnotations, DiagKind.PLURAL),
177         INTERSECTION_TYPES_IN_CAST(JDK8, Fragments.FeatureIntersectionTypesInCast, DiagKind.PLURAL),
178         GRAPH_INFERENCE(JDK8),
179         FUNCTIONAL_INTERFACE_MOST_SPECIFIC(JDK8),
180         POST_APPLICABILITY_VARARGS_ACCESS_CHECK(JDK8),
181         MAP_CAPTURES_TO_BOUNDS(MIN, JDK7),
182         PRIVATE_SAFE_VARARGS(JDK9),
183         DIAMOND_WITH_ANONYMOUS_CLASS_CREATION(JDK9, Fragments.FeatureDiamondAndAnonClass, DiagKind.NORMAL),
184         UNDERSCORE_IDENTIFIER(MIN, JDK8),
185         PRIVATE_INTERFACE_METHODS(JDK9, Fragments.FeaturePrivateIntfMethods, DiagKind.PLURAL),
186         LOCAL_VARIABLE_TYPE_INFERENCE(JDK10),
187         VAR_SYNTAX_IMPLICIT_LAMBDAS(JDK11, Fragments.FeatureVarSyntaxInImplicitLambda, DiagKind.PLURAL),
188         IMPORT_ON_DEMAND_OBSERVABLE_PACKAGES(JDK1_2, JDK8),
<span class="line-modified">189         SWITCH_MULTIPLE_CASE_LABELS(JDK13, Fragments.FeatureMultipleCaseLabels, DiagKind.PLURAL),</span>
<span class="line-modified">190         SWITCH_RULE(JDK13, Fragments.FeatureSwitchRules, DiagKind.PLURAL),</span>
<span class="line-modified">191         SWITCH_EXPRESSION(JDK13, Fragments.FeatureSwitchExpressions, DiagKind.PLURAL);</span>





192 
193         enum DiagKind {
194             NORMAL,
195             PLURAL;
196         }
197 
198         private final Source minLevel;
199         private final Source maxLevel;
200         private final Fragment optFragment;
201         private final DiagKind optKind;
202 
203         Feature(Source minLevel) {
204             this(minLevel, null, null);
205         }
206 
207         Feature(Source minLevel, Fragment optFragment, DiagKind optKind) {
208             this(minLevel, MAX, optFragment, optKind);
209         }
210 
211         Feature(Source minLevel, Source maxLevel) {
</pre>
<hr />
<pre>
258         case JDK1_4:
259             return RELEASE_4;
260         case JDK5:
261             return RELEASE_5;
262         case JDK6:
263             return RELEASE_6;
264         case JDK7:
265             return RELEASE_7;
266         case JDK8:
267             return RELEASE_8;
268         case JDK9:
269             return RELEASE_9;
270         case JDK10:
271             return RELEASE_10;
272         case JDK11:
273             return RELEASE_11;
274         case JDK12:
275             return RELEASE_12;
276         case JDK13:
277             return RELEASE_13;




278         default:
279             return null;
280         }
281     }
282 }
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2002, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 67     JDK5(&quot;5&quot;),
 68 
 69     /** 1.6 reports encoding problems as errors instead of warnings. */
 70     JDK6(&quot;6&quot;),
 71 
 72     /** 1.7 introduced try-with-resources, multi-catch, string switch, etc. */
 73     JDK7(&quot;7&quot;),
 74 
 75     /** 1.8 lambda expressions and default methods. */
 76     JDK8(&quot;8&quot;),
 77 
 78     /** 1.9 modularity. */
 79     JDK9(&quot;9&quot;),
 80 
 81     /** 1.10 local-variable type inference (var). */
 82     JDK10(&quot;10&quot;),
 83 
 84     /** 1.11 local-variable syntax for lambda parameters */
 85     JDK11(&quot;11&quot;),
 86 
<span class="line-modified"> 87     /** 12, no language features; switch expression in preview */</span>
 88     JDK12(&quot;12&quot;),
 89 
<span class="line-modified"> 90     /**</span>
<span class="line-modified"> 91      * 13, no language features; text blocks and revised switch</span>
<span class="line-added"> 92      * expressions in preview</span>
<span class="line-added"> 93      */</span>
<span class="line-added"> 94     JDK13(&quot;13&quot;),</span>
<span class="line-added"> 95 </span>
<span class="line-added"> 96     /**</span>
<span class="line-added"> 97      * 14, switch expressions; pattern matching, records, and revised</span>
<span class="line-added"> 98      * text blocks in preview</span>
<span class="line-added"> 99      */</span>
<span class="line-added">100     JDK14(&quot;14&quot;),</span>
<span class="line-added">101 </span>
<span class="line-added">102     /**</span>
<span class="line-added">103       * 15, tbd</span>
<span class="line-added">104       */</span>
<span class="line-added">105     JDK15(&quot;15&quot;);</span>
106 
107     private static final Context.Key&lt;Source&gt; sourceKey = new Context.Key&lt;&gt;();
108 
109     public static Source instance(Context context) {
110         Source instance = context.get(sourceKey);
111         if (instance == null) {
112             Options options = Options.instance(context);
113             String sourceString = options.get(SOURCE);
114             if (sourceString != null) instance = lookup(sourceString);
115             if (instance == null) instance = DEFAULT;
116             context.put(sourceKey, instance);
117         }
118         return instance;
119     }
120 
121     public final String name;
122 
123     private static final Map&lt;String,Source&gt; tab = new HashMap&lt;&gt;();
124     static {
125         for (Source s : values()) {
</pre>
<hr />
<pre>
136 
137     private Source(String name) {
138         this.name = name;
139     }
140 
141     public static final Source MIN = Source.JDK7;
142 
143     private static final Source MAX = values()[values().length - 1];
144 
145     public static final Source DEFAULT = MAX;
146 
147     public static Source lookup(String name) {
148         return tab.get(name);
149     }
150 
151     public boolean isSupported() {
152         return this.compareTo(MIN) &gt;= 0;
153     }
154 
155     public Target requiredTarget() {
<span class="line-added">156         if (this.compareTo(JDK15) &gt;= 0) return Target.JDK1_15;</span>
<span class="line-added">157         if (this.compareTo(JDK14) &gt;= 0) return Target.JDK1_14;</span>
158         if (this.compareTo(JDK13) &gt;= 0) return Target.JDK1_13;
159         if (this.compareTo(JDK12) &gt;= 0) return Target.JDK1_12;
160         if (this.compareTo(JDK11) &gt;= 0) return Target.JDK1_11;
161         if (this.compareTo(JDK10) &gt;= 0) return Target.JDK1_10;
162         if (this.compareTo(JDK9) &gt;= 0) return Target.JDK1_9;
163         if (this.compareTo(JDK8) &gt;= 0) return Target.JDK1_8;
164         if (this.compareTo(JDK7) &gt;= 0) return Target.JDK1_7;
165         if (this.compareTo(JDK6) &gt;= 0) return Target.JDK1_6;
166         if (this.compareTo(JDK5) &gt;= 0) return Target.JDK1_5;
167         if (this.compareTo(JDK1_4) &gt;= 0) return Target.JDK1_4;
168         return Target.JDK1_1;
169     }
170 
171     /**
172      * Models a feature of the Java programming language. Each feature can be associated with a
173      * minimum source level, a maximum source level and a diagnostic fragment describing the feature,
174      * which is used to generate error messages of the kind {@code feature XYZ not supported in source N}.
175      */
176     public enum Feature {
177 
</pre>
<hr />
<pre>
185         DEFAULT_METHODS(JDK8, Fragments.FeatureDefaultMethods, DiagKind.PLURAL),
186         STATIC_INTERFACE_METHODS(JDK8, Fragments.FeatureStaticIntfMethods, DiagKind.PLURAL),
187         STATIC_INTERFACE_METHODS_INVOKE(JDK8, Fragments.FeatureStaticIntfMethodInvoke, DiagKind.PLURAL),
188         STRICT_METHOD_CLASH_CHECK(JDK8),
189         EFFECTIVELY_FINAL_IN_INNER_CLASSES(JDK8),
190         TYPE_ANNOTATIONS(JDK8, Fragments.FeatureTypeAnnotations, DiagKind.PLURAL),
191         ANNOTATIONS_AFTER_TYPE_PARAMS(JDK8, Fragments.FeatureAnnotationsAfterTypeParams, DiagKind.PLURAL),
192         REPEATED_ANNOTATIONS(JDK8, Fragments.FeatureRepeatableAnnotations, DiagKind.PLURAL),
193         INTERSECTION_TYPES_IN_CAST(JDK8, Fragments.FeatureIntersectionTypesInCast, DiagKind.PLURAL),
194         GRAPH_INFERENCE(JDK8),
195         FUNCTIONAL_INTERFACE_MOST_SPECIFIC(JDK8),
196         POST_APPLICABILITY_VARARGS_ACCESS_CHECK(JDK8),
197         MAP_CAPTURES_TO_BOUNDS(MIN, JDK7),
198         PRIVATE_SAFE_VARARGS(JDK9),
199         DIAMOND_WITH_ANONYMOUS_CLASS_CREATION(JDK9, Fragments.FeatureDiamondAndAnonClass, DiagKind.NORMAL),
200         UNDERSCORE_IDENTIFIER(MIN, JDK8),
201         PRIVATE_INTERFACE_METHODS(JDK9, Fragments.FeaturePrivateIntfMethods, DiagKind.PLURAL),
202         LOCAL_VARIABLE_TYPE_INFERENCE(JDK10),
203         VAR_SYNTAX_IMPLICIT_LAMBDAS(JDK11, Fragments.FeatureVarSyntaxInImplicitLambda, DiagKind.PLURAL),
204         IMPORT_ON_DEMAND_OBSERVABLE_PACKAGES(JDK1_2, JDK8),
<span class="line-modified">205         SWITCH_MULTIPLE_CASE_LABELS(JDK14, Fragments.FeatureMultipleCaseLabels, DiagKind.PLURAL),</span>
<span class="line-modified">206         SWITCH_RULE(JDK14, Fragments.FeatureSwitchRules, DiagKind.PLURAL),</span>
<span class="line-modified">207         SWITCH_EXPRESSION(JDK14, Fragments.FeatureSwitchExpressions, DiagKind.PLURAL),</span>
<span class="line-added">208         TEXT_BLOCKS(JDK15, Fragments.FeatureTextBlocks, DiagKind.PLURAL),</span>
<span class="line-added">209         PATTERN_MATCHING_IN_INSTANCEOF(JDK15, Fragments.FeaturePatternMatchingInstanceof, DiagKind.NORMAL),</span>
<span class="line-added">210         REIFIABLE_TYPES_INSTANCEOF(JDK15, Fragments.FeatureReifiableTypesInstanceof, DiagKind.PLURAL),</span>
<span class="line-added">211         RECORDS(JDK15, Fragments.FeatureRecords, DiagKind.PLURAL),</span>
<span class="line-added">212         ;</span>
213 
214         enum DiagKind {
215             NORMAL,
216             PLURAL;
217         }
218 
219         private final Source minLevel;
220         private final Source maxLevel;
221         private final Fragment optFragment;
222         private final DiagKind optKind;
223 
224         Feature(Source minLevel) {
225             this(minLevel, null, null);
226         }
227 
228         Feature(Source minLevel, Fragment optFragment, DiagKind optKind) {
229             this(minLevel, MAX, optFragment, optKind);
230         }
231 
232         Feature(Source minLevel, Source maxLevel) {
</pre>
<hr />
<pre>
279         case JDK1_4:
280             return RELEASE_4;
281         case JDK5:
282             return RELEASE_5;
283         case JDK6:
284             return RELEASE_6;
285         case JDK7:
286             return RELEASE_7;
287         case JDK8:
288             return RELEASE_8;
289         case JDK9:
290             return RELEASE_9;
291         case JDK10:
292             return RELEASE_10;
293         case JDK11:
294             return RELEASE_11;
295         case JDK12:
296             return RELEASE_12;
297         case JDK13:
298             return RELEASE_13;
<span class="line-added">299         case JDK14:</span>
<span class="line-added">300             return RELEASE_14;</span>
<span class="line-added">301         case JDK15:</span>
<span class="line-added">302             return RELEASE_15;</span>
303         default:
304             return null;
305         }
306     }
307 }
</pre>
</td>
</tr>
</table>
<center><a href="Scope.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="Symbol.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>