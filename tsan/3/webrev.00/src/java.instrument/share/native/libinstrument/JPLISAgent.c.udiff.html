<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.instrument/share/native/libinstrument/JPLISAgent.c</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="InvocationAdapter.c.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="JavaExceptions.c.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.instrument/share/native/libinstrument/JPLISAgent.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2003, 2017, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -387,40 +387,41 @@</span>
      /*
       *  OK, Java is up now. We can start everything that needs Java.
       */
  
      /*
<span class="udiff-line-modified-removed">-      *  First make our emergency fallback InternalError throwable.</span>
<span class="udiff-line-modified-added">+      *  First make our fallback InternalError throwable.</span>
       */
      result = initializeFallbackError(jnienv);
<span class="udiff-line-modified-removed">-     jplis_assert(result);</span>
<span class="udiff-line-modified-added">+     jplis_assert_msg(result, &quot;fallback init failed&quot;);</span>
  
      /*
       *  Now make the InstrumentationImpl instance.
       */
      if ( result ) {
          result = createInstrumentationImpl(jnienv, agent);
<span class="udiff-line-modified-removed">-         jplis_assert(result);</span>
<span class="udiff-line-modified-added">+         jplis_assert_msg(result, &quot;instrumentation instance creation failed&quot;);</span>
      }
  
  
      /*
       *  Register a handler for ClassFileLoadHook (without enabling this event).
       *  Turn off the VMInit handler.
       */
      if ( result ) {
          result = setLivePhaseEventHandlers(agent);
<span class="udiff-line-modified-removed">-         jplis_assert(result);</span>
<span class="udiff-line-modified-added">+         jplis_assert_msg(result, &quot;setting of live phase VM handlers failed&quot;);</span>
      }
  
      /*
       *  Load the Java agent, and call the premain.
       */
      if ( result ) {
          result = startJavaAgent(agent, jnienv,
                                  agent-&gt;mAgentClassName, agent-&gt;mOptionsString,
                                  agent-&gt;mPremainCaller);
<span class="udiff-line-added">+         jplis_assert_msg(result, &quot;agent load/premain call failed&quot;);</span>
      }
  
      /*
       * Finally surrender all of the tracking data that we don&#39;t need any more.
       * If something is wrong, skip it, we will be aborting the JVM anyway.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1483,10 +1484,11 @@</span>
               * the platform encoding is used.
               */
              platformLen = convertUft8ToPlatformString((char*)utf8Chars, utf8Len, platformChars, MAXPATHLEN);
              if (platformLen &lt; 0) {
                  createAndThrowInternalError(jnienv);
<span class="udiff-line-added">+                 (*jnienv)-&gt;ReleaseStringUTFChars(jnienv, jarFile, utf8Chars);</span>
                  return;
              }
  
              (*jnienv)-&gt;ReleaseStringUTFChars(jnienv, jarFile, utf8Chars);
              errorOutstanding = checkForAndClearThrowable(jnienv);
</pre>
<center><a href="InvocationAdapter.c.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="JavaExceptions.c.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>