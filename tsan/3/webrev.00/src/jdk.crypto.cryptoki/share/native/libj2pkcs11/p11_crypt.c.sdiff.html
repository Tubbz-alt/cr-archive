<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.crypto.cryptoki/share/native/libj2pkcs11/p11_crypt.c</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="p11_convert.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="p11_digest.c.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.crypto.cryptoki/share/native/libj2pkcs11/p11_crypt.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2003, 2012, Oracle and/or its affiliates. All rights reserved.</span>
  3  */
  4 
  5 /* Copyright  (c) 2002 Graz University of Technology. All rights reserved.
  6  *
  7  * Redistribution and use in  source and binary forms, with or without
  8  * modification, are permitted  provided that the following conditions are met:
  9  *
 10  * 1. Redistributions of  source code must retain the above copyright notice,
 11  *    this list of conditions and the following disclaimer.
 12  *
 13  * 2. Redistributions in  binary form must reproduce the above copyright notice,
 14  *    this list of conditions and the following disclaimer in the documentation
 15  *    and/or other materials provided with the distribution.
 16  *
 17  * 3. The end-user documentation included with the redistribution, if any, must
 18  *    include the following acknowledgment:
 19  *
 20  *    &quot;This product includes software developed by IAIK of Graz University of
 21  *     Technology.&quot;
 22  *
</pre>
<hr />
<pre>
 54 #include &lt;assert.h&gt;
 55 
 56 #include &quot;sun_security_pkcs11_wrapper_PKCS11.h&quot;
 57 
 58 #ifdef P11_ENABLE_C_ENCRYPTINIT
 59 /*
 60  * Class:     sun_security_pkcs11_wrapper_PKCS11
 61  * Method:    C_EncryptInit
 62  * Signature: (JLsun/security/pkcs11/wrapper/CK_MECHANISM;J)V
 63  * Parametermapping:                    *PKCS11*
 64  * @param   jlong jSessionHandle        CK_SESSION_HANDLE hSession
 65  * @param   jobject jMechanism          CK_MECHANISM_PTR pMechanism
 66  * @param   jlong jKeyHandle            CK_OBJECT_HANDLE hKey
 67  */
 68 JNIEXPORT void JNICALL
 69 Java_sun_security_pkcs11_wrapper_PKCS11_C_1EncryptInit
 70 (JNIEnv *env, jobject obj, jlong jSessionHandle,
 71  jobject jMechanism, jlong jKeyHandle)
 72 {
 73     CK_SESSION_HANDLE ckSessionHandle;
<span class="line-modified"> 74     CK_MECHANISM ckMechanism;</span>

 75     CK_OBJECT_HANDLE ckKeyHandle;
 76     CK_RV rv;
 77 
 78     CK_FUNCTION_LIST_PTR ckpFunctions = getFunctionList(env, obj);
 79     if (ckpFunctions == NULL) { return; }
 80 
 81     ckSessionHandle = jLongToCKULong(jSessionHandle);
 82     ckKeyHandle = jLongToCKULong(jKeyHandle);
<span class="line-modified"> 83     jMechanismToCKMechanism(env, jMechanism, &amp;ckMechanism);</span>



 84     if ((*env)-&gt;ExceptionCheck(env)) { return; }
 85 
<span class="line-modified"> 86     rv = (*ckpFunctions-&gt;C_EncryptInit)(ckSessionHandle, &amp;ckMechanism,</span>
 87                                         ckKeyHandle);
 88 
<span class="line-modified"> 89     if (ckMechanism.pParameter != NULL_PTR) {</span>
<span class="line-modified"> 90         free(ckMechanism.pParameter);</span>









 91     }
 92 


 93     if (ckAssertReturnValueOK(env, rv) != CK_ASSERT_OK) { return; }


 94 }
 95 #endif
 96 
 97 #ifdef P11_ENABLE_C_ENCRYPT
 98 /*
 99  * Class:     sun_security_pkcs11_wrapper_PKCS11
100  * Method:    C_Encrypt
<span class="line-modified">101  * Signature: (J[BII[BII)I</span>
102  * Parametermapping:                    *PKCS11*
103  * @param   jlong jSessionHandle        CK_SESSION_HANDLE hSession

104  * @param   jbyteArray jData            CK_BYTE_PTR pData
105  *                                      CK_ULONG ulDataLen
<span class="line-modified">106  * @return  jbyteArray jEncryptedData   CK_BYTE_PTR pEncryptedData</span>

107  *                                      CK_ULONG_PTR pulEncryptedDataLen
108  */
109 JNIEXPORT jint JNICALL
110 Java_sun_security_pkcs11_wrapper_PKCS11_C_1Encrypt
111 (JNIEnv *env, jobject obj, jlong jSessionHandle,
<span class="line-modified">112  jbyteArray jIn, jint jInOfs, jint jInLen,</span>
<span class="line-modified">113  jbyteArray jOut, jint jOutOfs, jint jOutLen)</span>
114 {
115     CK_SESSION_HANDLE ckSessionHandle;
116     CK_RV rv;
117 
118     CK_BYTE_PTR inBufP;
119     CK_BYTE_PTR outBufP;
<span class="line-modified">120     CK_ULONG ckEncryptedPartLen;</span>
121 
122     CK_FUNCTION_LIST_PTR ckpFunctions = getFunctionList(env, obj);
123     if (ckpFunctions == NULL) { return 0; }
124 
125     ckSessionHandle = jLongToCKULong(jSessionHandle);
126 
<span class="line-modified">127     inBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jIn, NULL);</span>
<span class="line-modified">128     if (inBufP == NULL) { return 0; }</span>




129 
<span class="line-modified">130     outBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jOut, NULL);</span>
<span class="line-modified">131     if (outBufP == NULL) {</span>
<span class="line-modified">132         // Make sure to release inBufP</span>
<span class="line-modified">133         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);</span>
<span class="line-modified">134         return 0;</span>


135     }
136 
<span class="line-modified">137     ckEncryptedPartLen = jOutLen;</span>
138 
139     rv = (*ckpFunctions-&gt;C_Encrypt)(ckSessionHandle,
140                                     (CK_BYTE_PTR)(inBufP + jInOfs), jInLen,
141                                     (CK_BYTE_PTR)(outBufP + jOutOfs),
<span class="line-modified">142                                     &amp;ckEncryptedPartLen);</span>
<span class="line-removed">143 </span>
<span class="line-removed">144     (*env)-&gt;ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);</span>
<span class="line-removed">145     (*env)-&gt;ReleasePrimitiveArrayCritical(env, jOut, outBufP, JNI_COMMIT);</span>
146 
147     ckAssertReturnValueOK(env, rv);
<span class="line-modified">148     return ckEncryptedPartLen;</span>








149 }
150 #endif
151 
152 #ifdef P11_ENABLE_C_ENCRYPTUPDATE
153 /*
154  * Class:     sun_security_pkcs11_wrapper_PKCS11
155  * Method:    C_EncryptUpdate
156  * Signature: (J[BII[BII)I
157  * Parametermapping:                    *PKCS11*
158  * @param   jlong jSessionHandle        CK_SESSION_HANDLE hSession
159  * @param   jbyteArray jPart            CK_BYTE_PTR pPart
160  *                                      CK_ULONG ulPartLen
161  * @return  jbyteArray jEncryptedPart   CK_BYTE_PTR pEncryptedPart
162  *                                      CK_ULONG_PTR pulEncryptedPartLen
163  */
164 JNIEXPORT jint JNICALL
165 Java_sun_security_pkcs11_wrapper_PKCS11_C_1EncryptUpdate
166 (JNIEnv *env, jobject obj, jlong jSessionHandle,
167  jlong directIn, jbyteArray jIn, jint jInOfs, jint jInLen,
168  jlong directOut, jbyteArray jOut, jint jOutOfs, jint jOutLen)
169 {
170     CK_SESSION_HANDLE ckSessionHandle;
171     CK_RV rv;
172 
173     CK_BYTE_PTR inBufP;
174     CK_BYTE_PTR outBufP;
<span class="line-modified">175     CK_ULONG ckEncryptedPartLen;</span>
176 
177     CK_FUNCTION_LIST_PTR ckpFunctions = getFunctionList(env, obj);
178     if (ckpFunctions == NULL) { return 0; }
179 
180     ckSessionHandle = jLongToCKULong(jSessionHandle);
181 
182     if (directIn != 0) {
183       inBufP = (CK_BYTE_PTR) jlong_to_ptr(directIn);
184     } else {
185       inBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jIn, NULL);
186       if (inBufP == NULL) { return 0; }
187     }
188 
189     if (directOut != 0) {
190       outBufP = (CK_BYTE_PTR) jlong_to_ptr(directOut);
191     } else {
192       outBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jOut, NULL);
193       if (outBufP == NULL) {
<span class="line-modified">194           // Make sure to release inBufP</span>
<span class="line-removed">195           (*env)-&gt;ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);</span>
<span class="line-removed">196           return 0;</span>
197       }
198     }
199 
200     ckEncryptedPartLen = jOutLen;
201 
<span class="line-removed">202     //printf(&quot;EU: inBufP=%i, jInOfs=%i, jInLen=%i, outBufP=%i\n&quot;,</span>
<span class="line-removed">203     //       inBufP, jInOfs, jInLen, outBufP);</span>
<span class="line-removed">204 </span>
205     rv = (*ckpFunctions-&gt;C_EncryptUpdate)(ckSessionHandle,
206                                           (CK_BYTE_PTR)(inBufP + jInOfs), jInLen,
207                                           (CK_BYTE_PTR)(outBufP + jOutOfs),
208                                           &amp;ckEncryptedPartLen);
209 
<span class="line-modified">210     //printf(&quot;EU: ckEncryptedPartLen=%i\n&quot;, ckEncryptedPartLen);</span>
211 
<span class="line-modified">212     if (directIn == 0) {</span>

213         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);
214     }
<span class="line-modified">215 </span>
<span class="line-removed">216     if (directOut == 0) {</span>
217         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jOut, outBufP, JNI_COMMIT);
218     }
<span class="line-removed">219 </span>
<span class="line-removed">220     ckAssertReturnValueOK(env, rv);</span>
<span class="line-removed">221 </span>
222     return ckEncryptedPartLen;
223 }
224 #endif
225 
226 #ifdef P11_ENABLE_C_ENCRYPTFINAL
227 /*
228  * Class:     sun_security_pkcs11_wrapper_PKCS11
229  * Method:    C_EncryptFinal
230  * Signature: (J[BII)I
231  * Parametermapping:                        *PKCS11*
232  * @param   jlong jSessionHandle            CK_SESSION_HANDLE hSession
233  * @return  jbyteArray jLastEncryptedPart   CK_BYTE_PTR pLastEncryptedDataPart
234  *                                          CK_ULONG_PTR pulLastEncryptedDataPartLen
235  */
236 JNIEXPORT jint JNICALL
237 Java_sun_security_pkcs11_wrapper_PKCS11_C_1EncryptFinal
238 (JNIEnv *env, jobject obj, jlong jSessionHandle,
239  jlong directOut, jbyteArray jOut, jint jOutOfs, jint jOutLen)
240 {
241     CK_SESSION_HANDLE ckSessionHandle;
242     CK_RV rv;
243     CK_BYTE_PTR outBufP;
244     CK_ULONG ckLastEncryptedPartLen;
245 
246     CK_FUNCTION_LIST_PTR ckpFunctions = getFunctionList(env, obj);
247     if (ckpFunctions == NULL) { return 0; }
248 
249     ckSessionHandle = jLongToCKULong(jSessionHandle);
250 
251     if (directOut != 0) {
252       outBufP = (CK_BYTE_PTR) jlong_to_ptr(directOut);
253     } else {
254       outBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jOut, NULL);
255       if (outBufP == NULL) { return 0; }
256     }
257 
258     ckLastEncryptedPartLen = jOutLen;
259 
<span class="line-removed">260     //printf(&quot;EF: outBufP=%i\n&quot;, outBufP);</span>
<span class="line-removed">261 </span>
262     rv = (*ckpFunctions-&gt;C_EncryptFinal)(ckSessionHandle,
263                                          (CK_BYTE_PTR)(outBufP + jOutOfs),
264                                          &amp;ckLastEncryptedPartLen);
265 
<span class="line-removed">266     //printf(&quot;EF: ckLastEncryptedPartLen=%i&quot;, ckLastEncryptedPartLen);</span>
<span class="line-removed">267 </span>
268     if (directOut == 0) {
269         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jOut, outBufP, JNI_COMMIT);
270     }
271 
272     ckAssertReturnValueOK(env, rv);
273 
274     return ckLastEncryptedPartLen;
275 }
276 #endif
277 
278 #ifdef P11_ENABLE_C_DECRYPTINIT
279 /*
280  * Class:     sun_security_pkcs11_wrapper_PKCS11
281  * Method:    C_DecryptInit
282  * Signature: (JLsun/security/pkcs11/wrapper/CK_MECHANISM;J)V
283  * Parametermapping:                    *PKCS11*
284  * @param   jlong jSessionHandle        CK_SESSION_HANDLE hSession
285  * @param   jobject jMechanism          CK_MECHANISM_PTR pMechanism
286  * @param   jlong jKeyHandle            CK_OBJECT_HANDLE hKey
287  */
288 JNIEXPORT void JNICALL
289 Java_sun_security_pkcs11_wrapper_PKCS11_C_1DecryptInit
290 (JNIEnv *env, jobject obj, jlong jSessionHandle,
291  jobject jMechanism, jlong jKeyHandle)
292 {
293     CK_SESSION_HANDLE ckSessionHandle;
<span class="line-modified">294     CK_MECHANISM ckMechanism;</span>

295     CK_OBJECT_HANDLE ckKeyHandle;
296     CK_RV rv;
297 
298     CK_FUNCTION_LIST_PTR ckpFunctions = getFunctionList(env, obj);
299     if (ckpFunctions == NULL) { return; }
300 
301     ckSessionHandle = jLongToCKULong(jSessionHandle);
302     ckKeyHandle = jLongToCKULong(jKeyHandle);
<span class="line-modified">303     jMechanismToCKMechanism(env, jMechanism, &amp;ckMechanism);</span>



304     if ((*env)-&gt;ExceptionCheck(env)) { return; }
305 
<span class="line-modified">306     rv = (*ckpFunctions-&gt;C_DecryptInit)(ckSessionHandle, &amp;ckMechanism,</span>
307                                         ckKeyHandle);
308 
<span class="line-modified">309     if (ckMechanism.pParameter != NULL_PTR) {</span>
<span class="line-modified">310         free(ckMechanism.pParameter);</span>









311     }
312 


313     if (ckAssertReturnValueOK(env, rv) != CK_ASSERT_OK) { return; }


314 }
315 #endif
316 
317 #ifdef P11_ENABLE_C_DECRYPT
318 /*
319  * Class:     sun_security_pkcs11_wrapper_PKCS11
320  * Method:    C_Decrypt
<span class="line-modified">321  * Signature: (J[BII[BII)I</span>
322  * Parametermapping:                    *PKCS11*
323  * @param   jlong jSessionHandle        CK_SESSION_HANDLE hSession
324  * @param   jbyteArray jEncryptedData   CK_BYTE_PTR pEncryptedData
325  *                                      CK_ULONG ulEncryptedDataLen
326  * @return  jbyteArray jData            CK_BYTE_PTR pData
327  *                                      CK_ULONG_PTR pulDataLen
328  */
329 JNIEXPORT jint JNICALL
330 Java_sun_security_pkcs11_wrapper_PKCS11_C_1Decrypt
331 (JNIEnv *env, jobject obj, jlong jSessionHandle,
<span class="line-modified">332  jbyteArray jIn, jint jInOfs, jint jInLen,</span>
<span class="line-modified">333  jbyteArray jOut, jint jOutOfs, jint jOutLen)</span>
334 {
335     CK_SESSION_HANDLE ckSessionHandle;
336     CK_RV rv;
337 
338     CK_BYTE_PTR inBufP;
339     CK_BYTE_PTR outBufP;
<span class="line-modified">340     CK_ULONG ckPartLen;</span>
341 
342     CK_FUNCTION_LIST_PTR ckpFunctions = getFunctionList(env, obj);
343     if (ckpFunctions == NULL) { return 0; }
344 
345     ckSessionHandle = jLongToCKULong(jSessionHandle);
346 
<span class="line-modified">347     inBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jIn, NULL);</span>
<span class="line-modified">348     if (inBufP == NULL) { return 0; }</span>
<span class="line-modified">349 </span>
<span class="line-modified">350     outBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jOut, NULL);</span>
<span class="line-modified">351     if (outBufP == NULL) {</span>
<span class="line-removed">352         // Make sure to release inBufP</span>
<span class="line-removed">353         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);</span>
<span class="line-removed">354         return 0;</span>
355     }
356 
<span class="line-modified">357     ckPartLen = jOutLen;</span>








358 
359     rv = (*ckpFunctions-&gt;C_Decrypt)(ckSessionHandle,
360                                     (CK_BYTE_PTR)(inBufP + jInOfs), jInLen,
361                                     (CK_BYTE_PTR)(outBufP + jOutOfs),
<span class="line-modified">362                                     &amp;ckPartLen);</span>
<span class="line-removed">363 </span>
<span class="line-removed">364     (*env)-&gt;ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);</span>
<span class="line-removed">365     (*env)-&gt;ReleasePrimitiveArrayCritical(env, jOut, outBufP, JNI_COMMIT);</span>
366 
367     ckAssertReturnValueOK(env, rv);
368 
<span class="line-modified">369     return ckPartLen;</span>







370 }
371 #endif
372 
373 #ifdef P11_ENABLE_C_DECRYPTUPDATE
374 /*
375  * Class:     sun_security_pkcs11_wrapper_PKCS11
376  * Method:    C_DecryptUpdate
377  * Signature: (J[BII[BII)I
378  * Parametermapping:                    *PKCS11*
379  * @param   jlong jSessionHandle        CK_SESSION_HANDLE hSession
380  * @param   jbyteArray jEncryptedPart   CK_BYTE_PTR pEncryptedPart
381  *                                      CK_ULONG ulEncryptedPartLen
382  * @return  jbyteArray jPart            CK_BYTE_PTR pPart
383  *                                      CK_ULONG_PTR pulPartLen
384  */
385 JNIEXPORT jint JNICALL
386 Java_sun_security_pkcs11_wrapper_PKCS11_C_1DecryptUpdate
387 (JNIEnv *env, jobject obj, jlong jSessionHandle,
388  jlong directIn, jbyteArray jIn, jint jInOfs, jint jInLen,
389  jlong directOut, jbyteArray jOut, jint jOutOfs, jint jOutLen)
390 {
391     CK_SESSION_HANDLE ckSessionHandle;
392     CK_RV rv;
393 
394     CK_BYTE_PTR inBufP;
395     CK_BYTE_PTR outBufP;
<span class="line-modified">396     CK_ULONG ckDecryptedPartLen;</span>
397 
398     CK_FUNCTION_LIST_PTR ckpFunctions = getFunctionList(env, obj);
399     if (ckpFunctions == NULL) { return 0; }
400 
401     ckSessionHandle = jLongToCKULong(jSessionHandle);
402 
403     if (directIn != 0) {
404       inBufP = (CK_BYTE_PTR) jlong_to_ptr(directIn);
405     } else {
406       inBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jIn, NULL);
407       if (inBufP == NULL) { return 0; }
408     }
409 
410     if (directOut != 0) {
411       outBufP = (CK_BYTE_PTR) jlong_to_ptr(directOut);
412     } else {
413       outBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jOut, NULL);
414       if (outBufP == NULL) {
<span class="line-modified">415           // Make sure to release inBufP</span>
<span class="line-removed">416           (*env)-&gt;ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);</span>
<span class="line-removed">417           return 0;</span>
418       }
419     }
420 
421     ckDecryptedPartLen = jOutLen;
<span class="line-removed">422 </span>
423     rv = (*ckpFunctions-&gt;C_DecryptUpdate)(ckSessionHandle,
424                                           (CK_BYTE_PTR)(inBufP + jInOfs), jInLen,
425                                           (CK_BYTE_PTR)(outBufP + jOutOfs),
426                                           &amp;ckDecryptedPartLen);
<span class="line-modified">427     if (directIn == 0) {</span>



428         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);
429     }
<span class="line-modified">430 </span>
<span class="line-removed">431     if (directOut == 0) {</span>
432         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jOut, outBufP, JNI_COMMIT);
433     }
<span class="line-removed">434 </span>
<span class="line-removed">435     ckAssertReturnValueOK(env, rv);</span>
<span class="line-removed">436 </span>
437     return ckDecryptedPartLen;
438 }
439 
440 #endif
441 
442 #ifdef P11_ENABLE_C_DECRYPTFINAL
443 /*
444  * Class:     sun_security_pkcs11_wrapper_PKCS11
445  * Method:    C_DecryptFinal
446  * Signature: (J[BII)I
447  * Parametermapping:                    *PKCS11*
448  * @param   jlong jSessionHandle        CK_SESSION_HANDLE hSession
449  * @return  jbyteArray jLastPart        CK_BYTE_PTR pLastPart
450  *                                      CK_ULONG_PTR pulLastPartLen
451  */
452 JNIEXPORT jint JNICALL
453 Java_sun_security_pkcs11_wrapper_PKCS11_C_1DecryptFinal
454 (JNIEnv *env, jobject obj, jlong jSessionHandle,
455  jlong directOut, jbyteArray jOut, jint jOutOfs, jint jOutLen)
456 {
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  */
  4 
  5 /* Copyright  (c) 2002 Graz University of Technology. All rights reserved.
  6  *
  7  * Redistribution and use in  source and binary forms, with or without
  8  * modification, are permitted  provided that the following conditions are met:
  9  *
 10  * 1. Redistributions of  source code must retain the above copyright notice,
 11  *    this list of conditions and the following disclaimer.
 12  *
 13  * 2. Redistributions in  binary form must reproduce the above copyright notice,
 14  *    this list of conditions and the following disclaimer in the documentation
 15  *    and/or other materials provided with the distribution.
 16  *
 17  * 3. The end-user documentation included with the redistribution, if any, must
 18  *    include the following acknowledgment:
 19  *
 20  *    &quot;This product includes software developed by IAIK of Graz University of
 21  *     Technology.&quot;
 22  *
</pre>
<hr />
<pre>
 54 #include &lt;assert.h&gt;
 55 
 56 #include &quot;sun_security_pkcs11_wrapper_PKCS11.h&quot;
 57 
 58 #ifdef P11_ENABLE_C_ENCRYPTINIT
 59 /*
 60  * Class:     sun_security_pkcs11_wrapper_PKCS11
 61  * Method:    C_EncryptInit
 62  * Signature: (JLsun/security/pkcs11/wrapper/CK_MECHANISM;J)V
 63  * Parametermapping:                    *PKCS11*
 64  * @param   jlong jSessionHandle        CK_SESSION_HANDLE hSession
 65  * @param   jobject jMechanism          CK_MECHANISM_PTR pMechanism
 66  * @param   jlong jKeyHandle            CK_OBJECT_HANDLE hKey
 67  */
 68 JNIEXPORT void JNICALL
 69 Java_sun_security_pkcs11_wrapper_PKCS11_C_1EncryptInit
 70 (JNIEnv *env, jobject obj, jlong jSessionHandle,
 71  jobject jMechanism, jlong jKeyHandle)
 72 {
 73     CK_SESSION_HANDLE ckSessionHandle;
<span class="line-modified"> 74     CK_MECHANISM_PTR ckpMechanism = NULL;</span>
<span class="line-added"> 75     CK_MECHANISM_PTR ckpTemp;</span>
 76     CK_OBJECT_HANDLE ckKeyHandle;
 77     CK_RV rv;
 78 
 79     CK_FUNCTION_LIST_PTR ckpFunctions = getFunctionList(env, obj);
 80     if (ckpFunctions == NULL) { return; }
 81 
 82     ckSessionHandle = jLongToCKULong(jSessionHandle);
 83     ckKeyHandle = jLongToCKULong(jKeyHandle);
<span class="line-modified"> 84     ckpMechanism = jMechanismToCKMechanismPtr(env, jMechanism);</span>
<span class="line-added"> 85     TRACE1(&quot;DEBUG C_EncryptInit: created pMech = %p\n&quot;,</span>
<span class="line-added"> 86             ckpMechanism);</span>
<span class="line-added"> 87 </span>
 88     if ((*env)-&gt;ExceptionCheck(env)) { return; }
 89 
<span class="line-modified"> 90     rv = (*ckpFunctions-&gt;C_EncryptInit)(ckSessionHandle, ckpMechanism,</span>
 91                                         ckKeyHandle);
 92 
<span class="line-modified"> 93     if (ckpMechanism-&gt;mechanism == CKM_AES_GCM) {</span>
<span class="line-modified"> 94         if (rv == CKR_ARGUMENTS_BAD || rv == CKR_MECHANISM_PARAM_INVALID) {</span>
<span class="line-added"> 95             // retry with CKM_GCM_PARAMS structure in pkcs11t.h</span>
<span class="line-added"> 96             TRACE0(&quot;DEBUG C_EncryptInit: retry with CK_GCM_PARAMS\n&quot;);</span>
<span class="line-added"> 97             ckpTemp = updateGCMParams(env, ckpMechanism);</span>
<span class="line-added"> 98             if (ckpTemp != NULL) { // only re-call if conversion succeeds</span>
<span class="line-added"> 99                 ckpMechanism = ckpTemp;</span>
<span class="line-added">100                 rv = (*ckpFunctions-&gt;C_EncryptInit)(ckSessionHandle, ckpMechanism,</span>
<span class="line-added">101                         ckKeyHandle);</span>
<span class="line-added">102             }</span>
<span class="line-added">103         }</span>
104     }
105 
<span class="line-added">106     TRACE1(&quot;DEBUG C_EncryptInit: freed pMech = %p\n&quot;, ckpMechanism);</span>
<span class="line-added">107     freeCKMechanismPtr(ckpMechanism);</span>
108     if (ckAssertReturnValueOK(env, rv) != CK_ASSERT_OK) { return; }
<span class="line-added">109 </span>
<span class="line-added">110     TRACE0(&quot;FINISHED\n&quot;);</span>
111 }
112 #endif
113 
114 #ifdef P11_ENABLE_C_ENCRYPT
115 /*
116  * Class:     sun_security_pkcs11_wrapper_PKCS11
117  * Method:    C_Encrypt
<span class="line-modified">118  * Signature: (JJ[BIIJ[BII)I</span>
119  * Parametermapping:                    *PKCS11*
120  * @param   jlong jSessionHandle        CK_SESSION_HANDLE hSession
<span class="line-added">121  * @param   jlong directIn              CK_BYTE_PTR pData</span>
122  * @param   jbyteArray jData            CK_BYTE_PTR pData
123  *                                      CK_ULONG ulDataLen
<span class="line-modified">124  * @param   jlong directOut             CK_BYTE_PTR pEncryptedData</span>
<span class="line-added">125  * @return  jint encryptedDataLen       CK_BYTE_PTR pEncryptedData</span>
126  *                                      CK_ULONG_PTR pulEncryptedDataLen
127  */
128 JNIEXPORT jint JNICALL
129 Java_sun_security_pkcs11_wrapper_PKCS11_C_1Encrypt
130 (JNIEnv *env, jobject obj, jlong jSessionHandle,
<span class="line-modified">131  jlong directIn, jbyteArray jIn, jint jInOfs, jint jInLen,</span>
<span class="line-modified">132  jlong directOut, jbyteArray jOut, jint jOutOfs, jint jOutLen)</span>
133 {
134     CK_SESSION_HANDLE ckSessionHandle;
135     CK_RV rv;
136 
137     CK_BYTE_PTR inBufP;
138     CK_BYTE_PTR outBufP;
<span class="line-modified">139     CK_ULONG ckEncryptedLen = 0;</span>
140 
141     CK_FUNCTION_LIST_PTR ckpFunctions = getFunctionList(env, obj);
142     if (ckpFunctions == NULL) { return 0; }
143 
144     ckSessionHandle = jLongToCKULong(jSessionHandle);
145 
<span class="line-modified">146     if (directIn != 0) {</span>
<span class="line-modified">147       inBufP = (CK_BYTE_PTR) jlong_to_ptr(directIn);</span>
<span class="line-added">148     } else {</span>
<span class="line-added">149       inBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jIn, NULL);</span>
<span class="line-added">150       if (inBufP == NULL) { return 0; }</span>
<span class="line-added">151     }</span>
152 
<span class="line-modified">153     if (directOut != 0) {</span>
<span class="line-modified">154       outBufP = (CK_BYTE_PTR) jlong_to_ptr(directOut);</span>
<span class="line-modified">155     } else {</span>
<span class="line-modified">156       outBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jOut, NULL);</span>
<span class="line-modified">157       if (outBufP == NULL) {</span>
<span class="line-added">158           goto cleanup;</span>
<span class="line-added">159       }</span>
160     }
161 
<span class="line-modified">162     ckEncryptedLen = jOutLen;</span>
163 
164     rv = (*ckpFunctions-&gt;C_Encrypt)(ckSessionHandle,
165                                     (CK_BYTE_PTR)(inBufP + jInOfs), jInLen,
166                                     (CK_BYTE_PTR)(outBufP + jOutOfs),
<span class="line-modified">167                                     &amp;ckEncryptedLen);</span>



168 
169     ckAssertReturnValueOK(env, rv);
<span class="line-modified">170 </span>
<span class="line-added">171 cleanup:</span>
<span class="line-added">172     if (directIn == 0 &amp;&amp; inBufP != NULL) {</span>
<span class="line-added">173         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);</span>
<span class="line-added">174     }</span>
<span class="line-added">175     if (directOut == 0 &amp;&amp; outBufP != NULL) {</span>
<span class="line-added">176         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jOut, outBufP, JNI_COMMIT);</span>
<span class="line-added">177     }</span>
<span class="line-added">178     return ckEncryptedLen;</span>
179 }
180 #endif
181 
182 #ifdef P11_ENABLE_C_ENCRYPTUPDATE
183 /*
184  * Class:     sun_security_pkcs11_wrapper_PKCS11
185  * Method:    C_EncryptUpdate
186  * Signature: (J[BII[BII)I
187  * Parametermapping:                    *PKCS11*
188  * @param   jlong jSessionHandle        CK_SESSION_HANDLE hSession
189  * @param   jbyteArray jPart            CK_BYTE_PTR pPart
190  *                                      CK_ULONG ulPartLen
191  * @return  jbyteArray jEncryptedPart   CK_BYTE_PTR pEncryptedPart
192  *                                      CK_ULONG_PTR pulEncryptedPartLen
193  */
194 JNIEXPORT jint JNICALL
195 Java_sun_security_pkcs11_wrapper_PKCS11_C_1EncryptUpdate
196 (JNIEnv *env, jobject obj, jlong jSessionHandle,
197  jlong directIn, jbyteArray jIn, jint jInOfs, jint jInLen,
198  jlong directOut, jbyteArray jOut, jint jOutOfs, jint jOutLen)
199 {
200     CK_SESSION_HANDLE ckSessionHandle;
201     CK_RV rv;
202 
203     CK_BYTE_PTR inBufP;
204     CK_BYTE_PTR outBufP;
<span class="line-modified">205     CK_ULONG ckEncryptedPartLen = 0;</span>
206 
207     CK_FUNCTION_LIST_PTR ckpFunctions = getFunctionList(env, obj);
208     if (ckpFunctions == NULL) { return 0; }
209 
210     ckSessionHandle = jLongToCKULong(jSessionHandle);
211 
212     if (directIn != 0) {
213       inBufP = (CK_BYTE_PTR) jlong_to_ptr(directIn);
214     } else {
215       inBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jIn, NULL);
216       if (inBufP == NULL) { return 0; }
217     }
218 
219     if (directOut != 0) {
220       outBufP = (CK_BYTE_PTR) jlong_to_ptr(directOut);
221     } else {
222       outBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jOut, NULL);
223       if (outBufP == NULL) {
<span class="line-modified">224           goto cleanup;</span>


225       }
226     }
227 
228     ckEncryptedPartLen = jOutLen;
229 



230     rv = (*ckpFunctions-&gt;C_EncryptUpdate)(ckSessionHandle,
231                                           (CK_BYTE_PTR)(inBufP + jInOfs), jInLen,
232                                           (CK_BYTE_PTR)(outBufP + jOutOfs),
233                                           &amp;ckEncryptedPartLen);
234 
<span class="line-modified">235     ckAssertReturnValueOK(env, rv);</span>
236 
<span class="line-modified">237 cleanup:</span>
<span class="line-added">238     if (directIn == 0 &amp;&amp; inBufP != NULL) {</span>
239         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);
240     }
<span class="line-modified">241     if (directOut == 0 &amp;&amp; outBufP != NULL) {</span>

242         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jOut, outBufP, JNI_COMMIT);
243     }



244     return ckEncryptedPartLen;
245 }
246 #endif
247 
248 #ifdef P11_ENABLE_C_ENCRYPTFINAL
249 /*
250  * Class:     sun_security_pkcs11_wrapper_PKCS11
251  * Method:    C_EncryptFinal
252  * Signature: (J[BII)I
253  * Parametermapping:                        *PKCS11*
254  * @param   jlong jSessionHandle            CK_SESSION_HANDLE hSession
255  * @return  jbyteArray jLastEncryptedPart   CK_BYTE_PTR pLastEncryptedDataPart
256  *                                          CK_ULONG_PTR pulLastEncryptedDataPartLen
257  */
258 JNIEXPORT jint JNICALL
259 Java_sun_security_pkcs11_wrapper_PKCS11_C_1EncryptFinal
260 (JNIEnv *env, jobject obj, jlong jSessionHandle,
261  jlong directOut, jbyteArray jOut, jint jOutOfs, jint jOutLen)
262 {
263     CK_SESSION_HANDLE ckSessionHandle;
264     CK_RV rv;
265     CK_BYTE_PTR outBufP;
266     CK_ULONG ckLastEncryptedPartLen;
267 
268     CK_FUNCTION_LIST_PTR ckpFunctions = getFunctionList(env, obj);
269     if (ckpFunctions == NULL) { return 0; }
270 
271     ckSessionHandle = jLongToCKULong(jSessionHandle);
272 
273     if (directOut != 0) {
274       outBufP = (CK_BYTE_PTR) jlong_to_ptr(directOut);
275     } else {
276       outBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jOut, NULL);
277       if (outBufP == NULL) { return 0; }
278     }
279 
280     ckLastEncryptedPartLen = jOutLen;
281 


282     rv = (*ckpFunctions-&gt;C_EncryptFinal)(ckSessionHandle,
283                                          (CK_BYTE_PTR)(outBufP + jOutOfs),
284                                          &amp;ckLastEncryptedPartLen);
285 


286     if (directOut == 0) {
287         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jOut, outBufP, JNI_COMMIT);
288     }
289 
290     ckAssertReturnValueOK(env, rv);
291 
292     return ckLastEncryptedPartLen;
293 }
294 #endif
295 
296 #ifdef P11_ENABLE_C_DECRYPTINIT
297 /*
298  * Class:     sun_security_pkcs11_wrapper_PKCS11
299  * Method:    C_DecryptInit
300  * Signature: (JLsun/security/pkcs11/wrapper/CK_MECHANISM;J)V
301  * Parametermapping:                    *PKCS11*
302  * @param   jlong jSessionHandle        CK_SESSION_HANDLE hSession
303  * @param   jobject jMechanism          CK_MECHANISM_PTR pMechanism
304  * @param   jlong jKeyHandle            CK_OBJECT_HANDLE hKey
305  */
306 JNIEXPORT void JNICALL
307 Java_sun_security_pkcs11_wrapper_PKCS11_C_1DecryptInit
308 (JNIEnv *env, jobject obj, jlong jSessionHandle,
309  jobject jMechanism, jlong jKeyHandle)
310 {
311     CK_SESSION_HANDLE ckSessionHandle;
<span class="line-modified">312     CK_MECHANISM_PTR ckpMechanism = NULL;</span>
<span class="line-added">313     CK_MECHANISM_PTR ckpTemp;</span>
314     CK_OBJECT_HANDLE ckKeyHandle;
315     CK_RV rv;
316 
317     CK_FUNCTION_LIST_PTR ckpFunctions = getFunctionList(env, obj);
318     if (ckpFunctions == NULL) { return; }
319 
320     ckSessionHandle = jLongToCKULong(jSessionHandle);
321     ckKeyHandle = jLongToCKULong(jKeyHandle);
<span class="line-modified">322     ckpMechanism = jMechanismToCKMechanismPtr(env, jMechanism);</span>
<span class="line-added">323     TRACE1(&quot;DEBUG C_DecryptInit: created pMech = %p\n&quot;,</span>
<span class="line-added">324             ckpMechanism);</span>
<span class="line-added">325 </span>
326     if ((*env)-&gt;ExceptionCheck(env)) { return; }
327 
<span class="line-modified">328     rv = (*ckpFunctions-&gt;C_DecryptInit)(ckSessionHandle, ckpMechanism,</span>
329                                         ckKeyHandle);
330 
<span class="line-modified">331     if (ckpMechanism-&gt;mechanism == CKM_AES_GCM) {</span>
<span class="line-modified">332         if (rv == CKR_ARGUMENTS_BAD || rv == CKR_MECHANISM_PARAM_INVALID) {</span>
<span class="line-added">333             // retry with CKM_GCM_PARAMS structure in pkcs11t.h</span>
<span class="line-added">334             TRACE0(&quot;DEBUG C_DecryptInit: retry with CK_GCM_PARAMS\n&quot;);</span>
<span class="line-added">335             ckpTemp = updateGCMParams(env, ckpMechanism);</span>
<span class="line-added">336             if (ckpTemp != NULL) { // only re-call if conversion succeeds</span>
<span class="line-added">337                 ckpMechanism = ckpTemp;</span>
<span class="line-added">338                 rv = (*ckpFunctions-&gt;C_DecryptInit)(ckSessionHandle, ckpMechanism,</span>
<span class="line-added">339                         ckKeyHandle);</span>
<span class="line-added">340             }</span>
<span class="line-added">341         }</span>
342     }
343 
<span class="line-added">344     TRACE1(&quot;DEBUG C_DecryptInit: freed pMech = %p\n&quot;, ckpMechanism);</span>
<span class="line-added">345     freeCKMechanismPtr(ckpMechanism);</span>
346     if (ckAssertReturnValueOK(env, rv) != CK_ASSERT_OK) { return; }
<span class="line-added">347 </span>
<span class="line-added">348     TRACE0(&quot;FINISHED\n&quot;);</span>
349 }
350 #endif
351 
352 #ifdef P11_ENABLE_C_DECRYPT
353 /*
354  * Class:     sun_security_pkcs11_wrapper_PKCS11
355  * Method:    C_Decrypt
<span class="line-modified">356  * Signature: (JJ[BIIJ[BII)I</span>
357  * Parametermapping:                    *PKCS11*
358  * @param   jlong jSessionHandle        CK_SESSION_HANDLE hSession
359  * @param   jbyteArray jEncryptedData   CK_BYTE_PTR pEncryptedData
360  *                                      CK_ULONG ulEncryptedDataLen
361  * @return  jbyteArray jData            CK_BYTE_PTR pData
362  *                                      CK_ULONG_PTR pulDataLen
363  */
364 JNIEXPORT jint JNICALL
365 Java_sun_security_pkcs11_wrapper_PKCS11_C_1Decrypt
366 (JNIEnv *env, jobject obj, jlong jSessionHandle,
<span class="line-modified">367  jlong directIn, jbyteArray jIn, jint jInOfs, jint jInLen,</span>
<span class="line-modified">368  jlong directOut, jbyteArray jOut, jint jOutOfs, jint jOutLen)</span>
369 {
370     CK_SESSION_HANDLE ckSessionHandle;
371     CK_RV rv;
372 
373     CK_BYTE_PTR inBufP;
374     CK_BYTE_PTR outBufP;
<span class="line-modified">375     CK_ULONG ckOutLen = 0;</span>
376 
377     CK_FUNCTION_LIST_PTR ckpFunctions = getFunctionList(env, obj);
378     if (ckpFunctions == NULL) { return 0; }
379 
380     ckSessionHandle = jLongToCKULong(jSessionHandle);
381 
<span class="line-modified">382     if (directIn != 0) {</span>
<span class="line-modified">383       inBufP = (CK_BYTE_PTR) jlong_to_ptr(directIn);</span>
<span class="line-modified">384     } else {</span>
<span class="line-modified">385       inBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jIn, NULL);</span>
<span class="line-modified">386       if (inBufP == NULL) { return 0; }</span>



387     }
388 
<span class="line-modified">389     if (directOut != 0) {</span>
<span class="line-added">390       outBufP = (CK_BYTE_PTR) jlong_to_ptr(directOut);</span>
<span class="line-added">391     } else {</span>
<span class="line-added">392       outBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jOut, NULL);</span>
<span class="line-added">393       if (outBufP == NULL) {</span>
<span class="line-added">394           goto cleanup;</span>
<span class="line-added">395       }</span>
<span class="line-added">396     }</span>
<span class="line-added">397     ckOutLen = jOutLen;</span>
398 
399     rv = (*ckpFunctions-&gt;C_Decrypt)(ckSessionHandle,
400                                     (CK_BYTE_PTR)(inBufP + jInOfs), jInLen,
401                                     (CK_BYTE_PTR)(outBufP + jOutOfs),
<span class="line-modified">402                                     &amp;ckOutLen);</span>



403 
404     ckAssertReturnValueOK(env, rv);
405 
<span class="line-modified">406 cleanup:</span>
<span class="line-added">407     if (directIn == 0 &amp;&amp; inBufP != NULL) {</span>
<span class="line-added">408         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);</span>
<span class="line-added">409     }</span>
<span class="line-added">410     if (directOut == 0 &amp;&amp; outBufP != NULL) {</span>
<span class="line-added">411         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jOut, outBufP, JNI_COMMIT);</span>
<span class="line-added">412     }</span>
<span class="line-added">413     return ckOutLen;</span>
414 }
415 #endif
416 
417 #ifdef P11_ENABLE_C_DECRYPTUPDATE
418 /*
419  * Class:     sun_security_pkcs11_wrapper_PKCS11
420  * Method:    C_DecryptUpdate
421  * Signature: (J[BII[BII)I
422  * Parametermapping:                    *PKCS11*
423  * @param   jlong jSessionHandle        CK_SESSION_HANDLE hSession
424  * @param   jbyteArray jEncryptedPart   CK_BYTE_PTR pEncryptedPart
425  *                                      CK_ULONG ulEncryptedPartLen
426  * @return  jbyteArray jPart            CK_BYTE_PTR pPart
427  *                                      CK_ULONG_PTR pulPartLen
428  */
429 JNIEXPORT jint JNICALL
430 Java_sun_security_pkcs11_wrapper_PKCS11_C_1DecryptUpdate
431 (JNIEnv *env, jobject obj, jlong jSessionHandle,
432  jlong directIn, jbyteArray jIn, jint jInOfs, jint jInLen,
433  jlong directOut, jbyteArray jOut, jint jOutOfs, jint jOutLen)
434 {
435     CK_SESSION_HANDLE ckSessionHandle;
436     CK_RV rv;
437 
438     CK_BYTE_PTR inBufP;
439     CK_BYTE_PTR outBufP;
<span class="line-modified">440     CK_ULONG ckDecryptedPartLen = 0;</span>
441 
442     CK_FUNCTION_LIST_PTR ckpFunctions = getFunctionList(env, obj);
443     if (ckpFunctions == NULL) { return 0; }
444 
445     ckSessionHandle = jLongToCKULong(jSessionHandle);
446 
447     if (directIn != 0) {
448       inBufP = (CK_BYTE_PTR) jlong_to_ptr(directIn);
449     } else {
450       inBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jIn, NULL);
451       if (inBufP == NULL) { return 0; }
452     }
453 
454     if (directOut != 0) {
455       outBufP = (CK_BYTE_PTR) jlong_to_ptr(directOut);
456     } else {
457       outBufP = (*env)-&gt;GetPrimitiveArrayCritical(env, jOut, NULL);
458       if (outBufP == NULL) {
<span class="line-modified">459           goto cleanup;</span>


460       }
461     }
462 
463     ckDecryptedPartLen = jOutLen;

464     rv = (*ckpFunctions-&gt;C_DecryptUpdate)(ckSessionHandle,
465                                           (CK_BYTE_PTR)(inBufP + jInOfs), jInLen,
466                                           (CK_BYTE_PTR)(outBufP + jOutOfs),
467                                           &amp;ckDecryptedPartLen);
<span class="line-modified">468     ckAssertReturnValueOK(env, rv);</span>
<span class="line-added">469 </span>
<span class="line-added">470 cleanup:</span>
<span class="line-added">471     if (directIn == 0 &amp;&amp; inBufP != NULL) {</span>
472         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);
473     }
<span class="line-modified">474     if (directOut == 0 &amp;&amp; outBufP != NULL) {</span>

475         (*env)-&gt;ReleasePrimitiveArrayCritical(env, jOut, outBufP, JNI_COMMIT);
476     }



477     return ckDecryptedPartLen;
478 }
479 
480 #endif
481 
482 #ifdef P11_ENABLE_C_DECRYPTFINAL
483 /*
484  * Class:     sun_security_pkcs11_wrapper_PKCS11
485  * Method:    C_DecryptFinal
486  * Signature: (J[BII)I
487  * Parametermapping:                    *PKCS11*
488  * @param   jlong jSessionHandle        CK_SESSION_HANDLE hSession
489  * @return  jbyteArray jLastPart        CK_BYTE_PTR pLastPart
490  *                                      CK_ULONG_PTR pulLastPartLen
491  */
492 JNIEXPORT jint JNICALL
493 Java_sun_security_pkcs11_wrapper_PKCS11_C_1DecryptFinal
494 (JNIEnv *env, jobject obj, jlong jSessionHandle,
495  jlong directOut, jbyteArray jOut, jint jOutOfs, jint jOutLen)
496 {
</pre>
</td>
</tr>
</table>
<center><a href="p11_convert.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="p11_digest.c.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>