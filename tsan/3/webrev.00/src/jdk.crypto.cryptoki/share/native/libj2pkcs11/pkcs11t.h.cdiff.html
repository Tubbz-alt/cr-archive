<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.crypto.cryptoki/share/native/libj2pkcs11/pkcs11t.h</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="pkcs11f.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="pkcs11wrapper.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.crypto.cryptoki/share/native/libj2pkcs11/pkcs11t.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,38 ***</span>
<span class="line-modified">! /* pkcs11t.h include file for PKCS #11. */</span>
<span class="line-modified">! /* $Revision: 1.6 $ */</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* License to copy and use this software is granted provided that it is</span>
<span class="line-modified">!  * identified as &quot;RSA Security Inc. PKCS #11 Cryptographic Token Interface</span>
<span class="line-modified">!  * (Cryptoki)&quot; in all material mentioning or referencing this software.</span>
<span class="line-removed">- </span>
<span class="line-removed">-  * License is also granted to make and use derivative works provided that</span>
<span class="line-removed">-  * such works are identified as &quot;derived from the RSA Security Inc. PKCS #11</span>
<span class="line-removed">-  * Cryptographic Token Interface (Cryptoki)&quot; in all material mentioning or</span>
<span class="line-removed">-  * referencing the derived work.</span>
  
<span class="line-modified">!  * RSA Security Inc. makes no representations concerning either the</span>
<span class="line-modified">!  * merchantability of this software or the suitability of this software for</span>
<span class="line-removed">-  * any particular purpose. It is provided &quot;as is&quot; without express or implied</span>
<span class="line-removed">-  * warranty of any kind.</span>
   */
  
  /* See top of pkcs11.h for information about the macros that
   * must be defined and the structure-packing conventions that
<span class="line-modified">!  * must be set before including this file. */</span>
  
  #ifndef _PKCS11T_H_
  #define _PKCS11T_H_ 1
  
<span class="line-modified">! #define CK_TRUE 1</span>
<span class="line-modified">! #define CK_FALSE 0</span>
  
  #ifndef CK_DISABLE_TRUE_FALSE
  #ifndef FALSE
  #define FALSE CK_FALSE
  #endif
<span class="line-removed">- </span>
  #ifndef TRUE
  #define TRUE CK_TRUE
  #endif
  #endif
  
<span class="line-new-header">--- 1,35 ---</span>
<span class="line-modified">! /* Copyright (c) OASIS Open 2016. All Rights Reserved./</span>
<span class="line-modified">!  * /Distributed under the terms of the OASIS IPR Policy,</span>
<span class="line-modified">!  * [http://www.oasis-open.org/policies-guidelines/ipr], AS-IS, WITHOUT ANY</span>
<span class="line-modified">!  * IMPLIED OR EXPRESS WARRANTY; there is no warranty of MERCHANTABILITY, FITNESS FOR A</span>
<span class="line-modified">!  * PARTICULAR PURPOSE or NONINFRINGEMENT of the rights of others.</span>
<span class="line-modified">!  */</span>
  
<span class="line-modified">! /* Latest version of the specification:</span>
<span class="line-modified">!  * http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/pkcs11-base-v2.40.html</span>
   */
  
  /* See top of pkcs11.h for information about the macros that
   * must be defined and the structure-packing conventions that
<span class="line-modified">!  * must be set before including this file.</span>
<span class="line-added">+  */</span>
  
  #ifndef _PKCS11T_H_
  #define _PKCS11T_H_ 1
  
<span class="line-modified">! #define CRYPTOKI_VERSION_MAJOR          2</span>
<span class="line-modified">! #define CRYPTOKI_VERSION_MINOR          40</span>
<span class="line-added">+ #define CRYPTOKI_VERSION_AMENDMENT      0</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CK_TRUE         1</span>
<span class="line-added">+ #define CK_FALSE        0</span>
  
  #ifndef CK_DISABLE_TRUE_FALSE
  #ifndef FALSE
  #define FALSE CK_FALSE
  #endif
  #ifndef TRUE
  #define TRUE CK_TRUE
  #endif
  #endif
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 50,20 ***</span>
  
  /* an unsigned value, at least 32 bits long */
  typedef unsigned long int CK_ULONG;
  
  /* a signed value, the same size as a CK_ULONG */
<span class="line-removed">- /* CK_LONG is new for v2.0 */</span>
  typedef long int          CK_LONG;
  
  /* at least 32 bits; each bit is a Boolean flag */
  typedef CK_ULONG          CK_FLAGS;
  
  
  /* some special values for certain CK_ULONG variables */
<span class="line-modified">! #define CK_UNAVAILABLE_INFORMATION (~0UL)</span>
<span class="line-modified">! #define CK_EFFECTIVELY_INFINITE    0</span>
  
  
  typedef CK_BYTE     CK_PTR   CK_BYTE_PTR;
  typedef CK_CHAR     CK_PTR   CK_CHAR_PTR;
  typedef CK_UTF8CHAR CK_PTR   CK_UTF8CHAR_PTR;
<span class="line-new-header">--- 47,19 ---</span>
  
  /* an unsigned value, at least 32 bits long */
  typedef unsigned long int CK_ULONG;
  
  /* a signed value, the same size as a CK_ULONG */
  typedef long int          CK_LONG;
  
  /* at least 32 bits; each bit is a Boolean flag */
  typedef CK_ULONG          CK_FLAGS;
  
  
  /* some special values for certain CK_ULONG variables */
<span class="line-modified">! #define CK_UNAVAILABLE_INFORMATION      (~0UL)</span>
<span class="line-modified">! #define CK_EFFECTIVELY_INFINITE         0UL</span>
  
  
  typedef CK_BYTE     CK_PTR   CK_BYTE_PTR;
  typedef CK_CHAR     CK_PTR   CK_CHAR_PTR;
  typedef CK_UTF8CHAR CK_PTR   CK_UTF8CHAR_PTR;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 72,13 ***</span>
  
  /* Pointer to a CK_VOID_PTR-- i.e., pointer to pointer to void */
  typedef CK_VOID_PTR CK_PTR CK_VOID_PTR_PTR;
  
  
<span class="line-modified">! /* The following value is always invalid if used as a session */</span>
<span class="line-modified">! /* handle or object handle */</span>
<span class="line-modified">! #define CK_INVALID_HANDLE 0</span>
  
  
  typedef struct CK_VERSION {
    CK_BYTE       major;  /* integer portion of version number */
    CK_BYTE       minor;  /* 1/100ths portion of version number */
<span class="line-new-header">--- 68,14 ---</span>
  
  /* Pointer to a CK_VOID_PTR-- i.e., pointer to pointer to void */
  typedef CK_VOID_PTR CK_PTR CK_VOID_PTR_PTR;
  
  
<span class="line-modified">! /* The following value is always invalid if used as a session</span>
<span class="line-modified">!  * handle or object handle</span>
<span class="line-modified">!  */</span>
<span class="line-added">+ #define CK_INVALID_HANDLE       0UL</span>
  
  
  typedef struct CK_VERSION {
    CK_BYTE       major;  /* integer portion of version number */
    CK_BYTE       minor;  /* 1/100ths portion of version number */
</pre>
<hr />
<pre>
<span class="line-old-header">*** 86,1018 ***</span>
  
  typedef CK_VERSION CK_PTR CK_VERSION_PTR;
  
  
  typedef struct CK_INFO {
<span class="line-removed">-   /* manufacturerID and libraryDecription have been changed from</span>
<span class="line-removed">-    * CK_CHAR to CK_UTF8CHAR for v2.10 */</span>
    CK_VERSION    cryptokiVersion;     /* Cryptoki interface ver */
    CK_UTF8CHAR   manufacturerID[32];  /* blank padded */
    CK_FLAGS      flags;               /* must be zero */
<span class="line-removed">- </span>
<span class="line-removed">-   /* libraryDescription and libraryVersion are new for v2.0 */</span>
    CK_UTF8CHAR   libraryDescription[32];  /* blank padded */
    CK_VERSION    libraryVersion;          /* version of library */
  } CK_INFO;
  
  typedef CK_INFO CK_PTR    CK_INFO_PTR;
  
  
  /* CK_NOTIFICATION enumerates the types of notifications that
<span class="line-modified">!  * Cryptoki provides to an application */</span>
<span class="line-modified">! /* CK_NOTIFICATION has been changed from an enum to a CK_ULONG</span>
<span class="line-removed">-  * for v2.0 */</span>
  typedef CK_ULONG CK_NOTIFICATION;
<span class="line-modified">! #define CKN_SURRENDER       0</span>
<span class="line-modified">! </span>
  
  typedef CK_ULONG          CK_SLOT_ID;
  
  typedef CK_SLOT_ID CK_PTR CK_SLOT_ID_PTR;
  
  
  /* CK_SLOT_INFO provides information about a slot */
  typedef struct CK_SLOT_INFO {
<span class="line-removed">-   /* slotDescription and manufacturerID have been changed from</span>
<span class="line-removed">-    * CK_CHAR to CK_UTF8CHAR for v2.10 */</span>
    CK_UTF8CHAR   slotDescription[64];  /* blank padded */
    CK_UTF8CHAR   manufacturerID[32];   /* blank padded */
    CK_FLAGS      flags;
  
<span class="line-removed">-   /* hardwareVersion and firmwareVersion are new for v2.0 */</span>
    CK_VERSION    hardwareVersion;  /* version of hardware */
    CK_VERSION    firmwareVersion;  /* version of firmware */
  } CK_SLOT_INFO;
  
  /* flags: bit flags that provide capabilities of the slot
   *      Bit Flag              Mask        Meaning
   */
<span class="line-modified">! #define CKF_TOKEN_PRESENT     0x00000001  /* a token is there */</span>
<span class="line-modified">! #define CKF_REMOVABLE_DEVICE  0x00000002  /* removable devices*/</span>
<span class="line-modified">! #define CKF_HW_SLOT           0x00000004  /* hardware slot */</span>
  
  typedef CK_SLOT_INFO CK_PTR CK_SLOT_INFO_PTR;
  
  
  /* CK_TOKEN_INFO provides information about a token */
  typedef struct CK_TOKEN_INFO {
<span class="line-removed">-   /* label, manufacturerID, and model have been changed from</span>
<span class="line-removed">-    * CK_CHAR to CK_UTF8CHAR for v2.10 */</span>
    CK_UTF8CHAR   label[32];           /* blank padded */
    CK_UTF8CHAR   manufacturerID[32];  /* blank padded */
    CK_UTF8CHAR   model[16];           /* blank padded */
    CK_CHAR       serialNumber[16];    /* blank padded */
    CK_FLAGS      flags;               /* see below */
  
<span class="line-removed">-   /* ulMaxSessionCount, ulSessionCount, ulMaxRwSessionCount,</span>
<span class="line-removed">-    * ulRwSessionCount, ulMaxPinLen, and ulMinPinLen have all been</span>
<span class="line-removed">-    * changed from CK_USHORT to CK_ULONG for v2.0 */</span>
    CK_ULONG      ulMaxSessionCount;     /* max open sessions */
    CK_ULONG      ulSessionCount;        /* sess. now open */
    CK_ULONG      ulMaxRwSessionCount;   /* max R/W sessions */
    CK_ULONG      ulRwSessionCount;      /* R/W sess. now open */
    CK_ULONG      ulMaxPinLen;           /* in bytes */
    CK_ULONG      ulMinPinLen;           /* in bytes */
    CK_ULONG      ulTotalPublicMemory;   /* in bytes */
    CK_ULONG      ulFreePublicMemory;    /* in bytes */
    CK_ULONG      ulTotalPrivateMemory;  /* in bytes */
    CK_ULONG      ulFreePrivateMemory;   /* in bytes */
<span class="line-removed">- </span>
<span class="line-removed">-   /* hardwareVersion, firmwareVersion, and time are new for</span>
<span class="line-removed">-    * v2.0 */</span>
    CK_VERSION    hardwareVersion;       /* version of hardware */
    CK_VERSION    firmwareVersion;       /* version of firmware */
    CK_CHAR       utcTime[16];           /* time */
  } CK_TOKEN_INFO;
  
  /* The flags parameter is defined as follows:
   *      Bit Flag                    Mask        Meaning
   */
<span class="line-modified">! #define CKF_RNG                     0x00000001  /* has random #</span>
<span class="line-modified">!                                                  * generator */</span>
<span class="line-modified">! #define CKF_WRITE_PROTECTED         0x00000002  /* token is</span>
<span class="line-modified">!                                                  * write-</span>
<span class="line-modified">!                                                  * protected */</span>
<span class="line-modified">! #define CKF_LOGIN_REQUIRED          0x00000004  /* user must</span>
<span class="line-removed">-                                                  * login */</span>
<span class="line-removed">- #define CKF_USER_PIN_INITIALIZED    0x00000008  /* normal user&#39;s</span>
<span class="line-removed">-                                                  * PIN is set */</span>
<span class="line-removed">- </span>
<span class="line-removed">- /* CKF_RESTORE_KEY_NOT_NEEDED is new for v2.0.  If it is set,</span>
   * that means that *every* time the state of cryptographic
   * operations of a session is successfully saved, all keys
<span class="line-modified">!  * needed to continue those operations are stored in the state */</span>
<span class="line-modified">! #define CKF_RESTORE_KEY_NOT_NEEDED  0x00000020</span>
  
<span class="line-modified">! /* CKF_CLOCK_ON_TOKEN is new for v2.0.  If it is set, that means</span>
   * that the token has some sort of clock.  The time on that
<span class="line-modified">!  * clock is returned in the token info structure */</span>
<span class="line-modified">! #define CKF_CLOCK_ON_TOKEN          0x00000040</span>
  
<span class="line-modified">! /* CKF_PROTECTED_AUTHENTICATION_PATH is new for v2.0.  If it is</span>
   * set, that means that there is some way for the user to login
<span class="line-modified">!  * without sending a PIN through the Cryptoki library itself */</span>
<span class="line-modified">! #define CKF_PROTECTED_AUTHENTICATION_PATH 0x00000100</span>
  
<span class="line-modified">! /* CKF_DUAL_CRYPTO_OPERATIONS is new for v2.0.  If it is true,</span>
   * that means that a single session with the token can perform
   * dual simultaneous cryptographic operations (digest and
   * encrypt; decrypt and digest; sign and encrypt; and decrypt
<span class="line-modified">!  * and sign) */</span>
<span class="line-modified">! #define CKF_DUAL_CRYPTO_OPERATIONS  0x00000200</span>
  
<span class="line-modified">! /* CKF_TOKEN_INITIALIZED if new for v2.10. If it is true, the</span>
   * token has been initialized using C_InitializeToken or an
   * equivalent mechanism outside the scope of PKCS #11.
   * Calling C_InitializeToken when this flag is set will cause
<span class="line-modified">!  * the token to be reinitialized. */</span>
<span class="line-modified">! #define CKF_TOKEN_INITIALIZED       0x00000400</span>
  
<span class="line-modified">! /* CKF_SECONDARY_AUTHENTICATION if new for v2.10. If it is</span>
   * true, the token supports secondary authentication for
<span class="line-modified">!  * private key objects. This flag is deprecated in v2.11 and</span>
<span class="line-modified">!    onwards. */</span>
<span class="line-modified">! #define CKF_SECONDARY_AUTHENTICATION  0x00000800</span>
  
<span class="line-modified">! /* CKF_USER_PIN_COUNT_LOW if new for v2.10. If it is true, an</span>
   * incorrect user login PIN has been entered at least once
<span class="line-modified">!  * since the last successful authentication. */</span>
<span class="line-modified">! #define CKF_USER_PIN_COUNT_LOW       0x00010000</span>
  
<span class="line-modified">! /* CKF_USER_PIN_FINAL_TRY if new for v2.10. If it is true,</span>
<span class="line-modified">!  * supplying an incorrect user PIN will it to become locked. */</span>
<span class="line-modified">! #define CKF_USER_PIN_FINAL_TRY       0x00020000</span>
  
<span class="line-modified">! /* CKF_USER_PIN_LOCKED if new for v2.10. If it is true, the</span>
   * user PIN has been locked. User login to the token is not
<span class="line-modified">!  * possible. */</span>
<span class="line-modified">! #define CKF_USER_PIN_LOCKED          0x00040000</span>
  
<span class="line-modified">! /* CKF_USER_PIN_TO_BE_CHANGED if new for v2.10. If it is true,</span>
   * the user PIN value is the default value set by token
   * initialization or manufacturing, or the PIN has been
<span class="line-modified">!  * expired by the card. */</span>
<span class="line-modified">! #define CKF_USER_PIN_TO_BE_CHANGED   0x00080000</span>
  
<span class="line-modified">! /* CKF_SO_PIN_COUNT_LOW if new for v2.10. If it is true, an</span>
   * incorrect SO login PIN has been entered at least once since
<span class="line-modified">!  * the last successful authentication. */</span>
<span class="line-modified">! #define CKF_SO_PIN_COUNT_LOW         0x00100000</span>
  
<span class="line-modified">! /* CKF_SO_PIN_FINAL_TRY if new for v2.10. If it is true,</span>
<span class="line-modified">!  * supplying an incorrect SO PIN will it to become locked. */</span>
<span class="line-modified">! #define CKF_SO_PIN_FINAL_TRY         0x00200000</span>
  
<span class="line-modified">! /* CKF_SO_PIN_LOCKED if new for v2.10. If it is true, the SO</span>
   * PIN has been locked. SO login to the token is not possible.
   */
<span class="line-modified">! #define CKF_SO_PIN_LOCKED            0x00400000</span>
  
<span class="line-modified">! /* CKF_SO_PIN_TO_BE_CHANGED if new for v2.10. If it is true,</span>
   * the SO PIN value is the default value set by token
   * initialization or manufacturing, or the PIN has been
<span class="line-modified">!  * expired by the card. */</span>
<span class="line-modified">! #define CKF_SO_PIN_TO_BE_CHANGED     0x00800000</span>
  
  typedef CK_TOKEN_INFO CK_PTR CK_TOKEN_INFO_PTR;
  
  
  /* CK_SESSION_HANDLE is a Cryptoki-assigned value that
<span class="line-modified">!  * identifies a session */</span>
  typedef CK_ULONG          CK_SESSION_HANDLE;
  
  typedef CK_SESSION_HANDLE CK_PTR CK_SESSION_HANDLE_PTR;
  
  
  /* CK_USER_TYPE enumerates the types of Cryptoki users */
<span class="line-removed">- /* CK_USER_TYPE has been changed from an enum to a CK_ULONG for</span>
<span class="line-removed">-  * v2.0 */</span>
  typedef CK_ULONG          CK_USER_TYPE;
  /* Security Officer */
<span class="line-modified">! #define CKU_SO    0</span>
  /* Normal user */
<span class="line-modified">! #define CKU_USER  1</span>
<span class="line-modified">! /* Context specific (added in v2.20) */</span>
<span class="line-modified">! #define CKU_CONTEXT_SPECIFIC   2</span>
  
  /* CK_STATE enumerates the session states */
<span class="line-removed">- /* CK_STATE has been changed from an enum to a CK_ULONG for</span>
<span class="line-removed">-  * v2.0 */</span>
  typedef CK_ULONG          CK_STATE;
<span class="line-modified">! #define CKS_RO_PUBLIC_SESSION  0</span>
<span class="line-modified">! #define CKS_RO_USER_FUNCTIONS  1</span>
<span class="line-modified">! #define CKS_RW_PUBLIC_SESSION  2</span>
<span class="line-modified">! #define CKS_RW_USER_FUNCTIONS  3</span>
<span class="line-modified">! #define CKS_RW_SO_FUNCTIONS    4</span>
<span class="line-removed">- </span>
  
  /* CK_SESSION_INFO provides information about a session */
  typedef struct CK_SESSION_INFO {
    CK_SLOT_ID    slotID;
    CK_STATE      state;
    CK_FLAGS      flags;          /* see below */
<span class="line-removed">- </span>
<span class="line-removed">-   /* ulDeviceError was changed from CK_USHORT to CK_ULONG for</span>
<span class="line-removed">-    * v2.0 */</span>
    CK_ULONG      ulDeviceError;  /* device-dependent error code */
  } CK_SESSION_INFO;
  
  /* The flags are defined in the following table:
   *      Bit Flag                Mask        Meaning
   */
<span class="line-modified">! #define CKF_RW_SESSION          0x00000002  /* session is r/w */</span>
<span class="line-modified">! #define CKF_SERIAL_SESSION      0x00000004  /* no parallel */</span>
  
  typedef CK_SESSION_INFO CK_PTR CK_SESSION_INFO_PTR;
  
  
  /* CK_OBJECT_HANDLE is a token-specific identifier for an
<span class="line-modified">!  * object  */</span>
  typedef CK_ULONG          CK_OBJECT_HANDLE;
  
  typedef CK_OBJECT_HANDLE CK_PTR CK_OBJECT_HANDLE_PTR;
  
  
  /* CK_OBJECT_CLASS is a value that identifies the classes (or
   * types) of objects that Cryptoki recognizes.  It is defined
<span class="line-modified">!  * as follows: */</span>
<span class="line-modified">! /* CK_OBJECT_CLASS was changed from CK_USHORT to CK_ULONG for</span>
<span class="line-removed">-  * v2.0 */</span>
  typedef CK_ULONG          CK_OBJECT_CLASS;
  
  /* The following classes of objects are defined: */
<span class="line-modified">! /* CKO_HW_FEATURE is new for v2.10 */</span>
<span class="line-modified">! /* CKO_DOMAIN_PARAMETERS is new for v2.11 */</span>
<span class="line-modified">! /* CKO_MECHANISM is new for v2.20 */</span>
<span class="line-modified">! #define CKO_DATA              0x00000000</span>
<span class="line-modified">! #define CKO_CERTIFICATE       0x00000001</span>
<span class="line-modified">! #define CKO_PUBLIC_KEY        0x00000002</span>
<span class="line-modified">! #define CKO_PRIVATE_KEY       0x00000003</span>
<span class="line-modified">! #define CKO_SECRET_KEY        0x00000004</span>
<span class="line-modified">! #define CKO_HW_FEATURE        0x00000005</span>
<span class="line-modified">! #define CKO_DOMAIN_PARAMETERS 0x00000006</span>
<span class="line-modified">! #define CKO_MECHANISM         0x00000007</span>
<span class="line-removed">- #define CKO_VENDOR_DEFINED    0x80000000</span>
  
  typedef CK_OBJECT_CLASS CK_PTR CK_OBJECT_CLASS_PTR;
  
<span class="line-modified">! /* CK_HW_FEATURE_TYPE is new for v2.10. CK_HW_FEATURE_TYPE is a</span>
<span class="line-modified">!  * value that identifies the hardware feature type of an object</span>
<span class="line-modified">!  * with CK_OBJECT_CLASS equal to CKO_HW_FEATURE. */</span>
  typedef CK_ULONG          CK_HW_FEATURE_TYPE;
  
  /* The following hardware feature types are defined */
<span class="line-modified">! /* CKH_USER_INTERFACE is new for v2.20 */</span>
<span class="line-modified">! #define CKH_MONOTONIC_COUNTER  0x00000001</span>
<span class="line-modified">! #define CKH_CLOCK           0x00000002</span>
<span class="line-modified">! #define CKH_USER_INTERFACE  0x00000003</span>
<span class="line-removed">- #define CKH_VENDOR_DEFINED  0x80000000</span>
  
  /* CK_KEY_TYPE is a value that identifies a key type */
<span class="line-removed">- /* CK_KEY_TYPE was changed from CK_USHORT to CK_ULONG for v2.0 */</span>
  typedef CK_ULONG          CK_KEY_TYPE;
  
  /* the following key types are defined: */
<span class="line-modified">! #define CKK_RSA             0x00000000</span>
<span class="line-modified">! #define CKK_DSA             0x00000001</span>
<span class="line-modified">! #define CKK_DH              0x00000002</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKK_ECDSA and CKK_KEA are new for v2.0 */</span>
<span class="line-modified">! /* CKK_ECDSA is deprecated in v2.11, CKK_EC is preferred. */</span>
<span class="line-modified">! #define CKK_ECDSA           0x00000003</span>
<span class="line-modified">! #define CKK_EC              0x00000003</span>
<span class="line-modified">! #define CKK_X9_42_DH        0x00000004</span>
<span class="line-modified">! #define CKK_KEA             0x00000005</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKK_GENERIC_SECRET  0x00000010</span>
<span class="line-modified">! #define CKK_RC2             0x00000011</span>
<span class="line-modified">! #define CKK_RC4             0x00000012</span>
<span class="line-modified">! #define CKK_DES             0x00000013</span>
<span class="line-modified">! #define CKK_DES2            0x00000014</span>
<span class="line-modified">! #define CKK_DES3            0x00000015</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* all these key types are new for v2.0 */</span>
<span class="line-modified">! #define CKK_CAST            0x00000016</span>
<span class="line-modified">! #define CKK_CAST3           0x00000017</span>
<span class="line-modified">! /* CKK_CAST5 is deprecated in v2.11, CKK_CAST128 is preferred. */</span>
<span class="line-modified">! #define CKK_CAST5           0x00000018</span>
<span class="line-modified">! #define CKK_CAST128         0x00000018</span>
<span class="line-modified">! #define CKK_RC5             0x00000019</span>
<span class="line-modified">! #define CKK_IDEA            0x0000001A</span>
<span class="line-modified">! #define CKK_SKIPJACK        0x0000001B</span>
<span class="line-modified">! #define CKK_BATON           0x0000001C</span>
<span class="line-modified">! #define CKK_JUNIPER         0x0000001D</span>
<span class="line-modified">! #define CKK_CDMF            0x0000001E</span>
<span class="line-modified">! #define CKK_AES             0x0000001F</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* BlowFish and TwoFish are new for v2.20 */</span>
<span class="line-modified">! #define CKK_BLOWFISH        0x00000020</span>
<span class="line-modified">! #define CKK_TWOFISH         0x00000021</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKK_VENDOR_DEFINED  0x80000000</span>
  
  
  /* CK_CERTIFICATE_TYPE is a value that identifies a certificate
<span class="line-modified">!  * type */</span>
<span class="line-modified">! /* CK_CERTIFICATE_TYPE was changed from CK_USHORT to CK_ULONG</span>
<span class="line-removed">-  * for v2.0 */</span>
  typedef CK_ULONG          CK_CERTIFICATE_TYPE;
  
  /* The following certificate types are defined: */
<span class="line-modified">! /* CKC_X_509_ATTR_CERT is new for v2.10 */</span>
<span class="line-modified">! /* CKC_WTLS is new for v2.20 */</span>
<span class="line-modified">! #define CKC_X_509           0x00000000</span>
<span class="line-modified">! #define CKC_X_509_ATTR_CERT 0x00000001</span>
<span class="line-removed">- #define CKC_WTLS            0x00000002</span>
<span class="line-removed">- #define CKC_VENDOR_DEFINED  0x80000000</span>
  
  
  /* CK_ATTRIBUTE_TYPE is a value that identifies an attribute
<span class="line-modified">!  * type */</span>
<span class="line-modified">! /* CK_ATTRIBUTE_TYPE was changed from CK_USHORT to CK_ULONG for</span>
<span class="line-removed">-  * v2.0 */</span>
  typedef CK_ULONG          CK_ATTRIBUTE_TYPE;
  
  /* The CKF_ARRAY_ATTRIBUTE flag identifies an attribute which
<span class="line-modified">!    consists of an array of values. */</span>
<span class="line-modified">! #define CKF_ARRAY_ATTRIBUTE    0x40000000</span>
  
  /* The following attribute types are defined: */
<span class="line-modified">! #define CKA_CLASS              0x00000000</span>
<span class="line-modified">! #define CKA_TOKEN              0x00000001</span>
<span class="line-modified">! #define CKA_PRIVATE            0x00000002</span>
<span class="line-modified">! #define CKA_LABEL              0x00000003</span>
<span class="line-modified">! #define CKA_APPLICATION        0x00000010</span>
<span class="line-modified">! #define CKA_VALUE              0x00000011</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKA_OBJECT_ID is new for v2.10 */</span>
<span class="line-modified">! #define CKA_OBJECT_ID          0x00000012</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKA_CERTIFICATE_TYPE   0x00000080</span>
<span class="line-modified">! #define CKA_ISSUER             0x00000081</span>
<span class="line-modified">! #define CKA_SERIAL_NUMBER      0x00000082</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKA_AC_ISSUER, CKA_OWNER, and CKA_ATTR_TYPES are new</span>
<span class="line-modified">!  * for v2.10 */</span>
<span class="line-modified">! #define CKA_AC_ISSUER          0x00000083</span>
<span class="line-modified">! #define CKA_OWNER              0x00000084</span>
<span class="line-modified">! #define CKA_ATTR_TYPES         0x00000085</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKA_TRUSTED is new for v2.11 */</span>
<span class="line-modified">! #define CKA_TRUSTED            0x00000086</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKA_CERTIFICATE_CATEGORY ...</span>
<span class="line-modified">!  * CKA_CHECK_VALUE are new for v2.20 */</span>
<span class="line-modified">! #define CKA_CERTIFICATE_CATEGORY        0x00000087</span>
<span class="line-modified">! #define CKA_JAVA_MIDP_SECURITY_DOMAIN   0x00000088</span>
<span class="line-modified">! #define CKA_URL                         0x00000089</span>
<span class="line-modified">! #define CKA_HASH_OF_SUBJECT_PUBLIC_KEY  0x0000008A</span>
<span class="line-modified">! #define CKA_HASH_OF_ISSUER_PUBLIC_KEY   0x0000008B</span>
<span class="line-modified">! #define CKA_CHECK_VALUE                 0x00000090</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKA_KEY_TYPE           0x00000100</span>
<span class="line-modified">! #define CKA_SUBJECT            0x00000101</span>
<span class="line-modified">! #define CKA_ID                 0x00000102</span>
<span class="line-modified">! #define CKA_SENSITIVE          0x00000103</span>
<span class="line-modified">! #define CKA_ENCRYPT            0x00000104</span>
<span class="line-modified">! #define CKA_DECRYPT            0x00000105</span>
<span class="line-modified">! #define CKA_WRAP               0x00000106</span>
<span class="line-modified">! #define CKA_UNWRAP             0x00000107</span>
<span class="line-modified">! #define CKA_SIGN               0x00000108</span>
<span class="line-modified">! #define CKA_SIGN_RECOVER       0x00000109</span>
<span class="line-modified">! #define CKA_VERIFY             0x0000010A</span>
<span class="line-modified">! #define CKA_VERIFY_RECOVER     0x0000010B</span>
<span class="line-modified">! #define CKA_DERIVE             0x0000010C</span>
<span class="line-modified">! #define CKA_START_DATE         0x00000110</span>
<span class="line-modified">! #define CKA_END_DATE           0x00000111</span>
<span class="line-modified">! #define CKA_MODULUS            0x00000120</span>
<span class="line-modified">! #define CKA_MODULUS_BITS       0x00000121</span>
<span class="line-modified">! #define CKA_PUBLIC_EXPONENT    0x00000122</span>
<span class="line-modified">! #define CKA_PRIVATE_EXPONENT   0x00000123</span>
<span class="line-modified">! #define CKA_PRIME_1            0x00000124</span>
<span class="line-modified">! #define CKA_PRIME_2            0x00000125</span>
<span class="line-removed">- #define CKA_EXPONENT_1         0x00000126</span>
<span class="line-removed">- #define CKA_EXPONENT_2         0x00000127</span>
<span class="line-removed">- #define CKA_COEFFICIENT        0x00000128</span>
<span class="line-removed">- #define CKA_PRIME              0x00000130</span>
<span class="line-removed">- #define CKA_SUBPRIME           0x00000131</span>
<span class="line-removed">- #define CKA_BASE               0x00000132</span>
<span class="line-removed">- </span>
<span class="line-removed">- /* CKA_PRIME_BITS and CKA_SUB_PRIME_BITS are new for v2.11 */</span>
<span class="line-removed">- #define CKA_PRIME_BITS         0x00000133</span>
<span class="line-removed">- #define CKA_SUBPRIME_BITS      0x00000134</span>
  #define CKA_SUB_PRIME_BITS     CKA_SUBPRIME_BITS
<span class="line-removed">- /* (To retain backwards-compatibility) */</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define CKA_VALUE_BITS         0x00000160</span>
<span class="line-removed">- #define CKA_VALUE_LEN          0x00000161</span>
<span class="line-removed">- </span>
<span class="line-removed">- /* CKA_EXTRACTABLE, CKA_LOCAL, CKA_NEVER_EXTRACTABLE,</span>
<span class="line-removed">-  * CKA_ALWAYS_SENSITIVE, CKA_MODIFIABLE, CKA_ECDSA_PARAMS,</span>
<span class="line-removed">-  * and CKA_EC_POINT are new for v2.0 */</span>
<span class="line-removed">- #define CKA_EXTRACTABLE        0x00000162</span>
<span class="line-removed">- #define CKA_LOCAL              0x00000163</span>
<span class="line-removed">- #define CKA_NEVER_EXTRACTABLE  0x00000164</span>
<span class="line-removed">- #define CKA_ALWAYS_SENSITIVE   0x00000165</span>
<span class="line-removed">- </span>
<span class="line-removed">- /* CKA_KEY_GEN_MECHANISM is new for v2.11 */</span>
<span class="line-removed">- #define CKA_KEY_GEN_MECHANISM  0x00000166</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define CKA_MODIFIABLE         0x00000170</span>
<span class="line-removed">- </span>
<span class="line-removed">- /* CKA_ECDSA_PARAMS is deprecated in v2.11,</span>
<span class="line-removed">-  * CKA_EC_PARAMS is preferred. */</span>
<span class="line-removed">- #define CKA_ECDSA_PARAMS       0x00000180</span>
<span class="line-removed">- #define CKA_EC_PARAMS          0x00000180</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define CKA_EC_POINT           0x00000181</span>
<span class="line-removed">- </span>
<span class="line-removed">- /* CKA_SECONDARY_AUTH, CKA_AUTH_PIN_FLAGS,</span>
<span class="line-removed">-  * are new for v2.10. Deprecated in v2.11 and onwards. */</span>
<span class="line-removed">- #define CKA_SECONDARY_AUTH     0x00000200</span>
<span class="line-removed">- #define CKA_AUTH_PIN_FLAGS     0x00000201</span>
<span class="line-removed">- </span>
<span class="line-removed">- /* CKA_ALWAYS_AUTHENTICATE ...</span>
<span class="line-removed">-  * CKA_UNWRAP_TEMPLATE are new for v2.20 */</span>
<span class="line-removed">- #define CKA_ALWAYS_AUTHENTICATE  0x00000202</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define CKA_WRAP_WITH_TRUSTED    0x00000210</span>
<span class="line-removed">- #define CKA_WRAP_TEMPLATE        (CKF_ARRAY_ATTRIBUTE|0x00000211)</span>
<span class="line-removed">- #define CKA_UNWRAP_TEMPLATE      (CKF_ARRAY_ATTRIBUTE|0x00000212)</span>
<span class="line-removed">- </span>
<span class="line-removed">- /* CKA_HW_FEATURE_TYPE, CKA_RESET_ON_INIT, and CKA_HAS_RESET</span>
<span class="line-removed">-  * are new for v2.10 */</span>
<span class="line-removed">- #define CKA_HW_FEATURE_TYPE    0x00000300</span>
<span class="line-removed">- #define CKA_RESET_ON_INIT      0x00000301</span>
<span class="line-removed">- #define CKA_HAS_RESET          0x00000302</span>
<span class="line-removed">- </span>
<span class="line-removed">- /* The following attributes are new for v2.20 */</span>
<span class="line-removed">- #define CKA_PIXEL_X                     0x00000400</span>
<span class="line-removed">- #define CKA_PIXEL_Y                     0x00000401</span>
<span class="line-removed">- #define CKA_RESOLUTION                  0x00000402</span>
<span class="line-removed">- #define CKA_CHAR_ROWS                   0x00000403</span>
<span class="line-removed">- #define CKA_CHAR_COLUMNS                0x00000404</span>
<span class="line-removed">- #define CKA_COLOR                       0x00000405</span>
<span class="line-removed">- #define CKA_BITS_PER_PIXEL              0x00000406</span>
<span class="line-removed">- #define CKA_CHAR_SETS                   0x00000480</span>
<span class="line-removed">- #define CKA_ENCODING_METHODS            0x00000481</span>
<span class="line-removed">- #define CKA_MIME_TYPES                  0x00000482</span>
<span class="line-removed">- #define CKA_MECHANISM_TYPE              0x00000500</span>
<span class="line-removed">- #define CKA_REQUIRED_CMS_ATTRIBUTES     0x00000501</span>
<span class="line-removed">- #define CKA_DEFAULT_CMS_ATTRIBUTES      0x00000502</span>
<span class="line-removed">- #define CKA_SUPPORTED_CMS_ATTRIBUTES    0x00000503</span>
<span class="line-removed">- #define CKA_ALLOWED_MECHANISMS          (CKF_ARRAY_ATTRIBUTE|0x00000600)</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define CKA_VENDOR_DEFINED     0x80000000</span>
<span class="line-removed">- #define CKA_NETSCAPE_DB        0xD5A0DB00</span>
  
  
  /* CK_ATTRIBUTE is a structure that includes the type, length
<span class="line-modified">!  * and value of an attribute */</span>
  typedef struct CK_ATTRIBUTE {
    CK_ATTRIBUTE_TYPE type;
    CK_VOID_PTR       pValue;
<span class="line-removed">- </span>
<span class="line-removed">-   /* ulValueLen went from CK_USHORT to CK_ULONG for v2.0 */</span>
    CK_ULONG          ulValueLen;  /* in bytes */
  } CK_ATTRIBUTE;
  
  typedef CK_ATTRIBUTE CK_PTR CK_ATTRIBUTE_PTR;
  
<span class="line-removed">- </span>
  /* CK_DATE is a structure that defines a date */
  typedef struct CK_DATE{
    CK_CHAR       year[4];   /* the year (&quot;1900&quot; - &quot;9999&quot;) */
    CK_CHAR       month[2];  /* the month (&quot;01&quot; - &quot;12&quot;) */
    CK_CHAR       day[2];    /* the day   (&quot;01&quot; - &quot;31&quot;) */
  } CK_DATE;
  
  
  /* CK_MECHANISM_TYPE is a value that identifies a mechanism
<span class="line-modified">!  * type */</span>
<span class="line-modified">! /* CK_MECHANISM_TYPE was changed from CK_USHORT to CK_ULONG for</span>
<span class="line-removed">-  * v2.0 */</span>
  typedef CK_ULONG          CK_MECHANISM_TYPE;
  
  /* the following mechanism types are defined: */
<span class="line-modified">! #define CKM_RSA_PKCS_KEY_PAIR_GEN      0x00000000</span>
<span class="line-modified">! #define CKM_RSA_PKCS                   0x00000001</span>
<span class="line-modified">! #define CKM_RSA_9796                   0x00000002</span>
<span class="line-modified">! #define CKM_RSA_X_509                  0x00000003</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_MD2_RSA_PKCS, CKM_MD5_RSA_PKCS, and CKM_SHA1_RSA_PKCS</span>
<span class="line-modified">!  * are new for v2.0.  They are mechanisms which hash and sign */</span>
<span class="line-modified">! #define CKM_MD2_RSA_PKCS               0x00000004</span>
<span class="line-modified">! #define CKM_MD5_RSA_PKCS               0x00000005</span>
<span class="line-modified">! #define CKM_SHA1_RSA_PKCS              0x00000006</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_RIPEMD128_RSA_PKCS, CKM_RIPEMD160_RSA_PKCS, and</span>
<span class="line-modified">!  * CKM_RSA_PKCS_OAEP are new for v2.10 */</span>
<span class="line-modified">! #define CKM_RIPEMD128_RSA_PKCS         0x00000007</span>
<span class="line-modified">! #define CKM_RIPEMD160_RSA_PKCS         0x00000008</span>
<span class="line-modified">! #define CKM_RSA_PKCS_OAEP              0x00000009</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_RSA_X9_31_KEY_PAIR_GEN, CKM_RSA_X9_31, CKM_SHA1_RSA_X9_31,</span>
<span class="line-modified">!  * CKM_RSA_PKCS_PSS, and CKM_SHA1_RSA_PKCS_PSS are new for v2.11 */</span>
<span class="line-modified">! #define CKM_RSA_X9_31_KEY_PAIR_GEN     0x0000000A</span>
<span class="line-modified">! #define CKM_RSA_X9_31                  0x0000000B</span>
<span class="line-modified">! #define CKM_SHA1_RSA_X9_31             0x0000000C</span>
<span class="line-modified">! #define CKM_RSA_PKCS_PSS               0x0000000D</span>
<span class="line-modified">! #define CKM_SHA1_RSA_PKCS_PSS          0x0000000E</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_DSA_KEY_PAIR_GEN           0x00000010</span>
<span class="line-modified">! #define CKM_DSA                        0x00000011</span>
<span class="line-modified">! #define CKM_DSA_SHA1                   0x00000012</span>
<span class="line-modified">! #define CKM_DH_PKCS_KEY_PAIR_GEN       0x00000020</span>
<span class="line-modified">! #define CKM_DH_PKCS_DERIVE             0x00000021</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_X9_42_DH_KEY_PAIR_GEN, CKM_X9_42_DH_DERIVE,</span>
<span class="line-modified">!  * CKM_X9_42_DH_HYBRID_DERIVE, and CKM_X9_42_MQV_DERIVE are new for</span>
<span class="line-modified">!  * v2.11 */</span>
<span class="line-modified">! #define CKM_X9_42_DH_KEY_PAIR_GEN      0x00000030</span>
<span class="line-modified">! #define CKM_X9_42_DH_DERIVE            0x00000031</span>
<span class="line-modified">! #define CKM_X9_42_DH_HYBRID_DERIVE     0x00000032</span>
<span class="line-modified">! #define CKM_X9_42_MQV_DERIVE           0x00000033</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_SHA256/384/512 are new for v2.20 */</span>
<span class="line-modified">! #define CKM_SHA256_RSA_PKCS            0x00000040</span>
<span class="line-modified">! #define CKM_SHA384_RSA_PKCS            0x00000041</span>
<span class="line-modified">! #define CKM_SHA512_RSA_PKCS            0x00000042</span>
<span class="line-modified">! #define CKM_SHA256_RSA_PKCS_PSS        0x00000043</span>
<span class="line-modified">! #define CKM_SHA384_RSA_PKCS_PSS        0x00000044</span>
<span class="line-modified">! #define CKM_SHA512_RSA_PKCS_PSS        0x00000045</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_RC2_KEY_GEN                0x00000100</span>
<span class="line-modified">! #define CKM_RC2_ECB                    0x00000101</span>
<span class="line-modified">! #define CKM_RC2_CBC                    0x00000102</span>
<span class="line-modified">! #define CKM_RC2_MAC                    0x00000103</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_RC2_MAC_GENERAL and CKM_RC2_CBC_PAD are new for v2.0 */</span>
<span class="line-modified">! #define CKM_RC2_MAC_GENERAL            0x00000104</span>
<span class="line-modified">! #define CKM_RC2_CBC_PAD                0x00000105</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_RC4_KEY_GEN                0x00000110</span>
<span class="line-modified">! #define CKM_RC4                        0x00000111</span>
<span class="line-modified">! #define CKM_DES_KEY_GEN                0x00000120</span>
<span class="line-modified">! #define CKM_DES_ECB                    0x00000121</span>
<span class="line-modified">! #define CKM_DES_CBC                    0x00000122</span>
<span class="line-modified">! #define CKM_DES_MAC                    0x00000123</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_DES_MAC_GENERAL and CKM_DES_CBC_PAD are new for v2.0 */</span>
<span class="line-modified">! #define CKM_DES_MAC_GENERAL            0x00000124</span>
<span class="line-modified">! #define CKM_DES_CBC_PAD                0x00000125</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_DES2_KEY_GEN               0x00000130</span>
<span class="line-modified">! #define CKM_DES3_KEY_GEN               0x00000131</span>
<span class="line-modified">! #define CKM_DES3_ECB                   0x00000132</span>
<span class="line-modified">! #define CKM_DES3_CBC                   0x00000133</span>
<span class="line-modified">! #define CKM_DES3_MAC                   0x00000134</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_DES3_MAC_GENERAL, CKM_DES3_CBC_PAD, CKM_CDMF_KEY_GEN,</span>
<span class="line-modified">!  * CKM_CDMF_ECB, CKM_CDMF_CBC, CKM_CDMF_MAC,</span>
<span class="line-modified">!  * CKM_CDMF_MAC_GENERAL, and CKM_CDMF_CBC_PAD are new for v2.0 */</span>
<span class="line-modified">! #define CKM_DES3_MAC_GENERAL           0x00000135</span>
<span class="line-modified">! #define CKM_DES3_CBC_PAD               0x00000136</span>
<span class="line-modified">! #define CKM_CDMF_KEY_GEN               0x00000140</span>
<span class="line-modified">! #define CKM_CDMF_ECB                   0x00000141</span>
<span class="line-modified">! #define CKM_CDMF_CBC                   0x00000142</span>
<span class="line-modified">! #define CKM_CDMF_MAC                   0x00000143</span>
<span class="line-modified">! #define CKM_CDMF_MAC_GENERAL           0x00000144</span>
<span class="line-modified">! #define CKM_CDMF_CBC_PAD               0x00000145</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* the following four DES mechanisms are new for v2.20 */</span>
<span class="line-modified">! #define CKM_DES_OFB64                  0x00000150</span>
<span class="line-modified">! #define CKM_DES_OFB8                   0x00000151</span>
<span class="line-modified">! #define CKM_DES_CFB64                  0x00000152</span>
<span class="line-modified">! #define CKM_DES_CFB8                   0x00000153</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_MD2                        0x00000200</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_MD2_HMAC and CKM_MD2_HMAC_GENERAL are new for v2.0 */</span>
<span class="line-modified">! #define CKM_MD2_HMAC                   0x00000201</span>
<span class="line-modified">! #define CKM_MD2_HMAC_GENERAL           0x00000202</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_MD5                        0x00000210</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_MD5_HMAC and CKM_MD5_HMAC_GENERAL are new for v2.0 */</span>
<span class="line-modified">! #define CKM_MD5_HMAC                   0x00000211</span>
<span class="line-modified">! #define CKM_MD5_HMAC_GENERAL           0x00000212</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_SHA_1                      0x00000220</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_SHA_1_HMAC and CKM_SHA_1_HMAC_GENERAL are new for v2.0 */</span>
<span class="line-modified">! #define CKM_SHA_1_HMAC                 0x00000221</span>
<span class="line-modified">! #define CKM_SHA_1_HMAC_GENERAL         0x00000222</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_RIPEMD128, CKM_RIPEMD128_HMAC,</span>
<span class="line-modified">!  * CKM_RIPEMD128_HMAC_GENERAL, CKM_RIPEMD160, CKM_RIPEMD160_HMAC,</span>
<span class="line-modified">!  * and CKM_RIPEMD160_HMAC_GENERAL are new for v2.10 */</span>
<span class="line-modified">! #define CKM_RIPEMD128                  0x00000230</span>
<span class="line-modified">! #define CKM_RIPEMD128_HMAC             0x00000231</span>
<span class="line-modified">! #define CKM_RIPEMD128_HMAC_GENERAL     0x00000232</span>
<span class="line-modified">! #define CKM_RIPEMD160                  0x00000240</span>
<span class="line-modified">! #define CKM_RIPEMD160_HMAC             0x00000241</span>
<span class="line-modified">! #define CKM_RIPEMD160_HMAC_GENERAL     0x00000242</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_SHA256/384/512 are new for v2.20 */</span>
<span class="line-modified">! #define CKM_SHA256                     0x00000250</span>
<span class="line-modified">! #define CKM_SHA256_HMAC                0x00000251</span>
<span class="line-modified">! #define CKM_SHA256_HMAC_GENERAL        0x00000252</span>
<span class="line-modified">! #define CKM_SHA384                     0x00000260</span>
<span class="line-modified">! #define CKM_SHA384_HMAC                0x00000261</span>
<span class="line-modified">! #define CKM_SHA384_HMAC_GENERAL        0x00000262</span>
<span class="line-modified">! #define CKM_SHA512                     0x00000270</span>
<span class="line-modified">! #define CKM_SHA512_HMAC                0x00000271</span>
<span class="line-modified">! #define CKM_SHA512_HMAC_GENERAL        0x00000272</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* All of the following mechanisms are new for v2.0 */</span>
  /* Note that CAST128 and CAST5 are the same algorithm */
<span class="line-modified">! #define CKM_CAST_KEY_GEN               0x00000300</span>
<span class="line-modified">! #define CKM_CAST_ECB                   0x00000301</span>
<span class="line-modified">! #define CKM_CAST_CBC                   0x00000302</span>
<span class="line-modified">! #define CKM_CAST_MAC                   0x00000303</span>
<span class="line-modified">! #define CKM_CAST_MAC_GENERAL           0x00000304</span>
<span class="line-modified">! #define CKM_CAST_CBC_PAD               0x00000305</span>
<span class="line-modified">! #define CKM_CAST3_KEY_GEN              0x00000310</span>
<span class="line-modified">! #define CKM_CAST3_ECB                  0x00000311</span>
<span class="line-modified">! #define CKM_CAST3_CBC                  0x00000312</span>
<span class="line-modified">! #define CKM_CAST3_MAC                  0x00000313</span>
<span class="line-modified">! #define CKM_CAST3_MAC_GENERAL          0x00000314</span>
<span class="line-modified">! #define CKM_CAST3_CBC_PAD              0x00000315</span>
<span class="line-modified">! #define CKM_CAST5_KEY_GEN              0x00000320</span>
<span class="line-modified">! #define CKM_CAST128_KEY_GEN            0x00000320</span>
<span class="line-modified">! #define CKM_CAST5_ECB                  0x00000321</span>
<span class="line-modified">! #define CKM_CAST128_ECB                0x00000321</span>
<span class="line-modified">! #define CKM_CAST5_CBC                  0x00000322</span>
<span class="line-modified">! #define CKM_CAST128_CBC                0x00000322</span>
<span class="line-modified">! #define CKM_CAST5_MAC                  0x00000323</span>
<span class="line-modified">! #define CKM_CAST128_MAC                0x00000323</span>
<span class="line-modified">! #define CKM_CAST5_MAC_GENERAL          0x00000324</span>
<span class="line-modified">! #define CKM_CAST128_MAC_GENERAL        0x00000324</span>
<span class="line-modified">! #define CKM_CAST5_CBC_PAD              0x00000325</span>
<span class="line-modified">! #define CKM_CAST128_CBC_PAD            0x00000325</span>
<span class="line-modified">! #define CKM_RC5_KEY_GEN                0x00000330</span>
<span class="line-modified">! #define CKM_RC5_ECB                    0x00000331</span>
<span class="line-modified">! #define CKM_RC5_CBC                    0x00000332</span>
<span class="line-modified">! #define CKM_RC5_MAC                    0x00000333</span>
<span class="line-modified">! #define CKM_RC5_MAC_GENERAL            0x00000334</span>
<span class="line-modified">! #define CKM_RC5_CBC_PAD                0x00000335</span>
<span class="line-modified">! #define CKM_IDEA_KEY_GEN               0x00000340</span>
<span class="line-modified">! #define CKM_IDEA_ECB                   0x00000341</span>
<span class="line-modified">! #define CKM_IDEA_CBC                   0x00000342</span>
<span class="line-modified">! #define CKM_IDEA_MAC                   0x00000343</span>
<span class="line-modified">! #define CKM_IDEA_MAC_GENERAL           0x00000344</span>
<span class="line-modified">! #define CKM_IDEA_CBC_PAD               0x00000345</span>
<span class="line-modified">! #define CKM_GENERIC_SECRET_KEY_GEN     0x00000350</span>
<span class="line-modified">! #define CKM_CONCATENATE_BASE_AND_KEY   0x00000360</span>
<span class="line-modified">! #define CKM_CONCATENATE_BASE_AND_DATA  0x00000362</span>
<span class="line-modified">! #define CKM_CONCATENATE_DATA_AND_BASE  0x00000363</span>
<span class="line-modified">! #define CKM_XOR_BASE_AND_DATA          0x00000364</span>
<span class="line-modified">! #define CKM_EXTRACT_KEY_FROM_KEY       0x00000365</span>
<span class="line-modified">! #define CKM_SSL3_PRE_MASTER_KEY_GEN    0x00000370</span>
<span class="line-modified">! #define CKM_SSL3_MASTER_KEY_DERIVE     0x00000371</span>
<span class="line-modified">! #define CKM_SSL3_KEY_AND_MAC_DERIVE    0x00000372</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_SSL3_MASTER_KEY_DERIVE_DH, CKM_TLS_PRE_MASTER_KEY_GEN,</span>
<span class="line-modified">!  * CKM_TLS_MASTER_KEY_DERIVE, CKM_TLS_KEY_AND_MAC_DERIVE, and</span>
<span class="line-modified">!  * CKM_TLS_MASTER_KEY_DERIVE_DH are new for v2.11 */</span>
<span class="line-modified">! #define CKM_SSL3_MASTER_KEY_DERIVE_DH  0x00000373</span>
<span class="line-modified">! #define CKM_TLS_PRE_MASTER_KEY_GEN     0x00000374</span>
<span class="line-modified">! #define CKM_TLS_MASTER_KEY_DERIVE      0x00000375</span>
<span class="line-modified">! #define CKM_TLS_KEY_AND_MAC_DERIVE     0x00000376</span>
<span class="line-modified">! #define CKM_TLS_MASTER_KEY_DERIVE_DH   0x00000377</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_TLS_PRF is new for v2.20 */</span>
<span class="line-modified">! #define CKM_TLS_PRF                    0x00000378</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_SSL3_MD5_MAC               0x00000380</span>
<span class="line-modified">! #define CKM_SSL3_SHA1_MAC              0x00000381</span>
<span class="line-modified">! #define CKM_MD5_KEY_DERIVATION         0x00000390</span>
<span class="line-modified">! #define CKM_MD2_KEY_DERIVATION         0x00000391</span>
<span class="line-modified">! #define CKM_SHA1_KEY_DERIVATION        0x00000392</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_SHA256/384/512 are new for v2.20 */</span>
<span class="line-modified">! #define CKM_SHA256_KEY_DERIVATION      0x00000393</span>
<span class="line-modified">! #define CKM_SHA384_KEY_DERIVATION      0x00000394</span>
<span class="line-modified">! #define CKM_SHA512_KEY_DERIVATION      0x00000395</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_PBE_MD2_DES_CBC            0x000003A0</span>
<span class="line-modified">! #define CKM_PBE_MD5_DES_CBC            0x000003A1</span>
<span class="line-modified">! #define CKM_PBE_MD5_CAST_CBC           0x000003A2</span>
<span class="line-modified">! #define CKM_PBE_MD5_CAST3_CBC          0x000003A3</span>
<span class="line-modified">! #define CKM_PBE_MD5_CAST5_CBC          0x000003A4</span>
<span class="line-modified">! #define CKM_PBE_MD5_CAST128_CBC        0x000003A4</span>
<span class="line-modified">! #define CKM_PBE_SHA1_CAST5_CBC         0x000003A5</span>
<span class="line-modified">! #define CKM_PBE_SHA1_CAST128_CBC       0x000003A5</span>
<span class="line-modified">! #define CKM_PBE_SHA1_RC4_128           0x000003A6</span>
<span class="line-modified">! #define CKM_PBE_SHA1_RC4_40            0x000003A7</span>
<span class="line-modified">! #define CKM_PBE_SHA1_DES3_EDE_CBC      0x000003A8</span>
<span class="line-modified">! #define CKM_PBE_SHA1_DES2_EDE_CBC      0x000003A9</span>
<span class="line-modified">! #define CKM_PBE_SHA1_RC2_128_CBC       0x000003AA</span>
<span class="line-modified">! #define CKM_PBE_SHA1_RC2_40_CBC        0x000003AB</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_PKCS5_PBKD2 is new for v2.10 */</span>
<span class="line-modified">! #define CKM_PKCS5_PBKD2                0x000003B0</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_PBA_SHA1_WITH_SHA1_HMAC    0x000003C0</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* WTLS mechanisms are new for v2.20 */</span>
<span class="line-modified">! #define CKM_WTLS_PRE_MASTER_KEY_GEN         0x000003D0</span>
<span class="line-modified">! #define CKM_WTLS_MASTER_KEY_DERIVE          0x000003D1</span>
<span class="line-modified">! #define CKM_WTLS_MASTER_KEY_DERIVE_DH_ECC   0x000003D2</span>
<span class="line-modified">! #define CKM_WTLS_PRF                        0x000003D3</span>
<span class="line-modified">! #define CKM_WTLS_SERVER_KEY_AND_MAC_DERIVE  0x000003D4</span>
<span class="line-modified">! #define CKM_WTLS_CLIENT_KEY_AND_MAC_DERIVE  0x000003D5</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* new for v2.40 */</span>
<span class="line-modified">! #define CKM_TLS12_MASTER_KEY_DERIVE         0x000003E0</span>
<span class="line-modified">! #define CKM_TLS12_KEY_AND_MAC_DERIVE        0x000003E1</span>
<span class="line-modified">! #define CKM_TLS12_MASTER_KEY_DERIVE_DH      0x000003E2</span>
<span class="line-modified">! #define CKM_TLS_MAC                         0x000003E4</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_KEY_WRAP_LYNKS             0x00000400</span>
<span class="line-modified">! #define CKM_KEY_WRAP_SET_OAEP          0x00000401</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_CMS_SIG is new for v2.20 */</span>
<span class="line-modified">! #define CKM_CMS_SIG                    0x00000500</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* Fortezza mechanisms */</span>
<span class="line-modified">! #define CKM_SKIPJACK_KEY_GEN           0x00001000</span>
<span class="line-modified">! #define CKM_SKIPJACK_ECB64             0x00001001</span>
<span class="line-modified">! #define CKM_SKIPJACK_CBC64             0x00001002</span>
<span class="line-modified">! #define CKM_SKIPJACK_OFB64             0x00001003</span>
<span class="line-modified">! #define CKM_SKIPJACK_CFB64             0x00001004</span>
<span class="line-modified">! #define CKM_SKIPJACK_CFB32             0x00001005</span>
<span class="line-modified">! #define CKM_SKIPJACK_CFB16             0x00001006</span>
<span class="line-modified">! #define CKM_SKIPJACK_CFB8              0x00001007</span>
<span class="line-modified">! #define CKM_SKIPJACK_WRAP              0x00001008</span>
<span class="line-modified">! #define CKM_SKIPJACK_PRIVATE_WRAP      0x00001009</span>
<span class="line-modified">! #define CKM_SKIPJACK_RELAYX            0x0000100a</span>
<span class="line-modified">! #define CKM_KEA_KEY_PAIR_GEN           0x00001010</span>
<span class="line-modified">! #define CKM_KEA_KEY_DERIVE             0x00001011</span>
<span class="line-modified">! #define CKM_FORTEZZA_TIMESTAMP         0x00001020</span>
<span class="line-modified">! #define CKM_BATON_KEY_GEN              0x00001030</span>
<span class="line-modified">! #define CKM_BATON_ECB128               0x00001031</span>
<span class="line-modified">! #define CKM_BATON_ECB96                0x00001032</span>
<span class="line-modified">! #define CKM_BATON_CBC128               0x00001033</span>
<span class="line-modified">! #define CKM_BATON_COUNTER              0x00001034</span>
<span class="line-modified">! #define CKM_BATON_SHUFFLE              0x00001035</span>
<span class="line-modified">! #define CKM_BATON_WRAP                 0x00001036</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_ECDSA_KEY_PAIR_GEN is deprecated in v2.11,</span>
<span class="line-modified">!  * CKM_EC_KEY_PAIR_GEN is preferred */</span>
<span class="line-modified">! #define CKM_ECDSA_KEY_PAIR_GEN         0x00001040</span>
<span class="line-modified">! #define CKM_EC_KEY_PAIR_GEN            0x00001040</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_ECDSA                      0x00001041</span>
<span class="line-modified">! #define CKM_ECDSA_SHA1                 0x00001042</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_ECDH1_DERIVE, CKM_ECDH1_COFACTOR_DERIVE, and CKM_ECMQV_DERIVE</span>
<span class="line-modified">!  * are new for v2.11 */</span>
<span class="line-modified">! #define CKM_ECDH1_DERIVE               0x00001050</span>
<span class="line-modified">! #define CKM_ECDH1_COFACTOR_DERIVE      0x00001051</span>
<span class="line-modified">! #define CKM_ECMQV_DERIVE               0x00001052</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_JUNIPER_KEY_GEN            0x00001060</span>
<span class="line-modified">! #define CKM_JUNIPER_ECB128             0x00001061</span>
<span class="line-modified">! #define CKM_JUNIPER_CBC128             0x00001062</span>
<span class="line-modified">! #define CKM_JUNIPER_COUNTER            0x00001063</span>
<span class="line-modified">! #define CKM_JUNIPER_SHUFFLE            0x00001064</span>
<span class="line-modified">! #define CKM_JUNIPER_WRAP               0x00001065</span>
<span class="line-modified">! #define CKM_FASTHASH                   0x00001070</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_AES_KEY_GEN, CKM_AES_ECB, CKM_AES_CBC, CKM_AES_MAC,</span>
<span class="line-modified">!  * CKM_AES_MAC_GENERAL, CKM_AES_CBC_PAD, CKM_DSA_PARAMETER_GEN,</span>
<span class="line-modified">!  * CKM_DH_PKCS_PARAMETER_GEN, and CKM_X9_42_DH_PARAMETER_GEN are</span>
<span class="line-modified">!  * new for v2.11 */</span>
<span class="line-modified">! #define CKM_AES_KEY_GEN                0x00001080</span>
<span class="line-modified">! #define CKM_AES_ECB                    0x00001081</span>
<span class="line-modified">! #define CKM_AES_CBC                    0x00001082</span>
<span class="line-modified">! #define CKM_AES_MAC                    0x00001083</span>
<span class="line-modified">! #define CKM_AES_MAC_GENERAL            0x00001084</span>
<span class="line-modified">! #define CKM_AES_CBC_PAD                0x00001085</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* BlowFish and TwoFish are new for v2.20 */</span>
<span class="line-modified">! #define CKM_BLOWFISH_KEY_GEN           0x00001090</span>
<span class="line-modified">! #define CKM_BLOWFISH_CBC               0x00001091</span>
<span class="line-modified">! #define CKM_TWOFISH_KEY_GEN            0x00001092</span>
<span class="line-modified">! #define CKM_TWOFISH_CBC                0x00001093</span>
<span class="line-modified">! </span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKM_xxx_ENCRYPT_DATA mechanisms are new for v2.20 */</span>
<span class="line-modified">! #define CKM_DES_ECB_ENCRYPT_DATA       0x00001100</span>
<span class="line-modified">! #define CKM_DES_CBC_ENCRYPT_DATA       0x00001101</span>
<span class="line-modified">! #define CKM_DES3_ECB_ENCRYPT_DATA      0x00001102</span>
<span class="line-modified">! #define CKM_DES3_CBC_ENCRYPT_DATA      0x00001103</span>
<span class="line-modified">! #define CKM_AES_ECB_ENCRYPT_DATA       0x00001104</span>
<span class="line-modified">! #define CKM_AES_CBC_ENCRYPT_DATA       0x00001105</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_DSA_PARAMETER_GEN          0x00002000</span>
<span class="line-modified">! #define CKM_DH_PKCS_PARAMETER_GEN      0x00002001</span>
<span class="line-modified">! #define CKM_X9_42_DH_PARAMETER_GEN     0x00002002</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_VENDOR_DEFINED             0x80000000</span>
  
  typedef CK_MECHANISM_TYPE CK_PTR CK_MECHANISM_TYPE_PTR;
  
  
  /* CK_MECHANISM is a structure that specifies a particular
<span class="line-modified">!  * mechanism  */</span>
  typedef struct CK_MECHANISM {
    CK_MECHANISM_TYPE mechanism;
    CK_VOID_PTR       pParameter;
<span class="line-removed">- </span>
<span class="line-removed">-   /* ulParameterLen was changed from CK_USHORT to CK_ULONG for</span>
<span class="line-removed">-    * v2.0 */</span>
    CK_ULONG          ulParameterLen;  /* in bytes */
  } CK_MECHANISM;
  
  typedef CK_MECHANISM CK_PTR CK_MECHANISM_PTR;
  
  
  /* CK_MECHANISM_INFO provides information about a particular
<span class="line-modified">!  * mechanism */</span>
  typedef struct CK_MECHANISM_INFO {
      CK_ULONG    ulMinKeySize;
      CK_ULONG    ulMaxKeySize;
      CK_FLAGS    flags;
  } CK_MECHANISM_INFO;
  
  /* The flags are defined as follows:
<span class="line-modified">!  *      Bit Flag               Mask        Meaning */</span>
<span class="line-modified">! #define CKF_HW                 0x00000001  /* performed by HW */</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* The flags CKF_ENCRYPT, CKF_DECRYPT, CKF_DIGEST, CKF_SIGN,</span>
<span class="line-modified">!  * CKG_SIGN_RECOVER, CKF_VERIFY, CKF_VERIFY_RECOVER,</span>
<span class="line-modified">!  * CKF_GENERATE, CKF_GENERATE_KEY_PAIR, CKF_WRAP, CKF_UNWRAP,</span>
<span class="line-modified">!  * and CKF_DERIVE are new for v2.0.  They specify whether or not</span>
<span class="line-modified">!  * a mechanism can be used for a particular task */</span>
<span class="line-modified">! #define CKF_ENCRYPT            0x00000100</span>
<span class="line-modified">! #define CKF_DECRYPT            0x00000200</span>
<span class="line-modified">! #define CKF_DIGEST             0x00000400</span>
<span class="line-modified">! #define CKF_SIGN               0x00000800</span>
<span class="line-modified">! #define CKF_SIGN_RECOVER       0x00001000</span>
<span class="line-modified">! #define CKF_VERIFY             0x00002000</span>
<span class="line-modified">! #define CKF_VERIFY_RECOVER     0x00004000</span>
<span class="line-modified">! #define CKF_GENERATE           0x00008000</span>
<span class="line-modified">! #define CKF_GENERATE_KEY_PAIR  0x00010000</span>
<span class="line-modified">! #define CKF_WRAP               0x00020000</span>
<span class="line-modified">! #define CKF_UNWRAP             0x00040000</span>
<span class="line-modified">! #define CKF_DERIVE             0x00080000</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKF_EC_F_P, CKF_EC_F_2M, CKF_EC_ECPARAMETERS, CKF_EC_NAMEDCURVE,</span>
<span class="line-modified">!  * CKF_EC_UNCOMPRESS, and CKF_EC_COMPRESS are new for v2.11. They</span>
<span class="line-modified">!  * describe a token&#39;s EC capabilities not available in mechanism</span>
<span class="line-modified">!  * information. */</span>
<span class="line-modified">! #define CKF_EC_F_P             0x00100000</span>
<span class="line-removed">- #define CKF_EC_F_2M            0x00200000</span>
<span class="line-removed">- #define CKF_EC_ECPARAMETERS    0x00400000</span>
<span class="line-removed">- #define CKF_EC_NAMEDCURVE      0x00800000</span>
<span class="line-removed">- #define CKF_EC_UNCOMPRESS      0x01000000</span>
<span class="line-removed">- #define CKF_EC_COMPRESS        0x02000000</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define CKF_EXTENSION          0x80000000 /* FALSE for this version */</span>
  
<span class="line-modified">! typedef CK_MECHANISM_INFO CK_PTR CK_MECHANISM_INFO_PTR;</span>
  
  
  /* CK_RV is a value that identifies the return value of a
<span class="line-modified">!  * Cryptoki function */</span>
<span class="line-modified">! /* CK_RV was changed from CK_USHORT to CK_ULONG for v2.0 */</span>
  typedef CK_ULONG          CK_RV;
  
<span class="line-modified">! #define CKR_OK                                0x00000000</span>
<span class="line-modified">! #define CKR_CANCEL                            0x00000001</span>
<span class="line-modified">! #define CKR_HOST_MEMORY                       0x00000002</span>
<span class="line-modified">! #define CKR_SLOT_ID_INVALID                   0x00000003</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKR_FLAGS_INVALID was removed for v2.0 */</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKR_GENERAL_ERROR and CKR_FUNCTION_FAILED are new for v2.0 */</span>
<span class="line-modified">! #define CKR_GENERAL_ERROR                     0x00000005</span>
<span class="line-modified">! #define CKR_FUNCTION_FAILED                   0x00000006</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKR_ARGUMENTS_BAD, CKR_NO_EVENT, CKR_NEED_TO_CREATE_THREADS,</span>
<span class="line-modified">!  * and CKR_CANT_LOCK are new for v2.01 */</span>
<span class="line-modified">! #define CKR_ARGUMENTS_BAD                     0x00000007</span>
<span class="line-modified">! #define CKR_NO_EVENT                          0x00000008</span>
<span class="line-modified">! #define CKR_NEED_TO_CREATE_THREADS            0x00000009</span>
<span class="line-modified">! #define CKR_CANT_LOCK                         0x0000000A</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_ATTRIBUTE_READ_ONLY               0x00000010</span>
<span class="line-modified">! #define CKR_ATTRIBUTE_SENSITIVE               0x00000011</span>
<span class="line-modified">! #define CKR_ATTRIBUTE_TYPE_INVALID            0x00000012</span>
<span class="line-modified">! #define CKR_ATTRIBUTE_VALUE_INVALID           0x00000013</span>
<span class="line-modified">! #define CKR_DATA_INVALID                      0x00000020</span>
<span class="line-modified">! #define CKR_DATA_LEN_RANGE                    0x00000021</span>
<span class="line-modified">! #define CKR_DEVICE_ERROR                      0x00000030</span>
<span class="line-modified">! #define CKR_DEVICE_MEMORY                     0x00000031</span>
<span class="line-modified">! #define CKR_DEVICE_REMOVED                    0x00000032</span>
<span class="line-modified">! #define CKR_ENCRYPTED_DATA_INVALID            0x00000040</span>
<span class="line-modified">! #define CKR_ENCRYPTED_DATA_LEN_RANGE          0x00000041</span>
<span class="line-modified">! #define CKR_FUNCTION_CANCELED                 0x00000050</span>
<span class="line-modified">! #define CKR_FUNCTION_NOT_PARALLEL             0x00000051</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKR_FUNCTION_NOT_SUPPORTED is new for v2.0 */</span>
<span class="line-modified">! #define CKR_FUNCTION_NOT_SUPPORTED            0x00000054</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_KEY_HANDLE_INVALID                0x00000060</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKR_KEY_SENSITIVE was removed for v2.0 */</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_KEY_SIZE_RANGE                    0x00000062</span>
<span class="line-modified">! #define CKR_KEY_TYPE_INCONSISTENT             0x00000063</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKR_KEY_NOT_NEEDED, CKR_KEY_CHANGED, CKR_KEY_NEEDED,</span>
<span class="line-modified">!  * CKR_KEY_INDIGESTIBLE, CKR_KEY_FUNCTION_NOT_PERMITTED,</span>
<span class="line-modified">!  * CKR_KEY_NOT_WRAPPABLE, and CKR_KEY_UNEXTRACTABLE are new for</span>
<span class="line-modified">!  * v2.0 */</span>
<span class="line-modified">! #define CKR_KEY_NOT_NEEDED                    0x00000064</span>
<span class="line-modified">! #define CKR_KEY_CHANGED                       0x00000065</span>
<span class="line-modified">! #define CKR_KEY_NEEDED                        0x00000066</span>
<span class="line-modified">! #define CKR_KEY_INDIGESTIBLE                  0x00000067</span>
<span class="line-modified">! #define CKR_KEY_FUNCTION_NOT_PERMITTED        0x00000068</span>
<span class="line-modified">! #define CKR_KEY_NOT_WRAPPABLE                 0x00000069</span>
<span class="line-modified">! #define CKR_KEY_UNEXTRACTABLE                 0x0000006A</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_MECHANISM_INVALID                 0x00000070</span>
<span class="line-modified">! #define CKR_MECHANISM_PARAM_INVALID           0x00000071</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKR_OBJECT_CLASS_INCONSISTENT and CKR_OBJECT_CLASS_INVALID</span>
<span class="line-modified">!  * were removed for v2.0 */</span>
<span class="line-modified">! #define CKR_OBJECT_HANDLE_INVALID             0x00000082</span>
<span class="line-modified">! #define CKR_OPERATION_ACTIVE                  0x00000090</span>
<span class="line-modified">! #define CKR_OPERATION_NOT_INITIALIZED         0x00000091</span>
<span class="line-modified">! #define CKR_PIN_INCORRECT                     0x000000A0</span>
<span class="line-modified">! #define CKR_PIN_INVALID                       0x000000A1</span>
<span class="line-modified">! #define CKR_PIN_LEN_RANGE                     0x000000A2</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKR_PIN_EXPIRED and CKR_PIN_LOCKED are new for v2.0 */</span>
<span class="line-modified">! #define CKR_PIN_EXPIRED                       0x000000A3</span>
<span class="line-modified">! #define CKR_PIN_LOCKED                        0x000000A4</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_SESSION_CLOSED                    0x000000B0</span>
<span class="line-modified">! #define CKR_SESSION_COUNT                     0x000000B1</span>
<span class="line-modified">! #define CKR_SESSION_HANDLE_INVALID            0x000000B3</span>
<span class="line-modified">! #define CKR_SESSION_PARALLEL_NOT_SUPPORTED    0x000000B4</span>
<span class="line-modified">! #define CKR_SESSION_READ_ONLY                 0x000000B5</span>
<span class="line-modified">! #define CKR_SESSION_EXISTS                    0x000000B6</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKR_SESSION_READ_ONLY_EXISTS and</span>
<span class="line-modified">!  * CKR_SESSION_READ_WRITE_SO_EXISTS are new for v2.0 */</span>
<span class="line-modified">! #define CKR_SESSION_READ_ONLY_EXISTS          0x000000B7</span>
<span class="line-modified">! #define CKR_SESSION_READ_WRITE_SO_EXISTS      0x000000B8</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_SIGNATURE_INVALID                 0x000000C0</span>
<span class="line-modified">! #define CKR_SIGNATURE_LEN_RANGE               0x000000C1</span>
<span class="line-modified">! #define CKR_TEMPLATE_INCOMPLETE               0x000000D0</span>
<span class="line-modified">! #define CKR_TEMPLATE_INCONSISTENT             0x000000D1</span>
<span class="line-modified">! #define CKR_TOKEN_NOT_PRESENT                 0x000000E0</span>
<span class="line-modified">! #define CKR_TOKEN_NOT_RECOGNIZED              0x000000E1</span>
<span class="line-modified">! #define CKR_TOKEN_WRITE_PROTECTED             0x000000E2</span>
<span class="line-modified">! #define CKR_UNWRAPPING_KEY_HANDLE_INVALID     0x000000F0</span>
<span class="line-modified">! #define CKR_UNWRAPPING_KEY_SIZE_RANGE         0x000000F1</span>
<span class="line-modified">! #define CKR_UNWRAPPING_KEY_TYPE_INCONSISTENT  0x000000F2</span>
<span class="line-modified">! #define CKR_USER_ALREADY_LOGGED_IN            0x00000100</span>
<span class="line-modified">! #define CKR_USER_NOT_LOGGED_IN                0x00000101</span>
<span class="line-modified">! #define CKR_USER_PIN_NOT_INITIALIZED          0x00000102</span>
<span class="line-modified">! #define CKR_USER_TYPE_INVALID                 0x00000103</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKR_USER_ANOTHER_ALREADY_LOGGED_IN and CKR_USER_TOO_MANY_TYPES</span>
<span class="line-modified">!  * are new to v2.01 */</span>
<span class="line-modified">! #define CKR_USER_ANOTHER_ALREADY_LOGGED_IN    0x00000104</span>
<span class="line-modified">! #define CKR_USER_TOO_MANY_TYPES               0x00000105</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_WRAPPED_KEY_INVALID               0x00000110</span>
<span class="line-modified">! #define CKR_WRAPPED_KEY_LEN_RANGE             0x00000112</span>
<span class="line-modified">! #define CKR_WRAPPING_KEY_HANDLE_INVALID       0x00000113</span>
<span class="line-modified">! #define CKR_WRAPPING_KEY_SIZE_RANGE           0x00000114</span>
<span class="line-modified">! #define CKR_WRAPPING_KEY_TYPE_INCONSISTENT    0x00000115</span>
<span class="line-modified">! #define CKR_RANDOM_SEED_NOT_SUPPORTED         0x00000120</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* These are new to v2.0 */</span>
<span class="line-modified">! #define CKR_RANDOM_NO_RNG                     0x00000121</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* These are new to v2.11 */</span>
<span class="line-modified">! #define CKR_DOMAIN_PARAMS_INVALID             0x00000130</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* These are new to v2.0 */</span>
<span class="line-modified">! #define CKR_BUFFER_TOO_SMALL                  0x00000150</span>
<span class="line-modified">! #define CKR_SAVED_STATE_INVALID               0x00000160</span>
<span class="line-modified">! #define CKR_INFORMATION_SENSITIVE             0x00000170</span>
<span class="line-modified">! #define CKR_STATE_UNSAVEABLE                  0x00000180</span>
<span class="line-modified">! </span>
<span class="line-removed">- /* These are new to v2.01 */</span>
<span class="line-removed">- #define CKR_CRYPTOKI_NOT_INITIALIZED          0x00000190</span>
<span class="line-removed">- #define CKR_CRYPTOKI_ALREADY_INITIALIZED      0x00000191</span>
<span class="line-removed">- #define CKR_MUTEX_BAD                         0x000001A0</span>
<span class="line-removed">- #define CKR_MUTEX_NOT_LOCKED                  0x000001A1</span>
<span class="line-removed">- </span>
<span class="line-removed">- /* This is new to v2.20 */</span>
<span class="line-removed">- #define CKR_FUNCTION_REJECTED                 0x00000200</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define CKR_VENDOR_DEFINED                    0x80000000</span>
  
  
  /* CK_NOTIFY is an application callback that processes events */
  typedef CK_CALLBACK_FUNCTION(CK_RV, CK_NOTIFY)(
    CK_SESSION_HANDLE hSession,     /* the session&#39;s handle */
<span class="line-new-header">--- 83,1082 ---</span>
  
  typedef CK_VERSION CK_PTR CK_VERSION_PTR;
  
  
  typedef struct CK_INFO {
    CK_VERSION    cryptokiVersion;     /* Cryptoki interface ver */
    CK_UTF8CHAR   manufacturerID[32];  /* blank padded */
    CK_FLAGS      flags;               /* must be zero */
    CK_UTF8CHAR   libraryDescription[32];  /* blank padded */
    CK_VERSION    libraryVersion;          /* version of library */
  } CK_INFO;
  
  typedef CK_INFO CK_PTR    CK_INFO_PTR;
  
  
  /* CK_NOTIFICATION enumerates the types of notifications that
<span class="line-modified">!  * Cryptoki provides to an application</span>
<span class="line-modified">!  */</span>
  typedef CK_ULONG CK_NOTIFICATION;
<span class="line-modified">! #define CKN_SURRENDER           0UL</span>
<span class="line-modified">! #define CKN_OTP_CHANGED         1UL</span>
  
  typedef CK_ULONG          CK_SLOT_ID;
  
  typedef CK_SLOT_ID CK_PTR CK_SLOT_ID_PTR;
  
  
  /* CK_SLOT_INFO provides information about a slot */
  typedef struct CK_SLOT_INFO {
    CK_UTF8CHAR   slotDescription[64];  /* blank padded */
    CK_UTF8CHAR   manufacturerID[32];   /* blank padded */
    CK_FLAGS      flags;
  
    CK_VERSION    hardwareVersion;  /* version of hardware */
    CK_VERSION    firmwareVersion;  /* version of firmware */
  } CK_SLOT_INFO;
  
  /* flags: bit flags that provide capabilities of the slot
   *      Bit Flag              Mask        Meaning
   */
<span class="line-modified">! #define CKF_TOKEN_PRESENT     0x00000001UL  /* a token is there */</span>
<span class="line-modified">! #define CKF_REMOVABLE_DEVICE  0x00000002UL  /* removable devices*/</span>
<span class="line-modified">! #define CKF_HW_SLOT           0x00000004UL  /* hardware slot */</span>
  
  typedef CK_SLOT_INFO CK_PTR CK_SLOT_INFO_PTR;
  
  
  /* CK_TOKEN_INFO provides information about a token */
  typedef struct CK_TOKEN_INFO {
    CK_UTF8CHAR   label[32];           /* blank padded */
    CK_UTF8CHAR   manufacturerID[32];  /* blank padded */
    CK_UTF8CHAR   model[16];           /* blank padded */
    CK_CHAR       serialNumber[16];    /* blank padded */
    CK_FLAGS      flags;               /* see below */
  
    CK_ULONG      ulMaxSessionCount;     /* max open sessions */
    CK_ULONG      ulSessionCount;        /* sess. now open */
    CK_ULONG      ulMaxRwSessionCount;   /* max R/W sessions */
    CK_ULONG      ulRwSessionCount;      /* R/W sess. now open */
    CK_ULONG      ulMaxPinLen;           /* in bytes */
    CK_ULONG      ulMinPinLen;           /* in bytes */
    CK_ULONG      ulTotalPublicMemory;   /* in bytes */
    CK_ULONG      ulFreePublicMemory;    /* in bytes */
    CK_ULONG      ulTotalPrivateMemory;  /* in bytes */
    CK_ULONG      ulFreePrivateMemory;   /* in bytes */
    CK_VERSION    hardwareVersion;       /* version of hardware */
    CK_VERSION    firmwareVersion;       /* version of firmware */
    CK_CHAR       utcTime[16];           /* time */
  } CK_TOKEN_INFO;
  
  /* The flags parameter is defined as follows:
   *      Bit Flag                    Mask        Meaning
   */
<span class="line-modified">! #define CKF_RNG                     0x00000001UL  /* has random # generator */</span>
<span class="line-modified">! #define CKF_WRITE_PROTECTED         0x00000002UL  /* token is write-protected */</span>
<span class="line-modified">! #define CKF_LOGIN_REQUIRED          0x00000004UL  /* user must login */</span>
<span class="line-modified">! #define CKF_USER_PIN_INITIALIZED    0x00000008UL  /* normal user&#39;s PIN is set */</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CKF_RESTORE_KEY_NOT_NEEDED.  If it is set,</span>
   * that means that *every* time the state of cryptographic
   * operations of a session is successfully saved, all keys
<span class="line-modified">!  * needed to continue those operations are stored in the state</span>
<span class="line-modified">!  */</span>
<span class="line-added">+ #define CKF_RESTORE_KEY_NOT_NEEDED  0x00000020UL</span>
  
<span class="line-modified">! /* CKF_CLOCK_ON_TOKEN.  If it is set, that means</span>
   * that the token has some sort of clock.  The time on that
<span class="line-modified">!  * clock is returned in the token info structure</span>
<span class="line-modified">!  */</span>
<span class="line-added">+ #define CKF_CLOCK_ON_TOKEN          0x00000040UL</span>
  
<span class="line-modified">! /* CKF_PROTECTED_AUTHENTICATION_PATH.  If it is</span>
   * set, that means that there is some way for the user to login
<span class="line-modified">!  * without sending a PIN through the Cryptoki library itself</span>
<span class="line-modified">!  */</span>
<span class="line-added">+ #define CKF_PROTECTED_AUTHENTICATION_PATH 0x00000100UL</span>
  
<span class="line-modified">! /* CKF_DUAL_CRYPTO_OPERATIONS.  If it is true,</span>
   * that means that a single session with the token can perform
   * dual simultaneous cryptographic operations (digest and
   * encrypt; decrypt and digest; sign and encrypt; and decrypt
<span class="line-modified">!  * and sign)</span>
<span class="line-modified">!  */</span>
<span class="line-added">+ #define CKF_DUAL_CRYPTO_OPERATIONS  0x00000200UL</span>
  
<span class="line-modified">! /* CKF_TOKEN_INITIALIZED. If it is true, the</span>
   * token has been initialized using C_InitializeToken or an
   * equivalent mechanism outside the scope of PKCS #11.
   * Calling C_InitializeToken when this flag is set will cause
<span class="line-modified">!  * the token to be reinitialized.</span>
<span class="line-modified">!  */</span>
<span class="line-added">+ #define CKF_TOKEN_INITIALIZED       0x00000400UL</span>
  
<span class="line-modified">! /* CKF_SECONDARY_AUTHENTICATION. If it is</span>
   * true, the token supports secondary authentication for
<span class="line-modified">!  * private key objects.</span>
<span class="line-modified">!  */</span>
<span class="line-modified">! #define CKF_SECONDARY_AUTHENTICATION  0x00000800UL</span>
  
<span class="line-modified">! /* CKF_USER_PIN_COUNT_LOW. If it is true, an</span>
   * incorrect user login PIN has been entered at least once
<span class="line-modified">!  * since the last successful authentication.</span>
<span class="line-modified">!  */</span>
<span class="line-added">+ #define CKF_USER_PIN_COUNT_LOW       0x00010000UL</span>
  
<span class="line-modified">! /* CKF_USER_PIN_FINAL_TRY. If it is true,</span>
<span class="line-modified">!  * supplying an incorrect user PIN will it to become locked.</span>
<span class="line-modified">!  */</span>
<span class="line-added">+ #define CKF_USER_PIN_FINAL_TRY       0x00020000UL</span>
  
<span class="line-modified">! /* CKF_USER_PIN_LOCKED. If it is true, the</span>
   * user PIN has been locked. User login to the token is not
<span class="line-modified">!  * possible.</span>
<span class="line-modified">!  */</span>
<span class="line-added">+ #define CKF_USER_PIN_LOCKED          0x00040000UL</span>
  
<span class="line-modified">! /* CKF_USER_PIN_TO_BE_CHANGED. If it is true,</span>
   * the user PIN value is the default value set by token
   * initialization or manufacturing, or the PIN has been
<span class="line-modified">!  * expired by the card.</span>
<span class="line-modified">!  */</span>
<span class="line-added">+ #define CKF_USER_PIN_TO_BE_CHANGED   0x00080000UL</span>
  
<span class="line-modified">! /* CKF_SO_PIN_COUNT_LOW. If it is true, an</span>
   * incorrect SO login PIN has been entered at least once since
<span class="line-modified">!  * the last successful authentication.</span>
<span class="line-modified">!  */</span>
<span class="line-added">+ #define CKF_SO_PIN_COUNT_LOW         0x00100000UL</span>
  
<span class="line-modified">! /* CKF_SO_PIN_FINAL_TRY. If it is true,</span>
<span class="line-modified">!  * supplying an incorrect SO PIN will it to become locked.</span>
<span class="line-modified">!  */</span>
<span class="line-added">+ #define CKF_SO_PIN_FINAL_TRY         0x00200000UL</span>
  
<span class="line-modified">! /* CKF_SO_PIN_LOCKED. If it is true, the SO</span>
   * PIN has been locked. SO login to the token is not possible.
   */
<span class="line-modified">! #define CKF_SO_PIN_LOCKED            0x00400000UL</span>
  
<span class="line-modified">! /* CKF_SO_PIN_TO_BE_CHANGED. If it is true,</span>
   * the SO PIN value is the default value set by token
   * initialization or manufacturing, or the PIN has been
<span class="line-modified">!  * expired by the card.</span>
<span class="line-modified">!  */</span>
<span class="line-added">+ #define CKF_SO_PIN_TO_BE_CHANGED     0x00800000UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKF_ERROR_STATE              0x01000000UL</span>
  
  typedef CK_TOKEN_INFO CK_PTR CK_TOKEN_INFO_PTR;
  
  
  /* CK_SESSION_HANDLE is a Cryptoki-assigned value that
<span class="line-modified">!  * identifies a session</span>
<span class="line-added">+  */</span>
  typedef CK_ULONG          CK_SESSION_HANDLE;
  
  typedef CK_SESSION_HANDLE CK_PTR CK_SESSION_HANDLE_PTR;
  
  
  /* CK_USER_TYPE enumerates the types of Cryptoki users */
  typedef CK_ULONG          CK_USER_TYPE;
  /* Security Officer */
<span class="line-modified">! #define CKU_SO                  0UL</span>
  /* Normal user */
<span class="line-modified">! #define CKU_USER                1UL</span>
<span class="line-modified">! /* Context specific */</span>
<span class="line-modified">! #define CKU_CONTEXT_SPECIFIC    2UL</span>
  
  /* CK_STATE enumerates the session states */
  typedef CK_ULONG          CK_STATE;
<span class="line-modified">! #define CKS_RO_PUBLIC_SESSION   0UL</span>
<span class="line-modified">! #define CKS_RO_USER_FUNCTIONS   1UL</span>
<span class="line-modified">! #define CKS_RW_PUBLIC_SESSION   2UL</span>
<span class="line-modified">! #define CKS_RW_USER_FUNCTIONS   3UL</span>
<span class="line-modified">! #define CKS_RW_SO_FUNCTIONS     4UL</span>
  
  /* CK_SESSION_INFO provides information about a session */
  typedef struct CK_SESSION_INFO {
    CK_SLOT_ID    slotID;
    CK_STATE      state;
    CK_FLAGS      flags;          /* see below */
    CK_ULONG      ulDeviceError;  /* device-dependent error code */
  } CK_SESSION_INFO;
  
  /* The flags are defined in the following table:
   *      Bit Flag                Mask        Meaning
   */
<span class="line-modified">! #define CKF_RW_SESSION          0x00000002UL /* session is r/w */</span>
<span class="line-modified">! #define CKF_SERIAL_SESSION      0x00000004UL /* no parallel    */</span>
  
  typedef CK_SESSION_INFO CK_PTR CK_SESSION_INFO_PTR;
  
  
  /* CK_OBJECT_HANDLE is a token-specific identifier for an
<span class="line-modified">!  * object</span>
<span class="line-added">+  */</span>
  typedef CK_ULONG          CK_OBJECT_HANDLE;
  
  typedef CK_OBJECT_HANDLE CK_PTR CK_OBJECT_HANDLE_PTR;
  
  
  /* CK_OBJECT_CLASS is a value that identifies the classes (or
   * types) of objects that Cryptoki recognizes.  It is defined
<span class="line-modified">!  * as follows:</span>
<span class="line-modified">!  */</span>
  typedef CK_ULONG          CK_OBJECT_CLASS;
  
  /* The following classes of objects are defined: */
<span class="line-modified">! #define CKO_DATA              0x00000000UL</span>
<span class="line-modified">! #define CKO_CERTIFICATE       0x00000001UL</span>
<span class="line-modified">! #define CKO_PUBLIC_KEY        0x00000002UL</span>
<span class="line-modified">! #define CKO_PRIVATE_KEY       0x00000003UL</span>
<span class="line-modified">! #define CKO_SECRET_KEY        0x00000004UL</span>
<span class="line-modified">! #define CKO_HW_FEATURE        0x00000005UL</span>
<span class="line-modified">! #define CKO_DOMAIN_PARAMETERS 0x00000006UL</span>
<span class="line-modified">! #define CKO_MECHANISM         0x00000007UL</span>
<span class="line-modified">! #define CKO_OTP_KEY           0x00000008UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKO_VENDOR_DEFINED    0x80000000UL</span>
  
  typedef CK_OBJECT_CLASS CK_PTR CK_OBJECT_CLASS_PTR;
  
<span class="line-modified">! /* CK_HW_FEATURE_TYPE is a value that identifies the hardware feature type</span>
<span class="line-modified">!  * of an object with CK_OBJECT_CLASS equal to CKO_HW_FEATURE.</span>
<span class="line-modified">!  */</span>
  typedef CK_ULONG          CK_HW_FEATURE_TYPE;
  
  /* The following hardware feature types are defined */
<span class="line-modified">! #define CKH_MONOTONIC_COUNTER  0x00000001UL</span>
<span class="line-modified">! #define CKH_CLOCK              0x00000002UL</span>
<span class="line-modified">! #define CKH_USER_INTERFACE     0x00000003UL</span>
<span class="line-modified">! #define CKH_VENDOR_DEFINED     0x80000000UL</span>
  
  /* CK_KEY_TYPE is a value that identifies a key type */
  typedef CK_ULONG          CK_KEY_TYPE;
  
  /* the following key types are defined: */
<span class="line-modified">! #define CKK_RSA                 0x00000000UL</span>
<span class="line-modified">! #define CKK_DSA                 0x00000001UL</span>
<span class="line-modified">! #define CKK_DH                  0x00000002UL</span>
<span class="line-modified">! #define CKK_ECDSA               0x00000003UL /* Deprecated */</span>
<span class="line-modified">! #define CKK_EC                  0x00000003UL</span>
<span class="line-modified">! #define CKK_X9_42_DH            0x00000004UL</span>
<span class="line-modified">! #define CKK_KEA                 0x00000005UL</span>
<span class="line-modified">! #define CKK_GENERIC_SECRET      0x00000010UL</span>
<span class="line-modified">! #define CKK_RC2                 0x00000011UL</span>
<span class="line-modified">! #define CKK_RC4                 0x00000012UL</span>
<span class="line-modified">! #define CKK_DES                 0x00000013UL</span>
<span class="line-modified">! #define CKK_DES2                0x00000014UL</span>
<span class="line-modified">! #define CKK_DES3                0x00000015UL</span>
<span class="line-modified">! #define CKK_CAST                0x00000016UL</span>
<span class="line-modified">! #define CKK_CAST3               0x00000017UL</span>
<span class="line-modified">! #define CKK_CAST5               0x00000018UL /* Deprecated */</span>
<span class="line-modified">! #define CKK_CAST128             0x00000018UL</span>
<span class="line-modified">! #define CKK_RC5                 0x00000019UL</span>
<span class="line-modified">! #define CKK_IDEA                0x0000001AUL</span>
<span class="line-modified">! #define CKK_SKIPJACK            0x0000001BUL</span>
<span class="line-modified">! #define CKK_BATON               0x0000001CUL</span>
<span class="line-modified">! #define CKK_JUNIPER             0x0000001DUL</span>
<span class="line-modified">! #define CKK_CDMF                0x0000001EUL</span>
<span class="line-modified">! #define CKK_AES                 0x0000001FUL</span>
<span class="line-modified">! #define CKK_BLOWFISH            0x00000020UL</span>
<span class="line-modified">! #define CKK_TWOFISH             0x00000021UL</span>
<span class="line-modified">! #define CKK_SECURID             0x00000022UL</span>
<span class="line-modified">! #define CKK_HOTP                0x00000023UL</span>
<span class="line-modified">! #define CKK_ACTI                0x00000024UL</span>
<span class="line-modified">! #define CKK_CAMELLIA            0x00000025UL</span>
<span class="line-modified">! #define CKK_ARIA                0x00000026UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKK_MD5_HMAC            0x00000027UL</span>
<span class="line-modified">! #define CKK_SHA_1_HMAC          0x00000028UL</span>
<span class="line-modified">! #define CKK_RIPEMD128_HMAC      0x00000029UL</span>
<span class="line-modified">! #define CKK_RIPEMD160_HMAC      0x0000002AUL</span>
<span class="line-modified">! #define CKK_SHA256_HMAC         0x0000002BUL</span>
<span class="line-added">+ #define CKK_SHA384_HMAC         0x0000002CUL</span>
<span class="line-added">+ #define CKK_SHA512_HMAC         0x0000002DUL</span>
<span class="line-added">+ #define CKK_SHA224_HMAC         0x0000002EUL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKK_SEED                0x0000002FUL</span>
<span class="line-added">+ #define CKK_GOSTR3410           0x00000030UL</span>
<span class="line-added">+ #define CKK_GOSTR3411           0x00000031UL</span>
<span class="line-added">+ #define CKK_GOST28147           0x00000032UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ </span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKK_VENDOR_DEFINED      0x80000000UL</span>
  
  
  /* CK_CERTIFICATE_TYPE is a value that identifies a certificate
<span class="line-modified">!  * type</span>
<span class="line-modified">!  */</span>
  typedef CK_ULONG          CK_CERTIFICATE_TYPE;
  
<span class="line-added">+ #define CK_CERTIFICATE_CATEGORY_UNSPECIFIED     0UL</span>
<span class="line-added">+ #define CK_CERTIFICATE_CATEGORY_TOKEN_USER      1UL</span>
<span class="line-added">+ #define CK_CERTIFICATE_CATEGORY_AUTHORITY       2UL</span>
<span class="line-added">+ #define CK_CERTIFICATE_CATEGORY_OTHER_ENTITY    3UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CK_SECURITY_DOMAIN_UNSPECIFIED     0UL</span>
<span class="line-added">+ #define CK_SECURITY_DOMAIN_MANUFACTURER    1UL</span>
<span class="line-added">+ #define CK_SECURITY_DOMAIN_OPERATOR        2UL</span>
<span class="line-added">+ #define CK_SECURITY_DOMAIN_THIRD_PARTY     3UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ </span>
  /* The following certificate types are defined: */
<span class="line-modified">! #define CKC_X_509               0x00000000UL</span>
<span class="line-modified">! #define CKC_X_509_ATTR_CERT     0x00000001UL</span>
<span class="line-modified">! #define CKC_WTLS                0x00000002UL</span>
<span class="line-modified">! #define CKC_VENDOR_DEFINED      0x80000000UL</span>
  
  
  /* CK_ATTRIBUTE_TYPE is a value that identifies an attribute
<span class="line-modified">!  * type</span>
<span class="line-modified">!  */</span>
  typedef CK_ULONG          CK_ATTRIBUTE_TYPE;
  
  /* The CKF_ARRAY_ATTRIBUTE flag identifies an attribute which
<span class="line-modified">!  * consists of an array of values.</span>
<span class="line-modified">!  */</span>
<span class="line-added">+ #define CKF_ARRAY_ATTRIBUTE     0x40000000UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ /* The following OTP-related defines relate to the CKA_OTP_FORMAT attribute */</span>
<span class="line-added">+ #define CK_OTP_FORMAT_DECIMAL           0UL</span>
<span class="line-added">+ #define CK_OTP_FORMAT_HEXADECIMAL       1UL</span>
<span class="line-added">+ #define CK_OTP_FORMAT_ALPHANUMERIC      2UL</span>
<span class="line-added">+ #define CK_OTP_FORMAT_BINARY            3UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ /* The following OTP-related defines relate to the CKA_OTP_..._REQUIREMENT</span>
<span class="line-added">+  * attributes</span>
<span class="line-added">+  */</span>
<span class="line-added">+ #define CK_OTP_PARAM_IGNORED            0UL</span>
<span class="line-added">+ #define CK_OTP_PARAM_OPTIONAL           1UL</span>
<span class="line-added">+ #define CK_OTP_PARAM_MANDATORY          2UL</span>
  
  /* The following attribute types are defined: */
<span class="line-modified">! #define CKA_CLASS              0x00000000UL</span>
<span class="line-modified">! #define CKA_TOKEN              0x00000001UL</span>
<span class="line-modified">! #define CKA_PRIVATE            0x00000002UL</span>
<span class="line-modified">! #define CKA_LABEL              0x00000003UL</span>
<span class="line-modified">! #define CKA_APPLICATION        0x00000010UL</span>
<span class="line-modified">! #define CKA_VALUE              0x00000011UL</span>
<span class="line-modified">! #define CKA_OBJECT_ID          0x00000012UL</span>
<span class="line-modified">! #define CKA_CERTIFICATE_TYPE   0x00000080UL</span>
<span class="line-modified">! #define CKA_ISSUER             0x00000081UL</span>
<span class="line-modified">! #define CKA_SERIAL_NUMBER      0x00000082UL</span>
<span class="line-modified">! #define CKA_AC_ISSUER          0x00000083UL</span>
<span class="line-modified">! #define CKA_OWNER              0x00000084UL</span>
<span class="line-modified">! #define CKA_ATTR_TYPES         0x00000085UL</span>
<span class="line-modified">! #define CKA_TRUSTED            0x00000086UL</span>
<span class="line-modified">! #define CKA_CERTIFICATE_CATEGORY        0x00000087UL</span>
<span class="line-modified">! #define CKA_JAVA_MIDP_SECURITY_DOMAIN   0x00000088UL</span>
<span class="line-modified">! #define CKA_URL                         0x00000089UL</span>
<span class="line-modified">! #define CKA_HASH_OF_SUBJECT_PUBLIC_KEY  0x0000008AUL</span>
<span class="line-modified">! #define CKA_HASH_OF_ISSUER_PUBLIC_KEY   0x0000008BUL</span>
<span class="line-modified">! #define CKA_NAME_HASH_ALGORITHM         0x0000008CUL</span>
<span class="line-modified">! #define CKA_CHECK_VALUE                 0x00000090UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKA_KEY_TYPE           0x00000100UL</span>
<span class="line-modified">! #define CKA_SUBJECT            0x00000101UL</span>
<span class="line-modified">! #define CKA_ID                 0x00000102UL</span>
<span class="line-modified">! #define CKA_SENSITIVE          0x00000103UL</span>
<span class="line-modified">! #define CKA_ENCRYPT            0x00000104UL</span>
<span class="line-modified">! #define CKA_DECRYPT            0x00000105UL</span>
<span class="line-modified">! #define CKA_WRAP               0x00000106UL</span>
<span class="line-modified">! #define CKA_UNWRAP             0x00000107UL</span>
<span class="line-modified">! #define CKA_SIGN               0x00000108UL</span>
<span class="line-modified">! #define CKA_SIGN_RECOVER       0x00000109UL</span>
<span class="line-modified">! #define CKA_VERIFY             0x0000010AUL</span>
<span class="line-modified">! #define CKA_VERIFY_RECOVER     0x0000010BUL</span>
<span class="line-modified">! #define CKA_DERIVE             0x0000010CUL</span>
<span class="line-modified">! #define CKA_START_DATE         0x00000110UL</span>
<span class="line-modified">! #define CKA_END_DATE           0x00000111UL</span>
<span class="line-modified">! #define CKA_MODULUS            0x00000120UL</span>
<span class="line-modified">! #define CKA_MODULUS_BITS       0x00000121UL</span>
<span class="line-modified">! #define CKA_PUBLIC_EXPONENT    0x00000122UL</span>
<span class="line-modified">! #define CKA_PRIVATE_EXPONENT   0x00000123UL</span>
<span class="line-modified">! #define CKA_PRIME_1            0x00000124UL</span>
<span class="line-modified">! #define CKA_PRIME_2            0x00000125UL</span>
<span class="line-modified">! #define CKA_EXPONENT_1         0x00000126UL</span>
<span class="line-modified">! #define CKA_EXPONENT_2         0x00000127UL</span>
<span class="line-modified">! #define CKA_COEFFICIENT        0x00000128UL</span>
<span class="line-modified">! #define CKA_PUBLIC_KEY_INFO    0x00000129UL</span>
<span class="line-modified">! #define CKA_PRIME              0x00000130UL</span>
<span class="line-modified">! #define CKA_SUBPRIME           0x00000131UL</span>
<span class="line-modified">! #define CKA_BASE               0x00000132UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKA_PRIME_BITS         0x00000133UL</span>
<span class="line-modified">! #define CKA_SUBPRIME_BITS      0x00000134UL</span>
  #define CKA_SUB_PRIME_BITS     CKA_SUBPRIME_BITS
  
<span class="line-added">+ #define CKA_VALUE_BITS         0x00000160UL</span>
<span class="line-added">+ #define CKA_VALUE_LEN          0x00000161UL</span>
<span class="line-added">+ #define CKA_EXTRACTABLE        0x00000162UL</span>
<span class="line-added">+ #define CKA_LOCAL              0x00000163UL</span>
<span class="line-added">+ #define CKA_NEVER_EXTRACTABLE  0x00000164UL</span>
<span class="line-added">+ #define CKA_ALWAYS_SENSITIVE   0x00000165UL</span>
<span class="line-added">+ #define CKA_KEY_GEN_MECHANISM  0x00000166UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKA_MODIFIABLE         0x00000170UL</span>
<span class="line-added">+ #define CKA_COPYABLE           0x00000171UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKA_DESTROYABLE        0x00000172UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKA_ECDSA_PARAMS       0x00000180UL /* Deprecated */</span>
<span class="line-added">+ #define CKA_EC_PARAMS          0x00000180UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKA_EC_POINT           0x00000181UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKA_SECONDARY_AUTH     0x00000200UL /* Deprecated */</span>
<span class="line-added">+ #define CKA_AUTH_PIN_FLAGS     0x00000201UL /* Deprecated */</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKA_ALWAYS_AUTHENTICATE  0x00000202UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKA_WRAP_WITH_TRUSTED    0x00000210UL</span>
<span class="line-added">+ #define CKA_WRAP_TEMPLATE        (CKF_ARRAY_ATTRIBUTE|0x00000211UL)</span>
<span class="line-added">+ #define CKA_UNWRAP_TEMPLATE      (CKF_ARRAY_ATTRIBUTE|0x00000212UL)</span>
<span class="line-added">+ #define CKA_DERIVE_TEMPLATE      (CKF_ARRAY_ATTRIBUTE|0x00000213UL)</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKA_OTP_FORMAT                0x00000220UL</span>
<span class="line-added">+ #define CKA_OTP_LENGTH                0x00000221UL</span>
<span class="line-added">+ #define CKA_OTP_TIME_INTERVAL         0x00000222UL</span>
<span class="line-added">+ #define CKA_OTP_USER_FRIENDLY_MODE    0x00000223UL</span>
<span class="line-added">+ #define CKA_OTP_CHALLENGE_REQUIREMENT 0x00000224UL</span>
<span class="line-added">+ #define CKA_OTP_TIME_REQUIREMENT      0x00000225UL</span>
<span class="line-added">+ #define CKA_OTP_COUNTER_REQUIREMENT   0x00000226UL</span>
<span class="line-added">+ #define CKA_OTP_PIN_REQUIREMENT       0x00000227UL</span>
<span class="line-added">+ #define CKA_OTP_COUNTER               0x0000022EUL</span>
<span class="line-added">+ #define CKA_OTP_TIME                  0x0000022FUL</span>
<span class="line-added">+ #define CKA_OTP_USER_IDENTIFIER       0x0000022AUL</span>
<span class="line-added">+ #define CKA_OTP_SERVICE_IDENTIFIER    0x0000022BUL</span>
<span class="line-added">+ #define CKA_OTP_SERVICE_LOGO          0x0000022CUL</span>
<span class="line-added">+ #define CKA_OTP_SERVICE_LOGO_TYPE     0x0000022DUL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKA_GOSTR3410_PARAMS            0x00000250UL</span>
<span class="line-added">+ #define CKA_GOSTR3411_PARAMS            0x00000251UL</span>
<span class="line-added">+ #define CKA_GOST28147_PARAMS            0x00000252UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKA_HW_FEATURE_TYPE             0x00000300UL</span>
<span class="line-added">+ #define CKA_RESET_ON_INIT               0x00000301UL</span>
<span class="line-added">+ #define CKA_HAS_RESET                   0x00000302UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKA_PIXEL_X                     0x00000400UL</span>
<span class="line-added">+ #define CKA_PIXEL_Y                     0x00000401UL</span>
<span class="line-added">+ #define CKA_RESOLUTION                  0x00000402UL</span>
<span class="line-added">+ #define CKA_CHAR_ROWS                   0x00000403UL</span>
<span class="line-added">+ #define CKA_CHAR_COLUMNS                0x00000404UL</span>
<span class="line-added">+ #define CKA_COLOR                       0x00000405UL</span>
<span class="line-added">+ #define CKA_BITS_PER_PIXEL              0x00000406UL</span>
<span class="line-added">+ #define CKA_CHAR_SETS                   0x00000480UL</span>
<span class="line-added">+ #define CKA_ENCODING_METHODS            0x00000481UL</span>
<span class="line-added">+ #define CKA_MIME_TYPES                  0x00000482UL</span>
<span class="line-added">+ #define CKA_MECHANISM_TYPE              0x00000500UL</span>
<span class="line-added">+ #define CKA_REQUIRED_CMS_ATTRIBUTES     0x00000501UL</span>
<span class="line-added">+ #define CKA_DEFAULT_CMS_ATTRIBUTES      0x00000502UL</span>
<span class="line-added">+ #define CKA_SUPPORTED_CMS_ATTRIBUTES    0x00000503UL</span>
<span class="line-added">+ #define CKA_ALLOWED_MECHANISMS          (CKF_ARRAY_ATTRIBUTE|0x00000600UL)</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKA_VENDOR_DEFINED              0x80000000UL</span>
  
  /* CK_ATTRIBUTE is a structure that includes the type, length
<span class="line-modified">!  * and value of an attribute</span>
<span class="line-added">+  */</span>
  typedef struct CK_ATTRIBUTE {
    CK_ATTRIBUTE_TYPE type;
    CK_VOID_PTR       pValue;
    CK_ULONG          ulValueLen;  /* in bytes */
  } CK_ATTRIBUTE;
  
  typedef CK_ATTRIBUTE CK_PTR CK_ATTRIBUTE_PTR;
  
  /* CK_DATE is a structure that defines a date */
  typedef struct CK_DATE{
    CK_CHAR       year[4];   /* the year (&quot;1900&quot; - &quot;9999&quot;) */
    CK_CHAR       month[2];  /* the month (&quot;01&quot; - &quot;12&quot;) */
    CK_CHAR       day[2];    /* the day   (&quot;01&quot; - &quot;31&quot;) */
  } CK_DATE;
  
  
  /* CK_MECHANISM_TYPE is a value that identifies a mechanism
<span class="line-modified">!  * type</span>
<span class="line-modified">!  */</span>
  typedef CK_ULONG          CK_MECHANISM_TYPE;
  
  /* the following mechanism types are defined: */
<span class="line-modified">! #define CKM_RSA_PKCS_KEY_PAIR_GEN      0x00000000UL</span>
<span class="line-modified">! #define CKM_RSA_PKCS                   0x00000001UL</span>
<span class="line-modified">! #define CKM_RSA_9796                   0x00000002UL</span>
<span class="line-modified">! #define CKM_RSA_X_509                  0x00000003UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_MD2_RSA_PKCS               0x00000004UL</span>
<span class="line-modified">! #define CKM_MD5_RSA_PKCS               0x00000005UL</span>
<span class="line-modified">! #define CKM_SHA1_RSA_PKCS              0x00000006UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_RIPEMD128_RSA_PKCS         0x00000007UL</span>
<span class="line-modified">! #define CKM_RIPEMD160_RSA_PKCS         0x00000008UL</span>
<span class="line-modified">! #define CKM_RSA_PKCS_OAEP              0x00000009UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_RSA_X9_31_KEY_PAIR_GEN     0x0000000AUL</span>
<span class="line-modified">! #define CKM_RSA_X9_31                  0x0000000BUL</span>
<span class="line-modified">! #define CKM_SHA1_RSA_X9_31             0x0000000CUL</span>
<span class="line-modified">! #define CKM_RSA_PKCS_PSS               0x0000000DUL</span>
<span class="line-modified">! #define CKM_SHA1_RSA_PKCS_PSS          0x0000000EUL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_DSA_KEY_PAIR_GEN           0x00000010UL</span>
<span class="line-modified">! #define CKM_DSA                        0x00000011UL</span>
<span class="line-modified">! #define CKM_DSA_SHA1                   0x00000012UL</span>
<span class="line-modified">! #define CKM_DSA_SHA224                 0x00000013UL</span>
<span class="line-modified">! #define CKM_DSA_SHA256                 0x00000014UL</span>
<span class="line-modified">! #define CKM_DSA_SHA384                 0x00000015UL</span>
<span class="line-modified">! #define CKM_DSA_SHA512                 0x00000016UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_DH_PKCS_KEY_PAIR_GEN       0x00000020UL</span>
<span class="line-modified">! #define CKM_DH_PKCS_DERIVE             0x00000021UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_X9_42_DH_KEY_PAIR_GEN      0x00000030UL</span>
<span class="line-modified">! #define CKM_X9_42_DH_DERIVE            0x00000031UL</span>
<span class="line-modified">! #define CKM_X9_42_DH_HYBRID_DERIVE     0x00000032UL</span>
<span class="line-modified">! #define CKM_X9_42_MQV_DERIVE           0x00000033UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_SHA256_RSA_PKCS            0x00000040UL</span>
<span class="line-modified">! #define CKM_SHA384_RSA_PKCS            0x00000041UL</span>
<span class="line-modified">! #define CKM_SHA512_RSA_PKCS            0x00000042UL</span>
<span class="line-modified">! #define CKM_SHA256_RSA_PKCS_PSS        0x00000043UL</span>
<span class="line-modified">! #define CKM_SHA384_RSA_PKCS_PSS        0x00000044UL</span>
<span class="line-modified">! #define CKM_SHA512_RSA_PKCS_PSS        0x00000045UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_SHA224_RSA_PKCS            0x00000046UL</span>
<span class="line-modified">! #define CKM_SHA224_RSA_PKCS_PSS        0x00000047UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_SHA512_224                 0x00000048UL</span>
<span class="line-modified">! #define CKM_SHA512_224_HMAC            0x00000049UL</span>
<span class="line-modified">! #define CKM_SHA512_224_HMAC_GENERAL    0x0000004AUL</span>
<span class="line-modified">! #define CKM_SHA512_224_KEY_DERIVATION  0x0000004BUL</span>
<span class="line-modified">! #define CKM_SHA512_256                 0x0000004CUL</span>
<span class="line-modified">! #define CKM_SHA512_256_HMAC            0x0000004DUL</span>
<span class="line-modified">! #define CKM_SHA512_256_HMAC_GENERAL    0x0000004EUL</span>
<span class="line-modified">! #define CKM_SHA512_256_KEY_DERIVATION  0x0000004FUL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_SHA512_T                   0x00000050UL</span>
<span class="line-modified">! #define CKM_SHA512_T_HMAC              0x00000051UL</span>
<span class="line-modified">! #define CKM_SHA512_T_HMAC_GENERAL      0x00000052UL</span>
<span class="line-modified">! #define CKM_SHA512_T_KEY_DERIVATION    0x00000053UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_RC2_KEY_GEN                0x00000100UL</span>
<span class="line-modified">! #define CKM_RC2_ECB                    0x00000101UL</span>
<span class="line-modified">! #define CKM_RC2_CBC                    0x00000102UL</span>
<span class="line-modified">! #define CKM_RC2_MAC                    0x00000103UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_RC2_MAC_GENERAL            0x00000104UL</span>
<span class="line-modified">! #define CKM_RC2_CBC_PAD                0x00000105UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_RC4_KEY_GEN                0x00000110UL</span>
<span class="line-modified">! #define CKM_RC4                        0x00000111UL</span>
<span class="line-modified">! #define CKM_DES_KEY_GEN                0x00000120UL</span>
<span class="line-modified">! #define CKM_DES_ECB                    0x00000121UL</span>
<span class="line-modified">! #define CKM_DES_CBC                    0x00000122UL</span>
<span class="line-modified">! #define CKM_DES_MAC                    0x00000123UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_DES_MAC_GENERAL            0x00000124UL</span>
<span class="line-modified">! #define CKM_DES_CBC_PAD                0x00000125UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_DES2_KEY_GEN               0x00000130UL</span>
<span class="line-modified">! #define CKM_DES3_KEY_GEN               0x00000131UL</span>
<span class="line-modified">! #define CKM_DES3_ECB                   0x00000132UL</span>
<span class="line-modified">! #define CKM_DES3_CBC                   0x00000133UL</span>
<span class="line-modified">! #define CKM_DES3_MAC                   0x00000134UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_DES3_MAC_GENERAL           0x00000135UL</span>
<span class="line-modified">! #define CKM_DES3_CBC_PAD               0x00000136UL</span>
<span class="line-modified">! #define CKM_DES3_CMAC_GENERAL          0x00000137UL</span>
<span class="line-modified">! #define CKM_DES3_CMAC                  0x00000138UL</span>
<span class="line-modified">! #define CKM_CDMF_KEY_GEN               0x00000140UL</span>
<span class="line-modified">! #define CKM_CDMF_ECB                   0x00000141UL</span>
<span class="line-modified">! #define CKM_CDMF_CBC                   0x00000142UL</span>
<span class="line-modified">! #define CKM_CDMF_MAC                   0x00000143UL</span>
<span class="line-modified">! #define CKM_CDMF_MAC_GENERAL           0x00000144UL</span>
<span class="line-modified">! #define CKM_CDMF_CBC_PAD               0x00000145UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_DES_OFB64                  0x00000150UL</span>
<span class="line-modified">! #define CKM_DES_OFB8                   0x00000151UL</span>
<span class="line-modified">! #define CKM_DES_CFB64                  0x00000152UL</span>
<span class="line-modified">! #define CKM_DES_CFB8                   0x00000153UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_MD2                        0x00000200UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_MD2_HMAC                   0x00000201UL</span>
<span class="line-modified">! #define CKM_MD2_HMAC_GENERAL           0x00000202UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_MD5                        0x00000210UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_MD5_HMAC                   0x00000211UL</span>
<span class="line-modified">! #define CKM_MD5_HMAC_GENERAL           0x00000212UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_SHA_1                      0x00000220UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_SHA_1_HMAC                 0x00000221UL</span>
<span class="line-modified">! #define CKM_SHA_1_HMAC_GENERAL         0x00000222UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_RIPEMD128                  0x00000230UL</span>
<span class="line-modified">! #define CKM_RIPEMD128_HMAC             0x00000231UL</span>
<span class="line-modified">! #define CKM_RIPEMD128_HMAC_GENERAL     0x00000232UL</span>
<span class="line-modified">! #define CKM_RIPEMD160                  0x00000240UL</span>
<span class="line-modified">! #define CKM_RIPEMD160_HMAC             0x00000241UL</span>
<span class="line-modified">! #define CKM_RIPEMD160_HMAC_GENERAL     0x00000242UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_SHA256                     0x00000250UL</span>
<span class="line-modified">! #define CKM_SHA256_HMAC                0x00000251UL</span>
<span class="line-modified">! #define CKM_SHA256_HMAC_GENERAL        0x00000252UL</span>
<span class="line-modified">! #define CKM_SHA224                     0x00000255UL</span>
<span class="line-modified">! #define CKM_SHA224_HMAC                0x00000256UL</span>
<span class="line-modified">! #define CKM_SHA224_HMAC_GENERAL        0x00000257UL</span>
<span class="line-modified">! #define CKM_SHA384                     0x00000260UL</span>
<span class="line-modified">! #define CKM_SHA384_HMAC                0x00000261UL</span>
<span class="line-modified">! #define CKM_SHA384_HMAC_GENERAL        0x00000262UL</span>
<span class="line-modified">! #define CKM_SHA512                     0x00000270UL</span>
<span class="line-added">+ #define CKM_SHA512_HMAC                0x00000271UL</span>
<span class="line-added">+ #define CKM_SHA512_HMAC_GENERAL        0x00000272UL</span>
<span class="line-added">+ #define CKM_SECURID_KEY_GEN            0x00000280UL</span>
<span class="line-added">+ #define CKM_SECURID                    0x00000282UL</span>
<span class="line-added">+ #define CKM_HOTP_KEY_GEN               0x00000290UL</span>
<span class="line-added">+ #define CKM_HOTP                       0x00000291UL</span>
<span class="line-added">+ #define CKM_ACTI                       0x000002A0UL</span>
<span class="line-added">+ #define CKM_ACTI_KEY_GEN               0x000002A1UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKM_CAST_KEY_GEN               0x00000300UL</span>
<span class="line-added">+ #define CKM_CAST_ECB                   0x00000301UL</span>
<span class="line-added">+ #define CKM_CAST_CBC                   0x00000302UL</span>
<span class="line-added">+ #define CKM_CAST_MAC                   0x00000303UL</span>
<span class="line-added">+ #define CKM_CAST_MAC_GENERAL           0x00000304UL</span>
<span class="line-added">+ #define CKM_CAST_CBC_PAD               0x00000305UL</span>
<span class="line-added">+ #define CKM_CAST3_KEY_GEN              0x00000310UL</span>
<span class="line-added">+ #define CKM_CAST3_ECB                  0x00000311UL</span>
<span class="line-added">+ #define CKM_CAST3_CBC                  0x00000312UL</span>
<span class="line-added">+ #define CKM_CAST3_MAC                  0x00000313UL</span>
<span class="line-added">+ #define CKM_CAST3_MAC_GENERAL          0x00000314UL</span>
<span class="line-added">+ #define CKM_CAST3_CBC_PAD              0x00000315UL</span>
  /* Note that CAST128 and CAST5 are the same algorithm */
<span class="line-modified">! #define CKM_CAST5_KEY_GEN              0x00000320UL</span>
<span class="line-modified">! #define CKM_CAST128_KEY_GEN            0x00000320UL</span>
<span class="line-modified">! #define CKM_CAST5_ECB                  0x00000321UL</span>
<span class="line-modified">! #define CKM_CAST128_ECB                0x00000321UL</span>
<span class="line-modified">! #define CKM_CAST5_CBC                  0x00000322UL /* Deprecated */</span>
<span class="line-modified">! #define CKM_CAST128_CBC                0x00000322UL</span>
<span class="line-modified">! #define CKM_CAST5_MAC                  0x00000323UL /* Deprecated */</span>
<span class="line-modified">! #define CKM_CAST128_MAC                0x00000323UL</span>
<span class="line-modified">! #define CKM_CAST5_MAC_GENERAL          0x00000324UL /* Deprecated */</span>
<span class="line-modified">! #define CKM_CAST128_MAC_GENERAL        0x00000324UL</span>
<span class="line-modified">! #define CKM_CAST5_CBC_PAD              0x00000325UL /* Deprecated */</span>
<span class="line-modified">! #define CKM_CAST128_CBC_PAD            0x00000325UL</span>
<span class="line-modified">! #define CKM_RC5_KEY_GEN                0x00000330UL</span>
<span class="line-modified">! #define CKM_RC5_ECB                    0x00000331UL</span>
<span class="line-modified">! #define CKM_RC5_CBC                    0x00000332UL</span>
<span class="line-modified">! #define CKM_RC5_MAC                    0x00000333UL</span>
<span class="line-modified">! #define CKM_RC5_MAC_GENERAL            0x00000334UL</span>
<span class="line-modified">! #define CKM_RC5_CBC_PAD                0x00000335UL</span>
<span class="line-modified">! #define CKM_IDEA_KEY_GEN               0x00000340UL</span>
<span class="line-modified">! #define CKM_IDEA_ECB                   0x00000341UL</span>
<span class="line-modified">! #define CKM_IDEA_CBC                   0x00000342UL</span>
<span class="line-modified">! #define CKM_IDEA_MAC                   0x00000343UL</span>
<span class="line-modified">! #define CKM_IDEA_MAC_GENERAL           0x00000344UL</span>
<span class="line-modified">! #define CKM_IDEA_CBC_PAD               0x00000345UL</span>
<span class="line-modified">! #define CKM_GENERIC_SECRET_KEY_GEN     0x00000350UL</span>
<span class="line-modified">! #define CKM_CONCATENATE_BASE_AND_KEY   0x00000360UL</span>
<span class="line-modified">! #define CKM_CONCATENATE_BASE_AND_DATA  0x00000362UL</span>
<span class="line-modified">! #define CKM_CONCATENATE_DATA_AND_BASE  0x00000363UL</span>
<span class="line-modified">! #define CKM_XOR_BASE_AND_DATA          0x00000364UL</span>
<span class="line-modified">! #define CKM_EXTRACT_KEY_FROM_KEY       0x00000365UL</span>
<span class="line-modified">! #define CKM_SSL3_PRE_MASTER_KEY_GEN    0x00000370UL</span>
<span class="line-modified">! #define CKM_SSL3_MASTER_KEY_DERIVE     0x00000371UL</span>
<span class="line-modified">! #define CKM_SSL3_KEY_AND_MAC_DERIVE    0x00000372UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_SSL3_MASTER_KEY_DERIVE_DH  0x00000373UL</span>
<span class="line-modified">! #define CKM_TLS_PRE_MASTER_KEY_GEN     0x00000374UL</span>
<span class="line-modified">! #define CKM_TLS_MASTER_KEY_DERIVE      0x00000375UL</span>
<span class="line-modified">! #define CKM_TLS_KEY_AND_MAC_DERIVE     0x00000376UL</span>
<span class="line-modified">! #define CKM_TLS_MASTER_KEY_DERIVE_DH   0x00000377UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_TLS_PRF                    0x00000378UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_SSL3_MD5_MAC               0x00000380UL</span>
<span class="line-modified">! #define CKM_SSL3_SHA1_MAC              0x00000381UL</span>
<span class="line-modified">! #define CKM_MD5_KEY_DERIVATION         0x00000390UL</span>
<span class="line-modified">! #define CKM_MD2_KEY_DERIVATION         0x00000391UL</span>
<span class="line-modified">! #define CKM_SHA1_KEY_DERIVATION        0x00000392UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_SHA256_KEY_DERIVATION      0x00000393UL</span>
<span class="line-modified">! #define CKM_SHA384_KEY_DERIVATION      0x00000394UL</span>
<span class="line-modified">! #define CKM_SHA512_KEY_DERIVATION      0x00000395UL</span>
<span class="line-modified">! #define CKM_SHA224_KEY_DERIVATION      0x00000396UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_PBE_MD2_DES_CBC            0x000003A0UL</span>
<span class="line-modified">! #define CKM_PBE_MD5_DES_CBC            0x000003A1UL</span>
<span class="line-modified">! #define CKM_PBE_MD5_CAST_CBC           0x000003A2UL</span>
<span class="line-modified">! #define CKM_PBE_MD5_CAST3_CBC          0x000003A3UL</span>
<span class="line-modified">! #define CKM_PBE_MD5_CAST5_CBC          0x000003A4UL /* Deprecated */</span>
<span class="line-modified">! #define CKM_PBE_MD5_CAST128_CBC        0x000003A4UL</span>
<span class="line-modified">! #define CKM_PBE_SHA1_CAST5_CBC         0x000003A5UL /* Deprecated */</span>
<span class="line-modified">! #define CKM_PBE_SHA1_CAST128_CBC       0x000003A5UL</span>
<span class="line-modified">! #define CKM_PBE_SHA1_RC4_128           0x000003A6UL</span>
<span class="line-modified">! #define CKM_PBE_SHA1_RC4_40            0x000003A7UL</span>
<span class="line-modified">! #define CKM_PBE_SHA1_DES3_EDE_CBC      0x000003A8UL</span>
<span class="line-modified">! #define CKM_PBE_SHA1_DES2_EDE_CBC      0x000003A9UL</span>
<span class="line-modified">! #define CKM_PBE_SHA1_RC2_128_CBC       0x000003AAUL</span>
<span class="line-modified">! #define CKM_PBE_SHA1_RC2_40_CBC        0x000003ABUL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_PKCS5_PBKD2                0x000003B0UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_PBA_SHA1_WITH_SHA1_HMAC    0x000003C0UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_WTLS_PRE_MASTER_KEY_GEN         0x000003D0UL</span>
<span class="line-modified">! #define CKM_WTLS_MASTER_KEY_DERIVE          0x000003D1UL</span>
<span class="line-modified">! #define CKM_WTLS_MASTER_KEY_DERIVE_DH_ECC   0x000003D2UL</span>
<span class="line-modified">! #define CKM_WTLS_PRF                        0x000003D3UL</span>
<span class="line-modified">! #define CKM_WTLS_SERVER_KEY_AND_MAC_DERIVE  0x000003D4UL</span>
<span class="line-modified">! #define CKM_WTLS_CLIENT_KEY_AND_MAC_DERIVE  0x000003D5UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_TLS10_MAC_SERVER                0x000003D6UL</span>
<span class="line-modified">! #define CKM_TLS10_MAC_CLIENT                0x000003D7UL</span>
<span class="line-modified">! #define CKM_TLS12_MAC                       0x000003D8UL</span>
<span class="line-modified">! #define CKM_TLS12_KDF                       0x000003D9UL</span>
<span class="line-modified">! #define CKM_TLS12_MASTER_KEY_DERIVE         0x000003E0UL</span>
<span class="line-modified">! #define CKM_TLS12_KEY_AND_MAC_DERIVE        0x000003E1UL</span>
<span class="line-modified">! #define CKM_TLS12_MASTER_KEY_DERIVE_DH      0x000003E2UL</span>
<span class="line-modified">! #define CKM_TLS12_KEY_SAFE_DERIVE           0x000003E3UL</span>
<span class="line-modified">! #define CKM_TLS_MAC                         0x000003E4UL</span>
<span class="line-modified">! #define CKM_TLS_KDF                         0x000003E5UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_KEY_WRAP_LYNKS             0x00000400UL</span>
<span class="line-modified">! #define CKM_KEY_WRAP_SET_OAEP          0x00000401UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_CMS_SIG                    0x00000500UL</span>
<span class="line-modified">! #define CKM_KIP_DERIVE                 0x00000510UL</span>
<span class="line-modified">! #define CKM_KIP_WRAP                   0x00000511UL</span>
<span class="line-modified">! #define CKM_KIP_MAC                    0x00000512UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_CAMELLIA_KEY_GEN           0x00000550UL</span>
<span class="line-modified">! #define CKM_CAMELLIA_ECB               0x00000551UL</span>
<span class="line-modified">! #define CKM_CAMELLIA_CBC               0x00000552UL</span>
<span class="line-modified">! #define CKM_CAMELLIA_MAC               0x00000553UL</span>
<span class="line-modified">! #define CKM_CAMELLIA_MAC_GENERAL       0x00000554UL</span>
<span class="line-modified">! #define CKM_CAMELLIA_CBC_PAD           0x00000555UL</span>
<span class="line-modified">! #define CKM_CAMELLIA_ECB_ENCRYPT_DATA  0x00000556UL</span>
<span class="line-modified">! #define CKM_CAMELLIA_CBC_ENCRYPT_DATA  0x00000557UL</span>
<span class="line-modified">! #define CKM_CAMELLIA_CTR               0x00000558UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_ARIA_KEY_GEN               0x00000560UL</span>
<span class="line-modified">! #define CKM_ARIA_ECB                   0x00000561UL</span>
<span class="line-modified">! #define CKM_ARIA_CBC                   0x00000562UL</span>
<span class="line-modified">! #define CKM_ARIA_MAC                   0x00000563UL</span>
<span class="line-modified">! #define CKM_ARIA_MAC_GENERAL           0x00000564UL</span>
<span class="line-modified">! #define CKM_ARIA_CBC_PAD               0x00000565UL</span>
<span class="line-modified">! #define CKM_ARIA_ECB_ENCRYPT_DATA      0x00000566UL</span>
<span class="line-modified">! #define CKM_ARIA_CBC_ENCRYPT_DATA      0x00000567UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_SEED_KEY_GEN               0x00000650UL</span>
<span class="line-modified">! #define CKM_SEED_ECB                   0x00000651UL</span>
<span class="line-modified">! #define CKM_SEED_CBC                   0x00000652UL</span>
<span class="line-modified">! #define CKM_SEED_MAC                   0x00000653UL</span>
<span class="line-modified">! #define CKM_SEED_MAC_GENERAL           0x00000654UL</span>
<span class="line-modified">! #define CKM_SEED_CBC_PAD               0x00000655UL</span>
<span class="line-modified">! #define CKM_SEED_ECB_ENCRYPT_DATA      0x00000656UL</span>
<span class="line-modified">! #define CKM_SEED_CBC_ENCRYPT_DATA      0x00000657UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_SKIPJACK_KEY_GEN           0x00001000UL</span>
<span class="line-modified">! #define CKM_SKIPJACK_ECB64             0x00001001UL</span>
<span class="line-modified">! #define CKM_SKIPJACK_CBC64             0x00001002UL</span>
<span class="line-modified">! #define CKM_SKIPJACK_OFB64             0x00001003UL</span>
<span class="line-modified">! #define CKM_SKIPJACK_CFB64             0x00001004UL</span>
<span class="line-modified">! #define CKM_SKIPJACK_CFB32             0x00001005UL</span>
<span class="line-modified">! #define CKM_SKIPJACK_CFB16             0x00001006UL</span>
<span class="line-modified">! #define CKM_SKIPJACK_CFB8              0x00001007UL</span>
<span class="line-modified">! #define CKM_SKIPJACK_WRAP              0x00001008UL</span>
<span class="line-modified">! #define CKM_SKIPJACK_PRIVATE_WRAP      0x00001009UL</span>
<span class="line-modified">! #define CKM_SKIPJACK_RELAYX            0x0000100aUL</span>
<span class="line-modified">! #define CKM_KEA_KEY_PAIR_GEN           0x00001010UL</span>
<span class="line-modified">! #define CKM_KEA_KEY_DERIVE             0x00001011UL</span>
<span class="line-modified">! #define CKM_KEA_DERIVE                 0x00001012UL</span>
<span class="line-modified">! #define CKM_FORTEZZA_TIMESTAMP         0x00001020UL</span>
<span class="line-modified">! #define CKM_BATON_KEY_GEN              0x00001030UL</span>
<span class="line-modified">! #define CKM_BATON_ECB128               0x00001031UL</span>
<span class="line-modified">! #define CKM_BATON_ECB96                0x00001032UL</span>
<span class="line-modified">! #define CKM_BATON_CBC128               0x00001033UL</span>
<span class="line-modified">! #define CKM_BATON_COUNTER              0x00001034UL</span>
<span class="line-modified">! #define CKM_BATON_SHUFFLE              0x00001035UL</span>
<span class="line-modified">! #define CKM_BATON_WRAP                 0x00001036UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_ECDSA_KEY_PAIR_GEN         0x00001040UL /* Deprecated */</span>
<span class="line-modified">! #define CKM_EC_KEY_PAIR_GEN            0x00001040UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_ECDSA                      0x00001041UL</span>
<span class="line-modified">! #define CKM_ECDSA_SHA1                 0x00001042UL</span>
<span class="line-modified">! #define CKM_ECDSA_SHA224               0x00001043UL</span>
<span class="line-modified">! #define CKM_ECDSA_SHA256               0x00001044UL</span>
<span class="line-modified">! #define CKM_ECDSA_SHA384               0x00001045UL</span>
<span class="line-modified">! #define CKM_ECDSA_SHA512               0x00001046UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_ECDH1_DERIVE               0x00001050UL</span>
<span class="line-modified">! #define CKM_ECDH1_COFACTOR_DERIVE      0x00001051UL</span>
<span class="line-modified">! #define CKM_ECMQV_DERIVE               0x00001052UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_ECDH_AES_KEY_WRAP          0x00001053UL</span>
<span class="line-modified">! #define CKM_RSA_AES_KEY_WRAP           0x00001054UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_JUNIPER_KEY_GEN            0x00001060UL</span>
<span class="line-modified">! #define CKM_JUNIPER_ECB128             0x00001061UL</span>
<span class="line-modified">! #define CKM_JUNIPER_CBC128             0x00001062UL</span>
<span class="line-modified">! #define CKM_JUNIPER_COUNTER            0x00001063UL</span>
<span class="line-modified">! #define CKM_JUNIPER_SHUFFLE            0x00001064UL</span>
<span class="line-modified">! #define CKM_JUNIPER_WRAP               0x00001065UL</span>
<span class="line-modified">! #define CKM_FASTHASH                   0x00001070UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKM_AES_KEY_GEN                0x00001080UL</span>
<span class="line-modified">! #define CKM_AES_ECB                    0x00001081UL</span>
<span class="line-modified">! #define CKM_AES_CBC                    0x00001082UL</span>
<span class="line-modified">! #define CKM_AES_MAC                    0x00001083UL</span>
<span class="line-modified">! #define CKM_AES_MAC_GENERAL            0x00001084UL</span>
<span class="line-modified">! #define CKM_AES_CBC_PAD                0x00001085UL</span>
<span class="line-modified">! #define CKM_AES_CTR                    0x00001086UL</span>
<span class="line-modified">! #define CKM_AES_GCM                    0x00001087UL</span>
<span class="line-modified">! #define CKM_AES_CCM                    0x00001088UL</span>
<span class="line-modified">! #define CKM_AES_CTS                    0x00001089UL</span>
<span class="line-modified">! #define CKM_AES_CMAC                   0x0000108AUL</span>
<span class="line-added">+ #define CKM_AES_CMAC_GENERAL           0x0000108BUL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKM_AES_XCBC_MAC               0x0000108CUL</span>
<span class="line-added">+ #define CKM_AES_XCBC_MAC_96            0x0000108DUL</span>
<span class="line-added">+ #define CKM_AES_GMAC                   0x0000108EUL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKM_BLOWFISH_KEY_GEN           0x00001090UL</span>
<span class="line-added">+ #define CKM_BLOWFISH_CBC               0x00001091UL</span>
<span class="line-added">+ #define CKM_TWOFISH_KEY_GEN            0x00001092UL</span>
<span class="line-added">+ #define CKM_TWOFISH_CBC                0x00001093UL</span>
<span class="line-added">+ #define CKM_BLOWFISH_CBC_PAD           0x00001094UL</span>
<span class="line-added">+ #define CKM_TWOFISH_CBC_PAD            0x00001095UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKM_DES_ECB_ENCRYPT_DATA       0x00001100UL</span>
<span class="line-added">+ #define CKM_DES_CBC_ENCRYPT_DATA       0x00001101UL</span>
<span class="line-added">+ #define CKM_DES3_ECB_ENCRYPT_DATA      0x00001102UL</span>
<span class="line-added">+ #define CKM_DES3_CBC_ENCRYPT_DATA      0x00001103UL</span>
<span class="line-added">+ #define CKM_AES_ECB_ENCRYPT_DATA       0x00001104UL</span>
<span class="line-added">+ #define CKM_AES_CBC_ENCRYPT_DATA       0x00001105UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKM_GOSTR3410_KEY_PAIR_GEN     0x00001200UL</span>
<span class="line-added">+ #define CKM_GOSTR3410                  0x00001201UL</span>
<span class="line-added">+ #define CKM_GOSTR3410_WITH_GOSTR3411   0x00001202UL</span>
<span class="line-added">+ #define CKM_GOSTR3410_KEY_WRAP         0x00001203UL</span>
<span class="line-added">+ #define CKM_GOSTR3410_DERIVE           0x00001204UL</span>
<span class="line-added">+ #define CKM_GOSTR3411                  0x00001210UL</span>
<span class="line-added">+ #define CKM_GOSTR3411_HMAC             0x00001211UL</span>
<span class="line-added">+ #define CKM_GOST28147_KEY_GEN          0x00001220UL</span>
<span class="line-added">+ #define CKM_GOST28147_ECB              0x00001221UL</span>
<span class="line-added">+ #define CKM_GOST28147                  0x00001222UL</span>
<span class="line-added">+ #define CKM_GOST28147_MAC              0x00001223UL</span>
<span class="line-added">+ #define CKM_GOST28147_KEY_WRAP         0x00001224UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKM_DSA_PARAMETER_GEN          0x00002000UL</span>
<span class="line-added">+ #define CKM_DH_PKCS_PARAMETER_GEN      0x00002001UL</span>
<span class="line-added">+ #define CKM_X9_42_DH_PARAMETER_GEN     0x00002002UL</span>
<span class="line-added">+ #define CKM_DSA_PROBABLISTIC_PARAMETER_GEN    0x00002003UL</span>
<span class="line-added">+ #define CKM_DSA_SHAWE_TAYLOR_PARAMETER_GEN    0x00002004UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKM_AES_OFB                    0x00002104UL</span>
<span class="line-added">+ #define CKM_AES_CFB64                  0x00002105UL</span>
<span class="line-added">+ #define CKM_AES_CFB8                   0x00002106UL</span>
<span class="line-added">+ #define CKM_AES_CFB128                 0x00002107UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKM_AES_CFB1                   0x00002108UL</span>
<span class="line-added">+ #define CKM_AES_KEY_WRAP               0x00002109UL     /* WAS: 0x00001090 */</span>
<span class="line-added">+ #define CKM_AES_KEY_WRAP_PAD           0x0000210AUL     /* WAS: 0x00001091 */</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKM_RSA_PKCS_TPM_1_1           0x00004001UL</span>
<span class="line-added">+ #define CKM_RSA_PKCS_OAEP_TPM_1_1      0x00004002UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKM_VENDOR_DEFINED             0x80000000UL</span>
  
  typedef CK_MECHANISM_TYPE CK_PTR CK_MECHANISM_TYPE_PTR;
  
  
  /* CK_MECHANISM is a structure that specifies a particular
<span class="line-modified">!  * mechanism</span>
<span class="line-added">+  */</span>
  typedef struct CK_MECHANISM {
    CK_MECHANISM_TYPE mechanism;
    CK_VOID_PTR       pParameter;
    CK_ULONG          ulParameterLen;  /* in bytes */
  } CK_MECHANISM;
  
  typedef CK_MECHANISM CK_PTR CK_MECHANISM_PTR;
  
  
  /* CK_MECHANISM_INFO provides information about a particular
<span class="line-modified">!  * mechanism</span>
<span class="line-added">+  */</span>
  typedef struct CK_MECHANISM_INFO {
      CK_ULONG    ulMinKeySize;
      CK_ULONG    ulMaxKeySize;
      CK_FLAGS    flags;
  } CK_MECHANISM_INFO;
  
  /* The flags are defined as follows:
<span class="line-modified">!  *      Bit Flag               Mask          Meaning */</span>
<span class="line-modified">! #define CKF_HW                 0x00000001UL  /* performed by HW */</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* Specify whether or not a mechanism can be used for a particular task */</span>
<span class="line-modified">! #define CKF_ENCRYPT            0x00000100UL</span>
<span class="line-modified">! #define CKF_DECRYPT            0x00000200UL</span>
<span class="line-modified">! #define CKF_DIGEST             0x00000400UL</span>
<span class="line-modified">! #define CKF_SIGN               0x00000800UL</span>
<span class="line-modified">! #define CKF_SIGN_RECOVER       0x00001000UL</span>
<span class="line-modified">! #define CKF_VERIFY             0x00002000UL</span>
<span class="line-modified">! #define CKF_VERIFY_RECOVER     0x00004000UL</span>
<span class="line-modified">! #define CKF_GENERATE           0x00008000UL</span>
<span class="line-modified">! #define CKF_GENERATE_KEY_PAIR  0x00010000UL</span>
<span class="line-modified">! #define CKF_WRAP               0x00020000UL</span>
<span class="line-modified">! #define CKF_UNWRAP             0x00040000UL</span>
<span class="line-modified">! #define CKF_DERIVE             0x00080000UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* Describe a token&#39;s EC capabilities not available in mechanism</span>
<span class="line-modified">!  * information.</span>
<span class="line-modified">!  */</span>
<span class="line-modified">! #define CKF_EC_F_P             0x00100000UL</span>
<span class="line-modified">! #define CKF_EC_F_2M            0x00200000UL</span>
<span class="line-modified">! #define CKF_EC_ECPARAMETERS    0x00400000UL</span>
<span class="line-modified">! #define CKF_EC_NAMEDCURVE      0x00800000UL</span>
<span class="line-modified">! #define CKF_EC_UNCOMPRESS      0x01000000UL</span>
<span class="line-modified">! #define CKF_EC_COMPRESS        0x02000000UL</span>
  
<span class="line-modified">! #define CKF_EXTENSION          0x80000000UL</span>
  
<span class="line-added">+ typedef CK_MECHANISM_INFO CK_PTR CK_MECHANISM_INFO_PTR;</span>
  
  /* CK_RV is a value that identifies the return value of a
<span class="line-modified">!  * Cryptoki function</span>
<span class="line-modified">!  */</span>
  typedef CK_ULONG          CK_RV;
  
<span class="line-modified">! #define CKR_OK                                0x00000000UL</span>
<span class="line-modified">! #define CKR_CANCEL                            0x00000001UL</span>
<span class="line-modified">! #define CKR_HOST_MEMORY                       0x00000002UL</span>
<span class="line-modified">! #define CKR_SLOT_ID_INVALID                   0x00000003UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_GENERAL_ERROR                     0x00000005UL</span>
<span class="line-modified">! #define CKR_FUNCTION_FAILED                   0x00000006UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_ARGUMENTS_BAD                     0x00000007UL</span>
<span class="line-modified">! #define CKR_NO_EVENT                          0x00000008UL</span>
<span class="line-modified">! #define CKR_NEED_TO_CREATE_THREADS            0x00000009UL</span>
<span class="line-modified">! #define CKR_CANT_LOCK                         0x0000000AUL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_ATTRIBUTE_READ_ONLY               0x00000010UL</span>
<span class="line-modified">! #define CKR_ATTRIBUTE_SENSITIVE               0x00000011UL</span>
<span class="line-modified">! #define CKR_ATTRIBUTE_TYPE_INVALID            0x00000012UL</span>
<span class="line-modified">! #define CKR_ATTRIBUTE_VALUE_INVALID           0x00000013UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_ACTION_PROHIBITED                 0x0000001BUL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_DATA_INVALID                      0x00000020UL</span>
<span class="line-modified">! #define CKR_DATA_LEN_RANGE                    0x00000021UL</span>
<span class="line-modified">! #define CKR_DEVICE_ERROR                      0x00000030UL</span>
<span class="line-modified">! #define CKR_DEVICE_MEMORY                     0x00000031UL</span>
<span class="line-modified">! #define CKR_DEVICE_REMOVED                    0x00000032UL</span>
<span class="line-modified">! #define CKR_ENCRYPTED_DATA_INVALID            0x00000040UL</span>
<span class="line-modified">! #define CKR_ENCRYPTED_DATA_LEN_RANGE          0x00000041UL</span>
<span class="line-modified">! #define CKR_FUNCTION_CANCELED                 0x00000050UL</span>
<span class="line-modified">! #define CKR_FUNCTION_NOT_PARALLEL             0x00000051UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_FUNCTION_NOT_SUPPORTED            0x00000054UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_KEY_HANDLE_INVALID                0x00000060UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_KEY_SIZE_RANGE                    0x00000062UL</span>
<span class="line-modified">! #define CKR_KEY_TYPE_INCONSISTENT             0x00000063UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_KEY_NOT_NEEDED                    0x00000064UL</span>
<span class="line-modified">! #define CKR_KEY_CHANGED                       0x00000065UL</span>
<span class="line-modified">! #define CKR_KEY_NEEDED                        0x00000066UL</span>
<span class="line-modified">! #define CKR_KEY_INDIGESTIBLE                  0x00000067UL</span>
<span class="line-modified">! #define CKR_KEY_FUNCTION_NOT_PERMITTED        0x00000068UL</span>
<span class="line-modified">! #define CKR_KEY_NOT_WRAPPABLE                 0x00000069UL</span>
<span class="line-modified">! #define CKR_KEY_UNEXTRACTABLE                 0x0000006AUL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_MECHANISM_INVALID                 0x00000070UL</span>
<span class="line-modified">! #define CKR_MECHANISM_PARAM_INVALID           0x00000071UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_OBJECT_HANDLE_INVALID             0x00000082UL</span>
<span class="line-modified">! #define CKR_OPERATION_ACTIVE                  0x00000090UL</span>
<span class="line-modified">! #define CKR_OPERATION_NOT_INITIALIZED         0x00000091UL</span>
<span class="line-modified">! #define CKR_PIN_INCORRECT                     0x000000A0UL</span>
<span class="line-modified">! #define CKR_PIN_INVALID                       0x000000A1UL</span>
<span class="line-modified">! #define CKR_PIN_LEN_RANGE                     0x000000A2UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_PIN_EXPIRED                       0x000000A3UL</span>
<span class="line-modified">! #define CKR_PIN_LOCKED                        0x000000A4UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_SESSION_CLOSED                    0x000000B0UL</span>
<span class="line-modified">! #define CKR_SESSION_COUNT                     0x000000B1UL</span>
<span class="line-modified">! #define CKR_SESSION_HANDLE_INVALID            0x000000B3UL</span>
<span class="line-modified">! #define CKR_SESSION_PARALLEL_NOT_SUPPORTED    0x000000B4UL</span>
<span class="line-modified">! #define CKR_SESSION_READ_ONLY                 0x000000B5UL</span>
<span class="line-modified">! #define CKR_SESSION_EXISTS                    0x000000B6UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_SESSION_READ_ONLY_EXISTS          0x000000B7UL</span>
<span class="line-modified">! #define CKR_SESSION_READ_WRITE_SO_EXISTS      0x000000B8UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_SIGNATURE_INVALID                 0x000000C0UL</span>
<span class="line-modified">! #define CKR_SIGNATURE_LEN_RANGE               0x000000C1UL</span>
<span class="line-modified">! #define CKR_TEMPLATE_INCOMPLETE               0x000000D0UL</span>
<span class="line-modified">! #define CKR_TEMPLATE_INCONSISTENT             0x000000D1UL</span>
<span class="line-modified">! #define CKR_TOKEN_NOT_PRESENT                 0x000000E0UL</span>
<span class="line-modified">! #define CKR_TOKEN_NOT_RECOGNIZED              0x000000E1UL</span>
<span class="line-modified">! #define CKR_TOKEN_WRITE_PROTECTED             0x000000E2UL</span>
<span class="line-modified">! #define CKR_UNWRAPPING_KEY_HANDLE_INVALID     0x000000F0UL</span>
<span class="line-modified">! #define CKR_UNWRAPPING_KEY_SIZE_RANGE         0x000000F1UL</span>
<span class="line-modified">! #define CKR_UNWRAPPING_KEY_TYPE_INCONSISTENT  0x000000F2UL</span>
<span class="line-modified">! #define CKR_USER_ALREADY_LOGGED_IN            0x00000100UL</span>
<span class="line-modified">! #define CKR_USER_NOT_LOGGED_IN                0x00000101UL</span>
<span class="line-modified">! #define CKR_USER_PIN_NOT_INITIALIZED          0x00000102UL</span>
<span class="line-modified">! #define CKR_USER_TYPE_INVALID                 0x00000103UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_USER_ANOTHER_ALREADY_LOGGED_IN    0x00000104UL</span>
<span class="line-modified">! #define CKR_USER_TOO_MANY_TYPES               0x00000105UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_WRAPPED_KEY_INVALID               0x00000110UL</span>
<span class="line-modified">! #define CKR_WRAPPED_KEY_LEN_RANGE             0x00000112UL</span>
<span class="line-modified">! #define CKR_WRAPPING_KEY_HANDLE_INVALID       0x00000113UL</span>
<span class="line-modified">! #define CKR_WRAPPING_KEY_SIZE_RANGE           0x00000114UL</span>
<span class="line-modified">! #define CKR_WRAPPING_KEY_TYPE_INCONSISTENT    0x00000115UL</span>
<span class="line-modified">! #define CKR_RANDOM_SEED_NOT_SUPPORTED         0x00000120UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_RANDOM_NO_RNG                     0x00000121UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_DOMAIN_PARAMS_INVALID             0x00000130UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_CURVE_NOT_SUPPORTED               0x00000140UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_BUFFER_TOO_SMALL                  0x00000150UL</span>
<span class="line-modified">! #define CKR_SAVED_STATE_INVALID               0x00000160UL</span>
<span class="line-modified">! #define CKR_INFORMATION_SENSITIVE             0x00000170UL</span>
<span class="line-modified">! #define CKR_STATE_UNSAVEABLE                  0x00000180UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_CRYPTOKI_NOT_INITIALIZED          0x00000190UL</span>
<span class="line-modified">! #define CKR_CRYPTOKI_ALREADY_INITIALIZED      0x00000191UL</span>
<span class="line-modified">! #define CKR_MUTEX_BAD                         0x000001A0UL</span>
<span class="line-modified">! #define CKR_MUTEX_NOT_LOCKED                  0x000001A1UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_NEW_PIN_MODE                      0x000001B0UL</span>
<span class="line-modified">! #define CKR_NEXT_OTP                          0x000001B1UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_EXCEEDED_MAX_ITERATIONS           0x000001B5UL</span>
<span class="line-modified">! #define CKR_FIPS_SELF_TEST_FAILED             0x000001B6UL</span>
<span class="line-modified">! #define CKR_LIBRARY_LOAD_FAILED               0x000001B7UL</span>
<span class="line-modified">! #define CKR_PIN_TOO_WEAK                      0x000001B8UL</span>
<span class="line-modified">! #define CKR_PUBLIC_KEY_INVALID                0x000001B9UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_FUNCTION_REJECTED                 0x00000200UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! #define CKR_VENDOR_DEFINED                    0x80000000UL</span>
  
  
  /* CK_NOTIFY is an application callback that processes events */
  typedef CK_CALLBACK_FUNCTION(CK_RV, CK_NOTIFY)(
    CK_SESSION_HANDLE hSession,     /* the session&#39;s handle */
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1106,28 ***</span>
  );
  
  
  /* CK_FUNCTION_LIST is a structure holding a Cryptoki spec
   * version and pointers of appropriate types to all the
<span class="line-modified">!  * Cryptoki functions */</span>
<span class="line-modified">! /* CK_FUNCTION_LIST is new for v2.0 */</span>
  typedef struct CK_FUNCTION_LIST CK_FUNCTION_LIST;
  
  typedef CK_FUNCTION_LIST CK_PTR CK_FUNCTION_LIST_PTR;
  
  typedef CK_FUNCTION_LIST_PTR CK_PTR CK_FUNCTION_LIST_PTR_PTR;
  
  
  /* CK_CREATEMUTEX is an application callback for creating a
<span class="line-modified">!  * mutex object */</span>
  typedef CK_CALLBACK_FUNCTION(CK_RV, CK_CREATEMUTEX)(
    CK_VOID_PTR_PTR ppMutex  /* location to receive ptr to mutex */
  );
  
  
  /* CK_DESTROYMUTEX is an application callback for destroying a
<span class="line-modified">!  * mutex object */</span>
  typedef CK_CALLBACK_FUNCTION(CK_RV, CK_DESTROYMUTEX)(
    CK_VOID_PTR pMutex  /* pointer to mutex */
  );
  
  
<span class="line-new-header">--- 1167,30 ---</span>
  );
  
  
  /* CK_FUNCTION_LIST is a structure holding a Cryptoki spec
   * version and pointers of appropriate types to all the
<span class="line-modified">!  * Cryptoki functions</span>
<span class="line-modified">!  */</span>
  typedef struct CK_FUNCTION_LIST CK_FUNCTION_LIST;
  
  typedef CK_FUNCTION_LIST CK_PTR CK_FUNCTION_LIST_PTR;
  
  typedef CK_FUNCTION_LIST_PTR CK_PTR CK_FUNCTION_LIST_PTR_PTR;
  
  
  /* CK_CREATEMUTEX is an application callback for creating a
<span class="line-modified">!  * mutex object</span>
<span class="line-added">+  */</span>
  typedef CK_CALLBACK_FUNCTION(CK_RV, CK_CREATEMUTEX)(
    CK_VOID_PTR_PTR ppMutex  /* location to receive ptr to mutex */
  );
  
  
  /* CK_DESTROYMUTEX is an application callback for destroying a
<span class="line-modified">!  * mutex object</span>
<span class="line-added">+  */</span>
  typedef CK_CALLBACK_FUNCTION(CK_RV, CK_DESTROYMUTEX)(
    CK_VOID_PTR pMutex  /* pointer to mutex */
  );
  
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1136,18 ***</span>
    CK_VOID_PTR pMutex  /* pointer to mutex */
  );
  
  
  /* CK_UNLOCKMUTEX is an application callback for unlocking a
<span class="line-modified">!  * mutex */</span>
  typedef CK_CALLBACK_FUNCTION(CK_RV, CK_UNLOCKMUTEX)(
    CK_VOID_PTR pMutex  /* pointer to mutex */
  );
  
  
  /* CK_C_INITIALIZE_ARGS provides the optional arguments to
<span class="line-modified">!  * C_Initialize */</span>
  typedef struct CK_C_INITIALIZE_ARGS {
    CK_CREATEMUTEX CreateMutex;
    CK_DESTROYMUTEX DestroyMutex;
    CK_LOCKMUTEX LockMutex;
    CK_UNLOCKMUTEX UnlockMutex;
<span class="line-new-header">--- 1199,20 ---</span>
    CK_VOID_PTR pMutex  /* pointer to mutex */
  );
  
  
  /* CK_UNLOCKMUTEX is an application callback for unlocking a
<span class="line-modified">!  * mutex</span>
<span class="line-added">+  */</span>
  typedef CK_CALLBACK_FUNCTION(CK_RV, CK_UNLOCKMUTEX)(
    CK_VOID_PTR pMutex  /* pointer to mutex */
  );
  
  
  /* CK_C_INITIALIZE_ARGS provides the optional arguments to
<span class="line-modified">!  * C_Initialize</span>
<span class="line-added">+  */</span>
  typedef struct CK_C_INITIALIZE_ARGS {
    CK_CREATEMUTEX CreateMutex;
    CK_DESTROYMUTEX DestroyMutex;
    CK_LOCKMUTEX LockMutex;
    CK_UNLOCKMUTEX UnlockMutex;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1156,82 ***</span>
  } CK_C_INITIALIZE_ARGS;
  
  /* flags: bit flags that provide capabilities of the slot
   *      Bit Flag                           Mask       Meaning
   */
<span class="line-modified">! #define CKF_LIBRARY_CANT_CREATE_OS_THREADS 0x00000001</span>
<span class="line-modified">! #define CKF_OS_LOCKING_OK                  0x00000002</span>
  
  typedef CK_C_INITIALIZE_ARGS CK_PTR CK_C_INITIALIZE_ARGS_PTR;
  
  
  /* additional flags for parameters to functions */
  
  /* CKF_DONT_BLOCK is for the function C_WaitForSlotEvent */
  #define CKF_DONT_BLOCK     1
  
<span class="line-modified">! /* CK_RSA_PKCS_OAEP_MGF_TYPE is new for v2.10.</span>
<span class="line-removed">-  * CK_RSA_PKCS_OAEP_MGF_TYPE  is used to indicate the Message</span>
   * Generation Function (MGF) applied to a message block when
   * formatting a message block for the PKCS #1 OAEP encryption
<span class="line-modified">!  * scheme. */</span>
  typedef CK_ULONG CK_RSA_PKCS_MGF_TYPE;
  
  typedef CK_RSA_PKCS_MGF_TYPE CK_PTR CK_RSA_PKCS_MGF_TYPE_PTR;
  
  /* The following MGFs are defined */
<span class="line-modified">! /* CKG_MGF1_SHA256, CKG_MGF1_SHA384, and CKG_MGF1_SHA512</span>
<span class="line-modified">!  * are new for v2.20 */</span>
<span class="line-modified">! #define CKG_MGF1_SHA1         0x00000001</span>
<span class="line-modified">! #define CKG_MGF1_SHA256       0x00000002</span>
<span class="line-modified">! #define CKG_MGF1_SHA384       0x00000003</span>
<span class="line-modified">! #define CKG_MGF1_SHA512       0x00000004</span>
<span class="line-modified">! </span>
<span class="line-removed">- /* CK_RSA_PKCS_OAEP_SOURCE_TYPE is new for v2.10.</span>
<span class="line-removed">-  * CK_RSA_PKCS_OAEP_SOURCE_TYPE  is used to indicate the source</span>
   * of the encoding parameter when formatting a message block
<span class="line-modified">!  * for the PKCS #1 OAEP encryption scheme. */</span>
  typedef CK_ULONG CK_RSA_PKCS_OAEP_SOURCE_TYPE;
  
  typedef CK_RSA_PKCS_OAEP_SOURCE_TYPE CK_PTR CK_RSA_PKCS_OAEP_SOURCE_TYPE_PTR;
  
  /* The following encoding parameter sources are defined */
<span class="line-modified">! #define CKZ_DATA_SPECIFIED    0x00000001</span>
  
<span class="line-modified">! /* CK_RSA_PKCS_OAEP_PARAMS is new for v2.10.</span>
<span class="line-modified">!  * CK_RSA_PKCS_OAEP_PARAMS provides the parameters to the</span>
<span class="line-modified">!  * CKM_RSA_PKCS_OAEP mechanism. */</span>
  typedef struct CK_RSA_PKCS_OAEP_PARAMS {
          CK_MECHANISM_TYPE hashAlg;
          CK_RSA_PKCS_MGF_TYPE mgf;
          CK_RSA_PKCS_OAEP_SOURCE_TYPE source;
          CK_VOID_PTR pSourceData;
          CK_ULONG ulSourceDataLen;
  } CK_RSA_PKCS_OAEP_PARAMS;
  
  typedef CK_RSA_PKCS_OAEP_PARAMS CK_PTR CK_RSA_PKCS_OAEP_PARAMS_PTR;
  
<span class="line-modified">! /* CK_RSA_PKCS_PSS_PARAMS is new for v2.11.</span>
<span class="line-modified">!  * CK_RSA_PKCS_PSS_PARAMS provides the parameters to the</span>
<span class="line-modified">!  * CKM_RSA_PKCS_PSS mechanism(s). */</span>
  typedef struct CK_RSA_PKCS_PSS_PARAMS {
          CK_MECHANISM_TYPE    hashAlg;
          CK_RSA_PKCS_MGF_TYPE mgf;
          CK_ULONG             sLen;
  } CK_RSA_PKCS_PSS_PARAMS;
  
  typedef CK_RSA_PKCS_PSS_PARAMS CK_PTR CK_RSA_PKCS_PSS_PARAMS_PTR;
  
<span class="line-removed">- /* CK_EC_KDF_TYPE is new for v2.11. */</span>
  typedef CK_ULONG CK_EC_KDF_TYPE;
  
  /* The following EC Key Derivation Functions are defined */
<span class="line-modified">! #define CKD_NULL                 0x00000001</span>
<span class="line-modified">! #define CKD_SHA1_KDF             0x00000002</span>
  
<span class="line-modified">! /* CK_ECDH1_DERIVE_PARAMS is new for v2.11.</span>
<span class="line-modified">!  * CK_ECDH1_DERIVE_PARAMS provides the parameters to the</span>
   * CKM_ECDH1_DERIVE and CKM_ECDH1_COFACTOR_DERIVE mechanisms,
   * where each party contributes one key pair.
   */
  typedef struct CK_ECDH1_DERIVE_PARAMS {
    CK_EC_KDF_TYPE kdf;
<span class="line-new-header">--- 1221,89 ---</span>
  } CK_C_INITIALIZE_ARGS;
  
  /* flags: bit flags that provide capabilities of the slot
   *      Bit Flag                           Mask       Meaning
   */
<span class="line-modified">! #define CKF_LIBRARY_CANT_CREATE_OS_THREADS 0x00000001UL</span>
<span class="line-modified">! #define CKF_OS_LOCKING_OK                  0x00000002UL</span>
  
  typedef CK_C_INITIALIZE_ARGS CK_PTR CK_C_INITIALIZE_ARGS_PTR;
  
  
  /* additional flags for parameters to functions */
  
  /* CKF_DONT_BLOCK is for the function C_WaitForSlotEvent */
  #define CKF_DONT_BLOCK     1
  
<span class="line-modified">! /* CK_RSA_PKCS_MGF_TYPE  is used to indicate the Message</span>
   * Generation Function (MGF) applied to a message block when
   * formatting a message block for the PKCS #1 OAEP encryption
<span class="line-modified">!  * scheme.</span>
<span class="line-added">+  */</span>
  typedef CK_ULONG CK_RSA_PKCS_MGF_TYPE;
  
  typedef CK_RSA_PKCS_MGF_TYPE CK_PTR CK_RSA_PKCS_MGF_TYPE_PTR;
  
  /* The following MGFs are defined */
<span class="line-modified">! #define CKG_MGF1_SHA1         0x00000001UL</span>
<span class="line-modified">! #define CKG_MGF1_SHA256       0x00000002UL</span>
<span class="line-modified">! #define CKG_MGF1_SHA384       0x00000003UL</span>
<span class="line-modified">! #define CKG_MGF1_SHA512       0x00000004UL</span>
<span class="line-modified">! #define CKG_MGF1_SHA224       0x00000005UL</span>
<span class="line-modified">! </span>
<span class="line-modified">! /* CK_RSA_PKCS_OAEP_SOURCE_TYPE  is used to indicate the source</span>
   * of the encoding parameter when formatting a message block
<span class="line-modified">!  * for the PKCS #1 OAEP encryption scheme.</span>
<span class="line-added">+  */</span>
  typedef CK_ULONG CK_RSA_PKCS_OAEP_SOURCE_TYPE;
  
  typedef CK_RSA_PKCS_OAEP_SOURCE_TYPE CK_PTR CK_RSA_PKCS_OAEP_SOURCE_TYPE_PTR;
  
  /* The following encoding parameter sources are defined */
<span class="line-modified">! #define CKZ_DATA_SPECIFIED    0x00000001UL</span>
  
<span class="line-modified">! /* CK_RSA_PKCS_OAEP_PARAMS provides the parameters to the</span>
<span class="line-modified">!  * CKM_RSA_PKCS_OAEP mechanism.</span>
<span class="line-modified">!  */</span>
  typedef struct CK_RSA_PKCS_OAEP_PARAMS {
          CK_MECHANISM_TYPE hashAlg;
          CK_RSA_PKCS_MGF_TYPE mgf;
          CK_RSA_PKCS_OAEP_SOURCE_TYPE source;
          CK_VOID_PTR pSourceData;
          CK_ULONG ulSourceDataLen;
  } CK_RSA_PKCS_OAEP_PARAMS;
  
  typedef CK_RSA_PKCS_OAEP_PARAMS CK_PTR CK_RSA_PKCS_OAEP_PARAMS_PTR;
  
<span class="line-modified">! /* CK_RSA_PKCS_PSS_PARAMS provides the parameters to the</span>
<span class="line-modified">!  * CKM_RSA_PKCS_PSS mechanism(s).</span>
<span class="line-modified">!  */</span>
  typedef struct CK_RSA_PKCS_PSS_PARAMS {
          CK_MECHANISM_TYPE    hashAlg;
          CK_RSA_PKCS_MGF_TYPE mgf;
          CK_ULONG             sLen;
  } CK_RSA_PKCS_PSS_PARAMS;
  
  typedef CK_RSA_PKCS_PSS_PARAMS CK_PTR CK_RSA_PKCS_PSS_PARAMS_PTR;
  
  typedef CK_ULONG CK_EC_KDF_TYPE;
  
  /* The following EC Key Derivation Functions are defined */
<span class="line-modified">! #define CKD_NULL                 0x00000001UL</span>
<span class="line-modified">! #define CKD_SHA1_KDF             0x00000002UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ /* The following X9.42 DH key derivation functions are defined */</span>
<span class="line-added">+ #define CKD_SHA1_KDF_ASN1        0x00000003UL</span>
<span class="line-added">+ #define CKD_SHA1_KDF_CONCATENATE 0x00000004UL</span>
<span class="line-added">+ #define CKD_SHA224_KDF           0x00000005UL</span>
<span class="line-added">+ #define CKD_SHA256_KDF           0x00000006UL</span>
<span class="line-added">+ #define CKD_SHA384_KDF           0x00000007UL</span>
<span class="line-added">+ #define CKD_SHA512_KDF           0x00000008UL</span>
<span class="line-added">+ #define CKD_CPDIVERSIFY_KDF      0x00000009UL</span>
  
<span class="line-modified">! </span>
<span class="line-modified">! /* CK_ECDH1_DERIVE_PARAMS provides the parameters to the</span>
   * CKM_ECDH1_DERIVE and CKM_ECDH1_COFACTOR_DERIVE mechanisms,
   * where each party contributes one key pair.
   */
  typedef struct CK_ECDH1_DERIVE_PARAMS {
    CK_EC_KDF_TYPE kdf;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1241,14 ***</span>
    CK_BYTE_PTR pPublicData;
  } CK_ECDH1_DERIVE_PARAMS;
  
  typedef CK_ECDH1_DERIVE_PARAMS CK_PTR CK_ECDH1_DERIVE_PARAMS_PTR;
  
<span class="line-modified">! </span>
<span class="line-removed">- /* CK_ECDH2_DERIVE_PARAMS is new for v2.11.</span>
   * CK_ECDH2_DERIVE_PARAMS provides the parameters to the
<span class="line-modified">!  * CKM_ECMQV_DERIVE mechanism, where each party contributes two key pairs. */</span>
  typedef struct CK_ECDH2_DERIVE_PARAMS {
    CK_EC_KDF_TYPE kdf;
    CK_ULONG ulSharedDataLen;
    CK_BYTE_PTR pSharedData;
    CK_ULONG ulPublicDataLen;
<span class="line-new-header">--- 1313,14 ---</span>
    CK_BYTE_PTR pPublicData;
  } CK_ECDH1_DERIVE_PARAMS;
  
  typedef CK_ECDH1_DERIVE_PARAMS CK_PTR CK_ECDH1_DERIVE_PARAMS_PTR;
  
<span class="line-modified">! /*</span>
   * CK_ECDH2_DERIVE_PARAMS provides the parameters to the
<span class="line-modified">!  * CKM_ECMQV_DERIVE mechanism, where each party contributes two key pairs.</span>
<span class="line-added">+  */</span>
  typedef struct CK_ECDH2_DERIVE_PARAMS {
    CK_EC_KDF_TYPE kdf;
    CK_ULONG ulSharedDataLen;
    CK_BYTE_PTR pSharedData;
    CK_ULONG ulPublicDataLen;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1275,37 ***</span>
  } CK_ECMQV_DERIVE_PARAMS;
  
  typedef CK_ECMQV_DERIVE_PARAMS CK_PTR CK_ECMQV_DERIVE_PARAMS_PTR;
  
  /* Typedefs and defines for the CKM_X9_42_DH_KEY_PAIR_GEN and the
<span class="line-modified">!  * CKM_X9_42_DH_PARAMETER_GEN mechanisms (new for PKCS #11 v2.11) */</span>
  typedef CK_ULONG CK_X9_42_DH_KDF_TYPE;
  typedef CK_X9_42_DH_KDF_TYPE CK_PTR CK_X9_42_DH_KDF_TYPE_PTR;
  
<span class="line-modified">! /* The following X9.42 DH key derivation functions are defined</span>
<span class="line-removed">-    (besides CKD_NULL already defined : */</span>
<span class="line-removed">- #define CKD_SHA1_KDF_ASN1        0x00000003</span>
<span class="line-removed">- #define CKD_SHA1_KDF_CONCATENATE 0x00000004</span>
<span class="line-removed">- </span>
<span class="line-removed">- /* CK_X9_42_DH1_DERIVE_PARAMS is new for v2.11.</span>
<span class="line-removed">-  * CK_X9_42_DH1_DERIVE_PARAMS provides the parameters to the</span>
   * CKM_X9_42_DH_DERIVE key derivation mechanism, where each party
<span class="line-modified">!  * contributes one key pair */</span>
  typedef struct CK_X9_42_DH1_DERIVE_PARAMS {
    CK_X9_42_DH_KDF_TYPE kdf;
    CK_ULONG ulOtherInfoLen;
    CK_BYTE_PTR pOtherInfo;
    CK_ULONG ulPublicDataLen;
    CK_BYTE_PTR pPublicData;
  } CK_X9_42_DH1_DERIVE_PARAMS;
  
  typedef struct CK_X9_42_DH1_DERIVE_PARAMS CK_PTR CK_X9_42_DH1_DERIVE_PARAMS_PTR;
  
<span class="line-modified">! /* CK_X9_42_DH2_DERIVE_PARAMS is new for v2.11.</span>
<span class="line-removed">-  * CK_X9_42_DH2_DERIVE_PARAMS provides the parameters to the</span>
   * CKM_X9_42_DH_HYBRID_DERIVE and CKM_X9_42_MQV_DERIVE key derivation
<span class="line-modified">!  * mechanisms, where each party contributes two key pairs */</span>
  typedef struct CK_X9_42_DH2_DERIVE_PARAMS {
    CK_X9_42_DH_KDF_TYPE kdf;
    CK_ULONG ulOtherInfoLen;
    CK_BYTE_PTR pOtherInfo;
    CK_ULONG ulPublicDataLen;
<span class="line-new-header">--- 1347,33 ---</span>
  } CK_ECMQV_DERIVE_PARAMS;
  
  typedef CK_ECMQV_DERIVE_PARAMS CK_PTR CK_ECMQV_DERIVE_PARAMS_PTR;
  
  /* Typedefs and defines for the CKM_X9_42_DH_KEY_PAIR_GEN and the
<span class="line-modified">!  * CKM_X9_42_DH_PARAMETER_GEN mechanisms</span>
<span class="line-added">+  */</span>
  typedef CK_ULONG CK_X9_42_DH_KDF_TYPE;
  typedef CK_X9_42_DH_KDF_TYPE CK_PTR CK_X9_42_DH_KDF_TYPE_PTR;
  
<span class="line-modified">! /* CK_X9_42_DH1_DERIVE_PARAMS provides the parameters to the</span>
   * CKM_X9_42_DH_DERIVE key derivation mechanism, where each party
<span class="line-modified">!  * contributes one key pair</span>
<span class="line-added">+  */</span>
  typedef struct CK_X9_42_DH1_DERIVE_PARAMS {
    CK_X9_42_DH_KDF_TYPE kdf;
    CK_ULONG ulOtherInfoLen;
    CK_BYTE_PTR pOtherInfo;
    CK_ULONG ulPublicDataLen;
    CK_BYTE_PTR pPublicData;
  } CK_X9_42_DH1_DERIVE_PARAMS;
  
  typedef struct CK_X9_42_DH1_DERIVE_PARAMS CK_PTR CK_X9_42_DH1_DERIVE_PARAMS_PTR;
  
<span class="line-modified">! /* CK_X9_42_DH2_DERIVE_PARAMS provides the parameters to the</span>
   * CKM_X9_42_DH_HYBRID_DERIVE and CKM_X9_42_MQV_DERIVE key derivation
<span class="line-modified">!  * mechanisms, where each party contributes two key pairs</span>
<span class="line-added">+  */</span>
  typedef struct CK_X9_42_DH2_DERIVE_PARAMS {
    CK_X9_42_DH_KDF_TYPE kdf;
    CK_ULONG ulOtherInfoLen;
    CK_BYTE_PTR pOtherInfo;
    CK_ULONG ulPublicDataLen;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1332,12 ***</span>
  } CK_X9_42_MQV_DERIVE_PARAMS;
  
  typedef CK_X9_42_MQV_DERIVE_PARAMS CK_PTR CK_X9_42_MQV_DERIVE_PARAMS_PTR;
  
  /* CK_KEA_DERIVE_PARAMS provides the parameters to the
<span class="line-modified">!  * CKM_KEA_DERIVE mechanism */</span>
<span class="line-modified">! /* CK_KEA_DERIVE_PARAMS is new for v2.0 */</span>
  typedef struct CK_KEA_DERIVE_PARAMS {
    CK_BBOOL      isSender;
    CK_ULONG      ulRandomLen;
    CK_BYTE_PTR   pRandomA;
    CK_BYTE_PTR   pRandomB;
<span class="line-new-header">--- 1400,12 ---</span>
  } CK_X9_42_MQV_DERIVE_PARAMS;
  
  typedef CK_X9_42_MQV_DERIVE_PARAMS CK_PTR CK_X9_42_MQV_DERIVE_PARAMS_PTR;
  
  /* CK_KEA_DERIVE_PARAMS provides the parameters to the
<span class="line-modified">!  * CKM_KEA_DERIVE mechanism</span>
<span class="line-modified">!  */</span>
  typedef struct CK_KEA_DERIVE_PARAMS {
    CK_BBOOL      isSender;
    CK_ULONG      ulRandomLen;
    CK_BYTE_PTR   pRandomA;
    CK_BYTE_PTR   pRandomB;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1348,55 ***</span>
  typedef CK_KEA_DERIVE_PARAMS CK_PTR CK_KEA_DERIVE_PARAMS_PTR;
  
  
  /* CK_RC2_PARAMS provides the parameters to the CKM_RC2_ECB and
   * CKM_RC2_MAC mechanisms.  An instance of CK_RC2_PARAMS just
<span class="line-modified">!  * holds the effective keysize */</span>
  typedef CK_ULONG          CK_RC2_PARAMS;
  
  typedef CK_RC2_PARAMS CK_PTR CK_RC2_PARAMS_PTR;
  
  
  /* CK_RC2_CBC_PARAMS provides the parameters to the CKM_RC2_CBC
<span class="line-modified">!  * mechanism */</span>
  typedef struct CK_RC2_CBC_PARAMS {
<span class="line-removed">-   /* ulEffectiveBits was changed from CK_USHORT to CK_ULONG for</span>
<span class="line-removed">-    * v2.0 */</span>
    CK_ULONG      ulEffectiveBits;  /* effective bits (1-1024) */
<span class="line-removed">- </span>
    CK_BYTE       iv[8];            /* IV for CBC mode */
  } CK_RC2_CBC_PARAMS;
  
  typedef CK_RC2_CBC_PARAMS CK_PTR CK_RC2_CBC_PARAMS_PTR;
  
  
  /* CK_RC2_MAC_GENERAL_PARAMS provides the parameters for the
<span class="line-modified">!  * CKM_RC2_MAC_GENERAL mechanism */</span>
<span class="line-modified">! /* CK_RC2_MAC_GENERAL_PARAMS is new for v2.0 */</span>
  typedef struct CK_RC2_MAC_GENERAL_PARAMS {
    CK_ULONG      ulEffectiveBits;  /* effective bits (1-1024) */
    CK_ULONG      ulMacLength;      /* Length of MAC in bytes */
  } CK_RC2_MAC_GENERAL_PARAMS;
  
  typedef CK_RC2_MAC_GENERAL_PARAMS CK_PTR \
    CK_RC2_MAC_GENERAL_PARAMS_PTR;
  
  
  /* CK_RC5_PARAMS provides the parameters to the CKM_RC5_ECB and
<span class="line-modified">!  * CKM_RC5_MAC mechanisms */</span>
<span class="line-modified">! /* CK_RC5_PARAMS is new for v2.0 */</span>
  typedef struct CK_RC5_PARAMS {
    CK_ULONG      ulWordsize;  /* wordsize in bits */
    CK_ULONG      ulRounds;    /* number of rounds */
  } CK_RC5_PARAMS;
  
  typedef CK_RC5_PARAMS CK_PTR CK_RC5_PARAMS_PTR;
  
  
  /* CK_RC5_CBC_PARAMS provides the parameters to the CKM_RC5_CBC
<span class="line-modified">!  * mechanism */</span>
<span class="line-modified">! /* CK_RC5_CBC_PARAMS is new for v2.0 */</span>
  typedef struct CK_RC5_CBC_PARAMS {
    CK_ULONG      ulWordsize;  /* wordsize in bits */
    CK_ULONG      ulRounds;    /* number of rounds */
    CK_BYTE_PTR   pIv;         /* pointer to IV */
    CK_ULONG      ulIvLen;     /* length of IV in bytes */
<span class="line-new-header">--- 1416,54 ---</span>
  typedef CK_KEA_DERIVE_PARAMS CK_PTR CK_KEA_DERIVE_PARAMS_PTR;
  
  
  /* CK_RC2_PARAMS provides the parameters to the CKM_RC2_ECB and
   * CKM_RC2_MAC mechanisms.  An instance of CK_RC2_PARAMS just
<span class="line-modified">!  * holds the effective keysize</span>
<span class="line-added">+  */</span>
  typedef CK_ULONG          CK_RC2_PARAMS;
  
  typedef CK_RC2_PARAMS CK_PTR CK_RC2_PARAMS_PTR;
  
  
  /* CK_RC2_CBC_PARAMS provides the parameters to the CKM_RC2_CBC
<span class="line-modified">!  * mechanism</span>
<span class="line-added">+  */</span>
  typedef struct CK_RC2_CBC_PARAMS {
    CK_ULONG      ulEffectiveBits;  /* effective bits (1-1024) */
    CK_BYTE       iv[8];            /* IV for CBC mode */
  } CK_RC2_CBC_PARAMS;
  
  typedef CK_RC2_CBC_PARAMS CK_PTR CK_RC2_CBC_PARAMS_PTR;
  
  
  /* CK_RC2_MAC_GENERAL_PARAMS provides the parameters for the
<span class="line-modified">!  * CKM_RC2_MAC_GENERAL mechanism</span>
<span class="line-modified">!  */</span>
  typedef struct CK_RC2_MAC_GENERAL_PARAMS {
    CK_ULONG      ulEffectiveBits;  /* effective bits (1-1024) */
    CK_ULONG      ulMacLength;      /* Length of MAC in bytes */
  } CK_RC2_MAC_GENERAL_PARAMS;
  
  typedef CK_RC2_MAC_GENERAL_PARAMS CK_PTR \
    CK_RC2_MAC_GENERAL_PARAMS_PTR;
  
  
  /* CK_RC5_PARAMS provides the parameters to the CKM_RC5_ECB and
<span class="line-modified">!  * CKM_RC5_MAC mechanisms</span>
<span class="line-modified">!  */</span>
  typedef struct CK_RC5_PARAMS {
    CK_ULONG      ulWordsize;  /* wordsize in bits */
    CK_ULONG      ulRounds;    /* number of rounds */
  } CK_RC5_PARAMS;
  
  typedef CK_RC5_PARAMS CK_PTR CK_RC5_PARAMS_PTR;
  
  
  /* CK_RC5_CBC_PARAMS provides the parameters to the CKM_RC5_CBC
<span class="line-modified">!  * mechanism</span>
<span class="line-modified">!  */</span>
  typedef struct CK_RC5_CBC_PARAMS {
    CK_ULONG      ulWordsize;  /* wordsize in bits */
    CK_ULONG      ulRounds;    /* number of rounds */
    CK_BYTE_PTR   pIv;         /* pointer to IV */
    CK_ULONG      ulIvLen;     /* length of IV in bytes */
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1404,31 ***</span>
  
  typedef CK_RC5_CBC_PARAMS CK_PTR CK_RC5_CBC_PARAMS_PTR;
  
  
  /* CK_RC5_MAC_GENERAL_PARAMS provides the parameters for the
<span class="line-modified">!  * CKM_RC5_MAC_GENERAL mechanism */</span>
<span class="line-modified">! /* CK_RC5_MAC_GENERAL_PARAMS is new for v2.0 */</span>
  typedef struct CK_RC5_MAC_GENERAL_PARAMS {
    CK_ULONG      ulWordsize;   /* wordsize in bits */
    CK_ULONG      ulRounds;     /* number of rounds */
    CK_ULONG      ulMacLength;  /* Length of MAC in bytes */
  } CK_RC5_MAC_GENERAL_PARAMS;
  
  typedef CK_RC5_MAC_GENERAL_PARAMS CK_PTR \
    CK_RC5_MAC_GENERAL_PARAMS_PTR;
  
<span class="line-removed">- </span>
  /* CK_MAC_GENERAL_PARAMS provides the parameters to most block
   * ciphers&#39; MAC_GENERAL mechanisms.  Its value is the length of
<span class="line-modified">!  * the MAC */</span>
<span class="line-modified">! /* CK_MAC_GENERAL_PARAMS is new for v2.0 */</span>
  typedef CK_ULONG          CK_MAC_GENERAL_PARAMS;
  
  typedef CK_MAC_GENERAL_PARAMS CK_PTR CK_MAC_GENERAL_PARAMS_PTR;
  
<span class="line-removed">- /* CK_DES/AES_ECB/CBC_ENCRYPT_DATA_PARAMS are new for v2.20 */</span>
  typedef struct CK_DES_CBC_ENCRYPT_DATA_PARAMS {
    CK_BYTE      iv[8];
    CK_BYTE_PTR  pData;
    CK_ULONG     length;
  } CK_DES_CBC_ENCRYPT_DATA_PARAMS;
<span class="line-new-header">--- 1471,29 ---</span>
  
  typedef CK_RC5_CBC_PARAMS CK_PTR CK_RC5_CBC_PARAMS_PTR;
  
  
  /* CK_RC5_MAC_GENERAL_PARAMS provides the parameters for the
<span class="line-modified">!  * CKM_RC5_MAC_GENERAL mechanism</span>
<span class="line-modified">!  */</span>
  typedef struct CK_RC5_MAC_GENERAL_PARAMS {
    CK_ULONG      ulWordsize;   /* wordsize in bits */
    CK_ULONG      ulRounds;     /* number of rounds */
    CK_ULONG      ulMacLength;  /* Length of MAC in bytes */
  } CK_RC5_MAC_GENERAL_PARAMS;
  
  typedef CK_RC5_MAC_GENERAL_PARAMS CK_PTR \
    CK_RC5_MAC_GENERAL_PARAMS_PTR;
  
  /* CK_MAC_GENERAL_PARAMS provides the parameters to most block
   * ciphers&#39; MAC_GENERAL mechanisms.  Its value is the length of
<span class="line-modified">!  * the MAC</span>
<span class="line-modified">!  */</span>
  typedef CK_ULONG          CK_MAC_GENERAL_PARAMS;
  
  typedef CK_MAC_GENERAL_PARAMS CK_PTR CK_MAC_GENERAL_PARAMS_PTR;
  
  typedef struct CK_DES_CBC_ENCRYPT_DATA_PARAMS {
    CK_BYTE      iv[8];
    CK_BYTE_PTR  pData;
    CK_ULONG     length;
  } CK_DES_CBC_ENCRYPT_DATA_PARAMS;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1442,12 ***</span>
  } CK_AES_CBC_ENCRYPT_DATA_PARAMS;
  
  typedef CK_AES_CBC_ENCRYPT_DATA_PARAMS CK_PTR CK_AES_CBC_ENCRYPT_DATA_PARAMS_PTR;
  
  /* CK_SKIPJACK_PRIVATE_WRAP_PARAMS provides the parameters to the
<span class="line-modified">!  * CKM_SKIPJACK_PRIVATE_WRAP mechanism */</span>
<span class="line-modified">! /* CK_SKIPJACK_PRIVATE_WRAP_PARAMS is new for v2.0 */</span>
  typedef struct CK_SKIPJACK_PRIVATE_WRAP_PARAMS {
    CK_ULONG      ulPasswordLen;
    CK_BYTE_PTR   pPassword;
    CK_ULONG      ulPublicDataLen;
    CK_BYTE_PTR   pPublicData;
<span class="line-new-header">--- 1507,12 ---</span>
  } CK_AES_CBC_ENCRYPT_DATA_PARAMS;
  
  typedef CK_AES_CBC_ENCRYPT_DATA_PARAMS CK_PTR CK_AES_CBC_ENCRYPT_DATA_PARAMS_PTR;
  
  /* CK_SKIPJACK_PRIVATE_WRAP_PARAMS provides the parameters to the
<span class="line-modified">!  * CKM_SKIPJACK_PRIVATE_WRAP mechanism</span>
<span class="line-modified">!  */</span>
  typedef struct CK_SKIPJACK_PRIVATE_WRAP_PARAMS {
    CK_ULONG      ulPasswordLen;
    CK_BYTE_PTR   pPassword;
    CK_ULONG      ulPublicDataLen;
    CK_BYTE_PTR   pPublicData;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1459,16 ***</span>
    CK_BYTE_PTR   pBaseG;
    CK_BYTE_PTR   pSubprimeQ;
  } CK_SKIPJACK_PRIVATE_WRAP_PARAMS;
  
  typedef CK_SKIPJACK_PRIVATE_WRAP_PARAMS CK_PTR \
<span class="line-modified">!   CK_SKIPJACK_PRIVATE_WRAP_PTR;</span>
  
  
  /* CK_SKIPJACK_RELAYX_PARAMS provides the parameters to the
<span class="line-modified">!  * CKM_SKIPJACK_RELAYX mechanism */</span>
<span class="line-modified">! /* CK_SKIPJACK_RELAYX_PARAMS is new for v2.0 */</span>
  typedef struct CK_SKIPJACK_RELAYX_PARAMS {
    CK_ULONG      ulOldWrappedXLen;
    CK_BYTE_PTR   pOldWrappedX;
    CK_ULONG      ulOldPasswordLen;
    CK_BYTE_PTR   pOldPassword;
<span class="line-new-header">--- 1524,16 ---</span>
    CK_BYTE_PTR   pBaseG;
    CK_BYTE_PTR   pSubprimeQ;
  } CK_SKIPJACK_PRIVATE_WRAP_PARAMS;
  
  typedef CK_SKIPJACK_PRIVATE_WRAP_PARAMS CK_PTR \
<span class="line-modified">!   CK_SKIPJACK_PRIVATE_WRAP_PARAMS_PTR;</span>
  
  
  /* CK_SKIPJACK_RELAYX_PARAMS provides the parameters to the
<span class="line-modified">!  * CKM_SKIPJACK_RELAYX mechanism</span>
<span class="line-modified">!  */</span>
  typedef struct CK_SKIPJACK_RELAYX_PARAMS {
    CK_ULONG      ulOldWrappedXLen;
    CK_BYTE_PTR   pOldWrappedX;
    CK_ULONG      ulOldPasswordLen;
    CK_BYTE_PTR   pOldPassword;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1499,21 ***</span>
  
  typedef CK_PBE_PARAMS CK_PTR CK_PBE_PARAMS_PTR;
  
  
  /* CK_KEY_WRAP_SET_OAEP_PARAMS provides the parameters to the
<span class="line-modified">!  * CKM_KEY_WRAP_SET_OAEP mechanism */</span>
<span class="line-modified">! /* CK_KEY_WRAP_SET_OAEP_PARAMS is new for v2.0 */</span>
  typedef struct CK_KEY_WRAP_SET_OAEP_PARAMS {
    CK_BYTE       bBC;     /* block contents byte */
    CK_BYTE_PTR   pX;      /* extra data */
    CK_ULONG      ulXLen;  /* length of extra data in bytes */
  } CK_KEY_WRAP_SET_OAEP_PARAMS;
  
<span class="line-modified">! typedef CK_KEY_WRAP_SET_OAEP_PARAMS CK_PTR \</span>
<span class="line-removed">-   CK_KEY_WRAP_SET_OAEP_PARAMS_PTR;</span>
<span class="line-removed">- </span>
  
  typedef struct CK_SSL3_RANDOM_DATA {
    CK_BYTE_PTR  pClientRandom;
    CK_ULONG     ulClientRandomLen;
    CK_BYTE_PTR  pServerRandom;
<span class="line-new-header">--- 1564,19 ---</span>
  
  typedef CK_PBE_PARAMS CK_PTR CK_PBE_PARAMS_PTR;
  
  
  /* CK_KEY_WRAP_SET_OAEP_PARAMS provides the parameters to the
<span class="line-modified">!  * CKM_KEY_WRAP_SET_OAEP mechanism</span>
<span class="line-modified">!  */</span>
  typedef struct CK_KEY_WRAP_SET_OAEP_PARAMS {
    CK_BYTE       bBC;     /* block contents byte */
    CK_BYTE_PTR   pX;      /* extra data */
    CK_ULONG      ulXLen;  /* length of extra data in bytes */
  } CK_KEY_WRAP_SET_OAEP_PARAMS;
  
<span class="line-modified">! typedef CK_KEY_WRAP_SET_OAEP_PARAMS CK_PTR CK_KEY_WRAP_SET_OAEP_PARAMS_PTR;</span>
  
  typedef struct CK_SSL3_RANDOM_DATA {
    CK_BYTE_PTR  pClientRandom;
    CK_ULONG     ulClientRandomLen;
    CK_BYTE_PTR  pServerRandom;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1527,11 ***</span>
  } CK_SSL3_MASTER_KEY_DERIVE_PARAMS;
  
  typedef struct CK_SSL3_MASTER_KEY_DERIVE_PARAMS CK_PTR \
    CK_SSL3_MASTER_KEY_DERIVE_PARAMS_PTR;
  
<span class="line-removed">- </span>
  typedef struct CK_SSL3_KEY_MAT_OUT {
    CK_OBJECT_HANDLE hClientMacSecret;
    CK_OBJECT_HANDLE hServerMacSecret;
    CK_OBJECT_HANDLE hClientKey;
    CK_OBJECT_HANDLE hServerKey;
<span class="line-new-header">--- 1590,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1551,11 ***</span>
    CK_SSL3_KEY_MAT_OUT_PTR pReturnedKeyMaterial;
  } CK_SSL3_KEY_MAT_PARAMS;
  
  typedef CK_SSL3_KEY_MAT_PARAMS CK_PTR CK_SSL3_KEY_MAT_PARAMS_PTR;
  
<span class="line-removed">- /* CK_TLS_PRF_PARAMS is new for version 2.20 */</span>
  typedef struct CK_TLS_PRF_PARAMS {
    CK_BYTE_PTR  pSeed;
    CK_ULONG     ulSeedLen;
    CK_BYTE_PTR  pLabel;
    CK_ULONG     ulLabelLen;
<span class="line-new-header">--- 1613,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1563,11 ***</span>
    CK_ULONG_PTR pulOutputLen;
  } CK_TLS_PRF_PARAMS;
  
  typedef CK_TLS_PRF_PARAMS CK_PTR CK_TLS_PRF_PARAMS_PTR;
  
<span class="line-removed">- /* WTLS is new for version 2.20 */</span>
  typedef struct CK_WTLS_RANDOM_DATA {
    CK_BYTE_PTR pClientRandom;
    CK_ULONG    ulClientRandomLen;
    CK_BYTE_PTR pServerRandom;
    CK_ULONG    ulServerRandomLen;
<span class="line-new-header">--- 1624,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1615,11 ***</span>
    CK_WTLS_KEY_MAT_OUT_PTR pReturnedKeyMaterial;
  } CK_WTLS_KEY_MAT_PARAMS;
  
  typedef CK_WTLS_KEY_MAT_PARAMS CK_PTR CK_WTLS_KEY_MAT_PARAMS_PTR;
  
<span class="line-removed">- /* CMS is new for version 2.20 */</span>
  typedef struct CK_CMS_SIG_PARAMS {
    CK_OBJECT_HANDLE      certificateHandle;
    CK_MECHANISM_PTR      pSigningMechanism;
    CK_MECHANISM_PTR      pDigestMechanism;
    CK_UTF8CHAR_PTR       pContentType;
<span class="line-new-header">--- 1675,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1641,42 ***</span>
  
  
  /* The CK_EXTRACT_PARAMS is used for the
   * CKM_EXTRACT_KEY_FROM_KEY mechanism.  It specifies which bit
   * of the base key should be used as the first bit of the
<span class="line-modified">!  * derived key */</span>
<span class="line-modified">! /* CK_EXTRACT_PARAMS is new for v2.0 */</span>
  typedef CK_ULONG CK_EXTRACT_PARAMS;
  
  typedef CK_EXTRACT_PARAMS CK_PTR CK_EXTRACT_PARAMS_PTR;
  
<span class="line-modified">! /* CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE is new for v2.10.</span>
<span class="line-removed">-  * CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE is used to</span>
   * indicate the Pseudo-Random Function (PRF) used to generate
<span class="line-modified">!  * key bits using PKCS #5 PBKDF2. */</span>
  typedef CK_ULONG CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE;
  
<span class="line-modified">! typedef CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE CK_PTR CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE_PTR;</span>
<span class="line-modified">! </span>
<span class="line-removed">- /* The following PRFs are defined in PKCS #5 v2.0. */</span>
<span class="line-removed">- #define CKP_PKCS5_PBKD2_HMAC_SHA1 0x00000001</span>
  
  
<span class="line-modified">! /* CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE is new for v2.10.</span>
<span class="line-removed">-  * CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE is used to indicate the</span>
   * source of the salt value when deriving a key using PKCS #5
<span class="line-modified">!  * PBKDF2. */</span>
  typedef CK_ULONG CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE;
  
<span class="line-modified">! typedef CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE CK_PTR CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE_PTR;</span>
  
  /* The following salt value sources are defined in PKCS #5 v2.0. */
<span class="line-modified">! #define CKZ_SALT_SPECIFIED        0x00000001</span>
  
<span class="line-modified">! /* CK_PKCS5_PBKD2_PARAMS is new for v2.10.</span>
<span class="line-modified">!  * CK_PKCS5_PBKD2_PARAMS is a structure that provides the</span>
<span class="line-modified">!  * parameters to the CKM_PKCS5_PBKD2 mechanism. */</span>
  typedef struct CK_PKCS5_PBKD2_PARAMS {
          CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE           saltSource;
          CK_VOID_PTR                                pSaltSourceData;
          CK_ULONG                                   ulSaltSourceDataLen;
          CK_ULONG                                   iterations;
<span class="line-new-header">--- 1700,49 ---</span>
  
  
  /* The CK_EXTRACT_PARAMS is used for the
   * CKM_EXTRACT_KEY_FROM_KEY mechanism.  It specifies which bit
   * of the base key should be used as the first bit of the
<span class="line-modified">!  * derived key</span>
<span class="line-modified">!  */</span>
  typedef CK_ULONG CK_EXTRACT_PARAMS;
  
  typedef CK_EXTRACT_PARAMS CK_PTR CK_EXTRACT_PARAMS_PTR;
  
<span class="line-modified">! /* CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE is used to</span>
   * indicate the Pseudo-Random Function (PRF) used to generate
<span class="line-modified">!  * key bits using PKCS #5 PBKDF2.</span>
<span class="line-added">+  */</span>
  typedef CK_ULONG CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE;
  
<span class="line-modified">! typedef CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE CK_PTR \</span>
<span class="line-modified">!                         CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE_PTR;</span>
  
<span class="line-added">+ #define CKP_PKCS5_PBKD2_HMAC_SHA1          0x00000001UL</span>
<span class="line-added">+ #define CKP_PKCS5_PBKD2_HMAC_GOSTR3411     0x00000002UL</span>
<span class="line-added">+ #define CKP_PKCS5_PBKD2_HMAC_SHA224        0x00000003UL</span>
<span class="line-added">+ #define CKP_PKCS5_PBKD2_HMAC_SHA256        0x00000004UL</span>
<span class="line-added">+ #define CKP_PKCS5_PBKD2_HMAC_SHA384        0x00000005UL</span>
<span class="line-added">+ #define CKP_PKCS5_PBKD2_HMAC_SHA512        0x00000006UL</span>
<span class="line-added">+ #define CKP_PKCS5_PBKD2_HMAC_SHA512_224    0x00000007UL</span>
<span class="line-added">+ #define CKP_PKCS5_PBKD2_HMAC_SHA512_256    0x00000008UL</span>
  
<span class="line-modified">! /* CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE is used to indicate the</span>
   * source of the salt value when deriving a key using PKCS #5
<span class="line-modified">!  * PBKDF2.</span>
<span class="line-added">+  */</span>
  typedef CK_ULONG CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE;
  
<span class="line-modified">! typedef CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE CK_PTR \</span>
<span class="line-added">+                         CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE_PTR;</span>
  
  /* The following salt value sources are defined in PKCS #5 v2.0. */
<span class="line-modified">! #define CKZ_SALT_SPECIFIED        0x00000001UL</span>
  
<span class="line-modified">! /* CK_PKCS5_PBKD2_PARAMS is a structure that provides the</span>
<span class="line-modified">!  * parameters to the CKM_PKCS5_PBKD2 mechanism.</span>
<span class="line-modified">!  */</span>
  typedef struct CK_PKCS5_PBKD2_PARAMS {
          CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE           saltSource;
          CK_VOID_PTR                                pSaltSourceData;
          CK_ULONG                                   ulSaltSourceDataLen;
          CK_ULONG                                   iterations;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1687,36 ***</span>
          CK_ULONG_PTR                               ulPasswordLen;
  } CK_PKCS5_PBKD2_PARAMS;
  
  typedef CK_PKCS5_PBKD2_PARAMS CK_PTR CK_PKCS5_PBKD2_PARAMS_PTR;
  
<span class="line-modified">! /* new for v2.40 */</span>
  
  typedef struct CK_TLS12_MASTER_KEY_DERIVE_PARAMS {
<span class="line-modified">!   CK_SSL3_RANDOM_DATA       RandomInfo;</span>
<span class="line-modified">!   CK_VERSION_PTR            pVersion;</span>
<span class="line-modified">!   CK_MECHANISM_TYPE         prfHashMechanism;</span>
  } CK_TLS12_MASTER_KEY_DERIVE_PARAMS;
  
<span class="line-modified">! typedef CK_TLS12_MASTER_KEY_DERIVE_PARAMS CK_PTR CK_TLS12_MASTER_KEY_DERIVE_PARAMS_PTR;</span>
  
  typedef struct CK_TLS12_KEY_MAT_PARAMS {
<span class="line-modified">!   CK_ULONG ulMacSizeInBits;</span>
<span class="line-modified">!   CK_ULONG ulKeySizeInBits;</span>
<span class="line-modified">!   CK_ULONG ulIVSizeInBits;</span>
<span class="line-modified">!   CK_BBOOL bIsExport;</span>
<span class="line-modified">!   CK_SSL3_RANDOM_DATA RandomInfo;</span>
<span class="line-modified">!   CK_SSL3_KEY_MAT_OUT_PTR pReturnedKeyMaterial;</span>
<span class="line-modified">!   CK_MECHANISM_TYPE prfHashMechanism;</span>
  } CK_TLS12_KEY_MAT_PARAMS;
  
  typedef CK_TLS12_KEY_MAT_PARAMS CK_PTR CK_TLS12_KEY_MAT_PARAMS_PTR;
  
  typedef struct CK_TLS_MAC_PARAMS {
<span class="line-modified">!   CK_MECHANISM_TYPE prfMechanism;</span>
<span class="line-modified">!   CK_ULONG ulMacLength;</span>
<span class="line-modified">!   CK_ULONG ulServerOrClient;</span>
  } CK_TLS_MAC_PARAMS;
  
  typedef CK_TLS_MAC_PARAMS CK_PTR CK_TLS_MAC_PARAMS_PTR;
  
<span class="line-modified">! #endif</span>
<span class="line-new-header">--- 1753,252 ---</span>
          CK_ULONG_PTR                               ulPasswordLen;
  } CK_PKCS5_PBKD2_PARAMS;
  
  typedef CK_PKCS5_PBKD2_PARAMS CK_PTR CK_PKCS5_PBKD2_PARAMS_PTR;
  
<span class="line-modified">! /* CK_PKCS5_PBKD2_PARAMS2 is a corrected version of the CK_PKCS5_PBKD2_PARAMS</span>
<span class="line-added">+  * structure that provides the parameters to the CKM_PKCS5_PBKD2 mechanism</span>
<span class="line-added">+  * noting that the ulPasswordLen field is a CK_ULONG and not a CK_ULONG_PTR.</span>
<span class="line-added">+  */</span>
<span class="line-added">+ typedef struct CK_PKCS5_PBKD2_PARAMS2 {</span>
<span class="line-added">+         CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE saltSource;</span>
<span class="line-added">+         CK_VOID_PTR pSaltSourceData;</span>
<span class="line-added">+         CK_ULONG ulSaltSourceDataLen;</span>
<span class="line-added">+         CK_ULONG iterations;</span>
<span class="line-added">+         CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE prf;</span>
<span class="line-added">+         CK_VOID_PTR pPrfData;</span>
<span class="line-added">+         CK_ULONG ulPrfDataLen;</span>
<span class="line-added">+         CK_UTF8CHAR_PTR pPassword;</span>
<span class="line-added">+         CK_ULONG ulPasswordLen;</span>
<span class="line-added">+ } CK_PKCS5_PBKD2_PARAMS2;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_PKCS5_PBKD2_PARAMS2 CK_PTR CK_PKCS5_PBKD2_PARAMS2_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_ULONG CK_OTP_PARAM_TYPE;</span>
<span class="line-added">+ typedef CK_OTP_PARAM_TYPE CK_PARAM_TYPE; /* backward compatibility */</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_OTP_PARAM {</span>
<span class="line-added">+     CK_OTP_PARAM_TYPE type;</span>
<span class="line-added">+     CK_VOID_PTR pValue;</span>
<span class="line-added">+     CK_ULONG ulValueLen;</span>
<span class="line-added">+ } CK_OTP_PARAM;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_OTP_PARAM CK_PTR CK_OTP_PARAM_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_OTP_PARAMS {</span>
<span class="line-added">+     CK_OTP_PARAM_PTR pParams;</span>
<span class="line-added">+     CK_ULONG ulCount;</span>
<span class="line-added">+ } CK_OTP_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_OTP_PARAMS CK_PTR CK_OTP_PARAMS_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_OTP_SIGNATURE_INFO {</span>
<span class="line-added">+     CK_OTP_PARAM_PTR pParams;</span>
<span class="line-added">+     CK_ULONG ulCount;</span>
<span class="line-added">+ } CK_OTP_SIGNATURE_INFO;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_OTP_SIGNATURE_INFO CK_PTR CK_OTP_SIGNATURE_INFO_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CK_OTP_VALUE          0UL</span>
<span class="line-added">+ #define CK_OTP_PIN            1UL</span>
<span class="line-added">+ #define CK_OTP_CHALLENGE      2UL</span>
<span class="line-added">+ #define CK_OTP_TIME           3UL</span>
<span class="line-added">+ #define CK_OTP_COUNTER        4UL</span>
<span class="line-added">+ #define CK_OTP_FLAGS          5UL</span>
<span class="line-added">+ #define CK_OTP_OUTPUT_LENGTH  6UL</span>
<span class="line-added">+ #define CK_OTP_OUTPUT_FORMAT  7UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ #define CKF_NEXT_OTP          0x00000001UL</span>
<span class="line-added">+ #define CKF_EXCLUDE_TIME      0x00000002UL</span>
<span class="line-added">+ #define CKF_EXCLUDE_COUNTER   0x00000004UL</span>
<span class="line-added">+ #define CKF_EXCLUDE_CHALLENGE 0x00000008UL</span>
<span class="line-added">+ #define CKF_EXCLUDE_PIN       0x00000010UL</span>
<span class="line-added">+ #define CKF_USER_FRIENDLY_OTP 0x00000020UL</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_KIP_PARAMS {</span>
<span class="line-added">+     CK_MECHANISM_PTR  pMechanism;</span>
<span class="line-added">+     CK_OBJECT_HANDLE  hKey;</span>
<span class="line-added">+     CK_BYTE_PTR       pSeed;</span>
<span class="line-added">+     CK_ULONG          ulSeedLen;</span>
<span class="line-added">+ } CK_KIP_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_KIP_PARAMS CK_PTR CK_KIP_PARAMS_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_AES_CTR_PARAMS {</span>
<span class="line-added">+     CK_ULONG ulCounterBits;</span>
<span class="line-added">+     CK_BYTE cb[16];</span>
<span class="line-added">+ } CK_AES_CTR_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_AES_CTR_PARAMS CK_PTR CK_AES_CTR_PARAMS_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_GCM_PARAMS {</span>
<span class="line-added">+     CK_BYTE_PTR       pIv;</span>
<span class="line-added">+     CK_ULONG          ulIvLen;</span>
<span class="line-added">+     CK_ULONG          ulIvBits;</span>
<span class="line-added">+     CK_BYTE_PTR       pAAD;</span>
<span class="line-added">+     CK_ULONG          ulAADLen;</span>
<span class="line-added">+     CK_ULONG          ulTagBits;</span>
<span class="line-added">+ } CK_GCM_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_GCM_PARAMS CK_PTR CK_GCM_PARAMS_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_CCM_PARAMS {</span>
<span class="line-added">+     CK_ULONG          ulDataLen;</span>
<span class="line-added">+     CK_BYTE_PTR       pNonce;</span>
<span class="line-added">+     CK_ULONG          ulNonceLen;</span>
<span class="line-added">+     CK_BYTE_PTR       pAAD;</span>
<span class="line-added">+     CK_ULONG          ulAADLen;</span>
<span class="line-added">+     CK_ULONG          ulMACLen;</span>
<span class="line-added">+ } CK_CCM_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_CCM_PARAMS CK_PTR CK_CCM_PARAMS_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ /* Deprecated. Use CK_GCM_PARAMS */</span>
<span class="line-added">+ typedef struct CK_AES_GCM_PARAMS {</span>
<span class="line-added">+   CK_BYTE_PTR pIv;</span>
<span class="line-added">+   CK_ULONG ulIvLen;</span>
<span class="line-added">+   CK_ULONG ulIvBits;</span>
<span class="line-added">+   CK_BYTE_PTR pAAD;</span>
<span class="line-added">+   CK_ULONG ulAADLen;</span>
<span class="line-added">+   CK_ULONG ulTagBits;</span>
<span class="line-added">+ } CK_AES_GCM_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_AES_GCM_PARAMS CK_PTR CK_AES_GCM_PARAMS_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ /* Deprecated. Use CK_CCM_PARAMS */</span>
<span class="line-added">+ typedef struct CK_AES_CCM_PARAMS {</span>
<span class="line-added">+     CK_ULONG          ulDataLen;</span>
<span class="line-added">+     CK_BYTE_PTR       pNonce;</span>
<span class="line-added">+     CK_ULONG          ulNonceLen;</span>
<span class="line-added">+     CK_BYTE_PTR       pAAD;</span>
<span class="line-added">+     CK_ULONG          ulAADLen;</span>
<span class="line-added">+     CK_ULONG          ulMACLen;</span>
<span class="line-added">+ } CK_AES_CCM_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_AES_CCM_PARAMS CK_PTR CK_AES_CCM_PARAMS_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_CAMELLIA_CTR_PARAMS {</span>
<span class="line-added">+     CK_ULONG          ulCounterBits;</span>
<span class="line-added">+     CK_BYTE           cb[16];</span>
<span class="line-added">+ } CK_CAMELLIA_CTR_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_CAMELLIA_CTR_PARAMS CK_PTR CK_CAMELLIA_CTR_PARAMS_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS {</span>
<span class="line-added">+     CK_BYTE           iv[16];</span>
<span class="line-added">+     CK_BYTE_PTR       pData;</span>
<span class="line-added">+     CK_ULONG          length;</span>
<span class="line-added">+ } CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS CK_PTR \</span>
<span class="line-added">+                                 CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_ARIA_CBC_ENCRYPT_DATA_PARAMS {</span>
<span class="line-added">+     CK_BYTE           iv[16];</span>
<span class="line-added">+     CK_BYTE_PTR       pData;</span>
<span class="line-added">+     CK_ULONG          length;</span>
<span class="line-added">+ } CK_ARIA_CBC_ENCRYPT_DATA_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_ARIA_CBC_ENCRYPT_DATA_PARAMS CK_PTR \</span>
<span class="line-added">+                                 CK_ARIA_CBC_ENCRYPT_DATA_PARAMS_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_DSA_PARAMETER_GEN_PARAM {</span>
<span class="line-added">+     CK_MECHANISM_TYPE  hash;</span>
<span class="line-added">+     CK_BYTE_PTR        pSeed;</span>
<span class="line-added">+     CK_ULONG           ulSeedLen;</span>
<span class="line-added">+     CK_ULONG           ulIndex;</span>
<span class="line-added">+ } CK_DSA_PARAMETER_GEN_PARAM;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_DSA_PARAMETER_GEN_PARAM CK_PTR CK_DSA_PARAMETER_GEN_PARAM_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_ECDH_AES_KEY_WRAP_PARAMS {</span>
<span class="line-added">+     CK_ULONG           ulAESKeyBits;</span>
<span class="line-added">+     CK_EC_KDF_TYPE     kdf;</span>
<span class="line-added">+     CK_ULONG           ulSharedDataLen;</span>
<span class="line-added">+     CK_BYTE_PTR        pSharedData;</span>
<span class="line-added">+ } CK_ECDH_AES_KEY_WRAP_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_ECDH_AES_KEY_WRAP_PARAMS CK_PTR CK_ECDH_AES_KEY_WRAP_PARAMS_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_ULONG CK_JAVA_MIDP_SECURITY_DOMAIN;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_ULONG CK_CERTIFICATE_CATEGORY;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_RSA_AES_KEY_WRAP_PARAMS {</span>
<span class="line-added">+     CK_ULONG                      ulAESKeyBits;</span>
<span class="line-added">+     CK_RSA_PKCS_OAEP_PARAMS_PTR   pOAEPParams;</span>
<span class="line-added">+ } CK_RSA_AES_KEY_WRAP_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_RSA_AES_KEY_WRAP_PARAMS CK_PTR CK_RSA_AES_KEY_WRAP_PARAMS_PTR;</span>
  
  typedef struct CK_TLS12_MASTER_KEY_DERIVE_PARAMS {
<span class="line-modified">!     CK_SSL3_RANDOM_DATA       RandomInfo;</span>
<span class="line-modified">!     CK_VERSION_PTR            pVersion;</span>
<span class="line-modified">!     CK_MECHANISM_TYPE         prfHashMechanism;</span>
  } CK_TLS12_MASTER_KEY_DERIVE_PARAMS;
  
<span class="line-modified">! typedef CK_TLS12_MASTER_KEY_DERIVE_PARAMS CK_PTR \</span>
<span class="line-added">+                                 CK_TLS12_MASTER_KEY_DERIVE_PARAMS_PTR;</span>
  
  typedef struct CK_TLS12_KEY_MAT_PARAMS {
<span class="line-modified">!     CK_ULONG                  ulMacSizeInBits;</span>
<span class="line-modified">!     CK_ULONG                  ulKeySizeInBits;</span>
<span class="line-modified">!     CK_ULONG                  ulIVSizeInBits;</span>
<span class="line-modified">!     CK_BBOOL                  bIsExport;</span>
<span class="line-modified">!     CK_SSL3_RANDOM_DATA       RandomInfo;</span>
<span class="line-modified">!     CK_SSL3_KEY_MAT_OUT_PTR   pReturnedKeyMaterial;</span>
<span class="line-modified">!     CK_MECHANISM_TYPE         prfHashMechanism;</span>
  } CK_TLS12_KEY_MAT_PARAMS;
  
  typedef CK_TLS12_KEY_MAT_PARAMS CK_PTR CK_TLS12_KEY_MAT_PARAMS_PTR;
  
<span class="line-added">+ typedef struct CK_TLS_KDF_PARAMS {</span>
<span class="line-added">+     CK_MECHANISM_TYPE         prfMechanism;</span>
<span class="line-added">+     CK_BYTE_PTR               pLabel;</span>
<span class="line-added">+     CK_ULONG                  ulLabelLength;</span>
<span class="line-added">+     CK_SSL3_RANDOM_DATA       RandomInfo;</span>
<span class="line-added">+     CK_BYTE_PTR               pContextData;</span>
<span class="line-added">+     CK_ULONG                  ulContextDataLength;</span>
<span class="line-added">+ } CK_TLS_KDF_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_TLS_KDF_PARAMS CK_PTR CK_TLS_KDF_PARAMS_PTR;</span>
<span class="line-added">+ </span>
  typedef struct CK_TLS_MAC_PARAMS {
<span class="line-modified">!     CK_MECHANISM_TYPE         prfHashMechanism;</span>
<span class="line-modified">!     CK_ULONG                  ulMacLength;</span>
<span class="line-modified">!     CK_ULONG                  ulServerOrClient;</span>
  } CK_TLS_MAC_PARAMS;
  
  typedef CK_TLS_MAC_PARAMS CK_PTR CK_TLS_MAC_PARAMS_PTR;
  
<span class="line-modified">! typedef struct CK_GOSTR3410_DERIVE_PARAMS {</span>
<span class="line-added">+     CK_EC_KDF_TYPE            kdf;</span>
<span class="line-added">+     CK_BYTE_PTR               pPublicData;</span>
<span class="line-added">+     CK_ULONG                  ulPublicDataLen;</span>
<span class="line-added">+     CK_BYTE_PTR               pUKM;</span>
<span class="line-added">+     CK_ULONG                  ulUKMLen;</span>
<span class="line-added">+ } CK_GOSTR3410_DERIVE_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_GOSTR3410_DERIVE_PARAMS CK_PTR CK_GOSTR3410_DERIVE_PARAMS_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_GOSTR3410_KEY_WRAP_PARAMS {</span>
<span class="line-added">+     CK_BYTE_PTR               pWrapOID;</span>
<span class="line-added">+     CK_ULONG                  ulWrapOIDLen;</span>
<span class="line-added">+     CK_BYTE_PTR               pUKM;</span>
<span class="line-added">+     CK_ULONG                  ulUKMLen;</span>
<span class="line-added">+     CK_OBJECT_HANDLE          hKey;</span>
<span class="line-added">+ } CK_GOSTR3410_KEY_WRAP_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_GOSTR3410_KEY_WRAP_PARAMS CK_PTR CK_GOSTR3410_KEY_WRAP_PARAMS_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef struct CK_SEED_CBC_ENCRYPT_DATA_PARAMS {</span>
<span class="line-added">+     CK_BYTE                   iv[16];</span>
<span class="line-added">+     CK_BYTE_PTR               pData;</span>
<span class="line-added">+     CK_ULONG                  length;</span>
<span class="line-added">+ } CK_SEED_CBC_ENCRYPT_DATA_PARAMS;</span>
<span class="line-added">+ </span>
<span class="line-added">+ typedef CK_SEED_CBC_ENCRYPT_DATA_PARAMS CK_PTR \</span>
<span class="line-added">+                                         CK_SEED_CBC_ENCRYPT_DATA_PARAMS_PTR;</span>
<span class="line-added">+ </span>
<span class="line-added">+ #endif /* _PKCS11T_H_ */</span>
<span class="line-added">+ </span>
<span class="line-added">+ </span>
</pre>
<center><a href="pkcs11f.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="pkcs11wrapper.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>