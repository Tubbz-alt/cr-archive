<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/jdk.crypto.cryptoki/share/native/libj2pkcs11/pkcs11t.h</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
  <body>
    <pre>
   1 /* pkcs11t.h include file for PKCS #11. */
   2 /* $Revision: 1.6 $ */
   3 
   4 /* License to copy and use this software is granted provided that it is
   5  * identified as &quot;RSA Security Inc. PKCS #11 Cryptographic Token Interface
   6  * (Cryptoki)&quot; in all material mentioning or referencing this software.
   7 
   8  * License is also granted to make and use derivative works provided that
   9  * such works are identified as &quot;derived from the RSA Security Inc. PKCS #11
  10  * Cryptographic Token Interface (Cryptoki)&quot; in all material mentioning or
  11  * referencing the derived work.
  12 
  13  * RSA Security Inc. makes no representations concerning either the
  14  * merchantability of this software or the suitability of this software for
  15  * any particular purpose. It is provided &quot;as is&quot; without express or implied
  16  * warranty of any kind.
  17  */
  18 
  19 /* See top of pkcs11.h for information about the macros that
  20  * must be defined and the structure-packing conventions that
  21  * must be set before including this file. */
  22 
  23 #ifndef _PKCS11T_H_
  24 #define _PKCS11T_H_ 1
  25 
  26 #define CK_TRUE 1
  27 #define CK_FALSE 0
  28 
  29 #ifndef CK_DISABLE_TRUE_FALSE
  30 #ifndef FALSE
  31 #define FALSE CK_FALSE
  32 #endif
  33 
  34 #ifndef TRUE
  35 #define TRUE CK_TRUE
  36 #endif
  37 #endif
  38 
  39 /* an unsigned 8-bit value */
  40 typedef unsigned char     CK_BYTE;
  41 
  42 /* an unsigned 8-bit character */
  43 typedef CK_BYTE           CK_CHAR;
  44 
  45 /* an 8-bit UTF-8 character */
  46 typedef CK_BYTE           CK_UTF8CHAR;
  47 
  48 /* a BYTE-sized Boolean flag */
  49 typedef CK_BYTE           CK_BBOOL;
  50 
  51 /* an unsigned value, at least 32 bits long */
  52 typedef unsigned long int CK_ULONG;
  53 
  54 /* a signed value, the same size as a CK_ULONG */
  55 /* CK_LONG is new for v2.0 */
  56 typedef long int          CK_LONG;
  57 
  58 /* at least 32 bits; each bit is a Boolean flag */
  59 typedef CK_ULONG          CK_FLAGS;
  60 
  61 
  62 /* some special values for certain CK_ULONG variables */
  63 #define CK_UNAVAILABLE_INFORMATION (~0UL)
  64 #define CK_EFFECTIVELY_INFINITE    0
  65 
  66 
  67 typedef CK_BYTE     CK_PTR   CK_BYTE_PTR;
  68 typedef CK_CHAR     CK_PTR   CK_CHAR_PTR;
  69 typedef CK_UTF8CHAR CK_PTR   CK_UTF8CHAR_PTR;
  70 typedef CK_ULONG    CK_PTR   CK_ULONG_PTR;
  71 typedef void        CK_PTR   CK_VOID_PTR;
  72 
  73 /* Pointer to a CK_VOID_PTR-- i.e., pointer to pointer to void */
  74 typedef CK_VOID_PTR CK_PTR CK_VOID_PTR_PTR;
  75 
  76 
  77 /* The following value is always invalid if used as a session */
  78 /* handle or object handle */
  79 #define CK_INVALID_HANDLE 0
  80 
  81 
  82 typedef struct CK_VERSION {
  83   CK_BYTE       major;  /* integer portion of version number */
  84   CK_BYTE       minor;  /* 1/100ths portion of version number */
  85 } CK_VERSION;
  86 
  87 typedef CK_VERSION CK_PTR CK_VERSION_PTR;
  88 
  89 
  90 typedef struct CK_INFO {
  91   /* manufacturerID and libraryDecription have been changed from
  92    * CK_CHAR to CK_UTF8CHAR for v2.10 */
  93   CK_VERSION    cryptokiVersion;     /* Cryptoki interface ver */
  94   CK_UTF8CHAR   manufacturerID[32];  /* blank padded */
  95   CK_FLAGS      flags;               /* must be zero */
  96 
  97   /* libraryDescription and libraryVersion are new for v2.0 */
  98   CK_UTF8CHAR   libraryDescription[32];  /* blank padded */
  99   CK_VERSION    libraryVersion;          /* version of library */
 100 } CK_INFO;
 101 
 102 typedef CK_INFO CK_PTR    CK_INFO_PTR;
 103 
 104 
 105 /* CK_NOTIFICATION enumerates the types of notifications that
 106  * Cryptoki provides to an application */
 107 /* CK_NOTIFICATION has been changed from an enum to a CK_ULONG
 108  * for v2.0 */
 109 typedef CK_ULONG CK_NOTIFICATION;
 110 #define CKN_SURRENDER       0
 111 
 112 
 113 typedef CK_ULONG          CK_SLOT_ID;
 114 
 115 typedef CK_SLOT_ID CK_PTR CK_SLOT_ID_PTR;
 116 
 117 
 118 /* CK_SLOT_INFO provides information about a slot */
 119 typedef struct CK_SLOT_INFO {
 120   /* slotDescription and manufacturerID have been changed from
 121    * CK_CHAR to CK_UTF8CHAR for v2.10 */
 122   CK_UTF8CHAR   slotDescription[64];  /* blank padded */
 123   CK_UTF8CHAR   manufacturerID[32];   /* blank padded */
 124   CK_FLAGS      flags;
 125 
 126   /* hardwareVersion and firmwareVersion are new for v2.0 */
 127   CK_VERSION    hardwareVersion;  /* version of hardware */
 128   CK_VERSION    firmwareVersion;  /* version of firmware */
 129 } CK_SLOT_INFO;
 130 
 131 /* flags: bit flags that provide capabilities of the slot
 132  *      Bit Flag              Mask        Meaning
 133  */
 134 #define CKF_TOKEN_PRESENT     0x00000001  /* a token is there */
 135 #define CKF_REMOVABLE_DEVICE  0x00000002  /* removable devices*/
 136 #define CKF_HW_SLOT           0x00000004  /* hardware slot */
 137 
 138 typedef CK_SLOT_INFO CK_PTR CK_SLOT_INFO_PTR;
 139 
 140 
 141 /* CK_TOKEN_INFO provides information about a token */
 142 typedef struct CK_TOKEN_INFO {
 143   /* label, manufacturerID, and model have been changed from
 144    * CK_CHAR to CK_UTF8CHAR for v2.10 */
 145   CK_UTF8CHAR   label[32];           /* blank padded */
 146   CK_UTF8CHAR   manufacturerID[32];  /* blank padded */
 147   CK_UTF8CHAR   model[16];           /* blank padded */
 148   CK_CHAR       serialNumber[16];    /* blank padded */
 149   CK_FLAGS      flags;               /* see below */
 150 
 151   /* ulMaxSessionCount, ulSessionCount, ulMaxRwSessionCount,
 152    * ulRwSessionCount, ulMaxPinLen, and ulMinPinLen have all been
 153    * changed from CK_USHORT to CK_ULONG for v2.0 */
 154   CK_ULONG      ulMaxSessionCount;     /* max open sessions */
 155   CK_ULONG      ulSessionCount;        /* sess. now open */
 156   CK_ULONG      ulMaxRwSessionCount;   /* max R/W sessions */
 157   CK_ULONG      ulRwSessionCount;      /* R/W sess. now open */
 158   CK_ULONG      ulMaxPinLen;           /* in bytes */
 159   CK_ULONG      ulMinPinLen;           /* in bytes */
 160   CK_ULONG      ulTotalPublicMemory;   /* in bytes */
 161   CK_ULONG      ulFreePublicMemory;    /* in bytes */
 162   CK_ULONG      ulTotalPrivateMemory;  /* in bytes */
 163   CK_ULONG      ulFreePrivateMemory;   /* in bytes */
 164 
 165   /* hardwareVersion, firmwareVersion, and time are new for
 166    * v2.0 */
 167   CK_VERSION    hardwareVersion;       /* version of hardware */
 168   CK_VERSION    firmwareVersion;       /* version of firmware */
 169   CK_CHAR       utcTime[16];           /* time */
 170 } CK_TOKEN_INFO;
 171 
 172 /* The flags parameter is defined as follows:
 173  *      Bit Flag                    Mask        Meaning
 174  */
 175 #define CKF_RNG                     0x00000001  /* has random #
 176                                                  * generator */
 177 #define CKF_WRITE_PROTECTED         0x00000002  /* token is
 178                                                  * write-
 179                                                  * protected */
 180 #define CKF_LOGIN_REQUIRED          0x00000004  /* user must
 181                                                  * login */
 182 #define CKF_USER_PIN_INITIALIZED    0x00000008  /* normal user&#39;s
 183                                                  * PIN is set */
 184 
 185 /* CKF_RESTORE_KEY_NOT_NEEDED is new for v2.0.  If it is set,
 186  * that means that *every* time the state of cryptographic
 187  * operations of a session is successfully saved, all keys
 188  * needed to continue those operations are stored in the state */
 189 #define CKF_RESTORE_KEY_NOT_NEEDED  0x00000020
 190 
 191 /* CKF_CLOCK_ON_TOKEN is new for v2.0.  If it is set, that means
 192  * that the token has some sort of clock.  The time on that
 193  * clock is returned in the token info structure */
 194 #define CKF_CLOCK_ON_TOKEN          0x00000040
 195 
 196 /* CKF_PROTECTED_AUTHENTICATION_PATH is new for v2.0.  If it is
 197  * set, that means that there is some way for the user to login
 198  * without sending a PIN through the Cryptoki library itself */
 199 #define CKF_PROTECTED_AUTHENTICATION_PATH 0x00000100
 200 
 201 /* CKF_DUAL_CRYPTO_OPERATIONS is new for v2.0.  If it is true,
 202  * that means that a single session with the token can perform
 203  * dual simultaneous cryptographic operations (digest and
 204  * encrypt; decrypt and digest; sign and encrypt; and decrypt
 205  * and sign) */
 206 #define CKF_DUAL_CRYPTO_OPERATIONS  0x00000200
 207 
 208 /* CKF_TOKEN_INITIALIZED if new for v2.10. If it is true, the
 209  * token has been initialized using C_InitializeToken or an
 210  * equivalent mechanism outside the scope of PKCS #11.
 211  * Calling C_InitializeToken when this flag is set will cause
 212  * the token to be reinitialized. */
 213 #define CKF_TOKEN_INITIALIZED       0x00000400
 214 
 215 /* CKF_SECONDARY_AUTHENTICATION if new for v2.10. If it is
 216  * true, the token supports secondary authentication for
 217  * private key objects. This flag is deprecated in v2.11 and
 218    onwards. */
 219 #define CKF_SECONDARY_AUTHENTICATION  0x00000800
 220 
 221 /* CKF_USER_PIN_COUNT_LOW if new for v2.10. If it is true, an
 222  * incorrect user login PIN has been entered at least once
 223  * since the last successful authentication. */
 224 #define CKF_USER_PIN_COUNT_LOW       0x00010000
 225 
 226 /* CKF_USER_PIN_FINAL_TRY if new for v2.10. If it is true,
 227  * supplying an incorrect user PIN will it to become locked. */
 228 #define CKF_USER_PIN_FINAL_TRY       0x00020000
 229 
 230 /* CKF_USER_PIN_LOCKED if new for v2.10. If it is true, the
 231  * user PIN has been locked. User login to the token is not
 232  * possible. */
 233 #define CKF_USER_PIN_LOCKED          0x00040000
 234 
 235 /* CKF_USER_PIN_TO_BE_CHANGED if new for v2.10. If it is true,
 236  * the user PIN value is the default value set by token
 237  * initialization or manufacturing, or the PIN has been
 238  * expired by the card. */
 239 #define CKF_USER_PIN_TO_BE_CHANGED   0x00080000
 240 
 241 /* CKF_SO_PIN_COUNT_LOW if new for v2.10. If it is true, an
 242  * incorrect SO login PIN has been entered at least once since
 243  * the last successful authentication. */
 244 #define CKF_SO_PIN_COUNT_LOW         0x00100000
 245 
 246 /* CKF_SO_PIN_FINAL_TRY if new for v2.10. If it is true,
 247  * supplying an incorrect SO PIN will it to become locked. */
 248 #define CKF_SO_PIN_FINAL_TRY         0x00200000
 249 
 250 /* CKF_SO_PIN_LOCKED if new for v2.10. If it is true, the SO
 251  * PIN has been locked. SO login to the token is not possible.
 252  */
 253 #define CKF_SO_PIN_LOCKED            0x00400000
 254 
 255 /* CKF_SO_PIN_TO_BE_CHANGED if new for v2.10. If it is true,
 256  * the SO PIN value is the default value set by token
 257  * initialization or manufacturing, or the PIN has been
 258  * expired by the card. */
 259 #define CKF_SO_PIN_TO_BE_CHANGED     0x00800000
 260 
 261 typedef CK_TOKEN_INFO CK_PTR CK_TOKEN_INFO_PTR;
 262 
 263 
 264 /* CK_SESSION_HANDLE is a Cryptoki-assigned value that
 265  * identifies a session */
 266 typedef CK_ULONG          CK_SESSION_HANDLE;
 267 
 268 typedef CK_SESSION_HANDLE CK_PTR CK_SESSION_HANDLE_PTR;
 269 
 270 
 271 /* CK_USER_TYPE enumerates the types of Cryptoki users */
 272 /* CK_USER_TYPE has been changed from an enum to a CK_ULONG for
 273  * v2.0 */
 274 typedef CK_ULONG          CK_USER_TYPE;
 275 /* Security Officer */
 276 #define CKU_SO    0
 277 /* Normal user */
 278 #define CKU_USER  1
 279 /* Context specific (added in v2.20) */
 280 #define CKU_CONTEXT_SPECIFIC   2
 281 
 282 /* CK_STATE enumerates the session states */
 283 /* CK_STATE has been changed from an enum to a CK_ULONG for
 284  * v2.0 */
 285 typedef CK_ULONG          CK_STATE;
 286 #define CKS_RO_PUBLIC_SESSION  0
 287 #define CKS_RO_USER_FUNCTIONS  1
 288 #define CKS_RW_PUBLIC_SESSION  2
 289 #define CKS_RW_USER_FUNCTIONS  3
 290 #define CKS_RW_SO_FUNCTIONS    4
 291 
 292 
 293 /* CK_SESSION_INFO provides information about a session */
 294 typedef struct CK_SESSION_INFO {
 295   CK_SLOT_ID    slotID;
 296   CK_STATE      state;
 297   CK_FLAGS      flags;          /* see below */
 298 
 299   /* ulDeviceError was changed from CK_USHORT to CK_ULONG for
 300    * v2.0 */
 301   CK_ULONG      ulDeviceError;  /* device-dependent error code */
 302 } CK_SESSION_INFO;
 303 
 304 /* The flags are defined in the following table:
 305  *      Bit Flag                Mask        Meaning
 306  */
 307 #define CKF_RW_SESSION          0x00000002  /* session is r/w */
 308 #define CKF_SERIAL_SESSION      0x00000004  /* no parallel */
 309 
 310 typedef CK_SESSION_INFO CK_PTR CK_SESSION_INFO_PTR;
 311 
 312 
 313 /* CK_OBJECT_HANDLE is a token-specific identifier for an
 314  * object  */
 315 typedef CK_ULONG          CK_OBJECT_HANDLE;
 316 
 317 typedef CK_OBJECT_HANDLE CK_PTR CK_OBJECT_HANDLE_PTR;
 318 
 319 
 320 /* CK_OBJECT_CLASS is a value that identifies the classes (or
 321  * types) of objects that Cryptoki recognizes.  It is defined
 322  * as follows: */
 323 /* CK_OBJECT_CLASS was changed from CK_USHORT to CK_ULONG for
 324  * v2.0 */
 325 typedef CK_ULONG          CK_OBJECT_CLASS;
 326 
 327 /* The following classes of objects are defined: */
 328 /* CKO_HW_FEATURE is new for v2.10 */
 329 /* CKO_DOMAIN_PARAMETERS is new for v2.11 */
 330 /* CKO_MECHANISM is new for v2.20 */
 331 #define CKO_DATA              0x00000000
 332 #define CKO_CERTIFICATE       0x00000001
 333 #define CKO_PUBLIC_KEY        0x00000002
 334 #define CKO_PRIVATE_KEY       0x00000003
 335 #define CKO_SECRET_KEY        0x00000004
 336 #define CKO_HW_FEATURE        0x00000005
 337 #define CKO_DOMAIN_PARAMETERS 0x00000006
 338 #define CKO_MECHANISM         0x00000007
 339 #define CKO_VENDOR_DEFINED    0x80000000
 340 
 341 typedef CK_OBJECT_CLASS CK_PTR CK_OBJECT_CLASS_PTR;
 342 
 343 /* CK_HW_FEATURE_TYPE is new for v2.10. CK_HW_FEATURE_TYPE is a
 344  * value that identifies the hardware feature type of an object
 345  * with CK_OBJECT_CLASS equal to CKO_HW_FEATURE. */
 346 typedef CK_ULONG          CK_HW_FEATURE_TYPE;
 347 
 348 /* The following hardware feature types are defined */
 349 /* CKH_USER_INTERFACE is new for v2.20 */
 350 #define CKH_MONOTONIC_COUNTER  0x00000001
 351 #define CKH_CLOCK           0x00000002
 352 #define CKH_USER_INTERFACE  0x00000003
 353 #define CKH_VENDOR_DEFINED  0x80000000
 354 
 355 /* CK_KEY_TYPE is a value that identifies a key type */
 356 /* CK_KEY_TYPE was changed from CK_USHORT to CK_ULONG for v2.0 */
 357 typedef CK_ULONG          CK_KEY_TYPE;
 358 
 359 /* the following key types are defined: */
 360 #define CKK_RSA             0x00000000
 361 #define CKK_DSA             0x00000001
 362 #define CKK_DH              0x00000002
 363 
 364 /* CKK_ECDSA and CKK_KEA are new for v2.0 */
 365 /* CKK_ECDSA is deprecated in v2.11, CKK_EC is preferred. */
 366 #define CKK_ECDSA           0x00000003
 367 #define CKK_EC              0x00000003
 368 #define CKK_X9_42_DH        0x00000004
 369 #define CKK_KEA             0x00000005
 370 
 371 #define CKK_GENERIC_SECRET  0x00000010
 372 #define CKK_RC2             0x00000011
 373 #define CKK_RC4             0x00000012
 374 #define CKK_DES             0x00000013
 375 #define CKK_DES2            0x00000014
 376 #define CKK_DES3            0x00000015
 377 
 378 /* all these key types are new for v2.0 */
 379 #define CKK_CAST            0x00000016
 380 #define CKK_CAST3           0x00000017
 381 /* CKK_CAST5 is deprecated in v2.11, CKK_CAST128 is preferred. */
 382 #define CKK_CAST5           0x00000018
 383 #define CKK_CAST128         0x00000018
 384 #define CKK_RC5             0x00000019
 385 #define CKK_IDEA            0x0000001A
 386 #define CKK_SKIPJACK        0x0000001B
 387 #define CKK_BATON           0x0000001C
 388 #define CKK_JUNIPER         0x0000001D
 389 #define CKK_CDMF            0x0000001E
 390 #define CKK_AES             0x0000001F
 391 
 392 /* BlowFish and TwoFish are new for v2.20 */
 393 #define CKK_BLOWFISH        0x00000020
 394 #define CKK_TWOFISH         0x00000021
 395 
 396 #define CKK_VENDOR_DEFINED  0x80000000
 397 
 398 
 399 /* CK_CERTIFICATE_TYPE is a value that identifies a certificate
 400  * type */
 401 /* CK_CERTIFICATE_TYPE was changed from CK_USHORT to CK_ULONG
 402  * for v2.0 */
 403 typedef CK_ULONG          CK_CERTIFICATE_TYPE;
 404 
 405 /* The following certificate types are defined: */
 406 /* CKC_X_509_ATTR_CERT is new for v2.10 */
 407 /* CKC_WTLS is new for v2.20 */
 408 #define CKC_X_509           0x00000000
 409 #define CKC_X_509_ATTR_CERT 0x00000001
 410 #define CKC_WTLS            0x00000002
 411 #define CKC_VENDOR_DEFINED  0x80000000
 412 
 413 
 414 /* CK_ATTRIBUTE_TYPE is a value that identifies an attribute
 415  * type */
 416 /* CK_ATTRIBUTE_TYPE was changed from CK_USHORT to CK_ULONG for
 417  * v2.0 */
 418 typedef CK_ULONG          CK_ATTRIBUTE_TYPE;
 419 
 420 /* The CKF_ARRAY_ATTRIBUTE flag identifies an attribute which
 421    consists of an array of values. */
 422 #define CKF_ARRAY_ATTRIBUTE    0x40000000
 423 
 424 /* The following attribute types are defined: */
 425 #define CKA_CLASS              0x00000000
 426 #define CKA_TOKEN              0x00000001
 427 #define CKA_PRIVATE            0x00000002
 428 #define CKA_LABEL              0x00000003
 429 #define CKA_APPLICATION        0x00000010
 430 #define CKA_VALUE              0x00000011
 431 
 432 /* CKA_OBJECT_ID is new for v2.10 */
 433 #define CKA_OBJECT_ID          0x00000012
 434 
 435 #define CKA_CERTIFICATE_TYPE   0x00000080
 436 #define CKA_ISSUER             0x00000081
 437 #define CKA_SERIAL_NUMBER      0x00000082
 438 
 439 /* CKA_AC_ISSUER, CKA_OWNER, and CKA_ATTR_TYPES are new
 440  * for v2.10 */
 441 #define CKA_AC_ISSUER          0x00000083
 442 #define CKA_OWNER              0x00000084
 443 #define CKA_ATTR_TYPES         0x00000085
 444 
 445 /* CKA_TRUSTED is new for v2.11 */
 446 #define CKA_TRUSTED            0x00000086
 447 
 448 /* CKA_CERTIFICATE_CATEGORY ...
 449  * CKA_CHECK_VALUE are new for v2.20 */
 450 #define CKA_CERTIFICATE_CATEGORY        0x00000087
 451 #define CKA_JAVA_MIDP_SECURITY_DOMAIN   0x00000088
 452 #define CKA_URL                         0x00000089
 453 #define CKA_HASH_OF_SUBJECT_PUBLIC_KEY  0x0000008A
 454 #define CKA_HASH_OF_ISSUER_PUBLIC_KEY   0x0000008B
 455 #define CKA_CHECK_VALUE                 0x00000090
 456 
 457 #define CKA_KEY_TYPE           0x00000100
 458 #define CKA_SUBJECT            0x00000101
 459 #define CKA_ID                 0x00000102
 460 #define CKA_SENSITIVE          0x00000103
 461 #define CKA_ENCRYPT            0x00000104
 462 #define CKA_DECRYPT            0x00000105
 463 #define CKA_WRAP               0x00000106
 464 #define CKA_UNWRAP             0x00000107
 465 #define CKA_SIGN               0x00000108
 466 #define CKA_SIGN_RECOVER       0x00000109
 467 #define CKA_VERIFY             0x0000010A
 468 #define CKA_VERIFY_RECOVER     0x0000010B
 469 #define CKA_DERIVE             0x0000010C
 470 #define CKA_START_DATE         0x00000110
 471 #define CKA_END_DATE           0x00000111
 472 #define CKA_MODULUS            0x00000120
 473 #define CKA_MODULUS_BITS       0x00000121
 474 #define CKA_PUBLIC_EXPONENT    0x00000122
 475 #define CKA_PRIVATE_EXPONENT   0x00000123
 476 #define CKA_PRIME_1            0x00000124
 477 #define CKA_PRIME_2            0x00000125
 478 #define CKA_EXPONENT_1         0x00000126
 479 #define CKA_EXPONENT_2         0x00000127
 480 #define CKA_COEFFICIENT        0x00000128
 481 #define CKA_PRIME              0x00000130
 482 #define CKA_SUBPRIME           0x00000131
 483 #define CKA_BASE               0x00000132
 484 
 485 /* CKA_PRIME_BITS and CKA_SUB_PRIME_BITS are new for v2.11 */
 486 #define CKA_PRIME_BITS         0x00000133
 487 #define CKA_SUBPRIME_BITS      0x00000134
 488 #define CKA_SUB_PRIME_BITS     CKA_SUBPRIME_BITS
 489 /* (To retain backwards-compatibility) */
 490 
 491 #define CKA_VALUE_BITS         0x00000160
 492 #define CKA_VALUE_LEN          0x00000161
 493 
 494 /* CKA_EXTRACTABLE, CKA_LOCAL, CKA_NEVER_EXTRACTABLE,
 495  * CKA_ALWAYS_SENSITIVE, CKA_MODIFIABLE, CKA_ECDSA_PARAMS,
 496  * and CKA_EC_POINT are new for v2.0 */
 497 #define CKA_EXTRACTABLE        0x00000162
 498 #define CKA_LOCAL              0x00000163
 499 #define CKA_NEVER_EXTRACTABLE  0x00000164
 500 #define CKA_ALWAYS_SENSITIVE   0x00000165
 501 
 502 /* CKA_KEY_GEN_MECHANISM is new for v2.11 */
 503 #define CKA_KEY_GEN_MECHANISM  0x00000166
 504 
 505 #define CKA_MODIFIABLE         0x00000170
 506 
 507 /* CKA_ECDSA_PARAMS is deprecated in v2.11,
 508  * CKA_EC_PARAMS is preferred. */
 509 #define CKA_ECDSA_PARAMS       0x00000180
 510 #define CKA_EC_PARAMS          0x00000180
 511 
 512 #define CKA_EC_POINT           0x00000181
 513 
 514 /* CKA_SECONDARY_AUTH, CKA_AUTH_PIN_FLAGS,
 515  * are new for v2.10. Deprecated in v2.11 and onwards. */
 516 #define CKA_SECONDARY_AUTH     0x00000200
 517 #define CKA_AUTH_PIN_FLAGS     0x00000201
 518 
 519 /* CKA_ALWAYS_AUTHENTICATE ...
 520  * CKA_UNWRAP_TEMPLATE are new for v2.20 */
 521 #define CKA_ALWAYS_AUTHENTICATE  0x00000202
 522 
 523 #define CKA_WRAP_WITH_TRUSTED    0x00000210
 524 #define CKA_WRAP_TEMPLATE        (CKF_ARRAY_ATTRIBUTE|0x00000211)
 525 #define CKA_UNWRAP_TEMPLATE      (CKF_ARRAY_ATTRIBUTE|0x00000212)
 526 
 527 /* CKA_HW_FEATURE_TYPE, CKA_RESET_ON_INIT, and CKA_HAS_RESET
 528  * are new for v2.10 */
 529 #define CKA_HW_FEATURE_TYPE    0x00000300
 530 #define CKA_RESET_ON_INIT      0x00000301
 531 #define CKA_HAS_RESET          0x00000302
 532 
 533 /* The following attributes are new for v2.20 */
 534 #define CKA_PIXEL_X                     0x00000400
 535 #define CKA_PIXEL_Y                     0x00000401
 536 #define CKA_RESOLUTION                  0x00000402
 537 #define CKA_CHAR_ROWS                   0x00000403
 538 #define CKA_CHAR_COLUMNS                0x00000404
 539 #define CKA_COLOR                       0x00000405
 540 #define CKA_BITS_PER_PIXEL              0x00000406
 541 #define CKA_CHAR_SETS                   0x00000480
 542 #define CKA_ENCODING_METHODS            0x00000481
 543 #define CKA_MIME_TYPES                  0x00000482
 544 #define CKA_MECHANISM_TYPE              0x00000500
 545 #define CKA_REQUIRED_CMS_ATTRIBUTES     0x00000501
 546 #define CKA_DEFAULT_CMS_ATTRIBUTES      0x00000502
 547 #define CKA_SUPPORTED_CMS_ATTRIBUTES    0x00000503
 548 #define CKA_ALLOWED_MECHANISMS          (CKF_ARRAY_ATTRIBUTE|0x00000600)
 549 
 550 #define CKA_VENDOR_DEFINED     0x80000000
 551 #define CKA_NETSCAPE_DB        0xD5A0DB00
 552 
 553 
 554 /* CK_ATTRIBUTE is a structure that includes the type, length
 555  * and value of an attribute */
 556 typedef struct CK_ATTRIBUTE {
 557   CK_ATTRIBUTE_TYPE type;
 558   CK_VOID_PTR       pValue;
 559 
 560   /* ulValueLen went from CK_USHORT to CK_ULONG for v2.0 */
 561   CK_ULONG          ulValueLen;  /* in bytes */
 562 } CK_ATTRIBUTE;
 563 
 564 typedef CK_ATTRIBUTE CK_PTR CK_ATTRIBUTE_PTR;
 565 
 566 
 567 /* CK_DATE is a structure that defines a date */
 568 typedef struct CK_DATE{
 569   CK_CHAR       year[4];   /* the year (&quot;1900&quot; - &quot;9999&quot;) */
 570   CK_CHAR       month[2];  /* the month (&quot;01&quot; - &quot;12&quot;) */
 571   CK_CHAR       day[2];    /* the day   (&quot;01&quot; - &quot;31&quot;) */
 572 } CK_DATE;
 573 
 574 
 575 /* CK_MECHANISM_TYPE is a value that identifies a mechanism
 576  * type */
 577 /* CK_MECHANISM_TYPE was changed from CK_USHORT to CK_ULONG for
 578  * v2.0 */
 579 typedef CK_ULONG          CK_MECHANISM_TYPE;
 580 
 581 /* the following mechanism types are defined: */
 582 #define CKM_RSA_PKCS_KEY_PAIR_GEN      0x00000000
 583 #define CKM_RSA_PKCS                   0x00000001
 584 #define CKM_RSA_9796                   0x00000002
 585 #define CKM_RSA_X_509                  0x00000003
 586 
 587 /* CKM_MD2_RSA_PKCS, CKM_MD5_RSA_PKCS, and CKM_SHA1_RSA_PKCS
 588  * are new for v2.0.  They are mechanisms which hash and sign */
 589 #define CKM_MD2_RSA_PKCS               0x00000004
 590 #define CKM_MD5_RSA_PKCS               0x00000005
 591 #define CKM_SHA1_RSA_PKCS              0x00000006
 592 
 593 /* CKM_RIPEMD128_RSA_PKCS, CKM_RIPEMD160_RSA_PKCS, and
 594  * CKM_RSA_PKCS_OAEP are new for v2.10 */
 595 #define CKM_RIPEMD128_RSA_PKCS         0x00000007
 596 #define CKM_RIPEMD160_RSA_PKCS         0x00000008
 597 #define CKM_RSA_PKCS_OAEP              0x00000009
 598 
 599 /* CKM_RSA_X9_31_KEY_PAIR_GEN, CKM_RSA_X9_31, CKM_SHA1_RSA_X9_31,
 600  * CKM_RSA_PKCS_PSS, and CKM_SHA1_RSA_PKCS_PSS are new for v2.11 */
 601 #define CKM_RSA_X9_31_KEY_PAIR_GEN     0x0000000A
 602 #define CKM_RSA_X9_31                  0x0000000B
 603 #define CKM_SHA1_RSA_X9_31             0x0000000C
 604 #define CKM_RSA_PKCS_PSS               0x0000000D
 605 #define CKM_SHA1_RSA_PKCS_PSS          0x0000000E
 606 
 607 #define CKM_DSA_KEY_PAIR_GEN           0x00000010
 608 #define CKM_DSA                        0x00000011
 609 #define CKM_DSA_SHA1                   0x00000012
 610 #define CKM_DH_PKCS_KEY_PAIR_GEN       0x00000020
 611 #define CKM_DH_PKCS_DERIVE             0x00000021
 612 
 613 /* CKM_X9_42_DH_KEY_PAIR_GEN, CKM_X9_42_DH_DERIVE,
 614  * CKM_X9_42_DH_HYBRID_DERIVE, and CKM_X9_42_MQV_DERIVE are new for
 615  * v2.11 */
 616 #define CKM_X9_42_DH_KEY_PAIR_GEN      0x00000030
 617 #define CKM_X9_42_DH_DERIVE            0x00000031
 618 #define CKM_X9_42_DH_HYBRID_DERIVE     0x00000032
 619 #define CKM_X9_42_MQV_DERIVE           0x00000033
 620 
 621 /* CKM_SHA256/384/512 are new for v2.20 */
 622 #define CKM_SHA256_RSA_PKCS            0x00000040
 623 #define CKM_SHA384_RSA_PKCS            0x00000041
 624 #define CKM_SHA512_RSA_PKCS            0x00000042
 625 #define CKM_SHA256_RSA_PKCS_PSS        0x00000043
 626 #define CKM_SHA384_RSA_PKCS_PSS        0x00000044
 627 #define CKM_SHA512_RSA_PKCS_PSS        0x00000045
 628 
 629 #define CKM_RC2_KEY_GEN                0x00000100
 630 #define CKM_RC2_ECB                    0x00000101
 631 #define CKM_RC2_CBC                    0x00000102
 632 #define CKM_RC2_MAC                    0x00000103
 633 
 634 /* CKM_RC2_MAC_GENERAL and CKM_RC2_CBC_PAD are new for v2.0 */
 635 #define CKM_RC2_MAC_GENERAL            0x00000104
 636 #define CKM_RC2_CBC_PAD                0x00000105
 637 
 638 #define CKM_RC4_KEY_GEN                0x00000110
 639 #define CKM_RC4                        0x00000111
 640 #define CKM_DES_KEY_GEN                0x00000120
 641 #define CKM_DES_ECB                    0x00000121
 642 #define CKM_DES_CBC                    0x00000122
 643 #define CKM_DES_MAC                    0x00000123
 644 
 645 /* CKM_DES_MAC_GENERAL and CKM_DES_CBC_PAD are new for v2.0 */
 646 #define CKM_DES_MAC_GENERAL            0x00000124
 647 #define CKM_DES_CBC_PAD                0x00000125
 648 
 649 #define CKM_DES2_KEY_GEN               0x00000130
 650 #define CKM_DES3_KEY_GEN               0x00000131
 651 #define CKM_DES3_ECB                   0x00000132
 652 #define CKM_DES3_CBC                   0x00000133
 653 #define CKM_DES3_MAC                   0x00000134
 654 
 655 /* CKM_DES3_MAC_GENERAL, CKM_DES3_CBC_PAD, CKM_CDMF_KEY_GEN,
 656  * CKM_CDMF_ECB, CKM_CDMF_CBC, CKM_CDMF_MAC,
 657  * CKM_CDMF_MAC_GENERAL, and CKM_CDMF_CBC_PAD are new for v2.0 */
 658 #define CKM_DES3_MAC_GENERAL           0x00000135
 659 #define CKM_DES3_CBC_PAD               0x00000136
 660 #define CKM_CDMF_KEY_GEN               0x00000140
 661 #define CKM_CDMF_ECB                   0x00000141
 662 #define CKM_CDMF_CBC                   0x00000142
 663 #define CKM_CDMF_MAC                   0x00000143
 664 #define CKM_CDMF_MAC_GENERAL           0x00000144
 665 #define CKM_CDMF_CBC_PAD               0x00000145
 666 
 667 /* the following four DES mechanisms are new for v2.20 */
 668 #define CKM_DES_OFB64                  0x00000150
 669 #define CKM_DES_OFB8                   0x00000151
 670 #define CKM_DES_CFB64                  0x00000152
 671 #define CKM_DES_CFB8                   0x00000153
 672 
 673 #define CKM_MD2                        0x00000200
 674 
 675 /* CKM_MD2_HMAC and CKM_MD2_HMAC_GENERAL are new for v2.0 */
 676 #define CKM_MD2_HMAC                   0x00000201
 677 #define CKM_MD2_HMAC_GENERAL           0x00000202
 678 
 679 #define CKM_MD5                        0x00000210
 680 
 681 /* CKM_MD5_HMAC and CKM_MD5_HMAC_GENERAL are new for v2.0 */
 682 #define CKM_MD5_HMAC                   0x00000211
 683 #define CKM_MD5_HMAC_GENERAL           0x00000212
 684 
 685 #define CKM_SHA_1                      0x00000220
 686 
 687 /* CKM_SHA_1_HMAC and CKM_SHA_1_HMAC_GENERAL are new for v2.0 */
 688 #define CKM_SHA_1_HMAC                 0x00000221
 689 #define CKM_SHA_1_HMAC_GENERAL         0x00000222
 690 
 691 /* CKM_RIPEMD128, CKM_RIPEMD128_HMAC,
 692  * CKM_RIPEMD128_HMAC_GENERAL, CKM_RIPEMD160, CKM_RIPEMD160_HMAC,
 693  * and CKM_RIPEMD160_HMAC_GENERAL are new for v2.10 */
 694 #define CKM_RIPEMD128                  0x00000230
 695 #define CKM_RIPEMD128_HMAC             0x00000231
 696 #define CKM_RIPEMD128_HMAC_GENERAL     0x00000232
 697 #define CKM_RIPEMD160                  0x00000240
 698 #define CKM_RIPEMD160_HMAC             0x00000241
 699 #define CKM_RIPEMD160_HMAC_GENERAL     0x00000242
 700 
 701 /* CKM_SHA256/384/512 are new for v2.20 */
 702 #define CKM_SHA256                     0x00000250
 703 #define CKM_SHA256_HMAC                0x00000251
 704 #define CKM_SHA256_HMAC_GENERAL        0x00000252
 705 #define CKM_SHA384                     0x00000260
 706 #define CKM_SHA384_HMAC                0x00000261
 707 #define CKM_SHA384_HMAC_GENERAL        0x00000262
 708 #define CKM_SHA512                     0x00000270
 709 #define CKM_SHA512_HMAC                0x00000271
 710 #define CKM_SHA512_HMAC_GENERAL        0x00000272
 711 
 712 /* All of the following mechanisms are new for v2.0 */
 713 /* Note that CAST128 and CAST5 are the same algorithm */
 714 #define CKM_CAST_KEY_GEN               0x00000300
 715 #define CKM_CAST_ECB                   0x00000301
 716 #define CKM_CAST_CBC                   0x00000302
 717 #define CKM_CAST_MAC                   0x00000303
 718 #define CKM_CAST_MAC_GENERAL           0x00000304
 719 #define CKM_CAST_CBC_PAD               0x00000305
 720 #define CKM_CAST3_KEY_GEN              0x00000310
 721 #define CKM_CAST3_ECB                  0x00000311
 722 #define CKM_CAST3_CBC                  0x00000312
 723 #define CKM_CAST3_MAC                  0x00000313
 724 #define CKM_CAST3_MAC_GENERAL          0x00000314
 725 #define CKM_CAST3_CBC_PAD              0x00000315
 726 #define CKM_CAST5_KEY_GEN              0x00000320
 727 #define CKM_CAST128_KEY_GEN            0x00000320
 728 #define CKM_CAST5_ECB                  0x00000321
 729 #define CKM_CAST128_ECB                0x00000321
 730 #define CKM_CAST5_CBC                  0x00000322
 731 #define CKM_CAST128_CBC                0x00000322
 732 #define CKM_CAST5_MAC                  0x00000323
 733 #define CKM_CAST128_MAC                0x00000323
 734 #define CKM_CAST5_MAC_GENERAL          0x00000324
 735 #define CKM_CAST128_MAC_GENERAL        0x00000324
 736 #define CKM_CAST5_CBC_PAD              0x00000325
 737 #define CKM_CAST128_CBC_PAD            0x00000325
 738 #define CKM_RC5_KEY_GEN                0x00000330
 739 #define CKM_RC5_ECB                    0x00000331
 740 #define CKM_RC5_CBC                    0x00000332
 741 #define CKM_RC5_MAC                    0x00000333
 742 #define CKM_RC5_MAC_GENERAL            0x00000334
 743 #define CKM_RC5_CBC_PAD                0x00000335
 744 #define CKM_IDEA_KEY_GEN               0x00000340
 745 #define CKM_IDEA_ECB                   0x00000341
 746 #define CKM_IDEA_CBC                   0x00000342
 747 #define CKM_IDEA_MAC                   0x00000343
 748 #define CKM_IDEA_MAC_GENERAL           0x00000344
 749 #define CKM_IDEA_CBC_PAD               0x00000345
 750 #define CKM_GENERIC_SECRET_KEY_GEN     0x00000350
 751 #define CKM_CONCATENATE_BASE_AND_KEY   0x00000360
 752 #define CKM_CONCATENATE_BASE_AND_DATA  0x00000362
 753 #define CKM_CONCATENATE_DATA_AND_BASE  0x00000363
 754 #define CKM_XOR_BASE_AND_DATA          0x00000364
 755 #define CKM_EXTRACT_KEY_FROM_KEY       0x00000365
 756 #define CKM_SSL3_PRE_MASTER_KEY_GEN    0x00000370
 757 #define CKM_SSL3_MASTER_KEY_DERIVE     0x00000371
 758 #define CKM_SSL3_KEY_AND_MAC_DERIVE    0x00000372
 759 
 760 /* CKM_SSL3_MASTER_KEY_DERIVE_DH, CKM_TLS_PRE_MASTER_KEY_GEN,
 761  * CKM_TLS_MASTER_KEY_DERIVE, CKM_TLS_KEY_AND_MAC_DERIVE, and
 762  * CKM_TLS_MASTER_KEY_DERIVE_DH are new for v2.11 */
 763 #define CKM_SSL3_MASTER_KEY_DERIVE_DH  0x00000373
 764 #define CKM_TLS_PRE_MASTER_KEY_GEN     0x00000374
 765 #define CKM_TLS_MASTER_KEY_DERIVE      0x00000375
 766 #define CKM_TLS_KEY_AND_MAC_DERIVE     0x00000376
 767 #define CKM_TLS_MASTER_KEY_DERIVE_DH   0x00000377
 768 
 769 /* CKM_TLS_PRF is new for v2.20 */
 770 #define CKM_TLS_PRF                    0x00000378
 771 
 772 #define CKM_SSL3_MD5_MAC               0x00000380
 773 #define CKM_SSL3_SHA1_MAC              0x00000381
 774 #define CKM_MD5_KEY_DERIVATION         0x00000390
 775 #define CKM_MD2_KEY_DERIVATION         0x00000391
 776 #define CKM_SHA1_KEY_DERIVATION        0x00000392
 777 
 778 /* CKM_SHA256/384/512 are new for v2.20 */
 779 #define CKM_SHA256_KEY_DERIVATION      0x00000393
 780 #define CKM_SHA384_KEY_DERIVATION      0x00000394
 781 #define CKM_SHA512_KEY_DERIVATION      0x00000395
 782 
 783 #define CKM_PBE_MD2_DES_CBC            0x000003A0
 784 #define CKM_PBE_MD5_DES_CBC            0x000003A1
 785 #define CKM_PBE_MD5_CAST_CBC           0x000003A2
 786 #define CKM_PBE_MD5_CAST3_CBC          0x000003A3
 787 #define CKM_PBE_MD5_CAST5_CBC          0x000003A4
 788 #define CKM_PBE_MD5_CAST128_CBC        0x000003A4
 789 #define CKM_PBE_SHA1_CAST5_CBC         0x000003A5
 790 #define CKM_PBE_SHA1_CAST128_CBC       0x000003A5
 791 #define CKM_PBE_SHA1_RC4_128           0x000003A6
 792 #define CKM_PBE_SHA1_RC4_40            0x000003A7
 793 #define CKM_PBE_SHA1_DES3_EDE_CBC      0x000003A8
 794 #define CKM_PBE_SHA1_DES2_EDE_CBC      0x000003A9
 795 #define CKM_PBE_SHA1_RC2_128_CBC       0x000003AA
 796 #define CKM_PBE_SHA1_RC2_40_CBC        0x000003AB
 797 
 798 /* CKM_PKCS5_PBKD2 is new for v2.10 */
 799 #define CKM_PKCS5_PBKD2                0x000003B0
 800 
 801 #define CKM_PBA_SHA1_WITH_SHA1_HMAC    0x000003C0
 802 
 803 /* WTLS mechanisms are new for v2.20 */
 804 #define CKM_WTLS_PRE_MASTER_KEY_GEN         0x000003D0
 805 #define CKM_WTLS_MASTER_KEY_DERIVE          0x000003D1
 806 #define CKM_WTLS_MASTER_KEY_DERIVE_DH_ECC   0x000003D2
 807 #define CKM_WTLS_PRF                        0x000003D3
 808 #define CKM_WTLS_SERVER_KEY_AND_MAC_DERIVE  0x000003D4
 809 #define CKM_WTLS_CLIENT_KEY_AND_MAC_DERIVE  0x000003D5
 810 
 811 /* new for v2.40 */
 812 #define CKM_TLS12_MASTER_KEY_DERIVE         0x000003E0
 813 #define CKM_TLS12_KEY_AND_MAC_DERIVE        0x000003E1
 814 #define CKM_TLS12_MASTER_KEY_DERIVE_DH      0x000003E2
 815 #define CKM_TLS_MAC                         0x000003E4
 816 
 817 #define CKM_KEY_WRAP_LYNKS             0x00000400
 818 #define CKM_KEY_WRAP_SET_OAEP          0x00000401
 819 
 820 /* CKM_CMS_SIG is new for v2.20 */
 821 #define CKM_CMS_SIG                    0x00000500
 822 
 823 /* Fortezza mechanisms */
 824 #define CKM_SKIPJACK_KEY_GEN           0x00001000
 825 #define CKM_SKIPJACK_ECB64             0x00001001
 826 #define CKM_SKIPJACK_CBC64             0x00001002
 827 #define CKM_SKIPJACK_OFB64             0x00001003
 828 #define CKM_SKIPJACK_CFB64             0x00001004
 829 #define CKM_SKIPJACK_CFB32             0x00001005
 830 #define CKM_SKIPJACK_CFB16             0x00001006
 831 #define CKM_SKIPJACK_CFB8              0x00001007
 832 #define CKM_SKIPJACK_WRAP              0x00001008
 833 #define CKM_SKIPJACK_PRIVATE_WRAP      0x00001009
 834 #define CKM_SKIPJACK_RELAYX            0x0000100a
 835 #define CKM_KEA_KEY_PAIR_GEN           0x00001010
 836 #define CKM_KEA_KEY_DERIVE             0x00001011
 837 #define CKM_FORTEZZA_TIMESTAMP         0x00001020
 838 #define CKM_BATON_KEY_GEN              0x00001030
 839 #define CKM_BATON_ECB128               0x00001031
 840 #define CKM_BATON_ECB96                0x00001032
 841 #define CKM_BATON_CBC128               0x00001033
 842 #define CKM_BATON_COUNTER              0x00001034
 843 #define CKM_BATON_SHUFFLE              0x00001035
 844 #define CKM_BATON_WRAP                 0x00001036
 845 
 846 /* CKM_ECDSA_KEY_PAIR_GEN is deprecated in v2.11,
 847  * CKM_EC_KEY_PAIR_GEN is preferred */
 848 #define CKM_ECDSA_KEY_PAIR_GEN         0x00001040
 849 #define CKM_EC_KEY_PAIR_GEN            0x00001040
 850 
 851 #define CKM_ECDSA                      0x00001041
 852 #define CKM_ECDSA_SHA1                 0x00001042
 853 
 854 /* CKM_ECDH1_DERIVE, CKM_ECDH1_COFACTOR_DERIVE, and CKM_ECMQV_DERIVE
 855  * are new for v2.11 */
 856 #define CKM_ECDH1_DERIVE               0x00001050
 857 #define CKM_ECDH1_COFACTOR_DERIVE      0x00001051
 858 #define CKM_ECMQV_DERIVE               0x00001052
 859 
 860 #define CKM_JUNIPER_KEY_GEN            0x00001060
 861 #define CKM_JUNIPER_ECB128             0x00001061
 862 #define CKM_JUNIPER_CBC128             0x00001062
 863 #define CKM_JUNIPER_COUNTER            0x00001063
 864 #define CKM_JUNIPER_SHUFFLE            0x00001064
 865 #define CKM_JUNIPER_WRAP               0x00001065
 866 #define CKM_FASTHASH                   0x00001070
 867 
 868 /* CKM_AES_KEY_GEN, CKM_AES_ECB, CKM_AES_CBC, CKM_AES_MAC,
 869  * CKM_AES_MAC_GENERAL, CKM_AES_CBC_PAD, CKM_DSA_PARAMETER_GEN,
 870  * CKM_DH_PKCS_PARAMETER_GEN, and CKM_X9_42_DH_PARAMETER_GEN are
 871  * new for v2.11 */
 872 #define CKM_AES_KEY_GEN                0x00001080
 873 #define CKM_AES_ECB                    0x00001081
 874 #define CKM_AES_CBC                    0x00001082
 875 #define CKM_AES_MAC                    0x00001083
 876 #define CKM_AES_MAC_GENERAL            0x00001084
 877 #define CKM_AES_CBC_PAD                0x00001085
 878 
 879 /* BlowFish and TwoFish are new for v2.20 */
 880 #define CKM_BLOWFISH_KEY_GEN           0x00001090
 881 #define CKM_BLOWFISH_CBC               0x00001091
 882 #define CKM_TWOFISH_KEY_GEN            0x00001092
 883 #define CKM_TWOFISH_CBC                0x00001093
 884 
 885 
 886 /* CKM_xxx_ENCRYPT_DATA mechanisms are new for v2.20 */
 887 #define CKM_DES_ECB_ENCRYPT_DATA       0x00001100
 888 #define CKM_DES_CBC_ENCRYPT_DATA       0x00001101
 889 #define CKM_DES3_ECB_ENCRYPT_DATA      0x00001102
 890 #define CKM_DES3_CBC_ENCRYPT_DATA      0x00001103
 891 #define CKM_AES_ECB_ENCRYPT_DATA       0x00001104
 892 #define CKM_AES_CBC_ENCRYPT_DATA       0x00001105
 893 
 894 #define CKM_DSA_PARAMETER_GEN          0x00002000
 895 #define CKM_DH_PKCS_PARAMETER_GEN      0x00002001
 896 #define CKM_X9_42_DH_PARAMETER_GEN     0x00002002
 897 
 898 #define CKM_VENDOR_DEFINED             0x80000000
 899 
 900 typedef CK_MECHANISM_TYPE CK_PTR CK_MECHANISM_TYPE_PTR;
 901 
 902 
 903 /* CK_MECHANISM is a structure that specifies a particular
 904  * mechanism  */
 905 typedef struct CK_MECHANISM {
 906   CK_MECHANISM_TYPE mechanism;
 907   CK_VOID_PTR       pParameter;
 908 
 909   /* ulParameterLen was changed from CK_USHORT to CK_ULONG for
 910    * v2.0 */
 911   CK_ULONG          ulParameterLen;  /* in bytes */
 912 } CK_MECHANISM;
 913 
 914 typedef CK_MECHANISM CK_PTR CK_MECHANISM_PTR;
 915 
 916 
 917 /* CK_MECHANISM_INFO provides information about a particular
 918  * mechanism */
 919 typedef struct CK_MECHANISM_INFO {
 920     CK_ULONG    ulMinKeySize;
 921     CK_ULONG    ulMaxKeySize;
 922     CK_FLAGS    flags;
 923 } CK_MECHANISM_INFO;
 924 
 925 /* The flags are defined as follows:
 926  *      Bit Flag               Mask        Meaning */
 927 #define CKF_HW                 0x00000001  /* performed by HW */
 928 
 929 /* The flags CKF_ENCRYPT, CKF_DECRYPT, CKF_DIGEST, CKF_SIGN,
 930  * CKG_SIGN_RECOVER, CKF_VERIFY, CKF_VERIFY_RECOVER,
 931  * CKF_GENERATE, CKF_GENERATE_KEY_PAIR, CKF_WRAP, CKF_UNWRAP,
 932  * and CKF_DERIVE are new for v2.0.  They specify whether or not
 933  * a mechanism can be used for a particular task */
 934 #define CKF_ENCRYPT            0x00000100
 935 #define CKF_DECRYPT            0x00000200
 936 #define CKF_DIGEST             0x00000400
 937 #define CKF_SIGN               0x00000800
 938 #define CKF_SIGN_RECOVER       0x00001000
 939 #define CKF_VERIFY             0x00002000
 940 #define CKF_VERIFY_RECOVER     0x00004000
 941 #define CKF_GENERATE           0x00008000
 942 #define CKF_GENERATE_KEY_PAIR  0x00010000
 943 #define CKF_WRAP               0x00020000
 944 #define CKF_UNWRAP             0x00040000
 945 #define CKF_DERIVE             0x00080000
 946 
 947 /* CKF_EC_F_P, CKF_EC_F_2M, CKF_EC_ECPARAMETERS, CKF_EC_NAMEDCURVE,
 948  * CKF_EC_UNCOMPRESS, and CKF_EC_COMPRESS are new for v2.11. They
 949  * describe a token&#39;s EC capabilities not available in mechanism
 950  * information. */
 951 #define CKF_EC_F_P             0x00100000
 952 #define CKF_EC_F_2M            0x00200000
 953 #define CKF_EC_ECPARAMETERS    0x00400000
 954 #define CKF_EC_NAMEDCURVE      0x00800000
 955 #define CKF_EC_UNCOMPRESS      0x01000000
 956 #define CKF_EC_COMPRESS        0x02000000
 957 
 958 #define CKF_EXTENSION          0x80000000 /* FALSE for this version */
 959 
 960 typedef CK_MECHANISM_INFO CK_PTR CK_MECHANISM_INFO_PTR;
 961 
 962 
 963 /* CK_RV is a value that identifies the return value of a
 964  * Cryptoki function */
 965 /* CK_RV was changed from CK_USHORT to CK_ULONG for v2.0 */
 966 typedef CK_ULONG          CK_RV;
 967 
 968 #define CKR_OK                                0x00000000
 969 #define CKR_CANCEL                            0x00000001
 970 #define CKR_HOST_MEMORY                       0x00000002
 971 #define CKR_SLOT_ID_INVALID                   0x00000003
 972 
 973 /* CKR_FLAGS_INVALID was removed for v2.0 */
 974 
 975 /* CKR_GENERAL_ERROR and CKR_FUNCTION_FAILED are new for v2.0 */
 976 #define CKR_GENERAL_ERROR                     0x00000005
 977 #define CKR_FUNCTION_FAILED                   0x00000006
 978 
 979 /* CKR_ARGUMENTS_BAD, CKR_NO_EVENT, CKR_NEED_TO_CREATE_THREADS,
 980  * and CKR_CANT_LOCK are new for v2.01 */
 981 #define CKR_ARGUMENTS_BAD                     0x00000007
 982 #define CKR_NO_EVENT                          0x00000008
 983 #define CKR_NEED_TO_CREATE_THREADS            0x00000009
 984 #define CKR_CANT_LOCK                         0x0000000A
 985 
 986 #define CKR_ATTRIBUTE_READ_ONLY               0x00000010
 987 #define CKR_ATTRIBUTE_SENSITIVE               0x00000011
 988 #define CKR_ATTRIBUTE_TYPE_INVALID            0x00000012
 989 #define CKR_ATTRIBUTE_VALUE_INVALID           0x00000013
 990 #define CKR_DATA_INVALID                      0x00000020
 991 #define CKR_DATA_LEN_RANGE                    0x00000021
 992 #define CKR_DEVICE_ERROR                      0x00000030
 993 #define CKR_DEVICE_MEMORY                     0x00000031
 994 #define CKR_DEVICE_REMOVED                    0x00000032
 995 #define CKR_ENCRYPTED_DATA_INVALID            0x00000040
 996 #define CKR_ENCRYPTED_DATA_LEN_RANGE          0x00000041
 997 #define CKR_FUNCTION_CANCELED                 0x00000050
 998 #define CKR_FUNCTION_NOT_PARALLEL             0x00000051
 999 
1000 /* CKR_FUNCTION_NOT_SUPPORTED is new for v2.0 */
1001 #define CKR_FUNCTION_NOT_SUPPORTED            0x00000054
1002 
1003 #define CKR_KEY_HANDLE_INVALID                0x00000060
1004 
1005 /* CKR_KEY_SENSITIVE was removed for v2.0 */
1006 
1007 #define CKR_KEY_SIZE_RANGE                    0x00000062
1008 #define CKR_KEY_TYPE_INCONSISTENT             0x00000063
1009 
1010 /* CKR_KEY_NOT_NEEDED, CKR_KEY_CHANGED, CKR_KEY_NEEDED,
1011  * CKR_KEY_INDIGESTIBLE, CKR_KEY_FUNCTION_NOT_PERMITTED,
1012  * CKR_KEY_NOT_WRAPPABLE, and CKR_KEY_UNEXTRACTABLE are new for
1013  * v2.0 */
1014 #define CKR_KEY_NOT_NEEDED                    0x00000064
1015 #define CKR_KEY_CHANGED                       0x00000065
1016 #define CKR_KEY_NEEDED                        0x00000066
1017 #define CKR_KEY_INDIGESTIBLE                  0x00000067
1018 #define CKR_KEY_FUNCTION_NOT_PERMITTED        0x00000068
1019 #define CKR_KEY_NOT_WRAPPABLE                 0x00000069
1020 #define CKR_KEY_UNEXTRACTABLE                 0x0000006A
1021 
1022 #define CKR_MECHANISM_INVALID                 0x00000070
1023 #define CKR_MECHANISM_PARAM_INVALID           0x00000071
1024 
1025 /* CKR_OBJECT_CLASS_INCONSISTENT and CKR_OBJECT_CLASS_INVALID
1026  * were removed for v2.0 */
1027 #define CKR_OBJECT_HANDLE_INVALID             0x00000082
1028 #define CKR_OPERATION_ACTIVE                  0x00000090
1029 #define CKR_OPERATION_NOT_INITIALIZED         0x00000091
1030 #define CKR_PIN_INCORRECT                     0x000000A0
1031 #define CKR_PIN_INVALID                       0x000000A1
1032 #define CKR_PIN_LEN_RANGE                     0x000000A2
1033 
1034 /* CKR_PIN_EXPIRED and CKR_PIN_LOCKED are new for v2.0 */
1035 #define CKR_PIN_EXPIRED                       0x000000A3
1036 #define CKR_PIN_LOCKED                        0x000000A4
1037 
1038 #define CKR_SESSION_CLOSED                    0x000000B0
1039 #define CKR_SESSION_COUNT                     0x000000B1
1040 #define CKR_SESSION_HANDLE_INVALID            0x000000B3
1041 #define CKR_SESSION_PARALLEL_NOT_SUPPORTED    0x000000B4
1042 #define CKR_SESSION_READ_ONLY                 0x000000B5
1043 #define CKR_SESSION_EXISTS                    0x000000B6
1044 
1045 /* CKR_SESSION_READ_ONLY_EXISTS and
1046  * CKR_SESSION_READ_WRITE_SO_EXISTS are new for v2.0 */
1047 #define CKR_SESSION_READ_ONLY_EXISTS          0x000000B7
1048 #define CKR_SESSION_READ_WRITE_SO_EXISTS      0x000000B8
1049 
1050 #define CKR_SIGNATURE_INVALID                 0x000000C0
1051 #define CKR_SIGNATURE_LEN_RANGE               0x000000C1
1052 #define CKR_TEMPLATE_INCOMPLETE               0x000000D0
1053 #define CKR_TEMPLATE_INCONSISTENT             0x000000D1
1054 #define CKR_TOKEN_NOT_PRESENT                 0x000000E0
1055 #define CKR_TOKEN_NOT_RECOGNIZED              0x000000E1
1056 #define CKR_TOKEN_WRITE_PROTECTED             0x000000E2
1057 #define CKR_UNWRAPPING_KEY_HANDLE_INVALID     0x000000F0
1058 #define CKR_UNWRAPPING_KEY_SIZE_RANGE         0x000000F1
1059 #define CKR_UNWRAPPING_KEY_TYPE_INCONSISTENT  0x000000F2
1060 #define CKR_USER_ALREADY_LOGGED_IN            0x00000100
1061 #define CKR_USER_NOT_LOGGED_IN                0x00000101
1062 #define CKR_USER_PIN_NOT_INITIALIZED          0x00000102
1063 #define CKR_USER_TYPE_INVALID                 0x00000103
1064 
1065 /* CKR_USER_ANOTHER_ALREADY_LOGGED_IN and CKR_USER_TOO_MANY_TYPES
1066  * are new to v2.01 */
1067 #define CKR_USER_ANOTHER_ALREADY_LOGGED_IN    0x00000104
1068 #define CKR_USER_TOO_MANY_TYPES               0x00000105
1069 
1070 #define CKR_WRAPPED_KEY_INVALID               0x00000110
1071 #define CKR_WRAPPED_KEY_LEN_RANGE             0x00000112
1072 #define CKR_WRAPPING_KEY_HANDLE_INVALID       0x00000113
1073 #define CKR_WRAPPING_KEY_SIZE_RANGE           0x00000114
1074 #define CKR_WRAPPING_KEY_TYPE_INCONSISTENT    0x00000115
1075 #define CKR_RANDOM_SEED_NOT_SUPPORTED         0x00000120
1076 
1077 /* These are new to v2.0 */
1078 #define CKR_RANDOM_NO_RNG                     0x00000121
1079 
1080 /* These are new to v2.11 */
1081 #define CKR_DOMAIN_PARAMS_INVALID             0x00000130
1082 
1083 /* These are new to v2.0 */
1084 #define CKR_BUFFER_TOO_SMALL                  0x00000150
1085 #define CKR_SAVED_STATE_INVALID               0x00000160
1086 #define CKR_INFORMATION_SENSITIVE             0x00000170
1087 #define CKR_STATE_UNSAVEABLE                  0x00000180
1088 
1089 /* These are new to v2.01 */
1090 #define CKR_CRYPTOKI_NOT_INITIALIZED          0x00000190
1091 #define CKR_CRYPTOKI_ALREADY_INITIALIZED      0x00000191
1092 #define CKR_MUTEX_BAD                         0x000001A0
1093 #define CKR_MUTEX_NOT_LOCKED                  0x000001A1
1094 
1095 /* This is new to v2.20 */
1096 #define CKR_FUNCTION_REJECTED                 0x00000200
1097 
1098 #define CKR_VENDOR_DEFINED                    0x80000000
1099 
1100 
1101 /* CK_NOTIFY is an application callback that processes events */
1102 typedef CK_CALLBACK_FUNCTION(CK_RV, CK_NOTIFY)(
1103   CK_SESSION_HANDLE hSession,     /* the session&#39;s handle */
1104   CK_NOTIFICATION   event,
1105   CK_VOID_PTR       pApplication  /* passed to C_OpenSession */
1106 );
1107 
1108 
1109 /* CK_FUNCTION_LIST is a structure holding a Cryptoki spec
1110  * version and pointers of appropriate types to all the
1111  * Cryptoki functions */
1112 /* CK_FUNCTION_LIST is new for v2.0 */
1113 typedef struct CK_FUNCTION_LIST CK_FUNCTION_LIST;
1114 
1115 typedef CK_FUNCTION_LIST CK_PTR CK_FUNCTION_LIST_PTR;
1116 
1117 typedef CK_FUNCTION_LIST_PTR CK_PTR CK_FUNCTION_LIST_PTR_PTR;
1118 
1119 
1120 /* CK_CREATEMUTEX is an application callback for creating a
1121  * mutex object */
1122 typedef CK_CALLBACK_FUNCTION(CK_RV, CK_CREATEMUTEX)(
1123   CK_VOID_PTR_PTR ppMutex  /* location to receive ptr to mutex */
1124 );
1125 
1126 
1127 /* CK_DESTROYMUTEX is an application callback for destroying a
1128  * mutex object */
1129 typedef CK_CALLBACK_FUNCTION(CK_RV, CK_DESTROYMUTEX)(
1130   CK_VOID_PTR pMutex  /* pointer to mutex */
1131 );
1132 
1133 
1134 /* CK_LOCKMUTEX is an application callback for locking a mutex */
1135 typedef CK_CALLBACK_FUNCTION(CK_RV, CK_LOCKMUTEX)(
1136   CK_VOID_PTR pMutex  /* pointer to mutex */
1137 );
1138 
1139 
1140 /* CK_UNLOCKMUTEX is an application callback for unlocking a
1141  * mutex */
1142 typedef CK_CALLBACK_FUNCTION(CK_RV, CK_UNLOCKMUTEX)(
1143   CK_VOID_PTR pMutex  /* pointer to mutex */
1144 );
1145 
1146 
1147 /* CK_C_INITIALIZE_ARGS provides the optional arguments to
1148  * C_Initialize */
1149 typedef struct CK_C_INITIALIZE_ARGS {
1150   CK_CREATEMUTEX CreateMutex;
1151   CK_DESTROYMUTEX DestroyMutex;
1152   CK_LOCKMUTEX LockMutex;
1153   CK_UNLOCKMUTEX UnlockMutex;
1154   CK_FLAGS flags;
1155   CK_VOID_PTR pReserved;
1156 } CK_C_INITIALIZE_ARGS;
1157 
1158 /* flags: bit flags that provide capabilities of the slot
1159  *      Bit Flag                           Mask       Meaning
1160  */
1161 #define CKF_LIBRARY_CANT_CREATE_OS_THREADS 0x00000001
1162 #define CKF_OS_LOCKING_OK                  0x00000002
1163 
1164 typedef CK_C_INITIALIZE_ARGS CK_PTR CK_C_INITIALIZE_ARGS_PTR;
1165 
1166 
1167 /* additional flags for parameters to functions */
1168 
1169 /* CKF_DONT_BLOCK is for the function C_WaitForSlotEvent */
1170 #define CKF_DONT_BLOCK     1
1171 
1172 /* CK_RSA_PKCS_OAEP_MGF_TYPE is new for v2.10.
1173  * CK_RSA_PKCS_OAEP_MGF_TYPE  is used to indicate the Message
1174  * Generation Function (MGF) applied to a message block when
1175  * formatting a message block for the PKCS #1 OAEP encryption
1176  * scheme. */
1177 typedef CK_ULONG CK_RSA_PKCS_MGF_TYPE;
1178 
1179 typedef CK_RSA_PKCS_MGF_TYPE CK_PTR CK_RSA_PKCS_MGF_TYPE_PTR;
1180 
1181 /* The following MGFs are defined */
1182 /* CKG_MGF1_SHA256, CKG_MGF1_SHA384, and CKG_MGF1_SHA512
1183  * are new for v2.20 */
1184 #define CKG_MGF1_SHA1         0x00000001
1185 #define CKG_MGF1_SHA256       0x00000002
1186 #define CKG_MGF1_SHA384       0x00000003
1187 #define CKG_MGF1_SHA512       0x00000004
1188 
1189 /* CK_RSA_PKCS_OAEP_SOURCE_TYPE is new for v2.10.
1190  * CK_RSA_PKCS_OAEP_SOURCE_TYPE  is used to indicate the source
1191  * of the encoding parameter when formatting a message block
1192  * for the PKCS #1 OAEP encryption scheme. */
1193 typedef CK_ULONG CK_RSA_PKCS_OAEP_SOURCE_TYPE;
1194 
1195 typedef CK_RSA_PKCS_OAEP_SOURCE_TYPE CK_PTR CK_RSA_PKCS_OAEP_SOURCE_TYPE_PTR;
1196 
1197 /* The following encoding parameter sources are defined */
1198 #define CKZ_DATA_SPECIFIED    0x00000001
1199 
1200 /* CK_RSA_PKCS_OAEP_PARAMS is new for v2.10.
1201  * CK_RSA_PKCS_OAEP_PARAMS provides the parameters to the
1202  * CKM_RSA_PKCS_OAEP mechanism. */
1203 typedef struct CK_RSA_PKCS_OAEP_PARAMS {
1204         CK_MECHANISM_TYPE hashAlg;
1205         CK_RSA_PKCS_MGF_TYPE mgf;
1206         CK_RSA_PKCS_OAEP_SOURCE_TYPE source;
1207         CK_VOID_PTR pSourceData;
1208         CK_ULONG ulSourceDataLen;
1209 } CK_RSA_PKCS_OAEP_PARAMS;
1210 
1211 typedef CK_RSA_PKCS_OAEP_PARAMS CK_PTR CK_RSA_PKCS_OAEP_PARAMS_PTR;
1212 
1213 /* CK_RSA_PKCS_PSS_PARAMS is new for v2.11.
1214  * CK_RSA_PKCS_PSS_PARAMS provides the parameters to the
1215  * CKM_RSA_PKCS_PSS mechanism(s). */
1216 typedef struct CK_RSA_PKCS_PSS_PARAMS {
1217         CK_MECHANISM_TYPE    hashAlg;
1218         CK_RSA_PKCS_MGF_TYPE mgf;
1219         CK_ULONG             sLen;
1220 } CK_RSA_PKCS_PSS_PARAMS;
1221 
1222 typedef CK_RSA_PKCS_PSS_PARAMS CK_PTR CK_RSA_PKCS_PSS_PARAMS_PTR;
1223 
1224 /* CK_EC_KDF_TYPE is new for v2.11. */
1225 typedef CK_ULONG CK_EC_KDF_TYPE;
1226 
1227 /* The following EC Key Derivation Functions are defined */
1228 #define CKD_NULL                 0x00000001
1229 #define CKD_SHA1_KDF             0x00000002
1230 
1231 /* CK_ECDH1_DERIVE_PARAMS is new for v2.11.
1232  * CK_ECDH1_DERIVE_PARAMS provides the parameters to the
1233  * CKM_ECDH1_DERIVE and CKM_ECDH1_COFACTOR_DERIVE mechanisms,
1234  * where each party contributes one key pair.
1235  */
1236 typedef struct CK_ECDH1_DERIVE_PARAMS {
1237   CK_EC_KDF_TYPE kdf;
1238   CK_ULONG ulSharedDataLen;
1239   CK_BYTE_PTR pSharedData;
1240   CK_ULONG ulPublicDataLen;
1241   CK_BYTE_PTR pPublicData;
1242 } CK_ECDH1_DERIVE_PARAMS;
1243 
1244 typedef CK_ECDH1_DERIVE_PARAMS CK_PTR CK_ECDH1_DERIVE_PARAMS_PTR;
1245 
1246 
1247 /* CK_ECDH2_DERIVE_PARAMS is new for v2.11.
1248  * CK_ECDH2_DERIVE_PARAMS provides the parameters to the
1249  * CKM_ECMQV_DERIVE mechanism, where each party contributes two key pairs. */
1250 typedef struct CK_ECDH2_DERIVE_PARAMS {
1251   CK_EC_KDF_TYPE kdf;
1252   CK_ULONG ulSharedDataLen;
1253   CK_BYTE_PTR pSharedData;
1254   CK_ULONG ulPublicDataLen;
1255   CK_BYTE_PTR pPublicData;
1256   CK_ULONG ulPrivateDataLen;
1257   CK_OBJECT_HANDLE hPrivateData;
1258   CK_ULONG ulPublicDataLen2;
1259   CK_BYTE_PTR pPublicData2;
1260 } CK_ECDH2_DERIVE_PARAMS;
1261 
1262 typedef CK_ECDH2_DERIVE_PARAMS CK_PTR CK_ECDH2_DERIVE_PARAMS_PTR;
1263 
1264 typedef struct CK_ECMQV_DERIVE_PARAMS {
1265   CK_EC_KDF_TYPE kdf;
1266   CK_ULONG ulSharedDataLen;
1267   CK_BYTE_PTR pSharedData;
1268   CK_ULONG ulPublicDataLen;
1269   CK_BYTE_PTR pPublicData;
1270   CK_ULONG ulPrivateDataLen;
1271   CK_OBJECT_HANDLE hPrivateData;
1272   CK_ULONG ulPublicDataLen2;
1273   CK_BYTE_PTR pPublicData2;
1274   CK_OBJECT_HANDLE publicKey;
1275 } CK_ECMQV_DERIVE_PARAMS;
1276 
1277 typedef CK_ECMQV_DERIVE_PARAMS CK_PTR CK_ECMQV_DERIVE_PARAMS_PTR;
1278 
1279 /* Typedefs and defines for the CKM_X9_42_DH_KEY_PAIR_GEN and the
1280  * CKM_X9_42_DH_PARAMETER_GEN mechanisms (new for PKCS #11 v2.11) */
1281 typedef CK_ULONG CK_X9_42_DH_KDF_TYPE;
1282 typedef CK_X9_42_DH_KDF_TYPE CK_PTR CK_X9_42_DH_KDF_TYPE_PTR;
1283 
1284 /* The following X9.42 DH key derivation functions are defined
1285    (besides CKD_NULL already defined : */
1286 #define CKD_SHA1_KDF_ASN1        0x00000003
1287 #define CKD_SHA1_KDF_CONCATENATE 0x00000004
1288 
1289 /* CK_X9_42_DH1_DERIVE_PARAMS is new for v2.11.
1290  * CK_X9_42_DH1_DERIVE_PARAMS provides the parameters to the
1291  * CKM_X9_42_DH_DERIVE key derivation mechanism, where each party
1292  * contributes one key pair */
1293 typedef struct CK_X9_42_DH1_DERIVE_PARAMS {
1294   CK_X9_42_DH_KDF_TYPE kdf;
1295   CK_ULONG ulOtherInfoLen;
1296   CK_BYTE_PTR pOtherInfo;
1297   CK_ULONG ulPublicDataLen;
1298   CK_BYTE_PTR pPublicData;
1299 } CK_X9_42_DH1_DERIVE_PARAMS;
1300 
1301 typedef struct CK_X9_42_DH1_DERIVE_PARAMS CK_PTR CK_X9_42_DH1_DERIVE_PARAMS_PTR;
1302 
1303 /* CK_X9_42_DH2_DERIVE_PARAMS is new for v2.11.
1304  * CK_X9_42_DH2_DERIVE_PARAMS provides the parameters to the
1305  * CKM_X9_42_DH_HYBRID_DERIVE and CKM_X9_42_MQV_DERIVE key derivation
1306  * mechanisms, where each party contributes two key pairs */
1307 typedef struct CK_X9_42_DH2_DERIVE_PARAMS {
1308   CK_X9_42_DH_KDF_TYPE kdf;
1309   CK_ULONG ulOtherInfoLen;
1310   CK_BYTE_PTR pOtherInfo;
1311   CK_ULONG ulPublicDataLen;
1312   CK_BYTE_PTR pPublicData;
1313   CK_ULONG ulPrivateDataLen;
1314   CK_OBJECT_HANDLE hPrivateData;
1315   CK_ULONG ulPublicDataLen2;
1316   CK_BYTE_PTR pPublicData2;
1317 } CK_X9_42_DH2_DERIVE_PARAMS;
1318 
1319 typedef CK_X9_42_DH2_DERIVE_PARAMS CK_PTR CK_X9_42_DH2_DERIVE_PARAMS_PTR;
1320 
1321 typedef struct CK_X9_42_MQV_DERIVE_PARAMS {
1322   CK_X9_42_DH_KDF_TYPE kdf;
1323   CK_ULONG ulOtherInfoLen;
1324   CK_BYTE_PTR pOtherInfo;
1325   CK_ULONG ulPublicDataLen;
1326   CK_BYTE_PTR pPublicData;
1327   CK_ULONG ulPrivateDataLen;
1328   CK_OBJECT_HANDLE hPrivateData;
1329   CK_ULONG ulPublicDataLen2;
1330   CK_BYTE_PTR pPublicData2;
1331   CK_OBJECT_HANDLE publicKey;
1332 } CK_X9_42_MQV_DERIVE_PARAMS;
1333 
1334 typedef CK_X9_42_MQV_DERIVE_PARAMS CK_PTR CK_X9_42_MQV_DERIVE_PARAMS_PTR;
1335 
1336 /* CK_KEA_DERIVE_PARAMS provides the parameters to the
1337  * CKM_KEA_DERIVE mechanism */
1338 /* CK_KEA_DERIVE_PARAMS is new for v2.0 */
1339 typedef struct CK_KEA_DERIVE_PARAMS {
1340   CK_BBOOL      isSender;
1341   CK_ULONG      ulRandomLen;
1342   CK_BYTE_PTR   pRandomA;
1343   CK_BYTE_PTR   pRandomB;
1344   CK_ULONG      ulPublicDataLen;
1345   CK_BYTE_PTR   pPublicData;
1346 } CK_KEA_DERIVE_PARAMS;
1347 
1348 typedef CK_KEA_DERIVE_PARAMS CK_PTR CK_KEA_DERIVE_PARAMS_PTR;
1349 
1350 
1351 /* CK_RC2_PARAMS provides the parameters to the CKM_RC2_ECB and
1352  * CKM_RC2_MAC mechanisms.  An instance of CK_RC2_PARAMS just
1353  * holds the effective keysize */
1354 typedef CK_ULONG          CK_RC2_PARAMS;
1355 
1356 typedef CK_RC2_PARAMS CK_PTR CK_RC2_PARAMS_PTR;
1357 
1358 
1359 /* CK_RC2_CBC_PARAMS provides the parameters to the CKM_RC2_CBC
1360  * mechanism */
1361 typedef struct CK_RC2_CBC_PARAMS {
1362   /* ulEffectiveBits was changed from CK_USHORT to CK_ULONG for
1363    * v2.0 */
1364   CK_ULONG      ulEffectiveBits;  /* effective bits (1-1024) */
1365 
1366   CK_BYTE       iv[8];            /* IV for CBC mode */
1367 } CK_RC2_CBC_PARAMS;
1368 
1369 typedef CK_RC2_CBC_PARAMS CK_PTR CK_RC2_CBC_PARAMS_PTR;
1370 
1371 
1372 /* CK_RC2_MAC_GENERAL_PARAMS provides the parameters for the
1373  * CKM_RC2_MAC_GENERAL mechanism */
1374 /* CK_RC2_MAC_GENERAL_PARAMS is new for v2.0 */
1375 typedef struct CK_RC2_MAC_GENERAL_PARAMS {
1376   CK_ULONG      ulEffectiveBits;  /* effective bits (1-1024) */
1377   CK_ULONG      ulMacLength;      /* Length of MAC in bytes */
1378 } CK_RC2_MAC_GENERAL_PARAMS;
1379 
1380 typedef CK_RC2_MAC_GENERAL_PARAMS CK_PTR \
1381   CK_RC2_MAC_GENERAL_PARAMS_PTR;
1382 
1383 
1384 /* CK_RC5_PARAMS provides the parameters to the CKM_RC5_ECB and
1385  * CKM_RC5_MAC mechanisms */
1386 /* CK_RC5_PARAMS is new for v2.0 */
1387 typedef struct CK_RC5_PARAMS {
1388   CK_ULONG      ulWordsize;  /* wordsize in bits */
1389   CK_ULONG      ulRounds;    /* number of rounds */
1390 } CK_RC5_PARAMS;
1391 
1392 typedef CK_RC5_PARAMS CK_PTR CK_RC5_PARAMS_PTR;
1393 
1394 
1395 /* CK_RC5_CBC_PARAMS provides the parameters to the CKM_RC5_CBC
1396  * mechanism */
1397 /* CK_RC5_CBC_PARAMS is new for v2.0 */
1398 typedef struct CK_RC5_CBC_PARAMS {
1399   CK_ULONG      ulWordsize;  /* wordsize in bits */
1400   CK_ULONG      ulRounds;    /* number of rounds */
1401   CK_BYTE_PTR   pIv;         /* pointer to IV */
1402   CK_ULONG      ulIvLen;     /* length of IV in bytes */
1403 } CK_RC5_CBC_PARAMS;
1404 
1405 typedef CK_RC5_CBC_PARAMS CK_PTR CK_RC5_CBC_PARAMS_PTR;
1406 
1407 
1408 /* CK_RC5_MAC_GENERAL_PARAMS provides the parameters for the
1409  * CKM_RC5_MAC_GENERAL mechanism */
1410 /* CK_RC5_MAC_GENERAL_PARAMS is new for v2.0 */
1411 typedef struct CK_RC5_MAC_GENERAL_PARAMS {
1412   CK_ULONG      ulWordsize;   /* wordsize in bits */
1413   CK_ULONG      ulRounds;     /* number of rounds */
1414   CK_ULONG      ulMacLength;  /* Length of MAC in bytes */
1415 } CK_RC5_MAC_GENERAL_PARAMS;
1416 
1417 typedef CK_RC5_MAC_GENERAL_PARAMS CK_PTR \
1418   CK_RC5_MAC_GENERAL_PARAMS_PTR;
1419 
1420 
1421 /* CK_MAC_GENERAL_PARAMS provides the parameters to most block
1422  * ciphers&#39; MAC_GENERAL mechanisms.  Its value is the length of
1423  * the MAC */
1424 /* CK_MAC_GENERAL_PARAMS is new for v2.0 */
1425 typedef CK_ULONG          CK_MAC_GENERAL_PARAMS;
1426 
1427 typedef CK_MAC_GENERAL_PARAMS CK_PTR CK_MAC_GENERAL_PARAMS_PTR;
1428 
1429 /* CK_DES/AES_ECB/CBC_ENCRYPT_DATA_PARAMS are new for v2.20 */
1430 typedef struct CK_DES_CBC_ENCRYPT_DATA_PARAMS {
1431   CK_BYTE      iv[8];
1432   CK_BYTE_PTR  pData;
1433   CK_ULONG     length;
1434 } CK_DES_CBC_ENCRYPT_DATA_PARAMS;
1435 
1436 typedef CK_DES_CBC_ENCRYPT_DATA_PARAMS CK_PTR CK_DES_CBC_ENCRYPT_DATA_PARAMS_PTR;
1437 
1438 typedef struct CK_AES_CBC_ENCRYPT_DATA_PARAMS {
1439   CK_BYTE      iv[16];
1440   CK_BYTE_PTR  pData;
1441   CK_ULONG     length;
1442 } CK_AES_CBC_ENCRYPT_DATA_PARAMS;
1443 
1444 typedef CK_AES_CBC_ENCRYPT_DATA_PARAMS CK_PTR CK_AES_CBC_ENCRYPT_DATA_PARAMS_PTR;
1445 
1446 /* CK_SKIPJACK_PRIVATE_WRAP_PARAMS provides the parameters to the
1447  * CKM_SKIPJACK_PRIVATE_WRAP mechanism */
1448 /* CK_SKIPJACK_PRIVATE_WRAP_PARAMS is new for v2.0 */
1449 typedef struct CK_SKIPJACK_PRIVATE_WRAP_PARAMS {
1450   CK_ULONG      ulPasswordLen;
1451   CK_BYTE_PTR   pPassword;
1452   CK_ULONG      ulPublicDataLen;
1453   CK_BYTE_PTR   pPublicData;
1454   CK_ULONG      ulPAndGLen;
1455   CK_ULONG      ulQLen;
1456   CK_ULONG      ulRandomLen;
1457   CK_BYTE_PTR   pRandomA;
1458   CK_BYTE_PTR   pPrimeP;
1459   CK_BYTE_PTR   pBaseG;
1460   CK_BYTE_PTR   pSubprimeQ;
1461 } CK_SKIPJACK_PRIVATE_WRAP_PARAMS;
1462 
1463 typedef CK_SKIPJACK_PRIVATE_WRAP_PARAMS CK_PTR \
1464   CK_SKIPJACK_PRIVATE_WRAP_PTR;
1465 
1466 
1467 /* CK_SKIPJACK_RELAYX_PARAMS provides the parameters to the
1468  * CKM_SKIPJACK_RELAYX mechanism */
1469 /* CK_SKIPJACK_RELAYX_PARAMS is new for v2.0 */
1470 typedef struct CK_SKIPJACK_RELAYX_PARAMS {
1471   CK_ULONG      ulOldWrappedXLen;
1472   CK_BYTE_PTR   pOldWrappedX;
1473   CK_ULONG      ulOldPasswordLen;
1474   CK_BYTE_PTR   pOldPassword;
1475   CK_ULONG      ulOldPublicDataLen;
1476   CK_BYTE_PTR   pOldPublicData;
1477   CK_ULONG      ulOldRandomLen;
1478   CK_BYTE_PTR   pOldRandomA;
1479   CK_ULONG      ulNewPasswordLen;
1480   CK_BYTE_PTR   pNewPassword;
1481   CK_ULONG      ulNewPublicDataLen;
1482   CK_BYTE_PTR   pNewPublicData;
1483   CK_ULONG      ulNewRandomLen;
1484   CK_BYTE_PTR   pNewRandomA;
1485 } CK_SKIPJACK_RELAYX_PARAMS;
1486 
1487 typedef CK_SKIPJACK_RELAYX_PARAMS CK_PTR \
1488   CK_SKIPJACK_RELAYX_PARAMS_PTR;
1489 
1490 
1491 typedef struct CK_PBE_PARAMS {
1492   CK_BYTE_PTR      pInitVector;
1493   CK_UTF8CHAR_PTR  pPassword;
1494   CK_ULONG         ulPasswordLen;
1495   CK_BYTE_PTR      pSalt;
1496   CK_ULONG         ulSaltLen;
1497   CK_ULONG         ulIteration;
1498 } CK_PBE_PARAMS;
1499 
1500 typedef CK_PBE_PARAMS CK_PTR CK_PBE_PARAMS_PTR;
1501 
1502 
1503 /* CK_KEY_WRAP_SET_OAEP_PARAMS provides the parameters to the
1504  * CKM_KEY_WRAP_SET_OAEP mechanism */
1505 /* CK_KEY_WRAP_SET_OAEP_PARAMS is new for v2.0 */
1506 typedef struct CK_KEY_WRAP_SET_OAEP_PARAMS {
1507   CK_BYTE       bBC;     /* block contents byte */
1508   CK_BYTE_PTR   pX;      /* extra data */
1509   CK_ULONG      ulXLen;  /* length of extra data in bytes */
1510 } CK_KEY_WRAP_SET_OAEP_PARAMS;
1511 
1512 typedef CK_KEY_WRAP_SET_OAEP_PARAMS CK_PTR \
1513   CK_KEY_WRAP_SET_OAEP_PARAMS_PTR;
1514 
1515 
1516 typedef struct CK_SSL3_RANDOM_DATA {
1517   CK_BYTE_PTR  pClientRandom;
1518   CK_ULONG     ulClientRandomLen;
1519   CK_BYTE_PTR  pServerRandom;
1520   CK_ULONG     ulServerRandomLen;
1521 } CK_SSL3_RANDOM_DATA;
1522 
1523 
1524 typedef struct CK_SSL3_MASTER_KEY_DERIVE_PARAMS {
1525   CK_SSL3_RANDOM_DATA RandomInfo;
1526   CK_VERSION_PTR pVersion;
1527 } CK_SSL3_MASTER_KEY_DERIVE_PARAMS;
1528 
1529 typedef struct CK_SSL3_MASTER_KEY_DERIVE_PARAMS CK_PTR \
1530   CK_SSL3_MASTER_KEY_DERIVE_PARAMS_PTR;
1531 
1532 
1533 typedef struct CK_SSL3_KEY_MAT_OUT {
1534   CK_OBJECT_HANDLE hClientMacSecret;
1535   CK_OBJECT_HANDLE hServerMacSecret;
1536   CK_OBJECT_HANDLE hClientKey;
1537   CK_OBJECT_HANDLE hServerKey;
1538   CK_BYTE_PTR      pIVClient;
1539   CK_BYTE_PTR      pIVServer;
1540 } CK_SSL3_KEY_MAT_OUT;
1541 
1542 typedef CK_SSL3_KEY_MAT_OUT CK_PTR CK_SSL3_KEY_MAT_OUT_PTR;
1543 
1544 
1545 typedef struct CK_SSL3_KEY_MAT_PARAMS {
1546   CK_ULONG                ulMacSizeInBits;
1547   CK_ULONG                ulKeySizeInBits;
1548   CK_ULONG                ulIVSizeInBits;
1549   CK_BBOOL                bIsExport;
1550   CK_SSL3_RANDOM_DATA     RandomInfo;
1551   CK_SSL3_KEY_MAT_OUT_PTR pReturnedKeyMaterial;
1552 } CK_SSL3_KEY_MAT_PARAMS;
1553 
1554 typedef CK_SSL3_KEY_MAT_PARAMS CK_PTR CK_SSL3_KEY_MAT_PARAMS_PTR;
1555 
1556 /* CK_TLS_PRF_PARAMS is new for version 2.20 */
1557 typedef struct CK_TLS_PRF_PARAMS {
1558   CK_BYTE_PTR  pSeed;
1559   CK_ULONG     ulSeedLen;
1560   CK_BYTE_PTR  pLabel;
1561   CK_ULONG     ulLabelLen;
1562   CK_BYTE_PTR  pOutput;
1563   CK_ULONG_PTR pulOutputLen;
1564 } CK_TLS_PRF_PARAMS;
1565 
1566 typedef CK_TLS_PRF_PARAMS CK_PTR CK_TLS_PRF_PARAMS_PTR;
1567 
1568 /* WTLS is new for version 2.20 */
1569 typedef struct CK_WTLS_RANDOM_DATA {
1570   CK_BYTE_PTR pClientRandom;
1571   CK_ULONG    ulClientRandomLen;
1572   CK_BYTE_PTR pServerRandom;
1573   CK_ULONG    ulServerRandomLen;
1574 } CK_WTLS_RANDOM_DATA;
1575 
1576 typedef CK_WTLS_RANDOM_DATA CK_PTR CK_WTLS_RANDOM_DATA_PTR;
1577 
1578 typedef struct CK_WTLS_MASTER_KEY_DERIVE_PARAMS {
1579   CK_MECHANISM_TYPE   DigestMechanism;
1580   CK_WTLS_RANDOM_DATA RandomInfo;
1581   CK_BYTE_PTR         pVersion;
1582 } CK_WTLS_MASTER_KEY_DERIVE_PARAMS;
1583 
1584 typedef CK_WTLS_MASTER_KEY_DERIVE_PARAMS CK_PTR \
1585   CK_WTLS_MASTER_KEY_DERIVE_PARAMS_PTR;
1586 
1587 typedef struct CK_WTLS_PRF_PARAMS {
1588   CK_MECHANISM_TYPE DigestMechanism;
1589   CK_BYTE_PTR       pSeed;
1590   CK_ULONG          ulSeedLen;
1591   CK_BYTE_PTR       pLabel;
1592   CK_ULONG          ulLabelLen;
1593   CK_BYTE_PTR       pOutput;
1594   CK_ULONG_PTR      pulOutputLen;
1595 } CK_WTLS_PRF_PARAMS;
1596 
1597 typedef CK_WTLS_PRF_PARAMS CK_PTR CK_WTLS_PRF_PARAMS_PTR;
1598 
1599 typedef struct CK_WTLS_KEY_MAT_OUT {
1600   CK_OBJECT_HANDLE hMacSecret;
1601   CK_OBJECT_HANDLE hKey;
1602   CK_BYTE_PTR      pIV;
1603 } CK_WTLS_KEY_MAT_OUT;
1604 
1605 typedef CK_WTLS_KEY_MAT_OUT CK_PTR CK_WTLS_KEY_MAT_OUT_PTR;
1606 
1607 typedef struct CK_WTLS_KEY_MAT_PARAMS {
1608   CK_MECHANISM_TYPE       DigestMechanism;
1609   CK_ULONG                ulMacSizeInBits;
1610   CK_ULONG                ulKeySizeInBits;
1611   CK_ULONG                ulIVSizeInBits;
1612   CK_ULONG                ulSequenceNumber;
1613   CK_BBOOL                bIsExport;
1614   CK_WTLS_RANDOM_DATA     RandomInfo;
1615   CK_WTLS_KEY_MAT_OUT_PTR pReturnedKeyMaterial;
1616 } CK_WTLS_KEY_MAT_PARAMS;
1617 
1618 typedef CK_WTLS_KEY_MAT_PARAMS CK_PTR CK_WTLS_KEY_MAT_PARAMS_PTR;
1619 
1620 /* CMS is new for version 2.20 */
1621 typedef struct CK_CMS_SIG_PARAMS {
1622   CK_OBJECT_HANDLE      certificateHandle;
1623   CK_MECHANISM_PTR      pSigningMechanism;
1624   CK_MECHANISM_PTR      pDigestMechanism;
1625   CK_UTF8CHAR_PTR       pContentType;
1626   CK_BYTE_PTR           pRequestedAttributes;
1627   CK_ULONG              ulRequestedAttributesLen;
1628   CK_BYTE_PTR           pRequiredAttributes;
1629   CK_ULONG              ulRequiredAttributesLen;
1630 } CK_CMS_SIG_PARAMS;
1631 
1632 typedef CK_CMS_SIG_PARAMS CK_PTR CK_CMS_SIG_PARAMS_PTR;
1633 
1634 typedef struct CK_KEY_DERIVATION_STRING_DATA {
1635   CK_BYTE_PTR pData;
1636   CK_ULONG    ulLen;
1637 } CK_KEY_DERIVATION_STRING_DATA;
1638 
1639 typedef CK_KEY_DERIVATION_STRING_DATA CK_PTR \
1640   CK_KEY_DERIVATION_STRING_DATA_PTR;
1641 
1642 
1643 /* The CK_EXTRACT_PARAMS is used for the
1644  * CKM_EXTRACT_KEY_FROM_KEY mechanism.  It specifies which bit
1645  * of the base key should be used as the first bit of the
1646  * derived key */
1647 /* CK_EXTRACT_PARAMS is new for v2.0 */
1648 typedef CK_ULONG CK_EXTRACT_PARAMS;
1649 
1650 typedef CK_EXTRACT_PARAMS CK_PTR CK_EXTRACT_PARAMS_PTR;
1651 
1652 /* CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE is new for v2.10.
1653  * CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE is used to
1654  * indicate the Pseudo-Random Function (PRF) used to generate
1655  * key bits using PKCS #5 PBKDF2. */
1656 typedef CK_ULONG CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE;
1657 
1658 typedef CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE CK_PTR CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE_PTR;
1659 
1660 /* The following PRFs are defined in PKCS #5 v2.0. */
1661 #define CKP_PKCS5_PBKD2_HMAC_SHA1 0x00000001
1662 
1663 
1664 /* CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE is new for v2.10.
1665  * CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE is used to indicate the
1666  * source of the salt value when deriving a key using PKCS #5
1667  * PBKDF2. */
1668 typedef CK_ULONG CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE;
1669 
1670 typedef CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE CK_PTR CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE_PTR;
1671 
1672 /* The following salt value sources are defined in PKCS #5 v2.0. */
1673 #define CKZ_SALT_SPECIFIED        0x00000001
1674 
1675 /* CK_PKCS5_PBKD2_PARAMS is new for v2.10.
1676  * CK_PKCS5_PBKD2_PARAMS is a structure that provides the
1677  * parameters to the CKM_PKCS5_PBKD2 mechanism. */
1678 typedef struct CK_PKCS5_PBKD2_PARAMS {
1679         CK_PKCS5_PBKDF2_SALT_SOURCE_TYPE           saltSource;
1680         CK_VOID_PTR                                pSaltSourceData;
1681         CK_ULONG                                   ulSaltSourceDataLen;
1682         CK_ULONG                                   iterations;
1683         CK_PKCS5_PBKD2_PSEUDO_RANDOM_FUNCTION_TYPE prf;
1684         CK_VOID_PTR                                pPrfData;
1685         CK_ULONG                                   ulPrfDataLen;
1686         CK_UTF8CHAR_PTR                            pPassword;
1687         CK_ULONG_PTR                               ulPasswordLen;
1688 } CK_PKCS5_PBKD2_PARAMS;
1689 
1690 typedef CK_PKCS5_PBKD2_PARAMS CK_PTR CK_PKCS5_PBKD2_PARAMS_PTR;
1691 
1692 /* new for v2.40 */
1693 
1694 typedef struct CK_TLS12_MASTER_KEY_DERIVE_PARAMS {
1695   CK_SSL3_RANDOM_DATA       RandomInfo;
1696   CK_VERSION_PTR            pVersion;
1697   CK_MECHANISM_TYPE         prfHashMechanism;
1698 } CK_TLS12_MASTER_KEY_DERIVE_PARAMS;
1699 
1700 typedef CK_TLS12_MASTER_KEY_DERIVE_PARAMS CK_PTR CK_TLS12_MASTER_KEY_DERIVE_PARAMS_PTR;
1701 
1702 typedef struct CK_TLS12_KEY_MAT_PARAMS {
1703   CK_ULONG ulMacSizeInBits;
1704   CK_ULONG ulKeySizeInBits;
1705   CK_ULONG ulIVSizeInBits;
1706   CK_BBOOL bIsExport;
1707   CK_SSL3_RANDOM_DATA RandomInfo;
1708   CK_SSL3_KEY_MAT_OUT_PTR pReturnedKeyMaterial;
1709   CK_MECHANISM_TYPE prfHashMechanism;
1710 } CK_TLS12_KEY_MAT_PARAMS;
1711 
1712 typedef CK_TLS12_KEY_MAT_PARAMS CK_PTR CK_TLS12_KEY_MAT_PARAMS_PTR;
1713 
1714 typedef struct CK_TLS_MAC_PARAMS {
1715   CK_MECHANISM_TYPE prfMechanism;
1716   CK_ULONG ulMacLength;
1717   CK_ULONG ulServerOrClient;
1718 } CK_TLS_MAC_PARAMS;
1719 
1720 typedef CK_TLS_MAC_PARAMS CK_PTR CK_TLS_MAC_PARAMS_PTR;
1721 
1722 #endif
    </pre>
  </body>
</html>