<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.crypto.cryptoki/share/classes/sun/security/pkcs11/wrapper/PKCS11.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Functions.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="PKCS11Constants.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.crypto.cryptoki/share/classes/sun/security/pkcs11/wrapper/PKCS11.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2003, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   3  */
   4 
   5 /* Copyright  (c) 2002 Graz University of Technology. All rights reserved.
   6  *
   7  * Redistribution and use in  source and binary forms, with or without
   8  * modification, are permitted  provided that the following conditions are met:
   9  *
  10  * 1. Redistributions of  source code must retain the above copyright notice,
  11  *    this list of conditions and the following disclaimer.
  12  *
  13  * 2. Redistributions in  binary form must reproduce the above copyright notice,
  14  *    this list of conditions and the following disclaimer in the documentation
  15  *    and/or other materials provided with the distribution.
  16  *
  17  * 3. The end-user documentation included with the redistribution, if any, must
  18  *    include the following acknowledgment:
  19  *
  20  *    &quot;This product includes software developed by IAIK of Graz University of
  21  *     Technology.&quot;
  22  *
</pre>
<hr />
<pre>
  80     static {
  81         // cannot use LoadLibraryAction because that would make the native
  82         // library available to the bootclassloader, but we run in the
  83         // extension classloader.
  84         AccessController.doPrivileged(new PrivilegedAction&lt;Object&gt;() {
  85             public Object run() {
  86                 System.loadLibrary(PKCS11_WRAPPER);
  87                 return null;
  88             }
  89         });
  90         boolean enableDebug = Debug.getInstance(&quot;sunpkcs11&quot;) != null;
  91         initializeLibrary(enableDebug);
  92     }
  93 
  94     public static void loadNative() {
  95         // dummy method that can be called to make sure the native
  96         // portion has been loaded. actual loading happens in the
  97         // static initializer, hence this method is empty.
  98     }
  99 






 100     /**
 101      * The PKCS#11 module to connect to. This is the PKCS#11 driver of the token;
 102      * e.g. pk2priv.dll.
 103      */
 104     private final String pkcs11ModulePath;
 105 
 106     private long pNativeData;
 107 
 108     /**
 109      * This method does the initialization of the native library. It is called
 110      * exactly once for this class.
 111      *
 112      * @preconditions
 113      * @postconditions
 114      */
 115     private static native void initializeLibrary(boolean debug);
 116 
 117     // XXX
 118     /**
 119      * This method does the finalization of the native library. It is called
</pre>
<hr />
<pre>
 712      * @param hSession the session&#39;s handle
 713      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 714      * @param pMechanism the encryption mechanism
 715      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
 716      * @param hKey the handle of the encryption key
 717      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
 718      * @exception PKCS11Exception If function returns other value than CKR_OK.
 719      * @preconditions
 720      * @postconditions
 721      */
 722     public native void C_EncryptInit(long hSession, CK_MECHANISM pMechanism,
 723             long hKey) throws PKCS11Exception;
 724 
 725 
 726     /**
 727      * C_Encrypt encrypts single-part data.
 728      * (Encryption and decryption)
 729      *
 730      * @param hSession the session&#39;s handle
 731      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<span class="line-modified"> 732      * @param pData the data to get encrypted and the data&#39;s length</span>



 733      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG ulDataLen)
<span class="line-modified"> 734      * @return the encrypted data and the encrypted data&#39;s length</span>




 735      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedData,
 736      *                         CK_ULONG_PTR pulEncryptedDataLen)
 737      * @exception PKCS11Exception If function returns other value than CKR_OK.
<span class="line-modified"> 738      * @preconditions (pData &lt;&gt; null)</span>
<span class="line-modified"> 739      * @postconditions (result &lt;&gt; null)</span>
 740      */
<span class="line-modified"> 741     public native int C_Encrypt(long hSession, byte[] in, int inOfs, int inLen,</span>
<span class="line-modified"> 742             byte[] out, int outOfs, int outLen) throws PKCS11Exception;</span>

 743 
 744 
 745     /**
 746      * C_EncryptUpdate continues a multiple-part encryption
 747      * operation.
 748      * (Encryption and decryption)
 749      *
 750      * @param hSession the session&#39;s handle
 751      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<span class="line-modified"> 752      * @param pPart the data part to get encrypted and the data part&#39;s length</span>



 753      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
<span class="line-modified"> 754      * @return the encrypted data part and the encrypted data part&#39;s length</span>




 755      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,
 756                              CK_ULONG_PTR pulEncryptedPartLen)
 757      * @exception PKCS11Exception If function returns other value than CKR_OK.
<span class="line-modified"> 758      * @preconditions (pPart &lt;&gt; null)</span>
 759      * @postconditions
 760      */
 761     public native int C_EncryptUpdate(long hSession, long directIn, byte[] in,
 762             int inOfs, int inLen, long directOut, byte[] out, int outOfs,
 763             int outLen) throws PKCS11Exception;
 764 
 765 
 766     /**
 767      * C_EncryptFinal finishes a multiple-part encryption
 768      * operation.
 769      * (Encryption and decryption)
 770      *
 771      * @param hSession the session&#39;s handle
 772      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<span class="line-modified"> 773      * @return the last encrypted data part and the last data part&#39;s length</span>




 774      *         (PKCS#11 param: CK_BYTE_PTR pLastEncryptedPart,
 775                              CK_ULONG_PTR pulLastEncryptedPartLen)
 776      * @exception PKCS11Exception If function returns other value than CKR_OK.
 777      * @preconditions
<span class="line-modified"> 778      * @postconditions (result &lt;&gt; null)</span>
 779      */
 780     public native int C_EncryptFinal(long hSession, long directOut, byte[] out,
 781             int outOfs, int outLen) throws PKCS11Exception;
 782 
 783 
 784     /**
 785      * C_DecryptInit initializes a decryption operation.
 786      * (Encryption and decryption)
 787      *
 788      * @param hSession the session&#39;s handle
 789      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 790      * @param pMechanism the decryption mechanism
 791      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
 792      * @param hKey the handle of the decryption key
 793      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
 794      * @exception PKCS11Exception If function returns other value than CKR_OK.
 795      * @preconditions
 796      * @postconditions
 797      */
 798     public native void C_DecryptInit(long hSession, CK_MECHANISM pMechanism,
 799             long hKey) throws PKCS11Exception;
 800 
 801 
 802     /**
 803      * C_Decrypt decrypts encrypted data in a single part.
 804      * (Encryption and decryption)
 805      *
 806      * @param hSession the session&#39;s handle
 807      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<span class="line-modified"> 808      * @param pEncryptedData the encrypted data to get decrypted and the</span>
<span class="line-modified"> 809      *         encrypted data&#39;s length</span>
<span class="line-modified"> 810      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedData,</span>
<span class="line-modified"> 811      *                         CK_ULONG ulEncryptedDataLen)</span>
<span class="line-modified"> 812      * @return the decrypted data and the data&#39;s length</span>






 813      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG_PTR pulDataLen)
 814      * @exception PKCS11Exception If function returns other value than CKR_OK.
<span class="line-modified"> 815      * @preconditions (pEncryptedPart &lt;&gt; null)</span>
<span class="line-modified"> 816      * @postconditions (result &lt;&gt; null)</span>
 817      */
<span class="line-modified"> 818     public native int C_Decrypt(long hSession, byte[] in, int inOfs, int inLen,</span>
<span class="line-modified"> 819             byte[] out, int outOfs, int outLen) throws PKCS11Exception;</span>

 820 
 821 
 822     /**
 823      * C_DecryptUpdate continues a multiple-part decryption
 824      * operation.
 825      * (Encryption and decryption)
 826      *
 827      * @param hSession the session&#39;s handle
 828      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<span class="line-modified"> 829      * @param pEncryptedPart the encrypted data part to get decrypted and the</span>
<span class="line-modified"> 830      *         encrypted data part&#39;s length</span>
<span class="line-modified"> 831      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,</span>
<span class="line-modified"> 832      *                         CK_ULONG ulEncryptedPartLen)</span>
<span class="line-modified"> 833      * @return the decrypted data part and the data part&#39;s length</span>






 834      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG_PTR pulPartLen)
 835      * @exception PKCS11Exception If function returns other value than CKR_OK.
<span class="line-modified"> 836      * @preconditions (pEncryptedPart &lt;&gt; null)</span>
 837      * @postconditions
 838      */
 839     public native int C_DecryptUpdate(long hSession, long directIn, byte[] in,
 840             int inOfs, int inLen, long directOut, byte[] out, int outOfs,
 841             int outLen) throws PKCS11Exception;
 842 
 843 
 844     /**
 845      * C_DecryptFinal finishes a multiple-part decryption
 846      * operation.
 847      * (Encryption and decryption)
 848      *
 849      * @param hSession the session&#39;s handle
 850      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<span class="line-modified"> 851      * @return the last decrypted data part and the last data part&#39;s length</span>




 852      *         (PKCS#11 param: CK_BYTE_PTR pLastPart,
 853      *                         CK_ULONG_PTR pulLastPartLen)
 854      * @exception PKCS11Exception If function returns other value than CKR_OK.
 855      * @preconditions
<span class="line-modified"> 856      * @postconditions (result &lt;&gt; null)</span>
 857      */
 858     public native int C_DecryptFinal(long hSession, long directOut, byte[] out,
 859             int outOfs, int outLen) throws PKCS11Exception;
 860 
 861 
 862 
 863 /* *****************************************************************************
 864  * Message digesting
 865  ******************************************************************************/
 866 
 867     /**
 868      * C_DigestInit initializes a message-digesting operation.
 869      * (Message digesting)
 870      *
 871      * @param hSession the session&#39;s handle
 872      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 873      * @param pMechanism the digesting mechanism
 874      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
 875      * @exception PKCS11Exception If function returns other value than CKR_OK.
 876      * @preconditions
</pre>
<hr />
<pre>
1010      *
1011      * @param hSession the session&#39;s handle
1012      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1013      * @param pPart the data part to sign and the data part&#39;s length
1014      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
1015      * @exception PKCS11Exception If function returns other value than CKR_OK.
1016      * @preconditions (pPart &lt;&gt; null)
1017      * @postconditions
1018      */
1019     public native void C_SignUpdate(long hSession, long directIn, byte[] in,
1020             int inOfs, int inLen) throws PKCS11Exception;
1021 
1022 
1023     /**
1024      * C_SignFinal finishes a multiple-part signature operation,
1025      * returning the signature.
1026      * (Signing and MACing)
1027      *
1028      * @param hSession the session&#39;s handle
1029      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)

1030      * @return the signature and the signature&#39;s length
1031      *         (PKCS#11 param: CK_BYTE_PTR pSignature,
1032      *                         CK_ULONG_PTR pulSignatureLen)
1033      * @exception PKCS11Exception If function returns other value than CKR_OK.
1034      * @preconditions
1035      * @postconditions (result &lt;&gt; null)
1036      */
1037     public native byte[] C_SignFinal(long hSession, int expectedLen)
1038             throws PKCS11Exception;
1039 
1040 
1041     /**
1042      * C_SignRecoverInit initializes a signature operation, where
1043      * the data can be recovered from the signature.
1044      * (Signing and MACing)
1045      *
1046      * @param hSession the session&#39;s handle
1047      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1048      * @param pMechanism the signature mechanism
1049      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
</pre>
<hr />
<pre>
1268      * C_DecryptVerifyUpdate continues a multiple-part decryption and
1269      * verify operation.
1270      * (Dual-function cryptographic operations)
1271      *
1272      * @param hSession the session&#39;s handle
1273      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1274      * @param pEncryptedPart the encrypted data part to decrypt and to verify
1275      *         and the data part&#39;s length
1276      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,
1277      *                         CK_ULONG ulEncryptedPartLen)
1278      * @return the decrypted and verified data part and the data part&#39;s length
1279      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG_PTR pulPartLen)
1280      * @exception PKCS11Exception If function returns other value than CKR_OK.
1281      * @preconditions (pEncryptedPart &lt;&gt; null)
1282      * @postconditions
1283      */
1284 //    public native byte[] C_DecryptVerifyUpdate(long hSession,
1285 //            byte[] pEncryptedPart) throws PKCS11Exception;
1286 
1287 
<span class="line-removed">1288 </span>
1289 /* *****************************************************************************
1290  * Key management
1291  ******************************************************************************/
1292 
1293     /**
1294      * getNativeKeyInfo gets the key object attributes and values as an opaque
1295      * byte array to be used in createNativeKey method.
1296      * (Key management)
1297      *
1298      * @param hSession the session&#39;s handle
1299      * @param hKey key&#39;s handle
1300      * @param hWrappingKey key handle for wrapping the extracted sensitive keys.
1301      *        -1 if not used.
1302      * @param pWrappingMech mechanism for wrapping the extracted sensitive keys
1303      * @return an opaque byte array containing the key object attributes
1304      *         and values
1305      * @exception PKCS11Exception If an internal PKCS#11 function returns other
1306      *            value than CKR_OK.
1307      * @preconditions
1308      * @postconditions
</pre>
<hr />
<pre>
1675     public synchronized void C_FindObjectsInit(long hSession,
1676             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception {
1677         super.C_FindObjectsInit(hSession, pTemplate);
1678     }
1679 
1680     public synchronized long[] C_FindObjects(long hSession,
1681             long ulMaxObjectCount) throws PKCS11Exception {
1682         return super.C_FindObjects(hSession, ulMaxObjectCount);
1683     }
1684 
1685     public synchronized void C_FindObjectsFinal(long hSession)
1686             throws PKCS11Exception {
1687         super.C_FindObjectsFinal(hSession);
1688     }
1689 
1690     public synchronized void C_EncryptInit(long hSession,
1691             CK_MECHANISM pMechanism, long hKey) throws PKCS11Exception {
1692         super.C_EncryptInit(hSession, pMechanism, hKey);
1693     }
1694 
<span class="line-modified">1695     public synchronized int C_Encrypt(long hSession, byte[] in, int inOfs,</span>
<span class="line-modified">1696             int inLen, byte[] out, int outOfs, int outLen)</span>
1697             throws PKCS11Exception {
<span class="line-modified">1698         return super.C_Encrypt(hSession, in, inOfs, inLen, out, outOfs, outLen);</span>

1699     }
1700 
1701     public synchronized int C_EncryptUpdate(long hSession, long directIn,
1702             byte[] in, int inOfs, int inLen, long directOut, byte[] out,
1703             int outOfs, int outLen) throws PKCS11Exception {
1704         return super.C_EncryptUpdate(hSession, directIn, in, inOfs, inLen,
1705                 directOut, out, outOfs, outLen);
1706     }
1707 
1708     public synchronized int C_EncryptFinal(long hSession, long directOut,
1709             byte[] out, int outOfs, int outLen) throws PKCS11Exception {
1710         return super.C_EncryptFinal(hSession, directOut, out, outOfs, outLen);
1711     }
1712 
1713     public synchronized void C_DecryptInit(long hSession,
1714             CK_MECHANISM pMechanism, long hKey) throws PKCS11Exception {
1715         super.C_DecryptInit(hSession, pMechanism, hKey);
1716     }
1717 
<span class="line-modified">1718     public synchronized int C_Decrypt(long hSession, byte[] in, int inOfs,</span>
<span class="line-modified">1719             int inLen, byte[] out, int outOfs, int outLen)</span>
<span class="line-modified">1720             throws PKCS11Exception {</span>
<span class="line-modified">1721         return super.C_Decrypt(hSession, in, inOfs, inLen, out, outOfs, outLen);</span>

1722     }
1723 
1724     public synchronized int C_DecryptUpdate(long hSession, long directIn,
1725             byte[] in, int inOfs, int inLen, long directOut, byte[] out,
1726             int outOfs, int outLen) throws PKCS11Exception {
1727         return super.C_DecryptUpdate(hSession, directIn, in, inOfs, inLen,
1728                 directOut, out, outOfs, outLen);
1729     }
1730 
1731     public synchronized int C_DecryptFinal(long hSession, long directOut,
1732             byte[] out, int outOfs, int outLen) throws PKCS11Exception {
1733         return super.C_DecryptFinal(hSession, directOut, out, outOfs, outLen);
1734     }
1735 
1736     public synchronized void C_DigestInit(long hSession, CK_MECHANISM pMechanism)
1737             throws PKCS11Exception {
1738         super.C_DigestInit(hSession, pMechanism);
1739     }
1740 
1741     public synchronized int C_DigestSingle(long hSession,
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   3  */
   4 
   5 /* Copyright  (c) 2002 Graz University of Technology. All rights reserved.
   6  *
   7  * Redistribution and use in  source and binary forms, with or without
   8  * modification, are permitted  provided that the following conditions are met:
   9  *
  10  * 1. Redistributions of  source code must retain the above copyright notice,
  11  *    this list of conditions and the following disclaimer.
  12  *
  13  * 2. Redistributions in  binary form must reproduce the above copyright notice,
  14  *    this list of conditions and the following disclaimer in the documentation
  15  *    and/or other materials provided with the distribution.
  16  *
  17  * 3. The end-user documentation included with the redistribution, if any, must
  18  *    include the following acknowledgment:
  19  *
  20  *    &quot;This product includes software developed by IAIK of Graz University of
  21  *     Technology.&quot;
  22  *
</pre>
<hr />
<pre>
  80     static {
  81         // cannot use LoadLibraryAction because that would make the native
  82         // library available to the bootclassloader, but we run in the
  83         // extension classloader.
  84         AccessController.doPrivileged(new PrivilegedAction&lt;Object&gt;() {
  85             public Object run() {
  86                 System.loadLibrary(PKCS11_WRAPPER);
  87                 return null;
  88             }
  89         });
  90         boolean enableDebug = Debug.getInstance(&quot;sunpkcs11&quot;) != null;
  91         initializeLibrary(enableDebug);
  92     }
  93 
  94     public static void loadNative() {
  95         // dummy method that can be called to make sure the native
  96         // portion has been loaded. actual loading happens in the
  97         // static initializer, hence this method is empty.
  98     }
  99 
<span class="line-added"> 100     /* *****************************************************************************</span>
<span class="line-added"> 101      * Utility, Resource Clean up</span>
<span class="line-added"> 102      ******************************************************************************/</span>
<span class="line-added"> 103     // always return 0L</span>
<span class="line-added"> 104     public static native long freeMechanism(long hMechanism);</span>
<span class="line-added"> 105 </span>
 106     /**
 107      * The PKCS#11 module to connect to. This is the PKCS#11 driver of the token;
 108      * e.g. pk2priv.dll.
 109      */
 110     private final String pkcs11ModulePath;
 111 
 112     private long pNativeData;
 113 
 114     /**
 115      * This method does the initialization of the native library. It is called
 116      * exactly once for this class.
 117      *
 118      * @preconditions
 119      * @postconditions
 120      */
 121     private static native void initializeLibrary(boolean debug);
 122 
 123     // XXX
 124     /**
 125      * This method does the finalization of the native library. It is called
</pre>
<hr />
<pre>
 718      * @param hSession the session&#39;s handle
 719      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 720      * @param pMechanism the encryption mechanism
 721      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
 722      * @param hKey the handle of the encryption key
 723      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
 724      * @exception PKCS11Exception If function returns other value than CKR_OK.
 725      * @preconditions
 726      * @postconditions
 727      */
 728     public native void C_EncryptInit(long hSession, CK_MECHANISM pMechanism,
 729             long hKey) throws PKCS11Exception;
 730 
 731 
 732     /**
 733      * C_Encrypt encrypts single-part data.
 734      * (Encryption and decryption)
 735      *
 736      * @param hSession the session&#39;s handle
 737      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<span class="line-modified"> 738      * @param directIn the address of the to-be-encrypted data</span>
<span class="line-added"> 739      * @param in buffer containing the to-be-encrypted data</span>
<span class="line-added"> 740      * @param inOfs buffer offset of the to-be-encrypted data</span>
<span class="line-added"> 741      * @param inLen length of the to-be-encrypted data</span>
 742      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG ulDataLen)
<span class="line-modified"> 743      * @param directOut the address for the encrypted data</span>
<span class="line-added"> 744      * @param out buffer for the encrypted data</span>
<span class="line-added"> 745      * @param outOfs buffer offset for the encrypted data</span>
<span class="line-added"> 746      * @param outLen buffer size for the encrypted data</span>
<span class="line-added"> 747      * @return the length of encrypted data</span>
 748      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedData,
 749      *                         CK_ULONG_PTR pulEncryptedDataLen)
 750      * @exception PKCS11Exception If function returns other value than CKR_OK.
<span class="line-modified"> 751      * @preconditions</span>
<span class="line-modified"> 752      * @postconditions</span>
 753      */
<span class="line-modified"> 754     public native int C_Encrypt(long hSession, long directIn, byte[] in,</span>
<span class="line-modified"> 755             int inOfs, int inLen, long directOut, byte[] out, int outOfs,</span>
<span class="line-added"> 756             int outLen) throws PKCS11Exception;</span>
 757 
 758 
 759     /**
 760      * C_EncryptUpdate continues a multiple-part encryption
 761      * operation.
 762      * (Encryption and decryption)
 763      *
 764      * @param hSession the session&#39;s handle
 765      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<span class="line-modified"> 766      * @param directIn the address of the to-be-encrypted data</span>
<span class="line-added"> 767      * @param in buffer containing the to-be-encrypted data</span>
<span class="line-added"> 768      * @param inOfs buffer offset of the to-be-encrypted data</span>
<span class="line-added"> 769      * @param inLen length of the to-be-encrypted data</span>
 770      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
<span class="line-modified"> 771      * @param directOut the address for the encrypted data</span>
<span class="line-added"> 772      * @param out buffer for the encrypted data</span>
<span class="line-added"> 773      * @param outOfs buffer offset for the encrypted data</span>
<span class="line-added"> 774      * @param outLen buffer size for the encrypted data</span>
<span class="line-added"> 775      * @return the length of encrypted data for this update</span>
 776      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,
 777                              CK_ULONG_PTR pulEncryptedPartLen)
 778      * @exception PKCS11Exception If function returns other value than CKR_OK.
<span class="line-modified"> 779      * @preconditions</span>
 780      * @postconditions
 781      */
 782     public native int C_EncryptUpdate(long hSession, long directIn, byte[] in,
 783             int inOfs, int inLen, long directOut, byte[] out, int outOfs,
 784             int outLen) throws PKCS11Exception;
 785 
 786 
 787     /**
 788      * C_EncryptFinal finishes a multiple-part encryption
 789      * operation.
 790      * (Encryption and decryption)
 791      *
 792      * @param hSession the session&#39;s handle
 793      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<span class="line-modified"> 794      * @param directOut the address for the encrypted data</span>
<span class="line-added"> 795      * @param out buffer for the encrypted data</span>
<span class="line-added"> 796      * @param outOfs buffer offset for the encrypted data</span>
<span class="line-added"> 797      * @param outLen buffer size for the encrypted data</span>
<span class="line-added"> 798      * @return the length of the last part of the encrypted data</span>
 799      *         (PKCS#11 param: CK_BYTE_PTR pLastEncryptedPart,
 800                              CK_ULONG_PTR pulLastEncryptedPartLen)
 801      * @exception PKCS11Exception If function returns other value than CKR_OK.
 802      * @preconditions
<span class="line-modified"> 803      * @postconditions</span>
 804      */
 805     public native int C_EncryptFinal(long hSession, long directOut, byte[] out,
 806             int outOfs, int outLen) throws PKCS11Exception;
 807 
 808 
 809     /**
 810      * C_DecryptInit initializes a decryption operation.
 811      * (Encryption and decryption)
 812      *
 813      * @param hSession the session&#39;s handle
 814      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 815      * @param pMechanism the decryption mechanism
 816      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
 817      * @param hKey the handle of the decryption key
 818      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
 819      * @exception PKCS11Exception If function returns other value than CKR_OK.
 820      * @preconditions
 821      * @postconditions
 822      */
 823     public native void C_DecryptInit(long hSession, CK_MECHANISM pMechanism,
 824             long hKey) throws PKCS11Exception;
 825 
 826 
 827     /**
 828      * C_Decrypt decrypts encrypted data in a single part.
 829      * (Encryption and decryption)
 830      *
 831      * @param hSession the session&#39;s handle
 832      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<span class="line-modified"> 833      * @param directIn the address of the to-be-decrypted data</span>
<span class="line-modified"> 834      * @param in buffer containing the to-be-decrypted data</span>
<span class="line-modified"> 835      * @param inOfs buffer offset of the to-be-decrypted data</span>
<span class="line-modified"> 836      * @param inLen length of the to-be-decrypted data</span>
<span class="line-modified"> 837      *         (PKCS#11 param: CK_BYTE_PTR pDecryptedData,</span>
<span class="line-added"> 838      *                         CK_ULONG ulDecryptedDataLen)</span>
<span class="line-added"> 839      * @param directOut the address for the decrypted data</span>
<span class="line-added"> 840      * @param out buffer for the decrypted data</span>
<span class="line-added"> 841      * @param outOfs buffer offset for the decrypted data</span>
<span class="line-added"> 842      * @param outLen buffer size for the decrypted data</span>
<span class="line-added"> 843      * @return the length of decrypted data</span>
 844      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG_PTR pulDataLen)
 845      * @exception PKCS11Exception If function returns other value than CKR_OK.
<span class="line-modified"> 846      * @preconditions</span>
<span class="line-modified"> 847      * @postconditions</span>
 848      */
<span class="line-modified"> 849     public native int C_Decrypt(long hSession, long directIn, byte[] in,</span>
<span class="line-modified"> 850             int inOfs, int inLen, long directOut, byte[] out, int outOfs,</span>
<span class="line-added"> 851             int outLen) throws PKCS11Exception;</span>
 852 
 853 
 854     /**
 855      * C_DecryptUpdate continues a multiple-part decryption
 856      * operation.
 857      * (Encryption and decryption)
 858      *
 859      * @param hSession the session&#39;s handle
 860      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<span class="line-modified"> 861      * @param directIn the address of the to-be-decrypted data</span>
<span class="line-modified"> 862      * @param in buffer containing the to-be-decrypted data</span>
<span class="line-modified"> 863      * @param inOfs buffer offset of the to-be-decrypted data</span>
<span class="line-modified"> 864      * @param inLen length of the to-be-decrypted data</span>
<span class="line-modified"> 865      *         (PKCS#11 param: CK_BYTE_PTR pDecryptedPart,</span>
<span class="line-added"> 866      *                         CK_ULONG ulDecryptedPartLen)</span>
<span class="line-added"> 867      * @param directOut the address for the decrypted data</span>
<span class="line-added"> 868      * @param out buffer for the decrypted data</span>
<span class="line-added"> 869      * @param outOfs buffer offset for the decrypted data</span>
<span class="line-added"> 870      * @param outLen buffer size for the decrypted data</span>
<span class="line-added"> 871      * @return the length of decrypted data for this update</span>
 872      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG_PTR pulPartLen)
 873      * @exception PKCS11Exception If function returns other value than CKR_OK.
<span class="line-modified"> 874      * @preconditions</span>
 875      * @postconditions
 876      */
 877     public native int C_DecryptUpdate(long hSession, long directIn, byte[] in,
 878             int inOfs, int inLen, long directOut, byte[] out, int outOfs,
 879             int outLen) throws PKCS11Exception;
 880 
 881 
 882     /**
 883      * C_DecryptFinal finishes a multiple-part decryption
 884      * operation.
 885      * (Encryption and decryption)
 886      *
 887      * @param hSession the session&#39;s handle
 888      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<span class="line-modified"> 889      * @param directOut the address for the decrypted data</span>
<span class="line-added"> 890      * @param out buffer for the decrypted data</span>
<span class="line-added"> 891      * @param outOfs buffer offset for the decrypted data</span>
<span class="line-added"> 892      * @param outLen buffer size for the decrypted data</span>
<span class="line-added"> 893      * @return the length of this last part of decrypted data</span>
 894      *         (PKCS#11 param: CK_BYTE_PTR pLastPart,
 895      *                         CK_ULONG_PTR pulLastPartLen)
 896      * @exception PKCS11Exception If function returns other value than CKR_OK.
 897      * @preconditions
<span class="line-modified"> 898      * @postconditions</span>
 899      */
 900     public native int C_DecryptFinal(long hSession, long directOut, byte[] out,
 901             int outOfs, int outLen) throws PKCS11Exception;
 902 
 903 
 904 
 905 /* *****************************************************************************
 906  * Message digesting
 907  ******************************************************************************/
 908 
 909     /**
 910      * C_DigestInit initializes a message-digesting operation.
 911      * (Message digesting)
 912      *
 913      * @param hSession the session&#39;s handle
 914      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 915      * @param pMechanism the digesting mechanism
 916      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
 917      * @exception PKCS11Exception If function returns other value than CKR_OK.
 918      * @preconditions
</pre>
<hr />
<pre>
1052      *
1053      * @param hSession the session&#39;s handle
1054      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1055      * @param pPart the data part to sign and the data part&#39;s length
1056      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
1057      * @exception PKCS11Exception If function returns other value than CKR_OK.
1058      * @preconditions (pPart &lt;&gt; null)
1059      * @postconditions
1060      */
1061     public native void C_SignUpdate(long hSession, long directIn, byte[] in,
1062             int inOfs, int inLen) throws PKCS11Exception;
1063 
1064 
1065     /**
1066      * C_SignFinal finishes a multiple-part signature operation,
1067      * returning the signature.
1068      * (Signing and MACing)
1069      *
1070      * @param hSession the session&#39;s handle
1071      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<span class="line-added">1072      * @param expectedLen expected signature length, can be 0 if unknown</span>
1073      * @return the signature and the signature&#39;s length
1074      *         (PKCS#11 param: CK_BYTE_PTR pSignature,
1075      *                         CK_ULONG_PTR pulSignatureLen)
1076      * @exception PKCS11Exception If function returns other value than CKR_OK.
1077      * @preconditions
1078      * @postconditions (result &lt;&gt; null)
1079      */
1080     public native byte[] C_SignFinal(long hSession, int expectedLen)
1081             throws PKCS11Exception;
1082 
1083 
1084     /**
1085      * C_SignRecoverInit initializes a signature operation, where
1086      * the data can be recovered from the signature.
1087      * (Signing and MACing)
1088      *
1089      * @param hSession the session&#39;s handle
1090      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1091      * @param pMechanism the signature mechanism
1092      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
</pre>
<hr />
<pre>
1311      * C_DecryptVerifyUpdate continues a multiple-part decryption and
1312      * verify operation.
1313      * (Dual-function cryptographic operations)
1314      *
1315      * @param hSession the session&#39;s handle
1316      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1317      * @param pEncryptedPart the encrypted data part to decrypt and to verify
1318      *         and the data part&#39;s length
1319      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,
1320      *                         CK_ULONG ulEncryptedPartLen)
1321      * @return the decrypted and verified data part and the data part&#39;s length
1322      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG_PTR pulPartLen)
1323      * @exception PKCS11Exception If function returns other value than CKR_OK.
1324      * @preconditions (pEncryptedPart &lt;&gt; null)
1325      * @postconditions
1326      */
1327 //    public native byte[] C_DecryptVerifyUpdate(long hSession,
1328 //            byte[] pEncryptedPart) throws PKCS11Exception;
1329 
1330 

1331 /* *****************************************************************************
1332  * Key management
1333  ******************************************************************************/
1334 
1335     /**
1336      * getNativeKeyInfo gets the key object attributes and values as an opaque
1337      * byte array to be used in createNativeKey method.
1338      * (Key management)
1339      *
1340      * @param hSession the session&#39;s handle
1341      * @param hKey key&#39;s handle
1342      * @param hWrappingKey key handle for wrapping the extracted sensitive keys.
1343      *        -1 if not used.
1344      * @param pWrappingMech mechanism for wrapping the extracted sensitive keys
1345      * @return an opaque byte array containing the key object attributes
1346      *         and values
1347      * @exception PKCS11Exception If an internal PKCS#11 function returns other
1348      *            value than CKR_OK.
1349      * @preconditions
1350      * @postconditions
</pre>
<hr />
<pre>
1717     public synchronized void C_FindObjectsInit(long hSession,
1718             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception {
1719         super.C_FindObjectsInit(hSession, pTemplate);
1720     }
1721 
1722     public synchronized long[] C_FindObjects(long hSession,
1723             long ulMaxObjectCount) throws PKCS11Exception {
1724         return super.C_FindObjects(hSession, ulMaxObjectCount);
1725     }
1726 
1727     public synchronized void C_FindObjectsFinal(long hSession)
1728             throws PKCS11Exception {
1729         super.C_FindObjectsFinal(hSession);
1730     }
1731 
1732     public synchronized void C_EncryptInit(long hSession,
1733             CK_MECHANISM pMechanism, long hKey) throws PKCS11Exception {
1734         super.C_EncryptInit(hSession, pMechanism, hKey);
1735     }
1736 
<span class="line-modified">1737     public synchronized int C_Encrypt(long hSession, long directIn, byte[] in,</span>
<span class="line-modified">1738             int inOfs, int inLen, long directOut, byte[] out, int outOfs, int outLen)</span>
1739             throws PKCS11Exception {
<span class="line-modified">1740         return super.C_Encrypt(hSession, directIn, in, inOfs, inLen,</span>
<span class="line-added">1741                 directOut, out, outOfs, outLen);</span>
1742     }
1743 
1744     public synchronized int C_EncryptUpdate(long hSession, long directIn,
1745             byte[] in, int inOfs, int inLen, long directOut, byte[] out,
1746             int outOfs, int outLen) throws PKCS11Exception {
1747         return super.C_EncryptUpdate(hSession, directIn, in, inOfs, inLen,
1748                 directOut, out, outOfs, outLen);
1749     }
1750 
1751     public synchronized int C_EncryptFinal(long hSession, long directOut,
1752             byte[] out, int outOfs, int outLen) throws PKCS11Exception {
1753         return super.C_EncryptFinal(hSession, directOut, out, outOfs, outLen);
1754     }
1755 
1756     public synchronized void C_DecryptInit(long hSession,
1757             CK_MECHANISM pMechanism, long hKey) throws PKCS11Exception {
1758         super.C_DecryptInit(hSession, pMechanism, hKey);
1759     }
1760 
<span class="line-modified">1761     public synchronized int C_Decrypt(long hSession, long directIn,</span>
<span class="line-modified">1762             byte[] in, int inOfs, int inLen, long directOut, byte[] out,</span>
<span class="line-modified">1763             int outOfs, int outLen) throws PKCS11Exception {</span>
<span class="line-modified">1764         return super.C_Decrypt(hSession, directIn, in, inOfs, inLen,</span>
<span class="line-added">1765                 directOut, out, outOfs, outLen);</span>
1766     }
1767 
1768     public synchronized int C_DecryptUpdate(long hSession, long directIn,
1769             byte[] in, int inOfs, int inLen, long directOut, byte[] out,
1770             int outOfs, int outLen) throws PKCS11Exception {
1771         return super.C_DecryptUpdate(hSession, directIn, in, inOfs, inLen,
1772                 directOut, out, outOfs, outLen);
1773     }
1774 
1775     public synchronized int C_DecryptFinal(long hSession, long directOut,
1776             byte[] out, int outOfs, int outLen) throws PKCS11Exception {
1777         return super.C_DecryptFinal(hSession, directOut, out, outOfs, outLen);
1778     }
1779 
1780     public synchronized void C_DigestInit(long hSession, CK_MECHANISM pMechanism)
1781             throws PKCS11Exception {
1782         super.C_DigestInit(hSession, pMechanism);
1783     }
1784 
1785     public synchronized int C_DigestSingle(long hSession,
</pre>
</td>
</tr>
</table>
<center><a href="Functions.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="PKCS11Constants.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>