<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/jdk.crypto.cryptoki/share/classes/sun/security/pkcs11/wrapper/PKCS11.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>   1 /*
<a name="1" id="anc1"></a><span class="line-modified">   2  * Copyright (c) 2003, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   3  */
   4 
   5 /* Copyright  (c) 2002 Graz University of Technology. All rights reserved.
   6  *
   7  * Redistribution and use in  source and binary forms, with or without
   8  * modification, are permitted  provided that the following conditions are met:
   9  *
  10  * 1. Redistributions of  source code must retain the above copyright notice,
  11  *    this list of conditions and the following disclaimer.
  12  *
  13  * 2. Redistributions in  binary form must reproduce the above copyright notice,
  14  *    this list of conditions and the following disclaimer in the documentation
  15  *    and/or other materials provided with the distribution.
  16  *
  17  * 3. The end-user documentation included with the redistribution, if any, must
  18  *    include the following acknowledgment:
  19  *
  20  *    &quot;This product includes software developed by IAIK of Graz University of
  21  *     Technology.&quot;
  22  *
  23  *    Alternately, this acknowledgment may appear in the software itself, if
  24  *    and wherever such third-party acknowledgments normally appear.
  25  *
  26  * 4. The names &quot;Graz University of Technology&quot; and &quot;IAIK of Graz University of
  27  *    Technology&quot; must not be used to endorse or promote products derived from
  28  *    this software without prior written permission.
  29  *
  30  * 5. Products derived from this software may not be called
  31  *    &quot;IAIK PKCS Wrapper&quot;, nor may &quot;IAIK&quot; appear in their name, without prior
  32  *    written permission of Graz University of Technology.
  33  *
  34  *  THIS SOFTWARE IS PROVIDED &quot;AS IS&quot; AND ANY EXPRESSED OR IMPLIED
  35  *  WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
  36  *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  37  *  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE LICENSOR BE
  38  *  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,
  39  *  OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  40  *  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
  41  *  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
  42  *  ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  43  *  OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
  44  *  OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  45  *  POSSIBILITY  OF SUCH DAMAGE.
  46  */
  47 
  48 package sun.security.pkcs11.wrapper;
  49 
  50 import java.io.File;
  51 import java.io.IOException;
  52 import java.util.*;
  53 
  54 import java.security.AccessController;
  55 import java.security.PrivilegedAction;
  56 
  57 import sun.security.util.Debug;
  58 
  59 import static sun.security.pkcs11.wrapper.PKCS11Constants.*;
  60 
  61 /**
  62  * This is the default implementation of the PKCS11 interface. IT connects to
  63  * the pkcs11wrapper.dll file, which is the native part of this library.
  64  * The strange and awkward looking initialization was chosen to avoid calling
  65  * loadLibrary from a static initialization block, because this would complicate
  66  * the use in applets.
  67  *
  68  * @author Karl Scheibelhofer &lt;Karl.Scheibelhofer@iaik.at&gt;
  69  * @author Martin Schlaeffer &lt;schlaeff@sbox.tugraz.at&gt;
  70  * @invariants (pkcs11ModulePath_ &lt;&gt; null)
  71  */
  72 public class PKCS11 {
  73 
  74     /**
  75      * The name of the native part of the wrapper; i.e. the filename without
  76      * the extension (e.g. &quot;.DLL&quot; or &quot;.so&quot;).
  77      */
  78     private static final String PKCS11_WRAPPER = &quot;j2pkcs11&quot;;
  79 
  80     static {
  81         // cannot use LoadLibraryAction because that would make the native
  82         // library available to the bootclassloader, but we run in the
  83         // extension classloader.
  84         AccessController.doPrivileged(new PrivilegedAction&lt;Object&gt;() {
  85             public Object run() {
  86                 System.loadLibrary(PKCS11_WRAPPER);
  87                 return null;
  88             }
  89         });
  90         boolean enableDebug = Debug.getInstance(&quot;sunpkcs11&quot;) != null;
  91         initializeLibrary(enableDebug);
  92     }
  93 
  94     public static void loadNative() {
  95         // dummy method that can be called to make sure the native
  96         // portion has been loaded. actual loading happens in the
  97         // static initializer, hence this method is empty.
  98     }
  99 
<a name="2" id="anc2"></a>





 100     /**
 101      * The PKCS#11 module to connect to. This is the PKCS#11 driver of the token;
 102      * e.g. pk2priv.dll.
 103      */
 104     private final String pkcs11ModulePath;
 105 
 106     private long pNativeData;
 107 
 108     /**
 109      * This method does the initialization of the native library. It is called
 110      * exactly once for this class.
 111      *
 112      * @preconditions
 113      * @postconditions
 114      */
 115     private static native void initializeLibrary(boolean debug);
 116 
 117     // XXX
 118     /**
 119      * This method does the finalization of the native library. It is called
 120      * exactly once for this class. The library uses this method for a clean-up
 121      * of any resources.
 122      *
 123      * @preconditions
 124      * @postconditions
 125      */
 126     private static native void finalizeLibrary();
 127 
 128     private static final Map&lt;String,PKCS11&gt; moduleMap =
 129         new HashMap&lt;String,PKCS11&gt;();
 130 
 131     /**
 132      * Connects to the PKCS#11 driver given. The filename must contain the
 133      * path, if the driver is not in the system&#39;s search path.
 134      *
 135      * @param pkcs11ModulePath the PKCS#11 library path
 136      * @preconditions (pkcs11ModulePath &lt;&gt; null)
 137      * @postconditions
 138      */
 139     PKCS11(String pkcs11ModulePath, String functionListName)
 140             throws IOException {
 141         connect(pkcs11ModulePath, functionListName);
 142         this.pkcs11ModulePath = pkcs11ModulePath;
 143     }
 144 
 145     public static synchronized PKCS11 getInstance(String pkcs11ModulePath,
 146             String functionList, CK_C_INITIALIZE_ARGS pInitArgs,
 147             boolean omitInitialize) throws IOException, PKCS11Exception {
 148         // we may only call C_Initialize once per native .so/.dll
 149         // so keep a cache using the (non-canonicalized!) path
 150         PKCS11 pkcs11 = moduleMap.get(pkcs11ModulePath);
 151         if (pkcs11 == null) {
 152             if ((pInitArgs != null)
 153                     &amp;&amp; ((pInitArgs.flags &amp; CKF_OS_LOCKING_OK) != 0)) {
 154                 pkcs11 = new PKCS11(pkcs11ModulePath, functionList);
 155             } else {
 156                 pkcs11 = new SynchronizedPKCS11(pkcs11ModulePath, functionList);
 157             }
 158             if (omitInitialize == false) {
 159                 try {
 160                     pkcs11.C_Initialize(pInitArgs);
 161                 } catch (PKCS11Exception e) {
 162                     // ignore already-initialized error code
 163                     // rethrow all other errors
 164                     if (e.getErrorCode() != CKR_CRYPTOKI_ALREADY_INITIALIZED) {
 165                         throw e;
 166                     }
 167                 }
 168             }
 169             moduleMap.put(pkcs11ModulePath, pkcs11);
 170         }
 171         return pkcs11;
 172     }
 173 
 174     /**
 175      * Connects this object to the specified PKCS#11 library. This method is for
 176      * internal use only.
 177      * Declared private, because incorrect handling may result in errors in the
 178      * native part.
 179      *
 180      * @param pkcs11ModulePath The PKCS#11 library path.
 181      * @preconditions (pkcs11ModulePath &lt;&gt; null)
 182      * @postconditions
 183      */
 184     private native void connect(String pkcs11ModulePath, String functionListName)
 185             throws IOException;
 186 
 187     /**
 188      * Disconnects the PKCS#11 library from this object. After calling this
 189      * method, this object is no longer connected to a native PKCS#11 module
 190      * and any subsequent calls to C_ methods will fail. This method is for
 191      * internal use only.
 192      * Declared private, because incorrect handling may result in errors in the
 193      * native part.
 194      *
 195      * @preconditions
 196      * @postconditions
 197      */
 198     private native void disconnect();
 199 
 200 
 201     // Implementation of PKCS11 methods delegated to native pkcs11wrapper library
 202 
 203 /* *****************************************************************************
 204  * General-purpose
 205  ******************************************************************************/
 206 
 207     /**
 208      * C_Initialize initializes the Cryptoki library.
 209      * (General-purpose)
 210      *
 211      * @param pInitArgs if pInitArgs is not NULL it gets casted to
 212      *         CK_C_INITIALIZE_ARGS_PTR and dereferenced
 213      *         (PKCS#11 param: CK_VOID_PTR pInitArgs)
 214      * @exception PKCS11Exception If function returns other value than CKR_OK.
 215      * @preconditions
 216      * @postconditions
 217      */
 218     native void C_Initialize(Object pInitArgs) throws PKCS11Exception;
 219 
 220     /**
 221      * C_Finalize indicates that an application is done with the
 222      * Cryptoki library
 223      * (General-purpose)
 224      *
 225      * @param pReserved is reserved. Should be NULL_PTR
 226      *         (PKCS#11 param: CK_VOID_PTR pReserved)
 227      * @exception PKCS11Exception If function returns other value than CKR_OK.
 228      * @preconditions (pReserved == null)
 229      * @postconditions
 230      */
 231     public native void C_Finalize(Object pReserved) throws PKCS11Exception;
 232 
 233 
 234     /**
 235      * C_GetInfo returns general information about Cryptoki.
 236      * (General-purpose)
 237      *
 238      * @return the information.
 239      *         (PKCS#11 param: CK_INFO_PTR pInfo)
 240      * @exception PKCS11Exception If function returns other value than CKR_OK.
 241      * @preconditions
 242      * @postconditions (result &lt;&gt; null)
 243      */
 244     public native CK_INFO C_GetInfo() throws PKCS11Exception;
 245 
 246 
 247 /* *****************************************************************************
 248  * Slot and token management
 249  ******************************************************************************/
 250 
 251     /**
 252      * C_GetSlotList obtains a list of slots in the system.
 253      * (Slot and token management)
 254      *
 255      * @param tokenPresent if true only Slot IDs with a token are returned
 256      *         (PKCS#11 param: CK_BBOOL tokenPresent)
 257      * @return a long array of slot IDs and number of Slot IDs
 258      *         (PKCS#11 param: CK_SLOT_ID_PTR pSlotList, CK_ULONG_PTR pulCount)
 259      * @exception PKCS11Exception If function returns other value than CKR_OK.
 260      * @preconditions
 261      * @postconditions (result &lt;&gt; null)
 262      */
 263     public native long[] C_GetSlotList(boolean tokenPresent)
 264             throws PKCS11Exception;
 265 
 266 
 267     /**
 268      * C_GetSlotInfo obtains information about a particular slot in
 269      * the system.
 270      * (Slot and token management)
 271      *
 272      * @param slotID the ID of the slot
 273      *         (PKCS#11 param: CK_SLOT_ID slotID)
 274      * @return the slot information
 275      *         (PKCS#11 param: CK_SLOT_INFO_PTR pInfo)
 276      * @exception PKCS11Exception If function returns other value than CKR_OK.
 277      * @preconditions
 278      * @postconditions (result &lt;&gt; null)
 279      */
 280     public native CK_SLOT_INFO C_GetSlotInfo(long slotID) throws PKCS11Exception;
 281 
 282 
 283     /**
 284      * C_GetTokenInfo obtains information about a particular token
 285      * in the system.
 286      * (Slot and token management)
 287      *
 288      * @param slotID ID of the token&#39;s slot
 289      *         (PKCS#11 param: CK_SLOT_ID slotID)
 290      * @return the token information
 291      *         (PKCS#11 param: CK_TOKEN_INFO_PTR pInfo)
 292      * @exception PKCS11Exception If function returns other value than CKR_OK.
 293      * @preconditions
 294      * @postconditions (result &lt;&gt; null)
 295      */
 296     public native CK_TOKEN_INFO C_GetTokenInfo(long slotID)
 297             throws PKCS11Exception;
 298 
 299 
 300     /**
 301      * C_GetMechanismList obtains a list of mechanism types
 302      * supported by a token.
 303      * (Slot and token management)
 304      *
 305      * @param slotID ID of the token&#39;s slot
 306      *         (PKCS#11 param: CK_SLOT_ID slotID)
 307      * @return a long array of mechanism types and number of mechanism types
 308      *         (PKCS#11 param: CK_MECHANISM_TYPE_PTR pMechanismList,
 309      *                         CK_ULONG_PTR pulCount)
 310      * @exception PKCS11Exception If function returns other value than CKR_OK.
 311      * @preconditions
 312      * @postconditions (result &lt;&gt; null)
 313      */
 314     public native long[] C_GetMechanismList(long slotID) throws PKCS11Exception;
 315 
 316 
 317     /**
 318      * C_GetMechanismInfo obtains information about a particular
 319      * mechanism possibly supported by a token.
 320      * (Slot and token management)
 321      *
 322      * @param slotID ID of the token&#39;s slot
 323      *         (PKCS#11 param: CK_SLOT_ID slotID)
 324      * @param type type of mechanism
 325      *         (PKCS#11 param: CK_MECHANISM_TYPE type)
 326      * @return the mechanism info
 327      *         (PKCS#11 param: CK_MECHANISM_INFO_PTR pInfo)
 328      * @exception PKCS11Exception If function returns other value than CKR_OK.
 329      * @preconditions
 330      * @postconditions (result &lt;&gt; null)
 331      */
 332     public native CK_MECHANISM_INFO C_GetMechanismInfo(long slotID, long type)
 333             throws PKCS11Exception;
 334 
 335 
 336     /**
 337      * C_InitToken initializes a token.
 338      * (Slot and token management)
 339      *
 340      * @param slotID ID of the token&#39;s slot
 341      *         (PKCS#11 param: CK_SLOT_ID slotID)
 342      * @param pPin the SO&#39;s initial PIN and the length in bytes of the PIN
 343      *         (PKCS#11 param: CK_CHAR_PTR pPin, CK_ULONG ulPinLen)
 344      * @param pLabel 32-byte token label (blank padded)
 345      *         (PKCS#11 param: CK_UTF8CHAR_PTR pLabel)
 346      * @exception PKCS11Exception If function returns other value than CKR_OK.
 347      * @preconditions
 348      * @postconditions
 349      */
 350 //    public native void C_InitToken(long slotID, char[] pPin, char[] pLabel)
 351 //            throws PKCS11Exception;
 352 
 353 
 354     /**
 355      * C_InitPIN initializes the normal user&#39;s PIN.
 356      * (Slot and token management)
 357      *
 358      * @param hSession the session&#39;s handle
 359      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 360      * @param pPin the normal user&#39;s PIN and the length in bytes of the PIN
 361      *         (PKCS#11 param: CK_CHAR_PTR pPin, CK_ULONG ulPinLen)
 362      * @exception PKCS11Exception If function returns other value than CKR_OK.
 363      * @preconditions
 364      * @postconditions
 365      */
 366 //    public native void C_InitPIN(long hSession, char[] pPin)
 367 //            throws PKCS11Exception;
 368 
 369 
 370     /**
 371      * C_SetPIN modifies the PIN of the user who is logged in.
 372      * (Slot and token management)
 373      *
 374      * @param hSession the session&#39;s handle
 375      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 376      * @param pOldPin the old PIN and the length of the old PIN
 377      *         (PKCS#11 param: CK_CHAR_PTR pOldPin, CK_ULONG ulOldLen)
 378      * @param pNewPin the new PIN and the length of the new PIN
 379      *         (PKCS#11 param: CK_CHAR_PTR pNewPin, CK_ULONG ulNewLen)
 380      * @exception PKCS11Exception If function returns other value than CKR_OK.
 381      * @preconditions
 382      * @postconditions
 383      */
 384 //    public native void C_SetPIN(long hSession, char[] pOldPin, char[] pNewPin)
 385 //            throws PKCS11Exception;
 386 
 387 
 388 
 389 /* *****************************************************************************
 390  * Session management
 391  ******************************************************************************/
 392 
 393     /**
 394      * C_OpenSession opens a session between an application and a
 395      * token.
 396      * (Session management)
 397      *
 398      * @param slotID the slot&#39;s ID
 399      *         (PKCS#11 param: CK_SLOT_ID slotID)
 400      * @param flags of CK_SESSION_INFO
 401      *         (PKCS#11 param: CK_FLAGS flags)
 402      * @param pApplication passed to callback
 403      *         (PKCS#11 param: CK_VOID_PTR pApplication)
 404      * @param Notify the callback function
 405      *         (PKCS#11 param: CK_NOTIFY Notify)
 406      * @return the session handle
 407      *         (PKCS#11 param: CK_SESSION_HANDLE_PTR phSession)
 408      * @exception PKCS11Exception If function returns other value than CKR_OK.
 409      * @preconditions
 410      * @postconditions
 411      */
 412     public native long C_OpenSession(long slotID, long flags,
 413             Object pApplication, CK_NOTIFY Notify) throws PKCS11Exception;
 414 
 415 
 416     /**
 417      * C_CloseSession closes a session between an application and a
 418      * token.
 419      * (Session management)
 420      *
 421      * @param hSession the session&#39;s handle
 422      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 423      * @exception PKCS11Exception If function returns other value than CKR_OK.
 424      * @preconditions
 425      * @postconditions
 426      */
 427     public native void C_CloseSession(long hSession) throws PKCS11Exception;
 428 
 429 
 430     /**
 431      * C_CloseAllSessions closes all sessions with a token.
 432      * (Session management)
 433      *
 434      * @param slotID the ID of the token&#39;s slot
 435      *         (PKCS#11 param: CK_SLOT_ID slotID)
 436      * @exception PKCS11Exception If function returns other value than CKR_OK.
 437      * @preconditions
 438      * @postconditions
 439      */
 440 //    public native void C_CloseAllSessions(long slotID) throws PKCS11Exception;
 441 
 442 
 443     /**
 444      * C_GetSessionInfo obtains information about the session.
 445      * (Session management)
 446      *
 447      * @param hSession the session&#39;s handle
 448      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 449      * @return the session info
 450      *         (PKCS#11 param: CK_SESSION_INFO_PTR pInfo)
 451      * @exception PKCS11Exception If function returns other value than CKR_OK.
 452      * @preconditions
 453      * @postconditions (result &lt;&gt; null)
 454      */
 455     public native CK_SESSION_INFO C_GetSessionInfo(long hSession)
 456             throws PKCS11Exception;
 457 
 458 
 459     /**
 460      * C_GetOperationState obtains the state of the cryptographic operation
 461      * in a session.
 462      * (Session management)
 463      *
 464      * @param hSession session&#39;s handle
 465      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 466      * @return the state and the state length
 467      *         (PKCS#11 param: CK_BYTE_PTR pOperationState,
 468      *                         CK_ULONG_PTR pulOperationStateLen)
 469      * @exception PKCS11Exception If function returns other value than CKR_OK.
 470      * @preconditions
 471      * @postconditions (result &lt;&gt; null)
 472      */
 473     public native byte[] C_GetOperationState(long hSession)
 474             throws PKCS11Exception;
 475 
 476 
 477     /**
 478      * C_SetOperationState restores the state of the cryptographic
 479      * operation in a session.
 480      * (Session management)
 481      *
 482      * @param hSession session&#39;s handle
 483      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 484      * @param pOperationState the state and the state length
 485      *         (PKCS#11 param: CK_BYTE_PTR pOperationState,
 486      *                         CK_ULONG ulOperationStateLen)
 487      * @param hEncryptionKey en/decryption key
 488      *         (PKCS#11 param: CK_OBJECT_HANDLE hEncryptionKey)
 489      * @param hAuthenticationKey sign/verify key
 490      *         (PKCS#11 param: CK_OBJECT_HANDLE hAuthenticationKey)
 491      * @exception PKCS11Exception If function returns other value than CKR_OK.
 492      * @preconditions
 493      * @postconditions
 494      */
 495     public native void C_SetOperationState(long hSession, byte[] pOperationState,
 496             long hEncryptionKey, long hAuthenticationKey) throws PKCS11Exception;
 497 
 498 
 499     /**
 500      * C_Login logs a user into a token.
 501      * (Session management)
 502      *
 503      * @param hSession the session&#39;s handle
 504      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 505      * @param userType the user type
 506      *         (PKCS#11 param: CK_USER_TYPE userType)
 507      * @param pPin the user&#39;s PIN and the length of the PIN
 508      *         (PKCS#11 param: CK_CHAR_PTR pPin, CK_ULONG ulPinLen)
 509      * @exception PKCS11Exception If function returns other value than CKR_OK.
 510      * @preconditions
 511      * @postconditions
 512      */
 513     public native void C_Login(long hSession, long userType, char[] pPin)
 514             throws PKCS11Exception;
 515 
 516 
 517     /**
 518      * C_Logout logs a user out from a token.
 519      * (Session management)
 520      *
 521      * @param hSession the session&#39;s handle
 522      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 523      * @exception PKCS11Exception If function returns other value than CKR_OK.
 524      * @preconditions
 525      * @postconditions
 526      */
 527     public native void C_Logout(long hSession) throws PKCS11Exception;
 528 
 529 
 530 
 531 /* *****************************************************************************
 532  * Object management
 533  ******************************************************************************/
 534 
 535     /**
 536      * C_CreateObject creates a new object.
 537      * (Object management)
 538      *
 539      * @param hSession the session&#39;s handle
 540      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 541      * @param pTemplate the object&#39;s template and number of attributes in
 542      *         template
 543      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
 544      * @return the object&#39;s handle
 545      *         (PKCS#11 param: CK_OBJECT_HANDLE_PTR phObject)
 546      * @exception PKCS11Exception If function returns other value than CKR_OK.
 547      * @preconditions
 548      * @postconditions
 549      */
 550     public native long C_CreateObject(long hSession, CK_ATTRIBUTE[] pTemplate)
 551             throws PKCS11Exception;
 552 
 553 
 554     /**
 555      * C_CopyObject copies an object, creating a new object for the
 556      * copy.
 557      * (Object management)
 558      *
 559      * @param hSession the session&#39;s handle
 560      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 561      * @param hObject the object&#39;s handle
 562      *         (PKCS#11 param: CK_OBJECT_HANDLE hObject)
 563      * @param pTemplate the template for the new object and number of attributes
 564      *         in template
 565      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
 566      * @return the handle of the copy
 567      *         (PKCS#11 param: CK_OBJECT_HANDLE_PTR phNewObject)
 568      * @exception PKCS11Exception If function returns other value than CKR_OK.
 569      * @preconditions
 570      * @postconditions
 571      */
 572     public native long C_CopyObject(long hSession, long hObject,
 573             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception;
 574 
 575 
 576     /**
 577      * C_DestroyObject destroys an object.
 578      * (Object management)
 579      *
 580      * @param hSession the session&#39;s handle
 581      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 582      * @param hObject the object&#39;s handle
 583      *         (PKCS#11 param: CK_OBJECT_HANDLE hObject)
 584      * @exception PKCS11Exception If function returns other value than CKR_OK.
 585      * @preconditions
 586      * @postconditions
 587      */
 588     public native void C_DestroyObject(long hSession, long hObject)
 589             throws PKCS11Exception;
 590 
 591 
 592     /**
 593      * C_GetObjectSize gets the size of an object in bytes.
 594      * (Object management)
 595      *
 596      * @param hSession the session&#39;s handle
 597      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 598      * @param hObject the object&#39;s handle
 599      *         (PKCS#11 param: CK_OBJECT_HANDLE hObject)
 600      * @return the size of the object
 601      *         (PKCS#11 param: CK_ULONG_PTR pulSize)
 602      * @exception PKCS11Exception If function returns other value than CKR_OK.
 603      * @preconditions
 604      * @postconditions
 605      */
 606 //    public native long C_GetObjectSize(long hSession, long hObject)
 607 //            throws PKCS11Exception;
 608 
 609 
 610     /**
 611      * C_GetAttributeValue obtains the value of one or more object
 612      * attributes. The template attributes also receive the values.
 613      * (Object management)
 614      * note: in PKCS#11 pTemplate and the result template are the same
 615      *
 616      * @param hSession the session&#39;s handle
 617      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 618      * @param hObject the object&#39;s handle
 619      *         (PKCS#11 param: CK_OBJECT_HANDLE hObject)
 620      * @param pTemplate specifies the attributes and number of attributes to get
 621      *                  The template attributes also receive the values.
 622      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
 623      * @exception PKCS11Exception If function returns other value than CKR_OK.
 624      * @preconditions (pTemplate &lt;&gt; null)
 625      * @postconditions (result &lt;&gt; null)
 626      */
 627     public native void C_GetAttributeValue(long hSession, long hObject,
 628             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception;
 629 
 630 
 631     /**
 632      * C_SetAttributeValue modifies the value of one or more object
 633      * attributes
 634      * (Object management)
 635      *
 636      * @param hSession the session&#39;s handle
 637      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 638      * @param hObject the object&#39;s handle
 639      *         (PKCS#11 param: CK_OBJECT_HANDLE hObject)
 640      * @param pTemplate specifies the attributes and values to get; number of
 641      *         attributes in the template
 642      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
 643      * @exception PKCS11Exception If function returns other value than CKR_OK.
 644      * @preconditions (pTemplate &lt;&gt; null)
 645      * @postconditions
 646      */
 647     public native void C_SetAttributeValue(long hSession, long hObject,
 648             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception;
 649 
 650 
 651     /**
 652      * C_FindObjectsInit initializes a search for token and session
 653      * objects that match a template.
 654      * (Object management)
 655      *
 656      * @param hSession the session&#39;s handle
 657      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 658      * @param pTemplate the object&#39;s attribute values to match and the number of
 659      *         attributes in search template
 660      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
 661      * @exception PKCS11Exception If function returns other value than CKR_OK.
 662      * @preconditions
 663      * @postconditions
 664      */
 665     public native void C_FindObjectsInit(long hSession, CK_ATTRIBUTE[] pTemplate)
 666             throws PKCS11Exception;
 667 
 668 
 669     /**
 670      * C_FindObjects continues a search for token and session
 671      * objects that match a template, obtaining additional object
 672      * handles.
 673      * (Object management)
 674      *
 675      * @param hSession the session&#39;s handle
 676      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 677      * @param ulMaxObjectCount the max. object handles to get
 678      *         (PKCS#11 param: CK_ULONG ulMaxObjectCount)
 679      * @return the object&#39;s handles and the actual number of objects returned
 680      *         (PKCS#11 param: CK_ULONG_PTR pulObjectCount)
 681      * @exception PKCS11Exception If function returns other value than CKR_OK.
 682      * @preconditions
 683      * @postconditions (result &lt;&gt; null)
 684      */
 685     public native long[] C_FindObjects(long hSession, long ulMaxObjectCount)
 686             throws PKCS11Exception;
 687 
 688 
 689     /**
 690      * C_FindObjectsFinal finishes a search for token and session
 691      * objects.
 692      * (Object management)
 693      *
 694      * @param hSession the session&#39;s handle
 695      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 696      * @exception PKCS11Exception If function returns other value than CKR_OK.
 697      * @preconditions
 698      * @postconditions
 699      */
 700     public native void C_FindObjectsFinal(long hSession) throws PKCS11Exception;
 701 
 702 
 703 
 704 /* *****************************************************************************
 705  * Encryption and decryption
 706  ******************************************************************************/
 707 
 708     /**
 709      * C_EncryptInit initializes an encryption operation.
 710      * (Encryption and decryption)
 711      *
 712      * @param hSession the session&#39;s handle
 713      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 714      * @param pMechanism the encryption mechanism
 715      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
 716      * @param hKey the handle of the encryption key
 717      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
 718      * @exception PKCS11Exception If function returns other value than CKR_OK.
 719      * @preconditions
 720      * @postconditions
 721      */
 722     public native void C_EncryptInit(long hSession, CK_MECHANISM pMechanism,
 723             long hKey) throws PKCS11Exception;
 724 
 725 
 726     /**
 727      * C_Encrypt encrypts single-part data.
 728      * (Encryption and decryption)
 729      *
 730      * @param hSession the session&#39;s handle
 731      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<a name="3" id="anc3"></a><span class="line-modified"> 732      * @param pData the data to get encrypted and the data&#39;s length</span>



 733      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG ulDataLen)
<a name="4" id="anc4"></a><span class="line-modified"> 734      * @return the encrypted data and the encrypted data&#39;s length</span>




 735      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedData,
 736      *                         CK_ULONG_PTR pulEncryptedDataLen)
 737      * @exception PKCS11Exception If function returns other value than CKR_OK.
<a name="5" id="anc5"></a><span class="line-modified"> 738      * @preconditions (pData &lt;&gt; null)</span>
<span class="line-modified"> 739      * @postconditions (result &lt;&gt; null)</span>
 740      */
<a name="6" id="anc6"></a><span class="line-modified"> 741     public native int C_Encrypt(long hSession, byte[] in, int inOfs, int inLen,</span>
<span class="line-modified"> 742             byte[] out, int outOfs, int outLen) throws PKCS11Exception;</span>

 743 
 744 
 745     /**
 746      * C_EncryptUpdate continues a multiple-part encryption
 747      * operation.
 748      * (Encryption and decryption)
 749      *
 750      * @param hSession the session&#39;s handle
 751      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<a name="7" id="anc7"></a><span class="line-modified"> 752      * @param pPart the data part to get encrypted and the data part&#39;s length</span>



 753      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
<a name="8" id="anc8"></a><span class="line-modified"> 754      * @return the encrypted data part and the encrypted data part&#39;s length</span>




 755      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,
 756                              CK_ULONG_PTR pulEncryptedPartLen)
 757      * @exception PKCS11Exception If function returns other value than CKR_OK.
<a name="9" id="anc9"></a><span class="line-modified"> 758      * @preconditions (pPart &lt;&gt; null)</span>
 759      * @postconditions
 760      */
 761     public native int C_EncryptUpdate(long hSession, long directIn, byte[] in,
 762             int inOfs, int inLen, long directOut, byte[] out, int outOfs,
 763             int outLen) throws PKCS11Exception;
 764 
 765 
 766     /**
 767      * C_EncryptFinal finishes a multiple-part encryption
 768      * operation.
 769      * (Encryption and decryption)
 770      *
 771      * @param hSession the session&#39;s handle
 772      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<a name="10" id="anc10"></a><span class="line-modified"> 773      * @return the last encrypted data part and the last data part&#39;s length</span>




 774      *         (PKCS#11 param: CK_BYTE_PTR pLastEncryptedPart,
 775                              CK_ULONG_PTR pulLastEncryptedPartLen)
 776      * @exception PKCS11Exception If function returns other value than CKR_OK.
 777      * @preconditions
<a name="11" id="anc11"></a><span class="line-modified"> 778      * @postconditions (result &lt;&gt; null)</span>
 779      */
 780     public native int C_EncryptFinal(long hSession, long directOut, byte[] out,
 781             int outOfs, int outLen) throws PKCS11Exception;
 782 
 783 
 784     /**
 785      * C_DecryptInit initializes a decryption operation.
 786      * (Encryption and decryption)
 787      *
 788      * @param hSession the session&#39;s handle
 789      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 790      * @param pMechanism the decryption mechanism
 791      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
 792      * @param hKey the handle of the decryption key
 793      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
 794      * @exception PKCS11Exception If function returns other value than CKR_OK.
 795      * @preconditions
 796      * @postconditions
 797      */
 798     public native void C_DecryptInit(long hSession, CK_MECHANISM pMechanism,
 799             long hKey) throws PKCS11Exception;
 800 
 801 
 802     /**
 803      * C_Decrypt decrypts encrypted data in a single part.
 804      * (Encryption and decryption)
 805      *
 806      * @param hSession the session&#39;s handle
 807      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<a name="12" id="anc12"></a><span class="line-modified"> 808      * @param pEncryptedData the encrypted data to get decrypted and the</span>
<span class="line-modified"> 809      *         encrypted data&#39;s length</span>
<span class="line-modified"> 810      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedData,</span>
<span class="line-modified"> 811      *                         CK_ULONG ulEncryptedDataLen)</span>
<span class="line-modified"> 812      * @return the decrypted data and the data&#39;s length</span>






 813      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG_PTR pulDataLen)
 814      * @exception PKCS11Exception If function returns other value than CKR_OK.
<a name="13" id="anc13"></a><span class="line-modified"> 815      * @preconditions (pEncryptedPart &lt;&gt; null)</span>
<span class="line-modified"> 816      * @postconditions (result &lt;&gt; null)</span>
 817      */
<a name="14" id="anc14"></a><span class="line-modified"> 818     public native int C_Decrypt(long hSession, byte[] in, int inOfs, int inLen,</span>
<span class="line-modified"> 819             byte[] out, int outOfs, int outLen) throws PKCS11Exception;</span>

 820 
 821 
 822     /**
 823      * C_DecryptUpdate continues a multiple-part decryption
 824      * operation.
 825      * (Encryption and decryption)
 826      *
 827      * @param hSession the session&#39;s handle
 828      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<a name="15" id="anc15"></a><span class="line-modified"> 829      * @param pEncryptedPart the encrypted data part to get decrypted and the</span>
<span class="line-modified"> 830      *         encrypted data part&#39;s length</span>
<span class="line-modified"> 831      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,</span>
<span class="line-modified"> 832      *                         CK_ULONG ulEncryptedPartLen)</span>
<span class="line-modified"> 833      * @return the decrypted data part and the data part&#39;s length</span>






 834      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG_PTR pulPartLen)
 835      * @exception PKCS11Exception If function returns other value than CKR_OK.
<a name="16" id="anc16"></a><span class="line-modified"> 836      * @preconditions (pEncryptedPart &lt;&gt; null)</span>
 837      * @postconditions
 838      */
 839     public native int C_DecryptUpdate(long hSession, long directIn, byte[] in,
 840             int inOfs, int inLen, long directOut, byte[] out, int outOfs,
 841             int outLen) throws PKCS11Exception;
 842 
 843 
 844     /**
 845      * C_DecryptFinal finishes a multiple-part decryption
 846      * operation.
 847      * (Encryption and decryption)
 848      *
 849      * @param hSession the session&#39;s handle
 850      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<a name="17" id="anc17"></a><span class="line-modified"> 851      * @return the last decrypted data part and the last data part&#39;s length</span>




 852      *         (PKCS#11 param: CK_BYTE_PTR pLastPart,
 853      *                         CK_ULONG_PTR pulLastPartLen)
 854      * @exception PKCS11Exception If function returns other value than CKR_OK.
 855      * @preconditions
<a name="18" id="anc18"></a><span class="line-modified"> 856      * @postconditions (result &lt;&gt; null)</span>
 857      */
 858     public native int C_DecryptFinal(long hSession, long directOut, byte[] out,
 859             int outOfs, int outLen) throws PKCS11Exception;
 860 
 861 
 862 
 863 /* *****************************************************************************
 864  * Message digesting
 865  ******************************************************************************/
 866 
 867     /**
 868      * C_DigestInit initializes a message-digesting operation.
 869      * (Message digesting)
 870      *
 871      * @param hSession the session&#39;s handle
 872      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 873      * @param pMechanism the digesting mechanism
 874      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
 875      * @exception PKCS11Exception If function returns other value than CKR_OK.
 876      * @preconditions
 877      * @postconditions
 878      */
 879     public native void C_DigestInit(long hSession, CK_MECHANISM pMechanism)
 880             throws PKCS11Exception;
 881 
 882 
 883     // note that C_DigestSingle does not exist in PKCS#11
 884     // we combined the C_DigestInit and C_Digest into a single function
 885     // to save on Java&lt;-&gt;C transitions and save 5-10% on small digests
 886     // this made the C_Digest method redundant, it has been removed
 887     /**
 888      * C_Digest digests data in a single part.
 889      * (Message digesting)
 890      *
 891      * @param hSession the session&#39;s handle
 892      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 893      * @param data the data to get digested and the data&#39;s length
 894      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG ulDataLen)
 895      * @return the message digest and the length of the message digest
 896      *         (PKCS#11 param: CK_BYTE_PTR pDigest, CK_ULONG_PTR pulDigestLen)
 897      * @exception PKCS11Exception If function returns other value than CKR_OK.
 898      * @preconditions (data &lt;&gt; null)
 899      * @postconditions (result &lt;&gt; null)
 900      */
 901     public native int C_DigestSingle(long hSession, CK_MECHANISM pMechanism,
 902             byte[] in, int inOfs, int inLen, byte[] digest, int digestOfs,
 903             int digestLen) throws PKCS11Exception;
 904 
 905 
 906     /**
 907      * C_DigestUpdate continues a multiple-part message-digesting
 908      * operation.
 909      * (Message digesting)
 910      *
 911      * @param hSession the session&#39;s handle
 912      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 913      * @param pPart the data to get digested and the data&#39;s length
 914      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
 915      * @exception PKCS11Exception If function returns other value than CKR_OK.
 916      * @preconditions (pPart &lt;&gt; null)
 917      * @postconditions
 918      */
 919     public native void C_DigestUpdate(long hSession, long directIn, byte[] in,
 920             int inOfs, int inLen) throws PKCS11Exception;
 921 
 922 
 923     /**
 924      * C_DigestKey continues a multi-part message-digesting
 925      * operation, by digesting the value of a secret key as part of
 926      * the data already digested.
 927      * (Message digesting)
 928      *
 929      * @param hSession the session&#39;s handle
 930      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 931      * @param hKey the handle of the secret key to be digested
 932      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
 933      * @exception PKCS11Exception If function returns other value than CKR_OK.
 934      * @preconditions
 935      * @postconditions
 936      */
 937     public native void C_DigestKey(long hSession, long hKey)
 938             throws PKCS11Exception;
 939 
 940 
 941     /**
 942      * C_DigestFinal finishes a multiple-part message-digesting
 943      * operation.
 944      * (Message digesting)
 945      *
 946      * @param hSession the session&#39;s handle
 947      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 948      * @return the message digest and the length of the message digest
 949      *         (PKCS#11 param: CK_BYTE_PTR pDigest, CK_ULONG_PTR pulDigestLen)
 950      * @exception PKCS11Exception If function returns other value than CKR_OK.
 951      * @preconditions
 952      * @postconditions (result &lt;&gt; null)
 953      */
 954     public native int C_DigestFinal(long hSession, byte[] pDigest, int digestOfs,
 955             int digestLen) throws PKCS11Exception;
 956 
 957 
 958 
 959 /* *****************************************************************************
 960  * Signing and MACing
 961  ******************************************************************************/
 962 
 963     /**
 964      * C_SignInit initializes a signature (private key encryption)
 965      * operation, where the signature is (will be) an appendix to
 966      * the data, and plaintext cannot be recovered from the
 967      * signature.
 968      * (Signing and MACing)
 969      *
 970      * @param hSession the session&#39;s handle
 971      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 972      * @param pMechanism the signature mechanism
 973      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
 974      * @param hKey the handle of the signature key
 975      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
 976      * @exception PKCS11Exception If function returns other value than CKR_OK.
 977      * @preconditions
 978      * @postconditions
 979      */
 980     public native void C_SignInit(long hSession, CK_MECHANISM pMechanism,
 981             long hKey) throws PKCS11Exception;
 982 
 983 
 984     /**
 985      * C_Sign signs (encrypts with private key) data in a single
 986      * part, where the signature is (will be) an appendix to the
 987      * data, and plaintext cannot be recovered from the signature.
 988      * (Signing and MACing)
 989      *
 990      * @param hSession the session&#39;s handle
 991      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 992      * @param pData the data to sign and the data&#39;s length
 993      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG ulDataLen)
 994      * @return the signature and the signature&#39;s length
 995      *         (PKCS#11 param: CK_BYTE_PTR pSignature,
 996      *                         CK_ULONG_PTR pulSignatureLen)
 997      * @exception PKCS11Exception If function returns other value than CKR_OK.
 998      * @preconditions (pData &lt;&gt; null)
 999      * @postconditions (result &lt;&gt; null)
1000      */
1001     public native byte[] C_Sign(long hSession, byte[] pData)
1002             throws PKCS11Exception;
1003 
1004 
1005     /**
1006      * C_SignUpdate continues a multiple-part signature operation,
1007      * where the signature is (will be) an appendix to the data,
1008      * and plaintext cannot be recovered from the signature.
1009      * (Signing and MACing)
1010      *
1011      * @param hSession the session&#39;s handle
1012      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1013      * @param pPart the data part to sign and the data part&#39;s length
1014      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
1015      * @exception PKCS11Exception If function returns other value than CKR_OK.
1016      * @preconditions (pPart &lt;&gt; null)
1017      * @postconditions
1018      */
1019     public native void C_SignUpdate(long hSession, long directIn, byte[] in,
1020             int inOfs, int inLen) throws PKCS11Exception;
1021 
1022 
1023     /**
1024      * C_SignFinal finishes a multiple-part signature operation,
1025      * returning the signature.
1026      * (Signing and MACing)
1027      *
1028      * @param hSession the session&#39;s handle
1029      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
<a name="19" id="anc19"></a>
1030      * @return the signature and the signature&#39;s length
1031      *         (PKCS#11 param: CK_BYTE_PTR pSignature,
1032      *                         CK_ULONG_PTR pulSignatureLen)
1033      * @exception PKCS11Exception If function returns other value than CKR_OK.
1034      * @preconditions
1035      * @postconditions (result &lt;&gt; null)
1036      */
1037     public native byte[] C_SignFinal(long hSession, int expectedLen)
1038             throws PKCS11Exception;
1039 
1040 
1041     /**
1042      * C_SignRecoverInit initializes a signature operation, where
1043      * the data can be recovered from the signature.
1044      * (Signing and MACing)
1045      *
1046      * @param hSession the session&#39;s handle
1047      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1048      * @param pMechanism the signature mechanism
1049      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1050      * @param hKey the handle of the signature key
1051      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
1052      * @exception PKCS11Exception If function returns other value than CKR_OK.
1053      * @preconditions
1054      * @postconditions
1055      */
1056     public native void C_SignRecoverInit(long hSession, CK_MECHANISM pMechanism,
1057             long hKey) throws PKCS11Exception;
1058 
1059 
1060     /**
1061      * C_SignRecover signs data in a single operation, where the
1062      * data can be recovered from the signature.
1063      * (Signing and MACing)
1064      *
1065      * @param hSession the session&#39;s handle
1066      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1067      * @param pData the data to sign and the data&#39;s length
1068      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG ulDataLen)
1069      * @return the signature and the signature&#39;s length
1070      *         (PKCS#11 param: CK_BYTE_PTR pSignature,
1071      *                         CK_ULONG_PTR pulSignatureLen)
1072      * @exception PKCS11Exception If function returns other value than CKR_OK.
1073      * @preconditions (pData &lt;&gt; null)
1074      * @postconditions (result &lt;&gt; null)
1075      */
1076     public native int C_SignRecover(long hSession, byte[] in, int inOfs,
1077             int inLen, byte[] out, int outOufs, int outLen)
1078             throws PKCS11Exception;
1079 
1080 
1081 
1082 /* *****************************************************************************
1083  * Verifying signatures and MACs
1084  ******************************************************************************/
1085 
1086     /**
1087      * C_VerifyInit initializes a verification operation, where the
1088      * signature is an appendix to the data, and plaintext cannot
1089      * cannot be recovered from the signature (e.g. DSA).
1090      * (Signing and MACing)
1091      *
1092      * @param hSession the session&#39;s handle
1093      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1094      * @param pMechanism the verification mechanism
1095      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1096      * @param hKey the handle of the verification key
1097      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
1098      * @exception PKCS11Exception If function returns other value than CKR_OK.
1099      * @preconditions
1100      * @postconditions
1101      */
1102     public native void C_VerifyInit(long hSession, CK_MECHANISM pMechanism,
1103             long hKey) throws PKCS11Exception;
1104 
1105 
1106     /**
1107      * C_Verify verifies a signature in a single-part operation,
1108      * where the signature is an appendix to the data, and plaintext
1109      * cannot be recovered from the signature.
1110      * (Signing and MACing)
1111      *
1112      * @param hSession the session&#39;s handle
1113      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1114      * @param pData the signed data and the signed data&#39;s length
1115      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG ulDataLen)
1116      * @param pSignature the signature to verify and the signature&#39;s length
1117      *         (PKCS#11 param: CK_BYTE_PTR pSignature, CK_ULONG ulSignatureLen)
1118      * @exception PKCS11Exception If function returns other value than CKR_OK.
1119      * @preconditions (pData &lt;&gt; null) and (pSignature &lt;&gt; null)
1120      * @postconditions
1121      */
1122     public native void C_Verify(long hSession, byte[] pData, byte[] pSignature)
1123             throws PKCS11Exception;
1124 
1125 
1126     /**
1127      * C_VerifyUpdate continues a multiple-part verification
1128      * operation, where the signature is an appendix to the data,
1129      * and plaintext cannot be recovered from the signature.
1130      * (Signing and MACing)
1131      *
1132      * @param hSession the session&#39;s handle
1133      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1134      * @param pPart the signed data part and the signed data part&#39;s length
1135      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
1136      * @exception PKCS11Exception If function returns other value than CKR_OK.
1137      * @preconditions (pPart &lt;&gt; null)
1138      * @postconditions
1139      */
1140     public native void C_VerifyUpdate(long hSession, long directIn, byte[] in,
1141             int inOfs, int inLen) throws PKCS11Exception;
1142 
1143 
1144     /**
1145      * C_VerifyFinal finishes a multiple-part verification
1146      * operation, checking the signature.
1147      * (Signing and MACing)
1148      *
1149      * @param hSession the session&#39;s handle
1150      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1151      * @param pSignature the signature to verify and the signature&#39;s length
1152      *         (PKCS#11 param: CK_BYTE_PTR pSignature, CK_ULONG ulSignatureLen)
1153      * @exception PKCS11Exception If function returns other value than CKR_OK.
1154      * @preconditions (pSignature &lt;&gt; null)
1155      * @postconditions
1156      */
1157     public native void C_VerifyFinal(long hSession, byte[] pSignature)
1158             throws PKCS11Exception;
1159 
1160 
1161     /**
1162      * C_VerifyRecoverInit initializes a signature verification
1163      * operation, where the data is recovered from the signature.
1164      * (Signing and MACing)
1165      *
1166      * @param hSession the session&#39;s handle
1167      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1168      * @param pMechanism the verification mechanism
1169      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1170      * @param hKey the handle of the verification key
1171      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
1172      * @exception PKCS11Exception If function returns other value than CKR_OK.
1173      * @preconditions
1174      * @postconditions
1175      */
1176     public native void C_VerifyRecoverInit(long hSession,
1177             CK_MECHANISM pMechanism, long hKey) throws PKCS11Exception;
1178 
1179 
1180     /**
1181      * C_VerifyRecover verifies a signature in a single-part
1182      * operation, where the data is recovered from the signature.
1183      * (Signing and MACing)
1184      *
1185      * @param hSession the session&#39;s handle
1186      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1187      * @param pSignature the signature to verify and the signature&#39;s length
1188      *         (PKCS#11 param: CK_BYTE_PTR pSignature, CK_ULONG ulSignatureLen)
1189      * @return the recovered data and the recovered data&#39;s length
1190      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG_PTR pulDataLen)
1191      * @exception PKCS11Exception If function returns other value than CKR_OK.
1192      * @preconditions (pSignature &lt;&gt; null)
1193      * @postconditions (result &lt;&gt; null)
1194      */
1195     public native int C_VerifyRecover(long hSession, byte[] in, int inOfs,
1196             int inLen, byte[] out, int outOufs, int outLen)
1197             throws PKCS11Exception;
1198 
1199 
1200 
1201 /* *****************************************************************************
1202  * Dual-function cryptographic operations
1203  ******************************************************************************/
1204 
1205     /**
1206      * C_DigestEncryptUpdate continues a multiple-part digesting
1207      * and encryption operation.
1208      * (Dual-function cryptographic operations)
1209      *
1210      * @param hSession the session&#39;s handle
1211      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1212      * @param pPart the data part to digest and to encrypt and the data&#39;s length
1213      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
1214      * @return the digested and encrypted data part and the data part&#39;s length
1215      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,
1216      *                         CK_ULONG_PTR pulEncryptedPartLen)
1217      * @exception PKCS11Exception If function returns other value than CKR_OK.
1218      * @preconditions (pPart &lt;&gt; null)
1219      * @postconditions
1220      */
1221 //    public native byte[] C_DigestEncryptUpdate(long hSession, byte[] pPart)
1222 //            throws PKCS11Exception;
1223 
1224 
1225     /**
1226      * C_DecryptDigestUpdate continues a multiple-part decryption and
1227      * digesting operation.
1228      * (Dual-function cryptographic operations)
1229      *
1230      * @param hSession the session&#39;s handle
1231      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1232      * @param pEncryptedPart the encrypted data part to decrypt and to digest
1233      *         and encrypted data part&#39;s length
1234      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,
1235      *                         CK_ULONG ulEncryptedPartLen)
1236      * @return the decrypted and digested data part and the data part&#39;s length
1237      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG_PTR pulPartLen)
1238      * @exception PKCS11Exception If function returns other value than CKR_OK.
1239      * @preconditions (pEncryptedPart &lt;&gt; null)
1240      * @postconditions
1241      */
1242 //    public native byte[] C_DecryptDigestUpdate(long hSession,
1243 //            byte[] pEncryptedPart) throws PKCS11Exception;
1244 
1245 
1246     /**
1247      * C_SignEncryptUpdate continues a multiple-part signing and
1248      * encryption operation.
1249      * (Dual-function cryptographic operations)
1250      *
1251      * @param hSession the session&#39;s handle
1252      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1253      * @param pPart the data part to sign and to encrypt and the data part&#39;s
1254      *         length
1255      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
1256      * @return the signed and encrypted data part and the data part&#39;s length
1257      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,
1258      *                         CK_ULONG_PTR pulEncryptedPartLen)
1259      * @exception PKCS11Exception If function returns other value than CKR_OK.
1260      * @preconditions (pPart &lt;&gt; null)
1261      * @postconditions
1262      */
1263 //    public native byte[] C_SignEncryptUpdate(long hSession, byte[] pPart)
1264 //            throws PKCS11Exception;
1265 
1266 
1267     /**
1268      * C_DecryptVerifyUpdate continues a multiple-part decryption and
1269      * verify operation.
1270      * (Dual-function cryptographic operations)
1271      *
1272      * @param hSession the session&#39;s handle
1273      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1274      * @param pEncryptedPart the encrypted data part to decrypt and to verify
1275      *         and the data part&#39;s length
1276      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,
1277      *                         CK_ULONG ulEncryptedPartLen)
1278      * @return the decrypted and verified data part and the data part&#39;s length
1279      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG_PTR pulPartLen)
1280      * @exception PKCS11Exception If function returns other value than CKR_OK.
1281      * @preconditions (pEncryptedPart &lt;&gt; null)
1282      * @postconditions
1283      */
1284 //    public native byte[] C_DecryptVerifyUpdate(long hSession,
1285 //            byte[] pEncryptedPart) throws PKCS11Exception;
1286 
1287 
<a name="20" id="anc20"></a><span class="line-removed">1288 </span>
1289 /* *****************************************************************************
1290  * Key management
1291  ******************************************************************************/
1292 
1293     /**
1294      * getNativeKeyInfo gets the key object attributes and values as an opaque
1295      * byte array to be used in createNativeKey method.
1296      * (Key management)
1297      *
1298      * @param hSession the session&#39;s handle
1299      * @param hKey key&#39;s handle
1300      * @param hWrappingKey key handle for wrapping the extracted sensitive keys.
1301      *        -1 if not used.
1302      * @param pWrappingMech mechanism for wrapping the extracted sensitive keys
1303      * @return an opaque byte array containing the key object attributes
1304      *         and values
1305      * @exception PKCS11Exception If an internal PKCS#11 function returns other
1306      *            value than CKR_OK.
1307      * @preconditions
1308      * @postconditions
1309      */
1310     public native byte[] getNativeKeyInfo(long hSession, long hKey,
1311             long hWrappingKey, CK_MECHANISM pWrappingMech) throws PKCS11Exception;
1312 
1313     /**
1314      * createNativeKey creates a key object with attributes and values
1315      * specified by parameter as an opaque byte array.
1316      * (Key management)
1317      *
1318      * @param hSession the session&#39;s handle
1319      * @param keyInfo opaque byte array containing key object attributes
1320      *        and values
1321      * @param hWrappingKey key handle for unwrapping the extracted sensitive keys.
1322      *        -1 if not used.
1323      * @param pWrappingMech mechanism for unwrapping the extracted sensitive keys
1324      * @return key object handle
1325      * @exception PKCS11Exception If an internal PKCS#11 function returns other
1326      *            value than CKR_OK.
1327      * @preconditions
1328      * @postconditions
1329      */
1330     public native long createNativeKey(long hSession, byte[] keyInfo,
1331             long hWrappingKey, CK_MECHANISM pWrappingMech) throws PKCS11Exception;
1332 
1333     /**
1334      * C_GenerateKey generates a secret key, creating a new key
1335      * object.
1336      * (Key management)
1337      *
1338      * @param hSession the session&#39;s handle
1339      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1340      * @param pMechanism the key generation mechanism
1341      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1342      * @param pTemplate the template for the new key and the number of
1343      *         attributes in the template
1344      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
1345      * @return the handle of the new key
1346      *         (PKCS#11 param: CK_OBJECT_HANDLE_PTR phKey)
1347      * @exception PKCS11Exception If function returns other value than CKR_OK.
1348      * @preconditions
1349      * @postconditions
1350      */
1351     public native long C_GenerateKey(long hSession, CK_MECHANISM pMechanism,
1352             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception;
1353 
1354 
1355     /**
1356      * C_GenerateKeyPair generates a public-key/private-key pair,
1357      * creating new key objects.
1358      * (Key management)
1359      *
1360      * @param hSession the session&#39;s handle
1361      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1362      * @param pMechanism the key generation mechanism
1363      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1364      * @param pPublicKeyTemplate the template for the new public key and the
1365      *         number of attributes in the template
1366      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pPublicKeyTemplate,
1367      *                         CK_ULONG ulPublicKeyAttributeCount)
1368      * @param pPrivateKeyTemplate the template for the new private key and the
1369      *         number of attributes in the template
1370      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pPrivateKeyTemplate
1371      *                         CK_ULONG ulPrivateKeyAttributeCount)
1372      * @return a long array with exactly two elements and the public key handle
1373      *         as the first element and the private key handle as the second
1374      *         element
1375      *         (PKCS#11 param: CK_OBJECT_HANDLE_PTR phPublicKey,
1376      *                         CK_OBJECT_HANDLE_PTR phPrivateKey)
1377      * @exception PKCS11Exception If function returns other value than CKR_OK.
1378      * @preconditions (pMechanism &lt;&gt; null)
1379      * @postconditions (result &lt;&gt; null) and (result.length == 2)
1380      */
1381     public native long[] C_GenerateKeyPair(long hSession,
1382             CK_MECHANISM pMechanism, CK_ATTRIBUTE[] pPublicKeyTemplate,
1383             CK_ATTRIBUTE[] pPrivateKeyTemplate) throws PKCS11Exception;
1384 
1385 
1386 
1387     /**
1388      * C_WrapKey wraps (i.e., encrypts) a key.
1389      * (Key management)
1390      *
1391      * @param hSession the session&#39;s handle
1392      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1393      * @param pMechanism the wrapping mechanism
1394      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1395      * @param hWrappingKey the handle of the wrapping key
1396      *         (PKCS#11 param: CK_OBJECT_HANDLE hWrappingKey)
1397      * @param hKey the handle of the key to be wrapped
1398      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
1399      * @return the wrapped key and the length of the wrapped key
1400      *         (PKCS#11 param: CK_BYTE_PTR pWrappedKey,
1401      *                         CK_ULONG_PTR pulWrappedKeyLen)
1402      * @exception PKCS11Exception If function returns other value than CKR_OK.
1403      * @preconditions
1404      * @postconditions (result &lt;&gt; null)
1405      */
1406     public native byte[] C_WrapKey(long hSession, CK_MECHANISM pMechanism,
1407             long hWrappingKey, long hKey) throws PKCS11Exception;
1408 
1409 
1410     /**
1411      * C_UnwrapKey unwraps (decrypts) a wrapped key, creating a new
1412      * key object.
1413      * (Key management)
1414      *
1415      * @param hSession the session&#39;s handle
1416      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1417      * @param pMechanism the unwrapping mechanism
1418      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1419      * @param hUnwrappingKey the handle of the unwrapping key
1420      *         (PKCS#11 param: CK_OBJECT_HANDLE hUnwrappingKey)
1421      * @param pWrappedKey the wrapped key to unwrap and the wrapped key&#39;s length
1422      *         (PKCS#11 param: CK_BYTE_PTR pWrappedKey, CK_ULONG ulWrappedKeyLen)
1423      * @param pTemplate the template for the new key and the number of
1424      *         attributes in the template
1425      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
1426      * @return the handle of the unwrapped key
1427      *         (PKCS#11 param: CK_OBJECT_HANDLE_PTR phKey)
1428      * @exception PKCS11Exception If function returns other value than CKR_OK.
1429      * @preconditions (pWrappedKey &lt;&gt; null)
1430      * @postconditions
1431      */
1432     public native long C_UnwrapKey(long hSession, CK_MECHANISM pMechanism,
1433             long hUnwrappingKey, byte[] pWrappedKey, CK_ATTRIBUTE[] pTemplate)
1434             throws PKCS11Exception;
1435 
1436 
1437     /**
1438      * C_DeriveKey derives a key from a base key, creating a new key
1439      * object.
1440      * (Key management)
1441      *
1442      * @param hSession the session&#39;s handle
1443      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1444      * @param pMechanism the key derivation mechanism
1445      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1446      * @param hBaseKey the handle of the base key
1447      *         (PKCS#11 param: CK_OBJECT_HANDLE hBaseKey)
1448      * @param pTemplate the template for the new key and the number of
1449      *         attributes in the template
1450      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
1451      * @return the handle of the derived key
1452      *         (PKCS#11 param: CK_OBJECT_HANDLE_PTR phKey)
1453      * @exception PKCS11Exception If function returns other value than CKR_OK.
1454      * @preconditions
1455      * @postconditions
1456      */
1457     public native long C_DeriveKey(long hSession, CK_MECHANISM pMechanism,
1458             long hBaseKey, CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception;
1459 
1460 
1461 
1462 /* *****************************************************************************
1463  * Random number generation
1464  ******************************************************************************/
1465 
1466     /**
1467      * C_SeedRandom mixes additional seed material into the token&#39;s
1468      * random number generator.
1469      * (Random number generation)
1470      *
1471      * @param hSession the session&#39;s handle
1472      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1473      * @param pSeed the seed material and the seed material&#39;s length
1474      *         (PKCS#11 param: CK_BYTE_PTR pSeed, CK_ULONG ulSeedLen)
1475      * @exception PKCS11Exception If function returns other value than CKR_OK.
1476      * @preconditions (pSeed &lt;&gt; null)
1477      * @postconditions
1478      */
1479     public native void C_SeedRandom(long hSession, byte[] pSeed)
1480             throws PKCS11Exception;
1481 
1482 
1483     /**
1484      * C_GenerateRandom generates random data.
1485      * (Random number generation)
1486      *
1487      * @param hSession the session&#39;s handle
1488      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1489      * @param RandomData receives the random data and the length of RandomData
1490      *         is the length of random data to be generated
1491      *         (PKCS#11 param: CK_BYTE_PTR pRandomData, CK_ULONG ulRandomLen)
1492      * @exception PKCS11Exception If function returns other value than CKR_OK.
1493      * @preconditions (randomData &lt;&gt; null)
1494      * @postconditions
1495      */
1496     public native void C_GenerateRandom(long hSession, byte[] randomData)
1497             throws PKCS11Exception;
1498 
1499 
1500 
1501 /* *****************************************************************************
1502  * Parallel function management
1503  ******************************************************************************/
1504 
1505     /**
1506      * C_GetFunctionStatus is a legacy function; it obtains an
1507      * updated status of a function running in parallel with an
1508      * application.
1509      * (Parallel function management)
1510      *
1511      * @param hSession the session&#39;s handle
1512      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1513      * @exception PKCS11Exception If function returns other value than CKR_OK.
1514      * @preconditions
1515      * @postconditions
1516      */
1517 //    public native void C_GetFunctionStatus(long hSession)
1518 //            throws PKCS11Exception;
1519 
1520 
1521     /**
1522      * C_CancelFunction is a legacy function; it cancels a function
1523      * running in parallel.
1524      * (Parallel function management)
1525      *
1526      * @param hSession the session&#39;s handle
1527      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1528      * @exception PKCS11Exception If function returns other value than CKR_OK.
1529      * @preconditions
1530      * @postconditions
1531      */
1532 //    public native void C_CancelFunction(long hSession) throws PKCS11Exception;
1533 
1534 
1535 
1536 /* *****************************************************************************
1537  * Functions added in for Cryptoki Version 2.01 or later
1538  ******************************************************************************/
1539 
1540     /**
1541      * C_WaitForSlotEvent waits for a slot event (token insertion,
1542      * removal, etc.) to occur.
1543      * (General-purpose)
1544      *
1545      * @param flags blocking/nonblocking flag
1546      *         (PKCS#11 param: CK_FLAGS flags)
1547      * @param pReserved reserved. Should be null
1548      *         (PKCS#11 param: CK_VOID_PTR pReserved)
1549      * @return the slot ID where the event occurred
1550      *         (PKCS#11 param: CK_SLOT_ID_PTR pSlot)
1551      * @exception PKCS11Exception If function returns other value than CKR_OK.
1552      * @preconditions (pRserved == null)
1553      * @postconditions
1554      */
1555 //    public native long C_WaitForSlotEvent(long flags, Object pRserved)
1556 //            throws PKCS11Exception;
1557 
1558     /**
1559      * Returns the string representation of this object.
1560      *
1561      * @return The string representation of object
1562      */
1563     public String toString() {
1564         return &quot;Module name: &quot; + pkcs11ModulePath;
1565     }
1566 
1567     /**
1568      * Calls disconnect() to cleanup the native part of the wrapper. Once this
1569      * method is called, this object cannot be used any longer. Any subsequent
1570      * call to a C_* method will result in a runtime exception.
1571      *
1572      * @exception Throwable If finalization fails.
1573      */
1574     @SuppressWarnings(&quot;deprecation&quot;)
1575     protected void finalize() throws Throwable {
1576         disconnect();
1577     }
1578 
1579 // PKCS11 subclass that has all methods synchronized and delegating to the
1580 // parent. Used for tokens that only support single threaded access
1581 static class SynchronizedPKCS11 extends PKCS11 {
1582 
1583     SynchronizedPKCS11(String pkcs11ModulePath, String functionListName)
1584             throws IOException {
1585         super(pkcs11ModulePath, functionListName);
1586     }
1587 
1588     synchronized void C_Initialize(Object pInitArgs) throws PKCS11Exception {
1589         super.C_Initialize(pInitArgs);
1590     }
1591 
1592     public synchronized void C_Finalize(Object pReserved)
1593             throws PKCS11Exception {
1594         super.C_Finalize(pReserved);
1595     }
1596 
1597     public synchronized CK_INFO C_GetInfo() throws PKCS11Exception {
1598         return super.C_GetInfo();
1599     }
1600 
1601     public synchronized long[] C_GetSlotList(boolean tokenPresent)
1602             throws PKCS11Exception {
1603         return super.C_GetSlotList(tokenPresent);
1604     }
1605 
1606     public synchronized CK_SLOT_INFO C_GetSlotInfo(long slotID)
1607             throws PKCS11Exception {
1608         return super.C_GetSlotInfo(slotID);
1609     }
1610 
1611     public synchronized CK_TOKEN_INFO C_GetTokenInfo(long slotID)
1612             throws PKCS11Exception {
1613         return super.C_GetTokenInfo(slotID);
1614     }
1615 
1616     public synchronized long[] C_GetMechanismList(long slotID)
1617             throws PKCS11Exception {
1618         return super.C_GetMechanismList(slotID);
1619     }
1620 
1621     public synchronized CK_MECHANISM_INFO C_GetMechanismInfo(long slotID,
1622             long type) throws PKCS11Exception {
1623         return super.C_GetMechanismInfo(slotID, type);
1624     }
1625 
1626     public synchronized long C_OpenSession(long slotID, long flags,
1627             Object pApplication, CK_NOTIFY Notify) throws PKCS11Exception {
1628         return super.C_OpenSession(slotID, flags, pApplication, Notify);
1629     }
1630 
1631     public synchronized void C_CloseSession(long hSession)
1632             throws PKCS11Exception {
1633         super.C_CloseSession(hSession);
1634     }
1635 
1636     public synchronized CK_SESSION_INFO C_GetSessionInfo(long hSession)
1637             throws PKCS11Exception {
1638         return super.C_GetSessionInfo(hSession);
1639     }
1640 
1641     public synchronized void C_Login(long hSession, long userType, char[] pPin)
1642             throws PKCS11Exception {
1643         super.C_Login(hSession, userType, pPin);
1644     }
1645 
1646     public synchronized void C_Logout(long hSession) throws PKCS11Exception {
1647         super.C_Logout(hSession);
1648     }
1649 
1650     public synchronized long C_CreateObject(long hSession,
1651             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception {
1652         return super.C_CreateObject(hSession, pTemplate);
1653     }
1654 
1655     public synchronized long C_CopyObject(long hSession, long hObject,
1656             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception {
1657         return super.C_CopyObject(hSession, hObject, pTemplate);
1658     }
1659 
1660     public synchronized void C_DestroyObject(long hSession, long hObject)
1661             throws PKCS11Exception {
1662         super.C_DestroyObject(hSession, hObject);
1663     }
1664 
1665     public synchronized void C_GetAttributeValue(long hSession, long hObject,
1666             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception {
1667         super.C_GetAttributeValue(hSession, hObject, pTemplate);
1668     }
1669 
1670     public synchronized void C_SetAttributeValue(long hSession, long hObject,
1671             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception {
1672         super.C_SetAttributeValue(hSession, hObject, pTemplate);
1673     }
1674 
1675     public synchronized void C_FindObjectsInit(long hSession,
1676             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception {
1677         super.C_FindObjectsInit(hSession, pTemplate);
1678     }
1679 
1680     public synchronized long[] C_FindObjects(long hSession,
1681             long ulMaxObjectCount) throws PKCS11Exception {
1682         return super.C_FindObjects(hSession, ulMaxObjectCount);
1683     }
1684 
1685     public synchronized void C_FindObjectsFinal(long hSession)
1686             throws PKCS11Exception {
1687         super.C_FindObjectsFinal(hSession);
1688     }
1689 
1690     public synchronized void C_EncryptInit(long hSession,
1691             CK_MECHANISM pMechanism, long hKey) throws PKCS11Exception {
1692         super.C_EncryptInit(hSession, pMechanism, hKey);
1693     }
1694 
<a name="21" id="anc21"></a><span class="line-modified">1695     public synchronized int C_Encrypt(long hSession, byte[] in, int inOfs,</span>
<span class="line-modified">1696             int inLen, byte[] out, int outOfs, int outLen)</span>
1697             throws PKCS11Exception {
<a name="22" id="anc22"></a><span class="line-modified">1698         return super.C_Encrypt(hSession, in, inOfs, inLen, out, outOfs, outLen);</span>

1699     }
1700 
1701     public synchronized int C_EncryptUpdate(long hSession, long directIn,
1702             byte[] in, int inOfs, int inLen, long directOut, byte[] out,
1703             int outOfs, int outLen) throws PKCS11Exception {
1704         return super.C_EncryptUpdate(hSession, directIn, in, inOfs, inLen,
1705                 directOut, out, outOfs, outLen);
1706     }
1707 
1708     public synchronized int C_EncryptFinal(long hSession, long directOut,
1709             byte[] out, int outOfs, int outLen) throws PKCS11Exception {
1710         return super.C_EncryptFinal(hSession, directOut, out, outOfs, outLen);
1711     }
1712 
1713     public synchronized void C_DecryptInit(long hSession,
1714             CK_MECHANISM pMechanism, long hKey) throws PKCS11Exception {
1715         super.C_DecryptInit(hSession, pMechanism, hKey);
1716     }
1717 
<a name="23" id="anc23"></a><span class="line-modified">1718     public synchronized int C_Decrypt(long hSession, byte[] in, int inOfs,</span>
<span class="line-modified">1719             int inLen, byte[] out, int outOfs, int outLen)</span>
<span class="line-modified">1720             throws PKCS11Exception {</span>
<span class="line-modified">1721         return super.C_Decrypt(hSession, in, inOfs, inLen, out, outOfs, outLen);</span>

1722     }
1723 
1724     public synchronized int C_DecryptUpdate(long hSession, long directIn,
1725             byte[] in, int inOfs, int inLen, long directOut, byte[] out,
1726             int outOfs, int outLen) throws PKCS11Exception {
1727         return super.C_DecryptUpdate(hSession, directIn, in, inOfs, inLen,
1728                 directOut, out, outOfs, outLen);
1729     }
1730 
1731     public synchronized int C_DecryptFinal(long hSession, long directOut,
1732             byte[] out, int outOfs, int outLen) throws PKCS11Exception {
1733         return super.C_DecryptFinal(hSession, directOut, out, outOfs, outLen);
1734     }
1735 
1736     public synchronized void C_DigestInit(long hSession, CK_MECHANISM pMechanism)
1737             throws PKCS11Exception {
1738         super.C_DigestInit(hSession, pMechanism);
1739     }
1740 
1741     public synchronized int C_DigestSingle(long hSession,
1742             CK_MECHANISM pMechanism, byte[] in, int inOfs, int inLen,
1743             byte[] digest, int digestOfs, int digestLen) throws PKCS11Exception {
1744         return super.C_DigestSingle(hSession, pMechanism, in, inOfs, inLen,
1745                 digest, digestOfs, digestLen);
1746     }
1747 
1748     public synchronized void C_DigestUpdate(long hSession, long directIn,
1749             byte[] in, int inOfs, int inLen) throws PKCS11Exception {
1750         super.C_DigestUpdate(hSession, directIn, in, inOfs, inLen);
1751     }
1752 
1753     public synchronized void C_DigestKey(long hSession, long hKey)
1754             throws PKCS11Exception {
1755         super.C_DigestKey(hSession, hKey);
1756     }
1757 
1758     public synchronized int C_DigestFinal(long hSession, byte[] pDigest,
1759             int digestOfs, int digestLen) throws PKCS11Exception {
1760         return super.C_DigestFinal(hSession, pDigest, digestOfs, digestLen);
1761     }
1762 
1763     public synchronized void C_SignInit(long hSession, CK_MECHANISM pMechanism,
1764             long hKey) throws PKCS11Exception {
1765         super.C_SignInit(hSession, pMechanism, hKey);
1766     }
1767 
1768     public synchronized byte[] C_Sign(long hSession, byte[] pData)
1769             throws PKCS11Exception {
1770         return super.C_Sign(hSession, pData);
1771     }
1772 
1773     public synchronized void C_SignUpdate(long hSession, long directIn,
1774             byte[] in, int inOfs, int inLen) throws PKCS11Exception {
1775         super.C_SignUpdate(hSession, directIn, in, inOfs, inLen);
1776     }
1777 
1778     public synchronized byte[] C_SignFinal(long hSession, int expectedLen)
1779             throws PKCS11Exception {
1780         return super.C_SignFinal(hSession, expectedLen);
1781     }
1782 
1783     public synchronized void C_SignRecoverInit(long hSession,
1784             CK_MECHANISM pMechanism, long hKey) throws PKCS11Exception {
1785         super.C_SignRecoverInit(hSession, pMechanism, hKey);
1786     }
1787 
1788     public synchronized int C_SignRecover(long hSession, byte[] in, int inOfs,
1789             int inLen, byte[] out, int outOufs, int outLen)
1790             throws PKCS11Exception {
1791         return super.C_SignRecover(hSession, in, inOfs, inLen, out, outOufs,
1792                 outLen);
1793     }
1794 
1795     public synchronized void C_VerifyInit(long hSession, CK_MECHANISM pMechanism,
1796             long hKey) throws PKCS11Exception {
1797         super.C_VerifyInit(hSession, pMechanism, hKey);
1798     }
1799 
1800     public synchronized void C_Verify(long hSession, byte[] pData,
1801             byte[] pSignature) throws PKCS11Exception {
1802         super.C_Verify(hSession, pData, pSignature);
1803     }
1804 
1805     public synchronized void C_VerifyUpdate(long hSession, long directIn,
1806             byte[] in, int inOfs, int inLen) throws PKCS11Exception {
1807         super.C_VerifyUpdate(hSession, directIn, in, inOfs, inLen);
1808     }
1809 
1810     public synchronized void C_VerifyFinal(long hSession, byte[] pSignature)
1811             throws PKCS11Exception {
1812         super.C_VerifyFinal(hSession, pSignature);
1813     }
1814 
1815     public synchronized void C_VerifyRecoverInit(long hSession,
1816             CK_MECHANISM pMechanism, long hKey) throws PKCS11Exception {
1817         super.C_VerifyRecoverInit(hSession, pMechanism, hKey);
1818     }
1819 
1820     public synchronized int C_VerifyRecover(long hSession, byte[] in, int inOfs,
1821             int inLen, byte[] out, int outOufs, int outLen)
1822             throws PKCS11Exception {
1823         return super.C_VerifyRecover(hSession, in, inOfs, inLen, out, outOufs,
1824                 outLen);
1825     }
1826 
1827     public synchronized long C_GenerateKey(long hSession,
1828             CK_MECHANISM pMechanism, CK_ATTRIBUTE[] pTemplate)
1829             throws PKCS11Exception {
1830         return super.C_GenerateKey(hSession, pMechanism, pTemplate);
1831     }
1832 
1833     public synchronized long[] C_GenerateKeyPair(long hSession,
1834             CK_MECHANISM pMechanism, CK_ATTRIBUTE[] pPublicKeyTemplate,
1835             CK_ATTRIBUTE[] pPrivateKeyTemplate)
1836             throws PKCS11Exception {
1837         return super.C_GenerateKeyPair(hSession, pMechanism, pPublicKeyTemplate,
1838                 pPrivateKeyTemplate);
1839     }
1840 
1841     public synchronized byte[] C_WrapKey(long hSession, CK_MECHANISM pMechanism,
1842             long hWrappingKey, long hKey) throws PKCS11Exception {
1843         return super.C_WrapKey(hSession, pMechanism, hWrappingKey, hKey);
1844     }
1845 
1846     public synchronized long C_UnwrapKey(long hSession, CK_MECHANISM pMechanism,
1847             long hUnwrappingKey, byte[] pWrappedKey, CK_ATTRIBUTE[] pTemplate)
1848             throws PKCS11Exception {
1849         return super.C_UnwrapKey(hSession, pMechanism, hUnwrappingKey,
1850                 pWrappedKey, pTemplate);
1851     }
1852 
1853     public synchronized long C_DeriveKey(long hSession, CK_MECHANISM pMechanism,
1854     long hBaseKey, CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception {
1855         return super.C_DeriveKey(hSession, pMechanism, hBaseKey, pTemplate);
1856     }
1857 
1858     public synchronized void C_SeedRandom(long hSession, byte[] pSeed)
1859             throws PKCS11Exception {
1860         super.C_SeedRandom(hSession, pSeed);
1861     }
1862 
1863     public synchronized void C_GenerateRandom(long hSession, byte[] randomData)
1864             throws PKCS11Exception {
1865         super.C_GenerateRandom(hSession, randomData);
1866     }
1867 }
1868 }
<a name="24" id="anc24"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="24" type="hidden" />
</body>
</html>