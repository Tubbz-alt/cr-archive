<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/jdk.crypto.cryptoki/share/classes/sun/security/pkcs11/wrapper/PKCS11.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
   1 /*
   2  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.
   3  */
   4 
   5 /* Copyright  (c) 2002 Graz University of Technology. All rights reserved.
   6  *
   7  * Redistribution and use in  source and binary forms, with or without
   8  * modification, are permitted  provided that the following conditions are met:
   9  *
  10  * 1. Redistributions of  source code must retain the above copyright notice,
  11  *    this list of conditions and the following disclaimer.
  12  *
  13  * 2. Redistributions in  binary form must reproduce the above copyright notice,
  14  *    this list of conditions and the following disclaimer in the documentation
  15  *    and/or other materials provided with the distribution.
  16  *
  17  * 3. The end-user documentation included with the redistribution, if any, must
  18  *    include the following acknowledgment:
  19  *
  20  *    &quot;This product includes software developed by IAIK of Graz University of
  21  *     Technology.&quot;
  22  *
  23  *    Alternately, this acknowledgment may appear in the software itself, if
  24  *    and wherever such third-party acknowledgments normally appear.
  25  *
  26  * 4. The names &quot;Graz University of Technology&quot; and &quot;IAIK of Graz University of
  27  *    Technology&quot; must not be used to endorse or promote products derived from
  28  *    this software without prior written permission.
  29  *
  30  * 5. Products derived from this software may not be called
  31  *    &quot;IAIK PKCS Wrapper&quot;, nor may &quot;IAIK&quot; appear in their name, without prior
  32  *    written permission of Graz University of Technology.
  33  *
  34  *  THIS SOFTWARE IS PROVIDED &quot;AS IS&quot; AND ANY EXPRESSED OR IMPLIED
  35  *  WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
  36  *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  37  *  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE LICENSOR BE
  38  *  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,
  39  *  OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  40  *  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
  41  *  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
  42  *  ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  43  *  OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
  44  *  OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  45  *  POSSIBILITY  OF SUCH DAMAGE.
  46  */
  47 
  48 package sun.security.pkcs11.wrapper;
  49 
  50 import java.io.File;
  51 import java.io.IOException;
  52 import java.util.*;
  53 
  54 import java.security.AccessController;
  55 import java.security.PrivilegedAction;
  56 
  57 import sun.security.util.Debug;
  58 
  59 import static sun.security.pkcs11.wrapper.PKCS11Constants.*;
  60 
  61 /**
  62  * This is the default implementation of the PKCS11 interface. IT connects to
  63  * the pkcs11wrapper.dll file, which is the native part of this library.
  64  * The strange and awkward looking initialization was chosen to avoid calling
  65  * loadLibrary from a static initialization block, because this would complicate
  66  * the use in applets.
  67  *
  68  * @author Karl Scheibelhofer &lt;Karl.Scheibelhofer@iaik.at&gt;
  69  * @author Martin Schlaeffer &lt;schlaeff@sbox.tugraz.at&gt;
  70  * @invariants (pkcs11ModulePath_ &lt;&gt; null)
  71  */
  72 public class PKCS11 {
  73 
  74     /**
  75      * The name of the native part of the wrapper; i.e. the filename without
  76      * the extension (e.g. &quot;.DLL&quot; or &quot;.so&quot;).
  77      */
  78     private static final String PKCS11_WRAPPER = &quot;j2pkcs11&quot;;
  79 
  80     static {
  81         // cannot use LoadLibraryAction because that would make the native
  82         // library available to the bootclassloader, but we run in the
  83         // extension classloader.
  84         AccessController.doPrivileged(new PrivilegedAction&lt;Object&gt;() {
  85             public Object run() {
  86                 System.loadLibrary(PKCS11_WRAPPER);
  87                 return null;
  88             }
  89         });
  90         boolean enableDebug = Debug.getInstance(&quot;sunpkcs11&quot;) != null;
  91         initializeLibrary(enableDebug);
  92     }
  93 
  94     public static void loadNative() {
  95         // dummy method that can be called to make sure the native
  96         // portion has been loaded. actual loading happens in the
  97         // static initializer, hence this method is empty.
  98     }
  99 
 100     /* *****************************************************************************
 101      * Utility, Resource Clean up
 102      ******************************************************************************/
 103     // always return 0L
 104     public static native long freeMechanism(long hMechanism);
 105 
 106     /**
 107      * The PKCS#11 module to connect to. This is the PKCS#11 driver of the token;
 108      * e.g. pk2priv.dll.
 109      */
 110     private final String pkcs11ModulePath;
 111 
 112     private long pNativeData;
 113 
 114     /**
 115      * This method does the initialization of the native library. It is called
 116      * exactly once for this class.
 117      *
 118      * @preconditions
 119      * @postconditions
 120      */
 121     private static native void initializeLibrary(boolean debug);
 122 
 123     // XXX
 124     /**
 125      * This method does the finalization of the native library. It is called
 126      * exactly once for this class. The library uses this method for a clean-up
 127      * of any resources.
 128      *
 129      * @preconditions
 130      * @postconditions
 131      */
 132     private static native void finalizeLibrary();
 133 
 134     private static final Map&lt;String,PKCS11&gt; moduleMap =
 135         new HashMap&lt;String,PKCS11&gt;();
 136 
 137     /**
 138      * Connects to the PKCS#11 driver given. The filename must contain the
 139      * path, if the driver is not in the system&#39;s search path.
 140      *
 141      * @param pkcs11ModulePath the PKCS#11 library path
 142      * @preconditions (pkcs11ModulePath &lt;&gt; null)
 143      * @postconditions
 144      */
 145     PKCS11(String pkcs11ModulePath, String functionListName)
 146             throws IOException {
 147         connect(pkcs11ModulePath, functionListName);
 148         this.pkcs11ModulePath = pkcs11ModulePath;
 149     }
 150 
 151     public static synchronized PKCS11 getInstance(String pkcs11ModulePath,
 152             String functionList, CK_C_INITIALIZE_ARGS pInitArgs,
 153             boolean omitInitialize) throws IOException, PKCS11Exception {
 154         // we may only call C_Initialize once per native .so/.dll
 155         // so keep a cache using the (non-canonicalized!) path
 156         PKCS11 pkcs11 = moduleMap.get(pkcs11ModulePath);
 157         if (pkcs11 == null) {
 158             if ((pInitArgs != null)
 159                     &amp;&amp; ((pInitArgs.flags &amp; CKF_OS_LOCKING_OK) != 0)) {
 160                 pkcs11 = new PKCS11(pkcs11ModulePath, functionList);
 161             } else {
 162                 pkcs11 = new SynchronizedPKCS11(pkcs11ModulePath, functionList);
 163             }
 164             if (omitInitialize == false) {
 165                 try {
 166                     pkcs11.C_Initialize(pInitArgs);
 167                 } catch (PKCS11Exception e) {
 168                     // ignore already-initialized error code
 169                     // rethrow all other errors
 170                     if (e.getErrorCode() != CKR_CRYPTOKI_ALREADY_INITIALIZED) {
 171                         throw e;
 172                     }
 173                 }
 174             }
 175             moduleMap.put(pkcs11ModulePath, pkcs11);
 176         }
 177         return pkcs11;
 178     }
 179 
 180     /**
 181      * Connects this object to the specified PKCS#11 library. This method is for
 182      * internal use only.
 183      * Declared private, because incorrect handling may result in errors in the
 184      * native part.
 185      *
 186      * @param pkcs11ModulePath The PKCS#11 library path.
 187      * @preconditions (pkcs11ModulePath &lt;&gt; null)
 188      * @postconditions
 189      */
 190     private native void connect(String pkcs11ModulePath, String functionListName)
 191             throws IOException;
 192 
 193     /**
 194      * Disconnects the PKCS#11 library from this object. After calling this
 195      * method, this object is no longer connected to a native PKCS#11 module
 196      * and any subsequent calls to C_ methods will fail. This method is for
 197      * internal use only.
 198      * Declared private, because incorrect handling may result in errors in the
 199      * native part.
 200      *
 201      * @preconditions
 202      * @postconditions
 203      */
 204     private native void disconnect();
 205 
 206 
 207     // Implementation of PKCS11 methods delegated to native pkcs11wrapper library
 208 
 209 /* *****************************************************************************
 210  * General-purpose
 211  ******************************************************************************/
 212 
 213     /**
 214      * C_Initialize initializes the Cryptoki library.
 215      * (General-purpose)
 216      *
 217      * @param pInitArgs if pInitArgs is not NULL it gets casted to
 218      *         CK_C_INITIALIZE_ARGS_PTR and dereferenced
 219      *         (PKCS#11 param: CK_VOID_PTR pInitArgs)
 220      * @exception PKCS11Exception If function returns other value than CKR_OK.
 221      * @preconditions
 222      * @postconditions
 223      */
 224     native void C_Initialize(Object pInitArgs) throws PKCS11Exception;
 225 
 226     /**
 227      * C_Finalize indicates that an application is done with the
 228      * Cryptoki library
 229      * (General-purpose)
 230      *
 231      * @param pReserved is reserved. Should be NULL_PTR
 232      *         (PKCS#11 param: CK_VOID_PTR pReserved)
 233      * @exception PKCS11Exception If function returns other value than CKR_OK.
 234      * @preconditions (pReserved == null)
 235      * @postconditions
 236      */
 237     public native void C_Finalize(Object pReserved) throws PKCS11Exception;
 238 
 239 
 240     /**
 241      * C_GetInfo returns general information about Cryptoki.
 242      * (General-purpose)
 243      *
 244      * @return the information.
 245      *         (PKCS#11 param: CK_INFO_PTR pInfo)
 246      * @exception PKCS11Exception If function returns other value than CKR_OK.
 247      * @preconditions
 248      * @postconditions (result &lt;&gt; null)
 249      */
 250     public native CK_INFO C_GetInfo() throws PKCS11Exception;
 251 
 252 
 253 /* *****************************************************************************
 254  * Slot and token management
 255  ******************************************************************************/
 256 
 257     /**
 258      * C_GetSlotList obtains a list of slots in the system.
 259      * (Slot and token management)
 260      *
 261      * @param tokenPresent if true only Slot IDs with a token are returned
 262      *         (PKCS#11 param: CK_BBOOL tokenPresent)
 263      * @return a long array of slot IDs and number of Slot IDs
 264      *         (PKCS#11 param: CK_SLOT_ID_PTR pSlotList, CK_ULONG_PTR pulCount)
 265      * @exception PKCS11Exception If function returns other value than CKR_OK.
 266      * @preconditions
 267      * @postconditions (result &lt;&gt; null)
 268      */
 269     public native long[] C_GetSlotList(boolean tokenPresent)
 270             throws PKCS11Exception;
 271 
 272 
 273     /**
 274      * C_GetSlotInfo obtains information about a particular slot in
 275      * the system.
 276      * (Slot and token management)
 277      *
 278      * @param slotID the ID of the slot
 279      *         (PKCS#11 param: CK_SLOT_ID slotID)
 280      * @return the slot information
 281      *         (PKCS#11 param: CK_SLOT_INFO_PTR pInfo)
 282      * @exception PKCS11Exception If function returns other value than CKR_OK.
 283      * @preconditions
 284      * @postconditions (result &lt;&gt; null)
 285      */
 286     public native CK_SLOT_INFO C_GetSlotInfo(long slotID) throws PKCS11Exception;
 287 
 288 
 289     /**
 290      * C_GetTokenInfo obtains information about a particular token
 291      * in the system.
 292      * (Slot and token management)
 293      *
 294      * @param slotID ID of the token&#39;s slot
 295      *         (PKCS#11 param: CK_SLOT_ID slotID)
 296      * @return the token information
 297      *         (PKCS#11 param: CK_TOKEN_INFO_PTR pInfo)
 298      * @exception PKCS11Exception If function returns other value than CKR_OK.
 299      * @preconditions
 300      * @postconditions (result &lt;&gt; null)
 301      */
 302     public native CK_TOKEN_INFO C_GetTokenInfo(long slotID)
 303             throws PKCS11Exception;
 304 
 305 
 306     /**
 307      * C_GetMechanismList obtains a list of mechanism types
 308      * supported by a token.
 309      * (Slot and token management)
 310      *
 311      * @param slotID ID of the token&#39;s slot
 312      *         (PKCS#11 param: CK_SLOT_ID slotID)
 313      * @return a long array of mechanism types and number of mechanism types
 314      *         (PKCS#11 param: CK_MECHANISM_TYPE_PTR pMechanismList,
 315      *                         CK_ULONG_PTR pulCount)
 316      * @exception PKCS11Exception If function returns other value than CKR_OK.
 317      * @preconditions
 318      * @postconditions (result &lt;&gt; null)
 319      */
 320     public native long[] C_GetMechanismList(long slotID) throws PKCS11Exception;
 321 
 322 
 323     /**
 324      * C_GetMechanismInfo obtains information about a particular
 325      * mechanism possibly supported by a token.
 326      * (Slot and token management)
 327      *
 328      * @param slotID ID of the token&#39;s slot
 329      *         (PKCS#11 param: CK_SLOT_ID slotID)
 330      * @param type type of mechanism
 331      *         (PKCS#11 param: CK_MECHANISM_TYPE type)
 332      * @return the mechanism info
 333      *         (PKCS#11 param: CK_MECHANISM_INFO_PTR pInfo)
 334      * @exception PKCS11Exception If function returns other value than CKR_OK.
 335      * @preconditions
 336      * @postconditions (result &lt;&gt; null)
 337      */
 338     public native CK_MECHANISM_INFO C_GetMechanismInfo(long slotID, long type)
 339             throws PKCS11Exception;
 340 
 341 
 342     /**
 343      * C_InitToken initializes a token.
 344      * (Slot and token management)
 345      *
 346      * @param slotID ID of the token&#39;s slot
 347      *         (PKCS#11 param: CK_SLOT_ID slotID)
 348      * @param pPin the SO&#39;s initial PIN and the length in bytes of the PIN
 349      *         (PKCS#11 param: CK_CHAR_PTR pPin, CK_ULONG ulPinLen)
 350      * @param pLabel 32-byte token label (blank padded)
 351      *         (PKCS#11 param: CK_UTF8CHAR_PTR pLabel)
 352      * @exception PKCS11Exception If function returns other value than CKR_OK.
 353      * @preconditions
 354      * @postconditions
 355      */
 356 //    public native void C_InitToken(long slotID, char[] pPin, char[] pLabel)
 357 //            throws PKCS11Exception;
 358 
 359 
 360     /**
 361      * C_InitPIN initializes the normal user&#39;s PIN.
 362      * (Slot and token management)
 363      *
 364      * @param hSession the session&#39;s handle
 365      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 366      * @param pPin the normal user&#39;s PIN and the length in bytes of the PIN
 367      *         (PKCS#11 param: CK_CHAR_PTR pPin, CK_ULONG ulPinLen)
 368      * @exception PKCS11Exception If function returns other value than CKR_OK.
 369      * @preconditions
 370      * @postconditions
 371      */
 372 //    public native void C_InitPIN(long hSession, char[] pPin)
 373 //            throws PKCS11Exception;
 374 
 375 
 376     /**
 377      * C_SetPIN modifies the PIN of the user who is logged in.
 378      * (Slot and token management)
 379      *
 380      * @param hSession the session&#39;s handle
 381      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 382      * @param pOldPin the old PIN and the length of the old PIN
 383      *         (PKCS#11 param: CK_CHAR_PTR pOldPin, CK_ULONG ulOldLen)
 384      * @param pNewPin the new PIN and the length of the new PIN
 385      *         (PKCS#11 param: CK_CHAR_PTR pNewPin, CK_ULONG ulNewLen)
 386      * @exception PKCS11Exception If function returns other value than CKR_OK.
 387      * @preconditions
 388      * @postconditions
 389      */
 390 //    public native void C_SetPIN(long hSession, char[] pOldPin, char[] pNewPin)
 391 //            throws PKCS11Exception;
 392 
 393 
 394 
 395 /* *****************************************************************************
 396  * Session management
 397  ******************************************************************************/
 398 
 399     /**
 400      * C_OpenSession opens a session between an application and a
 401      * token.
 402      * (Session management)
 403      *
 404      * @param slotID the slot&#39;s ID
 405      *         (PKCS#11 param: CK_SLOT_ID slotID)
 406      * @param flags of CK_SESSION_INFO
 407      *         (PKCS#11 param: CK_FLAGS flags)
 408      * @param pApplication passed to callback
 409      *         (PKCS#11 param: CK_VOID_PTR pApplication)
 410      * @param Notify the callback function
 411      *         (PKCS#11 param: CK_NOTIFY Notify)
 412      * @return the session handle
 413      *         (PKCS#11 param: CK_SESSION_HANDLE_PTR phSession)
 414      * @exception PKCS11Exception If function returns other value than CKR_OK.
 415      * @preconditions
 416      * @postconditions
 417      */
 418     public native long C_OpenSession(long slotID, long flags,
 419             Object pApplication, CK_NOTIFY Notify) throws PKCS11Exception;
 420 
 421 
 422     /**
 423      * C_CloseSession closes a session between an application and a
 424      * token.
 425      * (Session management)
 426      *
 427      * @param hSession the session&#39;s handle
 428      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 429      * @exception PKCS11Exception If function returns other value than CKR_OK.
 430      * @preconditions
 431      * @postconditions
 432      */
 433     public native void C_CloseSession(long hSession) throws PKCS11Exception;
 434 
 435 
 436     /**
 437      * C_CloseAllSessions closes all sessions with a token.
 438      * (Session management)
 439      *
 440      * @param slotID the ID of the token&#39;s slot
 441      *         (PKCS#11 param: CK_SLOT_ID slotID)
 442      * @exception PKCS11Exception If function returns other value than CKR_OK.
 443      * @preconditions
 444      * @postconditions
 445      */
 446 //    public native void C_CloseAllSessions(long slotID) throws PKCS11Exception;
 447 
 448 
 449     /**
 450      * C_GetSessionInfo obtains information about the session.
 451      * (Session management)
 452      *
 453      * @param hSession the session&#39;s handle
 454      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 455      * @return the session info
 456      *         (PKCS#11 param: CK_SESSION_INFO_PTR pInfo)
 457      * @exception PKCS11Exception If function returns other value than CKR_OK.
 458      * @preconditions
 459      * @postconditions (result &lt;&gt; null)
 460      */
 461     public native CK_SESSION_INFO C_GetSessionInfo(long hSession)
 462             throws PKCS11Exception;
 463 
 464 
 465     /**
 466      * C_GetOperationState obtains the state of the cryptographic operation
 467      * in a session.
 468      * (Session management)
 469      *
 470      * @param hSession session&#39;s handle
 471      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 472      * @return the state and the state length
 473      *         (PKCS#11 param: CK_BYTE_PTR pOperationState,
 474      *                         CK_ULONG_PTR pulOperationStateLen)
 475      * @exception PKCS11Exception If function returns other value than CKR_OK.
 476      * @preconditions
 477      * @postconditions (result &lt;&gt; null)
 478      */
 479     public native byte[] C_GetOperationState(long hSession)
 480             throws PKCS11Exception;
 481 
 482 
 483     /**
 484      * C_SetOperationState restores the state of the cryptographic
 485      * operation in a session.
 486      * (Session management)
 487      *
 488      * @param hSession session&#39;s handle
 489      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 490      * @param pOperationState the state and the state length
 491      *         (PKCS#11 param: CK_BYTE_PTR pOperationState,
 492      *                         CK_ULONG ulOperationStateLen)
 493      * @param hEncryptionKey en/decryption key
 494      *         (PKCS#11 param: CK_OBJECT_HANDLE hEncryptionKey)
 495      * @param hAuthenticationKey sign/verify key
 496      *         (PKCS#11 param: CK_OBJECT_HANDLE hAuthenticationKey)
 497      * @exception PKCS11Exception If function returns other value than CKR_OK.
 498      * @preconditions
 499      * @postconditions
 500      */
 501     public native void C_SetOperationState(long hSession, byte[] pOperationState,
 502             long hEncryptionKey, long hAuthenticationKey) throws PKCS11Exception;
 503 
 504 
 505     /**
 506      * C_Login logs a user into a token.
 507      * (Session management)
 508      *
 509      * @param hSession the session&#39;s handle
 510      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 511      * @param userType the user type
 512      *         (PKCS#11 param: CK_USER_TYPE userType)
 513      * @param pPin the user&#39;s PIN and the length of the PIN
 514      *         (PKCS#11 param: CK_CHAR_PTR pPin, CK_ULONG ulPinLen)
 515      * @exception PKCS11Exception If function returns other value than CKR_OK.
 516      * @preconditions
 517      * @postconditions
 518      */
 519     public native void C_Login(long hSession, long userType, char[] pPin)
 520             throws PKCS11Exception;
 521 
 522 
 523     /**
 524      * C_Logout logs a user out from a token.
 525      * (Session management)
 526      *
 527      * @param hSession the session&#39;s handle
 528      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 529      * @exception PKCS11Exception If function returns other value than CKR_OK.
 530      * @preconditions
 531      * @postconditions
 532      */
 533     public native void C_Logout(long hSession) throws PKCS11Exception;
 534 
 535 
 536 
 537 /* *****************************************************************************
 538  * Object management
 539  ******************************************************************************/
 540 
 541     /**
 542      * C_CreateObject creates a new object.
 543      * (Object management)
 544      *
 545      * @param hSession the session&#39;s handle
 546      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 547      * @param pTemplate the object&#39;s template and number of attributes in
 548      *         template
 549      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
 550      * @return the object&#39;s handle
 551      *         (PKCS#11 param: CK_OBJECT_HANDLE_PTR phObject)
 552      * @exception PKCS11Exception If function returns other value than CKR_OK.
 553      * @preconditions
 554      * @postconditions
 555      */
 556     public native long C_CreateObject(long hSession, CK_ATTRIBUTE[] pTemplate)
 557             throws PKCS11Exception;
 558 
 559 
 560     /**
 561      * C_CopyObject copies an object, creating a new object for the
 562      * copy.
 563      * (Object management)
 564      *
 565      * @param hSession the session&#39;s handle
 566      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 567      * @param hObject the object&#39;s handle
 568      *         (PKCS#11 param: CK_OBJECT_HANDLE hObject)
 569      * @param pTemplate the template for the new object and number of attributes
 570      *         in template
 571      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
 572      * @return the handle of the copy
 573      *         (PKCS#11 param: CK_OBJECT_HANDLE_PTR phNewObject)
 574      * @exception PKCS11Exception If function returns other value than CKR_OK.
 575      * @preconditions
 576      * @postconditions
 577      */
 578     public native long C_CopyObject(long hSession, long hObject,
 579             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception;
 580 
 581 
 582     /**
 583      * C_DestroyObject destroys an object.
 584      * (Object management)
 585      *
 586      * @param hSession the session&#39;s handle
 587      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 588      * @param hObject the object&#39;s handle
 589      *         (PKCS#11 param: CK_OBJECT_HANDLE hObject)
 590      * @exception PKCS11Exception If function returns other value than CKR_OK.
 591      * @preconditions
 592      * @postconditions
 593      */
 594     public native void C_DestroyObject(long hSession, long hObject)
 595             throws PKCS11Exception;
 596 
 597 
 598     /**
 599      * C_GetObjectSize gets the size of an object in bytes.
 600      * (Object management)
 601      *
 602      * @param hSession the session&#39;s handle
 603      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 604      * @param hObject the object&#39;s handle
 605      *         (PKCS#11 param: CK_OBJECT_HANDLE hObject)
 606      * @return the size of the object
 607      *         (PKCS#11 param: CK_ULONG_PTR pulSize)
 608      * @exception PKCS11Exception If function returns other value than CKR_OK.
 609      * @preconditions
 610      * @postconditions
 611      */
 612 //    public native long C_GetObjectSize(long hSession, long hObject)
 613 //            throws PKCS11Exception;
 614 
 615 
 616     /**
 617      * C_GetAttributeValue obtains the value of one or more object
 618      * attributes. The template attributes also receive the values.
 619      * (Object management)
 620      * note: in PKCS#11 pTemplate and the result template are the same
 621      *
 622      * @param hSession the session&#39;s handle
 623      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 624      * @param hObject the object&#39;s handle
 625      *         (PKCS#11 param: CK_OBJECT_HANDLE hObject)
 626      * @param pTemplate specifies the attributes and number of attributes to get
 627      *                  The template attributes also receive the values.
 628      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
 629      * @exception PKCS11Exception If function returns other value than CKR_OK.
 630      * @preconditions (pTemplate &lt;&gt; null)
 631      * @postconditions (result &lt;&gt; null)
 632      */
 633     public native void C_GetAttributeValue(long hSession, long hObject,
 634             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception;
 635 
 636 
 637     /**
 638      * C_SetAttributeValue modifies the value of one or more object
 639      * attributes
 640      * (Object management)
 641      *
 642      * @param hSession the session&#39;s handle
 643      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 644      * @param hObject the object&#39;s handle
 645      *         (PKCS#11 param: CK_OBJECT_HANDLE hObject)
 646      * @param pTemplate specifies the attributes and values to get; number of
 647      *         attributes in the template
 648      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
 649      * @exception PKCS11Exception If function returns other value than CKR_OK.
 650      * @preconditions (pTemplate &lt;&gt; null)
 651      * @postconditions
 652      */
 653     public native void C_SetAttributeValue(long hSession, long hObject,
 654             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception;
 655 
 656 
 657     /**
 658      * C_FindObjectsInit initializes a search for token and session
 659      * objects that match a template.
 660      * (Object management)
 661      *
 662      * @param hSession the session&#39;s handle
 663      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 664      * @param pTemplate the object&#39;s attribute values to match and the number of
 665      *         attributes in search template
 666      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
 667      * @exception PKCS11Exception If function returns other value than CKR_OK.
 668      * @preconditions
 669      * @postconditions
 670      */
 671     public native void C_FindObjectsInit(long hSession, CK_ATTRIBUTE[] pTemplate)
 672             throws PKCS11Exception;
 673 
 674 
 675     /**
 676      * C_FindObjects continues a search for token and session
 677      * objects that match a template, obtaining additional object
 678      * handles.
 679      * (Object management)
 680      *
 681      * @param hSession the session&#39;s handle
 682      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 683      * @param ulMaxObjectCount the max. object handles to get
 684      *         (PKCS#11 param: CK_ULONG ulMaxObjectCount)
 685      * @return the object&#39;s handles and the actual number of objects returned
 686      *         (PKCS#11 param: CK_ULONG_PTR pulObjectCount)
 687      * @exception PKCS11Exception If function returns other value than CKR_OK.
 688      * @preconditions
 689      * @postconditions (result &lt;&gt; null)
 690      */
 691     public native long[] C_FindObjects(long hSession, long ulMaxObjectCount)
 692             throws PKCS11Exception;
 693 
 694 
 695     /**
 696      * C_FindObjectsFinal finishes a search for token and session
 697      * objects.
 698      * (Object management)
 699      *
 700      * @param hSession the session&#39;s handle
 701      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 702      * @exception PKCS11Exception If function returns other value than CKR_OK.
 703      * @preconditions
 704      * @postconditions
 705      */
 706     public native void C_FindObjectsFinal(long hSession) throws PKCS11Exception;
 707 
 708 
 709 
 710 /* *****************************************************************************
 711  * Encryption and decryption
 712  ******************************************************************************/
 713 
 714     /**
 715      * C_EncryptInit initializes an encryption operation.
 716      * (Encryption and decryption)
 717      *
 718      * @param hSession the session&#39;s handle
 719      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 720      * @param pMechanism the encryption mechanism
 721      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
 722      * @param hKey the handle of the encryption key
 723      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
 724      * @exception PKCS11Exception If function returns other value than CKR_OK.
 725      * @preconditions
 726      * @postconditions
 727      */
 728     public native void C_EncryptInit(long hSession, CK_MECHANISM pMechanism,
 729             long hKey) throws PKCS11Exception;
 730 
 731 
 732     /**
 733      * C_Encrypt encrypts single-part data.
 734      * (Encryption and decryption)
 735      *
 736      * @param hSession the session&#39;s handle
 737      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 738      * @param directIn the address of the to-be-encrypted data
 739      * @param in buffer containing the to-be-encrypted data
 740      * @param inOfs buffer offset of the to-be-encrypted data
 741      * @param inLen length of the to-be-encrypted data
 742      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG ulDataLen)
 743      * @param directOut the address for the encrypted data
 744      * @param out buffer for the encrypted data
 745      * @param outOfs buffer offset for the encrypted data
 746      * @param outLen buffer size for the encrypted data
 747      * @return the length of encrypted data
 748      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedData,
 749      *                         CK_ULONG_PTR pulEncryptedDataLen)
 750      * @exception PKCS11Exception If function returns other value than CKR_OK.
 751      * @preconditions
 752      * @postconditions
 753      */
 754     public native int C_Encrypt(long hSession, long directIn, byte[] in,
 755             int inOfs, int inLen, long directOut, byte[] out, int outOfs,
 756             int outLen) throws PKCS11Exception;
 757 
 758 
 759     /**
 760      * C_EncryptUpdate continues a multiple-part encryption
 761      * operation.
 762      * (Encryption and decryption)
 763      *
 764      * @param hSession the session&#39;s handle
 765      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 766      * @param directIn the address of the to-be-encrypted data
 767      * @param in buffer containing the to-be-encrypted data
 768      * @param inOfs buffer offset of the to-be-encrypted data
 769      * @param inLen length of the to-be-encrypted data
 770      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
 771      * @param directOut the address for the encrypted data
 772      * @param out buffer for the encrypted data
 773      * @param outOfs buffer offset for the encrypted data
 774      * @param outLen buffer size for the encrypted data
 775      * @return the length of encrypted data for this update
 776      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,
 777                              CK_ULONG_PTR pulEncryptedPartLen)
 778      * @exception PKCS11Exception If function returns other value than CKR_OK.
 779      * @preconditions
 780      * @postconditions
 781      */
 782     public native int C_EncryptUpdate(long hSession, long directIn, byte[] in,
 783             int inOfs, int inLen, long directOut, byte[] out, int outOfs,
 784             int outLen) throws PKCS11Exception;
 785 
 786 
 787     /**
 788      * C_EncryptFinal finishes a multiple-part encryption
 789      * operation.
 790      * (Encryption and decryption)
 791      *
 792      * @param hSession the session&#39;s handle
 793      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 794      * @param directOut the address for the encrypted data
 795      * @param out buffer for the encrypted data
 796      * @param outOfs buffer offset for the encrypted data
 797      * @param outLen buffer size for the encrypted data
 798      * @return the length of the last part of the encrypted data
 799      *         (PKCS#11 param: CK_BYTE_PTR pLastEncryptedPart,
 800                              CK_ULONG_PTR pulLastEncryptedPartLen)
 801      * @exception PKCS11Exception If function returns other value than CKR_OK.
 802      * @preconditions
 803      * @postconditions
 804      */
 805     public native int C_EncryptFinal(long hSession, long directOut, byte[] out,
 806             int outOfs, int outLen) throws PKCS11Exception;
 807 
 808 
 809     /**
 810      * C_DecryptInit initializes a decryption operation.
 811      * (Encryption and decryption)
 812      *
 813      * @param hSession the session&#39;s handle
 814      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 815      * @param pMechanism the decryption mechanism
 816      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
 817      * @param hKey the handle of the decryption key
 818      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
 819      * @exception PKCS11Exception If function returns other value than CKR_OK.
 820      * @preconditions
 821      * @postconditions
 822      */
 823     public native void C_DecryptInit(long hSession, CK_MECHANISM pMechanism,
 824             long hKey) throws PKCS11Exception;
 825 
 826 
 827     /**
 828      * C_Decrypt decrypts encrypted data in a single part.
 829      * (Encryption and decryption)
 830      *
 831      * @param hSession the session&#39;s handle
 832      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 833      * @param directIn the address of the to-be-decrypted data
 834      * @param in buffer containing the to-be-decrypted data
 835      * @param inOfs buffer offset of the to-be-decrypted data
 836      * @param inLen length of the to-be-decrypted data
 837      *         (PKCS#11 param: CK_BYTE_PTR pDecryptedData,
 838      *                         CK_ULONG ulDecryptedDataLen)
 839      * @param directOut the address for the decrypted data
 840      * @param out buffer for the decrypted data
 841      * @param outOfs buffer offset for the decrypted data
 842      * @param outLen buffer size for the decrypted data
 843      * @return the length of decrypted data
 844      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG_PTR pulDataLen)
 845      * @exception PKCS11Exception If function returns other value than CKR_OK.
 846      * @preconditions
 847      * @postconditions
 848      */
 849     public native int C_Decrypt(long hSession, long directIn, byte[] in,
 850             int inOfs, int inLen, long directOut, byte[] out, int outOfs,
 851             int outLen) throws PKCS11Exception;
 852 
 853 
 854     /**
 855      * C_DecryptUpdate continues a multiple-part decryption
 856      * operation.
 857      * (Encryption and decryption)
 858      *
 859      * @param hSession the session&#39;s handle
 860      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 861      * @param directIn the address of the to-be-decrypted data
 862      * @param in buffer containing the to-be-decrypted data
 863      * @param inOfs buffer offset of the to-be-decrypted data
 864      * @param inLen length of the to-be-decrypted data
 865      *         (PKCS#11 param: CK_BYTE_PTR pDecryptedPart,
 866      *                         CK_ULONG ulDecryptedPartLen)
 867      * @param directOut the address for the decrypted data
 868      * @param out buffer for the decrypted data
 869      * @param outOfs buffer offset for the decrypted data
 870      * @param outLen buffer size for the decrypted data
 871      * @return the length of decrypted data for this update
 872      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG_PTR pulPartLen)
 873      * @exception PKCS11Exception If function returns other value than CKR_OK.
 874      * @preconditions
 875      * @postconditions
 876      */
 877     public native int C_DecryptUpdate(long hSession, long directIn, byte[] in,
 878             int inOfs, int inLen, long directOut, byte[] out, int outOfs,
 879             int outLen) throws PKCS11Exception;
 880 
 881 
 882     /**
 883      * C_DecryptFinal finishes a multiple-part decryption
 884      * operation.
 885      * (Encryption and decryption)
 886      *
 887      * @param hSession the session&#39;s handle
 888      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 889      * @param directOut the address for the decrypted data
 890      * @param out buffer for the decrypted data
 891      * @param outOfs buffer offset for the decrypted data
 892      * @param outLen buffer size for the decrypted data
 893      * @return the length of this last part of decrypted data
 894      *         (PKCS#11 param: CK_BYTE_PTR pLastPart,
 895      *                         CK_ULONG_PTR pulLastPartLen)
 896      * @exception PKCS11Exception If function returns other value than CKR_OK.
 897      * @preconditions
 898      * @postconditions
 899      */
 900     public native int C_DecryptFinal(long hSession, long directOut, byte[] out,
 901             int outOfs, int outLen) throws PKCS11Exception;
 902 
 903 
 904 
 905 /* *****************************************************************************
 906  * Message digesting
 907  ******************************************************************************/
 908 
 909     /**
 910      * C_DigestInit initializes a message-digesting operation.
 911      * (Message digesting)
 912      *
 913      * @param hSession the session&#39;s handle
 914      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 915      * @param pMechanism the digesting mechanism
 916      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
 917      * @exception PKCS11Exception If function returns other value than CKR_OK.
 918      * @preconditions
 919      * @postconditions
 920      */
 921     public native void C_DigestInit(long hSession, CK_MECHANISM pMechanism)
 922             throws PKCS11Exception;
 923 
 924 
 925     // note that C_DigestSingle does not exist in PKCS#11
 926     // we combined the C_DigestInit and C_Digest into a single function
 927     // to save on Java&lt;-&gt;C transitions and save 5-10% on small digests
 928     // this made the C_Digest method redundant, it has been removed
 929     /**
 930      * C_Digest digests data in a single part.
 931      * (Message digesting)
 932      *
 933      * @param hSession the session&#39;s handle
 934      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 935      * @param data the data to get digested and the data&#39;s length
 936      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG ulDataLen)
 937      * @return the message digest and the length of the message digest
 938      *         (PKCS#11 param: CK_BYTE_PTR pDigest, CK_ULONG_PTR pulDigestLen)
 939      * @exception PKCS11Exception If function returns other value than CKR_OK.
 940      * @preconditions (data &lt;&gt; null)
 941      * @postconditions (result &lt;&gt; null)
 942      */
 943     public native int C_DigestSingle(long hSession, CK_MECHANISM pMechanism,
 944             byte[] in, int inOfs, int inLen, byte[] digest, int digestOfs,
 945             int digestLen) throws PKCS11Exception;
 946 
 947 
 948     /**
 949      * C_DigestUpdate continues a multiple-part message-digesting
 950      * operation.
 951      * (Message digesting)
 952      *
 953      * @param hSession the session&#39;s handle
 954      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 955      * @param pPart the data to get digested and the data&#39;s length
 956      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
 957      * @exception PKCS11Exception If function returns other value than CKR_OK.
 958      * @preconditions (pPart &lt;&gt; null)
 959      * @postconditions
 960      */
 961     public native void C_DigestUpdate(long hSession, long directIn, byte[] in,
 962             int inOfs, int inLen) throws PKCS11Exception;
 963 
 964 
 965     /**
 966      * C_DigestKey continues a multi-part message-digesting
 967      * operation, by digesting the value of a secret key as part of
 968      * the data already digested.
 969      * (Message digesting)
 970      *
 971      * @param hSession the session&#39;s handle
 972      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 973      * @param hKey the handle of the secret key to be digested
 974      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
 975      * @exception PKCS11Exception If function returns other value than CKR_OK.
 976      * @preconditions
 977      * @postconditions
 978      */
 979     public native void C_DigestKey(long hSession, long hKey)
 980             throws PKCS11Exception;
 981 
 982 
 983     /**
 984      * C_DigestFinal finishes a multiple-part message-digesting
 985      * operation.
 986      * (Message digesting)
 987      *
 988      * @param hSession the session&#39;s handle
 989      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
 990      * @return the message digest and the length of the message digest
 991      *         (PKCS#11 param: CK_BYTE_PTR pDigest, CK_ULONG_PTR pulDigestLen)
 992      * @exception PKCS11Exception If function returns other value than CKR_OK.
 993      * @preconditions
 994      * @postconditions (result &lt;&gt; null)
 995      */
 996     public native int C_DigestFinal(long hSession, byte[] pDigest, int digestOfs,
 997             int digestLen) throws PKCS11Exception;
 998 
 999 
1000 
1001 /* *****************************************************************************
1002  * Signing and MACing
1003  ******************************************************************************/
1004 
1005     /**
1006      * C_SignInit initializes a signature (private key encryption)
1007      * operation, where the signature is (will be) an appendix to
1008      * the data, and plaintext cannot be recovered from the
1009      * signature.
1010      * (Signing and MACing)
1011      *
1012      * @param hSession the session&#39;s handle
1013      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1014      * @param pMechanism the signature mechanism
1015      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1016      * @param hKey the handle of the signature key
1017      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
1018      * @exception PKCS11Exception If function returns other value than CKR_OK.
1019      * @preconditions
1020      * @postconditions
1021      */
1022     public native void C_SignInit(long hSession, CK_MECHANISM pMechanism,
1023             long hKey) throws PKCS11Exception;
1024 
1025 
1026     /**
1027      * C_Sign signs (encrypts with private key) data in a single
1028      * part, where the signature is (will be) an appendix to the
1029      * data, and plaintext cannot be recovered from the signature.
1030      * (Signing and MACing)
1031      *
1032      * @param hSession the session&#39;s handle
1033      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1034      * @param pData the data to sign and the data&#39;s length
1035      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG ulDataLen)
1036      * @return the signature and the signature&#39;s length
1037      *         (PKCS#11 param: CK_BYTE_PTR pSignature,
1038      *                         CK_ULONG_PTR pulSignatureLen)
1039      * @exception PKCS11Exception If function returns other value than CKR_OK.
1040      * @preconditions (pData &lt;&gt; null)
1041      * @postconditions (result &lt;&gt; null)
1042      */
1043     public native byte[] C_Sign(long hSession, byte[] pData)
1044             throws PKCS11Exception;
1045 
1046 
1047     /**
1048      * C_SignUpdate continues a multiple-part signature operation,
1049      * where the signature is (will be) an appendix to the data,
1050      * and plaintext cannot be recovered from the signature.
1051      * (Signing and MACing)
1052      *
1053      * @param hSession the session&#39;s handle
1054      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1055      * @param pPart the data part to sign and the data part&#39;s length
1056      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
1057      * @exception PKCS11Exception If function returns other value than CKR_OK.
1058      * @preconditions (pPart &lt;&gt; null)
1059      * @postconditions
1060      */
1061     public native void C_SignUpdate(long hSession, long directIn, byte[] in,
1062             int inOfs, int inLen) throws PKCS11Exception;
1063 
1064 
1065     /**
1066      * C_SignFinal finishes a multiple-part signature operation,
1067      * returning the signature.
1068      * (Signing and MACing)
1069      *
1070      * @param hSession the session&#39;s handle
1071      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1072      * @param expectedLen expected signature length, can be 0 if unknown
1073      * @return the signature and the signature&#39;s length
1074      *         (PKCS#11 param: CK_BYTE_PTR pSignature,
1075      *                         CK_ULONG_PTR pulSignatureLen)
1076      * @exception PKCS11Exception If function returns other value than CKR_OK.
1077      * @preconditions
1078      * @postconditions (result &lt;&gt; null)
1079      */
1080     public native byte[] C_SignFinal(long hSession, int expectedLen)
1081             throws PKCS11Exception;
1082 
1083 
1084     /**
1085      * C_SignRecoverInit initializes a signature operation, where
1086      * the data can be recovered from the signature.
1087      * (Signing and MACing)
1088      *
1089      * @param hSession the session&#39;s handle
1090      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1091      * @param pMechanism the signature mechanism
1092      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1093      * @param hKey the handle of the signature key
1094      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
1095      * @exception PKCS11Exception If function returns other value than CKR_OK.
1096      * @preconditions
1097      * @postconditions
1098      */
1099     public native void C_SignRecoverInit(long hSession, CK_MECHANISM pMechanism,
1100             long hKey) throws PKCS11Exception;
1101 
1102 
1103     /**
1104      * C_SignRecover signs data in a single operation, where the
1105      * data can be recovered from the signature.
1106      * (Signing and MACing)
1107      *
1108      * @param hSession the session&#39;s handle
1109      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1110      * @param pData the data to sign and the data&#39;s length
1111      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG ulDataLen)
1112      * @return the signature and the signature&#39;s length
1113      *         (PKCS#11 param: CK_BYTE_PTR pSignature,
1114      *                         CK_ULONG_PTR pulSignatureLen)
1115      * @exception PKCS11Exception If function returns other value than CKR_OK.
1116      * @preconditions (pData &lt;&gt; null)
1117      * @postconditions (result &lt;&gt; null)
1118      */
1119     public native int C_SignRecover(long hSession, byte[] in, int inOfs,
1120             int inLen, byte[] out, int outOufs, int outLen)
1121             throws PKCS11Exception;
1122 
1123 
1124 
1125 /* *****************************************************************************
1126  * Verifying signatures and MACs
1127  ******************************************************************************/
1128 
1129     /**
1130      * C_VerifyInit initializes a verification operation, where the
1131      * signature is an appendix to the data, and plaintext cannot
1132      * cannot be recovered from the signature (e.g. DSA).
1133      * (Signing and MACing)
1134      *
1135      * @param hSession the session&#39;s handle
1136      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1137      * @param pMechanism the verification mechanism
1138      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1139      * @param hKey the handle of the verification key
1140      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
1141      * @exception PKCS11Exception If function returns other value than CKR_OK.
1142      * @preconditions
1143      * @postconditions
1144      */
1145     public native void C_VerifyInit(long hSession, CK_MECHANISM pMechanism,
1146             long hKey) throws PKCS11Exception;
1147 
1148 
1149     /**
1150      * C_Verify verifies a signature in a single-part operation,
1151      * where the signature is an appendix to the data, and plaintext
1152      * cannot be recovered from the signature.
1153      * (Signing and MACing)
1154      *
1155      * @param hSession the session&#39;s handle
1156      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1157      * @param pData the signed data and the signed data&#39;s length
1158      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG ulDataLen)
1159      * @param pSignature the signature to verify and the signature&#39;s length
1160      *         (PKCS#11 param: CK_BYTE_PTR pSignature, CK_ULONG ulSignatureLen)
1161      * @exception PKCS11Exception If function returns other value than CKR_OK.
1162      * @preconditions (pData &lt;&gt; null) and (pSignature &lt;&gt; null)
1163      * @postconditions
1164      */
1165     public native void C_Verify(long hSession, byte[] pData, byte[] pSignature)
1166             throws PKCS11Exception;
1167 
1168 
1169     /**
1170      * C_VerifyUpdate continues a multiple-part verification
1171      * operation, where the signature is an appendix to the data,
1172      * and plaintext cannot be recovered from the signature.
1173      * (Signing and MACing)
1174      *
1175      * @param hSession the session&#39;s handle
1176      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1177      * @param pPart the signed data part and the signed data part&#39;s length
1178      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
1179      * @exception PKCS11Exception If function returns other value than CKR_OK.
1180      * @preconditions (pPart &lt;&gt; null)
1181      * @postconditions
1182      */
1183     public native void C_VerifyUpdate(long hSession, long directIn, byte[] in,
1184             int inOfs, int inLen) throws PKCS11Exception;
1185 
1186 
1187     /**
1188      * C_VerifyFinal finishes a multiple-part verification
1189      * operation, checking the signature.
1190      * (Signing and MACing)
1191      *
1192      * @param hSession the session&#39;s handle
1193      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1194      * @param pSignature the signature to verify and the signature&#39;s length
1195      *         (PKCS#11 param: CK_BYTE_PTR pSignature, CK_ULONG ulSignatureLen)
1196      * @exception PKCS11Exception If function returns other value than CKR_OK.
1197      * @preconditions (pSignature &lt;&gt; null)
1198      * @postconditions
1199      */
1200     public native void C_VerifyFinal(long hSession, byte[] pSignature)
1201             throws PKCS11Exception;
1202 
1203 
1204     /**
1205      * C_VerifyRecoverInit initializes a signature verification
1206      * operation, where the data is recovered from the signature.
1207      * (Signing and MACing)
1208      *
1209      * @param hSession the session&#39;s handle
1210      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1211      * @param pMechanism the verification mechanism
1212      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1213      * @param hKey the handle of the verification key
1214      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
1215      * @exception PKCS11Exception If function returns other value than CKR_OK.
1216      * @preconditions
1217      * @postconditions
1218      */
1219     public native void C_VerifyRecoverInit(long hSession,
1220             CK_MECHANISM pMechanism, long hKey) throws PKCS11Exception;
1221 
1222 
1223     /**
1224      * C_VerifyRecover verifies a signature in a single-part
1225      * operation, where the data is recovered from the signature.
1226      * (Signing and MACing)
1227      *
1228      * @param hSession the session&#39;s handle
1229      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1230      * @param pSignature the signature to verify and the signature&#39;s length
1231      *         (PKCS#11 param: CK_BYTE_PTR pSignature, CK_ULONG ulSignatureLen)
1232      * @return the recovered data and the recovered data&#39;s length
1233      *         (PKCS#11 param: CK_BYTE_PTR pData, CK_ULONG_PTR pulDataLen)
1234      * @exception PKCS11Exception If function returns other value than CKR_OK.
1235      * @preconditions (pSignature &lt;&gt; null)
1236      * @postconditions (result &lt;&gt; null)
1237      */
1238     public native int C_VerifyRecover(long hSession, byte[] in, int inOfs,
1239             int inLen, byte[] out, int outOufs, int outLen)
1240             throws PKCS11Exception;
1241 
1242 
1243 
1244 /* *****************************************************************************
1245  * Dual-function cryptographic operations
1246  ******************************************************************************/
1247 
1248     /**
1249      * C_DigestEncryptUpdate continues a multiple-part digesting
1250      * and encryption operation.
1251      * (Dual-function cryptographic operations)
1252      *
1253      * @param hSession the session&#39;s handle
1254      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1255      * @param pPart the data part to digest and to encrypt and the data&#39;s length
1256      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
1257      * @return the digested and encrypted data part and the data part&#39;s length
1258      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,
1259      *                         CK_ULONG_PTR pulEncryptedPartLen)
1260      * @exception PKCS11Exception If function returns other value than CKR_OK.
1261      * @preconditions (pPart &lt;&gt; null)
1262      * @postconditions
1263      */
1264 //    public native byte[] C_DigestEncryptUpdate(long hSession, byte[] pPart)
1265 //            throws PKCS11Exception;
1266 
1267 
1268     /**
1269      * C_DecryptDigestUpdate continues a multiple-part decryption and
1270      * digesting operation.
1271      * (Dual-function cryptographic operations)
1272      *
1273      * @param hSession the session&#39;s handle
1274      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1275      * @param pEncryptedPart the encrypted data part to decrypt and to digest
1276      *         and encrypted data part&#39;s length
1277      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,
1278      *                         CK_ULONG ulEncryptedPartLen)
1279      * @return the decrypted and digested data part and the data part&#39;s length
1280      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG_PTR pulPartLen)
1281      * @exception PKCS11Exception If function returns other value than CKR_OK.
1282      * @preconditions (pEncryptedPart &lt;&gt; null)
1283      * @postconditions
1284      */
1285 //    public native byte[] C_DecryptDigestUpdate(long hSession,
1286 //            byte[] pEncryptedPart) throws PKCS11Exception;
1287 
1288 
1289     /**
1290      * C_SignEncryptUpdate continues a multiple-part signing and
1291      * encryption operation.
1292      * (Dual-function cryptographic operations)
1293      *
1294      * @param hSession the session&#39;s handle
1295      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1296      * @param pPart the data part to sign and to encrypt and the data part&#39;s
1297      *         length
1298      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG ulPartLen)
1299      * @return the signed and encrypted data part and the data part&#39;s length
1300      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,
1301      *                         CK_ULONG_PTR pulEncryptedPartLen)
1302      * @exception PKCS11Exception If function returns other value than CKR_OK.
1303      * @preconditions (pPart &lt;&gt; null)
1304      * @postconditions
1305      */
1306 //    public native byte[] C_SignEncryptUpdate(long hSession, byte[] pPart)
1307 //            throws PKCS11Exception;
1308 
1309 
1310     /**
1311      * C_DecryptVerifyUpdate continues a multiple-part decryption and
1312      * verify operation.
1313      * (Dual-function cryptographic operations)
1314      *
1315      * @param hSession the session&#39;s handle
1316      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1317      * @param pEncryptedPart the encrypted data part to decrypt and to verify
1318      *         and the data part&#39;s length
1319      *         (PKCS#11 param: CK_BYTE_PTR pEncryptedPart,
1320      *                         CK_ULONG ulEncryptedPartLen)
1321      * @return the decrypted and verified data part and the data part&#39;s length
1322      *         (PKCS#11 param: CK_BYTE_PTR pPart, CK_ULONG_PTR pulPartLen)
1323      * @exception PKCS11Exception If function returns other value than CKR_OK.
1324      * @preconditions (pEncryptedPart &lt;&gt; null)
1325      * @postconditions
1326      */
1327 //    public native byte[] C_DecryptVerifyUpdate(long hSession,
1328 //            byte[] pEncryptedPart) throws PKCS11Exception;
1329 
1330 
1331 /* *****************************************************************************
1332  * Key management
1333  ******************************************************************************/
1334 
1335     /**
1336      * getNativeKeyInfo gets the key object attributes and values as an opaque
1337      * byte array to be used in createNativeKey method.
1338      * (Key management)
1339      *
1340      * @param hSession the session&#39;s handle
1341      * @param hKey key&#39;s handle
1342      * @param hWrappingKey key handle for wrapping the extracted sensitive keys.
1343      *        -1 if not used.
1344      * @param pWrappingMech mechanism for wrapping the extracted sensitive keys
1345      * @return an opaque byte array containing the key object attributes
1346      *         and values
1347      * @exception PKCS11Exception If an internal PKCS#11 function returns other
1348      *            value than CKR_OK.
1349      * @preconditions
1350      * @postconditions
1351      */
1352     public native byte[] getNativeKeyInfo(long hSession, long hKey,
1353             long hWrappingKey, CK_MECHANISM pWrappingMech) throws PKCS11Exception;
1354 
1355     /**
1356      * createNativeKey creates a key object with attributes and values
1357      * specified by parameter as an opaque byte array.
1358      * (Key management)
1359      *
1360      * @param hSession the session&#39;s handle
1361      * @param keyInfo opaque byte array containing key object attributes
1362      *        and values
1363      * @param hWrappingKey key handle for unwrapping the extracted sensitive keys.
1364      *        -1 if not used.
1365      * @param pWrappingMech mechanism for unwrapping the extracted sensitive keys
1366      * @return key object handle
1367      * @exception PKCS11Exception If an internal PKCS#11 function returns other
1368      *            value than CKR_OK.
1369      * @preconditions
1370      * @postconditions
1371      */
1372     public native long createNativeKey(long hSession, byte[] keyInfo,
1373             long hWrappingKey, CK_MECHANISM pWrappingMech) throws PKCS11Exception;
1374 
1375     /**
1376      * C_GenerateKey generates a secret key, creating a new key
1377      * object.
1378      * (Key management)
1379      *
1380      * @param hSession the session&#39;s handle
1381      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1382      * @param pMechanism the key generation mechanism
1383      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1384      * @param pTemplate the template for the new key and the number of
1385      *         attributes in the template
1386      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
1387      * @return the handle of the new key
1388      *         (PKCS#11 param: CK_OBJECT_HANDLE_PTR phKey)
1389      * @exception PKCS11Exception If function returns other value than CKR_OK.
1390      * @preconditions
1391      * @postconditions
1392      */
1393     public native long C_GenerateKey(long hSession, CK_MECHANISM pMechanism,
1394             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception;
1395 
1396 
1397     /**
1398      * C_GenerateKeyPair generates a public-key/private-key pair,
1399      * creating new key objects.
1400      * (Key management)
1401      *
1402      * @param hSession the session&#39;s handle
1403      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1404      * @param pMechanism the key generation mechanism
1405      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1406      * @param pPublicKeyTemplate the template for the new public key and the
1407      *         number of attributes in the template
1408      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pPublicKeyTemplate,
1409      *                         CK_ULONG ulPublicKeyAttributeCount)
1410      * @param pPrivateKeyTemplate the template for the new private key and the
1411      *         number of attributes in the template
1412      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pPrivateKeyTemplate
1413      *                         CK_ULONG ulPrivateKeyAttributeCount)
1414      * @return a long array with exactly two elements and the public key handle
1415      *         as the first element and the private key handle as the second
1416      *         element
1417      *         (PKCS#11 param: CK_OBJECT_HANDLE_PTR phPublicKey,
1418      *                         CK_OBJECT_HANDLE_PTR phPrivateKey)
1419      * @exception PKCS11Exception If function returns other value than CKR_OK.
1420      * @preconditions (pMechanism &lt;&gt; null)
1421      * @postconditions (result &lt;&gt; null) and (result.length == 2)
1422      */
1423     public native long[] C_GenerateKeyPair(long hSession,
1424             CK_MECHANISM pMechanism, CK_ATTRIBUTE[] pPublicKeyTemplate,
1425             CK_ATTRIBUTE[] pPrivateKeyTemplate) throws PKCS11Exception;
1426 
1427 
1428 
1429     /**
1430      * C_WrapKey wraps (i.e., encrypts) a key.
1431      * (Key management)
1432      *
1433      * @param hSession the session&#39;s handle
1434      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1435      * @param pMechanism the wrapping mechanism
1436      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1437      * @param hWrappingKey the handle of the wrapping key
1438      *         (PKCS#11 param: CK_OBJECT_HANDLE hWrappingKey)
1439      * @param hKey the handle of the key to be wrapped
1440      *         (PKCS#11 param: CK_OBJECT_HANDLE hKey)
1441      * @return the wrapped key and the length of the wrapped key
1442      *         (PKCS#11 param: CK_BYTE_PTR pWrappedKey,
1443      *                         CK_ULONG_PTR pulWrappedKeyLen)
1444      * @exception PKCS11Exception If function returns other value than CKR_OK.
1445      * @preconditions
1446      * @postconditions (result &lt;&gt; null)
1447      */
1448     public native byte[] C_WrapKey(long hSession, CK_MECHANISM pMechanism,
1449             long hWrappingKey, long hKey) throws PKCS11Exception;
1450 
1451 
1452     /**
1453      * C_UnwrapKey unwraps (decrypts) a wrapped key, creating a new
1454      * key object.
1455      * (Key management)
1456      *
1457      * @param hSession the session&#39;s handle
1458      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1459      * @param pMechanism the unwrapping mechanism
1460      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1461      * @param hUnwrappingKey the handle of the unwrapping key
1462      *         (PKCS#11 param: CK_OBJECT_HANDLE hUnwrappingKey)
1463      * @param pWrappedKey the wrapped key to unwrap and the wrapped key&#39;s length
1464      *         (PKCS#11 param: CK_BYTE_PTR pWrappedKey, CK_ULONG ulWrappedKeyLen)
1465      * @param pTemplate the template for the new key and the number of
1466      *         attributes in the template
1467      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
1468      * @return the handle of the unwrapped key
1469      *         (PKCS#11 param: CK_OBJECT_HANDLE_PTR phKey)
1470      * @exception PKCS11Exception If function returns other value than CKR_OK.
1471      * @preconditions (pWrappedKey &lt;&gt; null)
1472      * @postconditions
1473      */
1474     public native long C_UnwrapKey(long hSession, CK_MECHANISM pMechanism,
1475             long hUnwrappingKey, byte[] pWrappedKey, CK_ATTRIBUTE[] pTemplate)
1476             throws PKCS11Exception;
1477 
1478 
1479     /**
1480      * C_DeriveKey derives a key from a base key, creating a new key
1481      * object.
1482      * (Key management)
1483      *
1484      * @param hSession the session&#39;s handle
1485      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1486      * @param pMechanism the key derivation mechanism
1487      *         (PKCS#11 param: CK_MECHANISM_PTR pMechanism)
1488      * @param hBaseKey the handle of the base key
1489      *         (PKCS#11 param: CK_OBJECT_HANDLE hBaseKey)
1490      * @param pTemplate the template for the new key and the number of
1491      *         attributes in the template
1492      *         (PKCS#11 param: CK_ATTRIBUTE_PTR pTemplate, CK_ULONG ulCount)
1493      * @return the handle of the derived key
1494      *         (PKCS#11 param: CK_OBJECT_HANDLE_PTR phKey)
1495      * @exception PKCS11Exception If function returns other value than CKR_OK.
1496      * @preconditions
1497      * @postconditions
1498      */
1499     public native long C_DeriveKey(long hSession, CK_MECHANISM pMechanism,
1500             long hBaseKey, CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception;
1501 
1502 
1503 
1504 /* *****************************************************************************
1505  * Random number generation
1506  ******************************************************************************/
1507 
1508     /**
1509      * C_SeedRandom mixes additional seed material into the token&#39;s
1510      * random number generator.
1511      * (Random number generation)
1512      *
1513      * @param hSession the session&#39;s handle
1514      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1515      * @param pSeed the seed material and the seed material&#39;s length
1516      *         (PKCS#11 param: CK_BYTE_PTR pSeed, CK_ULONG ulSeedLen)
1517      * @exception PKCS11Exception If function returns other value than CKR_OK.
1518      * @preconditions (pSeed &lt;&gt; null)
1519      * @postconditions
1520      */
1521     public native void C_SeedRandom(long hSession, byte[] pSeed)
1522             throws PKCS11Exception;
1523 
1524 
1525     /**
1526      * C_GenerateRandom generates random data.
1527      * (Random number generation)
1528      *
1529      * @param hSession the session&#39;s handle
1530      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1531      * @param RandomData receives the random data and the length of RandomData
1532      *         is the length of random data to be generated
1533      *         (PKCS#11 param: CK_BYTE_PTR pRandomData, CK_ULONG ulRandomLen)
1534      * @exception PKCS11Exception If function returns other value than CKR_OK.
1535      * @preconditions (randomData &lt;&gt; null)
1536      * @postconditions
1537      */
1538     public native void C_GenerateRandom(long hSession, byte[] randomData)
1539             throws PKCS11Exception;
1540 
1541 
1542 
1543 /* *****************************************************************************
1544  * Parallel function management
1545  ******************************************************************************/
1546 
1547     /**
1548      * C_GetFunctionStatus is a legacy function; it obtains an
1549      * updated status of a function running in parallel with an
1550      * application.
1551      * (Parallel function management)
1552      *
1553      * @param hSession the session&#39;s handle
1554      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1555      * @exception PKCS11Exception If function returns other value than CKR_OK.
1556      * @preconditions
1557      * @postconditions
1558      */
1559 //    public native void C_GetFunctionStatus(long hSession)
1560 //            throws PKCS11Exception;
1561 
1562 
1563     /**
1564      * C_CancelFunction is a legacy function; it cancels a function
1565      * running in parallel.
1566      * (Parallel function management)
1567      *
1568      * @param hSession the session&#39;s handle
1569      *         (PKCS#11 param: CK_SESSION_HANDLE hSession)
1570      * @exception PKCS11Exception If function returns other value than CKR_OK.
1571      * @preconditions
1572      * @postconditions
1573      */
1574 //    public native void C_CancelFunction(long hSession) throws PKCS11Exception;
1575 
1576 
1577 
1578 /* *****************************************************************************
1579  * Functions added in for Cryptoki Version 2.01 or later
1580  ******************************************************************************/
1581 
1582     /**
1583      * C_WaitForSlotEvent waits for a slot event (token insertion,
1584      * removal, etc.) to occur.
1585      * (General-purpose)
1586      *
1587      * @param flags blocking/nonblocking flag
1588      *         (PKCS#11 param: CK_FLAGS flags)
1589      * @param pReserved reserved. Should be null
1590      *         (PKCS#11 param: CK_VOID_PTR pReserved)
1591      * @return the slot ID where the event occurred
1592      *         (PKCS#11 param: CK_SLOT_ID_PTR pSlot)
1593      * @exception PKCS11Exception If function returns other value than CKR_OK.
1594      * @preconditions (pRserved == null)
1595      * @postconditions
1596      */
1597 //    public native long C_WaitForSlotEvent(long flags, Object pRserved)
1598 //            throws PKCS11Exception;
1599 
1600     /**
1601      * Returns the string representation of this object.
1602      *
1603      * @return The string representation of object
1604      */
1605     public String toString() {
1606         return &quot;Module name: &quot; + pkcs11ModulePath;
1607     }
1608 
1609     /**
1610      * Calls disconnect() to cleanup the native part of the wrapper. Once this
1611      * method is called, this object cannot be used any longer. Any subsequent
1612      * call to a C_* method will result in a runtime exception.
1613      *
1614      * @exception Throwable If finalization fails.
1615      */
1616     @SuppressWarnings(&quot;deprecation&quot;)
1617     protected void finalize() throws Throwable {
1618         disconnect();
1619     }
1620 
1621 // PKCS11 subclass that has all methods synchronized and delegating to the
1622 // parent. Used for tokens that only support single threaded access
1623 static class SynchronizedPKCS11 extends PKCS11 {
1624 
1625     SynchronizedPKCS11(String pkcs11ModulePath, String functionListName)
1626             throws IOException {
1627         super(pkcs11ModulePath, functionListName);
1628     }
1629 
1630     synchronized void C_Initialize(Object pInitArgs) throws PKCS11Exception {
1631         super.C_Initialize(pInitArgs);
1632     }
1633 
1634     public synchronized void C_Finalize(Object pReserved)
1635             throws PKCS11Exception {
1636         super.C_Finalize(pReserved);
1637     }
1638 
1639     public synchronized CK_INFO C_GetInfo() throws PKCS11Exception {
1640         return super.C_GetInfo();
1641     }
1642 
1643     public synchronized long[] C_GetSlotList(boolean tokenPresent)
1644             throws PKCS11Exception {
1645         return super.C_GetSlotList(tokenPresent);
1646     }
1647 
1648     public synchronized CK_SLOT_INFO C_GetSlotInfo(long slotID)
1649             throws PKCS11Exception {
1650         return super.C_GetSlotInfo(slotID);
1651     }
1652 
1653     public synchronized CK_TOKEN_INFO C_GetTokenInfo(long slotID)
1654             throws PKCS11Exception {
1655         return super.C_GetTokenInfo(slotID);
1656     }
1657 
1658     public synchronized long[] C_GetMechanismList(long slotID)
1659             throws PKCS11Exception {
1660         return super.C_GetMechanismList(slotID);
1661     }
1662 
1663     public synchronized CK_MECHANISM_INFO C_GetMechanismInfo(long slotID,
1664             long type) throws PKCS11Exception {
1665         return super.C_GetMechanismInfo(slotID, type);
1666     }
1667 
1668     public synchronized long C_OpenSession(long slotID, long flags,
1669             Object pApplication, CK_NOTIFY Notify) throws PKCS11Exception {
1670         return super.C_OpenSession(slotID, flags, pApplication, Notify);
1671     }
1672 
1673     public synchronized void C_CloseSession(long hSession)
1674             throws PKCS11Exception {
1675         super.C_CloseSession(hSession);
1676     }
1677 
1678     public synchronized CK_SESSION_INFO C_GetSessionInfo(long hSession)
1679             throws PKCS11Exception {
1680         return super.C_GetSessionInfo(hSession);
1681     }
1682 
1683     public synchronized void C_Login(long hSession, long userType, char[] pPin)
1684             throws PKCS11Exception {
1685         super.C_Login(hSession, userType, pPin);
1686     }
1687 
1688     public synchronized void C_Logout(long hSession) throws PKCS11Exception {
1689         super.C_Logout(hSession);
1690     }
1691 
1692     public synchronized long C_CreateObject(long hSession,
1693             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception {
1694         return super.C_CreateObject(hSession, pTemplate);
1695     }
1696 
1697     public synchronized long C_CopyObject(long hSession, long hObject,
1698             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception {
1699         return super.C_CopyObject(hSession, hObject, pTemplate);
1700     }
1701 
1702     public synchronized void C_DestroyObject(long hSession, long hObject)
1703             throws PKCS11Exception {
1704         super.C_DestroyObject(hSession, hObject);
1705     }
1706 
1707     public synchronized void C_GetAttributeValue(long hSession, long hObject,
1708             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception {
1709         super.C_GetAttributeValue(hSession, hObject, pTemplate);
1710     }
1711 
1712     public synchronized void C_SetAttributeValue(long hSession, long hObject,
1713             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception {
1714         super.C_SetAttributeValue(hSession, hObject, pTemplate);
1715     }
1716 
1717     public synchronized void C_FindObjectsInit(long hSession,
1718             CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception {
1719         super.C_FindObjectsInit(hSession, pTemplate);
1720     }
1721 
1722     public synchronized long[] C_FindObjects(long hSession,
1723             long ulMaxObjectCount) throws PKCS11Exception {
1724         return super.C_FindObjects(hSession, ulMaxObjectCount);
1725     }
1726 
1727     public synchronized void C_FindObjectsFinal(long hSession)
1728             throws PKCS11Exception {
1729         super.C_FindObjectsFinal(hSession);
1730     }
1731 
1732     public synchronized void C_EncryptInit(long hSession,
1733             CK_MECHANISM pMechanism, long hKey) throws PKCS11Exception {
1734         super.C_EncryptInit(hSession, pMechanism, hKey);
1735     }
1736 
1737     public synchronized int C_Encrypt(long hSession, long directIn, byte[] in,
1738             int inOfs, int inLen, long directOut, byte[] out, int outOfs, int outLen)
1739             throws PKCS11Exception {
1740         return super.C_Encrypt(hSession, directIn, in, inOfs, inLen,
1741                 directOut, out, outOfs, outLen);
1742     }
1743 
1744     public synchronized int C_EncryptUpdate(long hSession, long directIn,
1745             byte[] in, int inOfs, int inLen, long directOut, byte[] out,
1746             int outOfs, int outLen) throws PKCS11Exception {
1747         return super.C_EncryptUpdate(hSession, directIn, in, inOfs, inLen,
1748                 directOut, out, outOfs, outLen);
1749     }
1750 
1751     public synchronized int C_EncryptFinal(long hSession, long directOut,
1752             byte[] out, int outOfs, int outLen) throws PKCS11Exception {
1753         return super.C_EncryptFinal(hSession, directOut, out, outOfs, outLen);
1754     }
1755 
1756     public synchronized void C_DecryptInit(long hSession,
1757             CK_MECHANISM pMechanism, long hKey) throws PKCS11Exception {
1758         super.C_DecryptInit(hSession, pMechanism, hKey);
1759     }
1760 
1761     public synchronized int C_Decrypt(long hSession, long directIn,
1762             byte[] in, int inOfs, int inLen, long directOut, byte[] out,
1763             int outOfs, int outLen) throws PKCS11Exception {
1764         return super.C_Decrypt(hSession, directIn, in, inOfs, inLen,
1765                 directOut, out, outOfs, outLen);
1766     }
1767 
1768     public synchronized int C_DecryptUpdate(long hSession, long directIn,
1769             byte[] in, int inOfs, int inLen, long directOut, byte[] out,
1770             int outOfs, int outLen) throws PKCS11Exception {
1771         return super.C_DecryptUpdate(hSession, directIn, in, inOfs, inLen,
1772                 directOut, out, outOfs, outLen);
1773     }
1774 
1775     public synchronized int C_DecryptFinal(long hSession, long directOut,
1776             byte[] out, int outOfs, int outLen) throws PKCS11Exception {
1777         return super.C_DecryptFinal(hSession, directOut, out, outOfs, outLen);
1778     }
1779 
1780     public synchronized void C_DigestInit(long hSession, CK_MECHANISM pMechanism)
1781             throws PKCS11Exception {
1782         super.C_DigestInit(hSession, pMechanism);
1783     }
1784 
1785     public synchronized int C_DigestSingle(long hSession,
1786             CK_MECHANISM pMechanism, byte[] in, int inOfs, int inLen,
1787             byte[] digest, int digestOfs, int digestLen) throws PKCS11Exception {
1788         return super.C_DigestSingle(hSession, pMechanism, in, inOfs, inLen,
1789                 digest, digestOfs, digestLen);
1790     }
1791 
1792     public synchronized void C_DigestUpdate(long hSession, long directIn,
1793             byte[] in, int inOfs, int inLen) throws PKCS11Exception {
1794         super.C_DigestUpdate(hSession, directIn, in, inOfs, inLen);
1795     }
1796 
1797     public synchronized void C_DigestKey(long hSession, long hKey)
1798             throws PKCS11Exception {
1799         super.C_DigestKey(hSession, hKey);
1800     }
1801 
1802     public synchronized int C_DigestFinal(long hSession, byte[] pDigest,
1803             int digestOfs, int digestLen) throws PKCS11Exception {
1804         return super.C_DigestFinal(hSession, pDigest, digestOfs, digestLen);
1805     }
1806 
1807     public synchronized void C_SignInit(long hSession, CK_MECHANISM pMechanism,
1808             long hKey) throws PKCS11Exception {
1809         super.C_SignInit(hSession, pMechanism, hKey);
1810     }
1811 
1812     public synchronized byte[] C_Sign(long hSession, byte[] pData)
1813             throws PKCS11Exception {
1814         return super.C_Sign(hSession, pData);
1815     }
1816 
1817     public synchronized void C_SignUpdate(long hSession, long directIn,
1818             byte[] in, int inOfs, int inLen) throws PKCS11Exception {
1819         super.C_SignUpdate(hSession, directIn, in, inOfs, inLen);
1820     }
1821 
1822     public synchronized byte[] C_SignFinal(long hSession, int expectedLen)
1823             throws PKCS11Exception {
1824         return super.C_SignFinal(hSession, expectedLen);
1825     }
1826 
1827     public synchronized void C_SignRecoverInit(long hSession,
1828             CK_MECHANISM pMechanism, long hKey) throws PKCS11Exception {
1829         super.C_SignRecoverInit(hSession, pMechanism, hKey);
1830     }
1831 
1832     public synchronized int C_SignRecover(long hSession, byte[] in, int inOfs,
1833             int inLen, byte[] out, int outOufs, int outLen)
1834             throws PKCS11Exception {
1835         return super.C_SignRecover(hSession, in, inOfs, inLen, out, outOufs,
1836                 outLen);
1837     }
1838 
1839     public synchronized void C_VerifyInit(long hSession, CK_MECHANISM pMechanism,
1840             long hKey) throws PKCS11Exception {
1841         super.C_VerifyInit(hSession, pMechanism, hKey);
1842     }
1843 
1844     public synchronized void C_Verify(long hSession, byte[] pData,
1845             byte[] pSignature) throws PKCS11Exception {
1846         super.C_Verify(hSession, pData, pSignature);
1847     }
1848 
1849     public synchronized void C_VerifyUpdate(long hSession, long directIn,
1850             byte[] in, int inOfs, int inLen) throws PKCS11Exception {
1851         super.C_VerifyUpdate(hSession, directIn, in, inOfs, inLen);
1852     }
1853 
1854     public synchronized void C_VerifyFinal(long hSession, byte[] pSignature)
1855             throws PKCS11Exception {
1856         super.C_VerifyFinal(hSession, pSignature);
1857     }
1858 
1859     public synchronized void C_VerifyRecoverInit(long hSession,
1860             CK_MECHANISM pMechanism, long hKey) throws PKCS11Exception {
1861         super.C_VerifyRecoverInit(hSession, pMechanism, hKey);
1862     }
1863 
1864     public synchronized int C_VerifyRecover(long hSession, byte[] in, int inOfs,
1865             int inLen, byte[] out, int outOufs, int outLen)
1866             throws PKCS11Exception {
1867         return super.C_VerifyRecover(hSession, in, inOfs, inLen, out, outOufs,
1868                 outLen);
1869     }
1870 
1871     public synchronized long C_GenerateKey(long hSession,
1872             CK_MECHANISM pMechanism, CK_ATTRIBUTE[] pTemplate)
1873             throws PKCS11Exception {
1874         return super.C_GenerateKey(hSession, pMechanism, pTemplate);
1875     }
1876 
1877     public synchronized long[] C_GenerateKeyPair(long hSession,
1878             CK_MECHANISM pMechanism, CK_ATTRIBUTE[] pPublicKeyTemplate,
1879             CK_ATTRIBUTE[] pPrivateKeyTemplate)
1880             throws PKCS11Exception {
1881         return super.C_GenerateKeyPair(hSession, pMechanism, pPublicKeyTemplate,
1882                 pPrivateKeyTemplate);
1883     }
1884 
1885     public synchronized byte[] C_WrapKey(long hSession, CK_MECHANISM pMechanism,
1886             long hWrappingKey, long hKey) throws PKCS11Exception {
1887         return super.C_WrapKey(hSession, pMechanism, hWrappingKey, hKey);
1888     }
1889 
1890     public synchronized long C_UnwrapKey(long hSession, CK_MECHANISM pMechanism,
1891             long hUnwrappingKey, byte[] pWrappedKey, CK_ATTRIBUTE[] pTemplate)
1892             throws PKCS11Exception {
1893         return super.C_UnwrapKey(hSession, pMechanism, hUnwrappingKey,
1894                 pWrappedKey, pTemplate);
1895     }
1896 
1897     public synchronized long C_DeriveKey(long hSession, CK_MECHANISM pMechanism,
1898     long hBaseKey, CK_ATTRIBUTE[] pTemplate) throws PKCS11Exception {
1899         return super.C_DeriveKey(hSession, pMechanism, hBaseKey, pTemplate);
1900     }
1901 
1902     public synchronized void C_SeedRandom(long hSession, byte[] pSeed)
1903             throws PKCS11Exception {
1904         super.C_SeedRandom(hSession, pSeed);
1905     }
1906 
1907     public synchronized void C_GenerateRandom(long hSession, byte[] randomData)
1908             throws PKCS11Exception {
1909         super.C_GenerateRandom(hSession, randomData);
1910     }
1911 }
1912 }
    </pre>
  </body>
</html>