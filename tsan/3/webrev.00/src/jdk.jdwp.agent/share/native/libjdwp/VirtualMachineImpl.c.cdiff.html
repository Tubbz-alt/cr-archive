<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.jdwp.agent/share/native/libjdwp/VirtualMachineImpl.c</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="ThreadReferenceImpl.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="VirtualMachineImpl.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.jdwp.agent/share/native/libjdwp/VirtualMachineImpl.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 1998, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 1998, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 33,21 ***</span>
  #include &quot;threadControl.h&quot;
  #include &quot;SDE.h&quot;
  #include &quot;FrameID.h&quot;
  
  static char *versionName = &quot;Java Debug Wire Protocol (Reference Implementation)&quot;;
<span class="line-removed">- static int majorVersion = 11;  /* JDWP major version */</span>
<span class="line-removed">- static int minorVersion = 0;  /* JDWP minor version */</span>
  
  static jboolean
  version(PacketInputStream *in, PacketOutputStream *out)
  {
      char buf[500];
      char *vmName;
      char *vmVersion;
      char *vmInfo;
  
      if (gdata-&gt;vmDead) {
          outStream_setError(out, JDWP_ERROR(VM_DEAD));
          return JNI_TRUE;
      }
  
<span class="line-new-header">--- 33,23 ---</span>
  #include &quot;threadControl.h&quot;
  #include &quot;SDE.h&quot;
  #include &quot;FrameID.h&quot;
  
  static char *versionName = &quot;Java Debug Wire Protocol (Reference Implementation)&quot;;
  
  static jboolean
  version(PacketInputStream *in, PacketOutputStream *out)
  {
      char buf[500];
      char *vmName;
      char *vmVersion;
      char *vmInfo;
  
<span class="line-added">+     /* Now the JDWP versions are the same as JVMTI versions */</span>
<span class="line-added">+     int majorVersion = jvmtiMajorVersion();</span>
<span class="line-added">+     int minorVersion = 0;</span>
<span class="line-added">+ </span>
      if (gdata-&gt;vmDead) {
          outStream_setError(out, JDWP_ERROR(VM_DEAD));
          return JNI_TRUE;
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 923,29 ***</span>
  {
      eventHelper_releaseEvents();
      return JNI_TRUE;
  }
  
<span class="line-modified">! void *VirtualMachine_Cmds[] = { (void *)22</span>
<span class="line-modified">!     ,(void *)version</span>
<span class="line-modified">!     ,(void *)classesForSignature</span>
<span class="line-modified">!     ,(void *)allClasses</span>
<span class="line-modified">!     ,(void *)getAllThreads</span>
<span class="line-modified">!     ,(void *)topLevelThreadGroups</span>
<span class="line-modified">!     ,(void *)dispose</span>
<span class="line-modified">!     ,(void *)idSizes</span>
<span class="line-modified">!     ,(void *)suspend</span>
<span class="line-modified">!     ,(void *)resume</span>
<span class="line-modified">!     ,(void *)doExit</span>
<span class="line-modified">!     ,(void *)createString</span>
<span class="line-modified">!     ,(void *)capabilities</span>
<span class="line-modified">!     ,(void *)classPaths</span>
<span class="line-modified">!     ,(void *)disposeObjects</span>
<span class="line-modified">!     ,(void *)holdEvents</span>
<span class="line-modified">!     ,(void *)releaseEvents</span>
<span class="line-modified">!     ,(void *)capabilitiesNew</span>
<span class="line-modified">!     ,(void *)redefineClasses</span>
<span class="line-modified">!     ,(void *)setDefaultStratum</span>
<span class="line-modified">!     ,(void *)allClassesWithGeneric</span>
<span class="line-modified">!     ,(void *)instanceCounts</span>
<span class="line-modified">!     ,(void *)allModules</span>
  };
<span class="line-new-header">--- 925,31 ---</span>
  {
      eventHelper_releaseEvents();
      return JNI_TRUE;
  }
  
<span class="line-modified">! Command VirtualMachine_Commands[] = {</span>
<span class="line-modified">!     {version, &quot;Version&quot;},</span>
<span class="line-modified">!     {classesForSignature, &quot;ClassesForSignature&quot;},</span>
<span class="line-modified">!     {allClasses, &quot;AllClasses&quot;},</span>
<span class="line-modified">!     {getAllThreads, &quot;GetAllThreads&quot;},</span>
<span class="line-modified">!     {topLevelThreadGroups, &quot;TopLevelThreadGroups&quot;},</span>
<span class="line-modified">!     {dispose, &quot;Dispose&quot;},</span>
<span class="line-modified">!     {idSizes, &quot;IDSizes&quot;},</span>
<span class="line-modified">!     {suspend, &quot;Suspend&quot;},</span>
<span class="line-modified">!     {resume, &quot;Resume&quot;},</span>
<span class="line-modified">!     {doExit, &quot;DoExit&quot;},</span>
<span class="line-modified">!     {createString, &quot;CreateString&quot;},</span>
<span class="line-modified">!     {capabilities, &quot;Capabilities&quot;},</span>
<span class="line-modified">!     {classPaths, &quot;ClassPaths&quot;},</span>
<span class="line-modified">!     {disposeObjects, &quot;DisposeObjects&quot;},</span>
<span class="line-modified">!     {holdEvents, &quot;HoldEvents&quot;},</span>
<span class="line-modified">!     {releaseEvents, &quot;ReleaseEvents&quot;},</span>
<span class="line-modified">!     {capabilitiesNew, &quot;CapabilitiesNew&quot;},</span>
<span class="line-modified">!     {redefineClasses, &quot;RedefineClasses&quot;},</span>
<span class="line-modified">!     {setDefaultStratum, &quot;SetDefaultStratum&quot;},</span>
<span class="line-modified">!     {allClassesWithGeneric, &quot;AllClassesWithGeneric&quot;},</span>
<span class="line-modified">!     {instanceCounts, &quot;InstanceCounts&quot;},</span>
<span class="line-modified">!     {allModules, &quot;AllModules&quot;}</span>
  };
<span class="line-added">+ </span>
<span class="line-added">+ DEBUG_DISPATCH_DEFINE_CMDSET(VirtualMachine)</span>
</pre>
<center><a href="ThreadReferenceImpl.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="VirtualMachineImpl.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>