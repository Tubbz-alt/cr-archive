diff a/src/jdk.attach/solaris/classes/sun/tools/attach/VirtualMachineImpl.java b/src/jdk.attach/solaris/classes/sun/tools/attach/VirtualMachineImpl.java
--- a/src/jdk.attach/solaris/classes/sun/tools/attach/VirtualMachineImpl.java
+++ b/src/jdk.attach/solaris/classes/sun/tools/attach/VirtualMachineImpl.java
@@ -58,12 +58,15 @@
         super(provider, vmid);
         // This provider only understands process-ids (pids).
         int pid;
         try {
             pid = Integer.parseInt(vmid);
+            if (pid < 1) {
+                throw new NumberFormatException();
+            }
         } catch (NumberFormatException x) {
-            throw new AttachNotSupportedException("Invalid process identifier");
+            throw new AttachNotSupportedException("Invalid process identifier: " + vmid);
         }
 
         // Opens the door file to the target VM. If the file is not
         // found it might mean that the attach mechanism isn't started in the
         // target VM so we attempt to start it and retry.
@@ -202,12 +205,16 @@
                 return 0;
 
             return VirtualMachineImpl.read(s, bs, off, len);
         }
 
-        public void close() throws IOException {
-            VirtualMachineImpl.close(s);
+        public synchronized void close() throws IOException {
+            if (s != -1) {
+                int toClose = s;
+                s = -1;
+                VirtualMachineImpl.close(toClose);
+            }
         }
     }
 
     // The door is attached to .java_pid<pid> in the temporary directory.
     private int openDoor(int pid) throws IOException {
