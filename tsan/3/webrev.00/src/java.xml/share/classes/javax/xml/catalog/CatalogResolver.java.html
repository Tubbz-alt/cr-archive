<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/java.xml/share/classes/javax/xml/catalog/CatalogResolver.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2015, 2017, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 package javax.xml.catalog;
 26 
 27 import java.io.InputStream;
 28 import javax.xml.stream.XMLResolver;
 29 import javax.xml.transform.Source;
 30 import javax.xml.transform.URIResolver;
 31 import org.w3c.dom.ls.LSInput;
 32 import org.w3c.dom.ls.LSResourceResolver;
 33 import org.xml.sax.EntityResolver;
 34 import org.xml.sax.InputSource;
 35 
 36 /**
 37  * A Catalog Resolver that implements SAX {@link org.xml.sax.EntityResolver},
 38  * StAX {@link javax.xml.stream.XMLResolver},
 39  * DOM LS {@link org.w3c.dom.ls.LSResourceResolver} used by Schema Validation, and
 40  * Transform {@link javax.xml.transform.URIResolver}, and resolves
 41  * external references using catalogs.
 42  * &lt;p&gt;
 43  * The &lt;a href=&quot;https://www.oasis-open.org/committees/download.php/14809/xml-catalogs.html&quot;&gt;
 44  * Catalog Standard&lt;/a&gt; distinguished {@code external identifiers} from {@code uri entries}
 45  * as being used to solely identify DTDs, while {@code uri entries} for
 46  * other resources such as stylesheets and schema. The Java APIs, such as
 47  * {@link javax.xml.stream.XMLResolver} and {@link org.w3c.dom.ls.LSResourceResolver}
 48  * however, make no such distinction.
 49  * In consistent with the existing Java API, this CatalogResolver recognizes a
 50  * system identifier as a URI and will search both {@code system} and {@code uri}
 51  * entries in a catalog in order to find a matching entry.
 52  * &lt;p&gt;
 53  * The search is started in the current catalog. If a match is found,
 54  * no further attempt will be made. Only if there is no match in the current
 55  * catalog, will alternate catalogs including delegate and next catalogs be considered.
 56  *
 57  * &lt;h2&gt;Search Order&lt;/h2&gt;
 58  * The resolver will first search the system-type of entries with the specified
 59  * {@code systemId}. The system entries include {@code system},
 60  * {@code rewriteSystem} and {@code systemSuffix} entries.
 61  * &lt;p&gt;
 62  * If no match is found, {@code public} entries may be searched in accordance with
 63  * the {@code prefer} attribute.
 64  * &lt;p&gt;
 65  * &lt;b&gt;The {@code prefer} attribute&lt;/b&gt;: if the {@code prefer} is public,
 66  * and there is no match found through the system entries, {@code public} entries
 67  * will be considered. If it is not specified, the {@code prefer} is public
 68  * by default (Note that by the OASIS standard, system entries will always
 69  * be considered before public entries. Prefer public means that public entries
 70  * will be matched when both system and public identifiers are specified.
 71  * In general therefore, prefer public is recommended.)
 72  * &lt;p&gt;
 73  * If no match is found with the {@code systemId} and {@code public} identifier,
 74  * the resolver will continue searching {@code uri} entries
 75  * with the specified {@code systemId} or {@code href}. The {@code uri} entries
 76  * include {@code uri}, {@code rewriteURI}, and {@code uriSuffix} entries.
 77  *
 78  * &lt;h2&gt;Error Handling&lt;/h2&gt;
 79  * The interfaces that the CatalogResolver extend specified checked exceptions, including:
 80  * &lt;ul&gt;
 81  * &lt;li&gt;
 82  * {@link org.xml.sax.SAXException} and {@link java.io.IOException} by
 83  * {@link org.xml.sax.EntityResolver#resolveEntity(java.lang.String, java.lang.String)}
 84  * &lt;/li&gt;
 85  * &lt;li&gt;
 86  * {@link javax.xml.stream.XMLStreamException} by
 87  * {@link javax.xml.stream.XMLResolver#resolveEntity(java.lang.String, java.lang.String, java.lang.String, java.lang.String)}
 88  * &lt;/li&gt;
 89  * &lt;li&gt;
 90  * {@link javax.xml.transform.TransformerException} by
 91  * {@link javax.xml.transform.URIResolver#resolve(java.lang.String, java.lang.String)}
 92  * &lt;/li&gt;
 93  * &lt;/ul&gt;
 94  * &lt;p&gt;
 95  * The CatalogResolver however, will throw {@link javax.xml.catalog.CatalogException}
 96  * only when {@code javax.xml.catalog.resolve} is specified as {@code strict}.
 97  * For applications that expect to handle the checked Exceptions, it may be
 98  * necessary to use a custom resolver to wrap the CatalogResolver or implement it
 99  * with a {@link javax.xml.catalog.Catalog} object.
100  *
101  * @since 9
102  */
103 public interface CatalogResolver extends EntityResolver, XMLResolver,
104         URIResolver, LSResourceResolver {
105 
106     /**
107      * Implements {@link org.xml.sax.EntityResolver}. The method searches through
108      * the catalog entries in the main and alternative catalogs to attempt to find
109      * a match with the specified {@code publicId} or systemId.
110      *
111      * @param publicId the public identifier of the external entity being
112      * referenced, or null if none was supplied
113      *
114      * @param systemId the system identifier of the external entity being
115      * referenced. A system identifier is required on all external entities. XML
116      * requires a system identifier on all external entities, so this value is
117      * always specified.
118      *
119      * @return a {@link org.xml.sax.InputSource} object if a mapping is found.
120      * If no mapping is found, returns a {@link org.xml.sax.InputSource} object
121      * containing an empty {@link java.io.Reader} if the
122      * {@code javax.xml.catalog.resolve} property is set to {@code ignore};
123      * returns null if the
124      * {@code javax.xml.catalog.resolve} property is set to {@code continue}.
125      *
126      * @throws CatalogException if no mapping is found and
127      * {@code javax.xml.catalog.resolve} is specified as {@code strict}
128      */
129     @Override
130     public InputSource resolveEntity(String publicId, String systemId);
131 
132 
133     /**
134      * Implements URIResolver. The method searches through the catalog entries
135      * in the main and alternative catalogs to attempt to find a match
136      * with the specified {@code href} attribute. The {@code href} attribute will
137      * be used literally, with no attempt to be made absolute to the {@code base}.
138      * &lt;p&gt;
139      * If the value is a URN, the {@code href} attribute is recognized as a
140      * {@code publicId}, and used to search {@code public} entries.
141      * If the value is a URI, it is taken as a {@code systemId}, and used to
142      * search both {@code system} and {@code uri} entries.
143      *
144      *
145      * @param href the href attribute that specifies the URI of a style sheet,
146      * which may be relative or absolute
147      * @param base The base URI against which the href attribute will be made
148      * absolute if the absolute URI is required
149      *
150      * @return a {@link javax.xml.transform.Source} object if a mapping is found.
151      * If no mapping is found, returns an empty {@link javax.xml.transform.Source}
152      * object if the {@code javax.xml.catalog.resolve} property is set to
153      * {@code ignore};
154      * returns a {@link javax.xml.transform.Source} object with the original URI
155      * (href, or href resolved with base if base is not null) if the
156      * {@code javax.xml.catalog.resolve} property is set to {@code continue}.
157      *
158      * @throws CatalogException if no mapping is found and
159      * {@code javax.xml.catalog.resolve} is specified as {@code strict}
160      */
161     @Override
162     public Source resolve(String href, String base);
163 
164     /**
165      * Implements {@link javax.xml.stream.XMLResolver}. For the purpose of resolving
166      * {@code publicId} and {@code systemId}, this method is equivalent to
167      * {@link #resolveEntity(java.lang.String, java.lang.String) }.
168      * &lt;p&gt;
169      * The {@code systemId} will be used literally, with no attempt to be made
170      * absolute to the {@code baseUri}. The {@code baseUri} and {@code namespace}
171      * are not used in the search for a match in a catalog. However, a relative
172      * {@code systemId} in an xml source may have been made absolute by the parser
173      * with the {@code baseURI}, thus making it unable to find a {@code system} entry.
174      * In such a case, a {@code systemSuffix} entry is recommended over a
175      * {@code system} entry.
176      *
177      * @param publicId the public identifier of the external entity being
178      * referenced, or null if none was supplied
179      *
180      * @param systemId the system identifier of the external entity being
181      * referenced. A system identifier is required on all external entities. XML
182      * requires a system identifier on all external entities, so this value is
183      * always specified.
184      * @param baseUri  the absolute base URI, not used by the CatalogResolver
185      * @param namespace the namespace of the entity to resolve, not used by the
186      * CatalogResolver.
187      *
188      * @return an {@link java.io.InputStream} object if a mapping is found; null
189      * if no mapping is found and the {@code javax.xml.catalog.resolve} property
190      * is set to {@code continue} or {@code ignore}. Note that for XMLResolver,
191      * it is not possible to ignore a reference, {@code ignore} is therefore
192      * treated the same as {@code continue}.
193      *
194      * @throws CatalogException if no mapping is found and
195      * {@code javax.xml.catalog.resolve} is specified as {@code strict}
196      */
197     @Override
198     public InputStream resolveEntity(String publicId, String systemId,
199             String baseUri, String namespace);
200 
201     /**
202      * Implements {@link org.w3c.dom.ls.LSResourceResolver}. For the purpose of
203      * resolving {@code publicId} and {@code systemId}, this method is equivalent
204      * to {@link #resolveEntity(java.lang.String, java.lang.String) }.
205      * &lt;p&gt;
206      * The {@code systemId} will be used literally, with no attempt to be made
207      * absolute to the {@code baseUri}. The {@code baseUri}, {@code namespaceUri}
208      * and {@code type} are not used in the search for a match in a catalog.
209      * However, a relative {@code systemId} in a source may have been made absolute
210      * by the parser with the {@code baseURI}, thus making it unable to find a
211      * {@code system} entry. In such a case, a {@code systemSuffix} entry is
212      * recommended over a {@code system} entry.
213      *
214      * @param type  the type of the resource being resolved,
215      * not used by the CatalogResolver
216      * @param namespaceUri  the namespace of the resource being resolved,
217      * not used by the CatalogResolver
218      * @param publicId  the public identifier of the external entity being
219      *   referenced, or {@code null} if no public identifier was
220      *   supplied or if the resource is not an entity.
221      * @param systemId  the system identifier, a URI reference of the
222      *   external resource being referenced
223      * @param baseUri  the absolute base URI, not used by the CatalogResolver
224      *
225      * @return a {@link org.w3c.dom.ls.LSInput} object if a mapping is found; null
226      * if no mapping is found and the {@code javax.xml.catalog.resolve} property
227      * is set to {@code continue} or {@code ignore}. Note that for
228      * {@link org.w3c.dom.ls.LSResourceResolver}, it is not possible to ignore a
229      * reference, {@code ignore} is therefore treated the same as {@code continue}.
230      *
231      * @throws CatalogException if no mapping is found and
232      * {@code javax.xml.catalog.resolve} is specified as {@code strict}
233      */
234     @Override
235     public LSInput resolveResource(String type, String namespaceUri,
236             String publicId, String systemId, String baseUri);
237 
238 }
    </pre>
  </body>
</html>