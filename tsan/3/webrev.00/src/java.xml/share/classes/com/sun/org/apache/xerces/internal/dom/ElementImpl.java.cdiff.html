<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.xml/share/classes/com/sun/org/apache/xerces/internal/dom/ElementImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DocumentTypeImpl.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="ElementNSImpl.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml/share/classes/com/sun/org/apache/xerces/internal/dom/ElementImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,8 ***</span>
  /*
<span class="line-modified">!  * reserved comment block</span>
<span class="line-removed">-  * DO NOT REMOVE OR ALTER!</span>
   */
  /*
   * Licensed to the Apache Software Foundation (ASF) under one or more
   * contributor license agreements.  See the NOTICE file distributed with
   * this work for additional information regarding copyright ownership.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2017, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   */
  /*
   * Licensed to the Apache Software Foundation (ASF) under one or more
   * contributor license agreements.  See the NOTICE file distributed with
   * this work for additional information regarding copyright ownership.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 53,51 ***</span>
   * @author Arnaud Le Hors, IBM
   * @author Joe Kesselman, IBM
   * @author Andy Clark, IBM
   * @author Ralf Pfeiffer, IBM
   * @since PR-DOM-Level-1-19980818.
   */
  public class ElementImpl
<span class="line-modified">!         extends ParentNode</span>
<span class="line-modified">!         implements Element, ElementTraversal, TypeInfo {</span>
  
      //
      // Constants
      //
<span class="line-modified">!     /**</span>
<span class="line-modified">!      * Serialization version.</span>
<span class="line-removed">-      */</span>
      static final long serialVersionUID = 3717253516652722278L;
      //
      // Data
      //
  
<span class="line-modified">!     /**</span>
<span class="line-removed">-      * Element name.</span>
<span class="line-removed">-      */</span>
      protected String name;
  
<span class="line-modified">!     /**</span>
<span class="line-removed">-      * Attributes.</span>
<span class="line-removed">-      */</span>
      protected AttributeMap attributes;
  
      //
      // Constructors
      //
<span class="line-modified">!     /**</span>
<span class="line-modified">!      * Factory constructor.</span>
<span class="line-removed">-      */</span>
      public ElementImpl(CoreDocumentImpl ownerDoc, String name) {
          super(ownerDoc);
          this.name = name;
          needsSyncData(true);    // synchronizeData will initialize attributes
      }
  
      // for ElementNSImpl
<span class="line-modified">!     protected ElementImpl() {</span>
<span class="line-removed">-     }</span>
  
      // Support for DOM Level 3 renameNode method.
      // Note: This only deals with part of the pb. CoreDocumentImpl
      // does all the work.
      void rename(String name) {
<span class="line-new-header">--- 52,45 ---</span>
   * @author Arnaud Le Hors, IBM
   * @author Joe Kesselman, IBM
   * @author Andy Clark, IBM
   * @author Ralf Pfeiffer, IBM
   * @since PR-DOM-Level-1-19980818.
<span class="line-added">+  * @LastModified: Apr 2019</span>
   */
  public class ElementImpl
<span class="line-modified">!     extends ParentNode</span>
<span class="line-modified">!     implements Element, ElementTraversal, TypeInfo {</span>
  
      //
      // Constants
      //
<span class="line-modified">! </span>
<span class="line-modified">!     /** Serialization version. */</span>
      static final long serialVersionUID = 3717253516652722278L;
      //
      // Data
      //
  
<span class="line-modified">!     /** Element name. */</span>
      protected String name;
  
<span class="line-modified">!     /** Attributes. */</span>
      protected AttributeMap attributes;
  
      //
      // Constructors
      //
<span class="line-modified">! </span>
<span class="line-modified">!     /** Factory constructor. */</span>
      public ElementImpl(CoreDocumentImpl ownerDoc, String name) {
          super(ownerDoc);
          this.name = name;
          needsSyncData(true);    // synchronizeData will initialize attributes
      }
  
      // for ElementNSImpl
<span class="line-modified">!     protected ElementImpl() {}</span>
  
      // Support for DOM Level 3 renameNode method.
      // Note: This only deals with part of the pb. CoreDocumentImpl
      // does all the work.
      void rename(String name) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 107,13 ***</span>
          if (ownerDocument.errorChecking) {
              int colon1 = name.indexOf(&#39;:&#39;);
              if (colon1 != -1) {
                  String msg
                          = DOMMessageFormatter.formatMessage(
<span class="line-modified">!                                 DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-modified">!                                 &quot;NAMESPACE_ERR&quot;,</span>
<span class="line-modified">!                                 null);</span>
                  throw new DOMException(DOMException.NAMESPACE_ERR, msg);
              }
              if (!CoreDocumentImpl.isXMLName(name, ownerDocument.isXML11Version())) {
                  String msg = DOMMessageFormatter.formatMessage(
                          DOMMessageFormatter.DOM_DOMAIN,
<span class="line-new-header">--- 100,13 ---</span>
          if (ownerDocument.errorChecking) {
              int colon1 = name.indexOf(&#39;:&#39;);
              if (colon1 != -1) {
                  String msg
                          = DOMMessageFormatter.formatMessage(
<span class="line-modified">!                             DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-modified">!                             &quot;NAMESPACE_ERR&quot;,</span>
<span class="line-modified">!                             null);</span>
                  throw new DOMException(DOMException.NAMESPACE_ERR, msg);
              }
              if (!CoreDocumentImpl.isXMLName(name, ownerDocument.isXML11Version())) {
                  String msg = DOMMessageFormatter.formatMessage(
                          DOMMessageFormatter.DOM_DOMAIN,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 285,11 ***</span>
              synchronizeData();
          }
          if (attributes == null) {
              return &quot;&quot;;
          }
<span class="line-modified">!         Attr attr = (Attr) (attributes.getNamedItem(name));</span>
          return (attr == null) ? &quot;&quot; : attr.getValue();
  
      } // getAttribute(String):String
  
      /**
<span class="line-new-header">--- 278,11 ---</span>
              synchronizeData();
          }
          if (attributes == null) {
              return &quot;&quot;;
          }
<span class="line-modified">!         Attr attr = (Attr)(attributes.getNamedItem(name));</span>
          return (attr == null) ? &quot;&quot; : attr.getValue();
  
      } // getAttribute(String):String
  
      /**
</pre>
<hr />
<pre>
<span class="line-old-header">*** 305,11 ***</span>
              synchronizeData();
          }
          if (attributes == null) {
              return null;
          }
<span class="line-modified">!         return (Attr) attributes.getNamedItem(name);</span>
  
      } // getAttributeNode(String):Attr
  
      /**
       * Returns a NodeList of all descendent nodes (children, grandchildren, and
<span class="line-new-header">--- 298,11 ---</span>
              synchronizeData();
          }
          if (attributes == null) {
              return null;
          }
<span class="line-modified">!         return (Attr)attributes.getNamedItem(name);</span>
  
      } // getAttributeNode(String):Attr
  
      /**
       * Returns a NodeList of all descendent nodes (children, grandchildren, and
</pre>
<hr />
<pre>
<span class="line-old-header">*** 451,11 ***</span>
       * this Element.
       * @throws DOMException(NO_MODIFICATION_ALLOWED_ERR) if the node is
       * readonly.
       */
      public Attr removeAttributeNode(Attr oldAttr)
<span class="line-modified">!             throws DOMException {</span>
  
          if (ownerDocument.errorChecking &amp;&amp; isReadOnly()) {
              String msg = DOMMessageFormatter.formatMessage(DOMMessageFormatter.DOM_DOMAIN, &quot;NO_MODIFICATION_ALLOWED_ERR&quot;, null);
              throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR, msg);
          }
<span class="line-new-header">--- 444,11 ---</span>
       * this Element.
       * @throws DOMException(NO_MODIFICATION_ALLOWED_ERR) if the node is
       * readonly.
       */
      public Attr removeAttributeNode(Attr oldAttr)
<span class="line-modified">!         throws DOMException {</span>
  
          if (ownerDocument.errorChecking &amp;&amp; isReadOnly()) {
              String msg = DOMMessageFormatter.formatMessage(DOMMessageFormatter.DOM_DOMAIN, &quot;NO_MODIFICATION_ALLOWED_ERR&quot;, null);
              throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR, msg);
          }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 489,40 ***</span>
       * (Attribute factory will do that test for us.)
       *
       * @throws DOMException(NO_MODIFICATION_ALLOWED_ERR) if the node is
       * readonly.
       */
<span class="line-modified">!     public void setAttribute(String name, String value) {</span>
<span class="line-modified">! </span>
<span class="line-modified">!         if (ownerDocument.errorChecking &amp;&amp; isReadOnly()) {</span>
<span class="line-modified">!             String msg</span>
<span class="line-modified">!                     = DOMMessageFormatter.formatMessage(</span>
<span class="line-modified">!                             DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-modified">!                             &quot;NO_MODIFICATION_ALLOWED_ERR&quot;,</span>
<span class="line-modified">!                             null);</span>
<span class="line-modified">!             throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR, msg);</span>
<span class="line-removed">-         }</span>
  
<span class="line-modified">!         if (needsSyncData()) {</span>
<span class="line-modified">!             synchronizeData();</span>
<span class="line-modified">!         }</span>
  
<span class="line-modified">!         Attr newAttr = getAttributeNode(name);</span>
<span class="line-modified">!         if (newAttr == null) {</span>
<span class="line-modified">!             newAttr = getOwnerDocument().createAttribute(name);</span>
  
<span class="line-modified">!             if (attributes == null) {</span>
<span class="line-modified">!                 attributes = new AttributeMap(this, null);</span>
<span class="line-modified">!             }</span>
  
<span class="line-modified">!             newAttr.setNodeValue(value);</span>
<span class="line-modified">!             attributes.setNamedItem(newAttr);</span>
<span class="line-modified">!         } else {</span>
<span class="line-modified">!             newAttr.setNodeValue(value);</span>
<span class="line-modified">!         }</span>
  
<span class="line-modified">!     } // setAttribute(String,String)</span>
  
      /**
       * Add a new attribute/value pair, or replace the value of the existing
       * attribute with that name.
       * &lt;P&gt;
<span class="line-new-header">--- 482,39 ---</span>
       * (Attribute factory will do that test for us.)
       *
       * @throws DOMException(NO_MODIFICATION_ALLOWED_ERR) if the node is
       * readonly.
       */
<span class="line-modified">!         public void setAttribute(String name, String value) {</span>
<span class="line-modified">! </span>
<span class="line-modified">!                 if (ownerDocument.errorChecking &amp;&amp; isReadOnly()) {</span>
<span class="line-modified">!                     String msg = DOMMessageFormatter.formatMessage(</span>
<span class="line-modified">!                                         DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-modified">!                                         &quot;NO_MODIFICATION_ALLOWED_ERR&quot;,</span>
<span class="line-modified">!                                         null);</span>
<span class="line-modified">!                     throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR, msg);</span>
<span class="line-modified">!                 }</span>
  
<span class="line-modified">!                 if (needsSyncData()) {</span>
<span class="line-modified">!                         synchronizeData();</span>
<span class="line-modified">!                 }</span>
  
<span class="line-modified">!                 Attr newAttr = getAttributeNode(name);</span>
<span class="line-modified">!                 if (newAttr == null) {</span>
<span class="line-modified">!                         newAttr = getOwnerDocument().createAttribute(name);</span>
  
<span class="line-modified">!                         if (attributes == null) {</span>
<span class="line-modified">!                                 attributes = new AttributeMap(this, null);</span>
<span class="line-modified">!                         }</span>
  
<span class="line-modified">!                         newAttr.setNodeValue(value);</span>
<span class="line-modified">!                         attributes.setNamedItem(newAttr);</span>
<span class="line-modified">!                 } else {</span>
<span class="line-modified">!                         newAttr.setNodeValue(value);</span>
<span class="line-modified">!                 }</span>
  
<span class="line-modified">!         } // setAttribute(String,String)</span>
  
      /**
       * Add a new attribute/value pair, or replace the value of the existing
       * attribute with that name.
       * &lt;P&gt;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 544,17 ***</span>
  
          if (ownerDocument.errorChecking) {
              if (isReadOnly()) {
                  String msg = DOMMessageFormatter.formatMessage(DOMMessageFormatter.DOM_DOMAIN, &quot;NO_MODIFICATION_ALLOWED_ERR&quot;, null);
                  throw new DOMException(
<span class="line-modified">!                         DOMException.NO_MODIFICATION_ALLOWED_ERR,</span>
<span class="line-modified">!                         msg);</span>
              }
  
              if (newAttr.getOwnerDocument() != ownerDocument) {
                  String msg = DOMMessageFormatter.formatMessage(DOMMessageFormatter.DOM_DOMAIN, &quot;WRONG_DOCUMENT_ERR&quot;, null);
<span class="line-modified">!                 throw new DOMException(DOMException.WRONG_DOCUMENT_ERR, msg);</span>
              }
          }
  
          if (attributes == null) {
              attributes = new AttributeMap(this, null);
<span class="line-new-header">--- 536,17 ---</span>
  
          if (ownerDocument.errorChecking) {
              if (isReadOnly()) {
                  String msg = DOMMessageFormatter.formatMessage(DOMMessageFormatter.DOM_DOMAIN, &quot;NO_MODIFICATION_ALLOWED_ERR&quot;, null);
                  throw new DOMException(
<span class="line-modified">!                                      DOMException.NO_MODIFICATION_ALLOWED_ERR,</span>
<span class="line-modified">!                                      msg);</span>
              }
  
              if (newAttr.getOwnerDocument() != ownerDocument) {
                  String msg = DOMMessageFormatter.formatMessage(DOMMessageFormatter.DOM_DOMAIN, &quot;WRONG_DOCUMENT_ERR&quot;, null);
<span class="line-modified">!                     throw new DOMException(DOMException.WRONG_DOCUMENT_ERR, msg);</span>
              }
          }
  
          if (attributes == null) {
              attributes = new AttributeMap(this, null);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 587,11 ***</span>
  
          if (attributes == null) {
              return &quot;&quot;;
          }
  
<span class="line-modified">!         Attr attr = (Attr) (attributes.getNamedItemNS(namespaceURI, localName));</span>
          return (attr == null) ? &quot;&quot; : attr.getValue();
  
      } // getAttributeNS(String,String):String
  
      /**
<span class="line-new-header">--- 579,11 ---</span>
  
          if (attributes == null) {
              return &quot;&quot;;
          }
  
<span class="line-modified">!         Attr attr = (Attr)(attributes.getNamedItemNS(namespaceURI, localName));</span>
          return (attr == null) ? &quot;&quot; : attr.getValue();
  
      } // getAttributeNS(String,String):String
  
      /**
</pre>
<hr />
<pre>
<span class="line-old-header">*** 631,45 ***</span>
       * string, or if if the qualifiedName has a prefix different from &quot;xml&quot; and
       * &quot;xmlns&quot; and the namespaceURI is null or an empty string.
       * @since WD-DOM-Level-2-19990923
       */
      public void setAttributeNS(String namespaceURI, String qualifiedName,
<span class="line-modified">!             String value) {</span>
<span class="line-modified">!         if (ownerDocument.errorChecking &amp;&amp; isReadOnly()) {</span>
<span class="line-modified">!             String msg</span>
<span class="line-modified">!                     = DOMMessageFormatter.formatMessage(</span>
<span class="line-modified">!                             DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-modified">!                             &quot;NO_MODIFICATION_ALLOWED_ERR&quot;,</span>
<span class="line-modified">!                             null);</span>
<span class="line-modified">!             throw new DOMException(</span>
<span class="line-modified">!                     DOMException.NO_MODIFICATION_ALLOWED_ERR,</span>
<span class="line-modified">!                     msg);</span>
<span class="line-modified">!         }</span>
<span class="line-modified">!         if (needsSyncData()) {</span>
<span class="line-modified">!             synchronizeData();</span>
<span class="line-modified">!         }</span>
<span class="line-modified">!         int index = qualifiedName.indexOf(&#39;:&#39;);</span>
<span class="line-modified">!         String prefix, localName;</span>
<span class="line-modified">!         if (index &lt; 0) {</span>
<span class="line-modified">!             prefix = null;</span>
<span class="line-modified">!             localName = qualifiedName;</span>
<span class="line-modified">!         } else {</span>
<span class="line-modified">!             prefix = qualifiedName.substring(0, index);</span>
<span class="line-modified">!             localName = qualifiedName.substring(index + 1);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         Attr newAttr = getAttributeNodeNS(namespaceURI, localName);</span>
<span class="line-removed">-         if (newAttr == null) {</span>
              // REVISIT: this is not efficient, we are creating twice the same
              //          strings for prefix and localName.
<span class="line-modified">!             newAttr = getOwnerDocument().createAttributeNS(</span>
<span class="line-modified">!                     namespaceURI,</span>
<span class="line-modified">!                     qualifiedName);</span>
<span class="line-modified">!             if (attributes == null) {</span>
<span class="line-modified">!                 attributes = new AttributeMap(this, null);</span>
<span class="line-modified">!             }</span>
<span class="line-modified">!             newAttr.setNodeValue(value);</span>
<span class="line-modified">!             attributes.setNamedItemNS(newAttr);</span>
                  }
                  else {
              if (newAttr instanceof AttrNSImpl){
                  String origNodeName = ((AttrNSImpl) newAttr).name;
                  String newName = (prefix!=null) ? (prefix+&quot;:&quot;+localName) : localName;
<span class="line-new-header">--- 623,42 ---</span>
       * string, or if if the qualifiedName has a prefix different from &quot;xml&quot; and
       * &quot;xmlns&quot; and the namespaceURI is null or an empty string.
       * @since WD-DOM-Level-2-19990923
       */
      public void setAttributeNS(String namespaceURI, String qualifiedName,
<span class="line-modified">!                                           String value) {</span>
<span class="line-modified">!                 if (ownerDocument.errorChecking &amp;&amp; isReadOnly()) {</span>
<span class="line-modified">!                     String msg = DOMMessageFormatter.formatMessage(</span>
<span class="line-modified">!                                         DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-modified">!                                         &quot;NO_MODIFICATION_ALLOWED_ERR&quot;,</span>
<span class="line-modified">!                                         null);</span>
<span class="line-modified">!                     throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR, msg);</span>
<span class="line-modified">!                 }</span>
<span class="line-modified">!                 if (needsSyncData()) {</span>
<span class="line-modified">!                         synchronizeData();</span>
<span class="line-modified">!                 }</span>
<span class="line-modified">!                 int index = qualifiedName.indexOf(&#39;:&#39;);</span>
<span class="line-modified">!                 String prefix, localName;</span>
<span class="line-modified">!                 if (index &lt; 0) {</span>
<span class="line-modified">!                         prefix = null;</span>
<span class="line-modified">!                         localName = qualifiedName;</span>
<span class="line-modified">!                 } else {</span>
<span class="line-modified">!                         prefix = qualifiedName.substring(0, index);</span>
<span class="line-modified">!                         localName = qualifiedName.substring(index + 1);</span>
<span class="line-modified">!                 }</span>
<span class="line-modified">!                 Attr newAttr = getAttributeNodeNS(namespaceURI, localName);</span>
<span class="line-modified">!                 if (newAttr == null) {</span>
              // REVISIT: this is not efficient, we are creating twice the same
              //          strings for prefix and localName.
<span class="line-modified">!                         newAttr = getOwnerDocument().createAttributeNS(</span>
<span class="line-modified">!                                         namespaceURI,</span>
<span class="line-modified">!                                         qualifiedName);</span>
<span class="line-modified">!                         if (attributes == null) {</span>
<span class="line-modified">!                                 attributes = new AttributeMap(this, null);</span>
<span class="line-modified">!                         }</span>
<span class="line-modified">!                         newAttr.setNodeValue(value);</span>
<span class="line-modified">!                         attributes.setNamedItemNS(newAttr);</span>
                  }
                  else {
              if (newAttr instanceof AttrNSImpl){
                  String origNodeName = ((AttrNSImpl) newAttr).name;
                  String newName = (prefix!=null) ? (prefix+&quot;:&quot;+localName) : localName;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 691,16 ***</span>
                  //      elem.setAttribute(&quot;name&quot;, &quot;value&quot;);
                  //      elem.setAttributeNS(null, &quot;name&quot;, &quot;value&quot;);
                  // This case is not defined by the DOM spec, we choose
                  // to create a new attribute in this case and remove an old one from the tree
                  // note this might cause events to be propagated or user data to be lost
<span class="line-modified">!                 newAttr = new AttrNSImpl((CoreDocumentImpl)getOwnerDocument(), namespaceURI, qualifiedName, localName);</span>
                  attributes.setNamedItemNS(newAttr);
              }
  
<span class="line-modified">!             newAttr.setNodeValue(value);</span>
<span class="line-modified">!         }</span>
  
      } // setAttributeNS(String,String,String)
  
      /**
       * Introduced in DOM Level 2.
<span class="line-new-header">--- 680,16 ---</span>
                  //      elem.setAttribute(&quot;name&quot;, &quot;value&quot;);
                  //      elem.setAttributeNS(null, &quot;name&quot;, &quot;value&quot;);
                  // This case is not defined by the DOM spec, we choose
                  // to create a new attribute in this case and remove an old one from the tree
                  // note this might cause events to be propagated or user data to be lost
<span class="line-modified">!                 newAttr = ((CoreDocumentImpl)getOwnerDocument()).createAttributeNS(namespaceURI, qualifiedName, localName);</span>
                  attributes.setNamedItemNS(newAttr);
              }
  
<span class="line-modified">!                         newAttr.setNodeValue(value);</span>
<span class="line-modified">!                 }</span>
  
      } // setAttributeNS(String,String,String)
  
      /**
       * Introduced in DOM Level 2.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 751,11 ***</span>
              synchronizeData();
          }
          if (attributes == null) {
              return null;
          }
<span class="line-modified">!         return (Attr) attributes.getNamedItemNS(namespaceURI, localName);</span>
  
      } // getAttributeNodeNS(String,String):Attr
  
      /**
       * Introduced in DOM Level 2.
<span class="line-new-header">--- 740,11 ---</span>
              synchronizeData();
          }
          if (attributes == null) {
              return null;
          }
<span class="line-modified">!         return (Attr)attributes.getNamedItemNS(namespaceURI, localName);</span>
  
      } // getAttributeNodeNS(String,String):Attr
  
      /**
       * Introduced in DOM Level 2.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 786,13 ***</span>
              synchronizeData();
          }
          if (ownerDocument.errorChecking) {
              if (isReadOnly()) {
                  String msg = DOMMessageFormatter.formatMessage(DOMMessageFormatter.DOM_DOMAIN, &quot;NO_MODIFICATION_ALLOWED_ERR&quot;, null);
<span class="line-modified">!                 throw new DOMException(</span>
<span class="line-modified">!                         DOMException.NO_MODIFICATION_ALLOWED_ERR,</span>
<span class="line-modified">!                         msg);</span>
              }
              if (newAttr.getOwnerDocument() != ownerDocument) {
                  String msg = DOMMessageFormatter.formatMessage(DOMMessageFormatter.DOM_DOMAIN, &quot;WRONG_DOCUMENT_ERR&quot;, null);
                  throw new DOMException(DOMException.WRONG_DOCUMENT_ERR, msg);
              }
<span class="line-new-header">--- 775,13 ---</span>
              synchronizeData();
          }
          if (ownerDocument.errorChecking) {
              if (isReadOnly()) {
                  String msg = DOMMessageFormatter.formatMessage(DOMMessageFormatter.DOM_DOMAIN, &quot;NO_MODIFICATION_ALLOWED_ERR&quot;, null);
<span class="line-modified">!                     throw new DOMException(</span>
<span class="line-modified">!                                      DOMException.NO_MODIFICATION_ALLOWED_ERR,</span>
<span class="line-modified">!                                      msg);</span>
              }
              if (newAttr.getOwnerDocument() != ownerDocument) {
                  String msg = DOMMessageFormatter.formatMessage(DOMMessageFormatter.DOM_DOMAIN, &quot;WRONG_DOCUMENT_ERR&quot;, null);
                  throw new DOMException(DOMException.WRONG_DOCUMENT_ERR, msg);
              }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 805,12 ***</span>
          return (Attr) attributes.setNamedItemNS(newAttr);
  
      } // setAttributeNodeNS(Attr):Attr
  
      /**
<span class="line-modified">!      * NON-DOM: sets attribute node for this element</span>
<span class="line-modified">!      */</span>
      protected int setXercesAttributeNode(Attr attr) {
  
          if (needsSyncData()) {
              synchronizeData();
          }
<span class="line-new-header">--- 794,12 ---</span>
          return (Attr) attributes.setNamedItemNS(newAttr);
  
      } // setAttributeNodeNS(Attr):Attr
  
      /**
<span class="line-modified">!       * NON-DOM: sets attribute node for this element</span>
<span class="line-modified">!       */</span>
      protected int setXercesAttributeNode(Attr attr) {
  
          if (needsSyncData()) {
              synchronizeData();
          }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 821,12 ***</span>
          return attributes.addItem(attr);
  
      }
  
      /**
<span class="line-modified">!      * NON-DOM: get inded of an attribute</span>
<span class="line-modified">!      */</span>
      protected int getXercesAttribute(String namespaceURI, String localName) {
  
          if (needsSyncData()) {
              synchronizeData();
          }
<span class="line-new-header">--- 810,12 ---</span>
          return attributes.addItem(attr);
  
      }
  
      /**
<span class="line-modified">!       * NON-DOM: get inded of an attribute</span>
<span class="line-modified">!       */</span>
      protected int getXercesAttribute(String namespaceURI, String localName) {
  
          if (needsSyncData()) {
              synchronizeData();
          }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 877,11 ***</span>
       * @return NodeList A new NodeList object containing all the matched
       * Elements.
       * @since WD-DOM-Level-2-19990923
       */
      public NodeList getElementsByTagNameNS(String namespaceURI,
<span class="line-modified">!             String localName) {</span>
          return new DeepNodeListImpl(this, namespaceURI, localName);
      }
  
      /**
       * DOM Level 3 WD- Experimental. Override inherited behavior from NodeImpl
<span class="line-new-header">--- 866,11 ---</span>
       * @return NodeList A new NodeList object containing all the matched
       * Elements.
       * @since WD-DOM-Level-2-19990923
       */
      public NodeList getElementsByTagNameNS(String namespaceURI,
<span class="line-modified">!                                            String localName) {</span>
          return new DeepNodeListImpl(this, namespaceURI, localName);
      }
  
      /**
       * DOM Level 3 WD- Experimental. Override inherited behavior from NodeImpl
</pre>
<hr />
<pre>
<span class="line-old-header">*** 909,11 ***</span>
                      if (n2 == null || !((NodeImpl) n1).isEqualNode(n2)) {
                          return false;
                      }
                  } else {
                      Node n2 = map2.getNamedItemNS(n1.getNamespaceURI(),
<span class="line-modified">!                             n1.getLocalName());</span>
                      if (n2 == null || !((NodeImpl) n1).isEqualNode(n2)) {
                          return false;
                      }
                  }
              }
<span class="line-new-header">--- 898,11 ---</span>
                      if (n2 == null || !((NodeImpl) n1).isEqualNode(n2)) {
                          return false;
                      }
                  } else {
                      Node n2 = map2.getNamedItemNS(n1.getNamespaceURI(),
<span class="line-modified">!                                                   n1.getLocalName());</span>
                      if (n2 == null || !((NodeImpl) n1).isEqualNode(n2)) {
                          return false;
                      }
                  }
              }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 928,18 ***</span>
          if (needsSyncData()) {
              synchronizeData();
          }
          if (ownerDocument.errorChecking) {
              if (isReadOnly()) {
<span class="line-modified">!                 String msg = DOMMessageFormatter.formatMessage(DOMMessageFormatter.DOM_DOMAIN, &quot;NO_MODIFICATION_ALLOWED_ERR&quot;, null);</span>
                  throw new DOMException(
<span class="line-modified">!                         DOMException.NO_MODIFICATION_ALLOWED_ERR,</span>
<span class="line-removed">-                         msg);</span>
              }
  
              if (at.getOwnerElement() != this) {
<span class="line-modified">!                 String msg = DOMMessageFormatter.formatMessage(DOMMessageFormatter.DOM_DOMAIN, &quot;NOT_FOUND_ERR&quot;, null);</span>
                  throw new DOMException(DOMException.NOT_FOUND_ERR, msg);
              }
          }
          ((AttrImpl) at).isIdAttribute(makeId);
          if (!makeId) {
<span class="line-new-header">--- 917,19 ---</span>
          if (needsSyncData()) {
              synchronizeData();
          }
          if (ownerDocument.errorChecking) {
              if (isReadOnly()) {
<span class="line-modified">!                 String msg = DOMMessageFormatter.formatMessage(</span>
<span class="line-added">+                         DOMMessageFormatter.DOM_DOMAIN, &quot;NO_MODIFICATION_ALLOWED_ERR&quot;, null);</span>
                  throw new DOMException(
<span class="line-modified">!                         DOMException.NO_MODIFICATION_ALLOWED_ERR, msg);</span>
              }
  
              if (at.getOwnerElement() != this) {
<span class="line-modified">!                 String msg = DOMMessageFormatter.formatMessage(</span>
<span class="line-added">+                         DOMMessageFormatter.DOM_DOMAIN, &quot;NOT_FOUND_ERR&quot;, null);</span>
                  throw new DOMException(DOMException.NOT_FOUND_ERR, msg);
              }
          }
          ((AttrImpl) at).isIdAttribute(makeId);
          if (!makeId) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 957,26 ***</span>
              synchronizeData();
          }
          Attr at = getAttributeNode(name);
  
          if (at == null) {
<span class="line-modified">!             String msg = DOMMessageFormatter.formatMessage(</span>
<span class="line-modified">!                     DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-removed">-                     &quot;NOT_FOUND_ERR&quot;, null);</span>
              throw new DOMException(DOMException.NOT_FOUND_ERR, msg);
<span class="line-modified">!         }</span>
  
          if (ownerDocument.errorChecking) {
              if (isReadOnly()) {
<span class="line-modified">!                 String msg = DOMMessageFormatter.formatMessage(DOMMessageFormatter.DOM_DOMAIN, &quot;NO_MODIFICATION_ALLOWED_ERR&quot;, null);</span>
<span class="line-modified">!                 throw new DOMException(</span>
<span class="line-modified">!                         DOMException.NO_MODIFICATION_ALLOWED_ERR,</span>
<span class="line-removed">-                         msg);</span>
              }
  
              if (at.getOwnerElement() != this) {
<span class="line-modified">!                 String msg = DOMMessageFormatter.formatMessage(DOMMessageFormatter.DOM_DOMAIN, &quot;NOT_FOUND_ERR&quot;, null);</span>
                  throw new DOMException(DOMException.NOT_FOUND_ERR, msg);
              }
          }
  
          ((AttrImpl) at).isIdAttribute(makeId);
<span class="line-new-header">--- 947,25 ---</span>
              synchronizeData();
          }
          Attr at = getAttributeNode(name);
  
          if (at == null) {
<span class="line-modified">!                 String msg = DOMMessageFormatter.formatMessage(</span>
<span class="line-modified">!                         DOMMessageFormatter.DOM_DOMAIN, &quot;NOT_FOUND_ERR&quot;, null);</span>
              throw new DOMException(DOMException.NOT_FOUND_ERR, msg);
<span class="line-modified">!                 }</span>
  
          if (ownerDocument.errorChecking) {
              if (isReadOnly()) {
<span class="line-modified">!                 String msg = DOMMessageFormatter.formatMessage(</span>
<span class="line-modified">!                         DOMMessageFormatter.DOM_DOMAIN, &quot;NO_MODIFICATION_ALLOWED_ERR&quot;, null);</span>
<span class="line-modified">!                 throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR, msg);</span>
              }
  
              if (at.getOwnerElement() != this) {
<span class="line-modified">!                 String msg = DOMMessageFormatter.formatMessage(</span>
<span class="line-added">+                         DOMMessageFormatter.DOM_DOMAIN, &quot;NOT_FOUND_ERR&quot;, null);</span>
                  throw new DOMException(DOMException.NOT_FOUND_ERR, msg);
              }
          }
  
          ((AttrImpl) at).isIdAttribute(makeId);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 989,34 ***</span>
  
      /**
       * DOM Level 3: register the given attribute node as an ID attribute
       */
      public void setIdAttributeNS(String namespaceURI, String localName,
<span class="line-modified">!             boolean makeId) {</span>
          if (needsSyncData()) {
              synchronizeData();
          }
          //if namespace uri is empty string, set it to &#39;null&#39;
          if (namespaceURI != null) {
              namespaceURI = (namespaceURI.length() == 0) ? null : namespaceURI;
          }
          Attr at = getAttributeNodeNS(namespaceURI, localName);
  
          if (at == null) {
<span class="line-modified">!             String msg = DOMMessageFormatter.formatMessage(</span>
<span class="line-modified">!                     DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-removed">-                     &quot;NOT_FOUND_ERR&quot;, null);</span>
              throw new DOMException(DOMException.NOT_FOUND_ERR, msg);
<span class="line-modified">!         }</span>
  
<span class="line-modified">!         if (ownerDocument.errorChecking) {</span>
              if (isReadOnly()) {
                  String msg = DOMMessageFormatter.formatMessage(
                          DOMMessageFormatter.DOM_DOMAIN, &quot;NO_MODIFICATION_ALLOWED_ERR&quot;, null);
                  throw new DOMException(
<span class="line-modified">!                         DOMException.NO_MODIFICATION_ALLOWED_ERR,</span>
<span class="line-modified">!                         msg);</span>
              }
  
              if (at.getOwnerElement() != this) {
                  String msg = DOMMessageFormatter.formatMessage(
                          DOMMessageFormatter.DOM_DOMAIN, &quot;NOT_FOUND_ERR&quot;, null);
<span class="line-new-header">--- 978,33 ---</span>
  
      /**
       * DOM Level 3: register the given attribute node as an ID attribute
       */
      public void setIdAttributeNS(String namespaceURI, String localName,
<span class="line-modified">!                                     boolean makeId) {</span>
          if (needsSyncData()) {
              synchronizeData();
          }
          //if namespace uri is empty string, set it to &#39;null&#39;
          if (namespaceURI != null) {
              namespaceURI = (namespaceURI.length() == 0) ? null : namespaceURI;
          }
          Attr at = getAttributeNodeNS(namespaceURI, localName);
  
          if (at == null) {
<span class="line-modified">!                 String msg = DOMMessageFormatter.formatMessage(</span>
<span class="line-modified">!                         DOMMessageFormatter.DOM_DOMAIN, &quot;NOT_FOUND_ERR&quot;, null);</span>
              throw new DOMException(DOMException.NOT_FOUND_ERR, msg);
<span class="line-modified">!                 }</span>
  
<span class="line-modified">!                 if (ownerDocument.errorChecking) {</span>
              if (isReadOnly()) {
                  String msg = DOMMessageFormatter.formatMessage(
                          DOMMessageFormatter.DOM_DOMAIN, &quot;NO_MODIFICATION_ALLOWED_ERR&quot;, null);
                  throw new DOMException(
<span class="line-modified">!                                      DOMException.NO_MODIFICATION_ALLOWED_ERR,</span>
<span class="line-modified">!                                      msg);</span>
              }
  
              if (at.getOwnerElement() != this) {
                  String msg = DOMMessageFormatter.formatMessage(
                          DOMMessageFormatter.DOM_DOMAIN, &quot;NOT_FOUND_ERR&quot;, null);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1027,18 ***</span>
          if (!makeId) {
              ownerDocument.removeIdentifier(at.getValue());
          } else {
              ownerDocument.putIdentifier(at.getValue(), this);
          }
<span class="line-modified">!     }</span>
  
      /**
       * @see org.w3c.dom.TypeInfo#getTypeName()
       */
<span class="line-modified">!     public String getTypeName() {</span>
          return null;
<span class="line-modified">!     }</span>
  
      /**
       * @see org.w3c.dom.TypeInfo#getTypeNamespace()
       */
      public String getTypeNamespace() {
<span class="line-new-header">--- 1015,18 ---</span>
          if (!makeId) {
              ownerDocument.removeIdentifier(at.getValue());
          } else {
              ownerDocument.putIdentifier(at.getValue(), this);
          }
<span class="line-modified">!    }</span>
  
      /**
       * @see org.w3c.dom.TypeInfo#getTypeName()
       */
<span class="line-modified">!      public String getTypeName() {</span>
          return null;
<span class="line-modified">!      }</span>
  
      /**
       * @see org.w3c.dom.TypeInfo#getTypeNamespace()
       */
      public String getTypeNamespace() {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1057,21 ***</span>
       *
       * @return boolean True if the type is derived by restriction for the
       * reference type
       */
      public boolean isDerivedFrom(String typeNamespaceArg,
<span class="line-modified">!             String typeNameArg,</span>
<span class="line-modified">!             int derivationMethod) {</span>
  
          return false;
      }
  
<span class="line-modified">!     /**</span>
<span class="line-modified">!      * Method getSchemaTypeInfo.</span>
<span class="line-modified">!      *</span>
<span class="line-modified">!      * @return TypeInfo</span>
<span class="line-removed">-      */</span>
      public TypeInfo getSchemaTypeInfo() {
          if (needsSyncData()) {
              synchronizeData();
          }
          return this;
<span class="line-new-header">--- 1045,20 ---</span>
       *
       * @return boolean True if the type is derived by restriction for the
       * reference type
       */
      public boolean isDerivedFrom(String typeNamespaceArg,
<span class="line-modified">!                                  String typeNameArg,</span>
<span class="line-modified">!                                  int derivationMethod) {</span>
  
          return false;
      }
  
<span class="line-modified">!         /**</span>
<span class="line-modified">!          * Method getSchemaTypeInfo.</span>
<span class="line-modified">!          * @return TypeInfo</span>
<span class="line-modified">!          */</span>
      public TypeInfo getSchemaTypeInfo() {
          if (needsSyncData()) {
              synchronizeData();
          }
          return this;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1157,12 ***</span>
          DocumentTypeImpl doctype
                  = (DocumentTypeImpl) ownerDocument.getDoctype();
          if (doctype == null) {
              return null;
          }
<span class="line-modified">!         ElementDefinitionImpl eldef</span>
<span class="line-removed">-                 = (ElementDefinitionImpl) doctype.getElements()</span>
                  .getNamedItem(getNodeName());
          if (eldef == null) {
              return null;
          }
          return (NamedNodeMapImpl) eldef.getAttributes();
<span class="line-new-header">--- 1144,11 ---</span>
          DocumentTypeImpl doctype
                  = (DocumentTypeImpl) ownerDocument.getDoctype();
          if (doctype == null) {
              return null;
          }
<span class="line-modified">!         ElementDefinitionImpl eldef = (ElementDefinitionImpl)doctype.getElements()</span>
                  .getNamedItem(getNodeName());
          if (eldef == null) {
              return null;
          }
          return (NamedNodeMapImpl) eldef.getAttributes();
</pre>
<center><a href="DocumentTypeImpl.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="ElementNSImpl.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>