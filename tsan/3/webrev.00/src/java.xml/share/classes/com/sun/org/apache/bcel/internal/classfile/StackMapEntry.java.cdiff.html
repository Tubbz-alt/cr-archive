<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.xml/share/classes/com/sun/org/apache/bcel/internal/classfile/StackMapEntry.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="StackMap.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="StackMapType.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml/share/classes/com/sun/org/apache/bcel/internal/classfile/StackMapEntry.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 29,11 ***</span>
  /**
   * This class represents a stack map entry recording the types of
   * local variables and the the of stack items at a given byte code offset.
   * See CLDC specification 5.3.1.2
   *
<span class="line-removed">-  * @version $Id: StackMapEntry.java 1750029 2016-06-23 22:14:38Z sebb $</span>
   * @see     StackMap
   * @see     StackMapType
   */
  public final class StackMapEntry implements Node, Cloneable
  {
<span class="line-new-header">--- 29,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 49,102 ***</span>
       * Construct object from input stream.
       *
       * @param input Input stream
       * @throws IOException
       */
<span class="line-modified">!     StackMapEntry(final DataInput input, final ConstantPool constant_pool) throws IOException {</span>
<span class="line-modified">!         this(input.readByte() &amp; 0xFF, -1, null, null, constant_pool);</span>
  
          if (frame_type &gt;= Const.SAME_FRAME &amp;&amp; frame_type &lt;= Const.SAME_FRAME_MAX) {
              byte_code_offset = frame_type - Const.SAME_FRAME;
          } else if (frame_type &gt;= Const.SAME_LOCALS_1_STACK_ITEM_FRAME &amp;&amp;
                     frame_type &lt;= Const.SAME_LOCALS_1_STACK_ITEM_FRAME_MAX) {
              byte_code_offset = frame_type - Const.SAME_LOCALS_1_STACK_ITEM_FRAME;
              types_of_stack_items = new StackMapType[1];
<span class="line-modified">!             types_of_stack_items[0] = new StackMapType(input, constant_pool);</span>
          } else if (frame_type == Const.SAME_LOCALS_1_STACK_ITEM_FRAME_EXTENDED) {
              byte_code_offset = input.readShort();
              types_of_stack_items = new StackMapType[1];
<span class="line-modified">!             types_of_stack_items[0] = new StackMapType(input, constant_pool);</span>
          } else if (frame_type &gt;= Const.CHOP_FRAME &amp;&amp; frame_type &lt;= Const.CHOP_FRAME_MAX) {
              byte_code_offset = input.readShort();
          } else if (frame_type == Const.SAME_FRAME_EXTENDED) {
              byte_code_offset = input.readShort();
          } else if (frame_type &gt;= Const.APPEND_FRAME &amp;&amp; frame_type &lt;= Const.APPEND_FRAME_MAX) {
              byte_code_offset = input.readShort();
              final int number_of_locals = frame_type - 251;
              types_of_locals = new StackMapType[number_of_locals];
              for (int i = 0; i &lt; number_of_locals; i++) {
<span class="line-modified">!                 types_of_locals[i] = new StackMapType(input, constant_pool);</span>
              }
          } else if (frame_type == Const.FULL_FRAME) {
              byte_code_offset = input.readShort();
              final int number_of_locals = input.readShort();
              types_of_locals = new StackMapType[number_of_locals];
              for (int i = 0; i &lt; number_of_locals; i++) {
<span class="line-modified">!                 types_of_locals[i] = new StackMapType(input, constant_pool);</span>
              }
              final int number_of_stack_items = input.readShort();
              types_of_stack_items = new StackMapType[number_of_stack_items];
              for (int i = 0; i &lt; number_of_stack_items; i++) {
<span class="line-modified">!                 types_of_stack_items[i] = new StackMapType(input, constant_pool);</span>
              }
          } else {
              /* Can&#39;t happen */
              throw new ClassFormatException (&quot;Invalid frame type found while parsing stack map table: &quot; + frame_type);
          }
      }
  
      /**
       * DO NOT USE
       *
<span class="line-modified">!      * @param byte_code_offset</span>
<span class="line-modified">!      * @param number_of_locals NOT USED</span>
<span class="line-modified">!      * @param types_of_locals array of {@link StackMapType}s of locals</span>
<span class="line-modified">!      * @param number_of_stack_items NOT USED</span>
<span class="line-modified">!      * @param types_of_stack_items array ot {@link StackMapType}s of stack items</span>
<span class="line-modified">!      * @param constant_pool the constant pool</span>
       * @deprecated Since 6.0, use {@link #StackMapEntry(int, int, StackMapType[], StackMapType[], ConstantPool)}
       * instead
       */
      @java.lang.Deprecated
<span class="line-modified">!     public StackMapEntry(final int byte_code_offset, final int number_of_locals,</span>
<span class="line-modified">!             final StackMapType[] types_of_locals, final int number_of_stack_items,</span>
<span class="line-modified">!             final StackMapType[] types_of_stack_items, final ConstantPool constant_pool) {</span>
<span class="line-modified">!         this.byte_code_offset = byte_code_offset;</span>
<span class="line-modified">!         this.types_of_locals = types_of_locals != null ? types_of_locals : new StackMapType[0];</span>
<span class="line-modified">!         this.types_of_stack_items = types_of_stack_items != null ? types_of_stack_items : new StackMapType[0];</span>
<span class="line-modified">!         this.constant_pool = constant_pool;</span>
      }
  
      /**
       * Create an instance
       *
       * @param tag the frame_type to use
<span class="line-modified">!      * @param byte_code_offset</span>
<span class="line-modified">!      * @param types_of_locals array of {@link StackMapType}s of locals</span>
<span class="line-modified">!      * @param types_of_stack_items array ot {@link StackMapType}s of stack items</span>
<span class="line-modified">!      * @param constant_pool the constant pool</span>
       */
<span class="line-modified">!     public StackMapEntry(final int tag, final int byte_code_offset,</span>
<span class="line-modified">!             final StackMapType[] types_of_locals,</span>
<span class="line-modified">!             final StackMapType[] types_of_stack_items, final ConstantPool constant_pool) {</span>
          this.frame_type = tag;
<span class="line-modified">!         this.byte_code_offset = byte_code_offset;</span>
<span class="line-modified">!         this.types_of_locals = types_of_locals != null ? types_of_locals : new StackMapType[0];</span>
<span class="line-modified">!         this.types_of_stack_items = types_of_stack_items != null ? types_of_stack_items : new StackMapType[0];</span>
<span class="line-modified">!         this.constant_pool = constant_pool;</span>
      }
  
  
      /**
       * Dump stack map entry
       *
       * @param file Output file stream
       * @throws IOException
       */
<span class="line-modified">!     public final void dump( final DataOutputStream file ) throws IOException {</span>
          file.write(frame_type);
          if (frame_type &gt;= Const.SAME_FRAME &amp;&amp; frame_type &lt;= Const.SAME_FRAME_MAX) {
              // nothing to be done
          } else if (frame_type &gt;= Const.SAME_LOCALS_1_STACK_ITEM_FRAME &amp;&amp;
                     frame_type &lt;= Const.SAME_LOCALS_1_STACK_ITEM_FRAME_MAX) {
<span class="line-new-header">--- 48,102 ---</span>
       * Construct object from input stream.
       *
       * @param input Input stream
       * @throws IOException
       */
<span class="line-modified">!     StackMapEntry(final DataInput input, final ConstantPool constantPool) throws IOException {</span>
<span class="line-modified">!         this(input.readByte() &amp; 0xFF, -1, null, null, constantPool);</span>
  
          if (frame_type &gt;= Const.SAME_FRAME &amp;&amp; frame_type &lt;= Const.SAME_FRAME_MAX) {
              byte_code_offset = frame_type - Const.SAME_FRAME;
          } else if (frame_type &gt;= Const.SAME_LOCALS_1_STACK_ITEM_FRAME &amp;&amp;
                     frame_type &lt;= Const.SAME_LOCALS_1_STACK_ITEM_FRAME_MAX) {
              byte_code_offset = frame_type - Const.SAME_LOCALS_1_STACK_ITEM_FRAME;
              types_of_stack_items = new StackMapType[1];
<span class="line-modified">!             types_of_stack_items[0] = new StackMapType(input, constantPool);</span>
          } else if (frame_type == Const.SAME_LOCALS_1_STACK_ITEM_FRAME_EXTENDED) {
              byte_code_offset = input.readShort();
              types_of_stack_items = new StackMapType[1];
<span class="line-modified">!             types_of_stack_items[0] = new StackMapType(input, constantPool);</span>
          } else if (frame_type &gt;= Const.CHOP_FRAME &amp;&amp; frame_type &lt;= Const.CHOP_FRAME_MAX) {
              byte_code_offset = input.readShort();
          } else if (frame_type == Const.SAME_FRAME_EXTENDED) {
              byte_code_offset = input.readShort();
          } else if (frame_type &gt;= Const.APPEND_FRAME &amp;&amp; frame_type &lt;= Const.APPEND_FRAME_MAX) {
              byte_code_offset = input.readShort();
              final int number_of_locals = frame_type - 251;
              types_of_locals = new StackMapType[number_of_locals];
              for (int i = 0; i &lt; number_of_locals; i++) {
<span class="line-modified">!                 types_of_locals[i] = new StackMapType(input, constantPool);</span>
              }
          } else if (frame_type == Const.FULL_FRAME) {
              byte_code_offset = input.readShort();
              final int number_of_locals = input.readShort();
              types_of_locals = new StackMapType[number_of_locals];
              for (int i = 0; i &lt; number_of_locals; i++) {
<span class="line-modified">!                 types_of_locals[i] = new StackMapType(input, constantPool);</span>
              }
              final int number_of_stack_items = input.readShort();
              types_of_stack_items = new StackMapType[number_of_stack_items];
              for (int i = 0; i &lt; number_of_stack_items; i++) {
<span class="line-modified">!                 types_of_stack_items[i] = new StackMapType(input, constantPool);</span>
              }
          } else {
              /* Can&#39;t happen */
              throw new ClassFormatException (&quot;Invalid frame type found while parsing stack map table: &quot; + frame_type);
          }
      }
  
      /**
       * DO NOT USE
       *
<span class="line-modified">!      * @param byteCodeOffset</span>
<span class="line-modified">!      * @param numberOfLocals NOT USED</span>
<span class="line-modified">!      * @param typesOfLocals array of {@link StackMapType}s of locals</span>
<span class="line-modified">!      * @param numberOfStackItems NOT USED</span>
<span class="line-modified">!      * @param typesOfStackItems array ot {@link StackMapType}s of stack items</span>
<span class="line-modified">!      * @param constantPool the constant pool</span>
       * @deprecated Since 6.0, use {@link #StackMapEntry(int, int, StackMapType[], StackMapType[], ConstantPool)}
       * instead
       */
      @java.lang.Deprecated
<span class="line-modified">!     public StackMapEntry(final int byteCodeOffset, final int numberOfLocals,</span>
<span class="line-modified">!             final StackMapType[] typesOfLocals, final int numberOfStackItems,</span>
<span class="line-modified">!             final StackMapType[] typesOfStackItems, final ConstantPool constantPool) {</span>
<span class="line-modified">!         this.byte_code_offset = byteCodeOffset;</span>
<span class="line-modified">!         this.types_of_locals = typesOfLocals != null ? typesOfLocals : new StackMapType[0];</span>
<span class="line-modified">!         this.types_of_stack_items = typesOfStackItems != null ? typesOfStackItems : new StackMapType[0];</span>
<span class="line-modified">!         this.constant_pool = constantPool;</span>
      }
  
      /**
       * Create an instance
       *
       * @param tag the frame_type to use
<span class="line-modified">!      * @param byteCodeOffset</span>
<span class="line-modified">!      * @param typesOfLocals array of {@link StackMapType}s of locals</span>
<span class="line-modified">!      * @param typesOfStackItems array ot {@link StackMapType}s of stack items</span>
<span class="line-modified">!      * @param constantPool the constant pool</span>
       */
<span class="line-modified">!     public StackMapEntry(final int tag, final int byteCodeOffset,</span>
<span class="line-modified">!             final StackMapType[] typesOfLocals,</span>
<span class="line-modified">!             final StackMapType[] typesOfStackItems, final ConstantPool constantPool) {</span>
          this.frame_type = tag;
<span class="line-modified">!         this.byte_code_offset = byteCodeOffset;</span>
<span class="line-modified">!         this.types_of_locals = typesOfLocals != null ? typesOfLocals : new StackMapType[0];</span>
<span class="line-modified">!         this.types_of_stack_items = typesOfStackItems != null ? typesOfStackItems : new StackMapType[0];</span>
<span class="line-modified">!         this.constant_pool = constantPool;</span>
      }
  
  
      /**
       * Dump stack map entry
       *
       * @param file Output file stream
       * @throws IOException
       */
<span class="line-modified">!     public void dump( final DataOutputStream file ) throws IOException {</span>
          file.write(frame_type);
          if (frame_type &gt;= Const.SAME_FRAME &amp;&amp; frame_type &lt;= Const.SAME_FRAME_MAX) {
              // nothing to be done
          } else if (frame_type &gt;= Const.SAME_LOCALS_1_STACK_ITEM_FRAME &amp;&amp;
                     frame_type &lt;= Const.SAME_LOCALS_1_STACK_ITEM_FRAME_MAX) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 180,11 ***</span>
  
      /**
       * @return String representation.
       */
      @Override
<span class="line-modified">!     public final String toString() {</span>
          final StringBuilder buf = new StringBuilder(64);
          buf.append(&quot;(&quot;);
          if (frame_type &gt;= Const.SAME_FRAME &amp;&amp; frame_type &lt;= Const.SAME_FRAME_MAX) {
              buf.append(&quot;SAME&quot;);
          } else if (frame_type &gt;= Const.SAME_LOCALS_1_STACK_ITEM_FRAME &amp;&amp;
<span class="line-new-header">--- 179,11 ---</span>
  
      /**
       * @return String representation.
       */
      @Override
<span class="line-modified">!     public String toString() {</span>
          final StringBuilder buf = new StringBuilder(64);
          buf.append(&quot;(&quot;);
          if (frame_type &gt;= Const.SAME_FRAME &amp;&amp; frame_type &lt;= Const.SAME_FRAME_MAX) {
              buf.append(&quot;SAME&quot;);
          } else if (frame_type &gt;= Const.SAME_LOCALS_1_STACK_ITEM_FRAME &amp;&amp;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 424,17 ***</span>
  
  
      /**
       * @return Constant pool used by this object.
       */
<span class="line-modified">!     public final ConstantPool getConstantPool() {</span>
          return constant_pool;
      }
  
  
      /**
       * @param constant_pool Constant pool to be used for this object.
       */
<span class="line-modified">!     public final void setConstantPool( final ConstantPool constant_pool ) {</span>
          this.constant_pool = constant_pool;
      }
  }
<span class="line-new-header">--- 423,17 ---</span>
  
  
      /**
       * @return Constant pool used by this object.
       */
<span class="line-modified">!     public ConstantPool getConstantPool() {</span>
          return constant_pool;
      }
  
  
      /**
       * @param constant_pool Constant pool to be used for this object.
       */
<span class="line-modified">!     public void setConstantPool( final ConstantPool constant_pool ) {</span>
          this.constant_pool = constant_pool;
      }
  }
</pre>
<center><a href="StackMap.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="StackMapType.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>