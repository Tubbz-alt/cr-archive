<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.xml/share/classes/com/sun/org/apache/bcel/internal/classfile/DescendingVisitor.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (c) 2013, 2017, Oracle and/or its affiliates. All rights reserved.
  3  */
  4 /*
  5  * Licensed to the Apache Software Foundation (ASF) under one or more
  6  * contributor license agreements.  See the NOTICE file distributed with
  7  * this work for additional information regarding copyright ownership.
  8  * The ASF licenses this file to You under the Apache License, Version 2.0
  9  * (the &quot;License&quot;); you may not use this file except in compliance with
 10  * the License.  You may obtain a copy of the License at
 11  *
 12  *      http://www.apache.org/licenses/LICENSE-2.0
 13  *
 14  * Unless required by applicable law or agreed to in writing, software
 15  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 16  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 17  * See the License for the specific language governing permissions and
 18  * limitations under the License.
 19  */
 20 package com.sun.org.apache.bcel.internal.classfile;
 21 
 22 import java.util.Stack;
 23 
 24 /**
 25  * Traverses a JavaClass with another Visitor object &#39;piggy-backed&#39; that is
 26  * applied to all components of a JavaClass object. I.e. this class supplies the
 27  * traversal strategy, other classes can make use of it.
 28  *
<a name="1" id="anc1"></a><span class="line-removed"> 29  * @version $Id: DescendingVisitor.java 1749603 2016-06-21 20:50:19Z ggregory $</span>
 30  */
<a name="2" id="anc2"></a><span class="line-modified"> 31 public class DescendingVisitor implements Visitor {</span>
<span class="line-modified"> 32 </span>
 33     private final JavaClass clazz;
 34 
 35     private final Visitor visitor;
 36 
 37     private final Stack&lt;Object&gt; stack = new Stack&lt;&gt;();
 38 
 39     /**
 40      * @return container of current entitity, i.e., predecessor during traversal
 41      */
<a name="3" id="anc3"></a><span class="line-modified"> 42     public Object predecessor() {</span>

 43         return predecessor(0);
 44     }
 45 
 46     /**
<a name="4" id="anc4"></a><span class="line-modified"> 47      * @param level nesting level, i.e., 0 returns the direct predecessor</span>

 48      * @return container of current entitity, i.e., predecessor during traversal
 49      */
<a name="5" id="anc5"></a><span class="line-modified"> 50     public Object predecessor(final int level) {</span>

 51         final int size = stack.size();
<a name="6" id="anc6"></a><span class="line-modified"> 52         if ((size &lt; 2) || (level &lt; 0)) {</span>

 53             return null;
 54         }
 55         return stack.elementAt(size - (level + 2)); // size - 1 == current
 56     }
 57 
 58     /**
 59      * @return current object
 60      */
<a name="7" id="anc7"></a><span class="line-modified"> 61     public Object current() {</span>

 62         return stack.peek();
 63     }
 64 
 65     /**
<a name="8" id="anc8"></a><span class="line-modified"> 66      * @param clazz Class to traverse</span>
<span class="line-modified"> 67      * @param visitor visitor object to apply to all components</span>


 68      */
<a name="9" id="anc9"></a><span class="line-modified"> 69     public DescendingVisitor(final JavaClass clazz, final Visitor visitor) {</span>

 70         this.clazz = clazz;
 71         this.visitor = visitor;
 72     }
 73 
 74     /**
 75      * Start traversal.
 76      */
<a name="10" id="anc10"></a><span class="line-modified"> 77     public void visit() {</span>

 78         clazz.accept(this);
 79     }
 80 
 81     @Override
<a name="11" id="anc11"></a><span class="line-modified"> 82     public void visitJavaClass(final JavaClass _clazz) {</span>

 83         stack.push(_clazz);
 84         _clazz.accept(visitor);
 85         final Field[] fields = _clazz.getFields();
 86         for (final Field field : fields) {
 87             field.accept(this);
 88         }
 89         final Method[] methods = _clazz.getMethods();
 90         for (final Method method : methods) {
 91             method.accept(this);
 92         }
 93         final Attribute[] attributes = _clazz.getAttributes();
 94         for (final Attribute attribute : attributes) {
 95             attribute.accept(this);
 96         }
 97         _clazz.getConstantPool().accept(this);
 98         stack.pop();
 99     }
100 
101     /**
102      * @since 6.0
103      */
104     @Override
<a name="12" id="anc12"></a><span class="line-modified">105     public void visitAnnotation(final Annotations annotation) {</span>

106         stack.push(annotation);
107         annotation.accept(visitor);
108         final AnnotationEntry[] entries = annotation.getAnnotationEntries();
109         for (final AnnotationEntry entrie : entries) {
110             entrie.accept(this);
111         }
112         stack.pop();
113     }
114 
115     /**
116      * @since 6.0
117      */
118     @Override
<a name="13" id="anc13"></a><span class="line-modified">119     public void visitAnnotationEntry(final AnnotationEntry annotationEntry) {</span>

120         stack.push(annotationEntry);
121         annotationEntry.accept(visitor);
122         stack.pop();
123     }
124 
125     @Override
<a name="14" id="anc14"></a><span class="line-modified">126     public void visitField(final Field field) {</span>

127         stack.push(field);
128         field.accept(visitor);
129         final Attribute[] attributes = field.getAttributes();
130         for (final Attribute attribute : attributes) {
131             attribute.accept(this);
132         }
133         stack.pop();
134     }
135 
136     @Override
<a name="15" id="anc15"></a><span class="line-modified">137     public void visitConstantValue(final ConstantValue cv) {</span>

138         stack.push(cv);
139         cv.accept(visitor);
140         stack.pop();
141     }
142 
143     @Override
<a name="16" id="anc16"></a><span class="line-modified">144     public void visitMethod(final Method method) {</span>

145         stack.push(method);
146         method.accept(visitor);
147         final Attribute[] attributes = method.getAttributes();
148         for (final Attribute attribute : attributes) {
149             attribute.accept(this);
150         }
151         stack.pop();
152     }
153 
154     @Override
<a name="17" id="anc17"></a><span class="line-modified">155     public void visitExceptionTable(final ExceptionTable table) {</span>

156         stack.push(table);
157         table.accept(visitor);
158         stack.pop();
159     }
160 
161     @Override
<a name="18" id="anc18"></a><span class="line-modified">162     public void visitCode(final Code code) {</span>

163         stack.push(code);
164         code.accept(visitor);
165         final CodeException[] table = code.getExceptionTable();
166         for (final CodeException element : table) {
167             element.accept(this);
168         }
169         final Attribute[] attributes = code.getAttributes();
170         for (final Attribute attribute : attributes) {
171             attribute.accept(this);
172         }
173         stack.pop();
174     }
175 
176     @Override
<a name="19" id="anc19"></a><span class="line-modified">177     public void visitCodeException(final CodeException ce) {</span>

178         stack.push(ce);
179         ce.accept(visitor);
180         stack.pop();
181     }
182 
183     @Override
<a name="20" id="anc20"></a><span class="line-modified">184     public void visitLineNumberTable(final LineNumberTable table) {</span>

185         stack.push(table);
186         table.accept(visitor);
187         final LineNumber[] numbers = table.getLineNumberTable();
188         for (final LineNumber number : numbers) {
189             number.accept(this);
190         }
191         stack.pop();
192     }
193 
194     @Override
<a name="21" id="anc21"></a><span class="line-modified">195     public void visitLineNumber(final LineNumber number) {</span>

196         stack.push(number);
197         number.accept(visitor);
198         stack.pop();
199     }
200 
201     @Override
<a name="22" id="anc22"></a><span class="line-modified">202     public void visitLocalVariableTable(final LocalVariableTable table) {</span>

203         stack.push(table);
204         table.accept(visitor);
205         final LocalVariable[] vars = table.getLocalVariableTable();
206         for (final LocalVariable var : vars) {
207             var.accept(this);
208         }
209         stack.pop();
210     }
211 
212     @Override
<a name="23" id="anc23"></a><span class="line-modified">213     public void visitStackMap(final StackMap table) {</span>

214         stack.push(table);
215         table.accept(visitor);
216         final StackMapEntry[] vars = table.getStackMap();
217         for (final StackMapEntry var : vars) {
218             var.accept(this);
219         }
220         stack.pop();
221     }
222 
223     @Override
<a name="24" id="anc24"></a><span class="line-modified">224     public void visitStackMapEntry(final StackMapEntry var) {</span>

225         stack.push(var);
226         var.accept(visitor);
227         stack.pop();
228     }
229 
230     @Override
<a name="25" id="anc25"></a><span class="line-modified">231     public void visitLocalVariable(final LocalVariable var) {</span>

232         stack.push(var);
233         var.accept(visitor);
234         stack.pop();
235     }
236 
237     @Override
<a name="26" id="anc26"></a><span class="line-modified">238     public void visitConstantPool(final ConstantPool cp) {</span>

239         stack.push(cp);
240         cp.accept(visitor);
241         final Constant[] constants = cp.getConstantPool();
<a name="27" id="anc27"></a><span class="line-modified">242         for (int i = 1; i &lt; constants.length; i++) {</span>
<span class="line-modified">243             if (constants[i] != null) {</span>


244                 constants[i].accept(this);
245             }
246         }
247         stack.pop();
248     }
249 
250     @Override
<a name="28" id="anc28"></a><span class="line-modified">251     public void visitConstantClass(final ConstantClass constant) {</span>

252         stack.push(constant);
253         constant.accept(visitor);
254         stack.pop();
255     }
256 
257     @Override
<a name="29" id="anc29"></a><span class="line-modified">258     public void visitConstantDouble(final ConstantDouble constant) {</span>

259         stack.push(constant);
260         constant.accept(visitor);
261         stack.pop();
262     }
263 
264     @Override
<a name="30" id="anc30"></a><span class="line-modified">265     public void visitConstantFieldref(final ConstantFieldref constant) {</span>

266         stack.push(constant);
267         constant.accept(visitor);
268         stack.pop();
269     }
270 
271     @Override
<a name="31" id="anc31"></a><span class="line-modified">272     public void visitConstantFloat(final ConstantFloat constant) {</span>

273         stack.push(constant);
274         constant.accept(visitor);
275         stack.pop();
276     }
277 
278     @Override
<a name="32" id="anc32"></a><span class="line-modified">279     public void visitConstantInteger(final ConstantInteger constant) {</span>

280         stack.push(constant);
281         constant.accept(visitor);
282         stack.pop();
283     }
284 
285     @Override
286     public void visitConstantInterfaceMethodref(
<a name="33" id="anc33"></a><span class="line-modified">287             final ConstantInterfaceMethodref constant) {</span>

288         stack.push(constant);
289         constant.accept(visitor);
290         stack.pop();
291     }
292 
293     /**
294      * @since 6.0
295      */
296     @Override
297     public void visitConstantInvokeDynamic(
<a name="34" id="anc34"></a><span class="line-modified">298             final ConstantInvokeDynamic constant) {</span>

299         stack.push(constant);
300         constant.accept(visitor);
301         stack.pop();
302     }
303 
304     @Override
<a name="35" id="anc35"></a><span class="line-modified">305     public void visitConstantLong(final ConstantLong constant) {</span>

306         stack.push(constant);
307         constant.accept(visitor);
308         stack.pop();
309     }
310 
311     @Override
<a name="36" id="anc36"></a><span class="line-modified">312     public void visitConstantMethodref(final ConstantMethodref constant) {</span>

313         stack.push(constant);
314         constant.accept(visitor);
315         stack.pop();
316     }
317 
318     @Override
<a name="37" id="anc37"></a><span class="line-modified">319     public void visitConstantNameAndType(final ConstantNameAndType constant) {</span>

320         stack.push(constant);
321         constant.accept(visitor);
322         stack.pop();
323     }
324 
325     @Override
<a name="38" id="anc38"></a><span class="line-modified">326     public void visitConstantString(final ConstantString constant) {</span>

327         stack.push(constant);
328         constant.accept(visitor);
329         stack.pop();
330     }
331 
332     @Override
<a name="39" id="anc39"></a><span class="line-modified">333     public void visitConstantUtf8(final ConstantUtf8 constant) {</span>

334         stack.push(constant);
335         constant.accept(visitor);
336         stack.pop();
337     }
338 
339     @Override
<a name="40" id="anc40"></a><span class="line-modified">340     public void visitInnerClasses(final InnerClasses ic) {</span>

341         stack.push(ic);
342         ic.accept(visitor);
343         final InnerClass[] ics = ic.getInnerClasses();
344         for (final InnerClass ic2 : ics) {
345             ic2.accept(this);
346         }
347         stack.pop();
348     }
349 
350     @Override
<a name="41" id="anc41"></a><span class="line-modified">351     public void visitInnerClass(final InnerClass inner) {</span>

352         stack.push(inner);
353         inner.accept(visitor);
354         stack.pop();
355     }
356 
357     /**
358      * @since 6.0
359      */
360     @Override
<a name="42" id="anc42"></a><span class="line-modified">361     public void visitBootstrapMethods(final BootstrapMethods bm) {</span>

362         stack.push(bm);
363         bm.accept(visitor);
364         // BootstrapMethod[] bms = bm.getBootstrapMethods();
365         // for (int i = 0; i &lt; bms.length; i++)
366         // {
367         //     bms[i].accept(this);
368         // }
369         stack.pop();
370     }
371 
372     @Override
<a name="43" id="anc43"></a><span class="line-modified">373     public void visitDeprecated(final Deprecated attribute) {</span>

374         stack.push(attribute);
375         attribute.accept(visitor);
376         stack.pop();
377     }
378 
379     @Override
<a name="44" id="anc44"></a><span class="line-modified">380     public void visitSignature(final Signature attribute) {</span>

381         stack.push(attribute);
382         attribute.accept(visitor);
383         stack.pop();
384     }
385 
386     @Override
<a name="45" id="anc45"></a><span class="line-modified">387     public void visitSourceFile(final SourceFile attribute) {</span>

388         stack.push(attribute);
389         attribute.accept(visitor);
390         stack.pop();
391     }
392 
393     @Override
<a name="46" id="anc46"></a><span class="line-modified">394     public void visitSynthetic(final Synthetic attribute) {</span>

395         stack.push(attribute);
396         attribute.accept(visitor);
397         stack.pop();
398     }
399 
400     @Override
<a name="47" id="anc47"></a><span class="line-modified">401     public void visitUnknown(final Unknown attribute) {</span>

402         stack.push(attribute);
403         attribute.accept(visitor);
404         stack.pop();
405     }
406 
407     /**
408      * @since 6.0
409      */
410     @Override
<a name="48" id="anc48"></a><span class="line-modified">411     public void visitAnnotationDefault(final AnnotationDefault obj) {</span>

412         stack.push(obj);
413         obj.accept(visitor);
414         stack.pop();
415     }
416 
417     /**
418      * @since 6.0
419      */
420     @Override
<a name="49" id="anc49"></a><span class="line-modified">421     public void visitEnclosingMethod(final EnclosingMethod obj) {</span>

422         stack.push(obj);
423         obj.accept(visitor);
424         stack.pop();
425     }
426 
427     /**
428      * @since 6.0
429      */
430     @Override
<a name="50" id="anc50"></a><span class="line-modified">431     public void visitLocalVariableTypeTable(final LocalVariableTypeTable obj) {</span>

432         stack.push(obj);
433         obj.accept(visitor);
<a name="51" id="anc51"></a><span class="line-removed">434         LocalVariable[] vars = obj.getLocalVariableTypeTable();</span>
<span class="line-removed">435         for (LocalVariable var : vars) {</span>
<span class="line-removed">436             var.accept(this);</span>
<span class="line-removed">437         }</span>
438         stack.pop();
439     }
440 
441     /**
442      * @since 6.0
443      */
444     @Override
<a name="52" id="anc52"></a><span class="line-modified">445     public void visitParameterAnnotation(final ParameterAnnotations obj) {</span>

446         stack.push(obj);
447         obj.accept(visitor);
448         stack.pop();
449     }
450 
451     /**
452      * @since 6.0
453      */
454     @Override
<a name="53" id="anc53"></a><span class="line-modified">455     public void visitMethodParameters(final MethodParameters obj) {</span>

456         stack.push(obj);
457         obj.accept(visitor);
<a name="54" id="anc54"></a>



458         stack.pop();
459     }
460 
461     /**
<a name="55" id="anc55"></a><span class="line-modified">462      * @since 6.0</span>
463      */
464     @Override
<a name="56" id="anc56"></a>








465     public void visitConstantMethodType(final ConstantMethodType obj) {
466         stack.push(obj);
467         obj.accept(visitor);
468         stack.pop();
469     }
470 
<a name="57" id="anc57"></a><span class="line-modified">471     /**</span>
<span class="line-removed">472      * @since 6.0</span>
<span class="line-removed">473      */</span>
474     @Override
475     public void visitConstantMethodHandle(final ConstantMethodHandle obj) {
476         stack.push(obj);
477         obj.accept(visitor);
478         stack.pop();
479     }
480 
<a name="58" id="anc58"></a><span class="line-modified">481     /**</span>
<span class="line-removed">482      * @since 6.0</span>
<span class="line-removed">483      */</span>
484     @Override
485     public void visitParameterAnnotationEntry(final ParameterAnnotationEntry obj) {
486         stack.push(obj);
487         obj.accept(visitor);
488         stack.pop();
489     }
490 
<a name="59" id="anc59"></a>














































































































491 }
<a name="60" id="anc60"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="60" type="hidden" />
</body>
</html>