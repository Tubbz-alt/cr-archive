<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.xml/share/classes/com/sun/org/apache/bcel/internal/generic/IINC.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="IF_ICMPNE.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="ILOAD.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml/share/classes/com/sun/org/apache/bcel/internal/generic/IINC.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 12  *
 13  *      http://www.apache.org/licenses/LICENSE-2.0
 14  *
 15  * Unless required by applicable law or agreed to in writing, software
 16  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 17  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 18  * See the License for the specific language governing permissions and
 19  * limitations under the License.
 20  */
 21 
 22 package com.sun.org.apache.bcel.internal.generic;
 23 
 24 import java.io.DataOutputStream;
 25 import java.io.IOException;
 26 
 27 import com.sun.org.apache.bcel.internal.util.ByteSequence;
 28 
 29 /**
 30  * IINC - Increment local variable by constant
 31  *
<span class="line-removed"> 32  * @version $Id: IINC.java 1747278 2016-06-07 17:28:43Z britter $</span>
 33  */
 34 public class IINC extends LocalVariableInstruction {
 35 
 36     private boolean wide;
 37     private int c;
 38 
 39 
 40     /**
<span class="line-modified"> 41      * Empty constructor needed for the Class.newInstance() statement in</span>
<span class="line-modified"> 42      * Instruction.readInstruction(). Not to be used otherwise.</span>
 43      */
 44     IINC() {
 45     }
 46 
 47 
 48     /**
 49      * @param n index of local variable
 50      * @param c increment factor
 51      */
 52     public IINC(final int n, final int c) {
<span class="line-modified"> 53         super(); // Default behaviour of LocalVariableInstruction causes error</span>
 54         super.setOpcode(com.sun.org.apache.bcel.internal.Const.IINC);
 55         super.setLength((short) 3);
 56         setIndex(n); // May set wide as side effect
 57         setIncrement(c);
 58     }
 59 
 60 
 61     /**
 62      * Dump instruction as byte code to stream out.
 63      * @param out Output stream
 64      */
 65     @Override
 66     public void dump( final DataOutputStream out ) throws IOException {
 67         if (wide) {
 68             out.writeByte(com.sun.org.apache.bcel.internal.Const.WIDE);
 69         }
 70         out.writeByte(super.getOpcode());
 71         if (wide) {
 72             out.writeShort(super.getIndex());
 73             out.writeShort(c);
 74         } else {
 75             out.writeByte(super.getIndex());
 76             out.writeByte(c);
 77         }
 78     }
 79 
 80 
 81     private void setWide() {
<span class="line-modified"> 82         wide = (super.getIndex() &gt; com.sun.org.apache.bcel.internal.Const.MAX_BYTE) || (Math.abs(c) &gt; Byte.MAX_VALUE);</span>





 83         if (wide) {
 84             super.setLength(6); // wide byte included
 85         } else {
 86             super.setLength(3);
 87         }
 88     }
 89 
 90 
 91     /**
 92      * Read needed data (e.g. index) from file.
 93      */
 94     @Override
 95     protected void initFromFile( final ByteSequence bytes, final boolean wide ) throws IOException {
 96         this.wide = wide;
 97         if (wide) {
 98             super.setLength(6);
 99             super.setIndexOnly(bytes.readUnsignedShort());
100             c = bytes.readShort();
101         } else {
102             super.setLength(3);
</pre>
</td>
<td>
<hr />
<pre>
 12  *
 13  *      http://www.apache.org/licenses/LICENSE-2.0
 14  *
 15  * Unless required by applicable law or agreed to in writing, software
 16  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 17  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 18  * See the License for the specific language governing permissions and
 19  * limitations under the License.
 20  */
 21 
 22 package com.sun.org.apache.bcel.internal.generic;
 23 
 24 import java.io.DataOutputStream;
 25 import java.io.IOException;
 26 
 27 import com.sun.org.apache.bcel.internal.util.ByteSequence;
 28 
 29 /**
 30  * IINC - Increment local variable by constant
 31  *

 32  */
 33 public class IINC extends LocalVariableInstruction {
 34 
 35     private boolean wide;
 36     private int c;
 37 
 38 
 39     /**
<span class="line-modified"> 40      * Empty constructor needed for Instruction.readInstruction.</span>
<span class="line-modified"> 41      * Not to be used otherwise.</span>
 42      */
 43     IINC() {
 44     }
 45 
 46 
 47     /**
 48      * @param n index of local variable
 49      * @param c increment factor
 50      */
 51     public IINC(final int n, final int c) {
<span class="line-modified"> 52         super(); // Default behavior of LocalVariableInstruction causes error</span>
 53         super.setOpcode(com.sun.org.apache.bcel.internal.Const.IINC);
 54         super.setLength((short) 3);
 55         setIndex(n); // May set wide as side effect
 56         setIncrement(c);
 57     }
 58 
 59 
 60     /**
 61      * Dump instruction as byte code to stream out.
 62      * @param out Output stream
 63      */
 64     @Override
 65     public void dump( final DataOutputStream out ) throws IOException {
 66         if (wide) {
 67             out.writeByte(com.sun.org.apache.bcel.internal.Const.WIDE);
 68         }
 69         out.writeByte(super.getOpcode());
 70         if (wide) {
 71             out.writeShort(super.getIndex());
 72             out.writeShort(c);
 73         } else {
 74             out.writeByte(super.getIndex());
 75             out.writeByte(c);
 76         }
 77     }
 78 
 79 
 80     private void setWide() {
<span class="line-modified"> 81         wide = super.getIndex() &gt; com.sun.org.apache.bcel.internal.Const.MAX_BYTE;</span>
<span class="line-added"> 82         if (c &gt; 0) {</span>
<span class="line-added"> 83             wide = wide || (c &gt; Byte.MAX_VALUE);</span>
<span class="line-added"> 84         } else {</span>
<span class="line-added"> 85             wide = wide || (c &lt; Byte.MIN_VALUE);</span>
<span class="line-added"> 86         }</span>
 87         if (wide) {
 88             super.setLength(6); // wide byte included
 89         } else {
 90             super.setLength(3);
 91         }
 92     }
 93 
 94 
 95     /**
 96      * Read needed data (e.g. index) from file.
 97      */
 98     @Override
 99     protected void initFromFile( final ByteSequence bytes, final boolean wide ) throws IOException {
100         this.wide = wide;
101         if (wide) {
102             super.setLength(6);
103             super.setIndexOnly(bytes.readUnsignedShort());
104             c = bytes.readShort();
105         } else {
106             super.setLength(3);
</pre>
</td>
</tr>
</table>
<center><a href="IF_ICMPNE.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="ILOAD.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>