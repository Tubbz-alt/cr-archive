<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.xml/share/classes/com/sun/org/apache/xerces/internal/dom/ElementNSImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ElementImpl.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="NodeImpl.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml/share/classes/com/sun/org/apache/xerces/internal/dom/ElementNSImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 84,17 ***</span>
          setName(namespaceURI, qualifiedName);
      }
  
          private void setName(String namespaceURI, String qname) {
  
<span class="line-modified">!                 String prefix;</span>
<span class="line-modified">!                 // DOM Level 3: namespace URI is never empty string.</span>
<span class="line-modified">!                 this.namespaceURI = namespaceURI;</span>
<span class="line-modified">!                 if (namespaceURI != null) {</span>
              //convert the empty string to &#39;null&#39;
<span class="line-modified">!                         this.namespaceURI =     (namespaceURI.length() == 0) ? null : namespaceURI;</span>
<span class="line-modified">!                 }</span>
  
          int colon1, colon2 ;
  
          //NAMESPACE_ERR:
          //1. if the qualified name is &#39;null&#39; it is malformed.
<span class="line-new-header">--- 84,17 ---</span>
          setName(namespaceURI, qualifiedName);
      }
  
          private void setName(String namespaceURI, String qname) {
  
<span class="line-modified">!             String prefix;</span>
<span class="line-modified">!             // DOM Level 3: namespace URI is never empty string.</span>
<span class="line-modified">!             this.namespaceURI = namespaceURI;</span>
<span class="line-modified">!             if (namespaceURI != null) {</span>
              //convert the empty string to &#39;null&#39;
<span class="line-modified">!             this.namespaceURI = (namespaceURI.length() == 0) ? null : namespaceURI;</span>
<span class="line-modified">!             }</span>
  
          int colon1, colon2 ;
  
          //NAMESPACE_ERR:
          //1. if the qualified name is &#39;null&#39; it is malformed.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 188,41 ***</span>
                  this.name = qualifiedName;
          setName(namespaceURI, qualifiedName);
          reconcileDefaultAttributes();
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * NON-DOM: resets this node and sets specified values for the node</span>
<span class="line-removed">-      *</span>
<span class="line-removed">-      * @param ownerDocument</span>
<span class="line-removed">-      * @param namespaceURI</span>
<span class="line-removed">-      * @param qualifiedName</span>
<span class="line-removed">-      * @param localName</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     protected void setValues (CoreDocumentImpl ownerDocument,</span>
<span class="line-removed">-                             String namespaceURI, String qualifiedName,</span>
<span class="line-removed">-                             String localName){</span>
<span class="line-removed">- </span>
<span class="line-removed">-         // remove children first</span>
<span class="line-removed">-         firstChild = null;</span>
<span class="line-removed">-         previousSibling = null;</span>
<span class="line-removed">-         nextSibling = null;</span>
<span class="line-removed">-         fNodeListCache = null;</span>
<span class="line-removed">- </span>
<span class="line-removed">-         // set owner document</span>
<span class="line-removed">-         attributes = null;</span>
<span class="line-removed">-         super.flags = 0;</span>
<span class="line-removed">-         setOwnerDocument(ownerDocument);</span>
<span class="line-removed">- </span>
<span class="line-removed">-         // synchronizeData will initialize attributes</span>
<span class="line-removed">-         needsSyncData(true);</span>
<span class="line-removed">-         super.name = qualifiedName;</span>
<span class="line-removed">-         this.localName = localName;</span>
<span class="line-removed">-         this.namespaceURI = namespaceURI;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      //
      // Node methods
      //
  
  
<span class="line-new-header">--- 188,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 338,92 ***</span>
              synchronizeData();
          }
          return localName;
      }
  
<span class="line-modified">! </span>
<span class="line-modified">!    /**</span>
<span class="line-modified">!      * DOM Level 3 WD - Experimental.</span>
<span class="line-removed">-      * Retrieve baseURI</span>
       */
<span class="line-modified">!     public String getBaseURI() {</span>
<span class="line-modified">! </span>
<span class="line-modified">!         if (needsSyncData()) {</span>
<span class="line-removed">-             synchronizeData();</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         // Absolute base URI is computed according to XML Base (http://www.w3.org/TR/xmlbase/#granularity)</span>
<span class="line-removed">- </span>
<span class="line-removed">-         // 1.  the base URI specified by an xml:base attribute on the element, if one exists</span>
<span class="line-removed">- </span>
<span class="line-removed">-         if (attributes != null) {</span>
<span class="line-removed">-             Attr attrNode = (Attr)attributes.getNamedItemNS(&quot;http://www.w3.org/XML/1998/namespace&quot;, &quot;base&quot;);</span>
<span class="line-removed">-             if (attrNode != null) {</span>
<span class="line-removed">-                 String uri =  attrNode.getNodeValue();</span>
<span class="line-removed">-                 if (uri.length() != 0 ) {// attribute value is always empty string</span>
<span class="line-removed">-                     try {</span>
<span class="line-removed">-                         uri = new URI(uri).toString();</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                     catch (com.sun.org.apache.xerces.internal.util.URI.MalformedURIException e) {</span>
<span class="line-removed">-                         // This may be a relative URI.</span>
<span class="line-removed">- </span>
<span class="line-removed">-                         // Start from the base URI of the parent, or if this node has no parent, the owner node.</span>
<span class="line-removed">-                         NodeImpl parentOrOwner = (parentNode() != null) ? parentNode() : ownerNode;</span>
<span class="line-removed">- </span>
<span class="line-removed">-                         // Make any parentURI into a URI object to use with the URI(URI, String) constructor.</span>
<span class="line-removed">-                         String parentBaseURI = (parentOrOwner != null) ? parentOrOwner.getBaseURI() : null;</span>
<span class="line-removed">- </span>
<span class="line-removed">-                         if (parentBaseURI != null) {</span>
<span class="line-removed">-                             try {</span>
<span class="line-removed">-                                 uri = new URI(new URI(parentBaseURI), uri).toString();</span>
<span class="line-removed">-                             }</span>
<span class="line-removed">-                             catch (com.sun.org.apache.xerces.internal.util.URI.MalformedURIException ex){</span>
<span class="line-removed">-                                 // This should never happen: parent should have checked the URI and returned null if invalid.</span>
<span class="line-removed">-                                 return null;</span>
<span class="line-removed">-                             }</span>
<span class="line-removed">-                             return uri;</span>
<span class="line-removed">-                         }</span>
<span class="line-removed">-                         // REVISIT: what should happen in this case?</span>
<span class="line-removed">-                         return null;</span>
<span class="line-removed">-                     }</span>
<span class="line-removed">-                     return uri;</span>
<span class="line-removed">-                 }</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         //2.the base URI of the element&#39;s parent element within the document or external entity,</span>
<span class="line-removed">-         //if one exists</span>
<span class="line-removed">-         String parentElementBaseURI = (this.parentNode() != null) ? this.parentNode().getBaseURI() : null ;</span>
<span class="line-removed">-         //base URI of parent element is not null</span>
<span class="line-removed">-         if(parentElementBaseURI != null){</span>
<span class="line-removed">-             try {</span>
<span class="line-removed">-                 //return valid absolute base URI</span>
<span class="line-removed">-                return new URI(parentElementBaseURI).toString();</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-             catch (com.sun.org.apache.xerces.internal.util.URI.MalformedURIException e){</span>
<span class="line-removed">-                 // REVISIT: what should happen in this case?</span>
<span class="line-removed">-                 return null;</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         //3. the base URI of the document entity or external entity containing the element</span>
<span class="line-removed">- </span>
<span class="line-removed">-         String baseURI = (this.ownerNode != null) ? this.ownerNode.getBaseURI() : null ;</span>
<span class="line-removed">- </span>
<span class="line-removed">-         if(baseURI != null){</span>
<span class="line-removed">-             try {</span>
<span class="line-removed">-                 //return valid absolute base URI</span>
<span class="line-removed">-                return new URI(baseURI).toString();</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-             catch (com.sun.org.apache.xerces.internal.util.URI.MalformedURIException e){</span>
<span class="line-removed">-                 // REVISIT: what should happen in this case?</span>
<span class="line-removed">-                 return null;</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         return null;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
  
      /**
       * @see org.w3c.dom.TypeInfo#getTypeName()
       */
      public String getTypeName() {
<span class="line-new-header">--- 307,17 ---</span>
              synchronizeData();
          }
          return localName;
      }
  
<span class="line-modified">!     /**</span>
<span class="line-modified">!      * NON-DOM</span>
<span class="line-modified">!      * Returns the xml:base attribute.</span>
       */
<span class="line-modified">!     protected Attr getXMLBaseAttribute() {</span>
<span class="line-modified">!         return (Attr) attributes.getNamedItemNS(&quot;http://www.w3.org/XML/1998/namespace&quot;, &quot;base&quot;);</span>
<span class="line-modified">!     } // getXMLBaseAttribute():Attr</span>
  
      /**
       * @see org.w3c.dom.TypeInfo#getTypeName()
       */
      public String getTypeName() {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 450,16 ***</span>
      /**
       * Introduced in DOM Level 2. &lt;p&gt;
       * Checks if a type is derived from another by restriction. See:
       * http://www.w3.org/TR/DOM-Level-3-Core/core.html#TypeInfo-isDerivedFrom
       *
<span class="line-modified">!      * @param ancestorNS</span>
       *        The namspace of the ancestor type declaration
<span class="line-modified">!      * @param ancestorName</span>
       *        The name of the ancestor type declaration
<span class="line-modified">!      * @param type</span>
<span class="line-modified">!      *        The reference type definition</span>
       *
       * @return boolean True if the type is derived by restriciton for the
       *         reference type
       */
      public boolean isDerivedFrom(String typeNamespaceArg, String typeNameArg,
<span class="line-new-header">--- 344,16 ---</span>
      /**
       * Introduced in DOM Level 2. &lt;p&gt;
       * Checks if a type is derived from another by restriction. See:
       * http://www.w3.org/TR/DOM-Level-3-Core/core.html#TypeInfo-isDerivedFrom
       *
<span class="line-modified">!      * @param typeNamespaceArg</span>
       *        The namspace of the ancestor type declaration
<span class="line-modified">!      * @param typeNameArg</span>
       *        The name of the ancestor type declaration
<span class="line-modified">!      * @param derivationMethod</span>
<span class="line-modified">!      *        The derivation method</span>
       *
       * @return boolean True if the type is derived by restriciton for the
       *         reference type
       */
      public boolean isDerivedFrom(String typeNamespaceArg, String typeNameArg,
</pre>
<center><a href="ElementImpl.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="NodeImpl.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>