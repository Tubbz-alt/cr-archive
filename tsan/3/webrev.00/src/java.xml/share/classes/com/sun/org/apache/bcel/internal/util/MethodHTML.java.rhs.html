<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.xml/share/classes/com/sun/org/apache/bcel/internal/util/MethodHTML.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * reserved comment block
  3  * DO NOT REMOVE OR ALTER!
  4  */
  5 /*
  6  * Licensed to the Apache Software Foundation (ASF) under one or more
  7  * contributor license agreements.  See the NOTICE file distributed with
  8  * this work for additional information regarding copyright ownership.
  9  * The ASF licenses this file to You under the Apache License, Version 2.0
 10  * (the &quot;License&quot;); you may not use this file except in compliance with
 11  * the License.  You may obtain a copy of the License at
 12  *
 13  *      http://www.apache.org/licenses/LICENSE-2.0
 14  *
 15  * Unless required by applicable law or agreed to in writing, software
 16  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 17  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 18  * See the License for the specific language governing permissions and
 19  * limitations under the License.
 20  */
 21 
 22 package com.sun.org.apache.bcel.internal.util;
 23 
 24 import java.io.FileOutputStream;
 25 import java.io.IOException;
 26 import java.io.PrintWriter;
 27 
 28 import com.sun.org.apache.bcel.internal.Const;
 29 import com.sun.org.apache.bcel.internal.classfile.Attribute;
 30 import com.sun.org.apache.bcel.internal.classfile.Code;
 31 import com.sun.org.apache.bcel.internal.classfile.ConstantValue;
 32 import com.sun.org.apache.bcel.internal.classfile.ExceptionTable;
 33 import com.sun.org.apache.bcel.internal.classfile.Field;
 34 import com.sun.org.apache.bcel.internal.classfile.Method;
 35 import com.sun.org.apache.bcel.internal.classfile.Utility;
 36 
 37 /**
 38  * Convert methods and fields into HTML file.
 39  *
<a name="1" id="anc1"></a>
 40  *
 41  */
 42 final class MethodHTML {
 43 
 44     private final String class_name; // name of current class
 45     private final PrintWriter file; // file to write to
 46     private final ConstantHTML constant_html;
 47     private final AttributeHTML attribute_html;
 48 
 49 
 50     MethodHTML(final String dir, final String class_name, final Method[] methods, final Field[] fields,
 51             final ConstantHTML constant_html, final AttributeHTML attribute_html) throws IOException {
 52         this.class_name = class_name;
 53         this.attribute_html = attribute_html;
 54         this.constant_html = constant_html;
 55         file = new PrintWriter(new FileOutputStream(dir + class_name + &quot;_methods.html&quot;));
 56         file.println(&quot;&lt;HTML&gt;&lt;BODY BGCOLOR=\&quot;#C0C0C0\&quot;&gt;&lt;TABLE BORDER=0&gt;&quot;);
 57         file.println(&quot;&lt;TR&gt;&lt;TH ALIGN=LEFT&gt;Access&amp;nbsp;flags&lt;/TH&gt;&lt;TH ALIGN=LEFT&gt;Type&lt;/TH&gt;&quot;
 58                 + &quot;&lt;TH ALIGN=LEFT&gt;Field&amp;nbsp;name&lt;/TH&gt;&lt;/TR&gt;&quot;);
 59         for (final Field field : fields) {
 60             writeField(field);
 61         }
 62         file.println(&quot;&lt;/TABLE&gt;&quot;);
 63         file.println(&quot;&lt;TABLE BORDER=0&gt;&lt;TR&gt;&lt;TH ALIGN=LEFT&gt;Access&amp;nbsp;flags&lt;/TH&gt;&quot;
 64                 + &quot;&lt;TH ALIGN=LEFT&gt;Return&amp;nbsp;type&lt;/TH&gt;&lt;TH ALIGN=LEFT&gt;Method&amp;nbsp;name&lt;/TH&gt;&quot;
 65                 + &quot;&lt;TH ALIGN=LEFT&gt;Arguments&lt;/TH&gt;&lt;/TR&gt;&quot;);
 66         for (int i = 0; i &lt; methods.length; i++) {
 67             writeMethod(methods[i], i);
 68         }
 69         file.println(&quot;&lt;/TABLE&gt;&lt;/BODY&gt;&lt;/HTML&gt;&quot;);
 70         file.close();
 71     }
 72 
 73 
 74     /**
 75      * Print field of class.
 76      *
 77      * @param field field to print
 78      * @throws java.io.IOException
 79      */
 80     private void writeField( final Field field ) throws IOException {
 81         final String type = Utility.signatureToString(field.getSignature());
 82         final String name = field.getName();
 83         String access = Utility.accessToString(field.getAccessFlags());
 84         Attribute[] attributes;
 85         access = Utility.replace(access, &quot; &quot;, &quot;&amp;nbsp;&quot;);
 86         file.print(&quot;&lt;TR&gt;&lt;TD&gt;&lt;FONT COLOR=\&quot;#FF0000\&quot;&gt;&quot; + access + &quot;&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD&gt;&quot;
 87                 + Class2HTML.referenceType(type) + &quot;&lt;/TD&gt;&lt;TD&gt;&lt;A NAME=\&quot;field&quot; + name + &quot;\&quot;&gt;&quot; + name
 88                 + &quot;&lt;/A&gt;&lt;/TD&gt;&quot;);
 89         attributes = field.getAttributes();
 90         // Write them to the Attributes.html file with anchor &quot;&lt;name&gt;[&lt;i&gt;]&quot;
 91         for (int i = 0; i &lt; attributes.length; i++) {
 92             attribute_html.writeAttribute(attributes[i], name + &quot;@&quot; + i);
 93         }
 94         for (int i = 0; i &lt; attributes.length; i++) {
 95             if (attributes[i].getTag() == Const.ATTR_CONSTANT_VALUE) { // Default value
 96                 final String str = ((ConstantValue) attributes[i]).toString();
 97                 // Reference attribute in _attributes.html
 98                 file.print(&quot;&lt;TD&gt;= &lt;A HREF=\&quot;&quot; + class_name + &quot;_attributes.html#&quot; + name + &quot;@&quot; + i
 99                         + &quot;\&quot; TARGET=\&quot;Attributes\&quot;&gt;&quot; + str + &quot;&lt;/TD&gt;\n&quot;);
100                 break;
101             }
102         }
103         file.println(&quot;&lt;/TR&gt;&quot;);
104     }
105 
106 
107     private void writeMethod( final Method method, final int method_number ) {
108         // Get raw signature
109         final String signature = method.getSignature();
110         // Get array of strings containing the argument types
111         final String[] args = Utility.methodSignatureArgumentTypes(signature, false);
112         // Get return type string
113         final String type = Utility.methodSignatureReturnType(signature, false);
114         // Get method name
115         final String name = method.getName();
116         String html_name;
117         // Get method&#39;s access flags
118         String access = Utility.accessToString(method.getAccessFlags());
119         // Get the method&#39;s attributes, the Code Attribute in particular
120         final Attribute[] attributes = method.getAttributes();
121         /* HTML doesn&#39;t like names like &lt;clinit&gt; and spaces are places to break
122          * lines. Both we don&#39;t want...
123          */
124         access = Utility.replace(access, &quot; &quot;, &quot;&amp;nbsp;&quot;);
125         html_name = Class2HTML.toHTML(name);
126         file.print(&quot;&lt;TR VALIGN=TOP&gt;&lt;TD&gt;&lt;FONT COLOR=\&quot;#FF0000\&quot;&gt;&lt;A NAME=method&quot; + method_number
127                 + &quot;&gt;&quot; + access + &quot;&lt;/A&gt;&lt;/FONT&gt;&lt;/TD&gt;&quot;);
128         file.print(&quot;&lt;TD&gt;&quot; + Class2HTML.referenceType(type) + &quot;&lt;/TD&gt;&lt;TD&gt;&quot; + &quot;&lt;A HREF=&quot; + class_name
129                 + &quot;_code.html#method&quot; + method_number + &quot; TARGET=Code&gt;&quot; + html_name
130                 + &quot;&lt;/A&gt;&lt;/TD&gt;\n&lt;TD&gt;(&quot;);
131         for (int i = 0; i &lt; args.length; i++) {
132             file.print(Class2HTML.referenceType(args[i]));
133             if (i &lt; args.length - 1) {
134                 file.print(&quot;, &quot;);
135             }
136         }
137         file.print(&quot;)&lt;/TD&gt;&lt;/TR&gt;&quot;);
138         // Check for thrown exceptions
139         for (int i = 0; i &lt; attributes.length; i++) {
140             attribute_html.writeAttribute(attributes[i], &quot;method&quot; + method_number + &quot;@&quot; + i,
141                     method_number);
142             final byte tag = attributes[i].getTag();
143             if (tag == Const.ATTR_EXCEPTIONS) {
144                 file.print(&quot;&lt;TR VALIGN=TOP&gt;&lt;TD COLSPAN=2&gt;&lt;/TD&gt;&lt;TH ALIGN=LEFT&gt;throws&lt;/TH&gt;&lt;TD&gt;&quot;);
145                 final int[] exceptions = ((ExceptionTable) attributes[i]).getExceptionIndexTable();
146                 for (int j = 0; j &lt; exceptions.length; j++) {
147                     file.print(constant_html.referenceConstant(exceptions[j]));
148                     if (j &lt; exceptions.length - 1) {
149                         file.print(&quot;, &quot;);
150                     }
151                 }
152                 file.println(&quot;&lt;/TD&gt;&lt;/TR&gt;&quot;);
153             } else if (tag == Const.ATTR_CODE) {
154                 final Attribute[] c_a = ((Code) attributes[i]).getAttributes();
155                 for (int j = 0; j &lt; c_a.length; j++) {
156                     attribute_html.writeAttribute(c_a[j], &quot;method&quot; + method_number + &quot;@&quot; + i + &quot;@&quot;
157                             + j, method_number);
158                 }
159             }
160         }
161     }
162 }
<a name="2" id="anc2"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="2" type="hidden" />
</body>
</html>