<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.xml/share/classes/com/sun/org/apache/xml/internal/serializer/dom3/LSSerializerImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../ToXMLStream.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../xpath/internal/XPath.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml/share/classes/com/sun/org/apache/xml/internal/serializer/dom3/LSSerializerImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * reserved comment block</span>
<span class="line-removed">   3  * DO NOT REMOVE OR ALTER!</span>
   4  */
   5 /*
   6  * Licensed to the Apache Software Foundation (ASF) under one
   7  * or more contributor license agreements. See the NOTICE file
   8  * distributed with this work for additional information
   9  * regarding copyright ownership. The ASF licenses this file
  10  * to you under the Apache License, Version 2.0 (the  &quot;License&quot;);
  11  * you may not use this file except in compliance with the License.
  12  * You may obtain a copy of the License at
  13  *
  14  *     http://www.apache.org/licenses/LICENSE-2.0
  15  *
  16  * Unless required by applicable law or agreed to in writing, software
  17  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  18  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  19  * See the License for the specific language governing permissions and
  20  * limitations under the License.
  21  */
  22 
  23 package com.sun.org.apache.xml.internal.serializer.dom3;
</pre>
<hr />
<pre>
  51 import org.w3c.dom.Document;
  52 import org.w3c.dom.Node;
  53 import org.w3c.dom.ls.LSException;
  54 import org.w3c.dom.ls.LSOutput;
  55 import org.w3c.dom.ls.LSSerializer;
  56 import org.w3c.dom.ls.LSSerializerFilter;
  57 
  58 
  59 /**
  60  * Implemenatation of DOM Level 3 org.w3c.ls.LSSerializer and
  61  * org.w3c.dom.ls.DOMConfiguration.  Serialization is achieved by delegating
  62  * serialization calls to &lt;CODE&gt;org.apache.xml.serializer.ToStream&lt;/CODE&gt; or
  63  * one of its derived classes depending on the serialization method, while walking
  64  * the DOM in DOM3TreeWalker.
  65  * @see &lt;a href=&quot;http://www.w3.org/TR/2004/REC-DOM-Level-3-LS-20040407/load-save.html#LS-LSSerializer&quot;&gt;org.w3c.dom.ls.LSSerializer&lt;/a&gt;
  66  * @see &lt;a href=&quot;http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/core.html#DOMConfiguration&quot;&gt;org.w3c.dom.DOMConfiguration&lt;/a&gt;
  67  *
  68  * @version $Id:
  69  *
  70  * @xsl.usage internal

  71  */
  72 final public class LSSerializerImpl implements DOMConfiguration, LSSerializer {
  73 
  74     /** private data members */
  75     private Serializer fXMLSerializer = null;
  76 
  77     // Tracks DOMConfiguration features.
  78     protected int fFeatures = 0;
  79 
  80     // Common DOM serializer
  81     private  DOM3Serializer fDOMSerializer = null;
  82 
  83     // A filter set on the LSSerializer
  84     private LSSerializerFilter fSerializerFilter = null;
  85 
  86     // Stores the nodeArg parameter to speed up multiple writes of the same node.
  87     private Node fVisitedNode = null;
  88 
  89     // The end-of-line character sequence used in serialization.  &quot;\n&quot; is whats used on the web.
  90     private String fEndOfLine = &quot;\n&quot;;
</pre>
<hr />
<pre>
 203         fFeatures |= NAMESPACEDECLS;
 204         fFeatures |= SPLITCDATA;
 205         fFeatures |= WELLFORMED;
 206         fFeatures |= DISCARDDEFAULT;
 207         fFeatures |= XMLDECL;
 208 
 209         // New OutputFormat properties
 210         fDOMConfigProperties = new Properties();
 211 
 212         // Initialize properties to be passed on the underlying serializer
 213         initializeSerializerProps();
 214 
 215         // Read output_xml.properties and System Properties to initialize properties
 216         Properties  configProps = OutputPropertiesFactory.getDefaultMethodProperties(&quot;xml&quot;);
 217 
 218         // change xml version from 1.0 to 1.1
 219         //configProps.setProperty(&quot;version&quot;, &quot;1.1&quot;);
 220 
 221         // Get a serializer that seriailizes according to the properties,
 222         // which in this case is to xml
<span class="line-modified"> 223         fXMLSerializer = new ToXMLStream();</span>
 224         fXMLSerializer.setOutputFormat(configProps);
 225 
 226         // Initialize Serializer
 227         fXMLSerializer.setOutputFormat(fDOMConfigProperties);
 228     }
 229 
 230     /**
 231      * Initializes the underlying serializer&#39;s configuration depending on the
 232      * default DOMConfiguration parameters. This method must be called before a
 233      * node is to be serialized.
 234      *
 235      * @xsl.usage internal
 236      */
 237     public void initializeSerializerProps () {
 238         // canonical-form
 239         fDOMConfigProperties.setProperty(DOMConstants.S_DOM3_PROPERTIES_NS
 240                 + DOMConstants.DOM_CANONICAL_FORM, DOMConstants.DOM3_DEFAULT_FALSE);
 241 
 242         // cdata-sections
 243         fDOMConfigProperties.setProperty(DOMConstants.S_DOM3_PROPERTIES_NS
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2019, Oracle and/or its affiliates. All rights reserved.</span>

   3  */
   4 /*
   5  * Licensed to the Apache Software Foundation (ASF) under one
   6  * or more contributor license agreements. See the NOTICE file
   7  * distributed with this work for additional information
   8  * regarding copyright ownership. The ASF licenses this file
   9  * to you under the Apache License, Version 2.0 (the  &quot;License&quot;);
  10  * you may not use this file except in compliance with the License.
  11  * You may obtain a copy of the License at
  12  *
  13  *     http://www.apache.org/licenses/LICENSE-2.0
  14  *
  15  * Unless required by applicable law or agreed to in writing, software
  16  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  17  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  18  * See the License for the specific language governing permissions and
  19  * limitations under the License.
  20  */
  21 
  22 package com.sun.org.apache.xml.internal.serializer.dom3;
</pre>
<hr />
<pre>
  50 import org.w3c.dom.Document;
  51 import org.w3c.dom.Node;
  52 import org.w3c.dom.ls.LSException;
  53 import org.w3c.dom.ls.LSOutput;
  54 import org.w3c.dom.ls.LSSerializer;
  55 import org.w3c.dom.ls.LSSerializerFilter;
  56 
  57 
  58 /**
  59  * Implemenatation of DOM Level 3 org.w3c.ls.LSSerializer and
  60  * org.w3c.dom.ls.DOMConfiguration.  Serialization is achieved by delegating
  61  * serialization calls to &lt;CODE&gt;org.apache.xml.serializer.ToStream&lt;/CODE&gt; or
  62  * one of its derived classes depending on the serialization method, while walking
  63  * the DOM in DOM3TreeWalker.
  64  * @see &lt;a href=&quot;http://www.w3.org/TR/2004/REC-DOM-Level-3-LS-20040407/load-save.html#LS-LSSerializer&quot;&gt;org.w3c.dom.ls.LSSerializer&lt;/a&gt;
  65  * @see &lt;a href=&quot;http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/core.html#DOMConfiguration&quot;&gt;org.w3c.dom.DOMConfiguration&lt;/a&gt;
  66  *
  67  * @version $Id:
  68  *
  69  * @xsl.usage internal
<span class="line-added">  70  * @LastModified: Aug 2019</span>
  71  */
  72 final public class LSSerializerImpl implements DOMConfiguration, LSSerializer {
  73 
  74     /** private data members */
  75     private Serializer fXMLSerializer = null;
  76 
  77     // Tracks DOMConfiguration features.
  78     protected int fFeatures = 0;
  79 
  80     // Common DOM serializer
  81     private  DOM3Serializer fDOMSerializer = null;
  82 
  83     // A filter set on the LSSerializer
  84     private LSSerializerFilter fSerializerFilter = null;
  85 
  86     // Stores the nodeArg parameter to speed up multiple writes of the same node.
  87     private Node fVisitedNode = null;
  88 
  89     // The end-of-line character sequence used in serialization.  &quot;\n&quot; is whats used on the web.
  90     private String fEndOfLine = &quot;\n&quot;;
</pre>
<hr />
<pre>
 203         fFeatures |= NAMESPACEDECLS;
 204         fFeatures |= SPLITCDATA;
 205         fFeatures |= WELLFORMED;
 206         fFeatures |= DISCARDDEFAULT;
 207         fFeatures |= XMLDECL;
 208 
 209         // New OutputFormat properties
 210         fDOMConfigProperties = new Properties();
 211 
 212         // Initialize properties to be passed on the underlying serializer
 213         initializeSerializerProps();
 214 
 215         // Read output_xml.properties and System Properties to initialize properties
 216         Properties  configProps = OutputPropertiesFactory.getDefaultMethodProperties(&quot;xml&quot;);
 217 
 218         // change xml version from 1.0 to 1.1
 219         //configProps.setProperty(&quot;version&quot;, &quot;1.1&quot;);
 220 
 221         // Get a serializer that seriailizes according to the properties,
 222         // which in this case is to xml
<span class="line-modified"> 223         fXMLSerializer = new ToXMLStream(null);</span>
 224         fXMLSerializer.setOutputFormat(configProps);
 225 
 226         // Initialize Serializer
 227         fXMLSerializer.setOutputFormat(fDOMConfigProperties);
 228     }
 229 
 230     /**
 231      * Initializes the underlying serializer&#39;s configuration depending on the
 232      * default DOMConfiguration parameters. This method must be called before a
 233      * node is to be serialized.
 234      *
 235      * @xsl.usage internal
 236      */
 237     public void initializeSerializerProps () {
 238         // canonical-form
 239         fDOMConfigProperties.setProperty(DOMConstants.S_DOM3_PROPERTIES_NS
 240                 + DOMConstants.DOM_CANONICAL_FORM, DOMConstants.DOM3_DEFAULT_FALSE);
 241 
 242         // cdata-sections
 243         fDOMConfigProperties.setProperty(DOMConstants.S_DOM3_PROPERTIES_NS
</pre>
</td>
</tr>
</table>
<center><a href="../ToXMLStream.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../xpath/internal/XPath.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>