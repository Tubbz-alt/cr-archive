<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.xml/share/classes/com/sun/org/apache/bcel/internal/generic/InvokeInstruction.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="InstructionTargeter.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="JSR.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml/share/classes/com/sun/org/apache/bcel/internal/generic/InvokeInstruction.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * reserved comment block</span>
<span class="line-removed">  3  * DO NOT REMOVE OR ALTER!</span>
  4  */
  5 /*
  6  * Licensed to the Apache Software Foundation (ASF) under one or more
  7  * contributor license agreements.  See the NOTICE file distributed with
  8  * this work for additional information regarding copyright ownership.
  9  * The ASF licenses this file to You under the Apache License, Version 2.0
 10  * (the &quot;License&quot;); you may not use this file except in compliance with
 11  * the License.  You may obtain a copy of the License at
 12  *
 13  *      http://www.apache.org/licenses/LICENSE-2.0
 14  *
 15  * Unless required by applicable law or agreed to in writing, software
 16  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 17  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 18  * See the License for the specific language governing permissions and
 19  * limitations under the License.
 20  */
 21 
 22 package com.sun.org.apache.bcel.internal.generic;
 23 
 24 import java.util.StringTokenizer;
 25 
 26 import com.sun.org.apache.bcel.internal.Const;
 27 import com.sun.org.apache.bcel.internal.classfile.Constant;
 28 import com.sun.org.apache.bcel.internal.classfile.ConstantCP;
 29 import com.sun.org.apache.bcel.internal.classfile.ConstantPool;
 30 
 31 /**
 32  * Super class for the INVOKExxx family of instructions.
 33  *
<span class="line-modified"> 34  * @version $Id: InvokeInstruction.java 1752106 2016-07-10 20:02:39Z britter $</span>
 35  */
 36 public abstract class InvokeInstruction extends FieldOrMethod implements ExceptionThrower,
 37         StackConsumer, StackProducer {
 38 
 39     /**
<span class="line-modified"> 40      * Empty constructor needed for the Class.newInstance() statement in</span>
<span class="line-modified"> 41      * Instruction.readInstruction(). Not to be used otherwise.</span>
 42      */
 43     InvokeInstruction() {
 44     }
 45 
 46 
 47     /**
 48      * @param index to constant pool
 49      */
 50     protected InvokeInstruction(final short opcode, final int index) {
 51         super(opcode, index);
 52     }
 53 
 54 
 55     /**
 56      * @return mnemonic for instruction with symbolic references resolved
 57      */
 58     @Override
 59     public String toString( final ConstantPool cp ) {
 60         final Constant c = cp.getConstant(super.getIndex());
 61         final StringTokenizer tok = new StringTokenizer(cp.constantToString(c));
<span class="line-modified"> 62         return Const.getOpcodeName(super.getOpcode()) + &quot; &quot; + tok.nextToken().replace(&#39;.&#39;, &#39;/&#39;)</span>
<span class="line-modified"> 63                 + tok.nextToken();</span>











 64     }
 65 
 66 
 67     /**
 68      * Also works for instructions whose stack effect depends on the
 69      * constant pool entry they reference.
 70      * @return Number of words consumed from stack by this instruction
 71      */
 72     @Override
 73     public int consumeStack( final ConstantPoolGen cpg ) {
 74         int sum;
 75         if ((super.getOpcode() == Const.INVOKESTATIC) || (super.getOpcode() == Const.INVOKEDYNAMIC)) {
 76             sum = 0;
 77         } else {
 78             sum = 1; // this reference
 79         }
 80 
 81         final String signature = getSignature(cpg);
 82         sum += Type.getArgumentTypesSize(signature);
 83         return sum;
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2017, 2020, Oracle and/or its affiliates. All rights reserved.</span>

  3  */
  4 /*
  5  * Licensed to the Apache Software Foundation (ASF) under one or more
  6  * contributor license agreements.  See the NOTICE file distributed with
  7  * this work for additional information regarding copyright ownership.
  8  * The ASF licenses this file to You under the Apache License, Version 2.0
  9  * (the &quot;License&quot;); you may not use this file except in compliance with
 10  * the License.  You may obtain a copy of the License at
 11  *
 12  *      http://www.apache.org/licenses/LICENSE-2.0
 13  *
 14  * Unless required by applicable law or agreed to in writing, software
 15  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 16  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 17  * See the License for the specific language governing permissions and
 18  * limitations under the License.
 19  */
 20 
 21 package com.sun.org.apache.bcel.internal.generic;
 22 
 23 import java.util.StringTokenizer;
 24 
 25 import com.sun.org.apache.bcel.internal.Const;
 26 import com.sun.org.apache.bcel.internal.classfile.Constant;
 27 import com.sun.org.apache.bcel.internal.classfile.ConstantCP;
 28 import com.sun.org.apache.bcel.internal.classfile.ConstantPool;
 29 
 30 /**
 31  * Super class for the INVOKExxx family of instructions.
 32  *
<span class="line-modified"> 33  * @LastModified: Jan 2020</span>
 34  */
 35 public abstract class InvokeInstruction extends FieldOrMethod implements ExceptionThrower,
 36         StackConsumer, StackProducer {
 37 
 38     /**
<span class="line-modified"> 39      * Empty constructor needed for Instruction.readInstruction.</span>
<span class="line-modified"> 40      * Not to be used otherwise.</span>
 41      */
 42     InvokeInstruction() {
 43     }
 44 
 45 
 46     /**
 47      * @param index to constant pool
 48      */
 49     protected InvokeInstruction(final short opcode, final int index) {
 50         super(opcode, index);
 51     }
 52 
 53 
 54     /**
 55      * @return mnemonic for instruction with symbolic references resolved
 56      */
 57     @Override
 58     public String toString( final ConstantPool cp ) {
 59         final Constant c = cp.getConstant(super.getIndex());
 60         final StringTokenizer tok = new StringTokenizer(cp.constantToString(c));
<span class="line-modified"> 61 </span>
<span class="line-modified"> 62         final String opcodeName = Const.getOpcodeName(super.getOpcode());</span>
<span class="line-added"> 63 </span>
<span class="line-added"> 64         final StringBuilder sb = new StringBuilder(opcodeName);</span>
<span class="line-added"> 65         if (tok.hasMoreTokens()) {</span>
<span class="line-added"> 66             sb.append(&quot; &quot;);</span>
<span class="line-added"> 67             sb.append(tok.nextToken().replace(&#39;.&#39;, &#39;/&#39;));</span>
<span class="line-added"> 68             if (tok.hasMoreTokens()) {</span>
<span class="line-added"> 69                 sb.append(tok.nextToken());</span>
<span class="line-added"> 70             }</span>
<span class="line-added"> 71         }</span>
<span class="line-added"> 72 </span>
<span class="line-added"> 73         return sb.toString();</span>
 74     }
 75 
 76 
 77     /**
 78      * Also works for instructions whose stack effect depends on the
 79      * constant pool entry they reference.
 80      * @return Number of words consumed from stack by this instruction
 81      */
 82     @Override
 83     public int consumeStack( final ConstantPoolGen cpg ) {
 84         int sum;
 85         if ((super.getOpcode() == Const.INVOKESTATIC) || (super.getOpcode() == Const.INVOKEDYNAMIC)) {
 86             sum = 0;
 87         } else {
 88             sum = 1; // this reference
 89         }
 90 
 91         final String signature = getSignature(cpg);
 92         sum += Type.getArgumentTypesSize(signature);
 93         return sum;
</pre>
</td>
</tr>
</table>
<center><a href="InstructionTargeter.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="JSR.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>