<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.xml/share/classes/com/sun/org/apache/bcel/internal/util/Class2HTML.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ByteSequence.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="ClassQueue.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml/share/classes/com/sun/org/apache/bcel/internal/util/Class2HTML.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2017, Oracle and/or its affiliates. All rights reserved.</span>
   */
  /*
   * Licensed to the Apache Software Foundation (ASF) under one or more
   * contributor license agreements.  See the NOTICE file distributed with
   * this work for additional information regarding copyright ownership.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2017, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   */
  /*
   * Licensed to the Apache Software Foundation (ASF) under one or more
   * contributor license agreements.  See the NOTICE file distributed with
   * this work for additional information regarding copyright ownership.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 35,28 ***</span>
  import com.sun.org.apache.bcel.internal.classfile.Utility;
  
  /**
   * Read class file(s) and convert them into HTML files.
   *
<span class="line-modified">!  * Given a JavaClass object &quot;class&quot; that is in package &quot;package&quot; five files will</span>
<span class="line-modified">!  * be created in the specified directory.</span>
   *
   * &lt;OL&gt;
<span class="line-modified">!  * &lt;LI&gt; &quot;package&quot;.&quot;class&quot;.html as the main file which defines the frames for the</span>
<span class="line-modified">!  * following subfiles.</span>
<span class="line-modified">!  * &lt;LI&gt; &quot;package&quot;.&quot;class&quot;_attributes.html contains all (known) attributes found</span>
<span class="line-modified">!  * in the file</span>
<span class="line-modified">!  * &lt;LI&gt; &quot;package&quot;.&quot;class&quot;_cp.html contains the constant pool</span>
<span class="line-modified">!  * &lt;LI&gt; &quot;package&quot;.&quot;class&quot;_code.html contains the byte code</span>
<span class="line-removed">-  * &lt;LI&gt; &quot;package&quot;.&quot;class&quot;_methods.html contains references to all methods and</span>
<span class="line-removed">-  * fields of the class</span>
   * &lt;/OL&gt;
   *
<span class="line-modified">!  * All subfiles reference each other appropriately, e.g. clicking on a method in</span>
<span class="line-modified">!  * the Method&#39;s frame will jump to the appropriate method in the Code frame.</span>
   *
<span class="line-modified">!  * @version $Id: Class2HTML.java 1749603 2016-06-21 20:50:19Z ggregory $</span>
   */
  public class Class2HTML {
  
      private final JavaClass java_class; // current class object
      private final String dir;
<span class="line-new-header">--- 35,27 ---</span>
  import com.sun.org.apache.bcel.internal.classfile.Utility;
  
  /**
   * Read class file(s) and convert them into HTML files.
   *
<span class="line-modified">!  * Given a JavaClass object &quot;class&quot; that is in package &quot;package&quot; five files</span>
<span class="line-modified">!  * will be created in the specified directory.</span>
   *
   * &lt;OL&gt;
<span class="line-modified">!  * &lt;LI&gt; &quot;package&quot;.&quot;class&quot;.html as the main file which defines the frames for</span>
<span class="line-modified">!  * the following subfiles.</span>
<span class="line-modified">!  * &lt;LI&gt;  &quot;package&quot;.&quot;class&quot;_attributes.html contains all (known) attributes found in the file</span>
<span class="line-modified">!  * &lt;LI&gt;  &quot;package&quot;.&quot;class&quot;_cp.html contains the constant pool</span>
<span class="line-modified">!  * &lt;LI&gt;  &quot;package&quot;.&quot;class&quot;_code.html contains the byte code</span>
<span class="line-modified">!  * &lt;LI&gt;  &quot;package&quot;.&quot;class&quot;_methods.html contains references to all methods and fields of the class</span>
   * &lt;/OL&gt;
   *
<span class="line-modified">!  * All subfiles reference each other appropriately, e.g. clicking on a</span>
<span class="line-modified">!  * method in the Method&#39;s frame will jump to the appropriate method in</span>
<span class="line-added">+  * the Code frame.</span>
   *
<span class="line-modified">!  * @LastModified: Jan 2020</span>
   */
  public class Class2HTML {
  
      private final JavaClass java_class; // current class object
      private final String dir;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 109,11 ***</span>
          writeMainHTML(attribute_html);
          new CodeHTML(dir, class_name, methods, constant_pool, constant_html);
          attribute_html.close();
      }
  
<span class="line-modified">!     public static void _main(final String[] argv) throws IOException {</span>
          final String[] file_name = new String[argv.length];
          int files = 0;
          ClassParser parser = null;
          JavaClass java_class = null;
          String zip_file = null;
<span class="line-new-header">--- 108,12 ---</span>
          writeMainHTML(attribute_html);
          new CodeHTML(dir, class_name, methods, constant_pool, constant_html);
          attribute_html.close();
      }
  
<span class="line-modified">! </span>
<span class="line-added">+     public static void main( final String[] argv ) throws IOException {</span>
          final String[] file_name = new String[argv.length];
          int files = 0;
          ClassParser parser = null;
          JavaClass java_class = null;
          String zip_file = null;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 127,11 ***</span>
                      dir = argv[++i];
                      if (!dir.endsWith(&quot;&quot; + sep)) {
                          dir = dir + sep;
                      }
                      final File store = new File(dir);
<span class="line-removed">- </span>
                      if (!store.isDirectory()) {
                          final boolean created = store.mkdirs(); // Create target directory if necessary
                          if (!created) {
                              if (!store.isDirectory()) {
                                  System.out.println(&quot;Tried to create the directory &quot; + dir + &quot; but failed&quot;);
<span class="line-new-header">--- 127,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 174,11 ***</span>
          str = Utility.compactClassName(str, class_package + &quot;.&quot;, true);
          return &quot;&lt;A HREF=\&quot;&quot; + class_name + &quot;_cp.html#cp&quot; + index + &quot;\&quot; TARGET=ConstantPool&gt;&quot; + str
                  + &quot;&lt;/A&gt;&quot;;
      }
  
<span class="line-modified">!     static String referenceType(final String type) {</span>
          String short_type = Utility.compactClassName(type);
          short_type = Utility.compactClassName(short_type, class_package + &quot;.&quot;, true);
          final int index = type.indexOf(&#39;[&#39;); // Type is an array?
          String base_type = type;
          if (index &gt; -1) {
<span class="line-new-header">--- 173,12 ---</span>
          str = Utility.compactClassName(str, class_package + &quot;.&quot;, true);
          return &quot;&lt;A HREF=\&quot;&quot; + class_name + &quot;_cp.html#cp&quot; + index + &quot;\&quot; TARGET=ConstantPool&gt;&quot; + str
                  + &quot;&lt;/A&gt;&quot;;
      }
  
<span class="line-modified">! </span>
<span class="line-added">+     static String referenceType( final String type ) {</span>
          String short_type = Utility.compactClassName(type);
          short_type = Utility.compactClassName(short_type, class_package + &quot;.&quot;, true);
          final int index = type.indexOf(&#39;[&#39;); // Type is an array?
          String base_type = type;
          if (index &gt; -1) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 189,11 ***</span>
              return &quot;&lt;FONT COLOR=\&quot;#00FF00\&quot;&gt;&quot; + type + &quot;&lt;/FONT&gt;&quot;;
          }
          return &quot;&lt;A HREF=\&quot;&quot; + base_type + &quot;.html\&quot; TARGET=_top&gt;&quot; + short_type + &quot;&lt;/A&gt;&quot;;
      }
  
<span class="line-modified">!     static String toHTML(final String str) {</span>
          final StringBuilder buf = new StringBuilder();
          for (int i = 0; i &lt; str.length(); i++) {
              char ch;
              switch (ch = str.charAt(i)) {
                  case &#39;&lt;&#39;:
<span class="line-new-header">--- 189,12 ---</span>
              return &quot;&lt;FONT COLOR=\&quot;#00FF00\&quot;&gt;&quot; + type + &quot;&lt;/FONT&gt;&quot;;
          }
          return &quot;&lt;A HREF=\&quot;&quot; + base_type + &quot;.html\&quot; TARGET=_top&gt;&quot; + short_type + &quot;&lt;/A&gt;&quot;;
      }
  
<span class="line-modified">! </span>
<span class="line-added">+     static String toHTML( final String str ) {</span>
          final StringBuilder buf = new StringBuilder();
          for (int i = 0; i &lt; str.length(); i++) {
              char ch;
              switch (ch = str.charAt(i)) {
                  case &#39;&lt;&#39;:
</pre>
<hr />
<pre>
<span class="line-old-header">*** 213,11 ***</span>
              }
          }
          return buf.toString();
      }
  
<span class="line-modified">!     private void writeMainHTML(final AttributeHTML attribute_html) throws IOException {</span>
          try (PrintWriter file = new PrintWriter(new FileOutputStream(dir + class_name + &quot;.html&quot;))) {
              file.println(&quot;&lt;HTML&gt;\n&quot; + &quot;&lt;HEAD&gt;&lt;TITLE&gt;Documentation for &quot; + class_name + &quot;&lt;/TITLE&gt;&quot; + &quot;&lt;/HEAD&gt;\n&quot;
                      + &quot;&lt;FRAMESET BORDER=1 cols=\&quot;30%,*\&quot;&gt;\n&quot; + &quot;&lt;FRAMESET BORDER=1 rows=\&quot;80%,*\&quot;&gt;\n&quot;
                      + &quot;&lt;FRAME NAME=\&quot;ConstantPool\&quot; SRC=\&quot;&quot; + class_name + &quot;_cp.html&quot; + &quot;\&quot;\n MARGINWIDTH=\&quot;0\&quot; &quot;
                      + &quot;MARGINHEIGHT=\&quot;0\&quot; FRAMEBORDER=\&quot;1\&quot; SCROLLING=\&quot;AUTO\&quot;&gt;\n&quot; + &quot;&lt;FRAME NAME=\&quot;Attributes\&quot; SRC=\&quot;&quot;
<span class="line-new-header">--- 214,12 ---</span>
              }
          }
          return buf.toString();
      }
  
<span class="line-modified">! </span>
<span class="line-added">+     private void writeMainHTML( final AttributeHTML attribute_html ) throws IOException {</span>
          try (PrintWriter file = new PrintWriter(new FileOutputStream(dir + class_name + &quot;.html&quot;))) {
              file.println(&quot;&lt;HTML&gt;\n&quot; + &quot;&lt;HEAD&gt;&lt;TITLE&gt;Documentation for &quot; + class_name + &quot;&lt;/TITLE&gt;&quot; + &quot;&lt;/HEAD&gt;\n&quot;
                      + &quot;&lt;FRAMESET BORDER=1 cols=\&quot;30%,*\&quot;&gt;\n&quot; + &quot;&lt;FRAMESET BORDER=1 rows=\&quot;80%,*\&quot;&gt;\n&quot;
                      + &quot;&lt;FRAME NAME=\&quot;ConstantPool\&quot; SRC=\&quot;&quot; + class_name + &quot;_cp.html&quot; + &quot;\&quot;\n MARGINWIDTH=\&quot;0\&quot; &quot;
                      + &quot;MARGINHEIGHT=\&quot;0\&quot; FRAMEBORDER=\&quot;1\&quot; SCROLLING=\&quot;AUTO\&quot;&gt;\n&quot; + &quot;&lt;FRAME NAME=\&quot;Attributes\&quot; SRC=\&quot;&quot;
</pre>
<center><a href="ByteSequence.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="ClassQueue.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>