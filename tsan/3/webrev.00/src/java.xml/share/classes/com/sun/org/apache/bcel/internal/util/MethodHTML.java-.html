<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/java.xml/share/classes/com/sun/org/apache/bcel/internal/util/MethodHTML.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * reserved comment block
  3  * DO NOT REMOVE OR ALTER!
  4  */
  5 /*
  6  * Licensed to the Apache Software Foundation (ASF) under one or more
  7  * contributor license agreements.  See the NOTICE file distributed with
  8  * this work for additional information regarding copyright ownership.
  9  * The ASF licenses this file to You under the Apache License, Version 2.0
 10  * (the &quot;License&quot;); you may not use this file except in compliance with
 11  * the License.  You may obtain a copy of the License at
 12  *
 13  *      http://www.apache.org/licenses/LICENSE-2.0
 14  *
 15  * Unless required by applicable law or agreed to in writing, software
 16  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 17  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 18  * See the License for the specific language governing permissions and
 19  * limitations under the License.
 20  */
 21 
 22 package com.sun.org.apache.bcel.internal.util;
 23 
 24 import java.io.FileOutputStream;
 25 import java.io.IOException;
 26 import java.io.PrintWriter;
 27 
 28 import com.sun.org.apache.bcel.internal.Const;
 29 import com.sun.org.apache.bcel.internal.classfile.Attribute;
 30 import com.sun.org.apache.bcel.internal.classfile.Code;
 31 import com.sun.org.apache.bcel.internal.classfile.ConstantValue;
 32 import com.sun.org.apache.bcel.internal.classfile.ExceptionTable;
 33 import com.sun.org.apache.bcel.internal.classfile.Field;
 34 import com.sun.org.apache.bcel.internal.classfile.Method;
 35 import com.sun.org.apache.bcel.internal.classfile.Utility;
 36 
 37 /**
 38  * Convert methods and fields into HTML file.
 39  *
 40  * @version $Id: MethodHTML.java 1749603 2016-06-21 20:50:19Z ggregory $
 41  *
 42  */
 43 final class MethodHTML {
 44 
 45     private final String class_name; // name of current class
 46     private final PrintWriter file; // file to write to
 47     private final ConstantHTML constant_html;
 48     private final AttributeHTML attribute_html;
 49 
 50 
 51     MethodHTML(final String dir, final String class_name, final Method[] methods, final Field[] fields,
 52             final ConstantHTML constant_html, final AttributeHTML attribute_html) throws IOException {
 53         this.class_name = class_name;
 54         this.attribute_html = attribute_html;
 55         this.constant_html = constant_html;
 56         file = new PrintWriter(new FileOutputStream(dir + class_name + &quot;_methods.html&quot;));
 57         file.println(&quot;&lt;HTML&gt;&lt;BODY BGCOLOR=\&quot;#C0C0C0\&quot;&gt;&lt;TABLE BORDER=0&gt;&quot;);
 58         file.println(&quot;&lt;TR&gt;&lt;TH ALIGN=LEFT&gt;Access&amp;nbsp;flags&lt;/TH&gt;&lt;TH ALIGN=LEFT&gt;Type&lt;/TH&gt;&quot;
 59                 + &quot;&lt;TH ALIGN=LEFT&gt;Field&amp;nbsp;name&lt;/TH&gt;&lt;/TR&gt;&quot;);
 60         for (final Field field : fields) {
 61             writeField(field);
 62         }
 63         file.println(&quot;&lt;/TABLE&gt;&quot;);
 64         file.println(&quot;&lt;TABLE BORDER=0&gt;&lt;TR&gt;&lt;TH ALIGN=LEFT&gt;Access&amp;nbsp;flags&lt;/TH&gt;&quot;
 65                 + &quot;&lt;TH ALIGN=LEFT&gt;Return&amp;nbsp;type&lt;/TH&gt;&lt;TH ALIGN=LEFT&gt;Method&amp;nbsp;name&lt;/TH&gt;&quot;
 66                 + &quot;&lt;TH ALIGN=LEFT&gt;Arguments&lt;/TH&gt;&lt;/TR&gt;&quot;);
 67         for (int i = 0; i &lt; methods.length; i++) {
 68             writeMethod(methods[i], i);
 69         }
 70         file.println(&quot;&lt;/TABLE&gt;&lt;/BODY&gt;&lt;/HTML&gt;&quot;);
 71         file.close();
 72     }
 73 
 74 
 75     /**
 76      * Print field of class.
 77      *
 78      * @param field field to print
 79      * @throws java.io.IOException
 80      */
 81     private void writeField( final Field field ) throws IOException {
 82         final String type = Utility.signatureToString(field.getSignature());
 83         final String name = field.getName();
 84         String access = Utility.accessToString(field.getAccessFlags());
 85         Attribute[] attributes;
 86         access = Utility.replace(access, &quot; &quot;, &quot;&amp;nbsp;&quot;);
 87         file.print(&quot;&lt;TR&gt;&lt;TD&gt;&lt;FONT COLOR=\&quot;#FF0000\&quot;&gt;&quot; + access + &quot;&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD&gt;&quot;
 88                 + Class2HTML.referenceType(type) + &quot;&lt;/TD&gt;&lt;TD&gt;&lt;A NAME=\&quot;field&quot; + name + &quot;\&quot;&gt;&quot; + name
 89                 + &quot;&lt;/A&gt;&lt;/TD&gt;&quot;);
 90         attributes = field.getAttributes();
 91         // Write them to the Attributes.html file with anchor &quot;&lt;name&gt;[&lt;i&gt;]&quot;
 92         for (int i = 0; i &lt; attributes.length; i++) {
 93             attribute_html.writeAttribute(attributes[i], name + &quot;@&quot; + i);
 94         }
 95         for (int i = 0; i &lt; attributes.length; i++) {
 96             if (attributes[i].getTag() == Const.ATTR_CONSTANT_VALUE) { // Default value
 97                 final String str = ((ConstantValue) attributes[i]).toString();
 98                 // Reference attribute in _attributes.html
 99                 file.print(&quot;&lt;TD&gt;= &lt;A HREF=\&quot;&quot; + class_name + &quot;_attributes.html#&quot; + name + &quot;@&quot; + i
100                         + &quot;\&quot; TARGET=\&quot;Attributes\&quot;&gt;&quot; + str + &quot;&lt;/TD&gt;\n&quot;);
101                 break;
102             }
103         }
104         file.println(&quot;&lt;/TR&gt;&quot;);
105     }
106 
107 
108     private void writeMethod( final Method method, final int method_number ) {
109         // Get raw signature
110         final String signature = method.getSignature();
111         // Get array of strings containing the argument types
112         final String[] args = Utility.methodSignatureArgumentTypes(signature, false);
113         // Get return type string
114         final String type = Utility.methodSignatureReturnType(signature, false);
115         // Get method name
116         final String name = method.getName();
117         String html_name;
118         // Get method&#39;s access flags
119         String access = Utility.accessToString(method.getAccessFlags());
120         // Get the method&#39;s attributes, the Code Attribute in particular
121         final Attribute[] attributes = method.getAttributes();
122         /* HTML doesn&#39;t like names like &lt;clinit&gt; and spaces are places to break
123          * lines. Both we don&#39;t want...
124          */
125         access = Utility.replace(access, &quot; &quot;, &quot;&amp;nbsp;&quot;);
126         html_name = Class2HTML.toHTML(name);
127         file.print(&quot;&lt;TR VALIGN=TOP&gt;&lt;TD&gt;&lt;FONT COLOR=\&quot;#FF0000\&quot;&gt;&lt;A NAME=method&quot; + method_number
128                 + &quot;&gt;&quot; + access + &quot;&lt;/A&gt;&lt;/FONT&gt;&lt;/TD&gt;&quot;);
129         file.print(&quot;&lt;TD&gt;&quot; + Class2HTML.referenceType(type) + &quot;&lt;/TD&gt;&lt;TD&gt;&quot; + &quot;&lt;A HREF=&quot; + class_name
130                 + &quot;_code.html#method&quot; + method_number + &quot; TARGET=Code&gt;&quot; + html_name
131                 + &quot;&lt;/A&gt;&lt;/TD&gt;\n&lt;TD&gt;(&quot;);
132         for (int i = 0; i &lt; args.length; i++) {
133             file.print(Class2HTML.referenceType(args[i]));
134             if (i &lt; args.length - 1) {
135                 file.print(&quot;, &quot;);
136             }
137         }
138         file.print(&quot;)&lt;/TD&gt;&lt;/TR&gt;&quot;);
139         // Check for thrown exceptions
140         for (int i = 0; i &lt; attributes.length; i++) {
141             attribute_html.writeAttribute(attributes[i], &quot;method&quot; + method_number + &quot;@&quot; + i,
142                     method_number);
143             final byte tag = attributes[i].getTag();
144             if (tag == Const.ATTR_EXCEPTIONS) {
145                 file.print(&quot;&lt;TR VALIGN=TOP&gt;&lt;TD COLSPAN=2&gt;&lt;/TD&gt;&lt;TH ALIGN=LEFT&gt;throws&lt;/TH&gt;&lt;TD&gt;&quot;);
146                 final int[] exceptions = ((ExceptionTable) attributes[i]).getExceptionIndexTable();
147                 for (int j = 0; j &lt; exceptions.length; j++) {
148                     file.print(constant_html.referenceConstant(exceptions[j]));
149                     if (j &lt; exceptions.length - 1) {
150                         file.print(&quot;, &quot;);
151                     }
152                 }
153                 file.println(&quot;&lt;/TD&gt;&lt;/TR&gt;&quot;);
154             } else if (tag == Const.ATTR_CODE) {
155                 final Attribute[] c_a = ((Code) attributes[i]).getAttributes();
156                 for (int j = 0; j &lt; c_a.length; j++) {
157                     attribute_html.writeAttribute(c_a[j], &quot;method&quot; + method_number + &quot;@&quot; + i + &quot;@&quot;
158                             + j, method_number);
159                 }
160             }
161         }
162     }
163 }
    </pre>
  </body>
</html>