<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.xml/share/classes/com/sun/org/apache/bcel/internal/classfile/Signature.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="RuntimeVisibleParameterAnnotations.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="SourceFile.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml/share/classes/com/sun/org/apache/bcel/internal/classfile/Signature.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 15  * Unless required by applicable law or agreed to in writing, software
 16  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 17  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 18  * See the License for the specific language governing permissions and
 19  * limitations under the License.
 20  */
 21 
 22 package com.sun.org.apache.bcel.internal.classfile;
 23 
 24 import java.io.ByteArrayInputStream;
 25 import java.io.DataInput;
 26 import java.io.DataOutputStream;
 27 import java.io.IOException;
 28 
 29 import com.sun.org.apache.bcel.internal.Const;
 30 
 31 /**
 32  * This class is derived from &lt;em&gt;Attribute&lt;/em&gt; and represents a reference
 33  * to a GJ attribute.
 34  *
<span class="line-removed"> 35  * @version $Id: Signature.java 1749603 2016-06-21 20:50:19Z ggregory $</span>
 36  * @see     Attribute
 37  */
 38 public final class Signature extends Attribute {
 39 
 40     private int signature_index;
 41 
 42 
 43     /**
 44      * Initialize from another object. Note that both objects use the same
 45      * references (shallow copy). Use clone() for a physical copy.
 46      */
 47     public Signature(final Signature c) {
 48         this(c.getNameIndex(), c.getLength(), c.getSignatureIndex(), c.getConstantPool());
 49     }
 50 
 51 
 52     /**
 53      * Construct object from file stream.
 54      * @param name_index Index in constant pool to CONSTANT_Utf8
 55      * @param length Content length in bytes
</pre>
<hr />
<pre>
 79      * Called by objects that are traversing the nodes of the tree implicitely
 80      * defined by the contents of a Java class. I.e., the hierarchy of methods,
 81      * fields, attributes, etc. spawns a tree of objects.
 82      *
 83      * @param v Visitor object
 84      */
 85     @Override
 86     public void accept( final Visitor v ) {
 87         //System.err.println(&quot;Visiting non-standard Signature object&quot;);
 88         v.visitSignature(this);
 89     }
 90 
 91 
 92     /**
 93      * Dump source file attribute to file stream in binary format.
 94      *
 95      * @param file Output file stream
 96      * @throws IOException
 97      */
 98     @Override
<span class="line-modified"> 99     public final void dump( final DataOutputStream file ) throws IOException {</span>
100         super.dump(file);
101         file.writeShort(signature_index);
102     }
103 
104 
105     /**
106      * @return Index in constant pool of source file name.
107      */
<span class="line-modified">108     public final int getSignatureIndex() {</span>
109         return signature_index;
110     }
111 
112 
113     /**
114      * @param signature_index the index info the constant pool of this signature
115      */
<span class="line-modified">116     public final void setSignatureIndex( final int signature_index ) {</span>
117         this.signature_index = signature_index;
118     }
119 
120 
121     /**
122      * @return GJ signature.
123      */
<span class="line-modified">124     public final String getSignature() {</span>
125         final ConstantUtf8 c = (ConstantUtf8) super.getConstantPool().getConstant(signature_index,
126                 Const.CONSTANT_Utf8);
127         return c.getBytes();
128     }
129 
130     /**
131      * Extends ByteArrayInputStream to make &#39;unreading&#39; chars possible.
132      */
133     private static final class MyByteArrayInputStream extends ByteArrayInputStream {
134 
135         MyByteArrayInputStream(final String data) {
136             super(data.getBytes());
137         }
138 
139 
<span class="line-modified">140         final String getData() {</span>
141             return new String(buf);
142         }
143 
144 
<span class="line-modified">145         final void unread() {</span>
146             if (pos &gt; 0) {
147                 pos--;
148             }
149         }
150     }
151 
152 
153     private static boolean identStart( final int ch ) {
154         return ch == &#39;T&#39; || ch == &#39;L&#39;;
155     }
156 
157 
158     private static void matchIdent( final MyByteArrayInputStream in, final StringBuilder buf ) {
159         int ch;
160         if ((ch = in.read()) == -1) {
161             throw new RuntimeException(&quot;Illegal signature: &quot; + in.getData()
162                     + &quot; no ident, reaching EOF&quot;);
163         }
164         //System.out.println(&quot;return from ident:&quot; + (char)ch);
165         if (!identStart(ch)) {
</pre>
<hr />
<pre>
241         return buf.toString();
242     }
243 
244 
245     // @since 6.0 is no longer final
246     public static boolean isFormalParameterList( final String s ) {
247         return s.startsWith(&quot;&lt;&quot;) &amp;&amp; (s.indexOf(&#39;:&#39;) &gt; 0);
248     }
249 
250 
251     // @since 6.0 is no longer final
252     public static boolean isActualParameterList( final String s ) {
253         return s.startsWith(&quot;L&quot;) &amp;&amp; s.endsWith(&quot;&gt;;&quot;);
254     }
255 
256 
257     /**
258      * @return String representation
259      */
260     @Override
<span class="line-modified">261     public final String toString() {</span>
262         final String s = getSignature();
263         return &quot;Signature: &quot; + s;
264     }
265 
266 
267     /**
268      * @return deep copy of this attribute
269      */
270     @Override
271     public Attribute copy( final ConstantPool _constant_pool ) {
272         return (Attribute) clone();
273     }
274 }
</pre>
</td>
<td>
<hr />
<pre>
 15  * Unless required by applicable law or agreed to in writing, software
 16  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 17  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 18  * See the License for the specific language governing permissions and
 19  * limitations under the License.
 20  */
 21 
 22 package com.sun.org.apache.bcel.internal.classfile;
 23 
 24 import java.io.ByteArrayInputStream;
 25 import java.io.DataInput;
 26 import java.io.DataOutputStream;
 27 import java.io.IOException;
 28 
 29 import com.sun.org.apache.bcel.internal.Const;
 30 
 31 /**
 32  * This class is derived from &lt;em&gt;Attribute&lt;/em&gt; and represents a reference
 33  * to a GJ attribute.
 34  *

 35  * @see     Attribute
 36  */
 37 public final class Signature extends Attribute {
 38 
 39     private int signature_index;
 40 
 41 
 42     /**
 43      * Initialize from another object. Note that both objects use the same
 44      * references (shallow copy). Use clone() for a physical copy.
 45      */
 46     public Signature(final Signature c) {
 47         this(c.getNameIndex(), c.getLength(), c.getSignatureIndex(), c.getConstantPool());
 48     }
 49 
 50 
 51     /**
 52      * Construct object from file stream.
 53      * @param name_index Index in constant pool to CONSTANT_Utf8
 54      * @param length Content length in bytes
</pre>
<hr />
<pre>
 78      * Called by objects that are traversing the nodes of the tree implicitely
 79      * defined by the contents of a Java class. I.e., the hierarchy of methods,
 80      * fields, attributes, etc. spawns a tree of objects.
 81      *
 82      * @param v Visitor object
 83      */
 84     @Override
 85     public void accept( final Visitor v ) {
 86         //System.err.println(&quot;Visiting non-standard Signature object&quot;);
 87         v.visitSignature(this);
 88     }
 89 
 90 
 91     /**
 92      * Dump source file attribute to file stream in binary format.
 93      *
 94      * @param file Output file stream
 95      * @throws IOException
 96      */
 97     @Override
<span class="line-modified"> 98     public void dump( final DataOutputStream file ) throws IOException {</span>
 99         super.dump(file);
100         file.writeShort(signature_index);
101     }
102 
103 
104     /**
105      * @return Index in constant pool of source file name.
106      */
<span class="line-modified">107     public int getSignatureIndex() {</span>
108         return signature_index;
109     }
110 
111 
112     /**
113      * @param signature_index the index info the constant pool of this signature
114      */
<span class="line-modified">115     public void setSignatureIndex( final int signature_index ) {</span>
116         this.signature_index = signature_index;
117     }
118 
119 
120     /**
121      * @return GJ signature.
122      */
<span class="line-modified">123     public String getSignature() {</span>
124         final ConstantUtf8 c = (ConstantUtf8) super.getConstantPool().getConstant(signature_index,
125                 Const.CONSTANT_Utf8);
126         return c.getBytes();
127     }
128 
129     /**
130      * Extends ByteArrayInputStream to make &#39;unreading&#39; chars possible.
131      */
132     private static final class MyByteArrayInputStream extends ByteArrayInputStream {
133 
134         MyByteArrayInputStream(final String data) {
135             super(data.getBytes());
136         }
137 
138 
<span class="line-modified">139         String getData() {</span>
140             return new String(buf);
141         }
142 
143 
<span class="line-modified">144         void unread() {</span>
145             if (pos &gt; 0) {
146                 pos--;
147             }
148         }
149     }
150 
151 
152     private static boolean identStart( final int ch ) {
153         return ch == &#39;T&#39; || ch == &#39;L&#39;;
154     }
155 
156 
157     private static void matchIdent( final MyByteArrayInputStream in, final StringBuilder buf ) {
158         int ch;
159         if ((ch = in.read()) == -1) {
160             throw new RuntimeException(&quot;Illegal signature: &quot; + in.getData()
161                     + &quot; no ident, reaching EOF&quot;);
162         }
163         //System.out.println(&quot;return from ident:&quot; + (char)ch);
164         if (!identStart(ch)) {
</pre>
<hr />
<pre>
240         return buf.toString();
241     }
242 
243 
244     // @since 6.0 is no longer final
245     public static boolean isFormalParameterList( final String s ) {
246         return s.startsWith(&quot;&lt;&quot;) &amp;&amp; (s.indexOf(&#39;:&#39;) &gt; 0);
247     }
248 
249 
250     // @since 6.0 is no longer final
251     public static boolean isActualParameterList( final String s ) {
252         return s.startsWith(&quot;L&quot;) &amp;&amp; s.endsWith(&quot;&gt;;&quot;);
253     }
254 
255 
256     /**
257      * @return String representation
258      */
259     @Override
<span class="line-modified">260     public String toString() {</span>
261         final String s = getSignature();
262         return &quot;Signature: &quot; + s;
263     }
264 
265 
266     /**
267      * @return deep copy of this attribute
268      */
269     @Override
270     public Attribute copy( final ConstantPool _constant_pool ) {
271         return (Attribute) clone();
272     }
273 }
</pre>
</td>
</tr>
</table>
<center><a href="RuntimeVisibleParameterAnnotations.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="SourceFile.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>