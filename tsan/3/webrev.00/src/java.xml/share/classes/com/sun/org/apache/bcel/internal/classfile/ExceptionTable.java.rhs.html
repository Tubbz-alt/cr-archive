<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.xml/share/classes/com/sun/org/apache/bcel/internal/classfile/ExceptionTable.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * reserved comment block
  3  * DO NOT REMOVE OR ALTER!
  4  */
  5 /*
  6  * Licensed to the Apache Software Foundation (ASF) under one or more
  7  * contributor license agreements.  See the NOTICE file distributed with
  8  * this work for additional information regarding copyright ownership.
  9  * The ASF licenses this file to You under the Apache License, Version 2.0
 10  * (the &quot;License&quot;); you may not use this file except in compliance with
 11  * the License.  You may obtain a copy of the License at
 12  *
 13  *      http://www.apache.org/licenses/LICENSE-2.0
 14  *
 15  * Unless required by applicable law or agreed to in writing, software
 16  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 17  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 18  * See the License for the specific language governing permissions and
 19  * limitations under the License.
 20  */
 21 
 22 package com.sun.org.apache.bcel.internal.classfile;
 23 
 24 import java.io.DataInput;
 25 import java.io.DataOutputStream;
 26 import java.io.IOException;
 27 
 28 import com.sun.org.apache.bcel.internal.Const;
 29 
 30 /**
 31  * This class represents the table of exceptions that are thrown by a
 32  * method. This attribute may be used once per method.  The name of
 33  * this class is &lt;em&gt;ExceptionTable&lt;/em&gt; for historical reasons; The
 34  * Java Virtual Machine Specification, Second Edition defines this
 35  * attribute using the name &lt;em&gt;Exceptions&lt;/em&gt; (which is inconsistent
 36  * with the other classes).
 37  *
<a name="1" id="anc1"></a>
 38  * @see     Code
 39  */
 40 public final class ExceptionTable extends Attribute {
 41 
 42     private int[] exception_index_table; // constant pool
 43 
 44 
 45     /**
 46      * Initialize from another object. Note that both objects use the same
 47      * references (shallow copy). Use copy() for a physical copy.
 48      */
 49     public ExceptionTable(final ExceptionTable c) {
 50         this(c.getNameIndex(), c.getLength(), c.getExceptionIndexTable(), c.getConstantPool());
 51     }
 52 
 53 
 54     /**
 55      * @param name_index Index in constant pool
 56      * @param length Content length in bytes
 57      * @param exception_index_table Table of indices in constant pool
 58      * @param constant_pool Array of constants
 59      */
 60     public ExceptionTable(final int name_index, final int length, final int[] exception_index_table,
 61             final ConstantPool constant_pool) {
 62         super(Const.ATTR_EXCEPTIONS, name_index, length, constant_pool);
 63         this.exception_index_table = exception_index_table != null ? exception_index_table : new int[0];
 64     }
 65 
 66 
 67     /**
 68      * Construct object from input stream.
 69      * @param name_index Index in constant pool
 70      * @param length Content length in bytes
 71      * @param input Input stream
 72      * @param constant_pool Array of constants
 73      * @throws IOException
 74      */
 75     ExceptionTable(final int name_index, final int length, final DataInput input, final ConstantPool constant_pool) throws IOException {
 76         this(name_index, length, (int[]) null, constant_pool);
 77         final int number_of_exceptions = input.readUnsignedShort();
 78         exception_index_table = new int[number_of_exceptions];
 79         for (int i = 0; i &lt; number_of_exceptions; i++) {
 80             exception_index_table[i] = input.readUnsignedShort();
 81         }
 82     }
 83 
 84 
 85     /**
 86      * Called by objects that are traversing the nodes of the tree implicitely
 87      * defined by the contents of a Java class. I.e., the hierarchy of methods,
 88      * fields, attributes, etc. spawns a tree of objects.
 89      *
 90      * @param v Visitor object
 91      */
 92     @Override
 93     public void accept( final Visitor v ) {
 94         v.visitExceptionTable(this);
 95     }
 96 
 97 
 98     /**
 99      * Dump exceptions attribute to file stream in binary format.
100      *
101      * @param file Output file stream
102      * @throws IOException
103      */
104     @Override
<a name="2" id="anc2"></a><span class="line-modified">105     public void dump( final DataOutputStream file ) throws IOException {</span>
106         super.dump(file);
107         file.writeShort(exception_index_table.length);
108         for (final int index : exception_index_table) {
109             file.writeShort(index);
110         }
111     }
112 
113 
114     /**
115      * @return Array of indices into constant pool of thrown exceptions.
116      */
<a name="3" id="anc3"></a><span class="line-modified">117     public int[] getExceptionIndexTable() {</span>
118         return exception_index_table;
119     }
120 
121 
122     /**
123      * @return Length of exception table.
124      */
<a name="4" id="anc4"></a><span class="line-modified">125     public int getNumberOfExceptions() {</span>
126         return exception_index_table == null ? 0 : exception_index_table.length;
127     }
128 
129 
130     /**
131      * @return class names of thrown exceptions
132      */
<a name="5" id="anc5"></a><span class="line-modified">133     public String[] getExceptionNames() {</span>
134         final String[] names = new String[exception_index_table.length];
135         for (int i = 0; i &lt; exception_index_table.length; i++) {
136             names[i] = super.getConstantPool().getConstantString(exception_index_table[i],
137                     Const.CONSTANT_Class).replace(&#39;/&#39;, &#39;.&#39;);
138         }
139         return names;
140     }
141 
142 
143     /**
144      * @param exception_index_table the list of exception indexes
145      * Also redefines number_of_exceptions according to table length.
146      */
<a name="6" id="anc6"></a><span class="line-modified">147     public void setExceptionIndexTable( final int[] exception_index_table ) {</span>
148         this.exception_index_table = exception_index_table != null ? exception_index_table : new int[0];
149     }
150 
151 
152     /**
153      * @return String representation, i.e., a list of thrown exceptions.
154      */
155     @Override
<a name="7" id="anc7"></a><span class="line-modified">156     public String toString() {</span>
157         final StringBuilder buf = new StringBuilder();
158         String str;
159         buf.append(&quot;Exceptions: &quot;);
160         for (int i = 0; i &lt; exception_index_table.length; i++) {
161             str = super.getConstantPool().getConstantString(exception_index_table[i], Const.CONSTANT_Class);
162             buf.append(Utility.compactClassName(str, false));
163             if (i &lt; exception_index_table.length - 1) {
164                 buf.append(&quot;, &quot;);
165             }
166         }
167         return buf.toString();
168     }
169 
170 
171     /**
172      * @return deep copy of this attribute
173      */
174     @Override
175     public Attribute copy( final ConstantPool _constant_pool ) {
176         final ExceptionTable c = (ExceptionTable) clone();
177         if (exception_index_table != null) {
178             c.exception_index_table = new int[exception_index_table.length];
179             System.arraycopy(exception_index_table, 0, c.exception_index_table, 0,
180                     exception_index_table.length);
181         }
182         c.setConstantPool(_constant_pool);
183         return c;
184     }
185 }
<a name="8" id="anc8"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="8" type="hidden" />
</body>
</html>