<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.xml/share/classes/com/sun/org/apache/xerces/internal/dom/DOMConfigurationImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="CoreDocumentImpl.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="DOMNormalizer.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml/share/classes/com/sun/org/apache/xerces/internal/dom/DOMConfigurationImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2013, 2017, Oracle and/or its affiliates. All rights reserved.</span>
   */
  /*
   * Licensed to the Apache Software Foundation (ASF) under one or more
   * contributor license agreements.  See the NOTICE file distributed with
   * this work for additional information regarding copyright ownership.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2013, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   */
  /*
   * Licensed to the Apache Software Foundation (ASF) under one or more
   * contributor license agreements.  See the NOTICE file distributed with
   * this work for additional information regarding copyright ownership.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 30,11 ***</span>
  import com.sun.org.apache.xerces.internal.util.DOMErrorHandlerWrapper;
  import com.sun.org.apache.xerces.internal.util.MessageFormatter;
  import com.sun.org.apache.xerces.internal.util.ParserConfigurationSettings;
  import com.sun.org.apache.xerces.internal.util.PropertyState;
  import com.sun.org.apache.xerces.internal.util.SymbolTable;
<span class="line-removed">- import com.sun.org.apache.xerces.internal.utils.ObjectFactory;</span>
  import com.sun.org.apache.xerces.internal.utils.XMLSecurityManager;
  import com.sun.org.apache.xerces.internal.utils.XMLSecurityPropertyManager;
  import com.sun.org.apache.xerces.internal.xni.XMLDTDContentModelHandler;
  import com.sun.org.apache.xerces.internal.xni.XMLDTDHandler;
  import com.sun.org.apache.xerces.internal.xni.XMLDocumentHandler;
<span class="line-new-header">--- 30,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 50,10 ***</span>
<span class="line-new-header">--- 49,11 ---</span>
  import java.io.IOException;
  import java.util.ArrayList;
  import java.util.HashMap;
  import java.util.List;
  import java.util.Locale;
<span class="line-added">+ import java.util.StringTokenizer;</span>
  import javax.xml.XMLConstants;
  import javax.xml.catalog.CatalogFeatures;
  import jdk.xml.internal.JdkXmlUtils;
  import org.w3c.dom.DOMConfiguration;
  import org.w3c.dom.DOMErrorHandler;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 68,19 ***</span>
   *
   * @xerces.internal
   *
   * @author Elena Litani, IBM
   * @author Neeraj Bajaj, Sun Microsystems.
<span class="line-modified">!  * @LastModified: Oct 2017</span>
   */
  public class DOMConfigurationImpl extends ParserConfigurationSettings
      implements XMLParserConfiguration, DOMConfiguration {
  
      //
      // Constants
      //
  
      // feature identifiers
  
      /** Feature identifier: validation. */
      protected static final String XERCES_VALIDATION =
          Constants.SAX_FEATURE_PREFIX + Constants.VALIDATION_FEATURE;
<span class="line-new-header">--- 68,22 ---</span>
   *
   * @xerces.internal
   *
   * @author Elena Litani, IBM
   * @author Neeraj Bajaj, Sun Microsystems.
<span class="line-modified">!  * @LastModified: Apr 2019</span>
   */
  public class DOMConfigurationImpl extends ParserConfigurationSettings
      implements XMLParserConfiguration, DOMConfiguration {
  
      //
      // Constants
      //
  
<span class="line-added">+     protected static final String XML11_DATATYPE_VALIDATOR_FACTORY =</span>
<span class="line-added">+         &quot;com.sun.org.apache.xerces.internal.impl.dv.dtd.XML11DTDDVFactoryImpl&quot;;</span>
<span class="line-added">+ </span>
      // feature identifiers
  
      /** Feature identifier: validation. */
      protected static final String XERCES_VALIDATION =
          Constants.SAX_FEATURE_PREFIX + Constants.VALIDATION_FEATURE;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 99,16 ***</span>
          Constants.XERCES_FEATURE_PREFIX + Constants.DYNAMIC_VALIDATION_FEATURE;
  
      protected static final String NORMALIZE_DATA =
          Constants.XERCES_FEATURE_PREFIX + Constants.SCHEMA_NORMALIZED_VALUE;
  
      /** sending psvi in the pipeline */
      protected static final String SEND_PSVI =
          Constants.XERCES_FEATURE_PREFIX + Constants.SCHEMA_AUGMENT_PSVI;
  
<span class="line-modified">!     protected final static String DTD_VALIDATOR_FACTORY_PROPERTY =</span>
<span class="line-modified">!         Constants.XERCES_PROPERTY_PREFIX + Constants.DATATYPE_VALIDATOR_FACTORY_PROPERTY;</span>
  
      /** Feature identifier: namespace growth */
      protected static final String NAMESPACE_GROWTH =
          Constants.XERCES_FEATURE_PREFIX + Constants.NAMESPACE_GROWTH_FEATURE;
  
<span class="line-new-header">--- 102,45 ---</span>
          Constants.XERCES_FEATURE_PREFIX + Constants.DYNAMIC_VALIDATION_FEATURE;
  
      protected static final String NORMALIZE_DATA =
          Constants.XERCES_FEATURE_PREFIX + Constants.SCHEMA_NORMALIZED_VALUE;
  
<span class="line-added">+     /** Feature identifier: send element default value via characters() */</span>
<span class="line-added">+     protected static final String SCHEMA_ELEMENT_DEFAULT =</span>
<span class="line-added">+         Constants.XERCES_FEATURE_PREFIX + Constants.SCHEMA_ELEMENT_DEFAULT;</span>
<span class="line-added">+ </span>
      /** sending psvi in the pipeline */
      protected static final String SEND_PSVI =
          Constants.XERCES_FEATURE_PREFIX + Constants.SCHEMA_AUGMENT_PSVI;
  
<span class="line-modified">!     /** Feature: generate synthetic annotations */</span>
<span class="line-modified">!     protected static final String GENERATE_SYNTHETIC_ANNOTATIONS =</span>
<span class="line-added">+         Constants.XERCES_FEATURE_PREFIX + Constants.GENERATE_SYNTHETIC_ANNOTATIONS_FEATURE;</span>
<span class="line-added">+ </span>
<span class="line-added">+     /** Feature identifier: validate annotations */</span>
<span class="line-added">+     protected static final String VALIDATE_ANNOTATIONS =</span>
<span class="line-added">+         Constants.XERCES_FEATURE_PREFIX + Constants.VALIDATE_ANNOTATIONS_FEATURE;</span>
<span class="line-added">+ </span>
<span class="line-added">+     /** Feature identifier: honour all schemaLocations */</span>
<span class="line-added">+     protected static final String HONOUR_ALL_SCHEMALOCATIONS =</span>
<span class="line-added">+         Constants.XERCES_FEATURE_PREFIX + Constants.HONOUR_ALL_SCHEMALOCATIONS_FEATURE;</span>
<span class="line-added">+ </span>
<span class="line-added">+     /** Feature identifier: use grammar pool only */</span>
<span class="line-added">+     protected static final String USE_GRAMMAR_POOL_ONLY =</span>
<span class="line-added">+         Constants.XERCES_FEATURE_PREFIX + Constants.USE_GRAMMAR_POOL_ONLY_FEATURE;</span>
<span class="line-added">+ </span>
<span class="line-added">+     /** Feature identifier: load external DTD. */</span>
<span class="line-added">+     protected static final String DISALLOW_DOCTYPE_DECL_FEATURE =</span>
<span class="line-added">+         Constants.XERCES_FEATURE_PREFIX + Constants.DISALLOW_DOCTYPE_DECL_FEATURE;</span>
<span class="line-added">+ </span>
<span class="line-added">+     /** Feature identifier: balance syntax trees. */</span>
<span class="line-added">+     protected static final String BALANCE_SYNTAX_TREES =</span>
<span class="line-added">+         Constants.XERCES_FEATURE_PREFIX + Constants.BALANCE_SYNTAX_TREES;</span>
<span class="line-added">+ </span>
<span class="line-added">+     /** Feature identifier: warn on duplicate attribute definition. */</span>
<span class="line-added">+     protected static final String WARN_ON_DUPLICATE_ATTDEF =</span>
<span class="line-added">+         Constants.XERCES_FEATURE_PREFIX + Constants.WARN_ON_DUPLICATE_ATTDEF_FEATURE;</span>
  
      /** Feature identifier: namespace growth */
      protected static final String NAMESPACE_GROWTH =
          Constants.XERCES_FEATURE_PREFIX + Constants.NAMESPACE_GROWTH_FEATURE;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 131,13 ***</span>
  
      /** Property identifier: symbol table. */
      protected static final String SYMBOL_TABLE =
          Constants.XERCES_PROPERTY_PREFIX + Constants.SYMBOL_TABLE_PROPERTY;
  
<span class="line-modified">!     /** Property id: Grammar pool*/</span>
      protected static final String GRAMMAR_POOL =
<span class="line-modified">!     Constants.XERCES_PROPERTY_PREFIX + Constants.XMLGRAMMAR_POOL_PROPERTY;</span>
  
      /** Property identifier: error handler. */
      protected static final String ERROR_HANDLER =
          Constants.XERCES_PROPERTY_PREFIX + Constants.ERROR_HANDLER_PROPERTY;
  
<span class="line-new-header">--- 163,13 ---</span>
  
      /** Property identifier: symbol table. */
      protected static final String SYMBOL_TABLE =
          Constants.XERCES_PROPERTY_PREFIX + Constants.SYMBOL_TABLE_PROPERTY;
  
<span class="line-modified">!     /** Property id: Grammar pool. */</span>
      protected static final String GRAMMAR_POOL =
<span class="line-modified">!         Constants.XERCES_PROPERTY_PREFIX + Constants.XMLGRAMMAR_POOL_PROPERTY;</span>
  
      /** Property identifier: error handler. */
      protected static final String ERROR_HANDLER =
          Constants.XERCES_PROPERTY_PREFIX + Constants.ERROR_HANDLER_PROPERTY;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 145,19 ***</span>
      protected static final String ENTITY_RESOLVER =
          Constants.XERCES_PROPERTY_PREFIX + Constants.ENTITY_RESOLVER_PROPERTY;
  
      /** Property identifier: JAXP schema language / DOM schema-type. */
      protected static final String JAXP_SCHEMA_LANGUAGE =
<span class="line-modified">!     Constants.JAXP_PROPERTY_PREFIX + Constants.SCHEMA_LANGUAGE;</span>
  
      /** Property identifier: JAXP schema source/ DOM schema-location. */
      protected static final String JAXP_SCHEMA_SOURCE =
<span class="line-modified">!     Constants.JAXP_PROPERTY_PREFIX + Constants.SCHEMA_SOURCE;</span>
  
      protected static final String VALIDATION_MANAGER =
          Constants.XERCES_PROPERTY_PREFIX + Constants.VALIDATION_MANAGER_PROPERTY;
  
      /** Property identifier: Schema DV Factory */
      protected static final String SCHEMA_DV_FACTORY =
          Constants.XERCES_PROPERTY_PREFIX + Constants.SCHEMA_DV_FACTORY_PROPERTY;
  
      /** Property identifier: Security manager. */
<span class="line-new-header">--- 177,35 ---</span>
      protected static final String ENTITY_RESOLVER =
          Constants.XERCES_PROPERTY_PREFIX + Constants.ENTITY_RESOLVER_PROPERTY;
  
      /** Property identifier: JAXP schema language / DOM schema-type. */
      protected static final String JAXP_SCHEMA_LANGUAGE =
<span class="line-modified">!         Constants.JAXP_PROPERTY_PREFIX + Constants.SCHEMA_LANGUAGE;</span>
  
      /** Property identifier: JAXP schema source/ DOM schema-location. */
      protected static final String JAXP_SCHEMA_SOURCE =
<span class="line-modified">!         Constants.JAXP_PROPERTY_PREFIX + Constants.SCHEMA_SOURCE;</span>
<span class="line-added">+ </span>
<span class="line-added">+     /** Property identifier: DTD validator. */</span>
<span class="line-added">+     protected final static String DTD_VALIDATOR_PROPERTY =</span>
<span class="line-added">+         Constants.XERCES_PROPERTY_PREFIX + Constants.DTD_VALIDATOR_PROPERTY;</span>
<span class="line-added">+ </span>
<span class="line-added">+     /** Property identifier: datatype validator factory. */</span>
<span class="line-added">+     protected static final String DTD_VALIDATOR_FACTORY_PROPERTY =</span>
<span class="line-added">+         Constants.XERCES_PROPERTY_PREFIX + Constants.DATATYPE_VALIDATOR_FACTORY_PROPERTY;</span>
  
      protected static final String VALIDATION_MANAGER =
          Constants.XERCES_PROPERTY_PREFIX + Constants.VALIDATION_MANAGER_PROPERTY;
  
<span class="line-added">+     /** Property identifier: schema location. */</span>
<span class="line-added">+     protected static final String SCHEMA_LOCATION =</span>
<span class="line-added">+         Constants.XERCES_PROPERTY_PREFIX + Constants.SCHEMA_LOCATION;</span>
<span class="line-added">+ </span>
<span class="line-added">+     /** Property identifier: no namespace schema location. */</span>
<span class="line-added">+     protected static final String SCHEMA_NONS_LOCATION =</span>
<span class="line-added">+         Constants.XERCES_PROPERTY_PREFIX + Constants.SCHEMA_NONS_LOCATION;</span>
<span class="line-added">+ </span>
      /** Property identifier: Schema DV Factory */
      protected static final String SCHEMA_DV_FACTORY =
          Constants.XERCES_PROPERTY_PREFIX + Constants.SCHEMA_DV_FACTORY_PROPERTY;
  
      /** Property identifier: Security manager. */
</pre>
<hr />
<pre>
<span class="line-old-header">*** 207,12 ***</span>
<span class="line-new-header">--- 255,22 ---</span>
      protected XMLErrorReporter fErrorReporter;
  
      protected final DOMErrorHandlerWrapper fErrorHandlerWrapper =
                  new DOMErrorHandlerWrapper();
  
<span class="line-added">+     /** Current Datatype validator factory. */</span>
<span class="line-added">+     protected DTDDVFactory fCurrentDVFactory;</span>
<span class="line-added">+ </span>
<span class="line-added">+     /** The XML 1.0 Datatype validator factory. */</span>
<span class="line-added">+     protected DTDDVFactory fDatatypeValidatorFactory;</span>
<span class="line-added">+ </span>
<span class="line-added">+     /** The XML 1.1 Datatype validator factory. **/</span>
<span class="line-added">+     protected DTDDVFactory fXML11DatatypeFactory;</span>
<span class="line-added">+ </span>
      // private data
  
<span class="line-added">+     private String fSchemaLocation = null;</span>
      private DOMStringList fRecognizedParameters;
  
  
      //
      // Constructors
</pre>
<hr />
<pre>
<span class="line-old-header">*** 254,11 ***</span>
<span class="line-new-header">--- 312,20 ---</span>
              XERCES_NAMESPACES,
              SCHEMA,
              SCHEMA_FULL_CHECKING,
              DYNAMIC_VALIDATION,
              NORMALIZE_DATA,
<span class="line-added">+             SCHEMA_ELEMENT_DEFAULT,</span>
              SEND_PSVI,
<span class="line-added">+             GENERATE_SYNTHETIC_ANNOTATIONS,</span>
<span class="line-added">+             VALIDATE_ANNOTATIONS,</span>
<span class="line-added">+             HONOUR_ALL_SCHEMALOCATIONS,</span>
<span class="line-added">+             USE_GRAMMAR_POOL_ONLY,</span>
<span class="line-added">+             DISALLOW_DOCTYPE_DECL_FEATURE,</span>
<span class="line-added">+             BALANCE_SYNTAX_TREES,</span>
<span class="line-added">+             WARN_ON_DUPLICATE_ATTDEF,</span>
<span class="line-added">+             PARSER_SETTINGS,</span>
              NAMESPACE_GROWTH,
              TOLERATE_DUPLICATES,
              XMLConstants.USE_CATALOG,
              JdkXmlUtils.OVERRIDE_PARSER
          };
</pre>
<hr />
<pre>
<span class="line-old-header">*** 268,13 ***</span>
<span class="line-new-header">--- 335,23 ---</span>
          setFeature(XERCES_VALIDATION, false);
          setFeature(SCHEMA, false);
          setFeature(SCHEMA_FULL_CHECKING, false);
          setFeature(DYNAMIC_VALIDATION, false);
          setFeature(NORMALIZE_DATA, false);
<span class="line-added">+         setFeature(SCHEMA_ELEMENT_DEFAULT, false);</span>
          setFeature(XERCES_NAMESPACES, true);
          setFeature(SEND_PSVI, true);
<span class="line-added">+         setFeature(GENERATE_SYNTHETIC_ANNOTATIONS, false);</span>
<span class="line-added">+         setFeature(VALIDATE_ANNOTATIONS, false);</span>
<span class="line-added">+         setFeature(HONOUR_ALL_SCHEMALOCATIONS, false);</span>
<span class="line-added">+         setFeature(USE_GRAMMAR_POOL_ONLY, false);</span>
<span class="line-added">+         setFeature(DISALLOW_DOCTYPE_DECL_FEATURE, false);</span>
<span class="line-added">+         setFeature(BALANCE_SYNTAX_TREES, false);</span>
<span class="line-added">+         setFeature(WARN_ON_DUPLICATE_ATTDEF, false);</span>
<span class="line-added">+         setFeature(PARSER_SETTINGS, true);</span>
          setFeature(NAMESPACE_GROWTH, false);
<span class="line-added">+         setFeature(TOLERATE_DUPLICATES, false);</span>
          setFeature(XMLConstants.USE_CATALOG, JdkXmlUtils.USE_CATALOG_DEFAULT);
          setFeature(JdkXmlUtils.OVERRIDE_PARSER, JdkXmlUtils.OVERRIDE_PARSER_DEFAULT);
  
          // add default recognized properties
          final String[] recognizedProperties = {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 286,10 ***</span>
<span class="line-new-header">--- 363,13 ---</span>
              ENTITY_MANAGER,
              VALIDATION_MANAGER,
              GRAMMAR_POOL,
              JAXP_SCHEMA_SOURCE,
              JAXP_SCHEMA_LANGUAGE,
<span class="line-added">+             SCHEMA_LOCATION,</span>
<span class="line-added">+             SCHEMA_NONS_LOCATION,</span>
<span class="line-added">+             DTD_VALIDATOR_PROPERTY,</span>
              DTD_VALIDATOR_FACTORY_PROPERTY,
              SCHEMA_DV_FACTORY,
              SECURITY_MANAGER,
              XML_SECURITY_PROPERTY_MANAGER,
              JdkXmlUtils.CATALOG_DEFER,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 319,11 ***</span>
          setProperty(SYMBOL_TABLE, fSymbolTable);
          fErrorReporter = new XMLErrorReporter();
          setProperty(ERROR_REPORTER, fErrorReporter);
          addComponent(fErrorReporter);
  
<span class="line-modified">!         setProperty(DTD_VALIDATOR_FACTORY_PROPERTY, DTDDVFactory.getInstance());</span>
  
          XMLEntityManager manager =  new XMLEntityManager();
          setProperty(ENTITY_MANAGER, manager);
          addComponent(manager);
  
<span class="line-new-header">--- 399,14 ---</span>
          setProperty(SYMBOL_TABLE, fSymbolTable);
          fErrorReporter = new XMLErrorReporter();
          setProperty(ERROR_REPORTER, fErrorReporter);
          addComponent(fErrorReporter);
  
<span class="line-modified">!         fDatatypeValidatorFactory = DTDDVFactory.getInstance();</span>
<span class="line-added">+         fXML11DatatypeFactory = DTDDVFactory.getInstance(XML11_DATATYPE_VALIDATOR_FACTORY);</span>
<span class="line-added">+         fCurrentDVFactory = fDatatypeValidatorFactory;</span>
<span class="line-added">+         setProperty(DTD_VALIDATOR_FACTORY_PROPERTY, fCurrentDVFactory);</span>
  
          XMLEntityManager manager =  new XMLEntityManager();
          setProperty(ENTITY_MANAGER, manager);
          addComponent(manager);
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 346,12 ***</span>
          //          This is a hack to allow DTD configuration to be build.
          //
          if (fErrorReporter.getMessageFormatter(&quot;http://www.w3.org/TR/xml-schema-1&quot;) == null) {
              MessageFormatter xmft = null;
              try {
<span class="line-modified">!                xmft = (MessageFormatter)(</span>
<span class="line-removed">-                     ObjectFactory.newInstance(&quot;com.sun.org.apache.xerces.internal.impl.xs.XSMessageFormatter&quot;, true));</span>
              } catch (Exception exception){
              }
  
               if (xmft !=  null) {
                   fErrorReporter.putMessageFormatter(&quot;http://www.w3.org/TR/xml-schema-1&quot;, xmft);
<span class="line-new-header">--- 429,11 ---</span>
          //          This is a hack to allow DTD configuration to be build.
          //
          if (fErrorReporter.getMessageFormatter(&quot;http://www.w3.org/TR/xml-schema-1&quot;) == null) {
              MessageFormatter xmft = null;
              try {
<span class="line-modified">!                xmft = new com.sun.org.apache.xerces.internal.impl.xs.XSMessageFormatter();</span>
              } catch (Exception exception){
              }
  
               if (xmft !=  null) {
                   fErrorReporter.putMessageFormatter(&quot;http://www.w3.org/TR/xml-schema-1&quot;, xmft);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 394,12 ***</span>
       * &lt;p&gt;
       * This method is synchronous: it will not return until parsing
       * has ended.  If a client application wants to terminate
       * parsing early, it should throw an exception.
       *
<span class="line-modified">!      * @param source The input source for the top-level of the</span>
<span class="line-modified">!      *               XML document.</span>
       *
       * @exception XNIException Any XNI exception, possibly wrapping
       *                         another exception.
       * @exception IOException  An IO exception from the parser, possibly
       *                         from a byte stream or character stream
<span class="line-new-header">--- 476,12 ---</span>
       * &lt;p&gt;
       * This method is synchronous: it will not return until parsing
       * has ended.  If a client application wants to terminate
       * parsing early, it should throw an exception.
       *
<span class="line-modified">!      * @param inputSource The input source for the top-level of the</span>
<span class="line-modified">!      *                    XML document.</span>
       *
       * @exception XNIException Any XNI exception, possibly wrapping
       *                         another exception.
       * @exception IOException  An IO exception from the parser, possibly
       *                         from a byte stream or character stream
</pre>
<hr />
<pre>
<span class="line-old-header">*** 460,13 ***</span>
       *
       * @param resolver The new entity resolver. Passing a null value will
       *                 uninstall the currently installed resolver.
       */
      public void setEntityResolver(XMLEntityResolver resolver) {
<span class="line-modified">!         if (resolver !=null) {</span>
<span class="line-removed">-             fProperties.put(ENTITY_RESOLVER, resolver);</span>
<span class="line-removed">-         }</span>
      } // setEntityResolver(XMLEntityResolver)
  
      /**
       * Return the current entity resolver.
       *
<span class="line-new-header">--- 542,11 ---</span>
       *
       * @param resolver The new entity resolver. Passing a null value will
       *                 uninstall the currently installed resolver.
       */
      public void setEntityResolver(XMLEntityResolver resolver) {
<span class="line-modified">!         fProperties.put(ENTITY_RESOLVER, resolver);</span>
      } // setEntityResolver(XMLEntityResolver)
  
      /**
       * Return the current entity resolver.
       *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 511,10 ***</span>
<span class="line-new-header">--- 591,30 ---</span>
       */
      public XMLErrorHandler getErrorHandler() {
          return (XMLErrorHandler)fProperties.get(ERROR_HANDLER);
      } // getErrorHandler():XMLErrorHandler
  
<span class="line-added">+     /**</span>
<span class="line-added">+      * Returns the state of a feature.</span>
<span class="line-added">+      *</span>
<span class="line-added">+      * @param featureId The feature identifier.</span>
<span class="line-added">+      * @return true if the feature is supported</span>
<span class="line-added">+      *</span>
<span class="line-added">+      * @throws XMLConfigurationException Thrown for configuration error.</span>
<span class="line-added">+      *                                   In general, components should</span>
<span class="line-added">+      *                                   only throw this exception if</span>
<span class="line-added">+      *                                   it is &lt;strong&gt;really&lt;/strong&gt;</span>
<span class="line-added">+      *                                   a critical error.</span>
<span class="line-added">+      */</span>
<span class="line-added">+     public boolean getFeature(String featureId)</span>
<span class="line-added">+         throws XMLConfigurationException {</span>
<span class="line-added">+         if (featureId.equals(PARSER_SETTINGS)) {</span>
<span class="line-added">+             return true;</span>
<span class="line-added">+         }</span>
<span class="line-added">+         return super.getFeature(featureId);</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      /**
       * Set the state of a feature.
       *
       * Set the state of any feature in a SAX2 parser.  The parser
       * might not recognize the feature, and if it does recognize
</pre>
<hr />
<pre>
<span class="line-old-header">*** 574,12 ***</span>
      public void setParameter(String name, Object value) throws DOMException {
          boolean found = true;
  
          // REVISIT: Recognizes DOM L3 default features only.
          //          Does not yet recognize Xerces features.
<span class="line-modified">!                 if(value instanceof Boolean){</span>
<span class="line-modified">!                         boolean state = ((Boolean)value).booleanValue();</span>
  
              if (name.equalsIgnoreCase(Constants.DOM_COMMENTS)) {
                  features = (short) (state ? features | COMMENTS : features &amp; ~COMMENTS);
              }
              else if (name.equalsIgnoreCase(Constants.DOM_DATATYPE_NORMALIZATION)) {
<span class="line-new-header">--- 674,12 ---</span>
      public void setParameter(String name, Object value) throws DOMException {
          boolean found = true;
  
          // REVISIT: Recognizes DOM L3 default features only.
          //          Does not yet recognize Xerces features.
<span class="line-modified">!         if(value instanceof Boolean){</span>
<span class="line-modified">!             boolean state = ((Boolean)value).booleanValue();</span>
  
              if (name.equalsIgnoreCase(Constants.DOM_COMMENTS)) {
                  features = (short) (state ? features | COMMENTS : features &amp; ~COMMENTS);
              }
              else if (name.equalsIgnoreCase(Constants.DOM_DATATYPE_NORMALIZATION)) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 623,39 ***</span>
                      || name.equalsIgnoreCase(Constants.DOM_CANONICAL_FORM)
                      || name.equalsIgnoreCase(Constants.DOM_VALIDATE_IF_SCHEMA)
                      || name.equalsIgnoreCase(Constants.DOM_CHECK_CHAR_NORMALIZATION)
                      ) {
                  if (state) { // true is not supported
<span class="line-modified">!                     String msg =</span>
<span class="line-removed">-                         DOMMessageFormatter.formatMessage(</span>
<span class="line-removed">-                             DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-removed">-                             &quot;FEATURE_NOT_SUPPORTED&quot;,</span>
<span class="line-removed">-                             new Object[] { name });</span>
<span class="line-removed">-                     throw new DOMException(DOMException.NOT_SUPPORTED_ERR, msg);</span>
                  }
              }
                          else if ( name.equalsIgnoreCase(Constants.DOM_ELEMENT_CONTENT_WHITESPACE)) {
                  if (!state) { // false is not supported
<span class="line-modified">!                     String msg =</span>
<span class="line-removed">-                         DOMMessageFormatter.formatMessage(</span>
<span class="line-removed">-                             DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-removed">-                             &quot;FEATURE_NOT_SUPPORTED&quot;,</span>
<span class="line-removed">-                             new Object[] { name });</span>
<span class="line-removed">-                    throw new DOMException(DOMException.NOT_SUPPORTED_ERR, msg);</span>
                  }
              }
              else if (name.equalsIgnoreCase(SEND_PSVI) ){
                  // REVISIT: turning augmentation of PSVI is not support,
                  // because in this case we won&#39;t be able to retrieve element
                  // default value.
                  if (!state) { // false is not supported
<span class="line-modified">!                     String msg =</span>
<span class="line-removed">-                         DOMMessageFormatter.formatMessage(</span>
<span class="line-removed">-                             DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-removed">-                             &quot;FEATURE_NOT_SUPPORTED&quot;,</span>
<span class="line-removed">-                             new Object[] { name });</span>
<span class="line-removed">-                     throw new DOMException(DOMException.NOT_SUPPORTED_ERR, msg);</span>
                  }
              }
              else if (name.equalsIgnoreCase(Constants.DOM_PSVI)){
                    features = (short) (state ? features | PSVI : features &amp; ~PSVI);
              }
<span class="line-new-header">--- 723,24 ---</span>
                      || name.equalsIgnoreCase(Constants.DOM_CANONICAL_FORM)
                      || name.equalsIgnoreCase(Constants.DOM_VALIDATE_IF_SCHEMA)
                      || name.equalsIgnoreCase(Constants.DOM_CHECK_CHAR_NORMALIZATION)
                      ) {
                  if (state) { // true is not supported
<span class="line-modified">!                     throw newFeatureNotSupportedError(name);</span>
                  }
              }
                          else if ( name.equalsIgnoreCase(Constants.DOM_ELEMENT_CONTENT_WHITESPACE)) {
                  if (!state) { // false is not supported
<span class="line-modified">!                     throw newFeatureNotSupportedError(name);</span>
                  }
              }
              else if (name.equalsIgnoreCase(SEND_PSVI) ){
                  // REVISIT: turning augmentation of PSVI is not support,
                  // because in this case we won&#39;t be able to retrieve element
                  // default value.
                  if (!state) { // false is not supported
<span class="line-modified">!                     throw newFeatureNotSupportedError(name);</span>
                  }
              }
              else if (name.equalsIgnoreCase(Constants.DOM_PSVI)){
                    features = (short) (state ? features | PSVI : features &amp; ~PSVI);
              }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 671,67 ***</span>
                  */
              }
  
          }
  
<span class="line-modified">!                 if (!found || !(value instanceof Boolean))  { // set properties</span>
<span class="line-modified">!                         found = true;</span>
  
              if (name.equalsIgnoreCase(Constants.DOM_ERROR_HANDLER)) {
                  if (value instanceof DOMErrorHandler || value == null) {
                      fErrorHandlerWrapper.setErrorHandler((DOMErrorHandler)value);
                      setErrorHandler(fErrorHandlerWrapper);
                  }
<span class="line-removed">- </span>
                  else {
<span class="line-modified">!                     // REVISIT: type mismatch</span>
<span class="line-removed">-                     String msg =</span>
<span class="line-removed">-                         DOMMessageFormatter.formatMessage(</span>
<span class="line-removed">-                             DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-removed">-                             &quot;TYPE_MISMATCH_ERR&quot;,</span>
<span class="line-removed">-                             new Object[] { name });</span>
<span class="line-removed">-                     throw new DOMException(DOMException.TYPE_MISMATCH_ERR, msg);</span>
                  }
              }
              else if (name.equalsIgnoreCase(Constants.DOM_RESOURCE_RESOLVER)) {
                  if (value instanceof LSResourceResolver || value == null) {
                      try {
                          setEntityResolver(new DOMEntityResolverWrapper((LSResourceResolver) value));
                      }
                      catch (XMLConfigurationException e) {}
                  }
                  else {
<span class="line-modified">!                     // REVISIT: type mismatch</span>
<span class="line-removed">-                     String msg =</span>
<span class="line-removed">-                         DOMMessageFormatter.formatMessage(</span>
<span class="line-removed">-                             DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-removed">-                             &quot;TYPE_MISMATCH_ERR&quot;,</span>
<span class="line-removed">-                             new Object[] { name });</span>
<span class="line-removed">-                     throw new DOMException(DOMException.TYPE_MISMATCH_ERR, msg);</span>
                  }
<span class="line-removed">- </span>
              }
              else if (name.equalsIgnoreCase(Constants.DOM_SCHEMA_LOCATION)) {
                  if (value instanceof String || value == null) {
                      try {
<span class="line-modified">!                         // map DOM schema-location to JAXP schemaSource property</span>
<span class="line-modified">!                         setProperty(</span>
<span class="line-modified">!                             Constants.JAXP_PROPERTY_PREFIX + Constants.SCHEMA_SOURCE,</span>
<span class="line-modified">!                             value);</span>
                      }
                      catch (XMLConfigurationException e) {}
                  }
                  else {
<span class="line-modified">!                     // REVISIT: type mismatch</span>
<span class="line-removed">-                     String msg =</span>
<span class="line-removed">-                         DOMMessageFormatter.formatMessage(</span>
<span class="line-removed">-                             DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-removed">-                             &quot;TYPE_MISMATCH_ERR&quot;,</span>
<span class="line-removed">-                             new Object[] { name });</span>
<span class="line-removed">-                     throw new DOMException(DOMException.TYPE_MISMATCH_ERR, msg);</span>
                  }
<span class="line-removed">- </span>
              }
              else if (name.equalsIgnoreCase(Constants.DOM_SCHEMA_TYPE)) {
                  if (value instanceof String || value == null) {
                      try {
                          if (value == null) {
<span class="line-new-header">--- 756,69 ---</span>
                  */
              }
  
          }
  
<span class="line-modified">!         if (!found || !(value instanceof Boolean))  { // set properties</span>
<span class="line-modified">!                 found = true;</span>
  
              if (name.equalsIgnoreCase(Constants.DOM_ERROR_HANDLER)) {
                  if (value instanceof DOMErrorHandler || value == null) {
                      fErrorHandlerWrapper.setErrorHandler((DOMErrorHandler)value);
                      setErrorHandler(fErrorHandlerWrapper);
                  }
                  else {
<span class="line-modified">!                     throw newTypeMismatchError(name);</span>
                  }
              }
              else if (name.equalsIgnoreCase(Constants.DOM_RESOURCE_RESOLVER)) {
                  if (value instanceof LSResourceResolver || value == null) {
                      try {
                          setEntityResolver(new DOMEntityResolverWrapper((LSResourceResolver) value));
                      }
                      catch (XMLConfigurationException e) {}
                  }
                  else {
<span class="line-modified">!                     throw newTypeMismatchError(name);</span>
                  }
              }
              else if (name.equalsIgnoreCase(Constants.DOM_SCHEMA_LOCATION)) {
                  if (value instanceof String || value == null) {
                      try {
<span class="line-modified">!                         if (value == null) {</span>
<span class="line-modified">!                             fSchemaLocation = null;</span>
<span class="line-modified">!                             setProperty (</span>
<span class="line-modified">!                                 Constants.JAXP_PROPERTY_PREFIX + Constants.SCHEMA_SOURCE,</span>
<span class="line-added">+                                 null);</span>
<span class="line-added">+                         }</span>
<span class="line-added">+                         else {</span>
<span class="line-added">+                             fSchemaLocation = (String) value;</span>
<span class="line-added">+                             // map DOM schema-location to JAXP schemaSource property</span>
<span class="line-added">+                             // tokenize location string</span>
<span class="line-added">+                             StringTokenizer t = new StringTokenizer(fSchemaLocation, &quot; \n\t\r&quot;);</span>
<span class="line-added">+                             if (t.hasMoreTokens()) {</span>
<span class="line-added">+                                 List&lt;String&gt; locations = new ArrayList&lt;&gt;();</span>
<span class="line-added">+                                 locations.add(t.nextToken());</span>
<span class="line-added">+                                 while (t.hasMoreTokens()) {</span>
<span class="line-added">+                                     locations.add (t.nextToken());</span>
<span class="line-added">+                                 }</span>
<span class="line-added">+                                 setProperty (</span>
<span class="line-added">+                                     Constants.JAXP_PROPERTY_PREFIX + Constants.SCHEMA_SOURCE,</span>
<span class="line-added">+                                     locations.toArray(new String[locations.size()]));</span>
<span class="line-added">+                             }</span>
<span class="line-added">+                             else {</span>
<span class="line-added">+                                 setProperty (</span>
<span class="line-added">+                                     Constants.JAXP_PROPERTY_PREFIX + Constants.SCHEMA_SOURCE,</span>
<span class="line-added">+                                     new String [] {(String) value});</span>
<span class="line-added">+                             }</span>
<span class="line-added">+                         }</span>
                      }
                      catch (XMLConfigurationException e) {}
                  }
                  else {
<span class="line-modified">!                     throw newTypeMismatchError(name);</span>
                  }
              }
              else if (name.equalsIgnoreCase(Constants.DOM_SCHEMA_TYPE)) {
                  if (value instanceof String || value == null) {
                      try {
                          if (value == null) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 752,61 ***</span>
                          }
                      }
                      catch (XMLConfigurationException e) {}
                  }
                  else {
<span class="line-modified">!                     String msg =</span>
<span class="line-removed">-                         DOMMessageFormatter.formatMessage(</span>
<span class="line-removed">-                             DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-removed">-                             &quot;TYPE_MISMATCH_ERR&quot;,</span>
<span class="line-removed">-                             new Object[] { name });</span>
<span class="line-removed">-                     throw new DOMException(DOMException.TYPE_MISMATCH_ERR, msg);</span>
                  }
<span class="line-removed">- </span>
              }
<span class="line-modified">!             else if (name.equalsIgnoreCase(SYMBOL_TABLE)){</span>
                  // Xerces Symbol Table
                  if (value instanceof SymbolTable){
                      setProperty(SYMBOL_TABLE, value);
                  }
                  else {
<span class="line-modified">!                     // REVISIT: type mismatch</span>
<span class="line-removed">-                     String msg =</span>
<span class="line-removed">-                         DOMMessageFormatter.formatMessage(</span>
<span class="line-removed">-                             DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-removed">-                             &quot;TYPE_MISMATCH_ERR&quot;,</span>
<span class="line-removed">-                             new Object[] { name });</span>
<span class="line-removed">-                     throw new DOMException(DOMException.TYPE_MISMATCH_ERR, msg);</span>
                  }
              }
<span class="line-modified">!             else if (name.equalsIgnoreCase (GRAMMAR_POOL)){</span>
<span class="line-modified">!                 if (value instanceof XMLGrammarPool){</span>
                      setProperty(GRAMMAR_POOL, value);
                  }
                  else {
<span class="line-modified">!                     // REVISIT: type mismatch</span>
<span class="line-removed">-                     String msg =</span>
<span class="line-removed">-                         DOMMessageFormatter.formatMessage(</span>
<span class="line-removed">-                             DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-removed">-                             &quot;TYPE_MISMATCH_ERR&quot;,</span>
<span class="line-removed">-                             new Object[] { name });</span>
<span class="line-removed">-                     throw new DOMException(DOMException.TYPE_MISMATCH_ERR, msg);</span>
                  }
<span class="line-removed">- </span>
              }
<span class="line-modified">!             else {</span>
                  // REVISIT: check if this is a boolean parameter -- type mismatch should be thrown.
                  //parameter is not recognized
<span class="line-modified">!                 String msg =</span>
<span class="line-removed">-                     DOMMessageFormatter.formatMessage(</span>
<span class="line-removed">-                         DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-removed">-                         &quot;FEATURE_NOT_FOUND&quot;,</span>
<span class="line-removed">-                         new Object[] { name });</span>
<span class="line-removed">-                 throw new DOMException(DOMException.NOT_FOUND_ERR, msg);</span>
              }
          }
<span class="line-removed">- </span>
      }
  
  
      /**
       * DOM Level 3 WD - Experimental.
<span class="line-new-header">--- 839,47 ---</span>
                          }
                      }
                      catch (XMLConfigurationException e) {}
                  }
                  else {
<span class="line-modified">!                     throw newTypeMismatchError(name);</span>
                  }
              }
<span class="line-modified">!             else if (name.equalsIgnoreCase(ENTITY_RESOLVER)) {</span>
<span class="line-added">+                 if (value instanceof XMLEntityResolver || value == null) {</span>
<span class="line-added">+                     try {</span>
<span class="line-added">+                         setEntityResolver((XMLEntityResolver) value);</span>
<span class="line-added">+                     }</span>
<span class="line-added">+                     catch (XMLConfigurationException e) {}</span>
<span class="line-added">+                 }</span>
<span class="line-added">+                 else {</span>
<span class="line-added">+                     throw newTypeMismatchError(name);</span>
<span class="line-added">+                 }</span>
<span class="line-added">+             }</span>
<span class="line-added">+             else if (name.equalsIgnoreCase(SYMBOL_TABLE)) {</span>
                  // Xerces Symbol Table
                  if (value instanceof SymbolTable){
                      setProperty(SYMBOL_TABLE, value);
                  }
                  else {
<span class="line-modified">!                     throw newTypeMismatchError(name);</span>
                  }
              }
<span class="line-modified">!             else if (name.equalsIgnoreCase (GRAMMAR_POOL)) {</span>
<span class="line-modified">!                 if (value instanceof XMLGrammarPool || value == null) {</span>
                      setProperty(GRAMMAR_POOL, value);
                  }
                  else {
<span class="line-modified">!                     throw newTypeMismatchError(name);</span>
                  }
              }
<span class="line-modified">!                 else {</span>
                  // REVISIT: check if this is a boolean parameter -- type mismatch should be thrown.
                  //parameter is not recognized
<span class="line-modified">!                 throw newFeatureNotFoundError(name);</span>
              }
          }
      }
  
  
      /**
       * DOM Level 3 WD - Experimental.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 876,27 ***</span>
                  }
                  else if (name.equalsIgnoreCase(Constants.DOM_SCHEMA_TYPE)) {
                          return getProperty(Constants.JAXP_PROPERTY_PREFIX + Constants.SCHEMA_LANGUAGE);
                  }
                  else if (name.equalsIgnoreCase(Constants.DOM_SCHEMA_LOCATION)) {
<span class="line-modified">!                         return getProperty(Constants.JAXP_PROPERTY_PREFIX + Constants.SCHEMA_SOURCE);</span>
                  }
<span class="line-modified">!         else if (name.equalsIgnoreCase(SYMBOL_TABLE)){</span>
              return getProperty(SYMBOL_TABLE);
          }
<span class="line-modified">!         else if (name.equalsIgnoreCase(GRAMMAR_POOL)){</span>
              return getProperty(GRAMMAR_POOL);
          }
                  else {
<span class="line-modified">!                         String msg =</span>
<span class="line-removed">-                                 DOMMessageFormatter.formatMessage(</span>
<span class="line-removed">-                                         DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-removed">-                                         &quot;FEATURE_NOT_FOUND&quot;,</span>
<span class="line-removed">-                                         new Object[] { name });</span>
<span class="line-removed">-                         throw new DOMException(DOMException.NOT_FOUND_ERR, msg);</span>
                  }
<span class="line-removed">- </span>
          }
  
      /**
       * DOM Level 3 WD - Experimental.
       * Check if setting a parameter to a specific value is supported.
<span class="line-new-header">--- 949,27 ---</span>
                  }
                  else if (name.equalsIgnoreCase(Constants.DOM_SCHEMA_TYPE)) {
                          return getProperty(Constants.JAXP_PROPERTY_PREFIX + Constants.SCHEMA_LANGUAGE);
                  }
                  else if (name.equalsIgnoreCase(Constants.DOM_SCHEMA_LOCATION)) {
<span class="line-modified">!             return fSchemaLocation;</span>
                  }
<span class="line-modified">!         else if (name.equalsIgnoreCase(ENTITY_RESOLVER)) {</span>
<span class="line-added">+             return getEntityResolver();</span>
<span class="line-added">+         }</span>
<span class="line-added">+         else if (name.equalsIgnoreCase(SYMBOL_TABLE)) {</span>
              return getProperty(SYMBOL_TABLE);
          }
<span class="line-modified">!         else if (name.equalsIgnoreCase(GRAMMAR_POOL)) {</span>
              return getProperty(GRAMMAR_POOL);
<span class="line-added">+         }</span>
<span class="line-added">+         else if (name.equalsIgnoreCase(SECURITY_MANAGER)) {</span>
<span class="line-added">+             return getProperty(SECURITY_MANAGER);</span>
          }
                  else {
<span class="line-modified">!                     throw newFeatureNotFoundError(name);</span>
                  }
          }
  
      /**
       * DOM Level 3 WD - Experimental.
       * Check if setting a parameter to a specific value is supported.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 964,19 ***</span>
          else if (name.equalsIgnoreCase(Constants.DOM_SCHEMA_LOCATION)) {
              return (value instanceof String) ? true : false ;
          }
          else if (name.equalsIgnoreCase(Constants.DOM_SCHEMA_TYPE)) {
              // REVISIT: should null value be supported?
<span class="line-modified">!             //as of now we are only supporting W3C XML Schema</span>
<span class="line-modified">!             return ( (value instanceof String) &amp;&amp; value.equals(Constants.NS_XMLSCHEMA) ) ? true : false ;</span>
          }
<span class="line-modified">!         else if (name.equalsIgnoreCase(SYMBOL_TABLE)){</span>
              // Xerces Symbol Table
<span class="line-modified">!             return (value instanceof SymbolTable) ? true : false ;</span>
          }
<span class="line-modified">!         else if (name.equalsIgnoreCase (GRAMMAR_POOL)){</span>
<span class="line-modified">!             return (value instanceof XMLGrammarPool) ? true : false ;</span>
          }
          else {
              //false if the parameter is not recognized or the requested value is not supported.
              return false ;
          }
<span class="line-new-header">--- 1037,23 ---</span>
          else if (name.equalsIgnoreCase(Constants.DOM_SCHEMA_LOCATION)) {
              return (value instanceof String) ? true : false ;
          }
          else if (name.equalsIgnoreCase(Constants.DOM_SCHEMA_TYPE)) {
              // REVISIT: should null value be supported?
<span class="line-modified">!             // as of now we are only supporting W3C XML Schema and DTD.</span>
<span class="line-modified">!             return ((value instanceof String) &amp;&amp;</span>
<span class="line-added">+                     (value.equals(Constants.NS_XMLSCHEMA) || value.equals(Constants.NS_DTD))) ? true : false;</span>
<span class="line-added">+         }</span>
<span class="line-added">+         else if (name.equalsIgnoreCase(ENTITY_RESOLVER)) {</span>
<span class="line-added">+             return (value instanceof XMLEntityResolver) ? true : false;</span>
          }
<span class="line-modified">!         else if (name.equalsIgnoreCase(SYMBOL_TABLE)) {</span>
              // Xerces Symbol Table
<span class="line-modified">!             return (value instanceof SymbolTable) ? true : false;</span>
          }
<span class="line-modified">!         else if (name.equalsIgnoreCase (GRAMMAR_POOL)) {</span>
<span class="line-modified">!             return (value instanceof XMLGrammarPool) ? true : false;</span>
          }
          else {
              //false if the parameter is not recognized or the requested value is not supported.
              return false ;
          }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 989,50 ***</span>
       *  The list of the parameters supported by this
       * &lt;code&gt;DOMConfiguration&lt;/code&gt; object and for which at least one value
       * can be set by the application. Note that this list can also contain
       * parameter names defined outside this specification.
       */
<span class="line-modified">!     public DOMStringList getParameterNames() {</span>
<span class="line-modified">!         if (fRecognizedParameters == null){</span>
              List&lt;String&gt; parameters = new ArrayList&lt;&gt;();
  
<span class="line-modified">!             //Add DOM recognized parameters</span>
<span class="line-modified">!             //REVISIT: Would have been nice to have a list of</span>
<span class="line-modified">!             //recognized paramters.</span>
<span class="line-modified">!             parameters.add(Constants.DOM_COMMENTS);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_DATATYPE_NORMALIZATION);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_CDATA_SECTIONS);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_ENTITIES);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_SPLIT_CDATA);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_NAMESPACES);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_VALIDATE);</span>
<span class="line-modified">! </span>
<span class="line-modified">!             parameters.add(Constants.DOM_INFOSET);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_NORMALIZE_CHARACTERS);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_CANONICAL_FORM);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_VALIDATE_IF_SCHEMA);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_CHECK_CHAR_NORMALIZATION);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_WELLFORMED);</span>
<span class="line-modified">! </span>
<span class="line-modified">!             parameters.add(Constants.DOM_NAMESPACE_DECLARATIONS);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_ELEMENT_CONTENT_WHITESPACE);</span>
<span class="line-modified">! </span>
<span class="line-modified">!             parameters.add(Constants.DOM_ERROR_HANDLER);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_SCHEMA_TYPE);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_SCHEMA_LOCATION);</span>
<span class="line-modified">!             parameters.add(Constants.DOM_RESOURCE_RESOLVER);</span>
<span class="line-modified">! </span>
<span class="line-modified">!             //Add recognized xerces features and properties</span>
<span class="line-modified">!             parameters.add(GRAMMAR_POOL);</span>
<span class="line-modified">!             parameters.add(SYMBOL_TABLE);</span>
<span class="line-modified">!             parameters.add(SEND_PSVI);</span>
<span class="line-modified">! </span>
<span class="line-modified">!             fRecognizedParameters = new DOMStringListImpl(parameters);</span>
<span class="line-modified">!         }</span>
  
<span class="line-modified">!         return fRecognizedParameters;</span>
<span class="line-modified">!     }//getParameterNames</span>
  
      //
      // Protected methods
      //
  
<span class="line-new-header">--- 1066,53 ---</span>
       *  The list of the parameters supported by this
       * &lt;code&gt;DOMConfiguration&lt;/code&gt; object and for which at least one value
       * can be set by the application. Note that this list can also contain
       * parameter names defined outside this specification.
       */
<span class="line-modified">!         public DOMStringList getParameterNames() {</span>
<span class="line-modified">!             if (fRecognizedParameters == null){</span>
              List&lt;String&gt; parameters = new ArrayList&lt;&gt;();
  
<span class="line-modified">!                 //Add DOM recognized parameters</span>
<span class="line-modified">!                 //REVISIT: Would have been nice to have a list of</span>
<span class="line-modified">!                 //recognized paramters.</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_COMMENTS);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_DATATYPE_NORMALIZATION);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_CDATA_SECTIONS);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_ENTITIES);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_SPLIT_CDATA);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_NAMESPACES);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_VALIDATE);</span>
<span class="line-modified">! </span>
<span class="line-modified">!                 parameters.add(Constants.DOM_INFOSET);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_NORMALIZE_CHARACTERS);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_CANONICAL_FORM);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_VALIDATE_IF_SCHEMA);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_CHECK_CHAR_NORMALIZATION);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_WELLFORMED);</span>
<span class="line-modified">! </span>
<span class="line-modified">!                 parameters.add(Constants.DOM_NAMESPACE_DECLARATIONS);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_ELEMENT_CONTENT_WHITESPACE);</span>
<span class="line-modified">! </span>
<span class="line-modified">!                 parameters.add(Constants.DOM_ERROR_HANDLER);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_SCHEMA_TYPE);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_SCHEMA_LOCATION);</span>
<span class="line-modified">!                 parameters.add(Constants.DOM_RESOURCE_RESOLVER);</span>
<span class="line-modified">! </span>
<span class="line-modified">!                 //Add recognized xerces features and properties</span>
<span class="line-modified">!                 parameters.add(ENTITY_RESOLVER);</span>
<span class="line-modified">!                 parameters.add(GRAMMAR_POOL);</span>
<span class="line-modified">!                 parameters.add(SECURITY_MANAGER);</span>
<span class="line-modified">!                 parameters.add(SYMBOL_TABLE);</span>
<span class="line-modified">!                 parameters.add(SEND_PSVI);</span>
<span class="line-modified">! </span>
<span class="line-added">+                 fRecognizedParameters = new DOMStringListImpl(parameters);</span>
  
<span class="line-modified">!             }</span>
<span class="line-modified">! </span>
<span class="line-added">+             return fRecognizedParameters;</span>
<span class="line-added">+         }//getParameterNames</span>
  
      //
      // Protected methods
      //
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1059,10 ***</span>
<span class="line-new-header">--- 1139,11 ---</span>
       * @param propertyId The unique identifier (URI) of the property
       *                   being set.
       * @exception com.sun.org.apache.xerces.internal.xni.parser.XMLConfigurationException If the
       *            requested feature is not known or supported.
       */
<span class="line-added">+     @Override</span>
      protected PropertyState checkProperty(String propertyId)
          throws XMLConfigurationException {
  
          // special cases
          if (propertyId.startsWith(Constants.SAX_PROPERTY_PREFIX)) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1113,6 ***</span>
  
      protected ValidationManager createValidationManager(){
          return new ValidationManager();
      }
  
<span class="line-modified">! } // class XMLParser</span>
<span class="line-new-header">--- 1194,46 ---</span>
  
      protected ValidationManager createValidationManager(){
          return new ValidationManager();
      }
  
<span class="line-modified">!     protected final void setDTDValidatorFactory(String version) {</span>
<span class="line-added">+         if (&quot;1.1&quot;.equals(version)) {</span>
<span class="line-added">+             if (fCurrentDVFactory != fXML11DatatypeFactory) {</span>
<span class="line-added">+                 fCurrentDVFactory = fXML11DatatypeFactory;</span>
<span class="line-added">+                 setProperty(DTD_VALIDATOR_FACTORY_PROPERTY, fCurrentDVFactory);</span>
<span class="line-added">+             }</span>
<span class="line-added">+         }</span>
<span class="line-added">+         else if (fCurrentDVFactory != fDatatypeValidatorFactory) {</span>
<span class="line-added">+             fCurrentDVFactory = fDatatypeValidatorFactory;</span>
<span class="line-added">+             setProperty(DTD_VALIDATOR_FACTORY_PROPERTY, fCurrentDVFactory);</span>
<span class="line-added">+         }</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
<span class="line-added">+     private static DOMException newFeatureNotSupportedError(String name) {</span>
<span class="line-added">+         String msg =</span>
<span class="line-added">+             DOMMessageFormatter.formatMessage(</span>
<span class="line-added">+                 DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-added">+                 &quot;FEATURE_NOT_SUPPORTED&quot;,</span>
<span class="line-added">+                 new Object[] { name });</span>
<span class="line-added">+         return new DOMException(DOMException.NOT_SUPPORTED_ERR, msg);</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
<span class="line-added">+     private static DOMException newFeatureNotFoundError(String name) {</span>
<span class="line-added">+         String msg =</span>
<span class="line-added">+             DOMMessageFormatter.formatMessage(</span>
<span class="line-added">+                 DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-added">+                 &quot;FEATURE_NOT_FOUND&quot;,</span>
<span class="line-added">+                 new Object[] { name });</span>
<span class="line-added">+         return new DOMException(DOMException.NOT_FOUND_ERR, msg);</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
<span class="line-added">+     private static DOMException newTypeMismatchError(String name) {</span>
<span class="line-added">+         String msg =</span>
<span class="line-added">+             DOMMessageFormatter.formatMessage(</span>
<span class="line-added">+                 DOMMessageFormatter.DOM_DOMAIN,</span>
<span class="line-added">+                 &quot;TYPE_MISMATCH_ERR&quot;,</span>
<span class="line-added">+                 new Object[] { name });</span>
<span class="line-added">+         return new DOMException(DOMException.TYPE_MISMATCH_ERR, msg);</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
<span class="line-added">+ } // class DOMConfigurationImpl</span>
</pre>
<center><a href="CoreDocumentImpl.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="DOMNormalizer.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>