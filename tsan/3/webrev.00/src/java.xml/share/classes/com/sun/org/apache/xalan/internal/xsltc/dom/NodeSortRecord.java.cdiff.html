<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.xml/share/classes/com/sun/org/apache/xalan/internal/xsltc/dom/NodeSortRecord.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../compiler/util/MethodGenerator.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../index.html" target="_top">index</a> <a href="../runtime/AbstractTranslet.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml/share/classes/com/sun/org/apache/xalan/internal/xsltc/dom/NodeSortRecord.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2017, Oracle and/or its affiliates. All rights reserved.</span>
   */
  /*
   * Licensed to the Apache Software Foundation (ASF) under one or more
   * contributor license agreements.  See the NOTICE file distributed with
   * this work for additional information regarding copyright ownership.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2017, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   */
  /*
   * Licensed to the Apache Software Foundation (ASF) under one or more
   * contributor license agreements.  See the NOTICE file distributed with
   * this work for additional information regarding copyright ownership.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 18,24 ***</span>
   * limitations under the License.
   */
  
  package com.sun.org.apache.xalan.internal.xsltc.dom;
  
<span class="line-removed">- import com.sun.org.apache.xalan.internal.utils.ObjectFactory;</span>
<span class="line-removed">- import com.sun.org.apache.xalan.internal.xsltc.CollatorFactory;</span>
  import com.sun.org.apache.xalan.internal.xsltc.DOM;
  import com.sun.org.apache.xalan.internal.xsltc.TransletException;
  import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;
  import com.sun.org.apache.xml.internal.utils.StringComparable;
  import java.text.Collator;
  import java.util.Locale;
<span class="line-removed">- import jdk.xml.internal.SecuritySupport;</span>
  
  /**
   * Base class for sort records containing application specific sort keys
   *
<span class="line-modified">!  * @LastModified: Oct 2017</span>
   */
  public abstract class NodeSortRecord {
      public static final int COMPARE_STRING     = 0;
      public static final int COMPARE_NUMERIC    = 1;
  
<span class="line-new-header">--- 18,21 ---</span>
   * limitations under the License.
   */
  
  package com.sun.org.apache.xalan.internal.xsltc.dom;
  
  import com.sun.org.apache.xalan.internal.xsltc.DOM;
  import com.sun.org.apache.xalan.internal.xsltc.TransletException;
  import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;
  import com.sun.org.apache.xml.internal.utils.StringComparable;
  import java.text.Collator;
  import java.util.Locale;
  
  /**
   * Base class for sort records containing application specific sort keys
   *
<span class="line-modified">!  * @LastModified: May 2019</span>
   */
  public abstract class NodeSortRecord {
      public static final int COMPARE_STRING     = 0;
      public static final int COMPARE_NUMERIC    = 1;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 66,12 ***</span>
       *             New code should not refer to it.
       */
      @Deprecated
      protected Locale _locale;
  
<span class="line-removed">-     protected CollatorFactory _collatorFactory;</span>
<span class="line-removed">- </span>
      protected SortSettings _settings;
  
      private DOM    _dom = null;
      private int    _node;           // The position in the current iterator
      private int    _last = 0;       // Number of nodes in the current iterator
<span class="line-new-header">--- 63,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 107,37 ***</span>
          _settings = settings;
  
          int levels = settings.getSortOrders().length;
          _values = new Object[levels];
  
<span class="line-modified">!         String colFactClassname = null;</span>
<span class="line-modified">!         try {</span>
<span class="line-removed">-             // -- W. Eliot Kimber (eliot@isogen.com)</span>
<span class="line-removed">-             colFactClassname =</span>
<span class="line-removed">-                 SecuritySupport.getSystemProperty(&quot;com.sun.org.apache.xalan.internal.xsltc.COLLATOR_FACTORY&quot;);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         catch (SecurityException e) {</span>
<span class="line-removed">-             // If we can&#39;t read the propery, just use default collator</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         if (colFactClassname != null) {</span>
<span class="line-removed">-             try {</span>
<span class="line-removed">-                 Object candObj = ObjectFactory.findProviderClass(colFactClassname, true);</span>
<span class="line-removed">-                 _collatorFactory = (CollatorFactory)candObj;</span>
<span class="line-removed">-             } catch (ClassNotFoundException e) {</span>
<span class="line-removed">-                 throw new TransletException(e);</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-             Locale[] locales = settings.getLocales();</span>
<span class="line-removed">-             _collators = new Collator[levels];</span>
<span class="line-removed">-             for (int i = 0; i &lt; levels; i++){</span>
<span class="line-removed">-                 _collators[i] = _collatorFactory.getCollator(locales[i]);</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-             _collator = _collators[0];</span>
<span class="line-removed">-         } else {</span>
<span class="line-removed">-             _collators = settings.getCollators();</span>
<span class="line-removed">-             _collator = _collators[0];</span>
<span class="line-removed">-         }</span>
      }
  
      /**
       * Returns the node for this sort object
       */
<span class="line-new-header">--- 102,12 ---</span>
          _settings = settings;
  
          int levels = settings.getSortOrders().length;
          _values = new Object[levels];
  
<span class="line-modified">!         _collators = settings.getCollators();</span>
<span class="line-modified">!         _collator = _collators[0];</span>
      }
  
      /**
       * Returns the node for this sort object
       */
</pre>
<center><a href="../compiler/util/MethodGenerator.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../index.html" target="_top">index</a> <a href="../runtime/AbstractTranslet.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>