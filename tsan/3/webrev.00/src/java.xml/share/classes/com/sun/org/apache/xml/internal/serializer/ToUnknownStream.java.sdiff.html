<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.xml/share/classes/com/sun/org/apache/xml/internal/serializer/ToUnknownStream.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ToTextStream.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="ToXMLStream.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml/share/classes/com/sun/org/apache/xml/internal/serializer/ToUnknownStream.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2007, 2017, Oracle and/or its affiliates. All rights reserved.</span>
   3  */
   4 /*
   5  * Licensed to the Apache Software Foundation (ASF) under one or more
   6  * contributor license agreements.  See the NOTICE file distributed with
   7  * this work for additional information regarding copyright ownership.
   8  * The ASF licenses this file to You under the Apache License, Version 2.0
   9  * (the &quot;License&quot;); you may not use this file except in compliance with
  10  * the License.  You may obtain a copy of the License at
  11  *
  12  *     http://www.apache.org/licenses/LICENSE-2.0
  13  *
  14  * Unless required by applicable law or agreed to in writing, software
  15  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  16  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  17  * See the License for the specific language governing permissions and
  18  * limitations under the License.
  19  */
  20 
  21 package com.sun.org.apache.xml.internal.serializer;
  22 
  23 import java.io.IOException;
  24 import java.io.OutputStream;
  25 import java.io.Writer;
  26 import java.util.ArrayList;
  27 import java.util.List;
  28 import java.util.Properties;

  29 import javax.xml.transform.SourceLocator;
  30 import javax.xml.transform.Transformer;
  31 import org.w3c.dom.Node;
  32 import org.xml.sax.Attributes;
  33 import org.xml.sax.ContentHandler;
  34 import org.xml.sax.Locator;
  35 import org.xml.sax.SAXException;
  36 
  37 /**
  38  *This class wraps another SerializationHandler. The wrapped object will either
  39  * handler XML or HTML, which is not known until a little later when the first XML
  40  * tag is seen.  If the first tag is &lt;html&gt; then the wrapped object is an HTML
  41  * handler, otherwise it is an XML handler.
  42  *
  43  * This class effectively caches the first few calls to it then passes them
  44  * on to the wrapped handler (once it exists).  After that subsequent calls a
  45  * simply passed directly to the wrapped handler.
  46  *
  47  * The user of this class doesn&#39;t know if the output is ultimatley XML or HTML.
  48  *
  49  * This class is not a public API, it is public because it is used within Xalan.
  50  * @xsl.usage internal
<span class="line-modified">  51  * @LastModified: Oct 2017</span>
  52  */
  53 public final class ToUnknownStream extends SerializerBase
  54 {
  55     /**
  56      * The wrapped handler, initially XML but possibly switched to HTML
  57      */
  58     private SerializationHandler m_handler;
  59 
  60     /**
  61      * A String with no characters
  62      */
  63     private static final String EMPTYSTRING = &quot;&quot;;
  64 
  65     /**
  66      * true if the underlying handler (XML or HTML) is fully initialized
  67      */
  68     private boolean m_wrapped_handler_not_initialized = false;
  69 
  70     /**
  71      * the prefix of the very first tag in the document
</pre>
<hr />
<pre>
  99     private List&lt;String&gt; m_namespaceURI = null;
 100 
 101     /**
 102      * A collection of namespace Prefix (only for first element)
 103      * _namespaceURI has the matching URIs for these prefix&#39;
 104      */
 105     private List&lt;String&gt; m_namespacePrefix = null;
 106 
 107     /**
 108      * true if startDocument() was called before the underlying handler
 109      * was initialized
 110      */
 111     private boolean m_needToCallStartDocument = false;
 112 
 113     /**
 114      * Default constructor.
 115      * Initially this object wraps an XML Stream object, so _handler is never null.
 116      * That may change later to an HTML Stream object.
 117      */
 118     public ToUnknownStream() {
<span class="line-modified"> 119         m_handler = new ToXMLStream();</span>




 120     }
 121 
 122     /**
 123      * @see Serializer#asContentHandler()
 124      * @return the wrapped XML or HTML handler
 125      */
 126     public ContentHandler asContentHandler() throws IOException {
 127         /* don&#39;t return the real handler ( m_handler ) because
 128          * that would expose the real handler to the outside.
 129          * Keep m_handler private so it can be internally swapped
 130          * to an HTML handler.
 131          */
 132         return this;
 133     }
 134 
 135     /**
 136      * @see SerializationHandler#close()
 137      */
 138     public void close() {
 139         m_handler.close();
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2007, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   3  */
   4 /*
   5  * Licensed to the Apache Software Foundation (ASF) under one or more
   6  * contributor license agreements.  See the NOTICE file distributed with
   7  * this work for additional information regarding copyright ownership.
   8  * The ASF licenses this file to You under the Apache License, Version 2.0
   9  * (the &quot;License&quot;); you may not use this file except in compliance with
  10  * the License.  You may obtain a copy of the License at
  11  *
  12  *     http://www.apache.org/licenses/LICENSE-2.0
  13  *
  14  * Unless required by applicable law or agreed to in writing, software
  15  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  16  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  17  * See the License for the specific language governing permissions and
  18  * limitations under the License.
  19  */
  20 
  21 package com.sun.org.apache.xml.internal.serializer;
  22 
  23 import java.io.IOException;
  24 import java.io.OutputStream;
  25 import java.io.Writer;
  26 import java.util.ArrayList;
  27 import java.util.List;
  28 import java.util.Properties;
<span class="line-added">  29 import javax.xml.transform.ErrorListener;</span>
  30 import javax.xml.transform.SourceLocator;
  31 import javax.xml.transform.Transformer;
  32 import org.w3c.dom.Node;
  33 import org.xml.sax.Attributes;
  34 import org.xml.sax.ContentHandler;
  35 import org.xml.sax.Locator;
  36 import org.xml.sax.SAXException;
  37 
  38 /**
  39  *This class wraps another SerializationHandler. The wrapped object will either
  40  * handler XML or HTML, which is not known until a little later when the first XML
  41  * tag is seen.  If the first tag is &lt;html&gt; then the wrapped object is an HTML
  42  * handler, otherwise it is an XML handler.
  43  *
  44  * This class effectively caches the first few calls to it then passes them
  45  * on to the wrapped handler (once it exists).  After that subsequent calls a
  46  * simply passed directly to the wrapped handler.
  47  *
  48  * The user of this class doesn&#39;t know if the output is ultimatley XML or HTML.
  49  *
  50  * This class is not a public API, it is public because it is used within Xalan.
  51  * @xsl.usage internal
<span class="line-modified">  52  * @LastModified: Aug 2019</span>
  53  */
  54 public final class ToUnknownStream extends SerializerBase
  55 {
  56     /**
  57      * The wrapped handler, initially XML but possibly switched to HTML
  58      */
  59     private SerializationHandler m_handler;
  60 
  61     /**
  62      * A String with no characters
  63      */
  64     private static final String EMPTYSTRING = &quot;&quot;;
  65 
  66     /**
  67      * true if the underlying handler (XML or HTML) is fully initialized
  68      */
  69     private boolean m_wrapped_handler_not_initialized = false;
  70 
  71     /**
  72      * the prefix of the very first tag in the document
</pre>
<hr />
<pre>
 100     private List&lt;String&gt; m_namespaceURI = null;
 101 
 102     /**
 103      * A collection of namespace Prefix (only for first element)
 104      * _namespaceURI has the matching URIs for these prefix&#39;
 105      */
 106     private List&lt;String&gt; m_namespacePrefix = null;
 107 
 108     /**
 109      * true if startDocument() was called before the underlying handler
 110      * was initialized
 111      */
 112     private boolean m_needToCallStartDocument = false;
 113 
 114     /**
 115      * Default constructor.
 116      * Initially this object wraps an XML Stream object, so _handler is never null.
 117      * That may change later to an HTML Stream object.
 118      */
 119     public ToUnknownStream() {
<span class="line-modified"> 120         this(null);</span>
<span class="line-added"> 121     }</span>
<span class="line-added"> 122 </span>
<span class="line-added"> 123     public ToUnknownStream(ErrorListener l) {</span>
<span class="line-added"> 124         m_handler = new ToXMLStream(l);</span>
 125     }
 126 
 127     /**
 128      * @see Serializer#asContentHandler()
 129      * @return the wrapped XML or HTML handler
 130      */
 131     public ContentHandler asContentHandler() throws IOException {
 132         /* don&#39;t return the real handler ( m_handler ) because
 133          * that would expose the real handler to the outside.
 134          * Keep m_handler private so it can be internally swapped
 135          * to an HTML handler.
 136          */
 137         return this;
 138     }
 139 
 140     /**
 141      * @see SerializationHandler#close()
 142      */
 143     public void close() {
 144         m_handler.close();
</pre>
</td>
</tr>
</table>
<center><a href="ToTextStream.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="ToXMLStream.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>