<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.xml/share/classes/com/sun/org/apache/bcel/internal/Repository.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ExceptionConst.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="classfile/AccessFlags.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml/share/classes/com/sun/org/apache/bcel/internal/Repository.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2017, Oracle and/or its affiliates. All rights reserved.</span>
   */
  /*
   * Licensed to the Apache Software Foundation (ASF) under one or more
   * contributor license agreements.  See the NOTICE file distributed with
   * this work for additional information regarding copyright ownership.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2017, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   */
  /*
   * Licensed to the Apache Software Foundation (ASF) under one or more
   * contributor license agreements.  See the NOTICE file distributed with
   * this work for additional information regarding copyright ownership.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 23,212 ***</span>
  import com.sun.org.apache.bcel.internal.classfile.JavaClass;
  import com.sun.org.apache.bcel.internal.util.SyntheticRepository;
  
  /**
   * The repository maintains informations about class interdependencies, e.g.,
<span class="line-modified">!  * whether a class is a sub-class of another. Delegates actual class loading to</span>
<span class="line-modified">!  * SyntheticRepository with current class path by default.</span>
   *
   * @see com.sun.org.apache.bcel.internal.util.Repository
   * @see SyntheticRepository
   *
<span class="line-modified">!  * @version $Id: Repository.java 1749603 2016-06-21 20:50:19Z ggregory $</span>
   */
  public abstract class Repository {
  
      private static com.sun.org.apache.bcel.internal.util.Repository repository
              = SyntheticRepository.getInstance();
  
      /**
       * @return currently used repository instance
       */
      public static com.sun.org.apache.bcel.internal.util.Repository getRepository() {
          return repository;
      }
  
      /**
<span class="line-modified">!      * Set repository instance to be used for class loading</span>
       */
<span class="line-modified">!     public static void setRepository(final com.sun.org.apache.bcel.internal.util.Repository rep) {</span>
          repository = rep;
      }
  
      /**
<span class="line-modified">!      * Lookup class somewhere found on your CLASSPATH, or whereever the</span>
       * repository instance looks for it.
       *
       * @return class object for given fully qualified class name
<span class="line-modified">!      * @throws ClassNotFoundException if the class could not be found or parsed</span>
<span class="line-modified">!      * correctly</span>
       */
<span class="line-modified">!     public static JavaClass lookupClass(final String class_name)</span>
<span class="line-removed">-             throws ClassNotFoundException {</span>
          return repository.loadClass(class_name);
      }
  
      /**
<span class="line-modified">!      * Try to find class source using the internal repository instance.</span>
       *
       * @see Class
       * @return JavaClass object for given runtime class
<span class="line-modified">!      * @throws ClassNotFoundException if the class could not be found or parsed</span>
<span class="line-modified">!      * correctly</span>
       */
<span class="line-modified">!     public static JavaClass lookupClass(final Class&lt;?&gt; clazz)</span>
<span class="line-removed">-             throws ClassNotFoundException {</span>
          return repository.loadClass(clazz);
      }
  
      /**
       * Clear the repository.
       */
      public static void clearCache() {
          repository.clear();
      }
  
      /**
<span class="line-modified">!      * Add clazz to repository if there isn&#39;t an equally named class already in</span>
<span class="line-removed">-      * there.</span>
       *
       * @return old entry in repository
       */
<span class="line-modified">!     public static JavaClass addClass(final JavaClass clazz) {</span>
          final JavaClass old = repository.findClass(clazz.getClassName());
          repository.storeClass(clazz);
          return old;
      }
  
      /**
<span class="line-modified">!      * Remove class with given (fully qualified) name from repository.</span>
       */
<span class="line-modified">!     public static void removeClass(final String clazz) {</span>
          repository.removeClass(repository.findClass(clazz));
      }
  
      /**
<span class="line-modified">!      * Remove given class from repository.</span>
       */
<span class="line-modified">!     public static void removeClass(final JavaClass clazz) {</span>
          repository.removeClass(clazz);
      }
  
      /**
<span class="line-modified">!      * @return list of super classes of clazz in ascending order, i.e., Object</span>
<span class="line-modified">!      * is always the last element</span>
       * @throws ClassNotFoundException if any of the superclasses can&#39;t be found
       */
<span class="line-modified">!     public static JavaClass[] getSuperClasses(final JavaClass clazz) throws ClassNotFoundException {</span>
          return clazz.getSuperClasses();
      }
  
      /**
<span class="line-modified">!      * @return list of super classes of clazz in ascending order, i.e., Object</span>
<span class="line-modified">!      * is always the last element.</span>
       * @throws ClassNotFoundException if the named class or any of its
<span class="line-modified">!      * superclasses can&#39;t be found</span>
       */
<span class="line-modified">!     public static JavaClass[] getSuperClasses(final String class_name) throws ClassNotFoundException {</span>
          final JavaClass jc = lookupClass(class_name);
          return getSuperClasses(jc);
      }
  
      /**
<span class="line-modified">!      * @return all interfaces implemented by class and its super classes and the</span>
<span class="line-modified">!      * interfaces that those interfaces extend, and so on. (Some people call</span>
<span class="line-modified">!      * this a transitive hull).</span>
<span class="line-modified">!      * @throws ClassNotFoundException if any of the class&#39;s superclasses or</span>
<span class="line-modified">!      * superinterfaces can&#39;t be found</span>
       */
<span class="line-modified">!     public static JavaClass[] getInterfaces(final JavaClass clazz) throws ClassNotFoundException {</span>
          return clazz.getAllInterfaces();
      }
  
      /**
<span class="line-modified">!      * @return all interfaces implemented by class and its super classes and the</span>
<span class="line-modified">!      * interfaces that extend those interfaces, and so on</span>
<span class="line-modified">!      * @throws ClassNotFoundException if the named class can&#39;t be found, or if</span>
<span class="line-modified">!      * any of its superclasses or superinterfaces can&#39;t be found</span>
       */
<span class="line-modified">!     public static JavaClass[] getInterfaces(final String class_name) throws ClassNotFoundException {</span>
          return getInterfaces(lookupClass(class_name));
      }
  
      /**
       * Equivalent to runtime &quot;instanceof&quot; operator.
<span class="line-removed">-      *</span>
       * @return true, if clazz is an instance of super_class
<span class="line-modified">!      * @throws ClassNotFoundException if any superclasses or superinterfaces of</span>
<span class="line-modified">!      * clazz can&#39;t be found</span>
       */
<span class="line-modified">!     public static boolean instanceOf(final JavaClass clazz, final JavaClass super_class)</span>
              throws ClassNotFoundException {
          return clazz.instanceOf(super_class);
      }
  
      /**
       * @return true, if clazz is an instance of super_class
<span class="line-modified">!      * @throws ClassNotFoundException if either clazz or super_class can&#39;t be</span>
<span class="line-modified">!      * found</span>
       */
<span class="line-modified">!     public static boolean instanceOf(final String clazz, final String super_class)</span>
              throws ClassNotFoundException {
          return instanceOf(lookupClass(clazz), lookupClass(super_class));
      }
  
      /**
       * @return true, if clazz is an instance of super_class
       * @throws ClassNotFoundException if super_class can&#39;t be found
       */
<span class="line-modified">!     public static boolean instanceOf(final JavaClass clazz, final String super_class)</span>
              throws ClassNotFoundException {
          return instanceOf(clazz, lookupClass(super_class));
      }
  
      /**
       * @return true, if clazz is an instance of super_class
       * @throws ClassNotFoundException if clazz can&#39;t be found
       */
<span class="line-modified">!     public static boolean instanceOf(final String clazz, final JavaClass super_class)</span>
              throws ClassNotFoundException {
          return instanceOf(lookupClass(clazz), super_class);
      }
  
      /**
       * @return true, if clazz is an implementation of interface inter
<span class="line-modified">!      * @throws ClassNotFoundException if any superclasses or superinterfaces of</span>
<span class="line-modified">!      * clazz can&#39;t be found</span>
       */
<span class="line-modified">!     public static boolean implementationOf(final JavaClass clazz, final JavaClass inter)</span>
              throws ClassNotFoundException {
          return clazz.implementationOf(inter);
      }
  
      /**
       * @return true, if clazz is an implementation of interface inter
<span class="line-modified">!      * @throws ClassNotFoundException if clazz, inter, or any superclasses or</span>
<span class="line-modified">!      * superinterfaces of clazz can&#39;t be found</span>
       */
<span class="line-modified">!     public static boolean implementationOf(final String clazz, final String inter)</span>
              throws ClassNotFoundException {
          return implementationOf(lookupClass(clazz), lookupClass(inter));
      }
  
      /**
       * @return true, if clazz is an implementation of interface inter
<span class="line-modified">!      * @throws ClassNotFoundException if inter or any superclasses or</span>
<span class="line-modified">!      * superinterfaces of clazz can&#39;t be found</span>
       */
<span class="line-modified">!     public static boolean implementationOf(final JavaClass clazz, final String inter)</span>
              throws ClassNotFoundException {
          return implementationOf(clazz, lookupClass(inter));
      }
  
      /**
       * @return true, if clazz is an implementation of interface inter
       * @throws ClassNotFoundException if clazz or any superclasses or
<span class="line-modified">!      * superinterfaces of clazz can&#39;t be found</span>
       */
<span class="line-modified">!     public static boolean implementationOf(final String clazz, final JavaClass inter)</span>
              throws ClassNotFoundException {
          return implementationOf(lookupClass(clazz), inter);
      }
  }
<span class="line-new-header">--- 23,228 ---</span>
  import com.sun.org.apache.bcel.internal.classfile.JavaClass;
  import com.sun.org.apache.bcel.internal.util.SyntheticRepository;
  
  /**
   * The repository maintains informations about class interdependencies, e.g.,
<span class="line-modified">!  * whether a class is a sub-class of another. Delegates actual class loading</span>
<span class="line-modified">!  * to SyntheticRepository with current class path by default.</span>
   *
   * @see com.sun.org.apache.bcel.internal.util.Repository
   * @see SyntheticRepository
   *
<span class="line-modified">!  * @LastModified: Jan 2020</span>
   */
  public abstract class Repository {
  
      private static com.sun.org.apache.bcel.internal.util.Repository repository
              = SyntheticRepository.getInstance();
  
<span class="line-added">+ </span>
      /**
       * @return currently used repository instance
       */
      public static com.sun.org.apache.bcel.internal.util.Repository getRepository() {
          return repository;
      }
  
<span class="line-added">+ </span>
      /**
<span class="line-modified">!      * Sets repository instance to be used for class loading</span>
       */
<span class="line-modified">!     public static void setRepository( final com.sun.org.apache.bcel.internal.util.Repository rep ) {</span>
          repository = rep;
      }
  
<span class="line-added">+ </span>
      /**
<span class="line-modified">!      * Lookups class somewhere found on your CLASSPATH, or whereever the</span>
       * repository instance looks for it.
       *
       * @return class object for given fully qualified class name
<span class="line-modified">!      * @throws ClassNotFoundException if the class could not be found or</span>
<span class="line-modified">!      * parsed correctly</span>
       */
<span class="line-modified">!     public static JavaClass lookupClass( final String class_name ) throws ClassNotFoundException {</span>
          return repository.loadClass(class_name);
      }
  
<span class="line-added">+ </span>
      /**
<span class="line-modified">!      * Tries to find class source using the internal repository instance.</span>
       *
       * @see Class
       * @return JavaClass object for given runtime class
<span class="line-modified">!      * @throws ClassNotFoundException if the class could not be found or</span>
<span class="line-modified">!      * parsed correctly</span>
       */
<span class="line-modified">!     public static JavaClass lookupClass( final Class&lt;?&gt; clazz ) throws ClassNotFoundException {</span>
          return repository.loadClass(clazz);
      }
  
<span class="line-added">+ </span>
      /**
       * Clear the repository.
       */
      public static void clearCache() {
          repository.clear();
      }
  
<span class="line-added">+ </span>
      /**
<span class="line-modified">!      * Adds clazz to repository if there isn&#39;t an equally named class already in there.</span>
       *
       * @return old entry in repository
       */
<span class="line-modified">!     public static JavaClass addClass( final JavaClass clazz ) {</span>
          final JavaClass old = repository.findClass(clazz.getClassName());
          repository.storeClass(clazz);
          return old;
      }
  
<span class="line-added">+ </span>
      /**
<span class="line-modified">!      * Removes class with given (fully qualified) name from repository.</span>
       */
<span class="line-modified">!     public static void removeClass( final String clazz ) {</span>
          repository.removeClass(repository.findClass(clazz));
      }
  
<span class="line-added">+ </span>
      /**
<span class="line-modified">!      * Removes given class from repository.</span>
       */
<span class="line-modified">!     public static void removeClass( final JavaClass clazz ) {</span>
          repository.removeClass(clazz);
      }
  
<span class="line-added">+ </span>
      /**
<span class="line-modified">!      * @return list of super classes of clazz in ascending order, i.e.,</span>
<span class="line-modified">!      * Object is always the last element</span>
       * @throws ClassNotFoundException if any of the superclasses can&#39;t be found
       */
<span class="line-modified">!     public static JavaClass[] getSuperClasses( final JavaClass clazz ) throws ClassNotFoundException {</span>
          return clazz.getSuperClasses();
      }
  
<span class="line-added">+ </span>
      /**
<span class="line-modified">!      * @return list of super classes of clazz in ascending order, i.e.,</span>
<span class="line-modified">!      * Object is always the last element.</span>
       * @throws ClassNotFoundException if the named class or any of its
<span class="line-modified">!      *  superclasses can&#39;t be found</span>
       */
<span class="line-modified">!     public static JavaClass[] getSuperClasses( final String class_name ) throws ClassNotFoundException {</span>
          final JavaClass jc = lookupClass(class_name);
          return getSuperClasses(jc);
      }
  
<span class="line-added">+ </span>
      /**
<span class="line-modified">!      * @return all interfaces implemented by class and its super</span>
<span class="line-modified">!      * classes and the interfaces that those interfaces extend, and so on.</span>
<span class="line-modified">!      * (Some people call this a transitive hull).</span>
<span class="line-modified">!      * @throws ClassNotFoundException if any of the class&#39;s</span>
<span class="line-modified">!      *  superclasses or superinterfaces can&#39;t be found</span>
       */
<span class="line-modified">!     public static JavaClass[] getInterfaces( final JavaClass clazz ) throws ClassNotFoundException {</span>
          return clazz.getAllInterfaces();
      }
  
<span class="line-added">+ </span>
      /**
<span class="line-modified">!      * @return all interfaces implemented by class and its super</span>
<span class="line-modified">!      * classes and the interfaces that extend those interfaces, and so on</span>
<span class="line-modified">!      * @throws ClassNotFoundException if the named class can&#39;t be found,</span>
<span class="line-modified">!      *   or if any of its superclasses or superinterfaces can&#39;t be found</span>
       */
<span class="line-modified">!     public static JavaClass[] getInterfaces( final String class_name ) throws ClassNotFoundException {</span>
          return getInterfaces(lookupClass(class_name));
      }
  
<span class="line-added">+ </span>
      /**
       * Equivalent to runtime &quot;instanceof&quot; operator.
       * @return true, if clazz is an instance of super_class
<span class="line-modified">!      * @throws ClassNotFoundException if any superclasses or superinterfaces</span>
<span class="line-modified">!      *   of clazz can&#39;t be found</span>
       */
<span class="line-modified">!     public static boolean instanceOf( final JavaClass clazz, final JavaClass super_class )</span>
              throws ClassNotFoundException {
          return clazz.instanceOf(super_class);
      }
  
<span class="line-added">+ </span>
      /**
       * @return true, if clazz is an instance of super_class
<span class="line-modified">!      * @throws ClassNotFoundException if either clazz or super_class</span>
<span class="line-modified">!      *   can&#39;t be found</span>
       */
<span class="line-modified">!     public static boolean instanceOf( final String clazz, final String super_class )</span>
              throws ClassNotFoundException {
          return instanceOf(lookupClass(clazz), lookupClass(super_class));
      }
  
<span class="line-added">+ </span>
      /**
       * @return true, if clazz is an instance of super_class
       * @throws ClassNotFoundException if super_class can&#39;t be found
       */
<span class="line-modified">!     public static boolean instanceOf( final JavaClass clazz, final String super_class )</span>
              throws ClassNotFoundException {
          return instanceOf(clazz, lookupClass(super_class));
      }
  
<span class="line-added">+ </span>
      /**
       * @return true, if clazz is an instance of super_class
       * @throws ClassNotFoundException if clazz can&#39;t be found
       */
<span class="line-modified">!     public static boolean instanceOf( final String clazz, final JavaClass super_class )</span>
              throws ClassNotFoundException {
          return instanceOf(lookupClass(clazz), super_class);
      }
  
<span class="line-added">+ </span>
      /**
       * @return true, if clazz is an implementation of interface inter
<span class="line-modified">!      * @throws ClassNotFoundException if any superclasses or superinterfaces</span>
<span class="line-modified">!      *   of clazz can&#39;t be found</span>
       */
<span class="line-modified">!     public static boolean implementationOf( final JavaClass clazz, final JavaClass inter )</span>
              throws ClassNotFoundException {
          return clazz.implementationOf(inter);
      }
  
<span class="line-added">+ </span>
      /**
       * @return true, if clazz is an implementation of interface inter
<span class="line-modified">!      * @throws ClassNotFoundException if clazz, inter, or any superclasses</span>
<span class="line-modified">!      *   or superinterfaces of clazz can&#39;t be found</span>
       */
<span class="line-modified">!     public static boolean implementationOf( final String clazz, final String inter )</span>
              throws ClassNotFoundException {
          return implementationOf(lookupClass(clazz), lookupClass(inter));
      }
  
<span class="line-added">+ </span>
      /**
       * @return true, if clazz is an implementation of interface inter
<span class="line-modified">!      * @throws ClassNotFoundException if inter or any superclasses</span>
<span class="line-modified">!      *   or superinterfaces of clazz can&#39;t be found</span>
       */
<span class="line-modified">!     public static boolean implementationOf( final JavaClass clazz, final String inter )</span>
              throws ClassNotFoundException {
          return implementationOf(clazz, lookupClass(inter));
      }
  
<span class="line-added">+ </span>
      /**
       * @return true, if clazz is an implementation of interface inter
       * @throws ClassNotFoundException if clazz or any superclasses or
<span class="line-modified">!      *   superinterfaces of clazz can&#39;t be found</span>
       */
<span class="line-modified">!     public static boolean implementationOf( final String clazz, final JavaClass inter )</span>
              throws ClassNotFoundException {
          return implementationOf(lookupClass(clazz), inter);
      }
  }
</pre>
<center><a href="ExceptionConst.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="classfile/AccessFlags.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>