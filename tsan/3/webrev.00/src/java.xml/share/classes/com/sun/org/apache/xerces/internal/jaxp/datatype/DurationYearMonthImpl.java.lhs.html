<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.xml/share/classes/com/sun/org/apache/xerces/internal/jaxp/datatype/DurationYearMonthImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 2010, 2017 Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package com.sun.org.apache.xerces.internal.jaxp.datatype;
 27 
 28 import java.math.BigInteger;
 29 import javax.xml.datatype.DatatypeConstants;
 30 
 31 
 32 /**
 33  * &lt;p&gt;Represent a subtype &lt;code&gt;xdt:yearMonthDuration&lt;/code&gt; of a &lt;code&gt;Duration&lt;/code&gt;
 34  * as specified in &lt;a href=&quot;http://www.w3.org/TR/xpath-datamodel#yearMonthDuration&quot;&gt;
 35  *   XQuery 1.0 and XPath 2.0 Data Model, xdt:yearMonthDuration&lt;/a&gt;.&lt;/p&gt;
 36  *
 37  *
 38  * &lt;p&gt;The DurationYearMonth object represents a period of Gregorian time,
 39  * with a lexical representation, &quot;&lt;em&gt;PnYnM&lt;/em&gt;&quot; that contains only year and month components.
 40  * &lt;/p&gt;
 41  *
 42  *
 43  * @author Vikram Aroskar
 44  * @see XMLGregorianCalendar#add(Duration)
 45  */
 46 
 47 class DurationYearMonthImpl
 48         extends DurationImpl {
 49     private static final long serialVersionUID = -4430140662861507958L;
 50 
 51     /**
 52      * &lt;p&gt;Constructs a new Duration object by specifying each field individually.&lt;/p&gt;
 53      *
 54      * &lt;p&gt;All the parameters are optional as long as at least one field is present.
 55      * If specified, parameters have to be zero or positive.&lt;/p&gt;
 56      *
 57      * @param isPositive Set to &lt;code&gt;false&lt;/code&gt; to create a negative duration. When the length
 58      *   of the duration is zero, this parameter will be ignored.
 59      * @param years of this &lt;code&gt;Duration&lt;/code&gt;
 60      * @param months of this &lt;code&gt;Duration&lt;/code&gt;
 61      *
 62      * @throws IllegalArgumentException
 63      *    If years, months parameters are all &lt;code&gt;null&lt;/code&gt;. Or if any
 64      *    of those parameters are negative.
 65      */
 66     public DurationYearMonthImpl(
 67         boolean isPositive,
 68         BigInteger years,
 69         BigInteger months) {
 70 
 71         super(isPositive, years, months, null, null, null, null);
 72         convertToCanonicalYearMonth();
 73     }
 74         /**
 75          * &lt;p&gt;Construct a &lt;code&gt;Duration&lt;/code&gt; of type &lt;code&gt;xdt:yearMonthDuration&lt;/code&gt; using the specified
 76          * &lt;code&gt;year&lt;/code&gt; and &lt;code&gt;month&lt;/code&gt; as defined in
 77          * &lt;a href=&quot;http://www.w3.org/TR/xpath-datamodel#yearMonthDuration&quot;&gt;
 78          *   XQuery 1.0 and XPath 2.0 Data Model, xdt:yearMonthDuration&lt;/a&gt;.&lt;/p&gt;
 79          *
 80      * &lt;p&gt;A {@link DatatypeConstants#FIELD_UNDEFINED} value indicates that field is not set.&lt;/p&gt;
 81      *
 82      * @param isPositive Set to &lt;code&gt;false&lt;/code&gt; to create a negative duration. When the length
 83      *   of the duration is zero, this parameter will be ignored.
 84          * @param year Year of &lt;code&gt;Duration&lt;/code&gt;.
 85          * @param month Month of &lt;code&gt;Duration&lt;/code&gt;.
 86          *
 87          * @throws IllegalArgumentException If the values are not a valid representation of a
 88          * &lt;code&gt;Duration&lt;/code&gt;: if any of the fields (year, month) is negative.
 89          */
 90     protected DurationYearMonthImpl(
 91         final boolean isPositive,
 92         final int years,
 93         final int months) {
 94 
 95         this(isPositive,
 96             wrap(years),
 97             wrap(months));
 98 
 99 
100     }
101 
102 
103         /**
104          * &lt;p&gt;Construct a &lt;code&gt;Duration&lt;/code&gt; of type &lt;code&gt;xdt:yearMonthDuration&lt;/code&gt; using the specified milliseconds as defined in
105          * &lt;a href=&quot;http://www.w3.org/TR/xpath-datamodel#yearMonthDuration&quot;&gt;
106          *   XQuery 1.0 and XPath 2.0 Data Model, xdt:yearMonthDuration&lt;/a&gt;.&lt;/p&gt;
107          *
108          * &lt;p&gt;The datatype &lt;code&gt;xdt:yearMonthDuration&lt;/code&gt; is a subtype of &lt;code&gt;xs:duration&lt;/code&gt;
109          * whose lexical representation contains only year and month components.
110          * This datatype resides in the namespace {@link javax.xml.XMLConstants#W3C_XPATH_DATATYPE_NS_URI}.&lt;/p&gt;
111          *
112      * &lt;p&gt;Both values are set by computing their values from the specified milliseconds
113      * and are availabe using the &lt;code&gt;get&lt;/code&gt; methods of  the created {@link Duration}.
114      * The values conform to and are defined by:&lt;/p&gt;
115      * &lt;ul&gt;
116      *   &lt;li&gt;ISO 8601:2000(E) Section 5.5.3.2 Alternative format&lt;/li&gt;
117      *   &lt;li&gt;&lt;a href=&quot;http://www.w3.org/TR/xmlschema-2/#isoformats&quot;&gt;
118      *     W3C XML Schema 1.0 Part 2, Appendix D, ISO 8601 Date and Time Formats&lt;/a&gt;
119      *   &lt;/li&gt;
120      *   &lt;li&gt;{@link XMLGregorianCalendar}  Date/Time Datatype Field Mapping Between XML Schema 1.0 and Java Representation&lt;/li&gt;
121      * &lt;/ul&gt;
122      *
123          * &lt;p&gt;The default start instance is defined by {@link GregorianCalendar}&#39;s use of the start of the epoch: i.e.,
124          * {@link java.util.Calendar#YEAR} = 1970,
125          * {@link java.util.Calendar#MONTH} = {@link java.util.Calendar#JANUARY},
126          * {@link java.util.Calendar#DATE} = 1, etc.
127          * This is important as there are variations in the Gregorian Calendar,
128          * e.g. leap years have different days in the month = {@link java.util.Calendar#FEBRUARY}
129          * so the result of {@link Duration#getMonths()} can be influenced.&lt;/p&gt;
130          *
131      * &lt;p&gt;Any remaining milliseconds after determining the year and month are discarded.&lt;/p&gt;
132          *
133          * @param durationInMilliseconds Milliseconds of &lt;code&gt;Duration&lt;/code&gt; to create.
134          */
135     protected DurationYearMonthImpl(long durationInMilliseconds) {
136 
137         super(durationInMilliseconds);
138         convertToCanonicalYearMonth();
139         //Any remaining milliseconds after determining the year and month are discarded.
140         days = null;
141         hours = null;
142         minutes = null;
143         seconds = null;
144         signum = calcSignum((signum&lt;0)?false:true);
145     }
146 
147 
148         /**
149          * &lt;p&gt;Construct a &lt;code&gt;Duration&lt;/code&gt; of type &lt;code&gt;xdt:yearMonthDuration&lt;/code&gt; by parsing its &lt;code&gt;String&lt;/code&gt; representation,
150          * &quot;&lt;em&gt;PnYnM&lt;/em&gt;&quot;, &lt;a href=&quot;http://www.w3.org/TR/xpath-datamodel#yearMonthDuration&quot;&gt;
151          *   XQuery 1.0 and XPath 2.0 Data Model, xdt:yearMonthDuration&lt;/a&gt;.&lt;/p&gt;
152          *
153          * &lt;p&gt;The datatype &lt;code&gt;xdt:yearMonthDuration&lt;/code&gt; is a subtype of &lt;code&gt;xs:duration&lt;/code&gt;
154          * whose lexical representation contains only year and month components.
155          * This datatype resides in the namespace {@link javax.xml.XMLConstants#W3C_XPATH_DATATYPE_NS_URI}.&lt;/p&gt;
156          *
157      * &lt;p&gt;Both values are set and availabe from the created {@link Duration}&lt;/p&gt;
158          *
159      * &lt;p&gt;The XML Schema specification states that values can be of an arbitrary size.
160      * Implementations may chose not to or be incapable of supporting arbitrarily large and/or small values.
161      * An {@link UnsupportedOperationException} will be thrown with a message indicating implementation limits
162      * if implementation capacities are exceeded.&lt;/p&gt;
163      *
164          * @param lexicalRepresentation Lexical representation of a duration.
165          *
166          * @throws IllegalArgumentException If &lt;code&gt;lexicalRepresentation&lt;/code&gt; is not a valid representation of a &lt;code&gt;Duration&lt;/code&gt; expressed only in terms of years and months.
167          * @throws UnsupportedOperationException If implementation cannot support requested values.
168          * @throws NullPointerException If &lt;code&gt;lexicalRepresentation&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;.
169          */
170     protected DurationYearMonthImpl(String lexicalRepresentation) {
171         super(lexicalRepresentation);
172         if (getDays() &gt; 0 || getHours() &gt; 0
173                 || getMinutes() &gt; 0 || getSeconds() &gt; 0) {
174             throw new IllegalArgumentException(
175                     &quot;Trying to create an xdt:yearMonthDuration with an invalid&quot;
176                     + &quot; lexical representation of \&quot;&quot; + lexicalRepresentation
177                     + &quot;\&quot;, data model requires PnYnM.&quot;);
178         }
179         convertToCanonicalYearMonth();
180     }
181 
182     /**
183      * The value space of xs:yearMonthDuration is the set of xs:integer month values.
184      * @return the value of yearMonthDuration
185      */
186     public int getValue() {
187         return getYears() * 12 + getMonths();
188     }
189 
190     private void convertToCanonicalYearMonth() {
191         while (getMonths() &gt;= 12)
192         {
193             months = months.subtract(BigInteger.valueOf(12));
194             years = BigInteger.valueOf((long) getYears()).add(BigInteger.ONE);
195         }
196     }
197 }
<a name="2" id="anc2"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="2" type="hidden" />
</body>
</html>