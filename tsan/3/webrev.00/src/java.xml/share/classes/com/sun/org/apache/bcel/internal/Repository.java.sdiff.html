<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.xml/share/classes/com/sun/org/apache/bcel/internal/Repository.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ExceptionConst.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="classfile/AccessFlags.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml/share/classes/com/sun/org/apache/bcel/internal/Repository.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2017, Oracle and/or its affiliates. All rights reserved.</span>
  3  */
  4 /*
  5  * Licensed to the Apache Software Foundation (ASF) under one or more
  6  * contributor license agreements.  See the NOTICE file distributed with
  7  * this work for additional information regarding copyright ownership.
  8  * The ASF licenses this file to You under the Apache License, Version 2.0
  9  * (the &quot;License&quot;); you may not use this file except in compliance with
 10  * the License.  You may obtain a copy of the License at
 11  *
 12  *      http://www.apache.org/licenses/LICENSE-2.0
 13  *
 14  * Unless required by applicable law or agreed to in writing, software
 15  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 16  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 17  * See the License for the specific language governing permissions and
 18  * limitations under the License.
 19  */
 20 package com.sun.org.apache.bcel.internal;
 21 
 22 
 23 import com.sun.org.apache.bcel.internal.classfile.JavaClass;
 24 import com.sun.org.apache.bcel.internal.util.SyntheticRepository;
 25 
 26 /**
 27  * The repository maintains informations about class interdependencies, e.g.,
<span class="line-modified"> 28  * whether a class is a sub-class of another. Delegates actual class loading to</span>
<span class="line-modified"> 29  * SyntheticRepository with current class path by default.</span>
 30  *
 31  * @see com.sun.org.apache.bcel.internal.util.Repository
 32  * @see SyntheticRepository
 33  *
<span class="line-modified"> 34  * @version $Id: Repository.java 1749603 2016-06-21 20:50:19Z ggregory $</span>
 35  */
 36 public abstract class Repository {
 37 
 38     private static com.sun.org.apache.bcel.internal.util.Repository repository
 39             = SyntheticRepository.getInstance();
 40 

 41     /**
 42      * @return currently used repository instance
 43      */
 44     public static com.sun.org.apache.bcel.internal.util.Repository getRepository() {
 45         return repository;
 46     }
 47 

 48     /**
<span class="line-modified"> 49      * Set repository instance to be used for class loading</span>
 50      */
<span class="line-modified"> 51     public static void setRepository(final com.sun.org.apache.bcel.internal.util.Repository rep) {</span>
 52         repository = rep;
 53     }
 54 

 55     /**
<span class="line-modified"> 56      * Lookup class somewhere found on your CLASSPATH, or whereever the</span>
 57      * repository instance looks for it.
 58      *
 59      * @return class object for given fully qualified class name
<span class="line-modified"> 60      * @throws ClassNotFoundException if the class could not be found or parsed</span>
<span class="line-modified"> 61      * correctly</span>
 62      */
<span class="line-modified"> 63     public static JavaClass lookupClass(final String class_name)</span>
<span class="line-removed"> 64             throws ClassNotFoundException {</span>
 65         return repository.loadClass(class_name);
 66     }
 67 

 68     /**
<span class="line-modified"> 69      * Try to find class source using the internal repository instance.</span>
 70      *
 71      * @see Class
 72      * @return JavaClass object for given runtime class
<span class="line-modified"> 73      * @throws ClassNotFoundException if the class could not be found or parsed</span>
<span class="line-modified"> 74      * correctly</span>
 75      */
<span class="line-modified"> 76     public static JavaClass lookupClass(final Class&lt;?&gt; clazz)</span>
<span class="line-removed"> 77             throws ClassNotFoundException {</span>
 78         return repository.loadClass(clazz);
 79     }
 80 

 81     /**
 82      * Clear the repository.
 83      */
 84     public static void clearCache() {
 85         repository.clear();
 86     }
 87 

 88     /**
<span class="line-modified"> 89      * Add clazz to repository if there isn&#39;t an equally named class already in</span>
<span class="line-removed"> 90      * there.</span>
 91      *
 92      * @return old entry in repository
 93      */
<span class="line-modified"> 94     public static JavaClass addClass(final JavaClass clazz) {</span>
 95         final JavaClass old = repository.findClass(clazz.getClassName());
 96         repository.storeClass(clazz);
 97         return old;
 98     }
 99 

100     /**
<span class="line-modified">101      * Remove class with given (fully qualified) name from repository.</span>
102      */
<span class="line-modified">103     public static void removeClass(final String clazz) {</span>
104         repository.removeClass(repository.findClass(clazz));
105     }
106 

107     /**
<span class="line-modified">108      * Remove given class from repository.</span>
109      */
<span class="line-modified">110     public static void removeClass(final JavaClass clazz) {</span>
111         repository.removeClass(clazz);
112     }
113 

114     /**
<span class="line-modified">115      * @return list of super classes of clazz in ascending order, i.e., Object</span>
<span class="line-modified">116      * is always the last element</span>
117      * @throws ClassNotFoundException if any of the superclasses can&#39;t be found
118      */
<span class="line-modified">119     public static JavaClass[] getSuperClasses(final JavaClass clazz) throws ClassNotFoundException {</span>
120         return clazz.getSuperClasses();
121     }
122 

123     /**
<span class="line-modified">124      * @return list of super classes of clazz in ascending order, i.e., Object</span>
<span class="line-modified">125      * is always the last element.</span>
126      * @throws ClassNotFoundException if the named class or any of its
<span class="line-modified">127      * superclasses can&#39;t be found</span>
128      */
<span class="line-modified">129     public static JavaClass[] getSuperClasses(final String class_name) throws ClassNotFoundException {</span>
130         final JavaClass jc = lookupClass(class_name);
131         return getSuperClasses(jc);
132     }
133 

134     /**
<span class="line-modified">135      * @return all interfaces implemented by class and its super classes and the</span>
<span class="line-modified">136      * interfaces that those interfaces extend, and so on. (Some people call</span>
<span class="line-modified">137      * this a transitive hull).</span>
<span class="line-modified">138      * @throws ClassNotFoundException if any of the class&#39;s superclasses or</span>
<span class="line-modified">139      * superinterfaces can&#39;t be found</span>
140      */
<span class="line-modified">141     public static JavaClass[] getInterfaces(final JavaClass clazz) throws ClassNotFoundException {</span>
142         return clazz.getAllInterfaces();
143     }
144 

145     /**
<span class="line-modified">146      * @return all interfaces implemented by class and its super classes and the</span>
<span class="line-modified">147      * interfaces that extend those interfaces, and so on</span>
<span class="line-modified">148      * @throws ClassNotFoundException if the named class can&#39;t be found, or if</span>
<span class="line-modified">149      * any of its superclasses or superinterfaces can&#39;t be found</span>
150      */
<span class="line-modified">151     public static JavaClass[] getInterfaces(final String class_name) throws ClassNotFoundException {</span>
152         return getInterfaces(lookupClass(class_name));
153     }
154 

155     /**
156      * Equivalent to runtime &quot;instanceof&quot; operator.
<span class="line-removed">157      *</span>
158      * @return true, if clazz is an instance of super_class
<span class="line-modified">159      * @throws ClassNotFoundException if any superclasses or superinterfaces of</span>
<span class="line-modified">160      * clazz can&#39;t be found</span>
161      */
<span class="line-modified">162     public static boolean instanceOf(final JavaClass clazz, final JavaClass super_class)</span>
163             throws ClassNotFoundException {
164         return clazz.instanceOf(super_class);
165     }
166 

167     /**
168      * @return true, if clazz is an instance of super_class
<span class="line-modified">169      * @throws ClassNotFoundException if either clazz or super_class can&#39;t be</span>
<span class="line-modified">170      * found</span>
171      */
<span class="line-modified">172     public static boolean instanceOf(final String clazz, final String super_class)</span>
173             throws ClassNotFoundException {
174         return instanceOf(lookupClass(clazz), lookupClass(super_class));
175     }
176 

177     /**
178      * @return true, if clazz is an instance of super_class
179      * @throws ClassNotFoundException if super_class can&#39;t be found
180      */
<span class="line-modified">181     public static boolean instanceOf(final JavaClass clazz, final String super_class)</span>
182             throws ClassNotFoundException {
183         return instanceOf(clazz, lookupClass(super_class));
184     }
185 

186     /**
187      * @return true, if clazz is an instance of super_class
188      * @throws ClassNotFoundException if clazz can&#39;t be found
189      */
<span class="line-modified">190     public static boolean instanceOf(final String clazz, final JavaClass super_class)</span>
191             throws ClassNotFoundException {
192         return instanceOf(lookupClass(clazz), super_class);
193     }
194 

195     /**
196      * @return true, if clazz is an implementation of interface inter
<span class="line-modified">197      * @throws ClassNotFoundException if any superclasses or superinterfaces of</span>
<span class="line-modified">198      * clazz can&#39;t be found</span>
199      */
<span class="line-modified">200     public static boolean implementationOf(final JavaClass clazz, final JavaClass inter)</span>
201             throws ClassNotFoundException {
202         return clazz.implementationOf(inter);
203     }
204 

205     /**
206      * @return true, if clazz is an implementation of interface inter
<span class="line-modified">207      * @throws ClassNotFoundException if clazz, inter, or any superclasses or</span>
<span class="line-modified">208      * superinterfaces of clazz can&#39;t be found</span>
209      */
<span class="line-modified">210     public static boolean implementationOf(final String clazz, final String inter)</span>
211             throws ClassNotFoundException {
212         return implementationOf(lookupClass(clazz), lookupClass(inter));
213     }
214 

215     /**
216      * @return true, if clazz is an implementation of interface inter
<span class="line-modified">217      * @throws ClassNotFoundException if inter or any superclasses or</span>
<span class="line-modified">218      * superinterfaces of clazz can&#39;t be found</span>
219      */
<span class="line-modified">220     public static boolean implementationOf(final JavaClass clazz, final String inter)</span>
221             throws ClassNotFoundException {
222         return implementationOf(clazz, lookupClass(inter));
223     }
224 

225     /**
226      * @return true, if clazz is an implementation of interface inter
227      * @throws ClassNotFoundException if clazz or any superclasses or
<span class="line-modified">228      * superinterfaces of clazz can&#39;t be found</span>
229      */
<span class="line-modified">230     public static boolean implementationOf(final String clazz, final JavaClass inter)</span>
231             throws ClassNotFoundException {
232         return implementationOf(lookupClass(clazz), inter);
233     }
234 }
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2017, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  3  */
  4 /*
  5  * Licensed to the Apache Software Foundation (ASF) under one or more
  6  * contributor license agreements.  See the NOTICE file distributed with
  7  * this work for additional information regarding copyright ownership.
  8  * The ASF licenses this file to You under the Apache License, Version 2.0
  9  * (the &quot;License&quot;); you may not use this file except in compliance with
 10  * the License.  You may obtain a copy of the License at
 11  *
 12  *      http://www.apache.org/licenses/LICENSE-2.0
 13  *
 14  * Unless required by applicable law or agreed to in writing, software
 15  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 16  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 17  * See the License for the specific language governing permissions and
 18  * limitations under the License.
 19  */
 20 package com.sun.org.apache.bcel.internal;
 21 
 22 
 23 import com.sun.org.apache.bcel.internal.classfile.JavaClass;
 24 import com.sun.org.apache.bcel.internal.util.SyntheticRepository;
 25 
 26 /**
 27  * The repository maintains informations about class interdependencies, e.g.,
<span class="line-modified"> 28  * whether a class is a sub-class of another. Delegates actual class loading</span>
<span class="line-modified"> 29  * to SyntheticRepository with current class path by default.</span>
 30  *
 31  * @see com.sun.org.apache.bcel.internal.util.Repository
 32  * @see SyntheticRepository
 33  *
<span class="line-modified"> 34  * @LastModified: Jan 2020</span>
 35  */
 36 public abstract class Repository {
 37 
 38     private static com.sun.org.apache.bcel.internal.util.Repository repository
 39             = SyntheticRepository.getInstance();
 40 
<span class="line-added"> 41 </span>
 42     /**
 43      * @return currently used repository instance
 44      */
 45     public static com.sun.org.apache.bcel.internal.util.Repository getRepository() {
 46         return repository;
 47     }
 48 
<span class="line-added"> 49 </span>
 50     /**
<span class="line-modified"> 51      * Sets repository instance to be used for class loading</span>
 52      */
<span class="line-modified"> 53     public static void setRepository( final com.sun.org.apache.bcel.internal.util.Repository rep ) {</span>
 54         repository = rep;
 55     }
 56 
<span class="line-added"> 57 </span>
 58     /**
<span class="line-modified"> 59      * Lookups class somewhere found on your CLASSPATH, or whereever the</span>
 60      * repository instance looks for it.
 61      *
 62      * @return class object for given fully qualified class name
<span class="line-modified"> 63      * @throws ClassNotFoundException if the class could not be found or</span>
<span class="line-modified"> 64      * parsed correctly</span>
 65      */
<span class="line-modified"> 66     public static JavaClass lookupClass( final String class_name ) throws ClassNotFoundException {</span>

 67         return repository.loadClass(class_name);
 68     }
 69 
<span class="line-added"> 70 </span>
 71     /**
<span class="line-modified"> 72      * Tries to find class source using the internal repository instance.</span>
 73      *
 74      * @see Class
 75      * @return JavaClass object for given runtime class
<span class="line-modified"> 76      * @throws ClassNotFoundException if the class could not be found or</span>
<span class="line-modified"> 77      * parsed correctly</span>
 78      */
<span class="line-modified"> 79     public static JavaClass lookupClass( final Class&lt;?&gt; clazz ) throws ClassNotFoundException {</span>

 80         return repository.loadClass(clazz);
 81     }
 82 
<span class="line-added"> 83 </span>
 84     /**
 85      * Clear the repository.
 86      */
 87     public static void clearCache() {
 88         repository.clear();
 89     }
 90 
<span class="line-added"> 91 </span>
 92     /**
<span class="line-modified"> 93      * Adds clazz to repository if there isn&#39;t an equally named class already in there.</span>

 94      *
 95      * @return old entry in repository
 96      */
<span class="line-modified"> 97     public static JavaClass addClass( final JavaClass clazz ) {</span>
 98         final JavaClass old = repository.findClass(clazz.getClassName());
 99         repository.storeClass(clazz);
100         return old;
101     }
102 
<span class="line-added">103 </span>
104     /**
<span class="line-modified">105      * Removes class with given (fully qualified) name from repository.</span>
106      */
<span class="line-modified">107     public static void removeClass( final String clazz ) {</span>
108         repository.removeClass(repository.findClass(clazz));
109     }
110 
<span class="line-added">111 </span>
112     /**
<span class="line-modified">113      * Removes given class from repository.</span>
114      */
<span class="line-modified">115     public static void removeClass( final JavaClass clazz ) {</span>
116         repository.removeClass(clazz);
117     }
118 
<span class="line-added">119 </span>
120     /**
<span class="line-modified">121      * @return list of super classes of clazz in ascending order, i.e.,</span>
<span class="line-modified">122      * Object is always the last element</span>
123      * @throws ClassNotFoundException if any of the superclasses can&#39;t be found
124      */
<span class="line-modified">125     public static JavaClass[] getSuperClasses( final JavaClass clazz ) throws ClassNotFoundException {</span>
126         return clazz.getSuperClasses();
127     }
128 
<span class="line-added">129 </span>
130     /**
<span class="line-modified">131      * @return list of super classes of clazz in ascending order, i.e.,</span>
<span class="line-modified">132      * Object is always the last element.</span>
133      * @throws ClassNotFoundException if the named class or any of its
<span class="line-modified">134      *  superclasses can&#39;t be found</span>
135      */
<span class="line-modified">136     public static JavaClass[] getSuperClasses( final String class_name ) throws ClassNotFoundException {</span>
137         final JavaClass jc = lookupClass(class_name);
138         return getSuperClasses(jc);
139     }
140 
<span class="line-added">141 </span>
142     /**
<span class="line-modified">143      * @return all interfaces implemented by class and its super</span>
<span class="line-modified">144      * classes and the interfaces that those interfaces extend, and so on.</span>
<span class="line-modified">145      * (Some people call this a transitive hull).</span>
<span class="line-modified">146      * @throws ClassNotFoundException if any of the class&#39;s</span>
<span class="line-modified">147      *  superclasses or superinterfaces can&#39;t be found</span>
148      */
<span class="line-modified">149     public static JavaClass[] getInterfaces( final JavaClass clazz ) throws ClassNotFoundException {</span>
150         return clazz.getAllInterfaces();
151     }
152 
<span class="line-added">153 </span>
154     /**
<span class="line-modified">155      * @return all interfaces implemented by class and its super</span>
<span class="line-modified">156      * classes and the interfaces that extend those interfaces, and so on</span>
<span class="line-modified">157      * @throws ClassNotFoundException if the named class can&#39;t be found,</span>
<span class="line-modified">158      *   or if any of its superclasses or superinterfaces can&#39;t be found</span>
159      */
<span class="line-modified">160     public static JavaClass[] getInterfaces( final String class_name ) throws ClassNotFoundException {</span>
161         return getInterfaces(lookupClass(class_name));
162     }
163 
<span class="line-added">164 </span>
165     /**
166      * Equivalent to runtime &quot;instanceof&quot; operator.

167      * @return true, if clazz is an instance of super_class
<span class="line-modified">168      * @throws ClassNotFoundException if any superclasses or superinterfaces</span>
<span class="line-modified">169      *   of clazz can&#39;t be found</span>
170      */
<span class="line-modified">171     public static boolean instanceOf( final JavaClass clazz, final JavaClass super_class )</span>
172             throws ClassNotFoundException {
173         return clazz.instanceOf(super_class);
174     }
175 
<span class="line-added">176 </span>
177     /**
178      * @return true, if clazz is an instance of super_class
<span class="line-modified">179      * @throws ClassNotFoundException if either clazz or super_class</span>
<span class="line-modified">180      *   can&#39;t be found</span>
181      */
<span class="line-modified">182     public static boolean instanceOf( final String clazz, final String super_class )</span>
183             throws ClassNotFoundException {
184         return instanceOf(lookupClass(clazz), lookupClass(super_class));
185     }
186 
<span class="line-added">187 </span>
188     /**
189      * @return true, if clazz is an instance of super_class
190      * @throws ClassNotFoundException if super_class can&#39;t be found
191      */
<span class="line-modified">192     public static boolean instanceOf( final JavaClass clazz, final String super_class )</span>
193             throws ClassNotFoundException {
194         return instanceOf(clazz, lookupClass(super_class));
195     }
196 
<span class="line-added">197 </span>
198     /**
199      * @return true, if clazz is an instance of super_class
200      * @throws ClassNotFoundException if clazz can&#39;t be found
201      */
<span class="line-modified">202     public static boolean instanceOf( final String clazz, final JavaClass super_class )</span>
203             throws ClassNotFoundException {
204         return instanceOf(lookupClass(clazz), super_class);
205     }
206 
<span class="line-added">207 </span>
208     /**
209      * @return true, if clazz is an implementation of interface inter
<span class="line-modified">210      * @throws ClassNotFoundException if any superclasses or superinterfaces</span>
<span class="line-modified">211      *   of clazz can&#39;t be found</span>
212      */
<span class="line-modified">213     public static boolean implementationOf( final JavaClass clazz, final JavaClass inter )</span>
214             throws ClassNotFoundException {
215         return clazz.implementationOf(inter);
216     }
217 
<span class="line-added">218 </span>
219     /**
220      * @return true, if clazz is an implementation of interface inter
<span class="line-modified">221      * @throws ClassNotFoundException if clazz, inter, or any superclasses</span>
<span class="line-modified">222      *   or superinterfaces of clazz can&#39;t be found</span>
223      */
<span class="line-modified">224     public static boolean implementationOf( final String clazz, final String inter )</span>
225             throws ClassNotFoundException {
226         return implementationOf(lookupClass(clazz), lookupClass(inter));
227     }
228 
<span class="line-added">229 </span>
230     /**
231      * @return true, if clazz is an implementation of interface inter
<span class="line-modified">232      * @throws ClassNotFoundException if inter or any superclasses</span>
<span class="line-modified">233      *   or superinterfaces of clazz can&#39;t be found</span>
234      */
<span class="line-modified">235     public static boolean implementationOf( final JavaClass clazz, final String inter )</span>
236             throws ClassNotFoundException {
237         return implementationOf(clazz, lookupClass(inter));
238     }
239 
<span class="line-added">240 </span>
241     /**
242      * @return true, if clazz is an implementation of interface inter
243      * @throws ClassNotFoundException if clazz or any superclasses or
<span class="line-modified">244      *   superinterfaces of clazz can&#39;t be found</span>
245      */
<span class="line-modified">246     public static boolean implementationOf( final String clazz, final JavaClass inter )</span>
247             throws ClassNotFoundException {
248         return implementationOf(lookupClass(clazz), inter);
249     }
250 }
</pre>
</td>
</tr>
</table>
<center><a href="ExceptionConst.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="classfile/AccessFlags.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>