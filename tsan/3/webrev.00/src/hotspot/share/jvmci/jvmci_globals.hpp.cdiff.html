<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/jvmci/jvmci_globals.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="jvmci_globals.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="vmStructs_jvmci.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/jvmci/jvmci_globals.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 23,11 ***</span>
   */
  
  #ifndef SHARE_JVMCI_JVMCI_GLOBALS_HPP
  #define SHARE_JVMCI_JVMCI_GLOBALS_HPP
  
<span class="line-modified">! #include &quot;runtime/globals.hpp&quot;</span>
  
  //
  // Defines all global flags used by the JVMCI compiler. Only flags that need
  // to be accessible to the JVMCI C++ code should be defined here.
  //
<span class="line-new-header">--- 23,13 ---</span>
   */
  
  #ifndef SHARE_JVMCI_JVMCI_GLOBALS_HPP
  #define SHARE_JVMCI_JVMCI_GLOBALS_HPP
  
<span class="line-modified">! #include &quot;runtime/flags/jvmFlag.hpp&quot;</span>
<span class="line-added">+ </span>
<span class="line-added">+ class fileStream;</span>
  
  //
  // Defines all global flags used by the JVMCI compiler. Only flags that need
  // to be accessible to the JVMCI C++ code should be defined here.
  //
</pre>
<hr />
<pre>
<span class="line-old-header">*** 38,37 ***</span>
                      diagnostic, \
                      diagnostic_pd, \
                      experimental, \
                      notproduct, \
                      range, \
<span class="line-modified">!                     constraint, \</span>
<span class="line-removed">-                     writeable) \</span>
                                                                              \
    experimental(bool, EnableJVMCI, false,                                    \
            &quot;Enable JVMCI&quot;)                                                   \
                                                                              \
    experimental(bool, UseJVMCICompiler, false,                               \
<span class="line-modified">!           &quot;Use JVMCI as the default compiler&quot;)                              \</span>
                                                                              \
    experimental(bool, JVMCIPrintProperties, false,                           \
            &quot;Prints properties used by the JVMCI compiler and exits&quot;)         \
                                                                              \
    experimental(bool, BootstrapJVMCI, false,                                 \
<span class="line-modified">!           &quot;Bootstrap JVMCI before running Java main method&quot;)                \</span>
                                                                              \
    experimental(bool, EagerJVMCI, false,                                     \
            &quot;Force eager JVMCI initialization&quot;)                               \
                                                                              \
    experimental(bool, PrintBootstrap, true,                                  \
            &quot;Print JVMCI bootstrap progress and summary&quot;)                     \
                                                                              \
    experimental(intx, JVMCIThreads, 1,                                       \
<span class="line-modified">!           &quot;Force number of JVMCI compiler threads to use&quot;)                  \</span>
            range(1, max_jint)                                                \
                                                                              \
    experimental(intx, JVMCIHostThreads, 1,                                   \
<span class="line-modified">!           &quot;Force number of compiler threads for JVMCI host compiler&quot;)       \</span>
            range(1, max_jint)                                                \
                                                                              \
    NOT_COMPILER2(product(intx, MaxVectorSize, 64,                            \
            &quot;Max vector size in bytes, &quot;                                      \
            &quot;actual size could be less depending on elements type&quot;))          \
<span class="line-new-header">--- 40,48 ---</span>
                      diagnostic, \
                      diagnostic_pd, \
                      experimental, \
                      notproduct, \
                      range, \
<span class="line-modified">!                     constraint) \</span>
                                                                              \
    experimental(bool, EnableJVMCI, false,                                    \
            &quot;Enable JVMCI&quot;)                                                   \
                                                                              \
<span class="line-added">+   experimental(bool, EnableJVMCIProduct, false,                             \</span>
<span class="line-added">+           &quot;Allow JVMCI to be used in product mode. This alters a subset of &quot;\</span>
<span class="line-added">+           &quot;JVMCI flags to be non-experimental, defaults UseJVMCICompiler &quot;  \</span>
<span class="line-added">+           &quot;and EnableJVMCI to true and defaults UseJVMCINativeLibrary &quot;     \</span>
<span class="line-added">+           &quot;to true if a JVMCI native library is available.&quot;)                \</span>
<span class="line-added">+                                                                             \</span>
    experimental(bool, UseJVMCICompiler, false,                               \
<span class="line-modified">!           &quot;Use JVMCI as the default compiler. Defaults to true if &quot;         \</span>
<span class="line-added">+           &quot;EnableJVMCIProduct is true.&quot;)                                    \</span>
                                                                              \
    experimental(bool, JVMCIPrintProperties, false,                           \
            &quot;Prints properties used by the JVMCI compiler and exits&quot;)         \
                                                                              \
    experimental(bool, BootstrapJVMCI, false,                                 \
<span class="line-modified">!           &quot;Bootstrap JVMCI before running Java main method. This &quot;          \</span>
<span class="line-added">+           &quot;initializes the compile queue with a small set of methods &quot;      \</span>
<span class="line-added">+           &quot;and processes the queue until it is empty. Combining this with &quot; \</span>
<span class="line-added">+           &quot;-XX:-TieredCompilation makes JVMCI compile more of itself.&quot;)     \</span>
                                                                              \
    experimental(bool, EagerJVMCI, false,                                     \
            &quot;Force eager JVMCI initialization&quot;)                               \
                                                                              \
    experimental(bool, PrintBootstrap, true,                                  \
            &quot;Print JVMCI bootstrap progress and summary&quot;)                     \
                                                                              \
    experimental(intx, JVMCIThreads, 1,                                       \
<span class="line-modified">!           &quot;Force number of JVMCI compiler threads to use. Ignored if &quot;      \</span>
<span class="line-added">+           &quot;UseJVMCICompiler is false.&quot;)                                     \</span>
            range(1, max_jint)                                                \
                                                                              \
    experimental(intx, JVMCIHostThreads, 1,                                   \
<span class="line-modified">!           &quot;Force number of C1 compiler threads. Ignored if &quot;                \</span>
<span class="line-added">+           &quot;UseJVMCICompiler is false.&quot;)                                     \</span>
            range(1, max_jint)                                                \
                                                                              \
    NOT_COMPILER2(product(intx, MaxVectorSize, 64,                            \
            &quot;Max vector size in bytes, &quot;                                      \
            &quot;actual size could be less depending on elements type&quot;))          \
</pre>
<hr />
<pre>
<span class="line-old-header">*** 95,12 ***</span>
            &quot;Maximum size of a compiled method.&quot;)                             \
                                                                              \
    experimental(intx, MethodProfileWidth, 0,                                 \
            &quot;Number of methods to record in call profile&quot;)                    \
                                                                              \
<span class="line-modified">!   develop(bool, TraceUncollectedSpeculations, false,                        \</span>
<span class="line-modified">!           &quot;Print message when a failed speculation was not collected&quot;)      \</span>
                                                                              \
    NOT_COMPILER2(diagnostic(bool, UseMultiplyToLenIntrinsic, false,          \
            &quot;Enables intrinsification of BigInteger.multiplyToLen()&quot;))        \
                                                                              \
    NOT_COMPILER2(diagnostic(bool, UseSquareToLenIntrinsic, false,            \
<span class="line-new-header">--- 108,22 ---</span>
            &quot;Maximum size of a compiled method.&quot;)                             \
                                                                              \
    experimental(intx, MethodProfileWidth, 0,                                 \
            &quot;Number of methods to record in call profile&quot;)                    \
                                                                              \
<span class="line-modified">!   experimental(ccstr, JVMCILibPath, NULL,                                   \</span>
<span class="line-modified">!           &quot;LD path for loading the JVMCI shared library&quot;)                   \</span>
<span class="line-added">+                                                                             \</span>
<span class="line-added">+   experimental(ccstr, JVMCILibDumpJNIConfig, NULL,                          \</span>
<span class="line-added">+           &quot;Dumps to the given file a description of the classes, fields &quot;   \</span>
<span class="line-added">+           &quot;and methods the JVMCI shared library must provide&quot;)              \</span>
<span class="line-added">+                                                                             \</span>
<span class="line-added">+   experimental(bool, UseJVMCINativeLibrary, false,                          \</span>
<span class="line-added">+           &quot;Execute JVMCI Java code from a shared library &quot;                  \</span>
<span class="line-added">+           &quot;instead of loading it from class files and executing it &quot;        \</span>
<span class="line-added">+           &quot;on the HotSpot heap. Defaults to true if EnableJVMCIProduct is &quot; \</span>
<span class="line-added">+           &quot;true and a JVMCI native library is available.&quot;)                  \</span>
                                                                              \
    NOT_COMPILER2(diagnostic(bool, UseMultiplyToLenIntrinsic, false,          \
            &quot;Enables intrinsification of BigInteger.multiplyToLen()&quot;))        \
                                                                              \
    NOT_COMPILER2(diagnostic(bool, UseSquareToLenIntrinsic, false,            \
</pre>
<hr />
<pre>
<span class="line-old-header">*** 113,31 ***</span>
            &quot;Enables intrinsification of BigInteger.montgomeryMultiply()&quot;))   \
                                                                              \
    NOT_COMPILER2(diagnostic(bool, UseMontgomerySquareIntrinsic, false,       \
            &quot;Enables intrinsification of BigInteger.montgomerySquare()&quot;))
  
<span class="line-modified">! </span>
<span class="line-modified">! // Read default values for JVMCI globals</span>
<span class="line-removed">- </span>
<span class="line-removed">- JVMCI_FLAGS(DECLARE_DEVELOPER_FLAG, \</span>
<span class="line-removed">-             DECLARE_PD_DEVELOPER_FLAG, \</span>
<span class="line-removed">-             DECLARE_PRODUCT_FLAG, \</span>
<span class="line-removed">-             DECLARE_PD_PRODUCT_FLAG, \</span>
<span class="line-removed">-             DECLARE_DIAGNOSTIC_FLAG, \</span>
<span class="line-removed">-             DECLARE_PD_DIAGNOSTIC_FLAG, \</span>
<span class="line-removed">-             DECLARE_EXPERIMENTAL_FLAG, \</span>
<span class="line-removed">-             DECLARE_NOTPRODUCT_FLAG, \</span>
<span class="line-removed">-             IGNORE_RANGE, \</span>
<span class="line-removed">-             IGNORE_CONSTRAINT, \</span>
<span class="line-removed">-             IGNORE_WRITEABLE)</span>
  
  class JVMCIGlobals {
   public:
<span class="line-modified">!   // Return true if jvmci flags are consistent. If not consistent,</span>
    // an error message describing the inconsistency is printed before
    // returning false.
    static bool check_jvmci_flags_are_consistent();
  
    // Check and exit VM with error if selected GC is not supported by JVMCI.
    static void check_jvmci_supported_gc();
  };
  #endif // SHARE_JVMCI_JVMCI_GLOBALS_HPP
<span class="line-new-header">--- 136,27 ---</span>
            &quot;Enables intrinsification of BigInteger.montgomeryMultiply()&quot;))   \
                                                                              \
    NOT_COMPILER2(diagnostic(bool, UseMontgomerySquareIntrinsic, false,       \
            &quot;Enables intrinsification of BigInteger.montgomerySquare()&quot;))
  
<span class="line-modified">! // The base name for the shared library containing the JVMCI based compiler</span>
<span class="line-modified">! #define JVMCI_SHARED_LIBRARY_NAME &quot;jvmcicompiler&quot;</span>
  
  class JVMCIGlobals {
<span class="line-added">+  private:</span>
<span class="line-added">+   static fileStream* _jni_config_file;</span>
   public:
<span class="line-modified">! </span>
<span class="line-added">+   // Returns true if jvmci flags are consistent. If not consistent,</span>
    // an error message describing the inconsistency is printed before
    // returning false.
    static bool check_jvmci_flags_are_consistent();
  
<span class="line-added">+   // Convert JVMCI experimental flags to product</span>
<span class="line-added">+   static bool enable_jvmci_product_mode(JVMFlag::Flags);</span>
<span class="line-added">+ </span>
    // Check and exit VM with error if selected GC is not supported by JVMCI.
    static void check_jvmci_supported_gc();
<span class="line-added">+ </span>
<span class="line-added">+   static fileStream* get_jni_config_file() { return _jni_config_file; }</span>
  };
  #endif // SHARE_JVMCI_JVMCI_GLOBALS_HPP
</pre>
<center><a href="jvmci_globals.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="vmStructs_jvmci.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>