<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/hotspot/share/jvmci/jvmciJavaClasses.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
    <script type="text/javascript" src="../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (c) 2011, 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 #ifndef SHARE_JVMCI_JVMCIJAVACLASSES_HPP
 25 #define SHARE_JVMCI_JVMCIJAVACLASSES_HPP
 26 
<a name="1" id="anc1"></a><span class="line-modified"> 27 #include &quot;classfile/systemDictionary.hpp&quot;</span>
<span class="line-modified"> 28 #include &quot;oops/access.hpp&quot;</span>
<span class="line-modified"> 29 #include &quot;oops/instanceMirrorKlass.hpp&quot;</span>
<span class="line-modified"> 30 #include &quot;oops/oop.hpp&quot;</span>































































































































































































































































































































































































































































































 31 
<a name="2" id="anc2"></a><span class="line-removed"> 32 class JVMCIJavaClasses : AllStatic {</span>
 33  public:
<a name="3" id="anc3"></a>



















 34   static void compute_offsets(TRAPS);
<a name="4" id="anc4"></a>


 35 };
 36 
<a name="5" id="anc5"></a><span class="line-modified"> 37 /* This macro defines the structure of the JVMCI classes accessed from VM code.</span>
<span class="line-modified"> 38  * It will generate classes with accessors similar to javaClasses.hpp, but with specializations for oops, Handles and jni handles.</span>



















































 39  *
<a name="6" id="anc6"></a><span class="line-modified"> 40  * The public interface of these classes will look like this:</span>
<span class="line-modified"> 41 </span>
<span class="line-modified"> 42  * class StackSlot : AllStatic {</span>
<span class="line-modified"> 43  * public:</span>
<span class="line-modified"> 44  *   static Klass* klass();</span>
<span class="line-modified"> 45  *   static jint  index(oop obj);</span>
<span class="line-modified"> 46  *   static jint  index(Handle obj);</span>
<span class="line-modified"> 47  *   static jint  index(jobject obj);</span>
<span class="line-modified"> 48  *   static void set_index(oop obj, jint x);</span>
<span class="line-modified"> 49  *   static void set_index(Handle obj, jint x);</span>
<span class="line-modified"> 50  *   static void set_index(jobject obj, jint x);</span>







 51  * };
<a name="7" id="anc7"></a><span class="line-removed"> 52  *</span>
 53  */
<a name="8" id="anc8"></a>

 54 
<a name="9" id="anc9"></a><span class="line-modified"> 55 #define COMPILER_CLASSES_DO(start_class, end_class, char_field, int_field, boolean_field, long_field, float_field, oop_field, typeArrayOop_field, objArrayOop_field, static_oop_field, static_objArrayOop_field, static_int_field, static_boolean_field) \</span>
<span class="line-modified"> 56   start_class(Architecture)                                                                                                                                    \</span>
<span class="line-modified"> 57     oop_field(Architecture, wordKind, &quot;Ljdk/vm/ci/meta/PlatformKind;&quot;)                                                                                         \</span>
<span class="line-modified"> 58   end_class                                                                                                                                                    \</span>
<span class="line-modified"> 59   start_class(TargetDescription)                                                                                                                               \</span>
<span class="line-removed"> 60     oop_field(TargetDescription, arch, &quot;Ljdk/vm/ci/code/Architecture;&quot;)                                                                                        \</span>
<span class="line-removed"> 61   end_class                                                                                                                                                    \</span>
<span class="line-removed"> 62   start_class(HotSpotResolvedObjectTypeImpl)                                                                                                                   \</span>
<span class="line-removed"> 63     oop_field(HotSpotResolvedObjectTypeImpl, javaClass, &quot;Ljava/lang/Class;&quot;)                                                                                   \</span>
<span class="line-removed"> 64   end_class                                                                                                                                                    \</span>
<span class="line-removed"> 65   start_class(HotSpotResolvedJavaMethodImpl)                                                                                                                   \</span>
<span class="line-removed"> 66     long_field(HotSpotResolvedJavaMethodImpl, metaspaceMethod)                                                                                                 \</span>
<span class="line-removed"> 67   end_class                                                                                                                                                    \</span>
<span class="line-removed"> 68   start_class(InstalledCode)                                                                                                                                   \</span>
<span class="line-removed"> 69     long_field(InstalledCode, address)                                                                                                                         \</span>
<span class="line-removed"> 70     long_field(InstalledCode, entryPoint)                                                                                                                      \</span>
<span class="line-removed"> 71     long_field(InstalledCode, version)                                                                                                                         \</span>
<span class="line-removed"> 72     oop_field(InstalledCode, name, &quot;Ljava/lang/String;&quot;)                                                                                                       \</span>
<span class="line-removed"> 73   end_class                                                                                                                                                    \</span>
<span class="line-removed"> 74   start_class(HotSpotInstalledCode)                                                                                                                            \</span>
<span class="line-removed"> 75     int_field(HotSpotInstalledCode, size)                                                                                                                      \</span>
<span class="line-removed"> 76     long_field(HotSpotInstalledCode, codeStart)                                                                                                                \</span>
<span class="line-removed"> 77     int_field(HotSpotInstalledCode, codeSize)                                                                                                                  \</span>
<span class="line-removed"> 78   end_class                                                                                                                                                    \</span>
<span class="line-removed"> 79   start_class(HotSpotNmethod)                                                                                                                                  \</span>
<span class="line-removed"> 80     boolean_field(HotSpotNmethod, isDefault)                                                                                                                   \</span>
<span class="line-removed"> 81   end_class                                                                                                                                                    \</span>
<span class="line-removed"> 82   start_class(HotSpotCompiledCode)                                                                                                                             \</span>
<span class="line-removed"> 83     oop_field(HotSpotCompiledCode, name, &quot;Ljava/lang/String;&quot;)                                                                                                 \</span>
<span class="line-removed"> 84     typeArrayOop_field(HotSpotCompiledCode, targetCode, &quot;[B&quot;)                                                                                                  \</span>
<span class="line-removed"> 85     int_field(HotSpotCompiledCode, targetCodeSize)                                                                                                             \</span>
<span class="line-removed"> 86     objArrayOop_field(HotSpotCompiledCode, sites, &quot;[Ljdk/vm/ci/code/site/Site;&quot;)                                                                               \</span>
<span class="line-removed"> 87     objArrayOop_field(HotSpotCompiledCode, assumptions, &quot;[Ljdk/vm/ci/meta/Assumptions$Assumption;&quot;)                                                            \</span>
<span class="line-removed"> 88     objArrayOop_field(HotSpotCompiledCode, methods, &quot;[Ljdk/vm/ci/meta/ResolvedJavaMethod;&quot;)                                                                    \</span>
<span class="line-removed"> 89     objArrayOop_field(HotSpotCompiledCode, comments, &quot;[Ljdk/vm/ci/hotspot/HotSpotCompiledCode$Comment;&quot;)                                                       \</span>
<span class="line-removed"> 90     typeArrayOop_field(HotSpotCompiledCode, dataSection, &quot;[B&quot;)                                                                                                 \</span>
<span class="line-removed"> 91     int_field(HotSpotCompiledCode, dataSectionAlignment)                                                                                                       \</span>
<span class="line-removed"> 92     objArrayOop_field(HotSpotCompiledCode, dataSectionPatches, &quot;[Ljdk/vm/ci/code/site/DataPatch;&quot;)                                                             \</span>
<span class="line-removed"> 93     boolean_field(HotSpotCompiledCode, isImmutablePIC)                                                                                                         \</span>
<span class="line-removed"> 94     int_field(HotSpotCompiledCode, totalFrameSize)                                                                                                             \</span>
<span class="line-removed"> 95     oop_field(HotSpotCompiledCode, deoptRescueSlot, &quot;Ljdk/vm/ci/code/StackSlot;&quot;)                                                                              \</span>
<span class="line-removed"> 96   end_class                                                                                                                                                    \</span>
<span class="line-removed"> 97   start_class(HotSpotCompiledCode_Comment)                                                                                                                     \</span>
<span class="line-removed"> 98     oop_field(HotSpotCompiledCode_Comment, text, &quot;Ljava/lang/String;&quot;)                                                                                         \</span>
<span class="line-removed"> 99     int_field(HotSpotCompiledCode_Comment, pcOffset)                                                                                                           \</span>
<span class="line-removed">100   end_class                                                                                                                                                    \</span>
<span class="line-removed">101   start_class(HotSpotCompiledNmethod)                                                                                                                          \</span>
<span class="line-removed">102     oop_field(HotSpotCompiledNmethod, method, &quot;Ljdk/vm/ci/hotspot/HotSpotResolvedJavaMethod;&quot;)                                                                 \</span>
<span class="line-removed">103     oop_field(HotSpotCompiledNmethod, installationFailureMessage, &quot;Ljava/lang/String;&quot;)                                                                        \</span>
<span class="line-removed">104     int_field(HotSpotCompiledNmethod, entryBCI)                                                                                                                \</span>
<span class="line-removed">105     int_field(HotSpotCompiledNmethod, id)                                                                                                                      \</span>
<span class="line-removed">106     long_field(HotSpotCompiledNmethod, jvmciEnv)                                                                                                               \</span>
<span class="line-removed">107     boolean_field(HotSpotCompiledNmethod, hasUnsafeAccess)                                                                                                     \</span>
<span class="line-removed">108   end_class                                                                                                                                                    \</span>
<span class="line-removed">109   start_class(HotSpotJVMCIMetaAccessContext)                                                                                                                   \</span>
<span class="line-removed">110     static_objArrayOop_field(HotSpotJVMCIMetaAccessContext, allContexts, &quot;[Ljava/lang/ref/WeakReference;&quot;)                                                     \</span>
<span class="line-removed">111     objArrayOop_field(HotSpotJVMCIMetaAccessContext, metadataRoots, &quot;[Ljava/lang/Object;&quot;)                                                                     \</span>
<span class="line-removed">112   end_class                                                                                                                                                    \</span>
<span class="line-removed">113   start_class(HotSpotForeignCallTarget)                                                                                                                        \</span>
<span class="line-removed">114     long_field(HotSpotForeignCallTarget, address)                                                                                                              \</span>
<span class="line-removed">115   end_class                                                                                                                                                    \</span>
<span class="line-removed">116   start_class(VMField)                                                                                                                                         \</span>
<span class="line-removed">117     oop_field(VMField, name, &quot;Ljava/lang/String;&quot;)                                                                                                             \</span>
<span class="line-removed">118     oop_field(VMField, type, &quot;Ljava/lang/String;&quot;)                                                                                                             \</span>
<span class="line-removed">119     long_field(VMField, offset)                                                                                                                                \</span>
<span class="line-removed">120     long_field(VMField, address)                                                                                                                               \</span>
<span class="line-removed">121     oop_field(VMField, value, &quot;Ljava/lang/Object;&quot;)                                                                                                            \</span>
<span class="line-removed">122   end_class                                                                                                                                                    \</span>
<span class="line-removed">123   start_class(VMFlag)                                                                                                                                          \</span>
<span class="line-removed">124     oop_field(VMFlag, name, &quot;Ljava/lang/String;&quot;)                                                                                                              \</span>
<span class="line-removed">125     oop_field(VMFlag, type, &quot;Ljava/lang/String;&quot;)                                                                                                              \</span>
<span class="line-removed">126     oop_field(VMFlag, value, &quot;Ljava/lang/Object;&quot;)                                                                                                             \</span>
<span class="line-removed">127   end_class                                                                                                                                                    \</span>
<span class="line-removed">128   start_class(VMIntrinsicMethod)                                                                                                                               \</span>
<span class="line-removed">129     oop_field(VMIntrinsicMethod, declaringClass, &quot;Ljava/lang/String;&quot;)                                                                                         \</span>
<span class="line-removed">130     oop_field(VMIntrinsicMethod, name, &quot;Ljava/lang/String;&quot;)                                                                                                   \</span>
<span class="line-removed">131     oop_field(VMIntrinsicMethod, descriptor, &quot;Ljava/lang/String;&quot;)                                                                                             \</span>
<span class="line-removed">132     int_field(VMIntrinsicMethod, id)                                                                                                                           \</span>
<span class="line-removed">133   end_class                                                                                                                                                    \</span>
<span class="line-removed">134   start_class(Assumptions_NoFinalizableSubclass)                                                                                                               \</span>
<span class="line-removed">135     oop_field(Assumptions_NoFinalizableSubclass, receiverType, &quot;Ljdk/vm/ci/meta/ResolvedJavaType;&quot;)                                                            \</span>
<span class="line-removed">136   end_class                                                                                                                                                    \</span>
<span class="line-removed">137   start_class(Assumptions_ConcreteSubtype)                                                                                                                     \</span>
<span class="line-removed">138     oop_field(Assumptions_ConcreteSubtype, context, &quot;Ljdk/vm/ci/meta/ResolvedJavaType;&quot;)                                                                       \</span>
<span class="line-removed">139     oop_field(Assumptions_ConcreteSubtype, subtype, &quot;Ljdk/vm/ci/meta/ResolvedJavaType;&quot;)                                                                       \</span>
<span class="line-removed">140   end_class                                                                                                                                                    \</span>
<span class="line-removed">141   start_class(Assumptions_LeafType)                                                                                                                            \</span>
<span class="line-removed">142     oop_field(Assumptions_LeafType, context, &quot;Ljdk/vm/ci/meta/ResolvedJavaType;&quot;)                                                                              \</span>
<span class="line-removed">143   end_class                                                                                                                                                    \</span>
<span class="line-removed">144   start_class(Assumptions_ConcreteMethod)                                                                                                                      \</span>
<span class="line-removed">145     oop_field(Assumptions_ConcreteMethod, method, &quot;Ljdk/vm/ci/meta/ResolvedJavaMethod;&quot;)                                                                       \</span>
<span class="line-removed">146     oop_field(Assumptions_ConcreteMethod, context, &quot;Ljdk/vm/ci/meta/ResolvedJavaType;&quot;)                                                                        \</span>
<span class="line-removed">147     oop_field(Assumptions_ConcreteMethod, impl, &quot;Ljdk/vm/ci/meta/ResolvedJavaMethod;&quot;)                                                                         \</span>
<span class="line-removed">148   end_class                                                                                                                                                    \</span>
<span class="line-removed">149   start_class(Assumptions_CallSiteTargetValue)                                                                                                                 \</span>
<span class="line-removed">150     oop_field(Assumptions_CallSiteTargetValue, callSite, &quot;Ljdk/vm/ci/meta/JavaConstant;&quot;)                                                                      \</span>
<span class="line-removed">151     oop_field(Assumptions_CallSiteTargetValue, methodHandle, &quot;Ljdk/vm/ci/meta/JavaConstant;&quot;)                                                                  \</span>
<span class="line-removed">152   end_class                                                                                                                                                    \</span>
<span class="line-removed">153   start_class(site_Site)                                                                                                                                       \</span>
<span class="line-removed">154     int_field(site_Site, pcOffset)                                                                                                                             \</span>
<span class="line-removed">155   end_class                                                                                                                                                    \</span>
<span class="line-removed">156   start_class(site_Call)                                                                                                                                       \</span>
<span class="line-removed">157     oop_field(site_Call, target, &quot;Ljdk/vm/ci/meta/InvokeTarget;&quot;)                                                                                              \</span>
<span class="line-removed">158     oop_field(site_Call, debugInfo, &quot;Ljdk/vm/ci/code/DebugInfo;&quot;)                                                                                              \</span>
<span class="line-removed">159   end_class                                                                                                                                                    \</span>
<span class="line-removed">160   start_class(site_DataPatch)                                                                                                                                  \</span>
<span class="line-removed">161     oop_field(site_DataPatch, reference, &quot;Ljdk/vm/ci/code/site/Reference;&quot;)                                                                                    \</span>
<span class="line-removed">162   end_class                                                                                                                                                    \</span>
<span class="line-removed">163   start_class(site_ConstantReference)                                                                                                                          \</span>
<span class="line-removed">164     oop_field(site_ConstantReference, constant, &quot;Ljdk/vm/ci/meta/VMConstant;&quot;)                                                                                 \</span>
<span class="line-removed">165   end_class                                                                                                                                                    \</span>
<span class="line-removed">166   start_class(site_DataSectionReference)                                                                                                                       \</span>
<span class="line-removed">167     int_field(site_DataSectionReference, offset)                                                                                                               \</span>
<span class="line-removed">168   end_class                                                                                                                                                    \</span>
<span class="line-removed">169   start_class(site_InfopointReason)                                                                                                                            \</span>
<span class="line-removed">170     static_oop_field(site_InfopointReason, SAFEPOINT, &quot;Ljdk/vm/ci/code/site/InfopointReason;&quot;)                                                                 \</span>
<span class="line-removed">171     static_oop_field(site_InfopointReason, CALL, &quot;Ljdk/vm/ci/code/site/InfopointReason;&quot;)                                                                      \</span>
<span class="line-removed">172     static_oop_field(site_InfopointReason, IMPLICIT_EXCEPTION, &quot;Ljdk/vm/ci/code/site/InfopointReason;&quot;)                                                        \</span>
<span class="line-removed">173   end_class                                                                                                                                                    \</span>
<span class="line-removed">174   start_class(site_Infopoint)                                                                                                                                  \</span>
<span class="line-removed">175     oop_field(site_Infopoint, debugInfo, &quot;Ljdk/vm/ci/code/DebugInfo;&quot;)                                                                                         \</span>
<span class="line-removed">176     oop_field(site_Infopoint, reason, &quot;Ljdk/vm/ci/code/site/InfopointReason;&quot;)                                                                                 \</span>
<span class="line-removed">177   end_class                                                                                                                                                    \</span>
<span class="line-removed">178   start_class(site_ExceptionHandler)                                                                                                                           \</span>
<span class="line-removed">179     int_field(site_ExceptionHandler, handlerPos)                                                                                                               \</span>
<span class="line-removed">180   end_class                                                                                                                                                    \</span>
<span class="line-removed">181   start_class(site_Mark)                                                                                                                                       \</span>
<span class="line-removed">182     oop_field(site_Mark, id, &quot;Ljava/lang/Object;&quot;)                                                                                                             \</span>
<span class="line-removed">183   end_class                                                                                                                                                    \</span>
<span class="line-removed">184   start_class(HotSpotCompilationRequestResult)                                                                                                                 \</span>
<span class="line-removed">185     oop_field(HotSpotCompilationRequestResult, failureMessage, &quot;Ljava/lang/String;&quot;)                                                                           \</span>
<span class="line-removed">186     boolean_field(HotSpotCompilationRequestResult, retry)                                                                                                      \</span>
<span class="line-removed">187     int_field(HotSpotCompilationRequestResult, inlinedBytecodes)                                                                                               \</span>
<span class="line-removed">188   end_class                                                                                                                                                    \</span>
<span class="line-removed">189   start_class(DebugInfo)                                                                                                                                       \</span>
<span class="line-removed">190     oop_field(DebugInfo, bytecodePosition, &quot;Ljdk/vm/ci/code/BytecodePosition;&quot;)                                                                                \</span>
<span class="line-removed">191     oop_field(DebugInfo, referenceMap, &quot;Ljdk/vm/ci/code/ReferenceMap;&quot;)                                                                                        \</span>
<span class="line-removed">192     oop_field(DebugInfo, calleeSaveInfo, &quot;Ljdk/vm/ci/code/RegisterSaveLayout;&quot;)                                                                                \</span>
<span class="line-removed">193     objArrayOop_field(DebugInfo, virtualObjectMapping, &quot;[Ljdk/vm/ci/code/VirtualObject;&quot;)                                                                      \</span>
<span class="line-removed">194   end_class                                                                                                                                                    \</span>
<span class="line-removed">195   start_class(HotSpotReferenceMap)                                                                                                                             \</span>
<span class="line-removed">196     objArrayOop_field(HotSpotReferenceMap, objects, &quot;[Ljdk/vm/ci/code/Location;&quot;)                                                                              \</span>
<span class="line-removed">197     objArrayOop_field(HotSpotReferenceMap, derivedBase, &quot;[Ljdk/vm/ci/code/Location;&quot;)                                                                          \</span>
<span class="line-removed">198     typeArrayOop_field(HotSpotReferenceMap, sizeInBytes, &quot;[I&quot;)                                                                                                 \</span>
<span class="line-removed">199     int_field(HotSpotReferenceMap, maxRegisterSize)                                                                                                            \</span>
<span class="line-removed">200   end_class                                                                                                                                                    \</span>
<span class="line-removed">201   start_class(RegisterSaveLayout)                                                                                                                              \</span>
<span class="line-removed">202     objArrayOop_field(RegisterSaveLayout, registers, &quot;[Ljdk/vm/ci/code/Register;&quot;)                                                                             \</span>
<span class="line-removed">203     typeArrayOop_field(RegisterSaveLayout, slots, &quot;[I&quot;)                                                                                                        \</span>
<span class="line-removed">204   end_class                                                                                                                                                    \</span>
<span class="line-removed">205   start_class(BytecodeFrame)                                                                                                                                   \</span>
<span class="line-removed">206     objArrayOop_field(BytecodeFrame, values, &quot;[Ljdk/vm/ci/meta/JavaValue;&quot;)                                                                                    \</span>
<span class="line-removed">207     objArrayOop_field(BytecodeFrame, slotKinds, &quot;[Ljdk/vm/ci/meta/JavaKind;&quot;)                                                                                  \</span>
<span class="line-removed">208     int_field(BytecodeFrame, numLocals)                                                                                                                        \</span>
<span class="line-removed">209     int_field(BytecodeFrame, numStack)                                                                                                                         \</span>
<span class="line-removed">210     int_field(BytecodeFrame, numLocks)                                                                                                                         \</span>
<span class="line-removed">211     boolean_field(BytecodeFrame, rethrowException)                                                                                                             \</span>
<span class="line-removed">212     boolean_field(BytecodeFrame, duringCall)                                                                                                                   \</span>
<span class="line-removed">213     static_int_field(BytecodeFrame, UNKNOWN_BCI)                                                                                                               \</span>
<span class="line-removed">214     static_int_field(BytecodeFrame, UNWIND_BCI)                                                                                                                \</span>
<span class="line-removed">215     static_int_field(BytecodeFrame, BEFORE_BCI)                                                                                                                \</span>
<span class="line-removed">216     static_int_field(BytecodeFrame, AFTER_BCI)                                                                                                                 \</span>
<span class="line-removed">217     static_int_field(BytecodeFrame, AFTER_EXCEPTION_BCI)                                                                                                       \</span>
<span class="line-removed">218     static_int_field(BytecodeFrame, INVALID_FRAMESTATE_BCI)                                                                                                    \</span>
<span class="line-removed">219   end_class                                                                                                                                                    \</span>
<span class="line-removed">220   start_class(BytecodePosition)                                                                                                                                \</span>
<span class="line-removed">221     oop_field(BytecodePosition, caller, &quot;Ljdk/vm/ci/code/BytecodePosition;&quot;)                                                                                   \</span>
<span class="line-removed">222     oop_field(BytecodePosition, method, &quot;Ljdk/vm/ci/meta/ResolvedJavaMethod;&quot;)                                                                                 \</span>
<span class="line-removed">223     int_field(BytecodePosition, bci)                                                                                                                           \</span>
<span class="line-removed">224   end_class                                                                                                                                                    \</span>
<span class="line-removed">225   start_class(JavaConstant)                                                                                                                                    \</span>
<span class="line-removed">226   end_class                                                                                                                                                    \</span>
<span class="line-removed">227   start_class(PrimitiveConstant)                                                                                                                               \</span>
<span class="line-removed">228     oop_field(PrimitiveConstant, kind, &quot;Ljdk/vm/ci/meta/JavaKind;&quot;)                                                                                            \</span>
<span class="line-removed">229     long_field(PrimitiveConstant, primitive)                                                                                                                   \</span>
<span class="line-removed">230   end_class                                                                                                                                                    \</span>
<span class="line-removed">231   start_class(RawConstant)                                                                                                                                     \</span>
<span class="line-removed">232     long_field(RawConstant, primitive)                                                                                                                         \</span>
<span class="line-removed">233   end_class                                                                                                                                                    \</span>
<span class="line-removed">234   start_class(NullConstant)                                                                                                                                    \</span>
<span class="line-removed">235   end_class                                                                                                                                                    \</span>
<span class="line-removed">236   start_class(HotSpotCompressedNullConstant)                                                                                                                   \</span>
<span class="line-removed">237   end_class                                                                                                                                                    \</span>
<span class="line-removed">238   start_class(HotSpotObjectConstantImpl)                                                                                                                       \</span>
<span class="line-removed">239     oop_field(HotSpotObjectConstantImpl, object, &quot;Ljava/lang/Object;&quot;)                                                                                         \</span>
<span class="line-removed">240     boolean_field(HotSpotObjectConstantImpl, compressed)                                                                                                       \</span>
<span class="line-removed">241   end_class                                                                                                                                                    \</span>
<span class="line-removed">242   start_class(HotSpotMetaspaceConstantImpl)                                                                                                                    \</span>
<span class="line-removed">243     oop_field(HotSpotMetaspaceConstantImpl, metaspaceObject, &quot;Ljdk/vm/ci/hotspot/MetaspaceWrapperObject;&quot;)                                                     \</span>
<span class="line-removed">244     boolean_field(HotSpotMetaspaceConstantImpl, compressed)                                                                                                    \</span>
<span class="line-removed">245   end_class                                                                                                                                                    \</span>
<span class="line-removed">246   start_class(HotSpotSentinelConstant)                                                                                                                         \</span>
<span class="line-removed">247   end_class                                                                                                                                                    \</span>
<span class="line-removed">248   start_class(JavaKind)                                                                                                                                        \</span>
<span class="line-removed">249     char_field(JavaKind, typeChar)                                                                                                                             \</span>
<span class="line-removed">250     static_oop_field(JavaKind, Boolean, &quot;Ljdk/vm/ci/meta/JavaKind;&quot;)                                                                                           \</span>
<span class="line-removed">251     static_oop_field(JavaKind, Byte, &quot;Ljdk/vm/ci/meta/JavaKind;&quot;)                                                                                              \</span>
<span class="line-removed">252     static_oop_field(JavaKind, Char, &quot;Ljdk/vm/ci/meta/JavaKind;&quot;)                                                                                              \</span>
<span class="line-removed">253     static_oop_field(JavaKind, Short, &quot;Ljdk/vm/ci/meta/JavaKind;&quot;)                                                                                             \</span>
<span class="line-removed">254     static_oop_field(JavaKind, Int, &quot;Ljdk/vm/ci/meta/JavaKind;&quot;)                                                                                               \</span>
<span class="line-removed">255     static_oop_field(JavaKind, Long, &quot;Ljdk/vm/ci/meta/JavaKind;&quot;)                                                                                              \</span>
<span class="line-removed">256   end_class                                                                                                                                                    \</span>
<span class="line-removed">257   start_class(ValueKind)                                                                                                                                       \</span>
<span class="line-removed">258     oop_field(ValueKind, platformKind, &quot;Ljdk/vm/ci/meta/PlatformKind;&quot;)                                                                                        \</span>
<span class="line-removed">259   end_class                                                                                                                                                    \</span>
<span class="line-removed">260   start_class(Value)                                                                                                                                           \</span>
<span class="line-removed">261     oop_field(Value, valueKind, &quot;Ljdk/vm/ci/meta/ValueKind;&quot;)                                                                                                  \</span>
<span class="line-removed">262     static_oop_field(Value, ILLEGAL, &quot;Ljdk/vm/ci/meta/AllocatableValue;&quot;)                                                                                      \</span>
<span class="line-removed">263   end_class                                                                                                                                                    \</span>
<span class="line-removed">264   start_class(RegisterValue)                                                                                                                                   \</span>
<span class="line-removed">265     oop_field(RegisterValue, reg, &quot;Ljdk/vm/ci/code/Register;&quot;)                                                                                                 \</span>
<span class="line-removed">266   end_class                                                                                                                                                    \</span>
<span class="line-removed">267   start_class(code_Location)                                                                                                                                   \</span>
<span class="line-removed">268     oop_field(code_Location, reg, &quot;Ljdk/vm/ci/code/Register;&quot;)                                                                                                 \</span>
<span class="line-removed">269     int_field(code_Location, offset)                                                                                                                           \</span>
<span class="line-removed">270   end_class                                                                                                                                                    \</span>
<span class="line-removed">271   start_class(code_Register)                                                                                                                                   \</span>
<span class="line-removed">272     int_field(code_Register, number)                                                                                                                           \</span>
<span class="line-removed">273     int_field(code_Register, encoding)                                                                                                                         \</span>
<span class="line-removed">274   end_class                                                                                                                                                    \</span>
<span class="line-removed">275   start_class(StackSlot)                                                                                                                                       \</span>
<span class="line-removed">276     int_field(StackSlot, offset)                                                                                                                               \</span>
<span class="line-removed">277     boolean_field(StackSlot, addFrameSize)                                                                                                                     \</span>
<span class="line-removed">278   end_class                                                                                                                                                    \</span>
<span class="line-removed">279   start_class(VirtualObject)                                                                                                                                   \</span>
<span class="line-removed">280     int_field(VirtualObject, id)                                                                                                                               \</span>
<span class="line-removed">281     oop_field(VirtualObject, type, &quot;Ljdk/vm/ci/meta/ResolvedJavaType;&quot;)                                                                                        \</span>
<span class="line-removed">282     objArrayOop_field(VirtualObject, values, &quot;[Ljdk/vm/ci/meta/JavaValue;&quot;)                                                                                    \</span>
<span class="line-removed">283     objArrayOop_field(VirtualObject, slotKinds, &quot;[Ljdk/vm/ci/meta/JavaKind;&quot;)                                                                                  \</span>
<span class="line-removed">284   end_class                                                                                                                                                    \</span>
<span class="line-removed">285   start_class(StackLockValue)                                                                                                                                  \</span>
<span class="line-removed">286     oop_field(StackLockValue, owner, &quot;Ljdk/vm/ci/meta/JavaValue;&quot;)                                                                                             \</span>
<span class="line-removed">287     oop_field(StackLockValue, slot, &quot;Ljdk/vm/ci/meta/AllocatableValue;&quot;)                                                                                       \</span>
<span class="line-removed">288     boolean_field(StackLockValue, eliminated)                                                                                                                  \</span>
<span class="line-removed">289   end_class                                                                                                                                                    \</span>
<span class="line-removed">290   start_class(HotSpotSpeculationLog)                                                                                                                           \</span>
<span class="line-removed">291     long_field(HotSpotSpeculationLog, lastFailed)                                                                                                              \</span>
<span class="line-removed">292   end_class                                                                                                                                                    \</span>
<span class="line-removed">293   start_class(HotSpotStackFrameReference)                                                                                                                      \</span>
<span class="line-removed">294     oop_field(HotSpotStackFrameReference, compilerToVM, &quot;Ljdk/vm/ci/hotspot/CompilerToVM;&quot;)                                                                    \</span>
<span class="line-removed">295     boolean_field(HotSpotStackFrameReference, objectsMaterialized)                                                                                             \</span>
<span class="line-removed">296     long_field(HotSpotStackFrameReference, stackPointer)                                                                                                       \</span>
<span class="line-removed">297     int_field(HotSpotStackFrameReference, frameNumber)                                                                                                         \</span>
<span class="line-removed">298     int_field(HotSpotStackFrameReference, bci)                                                                                                                 \</span>
<span class="line-removed">299     oop_field(HotSpotStackFrameReference, method, &quot;Ljdk/vm/ci/hotspot/HotSpotResolvedJavaMethod;&quot;)                                                             \</span>
<span class="line-removed">300     objArrayOop_field(HotSpotStackFrameReference, locals, &quot;[Ljava/lang/Object;&quot;)                                                                               \</span>
<span class="line-removed">301     typeArrayOop_field(HotSpotStackFrameReference, localIsVirtual, &quot;[Z&quot;)                                                                                       \</span>
<span class="line-removed">302   end_class                                                                                                                                                    \</span>
<span class="line-removed">303   start_class(HotSpotMetaData)                                                                                                                                 \</span>
<span class="line-removed">304     typeArrayOop_field(HotSpotMetaData, pcDescBytes, &quot;[B&quot;)                                                                                                     \</span>
<span class="line-removed">305     typeArrayOop_field(HotSpotMetaData, scopesDescBytes, &quot;[B&quot;)                                                                                                 \</span>
<span class="line-removed">306     typeArrayOop_field(HotSpotMetaData, relocBytes, &quot;[B&quot;)                                                                                                      \</span>
<span class="line-removed">307     typeArrayOop_field(HotSpotMetaData, exceptionBytes, &quot;[B&quot;)                                                                                                  \</span>
<span class="line-removed">308     typeArrayOop_field(HotSpotMetaData, oopMaps, &quot;[B&quot;)                                                                                                         \</span>
<span class="line-removed">309     objArrayOop_field(HotSpotMetaData, metadata, &quot;[Ljava/lang/Object;&quot;)                                                                                        \</span>
<span class="line-removed">310   end_class                                                                                                                                                    \</span>
<span class="line-removed">311   start_class(HotSpotConstantPool)                                                                                                                             \</span>
<span class="line-removed">312     long_field(HotSpotConstantPool, metaspaceConstantPool)                                                                                                     \</span>
<span class="line-removed">313   end_class                                                                                                                                                    \</span>
<span class="line-removed">314   start_class(HotSpotJVMCIRuntime)                                                                                                                             \</span>
<span class="line-removed">315     int_field(HotSpotJVMCIRuntime, compilationLevelAdjustment)                                                                                                 \</span>
<span class="line-removed">316   end_class                                                                                                                                                    \</span>
<span class="line-removed">317   /* end*/</span>
318 
<a name="10" id="anc10"></a><span class="line-modified">319 #define START_CLASS(name)                                                                                                                                      \</span>
<span class="line-modified">320 class name : AllStatic {                                                                                                                                       \</span>
<span class="line-modified">321   private:                                                                                                                                                     \</span>
<span class="line-modified">322     friend class JVMCICompiler;                                                                                                                                \</span>
<span class="line-removed">323     static void check(oop obj, const char* field_name, int offset);                                                                                            \</span>
<span class="line-removed">324     static void compute_offsets(TRAPS);                                                                                                                        \</span>
<span class="line-removed">325   public:                                                                                                                                                      \</span>
<span class="line-removed">326   static InstanceKlass* klass() { return SystemDictionary::name##_klass_is_loaded() ? SystemDictionary::name##_klass() : NULL; }</span>
327 
<a name="11" id="anc11"></a><span class="line-modified">328 #define END_CLASS };</span>

329 
<a name="12" id="anc12"></a><span class="line-modified">330 #define FIELD(name, type, accessor, cast)                                                                                                                         \</span>
<span class="line-removed">331     static int _##name##_offset;                                                                                                                                  \</span>
<span class="line-removed">332     static type name(oop obj)                   { check(obj, #name, _##name##_offset); return cast obj-&gt;accessor(_##name##_offset); }                             \</span>
<span class="line-removed">333     static type name(Handle obj)                { check(obj(), #name, _##name##_offset); return cast obj-&gt;accessor(_##name##_offset); }                           \</span>
<span class="line-removed">334     static type name(jobject obj);                                                                                                                                \</span>
<span class="line-removed">335     static void set_##name(oop obj, type x)     { check(obj, #name, _##name##_offset); obj-&gt;accessor##_put(_##name##_offset, x); }                                \</span>
<span class="line-removed">336     static void set_##name(Handle obj, type x)  { check(obj(), #name, _##name##_offset); obj-&gt;accessor##_put(_##name##_offset, x); }                              \</span>
<span class="line-removed">337     static void set_##name(jobject obj, type x);                                                                                                                  \</span>
338 
<a name="13" id="anc13"></a><span class="line-modified">339 #define EMPTY_CAST</span>
<span class="line-modified">340 #define CHAR_FIELD(klass, name) FIELD(name, jchar, char_field, EMPTY_CAST)</span>
<span class="line-modified">341 #define INT_FIELD(klass, name) FIELD(name, jint, int_field, EMPTY_CAST)</span>
<span class="line-modified">342 #define BOOLEAN_FIELD(klass, name) FIELD(name, jboolean, bool_field, EMPTY_CAST)</span>
<span class="line-modified">343 #define LONG_FIELD(klass, name) FIELD(name, jlong, long_field, EMPTY_CAST)</span>
<span class="line-modified">344 #define FLOAT_FIELD(klass, name) FIELD(name, jfloat, float_field, EMPTY_CAST)</span>
<span class="line-modified">345 #define OOP_FIELD(klass, name, signature) FIELD(name, oop, obj_field, EMPTY_CAST)</span>
<span class="line-modified">346 #define OBJARRAYOOP_FIELD(klass, name, signature) FIELD(name, objArrayOop, obj_field, (objArrayOop))</span>
<span class="line-modified">347 #define TYPEARRAYOOP_FIELD(klass, name, signature) FIELD(name, typeArrayOop, obj_field, (typeArrayOop))</span>
<span class="line-modified">348 #define STATIC_OOP_FIELD(klassName, name, signature) STATIC_OOPISH_FIELD(klassName, name, oop, signature)</span>
<span class="line-modified">349 #define STATIC_OBJARRAYOOP_FIELD(klassName, name, signature) STATIC_OOPISH_FIELD(klassName, name, objArrayOop, signature)</span>
<span class="line-modified">350 #define STATIC_OOPISH_FIELD(klassName, name, type, signature)                                                  \</span>
<span class="line-modified">351     static int _##name##_offset;                                                                               \</span>
<span class="line-modified">352     static type name();                                                                                        \</span>
<span class="line-modified">353     static void set_##name(type x);</span>
<span class="line-modified">354 #define STATIC_PRIMITIVE_FIELD(klassName, name, jtypename)                                                     \</span>
<span class="line-modified">355     static int _##name##_offset;                                                                               \</span>
<span class="line-modified">356     static jtypename name();                                                                                   \</span>
<span class="line-modified">357     static void set_##name(jtypename x);</span>
<span class="line-removed">358 </span>
<span class="line-removed">359 #define STATIC_INT_FIELD(klassName, name) STATIC_PRIMITIVE_FIELD(klassName, name, jint)</span>
<span class="line-removed">360 #define STATIC_BOOLEAN_FIELD(klassName, name) STATIC_PRIMITIVE_FIELD(klassName, name, jboolean)</span>
<span class="line-removed">361 </span>
<span class="line-removed">362 COMPILER_CLASSES_DO(START_CLASS, END_CLASS, CHAR_FIELD, INT_FIELD, BOOLEAN_FIELD, LONG_FIELD, FLOAT_FIELD, OOP_FIELD, TYPEARRAYOOP_FIELD, OBJARRAYOOP_FIELD, STATIC_OOP_FIELD, STATIC_OBJARRAYOOP_FIELD, STATIC_INT_FIELD, STATIC_BOOLEAN_FIELD)</span>
363 #undef START_CLASS
364 #undef END_CLASS
<a name="14" id="anc14"></a>

365 #undef FIELD
366 #undef CHAR_FIELD
367 #undef INT_FIELD
368 #undef BOOLEAN_FIELD
369 #undef LONG_FIELD
370 #undef FLOAT_FIELD
<a name="15" id="anc15"></a><span class="line-modified">371 #undef OOP_FIELD</span>
<span class="line-modified">372 #undef TYPEARRAYOOP_FIELD</span>
<span class="line-modified">373 #undef OBJARRAYOOP_FIELD</span>



374 #undef STATIC_OOPISH_FIELD
<a name="16" id="anc16"></a><span class="line-modified">375 #undef STATIC_OOP_FIELD</span>
<span class="line-modified">376 #undef STATIC_OBJARRAYOOP_FIELD</span>

377 #undef STATIC_INT_FIELD
378 #undef STATIC_BOOLEAN_FIELD
379 #undef STATIC_PRIMITIVE_FIELD
380 #undef EMPTY_CAST
381 
<a name="17" id="anc17"></a><span class="line-removed">382 void compute_offset(int &amp;dest_offset, Klass* klass, const char* name, const char* signature, bool static_field, TRAPS);</span>
<span class="line-removed">383 </span>
384 #endif // SHARE_JVMCI_JVMCIJAVACLASSES_HPP
<a name="18" id="anc18"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="18" type="hidden" />
</body>
</html>