<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/runtime/stubRoutines.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="stubRoutines.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="sweeper.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/runtime/stubRoutines.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -72,10 +72,55 @@</span>
  // 2. add a private instance variable holding the entry point address
  // 3. add a public accessor function to the instance variable
  // 4. implement the corresponding generator function in the platform-dependent
  //    stubGenerator_&lt;arch&gt;.cpp file and call the function in generate_all() of that file
  
<span class="udiff-line-added">+ class UnsafeCopyMemory : public CHeapObj&lt;mtCode&gt; {</span>
<span class="udiff-line-added">+  private:</span>
<span class="udiff-line-added">+   address _start_pc;</span>
<span class="udiff-line-added">+   address _end_pc;</span>
<span class="udiff-line-added">+   address _error_exit_pc;</span>
<span class="udiff-line-added">+  public:</span>
<span class="udiff-line-added">+   static address           _common_exit_stub_pc;</span>
<span class="udiff-line-added">+   static UnsafeCopyMemory* _table;</span>
<span class="udiff-line-added">+   static int               _table_length;</span>
<span class="udiff-line-added">+   static int               _table_max_length;</span>
<span class="udiff-line-added">+   UnsafeCopyMemory() : _start_pc(NULL), _end_pc(NULL), _error_exit_pc(NULL) {}</span>
<span class="udiff-line-added">+   void    set_start_pc(address pc)      { _start_pc = pc; }</span>
<span class="udiff-line-added">+   void    set_end_pc(address pc)        { _end_pc = pc; }</span>
<span class="udiff-line-added">+   void    set_error_exit_pc(address pc) { _error_exit_pc = pc; }</span>
<span class="udiff-line-added">+   address start_pc()      const { return _start_pc; }</span>
<span class="udiff-line-added">+   address end_pc()        const { return _end_pc; }</span>
<span class="udiff-line-added">+   address error_exit_pc() const { return _error_exit_pc; }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   static void    set_common_exit_stub_pc(address pc) { _common_exit_stub_pc = pc; }</span>
<span class="udiff-line-added">+   static address common_exit_stub_pc()               { return _common_exit_stub_pc; }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   static UnsafeCopyMemory* add_to_table(address start_pc, address end_pc, address error_exit_pc) {</span>
<span class="udiff-line-added">+     guarantee(_table_length &lt; _table_max_length, &quot;Incorrect UnsafeCopyMemory::_table_max_length&quot;);</span>
<span class="udiff-line-added">+     UnsafeCopyMemory* entry = &amp;_table[_table_length];</span>
<span class="udiff-line-added">+     entry-&gt;set_start_pc(start_pc);</span>
<span class="udiff-line-added">+     entry-&gt;set_end_pc(end_pc);</span>
<span class="udiff-line-added">+     entry-&gt;set_error_exit_pc(error_exit_pc);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     _table_length++;</span>
<span class="udiff-line-added">+     return entry;</span>
<span class="udiff-line-added">+   }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   static bool    contains_pc(address pc);</span>
<span class="udiff-line-added">+   static address page_error_continue_pc(address pc);</span>
<span class="udiff-line-added">+   static void    create_table(int max_size);</span>
<span class="udiff-line-added">+ };</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ class UnsafeCopyMemoryMark : public StackObj {</span>
<span class="udiff-line-added">+  private:</span>
<span class="udiff-line-added">+   UnsafeCopyMemory*  _ucm_entry;</span>
<span class="udiff-line-added">+   StubCodeGenerator* _cgen;</span>
<span class="udiff-line-added">+  public:</span>
<span class="udiff-line-added">+   UnsafeCopyMemoryMark(StubCodeGenerator* cgen, bool add_entry, bool continue_at_scope_end, address error_exit_pc = NULL);</span>
<span class="udiff-line-added">+   ~UnsafeCopyMemoryMark();</span>
<span class="udiff-line-added">+ };</span>
  
  class StubRoutines: AllStatic {
  
   public:
    // Dependencies
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -144,10 +189,14 @@</span>
    static address _arrayof_jshort_disjoint_arraycopy;
    static address _arrayof_jint_disjoint_arraycopy;
    static address _arrayof_jlong_disjoint_arraycopy;
    static address _arrayof_oop_disjoint_arraycopy, _arrayof_oop_disjoint_arraycopy_uninit;
  
<span class="udiff-line-added">+   // cache line writeback</span>
<span class="udiff-line-added">+   static address _data_cache_writeback;</span>
<span class="udiff-line-added">+   static address _data_cache_writeback_sync;</span>
<span class="udiff-line-added">+ </span>
    // these are recommended but optional:
    static address _checkcast_arraycopy, _checkcast_arraycopy_uninit;
    static address _unsafe_arraycopy;
    static address _generic_arraycopy;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -163,10 +212,12 @@</span>
  
    static address _aescrypt_encryptBlock;
    static address _aescrypt_decryptBlock;
    static address _cipherBlockChaining_encryptAESCrypt;
    static address _cipherBlockChaining_decryptAESCrypt;
<span class="udiff-line-added">+   static address _electronicCodeBook_encryptAESCrypt;</span>
<span class="udiff-line-added">+   static address _electronicCodeBook_decryptAESCrypt;</span>
    static address _counterMode_AESCrypt;
    static address _ghash_processBlocks;
    static address _base64_encodeBlock;
  
    static address _sha1_implCompress;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -186,10 +237,12 @@</span>
    static address _multiplyToLen;
    static address _squareToLen;
    static address _mulAdd;
    static address _montgomeryMultiply;
    static address _montgomerySquare;
<span class="udiff-line-added">+   static address _bigIntegerRightShiftWorker;</span>
<span class="udiff-line-added">+   static address _bigIntegerLeftShiftWorker;</span>
  
    static address _vectorizedMismatch;
  
    static address _dexp;
    static address _dlog;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -308,15 +361,26 @@</span>
    static address arrayof_jint_disjoint_arraycopy()   { return _arrayof_jint_disjoint_arraycopy; }
    static address arrayof_jlong_disjoint_arraycopy()  { return _arrayof_jlong_disjoint_arraycopy; }
    static address arrayof_oop_disjoint_arraycopy(bool dest_uninitialized = false) {
      return dest_uninitialized ? _arrayof_oop_disjoint_arraycopy_uninit : _arrayof_oop_disjoint_arraycopy;
    }
<span class="udiff-line-added">+   static address data_cache_writeback()              { return _data_cache_writeback; }</span>
<span class="udiff-line-added">+   static address data_cache_writeback_sync()         { return _data_cache_writeback_sync; }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   typedef void (*DataCacheWritebackStub)(void *);</span>
<span class="udiff-line-added">+   static DataCacheWritebackStub DataCacheWriteback_stub()         { return CAST_TO_FN_PTR(DataCacheWritebackStub,  _data_cache_writeback); }</span>
<span class="udiff-line-added">+   typedef void (*DataCacheWritebackSyncStub)(bool);</span>
<span class="udiff-line-added">+   static DataCacheWritebackSyncStub DataCacheWritebackSync_stub() { return CAST_TO_FN_PTR(DataCacheWritebackSyncStub,  _data_cache_writeback_sync); }</span>
  
    static address checkcast_arraycopy(bool dest_uninitialized = false) {
      return dest_uninitialized ? _checkcast_arraycopy_uninit : _checkcast_arraycopy;
    }
<span class="udiff-line-modified-removed">-   static address unsafe_arraycopy()    { return _unsafe_arraycopy; }</span>
<span class="udiff-line-modified-added">+   static address unsafe_arraycopy()     { return _unsafe_arraycopy; }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   typedef void (*UnsafeArrayCopyStub)(const void* src, void* dst, size_t count);</span>
<span class="udiff-line-added">+   static UnsafeArrayCopyStub UnsafeArrayCopy_stub()         { return CAST_TO_FN_PTR(UnsafeArrayCopyStub,  _unsafe_arraycopy); }</span>
<span class="udiff-line-added">+ </span>
    static address generic_arraycopy()   { return _generic_arraycopy; }
  
    static address jbyte_fill()          { return _jbyte_fill; }
    static address jshort_fill()         { return _jshort_fill; }
    static address jint_fill()           { return _jint_fill; }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -326,10 +390,12 @@</span>
  
    static address aescrypt_encryptBlock()                { return _aescrypt_encryptBlock; }
    static address aescrypt_decryptBlock()                { return _aescrypt_decryptBlock; }
    static address cipherBlockChaining_encryptAESCrypt()  { return _cipherBlockChaining_encryptAESCrypt; }
    static address cipherBlockChaining_decryptAESCrypt()  { return _cipherBlockChaining_decryptAESCrypt; }
<span class="udiff-line-added">+   static address electronicCodeBook_encryptAESCrypt()   { return _electronicCodeBook_encryptAESCrypt; }</span>
<span class="udiff-line-added">+   static address electronicCodeBook_decryptAESCrypt()   { return _electronicCodeBook_decryptAESCrypt; }</span>
    static address counterMode_AESCrypt()  { return _counterMode_AESCrypt; }
    static address ghash_processBlocks()   { return _ghash_processBlocks; }
    static address base64_encodeBlock()    { return _base64_encodeBlock; }
    static address sha1_implCompress()     { return _sha1_implCompress; }
    static address sha1_implCompressMB()   { return _sha1_implCompressMB; }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -348,10 +414,12 @@</span>
    static address multiplyToLen()       { return _multiplyToLen; }
    static address squareToLen()         { return _squareToLen; }
    static address mulAdd()              { return _mulAdd; }
    static address montgomeryMultiply()  { return _montgomeryMultiply; }
    static address montgomerySquare()    { return _montgomerySquare; }
<span class="udiff-line-added">+   static address bigIntegerRightShift() { return _bigIntegerRightShiftWorker; }</span>
<span class="udiff-line-added">+   static address bigIntegerLeftShift()  { return _bigIntegerLeftShiftWorker; }</span>
  
    static address vectorizedMismatch()  { return _vectorizedMismatch; }
  
    static address dexp()                { return _dexp; }
    static address dlog()                { return _dlog; }
</pre>
<center><a href="stubRoutines.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="sweeper.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>