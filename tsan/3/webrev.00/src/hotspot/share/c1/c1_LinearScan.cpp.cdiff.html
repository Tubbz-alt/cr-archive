<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/c1/c1_LinearScan.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="c1_LIRGenerator.hpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="c1_LinearScan.hpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/c1/c1_LinearScan.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 88,11 ***</span>
   , _block_of_op(0) // initialized later with correct length
   , _has_info(0)
   , _has_call(0)
   , _interval_in_loop(0)  // initialized later with correct length
   , _scope_value_cache(0) // initialized later with correct length
<span class="line-modified">! #ifdef X86</span>
   , _fpu_stack_allocator(NULL)
  #endif
  {
    assert(this-&gt;ir() != NULL,          &quot;check if valid&quot;);
    assert(this-&gt;compilation() != NULL, &quot;check if valid&quot;);
<span class="line-new-header">--- 88,11 ---</span>
   , _block_of_op(0) // initialized later with correct length
   , _has_info(0)
   , _has_call(0)
   , _interval_in_loop(0)  // initialized later with correct length
   , _scope_value_cache(0) // initialized later with correct length
<span class="line-modified">! #ifdef IA32</span>
   , _fpu_stack_allocator(NULL)
  #endif
  {
    assert(this-&gt;ir() != NULL,          &quot;check if valid&quot;);
    assert(this-&gt;compilation() != NULL, &quot;check if valid&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2651,17 ***</span>
      scope_values-&gt;append(sv);
      return 1;
  #endif
  
    } else if (opr-&gt;is_single_fpu()) {
<span class="line-modified">! #ifdef X86</span>
      // the exact location of fpu stack values is only known
      // during fpu stack allocation, so the stack allocator object
      // must be present
      assert(use_fpu_stack_allocation(), &quot;should not have float stack values without fpu stack allocation (all floats must be SSE2)&quot;);
      assert(_fpu_stack_allocator != NULL, &quot;must be present&quot;);
      opr = _fpu_stack_allocator-&gt;to_fpu_stack(opr);
  #endif
  
      Location::Type loc_type = float_saved_as_double ? Location::float_in_dbl : Location::normal;
      VMReg rname = frame_map()-&gt;fpu_regname(opr-&gt;fpu_regnr());
  #ifndef __SOFTFP__
<span class="line-new-header">--- 2651,19 ---</span>
      scope_values-&gt;append(sv);
      return 1;
  #endif
  
    } else if (opr-&gt;is_single_fpu()) {
<span class="line-modified">! #ifdef IA32</span>
      // the exact location of fpu stack values is only known
      // during fpu stack allocation, so the stack allocator object
      // must be present
      assert(use_fpu_stack_allocation(), &quot;should not have float stack values without fpu stack allocation (all floats must be SSE2)&quot;);
      assert(_fpu_stack_allocator != NULL, &quot;must be present&quot;);
      opr = _fpu_stack_allocator-&gt;to_fpu_stack(opr);
<span class="line-added">+ #elif defined(AMD64)</span>
<span class="line-added">+     assert(false, &quot;FPU not used on x86-64&quot;);</span>
  #endif
  
      Location::Type loc_type = float_saved_as_double ? Location::float_in_dbl : Location::normal;
      VMReg rname = frame_map()-&gt;fpu_regname(opr-&gt;fpu_regnr());
  #ifndef __SOFTFP__
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2762,20 ***</span>
        // fpu_regnrLo is a FPU stack slot whose VMReg represents
        // the low-order word of the double and fpu_regnrLo + 1 is the
        // name for the other half.  *first and *second must represent the
        // least and most significant words, respectively.
  
<span class="line-modified">! #ifdef X86</span>
        // the exact location of fpu stack values is only known
        // during fpu stack allocation, so the stack allocator object
        // must be present
        assert(use_fpu_stack_allocation(), &quot;should not have float stack values without fpu stack allocation (all floats must be SSE2)&quot;);
        assert(_fpu_stack_allocator != NULL, &quot;must be present&quot;);
        opr = _fpu_stack_allocator-&gt;to_fpu_stack(opr);
  
        assert(opr-&gt;fpu_regnrLo() == opr-&gt;fpu_regnrHi(), &quot;assumed in calculation (only fpu_regnrLo is used)&quot;);
  #endif
  #ifdef SPARC
        assert(opr-&gt;fpu_regnrLo() == opr-&gt;fpu_regnrHi() + 1, &quot;assumed in calculation (only fpu_regnrHi is used)&quot;);
  #endif
  #ifdef ARM32
        assert(opr-&gt;fpu_regnrHi() == opr-&gt;fpu_regnrLo() + 1, &quot;assumed in calculation (only fpu_regnrLo is used)&quot;);
<span class="line-new-header">--- 2764,23 ---</span>
        // fpu_regnrLo is a FPU stack slot whose VMReg represents
        // the low-order word of the double and fpu_regnrLo + 1 is the
        // name for the other half.  *first and *second must represent the
        // least and most significant words, respectively.
  
<span class="line-modified">! #ifdef IA32</span>
        // the exact location of fpu stack values is only known
        // during fpu stack allocation, so the stack allocator object
        // must be present
        assert(use_fpu_stack_allocation(), &quot;should not have float stack values without fpu stack allocation (all floats must be SSE2)&quot;);
        assert(_fpu_stack_allocator != NULL, &quot;must be present&quot;);
        opr = _fpu_stack_allocator-&gt;to_fpu_stack(opr);
  
        assert(opr-&gt;fpu_regnrLo() == opr-&gt;fpu_regnrHi(), &quot;assumed in calculation (only fpu_regnrLo is used)&quot;);
  #endif
<span class="line-added">+ #ifdef AMD64</span>
<span class="line-added">+       assert(false, &quot;FPU not used on x86-64&quot;);</span>
<span class="line-added">+ #endif</span>
  #ifdef SPARC
        assert(opr-&gt;fpu_regnrLo() == opr-&gt;fpu_regnrHi() + 1, &quot;assumed in calculation (only fpu_regnrHi is used)&quot;);
  #endif
  #ifdef ARM32
        assert(opr-&gt;fpu_regnrHi() == opr-&gt;fpu_regnrLo() + 1, &quot;assumed in calculation (only fpu_regnrLo is used)&quot;);
</pre>
<center><a href="c1_LIRGenerator.hpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="c1_LinearScan.hpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>