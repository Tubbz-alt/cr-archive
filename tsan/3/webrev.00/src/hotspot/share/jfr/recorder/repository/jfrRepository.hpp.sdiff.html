<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/jfr/recorder/repository/jfrRepository.hpp</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="jfrRepository.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../service/jfrOptionSet.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/jfr/recorder/repository/jfrRepository.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
38 //
39 // Chunk files are associated with recordings and are managed at a higher level in Java.
40 // Java continously keeps the VM informed about new chunk locations via set_chunk_path().
41 //
42 // A JfrChunkWriter will open the next chunk file which it maintains as the current chunk.
43 // There is a rotation scheme in place for creating new chunks at certain intervals.
44 //
45 class JfrRepository : public JfrCHeapObj {
46   friend class JfrRecorder;
47   friend class JfrRecorderService;
48  private:
49   char* _path;
50   JfrPostBox&amp; _post_box;
51 
52   JfrRepository(JfrPostBox&amp; post_box);
53   ~JfrRepository();
54 
55   bool set_path(const char* path);
56   void set_chunk_path(const char* path);
57   bool open_chunk(bool vm_error = false);
<span class="line-modified">58   size_t close_chunk(int64_t metadata_offset);</span>

59   void on_vm_error();

60   static void notify_on_new_chunk_path();
61   static JfrChunkWriter&amp; chunkwriter();
62 
63   static JfrRepository&amp; instance();
64   static JfrRepository* create(JfrPostBox&amp; post_box);
65   bool initialize();
66   static void destroy();
67 
68  public:
69   static void set_path(jstring location, JavaThread* jt);
70   static void set_chunk_path(jstring path, JavaThread* jt);



71 };
72 
73 #endif // SHARE_JFR_RECORDER_REPOSITORY_JFRREPOSITORY_HPP
</pre>
</td>
<td>
<hr />
<pre>
38 //
39 // Chunk files are associated with recordings and are managed at a higher level in Java.
40 // Java continously keeps the VM informed about new chunk locations via set_chunk_path().
41 //
42 // A JfrChunkWriter will open the next chunk file which it maintains as the current chunk.
43 // There is a rotation scheme in place for creating new chunks at certain intervals.
44 //
45 class JfrRepository : public JfrCHeapObj {
46   friend class JfrRecorder;
47   friend class JfrRecorderService;
48  private:
49   char* _path;
50   JfrPostBox&amp; _post_box;
51 
52   JfrRepository(JfrPostBox&amp; post_box);
53   ~JfrRepository();
54 
55   bool set_path(const char* path);
56   void set_chunk_path(const char* path);
57   bool open_chunk(bool vm_error = false);
<span class="line-modified">58   size_t close_chunk();</span>
<span class="line-added">59   size_t flush_chunk();</span>
60   void on_vm_error();
<span class="line-added">61 </span>
62   static void notify_on_new_chunk_path();
63   static JfrChunkWriter&amp; chunkwriter();
64 
65   static JfrRepository&amp; instance();
66   static JfrRepository* create(JfrPostBox&amp; post_box);
67   bool initialize();
68   static void destroy();
69 
70  public:
71   static void set_path(jstring location, JavaThread* jt);
72   static void set_chunk_path(jstring path, JavaThread* jt);
<span class="line-added">73   static void mark_chunk_final();</span>
<span class="line-added">74   static void flush(JavaThread* jt);</span>
<span class="line-added">75   static jlong current_chunk_start_nanos();</span>
76 };
77 
78 #endif // SHARE_JFR_RECORDER_REPOSITORY_JFRREPOSITORY_HPP
</pre>
</td>
</tr>
</table>
<center><a href="jfrRepository.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../service/jfrOptionSet.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>