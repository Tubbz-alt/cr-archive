<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/jfr/jni/jfrJavaSupport.hpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="jfrJavaSupport.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="jfrJniMethod.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/jfr/jni/jfrJavaSupport.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  *
 23  */
 24 
 25 #ifndef SHARE_JFR_JNI_JFRJAVASUPPORT_HPP
 26 #define SHARE_JFR_JNI_JFRJAVASUPPORT_HPP
 27 
 28 #include &quot;jfr/jni/jfrJavaCall.hpp&quot;
 29 #include &quot;utilities/exceptions.hpp&quot;
 30 
 31 class Klass;
<span class="line-removed"> 32 class JavaThread;</span>
 33 class outputStream;
 34 
 35 class JfrJavaSupport : public AllStatic {
 36  public:
 37   static jobject local_jni_handle(const oop obj, Thread* t);
 38   static jobject local_jni_handle(const jobject handle, Thread* t);
<span class="line-modified"> 39   static void destroy_local_jni_handle(const jobject handle);</span>
 40 
 41   static jobject global_jni_handle(const oop obj, Thread* t);
 42   static jobject global_jni_handle(const jobject handle, Thread* t);
<span class="line-modified"> 43   static void destroy_global_jni_handle(const jobject handle);</span>




 44 
 45   static oop resolve_non_null(jobject obj);
 46   static void notify_all(jobject obj, TRAPS);
 47   static void set_array_element(jobjectArray arr, jobject element, int index, Thread* t);
 48 
 49   // naked oop result
 50   static void call_static(JfrJavaArguments* args, TRAPS);
 51   static void call_special(JfrJavaArguments* args, TRAPS);
 52   static void call_virtual(JfrJavaArguments* args, TRAPS);
 53 
 54   static void set_field(JfrJavaArguments* args, TRAPS);
 55   static void get_field(JfrJavaArguments* args, TRAPS);
 56   static void new_object(JfrJavaArguments* args, TRAPS);
 57 
 58   // global jni handle result
 59   static void new_object_global_ref(JfrJavaArguments* args, TRAPS);
 60   static void get_field_global_ref(JfrJavaArguments* args, TRAPS);
 61 
 62   // local jni handle result
 63   static void new_object_local_ref(JfrJavaArguments* args, TRAPS);
 64   static void get_field_local_ref(JfrJavaArguments* args, TRAPS);
 65 
 66   static jstring new_string(const char* c_str, TRAPS);
 67   static jobjectArray new_string_array(int length, TRAPS);
 68 
 69   static jobject new_java_lang_Boolean(bool value, TRAPS);
 70   static jobject new_java_lang_Integer(jint value, TRAPS);
 71   static jobject new_java_lang_Long(jlong value, TRAPS);
 72 
 73   // misc
 74   static Klass* klass(const jobject handle);
 75   // caller needs ResourceMark
 76   static const char* c_str(jstring string, Thread* jt);
 77 
 78   // exceptions
 79   static void throw_illegal_state_exception(const char* message, TRAPS);
 80   static void throw_illegal_argument_exception(const char* message, TRAPS);
 81   static void throw_internal_error(const char* message, TRAPS);
 82   static void throw_out_of_memory_error(const char* message, TRAPS);
 83   static void throw_class_format_error(const char* message, TRAPS);

 84 
 85   static bool is_jdk_jfr_module_available();
 86   static bool is_jdk_jfr_module_available(outputStream* stream, TRAPS);
 87 
<span class="line-modified"> 88   static jlong jfr_thread_id(jobject target_thread);</span>







 89 
 90   // critical
 91   static void abort(jstring errorMsg, TRAPS);
 92   static void uncaught_exception(jthrowable throwable, Thread* t);
 93 
 94   // asserts
 95   DEBUG_ONLY(static void check_java_thread_in_vm(Thread* t);)
 96   DEBUG_ONLY(static void check_java_thread_in_native(Thread* t);)
 97 
 98   enum CAUSE {
 99     VM_ERROR,
100     OUT_OF_MEMORY,
101     STACK_OVERFLOW,
102     RUNTIME_EXCEPTION,
103     UNKNOWN,
104     NOF_CAUSES
105   };
106 
107   static CAUSE cause();
108 
</pre>
</td>
<td>
<hr />
<pre>
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  *
 23  */
 24 
 25 #ifndef SHARE_JFR_JNI_JFRJAVASUPPORT_HPP
 26 #define SHARE_JFR_JNI_JFRJAVASUPPORT_HPP
 27 
 28 #include &quot;jfr/jni/jfrJavaCall.hpp&quot;
 29 #include &quot;utilities/exceptions.hpp&quot;
 30 
 31 class Klass;

 32 class outputStream;
 33 
 34 class JfrJavaSupport : public AllStatic {
 35  public:
 36   static jobject local_jni_handle(const oop obj, Thread* t);
 37   static jobject local_jni_handle(const jobject handle, Thread* t);
<span class="line-modified"> 38   static void destroy_local_jni_handle(jobject handle);</span>
 39 
 40   static jobject global_jni_handle(const oop obj, Thread* t);
 41   static jobject global_jni_handle(const jobject handle, Thread* t);
<span class="line-modified"> 42   static void destroy_global_jni_handle(jobject handle);</span>
<span class="line-added"> 43 </span>
<span class="line-added"> 44   static jweak global_weak_jni_handle(const oop obj, Thread* t);</span>
<span class="line-added"> 45   static jweak global_weak_jni_handle(const jobject handle, Thread* t);</span>
<span class="line-added"> 46   static void destroy_global_weak_jni_handle(jweak handle);</span>
 47 
 48   static oop resolve_non_null(jobject obj);
 49   static void notify_all(jobject obj, TRAPS);
 50   static void set_array_element(jobjectArray arr, jobject element, int index, Thread* t);
 51 
 52   // naked oop result
 53   static void call_static(JfrJavaArguments* args, TRAPS);
 54   static void call_special(JfrJavaArguments* args, TRAPS);
 55   static void call_virtual(JfrJavaArguments* args, TRAPS);
 56 
 57   static void set_field(JfrJavaArguments* args, TRAPS);
 58   static void get_field(JfrJavaArguments* args, TRAPS);
 59   static void new_object(JfrJavaArguments* args, TRAPS);
 60 
 61   // global jni handle result
 62   static void new_object_global_ref(JfrJavaArguments* args, TRAPS);
 63   static void get_field_global_ref(JfrJavaArguments* args, TRAPS);
 64 
 65   // local jni handle result
 66   static void new_object_local_ref(JfrJavaArguments* args, TRAPS);
 67   static void get_field_local_ref(JfrJavaArguments* args, TRAPS);
 68 
 69   static jstring new_string(const char* c_str, TRAPS);
 70   static jobjectArray new_string_array(int length, TRAPS);
 71 
 72   static jobject new_java_lang_Boolean(bool value, TRAPS);
 73   static jobject new_java_lang_Integer(jint value, TRAPS);
 74   static jobject new_java_lang_Long(jlong value, TRAPS);
 75 
 76   // misc
 77   static Klass* klass(const jobject handle);
 78   // caller needs ResourceMark
 79   static const char* c_str(jstring string, Thread* jt);
 80 
 81   // exceptions
 82   static void throw_illegal_state_exception(const char* message, TRAPS);
 83   static void throw_illegal_argument_exception(const char* message, TRAPS);
 84   static void throw_internal_error(const char* message, TRAPS);
 85   static void throw_out_of_memory_error(const char* message, TRAPS);
 86   static void throw_class_format_error(const char* message, TRAPS);
<span class="line-added"> 87   static void throw_runtime_exception(const char* message, TRAPS);</span>
 88 
 89   static bool is_jdk_jfr_module_available();
 90   static bool is_jdk_jfr_module_available(outputStream* stream, TRAPS);
 91 
<span class="line-modified"> 92   static jlong jfr_thread_id(jobject thread);</span>
<span class="line-added"> 93   static void exclude(jobject thread);</span>
<span class="line-added"> 94   static void include(jobject thread);</span>
<span class="line-added"> 95   static bool is_excluded(jobject thread);</span>
<span class="line-added"> 96   static void on_thread_start(Thread* t);</span>
<span class="line-added"> 97 </span>
<span class="line-added"> 98   static jobject get_handler(jobject clazz, TRAPS);</span>
<span class="line-added"> 99   static bool set_handler(jobject clazz, jobject handler, TRAPS);</span>
100 
101   // critical
102   static void abort(jstring errorMsg, TRAPS);
103   static void uncaught_exception(jthrowable throwable, Thread* t);
104 
105   // asserts
106   DEBUG_ONLY(static void check_java_thread_in_vm(Thread* t);)
107   DEBUG_ONLY(static void check_java_thread_in_native(Thread* t);)
108 
109   enum CAUSE {
110     VM_ERROR,
111     OUT_OF_MEMORY,
112     STACK_OVERFLOW,
113     RUNTIME_EXCEPTION,
114     UNKNOWN,
115     NOF_CAUSES
116   };
117 
118   static CAUSE cause();
119 
</pre>
</td>
</tr>
</table>
<center><a href="jfrJavaSupport.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="jfrJniMethod.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>