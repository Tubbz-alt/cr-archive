<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/include/jmm.h</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="cds.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="jvm.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/include/jmm.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2003, 2017, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 33  * Bump the version number when either of the following happens:
 34  *
 35  * 1. There is a change in functions in JmmInterface.
 36  *
 37  * 2. There is a change in the contract between VM and Java classes.
 38  */
 39 
 40 #include &quot;jni.h&quot;
 41 
 42 #ifdef __cplusplus
 43 extern &quot;C&quot; {
 44 #endif
 45 
 46 enum {
 47   JMM_VERSION_1   = 0x20010000,
 48   JMM_VERSION_1_0 = 0x20010000,
 49   JMM_VERSION_1_1 = 0x20010100, // JDK 6
 50   JMM_VERSION_1_2 = 0x20010200, // JDK 7
 51   JMM_VERSION_1_2_1 = 0x20010201, // JDK 7 GA
 52   JMM_VERSION_1_2_2 = 0x20010202,
<span class="line-modified"> 53   JMM_VERSION_2  = 0x20020000,  // JDK 10</span>
<span class="line-modified"> 54   JMM_VERSION     = 0x20020000</span>

 55 };
 56 
 57 typedef struct {
 58   unsigned int isLowMemoryDetectionSupported : 1;
 59   unsigned int isCompilationTimeMonitoringSupported : 1;
 60   unsigned int isThreadContentionMonitoringSupported : 1;
 61   unsigned int isCurrentThreadCpuTimeSupported : 1;
 62   unsigned int isOtherThreadCpuTimeSupported : 1;
 63   unsigned int isObjectMonitorUsageSupported : 1;
 64   unsigned int isSynchronizerUsageSupported : 1;
 65   unsigned int isThreadAllocatedMemorySupported : 1;
 66   unsigned int isRemoteDiagnosticCommandsSupported : 1;
 67   unsigned int : 22;
 68 } jmmOptionalSupport;
 69 
 70 typedef enum {
 71   JMM_CLASS_LOADED_COUNT             = 1,    /* Total number of loaded classes */
 72   JMM_CLASS_UNLOADED_COUNT           = 2,    /* Total number of unloaded classes */
 73   JMM_THREAD_TOTAL_COUNT             = 3,    /* Total number of threads that have been started */
 74   JMM_THREAD_LIVE_COUNT              = 4,    /* Current number of live threads */
</pre>
<hr />
<pre>
222   void*        reserved1;
223   void*        reserved2;
224 
225   jint         (JNICALL *GetVersion)             (JNIEnv *env);
226 
227   jint         (JNICALL *GetOptionalSupport)     (JNIEnv *env,
228                                                   jmmOptionalSupport* support_ptr);
229 
230   jint         (JNICALL *GetThreadInfo)          (JNIEnv *env,
231                                                   jlongArray ids,
232                                                   jint maxDepth,
233                                                   jobjectArray infoArray);
234 
235   jobjectArray (JNICALL *GetMemoryPools)         (JNIEnv* env, jobject mgr);
236 
237   jobjectArray (JNICALL *GetMemoryManagers)      (JNIEnv* env, jobject pool);
238 
239   jobject      (JNICALL *GetMemoryPoolUsage)     (JNIEnv* env, jobject pool);
240   jobject      (JNICALL *GetPeakMemoryPoolUsage) (JNIEnv* env, jobject pool);
241 



242   void         (JNICALL *GetThreadAllocatedMemory)
243                                                  (JNIEnv *env,
244                                                   jlongArray ids,
245                                                   jlongArray sizeArray);
246 
247   jobject      (JNICALL *GetMemoryUsage)         (JNIEnv* env, jboolean heap);
248 
249   jlong        (JNICALL *GetLongAttribute)       (JNIEnv *env, jobject obj, jmmLongAttribute att);
250   jboolean     (JNICALL *GetBoolAttribute)       (JNIEnv *env, jmmBoolAttribute att);
251   jboolean     (JNICALL *SetBoolAttribute)       (JNIEnv *env, jmmBoolAttribute att, jboolean flag);
252 
253   jint         (JNICALL *GetLongAttributes)      (JNIEnv *env,
254                                                   jobject obj,
255                                                   jmmLongAttribute* atts,
256                                                   jint count,
257                                                   jlong* result);
258 
259   jobjectArray (JNICALL *FindCircularBlockedThreads) (JNIEnv *env);
260 
261   // Not used in JDK 6 or JDK 7
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 33  * Bump the version number when either of the following happens:
 34  *
 35  * 1. There is a change in functions in JmmInterface.
 36  *
 37  * 2. There is a change in the contract between VM and Java classes.
 38  */
 39 
 40 #include &quot;jni.h&quot;
 41 
 42 #ifdef __cplusplus
 43 extern &quot;C&quot; {
 44 #endif
 45 
 46 enum {
 47   JMM_VERSION_1   = 0x20010000,
 48   JMM_VERSION_1_0 = 0x20010000,
 49   JMM_VERSION_1_1 = 0x20010100, // JDK 6
 50   JMM_VERSION_1_2 = 0x20010200, // JDK 7
 51   JMM_VERSION_1_2_1 = 0x20010201, // JDK 7 GA
 52   JMM_VERSION_1_2_2 = 0x20010202,
<span class="line-modified"> 53   JMM_VERSION_2   = 0x20020000, // JDK 10</span>
<span class="line-modified"> 54   JMM_VERSION_3   = 0x20030000, // JDK 14</span>
<span class="line-added"> 55   JMM_VERSION     = JMM_VERSION_3</span>
 56 };
 57 
 58 typedef struct {
 59   unsigned int isLowMemoryDetectionSupported : 1;
 60   unsigned int isCompilationTimeMonitoringSupported : 1;
 61   unsigned int isThreadContentionMonitoringSupported : 1;
 62   unsigned int isCurrentThreadCpuTimeSupported : 1;
 63   unsigned int isOtherThreadCpuTimeSupported : 1;
 64   unsigned int isObjectMonitorUsageSupported : 1;
 65   unsigned int isSynchronizerUsageSupported : 1;
 66   unsigned int isThreadAllocatedMemorySupported : 1;
 67   unsigned int isRemoteDiagnosticCommandsSupported : 1;
 68   unsigned int : 22;
 69 } jmmOptionalSupport;
 70 
 71 typedef enum {
 72   JMM_CLASS_LOADED_COUNT             = 1,    /* Total number of loaded classes */
 73   JMM_CLASS_UNLOADED_COUNT           = 2,    /* Total number of unloaded classes */
 74   JMM_THREAD_TOTAL_COUNT             = 3,    /* Total number of threads that have been started */
 75   JMM_THREAD_LIVE_COUNT              = 4,    /* Current number of live threads */
</pre>
<hr />
<pre>
223   void*        reserved1;
224   void*        reserved2;
225 
226   jint         (JNICALL *GetVersion)             (JNIEnv *env);
227 
228   jint         (JNICALL *GetOptionalSupport)     (JNIEnv *env,
229                                                   jmmOptionalSupport* support_ptr);
230 
231   jint         (JNICALL *GetThreadInfo)          (JNIEnv *env,
232                                                   jlongArray ids,
233                                                   jint maxDepth,
234                                                   jobjectArray infoArray);
235 
236   jobjectArray (JNICALL *GetMemoryPools)         (JNIEnv* env, jobject mgr);
237 
238   jobjectArray (JNICALL *GetMemoryManagers)      (JNIEnv* env, jobject pool);
239 
240   jobject      (JNICALL *GetMemoryPoolUsage)     (JNIEnv* env, jobject pool);
241   jobject      (JNICALL *GetPeakMemoryPoolUsage) (JNIEnv* env, jobject pool);
242 
<span class="line-added">243   jlong        (JNICALL *GetOneThreadAllocatedMemory)</span>
<span class="line-added">244                                                  (JNIEnv *env,</span>
<span class="line-added">245                                                   jlong thread_id);</span>
246   void         (JNICALL *GetThreadAllocatedMemory)
247                                                  (JNIEnv *env,
248                                                   jlongArray ids,
249                                                   jlongArray sizeArray);
250 
251   jobject      (JNICALL *GetMemoryUsage)         (JNIEnv* env, jboolean heap);
252 
253   jlong        (JNICALL *GetLongAttribute)       (JNIEnv *env, jobject obj, jmmLongAttribute att);
254   jboolean     (JNICALL *GetBoolAttribute)       (JNIEnv *env, jmmBoolAttribute att);
255   jboolean     (JNICALL *SetBoolAttribute)       (JNIEnv *env, jmmBoolAttribute att, jboolean flag);
256 
257   jint         (JNICALL *GetLongAttributes)      (JNIEnv *env,
258                                                   jobject obj,
259                                                   jmmLongAttribute* atts,
260                                                   jint count,
261                                                   jlong* result);
262 
263   jobjectArray (JNICALL *FindCircularBlockedThreads) (JNIEnv *env);
264 
265   // Not used in JDK 6 or JDK 7
</pre>
</td>
</tr>
</table>
<center><a href="cds.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="jvm.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>