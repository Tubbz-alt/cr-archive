<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/include/cds.h</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../gc/z/z_globals.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="jmm.h.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/include/cds.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2018, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -31,28 +31,33 @@</span>
  // We should use only standard C types. Do not use custom types such as bool, intx,
  // etc, to avoid introducing unnecessary dependencies to other HotSpot type declarations.
  //
  // Also, this is a C header file. Do not use C++ here.
  
<span class="udiff-line-modified-removed">- #define NUM_CDS_REGIONS 9</span>
<span class="udiff-line-modified-added">+ #define NUM_CDS_REGIONS 8 // this must be the same as MetaspaceShared::n_regions</span>
  #define CDS_ARCHIVE_MAGIC 0xf00baba2
<span class="udiff-line-modified-removed">- #define CURRENT_CDS_ARCHIVE_VERSION 5</span>
<span class="udiff-line-modified-added">+ #define CDS_DYNAMIC_ARCHIVE_MAGIC 0xf00baba8</span>
<span class="udiff-line-added">+ #define CURRENT_CDS_ARCHIVE_VERSION 10</span>
  #define INVALID_CDS_ARCHIVE_VERSION -1
  
  struct CDSFileMapRegion {
<span class="udiff-line-modified-removed">-   int        _crc;           // crc checksum of the current space</span>
<span class="udiff-line-modified-removed">-   size_t     _file_offset;   // sizeof(this) rounded to vm page size</span>
<span class="udiff-line-modified-removed">-   union {</span>
<span class="udiff-line-modified-removed">-     char*    _base;          // copy-on-write base address</span>
<span class="udiff-line-modified-removed">-     size_t   _offset;        // offset from the compressed oop encoding base, only used</span>
<span class="udiff-line-modified-removed">-                              // by archive heap space</span>
<span class="udiff-line-modified-removed">-   } _addr;</span>
<span class="udiff-line-modified-removed">-   size_t     _used;          // for setting space top on read</span>
<span class="udiff-line-modified-removed">-   int        _read_only;     // read only space?</span>
<span class="udiff-line-modified-removed">-   int        _allow_exec;    // executable code in space?</span>
<span class="udiff-line-modified-removed">-   void*      _oopmap;        // bitmap for relocating embedded oops</span>
<span class="udiff-line-modified-removed">-   size_t     _oopmap_size_in_bits;</span>
<span class="udiff-line-modified-added">+   int     _crc;               // CRC checksum of this region.</span>
<span class="udiff-line-modified-added">+   int     _read_only;         // read only region?</span>
<span class="udiff-line-modified-added">+   int     _allow_exec;        // executable code in this region?</span>
<span class="udiff-line-modified-added">+   int     _is_heap_region;    // Used by SA and debug build.</span>
<span class="udiff-line-modified-added">+   int     _is_bitmap_region;  // Relocation bitmap for RO/RW/MC/MD regions (used by SA and debug build).</span>
<span class="udiff-line-modified-added">+   int     _mapped_from_file;  // Is this region mapped from a file?</span>
<span class="udiff-line-modified-added">+                               // If false, this region was initialized using os::read().</span>
<span class="udiff-line-modified-added">+   size_t  _file_offset;       // Data for this region starts at this offset in the archive file.</span>
<span class="udiff-line-modified-added">+   size_t  _mapping_offset;    // This region should be mapped at this offset from the base address</span>
<span class="udiff-line-modified-added">+                               // - for non-heap regions, the base address is SharedBaseAddress</span>
<span class="udiff-line-modified-added">+                               // - for heap regions, the base address is the compressed oop encoding base</span>
<span class="udiff-line-modified-added">+   size_t  _used;              // Number of bytes actually used by this region (excluding padding bytes added</span>
<span class="udiff-line-added">+                               // for alignment purposed.</span>
<span class="udiff-line-added">+   size_t  _oopmap_offset;     // Bitmap for relocating embedded oops (offset from SharedBaseAddress).</span>
<span class="udiff-line-added">+   size_t  _oopmap_size_in_bits;</span>
<span class="udiff-line-added">+   char*   _mapped_base;       // Actually mapped address (NULL if this region is not mapped).</span>
  };
  
  struct CDSFileMapHeaderBase {
    unsigned int _magic;           // identify file type
    int          _crc;             // header crc checksum
</pre>
<center><a href="../gc/z/z_globals.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="jmm.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>