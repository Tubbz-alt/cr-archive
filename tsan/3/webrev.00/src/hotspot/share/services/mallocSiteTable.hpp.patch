diff a/src/hotspot/share/services/mallocSiteTable.hpp b/src/hotspot/share/services/mallocSiteTable.hpp
--- a/src/hotspot/share/services/mallocSiteTable.hpp
+++ b/src/hotspot/share/services/mallocSiteTable.hpp
@@ -23,10 +23,12 @@
  */
 
 #ifndef SHARE_SERVICES_MALLOCSITETABLE_HPP
 #define SHARE_SERVICES_MALLOCSITETABLE_HPP
 
+#include "utilities/macros.hpp"
+
 #if INCLUDE_NMT
 
 #include "memory/allocation.hpp"
 #include "runtime/atomic.hpp"
 #include "services/allocationSite.hpp"
@@ -151,11 +153,11 @@
       }
     }
     // Acquire shared lock.
     // Return true if shared access is granted.
     inline bool sharedLock() {
-      jint res = Atomic::add(1, _lock);
+      jint res = Atomic::add(_lock, 1);
       if (res < 0) {
         Atomic::dec(_lock);
         return false;
       }
       _lock_state = SharedLock;
