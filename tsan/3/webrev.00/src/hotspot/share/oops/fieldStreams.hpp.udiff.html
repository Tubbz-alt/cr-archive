<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/oops/fieldStreams.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="fieldInfo.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="generateOopMap.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/oops/fieldStreams.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2011, 2019, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2011, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -45,11 +45,10 @@</span>
    int                 _limit;
    int                 _generic_signature_slot;
    fieldDescriptor     _fd_buf;
  
    FieldInfo* field() const { return FieldInfo::from_field_array(_fields, _index); }
<span class="udiff-line-removed">-   InstanceKlass* field_holder() const { return _constants-&gt;pool_holder(); }</span>
  
    int init_generic_signature_start_slot() {
      int length = _fields-&gt;length();
      int num_fields = _index;
      int skipped_generic_signature_slots = 0;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -77,41 +76,19 @@</span>
      _generic_signature_slot = length + skipped_generic_signature_slots;
      assert(_generic_signature_slot &lt;= _fields-&gt;length(), &quot;&quot;);
      return num_fields;
    }
  
<span class="udiff-line-modified-removed">-   FieldStreamBase(Array&lt;u2&gt;* fields, const constantPoolHandle&amp; constants, int start, int limit) {</span>
<span class="udiff-line-removed">-     _fields = fields;</span>
<span class="udiff-line-removed">-     _constants = constants;</span>
<span class="udiff-line-removed">-     _index = start;</span>
<span class="udiff-line-removed">-     int num_fields = init_generic_signature_start_slot();</span>
<span class="udiff-line-removed">-     if (limit &lt; start) {</span>
<span class="udiff-line-removed">-       _limit = num_fields;</span>
<span class="udiff-line-removed">-     } else {</span>
<span class="udiff-line-removed">-       _limit = limit;</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">-   }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-   FieldStreamBase(Array&lt;u2&gt;* fields, const constantPoolHandle&amp; constants) {</span>
<span class="udiff-line-removed">-     _fields = fields;</span>
<span class="udiff-line-removed">-     _constants = constants;</span>
<span class="udiff-line-removed">-     _index = 0;</span>
<span class="udiff-line-removed">-     _limit = init_generic_signature_start_slot();</span>
<span class="udiff-line-removed">-   }</span>
<span class="udiff-line-modified-added">+   inline FieldStreamBase(Array&lt;u2&gt;* fields, ConstantPool* constants, int start, int limit);</span>
  
<span class="udiff-line-added">+   inline FieldStreamBase(Array&lt;u2&gt;* fields, ConstantPool* constants);</span>
   public:
<span class="udiff-line-modified-removed">-   FieldStreamBase(InstanceKlass* klass) {</span>
<span class="udiff-line-removed">-     _fields = klass-&gt;fields();</span>
<span class="udiff-line-removed">-     _constants = klass-&gt;constants();</span>
<span class="udiff-line-removed">-     _index = 0;</span>
<span class="udiff-line-removed">-     _limit = klass-&gt;java_fields_count();</span>
<span class="udiff-line-removed">-     init_generic_signature_start_slot();</span>
<span class="udiff-line-removed">-     assert(klass == field_holder(), &quot;&quot;);</span>
<span class="udiff-line-removed">-   }</span>
<span class="udiff-line-modified-added">+   inline FieldStreamBase(InstanceKlass* klass);</span>
  
    // accessors
    int index() const                 { return _index; }
<span class="udiff-line-added">+   InstanceKlass* field_holder() const { return _constants-&gt;pool_holder(); }</span>
  
    void next() {
      if (access_flags().field_has_generic_signature()) {
        _generic_signature_slot ++;
        assert(_generic_signature_slot &lt;= _fields-&gt;length(), &quot;&quot;);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -134,15 +111,15 @@</span>
    void set_access_flags(AccessFlags flags) const {
      set_access_flags(flags.as_short());
    }
  
    Symbol* name() const {
<span class="udiff-line-modified-removed">-     return field()-&gt;name(_constants);</span>
<span class="udiff-line-modified-added">+     return field()-&gt;name(_constants());</span>
    }
  
    Symbol* signature() const {
<span class="udiff-line-modified-removed">-     return field()-&gt;signature(_constants);</span>
<span class="udiff-line-modified-added">+     return field()-&gt;signature(_constants());</span>
    }
  
    Symbol* generic_signature() const {
      if (access_flags().field_has_generic_signature()) {
        assert(_generic_signature_slot &lt; _fields-&gt;length(), &quot;out of bounds&quot;);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -240,10 +217,10 @@</span>
  };
  
  
  class AllFieldStream : public FieldStreamBase {
   public:
<span class="udiff-line-modified-removed">-   AllFieldStream(Array&lt;u2&gt;* fields, const constantPoolHandle&amp; constants): FieldStreamBase(fields, constants) {}</span>
<span class="udiff-line-modified-added">+   AllFieldStream(Array&lt;u2&gt;* fields, ConstantPool* constants): FieldStreamBase(fields, constants) {}</span>
    AllFieldStream(InstanceKlass* k):      FieldStreamBase(k-&gt;fields(), k-&gt;constants()) {}
  };
  
  #endif // SHARE_OOPS_FIELDSTREAMS_HPP
</pre>
<center><a href="fieldInfo.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="generateOopMap.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>