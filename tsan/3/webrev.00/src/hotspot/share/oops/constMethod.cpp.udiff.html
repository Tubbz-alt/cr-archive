<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/oops/constMethod.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="compressedOops.inline.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="constMethod.hpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/oops/constMethod.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2003, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -22,11 +22,10 @@</span>
   *
   */
  
  #include &quot;precompiled.hpp&quot;
  #include &quot;interpreter/interpreter.hpp&quot;
<span class="udiff-line-removed">- #include &quot;memory/heapInspection.hpp&quot;</span>
  #include &quot;memory/metadataFactory.hpp&quot;
  #include &quot;memory/metaspaceClosure.hpp&quot;
  #include &quot;memory/resourceArea.hpp&quot;
  #include &quot;oops/constMethod.hpp&quot;
  #include &quot;oops/method.hpp&quot;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -66,11 +65,11 @@</span>
    set_constants(NULL);
    set_max_stack(0);
    set_max_locals(0);
    set_method_idnum(0);
    set_size_of_parameters(0);
<span class="udiff-line-modified-removed">-   set_result_type(T_VOID);</span>
<span class="udiff-line-modified-added">+   set_result_type((BasicType)0);</span>
  }
  
  // Accessor that copies to metadata.
  void ConstMethod::copy_stackmap_data(ClassLoaderData* loader_data,
                                       u1* sd, int length, TRAPS) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -418,10 +417,12 @@</span>
        it-&gt;push(type_annotations_addr());
    }
    if (has_default_annotations()) {
        it-&gt;push(default_annotations_addr());
    }
<span class="udiff-line-added">+   ConstMethod* this_ptr = this;</span>
<span class="udiff-line-added">+   it-&gt;push_method_entry(&amp;this_ptr, (intptr_t*)&amp;_adapter_trampoline);</span>
  }
  
  // Printing
  
  void ConstMethod::print_on(outputStream* st) const {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -450,40 +451,10 @@</span>
    } else {
      st-&gt;print(&quot;NULL&quot;);
    }
  }
  
<span class="udiff-line-removed">- #if INCLUDE_SERVICES</span>
<span class="udiff-line-removed">- // Size Statistics</span>
<span class="udiff-line-removed">- void ConstMethod::collect_statistics(KlassSizeStats *sz) const {</span>
<span class="udiff-line-removed">-   int n1, n2, n3;</span>
<span class="udiff-line-removed">-   sz-&gt;_const_method_bytes += (n1 = sz-&gt;count(this));</span>
<span class="udiff-line-removed">-   sz-&gt;_bytecode_bytes     += (n2 = code_size());</span>
<span class="udiff-line-removed">-   sz-&gt;_stackmap_bytes     += (n3 = sz-&gt;count_array(stackmap_data()));</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-   // Count method annotations</span>
<span class="udiff-line-removed">-   int a1 = 0, a2 = 0, a3 = 0, a4 = 0;</span>
<span class="udiff-line-removed">-   if (has_method_annotations()) {</span>
<span class="udiff-line-removed">-     sz-&gt;_methods_annotations_bytes += (a1 = sz-&gt;count_array(method_annotations()));</span>
<span class="udiff-line-removed">-   }</span>
<span class="udiff-line-removed">-   if (has_parameter_annotations()) {</span>
<span class="udiff-line-removed">-     sz-&gt;_methods_parameter_annotations_bytes += (a2 = sz-&gt;count_array(parameter_annotations()));</span>
<span class="udiff-line-removed">-   }</span>
<span class="udiff-line-removed">-   if (has_type_annotations()) {</span>
<span class="udiff-line-removed">-     sz-&gt;_methods_type_annotations_bytes += (a3 = sz-&gt;count_array(type_annotations()));</span>
<span class="udiff-line-removed">-   }</span>
<span class="udiff-line-removed">-   if (has_default_annotations()) {</span>
<span class="udiff-line-removed">-     sz-&gt;_methods_default_annotations_bytes += (a4 = sz-&gt;count_array(default_annotations()));</span>
<span class="udiff-line-removed">-   }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-   int size_annotations = a1 + a2 + a3 + a4;</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-   sz-&gt;_method_all_bytes += n1 + n3 + size_annotations; // note: n2 is part of n3</span>
<span class="udiff-line-removed">-   sz-&gt;_ro_bytes += n1 + n3 + size_annotations;</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- #endif // INCLUDE_SERVICES</span>
<span class="udiff-line-removed">- </span>
  // Verification
  
  void ConstMethod::verify_on(outputStream* st) {
    // Verification can occur during oop construction before the method or
    // other fields have been initialized.
</pre>
<center><a href="compressedOops.inline.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="constMethod.hpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>