diff a/src/hotspot/share/gc/z/zNMethodData.hpp b/src/hotspot/share/gc/z/zNMethodData.hpp
--- a/src/hotspot/share/gc/z/zNMethodData.hpp
+++ b/src/hotspot/share/gc/z/zNMethodData.hpp
@@ -19,27 +19,28 @@
  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  * or visit www.oracle.com if you need additional information or have any
  * questions.
  */
 
+#ifndef SHARE_GC_Z_ZNMETHODDATA_HPP
+#define SHARE_GC_Z_ZNMETHODDATA_HPP
+
+#include "gc/z/zAttachedArray.hpp"
 #include "gc/z/zLock.hpp"
 #include "memory/allocation.hpp"
 #include "oops/oopsHierarchy.hpp"
 #include "utilities/globalDefinitions.hpp"
 
-#ifndef SHARE_GC_Z_ZNMETHODDATA_HPP
-#define SHARE_GC_Z_ZNMETHODDATA_HPP
-
 class nmethod;
 template <typename T> class GrowableArray;
 
 class ZNMethodDataOops {
 private:
-  const size_t _nimmediates;
-  bool         _has_non_immediates;
+  typedef ZAttachedArray<ZNMethodDataOops, oop*> AttachedArray;
 
-  static size_t header_size();
+  const AttachedArray _immediates;
+  const bool          _has_non_immediates;
 
   ZNMethodDataOops(const GrowableArray<oop*>& immediates, bool has_non_immediates);
 
 public:
   static ZNMethodDataOops* create(const GrowableArray<oop*>& immediates, bool has_non_immediates);
