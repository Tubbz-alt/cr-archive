<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/gc/z/vmStructs_z.hpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="c2/zBarrierSetC2.hpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="zAddress.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/z/vmStructs_z.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 22,15 ***</span>
   */
  
  #ifndef SHARE_GC_Z_VMSTRUCTS_Z_HPP
  #define SHARE_GC_Z_VMSTRUCTS_Z_HPP
  
  #include &quot;gc/z/zCollectedHeap.hpp&quot;
  #include &quot;gc/z/zGranuleMap.hpp&quot;
  #include &quot;gc/z/zHeap.hpp&quot;
  #include &quot;gc/z/zPageAllocator.hpp&quot;
<span class="line-removed">- #include &quot;gc/z/zPhysicalMemory.hpp&quot;</span>
  #include &quot;utilities/macros.hpp&quot;
  
  // Expose some ZGC globals to the SA agent.
  class ZGlobalsForVMStructs {
    static ZGlobalsForVMStructs _instance;
<span class="line-new-header">--- 22,16 ---</span>
   */
  
  #ifndef SHARE_GC_Z_VMSTRUCTS_Z_HPP
  #define SHARE_GC_Z_VMSTRUCTS_Z_HPP
  
<span class="line-added">+ #include &quot;gc/z/zAttachedArray.hpp&quot;</span>
  #include &quot;gc/z/zCollectedHeap.hpp&quot;
<span class="line-added">+ #include &quot;gc/z/zForwarding.hpp&quot;</span>
  #include &quot;gc/z/zGranuleMap.hpp&quot;
  #include &quot;gc/z/zHeap.hpp&quot;
  #include &quot;gc/z/zPageAllocator.hpp&quot;
  #include &quot;utilities/macros.hpp&quot;
  
  // Expose some ZGC globals to the SA agent.
  class ZGlobalsForVMStructs {
    static ZGlobalsForVMStructs _instance;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 50,11 ***</span>
  
    const int* _ZObjectAlignmentSmallShift;
    const int* _ZObjectAlignmentSmall;
  };
  
<span class="line-modified">! typedef ZGranuleMap&lt;ZPageTableEntry&gt; ZGranuleMapForPageTable;</span>
  
  #define VM_STRUCTS_ZGC(nonstatic_field, volatile_nonstatic_field, static_field)                      \
    static_field(ZGlobalsForVMStructs,            _instance_p,          ZGlobalsForVMStructs*)         \
    nonstatic_field(ZGlobalsForVMStructs,         _ZGlobalPhase,        uint32_t*)                     \
    nonstatic_field(ZGlobalsForVMStructs,         _ZGlobalSeqNum,       uint32_t*)                     \
<span class="line-new-header">--- 51,12 ---</span>
  
    const int* _ZObjectAlignmentSmallShift;
    const int* _ZObjectAlignmentSmall;
  };
  
<span class="line-modified">! typedef ZGranuleMap&lt;ZPage*&gt; ZGranuleMapForPageTable;</span>
<span class="line-added">+ typedef ZAttachedArray&lt;ZForwarding, ZForwardingEntry&gt; ZAttachedArrayForForwarding;</span>
  
  #define VM_STRUCTS_ZGC(nonstatic_field, volatile_nonstatic_field, static_field)                      \
    static_field(ZGlobalsForVMStructs,            _instance_p,          ZGlobalsForVMStructs*)         \
    nonstatic_field(ZGlobalsForVMStructs,         _ZGlobalPhase,        uint32_t*)                     \
    nonstatic_field(ZGlobalsForVMStructs,         _ZGlobalSeqNum,       uint32_t*)                     \
</pre>
<hr />
<pre>
<span class="line-old-header">*** 65,34 ***</span>
    nonstatic_field(ZGlobalsForVMStructs,         _ZObjectAlignmentSmall, const int*)                  \
                                                                                                       \
    nonstatic_field(ZCollectedHeap,               _heap,                ZHeap)                         \
                                                                                                       \
    nonstatic_field(ZHeap,                        _page_allocator,      ZPageAllocator)                \
<span class="line-modified">!   nonstatic_field(ZHeap,                        _pagetable,           ZPageTable)                    \</span>
                                                                                                       \
    nonstatic_field(ZPage,                        _type,                const uint8_t)                 \
    nonstatic_field(ZPage,                        _seqnum,              uint32_t)                      \
    nonstatic_field(ZPage,                        _virtual,             const ZVirtualMemory)          \
    volatile_nonstatic_field(ZPage,               _top,                 uintptr_t)                     \
<span class="line-removed">-   volatile_nonstatic_field(ZPage,               _refcount,            uint32_t)                      \</span>
<span class="line-removed">-   nonstatic_field(ZPage,                        _forwarding,          ZForwardingTable)              \</span>
                                                                                                       \
<span class="line-modified">!   nonstatic_field(ZPageAllocator,               _physical,            ZPhysicalMemoryManager)        \</span>
    nonstatic_field(ZPageAllocator,               _used,                size_t)                        \
                                                                                                       \
    nonstatic_field(ZPageTable,                   _map,                 ZGranuleMapForPageTable)       \
                                                                                                       \
<span class="line-modified">!   nonstatic_field(ZGranuleMapForPageTable,      _map,                 ZPageTableEntry* const)        \</span>
                                                                                                       \
<span class="line-modified">!   nonstatic_field(ZVirtualMemory,               _start,               uintptr_t)                     \</span>
<span class="line-modified">!   nonstatic_field(ZVirtualMemory,               _end,                 uintptr_t)                     \</span>
                                                                                                       \
<span class="line-modified">!   nonstatic_field(ZForwardingTable,             _table,               ZForwardingTableEntry*)        \</span>
<span class="line-removed">-   nonstatic_field(ZForwardingTable,             _size,                size_t)                        \</span>
<span class="line-removed">-                                                                                                      \</span>
<span class="line-removed">-   nonstatic_field(ZPhysicalMemoryManager,       _max_capacity,        const size_t)                  \</span>
<span class="line-removed">-   nonstatic_field(ZPhysicalMemoryManager,       _capacity,            size_t)</span>
  
  #define VM_INT_CONSTANTS_ZGC(declare_constant, declare_constant_with_value)                          \
    declare_constant(ZPhaseRelocate)                                                                   \
    declare_constant(ZPageTypeSmall)                                                                   \
    declare_constant(ZPageTypeMedium)                                                                  \
<span class="line-new-header">--- 67,29 ---</span>
    nonstatic_field(ZGlobalsForVMStructs,         _ZObjectAlignmentSmall, const int*)                  \
                                                                                                       \
    nonstatic_field(ZCollectedHeap,               _heap,                ZHeap)                         \
                                                                                                       \
    nonstatic_field(ZHeap,                        _page_allocator,      ZPageAllocator)                \
<span class="line-modified">!   nonstatic_field(ZHeap,                        _page_table,          ZPageTable)                    \</span>
                                                                                                       \
    nonstatic_field(ZPage,                        _type,                const uint8_t)                 \
    nonstatic_field(ZPage,                        _seqnum,              uint32_t)                      \
    nonstatic_field(ZPage,                        _virtual,             const ZVirtualMemory)          \
    volatile_nonstatic_field(ZPage,               _top,                 uintptr_t)                     \
                                                                                                       \
<span class="line-modified">!   nonstatic_field(ZPageAllocator,               _max_capacity,        const size_t)                  \</span>
<span class="line-added">+   nonstatic_field(ZPageAllocator,               _capacity,            size_t)                        \</span>
    nonstatic_field(ZPageAllocator,               _used,                size_t)                        \
                                                                                                       \
    nonstatic_field(ZPageTable,                   _map,                 ZGranuleMapForPageTable)       \
                                                                                                       \
<span class="line-modified">!   nonstatic_field(ZGranuleMapForPageTable,      _map,                 ZPage** const)                 \</span>
                                                                                                       \
<span class="line-modified">!   nonstatic_field(ZVirtualMemory,               _start,               const uintptr_t)               \</span>
<span class="line-modified">!   nonstatic_field(ZVirtualMemory,               _end,                 const uintptr_t)               \</span>
                                                                                                       \
<span class="line-modified">!   nonstatic_field(ZForwarding,                  _entries,             const ZAttachedArrayForForwarding)</span>
  
  #define VM_INT_CONSTANTS_ZGC(declare_constant, declare_constant_with_value)                          \
    declare_constant(ZPhaseRelocate)                                                                   \
    declare_constant(ZPageTypeSmall)                                                                   \
    declare_constant(ZPageTypeMedium)                                                                  \
</pre>
<hr />
<pre>
<span class="line-old-header">*** 105,23 ***</span>
    declare_constant(ZPageSizeSmallShift)                                                              \
    declare_constant(ZPageSizeMediumShift)                                                             \
    declare_constant(ZAddressOffsetShift)                                                              \
    declare_constant(ZAddressOffsetBits)                                                               \
    declare_constant(ZAddressOffsetMask)                                                               \
<span class="line-modified">!   declare_constant(ZAddressOffsetMax)                                                                \</span>
<span class="line-removed">-   declare_constant(ZAddressSpaceStart)</span>
  
  #define VM_TYPES_ZGC(declare_type, declare_toplevel_type, declare_integer_type)                      \
    declare_toplevel_type(ZGlobalsForVMStructs)                                                        \
    declare_type(ZCollectedHeap, CollectedHeap)                                                        \
    declare_toplevel_type(ZHeap)                                                                       \
    declare_toplevel_type(ZPage)                                                                       \
    declare_toplevel_type(ZPageAllocator)                                                              \
    declare_toplevel_type(ZPageTable)                                                                  \
<span class="line-modified">!   declare_toplevel_type(ZPageTableEntry)                                                             \</span>
    declare_toplevel_type(ZGranuleMapForPageTable)                                                     \
    declare_toplevel_type(ZVirtualMemory)                                                              \
    declare_toplevel_type(ZForwardingTable)                                                            \
<span class="line-modified">!   declare_toplevel_type(ZForwardingTableEntry)                                                       \</span>
    declare_toplevel_type(ZPhysicalMemoryManager)
  
  #endif // SHARE_GC_Z_VMSTRUCTS_Z_HPP
<span class="line-new-header">--- 102,23 ---</span>
    declare_constant(ZPageSizeSmallShift)                                                              \
    declare_constant(ZPageSizeMediumShift)                                                             \
    declare_constant(ZAddressOffsetShift)                                                              \
    declare_constant(ZAddressOffsetBits)                                                               \
    declare_constant(ZAddressOffsetMask)                                                               \
<span class="line-modified">!   declare_constant(ZAddressOffsetMax)</span>
  
  #define VM_TYPES_ZGC(declare_type, declare_toplevel_type, declare_integer_type)                      \
    declare_toplevel_type(ZGlobalsForVMStructs)                                                        \
    declare_type(ZCollectedHeap, CollectedHeap)                                                        \
    declare_toplevel_type(ZHeap)                                                                       \
    declare_toplevel_type(ZPage)                                                                       \
    declare_toplevel_type(ZPageAllocator)                                                              \
    declare_toplevel_type(ZPageTable)                                                                  \
<span class="line-modified">!   declare_toplevel_type(ZAttachedArrayForForwarding)                                                 \</span>
    declare_toplevel_type(ZGranuleMapForPageTable)                                                     \
    declare_toplevel_type(ZVirtualMemory)                                                              \
    declare_toplevel_type(ZForwardingTable)                                                            \
<span class="line-modified">!   declare_toplevel_type(ZForwarding)                                                                 \</span>
<span class="line-added">+   declare_toplevel_type(ZForwardingEntry)                                                            \</span>
    declare_toplevel_type(ZPhysicalMemoryManager)
  
  #endif // SHARE_GC_Z_VMSTRUCTS_Z_HPP
</pre>
<center><a href="c2/zBarrierSetC2.hpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="zAddress.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>