<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/gc/z/zThreadLocalData.hpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="zThreadLocalAllocBuffer.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="zTracer.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/z/zThreadLocalData.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 32,14 ***</span>
  
  class ZThreadLocalData {
  private:
    uintptr_t              _address_bad_mask;
    ZMarkThreadLocalStacks _stacks;
  
    ZThreadLocalData() :
        _address_bad_mask(0),
<span class="line-modified">!       _stacks() {}</span>
  
    static ZThreadLocalData* data(Thread* thread) {
      return thread-&gt;gc_data&lt;ZThreadLocalData&gt;();
    }
  
<span class="line-new-header">--- 32,16 ---</span>
  
  class ZThreadLocalData {
  private:
    uintptr_t              _address_bad_mask;
    ZMarkThreadLocalStacks _stacks;
<span class="line-added">+   oop*                   _invisible_root;</span>
  
    ZThreadLocalData() :
        _address_bad_mask(0),
<span class="line-modified">!       _stacks(),</span>
<span class="line-added">+       _invisible_root(NULL) {}</span>
  
    static ZThreadLocalData* data(Thread* thread) {
      return thread-&gt;gc_data&lt;ZThreadLocalData&gt;();
    }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 58,10 ***</span>
<span class="line-new-header">--- 60,27 ---</span>
  
    static ZMarkThreadLocalStacks* stacks(Thread* thread) {
      return &amp;data(thread)-&gt;_stacks;
    }
  
<span class="line-added">+   static void set_invisible_root(Thread* thread, oop* root) {</span>
<span class="line-added">+     assert(data(thread)-&gt;_invisible_root == NULL, &quot;Already set&quot;);</span>
<span class="line-added">+     data(thread)-&gt;_invisible_root = root;</span>
<span class="line-added">+   }</span>
<span class="line-added">+ </span>
<span class="line-added">+   static void clear_invisible_root(Thread* thread) {</span>
<span class="line-added">+     assert(data(thread)-&gt;_invisible_root != NULL, &quot;Should be set&quot;);</span>
<span class="line-added">+     data(thread)-&gt;_invisible_root = NULL;</span>
<span class="line-added">+   }</span>
<span class="line-added">+ </span>
<span class="line-added">+   template &lt;typename T&gt;</span>
<span class="line-added">+   static void do_invisible_root(Thread* thread, T f) {</span>
<span class="line-added">+     if (data(thread)-&gt;_invisible_root != NULL) {</span>
<span class="line-added">+       f(data(thread)-&gt;_invisible_root);</span>
<span class="line-added">+     }</span>
<span class="line-added">+   }</span>
<span class="line-added">+ </span>
    static ByteSize address_bad_mask_offset() {
      return Thread::gc_data_offset() + byte_offset_of(ZThreadLocalData, _address_bad_mask);
    }
  
    static ByteSize nmethod_disarmed_offset() {
</pre>
<center><a href="zThreadLocalAllocBuffer.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="zTracer.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>