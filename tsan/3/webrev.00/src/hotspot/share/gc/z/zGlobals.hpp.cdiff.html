<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/gc/z/zGlobals.hpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="zGlobals.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="zGranuleMap.hpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/z/zGlobals.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 24,14 ***</span>
  #ifndef SHARE_GC_Z_ZGLOBALS_HPP
  #define SHARE_GC_Z_ZGLOBALS_HPP
  
  #include &quot;utilities/globalDefinitions.hpp&quot;
  #include &quot;utilities/macros.hpp&quot;
<span class="line-modified">! #include OS_CPU_HEADER(gc/z/zGlobals)</span>
  
  // Collector name
<span class="line-modified">! const char* const ZGCName                       = &quot;The Z Garbage Collector&quot;;</span>
  
  // Global phase state
  extern uint32_t   ZGlobalPhase;
  const uint32_t    ZPhaseMark                    = 0;
  const uint32_t    ZPhaseMarkCompleted           = 1;
<span class="line-new-header">--- 24,14 ---</span>
  #ifndef SHARE_GC_Z_ZGLOBALS_HPP
  #define SHARE_GC_Z_ZGLOBALS_HPP
  
  #include &quot;utilities/globalDefinitions.hpp&quot;
  #include &quot;utilities/macros.hpp&quot;
<span class="line-modified">! #include CPU_HEADER(gc/z/zGlobals)</span>
  
  // Collector name
<span class="line-modified">! const char* const ZName                         = &quot;The Z Garbage Collector&quot;;</span>
  
  // Global phase state
  extern uint32_t   ZGlobalPhase;
  const uint32_t    ZPhaseMark                    = 0;
  const uint32_t    ZPhaseMarkCompleted           = 1;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 42,69 ***</span>
  
  // Granule shift/size
  const size_t      ZGranuleSizeShift             = ZPlatformGranuleSizeShift;
  const size_t      ZGranuleSize                  = (size_t)1 &lt;&lt; ZGranuleSizeShift;
  
  // Page types
  const uint8_t     ZPageTypeSmall                = 0;
  const uint8_t     ZPageTypeMedium               = 1;
  const uint8_t     ZPageTypeLarge                = 2;
  
  // Page size shifts
  const size_t      ZPageSizeSmallShift           = ZGranuleSizeShift;
<span class="line-modified">! const size_t      ZPageSizeMediumShift          = ZPageSizeSmallShift + 4;</span>
  
  // Page sizes
  const size_t      ZPageSizeSmall                = (size_t)1 &lt;&lt; ZPageSizeSmallShift;
<span class="line-modified">! const size_t      ZPageSizeMedium               = (size_t)1 &lt;&lt; ZPageSizeMediumShift;</span>
  
  // Object size limits
<span class="line-modified">! const size_t      ZObjectSizeLimitSmall         = (ZPageSizeSmall / 8);  // Allow 12.5% waste</span>
<span class="line-modified">! const size_t      ZObjectSizeLimitMedium        = (ZPageSizeMedium / 8); // Allow 12.5% waste</span>
  
  // Object alignment shifts
  extern const int&amp; ZObjectAlignmentSmallShift;
<span class="line-modified">! const int         ZObjectAlignmentMediumShift   = ZPageSizeMediumShift - 13; // 8192 objects per page</span>
<span class="line-modified">! const int         ZObjectAlignmentLargeShift    = ZPageSizeSmallShift;</span>
  
  // Object alignments
  extern const int&amp; ZObjectAlignmentSmall;
<span class="line-modified">! const int         ZObjectAlignmentMedium        = 1 &lt;&lt; ZObjectAlignmentMediumShift;</span>
  const int         ZObjectAlignmentLarge         = 1 &lt;&lt; ZObjectAlignmentLargeShift;
  
<span class="line-removed">- // Pointer part of address</span>
<span class="line-removed">- const uintptr_t   ZAddressOffsetShift           = 0;</span>
<span class="line-removed">- const uintptr_t   ZAddressOffsetBits            = ZPlatformAddressOffsetBits;</span>
<span class="line-removed">- const uintptr_t   ZAddressOffsetMask            = (((uintptr_t)1 &lt;&lt; ZAddressOffsetBits) - 1) &lt;&lt; ZAddressOffsetShift;</span>
<span class="line-removed">- const size_t      ZAddressOffsetMax             = (uintptr_t)1 &lt;&lt; ZAddressOffsetBits;</span>
<span class="line-removed">- </span>
<span class="line-removed">- // Metadata part of address</span>
<span class="line-removed">- const uintptr_t   ZAddressMetadataShift         = ZPlatformAddressMetadataShift;</span>
<span class="line-removed">- const uintptr_t   ZAddressMetadataBits          = 4;</span>
<span class="line-removed">- const uintptr_t   ZAddressMetadataMask          = (((uintptr_t)1 &lt;&lt; ZAddressMetadataBits) - 1) &lt;&lt; ZAddressMetadataShift;</span>
<span class="line-removed">- </span>
<span class="line-removed">- // Metadata types</span>
<span class="line-removed">- const uintptr_t   ZAddressMetadataMarked0       = (uintptr_t)1 &lt;&lt; (ZAddressMetadataShift + 0);</span>
<span class="line-removed">- const uintptr_t   ZAddressMetadataMarked1       = (uintptr_t)1 &lt;&lt; (ZAddressMetadataShift + 1);</span>
<span class="line-removed">- const uintptr_t   ZAddressMetadataRemapped      = (uintptr_t)1 &lt;&lt; (ZAddressMetadataShift + 2);</span>
<span class="line-removed">- const uintptr_t   ZAddressMetadataFinalizable   = (uintptr_t)1 &lt;&lt; (ZAddressMetadataShift + 3);</span>
<span class="line-removed">- </span>
<span class="line-removed">- // Address space start/end/size</span>
<span class="line-removed">- const uintptr_t   ZAddressSpaceStart            = ZPlatformAddressSpaceStart;</span>
<span class="line-removed">- const uintptr_t   ZAddressSpaceSize             = ZPlatformAddressSpaceSize;</span>
<span class="line-removed">- const uintptr_t   ZAddressSpaceEnd              = ZAddressSpaceStart + ZAddressSpaceSize;</span>
<span class="line-removed">- </span>
<span class="line-removed">- // NMethod entry barrier</span>
<span class="line-removed">- const size_t      ZNMethodDisarmedOffset        = ZPlatformNMethodDisarmedOffset;</span>
<span class="line-removed">- </span>
<span class="line-removed">- // Cache line size</span>
<span class="line-removed">- const size_t      ZCacheLineSize                = ZPlatformCacheLineSize;</span>
<span class="line-removed">- </span>
<span class="line-removed">- // Reserved start/end</span>
<span class="line-removed">- uintptr_t ZAddressReservedStart();</span>
<span class="line-removed">- uintptr_t ZAddressReservedEnd();</span>
<span class="line-removed">- </span>
  //
  // Good/Bad mask states
  // --------------------
  //
  //                 GoodMask         BadMask          WeakGoodMask     WeakBadMask
<span class="line-new-header">--- 42,43 ---</span>
  
  // Granule shift/size
  const size_t      ZGranuleSizeShift             = ZPlatformGranuleSizeShift;
  const size_t      ZGranuleSize                  = (size_t)1 &lt;&lt; ZGranuleSizeShift;
  
<span class="line-added">+ // Number of heap views</span>
<span class="line-added">+ const size_t      ZHeapViews                    = ZPlatformHeapViews;</span>
<span class="line-added">+ </span>
<span class="line-added">+ // Virtual memory to physical memory ratio</span>
<span class="line-added">+ const size_t      ZVirtualToPhysicalRatio       = 16; // 16:1</span>
<span class="line-added">+ </span>
  // Page types
  const uint8_t     ZPageTypeSmall                = 0;
  const uint8_t     ZPageTypeMedium               = 1;
  const uint8_t     ZPageTypeLarge                = 2;
  
  // Page size shifts
  const size_t      ZPageSizeSmallShift           = ZGranuleSizeShift;
<span class="line-modified">! extern size_t     ZPageSizeMediumShift;</span>
  
  // Page sizes
  const size_t      ZPageSizeSmall                = (size_t)1 &lt;&lt; ZPageSizeSmallShift;
<span class="line-modified">! extern size_t     ZPageSizeMedium;</span>
  
  // Object size limits
<span class="line-modified">! const size_t      ZObjectSizeLimitSmall         = ZPageSizeSmall / 8; // 12.5% max waste</span>
<span class="line-modified">! extern size_t     ZObjectSizeLimitMedium;</span>
  
  // Object alignment shifts
  extern const int&amp; ZObjectAlignmentSmallShift;
<span class="line-modified">! extern int        ZObjectAlignmentMediumShift;</span>
<span class="line-modified">! const int         ZObjectAlignmentLargeShift    = ZGranuleSizeShift;</span>
  
  // Object alignments
  extern const int&amp; ZObjectAlignmentSmall;
<span class="line-modified">! extern int        ZObjectAlignmentMedium;</span>
  const int         ZObjectAlignmentLarge         = 1 &lt;&lt; ZObjectAlignmentLargeShift;
  
  //
  // Good/Bad mask states
  // --------------------
  //
  //                 GoodMask         BadMask          WeakGoodMask     WeakBadMask
</pre>
<hr />
<pre>
<span class="line-old-header">*** 117,12 ***</span>
  // Good/bad masks
  extern uintptr_t  ZAddressGoodMask;
  extern uintptr_t  ZAddressBadMask;
  extern uintptr_t  ZAddressWeakBadMask;
  
<span class="line-modified">! // Marked state</span>
  extern uintptr_t  ZAddressMetadataMarked;
  
  // Mark stack space
  extern uintptr_t  ZMarkStackSpaceStart;
  const size_t      ZMarkStackSpaceExpandSize     = (size_t)1 &lt;&lt; 25; // 32M
  
<span class="line-new-header">--- 91,34 ---</span>
  // Good/bad masks
  extern uintptr_t  ZAddressGoodMask;
  extern uintptr_t  ZAddressBadMask;
  extern uintptr_t  ZAddressWeakBadMask;
  
<span class="line-modified">! // Pointer part of address</span>
<span class="line-added">+ extern size_t     ZAddressOffsetBits;</span>
<span class="line-added">+ const  size_t     ZAddressOffsetShift           = 0;</span>
<span class="line-added">+ extern uintptr_t  ZAddressOffsetMask;</span>
<span class="line-added">+ extern size_t     ZAddressOffsetMax;</span>
<span class="line-added">+ </span>
<span class="line-added">+ // Metadata part of address</span>
<span class="line-added">+ const size_t      ZAddressMetadataBits          = 4;</span>
<span class="line-added">+ extern size_t     ZAddressMetadataShift;</span>
<span class="line-added">+ extern uintptr_t  ZAddressMetadataMask;</span>
<span class="line-added">+ </span>
<span class="line-added">+ // Metadata types</span>
  extern uintptr_t  ZAddressMetadataMarked;
<span class="line-added">+ extern uintptr_t  ZAddressMetadataMarked0;</span>
<span class="line-added">+ extern uintptr_t  ZAddressMetadataMarked1;</span>
<span class="line-added">+ extern uintptr_t  ZAddressMetadataRemapped;</span>
<span class="line-added">+ extern uintptr_t  ZAddressMetadataFinalizable;</span>
<span class="line-added">+ </span>
<span class="line-added">+ // NMethod entry barrier</span>
<span class="line-added">+ const size_t      ZNMethodDisarmedOffset        = ZPlatformNMethodDisarmedOffset;</span>
<span class="line-added">+ </span>
<span class="line-added">+ // Cache line size</span>
<span class="line-added">+ const size_t      ZCacheLineSize                = ZPlatformCacheLineSize;</span>
<span class="line-added">+ #define           ZCACHE_ALIGNED                ATTRIBUTE_ALIGNED(ZCacheLineSize)</span>
  
  // Mark stack space
  extern uintptr_t  ZMarkStackSpaceStart;
  const size_t      ZMarkStackSpaceExpandSize     = (size_t)1 &lt;&lt; 25; // 32M
  
</pre>
<center><a href="zGlobals.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="zGranuleMap.hpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>