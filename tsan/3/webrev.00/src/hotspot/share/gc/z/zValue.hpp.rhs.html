<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/hotspot/share/gc/z/zValue.hpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
    <script type="text/javascript" src="../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 2015, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 #ifndef SHARE_GC_Z_ZVALUE_HPP
 25 #define SHARE_GC_Z_ZVALUE_HPP
 26 
 27 #include &quot;memory/allocation.hpp&quot;
<a name="2" id="anc2"></a><span class="line-modified"> 28 #include &quot;utilities/globalDefinitions.hpp&quot;</span>
<span class="line-modified"> 29 </span>
<span class="line-modified"> 30 //</span>
<span class="line-modified"> 31 // Storage</span>
<span class="line-modified"> 32 //</span>

 33 
 34 template &lt;typename S&gt;
 35 class ZValueStorage : public AllStatic {
 36 private:
 37   static uintptr_t _top;
 38   static uintptr_t _end;
 39 
 40 public:
 41   static const size_t offset = 4 * K;
 42 
<a name="3" id="anc3"></a><span class="line-modified"> 43   static uintptr_t alloc(size_t size);</span>




















 44 };
 45 
<a name="4" id="anc4"></a>


 46 class ZContendedStorage : public ZValueStorage&lt;ZContendedStorage&gt; {
 47 public:
<a name="5" id="anc5"></a><span class="line-modified"> 48   static size_t alignment();</span>
<span class="line-modified"> 49   static uint32_t count();</span>
<span class="line-modified"> 50   static uint32_t id();</span>








 51 };
 52 
 53 class ZPerCPUStorage : public ZValueStorage&lt;ZPerCPUStorage&gt; {
 54 public:
<a name="6" id="anc6"></a><span class="line-modified"> 55   static size_t alignment();</span>
<span class="line-modified"> 56   static uint32_t count();</span>
<span class="line-modified"> 57   static uint32_t id();</span>








 58 };
 59 
 60 class ZPerNUMAStorage : public ZValueStorage&lt;ZPerNUMAStorage&gt; {
 61 public:
<a name="7" id="anc7"></a><span class="line-modified"> 62   static size_t alignment();</span>
<span class="line-modified"> 63   static uint32_t count();</span>
<span class="line-modified"> 64   static uint32_t id();</span>








 65 };
 66 
 67 class ZPerWorkerStorage : public ZValueStorage&lt;ZPerWorkerStorage&gt; {
 68 public:
<a name="8" id="anc8"></a><span class="line-modified"> 69   static size_t alignment();</span>
<span class="line-modified"> 70   static uint32_t count();</span>
<span class="line-modified"> 71   static uint32_t id();</span>








 72 };
 73 
<a name="9" id="anc9"></a><span class="line-modified"> 74 //</span>
<span class="line-modified"> 75 // Value</span>
<span class="line-added"> 76 //</span>
 77 
 78 template &lt;typename S, typename T&gt;
 79 class ZValue : public CHeapObj&lt;mtGC&gt; {
 80 private:
 81   const uintptr_t _addr;
 82 
<a name="10" id="anc10"></a><span class="line-modified"> 83   uintptr_t value_addr(uint32_t value_id) const;</span>


 84 
 85 public:
<a name="11" id="anc11"></a><span class="line-modified"> 86   ZValue();</span>
<span class="line-modified"> 87   ZValue(const T&amp; value);</span>
<span class="line-modified"> 88 </span>
<span class="line-modified"> 89   const T* addr(uint32_t value_id = S::id()) const;</span>
<span class="line-modified"> 90   T* addr(uint32_t value_id = S::id());</span>
<span class="line-modified"> 91 </span>
<span class="line-modified"> 92   const T&amp; get(uint32_t value_id = S::id()) const;</span>
<span class="line-modified"> 93   T&amp; get(uint32_t value_id = S::id());</span>
<span class="line-modified"> 94 </span>
<span class="line-modified"> 95   void set(const T&amp; value, uint32_t value_id = S::id());</span>
<span class="line-modified"> 96   void set_all(const T&amp; value);</span>





































 97 };
 98 
 99 template &lt;typename T&gt;
100 class ZContended : public ZValue&lt;ZContendedStorage, T&gt; {
101 public:
<a name="12" id="anc12"></a><span class="line-modified">102   ZContended();</span>
<span class="line-modified">103   ZContended(const T&amp; value);</span>





104 };
105 
106 template &lt;typename T&gt;
107 class ZPerCPU : public ZValue&lt;ZPerCPUStorage, T&gt; {
108 public:
<a name="13" id="anc13"></a><span class="line-modified">109   ZPerCPU();</span>
<span class="line-modified">110   ZPerCPU(const T&amp; value);</span>





111 };
112 
113 template &lt;typename T&gt;
114 class ZPerNUMA : public ZValue&lt;ZPerNUMAStorage, T&gt; {
115 public:
<a name="14" id="anc14"></a><span class="line-modified">116   ZPerNUMA();</span>
<span class="line-modified">117   ZPerNUMA(const T&amp; value);</span>





118 };
119 
120 template &lt;typename T&gt;
121 class ZPerWorker : public ZValue&lt;ZPerWorkerStorage, T&gt; {
122 public:
<a name="15" id="anc15"></a><span class="line-modified">123   ZPerWorker();</span>
<span class="line-modified">124   ZPerWorker(const T&amp; value);</span>





125 };
126 
<a name="16" id="anc16"></a><span class="line-added">127 //</span>
<span class="line-added">128 // Iterator</span>
<span class="line-added">129 //</span>
<span class="line-added">130 </span>
131 template &lt;typename S, typename T&gt;
132 class ZValueIterator {
133 private:
134   ZValue&lt;S, T&gt;* const _value;
135   uint32_t            _value_id;
136 
137 public:
<a name="17" id="anc17"></a><span class="line-modified">138   ZValueIterator(ZValue&lt;S, T&gt;* value);</span>
<span class="line-modified">139 </span>
<span class="line-modified">140   bool next(T** value);</span>








141 };
142 
143 template &lt;typename T&gt;
144 class ZPerCPUIterator : public ZValueIterator&lt;ZPerCPUStorage, T&gt; {
145 public:
<a name="18" id="anc18"></a><span class="line-modified">146   ZPerCPUIterator(ZPerCPU&lt;T&gt;* value);</span>

147 };
148 
149 template &lt;typename T&gt;
150 class ZPerNUMAIterator : public ZValueIterator&lt;ZPerNUMAStorage, T&gt; {
151 public:
<a name="19" id="anc19"></a><span class="line-modified">152   ZPerNUMAIterator(ZPerNUMA&lt;T&gt;* value);</span>

153 };
154 
155 template &lt;typename T&gt;
156 class ZPerWorkerIterator : public ZValueIterator&lt;ZPerWorkerStorage, T&gt; {
157 public:
<a name="20" id="anc20"></a><span class="line-modified">158   ZPerWorkerIterator(ZPerWorker&lt;T&gt;* value);</span>

159 };
160 
161 template &lt;typename S, typename T&gt;
162 class ZValueConstIterator {
163 private:
164   const ZValue&lt;S, T&gt;* const _value;
165   uint32_t                  _value_id;
166 
167 public:
<a name="21" id="anc21"></a><span class="line-modified">168   ZValueConstIterator(const ZValue&lt;S, T&gt;* value);</span>
<span class="line-modified">169 </span>
<span class="line-modified">170   bool next(const T** value);</span>








171 };
172 
173 template &lt;typename T&gt;
174 class ZPerCPUConstIterator : public ZValueConstIterator&lt;ZPerCPUStorage, T&gt; {
175 public:
<a name="22" id="anc22"></a><span class="line-modified">176   ZPerCPUConstIterator(const ZPerCPU&lt;T&gt;* value);</span>

177 };
178 
179 template &lt;typename T&gt;
180 class ZPerNUMAConstIterator : public ZValueConstIterator&lt;ZPerNUMAStorage, T&gt; {
181 public:
<a name="23" id="anc23"></a><span class="line-modified">182   ZPerNUMAConstIterator(const ZPerNUMA&lt;T&gt;* value);</span>

183 };
184 
185 template &lt;typename T&gt;
186 class ZPerWorkerConstIterator : public ZValueConstIterator&lt;ZPerWorkerStorage, T&gt; {
187 public:
<a name="24" id="anc24"></a><span class="line-modified">188   ZPerWorkerConstIterator(const ZPerWorker&lt;T&gt;* value);</span>

189 };
190 
191 #endif // SHARE_GC_Z_ZVALUE_HPP
<a name="25" id="anc25"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="25" type="hidden" />
</body>
</html>