<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/gc/z/zMarkStackEntry.hpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="zMarkStackAllocator.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="zMarkTerminate.hpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/z/zMarkStackEntry.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -33,20 +33,22 @@</span>
  //
  //  Object entry
  //  ------------
  //
  //   6
<span class="udiff-line-modified-removed">- //   3                                                                   2 1 0</span>
<span class="udiff-line-modified-removed">- //  +---------------------------------------------------------------------+-+-+</span>
<span class="udiff-line-modified-removed">- //  |11111111 11111111 11111111 11111111 11111111 11111111 11111111 111111|1|1|</span>
<span class="udiff-line-modified-removed">- //  +---------------------------------------------------------------------+-+-+</span>
<span class="udiff-line-modified-removed">- //  |                                                                     | |</span>
<span class="udiff-line-modified-removed">- //  |                                      1-1 Partial Array Flag (1-bit) * |</span>
<span class="udiff-line-modified-removed">- //  |                                                                       |</span>
<span class="udiff-line-modified-removed">- //  |                                                0-0 Final Flag (1-bit) *</span>
<span class="udiff-line-modified-added">+ //   3                                                                  3 2 1 0</span>
<span class="udiff-line-modified-added">+ //  +--------------------------------------------------------------------+-+-+-+</span>
<span class="udiff-line-modified-added">+ //  |11111111 11111111 11111111 11111111 11111111 11111111 11111111 11111|1|1|1|</span>
<span class="udiff-line-modified-added">+ //  +--------------------------------------------------------------------+-+-+-+</span>
<span class="udiff-line-modified-added">+ //  |                                                                    | | |</span>
<span class="udiff-line-modified-added">+ //  |                                            2-2 Follow Flag (1-bit) * | |</span>
<span class="udiff-line-modified-added">+ //  |                                                                      | |</span>
<span class="udiff-line-modified-added">+ //  |                                       1-1 Partial Array Flag (1-bit) * |</span>
<span class="udiff-line-added">+ //  |                                                                        |</span>
<span class="udiff-line-added">+ //  |                                                 0-0 Final Flag (1-bit) *</span>
  //  |
<span class="udiff-line-modified-removed">- //  * 63-2 Object Address (62-bits)</span>
<span class="udiff-line-modified-added">+ //  * 63-3 Object Address (61-bits)</span>
  //
  //
  //  Partial array entry
  //  -------------------
  //
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -67,11 +69,12 @@</span>
  
  class ZMarkStackEntry  {
  private:
    typedef ZBitField&lt;uint64_t, bool,      0,  1&gt;  field_finalizable;
    typedef ZBitField&lt;uint64_t, bool,      1,  1&gt;  field_partial_array;
<span class="udiff-line-modified-removed">-   typedef ZBitField&lt;uint64_t, uintptr_t, 2,  62&gt; field_object_address;</span>
<span class="udiff-line-modified-added">+   typedef ZBitField&lt;uint64_t, bool,      2,  1&gt;  field_follow;</span>
<span class="udiff-line-added">+   typedef ZBitField&lt;uint64_t, uintptr_t, 3,  61&gt; field_object_address;</span>
    typedef ZBitField&lt;uint64_t, size_t,    2,  30&gt; field_partial_array_length;
    typedef ZBitField&lt;uint64_t, size_t,    32, 32&gt; field_partial_array_offset;
  
    uint64_t _entry;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -81,12 +84,13 @@</span>
      // _entry to allow it to be optimized out when instantiating ZMarkStack,
      // which has a long array of ZMarkStackEntry elements, but doesn&#39;t care
      // what _entry is initialized to.
    }
  
<span class="udiff-line-modified-removed">-   ZMarkStackEntry(uintptr_t object_address, bool finalizable) :</span>
<span class="udiff-line-modified-added">+   ZMarkStackEntry(uintptr_t object_address, bool follow, bool finalizable) :</span>
        _entry(field_object_address::encode(object_address) |
<span class="udiff-line-added">+              field_follow::encode(follow) |</span>
               field_partial_array::encode(false) |
               field_finalizable::encode(finalizable)) {}
  
    ZMarkStackEntry(size_t partial_array_offset, size_t partial_array_length, bool finalizable) :
        _entry(field_partial_array_offset::encode(partial_array_offset) |
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -108,10 +112,14 @@</span>
  
    size_t partial_array_length() const {
      return field_partial_array_length::decode(_entry);
    }
  
<span class="udiff-line-added">+   bool follow() const {</span>
<span class="udiff-line-added">+     return field_follow::decode(_entry);</span>
<span class="udiff-line-added">+   }</span>
<span class="udiff-line-added">+ </span>
    uintptr_t object_address() const {
      return field_object_address::decode(_entry);
    }
  };
  
</pre>
<center><a href="zMarkStackAllocator.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="zMarkTerminate.hpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>