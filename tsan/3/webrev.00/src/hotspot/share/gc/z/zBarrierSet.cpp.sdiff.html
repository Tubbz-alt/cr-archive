<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/gc/z/zBarrierSet.cpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="zBarrier.inline.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="zBarrierSet.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/z/zBarrierSet.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
49   return new ZBarrierSetNMethod();
50 }
51 
52 ZBarrierSet::ZBarrierSet() :
53     BarrierSet(make_barrier_set_assembler&lt;ZBarrierSetAssembler&gt;(),
54                make_barrier_set_c1&lt;ZBarrierSetC1&gt;(),
55                make_barrier_set_c2&lt;ZBarrierSetC2&gt;(),
56                make_barrier_set_nmethod(),
57                BarrierSet::FakeRtti(BarrierSet::ZBarrierSet)) {}
58 
59 ZBarrierSetAssembler* ZBarrierSet::assembler() {
60   BarrierSetAssembler* const bsa = BarrierSet::barrier_set()-&gt;barrier_set_assembler();
61   return reinterpret_cast&lt;ZBarrierSetAssembler*&gt;(bsa);
62 }
63 
64 bool ZBarrierSet::barrier_needed(DecoratorSet decorators, BasicType type) {
65   assert((decorators &amp; AS_RAW) == 0, &quot;Unexpected decorator&quot;);
66   assert((decorators &amp; AS_NO_KEEPALIVE) == 0, &quot;Unexpected decorator&quot;);
67   //assert((decorators &amp; ON_UNKNOWN_OOP_REF) == 0, &quot;Unexpected decorator&quot;);
68 
<span class="line-modified">69   if (type == T_OBJECT || type == T_ARRAY) {</span>
70     assert((decorators &amp; (IN_HEAP | IN_NATIVE)) != 0, &quot;Where is reference?&quot;);
71     // Barrier needed even when IN_NATIVE, to allow concurrent scanning.
72     return true;
73   }
74 
75   // Barrier not needed
76   return false;
77 }
78 
79 void ZBarrierSet::on_thread_create(Thread* thread) {
80   // Create thread local data
81   ZThreadLocalData::create(thread);
82 }
83 
84 void ZBarrierSet::on_thread_destroy(Thread* thread) {
85   // Destroy thread local data
86   ZThreadLocalData::destroy(thread);
87 }
88 
89 void ZBarrierSet::on_thread_attach(Thread* thread) {
</pre>
</td>
<td>
<hr />
<pre>
49   return new ZBarrierSetNMethod();
50 }
51 
52 ZBarrierSet::ZBarrierSet() :
53     BarrierSet(make_barrier_set_assembler&lt;ZBarrierSetAssembler&gt;(),
54                make_barrier_set_c1&lt;ZBarrierSetC1&gt;(),
55                make_barrier_set_c2&lt;ZBarrierSetC2&gt;(),
56                make_barrier_set_nmethod(),
57                BarrierSet::FakeRtti(BarrierSet::ZBarrierSet)) {}
58 
59 ZBarrierSetAssembler* ZBarrierSet::assembler() {
60   BarrierSetAssembler* const bsa = BarrierSet::barrier_set()-&gt;barrier_set_assembler();
61   return reinterpret_cast&lt;ZBarrierSetAssembler*&gt;(bsa);
62 }
63 
64 bool ZBarrierSet::barrier_needed(DecoratorSet decorators, BasicType type) {
65   assert((decorators &amp; AS_RAW) == 0, &quot;Unexpected decorator&quot;);
66   assert((decorators &amp; AS_NO_KEEPALIVE) == 0, &quot;Unexpected decorator&quot;);
67   //assert((decorators &amp; ON_UNKNOWN_OOP_REF) == 0, &quot;Unexpected decorator&quot;);
68 
<span class="line-modified">69   if (is_reference_type(type)) {</span>
70     assert((decorators &amp; (IN_HEAP | IN_NATIVE)) != 0, &quot;Where is reference?&quot;);
71     // Barrier needed even when IN_NATIVE, to allow concurrent scanning.
72     return true;
73   }
74 
75   // Barrier not needed
76   return false;
77 }
78 
79 void ZBarrierSet::on_thread_create(Thread* thread) {
80   // Create thread local data
81   ZThreadLocalData::create(thread);
82 }
83 
84 void ZBarrierSet::on_thread_destroy(Thread* thread) {
85   // Destroy thread local data
86   ZThreadLocalData::destroy(thread);
87 }
88 
89 void ZBarrierSet::on_thread_attach(Thread* thread) {
</pre>
</td>
</tr>
</table>
<center><a href="zBarrier.inline.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="zBarrierSet.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>