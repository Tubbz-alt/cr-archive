<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/gc/shared/genOopClosures.inline.hpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="genOopClosures.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="generation.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/shared/genOopClosures.inline.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -55,26 +55,15 @@</span>
    assert(generation()-&gt;is_in_reserved(p), &quot;expected ref in generation&quot;);
    T heap_oop = RawAccess&lt;&gt;::oop_load(p);
    assert(!CompressedOops::is_null(heap_oop), &quot;expected non-null oop&quot;);
    oop obj = CompressedOops::decode_not_null(heap_oop);
    // If p points to a younger generation, mark the card.
<span class="udiff-line-modified-removed">-   if ((HeapWord*)obj &lt; _gen_boundary) {</span>
<span class="udiff-line-modified-added">+   if (cast_from_oop&lt;HeapWord*&gt;(obj) &lt; _gen_boundary) {</span>
      _rs-&gt;inline_write_ref_field_gc(p, obj);
    }
  }
  
<span class="udiff-line-removed">- template &lt;class T&gt; inline void OopsInGenClosure::par_do_barrier(T* p) {</span>
<span class="udiff-line-removed">-   assert(generation()-&gt;is_in_reserved(p), &quot;expected ref in generation&quot;);</span>
<span class="udiff-line-removed">-   T heap_oop = RawAccess&lt;&gt;::oop_load(p);</span>
<span class="udiff-line-removed">-   assert(!CompressedOops::is_null(heap_oop), &quot;expected non-null oop&quot;);</span>
<span class="udiff-line-removed">-   oop obj = CompressedOops::decode_not_null(heap_oop);</span>
<span class="udiff-line-removed">-   // If p points to a younger generation, mark the card.</span>
<span class="udiff-line-removed">-   if ((HeapWord*)obj &lt; gen_boundary()) {</span>
<span class="udiff-line-removed">-     rs()-&gt;write_ref_field_gc_par(p, obj);</span>
<span class="udiff-line-removed">-   }</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
  inline BasicOopsInGenClosure::BasicOopsInGenClosure(Generation* gen) : OopsInGenClosure(gen) {
  }
  
  inline void OopsInClassLoaderDataOrGenClosure::do_cld_barrier() {
    assert(_scanned_cld != NULL, &quot;Must be&quot;);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -90,11 +79,11 @@</span>
  template &lt;class T&gt; inline void ScanClosure::do_oop_work(T* p) {
    T heap_oop = RawAccess&lt;&gt;::oop_load(p);
    // Should we copy the obj?
    if (!CompressedOops::is_null(heap_oop)) {
      oop obj = CompressedOops::decode_not_null(heap_oop);
<span class="udiff-line-modified-removed">-     if ((HeapWord*)obj &lt; _boundary) {</span>
<span class="udiff-line-modified-added">+     if (cast_from_oop&lt;HeapWord*&gt;(obj) &lt; _boundary) {</span>
        assert(!_g-&gt;to()-&gt;is_in_reserved(obj), &quot;Scanning field twice?&quot;);
        oop new_obj = obj-&gt;is_forwarded() ? obj-&gt;forwardee()
                                          : _g-&gt;copy_to_survivor_space(obj);
        RawAccess&lt;IS_NOT_NULL&gt;::oop_store(p, new_obj);
      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -116,11 +105,11 @@</span>
  template &lt;class T&gt; inline void FastScanClosure::do_oop_work(T* p) {
    T heap_oop = RawAccess&lt;&gt;::oop_load(p);
    // Should we copy the obj?
    if (!CompressedOops::is_null(heap_oop)) {
      oop obj = CompressedOops::decode_not_null(heap_oop);
<span class="udiff-line-modified-removed">-     if ((HeapWord*)obj &lt; _boundary) {</span>
<span class="udiff-line-modified-added">+     if (cast_from_oop&lt;HeapWord*&gt;(obj) &lt; _boundary) {</span>
        assert(!_g-&gt;to()-&gt;is_in_reserved(obj), &quot;Scanning field twice?&quot;);
        oop new_obj = obj-&gt;is_forwarded() ? obj-&gt;forwardee()
                                          : _g-&gt;copy_to_survivor_space(obj);
        RawAccess&lt;IS_NOT_NULL&gt;::oop_store(p, new_obj);
        if (is_scanning_a_cld()) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -140,11 +129,11 @@</span>
  
  template &lt;class T&gt; void FilteringClosure::do_oop_work(T* p) {
    T heap_oop = RawAccess&lt;&gt;::oop_load(p);
    if (!CompressedOops::is_null(heap_oop)) {
      oop obj = CompressedOops::decode_not_null(heap_oop);
<span class="udiff-line-modified-removed">-     if ((HeapWord*)obj &lt; _boundary) {</span>
<span class="udiff-line-modified-added">+     if (cast_from_oop&lt;HeapWord*&gt;(obj) &lt; _boundary) {</span>
        _cl-&gt;do_oop(p);
      }
    }
  }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -157,11 +146,11 @@</span>
  // the barrier set is taken care of outside this closure.
  template &lt;class T&gt; inline void ScanWeakRefClosure::do_oop_work(T* p) {
    oop obj = RawAccess&lt;IS_NOT_NULL&gt;::oop_load(p);
    // weak references are sometimes scanned twice; must check
    // that to-space doesn&#39;t already contain this object
<span class="udiff-line-modified-removed">-   if ((HeapWord*)obj &lt; _boundary &amp;&amp; !_g-&gt;to()-&gt;is_in_reserved(obj)) {</span>
<span class="udiff-line-modified-added">+   if (cast_from_oop&lt;HeapWord*&gt;(obj) &lt; _boundary &amp;&amp; !_g-&gt;to()-&gt;is_in_reserved(obj)) {</span>
      oop new_obj = obj-&gt;is_forwarded() ? obj-&gt;forwardee()
                                        : _g-&gt;copy_to_survivor_space(obj);
      RawAccess&lt;IS_NOT_NULL&gt;::oop_store(p, new_obj);
    }
  }
</pre>
<center><a href="genOopClosures.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="generation.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>