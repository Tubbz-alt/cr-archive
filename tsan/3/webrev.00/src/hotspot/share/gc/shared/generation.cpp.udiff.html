<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/gc/shared/generation.cpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="genOopClosures.inline.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="generation.hpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/shared/generation.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 1997, 2017, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -31,12 +31,13 @@</span>
  #include &quot;gc/shared/gcTrace.hpp&quot;
  #include &quot;gc/shared/genCollectedHeap.hpp&quot;
  #include &quot;gc/shared/genOopClosures.hpp&quot;
  #include &quot;gc/shared/genOopClosures.inline.hpp&quot;
  #include &quot;gc/shared/generation.hpp&quot;
<span class="udiff-line-added">+ #include &quot;gc/shared/generationSpec.hpp&quot;</span>
  #include &quot;gc/shared/space.inline.hpp&quot;
<span class="udiff-line-modified-removed">- #include &quot;gc/shared/spaceDecorator.hpp&quot;</span>
<span class="udiff-line-modified-added">+ #include &quot;gc/shared/spaceDecorator.inline.hpp&quot;</span>
  #include &quot;logging/log.hpp&quot;
  #include &quot;memory/allocation.inline.hpp&quot;
  #include &quot;oops/oop.inline.hpp&quot;
  #include &quot;runtime/java.hpp&quot;
  #include &quot;utilities/copy.hpp&quot;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -76,13 +77,10 @@</span>
  void Generation::ref_processor_init() {
    assert(_ref_processor == NULL, &quot;a reference processor already exists&quot;);
    assert(!_reserved.is_empty(), &quot;empty generation?&quot;);
    _span_based_discoverer.set_span(_reserved);
    _ref_processor = new ReferenceProcessor(&amp;_span_based_discoverer);    // a vanilla reference processor
<span class="udiff-line-removed">-   if (_ref_processor == NULL) {</span>
<span class="udiff-line-removed">-     vm_exit_during_initialization(&quot;Could not allocate ReferenceProcessor object&quot;);</span>
<span class="udiff-line-removed">-   }</span>
  }
  
  void Generation::print() const { print_on(tty); }
  
  void Generation::print_on(outputStream* st)  const {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -166,20 +164,20 @@</span>
    }
  #endif  // #ifndef PRODUCT
  
    HeapWord* result = allocate(obj_size, false);
    if (result != NULL) {
<span class="udiff-line-modified-removed">-     Copy::aligned_disjoint_words((HeapWord*)obj, result, obj_size);</span>
<span class="udiff-line-modified-added">+     Copy::aligned_disjoint_words(cast_from_oop&lt;HeapWord*&gt;(obj), result, obj_size);</span>
      return oop(result);
    } else {
      GenCollectedHeap* gch = GenCollectedHeap::heap();
      return gch-&gt;handle_failed_promotion(this, obj, obj_size);
    }
  }
  
  oop Generation::par_promote(int thread_num,
<span class="udiff-line-modified-removed">-                             oop obj, markOop m, size_t word_sz) {</span>
<span class="udiff-line-modified-added">+                             oop obj, markWord m, size_t word_sz) {</span>
    // Could do a bad general impl here that gets a lock.  But no.
    ShouldNotCallThis();
    return NULL;
  }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -286,25 +284,10 @@</span>
  void Generation::object_iterate(ObjectClosure* cl) {
    GenerationObjIterateClosure blk(cl);
    space_iterate(&amp;blk);
  }
  
<span class="udiff-line-removed">- class GenerationSafeObjIterateClosure : public SpaceClosure {</span>
<span class="udiff-line-removed">-  private:</span>
<span class="udiff-line-removed">-   ObjectClosure* _cl;</span>
<span class="udiff-line-removed">-  public:</span>
<span class="udiff-line-removed">-   virtual void do_space(Space* s) {</span>
<span class="udiff-line-removed">-     s-&gt;safe_object_iterate(_cl);</span>
<span class="udiff-line-removed">-   }</span>
<span class="udiff-line-removed">-   GenerationSafeObjIterateClosure(ObjectClosure* cl) : _cl(cl) {}</span>
<span class="udiff-line-removed">- };</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- void Generation::safe_object_iterate(ObjectClosure* cl) {</span>
<span class="udiff-line-removed">-   GenerationSafeObjIterateClosure blk(cl);</span>
<span class="udiff-line-removed">-   space_iterate(&amp;blk);</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
  #if INCLUDE_SERIALGC
  
  void Generation::prepare_for_compaction(CompactPoint* cp) {
    // Generic implementation, can be specialized
    CompactibleSpace* space = first_compaction_space();
</pre>
<center><a href="genOopClosures.inline.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="generation.hpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>