<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/gc/g1/g1CollectionSetCandidates.cpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="g1CollectionSet.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="g1CollectionSetCandidates.hpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/g1/g1CollectionSetCandidates.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -25,30 +25,16 @@</span>
  #include &quot;precompiled.hpp&quot;
  #include &quot;gc/g1/g1CollectionSetCandidates.hpp&quot;
  #include &quot;gc/g1/g1CollectionSetChooser.hpp&quot;
  #include &quot;gc/g1/heapRegion.inline.hpp&quot;
  
<span class="udiff-line-modified-removed">- HeapRegion* G1CollectionSetCandidates::pop_front() {</span>
<span class="udiff-line-modified-removed">-   assert(_front_idx &lt; _num_regions, &quot;pre-condition&quot;);</span>
<span class="udiff-line-modified-removed">-   HeapRegion* hr = _regions[_front_idx];</span>
<span class="udiff-line-modified-removed">-   assert(hr != NULL, &quot;pre-condition&quot;);</span>
<span class="udiff-line-modified-removed">-   _regions[_front_idx] = NULL;</span>
<span class="udiff-line-modified-removed">-   assert(hr-&gt;reclaimable_bytes() &lt;= _remaining_reclaimable_bytes,</span>
<span class="udiff-line-removed">-          &quot;Remaining reclaimable bytes inconsistent &quot;</span>
<span class="udiff-line-removed">-          &quot;from region: &quot; SIZE_FORMAT &quot; remaining: &quot; SIZE_FORMAT,</span>
<span class="udiff-line-removed">-          hr-&gt;reclaimable_bytes(), _remaining_reclaimable_bytes);</span>
<span class="udiff-line-removed">-   _remaining_reclaimable_bytes -= hr-&gt;reclaimable_bytes();</span>
<span class="udiff-line-removed">-   _front_idx++;</span>
<span class="udiff-line-removed">-   return hr;</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- void G1CollectionSetCandidates::push_front(HeapRegion* hr) {</span>
<span class="udiff-line-removed">-   assert(hr != NULL, &quot;Can&#39;t put back a NULL region&quot;);</span>
<span class="udiff-line-removed">-   assert(_front_idx &gt;= 1, &quot;Too many regions have been put back.&quot;);</span>
<span class="udiff-line-removed">-   _front_idx--;</span>
<span class="udiff-line-removed">-   _regions[_front_idx] = hr;</span>
<span class="udiff-line-removed">-   _remaining_reclaimable_bytes += hr-&gt;reclaimable_bytes();</span>
<span class="udiff-line-modified-added">+ void G1CollectionSetCandidates::remove(uint num_regions) {</span>
<span class="udiff-line-modified-added">+   assert(num_regions &lt;= num_remaining(), &quot;Trying to remove more regions (%u) than available (%u)&quot;, num_regions, num_remaining());</span>
<span class="udiff-line-modified-added">+   for (uint i = 0; i &lt; num_regions; i++) {</span>
<span class="udiff-line-modified-added">+     _remaining_reclaimable_bytes -= at(_front_idx)-&gt;reclaimable_bytes();</span>
<span class="udiff-line-modified-added">+     _front_idx++;</span>
<span class="udiff-line-modified-added">+   }</span>
  }
  
  void G1CollectionSetCandidates::iterate(HeapRegionClosure* cl) {
    for (uint i = _front_idx; i &lt; _num_regions; i++) {
      HeapRegion* r = _regions[i];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -60,17 +46,12 @@</span>
  }
  
  #ifndef PRODUCT
  void G1CollectionSetCandidates::verify() const {
    guarantee(_front_idx &lt;= _num_regions, &quot;Index: %u Num_regions: %u&quot;, _front_idx, _num_regions);
<span class="udiff-line-modified-removed">-   uint idx = 0;</span>
<span class="udiff-line-modified-added">+   uint idx = _front_idx;</span>
    size_t sum_of_reclaimable_bytes = 0;
<span class="udiff-line-removed">-   while (idx &lt; _front_idx) {</span>
<span class="udiff-line-removed">-     guarantee(_regions[idx] == NULL, &quot;All entries before _front_idx %u should be NULL, but %u is not&quot;,</span>
<span class="udiff-line-removed">-               _front_idx, idx);</span>
<span class="udiff-line-removed">-     idx++;</span>
<span class="udiff-line-removed">-   }</span>
    HeapRegion *prev = NULL;
    for (; idx &lt; _num_regions; idx++) {
      HeapRegion *cur = _regions[idx];
      guarantee(cur != NULL, &quot;Regions after _front_idx %u cannot be NULL but %u is&quot;, _front_idx, idx);
      guarantee(G1CollectionSetChooser::should_add(cur), &quot;Region %u should be eligible for addition.&quot;, cur-&gt;hrm_index());
</pre>
<center><a href="g1CollectionSet.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="g1CollectionSetCandidates.hpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>