<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/gc/g1/heapRegionSet.hpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="heapRegionSet.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="heapRegionSet.inline.hpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/g1/heapRegionSet.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -134,36 +134,65 @@</span>
  // sorted list. We should try to avoid doing operations that iterate over
  // such lists in performance critical paths. Typically we should
  // add / remove one region at a time or concatenate two lists.
  
  class FreeRegionListIterator;
<span class="udiff-line-added">+ class G1NUMA;</span>
  
  class FreeRegionList : public HeapRegionSetBase {
    friend class FreeRegionListIterator;
  
  private:
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   // This class is only initialized if there are multiple active nodes.</span>
<span class="udiff-line-added">+   class NodeInfo : public CHeapObj&lt;mtGC&gt; {</span>
<span class="udiff-line-added">+     G1NUMA* _numa;</span>
<span class="udiff-line-added">+     uint*   _length_of_node;</span>
<span class="udiff-line-added">+     uint    _num_nodes;</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   public:</span>
<span class="udiff-line-added">+     NodeInfo();</span>
<span class="udiff-line-added">+     ~NodeInfo();</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     inline void increase_length(uint node_index);</span>
<span class="udiff-line-added">+     inline void decrease_length(uint node_index);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     inline uint length(uint index) const;</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     void clear();</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     void add(NodeInfo* info);</span>
<span class="udiff-line-added">+   };</span>
<span class="udiff-line-added">+ </span>
    HeapRegion* _head;
    HeapRegion* _tail;
  
    // _last is used to keep track of where we added an element the last
    // time. It helps to improve performance when adding several ordered items in a row.
    HeapRegion* _last;
  
<span class="udiff-line-added">+   NodeInfo*   _node_info;</span>
<span class="udiff-line-added">+ </span>
    static uint _unrealistically_long_length;
  
    inline HeapRegion* remove_from_head_impl();
    inline HeapRegion* remove_from_tail_impl();
  
<span class="udiff-line-added">+   inline void increase_length(uint node_index);</span>
<span class="udiff-line-added">+   inline void decrease_length(uint node_index);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   // Common checks for adding a list.</span>
<span class="udiff-line-added">+   void add_list_common_start(FreeRegionList* from_list);</span>
<span class="udiff-line-added">+   void add_list_common_end(FreeRegionList* from_list);</span>
<span class="udiff-line-added">+ </span>
  protected:
    // See the comment for HeapRegionSetBase::clear()
    virtual void clear();
  
  public:
<span class="udiff-line-modified-removed">-   FreeRegionList(const char* name, HeapRegionSetChecker* checker = NULL):</span>
<span class="udiff-line-modified-removed">-     HeapRegionSetBase(name, checker) {</span>
<span class="udiff-line-removed">-     clear();</span>
<span class="udiff-line-removed">-   }</span>
<span class="udiff-line-modified-added">+   FreeRegionList(const char* name, HeapRegionSetChecker* checker = NULL);</span>
<span class="udiff-line-modified-added">+   ~FreeRegionList();</span>
  
    void verify_list();
  
  #ifdef ASSERT
    bool contains(HeapRegion* hr) const {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -175,29 +204,42 @@</span>
  
    // Add hr to the list. The region should not be a member of another set.
    // Assumes that the list is ordered and will preserve that order. The order
    // is determined by hrm_index.
    inline void add_ordered(HeapRegion* hr);
<span class="udiff-line-added">+   // Same restrictions as above, but adds the region last in the list.</span>
<span class="udiff-line-added">+   inline void add_to_tail(HeapRegion* region_to_add);</span>
  
    // Removes from head or tail based on the given argument.
    HeapRegion* remove_region(bool from_head);
  
<span class="udiff-line-added">+   HeapRegion* remove_region_with_node_index(bool from_head,</span>
<span class="udiff-line-added">+                                             uint requested_node_index);</span>
<span class="udiff-line-added">+ </span>
    // Merge two ordered lists. The result is also ordered. The order is
    // determined by hrm_index.
    void add_ordered(FreeRegionList* from_list);
<span class="udiff-line-added">+   void append_ordered(FreeRegionList* from_list);</span>
  
    // It empties the list by removing all regions from it.
    void remove_all();
  
<span class="udiff-line-added">+   // Abandon current free list. Requires that all regions in the current list</span>
<span class="udiff-line-added">+   // are taken care of separately, to allow a rebuild.</span>
<span class="udiff-line-added">+   void abandon();</span>
<span class="udiff-line-added">+ </span>
    // Remove all (contiguous) regions from first to first + num_regions -1 from
    // this list.
    // Num_regions must be &gt; 1.
    void remove_starting_at(HeapRegion* first, uint num_regions);
  
    virtual void verify();
  
    uint num_of_regions_in_range(uint start, uint end) const;
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   using HeapRegionSetBase::length;</span>
<span class="udiff-line-added">+   uint length(uint node_index) const;</span>
  };
  
  // Iterator class that provides a convenient way to iterate over the
  // regions of a FreeRegionList.
  
</pre>
<center><a href="heapRegionSet.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="heapRegionSet.inline.hpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>