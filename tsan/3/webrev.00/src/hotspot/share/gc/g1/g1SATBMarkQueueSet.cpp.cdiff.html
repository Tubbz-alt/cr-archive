<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/gc/g1/g1SATBMarkQueueSet.cpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="g1RootProcessor.hpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="g1SATBMarkQueueSet.hpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/g1/g1SATBMarkQueueSet.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 30,23 ***</span>
  #include &quot;gc/shared/satbMarkQueue.hpp&quot;
  #include &quot;oops/oop.hpp&quot;
  #include &quot;utilities/debug.hpp&quot;
  #include &quot;utilities/globalDefinitions.hpp&quot;
  
<span class="line-modified">! G1SATBMarkQueueSet::G1SATBMarkQueueSet() : _g1h(NULL) {}</span>
<span class="line-modified">! </span>
<span class="line-modified">! void G1SATBMarkQueueSet::initialize(G1CollectedHeap* g1h,</span>
<span class="line-removed">-                                     Monitor* cbl_mon,</span>
<span class="line-removed">-                                     BufferNode::Allocator* allocator,</span>
<span class="line-removed">-                                     size_t process_completed_buffers_threshold,</span>
<span class="line-removed">-                                     uint buffer_enqueue_threshold_percentage) {</span>
<span class="line-removed">-   SATBMarkQueueSet::initialize(cbl_mon,</span>
<span class="line-removed">-                                allocator,</span>
<span class="line-removed">-                                process_completed_buffers_threshold,</span>
<span class="line-removed">-                                buffer_enqueue_threshold_percentage);</span>
<span class="line-removed">-   _g1h = g1h;</span>
<span class="line-removed">- }</span>
  
  void G1SATBMarkQueueSet::handle_zero_index_for_thread(Thread* t) {
    G1ThreadLocalData::satb_mark_queue(t).handle_zero_index();
  }
  
<span class="line-new-header">--- 30,13 ---</span>
  #include &quot;gc/shared/satbMarkQueue.hpp&quot;
  #include &quot;oops/oop.hpp&quot;
  #include &quot;utilities/debug.hpp&quot;
  #include &quot;utilities/globalDefinitions.hpp&quot;
  
<span class="line-modified">! G1SATBMarkQueueSet::G1SATBMarkQueueSet(BufferNode::Allocator* allocator) :</span>
<span class="line-modified">!   SATBMarkQueueSet(allocator)</span>
<span class="line-modified">! {}</span>
  
  void G1SATBMarkQueueSet::handle_zero_index_for_thread(Thread* t) {
    G1ThreadLocalData::satb_mark_queue(t).handle_zero_index();
  }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 112,18 ***</span>
  // Workaround for not yet having std::bind.
  class G1SATBMarkQueueFilterFn {
    G1CollectedHeap* _g1h;
  
  public:
<span class="line-modified">!   G1SATBMarkQueueFilterFn(G1CollectedHeap* g1h) : _g1h(g1h) {}</span>
  
    // Return true if entry should be filtered out (removed), false if
    // it should be retained.
    bool operator()(const void* entry) const {
      return discard_entry(entry, _g1h);
    }
  };
  
  void G1SATBMarkQueueSet::filter(SATBMarkQueue* queue) {
<span class="line-modified">!   assert(_g1h != NULL, &quot;SATB queue set not initialized&quot;);</span>
<span class="line-removed">-   apply_filter(G1SATBMarkQueueFilterFn(_g1h), queue);</span>
  }
<span class="line-new-header">--- 102,17 ---</span>
  // Workaround for not yet having std::bind.
  class G1SATBMarkQueueFilterFn {
    G1CollectedHeap* _g1h;
  
  public:
<span class="line-modified">!   G1SATBMarkQueueFilterFn() : _g1h(G1CollectedHeap::heap()) {}</span>
  
    // Return true if entry should be filtered out (removed), false if
    // it should be retained.
    bool operator()(const void* entry) const {
      return discard_entry(entry, _g1h);
    }
  };
  
  void G1SATBMarkQueueSet::filter(SATBMarkQueue* queue) {
<span class="line-modified">!   apply_filter(G1SATBMarkQueueFilterFn(), queue);</span>
  }
</pre>
<center><a href="g1RootProcessor.hpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="g1SATBMarkQueueSet.hpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>