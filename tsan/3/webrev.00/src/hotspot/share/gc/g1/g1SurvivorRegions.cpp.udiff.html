<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/gc/g1/g1SurvivorRegions.cpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="g1StringDedupQueue.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="g1SurvivorRegions.hpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/g1/g1SurvivorRegions.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2015, 2016, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2015, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -26,21 +26,29 @@</span>
  #include &quot;gc/g1/g1SurvivorRegions.hpp&quot;
  #include &quot;gc/g1/heapRegion.hpp&quot;
  #include &quot;utilities/growableArray.hpp&quot;
  #include &quot;utilities/debug.hpp&quot;
  
<span class="udiff-line-modified-removed">- G1SurvivorRegions::G1SurvivorRegions() : _regions(new (ResourceObj::C_HEAP, mtGC) GrowableArray&lt;HeapRegion*&gt;(8, true, mtGC)) {}</span>
<span class="udiff-line-modified-added">+ G1SurvivorRegions::G1SurvivorRegions() :</span>
<span class="udiff-line-added">+   _regions(new (ResourceObj::C_HEAP, mtGC) GrowableArray&lt;HeapRegion*&gt;(8, true, mtGC)),</span>
<span class="udiff-line-added">+   _used_bytes(0),</span>
<span class="udiff-line-added">+   _regions_on_node() {}</span>
  
<span class="udiff-line-modified-removed">- void G1SurvivorRegions::add(HeapRegion* hr) {</span>
<span class="udiff-line-modified-added">+ uint G1SurvivorRegions::add(HeapRegion* hr) {</span>
    assert(hr-&gt;is_survivor(), &quot;should be flagged as survivor region&quot;);
    _regions-&gt;append(hr);
<span class="udiff-line-added">+   return _regions_on_node.add(hr);</span>
  }
  
  uint G1SurvivorRegions::length() const {
    return (uint)_regions-&gt;length();
  }
  
<span class="udiff-line-added">+ uint G1SurvivorRegions::regions_on_node(uint node_index) const {</span>
<span class="udiff-line-added">+   return _regions_on_node.count(node_index);</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
  void G1SurvivorRegions::convert_to_eden() {
    for (GrowableArrayIterator&lt;HeapRegion*&gt; it = _regions-&gt;begin();
         it != _regions-&gt;end();
         ++it) {
      HeapRegion* hr = *it;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -49,7 +57,12 @@</span>
    clear();
  }
  
  void G1SurvivorRegions::clear() {
    _regions-&gt;clear();
<span class="udiff-line-added">+   _used_bytes = 0;</span>
<span class="udiff-line-added">+   _regions_on_node.clear();</span>
  }
  
<span class="udiff-line-added">+ void G1SurvivorRegions::add_used_bytes(size_t used_bytes) {</span>
<span class="udiff-line-added">+   _used_bytes += used_bytes;</span>
<span class="udiff-line-added">+ }</span>
</pre>
<center><a href="g1StringDedupQueue.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="g1SurvivorRegions.hpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>