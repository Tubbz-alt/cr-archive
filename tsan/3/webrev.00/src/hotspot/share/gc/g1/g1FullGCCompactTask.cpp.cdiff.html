<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/gc/g1/g1FullGCCompactTask.cpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="g1FullGCAdjustTask.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="g1FullGCCompactionPoint.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/g1/g1FullGCCompactTask.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2017, 2018 Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2017, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 51,26 ***</span>
            obj-&gt;init_mark_raw();
          } else {
            assert(current-&gt;is_empty(), &quot;Should have been cleared in phase 2.&quot;);
          }
        }
<span class="line-modified">!       current-&gt;reset_during_compaction();</span>
      }
      return false;
    }
  };
  
  size_t G1FullGCCompactTask::G1CompactRegionClosure::apply(oop obj) {
    size_t size = obj-&gt;size();
<span class="line-modified">!   HeapWord* destination = (HeapWord*)obj-&gt;forwardee();</span>
    if (destination == NULL) {
      // Object not moving
      return size;
    }
  
    // copy object and reinit its mark
<span class="line-modified">!   HeapWord* obj_addr = (HeapWord*) obj;</span>
    assert(obj_addr != destination, &quot;everything in this pass should be moving&quot;);
    Copy::aligned_conjoint_words(obj_addr, destination, size);
    oop(destination)-&gt;init_mark_raw();
    assert(oop(destination)-&gt;klass() != NULL, &quot;should have a class&quot;);
  
<span class="line-new-header">--- 51,26 ---</span>
            obj-&gt;init_mark_raw();
          } else {
            assert(current-&gt;is_empty(), &quot;Should have been cleared in phase 2.&quot;);
          }
        }
<span class="line-modified">!       current-&gt;reset_humongous_during_compaction();</span>
      }
      return false;
    }
  };
  
  size_t G1FullGCCompactTask::G1CompactRegionClosure::apply(oop obj) {
    size_t size = obj-&gt;size();
<span class="line-modified">!   HeapWord* destination = cast_from_oop&lt;HeapWord*&gt;(obj-&gt;forwardee());</span>
    if (destination == NULL) {
      // Object not moving
      return size;
    }
  
    // copy object and reinit its mark
<span class="line-modified">!   HeapWord* obj_addr = cast_from_oop&lt;HeapWord*&gt;(obj);</span>
    assert(obj_addr != destination, &quot;everything in this pass should be moving&quot;);
    Copy::aligned_conjoint_words(obj_addr, destination, size);
    oop(destination)-&gt;init_mark_raw();
    assert(oop(destination)-&gt;klass() != NULL, &quot;should have a class&quot;);
  
</pre>
<center><a href="g1FullGCAdjustTask.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="g1FullGCCompactionPoint.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>