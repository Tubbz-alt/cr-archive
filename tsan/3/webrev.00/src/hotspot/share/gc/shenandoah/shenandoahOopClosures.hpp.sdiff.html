<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/gc/shenandoah/shenandoahOopClosures.hpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="shenandoahNumberSeq.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="shenandoahOopClosures.inline.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/shenandoah/shenandoahOopClosures.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2015, 2018, Red Hat, Inc. All rights reserved.</span>

  3  *
  4  * This code is free software; you can redistribute it and/or modify it
  5  * under the terms of the GNU General Public License version 2 only, as
  6  * published by the Free Software Foundation.
  7  *
  8  * This code is distributed in the hope that it will be useful, but WITHOUT
  9  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 10  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 11  * version 2 for more details (a copy is included in the LICENSE file that
 12  * accompanied this code).
 13  *
 14  * You should have received a copy of the GNU General Public License version
 15  * 2 along with this work; if not, write to the Free Software Foundation,
 16  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 17  *
 18  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 19  * or visit www.oracle.com if you need additional information or have any
 20  * questions.
 21  *
 22  */
 23 
 24 #ifndef SHARE_GC_SHENANDOAH_SHENANDOAHOOPCLOSURES_HPP
 25 #define SHARE_GC_SHENANDOAH_SHENANDOAHOOPCLOSURES_HPP
 26 
 27 #include &quot;gc/shared/referenceProcessor.hpp&quot;
 28 #include &quot;gc/shenandoah/shenandoahHeap.hpp&quot;
 29 #include &quot;gc/shenandoah/shenandoahStrDedupQueue.hpp&quot;
 30 #include &quot;gc/shenandoah/shenandoahTaskqueue.hpp&quot;
 31 #include &quot;gc/shenandoah/shenandoahTraversalGC.hpp&quot;
 32 #include &quot;memory/iterator.hpp&quot;
 33 #include &quot;runtime/thread.hpp&quot;
 34 
 35 enum UpdateRefsMode {
 36   NONE,       // No reference updating
<span class="line-modified"> 37   RESOLVE,    // Only a read-barrier (no reference updating)</span>
 38   SIMPLE,     // Reference updating using simple store
 39   CONCURRENT  // Reference updating using CAS
 40 };
 41 
 42 enum StringDedupMode {
 43   NO_DEDUP,      // Do not do anything for String deduplication
<span class="line-modified"> 44   ENQUEUE_DEDUP, // Enqueue candidate Strings for deduplication</span>
 45 };
 46 
 47 class ShenandoahMarkRefsSuperClosure : public MetadataVisitingOopIterateClosure {
 48 private:
 49   ShenandoahObjToScanQueue* _queue;
 50   ShenandoahHeap* _heap;
 51   ShenandoahMarkingContext* const _mark_context;
 52 
 53 protected:
 54   template &lt;class T, UpdateRefsMode UPDATE_MODE, StringDedupMode STRING_DEDUP&gt;
 55   void work(T *p);
 56 
 57 public:
 58   ShenandoahMarkRefsSuperClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp);
 59 };
 60 
 61 class ShenandoahMarkUpdateRefsClosure : public ShenandoahMarkRefsSuperClosure {
 62 private:
 63   template &lt;class T&gt;
 64   inline void do_oop_work(T* p)     { work&lt;T, CONCURRENT, NO_DEDUP&gt;(p); }
</pre>
<hr />
<pre>
167 
168   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
169   virtual void do_oop(oop* p)       { do_oop_work(p); }
170   virtual bool do_metadata()        { return true; }
171 };
172 
173 class ShenandoahMarkRefsMetadataDedupClosure : public ShenandoahMarkRefsSuperClosure {
174 private:
175   template &lt;class T&gt;
176   inline void do_oop_work(T* p)     { work&lt;T, NONE, ENQUEUE_DEDUP&gt;(p); }
177 
178 public:
179   ShenandoahMarkRefsMetadataDedupClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
180     ShenandoahMarkRefsSuperClosure(q, rp) {};
181 
182   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
183   virtual void do_oop(oop* p)       { do_oop_work(p); }
184   virtual bool do_metadata()        { return true; }
185 };
186 
<span class="line-modified">187 class ShenandoahUpdateHeapRefsSuperClosure : public BasicOopIterateClosure {</span>
188 private:
189   ShenandoahHeap* _heap;
<span class="line-removed">190 public:</span>
<span class="line-removed">191   ShenandoahUpdateHeapRefsSuperClosure() :</span>
<span class="line-removed">192     _heap(ShenandoahHeap::heap()) {}</span>
<span class="line-removed">193 </span>
<span class="line-removed">194   template &lt;class T&gt;</span>
<span class="line-removed">195   void work(T *p);</span>
<span class="line-removed">196 };</span>
197 
<span class="line-removed">198 class ShenandoahUpdateHeapRefsClosure : public ShenandoahUpdateHeapRefsSuperClosure {</span>
<span class="line-removed">199 private:</span>
200   template &lt;class T&gt;
<span class="line-modified">201   inline  void do_oop_work(T* p)    { work&lt;T&gt;(p); }</span>
202 
203 public:
<span class="line-modified">204   ShenandoahUpdateHeapRefsClosure() : ShenandoahUpdateHeapRefsSuperClosure() {}</span>

205 
206   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
207   virtual void do_oop(oop* p)       { do_oop_work(p); }
208 };
209 
210 class ShenandoahTraversalSuperClosure : public MetadataVisitingOopIterateClosure {
211 private:
212   ShenandoahTraversalGC* const _traversal_gc;
213   Thread* const _thread;
214   ShenandoahObjToScanQueue* const _queue;
215   ShenandoahMarkingContext* const _mark_context;
216 protected:
217   ShenandoahTraversalSuperClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
218     MetadataVisitingOopIterateClosure(rp),
219     _traversal_gc(ShenandoahHeap::heap()-&gt;traversal_gc()),
220     _thread(Thread::current()),
221     _queue(q),
222     _mark_context(ShenandoahHeap::heap()-&gt;marking_context()) {
223   }
224 
<span class="line-modified">225   template &lt;class T, bool STRING_DEDUP, bool DEGEN&gt;</span>
226   void work(T* p);
227 
228 };
229 















230 class ShenandoahTraversalClosure : public ShenandoahTraversalSuperClosure {
231 private:
232   template &lt;class T&gt;
<span class="line-modified">233   inline void do_oop_work(T* p)     { work&lt;T, false, false&gt;(p); }</span>
234 
235 public:
236   ShenandoahTraversalClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
237     ShenandoahTraversalSuperClosure(q, rp) {}
238 
239   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
240   virtual void do_oop(oop* p)       { do_oop_work(p); }
241 
242   virtual bool do_metadata()        { return false; }
243 };
244 
245 class ShenandoahTraversalMetadataClosure : public ShenandoahTraversalSuperClosure {
246 private:
247   template &lt;class T&gt;
<span class="line-modified">248   inline void do_oop_work(T* p)     { work&lt;T, false, false&gt;(p); }</span>
249 
250 public:
251   ShenandoahTraversalMetadataClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
252     ShenandoahTraversalSuperClosure(q, rp) {}
253 
254   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
255   virtual void do_oop(oop* p)       { do_oop_work(p); }
256 
257   virtual bool do_metadata()        { return true; }
258 };
259 
260 class ShenandoahTraversalDedupClosure : public ShenandoahTraversalSuperClosure {
261 private:
262   template &lt;class T&gt;
<span class="line-modified">263   inline void do_oop_work(T* p)     { work&lt;T, true, false&gt;(p); }</span>
264 
265 public:
266   ShenandoahTraversalDedupClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
267     ShenandoahTraversalSuperClosure(q, rp) {}
268 
269   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
270   virtual void do_oop(oop* p)       { do_oop_work(p); }
271 
272   virtual bool do_metadata()        { return false; }
273 };
274 
275 class ShenandoahTraversalMetadataDedupClosure : public ShenandoahTraversalSuperClosure {
276 private:
277   template &lt;class T&gt;
<span class="line-modified">278   inline void do_oop_work(T* p)     { work&lt;T, true, false&gt;(p); }</span>
279 
280 public:
281   ShenandoahTraversalMetadataDedupClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
282     ShenandoahTraversalSuperClosure(q, rp) {}
283 
284   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
285   virtual void do_oop(oop* p)       { do_oop_work(p); }
286 
287   virtual bool do_metadata()        { return true; }
288 };
289 
290 class ShenandoahTraversalDegenClosure : public ShenandoahTraversalSuperClosure {
291 private:
292   template &lt;class T&gt;
<span class="line-modified">293   inline void do_oop_work(T* p)     { work&lt;T, false, true&gt;(p); }</span>
294 
295 public:
296   ShenandoahTraversalDegenClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
297     ShenandoahTraversalSuperClosure(q, rp) {}
298 
299   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
300   virtual void do_oop(oop* p)       { do_oop_work(p); }
301 
302   virtual bool do_metadata()        { return false; }
303 };
304 
305 class ShenandoahTraversalMetadataDegenClosure : public ShenandoahTraversalSuperClosure {
306 private:
307   template &lt;class T&gt;
<span class="line-modified">308   inline void do_oop_work(T* p)     { work&lt;T, false, true&gt;(p); }</span>
309 
310 public:
311   ShenandoahTraversalMetadataDegenClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
312     ShenandoahTraversalSuperClosure(q, rp) {}
313 
314   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
315   virtual void do_oop(oop* p)       { do_oop_work(p); }
316 
317   virtual bool do_metadata()        { return true; }
318 };
319 
320 class ShenandoahTraversalDedupDegenClosure : public ShenandoahTraversalSuperClosure {
321 private:
322   template &lt;class T&gt;
<span class="line-modified">323   inline void do_oop_work(T* p)     { work&lt;T, true, true&gt;(p); }</span>
324 
325 public:
326   ShenandoahTraversalDedupDegenClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
327     ShenandoahTraversalSuperClosure(q, rp) {}
328 
329   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
330   virtual void do_oop(oop* p)       { do_oop_work(p); }
331 
332   virtual bool do_metadata()        { return false; }
333 };
334 
335 class ShenandoahTraversalMetadataDedupDegenClosure : public ShenandoahTraversalSuperClosure {
336 private:
337   template &lt;class T&gt;
<span class="line-modified">338   inline void do_oop_work(T* p)     { work&lt;T, true, true&gt;(p); }</span>
339 
340 public:
341   ShenandoahTraversalMetadataDedupDegenClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
342     ShenandoahTraversalSuperClosure(q, rp) {}
343 
344   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
345   virtual void do_oop(oop* p)       { do_oop_work(p); }
346 
347   virtual bool do_metadata()        { return true; }
348 };
349 
350 #endif // SHARE_GC_SHENANDOAH_SHENANDOAHOOPCLOSURES_HPP
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2015, 2019, Red Hat, Inc. All rights reserved.</span>
<span class="line-added">  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.</span>
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  *
 23  */
 24 
 25 #ifndef SHARE_GC_SHENANDOAH_SHENANDOAHOOPCLOSURES_HPP
 26 #define SHARE_GC_SHENANDOAH_SHENANDOAHOOPCLOSURES_HPP
 27 
 28 #include &quot;gc/shared/referenceProcessor.hpp&quot;
 29 #include &quot;gc/shenandoah/shenandoahHeap.hpp&quot;
 30 #include &quot;gc/shenandoah/shenandoahStrDedupQueue.hpp&quot;
 31 #include &quot;gc/shenandoah/shenandoahTaskqueue.hpp&quot;
 32 #include &quot;gc/shenandoah/shenandoahTraversalGC.hpp&quot;
 33 #include &quot;memory/iterator.hpp&quot;
 34 #include &quot;runtime/thread.hpp&quot;
 35 
 36 enum UpdateRefsMode {
 37   NONE,       // No reference updating
<span class="line-modified"> 38   RESOLVE,    // Only a resolve (no reference updating)</span>
 39   SIMPLE,     // Reference updating using simple store
 40   CONCURRENT  // Reference updating using CAS
 41 };
 42 
 43 enum StringDedupMode {
 44   NO_DEDUP,      // Do not do anything for String deduplication
<span class="line-modified"> 45   ENQUEUE_DEDUP  // Enqueue candidate Strings for deduplication</span>
 46 };
 47 
 48 class ShenandoahMarkRefsSuperClosure : public MetadataVisitingOopIterateClosure {
 49 private:
 50   ShenandoahObjToScanQueue* _queue;
 51   ShenandoahHeap* _heap;
 52   ShenandoahMarkingContext* const _mark_context;
 53 
 54 protected:
 55   template &lt;class T, UpdateRefsMode UPDATE_MODE, StringDedupMode STRING_DEDUP&gt;
 56   void work(T *p);
 57 
 58 public:
 59   ShenandoahMarkRefsSuperClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp);
 60 };
 61 
 62 class ShenandoahMarkUpdateRefsClosure : public ShenandoahMarkRefsSuperClosure {
 63 private:
 64   template &lt;class T&gt;
 65   inline void do_oop_work(T* p)     { work&lt;T, CONCURRENT, NO_DEDUP&gt;(p); }
</pre>
<hr />
<pre>
168 
169   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
170   virtual void do_oop(oop* p)       { do_oop_work(p); }
171   virtual bool do_metadata()        { return true; }
172 };
173 
174 class ShenandoahMarkRefsMetadataDedupClosure : public ShenandoahMarkRefsSuperClosure {
175 private:
176   template &lt;class T&gt;
177   inline void do_oop_work(T* p)     { work&lt;T, NONE, ENQUEUE_DEDUP&gt;(p); }
178 
179 public:
180   ShenandoahMarkRefsMetadataDedupClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
181     ShenandoahMarkRefsSuperClosure(q, rp) {};
182 
183   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
184   virtual void do_oop(oop* p)       { do_oop_work(p); }
185   virtual bool do_metadata()        { return true; }
186 };
187 
<span class="line-modified">188 class ShenandoahUpdateHeapRefsClosure : public BasicOopIterateClosure {</span>
189 private:
190   ShenandoahHeap* _heap;







191 


192   template &lt;class T&gt;
<span class="line-modified">193   void do_oop_work(T* p);</span>
194 
195 public:
<span class="line-modified">196   ShenandoahUpdateHeapRefsClosure() :</span>
<span class="line-added">197     _heap(ShenandoahHeap::heap()) {}</span>
198 
199   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
200   virtual void do_oop(oop* p)       { do_oop_work(p); }
201 };
202 
203 class ShenandoahTraversalSuperClosure : public MetadataVisitingOopIterateClosure {
204 private:
205   ShenandoahTraversalGC* const _traversal_gc;
206   Thread* const _thread;
207   ShenandoahObjToScanQueue* const _queue;
208   ShenandoahMarkingContext* const _mark_context;
209 protected:
210   ShenandoahTraversalSuperClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
211     MetadataVisitingOopIterateClosure(rp),
212     _traversal_gc(ShenandoahHeap::heap()-&gt;traversal_gc()),
213     _thread(Thread::current()),
214     _queue(q),
215     _mark_context(ShenandoahHeap::heap()-&gt;marking_context()) {
216   }
217 
<span class="line-modified">218   template &lt;class T, bool STRING_DEDUP, bool DEGEN, bool ATOMIC_UPDATE&gt;</span>
219   void work(T* p);
220 
221 };
222 
<span class="line-added">223 class ShenandoahTraversalRootsClosure : public ShenandoahTraversalSuperClosure {</span>
<span class="line-added">224 private:</span>
<span class="line-added">225   template &lt;class T&gt;</span>
<span class="line-added">226   inline void do_oop_work(T* p)     { work&lt;T, false, false, false&gt;(p); }</span>
<span class="line-added">227 </span>
<span class="line-added">228 public:</span>
<span class="line-added">229   ShenandoahTraversalRootsClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :</span>
<span class="line-added">230     ShenandoahTraversalSuperClosure(q, rp) {}</span>
<span class="line-added">231 </span>
<span class="line-added">232   virtual void do_oop(narrowOop* p) { do_oop_work(p); }</span>
<span class="line-added">233   virtual void do_oop(oop* p)       { do_oop_work(p); }</span>
<span class="line-added">234 </span>
<span class="line-added">235   virtual bool do_metadata()        { return false; }</span>
<span class="line-added">236 };</span>
<span class="line-added">237 </span>
238 class ShenandoahTraversalClosure : public ShenandoahTraversalSuperClosure {
239 private:
240   template &lt;class T&gt;
<span class="line-modified">241   inline void do_oop_work(T* p)     { work&lt;T, false, false, true&gt;(p); }</span>
242 
243 public:
244   ShenandoahTraversalClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
245     ShenandoahTraversalSuperClosure(q, rp) {}
246 
247   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
248   virtual void do_oop(oop* p)       { do_oop_work(p); }
249 
250   virtual bool do_metadata()        { return false; }
251 };
252 
253 class ShenandoahTraversalMetadataClosure : public ShenandoahTraversalSuperClosure {
254 private:
255   template &lt;class T&gt;
<span class="line-modified">256   inline void do_oop_work(T* p)     { work&lt;T, false, false, true&gt;(p); }</span>
257 
258 public:
259   ShenandoahTraversalMetadataClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
260     ShenandoahTraversalSuperClosure(q, rp) {}
261 
262   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
263   virtual void do_oop(oop* p)       { do_oop_work(p); }
264 
265   virtual bool do_metadata()        { return true; }
266 };
267 
268 class ShenandoahTraversalDedupClosure : public ShenandoahTraversalSuperClosure {
269 private:
270   template &lt;class T&gt;
<span class="line-modified">271   inline void do_oop_work(T* p)     { work&lt;T, true, false, true&gt;(p); }</span>
272 
273 public:
274   ShenandoahTraversalDedupClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
275     ShenandoahTraversalSuperClosure(q, rp) {}
276 
277   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
278   virtual void do_oop(oop* p)       { do_oop_work(p); }
279 
280   virtual bool do_metadata()        { return false; }
281 };
282 
283 class ShenandoahTraversalMetadataDedupClosure : public ShenandoahTraversalSuperClosure {
284 private:
285   template &lt;class T&gt;
<span class="line-modified">286   inline void do_oop_work(T* p)     { work&lt;T, true, false, true&gt;(p); }</span>
287 
288 public:
289   ShenandoahTraversalMetadataDedupClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
290     ShenandoahTraversalSuperClosure(q, rp) {}
291 
292   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
293   virtual void do_oop(oop* p)       { do_oop_work(p); }
294 
295   virtual bool do_metadata()        { return true; }
296 };
297 
298 class ShenandoahTraversalDegenClosure : public ShenandoahTraversalSuperClosure {
299 private:
300   template &lt;class T&gt;
<span class="line-modified">301   inline void do_oop_work(T* p)     { work&lt;T, false, true, false&gt;(p); }</span>
302 
303 public:
304   ShenandoahTraversalDegenClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
305     ShenandoahTraversalSuperClosure(q, rp) {}
306 
307   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
308   virtual void do_oop(oop* p)       { do_oop_work(p); }
309 
310   virtual bool do_metadata()        { return false; }
311 };
312 
313 class ShenandoahTraversalMetadataDegenClosure : public ShenandoahTraversalSuperClosure {
314 private:
315   template &lt;class T&gt;
<span class="line-modified">316   inline void do_oop_work(T* p)     { work&lt;T, false, true, false&gt;(p); }</span>
317 
318 public:
319   ShenandoahTraversalMetadataDegenClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
320     ShenandoahTraversalSuperClosure(q, rp) {}
321 
322   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
323   virtual void do_oop(oop* p)       { do_oop_work(p); }
324 
325   virtual bool do_metadata()        { return true; }
326 };
327 
328 class ShenandoahTraversalDedupDegenClosure : public ShenandoahTraversalSuperClosure {
329 private:
330   template &lt;class T&gt;
<span class="line-modified">331   inline void do_oop_work(T* p)     { work&lt;T, true, true, false&gt;(p); }</span>
332 
333 public:
334   ShenandoahTraversalDedupDegenClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
335     ShenandoahTraversalSuperClosure(q, rp) {}
336 
337   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
338   virtual void do_oop(oop* p)       { do_oop_work(p); }
339 
340   virtual bool do_metadata()        { return false; }
341 };
342 
343 class ShenandoahTraversalMetadataDedupDegenClosure : public ShenandoahTraversalSuperClosure {
344 private:
345   template &lt;class T&gt;
<span class="line-modified">346   inline void do_oop_work(T* p)     { work&lt;T, true, true, false&gt;(p); }</span>
347 
348 public:
349   ShenandoahTraversalMetadataDedupDegenClosure(ShenandoahObjToScanQueue* q, ReferenceProcessor* rp) :
350     ShenandoahTraversalSuperClosure(q, rp) {}
351 
352   virtual void do_oop(narrowOop* p) { do_oop_work(p); }
353   virtual void do_oop(oop* p)       { do_oop_work(p); }
354 
355   virtual bool do_metadata()        { return true; }
356 };
357 
358 #endif // SHARE_GC_SHENANDOAH_SHENANDOAHOOPCLOSURES_HPP
</pre>
</td>
</tr>
</table>
<center><a href="shenandoahNumberSeq.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="shenandoahOopClosures.inline.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>