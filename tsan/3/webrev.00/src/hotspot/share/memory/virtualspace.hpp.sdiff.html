<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/memory/virtualspace.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="virtualspace.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../oops/access.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/memory/virtualspace.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  *
 23  */
 24 
 25 #ifndef SHARE_MEMORY_VIRTUALSPACE_HPP
 26 #define SHARE_MEMORY_VIRTUALSPACE_HPP
 27 

 28 #include &quot;utilities/globalDefinitions.hpp&quot;
 29 
 30 class outputStream;
 31 
 32 // ReservedSpace is a data structure for reserving a contiguous address range.
 33 
 34 class ReservedSpace {
 35   friend class VMStructs;
 36  protected:
 37   char*  _base;
 38   size_t _size;
 39   size_t _noaccess_prefix;
 40   size_t _alignment;
 41   bool   _special;
 42   int    _fd_for_heap;
 43  private:
 44   bool   _executable;
 45 
 46   // ReservedSpace
 47   ReservedSpace(char* base, size_t size, size_t alignment, bool special,
</pre>
<hr />
<pre>
105 }
106 
107 // Class encapsulating behavior specific of memory space reserved for Java heap.
108 class ReservedHeapSpace : public ReservedSpace {
109  private:
110   void try_reserve_heap(size_t size, size_t alignment, bool large,
111                         char *requested_address);
112   void try_reserve_range(char *highest_start, char *lowest_start,
113                          size_t attach_point_alignment, char *aligned_HBMA,
114                          char *upper_bound, size_t size, size_t alignment, bool large);
115   void initialize_compressed_heap(const size_t size, size_t alignment, bool large);
116   // Create protection page at the beginning of the space.
117   void establish_noaccess_prefix();
118  public:
119   // Constructor. Tries to find a heap that is good for compressed oops.
120   // heap_allocation_directory is the path to the backing memory for Java heap. When set, Java heap will be allocated
121   // on the device which is managed by the file system where the directory resides.
122   ReservedHeapSpace(size_t size, size_t forced_base_alignment, bool large, const char* heap_allocation_directory = NULL);
123   // Returns the base to be used for compression, i.e. so that null can be
124   // encoded safely and implicit null checks can work.
<span class="line-modified">125   char *compressed_oop_base() { return _base - _noaccess_prefix; }</span>

126 };
127 
128 // Class encapsulating behavior specific memory space for Code
129 class ReservedCodeSpace : public ReservedSpace {
130  public:
131   // Constructor
132   ReservedCodeSpace(size_t r_size, size_t rs_align, bool large);
133 };
134 
135 // VirtualSpace is data structure for committing a previously reserved address range in smaller chunks.
136 
137 class VirtualSpace {
138   friend class VMStructs;
139  private:
140   // Reserved area
141   char* _low_boundary;
142   char* _high_boundary;
143 
144   // Committed area
145   char* _low;
</pre>
</td>
<td>
<hr />
<pre>
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  *
 23  */
 24 
 25 #ifndef SHARE_MEMORY_VIRTUALSPACE_HPP
 26 #define SHARE_MEMORY_VIRTUALSPACE_HPP
 27 
<span class="line-added"> 28 #include &quot;memory/memRegion.hpp&quot;</span>
 29 #include &quot;utilities/globalDefinitions.hpp&quot;
 30 
 31 class outputStream;
 32 
 33 // ReservedSpace is a data structure for reserving a contiguous address range.
 34 
 35 class ReservedSpace {
 36   friend class VMStructs;
 37  protected:
 38   char*  _base;
 39   size_t _size;
 40   size_t _noaccess_prefix;
 41   size_t _alignment;
 42   bool   _special;
 43   int    _fd_for_heap;
 44  private:
 45   bool   _executable;
 46 
 47   // ReservedSpace
 48   ReservedSpace(char* base, size_t size, size_t alignment, bool special,
</pre>
<hr />
<pre>
106 }
107 
108 // Class encapsulating behavior specific of memory space reserved for Java heap.
109 class ReservedHeapSpace : public ReservedSpace {
110  private:
111   void try_reserve_heap(size_t size, size_t alignment, bool large,
112                         char *requested_address);
113   void try_reserve_range(char *highest_start, char *lowest_start,
114                          size_t attach_point_alignment, char *aligned_HBMA,
115                          char *upper_bound, size_t size, size_t alignment, bool large);
116   void initialize_compressed_heap(const size_t size, size_t alignment, bool large);
117   // Create protection page at the beginning of the space.
118   void establish_noaccess_prefix();
119  public:
120   // Constructor. Tries to find a heap that is good for compressed oops.
121   // heap_allocation_directory is the path to the backing memory for Java heap. When set, Java heap will be allocated
122   // on the device which is managed by the file system where the directory resides.
123   ReservedHeapSpace(size_t size, size_t forced_base_alignment, bool large, const char* heap_allocation_directory = NULL);
124   // Returns the base to be used for compression, i.e. so that null can be
125   // encoded safely and implicit null checks can work.
<span class="line-modified">126   char *compressed_oop_base() const { return _base - _noaccess_prefix; }</span>
<span class="line-added">127   MemRegion region() const;</span>
128 };
129 
130 // Class encapsulating behavior specific memory space for Code
131 class ReservedCodeSpace : public ReservedSpace {
132  public:
133   // Constructor
134   ReservedCodeSpace(size_t r_size, size_t rs_align, bool large);
135 };
136 
137 // VirtualSpace is data structure for committing a previously reserved address range in smaller chunks.
138 
139 class VirtualSpace {
140   friend class VMStructs;
141  private:
142   // Reserved area
143   char* _low_boundary;
144   char* _high_boundary;
145 
146   // Committed area
147   char* _low;
</pre>
</td>
</tr>
</table>
<center><a href="virtualspace.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../oops/access.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>