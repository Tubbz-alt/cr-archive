<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/memory/iterator.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="iterator.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="iterator.inline.hpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/memory/iterator.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -34,15 +34,23 @@</span>
  class ReferenceDiscoverer;
  class DataLayout;
  class KlassClosure;
  class ClassLoaderData;
  class Symbol;
<span class="udiff-line-added">+ class Metadata;</span>
<span class="udiff-line-added">+ class Thread;</span>
  
  // The following classes are C++ `closures` for iterating over objects, roots and spaces
  
  class Closure : public StackObj { };
  
<span class="udiff-line-added">+ // Thread iterator</span>
<span class="udiff-line-added">+ class ThreadClosure: public Closure {</span>
<span class="udiff-line-added">+  public:</span>
<span class="udiff-line-added">+   virtual void do_thread(Thread* thread) = 0;</span>
<span class="udiff-line-added">+ };</span>
<span class="udiff-line-added">+ </span>
  // OopClosure is used for iterating through references to Java objects.
  class OopClosure : public Closure {
   public:
    virtual void do_oop(oop* o) = 0;
    virtual void do_oop(narrowOop* o) = 0;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -122,10 +130,15 @@</span>
  class CLDClosure : public Closure {
   public:
    virtual void do_cld(ClassLoaderData* cld) = 0;
  };
  
<span class="udiff-line-added">+ class MetadataClosure : public Closure {</span>
<span class="udiff-line-added">+  public:</span>
<span class="udiff-line-added">+   virtual void do_metadata(Metadata* md) = 0;</span>
<span class="udiff-line-added">+ };</span>
<span class="udiff-line-added">+ </span>
  
  class CLDToOopClosure : public CLDClosure {
    OopClosure*       _oop_closure;
    int               _cld_claim;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -136,22 +149,32 @@</span>
        _cld_claim(cld_claim) {}
  
    void do_cld(ClassLoaderData* cld);
  };
  
<span class="udiff-line-modified-removed">- // The base class for all concurrent marking closures,</span>
<span class="udiff-line-modified-removed">- // that participates in class unloading.</span>
<span class="udiff-line-modified-removed">- // It&#39;s used to proxy through the metadata to the oops defined in them.</span>
<span class="udiff-line-modified-removed">- class MetadataVisitingOopIterateClosure: public OopIterateClosure {</span>
<span class="udiff-line-modified-added">+ class ClaimMetadataVisitingOopIterateClosure : public OopIterateClosure {</span>
<span class="udiff-line-modified-added">+  protected:</span>
<span class="udiff-line-modified-added">+   const int _claim;</span>
<span class="udiff-line-modified-added">+ </span>
   public:
<span class="udiff-line-modified-removed">-   MetadataVisitingOopIterateClosure(ReferenceDiscoverer* rd = NULL) : OopIterateClosure(rd) { }</span>
<span class="udiff-line-modified-added">+   ClaimMetadataVisitingOopIterateClosure(int claim, ReferenceDiscoverer* rd = NULL) :</span>
<span class="udiff-line-added">+       OopIterateClosure(rd),</span>
<span class="udiff-line-added">+       _claim(claim) { }</span>
  
    virtual bool do_metadata() { return true; }
    virtual void do_klass(Klass* k);
    virtual void do_cld(ClassLoaderData* cld);
  };
  
<span class="udiff-line-added">+ // The base class for all concurrent marking closures,</span>
<span class="udiff-line-added">+ // that participates in class unloading.</span>
<span class="udiff-line-added">+ // It&#39;s used to proxy through the metadata to the oops defined in them.</span>
<span class="udiff-line-added">+ class MetadataVisitingOopIterateClosure: public ClaimMetadataVisitingOopIterateClosure {</span>
<span class="udiff-line-added">+  public:</span>
<span class="udiff-line-added">+   MetadataVisitingOopIterateClosure(ReferenceDiscoverer* rd = NULL);</span>
<span class="udiff-line-added">+ };</span>
<span class="udiff-line-added">+ </span>
  // ObjectClosure is used for iterating through an object space
  
  class ObjectClosure : public Closure {
   public:
    // Called for each object.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -181,38 +204,10 @@</span>
  public:
    void do_object(oop obj);
    ObjectToOopClosure(OopIterateClosure* cl) : _cl(cl) {}
  };
  
<span class="udiff-line-removed">- // A version of ObjectClosure that is expected to be robust</span>
<span class="udiff-line-removed">- // in the face of possibly uninitialized objects.</span>
<span class="udiff-line-removed">- class ObjectClosureCareful : public ObjectClosure {</span>
<span class="udiff-line-removed">-  public:</span>
<span class="udiff-line-removed">-   virtual size_t do_object_careful_m(oop p, MemRegion mr) = 0;</span>
<span class="udiff-line-removed">-   virtual size_t do_object_careful(oop p) = 0;</span>
<span class="udiff-line-removed">- };</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- // The following are used in CompactibleFreeListSpace and</span>
<span class="udiff-line-removed">- // ConcurrentMarkSweepGeneration.</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- // Blk closure (abstract class)</span>
<span class="udiff-line-removed">- class BlkClosure : public StackObj {</span>
<span class="udiff-line-removed">-  public:</span>
<span class="udiff-line-removed">-   virtual size_t do_blk(HeapWord* addr) = 0;</span>
<span class="udiff-line-removed">- };</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- // A version of BlkClosure that is expected to be robust</span>
<span class="udiff-line-removed">- // in the face of possibly uninitialized objects.</span>
<span class="udiff-line-removed">- class BlkClosureCareful : public BlkClosure {</span>
<span class="udiff-line-removed">-  public:</span>
<span class="udiff-line-removed">-   size_t do_blk(HeapWord* addr) {</span>
<span class="udiff-line-removed">-     guarantee(false, &quot;call do_blk_careful instead&quot;);</span>
<span class="udiff-line-removed">-     return 0;</span>
<span class="udiff-line-removed">-   }</span>
<span class="udiff-line-removed">-   virtual size_t do_blk_careful(HeapWord* addr) = 0;</span>
<span class="udiff-line-removed">- };</span>
<span class="udiff-line-removed">- </span>
  // SpaceClosure is used for iterating over spaces
  
  class Space;
  class CompactibleSpace;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -314,10 +309,13 @@</span>
    virtual void do_ptr(void** p) = 0;
  
    // Read/write the 32-bit unsigned integer pointed to by p.
    virtual void do_u4(u4* p) = 0;
  
<span class="udiff-line-added">+   // Read/write the bool pointed to by p.</span>
<span class="udiff-line-added">+   virtual void do_bool(bool* p) = 0;</span>
<span class="udiff-line-added">+ </span>
    // Read/write the region specified.
    virtual void do_region(u_char* start, size_t size) = 0;
  
    // Check/write the tag.  If reading, then compare the tag against
    // the passed in value and fail is they don&#39;t match.  This allows
</pre>
<center><a href="iterator.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="iterator.inline.hpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>