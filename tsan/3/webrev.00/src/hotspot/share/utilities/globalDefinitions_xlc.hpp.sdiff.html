<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/utilities/globalDefinitions_xlc.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="globalDefinitions_visCPP.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="growableArray.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/utilities/globalDefinitions_xlc.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 34 
 35 #include &lt;ctype.h&gt;
 36 #include &lt;string.h&gt;
 37 #include &lt;stdarg.h&gt;
 38 #include &lt;stddef.h&gt;
 39 #include &lt;stdio.h&gt;
 40 #include &lt;stdlib.h&gt;
 41 #include &lt;wchar.h&gt;
 42 
 43 #include &lt;math.h&gt;
 44 #include &lt;time.h&gt;
 45 #include &lt;fcntl.h&gt;
 46 #include &lt;dlfcn.h&gt;
 47 #include &lt;pthread.h&gt;
 48 
 49 #include &lt;limits.h&gt;
 50 #include &lt;errno.h&gt;
 51 
 52 #include &lt;stdint.h&gt;
 53 
<span class="line-modified"> 54 // __IBMCPP__ is not defined any more with xlclang++</span>
<span class="line-modified"> 55 #ifdef __IBMCPP__</span>
<span class="line-modified"> 56 #if __IBMCPP__ &lt; 1200</span>
<span class="line-modified"> 57 #error &quot;xlc &lt; 12 not supported&quot;</span>
<span class="line-modified"> 58 #endif</span>


 59 #endif
 60 
 61 #ifndef _AIX
 62 #error &quot;missing AIX-specific definition _AIX&quot;
 63 #endif
 64 
 65 // Use XLC compiler builtins instead of inline assembler
 66 #define USE_XLC_BUILTINS
 67 
 68 #ifdef USE_XLC_BUILTINS
 69 #include &lt;builtins.h&gt;
 70 // XLC V10 and higher provide the prototype for __dcbtst (void *);
 71 #endif // USE_XLC_BUILTINS
 72 
 73 // NULL vs NULL_WORD:
 74 // Some platform/tool-chain combinations can&#39;t assign NULL to an integer
 75 // type so we define NULL_WORD to use in those contexts. For xlc they are the same.
 76 #define NULL_WORD  NULL
 77 
 78 // AIX also needs a 64 bit NULL to work as a null address pointer.
</pre>
<hr />
<pre>
111 inline int wcslen(const jchar* x) { return wcslen((const wchar_t*)x); }
112 
113 
114 // Formatting.
115 #ifdef _LP64
116 #define FORMAT64_MODIFIER &quot;l&quot;
117 #else // !_LP64
118 #define FORMAT64_MODIFIER &quot;ll&quot;
119 #endif // _LP64
120 
121 // Cannot use xlc&#39;s offsetof as implementation of hotspot&#39;s
122 // offset_of(), because xlc warns about applying offsetof() to non-POD
123 // object and xlc cannot compile the expression offsetof(DataLayout,
124 // _cells[index]) in DataLayout::cell_offset() .  Therefore we define
125 // offset_of as it is defined for gcc.
126 #define offset_of(klass,field) (size_t)((intx)&amp;(((klass*)16)-&gt;field) - 16)
127 
128 // AIX 5.3 has buggy __thread support. (see JDK-8176442).
129 #define USE_LIBRARY_BASED_TLS_ONLY 1
130 
<span class="line-removed">131 #ifndef USE_LIBRARY_BASED_TLS_ONLY</span>
<span class="line-removed">132 #define THREAD_LOCAL_DECL __thread</span>
<span class="line-removed">133 #endif</span>
<span class="line-removed">134 </span>
135 // Inlining support
136 //
137 // Be aware that for function/method declarations, xlC only supports the following
138 // syntax (i.e. the attribute must be placed AFTER the function/method declarator):
139 //
140 //   void* operator new(size_t size) throw() NOINLINE;
141 //
142 // For function/method defintions, the more common placement BEFORE the
143 // function/method declarator seems to be supported as well:
144 //
145 //   NOINLINE void* CHeapObj&lt;F&gt;::operator new(size_t size) throw() {...}
146 
147 #define NOINLINE     __attribute__((__noinline__))
148 #define ALWAYSINLINE inline __attribute__((__always_inline__))
149 
150 #endif // SHARE_UTILITIES_GLOBALDEFINITIONS_XLC_HPP
</pre>
</td>
<td>
<hr />
<pre>
 34 
 35 #include &lt;ctype.h&gt;
 36 #include &lt;string.h&gt;
 37 #include &lt;stdarg.h&gt;
 38 #include &lt;stddef.h&gt;
 39 #include &lt;stdio.h&gt;
 40 #include &lt;stdlib.h&gt;
 41 #include &lt;wchar.h&gt;
 42 
 43 #include &lt;math.h&gt;
 44 #include &lt;time.h&gt;
 45 #include &lt;fcntl.h&gt;
 46 #include &lt;dlfcn.h&gt;
 47 #include &lt;pthread.h&gt;
 48 
 49 #include &lt;limits.h&gt;
 50 #include &lt;errno.h&gt;
 51 
 52 #include &lt;stdint.h&gt;
 53 
<span class="line-modified"> 54 // check for xlc16 or higher</span>
<span class="line-modified"> 55 #ifdef __ibmxl_version__</span>
<span class="line-modified"> 56   #if __ibmxl_version__ &lt; 16</span>
<span class="line-modified"> 57   #error &quot;xlc &lt; 16 not supported&quot;</span>
<span class="line-modified"> 58   #endif</span>
<span class="line-added"> 59 #else</span>
<span class="line-added"> 60   #error &quot;xlc &lt; 16 not supported, macro __ibmxl_version__ not found&quot;</span>
 61 #endif
 62 
 63 #ifndef _AIX
 64 #error &quot;missing AIX-specific definition _AIX&quot;
 65 #endif
 66 
 67 // Use XLC compiler builtins instead of inline assembler
 68 #define USE_XLC_BUILTINS
 69 
 70 #ifdef USE_XLC_BUILTINS
 71 #include &lt;builtins.h&gt;
 72 // XLC V10 and higher provide the prototype for __dcbtst (void *);
 73 #endif // USE_XLC_BUILTINS
 74 
 75 // NULL vs NULL_WORD:
 76 // Some platform/tool-chain combinations can&#39;t assign NULL to an integer
 77 // type so we define NULL_WORD to use in those contexts. For xlc they are the same.
 78 #define NULL_WORD  NULL
 79 
 80 // AIX also needs a 64 bit NULL to work as a null address pointer.
</pre>
<hr />
<pre>
113 inline int wcslen(const jchar* x) { return wcslen((const wchar_t*)x); }
114 
115 
116 // Formatting.
117 #ifdef _LP64
118 #define FORMAT64_MODIFIER &quot;l&quot;
119 #else // !_LP64
120 #define FORMAT64_MODIFIER &quot;ll&quot;
121 #endif // _LP64
122 
123 // Cannot use xlc&#39;s offsetof as implementation of hotspot&#39;s
124 // offset_of(), because xlc warns about applying offsetof() to non-POD
125 // object and xlc cannot compile the expression offsetof(DataLayout,
126 // _cells[index]) in DataLayout::cell_offset() .  Therefore we define
127 // offset_of as it is defined for gcc.
128 #define offset_of(klass,field) (size_t)((intx)&amp;(((klass*)16)-&gt;field) - 16)
129 
130 // AIX 5.3 has buggy __thread support. (see JDK-8176442).
131 #define USE_LIBRARY_BASED_TLS_ONLY 1
132 




133 // Inlining support
134 //
135 // Be aware that for function/method declarations, xlC only supports the following
136 // syntax (i.e. the attribute must be placed AFTER the function/method declarator):
137 //
138 //   void* operator new(size_t size) throw() NOINLINE;
139 //
140 // For function/method defintions, the more common placement BEFORE the
141 // function/method declarator seems to be supported as well:
142 //
143 //   NOINLINE void* CHeapObj&lt;F&gt;::operator new(size_t size) throw() {...}
144 
145 #define NOINLINE     __attribute__((__noinline__))
146 #define ALWAYSINLINE inline __attribute__((__always_inline__))
147 
148 #endif // SHARE_UTILITIES_GLOBALDEFINITIONS_XLC_HPP
</pre>
</td>
</tr>
</table>
<center><a href="globalDefinitions_visCPP.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="growableArray.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>