<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/prims/forte.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="cdsoffsets.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="jni.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/prims/forte.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2003, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  *
</pre>
<hr />
<pre>
 53   ticks_no_Java_frame         =  0,
 54   ticks_no_class_load         = -1,
 55   ticks_GC_active             = -2,
 56   ticks_unknown_not_Java      = -3,
 57   ticks_not_walkable_not_Java = -4,
 58   ticks_unknown_Java          = -5,
 59   ticks_not_walkable_Java     = -6,
 60   ticks_unknown_state         = -7,
 61   ticks_thread_exit           = -8,
 62   ticks_deopt                 = -9,
 63   ticks_safepoint             = -10
 64 };
 65 
 66 #if INCLUDE_JVMTI
 67 
 68 //-------------------------------------------------------
 69 
 70 // Native interfaces for use by Forte tools.
 71 
 72 
<span class="line-modified"> 73 #if !defined(IA64) &amp;&amp; !defined(PPC64)</span>
 74 
 75 class vframeStreamForte : public vframeStreamCommon {
 76  public:
 77   // constructor that starts with sender of frame fr (top_frame)
 78   vframeStreamForte(JavaThread *jt, frame fr, bool stop_at_java_call_stub);
 79   void forte_next();
 80 };
 81 
 82 
 83 static bool is_decipherable_compiled_frame(JavaThread* thread, frame* fr, CompiledMethod* nm);
 84 static bool is_decipherable_interpreted_frame(JavaThread* thread,
 85                                               frame* fr,
 86                                               Method** method_p,
 87                                               int* bci_p);
 88 
 89 
 90 
 91 
 92 vframeStreamForte::vframeStreamForte(JavaThread *jt,
 93                                      frame fr,
</pre>
<hr />
<pre>
622 // isn&#39;t present.
623 #ifdef __APPLE__
624 // XXXDARWIN: Link errors occur even when __attribute__((weak_import))
625 // is added
626 #define collector_func_load(x0,x1,x2,x3,x4,x5,x6) ((void) 0)
627 #else
628 void    collector_func_load(char* name,
629                             void* null_argument_1,
630                             void* null_argument_2,
631                             void *vaddr,
632                             int size,
633                             int zero_argument,
634                             void* null_argument_3);
635 #pragma weak collector_func_load
636 #define collector_func_load(x0,x1,x2,x3,x4,x5,x6) \
637         ( collector_func_load ? collector_func_load(x0,x1,x2,x3,x4,x5,x6),(void)0 : (void)0 )
638 #endif // __APPLE__
639 #endif // !_WINDOWS
640 
641 } // end extern &quot;C&quot;
<span class="line-modified">642 #endif // !IA64 &amp;&amp; !PPC64</span>
643 
644 void Forte::register_stub(const char* name, address start, address end) {
<span class="line-modified">645 #if !defined(_WINDOWS) &amp;&amp; !defined(IA64) &amp;&amp; !defined(PPC64)</span>
646   assert(pointer_delta(end, start, sizeof(jbyte)) &lt; INT_MAX,
647          &quot;Code size exceeds maximum range&quot;);
648 
649   collector_func_load((char*)name, NULL, NULL, start,
650     pointer_delta(end, start, sizeof(jbyte)), 0, NULL);
<span class="line-modified">651 #endif // !_WINDOWS &amp;&amp; !IA64 &amp;&amp; !PPC64</span>
652 }
653 
654 #else // INCLUDE_JVMTI
655 extern &quot;C&quot; {
656   JNIEXPORT
657   void AsyncGetCallTrace(ASGCT_CallTrace *trace, jint depth, void* ucontext) {
658     trace-&gt;num_frames = ticks_no_class_load; // -1
659   }
660 }
661 #endif // INCLUDE_JVMTI
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  *
</pre>
<hr />
<pre>
 53   ticks_no_Java_frame         =  0,
 54   ticks_no_class_load         = -1,
 55   ticks_GC_active             = -2,
 56   ticks_unknown_not_Java      = -3,
 57   ticks_not_walkable_not_Java = -4,
 58   ticks_unknown_Java          = -5,
 59   ticks_not_walkable_Java     = -6,
 60   ticks_unknown_state         = -7,
 61   ticks_thread_exit           = -8,
 62   ticks_deopt                 = -9,
 63   ticks_safepoint             = -10
 64 };
 65 
 66 #if INCLUDE_JVMTI
 67 
 68 //-------------------------------------------------------
 69 
 70 // Native interfaces for use by Forte tools.
 71 
 72 
<span class="line-modified"> 73 #if !defined(IA64)</span>
 74 
 75 class vframeStreamForte : public vframeStreamCommon {
 76  public:
 77   // constructor that starts with sender of frame fr (top_frame)
 78   vframeStreamForte(JavaThread *jt, frame fr, bool stop_at_java_call_stub);
 79   void forte_next();
 80 };
 81 
 82 
 83 static bool is_decipherable_compiled_frame(JavaThread* thread, frame* fr, CompiledMethod* nm);
 84 static bool is_decipherable_interpreted_frame(JavaThread* thread,
 85                                               frame* fr,
 86                                               Method** method_p,
 87                                               int* bci_p);
 88 
 89 
 90 
 91 
 92 vframeStreamForte::vframeStreamForte(JavaThread *jt,
 93                                      frame fr,
</pre>
<hr />
<pre>
622 // isn&#39;t present.
623 #ifdef __APPLE__
624 // XXXDARWIN: Link errors occur even when __attribute__((weak_import))
625 // is added
626 #define collector_func_load(x0,x1,x2,x3,x4,x5,x6) ((void) 0)
627 #else
628 void    collector_func_load(char* name,
629                             void* null_argument_1,
630                             void* null_argument_2,
631                             void *vaddr,
632                             int size,
633                             int zero_argument,
634                             void* null_argument_3);
635 #pragma weak collector_func_load
636 #define collector_func_load(x0,x1,x2,x3,x4,x5,x6) \
637         ( collector_func_load ? collector_func_load(x0,x1,x2,x3,x4,x5,x6),(void)0 : (void)0 )
638 #endif // __APPLE__
639 #endif // !_WINDOWS
640 
641 } // end extern &quot;C&quot;
<span class="line-modified">642 #endif // !IA64</span>
643 
644 void Forte::register_stub(const char* name, address start, address end) {
<span class="line-modified">645 #if !defined(_WINDOWS) &amp;&amp; !defined(IA64)</span>
646   assert(pointer_delta(end, start, sizeof(jbyte)) &lt; INT_MAX,
647          &quot;Code size exceeds maximum range&quot;);
648 
649   collector_func_load((char*)name, NULL, NULL, start,
650     pointer_delta(end, start, sizeof(jbyte)), 0, NULL);
<span class="line-modified">651 #endif // !_WINDOWS &amp;&amp; !IA64</span>
652 }
653 
654 #else // INCLUDE_JVMTI
655 extern &quot;C&quot; {
656   JNIEXPORT
657   void AsyncGetCallTrace(ASGCT_CallTrace *trace, jint depth, void* ucontext) {
658     trace-&gt;num_frames = ticks_no_class_load; // -1
659   }
660 }
661 #endif // INCLUDE_JVMTI
</pre>
</td>
</tr>
</table>
<center><a href="cdsoffsets.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="jni.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>