<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/opto/coalesce.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="classes.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="compile.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/opto/coalesce.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -600,33 +600,46 @@</span>
  
  void PhaseConservativeCoalesce::update_ifg(uint lr1, uint lr2, IndexSet *n_lr1, IndexSet *n_lr2) {
    // Some original neighbors of lr1 might have gone away
    // because the constrained register mask prevented them.
    // Remove lr1 from such neighbors.
<span class="udiff-line-modified-removed">-   IndexSetIterator one(n_lr1);</span>
<span class="udiff-line-removed">-   uint neighbor;</span>
<span class="udiff-line-modified-added">+   uint neighbor = 0;</span>
    LRG &amp;lrg1 = lrgs(lr1);
<span class="udiff-line-modified-removed">-   while ((neighbor = one.next()) != 0)</span>
<span class="udiff-line-modified-removed">-     if( !_ulr.member(neighbor) )</span>
<span class="udiff-line-modified-removed">-       if( _phc._ifg-&gt;neighbors(neighbor)-&gt;remove(lr1) )</span>
<span class="udiff-line-modified-removed">-         lrgs(neighbor).inc_degree( -lrg1.compute_degree(lrgs(neighbor)) );</span>
<span class="udiff-line-modified-added">+   if (!n_lr1-&gt;is_empty()) {</span>
<span class="udiff-line-modified-added">+     IndexSetIterator one(n_lr1);</span>
<span class="udiff-line-modified-added">+     while ((neighbor = one.next()) != 0) {</span>
<span class="udiff-line-modified-added">+       if (!_ulr.member(neighbor)) {</span>
<span class="udiff-line-added">+         if (_phc._ifg-&gt;neighbors(neighbor)-&gt;remove(lr1)) {</span>
<span class="udiff-line-added">+           lrgs(neighbor).inc_degree(-lrg1.compute_degree(lrgs(neighbor)));</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+       }</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+   }</span>
  
  
    // lr2 is now called (coalesced into) lr1.
    // Remove lr2 from the IFG.
<span class="udiff-line-removed">-   IndexSetIterator two(n_lr2);</span>
    LRG &amp;lrg2 = lrgs(lr2);
<span class="udiff-line-modified-removed">-   while ((neighbor = two.next()) != 0)</span>
<span class="udiff-line-modified-removed">-     if( _phc._ifg-&gt;neighbors(neighbor)-&gt;remove(lr2) )</span>
<span class="udiff-line-modified-removed">-       lrgs(neighbor).inc_degree( -lrg2.compute_degree(lrgs(neighbor)) );</span>
<span class="udiff-line-modified-added">+   if (!n_lr2-&gt;is_empty()) {</span>
<span class="udiff-line-modified-added">+     IndexSetIterator two(n_lr2);</span>
<span class="udiff-line-modified-added">+     while ((neighbor = two.next()) != 0) {</span>
<span class="udiff-line-added">+       if (_phc._ifg-&gt;neighbors(neighbor)-&gt;remove(lr2)) {</span>
<span class="udiff-line-added">+         lrgs(neighbor).inc_degree(-lrg2.compute_degree(lrgs(neighbor)));</span>
<span class="udiff-line-added">+       }</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+   }</span>
  
    // Some neighbors of intermediate copies now interfere with the
    // combined live range.
<span class="udiff-line-modified-removed">-   IndexSetIterator three(&amp;_ulr);</span>
<span class="udiff-line-modified-removed">-   while ((neighbor = three.next()) != 0)</span>
<span class="udiff-line-modified-removed">-     if( _phc._ifg-&gt;neighbors(neighbor)-&gt;insert(lr1) )</span>
<span class="udiff-line-modified-removed">-       lrgs(neighbor).inc_degree( lrg1.compute_degree(lrgs(neighbor)) );</span>
<span class="udiff-line-modified-added">+   if (!_ulr.is_empty()) {</span>
<span class="udiff-line-modified-added">+     IndexSetIterator three(&amp;_ulr);</span>
<span class="udiff-line-modified-added">+     while ((neighbor = three.next()) != 0) {</span>
<span class="udiff-line-modified-added">+       if (_phc._ifg-&gt;neighbors(neighbor)-&gt;insert(lr1)) {</span>
<span class="udiff-line-added">+         lrgs(neighbor).inc_degree(lrg1.compute_degree(lrgs(neighbor)));</span>
<span class="udiff-line-added">+       }</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+   }</span>
  }
  
  static void record_bias( const PhaseIFG *ifg, int lr1, int lr2 ) {
    // Tag copy bias here
    if( !ifg-&gt;lrgs(lr1)._copy_bias )
</pre>
<center><a href="classes.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="compile.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>