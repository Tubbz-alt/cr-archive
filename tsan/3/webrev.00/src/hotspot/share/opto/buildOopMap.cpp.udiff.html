<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/opto/buildOopMap.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="block.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="bytecodeInfo.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/opto/buildOopMap.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -350,11 +350,10 @@</span>
          omap-&gt;set_callee_saved( r, callee);
        }
  
      } else {
        // Other - some reaching non-oop value
<span class="udiff-line-removed">-       omap-&gt;set_value( r);</span>
  #ifdef ASSERT
        if( t-&gt;isa_rawptr() &amp;&amp; C-&gt;cfg()-&gt;_raw_oops.member(def) ) {
          def-&gt;dump();
          n-&gt;dump();
          assert(false, &quot;there should be a oop in OopMap instead of a live raw oop at safepoint&quot;);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -375,15 +374,22 @@</span>
    }
    */
  #endif
  
  #ifdef ASSERT
<span class="udiff-line-modified-removed">-   for( OopMapStream oms1(omap, OopMapValue::derived_oop_value); !oms1.is_done(); oms1.next()) {</span>
<span class="udiff-line-modified-added">+   for( OopMapStream oms1(omap); !oms1.is_done(); oms1.next()) {</span>
      OopMapValue omv1 = oms1.current();
<span class="udiff-line-added">+     if (omv1.type() != OopMapValue::derived_oop_value) {</span>
<span class="udiff-line-added">+       continue;</span>
<span class="udiff-line-added">+     }</span>
      bool found = false;
<span class="udiff-line-modified-removed">-     for( OopMapStream oms2(omap,OopMapValue::oop_value); !oms2.is_done(); oms2.next()) {</span>
<span class="udiff-line-modified-removed">-       if( omv1.content_reg() == oms2.current().reg() ) {</span>
<span class="udiff-line-modified-added">+     for( OopMapStream oms2(omap); !oms2.is_done(); oms2.next()) {</span>
<span class="udiff-line-modified-added">+       OopMapValue omv2 = oms2.current();</span>
<span class="udiff-line-added">+       if (omv2.type() != OopMapValue::oop_value) {</span>
<span class="udiff-line-added">+         continue;</span>
<span class="udiff-line-added">+       }</span>
<span class="udiff-line-added">+       if( omv1.content_reg() == omv2.reg() ) {</span>
          found = true;
          break;
        }
      }
      assert( found, &quot;derived with no base in oopmap&quot; );
</pre>
<center><a href="block.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="bytecodeInfo.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>