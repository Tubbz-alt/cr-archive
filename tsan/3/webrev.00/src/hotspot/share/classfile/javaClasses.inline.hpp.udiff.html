<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/classfile/javaClasses.inline.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="javaClasses.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="klassFactory.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/classfile/javaClasses.inline.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -43,18 +43,18 @@</span>
  void java_lang_String::set_value(oop string, typeArrayOop buffer) {
    assert(initialized &amp;&amp; (value_offset &gt; 0), &quot;Must be initialized&quot;);
    string-&gt;obj_field_put(value_offset, (oop)buffer);
  }
  
<span class="udiff-line-modified-removed">- void java_lang_String::set_hash(oop string, unsigned int hash) {</span>
<span class="udiff-line-modified-removed">-   assert(initialized &amp;&amp; (hash_offset &gt; 0), &quot;Must be initialized&quot;);</span>
<span class="udiff-line-modified-removed">-   string-&gt;int_field_put(hash_offset, hash);</span>
<span class="udiff-line-modified-added">+ bool java_lang_String::hash_is_set(oop java_string) {</span>
<span class="udiff-line-modified-added">+   assert(initialized &amp;&amp; (hash_offset &gt; 0) &amp;&amp; (hashIsZero_offset &gt; 0), &quot;Must be initialized&quot;);</span>
<span class="udiff-line-modified-added">+   return java_string-&gt;int_field(hash_offset) != 0 || java_string-&gt;bool_field(hashIsZero_offset) != 0;</span>
  }
  
  // Accessors
  bool java_lang_String::value_equals(typeArrayOop str_value1, typeArrayOop str_value2) {
<span class="udiff-line-modified-removed">-   return (oopDesc::equals(str_value1, str_value2) ||</span>
<span class="udiff-line-modified-added">+   return ((str_value1 == str_value2) ||</span>
            (str_value1-&gt;length() == str_value2-&gt;length() &amp;&amp;
             (!memcmp(str_value1-&gt;base(T_BYTE),
                      str_value2-&gt;base(T_BYTE),
                      str_value2-&gt;length() * sizeof(jbyte)))));
  }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -69,16 +69,10 @@</span>
    assert(initialized &amp;&amp; (value_offset &gt; 0), &quot;Must be initialized&quot;);
    assert(is_instance(java_string), &quot;must be java_string&quot;);
    return (typeArrayOop) java_string-&gt;obj_field_access&lt;AS_NO_KEEPALIVE&gt;(value_offset);
  }
  
<span class="udiff-line-removed">- unsigned int java_lang_String::hash(oop java_string) {</span>
<span class="udiff-line-removed">-   assert(initialized &amp;&amp; (hash_offset &gt; 0), &quot;Must be initialized&quot;);</span>
<span class="udiff-line-removed">-   assert(is_instance(java_string), &quot;must be java_string&quot;);</span>
<span class="udiff-line-removed">-   return java_string-&gt;int_field(hash_offset);</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
  bool java_lang_String::is_latin1(oop java_string) {
    assert(initialized &amp;&amp; (coder_offset &gt; 0), &quot;Must be initialized&quot;);
    assert(is_instance(java_string), &quot;must be java_string&quot;);
    jbyte coder = java_string-&gt;byte_field(coder_offset);
    assert(CompactStrings || coder == CODER_UTF16, &quot;Must be UTF16 without CompactStrings&quot;);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -183,10 +177,18 @@</span>
  
  inline bool java_lang_invoke_CallSite::is_instance(oop obj) {
    return obj != NULL &amp;&amp; is_subclass(obj-&gt;klass());
  }
  
<span class="udiff-line-added">+ inline jboolean java_lang_invoke_ConstantCallSite::is_frozen(oop site) {</span>
<span class="udiff-line-added">+   return site-&gt;bool_field(_is_frozen_offset);</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ inline bool java_lang_invoke_ConstantCallSite::is_instance(oop obj) {</span>
<span class="udiff-line-added">+   return obj != NULL &amp;&amp; is_subclass(obj-&gt;klass());</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
  inline bool java_lang_invoke_MethodHandleNatives_CallSiteContext::is_instance(oop obj) {
    return obj != NULL &amp;&amp; is_subclass(obj-&gt;klass());
  }
  
  inline bool java_lang_invoke_MemberName::is_instance(oop obj) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -268,23 +270,20 @@</span>
  
  inline int Backtrace::cpref_at(unsigned int merged) {
    return extract_low_short_from_int(merged);
  }
  
<span class="udiff-line-modified-removed">- inline int Backtrace::get_line_number(const methodHandle&amp; method, int bci) {</span>
<span class="udiff-line-modified-added">+ inline int Backtrace::get_line_number(Method* method, int bci) {</span>
    int line_number = 0;
    if (method-&gt;is_native()) {
      // Negative value different from -1 below, enabling Java code in
      // class java.lang.StackTraceElement to distinguish &quot;native&quot; from
      // &quot;no LineNumberTable&quot;.  JDK tests for -2.
      line_number = -2;
    } else {
      // Returns -1 if no LineNumberTable, and otherwise actual line number
      line_number = method-&gt;line_number_from_bci(bci);
<span class="udiff-line-removed">-     if (line_number == -1 &amp;&amp; ShowHiddenFrames) {</span>
<span class="udiff-line-removed">-       line_number = bci + 1000000;</span>
<span class="udiff-line-removed">-     }</span>
    }
    return line_number;
  }
  
  inline Symbol* Backtrace::get_source_file_name(InstanceKlass* holder, int version) {
</pre>
<center><a href="javaClasses.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="klassFactory.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>