<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/classfile/protectionDomainCache.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="placeholders.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="protectionDomainCache.hpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/classfile/protectionDomainCache.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -43,17 +43,17 @@</span>
  int ProtectionDomainCacheTable::index_for(Handle protection_domain) {
    return hash_to_index(compute_hash(protection_domain));
  }
  
  ProtectionDomainCacheTable::ProtectionDomainCacheTable(int table_size)
<span class="udiff-line-modified-removed">-   : Hashtable&lt;ClassLoaderWeakHandle, mtClass&gt;(table_size, sizeof(ProtectionDomainCacheEntry))</span>
<span class="udiff-line-modified-added">+   : Hashtable&lt;WeakHandle&lt;vm_class_loader_data&gt;, mtClass&gt;(table_size, sizeof(ProtectionDomainCacheEntry))</span>
  {   _dead_entries = false;
      _total_oops_removed = 0;
  }
  
  void ProtectionDomainCacheTable::trigger_cleanup() {
<span class="udiff-line-modified-removed">-   MutexLockerEx ml(Service_lock, Mutex::_no_safepoint_check_flag);</span>
<span class="udiff-line-modified-added">+   MutexLocker ml(Service_lock, Mutex::_no_safepoint_check_flag);</span>
    _dead_entries = true;
    Service_lock-&gt;notify_all();
  }
  
  class CleanProtectionDomainEntries : public CLDClosure {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -158,11 +158,11 @@</span>
  }
  
  ProtectionDomainCacheEntry* ProtectionDomainCacheTable::find_entry(int index, Handle protection_domain) {
    assert_locked_or_safepoint(SystemDictionary_lock);
    for (ProtectionDomainCacheEntry* e = bucket(index); e != NULL; e = e-&gt;next()) {
<span class="udiff-line-modified-removed">-     if (oopDesc::equals(e-&gt;object_no_keepalive(), protection_domain())) {</span>
<span class="udiff-line-modified-added">+     if (e-&gt;object_no_keepalive() == protection_domain()) {</span>
        return e;
      }
    }
  
    return NULL;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -178,10 +178,10 @@</span>
      LogStream ls(lt);
      ls.print(&quot;protection domain added &quot;);
      protection_domain-&gt;print_value_on(&amp;ls);
      ls.cr();
    }
<span class="udiff-line-modified-removed">-   ClassLoaderWeakHandle w = ClassLoaderWeakHandle::create(protection_domain);</span>
<span class="udiff-line-modified-added">+   WeakHandle&lt;vm_class_loader_data&gt; w = WeakHandle&lt;vm_class_loader_data&gt;::create(protection_domain);</span>
    ProtectionDomainCacheEntry* p = new_entry(hash, w);
<span class="udiff-line-modified-removed">-   Hashtable&lt;ClassLoaderWeakHandle, mtClass&gt;::add_entry(index, p);</span>
<span class="udiff-line-modified-added">+   Hashtable&lt;WeakHandle&lt;vm_class_loader_data&gt;, mtClass&gt;::add_entry(index, p);</span>
    return p;
  }
</pre>
<center><a href="placeholders.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="protectionDomainCache.hpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>