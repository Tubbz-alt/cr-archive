<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/os/aix/libodm_aix.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="libodm_aix.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="loadlib_aix.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/os/aix/libodm_aix.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,8 ***</span>
  /*
   * Copyright (c) 2015, 2019, Oracle and/or its affiliates. All rights reserved.
<span class="line-modified">!  * Copyright (c) 2015, 2015 SAP SE. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,8 ---</span>
  /*
   * Copyright (c) 2015, 2019, Oracle and/or its affiliates. All rights reserved.
<span class="line-modified">!  * Copyright (c) 2015, 2019 SAP SE. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 66,31 ***</span>
    bool _initialized;
    void clean_data();
  
   public:
    // Make sure everything gets initialized and cleaned up properly.
<span class="line-modified">!   explicit odmWrapper(char* odm_class_name, char* odm_path = NULL) : _odm_class((CLASS_SYMBOL)-1),</span>
                                                                       _data(NULL), _initialized(false) {
      if (!odm_loaded()) { return; }
      _initialized = ((*_odm_initialize)() != -1);
      if (_initialized) {
<span class="line-modified">!       if (odm_path) { (*_odm_set_path)(odm_path); }</span>
<span class="line-modified">!       _odm_class = (*_odm_mount_class)(odm_class_name);</span>
      }
    }
    ~odmWrapper() {
      if (_initialized) { (*_odm_terminate)(); clean_data(); }
    }
  
    CLASS_SYMBOL odm_class() { return _odm_class; }
    bool has_class() { return odm_class() != (CLASS_SYMBOL)-1; }
<span class="line-modified">!   int class_offset(char *field, bool is_aix_5);</span>
    char* data() { return _data; }
  
<span class="line-modified">!   char* retrieve_obj(char* name = NULL) {</span>
      clean_data();
<span class="line-modified">!     char *cnp = (char*)(void*)(*_odm_get_obj)(odm_class(), name, NULL, (name == NULL) ? ODM_NEXT : ODM_FIRST);</span>
      if (cnp != (char*)-1) { _data = cnp; }
      return data();
    }
  
    int read_short(int offs) {
<span class="line-new-header">--- 66,33 ---</span>
    bool _initialized;
    void clean_data();
  
   public:
    // Make sure everything gets initialized and cleaned up properly.
<span class="line-modified">!   explicit odmWrapper(const char* odm_class_name, const char* odm_path = NULL) : _odm_class((CLASS_SYMBOL)-1),</span>
                                                                       _data(NULL), _initialized(false) {
      if (!odm_loaded()) { return; }
      _initialized = ((*_odm_initialize)() != -1);
      if (_initialized) {
<span class="line-modified">!       // should we free what odm_set_path returns, man page suggests it</span>
<span class="line-modified">!       // see https://www.ibm.com/support/knowledgecenter/en/ssw_aix_71/o_bostechref/odm_set_path.html</span>
<span class="line-added">+       if (odm_path) { (*_odm_set_path)((char*)odm_path); }</span>
<span class="line-added">+       _odm_class = (*_odm_mount_class)((char*)odm_class_name);</span>
      }
    }
    ~odmWrapper() {
      if (_initialized) { (*_odm_terminate)(); clean_data(); }
    }
  
    CLASS_SYMBOL odm_class() { return _odm_class; }
    bool has_class() { return odm_class() != (CLASS_SYMBOL)-1; }
<span class="line-modified">!   int class_offset(const char *field, bool is_aix_5);</span>
    char* data() { return _data; }
  
<span class="line-modified">!   char* retrieve_obj(const char* name = NULL) {</span>
      clean_data();
<span class="line-modified">!     char *cnp = (char*)(void*)(*_odm_get_obj)(odm_class(), (char*) name, NULL, (name == NULL) ? ODM_NEXT : ODM_FIRST);</span>
      if (cnp != (char*)-1) { _data = cnp; }
      return data();
    }
  
    int read_short(int offs) {
</pre>
<center><a href="libodm_aix.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="loadlib_aix.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>