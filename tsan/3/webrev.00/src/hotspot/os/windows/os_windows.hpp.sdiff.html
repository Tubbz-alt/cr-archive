<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/os/windows/os_windows.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="os_windows.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="os_windows.inline.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/os/windows/os_windows.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 38 // File conventions
 39 static const char* file_separator() { return &quot;\\&quot;; }
 40 static const char* line_separator() { return &quot;\r\n&quot;; }
 41 static const char* path_separator() { return &quot;;&quot;; }
 42 
 43 class win32 {
 44   friend class os;
 45   friend unsigned __stdcall thread_native_entry(class Thread*);
 46 
 47  protected:
 48   static int    _vm_page_size;
 49   static int    _vm_allocation_granularity;
 50   static int    _processor_type;
 51   static int    _processor_level;
 52   static julong _physical_memory;
 53   static size_t _default_stack_size;
 54   static bool   _is_windows_server;
 55   static bool   _has_exit_bug;
 56 
 57   static void print_windows_version(outputStream* st);

 58 
 59  public:
 60   // Windows-specific interface:
 61   static void   initialize_system_info();
 62   static void   setmode_streams();
 63 
 64   // Processor info as provided by NT
 65   static int processor_type()  { return _processor_type;  }
 66   static int processor_level() {
 67     return _processor_level;
 68   }
 69   static julong available_memory();
 70   static julong physical_memory() { return _physical_memory; }
 71 
 72   // load dll from Windows system directory or Windows directory
 73   static HINSTANCE load_Windows_dll(const char* name, char *ebuf, int ebuflen);
 74 
 75  private:
 76   enum Ept { EPT_THREAD, EPT_PROCESS, EPT_PROCESS_DIE };
 77   // Wrapper around _endthreadex(), exit() and _exit()
</pre>
<hr />
<pre>
170     void park () ;
171     void unpark () ;
172     int  park (jlong millis) ;
173 } ;
174 
175 
176 
177 class PlatformParker : public CHeapObj&lt;mtSynchronizer&gt; {
178   protected:
179     HANDLE _ParkEvent ;
180 
181   public:
182     ~PlatformParker () { guarantee (0, &quot;invariant&quot;) ; }
183     PlatformParker  () {
184       _ParkEvent = CreateEvent (NULL, true, false, NULL) ;
185       guarantee (_ParkEvent != NULL, &quot;invariant&quot;) ;
186     }
187 
188 } ;
189 
<span class="line-modified">190 // Platform specific implementation that underpins VM Monitor/Mutex class</span>
<span class="line-modified">191 class PlatformMonitor : public CHeapObj&lt;mtSynchronizer&gt; {</span>
<span class="line-modified">192  private:</span>



193   CRITICAL_SECTION   _mutex; // Native mutex for locking
<span class="line-removed">194   CONDITION_VARIABLE _cond;  // Native condition variable for blocking</span>
195 
196  public:
<span class="line-modified">197   PlatformMonitor();</span>
<span class="line-modified">198   ~PlatformMonitor();</span>
199   void lock();
200   void unlock();
201   bool try_lock();










202   int wait(jlong millis);
203   void notify();
204   void notify_all();
205 };
206 
207 #endif // OS_WINDOWS_OS_WINDOWS_HPP
</pre>
</td>
<td>
<hr />
<pre>
 38 // File conventions
 39 static const char* file_separator() { return &quot;\\&quot;; }
 40 static const char* line_separator() { return &quot;\r\n&quot;; }
 41 static const char* path_separator() { return &quot;;&quot;; }
 42 
 43 class win32 {
 44   friend class os;
 45   friend unsigned __stdcall thread_native_entry(class Thread*);
 46 
 47  protected:
 48   static int    _vm_page_size;
 49   static int    _vm_allocation_granularity;
 50   static int    _processor_type;
 51   static int    _processor_level;
 52   static julong _physical_memory;
 53   static size_t _default_stack_size;
 54   static bool   _is_windows_server;
 55   static bool   _has_exit_bug;
 56 
 57   static void print_windows_version(outputStream* st);
<span class="line-added"> 58   static void print_uptime_info(outputStream* st);</span>
 59 
 60  public:
 61   // Windows-specific interface:
 62   static void   initialize_system_info();
 63   static void   setmode_streams();
 64 
 65   // Processor info as provided by NT
 66   static int processor_type()  { return _processor_type;  }
 67   static int processor_level() {
 68     return _processor_level;
 69   }
 70   static julong available_memory();
 71   static julong physical_memory() { return _physical_memory; }
 72 
 73   // load dll from Windows system directory or Windows directory
 74   static HINSTANCE load_Windows_dll(const char* name, char *ebuf, int ebuflen);
 75 
 76  private:
 77   enum Ept { EPT_THREAD, EPT_PROCESS, EPT_PROCESS_DIE };
 78   // Wrapper around _endthreadex(), exit() and _exit()
</pre>
<hr />
<pre>
171     void park () ;
172     void unpark () ;
173     int  park (jlong millis) ;
174 } ;
175 
176 
177 
178 class PlatformParker : public CHeapObj&lt;mtSynchronizer&gt; {
179   protected:
180     HANDLE _ParkEvent ;
181 
182   public:
183     ~PlatformParker () { guarantee (0, &quot;invariant&quot;) ; }
184     PlatformParker  () {
185       _ParkEvent = CreateEvent (NULL, true, false, NULL) ;
186       guarantee (_ParkEvent != NULL, &quot;invariant&quot;) ;
187     }
188 
189 } ;
190 
<span class="line-modified">191 // Platform specific implementations that underpin VM Mutex/Monitor classes</span>
<span class="line-modified">192 </span>
<span class="line-modified">193 class PlatformMutex : public CHeapObj&lt;mtSynchronizer&gt; {</span>
<span class="line-added">194   NONCOPYABLE(PlatformMutex);</span>
<span class="line-added">195 </span>
<span class="line-added">196  protected:</span>
197   CRITICAL_SECTION   _mutex; // Native mutex for locking

198 
199  public:
<span class="line-modified">200   PlatformMutex();</span>
<span class="line-modified">201   ~PlatformMutex();</span>
202   void lock();
203   void unlock();
204   bool try_lock();
<span class="line-added">205 };</span>
<span class="line-added">206 </span>
<span class="line-added">207 class PlatformMonitor : public PlatformMutex {</span>
<span class="line-added">208  private:</span>
<span class="line-added">209   CONDITION_VARIABLE _cond;  // Native condition variable for blocking</span>
<span class="line-added">210   NONCOPYABLE(PlatformMonitor);</span>
<span class="line-added">211 </span>
<span class="line-added">212  public:</span>
<span class="line-added">213   PlatformMonitor();</span>
<span class="line-added">214   ~PlatformMonitor();</span>
215   int wait(jlong millis);
216   void notify();
217   void notify_all();
218 };
219 
220 #endif // OS_WINDOWS_OS_WINDOWS_HPP
</pre>
</td>
</tr>
</table>
<center><a href="os_windows.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="os_windows.inline.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>