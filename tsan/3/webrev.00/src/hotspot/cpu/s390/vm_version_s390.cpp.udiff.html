<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/cpu/s390/vm_version_s390.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="vm_version_ext_s390.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="vm_version_s390.hpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/s390/vm_version_s390.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -29,11 +29,11 @@</span>
  #include &quot;compiler/disassembler.hpp&quot;
  #include &quot;code/compiledIC.hpp&quot;
  #include &quot;memory/resourceArea.hpp&quot;
  #include &quot;runtime/java.hpp&quot;
  #include &quot;runtime/stubCodeGenerator.hpp&quot;
<span class="udiff-line-modified-removed">- #include &quot;vm_version_s390.hpp&quot;</span>
<span class="udiff-line-modified-added">+ #include &quot;runtime/vm_version.hpp&quot;</span>
  
  # include &lt;sys/sysinfo.h&gt;
  
  bool VM_Version::_is_determine_features_test_running  = false;
  const char*   VM_Version::_model_string;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -42,12 +42,12 @@</span>
  unsigned long VM_Version::_cipher_features[_features_buffer_len]    = {0, 0, 0, 0};
  unsigned long VM_Version::_msgdigest_features[_features_buffer_len] = {0, 0, 0, 0};
  unsigned int  VM_Version::_nfeatures                                = 0;
  unsigned int  VM_Version::_ncipher_features                         = 0;
  unsigned int  VM_Version::_nmsgdigest_features                      = 0;
<span class="udiff-line-modified-removed">- unsigned int  VM_Version::_Dcache_lineSize                          = 256;</span>
<span class="udiff-line-modified-removed">- unsigned int  VM_Version::_Icache_lineSize                          = 256;</span>
<span class="udiff-line-modified-added">+ unsigned int  VM_Version::_Dcache_lineSize                          = DEFAULT_CACHE_LINE_SIZE;</span>
<span class="udiff-line-modified-added">+ unsigned int  VM_Version::_Icache_lineSize                          = DEFAULT_CACHE_LINE_SIZE;</span>
  
  static const char* z_gen[]     = {&quot;  &quot;,   &quot;G1&quot;,   &quot;G2&quot;, &quot;G3&quot;,    &quot;G4&quot;,     &quot;G5&quot;,      &quot;G6&quot;,   &quot;G7&quot;   };
  static const char* z_machine[] = {&quot;  &quot;, &quot;2064&quot;, &quot;2084&quot;, &quot;2094&quot;,  &quot;2097&quot;,   &quot;2817&quot;,    &quot;  &quot;,   &quot;2964&quot; };
  static const char* z_name[]    = {&quot;  &quot;, &quot;z900&quot;, &quot;z990&quot;, &quot;z9 EC&quot;, &quot;z10 EC&quot;, &quot;z196 EC&quot;, &quot;ec12&quot;, &quot;z13&quot;  };
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -59,11 +59,13 @@</span>
      print_features();
    }
  
    intx cache_line_size = Dcache_lineSize(0);
  
<span class="udiff-line-added">+ #ifdef COMPILER2</span>
    MaxVectorSize = 8;
<span class="udiff-line-added">+ #endif</span>
  
    if (has_PrefetchRaw()) {
      if (FLAG_IS_DEFAULT(AllocatePrefetchStyle)) {  // not preset
        // 0 = no prefetch.
        // 1 = Prefetch instructions for each allocation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -215,19 +217,21 @@</span>
  
    if (!(UseSHA1Intrinsics || UseSHA256Intrinsics || UseSHA512Intrinsics)) {
      FLAG_SET_DEFAULT(UseSHA, false);
    }
  
<span class="udiff-line-added">+ #ifdef COMPILER2</span>
    if (FLAG_IS_DEFAULT(UseMultiplyToLenIntrinsic)) {
      FLAG_SET_DEFAULT(UseMultiplyToLenIntrinsic, true);
    }
    if (FLAG_IS_DEFAULT(UseMontgomeryMultiplyIntrinsic)) {
      FLAG_SET_DEFAULT(UseMontgomeryMultiplyIntrinsic, true);
    }
    if (FLAG_IS_DEFAULT(UseMontgomerySquareIntrinsic)) {
      FLAG_SET_DEFAULT(UseMontgomerySquareIntrinsic, true);
    }
<span class="udiff-line-added">+ #endif</span>
    if (FLAG_IS_DEFAULT(UsePopCountInstruction)) {
      FLAG_SET_DEFAULT(UsePopCountInstruction, true);
    }
  
    // z/Architecture supports 8-byte compare-exchange operations
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -514,10 +518,23 @@</span>
        tty-&gt;print_cr(&quot;ContendedPaddingWidth &quot; INTX_FORMAT, ContendedPaddingWidth);
      }
    }
  }
  
<span class="udiff-line-added">+ void VM_Version::print_platform_virtualization_info(outputStream* st) {</span>
<span class="udiff-line-added">+   // /proc/sysinfo contains interesting information about</span>
<span class="udiff-line-added">+   // - LPAR</span>
<span class="udiff-line-added">+   // - whole &quot;Box&quot; (CPUs )</span>
<span class="udiff-line-added">+   // - z/VM / KVM (VM&lt;nn&gt;); this is not available in an LPAR-only setup</span>
<span class="udiff-line-added">+   const char* kw[] = { &quot;LPAR&quot;, &quot;CPUs&quot;, &quot;VM&quot;, NULL };</span>
<span class="udiff-line-added">+   const char* info_file = &quot;/proc/sysinfo&quot;;</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   if (!print_matching_lines_from_file(info_file, st, kw)) {</span>
<span class="udiff-line-added">+     st-&gt;print_cr(&quot;  &lt;%s Not Available&gt;&quot;, info_file);</span>
<span class="udiff-line-added">+   }</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
  void VM_Version::print_features() {
    print_features_internal(&quot;Version:&quot;);
  }
  
  void VM_Version::reset_features(bool reset) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -789,20 +806,22 @@</span>
    a-&gt;z_br(Z_R14);
  
    address code_end = a-&gt;pc();
    a-&gt;flush();
  
<span class="udiff-line-added">+   cbuf.insts()-&gt;set_end(code_end);</span>
<span class="udiff-line-added">+ </span>
    // Print the detection code.
    bool printVerbose = Verbose || PrintAssembly || PrintStubCode;
    if (printVerbose) {
      ttyLocker ttyl;
      tty-&gt;print_cr(&quot;Decoding CPU feature detection stub at &quot; INTPTR_FORMAT &quot; before execution:&quot;, p2i(code));
      tty-&gt;print_cr(&quot;Stub length is %ld bytes, codebuffer reserves %d bytes, %ld bytes spare.&quot;,
                    code_end-code, cbuf_size, cbuf_size-(code_end-code));
  
<span class="udiff-line-modified-removed">-     // Use existing decode function. This enables the [Code] format which is needed to DecodeErrorFile.</span>
<span class="udiff-line-modified-removed">-     Disassembler::decode((u_char*)code, (u_char*)code_end, tty);</span>
<span class="udiff-line-modified-added">+     // Use existing decode function. This enables the [MachCode] format which is needed to DecodeErrorFile.</span>
<span class="udiff-line-modified-added">+     Disassembler::decode(&amp;cbuf, code, code_end, tty);</span>
    }
  
    // Prepare for detection code execution and clear work buffer.
    _nfeatures        = 0;
    _ncipher_features = 0;
</pre>
<center><a href="vm_version_ext_s390.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="vm_version_s390.hpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>