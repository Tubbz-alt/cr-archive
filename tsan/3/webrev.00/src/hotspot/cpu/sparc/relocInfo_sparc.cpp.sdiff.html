<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/cpu/sparc/relocInfo_sparc.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="nativeInst_sparc.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="sharedRuntime_sparc.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/sparc/relocInfo_sparc.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 81     {
 82     guarantee(Assembler::inv_immed(inst), &quot;must have a simm13 field&quot;);
 83     int simm13 = Assembler::low10((intptr_t)x) + o;
 84     guarantee(Assembler::is_simm13(simm13), &quot;offset can&#39;t overflow simm13&quot;);
 85     inst &amp;= ~Assembler::simm(    -1, 13);
 86     inst |=  Assembler::simm(simm13, 13);
 87     if (verify_only) {
 88       guarantee(ip-&gt;long_at(0) == inst, &quot;instructions must match&quot;);
 89     } else {
 90       ip-&gt;set_long_at(0, inst);
 91     }
 92     }
 93     break;
 94 
 95   case Assembler::branch_op:
 96     {
 97     jint inst2;
 98     guarantee(Assembler::inv_op2(inst)==Assembler::sethi_op2, &quot;must be sethi&quot;);
 99     if (format() != 0) {
100       assert(type() == relocInfo::oop_type || type() == relocInfo::metadata_type, &quot;only narrow oops or klasses case&quot;);
<span class="line-modified">101       jint np = type() == relocInfo::oop_type ? CompressedOops::encode((oop)x) : Klass::encode_klass((Klass*)x);</span>
102       inst &amp;= ~Assembler::hi22(-1);
103       inst |=  Assembler::hi22((intptr_t)np);
104       if (verify_only) {
105         guarantee(ip-&gt;long_at(0) == inst, &quot;instructions must match&quot;);
106       } else {
107         ip-&gt;set_long_at(0, inst);
108       }
109       inst2 = ip-&gt;long_at( NativeInstruction::nop_instruction_size );
110       guarantee(Assembler::inv_op(inst2)==Assembler::arith_op, &quot;arith op&quot;);
111       if (verify_only) {
112         guarantee(ip-&gt;long_at(NativeInstruction::nop_instruction_size) == NativeInstruction::set_data32_simm13( inst2, (intptr_t)np),
113                   &quot;instructions must match&quot;);
114       } else {
115         ip-&gt;set_long_at(NativeInstruction::nop_instruction_size, NativeInstruction::set_data32_simm13( inst2, (intptr_t)np));
116       }
117       break;
118     }
119     if (verify_only) {
120       ip-&gt;verify_data64_sethi( ip-&gt;addr_at(0), (intptr_t)x );
121     } else {
</pre>
</td>
<td>
<hr />
<pre>
 81     {
 82     guarantee(Assembler::inv_immed(inst), &quot;must have a simm13 field&quot;);
 83     int simm13 = Assembler::low10((intptr_t)x) + o;
 84     guarantee(Assembler::is_simm13(simm13), &quot;offset can&#39;t overflow simm13&quot;);
 85     inst &amp;= ~Assembler::simm(    -1, 13);
 86     inst |=  Assembler::simm(simm13, 13);
 87     if (verify_only) {
 88       guarantee(ip-&gt;long_at(0) == inst, &quot;instructions must match&quot;);
 89     } else {
 90       ip-&gt;set_long_at(0, inst);
 91     }
 92     }
 93     break;
 94 
 95   case Assembler::branch_op:
 96     {
 97     jint inst2;
 98     guarantee(Assembler::inv_op2(inst)==Assembler::sethi_op2, &quot;must be sethi&quot;);
 99     if (format() != 0) {
100       assert(type() == relocInfo::oop_type || type() == relocInfo::metadata_type, &quot;only narrow oops or klasses case&quot;);
<span class="line-modified">101       jint np = type() == relocInfo::oop_type ? CompressedOops::encode((oop)x) : CompressedKlassPointers::encode((Klass*)x);</span>
102       inst &amp;= ~Assembler::hi22(-1);
103       inst |=  Assembler::hi22((intptr_t)np);
104       if (verify_only) {
105         guarantee(ip-&gt;long_at(0) == inst, &quot;instructions must match&quot;);
106       } else {
107         ip-&gt;set_long_at(0, inst);
108       }
109       inst2 = ip-&gt;long_at( NativeInstruction::nop_instruction_size );
110       guarantee(Assembler::inv_op(inst2)==Assembler::arith_op, &quot;arith op&quot;);
111       if (verify_only) {
112         guarantee(ip-&gt;long_at(NativeInstruction::nop_instruction_size) == NativeInstruction::set_data32_simm13( inst2, (intptr_t)np),
113                   &quot;instructions must match&quot;);
114       } else {
115         ip-&gt;set_long_at(NativeInstruction::nop_instruction_size, NativeInstruction::set_data32_simm13( inst2, (intptr_t)np));
116       }
117       break;
118     }
119     if (verify_only) {
120       ip-&gt;verify_data64_sethi( ip-&gt;addr_at(0), (intptr_t)x );
121     } else {
</pre>
</td>
</tr>
</table>
<center><a href="nativeInst_sparc.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="sharedRuntime_sparc.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>