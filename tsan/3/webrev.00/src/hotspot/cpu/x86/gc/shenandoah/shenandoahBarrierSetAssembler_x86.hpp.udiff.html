<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/cpu/x86/gc/shenandoah/shenandoahBarrierSetAssembler_x86.hpp</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="shenandoahBarrierSetAssembler_x86.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="shenandoah_x86_64.ad.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/x86/gc/shenandoah/shenandoahBarrierSetAssembler_x86.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,8 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2018, Red Hat, Inc. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2018, 2019, Red Hat, Inc. All rights reserved.</span>
<span class="udiff-line-added">+  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.</span>
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
   *
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -27,19 +28,19 @@</span>
  #include &quot;asm/macroAssembler.hpp&quot;
  #include &quot;gc/shared/barrierSetAssembler.hpp&quot;
  #ifdef COMPILER1
  class LIR_Assembler;
  class ShenandoahPreBarrierStub;
<span class="udiff-line-modified-removed">- class ShenandoahWriteBarrierStub;</span>
<span class="udiff-line-modified-added">+ class ShenandoahLoadReferenceBarrierStub;</span>
  class StubAssembler;
<span class="udiff-line-removed">- class StubCodeGenerator;</span>
  #endif
<span class="udiff-line-added">+ class StubCodeGenerator;</span>
  
  class ShenandoahBarrierSetAssembler: public BarrierSetAssembler {
  private:
  
<span class="udiff-line-modified-removed">-   static address _shenandoah_wb;</span>
<span class="udiff-line-modified-added">+   static address _shenandoah_lrb;</span>
  
    void satb_write_barrier_pre(MacroAssembler* masm,
                                Register obj,
                                Register pre_val,
                                Register thread,
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -53,67 +54,41 @@</span>
                                      Register thread,
                                      Register tmp,
                                      bool tosca_live,
                                      bool expand_call);
  
<span class="udiff-line-modified-removed">-   void read_barrier(MacroAssembler* masm, Register dst);</span>
<span class="udiff-line-removed">-   void read_barrier_impl(MacroAssembler* masm, Register dst);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-   void read_barrier_not_null(MacroAssembler* masm, Register dst);</span>
<span class="udiff-line-removed">-   void read_barrier_not_null_impl(MacroAssembler* masm, Register dst);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-   void write_barrier(MacroAssembler* masm, Register dst);</span>
<span class="udiff-line-removed">-   void write_barrier_impl(MacroAssembler* masm, Register dst);</span>
<span class="udiff-line-modified-added">+   void load_reference_barrier_not_null(MacroAssembler* masm, Register dst, Address src);</span>
  
    void storeval_barrier_impl(MacroAssembler* masm, Register dst, Register tmp);
  
<span class="udiff-line-modified-removed">-   address generate_shenandoah_wb(StubCodeGenerator* cgen);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-   void save_vector_registers(MacroAssembler* masm);</span>
<span class="udiff-line-removed">-   void restore_vector_registers(MacroAssembler* masm);</span>
<span class="udiff-line-modified-added">+   address generate_shenandoah_lrb(StubCodeGenerator* cgen);</span>
  
  public:
<span class="udiff-line-modified-removed">-   static address shenandoah_wb();</span>
<span class="udiff-line-modified-added">+   static address shenandoah_lrb();</span>
  
    void storeval_barrier(MacroAssembler* masm, Register dst, Register tmp);
  #ifdef COMPILER1
    void gen_pre_barrier_stub(LIR_Assembler* ce, ShenandoahPreBarrierStub* stub);
<span class="udiff-line-modified-removed">-   void gen_write_barrier_stub(LIR_Assembler* ce, ShenandoahWriteBarrierStub* stub);</span>
<span class="udiff-line-modified-added">+   void gen_load_reference_barrier_stub(LIR_Assembler* ce, ShenandoahLoadReferenceBarrierStub* stub);</span>
    void generate_c1_pre_barrier_runtime_stub(StubAssembler* sasm);
<span class="udiff-line-added">+   void generate_c1_load_reference_barrier_runtime_stub(StubAssembler* sasm, bool is_native);</span>
  #endif
  
<span class="udiff-line-added">+   void load_reference_barrier(MacroAssembler* masm, Register dst, Address src);</span>
<span class="udiff-line-added">+   void load_reference_barrier_native(MacroAssembler* masm, Register dst, Address src);</span>
<span class="udiff-line-added">+ </span>
    void cmpxchg_oop(MacroAssembler* masm,
                     Register res, Address addr, Register oldval, Register newval,
                     bool exchange, Register tmp1, Register tmp2);
    virtual void arraycopy_prologue(MacroAssembler* masm, DecoratorSet decorators, BasicType type,
                                    Register src, Register dst, Register count);
<span class="udiff-line-removed">-   virtual void arraycopy_epilogue(MacroAssembler* masm, DecoratorSet decorators, BasicType type,</span>
<span class="udiff-line-removed">-                                   Register src, Register dst, Register count);</span>
    virtual void load_at(MacroAssembler* masm, DecoratorSet decorators, BasicType type,
                         Register dst, Address src, Register tmp1, Register tmp_thread);
    virtual void store_at(MacroAssembler* masm, DecoratorSet decorators, BasicType type,
                          Address dst, Register val, Register tmp1, Register tmp2);
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">- #ifndef _LP64</span>
<span class="udiff-line-removed">-   virtual void obj_equals(MacroAssembler* masm,</span>
<span class="udiff-line-removed">-                           Address obj1, jobject obj2);</span>
<span class="udiff-line-removed">-   virtual void obj_equals(MacroAssembler* masm,</span>
<span class="udiff-line-removed">-                           Register obj1, jobject obj2);</span>
<span class="udiff-line-removed">- #endif</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-   virtual void obj_equals(MacroAssembler* masm, Register src1, Register src2);</span>
<span class="udiff-line-removed">-   virtual void obj_equals(MacroAssembler* masm, Register src1, Address src2);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-   virtual void tlab_allocate(MacroAssembler* masm,</span>
<span class="udiff-line-removed">-                              Register thread, Register obj,</span>
<span class="udiff-line-removed">-                              Register var_size_in_bytes,</span>
<span class="udiff-line-removed">-                              int con_size_in_bytes,</span>
<span class="udiff-line-removed">-                              Register t1, Register t2,</span>
<span class="udiff-line-removed">-                              Label&amp; slow_case);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-   virtual void resolve(MacroAssembler* masm, DecoratorSet decorators, Register obj);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-modified-added">+   virtual void try_resolve_jobject_in_native(MacroAssembler* masm, Register jni_env,</span>
<span class="udiff-line-modified-added">+                                              Register obj, Register tmp, Label&amp; slowpath);</span>
    virtual void barrier_stubs_init();
  
  };
  
  #endif // CPU_X86_GC_SHENANDOAH_SHENANDOAHBARRIERSETASSEMBLER_X86_HPP
</pre>
<center><a href="shenandoahBarrierSetAssembler_x86.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="shenandoah_x86_64.ad.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>