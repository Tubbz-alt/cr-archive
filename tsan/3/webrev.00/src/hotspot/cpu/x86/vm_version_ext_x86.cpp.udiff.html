<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/cpu/x86/vm_version_ext_x86.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="templateTable_x86.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="vm_version_ext_x86.hpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/x86/vm_version_ext_x86.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2013, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2013, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -41,14 +41,14 @@</span>
     CPU_FAMILY_PENTIUM    = 5,
     CPU_FAMILY_PENTIUMPRO = 6,    // Same family several models
     CPU_FAMILY_PENTIUM_4  = 0xF
  } FamilyFlag;
  
<span class="udiff-line-modified-removed">-  typedef enum {</span>
<span class="udiff-line-modified-removed">-     RDTSCP_FLAG  = 0x08000000, // bit 27</span>
<span class="udiff-line-modified-removed">-     INTEL64_FLAG = 0x20000000  // bit 29</span>
<span class="udiff-line-modified-removed">-   } _featureExtendedEdxFlag;</span>
<span class="udiff-line-modified-added">+ typedef enum {</span>
<span class="udiff-line-modified-added">+   RDTSCP_FLAG  = 0x08000000, // bit 27</span>
<span class="udiff-line-modified-added">+   INTEL64_FLAG = 0x20000000  // bit 29</span>
<span class="udiff-line-modified-added">+ } _featureExtendedEdxFlag;</span>
  
  #define CPUID_STANDARD_FN   0x0
  #define CPUID_STANDARD_FN_1 0x1
  #define CPUID_STANDARD_FN_4 0x4
  #define CPUID_STANDARD_FN_B 0xb
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -338,10 +338,14 @@</span>
  
    if (is_amd()) {
      return !is_amd_Barcelona();
    }
  
<span class="udiff-line-added">+   if (is_hygon()) {</span>
<span class="udiff-line-added">+     return true;</span>
<span class="udiff-line-added">+   }</span>
<span class="udiff-line-added">+ </span>
    return false;
  }
  
  void VM_Version_Ext::resolve_cpu_information_details(void) {
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -397,17 +401,24 @@</span>
  }
  
  const char* VM_Version_Ext::cpu_family_description(void) {
    int cpu_family_id = extended_cpu_family();
    if (is_amd()) {
<span class="udiff-line-modified-removed">-     return _family_id_amd[cpu_family_id];</span>
<span class="udiff-line-modified-added">+     if (cpu_family_id &lt; ExtendedFamilyIdLength_AMD) {</span>
<span class="udiff-line-added">+       return _family_id_amd[cpu_family_id];</span>
<span class="udiff-line-added">+     }</span>
    }
    if (is_intel()) {
      if (cpu_family_id == CPU_FAMILY_PENTIUMPRO) {
        return cpu_model_description();
      }
<span class="udiff-line-modified-removed">-     return _family_id_intel[cpu_family_id];</span>
<span class="udiff-line-modified-added">+     if (cpu_family_id &lt; ExtendedFamilyIdLength_INTEL) {</span>
<span class="udiff-line-added">+       return _family_id_intel[cpu_family_id];</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+   }</span>
<span class="udiff-line-added">+   if (is_hygon()) {</span>
<span class="udiff-line-added">+     return &quot;Dhyana&quot;;</span>
    }
    return &quot;Unknown x86&quot;;
  }
  
  int VM_Version_Ext::cpu_type_description(char* const buf, size_t buf_len) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -421,10 +432,13 @@</span>
      cpu_type = &quot;Intel&quot;;
      x64 = cpu_is_em64t() ? &quot; Intel64&quot; : &quot;&quot;;
    } else if (is_amd()) {
      cpu_type = &quot;AMD&quot;;
      x64 = cpu_is_em64t() ? &quot; AMD64&quot; : &quot;&quot;;
<span class="udiff-line-added">+   } else if (is_hygon()) {</span>
<span class="udiff-line-added">+     cpu_type = &quot;Hygon&quot;;</span>
<span class="udiff-line-added">+     x64 = cpu_is_em64t() ? &quot; AMD64&quot; : &quot;&quot;;</span>
    } else {
      cpu_type = &quot;Unknown x86&quot;;
      x64 = cpu_is_em64t() ? &quot; x86_64&quot; : &quot;&quot;;
    }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -692,11 +706,11 @@</span>
      _max_qualified_cpu_frequency = max_qualified_cpu_freq_from_brand_string();
    }
    return _max_qualified_cpu_frequency;
  }
  
<span class="udiff-line-modified-removed">- const char* const VM_Version_Ext::_family_id_intel[] = {</span>
<span class="udiff-line-modified-added">+ const char* const VM_Version_Ext::_family_id_intel[ExtendedFamilyIdLength_INTEL] = {</span>
    &quot;8086/8088&quot;,
    &quot;&quot;,
    &quot;286&quot;,
    &quot;386&quot;,
    &quot;486&quot;,
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -711,11 +725,11 @@</span>
    &quot;&quot;,
    &quot;&quot;,
    &quot;Pentium 4&quot;
  };
  
<span class="udiff-line-modified-removed">- const char* const VM_Version_Ext::_family_id_amd[] = {</span>
<span class="udiff-line-modified-added">+ const char* const VM_Version_Ext::_family_id_amd[ExtendedFamilyIdLength_AMD] = {</span>
    &quot;&quot;,
    &quot;&quot;,
    &quot;&quot;,
    &quot;&quot;,
    &quot;5x86&quot;,
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -729,10 +743,17 @@</span>
    &quot;&quot;,
    &quot;&quot;,
    &quot;&quot;,
    &quot;Opteron/Athlon64&quot;,
    &quot;Opteron QC/Phenom&quot;  // Barcelona et.al.
<span class="udiff-line-added">+   &quot;&quot;,</span>
<span class="udiff-line-added">+   &quot;&quot;,</span>
<span class="udiff-line-added">+   &quot;&quot;,</span>
<span class="udiff-line-added">+   &quot;&quot;,</span>
<span class="udiff-line-added">+   &quot;&quot;,</span>
<span class="udiff-line-added">+   &quot;&quot;,</span>
<span class="udiff-line-added">+   &quot;Zen&quot;</span>
  };
  // Partially from Intel 64 and IA-32 Architecture Software Developer&#39;s Manual,
  // September 2013, Vol 3C Table 35-1
  const char* const VM_Version_Ext::_model_id_pentium_pro[] = {
    &quot;&quot;,
</pre>
<center><a href="templateTable_x86.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="vm_version_ext_x86.hpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>