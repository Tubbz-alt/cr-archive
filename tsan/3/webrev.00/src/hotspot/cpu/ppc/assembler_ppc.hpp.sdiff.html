<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/cpu/ppc/assembler_ppc.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="assembler_ppc.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="assembler_ppc.inline.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/ppc/assembler_ppc.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 427     SRAD_OPCODE   = (31u &lt;&lt; OPCODE_SHIFT | 794u &lt;&lt; 1),              // X-FORM
 428 
 429     MULLD_OPCODE  = (31u &lt;&lt; OPCODE_SHIFT | 233u &lt;&lt; 1),              // XO-FORM
 430     MULHD_OPCODE  = (31u &lt;&lt; OPCODE_SHIFT |  73u &lt;&lt; 1),              // XO-FORM
 431     MULHDU_OPCODE = (31u &lt;&lt; OPCODE_SHIFT |   9u &lt;&lt; 1),              // XO-FORM
 432     DIVD_OPCODE   = (31u &lt;&lt; OPCODE_SHIFT | 489u &lt;&lt; 1),              // XO-FORM
 433 
 434     CNTLZD_OPCODE = (31u &lt;&lt; OPCODE_SHIFT |  58u &lt;&lt; XO_21_30_SHIFT), // X-FORM
 435     CNTTZD_OPCODE = (31u &lt;&lt; OPCODE_SHIFT | 570u &lt;&lt; XO_21_30_SHIFT), // X-FORM
 436     NAND_OPCODE   = (31u &lt;&lt; OPCODE_SHIFT | 476u &lt;&lt; XO_21_30_SHIFT), // X-FORM
 437     NOR_OPCODE    = (31u &lt;&lt; OPCODE_SHIFT | 124u &lt;&lt; XO_21_30_SHIFT), // X-FORM
 438 
 439 
 440     // opcodes only used for floating arithmetic
 441     FADD_OPCODE   = (63u &lt;&lt; OPCODE_SHIFT |  21u &lt;&lt; 1),
 442     FADDS_OPCODE  = (59u &lt;&lt; OPCODE_SHIFT |  21u &lt;&lt; 1),
 443     FCMPU_OPCODE  = (63u &lt;&lt; OPCODE_SHIFT |  00u &lt;&lt; 1),
 444     FDIV_OPCODE   = (63u &lt;&lt; OPCODE_SHIFT |  18u &lt;&lt; 1),
 445     FDIVS_OPCODE  = (59u &lt;&lt; OPCODE_SHIFT |  18u &lt;&lt; 1),
 446     FMR_OPCODE    = (63u &lt;&lt; OPCODE_SHIFT |  72u &lt;&lt; 1),



 447     // These are special Power6 opcodes, reused for &quot;lfdepx&quot; and &quot;stfdepx&quot;
 448     // on Power7.  Do not use.
 449     // MFFGPR_OPCODE  = (31u &lt;&lt; OPCODE_SHIFT | 607u &lt;&lt; 1),
 450     // MFTGPR_OPCODE  = (31u &lt;&lt; OPCODE_SHIFT | 735u &lt;&lt; 1),
 451     CMPB_OPCODE    = (31u &lt;&lt; OPCODE_SHIFT |  508  &lt;&lt; 1),
 452     POPCNTB_OPCODE = (31u &lt;&lt; OPCODE_SHIFT |  122  &lt;&lt; 1),
 453     POPCNTW_OPCODE = (31u &lt;&lt; OPCODE_SHIFT |  378  &lt;&lt; 1),
 454     POPCNTD_OPCODE = (31u &lt;&lt; OPCODE_SHIFT |  506  &lt;&lt; 1),
 455     FABS_OPCODE    = (63u &lt;&lt; OPCODE_SHIFT |  264u &lt;&lt; 1),
 456     FNABS_OPCODE   = (63u &lt;&lt; OPCODE_SHIFT |  136u &lt;&lt; 1),
 457     FMUL_OPCODE    = (63u &lt;&lt; OPCODE_SHIFT |   25u &lt;&lt; 1),
 458     FMULS_OPCODE   = (59u &lt;&lt; OPCODE_SHIFT |   25u &lt;&lt; 1),
 459     FNEG_OPCODE    = (63u &lt;&lt; OPCODE_SHIFT |   40u &lt;&lt; 1),
 460     FSUB_OPCODE    = (63u &lt;&lt; OPCODE_SHIFT |   20u &lt;&lt; 1),
 461     FSUBS_OPCODE   = (59u &lt;&lt; OPCODE_SHIFT |   20u &lt;&lt; 1),
 462 
 463     // PPC64-internal FPU conversion opcodes
 464     FCFID_OPCODE   = (63u &lt;&lt; OPCODE_SHIFT |  846u &lt;&lt; 1),
 465     FCFIDS_OPCODE  = (59u &lt;&lt; OPCODE_SHIFT |  846u &lt;&lt; 1),
 466     FCTID_OPCODE   = (63u &lt;&lt; OPCODE_SHIFT |  814u &lt;&lt; 1),
</pre>
<hr />
<pre>
 528     XXLEQV_OPCODE  = (60u &lt;&lt; OPCODE_SHIFT |  186u &lt;&lt; 3),
 529     XVDIVSP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |   88u &lt;&lt; 3),
 530     XVDIVDP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  120u &lt;&lt; 3),
 531     XVABSSP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  409u &lt;&lt; 2),
 532     XVABSDP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  473u &lt;&lt; 2),
 533     XVNEGSP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  441u &lt;&lt; 2),
 534     XVNEGDP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  505u &lt;&lt; 2),
 535     XVSQRTSP_OPCODE= (60u &lt;&lt; OPCODE_SHIFT |  139u &lt;&lt; 2),
 536     XVSQRTDP_OPCODE= (60u &lt;&lt; OPCODE_SHIFT |  203u &lt;&lt; 2),
 537     XSCVDPSPN_OPCODE=(60u &lt;&lt; OPCODE_SHIFT |  267u &lt;&lt; 2),
 538     XVADDDP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |   96u &lt;&lt; 3),
 539     XVSUBDP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  104u &lt;&lt; 3),
 540     XVMULSP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |   80u &lt;&lt; 3),
 541     XVMULDP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  112u &lt;&lt; 3),
 542     XVMADDASP_OPCODE=(60u &lt;&lt; OPCODE_SHIFT |   65u &lt;&lt; 3),
 543     XVMADDADP_OPCODE=(60u &lt;&lt; OPCODE_SHIFT |   97u &lt;&lt; 3),
 544     XVMSUBASP_OPCODE=(60u &lt;&lt; OPCODE_SHIFT |   81u &lt;&lt; 3),
 545     XVMSUBADP_OPCODE=(60u &lt;&lt; OPCODE_SHIFT |  113u &lt;&lt; 3),
 546     XVNMSUBASP_OPCODE=(60u&lt;&lt; OPCODE_SHIFT |  209u &lt;&lt; 3),
 547     XVNMSUBADP_OPCODE=(60u&lt;&lt; OPCODE_SHIFT |  241u &lt;&lt; 3),



 548 
 549     // Deliver A Random Number (introduced with POWER9)
 550     DARN_OPCODE    = (31u &lt;&lt; OPCODE_SHIFT |  755u &lt;&lt; 1),
 551 
 552     // Vector Permute and Formatting
 553     VPKPX_OPCODE   = (4u  &lt;&lt; OPCODE_SHIFT |  782u     ),
 554     VPKSHSS_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  398u     ),
 555     VPKSWSS_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  462u     ),
 556     VPKSHUS_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  270u     ),
 557     VPKSWUS_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  334u     ),
 558     VPKUHUM_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |   14u     ),
 559     VPKUWUM_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |   78u     ),
 560     VPKUHUS_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  142u     ),
 561     VPKUWUS_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  206u     ),
 562     VUPKHPX_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  846u     ),
 563     VUPKHSB_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  526u     ),
 564     VUPKHSH_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  590u     ),
 565     VUPKLPX_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  974u     ),
 566     VUPKLSB_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  654u     ),
 567     VUPKLSH_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  718u     ),
</pre>
<hr />
<pre>
 912     b_op    = 18,
 913     bc_op   = 16,
 914     bcr_op  = 19
 915   };
 916 
 917   enum Condition {
 918     negative         = 0,
 919     less             = 0,
 920     positive         = 1,
 921     greater          = 1,
 922     zero             = 2,
 923     equal            = 2,
 924     summary_overflow = 3,
 925   };
 926 
 927  public:
 928   // Helper functions for groups of instructions
 929 
 930   enum Predict { pt = 1, pn = 0 }; // pt = predict taken
 931 
<span class="line-modified"> 932   // Instruction must start at passed address.</span>
<span class="line-modified"> 933   static int instr_len(unsigned char *instr) { return BytesPerInstWord; }</span>


 934 
<span class="line-modified"> 935   // longest instructions</span>
<span class="line-modified"> 936   static int instr_maxlen() { return BytesPerInstWord; }</span>
 937 
 938   // Test if x is within signed immediate range for nbits.
 939   static bool is_simm(int x, unsigned int nbits) {
 940     assert(0 &lt; nbits &amp;&amp; nbits &lt; 32, &quot;out of bounds&quot;);
 941     const int   min      = -(((int)1) &lt;&lt; nbits-1);
 942     const int   maxplus1 =  (((int)1) &lt;&lt; nbits-1);
 943     return min &lt;= x &amp;&amp; x &lt; maxplus1;
 944   }
 945 
 946   static bool is_simm(jlong x, unsigned int nbits) {
 947     assert(0 &lt; nbits &amp;&amp; nbits &lt; 64, &quot;out of bounds&quot;);
 948     const jlong min      = -(((jlong)1) &lt;&lt; nbits-1);
 949     const jlong maxplus1 =  (((jlong)1) &lt;&lt; nbits-1);
 950     return min &lt;= x &amp;&amp; x &lt; maxplus1;
 951   }
 952 
 953   // Test if x is within unsigned immediate range for nbits.
 954   static bool is_uimm(int x, unsigned int nbits) {
 955     assert(0 &lt; nbits &amp;&amp; nbits &lt; 32, &quot;out of bounds&quot;);
 956     const unsigned int maxplus1 = (((unsigned int)1) &lt;&lt; nbits);
</pre>
<hr />
<pre>
1962   // PPC 1, section 4.6.2 Floating-Point Load Instructions
1963   inline void lfs(  FloatRegister d, int si16,   Register a);
1964   inline void lfsu( FloatRegister d, int si16,   Register a);
1965   inline void lfsx( FloatRegister d, Register a, Register b);
1966   inline void lfd(  FloatRegister d, int si16,   Register a);
1967   inline void lfdu( FloatRegister d, int si16,   Register a);
1968   inline void lfdx( FloatRegister d, Register a, Register b);
1969 
1970   // PPC 1, section 4.6.3 Floating-Point Store Instructions
1971   inline void stfs(  FloatRegister s, int si16,   Register a);
1972   inline void stfsu( FloatRegister s, int si16,   Register a);
1973   inline void stfsx( FloatRegister s, Register a, Register b);
1974   inline void stfd(  FloatRegister s, int si16,   Register a);
1975   inline void stfdu( FloatRegister s, int si16,   Register a);
1976   inline void stfdx( FloatRegister s, Register a, Register b);
1977 
1978   // PPC 1, section 4.6.4 Floating-Point Move Instructions
1979   inline void fmr(  FloatRegister d, FloatRegister b);
1980   inline void fmr_( FloatRegister d, FloatRegister b);
1981 




1982   //  inline void mffgpr( FloatRegister d, Register b);
1983   //  inline void mftgpr( Register d, FloatRegister b);
1984   inline void cmpb(   Register a, Register s, Register b);
1985   inline void popcntb(Register a, Register s);
1986   inline void popcntw(Register a, Register s);
1987   inline void popcntd(Register a, Register s);
1988 
1989   inline void fneg(  FloatRegister d, FloatRegister b);
1990   inline void fneg_( FloatRegister d, FloatRegister b);
1991   inline void fabs(  FloatRegister d, FloatRegister b);
1992   inline void fabs_( FloatRegister d, FloatRegister b);
1993   inline void fnabs( FloatRegister d, FloatRegister b);
1994   inline void fnabs_(FloatRegister d, FloatRegister b);
1995 
1996   // PPC 1, section 4.6.5.1 Floating-Point Elementary Arithmetic Instructions
1997   inline void fadd(  FloatRegister d, FloatRegister a, FloatRegister b);
1998   inline void fadd_( FloatRegister d, FloatRegister a, FloatRegister b);
1999   inline void fadds( FloatRegister d, FloatRegister a, FloatRegister b);
2000   inline void fadds_(FloatRegister d, FloatRegister a, FloatRegister b);
2001   inline void fsub(  FloatRegister d, FloatRegister a, FloatRegister b);
</pre>
<hr />
<pre>
2222   inline void xxleqv(   VectorSRegister d, VectorSRegister a, VectorSRegister b);
2223   inline void xvdivsp(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2224   inline void xvdivdp(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2225   inline void xvabssp(  VectorSRegister d, VectorSRegister b);
2226   inline void xvabsdp(  VectorSRegister d, VectorSRegister b);
2227   inline void xvnegsp(  VectorSRegister d, VectorSRegister b);
2228   inline void xvnegdp(  VectorSRegister d, VectorSRegister b);
2229   inline void xvsqrtsp( VectorSRegister d, VectorSRegister b);
2230   inline void xvsqrtdp( VectorSRegister d, VectorSRegister b);
2231   inline void xscvdpspn(VectorSRegister d, VectorSRegister b);
2232   inline void xvadddp(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2233   inline void xvsubdp(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2234   inline void xvmulsp(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2235   inline void xvmuldp(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2236   inline void xvmaddasp(VectorSRegister d, VectorSRegister a, VectorSRegister b);
2237   inline void xvmaddadp(VectorSRegister d, VectorSRegister a, VectorSRegister b);
2238   inline void xvmsubasp(VectorSRegister d, VectorSRegister a, VectorSRegister b);
2239   inline void xvmsubadp(VectorSRegister d, VectorSRegister a, VectorSRegister b);
2240   inline void xvnmsubasp(VectorSRegister d, VectorSRegister a, VectorSRegister b);
2241   inline void xvnmsubadp(VectorSRegister d, VectorSRegister a, VectorSRegister b);



2242 
2243   // VSX Extended Mnemonics
2244   inline void xxspltd(  VectorSRegister d, VectorSRegister a, int x);
2245   inline void xxmrghd(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2246   inline void xxmrgld(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2247   inline void xxswapd(  VectorSRegister d, VectorSRegister a);
2248 
2249   // Vector-Scalar (VSX) instructions.
2250   inline void mtfprd(   FloatRegister   d, Register a);
2251   inline void mtfprwa(  FloatRegister   d, Register a);
2252   inline void mffprd(   Register        a, FloatRegister d);
2253 
2254   // Deliver A Random Number (introduced with POWER9)
2255   inline void darn( Register d, int l = 1 /*L=CRN*/);
2256 
2257   // AES (introduced with Power 8)
2258   inline void vcipher(     VectorRegister d, VectorRegister a, VectorRegister b);
2259   inline void vcipherlast( VectorRegister d, VectorRegister a, VectorRegister b);
2260   inline void vncipher(    VectorRegister d, VectorRegister a, VectorRegister b);
2261   inline void vncipherlast(VectorRegister d, VectorRegister a, VectorRegister b);
</pre>
</td>
<td>
<hr />
<pre>
 427     SRAD_OPCODE   = (31u &lt;&lt; OPCODE_SHIFT | 794u &lt;&lt; 1),              // X-FORM
 428 
 429     MULLD_OPCODE  = (31u &lt;&lt; OPCODE_SHIFT | 233u &lt;&lt; 1),              // XO-FORM
 430     MULHD_OPCODE  = (31u &lt;&lt; OPCODE_SHIFT |  73u &lt;&lt; 1),              // XO-FORM
 431     MULHDU_OPCODE = (31u &lt;&lt; OPCODE_SHIFT |   9u &lt;&lt; 1),              // XO-FORM
 432     DIVD_OPCODE   = (31u &lt;&lt; OPCODE_SHIFT | 489u &lt;&lt; 1),              // XO-FORM
 433 
 434     CNTLZD_OPCODE = (31u &lt;&lt; OPCODE_SHIFT |  58u &lt;&lt; XO_21_30_SHIFT), // X-FORM
 435     CNTTZD_OPCODE = (31u &lt;&lt; OPCODE_SHIFT | 570u &lt;&lt; XO_21_30_SHIFT), // X-FORM
 436     NAND_OPCODE   = (31u &lt;&lt; OPCODE_SHIFT | 476u &lt;&lt; XO_21_30_SHIFT), // X-FORM
 437     NOR_OPCODE    = (31u &lt;&lt; OPCODE_SHIFT | 124u &lt;&lt; XO_21_30_SHIFT), // X-FORM
 438 
 439 
 440     // opcodes only used for floating arithmetic
 441     FADD_OPCODE   = (63u &lt;&lt; OPCODE_SHIFT |  21u &lt;&lt; 1),
 442     FADDS_OPCODE  = (59u &lt;&lt; OPCODE_SHIFT |  21u &lt;&lt; 1),
 443     FCMPU_OPCODE  = (63u &lt;&lt; OPCODE_SHIFT |  00u &lt;&lt; 1),
 444     FDIV_OPCODE   = (63u &lt;&lt; OPCODE_SHIFT |  18u &lt;&lt; 1),
 445     FDIVS_OPCODE  = (59u &lt;&lt; OPCODE_SHIFT |  18u &lt;&lt; 1),
 446     FMR_OPCODE    = (63u &lt;&lt; OPCODE_SHIFT |  72u &lt;&lt; 1),
<span class="line-added"> 447     FRIN_OPCODE   = (63u &lt;&lt; OPCODE_SHIFT | 392u &lt;&lt; 1),</span>
<span class="line-added"> 448     FRIP_OPCODE   = (63u &lt;&lt; OPCODE_SHIFT | 456u &lt;&lt; 1),</span>
<span class="line-added"> 449     FRIM_OPCODE   = (63u &lt;&lt; OPCODE_SHIFT | 488u &lt;&lt; 1),</span>
 450     // These are special Power6 opcodes, reused for &quot;lfdepx&quot; and &quot;stfdepx&quot;
 451     // on Power7.  Do not use.
 452     // MFFGPR_OPCODE  = (31u &lt;&lt; OPCODE_SHIFT | 607u &lt;&lt; 1),
 453     // MFTGPR_OPCODE  = (31u &lt;&lt; OPCODE_SHIFT | 735u &lt;&lt; 1),
 454     CMPB_OPCODE    = (31u &lt;&lt; OPCODE_SHIFT |  508  &lt;&lt; 1),
 455     POPCNTB_OPCODE = (31u &lt;&lt; OPCODE_SHIFT |  122  &lt;&lt; 1),
 456     POPCNTW_OPCODE = (31u &lt;&lt; OPCODE_SHIFT |  378  &lt;&lt; 1),
 457     POPCNTD_OPCODE = (31u &lt;&lt; OPCODE_SHIFT |  506  &lt;&lt; 1),
 458     FABS_OPCODE    = (63u &lt;&lt; OPCODE_SHIFT |  264u &lt;&lt; 1),
 459     FNABS_OPCODE   = (63u &lt;&lt; OPCODE_SHIFT |  136u &lt;&lt; 1),
 460     FMUL_OPCODE    = (63u &lt;&lt; OPCODE_SHIFT |   25u &lt;&lt; 1),
 461     FMULS_OPCODE   = (59u &lt;&lt; OPCODE_SHIFT |   25u &lt;&lt; 1),
 462     FNEG_OPCODE    = (63u &lt;&lt; OPCODE_SHIFT |   40u &lt;&lt; 1),
 463     FSUB_OPCODE    = (63u &lt;&lt; OPCODE_SHIFT |   20u &lt;&lt; 1),
 464     FSUBS_OPCODE   = (59u &lt;&lt; OPCODE_SHIFT |   20u &lt;&lt; 1),
 465 
 466     // PPC64-internal FPU conversion opcodes
 467     FCFID_OPCODE   = (63u &lt;&lt; OPCODE_SHIFT |  846u &lt;&lt; 1),
 468     FCFIDS_OPCODE  = (59u &lt;&lt; OPCODE_SHIFT |  846u &lt;&lt; 1),
 469     FCTID_OPCODE   = (63u &lt;&lt; OPCODE_SHIFT |  814u &lt;&lt; 1),
</pre>
<hr />
<pre>
 531     XXLEQV_OPCODE  = (60u &lt;&lt; OPCODE_SHIFT |  186u &lt;&lt; 3),
 532     XVDIVSP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |   88u &lt;&lt; 3),
 533     XVDIVDP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  120u &lt;&lt; 3),
 534     XVABSSP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  409u &lt;&lt; 2),
 535     XVABSDP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  473u &lt;&lt; 2),
 536     XVNEGSP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  441u &lt;&lt; 2),
 537     XVNEGDP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  505u &lt;&lt; 2),
 538     XVSQRTSP_OPCODE= (60u &lt;&lt; OPCODE_SHIFT |  139u &lt;&lt; 2),
 539     XVSQRTDP_OPCODE= (60u &lt;&lt; OPCODE_SHIFT |  203u &lt;&lt; 2),
 540     XSCVDPSPN_OPCODE=(60u &lt;&lt; OPCODE_SHIFT |  267u &lt;&lt; 2),
 541     XVADDDP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |   96u &lt;&lt; 3),
 542     XVSUBDP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  104u &lt;&lt; 3),
 543     XVMULSP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |   80u &lt;&lt; 3),
 544     XVMULDP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  112u &lt;&lt; 3),
 545     XVMADDASP_OPCODE=(60u &lt;&lt; OPCODE_SHIFT |   65u &lt;&lt; 3),
 546     XVMADDADP_OPCODE=(60u &lt;&lt; OPCODE_SHIFT |   97u &lt;&lt; 3),
 547     XVMSUBASP_OPCODE=(60u &lt;&lt; OPCODE_SHIFT |   81u &lt;&lt; 3),
 548     XVMSUBADP_OPCODE=(60u &lt;&lt; OPCODE_SHIFT |  113u &lt;&lt; 3),
 549     XVNMSUBASP_OPCODE=(60u&lt;&lt; OPCODE_SHIFT |  209u &lt;&lt; 3),
 550     XVNMSUBADP_OPCODE=(60u&lt;&lt; OPCODE_SHIFT |  241u &lt;&lt; 3),
<span class="line-added"> 551     XVRDPI_OPCODE  = (60u &lt;&lt; OPCODE_SHIFT |  201u &lt;&lt; 2),</span>
<span class="line-added"> 552     XVRDPIM_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  249u &lt;&lt; 2),</span>
<span class="line-added"> 553     XVRDPIP_OPCODE = (60u &lt;&lt; OPCODE_SHIFT |  233u &lt;&lt; 2),</span>
 554 
 555     // Deliver A Random Number (introduced with POWER9)
 556     DARN_OPCODE    = (31u &lt;&lt; OPCODE_SHIFT |  755u &lt;&lt; 1),
 557 
 558     // Vector Permute and Formatting
 559     VPKPX_OPCODE   = (4u  &lt;&lt; OPCODE_SHIFT |  782u     ),
 560     VPKSHSS_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  398u     ),
 561     VPKSWSS_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  462u     ),
 562     VPKSHUS_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  270u     ),
 563     VPKSWUS_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  334u     ),
 564     VPKUHUM_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |   14u     ),
 565     VPKUWUM_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |   78u     ),
 566     VPKUHUS_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  142u     ),
 567     VPKUWUS_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  206u     ),
 568     VUPKHPX_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  846u     ),
 569     VUPKHSB_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  526u     ),
 570     VUPKHSH_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  590u     ),
 571     VUPKLPX_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  974u     ),
 572     VUPKLSB_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  654u     ),
 573     VUPKLSH_OPCODE = (4u  &lt;&lt; OPCODE_SHIFT |  718u     ),
</pre>
<hr />
<pre>
 918     b_op    = 18,
 919     bc_op   = 16,
 920     bcr_op  = 19
 921   };
 922 
 923   enum Condition {
 924     negative         = 0,
 925     less             = 0,
 926     positive         = 1,
 927     greater          = 1,
 928     zero             = 2,
 929     equal            = 2,
 930     summary_overflow = 3,
 931   };
 932 
 933  public:
 934   // Helper functions for groups of instructions
 935 
 936   enum Predict { pt = 1, pn = 0 }; // pt = predict taken
 937 
<span class="line-modified"> 938   //---&lt;  calculate length of instruction  &gt;---</span>
<span class="line-modified"> 939   // With PPC64 being a RISC architecture, this always is BytesPerInstWord</span>
<span class="line-added"> 940   // instruction must start at passed address</span>
<span class="line-added"> 941   static unsigned int instr_len(unsigned char *instr) { return BytesPerInstWord; }</span>
 942 
<span class="line-modified"> 943   //---&lt;  longest instructions  &gt;---</span>
<span class="line-modified"> 944   static unsigned int instr_maxlen() { return BytesPerInstWord; }</span>
 945 
 946   // Test if x is within signed immediate range for nbits.
 947   static bool is_simm(int x, unsigned int nbits) {
 948     assert(0 &lt; nbits &amp;&amp; nbits &lt; 32, &quot;out of bounds&quot;);
 949     const int   min      = -(((int)1) &lt;&lt; nbits-1);
 950     const int   maxplus1 =  (((int)1) &lt;&lt; nbits-1);
 951     return min &lt;= x &amp;&amp; x &lt; maxplus1;
 952   }
 953 
 954   static bool is_simm(jlong x, unsigned int nbits) {
 955     assert(0 &lt; nbits &amp;&amp; nbits &lt; 64, &quot;out of bounds&quot;);
 956     const jlong min      = -(((jlong)1) &lt;&lt; nbits-1);
 957     const jlong maxplus1 =  (((jlong)1) &lt;&lt; nbits-1);
 958     return min &lt;= x &amp;&amp; x &lt; maxplus1;
 959   }
 960 
 961   // Test if x is within unsigned immediate range for nbits.
 962   static bool is_uimm(int x, unsigned int nbits) {
 963     assert(0 &lt; nbits &amp;&amp; nbits &lt; 32, &quot;out of bounds&quot;);
 964     const unsigned int maxplus1 = (((unsigned int)1) &lt;&lt; nbits);
</pre>
<hr />
<pre>
1970   // PPC 1, section 4.6.2 Floating-Point Load Instructions
1971   inline void lfs(  FloatRegister d, int si16,   Register a);
1972   inline void lfsu( FloatRegister d, int si16,   Register a);
1973   inline void lfsx( FloatRegister d, Register a, Register b);
1974   inline void lfd(  FloatRegister d, int si16,   Register a);
1975   inline void lfdu( FloatRegister d, int si16,   Register a);
1976   inline void lfdx( FloatRegister d, Register a, Register b);
1977 
1978   // PPC 1, section 4.6.3 Floating-Point Store Instructions
1979   inline void stfs(  FloatRegister s, int si16,   Register a);
1980   inline void stfsu( FloatRegister s, int si16,   Register a);
1981   inline void stfsx( FloatRegister s, Register a, Register b);
1982   inline void stfd(  FloatRegister s, int si16,   Register a);
1983   inline void stfdu( FloatRegister s, int si16,   Register a);
1984   inline void stfdx( FloatRegister s, Register a, Register b);
1985 
1986   // PPC 1, section 4.6.4 Floating-Point Move Instructions
1987   inline void fmr(  FloatRegister d, FloatRegister b);
1988   inline void fmr_( FloatRegister d, FloatRegister b);
1989 
<span class="line-added">1990   inline void frin( FloatRegister d, FloatRegister b);</span>
<span class="line-added">1991   inline void frip( FloatRegister d, FloatRegister b);</span>
<span class="line-added">1992   inline void frim( FloatRegister d, FloatRegister b);</span>
<span class="line-added">1993 </span>
1994   //  inline void mffgpr( FloatRegister d, Register b);
1995   //  inline void mftgpr( Register d, FloatRegister b);
1996   inline void cmpb(   Register a, Register s, Register b);
1997   inline void popcntb(Register a, Register s);
1998   inline void popcntw(Register a, Register s);
1999   inline void popcntd(Register a, Register s);
2000 
2001   inline void fneg(  FloatRegister d, FloatRegister b);
2002   inline void fneg_( FloatRegister d, FloatRegister b);
2003   inline void fabs(  FloatRegister d, FloatRegister b);
2004   inline void fabs_( FloatRegister d, FloatRegister b);
2005   inline void fnabs( FloatRegister d, FloatRegister b);
2006   inline void fnabs_(FloatRegister d, FloatRegister b);
2007 
2008   // PPC 1, section 4.6.5.1 Floating-Point Elementary Arithmetic Instructions
2009   inline void fadd(  FloatRegister d, FloatRegister a, FloatRegister b);
2010   inline void fadd_( FloatRegister d, FloatRegister a, FloatRegister b);
2011   inline void fadds( FloatRegister d, FloatRegister a, FloatRegister b);
2012   inline void fadds_(FloatRegister d, FloatRegister a, FloatRegister b);
2013   inline void fsub(  FloatRegister d, FloatRegister a, FloatRegister b);
</pre>
<hr />
<pre>
2234   inline void xxleqv(   VectorSRegister d, VectorSRegister a, VectorSRegister b);
2235   inline void xvdivsp(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2236   inline void xvdivdp(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2237   inline void xvabssp(  VectorSRegister d, VectorSRegister b);
2238   inline void xvabsdp(  VectorSRegister d, VectorSRegister b);
2239   inline void xvnegsp(  VectorSRegister d, VectorSRegister b);
2240   inline void xvnegdp(  VectorSRegister d, VectorSRegister b);
2241   inline void xvsqrtsp( VectorSRegister d, VectorSRegister b);
2242   inline void xvsqrtdp( VectorSRegister d, VectorSRegister b);
2243   inline void xscvdpspn(VectorSRegister d, VectorSRegister b);
2244   inline void xvadddp(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2245   inline void xvsubdp(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2246   inline void xvmulsp(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2247   inline void xvmuldp(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2248   inline void xvmaddasp(VectorSRegister d, VectorSRegister a, VectorSRegister b);
2249   inline void xvmaddadp(VectorSRegister d, VectorSRegister a, VectorSRegister b);
2250   inline void xvmsubasp(VectorSRegister d, VectorSRegister a, VectorSRegister b);
2251   inline void xvmsubadp(VectorSRegister d, VectorSRegister a, VectorSRegister b);
2252   inline void xvnmsubasp(VectorSRegister d, VectorSRegister a, VectorSRegister b);
2253   inline void xvnmsubadp(VectorSRegister d, VectorSRegister a, VectorSRegister b);
<span class="line-added">2254   inline void xvrdpi(   VectorSRegister d, VectorSRegister b);</span>
<span class="line-added">2255   inline void xvrdpim(  VectorSRegister d, VectorSRegister b);</span>
<span class="line-added">2256   inline void xvrdpip(  VectorSRegister d, VectorSRegister b);</span>
2257 
2258   // VSX Extended Mnemonics
2259   inline void xxspltd(  VectorSRegister d, VectorSRegister a, int x);
2260   inline void xxmrghd(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2261   inline void xxmrgld(  VectorSRegister d, VectorSRegister a, VectorSRegister b);
2262   inline void xxswapd(  VectorSRegister d, VectorSRegister a);
2263 
2264   // Vector-Scalar (VSX) instructions.
2265   inline void mtfprd(   FloatRegister   d, Register a);
2266   inline void mtfprwa(  FloatRegister   d, Register a);
2267   inline void mffprd(   Register        a, FloatRegister d);
2268 
2269   // Deliver A Random Number (introduced with POWER9)
2270   inline void darn( Register d, int l = 1 /*L=CRN*/);
2271 
2272   // AES (introduced with Power 8)
2273   inline void vcipher(     VectorRegister d, VectorRegister a, VectorRegister b);
2274   inline void vcipherlast( VectorRegister d, VectorRegister a, VectorRegister b);
2275   inline void vncipher(    VectorRegister d, VectorRegister a, VectorRegister b);
2276   inline void vncipherlast(VectorRegister d, VectorRegister a, VectorRegister b);
</pre>
</td>
</tr>
</table>
<center><a href="assembler_ppc.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="assembler_ppc.inline.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>