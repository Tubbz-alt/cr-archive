<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/cpu/ppc/interpreterRT_ppc.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="interp_masm_ppc_64.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="jniFastGetField_ppc.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/ppc/interpreterRT_ppc.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 1997, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * Copyright (c) 2012, 2013 SAP SE. All rights reserved.
  4  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  5  *
  6  * This code is free software; you can redistribute it and/or modify it
  7  * under the terms of the GNU General Public License version 2 only, as
  8  * published by the Free Software Foundation.
  9  *
 10  * This code is distributed in the hope that it will be useful, but WITHOUT
 11  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 12  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 13  * version 2 for more details (a copy is included in the LICENSE file that
 14  * accompanied this code).
 15  *
 16  * You should have received a copy of the GNU General Public License version
 17  * 2 along with this work; if not, write to the Free Software Foundation,
 18  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 19  *
 20  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 21  * or visit www.oracle.com if you need additional information or have any
 22  * questions.
 23  *
 24  */
 25 
 26 #include &quot;precompiled.hpp&quot;
 27 #include &quot;asm/assembler.inline.hpp&quot;
 28 #include &quot;interpreter/interp_masm.hpp&quot;
 29 #include &quot;interpreter/interpreter.hpp&quot;
 30 #include &quot;interpreter/interpreterRuntime.hpp&quot;
 31 #include &quot;memory/allocation.inline.hpp&quot;
<span class="line-removed"> 32 #include &quot;memory/universe.hpp&quot;</span>
 33 #include &quot;oops/method.hpp&quot;
 34 #include &quot;oops/oop.inline.hpp&quot;
 35 #include &quot;runtime/handles.inline.hpp&quot;
 36 #include &quot;runtime/icache.hpp&quot;
 37 #include &quot;runtime/interfaceSupport.inline.hpp&quot;
 38 #include &quot;runtime/signature.hpp&quot;
 39 
 40 #define __ _masm-&gt;
 41 
 42 // Access macros for Java and C arguments.
 43 // The first Java argument is at index -1.
 44 #define locals_j_arg_at(index)    (Interpreter::local_offset_in_bytes(index)), R18_locals
 45 // The first C argument is at index 0.
 46 #define sp_c_arg_at(index)        ((index)*wordSize + _abi(carg_1)), R1_SP
 47 
 48 // Implementation of SignatureHandlerGenerator
 49 
 50 InterpreterRuntime::SignatureHandlerGenerator::SignatureHandlerGenerator(
 51     const methodHandle&amp; method, CodeBuffer* buffer) : NativeSignatureIterator(method) {
 52   _masm = new MacroAssembler(buffer);
</pre>
<hr />
<pre>
131 
132   __ flush();
133 }
134 
135 #undef __
136 
137 // Implementation of SignatureHandlerLibrary
138 
139 void SignatureHandlerLibrary::pd_set_handler(address handler) {
140 #if !defined(ABI_ELFv2)
141   // patch fd here.
142   FunctionDescriptor* fd = (FunctionDescriptor*) handler;
143 
144   fd-&gt;set_entry(handler + (int)sizeof(FunctionDescriptor));
145   assert(fd-&gt;toc() == (address)0xcafe, &quot;need to adjust TOC here&quot;);
146 #endif
147 }
148 
149 
150 // Access function to get the signature.
<span class="line-modified">151 IRT_ENTRY(address, InterpreterRuntime::get_signature(JavaThread* thread, Method* method))</span>
152   methodHandle m(thread, method);
153   assert(m-&gt;is_native(), &quot;sanity check&quot;);
154   Symbol *s = m-&gt;signature();
155   return (address) s-&gt;base();
<span class="line-modified">156 IRT_END</span>
157 
<span class="line-modified">158 IRT_ENTRY(address, InterpreterRuntime::get_result_handler(JavaThread* thread, Method* method))</span>
159   methodHandle m(thread, method);
160   assert(m-&gt;is_native(), &quot;sanity check&quot;);
161   return AbstractInterpreter::result_handler(m-&gt;result_type());
<span class="line-modified">162 IRT_END</span>
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * Copyright (c) 2012, 2013 SAP SE. All rights reserved.
  4  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  5  *
  6  * This code is free software; you can redistribute it and/or modify it
  7  * under the terms of the GNU General Public License version 2 only, as
  8  * published by the Free Software Foundation.
  9  *
 10  * This code is distributed in the hope that it will be useful, but WITHOUT
 11  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 12  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 13  * version 2 for more details (a copy is included in the LICENSE file that
 14  * accompanied this code).
 15  *
 16  * You should have received a copy of the GNU General Public License version
 17  * 2 along with this work; if not, write to the Free Software Foundation,
 18  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 19  *
 20  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 21  * or visit www.oracle.com if you need additional information or have any
 22  * questions.
 23  *
 24  */
 25 
 26 #include &quot;precompiled.hpp&quot;
 27 #include &quot;asm/assembler.inline.hpp&quot;
 28 #include &quot;interpreter/interp_masm.hpp&quot;
 29 #include &quot;interpreter/interpreter.hpp&quot;
 30 #include &quot;interpreter/interpreterRuntime.hpp&quot;
 31 #include &quot;memory/allocation.inline.hpp&quot;

 32 #include &quot;oops/method.hpp&quot;
 33 #include &quot;oops/oop.inline.hpp&quot;
 34 #include &quot;runtime/handles.inline.hpp&quot;
 35 #include &quot;runtime/icache.hpp&quot;
 36 #include &quot;runtime/interfaceSupport.inline.hpp&quot;
 37 #include &quot;runtime/signature.hpp&quot;
 38 
 39 #define __ _masm-&gt;
 40 
 41 // Access macros for Java and C arguments.
 42 // The first Java argument is at index -1.
 43 #define locals_j_arg_at(index)    (Interpreter::local_offset_in_bytes(index)), R18_locals
 44 // The first C argument is at index 0.
 45 #define sp_c_arg_at(index)        ((index)*wordSize + _abi(carg_1)), R1_SP
 46 
 47 // Implementation of SignatureHandlerGenerator
 48 
 49 InterpreterRuntime::SignatureHandlerGenerator::SignatureHandlerGenerator(
 50     const methodHandle&amp; method, CodeBuffer* buffer) : NativeSignatureIterator(method) {
 51   _masm = new MacroAssembler(buffer);
</pre>
<hr />
<pre>
130 
131   __ flush();
132 }
133 
134 #undef __
135 
136 // Implementation of SignatureHandlerLibrary
137 
138 void SignatureHandlerLibrary::pd_set_handler(address handler) {
139 #if !defined(ABI_ELFv2)
140   // patch fd here.
141   FunctionDescriptor* fd = (FunctionDescriptor*) handler;
142 
143   fd-&gt;set_entry(handler + (int)sizeof(FunctionDescriptor));
144   assert(fd-&gt;toc() == (address)0xcafe, &quot;need to adjust TOC here&quot;);
145 #endif
146 }
147 
148 
149 // Access function to get the signature.
<span class="line-modified">150 JRT_ENTRY(address, InterpreterRuntime::get_signature(JavaThread* thread, Method* method))</span>
151   methodHandle m(thread, method);
152   assert(m-&gt;is_native(), &quot;sanity check&quot;);
153   Symbol *s = m-&gt;signature();
154   return (address) s-&gt;base();
<span class="line-modified">155 JRT_END</span>
156 
<span class="line-modified">157 JRT_ENTRY(address, InterpreterRuntime::get_result_handler(JavaThread* thread, Method* method))</span>
158   methodHandle m(thread, method);
159   assert(m-&gt;is_native(), &quot;sanity check&quot;);
160   return AbstractInterpreter::result_handler(m-&gt;result_type());
<span class="line-modified">161 JRT_END</span>
</pre>
</td>
</tr>
</table>
<center><a href="interp_masm_ppc_64.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="jniFastGetField_ppc.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>