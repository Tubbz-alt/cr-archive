<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/cpu/aarch64/vm_version_aarch64.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="vm_version_aarch64.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="vm_version_ext_aarch64.hpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/aarch64/vm_version_aarch64.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,8 ***</span>
  /*
   * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.
<span class="line-modified">!  * Copyright (c) 2014, Red Hat Inc. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,8 ---</span>
  /*
   * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.
<span class="line-modified">!  * Copyright (c) 2014, 2019, Red Hat Inc. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 24,12 ***</span>
   */
  
  #ifndef CPU_AARCH64_VM_VERSION_AARCH64_HPP
  #define CPU_AARCH64_VM_VERSION_AARCH64_HPP
  
  #include &quot;runtime/globals_extension.hpp&quot;
<span class="line-removed">- #include &quot;runtime/vm_version.hpp&quot;</span>
  #include &quot;utilities/sizes.hpp&quot;
  
  class VM_Version : public Abstract_VM_Version {
    friend class JVMCIVMStructs;
  
<span class="line-new-header">--- 24,12 ---</span>
   */
  
  #ifndef CPU_AARCH64_VM_VERSION_AARCH64_HPP
  #define CPU_AARCH64_VM_VERSION_AARCH64_HPP
  
<span class="line-added">+ #include &quot;runtime/abstract_vm_version.hpp&quot;</span>
  #include &quot;runtime/globals_extension.hpp&quot;
  #include &quot;utilities/sizes.hpp&quot;
  
  class VM_Version : public Abstract_VM_Version {
    friend class JVMCIVMStructs;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 38,11 ***</span>
    static int _model;
    static int _model2;
    static int _variant;
    static int _revision;
    static int _stepping;
<span class="line-modified">! </span>
    struct PsrInfo {
      uint32_t dczid_el0;
      uint32_t ctr_el0;
    };
    static PsrInfo _psr_info;
<span class="line-new-header">--- 38,11 ---</span>
    static int _model;
    static int _model2;
    static int _variant;
    static int _revision;
    static int _stepping;
<span class="line-modified">!   static bool _dcpop;</span>
    struct PsrInfo {
      uint32_t dczid_el0;
      uint32_t ctr_el0;
    };
    static PsrInfo _psr_info;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 65,11 ***</span>
<span class="line-new-header">--- 65,15 ---</span>
        }
      }
      return false;
    }
  
<span class="line-added">+   // The CPU implementer codes can be found in</span>
<span class="line-added">+   // ARM Architecture Reference Manual ARMv8, for ARMv8-A architecture profile</span>
<span class="line-added">+   // https://developer.arm.com/docs/ddi0487/latest</span>
    enum Family {
<span class="line-added">+     CPU_AMPERE    = 0xC0,</span>
      CPU_ARM       = &#39;A&#39;,
      CPU_BROADCOM  = &#39;B&#39;,
      CPU_CAVIUM    = &#39;C&#39;,
      CPU_DEC       = &#39;D&#39;,
      CPU_HISILICON = &#39;H&#39;,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 100,10 ***</span>
<span class="line-new-header">--- 104,11 ---</span>
    static int cpu_family()                     { return _cpu; }
    static int cpu_model()                      { return _model; }
    static int cpu_model2()                     { return _model2; }
    static int cpu_variant()                    { return _variant; }
    static int cpu_revision()                   { return _revision; }
<span class="line-added">+   static bool supports_dcpop()                { return _dcpop; }</span>
    static ByteSize dczid_el0_offset() { return byte_offset_of(PsrInfo, dczid_el0); }
    static ByteSize ctr_el0_offset()   { return byte_offset_of(PsrInfo, ctr_el0); }
    static bool is_zva_enabled() {
      // Check the DZP bit (bit 4) of dczid_el0 is zero
      // and block size (bit 0~3) is not zero.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 118,8 ***</span>
<span class="line-new-header">--- 123,9 ---</span>
      return (1 &lt;&lt; (_psr_info.ctr_el0 &amp; 0x0f)) * 4;
    }
    static int dcache_line_size() {
      return (1 &lt;&lt; ((_psr_info.ctr_el0 &gt;&gt; 16) &amp; 0x0f)) * 4;
    }
<span class="line-added">+   static bool supports_fast_class_init_checks() { return true; }</span>
  };
  
  #endif // CPU_AARCH64_VM_VERSION_AARCH64_HPP
</pre>
<center><a href="vm_version_aarch64.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="vm_version_ext_aarch64.hpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>