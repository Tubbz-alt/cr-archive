<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.naming/share/classes/com/sun/jndi/ldap/BerDecoder.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../../java.management/share/native/libmanagement/ThreadImpl.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="Connection.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.naming/share/classes/com/sun/jndi/ldap/BerDecoder.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
169      */
170     public int parseEnumeration() throws DecodeException {
171         return parseIntWithTag(ASN_ENUMERATED);
172     }
173 
174     /**
175      * Parses an ASN_INTEGER tagged integer from this BER buffer.
176      * @return The value of the integer.
177      */
178     public int parseInt() throws DecodeException {
179         return parseIntWithTag(ASN_INTEGER);
180     }
181 
182     /**
183       * Parses an integer that&#39;s preceded by a tag.
184       *&lt;blockquote&gt;&lt;pre&gt;
185       * BER integer ::= tag length byte {byte}*
186       *&lt;/pre&gt;&lt;/blockquote&gt;
187       */
188     private int parseIntWithTag(int tag) throws DecodeException {
<span class="line-removed">189 </span>
<span class="line-removed">190 </span>
191         if (parseByte() != tag) {







192             throw new DecodeException(&quot;Encountered ASN.1 tag &quot; +
<span class="line-modified">193                 Integer.toString(buf[offset - 1] &amp; 0xff) +</span>
<span class="line-removed">194                 &quot; (expected tag &quot; + Integer.toString(tag) + &quot;)&quot;);</span>
195         }
196 
197         int len = parseLength();
198 
199         if (len &gt; 4) {
200             throw new DecodeException(&quot;INTEGER too long&quot;);
201         } else if (len &gt; bufsize - offset) {
202             throw new DecodeException(&quot;Insufficient data&quot;);
203         }
204 
205         byte fb = buf[offset++];
206         int value = 0;
207 
208         value = fb &amp; 0x7F;
209         for( int i = 1 /* first byte already read */ ; i &lt; len; i++) {
210             value &lt;&lt;= 8;
211             value |= (buf[offset++] &amp; 0xff);
212         }
213 
214         if ((fb &amp; 0x80) == 0x80) {
</pre>
</td>
<td>
<hr />
<pre>
169      */
170     public int parseEnumeration() throws DecodeException {
171         return parseIntWithTag(ASN_ENUMERATED);
172     }
173 
174     /**
175      * Parses an ASN_INTEGER tagged integer from this BER buffer.
176      * @return The value of the integer.
177      */
178     public int parseInt() throws DecodeException {
179         return parseIntWithTag(ASN_INTEGER);
180     }
181 
182     /**
183       * Parses an integer that&#39;s preceded by a tag.
184       *&lt;blockquote&gt;&lt;pre&gt;
185       * BER integer ::= tag length byte {byte}*
186       *&lt;/pre&gt;&lt;/blockquote&gt;
187       */
188     private int parseIntWithTag(int tag) throws DecodeException {


189         if (parseByte() != tag) {
<span class="line-added">190             // Ber could have been reset;</span>
<span class="line-added">191             String s;</span>
<span class="line-added">192             if (offset &gt; 0) {</span>
<span class="line-added">193                 s = Integer.toString(buf[offset - 1] &amp; 0xff);</span>
<span class="line-added">194             } else {</span>
<span class="line-added">195                 s = &quot;Empty tag&quot;;</span>
<span class="line-added">196             }</span>
197             throw new DecodeException(&quot;Encountered ASN.1 tag &quot; +
<span class="line-modified">198                 s + &quot; (expected tag &quot; + Integer.toString(tag) + &quot;)&quot;);</span>

199         }
200 
201         int len = parseLength();
202 
203         if (len &gt; 4) {
204             throw new DecodeException(&quot;INTEGER too long&quot;);
205         } else if (len &gt; bufsize - offset) {
206             throw new DecodeException(&quot;Insufficient data&quot;);
207         }
208 
209         byte fb = buf[offset++];
210         int value = 0;
211 
212         value = fb &amp; 0x7F;
213         for( int i = 1 /* first byte already read */ ; i &lt; len; i++) {
214             value &lt;&lt;= 8;
215             value |= (buf[offset++] &amp; 0xff);
216         }
217 
218         if ((fb &amp; 0x80) == 0x80) {
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../../java.management/share/native/libmanagement/ThreadImpl.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="Connection.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>