<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.naming/share/classes/com/sun/jndi/ldap/LdapCtx.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DefaultLdapDnsProvider.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="LdapDnsProviderService.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.naming/share/classes/com/sun/jndi/ldap/LdapCtx.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 1999, 2017, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 1999, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -222,11 +222,10 @@</span>
  
      int port_number;                    // port number of server
      String hostname = null;             // host name of server (no brackets
                                          //   for IPv6 literals)
      LdapClient clnt = null;             // connection handle
<span class="udiff-line-removed">-     private boolean reconnect = false;  // indicates that re-connect requested</span>
      Hashtable&lt;String, java.lang.Object&gt; envprops = null; // environment properties of context
      int handleReferrals = DEFAULT_REFERRAL_MODE; // how referral is handled
      boolean hasLdapsScheme = false;     // true if the context was created
                                          //  using an LDAPS URL.
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -2666,11 +2665,10 @@</span>
          } else {
              envprops.put(BIND_CONTROLS, bindCtls = cloneControls(connCtls));
          }
  
          sharable = false;  // can&#39;t share with existing contexts
<span class="udiff-line-removed">-         reconnect = true;</span>
          ensureOpen();      // open or reauthenticated
      }
  
      private void ensureOpen() throws NamingException {
          ensureOpen(false);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -2691,11 +2689,12 @@</span>
              } else if (!sharable || startTLS) {
  
                  synchronized (clnt) {
                      if (!clnt.isLdapv3
                          || clnt.referenceCount &gt; 1
<span class="udiff-line-modified-removed">-                         || clnt.usingSaslStreams()) {</span>
<span class="udiff-line-modified-added">+                         || clnt.usingSaslStreams()</span>
<span class="udiff-line-added">+                         || !clnt.conn.useable) {</span>
                          closeConnection(SOFT_CLOSE);
                      }
                  }
                  // reset the cache before a new connection is established
                  schemaTrees = new Hashtable&lt;&gt;(11, 0.75f);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -2743,11 +2742,11 @@</span>
          }
  
          try {
              boolean initial = (clnt == null);
  
<span class="udiff-line-modified-removed">-             if (initial || reconnect) {</span>
<span class="udiff-line-modified-added">+             if (initial) {</span>
                  ldapVersion = (ver != null) ? Integer.parseInt(ver) :
                      DEFAULT_LDAP_VERSION;
  
                  clnt = LdapClient.getInstance(
                      usePool, // Whether to use connection pooling
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -2771,12 +2770,10 @@</span>
                      passwd,
  
                      // Required for SASL client identity
                      envprops);
  
<span class="udiff-line-removed">-                 reconnect = false;</span>
<span class="udiff-line-removed">- </span>
                  /**
                   * Pooled connections are preauthenticated;
                   * newly created ones are not.
                   */
                  if (clnt.authenticateCalled()) {
</pre>
<center><a href="DefaultLdapDnsProvider.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="LdapDnsProviderService.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>