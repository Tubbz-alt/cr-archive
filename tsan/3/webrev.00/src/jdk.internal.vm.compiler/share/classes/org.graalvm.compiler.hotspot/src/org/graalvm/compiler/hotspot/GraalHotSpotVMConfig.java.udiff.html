<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.hotspot/src/org/graalvm/compiler/hotspot/GraalHotSpotVMConfig.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="CompilerConfigurationFactory.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="GraalHotSpotVMConfigBase.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.hotspot/src/org/graalvm/compiler/hotspot/GraalHotSpotVMConfig.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2011, 2019, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2011, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -52,10 +52,11 @@</span>
          assert check();
      }
  
      private final CompressEncoding oopEncoding;
      private final CompressEncoding klassEncoding;
<span class="udiff-line-added">+     private final String markWord = versioned.markWordFieldType;</span>
  
      public CompressEncoding getOopEncoding() {
          return oopEncoding;
      }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -67,12 +68,10 @@</span>
  
      public final int codeEntryAlignment = getFlag(&quot;CodeEntryAlignment&quot;, Integer.class);
      public final boolean enableContended = getFlag(&quot;EnableContended&quot;, Boolean.class);
      public final boolean restrictContended = getFlag(&quot;RestrictContended&quot;, Boolean.class);
      public final int contendedPaddingWidth = getFlag(&quot;ContendedPaddingWidth&quot;, Integer.class);
<span class="udiff-line-removed">-     public final int fieldsAllocationStyle = getFlag(&quot;FieldsAllocationStyle&quot;, Integer.class);</span>
<span class="udiff-line-removed">-     public final boolean compactFields = getFlag(&quot;CompactFields&quot;, Boolean.class);</span>
      public final boolean verifyOops = getFlag(&quot;VerifyOops&quot;, Boolean.class);
      public final boolean ciTime = getFlag(&quot;CITime&quot;, Boolean.class);
      public final boolean ciTimeEach = getFlag(&quot;CITimeEach&quot;, Boolean.class);
      public final boolean dontCompileHugeMethods = getFlag(&quot;DontCompileHugeMethods&quot;, Boolean.class);
      public final int hugeMethodLimit = getFlag(&quot;HugeMethodLimit&quot;, Integer.class);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -93,22 +92,26 @@</span>
      public final boolean usePopCountInstruction = getFlag(&quot;UsePopCountInstruction&quot;, Boolean.class);
      public final boolean useAESIntrinsics = getFlag(&quot;UseAESIntrinsics&quot;, Boolean.class);
      public final boolean useAESCTRIntrinsics = getFlag(&quot;UseAESCTRIntrinsics&quot;, Boolean.class, false);
      public final boolean useCRC32Intrinsics = getFlag(&quot;UseCRC32Intrinsics&quot;, Boolean.class);
      public final boolean useCRC32CIntrinsics = versioned.useCRC32CIntrinsics;
<span class="udiff-line-modified-removed">-     public final boolean threadLocalHandshakes = getFlag(&quot;ThreadLocalHandshakes&quot;, Boolean.class, false);</span>
<span class="udiff-line-modified-added">+     public final boolean threadLocalHandshakes = versioned.threadLocalHandshakes;</span>
  
      private final boolean useMultiplyToLenIntrinsic = getFlag(&quot;UseMultiplyToLenIntrinsic&quot;, Boolean.class);
      private final boolean useSHA1Intrinsics = getFlag(&quot;UseSHA1Intrinsics&quot;, Boolean.class);
      private final boolean useSHA256Intrinsics = getFlag(&quot;UseSHA256Intrinsics&quot;, Boolean.class);
      private final boolean useSHA512Intrinsics = getFlag(&quot;UseSHA512Intrinsics&quot;, Boolean.class);
      private final boolean useGHASHIntrinsics = getFlag(&quot;UseGHASHIntrinsics&quot;, Boolean.class, false);
<span class="udiff-line-added">+     private final boolean useBase64Intrinsics = getFlag(&quot;UseBASE64Intrinsics&quot;, Boolean.class, false);</span>
      private final boolean useMontgomeryMultiplyIntrinsic = getFlag(&quot;UseMontgomeryMultiplyIntrinsic&quot;, Boolean.class, false);
      private final boolean useMontgomerySquareIntrinsic = getFlag(&quot;UseMontgomerySquareIntrinsic&quot;, Boolean.class, false);
      private final boolean useMulAddIntrinsic = getFlag(&quot;UseMulAddIntrinsic&quot;, Boolean.class, false);
      private final boolean useSquareToLenIntrinsic = getFlag(&quot;UseSquareToLenIntrinsic&quot;, Boolean.class, false);
      public final boolean useVectorizedMismatchIntrinsic = getFlag(&quot;UseVectorizedMismatchIntrinsic&quot;, Boolean.class, false);
<span class="udiff-line-added">+     public final boolean useFMAIntrinsics = getFlag(&quot;UseFMA&quot;, Boolean.class, false);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     public final boolean preserveFramePointer = getFlag(&quot;PreserveFramePointer&quot;, Boolean.class, false);</span>
  
      /*
       * These are methods because in some JDKs the flags are visible but the stubs themselves haven&#39;t
       * been exported so we have to check both if the flag is on and if we have the stub.
       */
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -130,10 +133,14 @@</span>
  
      public boolean useGHASHIntrinsics() {
          return useGHASHIntrinsics &amp;&amp; ghashProcessBlocks != 0;
      }
  
<span class="udiff-line-added">+     public boolean useBase64Intrinsics() {</span>
<span class="udiff-line-added">+         return useBase64Intrinsics &amp;&amp; base64EncodeBlock != 0;</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
      public boolean useMontgomeryMultiplyIntrinsic() {
          return useMontgomeryMultiplyIntrinsic &amp;&amp; montgomeryMultiply != 0;
      }
  
      public boolean useMontgomerySquareIntrinsic() {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -155,11 +162,11 @@</span>
      public boolean inlineNotifyAll() {
          return inlineNotify &amp;&amp; notifyAllAddress != 0;
      }
  
      public final boolean useG1GC = getFlag(&quot;UseG1GC&quot;, Boolean.class);
<span class="udiff-line-modified-removed">-     public final boolean useCMSGC = getFlag(&quot;UseConcMarkSweepGC&quot;, Boolean.class);</span>
<span class="udiff-line-modified-added">+     public final boolean useCMSGC = getFlag(&quot;UseConcMarkSweepGC&quot;, Boolean.class, false);</span>
  
      public final int allocatePrefetchStyle = getFlag(&quot;AllocatePrefetchStyle&quot;, Integer.class);
      public final int allocatePrefetchInstr = getFlag(&quot;AllocatePrefetchInstr&quot;, Integer.class);
      public final int allocatePrefetchLines = getFlag(&quot;AllocatePrefetchLines&quot;, Integer.class);
      public final int allocateInstancePrefetchLines = getFlag(&quot;AllocateInstancePrefetchLines&quot;, Integer.class);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -200,50 +207,22 @@</span>
      public final int stackReservedPages = getFlag(&quot;StackReservedPages&quot;, Integer.class, 0);
      public final boolean useStackBanging = getFlag(&quot;UseStackBanging&quot;, Boolean.class);
      public final int stackBias = getConstant(&quot;STACK_BIAS&quot;, Integer.class);
      public final int vmPageSize = getFieldValue(&quot;CompilerToVM::Data::vm_page_size&quot;, Integer.class, &quot;int&quot;);
  
<span class="udiff-line-modified-removed">-     public final int markOffset = getFieldOffset(&quot;oopDesc::_mark&quot;, Integer.class, &quot;markOop&quot;);</span>
<span class="udiff-line-modified-added">+     public final int markOffset = getFieldOffset(&quot;oopDesc::_mark&quot;, Integer.class, markWord);</span>
      public final int hubOffset = getFieldOffset(&quot;oopDesc::_metadata._klass&quot;, Integer.class, &quot;Klass*&quot;);
  
<span class="udiff-line-modified-removed">-     public final int prototypeMarkWordOffset = getFieldOffset(&quot;Klass::_prototype_header&quot;, Integer.class, &quot;markOop&quot;);</span>
<span class="udiff-line-modified-added">+     public final int prototypeMarkWordOffset = getFieldOffset(&quot;Klass::_prototype_header&quot;, Integer.class, markWord);</span>
      public final int subklassOffset = getFieldOffset(&quot;Klass::_subklass&quot;, Integer.class, &quot;Klass*&quot;);
      public final int nextSiblingOffset = getFieldOffset(&quot;Klass::_next_sibling&quot;, Integer.class, &quot;Klass*&quot;);
      public final int superCheckOffsetOffset = getFieldOffset(&quot;Klass::_super_check_offset&quot;, Integer.class, &quot;juint&quot;);
      public final int secondarySuperCacheOffset = getFieldOffset(&quot;Klass::_secondary_super_cache&quot;, Integer.class, &quot;Klass*&quot;);
      public final int secondarySupersOffset = getFieldOffset(&quot;Klass::_secondary_supers&quot;, Integer.class, &quot;Array&lt;Klass*&gt;*&quot;);
  
<span class="udiff-line-modified-removed">-     public final boolean classMirrorIsHandle;</span>
<span class="udiff-line-modified-removed">-     public final int classMirrorOffset;</span>
<span class="udiff-line-removed">-     {</span>
<span class="udiff-line-removed">-         String name = &quot;Klass::_java_mirror&quot;;</span>
<span class="udiff-line-removed">-         int offset = -1;</span>
<span class="udiff-line-removed">-         boolean isHandle = false;</span>
<span class="udiff-line-removed">-         try {</span>
<span class="udiff-line-removed">-             offset = getFieldOffset(name, Integer.class, &quot;oop&quot;);</span>
<span class="udiff-line-removed">-         } catch (JVMCIError e) {</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-         if (offset == -1) {</span>
<span class="udiff-line-removed">-             try {</span>
<span class="udiff-line-removed">-                 offset = getFieldOffset(name, Integer.class, &quot;jobject&quot;);</span>
<span class="udiff-line-removed">-                 isHandle = true;</span>
<span class="udiff-line-removed">-             } catch (JVMCIError e) {</span>
<span class="udiff-line-removed">-                 try {</span>
<span class="udiff-line-removed">-                     // JDK-8186777</span>
<span class="udiff-line-removed">-                     offset = getFieldOffset(name, Integer.class, &quot;OopHandle&quot;);</span>
<span class="udiff-line-removed">-                     isHandle = true;</span>
<span class="udiff-line-removed">-                 } catch (JVMCIError e2) {</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-         if (offset == -1) {</span>
<span class="udiff-line-removed">-             throw new JVMCIError(&quot;cannot get offset of field &quot; + name + &quot; with type oop, jobject or OopHandle&quot;);</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-         classMirrorOffset = offset;</span>
<span class="udiff-line-removed">-         classMirrorIsHandle = isHandle;</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-modified-added">+     public final boolean classMirrorIsHandle = versioned.classMirrorIsHandle;</span>
<span class="udiff-line-modified-added">+     public final int classMirrorOffset = versioned.classMirrorOffset;</span>
  
      public final int klassSuperKlassOffset = getFieldOffset(&quot;Klass::_super&quot;, Integer.class, &quot;Klass*&quot;);
      public final int klassModifierFlagsOffset = getFieldOffset(&quot;Klass::_modifier_flags&quot;, Integer.class, &quot;jint&quot;);
      public final int klassAccessFlagsOffset = getFieldOffset(&quot;Klass::_access_flags&quot;, Integer.class, &quot;AccessFlags&quot;);
      public final int klassLayoutHelperOffset = getFieldOffset(&quot;Klass::_layout_helper&quot;, Integer.class, &quot;jint&quot;);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -268,16 +247,18 @@</span>
  
      public final int vtableEntrySize = getFieldValue(&quot;CompilerToVM::Data::sizeof_vtableEntry&quot;, Integer.class, &quot;int&quot;);
      public final int vtableEntryMethodOffset = getFieldOffset(&quot;vtableEntry::_method&quot;, Integer.class, &quot;Method*&quot;);
  
      public final int instanceKlassInitStateOffset = getFieldOffset(&quot;InstanceKlass::_init_state&quot;, Integer.class, &quot;u1&quot;);
<span class="udiff-line-added">+     public final int instanceKlassInitThreadOffset = getFieldOffset(&quot;InstanceKlass::_init_thread&quot;, Integer.class, &quot;Thread*&quot;, -1);</span>
      public final int instanceKlassConstantsOffset = getFieldOffset(&quot;InstanceKlass::_constants&quot;, Integer.class, &quot;ConstantPool*&quot;);
      public final int instanceKlassFieldsOffset = getFieldOffset(&quot;InstanceKlass::_fields&quot;, Integer.class, &quot;Array&lt;u2&gt;*&quot;);
      public final int klassVtableStartOffset = getFieldValue(&quot;CompilerToVM::Data::Klass_vtable_start_offset&quot;, Integer.class, &quot;int&quot;);
      public final int klassVtableLengthOffset = getFieldValue(&quot;CompilerToVM::Data::Klass_vtable_length_offset&quot;, Integer.class, &quot;int&quot;);
  
      public final int instanceKlassStateLinked = getConstant(&quot;InstanceKlass::linked&quot;, Integer.class);
<span class="udiff-line-added">+     public final int instanceKlassStateBeingInitialized = getConstant(&quot;InstanceKlass::being_initialized&quot;, Integer.class, -1);</span>
      public final int instanceKlassStateFullyInitialized = getConstant(&quot;InstanceKlass::fully_initialized&quot;, Integer.class);
  
      public final int arrayOopDescSize = getFieldValue(&quot;CompilerToVM::Data::sizeof_arrayOopDesc&quot;, Integer.class, &quot;int&quot;);
  
      /**
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -314,31 +295,35 @@</span>
      public final int jvmAccFieldStable = getConstant(&quot;JVM_ACC_FIELD_STABLE&quot;, Integer.class);
      public final int jvmAccFieldHasGenericSignature = getConstant(&quot;JVM_ACC_FIELD_HAS_GENERIC_SIGNATURE&quot;, Integer.class);
      public final int jvmAccWrittenFlags = getConstant(&quot;JVM_ACC_WRITTEN_FLAGS&quot;, Integer.class);
      public final int jvmAccSynthetic = getConstant(&quot;JVM_ACC_SYNTHETIC&quot;, Integer.class);
  
<span class="udiff-line-modified-removed">-     public final int jvmciCompileStateCanPostOnExceptionsOffset = getJvmciCompileStateCanPostOnExceptionsOffset();</span>
<span class="udiff-line-modified-added">+     public final int jvmciCompileStateCanPostOnExceptionsOffset = getJvmciJvmtiCapabilityOffset(&quot;_jvmti_can_post_on_exceptions&quot;);</span>
<span class="udiff-line-added">+     public final int jvmciCompileStateCanPopFrameOffset = getJvmciJvmtiCapabilityOffset(&quot;_jvmti_can_pop_frame&quot;);</span>
<span class="udiff-line-added">+     public final int jvmciCompileStateCanAccessLocalVariablesOffset = getJvmciJvmtiCapabilityOffset(&quot;_jvmti_can_access_local_variables&quot;);</span>
  
      // Integer.MIN_VALUE if not available
<span class="udiff-line-modified-removed">-     private int getJvmciCompileStateCanPostOnExceptionsOffset() {</span>
<span class="udiff-line-modified-removed">-         int offset = getFieldOffset(&quot;JVMCICompileState::_jvmti_can_post_on_exceptions&quot;, Integer.class, &quot;jbyte&quot;, Integer.MIN_VALUE);</span>
<span class="udiff-line-modified-added">+     private int getJvmciJvmtiCapabilityOffset(String name) {</span>
<span class="udiff-line-modified-added">+         int offset = getFieldOffset(&quot;JVMCICompileState::&quot; + name, Integer.class, &quot;jbyte&quot;, Integer.MIN_VALUE);</span>
          if (offset == Integer.MIN_VALUE) {
              // JDK 12
<span class="udiff-line-modified-removed">-             offset = getFieldOffset(&quot;JVMCIEnv::_jvmti_can_post_on_exceptions&quot;, Integer.class, &quot;jbyte&quot;, Integer.MIN_VALUE);</span>
<span class="udiff-line-modified-added">+             offset = getFieldOffset(&quot;JVMCIEnv::&quot; + name, Integer.class, &quot;jbyte&quot;, Integer.MIN_VALUE);</span>
          }
          return offset;
      }
  
      public final int threadTlabOffset = getFieldOffset(&quot;Thread::_tlab&quot;, Integer.class, &quot;ThreadLocalAllocBuffer&quot;);
      public final int javaThreadAnchorOffset = getFieldOffset(&quot;JavaThread::_anchor&quot;, Integer.class, &quot;JavaFrameAnchor&quot;);
      public final int javaThreadShouldPostOnExceptionsFlagOffset = getFieldOffset(&quot;JavaThread::_should_post_on_exceptions_flag&quot;, Integer.class, &quot;int&quot;, Integer.MIN_VALUE);
      public final int threadObjectOffset = getFieldOffset(&quot;JavaThread::_threadObj&quot;, Integer.class, &quot;oop&quot;);
<span class="udiff-line-modified-removed">-     public final int osThreadOffset = getFieldOffset(&quot;JavaThread::_osthread&quot;, Integer.class, &quot;OSThread*&quot;);</span>
<span class="udiff-line-modified-added">+     public final int osThreadOffset = getFieldOffset(&quot;JavaThread::_osthread&quot;, Integer.class, &quot;OSThread*&quot;, Integer.MAX_VALUE);</span>
      public final int threadIsMethodHandleReturnOffset = getFieldOffset(&quot;JavaThread::_is_method_handle_return&quot;, Integer.class, &quot;int&quot;);
      public final int threadObjectResultOffset = getFieldOffset(&quot;JavaThread::_vm_result&quot;, Integer.class, &quot;oop&quot;);
      public final int jvmciCountersThreadOffset = getFieldOffset(&quot;JavaThread::_jvmci_counters&quot;, Integer.class, &quot;jlong*&quot;);
<span class="udiff-line-added">+     public final int doingUnsafeAccessOffset = getFieldOffset(&quot;JavaThread::_doing_unsafe_access&quot;, Integer.class, &quot;bool&quot;, Integer.MAX_VALUE);</span>
      public final int javaThreadReservedStackActivationOffset = versioned.javaThreadReservedStackActivationOffset;
<span class="udiff-line-added">+     public final int jniEnvironmentOffset = getFieldOffset(&quot;JavaThread::_jni_environment&quot;, Integer.class, &quot;JNIEnv&quot;, Integer.MIN_VALUE);</span>
  
      public boolean requiresReservedStackCheck(List&lt;ResolvedJavaMethod&gt; methods) {
          if (enableStackReservedZoneAddress != 0 &amp;&amp; methods != null) {
              for (ResolvedJavaMethod method : methods) {
                  if (((HotSpotResolvedJavaMethod) method).hasReservedStackAccess()) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -432,58 +417,63 @@</span>
  
      public final int runtimeCallStackSize = getConstant(&quot;frame::arg_reg_save_area_bytes&quot;, Integer.class, intRequiredOnAMD64);
      public final int frameInterpreterFrameSenderSpOffset = getConstant(&quot;frame::interpreter_frame_sender_sp_offset&quot;, Integer.class, intRequiredOnAMD64);
      public final int frameInterpreterFrameLastSpOffset = getConstant(&quot;frame::interpreter_frame_last_sp_offset&quot;, Integer.class, intRequiredOnAMD64);
  
<span class="udiff-line-modified-removed">-     public final int osThreadInterruptedOffset = getFieldOffset(&quot;OSThread::_interrupted&quot;, Integer.class, &quot;jint&quot;);</span>
<span class="udiff-line-modified-added">+     public final int osThreadInterruptedOffset = getFieldOffset(&quot;OSThread::_interrupted&quot;, Integer.class, &quot;jint&quot;, Integer.MAX_VALUE);</span>
  
<span class="udiff-line-modified-removed">-     public final long markOopDescHashShift = getConstant(&quot;markOopDesc::hash_shift&quot;, Long.class);</span>
<span class="udiff-line-modified-added">+     public final long markWordHashShift = getConstant(markWordField(&quot;hash_shift&quot;), Long.class);</span>
  
<span class="udiff-line-modified-removed">-     public final int biasedLockMaskInPlace = getConstant(&quot;markOopDesc::biased_lock_mask_in_place&quot;, Integer.class);</span>
<span class="udiff-line-modified-removed">-     public final int ageMaskInPlace = getConstant(&quot;markOopDesc::age_mask_in_place&quot;, Integer.class);</span>
<span class="udiff-line-modified-removed">-     public final int epochMaskInPlace = getConstant(&quot;markOopDesc::epoch_mask_in_place&quot;, Integer.class);</span>
<span class="udiff-line-modified-removed">-     public final long markOopDescHashMask = getConstant(&quot;markOopDesc::hash_mask&quot;, Long.class);</span>
<span class="udiff-line-modified-removed">-     public final long markOopDescHashMaskInPlace = getConstant(&quot;markOopDesc::hash_mask_in_place&quot;, Long.class);</span>
<span class="udiff-line-modified-added">+     public final int biasedLockMaskInPlace = getConstant(markWordField(&quot;biased_lock_mask_in_place&quot;), Integer.class);</span>
<span class="udiff-line-modified-added">+     public final int ageMaskInPlace = getConstant(markWordField(&quot;age_mask_in_place&quot;), Integer.class);</span>
<span class="udiff-line-modified-added">+     public final int epochMaskInPlace = getConstant(markWordField(&quot;epoch_mask_in_place&quot;), Integer.class);</span>
<span class="udiff-line-modified-added">+     public final long markWordHashMask = getConstant(markWordField(&quot;hash_mask&quot;), Long.class);</span>
<span class="udiff-line-modified-added">+     public final long markWordHashMaskInPlace = getConstant(markWordField(&quot;hash_mask_in_place&quot;), Long.class);</span>
  
<span class="udiff-line-modified-removed">-     public final int unlockedMask = getConstant(&quot;markOopDesc::unlocked_value&quot;, Integer.class);</span>
<span class="udiff-line-modified-removed">-     public final int monitorMask = getConstant(&quot;markOopDesc::monitor_value&quot;, Integer.class, -1);</span>
<span class="udiff-line-modified-removed">-     public final int biasedLockPattern = getConstant(&quot;markOopDesc::biased_lock_pattern&quot;, Integer.class);</span>
<span class="udiff-line-modified-added">+     public final int unlockedMask = getConstant(markWordField(&quot;unlocked_value&quot;), Integer.class);</span>
<span class="udiff-line-modified-added">+     public final int monitorMask = getConstant(markWordField(&quot;monitor_value&quot;), Integer.class, -1);</span>
<span class="udiff-line-modified-added">+     public final int biasedLockPattern = getConstant(markWordField(&quot;biased_lock_pattern&quot;), Integer.class);</span>
  
      // This field has no type in vmStructs.cpp
      public final int objectMonitorOwner = getFieldOffset(&quot;ObjectMonitor::_owner&quot;, Integer.class, null, -1);
      public final int objectMonitorRecursions = getFieldOffset(&quot;ObjectMonitor::_recursions&quot;, Integer.class, &quot;intptr_t&quot;, -1);
      public final int objectMonitorCxq = getFieldOffset(&quot;ObjectMonitor::_cxq&quot;, Integer.class, &quot;ObjectWaiter*&quot;, -1);
      public final int objectMonitorEntryList = getFieldOffset(&quot;ObjectMonitor::_EntryList&quot;, Integer.class, &quot;ObjectWaiter*&quot;, -1);
<span class="udiff-line-added">+     public final int objectMonitorSucc = getFieldOffset(&quot;ObjectMonitor::_succ&quot;, Integer.class, &quot;Thread*&quot;, -1);</span>
  
<span class="udiff-line-modified-removed">-     public final int markWordNoHashInPlace = getConstant(&quot;markOopDesc::no_hash_in_place&quot;, Integer.class);</span>
<span class="udiff-line-modified-removed">-     public final int markWordNoLockInPlace = getConstant(&quot;markOopDesc::no_lock_in_place&quot;, Integer.class);</span>
<span class="udiff-line-modified-added">+     public final int markWordNoHashInPlace = getConstant(markWordField(&quot;no_hash_in_place&quot;), Integer.class);</span>
<span class="udiff-line-modified-added">+     public final int markWordNoLockInPlace = getConstant(markWordField(&quot;no_lock_in_place&quot;), Integer.class);</span>
  
      /**
<span class="udiff-line-modified-removed">-      * See {@code markOopDesc::prototype()}.</span>
<span class="udiff-line-modified-added">+      * See {@code markOopDesc::prototype()}/{@code markWord::prototype()}.</span>
       */
      public long arrayPrototypeMarkWord() {
          return markWordNoHashInPlace | markWordNoLockInPlace;
      }
  
      /**
<span class="udiff-line-modified-removed">-      * See {@code markOopDesc::copy_set_hash()}.</span>
<span class="udiff-line-modified-added">+      * See {@code markOopDesc::copy_set_hash()}/{@code markWord::copy_set_hash()}.</span>
       */
      public long tlabIntArrayMarkWord() {
<span class="udiff-line-modified-removed">-         long tmp = arrayPrototypeMarkWord() &amp; (~markOopDescHashMaskInPlace);</span>
<span class="udiff-line-modified-removed">-         tmp |= ((0x2 &amp; markOopDescHashMask) &lt;&lt; markOopDescHashShift);</span>
<span class="udiff-line-modified-added">+         long tmp = arrayPrototypeMarkWord() &amp; (~markWordHashMaskInPlace);</span>
<span class="udiff-line-modified-added">+         tmp |= ((0x2 &amp; markWordHashMask) &lt;&lt; markWordHashShift);</span>
          return tmp;
      }
  
<span class="udiff-line-added">+     private String markWordField(String simpleName) {</span>
<span class="udiff-line-added">+         return versioned.markWordClassName + &quot;::&quot; + simpleName;</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
      /**
       * Mark word right shift to get identity hash code.
       */
<span class="udiff-line-modified-removed">-     public final int identityHashCodeShift = getConstant(&quot;markOopDesc::hash_shift&quot;, Integer.class);</span>
<span class="udiff-line-modified-added">+     public final int identityHashCodeShift = getConstant(markWordField(&quot;hash_shift&quot;), Integer.class);</span>
  
      /**
       * Identity hash code value when uninitialized.
       */
<span class="udiff-line-modified-removed">-     public final int uninitializedIdentityHashCodeValue = getConstant(&quot;markOopDesc::no_hash&quot;, Integer.class);</span>
<span class="udiff-line-modified-added">+     public final int uninitializedIdentityHashCodeValue = getConstant(markWordField(&quot;no_hash&quot;), Integer.class);</span>
  
      public final int methodAccessFlagsOffset = getFieldOffset(&quot;Method::_access_flags&quot;, Integer.class, &quot;AccessFlags&quot;);
      public final int methodConstMethodOffset = getFieldOffset(&quot;Method::_constMethod&quot;, Integer.class, &quot;ConstMethod*&quot;);
      public final int methodIntrinsicIdOffset = versioned.methodIntrinsicIdOffset;
      public final int methodFlagsOffset = versioned.methodFlagsOffset;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -553,11 +543,11 @@</span>
  
      public final int klassOffset = getFieldValue(&quot;java_lang_Class::_klass_offset&quot;, Integer.class, &quot;int&quot;);
      public final int arrayKlassOffset = getFieldValue(&quot;java_lang_Class::_array_klass_offset&quot;, Integer.class, &quot;int&quot;);
  
      public final int basicLockSize = getFieldValue(&quot;CompilerToVM::Data::sizeof_BasicLock&quot;, Integer.class, &quot;int&quot;);
<span class="udiff-line-modified-removed">-     public final int basicLockDisplacedHeaderOffset = getFieldOffset(&quot;BasicLock::_displaced_header&quot;, Integer.class, &quot;markOop&quot;);</span>
<span class="udiff-line-modified-added">+     public final int basicLockDisplacedHeaderOffset = getFieldOffset(&quot;BasicLock::_displaced_header&quot;, Integer.class, markWord);</span>
  
      public final int threadPollingPageOffset = getFieldOffset(&quot;Thread::_polling_page&quot;, Integer.class, &quot;address&quot;, -1);
      public final int threadAllocatedBytesOffset = getFieldOffset(&quot;Thread::_allocated_bytes&quot;, Integer.class, &quot;jlong&quot;);
  
      public final int tlabRefillWasteIncrement = getFlag(&quot;TLABWasteIncrement&quot;, Integer.class);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -610,22 +600,29 @@</span>
  
      public final int tlabAlignmentReserve = getFieldValue(&quot;CompilerToVM::Data::ThreadLocalAllocBuffer_alignment_reserve&quot;, Integer.class, &quot;size_t&quot;);
  
      public final boolean tlabStats = getFlag(&quot;TLABStats&quot;, Boolean.class);
  
<span class="udiff-line-added">+     // We set 0x10 as default value to disable DC ZVA if this field is not present in HotSpot.</span>
<span class="udiff-line-added">+     // ARMv8-A architecture reference manual D12.2.35 Data Cache Zero ID register says:</span>
<span class="udiff-line-added">+     // * BS, bits [3:0] indicate log2 of the DC ZVA block size in (4-byte) words.</span>
<span class="udiff-line-added">+     // * DZP, bit [4] of indicates whether use of DC ZVA instruction is prohibited.</span>
<span class="udiff-line-added">+     public final int psrInfoDczidValue = getFieldValue(&quot;VM_Version::_psr_info.dczid_el0&quot;, Integer.class, &quot;uint32_t&quot;, 0x10);</span>
<span class="udiff-line-added">+ </span>
      // FIXME This is only temporary until the GC code is changed.
      public final boolean inlineContiguousAllocationSupported = getFieldValue(&quot;CompilerToVM::Data::_supports_inline_contig_alloc&quot;, Boolean.class);
      public final long heapEndAddress = getFieldValue(&quot;CompilerToVM::Data::_heap_end_addr&quot;, Long.class, &quot;HeapWord**&quot;);
      public final long heapTopAddress = versioned.heapTopAddress;
  
      public final boolean cmsIncrementalMode = getFlag(&quot;CMSIncrementalMode&quot;, Boolean.class, false);
  
      public final long inlineCacheMissStub = getFieldValue(&quot;CompilerToVM::Data::SharedRuntime_ic_miss_stub&quot;, Long.class, &quot;address&quot;);
      public final long handleWrongMethodStub = getFieldValue(&quot;CompilerToVM::Data::SharedRuntime_handle_wrong_method_stub&quot;, Long.class, &quot;address&quot;);
  
<span class="udiff-line-modified-removed">-     public final long handleDeoptStub = getFieldValue(&quot;CompilerToVM::Data::SharedRuntime_deopt_blob_unpack&quot;, Long.class, &quot;address&quot;);</span>
<span class="udiff-line-modified-removed">-     public final long uncommonTrapStub = getFieldValue(&quot;CompilerToVM::Data::SharedRuntime_deopt_blob_uncommon_trap&quot;, Long.class, &quot;address&quot;);</span>
<span class="udiff-line-modified-added">+     public final long deoptBlobUnpack = getFieldValue(&quot;CompilerToVM::Data::SharedRuntime_deopt_blob_unpack&quot;, Long.class, &quot;address&quot;);</span>
<span class="udiff-line-modified-added">+     public final long deoptBlobUnpackWithExceptionInTLS = getFieldValue(&quot;CompilerToVM::Data::SharedRuntime_deopt_blob_unpack_with_exception_in_tls&quot;, Long.class, &quot;address&quot;, 0L);</span>
<span class="udiff-line-added">+     public final long deoptBlobUncommonTrap = getFieldValue(&quot;CompilerToVM::Data::SharedRuntime_deopt_blob_uncommon_trap&quot;, Long.class, &quot;address&quot;);</span>
  
      public final long codeCacheLowBound = versioned.codeCacheLowBound;
      public final long codeCacheHighBound = versioned.codeCacheHighBound;
  
      public final long aescryptEncryptBlockStub = getFieldValue(&quot;StubRoutines::_aescrypt_encryptBlock&quot;, Long.class, &quot;address&quot;);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -643,10 +640,11 @@</span>
      public final long sha512ImplCompressMultiBlock = getFieldValue(&quot;StubRoutines::_sha512_implCompressMB&quot;, Long.class, &quot;address&quot;, 0L);
      public final long multiplyToLen = getFieldValue(&quot;StubRoutines::_multiplyToLen&quot;, Long.class, &quot;address&quot;, longRequiredOnAMD64);
  
      public final long counterModeAESCrypt = getFieldValue(&quot;StubRoutines::_counterMode_AESCrypt&quot;, Long.class, &quot;address&quot;, 0L);
      public final long ghashProcessBlocks = getFieldValue(&quot;StubRoutines::_ghash_processBlocks&quot;, Long.class, &quot;address&quot;, 0L);
<span class="udiff-line-added">+     public final long base64EncodeBlock = getFieldValue(&quot;StubRoutines::_base64_encodeBlock&quot;, Long.class, &quot;address&quot;, 0L);</span>
      public final long crc32cTableTddr = getFieldValue(&quot;StubRoutines::_crc32c_table_addr&quot;, Long.class, &quot;address&quot;, 0L);
      public final long updateBytesCRC32C = getFieldValue(&quot;StubRoutines::_updateBytesCRC32C&quot;, Long.class, &quot;address&quot;, 0L);
      public final long updateBytesAdler32 = getFieldValue(&quot;StubRoutines::_updateBytesAdler32&quot;, Long.class, &quot;address&quot;, 0L);
      public final long squareToLen = getFieldValue(&quot;StubRoutines::_squareToLen&quot;, Long.class, &quot;address&quot;, longRequiredOnAMD64);
      public final long mulAdd = getFieldValue(&quot;StubRoutines::_mulAdd&quot;, Long.class, &quot;address&quot;, longRequiredOnAMD64);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -715,11 +713,10 @@</span>
              assert dynamicNewInstanceOrNullAddress != 0L;
          }
          return true;
      }
  
<span class="udiff-line-removed">-     public final long threadIsInterruptedAddress = getAddress(&quot;JVMCIRuntime::thread_is_interrupted&quot;);</span>
      public final long vmMessageAddress = getAddress(&quot;JVMCIRuntime::vm_message&quot;);
      public final long identityHashCodeAddress = getAddress(&quot;JVMCIRuntime::identity_hash_code&quot;);
      public final long exceptionHandlerForPcAddress = getAddress(&quot;JVMCIRuntime::exception_handler_for_pc&quot;);
      public final long monitorenterAddress = getAddress(&quot;JVMCIRuntime::monitorenter&quot;);
      public final long monitorexitAddress = getAddress(&quot;JVMCIRuntime::monitorexit&quot;);
</pre>
<center><a href="CompilerConfigurationFactory.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="GraalHotSpotVMConfigBase.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>