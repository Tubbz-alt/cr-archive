<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.graph/src/org/graalvm/compiler/graph/NodeList.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="NodeClass.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="NodeMap.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.graph/src/org/graalvm/compiler/graph/NodeList.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2011, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
</pre>
<hr />
<pre>
 91 
 92     protected NodeList(Node self, Collection&lt;? extends NodeInterface&gt; elements) {
 93         this.self = self;
 94         if (elements == null || elements.isEmpty()) {
 95             this.size = 0;
 96             this.nodes = EMPTY_NODE_ARRAY;
 97             this.initialSize = 0;
 98         } else {
 99             this.size = elements.size();
100             this.initialSize = elements.size();
101             this.nodes = new Node[elements.size()];
102             int i = 0;
103             for (NodeInterface n : elements) {
104                 this.nodes[i] = n.asNode();
105                 assert this.nodes[i] == null || !this.nodes[i].isDeleted();
106                 i++;
107             }
108         }
109     }
110 
<span class="line-modified">111     public boolean isList() {</span>
<span class="line-modified">112         return true;</span>










113     }
114 
115     protected abstract void update(T oldNode, T newNode);
116 
117     public abstract Edges.Type getEdgesType();
118 
119     @Override
120     public final int size() {
121         return size;
122     }
123 
124     @Override
125     public final boolean isEmpty() {
126         return size == 0;
127     }
128 
129     @Override
130     public boolean isNotEmpty() {
131         return size &gt; 0;
132     }
133 
134     @Override
135     public int count() {
136         return size;
137     }
138 
139     protected final void incModCount() {
140         modCount++;
141     }
142 
143     @SuppressWarnings(&quot;unchecked&quot;)
144     @Override
145     public boolean add(Node node) {
<span class="line-modified">146         assert node == null || !node.isDeleted();</span>
147         self.incModCount();
148         incModCount();
149         int length = nodes.length;
150         if (length == 0) {
151             nodes = new Node[2];
152         } else if (size == length) {
153             Node[] newNodes = new Node[nodes.length * 2 + 1];
154             System.arraycopy(nodes, 0, newNodes, 0, length);
155             nodes = newNodes;
156         }
157         nodes[size++] = node;
158         update(null, (T) node);
159         return true;
160     }
161 
162     @Override
163     @SuppressWarnings(&quot;unchecked&quot;)
164     public T get(int index) {
165         assert assertInRange(index);
166         return (T) nodes[index];
</pre>
<hr />
<pre>
184         update((T) nodes[index], (T) node);
185         nodes[index] = node;
186         return oldValue;
187     }
188 
189     public void initialize(int index, Node node) {
190         incModCount();
191         assert index &lt; size();
192         nodes[index] = node;
193     }
194 
195     void copy(NodeList&lt;? extends Node&gt; other) {
196         self.incModCount();
197         incModCount();
198         Node[] newNodes = new Node[other.size];
199         System.arraycopy(other.nodes, 0, newNodes, 0, newNodes.length);
200         nodes = newNodes;
201         size = other.size;
202     }
203 
<span class="line-modified">204     public boolean equals(NodeList&lt;T&gt; other) {</span>
<span class="line-modified">205         if (size != other.size) {</span>
<span class="line-modified">206             return false;</span>

207         }
<span class="line-modified">208         for (int i = 0; i &lt; size; i++) {</span>
<span class="line-modified">209             if (nodes[i] != other.nodes[i]) {</span>

210                 return false;
211             }






212         }
<span class="line-modified">213         return true;</span>
214     }
215 
216     @SuppressWarnings(&quot;unchecked&quot;)
217     @Override
218     public void clear() {
219         self.incModCount();
220         incModCount();
221         for (int i = 0; i &lt; size; i++) {
222             update((T) nodes[i], null);
223         }
224         clearWithoutUpdate();
225     }
226 
227     void clearWithoutUpdate() {
228         nodes = EMPTY_NODE_ARRAY;
229         size = 0;
230     }
231 
232     @Override
233     @SuppressWarnings(&quot;unchecked&quot;)
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2011, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
</pre>
<hr />
<pre>
 91 
 92     protected NodeList(Node self, Collection&lt;? extends NodeInterface&gt; elements) {
 93         this.self = self;
 94         if (elements == null || elements.isEmpty()) {
 95             this.size = 0;
 96             this.nodes = EMPTY_NODE_ARRAY;
 97             this.initialSize = 0;
 98         } else {
 99             this.size = elements.size();
100             this.initialSize = elements.size();
101             this.nodes = new Node[elements.size()];
102             int i = 0;
103             for (NodeInterface n : elements) {
104                 this.nodes[i] = n.asNode();
105                 assert this.nodes[i] == null || !this.nodes[i].isDeleted();
106                 i++;
107             }
108         }
109     }
110 
<span class="line-modified">111     /**</span>
<span class="line-modified">112      * Removes null values from the list.</span>
<span class="line-added">113      */</span>
<span class="line-added">114     public void trim() {</span>
<span class="line-added">115         int newSize = 0;</span>
<span class="line-added">116         for (int i = 0; i &lt; nodes.length; ++i) {</span>
<span class="line-added">117             if (nodes[i] != null) {</span>
<span class="line-added">118                 nodes[newSize] = nodes[i];</span>
<span class="line-added">119                 newSize++;</span>
<span class="line-added">120             }</span>
<span class="line-added">121         }</span>
<span class="line-added">122         size = newSize;</span>
123     }
124 
125     protected abstract void update(T oldNode, T newNode);
126 
127     public abstract Edges.Type getEdgesType();
128 
129     @Override
130     public final int size() {
131         return size;
132     }
133 
134     @Override
135     public final boolean isEmpty() {
136         return size == 0;
137     }
138 
139     @Override
140     public boolean isNotEmpty() {
141         return size &gt; 0;
142     }
143 
144     @Override
145     public int count() {
146         return size;
147     }
148 
149     protected final void incModCount() {
150         modCount++;
151     }
152 
153     @SuppressWarnings(&quot;unchecked&quot;)
154     @Override
155     public boolean add(Node node) {
<span class="line-modified">156         assert node == null || !node.isDeleted() : node;</span>
157         self.incModCount();
158         incModCount();
159         int length = nodes.length;
160         if (length == 0) {
161             nodes = new Node[2];
162         } else if (size == length) {
163             Node[] newNodes = new Node[nodes.length * 2 + 1];
164             System.arraycopy(nodes, 0, newNodes, 0, length);
165             nodes = newNodes;
166         }
167         nodes[size++] = node;
168         update(null, (T) node);
169         return true;
170     }
171 
172     @Override
173     @SuppressWarnings(&quot;unchecked&quot;)
174     public T get(int index) {
175         assert assertInRange(index);
176         return (T) nodes[index];
</pre>
<hr />
<pre>
194         update((T) nodes[index], (T) node);
195         nodes[index] = node;
196         return oldValue;
197     }
198 
199     public void initialize(int index, Node node) {
200         incModCount();
201         assert index &lt; size();
202         nodes[index] = node;
203     }
204 
205     void copy(NodeList&lt;? extends Node&gt; other) {
206         self.incModCount();
207         incModCount();
208         Node[] newNodes = new Node[other.size];
209         System.arraycopy(other.nodes, 0, newNodes, 0, newNodes.length);
210         nodes = newNodes;
211         size = other.size;
212     }
213 
<span class="line-modified">214     @Override</span>
<span class="line-modified">215     public boolean equals(Object other) {</span>
<span class="line-modified">216         if (other == this) {</span>
<span class="line-added">217             return true;</span>
218         }
<span class="line-modified">219         if (other instanceof List&lt;?&gt;) {</span>
<span class="line-modified">220             List&lt;?&gt; otherList = (List&lt;?&gt;) other;</span>
<span class="line-added">221             if (size != otherList.size()) {</span>
222                 return false;
223             }
<span class="line-added">224             for (int i = 0; i &lt; size; i++) {</span>
<span class="line-added">225                 if (nodes[i] != otherList.get(i)) {</span>
<span class="line-added">226                     return false;</span>
<span class="line-added">227                 }</span>
<span class="line-added">228             }</span>
<span class="line-added">229             return true;</span>
230         }
<span class="line-modified">231         return false;</span>
232     }
233 
234     @SuppressWarnings(&quot;unchecked&quot;)
235     @Override
236     public void clear() {
237         self.incModCount();
238         incModCount();
239         for (int i = 0; i &lt; size; i++) {
240             update((T) nodes[i], null);
241         }
242         clearWithoutUpdate();
243     }
244 
245     void clearWithoutUpdate() {
246         nodes = EMPTY_NODE_ARRAY;
247         size = 0;
248     }
249 
250     @Override
251     @SuppressWarnings(&quot;unchecked&quot;)
</pre>
</td>
</tr>
</table>
<center><a href="NodeClass.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="NodeMap.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>