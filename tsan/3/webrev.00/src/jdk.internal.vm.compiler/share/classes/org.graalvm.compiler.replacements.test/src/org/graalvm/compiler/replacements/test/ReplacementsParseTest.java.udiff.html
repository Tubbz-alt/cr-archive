<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.replacements.test/src/org/graalvm/compiler/replacements/test/ReplacementsParseTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="PointerTest.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="SnippetsTest.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.replacements.test/src/org/graalvm/compiler/replacements/test/ReplacementsParseTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2014, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2014, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -67,11 +67,11 @@</span>
  import org.graalvm.compiler.phases.common.FloatingReadPhase;
  import org.graalvm.compiler.phases.common.FrameStateAssignmentPhase;
  import org.graalvm.compiler.phases.common.GuardLoweringPhase;
  import org.graalvm.compiler.phases.common.LoweringPhase;
  import org.graalvm.compiler.phases.tiers.HighTierContext;
<span class="udiff-line-modified-removed">- import org.graalvm.compiler.test.GraalTest;</span>
<span class="udiff-line-modified-added">+ import org.graalvm.compiler.serviceprovider.JavaVersionUtil;</span>
  import jdk.internal.vm.compiler.word.LocationIdentity;
  import org.junit.Assert;
  import org.junit.Assume;
  import org.junit.BeforeClass;
  import org.junit.Test;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -316,11 +316,11 @@</span>
      }
  
      @Override
      protected void registerInvocationPlugins(InvocationPlugins invocationPlugins) {
          BytecodeProvider replacementBytecodeProvider = getSystemClassLoaderBytecodeProvider();
<span class="udiff-line-modified-removed">-         Registration r = new Registration(invocationPlugins, TestObject.class, replacementBytecodeProvider);</span>
<span class="udiff-line-modified-added">+         Registration r = new Registration(invocationPlugins, TestObject.class, getReplacements(), replacementBytecodeProvider);</span>
          NodeIntrinsicPluginFactory.InjectionProvider injections = new DummyInjectionProvider();
          new PluginFactory_ReplacementsParseTest().registerPlugins(invocationPlugins, injections);
          r.registerMethodSubstitution(TestObjectSubstitutions.class, &quot;nextAfter&quot;, double.class, double.class);
          r.registerMethodSubstitution(TestObjectSubstitutions.class, &quot;stringize&quot;, Object.class);
          r.registerMethodSubstitution(TestObjectSubstitutions.class, &quot;stringizeId&quot;, Receiver.class);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -373,11 +373,11 @@</span>
       * constructor is deleted.
       */
  
      @Test
      public void testNextAfter() {
<span class="udiff-line-modified-removed">-         Assume.assumeFalse(GraalTest.Java8OrEarlier);</span>
<span class="udiff-line-modified-added">+         Assume.assumeFalse(JavaVersionUtil.JAVA_SPEC &lt;= 8);</span>
          double[] inArray = new double[1024];
          double[] outArray = new double[1024];
          for (int i = 0; i &lt; inArray.length; i++) {
              inArray[i] = -0.0;
          }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -428,11 +428,11 @@</span>
          test(options, &quot;callStringize&quot;, Boolean.TRUE);
          String standardReturnValue = IN_INTERPRETED_HANDLER_MARKER;
          String compiledReturnValue = IN_COMPILED_HANDLER_MARKER;
          forceCompileOverride = true;
          inlineInvokeDecision = InlineInvokePlugin.InlineInfo.DO_NOT_INLINE_WITH_EXCEPTION;
<span class="udiff-line-modified-removed">-         inlineInvokeMethodName = &quot;stringizeId&quot;;</span>
<span class="udiff-line-modified-added">+         inlineInvokeMethodName = &quot;stringize&quot;;</span>
          try {
              testWithDifferentReturnValues(options, standardReturnValue, compiledReturnValue, &quot;callStringize&quot;, THROW_EXCEPTION_MARKER);
          } finally {
              inlineInvokeDecision = null;
              inlineInvokeMethodName = null;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -632,11 +632,11 @@</span>
          try (DebugContext.Scope s0 = graph.getDebug().scope(name, graph)) {
              for (OpaqueNode node : graph.getNodes().filter(OpaqueNode.class)) {
                  node.remove();
              }
              HighTierContext context = getDefaultHighTierContext();
<span class="udiff-line-modified-removed">-             CanonicalizerPhase canonicalizer = new CanonicalizerPhase();</span>
<span class="udiff-line-modified-added">+             CanonicalizerPhase canonicalizer = createCanonicalizerPhase();</span>
              new LoweringPhase(canonicalizer, LoweringTool.StandardLoweringStage.HIGH_TIER).apply(graph, context);
              new FloatingReadPhase().apply(graph);
              canonicalizer.apply(graph, context);
              new DeadCodeEliminationPhase().apply(graph);
              new GuardLoweringPhase().apply(graph, getDefaultMidTierContext());
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -679,10 +679,15 @@</span>
  
                      @Override
                      public ForeignCallLinkage lookupForeignCall(ForeignCallDescriptor descriptor) {
                          return null;
                      }
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+                     @Override</span>
<span class="udiff-line-added">+                     public boolean isAvailable(ForeignCallDescriptor descriptor) {</span>
<span class="udiff-line-added">+                         return true;</span>
<span class="udiff-line-added">+                     }</span>
                  };
              }
              if (type == SnippetReflectionProvider.class) {
                  return (T) getSnippetReflection();
              }
</pre>
<center><a href="PointerTest.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="SnippetsTest.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>