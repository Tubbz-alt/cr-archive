<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.replacements.amd64/src/org/graalvm/compiler/replacements/amd64/AMD64GraphBuilderPlugins.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 2015, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 
 25 package org.graalvm.compiler.replacements.amd64;
 26 
 27 import static org.graalvm.compiler.replacements.StandardGraphBuilderPlugins.registerPlatformSpecificUnsafePlugins;
 28 import static org.graalvm.compiler.replacements.nodes.BinaryMathIntrinsicNode.BinaryOperation.POW;
 29 import static org.graalvm.compiler.replacements.nodes.UnaryMathIntrinsicNode.UnaryOperation.COS;
 30 import static org.graalvm.compiler.replacements.nodes.UnaryMathIntrinsicNode.UnaryOperation.EXP;
 31 import static org.graalvm.compiler.replacements.nodes.UnaryMathIntrinsicNode.UnaryOperation.LOG;
 32 import static org.graalvm.compiler.replacements.nodes.UnaryMathIntrinsicNode.UnaryOperation.LOG10;
 33 import static org.graalvm.compiler.replacements.nodes.UnaryMathIntrinsicNode.UnaryOperation.SIN;
 34 import static org.graalvm.compiler.replacements.nodes.UnaryMathIntrinsicNode.UnaryOperation.TAN;
<a name="2" id="anc2"></a>


 35 
 36 import java.util.Arrays;
 37 
<a name="3" id="anc3"></a>
 38 import org.graalvm.compiler.lir.amd64.AMD64ArithmeticLIRGeneratorTool.RoundingMode;
 39 import org.graalvm.compiler.nodes.PauseNode;
 40 import org.graalvm.compiler.nodes.ValueNode;
 41 import org.graalvm.compiler.nodes.graphbuilderconf.GraphBuilderConfiguration.Plugins;
 42 import org.graalvm.compiler.nodes.graphbuilderconf.GraphBuilderContext;
 43 import org.graalvm.compiler.nodes.graphbuilderconf.InvocationPlugin;
 44 import org.graalvm.compiler.nodes.graphbuilderconf.InvocationPlugin.Receiver;
 45 import org.graalvm.compiler.nodes.graphbuilderconf.InvocationPlugins;
 46 import org.graalvm.compiler.nodes.graphbuilderconf.InvocationPlugins.Registration;
 47 import org.graalvm.compiler.nodes.java.AtomicReadAndAddNode;
 48 import org.graalvm.compiler.nodes.java.AtomicReadAndWriteNode;
 49 import org.graalvm.compiler.nodes.memory.address.OffsetAddressNode;
<a name="4" id="anc4"></a><span class="line-added"> 50 import org.graalvm.compiler.nodes.spi.Replacements;</span>
 51 import org.graalvm.compiler.replacements.ArraysSubstitutions;
<a name="5" id="anc5"></a>

 52 import org.graalvm.compiler.replacements.StandardGraphBuilderPlugins.UnsafeAccessPlugin;
 53 import org.graalvm.compiler.replacements.StandardGraphBuilderPlugins.UnsafeGetPlugin;
 54 import org.graalvm.compiler.replacements.StandardGraphBuilderPlugins.UnsafePutPlugin;
<a name="6" id="anc6"></a><span class="line-added"> 55 import org.graalvm.compiler.replacements.TargetGraphBuilderPlugins;</span>
 56 import org.graalvm.compiler.replacements.nodes.BinaryMathIntrinsicNode;
 57 import org.graalvm.compiler.replacements.nodes.BinaryMathIntrinsicNode.BinaryOperation;
 58 import org.graalvm.compiler.replacements.nodes.BitCountNode;
<a name="7" id="anc7"></a><span class="line-added"> 59 import org.graalvm.compiler.replacements.nodes.FusedMultiplyAddNode;</span>
 60 import org.graalvm.compiler.replacements.nodes.UnaryMathIntrinsicNode;
 61 import org.graalvm.compiler.replacements.nodes.UnaryMathIntrinsicNode.UnaryOperation;
<a name="8" id="anc8"></a><span class="line-added"> 62 import org.graalvm.compiler.serviceprovider.JavaVersionUtil;</span>
 63 
 64 import jdk.vm.ci.amd64.AMD64;
 65 import jdk.vm.ci.amd64.AMD64.CPUFeature;
<a name="9" id="anc9"></a><span class="line-added"> 66 import jdk.vm.ci.code.Architecture;</span>
 67 import jdk.vm.ci.meta.JavaKind;
 68 import jdk.vm.ci.meta.ResolvedJavaMethod;
 69 import sun.misc.Unsafe;
 70 
<a name="10" id="anc10"></a><span class="line-modified"> 71 public class AMD64GraphBuilderPlugins implements TargetGraphBuilderPlugins {</span>
<span class="line-added"> 72     @Override</span>
<span class="line-added"> 73     public void register(Plugins plugins, Replacements replacements, Architecture architecture, boolean explicitUnsafeNullChecks,</span>
<span class="line-added"> 74                     boolean registerMathPlugins, boolean emitJDK9StringSubstitutions, boolean useFMAIntrinsics) {</span>
<span class="line-added"> 75         register(plugins, replacements, (AMD64) architecture, explicitUnsafeNullChecks, emitJDK9StringSubstitutions, useFMAIntrinsics);</span>
<span class="line-added"> 76     }</span>
 77 
<a name="11" id="anc11"></a><span class="line-modified"> 78     public static void register(Plugins plugins, Replacements replacements, AMD64 arch, boolean explicitUnsafeNullChecks,</span>
<span class="line-added"> 79                     boolean emitJDK9StringSubstitutions,</span>
<span class="line-added"> 80                     boolean useFMAIntrinsics) {</span>
 81         InvocationPlugins invocationPlugins = plugins.getInvocationPlugins();
 82         invocationPlugins.defer(new Runnable() {
 83             @Override
 84             public void run() {
 85                 registerThreadPlugins(invocationPlugins, arch);
<a name="12" id="anc12"></a><span class="line-modified"> 86                 registerIntegerLongPlugins(invocationPlugins, AMD64IntegerSubstitutions.class, JavaKind.Int, arch, replacements);</span>
<span class="line-modified"> 87                 registerIntegerLongPlugins(invocationPlugins, AMD64LongSubstitutions.class, JavaKind.Long, arch, replacements);</span>
<span class="line-modified"> 88                 registerPlatformSpecificUnsafePlugins(invocationPlugins, replacements, explicitUnsafeNullChecks,</span>
 89                                 new JavaKind[]{JavaKind.Int, JavaKind.Long, JavaKind.Object, JavaKind.Boolean, JavaKind.Byte, JavaKind.Short, JavaKind.Char, JavaKind.Float, JavaKind.Double});
<a name="13" id="anc13"></a><span class="line-modified"> 90                 registerUnsafePlugins(invocationPlugins, replacements, explicitUnsafeNullChecks);</span>
<span class="line-modified"> 91                 registerStringPlugins(invocationPlugins, replacements);</span>
<span class="line-modified"> 92                 if (emitJDK9StringSubstitutions) {</span>
<span class="line-modified"> 93                     registerStringLatin1Plugins(invocationPlugins, replacements);</span>
<span class="line-modified"> 94                     registerStringUTF16Plugins(invocationPlugins, replacements);</span>
<span class="line-modified"> 95                 }</span>
<span class="line-added"> 96                 registerMathPlugins(invocationPlugins, useFMAIntrinsics, arch, replacements);</span>
<span class="line-added"> 97                 registerArraysEqualsPlugins(invocationPlugins, replacements);</span>
 98             }
 99         });
100     }
101 
102     private static void registerThreadPlugins(InvocationPlugins plugins, AMD64 arch) {
<a name="14" id="anc14"></a><span class="line-modified">103         if (JavaVersionUtil.JAVA_SPEC &gt; 8) {</span>
104             // Pause instruction introduced with SSE2
<a name="15" id="anc15"></a><span class="line-modified">105             assert (arch.getFeatures().contains(AMD64.CPUFeature.SSE2));</span>
<span class="line-modified">106             Registration r = new Registration(plugins, Thread.class);</span>
<span class="line-modified">107             r.register0(&quot;onSpinWait&quot;, new InvocationPlugin() {</span>
































108                 @Override
<a name="16" id="anc16"></a><span class="line-modified">109                 public boolean apply(GraphBuilderContext b, ResolvedJavaMethod targetMethod, Receiver receiver) {</span>
<span class="line-modified">110                     b.append(new PauseNode());</span>





111                     return true;
112                 }
113             });
<a name="17" id="anc17"></a>

114         }
<a name="18" id="anc18"></a><span class="line-added">115     }</span>
116 
<a name="19" id="anc19"></a><span class="line-modified">117     private static void registerIntegerLongPlugins(InvocationPlugins plugins, Class&lt;?&gt; substituteDeclaringClass, JavaKind kind, AMD64 arch, Replacements replacements) {</span>
<span class="line-modified">118         Class&lt;?&gt; declaringClass = kind.toBoxedJavaClass();</span>
<span class="line-modified">119         Class&lt;?&gt; type = kind.toJavaClass();</span>
<span class="line-modified">120         Registration r = new Registration(plugins, declaringClass, replacements);</span>
<span class="line-modified">121         r.registerMethodSubstitution(substituteDeclaringClass, &quot;numberOfLeadingZeros&quot;, type);</span>
<span class="line-modified">122         r.registerMethodSubstitution(substituteDeclaringClass, &quot;numberOfTrailingZeros&quot;, type);</span>
<span class="line-modified">123 </span>
<span class="line-modified">124         r.registerConditional1(arch.getFeatures().contains(AMD64.CPUFeature.POPCNT),</span>
<span class="line-modified">125                         &quot;bitCount&quot;, type, new InvocationPlugin() {</span>
<span class="line-added">126                             @Override</span>
<span class="line-added">127                             public boolean apply(GraphBuilderContext b, ResolvedJavaMethod targetMethod, Receiver receiver, ValueNode value) {</span>
<span class="line-added">128                                 b.push(JavaKind.Int, b.append(new BitCountNode(value).canonical(null)));</span>
<span class="line-added">129                                 return true;</span>
<span class="line-added">130                             }</span>
<span class="line-added">131                         });</span>
132     }
133 
<a name="20" id="anc20"></a><span class="line-modified">134     private static void registerMathPlugins(InvocationPlugins plugins, boolean useFMAIntrinsics, AMD64 arch, Replacements replacements) {</span>
<span class="line-modified">135         Registration r = new Registration(plugins, Math.class, replacements);</span>
136         registerUnaryMath(r, &quot;log&quot;, LOG);
137         registerUnaryMath(r, &quot;log10&quot;, LOG10);
138         registerUnaryMath(r, &quot;exp&quot;, EXP);
139         registerBinaryMath(r, &quot;pow&quot;, POW);
140         registerUnaryMath(r, &quot;sin&quot;, SIN);
141         registerUnaryMath(r, &quot;cos&quot;, COS);
142         registerUnaryMath(r, &quot;tan&quot;, TAN);
143 
<a name="21" id="anc21"></a><span class="line-modified">144         boolean roundEnabled = arch.getFeatures().contains(CPUFeature.SSE4_1);</span>
<span class="line-modified">145         registerRound(roundEnabled, r, &quot;rint&quot;, RoundingMode.NEAREST);</span>
<span class="line-modified">146         registerRound(roundEnabled, r, &quot;ceil&quot;, RoundingMode.UP);</span>
<span class="line-modified">147         registerRound(roundEnabled, r, &quot;floor&quot;, RoundingMode.DOWN);</span>
<span class="line-added">148 </span>
<span class="line-added">149         if (JavaVersionUtil.JAVA_SPEC &gt; 8) {</span>
<span class="line-added">150             registerFMA(r, useFMAIntrinsics &amp;&amp; arch.getFeatures().contains(CPUFeature.FMA));</span>
151         }
152     }
153 
<a name="22" id="anc22"></a><span class="line-added">154     private static void registerFMA(Registration r, boolean isEnabled) {</span>
<span class="line-added">155         r.registerConditional3(isEnabled, &quot;fma&quot;,</span>
<span class="line-added">156                         Double.TYPE,</span>
<span class="line-added">157                         Double.TYPE,</span>
<span class="line-added">158                         Double.TYPE,</span>
<span class="line-added">159                         new InvocationPlugin() {</span>
<span class="line-added">160                             @Override</span>
<span class="line-added">161                             public boolean apply(GraphBuilderContext b,</span>
<span class="line-added">162                                             ResolvedJavaMethod targetMethod,</span>
<span class="line-added">163                                             Receiver receiver,</span>
<span class="line-added">164                                             ValueNode na,</span>
<span class="line-added">165                                             ValueNode nb,</span>
<span class="line-added">166                                             ValueNode nc) {</span>
<span class="line-added">167                                 b.push(JavaKind.Double, b.append(new FusedMultiplyAddNode(na, nb, nc)));</span>
<span class="line-added">168                                 return true;</span>
<span class="line-added">169                             }</span>
<span class="line-added">170                         });</span>
<span class="line-added">171         r.registerConditional3(isEnabled, &quot;fma&quot;,</span>
<span class="line-added">172                         Float.TYPE,</span>
<span class="line-added">173                         Float.TYPE,</span>
<span class="line-added">174                         Float.TYPE,</span>
<span class="line-added">175                         new InvocationPlugin() {</span>
<span class="line-added">176                             @Override</span>
<span class="line-added">177                             public boolean apply(GraphBuilderContext b,</span>
<span class="line-added">178                                             ResolvedJavaMethod targetMethod,</span>
<span class="line-added">179                                             Receiver receiver,</span>
<span class="line-added">180                                             ValueNode na,</span>
<span class="line-added">181                                             ValueNode nb,</span>
<span class="line-added">182                                             ValueNode nc) {</span>
<span class="line-added">183                                 b.push(JavaKind.Float, b.append(new FusedMultiplyAddNode(na, nb, nc)));</span>
<span class="line-added">184                                 return true;</span>
<span class="line-added">185                             }</span>
<span class="line-added">186                         });</span>
<span class="line-added">187     }</span>
<span class="line-added">188 </span>
189     private static void registerUnaryMath(Registration r, String name, UnaryOperation operation) {
190         r.register1(name, Double.TYPE, new InvocationPlugin() {
191             @Override
192             public boolean apply(GraphBuilderContext b, ResolvedJavaMethod targetMethod, Receiver receiver, ValueNode value) {
193                 b.push(JavaKind.Double, b.append(UnaryMathIntrinsicNode.create(value, operation)));
194                 return true;
195             }
196         });
197     }
198 
199     private static void registerBinaryMath(Registration r, String name, BinaryOperation operation) {
200         r.register2(name, Double.TYPE, Double.TYPE, new InvocationPlugin() {
201             @Override
202             public boolean apply(GraphBuilderContext b, ResolvedJavaMethod targetMethod, Receiver receiver, ValueNode x, ValueNode y) {
203                 b.push(JavaKind.Double, b.append(BinaryMathIntrinsicNode.create(x, y, operation)));
204                 return true;
205             }
206         });
207     }
208 
<a name="23" id="anc23"></a><span class="line-modified">209     private static void registerRound(boolean isEnabled, Registration r, String name, RoundingMode mode) {</span>
<span class="line-modified">210         r.registerConditional1(isEnabled, name, Double.TYPE, new InvocationPlugin() {</span>
211             @Override
212             public boolean apply(GraphBuilderContext b, ResolvedJavaMethod targetMethod, Receiver receiver, ValueNode arg) {
213                 b.push(JavaKind.Double, b.append(new AMD64RoundNode(arg, mode)));
214                 return true;
215             }
216         });
217     }
218 
<a name="24" id="anc24"></a><span class="line-modified">219     private static void registerStringPlugins(InvocationPlugins plugins, Replacements replacements) {</span>
<span class="line-modified">220         if (JavaVersionUtil.JAVA_SPEC &lt;= 8) {</span>
221             Registration r;
<a name="25" id="anc25"></a><span class="line-modified">222             r = new Registration(plugins, String.class, replacements);</span>
223             r.setAllowOverwrite(true);
224             r.registerMethodSubstitution(AMD64StringSubstitutions.class, &quot;indexOf&quot;, char[].class, int.class,
225                             int.class, char[].class, int.class, int.class, int.class);
226             r.registerMethodSubstitution(AMD64StringSubstitutions.class, &quot;indexOf&quot;, Receiver.class, int.class, int.class);
227             r.registerMethodSubstitution(AMD64StringSubstitutions.class, &quot;compareTo&quot;, Receiver.class, String.class);
228         }
229     }
230 
<a name="26" id="anc26"></a><span class="line-modified">231     private static void registerStringLatin1Plugins(InvocationPlugins plugins, Replacements replacements) {</span>
<span class="line-modified">232         Registration r = new Registration(plugins, &quot;java.lang.StringLatin1&quot;, replacements);</span>
<span class="line-modified">233         r.setAllowOverwrite(true);</span>
<span class="line-modified">234         r.registerMethodSubstitution(AMD64StringLatin1Substitutions.class, &quot;compareTo&quot;, byte[].class, byte[].class);</span>
<span class="line-modified">235         r.registerMethodSubstitution(AMD64StringLatin1Substitutions.class, &quot;compareToUTF16&quot;, byte[].class, byte[].class);</span>
<span class="line-modified">236         r.registerMethodSubstitution(AMD64StringLatin1Substitutions.class, &quot;inflate&quot;, byte[].class, int.class, char[].class, int.class, int.class);</span>
<span class="line-modified">237         r.registerMethodSubstitution(AMD64StringLatin1Substitutions.class, &quot;inflate&quot;, byte[].class, int.class, byte[].class, int.class, int.class);</span>
<span class="line-modified">238         r.registerMethodSubstitution(AMD64StringLatin1Substitutions.class, &quot;indexOf&quot;, byte[].class, int.class, int.class);</span>
<span class="line-modified">239         r.registerMethodSubstitution(AMD64StringLatin1Substitutions.class, &quot;indexOf&quot;, byte[].class, int.class, byte[].class, int.class, int.class);</span>


240     }
241 
<a name="27" id="anc27"></a><span class="line-modified">242     private static void registerStringUTF16Plugins(InvocationPlugins plugins, Replacements replacements) {</span>
<span class="line-modified">243         Registration r = new Registration(plugins, &quot;java.lang.StringUTF16&quot;, replacements);</span>
<span class="line-modified">244         r.setAllowOverwrite(true);</span>
<span class="line-modified">245         r.registerMethodSubstitution(AMD64StringUTF16Substitutions.class, &quot;compareTo&quot;, byte[].class, byte[].class);</span>
<span class="line-modified">246         r.registerMethodSubstitution(AMD64StringUTF16Substitutions.class, &quot;compareToLatin1&quot;, byte[].class, byte[].class);</span>
<span class="line-modified">247         r.registerMethodSubstitution(AMD64StringUTF16Substitutions.class, &quot;compress&quot;, char[].class, int.class, byte[].class, int.class, int.class);</span>
<span class="line-modified">248         r.registerMethodSubstitution(AMD64StringUTF16Substitutions.class, &quot;compress&quot;, byte[].class, int.class, byte[].class, int.class, int.class);</span>
<span class="line-modified">249         r.registerMethodSubstitution(AMD64StringUTF16Substitutions.class, &quot;indexOfCharUnsafe&quot;, byte[].class, int.class, int.class, int.class);</span>
<span class="line-modified">250         r.registerMethodSubstitution(AMD64StringUTF16Substitutions.class, &quot;indexOfUnsafe&quot;, byte[].class, int.class, byte[].class, int.class, int.class);</span>
<span class="line-modified">251         r.registerMethodSubstitution(AMD64StringUTF16Substitutions.class, &quot;indexOfLatin1Unsafe&quot;, byte[].class, int.class, byte[].class, int.class, int.class);</span>


252     }
253 
<a name="28" id="anc28"></a><span class="line-modified">254     private static void registerUnsafePlugins(InvocationPlugins plugins, Replacements replacements, boolean explicitUnsafeNullChecks) {</span>
255         registerUnsafePlugins(new Registration(plugins, Unsafe.class), explicitUnsafeNullChecks, new JavaKind[]{JavaKind.Int, JavaKind.Long, JavaKind.Object}, true);
<a name="29" id="anc29"></a><span class="line-modified">256         if (JavaVersionUtil.JAVA_SPEC &gt; 8) {</span>
<span class="line-modified">257             registerUnsafePlugins(new Registration(plugins, &quot;jdk.internal.misc.Unsafe&quot;, replacements), explicitUnsafeNullChecks,</span>
<span class="line-modified">258                             new JavaKind[]{JavaKind.Boolean, JavaKind.Byte, JavaKind.Char, JavaKind.Short, JavaKind.Int, JavaKind.Long, JavaKind.Object},</span>
<span class="line-added">259                             JavaVersionUtil.JAVA_SPEC &lt;= 11);</span>
260         }
261     }
262 
263     private static void registerUnsafePlugins(Registration r, boolean explicitUnsafeNullChecks, JavaKind[] unsafeJavaKinds, boolean java11OrEarlier) {
264         for (JavaKind kind : unsafeJavaKinds) {
265             Class&lt;?&gt; javaClass = kind == JavaKind.Object ? Object.class : kind.toJavaClass();
266             String kindName = (kind == JavaKind.Object &amp;&amp; !java11OrEarlier) ? &quot;Reference&quot; : kind.name();
267             r.register4(&quot;getAndSet&quot; + kindName, Receiver.class, Object.class, long.class, javaClass, new UnsafeAccessPlugin(kind, explicitUnsafeNullChecks) {
268                 @Override
269                 public boolean apply(GraphBuilderContext b, ResolvedJavaMethod targetMethod, Receiver unsafe, ValueNode object, ValueNode offset, ValueNode value) {
270                     // Emits a null-check for the otherwise unused receiver
271                     unsafe.get();
272                     createUnsafeAccess(object, b, (obj, loc) -&gt; new AtomicReadAndWriteNode(obj, offset, value, kind, loc));
273                     return true;
274                 }
275             });
276             if (kind != JavaKind.Boolean &amp;&amp; kind.isNumericInteger()) {
277                 r.register4(&quot;getAndAdd&quot; + kindName, Receiver.class, Object.class, long.class, javaClass, new UnsafeAccessPlugin(kind, explicitUnsafeNullChecks) {
278                     @Override
279                     public boolean apply(GraphBuilderContext b, ResolvedJavaMethod targetMethod, Receiver unsafe, ValueNode object, ValueNode offset, ValueNode delta) {
280                         // Emits a null-check for the otherwise unused receiver
281                         unsafe.get();
282                         createUnsafeAccess(object, b, (obj, loc) -&gt; new AtomicReadAndAddNode(b.add(new OffsetAddressNode(obj, offset)), delta, kind, loc));
283                         return true;
284                     }
285                 });
286             }
287         }
288 
289         for (JavaKind kind : new JavaKind[]{JavaKind.Char, JavaKind.Short, JavaKind.Int, JavaKind.Long}) {
290             Class&lt;?&gt; javaClass = kind.toJavaClass();
291             r.registerOptional3(&quot;get&quot; + kind.name() + &quot;Unaligned&quot;, Receiver.class, Object.class, long.class, new UnsafeGetPlugin(kind, explicitUnsafeNullChecks));
292             r.registerOptional4(&quot;put&quot; + kind.name() + &quot;Unaligned&quot;, Receiver.class, Object.class, long.class, javaClass, new UnsafePutPlugin(kind, explicitUnsafeNullChecks));
293         }
294     }
295 
<a name="30" id="anc30"></a><span class="line-modified">296     private static void registerArraysEqualsPlugins(InvocationPlugins plugins, Replacements replacements) {</span>
<span class="line-modified">297         Registration r = new Registration(plugins, Arrays.class, replacements);</span>
298         r.registerMethodSubstitution(ArraysSubstitutions.class, &quot;equals&quot;, float[].class, float[].class);
299         r.registerMethodSubstitution(ArraysSubstitutions.class, &quot;equals&quot;, double[].class, double[].class);
300     }
301 }
<a name="31" id="anc31"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="31" type="hidden" />
</body>
</html>