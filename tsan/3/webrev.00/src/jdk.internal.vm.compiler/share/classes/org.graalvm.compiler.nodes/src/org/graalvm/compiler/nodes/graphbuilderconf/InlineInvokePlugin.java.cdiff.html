<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.nodes/src/org/graalvm/compiler/nodes/graphbuilderconf/InlineInvokePlugin.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="GraphBuilderTool.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="IntrinsicContext.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.nodes/src/org/graalvm/compiler/nodes/graphbuilderconf/InlineInvokePlugin.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2015, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2015, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 45,39 ***</span>
  
          /**
           * Denotes a call site that must not be inlined and should be implemented by a node that
           * does not speculate on the call not raising an exception.
           */
<span class="line-modified">!         public static final InlineInfo DO_NOT_INLINE_WITH_EXCEPTION = new InlineInfo(null, null, null);</span>
  
          /**
           * Denotes a call site must not be inlined and can be implemented by a node that speculates
           * the call will not throw an exception.
           */
<span class="line-modified">!         public static final InlineInfo DO_NOT_INLINE_NO_EXCEPTION = new InlineInfo(null, null, null);</span>
  
          /**
           * Denotes a call site must not be inlined and the execution should be transferred to
           * interpreter in case of an exception.
           */
<span class="line-modified">!         public static final InlineInfo DO_NOT_INLINE_DEOPTIMIZE_ON_EXCEPTION = new InlineInfo(null, null, null);</span>
  
          private final ResolvedJavaMethod methodToInline;
<span class="line-modified">!         private final ResolvedJavaMethod originalMethod;</span>
          private final BytecodeProvider intrinsicBytecodeProvider;
  
          public static InlineInfo createStandardInlineInfo(ResolvedJavaMethod methodToInline) {
              return new InlineInfo(methodToInline, null, null);
          }
  
<span class="line-modified">!         public static InlineInfo createIntrinsicInlineInfo(ResolvedJavaMethod methodToInline, ResolvedJavaMethod originalMethod, BytecodeProvider intrinsicBytecodeProvider) {</span>
<span class="line-modified">!             return new InlineInfo(methodToInline, originalMethod, intrinsicBytecodeProvider);</span>
          }
  
<span class="line-modified">!         private InlineInfo(ResolvedJavaMethod methodToInline, ResolvedJavaMethod originalMethod, BytecodeProvider intrinsicBytecodeProvider) {</span>
              this.methodToInline = methodToInline;
<span class="line-modified">!             this.originalMethod = originalMethod;</span>
              this.intrinsicBytecodeProvider = intrinsicBytecodeProvider;
          }
  
          /**
           * Returns the method to be inlined, or {@code null} if the call site must not be inlined.
<span class="line-new-header">--- 45,47 ---</span>
  
          /**
           * Denotes a call site that must not be inlined and should be implemented by a node that
           * does not speculate on the call not raising an exception.
           */
<span class="line-modified">!         public static final InlineInfo DO_NOT_INLINE_WITH_EXCEPTION = new InlineInfo();</span>
  
          /**
           * Denotes a call site must not be inlined and can be implemented by a node that speculates
           * the call will not throw an exception.
           */
<span class="line-modified">!         public static final InlineInfo DO_NOT_INLINE_NO_EXCEPTION = new InlineInfo();</span>
  
          /**
           * Denotes a call site must not be inlined and the execution should be transferred to
           * interpreter in case of an exception.
           */
<span class="line-modified">!         public static final InlineInfo DO_NOT_INLINE_DEOPTIMIZE_ON_EXCEPTION = new InlineInfo();</span>
  
          private final ResolvedJavaMethod methodToInline;
<span class="line-modified">!         private final MethodSubstitutionPlugin plugin;</span>
          private final BytecodeProvider intrinsicBytecodeProvider;
  
          public static InlineInfo createStandardInlineInfo(ResolvedJavaMethod methodToInline) {
              return new InlineInfo(methodToInline, null, null);
          }
  
<span class="line-modified">!         public static InlineInfo createIntrinsicInlineInfo(ResolvedJavaMethod methodToInline, BytecodeProvider intrinsicBytecodeProvider) {</span>
<span class="line-modified">!             return new InlineInfo(methodToInline, null, intrinsicBytecodeProvider);</span>
          }
  
<span class="line-modified">!         public static InlineInfo createMethodSubstitutionInlineInfo(ResolvedJavaMethod methodToInline, MethodSubstitutionPlugin plugin) {</span>
<span class="line-added">+             return new InlineInfo(methodToInline, plugin, plugin.getBytecodeProvider());</span>
<span class="line-added">+         }</span>
<span class="line-added">+ </span>
<span class="line-added">+         private InlineInfo() {</span>
<span class="line-added">+             this(null, null, null);</span>
<span class="line-added">+         }</span>
<span class="line-added">+ </span>
<span class="line-added">+         private InlineInfo(ResolvedJavaMethod methodToInline, MethodSubstitutionPlugin plugin, BytecodeProvider intrinsicBytecodeProvider) {</span>
              this.methodToInline = methodToInline;
<span class="line-modified">!             this.plugin = plugin;</span>
              this.intrinsicBytecodeProvider = intrinsicBytecodeProvider;
          }
  
          /**
           * Returns the method to be inlined, or {@code null} if the call site must not be inlined.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 88,27 ***</span>
  
          public boolean allowsInlining() {
              return methodToInline != null;
          }
  
<span class="line-removed">-         /**</span>
<span class="line-removed">-          * Returns the original method if this is an inline of an intrinsic, or {@code null} if the</span>
<span class="line-removed">-          * call site must not be inlined.</span>
<span class="line-removed">-          */</span>
<span class="line-removed">-         public ResolvedJavaMethod getOriginalMethod() {</span>
<span class="line-removed">-             return originalMethod;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
          /**
           * Gets the provider of bytecode to be parsed for {@link #getMethodToInline()} if is is an
           * intrinsic for the original method (i.e., the {@code method} passed to
           * {@link InlineInvokePlugin#shouldInlineInvoke}). A {@code null} return value indicates
           * that this is not an intrinsic inlining.
           */
          public BytecodeProvider getIntrinsicBytecodeProvider() {
              return intrinsicBytecodeProvider;
          }
      }
  
      /**
       * Determines whether a call to a given method is to be inlined. The return value is a
       * tri-state:
<span class="line-new-header">--- 96,27 ---</span>
  
          public boolean allowsInlining() {
              return methodToInline != null;
          }
  
          /**
           * Gets the provider of bytecode to be parsed for {@link #getMethodToInline()} if is is an
           * intrinsic for the original method (i.e., the {@code method} passed to
           * {@link InlineInvokePlugin#shouldInlineInvoke}). A {@code null} return value indicates
           * that this is not an intrinsic inlining.
           */
          public BytecodeProvider getIntrinsicBytecodeProvider() {
              return intrinsicBytecodeProvider;
          }
<span class="line-added">+ </span>
<span class="line-added">+         public boolean isSubstitution() {</span>
<span class="line-added">+             return plugin != null;</span>
<span class="line-added">+         }</span>
<span class="line-added">+ </span>
<span class="line-added">+         public MethodSubstitutionPlugin getPlugin() {</span>
<span class="line-added">+             return plugin;</span>
<span class="line-added">+         }</span>
      }
  
      /**
       * Determines whether a call to a given method is to be inlined. The return value is a
       * tri-state:
</pre>
<center><a href="GraphBuilderTool.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="IntrinsicContext.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>