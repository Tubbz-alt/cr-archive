<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.core.common/src/org/graalvm/compiler/core/common/util/TypeWriter.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="TypeReader.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../index.html" target="_top">index</a> <a href="UnsafeArrayTypeReader.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.core.common/src/org/graalvm/compiler/core/common/util/TypeWriter.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2015, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2015, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -27,11 +27,10 @@</span>
  /**
   * Provides low-level sequential write access for signed and unsigned values of size 1, 2, 4, and 8
   * bytes.
   */
  public interface TypeWriter {
<span class="udiff-line-removed">- </span>
      /**
       * Returns the number of bytes that have been written, i.e., the byte index of the next byte to
       * be written.
       */
      long getBytesWritten();
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -49,42 +48,20 @@</span>
      void putU2(long value);
  
      /** Writes a signed 4 byte value. */
      void putS4(long value);
  
<span class="udiff-line-added">+     /** Patches a previously written signed 4 byte value at a given offset. */</span>
<span class="udiff-line-added">+     void patchS4(long value, long offset);</span>
<span class="udiff-line-added">+ </span>
      /** Writes an unsigned 4 byte value. */
      void putU4(long value);
  
      /** Writes a signed 8 byte value. */
      void putS8(long value);
  
<span class="udiff-line-modified-removed">-     /**</span>
<span class="udiff-line-modified-removed">-      * Writes a signed value in a variable byte size encoding.</span>
<span class="udiff-line-removed">-      */</span>
<span class="udiff-line-removed">-     default void putSV(long value) {</span>
<span class="udiff-line-removed">-         long cur = value;</span>
<span class="udiff-line-removed">-         while (true) {</span>
<span class="udiff-line-removed">-             if (cur &gt;= -64 &amp;&amp; cur &lt; 64) {</span>
<span class="udiff-line-removed">-                 putU1(cur &amp; 0x7f);</span>
<span class="udiff-line-removed">-                 return;</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-             putU1(0x80 | (cur &amp; 0x7f));</span>
<span class="udiff-line-removed">-             cur = cur &gt;&gt; 7;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-modified-added">+     /** Writes a signed value in a variable byte size encoding. */</span>
<span class="udiff-line-modified-added">+     void putSV(long value);</span>
  
<span class="udiff-line-modified-removed">-     /**</span>
<span class="udiff-line-modified-removed">-      * Writes an unsigned value in a variable byte size encoding.</span>
<span class="udiff-line-removed">-      */</span>
<span class="udiff-line-removed">-     default void putUV(long value) {</span>
<span class="udiff-line-removed">-         long cur = value;</span>
<span class="udiff-line-removed">-         while (true) {</span>
<span class="udiff-line-removed">-             assert cur &gt;= 0;</span>
<span class="udiff-line-removed">-             if (cur &lt; 128) {</span>
<span class="udiff-line-removed">-                 putU1(cur &amp; 0x7f);</span>
<span class="udiff-line-removed">-                 return;</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-             putU1(0x80 | (cur &amp; 0x7f));</span>
<span class="udiff-line-removed">-             cur = cur &gt;&gt; 7;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-modified-added">+     /** Writes an unsigned value in a variable byte size encoding. */</span>
<span class="udiff-line-modified-added">+     void putUV(long value);</span>
  }
</pre>
<center><a href="TypeReader.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../index.html" target="_top">index</a> <a href="UnsafeArrayTypeReader.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>