<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.jtt/src/org/graalvm/compiler/jtt/optimize/TrichotomyTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="NestedLoop_EA.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="../reflect/Field_set02.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.jtt/src/org/graalvm/compiler/jtt/optimize/TrichotomyTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2018, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.
   8  *
   9  * This code is distributed in the hope that it will be useful, but WITHOUT
  10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  12  * version 2 for more details (a copy is included in the LICENSE file that
  13  * accompanied this code).
  14  *
  15  * You should have received a copy of the GNU General Public License version
  16  * 2 along with this work; if not, write to the Free Software Foundation,
  17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18  *
  19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20  * or visit www.oracle.com if you need additional information or have any
  21  * questions.
  22  */
</pre>
<hr />
<pre>
2510         }
2511         return super.bytecodeParserShouldInlineInvoke(b, method, args);
2512     }
2513 
2514     private static void runTest(TrichotomyTest self, FrameworkMethod method) {
2515         String name = method.getName();
2516 
2517         // test correctness
2518         TestCase test = method.getAnnotation(TestCase.class);
2519         Operation op = test.op();
2520         Result result = self.test(name, 0, 0);
2521         Assert.assertEquals(result.returnValue, (op == Operation.EQUAL || op == Operation.SMALLER_EQUAL || op == Operation.GREATER_EQUAL) ? true : false);
2522         result = self.test(name, 0, 1);
2523         Assert.assertEquals(result.returnValue, (op == Operation.SMALLER || op == Operation.SMALLER_EQUAL) ? true : false);
2524         result = self.test(name, 1, 0);
2525         Assert.assertEquals(result.returnValue, (op == Operation.GREATER || op == Operation.GREATER_EQUAL) ? true : false);
2526 
2527         // test folding
2528         StructuredGraph graph = self.parseForCompile(self.getResolvedJavaMethod(name));
2529         HighTierContext context = self.getDefaultHighTierContext();
<span class="line-modified">2530         CanonicalizerPhase canonicalizer = new CanonicalizerPhase();</span>
2531         canonicalizer.apply(graph, context);
2532         Assert.assertTrue(&quot;Too many ConditionalNodes after canonicalization&quot;, graph.getNodes().filter(ConditionalNode.class).count() &lt;= 1);
2533         Assert.assertTrue(&quot;Unexpected IfNodes after canonicalization&quot;, graph.getNodes().filter(IfNode.class).isEmpty());
2534     }
2535 
2536     public static class Runner extends BlockJUnit4ClassRunner {
2537         public Runner(Class&lt;?&gt; klass) throws InitializationError {
2538             super(klass);
2539         }
2540 
2541         @Override
2542         protected List&lt;FrameworkMethod&gt; computeTestMethods() {
2543             return getTestClass().getAnnotatedMethods(TestCase.class);
2544         }
2545 
2546         @Override
2547         protected void runChild(FrameworkMethod method, RunNotifier notifier) {
2548             super.runChild(method, notifier);
2549         }
2550 
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2018, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.
   8  *
   9  * This code is distributed in the hope that it will be useful, but WITHOUT
  10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  12  * version 2 for more details (a copy is included in the LICENSE file that
  13  * accompanied this code).
  14  *
  15  * You should have received a copy of the GNU General Public License version
  16  * 2 along with this work; if not, write to the Free Software Foundation,
  17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18  *
  19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20  * or visit www.oracle.com if you need additional information or have any
  21  * questions.
  22  */
</pre>
<hr />
<pre>
2510         }
2511         return super.bytecodeParserShouldInlineInvoke(b, method, args);
2512     }
2513 
2514     private static void runTest(TrichotomyTest self, FrameworkMethod method) {
2515         String name = method.getName();
2516 
2517         // test correctness
2518         TestCase test = method.getAnnotation(TestCase.class);
2519         Operation op = test.op();
2520         Result result = self.test(name, 0, 0);
2521         Assert.assertEquals(result.returnValue, (op == Operation.EQUAL || op == Operation.SMALLER_EQUAL || op == Operation.GREATER_EQUAL) ? true : false);
2522         result = self.test(name, 0, 1);
2523         Assert.assertEquals(result.returnValue, (op == Operation.SMALLER || op == Operation.SMALLER_EQUAL) ? true : false);
2524         result = self.test(name, 1, 0);
2525         Assert.assertEquals(result.returnValue, (op == Operation.GREATER || op == Operation.GREATER_EQUAL) ? true : false);
2526 
2527         // test folding
2528         StructuredGraph graph = self.parseForCompile(self.getResolvedJavaMethod(name));
2529         HighTierContext context = self.getDefaultHighTierContext();
<span class="line-modified">2530         CanonicalizerPhase canonicalizer = self.createCanonicalizerPhase();</span>
2531         canonicalizer.apply(graph, context);
2532         Assert.assertTrue(&quot;Too many ConditionalNodes after canonicalization&quot;, graph.getNodes().filter(ConditionalNode.class).count() &lt;= 1);
2533         Assert.assertTrue(&quot;Unexpected IfNodes after canonicalization&quot;, graph.getNodes().filter(IfNode.class).isEmpty());
2534     }
2535 
2536     public static class Runner extends BlockJUnit4ClassRunner {
2537         public Runner(Class&lt;?&gt; klass) throws InitializationError {
2538             super(klass);
2539         }
2540 
2541         @Override
2542         protected List&lt;FrameworkMethod&gt; computeTestMethods() {
2543             return getTestClass().getAnnotatedMethods(TestCase.class);
2544         }
2545 
2546         @Override
2547         protected void runChild(FrameworkMethod method, RunNotifier notifier) {
2548             super.runChild(method, notifier);
2549         }
2550 
</pre>
</td>
</tr>
</table>
<center><a href="NestedLoop_EA.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="../reflect/Field_set02.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>