<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/runtime/JavaThread.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Flags.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="OSThread.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/runtime/JavaThread.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 39,11 ***</span>
      instantiated by the JavaThreadFactory in the Threads class. */
  
  public class JavaThread extends Thread {
    private static final boolean DEBUG = System.getProperty(&quot;sun.jvm.hotspot.runtime.JavaThread.DEBUG&quot;) != null;
  
<span class="line-removed">-   private static AddressField  nextField;</span>
    private static sun.jvm.hotspot.types.OopField threadObjField;
    private static AddressField  anchorField;
    private static AddressField  lastJavaSPField;
    private static AddressField  lastJavaPCField;
    private static CIntegerField threadStateField;
<span class="line-new-header">--- 39,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 82,11 ***</span>
  
    private static synchronized void initialize(TypeDataBase db) {
      Type type = db.lookupType(&quot;JavaThread&quot;);
      Type anchorType = db.lookupType(&quot;JavaFrameAnchor&quot;);
  
<span class="line-removed">-     nextField         = type.getAddressField(&quot;_next&quot;);</span>
      threadObjField    = type.getOopField(&quot;_threadObj&quot;);
      anchorField       = type.getAddressField(&quot;_anchor&quot;);
      lastJavaSPField   = anchorType.getAddressField(&quot;_last_Java_sp&quot;);
      lastJavaPCField   = anchorType.getAddressField(&quot;_last_Java_pc&quot;);
      threadStateField  = type.getCIntegerField(&quot;_thread_state&quot;);
<span class="line-new-header">--- 81,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 118,19 ***</span>
  
    void setThreadPDAccess(JavaThreadPDAccess access) {
      this.access = access;
    }
  
<span class="line-removed">-   public JavaThread next() {</span>
<span class="line-removed">-     Address threadAddr = nextField.getValue(addr);</span>
<span class="line-removed">-     if (threadAddr == null) {</span>
<span class="line-removed">-       return null;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     return VM.getVM().getThreads().createJavaThreadWrapper(threadAddr);</span>
<span class="line-removed">-   }</span>
<span class="line-removed">- </span>
    /** NOTE: for convenience, this differs in definition from the underlying VM.
        Only &quot;pure&quot; JavaThreads return true; CompilerThreads, the CodeCacheSweeperThread,
        JVMDIDebuggerThreads return false.
        FIXME:
        consider encapsulating platform-specific functionality in an
<span class="line-new-header">--- 116,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 393,18 ***</span>
      }
      Address sp      = lastSPDbg();
      Address stackBase = getStackBase();
      // Be robust
      if (sp == null) return false;
<span class="line-modified">!     return stackBase.greaterThanOrEqual(a) &amp;&amp; sp.lessThanOrEqual(a);</span>
    }
  
    public boolean isLockOwned(Address a) {
      Address stackBase = getStackBase();
      Address stackLimit = stackBase.addOffsetTo(-getStackSize());
  
<span class="line-modified">!     return stackBase.greaterThanOrEqual(a) &amp;&amp; stackLimit.lessThanOrEqual(a);</span>
  
      // FIXME: should traverse MonitorArray/MonitorChunks as in VM
    }
  
    public Oop getCurrentParkBlocker() {
<span class="line-new-header">--- 382,18 ---</span>
      }
      Address sp      = lastSPDbg();
      Address stackBase = getStackBase();
      // Be robust
      if (sp == null) return false;
<span class="line-modified">!     return stackBase.greaterThan(a) &amp;&amp; sp.lessThanOrEqual(a);</span>
    }
  
    public boolean isLockOwned(Address a) {
      Address stackBase = getStackBase();
      Address stackLimit = stackBase.addOffsetTo(-getStackSize());
  
<span class="line-modified">!     return stackBase.greaterThan(a) &amp;&amp; stackLimit.lessThanOrEqual(a);</span>
  
      // FIXME: should traverse MonitorArray/MonitorChunks as in VM
    }
  
    public Oop getCurrentParkBlocker() {
</pre>
<center><a href="Flags.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="OSThread.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>