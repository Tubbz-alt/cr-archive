<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/runtime/JavaThread.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Flags.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="OSThread.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/runtime/JavaThread.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -39,11 +39,10 @@</span>
      instantiated by the JavaThreadFactory in the Threads class. */
  
  public class JavaThread extends Thread {
    private static final boolean DEBUG = System.getProperty(&quot;sun.jvm.hotspot.runtime.JavaThread.DEBUG&quot;) != null;
  
<span class="udiff-line-removed">-   private static AddressField  nextField;</span>
    private static sun.jvm.hotspot.types.OopField threadObjField;
    private static AddressField  anchorField;
    private static AddressField  lastJavaSPField;
    private static AddressField  lastJavaPCField;
    private static CIntegerField threadStateField;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -82,11 +81,10 @@</span>
  
    private static synchronized void initialize(TypeDataBase db) {
      Type type = db.lookupType(&quot;JavaThread&quot;);
      Type anchorType = db.lookupType(&quot;JavaFrameAnchor&quot;);
  
<span class="udiff-line-removed">-     nextField         = type.getAddressField(&quot;_next&quot;);</span>
      threadObjField    = type.getOopField(&quot;_threadObj&quot;);
      anchorField       = type.getAddressField(&quot;_anchor&quot;);
      lastJavaSPField   = anchorType.getAddressField(&quot;_last_Java_sp&quot;);
      lastJavaPCField   = anchorType.getAddressField(&quot;_last_Java_pc&quot;);
      threadStateField  = type.getCIntegerField(&quot;_thread_state&quot;);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -118,19 +116,10 @@</span>
  
    void setThreadPDAccess(JavaThreadPDAccess access) {
      this.access = access;
    }
  
<span class="udiff-line-removed">-   public JavaThread next() {</span>
<span class="udiff-line-removed">-     Address threadAddr = nextField.getValue(addr);</span>
<span class="udiff-line-removed">-     if (threadAddr == null) {</span>
<span class="udiff-line-removed">-       return null;</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     return VM.getVM().getThreads().createJavaThreadWrapper(threadAddr);</span>
<span class="udiff-line-removed">-   }</span>
<span class="udiff-line-removed">- </span>
    /** NOTE: for convenience, this differs in definition from the underlying VM.
        Only &quot;pure&quot; JavaThreads return true; CompilerThreads, the CodeCacheSweeperThread,
        JVMDIDebuggerThreads return false.
        FIXME:
        consider encapsulating platform-specific functionality in an
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -393,18 +382,18 @@</span>
      }
      Address sp      = lastSPDbg();
      Address stackBase = getStackBase();
      // Be robust
      if (sp == null) return false;
<span class="udiff-line-modified-removed">-     return stackBase.greaterThanOrEqual(a) &amp;&amp; sp.lessThanOrEqual(a);</span>
<span class="udiff-line-modified-added">+     return stackBase.greaterThan(a) &amp;&amp; sp.lessThanOrEqual(a);</span>
    }
  
    public boolean isLockOwned(Address a) {
      Address stackBase = getStackBase();
      Address stackLimit = stackBase.addOffsetTo(-getStackSize());
  
<span class="udiff-line-modified-removed">-     return stackBase.greaterThanOrEqual(a) &amp;&amp; stackLimit.lessThanOrEqual(a);</span>
<span class="udiff-line-modified-added">+     return stackBase.greaterThan(a) &amp;&amp; stackLimit.lessThanOrEqual(a);</span>
  
      // FIXME: should traverse MonitorArray/MonitorChunks as in VM
    }
  
    public Oop getCurrentParkBlocker() {
</pre>
<center><a href="Flags.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="OSThread.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>