<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/gc/g1/HeapRegion.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="G1CollectedHeap.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../shared/GCName.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/gc/g1/HeapRegion.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -43,13 +43,16 @@</span>
  
  // Mirror class for HeapRegion. Currently we don&#39;t actually include
  // any of its fields but only iterate over it.
  
  public class HeapRegion extends CompactibleSpace implements LiveRegionsProvider {
<span class="udiff-line-modified-removed">-     // static int GrainBytes;</span>
<span class="udiff-line-removed">-     static private CIntegerField grainBytesField;</span>
<span class="udiff-line-modified-added">+     private static AddressField bottomField;</span>
      static private AddressField topField;
<span class="udiff-line-added">+     private static AddressField endField;</span>
<span class="udiff-line-added">+     private static AddressField compactionTopField;</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     static private CIntegerField grainBytesField;</span>
      private static long typeFieldOffset;
      private static long pointerSize;
  
      private HeapRegionType type;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -62,12 +65,16 @@</span>
      }
  
      static private synchronized void initialize(TypeDataBase db) {
          Type type = db.lookupType(&quot;HeapRegion&quot;);
  
<span class="udiff-line-modified-removed">-         grainBytesField = type.getCIntegerField(&quot;GrainBytes&quot;);</span>
<span class="udiff-line-modified-added">+         bottomField = type.getAddressField(&quot;_bottom&quot;);</span>
          topField = type.getAddressField(&quot;_top&quot;);
<span class="udiff-line-added">+         endField = type.getAddressField(&quot;_end&quot;);</span>
<span class="udiff-line-added">+         compactionTopField = type.getAddressField(&quot;_compaction_top&quot;);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         grainBytesField = type.getCIntegerField(&quot;GrainBytes&quot;);</span>
          typeFieldOffset = type.getField(&quot;_type&quot;).getOffset();
  
          pointerSize = db.lookupType(&quot;HeapRegion*&quot;).getSize();
      }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -80,27 +87,33 @@</span>
          Address typeAddr = (addr instanceof OopHandle) ? addr.addOffsetToAsOopHandle(typeFieldOffset)
                                                         : addr.addOffsetTo(typeFieldOffset);
          type = (HeapRegionType)VMObjectFactory.newObject(HeapRegionType.class, typeAddr);
      }
  
<span class="udiff-line-modified-removed">-     public Address top() {</span>
<span class="udiff-line-modified-removed">-         return topField.getValue(addr);</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+     public Address bottom()        { return bottomField.getValue(addr); }</span>
<span class="udiff-line-modified-added">+     public Address top()           { return topField.getValue(addr); }</span>
<span class="udiff-line-modified-added">+     public Address end()           { return endField.getValue(addr); }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     public Address compactionTop() { return compactionTopField.getValue(addr); }</span>
  
      @Override
      public List&lt;MemRegion&gt; getLiveRegions() {
          List&lt;MemRegion&gt; res = new ArrayList&lt;&gt;();
          res.add(new MemRegion(bottom(), top()));
          return res;
      }
  
<span class="udiff-line-modified-removed">-     @Override</span>
<span class="udiff-line-modified-added">+     /** Returns a subregion of the space containing all the objects in</span>
<span class="udiff-line-added">+         the space. */</span>
<span class="udiff-line-added">+     public MemRegion usedRegion() {</span>
<span class="udiff-line-added">+         return new MemRegion(bottom(), end());</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
      public long used() {
          return top().minus(bottom());
      }
  
<span class="udiff-line-removed">-     @Override</span>
      public long free() {
          return end().minus(top());
      }
  
      public boolean isFree() {
</pre>
<center><a href="G1CollectedHeap.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../shared/GCName.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>