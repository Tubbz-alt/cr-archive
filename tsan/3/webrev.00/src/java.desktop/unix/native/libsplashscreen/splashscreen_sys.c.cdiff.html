<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/unix/native/libsplashscreen/splashscreen_sys.c</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../libawt_xawt/xawt/XWindow.c.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../../../windows/classes/com/sun/java/swing/plaf/windows/resources/windows.properties.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/unix/native/libsplashscreen/splashscreen_sys.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2005, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2005, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 403,11 ***</span>
      SplashCleanup(SplashGetInstance());
      pthread_exit(NULL);
      return 0;
  }
  
<span class="line-modified">! void</span>
  SplashInitPlatform(Splash * splash) {
      int shapeVersionMajor, shapeVersionMinor;
  
      // This setting enables the synchronous Xlib mode!
      // Don&#39;t use it == 1 in production builds!
<span class="line-new-header">--- 403,11 ---</span>
      SplashCleanup(SplashGetInstance());
      pthread_exit(NULL);
      return 0;
  }
  
<span class="line-modified">! int</span>
  SplashInitPlatform(Splash * splash) {
      int shapeVersionMajor, shapeVersionMinor;
  
      // This setting enables the synchronous Xlib mode!
      // Don&#39;t use it == 1 in production builds!
</pre>
<hr />
<pre>
<span class="line-old-header">*** 422,11 ***</span>
  //    XSetIOErrorHandler(HandleIOError);
      XSetIOErrorHandler(NULL);
      splash-&gt;display = XOpenDisplay(NULL);
      if (!splash-&gt;display) {
          splash-&gt;isVisible = -1;
<span class="line-modified">!         return;</span>
      }
  
      shapeSupported = XShapeQueryExtension(splash-&gt;display, &amp;shapeEventBase,
              &amp;shapeErrorBase);
      if (shapeSupported) {
<span class="line-new-header">--- 422,11 ---</span>
  //    XSetIOErrorHandler(HandleIOError);
      XSetIOErrorHandler(NULL);
      splash-&gt;display = XOpenDisplay(NULL);
      if (!splash-&gt;display) {
          splash-&gt;isVisible = -1;
<span class="line-modified">!         return 0;</span>
      }
  
      shapeSupported = XShapeQueryExtension(splash-&gt;display, &amp;shapeEventBase,
              &amp;shapeErrorBase);
      if (shapeSupported) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 472,11 ***</span>
                  splash-&gt;isVisible = -1;
                  splash-&gt;display = NULL;
                  splash-&gt;screen = NULL;
                  splash-&gt;visual = NULL;
                  fprintf(stderr, &quot;Warning: unable to initialize the splashscreen. Not enough available color cells.\n&quot;);
<span class="line-modified">!                 return;</span>
              }
              splash-&gt;cmap = AllocColors(splash-&gt;display, splash-&gt;screen,
                      numColors, colorIndex);
              for (i = 0; i &lt; numColors; i++) {
                  splash-&gt;colorIndex[i] = colorIndex[i];
<span class="line-new-header">--- 472,11 ---</span>
                  splash-&gt;isVisible = -1;
                  splash-&gt;display = NULL;
                  splash-&gt;screen = NULL;
                  splash-&gt;visual = NULL;
                  fprintf(stderr, &quot;Warning: unable to initialize the splashscreen. Not enough available color cells.\n&quot;);
<span class="line-modified">!                 return 0;</span>
              }
              splash-&gt;cmap = AllocColors(splash-&gt;display, splash-&gt;screen,
                      numColors, colorIndex);
              for (i = 0; i &lt; numColors; i++) {
                  splash-&gt;colorIndex[i] = colorIndex[i];
</pre>
<hr />
<pre>
<span class="line-old-header">*** 504,10 ***</span>
<span class="line-new-header">--- 504,11 ---</span>
              break;
          }
      default:
          ; /* FIXME: should probably be fixed, but javaws splash screen doesn&#39;t support other visuals either */
      }
<span class="line-added">+     return 1;</span>
  }
  
  
  void
  SplashCleanupPlatform(Splash * splash) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 799,11 ***</span>
  void
  SplashReconfigure(Splash * splash) {
      sendctl(splash, SPLASHCTL_RECONFIGURE);
  }
  
<span class="line-modified">! JNIEXPORT jboolean JNICALL</span>
  SplashGetScaledImageName(const char* jarName, const char* fileName,
                             float *scaleFactor, char *scaledImgName,
                             const size_t scaledImageNameLength)
  {
      *scaleFactor = 1;
<span class="line-new-header">--- 800,11 ---</span>
  void
  SplashReconfigure(Splash * splash) {
      sendctl(splash, SPLASHCTL_RECONFIGURE);
  }
  
<span class="line-modified">! JNIEXPORT jboolean</span>
  SplashGetScaledImageName(const char* jarName, const char* fileName,
                             float *scaleFactor, char *scaledImgName,
                             const size_t scaledImageNameLength)
  {
      *scaleFactor = 1;
</pre>
<center><a href="../libawt_xawt/xawt/XWindow.c.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../../../windows/classes/com/sun/java/swing/plaf/windows/resources/windows.properties.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>