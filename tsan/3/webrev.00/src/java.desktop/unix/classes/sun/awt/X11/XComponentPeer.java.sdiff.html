<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/unix/classes/sun/awt/X11/XComponentPeer.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="XBaseWindow.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="XConstants.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/unix/classes/sun/awt/X11/XComponentPeer.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2002, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */

  25 package sun.awt.X11;
  26 
  27 import java.awt.AWTEvent;
  28 import java.awt.AWTException;
  29 import java.awt.BufferCapabilities;
  30 import java.awt.Color;
  31 import java.awt.Component;
  32 import java.awt.Container;
  33 import java.awt.Cursor;
  34 import java.awt.Dimension;
  35 import java.awt.Font;
  36 import java.awt.FontMetrics;
  37 import java.awt.Graphics;
  38 import java.awt.GraphicsConfiguration;
  39 import java.awt.Image;
  40 import java.awt.Insets;
  41 import java.awt.Rectangle;
  42 import java.awt.SystemColor;
  43 import java.awt.Toolkit;
  44 import java.awt.Window;
  45 import java.awt.dnd.DropTarget;
  46 import java.awt.dnd.peer.DropTargetPeer;
  47 import java.awt.event.FocusEvent;
  48 import java.awt.event.InputEvent;
  49 import java.awt.event.InputMethodEvent;
  50 import java.awt.event.KeyEvent;
  51 import java.awt.event.MouseEvent;
  52 import java.awt.event.MouseWheelEvent;
  53 import java.awt.event.PaintEvent;
  54 import java.awt.event.WindowEvent;
<span class="line-removed">  55 import java.awt.image.ImageObserver;</span>
<span class="line-removed">  56 import java.awt.image.ImageProducer;</span>
  57 import java.awt.image.VolatileImage;
  58 import java.awt.peer.ComponentPeer;
  59 import java.awt.peer.ContainerPeer;
  60 import java.util.Collection;
  61 import java.util.Objects;
  62 import java.util.Set;
  63 

  64 import sun.awt.AWTAccessor.ComponentAccessor;
<span class="line-modified">  65 import sun.util.logging.PlatformLogger;</span>
<span class="line-modified">  66 import sun.awt.*;</span>
  67 import sun.awt.event.IgnorePaintEvent;
  68 import sun.awt.image.SunVolatileImage;
<span class="line-removed">  69 import sun.awt.image.ToolkitImage;</span>
  70 import sun.java2d.BackBufferCapsProvider;
  71 import sun.java2d.pipe.Region;

  72 
  73 
  74 public class XComponentPeer extends XWindow implements ComponentPeer, DropTargetPeer,
  75     BackBufferCapsProvider
  76 {
  77     private static final PlatformLogger log = PlatformLogger.getLogger(&quot;sun.awt.X11.XComponentPeer&quot;);
  78     private static final PlatformLogger buffersLog = PlatformLogger.getLogger(&quot;sun.awt.X11.XComponentPeer.multibuffer&quot;);
  79     private static final PlatformLogger focusLog = PlatformLogger.getLogger(&quot;sun.awt.X11.focus.XComponentPeer&quot;);
  80     private static final PlatformLogger fontLog = PlatformLogger.getLogger(&quot;sun.awt.X11.font.XComponentPeer&quot;);
  81     private static final PlatformLogger enableLog = PlatformLogger.getLogger(&quot;sun.awt.X11.enable.XComponentPeer&quot;);
  82     private static final PlatformLogger shapeLog = PlatformLogger.getLogger(&quot;sun.awt.X11.shape.XComponentPeer&quot;);
  83 
  84     boolean paintPending = false;
  85     boolean isLayouting = false;
  86     private boolean enabled;
  87 
  88     // Actually used only by XDecoratedPeer
  89     protected int boundsOperation;
  90 
  91     Color foreground;
</pre>
<hr />
<pre>
 693      */
 694     //ignoreSubComponents not used here
 695     public void pSetCursor(Cursor cursor, boolean ignoreSubComponents) {
 696         XToolkit.awtLock();
 697         try {
 698             long xcursor = XGlobalCursorManager.getCursor(cursor);
 699 
 700             XSetWindowAttributes xwa = new XSetWindowAttributes();
 701             xwa.set_cursor(xcursor);
 702 
 703             long valuemask = XConstants.CWCursor;
 704 
 705             XlibWrapper.XChangeWindowAttributes(XToolkit.getDisplay(),getWindow(),valuemask,xwa.pData);
 706             XlibWrapper.XFlush(XToolkit.getDisplay());
 707             xwa.dispose();
 708         } finally {
 709             XToolkit.awtUnlock();
 710         }
 711     }
 712 
<span class="line-removed"> 713     public Image createImage(ImageProducer producer) {</span>
<span class="line-removed"> 714         return new ToolkitImage(producer);</span>
<span class="line-removed"> 715     }</span>
<span class="line-removed"> 716 </span>
 717     public Image createImage(int width, int height) {
 718         return graphicsConfig.createAcceleratedImage(target, width, height);
 719     }
 720 
 721     public VolatileImage createVolatileImage(int width, int height) {
 722         return new SunVolatileImage(target, width, height);
 723     }
 724 
<span class="line-removed"> 725     public boolean prepareImage(Image img, int w, int h, ImageObserver o) {</span>
<span class="line-removed"> 726         return Toolkit.getDefaultToolkit().prepareImage(img, w, h, o);</span>
<span class="line-removed"> 727     }</span>
<span class="line-removed"> 728 </span>
<span class="line-removed"> 729     public int checkImage(Image img, int w, int h, ImageObserver o) {</span>
<span class="line-removed"> 730         return Toolkit.getDefaultToolkit().checkImage(img, w, h, o);</span>
<span class="line-removed"> 731     }</span>
<span class="line-removed"> 732 </span>
 733     public Insets getInsets() {
 734         return new Insets(0, 0, 0, 0);
 735     }
 736 
 737     public void beginValidate() {
 738     }
 739 
 740     public void endValidate() {
 741     }
 742 
 743     // Returns true if we are inside begin/endLayout and
 744     // are waiting for native painting
 745     public boolean isPaintPending() {
 746         return paintPending &amp;&amp; isLayouting;
 747     }
 748 
 749     public boolean handlesWheelScrolling() {
 750         return false;
 751     }
 752 
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2002, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
<span class="line-added">  25 </span>
  26 package sun.awt.X11;
  27 
  28 import java.awt.AWTEvent;
  29 import java.awt.AWTException;
  30 import java.awt.BufferCapabilities;
  31 import java.awt.Color;
  32 import java.awt.Component;
  33 import java.awt.Container;
  34 import java.awt.Cursor;
  35 import java.awt.Dimension;
  36 import java.awt.Font;
  37 import java.awt.FontMetrics;
  38 import java.awt.Graphics;
  39 import java.awt.GraphicsConfiguration;
  40 import java.awt.Image;
  41 import java.awt.Insets;
  42 import java.awt.Rectangle;
  43 import java.awt.SystemColor;
  44 import java.awt.Toolkit;
  45 import java.awt.Window;
  46 import java.awt.dnd.DropTarget;
  47 import java.awt.dnd.peer.DropTargetPeer;
  48 import java.awt.event.FocusEvent;
  49 import java.awt.event.InputEvent;
  50 import java.awt.event.InputMethodEvent;
  51 import java.awt.event.KeyEvent;
  52 import java.awt.event.MouseEvent;
  53 import java.awt.event.MouseWheelEvent;
  54 import java.awt.event.PaintEvent;
  55 import java.awt.event.WindowEvent;


  56 import java.awt.image.VolatileImage;
  57 import java.awt.peer.ComponentPeer;
  58 import java.awt.peer.ContainerPeer;
  59 import java.util.Collection;
  60 import java.util.Objects;
  61 import java.util.Set;
  62 
<span class="line-added">  63 import sun.awt.AWTAccessor;</span>
  64 import sun.awt.AWTAccessor.ComponentAccessor;
<span class="line-modified">  65 import sun.awt.SunToolkit;</span>
<span class="line-modified">  66 import sun.awt.X11GraphicsConfig;</span>
  67 import sun.awt.event.IgnorePaintEvent;
  68 import sun.awt.image.SunVolatileImage;

  69 import sun.java2d.BackBufferCapsProvider;
  70 import sun.java2d.pipe.Region;
<span class="line-added">  71 import sun.util.logging.PlatformLogger;</span>
  72 
  73 
  74 public class XComponentPeer extends XWindow implements ComponentPeer, DropTargetPeer,
  75     BackBufferCapsProvider
  76 {
  77     private static final PlatformLogger log = PlatformLogger.getLogger(&quot;sun.awt.X11.XComponentPeer&quot;);
  78     private static final PlatformLogger buffersLog = PlatformLogger.getLogger(&quot;sun.awt.X11.XComponentPeer.multibuffer&quot;);
  79     private static final PlatformLogger focusLog = PlatformLogger.getLogger(&quot;sun.awt.X11.focus.XComponentPeer&quot;);
  80     private static final PlatformLogger fontLog = PlatformLogger.getLogger(&quot;sun.awt.X11.font.XComponentPeer&quot;);
  81     private static final PlatformLogger enableLog = PlatformLogger.getLogger(&quot;sun.awt.X11.enable.XComponentPeer&quot;);
  82     private static final PlatformLogger shapeLog = PlatformLogger.getLogger(&quot;sun.awt.X11.shape.XComponentPeer&quot;);
  83 
  84     boolean paintPending = false;
  85     boolean isLayouting = false;
  86     private boolean enabled;
  87 
  88     // Actually used only by XDecoratedPeer
  89     protected int boundsOperation;
  90 
  91     Color foreground;
</pre>
<hr />
<pre>
 693      */
 694     //ignoreSubComponents not used here
 695     public void pSetCursor(Cursor cursor, boolean ignoreSubComponents) {
 696         XToolkit.awtLock();
 697         try {
 698             long xcursor = XGlobalCursorManager.getCursor(cursor);
 699 
 700             XSetWindowAttributes xwa = new XSetWindowAttributes();
 701             xwa.set_cursor(xcursor);
 702 
 703             long valuemask = XConstants.CWCursor;
 704 
 705             XlibWrapper.XChangeWindowAttributes(XToolkit.getDisplay(),getWindow(),valuemask,xwa.pData);
 706             XlibWrapper.XFlush(XToolkit.getDisplay());
 707             xwa.dispose();
 708         } finally {
 709             XToolkit.awtUnlock();
 710         }
 711     }
 712 




 713     public Image createImage(int width, int height) {
 714         return graphicsConfig.createAcceleratedImage(target, width, height);
 715     }
 716 
 717     public VolatileImage createVolatileImage(int width, int height) {
 718         return new SunVolatileImage(target, width, height);
 719     }
 720 








 721     public Insets getInsets() {
 722         return new Insets(0, 0, 0, 0);
 723     }
 724 
 725     public void beginValidate() {
 726     }
 727 
 728     public void endValidate() {
 729     }
 730 
 731     // Returns true if we are inside begin/endLayout and
 732     // are waiting for native painting
 733     public boolean isPaintPending() {
 734         return paintPending &amp;&amp; isLayouting;
 735     }
 736 
 737     public boolean handlesWheelScrolling() {
 738         return false;
 739     }
 740 
</pre>
</td>
</tr>
</table>
<center><a href="XBaseWindow.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="XConstants.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>