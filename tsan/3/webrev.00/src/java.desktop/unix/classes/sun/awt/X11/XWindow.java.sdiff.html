<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/unix/classes/sun/awt/X11/XWindow.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="XToolkit.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="XWindowPeer.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/unix/classes/sun/awt/X11/XWindow.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 432     }
 433 
 434     // overriden in XCanvasPeer
 435     protected boolean doEraseBackground() {
 436         return true;
 437     }
 438 
 439     // We need a version of setBackground that does not call repaint !!
 440     // and one that does not get overridden. The problem is that in postInit
 441     // we call setBackground and we don&#39;t have all the stuff initialized to
 442     // do a full paint for most peers. So we cannot call setBackground in postInit.
 443     public final void xSetBackground(Color c) {
 444         XToolkit.awtLock();
 445         try {
 446             winBackground(c);
 447             // fix for 6558510: handle sun.awt.noerasebackground flag,
 448             // see doEraseBackground() and preInit() methods in XCanvasPeer
 449             if (!doEraseBackground()) {
 450                 return;
 451             }
<span class="line-modified"> 452             // 6304250: XAWT: Items in choice show a blue border on OpenGL + Solaris10 when background color is set</span>
<span class="line-removed"> 453             // Note: When OGL is enabled, surfaceData.pixelFor() will not</span>
<span class="line-removed"> 454             // return a pixel value appropriate for passing to</span>
<span class="line-removed"> 455             // XSetWindowBackground().  Therefore, we will use the ColorModel</span>
<span class="line-removed"> 456             // for this component in order to calculate a pixel value from</span>
<span class="line-removed"> 457             // the given RGB value.</span>
<span class="line-removed"> 458             ColorModel cm = getColorModel();</span>
<span class="line-removed"> 459             int pixel = PixelConverter.instance.rgbToPixel(c.getRGB(), cm);</span>
 460             XlibWrapper.XSetWindowBackground(XToolkit.getDisplay(), getContentWindow(), pixel);
 461             XlibWrapper.XClearWindow(XToolkit.getDisplay(), getContentWindow());
 462         }
 463         finally {
 464             XToolkit.awtUnlock();
 465         }
 466     }
 467 
 468     public void setBackground(Color c) {
 469         xSetBackground(c);
 470     }
 471 
 472     Color backgroundColor;
 473     void winBackground(Color c) {
 474         backgroundColor = c;
 475     }
 476 
 477     public Color getWinBackground() {
 478         Color c = null;
 479 
</pre>
</td>
<td>
<hr />
<pre>
 432     }
 433 
 434     // overriden in XCanvasPeer
 435     protected boolean doEraseBackground() {
 436         return true;
 437     }
 438 
 439     // We need a version of setBackground that does not call repaint !!
 440     // and one that does not get overridden. The problem is that in postInit
 441     // we call setBackground and we don&#39;t have all the stuff initialized to
 442     // do a full paint for most peers. So we cannot call setBackground in postInit.
 443     public final void xSetBackground(Color c) {
 444         XToolkit.awtLock();
 445         try {
 446             winBackground(c);
 447             // fix for 6558510: handle sun.awt.noerasebackground flag,
 448             // see doEraseBackground() and preInit() methods in XCanvasPeer
 449             if (!doEraseBackground()) {
 450                 return;
 451             }
<span class="line-modified"> 452             int pixel = surfaceData.pixelFor(c.getRGB());</span>







 453             XlibWrapper.XSetWindowBackground(XToolkit.getDisplay(), getContentWindow(), pixel);
 454             XlibWrapper.XClearWindow(XToolkit.getDisplay(), getContentWindow());
 455         }
 456         finally {
 457             XToolkit.awtUnlock();
 458         }
 459     }
 460 
 461     public void setBackground(Color c) {
 462         xSetBackground(c);
 463     }
 464 
 465     Color backgroundColor;
 466     void winBackground(Color c) {
 467         backgroundColor = c;
 468     }
 469 
 470     public Color getWinBackground() {
 471         Color c = null;
 472 
</pre>
</td>
</tr>
</table>
<center><a href="XToolkit.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="XWindowPeer.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>