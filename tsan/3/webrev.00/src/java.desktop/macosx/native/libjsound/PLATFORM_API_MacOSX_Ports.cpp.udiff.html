<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.desktop/macosx/native/libjsound/PLATFORM_API_MacOSX_Ports.cpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../libawt_lwawt/java2d/opengl/CGLSurfaceData.m.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../libosxapp/NSApplicationAWT.m.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/macosx/native/libjsound/PLATFORM_API_MacOSX_Ports.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -412,15 +412,22 @@</span>
  // returns java control
  static void* CreatePortControl(PortMixer *mixer, PortControlCreator *creator, PortControl::ControlType type,
                                 AudioControl **audioControls, int offset, int len) {
      void *jControl = NULL;
      PortControl *control = (PortControl *)calloc(1, sizeof(PortControl));
<span class="udiff-line-added">+     if (control == NULL) {</span>
<span class="udiff-line-added">+         return NULL;</span>
<span class="udiff-line-added">+     }</span>
      float precision = 0.01;
  
      control-&gt;type = type;
      control-&gt;controlCount = len;
      control-&gt;audioControls = (AudioControl **)malloc(len * sizeof(AudioControl *));
<span class="udiff-line-added">+     if (control-&gt;audioControls == NULL) {</span>
<span class="udiff-line-added">+         free(control);</span>
<span class="udiff-line-added">+         return NULL;</span>
<span class="udiff-line-added">+     }</span>
      memcpy(control-&gt;audioControls, audioControls + offset, len * sizeof(AudioControl *));
  
      switch (control-&gt;type) {
      case PortControl::Volume:
          jControl = creator-&gt;newFloatControl(creator, control, CONTROL_TYPE_VOLUME, 0, 1, precision, &quot;&quot;);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -480,10 +487,13 @@</span>
  
              if (err) {
                  OS_ERROR1(err, &quot;PORT_GetControls (portIndex = %d) get OwnedObject values&quot;, portIndex);
              } else {
                  mixer-&gt;deviceControls = (AudioControl *)calloc(mixer-&gt;deviceControlCount, sizeof(AudioControl));
<span class="udiff-line-added">+                 if (mixer-&gt;deviceControls == NULL) {</span>
<span class="udiff-line-added">+                     return;</span>
<span class="udiff-line-added">+                 }</span>
  
                  for (int i = 0; i &lt; mixer-&gt;deviceControlCount; i++) {
                      AudioControl *control = &amp;mixer-&gt;deviceControls[i];
  
                      control-&gt;controlID = controlIDs[i];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -613,14 +623,20 @@</span>
                  UInt32 size = sizeof(cfname);
                  OSStatus err = AudioObjectGetPropertyData(mixer-&gt;deviceID, &amp;address, 0, NULL, &amp;size, &amp;cfname);
                  if (err == noErr) {
                      CFIndex length = CFStringGetLength(cfname) + 1;
                      channelName = (char *)malloc(length);
<span class="udiff-line-added">+                     if (channelName == NULL) {</span>
<span class="udiff-line-added">+                         return;</span>
<span class="udiff-line-added">+                     }</span>
                      CFStringGetCString(cfname, channelName, length, kCFStringEncodingUTF8);
                      CFRelease(cfname);
                  } else {
                      channelName = (char *)malloc(16);
<span class="udiff-line-added">+                     if (channelName == NULL) {</span>
<span class="udiff-line-added">+                         return;</span>
<span class="udiff-line-added">+                     }</span>
                      sprintf(channelName, &quot;Ch %d&quot;, ch);
                  }
  
                  void* jControls[2];
                  int controlCount = 0;
</pre>
<center><a href="../libawt_lwawt/java2d/opengl/CGLSurfaceData.m.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../libosxapp/NSApplicationAWT.m.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>