<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/java.desktop/macosx/classes/apple/laf/JRSUIUtils.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2011, 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package apple.laf;
 27 
 28 import java.security.AccessController;
 29 
 30 import apple.laf.JRSUIConstants.Hit;
 31 import apple.laf.JRSUIConstants.ScrollBarPart;
 32 import com.apple.laf.AquaImageFactory.NineSliceMetrics;
 33 import sun.security.action.GetPropertyAction;
 34 
 35 public final class JRSUIUtils {
 36 
 37     static boolean isLeopard = isMacOSXLeopard();
 38     static boolean isSnowLeopardOrBelow = isMacOSXSnowLeopardOrBelow();
 39     static boolean isCatalinaOrAbove = isMacOSXCatalinaOrAbove();
 40 
 41     static boolean isMacOSXCatalinaOrAbove() {
 42         return currentMacOSXVersionMatchesGivenVersionRange(15, true, false, true);
 43     }
 44 
 45     static boolean isMacOSXLeopard() {
 46         return isCurrentMacOSXVersion(5);
 47     }
 48 
 49     static boolean isMacOSXSnowLeopardOrBelow() {
 50         return currentMacOSXVersionMatchesGivenVersionRange(6, true, true, false);
 51     }
 52 
 53     static boolean isCurrentMacOSXVersion(final int version) {
 54         return currentMacOSXVersionMatchesGivenVersionRange(version, true, false, false);
 55     }
 56 
 57     static boolean currentMacOSXVersionMatchesGivenVersionRange(
 58             final int version, final boolean inclusive,
 59             final boolean matchBelow, final boolean matchAbove) {
 60         // split the &quot;10.x.y&quot; version number
 61         String osVersion = AccessController.doPrivileged(new GetPropertyAction(&quot;os.version&quot;));
 62         String[] fragments = osVersion.split(&quot;\\.&quot;);
 63 
 64         // sanity check the &quot;10.&quot; part of the version
 65         if (!fragments[0].equals(&quot;10&quot;)) return false;
 66         if (fragments.length &lt; 2) return false;
 67 
 68         // check if os.version matches the given version using the given match method
 69         try {
 70             int minorVers = Integer.parseInt(fragments[1]);
 71 
 72             if (inclusive &amp;&amp; minorVers == version) return true;
 73             if (matchBelow &amp;&amp; minorVers &lt; version) return true;
 74             if (matchAbove &amp;&amp; minorVers &gt; version) return true;
 75 
 76         } catch (NumberFormatException e) {
 77             // was not an integer
 78         }
 79         return false;
 80     }
 81 
 82     public static class TaskBar {
 83         public static boolean isIconBadgeSupported() {
 84             return !isCatalinaOrAbove;
 85         }
 86     }
 87 
 88     public static class TabbedPane {
 89         public static boolean useLegacyTabs() {
 90             return isLeopard;
 91         }
 92         public static boolean shouldUseTabbedPaneContrastUI() {
 93             return !isSnowLeopardOrBelow;
 94         }
 95     }
 96 
 97     public static class InternalFrame {
 98         public static boolean shouldUseLegacyBorderMetrics() {
 99             return isSnowLeopardOrBelow;
100         }
101     }
102 
103     public static class Tree {
104         public static boolean useLegacyTreeKnobs() {
105             return isLeopard;
106         }
107     }
108 
109     public static class ScrollBar {
110         private static native boolean shouldUseScrollToClick();
111 
112         public static boolean useScrollToClick() {
113             return shouldUseScrollToClick();
114         }
115 
116         public static void getPartBounds(final double[] rect,
117                                          final JRSUIControl control,
118                                          final int x, final int y, final int w,
119                                          final int h,
120                                          final ScrollBarPart part) {
121             control.getPartBounds(rect, x, y, w, h, part.ordinal);
122         }
123 
124         public static double getNativeOffsetChange(final JRSUIControl control,
125                                                    final int x, final int y,
126                                                    final int w, final int h,
127                                                    final int offset,
128                                                    final int visibleAmount,
129                                                    final int extent) {
130             return control.getScrollBarOffsetChange(x, y, w, h, offset,
131                                                     visibleAmount, extent);
132         }
133     }
134 
135     public static class Images {
136         public static boolean shouldUseLegacySecurityUIPath() {
137             return isSnowLeopardOrBelow;
138         }
139     }
140 
141     public static class HitDetection {
142         public static Hit getHitForPoint(final JRSUIControl control,
143                                          final int x, final int y, final int w,
144                                          final int h, final int hitX,
145                                          final int hitY) {
146             return control.getHitForPoint(x, y, w, h, hitX, hitY);
147         }
148     }
149 
150     public interface NineSliceMetricsProvider {
151         public NineSliceMetrics getNineSliceMetricsForState(JRSUIState state);
152     }
153 }
    </pre>
  </body>
</html>