<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/macosx/classes/sun/lwawt/macosx/CPlatformResponder.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="CPlatformLWWindow.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="CPlatformView.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/macosx/classes/sun/lwawt/macosx/CPlatformResponder.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
167             int[] in = new int[] {testCharIgnoringModifiers, isDeadChar ? 1 : 0, modifierFlags, keyCode};
168             int[] out = new int[3]; // [jkeyCode, jkeyLocation, deadChar]
169 
170             postsTyped = NSEvent.nsToJavaKeyInfo(in, out);
171             if (!postsTyped) {
172                 testChar = KeyEvent.CHAR_UNDEFINED;
173             }
174 
175             if(isDeadChar){
176                 testChar = (char) out[2];
177                 if(testChar == 0){
178                     return;
179                 }
180             }
181 
182             // If Pinyin Simplified input method is selected, CAPS_LOCK key is supposed to switch
183             // input to latin letters.
184             // It is necessary to use testCharIgnoringModifiers instead of testChar for event
185             // generation in such case to avoid uppercase letters in text components.
186             LWCToolkit lwcToolkit = (LWCToolkit)Toolkit.getDefaultToolkit();
<span class="line-modified">187             if (lwcToolkit.getLockingKeyState(KeyEvent.VK_CAPS_LOCK) &amp;&amp;</span>
<span class="line-modified">188                     Locale.SIMPLIFIED_CHINESE.equals(lwcToolkit.getDefaultKeyboardLocale())) {</span>



189                 testChar = testCharIgnoringModifiers;
190             }
191 
192             jkeyCode = out[0];
193             jkeyLocation = out[1];
194             jeventType = isNpapiCallback ? NSEvent.npToJavaEventType(eventType) :
195                                            NSEvent.nsToJavaEventType(eventType);
196         }
197 
198         char javaChar = NSEvent.nsToJavaChar(testChar, modifierFlags, spaceKeyTyped);
199         // Some keys may generate a KEY_TYPED, but we can&#39;t determine
200         // what that character is. That&#39;s likely a bug, but for now we
201         // just check for CHAR_UNDEFINED.
202         if (javaChar == KeyEvent.CHAR_UNDEFINED) {
203             postsTyped = false;
204         }
205 
206         int jmodifiers = NSEvent.nsToJavaModifiers(modifierFlags);
207         long when = System.currentTimeMillis();
208 
</pre>
</td>
<td>
<hr />
<pre>
167             int[] in = new int[] {testCharIgnoringModifiers, isDeadChar ? 1 : 0, modifierFlags, keyCode};
168             int[] out = new int[3]; // [jkeyCode, jkeyLocation, deadChar]
169 
170             postsTyped = NSEvent.nsToJavaKeyInfo(in, out);
171             if (!postsTyped) {
172                 testChar = KeyEvent.CHAR_UNDEFINED;
173             }
174 
175             if(isDeadChar){
176                 testChar = (char) out[2];
177                 if(testChar == 0){
178                     return;
179                 }
180             }
181 
182             // If Pinyin Simplified input method is selected, CAPS_LOCK key is supposed to switch
183             // input to latin letters.
184             // It is necessary to use testCharIgnoringModifiers instead of testChar for event
185             // generation in such case to avoid uppercase letters in text components.
186             LWCToolkit lwcToolkit = (LWCToolkit)Toolkit.getDefaultToolkit();
<span class="line-modified">187             if ((lwcToolkit.getLockingKeyState(KeyEvent.VK_CAPS_LOCK) &amp;&amp;</span>
<span class="line-modified">188                     Locale.SIMPLIFIED_CHINESE.equals(lwcToolkit.getDefaultKeyboardLocale())) ||</span>
<span class="line-added">189                 (LWCToolkit.isLocaleUSInternationalPC(lwcToolkit.getDefaultKeyboardLocale()) &amp;&amp;</span>
<span class="line-added">190                     LWCToolkit.isCharModifierKeyInUSInternationalPC(testChar) &amp;&amp;</span>
<span class="line-added">191                     (testChar != testCharIgnoringModifiers))) {</span>
192                 testChar = testCharIgnoringModifiers;
193             }
194 
195             jkeyCode = out[0];
196             jkeyLocation = out[1];
197             jeventType = isNpapiCallback ? NSEvent.npToJavaEventType(eventType) :
198                                            NSEvent.nsToJavaEventType(eventType);
199         }
200 
201         char javaChar = NSEvent.nsToJavaChar(testChar, modifierFlags, spaceKeyTyped);
202         // Some keys may generate a KEY_TYPED, but we can&#39;t determine
203         // what that character is. That&#39;s likely a bug, but for now we
204         // just check for CHAR_UNDEFINED.
205         if (javaChar == KeyEvent.CHAR_UNDEFINED) {
206             postsTyped = false;
207         }
208 
209         int jmodifiers = NSEvent.nsToJavaModifiers(modifierFlags);
210         long when = System.currentTimeMillis();
211 
</pre>
</td>
</tr>
</table>
<center><a href="CPlatformLWWindow.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="CPlatformView.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>