<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.desktop/macosx/classes/com/apple/laf/AquaKeyBindings.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 2011, 2014, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package com.apple.laf;
 27 
 28 import java.awt.event.ActionEvent;
 29 import java.util.*;
 30 
 31 import javax.swing.*;
 32 import javax.swing.UIDefaults.LazyValue;
 33 import javax.swing.text.*;
 34 import javax.swing.text.DefaultEditorKit.DefaultKeyTypedAction;
 35 
 36 import com.apple.laf.AquaUtils.RecyclableSingleton;
 37 import com.apple.laf.AquaUtils.RecyclableSingletonFromDefaultConstructor;
 38 
 39 public class AquaKeyBindings {
 40     private static final RecyclableSingleton&lt;AquaKeyBindings&gt; instance = new RecyclableSingletonFromDefaultConstructor&lt;AquaKeyBindings&gt;(AquaKeyBindings.class);
 41     static AquaKeyBindings instance() {
 42         return instance.get();
 43     }
 44 
 45     final DefaultKeyTypedAction defaultKeyTypedAction = new DefaultKeyTypedAction();
 46     void setDefaultAction(final String keymapName) {
 47         final javax.swing.text.Keymap map = JTextComponent.getKeymap(keymapName);
 48         map.setDefaultAction(defaultKeyTypedAction);
 49     }
 50 
 51     static final String upMultilineAction = &quot;aqua-move-up&quot;;
 52     static final String downMultilineAction = &quot;aqua-move-down&quot;;
 53     static final String pageUpMultiline = &quot;aqua-page-up&quot;;
 54     static final String pageDownMultiline = &quot;aqua-page-down&quot;;
 55 
 56     final String[] commonTextEditorBindings = {
 57         &quot;ENTER&quot;, JTextField.notifyAction,
 58         &quot;COPY&quot;, DefaultEditorKit.copyAction,
 59         &quot;CUT&quot;, DefaultEditorKit.cutAction,
 60         &quot;PASTE&quot;, DefaultEditorKit.pasteAction,
 61         &quot;meta A&quot;, DefaultEditorKit.selectAllAction,
 62         &quot;meta C&quot;, DefaultEditorKit.copyAction,
 63         &quot;meta V&quot;, DefaultEditorKit.pasteAction,
 64         &quot;meta X&quot;, DefaultEditorKit.cutAction,
 65         &quot;meta BACK_SLASH&quot;, &quot;unselect&quot;,
 66 
 67         &quot;DELETE&quot;, DefaultEditorKit.deleteNextCharAction,
 68         &quot;alt DELETE&quot;, &quot;delete-next-word&quot;,
 69         &quot;BACK_SPACE&quot;, DefaultEditorKit.deletePrevCharAction,
<a name="2" id="anc2"></a>
 70         &quot;alt BACK_SPACE&quot;, &quot;delete-previous-word&quot;,
 71 
 72         &quot;LEFT&quot;, DefaultEditorKit.backwardAction,
 73         &quot;KP_LEFT&quot;, DefaultEditorKit.backwardAction,
 74         &quot;RIGHT&quot;, DefaultEditorKit.forwardAction,
 75         &quot;KP_RIGHT&quot;, DefaultEditorKit.forwardAction,
 76         &quot;shift LEFT&quot;, DefaultEditorKit.selectionBackwardAction,
 77         &quot;shift KP_LEFT&quot;, DefaultEditorKit.selectionBackwardAction,
 78         &quot;shift RIGHT&quot;, DefaultEditorKit.selectionForwardAction,
 79         &quot;shift KP_RIGHT&quot;, DefaultEditorKit.selectionForwardAction,
 80         &quot;meta LEFT&quot;, DefaultEditorKit.beginLineAction,
 81         &quot;meta KP_LEFT&quot;, DefaultEditorKit.beginLineAction,
 82         &quot;meta RIGHT&quot;, DefaultEditorKit.endLineAction,
 83         &quot;meta KP_RIGHT&quot;, DefaultEditorKit.endLineAction,
 84         &quot;shift meta LEFT&quot;, DefaultEditorKit.selectionBeginLineAction,
 85         &quot;shift meta KP_LEFT&quot;, DefaultEditorKit.selectionBeginLineAction,
 86         &quot;shift meta RIGHT&quot;, DefaultEditorKit.selectionEndLineAction,
 87         &quot;shift meta KP_RIGHT&quot;, DefaultEditorKit.selectionEndLineAction,
 88         &quot;alt LEFT&quot;, DefaultEditorKit.previousWordAction,
 89         &quot;alt KP_LEFT&quot;, DefaultEditorKit.previousWordAction,
 90         &quot;alt RIGHT&quot;, DefaultEditorKit.nextWordAction,
 91         &quot;alt KP_RIGHT&quot;, DefaultEditorKit.nextWordAction,
 92         &quot;shift alt LEFT&quot;, DefaultEditorKit.selectionPreviousWordAction,
 93         &quot;shift alt KP_LEFT&quot;, DefaultEditorKit.selectionPreviousWordAction,
 94         &quot;shift alt RIGHT&quot;, DefaultEditorKit.selectionNextWordAction,
 95         &quot;shift alt KP_RIGHT&quot;, DefaultEditorKit.selectionNextWordAction,
 96 
 97         &quot;control A&quot;, DefaultEditorKit.beginLineAction,
 98         &quot;control B&quot;, DefaultEditorKit.backwardAction,
 99         &quot;control D&quot;, DefaultEditorKit.deleteNextCharAction,
100         &quot;control E&quot;, DefaultEditorKit.endLineAction,
101         &quot;control F&quot;, DefaultEditorKit.forwardAction,
102         &quot;control H&quot;, DefaultEditorKit.deletePrevCharAction,
103         &quot;control W&quot;, &quot;delete-previous-word&quot;,
104         &quot;control shift O&quot;, &quot;toggle-componentOrientation&quot;,
105 
106         &quot;END&quot;, DefaultEditorKit.endAction,
107         &quot;HOME&quot;, DefaultEditorKit.beginAction,
108         &quot;shift END&quot;, DefaultEditorKit.selectionEndAction,
109         &quot;shift HOME&quot;, DefaultEditorKit.selectionBeginAction,
110 
111         &quot;PAGE_DOWN&quot;, pageDownMultiline,
112         &quot;PAGE_UP&quot;, pageUpMultiline,
113         &quot;shift PAGE_DOWN&quot;, &quot;selection-page-down&quot;,
114         &quot;shift PAGE_UP&quot;, &quot;selection-page-up&quot;,
115         &quot;meta shift PAGE_DOWN&quot;, &quot;selection-page-right&quot;,
116         &quot;meta shift PAGE_UP&quot;, &quot;selection-page-left&quot;,
117 
118         &quot;meta DOWN&quot;, DefaultEditorKit.endAction,
119         &quot;meta KP_DOWN&quot;, DefaultEditorKit.endAction,
120         &quot;meta UP&quot;, DefaultEditorKit.beginAction,
121         &quot;meta KP_UP&quot;, DefaultEditorKit.beginAction,
122         &quot;shift meta DOWN&quot;, DefaultEditorKit.selectionEndAction,
123         &quot;shift meta KP_DOWN&quot;, DefaultEditorKit.selectionEndAction,
124         &quot;shift meta UP&quot;, DefaultEditorKit.selectionBeginAction,
125         &quot;shift meta KP_UP&quot;, DefaultEditorKit.selectionBeginAction,
126     };
127 
128     LateBoundInputMap getTextFieldInputMap() {
129         return new LateBoundInputMap(new SimpleBinding(commonTextEditorBindings), new SimpleBinding(new String[] {
130             &quot;DOWN&quot;, DefaultEditorKit.endLineAction,
131             &quot;KP_DOWN&quot;, DefaultEditorKit.endLineAction,
132             &quot;UP&quot;, DefaultEditorKit.beginLineAction,
133             &quot;KP_UP&quot;, DefaultEditorKit.beginLineAction,
134             &quot;shift DOWN&quot;, DefaultEditorKit.selectionEndLineAction,
135             &quot;shift KP_DOWN&quot;, DefaultEditorKit.selectionEndLineAction,
136             &quot;shift UP&quot;, DefaultEditorKit.selectionBeginLineAction,
137             &quot;shift KP_UP&quot;, DefaultEditorKit.selectionBeginLineAction,
138 
139             &quot;control P&quot;, DefaultEditorKit.beginAction,
140             &quot;control N&quot;, DefaultEditorKit.endAction,
141             &quot;control V&quot;, DefaultEditorKit.endAction,
142         }));
143     }
144 
145     LateBoundInputMap getPasswordFieldInputMap() {
146         return new LateBoundInputMap(new SimpleBinding(getTextFieldInputMap().getBindings()),
147                 // nullify all the bindings that may discover space characters in the text
148                 new SimpleBinding(new String[] {
149                         &quot;alt LEFT&quot;, null,
150                         &quot;alt KP_LEFT&quot;, null,
151                         &quot;alt RIGHT&quot;, null,
152                         &quot;alt KP_RIGHT&quot;, null,
153                         &quot;shift alt LEFT&quot;, null,
154                         &quot;shift alt KP_LEFT&quot;, null,
155                         &quot;shift alt RIGHT&quot;, null,
156                         &quot;shift alt KP_RIGHT&quot;, null,
157                 }));
158     }
159 
160     LateBoundInputMap getMultiLineTextInputMap() {
161         return new LateBoundInputMap(new SimpleBinding(commonTextEditorBindings), new SimpleBinding(new String[] {
162             &quot;ENTER&quot;, DefaultEditorKit.insertBreakAction,
163             &quot;DOWN&quot;, downMultilineAction,
164             &quot;KP_DOWN&quot;, downMultilineAction,
165             &quot;UP&quot;, upMultilineAction,
166             &quot;KP_UP&quot;, upMultilineAction,
167             &quot;shift DOWN&quot;, DefaultEditorKit.selectionDownAction,
168             &quot;shift KP_DOWN&quot;, DefaultEditorKit.selectionDownAction,
169             &quot;shift UP&quot;, DefaultEditorKit.selectionUpAction,
170             &quot;shift KP_UP&quot;, DefaultEditorKit.selectionUpAction,
171             &quot;alt shift DOWN&quot;, DefaultEditorKit.selectionEndParagraphAction,
172             &quot;alt shift KP_DOWN&quot;, DefaultEditorKit.selectionEndParagraphAction,
173             &quot;alt shift UP&quot;, DefaultEditorKit.selectionBeginParagraphAction,
174             &quot;alt shift KP_UP&quot;, DefaultEditorKit.selectionBeginParagraphAction,
175 
176             &quot;control P&quot;, DefaultEditorKit.upAction,
177             &quot;control N&quot;, DefaultEditorKit.downAction,
178             &quot;control V&quot;, pageDownMultiline,
179 
180             &quot;TAB&quot;, DefaultEditorKit.insertTabAction,
181             &quot;meta SPACE&quot;, &quot;activate-link-action&quot;,
182             &quot;meta T&quot;, &quot;next-link-action&quot;,
183             &quot;meta shift T&quot;, &quot;previous-link-action&quot;,
184 
185             &quot;END&quot;, DefaultEditorKit.endAction,
186             &quot;HOME&quot;, DefaultEditorKit.beginAction,
187             &quot;shift END&quot;, DefaultEditorKit.selectionEndAction,
188             &quot;shift HOME&quot;, DefaultEditorKit.selectionBeginAction,
189 
190             &quot;PAGE_DOWN&quot;, pageDownMultiline,
191             &quot;PAGE_UP&quot;, pageUpMultiline,
192             &quot;shift PAGE_DOWN&quot;, &quot;selection-page-down&quot;,
193             &quot;shift PAGE_UP&quot;, &quot;selection-page-up&quot;,
194             &quot;meta shift PAGE_DOWN&quot;, &quot;selection-page-right&quot;,
195             &quot;meta shift PAGE_UP&quot;, &quot;selection-page-left&quot;,
196         }));
197     }
198 
199     LateBoundInputMap getFormattedTextFieldInputMap() {
200         return new LateBoundInputMap(getTextFieldInputMap(), new SimpleBinding(new String[] {
201             &quot;UP&quot;, &quot;increment&quot;,
202             &quot;KP_UP&quot;, &quot;increment&quot;,
203             &quot;DOWN&quot;, &quot;decrement&quot;,
204             &quot;KP_DOWN&quot;, &quot;decrement&quot;,
205 
206             &quot;ESCAPE&quot;, &quot;reset-field-edit&quot;,
207         }));
208     }
209 
210     LateBoundInputMap getComboBoxInputMap() {
211         return new LateBoundInputMap(new SimpleBinding(new String[] {
212             &quot;ESCAPE&quot;, &quot;aquaHidePopup&quot;,
213             &quot;PAGE_UP&quot;, &quot;aquaSelectPageUp&quot;,
214             &quot;PAGE_DOWN&quot;, &quot;aquaSelectPageDown&quot;,
215             &quot;HOME&quot;, &quot;aquaSelectHome&quot;,
216             &quot;END&quot;, &quot;aquaSelectEnd&quot;,
217             &quot;ENTER&quot;, &quot;enterPressed&quot;,
218             &quot;UP&quot;, &quot;aquaSelectPrevious&quot;,
219             &quot;KP_UP&quot;, &quot;aquaSelectPrevious&quot;,
220             &quot;DOWN&quot;, &quot;aquaSelectNext&quot;,
221             &quot;KP_DOWN&quot;, &quot;aquaSelectNext&quot;,
222             &quot;SPACE&quot;, &quot;aquaSpacePressed&quot; // &quot;spacePopup&quot;
223         }));
224     }
225 
226     LateBoundInputMap getListInputMap() {
227         return new LateBoundInputMap(new SimpleBinding(new String[] {
228             &quot;meta C&quot;, &quot;copy&quot;,
229             &quot;meta V&quot;, &quot;paste&quot;,
230             &quot;meta X&quot;, &quot;cut&quot;,
231             &quot;COPY&quot;, &quot;copy&quot;,
232             &quot;PASTE&quot;, &quot;paste&quot;,
233             &quot;CUT&quot;, &quot;cut&quot;,
234             &quot;UP&quot;, &quot;selectPreviousRow&quot;,
235             &quot;KP_UP&quot;, &quot;selectPreviousRow&quot;,
236             &quot;shift UP&quot;, &quot;selectPreviousRowExtendSelection&quot;,
237             &quot;shift KP_UP&quot;, &quot;selectPreviousRowExtendSelection&quot;,
238             &quot;DOWN&quot;, &quot;selectNextRow&quot;,
239             &quot;KP_DOWN&quot;, &quot;selectNextRow&quot;,
240             &quot;shift DOWN&quot;, &quot;selectNextRowExtendSelection&quot;,
241             &quot;shift KP_DOWN&quot;, &quot;selectNextRowExtendSelection&quot;,
242             &quot;LEFT&quot;, &quot;selectPreviousColumn&quot;,
243             &quot;KP_LEFT&quot;, &quot;selectPreviousColumn&quot;,
244             &quot;shift LEFT&quot;, &quot;selectPreviousColumnExtendSelection&quot;,
245             &quot;shift KP_LEFT&quot;, &quot;selectPreviousColumnExtendSelection&quot;,
246             &quot;RIGHT&quot;, &quot;selectNextColumn&quot;,
247             &quot;KP_RIGHT&quot;, &quot;selectNextColumn&quot;,
248             &quot;shift RIGHT&quot;, &quot;selectNextColumnExtendSelection&quot;,
249             &quot;shift KP_RIGHT&quot;, &quot;selectNextColumnExtendSelection&quot;,
250             &quot;meta A&quot;, &quot;selectAll&quot;,
251 
252             // aquaHome and aquaEnd are new actions that just move the view so the first or last item is visible.
253             &quot;HOME&quot;, &quot;aquaHome&quot;,
254             &quot;shift HOME&quot;, &quot;selectFirstRowExtendSelection&quot;,
255             &quot;END&quot;, &quot;aquaEnd&quot;,
256             &quot;shift END&quot;, &quot;selectLastRowExtendSelection&quot;,
257 
258             // Unmodified PAGE_UP and PAGE_DOWN are handled by their scroll pane, if any.
259             &quot;shift PAGE_UP&quot;, &quot;scrollUpExtendSelection&quot;,
260             &quot;shift PAGE_DOWN&quot;, &quot;scrollDownExtendSelection&quot;
261         }));
262     }
263 
264     LateBoundInputMap getScrollBarInputMap() {
265         return new LateBoundInputMap(new SimpleBinding(new String[] {
266             &quot;RIGHT&quot;, &quot;positiveUnitIncrement&quot;,
267             &quot;KP_RIGHT&quot;, &quot;positiveUnitIncrement&quot;,
268             &quot;DOWN&quot;, &quot;positiveUnitIncrement&quot;,
269             &quot;KP_DOWN&quot;, &quot;positiveUnitIncrement&quot;,
270             &quot;PAGE_DOWN&quot;, &quot;positiveBlockIncrement&quot;,
271             &quot;LEFT&quot;, &quot;negativeUnitIncrement&quot;,
272             &quot;KP_LEFT&quot;, &quot;negativeUnitIncrement&quot;,
273             &quot;UP&quot;, &quot;negativeUnitIncrement&quot;,
274             &quot;KP_UP&quot;, &quot;negativeUnitIncrement&quot;,
275             &quot;PAGE_UP&quot;, &quot;negativeBlockIncrement&quot;,
276             &quot;HOME&quot;, &quot;minScroll&quot;,
277             &quot;END&quot;, &quot;maxScroll&quot;
278         }));
279     }
280 
281     LateBoundInputMap getScrollBarRightToLeftInputMap() {
282         return new LateBoundInputMap(new SimpleBinding(new String[] {
283             &quot;RIGHT&quot;, &quot;negativeUnitIncrement&quot;,
284             &quot;KP_RIGHT&quot;, &quot;negativeUnitIncrement&quot;,
285             &quot;LEFT&quot;, &quot;positiveUnitIncrement&quot;,
286             &quot;KP_LEFT&quot;, &quot;positiveUnitIncrement&quot;
287         }));
288     }
289 
290     LateBoundInputMap getScrollPaneInputMap() {
291         return new LateBoundInputMap(new SimpleBinding(new String[] {
292             &quot;RIGHT&quot;, &quot;unitScrollRight&quot;,
293             &quot;KP_RIGHT&quot;, &quot;unitScrollRight&quot;,
294             &quot;DOWN&quot;, &quot;unitScrollDown&quot;,
295             &quot;KP_DOWN&quot;, &quot;unitScrollDown&quot;,
296             &quot;LEFT&quot;, &quot;unitScrollLeft&quot;,
297             &quot;KP_LEFT&quot;, &quot;unitScrollLeft&quot;,
298             &quot;UP&quot;, &quot;unitScrollUp&quot;,
299             &quot;KP_UP&quot;, &quot;unitScrollUp&quot;,
300             &quot;PAGE_UP&quot;, &quot;scrollUp&quot;,
301             &quot;PAGE_DOWN&quot;, &quot;scrollDown&quot;,
302             &quot;HOME&quot;, &quot;scrollHome&quot;,
303             &quot;END&quot;, &quot;scrollEnd&quot;
304         }));
305     }
306 
307     LateBoundInputMap getSliderInputMap() {
308         return new LateBoundInputMap(new SimpleBinding(new String[] {
309             &quot;RIGHT&quot;, &quot;positiveUnitIncrement&quot;,
310             &quot;KP_RIGHT&quot;, &quot;positiveUnitIncrement&quot;,
311             &quot;DOWN&quot;, &quot;negativeUnitIncrement&quot;,
312             &quot;KP_DOWN&quot;, &quot;negativeUnitIncrement&quot;,
313             &quot;PAGE_DOWN&quot;, &quot;negativeBlockIncrement&quot;,
314             &quot;LEFT&quot;, &quot;negativeUnitIncrement&quot;,
315             &quot;KP_LEFT&quot;, &quot;negativeUnitIncrement&quot;,
316             &quot;UP&quot;, &quot;positiveUnitIncrement&quot;,
317             &quot;KP_UP&quot;, &quot;positiveUnitIncrement&quot;,
318             &quot;PAGE_UP&quot;, &quot;positiveBlockIncrement&quot;,
319             &quot;HOME&quot;, &quot;minScroll&quot;,
320             &quot;END&quot;, &quot;maxScroll&quot;
321         }));
322     }
323 
324     LateBoundInputMap getSliderRightToLeftInputMap() {
325         return new LateBoundInputMap(new SimpleBinding(new String[] {
326             &quot;RIGHT&quot;, &quot;negativeUnitIncrement&quot;,
327             &quot;KP_RIGHT&quot;, &quot;negativeUnitIncrement&quot;,
328             &quot;LEFT&quot;, &quot;positiveUnitIncrement&quot;,
329             &quot;KP_LEFT&quot;, &quot;positiveUnitIncrement&quot;
330         }));
331     }
332 
333     LateBoundInputMap getSpinnerInputMap() {
334         return new LateBoundInputMap(new SimpleBinding(new String[] {
335             &quot;UP&quot;, &quot;increment&quot;,
336             &quot;KP_UP&quot;, &quot;increment&quot;,
337             &quot;DOWN&quot;, &quot;decrement&quot;,
338             &quot;KP_DOWN&quot;, &quot;decrement&quot;
339         }));
340     }
341 
342     LateBoundInputMap getTableInputMap() {
343         return new LateBoundInputMap(new SimpleBinding(new String[] {
344             &quot;meta C&quot;, &quot;copy&quot;,
345             &quot;meta V&quot;, &quot;paste&quot;,
346             &quot;meta X&quot;, &quot;cut&quot;,
347             &quot;COPY&quot;, &quot;copy&quot;,
348             &quot;PASTE&quot;, &quot;paste&quot;,
349             &quot;CUT&quot;, &quot;cut&quot;,
350             &quot;RIGHT&quot;, &quot;selectNextColumn&quot;,
351             &quot;KP_RIGHT&quot;, &quot;selectNextColumn&quot;,
352             &quot;LEFT&quot;, &quot;selectPreviousColumn&quot;,
353             &quot;KP_LEFT&quot;, &quot;selectPreviousColumn&quot;,
354             &quot;DOWN&quot;, &quot;selectNextRow&quot;,
355             &quot;KP_DOWN&quot;, &quot;selectNextRow&quot;,
356             &quot;UP&quot;, &quot;selectPreviousRow&quot;,
357             &quot;KP_UP&quot;, &quot;selectPreviousRow&quot;,
358             &quot;shift RIGHT&quot;, &quot;selectNextColumnExtendSelection&quot;,
359             &quot;shift KP_RIGHT&quot;, &quot;selectNextColumnExtendSelection&quot;,
360             &quot;shift LEFT&quot;, &quot;selectPreviousColumnExtendSelection&quot;,
361             &quot;shift KP_LEFT&quot;, &quot;selectPreviousColumnExtendSelection&quot;,
362             &quot;shift DOWN&quot;, &quot;selectNextRowExtendSelection&quot;,
363             &quot;shift KP_DOWN&quot;, &quot;selectNextRowExtendSelection&quot;,
364             &quot;shift UP&quot;, &quot;selectPreviousRowExtendSelection&quot;,
365             &quot;shift KP_UP&quot;, &quot;selectPreviousRowExtendSelection&quot;,
366             &quot;PAGE_UP&quot;, &quot;scrollUpChangeSelection&quot;,
367             &quot;PAGE_DOWN&quot;, &quot;scrollDownChangeSelection&quot;,
368             &quot;HOME&quot;, &quot;selectFirstColumn&quot;,
369             &quot;END&quot;, &quot;selectLastColumn&quot;,
370             &quot;shift PAGE_UP&quot;, &quot;scrollUpExtendSelection&quot;,
371             &quot;shift PAGE_DOWN&quot;, &quot;scrollDownExtendSelection&quot;,
372             &quot;shift HOME&quot;, &quot;selectFirstColumnExtendSelection&quot;,
373             &quot;shift END&quot;, &quot;selectLastColumnExtendSelection&quot;,
374             &quot;TAB&quot;, &quot;selectNextColumnCell&quot;,
375             &quot;shift TAB&quot;, &quot;selectPreviousColumnCell&quot;,
376             &quot;meta A&quot;, &quot;selectAll&quot;,
377             &quot;ESCAPE&quot;, &quot;cancel&quot;,
378             &quot;ENTER&quot;, &quot;selectNextRowCell&quot;,
379             &quot;shift ENTER&quot;, &quot;selectPreviousRowCell&quot;,
380             &quot;alt TAB&quot;, &quot;focusHeader&quot;,
381             &quot;alt shift TAB&quot;, &quot;focusHeader&quot;
382         }));
383     }
384 
385     LateBoundInputMap getTableRightToLeftInputMap() {
386         return new LateBoundInputMap(new SimpleBinding(new String[] {
387             &quot;RIGHT&quot;, &quot;selectPreviousColumn&quot;,
388             &quot;KP_RIGHT&quot;, &quot;selectPreviousColumn&quot;,
389             &quot;LEFT&quot;, &quot;selectNextColumn&quot;,
390             &quot;KP_LEFT&quot;, &quot;selectNextColumn&quot;,
391             &quot;shift RIGHT&quot;, &quot;selectPreviousColumnExtendSelection&quot;,
392             &quot;shift KP_RIGHT&quot;, &quot;selectPreviousColumnExtendSelection&quot;,
393             &quot;shift LEFT&quot;, &quot;selectNextColumnExtendSelection&quot;,
394             &quot;shift KP_LEFT&quot;, &quot;selectNextColumnExtendSelection&quot;,
395             &quot;ctrl PAGE_UP&quot;, &quot;scrollRightChangeSelection&quot;,
396             &quot;ctrl PAGE_DOWN&quot;, &quot;scrollLeftChangeSelection&quot;,
397             &quot;ctrl shift PAGE_UP&quot;, &quot;scrollRightExtendSelection&quot;,
398             &quot;ctrl shift PAGE_DOWN&quot;, &quot;scrollLeftExtendSelection&quot;
399         }));
400     }
401 
402     LateBoundInputMap getTreeInputMap() {
403         return new LateBoundInputMap(new SimpleBinding(new String[] {
404             &quot;meta C&quot;, &quot;copy&quot;,
405             &quot;meta V&quot;, &quot;paste&quot;,
406             &quot;meta X&quot;, &quot;cut&quot;,
407             &quot;COPY&quot;, &quot;copy&quot;,
408             &quot;PASTE&quot;, &quot;paste&quot;,
409             &quot;CUT&quot;, &quot;cut&quot;,
410             &quot;UP&quot;, &quot;selectPrevious&quot;,
411             &quot;KP_UP&quot;, &quot;selectPrevious&quot;,
412             &quot;shift UP&quot;, &quot;selectPreviousExtendSelection&quot;,
413             &quot;shift KP_UP&quot;, &quot;selectPreviousExtendSelection&quot;,
414             &quot;DOWN&quot;, &quot;selectNext&quot;,
415             &quot;KP_DOWN&quot;, &quot;selectNext&quot;,
416             &quot;shift DOWN&quot;, &quot;selectNextExtendSelection&quot;,
417             &quot;shift KP_DOWN&quot;, &quot;selectNextExtendSelection&quot;,
418             &quot;RIGHT&quot;, &quot;aquaExpandNode&quot;,
419             &quot;KP_RIGHT&quot;, &quot;aquaExpandNode&quot;,
420             &quot;LEFT&quot;, &quot;aquaCollapseNode&quot;,
421             &quot;KP_LEFT&quot;, &quot;aquaCollapseNode&quot;,
422             &quot;shift RIGHT&quot;, &quot;aquaExpandNode&quot;,
423             &quot;shift KP_RIGHT&quot;, &quot;aquaExpandNode&quot;,
424             &quot;shift LEFT&quot;, &quot;aquaCollapseNode&quot;,
425             &quot;shift KP_LEFT&quot;, &quot;aquaCollapseNode&quot;,
426             &quot;ctrl LEFT&quot;, &quot;aquaCollapseNode&quot;,
427             &quot;ctrl KP_LEFT&quot;, &quot;aquaCollapseNode&quot;,
428             &quot;ctrl RIGHT&quot;, &quot;aquaExpandNode&quot;,
429             &quot;ctrl KP_RIGHT&quot;, &quot;aquaExpandNode&quot;,
430             &quot;alt RIGHT&quot;, &quot;aquaFullyExpandNode&quot;,
431             &quot;alt KP_RIGHT&quot;, &quot;aquaFullyExpandNode&quot;,
432             &quot;alt LEFT&quot;, &quot;aquaFullyCollapseNode&quot;,
433             &quot;alt KP_LEFT&quot;, &quot;aquaFullyCollapseNode&quot;,
434             &quot;meta A&quot;, &quot;selectAll&quot;,
435             &quot;RETURN&quot;, &quot;startEditing&quot;
436         }));
437     }
438 
439     LateBoundInputMap getTreeRightToLeftInputMap() {
440         return new LateBoundInputMap(new SimpleBinding(new String[] {
441             &quot;RIGHT&quot;, &quot;aquaCollapseNode&quot;,
442             &quot;KP_RIGHT&quot;, &quot;aquaCollapseNode&quot;,
443             &quot;LEFT&quot;, &quot;aquaExpandNode&quot;,
444             &quot;KP_LEFT&quot;, &quot;aquaExpandNode&quot;,
445             &quot;shift RIGHT&quot;, &quot;aquaCollapseNode&quot;,
446             &quot;shift KP_RIGHT&quot;, &quot;aquaCollapseNode&quot;,
447             &quot;shift LEFT&quot;, &quot;aquaExpandNode&quot;,
448             &quot;shift KP_LEFT&quot;, &quot;aquaExpandNode&quot;,
449             &quot;ctrl LEFT&quot;, &quot;aquaExpandNode&quot;,
450             &quot;ctrl KP_LEFT&quot;, &quot;aquaExpandNode&quot;,
451             &quot;ctrl RIGHT&quot;, &quot;aquaCollapseNode&quot;,
452             &quot;ctrl KP_RIGHT&quot;, &quot;aquaCollapseNode&quot;
453         }));
454     }
455 
456     // common interface between a string array, and a dynamic provider of string arrays ;-)
457     interface BindingsProvider {
458         public String[] getBindings();
459     }
460 
461     // wraps basic string arrays
462     static class SimpleBinding implements BindingsProvider {
463         final String[] bindings;
464         public SimpleBinding(final String[] bindings) { this.bindings = bindings; }
465         public String[] getBindings() { return bindings; }
466     }
467 
468     // patches all providers together at the moment the UIManager needs the real InputMap
469     static class LateBoundInputMap implements LazyValue, BindingsProvider {
470         private final BindingsProvider[] providerList;
471         private String[] mergedBindings;
472 
473         public LateBoundInputMap(final BindingsProvider ... providerList) {
474             this.providerList = providerList;
475         }
476 
477         public Object createValue(final UIDefaults table) {
478             return LookAndFeel.makeInputMap(getBindings());
479         }
480 
481         public String[] getBindings() {
482             if (mergedBindings != null) return mergedBindings;
483 
484             final String[][] bindingsList = new String[providerList.length][];
485             int size = 0;
486             for (int i = 0; i &lt; providerList.length; i++) {
487                 bindingsList[i] = providerList[i].getBindings();
488                 size += bindingsList[i].length;
489             }
490 
491             if (bindingsList.length == 1) {
492                 return mergedBindings = bindingsList[0];
493             }
494 
495             final ArrayList&lt;String&gt; unifiedList = new ArrayList&lt;String&gt;(size);
496             Collections.addAll(unifiedList, bindingsList[0]); // System.arrayCopy() the first set
497 
498             for (int i = 1; i &lt; providerList.length; i++) {
499                 mergeBindings(unifiedList, bindingsList[i]);
500             }
501 
502             return mergedBindings = unifiedList.toArray(new String[unifiedList.size()]);
503         }
504 
505         static void mergeBindings(final ArrayList&lt;String&gt; unifiedList, final String[] overrides) {
506             for (int i = 0; i &lt; overrides.length; i+=2) {
507                 final String key = overrides[i];
508                 final String value = overrides[i+1];
509 
510                 final int keyIndex = unifiedList.indexOf(key);
511                 if (keyIndex == -1) {
512                     unifiedList.add(key);
513                     unifiedList.add(value);
514                 } else {
515                     unifiedList.set(keyIndex, key);
516                     unifiedList.set(keyIndex + 1, value);
517                 }
518             }
519         }
520     }
521 
522     void installAquaUpDownActions(final JTextComponent component) {
523         final ActionMap actionMap = component.getActionMap();
524         actionMap.put(upMultilineAction, moveUpMultilineAction);
525         actionMap.put(downMultilineAction, moveDownMultilineAction);
526         actionMap.put(pageUpMultiline, pageUpMultilineAction);
527         actionMap.put(pageDownMultiline, pageDownMultilineAction);
528     }
529 
530     // extracted and adapted from DefaultEditorKit in 1.6
531     @SuppressWarnings(&quot;serial&quot;) // Superclass is not serializable across versions
532     abstract static class DeleteWordAction extends TextAction {
533         public DeleteWordAction(final String name) { super(name); }
534 
535         public void actionPerformed(final ActionEvent e) {
536             if (e == null) return;
537 
538             final JTextComponent target = getTextComponent(e);
539             if (target == null) return;
540 
541             if (!target.isEditable() || !target.isEnabled()) {
542                 UIManager.getLookAndFeel().provideErrorFeedback(target);
543                 return;
544             }
545 
546             try {
547                 final int start = target.getSelectionStart();
548                 final Element line = Utilities.getParagraphElement(target, start);
549                 final int end = getEnd(target, line, start);
550 
551                 final int offs = Math.min(start, end);
552                 final int len = Math.abs(end - start);
553                 if (offs &gt;= 0) {
554                     target.getDocument().remove(offs, len);
555                     return;
556                 }
557             } catch (final BadLocationException ignore) {}
558             UIManager.getLookAndFeel().provideErrorFeedback(target);
559         }
560 
561         abstract int getEnd(final JTextComponent target, final Element line, final int start) throws BadLocationException;
562     }
563 
564     final TextAction moveUpMultilineAction = new AquaMultilineAction(upMultilineAction, DefaultEditorKit.upAction, DefaultEditorKit.beginAction);
565     final TextAction moveDownMultilineAction = new AquaMultilineAction(downMultilineAction, DefaultEditorKit.downAction, DefaultEditorKit.endAction);
566     final TextAction pageUpMultilineAction = new AquaMultilineAction(pageUpMultiline, DefaultEditorKit.pageUpAction, DefaultEditorKit.beginAction);
567     final TextAction pageDownMultilineAction = new AquaMultilineAction(pageDownMultiline, DefaultEditorKit.pageDownAction, DefaultEditorKit.endAction);
568 
569     @SuppressWarnings(&quot;serial&quot;) // Superclass is not serializable across versions
570     static class AquaMultilineAction extends TextAction {
571         final String targetActionName;
572         final String proxyActionName;
573 
574         public AquaMultilineAction(final String actionName, final String targetActionName, final String proxyActionName) {
575             super(actionName);
576             this.targetActionName = targetActionName;
577             this.proxyActionName = proxyActionName;
578         }
579 
580         public void actionPerformed(final ActionEvent e) {
581             final JTextComponent c = getTextComponent(e);
582             final ActionMap actionMap = c.getActionMap();
583             final Action targetAction = actionMap.get(targetActionName);
584 
585             final int startPosition = c.getCaretPosition();
586             targetAction.actionPerformed(e);
587             if (startPosition != c.getCaretPosition()) return;
588 
589             final Action proxyAction = actionMap.get(proxyActionName);
590             proxyAction.actionPerformed(e);
591         }
592     }
593 }
<a name="3" id="anc3"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="3" type="hidden" />
</body>
</html>