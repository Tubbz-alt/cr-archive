<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.desktop/windows/native/libawt/windows/awt_Menu.cpp</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="awt_Frame.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="awt_Menu.h.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/windows/native/libawt/windows/awt_Menu.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 1996, 2014, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 1996, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -126,28 +126,10 @@</span>
      }
  
      return menu;
  }
  
<span class="udiff-line-removed">- void AwtMenu::_AddSeparator(void *param)</span>
<span class="udiff-line-removed">- {</span>
<span class="udiff-line-removed">-     if (AwtToolkit::IsMainThread()) {</span>
<span class="udiff-line-removed">-         JNIEnv *env = (JNIEnv *)JNU_GetEnv(jvm, JNI_VERSION_1_2);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         jobject self = (jobject)param;</span>
<span class="udiff-line-removed">-         AwtMenu *m = NULL;</span>
<span class="udiff-line-removed">-         PDATA pData;</span>
<span class="udiff-line-removed">-         JNI_CHECK_PEER_GOTO(self, ret);</span>
<span class="udiff-line-removed">-         m = (AwtMenu *)pData;</span>
<span class="udiff-line-removed">-         m-&gt;AddSeparator();</span>
<span class="udiff-line-removed">- ret:</span>
<span class="udiff-line-removed">-         env-&gt;DeleteGlobalRef(self);</span>
<span class="udiff-line-removed">-     } else {</span>
<span class="udiff-line-removed">-         AwtToolkit::GetInstance().InvokeFunction(AwtMenu::_AddSeparator, param);</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
  void AwtMenu::_DelItem(void *param)
  {
      if (AwtToolkit::IsMainThread()) {
          JNIEnv *env = (JNIEnv *)JNU_GetEnv(jvm, JNI_VERSION_1_2);
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -209,23 +191,19 @@</span>
  
  HWND AwtMenu::GetOwnerHWnd() {
      return (GetMenuContainer() == NULL) ? NULL : GetMenuContainer()-&gt;GetOwnerHWnd();
  }
  
<span class="udiff-line-removed">- void AwtMenu::AddSeparator() {</span>
<span class="udiff-line-removed">-     VERIFY(::AppendMenu(GetHMenu(), MF_SEPARATOR, 0, 0));</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
  void AwtMenu::AddItem(AwtMenuItem* item)
  {
      JNIEnv *env = (JNIEnv *)JNU_GetEnv(jvm, JNI_VERSION_1_2);
      if (env-&gt;EnsureLocalCapacity(2) &lt; 0) {
          return;
      }
  
      if (item-&gt;IsSeparator()) {
<span class="udiff-line-modified-removed">-         AddSeparator();</span>
<span class="udiff-line-modified-added">+         VERIFY(::AppendMenu(GetHMenu(), MF_SEPARATOR, 0, 0));</span>
      } else {
          /* jitem is a java.awt.MenuItem */
          jobject jitem = item-&gt;GetTarget(env);
  
          jboolean enabled =
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -401,28 +379,10 @@</span>
   * WMenuPeer native methods
   */
  
  extern &quot;C&quot; {
  
<span class="udiff-line-removed">- /*</span>
<span class="udiff-line-removed">-  * Class:     sun_awt_windows_WMenuPeer</span>
<span class="udiff-line-removed">-  * Method:    addSeparator</span>
<span class="udiff-line-removed">-  * Signature: ()V</span>
<span class="udiff-line-removed">-  */</span>
<span class="udiff-line-removed">- JNIEXPORT void JNICALL</span>
<span class="udiff-line-removed">- Java_sun_awt_windows_WMenuPeer_addSeparator(JNIEnv *env, jobject self)</span>
<span class="udiff-line-removed">- {</span>
<span class="udiff-line-removed">-     TRY;</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     jobject selfGlobalRef = env-&gt;NewGlobalRef(self);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     AwtToolkit::GetInstance().SyncCall(AwtMenu::_AddSeparator, selfGlobalRef);</span>
<span class="udiff-line-removed">-     // selfGlobalRef is deleted in _AddSeparator</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     CATCH_BAD_ALLOC;</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
  /*
   * Class:     sun_awt_windows_WMenuPeer
   * Method:    delItem
   * Signature: (I)V
   */
</pre>
<center><a href="awt_Frame.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="awt_Menu.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>