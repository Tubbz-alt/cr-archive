<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.desktop/windows/native/libawt/java2d/d3d/D3DContext.cpp</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../common/awt/systemscale/systemScale.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="D3DContext.h.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/windows/native/libawt/java2d/d3d/D3DContext.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2007, 2016, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2007, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -683,68 +683,10 @@</span>
          }
      }
      return res;
  }
  
<span class="udiff-line-removed">- HRESULT</span>
<span class="udiff-line-removed">- D3DContext::SaveState()</span>
<span class="udiff-line-removed">- {</span>
<span class="udiff-line-removed">-     HRESULT res;</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     RETURN_STATUS_IF_NULL(pd3dDevice, S_OK);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     J2dTraceLn(J2D_TRACE_INFO, &quot;D3DContext::SaveState&quot;);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     FlushVertexQueue();</span>
<span class="udiff-line-removed">-     UpdateState(STATE_CHANGE);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     if (pStateBlock != NULL) {</span>
<span class="udiff-line-removed">-         J2dTraceLn(J2D_TRACE_WARNING,</span>
<span class="udiff-line-removed">-                    &quot;D3DContext::SaveState: existing state block!&quot;);</span>
<span class="udiff-line-removed">-         SAFE_RELEASE(pStateBlock);</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     if (SUCCEEDED(res =</span>
<span class="udiff-line-removed">-             pd3dDevice-&gt;CreateStateBlock(D3DSBT_ALL, &amp;pStateBlock)))</span>
<span class="udiff-line-removed">-     {</span>
<span class="udiff-line-removed">-         J2dTraceLn(J2D_TRACE_VERBOSE, &quot;  created state block&quot;);</span>
<span class="udiff-line-removed">-     } else {</span>
<span class="udiff-line-removed">-         J2dTraceLn(J2D_TRACE_WARNING,</span>
<span class="udiff-line-removed">-                    &quot;D3DContext::SaveState: failed to create state block&quot;);</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">-     ZeroMemory(lastTexture, sizeof(lastTexture));</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     return res;</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- HRESULT</span>
<span class="udiff-line-removed">- D3DContext::RestoreState()</span>
<span class="udiff-line-removed">- {</span>
<span class="udiff-line-removed">-     HRESULT res = S_OK;</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     J2dTraceLn(J2D_TRACE_INFO, &quot;D3DContext::RestoreState&quot;);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     FlushVertexQueue();</span>
<span class="udiff-line-removed">-     UpdateState(STATE_CHANGE);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     if (pStateBlock != NULL) {</span>
<span class="udiff-line-removed">-         if (SUCCEEDED(res = pStateBlock-&gt;Apply())) {</span>
<span class="udiff-line-removed">-             J2dTraceLn(J2D_TRACE_VERBOSE, &quot;  restored device state&quot;);</span>
<span class="udiff-line-removed">-         } else {</span>
<span class="udiff-line-removed">-             J2dTraceLn(J2D_TRACE_WARNING,</span>
<span class="udiff-line-removed">-                        &quot;D3DContext::RestoreState: failed to restore state&quot;);</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-         SAFE_RELEASE(pStateBlock);</span>
<span class="udiff-line-removed">-     } else {</span>
<span class="udiff-line-removed">-         J2dTraceLn(J2D_TRACE_WARNING,</span>
<span class="udiff-line-removed">-                    &quot;D3DContext::RestoreState: empty state block!&quot;);</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">-     ZeroMemory(lastTexture, sizeof(lastTexture));</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     return res;</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
  #define POINT_FILTER_CAP (D3DPTFILTERCAPS_MAGFPOINT|D3DPTFILTERCAPS_MINFPOINT)
  #define LINEAR_FILTER_CAP (D3DPTFILTERCAPS_MAGFLINEAR|D3DPTFILTERCAPS_MINFLINEAR)
  
  BOOL
  D3DContext::IsStretchRectFilteringSupported(D3DTEXTUREFILTERTYPE fType)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1148,11 +1090,13 @@</span>
                                  jint *pPixelsTouchedL,
                                  jint* pPixelsTouchedR)
  {
  #ifndef PtrAddBytes
  #define PtrAddBytes(p, b)               ((void *) (((intptr_t) (p)) + (b)))
<span class="udiff-line-modified-removed">- #define PtrCoord(p, x, xinc, y, yinc)   PtrAddBytes(p, (y)*(yinc) + (x)*(xinc))</span>
<span class="udiff-line-modified-added">+ #define PtrCoord(p, x, xinc, y, yinc)   PtrAddBytes(p, \</span>
<span class="udiff-line-added">+                                                     ((ptrdiff_t)(y))*(yinc) + \</span>
<span class="udiff-line-added">+                                                     ((ptrdiff_t)(x))*(xinc))</span>
  #endif // PtrAddBytes
  
      HRESULT res = S_OK;
      IDirect3DTexture9 *pTexture = pTextureRes-&gt;GetTexture();
      D3DSURFACE_DESC *pDesc = pTextureRes-&gt;GetDesc();
</pre>
<center><a href="../../../common/awt/systemscale/systemScale.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="D3DContext.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>