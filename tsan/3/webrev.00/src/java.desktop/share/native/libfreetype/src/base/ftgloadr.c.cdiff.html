<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/share/native/libfreetype/src/base/ftgloadr.c</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="ftgasp.c.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ftglyph.c.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfreetype/src/base/ftgloadr.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,31 ***</span>
<span class="line-modified">! /***************************************************************************/</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /*  ftgloadr.c                                                             */</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /*    The FreeType glyph loader (body).                                    */</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /*  Copyright 2002-2018 by                                                 */</span>
<span class="line-modified">! /*  David Turner, Robert Wilhelm, and Werner Lemberg                       */</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /*  This file is part of the FreeType project, and may only be used,       */</span>
<span class="line-modified">! /*  modified, and distributed under the terms of the FreeType project      */</span>
<span class="line-modified">! /*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<span class="line-modified">! /*  this file you indicate that you have read the license and              */</span>
<span class="line-modified">! /*  understand and accept it fully.                                        */</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /***************************************************************************/</span>
  
  
  #include &lt;ft2build.h&gt;
  #include FT_INTERNAL_DEBUG_H
  #include FT_INTERNAL_GLYPH_LOADER_H
  #include FT_INTERNAL_MEMORY_H
  #include FT_INTERNAL_OBJECTS_H
  
  #undef  FT_COMPONENT
<span class="line-modified">! #define FT_COMPONENT  trace_gloader</span>
  
  
    /*************************************************************************/
    /*************************************************************************/
    /*************************************************************************/
<span class="line-new-header">--- 1,31 ---</span>
<span class="line-modified">! /****************************************************************************</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  * ftgloadr.c</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  *   The FreeType glyph loader (body).</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  * Copyright (C) 2002-2019 by</span>
<span class="line-modified">!  * David Turner, Robert Wilhelm, and Werner Lemberg</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  * This file is part of the FreeType project, and may only be used,</span>
<span class="line-modified">!  * modified, and distributed under the terms of the FreeType project</span>
<span class="line-modified">!  * license, LICENSE.TXT.  By continuing to use, modify, or distribute</span>
<span class="line-modified">!  * this file you indicate that you have read the license and</span>
<span class="line-modified">!  * understand and accept it fully.</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  */</span>
  
  
  #include &lt;ft2build.h&gt;
  #include FT_INTERNAL_DEBUG_H
  #include FT_INTERNAL_GLYPH_LOADER_H
  #include FT_INTERNAL_MEMORY_H
  #include FT_INTERNAL_OBJECTS_H
  
  #undef  FT_COMPONENT
<span class="line-modified">! #define FT_COMPONENT  gloader</span>
  
  
    /*************************************************************************/
    /*************************************************************************/
    /*************************************************************************/
</pre>
<hr />
<pre>
<span class="line-old-header">*** 36,35 ***</span>
    /*****                                                               *****/
    /*************************************************************************/
    /*************************************************************************/
    /*************************************************************************/
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* The glyph loader is a simple object which is used to load a set of    */</span>
<span class="line-modified">!   /* glyphs easily.  It is critical for the correct loading of composites. */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* Ideally, one can see it as a stack of abstract `glyph&#39; objects.       */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*   loader.base     Is really the bottom of the stack.  It describes a  */</span>
<span class="line-modified">!   /*                   single glyph image made of the juxtaposition of     */</span>
<span class="line-modified">!   /*                   several glyphs (those `in the stack&#39;).              */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*   loader.current  Describes the top of the stack, on which a new      */</span>
<span class="line-modified">!   /*                   glyph can be loaded.                                */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*   Rewind          Clears the stack.                                   */</span>
<span class="line-modified">!   /*   Prepare         Set up `loader.current&#39; for addition of a new glyph */</span>
<span class="line-modified">!   /*                   image.                                              */</span>
<span class="line-modified">!   /*   Add             Add the `current&#39; glyph image to the `base&#39; one,    */</span>
<span class="line-modified">!   /*                   and prepare for another one.                        */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* The glyph loader is now a base object.  Each driver used to           */</span>
<span class="line-modified">!   /* re-implement it in one way or the other, which wasted code and        */</span>
<span class="line-modified">!   /* energy.                                                               */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*************************************************************************/</span>
  
  
    /* create a new glyph loader */
    FT_BASE_DEF( FT_Error )
    FT_GlyphLoader_New( FT_Memory        memory,
<span class="line-new-header">--- 36,35 ---</span>
    /*****                                                               *****/
    /*************************************************************************/
    /*************************************************************************/
    /*************************************************************************/
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * The glyph loader is a simple object which is used to load a set of</span>
<span class="line-modified">!    * glyphs easily.  It is critical for the correct loading of composites.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * Ideally, one can see it as a stack of abstract `glyph&#39; objects.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   loader.base     Is really the bottom of the stack.  It describes a</span>
<span class="line-modified">!    *                   single glyph image made of the juxtaposition of</span>
<span class="line-modified">!    *                   several glyphs (those `in the stack&#39;).</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   loader.current  Describes the top of the stack, on which a new</span>
<span class="line-modified">!    *                   glyph can be loaded.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   Rewind          Clears the stack.</span>
<span class="line-modified">!    *   Prepare         Set up `loader.current&#39; for addition of a new glyph</span>
<span class="line-modified">!    *                   image.</span>
<span class="line-modified">!    *   Add             Add the `current&#39; glyph image to the `base&#39; one,</span>
<span class="line-modified">!    *                   and prepare for another one.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * The glyph loader is now a base object.  Each driver used to</span>
<span class="line-modified">!    * re-implement it in one way or the other, which wasted code and</span>
<span class="line-modified">!    * energy.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    */</span>
  
  
    /* create a new glyph loader */
    FT_BASE_DEF( FT_Error )
    FT_GlyphLoader_New( FT_Memory        memory,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 97,16 ***</span>
  
      *current = *base;
    }
  
  
<span class="line-modified">!   /* reset the glyph loader, frees all allocated tables */</span>
<span class="line-modified">!   /* and starts from zero                               */</span>
    FT_BASE_DEF( void )
    FT_GlyphLoader_Reset( FT_GlyphLoader  loader )
    {
<span class="line-modified">!     FT_Memory memory = loader-&gt;memory;</span>
  
  
      FT_FREE( loader-&gt;base.outline.points );
      FT_FREE( loader-&gt;base.outline.tags );
      FT_FREE( loader-&gt;base.outline.contours );
<span class="line-new-header">--- 97,16 ---</span>
  
      *current = *base;
    }
  
  
<span class="line-modified">!   /* reset glyph loader, free all allocated tables, */</span>
<span class="line-modified">!   /* and start from zero                            */</span>
    FT_BASE_DEF( void )
    FT_GlyphLoader_Reset( FT_GlyphLoader  loader )
    {
<span class="line-modified">!     FT_Memory  memory = loader-&gt;memory;</span>
  
  
      FT_FREE( loader-&gt;base.outline.points );
      FT_FREE( loader-&gt;base.outline.tags );
      FT_FREE( loader-&gt;base.outline.contours );
</pre>
<hr />
<pre>
<span class="line-old-header">*** 127,11 ***</span>
    FT_BASE_DEF( void )
    FT_GlyphLoader_Done( FT_GlyphLoader  loader )
    {
      if ( loader )
      {
<span class="line-modified">!       FT_Memory memory = loader-&gt;memory;</span>
  
  
        FT_GlyphLoader_Reset( loader );
        FT_FREE( loader );
      }
<span class="line-new-header">--- 127,11 ---</span>
    FT_BASE_DEF( void )
    FT_GlyphLoader_Done( FT_GlyphLoader  loader )
    {
      if ( loader )
      {
<span class="line-modified">!       FT_Memory  memory = loader-&gt;memory;</span>
  
  
        FT_GlyphLoader_Reset( loader );
        FT_FREE( loader );
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 359,48 ***</span>
      /* prepare for another new glyph image */
      FT_GlyphLoader_Prepare( loader );
    }
  
  
<span class="line-removed">-   FT_BASE_DEF( FT_Error )</span>
<span class="line-removed">-   FT_GlyphLoader_CopyPoints( FT_GlyphLoader  target,</span>
<span class="line-removed">-                              FT_GlyphLoader  source )</span>
<span class="line-removed">-   {</span>
<span class="line-removed">-     FT_Error  error;</span>
<span class="line-removed">-     FT_UInt   num_points   = (FT_UInt)source-&gt;base.outline.n_points;</span>
<span class="line-removed">-     FT_UInt   num_contours = (FT_UInt)source-&gt;base.outline.n_contours;</span>
<span class="line-removed">- </span>
<span class="line-removed">- </span>
<span class="line-removed">-     error = FT_GlyphLoader_CheckPoints( target, num_points, num_contours );</span>
<span class="line-removed">-     if ( !error )</span>
<span class="line-removed">-     {</span>
<span class="line-removed">-       FT_Outline*  out = &amp;target-&gt;base.outline;</span>
<span class="line-removed">-       FT_Outline*  in  = &amp;source-&gt;base.outline;</span>
<span class="line-removed">- </span>
<span class="line-removed">- </span>
<span class="line-removed">-       FT_ARRAY_COPY( out-&gt;points, in-&gt;points,</span>
<span class="line-removed">-                      num_points );</span>
<span class="line-removed">-       FT_ARRAY_COPY( out-&gt;tags, in-&gt;tags,</span>
<span class="line-removed">-                      num_points );</span>
<span class="line-removed">-       FT_ARRAY_COPY( out-&gt;contours, in-&gt;contours,</span>
<span class="line-removed">-                      num_contours );</span>
<span class="line-removed">- </span>
<span class="line-removed">-       /* do we need to copy the extra points? */</span>
<span class="line-removed">-       if ( target-&gt;use_extra &amp;&amp; source-&gt;use_extra )</span>
<span class="line-removed">-       {</span>
<span class="line-removed">-         FT_ARRAY_COPY( target-&gt;base.extra_points, source-&gt;base.extra_points,</span>
<span class="line-removed">-                        num_points );</span>
<span class="line-removed">-         FT_ARRAY_COPY( target-&gt;base.extra_points2, source-&gt;base.extra_points2,</span>
<span class="line-removed">-                        num_points );</span>
<span class="line-removed">-       }</span>
<span class="line-removed">- </span>
<span class="line-removed">-       out-&gt;n_points   = (short)num_points;</span>
<span class="line-removed">-       out-&gt;n_contours = (short)num_contours;</span>
<span class="line-removed">- </span>
<span class="line-removed">-       FT_GlyphLoader_Adjust_Points( target );</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     return error;</span>
<span class="line-removed">-   }</span>
<span class="line-removed">- </span>
<span class="line-removed">- </span>
  /* END */
<span class="line-new-header">--- 359,6 ---</span>
</pre>
<center><a href="ftgasp.c.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ftglyph.c.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>