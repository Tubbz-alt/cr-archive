<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.desktop/share/native/libfreetype/include/freetype/internal/ftrfork.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre><a name="1" id="anc1"></a><span class="line-modified">  1 /****************************************************************************</span>
<span class="line-modified">  2  *</span>
<span class="line-modified">  3  * ftrfork.h</span>
<span class="line-modified">  4  *</span>
<span class="line-modified">  5  *   Embedded resource forks accessor (specification).</span>
<span class="line-modified">  6  *</span>
<span class="line-modified">  7  * Copyright (C) 2004-2019 by</span>
<span class="line-modified">  8  * Masatake YAMATO and Redhat K.K.</span>
<span class="line-modified">  9  *</span>
<span class="line-modified"> 10  * This file is part of the FreeType project, and may only be used,</span>
<span class="line-modified"> 11  * modified, and distributed under the terms of the FreeType project</span>
<span class="line-modified"> 12  * license, LICENSE.TXT.  By continuing to use, modify, or distribute</span>
<span class="line-modified"> 13  * this file you indicate that you have read the license and</span>
<span class="line-modified"> 14  * understand and accept it fully.</span>
<span class="line-modified"> 15  *</span>
<span class="line-modified"> 16  */</span>
<span class="line-modified"> 17 </span>
<span class="line-modified"> 18 /****************************************************************************</span>
<span class="line-modified"> 19  * Development of the code in this file is support of</span>
<span class="line-modified"> 20  * Information-technology Promotion Agency, Japan.</span>
<span class="line-modified"> 21  */</span>
 22 
 23 
 24 #ifndef FTRFORK_H_
 25 #define FTRFORK_H_
 26 
 27 
 28 #include &lt;ft2build.h&gt;
 29 #include FT_INTERNAL_OBJECTS_H
 30 
 31 
 32 FT_BEGIN_HEADER
 33 
 34 
 35   /* Number of guessing rules supported in `FT_Raccess_Guess&#39;.            */
 36   /* Don&#39;t forget to increment the number if you add a new guessing rule. */
 37 #define FT_RACCESS_N_RULES  9
 38 
 39 
 40   /* A structure to describe a reference in a resource by its resource ID */
 41   /* and internal offset.  The `POST&#39; resource expects to be concatenated */
 42   /* by the order of resource IDs instead of its appearance in the file.  */
 43 
 44   typedef struct  FT_RFork_Ref_
 45   {
 46     FT_Short  res_id;
 47     FT_Long   offset;
 48 
 49   } FT_RFork_Ref;
 50 
 51 
 52 #ifdef FT_CONFIG_OPTION_GUESSING_EMBEDDED_RFORK
 53   typedef FT_Error
 54   (*ft_raccess_guess_func)( FT_Library  library,
 55                             FT_Stream   stream,
 56                             char       *base_file_name,
 57                             char      **result_file_name,
 58                             FT_Long    *result_offset );
 59 
 60   typedef enum  FT_RFork_Rule_ {
 61     FT_RFork_Rule_invalid = -2,
 62     FT_RFork_Rule_uknown, /* -1 */
 63     FT_RFork_Rule_apple_double,
 64     FT_RFork_Rule_apple_single,
 65     FT_RFork_Rule_darwin_ufs_export,
 66     FT_RFork_Rule_darwin_newvfs,
 67     FT_RFork_Rule_darwin_hfsplus,
 68     FT_RFork_Rule_vfat,
 69     FT_RFork_Rule_linux_cap,
 70     FT_RFork_Rule_linux_double,
 71     FT_RFork_Rule_linux_netatalk
 72   } FT_RFork_Rule;
 73 
 74   /* For fast translation between rule index and rule type,
<a name="2" id="anc2"></a><span class="line-modified"> 75    * the macros FT_RFORK_xxx should be kept consistent with the</span>
<span class="line-modified"> 76    * raccess_guess_funcs table</span>
 77    */
 78   typedef struct ft_raccess_guess_rec_ {
 79     ft_raccess_guess_func  func;
 80     FT_RFork_Rule          type;
 81   } ft_raccess_guess_rec;
 82 
<a name="3" id="anc3"></a>
 83 
<a name="4" id="anc4"></a>
 84 #define CONST_FT_RFORK_RULE_ARRAY_BEGIN( name, type )  \
 85           static const type name[] = {
 86 #define CONST_FT_RFORK_RULE_ARRAY_ENTRY( func_suffix, type_suffix )  \
 87           { raccess_guess_ ## func_suffix,                           \
 88             FT_RFork_Rule_ ## type_suffix },
<a name="5" id="anc5"></a><span class="line-added"> 89   /* this array is a storage, thus a final `;&#39; is needed */</span>
 90 #define CONST_FT_RFORK_RULE_ARRAY_END  };
 91 
<a name="6" id="anc6"></a>


















 92 #endif /* FT_CONFIG_OPTION_GUESSING_EMBEDDED_RFORK */
 93 
 94 
<a name="7" id="anc7"></a><span class="line-modified"> 95   /**************************************************************************</span>
<span class="line-modified"> 96    *</span>
<span class="line-modified"> 97    * @function:</span>
<span class="line-modified"> 98    *   FT_Raccess_Guess</span>
<span class="line-modified"> 99    *</span>
<span class="line-modified">100    * @description:</span>
<span class="line-modified">101    *   Guess a file name and offset where the actual resource fork is stored.</span>
<span class="line-modified">102    *   The macro FT_RACCESS_N_RULES holds the number of guessing rules; the</span>
<span class="line-modified">103    *   guessed result for the Nth rule is represented as a triplet: a new</span>
<span class="line-modified">104    *   file name (new_names[N]), a file offset (offsets[N]), and an error</span>
<span class="line-modified">105    *   code (errors[N]).</span>
<span class="line-modified">106    *</span>
<span class="line-modified">107    * @input:</span>
<span class="line-modified">108    *   library ::</span>
<span class="line-modified">109    *     A FreeType library instance.</span>
<span class="line-modified">110    *</span>
<span class="line-modified">111    *   stream ::</span>
<span class="line-modified">112    *     A file stream containing the resource fork.</span>
<span class="line-modified">113    *</span>
<span class="line-modified">114    *   base_name ::</span>
<span class="line-modified">115    *     The (base) file name of the resource fork used for some guessing</span>
<span class="line-modified">116    *     rules.</span>
<span class="line-modified">117    *</span>
<span class="line-modified">118    * @output:</span>
<span class="line-modified">119    *   new_names ::</span>
<span class="line-modified">120    *     An array of guessed file names in which the resource forks may</span>
<span class="line-modified">121    *     exist.  If &#39;new_names[N]&#39; is `NULL`, the guessed file name is equal</span>
<span class="line-modified">122    *     to `base_name`.</span>
<span class="line-modified">123    *</span>
<span class="line-modified">124    *   offsets ::</span>
<span class="line-modified">125    *     An array of guessed file offsets.  &#39;offsets[N]&#39; holds the file</span>
<span class="line-modified">126    *     offset of the possible start of the resource fork in file</span>
<span class="line-modified">127    *     &#39;new_names[N]&#39;.</span>
<span class="line-modified">128    *</span>
<span class="line-modified">129    *   errors ::</span>
<span class="line-modified">130    *     An array of FreeType error codes.  &#39;errors[N]&#39; is the error code of</span>
<span class="line-modified">131    *     Nth guessing rule function.  If &#39;errors[N]&#39; is not FT_Err_Ok,</span>
<span class="line-modified">132    *     &#39;new_names[N]&#39; and &#39;offsets[N]&#39; are meaningless.</span>
<span class="line-modified">133    */</span>
134   FT_BASE( void )
135   FT_Raccess_Guess( FT_Library  library,
136                     FT_Stream   stream,
137                     char*       base_name,
138                     char**      new_names,
139                     FT_Long*    offsets,
140                     FT_Error*   errors );
141 
142 
<a name="8" id="anc8"></a><span class="line-modified">143   /**************************************************************************</span>
<span class="line-modified">144    *</span>
<span class="line-modified">145    * @function:</span>
<span class="line-modified">146    *   FT_Raccess_Get_HeaderInfo</span>
<span class="line-modified">147    *</span>
<span class="line-modified">148    * @description:</span>
<span class="line-modified">149    *   Get the information from the header of resource fork.  The information</span>
<span class="line-modified">150    *   includes the file offset where the resource map starts, and the file</span>
<span class="line-modified">151    *   offset where the resource data starts.  `FT_Raccess_Get_DataOffsets`</span>
<span class="line-modified">152    *   requires these two data.</span>
<span class="line-modified">153    *</span>
<span class="line-modified">154    * @input:</span>
<span class="line-modified">155    *   library ::</span>
<span class="line-modified">156    *     A FreeType library instance.</span>
<span class="line-modified">157    *</span>
<span class="line-modified">158    *   stream ::</span>
<span class="line-modified">159    *     A file stream containing the resource fork.</span>
<span class="line-modified">160    *</span>
<span class="line-modified">161    *   rfork_offset ::</span>
<span class="line-modified">162    *     The file offset where the resource fork starts.</span>
<span class="line-modified">163    *</span>
<span class="line-modified">164    * @output:</span>
<span class="line-modified">165    *   map_offset ::</span>
<span class="line-modified">166    *     The file offset where the resource map starts.</span>
<span class="line-modified">167    *</span>
<span class="line-modified">168    *   rdata_pos ::</span>
<span class="line-modified">169    *     The file offset where the resource data starts.</span>
<span class="line-modified">170    *</span>
<span class="line-modified">171    * @return:</span>
<span class="line-modified">172    *   FreeType error code.  FT_Err_Ok means success.</span>
<span class="line-modified">173    */</span>
174   FT_BASE( FT_Error )
175   FT_Raccess_Get_HeaderInfo( FT_Library  library,
176                              FT_Stream   stream,
177                              FT_Long     rfork_offset,
178                              FT_Long    *map_offset,
179                              FT_Long    *rdata_pos );
180 
181 
<a name="9" id="anc9"></a><span class="line-modified">182   /**************************************************************************</span>
<span class="line-modified">183    *</span>
<span class="line-modified">184    * @function:</span>
<span class="line-modified">185    *   FT_Raccess_Get_DataOffsets</span>
<span class="line-modified">186    *</span>
<span class="line-modified">187    * @description:</span>
<span class="line-modified">188    *   Get the data offsets for a tag in a resource fork.  Offsets are stored</span>
<span class="line-modified">189    *   in an array because, in some cases, resources in a resource fork have</span>
<span class="line-modified">190    *   the same tag.</span>
<span class="line-modified">191    *</span>
<span class="line-modified">192    * @input:</span>
<span class="line-modified">193    *   library ::</span>
<span class="line-modified">194    *     A FreeType library instance.</span>
<span class="line-modified">195    *</span>
<span class="line-modified">196    *   stream ::</span>
<span class="line-modified">197    *     A file stream containing the resource fork.</span>
<span class="line-modified">198    *</span>
<span class="line-modified">199    *   map_offset ::</span>
<span class="line-modified">200    *     The file offset where the resource map starts.</span>
<span class="line-modified">201    *</span>
<span class="line-modified">202    *   rdata_pos ::</span>
<span class="line-modified">203    *     The file offset where the resource data starts.</span>
<span class="line-modified">204    *</span>
<span class="line-modified">205    *   tag ::</span>
<span class="line-modified">206    *     The resource tag.</span>
<span class="line-modified">207    *</span>
<span class="line-modified">208    *   sort_by_res_id ::</span>
<span class="line-modified">209    *     A Boolean to sort the fragmented resource by their ids.  The</span>
<span class="line-modified">210    *     fragmented resources for &#39;POST&#39; resource should be sorted to restore</span>
<span class="line-modified">211    *     Type1 font properly.  For &#39;sfnt&#39; resources, sorting may induce a</span>
<span class="line-modified">212    *     different order of the faces in comparison to that by QuickDraw API.</span>
<span class="line-modified">213    *</span>
<span class="line-modified">214    * @output:</span>
<span class="line-modified">215    *   offsets ::</span>
<span class="line-modified">216    *     The stream offsets for the resource data specified by &#39;tag&#39;.  This</span>
<span class="line-modified">217    *     array is allocated by the function, so you have to call @ft_mem_free</span>
<span class="line-modified">218    *     after use.</span>
<span class="line-modified">219    *</span>
<span class="line-modified">220    *   count ::</span>
<span class="line-modified">221    *     The length of offsets array.</span>
<span class="line-modified">222    *</span>
<span class="line-modified">223    * @return:</span>
<span class="line-modified">224    *   FreeType error code.  FT_Err_Ok means success.</span>
<span class="line-modified">225    *</span>
<span class="line-modified">226    * @note:</span>
<span class="line-modified">227    *   Normally you should use `FT_Raccess_Get_HeaderInfo` to get the value</span>
<span class="line-modified">228    *   for `map_offset` and `rdata_pos`.</span>
<span class="line-modified">229    */</span>

230   FT_BASE( FT_Error )
231   FT_Raccess_Get_DataOffsets( FT_Library  library,
232                               FT_Stream   stream,
233                               FT_Long     map_offset,
234                               FT_Long     rdata_pos,
235                               FT_Long     tag,
236                               FT_Bool     sort_by_res_id,
237                               FT_Long   **offsets,
238                               FT_Long    *count );
239 
240 
241 FT_END_HEADER
242 
243 #endif /* FTRFORK_H_ */
244 
245 
246 /* END */
<a name="10" id="anc10"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="10" type="hidden" />
</body>
</html>