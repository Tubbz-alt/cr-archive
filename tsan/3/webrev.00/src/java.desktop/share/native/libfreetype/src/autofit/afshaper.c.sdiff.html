<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/native/libfreetype/src/autofit/afshaper.c</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="afscript.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="afshaper.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfreetype/src/autofit/afshaper.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
<span class="line-modified">  1 /***************************************************************************/</span>
<span class="line-modified">  2 /*                                                                         */</span>
<span class="line-modified">  3 /*  afshaper.c                                                             */</span>
<span class="line-modified">  4 /*                                                                         */</span>
<span class="line-modified">  5 /*    HarfBuzz interface for accessing OpenType features (body).           */</span>
<span class="line-modified">  6 /*                                                                         */</span>
<span class="line-modified">  7 /*  Copyright 2013-2018 by                                                 */</span>
<span class="line-modified">  8 /*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */</span>
<span class="line-modified">  9 /*                                                                         */</span>
<span class="line-modified"> 10 /*  This file is part of the FreeType project, and may only be used,       */</span>
<span class="line-modified"> 11 /*  modified, and distributed under the terms of the FreeType project      */</span>
<span class="line-modified"> 12 /*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<span class="line-modified"> 13 /*  this file you indicate that you have read the license and              */</span>
<span class="line-modified"> 14 /*  understand and accept it fully.                                        */</span>
<span class="line-modified"> 15 /*                                                                         */</span>
<span class="line-modified"> 16 /***************************************************************************/</span>
 17 
 18 
 19 #include &lt;ft2build.h&gt;
 20 #include FT_FREETYPE_H
 21 #include FT_ADVANCES_H
 22 #include &quot;afglobal.h&quot;
 23 #include &quot;aftypes.h&quot;
 24 #include &quot;afshaper.h&quot;
 25 
 26 #ifdef FT_CONFIG_OPTION_USE_HARFBUZZ
 27 
 28 
<span class="line-modified"> 29   /*************************************************************************/</span>
<span class="line-modified"> 30   /*                                                                       */</span>
<span class="line-modified"> 31   /* The macro FT_COMPONENT is used in trace mode.  It is an implicit      */</span>
<span class="line-modified"> 32   /* parameter of the FT_TRACE() and FT_ERROR() macros, used to print/log  */</span>
<span class="line-modified"> 33   /* messages during execution.                                            */</span>
<span class="line-modified"> 34   /*                                                                       */</span>
 35 #undef  FT_COMPONENT
<span class="line-modified"> 36 #define FT_COMPONENT  trace_afshaper</span>
 37 
 38 
 39   /*
 40    * We use `sets&#39; (in the HarfBuzz sense, which comes quite near to the
 41    * usual mathematical meaning) to manage both lookups and glyph indices.
 42    *
 43    * 1. For each coverage, collect lookup IDs in a set.  Note that an
 44    *    auto-hinter `coverage&#39; is represented by one `feature&#39;, and a
 45    *    feature consists of an arbitrary number of (font specific) `lookup&#39;s
 46    *    that actually do the mapping job.  Please check the OpenType
 47    *    specification for more details on features and lookups.
 48    *
 49    * 2. Create glyph ID sets from the corresponding lookup sets.
 50    *
 51    * 3. The glyph set corresponding to AF_COVERAGE_DEFAULT is computed
 52    *    with all lookups specific to the OpenType script activated.  It
 53    *    relies on the order of AF_DEFINE_STYLE_CLASS entries so that
 54    *    special coverages (like `oldstyle figures&#39;) don&#39;t get overwritten.
 55    *
 56    */
</pre>
<hr />
<pre>
574 
575 
576   FT_Error
577   af_shaper_get_coverage( AF_FaceGlobals  globals,
578                           AF_StyleClass   style_class,
579                           FT_UShort*      gstyles,
580                           FT_Bool         default_script )
581   {
582     FT_UNUSED( globals );
583     FT_UNUSED( style_class );
584     FT_UNUSED( gstyles );
585     FT_UNUSED( default_script );
586 
587     return FT_Err_Ok;
588   }
589 
590 
591   void*
592   af_shaper_buf_create( FT_Face  face )
593   {
<span class="line-modified">594     FT_Error   error;</span>
<span class="line-removed">595     FT_Memory  memory = face-&gt;memory;</span>
<span class="line-removed">596     FT_ULong*  buf;</span>
<span class="line-removed">597 </span>
<span class="line-removed">598 </span>
<span class="line-removed">599     FT_MEM_ALLOC( buf, sizeof ( FT_ULong ) );</span>
600 
<span class="line-modified">601     return (void*)buf;</span>
602   }
603 
604 
605   void
606   af_shaper_buf_destroy( FT_Face  face,
607                          void*    buf )
608   {
<span class="line-modified">609     FT_Memory  memory = face-&gt;memory;</span>
<span class="line-modified">610 </span>
<span class="line-removed">611 </span>
<span class="line-removed">612     FT_FREE( buf );</span>
613   }
614 
615 
616   const char*
617   af_shaper_get_cluster( const char*      p,
618                          AF_StyleMetrics  metrics,
619                          void*            buf_,
620                          unsigned int*    count )
621   {
622     FT_Face    face      = metrics-&gt;globals-&gt;face;
623     FT_ULong   ch, dummy = 0;
624     FT_ULong*  buf       = (FT_ULong*)buf_;
625 
626 
627     while ( *p == &#39; &#39; )
628       p++;
629 
630     GET_UTF8_CHAR( ch, p );
631 
632     /* since we don&#39;t have an engine to handle clusters, */
</pre>
</td>
<td>
<hr />
<pre>
<span class="line-modified">  1 /****************************************************************************</span>
<span class="line-modified">  2  *</span>
<span class="line-modified">  3  * afshaper.c</span>
<span class="line-modified">  4  *</span>
<span class="line-modified">  5  *   HarfBuzz interface for accessing OpenType features (body).</span>
<span class="line-modified">  6  *</span>
<span class="line-modified">  7  * Copyright (C) 2013-2019 by</span>
<span class="line-modified">  8  * David Turner, Robert Wilhelm, and Werner Lemberg.</span>
<span class="line-modified">  9  *</span>
<span class="line-modified"> 10  * This file is part of the FreeType project, and may only be used,</span>
<span class="line-modified"> 11  * modified, and distributed under the terms of the FreeType project</span>
<span class="line-modified"> 12  * license, LICENSE.TXT.  By continuing to use, modify, or distribute</span>
<span class="line-modified"> 13  * this file you indicate that you have read the license and</span>
<span class="line-modified"> 14  * understand and accept it fully.</span>
<span class="line-modified"> 15  *</span>
<span class="line-modified"> 16  */</span>
 17 
 18 
 19 #include &lt;ft2build.h&gt;
 20 #include FT_FREETYPE_H
 21 #include FT_ADVANCES_H
 22 #include &quot;afglobal.h&quot;
 23 #include &quot;aftypes.h&quot;
 24 #include &quot;afshaper.h&quot;
 25 
 26 #ifdef FT_CONFIG_OPTION_USE_HARFBUZZ
 27 
 28 
<span class="line-modified"> 29   /**************************************************************************</span>
<span class="line-modified"> 30    *</span>
<span class="line-modified"> 31    * The macro FT_COMPONENT is used in trace mode.  It is an implicit</span>
<span class="line-modified"> 32    * parameter of the FT_TRACE() and FT_ERROR() macros, used to print/log</span>
<span class="line-modified"> 33    * messages during execution.</span>
<span class="line-modified"> 34    */</span>
 35 #undef  FT_COMPONENT
<span class="line-modified"> 36 #define FT_COMPONENT  afshaper</span>
 37 
 38 
 39   /*
 40    * We use `sets&#39; (in the HarfBuzz sense, which comes quite near to the
 41    * usual mathematical meaning) to manage both lookups and glyph indices.
 42    *
 43    * 1. For each coverage, collect lookup IDs in a set.  Note that an
 44    *    auto-hinter `coverage&#39; is represented by one `feature&#39;, and a
 45    *    feature consists of an arbitrary number of (font specific) `lookup&#39;s
 46    *    that actually do the mapping job.  Please check the OpenType
 47    *    specification for more details on features and lookups.
 48    *
 49    * 2. Create glyph ID sets from the corresponding lookup sets.
 50    *
 51    * 3. The glyph set corresponding to AF_COVERAGE_DEFAULT is computed
 52    *    with all lookups specific to the OpenType script activated.  It
 53    *    relies on the order of AF_DEFINE_STYLE_CLASS entries so that
 54    *    special coverages (like `oldstyle figures&#39;) don&#39;t get overwritten.
 55    *
 56    */
</pre>
<hr />
<pre>
574 
575 
576   FT_Error
577   af_shaper_get_coverage( AF_FaceGlobals  globals,
578                           AF_StyleClass   style_class,
579                           FT_UShort*      gstyles,
580                           FT_Bool         default_script )
581   {
582     FT_UNUSED( globals );
583     FT_UNUSED( style_class );
584     FT_UNUSED( gstyles );
585     FT_UNUSED( default_script );
586 
587     return FT_Err_Ok;
588   }
589 
590 
591   void*
592   af_shaper_buf_create( FT_Face  face )
593   {
<span class="line-modified">594     FT_UNUSED( face );</span>





595 
<span class="line-modified">596     return NULL;</span>
597   }
598 
599 
600   void
601   af_shaper_buf_destroy( FT_Face  face,
602                          void*    buf )
603   {
<span class="line-modified">604     FT_UNUSED( face );</span>
<span class="line-modified">605     FT_UNUSED( buf );</span>


606   }
607 
608 
609   const char*
610   af_shaper_get_cluster( const char*      p,
611                          AF_StyleMetrics  metrics,
612                          void*            buf_,
613                          unsigned int*    count )
614   {
615     FT_Face    face      = metrics-&gt;globals-&gt;face;
616     FT_ULong   ch, dummy = 0;
617     FT_ULong*  buf       = (FT_ULong*)buf_;
618 
619 
620     while ( *p == &#39; &#39; )
621       p++;
622 
623     GET_UTF8_CHAR( ch, p );
624 
625     /* since we don&#39;t have an engine to handle clusters, */
</pre>
</td>
</tr>
</table>
<center><a href="afscript.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="afshaper.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>