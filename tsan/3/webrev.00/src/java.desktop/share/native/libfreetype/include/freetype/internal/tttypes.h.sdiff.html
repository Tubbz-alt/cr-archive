<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/native/libfreetype/include/freetype/internal/tttypes.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="t1types.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../t1tables.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfreetype/include/freetype/internal/tttypes.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
<span class="line-modified">   1 /***************************************************************************/</span>
<span class="line-modified">   2 /*                                                                         */</span>
<span class="line-modified">   3 /*  tttypes.h                                                              */</span>
<span class="line-modified">   4 /*                                                                         */</span>
<span class="line-modified">   5 /*    Basic SFNT/TrueType type definitions and interface (specification    */</span>
<span class="line-modified">   6 /*    only).                                                               */</span>
<span class="line-modified">   7 /*                                                                         */</span>
<span class="line-modified">   8 /*  Copyright 1996-2018 by                                                 */</span>
<span class="line-modified">   9 /*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */</span>
<span class="line-modified">  10 /*                                                                         */</span>
<span class="line-modified">  11 /*  This file is part of the FreeType project, and may only be used,       */</span>
<span class="line-modified">  12 /*  modified, and distributed under the terms of the FreeType project      */</span>
<span class="line-modified">  13 /*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<span class="line-modified">  14 /*  this file you indicate that you have read the license and              */</span>
<span class="line-modified">  15 /*  understand and accept it fully.                                        */</span>
<span class="line-modified">  16 /*                                                                         */</span>
<span class="line-modified">  17 /***************************************************************************/</span>
  18 
  19 
  20 #ifndef TTTYPES_H_
  21 #define TTTYPES_H_
  22 
  23 
  24 #include &lt;ft2build.h&gt;
  25 #include FT_TRUETYPE_TABLES_H
  26 #include FT_INTERNAL_OBJECTS_H

  27 
  28 #ifdef TT_CONFIG_OPTION_GX_VAR_SUPPORT
  29 #include FT_MULTIPLE_MASTERS_H
  30 #endif
  31 
  32 
  33 FT_BEGIN_HEADER
  34 
  35 
  36   /*************************************************************************/
  37   /*************************************************************************/
  38   /*************************************************************************/
  39   /***                                                                   ***/
  40   /***                                                                   ***/
  41   /***             REQUIRED TRUETYPE/OPENTYPE TABLES DEFINITIONS         ***/
  42   /***                                                                   ***/
  43   /***                                                                   ***/
  44   /*************************************************************************/
  45   /*************************************************************************/
  46   /*************************************************************************/
  47 
  48 
<span class="line-modified">  49   /*************************************************************************/</span>
<span class="line-modified">  50   /*                                                                       */</span>
<span class="line-modified">  51   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified">  52   /*    TTC_HeaderRec                                                      */</span>
<span class="line-modified">  53   /*                                                                       */</span>
<span class="line-modified">  54   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">  55   /*    TrueType collection header.  This table contains the offsets of    */</span>
<span class="line-modified">  56   /*    the font headers of each distinct TrueType face in the file.       */</span>
<span class="line-modified">  57   /*                                                                       */</span>
<span class="line-modified">  58   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified">  59   /*    tag     :: Must be `ttc &#39; to indicate a TrueType collection.       */</span>
<span class="line-modified">  60   /*                                                                       */</span>
<span class="line-modified">  61   /*    version :: The version number.                                     */</span>
<span class="line-modified">  62   /*                                                                       */</span>
<span class="line-modified">  63   /*    count   :: The number of faces in the collection.  The             */</span>
<span class="line-modified">  64   /*               specification says this should be an unsigned long, but */</span>
<span class="line-modified">  65   /*               we use a signed long since we need the value -1 for     */</span>
<span class="line-modified">  66   /*               specific purposes.                                      */</span>
<span class="line-modified">  67   /*                                                                       */</span>
<span class="line-modified">  68   /*    offsets :: The offsets of the font headers, one per face.          */</span>
<span class="line-modified">  69   /*                                                                       */</span>



  70   typedef struct  TTC_HeaderRec_
  71   {
  72     FT_ULong   tag;
  73     FT_Fixed   version;
  74     FT_Long    count;
  75     FT_ULong*  offsets;
  76 
  77   } TTC_HeaderRec;
  78 
  79 
<span class="line-modified">  80   /*************************************************************************/</span>
<span class="line-modified">  81   /*                                                                       */</span>
<span class="line-modified">  82   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified">  83   /*    SFNT_HeaderRec                                                     */</span>
<span class="line-modified">  84   /*                                                                       */</span>
<span class="line-modified">  85   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">  86   /*    SFNT file format header.                                           */</span>
<span class="line-modified">  87   /*                                                                       */</span>
<span class="line-modified">  88   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified">  89   /*    format_tag     :: The font format tag.                             */</span>
<span class="line-modified">  90   /*                                                                       */</span>
<span class="line-modified">  91   /*    num_tables     :: The number of tables in file.                    */</span>
<span class="line-modified">  92   /*                                                                       */</span>
<span class="line-modified">  93   /*    search_range   :: Must be `16 * (max power of 2 &lt;= num_tables)&#39;.   */</span>
<span class="line-modified">  94   /*                                                                       */</span>
<span class="line-modified">  95   /*    entry_selector :: Must be log2 of `search_range / 16&#39;.             */</span>
<span class="line-modified">  96   /*                                                                       */</span>
<span class="line-modified">  97   /*    range_shift    :: Must be `num_tables * 16 - search_range&#39;.        */</span>
<span class="line-modified">  98   /*                                                                       */</span>





  99   typedef struct  SFNT_HeaderRec_
 100   {
 101     FT_ULong   format_tag;
 102     FT_UShort  num_tables;
 103     FT_UShort  search_range;
 104     FT_UShort  entry_selector;
 105     FT_UShort  range_shift;
 106 
 107     FT_ULong   offset;  /* not in file */
 108 
 109   } SFNT_HeaderRec, *SFNT_Header;
 110 
 111 
<span class="line-modified"> 112   /*************************************************************************/</span>
<span class="line-modified"> 113   /*                                                                       */</span>
<span class="line-modified"> 114   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 115   /*    TT_TableRec                                                        */</span>
<span class="line-modified"> 116   /*                                                                       */</span>
<span class="line-modified"> 117   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 118   /*    This structure describes a given table of a TrueType font.         */</span>
<span class="line-modified"> 119   /*                                                                       */</span>
<span class="line-modified"> 120   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 121   /*    Tag      :: A four-bytes tag describing the table.                 */</span>
<span class="line-modified"> 122   /*                                                                       */</span>
<span class="line-modified"> 123   /*    CheckSum :: The table checksum.  This value can be ignored.        */</span>
<span class="line-modified"> 124   /*                                                                       */</span>
<span class="line-modified"> 125   /*    Offset   :: The offset of the table from the start of the TrueType */</span>
<span class="line-modified"> 126   /*                font in its resource.                                  */</span>
<span class="line-modified"> 127   /*                                                                       */</span>
<span class="line-modified"> 128   /*    Length   :: The table length (in bytes).                           */</span>
<span class="line-modified"> 129   /*                                                                       */</span>




 130   typedef struct  TT_TableRec_
 131   {
 132     FT_ULong  Tag;        /*        table type */
 133     FT_ULong  CheckSum;   /*    table checksum */
 134     FT_ULong  Offset;     /* table file offset */
 135     FT_ULong  Length;     /*      table length */
 136 
 137   } TT_TableRec, *TT_Table;
 138 
 139 
<span class="line-modified"> 140   /*************************************************************************/</span>
<span class="line-modified"> 141   /*                                                                       */</span>
<span class="line-modified"> 142   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 143   /*    WOFF_HeaderRec                                                     */</span>
<span class="line-modified"> 144   /*                                                                       */</span>
<span class="line-modified"> 145   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 146   /*    WOFF file format header.                                           */</span>
<span class="line-modified"> 147   /*                                                                       */</span>
<span class="line-modified"> 148   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 149   /*    See                                                                */</span>
<span class="line-modified"> 150   /*                                                                       */</span>
<span class="line-modified"> 151   /*      https://www.w3.org/TR/WOFF/#WOFFHeader                           */</span>
<span class="line-modified"> 152   /*                                                                       */</span>
<span class="line-modified"> 153   typedef struct  WOFF_HeaderRec_</span>
<span class="line-modified"> 154   {</span>
<span class="line-modified"> 155     FT_ULong   signature;</span>
<span class="line-removed"> 156     FT_ULong   flavor;</span>
<span class="line-removed"> 157     FT_ULong   length;</span>
<span class="line-removed"> 158     FT_UShort  num_tables;</span>
<span class="line-removed"> 159     FT_UShort  reserved;</span>
<span class="line-removed"> 160     FT_ULong   totalSfntSize;</span>
<span class="line-removed"> 161     FT_UShort  majorVersion;</span>
<span class="line-removed"> 162     FT_UShort  minorVersion;</span>
<span class="line-removed"> 163     FT_ULong   metaOffset;</span>
<span class="line-removed"> 164     FT_ULong   metaLength;</span>
<span class="line-removed"> 165     FT_ULong   metaOrigLength;</span>
<span class="line-removed"> 166     FT_ULong   privOffset;</span>
<span class="line-removed"> 167     FT_ULong   privLength;</span>
<span class="line-removed"> 168 </span>
<span class="line-removed"> 169   } WOFF_HeaderRec, *WOFF_Header;</span>
<span class="line-removed"> 170 </span>
<span class="line-removed"> 171 </span>
<span class="line-removed"> 172   /*************************************************************************/</span>
<span class="line-removed"> 173   /*                                                                       */</span>
<span class="line-removed"> 174   /* &lt;Struct&gt;                                                              */</span>
<span class="line-removed"> 175   /*    WOFF_TableRec                                                      */</span>
<span class="line-removed"> 176   /*                                                                       */</span>
<span class="line-removed"> 177   /* &lt;Description&gt;                                                         */</span>
<span class="line-removed"> 178   /*    This structure describes a given table of a WOFF font.             */</span>
<span class="line-removed"> 179   /*                                                                       */</span>
<span class="line-removed"> 180   /* &lt;Fields&gt;                                                              */</span>
<span class="line-removed"> 181   /*    Tag        :: A four-bytes tag describing the table.               */</span>
<span class="line-removed"> 182   /*                                                                       */</span>
<span class="line-removed"> 183   /*    Offset     :: The offset of the table from the start of the WOFF   */</span>
<span class="line-removed"> 184   /*                  font in its resource.                                */</span>
<span class="line-removed"> 185   /*                                                                       */</span>
<span class="line-removed"> 186   /*    CompLength :: Compressed table length (in bytes).                  */</span>
<span class="line-removed"> 187   /*                                                                       */</span>
<span class="line-removed"> 188   /*    OrigLength :: Uncompressed table length (in bytes).                */</span>
<span class="line-removed"> 189   /*                                                                       */</span>
<span class="line-removed"> 190   /*    CheckSum   :: The table checksum.  This value can be ignored.      */</span>
<span class="line-removed"> 191   /*                                                                       */</span>
<span class="line-removed"> 192   /*    OrigOffset :: The uncompressed table file offset.  This value gets */</span>
<span class="line-removed"> 193   /*                  computed while constructing the (uncompressed) SFNT  */</span>
<span class="line-removed"> 194   /*                  header.  It is not contained in the WOFF file.       */</span>
<span class="line-removed"> 195   /*                                                                       */</span>
<span class="line-removed"> 196   typedef struct  WOFF_TableRec_</span>
<span class="line-removed"> 197   {</span>
<span class="line-removed"> 198     FT_ULong  Tag;           /* table ID                  */</span>
<span class="line-removed"> 199     FT_ULong  Offset;        /* table file offset         */</span>
<span class="line-removed"> 200     FT_ULong  CompLength;    /* compressed table length   */</span>
<span class="line-removed"> 201     FT_ULong  OrigLength;    /* uncompressed table length */</span>
<span class="line-removed"> 202     FT_ULong  CheckSum;      /* uncompressed checksum     */</span>
<span class="line-removed"> 203 </span>
<span class="line-removed"> 204     FT_ULong  OrigOffset;    /* uncompressed table file offset */</span>
<span class="line-removed"> 205                              /* (not in the WOFF file)         */</span>
<span class="line-removed"> 206   } WOFF_TableRec, *WOFF_Table;</span>
<span class="line-removed"> 207 </span>
<span class="line-removed"> 208 </span>
<span class="line-removed"> 209   /*************************************************************************/</span>
<span class="line-removed"> 210   /*                                                                       */</span>
<span class="line-removed"> 211   /* &lt;Struct&gt;                                                              */</span>
<span class="line-removed"> 212   /*    TT_LongMetricsRec                                                  */</span>
<span class="line-removed"> 213   /*                                                                       */</span>
<span class="line-removed"> 214   /* &lt;Description&gt;                                                         */</span>
<span class="line-removed"> 215   /*    A structure modeling the long metrics of the `hmtx&#39; and `vmtx&#39;     */</span>
<span class="line-removed"> 216   /*    TrueType tables.  The values are expressed in font units.          */</span>
<span class="line-removed"> 217   /*                                                                       */</span>
<span class="line-removed"> 218   /* &lt;Fields&gt;                                                              */</span>
<span class="line-removed"> 219   /*    advance :: The advance width or height for the glyph.              */</span>
<span class="line-removed"> 220   /*                                                                       */</span>
<span class="line-removed"> 221   /*    bearing :: The left-side or top-side bearing for the glyph.        */</span>
<span class="line-removed"> 222   /*                                                                       */</span>
 223   typedef struct  TT_LongMetricsRec_
 224   {
 225     FT_UShort  advance;
 226     FT_Short   bearing;
 227 
 228   } TT_LongMetricsRec, *TT_LongMetrics;
 229 
 230 
<span class="line-modified"> 231   /*************************************************************************/</span>
<span class="line-modified"> 232   /*                                                                       */</span>
<span class="line-modified"> 233   /* &lt;Type&gt;                                                                */</span>
<span class="line-modified"> 234   /*    TT_ShortMetrics                                                    */</span>
<span class="line-modified"> 235   /*                                                                       */</span>
<span class="line-modified"> 236   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 237   /*    A simple type to model the short metrics of the `hmtx&#39; and `vmtx&#39;  */</span>
<span class="line-modified"> 238   /*    tables.                                                            */</span>
<span class="line-modified"> 239   /*                                                                       */</span>
 240   typedef FT_Short  TT_ShortMetrics;
 241 
 242 
<span class="line-modified"> 243   /*************************************************************************/</span>
<span class="line-modified"> 244   /*                                                                       */</span>
<span class="line-modified"> 245   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 246   /*    TT_NameRec                                                         */</span>
<span class="line-modified"> 247   /*                                                                       */</span>
<span class="line-modified"> 248   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 249   /*    A structure modeling TrueType name records.  Name records are used */</span>
<span class="line-modified"> 250   /*    to store important strings like family name, style name,           */</span>
<span class="line-modified"> 251   /*    copyright, etc. in _localized_ versions (i.e., language, encoding, */</span>
<span class="line-modified"> 252   /*    etc).                                                              */</span>
<span class="line-modified"> 253   /*                                                                       */</span>
<span class="line-modified"> 254   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 255   /*    platformID   :: The ID of the name&#39;s encoding platform.            */</span>
<span class="line-modified"> 256   /*                                                                       */</span>
<span class="line-modified"> 257   /*    encodingID   :: The platform-specific ID for the name&#39;s encoding.  */</span>
<span class="line-modified"> 258   /*                                                                       */</span>
<span class="line-modified"> 259   /*    languageID   :: The platform-specific ID for the name&#39;s language.  */</span>
<span class="line-modified"> 260   /*                                                                       */</span>
<span class="line-modified"> 261   /*    nameID       :: The ID specifying what kind of name this is.       */</span>
<span class="line-modified"> 262   /*                                                                       */</span>
<span class="line-modified"> 263   /*    stringLength :: The length of the string in bytes.                 */</span>
<span class="line-modified"> 264   /*                                                                       */</span>
<span class="line-modified"> 265   /*    stringOffset :: The offset to the string in the `name&#39; table.      */</span>
<span class="line-modified"> 266   /*                                                                       */</span>
<span class="line-modified"> 267   /*    string       :: A pointer to the string&#39;s bytes.  Note that these  */</span>
<span class="line-modified"> 268   /*                    are usually UTF-16 encoded characters.             */</span>
<span class="line-modified"> 269   /*                                                                       */</span>






 270   typedef struct  TT_NameRec_
 271   {
 272     FT_UShort  platformID;
 273     FT_UShort  encodingID;
 274     FT_UShort  languageID;
 275     FT_UShort  nameID;
 276     FT_UShort  stringLength;
 277     FT_ULong   stringOffset;
 278 
 279     /* this last field is not defined in the spec */
 280     /* but used by the FreeType engine            */
 281 
 282     FT_Byte*  string;
 283 
 284   } TT_NameRec, *TT_Name;
 285 
 286 
<span class="line-modified"> 287   /*************************************************************************/</span>
<span class="line-modified"> 288   /*                                                                       */</span>
<span class="line-modified"> 289   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 290   /*    TT_LangTagRec                                                      */</span>
<span class="line-modified"> 291   /*                                                                       */</span>
<span class="line-modified"> 292   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 293   /*    A structure modeling language tag records in SFNT `name&#39; tables,   */</span>
<span class="line-modified"> 294   /*    introduced in OpenType version 1.6.                                */</span>
<span class="line-modified"> 295   /*                                                                       */</span>
<span class="line-modified"> 296   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 297   /*    stringLength :: The length of the string in bytes.                 */</span>
<span class="line-modified"> 298   /*                                                                       */</span>
<span class="line-modified"> 299   /*    stringOffset :: The offset to the string in the `name&#39; table.      */</span>
<span class="line-modified"> 300   /*                                                                       */</span>
<span class="line-modified"> 301   /*    string       :: A pointer to the string&#39;s bytes.  Note that these  */</span>
<span class="line-modified"> 302   /*                    are UTF-16BE encoded characters.                   */</span>
<span class="line-modified"> 303   /*                                                                       */</span>



 304   typedef struct TT_LangTagRec_
 305   {
 306     FT_UShort  stringLength;
 307     FT_ULong   stringOffset;
 308 
 309     /* this last field is not defined in the spec */
 310     /* but used by the FreeType engine            */
 311 
 312     FT_Byte*  string;
 313 
 314   } TT_LangTagRec, *TT_LangTag;
 315 
 316 
<span class="line-modified"> 317   /*************************************************************************/</span>
<span class="line-modified"> 318   /*                                                                       */</span>
<span class="line-modified"> 319   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 320   /*    TT_NameTableRec                                                    */</span>
<span class="line-modified"> 321   /*                                                                       */</span>
<span class="line-modified"> 322   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 323   /*    A structure modeling the TrueType name table.                      */</span>
<span class="line-modified"> 324   /*                                                                       */</span>
<span class="line-modified"> 325   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 326   /*    format            :: The format of the name table.                 */</span>
<span class="line-modified"> 327   /*                                                                       */</span>
<span class="line-modified"> 328   /*    numNameRecords    :: The number of names in table.                 */</span>
<span class="line-modified"> 329   /*                                                                       */</span>
<span class="line-modified"> 330   /*    storageOffset     :: The offset of the name table in the `name&#39;    */</span>
<span class="line-modified"> 331   /*                         TrueType table.                               */</span>
<span class="line-modified"> 332   /*                                                                       */</span>
<span class="line-modified"> 333   /*    names             :: An array of name records.                     */</span>
<span class="line-modified"> 334   /*                                                                       */</span>
<span class="line-modified"> 335   /*    numLangTagRecords :: The number of language tags in table.         */</span>
<span class="line-modified"> 336   /*                                                                       */</span>
<span class="line-modified"> 337   /*    langTags          :: An array of language tag records.             */</span>
<span class="line-modified"> 338   /*                                                                       */</span>
<span class="line-modified"> 339   /*    stream            :: The file&#39;s input stream.                      */</span>
<span class="line-modified"> 340   /*                                                                       */</span>






 341   typedef struct  TT_NameTableRec_
 342   {
 343     FT_UShort       format;
 344     FT_UInt         numNameRecords;
 345     FT_UInt         storageOffset;
 346     TT_NameRec*     names;
 347     FT_UInt         numLangTagRecords;
 348     TT_LangTagRec*  langTags;
 349     FT_Stream       stream;
 350 
 351   } TT_NameTableRec, *TT_NameTable;
 352 
 353 
 354   /*************************************************************************/
 355   /*************************************************************************/
 356   /*************************************************************************/
 357   /***                                                                   ***/
 358   /***                                                                   ***/
 359   /***             OPTIONAL TRUETYPE/OPENTYPE TABLES DEFINITIONS         ***/
 360   /***                                                                   ***/
 361   /***                                                                   ***/
 362   /*************************************************************************/
 363   /*************************************************************************/
 364   /*************************************************************************/
 365 
 366 
<span class="line-modified"> 367   /*************************************************************************/</span>
<span class="line-modified"> 368   /*                                                                       */</span>
<span class="line-modified"> 369   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 370   /*    TT_GaspRangeRec                                                    */</span>
<span class="line-modified"> 371   /*                                                                       */</span>
<span class="line-modified"> 372   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 373   /*    A tiny structure used to model a gasp range according to the       */</span>
<span class="line-modified"> 374   /*    TrueType specification.                                            */</span>
<span class="line-modified"> 375   /*                                                                       */</span>
<span class="line-modified"> 376   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 377   /*    maxPPEM  :: The maximum ppem value to which `gaspFlag&#39; applies.    */</span>
<span class="line-modified"> 378   /*                                                                       */</span>
<span class="line-modified"> 379   /*    gaspFlag :: A flag describing the grid-fitting and anti-aliasing   */</span>
<span class="line-modified"> 380   /*                modes to be used.                                      */</span>
<span class="line-modified"> 381   /*                                                                       */</span>


 382   typedef struct  TT_GaspRangeRec_
 383   {
 384     FT_UShort  maxPPEM;
 385     FT_UShort  gaspFlag;
 386 
 387   } TT_GaspRangeRec, *TT_GaspRange;
 388 
 389 
 390 #define TT_GASP_GRIDFIT  0x01
 391 #define TT_GASP_DOGRAY   0x02
 392 
 393 
<span class="line-modified"> 394   /*************************************************************************/</span>
<span class="line-modified"> 395   /*                                                                       */</span>
<span class="line-modified"> 396   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 397   /*    TT_GaspRec                                                         */</span>
<span class="line-modified"> 398   /*                                                                       */</span>
<span class="line-modified"> 399   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 400   /*    A structure modeling the TrueType `gasp&#39; table used to specify     */</span>
<span class="line-modified"> 401   /*    grid-fitting and anti-aliasing behaviour.                          */</span>
<span class="line-modified"> 402   /*                                                                       */</span>
<span class="line-modified"> 403   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 404   /*    version    :: The version number.                                  */</span>
<span class="line-modified"> 405   /*                                                                       */</span>
<span class="line-modified"> 406   /*    numRanges  :: The number of gasp ranges in table.                  */</span>
<span class="line-modified"> 407   /*                                                                       */</span>
<span class="line-modified"> 408   /*    gaspRanges :: An array of gasp ranges.                             */</span>
<span class="line-modified"> 409   /*                                                                       */</span>



 410   typedef struct  TT_Gasp_
 411   {
 412     FT_UShort     version;
 413     FT_UShort     numRanges;
 414     TT_GaspRange  gaspRanges;
 415 
 416   } TT_GaspRec;
 417 
 418 
 419   /*************************************************************************/
 420   /*************************************************************************/
 421   /*************************************************************************/
 422   /***                                                                   ***/
 423   /***                                                                   ***/
 424   /***                    EMBEDDED BITMAPS SUPPORT                       ***/
 425   /***                                                                   ***/
 426   /***                                                                   ***/
 427   /*************************************************************************/
 428   /*************************************************************************/
 429   /*************************************************************************/
 430 
 431 
<span class="line-modified"> 432   /*************************************************************************/</span>
<span class="line-modified"> 433   /*                                                                       */</span>
<span class="line-modified"> 434   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 435   /*    TT_SBit_MetricsRec                                                 */</span>
<span class="line-modified"> 436   /*                                                                       */</span>
<span class="line-modified"> 437   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 438   /*    A structure used to hold the big metrics of a given glyph bitmap   */</span>
<span class="line-modified"> 439   /*    in a TrueType or OpenType font.  These are usually found in the    */</span>
<span class="line-modified"> 440   /*    `EBDT&#39; (Microsoft) or `bloc&#39; (Apple) table.                        */</span>
<span class="line-modified"> 441   /*                                                                       */</span>
<span class="line-modified"> 442   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 443   /*    height       :: The glyph height in pixels.                        */</span>
<span class="line-modified"> 444   /*                                                                       */</span>
<span class="line-modified"> 445   /*    width        :: The glyph width in pixels.                         */</span>
<span class="line-modified"> 446   /*                                                                       */</span>
<span class="line-modified"> 447   /*    horiBearingX :: The horizontal left bearing.                       */</span>
<span class="line-modified"> 448   /*                                                                       */</span>
<span class="line-modified"> 449   /*    horiBearingY :: The horizontal top bearing.                        */</span>
<span class="line-modified"> 450   /*                                                                       */</span>
<span class="line-modified"> 451   /*    horiAdvance  :: The horizontal advance.                            */</span>
<span class="line-modified"> 452   /*                                                                       */</span>
<span class="line-modified"> 453   /*    vertBearingX :: The vertical left bearing.                         */</span>
<span class="line-modified"> 454   /*                                                                       */</span>
<span class="line-modified"> 455   /*    vertBearingY :: The vertical top bearing.                          */</span>
<span class="line-modified"> 456   /*                                                                       */</span>
<span class="line-modified"> 457   /*    vertAdvance  :: The vertical advance.                              */</span>
<span class="line-modified"> 458   /*                                                                       */</span>








 459   typedef struct  TT_SBit_MetricsRec_
 460   {
 461     FT_UShort  height;
 462     FT_UShort  width;
 463 
 464     FT_Short   horiBearingX;
 465     FT_Short   horiBearingY;
 466     FT_UShort  horiAdvance;
 467 
 468     FT_Short   vertBearingX;
 469     FT_Short   vertBearingY;
 470     FT_UShort  vertAdvance;
 471 
 472   } TT_SBit_MetricsRec, *TT_SBit_Metrics;
 473 
 474 
<span class="line-modified"> 475   /*************************************************************************/</span>
<span class="line-modified"> 476   /*                                                                       */</span>
<span class="line-modified"> 477   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 478   /*    TT_SBit_SmallMetricsRec                                            */</span>
<span class="line-modified"> 479   /*                                                                       */</span>
<span class="line-modified"> 480   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 481   /*    A structure used to hold the small metrics of a given glyph bitmap */</span>
<span class="line-modified"> 482   /*    in a TrueType or OpenType font.  These are usually found in the    */</span>
<span class="line-modified"> 483   /*    `EBDT&#39; (Microsoft) or the `bdat&#39; (Apple) table.                    */</span>
<span class="line-modified"> 484   /*                                                                       */</span>
<span class="line-modified"> 485   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 486   /*    height   :: The glyph height in pixels.                            */</span>
<span class="line-modified"> 487   /*                                                                       */</span>
<span class="line-modified"> 488   /*    width    :: The glyph width in pixels.                             */</span>
<span class="line-modified"> 489   /*                                                                       */</span>
<span class="line-modified"> 490   /*    bearingX :: The left-side bearing.                                 */</span>
<span class="line-modified"> 491   /*                                                                       */</span>
<span class="line-modified"> 492   /*    bearingY :: The top-side bearing.                                  */</span>
<span class="line-modified"> 493   /*                                                                       */</span>
<span class="line-modified"> 494   /*    advance  :: The advance width or height.                           */</span>
<span class="line-modified"> 495   /*                                                                       */</span>





 496   typedef struct  TT_SBit_Small_Metrics_
 497   {
 498     FT_Byte  height;
 499     FT_Byte  width;
 500 
 501     FT_Char  bearingX;
 502     FT_Char  bearingY;
 503     FT_Byte  advance;
 504 
 505   } TT_SBit_SmallMetricsRec, *TT_SBit_SmallMetrics;
 506 
 507 
<span class="line-modified"> 508   /*************************************************************************/</span>
<span class="line-modified"> 509   /*                                                                       */</span>
<span class="line-modified"> 510   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 511   /*    TT_SBit_LineMetricsRec                                             */</span>
<span class="line-modified"> 512   /*                                                                       */</span>
<span class="line-modified"> 513   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 514   /*    A structure used to describe the text line metrics of a given      */</span>
<span class="line-modified"> 515   /*    bitmap strike, for either a horizontal or vertical layout.         */</span>
<span class="line-modified"> 516   /*                                                                       */</span>
<span class="line-modified"> 517   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 518   /*    ascender                :: The ascender in pixels.                 */</span>
<span class="line-modified"> 519   /*                                                                       */</span>
<span class="line-modified"> 520   /*    descender               :: The descender in pixels.                */</span>
<span class="line-modified"> 521   /*                                                                       */</span>
<span class="line-modified"> 522   /*    max_width               :: The maximum glyph width in pixels.      */</span>
<span class="line-modified"> 523   /*                                                                       */</span>
<span class="line-modified"> 524   /*    caret_slope_enumerator  :: Rise of the caret slope, typically set  */</span>
<span class="line-modified"> 525   /*                               to 1 for non-italic fonts.              */</span>
<span class="line-modified"> 526   /*                                                                       */</span>
<span class="line-modified"> 527   /*    caret_slope_denominator :: Rise of the caret slope, typically set  */</span>
<span class="line-modified"> 528   /*                               to 0 for non-italic fonts.              */</span>
<span class="line-modified"> 529   /*                                                                       */</span>
<span class="line-modified"> 530   /*    caret_offset            :: Offset in pixels to move the caret for  */</span>
<span class="line-modified"> 531   /*                               proper positioning.                     */</span>
<span class="line-modified"> 532   /*                                                                       */</span>
<span class="line-modified"> 533   /*    min_origin_SB           :: Minimum of horiBearingX (resp.          */</span>
<span class="line-modified"> 534   /*                               vertBearingY).                          */</span>
<span class="line-modified"> 535   /*    min_advance_SB          :: Minimum of                              */</span>
<span class="line-modified"> 536   /*                                                                       */</span>
<span class="line-modified"> 537   /*                                 horizontal advance -                  */</span>
<span class="line-modified"> 538   /*                                   ( horiBearingX + width )            */</span>
<span class="line-modified"> 539   /*                                                                       */</span>
<span class="line-modified"> 540   /*                               resp.                                   */</span>
<span class="line-modified"> 541   /*                                                                       */</span>
<span class="line-modified"> 542   /*                                 vertical advance -                    */</span>
<span class="line-modified"> 543   /*                                   ( vertBearingY + height )           */</span>
<span class="line-modified"> 544   /*                                                                       */</span>
<span class="line-modified"> 545   /*    max_before_BL           :: Maximum of horiBearingY (resp.          */</span>
<span class="line-modified"> 546   /*                               vertBearingY).                          */</span>
<span class="line-modified"> 547   /*                                                                       */</span>
<span class="line-modified"> 548   /*    min_after_BL            :: Minimum of                              */</span>
<span class="line-modified"> 549   /*                                                                       */</span>
<span class="line-modified"> 550   /*                                 horiBearingY - height                 */</span>
<span class="line-modified"> 551   /*                                                                       */</span>
<span class="line-modified"> 552   /*                               resp.                                   */</span>
<span class="line-modified"> 553   /*                                                                       */</span>
<span class="line-modified"> 554   /*                                 vertBearingX - width                  */</span>
<span class="line-modified"> 555   /*                                                                       */</span>
<span class="line-modified"> 556   /*    pads                    :: Unused (to make the size of the record  */</span>
<span class="line-modified"> 557   /*                               a multiple of 32 bits.                  */</span>
<span class="line-modified"> 558   /*                                                                       */</span>



 559   typedef struct  TT_SBit_LineMetricsRec_
 560   {
 561     FT_Char  ascender;
 562     FT_Char  descender;
 563     FT_Byte  max_width;
 564     FT_Char  caret_slope_numerator;
 565     FT_Char  caret_slope_denominator;
 566     FT_Char  caret_offset;
 567     FT_Char  min_origin_SB;
 568     FT_Char  min_advance_SB;
 569     FT_Char  max_before_BL;
 570     FT_Char  min_after_BL;
 571     FT_Char  pads[2];
 572 
 573   } TT_SBit_LineMetricsRec, *TT_SBit_LineMetrics;
 574 
 575 
<span class="line-modified"> 576   /*************************************************************************/</span>
<span class="line-modified"> 577   /*                                                                       */</span>
<span class="line-modified"> 578   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 579   /*    TT_SBit_RangeRec                                                   */</span>
<span class="line-modified"> 580   /*                                                                       */</span>
<span class="line-modified"> 581   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 582   /*    A TrueType/OpenType subIndexTable as defined in the `EBLC&#39;         */</span>
<span class="line-modified"> 583   /*    (Microsoft) or `bloc&#39; (Apple) tables.                              */</span>
<span class="line-modified"> 584   /*                                                                       */</span>
<span class="line-modified"> 585   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 586   /*    first_glyph   :: The first glyph index in the range.               */</span>
<span class="line-modified"> 587   /*                                                                       */</span>
<span class="line-modified"> 588   /*    last_glyph    :: The last glyph index in the range.                */</span>
<span class="line-modified"> 589   /*                                                                       */</span>
<span class="line-modified"> 590   /*    index_format  :: The format of index table.  Valid values are 1    */</span>
<span class="line-modified"> 591   /*                     to 5.                                             */</span>
<span class="line-modified"> 592   /*                                                                       */</span>
<span class="line-modified"> 593   /*    image_format  :: The format of `EBDT&#39; image data.                  */</span>
<span class="line-modified"> 594   /*                                                                       */</span>
<span class="line-modified"> 595   /*    image_offset  :: The offset to image data in `EBDT&#39;.               */</span>
<span class="line-modified"> 596   /*                                                                       */</span>
<span class="line-modified"> 597   /*    image_size    :: For index formats 2 and 5.  This is the size in   */</span>
<span class="line-modified"> 598   /*                     bytes of each glyph bitmap.                       */</span>
<span class="line-modified"> 599   /*                                                                       */</span>
<span class="line-modified"> 600   /*    big_metrics   :: For index formats 2 and 5.  This is the big       */</span>
<span class="line-modified"> 601   /*                     metrics for each glyph bitmap.                    */</span>
<span class="line-modified"> 602   /*                                                                       */</span>
<span class="line-modified"> 603   /*    num_glyphs    :: For index formats 4 and 5.  This is the number of */</span>
<span class="line-modified"> 604   /*                     glyphs in the code array.                         */</span>
<span class="line-modified"> 605   /*                                                                       */</span>
<span class="line-modified"> 606   /*    glyph_offsets :: For index formats 1 and 3.                        */</span>
<span class="line-modified"> 607   /*                                                                       */</span>
<span class="line-modified"> 608   /*    glyph_codes   :: For index formats 4 and 5.                        */</span>
<span class="line-modified"> 609   /*                                                                       */</span>
<span class="line-modified"> 610   /*    table_offset  :: The offset of the index table in the `EBLC&#39;       */</span>
<span class="line-modified"> 611   /*                     table.  Only used during strike loading.          */</span>
<span class="line-modified"> 612   /*                                                                       */</span>










 613   typedef struct  TT_SBit_RangeRec_
 614   {
 615     FT_UShort           first_glyph;
 616     FT_UShort           last_glyph;
 617 
 618     FT_UShort           index_format;
 619     FT_UShort           image_format;
 620     FT_ULong            image_offset;
 621 
 622     FT_ULong            image_size;
 623     TT_SBit_MetricsRec  metrics;
 624     FT_ULong            num_glyphs;
 625 
 626     FT_ULong*           glyph_offsets;
 627     FT_UShort*          glyph_codes;
 628 
 629     FT_ULong            table_offset;
 630 
 631   } TT_SBit_RangeRec, *TT_SBit_Range;
 632 
 633 
<span class="line-modified"> 634   /*************************************************************************/</span>
<span class="line-modified"> 635   /*                                                                       */</span>
<span class="line-modified"> 636   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 637   /*    TT_SBit_StrikeRec                                                  */</span>
<span class="line-modified"> 638   /*                                                                       */</span>
<span class="line-modified"> 639   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 640   /*    A structure used describe a given bitmap strike in the `EBLC&#39;      */</span>
<span class="line-modified"> 641   /*    (Microsoft) or `bloc&#39; (Apple) tables.                              */</span>
<span class="line-modified"> 642   /*                                                                       */</span>
<span class="line-modified"> 643   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 644   /*   num_index_ranges :: The number of index ranges.                     */</span>
<span class="line-modified"> 645   /*                                                                       */</span>
<span class="line-modified"> 646   /*   index_ranges     :: An array of glyph index ranges.                 */</span>
<span class="line-modified"> 647   /*                                                                       */</span>
<span class="line-modified"> 648   /*   color_ref        :: Unused.  `color_ref&#39; is put in for future       */</span>
<span class="line-modified"> 649   /*                       enhancements, but these fields are already      */</span>
<span class="line-modified"> 650   /*                       in use by other platforms (e.g. Newton).        */</span>
<span class="line-modified"> 651   /*                       For details, please see                         */</span>
<span class="line-modified"> 652   /*                                                                       */</span>
<span class="line-modified"> 653   /*                         https://developer.apple.com/fonts/TrueType-Reference-Manual/RM06/Chap6bloc.html */</span>
<span class="line-modified"> 654   /*                                                                       */</span>
<span class="line-modified"> 655   /*   hori             :: The line metrics for horizontal layouts.        */</span>
<span class="line-modified"> 656   /*                                                                       */</span>
<span class="line-modified"> 657   /*   vert             :: The line metrics for vertical layouts.          */</span>
<span class="line-modified"> 658   /*                                                                       */</span>
<span class="line-modified"> 659   /*   start_glyph      :: The lowest glyph index for this strike.         */</span>
<span class="line-modified"> 660   /*                                                                       */</span>
<span class="line-modified"> 661   /*   end_glyph        :: The highest glyph index for this strike.        */</span>
<span class="line-modified"> 662   /*                                                                       */</span>
<span class="line-modified"> 663   /*   x_ppem           :: The number of horizontal pixels per EM.         */</span>
<span class="line-modified"> 664   /*                                                                       */</span>
<span class="line-modified"> 665   /*   y_ppem           :: The number of vertical pixels per EM.           */</span>
<span class="line-modified"> 666   /*                                                                       */</span>
<span class="line-modified"> 667   /*   bit_depth        :: The bit depth.  Valid values are 1, 2, 4,       */</span>
<span class="line-modified"> 668   /*                       and 8.                                          */</span>
<span class="line-modified"> 669   /*                                                                       */</span>
<span class="line-modified"> 670   /*   flags            :: Is this a vertical or horizontal strike?  For   */</span>
<span class="line-modified"> 671   /*                       details, please see                             */</span>
<span class="line-modified"> 672   /*                                                                       */</span>
<span class="line-modified"> 673   /*                         https://developer.apple.com/fonts/TrueType-Reference-Manual/RM06/Chap6bloc.html */</span>
<span class="line-modified"> 674   /*                                                                       */</span>








 675   typedef struct  TT_SBit_StrikeRec_
 676   {
 677     FT_Int                  num_ranges;
 678     TT_SBit_Range           sbit_ranges;
 679     FT_ULong                ranges_offset;
 680 
 681     FT_ULong                color_ref;
 682 
 683     TT_SBit_LineMetricsRec  hori;
 684     TT_SBit_LineMetricsRec  vert;
 685 
 686     FT_UShort               start_glyph;
 687     FT_UShort               end_glyph;
 688 
 689     FT_Byte                 x_ppem;
 690     FT_Byte                 y_ppem;
 691 
 692     FT_Byte                 bit_depth;
 693     FT_Char                 flags;
 694 
 695   } TT_SBit_StrikeRec, *TT_SBit_Strike;
 696 
 697 
<span class="line-modified"> 698   /*************************************************************************/</span>
<span class="line-modified"> 699   /*                                                                       */</span>
<span class="line-modified"> 700   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 701   /*    TT_SBit_ComponentRec                                               */</span>
<span class="line-modified"> 702   /*                                                                       */</span>
<span class="line-modified"> 703   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 704   /*    A simple structure to describe a compound sbit element.            */</span>
<span class="line-modified"> 705   /*                                                                       */</span>
<span class="line-modified"> 706   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 707   /*    glyph_code :: The element&#39;s glyph index.                           */</span>
<span class="line-modified"> 708   /*                                                                       */</span>
<span class="line-modified"> 709   /*    x_offset   :: The element&#39;s left bearing.                          */</span>
<span class="line-modified"> 710   /*                                                                       */</span>
<span class="line-modified"> 711   /*    y_offset   :: The element&#39;s top bearing.                           */</span>
<span class="line-modified"> 712   /*                                                                       */</span>



 713   typedef struct  TT_SBit_ComponentRec_
 714   {
 715     FT_UShort  glyph_code;
 716     FT_Char    x_offset;
 717     FT_Char    y_offset;
 718 
 719   } TT_SBit_ComponentRec, *TT_SBit_Component;
 720 
 721 
<span class="line-modified"> 722   /*************************************************************************/</span>
<span class="line-modified"> 723   /*                                                                       */</span>
<span class="line-modified"> 724   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 725   /*    TT_SBit_ScaleRec                                                   */</span>
<span class="line-modified"> 726   /*                                                                       */</span>
<span class="line-modified"> 727   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 728   /*    A structure used describe a given bitmap scaling table, as defined */</span>
<span class="line-modified"> 729   /*    in the `EBSC&#39; table.                                               */</span>
<span class="line-modified"> 730   /*                                                                       */</span>
<span class="line-modified"> 731   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 732   /*    hori              :: The horizontal line metrics.                  */</span>
<span class="line-modified"> 733   /*                                                                       */</span>
<span class="line-modified"> 734   /*    vert              :: The vertical line metrics.                    */</span>
<span class="line-modified"> 735   /*                                                                       */</span>
<span class="line-modified"> 736   /*    x_ppem            :: The number of horizontal pixels per EM.       */</span>
<span class="line-modified"> 737   /*                                                                       */</span>
<span class="line-modified"> 738   /*    y_ppem            :: The number of vertical pixels per EM.         */</span>
<span class="line-modified"> 739   /*                                                                       */</span>
<span class="line-modified"> 740   /*    x_ppem_substitute :: Substitution x_ppem value.                    */</span>
<span class="line-modified"> 741   /*                                                                       */</span>
<span class="line-modified"> 742   /*    y_ppem_substitute :: Substitution y_ppem value.                    */</span>
<span class="line-modified"> 743   /*                                                                       */</span>






 744   typedef struct  TT_SBit_ScaleRec_
 745   {
 746     TT_SBit_LineMetricsRec  hori;
 747     TT_SBit_LineMetricsRec  vert;
 748 
 749     FT_Byte                 x_ppem;
 750     FT_Byte                 y_ppem;
 751 
 752     FT_Byte                 x_ppem_substitute;
 753     FT_Byte                 y_ppem_substitute;
 754 
 755   } TT_SBit_ScaleRec, *TT_SBit_Scale;
 756 
 757 
 758   /*************************************************************************/
 759   /*************************************************************************/
 760   /*************************************************************************/
 761   /***                                                                   ***/
 762   /***                                                                   ***/
 763   /***                  POSTSCRIPT GLYPH NAMES SUPPORT                   ***/
 764   /***                                                                   ***/
 765   /***                                                                   ***/
 766   /*************************************************************************/
 767   /*************************************************************************/
 768   /*************************************************************************/
 769 
 770 
<span class="line-modified"> 771   /*************************************************************************/</span>
<span class="line-modified"> 772   /*                                                                       */</span>
<span class="line-modified"> 773   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 774   /*    TT_Post_20Rec                                                      */</span>
<span class="line-modified"> 775   /*                                                                       */</span>
<span class="line-modified"> 776   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 777   /*    Postscript names sub-table, format 2.0.  Stores the PS name of     */</span>
<span class="line-modified"> 778   /*    each glyph in the font face.                                       */</span>
<span class="line-modified"> 779   /*                                                                       */</span>
<span class="line-modified"> 780   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 781   /*    num_glyphs    :: The number of named glyphs in the table.          */</span>
<span class="line-modified"> 782   /*                                                                       */</span>
<span class="line-modified"> 783   /*    num_names     :: The number of PS names stored in the table.       */</span>
<span class="line-modified"> 784   /*                                                                       */</span>
<span class="line-modified"> 785   /*    glyph_indices :: The indices of the glyphs in the names arrays.    */</span>
<span class="line-modified"> 786   /*                                                                       */</span>
<span class="line-modified"> 787   /*    glyph_names   :: The PS names not in Mac Encoding.                 */</span>
<span class="line-modified"> 788   /*                                                                       */</span>




 789   typedef struct  TT_Post_20Rec_
 790   {
 791     FT_UShort   num_glyphs;
 792     FT_UShort   num_names;
 793     FT_UShort*  glyph_indices;
 794     FT_Char**   glyph_names;
 795 
 796   } TT_Post_20Rec, *TT_Post_20;
 797 
 798 
<span class="line-modified"> 799   /*************************************************************************/</span>
<span class="line-modified"> 800   /*                                                                       */</span>
<span class="line-modified"> 801   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 802   /*    TT_Post_25Rec                                                      */</span>
<span class="line-modified"> 803   /*                                                                       */</span>
<span class="line-modified"> 804   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 805   /*    Postscript names sub-table, format 2.5.  Stores the PS name of     */</span>
<span class="line-modified"> 806   /*    each glyph in the font face.                                       */</span>
<span class="line-modified"> 807   /*                                                                       */</span>
<span class="line-modified"> 808   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 809   /*    num_glyphs :: The number of glyphs in the table.                   */</span>
<span class="line-modified"> 810   /*                                                                       */</span>
<span class="line-modified"> 811   /*    offsets    :: An array of signed offsets in a normal Mac           */</span>
<span class="line-modified"> 812   /*                  Postscript name encoding.                            */</span>
<span class="line-modified"> 813   /*                                                                       */</span>

 814   typedef struct  TT_Post_25_
 815   {
 816     FT_UShort  num_glyphs;
 817     FT_Char*   offsets;
 818 
 819   } TT_Post_25Rec, *TT_Post_25;
 820 
 821 
<span class="line-modified"> 822   /*************************************************************************/</span>
<span class="line-modified"> 823   /*                                                                       */</span>
<span class="line-modified"> 824   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 825   /*    TT_Post_NamesRec                                                   */</span>
<span class="line-modified"> 826   /*                                                                       */</span>
<span class="line-modified"> 827   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 828   /*    Postscript names table, either format 2.0 or 2.5.                  */</span>
<span class="line-modified"> 829   /*                                                                       */</span>
<span class="line-modified"> 830   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 831   /*    loaded    :: A flag to indicate whether the PS names are loaded.   */</span>
<span class="line-modified"> 832   /*                                                                       */</span>
<span class="line-modified"> 833   /*    format_20 :: The sub-table used for format 2.0.                    */</span>
<span class="line-modified"> 834   /*                                                                       */</span>
<span class="line-modified"> 835   /*    format_25 :: The sub-table used for format 2.5.                    */</span>
<span class="line-modified"> 836   /*                                                                       */</span>



 837   typedef struct  TT_Post_NamesRec_
 838   {
 839     FT_Bool  loaded;
 840 
 841     union
 842     {
 843       TT_Post_20Rec  format_20;
 844       TT_Post_25Rec  format_25;
 845 
 846     } names;
 847 
 848   } TT_Post_NamesRec, *TT_Post_Names;
 849 
 850 
 851   /*************************************************************************/
 852   /*************************************************************************/
 853   /*************************************************************************/
 854   /***                                                                   ***/
 855   /***                                                                   ***/
 856   /***                    GX VARIATION TABLE SUPPORT                     ***/
</pre>
<hr />
<pre>
 862 
 863 
 864 #ifdef TT_CONFIG_OPTION_GX_VAR_SUPPORT
 865   typedef struct GX_BlendRec_  *GX_Blend;
 866 #endif
 867 
 868   /*************************************************************************/
 869   /*************************************************************************/
 870   /*************************************************************************/
 871   /***                                                                   ***/
 872   /***                                                                   ***/
 873   /***              EMBEDDED BDF PROPERTIES TABLE SUPPORT                ***/
 874   /***                                                                   ***/
 875   /***                                                                   ***/
 876   /*************************************************************************/
 877   /*************************************************************************/
 878   /*************************************************************************/
 879 
 880   /*
 881    * These types are used to support a `BDF &#39; table that isn&#39;t part of the
<span class="line-modified"> 882    * official TrueType specification.  It is mainly used in SFNT-based</span>
<span class="line-modified"> 883    * bitmap fonts that were generated from a set of BDF fonts.</span>
 884    *
 885    * The format of the table is as follows.
 886    *
<span class="line-modified"> 887    *   USHORT   version      `BDF &#39; table version number, should be 0x0001.</span>
<span class="line-modified"> 888    *   USHORT   strikeCount  Number of strikes (bitmap sizes) in this table.</span>
<span class="line-modified"> 889    *   ULONG    stringTable  Offset (from start of BDF table) to string</span>
 890    *                         table.
 891    *
 892    * This is followed by an array of `strikeCount&#39; descriptors, having the
 893    * following format.
 894    *
<span class="line-modified"> 895    *   USHORT   ppem         Vertical pixels per EM for this strike.</span>
<span class="line-modified"> 896    *   USHORT   numItems     Number of items for this strike (properties and</span>
 897    *                         atoms).  Maximum is 255.
 898    *
<span class="line-modified"> 899    * This array in turn is followed by `strikeCount&#39; value sets.  Each</span>
<span class="line-modified"> 900    * `value set&#39; is an array of `numItems&#39; items with the following format.</span>
 901    *
 902    *   ULONG    item_name    Offset in string table to item name.
 903    *   USHORT   item_type    The item type.  Possible values are
 904    *                            0 =&gt; string (e.g., COMMENT)
 905    *                            1 =&gt; atom   (e.g., FONT or even SIZE)
 906    *                            2 =&gt; int32
 907    *                            3 =&gt; uint32
 908    *                         0x10 =&gt; A flag to indicate a properties.  This
 909    *                                 is ORed with the above values.
 910    *   ULONG    item_value   For strings  =&gt; Offset into string table without
 911    *                                         the corresponding double quotes.
 912    *                         For atoms    =&gt; Offset into string table.
 913    *                         For integers =&gt; Direct value.
 914    *
 915    * All strings in the string table consist of bytes and are
 916    * zero-terminated.
 917    *
 918    */
 919 
 920 #ifdef TT_CONFIG_OPTION_BDF
</pre>
<hr />
<pre>
 928     FT_UInt    num_strikes;
 929     FT_Bool    loaded;
 930 
 931   } TT_BDFRec, *TT_BDF;
 932 
 933 #endif /* TT_CONFIG_OPTION_BDF */
 934 
 935   /*************************************************************************/
 936   /*************************************************************************/
 937   /*************************************************************************/
 938   /***                                                                   ***/
 939   /***                                                                   ***/
 940   /***                  ORIGINAL TT_FACE CLASS DEFINITION                ***/
 941   /***                                                                   ***/
 942   /***                                                                   ***/
 943   /*************************************************************************/
 944   /*************************************************************************/
 945   /*************************************************************************/
 946 
 947 
<span class="line-modified"> 948   /*************************************************************************/</span>
<span class="line-modified"> 949   /*                                                                       */</span>
<span class="line-modified"> 950   /* This structure/class is defined here because it is common to the      */</span>
<span class="line-modified"> 951   /* following formats: TTF, OpenType-TT, and OpenType-CFF.                */</span>
<span class="line-modified"> 952   /*                                                                       */</span>
<span class="line-modified"> 953   /* Note, however, that the classes TT_Size and TT_GlyphSlot are not      */</span>
<span class="line-modified"> 954   /* shared between font drivers, and are thus defined in `ttobjs.h&#39;.      */</span>
<span class="line-modified"> 955   /*                                                                       */</span>
<span class="line-modified"> 956   /*************************************************************************/</span>
 957 
 958 
<span class="line-modified"> 959   /*************************************************************************/</span>
<span class="line-modified"> 960   /*                                                                       */</span>
<span class="line-modified"> 961   /* &lt;Type&gt;                                                                */</span>
<span class="line-modified"> 962   /*    TT_Face                                                            */</span>
<span class="line-modified"> 963   /*                                                                       */</span>
<span class="line-modified"> 964   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 965   /*    A handle to a TrueType face/font object.  A TT_Face encapsulates   */</span>
<span class="line-modified"> 966   /*    the resolution and scaling independent parts of a TrueType font    */</span>
<span class="line-modified"> 967   /*    resource.                                                          */</span>
<span class="line-modified"> 968   /*                                                                       */</span>
<span class="line-modified"> 969   /* &lt;Note&gt;                                                                */</span>
<span class="line-modified"> 970   /*    The TT_Face structure is also used as a `parent class&#39; for the     */</span>
<span class="line-modified"> 971   /*    OpenType-CFF class (T2_Face).                                      */</span>
<span class="line-removed"> 972   /*                                                                       */</span>
 973   typedef struct TT_FaceRec_*  TT_Face;
 974 
 975 
 976   /* a function type used for the truetype bytecode interpreter hooks */
 977   typedef FT_Error
 978   (*TT_Interpreter)( void*  exec_context );
 979 
 980   /* forward declaration */
 981   typedef struct TT_LoaderRec_*  TT_Loader;
 982 
 983 
<span class="line-modified"> 984   /*************************************************************************/</span>
<span class="line-modified"> 985   /*                                                                       */</span>
<span class="line-modified"> 986   /* &lt;FuncType&gt;                                                            */</span>
<span class="line-modified"> 987   /*    TT_Loader_GotoTableFunc                                            */</span>
<span class="line-modified"> 988   /*                                                                       */</span>
<span class="line-modified"> 989   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 990   /*    Seeks a stream to the start of a given TrueType table.             */</span>
<span class="line-modified"> 991   /*                                                                       */</span>
<span class="line-modified"> 992   /* &lt;Input&gt;                                                               */</span>
<span class="line-modified"> 993   /*    face   :: A handle to the target face object.                      */</span>
<span class="line-modified"> 994   /*                                                                       */</span>
<span class="line-modified"> 995   /*    tag    :: A 4-byte tag used to name the table.                     */</span>
<span class="line-modified"> 996   /*                                                                       */</span>
<span class="line-modified"> 997   /*    stream :: The input stream.                                        */</span>
<span class="line-modified"> 998   /*                                                                       */</span>
<span class="line-modified"> 999   /* &lt;Output&gt;                                                              */</span>
<span class="line-modified">1000   /*    length :: The length of the table in bytes.  Set to 0 if not       */</span>
<span class="line-modified">1001   /*              needed.                                                  */</span>
<span class="line-modified">1002   /*                                                                       */</span>
<span class="line-modified">1003   /* &lt;Return&gt;                                                              */</span>
<span class="line-modified">1004   /*    FreeType error code.  0 means success.                             */</span>
<span class="line-modified">1005   /*                                                                       */</span>
<span class="line-modified">1006   /* &lt;Note&gt;                                                                */</span>
<span class="line-modified">1007   /*    The stream cursor must be at the font file&#39;s origin.               */</span>
<span class="line-modified">1008   /*                                                                       */</span>



1009   typedef FT_Error
1010   (*TT_Loader_GotoTableFunc)( TT_Face    face,
1011                               FT_ULong   tag,
1012                               FT_Stream  stream,
1013                               FT_ULong*  length );
1014 
1015 
<span class="line-modified">1016   /*************************************************************************/</span>
<span class="line-modified">1017   /*                                                                       */</span>
<span class="line-modified">1018   /* &lt;FuncType&gt;                                                            */</span>
<span class="line-modified">1019   /*    TT_Loader_StartGlyphFunc                                           */</span>
<span class="line-modified">1020   /*                                                                       */</span>
<span class="line-modified">1021   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">1022   /*    Seeks a stream to the start of a given glyph element, and opens a  */</span>
<span class="line-modified">1023   /*    frame for it.                                                      */</span>
<span class="line-modified">1024   /*                                                                       */</span>
<span class="line-modified">1025   /* &lt;Input&gt;                                                               */</span>
<span class="line-modified">1026   /*    loader      :: The current TrueType glyph loader object.           */</span>
<span class="line-modified">1027   /*                                                                       */</span>
<span class="line-modified">1028   /*    glyph index :: The index of the glyph to access.                   */</span>
<span class="line-modified">1029   /*                                                                       */</span>
<span class="line-modified">1030   /*    offset      :: The offset of the glyph according to the            */</span>
<span class="line-modified">1031   /*                   `locations&#39; table.                                  */</span>
<span class="line-modified">1032   /*                                                                       */</span>
<span class="line-modified">1033   /*    byte_count  :: The size of the frame in bytes.                     */</span>
<span class="line-modified">1034   /*                                                                       */</span>
<span class="line-modified">1035   /* &lt;Return&gt;                                                              */</span>
<span class="line-modified">1036   /*    FreeType error code.  0 means success.                             */</span>
<span class="line-modified">1037   /*                                                                       */</span>
<span class="line-modified">1038   /* &lt;Note&gt;                                                                */</span>
<span class="line-modified">1039   /*    This function is normally equivalent to FT_STREAM_SEEK(offset)     */</span>
<span class="line-modified">1040   /*    followed by FT_FRAME_ENTER(byte_count) with the loader&#39;s stream,   */</span>
<span class="line-modified">1041   /*    but alternative formats (e.g. compressed ones) might use something */</span>
<span class="line-modified">1042   /*    different.                                                         */</span>
<span class="line-modified">1043   /*                                                                       */</span>


1044   typedef FT_Error
1045   (*TT_Loader_StartGlyphFunc)( TT_Loader  loader,
1046                                FT_UInt    glyph_index,
1047                                FT_ULong   offset,
1048                                FT_UInt    byte_count );
1049 
1050 
<span class="line-modified">1051   /*************************************************************************/</span>
<span class="line-modified">1052   /*                                                                       */</span>
<span class="line-modified">1053   /* &lt;FuncType&gt;                                                            */</span>
<span class="line-modified">1054   /*    TT_Loader_ReadGlyphFunc                                            */</span>
<span class="line-modified">1055   /*                                                                       */</span>
<span class="line-modified">1056   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">1057   /*    Reads one glyph element (its header, a simple glyph, or a          */</span>
<span class="line-modified">1058   /*    composite) from the loader&#39;s current stream frame.                 */</span>
<span class="line-modified">1059   /*                                                                       */</span>
<span class="line-modified">1060   /* &lt;Input&gt;                                                               */</span>
<span class="line-modified">1061   /*    loader :: The current TrueType glyph loader object.                */</span>
<span class="line-modified">1062   /*                                                                       */</span>
<span class="line-modified">1063   /* &lt;Return&gt;                                                              */</span>
<span class="line-modified">1064   /*    FreeType error code.  0 means success.                             */</span>
<span class="line-modified">1065   /*                                                                       */</span>

1066   typedef FT_Error
1067   (*TT_Loader_ReadGlyphFunc)( TT_Loader  loader );
1068 
1069 
<span class="line-modified">1070   /*************************************************************************/</span>
<span class="line-modified">1071   /*                                                                       */</span>
<span class="line-modified">1072   /* &lt;FuncType&gt;                                                            */</span>
<span class="line-modified">1073   /*    TT_Loader_EndGlyphFunc                                             */</span>
<span class="line-modified">1074   /*                                                                       */</span>
<span class="line-modified">1075   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">1076   /*    Closes the current loader stream frame for the glyph.              */</span>
<span class="line-modified">1077   /*                                                                       */</span>
<span class="line-modified">1078   /* &lt;Input&gt;                                                               */</span>
<span class="line-modified">1079   /*    loader :: The current TrueType glyph loader object.                */</span>
<span class="line-modified">1080   /*                                                                       */</span>

1081   typedef void
1082   (*TT_Loader_EndGlyphFunc)( TT_Loader  loader );
1083 
1084 
1085   typedef enum TT_SbitTableType_
1086   {
1087     TT_SBIT_TABLE_TYPE_NONE = 0,
1088     TT_SBIT_TABLE_TYPE_EBLC, /* `EBLC&#39; (Microsoft), */
1089                              /* `bloc&#39; (Apple)      */
1090     TT_SBIT_TABLE_TYPE_CBLC, /* `CBLC&#39; (Google)     */
1091     TT_SBIT_TABLE_TYPE_SBIX, /* `sbix&#39; (Apple)      */
1092 
1093     /* do not remove */
1094     TT_SBIT_TABLE_TYPE_MAX
1095 
1096   } TT_SbitTableType;
1097 
1098 
1099   /* OpenType 1.8 brings new tables for variation font support;  */
1100   /* to make the old MM and GX fonts still work we need to check */
</pre>
<hr />
<pre>
1107   /* actually requested.                                         */
1108 
1109   /* FVAR */
1110 #define TT_FACE_FLAG_VAR_FVAR  ( 1 &lt;&lt; 0 )
1111 
1112   /* HVAR */
1113 #define TT_FACE_FLAG_VAR_HADVANCE  ( 1 &lt;&lt; 1 )
1114 #define TT_FACE_FLAG_VAR_LSB       ( 1 &lt;&lt; 2 )
1115 #define TT_FACE_FLAG_VAR_RSB       ( 1 &lt;&lt; 3 )
1116 
1117   /* VVAR */
1118 #define TT_FACE_FLAG_VAR_VADVANCE  ( 1 &lt;&lt; 4 )
1119 #define TT_FACE_FLAG_VAR_TSB       ( 1 &lt;&lt; 5 )
1120 #define TT_FACE_FLAG_VAR_BSB       ( 1 &lt;&lt; 6 )
1121 #define TT_FACE_FLAG_VAR_VORG      ( 1 &lt;&lt; 7 )
1122 
1123   /* MVAR */
1124 #define TT_FACE_FLAG_VAR_MVAR  ( 1 &lt;&lt; 8 )
1125 
1126 
<span class="line-modified">1127   /*************************************************************************/</span>
<span class="line-modified">1128   /*                                                                       */</span>
<span class="line-modified">1129   /*                         TrueType Face Type                            */</span>
<span class="line-modified">1130   /*                                                                       */</span>
<span class="line-modified">1131   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified">1132   /*    TT_Face                                                            */</span>
<span class="line-modified">1133   /*                                                                       */</span>
<span class="line-modified">1134   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">1135   /*    The TrueType face class.  These objects model the resolution and   */</span>
<span class="line-modified">1136   /*    point-size independent data found in a TrueType font file.         */</span>
<span class="line-modified">1137   /*                                                                       */</span>
<span class="line-modified">1138   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified">1139   /*    root                 :: The base FT_Face structure, managed by the */</span>
<span class="line-modified">1140   /*                            base layer.                                */</span>
<span class="line-modified">1141   /*                                                                       */</span>
<span class="line-modified">1142   /*    ttc_header           :: The TrueType collection header, used when  */</span>
<span class="line-modified">1143   /*                            the file is a `ttc&#39; rather than a `ttf&#39;.   */</span>
<span class="line-modified">1144   /*                            For ordinary font files, the field         */</span>
<span class="line-modified">1145   /*                            `ttc_header.count&#39; is set to 0.            */</span>
<span class="line-modified">1146   /*                                                                       */</span>
<span class="line-modified">1147   /*    format_tag           :: The font format tag.                       */</span>
<span class="line-modified">1148   /*                                                                       */</span>
<span class="line-modified">1149   /*    num_tables           :: The number of TrueType tables in this font */</span>
<span class="line-modified">1150   /*                            file.                                      */</span>
<span class="line-modified">1151   /*                                                                       */</span>
<span class="line-modified">1152   /*    dir_tables           :: The directory of TrueType tables for this  */</span>
<span class="line-modified">1153   /*                            font file.                                 */</span>
<span class="line-modified">1154   /*                                                                       */</span>
<span class="line-modified">1155   /*    header               :: The font&#39;s font header (`head&#39; table).     */</span>
<span class="line-modified">1156   /*                            Read on font opening.                      */</span>
<span class="line-modified">1157   /*                                                                       */</span>
<span class="line-modified">1158   /*    horizontal           :: The font&#39;s horizontal header (`hhea&#39;       */</span>
<span class="line-modified">1159   /*                            table).  This field also contains the      */</span>
<span class="line-modified">1160   /*                            associated horizontal metrics table        */</span>
<span class="line-modified">1161   /*                            (`hmtx&#39;).                                  */</span>
<span class="line-modified">1162   /*                                                                       */</span>
<span class="line-modified">1163   /*    max_profile          :: The font&#39;s maximum profile table.  Read on */</span>
<span class="line-modified">1164   /*                            font opening.  Note that some maximum      */</span>
<span class="line-modified">1165   /*                            values cannot be taken directly from this  */</span>
<span class="line-modified">1166   /*                            table.  We thus define additional fields   */</span>
<span class="line-modified">1167   /*                            below to hold the computed maxima.         */</span>
<span class="line-modified">1168   /*                                                                       */</span>
<span class="line-modified">1169   /*    vertical_info        :: A boolean which is set when the font file  */</span>
<span class="line-modified">1170   /*                            contains vertical metrics.  If not, the    */</span>
<span class="line-modified">1171   /*                            value of the `vertical&#39; field is           */</span>
<span class="line-modified">1172   /*                            undefined.                                 */</span>
<span class="line-modified">1173   /*                                                                       */</span>
<span class="line-modified">1174   /*    vertical             :: The font&#39;s vertical header (`vhea&#39; table). */</span>
<span class="line-modified">1175   /*                            This field also contains the associated    */</span>
<span class="line-modified">1176   /*                            vertical metrics table (`vmtx&#39;), if found. */</span>
<span class="line-modified">1177   /*                            IMPORTANT: The contents of this field is   */</span>
<span class="line-modified">1178   /*                            undefined if the `vertical_info&#39; field is  */</span>
<span class="line-modified">1179   /*                            unset.                                     */</span>
<span class="line-modified">1180   /*                                                                       */</span>
<span class="line-modified">1181   /*    num_names            :: The number of name records within this     */</span>
<span class="line-modified">1182   /*                            TrueType font.                             */</span>
<span class="line-modified">1183   /*                                                                       */</span>
<span class="line-modified">1184   /*    name_table           :: The table of name records (`name&#39;).        */</span>
<span class="line-modified">1185   /*                                                                       */</span>
<span class="line-modified">1186   /*    os2                  :: The font&#39;s OS/2 table (`OS/2&#39;).            */</span>
<span class="line-modified">1187   /*                                                                       */</span>
<span class="line-modified">1188   /*    postscript           :: The font&#39;s PostScript table (`post&#39;        */</span>
<span class="line-modified">1189   /*                            table).  The PostScript glyph names are    */</span>
<span class="line-modified">1190   /*                            not loaded by the driver on face opening.  */</span>
<span class="line-modified">1191   /*                            See the `ttpost&#39; module for more details.  */</span>
<span class="line-modified">1192   /*                                                                       */</span>
<span class="line-modified">1193   /*    cmap_table           :: Address of the face&#39;s `cmap&#39; SFNT table    */</span>
<span class="line-modified">1194   /*                            in memory (it&#39;s an extracted frame).       */</span>
<span class="line-modified">1195   /*                                                                       */</span>
<span class="line-modified">1196   /*    cmap_size            :: The size in bytes of the `cmap_table&#39;      */</span>
<span class="line-modified">1197   /*                            described above.                           */</span>
<span class="line-modified">1198   /*                                                                       */</span>
<span class="line-modified">1199   /*    goto_table           :: A function called by each TrueType table   */</span>
<span class="line-modified">1200   /*                            loader to position a stream&#39;s cursor to    */</span>
<span class="line-modified">1201   /*                            the start of a given table according to    */</span>
<span class="line-modified">1202   /*                            its tag.  It defaults to TT_Goto_Face but  */</span>
<span class="line-modified">1203   /*                            can be different for strange formats (e.g. */</span>
<span class="line-modified">1204   /*                            Type 42).                                  */</span>
<span class="line-modified">1205   /*                                                                       */</span>
<span class="line-modified">1206   /*    access_glyph_frame   :: A function used to access the frame of a   */</span>
<span class="line-modified">1207   /*                            given glyph within the face&#39;s font file.   */</span>
<span class="line-modified">1208   /*                                                                       */</span>
<span class="line-modified">1209   /*    forget_glyph_frame   :: A function used to forget the frame of a   */</span>
<span class="line-modified">1210   /*                            given glyph when all data has been loaded. */</span>
<span class="line-modified">1211   /*                                                                       */</span>
<span class="line-modified">1212   /*    read_glyph_header    :: A function used to read a glyph header.    */</span>
<span class="line-modified">1213   /*                            It must be called between an `access&#39; and  */</span>
<span class="line-modified">1214   /*                            `forget&#39;.                                  */</span>
<span class="line-modified">1215   /*                                                                       */</span>
<span class="line-modified">1216   /*    read_simple_glyph    :: A function used to read a simple glyph.    */</span>
<span class="line-modified">1217   /*                            It must be called after the header was     */</span>
<span class="line-modified">1218   /*                            read, and before the `forget&#39;.             */</span>
<span class="line-modified">1219   /*                                                                       */</span>
<span class="line-modified">1220   /*    read_composite_glyph :: A function used to read a composite glyph. */</span>
<span class="line-modified">1221   /*                            It must be called after the header was     */</span>
<span class="line-modified">1222   /*                            read, and before the `forget&#39;.             */</span>
<span class="line-modified">1223   /*                                                                       */</span>
<span class="line-modified">1224   /*    sfnt                 :: A pointer to the SFNT service.             */</span>
<span class="line-modified">1225   /*                                                                       */</span>
<span class="line-modified">1226   /*    psnames              :: A pointer to the PostScript names service. */</span>
<span class="line-modified">1227   /*                                                                       */</span>
<span class="line-modified">1228   /*    mm                   :: A pointer to the Multiple Masters service. */</span>
<span class="line-modified">1229   /*                                                                       */</span>
<span class="line-modified">1230   /*    var                  :: A pointer to the Metrics Variations        */</span>
<span class="line-modified">1231   /*                            service.                                   */</span>
<span class="line-modified">1232   /*                                                                       */</span>
<span class="line-modified">1233   /*    hdmx                 :: The face&#39;s horizontal device metrics       */</span>
<span class="line-modified">1234   /*                            (`hdmx&#39; table).  This table is optional in */</span>
<span class="line-modified">1235   /*                            TrueType/OpenType fonts.                   */</span>
<span class="line-modified">1236   /*                                                                       */</span>
<span class="line-modified">1237   /*    gasp                 :: The grid-fitting and scaling properties    */</span>
<span class="line-modified">1238   /*                            table (`gasp&#39;).  This table is optional in */</span>
<span class="line-modified">1239   /*                            TrueType/OpenType fonts.                   */</span>
<span class="line-modified">1240   /*                                                                       */</span>
<span class="line-modified">1241   /*    pclt                 :: The `pclt&#39; SFNT table.                     */</span>
<span class="line-modified">1242   /*                                                                       */</span>
<span class="line-modified">1243   /*    num_sbit_scales      :: The number of sbit scales for this font.   */</span>
<span class="line-modified">1244   /*                                                                       */</span>
<span class="line-modified">1245   /*    sbit_scales          :: Array of sbit scales embedded in this      */</span>
<span class="line-modified">1246   /*                            font.  This table is optional in a         */</span>
<span class="line-modified">1247   /*                            TrueType/OpenType font.                    */</span>
<span class="line-modified">1248   /*                                                                       */</span>
<span class="line-modified">1249   /*    postscript_names     :: A table used to store the Postscript names */</span>
<span class="line-modified">1250   /*                            of  the glyphs for this font.  See the     */</span>
<span class="line-modified">1251   /*                            file  `ttconfig.h&#39; for comments on the     */</span>
<span class="line-modified">1252   /*                            TT_CONFIG_OPTION_POSTSCRIPT_NAMES option.  */</span>
<span class="line-modified">1253   /*                                                                       */</span>
<span class="line-modified">1254   /*    font_program_size    :: Size in bytecodes of the face&#39;s font       */</span>
<span class="line-modified">1255   /*                            program.  0 if none defined.  Ignored for  */</span>
<span class="line-modified">1256   /*                            Type 2 fonts.                              */</span>
<span class="line-modified">1257   /*                                                                       */</span>
<span class="line-modified">1258   /*    font_program         :: The face&#39;s font program (bytecode stream)  */</span>
<span class="line-modified">1259   /*                            executed at load time, also used during    */</span>
<span class="line-modified">1260   /*                            glyph rendering.  Comes from the `fpgm&#39;    */</span>
<span class="line-modified">1261   /*                            table.  Ignored for Type 2 font fonts.     */</span>
<span class="line-modified">1262   /*                                                                       */</span>
<span class="line-modified">1263   /*    cvt_program_size     :: The size in bytecodes of the face&#39;s cvt    */</span>
<span class="line-modified">1264   /*                            program.  Ignored for Type 2 fonts.        */</span>
<span class="line-modified">1265   /*                                                                       */</span>
<span class="line-modified">1266   /*    cvt_program          :: The face&#39;s cvt program (bytecode stream)   */</span>
<span class="line-modified">1267   /*                            executed each time an instance/size is     */</span>
<span class="line-modified">1268   /*                            changed/reset.  Comes from the `prep&#39;      */</span>
<span class="line-modified">1269   /*                            table.  Ignored for Type 2 fonts.          */</span>
<span class="line-modified">1270   /*                                                                       */</span>
<span class="line-modified">1271   /*    cvt_size             :: Size of the control value table (in        */</span>
<span class="line-modified">1272   /*                            entries).   Ignored for Type 2 fonts.      */</span>
<span class="line-modified">1273   /*                                                                       */</span>
<span class="line-modified">1274   /*    cvt                  :: The face&#39;s original control value table.   */</span>
<span class="line-modified">1275   /*                            Coordinates are expressed in unscaled font */</span>
<span class="line-modified">1276   /*                            units.  Comes from the `cvt &#39; table.       */</span>
<span class="line-modified">1277   /*                            Ignored for Type 2 fonts.                  */</span>
<span class="line-modified">1278   /*                                                                       */</span>
<span class="line-modified">1279   /*    interpreter          :: A pointer to the TrueType bytecode         */</span>
<span class="line-modified">1280   /*                            interpreters field is also used to hook    */</span>
<span class="line-modified">1281   /*                            the debugger in `ttdebug&#39;.                 */</span>
<span class="line-modified">1282   /*                                                                       */</span>
<span class="line-modified">1283   /*    extra                :: Reserved for third-party font drivers.     */</span>
<span class="line-modified">1284   /*                                                                       */</span>
<span class="line-modified">1285   /*    postscript_name      :: The PS name of the font.  Used by the      */</span>
<span class="line-modified">1286   /*                            postscript name service.                   */</span>
<span class="line-modified">1287   /*                                                                       */</span>
<span class="line-modified">1288   /*    glyf_len             :: The length of the `glyf&#39; table.  Needed    */</span>
<span class="line-modified">1289   /*                            for malformed `loca&#39; tables.               */</span>
<span class="line-modified">1290   /*                                                                       */</span>
<span class="line-modified">1291   /*    glyf_offset          :: The file offset of the `glyf&#39; table.       */</span>
<span class="line-modified">1292   /*                                                                       */</span>
<span class="line-modified">1293   /*    is_cff2              :: Set if the font format is CFF2.            */</span>
<span class="line-modified">1294   /*                                                                       */</span>
<span class="line-modified">1295   /*    doblend              :: A boolean which is set if the font should  */</span>
<span class="line-modified">1296   /*                            be blended (this is for GX var).           */</span>
<span class="line-modified">1297   /*                                                                       */</span>
<span class="line-modified">1298   /*    blend                :: Contains the data needed to control GX     */</span>
<span class="line-modified">1299   /*                            variation tables (rather like Multiple     */</span>
<span class="line-modified">1300   /*                            Master data).                              */</span>
<span class="line-modified">1301   /*                                                                       */</span>
<span class="line-modified">1302   /*    variation_support    :: Flags that indicate which OpenType         */</span>
<span class="line-modified">1303   /*                            functionality related to font variation    */</span>
<span class="line-modified">1304   /*                            support is present, valid, and usable.     */</span>
<span class="line-modified">1305   /*                            For example, TT_FACE_FLAG_VAR_FVAR is only */</span>
<span class="line-modified">1306   /*                            set if we have at least one design axis.   */</span>
<span class="line-modified">1307   /*                                                                       */</span>
<span class="line-modified">1308   /*    var_postscript_prefix ::                                           */</span>
<span class="line-modified">1309   /*                            The PostScript name prefix needed for      */</span>
<span class="line-modified">1310   /*                            constructing a variation font instance&#39;s   */</span>
<span class="line-modified">1311   /*                            PS name .                                  */</span>
<span class="line-modified">1312   /*                                                                       */</span>
<span class="line-modified">1313   /*    var_postscript_prefix_len ::                                       */</span>
<span class="line-modified">1314   /*                            The length of the `var_postscript_prefix&#39;  */</span>
<span class="line-modified">1315   /*                            string.                                    */</span>
<span class="line-modified">1316   /*                                                                       */</span>
<span class="line-modified">1317   /*    horz_metrics_size    :: The size of the `hmtx&#39; table.              */</span>
<span class="line-modified">1318   /*                                                                       */</span>
<span class="line-modified">1319   /*    vert_metrics_size    :: The size of the `vmtx&#39; table.              */</span>
<span class="line-modified">1320   /*                                                                       */</span>
<span class="line-modified">1321   /*    num_locations        :: The number of glyph locations in this      */</span>
<span class="line-modified">1322   /*                            TrueType file.  This should be             */</span>
<span class="line-modified">1323   /*                            identical to the number of glyphs.         */</span>
<span class="line-modified">1324   /*                            Ignored for Type 2 fonts.                  */</span>
<span class="line-modified">1325   /*                                                                       */</span>
<span class="line-modified">1326   /*    glyph_locations      :: An array of longs.  These are offsets to   */</span>
<span class="line-modified">1327   /*                            glyph data within the `glyf&#39; table.        */</span>
<span class="line-modified">1328   /*                            Ignored for Type 2 font faces.             */</span>
<span class="line-modified">1329   /*                                                                       */</span>
<span class="line-modified">1330   /*    hdmx_table           :: A pointer to the `hdmx&#39; table.             */</span>
<span class="line-modified">1331   /*                                                                       */</span>
<span class="line-modified">1332   /*    hdmx_table_size      :: The size of the `hdmx&#39; table.              */</span>
<span class="line-modified">1333   /*                                                                       */</span>
<span class="line-modified">1334   /*    hdmx_record_count    :: The number of hdmx records.                */</span>
<span class="line-modified">1335   /*                                                                       */</span>
<span class="line-modified">1336   /*    hdmx_record_size     :: The size of a single hdmx record.          */</span>
<span class="line-modified">1337   /*                                                                       */</span>
<span class="line-modified">1338   /*    hdmx_record_sizes    :: An array holding the ppem sizes available  */</span>
<span class="line-modified">1339   /*                            in the `hdmx&#39; table.                       */</span>
<span class="line-modified">1340   /*                                                                       */</span>
<span class="line-modified">1341   /*    sbit_table           :: A pointer to the font&#39;s embedded bitmap    */</span>
<span class="line-modified">1342   /*                            location table.                            */</span>
<span class="line-modified">1343   /*                                                                       */</span>
<span class="line-modified">1344   /*    sbit_table_size      :: The size of `sbit_table&#39;.                  */</span>
<span class="line-modified">1345   /*                                                                       */</span>
<span class="line-modified">1346   /*    sbit_table_type      :: The sbit table type (CBLC, sbix, etc.).    */</span>
<span class="line-modified">1347   /*                                                                       */</span>
<span class="line-modified">1348   /*    sbit_num_strikes     :: The number of sbit strikes exposed by      */</span>
<span class="line-modified">1349   /*                            FreeType&#39;s API, omitting invalid strikes.  */</span>
<span class="line-modified">1350   /*                                                                       */</span>
<span class="line-modified">1351   /*    sbit_strike_map      :: A mapping between the strike indices       */</span>
<span class="line-modified">1352   /*                            exposed by the API and the indices used in */</span>
<span class="line-modified">1353   /*                            the font&#39;s sbit table.                     */</span>
<span class="line-modified">1354   /*                                                                       */</span>
<span class="line-modified">1355   /*    kern_table           :: A pointer to the `kern&#39; table.             */</span>
<span class="line-modified">1356   /*                                                                       */</span>
<span class="line-modified">1357   /*    kern_table_size      :: The size of the `kern&#39; table.              */</span>
<span class="line-modified">1358   /*                                                                       */</span>
<span class="line-modified">1359   /*    num_kern_tables      :: The number of supported kern subtables     */</span>
<span class="line-modified">1360   /*                            (up to 32; FreeType recognizes only        */</span>
<span class="line-modified">1361   /*                            horizontal ones with format 0).            */</span>
<span class="line-modified">1362   /*                                                                       */</span>
<span class="line-modified">1363   /*    kern_avail_bits      :: The availability status of kern subtables; */</span>
<span class="line-modified">1364   /*                            if bit n is set, table n is available.     */</span>
<span class="line-modified">1365   /*                                                                       */</span>
<span class="line-modified">1366   /*    kern_order_bits      :: The sortedness status of kern subtables;   */</span>
<span class="line-modified">1367   /*                            if bit n is set, table n is sorted.        */</span>
<span class="line-modified">1368   /*                                                                       */</span>
<span class="line-modified">1369   /*    bdf                  :: Data related to an SFNT font&#39;s `bdf&#39;       */</span>
<span class="line-modified">1370   /*                            table; see `tttypes.h&#39;.                    */</span>
<span class="line-modified">1371   /*                                                                       */</span>
<span class="line-modified">1372   /*    horz_metrics_offset  :: The file offset of the `hmtx&#39; table.       */</span>
<span class="line-modified">1373   /*                                                                       */</span>
<span class="line-modified">1374   /*    vert_metrics_offset  :: The file offset of the `vmtx&#39; table.       */</span>
<span class="line-modified">1375   /*                                                                       */</span>
<span class="line-modified">1376   /*    sph_found_func_flags :: Flags identifying special bytecode         */</span>
<span class="line-modified">1377   /*                            functions (used by the v38 implementation  */</span>
<span class="line-modified">1378   /*                            of the bytecode interpreter).              */</span>
<span class="line-modified">1379   /*                                                                       */</span>
<span class="line-modified">1380   /*    sph_compatibility_mode ::                                          */</span>
<span class="line-modified">1381   /*                            This flag is set if we are in ClearType    */</span>
<span class="line-modified">1382   /*                            backward compatibility mode (used by the   */</span>
<span class="line-modified">1383   /*                            v38 implementation of the bytecode         */</span>
<span class="line-modified">1384   /*                            interpreter).                              */</span>
<span class="line-modified">1385   /*                                                                       */</span>
<span class="line-modified">1386   /*    ebdt_start           :: The file offset of the sbit data table     */</span>
<span class="line-modified">1387   /*                            (CBDT, bdat, etc.).                        */</span>
<span class="line-modified">1388   /*                                                                       */</span>
<span class="line-modified">1389   /*    ebdt_size            :: The size of the sbit data table.           */</span>
<span class="line-modified">1390   /*                                                                       */</span>

















































1391   typedef struct  TT_FaceRec_
1392   {
1393     FT_FaceRec            root;
1394 
1395     TTC_HeaderRec         ttc_header;
1396 
1397     FT_ULong              format_tag;
1398     FT_UShort             num_tables;
1399     TT_Table              dir_tables;
1400 
1401     TT_Header             header;       /* TrueType header table          */
1402     TT_HoriHeader         horizontal;   /* TrueType horizontal header     */
1403 
1404     TT_MaxProfile         max_profile;
1405 
1406     FT_Bool               vertical_info;
1407     TT_VertHeader         vertical;     /* TT Vertical header, if present */
1408 
1409     FT_UShort             num_names;    /* number of name records  */
1410     TT_NameTableRec       name_table;   /* name table              */
</pre>
<hr />
<pre>
1428     void*                 sfnt;
1429 
1430     /* a typeless pointer to the FT_Service_PsCMapsRec table used to */
1431     /* handle glyph names &lt;-&gt; unicode &amp; Mac values                   */
1432     void*                 psnames;
1433 
1434 #ifdef TT_CONFIG_OPTION_GX_VAR_SUPPORT
1435     /* a typeless pointer to the FT_Service_MultiMasters table used to */
1436     /* handle variation fonts                                          */
1437     void*                 mm;
1438 
1439     /* a typeless pointer to the FT_Service_MetricsVariationsRec table */
1440     /* used to handle the HVAR, VVAR, and MVAR OpenType tables         */
1441     void*                 var;
1442 #endif
1443 
1444     /* a typeless pointer to the PostScript Aux service */
1445     void*                 psaux;
1446 
1447 
<span class="line-modified">1448     /***********************************************************************/</span>
<span class="line-modified">1449     /*                                                                     */</span>
<span class="line-modified">1450     /* Optional TrueType/OpenType tables                                   */</span>
<span class="line-modified">1451     /*                                                                     */</span>
<span class="line-modified">1452     /***********************************************************************/</span>
1453 
1454     /* grid-fitting and scaling table */
1455     TT_GaspRec            gasp;                 /* the `gasp&#39; table */
1456 
1457     /* PCL 5 table */
1458     TT_PCLT               pclt;
1459 
1460     /* embedded bitmaps support */
1461     FT_ULong              num_sbit_scales;
1462     TT_SBit_Scale         sbit_scales;
1463 
1464     /* postscript names table */
1465     TT_Post_NamesRec      postscript_names;
1466 







1467 
<span class="line-modified">1468     /***********************************************************************/</span>
<span class="line-modified">1469     /*                                                                     */</span>
<span class="line-modified">1470     /* TrueType-specific fields (ignored by the CFF driver)                */</span>
<span class="line-modified">1471     /*                                                                     */</span>
<span class="line-modified">1472     /***********************************************************************/</span>
1473 
1474     /* the font program, if any */
1475     FT_ULong              font_program_size;
1476     FT_Byte*              font_program;
1477 
1478     /* the cvt program, if any */
1479     FT_ULong              cvt_program_size;
1480     FT_Byte*              cvt_program;
1481 
1482     /* the original, unscaled, control value table */
1483     FT_ULong              cvt_size;
<span class="line-modified">1484     FT_Short*             cvt;</span>
1485 
1486     /* A pointer to the bytecode interpreter to use.  This is also */
1487     /* used to hook the debugger for the `ttdebug&#39; utility.        */
1488     TT_Interpreter        interpreter;
1489 
1490 
<span class="line-modified">1491     /***********************************************************************/</span>
<span class="line-modified">1492     /*                                                                     */</span>
<span class="line-modified">1493     /* Other tables or fields. This is used by derivative formats like     */</span>
<span class="line-modified">1494     /* OpenType.                                                           */</span>
<span class="line-modified">1495     /*                                                                     */</span>
<span class="line-modified">1496     /***********************************************************************/</span>
1497 
1498     FT_Generic            extra;
1499 
1500     const char*           postscript_name;
1501 
1502     FT_ULong              glyf_len;
1503     FT_ULong              glyf_offset;    /* since 2.7.1 */
1504 
1505     FT_Bool               is_cff2;        /* since 2.7.1 */
1506 
1507 #ifdef TT_CONFIG_OPTION_GX_VAR_SUPPORT
1508     FT_Bool               doblend;
1509     GX_Blend              blend;
1510 
1511     FT_UInt32             variation_support;     /* since 2.7.1 */
1512 
1513     const char*           var_postscript_prefix;     /* since 2.7.2 */
1514     FT_UInt               var_postscript_prefix_len; /* since 2.7.2 */
1515 
1516 #endif
</pre>
<hr />
<pre>
1545     TT_BDFRec             bdf;
1546 #endif /* TT_CONFIG_OPTION_BDF */
1547 
1548     /* since 2.3.0 */
1549     FT_ULong              horz_metrics_offset;
1550     FT_ULong              vert_metrics_offset;
1551 
1552 #ifdef TT_SUPPORT_SUBPIXEL_HINTING_INFINALITY
1553     /* since 2.4.12 */
1554     FT_ULong              sph_found_func_flags; /* special functions found */
1555                                                 /* for this face           */
1556     FT_Bool               sph_compatibility_mode;
1557 #endif /* TT_SUPPORT_SUBPIXEL_HINTING_INFINALITY */
1558 
1559 #ifdef TT_CONFIG_OPTION_EMBEDDED_BITMAPS
1560     /* since 2.7 */
1561     FT_ULong              ebdt_start;  /* either `CBDT&#39;, `EBDT&#39;, or `bdat&#39; */
1562     FT_ULong              ebdt_size;
1563 #endif
1564 




1565   } TT_FaceRec;
1566 
1567 
<span class="line-modified">1568   /*************************************************************************/</span>
<span class="line-modified">1569   /*                                                                       */</span>
<span class="line-modified">1570   /*  &lt;Struct&gt;                                                             */</span>
<span class="line-modified">1571   /*     TT_GlyphZoneRec                                                   */</span>
<span class="line-modified">1572   /*                                                                       */</span>
<span class="line-modified">1573   /*  &lt;Description&gt;                                                        */</span>
<span class="line-modified">1574   /*     A glyph zone is used to load, scale and hint glyph outline        */</span>
<span class="line-modified">1575   /*     coordinates.                                                      */</span>
<span class="line-modified">1576   /*                                                                       */</span>
<span class="line-modified">1577   /*  &lt;Fields&gt;                                                             */</span>
<span class="line-modified">1578   /*     memory       :: A handle to the memory manager.                   */</span>
<span class="line-modified">1579   /*                                                                       */</span>
<span class="line-modified">1580   /*     max_points   :: The maximum size in points of the zone.           */</span>
<span class="line-modified">1581   /*                                                                       */</span>
<span class="line-modified">1582   /*     max_contours :: Max size in links contours of the zone.           */</span>
<span class="line-modified">1583   /*                                                                       */</span>
<span class="line-modified">1584   /*     n_points     :: The current number of points in the zone.         */</span>
<span class="line-modified">1585   /*                                                                       */</span>
<span class="line-modified">1586   /*     n_contours   :: The current number of contours in the zone.       */</span>
<span class="line-modified">1587   /*                                                                       */</span>
<span class="line-modified">1588   /*     org          :: The original glyph coordinates (font              */</span>
<span class="line-modified">1589   /*                     units/scaled).                                    */</span>
<span class="line-modified">1590   /*                                                                       */</span>
<span class="line-modified">1591   /*     cur          :: The current glyph coordinates (scaled/hinted).    */</span>
<span class="line-modified">1592   /*                                                                       */</span>
<span class="line-modified">1593   /*     tags         :: The point control tags.                           */</span>
<span class="line-modified">1594   /*                                                                       */</span>
<span class="line-modified">1595   /*     contours     :: The contours end points.                          */</span>
<span class="line-modified">1596   /*                                                                       */</span>
<span class="line-modified">1597   /*     first_point  :: Offset of the current subglyph&#39;s first point.     */</span>
<span class="line-modified">1598   /*                                                                       */</span>









1599   typedef struct  TT_GlyphZoneRec_
1600   {
1601     FT_Memory   memory;
1602     FT_UShort   max_points;
1603     FT_Short    max_contours;
1604     FT_UShort   n_points;    /* number of points in zone    */
1605     FT_Short    n_contours;  /* number of contours          */
1606 
1607     FT_Vector*  org;         /* original point coordinates  */
1608     FT_Vector*  cur;         /* current point coordinates   */
1609     FT_Vector*  orus;        /* original (unscaled) point coordinates */
1610 
1611     FT_Byte*    tags;        /* current touch flags         */
1612     FT_UShort*  contours;    /* contour end points          */
1613 
1614     FT_UShort   first_point; /* offset of first (#0) point  */
1615 
1616   } TT_GlyphZoneRec, *TT_GlyphZone;
1617 
1618 
1619   /* handle to execution context */
1620   typedef struct TT_ExecContextRec_*  TT_ExecContext;
1621 
1622 
<span class="line-modified">1623   /*************************************************************************/</span>
<span class="line-modified">1624   /*                                                                       */</span>
<span class="line-modified">1625   /* &lt;Type&gt;                                                                */</span>
<span class="line-modified">1626   /*    TT_Size                                                            */</span>
<span class="line-modified">1627   /*                                                                       */</span>
<span class="line-modified">1628   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">1629   /*    A handle to a TrueType size object.                                */</span>
<span class="line-modified">1630   /*                                                                       */</span>
1631   typedef struct TT_SizeRec_*  TT_Size;
1632 
1633 
1634   /* glyph loader structure */
1635   typedef struct  TT_LoaderRec_
1636   {
1637     TT_Face          face;
1638     TT_Size          size;
1639     FT_GlyphSlot     glyph;
1640     FT_GlyphLoader   gloader;
1641 
1642     FT_ULong         load_flags;
1643     FT_UInt          glyph_index;
1644 
1645     FT_Stream        stream;
1646     FT_Int           byte_len;
1647 
1648     FT_Short         n_contours;
1649     FT_BBox          bbox;
1650     FT_Int           left_bearing;
</pre>
</td>
<td>
<hr />
<pre>
<span class="line-modified">   1 /****************************************************************************</span>
<span class="line-modified">   2  *</span>
<span class="line-modified">   3  * tttypes.h</span>
<span class="line-modified">   4  *</span>
<span class="line-modified">   5  *   Basic SFNT/TrueType type definitions and interface (specification</span>
<span class="line-modified">   6  *   only).</span>
<span class="line-modified">   7  *</span>
<span class="line-modified">   8  * Copyright (C) 1996-2019 by</span>
<span class="line-modified">   9  * David Turner, Robert Wilhelm, and Werner Lemberg.</span>
<span class="line-modified">  10  *</span>
<span class="line-modified">  11  * This file is part of the FreeType project, and may only be used,</span>
<span class="line-modified">  12  * modified, and distributed under the terms of the FreeType project</span>
<span class="line-modified">  13  * license, LICENSE.TXT.  By continuing to use, modify, or distribute</span>
<span class="line-modified">  14  * this file you indicate that you have read the license and</span>
<span class="line-modified">  15  * understand and accept it fully.</span>
<span class="line-modified">  16  *</span>
<span class="line-modified">  17  */</span>
  18 
  19 
  20 #ifndef TTTYPES_H_
  21 #define TTTYPES_H_
  22 
  23 
  24 #include &lt;ft2build.h&gt;
  25 #include FT_TRUETYPE_TABLES_H
  26 #include FT_INTERNAL_OBJECTS_H
<span class="line-added">  27 #include FT_COLOR_H</span>
  28 
  29 #ifdef TT_CONFIG_OPTION_GX_VAR_SUPPORT
  30 #include FT_MULTIPLE_MASTERS_H
  31 #endif
  32 
  33 
  34 FT_BEGIN_HEADER
  35 
  36 
  37   /*************************************************************************/
  38   /*************************************************************************/
  39   /*************************************************************************/
  40   /***                                                                   ***/
  41   /***                                                                   ***/
  42   /***             REQUIRED TRUETYPE/OPENTYPE TABLES DEFINITIONS         ***/
  43   /***                                                                   ***/
  44   /***                                                                   ***/
  45   /*************************************************************************/
  46   /*************************************************************************/
  47   /*************************************************************************/
  48 
  49 
<span class="line-modified">  50   /**************************************************************************</span>
<span class="line-modified">  51    *</span>
<span class="line-modified">  52    * @struct:</span>
<span class="line-modified">  53    *   TTC_HeaderRec</span>
<span class="line-modified">  54    *</span>
<span class="line-modified">  55    * @description:</span>
<span class="line-modified">  56    *   TrueType collection header.  This table contains the offsets of the</span>
<span class="line-modified">  57    *   font headers of each distinct TrueType face in the file.</span>
<span class="line-modified">  58    *</span>
<span class="line-modified">  59    * @fields:</span>
<span class="line-modified">  60    *   tag ::</span>
<span class="line-modified">  61    *     Must be &#39;ttc~&#39; to indicate a TrueType collection.</span>
<span class="line-modified">  62    *</span>
<span class="line-modified">  63    *   version ::</span>
<span class="line-modified">  64    *     The version number.</span>
<span class="line-modified">  65    *</span>
<span class="line-modified">  66    *   count ::</span>
<span class="line-modified">  67    *     The number of faces in the collection.  The specification says this</span>
<span class="line-modified">  68    *     should be an unsigned long, but we use a signed long since we need</span>
<span class="line-modified">  69    *     the value -1 for specific purposes.</span>
<span class="line-modified">  70    *</span>
<span class="line-added">  71    *   offsets ::</span>
<span class="line-added">  72    *     The offsets of the font headers, one per face.</span>
<span class="line-added">  73    */</span>
  74   typedef struct  TTC_HeaderRec_
  75   {
  76     FT_ULong   tag;
  77     FT_Fixed   version;
  78     FT_Long    count;
  79     FT_ULong*  offsets;
  80 
  81   } TTC_HeaderRec;
  82 
  83 
<span class="line-modified">  84   /**************************************************************************</span>
<span class="line-modified">  85    *</span>
<span class="line-modified">  86    * @struct:</span>
<span class="line-modified">  87    *   SFNT_HeaderRec</span>
<span class="line-modified">  88    *</span>
<span class="line-modified">  89    * @description:</span>
<span class="line-modified">  90    *   SFNT file format header.</span>
<span class="line-modified">  91    *</span>
<span class="line-modified">  92    * @fields:</span>
<span class="line-modified">  93    *   format_tag ::</span>
<span class="line-modified">  94    *     The font format tag.</span>
<span class="line-modified">  95    *</span>
<span class="line-modified">  96    *   num_tables ::</span>
<span class="line-modified">  97    *     The number of tables in file.</span>
<span class="line-modified">  98    *</span>
<span class="line-modified">  99    *   search_range ::</span>
<span class="line-modified"> 100    *     Must be &#39;16 * (max power of 2 &lt;= num_tables)&#39;.</span>
<span class="line-modified"> 101    *</span>
<span class="line-modified"> 102    *   entry_selector ::</span>
<span class="line-added"> 103    *     Must be log2 of &#39;search_range / 16&#39;.</span>
<span class="line-added"> 104    *</span>
<span class="line-added"> 105    *   range_shift ::</span>
<span class="line-added"> 106    *     Must be &#39;num_tables * 16 - search_range&#39;.</span>
<span class="line-added"> 107    */</span>
 108   typedef struct  SFNT_HeaderRec_
 109   {
 110     FT_ULong   format_tag;
 111     FT_UShort  num_tables;
 112     FT_UShort  search_range;
 113     FT_UShort  entry_selector;
 114     FT_UShort  range_shift;
 115 
 116     FT_ULong   offset;  /* not in file */
 117 
 118   } SFNT_HeaderRec, *SFNT_Header;
 119 
 120 
<span class="line-modified"> 121   /**************************************************************************</span>
<span class="line-modified"> 122    *</span>
<span class="line-modified"> 123    * @struct:</span>
<span class="line-modified"> 124    *   TT_TableRec</span>
<span class="line-modified"> 125    *</span>
<span class="line-modified"> 126    * @description:</span>
<span class="line-modified"> 127    *   This structure describes a given table of a TrueType font.</span>
<span class="line-modified"> 128    *</span>
<span class="line-modified"> 129    * @fields:</span>
<span class="line-modified"> 130    *   Tag ::</span>
<span class="line-modified"> 131    *     A four-bytes tag describing the table.</span>
<span class="line-modified"> 132    *</span>
<span class="line-modified"> 133    *   CheckSum ::</span>
<span class="line-modified"> 134    *     The table checksum.  This value can be ignored.</span>
<span class="line-modified"> 135    *</span>
<span class="line-modified"> 136    *   Offset ::</span>
<span class="line-modified"> 137    *     The offset of the table from the start of the TrueType font in its</span>
<span class="line-modified"> 138    *     resource.</span>
<span class="line-added"> 139    *</span>
<span class="line-added"> 140    *   Length ::</span>
<span class="line-added"> 141    *     The table length (in bytes).</span>
<span class="line-added"> 142    */</span>
 143   typedef struct  TT_TableRec_
 144   {
 145     FT_ULong  Tag;        /*        table type */
 146     FT_ULong  CheckSum;   /*    table checksum */
 147     FT_ULong  Offset;     /* table file offset */
 148     FT_ULong  Length;     /*      table length */
 149 
 150   } TT_TableRec, *TT_Table;
 151 
 152 
<span class="line-modified"> 153   /**************************************************************************</span>
<span class="line-modified"> 154    *</span>
<span class="line-modified"> 155    * @struct:</span>
<span class="line-modified"> 156    *   TT_LongMetricsRec</span>
<span class="line-modified"> 157    *</span>
<span class="line-modified"> 158    * @description:</span>
<span class="line-modified"> 159    *   A structure modeling the long metrics of the &#39;hmtx&#39; and &#39;vmtx&#39;</span>
<span class="line-modified"> 160    *   TrueType tables.  The values are expressed in font units.</span>
<span class="line-modified"> 161    *</span>
<span class="line-modified"> 162    * @fields:</span>
<span class="line-modified"> 163    *   advance ::</span>
<span class="line-modified"> 164    *     The advance width or height for the glyph.</span>
<span class="line-modified"> 165    *</span>
<span class="line-modified"> 166    *   bearing ::</span>
<span class="line-modified"> 167    *     The left-side or top-side bearing for the glyph.</span>
<span class="line-modified"> 168    */</span>



































































 169   typedef struct  TT_LongMetricsRec_
 170   {
 171     FT_UShort  advance;
 172     FT_Short   bearing;
 173 
 174   } TT_LongMetricsRec, *TT_LongMetrics;
 175 
 176 
<span class="line-modified"> 177   /**************************************************************************</span>
<span class="line-modified"> 178    *</span>
<span class="line-modified"> 179    * @type:</span>
<span class="line-modified"> 180    *   TT_ShortMetrics</span>
<span class="line-modified"> 181    *</span>
<span class="line-modified"> 182    * @description:</span>
<span class="line-modified"> 183    *   A simple type to model the short metrics of the &#39;hmtx&#39; and &#39;vmtx&#39;</span>
<span class="line-modified"> 184    *   tables.</span>
<span class="line-modified"> 185    */</span>
 186   typedef FT_Short  TT_ShortMetrics;
 187 
 188 
<span class="line-modified"> 189   /**************************************************************************</span>
<span class="line-modified"> 190    *</span>
<span class="line-modified"> 191    * @struct:</span>
<span class="line-modified"> 192    *   TT_NameRec</span>
<span class="line-modified"> 193    *</span>
<span class="line-modified"> 194    * @description:</span>
<span class="line-modified"> 195    *   A structure modeling TrueType name records.  Name records are used to</span>
<span class="line-modified"> 196    *   store important strings like family name, style name, copyright,</span>
<span class="line-modified"> 197    *   etc. in _localized_ versions (i.e., language, encoding, etc).</span>
<span class="line-modified"> 198    *</span>
<span class="line-modified"> 199    * @fields:</span>
<span class="line-modified"> 200    *   platformID ::</span>
<span class="line-modified"> 201    *     The ID of the name&#39;s encoding platform.</span>
<span class="line-modified"> 202    *</span>
<span class="line-modified"> 203    *   encodingID ::</span>
<span class="line-modified"> 204    *     The platform-specific ID for the name&#39;s encoding.</span>
<span class="line-modified"> 205    *</span>
<span class="line-modified"> 206    *   languageID ::</span>
<span class="line-modified"> 207    *     The platform-specific ID for the name&#39;s language.</span>
<span class="line-modified"> 208    *</span>
<span class="line-modified"> 209    *   nameID ::</span>
<span class="line-modified"> 210    *     The ID specifying what kind of name this is.</span>
<span class="line-modified"> 211    *</span>
<span class="line-modified"> 212    *   stringLength ::</span>
<span class="line-modified"> 213    *     The length of the string in bytes.</span>
<span class="line-modified"> 214    *</span>
<span class="line-modified"> 215    *   stringOffset ::</span>
<span class="line-added"> 216    *     The offset to the string in the &#39;name&#39; table.</span>
<span class="line-added"> 217    *</span>
<span class="line-added"> 218    *   string ::</span>
<span class="line-added"> 219    *     A pointer to the string&#39;s bytes.  Note that these are usually UTF-16</span>
<span class="line-added"> 220    *     encoded characters.</span>
<span class="line-added"> 221    */</span>
 222   typedef struct  TT_NameRec_
 223   {
 224     FT_UShort  platformID;
 225     FT_UShort  encodingID;
 226     FT_UShort  languageID;
 227     FT_UShort  nameID;
 228     FT_UShort  stringLength;
 229     FT_ULong   stringOffset;
 230 
 231     /* this last field is not defined in the spec */
 232     /* but used by the FreeType engine            */
 233 
 234     FT_Byte*  string;
 235 
 236   } TT_NameRec, *TT_Name;
 237 
 238 
<span class="line-modified"> 239   /**************************************************************************</span>
<span class="line-modified"> 240    *</span>
<span class="line-modified"> 241    * @struct:</span>
<span class="line-modified"> 242    *   TT_LangTagRec</span>
<span class="line-modified"> 243    *</span>
<span class="line-modified"> 244    * @description:</span>
<span class="line-modified"> 245    *   A structure modeling language tag records in SFNT &#39;name&#39; tables,</span>
<span class="line-modified"> 246    *   introduced in OpenType version 1.6.</span>
<span class="line-modified"> 247    *</span>
<span class="line-modified"> 248    * @fields:</span>
<span class="line-modified"> 249    *   stringLength ::</span>
<span class="line-modified"> 250    *     The length of the string in bytes.</span>
<span class="line-modified"> 251    *</span>
<span class="line-modified"> 252    *   stringOffset ::</span>
<span class="line-modified"> 253    *     The offset to the string in the &#39;name&#39; table.</span>
<span class="line-modified"> 254    *</span>
<span class="line-modified"> 255    *   string ::</span>
<span class="line-added"> 256    *     A pointer to the string&#39;s bytes.  Note that these are UTF-16BE</span>
<span class="line-added"> 257    *     encoded characters.</span>
<span class="line-added"> 258    */</span>
 259   typedef struct TT_LangTagRec_
 260   {
 261     FT_UShort  stringLength;
 262     FT_ULong   stringOffset;
 263 
 264     /* this last field is not defined in the spec */
 265     /* but used by the FreeType engine            */
 266 
 267     FT_Byte*  string;
 268 
 269   } TT_LangTagRec, *TT_LangTag;
 270 
 271 
<span class="line-modified"> 272   /**************************************************************************</span>
<span class="line-modified"> 273    *</span>
<span class="line-modified"> 274    * @struct:</span>
<span class="line-modified"> 275    *   TT_NameTableRec</span>
<span class="line-modified"> 276    *</span>
<span class="line-modified"> 277    * @description:</span>
<span class="line-modified"> 278    *   A structure modeling the TrueType name table.</span>
<span class="line-modified"> 279    *</span>
<span class="line-modified"> 280    * @fields:</span>
<span class="line-modified"> 281    *   format ::</span>
<span class="line-modified"> 282    *     The format of the name table.</span>
<span class="line-modified"> 283    *</span>
<span class="line-modified"> 284    *   numNameRecords ::</span>
<span class="line-modified"> 285    *     The number of names in table.</span>
<span class="line-modified"> 286    *</span>
<span class="line-modified"> 287    *   storageOffset ::</span>
<span class="line-modified"> 288    *     The offset of the name table in the &#39;name&#39; TrueType table.</span>
<span class="line-modified"> 289    *</span>
<span class="line-modified"> 290    *   names ::</span>
<span class="line-modified"> 291    *     An array of name records.</span>
<span class="line-modified"> 292    *</span>
<span class="line-modified"> 293    *   numLangTagRecords ::</span>
<span class="line-modified"> 294    *     The number of language tags in table.</span>
<span class="line-modified"> 295    *</span>
<span class="line-added"> 296    *   langTags ::</span>
<span class="line-added"> 297    *     An array of language tag records.</span>
<span class="line-added"> 298    *</span>
<span class="line-added"> 299    *   stream ::</span>
<span class="line-added"> 300    *     The file&#39;s input stream.</span>
<span class="line-added"> 301    */</span>
 302   typedef struct  TT_NameTableRec_
 303   {
 304     FT_UShort       format;
 305     FT_UInt         numNameRecords;
 306     FT_UInt         storageOffset;
 307     TT_NameRec*     names;
 308     FT_UInt         numLangTagRecords;
 309     TT_LangTagRec*  langTags;
 310     FT_Stream       stream;
 311 
 312   } TT_NameTableRec, *TT_NameTable;
 313 
 314 
 315   /*************************************************************************/
 316   /*************************************************************************/
 317   /*************************************************************************/
 318   /***                                                                   ***/
 319   /***                                                                   ***/
 320   /***             OPTIONAL TRUETYPE/OPENTYPE TABLES DEFINITIONS         ***/
 321   /***                                                                   ***/
 322   /***                                                                   ***/
 323   /*************************************************************************/
 324   /*************************************************************************/
 325   /*************************************************************************/
 326 
 327 
<span class="line-modified"> 328   /**************************************************************************</span>
<span class="line-modified"> 329    *</span>
<span class="line-modified"> 330    * @struct:</span>
<span class="line-modified"> 331    *   TT_GaspRangeRec</span>
<span class="line-modified"> 332    *</span>
<span class="line-modified"> 333    * @description:</span>
<span class="line-modified"> 334    *   A tiny structure used to model a gasp range according to the TrueType</span>
<span class="line-modified"> 335    *   specification.</span>
<span class="line-modified"> 336    *</span>
<span class="line-modified"> 337    * @fields:</span>
<span class="line-modified"> 338    *   maxPPEM ::</span>
<span class="line-modified"> 339    *     The maximum ppem value to which `gaspFlag` applies.</span>
<span class="line-modified"> 340    *</span>
<span class="line-modified"> 341    *   gaspFlag ::</span>
<span class="line-modified"> 342    *     A flag describing the grid-fitting and anti-aliasing modes to be</span>
<span class="line-added"> 343    *     used.</span>
<span class="line-added"> 344    */</span>
 345   typedef struct  TT_GaspRangeRec_
 346   {
 347     FT_UShort  maxPPEM;
 348     FT_UShort  gaspFlag;
 349 
 350   } TT_GaspRangeRec, *TT_GaspRange;
 351 
 352 
 353 #define TT_GASP_GRIDFIT  0x01
 354 #define TT_GASP_DOGRAY   0x02
 355 
 356 
<span class="line-modified"> 357   /**************************************************************************</span>
<span class="line-modified"> 358    *</span>
<span class="line-modified"> 359    * @struct:</span>
<span class="line-modified"> 360    *   TT_GaspRec</span>
<span class="line-modified"> 361    *</span>
<span class="line-modified"> 362    * @description:</span>
<span class="line-modified"> 363    *   A structure modeling the TrueType &#39;gasp&#39; table used to specify</span>
<span class="line-modified"> 364    *   grid-fitting and anti-aliasing behaviour.</span>
<span class="line-modified"> 365    *</span>
<span class="line-modified"> 366    * @fields:</span>
<span class="line-modified"> 367    *   version ::</span>
<span class="line-modified"> 368    *     The version number.</span>
<span class="line-modified"> 369    *</span>
<span class="line-modified"> 370    *   numRanges ::</span>
<span class="line-modified"> 371    *     The number of gasp ranges in table.</span>
<span class="line-modified"> 372    *</span>
<span class="line-added"> 373    *   gaspRanges ::</span>
<span class="line-added"> 374    *     An array of gasp ranges.</span>
<span class="line-added"> 375    */</span>
 376   typedef struct  TT_Gasp_
 377   {
 378     FT_UShort     version;
 379     FT_UShort     numRanges;
 380     TT_GaspRange  gaspRanges;
 381 
 382   } TT_GaspRec;
 383 
 384 
 385   /*************************************************************************/
 386   /*************************************************************************/
 387   /*************************************************************************/
 388   /***                                                                   ***/
 389   /***                                                                   ***/
 390   /***                    EMBEDDED BITMAPS SUPPORT                       ***/
 391   /***                                                                   ***/
 392   /***                                                                   ***/
 393   /*************************************************************************/
 394   /*************************************************************************/
 395   /*************************************************************************/
 396 
 397 
<span class="line-modified"> 398   /**************************************************************************</span>
<span class="line-modified"> 399    *</span>
<span class="line-modified"> 400    * @struct:</span>
<span class="line-modified"> 401    *   TT_SBit_MetricsRec</span>
<span class="line-modified"> 402    *</span>
<span class="line-modified"> 403    * @description:</span>
<span class="line-modified"> 404    *   A structure used to hold the big metrics of a given glyph bitmap in a</span>
<span class="line-modified"> 405    *   TrueType or OpenType font.  These are usually found in the &#39;EBDT&#39;</span>
<span class="line-modified"> 406    *   (Microsoft) or &#39;bloc&#39; (Apple) table.</span>
<span class="line-modified"> 407    *</span>
<span class="line-modified"> 408    * @fields:</span>
<span class="line-modified"> 409    *   height ::</span>
<span class="line-modified"> 410    *     The glyph height in pixels.</span>
<span class="line-modified"> 411    *</span>
<span class="line-modified"> 412    *   width ::</span>
<span class="line-modified"> 413    *     The glyph width in pixels.</span>
<span class="line-modified"> 414    *</span>
<span class="line-modified"> 415    *   horiBearingX ::</span>
<span class="line-modified"> 416    *     The horizontal left bearing.</span>
<span class="line-modified"> 417    *</span>
<span class="line-modified"> 418    *   horiBearingY ::</span>
<span class="line-modified"> 419    *     The horizontal top bearing.</span>
<span class="line-modified"> 420    *</span>
<span class="line-modified"> 421    *   horiAdvance ::</span>
<span class="line-modified"> 422    *     The horizontal advance.</span>
<span class="line-modified"> 423    *</span>
<span class="line-modified"> 424    *   vertBearingX ::</span>
<span class="line-added"> 425    *     The vertical left bearing.</span>
<span class="line-added"> 426    *</span>
<span class="line-added"> 427    *   vertBearingY ::</span>
<span class="line-added"> 428    *     The vertical top bearing.</span>
<span class="line-added"> 429    *</span>
<span class="line-added"> 430    *   vertAdvance ::</span>
<span class="line-added"> 431    *     The vertical advance.</span>
<span class="line-added"> 432    */</span>
 433   typedef struct  TT_SBit_MetricsRec_
 434   {
 435     FT_UShort  height;
 436     FT_UShort  width;
 437 
 438     FT_Short   horiBearingX;
 439     FT_Short   horiBearingY;
 440     FT_UShort  horiAdvance;
 441 
 442     FT_Short   vertBearingX;
 443     FT_Short   vertBearingY;
 444     FT_UShort  vertAdvance;
 445 
 446   } TT_SBit_MetricsRec, *TT_SBit_Metrics;
 447 
 448 
<span class="line-modified"> 449   /**************************************************************************</span>
<span class="line-modified"> 450    *</span>
<span class="line-modified"> 451    * @struct:</span>
<span class="line-modified"> 452    *   TT_SBit_SmallMetricsRec</span>
<span class="line-modified"> 453    *</span>
<span class="line-modified"> 454    * @description:</span>
<span class="line-modified"> 455    *   A structure used to hold the small metrics of a given glyph bitmap in</span>
<span class="line-modified"> 456    *   a TrueType or OpenType font.  These are usually found in the &#39;EBDT&#39;</span>
<span class="line-modified"> 457    *   (Microsoft) or the &#39;bdat&#39; (Apple) table.</span>
<span class="line-modified"> 458    *</span>
<span class="line-modified"> 459    * @fields:</span>
<span class="line-modified"> 460    *   height ::</span>
<span class="line-modified"> 461    *     The glyph height in pixels.</span>
<span class="line-modified"> 462    *</span>
<span class="line-modified"> 463    *   width ::</span>
<span class="line-modified"> 464    *     The glyph width in pixels.</span>
<span class="line-modified"> 465    *</span>
<span class="line-modified"> 466    *   bearingX ::</span>
<span class="line-modified"> 467    *     The left-side bearing.</span>
<span class="line-modified"> 468    *</span>
<span class="line-modified"> 469    *   bearingY ::</span>
<span class="line-added"> 470    *     The top-side bearing.</span>
<span class="line-added"> 471    *</span>
<span class="line-added"> 472    *   advance ::</span>
<span class="line-added"> 473    *     The advance width or height.</span>
<span class="line-added"> 474    */</span>
 475   typedef struct  TT_SBit_Small_Metrics_
 476   {
 477     FT_Byte  height;
 478     FT_Byte  width;
 479 
 480     FT_Char  bearingX;
 481     FT_Char  bearingY;
 482     FT_Byte  advance;
 483 
 484   } TT_SBit_SmallMetricsRec, *TT_SBit_SmallMetrics;
 485 
 486 
<span class="line-modified"> 487   /**************************************************************************</span>
<span class="line-modified"> 488    *</span>
<span class="line-modified"> 489    * @struct:</span>
<span class="line-modified"> 490    *   TT_SBit_LineMetricsRec</span>
<span class="line-modified"> 491    *</span>
<span class="line-modified"> 492    * @description:</span>
<span class="line-modified"> 493    *   A structure used to describe the text line metrics of a given bitmap</span>
<span class="line-modified"> 494    *   strike, for either a horizontal or vertical layout.</span>
<span class="line-modified"> 495    *</span>
<span class="line-modified"> 496    * @fields:</span>
<span class="line-modified"> 497    *   ascender ::</span>
<span class="line-modified"> 498    *     The ascender in pixels.</span>
<span class="line-modified"> 499    *</span>
<span class="line-modified"> 500    *   descender ::</span>
<span class="line-modified"> 501    *     The descender in pixels.</span>
<span class="line-modified"> 502    *</span>
<span class="line-modified"> 503    *   max_width ::</span>
<span class="line-modified"> 504    *     The maximum glyph width in pixels.</span>
<span class="line-modified"> 505    *</span>
<span class="line-modified"> 506    *   caret_slope_enumerator ::</span>
<span class="line-modified"> 507    *     Rise of the caret slope, typically set to 1 for non-italic fonts.</span>
<span class="line-modified"> 508    *</span>
<span class="line-modified"> 509    *   caret_slope_denominator ::</span>
<span class="line-modified"> 510    *     Rise of the caret slope, typically set to 0 for non-italic fonts.</span>
<span class="line-modified"> 511    *</span>
<span class="line-modified"> 512    *   caret_offset ::</span>
<span class="line-modified"> 513    *     Offset in pixels to move the caret for proper positioning.</span>
<span class="line-modified"> 514    *</span>
<span class="line-modified"> 515    *   min_origin_SB ::</span>
<span class="line-modified"> 516    *     Minimum of horiBearingX (resp.  vertBearingY).</span>
<span class="line-modified"> 517    *   min_advance_SB ::</span>
<span class="line-modified"> 518    *     Minimum of</span>
<span class="line-modified"> 519    *</span>
<span class="line-modified"> 520    *     horizontal advance - ( horiBearingX + width )</span>
<span class="line-modified"> 521    *</span>
<span class="line-modified"> 522    *     resp.</span>
<span class="line-modified"> 523    *</span>
<span class="line-modified"> 524    *     vertical advance - ( vertBearingY + height )</span>
<span class="line-modified"> 525    *</span>
<span class="line-modified"> 526    *   max_before_BL ::</span>
<span class="line-modified"> 527    *     Maximum of horiBearingY (resp.  vertBearingY).</span>
<span class="line-modified"> 528    *</span>
<span class="line-modified"> 529    *   min_after_BL ::</span>
<span class="line-modified"> 530    *     Minimum of</span>
<span class="line-modified"> 531    *</span>
<span class="line-modified"> 532    *     horiBearingY - height</span>
<span class="line-modified"> 533    *</span>
<span class="line-modified"> 534    *     resp.</span>
<span class="line-modified"> 535    *</span>
<span class="line-modified"> 536    *     vertBearingX - width</span>
<span class="line-modified"> 537    *</span>
<span class="line-added"> 538    *   pads ::</span>
<span class="line-added"> 539    *     Unused (to make the size of the record a multiple of 32 bits.</span>
<span class="line-added"> 540    */</span>
 541   typedef struct  TT_SBit_LineMetricsRec_
 542   {
 543     FT_Char  ascender;
 544     FT_Char  descender;
 545     FT_Byte  max_width;
 546     FT_Char  caret_slope_numerator;
 547     FT_Char  caret_slope_denominator;
 548     FT_Char  caret_offset;
 549     FT_Char  min_origin_SB;
 550     FT_Char  min_advance_SB;
 551     FT_Char  max_before_BL;
 552     FT_Char  min_after_BL;
 553     FT_Char  pads[2];
 554 
 555   } TT_SBit_LineMetricsRec, *TT_SBit_LineMetrics;
 556 
 557 
<span class="line-modified"> 558   /**************************************************************************</span>
<span class="line-modified"> 559    *</span>
<span class="line-modified"> 560    * @struct:</span>
<span class="line-modified"> 561    *   TT_SBit_RangeRec</span>
<span class="line-modified"> 562    *</span>
<span class="line-modified"> 563    * @description:</span>
<span class="line-modified"> 564    *   A TrueType/OpenType subIndexTable as defined in the &#39;EBLC&#39; (Microsoft)</span>
<span class="line-modified"> 565    *   or &#39;bloc&#39; (Apple) tables.</span>
<span class="line-modified"> 566    *</span>
<span class="line-modified"> 567    * @fields:</span>
<span class="line-modified"> 568    *   first_glyph ::</span>
<span class="line-modified"> 569    *     The first glyph index in the range.</span>
<span class="line-modified"> 570    *</span>
<span class="line-modified"> 571    *   last_glyph ::</span>
<span class="line-modified"> 572    *     The last glyph index in the range.</span>
<span class="line-modified"> 573    *</span>
<span class="line-modified"> 574    *   index_format ::</span>
<span class="line-modified"> 575    *     The format of index table.  Valid values are 1 to 5.</span>
<span class="line-modified"> 576    *</span>
<span class="line-modified"> 577    *   image_format ::</span>
<span class="line-modified"> 578    *     The format of &#39;EBDT&#39; image data.</span>
<span class="line-modified"> 579    *</span>
<span class="line-modified"> 580    *   image_offset ::</span>
<span class="line-modified"> 581    *     The offset to image data in &#39;EBDT&#39;.</span>
<span class="line-modified"> 582    *</span>
<span class="line-modified"> 583    *   image_size ::</span>
<span class="line-modified"> 584    *     For index formats 2 and 5.  This is the size in bytes of each glyph</span>
<span class="line-modified"> 585    *     bitmap.</span>
<span class="line-modified"> 586    *</span>
<span class="line-modified"> 587    *   big_metrics ::</span>
<span class="line-modified"> 588    *     For index formats 2 and 5.  This is the big metrics for each glyph</span>
<span class="line-modified"> 589    *     bitmap.</span>
<span class="line-modified"> 590    *</span>
<span class="line-modified"> 591    *   num_glyphs ::</span>
<span class="line-modified"> 592    *     For index formats 4 and 5.  This is the number of glyphs in the code</span>
<span class="line-modified"> 593    *     array.</span>
<span class="line-modified"> 594    *</span>
<span class="line-added"> 595    *   glyph_offsets ::</span>
<span class="line-added"> 596    *     For index formats 1 and 3.</span>
<span class="line-added"> 597    *</span>
<span class="line-added"> 598    *   glyph_codes ::</span>
<span class="line-added"> 599    *     For index formats 4 and 5.</span>
<span class="line-added"> 600    *</span>
<span class="line-added"> 601    *   table_offset ::</span>
<span class="line-added"> 602    *     The offset of the index table in the &#39;EBLC&#39; table.  Only used during</span>
<span class="line-added"> 603    *     strike loading.</span>
<span class="line-added"> 604    */</span>
 605   typedef struct  TT_SBit_RangeRec_
 606   {
 607     FT_UShort           first_glyph;
 608     FT_UShort           last_glyph;
 609 
 610     FT_UShort           index_format;
 611     FT_UShort           image_format;
 612     FT_ULong            image_offset;
 613 
 614     FT_ULong            image_size;
 615     TT_SBit_MetricsRec  metrics;
 616     FT_ULong            num_glyphs;
 617 
 618     FT_ULong*           glyph_offsets;
 619     FT_UShort*          glyph_codes;
 620 
 621     FT_ULong            table_offset;
 622 
 623   } TT_SBit_RangeRec, *TT_SBit_Range;
 624 
 625 
<span class="line-modified"> 626   /**************************************************************************</span>
<span class="line-modified"> 627    *</span>
<span class="line-modified"> 628    * @struct:</span>
<span class="line-modified"> 629    *   TT_SBit_StrikeRec</span>
<span class="line-modified"> 630    *</span>
<span class="line-modified"> 631    * @description:</span>
<span class="line-modified"> 632    *   A structure used describe a given bitmap strike in the &#39;EBLC&#39;</span>
<span class="line-modified"> 633    *   (Microsoft) or &#39;bloc&#39; (Apple) tables.</span>
<span class="line-modified"> 634    *</span>
<span class="line-modified"> 635    * @fields:</span>
<span class="line-modified"> 636    *  num_index_ranges ::</span>
<span class="line-modified"> 637    *    The number of index ranges.</span>
<span class="line-modified"> 638    *</span>
<span class="line-modified"> 639    *  index_ranges ::</span>
<span class="line-modified"> 640    *    An array of glyph index ranges.</span>
<span class="line-modified"> 641    *</span>
<span class="line-modified"> 642    *  color_ref ::</span>
<span class="line-modified"> 643    *    Unused.  `color_ref` is put in for future enhancements, but these</span>
<span class="line-modified"> 644    *    fields are already in use by other platforms (e.g. Newton).  For</span>
<span class="line-modified"> 645    *    details, please see</span>
<span class="line-modified"> 646    *</span>
<span class="line-modified"> 647    *    https://developer.apple.com/fonts/TrueType-Reference-Manual/RM06/Chap6bloc.html</span>
<span class="line-modified"> 648    *</span>
<span class="line-modified"> 649    *  hori ::</span>
<span class="line-modified"> 650    *    The line metrics for horizontal layouts.</span>
<span class="line-modified"> 651    *</span>
<span class="line-modified"> 652    *  vert ::</span>
<span class="line-modified"> 653    *    The line metrics for vertical layouts.</span>
<span class="line-modified"> 654    *</span>
<span class="line-modified"> 655    *  start_glyph ::</span>
<span class="line-modified"> 656    *    The lowest glyph index for this strike.</span>
<span class="line-modified"> 657    *</span>
<span class="line-modified"> 658    *  end_glyph ::</span>
<span class="line-modified"> 659    *    The highest glyph index for this strike.</span>
<span class="line-modified"> 660    *</span>
<span class="line-modified"> 661    *  x_ppem ::</span>
<span class="line-modified"> 662    *    The number of horizontal pixels per EM.</span>
<span class="line-modified"> 663    *</span>
<span class="line-modified"> 664    *  y_ppem ::</span>
<span class="line-modified"> 665    *    The number of vertical pixels per EM.</span>
<span class="line-modified"> 666    *</span>
<span class="line-added"> 667    *  bit_depth ::</span>
<span class="line-added"> 668    *    The bit depth.  Valid values are 1, 2, 4, and 8.</span>
<span class="line-added"> 669    *</span>
<span class="line-added"> 670    *  flags ::</span>
<span class="line-added"> 671    *    Is this a vertical or horizontal strike?  For details, please see</span>
<span class="line-added"> 672    *</span>
<span class="line-added"> 673    *    https://developer.apple.com/fonts/TrueType-Reference-Manual/RM06/Chap6bloc.html</span>
<span class="line-added"> 674    */</span>
 675   typedef struct  TT_SBit_StrikeRec_
 676   {
 677     FT_Int                  num_ranges;
 678     TT_SBit_Range           sbit_ranges;
 679     FT_ULong                ranges_offset;
 680 
 681     FT_ULong                color_ref;
 682 
 683     TT_SBit_LineMetricsRec  hori;
 684     TT_SBit_LineMetricsRec  vert;
 685 
 686     FT_UShort               start_glyph;
 687     FT_UShort               end_glyph;
 688 
 689     FT_Byte                 x_ppem;
 690     FT_Byte                 y_ppem;
 691 
 692     FT_Byte                 bit_depth;
 693     FT_Char                 flags;
 694 
 695   } TT_SBit_StrikeRec, *TT_SBit_Strike;
 696 
 697 
<span class="line-modified"> 698   /**************************************************************************</span>
<span class="line-modified"> 699    *</span>
<span class="line-modified"> 700    * @struct:</span>
<span class="line-modified"> 701    *   TT_SBit_ComponentRec</span>
<span class="line-modified"> 702    *</span>
<span class="line-modified"> 703    * @description:</span>
<span class="line-modified"> 704    *   A simple structure to describe a compound sbit element.</span>
<span class="line-modified"> 705    *</span>
<span class="line-modified"> 706    * @fields:</span>
<span class="line-modified"> 707    *   glyph_code ::</span>
<span class="line-modified"> 708    *     The element&#39;s glyph index.</span>
<span class="line-modified"> 709    *</span>
<span class="line-modified"> 710    *   x_offset ::</span>
<span class="line-modified"> 711    *     The element&#39;s left bearing.</span>
<span class="line-modified"> 712    *</span>
<span class="line-added"> 713    *   y_offset ::</span>
<span class="line-added"> 714    *     The element&#39;s top bearing.</span>
<span class="line-added"> 715    */</span>
 716   typedef struct  TT_SBit_ComponentRec_
 717   {
 718     FT_UShort  glyph_code;
 719     FT_Char    x_offset;
 720     FT_Char    y_offset;
 721 
 722   } TT_SBit_ComponentRec, *TT_SBit_Component;
 723 
 724 
<span class="line-modified"> 725   /**************************************************************************</span>
<span class="line-modified"> 726    *</span>
<span class="line-modified"> 727    * @struct:</span>
<span class="line-modified"> 728    *   TT_SBit_ScaleRec</span>
<span class="line-modified"> 729    *</span>
<span class="line-modified"> 730    * @description:</span>
<span class="line-modified"> 731    *   A structure used describe a given bitmap scaling table, as defined in</span>
<span class="line-modified"> 732    *   the &#39;EBSC&#39; table.</span>
<span class="line-modified"> 733    *</span>
<span class="line-modified"> 734    * @fields:</span>
<span class="line-modified"> 735    *   hori ::</span>
<span class="line-modified"> 736    *     The horizontal line metrics.</span>
<span class="line-modified"> 737    *</span>
<span class="line-modified"> 738    *   vert ::</span>
<span class="line-modified"> 739    *     The vertical line metrics.</span>
<span class="line-modified"> 740    *</span>
<span class="line-modified"> 741    *   x_ppem ::</span>
<span class="line-modified"> 742    *     The number of horizontal pixels per EM.</span>
<span class="line-modified"> 743    *</span>
<span class="line-modified"> 744    *   y_ppem ::</span>
<span class="line-modified"> 745    *     The number of vertical pixels per EM.</span>
<span class="line-modified"> 746    *</span>
<span class="line-added"> 747    *   x_ppem_substitute ::</span>
<span class="line-added"> 748    *     Substitution x_ppem value.</span>
<span class="line-added"> 749    *</span>
<span class="line-added"> 750    *   y_ppem_substitute ::</span>
<span class="line-added"> 751    *     Substitution y_ppem value.</span>
<span class="line-added"> 752    */</span>
 753   typedef struct  TT_SBit_ScaleRec_
 754   {
 755     TT_SBit_LineMetricsRec  hori;
 756     TT_SBit_LineMetricsRec  vert;
 757 
 758     FT_Byte                 x_ppem;
 759     FT_Byte                 y_ppem;
 760 
 761     FT_Byte                 x_ppem_substitute;
 762     FT_Byte                 y_ppem_substitute;
 763 
 764   } TT_SBit_ScaleRec, *TT_SBit_Scale;
 765 
 766 
 767   /*************************************************************************/
 768   /*************************************************************************/
 769   /*************************************************************************/
 770   /***                                                                   ***/
 771   /***                                                                   ***/
 772   /***                  POSTSCRIPT GLYPH NAMES SUPPORT                   ***/
 773   /***                                                                   ***/
 774   /***                                                                   ***/
 775   /*************************************************************************/
 776   /*************************************************************************/
 777   /*************************************************************************/
 778 
 779 
<span class="line-modified"> 780   /**************************************************************************</span>
<span class="line-modified"> 781    *</span>
<span class="line-modified"> 782    * @struct:</span>
<span class="line-modified"> 783    *   TT_Post_20Rec</span>
<span class="line-modified"> 784    *</span>
<span class="line-modified"> 785    * @description:</span>
<span class="line-modified"> 786    *   Postscript names sub-table, format 2.0.  Stores the PS name of each</span>
<span class="line-modified"> 787    *   glyph in the font face.</span>
<span class="line-modified"> 788    *</span>
<span class="line-modified"> 789    * @fields:</span>
<span class="line-modified"> 790    *   num_glyphs ::</span>
<span class="line-modified"> 791    *     The number of named glyphs in the table.</span>
<span class="line-modified"> 792    *</span>
<span class="line-modified"> 793    *   num_names ::</span>
<span class="line-modified"> 794    *     The number of PS names stored in the table.</span>
<span class="line-modified"> 795    *</span>
<span class="line-modified"> 796    *   glyph_indices ::</span>
<span class="line-modified"> 797    *     The indices of the glyphs in the names arrays.</span>
<span class="line-added"> 798    *</span>
<span class="line-added"> 799    *   glyph_names ::</span>
<span class="line-added"> 800    *     The PS names not in Mac Encoding.</span>
<span class="line-added"> 801    */</span>
 802   typedef struct  TT_Post_20Rec_
 803   {
 804     FT_UShort   num_glyphs;
 805     FT_UShort   num_names;
 806     FT_UShort*  glyph_indices;
 807     FT_Char**   glyph_names;
 808 
 809   } TT_Post_20Rec, *TT_Post_20;
 810 
 811 
<span class="line-modified"> 812   /**************************************************************************</span>
<span class="line-modified"> 813    *</span>
<span class="line-modified"> 814    * @struct:</span>
<span class="line-modified"> 815    *   TT_Post_25Rec</span>
<span class="line-modified"> 816    *</span>
<span class="line-modified"> 817    * @description:</span>
<span class="line-modified"> 818    *   Postscript names sub-table, format 2.5.  Stores the PS name of each</span>
<span class="line-modified"> 819    *   glyph in the font face.</span>
<span class="line-modified"> 820    *</span>
<span class="line-modified"> 821    * @fields:</span>
<span class="line-modified"> 822    *   num_glyphs ::</span>
<span class="line-modified"> 823    *     The number of glyphs in the table.</span>
<span class="line-modified"> 824    *</span>
<span class="line-modified"> 825    *   offsets ::</span>
<span class="line-modified"> 826    *     An array of signed offsets in a normal Mac Postscript name encoding.</span>
<span class="line-added"> 827    */</span>
 828   typedef struct  TT_Post_25_
 829   {
 830     FT_UShort  num_glyphs;
 831     FT_Char*   offsets;
 832 
 833   } TT_Post_25Rec, *TT_Post_25;
 834 
 835 
<span class="line-modified"> 836   /**************************************************************************</span>
<span class="line-modified"> 837    *</span>
<span class="line-modified"> 838    * @struct:</span>
<span class="line-modified"> 839    *   TT_Post_NamesRec</span>
<span class="line-modified"> 840    *</span>
<span class="line-modified"> 841    * @description:</span>
<span class="line-modified"> 842    *   Postscript names table, either format 2.0 or 2.5.</span>
<span class="line-modified"> 843    *</span>
<span class="line-modified"> 844    * @fields:</span>
<span class="line-modified"> 845    *   loaded ::</span>
<span class="line-modified"> 846    *     A flag to indicate whether the PS names are loaded.</span>
<span class="line-modified"> 847    *</span>
<span class="line-modified"> 848    *   format_20 ::</span>
<span class="line-modified"> 849    *     The sub-table used for format 2.0.</span>
<span class="line-modified"> 850    *</span>
<span class="line-added"> 851    *   format_25 ::</span>
<span class="line-added"> 852    *     The sub-table used for format 2.5.</span>
<span class="line-added"> 853    */</span>
 854   typedef struct  TT_Post_NamesRec_
 855   {
 856     FT_Bool  loaded;
 857 
 858     union
 859     {
 860       TT_Post_20Rec  format_20;
 861       TT_Post_25Rec  format_25;
 862 
 863     } names;
 864 
 865   } TT_Post_NamesRec, *TT_Post_Names;
 866 
 867 
 868   /*************************************************************************/
 869   /*************************************************************************/
 870   /*************************************************************************/
 871   /***                                                                   ***/
 872   /***                                                                   ***/
 873   /***                    GX VARIATION TABLE SUPPORT                     ***/
</pre>
<hr />
<pre>
 879 
 880 
 881 #ifdef TT_CONFIG_OPTION_GX_VAR_SUPPORT
 882   typedef struct GX_BlendRec_  *GX_Blend;
 883 #endif
 884 
 885   /*************************************************************************/
 886   /*************************************************************************/
 887   /*************************************************************************/
 888   /***                                                                   ***/
 889   /***                                                                   ***/
 890   /***              EMBEDDED BDF PROPERTIES TABLE SUPPORT                ***/
 891   /***                                                                   ***/
 892   /***                                                                   ***/
 893   /*************************************************************************/
 894   /*************************************************************************/
 895   /*************************************************************************/
 896 
 897   /*
 898    * These types are used to support a `BDF &#39; table that isn&#39;t part of the
<span class="line-modified"> 899    * official TrueType specification.  It is mainly used in SFNT-based bitmap</span>
<span class="line-modified"> 900    * fonts that were generated from a set of BDF fonts.</span>
 901    *
 902    * The format of the table is as follows.
 903    *
<span class="line-modified"> 904    *   USHORT version `BDF &#39; table version number, should be 0x0001.  USHORT</span>
<span class="line-modified"> 905    *   strikeCount Number of strikes (bitmap sizes) in this table.  ULONG</span>
<span class="line-modified"> 906    *   stringTable Offset (from start of BDF table) to string</span>
 907    *                         table.
 908    *
 909    * This is followed by an array of `strikeCount&#39; descriptors, having the
 910    * following format.
 911    *
<span class="line-modified"> 912    *   USHORT ppem Vertical pixels per EM for this strike.  USHORT numItems</span>
<span class="line-modified"> 913    *   Number of items for this strike (properties and</span>
 914    *                         atoms).  Maximum is 255.
 915    *
<span class="line-modified"> 916    * This array in turn is followed by `strikeCount&#39; value sets.  Each `value</span>
<span class="line-modified"> 917    * set&#39; is an array of `numItems&#39; items with the following format.</span>
 918    *
 919    *   ULONG    item_name    Offset in string table to item name.
 920    *   USHORT   item_type    The item type.  Possible values are
 921    *                            0 =&gt; string (e.g., COMMENT)
 922    *                            1 =&gt; atom   (e.g., FONT or even SIZE)
 923    *                            2 =&gt; int32
 924    *                            3 =&gt; uint32
 925    *                         0x10 =&gt; A flag to indicate a properties.  This
 926    *                                 is ORed with the above values.
 927    *   ULONG    item_value   For strings  =&gt; Offset into string table without
 928    *                                         the corresponding double quotes.
 929    *                         For atoms    =&gt; Offset into string table.
 930    *                         For integers =&gt; Direct value.
 931    *
 932    * All strings in the string table consist of bytes and are
 933    * zero-terminated.
 934    *
 935    */
 936 
 937 #ifdef TT_CONFIG_OPTION_BDF
</pre>
<hr />
<pre>
 945     FT_UInt    num_strikes;
 946     FT_Bool    loaded;
 947 
 948   } TT_BDFRec, *TT_BDF;
 949 
 950 #endif /* TT_CONFIG_OPTION_BDF */
 951 
 952   /*************************************************************************/
 953   /*************************************************************************/
 954   /*************************************************************************/
 955   /***                                                                   ***/
 956   /***                                                                   ***/
 957   /***                  ORIGINAL TT_FACE CLASS DEFINITION                ***/
 958   /***                                                                   ***/
 959   /***                                                                   ***/
 960   /*************************************************************************/
 961   /*************************************************************************/
 962   /*************************************************************************/
 963 
 964 
<span class="line-modified"> 965   /**************************************************************************</span>
<span class="line-modified"> 966    *</span>
<span class="line-modified"> 967    * This structure/class is defined here because it is common to the</span>
<span class="line-modified"> 968    * following formats: TTF, OpenType-TT, and OpenType-CFF.</span>
<span class="line-modified"> 969    *</span>
<span class="line-modified"> 970    * Note, however, that the classes TT_Size and TT_GlyphSlot are not shared</span>
<span class="line-modified"> 971    * between font drivers, and are thus defined in `ttobjs.h`.</span>
<span class="line-modified"> 972    *</span>
<span class="line-modified"> 973    */</span>
 974 
 975 
<span class="line-modified"> 976   /**************************************************************************</span>
<span class="line-modified"> 977    *</span>
<span class="line-modified"> 978    * @type:</span>
<span class="line-modified"> 979    *   TT_Face</span>
<span class="line-modified"> 980    *</span>
<span class="line-modified"> 981    * @description:</span>
<span class="line-modified"> 982    *   A handle to a TrueType face/font object.  A TT_Face encapsulates the</span>
<span class="line-modified"> 983    *   resolution and scaling independent parts of a TrueType font resource.</span>
<span class="line-modified"> 984    *</span>
<span class="line-modified"> 985    * @note:</span>
<span class="line-modified"> 986    *   The TT_Face structure is also used as a &#39;parent class&#39; for the</span>
<span class="line-modified"> 987    *   OpenType-CFF class (T2_Face).</span>
<span class="line-modified"> 988    */</span>

 989   typedef struct TT_FaceRec_*  TT_Face;
 990 
 991 
 992   /* a function type used for the truetype bytecode interpreter hooks */
 993   typedef FT_Error
 994   (*TT_Interpreter)( void*  exec_context );
 995 
 996   /* forward declaration */
 997   typedef struct TT_LoaderRec_*  TT_Loader;
 998 
 999 
<span class="line-modified">1000   /**************************************************************************</span>
<span class="line-modified">1001    *</span>
<span class="line-modified">1002    * @functype:</span>
<span class="line-modified">1003    *   TT_Loader_GotoTableFunc</span>
<span class="line-modified">1004    *</span>
<span class="line-modified">1005    * @description:</span>
<span class="line-modified">1006    *   Seeks a stream to the start of a given TrueType table.</span>
<span class="line-modified">1007    *</span>
<span class="line-modified">1008    * @input:</span>
<span class="line-modified">1009    *   face ::</span>
<span class="line-modified">1010    *     A handle to the target face object.</span>
<span class="line-modified">1011    *</span>
<span class="line-modified">1012    *   tag ::</span>
<span class="line-modified">1013    *     A 4-byte tag used to name the table.</span>
<span class="line-modified">1014    *</span>
<span class="line-modified">1015    *   stream ::</span>
<span class="line-modified">1016    *     The input stream.</span>
<span class="line-modified">1017    *</span>
<span class="line-modified">1018    * @output:</span>
<span class="line-modified">1019    *   length ::</span>
<span class="line-modified">1020    *     The length of the table in bytes.  Set to 0 if not needed.</span>
<span class="line-modified">1021    *</span>
<span class="line-modified">1022    * @return:</span>
<span class="line-modified">1023    *   FreeType error code.  0 means success.</span>
<span class="line-modified">1024    *</span>
<span class="line-added">1025    * @note:</span>
<span class="line-added">1026    *   The stream cursor must be at the font file&#39;s origin.</span>
<span class="line-added">1027    */</span>
1028   typedef FT_Error
1029   (*TT_Loader_GotoTableFunc)( TT_Face    face,
1030                               FT_ULong   tag,
1031                               FT_Stream  stream,
1032                               FT_ULong*  length );
1033 
1034 
<span class="line-modified">1035   /**************************************************************************</span>
<span class="line-modified">1036    *</span>
<span class="line-modified">1037    * @functype:</span>
<span class="line-modified">1038    *   TT_Loader_StartGlyphFunc</span>
<span class="line-modified">1039    *</span>
<span class="line-modified">1040    * @description:</span>
<span class="line-modified">1041    *   Seeks a stream to the start of a given glyph element, and opens a</span>
<span class="line-modified">1042    *   frame for it.</span>
<span class="line-modified">1043    *</span>
<span class="line-modified">1044    * @input:</span>
<span class="line-modified">1045    *   loader ::</span>
<span class="line-modified">1046    *     The current TrueType glyph loader object.</span>
<span class="line-modified">1047    *</span>
<span class="line-modified">1048    *     glyph index :: The index of the glyph to access.</span>
<span class="line-modified">1049    *</span>
<span class="line-modified">1050    *   offset ::</span>
<span class="line-modified">1051    *     The offset of the glyph according to the &#39;locations&#39; table.</span>
<span class="line-modified">1052    *</span>
<span class="line-modified">1053    *   byte_count ::</span>
<span class="line-modified">1054    *     The size of the frame in bytes.</span>
<span class="line-modified">1055    *</span>
<span class="line-modified">1056    * @return:</span>
<span class="line-modified">1057    *   FreeType error code.  0 means success.</span>
<span class="line-modified">1058    *</span>
<span class="line-modified">1059    * @note:</span>
<span class="line-modified">1060    *   This function is normally equivalent to FT_STREAM_SEEK(offset)</span>
<span class="line-modified">1061    *   followed by FT_FRAME_ENTER(byte_count) with the loader&#39;s stream, but</span>
<span class="line-modified">1062    *   alternative formats (e.g. compressed ones) might use something</span>
<span class="line-added">1063    *   different.</span>
<span class="line-added">1064    */</span>
1065   typedef FT_Error
1066   (*TT_Loader_StartGlyphFunc)( TT_Loader  loader,
1067                                FT_UInt    glyph_index,
1068                                FT_ULong   offset,
1069                                FT_UInt    byte_count );
1070 
1071 
<span class="line-modified">1072   /**************************************************************************</span>
<span class="line-modified">1073    *</span>
<span class="line-modified">1074    * @functype:</span>
<span class="line-modified">1075    *   TT_Loader_ReadGlyphFunc</span>
<span class="line-modified">1076    *</span>
<span class="line-modified">1077    * @description:</span>
<span class="line-modified">1078    *   Reads one glyph element (its header, a simple glyph, or a composite)</span>
<span class="line-modified">1079    *   from the loader&#39;s current stream frame.</span>
<span class="line-modified">1080    *</span>
<span class="line-modified">1081    * @input:</span>
<span class="line-modified">1082    *   loader ::</span>
<span class="line-modified">1083    *     The current TrueType glyph loader object.</span>
<span class="line-modified">1084    *</span>
<span class="line-modified">1085    * @return:</span>
<span class="line-modified">1086    *   FreeType error code.  0 means success.</span>
<span class="line-added">1087    */</span>
1088   typedef FT_Error
1089   (*TT_Loader_ReadGlyphFunc)( TT_Loader  loader );
1090 
1091 
<span class="line-modified">1092   /**************************************************************************</span>
<span class="line-modified">1093    *</span>
<span class="line-modified">1094    * @functype:</span>
<span class="line-modified">1095    *   TT_Loader_EndGlyphFunc</span>
<span class="line-modified">1096    *</span>
<span class="line-modified">1097    * @description:</span>
<span class="line-modified">1098    *   Closes the current loader stream frame for the glyph.</span>
<span class="line-modified">1099    *</span>
<span class="line-modified">1100    * @input:</span>
<span class="line-modified">1101    *   loader ::</span>
<span class="line-modified">1102    *     The current TrueType glyph loader object.</span>
<span class="line-added">1103    */</span>
1104   typedef void
1105   (*TT_Loader_EndGlyphFunc)( TT_Loader  loader );
1106 
1107 
1108   typedef enum TT_SbitTableType_
1109   {
1110     TT_SBIT_TABLE_TYPE_NONE = 0,
1111     TT_SBIT_TABLE_TYPE_EBLC, /* `EBLC&#39; (Microsoft), */
1112                              /* `bloc&#39; (Apple)      */
1113     TT_SBIT_TABLE_TYPE_CBLC, /* `CBLC&#39; (Google)     */
1114     TT_SBIT_TABLE_TYPE_SBIX, /* `sbix&#39; (Apple)      */
1115 
1116     /* do not remove */
1117     TT_SBIT_TABLE_TYPE_MAX
1118 
1119   } TT_SbitTableType;
1120 
1121 
1122   /* OpenType 1.8 brings new tables for variation font support;  */
1123   /* to make the old MM and GX fonts still work we need to check */
</pre>
<hr />
<pre>
1130   /* actually requested.                                         */
1131 
1132   /* FVAR */
1133 #define TT_FACE_FLAG_VAR_FVAR  ( 1 &lt;&lt; 0 )
1134 
1135   /* HVAR */
1136 #define TT_FACE_FLAG_VAR_HADVANCE  ( 1 &lt;&lt; 1 )
1137 #define TT_FACE_FLAG_VAR_LSB       ( 1 &lt;&lt; 2 )
1138 #define TT_FACE_FLAG_VAR_RSB       ( 1 &lt;&lt; 3 )
1139 
1140   /* VVAR */
1141 #define TT_FACE_FLAG_VAR_VADVANCE  ( 1 &lt;&lt; 4 )
1142 #define TT_FACE_FLAG_VAR_TSB       ( 1 &lt;&lt; 5 )
1143 #define TT_FACE_FLAG_VAR_BSB       ( 1 &lt;&lt; 6 )
1144 #define TT_FACE_FLAG_VAR_VORG      ( 1 &lt;&lt; 7 )
1145 
1146   /* MVAR */
1147 #define TT_FACE_FLAG_VAR_MVAR  ( 1 &lt;&lt; 8 )
1148 
1149 
<span class="line-modified">1150   /**************************************************************************</span>
<span class="line-modified">1151    *</span>
<span class="line-modified">1152    *                        TrueType Face Type</span>
<span class="line-modified">1153    *</span>
<span class="line-modified">1154    * @struct:</span>
<span class="line-modified">1155    *   TT_Face</span>
<span class="line-modified">1156    *</span>
<span class="line-modified">1157    * @description:</span>
<span class="line-modified">1158    *   The TrueType face class.  These objects model the resolution and</span>
<span class="line-modified">1159    *   point-size independent data found in a TrueType font file.</span>
<span class="line-modified">1160    *</span>
<span class="line-modified">1161    * @fields:</span>
<span class="line-modified">1162    *   root ::</span>
<span class="line-modified">1163    *     The base FT_Face structure, managed by the base layer.</span>
<span class="line-modified">1164    *</span>
<span class="line-modified">1165    *   ttc_header ::</span>
<span class="line-modified">1166    *     The TrueType collection header, used when the file is a &#39;ttc&#39; rather</span>
<span class="line-modified">1167    *     than a &#39;ttf&#39;.  For ordinary font files, the field `ttc_header.count`</span>
<span class="line-modified">1168    *     is set to 0.</span>
<span class="line-modified">1169    *</span>
<span class="line-modified">1170    *   format_tag ::</span>
<span class="line-modified">1171    *     The font format tag.</span>
<span class="line-modified">1172    *</span>
<span class="line-modified">1173    *   num_tables ::</span>
<span class="line-modified">1174    *     The number of TrueType tables in this font file.</span>
<span class="line-modified">1175    *</span>
<span class="line-modified">1176    *   dir_tables ::</span>
<span class="line-modified">1177    *     The directory of TrueType tables for this font file.</span>
<span class="line-modified">1178    *</span>
<span class="line-modified">1179    *   header ::</span>
<span class="line-modified">1180    *     The font&#39;s font header (&#39;head&#39; table).  Read on font opening.</span>
<span class="line-modified">1181    *</span>
<span class="line-modified">1182    *   horizontal ::</span>
<span class="line-modified">1183    *     The font&#39;s horizontal header (&#39;hhea&#39; table).  This field also</span>
<span class="line-modified">1184    *     contains the associated horizontal metrics table (&#39;hmtx&#39;).</span>
<span class="line-modified">1185    *</span>
<span class="line-modified">1186    *   max_profile ::</span>
<span class="line-modified">1187    *     The font&#39;s maximum profile table.  Read on font opening.  Note that</span>
<span class="line-modified">1188    *     some maximum values cannot be taken directly from this table.  We</span>
<span class="line-modified">1189    *     thus define additional fields below to hold the computed maxima.</span>
<span class="line-modified">1190    *</span>
<span class="line-modified">1191    *   vertical_info ::</span>
<span class="line-modified">1192    *     A boolean which is set when the font file contains vertical metrics.</span>
<span class="line-modified">1193    *     If not, the value of the &#39;vertical&#39; field is undefined.</span>
<span class="line-modified">1194    *</span>
<span class="line-modified">1195    *   vertical ::</span>
<span class="line-modified">1196    *     The font&#39;s vertical header (&#39;vhea&#39; table).  This field also contains</span>
<span class="line-modified">1197    *     the associated vertical metrics table (&#39;vmtx&#39;), if found.</span>
<span class="line-modified">1198    *     IMPORTANT: The contents of this field is undefined if the</span>
<span class="line-modified">1199    *     `vertical_info` field is unset.</span>
<span class="line-modified">1200    *</span>
<span class="line-modified">1201    *   num_names ::</span>
<span class="line-modified">1202    *     The number of name records within this TrueType font.</span>
<span class="line-modified">1203    *</span>
<span class="line-modified">1204    *   name_table ::</span>
<span class="line-modified">1205    *     The table of name records (&#39;name&#39;).</span>
<span class="line-modified">1206    *</span>
<span class="line-modified">1207    *   os2 ::</span>
<span class="line-modified">1208    *     The font&#39;s OS/2 table (&#39;OS/2&#39;).</span>
<span class="line-modified">1209    *</span>
<span class="line-modified">1210    *   postscript ::</span>
<span class="line-modified">1211    *     The font&#39;s PostScript table (&#39;post&#39; table).  The PostScript glyph</span>
<span class="line-modified">1212    *     names are not loaded by the driver on face opening.  See the</span>
<span class="line-modified">1213    *     &#39;ttpost&#39; module for more details.</span>
<span class="line-modified">1214    *</span>
<span class="line-modified">1215    *   cmap_table ::</span>
<span class="line-modified">1216    *     Address of the face&#39;s &#39;cmap&#39; SFNT table in memory (it&#39;s an extracted</span>
<span class="line-modified">1217    *     frame).</span>
<span class="line-modified">1218    *</span>
<span class="line-modified">1219    *   cmap_size ::</span>
<span class="line-modified">1220    *     The size in bytes of the `cmap_table` described above.</span>
<span class="line-modified">1221    *</span>
<span class="line-modified">1222    *   goto_table ::</span>
<span class="line-modified">1223    *     A function called by each TrueType table loader to position a</span>
<span class="line-modified">1224    *     stream&#39;s cursor to the start of a given table according to its tag.</span>
<span class="line-modified">1225    *     It defaults to TT_Goto_Face but can be different for strange formats</span>
<span class="line-modified">1226    *     (e.g.  Type 42).</span>
<span class="line-modified">1227    *</span>
<span class="line-modified">1228    *   access_glyph_frame ::</span>
<span class="line-modified">1229    *     A function used to access the frame of a given glyph within the</span>
<span class="line-modified">1230    *     face&#39;s font file.</span>
<span class="line-modified">1231    *</span>
<span class="line-modified">1232    *   forget_glyph_frame ::</span>
<span class="line-modified">1233    *     A function used to forget the frame of a given glyph when all data</span>
<span class="line-modified">1234    *     has been loaded.</span>
<span class="line-modified">1235    *</span>
<span class="line-modified">1236    *   read_glyph_header ::</span>
<span class="line-modified">1237    *     A function used to read a glyph header.  It must be called between</span>
<span class="line-modified">1238    *     an &#39;access&#39; and &#39;forget&#39;.</span>
<span class="line-modified">1239    *</span>
<span class="line-modified">1240    *   read_simple_glyph ::</span>
<span class="line-modified">1241    *     A function used to read a simple glyph.  It must be called after the</span>
<span class="line-modified">1242    *     header was read, and before the &#39;forget&#39;.</span>
<span class="line-modified">1243    *</span>
<span class="line-modified">1244    *   read_composite_glyph ::</span>
<span class="line-modified">1245    *     A function used to read a composite glyph.  It must be called after</span>
<span class="line-modified">1246    *     the header was read, and before the &#39;forget&#39;.</span>
<span class="line-modified">1247    *</span>
<span class="line-modified">1248    *   sfnt ::</span>
<span class="line-modified">1249    *     A pointer to the SFNT service.</span>
<span class="line-modified">1250    *</span>
<span class="line-modified">1251    *   psnames ::</span>
<span class="line-modified">1252    *     A pointer to the PostScript names service.</span>
<span class="line-modified">1253    *</span>
<span class="line-modified">1254    *   mm ::</span>
<span class="line-modified">1255    *     A pointer to the Multiple Masters service.</span>
<span class="line-modified">1256    *</span>
<span class="line-modified">1257    *   var ::</span>
<span class="line-modified">1258    *     A pointer to the Metrics Variations service.</span>
<span class="line-modified">1259    *</span>
<span class="line-modified">1260    *   hdmx ::</span>
<span class="line-modified">1261    *     The face&#39;s horizontal device metrics (&#39;hdmx&#39; table).  This table is</span>
<span class="line-modified">1262    *     optional in TrueType/OpenType fonts.</span>
<span class="line-modified">1263    *</span>
<span class="line-modified">1264    *   gasp ::</span>
<span class="line-modified">1265    *     The grid-fitting and scaling properties table (&#39;gasp&#39;).  This table</span>
<span class="line-modified">1266    *     is optional in TrueType/OpenType fonts.</span>
<span class="line-modified">1267    *</span>
<span class="line-modified">1268    *   pclt ::</span>
<span class="line-modified">1269    *     The &#39;pclt&#39; SFNT table.</span>
<span class="line-modified">1270    *</span>
<span class="line-modified">1271    *   num_sbit_scales ::</span>
<span class="line-modified">1272    *     The number of sbit scales for this font.</span>
<span class="line-modified">1273    *</span>
<span class="line-modified">1274    *   sbit_scales ::</span>
<span class="line-modified">1275    *     Array of sbit scales embedded in this font.  This table is optional</span>
<span class="line-modified">1276    *     in a TrueType/OpenType font.</span>
<span class="line-modified">1277    *</span>
<span class="line-modified">1278    *   postscript_names ::</span>
<span class="line-modified">1279    *     A table used to store the Postscript names of the glyphs for this</span>
<span class="line-modified">1280    *     font.  See the file `ttconfig.h` for comments on the</span>
<span class="line-modified">1281    *     TT_CONFIG_OPTION_POSTSCRIPT_NAMES option.</span>
<span class="line-modified">1282    *</span>
<span class="line-modified">1283    *   palette_data ::</span>
<span class="line-modified">1284    *     Some fields from the &#39;CPAL&#39; table that are directly indexed.</span>
<span class="line-modified">1285    *</span>
<span class="line-modified">1286    *   palette_index ::</span>
<span class="line-modified">1287    *     The current palette index, as set by @FT_Palette_Select.</span>
<span class="line-modified">1288    *</span>
<span class="line-modified">1289    *   palette ::</span>
<span class="line-modified">1290    *     An array containing the current palette&#39;s colors.</span>
<span class="line-modified">1291    *</span>
<span class="line-modified">1292    *   have_foreground_color ::</span>
<span class="line-modified">1293    *     There was a call to @FT_Palette_Set_Foreground_Color.</span>
<span class="line-modified">1294    *</span>
<span class="line-modified">1295    *   foreground_color ::</span>
<span class="line-modified">1296    *     The current foreground color corresponding to &#39;CPAL&#39; color index</span>
<span class="line-modified">1297    *     0xFFFF.  Only valid if `have_foreground_color` is set.</span>
<span class="line-modified">1298    *</span>
<span class="line-modified">1299    *   font_program_size ::</span>
<span class="line-modified">1300    *     Size in bytecodes of the face&#39;s font program.  0 if none defined.</span>
<span class="line-modified">1301    *     Ignored for Type 2 fonts.</span>
<span class="line-modified">1302    *</span>
<span class="line-modified">1303    *   font_program ::</span>
<span class="line-modified">1304    *     The face&#39;s font program (bytecode stream) executed at load time,</span>
<span class="line-modified">1305    *     also used during glyph rendering.  Comes from the &#39;fpgm&#39; table.</span>
<span class="line-modified">1306    *     Ignored for Type 2 font fonts.</span>
<span class="line-modified">1307    *</span>
<span class="line-modified">1308    *   cvt_program_size ::</span>
<span class="line-modified">1309    *     The size in bytecodes of the face&#39;s cvt program.  Ignored for Type 2</span>
<span class="line-modified">1310    *     fonts.</span>
<span class="line-modified">1311    *</span>
<span class="line-modified">1312    *   cvt_program ::</span>
<span class="line-modified">1313    *     The face&#39;s cvt program (bytecode stream) executed each time an</span>
<span class="line-modified">1314    *     instance/size is changed/reset.  Comes from the &#39;prep&#39; table.</span>
<span class="line-modified">1315    *     Ignored for Type 2 fonts.</span>
<span class="line-modified">1316    *</span>
<span class="line-modified">1317    *   cvt_size ::</span>
<span class="line-modified">1318    *     Size of the control value table (in entries).  Ignored for Type 2</span>
<span class="line-modified">1319    *     fonts.</span>
<span class="line-modified">1320    *</span>
<span class="line-modified">1321    *   cvt ::</span>
<span class="line-modified">1322    *     The face&#39;s original control value table.  Coordinates are expressed</span>
<span class="line-modified">1323    *     in unscaled font units (in 26.6 format).  Comes from the &#39;cvt~&#39;</span>
<span class="line-modified">1324    *     table.  Ignored for Type 2 fonts.</span>
<span class="line-modified">1325    *</span>
<span class="line-modified">1326    *     If varied by the `CVAR&#39; table, non-integer values are possible.</span>
<span class="line-modified">1327    *</span>
<span class="line-modified">1328    *   interpreter ::</span>
<span class="line-modified">1329    *     A pointer to the TrueType bytecode interpreters field is also used</span>
<span class="line-modified">1330    *     to hook the debugger in &#39;ttdebug&#39;.</span>
<span class="line-modified">1331    *</span>
<span class="line-modified">1332    *   extra ::</span>
<span class="line-modified">1333    *     Reserved for third-party font drivers.</span>
<span class="line-modified">1334    *</span>
<span class="line-modified">1335    *   postscript_name ::</span>
<span class="line-modified">1336    *     The PS name of the font.  Used by the postscript name service.</span>
<span class="line-modified">1337    *</span>
<span class="line-modified">1338    *   glyf_len ::</span>
<span class="line-modified">1339    *     The length of the &#39;glyf&#39; table.  Needed for malformed &#39;loca&#39; tables.</span>
<span class="line-modified">1340    *</span>
<span class="line-modified">1341    *   glyf_offset ::</span>
<span class="line-modified">1342    *     The file offset of the &#39;glyf&#39; table.</span>
<span class="line-modified">1343    *</span>
<span class="line-modified">1344    *   is_cff2 ::</span>
<span class="line-modified">1345    *     Set if the font format is CFF2.</span>
<span class="line-modified">1346    *</span>
<span class="line-modified">1347    *   doblend ::</span>
<span class="line-modified">1348    *     A boolean which is set if the font should be blended (this is for GX</span>
<span class="line-modified">1349    *     var).</span>
<span class="line-modified">1350    *</span>
<span class="line-modified">1351    *   blend ::</span>
<span class="line-modified">1352    *     Contains the data needed to control GX variation tables (rather like</span>
<span class="line-modified">1353    *     Multiple Master data).</span>
<span class="line-modified">1354    *</span>
<span class="line-modified">1355    *   variation_support ::</span>
<span class="line-modified">1356    *     Flags that indicate which OpenType functionality related to font</span>
<span class="line-modified">1357    *     variation support is present, valid, and usable.  For example,</span>
<span class="line-modified">1358    *     TT_FACE_FLAG_VAR_FVAR is only set if we have at least one design</span>
<span class="line-modified">1359    *     axis.</span>
<span class="line-modified">1360    *</span>
<span class="line-modified">1361    *   var_postscript_prefix ::</span>
<span class="line-modified">1362    *     The PostScript name prefix needed for constructing a variation font</span>
<span class="line-modified">1363    *     instance&#39;s PS name .</span>
<span class="line-modified">1364    *</span>
<span class="line-modified">1365    *   var_postscript_prefix_len ::</span>
<span class="line-modified">1366    *     The length of the `var_postscript_prefix` string.</span>
<span class="line-modified">1367    *</span>
<span class="line-modified">1368    *   horz_metrics_size ::</span>
<span class="line-modified">1369    *     The size of the &#39;hmtx&#39; table.</span>
<span class="line-modified">1370    *</span>
<span class="line-modified">1371    *   vert_metrics_size ::</span>
<span class="line-modified">1372    *     The size of the &#39;vmtx&#39; table.</span>
<span class="line-modified">1373    *</span>
<span class="line-modified">1374    *   num_locations ::</span>
<span class="line-modified">1375    *     The number of glyph locations in this TrueType file.  This should be</span>
<span class="line-modified">1376    *     identical to the number of glyphs.  Ignored for Type 2 fonts.</span>
<span class="line-modified">1377    *</span>
<span class="line-modified">1378    *   glyph_locations ::</span>
<span class="line-modified">1379    *     An array of longs.  These are offsets to glyph data within the</span>
<span class="line-modified">1380    *     &#39;glyf&#39; table.  Ignored for Type 2 font faces.</span>
<span class="line-modified">1381    *</span>
<span class="line-modified">1382    *   hdmx_table ::</span>
<span class="line-modified">1383    *     A pointer to the &#39;hdmx&#39; table.</span>
<span class="line-modified">1384    *</span>
<span class="line-modified">1385    *   hdmx_table_size ::</span>
<span class="line-modified">1386    *     The size of the &#39;hdmx&#39; table.</span>
<span class="line-modified">1387    *</span>
<span class="line-modified">1388    *   hdmx_record_count ::</span>
<span class="line-modified">1389    *     The number of hdmx records.</span>
<span class="line-modified">1390    *</span>
<span class="line-modified">1391    *   hdmx_record_size ::</span>
<span class="line-modified">1392    *     The size of a single hdmx record.</span>
<span class="line-modified">1393    *</span>
<span class="line-modified">1394    *   hdmx_record_sizes ::</span>
<span class="line-modified">1395    *     An array holding the ppem sizes available in the &#39;hdmx&#39; table.</span>
<span class="line-modified">1396    *</span>
<span class="line-modified">1397    *   sbit_table ::</span>
<span class="line-modified">1398    *     A pointer to the font&#39;s embedded bitmap location table.</span>
<span class="line-modified">1399    *</span>
<span class="line-modified">1400    *   sbit_table_size ::</span>
<span class="line-modified">1401    *     The size of `sbit_table`.</span>
<span class="line-modified">1402    *</span>
<span class="line-modified">1403    *   sbit_table_type ::</span>
<span class="line-modified">1404    *     The sbit table type (CBLC, sbix, etc.).</span>
<span class="line-modified">1405    *</span>
<span class="line-modified">1406    *   sbit_num_strikes ::</span>
<span class="line-modified">1407    *     The number of sbit strikes exposed by FreeType&#39;s API, omitting</span>
<span class="line-modified">1408    *     invalid strikes.</span>
<span class="line-modified">1409    *</span>
<span class="line-modified">1410    *   sbit_strike_map ::</span>
<span class="line-modified">1411    *     A mapping between the strike indices exposed by the API and the</span>
<span class="line-modified">1412    *     indices used in the font&#39;s sbit table.</span>
<span class="line-modified">1413    *</span>
<span class="line-added">1414    *   cpal ::</span>
<span class="line-added">1415    *     A pointer to data related to the &#39;CPAL&#39; table.  `NULL` if the table</span>
<span class="line-added">1416    *     is not available.</span>
<span class="line-added">1417    *</span>
<span class="line-added">1418    *   colr ::</span>
<span class="line-added">1419    *     A pointer to data related to the &#39;COLR&#39; table.  `NULL` if the table</span>
<span class="line-added">1420    *     is not available.</span>
<span class="line-added">1421    *</span>
<span class="line-added">1422    *   kern_table ::</span>
<span class="line-added">1423    *     A pointer to the &#39;kern&#39; table.</span>
<span class="line-added">1424    *</span>
<span class="line-added">1425    *   kern_table_size ::</span>
<span class="line-added">1426    *     The size of the &#39;kern&#39; table.</span>
<span class="line-added">1427    *</span>
<span class="line-added">1428    *   num_kern_tables ::</span>
<span class="line-added">1429    *     The number of supported kern subtables (up to 32; FreeType</span>
<span class="line-added">1430    *     recognizes only horizontal ones with format 0).</span>
<span class="line-added">1431    *</span>
<span class="line-added">1432    *   kern_avail_bits ::</span>
<span class="line-added">1433    *     The availability status of kern subtables; if bit n is set, table n</span>
<span class="line-added">1434    *     is available.</span>
<span class="line-added">1435    *</span>
<span class="line-added">1436    *   kern_order_bits ::</span>
<span class="line-added">1437    *     The sortedness status of kern subtables; if bit n is set, table n is</span>
<span class="line-added">1438    *     sorted.</span>
<span class="line-added">1439    *</span>
<span class="line-added">1440    *   bdf ::</span>
<span class="line-added">1441    *     Data related to an SFNT font&#39;s &#39;bdf&#39; table; see `tttypes.h`.</span>
<span class="line-added">1442    *</span>
<span class="line-added">1443    *   horz_metrics_offset ::</span>
<span class="line-added">1444    *     The file offset of the &#39;hmtx&#39; table.</span>
<span class="line-added">1445    *</span>
<span class="line-added">1446    *   vert_metrics_offset ::</span>
<span class="line-added">1447    *     The file offset of the &#39;vmtx&#39; table.</span>
<span class="line-added">1448    *</span>
<span class="line-added">1449    *   sph_found_func_flags ::</span>
<span class="line-added">1450    *     Flags identifying special bytecode functions (used by the v38</span>
<span class="line-added">1451    *     implementation of the bytecode interpreter).</span>
<span class="line-added">1452    *</span>
<span class="line-added">1453    *   sph_compatibility_mode ::</span>
<span class="line-added">1454    *     This flag is set if we are in ClearType backward compatibility mode</span>
<span class="line-added">1455    *     (used by the v38 implementation of the bytecode interpreter).</span>
<span class="line-added">1456    *</span>
<span class="line-added">1457    *   ebdt_start ::</span>
<span class="line-added">1458    *     The file offset of the sbit data table (CBDT, bdat, etc.).</span>
<span class="line-added">1459    *</span>
<span class="line-added">1460    *   ebdt_size ::</span>
<span class="line-added">1461    *     The size of the sbit data table.</span>
<span class="line-added">1462    */</span>
1463   typedef struct  TT_FaceRec_
1464   {
1465     FT_FaceRec            root;
1466 
1467     TTC_HeaderRec         ttc_header;
1468 
1469     FT_ULong              format_tag;
1470     FT_UShort             num_tables;
1471     TT_Table              dir_tables;
1472 
1473     TT_Header             header;       /* TrueType header table          */
1474     TT_HoriHeader         horizontal;   /* TrueType horizontal header     */
1475 
1476     TT_MaxProfile         max_profile;
1477 
1478     FT_Bool               vertical_info;
1479     TT_VertHeader         vertical;     /* TT Vertical header, if present */
1480 
1481     FT_UShort             num_names;    /* number of name records  */
1482     TT_NameTableRec       name_table;   /* name table              */
</pre>
<hr />
<pre>
1500     void*                 sfnt;
1501 
1502     /* a typeless pointer to the FT_Service_PsCMapsRec table used to */
1503     /* handle glyph names &lt;-&gt; unicode &amp; Mac values                   */
1504     void*                 psnames;
1505 
1506 #ifdef TT_CONFIG_OPTION_GX_VAR_SUPPORT
1507     /* a typeless pointer to the FT_Service_MultiMasters table used to */
1508     /* handle variation fonts                                          */
1509     void*                 mm;
1510 
1511     /* a typeless pointer to the FT_Service_MetricsVariationsRec table */
1512     /* used to handle the HVAR, VVAR, and MVAR OpenType tables         */
1513     void*                 var;
1514 #endif
1515 
1516     /* a typeless pointer to the PostScript Aux service */
1517     void*                 psaux;
1518 
1519 
<span class="line-modified">1520     /************************************************************************</span>
<span class="line-modified">1521      *</span>
<span class="line-modified">1522      * Optional TrueType/OpenType tables</span>
<span class="line-modified">1523      *</span>
<span class="line-modified">1524      */</span>
1525 
1526     /* grid-fitting and scaling table */
1527     TT_GaspRec            gasp;                 /* the `gasp&#39; table */
1528 
1529     /* PCL 5 table */
1530     TT_PCLT               pclt;
1531 
1532     /* embedded bitmaps support */
1533     FT_ULong              num_sbit_scales;
1534     TT_SBit_Scale         sbit_scales;
1535 
1536     /* postscript names table */
1537     TT_Post_NamesRec      postscript_names;
1538 
<span class="line-added">1539     /* glyph colors */</span>
<span class="line-added">1540     FT_Palette_Data       palette_data;         /* since 2.10 */</span>
<span class="line-added">1541     FT_UShort             palette_index;</span>
<span class="line-added">1542     FT_Color*             palette;</span>
<span class="line-added">1543     FT_Bool               have_foreground_color;</span>
<span class="line-added">1544     FT_Color              foreground_color;</span>
<span class="line-added">1545 </span>
1546 
<span class="line-modified">1547     /************************************************************************</span>
<span class="line-modified">1548      *</span>
<span class="line-modified">1549      * TrueType-specific fields (ignored by the CFF driver)</span>
<span class="line-modified">1550      *</span>
<span class="line-modified">1551      */</span>
1552 
1553     /* the font program, if any */
1554     FT_ULong              font_program_size;
1555     FT_Byte*              font_program;
1556 
1557     /* the cvt program, if any */
1558     FT_ULong              cvt_program_size;
1559     FT_Byte*              cvt_program;
1560 
1561     /* the original, unscaled, control value table */
1562     FT_ULong              cvt_size;
<span class="line-modified">1563     FT_Int32*             cvt;</span>
1564 
1565     /* A pointer to the bytecode interpreter to use.  This is also */
1566     /* used to hook the debugger for the `ttdebug&#39; utility.        */
1567     TT_Interpreter        interpreter;
1568 
1569 
<span class="line-modified">1570     /************************************************************************</span>
<span class="line-modified">1571      *</span>
<span class="line-modified">1572      * Other tables or fields. This is used by derivative formats like</span>
<span class="line-modified">1573      * OpenType.</span>
<span class="line-modified">1574      *</span>
<span class="line-modified">1575      */</span>
1576 
1577     FT_Generic            extra;
1578 
1579     const char*           postscript_name;
1580 
1581     FT_ULong              glyf_len;
1582     FT_ULong              glyf_offset;    /* since 2.7.1 */
1583 
1584     FT_Bool               is_cff2;        /* since 2.7.1 */
1585 
1586 #ifdef TT_CONFIG_OPTION_GX_VAR_SUPPORT
1587     FT_Bool               doblend;
1588     GX_Blend              blend;
1589 
1590     FT_UInt32             variation_support;     /* since 2.7.1 */
1591 
1592     const char*           var_postscript_prefix;     /* since 2.7.2 */
1593     FT_UInt               var_postscript_prefix_len; /* since 2.7.2 */
1594 
1595 #endif
</pre>
<hr />
<pre>
1624     TT_BDFRec             bdf;
1625 #endif /* TT_CONFIG_OPTION_BDF */
1626 
1627     /* since 2.3.0 */
1628     FT_ULong              horz_metrics_offset;
1629     FT_ULong              vert_metrics_offset;
1630 
1631 #ifdef TT_SUPPORT_SUBPIXEL_HINTING_INFINALITY
1632     /* since 2.4.12 */
1633     FT_ULong              sph_found_func_flags; /* special functions found */
1634                                                 /* for this face           */
1635     FT_Bool               sph_compatibility_mode;
1636 #endif /* TT_SUPPORT_SUBPIXEL_HINTING_INFINALITY */
1637 
1638 #ifdef TT_CONFIG_OPTION_EMBEDDED_BITMAPS
1639     /* since 2.7 */
1640     FT_ULong              ebdt_start;  /* either `CBDT&#39;, `EBDT&#39;, or `bdat&#39; */
1641     FT_ULong              ebdt_size;
1642 #endif
1643 
<span class="line-added">1644     /* since 2.10 */</span>
<span class="line-added">1645     void*                 cpal;</span>
<span class="line-added">1646     void*                 colr;</span>
<span class="line-added">1647 </span>
1648   } TT_FaceRec;
1649 
1650 
<span class="line-modified">1651   /**************************************************************************</span>
<span class="line-modified">1652    *</span>
<span class="line-modified">1653    * @struct:</span>
<span class="line-modified">1654    *    TT_GlyphZoneRec</span>
<span class="line-modified">1655    *</span>
<span class="line-modified">1656    * @description:</span>
<span class="line-modified">1657    *   A glyph zone is used to load, scale and hint glyph outline</span>
<span class="line-modified">1658    *   coordinates.</span>
<span class="line-modified">1659    *</span>
<span class="line-modified">1660    * @fields:</span>
<span class="line-modified">1661    *   memory ::</span>
<span class="line-modified">1662    *     A handle to the memory manager.</span>
<span class="line-modified">1663    *</span>
<span class="line-modified">1664    *   max_points ::</span>
<span class="line-modified">1665    *     The maximum size in points of the zone.</span>
<span class="line-modified">1666    *</span>
<span class="line-modified">1667    *   max_contours ::</span>
<span class="line-modified">1668    *     Max size in links contours of the zone.</span>
<span class="line-modified">1669    *</span>
<span class="line-modified">1670    *   n_points ::</span>
<span class="line-modified">1671    *     The current number of points in the zone.</span>
<span class="line-modified">1672    *</span>
<span class="line-modified">1673    *   n_contours ::</span>
<span class="line-modified">1674    *     The current number of contours in the zone.</span>
<span class="line-modified">1675    *</span>
<span class="line-modified">1676    *   org ::</span>
<span class="line-modified">1677    *     The original glyph coordinates (font units/scaled).</span>
<span class="line-modified">1678    *</span>
<span class="line-modified">1679    *   cur ::</span>
<span class="line-modified">1680    *     The current glyph coordinates (scaled/hinted).</span>
<span class="line-modified">1681    *</span>
<span class="line-added">1682    *   tags ::</span>
<span class="line-added">1683    *     The point control tags.</span>
<span class="line-added">1684    *</span>
<span class="line-added">1685    *   contours ::</span>
<span class="line-added">1686    *     The contours end points.</span>
<span class="line-added">1687    *</span>
<span class="line-added">1688    *   first_point ::</span>
<span class="line-added">1689    *     Offset of the current subglyph&#39;s first point.</span>
<span class="line-added">1690    */</span>
1691   typedef struct  TT_GlyphZoneRec_
1692   {
1693     FT_Memory   memory;
1694     FT_UShort   max_points;
1695     FT_Short    max_contours;
1696     FT_UShort   n_points;    /* number of points in zone    */
1697     FT_Short    n_contours;  /* number of contours          */
1698 
1699     FT_Vector*  org;         /* original point coordinates  */
1700     FT_Vector*  cur;         /* current point coordinates   */
1701     FT_Vector*  orus;        /* original (unscaled) point coordinates */
1702 
1703     FT_Byte*    tags;        /* current touch flags         */
1704     FT_UShort*  contours;    /* contour end points          */
1705 
1706     FT_UShort   first_point; /* offset of first (#0) point  */
1707 
1708   } TT_GlyphZoneRec, *TT_GlyphZone;
1709 
1710 
1711   /* handle to execution context */
1712   typedef struct TT_ExecContextRec_*  TT_ExecContext;
1713 
1714 
<span class="line-modified">1715   /**************************************************************************</span>
<span class="line-modified">1716    *</span>
<span class="line-modified">1717    * @type:</span>
<span class="line-modified">1718    *   TT_Size</span>
<span class="line-modified">1719    *</span>
<span class="line-modified">1720    * @description:</span>
<span class="line-modified">1721    *   A handle to a TrueType size object.</span>
<span class="line-modified">1722    */</span>
1723   typedef struct TT_SizeRec_*  TT_Size;
1724 
1725 
1726   /* glyph loader structure */
1727   typedef struct  TT_LoaderRec_
1728   {
1729     TT_Face          face;
1730     TT_Size          size;
1731     FT_GlyphSlot     glyph;
1732     FT_GlyphLoader   gloader;
1733 
1734     FT_ULong         load_flags;
1735     FT_UInt          glyph_index;
1736 
1737     FT_Stream        stream;
1738     FT_Int           byte_len;
1739 
1740     FT_Short         n_contours;
1741     FT_BBox          bbox;
1742     FT_Int           left_bearing;
</pre>
</td>
</tr>
</table>
<center><a href="t1types.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../t1tables.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>