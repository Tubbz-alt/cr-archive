<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/native/libfreetype/src/base/ftmm.c</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="ftmac.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ftobjs.c.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfreetype/src/base/ftmm.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
<span class="line-modified">  1 /***************************************************************************/</span>
<span class="line-modified">  2 /*                                                                         */</span>
<span class="line-modified">  3 /*  ftmm.c                                                                 */</span>
<span class="line-modified">  4 /*                                                                         */</span>
<span class="line-modified">  5 /*    Multiple Master font support (body).                                 */</span>
<span class="line-modified">  6 /*                                                                         */</span>
<span class="line-modified">  7 /*  Copyright 1996-2018 by                                                 */</span>
<span class="line-modified">  8 /*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */</span>
<span class="line-modified">  9 /*                                                                         */</span>
<span class="line-modified"> 10 /*  This file is part of the FreeType project, and may only be used,       */</span>
<span class="line-modified"> 11 /*  modified, and distributed under the terms of the FreeType project      */</span>
<span class="line-modified"> 12 /*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<span class="line-modified"> 13 /*  this file you indicate that you have read the license and              */</span>
<span class="line-modified"> 14 /*  understand and accept it fully.                                        */</span>
<span class="line-modified"> 15 /*                                                                         */</span>
<span class="line-modified"> 16 /***************************************************************************/</span>
 17 
 18 
 19 #include &lt;ft2build.h&gt;
 20 #include FT_INTERNAL_DEBUG_H
 21 
 22 #include FT_MULTIPLE_MASTERS_H
 23 #include FT_INTERNAL_OBJECTS_H
 24 #include FT_SERVICE_MULTIPLE_MASTERS_H
 25 #include FT_SERVICE_METRICS_VARIATIONS_H
 26 
 27 
<span class="line-modified"> 28   /*************************************************************************/</span>
<span class="line-modified"> 29   /*                                                                       */</span>
<span class="line-modified"> 30   /* The macro FT_COMPONENT is used in trace mode.  It is an implicit      */</span>
<span class="line-modified"> 31   /* parameter of the FT_TRACE() and FT_ERROR() macros, used to print/log  */</span>
<span class="line-modified"> 32   /* messages during execution.                                            */</span>
<span class="line-modified"> 33   /*                                                                       */</span>
 34 #undef  FT_COMPONENT
<span class="line-modified"> 35 #define FT_COMPONENT  trace_mm</span>
 36 
 37 
 38   static FT_Error
 39   ft_face_get_mm_service( FT_Face                   face,
 40                           FT_Service_MultiMasters  *aservice )
 41   {
 42     FT_Error  error;
 43 
 44 
 45     *aservice = NULL;
 46 
 47     if ( !face )
 48       return FT_THROW( Invalid_Face_Handle );
 49 
 50     error = FT_ERR( Invalid_Argument );
 51 
 52     if ( FT_HAS_MULTIPLE_MASTERS( face ) )
 53     {
 54       FT_FACE_LOOKUP_SERVICE( face,
 55                               *aservice,
</pre>
<hr />
<pre>
182 
183     error = ft_face_get_mm_service( face, &amp;service );
184     if ( !error )
185     {
186       error = FT_ERR( Invalid_Argument );
187       if ( service-&gt;set_mm_design )
188         error = service-&gt;set_mm_design( face, num_coords, coords );
189     }
190 
191     /* enforce recomputation of auto-hinting data */
192     if ( !error &amp;&amp; face-&gt;autohint.finalizer )
193     {
194       face-&gt;autohint.finalizer( face-&gt;autohint.data );
195       face-&gt;autohint.data = NULL;
196     }
197 
198     return error;
199   }
200 
201 





























































202   /* documentation is in ftmm.h */
203 
204   FT_EXPORT_DEF( FT_Error )
205   FT_Set_Var_Design_Coordinates( FT_Face    face,
206                                  FT_UInt    num_coords,
207                                  FT_Fixed*  coords )
208   {
209     FT_Error                      error;
210     FT_Service_MultiMasters       service_mm   = NULL;
211     FT_Service_MetricsVariations  service_mvar = NULL;
212 
213 
214     /* check of `face&#39; delayed to `ft_face_get_mm_service&#39; */
215 
216     if ( num_coords &amp;&amp; !coords )
217       return FT_THROW( Invalid_Argument );
218 
219     error = ft_face_get_mm_service( face, &amp;service_mm );
220     if ( !error )
221     {
</pre>
</td>
<td>
<hr />
<pre>
<span class="line-modified">  1 /****************************************************************************</span>
<span class="line-modified">  2  *</span>
<span class="line-modified">  3  * ftmm.c</span>
<span class="line-modified">  4  *</span>
<span class="line-modified">  5  *   Multiple Master font support (body).</span>
<span class="line-modified">  6  *</span>
<span class="line-modified">  7  * Copyright (C) 1996-2019 by</span>
<span class="line-modified">  8  * David Turner, Robert Wilhelm, and Werner Lemberg.</span>
<span class="line-modified">  9  *</span>
<span class="line-modified"> 10  * This file is part of the FreeType project, and may only be used,</span>
<span class="line-modified"> 11  * modified, and distributed under the terms of the FreeType project</span>
<span class="line-modified"> 12  * license, LICENSE.TXT.  By continuing to use, modify, or distribute</span>
<span class="line-modified"> 13  * this file you indicate that you have read the license and</span>
<span class="line-modified"> 14  * understand and accept it fully.</span>
<span class="line-modified"> 15  *</span>
<span class="line-modified"> 16  */</span>
 17 
 18 
 19 #include &lt;ft2build.h&gt;
 20 #include FT_INTERNAL_DEBUG_H
 21 
 22 #include FT_MULTIPLE_MASTERS_H
 23 #include FT_INTERNAL_OBJECTS_H
 24 #include FT_SERVICE_MULTIPLE_MASTERS_H
 25 #include FT_SERVICE_METRICS_VARIATIONS_H
 26 
 27 
<span class="line-modified"> 28   /**************************************************************************</span>
<span class="line-modified"> 29    *</span>
<span class="line-modified"> 30    * The macro FT_COMPONENT is used in trace mode.  It is an implicit</span>
<span class="line-modified"> 31    * parameter of the FT_TRACE() and FT_ERROR() macros, used to print/log</span>
<span class="line-modified"> 32    * messages during execution.</span>
<span class="line-modified"> 33    */</span>
 34 #undef  FT_COMPONENT
<span class="line-modified"> 35 #define FT_COMPONENT  mm</span>
 36 
 37 
 38   static FT_Error
 39   ft_face_get_mm_service( FT_Face                   face,
 40                           FT_Service_MultiMasters  *aservice )
 41   {
 42     FT_Error  error;
 43 
 44 
 45     *aservice = NULL;
 46 
 47     if ( !face )
 48       return FT_THROW( Invalid_Face_Handle );
 49 
 50     error = FT_ERR( Invalid_Argument );
 51 
 52     if ( FT_HAS_MULTIPLE_MASTERS( face ) )
 53     {
 54       FT_FACE_LOOKUP_SERVICE( face,
 55                               *aservice,
</pre>
<hr />
<pre>
182 
183     error = ft_face_get_mm_service( face, &amp;service );
184     if ( !error )
185     {
186       error = FT_ERR( Invalid_Argument );
187       if ( service-&gt;set_mm_design )
188         error = service-&gt;set_mm_design( face, num_coords, coords );
189     }
190 
191     /* enforce recomputation of auto-hinting data */
192     if ( !error &amp;&amp; face-&gt;autohint.finalizer )
193     {
194       face-&gt;autohint.finalizer( face-&gt;autohint.data );
195       face-&gt;autohint.data = NULL;
196     }
197 
198     return error;
199   }
200 
201 
<span class="line-added">202   /* documentation is in ftmm.h */</span>
<span class="line-added">203 </span>
<span class="line-added">204   FT_EXPORT_DEF( FT_Error )</span>
<span class="line-added">205   FT_Set_MM_WeightVector( FT_Face    face,</span>
<span class="line-added">206                           FT_UInt    len,</span>
<span class="line-added">207                           FT_Fixed*  weightvector )</span>
<span class="line-added">208   {</span>
<span class="line-added">209     FT_Error                 error;</span>
<span class="line-added">210     FT_Service_MultiMasters  service;</span>
<span class="line-added">211 </span>
<span class="line-added">212 </span>
<span class="line-added">213     /* check of `face&#39; delayed to `ft_face_get_mm_service&#39; */</span>
<span class="line-added">214 </span>
<span class="line-added">215     if ( len &amp;&amp; !weightvector )</span>
<span class="line-added">216       return FT_THROW( Invalid_Argument );</span>
<span class="line-added">217 </span>
<span class="line-added">218     error = ft_face_get_mm_service( face, &amp;service );</span>
<span class="line-added">219     if ( !error )</span>
<span class="line-added">220     {</span>
<span class="line-added">221       error = FT_ERR( Invalid_Argument );</span>
<span class="line-added">222       if ( service-&gt;set_mm_weightvector )</span>
<span class="line-added">223         error = service-&gt;set_mm_weightvector( face, len, weightvector );</span>
<span class="line-added">224     }</span>
<span class="line-added">225 </span>
<span class="line-added">226     /* enforce recomputation of auto-hinting data */</span>
<span class="line-added">227     if ( !error &amp;&amp; face-&gt;autohint.finalizer )</span>
<span class="line-added">228     {</span>
<span class="line-added">229       face-&gt;autohint.finalizer( face-&gt;autohint.data );</span>
<span class="line-added">230       face-&gt;autohint.data = NULL;</span>
<span class="line-added">231     }</span>
<span class="line-added">232 </span>
<span class="line-added">233     return error;</span>
<span class="line-added">234   }</span>
<span class="line-added">235 </span>
<span class="line-added">236 </span>
<span class="line-added">237   FT_EXPORT_DEF( FT_Error )</span>
<span class="line-added">238   FT_Get_MM_WeightVector( FT_Face    face,</span>
<span class="line-added">239                           FT_UInt*   len,</span>
<span class="line-added">240                           FT_Fixed*  weightvector )</span>
<span class="line-added">241   {</span>
<span class="line-added">242     FT_Error                 error;</span>
<span class="line-added">243     FT_Service_MultiMasters  service;</span>
<span class="line-added">244 </span>
<span class="line-added">245 </span>
<span class="line-added">246     /* check of `face&#39; delayed to `ft_face_get_mm_service&#39; */</span>
<span class="line-added">247 </span>
<span class="line-added">248     if ( len &amp;&amp; !weightvector )</span>
<span class="line-added">249       return FT_THROW( Invalid_Argument );</span>
<span class="line-added">250 </span>
<span class="line-added">251     error = ft_face_get_mm_service( face, &amp;service );</span>
<span class="line-added">252     if ( !error )</span>
<span class="line-added">253     {</span>
<span class="line-added">254       error = FT_ERR( Invalid_Argument );</span>
<span class="line-added">255       if ( service-&gt;get_mm_weightvector )</span>
<span class="line-added">256         error = service-&gt;get_mm_weightvector( face, len, weightvector );</span>
<span class="line-added">257     }</span>
<span class="line-added">258 </span>
<span class="line-added">259     return error;</span>
<span class="line-added">260   }</span>
<span class="line-added">261 </span>
<span class="line-added">262 </span>
263   /* documentation is in ftmm.h */
264 
265   FT_EXPORT_DEF( FT_Error )
266   FT_Set_Var_Design_Coordinates( FT_Face    face,
267                                  FT_UInt    num_coords,
268                                  FT_Fixed*  coords )
269   {
270     FT_Error                      error;
271     FT_Service_MultiMasters       service_mm   = NULL;
272     FT_Service_MetricsVariations  service_mvar = NULL;
273 
274 
275     /* check of `face&#39; delayed to `ft_face_get_mm_service&#39; */
276 
277     if ( num_coords &amp;&amp; !coords )
278       return FT_THROW( Invalid_Argument );
279 
280     error = ft_face_get_mm_service( face, &amp;service_mm );
281     if ( !error )
282     {
</pre>
</td>
</tr>
</table>
<center><a href="ftmac.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ftobjs.c.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>