<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/share/native/libfreetype/include/freetype/internal/ftobjs.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ftmemory.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="ftpsprop.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfreetype/include/freetype/internal/ftobjs.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,28 ***</span>
<span class="line-modified">! /***************************************************************************/</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /*  ftobjs.h                                                               */</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /*    The FreeType private base classes (specification).                   */</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /*  Copyright 1996-2018 by                                                 */</span>
<span class="line-modified">! /*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /*  This file is part of the FreeType project, and may only be used,       */</span>
<span class="line-modified">! /*  modified, and distributed under the terms of the FreeType project      */</span>
<span class="line-modified">! /*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<span class="line-modified">! /*  this file you indicate that you have read the license and              */</span>
<span class="line-modified">! /*  understand and accept it fully.                                        */</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /***************************************************************************/</span>
<span class="line-modified">! </span>
<span class="line-modified">! </span>
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*  This file contains the definition of all internal FreeType classes.  */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*************************************************************************/</span>
  
  
  #ifndef FTOBJS_H_
  #define FTOBJS_H_
  
<span class="line-new-header">--- 1,28 ---</span>
<span class="line-modified">! /****************************************************************************</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  * ftobjs.h</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  *   The FreeType private base classes (specification).</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  * Copyright (C) 1996-2019 by</span>
<span class="line-modified">!  * David Turner, Robert Wilhelm, and Werner Lemberg.</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  * This file is part of the FreeType project, and may only be used,</span>
<span class="line-modified">!  * modified, and distributed under the terms of the FreeType project</span>
<span class="line-modified">!  * license, LICENSE.TXT.  By continuing to use, modify, or distribute</span>
<span class="line-modified">!  * this file you indicate that you have read the license and</span>
<span class="line-modified">!  * understand and accept it fully.</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  */</span>
<span class="line-modified">! </span>
<span class="line-modified">! </span>
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * This file contains the definition of all internal FreeType classes.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    */</span>
  
  
  #ifndef FTOBJS_H_
  #define FTOBJS_H_
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 33,25 ***</span>
  #include FT_INTERNAL_MEMORY_H
  #include FT_INTERNAL_GLYPH_LOADER_H
  #include FT_INTERNAL_DRIVER_H
  #include FT_INTERNAL_AUTOHINT_H
  #include FT_INTERNAL_SERVICE_H
<span class="line-removed">- #include FT_INTERNAL_PIC_H</span>
  #include FT_INTERNAL_CALC_H
  
  #ifdef FT_CONFIG_OPTION_INCREMENTAL
  #include FT_INCREMENTAL_H
  #endif
  
  
  FT_BEGIN_HEADER
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* Some generic definitions.                                             */</span>
<span class="line-modified">!   /*                                                                       */</span>
  #ifndef TRUE
  #define TRUE  1
  #endif
  
  #ifndef FALSE
<span class="line-new-header">--- 33,24 ---</span>
  #include FT_INTERNAL_MEMORY_H
  #include FT_INTERNAL_GLYPH_LOADER_H
  #include FT_INTERNAL_DRIVER_H
  #include FT_INTERNAL_AUTOHINT_H
  #include FT_INTERNAL_SERVICE_H
  #include FT_INTERNAL_CALC_H
  
  #ifdef FT_CONFIG_OPTION_INCREMENTAL
  #include FT_INCREMENTAL_H
  #endif
  
  
  FT_BEGIN_HEADER
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * Some generic definitions.</span>
<span class="line-modified">!    */</span>
  #ifndef TRUE
  #define TRUE  1
  #endif
  
  #ifndef FALSE
</pre>
<hr />
<pre>
<span class="line-old-header">*** 61,24 ***</span>
  #ifndef NULL
  #define NULL  (void*)0
  #endif
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* The min and max functions missing in C.  As usual, be careful not to  */</span>
<span class="line-modified">!   /* write things like FT_MIN( a++, b++ ) to avoid side effects.           */</span>
<span class="line-modified">!   /*                                                                       */</span>
  #define FT_MIN( a, b )  ( (a) &lt; (b) ? (a) : (b) )
  #define FT_MAX( a, b )  ( (a) &gt; (b) ? (a) : (b) )
  
  #define FT_ABS( a )     ( (a) &lt; 0 ? -(a) : (a) )
  
    /*
<span class="line-modified">!    *  Approximate sqrt(x*x+y*y) using the `alpha max plus beta min&#39;</span>
<span class="line-modified">!    *  algorithm.  We use alpha = 1, beta = 3/8, giving us results with a</span>
<span class="line-modified">!    *  largest error less than 7% compared to the exact value.</span>
     */
  #define FT_HYPOT( x, y )                 \
            ( x = FT_ABS( x ),             \
              y = FT_ABS( y ),             \
              x &gt; y ? x + ( 3 * y &gt;&gt; 3 )   \
<span class="line-new-header">--- 60,24 ---</span>
  #ifndef NULL
  #define NULL  (void*)0
  #endif
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * The min and max functions missing in C.  As usual, be careful not to</span>
<span class="line-modified">!    * write things like FT_MIN( a++, b++ ) to avoid side effects.</span>
<span class="line-modified">!    */</span>
  #define FT_MIN( a, b )  ( (a) &lt; (b) ? (a) : (b) )
  #define FT_MAX( a, b )  ( (a) &gt; (b) ? (a) : (b) )
  
  #define FT_ABS( a )     ( (a) &lt; 0 ? -(a) : (a) )
  
    /*
<span class="line-modified">!    * Approximate sqrt(x*x+y*y) using the `alpha max plus beta min&#39; algorithm.</span>
<span class="line-modified">!    * We use alpha = 1, beta = 3/8, giving us results with a largest error</span>
<span class="line-modified">!    * less than 7% compared to the exact value.</span>
     */
  #define FT_HYPOT( x, y )                 \
            ( x = FT_ABS( x ),             \
              y = FT_ABS( y ),             \
              x &gt; y ? x + ( 3 * y &gt;&gt; 3 )   \
</pre>
<hr />
<pre>
<span class="line-old-header">*** 109,13 ***</span>
  #define FT_PIX_ROUND_INT32( x )     FT_PIX_FLOOR( ADD_INT32( (x), 32 ) )
  #define FT_PIX_CEIL_INT32( x )      FT_PIX_FLOOR( ADD_INT32( (x), 63 ) )
  
  
    /*
<span class="line-modified">!    *  character classification functions -- since these are used to parse</span>
<span class="line-modified">!    *  font files, we must not use those in &lt;ctypes.h&gt; which are</span>
<span class="line-removed">-    *  locale-dependent</span>
     */
  #define  ft_isdigit( x )   ( ( (unsigned)(x) - &#39;0&#39; ) &lt; 10U )
  
  #define  ft_isxdigit( x )  ( ( (unsigned)(x) - &#39;0&#39; ) &lt; 10U || \
                               ( (unsigned)(x) - &#39;a&#39; ) &lt; 6U  || \
<span class="line-new-header">--- 108,12 ---</span>
  #define FT_PIX_ROUND_INT32( x )     FT_PIX_FLOOR( ADD_INT32( (x), 32 ) )
  #define FT_PIX_CEIL_INT32( x )      FT_PIX_FLOOR( ADD_INT32( (x), 63 ) )
  
  
    /*
<span class="line-modified">!    * character classification functions -- since these are used to parse font</span>
<span class="line-modified">!    * files, we must not use those in &lt;ctypes.h&gt; which are locale-dependent</span>
     */
  #define  ft_isdigit( x )   ( ( (unsigned)(x) - &#39;0&#39; ) &lt; 10U )
  
  #define  ft_isxdigit( x )  ( ( (unsigned)(x) - &#39;0&#39; ) &lt; 10U || \
                               ( (unsigned)(x) - &#39;a&#39; ) &lt; 6U  || \
</pre>
<hr />
<pre>
<span class="line-old-header">*** 185,11 ***</span>
    (*FT_CMap_CharVarIndexFunc)( FT_CMap    cmap,
                                 FT_CMap    unicode_cmap,
                                 FT_UInt32  char_code,
                                 FT_UInt32  variant_selector );
  
<span class="line-modified">!   typedef FT_Bool</span>
    (*FT_CMap_CharVarIsDefaultFunc)( FT_CMap    cmap,
                                     FT_UInt32  char_code,
                                     FT_UInt32  variant_selector );
  
    typedef FT_UInt32 *
<span class="line-new-header">--- 183,11 ---</span>
    (*FT_CMap_CharVarIndexFunc)( FT_CMap    cmap,
                                 FT_CMap    unicode_cmap,
                                 FT_UInt32  char_code,
                                 FT_UInt32  variant_selector );
  
<span class="line-modified">!   typedef FT_Int</span>
    (*FT_CMap_CharVarIsDefaultFunc)( FT_CMap    cmap,
                                     FT_UInt32  char_code,
                                     FT_UInt32  variant_selector );
  
    typedef FT_UInt32 *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 226,12 ***</span>
      FT_CMap_VariantCharListFunc   variantchar_list;
  
    } FT_CMap_ClassRec;
  
  
<span class="line-removed">- #ifndef FT_CONFIG_OPTION_PIC</span>
<span class="line-removed">- </span>
  #define FT_DECLARE_CMAP_CLASS( class_ )              \
    FT_CALLBACK_TABLE const  FT_CMap_ClassRec class_;
  
  #define FT_DEFINE_CMAP_CLASS(       \
            class_,                   \
<span class="line-new-header">--- 224,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 258,49 ***</span>
      variant_list_,                  \
      charvariant_list_,              \
      variantchar_list_               \
    };
  
<span class="line-removed">- #else /* FT_CONFIG_OPTION_PIC */</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define FT_DECLARE_CMAP_CLASS( class_ )                  \</span>
<span class="line-removed">-   void                                                   \</span>
<span class="line-removed">-   FT_Init_Class_ ## class_( FT_Library         library,  \</span>
<span class="line-removed">-                             FT_CMap_ClassRec*  clazz );</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define FT_DEFINE_CMAP_CLASS(                            \</span>
<span class="line-removed">-           class_,                                        \</span>
<span class="line-removed">-           size_,                                         \</span>
<span class="line-removed">-           init_,                                         \</span>
<span class="line-removed">-           done_,                                         \</span>
<span class="line-removed">-           char_index_,                                   \</span>
<span class="line-removed">-           char_next_,                                    \</span>
<span class="line-removed">-           char_var_index_,                               \</span>
<span class="line-removed">-           char_var_default_,                             \</span>
<span class="line-removed">-           variant_list_,                                 \</span>
<span class="line-removed">-           charvariant_list_,                             \</span>
<span class="line-removed">-           variantchar_list_ )                            \</span>
<span class="line-removed">-   void                                                   \</span>
<span class="line-removed">-   FT_Init_Class_ ## class_( FT_Library         library,  \</span>
<span class="line-removed">-                             FT_CMap_ClassRec*  clazz )   \</span>
<span class="line-removed">-   {                                                      \</span>
<span class="line-removed">-     FT_UNUSED( library );                                \</span>
<span class="line-removed">-                                                          \</span>
<span class="line-removed">-     clazz-&gt;size             = size_;                     \</span>
<span class="line-removed">-     clazz-&gt;init             = init_;                     \</span>
<span class="line-removed">-     clazz-&gt;done             = done_;                     \</span>
<span class="line-removed">-     clazz-&gt;char_index       = char_index_;               \</span>
<span class="line-removed">-     clazz-&gt;char_next        = char_next_;                \</span>
<span class="line-removed">-     clazz-&gt;char_var_index   = char_var_index_;           \</span>
<span class="line-removed">-     clazz-&gt;char_var_default = char_var_default_;         \</span>
<span class="line-removed">-     clazz-&gt;variant_list     = variant_list_;             \</span>
<span class="line-removed">-     clazz-&gt;charvariant_list = charvariant_list_;         \</span>
<span class="line-removed">-     clazz-&gt;variantchar_list = variantchar_list_;         \</span>
<span class="line-removed">-   }</span>
<span class="line-removed">- </span>
<span class="line-removed">- #endif /* FT_CONFIG_OPTION_PIC */</span>
<span class="line-removed">- </span>
  
    /* create a new charmap and add it to charmap-&gt;face */
    FT_BASE( FT_Error )
    FT_CMap_New( FT_CMap_Class  clazz,
                 FT_Pointer     init_data,
<span class="line-new-header">--- 254,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 310,99 ***</span>
    /* destroy a charmap and remove it from face&#39;s list */
    FT_BASE( void )
    FT_CMap_Done( FT_CMap  cmap );
  
  
<span class="line-modified">!   /* adds LCD padding to Min and Max boundaries */</span>
    FT_BASE( void )
<span class="line-modified">!   ft_lcd_padding( FT_Pos*       Min,</span>
<span class="line-modified">!                   FT_Pos*       Max,</span>
<span class="line-modified">!                   FT_GlyphSlot  slot );</span>
  
  #ifdef FT_CONFIG_OPTION_SUBPIXEL_RENDERING
  
    typedef void  (*FT_Bitmap_LcdFilterFunc)( FT_Bitmap*      bitmap,
<span class="line-removed">-                                             FT_Render_Mode  render_mode,</span>
                                              FT_Byte*        weights );
  
  
    /* This is the default LCD filter, an in-place, 5-tap FIR filter. */
    FT_BASE( void )
    ft_lcd_filter_fir( FT_Bitmap*           bitmap,
<span class="line-removed">-                      FT_Render_Mode       mode,</span>
                       FT_LcdFiveTapFilter  weights );
  
  #endif /* FT_CONFIG_OPTION_SUBPIXEL_RENDERING */
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified">!   /*    FT_Face_InternalRec                                                */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    This structure contains the internal fields of each FT_Face        */</span>
<span class="line-modified">!   /*    object.  These fields may change between different releases of     */</span>
<span class="line-modified">!   /*    FreeType.                                                          */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified">!   /*    max_points ::                                                      */</span>
<span class="line-modified">!   /*      The maximum number of points used to store the vectorial outline */</span>
<span class="line-modified">!   /*      of any glyph in this face.  If this value cannot be known in     */</span>
<span class="line-modified">!   /*      advance, or if the face isn&#39;t scalable, this should be set to 0. */</span>
<span class="line-modified">!   /*      Only relevant for scalable formats.                              */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    max_contours ::                                                    */</span>
<span class="line-modified">!   /*      The maximum number of contours used to store the vectorial       */</span>
<span class="line-modified">!   /*      outline of any glyph in this face.  If this value cannot be      */</span>
<span class="line-modified">!   /*      known in advance, or if the face isn&#39;t scalable, this should be  */</span>
<span class="line-modified">!   /*      set to 0.  Only relevant for scalable formats.                   */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    transform_matrix ::                                                */</span>
<span class="line-modified">!   /*      A 2x2 matrix of 16.16 coefficients used to transform glyph       */</span>
<span class="line-modified">!   /*      outlines after they are loaded from the font.  Only used by the  */</span>
<span class="line-modified">!   /*      convenience functions.                                           */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    transform_delta ::                                                 */</span>
<span class="line-modified">!   /*      A translation vector used to transform glyph outlines after they */</span>
<span class="line-modified">!   /*      are loaded from the font.  Only used by the convenience          */</span>
<span class="line-modified">!   /*      functions.                                                       */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    transform_flags ::                                                 */</span>
<span class="line-modified">!   /*      Some flags used to classify the transform.  Only used by the     */</span>
<span class="line-modified">!   /*      convenience functions.                                           */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    services ::                                                        */</span>
<span class="line-modified">!   /*      A cache for frequently used services.  It should be only         */</span>
<span class="line-modified">!   /*      accessed with the macro `FT_FACE_LOOKUP_SERVICE&#39;.                */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    incremental_interface ::                                           */</span>
<span class="line-modified">!   /*      If non-null, the interface through which glyph data and metrics  */</span>
<span class="line-modified">!   /*      are loaded incrementally for faces that do not provide all of    */</span>
<span class="line-modified">!   /*      this data when first opened.  This field exists only if          */</span>
<span class="line-modified">!   /*      @FT_CONFIG_OPTION_INCREMENTAL is defined.                        */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    no_stem_darkening ::                                               */</span>
<span class="line-modified">!   /*      Overrides the module-level default, see @stem-darkening[cff],    */</span>
<span class="line-modified">!   /*      for example.  FALSE and TRUE toggle stem darkening on and off,   */</span>
<span class="line-modified">!   /*      respectively, value~-1 means to use the module/driver default.   */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    random_seed ::                                                     */</span>
<span class="line-modified">!   /*      If positive, override the seed value for the CFF `random&#39;        */</span>
<span class="line-modified">!   /*      operator.  Value~0 means to use the font&#39;s value.  Value~-1      */</span>
<span class="line-modified">!   /*      means to use the CFF driver&#39;s default.                           */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    lcd_weights      ::                                                */</span>
<span class="line-modified">!   /*    lcd_filter_func  ::                                                */</span>
<span class="line-modified">!   /*      If subpixel rendering is activated, the LCD filtering weights    */</span>
<span class="line-modified">!   /*      and callback function.                                           */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    refcount ::                                                        */</span>
<span class="line-modified">!   /*      A counter initialized to~1 at the time an @FT_Face structure is  */</span>
<span class="line-modified">!   /*      created.  @FT_Reference_Face increments this counter, and        */</span>
<span class="line-modified">!   /*      @FT_Done_Face only destroys a face if the counter is~1,          */</span>
<span class="line-removed">-   /*      otherwise it simply decrements it.                               */</span>
<span class="line-removed">-   /*                                                                       */</span>
    typedef struct  FT_Face_InternalRec_
    {
      FT_Matrix  transform_matrix;
      FT_Vector  transform_delta;
      FT_Int     transform_flags;
<span class="line-new-header">--- 267,95 ---</span>
    /* destroy a charmap and remove it from face&#39;s list */
    FT_BASE( void )
    FT_CMap_Done( FT_CMap  cmap );
  
  
<span class="line-modified">!   /* add LCD padding to CBox */</span>
    FT_BASE( void )
<span class="line-modified">!   ft_lcd_padding( FT_BBox*        cbox,</span>
<span class="line-modified">!                   FT_GlyphSlot    slot,</span>
<span class="line-modified">!                   FT_Render_Mode  mode );</span>
  
  #ifdef FT_CONFIG_OPTION_SUBPIXEL_RENDERING
  
    typedef void  (*FT_Bitmap_LcdFilterFunc)( FT_Bitmap*      bitmap,
                                              FT_Byte*        weights );
  
  
    /* This is the default LCD filter, an in-place, 5-tap FIR filter. */
    FT_BASE( void )
    ft_lcd_filter_fir( FT_Bitmap*           bitmap,
                       FT_LcdFiveTapFilter  weights );
  
  #endif /* FT_CONFIG_OPTION_SUBPIXEL_RENDERING */
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @struct:</span>
<span class="line-modified">!    *   FT_Face_InternalRec</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @description:</span>
<span class="line-modified">!    *   This structure contains the internal fields of each FT_Face object.</span>
<span class="line-modified">!    *   These fields may change between different releases of FreeType.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @fields:</span>
<span class="line-modified">!    *   max_points ::</span>
<span class="line-modified">!    *     The maximum number of points used to store the vectorial outline of</span>
<span class="line-modified">!    *     any glyph in this face.  If this value cannot be known in advance,</span>
<span class="line-modified">!    *     or if the face isn&#39;t scalable, this should be set to 0.  Only</span>
<span class="line-modified">!    *     relevant for scalable formats.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   max_contours ::</span>
<span class="line-modified">!    *     The maximum number of contours used to store the vectorial outline</span>
<span class="line-modified">!    *     of any glyph in this face.  If this value cannot be known in</span>
<span class="line-modified">!    *     advance, or if the face isn&#39;t scalable, this should be set to 0.</span>
<span class="line-modified">!    *     Only relevant for scalable formats.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   transform_matrix ::</span>
<span class="line-modified">!    *     A 2x2 matrix of 16.16 coefficients used to transform glyph outlines</span>
<span class="line-modified">!    *     after they are loaded from the font.  Only used by the convenience</span>
<span class="line-modified">!    *     functions.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   transform_delta ::</span>
<span class="line-modified">!    *     A translation vector used to transform glyph outlines after they are</span>
<span class="line-modified">!    *     loaded from the font.  Only used by the convenience functions.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   transform_flags ::</span>
<span class="line-modified">!    *     Some flags used to classify the transform.  Only used by the</span>
<span class="line-modified">!    *     convenience functions.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   services ::</span>
<span class="line-modified">!    *     A cache for frequently used services.  It should be only accessed</span>
<span class="line-modified">!    *     with the macro `FT_FACE_LOOKUP_SERVICE`.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   incremental_interface ::</span>
<span class="line-modified">!    *     If non-null, the interface through which glyph data and metrics are</span>
<span class="line-modified">!    *     loaded incrementally for faces that do not provide all of this data</span>
<span class="line-modified">!    *     when first opened.  This field exists only if</span>
<span class="line-modified">!    *     @FT_CONFIG_OPTION_INCREMENTAL is defined.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   no_stem_darkening ::</span>
<span class="line-modified">!    *     Overrides the module-level default, see @stem-darkening[cff], for</span>
<span class="line-modified">!    *     example.  FALSE and TRUE toggle stem darkening on and off,</span>
<span class="line-modified">!    *     respectively, value~-1 means to use the module/driver default.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   random_seed ::</span>
<span class="line-modified">!    *     If positive, override the seed value for the CFF &#39;random&#39; operator.</span>
<span class="line-modified">!    *     Value~0 means to use the font&#39;s value.  Value~-1 means to use the</span>
<span class="line-modified">!    *     CFF driver&#39;s default.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   lcd_weights ::</span>
<span class="line-modified">!    *   lcd_filter_func ::</span>
<span class="line-modified">!    *     These fields specify the LCD filtering weights and callback function</span>
<span class="line-modified">!    *     for ClearType-style subpixel rendering.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   refcount ::</span>
<span class="line-modified">!    *     A counter initialized to~1 at the time an @FT_Face structure is</span>
<span class="line-modified">!    *     created.  @FT_Reference_Face increments this counter, and</span>
<span class="line-modified">!    *     @FT_Done_Face only destroys a face if the counter is~1, otherwise it</span>
<span class="line-modified">!    *     simply decrements it.</span>
<span class="line-modified">!    */</span>
    typedef struct  FT_Face_InternalRec_
    {
      FT_Matrix  transform_matrix;
      FT_Vector  transform_delta;
      FT_Int     transform_flags;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 424,43 ***</span>
      FT_Int  refcount;
  
    } FT_Face_InternalRec;
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified">!   /*    FT_Slot_InternalRec                                                */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    This structure contains the internal fields of each FT_GlyphSlot   */</span>
<span class="line-modified">!   /*    object.  These fields may change between different releases of     */</span>
<span class="line-modified">!   /*    FreeType.                                                          */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified">!   /*    loader            :: The glyph loader object used to load outlines */</span>
<span class="line-modified">!   /*                         into the glyph slot.                          */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    flags             :: Possible values are zero or                   */</span>
<span class="line-modified">!   /*                         FT_GLYPH_OWN_BITMAP.  The latter indicates    */</span>
<span class="line-modified">!   /*                         that the FT_GlyphSlot structure owns the      */</span>
<span class="line-modified">!   /*                         bitmap buffer.                                */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    glyph_transformed :: Boolean.  Set to TRUE when the loaded glyph   */</span>
<span class="line-modified">!   /*                         must be transformed through a specific        */</span>
<span class="line-modified">!   /*                         font transformation.  This is _not_ the same  */</span>
<span class="line-modified">!   /*                         as the face transform set through             */</span>
<span class="line-modified">!   /*                         FT_Set_Transform().                           */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    glyph_matrix      :: The 2x2 matrix corresponding to the glyph     */</span>
<span class="line-modified">!   /*                         transformation, if necessary.                 */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    glyph_delta       :: The 2d translation vector corresponding to    */</span>
<span class="line-modified">!   /*                         the glyph transformation, if necessary.       */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    glyph_hints       :: Format-specific glyph hints management.       */</span>
<span class="line-modified">!   /*                                                                       */</span>
  
  #define FT_GLYPH_OWN_BITMAP  0x1U
  
    typedef struct  FT_Slot_InternalRec_
    {
<span class="line-new-header">--- 377,48 ---</span>
      FT_Int  refcount;
  
    } FT_Face_InternalRec;
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @struct:</span>
<span class="line-modified">!    *   FT_Slot_InternalRec</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @description:</span>
<span class="line-modified">!    *   This structure contains the internal fields of each FT_GlyphSlot</span>
<span class="line-modified">!    *   object.  These fields may change between different releases of</span>
<span class="line-modified">!    *   FreeType.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @fields:</span>
<span class="line-modified">!    *   loader ::</span>
<span class="line-modified">!    *     The glyph loader object used to load outlines into the glyph slot.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   flags ::</span>
<span class="line-modified">!    *     Possible values are zero or FT_GLYPH_OWN_BITMAP.  The latter</span>
<span class="line-modified">!    *     indicates that the FT_GlyphSlot structure owns the bitmap buffer.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   glyph_transformed ::</span>
<span class="line-modified">!    *     Boolean.  Set to TRUE when the loaded glyph must be transformed</span>
<span class="line-modified">!    *     through a specific font transformation.  This is _not_ the same as</span>
<span class="line-modified">!    *     the face transform set through FT_Set_Transform().</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   glyph_matrix ::</span>
<span class="line-modified">!    *     The 2x2 matrix corresponding to the glyph transformation, if</span>
<span class="line-modified">!    *     necessary.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   glyph_delta ::</span>
<span class="line-modified">!    *     The 2d translation vector corresponding to the glyph transformation,</span>
<span class="line-modified">!    *     if necessary.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   glyph_hints ::</span>
<span class="line-modified">!    *     Format-specific glyph hints management.</span>
<span class="line-added">+    *</span>
<span class="line-added">+    *   load_flags ::</span>
<span class="line-added">+    *     The load flags passed as an argument to @FT_Load_Glyph while</span>
<span class="line-added">+    *     initializing the glyph slot.</span>
<span class="line-added">+    */</span>
  
  #define FT_GLYPH_OWN_BITMAP  0x1U
  
    typedef struct  FT_Slot_InternalRec_
    {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 469,30 ***</span>
      FT_Bool         glyph_transformed;
      FT_Matrix       glyph_matrix;
      FT_Vector       glyph_delta;
      void*           glyph_hints;
  
    } FT_GlyphSlot_InternalRec;
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified">!   /*    FT_Size_InternalRec                                                */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    This structure contains the internal fields of each FT_Size        */</span>
<span class="line-modified">!   /*    object.                                                            */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified">!   /*    module_data      :: Data specific to a driver module.              */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    autohint_mode    :: The used auto-hinting mode.                    */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    autohint_metrics :: Metrics used by the auto-hinter.               */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*************************************************************************/</span>
  
    typedef struct  FT_Size_InternalRec_
    {
      void*  module_data;
  
<span class="line-new-header">--- 427,34 ---</span>
      FT_Bool         glyph_transformed;
      FT_Matrix       glyph_matrix;
      FT_Vector       glyph_delta;
      void*           glyph_hints;
  
<span class="line-added">+     FT_Int32        load_flags;</span>
<span class="line-added">+ </span>
    } FT_GlyphSlot_InternalRec;
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @struct:</span>
<span class="line-modified">!    *   FT_Size_InternalRec</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @description:</span>
<span class="line-modified">!    *   This structure contains the internal fields of each FT_Size object.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @fields:</span>
<span class="line-modified">!    *   module_data ::</span>
<span class="line-modified">!    *     Data specific to a driver module.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   autohint_mode ::</span>
<span class="line-modified">!    *     The used auto-hinting mode.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   autohint_metrics ::</span>
<span class="line-modified">!    *     Metrics used by the auto-hinter.</span>
<span class="line-added">+    *</span>
<span class="line-added">+    */</span>
  
    typedef struct  FT_Size_InternalRec_
    {
      void*  module_data;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 513,25 ***</span>
    /*************************************************************************/
    /*************************************************************************/
    /*************************************************************************/
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified">!   /*    FT_ModuleRec                                                       */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    A module object instance.                                          */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified">!   /*    clazz   :: A pointer to the module&#39;s class.                        */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    library :: A handle to the parent library object.                  */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    memory  :: A handle to the memory manager.                         */</span>
<span class="line-modified">!   /*                                                                       */</span>
    typedef struct  FT_ModuleRec_
    {
      FT_Module_Class*  clazz;
      FT_Library        library;
      FT_Memory         memory;
<span class="line-new-header">--- 475,28 ---</span>
    /*************************************************************************/
    /*************************************************************************/
    /*************************************************************************/
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @struct:</span>
<span class="line-modified">!    *   FT_ModuleRec</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @description:</span>
<span class="line-modified">!    *   A module object instance.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @fields:</span>
<span class="line-modified">!    *   clazz ::</span>
<span class="line-modified">!    *     A pointer to the module&#39;s class.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   library ::</span>
<span class="line-modified">!    *     A handle to the parent library object.</span>
<span class="line-modified">!    *</span>
<span class="line-added">+    *   memory ::</span>
<span class="line-added">+    *     A handle to the memory manager.</span>
<span class="line-added">+    */</span>
    typedef struct  FT_ModuleRec_
    {
      FT_Module_Class*  clazz;
      FT_Library        library;
      FT_Memory         memory;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 570,31 ***</span>
  
  #define FT_DRIVER_HINTS_LIGHTLY( x )  ( FT_MODULE_CLASS( x )-&gt;module_flags &amp; \
                                          FT_MODULE_DRIVER_HINTS_LIGHTLY )
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Function&gt;                                                            */</span>
<span class="line-modified">!   /*    FT_Get_Module_Interface                                            */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    Finds a module and returns its specific interface as a typeless    */</span>
<span class="line-modified">!   /*    pointer.                                                           */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Input&gt;                                                               */</span>
<span class="line-modified">!   /*    library     :: A handle to the library object.                     */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    module_name :: The module&#39;s name (as an ASCII string).             */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Return&gt;                                                              */</span>
<span class="line-modified">!   /*    A module-specific interface if available, 0 otherwise.             */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Note&gt;                                                                */</span>
<span class="line-modified">!   /*    You should better be familiar with FreeType internals to know      */</span>
<span class="line-modified">!   /*    which module to look for, and what its interface is :-)            */</span>
<span class="line-modified">!   /*                                                                       */</span>
    FT_BASE( const void* )
    FT_Get_Module_Interface( FT_Library   library,
                             const char*  mod_name );
  
    FT_BASE( FT_Pointer )
<span class="line-new-header">--- 535,33 ---</span>
  
  #define FT_DRIVER_HINTS_LIGHTLY( x )  ( FT_MODULE_CLASS( x )-&gt;module_flags &amp; \
                                          FT_MODULE_DRIVER_HINTS_LIGHTLY )
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @function:</span>
<span class="line-modified">!    *   FT_Get_Module_Interface</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @description:</span>
<span class="line-modified">!    *   Finds a module and returns its specific interface as a typeless</span>
<span class="line-modified">!    *   pointer.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @input:</span>
<span class="line-modified">!    *   library ::</span>
<span class="line-modified">!    *     A handle to the library object.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   module_name ::</span>
<span class="line-modified">!    *     The module&#39;s name (as an ASCII string).</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @return:</span>
<span class="line-modified">!    *   A module-specific interface if available, 0 otherwise.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @note:</span>
<span class="line-modified">!    *   You should better be familiar with FreeType internals to know which</span>
<span class="line-added">+    *   module to look for, and what its interface is :-)</span>
<span class="line-added">+    */</span>
    FT_BASE( const void* )
    FT_Get_Module_Interface( FT_Library   library,
                             const char*  mod_name );
  
    FT_BASE( FT_Pointer )
</pre>
<hr />
<pre>
<span class="line-old-header">*** 641,48 ***</span>
  
  #define FT_FACE_SLOT( x )     FT_FACE( x )-&gt;glyph
  #define FT_FACE_SIZE( x )     FT_FACE( x )-&gt;size
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Function&gt;                                                            */</span>
<span class="line-modified">!   /*    FT_New_GlyphSlot                                                   */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    It is sometimes useful to have more than one glyph slot for a      */</span>
<span class="line-modified">!   /*    given face object.  This function is used to create additional     */</span>
<span class="line-modified">!   /*    slots.  All of them are automatically discarded when the face is   */</span>
<span class="line-modified">!   /*    destroyed.                                                         */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Input&gt;                                                               */</span>
<span class="line-modified">!   /*    face  :: A handle to a parent face object.                         */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Output&gt;                                                              */</span>
<span class="line-modified">!   /*    aslot :: A handle to a new glyph slot object.                      */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Return&gt;                                                              */</span>
<span class="line-modified">!   /*    FreeType error code.  0 means success.                             */</span>
<span class="line-modified">!   /*                                                                       */</span>
    FT_BASE( FT_Error )
    FT_New_GlyphSlot( FT_Face        face,
                      FT_GlyphSlot  *aslot );
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Function&gt;                                                            */</span>
<span class="line-modified">!   /*    FT_Done_GlyphSlot                                                  */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    Destroys a given glyph slot.  Remember however that all slots are  */</span>
<span class="line-modified">!   /*    automatically destroyed with its parent.  Using this function is   */</span>
<span class="line-modified">!   /*    not always mandatory.                                              */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Input&gt;                                                               */</span>
<span class="line-modified">!   /*    slot :: A handle to a target glyph slot.                           */</span>
<span class="line-modified">!   /*                                                                       */</span>
    FT_BASE( void )
    FT_Done_GlyphSlot( FT_GlyphSlot  slot );
  
   /* */
  
<span class="line-new-header">--- 608,50 ---</span>
  
  #define FT_FACE_SLOT( x )     FT_FACE( x )-&gt;glyph
  #define FT_FACE_SIZE( x )     FT_FACE( x )-&gt;size
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @function:</span>
<span class="line-modified">!    *   FT_New_GlyphSlot</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @description:</span>
<span class="line-modified">!    *   It is sometimes useful to have more than one glyph slot for a given</span>
<span class="line-modified">!    *   face object.  This function is used to create additional slots.  All</span>
<span class="line-modified">!    *   of them are automatically discarded when the face is destroyed.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @input:</span>
<span class="line-modified">!    *   face ::</span>
<span class="line-modified">!    *     A handle to a parent face object.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @output:</span>
<span class="line-modified">!    *   aslot ::</span>
<span class="line-modified">!    *     A handle to a new glyph slot object.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @return:</span>
<span class="line-modified">!    *   FreeType error code.  0 means success.</span>
<span class="line-added">+    */</span>
    FT_BASE( FT_Error )
    FT_New_GlyphSlot( FT_Face        face,
                      FT_GlyphSlot  *aslot );
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @function:</span>
<span class="line-modified">!    *   FT_Done_GlyphSlot</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @description:</span>
<span class="line-modified">!    *   Destroys a given glyph slot.  Remember however that all slots are</span>
<span class="line-modified">!    *   automatically destroyed with its parent.  Using this function is not</span>
<span class="line-modified">!    *   always mandatory.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @input:</span>
<span class="line-modified">!    *   slot ::</span>
<span class="line-modified">!    *     A handle to a target glyph slot.</span>
<span class="line-added">+    */</span>
    FT_BASE( void )
    FT_Done_GlyphSlot( FT_GlyphSlot  slot );
  
   /* */
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 728,12 ***</span>
    /* was allocated with ft_glyphslot_alloc_bitmap).                       */
    FT_BASE( void )
    ft_glyphslot_free_bitmap( FT_GlyphSlot  slot );
  
  
<span class="line-modified">!   /* Preset bitmap metrics of an outline glyphslot prior to rendering. */</span>
<span class="line-modified">!   FT_BASE( void )</span>
    ft_glyphslot_preset_bitmap( FT_GlyphSlot      slot,
                                FT_Render_Mode    mode,
                                const FT_Vector*  origin );
  
    /* Allocate a new bitmap buffer in a glyph slot. */
<span class="line-new-header">--- 697,13 ---</span>
    /* was allocated with ft_glyphslot_alloc_bitmap).                       */
    FT_BASE( void )
    ft_glyphslot_free_bitmap( FT_GlyphSlot  slot );
  
  
<span class="line-modified">!   /* Preset bitmap metrics of an outline glyphslot prior to rendering */</span>
<span class="line-modified">!   /* and check whether the truncated bbox is too large for rendering. */</span>
<span class="line-added">+   FT_BASE( FT_Bool )</span>
    ft_glyphslot_preset_bitmap( FT_GlyphSlot      slot,
                                FT_Render_Mode    mode,
                                const FT_Vector*  origin );
  
    /* Allocate a new bitmap buffer in a glyph slot. */
</pre>
<hr />
<pre>
<span class="line-old-header">*** 800,32 ***</span>
  
    /* typecast a module as a driver, and get its driver class */
  #define FT_DRIVER_CLASS( x )  FT_DRIVER( x )-&gt;clazz
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified">!   /*    FT_DriverRec                                                       */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    The root font driver class.  A font driver is responsible for      */</span>
<span class="line-modified">!   /*    managing and loading font files of a given format.                 */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*  &lt;Fields&gt;                                                             */</span>
<span class="line-modified">!   /*     root         :: Contains the fields of the root module class.     */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*     clazz        :: A pointer to the font driver&#39;s class.  Note that  */</span>
<span class="line-modified">!   /*                     this is NOT root.clazz.  `class&#39; wasn&#39;t used      */</span>
<span class="line-modified">!   /*                     as it is a reserved word in C++.                  */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*     faces_list   :: The list of faces currently opened by this        */</span>
<span class="line-modified">!   /*                     driver.                                           */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*     glyph_loader :: Unused.  Used to be glyph loader for all faces    */</span>
<span class="line-modified">!   /*                     managed by this driver.                           */</span>
<span class="line-modified">!   /*                                                                       */</span>
    typedef struct  FT_DriverRec_
    {
      FT_ModuleRec     root;
      FT_Driver_Class  clazz;
      FT_ListRec       faces_list;
<span class="line-new-header">--- 770,34 ---</span>
  
    /* typecast a module as a driver, and get its driver class */
  #define FT_DRIVER_CLASS( x )  FT_DRIVER( x )-&gt;clazz
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @struct:</span>
<span class="line-modified">!    *   FT_DriverRec</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @description:</span>
<span class="line-modified">!    *   The root font driver class.  A font driver is responsible for managing</span>
<span class="line-modified">!    *   and loading font files of a given format.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @fields:</span>
<span class="line-modified">!    *   root ::</span>
<span class="line-modified">!    *     Contains the fields of the root module class.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   clazz ::</span>
<span class="line-modified">!    *     A pointer to the font driver&#39;s class.  Note that this is NOT</span>
<span class="line-modified">!    *     root.clazz.  &#39;class&#39; wasn&#39;t used as it is a reserved word in C++.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   faces_list ::</span>
<span class="line-modified">!    *     The list of faces currently opened by this driver.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   glyph_loader ::</span>
<span class="line-modified">!    *     Unused.  Used to be glyph loader for all faces managed by this</span>
<span class="line-added">+    *     driver.</span>
<span class="line-added">+    */</span>
    typedef struct  FT_DriverRec_
    {
      FT_ModuleRec     root;
      FT_Driver_Class  clazz;
      FT_ListRec       faces_list;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 845,76 ***</span>
    /*************************************************************************/
    /*************************************************************************/
    /*************************************************************************/
  
  
<span class="line-modified">!   /* This hook is used by the TrueType debugger.  It must be set to an */</span>
<span class="line-modified">!   /* alternate truetype bytecode interpreter function.                 */</span>
<span class="line-modified">! #define FT_DEBUG_HOOK_TRUETYPE  0</span>
<span class="line-modified">! </span>
<span class="line-modified">! </span>
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified">!   /*    FT_LibraryRec                                                      */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    The FreeType library class.  This is the root of all FreeType      */</span>
<span class="line-modified">!   /*    data.  Use FT_New_Library() to create a library object, and        */</span>
<span class="line-modified">!   /*    FT_Done_Library() to discard it and all child objects.             */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified">!   /*    memory           :: The library&#39;s memory object.  Manages memory   */</span>
<span class="line-modified">!   /*                        allocation.                                    */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    version_major    :: The major version number of the library.       */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    version_minor    :: The minor version number of the library.       */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    version_patch    :: The current patch level of the library.        */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    num_modules      :: The number of modules currently registered     */</span>
<span class="line-modified">!   /*                        within this library.  This is set to 0 for new */</span>
<span class="line-modified">!   /*                        libraries.  New modules are added through the  */</span>
<span class="line-modified">!   /*                        FT_Add_Module() API function.                  */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    modules          :: A table used to store handles to the currently */</span>
<span class="line-modified">!   /*                        registered modules. Note that each font driver */</span>
<span class="line-modified">!   /*                        contains a list of its opened faces.           */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    renderers        :: The list of renderers currently registered     */</span>
<span class="line-modified">!   /*                        within the library.                            */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    cur_renderer     :: The current outline renderer.  This is a       */</span>
<span class="line-modified">!   /*                        shortcut used to avoid parsing the list on     */</span>
<span class="line-modified">!   /*                        each call to FT_Outline_Render().  It is a     */</span>
<span class="line-modified">!   /*                        handle to the current renderer for the         */</span>
<span class="line-modified">!   /*                        FT_GLYPH_FORMAT_OUTLINE format.                */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    auto_hinter      :: The auto-hinter module interface.              */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    debug_hooks      :: An array of four function pointers that allow  */</span>
<span class="line-modified">!   /*                        debuggers to hook into a font format&#39;s         */</span>
<span class="line-modified">!   /*                        interpreter.  Currently, only the TrueType     */</span>
<span class="line-modified">!   /*                        bytecode debugger uses this.                   */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    lcd_weights      :: If subpixel rendering is activated, the LCD    */</span>
<span class="line-modified">!   /*                        filter weights, if any.                        */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    lcd_filter_func  :: If subpixel rendering is activated, the LCD    */</span>
<span class="line-modified">!   /*                        filtering callback function.                   */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    pic_container    :: Contains global structs and tables, instead    */</span>
<span class="line-modified">!   /*                        of defining them globally.                     */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    refcount         :: A counter initialized to~1 at the time an      */</span>
<span class="line-modified">!   /*                        @FT_Library structure is created.              */</span>
<span class="line-modified">!   /*                        @FT_Reference_Library increments this counter, */</span>
<span class="line-modified">!   /*                        and @FT_Done_Library only destroys a library   */</span>
<span class="line-modified">!   /*                        if the counter is~1, otherwise it simply       */</span>
<span class="line-modified">!   /*                        decrements it.                                 */</span>
<span class="line-modified">!   /*                                                                       */</span>
    typedef struct  FT_LibraryRec_
    {
      FT_Memory          memory;           /* library&#39;s memory manager */
  
      FT_Int             version_major;
<span class="line-new-header">--- 817,81 ---</span>
    /*************************************************************************/
    /*************************************************************************/
    /*************************************************************************/
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @struct:</span>
<span class="line-modified">!    *   FT_LibraryRec</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @description:</span>
<span class="line-modified">!    *   The FreeType library class.  This is the root of all FreeType data.</span>
<span class="line-modified">!    *   Use FT_New_Library() to create a library object, and FT_Done_Library()</span>
<span class="line-modified">!    *   to discard it and all child objects.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @fields:</span>
<span class="line-modified">!    *   memory ::</span>
<span class="line-modified">!    *     The library&#39;s memory object.  Manages memory allocation.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   version_major ::</span>
<span class="line-modified">!    *     The major version number of the library.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   version_minor ::</span>
<span class="line-modified">!    *     The minor version number of the library.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   version_patch ::</span>
<span class="line-modified">!    *     The current patch level of the library.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   num_modules ::</span>
<span class="line-modified">!    *     The number of modules currently registered within this library.</span>
<span class="line-modified">!    *     This is set to 0 for new libraries.  New modules are added through</span>
<span class="line-modified">!    *     the FT_Add_Module() API function.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   modules ::</span>
<span class="line-modified">!    *     A table used to store handles to the currently registered</span>
<span class="line-modified">!    *     modules. Note that each font driver contains a list of its opened</span>
<span class="line-modified">!    *     faces.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   renderers ::</span>
<span class="line-modified">!    *     The list of renderers currently registered within the library.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   cur_renderer ::</span>
<span class="line-modified">!    *     The current outline renderer.  This is a shortcut used to avoid</span>
<span class="line-modified">!    *     parsing the list on each call to FT_Outline_Render().  It is a</span>
<span class="line-modified">!    *     handle to the current renderer for the FT_GLYPH_FORMAT_OUTLINE</span>
<span class="line-modified">!    *     format.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   auto_hinter ::</span>
<span class="line-modified">!    *     The auto-hinter module interface.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   debug_hooks ::</span>
<span class="line-modified">!    *     An array of four function pointers that allow debuggers to hook into</span>
<span class="line-modified">!    *     a font format&#39;s interpreter.  Currently, only the TrueType bytecode</span>
<span class="line-modified">!    *     debugger uses this.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   lcd_weights ::</span>
<span class="line-modified">!    *     The LCD filter weights for ClearType-style subpixel rendering.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   lcd_filter_func ::</span>
<span class="line-modified">!    *     The LCD filtering callback function for for ClearType-style subpixel</span>
<span class="line-modified">!    *     rendering.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   lcd_geometry ::</span>
<span class="line-modified">!    *     This array specifies LCD subpixel geometry and controls Harmony LCD</span>
<span class="line-modified">!    *     rendering technique, alternative to ClearType.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   pic_container ::</span>
<span class="line-modified">!    *     Contains global structs and tables, instead of defining them</span>
<span class="line-modified">!    *     globally.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   refcount ::</span>
<span class="line-added">+    *     A counter initialized to~1 at the time an @FT_Library structure is</span>
<span class="line-added">+    *     created.  @FT_Reference_Library increments this counter, and</span>
<span class="line-added">+    *     @FT_Done_Library only destroys a library if the counter is~1,</span>
<span class="line-added">+    *     otherwise it simply decrements it.</span>
<span class="line-added">+    */</span>
    typedef struct  FT_LibraryRec_
    {
      FT_Memory          memory;           /* library&#39;s memory manager */
  
      FT_Int             version_major;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 931,14 ***</span>
      FT_DebugHook_Func  debug_hooks[4];
  
  #ifdef FT_CONFIG_OPTION_SUBPIXEL_RENDERING
      FT_LcdFiveTapFilter      lcd_weights;      /* filter weights, if any */
      FT_Bitmap_LcdFilterFunc  lcd_filter_func;  /* filtering callback     */
<span class="line-modified">! #endif</span>
<span class="line-modified">! </span>
<span class="line-removed">- #ifdef FT_CONFIG_OPTION_PIC</span>
<span class="line-removed">-     FT_PIC_Container   pic_container;</span>
  #endif
  
      FT_Int             refcount;
  
    } FT_LibraryRec;
<span class="line-new-header">--- 908,12 ---</span>
      FT_DebugHook_Func  debug_hooks[4];
  
  #ifdef FT_CONFIG_OPTION_SUBPIXEL_RENDERING
      FT_LcdFiveTapFilter      lcd_weights;      /* filter weights, if any */
      FT_Bitmap_LcdFilterFunc  lcd_filter_func;  /* filtering callback     */
<span class="line-modified">! #else</span>
<span class="line-modified">!     FT_Vector                lcd_geometry[3];  /* RGB subpixel positions */</span>
  #endif
  
      FT_Int             refcount;
  
    } FT_LibraryRec;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 962,42 ***</span>
                                 FT_UInt     glyph_index,
                                 FT_Pointer  buffer,
                                 FT_UInt     buffer_max );
  
    typedef FT_UInt
<span class="line-modified">!   (*FT_Face_GetGlyphNameIndexFunc)( FT_Face     face,</span>
<span class="line-modified">!                                     FT_String*  glyph_name );</span>
  
  
  #ifndef FT_CONFIG_OPTION_NO_DEFAULT_SYSTEM
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Function&gt;                                                            */</span>
<span class="line-modified">!   /*    FT_New_Memory                                                      */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    Creates a new memory object.                                       */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Return&gt;                                                              */</span>
<span class="line-modified">!   /*    A pointer to the new memory object.  0 in case of error.           */</span>
<span class="line-modified">!   /*                                                                       */</span>
    FT_BASE( FT_Memory )
    FT_New_Memory( void );
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Function&gt;                                                            */</span>
<span class="line-modified">!   /*    FT_Done_Memory                                                     */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    Discards memory manager.                                           */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Input&gt;                                                               */</span>
<span class="line-modified">!   /*    memory :: A handle to the memory manager.                          */</span>
<span class="line-modified">!   /*                                                                       */</span>
    FT_BASE( void )
    FT_Done_Memory( FT_Memory  memory );
  
  #endif /* !FT_CONFIG_OPTION_NO_DEFAULT_SYSTEM */
  
<span class="line-new-header">--- 937,43 ---</span>
                                 FT_UInt     glyph_index,
                                 FT_Pointer  buffer,
                                 FT_UInt     buffer_max );
  
    typedef FT_UInt
<span class="line-modified">!   (*FT_Face_GetGlyphNameIndexFunc)( FT_Face           face,</span>
<span class="line-modified">!                                     const FT_String*  glyph_name );</span>
  
  
  #ifndef FT_CONFIG_OPTION_NO_DEFAULT_SYSTEM
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @function:</span>
<span class="line-modified">!    *   FT_New_Memory</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @description:</span>
<span class="line-modified">!    *   Creates a new memory object.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @return:</span>
<span class="line-modified">!    *   A pointer to the new memory object.  0 in case of error.</span>
<span class="line-modified">!    */</span>
    FT_BASE( FT_Memory )
    FT_New_Memory( void );
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @function:</span>
<span class="line-modified">!    *   FT_Done_Memory</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @description:</span>
<span class="line-modified">!    *   Discards memory manager.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @input:</span>
<span class="line-modified">!    *   memory ::</span>
<span class="line-modified">!    *     A handle to the memory manager.</span>
<span class="line-added">+    */</span>
    FT_BASE( void )
    FT_Done_Memory( FT_Memory  memory );
  
  #endif /* !FT_CONFIG_OPTION_NO_DEFAULT_SYSTEM */
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1011,41 ***</span>
  #ifndef FT_NO_DEFAULT_RASTER
    FT_EXPORT_VAR( FT_Raster_Funcs )  ft_default_raster;
  #endif
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /****                                                                 ****/</span>
<span class="line-modified">!   /****                                                                 ****/</span>
<span class="line-modified">!   /****                      P I C   S U P P O R T                      ****/</span>
<span class="line-modified">!   /****                                                                 ****/</span>
<span class="line-modified">!   /****                                                                 ****/</span>
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-removed">-   /*************************************************************************/</span>
<span class="line-removed">- </span>
<span class="line-removed">- </span>
<span class="line-removed">-   /* PIC support macros for ftimage.h */</span>
<span class="line-removed">- </span>
<span class="line-removed">- </span>
<span class="line-removed">-   /*************************************************************************/</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Macro&gt;                                                               */</span>
<span class="line-removed">-   /*    FT_DEFINE_OUTLINE_FUNCS                                            */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Description&gt;                                                         */</span>
<span class="line-removed">-   /*    Used to initialize an instance of FT_Outline_Funcs struct.         */</span>
<span class="line-removed">-   /*    When FT_CONFIG_OPTION_PIC is defined an init function will need    */</span>
<span class="line-removed">-   /*    to be called with a pre-allocated structure to be filled.          */</span>
<span class="line-removed">-   /*    When FT_CONFIG_OPTION_PIC is not defined the struct will be        */</span>
<span class="line-removed">-   /*    allocated in the global scope (or the scope where the macro        */</span>
<span class="line-removed">-   /*    is used).                                                          */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">- #ifndef FT_CONFIG_OPTION_PIC</span>
<span class="line-removed">- </span>
  #define FT_DEFINE_OUTLINE_FUNCS(           \
            class_,                          \
            move_to_,                        \
            line_to_,                        \
            conic_to_,                       \
<span class="line-new-header">--- 987,20 ---</span>
  #ifndef FT_NO_DEFAULT_RASTER
    FT_EXPORT_VAR( FT_Raster_Funcs )  ft_default_raster;
  #endif
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @macro:</span>
<span class="line-modified">!    *   FT_DEFINE_OUTLINE_FUNCS</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @description:</span>
<span class="line-modified">!    *   Used to initialize an instance of FT_Outline_Funcs struct.  The struct</span>
<span class="line-modified">!    *   will be allocated in the global scope (or the scope where the macro is</span>
<span class="line-modified">!    *   used).</span>
<span class="line-modified">!    */</span>
  #define FT_DEFINE_OUTLINE_FUNCS(           \
            class_,                          \
            move_to_,                        \
            line_to_,                        \
            conic_to_,                       \
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1060,51 ***</span>
      cubic_to_,                             \
      shift_,                                \
      delta_                                 \
    };
  
<span class="line-removed">- #else /* FT_CONFIG_OPTION_PIC */</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define FT_DEFINE_OUTLINE_FUNCS(                     \</span>
<span class="line-removed">-           class_,                                    \</span>
<span class="line-removed">-           move_to_,                                  \</span>
<span class="line-removed">-           line_to_,                                  \</span>
<span class="line-removed">-           conic_to_,                                 \</span>
<span class="line-removed">-           cubic_to_,                                 \</span>
<span class="line-removed">-           shift_,                                    \</span>
<span class="line-removed">-           delta_ )                                   \</span>
<span class="line-removed">-   static FT_Error                                    \</span>
<span class="line-removed">-   Init_Class_ ## class_( FT_Outline_Funcs*  clazz )  \</span>
<span class="line-removed">-   {                                                  \</span>
<span class="line-removed">-     clazz-&gt;move_to  = move_to_;                      \</span>
<span class="line-removed">-     clazz-&gt;line_to  = line_to_;                      \</span>
<span class="line-removed">-     clazz-&gt;conic_to = conic_to_;                     \</span>
<span class="line-removed">-     clazz-&gt;cubic_to = cubic_to_;                     \</span>
<span class="line-removed">-     clazz-&gt;shift    = shift_;                        \</span>
<span class="line-removed">-     clazz-&gt;delta    = delta_;                        \</span>
<span class="line-removed">-                                                      \</span>
<span class="line-removed">-     return FT_Err_Ok;                                \</span>
<span class="line-removed">-   }</span>
<span class="line-removed">- </span>
<span class="line-removed">- #endif /* FT_CONFIG_OPTION_PIC */</span>
<span class="line-removed">- </span>
<span class="line-removed">- </span>
<span class="line-removed">-   /*************************************************************************/</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Macro&gt;                                                               */</span>
<span class="line-removed">-   /*    FT_DEFINE_RASTER_FUNCS                                             */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Description&gt;                                                         */</span>
<span class="line-removed">-   /*    Used to initialize an instance of FT_Raster_Funcs struct.          */</span>
<span class="line-removed">-   /*    When FT_CONFIG_OPTION_PIC is defined an init function will need    */</span>
<span class="line-removed">-   /*    to be called with a pre-allocated structure to be filled.          */</span>
<span class="line-removed">-   /*    When FT_CONFIG_OPTION_PIC is not defined the struct will be        */</span>
<span class="line-removed">-   /*    allocated in the global scope (or the scope where the macro        */</span>
<span class="line-removed">-   /*    is used).                                                          */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">- #ifndef FT_CONFIG_OPTION_PIC</span>
  
  #define FT_DEFINE_RASTER_FUNCS(    \
            class_,                  \
            glyph_format_,           \
            raster_new_,             \
            raster_reset_,           \
<span class="line-new-header">--- 1015,21 ---</span>
      cubic_to_,                             \
      shift_,                                \
      delta_                                 \
    };
  
  
<span class="line-added">+   /**************************************************************************</span>
<span class="line-added">+    *</span>
<span class="line-added">+    * @macro:</span>
<span class="line-added">+    *   FT_DEFINE_RASTER_FUNCS</span>
<span class="line-added">+    *</span>
<span class="line-added">+    * @description:</span>
<span class="line-added">+    *   Used to initialize an instance of FT_Raster_Funcs struct.  The struct</span>
<span class="line-added">+    *   will be allocated in the global scope (or the scope where the macro is</span>
<span class="line-added">+    *   used).</span>
<span class="line-added">+    */</span>
  #define FT_DEFINE_RASTER_FUNCS(    \
            class_,                  \
            glyph_format_,           \
            raster_new_,             \
            raster_reset_,           \
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1119,52 ***</span>
      raster_set_mode_,              \
      raster_render_,                \
      raster_done_                   \
    };
  
<span class="line-removed">- #else /* FT_CONFIG_OPTION_PIC */</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define FT_DEFINE_RASTER_FUNCS(                        \</span>
<span class="line-removed">-           class_,                                      \</span>
<span class="line-removed">-           glyph_format_,                               \</span>
<span class="line-removed">-           raster_new_,                                 \</span>
<span class="line-removed">-           raster_reset_,                               \</span>
<span class="line-removed">-           raster_set_mode_,                            \</span>
<span class="line-removed">-           raster_render_,                              \</span>
<span class="line-removed">-           raster_done_ )                               \</span>
<span class="line-removed">-   void                                                 \</span>
<span class="line-removed">-   FT_Init_Class_ ## class_( FT_Raster_Funcs*  clazz )  \</span>
<span class="line-removed">-   {                                                    \</span>
<span class="line-removed">-     clazz-&gt;glyph_format    = glyph_format_;            \</span>
<span class="line-removed">-     clazz-&gt;raster_new      = raster_new_;              \</span>
<span class="line-removed">-     clazz-&gt;raster_reset    = raster_reset_;            \</span>
<span class="line-removed">-     clazz-&gt;raster_set_mode = raster_set_mode_;         \</span>
<span class="line-removed">-     clazz-&gt;raster_render   = raster_render_;           \</span>
<span class="line-removed">-     clazz-&gt;raster_done     = raster_done_;             \</span>
<span class="line-removed">-   }</span>
<span class="line-removed">- </span>
<span class="line-removed">- #endif /* FT_CONFIG_OPTION_PIC */</span>
  
  
<span class="line-modified">!   /* PIC support macros for ftrender.h */</span>
<span class="line-modified">! </span>
<span class="line-modified">! </span>
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Macro&gt;                                                               */</span>
<span class="line-modified">!   /*    FT_DEFINE_GLYPH                                                    */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-removed">-   /*    Used to initialize an instance of FT_Glyph_Class struct.           */</span>
<span class="line-removed">-   /*    When FT_CONFIG_OPTION_PIC is defined an init function will need    */</span>
<span class="line-removed">-   /*    to be called with a pre-allocated structure to be filled.          */</span>
<span class="line-removed">-   /*    When FT_CONFIG_OPTION_PIC is not defined the struct will be        */</span>
<span class="line-removed">-   /*    allocated in the global scope (or the scope where the macro        */</span>
<span class="line-removed">-   /*    is used).                                                          */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">- #ifndef FT_CONFIG_OPTION_PIC</span>
<span class="line-removed">- </span>
  #define FT_DEFINE_GLYPH(          \
            class_,                 \
            size_,                  \
            format_,                \
            init_,                  \
<span class="line-new-header">--- 1044,21 ---</span>
      raster_set_mode_,              \
      raster_render_,                \
      raster_done_                   \
    };
  
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @macro:</span>
<span class="line-modified">!    *   FT_DEFINE_GLYPH</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @description:</span>
<span class="line-modified">!    *   The struct will be allocated in the global scope (or the scope where</span>
<span class="line-modified">!    *   the macro is used).</span>
<span class="line-modified">!    */</span>
  #define FT_DEFINE_GLYPH(          \
            class_,                 \
            size_,                  \
            format_,                \
            init_,                  \
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1184,77 ***</span>
      transform_,                   \
      bbox_,                        \
      prepare_                      \
    };
  
<span class="line-removed">- #else /* FT_CONFIG_OPTION_PIC */</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define FT_DEFINE_GLYPH(                              \</span>
<span class="line-removed">-           class_,                                     \</span>
<span class="line-removed">-           size_,                                      \</span>
<span class="line-removed">-           format_,                                    \</span>
<span class="line-removed">-           init_,                                      \</span>
<span class="line-removed">-           done_,                                      \</span>
<span class="line-removed">-           copy_,                                      \</span>
<span class="line-removed">-           transform_,                                 \</span>
<span class="line-removed">-           bbox_,                                      \</span>
<span class="line-removed">-           prepare_ )                                  \</span>
<span class="line-removed">-   void                                                \</span>
<span class="line-removed">-   FT_Init_Class_ ## class_( FT_Glyph_Class*  clazz )  \</span>
<span class="line-removed">-   {                                                   \</span>
<span class="line-removed">-     clazz-&gt;glyph_size      = size_;                   \</span>
<span class="line-removed">-     clazz-&gt;glyph_format    = format_;                 \</span>
<span class="line-removed">-     clazz-&gt;glyph_init      = init_;                   \</span>
<span class="line-removed">-     clazz-&gt;glyph_done      = done_;                   \</span>
<span class="line-removed">-     clazz-&gt;glyph_copy      = copy_;                   \</span>
<span class="line-removed">-     clazz-&gt;glyph_transform = transform_;              \</span>
<span class="line-removed">-     clazz-&gt;glyph_bbox      = bbox_;                   \</span>
<span class="line-removed">-     clazz-&gt;glyph_prepare   = prepare_;                \</span>
<span class="line-removed">-   }</span>
<span class="line-removed">- </span>
<span class="line-removed">- #endif /* FT_CONFIG_OPTION_PIC */</span>
<span class="line-removed">- </span>
<span class="line-removed">- </span>
<span class="line-removed">-   /*************************************************************************/</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Macro&gt;                                                               */</span>
<span class="line-removed">-   /*    FT_DECLARE_RENDERER                                                */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Description&gt;                                                         */</span>
<span class="line-removed">-   /*    Used to create a forward declaration of a                          */</span>
<span class="line-removed">-   /*    FT_Renderer_Class struct instance.                                 */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Macro&gt;                                                               */</span>
<span class="line-removed">-   /*    FT_DEFINE_RENDERER                                                 */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Description&gt;                                                         */</span>
<span class="line-removed">-   /*    Used to initialize an instance of FT_Renderer_Class struct.        */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /*    When FT_CONFIG_OPTION_PIC is defined a `create&#39; function will      */</span>
<span class="line-removed">-   /*    need to be called with a pointer where the allocated structure is  */</span>
<span class="line-removed">-   /*    returned.  And when it is no longer needed a `destroy&#39; function    */</span>
<span class="line-removed">-   /*    needs to be called to release that allocation.                     */</span>
<span class="line-removed">-   /*    `ftinit.c&#39; (ft_create_default_module_classes) already contains     */</span>
<span class="line-removed">-   /*    a mechanism to call these functions for the default modules        */</span>
<span class="line-removed">-   /*    described in `ftmodule.h&#39;.                                         */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /*    Notice that the created `create&#39; and `destroy&#39; functions call      */</span>
<span class="line-removed">-   /*    `pic_init&#39; and `pic_free&#39; to allow you to manually allocate and    */</span>
<span class="line-removed">-   /*    initialize any additional global data, like a module specific      */</span>
<span class="line-removed">-   /*    interface, and put them in the global pic container defined in     */</span>
<span class="line-removed">-   /*    `ftpic.h&#39;.  If you don&#39;t need them just implement the functions as */</span>
<span class="line-removed">-   /*    empty to resolve the link error.  Also the `pic_init&#39; and          */</span>
<span class="line-removed">-   /*    `pic_free&#39; functions should be declared in `pic.h&#39;, to be referred */</span>
<span class="line-removed">-   /*    by the renderer definition calling `FT_DEFINE_RENDERER&#39; in the     */</span>
<span class="line-removed">-   /*    following.                                                         */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /*    When FT_CONFIG_OPTION_PIC is not defined the struct will be        */</span>
<span class="line-removed">-   /*    allocated in the global scope (or the scope where the macro        */</span>
<span class="line-removed">-   /*    is used).                                                          */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">- #ifndef FT_CONFIG_OPTION_PIC</span>
  
  #define FT_DECLARE_RENDERER( class_ )               \
    FT_EXPORT_VAR( const FT_Renderer_Class ) class_;
  
  #define FT_DEFINE_RENDERER(                  \
            class_,                            \
<span class="line-new-header">--- 1078,29 ---</span>
      transform_,                   \
      bbox_,                        \
      prepare_                      \
    };
  
  
<span class="line-added">+   /**************************************************************************</span>
<span class="line-added">+    *</span>
<span class="line-added">+    * @macro:</span>
<span class="line-added">+    *   FT_DECLARE_RENDERER</span>
<span class="line-added">+    *</span>
<span class="line-added">+    * @description:</span>
<span class="line-added">+    *   Used to create a forward declaration of a FT_Renderer_Class struct</span>
<span class="line-added">+    *   instance.</span>
<span class="line-added">+    *</span>
<span class="line-added">+    * @macro:</span>
<span class="line-added">+    *   FT_DEFINE_RENDERER</span>
<span class="line-added">+    *</span>
<span class="line-added">+    * @description:</span>
<span class="line-added">+    *   Used to initialize an instance of FT_Renderer_Class struct.</span>
<span class="line-added">+    *</span>
<span class="line-added">+    *   The struct will be allocated in the global scope (or the scope where</span>
<span class="line-added">+    *   the macro is used).</span>
<span class="line-added">+    */</span>
  #define FT_DECLARE_RENDERER( class_ )               \
    FT_EXPORT_VAR( const FT_Renderer_Class ) class_;
  
  #define FT_DEFINE_RENDERER(                  \
            class_,                            \
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1293,180 ***</span>
      set_mode_,                               \
                                               \
      raster_class_                            \
    };
  
<span class="line-removed">- #else /* FT_CONFIG_OPTION_PIC */</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define FT_DECLARE_RENDERER( class_ )  FT_DECLARE_MODULE( class_ )</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define FT_DEFINE_RENDERER(                                      \</span>
<span class="line-removed">-           class_,                                                \</span>
<span class="line-removed">-           flags_,                                                \</span>
<span class="line-removed">-           size_,                                                 \</span>
<span class="line-removed">-           name_,                                                 \</span>
<span class="line-removed">-           version_,                                              \</span>
<span class="line-removed">-           requires_,                                             \</span>
<span class="line-removed">-           interface_,                                            \</span>
<span class="line-removed">-           init_,                                                 \</span>
<span class="line-removed">-           done_,                                                 \</span>
<span class="line-removed">-           get_interface_,                                        \</span>
<span class="line-removed">-           glyph_format_,                                         \</span>
<span class="line-removed">-           render_glyph_,                                         \</span>
<span class="line-removed">-           transform_glyph_,                                      \</span>
<span class="line-removed">-           get_glyph_cbox_,                                       \</span>
<span class="line-removed">-           set_mode_,                                             \</span>
<span class="line-removed">-           raster_class_ )                                        \</span>
<span class="line-removed">-   void                                                           \</span>
<span class="line-removed">-   FT_Destroy_Class_ ## class_( FT_Library        library,        \</span>
<span class="line-removed">-                                FT_Module_Class*  clazz )         \</span>
<span class="line-removed">-   {                                                              \</span>
<span class="line-removed">-     FT_Renderer_Class*  rclazz = (FT_Renderer_Class*)clazz;      \</span>
<span class="line-removed">-     FT_Memory           memory = library-&gt;memory;                \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     class_ ## _pic_free( library );                              \</span>
<span class="line-removed">-     if ( rclazz )                                                \</span>
<span class="line-removed">-       FT_FREE( rclazz );                                         \</span>
<span class="line-removed">-   }                                                              \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-   FT_Error                                                       \</span>
<span class="line-removed">-   FT_Create_Class_ ## class_( FT_Library         library,        \</span>
<span class="line-removed">-                               FT_Module_Class**  output_class )  \</span>
<span class="line-removed">-   {                                                              \</span>
<span class="line-removed">-     FT_Renderer_Class*  clazz = NULL;                            \</span>
<span class="line-removed">-     FT_Error            error;                                   \</span>
<span class="line-removed">-     FT_Memory           memory = library-&gt;memory;                \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     if ( FT_ALLOC( clazz, sizeof ( *clazz ) ) )                  \</span>
<span class="line-removed">-       return error;                                              \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     error = class_ ## _pic_init( library );                      \</span>
<span class="line-removed">-     if ( error )                                                 \</span>
<span class="line-removed">-     {                                                            \</span>
<span class="line-removed">-       FT_FREE( clazz );                                          \</span>
<span class="line-removed">-       return error;                                              \</span>
<span class="line-removed">-     }                                                            \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     FT_DEFINE_ROOT_MODULE( flags_,                               \</span>
<span class="line-removed">-                            size_,                                \</span>
<span class="line-removed">-                            name_,                                \</span>
<span class="line-removed">-                            version_,                             \</span>
<span class="line-removed">-                            requires_,                            \</span>
<span class="line-removed">-                            interface_,                           \</span>
<span class="line-removed">-                            init_,                                \</span>
<span class="line-removed">-                            done_,                                \</span>
<span class="line-removed">-                            get_interface_ )                      \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     clazz-&gt;glyph_format    = glyph_format_;                      \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     clazz-&gt;render_glyph    = render_glyph_;                      \</span>
<span class="line-removed">-     clazz-&gt;transform_glyph = transform_glyph_;                   \</span>
<span class="line-removed">-     clazz-&gt;get_glyph_cbox  = get_glyph_cbox_;                    \</span>
<span class="line-removed">-     clazz-&gt;set_mode        = set_mode_;                          \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     clazz-&gt;raster_class    = raster_class_;                      \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     *output_class = (FT_Module_Class*)clazz;                     \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     return FT_Err_Ok;                                            \</span>
<span class="line-removed">-   }</span>
<span class="line-removed">- </span>
<span class="line-removed">- #endif /* FT_CONFIG_OPTION_PIC */</span>
<span class="line-removed">- </span>
<span class="line-removed">- </span>
<span class="line-removed">-   /* PIC support macros for ftmodapi.h **/</span>
<span class="line-removed">- </span>
<span class="line-removed">- </span>
<span class="line-removed">- #ifdef FT_CONFIG_OPTION_PIC</span>
<span class="line-removed">- </span>
<span class="line-removed">-   /*************************************************************************/</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;FuncType&gt;                                                            */</span>
<span class="line-removed">-   /*    FT_Module_Creator                                                  */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Description&gt;                                                         */</span>
<span class="line-removed">-   /*    A function used to create (allocate) a new module class object.    */</span>
<span class="line-removed">-   /*    The object&#39;s members are initialized, but the module itself is     */</span>
<span class="line-removed">-   /*    not.                                                               */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Input&gt;                                                               */</span>
<span class="line-removed">-   /*    memory       :: A handle to the memory manager.                    */</span>
<span class="line-removed">-   /*    output_class :: Initialized with the newly allocated class.        */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   typedef FT_Error</span>
<span class="line-removed">-   (*FT_Module_Creator)( FT_Memory          memory,</span>
<span class="line-removed">-                         FT_Module_Class**  output_class );</span>
<span class="line-removed">- </span>
<span class="line-removed">-   /*************************************************************************/</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;FuncType&gt;                                                            */</span>
<span class="line-removed">-   /*    FT_Module_Destroyer                                                */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Description&gt;                                                         */</span>
<span class="line-removed">-   /*    A function used to destroy (deallocate) a module class object.     */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Input&gt;                                                               */</span>
<span class="line-removed">-   /*    memory :: A handle to the memory manager.                          */</span>
<span class="line-removed">-   /*    clazz  :: Module class to destroy.                                 */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   typedef void</span>
<span class="line-removed">-   (*FT_Module_Destroyer)( FT_Memory         memory,</span>
<span class="line-removed">-                           FT_Module_Class*  clazz );</span>
<span class="line-removed">- </span>
<span class="line-removed">- #endif</span>
<span class="line-removed">- </span>
<span class="line-removed">- </span>
<span class="line-removed">-   /*************************************************************************/</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Macro&gt;                                                               */</span>
<span class="line-removed">-   /*    FT_DECLARE_MODULE                                                  */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Description&gt;                                                         */</span>
<span class="line-removed">-   /*    Used to create a forward declaration of a                          */</span>
<span class="line-removed">-   /*    FT_Module_Class struct instance.                                   */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Macro&gt;                                                               */</span>
<span class="line-removed">-   /*    FT_DEFINE_MODULE                                                   */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Description&gt;                                                         */</span>
<span class="line-removed">-   /*    Used to initialize an instance of an FT_Module_Class struct.       */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /*    When FT_CONFIG_OPTION_PIC is defined a `create&#39; function needs     */</span>
<span class="line-removed">-   /*    to be called with a pointer where the allocated structure is       */</span>
<span class="line-removed">-   /*    returned.  And when it is no longer needed a `destroy&#39; function    */</span>
<span class="line-removed">-   /*    needs to be called to release that allocation.                     */</span>
<span class="line-removed">-   /*    `ftinit.c&#39; (ft_create_default_module_classes) already contains     */</span>
<span class="line-removed">-   /*    a mechanism to call these functions for the default modules        */</span>
<span class="line-removed">-   /*    described in `ftmodule.h&#39;.                                         */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /*    Notice that the created `create&#39; and `destroy&#39; functions call      */</span>
<span class="line-removed">-   /*    `pic_init&#39; and `pic_free&#39; to allow you to manually allocate and    */</span>
<span class="line-removed">-   /*    initialize any additional global data, like a module specific      */</span>
<span class="line-removed">-   /*    interface, and put them in the global pic container defined in     */</span>
<span class="line-removed">-   /*    `ftpic.h&#39;.  If you don&#39;t need them just implement the functions as */</span>
<span class="line-removed">-   /*    empty to resolve the link error.  Also the `pic_init&#39; and          */</span>
<span class="line-removed">-   /*    `pic_free&#39; functions should be declared in `pic.h&#39;, to be referred */</span>
<span class="line-removed">-   /*    by the module definition calling `FT_DEFINE_MODULE&#39; in the         */</span>
<span class="line-removed">-   /*    following.                                                         */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /*    When FT_CONFIG_OPTION_PIC is not defined the struct will be        */</span>
<span class="line-removed">-   /*    allocated in the global scope (or the scope where the macro        */</span>
<span class="line-removed">-   /*    is used).                                                          */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Macro&gt;                                                               */</span>
<span class="line-removed">-   /*    FT_DEFINE_ROOT_MODULE                                              */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">-   /* &lt;Description&gt;                                                         */</span>
<span class="line-removed">-   /*    Used to initialize an instance of an FT_Module_Class struct inside */</span>
<span class="line-removed">-   /*    another struct that contains it or in a function that initializes  */</span>
<span class="line-removed">-   /*    that containing struct.                                            */</span>
<span class="line-removed">-   /*                                                                       */</span>
<span class="line-removed">- #ifndef FT_CONFIG_OPTION_PIC</span>
  
  #define FT_DECLARE_MODULE( class_ )  \
    FT_CALLBACK_TABLE                  \
    const FT_Module_Class  class_;
  
  #define FT_DEFINE_ROOT_MODULE(  \
<span class="line-new-header">--- 1139,37 ---</span>
      set_mode_,                               \
                                               \
      raster_class_                            \
    };
  
  
<span class="line-added">+   /**************************************************************************</span>
<span class="line-added">+    *</span>
<span class="line-added">+    * @macro:</span>
<span class="line-added">+    *   FT_DECLARE_MODULE</span>
<span class="line-added">+    *</span>
<span class="line-added">+    * @description:</span>
<span class="line-added">+    *   Used to create a forward declaration of a FT_Module_Class struct</span>
<span class="line-added">+    *   instance.</span>
<span class="line-added">+    *</span>
<span class="line-added">+    * @macro:</span>
<span class="line-added">+    *   FT_DEFINE_MODULE</span>
<span class="line-added">+    *</span>
<span class="line-added">+    * @description:</span>
<span class="line-added">+    *   Used to initialize an instance of an FT_Module_Class struct.</span>
<span class="line-added">+    *</span>
<span class="line-added">+    *   The struct will be allocated in the global scope (or the scope where</span>
<span class="line-added">+    *   the macro is used).</span>
<span class="line-added">+    *</span>
<span class="line-added">+    * @macro:</span>
<span class="line-added">+    *   FT_DEFINE_ROOT_MODULE</span>
<span class="line-added">+    *</span>
<span class="line-added">+    * @description:</span>
<span class="line-added">+    *   Used to initialize an instance of an FT_Module_Class struct inside</span>
<span class="line-added">+    *   another struct that contains it or in a function that initializes that</span>
<span class="line-added">+    *   containing struct.</span>
<span class="line-added">+    */</span>
  #define FT_DECLARE_MODULE( class_ )  \
    FT_CALLBACK_TABLE                  \
    const FT_Module_Class  class_;
  
  #define FT_DEFINE_ROOT_MODULE(  \
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1521,104 ***</span>
      done_,                        \
      get_interface_,               \
    };
  
  
<span class="line-removed">- #else /* FT_CONFIG_OPTION_PIC */</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define FT_DECLARE_MODULE( class_ )                               \</span>
<span class="line-removed">-   FT_Error                                                        \</span>
<span class="line-removed">-   FT_Create_Class_ ## class_( FT_Library         library,         \</span>
<span class="line-removed">-                               FT_Module_Class**  output_class );  \</span>
<span class="line-removed">-   void                                                            \</span>
<span class="line-removed">-   FT_Destroy_Class_ ## class_( FT_Library        library,         \</span>
<span class="line-removed">-                                FT_Module_Class*  clazz );</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define FT_DEFINE_ROOT_MODULE(                      \</span>
<span class="line-removed">-           flags_,                                   \</span>
<span class="line-removed">-           size_,                                    \</span>
<span class="line-removed">-           name_,                                    \</span>
<span class="line-removed">-           version_,                                 \</span>
<span class="line-removed">-           requires_,                                \</span>
<span class="line-removed">-           interface_,                               \</span>
<span class="line-removed">-           init_,                                    \</span>
<span class="line-removed">-           done_,                                    \</span>
<span class="line-removed">-           get_interface_ )                          \</span>
<span class="line-removed">-     clazz-&gt;root.module_flags     = flags_;          \</span>
<span class="line-removed">-     clazz-&gt;root.module_size      = size_;           \</span>
<span class="line-removed">-     clazz-&gt;root.module_name      = name_;           \</span>
<span class="line-removed">-     clazz-&gt;root.module_version   = version_;        \</span>
<span class="line-removed">-     clazz-&gt;root.module_requires  = requires_;       \</span>
<span class="line-removed">-                                                     \</span>
<span class="line-removed">-     clazz-&gt;root.module_interface = interface_;      \</span>
<span class="line-removed">-                                                     \</span>
<span class="line-removed">-     clazz-&gt;root.module_init      = init_;           \</span>
<span class="line-removed">-     clazz-&gt;root.module_done      = done_;           \</span>
<span class="line-removed">-     clazz-&gt;root.get_interface    = get_interface_;</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define FT_DEFINE_MODULE(                                        \</span>
<span class="line-removed">-           class_,                                                \</span>
<span class="line-removed">-           flags_,                                                \</span>
<span class="line-removed">-           size_,                                                 \</span>
<span class="line-removed">-           name_,                                                 \</span>
<span class="line-removed">-           version_,                                              \</span>
<span class="line-removed">-           requires_,                                             \</span>
<span class="line-removed">-           interface_,                                            \</span>
<span class="line-removed">-           init_,                                                 \</span>
<span class="line-removed">-           done_,                                                 \</span>
<span class="line-removed">-           get_interface_ )                                       \</span>
<span class="line-removed">-   void                                                           \</span>
<span class="line-removed">-   FT_Destroy_Class_ ## class_( FT_Library        library,        \</span>
<span class="line-removed">-                                FT_Module_Class*  clazz )         \</span>
<span class="line-removed">-   {                                                              \</span>
<span class="line-removed">-     FT_Memory memory = library-&gt;memory;                          \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     class_ ## _pic_free( library );                              \</span>
<span class="line-removed">-     if ( clazz )                                                 \</span>
<span class="line-removed">-       FT_FREE( clazz );                                          \</span>
<span class="line-removed">-   }                                                              \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-   FT_Error                                                       \</span>
<span class="line-removed">-   FT_Create_Class_ ## class_( FT_Library         library,        \</span>
<span class="line-removed">-                               FT_Module_Class**  output_class )  \</span>
<span class="line-removed">-   {                                                              \</span>
<span class="line-removed">-     FT_Memory         memory = library-&gt;memory;                  \</span>
<span class="line-removed">-     FT_Module_Class*  clazz  = NULL;                             \</span>
<span class="line-removed">-     FT_Error          error;                                     \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     if ( FT_ALLOC( clazz, sizeof ( *clazz ) ) )                  \</span>
<span class="line-removed">-       return error;                                              \</span>
<span class="line-removed">-     error = class_ ## _pic_init( library );                      \</span>
<span class="line-removed">-     if ( error )                                                 \</span>
<span class="line-removed">-     {                                                            \</span>
<span class="line-removed">-       FT_FREE( clazz );                                          \</span>
<span class="line-removed">-       return error;                                              \</span>
<span class="line-removed">-     }                                                            \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     clazz-&gt;module_flags     = flags_;                            \</span>
<span class="line-removed">-     clazz-&gt;module_size      = size_;                             \</span>
<span class="line-removed">-     clazz-&gt;module_name      = name_;                             \</span>
<span class="line-removed">-     clazz-&gt;module_version   = version_;                          \</span>
<span class="line-removed">-     clazz-&gt;module_requires  = requires_;                         \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     clazz-&gt;module_interface = interface_;                        \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     clazz-&gt;module_init      = init_;                             \</span>
<span class="line-removed">-     clazz-&gt;module_done      = done_;                             \</span>
<span class="line-removed">-     clazz-&gt;get_interface    = get_interface_;                    \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     *output_class = clazz;                                       \</span>
<span class="line-removed">-                                                                  \</span>
<span class="line-removed">-     return FT_Err_Ok;                                            \</span>
<span class="line-removed">-   }</span>
<span class="line-removed">- </span>
<span class="line-removed">- #endif /* FT_CONFIG_OPTION_PIC */</span>
<span class="line-removed">- </span>
<span class="line-removed">- </span>
  FT_END_HEADER
  
  #endif /* FTOBJS_H_ */
  
  
<span class="line-new-header">--- 1224,10 ---</span>
</pre>
<center><a href="ftmemory.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="ftpsprop.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>