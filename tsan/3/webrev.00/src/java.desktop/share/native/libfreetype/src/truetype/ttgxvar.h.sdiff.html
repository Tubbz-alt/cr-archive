<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/native/libfreetype/src/truetype/ttgxvar.h</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="ttgxvar.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ttinterp.c.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfreetype/src/truetype/ttgxvar.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
<span class="line-modified">  1 /***************************************************************************/</span>
<span class="line-modified">  2 /*                                                                         */</span>
<span class="line-modified">  3 /*  ttgxvar.h                                                              */</span>
<span class="line-modified">  4 /*                                                                         */</span>
<span class="line-modified">  5 /*    TrueType GX Font Variation loader (specification)                    */</span>
<span class="line-modified">  6 /*                                                                         */</span>
<span class="line-modified">  7 /*  Copyright 2004-2018 by                                                 */</span>
<span class="line-modified">  8 /*  David Turner, Robert Wilhelm, Werner Lemberg and George Williams.      */</span>
<span class="line-modified">  9 /*                                                                         */</span>
<span class="line-modified"> 10 /*  This file is part of the FreeType project, and may only be used,       */</span>
<span class="line-modified"> 11 /*  modified, and distributed under the terms of the FreeType project      */</span>
<span class="line-modified"> 12 /*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<span class="line-modified"> 13 /*  this file you indicate that you have read the license and              */</span>
<span class="line-modified"> 14 /*  understand and accept it fully.                                        */</span>
<span class="line-modified"> 15 /*                                                                         */</span>
<span class="line-modified"> 16 /***************************************************************************/</span>
 17 
 18 
 19 #ifndef TTGXVAR_H_
 20 #define TTGXVAR_H_
 21 
 22 
 23 #include &lt;ft2build.h&gt;
 24 #include &quot;ttobjs.h&quot;
 25 
 26 
 27 FT_BEGIN_HEADER
 28 
 29 
 30 #ifdef TT_CONFIG_OPTION_GX_VAR_SUPPORT
 31 
<span class="line-modified"> 32   /*************************************************************************/</span>
<span class="line-modified"> 33   /*                                                                       */</span>
<span class="line-modified"> 34   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 35   /*    GX_AVarCorrespondenceRec                                           */</span>
<span class="line-modified"> 36   /*                                                                       */</span>
<span class="line-modified"> 37   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 38   /*    A data structure representing `shortFracCorrespondence&#39; in `avar&#39;  */</span>
<span class="line-modified"> 39   /*    table according to the specifications from Apple.                  */</span>
<span class="line-modified"> 40   /*                                                                       */</span>
 41   typedef struct  GX_AVarCorrespondenceRec_
 42   {
 43     FT_Fixed  fromCoord;
 44     FT_Fixed  toCoord;
 45 
 46   } GX_AVarCorrespondenceRec_, *GX_AVarCorrespondence;
 47 
 48 
<span class="line-modified"> 49   /*************************************************************************/</span>
<span class="line-modified"> 50   /*                                                                       */</span>
<span class="line-modified"> 51   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 52   /*    GX_AVarRec                                                         */</span>
<span class="line-modified"> 53   /*                                                                       */</span>
<span class="line-modified"> 54   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 55   /*    Data from the segment field of `avar&#39; table.                       */</span>
<span class="line-modified"> 56   /*    There is one of these for each axis.                               */</span>
<span class="line-modified"> 57   /*                                                                       */</span>
 58   typedef struct  GX_AVarSegmentRec_
 59   {
 60     FT_UShort              pairCount;
 61     GX_AVarCorrespondence  correspondence; /* array with pairCount entries */
 62 
 63   } GX_AVarSegmentRec, *GX_AVarSegment;
 64 
 65 
 66   typedef struct  GX_ItemVarDataRec_
 67   {
 68     FT_UInt    itemCount;      /* number of delta sets per item         */
 69     FT_UInt    regionIdxCount; /* number of region indices in this data */
 70     FT_UInt*   regionIndices;  /* array of `regionCount&#39; indices;       */
 71                                /* these index `varRegionList&#39;           */
 72     FT_Short*  deltaSet;       /* array of `itemCount&#39; deltas           */
 73                                /* use `innerIndex&#39; for this array       */
 74 
 75   } GX_ItemVarDataRec, *GX_ItemVarData;
 76 
 77 
</pre>
<hr />
<pre>
 97   {
 98     FT_UInt         dataCount;
 99     GX_ItemVarData  varData;            /* array of dataCount records;     */
100                                         /* use `outerIndex&#39; for this array */
101     FT_UShort     axisCount;
102     FT_UInt       regionCount;          /* total number of regions defined */
103     GX_VarRegion  varRegionList;
104 
105   } GX_ItemVarStoreRec, *GX_ItemVarStore;
106 
107 
108   typedef struct  GX_DeltaSetIdxMapRec_
109   {
110     FT_UInt   mapCount;
111     FT_UInt*  outerIndex;             /* indices to item var data */
112     FT_UInt*  innerIndex;             /* indices to delta set     */
113 
114   } GX_DeltaSetIdxMapRec, *GX_DeltaSetIdxMap;
115 
116 
<span class="line-modified">117   /*************************************************************************/</span>
<span class="line-modified">118   /*                                                                       */</span>
<span class="line-modified">119   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified">120   /*    GX_HVVarTableRec                                                   */</span>
<span class="line-modified">121   /*                                                                       */</span>
<span class="line-modified">122   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">123   /*    Data from either the `HVAR&#39; or `VVAR&#39; table.                       */</span>
<span class="line-modified">124   /*                                                                       */</span>
125   typedef struct  GX_HVVarTableRec_
126   {
127     GX_ItemVarStoreRec    itemStore;        /* Item Variation Store  */
128     GX_DeltaSetIdxMapRec  widthMap;         /* Advance Width Mapping */
129 
130 #if 0
131     GX_DeltaSetIdxMapRec  lsbMap;           /* not implemented */
132     GX_DeltaSetIdxMapRec  rsbMap;           /* not implemented */
133 
134     GX_DeltaSetIdxMapRec  tsbMap;           /* not implemented */
135     GX_DeltaSetIdxMapRec  bsbMap;           /* not implemented */
136     GX_DeltaSetIdxMapRec  vorgMap;          /* not implemented */
137 #endif
138 
139   } GX_HVVarTableRec, *GX_HVVarTable;
140 
141 
142 #define MVAR_TAG_GASP_0  FT_MAKE_TAG( &#39;g&#39;, &#39;s&#39;, &#39;p&#39;, &#39;0&#39; )
143 #define MVAR_TAG_GASP_1  FT_MAKE_TAG( &#39;g&#39;, &#39;s&#39;, &#39;p&#39;, &#39;1&#39; )
144 #define MVAR_TAG_GASP_2  FT_MAKE_TAG( &#39;g&#39;, &#39;s&#39;, &#39;p&#39;, &#39;2&#39; )
</pre>
<hr />
<pre>
174 #define MVAR_TAG_VASC  FT_MAKE_TAG( &#39;v&#39;, &#39;a&#39;, &#39;s&#39;, &#39;c&#39; )
175 #define MVAR_TAG_VCOF  FT_MAKE_TAG( &#39;v&#39;, &#39;c&#39;, &#39;o&#39;, &#39;f&#39; )
176 #define MVAR_TAG_VCRN  FT_MAKE_TAG( &#39;v&#39;, &#39;c&#39;, &#39;r&#39;, &#39;n&#39; )
177 #define MVAR_TAG_VCRS  FT_MAKE_TAG( &#39;v&#39;, &#39;c&#39;, &#39;r&#39;, &#39;s&#39; )
178 #define MVAR_TAG_VDSC  FT_MAKE_TAG( &#39;v&#39;, &#39;d&#39;, &#39;s&#39;, &#39;c&#39; )
179 #define MVAR_TAG_VLGP  FT_MAKE_TAG( &#39;v&#39;, &#39;l&#39;, &#39;g&#39;, &#39;p&#39; )
180 #define MVAR_TAG_XHGT  FT_MAKE_TAG( &#39;x&#39;, &#39;h&#39;, &#39;g&#39;, &#39;t&#39; )
181 
182 
183   typedef struct  GX_ValueRec_
184   {
185     FT_ULong   tag;
186     FT_UShort  outerIndex;
187     FT_UShort  innerIndex;
188 
189     FT_Short  unmodified;  /* values are either FT_Short or FT_UShort */
190 
191   } GX_ValueRec, *GX_Value;
192 
193 
<span class="line-modified">194   /*************************************************************************/</span>
<span class="line-modified">195   /*                                                                       */</span>
<span class="line-modified">196   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified">197   /*    GX_MVarTableRec                                                    */</span>
<span class="line-modified">198   /*                                                                       */</span>
<span class="line-modified">199   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">200   /*    Data from the `MVAR&#39; table.                                        */</span>
<span class="line-modified">201   /*                                                                       */</span>
202   typedef struct  GX_MVarTableRec_
203   {
204     FT_UShort  valueCount;
205 
206     GX_ItemVarStoreRec  itemStore;        /* Item Variation Store  */
207     GX_Value            values;           /* Value Records         */
208 
209   } GX_MVarTableRec, *GX_MVarTable;
210 
211 
<span class="line-modified">212   /*************************************************************************/</span>
<span class="line-modified">213   /*                                                                       */</span>
<span class="line-modified">214   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified">215   /*    GX_BlendRec                                                        */</span>
<span class="line-modified">216   /*                                                                       */</span>
<span class="line-modified">217   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">218   /*    Data for interpolating a font from a distortable font specified    */</span>
<span class="line-modified">219   /*    by the GX *var tables ([fgcahvm]var).                              */</span>
<span class="line-modified">220   /*                                                                       */</span>
<span class="line-modified">221   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified">222   /*    num_axis ::                                                        */</span>
<span class="line-modified">223   /*      The number of axes along which interpolation may happen.         */</span>
<span class="line-modified">224   /*                                                                       */</span>
<span class="line-modified">225   /*    coords ::                                                          */</span>
<span class="line-modified">226   /*      An array of design coordinates (in user space) indicating the    */</span>
<span class="line-modified">227   /*      contribution along each axis to the final interpolated font.     */</span>
<span class="line-modified">228   /*      `normalizedcoords&#39; holds the same values.                        */</span>
<span class="line-modified">229   /*                                                                       */</span>
<span class="line-modified">230   /*    normalizedcoords ::                                                */</span>
<span class="line-modified">231   /*      An array of normalized values (between [-1,1]) indicating the    */</span>
<span class="line-modified">232   /*      contribution along each axis to the final interpolated font.     */</span>
<span class="line-modified">233   /*      `coords&#39; holds the same values.                                  */</span>
<span class="line-modified">234   /*                                                                       */</span>
<span class="line-modified">235   /*    mmvar ::                                                           */</span>
<span class="line-modified">236   /*      Data from the `fvar&#39; table.                                      */</span>
<span class="line-modified">237   /*                                                                       */</span>
<span class="line-modified">238   /*    mmvar_len ::                                                       */</span>
<span class="line-modified">239   /*      The length of the `mmvar&#39; structure.                             */</span>
<span class="line-modified">240   /*                                                                       */</span>
<span class="line-modified">241   /*    normalized_stylecoords ::                                          */</span>
<span class="line-modified">242   /*      A two-dimensional array that holds the named instance data from  */</span>
<span class="line-modified">243   /*      `mmvar&#39; as normalized values.                                    */</span>
<span class="line-modified">244   /*                                                                       */</span>
<span class="line-modified">245   /*    avar_loaded ::                                                     */</span>
<span class="line-modified">246   /*      A Boolean; if set, FreeType tried to load (and parse) the `avar&#39; */</span>
<span class="line-modified">247   /*      table.                                                           */</span>
<span class="line-modified">248   /*                                                                       */</span>
<span class="line-modified">249   /*    avar_segment ::                                                    */</span>
<span class="line-modified">250   /*      Data from the `avar&#39; table.                                      */</span>
<span class="line-modified">251   /*                                                                       */</span>
<span class="line-modified">252   /*    hvar_loaded ::                                                     */</span>
<span class="line-modified">253   /*      A Boolean; if set, FreeType tried to load (and parse) the `hvar&#39; */</span>
<span class="line-modified">254   /*      table.                                                           */</span>
<span class="line-modified">255   /*                                                                       */</span>
<span class="line-modified">256   /*    hvar_checked ::                                                    */</span>
<span class="line-modified">257   /*      A Boolean; if set, FreeType successfully loaded and parsed the   */</span>
<span class="line-modified">258   /*      `hvar&#39; table.                                                    */</span>
<span class="line-modified">259   /*                                                                       */</span>
<span class="line-modified">260   /*    hvar_error ::                                                      */</span>
<span class="line-modified">261   /*      If loading and parsing of the `hvar&#39; table failed, this field    */</span>
<span class="line-modified">262   /*      holds the corresponding error code.                              */</span>
<span class="line-modified">263   /*                                                                       */</span>
<span class="line-modified">264   /*    hvar_table ::                                                      */</span>
<span class="line-modified">265   /*      Data from the `hvar&#39; table.                                      */</span>
<span class="line-modified">266   /*                                                                       */</span>
<span class="line-modified">267   /*    vvar_loaded ::                                                     */</span>
<span class="line-modified">268   /*      A Boolean; if set, FreeType tried to load (and parse) the `vvar&#39; */</span>
<span class="line-modified">269   /*      table.                                                           */</span>
<span class="line-modified">270   /*                                                                       */</span>
<span class="line-modified">271   /*    vvar_checked ::                                                    */</span>
<span class="line-modified">272   /*      A Boolean; if set, FreeType successfully loaded and parsed the   */</span>
<span class="line-modified">273   /*      `vvar&#39; table.                                                    */</span>
<span class="line-modified">274   /*                                                                       */</span>
<span class="line-modified">275   /*    vvar_error ::                                                      */</span>
<span class="line-modified">276   /*      If loading and parsing of the `vvar&#39; table failed, this field    */</span>
<span class="line-modified">277   /*      holds the corresponding error code.                              */</span>
<span class="line-modified">278   /*                                                                       */</span>
<span class="line-modified">279   /*    vvar_table ::                                                      */</span>
<span class="line-modified">280   /*      Data from the `vvar&#39; table.                                      */</span>
<span class="line-modified">281   /*                                                                       */</span>
<span class="line-modified">282   /*    mvar_table ::                                                      */</span>
<span class="line-modified">283   /*      Data from the `mvar&#39; table.                                      */</span>
<span class="line-modified">284   /*                                                                       */</span>
<span class="line-modified">285   /*    tuplecount ::                                                      */</span>
<span class="line-modified">286   /*      The number of shared tuples in the `gvar&#39; table.                 */</span>
<span class="line-modified">287   /*                                                                       */</span>
<span class="line-modified">288   /*    tuplecoords ::                                                     */</span>
<span class="line-modified">289   /*      A two-dimensional array that holds the shared tuple coordinates  */</span>
<span class="line-modified">290   /*      in the `gvar&#39; table.                                             */</span>
<span class="line-modified">291   /*                                                                       */</span>
<span class="line-modified">292   /*    gv_glyphcnt ::                                                     */</span>
<span class="line-modified">293   /*      The number of glyphs handled in the `gvar&#39; table.                */</span>
<span class="line-modified">294   /*                                                                       */</span>
<span class="line-modified">295   /*    glyphoffsets ::                                                    */</span>
<span class="line-modified">296   /*      Offsets into the glyph variation data array.                     */</span>
<span class="line-modified">297   /*                                                                       */</span>
<span class="line-modified">298   /*    gvar_size ::                                                       */</span>
<span class="line-modified">299   /*      The size of the `gvar&#39; table.                                    */</span>
<span class="line-modified">300   /*                                                                       */</span>
301   typedef struct  GX_BlendRec_
302   {
303     FT_UInt         num_axis;
304     FT_Fixed*       coords;
305     FT_Fixed*       normalizedcoords;
306 
307     FT_MM_Var*      mmvar;
308     FT_Offset       mmvar_len;
309 
310     FT_Fixed*       normalized_stylecoords;
311                       /* normalized_stylecoords[num_namedstyles][num_axis] */
312 
313     FT_Bool         avar_loaded;
314     GX_AVarSegment  avar_segment;                /* avar_segment[num_axis] */
315 
316     FT_Bool         hvar_loaded;
317     FT_Bool         hvar_checked;
318     FT_Error        hvar_error;
319     GX_HVVarTable   hvar_table;
320 
321     FT_Bool         vvar_loaded;
322     FT_Bool         vvar_checked;
323     FT_Error        vvar_error;
324     GX_HVVarTable   vvar_table;
325 
326     GX_MVarTable    mvar_table;
327 
328     FT_UInt         tuplecount;
329     FT_Fixed*       tuplecoords;      /* tuplecoords[tuplecount][num_axis] */
330 
331     FT_UInt         gv_glyphcnt;
332     FT_ULong*       glyphoffsets;         /* glyphoffsets[gv_glyphcnt + 1] */
333 
334     FT_ULong        gvar_size;
335 
336   } GX_BlendRec;
337 
338 
<span class="line-modified">339   /*************************************************************************/</span>
<span class="line-modified">340   /*                                                                       */</span>
<span class="line-modified">341   /* &lt;enum&gt;                                                                */</span>
<span class="line-modified">342   /*    GX_TupleCountFlags                                                 */</span>
<span class="line-modified">343   /*                                                                       */</span>
<span class="line-modified">344   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">345   /*    Flags used within the `TupleCount&#39; field of the `gvar&#39; table.      */</span>
<span class="line-modified">346   /*                                                                       */</span>
347   typedef enum  GX_TupleCountFlags_
348   {
349     GX_TC_TUPLES_SHARE_POINT_NUMBERS = 0x8000,
350     GX_TC_RESERVED_TUPLE_FLAGS       = 0x7000,
351     GX_TC_TUPLE_COUNT_MASK           = 0x0FFF
352 
353   } GX_TupleCountFlags;
354 
355 
<span class="line-modified">356   /*************************************************************************/</span>
<span class="line-modified">357   /*                                                                       */</span>
<span class="line-modified">358   /* &lt;enum&gt;                                                                */</span>
<span class="line-modified">359   /*    GX_TupleIndexFlags                                                 */</span>
<span class="line-modified">360   /*                                                                       */</span>
<span class="line-modified">361   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">362   /*    Flags used within the `TupleIndex&#39; field of the `gvar&#39; and `cvar&#39;  */</span>
<span class="line-modified">363   /*    tables.                                                            */</span>
<span class="line-modified">364   /*                                                                       */</span>
365   typedef enum  GX_TupleIndexFlags_
366   {
367     GX_TI_EMBEDDED_TUPLE_COORD  = 0x8000,
368     GX_TI_INTERMEDIATE_TUPLE    = 0x4000,
369     GX_TI_PRIVATE_POINT_NUMBERS = 0x2000,
370     GX_TI_RESERVED_TUPLE_FLAG   = 0x1000,
371     GX_TI_TUPLE_INDEX_MASK      = 0x0FFF
372 
373   } GX_TupleIndexFlags;
374 
375 
376 #define TTAG_wght  FT_MAKE_TAG( &#39;w&#39;, &#39;g&#39;, &#39;h&#39;, &#39;t&#39; )
377 #define TTAG_wdth  FT_MAKE_TAG( &#39;w&#39;, &#39;d&#39;, &#39;t&#39;, &#39;h&#39; )
378 #define TTAG_opsz  FT_MAKE_TAG( &#39;o&#39;, &#39;p&#39;, &#39;s&#39;, &#39;z&#39; )
379 #define TTAG_slnt  FT_MAKE_TAG( &#39;s&#39;, &#39;l&#39;, &#39;n&#39;, &#39;t&#39; )
380 
381 
382   FT_LOCAL( FT_Error )
383   TT_Set_MM_Blend( TT_Face    face,
384                    FT_UInt    num_coords,
</pre>
<hr />
<pre>
399                  FT_MM_Var*  *master );
400 
401   FT_LOCAL( FT_Error )
402   TT_Get_Var_Design( TT_Face    face,
403                      FT_UInt    num_coords,
404                      FT_Fixed*  coords );
405 
406   FT_LOCAL( FT_Error )
407   TT_Set_Named_Instance( TT_Face  face,
408                          FT_UInt  instance_index );
409 
410   FT_LOCAL( FT_Error )
411   tt_face_vary_cvt( TT_Face    face,
412                     FT_Stream  stream );
413 
414 
415   FT_LOCAL( FT_Error )
416   TT_Vary_Apply_Glyph_Deltas( TT_Face      face,
417                               FT_UInt      glyph_index,
418                               FT_Outline*  outline,

419                               FT_UInt      n_points );
420 
421   FT_LOCAL( FT_Error )
422   tt_hadvance_adjust( TT_Face  face,
423                       FT_UInt  gindex,
424                       FT_Int  *adelta );
425 
426   FT_LOCAL( FT_Error )
427   tt_vadvance_adjust( TT_Face  face,
428                       FT_UInt  gindex,
429                       FT_Int  *adelta );
430 
431   FT_LOCAL( void )
432   tt_apply_mvar( TT_Face  face );
433 
434   FT_LOCAL( FT_Error )
435   tt_get_var_blend( TT_Face      face,
436                     FT_UInt     *num_coords,
437                     FT_Fixed*   *coords,
438                     FT_Fixed*   *normalizedcoords,
</pre>
</td>
<td>
<hr />
<pre>
<span class="line-modified">  1 /****************************************************************************</span>
<span class="line-modified">  2  *</span>
<span class="line-modified">  3  * ttgxvar.h</span>
<span class="line-modified">  4  *</span>
<span class="line-modified">  5  *   TrueType GX Font Variation loader (specification)</span>
<span class="line-modified">  6  *</span>
<span class="line-modified">  7  * Copyright (C) 2004-2019 by</span>
<span class="line-modified">  8  * David Turner, Robert Wilhelm, Werner Lemberg and George Williams.</span>
<span class="line-modified">  9  *</span>
<span class="line-modified"> 10  * This file is part of the FreeType project, and may only be used,</span>
<span class="line-modified"> 11  * modified, and distributed under the terms of the FreeType project</span>
<span class="line-modified"> 12  * license, LICENSE.TXT.  By continuing to use, modify, or distribute</span>
<span class="line-modified"> 13  * this file you indicate that you have read the license and</span>
<span class="line-modified"> 14  * understand and accept it fully.</span>
<span class="line-modified"> 15  *</span>
<span class="line-modified"> 16  */</span>
 17 
 18 
 19 #ifndef TTGXVAR_H_
 20 #define TTGXVAR_H_
 21 
 22 
 23 #include &lt;ft2build.h&gt;
 24 #include &quot;ttobjs.h&quot;
 25 
 26 
 27 FT_BEGIN_HEADER
 28 
 29 
 30 #ifdef TT_CONFIG_OPTION_GX_VAR_SUPPORT
 31 
<span class="line-modified"> 32   /**************************************************************************</span>
<span class="line-modified"> 33    *</span>
<span class="line-modified"> 34    * @Struct:</span>
<span class="line-modified"> 35    *   GX_AVarCorrespondenceRec</span>
<span class="line-modified"> 36    *</span>
<span class="line-modified"> 37    * @Description:</span>
<span class="line-modified"> 38    *   A data structure representing `shortFracCorrespondence&#39; in `avar&#39;</span>
<span class="line-modified"> 39    *   table according to the specifications from Apple.</span>
<span class="line-modified"> 40    */</span>
 41   typedef struct  GX_AVarCorrespondenceRec_
 42   {
 43     FT_Fixed  fromCoord;
 44     FT_Fixed  toCoord;
 45 
 46   } GX_AVarCorrespondenceRec_, *GX_AVarCorrespondence;
 47 
 48 
<span class="line-modified"> 49   /**************************************************************************</span>
<span class="line-modified"> 50    *</span>
<span class="line-modified"> 51    * @Struct:</span>
<span class="line-modified"> 52    *   GX_AVarRec</span>
<span class="line-modified"> 53    *</span>
<span class="line-modified"> 54    * @Description:</span>
<span class="line-modified"> 55    *   Data from the segment field of `avar&#39; table.</span>
<span class="line-modified"> 56    *   There is one of these for each axis.</span>
<span class="line-modified"> 57    */</span>
 58   typedef struct  GX_AVarSegmentRec_
 59   {
 60     FT_UShort              pairCount;
 61     GX_AVarCorrespondence  correspondence; /* array with pairCount entries */
 62 
 63   } GX_AVarSegmentRec, *GX_AVarSegment;
 64 
 65 
 66   typedef struct  GX_ItemVarDataRec_
 67   {
 68     FT_UInt    itemCount;      /* number of delta sets per item         */
 69     FT_UInt    regionIdxCount; /* number of region indices in this data */
 70     FT_UInt*   regionIndices;  /* array of `regionCount&#39; indices;       */
 71                                /* these index `varRegionList&#39;           */
 72     FT_Short*  deltaSet;       /* array of `itemCount&#39; deltas           */
 73                                /* use `innerIndex&#39; for this array       */
 74 
 75   } GX_ItemVarDataRec, *GX_ItemVarData;
 76 
 77 
</pre>
<hr />
<pre>
 97   {
 98     FT_UInt         dataCount;
 99     GX_ItemVarData  varData;            /* array of dataCount records;     */
100                                         /* use `outerIndex&#39; for this array */
101     FT_UShort     axisCount;
102     FT_UInt       regionCount;          /* total number of regions defined */
103     GX_VarRegion  varRegionList;
104 
105   } GX_ItemVarStoreRec, *GX_ItemVarStore;
106 
107 
108   typedef struct  GX_DeltaSetIdxMapRec_
109   {
110     FT_UInt   mapCount;
111     FT_UInt*  outerIndex;             /* indices to item var data */
112     FT_UInt*  innerIndex;             /* indices to delta set     */
113 
114   } GX_DeltaSetIdxMapRec, *GX_DeltaSetIdxMap;
115 
116 
<span class="line-modified">117   /**************************************************************************</span>
<span class="line-modified">118    *</span>
<span class="line-modified">119    * @Struct:</span>
<span class="line-modified">120    *   GX_HVVarTableRec</span>
<span class="line-modified">121    *</span>
<span class="line-modified">122    * @Description:</span>
<span class="line-modified">123    *   Data from either the `HVAR&#39; or `VVAR&#39; table.</span>
<span class="line-modified">124    */</span>
125   typedef struct  GX_HVVarTableRec_
126   {
127     GX_ItemVarStoreRec    itemStore;        /* Item Variation Store  */
128     GX_DeltaSetIdxMapRec  widthMap;         /* Advance Width Mapping */
129 
130 #if 0
131     GX_DeltaSetIdxMapRec  lsbMap;           /* not implemented */
132     GX_DeltaSetIdxMapRec  rsbMap;           /* not implemented */
133 
134     GX_DeltaSetIdxMapRec  tsbMap;           /* not implemented */
135     GX_DeltaSetIdxMapRec  bsbMap;           /* not implemented */
136     GX_DeltaSetIdxMapRec  vorgMap;          /* not implemented */
137 #endif
138 
139   } GX_HVVarTableRec, *GX_HVVarTable;
140 
141 
142 #define MVAR_TAG_GASP_0  FT_MAKE_TAG( &#39;g&#39;, &#39;s&#39;, &#39;p&#39;, &#39;0&#39; )
143 #define MVAR_TAG_GASP_1  FT_MAKE_TAG( &#39;g&#39;, &#39;s&#39;, &#39;p&#39;, &#39;1&#39; )
144 #define MVAR_TAG_GASP_2  FT_MAKE_TAG( &#39;g&#39;, &#39;s&#39;, &#39;p&#39;, &#39;2&#39; )
</pre>
<hr />
<pre>
174 #define MVAR_TAG_VASC  FT_MAKE_TAG( &#39;v&#39;, &#39;a&#39;, &#39;s&#39;, &#39;c&#39; )
175 #define MVAR_TAG_VCOF  FT_MAKE_TAG( &#39;v&#39;, &#39;c&#39;, &#39;o&#39;, &#39;f&#39; )
176 #define MVAR_TAG_VCRN  FT_MAKE_TAG( &#39;v&#39;, &#39;c&#39;, &#39;r&#39;, &#39;n&#39; )
177 #define MVAR_TAG_VCRS  FT_MAKE_TAG( &#39;v&#39;, &#39;c&#39;, &#39;r&#39;, &#39;s&#39; )
178 #define MVAR_TAG_VDSC  FT_MAKE_TAG( &#39;v&#39;, &#39;d&#39;, &#39;s&#39;, &#39;c&#39; )
179 #define MVAR_TAG_VLGP  FT_MAKE_TAG( &#39;v&#39;, &#39;l&#39;, &#39;g&#39;, &#39;p&#39; )
180 #define MVAR_TAG_XHGT  FT_MAKE_TAG( &#39;x&#39;, &#39;h&#39;, &#39;g&#39;, &#39;t&#39; )
181 
182 
183   typedef struct  GX_ValueRec_
184   {
185     FT_ULong   tag;
186     FT_UShort  outerIndex;
187     FT_UShort  innerIndex;
188 
189     FT_Short  unmodified;  /* values are either FT_Short or FT_UShort */
190 
191   } GX_ValueRec, *GX_Value;
192 
193 
<span class="line-modified">194   /**************************************************************************</span>
<span class="line-modified">195    *</span>
<span class="line-modified">196    * @Struct:</span>
<span class="line-modified">197    *   GX_MVarTableRec</span>
<span class="line-modified">198    *</span>
<span class="line-modified">199    * @Description:</span>
<span class="line-modified">200    *   Data from the `MVAR&#39; table.</span>
<span class="line-modified">201    */</span>
202   typedef struct  GX_MVarTableRec_
203   {
204     FT_UShort  valueCount;
205 
206     GX_ItemVarStoreRec  itemStore;        /* Item Variation Store  */
207     GX_Value            values;           /* Value Records         */
208 
209   } GX_MVarTableRec, *GX_MVarTable;
210 
211 
<span class="line-modified">212   /**************************************************************************</span>
<span class="line-modified">213    *</span>
<span class="line-modified">214    * @Struct:</span>
<span class="line-modified">215    *   GX_BlendRec</span>
<span class="line-modified">216    *</span>
<span class="line-modified">217    * @Description:</span>
<span class="line-modified">218    *   Data for interpolating a font from a distortable font specified</span>
<span class="line-modified">219    *   by the GX *var tables ([fgcahvm]var).</span>
<span class="line-modified">220    *</span>
<span class="line-modified">221    * @Fields:</span>
<span class="line-modified">222    *   num_axis ::</span>
<span class="line-modified">223    *     The number of axes along which interpolation may happen.</span>
<span class="line-modified">224    *</span>
<span class="line-modified">225    *   coords ::</span>
<span class="line-modified">226    *     An array of design coordinates (in user space) indicating the</span>
<span class="line-modified">227    *     contribution along each axis to the final interpolated font.</span>
<span class="line-modified">228    *     `normalizedcoords&#39; holds the same values.</span>
<span class="line-modified">229    *</span>
<span class="line-modified">230    *   normalizedcoords ::</span>
<span class="line-modified">231    *     An array of normalized values (between [-1,1]) indicating the</span>
<span class="line-modified">232    *     contribution along each axis to the final interpolated font.</span>
<span class="line-modified">233    *     `coords&#39; holds the same values.</span>
<span class="line-modified">234    *</span>
<span class="line-modified">235    *   mmvar ::</span>
<span class="line-modified">236    *     Data from the `fvar&#39; table.</span>
<span class="line-modified">237    *</span>
<span class="line-modified">238    *   mmvar_len ::</span>
<span class="line-modified">239    *     The length of the `mmvar&#39; structure.</span>
<span class="line-modified">240    *</span>
<span class="line-modified">241    *   normalized_stylecoords ::</span>
<span class="line-modified">242    *     A two-dimensional array that holds the named instance data from</span>
<span class="line-modified">243    *     `mmvar&#39; as normalized values.</span>
<span class="line-modified">244    *</span>
<span class="line-modified">245    *   avar_loaded ::</span>
<span class="line-modified">246    *     A Boolean; if set, FreeType tried to load (and parse) the `avar&#39;</span>
<span class="line-modified">247    *     table.</span>
<span class="line-modified">248    *</span>
<span class="line-modified">249    *   avar_segment ::</span>
<span class="line-modified">250    *     Data from the `avar&#39; table.</span>
<span class="line-modified">251    *</span>
<span class="line-modified">252    *   hvar_loaded ::</span>
<span class="line-modified">253    *     A Boolean; if set, FreeType tried to load (and parse) the `hvar&#39;</span>
<span class="line-modified">254    *     table.</span>
<span class="line-modified">255    *</span>
<span class="line-modified">256    *   hvar_checked ::</span>
<span class="line-modified">257    *     A Boolean; if set, FreeType successfully loaded and parsed the</span>
<span class="line-modified">258    *     `hvar&#39; table.</span>
<span class="line-modified">259    *</span>
<span class="line-modified">260    *   hvar_error ::</span>
<span class="line-modified">261    *     If loading and parsing of the `hvar&#39; table failed, this field</span>
<span class="line-modified">262    *     holds the corresponding error code.</span>
<span class="line-modified">263    *</span>
<span class="line-modified">264    *   hvar_table ::</span>
<span class="line-modified">265    *     Data from the `hvar&#39; table.</span>
<span class="line-modified">266    *</span>
<span class="line-modified">267    *   vvar_loaded ::</span>
<span class="line-modified">268    *     A Boolean; if set, FreeType tried to load (and parse) the `vvar&#39;</span>
<span class="line-modified">269    *     table.</span>
<span class="line-modified">270    *</span>
<span class="line-modified">271    *   vvar_checked ::</span>
<span class="line-modified">272    *     A Boolean; if set, FreeType successfully loaded and parsed the</span>
<span class="line-modified">273    *     `vvar&#39; table.</span>
<span class="line-modified">274    *</span>
<span class="line-modified">275    *   vvar_error ::</span>
<span class="line-modified">276    *     If loading and parsing of the `vvar&#39; table failed, this field</span>
<span class="line-modified">277    *     holds the corresponding error code.</span>
<span class="line-modified">278    *</span>
<span class="line-modified">279    *   vvar_table ::</span>
<span class="line-modified">280    *     Data from the `vvar&#39; table.</span>
<span class="line-modified">281    *</span>
<span class="line-modified">282    *   mvar_table ::</span>
<span class="line-modified">283    *     Data from the `mvar&#39; table.</span>
<span class="line-modified">284    *</span>
<span class="line-modified">285    *   tuplecount ::</span>
<span class="line-modified">286    *     The number of shared tuples in the `gvar&#39; table.</span>
<span class="line-modified">287    *</span>
<span class="line-modified">288    *   tuplecoords ::</span>
<span class="line-modified">289    *     A two-dimensional array that holds the shared tuple coordinates</span>
<span class="line-modified">290    *     in the `gvar&#39; table.</span>
<span class="line-modified">291    *</span>
<span class="line-modified">292    *   gv_glyphcnt ::</span>
<span class="line-modified">293    *     The number of glyphs handled in the `gvar&#39; table.</span>
<span class="line-modified">294    *</span>
<span class="line-modified">295    *   glyphoffsets ::</span>
<span class="line-modified">296    *     Offsets into the glyph variation data array.</span>
<span class="line-modified">297    *</span>
<span class="line-modified">298    *   gvar_size ::</span>
<span class="line-modified">299    *     The size of the `gvar&#39; table.</span>
<span class="line-modified">300    */</span>
301   typedef struct  GX_BlendRec_
302   {
303     FT_UInt         num_axis;
304     FT_Fixed*       coords;
305     FT_Fixed*       normalizedcoords;
306 
307     FT_MM_Var*      mmvar;
308     FT_Offset       mmvar_len;
309 
310     FT_Fixed*       normalized_stylecoords;
311                       /* normalized_stylecoords[num_namedstyles][num_axis] */
312 
313     FT_Bool         avar_loaded;
314     GX_AVarSegment  avar_segment;                /* avar_segment[num_axis] */
315 
316     FT_Bool         hvar_loaded;
317     FT_Bool         hvar_checked;
318     FT_Error        hvar_error;
319     GX_HVVarTable   hvar_table;
320 
321     FT_Bool         vvar_loaded;
322     FT_Bool         vvar_checked;
323     FT_Error        vvar_error;
324     GX_HVVarTable   vvar_table;
325 
326     GX_MVarTable    mvar_table;
327 
328     FT_UInt         tuplecount;
329     FT_Fixed*       tuplecoords;      /* tuplecoords[tuplecount][num_axis] */
330 
331     FT_UInt         gv_glyphcnt;
332     FT_ULong*       glyphoffsets;         /* glyphoffsets[gv_glyphcnt + 1] */
333 
334     FT_ULong        gvar_size;
335 
336   } GX_BlendRec;
337 
338 
<span class="line-modified">339   /**************************************************************************</span>
<span class="line-modified">340    *</span>
<span class="line-modified">341    * @enum:</span>
<span class="line-modified">342    *   GX_TupleCountFlags</span>
<span class="line-modified">343    *</span>
<span class="line-modified">344    * @Description:</span>
<span class="line-modified">345    *   Flags used within the `TupleCount&#39; field of the `gvar&#39; table.</span>
<span class="line-modified">346    */</span>
347   typedef enum  GX_TupleCountFlags_
348   {
349     GX_TC_TUPLES_SHARE_POINT_NUMBERS = 0x8000,
350     GX_TC_RESERVED_TUPLE_FLAGS       = 0x7000,
351     GX_TC_TUPLE_COUNT_MASK           = 0x0FFF
352 
353   } GX_TupleCountFlags;
354 
355 
<span class="line-modified">356   /**************************************************************************</span>
<span class="line-modified">357    *</span>
<span class="line-modified">358    * @enum:</span>
<span class="line-modified">359    *   GX_TupleIndexFlags</span>
<span class="line-modified">360    *</span>
<span class="line-modified">361    * @Description:</span>
<span class="line-modified">362    *   Flags used within the `TupleIndex&#39; field of the `gvar&#39; and `cvar&#39;</span>
<span class="line-modified">363    *   tables.</span>
<span class="line-modified">364    */</span>
365   typedef enum  GX_TupleIndexFlags_
366   {
367     GX_TI_EMBEDDED_TUPLE_COORD  = 0x8000,
368     GX_TI_INTERMEDIATE_TUPLE    = 0x4000,
369     GX_TI_PRIVATE_POINT_NUMBERS = 0x2000,
370     GX_TI_RESERVED_TUPLE_FLAG   = 0x1000,
371     GX_TI_TUPLE_INDEX_MASK      = 0x0FFF
372 
373   } GX_TupleIndexFlags;
374 
375 
376 #define TTAG_wght  FT_MAKE_TAG( &#39;w&#39;, &#39;g&#39;, &#39;h&#39;, &#39;t&#39; )
377 #define TTAG_wdth  FT_MAKE_TAG( &#39;w&#39;, &#39;d&#39;, &#39;t&#39;, &#39;h&#39; )
378 #define TTAG_opsz  FT_MAKE_TAG( &#39;o&#39;, &#39;p&#39;, &#39;s&#39;, &#39;z&#39; )
379 #define TTAG_slnt  FT_MAKE_TAG( &#39;s&#39;, &#39;l&#39;, &#39;n&#39;, &#39;t&#39; )
380 
381 
382   FT_LOCAL( FT_Error )
383   TT_Set_MM_Blend( TT_Face    face,
384                    FT_UInt    num_coords,
</pre>
<hr />
<pre>
399                  FT_MM_Var*  *master );
400 
401   FT_LOCAL( FT_Error )
402   TT_Get_Var_Design( TT_Face    face,
403                      FT_UInt    num_coords,
404                      FT_Fixed*  coords );
405 
406   FT_LOCAL( FT_Error )
407   TT_Set_Named_Instance( TT_Face  face,
408                          FT_UInt  instance_index );
409 
410   FT_LOCAL( FT_Error )
411   tt_face_vary_cvt( TT_Face    face,
412                     FT_Stream  stream );
413 
414 
415   FT_LOCAL( FT_Error )
416   TT_Vary_Apply_Glyph_Deltas( TT_Face      face,
417                               FT_UInt      glyph_index,
418                               FT_Outline*  outline,
<span class="line-added">419                               FT_Vector*   unrounded,</span>
420                               FT_UInt      n_points );
421 
422   FT_LOCAL( FT_Error )
423   tt_hadvance_adjust( TT_Face  face,
424                       FT_UInt  gindex,
425                       FT_Int  *adelta );
426 
427   FT_LOCAL( FT_Error )
428   tt_vadvance_adjust( TT_Face  face,
429                       FT_UInt  gindex,
430                       FT_Int  *adelta );
431 
432   FT_LOCAL( void )
433   tt_apply_mvar( TT_Face  face );
434 
435   FT_LOCAL( FT_Error )
436   tt_get_var_blend( TT_Face      face,
437                     FT_UInt     *num_coords,
438                     FT_Fixed*   *coords,
439                     FT_Fixed*   *normalizedcoords,
</pre>
</td>
</tr>
</table>
<center><a href="ttgxvar.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ttinterp.c.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>