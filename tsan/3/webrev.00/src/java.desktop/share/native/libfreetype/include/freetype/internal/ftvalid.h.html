<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/java.desktop/share/native/libfreetype/include/freetype/internal/ftvalid.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /****************************************************************************
  2  *
  3  * ftvalid.h
  4  *
  5  *   FreeType validation support (specification).
  6  *
  7  * Copyright (C) 2004-2019 by
  8  * David Turner, Robert Wilhelm, and Werner Lemberg.
  9  *
 10  * This file is part of the FreeType project, and may only be used,
 11  * modified, and distributed under the terms of the FreeType project
 12  * license, LICENSE.TXT.  By continuing to use, modify, or distribute
 13  * this file you indicate that you have read the license and
 14  * understand and accept it fully.
 15  *
 16  */
 17 
 18 
 19 #ifndef FTVALID_H_
 20 #define FTVALID_H_
 21 
 22 #include &lt;ft2build.h&gt;
 23 #include FT_CONFIG_STANDARD_LIBRARY_H   /* for ft_setjmp and ft_longjmp */
 24 
 25 
 26 FT_BEGIN_HEADER
 27 
 28 
 29   /*************************************************************************/
 30   /*************************************************************************/
 31   /*************************************************************************/
 32   /****                                                                 ****/
 33   /****                                                                 ****/
 34   /****                    V A L I D A T I O N                          ****/
 35   /****                                                                 ****/
 36   /****                                                                 ****/
 37   /*************************************************************************/
 38   /*************************************************************************/
 39   /*************************************************************************/
 40 
 41   /* handle to a validation object */
 42   typedef struct FT_ValidatorRec_ volatile*  FT_Validator;
 43 
 44 
 45   /**************************************************************************
 46    *
 47    * There are three distinct validation levels defined here:
 48    *
 49    * FT_VALIDATE_DEFAULT ::
 50    *   A table that passes this validation level can be used reliably by
 51    *   FreeType.  It generally means that all offsets have been checked to
 52    *   prevent out-of-bound reads, that array counts are correct, etc.
 53    *
 54    * FT_VALIDATE_TIGHT ::
 55    *   A table that passes this validation level can be used reliably and
 56    *   doesn&#39;t contain invalid data.  For example, a charmap table that
 57    *   returns invalid glyph indices will not pass, even though it can be
 58    *   used with FreeType in default mode (the library will simply return an
 59    *   error later when trying to load the glyph).
 60    *
 61    *   It also checks that fields which must be a multiple of 2, 4, or 8,
 62    *   don&#39;t have incorrect values, etc.
 63    *
 64    * FT_VALIDATE_PARANOID ::
 65    *   Only for font debugging.  Checks that a table follows the
 66    *   specification by 100%.  Very few fonts will be able to pass this level
 67    *   anyway but it can be useful for certain tools like font
 68    *   editors/converters.
 69    */
 70   typedef enum  FT_ValidationLevel_
 71   {
 72     FT_VALIDATE_DEFAULT = 0,
 73     FT_VALIDATE_TIGHT,
 74     FT_VALIDATE_PARANOID
 75 
 76   } FT_ValidationLevel;
 77 
 78 
 79 #if defined( _MSC_VER )      /* Visual C++ (and Intel C++) */
 80   /* We disable the warning `structure was padded due to   */
 81   /* __declspec(align())&#39; in order to compile cleanly with */
 82   /* the maximum level of warnings.                        */
 83 #pragma warning( push )
 84 #pragma warning( disable : 4324 )
 85 #endif /* _MSC_VER */
 86 
 87   /* validator structure */
 88   typedef struct  FT_ValidatorRec_
 89   {
 90     ft_jmp_buf          jump_buffer; /* used for exception handling      */
 91 
 92     const FT_Byte*      base;        /* address of table in memory       */
 93     const FT_Byte*      limit;       /* `base&#39; + sizeof(table) in memory */
 94     FT_ValidationLevel  level;       /* validation level                 */
 95     FT_Error            error;       /* error returned. 0 means success  */
 96 
 97   } FT_ValidatorRec;
 98 
 99 #if defined( _MSC_VER )
100 #pragma warning( pop )
101 #endif
102 
103 #define FT_VALIDATOR( x )  ( (FT_Validator)( x ) )
104 
105 
106   FT_BASE( void )
107   ft_validator_init( FT_Validator        valid,
108                      const FT_Byte*      base,
109                      const FT_Byte*      limit,
110                      FT_ValidationLevel  level );
111 
112   /* Do not use this. It&#39;s broken and will cause your validator to crash */
113   /* if you run it on an invalid font.                                   */
114   FT_BASE( FT_Int )
115   ft_validator_run( FT_Validator  valid );
116 
117   /* Sets the error field in a validator, then calls `longjmp&#39; to return */
118   /* to high-level caller.  Using `setjmp/longjmp&#39; avoids many stupid    */
119   /* error checks within the validation routines.                        */
120   /*                                                                     */
121   FT_BASE( void )
122   ft_validator_error( FT_Validator  valid,
123                       FT_Error      error );
124 
125 
126   /* Calls ft_validate_error.  Assumes that the `valid&#39; local variable */
127   /* holds a pointer to the current validator object.                  */
128   /*                                                                   */
129 #define FT_INVALID( _error )  FT_INVALID_( _error )
130 #define FT_INVALID_( _error ) \
131           ft_validator_error( valid, FT_THROW( _error ) )
132 
133   /* called when a broken table is detected */
134 #define FT_INVALID_TOO_SHORT \
135           FT_INVALID( Invalid_Table )
136 
137   /* called when an invalid offset is detected */
138 #define FT_INVALID_OFFSET \
139           FT_INVALID( Invalid_Offset )
140 
141   /* called when an invalid format/value is detected */
142 #define FT_INVALID_FORMAT \
143           FT_INVALID( Invalid_Table )
144 
145   /* called when an invalid glyph index is detected */
146 #define FT_INVALID_GLYPH_ID \
147           FT_INVALID( Invalid_Glyph_Index )
148 
149   /* called when an invalid field value is detected */
150 #define FT_INVALID_DATA \
151           FT_INVALID( Invalid_Table )
152 
153 
154 FT_END_HEADER
155 
156 #endif /* FTVALID_H_ */
157 
158 
159 /* END */
    </pre>
  </body>
</html>