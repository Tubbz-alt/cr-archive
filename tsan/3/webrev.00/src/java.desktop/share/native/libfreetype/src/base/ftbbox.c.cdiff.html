<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/share/native/libfreetype/src/base/ftbbox.c</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="ftbase.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ftbitmap.c.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfreetype/src/base/ftbbox.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,29 ***</span>
<span class="line-modified">! /***************************************************************************/</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /*  ftbbox.c                                                               */</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /*    FreeType bbox computation (body).                                    */</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /*  Copyright 1996-2018 by                                                 */</span>
<span class="line-modified">! /*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /*  This file is part of the FreeType project, and may only be used        */</span>
<span class="line-modified">! /*  modified and distributed under the terms of the FreeType project       */</span>
<span class="line-modified">! /*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<span class="line-modified">! /*  this file you indicate that you have read the license and              */</span>
<span class="line-modified">! /*  understand and accept it fully.                                        */</span>
<span class="line-modified">! /*                                                                         */</span>
<span class="line-modified">! /***************************************************************************/</span>
<span class="line-modified">! </span>
<span class="line-modified">! </span>
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* This component has a _single_ role: to compute exact outline bounding */</span>
<span class="line-modified">!   /* boxes.                                                                */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*************************************************************************/</span>
  
  
  #include &lt;ft2build.h&gt;
  #include FT_INTERNAL_DEBUG_H
  
<span class="line-new-header">--- 1,29 ---</span>
<span class="line-modified">! /****************************************************************************</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  * ftbbox.c</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  *   FreeType bbox computation (body).</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  * Copyright (C) 1996-2019 by</span>
<span class="line-modified">!  * David Turner, Robert Wilhelm, and Werner Lemberg.</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  * This file is part of the FreeType project, and may only be used</span>
<span class="line-modified">!  * modified and distributed under the terms of the FreeType project</span>
<span class="line-modified">!  * license, LICENSE.TXT.  By continuing to use, modify, or distribute</span>
<span class="line-modified">!  * this file you indicate that you have read the license and</span>
<span class="line-modified">!  * understand and accept it fully.</span>
<span class="line-modified">!  *</span>
<span class="line-modified">!  */</span>
<span class="line-modified">! </span>
<span class="line-modified">! </span>
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * This component has a _single_ role: to compute exact outline bounding</span>
<span class="line-modified">!    * boxes.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    */</span>
  
  
  #include &lt;ft2build.h&gt;
  #include FT_INTERNAL_DEBUG_H
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 59,30 ***</span>
  
  #define CHECK_Y( p, bbox )                         \
            ( p-&gt;y &lt; bbox.yMin || p-&gt;y &gt; bbox.yMax )
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Function&gt;                                                            */</span>
<span class="line-modified">!   /*    BBox_Move_To                                                       */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    This function is used as a `move_to&#39; emitter during                */</span>
<span class="line-modified">!   /*    FT_Outline_Decompose().  It simply records the destination point   */</span>
<span class="line-modified">!   /*    in `user-&gt;last&#39;. We also update bbox in case contour starts with   */</span>
<span class="line-modified">!   /*    an implicit `on&#39; point.                                            */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Input&gt;                                                               */</span>
<span class="line-modified">!   /*    to   :: A pointer to the destination vector.                       */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;InOut&gt;                                                               */</span>
<span class="line-modified">!   /*    user :: A pointer to the current walk context.                     */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Return&gt;                                                              */</span>
<span class="line-modified">!   /*    Always 0.  Needed for the interface only.                          */</span>
<span class="line-modified">!   /*                                                                       */</span>
    static int
    BBox_Move_To( FT_Vector*  to,
                  TBBox_Rec*  user )
    {
      FT_UPDATE_BBOX( to, user-&gt;bbox );
<span class="line-new-header">--- 59,32 ---</span>
  
  #define CHECK_Y( p, bbox )                         \
            ( p-&gt;y &lt; bbox.yMin || p-&gt;y &gt; bbox.yMax )
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Function:</span>
<span class="line-modified">!    *   BBox_Move_To</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Description:</span>
<span class="line-modified">!    *   This function is used as a `move_to&#39; emitter during</span>
<span class="line-modified">!    *   FT_Outline_Decompose().  It simply records the destination point</span>
<span class="line-modified">!    *   in `user-&gt;last&#39;. We also update bbox in case contour starts with</span>
<span class="line-modified">!    *   an implicit `on&#39; point.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Input:</span>
<span class="line-modified">!    *   to ::</span>
<span class="line-modified">!    *     A pointer to the destination vector.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @InOut:</span>
<span class="line-modified">!    *   user ::</span>
<span class="line-modified">!    *     A pointer to the current walk context.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Return:</span>
<span class="line-added">+    *   Always 0.  Needed for the interface only.</span>
<span class="line-added">+    */</span>
    static int
    BBox_Move_To( FT_Vector*  to,
                  TBBox_Rec*  user )
    {
      FT_UPDATE_BBOX( to, user-&gt;bbox );
</pre>
<hr />
<pre>
<span class="line-old-header">*** 91,62 ***</span>
  
      return 0;
    }
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Function&gt;                                                            */</span>
<span class="line-modified">!   /*    BBox_Line_To                                                       */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    This function is used as a `line_to&#39; emitter during                */</span>
<span class="line-modified">!   /*    FT_Outline_Decompose().  It simply records the destination point   */</span>
<span class="line-modified">!   /*    in `user-&gt;last&#39;; no further computations are necessary because     */</span>
<span class="line-modified">!   /*    bbox already contains both explicit ends of the line segment.      */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Input&gt;                                                               */</span>
<span class="line-modified">!   /*    to   :: A pointer to the destination vector.                       */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;InOut&gt;                                                               */</span>
<span class="line-modified">!   /*    user :: A pointer to the current walk context.                     */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Return&gt;                                                              */</span>
<span class="line-modified">!   /*    Always 0.  Needed for the interface only.                          */</span>
<span class="line-modified">!   /*                                                                       */</span>
    static int
    BBox_Line_To( FT_Vector*  to,
                  TBBox_Rec*  user )
    {
      user-&gt;last = *to;
  
      return 0;
    }
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Function&gt;                                                            */</span>
<span class="line-modified">!   /*    BBox_Conic_Check                                                   */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    Find the extrema of a 1-dimensional conic Bezier curve and update  */</span>
<span class="line-modified">!   /*    a bounding range.  This version uses direct computation, as it     */</span>
<span class="line-modified">!   /*    doesn&#39;t need square roots.                                         */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Input&gt;                                                               */</span>
<span class="line-modified">!   /*    y1  :: The start coordinate.                                       */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    y2  :: The coordinate of the control point.                        */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    y3  :: The end coordinate.                                         */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;InOut&gt;                                                               */</span>
<span class="line-modified">!   /*    min :: The address of the current minimum.                         */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    max :: The address of the current maximum.                         */</span>
<span class="line-modified">!   /*                                                                       */</span>
    static void
    BBox_Conic_Check( FT_Pos   y1,
                      FT_Pos   y2,
                      FT_Pos   y3,
                      FT_Pos*  min,
<span class="line-new-header">--- 93,69 ---</span>
  
      return 0;
    }
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Function:</span>
<span class="line-modified">!    *   BBox_Line_To</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Description:</span>
<span class="line-modified">!    *   This function is used as a `line_to&#39; emitter during</span>
<span class="line-modified">!    *   FT_Outline_Decompose().  It simply records the destination point</span>
<span class="line-modified">!    *   in `user-&gt;last&#39;; no further computations are necessary because</span>
<span class="line-modified">!    *   bbox already contains both explicit ends of the line segment.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Input:</span>
<span class="line-modified">!    *   to ::</span>
<span class="line-modified">!    *     A pointer to the destination vector.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @InOut:</span>
<span class="line-modified">!    *   user ::</span>
<span class="line-modified">!    *     A pointer to the current walk context.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Return:</span>
<span class="line-added">+    *   Always 0.  Needed for the interface only.</span>
<span class="line-added">+    */</span>
    static int
    BBox_Line_To( FT_Vector*  to,
                  TBBox_Rec*  user )
    {
      user-&gt;last = *to;
  
      return 0;
    }
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Function:</span>
<span class="line-modified">!    *   BBox_Conic_Check</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Description:</span>
<span class="line-modified">!    *   Find the extrema of a 1-dimensional conic Bezier curve and update</span>
<span class="line-modified">!    *   a bounding range.  This version uses direct computation, as it</span>
<span class="line-modified">!    *   doesn&#39;t need square roots.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Input:</span>
<span class="line-modified">!    *   y1 ::</span>
<span class="line-modified">!    *     The start coordinate.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   y2 ::</span>
<span class="line-modified">!    *     The coordinate of the control point.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   y3 ::</span>
<span class="line-modified">!    *     The end coordinate.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @InOut:</span>
<span class="line-modified">!    *   min ::</span>
<span class="line-added">+    *     The address of the current minimum.</span>
<span class="line-added">+    *</span>
<span class="line-added">+    *   max ::</span>
<span class="line-added">+    *     The address of the current maximum.</span>
<span class="line-added">+    */</span>
    static void
    BBox_Conic_Check( FT_Pos   y1,
                      FT_Pos   y2,
                      FT_Pos   y3,
                      FT_Pos*  min,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 166,36 ***</span>
      if ( y2 &gt; *max )
        *max = y2;
    }
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Function&gt;                                                            */</span>
<span class="line-modified">!   /*    BBox_Conic_To                                                      */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    This function is used as a `conic_to&#39; emitter during               */</span>
<span class="line-modified">!   /*    FT_Outline_Decompose().  It checks a conic Bezier curve with the   */</span>
<span class="line-modified">!   /*    current bounding box, and computes its extrema if necessary to     */</span>
<span class="line-modified">!   /*    update it.                                                         */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Input&gt;                                                               */</span>
<span class="line-modified">!   /*    control :: A pointer to a control point.                           */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    to      :: A pointer to the destination vector.                    */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;InOut&gt;                                                               */</span>
<span class="line-modified">!   /*    user    :: The address of the current walk context.                */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Return&gt;                                                              */</span>
<span class="line-modified">!   /*    Always 0.  Needed for the interface only.                          */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Note&gt;                                                                */</span>
<span class="line-modified">!   /*    In the case of a non-monotonous arc, we compute directly the       */</span>
<span class="line-modified">!   /*    extremum coordinates, as it is sufficiently fast.                  */</span>
<span class="line-modified">!   /*                                                                       */</span>
    static int
    BBox_Conic_To( FT_Vector*  control,
                   FT_Vector*  to,
                   TBBox_Rec*  user )
    {
<span class="line-new-header">--- 175,39 ---</span>
      if ( y2 &gt; *max )
        *max = y2;
    }
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Function:</span>
<span class="line-modified">!    *   BBox_Conic_To</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Description:</span>
<span class="line-modified">!    *   This function is used as a `conic_to&#39; emitter during</span>
<span class="line-modified">!    *   FT_Outline_Decompose().  It checks a conic Bezier curve with the</span>
<span class="line-modified">!    *   current bounding box, and computes its extrema if necessary to</span>
<span class="line-modified">!    *   update it.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Input:</span>
<span class="line-modified">!    *   control ::</span>
<span class="line-modified">!    *     A pointer to a control point.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   to ::</span>
<span class="line-modified">!    *     A pointer to the destination vector.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @InOut:</span>
<span class="line-modified">!    *   user ::</span>
<span class="line-modified">!    *     The address of the current walk context.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Return:</span>
<span class="line-modified">!    *   Always 0.  Needed for the interface only.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Note:</span>
<span class="line-added">+    *   In the case of a non-monotonous arc, we compute directly the</span>
<span class="line-added">+    *   extremum coordinates, as it is sufficiently fast.</span>
<span class="line-added">+    */</span>
    static int
    BBox_Conic_To( FT_Vector*  control,
                   FT_Vector*  to,
                   TBBox_Rec*  user )
    {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 220,34 ***</span>
  
      return 0;
    }
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Function&gt;                                                            */</span>
<span class="line-modified">!   /*    BBox_Cubic_Check                                                   */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    Find the extrema of a 1-dimensional cubic Bezier curve and         */</span>
<span class="line-modified">!   /*    update a bounding range.  This version uses iterative splitting    */</span>
<span class="line-modified">!   /*    because it is faster than the exact solution with square roots.    */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Input&gt;                                                               */</span>
<span class="line-modified">!   /*    p1  :: The start coordinate.                                       */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    p2  :: The coordinate of the first control point.                  */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    p3  :: The coordinate of the second control point.                 */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    p4  :: The end coordinate.                                         */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;InOut&gt;                                                               */</span>
<span class="line-modified">!   /*    min :: The address of the current minimum.                         */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    max :: The address of the current maximum.                         */</span>
<span class="line-modified">!   /*                                                                       */</span>
    static FT_Pos
    cubic_peak( FT_Pos  q1,
                FT_Pos  q2,
                FT_Pos  q3,
                FT_Pos  q4 )
<span class="line-new-header">--- 232,40 ---</span>
  
      return 0;
    }
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Function:</span>
<span class="line-modified">!    *   BBox_Cubic_Check</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Description:</span>
<span class="line-modified">!    *   Find the extrema of a 1-dimensional cubic Bezier curve and</span>
<span class="line-modified">!    *   update a bounding range.  This version uses iterative splitting</span>
<span class="line-modified">!    *   because it is faster than the exact solution with square roots.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Input:</span>
<span class="line-modified">!    *   p1 ::</span>
<span class="line-modified">!    *     The start coordinate.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   p2 ::</span>
<span class="line-modified">!    *     The coordinate of the first control point.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   p3 ::</span>
<span class="line-modified">!    *     The coordinate of the second control point.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   p4 ::</span>
<span class="line-modified">!    *     The end coordinate.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @InOut:</span>
<span class="line-added">+    *   min ::</span>
<span class="line-added">+    *     The address of the current minimum.</span>
<span class="line-added">+    *</span>
<span class="line-added">+    *   max ::</span>
<span class="line-added">+    *     The address of the current maximum.</span>
<span class="line-added">+    */</span>
    static FT_Pos
    cubic_peak( FT_Pos  q1,
                FT_Pos  q2,
                FT_Pos  q3,
                FT_Pos  q4 )
</pre>
<hr />
<pre>
<span class="line-old-header">*** 299,24 ***</span>
          q4 = q4 + q3;
          q3 = q3 + q2;
          q2 = q2 + q1;
          q4 = q4 + q3;
          q3 = q3 + q2;
<span class="line-modified">!         q4 = ( q4 + q3 ) / 8;</span>
<span class="line-modified">!         q3 = q3 / 4;</span>
<span class="line-modified">!         q2 = q2 / 2;</span>
        }
        else                     /* second half */
        {
          q1 = q1 + q2;
          q2 = q2 + q3;
          q3 = q3 + q4;
          q1 = q1 + q2;
          q2 = q2 + q3;
<span class="line-modified">!         q1 = ( q1 + q2 ) / 8;</span>
<span class="line-modified">!         q2 = q2 / 4;</span>
<span class="line-modified">!         q3 = q3 / 2;</span>
        }
  
        /* check whether either end reached the maximum */
        if ( q1 == q2 &amp;&amp; q1 &gt;= q3 )
        {
<span class="line-new-header">--- 317,24 ---</span>
          q4 = q4 + q3;
          q3 = q3 + q2;
          q2 = q2 + q1;
          q4 = q4 + q3;
          q3 = q3 + q2;
<span class="line-modified">!         q4 = ( q4 + q3 ) &gt;&gt; 3;</span>
<span class="line-modified">!         q3 = q3 &gt;&gt; 2;</span>
<span class="line-modified">!         q2 = q2 &gt;&gt; 1;</span>
        }
        else                     /* second half */
        {
          q1 = q1 + q2;
          q2 = q2 + q3;
          q3 = q3 + q4;
          q1 = q1 + q2;
          q2 = q2 + q3;
<span class="line-modified">!         q1 = ( q1 + q2 ) &gt;&gt; 3;</span>
<span class="line-modified">!         q2 = q2 &gt;&gt; 2;</span>
<span class="line-modified">!         q3 = q3 &gt;&gt; 1;</span>
        }
  
        /* check whether either end reached the maximum */
        if ( q1 == q2 &amp;&amp; q1 &gt;= q3 )
        {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 359,38 ***</span>
      if ( p2 &lt; *min || p3 &lt; *min )
        *min -= cubic_peak( *min - p1, *min - p2, *min - p3, *min - p4 );
    }
  
  
<span class="line-modified">!   /*************************************************************************/</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Function&gt;                                                            */</span>
<span class="line-modified">!   /*    BBox_Cubic_To                                                      */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">!   /*    This function is used as a `cubic_to&#39; emitter during               */</span>
<span class="line-modified">!   /*    FT_Outline_Decompose().  It checks a cubic Bezier curve with the   */</span>
<span class="line-modified">!   /*    current bounding box, and computes its extrema if necessary to     */</span>
<span class="line-modified">!   /*    update it.                                                         */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Input&gt;                                                               */</span>
<span class="line-modified">!   /*    control1 :: A pointer to the first control point.                  */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    control2 :: A pointer to the second control point.                 */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /*    to       :: A pointer to the destination vector.                   */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;InOut&gt;                                                               */</span>
<span class="line-modified">!   /*    user     :: The address of the current walk context.               */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Return&gt;                                                              */</span>
<span class="line-modified">!   /*    Always 0.  Needed for the interface only.                          */</span>
<span class="line-modified">!   /*                                                                       */</span>
<span class="line-modified">!   /* &lt;Note&gt;                                                                */</span>
<span class="line-modified">!   /*    In the case of a non-monotonous arc, we don&#39;t compute directly     */</span>
<span class="line-modified">!   /*    extremum coordinates, we subdivide instead.                        */</span>
<span class="line-modified">!   /*                                                                       */</span>
    static int
    BBox_Cubic_To( FT_Vector*  control1,
                   FT_Vector*  control2,
                   FT_Vector*  to,
                   TBBox_Rec*  user )
<span class="line-new-header">--- 377,42 ---</span>
      if ( p2 &lt; *min || p3 &lt; *min )
        *min -= cubic_peak( *min - p1, *min - p2, *min - p3, *min - p4 );
    }
  
  
<span class="line-modified">!   /**************************************************************************</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Function:</span>
<span class="line-modified">!    *   BBox_Cubic_To</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Description:</span>
<span class="line-modified">!    *   This function is used as a `cubic_to&#39; emitter during</span>
<span class="line-modified">!    *   FT_Outline_Decompose().  It checks a cubic Bezier curve with the</span>
<span class="line-modified">!    *   current bounding box, and computes its extrema if necessary to</span>
<span class="line-modified">!    *   update it.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Input:</span>
<span class="line-modified">!    *   control1 ::</span>
<span class="line-modified">!    *     A pointer to the first control point.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   control2 ::</span>
<span class="line-modified">!    *     A pointer to the second control point.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    *   to ::</span>
<span class="line-modified">!    *     A pointer to the destination vector.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @InOut:</span>
<span class="line-modified">!    *   user ::</span>
<span class="line-modified">!    *     The address of the current walk context.</span>
<span class="line-modified">!    *</span>
<span class="line-modified">!    * @Return:</span>
<span class="line-modified">!    *   Always 0.  Needed for the interface only.</span>
<span class="line-modified">!    *</span>
<span class="line-added">+    * @Note:</span>
<span class="line-added">+    *   In the case of a non-monotonous arc, we don&#39;t compute directly</span>
<span class="line-added">+    *   extremum coordinates, we subdivide instead.</span>
<span class="line-added">+    */</span>
    static int
    BBox_Cubic_To( FT_Vector*  control1,
                   FT_Vector*  control2,
                   FT_Vector*  to,
                   TBBox_Rec*  user )
</pre>
<hr />
<pre>
<span class="line-old-header">*** 488,16 ***</span>
        /* get the Bezier arc extrema.                               */
  
        FT_Error   error;
        TBBox_Rec  user;
  
<span class="line-removed">- #ifdef FT_CONFIG_OPTION_PIC</span>
<span class="line-removed">-       FT_Outline_Funcs  bbox_interface;</span>
<span class="line-removed">- </span>
<span class="line-removed">- </span>
<span class="line-removed">-       Init_Class_bbox_interface( &amp;bbox_interface );</span>
<span class="line-removed">- #endif</span>
  
        user.bbox = bbox;
  
        error = FT_Outline_Decompose( outline, &amp;bbox_interface, &amp;user );
        if ( error )
<span class="line-new-header">--- 510,10 ---</span>
</pre>
<center><a href="ftbase.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ftbitmap.c.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>