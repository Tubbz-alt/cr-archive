<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/native/libfreetype/src/pshinter/pshglob.c</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="pshalgo.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="pshglob.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfreetype/src/pshinter/pshglob.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
<span class="line-modified">  1 /***************************************************************************/</span>
<span class="line-modified">  2 /*                                                                         */</span>
<span class="line-modified">  3 /*  pshglob.c                                                              */</span>
<span class="line-modified">  4 /*                                                                         */</span>
<span class="line-modified">  5 /*    PostScript hinter global hinting management (body).                  */</span>
<span class="line-modified">  6 /*    Inspired by the new auto-hinter module.                              */</span>
<span class="line-modified">  7 /*                                                                         */</span>
<span class="line-modified">  8 /*  Copyright 2001-2018 by                                                 */</span>
<span class="line-modified">  9 /*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */</span>
<span class="line-modified"> 10 /*                                                                         */</span>
<span class="line-modified"> 11 /*  This file is part of the FreeType project, and may only be used        */</span>
<span class="line-modified"> 12 /*  modified and distributed under the terms of the FreeType project       */</span>
<span class="line-modified"> 13 /*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<span class="line-modified"> 14 /*  this file you indicate that you have read the license and              */</span>
<span class="line-modified"> 15 /*  understand and accept it fully.                                        */</span>
<span class="line-modified"> 16 /*                                                                         */</span>
<span class="line-modified"> 17 /***************************************************************************/</span>
 18 
 19 
 20 #include &lt;ft2build.h&gt;
 21 #include FT_FREETYPE_H
 22 #include FT_INTERNAL_OBJECTS_H

 23 #include &quot;pshglob.h&quot;
 24 
 25 #ifdef DEBUG_HINTER
 26   PSH_Globals  ps_debug_globals = NULL;
 27 #endif
 28 
 29 
 30   /*************************************************************************/
 31   /*************************************************************************/
 32   /*****                                                               *****/
 33   /*****                       STANDARD WIDTHS                         *****/
 34   /*****                                                               *****/
 35   /*************************************************************************/
 36   /*************************************************************************/
 37 
 38 
 39   /* scale the widths/heights table */
 40   static void
 41   psh_globals_scale_widths( PSH_Globals  globals,
 42                             FT_UInt      direction )
</pre>
<hr />
<pre>
551                        PSH_Alignment  alignment )
552   {
553     PSH_Blue_Table  table;
554     FT_UInt         count;
555     FT_Pos          delta;
556     PSH_Blue_Zone   zone;
557     FT_Int          no_shoots;
558 
559 
560     alignment-&gt;align = PSH_BLUE_ALIGN_NONE;
561 
562     no_shoots = blues-&gt;no_overshoots;
563 
564     /* look up stem top in top zones table */
565     table = &amp;blues-&gt;normal_top;
566     count = table-&gt;count;
567     zone  = table-&gt;zones;
568 
569     for ( ; count &gt; 0; count--, zone++ )
570     {
<span class="line-modified">571       delta = stem_top - zone-&gt;org_bottom;</span>
572       if ( delta &lt; -blues-&gt;blue_fuzz )
573         break;
574 
575       if ( stem_top &lt;= zone-&gt;org_top + blues-&gt;blue_fuzz )
576       {
577         if ( no_shoots || delta &lt;= blues-&gt;blue_threshold )
578         {
579           alignment-&gt;align    |= PSH_BLUE_ALIGN_TOP;
580           alignment-&gt;align_top = zone-&gt;cur_ref;
581         }
582         break;
583       }
584     }
585 
586     /* look up stem bottom in bottom zones table */
587     table = &amp;blues-&gt;normal_bottom;
588     count = table-&gt;count;
589     zone  = table-&gt;zones + count-1;
590 
591     for ( ; count &gt; 0; count--, zone-- )
592     {
<span class="line-modified">593       delta = zone-&gt;org_top - stem_bot;</span>
594       if ( delta &lt; -blues-&gt;blue_fuzz )
595         break;
596 
597       if ( stem_bot &gt;= zone-&gt;org_bottom - blues-&gt;blue_fuzz )
598       {
599         if ( no_shoots || delta &lt; blues-&gt;blue_threshold )
600         {
601           alignment-&gt;align    |= PSH_BLUE_ALIGN_BOT;
602           alignment-&gt;align_bot = zone-&gt;cur_ref;
603         }
604         break;
605       }
606     }
607   }
608 
609 
610   /*************************************************************************/
611   /*************************************************************************/
612   /*****                                                               *****/
613   /*****                        GLOBAL HINTS                           *****/
</pre>
</td>
<td>
<hr />
<pre>
<span class="line-modified">  1 /****************************************************************************</span>
<span class="line-modified">  2  *</span>
<span class="line-modified">  3  * pshglob.c</span>
<span class="line-modified">  4  *</span>
<span class="line-modified">  5  *   PostScript hinter global hinting management (body).</span>
<span class="line-modified">  6  *   Inspired by the new auto-hinter module.</span>
<span class="line-modified">  7  *</span>
<span class="line-modified">  8  * Copyright (C) 2001-2019 by</span>
<span class="line-modified">  9  * David Turner, Robert Wilhelm, and Werner Lemberg.</span>
<span class="line-modified"> 10  *</span>
<span class="line-modified"> 11  * This file is part of the FreeType project, and may only be used</span>
<span class="line-modified"> 12  * modified and distributed under the terms of the FreeType project</span>
<span class="line-modified"> 13  * license, LICENSE.TXT.  By continuing to use, modify, or distribute</span>
<span class="line-modified"> 14  * this file you indicate that you have read the license and</span>
<span class="line-modified"> 15  * understand and accept it fully.</span>
<span class="line-modified"> 16  *</span>
<span class="line-modified"> 17  */</span>
 18 
 19 
 20 #include &lt;ft2build.h&gt;
 21 #include FT_FREETYPE_H
 22 #include FT_INTERNAL_OBJECTS_H
<span class="line-added"> 23 #include FT_INTERNAL_CALC_H</span>
 24 #include &quot;pshglob.h&quot;
 25 
 26 #ifdef DEBUG_HINTER
 27   PSH_Globals  ps_debug_globals = NULL;
 28 #endif
 29 
 30 
 31   /*************************************************************************/
 32   /*************************************************************************/
 33   /*****                                                               *****/
 34   /*****                       STANDARD WIDTHS                         *****/
 35   /*****                                                               *****/
 36   /*************************************************************************/
 37   /*************************************************************************/
 38 
 39 
 40   /* scale the widths/heights table */
 41   static void
 42   psh_globals_scale_widths( PSH_Globals  globals,
 43                             FT_UInt      direction )
</pre>
<hr />
<pre>
552                        PSH_Alignment  alignment )
553   {
554     PSH_Blue_Table  table;
555     FT_UInt         count;
556     FT_Pos          delta;
557     PSH_Blue_Zone   zone;
558     FT_Int          no_shoots;
559 
560 
561     alignment-&gt;align = PSH_BLUE_ALIGN_NONE;
562 
563     no_shoots = blues-&gt;no_overshoots;
564 
565     /* look up stem top in top zones table */
566     table = &amp;blues-&gt;normal_top;
567     count = table-&gt;count;
568     zone  = table-&gt;zones;
569 
570     for ( ; count &gt; 0; count--, zone++ )
571     {
<span class="line-modified">572       delta = SUB_LONG( stem_top, zone-&gt;org_bottom );</span>
573       if ( delta &lt; -blues-&gt;blue_fuzz )
574         break;
575 
576       if ( stem_top &lt;= zone-&gt;org_top + blues-&gt;blue_fuzz )
577       {
578         if ( no_shoots || delta &lt;= blues-&gt;blue_threshold )
579         {
580           alignment-&gt;align    |= PSH_BLUE_ALIGN_TOP;
581           alignment-&gt;align_top = zone-&gt;cur_ref;
582         }
583         break;
584       }
585     }
586 
587     /* look up stem bottom in bottom zones table */
588     table = &amp;blues-&gt;normal_bottom;
589     count = table-&gt;count;
590     zone  = table-&gt;zones + count-1;
591 
592     for ( ; count &gt; 0; count--, zone-- )
593     {
<span class="line-modified">594       delta = SUB_LONG( zone-&gt;org_top, stem_bot );</span>
595       if ( delta &lt; -blues-&gt;blue_fuzz )
596         break;
597 
598       if ( stem_bot &gt;= zone-&gt;org_bottom - blues-&gt;blue_fuzz )
599       {
600         if ( no_shoots || delta &lt; blues-&gt;blue_threshold )
601         {
602           alignment-&gt;align    |= PSH_BLUE_ALIGN_BOT;
603           alignment-&gt;align_bot = zone-&gt;cur_ref;
604         }
605         break;
606       }
607     }
608   }
609 
610 
611   /*************************************************************************/
612   /*************************************************************************/
613   /*****                                                               *****/
614   /*****                        GLOBAL HINTS                           *****/
</pre>
</td>
</tr>
</table>
<center><a href="pshalgo.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="pshglob.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>