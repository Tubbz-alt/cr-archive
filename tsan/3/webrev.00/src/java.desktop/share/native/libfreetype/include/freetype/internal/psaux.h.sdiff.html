<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/native/libfreetype/include/freetype/internal/psaux.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="internal.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="pshints.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfreetype/include/freetype/internal/psaux.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
<span class="line-modified">   1 /***************************************************************************/</span>
<span class="line-modified">   2 /*                                                                         */</span>
<span class="line-modified">   3 /*  psaux.h                                                                */</span>
<span class="line-modified">   4 /*                                                                         */</span>
<span class="line-modified">   5 /*    Auxiliary functions and data structures related to PostScript fonts  */</span>
<span class="line-modified">   6 /*    (specification).                                                     */</span>
<span class="line-modified">   7 /*                                                                         */</span>
<span class="line-modified">   8 /*  Copyright 1996-2018 by                                                 */</span>
<span class="line-modified">   9 /*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */</span>
<span class="line-modified">  10 /*                                                                         */</span>
<span class="line-modified">  11 /*  This file is part of the FreeType project, and may only be used,       */</span>
<span class="line-modified">  12 /*  modified, and distributed under the terms of the FreeType project      */</span>
<span class="line-modified">  13 /*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<span class="line-modified">  14 /*  this file you indicate that you have read the license and              */</span>
<span class="line-modified">  15 /*  understand and accept it fully.                                        */</span>
<span class="line-modified">  16 /*                                                                         */</span>
<span class="line-modified">  17 /***************************************************************************/</span>
  18 
  19 
  20 #ifndef PSAUX_H_
  21 #define PSAUX_H_
  22 
  23 
  24 #include &lt;ft2build.h&gt;
  25 #include FT_INTERNAL_OBJECTS_H
  26 #include FT_INTERNAL_TYPE1_TYPES_H
  27 #include FT_INTERNAL_HASH_H
  28 #include FT_INTERNAL_TRUETYPE_TYPES_H
  29 #include FT_SERVICE_POSTSCRIPT_CMAPS_H
  30 #include FT_INTERNAL_CFF_TYPES_H
  31 #include FT_INTERNAL_CFF_OBJECTS_TYPES_H
  32 
  33 
  34 
  35 FT_BEGIN_HEADER
  36 
  37 
<span class="line-modified">  38   /***********************************************************************/</span>
<span class="line-modified">  39   /*                                                                     */</span>
<span class="line-modified">  40   /* PostScript modules driver class.                                    */</span>
<span class="line-modified">  41   /*                                                                     */</span>
  42   typedef struct  PS_DriverRec_
  43   {
  44     FT_DriverRec  root;
  45 
  46     FT_UInt   hinting_engine;
  47     FT_Bool   no_stem_darkening;
  48     FT_Int    darken_params[8];
  49     FT_Int32  random_seed;
  50 
  51   } PS_DriverRec, *PS_Driver;
  52 
  53 
  54   /*************************************************************************/
  55   /*************************************************************************/
  56   /*****                                                               *****/
  57   /*****                             T1_TABLE                          *****/
  58   /*****                                                               *****/
  59   /*************************************************************************/
  60   /*************************************************************************/
  61 
  62 
  63   typedef struct PS_TableRec_*              PS_Table;
  64   typedef const struct PS_Table_FuncsRec_*  PS_Table_Funcs;
  65 
  66 
<span class="line-modified">  67   /*************************************************************************/</span>
<span class="line-modified">  68   /*                                                                       */</span>
<span class="line-modified">  69   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified">  70   /*    PS_Table_FuncsRec                                                  */</span>
<span class="line-modified">  71   /*                                                                       */</span>
<span class="line-modified">  72   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">  73   /*    A set of function pointers to manage PS_Table objects.             */</span>
<span class="line-modified">  74   /*                                                                       */</span>
<span class="line-modified">  75   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified">  76   /*    table_init    :: Used to initialize a table.                       */</span>
<span class="line-modified">  77   /*                                                                       */</span>
<span class="line-modified">  78   /*    table_done    :: Finalizes resp. destroy a given table.            */</span>
<span class="line-modified">  79   /*                                                                       */</span>
<span class="line-modified">  80   /*    table_add     :: Adds a new object to a table.                     */</span>
<span class="line-modified">  81   /*                                                                       */</span>
<span class="line-modified">  82   /*    table_release :: Releases table data, then finalizes it.           */</span>
<span class="line-modified">  83   /*                                                                       */</span>




  84   typedef struct  PS_Table_FuncsRec_
  85   {
  86     FT_Error
  87     (*init)( PS_Table   table,
  88              FT_Int     count,
  89              FT_Memory  memory );
  90 
  91     void
  92     (*done)( PS_Table  table );
  93 
  94     FT_Error
<span class="line-modified">  95     (*add)( PS_Table  table,</span>
<span class="line-modified">  96             FT_Int    idx,</span>
<span class="line-modified">  97             void*     object,</span>
<span class="line-modified">  98             FT_UInt   length );</span>
  99 
 100     void
 101     (*release)( PS_Table  table );
 102 
 103   } PS_Table_FuncsRec;
 104 
 105 
<span class="line-modified"> 106   /*************************************************************************/</span>
<span class="line-modified"> 107   /*                                                                       */</span>
<span class="line-modified"> 108   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 109   /*    PS_TableRec                                                        */</span>
<span class="line-modified"> 110   /*                                                                       */</span>
<span class="line-modified"> 111   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 112   /*    A PS_Table is a simple object used to store an array of objects in */</span>
<span class="line-modified"> 113   /*    a single memory block.                                             */</span>
<span class="line-modified"> 114   /*                                                                       */</span>
<span class="line-modified"> 115   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 116   /*    block     :: The address in memory of the growheap&#39;s block.  This  */</span>
<span class="line-modified"> 117   /*                 can change between two object adds, due to            */</span>
<span class="line-modified"> 118   /*                 reallocation.                                         */</span>
<span class="line-modified"> 119   /*                                                                       */</span>
<span class="line-modified"> 120   /*    cursor    :: The current top of the grow heap within its block.    */</span>
<span class="line-modified"> 121   /*                                                                       */</span>
<span class="line-modified"> 122   /*    capacity  :: The current size of the heap block.  Increments by    */</span>
<span class="line-modified"> 123   /*                 1kByte chunks.                                        */</span>
<span class="line-modified"> 124   /*                                                                       */</span>
<span class="line-modified"> 125   /*    init      :: Set to 0xDEADBEEF if `elements&#39; and `lengths&#39; have    */</span>
<span class="line-modified"> 126   /*                 been allocated.                                       */</span>
<span class="line-modified"> 127   /*                                                                       */</span>
<span class="line-modified"> 128   /*    max_elems :: The maximum number of elements in table.              */</span>
<span class="line-modified"> 129   /*                                                                       */</span>
<span class="line-modified"> 130   /*    num_elems :: The current number of elements in table.              */</span>
<span class="line-modified"> 131   /*                                                                       */</span>
<span class="line-modified"> 132   /*    elements  :: A table of element addresses within the block.        */</span>
<span class="line-modified"> 133   /*                                                                       */</span>
<span class="line-modified"> 134   /*    lengths   :: A table of element sizes within the block.            */</span>
<span class="line-modified"> 135   /*                                                                       */</span>
<span class="line-modified"> 136   /*    memory    :: The object used for memory operations                 */</span>
<span class="line-modified"> 137   /*                 (alloc/realloc).                                      */</span>
<span class="line-modified"> 138   /*                                                                       */</span>
<span class="line-modified"> 139   /*    funcs     :: A table of method pointers for this object.           */</span>
<span class="line-modified"> 140   /*                                                                       */</span>






 141   typedef struct  PS_TableRec_
 142   {
 143     FT_Byte*           block;          /* current memory block           */
 144     FT_Offset          cursor;         /* current cursor in memory block */
 145     FT_Offset          capacity;       /* current size of memory block   */
 146     FT_ULong           init;
 147 
 148     FT_Int             max_elems;
 149     FT_Int             num_elems;
 150     FT_Byte**          elements;       /* addresses of table elements */
 151     FT_UInt*           lengths;        /* lengths of table elements   */
 152 
 153     FT_Memory          memory;
 154     PS_Table_FuncsRec  funcs;
 155 
 156   } PS_TableRec;
 157 
 158 
 159   /*************************************************************************/
 160   /*************************************************************************/
</pre>
<hr />
<pre>
 408                        FT_UInt    max_tokens,
 409                        FT_Int*    pnum_tokens );
 410 
 411     FT_Error
 412     (*load_field)( PS_Parser       parser,
 413                    const T1_Field  field,
 414                    void**          objects,
 415                    FT_UInt         max_objects,
 416                    FT_ULong*       pflags );
 417 
 418     FT_Error
 419     (*load_field_table)( PS_Parser       parser,
 420                          const T1_Field  field,
 421                          void**          objects,
 422                          FT_UInt         max_objects,
 423                          FT_ULong*       pflags );
 424 
 425   } PS_Parser_FuncsRec;
 426 
 427 
<span class="line-modified"> 428   /*************************************************************************/</span>
<span class="line-modified"> 429   /*                                                                       */</span>
<span class="line-modified"> 430   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified"> 431   /*    PS_ParserRec                                                       */</span>
<span class="line-modified"> 432   /*                                                                       */</span>
<span class="line-modified"> 433   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 434   /*    A PS_Parser is an object used to parse a Type 1 font very quickly. */</span>
<span class="line-modified"> 435   /*                                                                       */</span>
<span class="line-modified"> 436   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 437   /*    cursor :: The current position in the text.                        */</span>
<span class="line-modified"> 438   /*                                                                       */</span>
<span class="line-modified"> 439   /*    base   :: Start of the processed text.                             */</span>
<span class="line-modified"> 440   /*                                                                       */</span>
<span class="line-modified"> 441   /*    limit  :: End of the processed text.                               */</span>
<span class="line-modified"> 442   /*                                                                       */</span>
<span class="line-modified"> 443   /*    error  :: The last error returned.                                 */</span>
<span class="line-modified"> 444   /*                                                                       */</span>
<span class="line-modified"> 445   /*    memory :: The object used for memory operations (alloc/realloc).   */</span>
<span class="line-modified"> 446   /*                                                                       */</span>
<span class="line-modified"> 447   /*    funcs  :: A table of functions for the parser.                     */</span>
<span class="line-modified"> 448   /*                                                                       */</span>






 449   typedef struct  PS_ParserRec_
 450   {
 451     FT_Byte*   cursor;
 452     FT_Byte*   base;
 453     FT_Byte*   limit;
 454     FT_Error   error;
 455     FT_Memory  memory;
 456 
 457     PS_Parser_FuncsRec  funcs;
 458 
 459   } PS_ParserRec;
 460 
 461 
 462   /*************************************************************************/
 463   /*************************************************************************/
 464   /*****                                                               *****/
 465   /*****                         PS BUILDER                            *****/
 466   /*****                                                               *****/
 467   /*************************************************************************/
 468   /*************************************************************************/
 469 
 470 
 471   typedef struct PS_Builder_  PS_Builder;
 472   typedef const struct PS_Builder_FuncsRec_*  PS_Builder_Funcs;
 473 
 474   typedef struct  PS_Builder_FuncsRec_
 475   {
 476     void
 477     (*init)( PS_Builder*  ps_builder,
 478              void*        builder,
 479              FT_Bool      is_t1 );
 480 
 481     void
 482     (*done)( PS_Builder*  builder );
 483 
 484   } PS_Builder_FuncsRec;
 485 
 486 
<span class="line-modified"> 487   /*************************************************************************/</span>
<span class="line-modified"> 488   /*                                                                       */</span>
<span class="line-modified"> 489   /* &lt;Structure&gt;                                                           */</span>
<span class="line-modified"> 490   /*    PS_Builder                                                         */</span>
<span class="line-modified"> 491   /*                                                                       */</span>
<span class="line-modified"> 492   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 493   /*     A structure used during glyph loading to store its outline.       */</span>
<span class="line-modified"> 494   /*                                                                       */</span>
<span class="line-modified"> 495   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 496   /*    memory       :: The current memory object.                         */</span>
<span class="line-modified"> 497   /*                                                                       */</span>
<span class="line-modified"> 498   /*    face         :: The current face object.                           */</span>
<span class="line-modified"> 499   /*                                                                       */</span>
<span class="line-modified"> 500   /*    glyph        :: The current glyph slot.                            */</span>
<span class="line-modified"> 501   /*                                                                       */</span>
<span class="line-modified"> 502   /*    loader       :: XXX                                                */</span>
<span class="line-modified"> 503   /*                                                                       */</span>
<span class="line-modified"> 504   /*    base         :: The base glyph outline.                            */</span>
<span class="line-modified"> 505   /*                                                                       */</span>
<span class="line-modified"> 506   /*    current      :: The current glyph outline.                         */</span>
<span class="line-modified"> 507   /*                                                                       */</span>
<span class="line-modified"> 508   /*    pos_x        :: The horizontal translation (if composite glyph).   */</span>
<span class="line-modified"> 509   /*                                                                       */</span>
<span class="line-modified"> 510   /*    pos_y        :: The vertical translation (if composite glyph).     */</span>
<span class="line-modified"> 511   /*                                                                       */</span>
<span class="line-modified"> 512   /*    left_bearing :: The left side bearing point.                       */</span>
<span class="line-modified"> 513   /*                                                                       */</span>
<span class="line-modified"> 514   /*    advance      :: The horizontal advance vector.                     */</span>
<span class="line-modified"> 515   /*                                                                       */</span>
<span class="line-modified"> 516   /*    bbox         :: Unused.                                            */</span>
<span class="line-modified"> 517   /*                                                                       */</span>
<span class="line-modified"> 518   /*    path_begun   :: A flag which indicates that a new path has begun.  */</span>
<span class="line-modified"> 519   /*                                                                       */</span>
<span class="line-modified"> 520   /*    load_points  :: If this flag is not set, no points are loaded.     */</span>
<span class="line-modified"> 521   /*                                                                       */</span>
<span class="line-modified"> 522   /*    no_recurse   :: Set but not used.                                  */</span>
<span class="line-modified"> 523   /*                                                                       */</span>
<span class="line-modified"> 524   /*    metrics_only :: A boolean indicating that we only want to compute  */</span>
<span class="line-modified"> 525   /*                    the metrics of a given glyph, not load all of its  */</span>
<span class="line-modified"> 526   /*                    points.                                            */</span>
<span class="line-modified"> 527   /*                                                                       */</span>
<span class="line-modified"> 528   /*    is_t1        :: Set if current font type is Type 1.                */</span>
<span class="line-modified"> 529   /*                                                                       */</span>
<span class="line-modified"> 530   /*    funcs        :: An array of function pointers for the builder.     */</span>
<span class="line-modified"> 531   /*                                                                       */</span>
















 532   struct  PS_Builder_
 533   {
 534     FT_Memory       memory;
 535     FT_Face         face;
 536     CFF_GlyphSlot   glyph;
 537     FT_GlyphLoader  loader;
 538     FT_Outline*     base;
 539     FT_Outline*     current;
 540 
 541     FT_Pos*  pos_x;
 542     FT_Pos*  pos_y;
 543 
 544     FT_Vector*  left_bearing;
 545     FT_Vector*  advance;
 546 
 547     FT_BBox*  bbox;          /* bounding box */
 548     FT_Bool   path_begun;
 549     FT_Bool   load_points;
 550     FT_Bool   no_recurse;
 551 
</pre>
<hr />
<pre>
 712     T1_Builder_Add_Point_Func      add_point;
 713     T1_Builder_Add_Point1_Func     add_point1;
 714     T1_Builder_Add_Contour_Func    add_contour;
 715     T1_Builder_Start_Point_Func    start_point;
 716     T1_Builder_Close_Contour_Func  close_contour;
 717 
 718   } T1_Builder_FuncsRec;
 719 
 720 
 721   /* an enumeration type to handle charstring parsing states */
 722   typedef enum  T1_ParseState_
 723   {
 724     T1_Parse_Start,
 725     T1_Parse_Have_Width,
 726     T1_Parse_Have_Moveto,
 727     T1_Parse_Have_Path
 728 
 729   } T1_ParseState;
 730 
 731 
<span class="line-modified"> 732   /*************************************************************************/</span>
<span class="line-modified"> 733   /*                                                                       */</span>
<span class="line-modified"> 734   /* &lt;Structure&gt;                                                           */</span>
<span class="line-modified"> 735   /*    T1_BuilderRec                                                      */</span>
<span class="line-modified"> 736   /*                                                                       */</span>
<span class="line-modified"> 737   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 738   /*     A structure used during glyph loading to store its outline.       */</span>
<span class="line-modified"> 739   /*                                                                       */</span>
<span class="line-modified"> 740   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified"> 741   /*    memory       :: The current memory object.                         */</span>
<span class="line-modified"> 742   /*                                                                       */</span>
<span class="line-modified"> 743   /*    face         :: The current face object.                           */</span>
<span class="line-modified"> 744   /*                                                                       */</span>
<span class="line-modified"> 745   /*    glyph        :: The current glyph slot.                            */</span>
<span class="line-modified"> 746   /*                                                                       */</span>
<span class="line-modified"> 747   /*    loader       :: XXX                                                */</span>
<span class="line-modified"> 748   /*                                                                       */</span>
<span class="line-modified"> 749   /*    base         :: The base glyph outline.                            */</span>
<span class="line-modified"> 750   /*                                                                       */</span>
<span class="line-modified"> 751   /*    current      :: The current glyph outline.                         */</span>
<span class="line-modified"> 752   /*                                                                       */</span>
<span class="line-modified"> 753   /*    max_points   :: maximum points in builder outline                  */</span>
<span class="line-modified"> 754   /*                                                                       */</span>
<span class="line-modified"> 755   /*    max_contours :: Maximum number of contours in builder outline.     */</span>
<span class="line-modified"> 756   /*                                                                       */</span>
<span class="line-modified"> 757   /*    pos_x        :: The horizontal translation (if composite glyph).   */</span>
<span class="line-modified"> 758   /*                                                                       */</span>
<span class="line-modified"> 759   /*    pos_y        :: The vertical translation (if composite glyph).     */</span>
<span class="line-modified"> 760   /*                                                                       */</span>
<span class="line-modified"> 761   /*    left_bearing :: The left side bearing point.                       */</span>
<span class="line-modified"> 762   /*                                                                       */</span>
<span class="line-modified"> 763   /*    advance      :: The horizontal advance vector.                     */</span>
<span class="line-modified"> 764   /*                                                                       */</span>
<span class="line-modified"> 765   /*    bbox         :: Unused.                                            */</span>
<span class="line-modified"> 766   /*                                                                       */</span>
<span class="line-modified"> 767   /*    parse_state  :: An enumeration which controls the charstring       */</span>
<span class="line-modified"> 768   /*                    parsing state.                                     */</span>
<span class="line-modified"> 769   /*                                                                       */</span>
<span class="line-modified"> 770   /*    load_points  :: If this flag is not set, no points are loaded.     */</span>
<span class="line-modified"> 771   /*                                                                       */</span>
<span class="line-modified"> 772   /*    no_recurse   :: Set but not used.                                  */</span>
<span class="line-modified"> 773   /*                                                                       */</span>
<span class="line-modified"> 774   /*    metrics_only :: A boolean indicating that we only want to compute  */</span>
<span class="line-modified"> 775   /*                    the metrics of a given glyph, not load all of its  */</span>
<span class="line-modified"> 776   /*                    points.                                            */</span>
<span class="line-modified"> 777   /*                                                                       */</span>
<span class="line-modified"> 778   /*    funcs        :: An array of function pointers for the builder.     */</span>
<span class="line-modified"> 779   /*                                                                       */</span>
















 780   typedef struct  T1_BuilderRec_
 781   {
 782     FT_Memory       memory;
 783     FT_Face         face;
 784     FT_GlyphSlot    glyph;
 785     FT_GlyphLoader  loader;
 786     FT_Outline*     base;
 787     FT_Outline*     current;
 788 
 789     FT_Pos          pos_x;
 790     FT_Pos          pos_y;
 791 
 792     FT_Vector       left_bearing;
 793     FT_Vector       advance;
 794 
 795     FT_BBox         bbox;          /* bounding box */
 796     T1_ParseState   parse_state;
 797     FT_Bool         load_points;
 798     FT_Bool         no_recurse;
 799 
 800     FT_Bool         metrics_only;
 801 
 802     void*           hints_funcs;    /* hinter-specific */
 803     void*           hints_globals;  /* hinter-specific */
 804 
 805     T1_Builder_FuncsRec  funcs;
 806 
 807   } T1_BuilderRec;
 808 
 809 
 810   /*************************************************************************/
 811   /*************************************************************************/
 812   /*****                                                               *****/
 813   /*****                         T1 DECODER                            *****/
 814   /*****                                                               *****/
 815   /*************************************************************************/
 816   /*************************************************************************/
 817 
 818 #if 0
 819 
<span class="line-modified"> 820   /*************************************************************************/</span>
<span class="line-modified"> 821   /*                                                                       */</span>
<span class="line-modified"> 822   /* T1_MAX_SUBRS_CALLS details the maximum number of nested sub-routine   */</span>
<span class="line-modified"> 823   /* calls during glyph loading.                                           */</span>
<span class="line-modified"> 824   /*                                                                       */</span>
 825 #define T1_MAX_SUBRS_CALLS  8
 826 
 827 
<span class="line-modified"> 828   /*************************************************************************/</span>
<span class="line-modified"> 829   /*                                                                       */</span>
<span class="line-modified"> 830   /* T1_MAX_CHARSTRING_OPERANDS is the charstring stack&#39;s capacity.  A     */</span>
<span class="line-modified"> 831   /* minimum of 16 is required.                                            */</span>
<span class="line-modified"> 832   /*                                                                       */</span>
 833 #define T1_MAX_CHARSTRINGS_OPERANDS  32
 834 
 835 #endif /* 0 */
 836 
 837 
 838   typedef struct  T1_Decoder_ZoneRec_
 839   {
 840     FT_Byte*  cursor;
 841     FT_Byte*  base;
 842     FT_Byte*  limit;
 843 
 844   } T1_Decoder_ZoneRec, *T1_Decoder_Zone;
 845 
 846 
 847   typedef struct T1_DecoderRec_*              T1_Decoder;
 848   typedef const struct T1_Decoder_FuncsRec_*  T1_Decoder_Funcs;
 849 
 850 
 851   typedef FT_Error
 852   (*T1_Decoder_Callback)( T1_Decoder  decoder,
</pre>
<hr />
<pre>
 976     void
 977     (*init)( CFF_Builder*   builder,
 978              TT_Face        face,
 979              CFF_Size       size,
 980              CFF_GlyphSlot  glyph,
 981              FT_Bool        hinting );
 982 
 983     void
 984     (*done)( CFF_Builder*  builder );
 985 
 986     CFF_Builder_Check_Points_Func   check_points;
 987     CFF_Builder_Add_Point_Func      add_point;
 988     CFF_Builder_Add_Point1_Func     add_point1;
 989     CFF_Builder_Add_Contour_Func    add_contour;
 990     CFF_Builder_Start_Point_Func    start_point;
 991     CFF_Builder_Close_Contour_Func  close_contour;
 992 
 993   } CFF_Builder_FuncsRec;
 994 
 995 
<span class="line-modified"> 996   /*************************************************************************/</span>
<span class="line-modified"> 997   /*                                                                       */</span>
<span class="line-modified"> 998   /* &lt;Structure&gt;                                                           */</span>
<span class="line-modified"> 999   /*    CFF_Builder                                                        */</span>
<span class="line-modified">1000   /*                                                                       */</span>
<span class="line-modified">1001   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">1002   /*     A structure used during glyph loading to store its outline.       */</span>
<span class="line-modified">1003   /*                                                                       */</span>
<span class="line-modified">1004   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified">1005   /*    memory        :: The current memory object.                        */</span>
<span class="line-modified">1006   /*                                                                       */</span>
<span class="line-modified">1007   /*    face          :: The current face object.                          */</span>
<span class="line-modified">1008   /*                                                                       */</span>
<span class="line-modified">1009   /*    glyph         :: The current glyph slot.                           */</span>
<span class="line-modified">1010   /*                                                                       */</span>
<span class="line-modified">1011   /*    loader        :: The current glyph loader.                         */</span>
<span class="line-modified">1012   /*                                                                       */</span>
<span class="line-modified">1013   /*    base          :: The base glyph outline.                           */</span>
<span class="line-modified">1014   /*                                                                       */</span>
<span class="line-modified">1015   /*    current       :: The current glyph outline.                        */</span>
<span class="line-modified">1016   /*                                                                       */</span>
<span class="line-modified">1017   /*    pos_x         :: The horizontal translation (if composite glyph).  */</span>
<span class="line-modified">1018   /*                                                                       */</span>
<span class="line-modified">1019   /*    pos_y         :: The vertical translation (if composite glyph).    */</span>
<span class="line-modified">1020   /*                                                                       */</span>
<span class="line-modified">1021   /*    left_bearing  :: The left side bearing point.                      */</span>
<span class="line-modified">1022   /*                                                                       */</span>
<span class="line-modified">1023   /*    advance       :: The horizontal advance vector.                    */</span>
<span class="line-modified">1024   /*                                                                       */</span>
<span class="line-modified">1025   /*    bbox          :: Unused.                                           */</span>
<span class="line-modified">1026   /*                                                                       */</span>
<span class="line-modified">1027   /*    path_begun    :: A flag which indicates that a new path has begun. */</span>
<span class="line-modified">1028   /*                                                                       */</span>
<span class="line-modified">1029   /*    load_points   :: If this flag is not set, no points are loaded.    */</span>
<span class="line-modified">1030   /*                                                                       */</span>
<span class="line-modified">1031   /*    no_recurse    :: Set but not used.                                 */</span>
<span class="line-modified">1032   /*                                                                       */</span>
<span class="line-modified">1033   /*    metrics_only  :: A boolean indicating that we only want to compute */</span>
<span class="line-modified">1034   /*                     the metrics of a given glyph, not load all of its */</span>
<span class="line-modified">1035   /*                     points.                                           */</span>
<span class="line-modified">1036   /*                                                                       */</span>
<span class="line-modified">1037   /*    hints_funcs   :: Auxiliary pointer for hinting.                    */</span>
<span class="line-modified">1038   /*                                                                       */</span>
<span class="line-modified">1039   /*    hints_globals :: Auxiliary pointer for hinting.                    */</span>
<span class="line-modified">1040   /*                                                                       */</span>
<span class="line-modified">1041   /*    funcs         :: A table of method pointers for this object.       */</span>
<span class="line-modified">1042   /*                                                                       */</span>

















1043   struct  CFF_Builder_
1044   {
1045     FT_Memory       memory;
1046     TT_Face         face;
1047     CFF_GlyphSlot   glyph;
1048     FT_GlyphLoader  loader;
1049     FT_Outline*     base;
1050     FT_Outline*     current;
1051 
1052     FT_Pos  pos_x;
1053     FT_Pos  pos_y;
1054 
1055     FT_Vector  left_bearing;
1056     FT_Vector  advance;
1057 
1058     FT_BBox  bbox;          /* bounding box */
1059 
1060     FT_Bool  path_begun;
1061     FT_Bool  load_points;
1062     FT_Bool  no_recurse;
</pre>
<hr />
<pre>
1194   typedef struct  AFM_Parser_FuncsRec_
1195   {
1196     FT_Error
1197     (*init)( AFM_Parser  parser,
1198              FT_Memory   memory,
1199              FT_Byte*    base,
1200              FT_Byte*    limit );
1201 
1202     void
1203     (*done)( AFM_Parser  parser );
1204 
1205     FT_Error
1206     (*parse)( AFM_Parser  parser );
1207 
1208   } AFM_Parser_FuncsRec;
1209 
1210 
1211   typedef struct AFM_StreamRec_*  AFM_Stream;
1212 
1213 
<span class="line-modified">1214   /*************************************************************************/</span>
<span class="line-modified">1215   /*                                                                       */</span>
<span class="line-modified">1216   /* &lt;Struct&gt;                                                              */</span>
<span class="line-modified">1217   /*    AFM_ParserRec                                                      */</span>
<span class="line-modified">1218   /*                                                                       */</span>
<span class="line-modified">1219   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified">1220   /*    An AFM_Parser is a parser for the AFM files.                       */</span>
<span class="line-modified">1221   /*                                                                       */</span>
<span class="line-modified">1222   /* &lt;Fields&gt;                                                              */</span>
<span class="line-modified">1223   /*    memory    :: The object used for memory operations (alloc and      */</span>
<span class="line-modified">1224   /*                 realloc).                                             */</span>
<span class="line-modified">1225   /*                                                                       */</span>
<span class="line-modified">1226   /*    stream    :: This is an opaque object.                             */</span>
<span class="line-modified">1227   /*                                                                       */</span>
<span class="line-modified">1228   /*    FontInfo  :: The result will be stored here.                       */</span>
<span class="line-modified">1229   /*                                                                       */</span>
<span class="line-modified">1230   /*    get_index :: A user provided function to get a glyph index by its  */</span>
<span class="line-modified">1231   /*                 name.                                                 */</span>
<span class="line-modified">1232   /*                                                                       */</span>


1233   typedef struct  AFM_ParserRec_
1234   {
1235     FT_Memory     memory;
1236     AFM_Stream    stream;
1237 
1238     AFM_FontInfo  FontInfo;
1239 
1240     FT_Int
1241     (*get_index)( const char*  name,
1242                   FT_Offset    len,
1243                   void*        user_data );
1244 
1245     void*         user_data;
1246 
1247   } AFM_ParserRec;
1248 
1249 
1250   /*************************************************************************/
1251   /*************************************************************************/
1252   /*****                                                               *****/
</pre>
</td>
<td>
<hr />
<pre>
<span class="line-modified">   1 /****************************************************************************</span>
<span class="line-modified">   2  *</span>
<span class="line-modified">   3  * psaux.h</span>
<span class="line-modified">   4  *</span>
<span class="line-modified">   5  *   Auxiliary functions and data structures related to PostScript fonts</span>
<span class="line-modified">   6  *   (specification).</span>
<span class="line-modified">   7  *</span>
<span class="line-modified">   8  * Copyright (C) 1996-2019 by</span>
<span class="line-modified">   9  * David Turner, Robert Wilhelm, and Werner Lemberg.</span>
<span class="line-modified">  10  *</span>
<span class="line-modified">  11  * This file is part of the FreeType project, and may only be used,</span>
<span class="line-modified">  12  * modified, and distributed under the terms of the FreeType project</span>
<span class="line-modified">  13  * license, LICENSE.TXT.  By continuing to use, modify, or distribute</span>
<span class="line-modified">  14  * this file you indicate that you have read the license and</span>
<span class="line-modified">  15  * understand and accept it fully.</span>
<span class="line-modified">  16  *</span>
<span class="line-modified">  17  */</span>
  18 
  19 
  20 #ifndef PSAUX_H_
  21 #define PSAUX_H_
  22 
  23 
  24 #include &lt;ft2build.h&gt;
  25 #include FT_INTERNAL_OBJECTS_H
  26 #include FT_INTERNAL_TYPE1_TYPES_H
  27 #include FT_INTERNAL_HASH_H
  28 #include FT_INTERNAL_TRUETYPE_TYPES_H
  29 #include FT_SERVICE_POSTSCRIPT_CMAPS_H
  30 #include FT_INTERNAL_CFF_TYPES_H
  31 #include FT_INTERNAL_CFF_OBJECTS_TYPES_H
  32 
  33 
  34 
  35 FT_BEGIN_HEADER
  36 
  37 
<span class="line-modified">  38   /**************************************************************************</span>
<span class="line-modified">  39    *</span>
<span class="line-modified">  40    * PostScript modules driver class.</span>
<span class="line-modified">  41    */</span>
  42   typedef struct  PS_DriverRec_
  43   {
  44     FT_DriverRec  root;
  45 
  46     FT_UInt   hinting_engine;
  47     FT_Bool   no_stem_darkening;
  48     FT_Int    darken_params[8];
  49     FT_Int32  random_seed;
  50 
  51   } PS_DriverRec, *PS_Driver;
  52 
  53 
  54   /*************************************************************************/
  55   /*************************************************************************/
  56   /*****                                                               *****/
  57   /*****                             T1_TABLE                          *****/
  58   /*****                                                               *****/
  59   /*************************************************************************/
  60   /*************************************************************************/
  61 
  62 
  63   typedef struct PS_TableRec_*              PS_Table;
  64   typedef const struct PS_Table_FuncsRec_*  PS_Table_Funcs;
  65 
  66 
<span class="line-modified">  67   /**************************************************************************</span>
<span class="line-modified">  68    *</span>
<span class="line-modified">  69    * @struct:</span>
<span class="line-modified">  70    *   PS_Table_FuncsRec</span>
<span class="line-modified">  71    *</span>
<span class="line-modified">  72    * @description:</span>
<span class="line-modified">  73    *   A set of function pointers to manage PS_Table objects.</span>
<span class="line-modified">  74    *</span>
<span class="line-modified">  75    * @fields:</span>
<span class="line-modified">  76    *   table_init ::</span>
<span class="line-modified">  77    *     Used to initialize a table.</span>
<span class="line-modified">  78    *</span>
<span class="line-modified">  79    *   table_done ::</span>
<span class="line-modified">  80    *     Finalizes resp. destroy a given table.</span>
<span class="line-modified">  81    *</span>
<span class="line-modified">  82    *   table_add ::</span>
<span class="line-modified">  83    *     Adds a new object to a table.</span>
<span class="line-added">  84    *</span>
<span class="line-added">  85    *   table_release ::</span>
<span class="line-added">  86    *     Releases table data, then finalizes it.</span>
<span class="line-added">  87    */</span>
  88   typedef struct  PS_Table_FuncsRec_
  89   {
  90     FT_Error
  91     (*init)( PS_Table   table,
  92              FT_Int     count,
  93              FT_Memory  memory );
  94 
  95     void
  96     (*done)( PS_Table  table );
  97 
  98     FT_Error
<span class="line-modified">  99     (*add)( PS_Table     table,</span>
<span class="line-modified"> 100             FT_Int       idx,</span>
<span class="line-modified"> 101             const void*  object,</span>
<span class="line-modified"> 102             FT_UInt      length );</span>
 103 
 104     void
 105     (*release)( PS_Table  table );
 106 
 107   } PS_Table_FuncsRec;
 108 
 109 
<span class="line-modified"> 110   /**************************************************************************</span>
<span class="line-modified"> 111    *</span>
<span class="line-modified"> 112    * @struct:</span>
<span class="line-modified"> 113    *   PS_TableRec</span>
<span class="line-modified"> 114    *</span>
<span class="line-modified"> 115    * @description:</span>
<span class="line-modified"> 116    *   A PS_Table is a simple object used to store an array of objects in a</span>
<span class="line-modified"> 117    *   single memory block.</span>
<span class="line-modified"> 118    *</span>
<span class="line-modified"> 119    * @fields:</span>
<span class="line-modified"> 120    *   block ::</span>
<span class="line-modified"> 121    *     The address in memory of the growheap&#39;s block.  This can change</span>
<span class="line-modified"> 122    *     between two object adds, due to reallocation.</span>
<span class="line-modified"> 123    *</span>
<span class="line-modified"> 124    *   cursor ::</span>
<span class="line-modified"> 125    *     The current top of the grow heap within its block.</span>
<span class="line-modified"> 126    *</span>
<span class="line-modified"> 127    *   capacity ::</span>
<span class="line-modified"> 128    *     The current size of the heap block.  Increments by 1kByte chunks.</span>
<span class="line-modified"> 129    *</span>
<span class="line-modified"> 130    *   init ::</span>
<span class="line-modified"> 131    *     Set to 0xDEADBEEF if &#39;elements&#39; and &#39;lengths&#39; have been allocated.</span>
<span class="line-modified"> 132    *</span>
<span class="line-modified"> 133    *   max_elems ::</span>
<span class="line-modified"> 134    *     The maximum number of elements in table.</span>
<span class="line-modified"> 135    *</span>
<span class="line-modified"> 136    *   num_elems ::</span>
<span class="line-modified"> 137    *     The current number of elements in table.</span>
<span class="line-modified"> 138    *</span>
<span class="line-modified"> 139    *   elements ::</span>
<span class="line-modified"> 140    *     A table of element addresses within the block.</span>
<span class="line-modified"> 141    *</span>
<span class="line-modified"> 142    *   lengths ::</span>
<span class="line-modified"> 143    *     A table of element sizes within the block.</span>
<span class="line-modified"> 144    *</span>
<span class="line-added"> 145    *   memory ::</span>
<span class="line-added"> 146    *     The object used for memory operations (alloc/realloc).</span>
<span class="line-added"> 147    *</span>
<span class="line-added"> 148    *   funcs ::</span>
<span class="line-added"> 149    *     A table of method pointers for this object.</span>
<span class="line-added"> 150    */</span>
 151   typedef struct  PS_TableRec_
 152   {
 153     FT_Byte*           block;          /* current memory block           */
 154     FT_Offset          cursor;         /* current cursor in memory block */
 155     FT_Offset          capacity;       /* current size of memory block   */
 156     FT_ULong           init;
 157 
 158     FT_Int             max_elems;
 159     FT_Int             num_elems;
 160     FT_Byte**          elements;       /* addresses of table elements */
 161     FT_UInt*           lengths;        /* lengths of table elements   */
 162 
 163     FT_Memory          memory;
 164     PS_Table_FuncsRec  funcs;
 165 
 166   } PS_TableRec;
 167 
 168 
 169   /*************************************************************************/
 170   /*************************************************************************/
</pre>
<hr />
<pre>
 418                        FT_UInt    max_tokens,
 419                        FT_Int*    pnum_tokens );
 420 
 421     FT_Error
 422     (*load_field)( PS_Parser       parser,
 423                    const T1_Field  field,
 424                    void**          objects,
 425                    FT_UInt         max_objects,
 426                    FT_ULong*       pflags );
 427 
 428     FT_Error
 429     (*load_field_table)( PS_Parser       parser,
 430                          const T1_Field  field,
 431                          void**          objects,
 432                          FT_UInt         max_objects,
 433                          FT_ULong*       pflags );
 434 
 435   } PS_Parser_FuncsRec;
 436 
 437 
<span class="line-modified"> 438   /**************************************************************************</span>
<span class="line-modified"> 439    *</span>
<span class="line-modified"> 440    * @struct:</span>
<span class="line-modified"> 441    *   PS_ParserRec</span>
<span class="line-modified"> 442    *</span>
<span class="line-modified"> 443    * @description:</span>
<span class="line-modified"> 444    *   A PS_Parser is an object used to parse a Type 1 font very quickly.</span>
<span class="line-modified"> 445    *</span>
<span class="line-modified"> 446    * @fields:</span>
<span class="line-modified"> 447    *   cursor ::</span>
<span class="line-modified"> 448    *     The current position in the text.</span>
<span class="line-modified"> 449    *</span>
<span class="line-modified"> 450    *   base ::</span>
<span class="line-modified"> 451    *     Start of the processed text.</span>
<span class="line-modified"> 452    *</span>
<span class="line-modified"> 453    *   limit ::</span>
<span class="line-modified"> 454    *     End of the processed text.</span>
<span class="line-modified"> 455    *</span>
<span class="line-modified"> 456    *   error ::</span>
<span class="line-modified"> 457    *     The last error returned.</span>
<span class="line-modified"> 458    *</span>
<span class="line-added"> 459    *   memory ::</span>
<span class="line-added"> 460    *     The object used for memory operations (alloc/realloc).</span>
<span class="line-added"> 461    *</span>
<span class="line-added"> 462    *   funcs ::</span>
<span class="line-added"> 463    *     A table of functions for the parser.</span>
<span class="line-added"> 464    */</span>
 465   typedef struct  PS_ParserRec_
 466   {
 467     FT_Byte*   cursor;
 468     FT_Byte*   base;
 469     FT_Byte*   limit;
 470     FT_Error   error;
 471     FT_Memory  memory;
 472 
 473     PS_Parser_FuncsRec  funcs;
 474 
 475   } PS_ParserRec;
 476 
 477 
 478   /*************************************************************************/
 479   /*************************************************************************/
 480   /*****                                                               *****/
 481   /*****                         PS BUILDER                            *****/
 482   /*****                                                               *****/
 483   /*************************************************************************/
 484   /*************************************************************************/
 485 
 486 
 487   typedef struct PS_Builder_  PS_Builder;
 488   typedef const struct PS_Builder_FuncsRec_*  PS_Builder_Funcs;
 489 
 490   typedef struct  PS_Builder_FuncsRec_
 491   {
 492     void
 493     (*init)( PS_Builder*  ps_builder,
 494              void*        builder,
 495              FT_Bool      is_t1 );
 496 
 497     void
 498     (*done)( PS_Builder*  builder );
 499 
 500   } PS_Builder_FuncsRec;
 501 
 502 
<span class="line-modified"> 503   /**************************************************************************</span>
<span class="line-modified"> 504    *</span>
<span class="line-modified"> 505    * @struct:</span>
<span class="line-modified"> 506    *   PS_Builder</span>
<span class="line-modified"> 507    *</span>
<span class="line-modified"> 508    * @description:</span>
<span class="line-modified"> 509    *    A structure used during glyph loading to store its outline.</span>
<span class="line-modified"> 510    *</span>
<span class="line-modified"> 511    * @fields:</span>
<span class="line-modified"> 512    *   memory ::</span>
<span class="line-modified"> 513    *     The current memory object.</span>
<span class="line-modified"> 514    *</span>
<span class="line-modified"> 515    *   face ::</span>
<span class="line-modified"> 516    *     The current face object.</span>
<span class="line-modified"> 517    *</span>
<span class="line-modified"> 518    *   glyph ::</span>
<span class="line-modified"> 519    *     The current glyph slot.</span>
<span class="line-modified"> 520    *</span>
<span class="line-modified"> 521    *   loader ::</span>
<span class="line-modified"> 522    *     XXX</span>
<span class="line-modified"> 523    *</span>
<span class="line-modified"> 524    *   base ::</span>
<span class="line-modified"> 525    *     The base glyph outline.</span>
<span class="line-modified"> 526    *</span>
<span class="line-modified"> 527    *   current ::</span>
<span class="line-modified"> 528    *     The current glyph outline.</span>
<span class="line-modified"> 529    *</span>
<span class="line-modified"> 530    *   pos_x ::</span>
<span class="line-modified"> 531    *     The horizontal translation (if composite glyph).</span>
<span class="line-modified"> 532    *</span>
<span class="line-modified"> 533    *   pos_y ::</span>
<span class="line-modified"> 534    *     The vertical translation (if composite glyph).</span>
<span class="line-modified"> 535    *</span>
<span class="line-modified"> 536    *   left_bearing ::</span>
<span class="line-modified"> 537    *     The left side bearing point.</span>
<span class="line-modified"> 538    *</span>
<span class="line-modified"> 539    *   advance ::</span>
<span class="line-modified"> 540    *     The horizontal advance vector.</span>
<span class="line-modified"> 541    *</span>
<span class="line-modified"> 542    *   bbox ::</span>
<span class="line-modified"> 543    *     Unused.</span>
<span class="line-modified"> 544    *</span>
<span class="line-modified"> 545    *   path_begun ::</span>
<span class="line-modified"> 546    *     A flag which indicates that a new path has begun.</span>
<span class="line-modified"> 547    *</span>
<span class="line-added"> 548    *   load_points ::</span>
<span class="line-added"> 549    *     If this flag is not set, no points are loaded.</span>
<span class="line-added"> 550    *</span>
<span class="line-added"> 551    *   no_recurse ::</span>
<span class="line-added"> 552    *     Set but not used.</span>
<span class="line-added"> 553    *</span>
<span class="line-added"> 554    *   metrics_only ::</span>
<span class="line-added"> 555    *     A boolean indicating that we only want to compute the metrics of a</span>
<span class="line-added"> 556    *     given glyph, not load all of its points.</span>
<span class="line-added"> 557    *</span>
<span class="line-added"> 558    *   is_t1 ::</span>
<span class="line-added"> 559    *     Set if current font type is Type 1.</span>
<span class="line-added"> 560    *</span>
<span class="line-added"> 561    *   funcs ::</span>
<span class="line-added"> 562    *     An array of function pointers for the builder.</span>
<span class="line-added"> 563    */</span>
 564   struct  PS_Builder_
 565   {
 566     FT_Memory       memory;
 567     FT_Face         face;
 568     CFF_GlyphSlot   glyph;
 569     FT_GlyphLoader  loader;
 570     FT_Outline*     base;
 571     FT_Outline*     current;
 572 
 573     FT_Pos*  pos_x;
 574     FT_Pos*  pos_y;
 575 
 576     FT_Vector*  left_bearing;
 577     FT_Vector*  advance;
 578 
 579     FT_BBox*  bbox;          /* bounding box */
 580     FT_Bool   path_begun;
 581     FT_Bool   load_points;
 582     FT_Bool   no_recurse;
 583 
</pre>
<hr />
<pre>
 744     T1_Builder_Add_Point_Func      add_point;
 745     T1_Builder_Add_Point1_Func     add_point1;
 746     T1_Builder_Add_Contour_Func    add_contour;
 747     T1_Builder_Start_Point_Func    start_point;
 748     T1_Builder_Close_Contour_Func  close_contour;
 749 
 750   } T1_Builder_FuncsRec;
 751 
 752 
 753   /* an enumeration type to handle charstring parsing states */
 754   typedef enum  T1_ParseState_
 755   {
 756     T1_Parse_Start,
 757     T1_Parse_Have_Width,
 758     T1_Parse_Have_Moveto,
 759     T1_Parse_Have_Path
 760 
 761   } T1_ParseState;
 762 
 763 
<span class="line-modified"> 764   /**************************************************************************</span>
<span class="line-modified"> 765    *</span>
<span class="line-modified"> 766    * @struct:</span>
<span class="line-modified"> 767    *   T1_BuilderRec</span>
<span class="line-modified"> 768    *</span>
<span class="line-modified"> 769    * @description:</span>
<span class="line-modified"> 770    *    A structure used during glyph loading to store its outline.</span>
<span class="line-modified"> 771    *</span>
<span class="line-modified"> 772    * @fields:</span>
<span class="line-modified"> 773    *   memory ::</span>
<span class="line-modified"> 774    *     The current memory object.</span>
<span class="line-modified"> 775    *</span>
<span class="line-modified"> 776    *   face ::</span>
<span class="line-modified"> 777    *     The current face object.</span>
<span class="line-modified"> 778    *</span>
<span class="line-modified"> 779    *   glyph ::</span>
<span class="line-modified"> 780    *     The current glyph slot.</span>
<span class="line-modified"> 781    *</span>
<span class="line-modified"> 782    *   loader ::</span>
<span class="line-modified"> 783    *     XXX</span>
<span class="line-modified"> 784    *</span>
<span class="line-modified"> 785    *   base ::</span>
<span class="line-modified"> 786    *     The base glyph outline.</span>
<span class="line-modified"> 787    *</span>
<span class="line-modified"> 788    *   current ::</span>
<span class="line-modified"> 789    *     The current glyph outline.</span>
<span class="line-modified"> 790    *</span>
<span class="line-modified"> 791    *   max_points ::</span>
<span class="line-modified"> 792    *     maximum points in builder outline</span>
<span class="line-modified"> 793    *</span>
<span class="line-modified"> 794    *   max_contours ::</span>
<span class="line-modified"> 795    *     Maximum number of contours in builder outline.</span>
<span class="line-modified"> 796    *</span>
<span class="line-modified"> 797    *   pos_x ::</span>
<span class="line-modified"> 798    *     The horizontal translation (if composite glyph).</span>
<span class="line-modified"> 799    *</span>
<span class="line-modified"> 800    *   pos_y ::</span>
<span class="line-modified"> 801    *     The vertical translation (if composite glyph).</span>
<span class="line-modified"> 802    *</span>
<span class="line-modified"> 803    *   left_bearing ::</span>
<span class="line-modified"> 804    *     The left side bearing point.</span>
<span class="line-modified"> 805    *</span>
<span class="line-modified"> 806    *   advance ::</span>
<span class="line-modified"> 807    *     The horizontal advance vector.</span>
<span class="line-modified"> 808    *</span>
<span class="line-modified"> 809    *   bbox ::</span>
<span class="line-modified"> 810    *     Unused.</span>
<span class="line-modified"> 811    *</span>
<span class="line-added"> 812    *   parse_state ::</span>
<span class="line-added"> 813    *     An enumeration which controls the charstring parsing state.</span>
<span class="line-added"> 814    *</span>
<span class="line-added"> 815    *   load_points ::</span>
<span class="line-added"> 816    *     If this flag is not set, no points are loaded.</span>
<span class="line-added"> 817    *</span>
<span class="line-added"> 818    *   no_recurse ::</span>
<span class="line-added"> 819    *     Set but not used.</span>
<span class="line-added"> 820    *</span>
<span class="line-added"> 821    *   metrics_only ::</span>
<span class="line-added"> 822    *     A boolean indicating that we only want to compute the metrics of a</span>
<span class="line-added"> 823    *     given glyph, not load all of its points.</span>
<span class="line-added"> 824    *</span>
<span class="line-added"> 825    *   funcs ::</span>
<span class="line-added"> 826    *     An array of function pointers for the builder.</span>
<span class="line-added"> 827    */</span>
 828   typedef struct  T1_BuilderRec_
 829   {
 830     FT_Memory       memory;
 831     FT_Face         face;
 832     FT_GlyphSlot    glyph;
 833     FT_GlyphLoader  loader;
 834     FT_Outline*     base;
 835     FT_Outline*     current;
 836 
 837     FT_Pos          pos_x;
 838     FT_Pos          pos_y;
 839 
 840     FT_Vector       left_bearing;
 841     FT_Vector       advance;
 842 
 843     FT_BBox         bbox;          /* bounding box */
 844     T1_ParseState   parse_state;
 845     FT_Bool         load_points;
 846     FT_Bool         no_recurse;
 847 
 848     FT_Bool         metrics_only;
 849 
 850     void*           hints_funcs;    /* hinter-specific */
 851     void*           hints_globals;  /* hinter-specific */
 852 
 853     T1_Builder_FuncsRec  funcs;
 854 
 855   } T1_BuilderRec;
 856 
 857 
 858   /*************************************************************************/
 859   /*************************************************************************/
 860   /*****                                                               *****/
 861   /*****                         T1 DECODER                            *****/
 862   /*****                                                               *****/
 863   /*************************************************************************/
 864   /*************************************************************************/
 865 
 866 #if 0
 867 
<span class="line-modified"> 868   /**************************************************************************</span>
<span class="line-modified"> 869    *</span>
<span class="line-modified"> 870    * T1_MAX_SUBRS_CALLS details the maximum number of nested sub-routine</span>
<span class="line-modified"> 871    * calls during glyph loading.</span>
<span class="line-modified"> 872    */</span>
 873 #define T1_MAX_SUBRS_CALLS  8
 874 
 875 
<span class="line-modified"> 876   /**************************************************************************</span>
<span class="line-modified"> 877    *</span>
<span class="line-modified"> 878    * T1_MAX_CHARSTRING_OPERANDS is the charstring stack&#39;s capacity.  A</span>
<span class="line-modified"> 879    * minimum of 16 is required.</span>
<span class="line-modified"> 880    */</span>
 881 #define T1_MAX_CHARSTRINGS_OPERANDS  32
 882 
 883 #endif /* 0 */
 884 
 885 
 886   typedef struct  T1_Decoder_ZoneRec_
 887   {
 888     FT_Byte*  cursor;
 889     FT_Byte*  base;
 890     FT_Byte*  limit;
 891 
 892   } T1_Decoder_ZoneRec, *T1_Decoder_Zone;
 893 
 894 
 895   typedef struct T1_DecoderRec_*              T1_Decoder;
 896   typedef const struct T1_Decoder_FuncsRec_*  T1_Decoder_Funcs;
 897 
 898 
 899   typedef FT_Error
 900   (*T1_Decoder_Callback)( T1_Decoder  decoder,
</pre>
<hr />
<pre>
1024     void
1025     (*init)( CFF_Builder*   builder,
1026              TT_Face        face,
1027              CFF_Size       size,
1028              CFF_GlyphSlot  glyph,
1029              FT_Bool        hinting );
1030 
1031     void
1032     (*done)( CFF_Builder*  builder );
1033 
1034     CFF_Builder_Check_Points_Func   check_points;
1035     CFF_Builder_Add_Point_Func      add_point;
1036     CFF_Builder_Add_Point1_Func     add_point1;
1037     CFF_Builder_Add_Contour_Func    add_contour;
1038     CFF_Builder_Start_Point_Func    start_point;
1039     CFF_Builder_Close_Contour_Func  close_contour;
1040 
1041   } CFF_Builder_FuncsRec;
1042 
1043 
<span class="line-modified">1044   /**************************************************************************</span>
<span class="line-modified">1045    *</span>
<span class="line-modified">1046    * @struct:</span>
<span class="line-modified">1047    *   CFF_Builder</span>
<span class="line-modified">1048    *</span>
<span class="line-modified">1049    * @description:</span>
<span class="line-modified">1050    *    A structure used during glyph loading to store its outline.</span>
<span class="line-modified">1051    *</span>
<span class="line-modified">1052    * @fields:</span>
<span class="line-modified">1053    *   memory ::</span>
<span class="line-modified">1054    *     The current memory object.</span>
<span class="line-modified">1055    *</span>
<span class="line-modified">1056    *   face ::</span>
<span class="line-modified">1057    *     The current face object.</span>
<span class="line-modified">1058    *</span>
<span class="line-modified">1059    *   glyph ::</span>
<span class="line-modified">1060    *     The current glyph slot.</span>
<span class="line-modified">1061    *</span>
<span class="line-modified">1062    *   loader ::</span>
<span class="line-modified">1063    *     The current glyph loader.</span>
<span class="line-modified">1064    *</span>
<span class="line-modified">1065    *   base ::</span>
<span class="line-modified">1066    *     The base glyph outline.</span>
<span class="line-modified">1067    *</span>
<span class="line-modified">1068    *   current ::</span>
<span class="line-modified">1069    *     The current glyph outline.</span>
<span class="line-modified">1070    *</span>
<span class="line-modified">1071    *   pos_x ::</span>
<span class="line-modified">1072    *     The horizontal translation (if composite glyph).</span>
<span class="line-modified">1073    *</span>
<span class="line-modified">1074    *   pos_y ::</span>
<span class="line-modified">1075    *     The vertical translation (if composite glyph).</span>
<span class="line-modified">1076    *</span>
<span class="line-modified">1077    *   left_bearing ::</span>
<span class="line-modified">1078    *     The left side bearing point.</span>
<span class="line-modified">1079    *</span>
<span class="line-modified">1080    *   advance ::</span>
<span class="line-modified">1081    *     The horizontal advance vector.</span>
<span class="line-modified">1082    *</span>
<span class="line-modified">1083    *   bbox ::</span>
<span class="line-modified">1084    *     Unused.</span>
<span class="line-modified">1085    *</span>
<span class="line-modified">1086    *   path_begun ::</span>
<span class="line-modified">1087    *     A flag which indicates that a new path has begun.</span>
<span class="line-modified">1088    *</span>
<span class="line-modified">1089    *   load_points ::</span>
<span class="line-modified">1090    *     If this flag is not set, no points are loaded.</span>
<span class="line-added">1091    *</span>
<span class="line-added">1092    *   no_recurse ::</span>
<span class="line-added">1093    *     Set but not used.</span>
<span class="line-added">1094    *</span>
<span class="line-added">1095    *   metrics_only ::</span>
<span class="line-added">1096    *     A boolean indicating that we only want to compute the metrics of a</span>
<span class="line-added">1097    *     given glyph, not load all of its points.</span>
<span class="line-added">1098    *</span>
<span class="line-added">1099    *   hints_funcs ::</span>
<span class="line-added">1100    *     Auxiliary pointer for hinting.</span>
<span class="line-added">1101    *</span>
<span class="line-added">1102    *   hints_globals ::</span>
<span class="line-added">1103    *     Auxiliary pointer for hinting.</span>
<span class="line-added">1104    *</span>
<span class="line-added">1105    *   funcs ::</span>
<span class="line-added">1106    *     A table of method pointers for this object.</span>
<span class="line-added">1107    */</span>
1108   struct  CFF_Builder_
1109   {
1110     FT_Memory       memory;
1111     TT_Face         face;
1112     CFF_GlyphSlot   glyph;
1113     FT_GlyphLoader  loader;
1114     FT_Outline*     base;
1115     FT_Outline*     current;
1116 
1117     FT_Pos  pos_x;
1118     FT_Pos  pos_y;
1119 
1120     FT_Vector  left_bearing;
1121     FT_Vector  advance;
1122 
1123     FT_BBox  bbox;          /* bounding box */
1124 
1125     FT_Bool  path_begun;
1126     FT_Bool  load_points;
1127     FT_Bool  no_recurse;
</pre>
<hr />
<pre>
1259   typedef struct  AFM_Parser_FuncsRec_
1260   {
1261     FT_Error
1262     (*init)( AFM_Parser  parser,
1263              FT_Memory   memory,
1264              FT_Byte*    base,
1265              FT_Byte*    limit );
1266 
1267     void
1268     (*done)( AFM_Parser  parser );
1269 
1270     FT_Error
1271     (*parse)( AFM_Parser  parser );
1272 
1273   } AFM_Parser_FuncsRec;
1274 
1275 
1276   typedef struct AFM_StreamRec_*  AFM_Stream;
1277 
1278 
<span class="line-modified">1279   /**************************************************************************</span>
<span class="line-modified">1280    *</span>
<span class="line-modified">1281    * @struct:</span>
<span class="line-modified">1282    *   AFM_ParserRec</span>
<span class="line-modified">1283    *</span>
<span class="line-modified">1284    * @description:</span>
<span class="line-modified">1285    *   An AFM_Parser is a parser for the AFM files.</span>
<span class="line-modified">1286    *</span>
<span class="line-modified">1287    * @fields:</span>
<span class="line-modified">1288    *   memory ::</span>
<span class="line-modified">1289    *     The object used for memory operations (alloc and realloc).</span>
<span class="line-modified">1290    *</span>
<span class="line-modified">1291    *   stream ::</span>
<span class="line-modified">1292    *     This is an opaque object.</span>
<span class="line-modified">1293    *</span>
<span class="line-modified">1294    *   FontInfo ::</span>
<span class="line-modified">1295    *     The result will be stored here.</span>
<span class="line-modified">1296    *</span>
<span class="line-modified">1297    *   get_index ::</span>
<span class="line-added">1298    *     A user provided function to get a glyph index by its name.</span>
<span class="line-added">1299    */</span>
1300   typedef struct  AFM_ParserRec_
1301   {
1302     FT_Memory     memory;
1303     AFM_Stream    stream;
1304 
1305     AFM_FontInfo  FontInfo;
1306 
1307     FT_Int
1308     (*get_index)( const char*  name,
1309                   FT_Offset    len,
1310                   void*        user_data );
1311 
1312     void*         user_data;
1313 
1314   } AFM_ParserRec;
1315 
1316 
1317   /*************************************************************************/
1318   /*************************************************************************/
1319   /*****                                                               *****/
</pre>
</td>
</tr>
</table>
<center><a href="internal.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="pshints.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>