<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/native/libfreetype/src/cid/cidriver.c</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="cidparse.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="cidriver.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfreetype/src/cid/cidriver.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
<span class="line-modified">  1 /***************************************************************************/</span>
<span class="line-modified">  2 /*                                                                         */</span>
<span class="line-modified">  3 /*  cidriver.c                                                             */</span>
<span class="line-modified">  4 /*                                                                         */</span>
<span class="line-modified">  5 /*    CID driver interface (body).                                         */</span>
<span class="line-modified">  6 /*                                                                         */</span>
<span class="line-modified">  7 /*  Copyright 1996-2018 by                                                 */</span>
<span class="line-modified">  8 /*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */</span>
<span class="line-modified">  9 /*                                                                         */</span>
<span class="line-modified"> 10 /*  This file is part of the FreeType project, and may only be used,       */</span>
<span class="line-modified"> 11 /*  modified, and distributed under the terms of the FreeType project      */</span>
<span class="line-modified"> 12 /*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<span class="line-modified"> 13 /*  this file you indicate that you have read the license and              */</span>
<span class="line-modified"> 14 /*  understand and accept it fully.                                        */</span>
<span class="line-modified"> 15 /*                                                                         */</span>
<span class="line-modified"> 16 /***************************************************************************/</span>
 17 
 18 
 19 #include &lt;ft2build.h&gt;
 20 #include &quot;cidriver.h&quot;
 21 #include &quot;cidgload.h&quot;
 22 #include FT_INTERNAL_DEBUG_H
 23 #include FT_INTERNAL_POSTSCRIPT_PROPS_H
 24 
 25 #include &quot;ciderrs.h&quot;
 26 
 27 #include FT_SERVICE_POSTSCRIPT_NAME_H
 28 #include FT_SERVICE_FONT_FORMAT_H
 29 #include FT_SERVICE_POSTSCRIPT_INFO_H
 30 #include FT_SERVICE_CID_H
 31 #include FT_SERVICE_PROPERTIES_H
 32 #include FT_DRIVER_H
 33 
 34 #include FT_INTERNAL_POSTSCRIPT_AUX_H
 35 
 36 
<span class="line-modified"> 37   /*************************************************************************/</span>
<span class="line-modified"> 38   /*                                                                       */</span>
<span class="line-modified"> 39   /* The macro FT_COMPONENT is used in trace mode.  It is an implicit      */</span>
<span class="line-modified"> 40   /* parameter of the FT_TRACE() and FT_ERROR() macros, used to print/log  */</span>
<span class="line-modified"> 41   /* messages during execution.                                            */</span>
<span class="line-modified"> 42   /*                                                                       */</span>
 43 #undef  FT_COMPONENT
<span class="line-modified"> 44 #define FT_COMPONENT  trace_ciddriver</span>
 45 
 46 
 47   /*
<span class="line-modified"> 48    *  POSTSCRIPT NAME SERVICE</span>
 49    *
 50    */
 51 
 52   static const char*
 53   cid_get_postscript_name( CID_Face  face )
 54   {
 55     const char*  result = face-&gt;cid.cid_font_name;
 56 
 57 
 58     if ( result &amp;&amp; result[0] == &#39;/&#39; )
 59       result++;
 60 
 61     return result;
 62   }
 63 
 64 
 65   static const FT_Service_PsFontNameRec  cid_service_ps_name =
 66   {
 67     (FT_PsName_GetFunc)cid_get_postscript_name    /* get_ps_font_name */
 68   };
 69 
 70 
 71   /*
<span class="line-modified"> 72    *  POSTSCRIPT INFO SERVICE</span>
 73    *
 74    */
 75 
 76   static FT_Error
 77   cid_ps_get_font_info( FT_Face          face,
 78                         PS_FontInfoRec*  afont_info )
 79   {
 80     *afont_info = ((CID_Face)face)-&gt;cid.font_info;
 81 
 82     return FT_Err_Ok;
 83   }
 84 
 85   static FT_Error
 86   cid_ps_get_font_extra( FT_Face          face,
 87                         PS_FontExtraRec*  afont_extra )
 88   {
 89     *afont_extra = ((CID_Face)face)-&gt;font_extra;
 90 
 91     return FT_Err_Ok;
 92   }
 93 
 94   static const FT_Service_PsInfoRec  cid_service_ps_info =
 95   {
 96     (PS_GetFontInfoFunc)   cid_ps_get_font_info,   /* ps_get_font_info    */
 97     (PS_GetFontExtraFunc)  cid_ps_get_font_extra,  /* ps_get_font_extra   */
 98     /* unsupported with CID fonts */
 99     (PS_HasGlyphNamesFunc) NULL,                   /* ps_has_glyph_names  */
100     /* unsupported                */
101     (PS_GetFontPrivateFunc)NULL,                   /* ps_get_font_private */
102     /* not implemented            */
103     (PS_GetFontValueFunc)  NULL                    /* ps_get_font_value   */
104   };
105 
106 
107   /*
<span class="line-modified">108    *  CID INFO SERVICE</span>
109    *
110    */
111   static FT_Error
112   cid_get_ros( CID_Face      face,
113                const char*  *registry,
114                const char*  *ordering,
115                FT_Int       *supplement )
116   {
117     CID_FaceInfo  cid = &amp;face-&gt;cid;
118 
119 
120     if ( registry )
121       *registry = cid-&gt;registry;
122 
123     if ( ordering )
124       *ordering = cid-&gt;ordering;
125 
126     if ( supplement )
127       *supplement = cid-&gt;supplement;
128 
</pre>
<hr />
<pre>
156 
157     if ( cid )
158       *cid = glyph_index; /* identity mapping */
159 
160     return error;
161   }
162 
163 
164   static const FT_Service_CIDRec  cid_service_cid_info =
165   {
166     (FT_CID_GetRegistryOrderingSupplementFunc)
167       cid_get_ros,                             /* get_ros                  */
168     (FT_CID_GetIsInternallyCIDKeyedFunc)
169       cid_get_is_cid,                          /* get_is_cid               */
170     (FT_CID_GetCIDFromGlyphIndexFunc)
171       cid_get_cid_from_glyph_index             /* get_cid_from_glyph_index */
172   };
173 
174 
175   /*
<span class="line-modified">176    *  PROPERTY SERVICE</span>
177    *
178    */
179 
180   FT_DEFINE_SERVICE_PROPERTIESREC(
181     cid_service_properties,
182 
183     (FT_Properties_SetFunc)ps_property_set,      /* set_property */
184     (FT_Properties_GetFunc)ps_property_get )     /* get_property */
185 
186 
187   /*
<span class="line-modified">188    *  SERVICE LIST</span>
189    *
190    */
191 
192   static const FT_ServiceDescRec  cid_services[] =
193   {
194     { FT_SERVICE_ID_FONT_FORMAT,          FT_FONT_FORMAT_CID },
195     { FT_SERVICE_ID_POSTSCRIPT_FONT_NAME, &amp;cid_service_ps_name },
196     { FT_SERVICE_ID_POSTSCRIPT_INFO,      &amp;cid_service_ps_info },
197     { FT_SERVICE_ID_CID,                  &amp;cid_service_cid_info },
198     { FT_SERVICE_ID_PROPERTIES,           &amp;cid_service_properties },
199     { NULL, NULL }
200   };
201 
202 
203   FT_CALLBACK_DEF( FT_Module_Interface )
204   cid_get_interface( FT_Module    module,
205                      const char*  cid_interface )
206   {
207     FT_UNUSED( module );
208 
</pre>
</td>
<td>
<hr />
<pre>
<span class="line-modified">  1 /****************************************************************************</span>
<span class="line-modified">  2  *</span>
<span class="line-modified">  3  * cidriver.c</span>
<span class="line-modified">  4  *</span>
<span class="line-modified">  5  *   CID driver interface (body).</span>
<span class="line-modified">  6  *</span>
<span class="line-modified">  7  * Copyright (C) 1996-2019 by</span>
<span class="line-modified">  8  * David Turner, Robert Wilhelm, and Werner Lemberg.</span>
<span class="line-modified">  9  *</span>
<span class="line-modified"> 10  * This file is part of the FreeType project, and may only be used,</span>
<span class="line-modified"> 11  * modified, and distributed under the terms of the FreeType project</span>
<span class="line-modified"> 12  * license, LICENSE.TXT.  By continuing to use, modify, or distribute</span>
<span class="line-modified"> 13  * this file you indicate that you have read the license and</span>
<span class="line-modified"> 14  * understand and accept it fully.</span>
<span class="line-modified"> 15  *</span>
<span class="line-modified"> 16  */</span>
 17 
 18 
 19 #include &lt;ft2build.h&gt;
 20 #include &quot;cidriver.h&quot;
 21 #include &quot;cidgload.h&quot;
 22 #include FT_INTERNAL_DEBUG_H
 23 #include FT_INTERNAL_POSTSCRIPT_PROPS_H
 24 
 25 #include &quot;ciderrs.h&quot;
 26 
 27 #include FT_SERVICE_POSTSCRIPT_NAME_H
 28 #include FT_SERVICE_FONT_FORMAT_H
 29 #include FT_SERVICE_POSTSCRIPT_INFO_H
 30 #include FT_SERVICE_CID_H
 31 #include FT_SERVICE_PROPERTIES_H
 32 #include FT_DRIVER_H
 33 
 34 #include FT_INTERNAL_POSTSCRIPT_AUX_H
 35 
 36 
<span class="line-modified"> 37   /**************************************************************************</span>
<span class="line-modified"> 38    *</span>
<span class="line-modified"> 39    * The macro FT_COMPONENT is used in trace mode.  It is an implicit</span>
<span class="line-modified"> 40    * parameter of the FT_TRACE() and FT_ERROR() macros, used to print/log</span>
<span class="line-modified"> 41    * messages during execution.</span>
<span class="line-modified"> 42    */</span>
 43 #undef  FT_COMPONENT
<span class="line-modified"> 44 #define FT_COMPONENT  ciddriver</span>
 45 
 46 
 47   /*
<span class="line-modified"> 48    * POSTSCRIPT NAME SERVICE</span>
 49    *
 50    */
 51 
 52   static const char*
 53   cid_get_postscript_name( CID_Face  face )
 54   {
 55     const char*  result = face-&gt;cid.cid_font_name;
 56 
 57 
 58     if ( result &amp;&amp; result[0] == &#39;/&#39; )
 59       result++;
 60 
 61     return result;
 62   }
 63 
 64 
 65   static const FT_Service_PsFontNameRec  cid_service_ps_name =
 66   {
 67     (FT_PsName_GetFunc)cid_get_postscript_name    /* get_ps_font_name */
 68   };
 69 
 70 
 71   /*
<span class="line-modified"> 72    * POSTSCRIPT INFO SERVICE</span>
 73    *
 74    */
 75 
 76   static FT_Error
 77   cid_ps_get_font_info( FT_Face          face,
 78                         PS_FontInfoRec*  afont_info )
 79   {
 80     *afont_info = ((CID_Face)face)-&gt;cid.font_info;
 81 
 82     return FT_Err_Ok;
 83   }
 84 
 85   static FT_Error
 86   cid_ps_get_font_extra( FT_Face          face,
 87                         PS_FontExtraRec*  afont_extra )
 88   {
 89     *afont_extra = ((CID_Face)face)-&gt;font_extra;
 90 
 91     return FT_Err_Ok;
 92   }
 93 
 94   static const FT_Service_PsInfoRec  cid_service_ps_info =
 95   {
 96     (PS_GetFontInfoFunc)   cid_ps_get_font_info,   /* ps_get_font_info    */
 97     (PS_GetFontExtraFunc)  cid_ps_get_font_extra,  /* ps_get_font_extra   */
 98     /* unsupported with CID fonts */
 99     (PS_HasGlyphNamesFunc) NULL,                   /* ps_has_glyph_names  */
100     /* unsupported                */
101     (PS_GetFontPrivateFunc)NULL,                   /* ps_get_font_private */
102     /* not implemented            */
103     (PS_GetFontValueFunc)  NULL                    /* ps_get_font_value   */
104   };
105 
106 
107   /*
<span class="line-modified">108    * CID INFO SERVICE</span>
109    *
110    */
111   static FT_Error
112   cid_get_ros( CID_Face      face,
113                const char*  *registry,
114                const char*  *ordering,
115                FT_Int       *supplement )
116   {
117     CID_FaceInfo  cid = &amp;face-&gt;cid;
118 
119 
120     if ( registry )
121       *registry = cid-&gt;registry;
122 
123     if ( ordering )
124       *ordering = cid-&gt;ordering;
125 
126     if ( supplement )
127       *supplement = cid-&gt;supplement;
128 
</pre>
<hr />
<pre>
156 
157     if ( cid )
158       *cid = glyph_index; /* identity mapping */
159 
160     return error;
161   }
162 
163 
164   static const FT_Service_CIDRec  cid_service_cid_info =
165   {
166     (FT_CID_GetRegistryOrderingSupplementFunc)
167       cid_get_ros,                             /* get_ros                  */
168     (FT_CID_GetIsInternallyCIDKeyedFunc)
169       cid_get_is_cid,                          /* get_is_cid               */
170     (FT_CID_GetCIDFromGlyphIndexFunc)
171       cid_get_cid_from_glyph_index             /* get_cid_from_glyph_index */
172   };
173 
174 
175   /*
<span class="line-modified">176    * PROPERTY SERVICE</span>
177    *
178    */
179 
180   FT_DEFINE_SERVICE_PROPERTIESREC(
181     cid_service_properties,
182 
183     (FT_Properties_SetFunc)ps_property_set,      /* set_property */
184     (FT_Properties_GetFunc)ps_property_get )     /* get_property */
185 
186 
187   /*
<span class="line-modified">188    * SERVICE LIST</span>
189    *
190    */
191 
192   static const FT_ServiceDescRec  cid_services[] =
193   {
194     { FT_SERVICE_ID_FONT_FORMAT,          FT_FONT_FORMAT_CID },
195     { FT_SERVICE_ID_POSTSCRIPT_FONT_NAME, &amp;cid_service_ps_name },
196     { FT_SERVICE_ID_POSTSCRIPT_INFO,      &amp;cid_service_ps_info },
197     { FT_SERVICE_ID_CID,                  &amp;cid_service_cid_info },
198     { FT_SERVICE_ID_PROPERTIES,           &amp;cid_service_properties },
199     { NULL, NULL }
200   };
201 
202 
203   FT_CALLBACK_DEF( FT_Module_Interface )
204   cid_get_interface( FT_Module    module,
205                      const char*  cid_interface )
206   {
207     FT_UNUSED( module );
208 
</pre>
</td>
</tr>
</table>
<center><a href="cidparse.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="cidriver.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>