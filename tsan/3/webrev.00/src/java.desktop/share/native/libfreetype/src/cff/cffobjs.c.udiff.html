<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.desktop/share/native/libfreetype/src/cff/cffobjs.c</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="cffload.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="cffobjs.h.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfreetype/src/cff/cffobjs.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,21 +1,21 @@</span>
<span class="udiff-line-modified-removed">- /***************************************************************************/</span>
<span class="udiff-line-modified-removed">- /*                                                                         */</span>
<span class="udiff-line-modified-removed">- /*  cffobjs.c                                                              */</span>
<span class="udiff-line-modified-removed">- /*                                                                         */</span>
<span class="udiff-line-modified-removed">- /*    OpenType objects manager (body).                                     */</span>
<span class="udiff-line-modified-removed">- /*                                                                         */</span>
<span class="udiff-line-modified-removed">- /*  Copyright 1996-2018 by                                                 */</span>
<span class="udiff-line-modified-removed">- /*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */</span>
<span class="udiff-line-modified-removed">- /*                                                                         */</span>
<span class="udiff-line-modified-removed">- /*  This file is part of the FreeType project, and may only be used,       */</span>
<span class="udiff-line-modified-removed">- /*  modified, and distributed under the terms of the FreeType project      */</span>
<span class="udiff-line-modified-removed">- /*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<span class="udiff-line-modified-removed">- /*  this file you indicate that you have read the license and              */</span>
<span class="udiff-line-modified-removed">- /*  understand and accept it fully.                                        */</span>
<span class="udiff-line-modified-removed">- /*                                                                         */</span>
<span class="udiff-line-modified-removed">- /***************************************************************************/</span>
<span class="udiff-line-modified-added">+ /****************************************************************************</span>
<span class="udiff-line-modified-added">+  *</span>
<span class="udiff-line-modified-added">+  * cffobjs.c</span>
<span class="udiff-line-modified-added">+  *</span>
<span class="udiff-line-modified-added">+  *   OpenType objects manager (body).</span>
<span class="udiff-line-modified-added">+  *</span>
<span class="udiff-line-modified-added">+  * Copyright (C) 1996-2019 by</span>
<span class="udiff-line-modified-added">+  * David Turner, Robert Wilhelm, and Werner Lemberg.</span>
<span class="udiff-line-modified-added">+  *</span>
<span class="udiff-line-modified-added">+  * This file is part of the FreeType project, and may only be used,</span>
<span class="udiff-line-modified-added">+  * modified, and distributed under the terms of the FreeType project</span>
<span class="udiff-line-modified-added">+  * license, LICENSE.TXT.  By continuing to use, modify, or distribute</span>
<span class="udiff-line-modified-added">+  * this file you indicate that you have read the license and</span>
<span class="udiff-line-modified-added">+  * understand and accept it fully.</span>
<span class="udiff-line-modified-added">+  *</span>
<span class="udiff-line-modified-added">+  */</span>
  
  
  #include &lt;ft2build.h&gt;
  
  #include FT_INTERNAL_DEBUG_H
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -35,33 +35,32 @@</span>
  
  #include FT_INTERNAL_CFF_OBJECTS_TYPES_H
  #include &quot;cffobjs.h&quot;
  #include &quot;cffload.h&quot;
  #include &quot;cffcmap.h&quot;
<span class="udiff-line-removed">- #include &quot;cffpic.h&quot;</span>
  
  #include &quot;cfferrs.h&quot;
  
  #include FT_INTERNAL_POSTSCRIPT_AUX_H
  #include FT_SERVICE_CFF_TABLE_LOAD_H
  
  
<span class="udiff-line-modified-removed">-   /*************************************************************************/</span>
<span class="udiff-line-modified-removed">-   /*                                                                       */</span>
<span class="udiff-line-modified-removed">-   /* The macro FT_COMPONENT is used in trace mode.  It is an implicit      */</span>
<span class="udiff-line-modified-removed">-   /* parameter of the FT_TRACE() and FT_ERROR() macros, used to print/log  */</span>
<span class="udiff-line-modified-removed">-   /* messages during execution.                                            */</span>
<span class="udiff-line-modified-removed">-   /*                                                                       */</span>
<span class="udiff-line-modified-added">+   /**************************************************************************</span>
<span class="udiff-line-modified-added">+    *</span>
<span class="udiff-line-modified-added">+    * The macro FT_COMPONENT is used in trace mode.  It is an implicit</span>
<span class="udiff-line-modified-added">+    * parameter of the FT_TRACE() and FT_ERROR() macros, used to print/log</span>
<span class="udiff-line-modified-added">+    * messages during execution.</span>
<span class="udiff-line-modified-added">+    */</span>
  #undef  FT_COMPONENT
<span class="udiff-line-modified-removed">- #define FT_COMPONENT  trace_cffobjs</span>
<span class="udiff-line-modified-added">+ #define FT_COMPONENT  cffobjs</span>
  
  
<span class="udiff-line-modified-removed">-   /*************************************************************************/</span>
<span class="udiff-line-modified-removed">-   /*                                                                       */</span>
<span class="udiff-line-modified-removed">-   /*                            SIZE FUNCTIONS                             */</span>
<span class="udiff-line-modified-removed">-   /*                                                                       */</span>
<span class="udiff-line-modified-removed">-   /*************************************************************************/</span>
<span class="udiff-line-modified-added">+   /**************************************************************************</span>
<span class="udiff-line-modified-added">+    *</span>
<span class="udiff-line-modified-added">+    *                           SIZE FUNCTIONS</span>
<span class="udiff-line-modified-added">+    *</span>
<span class="udiff-line-modified-added">+    */</span>
  
  
    static PSH_Globals_Funcs
    cff_size_get_globals_funcs( CFF_Size  size )
    {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -339,15 +338,15 @@</span>
  
      return FT_Err_Ok;
    }
  
  
<span class="udiff-line-modified-removed">-   /*************************************************************************/</span>
<span class="udiff-line-modified-removed">-   /*                                                                       */</span>
<span class="udiff-line-modified-removed">-   /*                            SLOT  FUNCTIONS                            */</span>
<span class="udiff-line-modified-removed">-   /*                                                                       */</span>
<span class="udiff-line-modified-removed">-   /*************************************************************************/</span>
<span class="udiff-line-modified-added">+   /**************************************************************************</span>
<span class="udiff-line-modified-added">+    *</span>
<span class="udiff-line-modified-added">+    *                           SLOT  FUNCTIONS</span>
<span class="udiff-line-modified-added">+    *</span>
<span class="udiff-line-modified-added">+    */</span>
  
    FT_LOCAL_DEF( void )
    cff_slot_done( FT_GlyphSlot  slot )
    {
      slot-&gt;internal-&gt;glyph_hints = NULL;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -381,15 +380,15 @@</span>
  
      return FT_Err_Ok;
    }
  
  
<span class="udiff-line-modified-removed">-   /*************************************************************************/</span>
<span class="udiff-line-modified-removed">-   /*                                                                       */</span>
<span class="udiff-line-modified-removed">-   /*                           FACE  FUNCTIONS                             */</span>
<span class="udiff-line-modified-removed">-   /*                                                                       */</span>
<span class="udiff-line-modified-removed">-   /*************************************************************************/</span>
<span class="udiff-line-modified-added">+   /**************************************************************************</span>
<span class="udiff-line-modified-added">+    *</span>
<span class="udiff-line-modified-added">+    *                          FACE  FUNCTIONS</span>
<span class="udiff-line-modified-added">+    *</span>
<span class="udiff-line-modified-added">+    */</span>
  
    static FT_String*
    cff_strcpy( FT_Memory         memory,
                const FT_String*  source )
    {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -643,18 +642,18 @@</span>
  
        cffface-&gt;num_glyphs = (FT_Long)cff-&gt;num_glyphs;
  
        dict = &amp;cff-&gt;top_font.font_dict;
  
<span class="udiff-line-modified-removed">-       /* we need the `PSNames&#39; module for CFF and CEF formats */</span>
<span class="udiff-line-modified-added">+       /* we need the `psnames&#39; module for CFF and CEF formats */</span>
        /* which aren&#39;t CID-keyed                               */
        if ( dict-&gt;cid_registry == 0xFFFFU &amp;&amp; !psnames )
        {
          FT_ERROR(( &quot;cff_face_init:&quot;
                     &quot; cannot open CFF &amp; CEF fonts\n&quot;
                     &quot;              &quot;
<span class="udiff-line-modified-removed">-                    &quot; without the `PSNames&#39; module\n&quot; ));</span>
<span class="udiff-line-modified-added">+                    &quot; without the `psnames&#39; module\n&quot; ));</span>
          error = FT_THROW( Missing_Module );
          goto Exit;
        }
  
  #ifdef FT_DEBUG_LEVEL_TRACE
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -961,16 +960,16 @@</span>
  
          if ( style_name )
            cffface-&gt;style_name = style_name;
          else
            /* assume &quot;Regular&quot; style if we don&#39;t know better */
<span class="udiff-line-modified-removed">-           cffface-&gt;style_name = cff_strcpy( memory, (char *)&quot;Regular&quot; );</span>
<span class="udiff-line-modified-added">+           cffface-&gt;style_name = cff_strcpy( memory, &quot;Regular&quot; );</span>
  
<span class="udiff-line-modified-removed">-         /*******************************************************************/</span>
<span class="udiff-line-modified-removed">-         /*                                                                 */</span>
<span class="udiff-line-modified-removed">-         /* Compute face flags.                                             */</span>
<span class="udiff-line-modified-removed">-         /*                                                                 */</span>
<span class="udiff-line-modified-added">+         /********************************************************************</span>
<span class="udiff-line-modified-added">+          *</span>
<span class="udiff-line-modified-added">+          * Compute face flags.</span>
<span class="udiff-line-modified-added">+          */</span>
          flags = FT_FACE_FLAG_SCALABLE   | /* scalable outlines */
                  FT_FACE_FLAG_HORIZONTAL | /* horizontal data   */
                  FT_FACE_FLAG_HINTER;      /* has native hinter */
  
          if ( sfnt_format )
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -987,14 +986,14 @@</span>
            flags |= FT_FACE_FLAG_KERNING;
  #endif
  
          cffface-&gt;face_flags |= flags;
  
<span class="udiff-line-modified-removed">-         /*******************************************************************/</span>
<span class="udiff-line-modified-removed">-         /*                                                                 */</span>
<span class="udiff-line-modified-removed">-         /* Compute style flags.                                            */</span>
<span class="udiff-line-modified-removed">-         /*                                                                 */</span>
<span class="udiff-line-modified-added">+         /********************************************************************</span>
<span class="udiff-line-modified-added">+          *</span>
<span class="udiff-line-modified-added">+          * Compute style flags.</span>
<span class="udiff-line-modified-added">+          */</span>
          flags = 0;
  
          if ( dict-&gt;italic_angle )
            flags |= FT_STYLE_FLAG_ITALIC;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1026,14 +1025,14 @@</span>
  #endif
  
        if ( dict-&gt;cid_registry != 0xFFFFU &amp;&amp; pure_cff )
          cffface-&gt;face_flags |= FT_FACE_FLAG_CID_KEYED;
  
<span class="udiff-line-modified-removed">-       /*******************************************************************/</span>
<span class="udiff-line-modified-removed">-       /*                                                                 */</span>
<span class="udiff-line-modified-removed">-       /* Compute char maps.                                              */</span>
<span class="udiff-line-modified-removed">-       /*                                                                 */</span>
<span class="udiff-line-modified-added">+       /********************************************************************</span>
<span class="udiff-line-modified-added">+        *</span>
<span class="udiff-line-modified-added">+        * Compute char maps.</span>
<span class="udiff-line-modified-added">+        */</span>
  
        /* Try to synthesize a Unicode charmap if there is none available */
        /* already.  If an OpenType font contains a Unicode &quot;cmap&quot;, we    */
        /* will use it, whatever be in the CFF part of the file.          */
        {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1068,14 +1067,15 @@</span>
          cmaprec.encoding_id = TT_MS_ID_UNICODE_CS;
          cmaprec.encoding    = FT_ENCODING_UNICODE;
  
          nn = (FT_UInt)cffface-&gt;num_charmaps;
  
<span class="udiff-line-modified-removed">-         error = FT_CMap_New( &amp;CFF_CMAP_UNICODE_CLASS_REC_GET, NULL,</span>
<span class="udiff-line-modified-added">+         error = FT_CMap_New( &amp;cff_cmap_unicode_class_rec, NULL,</span>
                               &amp;cmaprec, NULL );
          if ( error                                      &amp;&amp;
<span class="udiff-line-modified-removed">-              FT_ERR_NEQ( error, No_Unicode_Glyph_Name ) )</span>
<span class="udiff-line-modified-added">+              FT_ERR_NEQ( error, No_Unicode_Glyph_Name ) &amp;&amp;</span>
<span class="udiff-line-added">+              FT_ERR_NEQ( error, Unimplemented_Feature ) )</span>
            goto Exit;
          error = FT_Err_Ok;
  
          /* if no Unicode charmap was previously selected, select this one */
          if ( !cffface-&gt;charmap &amp;&amp; nn != (FT_UInt)cffface-&gt;num_charmaps )
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1092,23 +1092,23 @@</span>
  
            if ( encoding-&gt;offset == 0 )
            {
              cmaprec.encoding_id = TT_ADOBE_ID_STANDARD;
              cmaprec.encoding    = FT_ENCODING_ADOBE_STANDARD;
<span class="udiff-line-modified-removed">-             clazz               = &amp;CFF_CMAP_ENCODING_CLASS_REC_GET;</span>
<span class="udiff-line-modified-added">+             clazz               = &amp;cff_cmap_encoding_class_rec;</span>
            }
            else if ( encoding-&gt;offset == 1 )
            {
              cmaprec.encoding_id = TT_ADOBE_ID_EXPERT;
              cmaprec.encoding    = FT_ENCODING_ADOBE_EXPERT;
<span class="udiff-line-modified-removed">-             clazz               = &amp;CFF_CMAP_ENCODING_CLASS_REC_GET;</span>
<span class="udiff-line-modified-added">+             clazz               = &amp;cff_cmap_encoding_class_rec;</span>
            }
            else
            {
              cmaprec.encoding_id = TT_ADOBE_ID_CUSTOM;
              cmaprec.encoding    = FT_ENCODING_ADOBE_CUSTOM;
<span class="udiff-line-modified-removed">-             clazz               = &amp;CFF_CMAP_ENCODING_CLASS_REC_GET;</span>
<span class="udiff-line-modified-added">+             clazz               = &amp;cff_cmap_encoding_class_rec;</span>
            }
  
            error = FT_CMap_New( clazz, NULL, &amp;cmaprec, NULL );
          }
        }
</pre>
<center><a href="cffload.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="cffobjs.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>