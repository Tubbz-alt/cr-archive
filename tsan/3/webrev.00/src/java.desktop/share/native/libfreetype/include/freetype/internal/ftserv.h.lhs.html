<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.desktop/share/native/libfreetype/include/freetype/internal/ftserv.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre><a name="1" id="anc1"></a><span class="line-modified">   1 /***************************************************************************/</span>
<span class="line-modified">   2 /*                                                                         */</span>
<span class="line-modified">   3 /*  ftserv.h                                                               */</span>
<span class="line-modified">   4 /*                                                                         */</span>
<span class="line-modified">   5 /*    The FreeType services (specification only).                          */</span>
<span class="line-modified">   6 /*                                                                         */</span>
<span class="line-modified">   7 /*  Copyright 2003-2018 by                                                 */</span>
<span class="line-modified">   8 /*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */</span>
<span class="line-modified">   9 /*                                                                         */</span>
<span class="line-modified">  10 /*  This file is part of the FreeType project, and may only be used,       */</span>
<span class="line-modified">  11 /*  modified, and distributed under the terms of the FreeType project      */</span>
<span class="line-modified">  12 /*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<span class="line-modified">  13 /*  this file you indicate that you have read the license and              */</span>
<span class="line-modified">  14 /*  understand and accept it fully.                                        */</span>
<span class="line-modified">  15 /*                                                                         */</span>
<span class="line-modified">  16 /***************************************************************************/</span>
<span class="line-modified">  17 </span>
<span class="line-modified">  18   /*************************************************************************/</span>
<span class="line-modified">  19   /*                                                                       */</span>
<span class="line-modified">  20   /*  Each module can export one or more `services&#39;.  Each service is      */</span>
<span class="line-modified">  21   /*  identified by a constant string and modeled by a pointer; the latter */</span>
<span class="line-modified">  22   /*  generally corresponds to a structure containing function pointers.   */</span>
<span class="line-modified">  23   /*                                                                       */</span>
<span class="line-modified">  24   /*  Note that a service&#39;s data cannot be a mere function pointer because */</span>
<span class="line-modified">  25   /*  in C it is possible that function pointers might be implemented      */</span>
<span class="line-modified">  26   /*  differently than data pointers (e.g. 48 bits instead of 32).         */</span>
<span class="line-modified">  27   /*                                                                       */</span>
<span class="line-modified">  28   /*************************************************************************/</span>
  29 
  30 
  31 #ifndef FTSERV_H_
  32 #define FTSERV_H_
  33 
  34 
  35 FT_BEGIN_HEADER
  36 
<a name="2" id="anc2"></a><span class="line-modified">  37   /*</span>

  38    * @macro:
  39    *   FT_FACE_FIND_SERVICE
  40    *
  41    * @description:
  42    *   This macro is used to look up a service from a face&#39;s driver module.
  43    *
  44    * @input:
  45    *   face ::
  46    *     The source face handle.
  47    *
  48    *   id ::
<a name="3" id="anc3"></a><span class="line-modified">  49    *     A string describing the service as defined in the service&#39;s</span>
<span class="line-modified">  50    *     header files (e.g. FT_SERVICE_ID_MULTI_MASTERS which expands to</span>
<span class="line-modified">  51    *     `multi-masters&#39;).  It is automatically prefixed with</span>
<span class="line-modified">  52    *     `FT_SERVICE_ID_&#39;.</span>
  53    *
  54    * @output:
  55    *   ptr ::
<a name="4" id="anc4"></a><span class="line-modified">  56    *     A variable that receives the service pointer.  Will be NULL</span>
<span class="line-modified">  57    *     if not found.</span>
  58    */
  59 #ifdef __cplusplus
  60 
  61 #define FT_FACE_FIND_SERVICE( face, ptr, id )                               \
  62   FT_BEGIN_STMNT                                                            \
  63     FT_Module    module = FT_MODULE( FT_FACE( face )-&gt;driver );             \
  64     FT_Pointer   _tmp_  = NULL;                                             \
  65     FT_Pointer*  _pptr_ = (FT_Pointer*)&amp;(ptr);                              \
  66                                                                             \
  67                                                                             \
  68     if ( module-&gt;clazz-&gt;get_interface )                                     \
  69       _tmp_ = module-&gt;clazz-&gt;get_interface( module, FT_SERVICE_ID_ ## id ); \
  70     *_pptr_ = _tmp_;                                                        \
  71   FT_END_STMNT
  72 
  73 #else /* !C++ */
  74 
  75 #define FT_FACE_FIND_SERVICE( face, ptr, id )                               \
  76   FT_BEGIN_STMNT                                                            \
  77     FT_Module   module = FT_MODULE( FT_FACE( face )-&gt;driver );              \
  78     FT_Pointer  _tmp_  = NULL;                                              \
  79                                                                             \
  80     if ( module-&gt;clazz-&gt;get_interface )                                     \
  81       _tmp_ = module-&gt;clazz-&gt;get_interface( module, FT_SERVICE_ID_ ## id ); \
  82     ptr = _tmp_;                                                            \
  83   FT_END_STMNT
  84 
  85 #endif /* !C++ */
  86 
  87 
<a name="5" id="anc5"></a><span class="line-modified">  88   /*</span>

  89    * @macro:
  90    *   FT_FACE_FIND_GLOBAL_SERVICE
  91    *
  92    * @description:
  93    *   This macro is used to look up a service from all modules.
  94    *
  95    * @input:
  96    *   face ::
  97    *     The source face handle.
  98    *
  99    *   id ::
<a name="6" id="anc6"></a><span class="line-modified"> 100    *     A string describing the service as defined in the service&#39;s</span>
<span class="line-modified"> 101    *     header files (e.g. FT_SERVICE_ID_MULTI_MASTERS which expands to</span>
<span class="line-modified"> 102    *     `multi-masters&#39;).  It is automatically prefixed with</span>
<span class="line-modified"> 103    *     `FT_SERVICE_ID_&#39;.</span>
 104    *
 105    * @output:
 106    *   ptr ::
<a name="7" id="anc7"></a><span class="line-modified"> 107    *     A variable that receives the service pointer.  Will be NULL</span>
<span class="line-modified"> 108    *     if not found.</span>
 109    */
 110 #ifdef __cplusplus
 111 
 112 #define FT_FACE_FIND_GLOBAL_SERVICE( face, ptr, id )                  \
 113   FT_BEGIN_STMNT                                                      \
 114     FT_Module    module = FT_MODULE( FT_FACE( face )-&gt;driver );       \
 115     FT_Pointer   _tmp_;                                               \
 116     FT_Pointer*  _pptr_ = (FT_Pointer*)&amp;(ptr);                        \
 117                                                                       \
 118                                                                       \
 119     _tmp_ = ft_module_get_service( module, FT_SERVICE_ID_ ## id, 1 ); \
 120     *_pptr_ = _tmp_;                                                  \
 121   FT_END_STMNT
 122 
 123 #else /* !C++ */
 124 
 125 #define FT_FACE_FIND_GLOBAL_SERVICE( face, ptr, id )                  \
 126   FT_BEGIN_STMNT                                                      \
 127     FT_Module   module = FT_MODULE( FT_FACE( face )-&gt;driver );        \
 128     FT_Pointer  _tmp_;                                                \
 129                                                                       \
 130                                                                       \
 131     _tmp_ = ft_module_get_service( module, FT_SERVICE_ID_ ## id, 1 ); \
 132     ptr   = _tmp_;                                                    \
 133   FT_END_STMNT
 134 
 135 #endif /* !C++ */
 136 
 137 
 138   /*************************************************************************/
 139   /*************************************************************************/
 140   /*****                                                               *****/
 141   /*****         S E R V I C E   D E S C R I P T O R S                 *****/
 142   /*****                                                               *****/
 143   /*************************************************************************/
 144   /*************************************************************************/
 145 
 146   /*
<a name="8" id="anc8"></a><span class="line-modified"> 147    *  The following structure is used to _describe_ a given service</span>
<span class="line-modified"> 148    *  to the library.  This is useful to build simple static service lists.</span>
 149    */
 150   typedef struct  FT_ServiceDescRec_
 151   {
 152     const char*  serv_id;     /* service name         */
 153     const void*  serv_data;   /* service pointer/data */
 154 
 155   } FT_ServiceDescRec;
 156 
 157   typedef const FT_ServiceDescRec*  FT_ServiceDesc;
 158 
 159 
<a name="9" id="anc9"></a><span class="line-modified"> 160   /*************************************************************************/</span>
<span class="line-modified"> 161   /*                                                                       */</span>
<span class="line-modified"> 162   /* &lt;Macro&gt;                                                               */</span>
<span class="line-modified"> 163   /*    FT_DEFINE_SERVICEDESCREC1                                          */</span>
<span class="line-modified"> 164   /*    FT_DEFINE_SERVICEDESCREC2                                          */</span>
<span class="line-modified"> 165   /*    FT_DEFINE_SERVICEDESCREC3                                          */</span>
<span class="line-modified"> 166   /*    FT_DEFINE_SERVICEDESCREC4                                          */</span>
<span class="line-modified"> 167   /*    FT_DEFINE_SERVICEDESCREC5                                          */</span>
<span class="line-modified"> 168   /*    FT_DEFINE_SERVICEDESCREC6                                          */</span>
<span class="line-modified"> 169   /*    FT_DEFINE_SERVICEDESCREC7                                          */</span>
<span class="line-modified"> 170   /*    FT_DEFINE_SERVICEDESCREC8                                          */</span>
<span class="line-modified"> 171   /*                                                                       */</span>
<span class="line-modified"> 172   /* &lt;Description&gt;                                                         */</span>
<span class="line-modified"> 173   /*    Used to initialize an array of FT_ServiceDescRec structures.       */</span>
<span class="line-modified"> 174   /*                                                                       */</span>
<span class="line-modified"> 175   /*    When FT_CONFIG_OPTION_PIC is defined a `create&#39; function needs to  */</span>
<span class="line-modified"> 176   /*    be called with a pointer to return an allocated array.  As soon as */</span>
<span class="line-modified"> 177   /*    it is no longer needed, a `destroy&#39; function needs to be called to */</span>
<span class="line-modified"> 178   /*    release that allocation.                                           */</span>
<span class="line-modified"> 179   /*                                                                       */</span>
<span class="line-removed"> 180   /*    These functions should be manually called from the `pic_init&#39; and  */</span>
<span class="line-removed"> 181   /*    `pic_free&#39; functions of your module (see FT_DEFINE_MODULE).        */</span>
<span class="line-removed"> 182   /*                                                                       */</span>
<span class="line-removed"> 183   /*    When FT_CONFIG_OPTION_PIC is not defined the array will be         */</span>
<span class="line-removed"> 184   /*    allocated in the global scope (or the scope where the macro is     */</span>
<span class="line-removed"> 185   /*    used).                                                             */</span>
<span class="line-removed"> 186   /*                                                                       */</span>
<span class="line-removed"> 187 #ifndef FT_CONFIG_OPTION_PIC</span>
<span class="line-removed"> 188 </span>
 189 #define FT_DEFINE_SERVICEDESCREC1( class_,                                  \
 190                                    serv_id_1, serv_data_1 )                 \
 191   static const FT_ServiceDescRec  class_[] =                                \
 192   {                                                                         \
 193     { serv_id_1, serv_data_1 },                                             \
 194     { NULL, NULL }                                                          \
 195   };
 196 
 197 #define FT_DEFINE_SERVICEDESCREC2( class_,                                  \
 198                                    serv_id_1, serv_data_1,                  \
 199                                    serv_id_2, serv_data_2 )                 \
 200   static const FT_ServiceDescRec  class_[] =                                \
 201   {                                                                         \
 202     { serv_id_1, serv_data_1 },                                             \
 203     { serv_id_2, serv_data_2 },                                             \
 204     { NULL, NULL }                                                          \
 205   };
 206 
 207 #define FT_DEFINE_SERVICEDESCREC3( class_,                                  \
 208                                    serv_id_1, serv_data_1,                  \
 209                                    serv_id_2, serv_data_2,                  \
 210                                    serv_id_3, serv_data_3 )                 \
 211   static const FT_ServiceDescRec  class_[] =                                \
 212   {                                                                         \
 213     { serv_id_1, serv_data_1 },                                             \
 214     { serv_id_2, serv_data_2 },                                             \
 215     { serv_id_3, serv_data_3 },                                             \
 216     { NULL, NULL }                                                          \
 217   };
 218 
 219 #define FT_DEFINE_SERVICEDESCREC4( class_,                                  \
 220                                    serv_id_1, serv_data_1,                  \
 221                                    serv_id_2, serv_data_2,                  \
 222                                    serv_id_3, serv_data_3,                  \
 223                                    serv_id_4, serv_data_4 )                 \
 224   static const FT_ServiceDescRec  class_[] =                                \
 225   {                                                                         \
 226     { serv_id_1, serv_data_1 },                                             \
 227     { serv_id_2, serv_data_2 },                                             \
 228     { serv_id_3, serv_data_3 },                                             \
 229     { serv_id_4, serv_data_4 },                                             \
 230     { NULL, NULL }                                                          \
 231   };
 232 
 233 #define FT_DEFINE_SERVICEDESCREC5( class_,                                  \
 234                                    serv_id_1, serv_data_1,                  \
 235                                    serv_id_2, serv_data_2,                  \
 236                                    serv_id_3, serv_data_3,                  \
 237                                    serv_id_4, serv_data_4,                  \
 238                                    serv_id_5, serv_data_5 )                 \
 239   static const FT_ServiceDescRec  class_[] =                                \
 240   {                                                                         \
 241     { serv_id_1, serv_data_1 },                                             \
 242     { serv_id_2, serv_data_2 },                                             \
 243     { serv_id_3, serv_data_3 },                                             \
 244     { serv_id_4, serv_data_4 },                                             \
 245     { serv_id_5, serv_data_5 },                                             \
 246     { NULL, NULL }                                                          \
 247   };
 248 
 249 #define FT_DEFINE_SERVICEDESCREC6( class_,                                  \
 250                                    serv_id_1, serv_data_1,                  \
 251                                    serv_id_2, serv_data_2,                  \
 252                                    serv_id_3, serv_data_3,                  \
 253                                    serv_id_4, serv_data_4,                  \
 254                                    serv_id_5, serv_data_5,                  \
 255                                    serv_id_6, serv_data_6 )                 \
 256   static const FT_ServiceDescRec  class_[] =                                \
 257   {                                                                         \
 258     { serv_id_1, serv_data_1 },                                             \
 259     { serv_id_2, serv_data_2 },                                             \
 260     { serv_id_3, serv_data_3 },                                             \
 261     { serv_id_4, serv_data_4 },                                             \
 262     { serv_id_5, serv_data_5 },                                             \
 263     { serv_id_6, serv_data_6 },                                             \
 264     { NULL, NULL }                                                          \
 265   };
 266 
 267 #define FT_DEFINE_SERVICEDESCREC7( class_,                                  \
 268                                    serv_id_1, serv_data_1,                  \
 269                                    serv_id_2, serv_data_2,                  \
 270                                    serv_id_3, serv_data_3,                  \
 271                                    serv_id_4, serv_data_4,                  \
 272                                    serv_id_5, serv_data_5,                  \
 273                                    serv_id_6, serv_data_6,                  \
 274                                    serv_id_7, serv_data_7 )                 \
 275   static const FT_ServiceDescRec  class_[] =                                \
 276   {                                                                         \
 277     { serv_id_1, serv_data_1 },                                             \
 278     { serv_id_2, serv_data_2 },                                             \
 279     { serv_id_3, serv_data_3 },                                             \
 280     { serv_id_4, serv_data_4 },                                             \
 281     { serv_id_5, serv_data_5 },                                             \
 282     { serv_id_6, serv_data_6 },                                             \
 283     { serv_id_7, serv_data_7 },                                             \
 284     { NULL, NULL }                                                          \
 285   };
 286 
 287 #define FT_DEFINE_SERVICEDESCREC8( class_,                                  \
 288                                    serv_id_1, serv_data_1,                  \
 289                                    serv_id_2, serv_data_2,                  \
 290                                    serv_id_3, serv_data_3,                  \
 291                                    serv_id_4, serv_data_4,                  \
 292                                    serv_id_5, serv_data_5,                  \
 293                                    serv_id_6, serv_data_6,                  \
 294                                    serv_id_7, serv_data_7,                  \
 295                                    serv_id_8, serv_data_8 )                 \
 296   static const FT_ServiceDescRec  class_[] =                                \
 297   {                                                                         \
 298     { serv_id_1, serv_data_1 },                                             \
 299     { serv_id_2, serv_data_2 },                                             \
 300     { serv_id_3, serv_data_3 },                                             \
 301     { serv_id_4, serv_data_4 },                                             \
 302     { serv_id_5, serv_data_5 },                                             \
 303     { serv_id_6, serv_data_6 },                                             \
 304     { serv_id_7, serv_data_7 },                                             \
 305     { serv_id_8, serv_data_8 },                                             \
 306     { NULL, NULL }                                                          \
 307   };
 308 
 309 #define FT_DEFINE_SERVICEDESCREC9( class_,                                  \
 310                                    serv_id_1, serv_data_1,                  \
 311                                    serv_id_2, serv_data_2,                  \
 312                                    serv_id_3, serv_data_3,                  \
 313                                    serv_id_4, serv_data_4,                  \
 314                                    serv_id_5, serv_data_5,                  \
 315                                    serv_id_6, serv_data_6,                  \
 316                                    serv_id_7, serv_data_7,                  \
 317                                    serv_id_8, serv_data_8,                  \
 318                                    serv_id_9, serv_data_9 )                 \
 319   static const FT_ServiceDescRec  class_[] =                                \
 320   {                                                                         \
 321     { serv_id_1, serv_data_1 },                                             \
 322     { serv_id_2, serv_data_2 },                                             \
 323     { serv_id_3, serv_data_3 },                                             \
 324     { serv_id_4, serv_data_4 },                                             \
 325     { serv_id_5, serv_data_5 },                                             \
 326     { serv_id_6, serv_data_6 },                                             \
 327     { serv_id_7, serv_data_7 },                                             \
 328     { serv_id_8, serv_data_8 },                                             \
 329     { serv_id_9, serv_data_9 },                                             \
 330     { NULL, NULL }                                                          \
 331   };
 332 
 333 #define FT_DEFINE_SERVICEDESCREC10( class_,                                 \
 334                                     serv_id_1, serv_data_1,                 \
 335                                     serv_id_2, serv_data_2,                 \
 336                                     serv_id_3, serv_data_3,                 \
 337                                     serv_id_4, serv_data_4,                 \
 338                                     serv_id_5, serv_data_5,                 \
 339                                     serv_id_6, serv_data_6,                 \
 340                                     serv_id_7, serv_data_7,                 \
 341                                     serv_id_8, serv_data_8,                 \
 342                                     serv_id_9, serv_data_9,                 \
 343                                     serv_id_10, serv_data_10 )              \
 344   static const FT_ServiceDescRec  class_[] =                                \
 345   {                                                                         \
 346     { serv_id_1, serv_data_1 },                                             \
 347     { serv_id_2, serv_data_2 },                                             \
 348     { serv_id_3, serv_data_3 },                                             \
 349     { serv_id_4, serv_data_4 },                                             \
 350     { serv_id_5, serv_data_5 },                                             \
 351     { serv_id_6, serv_data_6 },                                             \
 352     { serv_id_7, serv_data_7 },                                             \
 353     { serv_id_8, serv_data_8 },                                             \
 354     { serv_id_9, serv_data_9 },                                             \
 355     { serv_id_10, serv_data_10 },                                           \
 356     { NULL, NULL }                                                          \
 357   };
 358 
<a name="10" id="anc10"></a><span class="line-removed"> 359 #else /* FT_CONFIG_OPTION_PIC */</span>
<span class="line-removed"> 360 </span>
<span class="line-removed"> 361 #define FT_DEFINE_SERVICEDESCREC1( class_,                                  \</span>
<span class="line-removed"> 362                                    serv_id_1, serv_data_1 )                 \</span>
<span class="line-removed"> 363   void                                                                      \</span>
<span class="line-removed"> 364   FT_Destroy_Class_ ## class_( FT_Library          library,                 \</span>
<span class="line-removed"> 365                                FT_ServiceDescRec*  clazz )                  \</span>
<span class="line-removed"> 366   {                                                                         \</span>
<span class="line-removed"> 367     FT_Memory  memory = library-&gt;memory;                                    \</span>
<span class="line-removed"> 368                                                                             \</span>
<span class="line-removed"> 369                                                                             \</span>
<span class="line-removed"> 370     if ( clazz )                                                            \</span>
<span class="line-removed"> 371       FT_FREE( clazz );                                                     \</span>
<span class="line-removed"> 372   }                                                                         \</span>
<span class="line-removed"> 373                                                                             \</span>
<span class="line-removed"> 374   FT_Error                                                                  \</span>
<span class="line-removed"> 375   FT_Create_Class_ ## class_( FT_Library           library,                 \</span>
<span class="line-removed"> 376                               FT_ServiceDescRec**  output_class )           \</span>
<span class="line-removed"> 377   {                                                                         \</span>
<span class="line-removed"> 378     FT_ServiceDescRec*  clazz  = NULL;                                      \</span>
<span class="line-removed"> 379     FT_Error            error;                                              \</span>
<span class="line-removed"> 380     FT_Memory           memory = library-&gt;memory;                           \</span>
<span class="line-removed"> 381                                                                             \</span>
<span class="line-removed"> 382                                                                             \</span>
<span class="line-removed"> 383     if ( FT_ALLOC( clazz, sizeof ( *clazz ) * 2 ) )                         \</span>
<span class="line-removed"> 384       return error;                                                         \</span>
<span class="line-removed"> 385                                                                             \</span>
<span class="line-removed"> 386     clazz[0].serv_id   = serv_id_1;                                         \</span>
<span class="line-removed"> 387     clazz[0].serv_data = serv_data_1;                                       \</span>
<span class="line-removed"> 388     clazz[1].serv_id   = NULL;                                              \</span>
<span class="line-removed"> 389     clazz[1].serv_data = NULL;                                              \</span>
<span class="line-removed"> 390                                                                             \</span>
<span class="line-removed"> 391     *output_class = clazz;                                                  \</span>
<span class="line-removed"> 392                                                                             \</span>
<span class="line-removed"> 393     return FT_Err_Ok;                                                       \</span>
<span class="line-removed"> 394   }</span>
<span class="line-removed"> 395 </span>
<span class="line-removed"> 396 #define FT_DEFINE_SERVICEDESCREC2( class_,                                  \</span>
<span class="line-removed"> 397                                    serv_id_1, serv_data_1,                  \</span>
<span class="line-removed"> 398                                    serv_id_2, serv_data_2 )                 \</span>
<span class="line-removed"> 399   void                                                                      \</span>
<span class="line-removed"> 400   FT_Destroy_Class_ ## class_( FT_Library          library,                 \</span>
<span class="line-removed"> 401                                FT_ServiceDescRec*  clazz )                  \</span>
<span class="line-removed"> 402   {                                                                         \</span>
<span class="line-removed"> 403     FT_Memory  memory = library-&gt;memory;                                    \</span>
<span class="line-removed"> 404                                                                             \</span>
<span class="line-removed"> 405                                                                             \</span>
<span class="line-removed"> 406     if ( clazz )                                                            \</span>
<span class="line-removed"> 407       FT_FREE( clazz );                                                     \</span>
<span class="line-removed"> 408   }                                                                         \</span>
<span class="line-removed"> 409                                                                             \</span>
<span class="line-removed"> 410   FT_Error                                                                  \</span>
<span class="line-removed"> 411   FT_Create_Class_ ## class_( FT_Library           library,                 \</span>
<span class="line-removed"> 412                               FT_ServiceDescRec**  output_class )           \</span>
<span class="line-removed"> 413   {                                                                         \</span>
<span class="line-removed"> 414     FT_ServiceDescRec*  clazz  = NULL;                                      \</span>
<span class="line-removed"> 415     FT_Error            error;                                              \</span>
<span class="line-removed"> 416     FT_Memory           memory = library-&gt;memory;                           \</span>
<span class="line-removed"> 417                                                                             \</span>
<span class="line-removed"> 418                                                                             \</span>
<span class="line-removed"> 419     if ( FT_ALLOC( clazz, sizeof ( *clazz ) * 3 ) )                         \</span>
<span class="line-removed"> 420       return error;                                                         \</span>
<span class="line-removed"> 421                                                                             \</span>
<span class="line-removed"> 422     clazz[0].serv_id   = serv_id_1;                                         \</span>
<span class="line-removed"> 423     clazz[0].serv_data = serv_data_1;                                       \</span>
<span class="line-removed"> 424     clazz[1].serv_id   = serv_id_2;                                         \</span>
<span class="line-removed"> 425     clazz[1].serv_data = serv_data_2;                                       \</span>
<span class="line-removed"> 426     clazz[2].serv_id   = NULL;                                              \</span>
<span class="line-removed"> 427     clazz[2].serv_data = NULL;                                              \</span>
<span class="line-removed"> 428                                                                             \</span>
<span class="line-removed"> 429     *output_class = clazz;                                                  \</span>
<span class="line-removed"> 430                                                                             \</span>
<span class="line-removed"> 431     return FT_Err_Ok;                                                       \</span>
<span class="line-removed"> 432   }</span>
<span class="line-removed"> 433 </span>
<span class="line-removed"> 434 #define FT_DEFINE_SERVICEDESCREC3( class_,                                  \</span>
<span class="line-removed"> 435                                    serv_id_1, serv_data_1,                  \</span>
<span class="line-removed"> 436                                    serv_id_2, serv_data_2,                  \</span>
<span class="line-removed"> 437                                    serv_id_3, serv_data_3 )                 \</span>
<span class="line-removed"> 438   void                                                                      \</span>
<span class="line-removed"> 439   FT_Destroy_Class_ ## class_( FT_Library          library,                 \</span>
<span class="line-removed"> 440                                FT_ServiceDescRec*  clazz )                  \</span>
<span class="line-removed"> 441   {                                                                         \</span>
<span class="line-removed"> 442     FT_Memory  memory = library-&gt;memory;                                    \</span>
<span class="line-removed"> 443                                                                             \</span>
<span class="line-removed"> 444                                                                             \</span>
<span class="line-removed"> 445     if ( clazz )                                                            \</span>
<span class="line-removed"> 446       FT_FREE( clazz );                                                     \</span>
<span class="line-removed"> 447   }                                                                         \</span>
<span class="line-removed"> 448                                                                             \</span>
<span class="line-removed"> 449   FT_Error                                                                  \</span>
<span class="line-removed"> 450   FT_Create_Class_ ## class_( FT_Library           library,                 \</span>
<span class="line-removed"> 451                               FT_ServiceDescRec**  output_class )           \</span>
<span class="line-removed"> 452   {                                                                         \</span>
<span class="line-removed"> 453     FT_ServiceDescRec*  clazz  = NULL;                                      \</span>
<span class="line-removed"> 454     FT_Error            error;                                              \</span>
<span class="line-removed"> 455     FT_Memory           memory = library-&gt;memory;                           \</span>
<span class="line-removed"> 456                                                                             \</span>
<span class="line-removed"> 457                                                                             \</span>
<span class="line-removed"> 458     if ( FT_ALLOC( clazz, sizeof ( *clazz ) * 4 ) )                         \</span>
<span class="line-removed"> 459       return error;                                                         \</span>
<span class="line-removed"> 460                                                                             \</span>
<span class="line-removed"> 461     clazz[0].serv_id   = serv_id_1;                                         \</span>
<span class="line-removed"> 462     clazz[0].serv_data = serv_data_1;                                       \</span>
<span class="line-removed"> 463     clazz[1].serv_id   = serv_id_2;                                         \</span>
<span class="line-removed"> 464     clazz[1].serv_data = serv_data_2;                                       \</span>
<span class="line-removed"> 465     clazz[2].serv_id   = serv_id_3;                                         \</span>
<span class="line-removed"> 466     clazz[2].serv_data = serv_data_3;                                       \</span>
<span class="line-removed"> 467     clazz[3].serv_id   = NULL;                                              \</span>
<span class="line-removed"> 468     clazz[3].serv_data = NULL;                                              \</span>
<span class="line-removed"> 469                                                                             \</span>
<span class="line-removed"> 470     *output_class = clazz;                                                  \</span>
<span class="line-removed"> 471                                                                             \</span>
<span class="line-removed"> 472     return FT_Err_Ok;                                                       \</span>
<span class="line-removed"> 473   }</span>
<span class="line-removed"> 474 </span>
<span class="line-removed"> 475 #define FT_DEFINE_SERVICEDESCREC4( class_,                                  \</span>
<span class="line-removed"> 476                                    serv_id_1, serv_data_1,                  \</span>
<span class="line-removed"> 477                                    serv_id_2, serv_data_2,                  \</span>
<span class="line-removed"> 478                                    serv_id_3, serv_data_3,                  \</span>
<span class="line-removed"> 479                                    serv_id_4, serv_data_4 )                 \</span>
<span class="line-removed"> 480   void                                                                      \</span>
<span class="line-removed"> 481   FT_Destroy_Class_ ## class_( FT_Library          library,                 \</span>
<span class="line-removed"> 482                                FT_ServiceDescRec*  clazz )                  \</span>
<span class="line-removed"> 483   {                                                                         \</span>
<span class="line-removed"> 484     FT_Memory  memory = library-&gt;memory;                                    \</span>
<span class="line-removed"> 485                                                                             \</span>
<span class="line-removed"> 486                                                                             \</span>
<span class="line-removed"> 487     if ( clazz )                                                            \</span>
<span class="line-removed"> 488       FT_FREE( clazz );                                                     \</span>
<span class="line-removed"> 489   }                                                                         \</span>
<span class="line-removed"> 490                                                                             \</span>
<span class="line-removed"> 491   FT_Error                                                                  \</span>
<span class="line-removed"> 492   FT_Create_Class_ ## class_( FT_Library           library,                 \</span>
<span class="line-removed"> 493                               FT_ServiceDescRec**  output_class )           \</span>
<span class="line-removed"> 494   {                                                                         \</span>
<span class="line-removed"> 495     FT_ServiceDescRec*  clazz  = NULL;                                      \</span>
<span class="line-removed"> 496     FT_Error            error;                                              \</span>
<span class="line-removed"> 497     FT_Memory           memory = library-&gt;memory;                           \</span>
<span class="line-removed"> 498                                                                             \</span>
<span class="line-removed"> 499                                                                             \</span>
<span class="line-removed"> 500     if ( FT_ALLOC( clazz, sizeof ( *clazz ) * 5 ) )                         \</span>
<span class="line-removed"> 501       return error;                                                         \</span>
<span class="line-removed"> 502                                                                             \</span>
<span class="line-removed"> 503     clazz[0].serv_id   = serv_id_1;                                         \</span>
<span class="line-removed"> 504     clazz[0].serv_data = serv_data_1;                                       \</span>
<span class="line-removed"> 505     clazz[1].serv_id   = serv_id_2;                                         \</span>
<span class="line-removed"> 506     clazz[1].serv_data = serv_data_2;                                       \</span>
<span class="line-removed"> 507     clazz[2].serv_id   = serv_id_3;                                         \</span>
<span class="line-removed"> 508     clazz[2].serv_data = serv_data_3;                                       \</span>
<span class="line-removed"> 509     clazz[3].serv_id   = serv_id_4;                                         \</span>
<span class="line-removed"> 510     clazz[3].serv_data = serv_data_4;                                       \</span>
<span class="line-removed"> 511     clazz[4].serv_id   = NULL;                                              \</span>
<span class="line-removed"> 512     clazz[4].serv_data = NULL;                                              \</span>
<span class="line-removed"> 513                                                                             \</span>
<span class="line-removed"> 514     *output_class = clazz;                                                  \</span>
<span class="line-removed"> 515                                                                             \</span>
<span class="line-removed"> 516     return FT_Err_Ok;                                                       \</span>
<span class="line-removed"> 517   }</span>
<span class="line-removed"> 518 </span>
<span class="line-removed"> 519 #define FT_DEFINE_SERVICEDESCREC5( class_,                                  \</span>
<span class="line-removed"> 520                                    serv_id_1, serv_data_1,                  \</span>
<span class="line-removed"> 521                                    serv_id_2, serv_data_2,                  \</span>
<span class="line-removed"> 522                                    serv_id_3, serv_data_3,                  \</span>
<span class="line-removed"> 523                                    serv_id_4, serv_data_4,                  \</span>
<span class="line-removed"> 524                                    serv_id_5, serv_data_5 )                 \</span>
<span class="line-removed"> 525   void                                                                      \</span>
<span class="line-removed"> 526   FT_Destroy_Class_ ## class_( FT_Library          library,                 \</span>
<span class="line-removed"> 527                                FT_ServiceDescRec*  clazz )                  \</span>
<span class="line-removed"> 528   {                                                                         \</span>
<span class="line-removed"> 529     FT_Memory  memory = library-&gt;memory;                                    \</span>
<span class="line-removed"> 530                                                                             \</span>
<span class="line-removed"> 531                                                                             \</span>
<span class="line-removed"> 532     if ( clazz )                                                            \</span>
<span class="line-removed"> 533       FT_FREE( clazz );                                                     \</span>
<span class="line-removed"> 534   }                                                                         \</span>
<span class="line-removed"> 535                                                                             \</span>
<span class="line-removed"> 536   FT_Error                                                                  \</span>
<span class="line-removed"> 537   FT_Create_Class_ ## class_( FT_Library           library,                 \</span>
<span class="line-removed"> 538                               FT_ServiceDescRec**  output_class )           \</span>
<span class="line-removed"> 539   {                                                                         \</span>
<span class="line-removed"> 540     FT_ServiceDescRec*  clazz  = NULL;                                      \</span>
<span class="line-removed"> 541     FT_Error            error;                                              \</span>
<span class="line-removed"> 542     FT_Memory           memory = library-&gt;memory;                           \</span>
<span class="line-removed"> 543                                                                             \</span>
<span class="line-removed"> 544                                                                             \</span>
<span class="line-removed"> 545     if ( FT_ALLOC( clazz, sizeof ( *clazz ) * 6 ) )                         \</span>
<span class="line-removed"> 546       return error;                                                         \</span>
<span class="line-removed"> 547                                                                             \</span>
<span class="line-removed"> 548     clazz[0].serv_id   = serv_id_1;                                         \</span>
<span class="line-removed"> 549     clazz[0].serv_data = serv_data_1;                                       \</span>
<span class="line-removed"> 550     clazz[1].serv_id   = serv_id_2;                                         \</span>
<span class="line-removed"> 551     clazz[1].serv_data = serv_data_2;                                       \</span>
<span class="line-removed"> 552     clazz[2].serv_id   = serv_id_3;                                         \</span>
<span class="line-removed"> 553     clazz[2].serv_data = serv_data_3;                                       \</span>
<span class="line-removed"> 554     clazz[3].serv_id   = serv_id_4;                                         \</span>
<span class="line-removed"> 555     clazz[3].serv_data = serv_data_4;                                       \</span>
<span class="line-removed"> 556     clazz[4].serv_id   = serv_id_5;                                         \</span>
<span class="line-removed"> 557     clazz[4].serv_data = serv_data_5;                                       \</span>
<span class="line-removed"> 558     clazz[5].serv_id   = NULL;                                              \</span>
<span class="line-removed"> 559     clazz[5].serv_data = NULL;                                              \</span>
<span class="line-removed"> 560                                                                             \</span>
<span class="line-removed"> 561     *output_class = clazz;                                                  \</span>
<span class="line-removed"> 562                                                                             \</span>
<span class="line-removed"> 563     return FT_Err_Ok;                                                       \</span>
<span class="line-removed"> 564   }</span>
<span class="line-removed"> 565 </span>
<span class="line-removed"> 566 #define FT_DEFINE_SERVICEDESCREC6( class_,                                  \</span>
<span class="line-removed"> 567                                    serv_id_1, serv_data_1,                  \</span>
<span class="line-removed"> 568                                    serv_id_2, serv_data_2,                  \</span>
<span class="line-removed"> 569                                    serv_id_3, serv_data_3,                  \</span>
<span class="line-removed"> 570                                    serv_id_4, serv_data_4,                  \</span>
<span class="line-removed"> 571                                    serv_id_5, serv_data_5,                  \</span>
<span class="line-removed"> 572                                    serv_id_6, serv_data_6 )                 \</span>
<span class="line-removed"> 573   void                                                                      \</span>
<span class="line-removed"> 574   FT_Destroy_Class_ ## class_( FT_Library          library,                 \</span>
<span class="line-removed"> 575                                FT_ServiceDescRec*  clazz )                  \</span>
<span class="line-removed"> 576   {                                                                         \</span>
<span class="line-removed"> 577     FT_Memory  memory = library-&gt;memory;                                    \</span>
<span class="line-removed"> 578                                                                             \</span>
<span class="line-removed"> 579                                                                             \</span>
<span class="line-removed"> 580     if ( clazz )                                                            \</span>
<span class="line-removed"> 581       FT_FREE( clazz );                                                     \</span>
<span class="line-removed"> 582   }                                                                         \</span>
<span class="line-removed"> 583                                                                             \</span>
<span class="line-removed"> 584   FT_Error                                                                  \</span>
<span class="line-removed"> 585   FT_Create_Class_ ## class_( FT_Library           library,                 \</span>
<span class="line-removed"> 586                               FT_ServiceDescRec**  output_class )           \</span>
<span class="line-removed"> 587   {                                                                         \</span>
<span class="line-removed"> 588     FT_ServiceDescRec*  clazz  = NULL;                                      \</span>
<span class="line-removed"> 589     FT_Error            error;                                              \</span>
<span class="line-removed"> 590     FT_Memory           memory = library-&gt;memory;                           \</span>
<span class="line-removed"> 591                                                                             \</span>
<span class="line-removed"> 592                                                                             \</span>
<span class="line-removed"> 593     if ( FT_ALLOC( clazz, sizeof ( *clazz ) * 7 ) )                         \</span>
<span class="line-removed"> 594       return error;                                                         \</span>
<span class="line-removed"> 595                                                                             \</span>
<span class="line-removed"> 596     clazz[0].serv_id   = serv_id_1;                                         \</span>
<span class="line-removed"> 597     clazz[0].serv_data = serv_data_1;                                       \</span>
<span class="line-removed"> 598     clazz[1].serv_id   = serv_id_2;                                         \</span>
<span class="line-removed"> 599     clazz[1].serv_data = serv_data_2;                                       \</span>
<span class="line-removed"> 600     clazz[2].serv_id   = serv_id_3;                                         \</span>
<span class="line-removed"> 601     clazz[2].serv_data = serv_data_3;                                       \</span>
<span class="line-removed"> 602     clazz[3].serv_id   = serv_id_4;                                         \</span>
<span class="line-removed"> 603     clazz[3].serv_data = serv_data_4;                                       \</span>
<span class="line-removed"> 604     clazz[4].serv_id   = serv_id_5;                                         \</span>
<span class="line-removed"> 605     clazz[4].serv_data = serv_data_5;                                       \</span>
<span class="line-removed"> 606     clazz[5].serv_id   = serv_id_6;                                         \</span>
<span class="line-removed"> 607     clazz[5].serv_data = serv_data_6;                                       \</span>
<span class="line-removed"> 608     clazz[6].serv_id   = NULL;                                              \</span>
<span class="line-removed"> 609     clazz[6].serv_data = NULL;                                              \</span>
<span class="line-removed"> 610                                                                             \</span>
<span class="line-removed"> 611     *output_class = clazz;                                                  \</span>
<span class="line-removed"> 612                                                                             \</span>
<span class="line-removed"> 613     return FT_Err_Ok;                                                       \</span>
<span class="line-removed"> 614   }</span>
<span class="line-removed"> 615 </span>
<span class="line-removed"> 616 #define FT_DEFINE_SERVICEDESCREC7( class_,                                  \</span>
<span class="line-removed"> 617                                    serv_id_1, serv_data_1,                  \</span>
<span class="line-removed"> 618                                    serv_id_2, serv_data_2,                  \</span>
<span class="line-removed"> 619                                    serv_id_3, serv_data_3,                  \</span>
<span class="line-removed"> 620                                    serv_id_4, serv_data_4,                  \</span>
<span class="line-removed"> 621                                    serv_id_5, serv_data_5,                  \</span>
<span class="line-removed"> 622                                    serv_id_6, serv_data_6,                  \</span>
<span class="line-removed"> 623                                    serv_id_7, serv_data_7 )                 \</span>
<span class="line-removed"> 624   void                                                                      \</span>
<span class="line-removed"> 625   FT_Destroy_Class_ ## class_( FT_Library          library,                 \</span>
<span class="line-removed"> 626                                FT_ServiceDescRec*  clazz )                  \</span>
<span class="line-removed"> 627   {                                                                         \</span>
<span class="line-removed"> 628     FT_Memory  memory = library-&gt;memory;                                    \</span>
<span class="line-removed"> 629                                                                             \</span>
<span class="line-removed"> 630                                                                             \</span>
<span class="line-removed"> 631     if ( clazz )                                                            \</span>
<span class="line-removed"> 632       FT_FREE( clazz );                                                     \</span>
<span class="line-removed"> 633   }                                                                         \</span>
<span class="line-removed"> 634                                                                             \</span>
<span class="line-removed"> 635   FT_Error                                                                  \</span>
<span class="line-removed"> 636   FT_Create_Class_ ## class_( FT_Library           library,                 \</span>
<span class="line-removed"> 637                               FT_ServiceDescRec**  output_class )           \</span>
<span class="line-removed"> 638   {                                                                         \</span>
<span class="line-removed"> 639     FT_ServiceDescRec*  clazz  = NULL;                                      \</span>
<span class="line-removed"> 640     FT_Error            error;                                              \</span>
<span class="line-removed"> 641     FT_Memory           memory = library-&gt;memory;                           \</span>
<span class="line-removed"> 642                                                                             \</span>
<span class="line-removed"> 643                                                                             \</span>
<span class="line-removed"> 644     if ( FT_ALLOC( clazz, sizeof ( *clazz ) * 8 ) )                         \</span>
<span class="line-removed"> 645       return error;                                                         \</span>
<span class="line-removed"> 646                                                                             \</span>
<span class="line-removed"> 647     clazz[0].serv_id   = serv_id_1;                                         \</span>
<span class="line-removed"> 648     clazz[0].serv_data = serv_data_1;                                       \</span>
<span class="line-removed"> 649     clazz[1].serv_id   = serv_id_2;                                         \</span>
<span class="line-removed"> 650     clazz[1].serv_data = serv_data_2;                                       \</span>
<span class="line-removed"> 651     clazz[2].serv_id   = serv_id_3;                                         \</span>
<span class="line-removed"> 652     clazz[2].serv_data = serv_data_3;                                       \</span>
<span class="line-removed"> 653     clazz[3].serv_id   = serv_id_4;                                         \</span>
<span class="line-removed"> 654     clazz[3].serv_data = serv_data_4;                                       \</span>
<span class="line-removed"> 655     clazz[4].serv_id   = serv_id_5;                                         \</span>
<span class="line-removed"> 656     clazz[4].serv_data = serv_data_5;                                       \</span>
<span class="line-removed"> 657     clazz[5].serv_id   = serv_id_6;                                         \</span>
<span class="line-removed"> 658     clazz[5].serv_data = serv_data_6;                                       \</span>
<span class="line-removed"> 659     clazz[6].serv_id   = serv_id_7;                                         \</span>
<span class="line-removed"> 660     clazz[6].serv_data = serv_data_7;                                       \</span>
<span class="line-removed"> 661     clazz[7].serv_id   = NULL;                                              \</span>
<span class="line-removed"> 662     clazz[7].serv_data = NULL;                                              \</span>
<span class="line-removed"> 663                                                                             \</span>
<span class="line-removed"> 664     *output_class = clazz;                                                  \</span>
<span class="line-removed"> 665                                                                             \</span>
<span class="line-removed"> 666     return FT_Err_Ok;                                                       \</span>
<span class="line-removed"> 667   }</span>
<span class="line-removed"> 668 </span>
<span class="line-removed"> 669 #define FT_DEFINE_SERVICEDESCREC8( class_,                                  \</span>
<span class="line-removed"> 670                                    serv_id_1, serv_data_1,                  \</span>
<span class="line-removed"> 671                                    serv_id_2, serv_data_2,                  \</span>
<span class="line-removed"> 672                                    serv_id_3, serv_data_3,                  \</span>
<span class="line-removed"> 673                                    serv_id_4, serv_data_4,                  \</span>
<span class="line-removed"> 674                                    serv_id_5, serv_data_5,                  \</span>
<span class="line-removed"> 675                                    serv_id_6, serv_data_6,                  \</span>
<span class="line-removed"> 676                                    serv_id_7, serv_data_7,                  \</span>
<span class="line-removed"> 677                                    serv_id_8, serv_data_8 )                 \</span>
<span class="line-removed"> 678   void                                                                      \</span>
<span class="line-removed"> 679   FT_Destroy_Class_ ## class_( FT_Library          library,                 \</span>
<span class="line-removed"> 680                                FT_ServiceDescRec*  clazz )                  \</span>
<span class="line-removed"> 681   {                                                                         \</span>
<span class="line-removed"> 682     FT_Memory  memory = library-&gt;memory;                                    \</span>
<span class="line-removed"> 683                                                                             \</span>
<span class="line-removed"> 684                                                                             \</span>
<span class="line-removed"> 685     if ( clazz )                                                            \</span>
<span class="line-removed"> 686       FT_FREE( clazz );                                                     \</span>
<span class="line-removed"> 687   }                                                                         \</span>
<span class="line-removed"> 688                                                                             \</span>
<span class="line-removed"> 689   FT_Error                                                                  \</span>
<span class="line-removed"> 690   FT_Create_Class_ ## class_( FT_Library           library,                 \</span>
<span class="line-removed"> 691                               FT_ServiceDescRec**  output_class )           \</span>
<span class="line-removed"> 692   {                                                                         \</span>
<span class="line-removed"> 693     FT_ServiceDescRec*  clazz  = NULL;                                      \</span>
<span class="line-removed"> 694     FT_Error            error;                                              \</span>
<span class="line-removed"> 695     FT_Memory           memory = library-&gt;memory;                           \</span>
<span class="line-removed"> 696                                                                             \</span>
<span class="line-removed"> 697                                                                             \</span>
<span class="line-removed"> 698     if ( FT_ALLOC( clazz, sizeof ( *clazz ) * 9 ) )                         \</span>
<span class="line-removed"> 699       return error;                                                         \</span>
<span class="line-removed"> 700                                                                             \</span>
<span class="line-removed"> 701     clazz[0].serv_id   = serv_id_1;                                         \</span>
<span class="line-removed"> 702     clazz[0].serv_data = serv_data_1;                                       \</span>
<span class="line-removed"> 703     clazz[1].serv_id   = serv_id_2;                                         \</span>
<span class="line-removed"> 704     clazz[1].serv_data = serv_data_2;                                       \</span>
<span class="line-removed"> 705     clazz[2].serv_id   = serv_id_3;                                         \</span>
<span class="line-removed"> 706     clazz[2].serv_data = serv_data_3;                                       \</span>
<span class="line-removed"> 707     clazz[3].serv_id   = serv_id_4;                                         \</span>
<span class="line-removed"> 708     clazz[3].serv_data = serv_data_4;                                       \</span>
<span class="line-removed"> 709     clazz[4].serv_id   = serv_id_5;                                         \</span>
<span class="line-removed"> 710     clazz[4].serv_data = serv_data_5;                                       \</span>
<span class="line-removed"> 711     clazz[5].serv_id   = serv_id_6;                                         \</span>
<span class="line-removed"> 712     clazz[5].serv_data = serv_data_6;                                       \</span>
<span class="line-removed"> 713     clazz[6].serv_id   = serv_id_7;                                         \</span>
<span class="line-removed"> 714     clazz[6].serv_data = serv_data_7;                                       \</span>
<span class="line-removed"> 715     clazz[7].serv_id   = serv_id_8;                                         \</span>
<span class="line-removed"> 716     clazz[7].serv_data = serv_data_8;                                       \</span>
<span class="line-removed"> 717     clazz[8].serv_id   = NULL;                                              \</span>
<span class="line-removed"> 718     clazz[8].serv_data = NULL;                                              \</span>
<span class="line-removed"> 719                                                                             \</span>
<span class="line-removed"> 720     *output_class = clazz;                                                  \</span>
<span class="line-removed"> 721                                                                             \</span>
<span class="line-removed"> 722     return FT_Err_Ok;                                                       \</span>
<span class="line-removed"> 723   }</span>
<span class="line-removed"> 724 </span>
<span class="line-removed"> 725 #define FT_DEFINE_SERVICEDESCREC9( class_,                                  \</span>
<span class="line-removed"> 726                                    serv_id_1, serv_data_1,                  \</span>
<span class="line-removed"> 727                                    serv_id_2, serv_data_2,                  \</span>
<span class="line-removed"> 728                                    serv_id_3, serv_data_3,                  \</span>
<span class="line-removed"> 729                                    serv_id_4, serv_data_4,                  \</span>
<span class="line-removed"> 730                                    serv_id_5, serv_data_5,                  \</span>
<span class="line-removed"> 731                                    serv_id_6, serv_data_6,                  \</span>
<span class="line-removed"> 732                                    serv_id_7, serv_data_7,                  \</span>
<span class="line-removed"> 733                                    serv_id_8, serv_data_8,                  \</span>
<span class="line-removed"> 734                                    serv_id_9, serv_data_9 )                 \</span>
<span class="line-removed"> 735   void                                                                      \</span>
<span class="line-removed"> 736   FT_Destroy_Class_ ## class_( FT_Library          library,                 \</span>
<span class="line-removed"> 737                                FT_ServiceDescRec*  clazz )                  \</span>
<span class="line-removed"> 738   {                                                                         \</span>
<span class="line-removed"> 739     FT_Memory  memory = library-&gt;memory;                                    \</span>
<span class="line-removed"> 740                                                                             \</span>
<span class="line-removed"> 741                                                                             \</span>
<span class="line-removed"> 742     if ( clazz )                                                            \</span>
<span class="line-removed"> 743       FT_FREE( clazz );                                                     \</span>
<span class="line-removed"> 744   }                                                                         \</span>
<span class="line-removed"> 745                                                                             \</span>
<span class="line-removed"> 746   FT_Error                                                                  \</span>
<span class="line-removed"> 747   FT_Create_Class_ ## class_( FT_Library           library,                 \</span>
<span class="line-removed"> 748                               FT_ServiceDescRec**  output_class )           \</span>
<span class="line-removed"> 749   {                                                                         \</span>
<span class="line-removed"> 750     FT_ServiceDescRec*  clazz  = NULL;                                      \</span>
<span class="line-removed"> 751     FT_Error            error;                                              \</span>
<span class="line-removed"> 752     FT_Memory           memory = library-&gt;memory;                           \</span>
<span class="line-removed"> 753                                                                             \</span>
<span class="line-removed"> 754                                                                             \</span>
<span class="line-removed"> 755     if ( FT_ALLOC( clazz, sizeof ( *clazz ) * 10 ) )                        \</span>
<span class="line-removed"> 756       return error;                                                         \</span>
<span class="line-removed"> 757                                                                             \</span>
<span class="line-removed"> 758     clazz[0].serv_id   = serv_id_1;                                         \</span>
<span class="line-removed"> 759     clazz[0].serv_data = serv_data_1;                                       \</span>
<span class="line-removed"> 760     clazz[1].serv_id   = serv_id_2;                                         \</span>
<span class="line-removed"> 761     clazz[1].serv_data = serv_data_2;                                       \</span>
<span class="line-removed"> 762     clazz[2].serv_id   = serv_id_3;                                         \</span>
<span class="line-removed"> 763     clazz[2].serv_data = serv_data_3;                                       \</span>
<span class="line-removed"> 764     clazz[3].serv_id   = serv_id_4;                                         \</span>
<span class="line-removed"> 765     clazz[3].serv_data = serv_data_4;                                       \</span>
<span class="line-removed"> 766     clazz[4].serv_id   = serv_id_5;                                         \</span>
<span class="line-removed"> 767     clazz[4].serv_data = serv_data_5;                                       \</span>
<span class="line-removed"> 768     clazz[5].serv_id   = serv_id_6;                                         \</span>
<span class="line-removed"> 769     clazz[5].serv_data = serv_data_6;                                       \</span>
<span class="line-removed"> 770     clazz[6].serv_id   = serv_id_7;                                         \</span>
<span class="line-removed"> 771     clazz[6].serv_data = serv_data_7;                                       \</span>
<span class="line-removed"> 772     clazz[7].serv_id   = serv_id_8;                                         \</span>
<span class="line-removed"> 773     clazz[7].serv_data = serv_data_8;                                       \</span>
<span class="line-removed"> 774     clazz[8].serv_id   = serv_id_9;                                         \</span>
<span class="line-removed"> 775     clazz[8].serv_data = serv_data_9;                                       \</span>
<span class="line-removed"> 776     clazz[9].serv_id   = NULL;                                              \</span>
<span class="line-removed"> 777     clazz[9].serv_data = NULL;                                              \</span>
<span class="line-removed"> 778                                                                             \</span>
<span class="line-removed"> 779     *output_class = clazz;                                                  \</span>
<span class="line-removed"> 780                                                                             \</span>
<span class="line-removed"> 781     return FT_Err_Ok;                                                       \</span>
<span class="line-removed"> 782   }</span>
<span class="line-removed"> 783 </span>
<span class="line-removed"> 784 #define FT_DEFINE_SERVICEDESCREC10( class_,                                 \</span>
<span class="line-removed"> 785                                     serv_id_1, serv_data_1,                 \</span>
<span class="line-removed"> 786                                     serv_id_2, serv_data_2,                 \</span>
<span class="line-removed"> 787                                     serv_id_3, serv_data_3,                 \</span>
<span class="line-removed"> 788                                     serv_id_4, serv_data_4,                 \</span>
<span class="line-removed"> 789                                     serv_id_5, serv_data_5,                 \</span>
<span class="line-removed"> 790                                     serv_id_6, serv_data_6,                 \</span>
<span class="line-removed"> 791                                     serv_id_7, serv_data_7,                 \</span>
<span class="line-removed"> 792                                     serv_id_8, serv_data_8,                 \</span>
<span class="line-removed"> 793                                     serv_id_9, serv_data_9,                 \</span>
<span class="line-removed"> 794                                     serv_id_10, serv_data_10 )              \</span>
<span class="line-removed"> 795   void                                                                      \</span>
<span class="line-removed"> 796   FT_Destroy_Class_ ## class_( FT_Library          library,                 \</span>
<span class="line-removed"> 797                                FT_ServiceDescRec*  clazz )                  \</span>
<span class="line-removed"> 798   {                                                                         \</span>
<span class="line-removed"> 799     FT_Memory  memory = library-&gt;memory;                                    \</span>
<span class="line-removed"> 800                                                                             \</span>
<span class="line-removed"> 801                                                                             \</span>
<span class="line-removed"> 802     if ( clazz )                                                            \</span>
<span class="line-removed"> 803       FT_FREE( clazz );                                                     \</span>
<span class="line-removed"> 804   }                                                                         \</span>
<span class="line-removed"> 805                                                                             \</span>
<span class="line-removed"> 806   FT_Error                                                                  \</span>
<span class="line-removed"> 807   FT_Create_Class_ ## class_( FT_Library           library,                 \</span>
<span class="line-removed"> 808                               FT_ServiceDescRec**  output_class )           \</span>
<span class="line-removed"> 809   {                                                                         \</span>
<span class="line-removed"> 810     FT_ServiceDescRec*  clazz  = NULL;                                      \</span>
<span class="line-removed"> 811     FT_Error            error;                                              \</span>
<span class="line-removed"> 812     FT_Memory           memory = library-&gt;memory;                           \</span>
<span class="line-removed"> 813                                                                             \</span>
<span class="line-removed"> 814                                                                             \</span>
<span class="line-removed"> 815     if ( FT_ALLOC( clazz, sizeof ( *clazz ) * 11 ) )                        \</span>
<span class="line-removed"> 816       return error;                                                         \</span>
<span class="line-removed"> 817                                                                             \</span>
<span class="line-removed"> 818     clazz[ 0].serv_id   = serv_id_1;                                        \</span>
<span class="line-removed"> 819     clazz[ 0].serv_data = serv_data_1;                                      \</span>
<span class="line-removed"> 820     clazz[ 1].serv_id   = serv_id_2;                                        \</span>
<span class="line-removed"> 821     clazz[ 1].serv_data = serv_data_2;                                      \</span>
<span class="line-removed"> 822     clazz[ 2].serv_id   = serv_id_3;                                        \</span>
<span class="line-removed"> 823     clazz[ 2].serv_data = serv_data_3;                                      \</span>
<span class="line-removed"> 824     clazz[ 3].serv_id   = serv_id_4;                                        \</span>
<span class="line-removed"> 825     clazz[ 3].serv_data = serv_data_4;                                      \</span>
<span class="line-removed"> 826     clazz[ 4].serv_id   = serv_id_5;                                        \</span>
<span class="line-removed"> 827     clazz[ 4].serv_data = serv_data_5;                                      \</span>
<span class="line-removed"> 828     clazz[ 5].serv_id   = serv_id_6;                                        \</span>
<span class="line-removed"> 829     clazz[ 5].serv_data = serv_data_6;                                      \</span>
<span class="line-removed"> 830     clazz[ 6].serv_id   = serv_id_7;                                        \</span>
<span class="line-removed"> 831     clazz[ 6].serv_data = serv_data_7;                                      \</span>
<span class="line-removed"> 832     clazz[ 7].serv_id   = serv_id_8;                                        \</span>
<span class="line-removed"> 833     clazz[ 7].serv_data = serv_data_8;                                      \</span>
<span class="line-removed"> 834     clazz[ 8].serv_id   = serv_id_9;                                        \</span>
<span class="line-removed"> 835     clazz[ 8].serv_data = serv_data_9;                                      \</span>
<span class="line-removed"> 836     clazz[ 9].serv_id   = serv_id_10;                                       \</span>
<span class="line-removed"> 837     clazz[ 9].serv_data = serv_data_10;                                     \</span>
<span class="line-removed"> 838     clazz[10].serv_id   = NULL;                                             \</span>
<span class="line-removed"> 839     clazz[10].serv_data = NULL;                                             \</span>
<span class="line-removed"> 840                                                                             \</span>
<span class="line-removed"> 841     *output_class = clazz;                                                  \</span>
<span class="line-removed"> 842                                                                             \</span>
<span class="line-removed"> 843     return FT_Err_Ok;                                                       \</span>
<span class="line-removed"> 844   }</span>
<span class="line-removed"> 845 </span>
<span class="line-removed"> 846 #endif /* FT_CONFIG_OPTION_PIC */</span>
<span class="line-removed"> 847 </span>
 848 
 849   /*
<a name="11" id="anc11"></a><span class="line-modified"> 850    *  Parse a list of FT_ServiceDescRec descriptors and look for</span>
<span class="line-modified"> 851    *  a specific service by ID.  Note that the last element in the</span>
<span class="line-modified"> 852    *  array must be { NULL, NULL }, and that the function should</span>
<span class="line-modified"> 853    *  return NULL if the service isn&#39;t available.</span>
 854    *
<a name="12" id="anc12"></a><span class="line-modified"> 855    *  This function can be used by modules to implement their</span>
<span class="line-modified"> 856    *  `get_service&#39; method.</span>
 857    */
 858   FT_BASE( FT_Pointer )
 859   ft_service_list_lookup( FT_ServiceDesc  service_descriptors,
 860                           const char*     service_id );
 861 
 862 
 863   /*************************************************************************/
 864   /*************************************************************************/
 865   /*****                                                               *****/
 866   /*****             S E R V I C E S   C A C H E                       *****/
 867   /*****                                                               *****/
 868   /*************************************************************************/
 869   /*************************************************************************/
 870 
 871   /*
<a name="13" id="anc13"></a><span class="line-modified"> 872    *  This structure is used to store a cache for several frequently used</span>
<span class="line-modified"> 873    *  services.  It is the type of `face-&gt;internal-&gt;services&#39;.  You</span>
<span class="line-modified"> 874    *  should only use FT_FACE_LOOKUP_SERVICE to access it.</span>
 875    *
<a name="14" id="anc14"></a><span class="line-modified"> 876    *  All fields should have the type FT_Pointer to relax compilation</span>
<span class="line-modified"> 877    *  dependencies.  We assume the developer isn&#39;t completely stupid.</span>
 878    *
<a name="15" id="anc15"></a><span class="line-modified"> 879    *  Each field must be named `service_XXXX&#39; where `XXX&#39; corresponds to</span>
<span class="line-modified"> 880    *  the correct FT_SERVICE_ID_XXXX macro.  See the definition of</span>
<span class="line-modified"> 881    *  FT_FACE_LOOKUP_SERVICE below how this is implemented.</span>
 882    *
 883    */
 884   typedef struct  FT_ServiceCacheRec_
 885   {
 886     FT_Pointer  service_POSTSCRIPT_FONT_NAME;
 887     FT_Pointer  service_MULTI_MASTERS;
 888     FT_Pointer  service_METRICS_VARIATIONS;
 889     FT_Pointer  service_GLYPH_DICT;
 890     FT_Pointer  service_PFR_METRICS;
 891     FT_Pointer  service_WINFNT;
 892 
 893   } FT_ServiceCacheRec, *FT_ServiceCache;
 894 
 895 
 896   /*
<a name="16" id="anc16"></a><span class="line-modified"> 897    *  A magic number used within the services cache.</span>
 898    */
 899 
 900   /* ensure that value `1&#39; has the same width as a pointer */
 901 #define FT_SERVICE_UNAVAILABLE  ((FT_Pointer)~(FT_PtrDist)1)
 902 
 903 
<a name="17" id="anc17"></a><span class="line-modified"> 904   /*</span>

 905    * @macro:
 906    *   FT_FACE_LOOKUP_SERVICE
 907    *
 908    * @description:
 909    *   This macro is used to look up a service from a face&#39;s driver module
 910    *   using its cache.
 911    *
 912    * @input:
<a name="18" id="anc18"></a><span class="line-modified"> 913    *   face::</span>
 914    *     The source face handle containing the cache.
 915    *
 916    *   field ::
 917    *     The field name in the cache.
 918    *
 919    *   id ::
 920    *     The service ID.
 921    *
 922    * @output:
 923    *   ptr ::
<a name="19" id="anc19"></a><span class="line-modified"> 924    *     A variable receiving the service data.  NULL if not available.</span>
 925    */
 926 #ifdef __cplusplus
 927 
 928 #define FT_FACE_LOOKUP_SERVICE( face, ptr, id )                \
 929   FT_BEGIN_STMNT                                               \
 930     FT_Pointer   svc;                                          \
 931     FT_Pointer*  Pptr = (FT_Pointer*)&amp;(ptr);                   \
 932                                                                \
 933                                                                \
 934     svc = FT_FACE( face )-&gt;internal-&gt;services. service_ ## id; \
 935     if ( svc == FT_SERVICE_UNAVAILABLE )                       \
 936       svc = NULL;                                              \
 937     else if ( svc == NULL )                                    \
 938     {                                                          \
 939       FT_FACE_FIND_SERVICE( face, svc, id );                   \
 940                                                                \
 941       FT_FACE( face )-&gt;internal-&gt;services. service_ ## id =    \
 942         (FT_Pointer)( svc != NULL ? svc                        \
 943                                   : FT_SERVICE_UNAVAILABLE );  \
 944     }                                                          \
 945     *Pptr = svc;                                               \
 946   FT_END_STMNT
 947 
 948 #else /* !C++ */
 949 
 950 #define FT_FACE_LOOKUP_SERVICE( face, ptr, id )                \
 951   FT_BEGIN_STMNT                                               \
 952     FT_Pointer  svc;                                           \
 953                                                                \
 954                                                                \
 955     svc = FT_FACE( face )-&gt;internal-&gt;services. service_ ## id; \
 956     if ( svc == FT_SERVICE_UNAVAILABLE )                       \
 957       svc = NULL;                                              \
 958     else if ( svc == NULL )                                    \
 959     {                                                          \
 960       FT_FACE_FIND_SERVICE( face, svc, id );                   \
 961                                                                \
 962       FT_FACE( face )-&gt;internal-&gt;services. service_ ## id =    \
 963         (FT_Pointer)( svc != NULL ? svc                        \
 964                                   : FT_SERVICE_UNAVAILABLE );  \
 965     }                                                          \
 966     ptr = svc;                                                 \
 967   FT_END_STMNT
 968 
 969 #endif /* !C++ */
 970 
 971   /*
<a name="20" id="anc20"></a><span class="line-modified"> 972    *  A macro used to define new service structure types.</span>
 973    */
 974 
 975 #define FT_DEFINE_SERVICE( name )            \
 976   typedef struct FT_Service_ ## name ## Rec_ \
 977     FT_Service_ ## name ## Rec ;             \
 978   typedef struct FT_Service_ ## name ## Rec_ \
 979     const * FT_Service_ ## name ;            \
 980   struct FT_Service_ ## name ## Rec_
 981 
 982   /* */
 983 
 984   /*
<a name="21" id="anc21"></a><span class="line-modified"> 985    *  The header files containing the services.</span>
 986    */
 987 
 988 #define FT_SERVICE_BDF_H                &lt;freetype/internal/services/svbdf.h&gt;
 989 #define FT_SERVICE_CFF_TABLE_LOAD_H     &lt;freetype/internal/services/svcfftl.h&gt;
 990 #define FT_SERVICE_CID_H                &lt;freetype/internal/services/svcid.h&gt;
 991 #define FT_SERVICE_FONT_FORMAT_H        &lt;freetype/internal/services/svfntfmt.h&gt;
 992 #define FT_SERVICE_GLYPH_DICT_H         &lt;freetype/internal/services/svgldict.h&gt;
 993 #define FT_SERVICE_GX_VALIDATE_H        &lt;freetype/internal/services/svgxval.h&gt;
 994 #define FT_SERVICE_KERNING_H            &lt;freetype/internal/services/svkern.h&gt;
 995 #define FT_SERVICE_METRICS_VARIATIONS_H &lt;freetype/internal/services/svmetric.h&gt;
 996 #define FT_SERVICE_MULTIPLE_MASTERS_H   &lt;freetype/internal/services/svmm.h&gt;
 997 #define FT_SERVICE_OPENTYPE_VALIDATE_H  &lt;freetype/internal/services/svotval.h&gt;
 998 #define FT_SERVICE_PFR_H                &lt;freetype/internal/services/svpfr.h&gt;
 999 #define FT_SERVICE_POSTSCRIPT_CMAPS_H   &lt;freetype/internal/services/svpscmap.h&gt;
1000 #define FT_SERVICE_POSTSCRIPT_INFO_H    &lt;freetype/internal/services/svpsinfo.h&gt;
1001 #define FT_SERVICE_POSTSCRIPT_NAME_H    &lt;freetype/internal/services/svpostnm.h&gt;
1002 #define FT_SERVICE_PROPERTIES_H         &lt;freetype/internal/services/svprop.h&gt;
1003 #define FT_SERVICE_SFNT_H               &lt;freetype/internal/services/svsfnt.h&gt;
1004 #define FT_SERVICE_TRUETYPE_ENGINE_H    &lt;freetype/internal/services/svtteng.h&gt;
1005 #define FT_SERVICE_TRUETYPE_GLYF_H      &lt;freetype/internal/services/svttglyf.h&gt;
1006 #define FT_SERVICE_TT_CMAP_H            &lt;freetype/internal/services/svttcmap.h&gt;
1007 #define FT_SERVICE_WINFNT_H             &lt;freetype/internal/services/svwinfnt.h&gt;
1008 
1009  /* */
1010 
1011 FT_END_HEADER
1012 
1013 #endif /* FTSERV_H_ */
1014 
1015 
1016 /* END */
<a name="22" id="anc22"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="22" type="hidden" />
</body>
</html>