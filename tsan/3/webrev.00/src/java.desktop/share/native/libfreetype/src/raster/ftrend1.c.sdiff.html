<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/native/libfreetype/src/raster/ftrend1.c</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="ftraster.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ftrend1.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfreetype/src/raster/ftrend1.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
<span class="line-modified">  1 /***************************************************************************/</span>
<span class="line-modified">  2 /*                                                                         */</span>
<span class="line-modified">  3 /*  ftrend1.c                                                              */</span>
<span class="line-modified">  4 /*                                                                         */</span>
<span class="line-modified">  5 /*    The FreeType glyph rasterizer interface (body).                      */</span>
<span class="line-modified">  6 /*                                                                         */</span>
<span class="line-modified">  7 /*  Copyright 1996-2018 by                                                 */</span>
<span class="line-modified">  8 /*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */</span>
<span class="line-modified">  9 /*                                                                         */</span>
<span class="line-modified"> 10 /*  This file is part of the FreeType project, and may only be used,       */</span>
<span class="line-modified"> 11 /*  modified, and distributed under the terms of the FreeType project      */</span>
<span class="line-modified"> 12 /*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<span class="line-modified"> 13 /*  this file you indicate that you have read the license and              */</span>
<span class="line-modified"> 14 /*  understand and accept it fully.                                        */</span>
<span class="line-modified"> 15 /*                                                                         */</span>
<span class="line-modified"> 16 /***************************************************************************/</span>
 17 
 18 
 19 #include &lt;ft2build.h&gt;
 20 #include FT_INTERNAL_DEBUG_H
 21 #include FT_INTERNAL_OBJECTS_H
 22 #include FT_OUTLINE_H
 23 #include &quot;ftrend1.h&quot;
 24 #include &quot;ftraster.h&quot;
<span class="line-removed"> 25 #include &quot;rastpic.h&quot;</span>
 26 
 27 #include &quot;rasterrs.h&quot;
 28 
 29 
 30   /* initialize renderer -- init its raster */
 31   static FT_Error
 32   ft_raster1_init( FT_Renderer  render )
 33   {
 34     render-&gt;clazz-&gt;raster_class-&gt;raster_reset( render-&gt;raster, NULL, 0 );
 35 
 36     return FT_Err_Ok;
 37   }
 38 
 39 
 40   /* set render-specific mode */
 41   static FT_Error
 42   ft_raster1_set_mode( FT_Renderer  render,
 43                        FT_ULong     mode_tag,
 44                        FT_Pointer   data )
 45   {
</pre>
<hr />
<pre>
111     if ( slot-&gt;format != render-&gt;glyph_format )
112     {
113       error = FT_THROW( Invalid_Argument );
114       goto Exit;
115     }
116 
117     /* check rendering mode */
118     if ( mode != FT_RENDER_MODE_MONO )
119     {
120       /* raster1 is only capable of producing monochrome bitmaps */
121       return FT_THROW( Cannot_Render_Glyph );
122     }
123 
124     /* release old bitmap buffer */
125     if ( slot-&gt;internal-&gt;flags &amp; FT_GLYPH_OWN_BITMAP )
126     {
127       FT_FREE( bitmap-&gt;buffer );
128       slot-&gt;internal-&gt;flags &amp;= ~FT_GLYPH_OWN_BITMAP;
129     }
130 
<span class="line-modified">131     ft_glyphslot_preset_bitmap( slot, mode, origin );</span>




132 
133     /* allocate new one */
134     if ( FT_ALLOC_MULT( bitmap-&gt;buffer, bitmap-&gt;rows, bitmap-&gt;pitch ) )
135       goto Exit;
136 
137     slot-&gt;internal-&gt;flags |= FT_GLYPH_OWN_BITMAP;
138 
139     x_shift = -slot-&gt;bitmap_left * 64;
140     y_shift = ( (FT_Int)bitmap-&gt;rows - slot-&gt;bitmap_top ) * 64;
141 
142     if ( origin )
143     {
144       x_shift += origin-&gt;x;
145       y_shift += origin-&gt;y;
146     }
147 
148     /* translate outline to render it into the bitmap */
149     if ( x_shift || y_shift )
150       FT_Outline_Translate( outline, x_shift, y_shift );
151 
</pre>
<hr />
<pre>
180       FT_MODULE_RENDERER,
181       sizeof ( FT_RendererRec ),
182 
183       &quot;raster1&quot;,
184       0x10000L,
185       0x20000L,
186 
187       NULL,    /* module specific interface */
188 
189       (FT_Module_Constructor)ft_raster1_init,  /* module_init   */
190       (FT_Module_Destructor) NULL,             /* module_done   */
191       (FT_Module_Requester)  NULL,             /* get_interface */
192 
193     FT_GLYPH_FORMAT_OUTLINE,
194 
195     (FT_Renderer_RenderFunc)   ft_raster1_render,     /* render_glyph    */
196     (FT_Renderer_TransformFunc)ft_raster1_transform,  /* transform_glyph */
197     (FT_Renderer_GetCBoxFunc)  ft_raster1_get_cbox,   /* get_glyph_cbox  */
198     (FT_Renderer_SetModeFunc)  ft_raster1_set_mode,   /* set_mode        */
199 
<span class="line-modified">200     (FT_Raster_Funcs*)&amp;FT_STANDARD_RASTER_GET         /* raster_class    */</span>
201   )
202 
203 
204 /* END */
</pre>
</td>
<td>
<hr />
<pre>
<span class="line-modified">  1 /****************************************************************************</span>
<span class="line-modified">  2  *</span>
<span class="line-modified">  3  * ftrend1.c</span>
<span class="line-modified">  4  *</span>
<span class="line-modified">  5  *   The FreeType glyph rasterizer interface (body).</span>
<span class="line-modified">  6  *</span>
<span class="line-modified">  7  * Copyright (C) 1996-2019 by</span>
<span class="line-modified">  8  * David Turner, Robert Wilhelm, and Werner Lemberg.</span>
<span class="line-modified">  9  *</span>
<span class="line-modified"> 10  * This file is part of the FreeType project, and may only be used,</span>
<span class="line-modified"> 11  * modified, and distributed under the terms of the FreeType project</span>
<span class="line-modified"> 12  * license, LICENSE.TXT.  By continuing to use, modify, or distribute</span>
<span class="line-modified"> 13  * this file you indicate that you have read the license and</span>
<span class="line-modified"> 14  * understand and accept it fully.</span>
<span class="line-modified"> 15  *</span>
<span class="line-modified"> 16  */</span>
 17 
 18 
 19 #include &lt;ft2build.h&gt;
 20 #include FT_INTERNAL_DEBUG_H
 21 #include FT_INTERNAL_OBJECTS_H
 22 #include FT_OUTLINE_H
 23 #include &quot;ftrend1.h&quot;
 24 #include &quot;ftraster.h&quot;

 25 
 26 #include &quot;rasterrs.h&quot;
 27 
 28 
 29   /* initialize renderer -- init its raster */
 30   static FT_Error
 31   ft_raster1_init( FT_Renderer  render )
 32   {
 33     render-&gt;clazz-&gt;raster_class-&gt;raster_reset( render-&gt;raster, NULL, 0 );
 34 
 35     return FT_Err_Ok;
 36   }
 37 
 38 
 39   /* set render-specific mode */
 40   static FT_Error
 41   ft_raster1_set_mode( FT_Renderer  render,
 42                        FT_ULong     mode_tag,
 43                        FT_Pointer   data )
 44   {
</pre>
<hr />
<pre>
110     if ( slot-&gt;format != render-&gt;glyph_format )
111     {
112       error = FT_THROW( Invalid_Argument );
113       goto Exit;
114     }
115 
116     /* check rendering mode */
117     if ( mode != FT_RENDER_MODE_MONO )
118     {
119       /* raster1 is only capable of producing monochrome bitmaps */
120       return FT_THROW( Cannot_Render_Glyph );
121     }
122 
123     /* release old bitmap buffer */
124     if ( slot-&gt;internal-&gt;flags &amp; FT_GLYPH_OWN_BITMAP )
125     {
126       FT_FREE( bitmap-&gt;buffer );
127       slot-&gt;internal-&gt;flags &amp;= ~FT_GLYPH_OWN_BITMAP;
128     }
129 
<span class="line-modified">130     if ( ft_glyphslot_preset_bitmap( slot, mode, origin ) )</span>
<span class="line-added">131     {</span>
<span class="line-added">132       error = FT_THROW( Raster_Overflow );</span>
<span class="line-added">133       goto Exit;</span>
<span class="line-added">134     }</span>
135 
136     /* allocate new one */
137     if ( FT_ALLOC_MULT( bitmap-&gt;buffer, bitmap-&gt;rows, bitmap-&gt;pitch ) )
138       goto Exit;
139 
140     slot-&gt;internal-&gt;flags |= FT_GLYPH_OWN_BITMAP;
141 
142     x_shift = -slot-&gt;bitmap_left * 64;
143     y_shift = ( (FT_Int)bitmap-&gt;rows - slot-&gt;bitmap_top ) * 64;
144 
145     if ( origin )
146     {
147       x_shift += origin-&gt;x;
148       y_shift += origin-&gt;y;
149     }
150 
151     /* translate outline to render it into the bitmap */
152     if ( x_shift || y_shift )
153       FT_Outline_Translate( outline, x_shift, y_shift );
154 
</pre>
<hr />
<pre>
183       FT_MODULE_RENDERER,
184       sizeof ( FT_RendererRec ),
185 
186       &quot;raster1&quot;,
187       0x10000L,
188       0x20000L,
189 
190       NULL,    /* module specific interface */
191 
192       (FT_Module_Constructor)ft_raster1_init,  /* module_init   */
193       (FT_Module_Destructor) NULL,             /* module_done   */
194       (FT_Module_Requester)  NULL,             /* get_interface */
195 
196     FT_GLYPH_FORMAT_OUTLINE,
197 
198     (FT_Renderer_RenderFunc)   ft_raster1_render,     /* render_glyph    */
199     (FT_Renderer_TransformFunc)ft_raster1_transform,  /* transform_glyph */
200     (FT_Renderer_GetCBoxFunc)  ft_raster1_get_cbox,   /* get_glyph_cbox  */
201     (FT_Renderer_SetModeFunc)  ft_raster1_set_mode,   /* set_mode        */
202 
<span class="line-modified">203     (FT_Raster_Funcs*)&amp;ft_standard_raster             /* raster_class    */</span>
204   )
205 
206 
207 /* END */
</pre>
</td>
</tr>
</table>
<center><a href="ftraster.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ftrend1.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>