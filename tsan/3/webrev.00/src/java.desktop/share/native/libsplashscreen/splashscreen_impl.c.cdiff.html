<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/share/native/libsplashscreen/splashscreen_impl.c</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="libpng/pngtrans.c.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="splashscreen_impl.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libsplashscreen/splashscreen_impl.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2005, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2005, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 44,35 ***</span>
          preInitialized = 1;
      }
      return &amp;splash;
  }
  
<span class="line-modified">! JNIEXPORT void JNICALL</span>
  SplashSetFileJarName(const char* fileName, const char* jarName) {
      Splash *splash = SplashGetInstance();
  
      free(splash-&gt;fileName);
      splash-&gt;fileName = SplashConvertStringAlloc(fileName, &amp;splash-&gt;fileNameLen);
  
      free(splash-&gt;jarName);
      splash-&gt;jarName = SplashConvertStringAlloc(jarName, &amp;splash-&gt;jarNameLen);
  }
  
<span class="line-modified">! JNIEXPORT void JNICALL</span>
  SplashInit()
  {
      Splash *splash = SplashGetInstance();
  
      memset(splash, 0, sizeof(Splash));
      splash-&gt;currentFrame = -1;
      splash-&gt;scaleFactor = 1;
      initFormat(&amp;splash-&gt;imageFormat, QUAD_RED_MASK, QUAD_GREEN_MASK,
          QUAD_BLUE_MASK, QUAD_ALPHA_MASK);
<span class="line-modified">!     SplashInitPlatform(splash);</span>
  }
  
<span class="line-modified">! JNIEXPORT void JNICALL</span>
  SplashClose()
  {
      Splash *splash = SplashGetInstance();
  
      if (splash-&gt;isVisible &gt; 0) {
<span class="line-new-header">--- 44,35 ---</span>
          preInitialized = 1;
      }
      return &amp;splash;
  }
  
<span class="line-modified">! JNIEXPORT void</span>
  SplashSetFileJarName(const char* fileName, const char* jarName) {
      Splash *splash = SplashGetInstance();
  
      free(splash-&gt;fileName);
      splash-&gt;fileName = SplashConvertStringAlloc(fileName, &amp;splash-&gt;fileNameLen);
  
      free(splash-&gt;jarName);
      splash-&gt;jarName = SplashConvertStringAlloc(jarName, &amp;splash-&gt;jarNameLen);
  }
  
<span class="line-modified">! JNIEXPORT int</span>
  SplashInit()
  {
      Splash *splash = SplashGetInstance();
  
      memset(splash, 0, sizeof(Splash));
      splash-&gt;currentFrame = -1;
      splash-&gt;scaleFactor = 1;
      initFormat(&amp;splash-&gt;imageFormat, QUAD_RED_MASK, QUAD_GREEN_MASK,
          QUAD_BLUE_MASK, QUAD_ALPHA_MASK);
<span class="line-modified">!     return SplashInitPlatform(splash);</span>
  }
  
<span class="line-modified">! JNIEXPORT void</span>
  SplashClose()
  {
      Splash *splash = SplashGetInstance();
  
      if (splash-&gt;isVisible &gt; 0) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 105,11 ***</span>
          splash-&gt;overlayData = NULL;
      }
      SplashSetFileJarName(NULL, NULL);
  }
  
<span class="line-modified">! JNIEXPORT void JNICALL</span>
  SplashSetScaleFactor(float scaleFactor)
  {
      Splash *splash = SplashGetInstance();
      splash-&gt;scaleFactor = scaleFactor;
  }
<span class="line-new-header">--- 105,11 ---</span>
          splash-&gt;overlayData = NULL;
      }
      SplashSetFileJarName(NULL, NULL);
  }
  
<span class="line-modified">! JNIEXPORT void</span>
  SplashSetScaleFactor(float scaleFactor)
  {
      Splash *splash = SplashGetInstance();
      splash-&gt;scaleFactor = scaleFactor;
  }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 261,10 ***</span>
<span class="line-new-header">--- 261,11 ---</span>
      int c;
      size_t i;
  
      Splash *splash = SplashGetInstance();
      if (splash-&gt;isVisible &lt; 0) {
<span class="line-added">+         stream-&gt;close(stream);</span>
          return 0;
      }
  
      SplashLock(splash);
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 300,19 ***</span>
          SplashUnlock(splash);
      }
      return success;
  }
  
<span class="line-modified">! JNIEXPORT int JNICALL</span>
  SplashLoadFile(const char *filename)
  {
      SplashStream stream;
      return SplashStreamInitFile(&amp;stream, filename) &amp;&amp;
                  SplashLoadStream(&amp;stream);
  }
  
<span class="line-modified">! JNIEXPORT int JNICALL</span>
  SplashLoadMemory(void *data, int size)
  {
      SplashStream stream;
      return SplashStreamInitMemory(&amp;stream, data, size) &amp;&amp;
                  SplashLoadStream(&amp;stream);
<span class="line-new-header">--- 301,19 ---</span>
          SplashUnlock(splash);
      }
      return success;
  }
  
<span class="line-modified">! JNIEXPORT int</span>
  SplashLoadFile(const char *filename)
  {
      SplashStream stream;
      return SplashStreamInitFile(&amp;stream, filename) &amp;&amp;
                  SplashLoadStream(&amp;stream);
  }
  
<span class="line-modified">! JNIEXPORT int</span>
  SplashLoadMemory(void *data, int size)
  {
      SplashStream stream;
      return SplashStreamInitMemory(&amp;stream, data, size) &amp;&amp;
                  SplashLoadStream(&amp;stream);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 393,11 ***</span>
      pStream-&gt;peek = peekMem;
      pStream-&gt;close = closeMem;
      return 1;
  }
  
<span class="line-modified">! JNIEXPORT int JNICALL</span>
  SplashGetScaledImgNameMaxPstfixLen(const char *fileName){
      return strlen(fileName) + strlen(&quot;@100pct&quot;) + 1;
  }
  
  jboolean GetScaledImageName(const char *fileName, char *scaleImageName,
<span class="line-new-header">--- 394,11 ---</span>
      pStream-&gt;peek = peekMem;
      pStream-&gt;close = closeMem;
      return 1;
  }
  
<span class="line-modified">! JNIEXPORT int</span>
  SplashGetScaledImgNameMaxPstfixLen(const char *fileName){
      return strlen(fileName) + strlen(&quot;@100pct&quot;) + 1;
  }
  
  jboolean GetScaledImageName(const char *fileName, char *scaleImageName,
</pre>
<center><a href="libpng/pngtrans.c.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="splashscreen_impl.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>