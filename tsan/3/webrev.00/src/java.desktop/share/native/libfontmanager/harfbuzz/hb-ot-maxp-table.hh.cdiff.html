<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/share/native/libfontmanager/harfbuzz/hb-ot-maxp-table.hh</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="hb-ot-map.cc.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="hb-ot-name-table.hh.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfontmanager/harfbuzz/hb-ot-maxp-table.hh</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 25,12 ***</span>
   */
  
  #ifndef HB_OT_MAXP_TABLE_HH
  #define HB_OT_MAXP_TABLE_HH
  
<span class="line-modified">! #include &quot;hb-open-type-private.hh&quot;</span>
<span class="line-removed">- #include &quot;hb-subset-plan.hh&quot;</span>
  
  namespace OT {
  
  
  /*
<span class="line-new-header">--- 25,11 ---</span>
   */
  
  #ifndef HB_OT_MAXP_TABLE_HH
  #define HB_OT_MAXP_TABLE_HH
  
<span class="line-modified">! #include &quot;hb-open-type.hh&quot;</span>
  
  namespace OT {
  
  
  /*
</pre>
<hr />
<pre>
<span class="line-old-header">*** 40,11 ***</span>
  
  #define HB_OT_TAG_maxp HB_TAG(&#39;m&#39;,&#39;a&#39;,&#39;x&#39;,&#39;p&#39;)
  
  struct maxpV1Tail
  {
<span class="line-modified">!   inline bool sanitize (hb_sanitize_context_t *c) const</span>
    {
      TRACE_SANITIZE (this);
      return_trace (c-&gt;check_struct (this));
    }
  
<span class="line-new-header">--- 39,11 ---</span>
  
  #define HB_OT_TAG_maxp HB_TAG(&#39;m&#39;,&#39;a&#39;,&#39;x&#39;,&#39;p&#39;)
  
  struct maxpV1Tail
  {
<span class="line-modified">!   bool sanitize (hb_sanitize_context_t *c) const</span>
    {
      TRACE_SANITIZE (this);
      return_trace (c-&gt;check_struct (this));
    }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 70,57 ***</span>
  };
  
  
  struct maxp
  {
<span class="line-modified">!   static const hb_tag_t tableTag = HB_OT_TAG_maxp;</span>
  
<span class="line-modified">!   inline unsigned int get_num_glyphs (void) const</span>
<span class="line-removed">-   {</span>
<span class="line-removed">-     return numGlyphs;</span>
<span class="line-removed">-   }</span>
  
<span class="line-modified">!   inline void set_num_glyphs (unsigned int count)</span>
    {
      numGlyphs.set (count);
    }
  
<span class="line-modified">!   inline bool sanitize (hb_sanitize_context_t *c) const</span>
    {
      TRACE_SANITIZE (this);
      if (unlikely (!c-&gt;check_struct (this)))
        return_trace (false);
  
      if (version.major == 1)
      {
        const maxpV1Tail &amp;v1 = StructAfter&lt;maxpV1Tail&gt; (*this);
<span class="line-modified">!       return v1.sanitize (c);</span>
      }
      return_trace (likely (version.major == 0 &amp;&amp; version.minor == 0x5000u));
    }
  
<span class="line-modified">!   inline bool subset (hb_subset_plan_t *plan) const</span>
    {
<span class="line-modified">!     hb_blob_t *maxp_blob = OT::Sanitizer&lt;OT::maxp&gt;().sanitize (hb_face_reference_table (plan-&gt;source, HB_OT_TAG_maxp));</span>
      hb_blob_t *maxp_prime_blob = hb_blob_copy_writable_or_fail (maxp_blob);
      hb_blob_destroy (maxp_blob);
  
      if (unlikely (!maxp_prime_blob)) {
        return false;
      }
<span class="line-modified">!     OT::maxp *maxp_prime = (OT::maxp *) hb_blob_get_data (maxp_prime_blob, nullptr);</span>
  
<span class="line-modified">!     maxp_prime-&gt;set_num_glyphs (plan-&gt;glyphs.len);</span>
      if (plan-&gt;drop_hints)
        drop_hint_fields (plan, maxp_prime);
  
      bool result = plan-&gt;add_table (HB_OT_TAG_maxp, maxp_prime_blob);
      hb_blob_destroy (maxp_prime_blob);
      return result;
    }
  
<span class="line-modified">!   static inline void drop_hint_fields (hb_subset_plan_t *plan, OT::maxp *maxp_prime)</span>
    {
      if (maxp_prime-&gt;version.major == 1)
      {
        maxpV1Tail &amp;v1 = StructAfter&lt;maxpV1Tail&gt; (*maxp_prime);
        v1.maxZones.set (1);
<span class="line-new-header">--- 69,54 ---</span>
  };
  
  
  struct maxp
  {
<span class="line-modified">!   static constexpr hb_tag_t tableTag = HB_OT_TAG_maxp;</span>
  
<span class="line-modified">!   unsigned int get_num_glyphs () const { return numGlyphs; }</span>
  
<span class="line-modified">!   void set_num_glyphs (unsigned int count)</span>
    {
      numGlyphs.set (count);
    }
  
<span class="line-modified">!   bool sanitize (hb_sanitize_context_t *c) const</span>
    {
      TRACE_SANITIZE (this);
      if (unlikely (!c-&gt;check_struct (this)))
        return_trace (false);
  
      if (version.major == 1)
      {
        const maxpV1Tail &amp;v1 = StructAfter&lt;maxpV1Tail&gt; (*this);
<span class="line-modified">!       return_trace (v1.sanitize (c));</span>
      }
      return_trace (likely (version.major == 0 &amp;&amp; version.minor == 0x5000u));
    }
  
<span class="line-modified">!   bool subset (hb_subset_plan_t *plan) const</span>
    {
<span class="line-modified">!     hb_blob_t *maxp_blob = hb_sanitize_context_t().reference_table&lt;maxp&gt; (plan-&gt;source);</span>
      hb_blob_t *maxp_prime_blob = hb_blob_copy_writable_or_fail (maxp_blob);
      hb_blob_destroy (maxp_blob);
  
      if (unlikely (!maxp_prime_blob)) {
        return false;
      }
<span class="line-modified">!     maxp *maxp_prime = (maxp *) hb_blob_get_data (maxp_prime_blob, nullptr);</span>
  
<span class="line-modified">!     maxp_prime-&gt;set_num_glyphs (plan-&gt;glyphs.length);</span>
      if (plan-&gt;drop_hints)
        drop_hint_fields (plan, maxp_prime);
  
      bool result = plan-&gt;add_table (HB_OT_TAG_maxp, maxp_prime_blob);
      hb_blob_destroy (maxp_prime_blob);
      return result;
    }
  
<span class="line-modified">!   static void drop_hint_fields (hb_subset_plan_t *plan HB_UNUSED, maxp *maxp_prime)</span>
    {
      if (maxp_prime-&gt;version.major == 1)
      {
        maxpV1Tail &amp;v1 = StructAfter&lt;maxpV1Tail&gt; (*maxp_prime);
        v1.maxZones.set (1);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 135,11 ***</span>
  
    protected:
    FixedVersion&lt;&gt;version;                /* Version of the maxp table (0.5 or 1.0),
                                           * 0x00005000u or 0x00010000u. */
    HBUINT16      numGlyphs;              /* The number of glyphs in the font. */
<span class="line-modified">! /*maxpV1Tail v1Tail[VAR]; */</span>
    public:
    DEFINE_SIZE_STATIC (6);
  };
  
  
<span class="line-new-header">--- 131,11 ---</span>
  
    protected:
    FixedVersion&lt;&gt;version;                /* Version of the maxp table (0.5 or 1.0),
                                           * 0x00005000u or 0x00010000u. */
    HBUINT16      numGlyphs;              /* The number of glyphs in the font. */
<span class="line-modified">! /*maxpV1Tail    v1Tail[VAR]; */</span>
    public:
    DEFINE_SIZE_STATIC (6);
  };
  
  
</pre>
<center><a href="hb-ot-map.cc.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="hb-ot-name-table.hh.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>