<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/share/native/libfontmanager/DrawGlyphList.c</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../libawt/java2d/loops/LoopMacros.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="HBShaper.c.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfontmanager/DrawGlyphList.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 530,10 ***</span>
<span class="line-new-header">--- 530,16 ---</span>
       * need to test that on a per glyph basis once the list becomes
       * heterogenous
       */
      if (subPixPos &amp;&amp; len &gt; 0) {
          ginfo = (GlyphInfo*)imagePtrs[0];
<span class="line-added">+         if (ginfo == NULL) {</span>
<span class="line-added">+             (*env)-&gt;ReleasePrimitiveArrayCritical(env, glyphImages,</span>
<span class="line-added">+                                                   imagePtrs, JNI_ABORT);</span>
<span class="line-added">+             free(gbv);</span>
<span class="line-added">+             return (GlyphBlitVector*)NULL;</span>
<span class="line-added">+         }</span>
          /* rowBytes==width tests if its a B&amp;W or LCD glyph */
          if (ginfo-&gt;width == ginfo-&gt;rowBytes) {
              subPixPos = JNI_FALSE;
          }
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 559,10 ***</span>
<span class="line-new-header">--- 565,16 ---</span>
  
          for (g=0; g&lt;len; g++) {
              jfloat px, py;
  
              ginfo = (GlyphInfo*)imagePtrs[g];
<span class="line-added">+             if (ginfo == NULL) {</span>
<span class="line-added">+                 (*env)-&gt;ReleasePrimitiveArrayCritical(env, glyphImages,</span>
<span class="line-added">+                                                   imagePtrs, JNI_ABORT);</span>
<span class="line-added">+                 free(gbv);</span>
<span class="line-added">+                 return (GlyphBlitVector*)NULL;</span>
<span class="line-added">+             }</span>
              gbv-&gt;glyphs[g].glyphInfo = ginfo;
              gbv-&gt;glyphs[g].pixels = ginfo-&gt;image;
              gbv-&gt;glyphs[g].width = ginfo-&gt;width;
              gbv-&gt;glyphs[g].rowBytes = ginfo-&gt;rowBytes;
              gbv-&gt;glyphs[g].height = ginfo-&gt;height;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 634,10 ***</span>
<span class="line-new-header">--- 646,16 ---</span>
          (*env)-&gt;ReleasePrimitiveArrayCritical(env,glyphPositions,
                                                positions, JNI_ABORT);
      } else {
          for (g=0; g&lt;len; g++) {
              ginfo = (GlyphInfo*)imagePtrs[g];
<span class="line-added">+             if (ginfo == NULL) {</span>
<span class="line-added">+                 (*env)-&gt;ReleasePrimitiveArrayCritical(env, glyphImages,</span>
<span class="line-added">+                                                   imagePtrs, JNI_ABORT);</span>
<span class="line-added">+                 free(gbv);</span>
<span class="line-added">+                 return (GlyphBlitVector*)NULL;</span>
<span class="line-added">+             }</span>
              gbv-&gt;glyphs[g].glyphInfo = ginfo;
              gbv-&gt;glyphs[g].pixels = ginfo-&gt;image;
              gbv-&gt;glyphs[g].width = ginfo-&gt;width;
              gbv-&gt;glyphs[g].rowBytes = ginfo-&gt;rowBytes;
              gbv-&gt;glyphs[g].height = ginfo-&gt;height;
</pre>
<center><a href="../libawt/java2d/loops/LoopMacros.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="HBShaper.c.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>