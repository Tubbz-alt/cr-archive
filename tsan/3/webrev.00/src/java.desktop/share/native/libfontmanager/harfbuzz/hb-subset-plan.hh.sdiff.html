<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/native/libfontmanager/harfbuzz/hb-subset-plan.hh</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="hb-subset-glyf.hh.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="hb-subset.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfontmanager/harfbuzz/hb-subset-plan.hh</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 10  * all copies of this software.
 11  *
 12  * IN NO EVENT SHALL THE COPYRIGHT HOLDER BE LIABLE TO ANY PARTY FOR
 13  * DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES
 14  * ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN
 15  * IF THE COPYRIGHT HOLDER HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH
 16  * DAMAGE.
 17  *
 18  * THE COPYRIGHT HOLDER SPECIFICALLY DISCLAIMS ANY WARRANTIES, INCLUDING,
 19  * BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
 20  * FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE PROVIDED HEREUNDER IS
 21  * ON AN &quot;AS IS&quot; BASIS, AND THE COPYRIGHT HOLDER HAS NO OBLIGATION TO
 22  * PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.
 23  *
 24  * Google Author(s): Garret Rieger, Roderick Sheeter
 25  */
 26 
 27 #ifndef HB_SUBSET_PLAN_HH
 28 #define HB_SUBSET_PLAN_HH
 29 
<span class="line-modified"> 30 #include &quot;hb-private.hh&quot;</span>
 31 
 32 #include &quot;hb-subset.h&quot;
<span class="line-modified"> 33 #include &quot;hb-subset-private.hh&quot;</span>
 34 
<span class="line-modified"> 35 #include &quot;hb-object-private.hh&quot;</span>
<span class="line-removed"> 36 #include &quot;hb-map-private.hh&quot;</span>
 37 
 38 struct hb_subset_plan_t
 39 {
 40   hb_object_header_t header;
<span class="line-removed"> 41   ASSERT_POD ();</span>
 42 
<span class="line-modified"> 43   hb_bool_t drop_hints;</span>
<span class="line-modified"> 44   hb_bool_t drop_ot_layout;</span>

 45 
 46   // For each cp that we&#39;d like to retain maps to the corresponding gid.
 47   hb_set_t *unicodes;
 48 
<span class="line-removed"> 49   // This list contains the complete set of glyphs to retain and may contain</span>
<span class="line-removed"> 50   // more glyphs then the lists above.</span>
 51   hb_vector_t&lt;hb_codepoint_t&gt; glyphs;

 52 
 53   hb_map_t *codepoint_to_glyph;
 54   hb_map_t *glyph_map;
 55 
 56   // Plan is only good for a specific source/dest so keep them with it
 57   hb_face_t *source;
 58   hb_face_t *dest;
 59 
<span class="line-modified"> 60   inline hb_bool_t</span>
<span class="line-modified"> 61   new_gid_for_codepoint (hb_codepoint_t codepoint,</span>
<span class="line-removed"> 62                          hb_codepoint_t *new_gid) const</span>
 63   {
 64     hb_codepoint_t old_gid = codepoint_to_glyph-&gt;get (codepoint);
 65     if (old_gid == HB_MAP_VALUE_INVALID)
 66       return false;
 67 
 68     return new_gid_for_old_gid (old_gid, new_gid);
 69   }
 70 
<span class="line-modified"> 71   inline hb_bool_t</span>
<span class="line-modified"> 72   new_gid_for_old_gid (hb_codepoint_t old_gid,</span>
<span class="line-removed"> 73                       hb_codepoint_t *new_gid) const</span>
 74   {
 75     hb_codepoint_t gid = glyph_map-&gt;get (old_gid);
 76     if (gid == HB_MAP_VALUE_INVALID)
 77       return false;
 78 
 79     *new_gid = gid;
 80     return true;
 81   }
 82 
<span class="line-modified"> 83   inline hb_bool_t</span>
 84   add_table (hb_tag_t tag,
 85              hb_blob_t *contents)
 86   {
 87     hb_blob_t *source_blob = source-&gt;reference_table (tag);
 88     DEBUG_MSG(SUBSET, nullptr, &quot;add table %c%c%c%c, dest %d bytes, source %d bytes&quot;,
 89               HB_UNTAG(tag),
 90               hb_blob_get_length (contents),
 91               hb_blob_get_length (source_blob));
 92     hb_blob_destroy (source_blob);
<span class="line-modified"> 93     return hb_subset_face_add_table(dest, tag, contents);</span>
 94   }
 95 };
 96 
 97 typedef struct hb_subset_plan_t hb_subset_plan_t;
 98 
 99 HB_INTERNAL hb_subset_plan_t *
100 hb_subset_plan_create (hb_face_t           *face,
<span class="line-removed">101                        hb_subset_profile_t *profile,</span>
102                        hb_subset_input_t   *input);
103 
104 HB_INTERNAL void
105 hb_subset_plan_destroy (hb_subset_plan_t *plan);
106 
107 #endif /* HB_SUBSET_PLAN_HH */
</pre>
</td>
<td>
<hr />
<pre>
 10  * all copies of this software.
 11  *
 12  * IN NO EVENT SHALL THE COPYRIGHT HOLDER BE LIABLE TO ANY PARTY FOR
 13  * DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES
 14  * ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN
 15  * IF THE COPYRIGHT HOLDER HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH
 16  * DAMAGE.
 17  *
 18  * THE COPYRIGHT HOLDER SPECIFICALLY DISCLAIMS ANY WARRANTIES, INCLUDING,
 19  * BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
 20  * FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE PROVIDED HEREUNDER IS
 21  * ON AN &quot;AS IS&quot; BASIS, AND THE COPYRIGHT HOLDER HAS NO OBLIGATION TO
 22  * PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.
 23  *
 24  * Google Author(s): Garret Rieger, Roderick Sheeter
 25  */
 26 
 27 #ifndef HB_SUBSET_PLAN_HH
 28 #define HB_SUBSET_PLAN_HH
 29 
<span class="line-modified"> 30 #include &quot;hb.hh&quot;</span>
 31 
 32 #include &quot;hb-subset.h&quot;
<span class="line-modified"> 33 #include &quot;hb-subset-input.hh&quot;</span>
 34 
<span class="line-modified"> 35 #include &quot;hb-map.hh&quot;</span>

 36 
 37 struct hb_subset_plan_t
 38 {
 39   hb_object_header_t header;

 40 
<span class="line-modified"> 41   bool drop_hints : 1;</span>
<span class="line-modified"> 42   bool drop_layout : 1;</span>
<span class="line-added"> 43   bool desubroutinize : 1;</span>
 44 
 45   // For each cp that we&#39;d like to retain maps to the corresponding gid.
 46   hb_set_t *unicodes;
 47 


 48   hb_vector_t&lt;hb_codepoint_t&gt; glyphs;
<span class="line-added"> 49   hb_set_t *glyphset;</span>
 50 
 51   hb_map_t *codepoint_to_glyph;
 52   hb_map_t *glyph_map;
 53 
 54   // Plan is only good for a specific source/dest so keep them with it
 55   hb_face_t *source;
 56   hb_face_t *dest;
 57 
<span class="line-modified"> 58   bool new_gid_for_codepoint (hb_codepoint_t codepoint,</span>
<span class="line-modified"> 59                               hb_codepoint_t *new_gid) const</span>

 60   {
 61     hb_codepoint_t old_gid = codepoint_to_glyph-&gt;get (codepoint);
 62     if (old_gid == HB_MAP_VALUE_INVALID)
 63       return false;
 64 
 65     return new_gid_for_old_gid (old_gid, new_gid);
 66   }
 67 
<span class="line-modified"> 68   bool new_gid_for_old_gid (hb_codepoint_t old_gid,</span>
<span class="line-modified"> 69                             hb_codepoint_t *new_gid) const</span>

 70   {
 71     hb_codepoint_t gid = glyph_map-&gt;get (old_gid);
 72     if (gid == HB_MAP_VALUE_INVALID)
 73       return false;
 74 
 75     *new_gid = gid;
 76     return true;
 77   }
 78 
<span class="line-modified"> 79   bool</span>
 80   add_table (hb_tag_t tag,
 81              hb_blob_t *contents)
 82   {
 83     hb_blob_t *source_blob = source-&gt;reference_table (tag);
 84     DEBUG_MSG(SUBSET, nullptr, &quot;add table %c%c%c%c, dest %d bytes, source %d bytes&quot;,
 85               HB_UNTAG(tag),
 86               hb_blob_get_length (contents),
 87               hb_blob_get_length (source_blob));
 88     hb_blob_destroy (source_blob);
<span class="line-modified"> 89     return hb_face_builder_add_table (dest, tag, contents);</span>
 90   }
 91 };
 92 
 93 typedef struct hb_subset_plan_t hb_subset_plan_t;
 94 
 95 HB_INTERNAL hb_subset_plan_t *
 96 hb_subset_plan_create (hb_face_t           *face,

 97                        hb_subset_input_t   *input);
 98 
 99 HB_INTERNAL void
100 hb_subset_plan_destroy (hb_subset_plan_t *plan);
101 
102 #endif /* HB_SUBSET_PLAN_HH */
</pre>
</td>
</tr>
</table>
<center><a href="hb-subset-glyf.hh.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="hb-subset.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>