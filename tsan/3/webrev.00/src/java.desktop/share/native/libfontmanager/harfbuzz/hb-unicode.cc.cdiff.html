<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/share/native/libfontmanager/harfbuzz/hb-unicode.cc</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="hb-ucdn/ucdn.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="hb-unicode.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfontmanager/harfbuzz/hb-unicode.cc</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 26,15 ***</span>
   * Red Hat Author(s): Behdad Esfahbod
   * Codethink Author(s): Ryan Lortie
   * Google Author(s): Behdad Esfahbod
   */
  
<span class="line-modified">! #include &quot;hb-private.hh&quot;</span>
  
<span class="line-modified">! #include &quot;hb-unicode-private.hh&quot;</span>
  
  
  
  /*
   * hb_unicode_funcs_t
   */
  
<span class="line-new-header">--- 26,29 ---</span>
   * Red Hat Author(s): Behdad Esfahbod
   * Codethink Author(s): Ryan Lortie
   * Google Author(s): Behdad Esfahbod
   */
  
<span class="line-modified">! #include &quot;hb.hh&quot;</span>
  
<span class="line-modified">! #include &quot;hb-unicode.hh&quot;</span>
  
  
<span class="line-added">+ /**</span>
<span class="line-added">+  * SECTION: hb-unicode</span>
<span class="line-added">+  * @title: hb-unicode</span>
<span class="line-added">+  * @short_description: Unicode character property access</span>
<span class="line-added">+  * @include: hb.h</span>
<span class="line-added">+  *</span>
<span class="line-added">+  * Unicode functions are used to access Unicode character properties.</span>
<span class="line-added">+  * Client can pass its own Unicode functions to HarfBuzz, or access</span>
<span class="line-added">+  * the built-in Unicode functions that come with HarfBuzz.</span>
<span class="line-added">+  *</span>
<span class="line-added">+  * With the Unicode functions, one can query variour Unicode character</span>
<span class="line-added">+  * properties, such as General Category, Script, Combining Class, etc.</span>
<span class="line-added">+  **/</span>
<span class="line-added">+ </span>
  
  /*
   * hb_unicode_funcs_t
   */
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 107,44 ***</span>
  {
    return 0;
  }
  
  
<span class="line-modified">! #define HB_UNICODE_FUNCS_IMPLEMENT_SET \</span>
<span class="line-modified">!   HB_UNICODE_FUNCS_IMPLEMENT (glib) \</span>
<span class="line-modified">!   HB_UNICODE_FUNCS_IMPLEMENT (icu) \</span>
<span class="line-removed">-   HB_UNICODE_FUNCS_IMPLEMENT (ucdn) \</span>
<span class="line-removed">-   HB_UNICODE_FUNCS_IMPLEMENT (nil) \</span>
<span class="line-removed">-   /* ^--- Add new callbacks before nil */</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define hb_nil_get_unicode_funcs hb_unicode_funcs_get_empty</span>
<span class="line-removed">- </span>
<span class="line-removed">- /* Prototype them all */</span>
<span class="line-removed">- #define HB_UNICODE_FUNCS_IMPLEMENT(set) \</span>
<span class="line-removed">- extern &quot;C&quot; hb_unicode_funcs_t *hb_##set##_get_unicode_funcs (void);</span>
<span class="line-removed">- HB_UNICODE_FUNCS_IMPLEMENT_SET</span>
<span class="line-removed">- #undef HB_UNICODE_FUNCS_IMPLEMENT</span>
<span class="line-removed">- </span>
  
  hb_unicode_funcs_t *
<span class="line-modified">! hb_unicode_funcs_get_default (void)</span>
  {
<span class="line-removed">- #define HB_UNICODE_FUNCS_IMPLEMENT(set) \</span>
<span class="line-removed">-   return hb_##set##_get_unicode_funcs ();</span>
<span class="line-removed">- </span>
  #if defined(HAVE_UCDN)
<span class="line-modified">!   HB_UNICODE_FUNCS_IMPLEMENT(ucdn)</span>
  #elif defined(HAVE_GLIB)
<span class="line-modified">!   HB_UNICODE_FUNCS_IMPLEMENT(glib)</span>
  #elif defined(HAVE_ICU) &amp;&amp; defined(HAVE_ICU_BUILTIN)
<span class="line-modified">!   HB_UNICODE_FUNCS_IMPLEMENT(icu)</span>
  #else
  #define HB_UNICODE_FUNCS_NIL 1
<span class="line-modified">!   HB_UNICODE_FUNCS_IMPLEMENT(nil)</span>
  #endif
<span class="line-removed">- </span>
<span class="line-removed">- #undef HB_UNICODE_FUNCS_IMPLEMENT</span>
  }
  
  #if !defined(HB_NO_UNICODE_FUNCS) &amp;&amp; defined(HB_UNICODE_FUNCS_NIL)
  #error &quot;Could not find any Unicode functions implementation, you have to provide your own&quot;
  #error &quot;Consider building hb-ucdn.c.  If you absolutely want to build without any, check the code.&quot;
<span class="line-new-header">--- 121,27 ---</span>
  {
    return 0;
  }
  
  
<span class="line-modified">! extern &quot;C&quot; hb_unicode_funcs_t *hb_glib_get_unicode_funcs ();</span>
<span class="line-modified">! extern &quot;C&quot; hb_unicode_funcs_t *hb_icu_get_unicode_funcs ();</span>
<span class="line-modified">! extern &quot;C&quot; hb_unicode_funcs_t *hb_ucdn_get_unicode_funcs ();</span>
  
  hb_unicode_funcs_t *
<span class="line-modified">! hb_unicode_funcs_get_default ()</span>
  {
  #if defined(HAVE_UCDN)
<span class="line-modified">!   return hb_ucdn_get_unicode_funcs ();</span>
  #elif defined(HAVE_GLIB)
<span class="line-modified">!   return hb_glib_get_unicode_funcs ();</span>
  #elif defined(HAVE_ICU) &amp;&amp; defined(HAVE_ICU_BUILTIN)
<span class="line-modified">!   return hb_icu_get_unicode_funcs ();</span>
  #else
  #define HB_UNICODE_FUNCS_NIL 1
<span class="line-modified">!   return hb_unicode_funcs_get_empty ();</span>
  #endif
  }
  
  #if !defined(HB_NO_UNICODE_FUNCS) &amp;&amp; defined(HB_UNICODE_FUNCS_NIL)
  #error &quot;Could not find any Unicode functions implementation, you have to provide your own&quot;
  #error &quot;Consider building hb-ucdn.c.  If you absolutely want to build without any, check the code.&quot;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 183,15 ***</span>
  
    return ufuncs;
  }
  
  
<span class="line-modified">! const hb_unicode_funcs_t _hb_unicode_funcs_nil = {</span>
    HB_OBJECT_HEADER_STATIC,
  
    nullptr, /* parent */
<span class="line-removed">-   true, /* immutable */</span>
    {
  #define HB_UNICODE_FUNC_IMPLEMENT(name) hb_unicode_##name##_nil,
      HB_UNICODE_FUNCS_IMPLEMENT_CALLBACKS
  #undef HB_UNICODE_FUNC_IMPLEMENT
    }
<span class="line-new-header">--- 180,15 ---</span>
  
    return ufuncs;
  }
  
  
<span class="line-modified">! DEFINE_NULL_INSTANCE (hb_unicode_funcs_t) =</span>
<span class="line-added">+ {</span>
    HB_OBJECT_HEADER_STATIC,
  
    nullptr, /* parent */
    {
  #define HB_UNICODE_FUNC_IMPLEMENT(name) hb_unicode_##name##_nil,
      HB_UNICODE_FUNCS_IMPLEMENT_CALLBACKS
  #undef HB_UNICODE_FUNC_IMPLEMENT
    }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 205,13 ***</span>
   * Return value: (transfer full):
   *
   * Since: 0.9.2
   **/
  hb_unicode_funcs_t *
<span class="line-modified">! hb_unicode_funcs_get_empty (void)</span>
  {
<span class="line-modified">!   return const_cast&lt;hb_unicode_funcs_t *&gt; (&amp;_hb_unicode_funcs_nil);</span>
  }
  
  /**
   * hb_unicode_funcs_reference: (skip)
   * @ufuncs: Unicode functions.
<span class="line-new-header">--- 202,13 ---</span>
   * Return value: (transfer full):
   *
   * Since: 0.9.2
   **/
  hb_unicode_funcs_t *
<span class="line-modified">! hb_unicode_funcs_get_empty ()</span>
  {
<span class="line-modified">!   return const_cast&lt;hb_unicode_funcs_t *&gt; (&amp;Null(hb_unicode_funcs_t));</span>
  }
  
  /**
   * hb_unicode_funcs_reference: (skip)
   * @ufuncs: Unicode functions.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 303,14 ***</span>
   * Since: 0.9.2
   **/
  void
  hb_unicode_funcs_make_immutable (hb_unicode_funcs_t *ufuncs)
  {
<span class="line-modified">!   if (unlikely (hb_object_is_inert (ufuncs)))</span>
      return;
  
<span class="line-modified">!   ufuncs-&gt;immutable = true;</span>
  }
  
  /**
   * hb_unicode_funcs_is_immutable:
   * @ufuncs: Unicode functions.
<span class="line-new-header">--- 300,14 ---</span>
   * Since: 0.9.2
   **/
  void
  hb_unicode_funcs_make_immutable (hb_unicode_funcs_t *ufuncs)
  {
<span class="line-modified">!   if (hb_object_is_immutable (ufuncs))</span>
      return;
  
<span class="line-modified">!   hb_object_make_immutable (ufuncs);</span>
  }
  
  /**
   * hb_unicode_funcs_is_immutable:
   * @ufuncs: Unicode functions.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 322,11 ***</span>
   * Since: 0.9.2
   **/
  hb_bool_t
  hb_unicode_funcs_is_immutable (hb_unicode_funcs_t *ufuncs)
  {
<span class="line-modified">!   return ufuncs-&gt;immutable;</span>
  }
  
  /**
   * hb_unicode_funcs_get_parent:
   * @ufuncs: Unicode functions.
<span class="line-new-header">--- 319,11 ---</span>
   * Since: 0.9.2
   **/
  hb_bool_t
  hb_unicode_funcs_is_immutable (hb_unicode_funcs_t *ufuncs)
  {
<span class="line-modified">!   return hb_object_is_immutable (ufuncs);</span>
  }
  
  /**
   * hb_unicode_funcs_get_parent:
   * @ufuncs: Unicode functions.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 350,11 ***</span>
  hb_unicode_funcs_set_##name##_func (hb_unicode_funcs_t             *ufuncs,     \
                                      hb_unicode_##name##_func_t      func,       \
                                      void                           *user_data,  \
                                      hb_destroy_func_t               destroy)    \
  {                                                                               \
<span class="line-modified">!   if (ufuncs-&gt;immutable)                                                        \</span>
      return;                                                                     \
                                                                                  \
    if (ufuncs-&gt;destroy.name)                                                     \
      ufuncs-&gt;destroy.name (ufuncs-&gt;user_data.name);                              \
                                                                                  \
<span class="line-new-header">--- 347,11 ---</span>
  hb_unicode_funcs_set_##name##_func (hb_unicode_funcs_t             *ufuncs,     \
                                      hb_unicode_##name##_func_t      func,       \
                                      void                           *user_data,  \
                                      hb_destroy_func_t               destroy)    \
  {                                                                               \
<span class="line-modified">!   if (hb_object_is_immutable (ufuncs))                                          \</span>
      return;                                                                     \
                                                                                  \
    if (ufuncs-&gt;destroy.name)                                                     \
      ufuncs-&gt;destroy.name (ufuncs-&gt;user_data.name);                              \
                                                                                  \
</pre>
<hr />
<pre>
<span class="line-old-header">*** 437,21 ***</span>
   *
   *
   * Return value:
   *
   * Since: 0.9.2
   **/
  unsigned int
  hb_unicode_decompose_compatibility (hb_unicode_funcs_t *ufuncs,
                                      hb_codepoint_t      u,
                                      hb_codepoint_t     *decomposed)
  {
    return ufuncs-&gt;decompose_compatibility (u, decomposed);
  }
  
  
<span class="line-modified">! /* See hb-unicode-private.hh for details. */</span>
  const uint8_t
  _hb_modified_combining_class[256] =
  {
    0, /* HB_UNICODE_COMBINING_CLASS_NOT_REORDERED */
    1, /* HB_UNICODE_COMBINING_CLASS_OVERLAY */
<span class="line-new-header">--- 434,22 ---</span>
   *
   *
   * Return value:
   *
   * Since: 0.9.2
<span class="line-added">+  * Deprecated: 2.0.0</span>
   **/
  unsigned int
  hb_unicode_decompose_compatibility (hb_unicode_funcs_t *ufuncs,
                                      hb_codepoint_t      u,
                                      hb_codepoint_t     *decomposed)
  {
    return ufuncs-&gt;decompose_compatibility (u, decomposed);
  }
  
  
<span class="line-modified">! /* See hb-unicode.hh for details. */</span>
  const uint8_t
  _hb_modified_combining_class[256] =
  {
    0, /* HB_UNICODE_COMBINING_CLASS_NOT_REORDERED */
    1, /* HB_UNICODE_COMBINING_CLASS_OVERLAY */
</pre>
<hr />
<pre>
<span class="line-old-header">*** 559,5 ***</span>
<span class="line-new-header">--- 557,21 ---</span>
    235, 236, 237, 238, 239,
    240, /* HB_UNICODE_COMBINING_CLASS_IOTA_SUBSCRIPT */
    241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254,
    255, /* HB_UNICODE_COMBINING_CLASS_INVALID */
  };
<span class="line-added">+ </span>
<span class="line-added">+ </span>
<span class="line-added">+ /*</span>
<span class="line-added">+  * Emoji</span>
<span class="line-added">+  */</span>
<span class="line-added">+ </span>
<span class="line-added">+ #include &quot;hb-unicode-emoji-table.hh&quot;</span>
<span class="line-added">+ </span>
<span class="line-added">+ bool</span>
<span class="line-added">+ _hb_unicode_is_emoji_Extended_Pictographic (hb_codepoint_t cp)</span>
<span class="line-added">+ {</span>
<span class="line-added">+   return hb_bsearch (&amp;cp, _hb_unicode_emoji_Extended_Pictographic_table,</span>
<span class="line-added">+                      ARRAY_LENGTH (_hb_unicode_emoji_Extended_Pictographic_table),</span>
<span class="line-added">+                      sizeof (hb_unicode_range_t),</span>
<span class="line-added">+                      hb_unicode_range_t::cmp);</span>
<span class="line-added">+ }</span>
</pre>
<center><a href="hb-ucdn/ucdn.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="hb-unicode.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>