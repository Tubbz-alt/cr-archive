<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.desktop/share/native/libfontmanager/harfbuzz/hb-ot-var-hvar-table.hh</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="hb-ot-var-fvar-table.hh.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="hb-ot-var-mvar-table.hh.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfontmanager/harfbuzz/hb-ot-var-hvar-table.hh</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -25,23 +25,25 @@</span>
   */
  
  #ifndef HB_OT_VAR_HVAR_TABLE_HH
  #define HB_OT_VAR_HVAR_TABLE_HH
  
<span class="udiff-line-modified-removed">- #include &quot;hb-ot-layout-common-private.hh&quot;</span>
<span class="udiff-line-modified-added">+ #include &quot;hb-ot-layout-common.hh&quot;</span>
  
  
  namespace OT {
  
  
  struct DeltaSetIndexMap
  {
<span class="udiff-line-modified-removed">-   inline bool sanitize (hb_sanitize_context_t *c) const</span>
<span class="udiff-line-modified-added">+   bool sanitize (hb_sanitize_context_t *c) const</span>
    {
      TRACE_SANITIZE (this);
      return_trace (c-&gt;check_struct (this) &amp;&amp;
<span class="udiff-line-modified-removed">-                   c-&gt;check_array (mapData, get_width (), mapCount));</span>
<span class="udiff-line-modified-added">+                   c-&gt;check_range (mapDataZ.arrayZ,</span>
<span class="udiff-line-added">+                                   mapCount,</span>
<span class="udiff-line-added">+                                   get_width ()));</span>
    }
  
    unsigned int map (unsigned int v) const /* Returns 16.16 outer.inner. */
    {
      /* If count is zero, pass value unchanged.  This takes
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -53,11 +55,11 @@</span>
        v = mapCount - 1;
  
      unsigned int u = 0;
      { /* Fetch it. */
        unsigned int w = get_width ();
<span class="udiff-line-modified-removed">-       const HBUINT8 *p = mapData + w * v;</span>
<span class="udiff-line-modified-added">+       const HBUINT8 *p = mapDataZ.arrayZ + w * v;</span>
        for (; w; w--)
          u = (u &lt;&lt; 8) + *p++;
      }
  
      { /* Repack it. */
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -69,24 +71,23 @@</span>
  
      return u;
    }
  
    protected:
<span class="udiff-line-modified-removed">-   inline unsigned int get_width (void) const</span>
<span class="udiff-line-removed">-   { return ((format &gt;&gt; 4) &amp; 3) + 1; }</span>
<span class="udiff-line-modified-added">+   unsigned int get_width () const          { return ((format &gt;&gt; 4) &amp; 3) + 1; }</span>
  
<span class="udiff-line-modified-removed">-   inline unsigned int get_inner_bitcount (void) const</span>
<span class="udiff-line-removed">-   { return (format &amp; 0xF) + 1; }</span>
<span class="udiff-line-modified-added">+   unsigned int get_inner_bitcount () const { return (format &amp; 0xF) + 1; }</span>
  
    protected:
    HBUINT16      format;         /* A packed field that describes the compressed
                                   * representation of delta-set indices. */
    HBUINT16      mapCount;       /* The number of mapping entries. */
<span class="udiff-line-modified-removed">-   HBUINT8               mapData[VAR];   /* The delta-set index mapping data. */</span>
<span class="udiff-line-modified-added">+   UnsizedArrayOf&lt;HBUINT8&gt;</span>
<span class="udiff-line-added">+                 mapDataZ;       /* The delta-set index mapping data. */</span>
  
    public:
<span class="udiff-line-modified-removed">-   DEFINE_SIZE_ARRAY (4, mapData);</span>
<span class="udiff-line-modified-added">+   DEFINE_SIZE_ARRAY (4, mapDataZ);</span>
  };
  
  
  /*
   * HVAR -- Horizontal Metrics Variations
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -97,33 +98,32 @@</span>
  #define HB_OT_TAG_HVAR HB_TAG(&#39;H&#39;,&#39;V&#39;,&#39;A&#39;,&#39;R&#39;)
  #define HB_OT_TAG_VVAR HB_TAG(&#39;V&#39;,&#39;V&#39;,&#39;A&#39;,&#39;R&#39;)
  
  struct HVARVVAR
  {
<span class="udiff-line-modified-removed">-   static const hb_tag_t HVARTag = HB_OT_TAG_HVAR;</span>
<span class="udiff-line-modified-removed">-   static const hb_tag_t VVARTag = HB_OT_TAG_VVAR;</span>
<span class="udiff-line-modified-added">+   static constexpr hb_tag_t HVARTag = HB_OT_TAG_HVAR;</span>
<span class="udiff-line-modified-added">+   static constexpr hb_tag_t VVARTag = HB_OT_TAG_VVAR;</span>
  
<span class="udiff-line-modified-removed">-   inline bool sanitize (hb_sanitize_context_t *c) const</span>
<span class="udiff-line-modified-added">+   bool sanitize (hb_sanitize_context_t *c) const</span>
    {
      TRACE_SANITIZE (this);
      return_trace (version.sanitize (c) &amp;&amp;
                    likely (version.major == 1) &amp;&amp;
                    varStore.sanitize (c, this) &amp;&amp;
                    advMap.sanitize (c, this) &amp;&amp;
                    lsbMap.sanitize (c, this) &amp;&amp;
                    rsbMap.sanitize (c, this));
    }
  
<span class="udiff-line-modified-removed">-   inline float get_advance_var (hb_codepoint_t glyph,</span>
<span class="udiff-line-modified-removed">-                                 int *coords, unsigned int coord_count) const</span>
<span class="udiff-line-modified-added">+   float get_advance_var (hb_codepoint_t glyph,</span>
<span class="udiff-line-modified-added">+                          const int *coords, unsigned int coord_count) const</span>
    {
      unsigned int varidx = (this+advMap).map (glyph);
      return (this+varStore).get_delta (varidx, coords, coord_count);
    }
  
<span class="udiff-line-modified-removed">-   inline bool has_sidebearing_deltas (void) const</span>
<span class="udiff-line-removed">-   { return lsbMap &amp;&amp; rsbMap; }</span>
<span class="udiff-line-modified-added">+   bool has_sidebearing_deltas () const { return lsbMap &amp;&amp; rsbMap; }</span>
  
    protected:
    FixedVersion&lt;&gt;version;        /* Version of the metrics variation table
                                   * initially set to 0x00010000u */
    LOffsetTo&lt;VariationStore&gt;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -138,16 +138,16 @@</span>
    public:
    DEFINE_SIZE_STATIC (20);
  };
  
  struct HVAR : HVARVVAR {
<span class="udiff-line-modified-removed">-   static const hb_tag_t tableTag        = HB_OT_TAG_HVAR;</span>
<span class="udiff-line-modified-added">+   static constexpr hb_tag_t tableTag = HB_OT_TAG_HVAR;</span>
  };
  struct VVAR : HVARVVAR {
<span class="udiff-line-modified-removed">-   static const hb_tag_t tableTag        = HB_OT_TAG_VVAR;</span>
<span class="udiff-line-modified-added">+   static constexpr hb_tag_t tableTag = HB_OT_TAG_VVAR;</span>
  
<span class="udiff-line-modified-removed">-   inline bool sanitize (hb_sanitize_context_t *c) const</span>
<span class="udiff-line-modified-added">+   bool sanitize (hb_sanitize_context_t *c) const</span>
    {
      TRACE_SANITIZE (this);
      return_trace (static_cast&lt;const HVARVVAR *&gt; (this)-&gt;sanitize (c) &amp;&amp;
                    vorgMap.sanitize (c, this));
    }
</pre>
<center><a href="hb-ot-var-fvar-table.hh.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="hb-ot-var-mvar-table.hh.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>