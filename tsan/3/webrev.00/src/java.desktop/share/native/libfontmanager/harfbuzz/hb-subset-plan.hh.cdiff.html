<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/share/native/libfontmanager/harfbuzz/hb-subset-plan.hh</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="hb-subset-glyf.hh.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="hb-subset.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libfontmanager/harfbuzz/hb-subset-plan.hh</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 25,82 ***</span>
   */
  
  #ifndef HB_SUBSET_PLAN_HH
  #define HB_SUBSET_PLAN_HH
  
<span class="line-modified">! #include &quot;hb-private.hh&quot;</span>
  
  #include &quot;hb-subset.h&quot;
<span class="line-modified">! #include &quot;hb-subset-private.hh&quot;</span>
  
<span class="line-modified">! #include &quot;hb-object-private.hh&quot;</span>
<span class="line-removed">- #include &quot;hb-map-private.hh&quot;</span>
  
  struct hb_subset_plan_t
  {
    hb_object_header_t header;
<span class="line-removed">-   ASSERT_POD ();</span>
  
<span class="line-modified">!   hb_bool_t drop_hints;</span>
<span class="line-modified">!   hb_bool_t drop_ot_layout;</span>
  
    // For each cp that we&#39;d like to retain maps to the corresponding gid.
    hb_set_t *unicodes;
  
<span class="line-removed">-   // This list contains the complete set of glyphs to retain and may contain</span>
<span class="line-removed">-   // more glyphs then the lists above.</span>
    hb_vector_t&lt;hb_codepoint_t&gt; glyphs;
  
    hb_map_t *codepoint_to_glyph;
    hb_map_t *glyph_map;
  
    // Plan is only good for a specific source/dest so keep them with it
    hb_face_t *source;
    hb_face_t *dest;
  
<span class="line-modified">!   inline hb_bool_t</span>
<span class="line-modified">!   new_gid_for_codepoint (hb_codepoint_t codepoint,</span>
<span class="line-removed">-                          hb_codepoint_t *new_gid) const</span>
    {
      hb_codepoint_t old_gid = codepoint_to_glyph-&gt;get (codepoint);
      if (old_gid == HB_MAP_VALUE_INVALID)
        return false;
  
      return new_gid_for_old_gid (old_gid, new_gid);
    }
  
<span class="line-modified">!   inline hb_bool_t</span>
<span class="line-modified">!   new_gid_for_old_gid (hb_codepoint_t old_gid,</span>
<span class="line-removed">-                       hb_codepoint_t *new_gid) const</span>
    {
      hb_codepoint_t gid = glyph_map-&gt;get (old_gid);
      if (gid == HB_MAP_VALUE_INVALID)
        return false;
  
      *new_gid = gid;
      return true;
    }
  
<span class="line-modified">!   inline hb_bool_t</span>
    add_table (hb_tag_t tag,
               hb_blob_t *contents)
    {
      hb_blob_t *source_blob = source-&gt;reference_table (tag);
      DEBUG_MSG(SUBSET, nullptr, &quot;add table %c%c%c%c, dest %d bytes, source %d bytes&quot;,
                HB_UNTAG(tag),
                hb_blob_get_length (contents),
                hb_blob_get_length (source_blob));
      hb_blob_destroy (source_blob);
<span class="line-modified">!     return hb_subset_face_add_table(dest, tag, contents);</span>
    }
  };
  
  typedef struct hb_subset_plan_t hb_subset_plan_t;
  
  HB_INTERNAL hb_subset_plan_t *
  hb_subset_plan_create (hb_face_t           *face,
<span class="line-removed">-                        hb_subset_profile_t *profile,</span>
                         hb_subset_input_t   *input);
  
  HB_INTERNAL void
  hb_subset_plan_destroy (hb_subset_plan_t *plan);
  
<span class="line-new-header">--- 25,77 ---</span>
   */
  
  #ifndef HB_SUBSET_PLAN_HH
  #define HB_SUBSET_PLAN_HH
  
<span class="line-modified">! #include &quot;hb.hh&quot;</span>
  
  #include &quot;hb-subset.h&quot;
<span class="line-modified">! #include &quot;hb-subset-input.hh&quot;</span>
  
<span class="line-modified">! #include &quot;hb-map.hh&quot;</span>
  
  struct hb_subset_plan_t
  {
    hb_object_header_t header;
  
<span class="line-modified">!   bool drop_hints : 1;</span>
<span class="line-modified">!   bool drop_layout : 1;</span>
<span class="line-added">+   bool desubroutinize : 1;</span>
  
    // For each cp that we&#39;d like to retain maps to the corresponding gid.
    hb_set_t *unicodes;
  
    hb_vector_t&lt;hb_codepoint_t&gt; glyphs;
<span class="line-added">+   hb_set_t *glyphset;</span>
  
    hb_map_t *codepoint_to_glyph;
    hb_map_t *glyph_map;
  
    // Plan is only good for a specific source/dest so keep them with it
    hb_face_t *source;
    hb_face_t *dest;
  
<span class="line-modified">!   bool new_gid_for_codepoint (hb_codepoint_t codepoint,</span>
<span class="line-modified">!                               hb_codepoint_t *new_gid) const</span>
    {
      hb_codepoint_t old_gid = codepoint_to_glyph-&gt;get (codepoint);
      if (old_gid == HB_MAP_VALUE_INVALID)
        return false;
  
      return new_gid_for_old_gid (old_gid, new_gid);
    }
  
<span class="line-modified">!   bool new_gid_for_old_gid (hb_codepoint_t old_gid,</span>
<span class="line-modified">!                             hb_codepoint_t *new_gid) const</span>
    {
      hb_codepoint_t gid = glyph_map-&gt;get (old_gid);
      if (gid == HB_MAP_VALUE_INVALID)
        return false;
  
      *new_gid = gid;
      return true;
    }
  
<span class="line-modified">!   bool</span>
    add_table (hb_tag_t tag,
               hb_blob_t *contents)
    {
      hb_blob_t *source_blob = source-&gt;reference_table (tag);
      DEBUG_MSG(SUBSET, nullptr, &quot;add table %c%c%c%c, dest %d bytes, source %d bytes&quot;,
                HB_UNTAG(tag),
                hb_blob_get_length (contents),
                hb_blob_get_length (source_blob));
      hb_blob_destroy (source_blob);
<span class="line-modified">!     return hb_face_builder_add_table (dest, tag, contents);</span>
    }
  };
  
  typedef struct hb_subset_plan_t hb_subset_plan_t;
  
  HB_INTERNAL hb_subset_plan_t *
  hb_subset_plan_create (hb_face_t           *face,
                         hb_subset_input_t   *input);
  
  HB_INTERNAL void
  hb_subset_plan_destroy (hb_subset_plan_t *plan);
  
</pre>
<center><a href="hb-subset-glyf.hh.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="hb-subset.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>