<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.desktop/share/classes/sun/swing/SwingUtilities2.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="MenuItemLayoutHelper.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="plaf/synth/SynthFileChooserUI.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/classes/sun/swing/SwingUtilities2.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2002, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2002, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -380,11 +380,11 @@</span>
       * @param string String to get the width of
       * @param useFPAPI use floating point API
       */
      public static float stringWidth(JComponent c, FontMetrics fm, String string,
              boolean useFPAPI){
<span class="udiff-line-modified-removed">-         if (string == null || string.equals(&quot;&quot;)) {</span>
<span class="udiff-line-modified-added">+         if (string == null || string.isEmpty()) {</span>
              return 0;
          }
          boolean needsTextLayout = ((c != null) &amp;&amp;
                  (c.getClientProperty(TextAttribute.NUMERIC_SHAPING) != null));
          if (needsTextLayout) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -413,11 +413,11 @@</span>
       * @return Clipped string that can fit in the provided space.
       */
      public static String clipStringIfNecessary(JComponent c, FontMetrics fm,
                                                 String string,
                                                 int availTextWidth) {
<span class="udiff-line-modified-removed">-         if ((string == null) || (string.equals(&quot;&quot;)))  {</span>
<span class="udiff-line-modified-added">+         if (string == null || string.isEmpty())  {</span>
              return &quot;&quot;;
          }
          int textWidth = SwingUtilities2.stringWidth(c, fm, string);
          if (textWidth &gt; availTextWidth) {
              return SwingUtilities2.clipString(c, fm, string, availTextWidth);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -522,15 +522,19 @@</span>
                   * more evenly than directly laying out to the screen advances.
                   */
                  String trimmedText = trimTrailingSpaces(text);
                  if (!trimmedText.isEmpty()) {
                      float screenWidth = (float) g2d.getFont().getStringBounds
<span class="udiff-line-modified-removed">-                             (trimmedText, DEFAULT_FRC).getWidth();</span>
<span class="udiff-line-modified-added">+                             (trimmedText, getFontRenderContext(c)).getWidth();</span>
                      TextLayout layout = createTextLayout(c, text, g2d.getFont(),
                                                         g2d.getFontRenderContext());
  
<span class="udiff-line-modified-removed">-                     layout = layout.getJustifiedLayout(screenWidth);</span>
<span class="udiff-line-modified-added">+                     // If text fits the screenWidth, then do not need to justify</span>
<span class="udiff-line-added">+                     if (SwingUtilities2.stringWidth(c, g2d.getFontMetrics(),</span>
<span class="udiff-line-added">+                                             trimmedText) &gt; screenWidth) {</span>
<span class="udiff-line-added">+                         layout = layout.getJustifiedLayout(screenWidth);</span>
<span class="udiff-line-added">+                     }</span>
                      /* Use alternate print color if specified */
                      Color col = g2d.getColor();
                      if (col instanceof PrintColorUIResource) {
                          g2d.setColor(((PrintColorUIResource)col).getPrintColor());
                      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -675,12 +679,16 @@</span>
                      TextLayout layout =
                          createTextLayout(c, text, g2d.getFont(),
                                         g2d.getFontRenderContext());
                      if (isPrinting) {
                          float screenWidth = (float)g2d.getFont().
<span class="udiff-line-modified-removed">-                             getStringBounds(text, DEFAULT_FRC).getWidth();</span>
<span class="udiff-line-modified-removed">-                         layout = layout.getJustifiedLayout(screenWidth);</span>
<span class="udiff-line-modified-added">+                             getStringBounds(text, getFontRenderContext(c)).getWidth();</span>
<span class="udiff-line-modified-added">+                         // If text fits the screenWidth, then do not need to justify</span>
<span class="udiff-line-added">+                         if (SwingUtilities2.stringWidth(c, g2d.getFontMetrics(),</span>
<span class="udiff-line-added">+                                                         text) &gt; screenWidth) {</span>
<span class="udiff-line-added">+                             layout = layout.getJustifiedLayout(screenWidth);</span>
<span class="udiff-line-added">+                         }</span>
                      }
                      TextHitInfo leading =
                          TextHitInfo.leading(underlinedIndex);
                      TextHitInfo trailing =
                          TextHitInfo.trailing(underlinedIndex);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -861,11 +869,15 @@</span>
                                      deviceFontRenderContext);
                      String trimmedText = trimTrailingSpaces(text);
                      if (!trimmedText.isEmpty()) {
                          float screenWidth = (float)g2d.getFont().
                              getStringBounds(trimmedText, frc).getWidth();
<span class="udiff-line-modified-removed">-                         layout = layout.getJustifiedLayout(screenWidth);</span>
<span class="udiff-line-modified-added">+                         // If text fits the screenWidth, then do not need to justify</span>
<span class="udiff-line-added">+                         if (SwingUtilities2.stringWidth(c, g2d.getFontMetrics(),</span>
<span class="udiff-line-added">+                                                 trimmedText) &gt; screenWidth) {</span>
<span class="udiff-line-added">+                             layout = layout.getJustifiedLayout(screenWidth);</span>
<span class="udiff-line-added">+                         }</span>
  
                          /* Use alternate print color if specified */
                          Color col = g2d.getColor();
                          if (col instanceof PrintColorUIResource) {
                              g2d.setColor(((PrintColorUIResource)col).getPrintColor());
</pre>
<center><a href="MenuItemLayoutHelper.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="plaf/synth/SynthFileChooserUI.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>