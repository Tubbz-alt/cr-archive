<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/classes/sun/font/FileFont.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="CMap.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="FileFontStrike.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/classes/sun/font/FileFont.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
155      * map they are held in via a boolean flag
156      * Since this isn&#39;t expected to be anything other than an extremely
157      * rare maybe it is not worth doing this last part.
158      */
159     synchronized void deregisterFontAndClearStrikeCache() {
160         SunFontManager fm = SunFontManager.getInstance();
161         fm.deRegisterBadFont(this);
162 
163         for (Reference&lt;FontStrike&gt; strikeRef : strikeCache.values()) {
164             if (strikeRef != null) {
165                 /* NB we know these are all FileFontStrike instances
166                  * because the cache is on this FileFont
167                  */
168                 FileFontStrike strike = (FileFontStrike)strikeRef.get();
169                 if (strike != null &amp;&amp; strike.pScalerContext != 0L) {
170                     scaler.invalidateScalerContext(strike.pScalerContext);
171                 }
172             }
173         }
174         if (scaler != null) {
<span class="line-modified">175             scaler.dispose();</span>
176         }
177         scaler = FontScaler.getNullScaler();
178     }
179 
180     StrikeMetrics getFontMetrics(long pScalerContext) {
181         try {
182             return getScaler().getFontMetrics(pScalerContext);
183         } catch (FontScalerException fe) {
184             scaler = FontScaler.getNullScaler();
185             return getFontMetrics(pScalerContext);
186         }
187     }
188 
189     float getGlyphAdvance(long pScalerContext, int glyphCode) {
190         try {
191             return getScaler().getGlyphAdvance(pScalerContext, glyphCode);
192         } catch (FontScalerException fe) {
193             scaler = FontScaler.getNullScaler();
194             return getGlyphAdvance(pScalerContext, glyphCode);
195         }
</pre>
</td>
<td>
<hr />
<pre>
155      * map they are held in via a boolean flag
156      * Since this isn&#39;t expected to be anything other than an extremely
157      * rare maybe it is not worth doing this last part.
158      */
159     synchronized void deregisterFontAndClearStrikeCache() {
160         SunFontManager fm = SunFontManager.getInstance();
161         fm.deRegisterBadFont(this);
162 
163         for (Reference&lt;FontStrike&gt; strikeRef : strikeCache.values()) {
164             if (strikeRef != null) {
165                 /* NB we know these are all FileFontStrike instances
166                  * because the cache is on this FileFont
167                  */
168                 FileFontStrike strike = (FileFontStrike)strikeRef.get();
169                 if (strike != null &amp;&amp; strike.pScalerContext != 0L) {
170                     scaler.invalidateScalerContext(strike.pScalerContext);
171                 }
172             }
173         }
174         if (scaler != null) {
<span class="line-modified">175             scaler.disposeScaler();</span>
176         }
177         scaler = FontScaler.getNullScaler();
178     }
179 
180     StrikeMetrics getFontMetrics(long pScalerContext) {
181         try {
182             return getScaler().getFontMetrics(pScalerContext);
183         } catch (FontScalerException fe) {
184             scaler = FontScaler.getNullScaler();
185             return getFontMetrics(pScalerContext);
186         }
187     }
188 
189     float getGlyphAdvance(long pScalerContext, int glyphCode) {
190         try {
191             return getScaler().getGlyphAdvance(pScalerContext, glyphCode);
192         } catch (FontScalerException fe) {
193             scaler = FontScaler.getNullScaler();
194             return getGlyphAdvance(pScalerContext, glyphCode);
195         }
</pre>
</td>
</tr>
</table>
<center><a href="CMap.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="FileFontStrike.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>