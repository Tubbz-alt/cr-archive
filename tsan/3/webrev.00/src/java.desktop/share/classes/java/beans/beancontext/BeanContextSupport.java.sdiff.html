<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/classes/java/beans/beancontext/BeanContextSupport.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="BeanContextServicesSupport.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../javax/accessibility/AccessibleBundle.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/classes/java/beans/beancontext/BeanContextSupport.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 1997, 2014, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 321             super();
 322 
 323             child     = bcc;
 324             proxyPeer = peer;
 325         }
 326 
 327         Object  getChild()                  { return child; }
 328 
 329         void    setRemovePending(boolean v) { removePending = v; }
 330 
 331         boolean isRemovePending()           { return removePending; }
 332 
 333         boolean isProxyPeer()               { return proxyPeer != null; }
 334 
 335         Object  getProxyPeer()              { return proxyPeer; }
 336         /*
 337          * fields
 338          */
 339 
 340 

 341         private           Object   child;

 342         private           Object   proxyPeer;
 343 
 344         private transient boolean  removePending;
 345     }
 346 
 347     /**
 348      * &lt;p&gt;
 349      * Subclasses can override this method to insert their own subclass
 350      * of Child without having to override add() or the other Collection
 351      * methods that add children to the set.
 352      * &lt;/p&gt;
 353      * @param targetChild the child to create the Child on behalf of
 354      * @param peer        the peer if the tragetChild and the peer are related by an implementation of BeanContextProxy
 355      * @return Subtype-specific subclass of Child without overriding collection methods
 356      */
 357 
 358     protected BCSChild createBCSChild(Object targetChild, Object peer) {
 359         return new BCSChild(targetChild, peer);
 360     }
 361 
</pre>
<hr />
<pre>
1013                 serialize(oos, (Collection)bcmListeners);
1014             } finally {
1015                 serializing = false;
1016             }
1017         }
1018     }
1019 
1020     /**
1021      * When an instance of this class is used as a delegate for the
1022      * implementation of the BeanContext protocols (and its subprotocols)
1023      * there exists a &#39;chicken and egg&#39; problem during deserialization
1024      * @param ois the ObjectInputStream to use
1025      * @throws IOException if deserialization failed
1026      * @throws ClassNotFoundException if needed classes are not found
1027      */
1028 
1029     public final void readChildren(ObjectInputStream ois) throws IOException, ClassNotFoundException {
1030         int count = serializable;
1031 
1032         while (count-- &gt; 0) {
<span class="line-modified">1033             Object                      child = null;</span>
<span class="line-modified">1034             BeanContextSupport.BCSChild bscc  = null;</span>
<span class="line-removed">1035 </span>
<span class="line-removed">1036             try {</span>
<span class="line-removed">1037                 child = ois.readObject();</span>
<span class="line-removed">1038                 bscc  = (BeanContextSupport.BCSChild)ois.readObject();</span>
<span class="line-removed">1039             } catch (IOException ioe) {</span>
<span class="line-removed">1040                 continue;</span>
<span class="line-removed">1041             } catch (ClassNotFoundException cnfe) {</span>
<span class="line-removed">1042                 continue;</span>
<span class="line-removed">1043             }</span>
<span class="line-removed">1044 </span>
1045 
1046             synchronized(child) {
1047                 BeanContextChild bcc = null;
1048 
1049                 try {
1050                     bcc = (BeanContextChild)child;
1051                 } catch (ClassCastException cce) {
1052                     // do nothing;
1053                 }
1054 
1055                 if (bcc != null) {
1056                     try {
1057                         bcc.setBeanContext(getBeanContextPeer());
1058 
1059                        bcc.addPropertyChangeListener(&quot;beanContext&quot;, childPCL);
1060                        bcc.addVetoableChangeListener(&quot;beanContext&quot;, childVCL);
1061 
1062                     } catch (PropertyVetoException pve) {
1063                         continue;
1064                     }
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 321             super();
 322 
 323             child     = bcc;
 324             proxyPeer = peer;
 325         }
 326 
 327         Object  getChild()                  { return child; }
 328 
 329         void    setRemovePending(boolean v) { removePending = v; }
 330 
 331         boolean isRemovePending()           { return removePending; }
 332 
 333         boolean isProxyPeer()               { return proxyPeer != null; }
 334 
 335         Object  getProxyPeer()              { return proxyPeer; }
 336         /*
 337          * fields
 338          */
 339 
 340 
<span class="line-added"> 341         @SuppressWarnings(&quot;serial&quot;) // Not statically typed as Serializable</span>
 342         private           Object   child;
<span class="line-added"> 343         @SuppressWarnings(&quot;serial&quot;) // Not statically typed as Serializable</span>
 344         private           Object   proxyPeer;
 345 
 346         private transient boolean  removePending;
 347     }
 348 
 349     /**
 350      * &lt;p&gt;
 351      * Subclasses can override this method to insert their own subclass
 352      * of Child without having to override add() or the other Collection
 353      * methods that add children to the set.
 354      * &lt;/p&gt;
 355      * @param targetChild the child to create the Child on behalf of
 356      * @param peer        the peer if the tragetChild and the peer are related by an implementation of BeanContextProxy
 357      * @return Subtype-specific subclass of Child without overriding collection methods
 358      */
 359 
 360     protected BCSChild createBCSChild(Object targetChild, Object peer) {
 361         return new BCSChild(targetChild, peer);
 362     }
 363 
</pre>
<hr />
<pre>
1015                 serialize(oos, (Collection)bcmListeners);
1016             } finally {
1017                 serializing = false;
1018             }
1019         }
1020     }
1021 
1022     /**
1023      * When an instance of this class is used as a delegate for the
1024      * implementation of the BeanContext protocols (and its subprotocols)
1025      * there exists a &#39;chicken and egg&#39; problem during deserialization
1026      * @param ois the ObjectInputStream to use
1027      * @throws IOException if deserialization failed
1028      * @throws ClassNotFoundException if needed classes are not found
1029      */
1030 
1031     public final void readChildren(ObjectInputStream ois) throws IOException, ClassNotFoundException {
1032         int count = serializable;
1033 
1034         while (count-- &gt; 0) {
<span class="line-modified">1035             Object child = ois.readObject();</span>
<span class="line-modified">1036             BCSChild bscc = (BCSChild) ois.readObject();</span>










1037 
1038             synchronized(child) {
1039                 BeanContextChild bcc = null;
1040 
1041                 try {
1042                     bcc = (BeanContextChild)child;
1043                 } catch (ClassCastException cce) {
1044                     // do nothing;
1045                 }
1046 
1047                 if (bcc != null) {
1048                     try {
1049                         bcc.setBeanContext(getBeanContextPeer());
1050 
1051                        bcc.addPropertyChangeListener(&quot;beanContext&quot;, childPCL);
1052                        bcc.addVetoableChangeListener(&quot;beanContext&quot;, childVCL);
1053 
1054                     } catch (PropertyVetoException pve) {
1055                         continue;
1056                     }
</pre>
</td>
</tr>
</table>
<center><a href="BeanContextServicesSupport.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../javax/accessibility/AccessibleBundle.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>