<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.desktop/share/classes/javax/accessibility/AccessibleBundle.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../java/beans/beancontext/BeanContextSupport.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="package-info.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/classes/javax/accessibility/AccessibleBundle.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 1997, 2017, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -23,12 +23,10 @@</span>
   * questions.
   */
  
  package javax.accessibility;
  
<span class="udiff-line-removed">- import java.util.Enumeration;</span>
<span class="udiff-line-removed">- import java.util.Hashtable;</span>
  import java.util.Locale;
  import java.util.MissingResourceException;
  import java.util.ResourceBundle;
  
  import sun.awt.AWTAccessor;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -48,12 +46,10 @@</span>
   * @see AccessibleRole
   * @see AccessibleState
   */
  public abstract class AccessibleBundle {
  
<span class="udiff-line-removed">-     private static Hashtable&lt;Locale, Hashtable&lt;String, Object&gt;&gt; table = new Hashtable&lt;&gt;();</span>
<span class="udiff-line-removed">- </span>
      private final String defaultResourceBundleName
          = &quot;com.sun.accessibility.internal.resources.accessibility&quot;;
  
      static {
          AWTAccessor.setAccessibleBundleAccessor(
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -85,30 +81,20 @@</span>
       * found for the key, the locale independent key stored in the role will be
       * returned. This method is intended to be used only by subclasses so that
       * they can specify their own resource bundles which contain localized
       * strings for their keys.
       *
<span class="udiff-line-modified-removed">-      * @param  resourceBundleName the name of the resource bundle to use for</span>
<span class="udiff-line-removed">-      *         lookup</span>
<span class="udiff-line-modified-added">+      * @param  name the name of the resource bundle to use for lookup</span>
       * @param  locale the locale for which to obtain a localized string
       * @return a localized string for the key
       */
<span class="udiff-line-modified-removed">-     protected String toDisplayString(String resourceBundleName,</span>
<span class="udiff-line-modified-removed">-                                      Locale locale) {</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-         // loads the resource bundle if necessary</span>
<span class="udiff-line-modified-removed">-         loadResourceBundle(resourceBundleName, locale);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // returns the localized string</span>
<span class="udiff-line-removed">-         Hashtable&lt;String, Object&gt; ht = table.get(locale);</span>
<span class="udiff-line-removed">-         if (ht != null) {</span>
<span class="udiff-line-removed">-             Object o = ht.get(key);</span>
<span class="udiff-line-removed">-             if (o != null &amp;&amp; o instanceof String) {</span>
<span class="udiff-line-removed">-                 return (String)o;</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-modified-added">+     protected String toDisplayString(final String name, final Locale locale) {</span>
<span class="udiff-line-modified-added">+         try {</span>
<span class="udiff-line-modified-added">+             return ResourceBundle.getBundle(name, locale).getString(key);</span>
<span class="udiff-line-modified-added">+         } catch (ClassCastException | MissingResourceException ignored) {</span>
<span class="udiff-line-modified-added">+             return key; // return the non-localized key</span>
          }
<span class="udiff-line-removed">-         return key;</span>
      }
  
      /**
       * Obtains the key as a localized string. If a localized string cannot be
       * found for the key, the locale independent key stored in the role will be
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -137,35 +123,6 @@</span>
       * @see #toDisplayString
       */
      public String toString() {
          return toDisplayString();
      }
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     /**</span>
<span class="udiff-line-removed">-      * Loads the Accessibility resource bundle if necessary.</span>
<span class="udiff-line-removed">-      */</span>
<span class="udiff-line-removed">-     private void loadResourceBundle(String resourceBundleName,</span>
<span class="udiff-line-removed">-                                     Locale locale) {</span>
<span class="udiff-line-removed">-         if (! table.containsKey(locale)) {</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             try {</span>
<span class="udiff-line-removed">-                 Hashtable&lt;String, Object&gt; resourceTable = new Hashtable&lt;&gt;();</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-                 ResourceBundle bundle = ResourceBundle.getBundle(resourceBundleName, locale);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-                 Enumeration&lt;String&gt; iter = bundle.getKeys();</span>
<span class="udiff-line-removed">-                 while(iter.hasMoreElements()) {</span>
<span class="udiff-line-removed">-                     String key = iter.nextElement();</span>
<span class="udiff-line-removed">-                     resourceTable.put(key, bundle.getObject(key));</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-                 table.put(locale, resourceTable);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-             catch (MissingResourceException e) {</span>
<span class="udiff-line-removed">-                 System.err.println(&quot;loadResourceBundle: &quot; + e);</span>
<span class="udiff-line-removed">-                 // Just return so toDisplayString() returns the</span>
<span class="udiff-line-removed">-                 // non-localized key.</span>
<span class="udiff-line-removed">-                 return;</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-     }</span>
  }
</pre>
<center><a href="../../java/beans/beancontext/BeanContextSupport.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="package-info.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>