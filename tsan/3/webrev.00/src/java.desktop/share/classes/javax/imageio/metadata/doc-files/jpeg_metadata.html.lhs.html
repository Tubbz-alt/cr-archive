<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.desktop/share/classes/javax/imageio/metadata/doc-files/jpeg_metadata.html</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>   1 &lt;!doctype html&gt;
   2 &lt;html lang=&quot;en&quot;&gt;
   3 &lt;head&gt;
   4   &lt;meta charset=&quot;utf-8&quot;/&gt;
   5   &lt;title&gt;JPEG Metadata Format Specification and Usage Notes&lt;/title&gt;
   6 &lt;/head&gt;
   7 &lt;!--
<a name="1" id="anc1"></a><span class="line-modified">   8 Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   9 DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  10 
  11 This code is free software; you can redistribute it and/or modify it
  12 under the terms of the GNU General Public License version 2 only, as
  13 published by the Free Software Foundation.  Oracle designates this
  14 particular file as subject to the &quot;Classpath&quot; exception as provided
  15 by Oracle in the LICENSE file that accompanied this code.
  16 
  17 This code is distributed in the hope that it will be useful, but WITHOUT
  18 ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  19 FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  20 version 2 for more details (a copy is included in the LICENSE file that
  21 accompanied this code).
  22 
  23 You should have received a copy of the GNU General Public License version
  24 2 along with this work; if not, write to the Free Software Foundation,
  25 Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  26 
  27 Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  28 or visit www.oracle.com if you need additional information or have any
  29 questions.
  30 --&gt;
  31 
  32 &lt;body&gt;
  33 &lt;main role=&quot;main&quot;&gt;
<a name="2" id="anc2"></a>
  34 &lt;h1&gt;JPEG Metadata Format Specification and Usage Notes&lt;/h1&gt;
  35 
  36 &lt;p&gt;
  37 &lt;a href=#metadata&gt;JPEG Metadata&lt;/a&gt;&lt;br&gt;
  38 &lt;a href=#abbrev&gt;Abbreviated Streams&lt;/a&gt;&lt;br&gt;
  39 &lt;a href=#tables&gt;Sources of Tables&lt;/a&gt;&lt;br&gt;
  40 &lt;a href=#color&gt;Colorspace Transformations and Conventional Markers&lt;/a&gt;&lt;br&gt;
  41 &lt;a href=#thumbs&gt;Thumbnail Images&lt;/a&gt;&lt;br&gt;
  42 &lt;a href=#prog&gt;Progressive Encoding&lt;/a&gt;&lt;br&gt;
  43 &lt;a href=#tree&gt;Native Metadata Format Tree Structure and Editing&lt;/a&gt;&lt;br&gt;
  44 &lt;a href=#image&gt;Image Metadata DTD&lt;/a&gt;&lt;br&gt;
  45 &lt;a href=#stream&gt;Stream Metadata DTD&lt;/a&gt;
  46 &lt;p&gt;
  47 &lt;b&gt;NOTE&lt;/b&gt;: It is important to call &lt;code&gt;dispose()&lt;/code&gt;
  48 on the JPEG reader and writer objects when they are no longer needed, as
  49 they consume significant native resources which are not adequately recovered
  50 by garbage collection.  Both reader and writer call &lt;code&gt;dispose()&lt;/code&gt;
  51 in their finalizers, but those finalizers may not be called before the native
  52 code has exhausted native memory.
  53 
  54 &lt;p&gt;
  55 
  56 The JPEG writer does not support replacing pixels.
  57 
  58 &lt;h2&gt;
  59 &lt;a id=metadata&gt;JPEG Metadata&lt;/a&gt;
  60 &lt;/h2&gt;
  61 JPEG metadata consists of the data contained in marker segments in a JPEG
  62 stream.  The image metadata object returned from a read describes the
  63 contents of the marker segments between the &lt;code&gt;SOI&lt;/code&gt; marker and
  64 the &lt;code&gt;EOI&lt;/code&gt; marker for that image.  The image metadata object
  65 passed into a write determines the contents of the stream between the
  66 &lt;code&gt;SOI&lt;/code&gt; marker and the &lt;code&gt;EOI&lt;/code&gt; marker for that image,
  67 subject to the controls in any &lt;code&gt;ImageWriteParam&lt;/code&gt;.
  68 
  69 &lt;p&gt;
  70 Stream metadata is used only for tables-only images found (or to be
  71 placed) at the beginning of a stream containing abbreviated images.
  72 Tables-only images are not treated as images and do not consume an
  73 image index.  The stream metadata object returned from a read describes the
  74 contents of the marker segments between the &lt;code&gt;SOI&lt;/code&gt; marker and
  75 the &lt;code&gt;EOI&lt;/code&gt; marker for the single tables-only image at the
  76 beginning of the stream, if one is present.  If no tables-only image is
  77 present at the front of the stream, the &lt;code&gt;getStreamMetadata&lt;/code&gt;
  78 method of &lt;code&gt;ImageReader&lt;/code&gt; returns &lt;code&gt;null&lt;/code&gt;.  If
  79 stream metadata is provided to the writer, a single tables-only image
  80 containing the tables from the stream metadata object will be written at
  81 the beginning of the stream.  If the stream metadata object contains no
  82 tables, default tables will be written.  As the sole purpose of stream
  83 metadata is for specifying tables-only images at the front of abbreviated
  84 streams, the stream metadata argument is useful only on the
  85 &lt;code&gt;ImageWriter.prepareWriteSequence&lt;/code&gt; method.  It is ignored on all
  86 other methods.
  87 
  88 &lt;p&gt;
  89 The &lt;code&gt;ImageWriter.getDefaultStreamMetadata&lt;/code&gt; method returns an
  90 object containing the tables from the &lt;code&gt;ImageWriteParam&lt;/code&gt; argument,
  91 if it is a &lt;code&gt;JPEGImageWriteParam&lt;/code&gt; and contains tables.  Otherwise,
  92 the returned object will contain default tables.
  93 
  94 &lt;p&gt;The &lt;code&gt;ImageWriter.getDefaultImageMetadata&lt;/code&gt; method returns a
  95 metadata object containing &lt;b&gt;no&lt;/b&gt; tables if the
  96 &lt;code&gt;ImageWriteParam&lt;/code&gt; argument contains tables.  Otherwise the
  97 returned metadata object will contain default visually lossless tables.
  98 Of course, only a &lt;code&gt;JPEGImageWriteParam&lt;/code&gt; may contain tables.
  99 
 100 &lt;p&gt;
 101 If &lt;code&gt;ignoreMetadata&lt;/code&gt; is set to &lt;code&gt;true&lt;/code&gt; when the input
 102 is set on the reader, stream metadata will not be available, but image
 103 metadata will.
 104 
 105 &lt;h2&gt;
 106 &lt;a id=abbrev&gt;Abbreviated Streams&lt;/a&gt;
 107 &lt;/h2&gt;
 108 Both the reader and the writer retain their tables from one operation to the
 109 next, thus permitting the use of abbreviated streams quite naturally, with a
 110 few minor restrictions:
 111 &lt;ol&gt;
 112   &lt;li&gt; Abbreviated streams may contain only one tables-only image, which must
 113        come first in the stream.  Subsequent tables-only images will cause
 114        undefined behavior.&lt;/li&gt;
 115   &lt;li&gt; Abbreviated streams must be read fully and in order.  No random access
 116        is allowed, in either direction.  The same image may be read multiple
 117        times.  If a call is made with an image index that is not the same as
 118        or one greater than the most recent call (or 0 if no calls have been
 119        made), then an &lt;code&gt;IllegalArgumentException&lt;/code&gt; is thrown.&lt;/li&gt;
 120 &lt;/ol&gt;
 121 These restrictions mean that streams may contain abbreviated images
 122 interspersed with images containing tables.  As required by JPEG, any tables
 123 appearing in the stream override previous tables, regardless of the source
 124 of the previous tables.
 125 
 126 &lt;p&gt;
 127 Note that once a tables-only image has been read, it&#39;s contents is available
 128 as stream metadata from the reader until either another tables-only image
 129 is read from another stream or the reader is reset.  Changing the input does
 130 not reset the stream metadata.  This is useful for reading the tables from
 131 one file, then changing the input to read an abbreviated stream containing
 132 a sequence of images.  The tables will be used automatically, and will remain
 133 available as &quot;stream&quot; metadata.
 134 
 135 &lt;p&gt;
 136 Abbreviated streams are written using the sequence methods of
 137 &lt;code&gt;ImageWriter&lt;/code&gt;.  Stream metadata is used to write a tables-only
 138 image at the beginning of the stream, and the tables are set up for use, using
 139 &lt;code&gt;ImageWriter.prepareWriteSequence&lt;/code&gt;.  If no stream metadata is
 140 supplied to &lt;code&gt;ImageWriter.prepareWriteSequence&lt;/code&gt;, then no
 141 tables-only image is written.  If stream metadata containing no tables is
 142 supplied to &lt;code&gt;ImageWriter.prepareWriteSequence&lt;/code&gt;, then a tables-only
 143 image containing default visually lossless tables is written.
 144 
 145 &lt;h2&gt;
 146 &lt;a id=tables&gt;Sources of Tables&lt;/a&gt;
 147 &lt;/h2&gt;
 148 &lt;p&gt;
 149 Images are written with tables if tables are present in their metadata objects
 150 or without them if no tables are present in their metadata objects.  If no
 151 metadata object is present then the tables are written.  The tables used for
 152 compression are taken from one of the following sources, which are consulted
 153 in order:
 154 &lt;ol&gt;
 155   &lt;li&gt; If there is an &lt;code&gt;ImageWriteParam&lt;/code&gt; and the compression mode is
 156        set to &lt;code&gt;EXPLICIT&lt;/code&gt;, default tables constructed using the
 157        quality setting are used.  They are written only if the metadata
 158        contains tables or if there is no metadata, but they replace the
 159        tables in the metadata.&lt;/li&gt;
 160   &lt;li&gt; If there is an &lt;code&gt;ImageWriteParam&lt;/code&gt; and the compression mode is
 161        set to &lt;code&gt;DEFAULT&lt;/code&gt;, default visually lossles tables are used.
 162        They are written only if the metadata contains tables or if
 163        there is no metadata, but they replace the tables in the
 164        metadata.&lt;/li&gt;
 165   &lt;li&gt; Otherwise the compression mode on the &lt;code&gt;ImageWriteParam&lt;/code&gt; must
 166        be MODE_COPY_FROM_&lt;code&gt;METADATA&lt;/code&gt;, in which case the following
 167        are used:
 168     &lt;ol&gt;
 169       &lt;li&gt; the tables in the image metadata, if present&lt;/li&gt;
 170       &lt;li&gt; the tables in the stream metadata, if present&lt;/li&gt;
 171       &lt;li&gt; the tables in the &lt;code&gt;JPEGImageWriteParam&lt;/code&gt;, if present&lt;/li&gt;
 172       &lt;li&gt; default visually lossless tables&lt;/li&gt;
 173     &lt;/ol&gt; Tables are written only if they are taken from image metadata.
 174   &lt;/li&gt;
 175 &lt;/ol&gt;
 176 
 177 This ordering implements the design intention that tables should be included
 178 in &lt;code&gt;JPEGImageWriteParam&lt;/code&gt;s only as a means of specifying tables
 179 when no other source is available, and this can occur only when writing to an
 180 abbreviated stream without tables using known non-standard tables for
 181 compression.
 182 
 183 &lt;p&gt;
 184 When reading, tables in a &lt;code&gt;JPEGImageReadParam&lt;/code&gt; are consulted only
 185 if tables have not been set by any previous read.  Tables set from a
 186 &lt;code&gt;JPEGImageReadParam&lt;/code&gt; are overridden by any tables present in the
 187 stream being read.
 188 
 189 &lt;p&gt;
 190 Note that if no image metadata object is specified for a particular image, a
 191 default object is used, which includes default tables.
 192 
 193 &lt;h2&gt;
 194 &lt;a id=color&gt;Colorspace Transformations and Conventional Markers&lt;/a&gt;
 195 &lt;/h2&gt;
 196 Colorspace transformations are controlled by the destination type for
 197 both reading and writing of images.  When &lt;code&gt;Raster&lt;/code&gt;s are
 198 read, no colorspace transformation is performed, and any destination type
 199 is ignored.  A warning is sent to any listeners if a destination type is
 200 specified in this case.  When &lt;code&gt;Raster&lt;/code&gt;s are written, any
 201 destination type is used to interpret the bands.  This might result in a
 202 JFIF or Adobe header being written, or different component ids being written
 203 to the frame and scan headers.  If values present in a metadata object do not
 204 match the destination type, the destination type is used and a warning is sent
 205 to any listeners.
 206 
 207 &lt;p&gt;
 208 
 209 &lt;a id=optcolor&gt;&lt;b&gt;Optional ColorSpace support:&lt;/b&gt;&lt;/a&gt;
 210 Handling of PhotoYCC (YCC), PhotoYCCA (YCCA), RGBA and YCbCrA color spaces
 211 by the standard plugin, as described below, is dependent on capabilities
 212 of the libraries used to interpret the JPEG data. Thus all consequential
 213 behaviors are optional. If the support is not available when decoding,
 214 the color space will be treated as unrecognized and the appropriate
 215 default color space for the specified number of component channels
 216 may be used.
 217 When writing, an Exception may be thrown if no suitable conversion
 218 can be applied before encoding.
 219 But where the support for these color spaces is available, the behavior
 220 must be as documented.
 221 &lt;p&gt;
 222 
 223 When reading, the contents of the stream are interpreted by the usual
 224 JPEG conventions, as follows:
 225 
 226 &lt;ul&gt;
 227   &lt;li&gt; If a JFIF &lt;code&gt;APP0&lt;/code&gt; marker segment is present, the colorspace
 228        is known to be either grayscale or YCbCr.  If an &lt;code&gt;APP2&lt;/code&gt;
 229        marker segment containing an embedded ICC profile is also present, then
 230        the YCbCr is converted to RGB according to the formulas given in the
 231        JFIF spec, and the ICC profile is assumed to refer to the resulting RGB
 232        space.
 233   &lt;li&gt; If an Adobe &lt;code&gt;APP14&lt;/code&gt; marker segment is present, the
 234        colorspace is determined by consulting the &lt;code&gt;transform&lt;/code&gt; flag.
 235        The &lt;code&gt;transform&lt;/code&gt; flag takes one of three values:
 236     &lt;ul&gt;
 237       &lt;li&gt; 2 - The image is encoded as YCCK (implicitly converted from
 238            CMYK on encoding).
 239 
 240       &lt;li&gt; 1 - The image is encoded as YCbCr (implicitly converted from RGB
 241            on encoding).
 242 
 243       &lt;li&gt; 0 - Unknown.  3-channel images are assumed to be RGB, 4-channel
 244            images are assumed to be CMYK.
 245     &lt;/ul&gt;
 246   &lt;li&gt; If neither marker segment is present, the following procedure is
 247        followed: Single-channel images are assumed to be grayscale, and
 248        2-channel images are assumed to be grayscale with an alpha channel.
 249        For 3- and 4-channel images, the component ids are consulted.  If these
 250        values are 1-3 for a 3-channel image, then the image is assumed to be
 251        YCbCr. Subject to the availability of the
 252        &lt;a href=#optcolor&gt;optional color space support&lt;/a&gt;
 253        described above, if these values are 1-4 for a 4-channel image,
 254        then the image is assumed to be YCbCrA.
 255        If these values are &gt; 4, they are checked
 256        against the ASCII codes for &#39;R&#39;, &#39;G&#39;, &#39;B&#39;, &#39;A&#39;, &#39;C&#39;, &#39;c&#39;.  These can
 257        encode the following colorspaces:
 258        &lt;p&gt;
 259        &lt;br&gt;RGB
 260        &lt;br&gt;RGBA
 261        &lt;br&gt;YCC (as &#39;Y&#39;,&#39;C&#39;,&#39;c&#39;), assumed to be PhotoYCC
 262        &lt;br&gt;YCCA (as &#39;Y&#39;,&#39;C&#39;,&#39;c&#39;,&#39;A&#39;), assumed to be PhotoYCCA
 263        &lt;p&gt;
 264        Otherwise, 3-channel subsampled images are assumed to be YCbCr,
 265        3-channel non-subsampled images are assumed to be RGB, 4-channel
 266        subsampled images are assumed to be YCCK, and 4-channel, non-subsampled
 267        images are assumed to be CMYK.
 268 
 269   &lt;li&gt; All other images are declared uninterpretable and an exception is
 270        thrown if an attempt is made to read one as a
 271        &lt;code&gt;BufferedImage&lt;/code&gt;.  Such an image may be read only as a
 272        &lt;code&gt;Raster&lt;/code&gt;.  If an image is interpretable but there is no Java
 273        &lt;code&gt;ColorSpace&lt;/code&gt; available corresponding to the encoded
 274        colorspace (&lt;i&gt;e.g.&lt;/i&gt; YCbCr), then
 275        &lt;code&gt;ImageReader.getRawImageType&lt;/code&gt; will return &lt;code&gt;null&lt;/code&gt;.
 276 &lt;/ul&gt;
 277 
 278 Once an encoded colorspace is determined, then the target colorspace is
 279 determined as follows:
 280 
 281 &lt;ul&gt;
 282   &lt;li&gt; If a destination type is not set, then the following default
 283        transformations take place after upsampling: YCbCr (and YCbCrA) images
 284        are converted to RGB (and RGBA) using the conversion provided by the
 285        underlying IJG library and either the built-in sRGB
 286        &lt;code&gt;ColorSpace&lt;/code&gt; or a custom RGB &lt;code&gt;ColorSpace&lt;/code&gt; object
 287        based on an embedded ICC profile is used to create the output
 288        &lt;code&gt;ColorModel&lt;/code&gt;.  PhotoYCC and PhotoYCCA images are not
 289        converted.  CMYK and YCCK images are currently not supported.&lt;/li&gt;
 290 
 291   &lt;li&gt; If a destination image or type is set, it is used as follows:
 292        If the IJG library provides an appropriate conversion, it is used.
 293        Otherwise the default library conversion is followed by a colorspace
 294        conversion in Java.&lt;/li&gt;
 295 
 296   &lt;li&gt; Bands are selected AFTER any library colorspace conversion.  If a
 297        subset of either source or destination bands is used, then the default
 298        library conversions are used with no further conversion in Java,
 299        regardless of any destination type.&lt;/li&gt;
 300 
 301   &lt;li&gt; An exception is thrown if an attempt is made to read an image in an
 302        unsupported jpeg colorspace as a &lt;code&gt;BufferedImage&lt;/code&gt;
 303        (&lt;i&gt;e.g.&lt;/i&gt; CMYK).  Such images may be read as
 304        &lt;code&gt;Raster&lt;/code&gt;s.  If an image colorspace is unsupported or
 305        uninterpretable, then &lt;code&gt;ImageReader.getImageTypes&lt;/code&gt; will
 306        return an empty &lt;code&gt;Iterator&lt;/code&gt;.   If a subset of the raw bands
 307        are required, a &lt;code&gt;Raster&lt;/code&gt; must be obtained first and the
 308        bands obtained from that. &lt;/li&gt;
 309 &lt;/ul&gt;
 310 
 311 &lt;p&gt;
 312 For writing, the color transformation to apply is determined as
 313 follows:
 314 
 315 &lt;p&gt;
 316 If a subset of the source bands is to be written, no color conversion is
 317 performed.  Any destination, if set, must match the number of bands that will
 318 be written, and serves as an interpretation of the selected bands, rather than
 319 a conversion request.  This behavior is identical to that for
 320 &lt;code&gt;Raster&lt;/code&gt;s.  If all the bands are to be written and an image
 321 (as opposed to a &lt;code&gt;Raster&lt;/code&gt;) is being written, any destination type
 322 is ignored and a warning is sent to any listeners.
 323 
 324 &lt;p&gt;
 325 If a destination type is used and any aspect of the metadata object, if there
 326 is one, is not compatible with that type, the destination type is used, the
 327 metadata written is modified from that provided, and a warning is sent to
 328 listeners.  This includes the &lt;code&gt;app0JFIF&lt;/code&gt; and
 329 &lt;code&gt;app14Adobe&lt;/code&gt; nodes.  The component ids in the &lt;code&gt;sof&lt;/code&gt; and
 330 &lt;code&gt;sos&lt;/code&gt; nodes are not modified, however, as unless a
 331 &lt;code&gt;app0JFIF&lt;/code&gt; node is present, any values may be used.
 332 &lt;p&gt;
 333 
 334 When a full image is written, a destination colorspace will be
 335 chosen based on the image contents and the metadata settings, according to
 336 the following algorithm:
 337 
 338 &lt;p&gt;
 339 
 340 If no metadata object is specified, then the following defaults apply:
 341 
 342 &lt;ul&gt;
 343   &lt;li&gt; Grayscale images are written with a JFIF &lt;code&gt;APP0&lt;/code&gt; marker
 344        segment.  Grayscale images with alpha are written with no special
 345        marker.  As required by JFIF, the component ids in the frame and
 346        scan header is set to 1.
 347 
 348   &lt;li&gt; RGB images are converted to YCbCr, subsampled in the chrominance
 349        channels by half both vertically and horizontally, and written with a
 350        JFIF &lt;code&gt;APP0&lt;/code&gt; marker segment.  If the &lt;code&gt;ColorSpace&lt;/code&gt;
 351        of the image is based on an &lt;code&gt;ICCProfile&lt;/code&gt; (it is an instance
 352        of &lt;code&gt;ICC_ColorSpace&lt;/code&gt;, but is not one of the standard built-in
 353        &lt;code&gt;ColorSpaces&lt;/code&gt;), then that profile is embedded in an
 354        &lt;code&gt;APP2&lt;/code&gt; marker segment.  As required by JFIF, the
 355        component ids in the frame and scan headers are set to 1, 2, and 3.
 356 
 357 
 358   &lt;li&gt; Subject to the &lt;a href=#optcolor&gt;optional library support&lt;/a&gt;
 359         described above,
 360        RGBA images are converted to YCbCrA, subsampled in the
 361        chrominance channels by half both vertically and horizontally, and
 362        written without any special marker segments.  The component ids
 363        in the frame and scan headers are set to 1, 2, 3, and 4.
 364 
 365   &lt;li&gt; Subject to the &lt;a href=#optcolor&gt;optional library support&lt;/a&gt;
 366        described above,
 367        PhotoYCC and YCCAimages are subsampled by half in the chrominance
 368        channels both vertically and horizontally and written with an
 369        Adobe &lt;code&gt;APP14&lt;/code&gt; marker segment and &#39;Y&#39;,&#39;C&#39;, and &#39;c&#39; (and
 370        &#39;A&#39; if an alpha channel is present) as component ids in the frame
 371         and scan headers.
 372 &lt;/ul&gt;
 373 
 374 Default metadata objects for these image types will reflect these settings.
 375 
 376 &lt;p&gt;
 377 
 378 If a metadata object is specified, then the number of channels in the
 379 frame and scan headers must always match the number of bands to be
 380 written, or an exception is thrown.  &lt;code&gt;app0JFIF&lt;/code&gt; and
 381 &lt;code&gt;app14Adobe&lt;/code&gt; nodes may appear in the same metadata object only
 382 if the &lt;code&gt;app14Adobe&lt;/code&gt; node indicates YCbCr, and the component ids
 383 are JFIF compatible (0-2).  The various image types are processed in the
 384 following ways:
 385 
 386 &lt;br&gt;
 387 
 388 (All multi-channel images are subsampled according to the sampling factors
 389 in the frame header node of the metadata object, regardless of color space.)
 390 
 391 &lt;ul&gt;
 392   &lt;li&gt; Grayscale Images:
 393     &lt;ul&gt;
 394       &lt;li&gt; If an &lt;code&gt;app0JFIF&lt;/code&gt; node is present in the metadata object,
 395            a JFIF &lt;code&gt;APP0&lt;/code&gt; marker segment is written.
 396       &lt;li&gt; If an &lt;code&gt;app14Adobe&lt;/code&gt; node is present in the metadata
 397            object, it is checked for validity (&lt;code&gt;transform&lt;/code&gt; must be
 398            &lt;code&gt;UNKNOWN&lt;/code&gt;) and written.
 399       &lt;li&gt; If neither node is present in the metadata object, no special
 400            marker segment is written.
 401     &lt;/ul&gt;
 402 
 403   &lt;li&gt; Grayscale Images with an Alpha Channel:
 404     &lt;ul&gt;
 405       &lt;li&gt; If an &lt;code&gt;app0JFIF&lt;/code&gt; node is present in the metadata object,
 406            it is ignored and a warning is sent to listeners, as JFIF does not
 407            support 2-channel images.
 408       &lt;li&gt; If an &lt;code&gt;app14Adobe&lt;/code&gt; node is present in the metadata
 409            object, it is checked for validity (&lt;code&gt;transform&lt;/code&gt; must be
 410            &lt;code&gt;UNKNOWN&lt;/code&gt;) and written.  If &lt;code&gt;transform&lt;/code&gt; is
 411            not &lt;code&gt;UNKNOWN&lt;/code&gt;, a warning is sent to listeners and the
 412            correct transform is written.
 413       &lt;li&gt; If neither node is present in the metadata object, no special
 414            marker segment is written.
 415     &lt;/ul&gt;
 416 
 417   &lt;li&gt; RGB Images:
 418     &lt;ul&gt;
 419       &lt;li&gt; If an &lt;code&gt;app0JFIF&lt;/code&gt; node is present in the metadata object,
 420            the image is converted to YCbCr and written with a JFIF
 421            &lt;code&gt;APP0&lt;/code&gt; marker segment.  If the &lt;code&gt;ColorSpace&lt;/code&gt;
 422            of the image is based on a non-standard ICC Profile, then that
 423            profile is embedded in an &lt;code&gt;APP2&lt;/code&gt; marker segment.  If the
 424            &lt;code&gt;ColorSpace&lt;/code&gt; is not based on a non-standard ICC Profile,
 425            but an &lt;code&gt;app2ICC&lt;/code&gt; node appears in the metadata, then an
 426            &lt;code&gt;APP2&lt;/code&gt; marker segment is written with the appropriate
 427            standard profile.  Note that the profile must specify an RGB color
 428            space, as the file must be JFIF compliant.
 429 
 430       &lt;li&gt; If an &lt;code&gt;app14Adobe&lt;/code&gt; node is present in the metadata
 431            object, the image is converted according to the color transform
 432            setting and written with an Adobe &lt;code&gt;APP14&lt;/code&gt; marker
 433            segment.  Component ids are written just as they appear in the
 434            frame and scan headers.  The color transform must be either YCbCr
 435            or &lt;code&gt;UNKNOWN&lt;/code&gt;.  If it is &lt;code&gt;UNKNOWN&lt;/code&gt;, the image
 436            is not color converted.
 437 
 438       &lt;li&gt; If neither node is present, the component ids in the frame
 439            header are consulted.  If these indicate a colorspace as described
 440            above, then the image is converted to that colorspace if possible.
 441            If the component ids do not indicate a colorspace, then the
 442            sampling factors are consulted.  If the image is to be subsampled,
 443            it is converted to YCbCr first.  If the image is not to be
 444            subsampled, then no conversion is applied.  No special marker
 445            segmentss are written.
 446     &lt;/ul&gt;
 447 
 448   &lt;li&gt; RGBA images:
 449        Subject to the &lt;a href=#optcolor&gt;optional library support&lt;/a&gt;
 450        described above,
 451     &lt;ul&gt;
 452       &lt;li&gt; If an &lt;code&gt;app0JFIF&lt;/code&gt; node is present in the metadata object,
 453            it is ignored and a warning is sent to listeners, as JFIF does not
 454            support 4-channel images.
 455 
 456       &lt;li&gt; If an &lt;code&gt;app14Adobe&lt;/code&gt; node is present in the metadata
 457            object, the image is written with an Adobe &lt;code&gt;APP14&lt;/code&gt; marker
 458            segment.  No colorspace conversion is performed.  Component ids
 459            are written just as they appear in the frame and scan  headers.
 460            The color transform must be &lt;code&gt;UNKNOWN&lt;/code&gt;.  If it is
 461            not, a warning is sent to listeners.
 462 
 463       &lt;li&gt; If no &lt;code&gt;app14Adobe&lt;/code&gt; node is present, the component ids in
 464            the frame header are consulted.  If these indicate a colorspace as
 465            described above, then the image is converted to that colorspace if
 466            possible.  If the component ids do not indicate a colorspace, then
 467            the sampling factors are consulted.  If the image is to be
 468            subsampled, it is converted to YCbCrA.  If the image is not to be
 469            subsampled, then no conversion is applied.  No special marker
 470            segments are written.
 471     &lt;/ul&gt;
 472 
 473   &lt;li&gt; PhotoYCC Images:
 474        Subject to the &lt;a href=#optcolor&gt;optional library support&lt;/a&gt;
 475        described above,
 476     &lt;ul&gt;
 477       &lt;li&gt; If an &lt;code&gt;app0JFIF&lt;/code&gt; node is present in the metadata object,
 478            the image is converted to sRGB, and then to YCbCr during encoding,
 479            and a JFIF &lt;code&gt;APP0&lt;/code&gt; marker segment is written.
 480 
 481       &lt;li&gt; If an &lt;code&gt;app14Adobe&lt;/code&gt; node is present in the metadata
 482            object, no conversion is applied, and an Adobe &lt;code&gt;APP14&lt;/code&gt;
 483            marker segment is written.  The color transform must be YCC.  If it
 484            is not, a warning is sent to listeners.
 485 
 486       &lt;li&gt; If neither node is present in the metadata object, no conversion
 487            is applied, and no special marker segment is written.
 488     &lt;/ul&gt;
 489 
 490   &lt;li&gt; PhotoYCCA Images:
 491        Subject to the &lt;a href=#optcolor&gt;optional library support&lt;/a&gt;
 492        described above,
 493     &lt;ul&gt;
 494       &lt;li&gt; If an &lt;code&gt;app0JFIF&lt;/code&gt; node is present in the metadata object,
 495            it is ignored and a warning is sent to listeners, as JFIF does not
 496            support 4-channel images.
 497 
 498       &lt;li&gt; If an &lt;code&gt;app14Adobe&lt;/code&gt; node is present in the metadata
 499            object, no conversion is applied, and an Adobe &lt;code&gt;APP14&lt;/code&gt;
 500            marker segment is written.  The color transform must be
 501            &lt;code&gt;UNKNOWN&lt;/code&gt;.  If it is not, a warning is sent to
 502            listeners.
 503 
 504       &lt;li&gt; If neither node is present in the metadata object, no conversion
 505            is applied, and no special marker segment is written.
 506     &lt;/ul&gt;
 507 &lt;/ul&gt;
 508 
 509 &lt;h2&gt;
 510 &lt;a id=thumbs&gt;Thumbnail Images&lt;/a&gt;
 511 &lt;/h2&gt;
 512 Thumbnails are supported by the use of JFIF and JFIF extension marker segments.
 513 Thumbnails provided on the write methods determine the thumbnails that will be
 514 included.  &lt;code&gt;app0JFIF&lt;/code&gt; and &lt;code&gt;app0JFXX&lt;/code&gt; nodes present in
 515 the metadata do not contain any thumbnail pixel data.  However, the kinds of
 516 thumbnails written depend on the contents of the metadata object, as follows.
 517 Any thumbnail which is to be written as an indexed or RGB image and which is
 518 larger than 255 by 255 will be clipped, not scaled, to 255 by 255.  Thumbnails
 519 written as JPEG images may be any size.  A warning is sent to any listeners
 520 whenever a thumbnail is clipped.
 521 &lt;ul&gt;
 522   &lt;li&gt; If there is a single thumbnail, it is processed as follows:
 523     &lt;ul&gt;
 524       &lt;li&gt; If the thumbnail image is an RGB palette image, it is processed as
 525            follows:
 526         &lt;ul&gt;
 527           &lt;li&gt; If no &lt;code&gt;app0JFXX&lt;/code&gt; node is present in the metadata, or
 528                the first &lt;code&gt;app0JFXX&lt;/code&gt; node present in the metadata
 529                contains a &lt;code&gt;JFIFthumbPalette&lt;/code&gt; element, a
 530                palette thumbnail is written in a JFXX &lt;code&gt;APP0&lt;/code&gt; marker
 531                segment.
 532           &lt;li&gt; If the first &lt;code&gt;app0JFXX&lt;/code&gt; node present in the metadata
 533                contains another thumbnail form (RGB or JPEG), the palette
 534                image is expanded to RGB and the indicated thumbnail form is
 535                written.
 536         &lt;/ul&gt;
 537 
 538       &lt;li&gt; If the thumbnail image is an RGB image, it is processed as follows:
 539         &lt;ul&gt;
 540           &lt;li&gt; If no &lt;code&gt;app0JFXX&lt;/code&gt; node is present in the metadata,
 541                the thumbnail is written as part of the JFIF &lt;code&gt;APP0&lt;/code&gt;
 542                marker segment.
 543           &lt;li&gt; If the first &lt;code&gt;app0JFXX&lt;/code&gt; node present in the metadata
 544                contains a &lt;code&gt;JFIFthumbRGB&lt;/code&gt; element, an
 545                RGB thumbnail is written in a JFXX &lt;code&gt;APP0&lt;/code&gt; marker
 546                segment.
 547           &lt;li&gt; If the first &lt;code&gt;app0JFXX&lt;/code&gt; node present in the metadata
 548                contains a &lt;code&gt;JFIFthumbJPEG&lt;/code&gt; element, a
 549                JPEG thumbnail is written in a JFXX &lt;code&gt;APP0&lt;/code&gt; marker
 550                segment.
 551           &lt;li&gt; If the first &lt;code&gt;app0JFXX&lt;/code&gt; node present in the metadata
 552                contains a &lt;code&gt;JFIFthumbPalette&lt;/code&gt; element, an
 553                RGB thumbnail is written in a JFXX &lt;code&gt;APP0&lt;/code&gt; marker
 554                segment and a warning is sent to any listeners.
 555         &lt;/ul&gt;
 556 
 557       &lt;li&gt; If the thumbnail image is a grayscale image, it is processed as
 558            follows:
 559         &lt;ul&gt;
 560           &lt;li&gt; If no &lt;code&gt;app0JFXX&lt;/code&gt; node is present in the metadata,
 561                the thumbnail is expanded to RGB and written as part of the
 562                JFIF &lt;code&gt;APP0&lt;/code&gt; marker segment.
 563           &lt;li&gt; If the first &lt;code&gt;app0JFXX&lt;/code&gt; node present in the metadata
 564                contains a &lt;code&gt;JFIFthumbRGB&lt;/code&gt; element, the thumbnail is
 565                expanded to RGB and written in a separate &lt;code&gt;JFXX&lt;/code&gt; RGB
 566                marker segment.
 567           &lt;li&gt; If the first &lt;code&gt;app0JFXX&lt;/code&gt; node present in the metadata
 568                contains a &lt;code&gt;JFIFthumbJPEG&lt;/code&gt; element, a
 569                JPEG thumbnail is written in a JFXX &lt;code&gt;APP0&lt;/code&gt; marker
 570                segment.
 571           &lt;li&gt; If the first &lt;code&gt;app0JFXX&lt;/code&gt; node present in the metadata
 572                contains a &lt;code&gt;JFIFthumbPalette&lt;/code&gt; element, a
 573                JPEG thumbnail is written in a JFXX &lt;code&gt;APP0&lt;/code&gt; marker
 574                segment and a warning is sent to any listeners.
 575         &lt;/ul&gt;
 576 
 577       &lt;li&gt; Any other thumbnail image types are ignored and a warning is sent
 578            to any listeners.
 579     &lt;/ul&gt;
 580 
 581   &lt;li&gt; If there are multiple thumbnails, each one is processed as above, except
 582        that no thumbnail is placed in the JFIF &lt;code&gt;APP0&lt;/code&gt; segment, and
 583        the &lt;code&gt;app0JFXX&lt;/code&gt; node consulted for each thumbnail is the
 584        &lt;code&gt;app0JFXX&lt;/code&gt; node from the metadata that occurs in the same
 585        sequence as the thumbnail.  &lt;i&gt;I.e.&lt;/i&gt; the first
 586        &lt;code&gt;app0JFXX&lt;/code&gt; node applies to the first thumbnail, the second
 587        node to the second thumbnail, and so on.  If there are fewer
 588        &lt;code&gt;app0JFXX&lt;/code&gt; nodes in the metadata than thumbnails, then
 589        those thumbnails are considered to have no matching
 590        &lt;code&gt;app0JFXX&lt;/code&gt; node.  An RGB thumbnail with no matching
 591        &lt;code&gt;app0JFXX&lt;/code&gt; node is written in a JFXX &lt;code&gt;APP0&lt;/code&gt; marker
 592        segment.  A grayscale thumbnail with no matching
 593        &lt;code&gt;app0JFXX&lt;/code&gt; node is written as a JPEG image to a JFXX
 594        &lt;code&gt;APP0&lt;/code&gt; marker segment.
 595 &lt;/ul&gt;
 596 &lt;p&gt;
 597 
 598 Note that as the only mechanism for storing thumbnails is via the
 599 JFIF or JFIF extension marker segments, only grayscale or RGB images
 600 may have thumbnails.  If thumbnails are present when writing any other type
 601 of image, the thumbnails are ignored and a warning is sent to any warning
 602 listeners.
 603 
 604 &lt;h2&gt;
 605 &lt;a id=prog&gt;Progressive Encoding&lt;/a&gt;
 606 &lt;/h2&gt;
 607 
 608 Progressive encoding must be enabled on the &lt;code&gt;ImageWriteParam&lt;/code&gt;
 609 passed in to a write operation, or the image will be written sequentially,
 610 regardless of the scan headers included in the metadata object.  If
 611 progressive encoding is enabled and set to copy from metadata, then
 612 the sequence of scan headers from the metadata is used to write the
 613 image.  If progressive encoding is enabled and set to use a default,
 614 then the scans in the metadata are ignored and a default set of scans
 615 is used.  Progressive encoding always forces optimized Huffman tables to
 616 be used.  Any Huffman tables present in the metadata will be ignored,
 617 and a warning will be sent to any warning listeners.
 618 
 619 If Huffman-table optimization is requested on the &lt;code&gt;ImageWriteParam&lt;/code&gt;,
 620 all Huffman tables in the metadata or in the &lt;code&gt;ImageWriteParam&lt;/code&gt;
 621 itself are ignored, and a warning will be sent to any warning listeners if
 622 any such tables are present.
 623 
 624 &lt;h2&gt;
 625 &lt;a id=tree&gt;Native Metadata Format Tree Structure and Editing&lt;/a&gt;
 626 &lt;/h2&gt;
 627 
 628 The DTDs below describe just the trees of metadata objects actually returned
 629 by the &lt;code&gt;IIOMetadata&lt;/code&gt; object.  They do not include nodes
 630 corresponding to &lt;code&gt;SOI&lt;/code&gt;, &lt;code&gt;EOI&lt;/code&gt;, or &lt;code&gt;RST&lt;/code&gt;
 631 markers, as these parsing delimiters do not carry any meaningful metadata.
 632 &lt;p&gt;
 633 
 634 The first node is always a &lt;code&gt;JPEGvariety&lt;/code&gt; node.  In the
 635 &lt;code&gt;javax_imageio_jpeg_image_1.0&lt;/code&gt; version of the JPEG metadata
 636 format, this node may have one child, an &lt;code&gt;app0JFIF&lt;/code&gt; node,
 637 indicating that the JPEG stream contains a JFIF marker segment and related
 638 data, or no children, indicating that the stream contains no JFIF marker.
 639 In future versions of the JPEG metadata format, other varieties of JPEG
 640 metadata may be supported (e.g. Exif) by defining other types of nodes
 641 which may appear as a child of the &lt;code&gt;JPEGvariety&lt;/code&gt; node.
 642 &lt;p&gt;
 643 
 644 (Note that an application wishing to interpret Exif metadata given
 645 a metadata tree structure in the &lt;code&gt;javax_imageio_jpeg_image_1.0&lt;/code&gt;
 646 format must check for an &lt;code&gt;unknown&lt;/code&gt; marker segment with a tag
 647 indicating an &lt;code&gt;APP1&lt;/code&gt; marker and containing data identifying it
 648 as an Exif marker segment.  Then it may use application-specific code to
 649 interpret the data in the marker segment.  If such an application were
 650 to encounter a metadata tree formatted according to a future version of
 651 the JPEG metadata format, the Exif marker segment might not be
 652 &lt;code&gt;unknown&lt;/code&gt; in that format - it might be structured as a
 653 child node of the &lt;code&gt;JPEGvariety&lt;/code&gt; node.  Thus, it is important
 654 for an application to specify which version to use by passing the string
 655 identifying the version to the method/constructor used to obtain an
 656 &lt;code&gt;IIOMetadata&lt;/code&gt; object.)
 657 
 658 &lt;p&gt;
 659 
 660 On reading, &lt;code&gt;JFXX&lt;/code&gt; and &lt;code&gt;app2ICC&lt;/code&gt; nodes occur as
 661 children of an &lt;code&gt;app0JFIF&lt;/code&gt; node.
 662 This is true regardless of where the JFXX &lt;code&gt;APP0&lt;/code&gt; and
 663 &lt;code&gt;APP2&lt;/code&gt; marker segments actually occur in the stream.  The ordering
 664 of nodes within the &lt;code&gt;markerSequence&lt;/code&gt; node corresponds to the
 665 ordering of marker segments found in the JPEG stream.
 666 &lt;p&gt;
 667 On writing, any &lt;code&gt;JFXX&lt;/code&gt; and &lt;code&gt;app2ICC&lt;/code&gt; nodes must
 668 occur as children of an &lt;code&gt;app0JFIF&lt;/code&gt; node, itself a child of a
 669 &lt;code&gt;JPEGvariety&lt;/code&gt; node, which must always be the first node.
 670 (If the stream is not to be JFIF compliant, no &lt;code&gt;app0JFIF&lt;/code&gt; node
 671 should be provided, and the &lt;code&gt;JPEGvariety&lt;/code&gt; node should have no
 672 children.)  Any
 673 JFIF &lt;code&gt;APP0&lt;/code&gt;, JFXX &lt;code&gt;APP0&lt;/code&gt;, and &lt;code&gt;APP2&lt;/code&gt; marker
 674 segments are written first, followed by all Adobe &lt;code&gt;APP14&lt;/code&gt;,
 675 &lt;code&gt;APPn&lt;/code&gt;, &lt;code&gt;COM&lt;/code&gt; and unknown segments in the
 676 order in which their corresponding nodes appear in the
 677 &lt;code&gt;markerSequence&lt;/code&gt; node, followed by &lt;code&gt;DQT&lt;/code&gt; (and
 678 &lt;code&gt;DHT&lt;/code&gt; for non-progressive writes) marker segments, followed by the
 679 &lt;code&gt;SOF&lt;/code&gt; and &lt;code&gt;SOS&lt;/code&gt; marker segments.  For progressive writes
 680 using metadata to control progression, the &lt;code&gt;SOS&lt;/code&gt; segments are used
 681 in the order in which their corresponding nodes occur in the
 682 &lt;code&gt;markerSequence&lt;/code&gt; node.
 683 &lt;p&gt;
 684 
 685 The &lt;code&gt;reset&lt;/code&gt;, &lt;code&gt;mergeTree&lt;/code&gt; and &lt;code&gt;setFromTree&lt;/code&gt;
 686 operations have the following semantics for the JPEG plug-in metadata object:
 687 
 688 &lt;p&gt; &lt;code&gt;reset&lt;/code&gt; - A call to &lt;code&gt;reset&lt;/code&gt; will restore the
 689 metadata object to the same state it had immediately after creation, whether
 690 this came about from reading a stream or by obtaining a default object from
 691 the &lt;code&gt;ImageWriter&lt;/code&gt;.  This is true regardless of how many times the
 692 metadata object has been modified since creation.
 693 
 694 &lt;p&gt; &lt;code&gt;mergeTree&lt;/code&gt; - Native Format
 695 &lt;br&gt; The &lt;code&gt;mergeTree&lt;/code&gt; operation accepts valid trees conforming to
 696 the DTD below, and merges the nodes using the following ordering rules.  In
 697 all cases, only data present in the new node is changed in a corresponding
 698 existing node, if any.  This means that nodes cannot be removed using
 699 &lt;code&gt;mergeTree&lt;/code&gt;.  To remove nodes, use &lt;code&gt;setFromTree&lt;/code&gt;.  The
 700 tree must consist of &lt;code&gt;IIOMetadataNode&lt;/code&gt;s.
 701 &lt;ul&gt;
 702   &lt;li&gt; &lt;code&gt;app0JFIF&lt;/code&gt;
 703         &lt;ul&gt;
 704           &lt;li&gt; If an &lt;code&gt;app0JFIF&lt;/code&gt; node already exists, the contents
 705                of the new one modify the existing one.
 706           &lt;li&gt; If there is no such node, a new one is created and inserted in
 707                the appropriate position.
 708         &lt;/ul&gt;
 709   &lt;li&gt; &lt;code&gt;dqt&lt;/code&gt;
 710         &lt;ul&gt;
 711           &lt;li&gt; If there already exist &lt;code&gt;dqt&lt;/code&gt; nodes in the sequence,
 712                then each table in the node replaces the first table, in any
 713                &lt;code&gt;dqt&lt;/code&gt; node, with the same table id.
 714           &lt;li&gt; If none of the existing &lt;code&gt;dqt&lt;/code&gt; nodes contain a table
 715                with the same id, then the table is added to the last existing
 716                &lt;code&gt;dqt&lt;/code&gt; node.
 717           &lt;li&gt; If there are no &lt;code&gt;dqt&lt;/code&gt; nodes, then a new one is
 718                created and added as follows:
 719             &lt;ul&gt;
 720               &lt;li&gt; If there are &lt;code&gt;dht&lt;/code&gt; nodes, the new
 721                    &lt;code&gt;dqt&lt;/code&gt; node is inserted before the first one.
 722               &lt;li&gt; If there are no &lt;code&gt;dht&lt;/code&gt; nodes, the new
 723                    &lt;code&gt;dqt&lt;/code&gt; node is inserted  before an
 724                    &lt;code&gt;sof&lt;/code&gt; node, if there is one.
 725               &lt;li&gt; If there is no &lt;code&gt;sof&lt;/code&gt; node, the new
 726                    &lt;code&gt;dqt&lt;/code&gt; node is inserted before the first
 727                    &lt;code&gt;sos&lt;/code&gt; node, if there is one.
 728               &lt;li&gt; If there is no &lt;code&gt;sos&lt;/code&gt; node, the new
 729                    &lt;code&gt;dqt&lt;/code&gt; node is added to the end of the sequence.
 730             &lt;/ul&gt;
 731         &lt;/ul&gt;
 732   &lt;li&gt; &lt;code&gt;dht&lt;/code&gt;
 733         &lt;ul&gt;
 734           &lt;li&gt; If there already exist &lt;code&gt;dht&lt;/code&gt; nodes in the sequence,
 735                then each table in the node replaces the first table, in any
 736                &lt;code&gt;dht&lt;/code&gt; node, with the same table class and table id.
 737           &lt;li&gt; If none of the existing &lt;code&gt;dht&lt;/code&gt; nodes contain a table
 738                with the same class and id, then the table is added to the last
 739                existing &lt;code&gt;dht&lt;/code&gt; node.
 740           &lt;li&gt; If there are no &lt;code&gt;dht&lt;/code&gt; nodes, then a new one is
 741                created and added as follows:
 742             &lt;ul&gt;
 743               &lt;li&gt; If there are &lt;code&gt;dqt&lt;/code&gt; nodes, the new
 744                    &lt;code&gt;dht&lt;/code&gt; node is inserted immediately following the
 745                    last &lt;code&gt;dqt&lt;/code&gt; node.
 746               &lt;li&gt; If there are no &lt;code&gt;dqt&lt;/code&gt; nodes, the new
 747                    &lt;code&gt;dht&lt;/code&gt; node is inserted before an
 748                    &lt;code&gt;sof&lt;/code&gt; node, if there is one.
 749               &lt;li&gt; If there is no &lt;code&gt;sof&lt;/code&gt; node, the new
 750                    &lt;code&gt;dht&lt;/code&gt; node is inserted before the first
 751                    &lt;code&gt;sos&lt;/code&gt; node, if there is one.
 752               &lt;li&gt; If there is no &lt;code&gt;sos&lt;/code&gt; node, the new
 753                    &lt;code&gt;dht&lt;/code&gt; node is added to the end of the sequence.
 754             &lt;/ul&gt;
 755         &lt;/ul&gt;
 756   &lt;li&gt; &lt;code&gt;dri&lt;/code&gt;
 757         &lt;ul&gt;
 758           &lt;li&gt; If there already exists a &lt;code&gt;dri&lt;/code&gt; node, the restart
 759                interval value is updated.
 760           &lt;li&gt; If there is no &lt;code&gt;dri&lt;/code&gt; node, then a new one is created
 761                and added as follows:
 762             &lt;ul&gt;
 763               &lt;li&gt; If there is an &lt;code&gt;sof&lt;/code&gt; node, the new
 764                    &lt;code&gt;dri&lt;/code&gt; node is inserted before it.
 765               &lt;li&gt; If there is no &lt;code&gt;sof&lt;/code&gt; node, the new
 766                    &lt;code&gt;dri&lt;/code&gt; node is inserted before the first
 767                    &lt;code&gt;sos&lt;/code&gt; node, if there is one.
 768               &lt;li&gt; If there is no &lt;code&gt;sos&lt;/code&gt; node, the new
 769                    &lt;code&gt;dri&lt;/code&gt; node is added to the end of the sequence.
 770             &lt;/ul&gt;
 771         &lt;/ul&gt;
 772   &lt;li&gt; &lt;code&gt;com&lt;/code&gt;
 773         &lt;br&gt; A new &lt;code&gt;com&lt;/code&gt; node is created and inserted as follows:
 774         &lt;ul&gt;
 775           &lt;li&gt; If there already exist &lt;code&gt;com&lt;/code&gt; nodes, the new one is
 776                inserted after the last one.
 777           &lt;li&gt; If there are no &lt;code&gt;com&lt;/code&gt; nodes, the new
 778                &lt;code&gt;com&lt;/code&gt; node is inserted after the
 779                &lt;code&gt;app14Adobe&lt;/code&gt; node, if there is one.
 780           &lt;li&gt; If there is no &lt;code&gt;app14Adobe&lt;/code&gt; node, the new
 781                &lt;code&gt;com&lt;/code&gt; node is inserted at the beginning of the
 782                sequence.
 783         &lt;/ul&gt;
 784   &lt;li&gt; &lt;code&gt;app14Adobe&lt;/code&gt;
 785         &lt;ul&gt;
 786           &lt;li&gt; If there already exists an &lt;code&gt;app14Adobe&lt;/code&gt; node, then
 787                its attributes are updated from the node.
 788           &lt;li&gt; If there is no &lt;code&gt;app14Adobe&lt;/code&gt; node, then a new one is
 789                created and  added as follows:
 790             &lt;ul&gt;
 791               &lt;li&gt; The new &lt;code&gt;app14Adobe&lt;/code&gt; node is inserted after the
 792                    last &lt;code&gt;unknown&lt;/code&gt; node, if there are any.
 793               &lt;li&gt; If there are no &lt;code&gt;unknown&lt;/code&gt; nodes, the new
 794                    &lt;code&gt;app14Adobe&lt;/code&gt; node is inserted at the beginning
 795                    of the sequence.
 796             &lt;/ul&gt;
 797         &lt;/ul&gt;
 798   &lt;li&gt; &lt;code&gt;unknown&lt;/code&gt;
 799        &lt;br&gt; A new &lt;code&gt;unknown&lt;/code&gt; node is created and added to the
 800             sequence as follows:
 801         &lt;ul&gt;
 802           &lt;li&gt; If there already exist &lt;code&gt;unknown&lt;/code&gt; marker nodes, the
 803                new one is inserted after the last one.
 804           &lt;li&gt; If there are no &lt;code&gt;unknown&lt;/code&gt; nodes, the new
 805                &lt;code&gt;unknown&lt;/code&gt; node is inserted before the
 806                &lt;code&gt;app14Adobe&lt;/code&gt; node, if there is one.
 807           &lt;li&gt; If there is no &lt;code&gt;app14Adobe&lt;/code&gt; node, the new
 808                &lt;code&gt;unknown&lt;/code&gt; node is inserted at the beginning of the
 809                sequence.
 810         &lt;/ul&gt;
 811   &lt;li&gt; &lt;code&gt;sof&lt;/code&gt;
 812         &lt;ul&gt;
 813           &lt;li&gt; If there already exists an &lt;code&gt;sof&lt;/code&gt; node in the
 814                sequence, then its values are updated from the node.
 815           &lt;li&gt; If there is no &lt;code&gt;sof&lt;/code&gt; node, then a new one is created
 816                and added as follows:
 817             &lt;ul&gt;
 818               &lt;li&gt; If there are any &lt;code&gt;sos&lt;/code&gt; nodes, the new
 819                    &lt;code&gt;sof&lt;/code&gt; node is inserted before the first one.
 820               &lt;li&gt; If there is no &lt;code&gt;sos&lt;/code&gt; node, the new
 821                    &lt;code&gt;sof&lt;/code&gt; node is added to the end of the sequence.
 822             &lt;/ul&gt;
 823         &lt;/ul&gt;
 824   &lt;li&gt; &lt;code&gt;sos&lt;/code&gt;
 825         &lt;ul&gt;
 826           &lt;li&gt; If there already exists a single &lt;code&gt;sos&lt;/code&gt; node, then
 827                the values are updated from the node.
 828           &lt;li&gt; If there are more than one existing &lt;code&gt;sos&lt;/code&gt; nodes,
 829                then an &lt;code&gt;IIOInvalidTreeException&lt;/code&gt; is thrown, as
 830                &lt;code&gt;sos&lt;/code&gt; nodes cannot be merged into a set of
 831                progressive scans.
 832           &lt;li&gt; If there are no &lt;code&gt;sos&lt;/code&gt; nodes, a new one is created
 833                and added to the end of the sequence.
 834         &lt;/ul&gt;
 835 &lt;/ul&gt;
 836 
 837 &lt;p&gt; &lt;code&gt;mergeTree&lt;/code&gt; - Standard Format
 838 &lt;br&gt;
 839 The &lt;code&gt;mergeTree&lt;/code&gt; operation, when given a tree in the standard
 840 format, will modify the native tree in the following ways:
 841 &lt;ul&gt;
 842    &lt;li&gt; &lt;code&gt;Chroma&lt;/code&gt; - The &lt;code&gt;ColorSpaceType&lt;/code&gt; subnode of a
 843         &lt;code&gt;Chroma&lt;/code&gt; node may change the target colorspace of the
 844         compressed image.  The selection of a new colorspace can cause a number
 845         of changes, in keeping with the algorithms described above:
 846         &lt;code&gt;app0JFIF&lt;/code&gt; and &lt;code&gt;app14Adobe&lt;/code&gt; nodes may be added
 847         or removed, subsampling may be added or removed, component ids may
 848         be changed, and &lt;code&gt;sof&lt;/code&gt; and &lt;code&gt;sos&lt;/code&gt; nodes will be
 849         updated accordingly.  If necessary, additional quantization and
 850         huffman tables are added.  In the case of quantization tables, the
 851         default will be scaled to match the quality level of any existing
 852         tables.  No tables are added to metadata that does not already contain
 853         tables.  If the existing metadata specifies progressive encoding, then
 854         the number of channels must not change.  Any &lt;code&gt;Transparency&lt;/code&gt;
 855         node is also taken into account, as an explicit value of
 856         &lt;code&gt;none&lt;/code&gt; for the &lt;code&gt;Alpha&lt;/code&gt; subnode can cause the
 857         removal of an alpha channel, and anything other than &lt;code&gt;none&lt;/code&gt;
 858         can cause the addition of an alpha channel.
 859    &lt;li&gt; &lt;code&gt;Dimension&lt;/code&gt; - A &lt;code&gt;PixelAspectRatio&lt;/code&gt; specification
 860         can cause the contents of an &lt;code&gt;app0JFIF&lt;/code&gt; node to change, if
 861         there is one present, or the addition of an &lt;code&gt;app0JFIF&lt;/code&gt; node
 862         containing appropriate values, if there can be one.  An appropriate
 863         pair of integers is computed from the floating-point ratio for
 864         inclusion in the node.
 865    &lt;li&gt; &lt;code&gt;Text&lt;/code&gt; - Each uncompressed text item is converted to a
 866         &lt;code&gt;com&lt;/code&gt; node and inserted according to the rules above for
 867         merging &lt;code&gt;com&lt;/code&gt; nodes.
 868 &lt;/ul&gt;
 869 
 870 &lt;p&gt; &lt;code&gt;setFromTree&lt;/code&gt; - Native Format
 871 &lt;br&gt;
 872 The &lt;code&gt;setFromTree&lt;/code&gt; operation, when given a tree in the native
 873 format described below, will simply replace the existing tree in its entirety
 874 with the new one.  The tree must consist of &lt;code&gt;IIOMetadataNode&lt;/code&gt;s.
 875 
 876 &lt;p&gt; &lt;code&gt;setFromTree&lt;/code&gt; - Standard Format
 877 &lt;br&gt;
 878 The &lt;code&gt;setFromTree&lt;/code&gt; operation, when given a tree in the standard
 879 format, performs a &lt;code&gt;reset&lt;/code&gt; followed by a merge of the new tree.
 880 
 881 &lt;h2&gt;
 882 &lt;a id=image&gt;Image Metadata DTD&lt;/a&gt;
 883 &lt;/h2&gt;
 884 
 885 &lt;pre&gt;
 886 &amp;lt;!DOCTYPE &quot;javax_imageio_jpeg_image_1.0&quot; [
 887 
 888   &amp;lt;!ELEMENT &quot;javax_imageio_jpeg_image_1.0&quot; (JPEGvariety, markerSequence)&amp;gt;
 889 
 890     &amp;lt;!ELEMENT &quot;JPEGvariety&quot; (app0JFIF)&amp;gt;
 891       &amp;lt;!-- A node grouping all marker segments specific to the variety of
 892               stream being read/written (e.g. JFIF) - may be empty --&amp;gt;
 893 
 894       &amp;lt;!ELEMENT &quot;app0JFIF&quot; (JFXX?, app2ICC?)&amp;gt;
 895         &amp;lt;!ATTLIST &quot;app0JFIF&quot; &quot;majorVersion&quot; #CDATA &quot;1&quot;&amp;gt;
 896           &amp;lt;!-- The major JFIF version number --&amp;gt;
 897           &amp;lt;!-- Data type: Integer --&amp;gt;
 898           &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
 899           &amp;lt;!-- Max value: 255 (inclusive) --&amp;gt;
 900         &amp;lt;!ATTLIST &quot;app0JFIF&quot; &quot;minorVersion&quot; #CDATA &quot;2&quot;&amp;gt;
 901           &amp;lt;!-- The minor JFIF version number --&amp;gt;
 902           &amp;lt;!-- Data type: Integer --&amp;gt;
 903           &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
 904           &amp;lt;!-- Max value: 255 (inclusive) --&amp;gt;
 905         &amp;lt;!ATTLIST &quot;app0JFIF&quot; &quot;resUnits&quot; (&quot;0&quot; | &quot;1&quot; | &quot;2&quot;) &quot;0&quot;&amp;gt;
 906           &amp;lt;!-- The resolution units for Xdensisty and Ydensity (0 = no
 907                units, just aspect ratio; 1 = dots/inch; 2 = dots/cm) --&amp;gt;
 908         &amp;lt;!ATTLIST &quot;app0JFIF&quot; &quot;Xdensity&quot; #CDATA &quot;1&quot;&amp;gt;
 909           &amp;lt;!-- The horizontal density or aspect ratio numerator --&amp;gt;
 910           &amp;lt;!-- Data type: Integer --&amp;gt;
 911           &amp;lt;!-- Min value: 1 (inclusive) --&amp;gt;
 912           &amp;lt;!-- Max value: 65535 (inclusive) --&amp;gt;
 913         &amp;lt;!ATTLIST &quot;app0JFIF&quot; &quot;Ydensity&quot; #CDATA &quot;1&quot;&amp;gt;
 914           &amp;lt;!-- The vertical density or aspect ratio denominator --&amp;gt;
 915           &amp;lt;!-- Data type: Integer --&amp;gt;
 916           &amp;lt;!-- Min value: 1 (inclusive) --&amp;gt;
 917           &amp;lt;!-- Max value: 65535 (inclusive) --&amp;gt;
 918         &amp;lt;!ATTLIST &quot;app0JFIF&quot; &quot;thumbWidth&quot; #CDATA &quot;0&quot;&amp;gt;
 919           &amp;lt;!-- The width of the thumbnail, or 0 if there isn&#39;t one --&amp;gt;
 920           &amp;lt;!-- Data type: Integer --&amp;gt;
 921           &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
 922           &amp;lt;!-- Max value: 255 (inclusive) --&amp;gt;
 923         &amp;lt;!ATTLIST &quot;app0JFIF&quot; &quot;thumbHeight&quot; #CDATA &quot;0&quot;&amp;gt;
 924           &amp;lt;!-- The height of the thumbnail, or 0 if there isn&#39;t one --&amp;gt;
 925           &amp;lt;!-- Data type: Integer --&amp;gt;
 926           &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
 927           &amp;lt;!-- Max value: 255 (inclusive) --&amp;gt;
 928 
 929         &amp;lt;!ELEMENT &quot;JFXX&quot; (app0JFXX)*&amp;gt;
 930           &amp;lt;!-- Min children: 1 --&amp;gt;
 931 
 932         &amp;lt;!ELEMENT &quot;app0JFXX&quot; (JFIFthumbJPEG | JFIFthumbPalette |
 933           JFIFthumbRGB)&amp;gt;
 934           &amp;lt;!-- A JFIF extension marker segment --&amp;gt;
 935           &amp;lt;!ATTLIST &quot;app0JFXX&quot; &quot;extensionCode&quot; (&quot;16&quot; | &quot;17&quot; | &quot;19&quot;)
 936              #IMPLIED&amp;gt;
 937             &amp;lt;!-- The JFXX extension code identifying thumbnail type: (16 =
 938                  JPEG, 17 = indexed, 19 = RGB --&amp;gt;
 939 
 940           &amp;lt;!ELEMENT &quot;JFIFthumbJPEG&quot; (markerSequence?)&amp;gt;
 941             &amp;lt;!-- A JFIF thumbnail in JPEG format (no JFIF segments
 942                  permitted) --&amp;gt;
 943 
 944           &amp;lt;!ELEMENT &quot;JFIFthumbPalette&quot; EMPTY&amp;gt;
 945             &amp;lt;!-- A JFIF thumbnail as an RGB indexed image --&amp;gt;
 946             &amp;lt;!ATTLIST &quot;JFIFthumbPalette&quot; &quot;thumbWidth&quot; #CDATA #IMPLIED&amp;gt;
 947               &amp;lt;!-- The width of the thumbnail --&amp;gt;
 948               &amp;lt;!-- Data type: Integer --&amp;gt;
 949               &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
 950               &amp;lt;!-- Max value: 255 (inclusive) --&amp;gt;
 951             &amp;lt;!ATTLIST &quot;JFIFthumbPalette&quot; &quot;thumbHeight&quot; #CDATA #IMPLIED&amp;gt;
 952               &amp;lt;!-- The height of the thumbnail --&amp;gt;
 953               &amp;lt;!-- Data type: Integer --&amp;gt;
 954               &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
 955               &amp;lt;!-- Max value: 255 (inclusive) --&amp;gt;
 956 
 957           &amp;lt;!ELEMENT &quot;JFIFthumbRGB&quot; EMPTY&amp;gt;
 958             &amp;lt;!-- A JFIF thumbnail as an RGB image --&amp;gt;
 959             &amp;lt;!ATTLIST &quot;JFIFthumbRGB&quot; &quot;thumbWidth&quot; #CDATA #IMPLIED&amp;gt;
 960               &amp;lt;!-- The width of the thumbnail --&amp;gt;
 961               &amp;lt;!-- Data type: Integer --&amp;gt;
 962               &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
 963               &amp;lt;!-- Max value: 255 (inclusive) --&amp;gt;
 964             &amp;lt;!ATTLIST &quot;JFIFthumbRGB&quot; &quot;thumbHeight&quot; #CDATA #IMPLIED&amp;gt;
 965               &amp;lt;!-- The height of the thumbnail --&amp;gt;
 966               &amp;lt;!-- Data type: Integer --&amp;gt;
 967               &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
 968               &amp;lt;!-- Max value: 255 (inclusive) --&amp;gt;
 969 
 970         &amp;lt;!ELEMENT &quot;app2ICC&quot; EMPTY&amp;gt;
 971           &amp;lt;!-- An ICC profile APP2 marker segment --&amp;gt;
 972           &amp;lt;!-- Optional User object: java.awt.color.ICC_Profile --&amp;gt;
 973 
 974     &amp;lt;!ELEMENT &quot;markerSequence&quot; (dqt | dht | dri | com | unknown |
 975       app14Adobe | sof | sos)*&amp;gt;
 976       &amp;lt;!-- A node grouping all non-jfif marker segments --&amp;gt;
 977 
 978       &amp;lt;!ELEMENT &quot;dqt&quot; (dqtable)*&amp;gt;
 979         &amp;lt;!-- A Define Quantization Table(s) marker segment --&amp;gt;
 980         &amp;lt;!-- Min children: 1 --&amp;gt;
 981         &amp;lt;!-- Max children: 4 --&amp;gt;
 982 
 983         &amp;lt;!ELEMENT &quot;dqtable&quot; EMPTY&amp;gt;
 984           &amp;lt;!-- A single quantization table --&amp;gt;
 985           &amp;lt;!-- User object: javax.imageio.plugins.jpeg.JPEGQTable --&amp;gt;
 986           &amp;lt;!ATTLIST &quot;dqtable&quot; &quot;elementPrecision&quot; #CDATA &quot;0&quot;&amp;gt;
 987             &amp;lt;!-- The number of bits in each table element (0 = 8, 1 = 16)
 988                  --&amp;gt;
 989             &amp;lt;!-- Data type: Integer --&amp;gt;
 990           &amp;lt;!ATTLIST &quot;dqtable&quot; &quot;qtableId&quot; (&quot;0&quot; | &quot;1&quot; | &quot;2&quot; | &quot;3&quot;) #REQUIRED&amp;gt;
 991 
 992       &amp;lt;!ELEMENT &quot;dht&quot; (dhtable)*&amp;gt;
 993         &amp;lt;!-- A Define Huffman Table(s) marker segment --&amp;gt;
 994         &amp;lt;!-- Min children: 1 --&amp;gt;
 995         &amp;lt;!-- Max children: 4 --&amp;gt;
 996 
 997         &amp;lt;!ELEMENT &quot;dhtable&quot; EMPTY&amp;gt;
 998           &amp;lt;!-- A single Huffman table --&amp;gt;
 999           &amp;lt;!-- User object: javax.imageio.plugins.jpeg.JPEGHuffmanTable --&amp;gt;
1000           &amp;lt;!ATTLIST &quot;dhtable&quot; &quot;class&quot; (&quot;0&quot; | &quot;1&quot;) #REQUIRED&amp;gt;
1001             &amp;lt;!-- Indicates whether this is a DC (0) or an AC (1) table --&amp;gt;
1002           &amp;lt;!ATTLIST &quot;dhtable&quot; &quot;htableId&quot; (&quot;0&quot; | &quot;1&quot; | &quot;2&quot; | &quot;3&quot;) #REQUIRED&amp;gt;
1003             &amp;lt;!-- The table id --&amp;gt;
1004 
1005       &amp;lt;!ELEMENT &quot;dri&quot; EMPTY&amp;gt;
1006         &amp;lt;!-- A Define Restart Interval marker segment --&amp;gt;
1007         &amp;lt;!ATTLIST &quot;dri&quot; &quot;interval&quot; #CDATA #REQUIRED&amp;gt;
1008           &amp;lt;!-- The restart interval in MCUs --&amp;gt;
1009           &amp;lt;!-- Data type: Integer --&amp;gt;
1010           &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
1011           &amp;lt;!-- Max value: 65535 (inclusive) --&amp;gt;
1012 
1013       &amp;lt;!ELEMENT &quot;com&quot; EMPTY&amp;gt;
1014         &amp;lt;!-- A Comment marker segment. The user object contains the actual
1015              bytes. --&amp;gt;
1016         &amp;lt;!-- User object: array of [B --&amp;gt;
1017         &amp;lt;!-- Min length: 1 --&amp;gt;
1018         &amp;lt;!-- Max length: 65533 --&amp;gt;
1019         &amp;lt;!ATTLIST &quot;com&quot; &quot;comment&quot; #CDATA #IMPLIED&amp;gt;
1020           &amp;lt;!-- The comment as a string (used only if user object is null)
1021                --&amp;gt;
1022           &amp;lt;!-- Data type: String --&amp;gt;
1023 
1024       &amp;lt;!ELEMENT &quot;unknown&quot; EMPTY&amp;gt;
1025         &amp;lt;!-- An unrecognized marker segment. The user object contains the
1026              data not including length. --&amp;gt;
1027         &amp;lt;!-- User object: array of [B --&amp;gt;
1028         &amp;lt;!-- Min length: 1 --&amp;gt;
1029         &amp;lt;!-- Max length: 65533 --&amp;gt;
1030         &amp;lt;!ATTLIST &quot;unknown&quot; &quot;MarkerTag&quot; #CDATA #REQUIRED&amp;gt;
1031           &amp;lt;!-- The tag identifying this marker segment --&amp;gt;
1032           &amp;lt;!-- Data type: Integer --&amp;gt;
1033           &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
1034           &amp;lt;!-- Max value: 255 (inclusive) --&amp;gt;
1035 
1036       &amp;lt;!ELEMENT &quot;app14Adobe&quot; EMPTY&amp;gt;
1037         &amp;lt;!-- An Adobe APP14 marker segment --&amp;gt;
1038         &amp;lt;!ATTLIST &quot;app14Adobe&quot; &quot;version&quot; #CDATA &quot;100&quot;&amp;gt;
1039           &amp;lt;!-- The version of Adobe APP14 marker segment --&amp;gt;
1040           &amp;lt;!-- Data type: Integer --&amp;gt;
1041           &amp;lt;!-- Min value: 100 (inclusive) --&amp;gt;
1042           &amp;lt;!-- Max value: 255 (inclusive) --&amp;gt;
1043         &amp;lt;!ATTLIST &quot;app14Adobe&quot; &quot;flags0&quot; #CDATA &quot;0&quot;&amp;gt;
1044           &amp;lt;!-- The flags0 variable of an APP14 marker segment --&amp;gt;
1045           &amp;lt;!-- Data type: Integer --&amp;gt;
1046           &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
1047           &amp;lt;!-- Max value: 65535 (inclusive) --&amp;gt;
1048         &amp;lt;!ATTLIST &quot;app14Adobe&quot; &quot;flags1&quot; #CDATA &quot;0&quot;&amp;gt;
1049           &amp;lt;!-- The flags1 variable of an APP14 marker segment --&amp;gt;
1050           &amp;lt;!-- Data type: Integer --&amp;gt;
1051           &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
1052           &amp;lt;!-- Max value: 65535 (inclusive) --&amp;gt;
1053         &amp;lt;!ATTLIST &quot;app14Adobe&quot; &quot;transform&quot; (&quot;0&quot; | &quot;1&quot; | &quot;2&quot;) #REQUIRED&amp;gt;
1054           &amp;lt;!-- The color transform applied to the image (0 = Unknown, 1 =
1055                YCbCr, 2 = YCCK) --&amp;gt;
1056 
1057       &amp;lt;!ELEMENT &quot;sof&quot; (componentSpec)*&amp;gt;
1058         &amp;lt;!-- A Start Of Frame marker segment --&amp;gt;
1059         &amp;lt;!-- Min children: 1 --&amp;gt;
1060         &amp;lt;!-- Max children: 4 --&amp;gt;
1061         &amp;lt;!ATTLIST &quot;sof&quot; &quot;process&quot; (&quot;0&quot; | &quot;1&quot; | &quot;2&quot;) #IMPLIED&amp;gt;
1062           &amp;lt;!-- The JPEG process (0 = Baseline sequential, 1 = Extended
1063                sequential, 2 = Progressive) --&amp;gt;
1064         &amp;lt;!ATTLIST &quot;sof&quot; &quot;samplePrecision&quot; #CDATA &quot;8&quot;&amp;gt;
1065           &amp;lt;!-- The number of bits per sample --&amp;gt;
1066           &amp;lt;!-- Data type: Integer --&amp;gt;
1067         &amp;lt;!ATTLIST &quot;sof&quot; &quot;numLines&quot; #CDATA #IMPLIED&amp;gt;
1068           &amp;lt;!-- The number of lines in the image --&amp;gt;
1069           &amp;lt;!-- Data type: Integer --&amp;gt;
1070           &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
1071           &amp;lt;!-- Max value: 65535 (inclusive) --&amp;gt;
1072         &amp;lt;!ATTLIST &quot;sof&quot; &quot;samplesPerLine&quot; #CDATA #IMPLIED&amp;gt;
1073           &amp;lt;!-- The number of samples per line --&amp;gt;
1074           &amp;lt;!-- Data type: Integer --&amp;gt;
1075           &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
1076           &amp;lt;!-- Max value: 65535 (inclusive) --&amp;gt;
1077         &amp;lt;!ATTLIST &quot;sof&quot; &quot;numFrameComponents&quot; (&quot;1&quot; | &quot;2&quot; | &quot;3&quot; | &quot;4&quot;)
1078            #IMPLIED&amp;gt;
1079           &amp;lt;!-- The number of components in the image --&amp;gt;
1080 
1081         &amp;lt;!ELEMENT &quot;componentSpec&quot; EMPTY&amp;gt;
1082           &amp;lt;!-- A component specification for a frame --&amp;gt;
1083           &amp;lt;!ATTLIST &quot;componentSpec&quot; &quot;componentId&quot; #CDATA #REQUIRED&amp;gt;
1084             &amp;lt;!-- The id for this component --&amp;gt;
1085             &amp;lt;!-- Data type: Integer --&amp;gt;
1086             &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
1087             &amp;lt;!-- Max value: 255 (inclusive) --&amp;gt;
1088           &amp;lt;!ATTLIST &quot;componentSpec&quot; &quot;HsamplingFactor&quot; #CDATA #REQUIRED&amp;gt;
1089             &amp;lt;!-- The horizontal sampling factor for this component --&amp;gt;
1090             &amp;lt;!-- Data type: Integer --&amp;gt;
1091             &amp;lt;!-- Min value: 1 (inclusive) --&amp;gt;
1092             &amp;lt;!-- Max value: 255 (inclusive) --&amp;gt;
1093           &amp;lt;!ATTLIST &quot;componentSpec&quot; &quot;VsamplingFactor&quot; #CDATA #REQUIRED&amp;gt;
1094             &amp;lt;!-- The vertical sampling factor for this component --&amp;gt;
1095             &amp;lt;!-- Data type: Integer --&amp;gt;
1096             &amp;lt;!-- Min value: 1 (inclusive) --&amp;gt;
1097             &amp;lt;!-- Max value: 255 (inclusive) --&amp;gt;
1098           &amp;lt;!ATTLIST &quot;componentSpec&quot; &quot;QtableSelector&quot; (&quot;0&quot; | &quot;1&quot; | &quot;2&quot; |
1099             &quot;3&quot;) #REQUIRED&amp;gt;
1100             &amp;lt;!-- The quantization table to use for this component --&amp;gt;
1101 
1102       &amp;lt;!ELEMENT &quot;sos&quot; (scanComponentSpec)*&amp;gt;
1103         &amp;lt;!-- A Start Of Scan marker segment --&amp;gt;
1104         &amp;lt;!-- Min children: 1 --&amp;gt;
1105         &amp;lt;!-- Max children: 4 --&amp;gt;
1106         &amp;lt;!ATTLIST &quot;sos&quot; &quot;numScanComponents&quot; (&quot;1&quot; | &quot;2&quot; | &quot;3&quot; | &quot;4&quot;)
1107            #REQUIRED&amp;gt;
1108           &amp;lt;!-- The number of components in the scan --&amp;gt;
1109         &amp;lt;!ATTLIST &quot;sos&quot; &quot;startSpectralSelection&quot; #CDATA &quot;0&quot;&amp;gt;
1110           &amp;lt;!-- The first spectral band included in this scan --&amp;gt;
1111           &amp;lt;!-- Data type: Integer --&amp;gt;
1112           &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
1113           &amp;lt;!-- Max value: 63 (inclusive) --&amp;gt;
1114         &amp;lt;!ATTLIST &quot;sos&quot; &quot;endSpectralSelection&quot; #CDATA &quot;63&quot;&amp;gt;
1115           &amp;lt;!-- The last spectral band included in this scan --&amp;gt;
1116           &amp;lt;!-- Data type: Integer --&amp;gt;
1117           &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
1118           &amp;lt;!-- Max value: 63 (inclusive) --&amp;gt;
1119         &amp;lt;!ATTLIST &quot;sos&quot; &quot;approxHigh&quot; #CDATA &quot;0&quot;&amp;gt;
1120           &amp;lt;!-- The highest bit position included in this scan --&amp;gt;
1121           &amp;lt;!-- Data type: Integer --&amp;gt;
1122           &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
1123           &amp;lt;!-- Max value: 15 (inclusive) --&amp;gt;
1124         &amp;lt;!ATTLIST &quot;sos&quot; &quot;approxLow&quot; #CDATA &quot;0&quot;&amp;gt;
1125           &amp;lt;!-- The lowest bit position included in this scan --&amp;gt;
1126           &amp;lt;!-- Data type: Integer --&amp;gt;
1127           &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
1128           &amp;lt;!-- Max value: 15 (inclusive) --&amp;gt;
1129 
1130         &amp;lt;!ELEMENT &quot;scanComponentSpec&quot; EMPTY&amp;gt;
1131           &amp;lt;!-- A component specification for a scan --&amp;gt;
1132           &amp;lt;!ATTLIST &quot;scanComponentSpec&quot; &quot;componentSelector&quot; #CDATA
1133              #REQUIRED&amp;gt;
1134             &amp;lt;!-- The id of this component --&amp;gt;
1135             &amp;lt;!-- Data type: Integer --&amp;gt;
1136             &amp;lt;!-- Min value: 0 (inclusive) --&amp;gt;
1137             &amp;lt;!-- Max value: 255 (inclusive) --&amp;gt;
1138           &amp;lt;!ATTLIST &quot;scanComponentSpec&quot; &quot;dcHuffTable&quot; (&quot;0&quot; | &quot;1&quot; | &quot;2&quot; |
1139             &quot;3&quot;) #REQUIRED&amp;gt;
1140             &amp;lt;!-- The huffman table to use for encoding DC coefficients --&amp;gt;
1141           &amp;lt;!ATTLIST &quot;scanComponentSpec&quot; &quot;acHuffTable&quot; (&quot;0&quot; | &quot;1&quot; | &quot;2&quot; |
1142             &quot;3&quot;) #REQUIRED&amp;gt;
1143             &amp;lt;!-- The huffman table to use for encoding AC coefficients --&amp;gt;
1144 ]&amp;gt;
1145 &lt;/pre&gt;
1146 
1147 &lt;h2&gt;
1148 &lt;a id=stream&gt;Stream Metadata DTD&lt;/a&gt;
1149 &lt;/h2&gt;
1150 
1151 &lt;pre&gt;
1152 &amp;lt;!DOCTYPE &quot;javax_imageio_jpeg_stream_1.0&quot; [
1153   &amp;lt;!ELEMENT &quot;javax_imageio_jpeg_stream_1.0&quot; (dqt |
1154                       dht |
1155                       dri |
1156                       com |
1157                       unknown)*&amp;gt;
1158 
1159   &amp;lt;!-- All elements are as defined above for image metadata --&amp;gt;
1160 ]&amp;gt;
1161 &lt;/pre&gt;
<a name="3" id="anc3"></a>
1162 &lt;/main&gt;
1163 &lt;/body&gt;
1164 &lt;/html&gt;
<a name="4" id="anc4"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="4" type="hidden" />
</body>
</html>