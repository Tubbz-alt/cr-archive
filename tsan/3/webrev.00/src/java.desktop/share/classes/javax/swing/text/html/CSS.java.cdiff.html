<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/share/classes/javax/swing/text/html/CSS.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../WrappedPlainView.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="FormView.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/classes/javax/swing/text/html/CSS.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 2519,11 ***</span>
                  lv = new LengthValue();
                  lv.span = absolute;
              } catch (NumberFormatException nfe) {
                  // Not pixels, use LengthUnit
                  LengthUnit lu = new LengthUnit(value,
<span class="line-modified">!                                                LengthUnit.UNINITALIZED_LENGTH,</span>
                                                 0);
  
                  // PENDING: currently, we only support absolute values and
                  // percentages.
                  switch (lu.type) {
<span class="line-new-header">--- 2519,11 ---</span>
                  lv = new LengthValue();
                  lv.span = absolute;
              } catch (NumberFormatException nfe) {
                  // Not pixels, use LengthUnit
                  LengthUnit lu = new LengthUnit(value,
<span class="line-modified">!                                                LengthUnit.UNINITIALIZED_LENGTH,</span>
                                                 0);
  
                  // PENDING: currently, we only support absolute values and
                  // percentages.
                  switch (lu.type) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2853,29 ***</span>
      @SuppressWarnings(&quot;serial&quot;) // Same-version serialization only
      static class LengthUnit implements Serializable {
          static Hashtable&lt;String, Float&gt; lengthMapping = new Hashtable&lt;String, Float&gt;(6);
          static Hashtable&lt;String, Float&gt; w3cLengthMapping = new Hashtable&lt;String, Float&gt;(6);
          static {
<span class="line-modified">!             lengthMapping.put(&quot;pt&quot;, Float.valueOf(1f));</span>
<span class="line-modified">!             // Not sure about 1.3, determined by experiementation.</span>
<span class="line-modified">!             lengthMapping.put(&quot;px&quot;, Float.valueOf(1.3f));</span>
<span class="line-modified">!             lengthMapping.put(&quot;mm&quot;, Float.valueOf(2.83464f));</span>
<span class="line-modified">!             lengthMapping.put(&quot;cm&quot;, Float.valueOf(28.3464f));</span>
<span class="line-modified">!             lengthMapping.put(&quot;pc&quot;, Float.valueOf(12f));</span>
<span class="line-modified">!             lengthMapping.put(&quot;in&quot;, Float.valueOf(72f));</span>
              int res = 72;
              try {
                  res = Toolkit.getDefaultToolkit().getScreenResolution();
              } catch (HeadlessException e) {
              }
              // mapping according to the CSS2 spec
<span class="line-modified">!             w3cLengthMapping.put(&quot;pt&quot;, Float.valueOf(res/72f));</span>
<span class="line-modified">!             w3cLengthMapping.put(&quot;px&quot;, Float.valueOf(1f));</span>
<span class="line-modified">!             w3cLengthMapping.put(&quot;mm&quot;, Float.valueOf(res/25.4f));</span>
<span class="line-modified">!             w3cLengthMapping.put(&quot;cm&quot;, Float.valueOf(res/2.54f));</span>
<span class="line-modified">!             w3cLengthMapping.put(&quot;pc&quot;, Float.valueOf(res/6f));</span>
<span class="line-modified">!             w3cLengthMapping.put(&quot;in&quot;, Float.valueOf((float)res));</span>
          }
  
          LengthUnit(String value, short defaultType, float defaultValue) {
              parse(value, defaultType, defaultValue);
          }
<span class="line-new-header">--- 2853,29 ---</span>
      @SuppressWarnings(&quot;serial&quot;) // Same-version serialization only
      static class LengthUnit implements Serializable {
          static Hashtable&lt;String, Float&gt; lengthMapping = new Hashtable&lt;String, Float&gt;(6);
          static Hashtable&lt;String, Float&gt; w3cLengthMapping = new Hashtable&lt;String, Float&gt;(6);
          static {
<span class="line-modified">!             lengthMapping.put(&quot;pt&quot;, 1f);</span>
<span class="line-modified">!             // Not sure about 1.3, determined by experimentation.</span>
<span class="line-modified">!             lengthMapping.put(&quot;px&quot;, 1.3f);</span>
<span class="line-modified">!             lengthMapping.put(&quot;mm&quot;, 2.83464f);</span>
<span class="line-modified">!             lengthMapping.put(&quot;cm&quot;, 28.3464f);</span>
<span class="line-modified">!             lengthMapping.put(&quot;pc&quot;, 12f);</span>
<span class="line-modified">!             lengthMapping.put(&quot;in&quot;, 72f);</span>
              int res = 72;
              try {
                  res = Toolkit.getDefaultToolkit().getScreenResolution();
              } catch (HeadlessException e) {
              }
              // mapping according to the CSS2 spec
<span class="line-modified">!             w3cLengthMapping.put(&quot;pt&quot;, res / 72f);</span>
<span class="line-modified">!             w3cLengthMapping.put(&quot;px&quot;, 1f);</span>
<span class="line-modified">!             w3cLengthMapping.put(&quot;mm&quot;, res / 25.4f);</span>
<span class="line-modified">!             w3cLengthMapping.put(&quot;cm&quot;, res / 2.54f);</span>
<span class="line-modified">!             w3cLengthMapping.put(&quot;pc&quot;, res / 6f);</span>
<span class="line-modified">!             w3cLengthMapping.put(&quot;in&quot;, (float) res);</span>
          }
  
          LengthUnit(String value, short defaultType, float defaultValue) {
              parse(value, defaultType, defaultValue);
          }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2883,58 ***</span>
          void parse(String value, short defaultType, float defaultValue) {
              type = defaultType;
              this.value = defaultValue;
  
              int length = value.length();
<span class="line-modified">!             if (length &gt; 0 &amp;&amp; value.charAt(length - 1) == &#39;%&#39;) {</span>
                  try {
<span class="line-modified">!                     this.value = Float.valueOf(value.substring(0, length - 1)).</span>
<span class="line-removed">-                                                floatValue() / 100.0f;</span>
                      type = 1;
                  }
                  catch (NumberFormatException nfe) { }
              }
<span class="line-modified">!             if (length &gt;= 2) {</span>
                  units = value.substring(length - 2, length);
                  Float scale = lengthMapping.get(units);
                  if (scale != null) {
                      try {
<span class="line-modified">!                         this.value = Float.valueOf(value.substring(0,</span>
<span class="line-removed">-                                length - 2)).floatValue();</span>
                          type = 0;
                      }
                      catch (NumberFormatException nfe) { }
                  }
                  else if (units.equals(&quot;em&quot;) ||
                           units.equals(&quot;ex&quot;)) {
                      try {
<span class="line-modified">!                         this.value = Float.valueOf(value.substring(0,</span>
<span class="line-removed">-                                       length - 2)).floatValue();</span>
                          type = 3;
                      }
                      catch (NumberFormatException nfe) { }
                  }
                  else if (value.equals(&quot;larger&quot;)) {
<span class="line-modified">!                     this.value = 2f;</span>
                      type = 2;
                  }
                  else if (value.equals(&quot;smaller&quot;)) {
<span class="line-modified">!                     this.value = -2;</span>
                      type = 2;
                  }
                  else {
                      // treat like points.
                      try {
<span class="line-modified">!                         this.value = Float.valueOf(value).floatValue();</span>
                          type = 0;
                      } catch (NumberFormatException nfe) {}
                  }
              }
<span class="line-modified">!             else if (length &gt; 0) {</span>
                  // treat like points.
                  try {
<span class="line-modified">!                     this.value = Float.valueOf(value).floatValue();</span>
                      type = 0;
                  } catch (NumberFormatException nfe) {}
              }
          }
  
<span class="line-new-header">--- 2883,58 ---</span>
          void parse(String value, short defaultType, float defaultValue) {
              type = defaultType;
              this.value = defaultValue;
  
              int length = value.length();
<span class="line-modified">!             if (length &lt; 1) {</span>
<span class="line-added">+                 return;</span>
<span class="line-added">+             }</span>
<span class="line-added">+             if (value.charAt(length - 1) == &#39;%&#39;) {</span>
                  try {
<span class="line-modified">!                     this.value = Float.parseFloat(value.substring(0, length - 1)) / 100.0f;</span>
                      type = 1;
                  }
                  catch (NumberFormatException nfe) { }
              }
<span class="line-modified">!             else if (length &gt;= 2) {</span>
                  units = value.substring(length - 2, length);
                  Float scale = lengthMapping.get(units);
                  if (scale != null) {
                      try {
<span class="line-modified">!                         this.value = Float.parseFloat(value.substring(0, length - 2));</span>
                          type = 0;
                      }
                      catch (NumberFormatException nfe) { }
                  }
                  else if (units.equals(&quot;em&quot;) ||
                           units.equals(&quot;ex&quot;)) {
                      try {
<span class="line-modified">!                         this.value = Float.parseFloat(value.substring(0, length - 2));</span>
                          type = 3;
                      }
                      catch (NumberFormatException nfe) { }
                  }
                  else if (value.equals(&quot;larger&quot;)) {
<span class="line-modified">!                     this.value = 2.f;</span>
                      type = 2;
                  }
                  else if (value.equals(&quot;smaller&quot;)) {
<span class="line-modified">!                     this.value = -2.f;</span>
                      type = 2;
                  }
                  else {
                      // treat like points.
                      try {
<span class="line-modified">!                         this.value = Float.parseFloat(value);</span>
                          type = 0;
                      } catch (NumberFormatException nfe) {}
                  }
              }
<span class="line-modified">!             else {</span>
                  // treat like points.
                  try {
<span class="line-modified">!                     this.value = Float.parseFloat(value);</span>
                      type = 0;
                  } catch (NumberFormatException nfe) {}
              }
          }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2976,11 ***</span>
          short type;
          float value;
          String units = null;
  
  
<span class="line-modified">!         static final short UNINITALIZED_LENGTH = (short)10;</span>
      }
  
  
      /**
       * Class used to parse font property. The font property is shorthand
<span class="line-new-header">--- 2976,11 ---</span>
          short type;
          float value;
          String units = null;
  
  
<span class="line-modified">!         static final short UNINITIALIZED_LENGTH = (short)10;</span>
      }
  
  
      /**
       * Class used to parse font property. The font property is shorthand
</pre>
<center><a href="../WrappedPlainView.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="FormView.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>