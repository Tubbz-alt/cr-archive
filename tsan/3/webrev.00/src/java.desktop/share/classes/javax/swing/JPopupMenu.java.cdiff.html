<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/share/classes/javax/swing/JPopupMenu.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="JLayeredPane.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="JRootPane.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/classes/javax/swing/JPopupMenu.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 1997, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 323,30 ***</span>
          if(popupPostionFixDisabled == true || GraphicsEnvironment.isHeadless()) {
              return popupLocation;
          }
  
          // Get screen bounds
<span class="line-removed">-         Rectangle scrBounds;</span>
          GraphicsConfiguration gc = getCurrentGraphicsConfiguration(popupLocation);
<span class="line-modified">!         Toolkit toolkit = Toolkit.getDefaultToolkit();</span>
<span class="line-removed">-         if(gc != null) {</span>
<span class="line-removed">-             // If we have GraphicsConfiguration use it to get screen bounds</span>
<span class="line-removed">-             scrBounds = gc.getBounds();</span>
<span class="line-removed">-         } else {</span>
              // If we don&#39;t have GraphicsConfiguration use primary screen
<span class="line-modified">!             scrBounds = new Rectangle(toolkit.getScreenSize());</span>
          }
  
          // Calculate the screen size that popup should fit
          Dimension popupSize = JPopupMenu.this.getPreferredSize();
          long popupRightX = (long)popupLocation.x + (long)popupSize.width;
          long popupBottomY = (long)popupLocation.y + (long)popupSize.height;
          int scrWidth = scrBounds.width;
          int scrHeight = scrBounds.height;
  
          if (!canPopupOverlapTaskBar()) {
              // Insets include the task bar. Take them into account.
              Insets scrInsets = toolkit.getScreenInsets(gc);
              scrBounds.x += scrInsets.left;
              scrBounds.y += scrInsets.top;
              scrWidth -= scrInsets.left + scrInsets.right;
              scrHeight -= scrInsets.top + scrInsets.bottom;
<span class="line-new-header">--- 323,28 ---</span>
          if(popupPostionFixDisabled == true || GraphicsEnvironment.isHeadless()) {
              return popupLocation;
          }
  
          // Get screen bounds
          GraphicsConfiguration gc = getCurrentGraphicsConfiguration(popupLocation);
<span class="line-modified">!         if (gc == null) {</span>
              // If we don&#39;t have GraphicsConfiguration use primary screen
<span class="line-modified">!             gc = GraphicsEnvironment.getLocalGraphicsEnvironment().</span>
<span class="line-added">+                             getDefaultScreenDevice().getDefaultConfiguration();</span>
          }
<span class="line-added">+         Rectangle scrBounds = gc.getBounds();</span>
  
          // Calculate the screen size that popup should fit
          Dimension popupSize = JPopupMenu.this.getPreferredSize();
          long popupRightX = (long)popupLocation.x + (long)popupSize.width;
          long popupBottomY = (long)popupLocation.y + (long)popupSize.height;
          int scrWidth = scrBounds.width;
          int scrHeight = scrBounds.height;
  
          if (!canPopupOverlapTaskBar()) {
              // Insets include the task bar. Take them into account.
<span class="line-added">+             Toolkit toolkit = Toolkit.getDefaultToolkit();</span>
              Insets scrInsets = toolkit.getScreenInsets(gc);
              scrBounds.x += scrInsets.left;
              scrBounds.y += scrInsets.top;
              scrWidth -= scrInsets.left + scrInsets.right;
              scrHeight -= scrInsets.top + scrInsets.bottom;
</pre>
<center><a href="JLayeredPane.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="JRootPane.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>