<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/share/classes/javax/swing/text/Document.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="AbstractDocument.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ElementIterator.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/classes/javax/swing/text/Document.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 163,15 ***</span>
   * &lt;ul&gt;
   * &lt;li&gt;{@link #getProperty(java.lang.Object)}
   * &lt;li&gt;{@link #putProperty(java.lang.Object, java.lang.Object)}
   * &lt;/ul&gt;
   *
<span class="line-modified">!  * &lt;p&gt;For more information on the &lt;code&gt;Document&lt;/code&gt; class, see</span>
<span class="line-modified">!  * &lt;a href=&quot;http://www.oracle.com/technetwork/java/javase/tech/articles-jsp-139072.html&quot;&gt;The Swing Connection&lt;/a&gt;</span>
<span class="line-modified">!  * and most particularly the article,</span>
<span class="line-modified">!  * &lt;a href=&quot;http://java.sun.com/products/jfc/tsc/articles/text/element_interface&quot;&gt;</span>
<span class="line-modified">!  * The Element Interface&lt;/a&gt;.</span>
   *
   * @author  Timothy Prinzing
   *
   * @see javax.swing.event.DocumentEvent
   * @see javax.swing.event.DocumentListener
<span class="line-new-header">--- 163,186 ---</span>
   * &lt;ul&gt;
   * &lt;li&gt;{@link #getProperty(java.lang.Object)}
   * &lt;li&gt;{@link #putProperty(java.lang.Object, java.lang.Object)}
   * &lt;/ul&gt;
   *
<span class="line-modified">!  * &lt;p&gt;&lt;b&gt;Overview and Programming Tips&lt;/b&gt;</span>
<span class="line-modified">!  * &lt;p&gt;&lt;u&gt;{@link javax.swing.text.Element}&lt;/u&gt; is an important interface used in constructing a Document.</span>
<span class="line-modified">!  * It has the power to describe various structural parts of a document,</span>
<span class="line-modified">!  * such as paragraphs, lines of text, or even (in HTML documents) items in lists.</span>
<span class="line-modified">!  * Conceptually, the Element interface captures some of the spirit of an SGML document.</span>
<span class="line-added">+  * So if you know SGML, you may already have some understanding of Swing&#39;s Element interface.</span>
<span class="line-added">+  * &lt;p&gt;In the Swing text API&#39;s document model, the interface Element defines a structural piece of a Document,</span>
<span class="line-added">+  * like a paragraph, a line of text, or a list item in an HTML document.</span>
<span class="line-added">+  * &lt;p&gt;Every Element is either a &lt;i&gt;branch&lt;/i&gt; or a &lt;i&gt;leaf&lt;/i&gt;. If an element is a branch,</span>
<span class="line-added">+  * the &lt;code&gt;isLeaf()&lt;/code&gt; method returns false. If an element is a a leaf, &lt;code&gt;isLeaf()&lt;/code&gt; returns true.</span>
<span class="line-added">+  * &lt;p&gt;Branches can have any number of children. Leaves do not have children.</span>
<span class="line-added">+  * To determine how many children a branch has, you can call &lt;code&gt;getElementCount()&lt;/code&gt;.</span>
<span class="line-added">+  * To determine the parent of an Element, you can call &lt;code&gt;getParentElement()&lt;/code&gt;.</span>
<span class="line-added">+  * Root elements don&#39;t have parents, so calling &lt;code&gt;getParentElement()&lt;/code&gt; on a root returns null.</span>
<span class="line-added">+  * &lt;p&gt;An Element represents a specific region in a Document that begins with startOffset</span>
<span class="line-added">+  * and ends just before endOffset.</span>
<span class="line-added">+  * The start offset of a branch Element is usually the start offset of its first child.</span>
<span class="line-added">+  * Similarly, the end offset of a branch Element is usually the end offset of its last child.</span>
<span class="line-added">+  * &lt;p&gt;Every Element is associated with an AttributeSet that you can access by calling &lt;code&gt;getAttributes()&lt;/code&gt;.</span>
<span class="line-added">+  * In an Element, and AttributeSet is essentially a set of key/value pairs.</span>
<span class="line-added">+  * These pairs are generally used for markup -- such as determining the Element&#39;s</span>
<span class="line-added">+  * foreground color, font size, and so on. But it is up to the model, and the developer,</span>
<span class="line-added">+  * to determine what is stored in the AttributeSet.</span>
<span class="line-added">+  * &lt;p&gt;You can obtain the root Element (or Elements) of a Document by calling the</span>
<span class="line-added">+  * methods &lt;code&gt;getDefaultRootElement()&lt;/code&gt; and &lt;code&gt;getRootElements()&lt;/code&gt;, which are defined in the Document interface.</span>
<span class="line-added">+  * &lt;p&gt;The Document interface is responsible for translating a linear view of the</span>
<span class="line-added">+  * characters into Element operations. It is up to each Document implementation</span>
<span class="line-added">+  * to define what the Element structure is.</span>
<span class="line-added">+  *</span>
<span class="line-added">+  * &lt;p&gt;&lt;b&gt;The PlainDocument class&lt;/b&gt;</span>
<span class="line-added">+  * &lt;p&gt;The &lt;u&gt;{@link javax.swing.text.PlainDocument}&lt;/u&gt; class defines an Element</span>
<span class="line-added">+  * structure in which the root node has a child node for each line of text in the model.</span>
<span class="line-added">+  * &lt;u&gt;Figure 1&lt;/u&gt; shows how two lines of text would be modeled by a PlainDocument</span>
<span class="line-added">+  * &lt;p style=&quot;text-align:center&quot;&gt;&lt;img src=&quot;doc-files/plain1.gif&quot;</span>
<span class="line-added">+  * alt=&quot;The preceding text describes this graphic.&quot;&gt;</span>
<span class="line-added">+  * &lt;p&gt;&lt;u&gt;Figure 2&lt;/u&gt; shows how how those same two lines of text might map to actual content:</span>
<span class="line-added">+  * &lt;p style=&quot;text-align:center&quot;&gt;&lt;img src=&quot;doc-files/plain2.gif&quot;</span>
<span class="line-added">+  * alt=&quot;The preceding text describes this graphic.&quot;&gt;</span>
<span class="line-added">+  *</span>
<span class="line-added">+  * &lt;p&gt;&lt;b&gt;Inserting text into a PlainDocument&lt;/b&gt;</span>
<span class="line-added">+  * &lt;p&gt;As just mentioned, a PlainDocument contains a root Element, which in turn</span>
<span class="line-added">+  * contains an Element for each line of text.</span>
<span class="line-added">+  * When text is inserted into a PlainDocument, it creates the Elements that</span>
<span class="line-added">+  * are needed for an Element to exist for each newline.</span>
<span class="line-added">+  * To illustrate, let&#39;s say you wanted to insert a newline at offset 2 in &lt;u&gt;Figure 2&lt;/u&gt;, above.</span>
<span class="line-added">+  * To accomplish this objective, you could use the Document method &lt;code&gt;insertString()&lt;/code&gt;,</span>
<span class="line-added">+  * using this syntax:</span>
<span class="line-added">+  * &lt;pre&gt;&lt;code&gt;document.insertString(2, &quot;\n&quot;, null);&lt;/code&gt;&lt;/pre&gt;</span>
<span class="line-added">+  * &lt;p&gt;After invoking the &lt;code&gt;insertString()&lt;/code&gt; method, the Element structure would look</span>
<span class="line-added">+  * like the one shown in &lt;u&gt;Figure 3&lt;/u&gt;.</span>
<span class="line-added">+  * &lt;p style=&quot;text-align:center&quot;&gt;&lt;img src=&quot;doc-files/plain3.gif&quot;</span>
<span class="line-added">+  * alt=&quot;The preceding text describes this graphic.&quot;&gt;</span>
<span class="line-added">+  * &lt;p&gt;As another example, let&#39;s say you wanted to insert the pattern &quot;new\ntext\n&quot;</span>
<span class="line-added">+  * at offset 2 as shown previously in &lt;u&gt;Figure 2&lt;/u&gt;. This operation would have the</span>
<span class="line-added">+  * result shown in &lt;u&gt;Figure 4&lt;/u&gt;.</span>
<span class="line-added">+  * &lt;p style=&quot;text-align:center&quot;&gt;&lt;img src=&quot;doc-files/plain4.gif&quot;</span>
<span class="line-added">+  * alt=&quot;The preceding text describes this graphic.&quot;&gt;</span>
<span class="line-added">+  * &lt;p&gt;In the preceding illustrations, the name of the line Elements is changed</span>
<span class="line-added">+  * after the insertion to match the line numbers.</span>
<span class="line-added">+  * But notice that when this is done, the AttributeSets remain the same.</span>
<span class="line-added">+  * For example, in &lt;u&gt;Figure 2&lt;/u&gt;, the AttributeSet of Line 2 matches that of the</span>
<span class="line-added">+  * AttributeSet of Line 4 in &lt;u&gt;Figure 4&lt;/u&gt;.</span>
<span class="line-added">+  *</span>
<span class="line-added">+  * &lt;p&gt;&lt;b&gt;Removing text from a PlainDocument&lt;/b&gt;</span>
<span class="line-added">+  * &lt;p&gt;Removal of text results in a structure change if the deletion spans more than one line.</span>
<span class="line-added">+  * Consider a deletion of seven characters starting at Offset 1 shown previously in &lt;u&gt;Figure 3&lt;/u&gt;.</span>
<span class="line-added">+  * In this case, the Element representing Line 2 is completely removed, as the</span>
<span class="line-added">+  * region it represents is contained in the deleted region.</span>
<span class="line-added">+  * The Elements representing Lines 1 and 3 are joined, as they are partially</span>
<span class="line-added">+  * contained in the deleted region. Thus, we have the result:</span>
<span class="line-added">+  * &lt;p style=&quot;text-align:center&quot;&gt;&lt;img src=&quot;doc-files/plain5.gif&quot;</span>
<span class="line-added">+  * alt=&quot;The preceding text describes this graphic.&quot;&gt;</span>
<span class="line-added">+  *</span>
<span class="line-added">+  * &lt;p&gt;&lt;b&gt;The Default StyledDocument Class&lt;/b&gt;</span>
<span class="line-added">+  * &lt;p&gt;The &lt;u&gt;{@link javax.swing.text.DefaultStyledDocument}&lt;/u&gt; class, used for styled text,</span>
<span class="line-added">+  * contains another level of Elements.</span>
<span class="line-added">+  * This extra level is needed so that each paragraph can contain different styles of text.</span>
<span class="line-added">+  * In the two paragraphs shown in &lt;u&gt;Figure 6&lt;/u&gt;, the first paragraph contains</span>
<span class="line-added">+  * two styles and the second paragraph contains three styles.</span>
<span class="line-added">+  * &lt;p style=&quot;text-align:center&quot;&gt;&lt;img src=&quot;doc-files/plain6.gif&quot;</span>
<span class="line-added">+  * alt=&quot;The preceding text describes this graphic.&quot;&gt;</span>
<span class="line-added">+  * &lt;p&gt;&lt;u&gt;Figure 7&lt;/u&gt; shows how those same Elements might map to content.</span>
<span class="line-added">+  * &lt;p style=&quot;text-align:center&quot;&gt;&lt;img src=&quot;doc-files/plain7.gif&quot;</span>
<span class="line-added">+  * alt=&quot;The preceding text describes this graphic.&quot;&gt;</span>
<span class="line-added">+  *</span>
<span class="line-added">+  * &lt;p&gt;&lt;b&gt;Inserting text into a DefaultStyledDocument&lt;/b&gt;</span>
<span class="line-added">+  * &lt;p&gt;As previously mentioned, DefaultStyledDocument maintains an Element structure</span>
<span class="line-added">+  * such that the root Element</span>
<span class="line-added">+  * contains a child Element for each paragraph. In turn, each of these</span>
<span class="line-added">+  * paragraph Elements contains an Element for each style of text in the paragraph.</span>
<span class="line-added">+  * As an example, let&#39;s say you had a document containing one paragraph,</span>
<span class="line-added">+  * and that this paragraph contained two styles, as shown in &lt;u&gt;Figure 8&lt;/u&gt;.</span>
<span class="line-added">+  * &lt;p style=&quot;text-align:center&quot;&gt;&lt;img src=&quot;doc-files/plain8.gif&quot;</span>
<span class="line-added">+  * alt=&quot;The preceding text describes this graphic.&quot;&gt;</span>
<span class="line-added">+  * &lt;p&gt;If you then wanted to insert a newline at offset 2, you would again use the</span>
<span class="line-added">+  * method &lt;code&gt;insertString()&lt;/code&gt;, as follows:</span>
<span class="line-added">+  *</span>
<span class="line-added">+  *  &lt;pre&gt;&lt;code&gt; styledDocument.insertString(2, &quot;\n&quot;,</span>
<span class="line-added">+                 styledDocument.getCharacterElement(0).getAttributes());&lt;/code&gt;&lt;/pre&gt;</span>
<span class="line-added">+ </span>
<span class="line-added">+  * &lt;p&gt;This operation would have the result shown in &lt;u&gt;Figure 9&lt;/u&gt;.</span>
<span class="line-added">+  * &lt;p style=&quot;text-align:center&quot;&gt;&lt;img src=&quot;doc-files/plain9.gif&quot;</span>
<span class="line-added">+  * alt=&quot;The preceding text describes this graphic.&quot;&gt;</span>
<span class="line-added">+  * &lt;p&gt;It&#39;s important to note that the AttributeSet passed to &lt;code&gt;insertString()&lt;/code&gt; matches</span>
<span class="line-added">+  * that of the attributes of Style 1. If the AttributeSet passed to &lt;code&gt;insertString()&lt;/code&gt;</span>
<span class="line-added">+  *  did not match, the result would be the situation shown in &lt;u&gt;Figure 10&lt;/u&gt;.</span>
<span class="line-added">+  * &lt;p style=&quot;text-align:center&quot;&gt;&lt;img src=&quot;doc-files/plain10.gif&quot;</span>
<span class="line-added">+  * alt=&quot;The preceding text describes this graphic.&quot;&gt;</span>
<span class="line-added">+  * &lt;p&gt;&lt;b&gt;Removing text from a DefaultStyledDocument&lt;/b&gt;</span>
<span class="line-added">+  * &lt;p&gt;Removing text from a DefaultStyledDocument is similar to removing text from</span>
<span class="line-added">+  * a PlainDocument. The only difference is the extra level of Elements.</span>
<span class="line-added">+  * Consider what would happen if you deleted two characters at Offset 1</span>
<span class="line-added">+  * from Figure 10, above. Since the the second Element of Paragraph 1 is</span>
<span class="line-added">+  * completely contained in the deleted region, it would be removed.</span>
<span class="line-added">+  * Assuming the attributes of Paragraph 1&#39;s first child matched those of</span>
<span class="line-added">+  * Paragraph2&#39;s first child, the results would be those shown in &lt;u&gt;Figure 11&lt;/u&gt;.</span>
<span class="line-added">+  * &lt;p style=&quot;text-align:center&quot;&gt;&lt;img src=&quot;doc-files/plain11.gif&quot;</span>
<span class="line-added">+  * alt=&quot;The preceding text describes this graphic.&quot;&gt;</span>
<span class="line-added">+  * &lt;p&gt;If the attributes did not match, we would get the results shown in &lt;u&gt;Figure 12&lt;/u&gt;.</span>
<span class="line-added">+  * &lt;p style=&quot;text-align:center&quot;&gt;&lt;img src=&quot;doc-files/plain12.gif&quot;</span>
<span class="line-added">+  * alt=&quot;The preceding text describes this graphic.&quot;&gt;</span>
<span class="line-added">+  *</span>
<span class="line-added">+  * &lt;p&gt;&lt;b&gt;The StyledDocument Class&lt;/b&gt;</span>
<span class="line-added">+  * &lt;p&gt;The &lt;u&gt;{@link javax.swing.text.StyledDocument}&lt;/u&gt; class provides a method</span>
<span class="line-added">+  * named &lt;code&gt;setCharacterAttributes()&lt;/code&gt;, which allows you to set the attributes</span>
<span class="line-added">+  * on the character Elements in a given range:</span>
<span class="line-added">+ </span>
<span class="line-added">+  *   &lt;pre&gt;&lt;code&gt; public void setCharacterAttributes</span>
<span class="line-added">+  *          (int offset, int length, AttributeSet s, boolean replace);&lt;/code&gt;&lt;/pre&gt;</span>
<span class="line-added">+  *</span>
<span class="line-added">+  * &lt;p&gt;Recall that in the diagrams shown in the previous section, all leaf Elements</span>
<span class="line-added">+  * shown in the drawings were also character Elements.</span>
<span class="line-added">+  * That means that the &lt;code&gt;setCharacterAttributes()&lt;/code&gt; method could be used to set their attributes.</span>
<span class="line-added">+  * &lt;p&gt;The &lt;code&gt;setCharacterAttributes()&lt;/code&gt; method takes four arguments .</span>
<span class="line-added">+  * The first and second arguments identify a region in the Document that is</span>
<span class="line-added">+  * to be changed. The third argument specifies the new attributes</span>
<span class="line-added">+  * (as an AttributeSet), and the fourth argument determines if the new attributes</span>
<span class="line-added">+  * should be added to the existing attributes (a value of false) or</span>
<span class="line-added">+  * if the character Element should replace its existing attributes</span>
<span class="line-added">+  * with the new attributes (a value of true).</span>
<span class="line-added">+  * &lt;p&gt;As an example, let&#39;s say you wanted to change the attributes of the</span>
<span class="line-added">+  * first three characters in &lt;u&gt;Figure 9&lt;/u&gt;, shown previously.</span>
<span class="line-added">+  * The first two arguments passed to &lt;code&gt;setCharacterAttributes()&lt;/code&gt; would be 0 and 3.</span>
<span class="line-added">+  * The third argument would be the AttributeSet containing the new attributes.</span>
<span class="line-added">+  * In the example we are considering, it doesn&#39;t matter what the fourth argument is.</span>
<span class="line-added">+  * &lt;p&gt;As the start and end offsets of the changed region (0 and 3) fall on</span>
<span class="line-added">+  * character Element boundaries, no structure change is needed.</span>
<span class="line-added">+  * That is, only the attributes of the character Element style 1 will change.</span>
<span class="line-added">+  * &lt;p&gt;Now let&#39;s look at an example that requires a structure change.</span>
<span class="line-added">+  * Instead of changing the first three characters shown in &lt;u&gt;Figure 9&lt;/u&gt;,</span>
<span class="line-added">+  * let&#39;s change the first two characters.</span>
<span class="line-added">+  * Because the end change offset (2) does not fall on a character Element boundary,</span>
<span class="line-added">+  * the Element at offset 2 must be split in such a way</span>
<span class="line-added">+  * that offset 2 is the boundary of two Elements.</span>
<span class="line-added">+  * Invoking &lt;code&gt;setCharacterAttributes()&lt;/code&gt; with a start offset of 0</span>
<span class="line-added">+  * and length of 2 has the result shown earlier in &lt;u&gt;Figure 10&lt;/u&gt;.</span>
<span class="line-added">+  * &lt;p&gt;&lt;b&gt;Changing Paragraph Attributes in a StyledDocument&lt;/b&gt;</span>
<span class="line-added">+  * &lt;p&gt;The StyledDocument class provides a method named &lt;code&gt;setParagraphAttributes()&lt;/code&gt;,</span>
<span class="line-added">+  * which can be used to change the attributes of a paragraph Element:</span>
<span class="line-added">+ </span>
<span class="line-added">+  *   &lt;pre&gt;&lt;code&gt; public void setParagraphAttributes</span>
<span class="line-added">+  *         (int offset, int length, AttributeSet s, boolean replace);&lt;/code&gt;&lt;/pre&gt;</span>
<span class="line-added">+  *</span>
<span class="line-added">+  *  &lt;p&gt;This method is similar to &lt;code&gt;setCharacterAttributes()&lt;/code&gt;,</span>
<span class="line-added">+  *  but it allows you to change the attributes of paragraph Elements.</span>
<span class="line-added">+  *  It is up to the implementation of a StyledDocument to define which Elements</span>
<span class="line-added">+  *  are paragraphs. DefaultStyledDocument interprets paragraph Elements</span>
<span class="line-added">+  *  to be the parent Element of the character Element.</span>
<span class="line-added">+  *  Invoking this method does not result in a structure change;</span>
<span class="line-added">+  *  only the attributes of the paragraph Element change.</span>
<span class="line-added">+  *</span>
<span class="line-added">+  * &lt;p&gt;It is recommended to look into {@link javax.swing.text.EditorKit} and</span>
<span class="line-added">+  * {@link javax.swing.text.View}.</span>
<span class="line-added">+  * View is responsible for rendering a particular Element, and</span>
<span class="line-added">+  * EditorKit is responsible for a ViewFactory that is able to decide what</span>
<span class="line-added">+  * View should be created based on an Element.</span>
   *
   * @author  Timothy Prinzing
   *
   * @see javax.swing.event.DocumentEvent
   * @see javax.swing.event.DocumentListener
</pre>
<center><a href="AbstractDocument.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ElementIterator.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>