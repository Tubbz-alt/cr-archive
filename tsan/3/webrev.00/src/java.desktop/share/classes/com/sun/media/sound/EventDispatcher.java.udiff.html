<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.desktop/share/classes/com/sun/media/sound/EventDispatcher.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DirectAudioDeviceProvider.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="FastSysexMessage.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/classes/com/sun/media/sound/EventDispatcher.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 1998, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 1998, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -98,11 +98,10 @@</span>
          int count = eventInfo.getListenerCount();
  
          // process an LineEvent
          if (eventInfo.getEvent() instanceof LineEvent) {
              LineEvent event = (LineEvent) eventInfo.getEvent();
<span class="udiff-line-removed">-             if (Printer.debug) Printer.debug(&quot;Sending &quot;+event+&quot; to &quot;+count+&quot; listeners&quot;);</span>
              for (int i = 0; i &lt; count; i++) {
                  try {
                      ((LineListener) eventInfo.getListener(i)).update(event);
                  } catch (Throwable t) {
                      if (Printer.err) t.printStackTrace();
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -239,35 +238,26 @@</span>
       *
       * This method is called in regular intervals
       */
      private void closeAutoClosingClips() {
          synchronized(autoClosingClips) {
<span class="udiff-line-removed">-             if (Printer.debug)Printer.debug(&quot;&gt; EventDispatcher.closeAutoClosingClips (&quot;+autoClosingClips.size()+&quot; clips)&quot;);</span>
              long currTime = System.currentTimeMillis();
              for (int i = autoClosingClips.size()-1; i &gt;= 0 ; i--) {
                  ClipInfo info = autoClosingClips.get(i);
                  if (info.isExpired(currTime)) {
                      AutoClosingClip clip = info.getClip();
                      // sanity check
                      if (!clip.isOpen() || !clip.isAutoClosing()) {
<span class="udiff-line-removed">-                         if (Printer.debug)Printer.debug(&quot;EventDispatcher: removing clip &quot;+clip+&quot;  isOpen:&quot;+clip.isOpen());</span>
                          autoClosingClips.remove(i);
                      }
                      else if (!clip.isRunning() &amp;&amp; !clip.isActive() &amp;&amp; clip.isAutoClosing()) {
<span class="udiff-line-removed">-                         if (Printer.debug)Printer.debug(&quot;EventDispatcher: closing clip &quot;+clip);</span>
                          clip.close();
                      } else {
<span class="udiff-line-removed">-                         if (Printer.debug)Printer.debug(&quot;Doing nothing with clip &quot;+clip+&quot;:&quot;);</span>
<span class="udiff-line-removed">-                         if (Printer.debug)Printer.debug(&quot;  open=&quot;+clip.isOpen()+&quot;, autoclosing=&quot;+clip.isAutoClosing());</span>
<span class="udiff-line-removed">-                         if (Printer.debug)Printer.debug(&quot;  isRunning=&quot;+clip.isRunning()+&quot;, isActive=&quot;+clip.isActive());</span>
                      }
<span class="udiff-line-removed">-                 } else {</span>
<span class="udiff-line-removed">-                     if (Printer.debug)Printer.debug(&quot;EventDispatcher: clip &quot;+info.getClip()+&quot; not yet expired&quot;);</span>
                  }
              }
          }
<span class="udiff-line-removed">-         if (Printer.debug)Printer.debug(&quot;&lt; EventDispatcher.closeAutoClosingClips (&quot;+autoClosingClips.size()+&quot; clips)&quot;);</span>
      }
  
      private int getAutoClosingClipIndex(AutoClosingClip clip) {
          synchronized(autoClosingClips) {
              for (int i = autoClosingClips.size()-1; i &gt;= 0; i--) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -281,16 +271,14 @@</span>
  
      /**
       * called from auto-closing clips when one of their open() method is called.
       */
      void autoClosingClipOpened(AutoClosingClip clip) {
<span class="udiff-line-removed">-         if (Printer.debug)Printer.debug(&quot;&gt; EventDispatcher.autoClosingClipOpened &quot;);</span>
          int index = 0;
          synchronized(autoClosingClips) {
              index = getAutoClosingClipIndex(clip);
              if (index == -1) {
<span class="udiff-line-removed">-                 if (Printer.debug)Printer.debug(&quot;EventDispatcher: adding auto-closing clip &quot;+clip);</span>
                  autoClosingClips.add(new ClipInfo(clip));
              }
          }
          if (index == -1) {
              synchronized (this) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -299,11 +287,10 @@</span>
                  // EventDispatcher.process() method would block in wait() and
                  // never close this first clip, keeping the device open.
                  notifyAll();
              }
          }
<span class="udiff-line-removed">-         if (Printer.debug)Printer.debug(&quot;&lt; EventDispatcher.autoClosingClipOpened finished(&quot;+autoClosingClips.size()+&quot; clips)&quot;);</span>
      }
  
      /**
       * called from auto-closing clips when their closed() method is called.
       */
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -324,52 +311,42 @@</span>
       *
       * This method is called in regular intervals
       */
      private void monitorLines() {
          synchronized(lineMonitors) {
<span class="udiff-line-removed">-             if (Printer.debug)Printer.debug(&quot;&gt; EventDispatcher.monitorLines (&quot;+lineMonitors.size()+&quot; monitors)&quot;);</span>
              for (int i = 0; i &lt; lineMonitors.size(); i++) {
                  lineMonitors.get(i).checkLine();
              }
          }
<span class="udiff-line-removed">-         if (Printer.debug)Printer.debug(&quot;&lt; EventDispatcher.monitorLines(&quot;+lineMonitors.size()+&quot; monitors)&quot;);</span>
      }
  
      /**
       * Add this LineMonitor instance to the list of monitors.
       */
      void addLineMonitor(LineMonitor lm) {
<span class="udiff-line-removed">-         if (Printer.trace)Printer.trace(&quot;&gt; EventDispatcher.addLineMonitor(&quot;+lm+&quot;)&quot;);</span>
          synchronized(lineMonitors) {
              if (lineMonitors.indexOf(lm) &gt;= 0) {
<span class="udiff-line-removed">-                 if (Printer.trace)Printer.trace(&quot;&lt; EventDispatcher.addLineMonitor finished -- this monitor already exists!&quot;);</span>
                  return;
              }
<span class="udiff-line-removed">-             if (Printer.debug)Printer.debug(&quot;EventDispatcher: adding line monitor &quot;+lm);</span>
              lineMonitors.add(lm);
          }
          synchronized (this) {
              // need to interrupt the infinite wait()
              notifyAll();
          }
<span class="udiff-line-removed">-         if (Printer.debug)Printer.debug(&quot;&lt; EventDispatcher.addLineMonitor finished -- now (&quot;+lineMonitors.size()+&quot; monitors)&quot;);</span>
      }
  
      /**
       * Remove this LineMonitor instance from the list of monitors.
       */
      void removeLineMonitor(LineMonitor lm) {
<span class="udiff-line-removed">-         if (Printer.trace)Printer.trace(&quot;&gt; EventDispatcher.removeLineMonitor(&quot;+lm+&quot;)&quot;);</span>
          synchronized(lineMonitors) {
              if (lineMonitors.indexOf(lm) &lt; 0) {
<span class="udiff-line-removed">-                 if (Printer.trace)Printer.trace(&quot;&lt; EventDispatcher.removeLineMonitor finished -- this monitor does not exist!&quot;);</span>
                  return;
              }
<span class="udiff-line-removed">-             if (Printer.debug)Printer.debug(&quot;EventDispatcher: removing line monitor &quot;+lm);</span>
              lineMonitors.remove(lm);
          }
<span class="udiff-line-removed">-         if (Printer.debug)Printer.debug(&quot;&lt; EventDispatcher.removeLineMonitor finished -- now (&quot;+lineMonitors.size()+&quot; monitors)&quot;);</span>
      }
  
      /**
       * Container for an event and a set of listeners to deliver it to.
       */
</pre>
<center><a href="DirectAudioDeviceProvider.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="FastSysexMessage.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>