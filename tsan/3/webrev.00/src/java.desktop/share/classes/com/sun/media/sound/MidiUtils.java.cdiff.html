<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/share/classes/com/sun/media/sound/MidiUtils.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MidiOutDeviceProvider.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="PCMtoPCMCodec.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/classes/com/sun/media/sound/MidiUtils.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2014, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 25,17 ***</span>
<span class="line-new-header">--- 25,21 ---</span>
  
  package com.sun.media.sound;
  
  import java.util.ArrayList;
  
<span class="line-added">+ import javax.sound.midi.InvalidMidiDataException;</span>
  import javax.sound.midi.MetaMessage;
  import javax.sound.midi.MidiDevice;
  import javax.sound.midi.MidiEvent;
  import javax.sound.midi.MidiMessage;
  import javax.sound.midi.Sequence;
  import javax.sound.midi.Track;
  
<span class="line-added">+ import static javax.sound.midi.SysexMessage.SPECIAL_SYSTEM_EXCLUSIVE;</span>
<span class="line-added">+ import static javax.sound.midi.SysexMessage.SYSTEM_EXCLUSIVE;</span>
<span class="line-added">+ </span>
  // TODO:
  // - define and use a global symbolic constant for 60000000 (see convertTempo)
  
  /**
   * Some utilities for MIDI (some stuff is used from javax.sound.midi)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 63,10 ***</span>
<span class="line-new-header">--- 67,41 ---</span>
      static RuntimeException unsupportedDevice(final MidiDevice.Info info) {
          return new IllegalArgumentException(String.format(
                  &quot;MidiDevice %s not supported by this provider&quot;, info));
      }
  
<span class="line-added">+     /**</span>
<span class="line-added">+      * Checks the status byte for the system exclusive message.</span>
<span class="line-added">+      *</span>
<span class="line-added">+      * @param  data the system exclusive message data</span>
<span class="line-added">+      * @param  length the length of the valid message data in the array</span>
<span class="line-added">+      * @throws InvalidMidiDataException if the status byte is invalid for a</span>
<span class="line-added">+      *         system exclusive message</span>
<span class="line-added">+      */</span>
<span class="line-added">+     public static void checkSysexStatus(final byte[] data, final int length)</span>
<span class="line-added">+             throws InvalidMidiDataException {</span>
<span class="line-added">+         if (data.length == 0 || length == 0) {</span>
<span class="line-added">+             throw new InvalidMidiDataException(&quot;Status byte is missing&quot;);</span>
<span class="line-added">+         }</span>
<span class="line-added">+         checkSysexStatus(data[0] &amp; 0xFF);</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
<span class="line-added">+     /**</span>
<span class="line-added">+      * Checks the status byte for the system exclusive message.</span>
<span class="line-added">+      *</span>
<span class="line-added">+      * @param  status the status byte for the message (0xF0 or 0xF7)</span>
<span class="line-added">+      * @throws InvalidMidiDataException if the status byte is invalid for a</span>
<span class="line-added">+      *         system exclusive message</span>
<span class="line-added">+      */</span>
<span class="line-added">+     public static void checkSysexStatus(final int status)</span>
<span class="line-added">+             throws InvalidMidiDataException {</span>
<span class="line-added">+         if (status != SYSTEM_EXCLUSIVE &amp;&amp; status != SPECIAL_SYSTEM_EXCLUSIVE) {</span>
<span class="line-added">+             throw new InvalidMidiDataException(String.format(</span>
<span class="line-added">+                     &quot;Invalid status byte for sysex message: 0x%X&quot;, status));</span>
<span class="line-added">+         }</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      /** return true if the passed message is Meta End Of Track */
      public static boolean isMetaEndOfTrack(MidiMessage midiMsg) {
          // first check if it is a META message at all
          if (midiMsg.getLength() != 3
              || midiMsg.getStatus() != MetaMessage.META) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 232,12 ***</span>
                  }
                  us = nextTime;
                  i++;
              }
              tick = ticks[i - 1] + microsec2ticks(micros - us, tempos[i - 1], resolution);
<span class="line-removed">-             if (Printer.debug) Printer.debug(&quot;microsecond2tick(&quot; + (micros / 1000)+&quot;) = &quot;+tick+&quot; ticks.&quot;);</span>
<span class="line-removed">-             //if (Printer.debug) Printer.debug(&quot;   -&gt; convert back = &quot; + (tick2microsecond(seq, tick, null) / 1000)+&quot; microseconds&quot;);</span>
          }
          cache.currTempo = tempos[i - 1];
          return tick;
      }
  
<span class="line-new-header">--- 267,10 ---</span>
</pre>
<center><a href="MidiOutDeviceProvider.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="PCMtoPCMCodec.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>