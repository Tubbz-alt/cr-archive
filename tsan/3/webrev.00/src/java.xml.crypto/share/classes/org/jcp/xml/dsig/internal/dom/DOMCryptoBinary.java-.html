<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/java.xml.crypto/share/classes/org/jcp/xml/dsig/internal/dom/DOMCryptoBinary.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /**
  2  * Licensed to the Apache Software Foundation (ASF) under one
  3  * or more contributor license agreements. See the NOTICE file
  4  * distributed with this work for additional information
  5  * regarding copyright ownership. The ASF licenses this file
  6  * to you under the Apache License, Version 2.0 (the
  7  * &quot;License&quot;); you may not use this file except in compliance
  8  * with the License. You may obtain a copy of the License at
  9  *
 10  * http://www.apache.org/licenses/LICENSE-2.0
 11  *
 12  * Unless required by applicable law or agreed to in writing,
 13  * software distributed under the License is distributed on an
 14  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 15  * KIND, either express or implied. See the License for the
 16  * specific language governing permissions and limitations
 17  * under the License.
 18  */
 19 /*
 20  * Copyright 2005 Sun Microsystems, Inc. All rights reserved.
 21  */
 22 /*
 23  * $Id$
 24  */
 25 package org.jcp.xml.dsig.internal.dom;
 26 
 27 import java.math.BigInteger;
 28 import javax.xml.crypto.*;
 29 import javax.xml.crypto.dom.DOMCryptoContext;
 30 
 31 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
 32 import org.w3c.dom.Node;
 33 import org.w3c.dom.Text;
 34 
 35 /**
 36  * A DOM-based representation of the XML &lt;code&gt;CryptoBinary&lt;/code&gt; simple type
 37  * as defined in the W3C specification for XML-Signature Syntax and Processing.
 38  * The XML Schema Definition is defined as:
 39  *
 40  * &lt;xmp&gt;
 41  * &lt;simpleType name=&quot;CryptoBinary&quot;&gt;
 42  *   &lt;restriction base = &quot;base64Binary&quot;&gt;
 43  *   &lt;/restriction&gt;
 44  * &lt;/simpleType&gt;
 45  * &lt;/xmp&gt;
 46  *
 47  * @author Sean Mullan
 48  */
 49 public final class DOMCryptoBinary extends DOMStructure {
 50 
 51     private final BigInteger bigNum;
 52     private final String value;
 53 
 54     /**
 55      * Create a &lt;code&gt;DOMCryptoBinary&lt;/code&gt; instance from the specified
 56      * &lt;code&gt;BigInteger&lt;/code&gt;
 57      *
 58      * @param bigNum the arbitrary-length integer
 59      * @throws NullPointerException if &lt;code&gt;bigNum&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;
 60      */
 61     public DOMCryptoBinary(BigInteger bigNum) {
 62         if (bigNum == null) {
 63             throw new NullPointerException(&quot;bigNum is null&quot;);
 64         }
 65         this.bigNum = bigNum;
 66         // convert to bitstring
 67         byte[] bytes = XMLUtils.getBytes(bigNum, bigNum.bitLength());
 68         value = XMLUtils.encodeToString(bytes);
 69     }
 70 
 71     /**
 72      * Creates a &lt;code&gt;DOMCryptoBinary&lt;/code&gt; from a node.
 73      *
 74      * @param cbNode a CryptoBinary text node
 75      * @throws MarshalException if value cannot be decoded (invalid format)
 76      */
 77     public DOMCryptoBinary(Node cbNode) throws MarshalException {
 78         value = cbNode.getNodeValue();
 79         try {
 80             bigNum = new BigInteger(1, XMLUtils.decode(((Text) cbNode).getData()));
 81         } catch (Exception ex) {
 82             throw new MarshalException(ex);
 83         }
 84     }
 85 
 86     /**
 87      * Returns the &lt;code&gt;BigInteger&lt;/code&gt; that this object contains.
 88      *
 89      * @return the &lt;code&gt;BigInteger&lt;/code&gt; that this object contains
 90      */
 91     public BigInteger getBigNum() {
 92         return bigNum;
 93     }
 94 
 95     @Override
 96     public void marshal(Node parent, String prefix, DOMCryptoContext context)
 97         throws MarshalException {
 98         parent.appendChild
 99             (DOMUtils.getOwnerDocument(parent).createTextNode(value));
100     }
101 }
    </pre>
  </body>
</html>