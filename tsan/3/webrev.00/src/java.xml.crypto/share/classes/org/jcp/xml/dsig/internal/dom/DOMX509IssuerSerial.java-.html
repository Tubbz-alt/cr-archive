<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/java.xml.crypto/share/classes/org/jcp/xml/dsig/internal/dom/DOMX509IssuerSerial.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * reserved comment block
  3  * DO NOT REMOVE OR ALTER!
  4  */
  5 /**
  6  * Licensed to the Apache Software Foundation (ASF) under one
  7  * or more contributor license agreements. See the NOTICE file
  8  * distributed with this work for additional information
  9  * regarding copyright ownership. The ASF licenses this file
 10  * to you under the Apache License, Version 2.0 (the
 11  * &quot;License&quot;); you may not use this file except in compliance
 12  * with the License. You may obtain a copy of the License at
 13  *
 14  * http://www.apache.org/licenses/LICENSE-2.0
 15  *
 16  * Unless required by applicable law or agreed to in writing,
 17  * software distributed under the License is distributed on an
 18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 19  * KIND, either express or implied. See the License for the
 20  * specific language governing permissions and limitations
 21  * under the License.
 22  */
 23 /*
 24  * Copyright (c) 2005, 2018, Oracle and/or its affiliates. All rights reserved.
 25  */
 26 /*
 27  * $Id: DOMX509IssuerSerial.java 1788465 2017-03-24 15:10:51Z coheigea $
 28  */
 29 package org.jcp.xml.dsig.internal.dom;
 30 
 31 import javax.xml.crypto.MarshalException;
 32 import javax.xml.crypto.dom.DOMCryptoContext;
 33 import javax.xml.crypto.dsig.XMLSignature;
 34 import javax.xml.crypto.dsig.keyinfo.X509IssuerSerial;
 35 
 36 import java.math.BigInteger;
 37 
 38 import javax.security.auth.x500.X500Principal;
 39 import org.w3c.dom.Document;
 40 import org.w3c.dom.Element;
 41 import org.w3c.dom.Node;
 42 
 43 /**
 44  * DOM-based implementation of X509IssuerSerial.
 45  *
 46  */
 47 public final class DOMX509IssuerSerial extends DOMStructure
 48     implements X509IssuerSerial {
 49 
 50     private final String issuerName;
 51     private final BigInteger serialNumber;
 52 
 53     /**
 54      * Creates a {@code DOMX509IssuerSerial} containing the specified
 55      * issuer distinguished name/serial number pair.
 56      *
 57      * @param issuerName the X.509 issuer distinguished name in RFC 2253
 58      *    String format
 59      * @param serialNumber the serial number
 60      * @throws IllegalArgumentException if the format of {@code issuerName}
 61      *    is not RFC 2253 compliant
 62      * @throws NullPointerException if {@code issuerName} or
 63      *    {@code serialNumber} is {@code null}
 64      */
 65     public DOMX509IssuerSerial(String issuerName, BigInteger serialNumber) {
 66         if (issuerName == null) {
 67             throw new NullPointerException(&quot;issuerName cannot be null&quot;);
 68         }
 69         if (serialNumber == null) {
 70             throw new NullPointerException(&quot;serialNumber cannot be null&quot;);
 71         }
 72         // check that issuer distinguished name conforms to RFC 2253
 73         new X500Principal(issuerName);
 74         this.issuerName = issuerName;
 75         this.serialNumber = serialNumber;
 76     }
 77 
 78     /**
 79      * Creates a {@code DOMX509IssuerSerial} from an element.
 80      *
 81      * @param isElem an X509IssuerSerial element
 82      */
 83     public DOMX509IssuerSerial(Element isElem) throws MarshalException {
 84         Element iNElem = DOMUtils.getFirstChildElement(isElem,
 85                                                        &quot;X509IssuerName&quot;,
 86                                                        XMLSignature.XMLNS);
 87         Element sNElem = DOMUtils.getNextSiblingElement(iNElem,
 88                                                         &quot;X509SerialNumber&quot;,
 89                                                         XMLSignature.XMLNS);
 90         issuerName = iNElem.getFirstChild().getNodeValue();
 91         serialNumber = new BigInteger(sNElem.getFirstChild().getNodeValue());
 92     }
 93 
 94     public String getIssuerName() {
 95         return issuerName;
 96     }
 97 
 98     public BigInteger getSerialNumber() {
 99         return serialNumber;
100     }
101 
102     @Override
103     public void marshal(Node parent, String dsPrefix, DOMCryptoContext context)
104         throws MarshalException
105     {
106         Document ownerDoc = DOMUtils.getOwnerDocument(parent);
107 
108         Element isElem = DOMUtils.createElement(ownerDoc, &quot;X509IssuerSerial&quot;,
109                                                 XMLSignature.XMLNS, dsPrefix);
110         Element inElem = DOMUtils.createElement(ownerDoc, &quot;X509IssuerName&quot;,
111                                                 XMLSignature.XMLNS, dsPrefix);
112         Element snElem = DOMUtils.createElement(ownerDoc, &quot;X509SerialNumber&quot;,
113                                                 XMLSignature.XMLNS, dsPrefix);
114         inElem.appendChild(ownerDoc.createTextNode(issuerName));
115         snElem.appendChild(ownerDoc.createTextNode(serialNumber.toString()));
116         isElem.appendChild(inElem);
117         isElem.appendChild(snElem);
118         parent.appendChild(isElem);
119     }
120 
121     @Override
122     public boolean equals(Object obj) {
123         if (this == obj) {
124             return true;
125         }
126         if (!(obj instanceof X509IssuerSerial)) {
127             return false;
128         }
129         X509IssuerSerial ois = (X509IssuerSerial)obj;
130         return issuerName.equals(ois.getIssuerName()) &amp;&amp;
131                 serialNumber.equals(ois.getSerialNumber());
132     }
133 
134     @Override
135     public int hashCode() {
136         int result = 17;
137         result = 31 * result + issuerName.hashCode();
138         result = 31 * result + serialNumber.hashCode();
139 
140         return result;
141     }
142 }
    </pre>
  </body>
</html>