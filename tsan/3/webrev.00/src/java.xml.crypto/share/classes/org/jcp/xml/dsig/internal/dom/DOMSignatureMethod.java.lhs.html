<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.xml.crypto/share/classes/org/jcp/xml/dsig/internal/dom/DOMSignatureMethod.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>   1 /*
   2  * reserved comment block
   3  * DO NOT REMOVE OR ALTER!
   4  */
   5 /**
   6  * Licensed to the Apache Software Foundation (ASF) under one
   7  * or more contributor license agreements. See the NOTICE file
   8  * distributed with this work for additional information
   9  * regarding copyright ownership. The ASF licenses this file
  10  * to you under the Apache License, Version 2.0 (the
  11  * &quot;License&quot;); you may not use this file except in compliance
  12  * with the License. You may obtain a copy of the License at
  13  *
  14  * http://www.apache.org/licenses/LICENSE-2.0
  15  *
  16  * Unless required by applicable law or agreed to in writing,
  17  * software distributed under the License is distributed on an
  18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  19  * KIND, either express or implied. See the License for the
  20  * specific language governing permissions and limitations
  21  * under the License.
  22  */
  23 /*
<a name="1" id="anc1"></a><span class="line-modified">  24  * Copyright (c) 2005, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  25  */
  26 /*
<a name="2" id="anc2"></a><span class="line-modified">  27  * $Id: DOMSignatureMethod.java 1788465 2017-03-24 15:10:51Z coheigea $</span>
  28  */
  29 package org.jcp.xml.dsig.internal.dom;
  30 
  31 import javax.xml.crypto.*;
  32 import javax.xml.crypto.dsig.*;
  33 import javax.xml.crypto.dsig.spec.SignatureMethodParameterSpec;
  34 
  35 import java.io.IOException;
  36 import java.security.*;
  37 import java.security.interfaces.DSAKey;
  38 import java.security.spec.AlgorithmParameterSpec;
  39 import java.security.spec.MGF1ParameterSpec;
  40 import java.security.spec.PSSParameterSpec;
  41 
  42 import org.w3c.dom.Element;
  43 
  44 import com.sun.org.apache.xml.internal.security.algorithms.implementations.SignatureECDSA;
  45 import com.sun.org.apache.xml.internal.security.utils.JavaUtils;
  46 import org.jcp.xml.dsig.internal.SignerOutputStream;
  47 import sun.security.util.KeyUtil;
  48 
  49 /**
  50  * DOM-based abstract implementation of SignatureMethod.
  51  *
  52  */
  53 public abstract class DOMSignatureMethod extends AbstractDOMSignatureMethod {
  54 
  55     private static final com.sun.org.slf4j.internal.Logger LOG =
  56         com.sun.org.slf4j.internal.LoggerFactory.getLogger(DOMSignatureMethod.class);
  57 
  58     private SignatureMethodParameterSpec params;
  59     private Signature signature;
  60 
  61     // see RFC 4051 for these algorithm definitions
  62     static final String RSA_SHA224 =
  63         &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha224&quot;;
  64     static final String RSA_SHA256 =
  65         &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;;
  66     static final String RSA_SHA384 =
  67         &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha384&quot;;
  68     static final String RSA_SHA512 =
  69         &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha512&quot;;
  70     static final String RSA_RIPEMD160 =
  71         &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-ripemd160&quot;;
  72     static final String ECDSA_SHA1 =
  73         &quot;http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha1&quot;;
  74     static final String ECDSA_SHA224 =
  75         &quot;http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha224&quot;;
  76     static final String ECDSA_SHA256 =
  77         &quot;http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256&quot;;
  78     static final String ECDSA_SHA384 =
  79         &quot;http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384&quot;;
  80     static final String ECDSA_SHA512 =
  81         &quot;http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512&quot;;
  82     static final String DSA_SHA256 =
  83         &quot;http://www.w3.org/2009/xmldsig11#dsa-sha256&quot;;
  84 
  85     // see RFC 6931 for these algorithm definitions
  86     static final String ECDSA_RIPEMD160 =
  87         &quot;http://www.w3.org/2007/05/xmldsig-more#ecdsa-ripemd160&quot;;
  88     static final String RSA_SHA1_MGF1 =
  89         &quot;http://www.w3.org/2007/05/xmldsig-more#sha1-rsa-MGF1&quot;;
  90     static final String RSA_SHA224_MGF1 =
  91         &quot;http://www.w3.org/2007/05/xmldsig-more#sha224-rsa-MGF1&quot;;
  92     static final String RSA_SHA256_MGF1 =
  93         &quot;http://www.w3.org/2007/05/xmldsig-more#sha256-rsa-MGF1&quot;;
  94     static final String RSA_SHA384_MGF1 =
  95         &quot;http://www.w3.org/2007/05/xmldsig-more#sha384-rsa-MGF1&quot;;
  96     static final String RSA_SHA512_MGF1 =
  97         &quot;http://www.w3.org/2007/05/xmldsig-more#sha512-rsa-MGF1&quot;;
  98     static final String RSA_RIPEMD160_MGF1 =
  99         &quot;http://www.w3.org/2007/05/xmldsig-more#ripemd160-rsa-MGF1&quot;;
 100 
 101     /**
 102      * Creates a {@code DOMSignatureMethod}.
 103      *
 104      * @param params the algorithm-specific params (may be {@code null})
 105      * @throws InvalidAlgorithmParameterException if the parameters are not
 106      *    appropriate for this signature method
 107      */
 108     DOMSignatureMethod(AlgorithmParameterSpec params)
 109         throws InvalidAlgorithmParameterException
 110     {
 111         if (params != null &amp;&amp;
 112             !(params instanceof SignatureMethodParameterSpec)) {
 113             throw new InvalidAlgorithmParameterException
 114                 (&quot;params must be of type SignatureMethodParameterSpec&quot;);
 115         }
 116         checkParams((SignatureMethodParameterSpec)params);
 117         this.params = (SignatureMethodParameterSpec)params;
 118     }
 119 
 120     /**
 121      * Creates a {@code DOMSignatureMethod} from an element. This ctor
 122      * invokes the {@link #unmarshalParams unmarshalParams} method to
 123      * unmarshal any algorithm-specific input parameters.
 124      *
 125      * @param smElem a SignatureMethod element
 126      */
 127     DOMSignatureMethod(Element smElem) throws MarshalException {
 128         Element paramsElem = DOMUtils.getFirstChildElement(smElem);
 129         if (paramsElem != null) {
 130             params = unmarshalParams(paramsElem);
 131         }
 132         try {
 133             checkParams(params);
 134         } catch (InvalidAlgorithmParameterException iape) {
 135             throw new MarshalException(iape);
 136         }
 137     }
 138 
 139     /**
 140      * Returns the signature bytes with any additional formatting
 141      * necessary for the signature algorithm used. For RSA signatures,
 142      * no changes are required, and this method should simply return
 143      * back {@code sig}. For DSA and ECDSA, this method should return the
 144      * signature in the IEEE P1363 format, the concatenation of r and s.
 145      *
 146      * @param key the key used to sign
 147      * @param sig the signature returned by {@code Signature.sign()}
 148      * @return the formatted signature
 149      * @throws IOException
 150      */
 151     abstract byte[] postSignFormat(Key key, byte[] sig) throws IOException;
 152 
 153     /**
 154      * Returns the signature bytes with any conversions that are necessary
 155      * before the signature can be verified. For RSA signatures,
 156      * no changes are required, and this method should simply
 157      * return back {@code sig}. For DSA and ECDSA, this method should
 158      * return the signature in the DER-encoded ASN.1 format.
 159      *
 160      * @param key the key used to sign
 161      * @param sig the signature
 162      * @return the formatted signature
 163      * @throws IOException
 164      */
 165     abstract byte[] preVerifyFormat(Key key, byte[] sig) throws IOException;
 166 
 167     static SignatureMethod unmarshal(Element smElem) throws MarshalException {
 168         String alg = DOMUtils.getAttributeValue(smElem, &quot;Algorithm&quot;);
 169         if (alg.equals(SignatureMethod.RSA_SHA1)) {
 170             return new SHA1withRSA(smElem);
 171         } else if (alg.equals(RSA_SHA224)) {
 172             return new SHA224withRSA(smElem);
 173         } else if (alg.equals(RSA_SHA256)) {
 174             return new SHA256withRSA(smElem);
 175         } else if (alg.equals(RSA_SHA384)) {
 176             return new SHA384withRSA(smElem);
 177         } else if (alg.equals(RSA_SHA512)) {
 178             return new SHA512withRSA(smElem);
 179         } else if (alg.equals(RSA_RIPEMD160)) {
 180             return new RIPEMD160withRSA(smElem);
 181         } else if (alg.equals(RSA_SHA1_MGF1)) {
 182             return new SHA1withRSAandMGF1(smElem);
 183         } else if (alg.equals(RSA_SHA224_MGF1)) {
 184             return new SHA224withRSAandMGF1(smElem);
 185         } else if (alg.equals(RSA_SHA256_MGF1)) {
 186             return new SHA256withRSAandMGF1(smElem);
 187         } else if (alg.equals(RSA_SHA384_MGF1)) {
 188             return new SHA384withRSAandMGF1(smElem);
 189         } else if (alg.equals(RSA_SHA512_MGF1)) {
 190             return new SHA512withRSAandMGF1(smElem);
 191         } else if (alg.equals(RSA_RIPEMD160_MGF1)) {
 192             return new RIPEMD160withRSAandMGF1(smElem);
 193         } else if (alg.equals(SignatureMethod.DSA_SHA1)) {
 194             return new SHA1withDSA(smElem);
 195         } else if (alg.equals(DSA_SHA256)) {
 196             return new SHA256withDSA(smElem);
 197         } else if (alg.equals(ECDSA_SHA1)) {
 198             return new SHA1withECDSA(smElem);
 199         } else if (alg.equals(ECDSA_SHA224)) {
 200             return new SHA224withECDSA(smElem);
 201         } else if (alg.equals(ECDSA_SHA256)) {
 202             return new SHA256withECDSA(smElem);
 203         } else if (alg.equals(ECDSA_SHA384)) {
 204             return new SHA384withECDSA(smElem);
 205         } else if (alg.equals(ECDSA_SHA512)) {
 206             return new SHA512withECDSA(smElem);
 207         } else if (alg.equals(ECDSA_RIPEMD160)) {
 208             return new RIPEMD160withECDSA(smElem);
 209         } else if (alg.equals(SignatureMethod.HMAC_SHA1)) {
 210             return new DOMHMACSignatureMethod.SHA1(smElem);
 211         } else if (alg.equals(DOMHMACSignatureMethod.HMAC_SHA224)) {
 212             return new DOMHMACSignatureMethod.SHA224(smElem);
 213         } else if (alg.equals(DOMHMACSignatureMethod.HMAC_SHA256)) {
 214             return new DOMHMACSignatureMethod.SHA256(smElem);
 215         } else if (alg.equals(DOMHMACSignatureMethod.HMAC_SHA384)) {
 216             return new DOMHMACSignatureMethod.SHA384(smElem);
 217         } else if (alg.equals(DOMHMACSignatureMethod.HMAC_SHA512)) {
 218             return new DOMHMACSignatureMethod.SHA512(smElem);
 219         } else if (alg.equals(DOMHMACSignatureMethod.HMAC_RIPEMD160)) {
 220             return new DOMHMACSignatureMethod.RIPEMD160(smElem);
 221         } else {
 222             throw new MarshalException
 223                 (&quot;unsupported SignatureMethod algorithm: &quot; + alg);
 224         }
 225     }
 226 
 227     public final AlgorithmParameterSpec getParameterSpec() {
 228         return params;
 229     }
 230 
 231     /**
 232      * Returns an instance of Signature from the specified Provider.
 233      * The algorithm is specified by the {@code getJCAAlgorithm()} method.
 234      *
 235      * @param p the Provider to use
 236      * @return an instance of Signature implementing the algorithm
 237      *    specified by {@code getJCAAlgorithm()}
 238      * @throws NoSuchAlgorithmException if the Provider does not support the
 239      *    signature algorithm
 240      */
 241     Signature getSignature(Provider p)
 242             throws NoSuchAlgorithmException {
 243         return (p == null)
 244             ? Signature.getInstance(getJCAAlgorithm())
 245             : Signature.getInstance(getJCAAlgorithm(), p);
 246     }
 247 
 248     boolean verify(Key key, SignedInfo si, byte[] sig,
 249                    XMLValidateContext context)
 250         throws InvalidKeyException, SignatureException, XMLSignatureException
 251     {
 252         if (key == null || si == null || sig == null) {
 253             throw new NullPointerException();
 254         }
 255 
 256         if (!(key instanceof PublicKey)) {
 257             throw new InvalidKeyException(&quot;key must be PublicKey&quot;);
 258         }
 259         checkKeySize(context, key);
 260         if (signature == null) {
 261             Provider p = (Provider) context.getProperty
 262                     (&quot;org.jcp.xml.dsig.internal.dom.SignatureProvider&quot;);
 263             try {
 264                 signature = getSignature(p);
 265             } catch (NoSuchAlgorithmException nsae) {
 266                 throw new XMLSignatureException(nsae);
 267             }
 268         }
 269         signature.initVerify((PublicKey)key);
 270         LOG.debug(&quot;Signature provider: {}&quot;, signature.getProvider());
 271         LOG.debug(&quot;Verifying with key: {}&quot;, key);
 272         LOG.debug(&quot;JCA Algorithm: {}&quot;, getJCAAlgorithm());
 273         LOG.debug(&quot;Signature Bytes length: {}&quot;, sig.length);
 274 
 275         byte[] s;
 276         try (SignerOutputStream outputStream = new SignerOutputStream(signature)) {
 277             ((DOMSignedInfo)si).canonicalize(context, outputStream);
 278             // Do any necessary format conversions
 279             s = preVerifyFormat(key, sig);
 280         } catch (IOException ioe) {
 281             throw new XMLSignatureException(ioe);
 282         }
 283         return signature.verify(s);
 284     }
 285 
 286     /**
 287      * If secure validation mode is enabled, checks that the key size is
 288      * restricted.
 289      *
 290      * @param context the context
 291      * @param key the key to check
 292      * @throws XMLSignatureException if the key size is restricted
 293      */
 294     private static void checkKeySize(XMLCryptoContext context, Key key)
 295         throws XMLSignatureException {
 296         if (Utils.secureValidation(context)) {
 297             int size = KeyUtil.getKeySize(key);
 298             if (size == -1) {
 299                 // key size cannot be determined, so we cannot check against
 300                 // restrictions. Note that a DSA key w/o params will be
 301                 // rejected later if the certificate chain is validated.
 302                 LOG.debug(&quot;Size for &quot; +
 303                             key.getAlgorithm() + &quot; key cannot be determined&quot;);
 304                 return;
 305             }
 306             if (Policy.restrictKey(key.getAlgorithm(), size)) {
 307                 throw new XMLSignatureException(key.getAlgorithm() +
 308                     &quot; keys less than &quot; +
 309                     Policy.minKeySize(key.getAlgorithm()) + &quot; bits are&quot; +
 310                     &quot; forbidden when secure validation is enabled&quot;);
 311             }
 312         }
 313     }
 314 
 315     byte[] sign(Key key, SignedInfo si, XMLSignContext context)
 316         throws InvalidKeyException, XMLSignatureException
 317     {
 318         if (key == null || si == null) {
 319             throw new NullPointerException();
 320         }
 321 
 322         if (!(key instanceof PrivateKey)) {
 323             throw new InvalidKeyException(&quot;key must be PrivateKey&quot;);
 324         }
 325         checkKeySize(context, key);
 326         if (signature == null) {
 327             Provider p = (Provider)context.getProperty
 328                     (&quot;org.jcp.xml.dsig.internal.dom.SignatureProvider&quot;);
 329             try {
 330                 signature = getSignature(p);
 331             } catch (NoSuchAlgorithmException nsae) {
 332                 throw new XMLSignatureException(nsae);
 333             }
 334         }
 335         signature.initSign((PrivateKey)key);
 336         LOG.debug(&quot;Signature provider: {}&quot;, signature.getProvider());
 337         LOG.debug(&quot;Signing with key: {}&quot;, key);
 338         LOG.debug(&quot;JCA Algorithm: {}&quot;, getJCAAlgorithm());
 339 
 340         try (SignerOutputStream outputStream = new SignerOutputStream(signature)) {
 341             ((DOMSignedInfo)si).canonicalize(context, outputStream);
 342             // Return signature with any necessary format conversions
 343             return postSignFormat(key, signature.sign());
 344         } catch (SignatureException | IOException ex){
 345             throw new XMLSignatureException(ex);
 346         }
 347     }
 348 
 349     abstract static class AbstractRSASignatureMethod
 350             extends DOMSignatureMethod {
 351 
 352         AbstractRSASignatureMethod(AlgorithmParameterSpec params)
 353                 throws InvalidAlgorithmParameterException {
 354             super(params);
 355         }
 356 
 357         AbstractRSASignatureMethod(Element dmElem) throws MarshalException {
 358             super(dmElem);
 359         }
 360 
 361         /**
 362          * Returns {@code sig}. No extra formatting is necessary for RSA.
 363          */
 364         @Override
 365         byte[] postSignFormat(Key key, byte[] sig) {
 366             return sig;
 367         }
 368 
 369         /**
 370          * Returns {@code sig}. No extra formatting is necessary for RSA.
 371          */
 372         @Override
 373         byte[] preVerifyFormat(Key key, byte[] sig) {
 374             return sig;
 375         }
 376     }
 377 
 378     abstract static class AbstractRSAPSSSignatureMethod
 379             extends AbstractRSASignatureMethod {
 380 
 381         AbstractRSAPSSSignatureMethod(AlgorithmParameterSpec params)
 382                 throws InvalidAlgorithmParameterException {
 383             super(params);
 384         }
 385 
 386         AbstractRSAPSSSignatureMethod(Element dmElem) throws MarshalException {
 387             super(dmElem);
 388         }
 389 
 390         abstract public PSSParameterSpec getPSSParameterSpec();
 391 
 392         @Override
 393         Signature getSignature(Provider p)
 394                 throws NoSuchAlgorithmException {
 395             try {
 396                 Signature s = (p == null)
 397                         ? Signature.getInstance(&quot;RSASSA-PSS&quot;)
 398                         : Signature.getInstance(&quot;RSASSA-PSS&quot;, p);
 399                 try {
 400                     s.setParameter(getPSSParameterSpec());
 401                 } catch (InvalidAlgorithmParameterException e) {
 402                     throw new NoSuchAlgorithmException(&quot;Should not happen&quot;, e);
 403                 }
 404                 return s;
 405             } catch (NoSuchAlgorithmException nsae) {
 406                 return (p == null)
 407                         ? Signature.getInstance(getJCAAlgorithm())
 408                         : Signature.getInstance(getJCAAlgorithm(), p);
 409             }
 410         }
 411     }
 412     /**
 413      * Abstract class to support signature algorithms that sign and verify
 414      * signatures in the IEEE P1363 format. The P1363 format is the
 415      * concatenation of r and s in DSA and ECDSA signatures, and thus, only
 416      * DSA and ECDSA signature methods should extend this class. Subclasses
 417      * must supply a fallback algorithm to be used when the provider does
 418      * not offer signature algorithms that use the P1363 format.
 419      */
 420     abstract static class AbstractP1363FormatSignatureMethod
 421             extends DOMSignatureMethod {
 422 
 423         /* Set to true when the fallback algorithm is used */
 424         boolean asn1;
 425 
 426         AbstractP1363FormatSignatureMethod(AlgorithmParameterSpec params)
 427                 throws InvalidAlgorithmParameterException {
 428             super(params);
 429         }
 430 
 431         AbstractP1363FormatSignatureMethod(Element dmElem)
 432                 throws MarshalException {
 433             super(dmElem);
 434         }
 435 
 436         /**
 437          * Return the fallback algorithm to be used when the provider does not
 438          * support signatures in the IEEE P1363 format. This algorithm should
 439          * return signatures in the DER-encoded ASN.1 format.
 440          */
 441         abstract String getJCAFallbackAlgorithm();
 442 
 443         /*
 444          * Try to return an instance of Signature implementing signatures
 445          * in the IEEE P1363 format. If the provider doesn&#39;t support the
 446          * P1363 format, return an instance of Signature implementing
 447          * signatures in the DER-encoded ASN.1 format.
 448          */
 449         @Override
 450         Signature getSignature(Provider p)
 451                 throws NoSuchAlgorithmException {
 452             try {
 453                 return (p == null)
 454                     ? Signature.getInstance(getJCAAlgorithm())
 455                     : Signature.getInstance(getJCAAlgorithm(), p);
 456             } catch (NoSuchAlgorithmException nsae) {
 457                 Signature s = (p == null)
 458                     ? Signature.getInstance(getJCAFallbackAlgorithm())
 459                     : Signature.getInstance(getJCAFallbackAlgorithm(), p);
 460                 asn1 = true;
 461                 return s;
 462             }
 463         }
 464     }
 465 
 466     abstract static class AbstractDSASignatureMethod
 467         extends AbstractP1363FormatSignatureMethod {
 468 
 469         AbstractDSASignatureMethod(AlgorithmParameterSpec params)
 470                 throws InvalidAlgorithmParameterException {
 471             super(params);
 472         }
 473 
 474         AbstractDSASignatureMethod(Element dmElem) throws MarshalException {
 475             super(dmElem);
 476         }
 477 
 478         @Override
 479         byte[] postSignFormat(Key key, byte[] sig) throws IOException {
 480             // If signature is in ASN.1 (i.e., if the fallback algorithm
 481             // was used), convert the signature to the P1363 format
 482             if (asn1) {
 483                 int size = ((DSAKey) key).getParams().getQ().bitLength();
 484                 return JavaUtils.convertDsaASN1toXMLDSIG(sig, size / 8);
 485             } else {
 486                 return sig;
 487             }
 488         }
 489 
 490         @Override
 491         byte[] preVerifyFormat(Key key, byte[] sig) throws IOException {
 492             // If signature needs to be in ASN.1 (i.e., if the fallback
 493             // algorithm will be used to verify the sig), convert the signature
 494             // to the ASN.1 format
 495             if (asn1) {
 496                 int size = ((DSAKey) key).getParams().getQ().bitLength();
 497                 return JavaUtils.convertDsaXMLDSIGtoASN1(sig, size / 8);
 498             } else {
 499                 return sig;
 500             }
 501         }
 502     }
 503 
 504     abstract static class AbstractECDSASignatureMethod
 505         extends AbstractP1363FormatSignatureMethod {
 506 
 507         AbstractECDSASignatureMethod(AlgorithmParameterSpec params)
 508                 throws InvalidAlgorithmParameterException {
 509             super(params);
 510         }
 511 
 512         AbstractECDSASignatureMethod(Element dmElem) throws MarshalException {
 513             super(dmElem);
 514         }
 515 
 516         @Override
 517         byte[] postSignFormat(Key key, byte[] sig) throws IOException {
 518             // If signature is in ASN.1 (i.e., if the fallback algorithm
 519             // was used), convert the signature to the P1363 format
 520             if (asn1) {
 521                 return SignatureECDSA.convertASN1toXMLDSIG(sig);
 522             } else {
 523                 return sig;
 524             }
 525         }
 526 
 527         @Override
 528         byte[] preVerifyFormat(Key key, byte[] sig) throws IOException {
 529             // If signature needs to be in ASN.1 (i.e., if the fallback
 530             // algorithm will be used to verify the sig), convert the signature
 531             // to the ASN.1 format
 532             if (asn1) {
 533                 return SignatureECDSA.convertXMLDSIGtoASN1(sig);
 534             } else {
 535                 return sig;
 536             }
 537         }
 538     }
 539 
 540     static final class SHA1withRSA extends AbstractRSASignatureMethod {
 541         SHA1withRSA(AlgorithmParameterSpec params)
 542             throws InvalidAlgorithmParameterException {
 543             super(params);
 544         }
 545         SHA1withRSA(Element dmElem) throws MarshalException {
 546             super(dmElem);
 547         }
 548         @Override
 549         public String getAlgorithm() {
 550             return SignatureMethod.RSA_SHA1;
 551         }
 552         @Override
 553         String getJCAAlgorithm() {
 554             return &quot;SHA1withRSA&quot;;
 555         }
 556         @Override
 557         Type getAlgorithmType() {
 558             return Type.RSA;
 559         }
 560     }
 561 
 562     static final class SHA224withRSA extends AbstractRSASignatureMethod {
 563         SHA224withRSA(AlgorithmParameterSpec params)
 564             throws InvalidAlgorithmParameterException {
 565             super(params);
 566         }
 567         SHA224withRSA(Element dmElem) throws MarshalException {
 568             super(dmElem);
 569         }
 570         public String getAlgorithm() {
 571             return RSA_SHA224;
 572         }
 573         String getJCAAlgorithm() {
 574             return &quot;SHA224withRSA&quot;;
 575         }
 576         Type getAlgorithmType() {
 577             return Type.RSA;
 578         }
 579     }
 580 
 581     static final class SHA256withRSA extends AbstractRSASignatureMethod {
 582         SHA256withRSA(AlgorithmParameterSpec params)
 583             throws InvalidAlgorithmParameterException {
 584             super(params);
 585         }
 586         SHA256withRSA(Element dmElem) throws MarshalException {
 587             super(dmElem);
 588         }
 589         public String getAlgorithm() {
 590             return RSA_SHA256;
 591         }
 592         String getJCAAlgorithm() {
 593             return &quot;SHA256withRSA&quot;;
 594         }
 595         Type getAlgorithmType() {
 596             return Type.RSA;
 597         }
 598     }
 599 
 600     static final class SHA384withRSA extends AbstractRSASignatureMethod {
 601         SHA384withRSA(AlgorithmParameterSpec params)
 602             throws InvalidAlgorithmParameterException {
 603             super(params);
 604         }
 605         SHA384withRSA(Element dmElem) throws MarshalException {
 606             super(dmElem);
 607         }
 608         public String getAlgorithm() {
 609             return RSA_SHA384;
 610         }
 611         String getJCAAlgorithm() {
 612             return &quot;SHA384withRSA&quot;;
 613         }
 614         Type getAlgorithmType() {
 615             return Type.RSA;
 616         }
 617     }
 618 
 619     static final class SHA512withRSA extends AbstractRSASignatureMethod {
 620         SHA512withRSA(AlgorithmParameterSpec params)
 621             throws InvalidAlgorithmParameterException {
 622             super(params);
 623         }
 624         SHA512withRSA(Element dmElem) throws MarshalException {
 625             super(dmElem);
 626         }
 627         public String getAlgorithm() {
 628             return RSA_SHA512;
 629         }
 630         String getJCAAlgorithm() {
 631             return &quot;SHA512withRSA&quot;;
 632         }
 633         Type getAlgorithmType() {
 634             return Type.RSA;
 635         }
 636     }
 637 
 638     static final class RIPEMD160withRSA extends AbstractRSASignatureMethod {
 639         RIPEMD160withRSA(AlgorithmParameterSpec params)
 640             throws InvalidAlgorithmParameterException {
 641             super(params);
 642         }
 643         RIPEMD160withRSA(Element dmElem) throws MarshalException {
 644             super(dmElem);
 645         }
 646         @Override
 647         public String getAlgorithm() {
 648             return RSA_RIPEMD160;
 649         }
 650         @Override
 651         String getJCAAlgorithm() {
 652             return &quot;RIPEMD160withRSA&quot;;
 653         }
 654         @Override
 655         Type getAlgorithmType() {
 656             return Type.RSA;
 657         }
 658     }
 659 
 660     static final class SHA1withRSAandMGF1 extends AbstractRSAPSSSignatureMethod {
 661 
 662         private static PSSParameterSpec spec
 663                 = new PSSParameterSpec(&quot;SHA-1&quot;, &quot;MGF1&quot;, MGF1ParameterSpec.SHA1,
 664                 20, PSSParameterSpec.TRAILER_FIELD_BC);
 665 
 666         SHA1withRSAandMGF1(AlgorithmParameterSpec params)
 667             throws InvalidAlgorithmParameterException {
 668             super(params);
 669         }
 670         SHA1withRSAandMGF1(Element dmElem) throws MarshalException {
 671             super(dmElem);
 672         }
 673         @Override
 674         public String getAlgorithm() {
 675             return RSA_SHA1_MGF1;
 676         }
 677         @Override
 678         public PSSParameterSpec getPSSParameterSpec() {
 679             return spec;
 680         }
 681         @Override
 682         String getJCAAlgorithm() {
 683             return &quot;SHA1withRSAandMGF1&quot;;
 684         }
 685         @Override
 686         Type getAlgorithmType() {
 687             return Type.RSA;
 688         }
 689     }
 690 
 691     static final class SHA224withRSAandMGF1 extends AbstractRSAPSSSignatureMethod {
 692 
 693         private static PSSParameterSpec spec
 694                 = new PSSParameterSpec(&quot;SHA-224&quot;, &quot;MGF1&quot;, MGF1ParameterSpec.SHA224,
 695                 28, PSSParameterSpec.TRAILER_FIELD_BC);
 696 
 697         SHA224withRSAandMGF1(AlgorithmParameterSpec params)
 698             throws InvalidAlgorithmParameterException {
 699             super(params);
 700         }
 701         SHA224withRSAandMGF1(Element dmElem) throws MarshalException {
 702             super(dmElem);
 703         }
 704         @Override
 705         public String getAlgorithm() {
 706             return RSA_SHA224_MGF1;
 707         }
 708         @Override
 709         public PSSParameterSpec getPSSParameterSpec() {
 710             return spec;
 711         }
 712         @Override
 713         String getJCAAlgorithm() {
 714             return &quot;SHA224withRSAandMGF1&quot;;
 715         }
 716         @Override
 717         Type getAlgorithmType() {
 718             return Type.RSA;
 719         }
 720     }
 721 
 722     static final class SHA256withRSAandMGF1 extends AbstractRSAPSSSignatureMethod {
 723 
 724         private static PSSParameterSpec spec
 725                 = new PSSParameterSpec(&quot;SHA-256&quot;, &quot;MGF1&quot;, MGF1ParameterSpec.SHA256,
 726                 32, PSSParameterSpec.TRAILER_FIELD_BC);
 727 
 728         SHA256withRSAandMGF1(AlgorithmParameterSpec params)
 729             throws InvalidAlgorithmParameterException {
 730             super(params);
 731         }
 732         SHA256withRSAandMGF1(Element dmElem) throws MarshalException {
 733             super(dmElem);
 734         }
 735         @Override
 736         public String getAlgorithm() {
 737             return RSA_SHA256_MGF1;
 738         }
 739         @Override
 740         public PSSParameterSpec getPSSParameterSpec() {
 741             return spec;
 742         }
 743         @Override
 744         String getJCAAlgorithm() {
 745             return &quot;SHA256withRSAandMGF1&quot;;
 746         }
 747         @Override
 748         Type getAlgorithmType() {
 749             return Type.RSA;
 750         }
 751     }
 752 
 753     static final class SHA384withRSAandMGF1 extends AbstractRSAPSSSignatureMethod {
 754 
 755         private static PSSParameterSpec spec
 756                 = new PSSParameterSpec(&quot;SHA-384&quot;, &quot;MGF1&quot;, MGF1ParameterSpec.SHA384,
 757                 48, PSSParameterSpec.TRAILER_FIELD_BC);
 758 
 759         SHA384withRSAandMGF1(AlgorithmParameterSpec params)
 760             throws InvalidAlgorithmParameterException {
 761             super(params);
 762         }
 763         SHA384withRSAandMGF1(Element dmElem) throws MarshalException {
 764             super(dmElem);
 765         }
 766         @Override
 767         public String getAlgorithm() {
 768             return RSA_SHA384_MGF1;
 769         }
 770         @Override
 771         public PSSParameterSpec getPSSParameterSpec() {
 772             return spec;
 773         }
 774         @Override
 775         String getJCAAlgorithm() {
 776             return &quot;SHA384withRSAandMGF1&quot;;
 777         }
 778         @Override
 779         Type getAlgorithmType() {
 780             return Type.RSA;
 781         }
 782     }
 783 
 784     static final class SHA512withRSAandMGF1 extends AbstractRSAPSSSignatureMethod {
 785 
 786         private static PSSParameterSpec spec
 787                 = new PSSParameterSpec(&quot;SHA-512&quot;, &quot;MGF1&quot;, MGF1ParameterSpec.SHA512,
 788                 64, PSSParameterSpec.TRAILER_FIELD_BC);
 789 
 790         SHA512withRSAandMGF1(AlgorithmParameterSpec params)
 791             throws InvalidAlgorithmParameterException {
 792             super(params);
 793         }
 794         SHA512withRSAandMGF1(Element dmElem) throws MarshalException {
 795             super(dmElem);
 796         }
 797         @Override
 798         public String getAlgorithm() {
 799             return RSA_SHA512_MGF1;
 800         }
 801         @Override
 802         public PSSParameterSpec getPSSParameterSpec() {
 803             return spec;
 804         }
 805         @Override
 806         String getJCAAlgorithm() {
 807             return &quot;SHA512withRSAandMGF1&quot;;
 808         }
 809         @Override
 810         Type getAlgorithmType() {
 811             return Type.RSA;
 812         }
 813     }
 814 
 815     static final class RIPEMD160withRSAandMGF1 extends AbstractRSASignatureMethod {
 816         RIPEMD160withRSAandMGF1(AlgorithmParameterSpec params)
 817             throws InvalidAlgorithmParameterException {
 818             super(params);
 819         }
 820         RIPEMD160withRSAandMGF1(Element dmElem) throws MarshalException {
 821             super(dmElem);
 822         }
 823         @Override
 824         public String getAlgorithm() {
 825             return RSA_RIPEMD160_MGF1;
 826         }
 827         @Override
 828         String getJCAAlgorithm() {
 829             return &quot;RIPEMD160withRSAandMGF1&quot;;
 830         }
 831         @Override
 832         Type getAlgorithmType() {
 833             return Type.RSA;
 834         }
 835     }
 836 
 837     static final class SHA1withDSA extends AbstractDSASignatureMethod {
 838         SHA1withDSA(AlgorithmParameterSpec params)
 839             throws InvalidAlgorithmParameterException {
 840             super(params);
 841         }
 842         SHA1withDSA(Element dmElem) throws MarshalException {
 843             super(dmElem);
 844         }
 845         public String getAlgorithm() {
 846             return SignatureMethod.DSA_SHA1;
 847         }
 848         String getJCAAlgorithm() {
 849             return &quot;SHA1withDSAinP1363Format&quot;;
 850         }
 851         String getJCAFallbackAlgorithm() {
 852             return &quot;SHA1withDSA&quot;;
 853         }
 854         Type getAlgorithmType() {
 855             return Type.DSA;
 856         }
 857     }
 858 
 859     static final class SHA256withDSA extends AbstractDSASignatureMethod {
 860         SHA256withDSA(AlgorithmParameterSpec params)
 861             throws InvalidAlgorithmParameterException {
 862             super(params);
 863         }
 864         SHA256withDSA(Element dmElem) throws MarshalException {
 865             super(dmElem);
 866         }
 867         public String getAlgorithm() {
 868             return DSA_SHA256;
 869         }
 870         String getJCAAlgorithm() {
 871             return &quot;SHA256withDSAinP1363Format&quot;;
 872         }
 873         String getJCAFallbackAlgorithm() {
 874             return &quot;SHA256withDSA&quot;;
 875         }
 876         Type getAlgorithmType() {
 877             return Type.DSA;
 878         }
 879     }
 880 
 881     static final class SHA1withECDSA extends AbstractECDSASignatureMethod {
 882         SHA1withECDSA(AlgorithmParameterSpec params)
 883             throws InvalidAlgorithmParameterException {
 884             super(params);
 885         }
 886         SHA1withECDSA(Element dmElem) throws MarshalException {
 887             super(dmElem);
 888         }
 889         public String getAlgorithm() {
 890             return ECDSA_SHA1;
 891         }
 892         String getJCAAlgorithm() {
 893             return &quot;SHA1withECDSAinP1363Format&quot;;
 894         }
 895         String getJCAFallbackAlgorithm() {
 896             return &quot;SHA1withECDSA&quot;;
 897         }
 898         Type getAlgorithmType() {
 899             return Type.ECDSA;
 900         }
 901     }
 902 
 903     static final class SHA224withECDSA extends AbstractECDSASignatureMethod {
 904         SHA224withECDSA(AlgorithmParameterSpec params)
 905             throws InvalidAlgorithmParameterException {
 906             super(params);
 907         }
 908         SHA224withECDSA(Element dmElem) throws MarshalException {
 909             super(dmElem);
 910         }
 911         @Override
 912         public String getAlgorithm() {
 913             return ECDSA_SHA224;
 914         }
 915         @Override
 916         String getJCAAlgorithm() {
 917             return &quot;SHA224withECDSAinP1363Format&quot;;
 918         }
 919         String getJCAFallbackAlgorithm() {
 920             return &quot;SHA224withECDSA&quot;;
 921         }
 922         @Override
 923         Type getAlgorithmType() {
 924             return Type.ECDSA;
 925         }
 926     }
 927 
 928     static final class SHA256withECDSA extends AbstractECDSASignatureMethod {
 929         SHA256withECDSA(AlgorithmParameterSpec params)
 930             throws InvalidAlgorithmParameterException {
 931             super(params);
 932         }
 933         SHA256withECDSA(Element dmElem) throws MarshalException {
 934             super(dmElem);
 935         }
 936         public String getAlgorithm() {
 937             return ECDSA_SHA256;
 938         }
 939         String getJCAAlgorithm() {
 940             return &quot;SHA256withECDSAinP1363Format&quot;;
 941         }
 942         String getJCAFallbackAlgorithm() {
 943             return &quot;SHA256withECDSA&quot;;
 944         }
 945         Type getAlgorithmType() {
 946             return Type.ECDSA;
 947         }
 948     }
 949 
 950     static final class SHA384withECDSA extends AbstractECDSASignatureMethod {
 951         SHA384withECDSA(AlgorithmParameterSpec params)
 952             throws InvalidAlgorithmParameterException {
 953             super(params);
 954         }
 955         SHA384withECDSA(Element dmElem) throws MarshalException {
 956             super(dmElem);
 957         }
 958         public String getAlgorithm() {
 959             return ECDSA_SHA384;
 960         }
 961         String getJCAAlgorithm() {
 962             return &quot;SHA384withECDSAinP1363Format&quot;;
 963         }
 964         String getJCAFallbackAlgorithm() {
 965             return &quot;SHA384withECDSA&quot;;
 966         }
 967         Type getAlgorithmType() {
 968             return Type.ECDSA;
 969         }
 970     }
 971 
 972     static final class SHA512withECDSA extends AbstractECDSASignatureMethod {
 973         SHA512withECDSA(AlgorithmParameterSpec params)
 974             throws InvalidAlgorithmParameterException {
 975             super(params);
 976         }
 977         SHA512withECDSA(Element dmElem) throws MarshalException {
 978             super(dmElem);
 979         }
 980         public String getAlgorithm() {
 981             return ECDSA_SHA512;
 982         }
 983         String getJCAAlgorithm() {
 984             return &quot;SHA512withECDSAinP1363Format&quot;;
 985         }
 986         String getJCAFallbackAlgorithm() {
 987             return &quot;SHA512withECDSA&quot;;
 988         }
 989         Type getAlgorithmType() {
 990             return Type.ECDSA;
 991         }
 992     }
 993 
 994     static final class RIPEMD160withECDSA extends AbstractECDSASignatureMethod {
 995         RIPEMD160withECDSA(AlgorithmParameterSpec params)
 996             throws InvalidAlgorithmParameterException {
 997             super(params);
 998         }
 999         RIPEMD160withECDSA(Element dmElem) throws MarshalException {
1000             super(dmElem);
1001         }
1002         @Override
1003         public String getAlgorithm() {
1004             return ECDSA_RIPEMD160;
1005         }
1006         @Override
1007         String getJCAAlgorithm() {
1008             return &quot;RIPEMD160withECDSAinP1363Format&quot;; // Is this real?
1009         }
1010         String getJCAFallbackAlgorithm() {
1011             return &quot;RIPEMD160withECDSA&quot;;
1012         }
1013         @Override
1014         Type getAlgorithmType() {
1015             return Type.ECDSA;
1016         }
1017     }
1018 
1019 }
<a name="3" id="anc3"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="3" type="hidden" />
</body>
</html>