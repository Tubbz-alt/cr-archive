<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/java.xml.crypto/share/classes/org/jcp/xml/dsig/internal/dom/DOMCryptoBinary.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * reserved comment block
  3  * DO NOT REMOVE OR ALTER!
  4  */
  5 /**
  6  * Licensed to the Apache Software Foundation (ASF) under one
  7  * or more contributor license agreements. See the NOTICE file
  8  * distributed with this work for additional information
  9  * regarding copyright ownership. The ASF licenses this file
 10  * to you under the Apache License, Version 2.0 (the
 11  * &quot;License&quot;); you may not use this file except in compliance
 12  * with the License. You may obtain a copy of the License at
 13  *
 14  * http://www.apache.org/licenses/LICENSE-2.0
 15  *
 16  * Unless required by applicable law or agreed to in writing,
 17  * software distributed under the License is distributed on an
 18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 19  * KIND, either express or implied. See the License for the
 20  * specific language governing permissions and limitations
 21  * under the License.
 22  */
 23 /*
 24  * Copyright (c) 2005, 2019, Oracle and/or its affiliates. All rights reserved.
 25  */
 26 /*
 27  * $Id$
 28  */
 29 package org.jcp.xml.dsig.internal.dom;
 30 
 31 import java.math.BigInteger;
 32 import javax.xml.crypto.*;
 33 import javax.xml.crypto.dom.DOMCryptoContext;
 34 
 35 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
 36 import org.w3c.dom.Node;
 37 import org.w3c.dom.Text;
 38 
 39 /**
 40  * A DOM-based representation of the XML {@code CryptoBinary} simple type
 41  * as defined in the W3C specification for XML-Signature Syntax and Processing.
 42  * The XML Schema Definition is defined as:
 43  *
 44  * &lt;pre&gt;{@code
 45  * &lt;simpleType name=&quot;CryptoBinary&quot;&gt;
 46  *   &lt;restriction base = &quot;base64Binary&quot;&gt;
 47  *   &lt;/restriction&gt;
 48  * &lt;/simpleType&gt;
 49  * }&lt;/pre&gt;
 50  *
 51  * @author Sean Mullan
 52  */
 53 public final class DOMCryptoBinary extends DOMStructure {
 54 
 55     private final BigInteger bigNum;
 56     private final String value;
 57 
 58     /**
 59      * Create a {@code DOMCryptoBinary} instance from the specified
 60      * {@code BigInteger}
 61      *
 62      * @param bigNum the arbitrary-length integer
 63      * @throws NullPointerException if {@code bigNum} is {@code null}
 64      */
 65     public DOMCryptoBinary(BigInteger bigNum) {
 66         if (bigNum == null) {
 67             throw new NullPointerException(&quot;bigNum is null&quot;);
 68         }
 69         this.bigNum = bigNum;
 70         // convert to bitstring
 71         byte[] bytes = XMLUtils.getBytes(bigNum, bigNum.bitLength());
 72         value = XMLUtils.encodeToString(bytes);
 73     }
 74 
 75     /**
 76      * Creates a {@code DOMCryptoBinary} from a node.
 77      *
 78      * @param cbNode a CryptoBinary text node
 79      * @throws MarshalException if value cannot be decoded (invalid format)
 80      */
 81     public DOMCryptoBinary(Node cbNode) throws MarshalException {
 82         value = cbNode.getNodeValue();
 83         try {
 84             bigNum = new BigInteger(1, XMLUtils.decode(((Text) cbNode).getData()));
 85         } catch (Exception ex) {
 86             throw new MarshalException(ex);
 87         }
 88     }
 89 
 90     /**
 91      * Returns the {@code BigInteger} that this object contains.
 92      *
 93      * @return the {@code BigInteger} that this object contains
 94      */
 95     public BigInteger getBigNum() {
 96         return bigNum;
 97     }
 98 
 99     @Override
100     public void marshal(Node parent, String prefix, DOMCryptoContext context)
101         throws MarshalException {
102         parent.appendChild
103             (DOMUtils.getOwnerDocument(parent).createTextNode(value));
104     }
105 }
    </pre>
  </body>
</html>