<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.xml.crypto/share/classes/org/jcp/xml/dsig/internal/dom/DOMCryptoBinary.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre><a name="1" id="anc1"></a><span class="line-added">  1 /*</span>
<span class="line-added">  2  * reserved comment block</span>
<span class="line-added">  3  * DO NOT REMOVE OR ALTER!</span>
<span class="line-added">  4  */</span>
  5 /**
  6  * Licensed to the Apache Software Foundation (ASF) under one
  7  * or more contributor license agreements. See the NOTICE file
  8  * distributed with this work for additional information
  9  * regarding copyright ownership. The ASF licenses this file
 10  * to you under the Apache License, Version 2.0 (the
 11  * &quot;License&quot;); you may not use this file except in compliance
 12  * with the License. You may obtain a copy of the License at
 13  *
 14  * http://www.apache.org/licenses/LICENSE-2.0
 15  *
 16  * Unless required by applicable law or agreed to in writing,
 17  * software distributed under the License is distributed on an
 18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 19  * KIND, either express or implied. See the License for the
 20  * specific language governing permissions and limitations
 21  * under the License.
 22  */
 23 /*
<a name="2" id="anc2"></a><span class="line-modified"> 24  * Copyright (c) 2005, 2019, Oracle and/or its affiliates. All rights reserved.</span>
 25  */
 26 /*
 27  * $Id$
 28  */
 29 package org.jcp.xml.dsig.internal.dom;
 30 
 31 import java.math.BigInteger;
 32 import javax.xml.crypto.*;
 33 import javax.xml.crypto.dom.DOMCryptoContext;
 34 
 35 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
 36 import org.w3c.dom.Node;
 37 import org.w3c.dom.Text;
 38 
 39 /**
<a name="3" id="anc3"></a><span class="line-modified"> 40  * A DOM-based representation of the XML {@code CryptoBinary} simple type</span>
 41  * as defined in the W3C specification for XML-Signature Syntax and Processing.
 42  * The XML Schema Definition is defined as:
 43  *
<a name="4" id="anc4"></a><span class="line-modified"> 44  * &lt;pre&gt;{@code</span>
 45  * &lt;simpleType name=&quot;CryptoBinary&quot;&gt;
 46  *   &lt;restriction base = &quot;base64Binary&quot;&gt;
 47  *   &lt;/restriction&gt;
 48  * &lt;/simpleType&gt;
<a name="5" id="anc5"></a><span class="line-modified"> 49  * }&lt;/pre&gt;</span>
 50  *
 51  * @author Sean Mullan
 52  */
 53 public final class DOMCryptoBinary extends DOMStructure {
 54 
 55     private final BigInteger bigNum;
 56     private final String value;
 57 
 58     /**
<a name="6" id="anc6"></a><span class="line-modified"> 59      * Create a {@code DOMCryptoBinary} instance from the specified</span>
<span class="line-modified"> 60      * {@code BigInteger}</span>
 61      *
 62      * @param bigNum the arbitrary-length integer
<a name="7" id="anc7"></a><span class="line-modified"> 63      * @throws NullPointerException if {@code bigNum} is {@code null}</span>
 64      */
 65     public DOMCryptoBinary(BigInteger bigNum) {
 66         if (bigNum == null) {
 67             throw new NullPointerException(&quot;bigNum is null&quot;);
 68         }
 69         this.bigNum = bigNum;
 70         // convert to bitstring
 71         byte[] bytes = XMLUtils.getBytes(bigNum, bigNum.bitLength());
 72         value = XMLUtils.encodeToString(bytes);
 73     }
 74 
 75     /**
<a name="8" id="anc8"></a><span class="line-modified"> 76      * Creates a {@code DOMCryptoBinary} from a node.</span>
 77      *
 78      * @param cbNode a CryptoBinary text node
 79      * @throws MarshalException if value cannot be decoded (invalid format)
 80      */
 81     public DOMCryptoBinary(Node cbNode) throws MarshalException {
 82         value = cbNode.getNodeValue();
 83         try {
 84             bigNum = new BigInteger(1, XMLUtils.decode(((Text) cbNode).getData()));
 85         } catch (Exception ex) {
 86             throw new MarshalException(ex);
 87         }
 88     }
 89 
 90     /**
<a name="9" id="anc9"></a><span class="line-modified"> 91      * Returns the {@code BigInteger} that this object contains.</span>
 92      *
<a name="10" id="anc10"></a><span class="line-modified"> 93      * @return the {@code BigInteger} that this object contains</span>
 94      */
 95     public BigInteger getBigNum() {
 96         return bigNum;
 97     }
 98 
 99     @Override
100     public void marshal(Node parent, String prefix, DOMCryptoContext context)
101         throws MarshalException {
102         parent.appendChild
103             (DOMUtils.getOwnerDocument(parent).createTextNode(value));
104     }
105 }
<a name="11" id="anc11"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="11" type="hidden" />
</body>
</html>