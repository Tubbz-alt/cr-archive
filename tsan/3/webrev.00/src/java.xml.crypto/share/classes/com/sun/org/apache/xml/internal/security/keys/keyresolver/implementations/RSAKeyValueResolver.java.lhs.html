<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/keys/keyresolver/implementations/RSAKeyValueResolver.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre> 1 /*
 2  * reserved comment block
 3  * DO NOT REMOVE OR ALTER!
 4  */
 5 /**
 6  * Licensed to the Apache Software Foundation (ASF) under one
 7  * or more contributor license agreements. See the NOTICE file
 8  * distributed with this work for additional information
 9  * regarding copyright ownership. The ASF licenses this file
10  * to you under the Apache License, Version 2.0 (the
11  * &quot;License&quot;); you may not use this file except in compliance
12  * with the License. You may obtain a copy of the License at
13  *
14  * http://www.apache.org/licenses/LICENSE-2.0
15  *
16  * Unless required by applicable law or agreed to in writing,
17  * software distributed under the License is distributed on an
18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
19  * KIND, either express or implied. See the License for the
20  * specific language governing permissions and limitations
21  * under the License.
22  */
23 package com.sun.org.apache.xml.internal.security.keys.keyresolver.implementations;
24 
25 import java.security.PublicKey;
26 import java.security.cert.X509Certificate;
27 
28 
29 import com.sun.org.apache.xml.internal.security.exceptions.XMLSecurityException;
30 import com.sun.org.apache.xml.internal.security.keys.content.keyvalues.RSAKeyValue;
31 import com.sun.org.apache.xml.internal.security.keys.keyresolver.KeyResolverSpi;
32 import com.sun.org.apache.xml.internal.security.keys.storage.StorageResolver;
33 import com.sun.org.apache.xml.internal.security.utils.Constants;
34 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
35 import org.w3c.dom.Element;
36 
37 public class RSAKeyValueResolver extends KeyResolverSpi {
38 
39     private static final com.sun.org.slf4j.internal.Logger LOG =
40         com.sun.org.slf4j.internal.LoggerFactory.getLogger(RSAKeyValueResolver.class);
41 
42 
43     /** {@inheritDoc} */
44     public PublicKey engineLookupAndResolvePublicKey(
45         Element element, String baseURI, StorageResolver storage
46     ) {
<a name="1" id="anc1"></a><span class="line-removed">47         LOG.debug(&quot;Can I resolve {}&quot;, element.getTagName());</span>
48         if (element == null) {
49             return null;
50         }
51 
<a name="2" id="anc2"></a>

52         boolean isKeyValue = XMLUtils.elementIsInSignatureSpace(element, Constants._TAG_KEYVALUE);
53         Element rsaKeyElement = null;
54         if (isKeyValue) {
55             rsaKeyElement =
56                 XMLUtils.selectDsNode(element.getFirstChild(), Constants._TAG_RSAKEYVALUE, 0);
57         } else if (XMLUtils.elementIsInSignatureSpace(element, Constants._TAG_RSAKEYVALUE)) {
58             // this trick is needed to allow the RetrievalMethodResolver to eat a
59             // ds:RSAKeyValue directly (without KeyValue)
60             rsaKeyElement = element;
61         }
62 
63         if (rsaKeyElement == null) {
64             return null;
65         }
66 
67         try {
68             RSAKeyValue rsaKeyValue = new RSAKeyValue(rsaKeyElement, baseURI);
69 
70             return rsaKeyValue.getPublicKey();
71         } catch (XMLSecurityException ex) {
72             LOG.debug(&quot;XMLSecurityException&quot;, ex);
73         }
74 
75         return null;
76     }
77 
78     /** {@inheritDoc} */
79     public X509Certificate engineLookupResolveX509Certificate(
80         Element element, String baseURI, StorageResolver storage
81     ) {
82         return null;
83     }
84 
85     /** {@inheritDoc} */
86     public javax.crypto.SecretKey engineLookupAndResolveSecretKey(
87         Element element, String baseURI, StorageResolver storage
88     ) {
89         return null;
90     }
91 }
<a name="3" id="anc3"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="3" type="hidden" />
</body>
</html>