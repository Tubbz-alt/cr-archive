<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/keys/content/KeyValue.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * reserved comment block
  3  * DO NOT REMOVE OR ALTER!
  4  */
  5 /**
  6  * Licensed to the Apache Software Foundation (ASF) under one
  7  * or more contributor license agreements. See the NOTICE file
  8  * distributed with this work for additional information
  9  * regarding copyright ownership. The ASF licenses this file
 10  * to you under the Apache License, Version 2.0 (the
 11  * &quot;License&quot;); you may not use this file except in compliance
 12  * with the License. You may obtain a copy of the License at
 13  *
 14  * http://www.apache.org/licenses/LICENSE-2.0
 15  *
 16  * Unless required by applicable law or agreed to in writing,
 17  * software distributed under the License is distributed on an
 18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 19  * KIND, either express or implied. See the License for the
 20  * specific language governing permissions and limitations
 21  * under the License.
 22  */
 23 package com.sun.org.apache.xml.internal.security.keys.content;
 24 
 25 import java.security.PublicKey;
 26 
 27 import com.sun.org.apache.xml.internal.security.exceptions.XMLSecurityException;
 28 import com.sun.org.apache.xml.internal.security.keys.content.keyvalues.DSAKeyValue;
 29 import com.sun.org.apache.xml.internal.security.keys.content.keyvalues.ECKeyValue;
 30 import com.sun.org.apache.xml.internal.security.keys.content.keyvalues.RSAKeyValue;
 31 import com.sun.org.apache.xml.internal.security.utils.Constants;
 32 import com.sun.org.apache.xml.internal.security.utils.SignatureElementProxy;
 33 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
 34 import org.w3c.dom.Document;
 35 import org.w3c.dom.Element;
 36 
 37 /**
 38  * The KeyValue element contains a single public key that may be useful in
 39  * validating the signature. Structured formats for defining DSA (REQUIRED)
 40  * and RSA (RECOMMENDED) public keys are defined in Signature Algorithms
 41  * (section 6.4). The KeyValue element may include externally defined public
 42  * keys values represented as PCDATA or element types from an external
 43  * namespace.
 44  *
 45  */
 46 public class KeyValue extends SignatureElementProxy implements KeyInfoContent {
 47 
 48     /**
 49      * Constructor KeyValue
 50      *
 51      * @param doc
 52      * @param dsaKeyValue
 53      */
 54     public KeyValue(Document doc, DSAKeyValue dsaKeyValue) {
 55         super(doc);
 56 
 57         addReturnToSelf();
 58         appendSelf(dsaKeyValue);
 59         addReturnToSelf();
 60     }
 61 
 62     /**
 63      * Constructor KeyValue
 64      *
 65      * @param doc
 66      * @param rsaKeyValue
 67      */
 68     public KeyValue(Document doc, RSAKeyValue rsaKeyValue) {
 69         super(doc);
 70 
 71         addReturnToSelf();
 72         appendSelf(rsaKeyValue);
 73         addReturnToSelf();
 74     }
 75 
 76     /**
 77      * Constructor KeyValue
 78      *
 79      * @param doc
 80      * @param unknownKeyValue
 81      */
 82     public KeyValue(Document doc, Element unknownKeyValue) {
 83         super(doc);
 84 
 85         addReturnToSelf();
 86         appendSelf(unknownKeyValue);
 87         addReturnToSelf();
 88     }
 89 
 90     /**
 91      * Constructor KeyValue
 92      *
 93      * @param doc
 94      * @param pk
 95      */
 96     public KeyValue(Document doc, PublicKey pk) {
 97         super(doc);
 98 
 99         addReturnToSelf();
100 
101         if (pk instanceof java.security.interfaces.DSAPublicKey) {
102             DSAKeyValue dsa = new DSAKeyValue(getDocument(), pk);
103 
104             appendSelf(dsa);
105             addReturnToSelf();
106         } else if (pk instanceof java.security.interfaces.RSAPublicKey) {
107             RSAKeyValue rsa = new RSAKeyValue(getDocument(), pk);
108 
109             appendSelf(rsa);
110             addReturnToSelf();
111         } else if (pk instanceof java.security.interfaces.ECPublicKey) {
112             ECKeyValue ec = new ECKeyValue(getDocument(), pk);
113 
114             appendSelf(ec);
115             addReturnToSelf();
116         } else {
117             String error = &quot;The given PublicKey type &quot; + pk + &quot; is not supported. Only DSAPublicKey and &quot;
118                 + &quot;RSAPublicKey and ECPublicKey types are currently supported&quot;;
119             throw new IllegalArgumentException(error);
120         }
121     }
122 
123     /**
124      * Constructor KeyValue
125      *
126      * @param element
127      * @param baseURI
128      * @throws XMLSecurityException
129      */
130     public KeyValue(Element element, String baseURI) throws XMLSecurityException {
131         super(element, baseURI);
132     }
133 
134     /**
135      * Method getPublicKey
136      *
137      * @return the public key
138      * @throws XMLSecurityException
139      */
140     public PublicKey getPublicKey() throws XMLSecurityException {
141         Element rsa =
142             XMLUtils.selectDsNode(
143                 getFirstChild(), Constants._TAG_RSAKEYVALUE, 0);
144 
145         if (rsa != null) {
146             RSAKeyValue kv = new RSAKeyValue(rsa, this.baseURI);
147             return kv.getPublicKey();
148         }
149 
150         Element dsa =
151             XMLUtils.selectDsNode(
152                 getFirstChild(), Constants._TAG_DSAKEYVALUE, 0);
153 
154         if (dsa != null) {
155             DSAKeyValue kv = new DSAKeyValue(dsa, this.baseURI);
156             return kv.getPublicKey();
157         }
158 
159         return null;
160     }
161 
162     /** {@inheritDoc} */
163     public String getBaseLocalName() {
164         return Constants._TAG_KEYVALUE;
165     }
166 }
    </pre>
  </body>
</html>