<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/keys/content/x509/XMLX509SKI.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../KeyValue.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../../../index.html" target="_top">index</a> <a href="../../keyresolver/KeyResolver.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/keys/content/x509/XMLX509SKI.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  7  * or more contributor license agreements. See the NOTICE file
  8  * distributed with this work for additional information
  9  * regarding copyright ownership. The ASF licenses this file
 10  * to you under the Apache License, Version 2.0 (the
 11  * &quot;License&quot;); you may not use this file except in compliance
 12  * with the License. You may obtain a copy of the License at
 13  *
 14  * http://www.apache.org/licenses/LICENSE-2.0
 15  *
 16  * Unless required by applicable law or agreed to in writing,
 17  * software distributed under the License is distributed on an
 18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 19  * KIND, either express or implied. See the License for the
 20  * specific language governing permissions and limitations
 21  * under the License.
 22  */
 23 package com.sun.org.apache.xml.internal.security.keys.content.x509;
 24 
 25 import java.security.cert.X509Certificate;
 26 import java.util.Arrays;
<span class="line-removed"> 27 import java.util.Base64;</span>
 28 
 29 import com.sun.org.apache.xml.internal.security.exceptions.XMLSecurityException;
 30 import com.sun.org.apache.xml.internal.security.utils.Constants;
 31 import com.sun.org.apache.xml.internal.security.utils.SignatureElementProxy;

 32 import org.w3c.dom.Document;
 33 import org.w3c.dom.Element;
 34 
 35 /**
 36  * Handles SubjectKeyIdentifier (SKI) for X.509v3.
 37  *
<span class="line-modified"> 38  * @see &lt;A HREF=&quot;http://docs.oracle.com/javase/1.5.0/docs/api/java/security/cert/X509Extension.html&quot;&gt;</span>
 39  * Interface X509Extension&lt;/A&gt;
 40  */
 41 public class XMLX509SKI extends SignatureElementProxy implements XMLX509DataContent {
 42 
 43     private static final com.sun.org.slf4j.internal.Logger LOG =
 44         com.sun.org.slf4j.internal.LoggerFactory.getLogger(XMLX509SKI.class);
 45 
 46     /**
 47      * {@code SubjectKeyIdentifier (id-ce-subjectKeyIdentifier) (2.5.29.14)}:
 48      * This extension identifies the public key being certified. It enables
 49      * distinct keys used by the same subject to be differentiated
 50      * (e.g., as key updating occurs).
 51      * &lt;p&gt;&lt;/p&gt;
 52      * A key identifier shall be unique with respect to all key identifiers
 53      * for the subject with which it is used. This extension is always non-critical.
 54      */
 55     public static final String SKI_OID = &quot;2.5.29.14&quot;; //NOPMD
 56 
 57     /**
 58      * Constructor X509SKI
</pre>
<hr />
<pre>
121          * (extnValue) identified by the passed-in oid String. The oid
122          * string is represented by a set of positive whole numbers
123          * separated by periods.
124          */
125         byte[] extensionValue = cert.getExtensionValue(XMLX509SKI.SKI_OID);
126         if (extensionValue == null) {
127             throw new XMLSecurityException(&quot;certificate.noSki.null&quot;);
128         }
129 
130         /**
131          * Strip away first four bytes from the extensionValue
132          * The first two bytes are the tag and length of the extensionValue
133          * OCTET STRING, and the next two bytes are the tag and length of
134          * the ski OCTET STRING.
135          */
136         byte skidValue[] = new byte[extensionValue.length - 4];
137 
138         System.arraycopy(extensionValue, 4, skidValue, 0, skidValue.length);
139 
140         if (LOG.isDebugEnabled()) {
<span class="line-modified">141             LOG.debug(&quot;Base64 of SKI is &quot; + Base64.getMimeEncoder().encodeToString(skidValue));</span>
142         }
143 
144         return skidValue;
145     }
146 
147     /** {@inheritDoc} */
148     public boolean equals(Object obj) {
149         if (!(obj instanceof XMLX509SKI)) {
150             return false;
151         }
152 
153         XMLX509SKI other = (XMLX509SKI) obj;
154 
155         try {
156             return Arrays.equals(other.getSKIBytes(), this.getSKIBytes());
157         } catch (XMLSecurityException ex) {
158             return false;
159         }
160     }
161 
</pre>
</td>
<td>
<hr />
<pre>
  7  * or more contributor license agreements. See the NOTICE file
  8  * distributed with this work for additional information
  9  * regarding copyright ownership. The ASF licenses this file
 10  * to you under the Apache License, Version 2.0 (the
 11  * &quot;License&quot;); you may not use this file except in compliance
 12  * with the License. You may obtain a copy of the License at
 13  *
 14  * http://www.apache.org/licenses/LICENSE-2.0
 15  *
 16  * Unless required by applicable law or agreed to in writing,
 17  * software distributed under the License is distributed on an
 18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 19  * KIND, either express or implied. See the License for the
 20  * specific language governing permissions and limitations
 21  * under the License.
 22  */
 23 package com.sun.org.apache.xml.internal.security.keys.content.x509;
 24 
 25 import java.security.cert.X509Certificate;
 26 import java.util.Arrays;

 27 
 28 import com.sun.org.apache.xml.internal.security.exceptions.XMLSecurityException;
 29 import com.sun.org.apache.xml.internal.security.utils.Constants;
 30 import com.sun.org.apache.xml.internal.security.utils.SignatureElementProxy;
<span class="line-added"> 31 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;</span>
 32 import org.w3c.dom.Document;
 33 import org.w3c.dom.Element;
 34 
 35 /**
 36  * Handles SubjectKeyIdentifier (SKI) for X.509v3.
 37  *
<span class="line-modified"> 38  * @see &lt;A HREF=&quot;http://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Extension.html&quot;&gt;</span>
 39  * Interface X509Extension&lt;/A&gt;
 40  */
 41 public class XMLX509SKI extends SignatureElementProxy implements XMLX509DataContent {
 42 
 43     private static final com.sun.org.slf4j.internal.Logger LOG =
 44         com.sun.org.slf4j.internal.LoggerFactory.getLogger(XMLX509SKI.class);
 45 
 46     /**
 47      * {@code SubjectKeyIdentifier (id-ce-subjectKeyIdentifier) (2.5.29.14)}:
 48      * This extension identifies the public key being certified. It enables
 49      * distinct keys used by the same subject to be differentiated
 50      * (e.g., as key updating occurs).
 51      * &lt;p&gt;&lt;/p&gt;
 52      * A key identifier shall be unique with respect to all key identifiers
 53      * for the subject with which it is used. This extension is always non-critical.
 54      */
 55     public static final String SKI_OID = &quot;2.5.29.14&quot;; //NOPMD
 56 
 57     /**
 58      * Constructor X509SKI
</pre>
<hr />
<pre>
121          * (extnValue) identified by the passed-in oid String. The oid
122          * string is represented by a set of positive whole numbers
123          * separated by periods.
124          */
125         byte[] extensionValue = cert.getExtensionValue(XMLX509SKI.SKI_OID);
126         if (extensionValue == null) {
127             throw new XMLSecurityException(&quot;certificate.noSki.null&quot;);
128         }
129 
130         /**
131          * Strip away first four bytes from the extensionValue
132          * The first two bytes are the tag and length of the extensionValue
133          * OCTET STRING, and the next two bytes are the tag and length of
134          * the ski OCTET STRING.
135          */
136         byte skidValue[] = new byte[extensionValue.length - 4];
137 
138         System.arraycopy(extensionValue, 4, skidValue, 0, skidValue.length);
139 
140         if (LOG.isDebugEnabled()) {
<span class="line-modified">141             LOG.debug(&quot;Base64 of SKI is &quot; + XMLUtils.encodeToString(skidValue));</span>
142         }
143 
144         return skidValue;
145     }
146 
147     /** {@inheritDoc} */
148     public boolean equals(Object obj) {
149         if (!(obj instanceof XMLX509SKI)) {
150             return false;
151         }
152 
153         XMLX509SKI other = (XMLX509SKI) obj;
154 
155         try {
156             return Arrays.equals(other.getSKIBytes(), this.getSKIBytes());
157         } catch (XMLSecurityException ex) {
158             return false;
159         }
160     }
161 
</pre>
</td>
</tr>
</table>
<center><a href="../KeyValue.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../../../index.html" target="_top">index</a> <a href="../../keyresolver/KeyResolver.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>