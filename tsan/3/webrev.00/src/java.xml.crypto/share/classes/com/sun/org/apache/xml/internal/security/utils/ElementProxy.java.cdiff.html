<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/utils/ElementProxy.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Constants.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../index.html" target="_top">index</a> <a href="Signature11ElementProxy.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/utils/ElementProxy.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 22,11 ***</span>
   */
  package com.sun.org.apache.xml.internal.security.utils;
  
  import java.math.BigInteger;
  import java.util.concurrent.ConcurrentHashMap;
<span class="line-removed">- import java.util.Base64;</span>
  import java.util.Map;
  
  import com.sun.org.apache.xml.internal.security.exceptions.XMLSecurityException;
  import org.w3c.dom.Attr;
  import org.w3c.dom.Document;
<span class="line-new-header">--- 22,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 265,11 ***</span>
      public void addBigIntegerElement(BigInteger bi, String localname) {
          if (bi != null) {
              Element e = XMLUtils.createElementInSignatureSpace(getDocument(), localname);
  
              byte[] bytes = XMLUtils.getBytes(bi, bi.bitLength());
<span class="line-modified">!             String encodedInt = Base64.getMimeEncoder().encodeToString(bytes);</span>
  
              Document doc = e.getOwnerDocument();
              Text text = doc.createTextNode(encodedInt);
  
              e.appendChild(text);
<span class="line-new-header">--- 264,11 ---</span>
      public void addBigIntegerElement(BigInteger bi, String localname) {
          if (bi != null) {
              Element e = XMLUtils.createElementInSignatureSpace(getDocument(), localname);
  
              byte[] bytes = XMLUtils.getBytes(bi, bi.bitLength());
<span class="line-modified">!             String encodedInt = XMLUtils.encodeToString(bytes);</span>
  
              Document doc = e.getOwnerDocument();
              Text text = doc.createTextNode(encodedInt);
  
              e.appendChild(text);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 290,11 ***</span>
       * @param localname
       */
      public void addBase64Element(byte[] bytes, String localname) {
          if (bytes != null) {
              Element el = XMLUtils.createElementInSignatureSpace(getDocument(), localname);
<span class="line-modified">!             Text text = getDocument().createTextNode(Base64.getMimeEncoder().encodeToString(bytes));</span>
  
              el.appendChild(text);
  
              appendSelf(el);
              if (!XMLUtils.ignoreLineBreaks()) {
<span class="line-new-header">--- 289,11 ---</span>
       * @param localname
       */
      public void addBase64Element(byte[] bytes, String localname) {
          if (bytes != null) {
              Element el = XMLUtils.createElementInSignatureSpace(getDocument(), localname);
<span class="line-modified">!             Text text = getDocument().createTextNode(XMLUtils.encodeToString(bytes));</span>
  
              el.appendChild(text);
  
              appendSelf(el);
              if (!XMLUtils.ignoreLineBreaks()) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 324,12 ***</span>
       * @param bytes
       */
      public void addBase64Text(byte[] bytes) {
          if (bytes != null) {
              Text t = XMLUtils.ignoreLineBreaks()
<span class="line-modified">!                 ? createText(Base64.getMimeEncoder().encodeToString(bytes))</span>
<span class="line-modified">!                 : createText(&quot;\n&quot; + Base64.getMimeEncoder().encodeToString(bytes) + &quot;\n&quot;);</span>
              appendSelf(t);
          }
      }
  
      protected void appendSelf(ElementProxy toAppend) {
<span class="line-new-header">--- 323,12 ---</span>
       * @param bytes
       */
      public void addBase64Text(byte[] bytes) {
          if (bytes != null) {
              Text t = XMLUtils.ignoreLineBreaks()
<span class="line-modified">!                 ? createText(XMLUtils.encodeToString(bytes))</span>
<span class="line-modified">!                 : createText(&quot;\n&quot; + XMLUtils.encodeToString(bytes) + &quot;\n&quot;);</span>
              appendSelf(t);
          }
      }
  
      protected void appendSelf(ElementProxy toAppend) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 365,15 ***</span>
       * @return The biginteger contained in the given element
       */
      public BigInteger getBigIntegerFromChildElement(
          String localname, String namespace
      ) {
<span class="line-modified">!         return new BigInteger(1, Base64.getMimeDecoder().decode(</span>
<span class="line-modified">!             XMLUtils.selectNodeText(</span>
<span class="line-modified">!                 getFirstChild(), namespace, localname, 0</span>
<span class="line-modified">!             ).getNodeValue()</span>
<span class="line-modified">!         ));</span>
      }
  
      /**
       * Method getTextFromChildElement
       *
<span class="line-new-header">--- 364,15 ---</span>
       * @return The biginteger contained in the given element
       */
      public BigInteger getBigIntegerFromChildElement(
          String localname, String namespace
      ) {
<span class="line-modified">!         Node n = XMLUtils.selectNode(getFirstChild(), namespace, localname, 0);</span>
<span class="line-modified">!         if (n != null) {</span>
<span class="line-modified">!             return new BigInteger(1, XMLUtils.decode(XMLUtils.getFullTextChildrenFromNode(n)));</span>
<span class="line-modified">!         }</span>
<span class="line-modified">!         return null;</span>
      }
  
      /**
       * Method getTextFromChildElement
       *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 394,21 ***</span>
       *
       * @return The base64 bytes from the text children of this element
       * @throws XMLSecurityException
       */
      public byte[] getBytesFromTextChild() throws XMLSecurityException {
<span class="line-modified">!         return Base64.getMimeDecoder().decode(getTextFromTextChild());</span>
      }
  
      /**
       * Method getTextFromTextChild
       *
       * @return the Text obtained by concatenating all the text nodes of this
       *    element
       */
      public String getTextFromTextChild() {
<span class="line-modified">!         return XMLUtils.getFullTextChildrenFromElement(getElement());</span>
      }
  
      /**
       * Method length
       *
<span class="line-new-header">--- 393,21 ---</span>
       *
       * @return The base64 bytes from the text children of this element
       * @throws XMLSecurityException
       */
      public byte[] getBytesFromTextChild() throws XMLSecurityException {
<span class="line-modified">!         return XMLUtils.decode(getTextFromTextChild());</span>
      }
  
      /**
       * Method getTextFromTextChild
       *
       * @return the Text obtained by concatenating all the text nodes of this
       *    element
       */
      public String getTextFromTextChild() {
<span class="line-modified">!         return XMLUtils.getFullTextChildrenFromNode(getElement());</span>
      }
  
      /**
       * Method length
       *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 496,12 ***</span>
              }
          }
  
          if (Constants.SignatureSpecNS.equals(namespace)) {
              XMLUtils.setDsPrefix(prefix);
<span class="line-modified">!         }</span>
<span class="line-modified">!         if (EncryptionConstants.EncryptionSpecNS.equals(namespace)) {</span>
              XMLUtils.setXencPrefix(prefix);
          }
          prefixMappings.put(namespace, prefix);
      }
  
<span class="line-new-header">--- 495,13 ---</span>
              }
          }
  
          if (Constants.SignatureSpecNS.equals(namespace)) {
              XMLUtils.setDsPrefix(prefix);
<span class="line-modified">!         } else if (Constants.SignatureSpec11NS.equals(namespace)) {</span>
<span class="line-modified">!             XMLUtils.setDs11Prefix(prefix);</span>
<span class="line-added">+         } else if (EncryptionConstants.EncryptionSpecNS.equals(namespace)) {</span>
              XMLUtils.setXencPrefix(prefix);
          }
          prefixMappings.put(namespace, prefix);
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 517,10 ***</span>
<span class="line-new-header">--- 517,11 ---</span>
          setNamespacePrefix(&quot;http://www.w3.org/2002/06/xmldsig-filter2&quot;, &quot;dsig-xpath&quot;);
          setNamespacePrefix(&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;, &quot;ec&quot;);
          setNamespacePrefix(
              &quot;http://www.nue.et-inf.uni-siegen.de/~geuer-pollmann/#xpathFilter&quot;, &quot;xx&quot;
          );
<span class="line-added">+         setNamespacePrefix(&quot;http://www.w3.org/2009/xmldsig11#&quot;, &quot;dsig11&quot;);</span>
      }
  
      /**
       * Method getDefaultPrefix
       *
</pre>
<center><a href="Constants.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../index.html" target="_top">index</a> <a href="Signature11ElementProxy.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>