<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/keys/keyresolver/implementations/RSAKeyValueResolver.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre> 1 /*
 2  * reserved comment block
 3  * DO NOT REMOVE OR ALTER!
 4  */
 5 /**
 6  * Licensed to the Apache Software Foundation (ASF) under one
 7  * or more contributor license agreements. See the NOTICE file
 8  * distributed with this work for additional information
 9  * regarding copyright ownership. The ASF licenses this file
10  * to you under the Apache License, Version 2.0 (the
11  * &quot;License&quot;); you may not use this file except in compliance
12  * with the License. You may obtain a copy of the License at
13  *
14  * http://www.apache.org/licenses/LICENSE-2.0
15  *
16  * Unless required by applicable law or agreed to in writing,
17  * software distributed under the License is distributed on an
18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
19  * KIND, either express or implied. See the License for the
20  * specific language governing permissions and limitations
21  * under the License.
22  */
23 package com.sun.org.apache.xml.internal.security.keys.keyresolver.implementations;
24 
25 import java.security.PublicKey;
26 import java.security.cert.X509Certificate;
27 
28 
29 import com.sun.org.apache.xml.internal.security.exceptions.XMLSecurityException;
30 import com.sun.org.apache.xml.internal.security.keys.content.keyvalues.RSAKeyValue;
31 import com.sun.org.apache.xml.internal.security.keys.keyresolver.KeyResolverSpi;
32 import com.sun.org.apache.xml.internal.security.keys.storage.StorageResolver;
33 import com.sun.org.apache.xml.internal.security.utils.Constants;
34 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
35 import org.w3c.dom.Element;
36 
37 public class RSAKeyValueResolver extends KeyResolverSpi {
38 
39     private static final com.sun.org.slf4j.internal.Logger LOG =
40         com.sun.org.slf4j.internal.LoggerFactory.getLogger(RSAKeyValueResolver.class);
41 
42 
43     /** {@inheritDoc} */
44     public PublicKey engineLookupAndResolvePublicKey(
45         Element element, String baseURI, StorageResolver storage
46     ) {
<a name="1" id="anc1"></a>
47         if (element == null) {
48             return null;
49         }
50 
<a name="2" id="anc2"></a><span class="line-added">51         LOG.debug(&quot;Can I resolve {}&quot;, element.getTagName());</span>
<span class="line-added">52 </span>
53         boolean isKeyValue = XMLUtils.elementIsInSignatureSpace(element, Constants._TAG_KEYVALUE);
54         Element rsaKeyElement = null;
55         if (isKeyValue) {
56             rsaKeyElement =
57                 XMLUtils.selectDsNode(element.getFirstChild(), Constants._TAG_RSAKEYVALUE, 0);
58         } else if (XMLUtils.elementIsInSignatureSpace(element, Constants._TAG_RSAKEYVALUE)) {
59             // this trick is needed to allow the RetrievalMethodResolver to eat a
60             // ds:RSAKeyValue directly (without KeyValue)
61             rsaKeyElement = element;
62         }
63 
64         if (rsaKeyElement == null) {
65             return null;
66         }
67 
68         try {
69             RSAKeyValue rsaKeyValue = new RSAKeyValue(rsaKeyElement, baseURI);
70 
71             return rsaKeyValue.getPublicKey();
72         } catch (XMLSecurityException ex) {
73             LOG.debug(&quot;XMLSecurityException&quot;, ex);
74         }
75 
76         return null;
77     }
78 
79     /** {@inheritDoc} */
80     public X509Certificate engineLookupResolveX509Certificate(
81         Element element, String baseURI, StorageResolver storage
82     ) {
83         return null;
84     }
85 
86     /** {@inheritDoc} */
87     public javax.crypto.SecretKey engineLookupAndResolveSecretKey(
88         Element element, String baseURI, StorageResolver storage
89     ) {
90         return null;
91     }
92 }
<a name="3" id="anc3"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="3" type="hidden" />
</body>
</html>