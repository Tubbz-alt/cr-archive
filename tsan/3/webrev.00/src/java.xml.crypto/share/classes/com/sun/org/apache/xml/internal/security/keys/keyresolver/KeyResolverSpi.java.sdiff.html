<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/keys/keyresolver/KeyResolverSpi.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="KeyResolver.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../../index.html" target="_top">index</a> <a href="implementations/RSAKeyValueResolver.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/keys/keyresolver/KeyResolverSpi.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 14  * http://www.apache.org/licenses/LICENSE-2.0
 15  *
 16  * Unless required by applicable law or agreed to in writing,
 17  * software distributed under the License is distributed on an
 18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 19  * KIND, either express or implied. See the License for the
 20  * specific language governing permissions and limitations
 21  * under the License.
 22  */
 23 package com.sun.org.apache.xml.internal.security.keys.keyresolver;
 24 
 25 import java.io.ByteArrayInputStream;
 26 import java.io.IOException;
 27 import java.io.InputStream;
 28 import java.security.PrivateKey;
 29 import java.security.PublicKey;
 30 import java.security.cert.X509Certificate;
 31 import java.util.HashMap;
 32 
 33 import javax.crypto.SecretKey;
<span class="line-removed"> 34 import javax.xml.parsers.DocumentBuilder;</span>
 35 import javax.xml.parsers.ParserConfigurationException;
 36 
 37 import com.sun.org.apache.xml.internal.security.keys.storage.StorageResolver;
 38 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
 39 import org.w3c.dom.Document;
 40 import org.w3c.dom.Element;
 41 import org.xml.sax.SAXException;
 42 
 43 /**
 44  * This class is an abstract class for a child KeyInfo Element.
 45  *
 46  * If you want the your KeyResolver, at firstly you must extend this class, and register
 47  * as following in config.xml
 48  * &lt;PRE&gt;
 49  *  &amp;lt;KeyResolver URI=&quot;http://www.w3.org/2000/09/xmldsig#KeyValue&quot;
 50  *   JAVACLASS=&quot;MyPackage.MyKeyValueImpl&quot;//gt;
 51  * &lt;/PRE&gt;
 52  */
 53 public abstract class KeyResolverSpi {
 54 
</pre>
<hr />
<pre>
259         if (properties == null) {
260             return false;
261         }
262 
263         return properties.get(propertyToTest) != null;
264     }
265 
266     public void setGlobalResolver(boolean globalResolver) {
267         this.globalResolver = globalResolver;
268     }
269 
270 
271     /**
272      * Parses a byte array and returns the parsed Element.
273      *
274      * @param bytes
275      * @return the Document Element after parsing bytes
276      * @throws KeyResolverException if something goes wrong
277      */
278     protected static Element getDocFromBytes(byte[] bytes, boolean secureValidation) throws KeyResolverException {
<span class="line-removed">279         DocumentBuilder db = null;</span>
280         try (InputStream is = new ByteArrayInputStream(bytes)) {
<span class="line-modified">281             db = XMLUtils.createDocumentBuilder(false, secureValidation);</span>
<span class="line-removed">282             Document doc = db.parse(is);</span>
283             return doc.getDocumentElement();
284         } catch (SAXException ex) {
285             throw new KeyResolverException(ex);
286         } catch (IOException ex) {
287             throw new KeyResolverException(ex);
288         } catch (ParserConfigurationException ex) {
289             throw new KeyResolverException(ex);
290         }
291     }
292 
293 }
</pre>
</td>
<td>
<hr />
<pre>
 14  * http://www.apache.org/licenses/LICENSE-2.0
 15  *
 16  * Unless required by applicable law or agreed to in writing,
 17  * software distributed under the License is distributed on an
 18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 19  * KIND, either express or implied. See the License for the
 20  * specific language governing permissions and limitations
 21  * under the License.
 22  */
 23 package com.sun.org.apache.xml.internal.security.keys.keyresolver;
 24 
 25 import java.io.ByteArrayInputStream;
 26 import java.io.IOException;
 27 import java.io.InputStream;
 28 import java.security.PrivateKey;
 29 import java.security.PublicKey;
 30 import java.security.cert.X509Certificate;
 31 import java.util.HashMap;
 32 
 33 import javax.crypto.SecretKey;

 34 import javax.xml.parsers.ParserConfigurationException;
 35 
 36 import com.sun.org.apache.xml.internal.security.keys.storage.StorageResolver;
 37 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
 38 import org.w3c.dom.Document;
 39 import org.w3c.dom.Element;
 40 import org.xml.sax.SAXException;
 41 
 42 /**
 43  * This class is an abstract class for a child KeyInfo Element.
 44  *
 45  * If you want the your KeyResolver, at firstly you must extend this class, and register
 46  * as following in config.xml
 47  * &lt;PRE&gt;
 48  *  &amp;lt;KeyResolver URI=&quot;http://www.w3.org/2000/09/xmldsig#KeyValue&quot;
 49  *   JAVACLASS=&quot;MyPackage.MyKeyValueImpl&quot;//gt;
 50  * &lt;/PRE&gt;
 51  */
 52 public abstract class KeyResolverSpi {
 53 
</pre>
<hr />
<pre>
258         if (properties == null) {
259             return false;
260         }
261 
262         return properties.get(propertyToTest) != null;
263     }
264 
265     public void setGlobalResolver(boolean globalResolver) {
266         this.globalResolver = globalResolver;
267     }
268 
269 
270     /**
271      * Parses a byte array and returns the parsed Element.
272      *
273      * @param bytes
274      * @return the Document Element after parsing bytes
275      * @throws KeyResolverException if something goes wrong
276      */
277     protected static Element getDocFromBytes(byte[] bytes, boolean secureValidation) throws KeyResolverException {

278         try (InputStream is = new ByteArrayInputStream(bytes)) {
<span class="line-modified">279             Document doc = XMLUtils.read(is, secureValidation);</span>

280             return doc.getDocumentElement();
281         } catch (SAXException ex) {
282             throw new KeyResolverException(ex);
283         } catch (IOException ex) {
284             throw new KeyResolverException(ex);
285         } catch (ParserConfigurationException ex) {
286             throw new KeyResolverException(ex);
287         }
288     }
289 
290 }
</pre>
</td>
</tr>
</table>
<center><a href="KeyResolver.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../../index.html" target="_top">index</a> <a href="implementations/RSAKeyValueResolver.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>