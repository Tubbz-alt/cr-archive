<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/c14n/CanonicalizerSpi.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * reserved comment block
  3  * DO NOT REMOVE OR ALTER!
  4  */
  5 /**
  6  * Licensed to the Apache Software Foundation (ASF) under one
  7  * or more contributor license agreements. See the NOTICE file
  8  * distributed with this work for additional information
  9  * regarding copyright ownership. The ASF licenses this file
 10  * to you under the Apache License, Version 2.0 (the
 11  * &quot;License&quot;); you may not use this file except in compliance
 12  * with the License. You may obtain a copy of the License at
 13  *
 14  * http://www.apache.org/licenses/LICENSE-2.0
 15  *
 16  * Unless required by applicable law or agreed to in writing,
 17  * software distributed under the License is distributed on an
 18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 19  * KIND, either express or implied. See the License for the
 20  * specific language governing permissions and limitations
 21  * under the License.
 22  */
 23 package com.sun.org.apache.xml.internal.security.c14n;
 24 
 25 import java.io.ByteArrayInputStream;
 26 import java.io.OutputStream;
 27 import java.util.Set;
 28 
 29 import javax.xml.parsers.DocumentBuilder;
 30 
 31 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
 32 import org.w3c.dom.Document;
 33 import org.w3c.dom.Node;
 34 import org.w3c.dom.NodeList;
 35 import org.xml.sax.InputSource;
 36 
 37 /**
 38  * Base class which all Canonicalization algorithms extend.
 39  *
 40  */
 41 public abstract class CanonicalizerSpi {
 42 
 43     /** Reset the writer after a c14n */
 44     protected boolean reset = false;
 45     protected boolean secureValidation;
 46 
 47     /**
 48      * Method canonicalize
 49      *
 50      * @param inputBytes
 51      * @return the c14n bytes.
 52      *
 53      * @throws CanonicalizationException
 54      * @throws java.io.IOException
 55      * @throws javax.xml.parsers.ParserConfigurationException
 56      * @throws org.xml.sax.SAXException
 57      */
 58     public byte[] engineCanonicalize(byte[] inputBytes)
 59         throws javax.xml.parsers.ParserConfigurationException, java.io.IOException,
 60         org.xml.sax.SAXException, CanonicalizationException {
 61 
 62         Document document = null;
 63         try (java.io.InputStream bais = new ByteArrayInputStream(inputBytes)) {
 64             InputSource in = new InputSource(bais);
 65 
 66             DocumentBuilder db = XMLUtils.createDocumentBuilder(false, secureValidation);
 67 
 68             document = db.parse(in);
 69         }
 70         return this.engineCanonicalizeSubTree(document);
 71     }
 72 
 73     /**
 74      * Method engineCanonicalizeXPathNodeSet
 75      *
 76      * @param xpathNodeSet
 77      * @return the c14n bytes
 78      * @throws CanonicalizationException
 79      */
 80     public byte[] engineCanonicalizeXPathNodeSet(NodeList xpathNodeSet)
 81         throws CanonicalizationException {
 82         return this.engineCanonicalizeXPathNodeSet(
 83             XMLUtils.convertNodelistToSet(xpathNodeSet)
 84         );
 85     }
 86 
 87     /**
 88      * Method engineCanonicalizeXPathNodeSet
 89      *
 90      * @param xpathNodeSet
 91      * @param inclusiveNamespaces
 92      * @return the c14n bytes
 93      * @throws CanonicalizationException
 94      */
 95     public byte[] engineCanonicalizeXPathNodeSet(NodeList xpathNodeSet, String inclusiveNamespaces)
 96         throws CanonicalizationException {
 97         return this.engineCanonicalizeXPathNodeSet(
 98             XMLUtils.convertNodelistToSet(xpathNodeSet), inclusiveNamespaces
 99         );
100     }
101 
102     /**
103      * Returns the URI of this engine.
104      * @return the URI
105      */
106     public abstract String engineGetURI();
107 
108     /**
109      * Returns true if comments are included
110      * @return true if comments are included
111      */
112     public abstract boolean engineGetIncludeComments();
113 
114     /**
115      * C14n a nodeset
116      *
117      * @param xpathNodeSet
118      * @return the c14n bytes
119      * @throws CanonicalizationException
120      */
121     public abstract byte[] engineCanonicalizeXPathNodeSet(Set&lt;Node&gt; xpathNodeSet)
122         throws CanonicalizationException;
123 
124     /**
125      * C14n a nodeset
126      *
127      * @param xpathNodeSet
128      * @param inclusiveNamespaces
129      * @return the c14n bytes
130      * @throws CanonicalizationException
131      */
132     public abstract byte[] engineCanonicalizeXPathNodeSet(
133         Set&lt;Node&gt; xpathNodeSet, String inclusiveNamespaces
134     ) throws CanonicalizationException;
135 
136     /**
137      * C14n a node tree.
138      *
139      * @param rootNode
140      * @return the c14n bytes
141      * @throws CanonicalizationException
142      */
143     public abstract byte[] engineCanonicalizeSubTree(Node rootNode)
144         throws CanonicalizationException;
145 
146     /**
147      * C14n a node tree.
148      *
149      * @param rootNode
150      * @param inclusiveNamespaces
151      * @return the c14n bytes
152      * @throws CanonicalizationException
153      */
154     public abstract byte[] engineCanonicalizeSubTree(Node rootNode, String inclusiveNamespaces)
155         throws CanonicalizationException;
156 
157     /**
158      * C14n a node tree.
159      *
160      * @param rootNode
161      * @param inclusiveNamespaces
162      * @param propagateDefaultNamespace If true the default namespace will be propagated to the c14n-ized root element
163      * @return the c14n bytes
164      * @throws CanonicalizationException
165      */
166     public abstract byte[] engineCanonicalizeSubTree(
167             Node rootNode, String inclusiveNamespaces, boolean propagateDefaultNamespace)
168             throws CanonicalizationException;
169 
170     /**
171      * Sets the writer where the canonicalization ends. ByteArrayOutputStream if
172      * none is set.
173      * @param os
174      */
175     public abstract void setWriter(OutputStream os);
176 
177     public boolean isSecureValidation() {
178         return secureValidation;
179     }
180 
181     public void setSecureValidation(boolean secureValidation) {
182         this.secureValidation = secureValidation;
183     }
184 
185 }
    </pre>
  </body>
</html>