<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/transforms/params/XPathFilterCHGPContainer.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../implementations/TransformXSLT.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../../index.html" target="_top">index</a> <a href="../../utils/Constants.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/transforms/params/XPathFilterCHGPContainer.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 13  *
 14  * http://www.apache.org/licenses/LICENSE-2.0
 15  *
 16  * Unless required by applicable law or agreed to in writing,
 17  * software distributed under the License is distributed on an
 18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 19  * KIND, either express or implied. See the License for the
 20  * specific language governing permissions and limitations
 21  * under the License.
 22  */
 23 package com.sun.org.apache.xml.internal.security.transforms.params;
 24 
 25 
 26 import com.sun.org.apache.xml.internal.security.exceptions.XMLSecurityException;
 27 import com.sun.org.apache.xml.internal.security.transforms.TransformParam;
 28 import com.sun.org.apache.xml.internal.security.utils.ElementProxy;
 29 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
 30 import org.w3c.dom.Document;
 31 import org.w3c.dom.Element;
 32 import org.w3c.dom.Node;

 33 
 34 /**
 35  * Implements the parameters for a custom Transform which has a better performance
 36  * than the xfilter2.
 37  *
 38  */
 39 public class XPathFilterCHGPContainer extends ElementProxy implements TransformParam {
 40 
 41     public static final String TRANSFORM_XPATHFILTERCHGP =
 42         &quot;http://www.nue.et-inf.uni-siegen.de/~geuer-pollmann/#xpathFilter&quot;;
 43 
 44     /** Field _ATT_FILTER_VALUE_INTERSECT */
 45     private static final String _TAG_INCLUDE_BUT_SEARCH = &quot;IncludeButSearch&quot;;
 46 
 47     /** Field _ATT_FILTER_VALUE_SUBTRACT */
 48     private static final String _TAG_EXCLUDE_BUT_SEARCH = &quot;ExcludeButSearch&quot;;
 49 
 50     /** Field _ATT_FILTER_VALUE_UNION */
 51     private static final String _TAG_EXCLUDE = &quot;Exclude&quot;;
 52 
</pre>
<hr />
<pre>
187     ) throws XMLSecurityException {
188         return new XPathFilterCHGPContainer(element, baseURI);
189     }
190 
191     /**
192      * Method getXStr
193      *
194      * @param type
195      * @return The Xstr
196      */
197     private String getXStr(String type) {
198         if (this.length(this.getBaseNamespace(), type) != 1) {
199             return &quot;&quot;;
200         }
201 
202         Element xElem =
203             XMLUtils.selectNode(
204                 getElement().getFirstChild(), this.getBaseNamespace(), type, 0
205             );
206 
<span class="line-modified">207         return XMLUtils.getFullTextChildrenFromElement(xElem);</span>
208     }
209 
210     /**
211      * Method getIncludeButSearch
212      *
213      * @return the string
214      */
215     public String getIncludeButSearch() {
216         return this.getXStr(XPathFilterCHGPContainer._TAG_INCLUDE_BUT_SEARCH);
217     }
218 
219     /**
220      * Method getExcludeButSearch
221      *
222      * @return the string
223      */
224     public String getExcludeButSearch() {
225         return this.getXStr(XPathFilterCHGPContainer._TAG_EXCLUDE_BUT_SEARCH);
226     }
227 
</pre>
<hr />
<pre>
241      */
242     public boolean getIncludeSlashPolicy() {
243         return getLocalAttribute(XPathFilterCHGPContainer._ATT_INCLUDESLASH).equals(&quot;true&quot;);
244     }
245 
246     /**
247      * Returns the first Text node which contains information from the XPath
248      * Filter String. We must use this stupid hook to enable the here() function
249      * to work.
250      *
251      * $todo$ I dunno whether this crashes: &lt;XPath&gt; he&lt;!-- comment --&gt;re()/ds:Signature[1]&lt;/XPath&gt;
252      * @param type
253      * @return the first Text node which contains information from the XPath 2 Filter String
254      */
255     private Node getHereContextNode(String type) {
256 
257         if (this.length(this.getBaseNamespace(), type) != 1) {
258             return null;
259         }
260 
<span class="line-modified">261         return XMLUtils.selectNodeText(</span>
262             getFirstChild(), this.getBaseNamespace(), type, 0
263         );
264     }
265 












266     /**
267      * Method getHereContextNodeIncludeButSearch
268      *
269      * @return the string
270      */
271     public Node getHereContextNodeIncludeButSearch() {
272         return this.getHereContextNode(XPathFilterCHGPContainer._TAG_INCLUDE_BUT_SEARCH);
273     }
274 
275     /**
276      * Method getHereContextNodeExcludeButSearch
277      *
278      * @return the string
279      */
280     public Node getHereContextNodeExcludeButSearch() {
281         return this.getHereContextNode(XPathFilterCHGPContainer._TAG_EXCLUDE_BUT_SEARCH);
282     }
283 
284     /**
285      * Method getHereContextNodeExclude
</pre>
</td>
<td>
<hr />
<pre>
 13  *
 14  * http://www.apache.org/licenses/LICENSE-2.0
 15  *
 16  * Unless required by applicable law or agreed to in writing,
 17  * software distributed under the License is distributed on an
 18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 19  * KIND, either express or implied. See the License for the
 20  * specific language governing permissions and limitations
 21  * under the License.
 22  */
 23 package com.sun.org.apache.xml.internal.security.transforms.params;
 24 
 25 
 26 import com.sun.org.apache.xml.internal.security.exceptions.XMLSecurityException;
 27 import com.sun.org.apache.xml.internal.security.transforms.TransformParam;
 28 import com.sun.org.apache.xml.internal.security.utils.ElementProxy;
 29 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
 30 import org.w3c.dom.Document;
 31 import org.w3c.dom.Element;
 32 import org.w3c.dom.Node;
<span class="line-added"> 33 import org.w3c.dom.Text;</span>
 34 
 35 /**
 36  * Implements the parameters for a custom Transform which has a better performance
 37  * than the xfilter2.
 38  *
 39  */
 40 public class XPathFilterCHGPContainer extends ElementProxy implements TransformParam {
 41 
 42     public static final String TRANSFORM_XPATHFILTERCHGP =
 43         &quot;http://www.nue.et-inf.uni-siegen.de/~geuer-pollmann/#xpathFilter&quot;;
 44 
 45     /** Field _ATT_FILTER_VALUE_INTERSECT */
 46     private static final String _TAG_INCLUDE_BUT_SEARCH = &quot;IncludeButSearch&quot;;
 47 
 48     /** Field _ATT_FILTER_VALUE_SUBTRACT */
 49     private static final String _TAG_EXCLUDE_BUT_SEARCH = &quot;ExcludeButSearch&quot;;
 50 
 51     /** Field _ATT_FILTER_VALUE_UNION */
 52     private static final String _TAG_EXCLUDE = &quot;Exclude&quot;;
 53 
</pre>
<hr />
<pre>
188     ) throws XMLSecurityException {
189         return new XPathFilterCHGPContainer(element, baseURI);
190     }
191 
192     /**
193      * Method getXStr
194      *
195      * @param type
196      * @return The Xstr
197      */
198     private String getXStr(String type) {
199         if (this.length(this.getBaseNamespace(), type) != 1) {
200             return &quot;&quot;;
201         }
202 
203         Element xElem =
204             XMLUtils.selectNode(
205                 getElement().getFirstChild(), this.getBaseNamespace(), type, 0
206             );
207 
<span class="line-modified">208         return XMLUtils.getFullTextChildrenFromNode(xElem);</span>
209     }
210 
211     /**
212      * Method getIncludeButSearch
213      *
214      * @return the string
215      */
216     public String getIncludeButSearch() {
217         return this.getXStr(XPathFilterCHGPContainer._TAG_INCLUDE_BUT_SEARCH);
218     }
219 
220     /**
221      * Method getExcludeButSearch
222      *
223      * @return the string
224      */
225     public String getExcludeButSearch() {
226         return this.getXStr(XPathFilterCHGPContainer._TAG_EXCLUDE_BUT_SEARCH);
227     }
228 
</pre>
<hr />
<pre>
242      */
243     public boolean getIncludeSlashPolicy() {
244         return getLocalAttribute(XPathFilterCHGPContainer._ATT_INCLUDESLASH).equals(&quot;true&quot;);
245     }
246 
247     /**
248      * Returns the first Text node which contains information from the XPath
249      * Filter String. We must use this stupid hook to enable the here() function
250      * to work.
251      *
252      * $todo$ I dunno whether this crashes: &lt;XPath&gt; he&lt;!-- comment --&gt;re()/ds:Signature[1]&lt;/XPath&gt;
253      * @param type
254      * @return the first Text node which contains information from the XPath 2 Filter String
255      */
256     private Node getHereContextNode(String type) {
257 
258         if (this.length(this.getBaseNamespace(), type) != 1) {
259             return null;
260         }
261 
<span class="line-modified">262         return selectNodeText(</span>
263             getFirstChild(), this.getBaseNamespace(), type, 0
264         );
265     }
266 
<span class="line-added">267     private static Text selectNodeText(Node sibling, String uri, String nodeName, int number) {</span>
<span class="line-added">268         Node n = XMLUtils.selectNode(sibling, uri, nodeName, number);</span>
<span class="line-added">269         if (n == null) {</span>
<span class="line-added">270             return null;</span>
<span class="line-added">271         }</span>
<span class="line-added">272         n = n.getFirstChild();</span>
<span class="line-added">273         while (n != null &amp;&amp; n.getNodeType() != Node.TEXT_NODE) {</span>
<span class="line-added">274             n = n.getNextSibling();</span>
<span class="line-added">275         }</span>
<span class="line-added">276         return (Text)n;</span>
<span class="line-added">277     }</span>
<span class="line-added">278 </span>
279     /**
280      * Method getHereContextNodeIncludeButSearch
281      *
282      * @return the string
283      */
284     public Node getHereContextNodeIncludeButSearch() {
285         return this.getHereContextNode(XPathFilterCHGPContainer._TAG_INCLUDE_BUT_SEARCH);
286     }
287 
288     /**
289      * Method getHereContextNodeExcludeButSearch
290      *
291      * @return the string
292      */
293     public Node getHereContextNodeExcludeButSearch() {
294         return this.getHereContextNode(XPathFilterCHGPContainer._TAG_EXCLUDE_BUT_SEARCH);
295     }
296 
297     /**
298      * Method getHereContextNodeExclude
</pre>
</td>
</tr>
</table>
<center><a href="../implementations/TransformXSLT.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../../index.html" target="_top">index</a> <a href="../../utils/Constants.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>