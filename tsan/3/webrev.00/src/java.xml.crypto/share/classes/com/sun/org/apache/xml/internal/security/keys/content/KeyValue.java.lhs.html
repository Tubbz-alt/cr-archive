<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/keys/content/KeyValue.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * reserved comment block
  3  * DO NOT REMOVE OR ALTER!
  4  */
  5 /**
  6  * Licensed to the Apache Software Foundation (ASF) under one
  7  * or more contributor license agreements. See the NOTICE file
  8  * distributed with this work for additional information
  9  * regarding copyright ownership. The ASF licenses this file
 10  * to you under the Apache License, Version 2.0 (the
 11  * &quot;License&quot;); you may not use this file except in compliance
 12  * with the License. You may obtain a copy of the License at
 13  *
 14  * http://www.apache.org/licenses/LICENSE-2.0
 15  *
 16  * Unless required by applicable law or agreed to in writing,
 17  * software distributed under the License is distributed on an
 18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 19  * KIND, either express or implied. See the License for the
 20  * specific language governing permissions and limitations
 21  * under the License.
 22  */
 23 package com.sun.org.apache.xml.internal.security.keys.content;
 24 
 25 import java.security.PublicKey;
 26 
 27 import com.sun.org.apache.xml.internal.security.exceptions.XMLSecurityException;
 28 import com.sun.org.apache.xml.internal.security.keys.content.keyvalues.DSAKeyValue;
<a name="1" id="anc1"></a>
 29 import com.sun.org.apache.xml.internal.security.keys.content.keyvalues.RSAKeyValue;
 30 import com.sun.org.apache.xml.internal.security.utils.Constants;
 31 import com.sun.org.apache.xml.internal.security.utils.SignatureElementProxy;
 32 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
 33 import org.w3c.dom.Document;
 34 import org.w3c.dom.Element;
 35 
 36 /**
 37  * The KeyValue element contains a single public key that may be useful in
 38  * validating the signature. Structured formats for defining DSA (REQUIRED)
 39  * and RSA (RECOMMENDED) public keys are defined in Signature Algorithms
 40  * (section 6.4). The KeyValue element may include externally defined public
 41  * keys values represented as PCDATA or element types from an external
 42  * namespace.
 43  *
 44  */
 45 public class KeyValue extends SignatureElementProxy implements KeyInfoContent {
 46 
 47     /**
 48      * Constructor KeyValue
 49      *
 50      * @param doc
 51      * @param dsaKeyValue
 52      */
 53     public KeyValue(Document doc, DSAKeyValue dsaKeyValue) {
 54         super(doc);
 55 
 56         addReturnToSelf();
 57         appendSelf(dsaKeyValue);
 58         addReturnToSelf();
 59     }
 60 
 61     /**
 62      * Constructor KeyValue
 63      *
 64      * @param doc
 65      * @param rsaKeyValue
 66      */
 67     public KeyValue(Document doc, RSAKeyValue rsaKeyValue) {
 68         super(doc);
 69 
 70         addReturnToSelf();
 71         appendSelf(rsaKeyValue);
 72         addReturnToSelf();
 73     }
 74 
 75     /**
 76      * Constructor KeyValue
 77      *
 78      * @param doc
 79      * @param unknownKeyValue
 80      */
 81     public KeyValue(Document doc, Element unknownKeyValue) {
 82         super(doc);
 83 
 84         addReturnToSelf();
 85         appendSelf(unknownKeyValue);
 86         addReturnToSelf();
 87     }
 88 
 89     /**
 90      * Constructor KeyValue
 91      *
 92      * @param doc
 93      * @param pk
 94      */
 95     public KeyValue(Document doc, PublicKey pk) {
 96         super(doc);
 97 
 98         addReturnToSelf();
 99 
100         if (pk instanceof java.security.interfaces.DSAPublicKey) {
101             DSAKeyValue dsa = new DSAKeyValue(getDocument(), pk);
102 
103             appendSelf(dsa);
104             addReturnToSelf();
105         } else if (pk instanceof java.security.interfaces.RSAPublicKey) {
106             RSAKeyValue rsa = new RSAKeyValue(getDocument(), pk);
107 
108             appendSelf(rsa);
109             addReturnToSelf();
<a name="2" id="anc2"></a>




110         } else {
111             String error = &quot;The given PublicKey type &quot; + pk + &quot; is not supported. Only DSAPublicKey and &quot;
<a name="3" id="anc3"></a><span class="line-modified">112                 + &quot;RSAPublicKey types are currently supported&quot;;</span>
113             throw new IllegalArgumentException(error);
114         }
115     }
116 
117     /**
118      * Constructor KeyValue
119      *
120      * @param element
121      * @param baseURI
122      * @throws XMLSecurityException
123      */
124     public KeyValue(Element element, String baseURI) throws XMLSecurityException {
125         super(element, baseURI);
126     }
127 
128     /**
129      * Method getPublicKey
130      *
131      * @return the public key
132      * @throws XMLSecurityException
133      */
134     public PublicKey getPublicKey() throws XMLSecurityException {
135         Element rsa =
136             XMLUtils.selectDsNode(
137                 getFirstChild(), Constants._TAG_RSAKEYVALUE, 0);
138 
139         if (rsa != null) {
140             RSAKeyValue kv = new RSAKeyValue(rsa, this.baseURI);
141             return kv.getPublicKey();
142         }
143 
144         Element dsa =
145             XMLUtils.selectDsNode(
146                 getFirstChild(), Constants._TAG_DSAKEYVALUE, 0);
147 
148         if (dsa != null) {
149             DSAKeyValue kv = new DSAKeyValue(dsa, this.baseURI);
150             return kv.getPublicKey();
151         }
152 
153         return null;
154     }
155 
156     /** {@inheritDoc} */
157     public String getBaseLocalName() {
158         return Constants._TAG_KEYVALUE;
159     }
160 }
<a name="4" id="anc4"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="4" type="hidden" />
</body>
</html>