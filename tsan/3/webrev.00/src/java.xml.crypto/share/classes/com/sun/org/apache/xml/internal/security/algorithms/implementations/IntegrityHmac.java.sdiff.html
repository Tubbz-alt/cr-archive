<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/algorithms/implementations/IntegrityHmac.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../Init.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../../index.html" target="_top">index</a> <a href="SignatureDSA.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/algorithms/implementations/IntegrityHmac.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 23 package com.sun.org.apache.xml.internal.security.algorithms.implementations;
 24 
 25 import java.security.InvalidAlgorithmParameterException;
 26 import java.security.InvalidKeyException;
 27 import java.security.Key;
 28 import java.security.SecureRandom;
 29 import java.security.spec.AlgorithmParameterSpec;
 30 
 31 import javax.crypto.Mac;
 32 import javax.crypto.SecretKey;
 33 
 34 import com.sun.org.apache.xml.internal.security.algorithms.JCEMapper;
 35 import com.sun.org.apache.xml.internal.security.algorithms.MessageDigestAlgorithm;
 36 import com.sun.org.apache.xml.internal.security.algorithms.SignatureAlgorithmSpi;
 37 import com.sun.org.apache.xml.internal.security.signature.XMLSignature;
 38 import com.sun.org.apache.xml.internal.security.signature.XMLSignatureException;
 39 import com.sun.org.apache.xml.internal.security.utils.Constants;
 40 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
 41 import org.w3c.dom.Document;
 42 import org.w3c.dom.Element;

 43 import org.w3c.dom.Text;
 44 
 45 public abstract class IntegrityHmac extends SignatureAlgorithmSpi {
 46 
 47     private static final com.sun.org.slf4j.internal.Logger LOG =
 48         com.sun.org.slf4j.internal.LoggerFactory.getLogger(IntegrityHmac.class);
 49 
 50     /** Field macAlgorithm */
 51     private Mac macAlgorithm;
 52 
 53     /** Field HMACOutputLength */
 54     private int HMACOutputLength;
 55     private boolean HMACOutputLengthSet = false;
 56 
 57     /**
 58      * Method engineGetURI
 59      *
 60      *{@inheritDoc}
 61      */
 62     public abstract String engineGetURI();
</pre>
<hr />
<pre>
308      *
309      * @param HMACOutputLength
310      */
311     protected void engineSetHMACOutputLength(int HMACOutputLength) {
312         this.HMACOutputLength = HMACOutputLength;
313         this.HMACOutputLengthSet = true;
314     }
315 
316     /**
317      * Method engineGetContextFromElement
318      *
319      * @param element
320      */
321     protected void engineGetContextFromElement(Element element) {
322         super.engineGetContextFromElement(element);
323 
324         if (element == null) {
325             throw new IllegalArgumentException(&quot;element null&quot;);
326         }
327 
<span class="line-modified">328         Text hmaclength =</span>
<span class="line-modified">329             XMLUtils.selectDsNodeText(element.getFirstChild(), Constants._TAG_HMACOUTPUTLENGTH, 0);</span>
<span class="line-modified">330 </span>
<span class="line-modified">331         if (hmaclength != null) {</span>
<span class="line-modified">332             this.HMACOutputLength = Integer.parseInt(hmaclength.getData());</span>
<span class="line-modified">333             this.HMACOutputLengthSet = true;</span>

334         }
335     }
336 
337     /**
338      * Method engineAddContextToElement
339      *
340      * @param element
341      */
342     public void engineAddContextToElement(Element element) {
343         if (element == null) {
344             throw new IllegalArgumentException(&quot;null element&quot;);
345         }
346 
347         if (this.HMACOutputLengthSet) {
348             Document doc = element.getOwnerDocument();
349             Element HMElem =
350                 XMLUtils.createElementInSignatureSpace(doc, Constants._TAG_HMACOUTPUTLENGTH);
351             Text HMText =
352                 doc.createTextNode(&quot;&quot; + this.HMACOutputLength);
353 
</pre>
</td>
<td>
<hr />
<pre>
 23 package com.sun.org.apache.xml.internal.security.algorithms.implementations;
 24 
 25 import java.security.InvalidAlgorithmParameterException;
 26 import java.security.InvalidKeyException;
 27 import java.security.Key;
 28 import java.security.SecureRandom;
 29 import java.security.spec.AlgorithmParameterSpec;
 30 
 31 import javax.crypto.Mac;
 32 import javax.crypto.SecretKey;
 33 
 34 import com.sun.org.apache.xml.internal.security.algorithms.JCEMapper;
 35 import com.sun.org.apache.xml.internal.security.algorithms.MessageDigestAlgorithm;
 36 import com.sun.org.apache.xml.internal.security.algorithms.SignatureAlgorithmSpi;
 37 import com.sun.org.apache.xml.internal.security.signature.XMLSignature;
 38 import com.sun.org.apache.xml.internal.security.signature.XMLSignatureException;
 39 import com.sun.org.apache.xml.internal.security.utils.Constants;
 40 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
 41 import org.w3c.dom.Document;
 42 import org.w3c.dom.Element;
<span class="line-added"> 43 import org.w3c.dom.Node;</span>
 44 import org.w3c.dom.Text;
 45 
 46 public abstract class IntegrityHmac extends SignatureAlgorithmSpi {
 47 
 48     private static final com.sun.org.slf4j.internal.Logger LOG =
 49         com.sun.org.slf4j.internal.LoggerFactory.getLogger(IntegrityHmac.class);
 50 
 51     /** Field macAlgorithm */
 52     private Mac macAlgorithm;
 53 
 54     /** Field HMACOutputLength */
 55     private int HMACOutputLength;
 56     private boolean HMACOutputLengthSet = false;
 57 
 58     /**
 59      * Method engineGetURI
 60      *
 61      *{@inheritDoc}
 62      */
 63     public abstract String engineGetURI();
</pre>
<hr />
<pre>
309      *
310      * @param HMACOutputLength
311      */
312     protected void engineSetHMACOutputLength(int HMACOutputLength) {
313         this.HMACOutputLength = HMACOutputLength;
314         this.HMACOutputLengthSet = true;
315     }
316 
317     /**
318      * Method engineGetContextFromElement
319      *
320      * @param element
321      */
322     protected void engineGetContextFromElement(Element element) {
323         super.engineGetContextFromElement(element);
324 
325         if (element == null) {
326             throw new IllegalArgumentException(&quot;element null&quot;);
327         }
328 
<span class="line-modified">329         Node n = XMLUtils.selectDsNode(element.getFirstChild(), Constants._TAG_HMACOUTPUTLENGTH, 0);</span>
<span class="line-modified">330         if (n != null) {</span>
<span class="line-modified">331             String hmacLength = XMLUtils.getFullTextChildrenFromNode(n);</span>
<span class="line-modified">332             if (hmacLength != null &amp;&amp; !&quot;&quot;.equals(hmacLength)) {</span>
<span class="line-modified">333                 this.HMACOutputLength = Integer.parseInt(hmacLength);</span>
<span class="line-modified">334                 this.HMACOutputLengthSet = true;</span>
<span class="line-added">335             }</span>
336         }
337     }
338 
339     /**
340      * Method engineAddContextToElement
341      *
342      * @param element
343      */
344     public void engineAddContextToElement(Element element) {
345         if (element == null) {
346             throw new IllegalArgumentException(&quot;null element&quot;);
347         }
348 
349         if (this.HMACOutputLengthSet) {
350             Document doc = element.getOwnerDocument();
351             Element HMElem =
352                 XMLUtils.createElementInSignatureSpace(doc, Constants._TAG_HMACOUTPUTLENGTH);
353             Text HMText =
354                 doc.createTextNode(&quot;&quot; + this.HMACOutputLength);
355 
</pre>
</td>
</tr>
</table>
<center><a href="../../Init.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../../index.html" target="_top">index</a> <a href="SignatureDSA.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>