<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/java.xml.crypto/share/classes/com/sun/org/apache/xml/internal/security/keys/keyresolver/implementations/ECKeyValueResolver.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
 1 /*
 2  * reserved comment block
 3  * DO NOT REMOVE OR ALTER!
 4  */
 5 /**
 6  * Licensed to the Apache Software Foundation (ASF) under one
 7  * or more contributor license agreements. See the NOTICE file
 8  * distributed with this work for additional information
 9  * regarding copyright ownership. The ASF licenses this file
10  * to you under the Apache License, Version 2.0 (the
11  * &quot;License&quot;); you may not use this file except in compliance
12  * with the License. You may obtain a copy of the License at
13  *
14  * http://www.apache.org/licenses/LICENSE-2.0
15  *
16  * Unless required by applicable law or agreed to in writing,
17  * software distributed under the License is distributed on an
18  * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
19  * KIND, either express or implied. See the License for the
20  * specific language governing permissions and limitations
21  * under the License.
22  */
23 package com.sun.org.apache.xml.internal.security.keys.keyresolver.implementations;
24 
25 import java.security.PublicKey;
26 import java.security.cert.X509Certificate;
27 
28 import com.sun.org.apache.xml.internal.security.exceptions.XMLSecurityException;
29 import com.sun.org.apache.xml.internal.security.keys.content.keyvalues.ECKeyValue;
30 import com.sun.org.apache.xml.internal.security.keys.keyresolver.KeyResolverSpi;
31 import com.sun.org.apache.xml.internal.security.keys.storage.StorageResolver;
32 import com.sun.org.apache.xml.internal.security.utils.Constants;
33 import com.sun.org.apache.xml.internal.security.utils.XMLUtils;
34 import org.w3c.dom.Element;
35 
36 public class ECKeyValueResolver extends KeyResolverSpi {
37 
38     private static final com.sun.org.slf4j.internal.Logger LOG =
39         com.sun.org.slf4j.internal.LoggerFactory.getLogger(ECKeyValueResolver.class);
40 
41 
42     /**
43      * Method engineResolvePublicKey
44      *
45      * @param element
46      * @param baseURI
47      * @param storage
48      * @return null if no {@link PublicKey} could be obtained
49      */
50     public PublicKey engineLookupAndResolvePublicKey(
51         Element element, String baseURI, StorageResolver storage
52     ) {
53         if (element == null) {
54             return null;
55         }
56         Element ecKeyElement = null;
57         boolean isKeyValue =
58             XMLUtils.elementIsInSignatureSpace(element, Constants._TAG_KEYVALUE);
59         if (isKeyValue) {
60             ecKeyElement =
61                 XMLUtils.selectDs11Node(element.getFirstChild(), Constants._TAG_ECKEYVALUE, 0);
62         } else if (XMLUtils.elementIsInSignature11Space(element, Constants._TAG_ECKEYVALUE)) {
63             // this trick is needed to allow the RetrievalMethodResolver to eat a
64             // ds:ECKeyValue directly (without KeyValue)
65             ecKeyElement = element;
66         }
67 
68         if (ecKeyElement == null) {
69             return null;
70         }
71 
72         try {
73             ECKeyValue ecKeyValue = new ECKeyValue(ecKeyElement, baseURI);
74             return ecKeyValue.getPublicKey();
75         } catch (XMLSecurityException ex) {
76             LOG.debug(ex.getMessage(), ex);
77             //do nothing
78         }
79 
80         return null;
81     }
82 
83 
84     /** {@inheritDoc} */
85     public X509Certificate engineLookupResolveX509Certificate(
86         Element element, String baseURI, StorageResolver storage
87     ) {
88         return null;
89     }
90 
91     /** {@inheritDoc} */
92     public javax.crypto.SecretKey engineLookupAndResolveSecretKey(
93         Element element, String baseURI, StorageResolver storage
94     ) {
95         return null;
96     }
97 }
    </pre>
  </body>
</html>