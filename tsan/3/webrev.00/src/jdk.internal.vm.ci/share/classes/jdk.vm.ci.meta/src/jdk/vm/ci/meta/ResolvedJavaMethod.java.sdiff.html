<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.internal.vm.ci/share/classes/jdk.vm.ci.meta/src/jdk/vm/ci/meta/ResolvedJavaMethod.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="PrimitiveConstant.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="SpeculationLog.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.internal.vm.ci/share/classes/jdk.vm.ci.meta/src/jdk/vm/ci/meta/ResolvedJavaMethod.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2009, 2014, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 package jdk.vm.ci.meta;
 24 
 25 import java.lang.annotation.Annotation;
 26 import java.lang.reflect.AnnotatedElement;
 27 import java.lang.reflect.Array;
<span class="line-removed"> 28 import java.lang.reflect.InvocationTargetException;</span>
 29 import java.lang.reflect.Method;
 30 import java.lang.reflect.Modifier;
 31 import java.lang.reflect.Type;
 32 
 33 /**
 34  * Represents a resolved Java method. Methods, like fields and types, are resolved through
 35  * {@link ConstantPool constant pools}.
 36  */
 37 public interface ResolvedJavaMethod extends JavaMethod, InvokeTarget, ModifiersProvider, AnnotatedElement {
 38 
 39     /**
 40      * Returns the bytecode of this method, if the method has code. The returned byte array does not
 41      * contain breakpoints or non-Java bytecodes. This may return null if the
<span class="line-modified"> 42      * {@link #getDeclaringClass() holder} is not {@link ResolvedJavaType#isLinked() linked}.</span>

 43      *
 44      * The contained constant pool indices may not be the ones found in the original class file but
 45      * they can be used with the JVMCI API (e.g. methods in {@link ConstantPool}).
 46      *
 47      * @return the bytecode of the method, or {@code null} if {@code getCodeSize() == 0} or if the
 48      *         code is not ready.
 49      */
 50     byte[] getCode();
 51 
 52     /**
 53      * Returns the size of the bytecode of this method, if the method has code. This is equivalent
 54      * to {@link #getCode()}. {@code length} if the method has code.
 55      *
 56      * @return the size of the bytecode in bytes, or 0 if no bytecode is available
 57      */
 58     int getCodeSize();
 59 
 60     /**
 61      * Returns the {@link ResolvedJavaType} object representing the class or interface that declares
 62      * this method.
</pre>
<hr />
<pre>
422      *
423      * @param annotationClass the Class object corresponding to the annotation type
424      * @return the annotation of type {@code annotationClass} (if any) for each formal parameter
425      *         present
426      */
427     @SuppressWarnings(&quot;unchecked&quot;)
428     default &lt;T extends Annotation&gt; T[] getParameterAnnotations(Class&lt;T&gt; annotationClass) {
429         Annotation[][] parameterAnnotations = getParameterAnnotations();
430         T[] result = (T[]) Array.newInstance(annotationClass, parameterAnnotations.length);
431         for (int i = 0; i &lt; parameterAnnotations.length; i++) {
432             for (Annotation a : parameterAnnotations[i]) {
433                 if (a.annotationType() == annotationClass) {
434                     result[i] = annotationClass.cast(a);
435                 }
436             }
437         }
438         return result;
439     }
440 
441     /**
<span class="line-modified">442      * Checks whether the method has bytecodes associated with it. Methods without bytecodes are</span>
<span class="line-modified">443      * either abstract or native methods.</span>


444      *
<span class="line-modified">445      * @return whether the definition of this method is Java bytecodes</span>
446      */
447     default boolean hasBytecodes() {
<span class="line-modified">448         return isConcrete() &amp;&amp; !isNative();</span>
449     }
450 
451     /**
452      * Checks whether the method has a receiver parameter - i.e., whether it is not static.
453      *
454      * @return whether the method has a receiver parameter
455      */
456     default boolean hasReceiver() {
457         return !isStatic();
458     }
459 
460     /**
461      * Determines if this method is {@link java.lang.Object#Object()}.
462      */
463     default boolean isJavaLangObjectInit() {
464         return getDeclaringClass().isJavaLangObject() &amp;&amp; getName().equals(&quot;&lt;init&gt;&quot;);
465     }
466 
<span class="line-removed">467     SpeculationLog getSpeculationLog();</span>
<span class="line-removed">468 </span>
469     /**
<span class="line-modified">470      *</span>
<span class="line-modified">471      * @param object</span>
<span class="line-modified">472      * @param args</span>
<span class="line-modified">473      * @throws InvocationTargetException</span>
<span class="line-removed">474      * @throws IllegalAccessException</span>
475      */
<span class="line-modified">476     default JavaConstant invoke(JavaConstant object, JavaConstant... args) throws InvocationTargetException, IllegalAccessException {</span>
<span class="line-removed">477         throw new InternalError(&quot;unimplemented&quot;);</span>
<span class="line-removed">478     }</span>
479 }
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2009, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 package jdk.vm.ci.meta;
 24 
 25 import java.lang.annotation.Annotation;
 26 import java.lang.reflect.AnnotatedElement;
 27 import java.lang.reflect.Array;

 28 import java.lang.reflect.Method;
 29 import java.lang.reflect.Modifier;
 30 import java.lang.reflect.Type;
 31 
 32 /**
 33  * Represents a resolved Java method. Methods, like fields and types, are resolved through
 34  * {@link ConstantPool constant pools}.
 35  */
 36 public interface ResolvedJavaMethod extends JavaMethod, InvokeTarget, ModifiersProvider, AnnotatedElement {
 37 
 38     /**
 39      * Returns the bytecode of this method, if the method has code. The returned byte array does not
 40      * contain breakpoints or non-Java bytecodes. This may return null if the
<span class="line-modified"> 41      * {@linkplain #getDeclaringClass() declaring class} is not</span>
<span class="line-added"> 42      * {@linkplain ResolvedJavaType#isLinked() linked}.</span>
 43      *
 44      * The contained constant pool indices may not be the ones found in the original class file but
 45      * they can be used with the JVMCI API (e.g. methods in {@link ConstantPool}).
 46      *
 47      * @return the bytecode of the method, or {@code null} if {@code getCodeSize() == 0} or if the
 48      *         code is not ready.
 49      */
 50     byte[] getCode();
 51 
 52     /**
 53      * Returns the size of the bytecode of this method, if the method has code. This is equivalent
 54      * to {@link #getCode()}. {@code length} if the method has code.
 55      *
 56      * @return the size of the bytecode in bytes, or 0 if no bytecode is available
 57      */
 58     int getCodeSize();
 59 
 60     /**
 61      * Returns the {@link ResolvedJavaType} object representing the class or interface that declares
 62      * this method.
</pre>
<hr />
<pre>
422      *
423      * @param annotationClass the Class object corresponding to the annotation type
424      * @return the annotation of type {@code annotationClass} (if any) for each formal parameter
425      *         present
426      */
427     @SuppressWarnings(&quot;unchecked&quot;)
428     default &lt;T extends Annotation&gt; T[] getParameterAnnotations(Class&lt;T&gt; annotationClass) {
429         Annotation[][] parameterAnnotations = getParameterAnnotations();
430         T[] result = (T[]) Array.newInstance(annotationClass, parameterAnnotations.length);
431         for (int i = 0; i &lt; parameterAnnotations.length; i++) {
432             for (Annotation a : parameterAnnotations[i]) {
433                 if (a.annotationType() == annotationClass) {
434                     result[i] = annotationClass.cast(a);
435                 }
436             }
437         }
438         return result;
439     }
440 
441     /**
<span class="line-modified">442      * Checks whether the method has bytecodes associated with it. Note that even if this method</span>
<span class="line-modified">443      * returns {@code true}, {@link #getCode} can return {@code null} if</span>
<span class="line-added">444      * {@linkplain #getDeclaringClass() declaring class} is not</span>
<span class="line-added">445      * {@linkplain ResolvedJavaType#isLinked() linked}.</span>
446      *
<span class="line-modified">447      * @return {@code this.getCodeSize() != 0}</span>
448      */
449     default boolean hasBytecodes() {
<span class="line-modified">450         return getCodeSize() != 0;</span>
451     }
452 
453     /**
454      * Checks whether the method has a receiver parameter - i.e., whether it is not static.
455      *
456      * @return whether the method has a receiver parameter
457      */
458     default boolean hasReceiver() {
459         return !isStatic();
460     }
461 
462     /**
463      * Determines if this method is {@link java.lang.Object#Object()}.
464      */
465     default boolean isJavaLangObjectInit() {
466         return getDeclaringClass().isJavaLangObject() &amp;&amp; getName().equals(&quot;&lt;init&gt;&quot;);
467     }
468 


469     /**
<span class="line-modified">470      * Gets a speculation log that can be used when compiling this method to make new speculations</span>
<span class="line-modified">471      * and query previously failed speculations. The implementation may return a new</span>
<span class="line-modified">472      * {@link SpeculationLog} object each time this method is called so its the caller&#39;s</span>
<span class="line-modified">473      * responsibility to ensure the same speculation log is used throughout a compilation.</span>

474      */
<span class="line-modified">475     SpeculationLog getSpeculationLog();</span>


476 }
</pre>
</td>
</tr>
</table>
<center><a href="PrimitiveConstant.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="SpeculationLog.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>