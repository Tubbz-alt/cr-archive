<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/jdk.internal.vm.ci/share/classes/jdk.vm.ci.hotspot/src/jdk/vm/ci/hotspot/HotSpotCompiledCode.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="HotSpotCompilationRequest.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="HotSpotCompiledNmethod.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.internal.vm.ci/share/classes/jdk.vm.ci.hotspot/src/jdk/vm/ci/hotspot/HotSpotCompiledCode.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2011, 2016, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2011, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -23,14 +23,16 @@</span>
  package jdk.vm.ci.hotspot;
  
  import jdk.vm.ci.code.BytecodeFrame;
  import jdk.vm.ci.code.CompiledCode;
  import jdk.vm.ci.code.StackSlot;
<span class="udiff-line-added">+ import jdk.vm.ci.code.VirtualObject;</span>
  import jdk.vm.ci.code.site.DataPatch;
  import jdk.vm.ci.code.site.Infopoint;
  import jdk.vm.ci.code.site.Site;
  import jdk.vm.ci.meta.Assumptions.Assumption;
<span class="udiff-line-added">+ import jdk.vm.ci.meta.ResolvedJavaField;</span>
  import jdk.vm.ci.meta.ResolvedJavaMethod;
  
  /**
   * A {@link CompiledCode} with additional HotSpot-specific information required for installing the
   * code in HotSpot&#39;s code cache.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -154,11 +156,25 @@</span>
              if (site instanceof Infopoint) {
                  Infopoint info = (Infopoint) site;
                  if (info.debugInfo != null) {
                      BytecodeFrame frame = info.debugInfo.frame();
                      assert frame == null || frame.validateFormat();
<span class="udiff-line-added">+                     if (info.debugInfo.getVirtualObjectMapping() != null) {</span>
<span class="udiff-line-added">+                         for (VirtualObject v : info.debugInfo.getVirtualObjectMapping()) {</span>
<span class="udiff-line-added">+                             verifyVirtualObject(v);</span>
<span class="udiff-line-added">+                         }</span>
<span class="udiff-line-added">+                     }</span>
                  }
              }
          }
          return true;
      }
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     public static void verifyVirtualObject(VirtualObject v) {</span>
<span class="udiff-line-added">+         v.verifyLayout(new VirtualObject.LayoutVerifier() {</span>
<span class="udiff-line-added">+             @Override</span>
<span class="udiff-line-added">+             public int getOffset(ResolvedJavaField field) {</span>
<span class="udiff-line-added">+                 return field.getOffset();</span>
<span class="udiff-line-added">+             }</span>
<span class="udiff-line-added">+         });</span>
<span class="udiff-line-added">+     }</span>
  }
</pre>
<center><a href="HotSpotCompilationRequest.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="HotSpotCompiledNmethod.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>