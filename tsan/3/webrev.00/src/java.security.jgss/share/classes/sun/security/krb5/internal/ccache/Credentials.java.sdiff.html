<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.security.jgss/share/classes/sun/security/krb5/internal/ccache/Credentials.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="CCacheOutputStream.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="CredentialsCache.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.security.jgss/share/classes/sun/security/krb5/internal/ccache/Credentials.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 31 package sun.security.krb5.internal.ccache;
 32 
 33 import sun.security.krb5.*;
 34 import sun.security.krb5.internal.*;
 35 
 36 public class Credentials {
 37 
 38     PrincipalName cname;
 39     PrincipalName sname;
 40     EncryptionKey key;
 41     KerberosTime authtime;
 42     KerberosTime starttime;//optional
 43     KerberosTime endtime;
 44     KerberosTime renewTill; //optional
 45     HostAddresses caddr; //optional; for proxied tickets only
 46     AuthorizationData authorizationData; //optional, not being actually used
 47     public boolean isEncInSKey;  // true if ticket is encrypted in another ticket&#39;s skey
 48     TicketFlags flags;
 49     Ticket ticket;
 50     Ticket secondTicket; //optional
<span class="line-removed"> 51     private boolean DEBUG = Krb5.DEBUG;</span>
 52 
 53     public Credentials(
 54             PrincipalName new_cname,
 55             PrincipalName new_sname,
 56             EncryptionKey new_key,
 57             KerberosTime new_authtime,
 58             KerberosTime new_starttime,
 59             KerberosTime new_endtime,
 60             KerberosTime new_renewTill,
 61             boolean new_isEncInSKey,
 62             TicketFlags new_flags,
 63             HostAddresses new_caddr,
 64             AuthorizationData new_authData,
 65             Ticket new_ticket,
 66             Ticket new_secondTicket) {
 67         cname = (PrincipalName) new_cname.clone();
 68         sname = (PrincipalName) new_sname.clone();
 69         key = (EncryptionKey) new_key.clone();
 70 
 71         authtime = new_authtime;
</pre>
<hr />
<pre>
152     public boolean isValid() {
153         boolean valid = true;
154         if (endtime.getTime() &lt; System.currentTimeMillis()) {
155             valid = false;
156         } else if (starttime != null) {
157             if (starttime.getTime() &gt; System.currentTimeMillis()) {
158                 valid = false;
159             }
160         } else {
161             if (authtime.getTime() &gt; System.currentTimeMillis()) {
162                 valid = false;
163             }
164         }
165         return valid;
166     }
167 
168     public PrincipalName getServicePrincipal() throws RealmException {
169         return sname;
170     }
171 












172     public sun.security.krb5.Credentials setKrbCreds() {
173         // Note: We will not pass authorizationData to s.s.k.Credentials. The
174         // field in that class will be passed to Krb5Context as the return
175         // value of ExtendedGSSContext.inquireSecContext(KRB5_GET_AUTHZ_DATA),
176         // which is documented as the authData in the service ticket. That
177         // is on the acceptor side.
178         //
179         // This class is for the initiator side. Also, authdata inside a ccache
180         // is most likely to be the one in Authenticator in PA-TGS-REQ encoded
181         // in TGS-REQ, therefore only stored with a service ticket. Currently
182         // in Java, we only reads TGTs.
<span class="line-modified">183         return new sun.security.krb5.Credentials(ticket,</span>
<span class="line-modified">184                 cname, sname, key, flags, authtime, starttime, endtime, renewTill, caddr);</span>

185     }
186 
187     public KerberosTime getStartTime() {
188         return starttime;
189     }
190 
191     public KerberosTime getAuthTime() {
192         return authtime;
193     }
194 
195     public KerberosTime getEndTime() {
196         return endtime;
197     }
198 
199     public KerberosTime getRenewTill() {
200         return renewTill;
201     }
202 
203     public TicketFlags getTicketFlags() {
204         return flags;
205     }
206 
207     public int getEType() {
208         return key.getEType();
209     }
210 




211     public int getTktEType() {
212         return ticket.encPart.getEType();
213     }




214 }
</pre>
</td>
<td>
<hr />
<pre>
 31 package sun.security.krb5.internal.ccache;
 32 
 33 import sun.security.krb5.*;
 34 import sun.security.krb5.internal.*;
 35 
 36 public class Credentials {
 37 
 38     PrincipalName cname;
 39     PrincipalName sname;
 40     EncryptionKey key;
 41     KerberosTime authtime;
 42     KerberosTime starttime;//optional
 43     KerberosTime endtime;
 44     KerberosTime renewTill; //optional
 45     HostAddresses caddr; //optional; for proxied tickets only
 46     AuthorizationData authorizationData; //optional, not being actually used
 47     public boolean isEncInSKey;  // true if ticket is encrypted in another ticket&#39;s skey
 48     TicketFlags flags;
 49     Ticket ticket;
 50     Ticket secondTicket; //optional

 51 
 52     public Credentials(
 53             PrincipalName new_cname,
 54             PrincipalName new_sname,
 55             EncryptionKey new_key,
 56             KerberosTime new_authtime,
 57             KerberosTime new_starttime,
 58             KerberosTime new_endtime,
 59             KerberosTime new_renewTill,
 60             boolean new_isEncInSKey,
 61             TicketFlags new_flags,
 62             HostAddresses new_caddr,
 63             AuthorizationData new_authData,
 64             Ticket new_ticket,
 65             Ticket new_secondTicket) {
 66         cname = (PrincipalName) new_cname.clone();
 67         sname = (PrincipalName) new_sname.clone();
 68         key = (EncryptionKey) new_key.clone();
 69 
 70         authtime = new_authtime;
</pre>
<hr />
<pre>
151     public boolean isValid() {
152         boolean valid = true;
153         if (endtime.getTime() &lt; System.currentTimeMillis()) {
154             valid = false;
155         } else if (starttime != null) {
156             if (starttime.getTime() &gt; System.currentTimeMillis()) {
157                 valid = false;
158             }
159         } else {
160             if (authtime.getTime() &gt; System.currentTimeMillis()) {
161                 valid = false;
162             }
163         }
164         return valid;
165     }
166 
167     public PrincipalName getServicePrincipal() throws RealmException {
168         return sname;
169     }
170 
<span class="line-added">171     public Ticket getTicket() throws RealmException {</span>
<span class="line-added">172         return ticket;</span>
<span class="line-added">173     }</span>
<span class="line-added">174 </span>
<span class="line-added">175     public PrincipalName getServicePrincipal2() throws RealmException {</span>
<span class="line-added">176         return secondTicket == null ? null : secondTicket.sname;</span>
<span class="line-added">177     }</span>
<span class="line-added">178 </span>
<span class="line-added">179     public PrincipalName getClientPrincipal() throws RealmException {</span>
<span class="line-added">180         return cname;</span>
<span class="line-added">181     }</span>
<span class="line-added">182 </span>
183     public sun.security.krb5.Credentials setKrbCreds() {
184         // Note: We will not pass authorizationData to s.s.k.Credentials. The
185         // field in that class will be passed to Krb5Context as the return
186         // value of ExtendedGSSContext.inquireSecContext(KRB5_GET_AUTHZ_DATA),
187         // which is documented as the authData in the service ticket. That
188         // is on the acceptor side.
189         //
190         // This class is for the initiator side. Also, authdata inside a ccache
191         // is most likely to be the one in Authenticator in PA-TGS-REQ encoded
192         // in TGS-REQ, therefore only stored with a service ticket. Currently
193         // in Java, we only reads TGTs.
<span class="line-modified">194         return new sun.security.krb5.Credentials(ticket, cname, null, sname,</span>
<span class="line-modified">195                 null, key, flags, authtime, starttime, endtime, renewTill,</span>
<span class="line-added">196                 caddr);</span>
197     }
198 
199     public KerberosTime getStartTime() {
200         return starttime;
201     }
202 
203     public KerberosTime getAuthTime() {
204         return authtime;
205     }
206 
207     public KerberosTime getEndTime() {
208         return endtime;
209     }
210 
211     public KerberosTime getRenewTill() {
212         return renewTill;
213     }
214 
215     public TicketFlags getTicketFlags() {
216         return flags;
217     }
218 
219     public int getEType() {
220         return key.getEType();
221     }
222 
<span class="line-added">223     public EncryptionKey getKey() {</span>
<span class="line-added">224         return key;</span>
<span class="line-added">225     }</span>
<span class="line-added">226 </span>
227     public int getTktEType() {
228         return ticket.encPart.getEType();
229     }
<span class="line-added">230 </span>
<span class="line-added">231     public int getTktEType2() {</span>
<span class="line-added">232         return (secondTicket == null) ? 0 : secondTicket.encPart.getEType();</span>
<span class="line-added">233     }</span>
234 }
</pre>
</td>
</tr>
</table>
<center><a href="CCacheOutputStream.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="CredentialsCache.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>