<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.security.jgss/share/classes/sun/security/krb5/internal/crypto/EType.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DesMacKCksumType.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="HmacMd5ArcFourCksumType.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.security.jgss/share/classes/sun/security/krb5/internal/crypto/EType.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 46 //see dataSize() below
 47 
 48 public abstract class EType {
 49 
 50     private static final boolean DEBUG = Krb5.DEBUG;
 51     private static boolean allowWeakCrypto;
 52 
 53     static {
 54         initStatic();
 55     }
 56 
 57     public static void initStatic() {
 58         boolean allowed = false;
 59         try {
 60             Config cfg = Config.getInstance();
 61             allowed = cfg.getBooleanObject(&quot;libdefaults&quot;, &quot;allow_weak_crypto&quot;)
 62                     == Boolean.TRUE;
 63         } catch (Exception exc) {
 64             if (DEBUG) {
 65                 System.out.println (&quot;Exception in getting allow_weak_crypto, &quot; +
<span class="line-modified"> 66                                     &quot;using default value &quot; +</span>
 67                                     exc.getMessage());
 68             }
 69         }
 70         allowWeakCrypto = allowed;
 71     }
 72 
 73     public static EType getInstance  (int eTypeConst)
 74         throws KdcErrException {
 75         EType eType = null;
 76         String eTypeName = null;
 77         switch (eTypeConst) {
 78         case EncryptedData.ETYPE_NULL:
 79             eType = new NullEType();
 80             eTypeName = &quot;sun.security.krb5.internal.crypto.NullEType&quot;;
 81             break;
 82         case EncryptedData.ETYPE_DES_CBC_CRC:
 83             eType = new DesCbcCrcEType();
 84             eTypeName = &quot;sun.security.krb5.internal.crypto.DesCbcCrcEType&quot;;
 85             break;
 86         case EncryptedData.ETYPE_DES_CBC_MD5:
</pre>
<hr />
<pre>
239             // The last 2 etypes are now weak ones
240             return Arrays.copyOfRange(result, 0, result.length - 2);
241         }
242         return result;
243     }
244 
245     /**
246      * Retrieves the default etypes from the configuration file, or
247      * if that&#39;s not available, return the built-in list of default etypes.
248      * This result is always non-empty. If no etypes are found,
249      * an exception is thrown.
250      */
251     public static int[] getDefaults(String configName)
252             throws KrbException {
253         Config config = null;
254         try {
255             config = Config.getInstance();
256         } catch (KrbException exc) {
257             if (DEBUG) {
258                 System.out.println(&quot;Exception while getting &quot; +
<span class="line-modified">259                     configName + exc.getMessage());</span>
260                 System.out.println(&quot;Using default builtin etypes&quot;);
261             }
262             return getBuiltInDefaults();
263         }
264         return config.defaultEtype(configName);
265     }
266 
267     /**
268      * Retrieve the default etypes from the configuration file for
269      * those etypes for which there are corresponding keys.
270      * Used in scenario we have some keys from a keytab with etypes
271      * different from those named in configName. Then, in order
272      * to decrypt an AS-REP, we should only ask for etypes for which
273      * we have keys.
274      */
275     public static int[] getDefaults(String configName, EncryptionKey[] keys)
276             throws KrbException {
277         int[] answer = getDefaults(configName);
278 
279         List&lt;Integer&gt; list = new ArrayList&lt;&gt;(answer.length);
</pre>
</td>
<td>
<hr />
<pre>
 46 //see dataSize() below
 47 
 48 public abstract class EType {
 49 
 50     private static final boolean DEBUG = Krb5.DEBUG;
 51     private static boolean allowWeakCrypto;
 52 
 53     static {
 54         initStatic();
 55     }
 56 
 57     public static void initStatic() {
 58         boolean allowed = false;
 59         try {
 60             Config cfg = Config.getInstance();
 61             allowed = cfg.getBooleanObject(&quot;libdefaults&quot;, &quot;allow_weak_crypto&quot;)
 62                     == Boolean.TRUE;
 63         } catch (Exception exc) {
 64             if (DEBUG) {
 65                 System.out.println (&quot;Exception in getting allow_weak_crypto, &quot; +
<span class="line-modified"> 66                                     &quot;using default value: &quot; +</span>
 67                                     exc.getMessage());
 68             }
 69         }
 70         allowWeakCrypto = allowed;
 71     }
 72 
 73     public static EType getInstance  (int eTypeConst)
 74         throws KdcErrException {
 75         EType eType = null;
 76         String eTypeName = null;
 77         switch (eTypeConst) {
 78         case EncryptedData.ETYPE_NULL:
 79             eType = new NullEType();
 80             eTypeName = &quot;sun.security.krb5.internal.crypto.NullEType&quot;;
 81             break;
 82         case EncryptedData.ETYPE_DES_CBC_CRC:
 83             eType = new DesCbcCrcEType();
 84             eTypeName = &quot;sun.security.krb5.internal.crypto.DesCbcCrcEType&quot;;
 85             break;
 86         case EncryptedData.ETYPE_DES_CBC_MD5:
</pre>
<hr />
<pre>
239             // The last 2 etypes are now weak ones
240             return Arrays.copyOfRange(result, 0, result.length - 2);
241         }
242         return result;
243     }
244 
245     /**
246      * Retrieves the default etypes from the configuration file, or
247      * if that&#39;s not available, return the built-in list of default etypes.
248      * This result is always non-empty. If no etypes are found,
249      * an exception is thrown.
250      */
251     public static int[] getDefaults(String configName)
252             throws KrbException {
253         Config config = null;
254         try {
255             config = Config.getInstance();
256         } catch (KrbException exc) {
257             if (DEBUG) {
258                 System.out.println(&quot;Exception while getting &quot; +
<span class="line-modified">259                     configName + &quot;: &quot; + exc.getMessage());</span>
260                 System.out.println(&quot;Using default builtin etypes&quot;);
261             }
262             return getBuiltInDefaults();
263         }
264         return config.defaultEtype(configName);
265     }
266 
267     /**
268      * Retrieve the default etypes from the configuration file for
269      * those etypes for which there are corresponding keys.
270      * Used in scenario we have some keys from a keytab with etypes
271      * different from those named in configName. Then, in order
272      * to decrypt an AS-REP, we should only ask for etypes for which
273      * we have keys.
274      */
275     public static int[] getDefaults(String configName, EncryptionKey[] keys)
276             throws KrbException {
277         int[] answer = getDefaults(configName);
278 
279         List&lt;Integer&gt; list = new ArrayList&lt;&gt;(answer.length);
</pre>
</td>
</tr>
</table>
<center><a href="DesMacKCksumType.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="HmacMd5ArcFourCksumType.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>