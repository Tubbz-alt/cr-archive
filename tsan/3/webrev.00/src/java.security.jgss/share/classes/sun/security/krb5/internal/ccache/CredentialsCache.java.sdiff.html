<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.security.jgss/share/classes/sun/security/krb5/internal/ccache/CredentialsCache.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Credentials.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="FileCredentialsCache.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.security.jgss/share/classes/sun/security/krb5/internal/ccache/CredentialsCache.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 15  *
 16  * You should have received a copy of the GNU General Public License version
 17  * 2 along with this work; if not, write to the Free Software Foundation,
 18  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 19  *
 20  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 21  * or visit www.oracle.com if you need additional information or have any
 22  * questions.
 23  */
 24 
 25 /*
 26  *
 27  *  (C) Copyright IBM Corp. 1999 All Rights Reserved.
 28  *  Copyright 1997 The Open Group Research Institute.  All rights reserved.
 29  */
 30 
 31 package sun.security.krb5.internal.ccache;
 32 
 33 import sun.security.krb5.*;
 34 import sun.security.krb5.internal.*;
<span class="line-modified"> 35 import java.util.StringTokenizer;</span>
<span class="line-modified"> 36 import java.util.Vector;</span>
 37 import java.io.IOException;
<span class="line-removed"> 38 import java.io.File;</span>
<span class="line-removed"> 39 import java.io.FileInputStream;</span>
<span class="line-removed"> 40 import java.io.FileOutputStream;</span>
<span class="line-removed"> 41 import java.io.BufferedReader;</span>
<span class="line-removed"> 42 import java.io.InputStreamReader;</span>
 43 
 44 /**
 45  * CredentialsCache stores credentials(tickets, session keys, etc) in a semi-permanent store
 46  * for later use by different program.
 47  *
 48  * @author Yanni Zhang
 49  */
 50 public abstract class CredentialsCache {
 51     static CredentialsCache singleton = null;
 52     static String cacheName;
<span class="line-removed"> 53     private static boolean DEBUG = Krb5.DEBUG;</span>
 54 
 55     public static CredentialsCache getInstance(PrincipalName principal) {
 56         return FileCredentialsCache.acquireInstance(principal, null);
 57     }
 58 
 59     public static CredentialsCache getInstance(String cache) {
 60         if ((cache.length() &gt;= 5) &amp;&amp; cache.substring(0, 5).equalsIgnoreCase(&quot;FILE:&quot;)) {
 61             return FileCredentialsCache.acquireInstance(null, cache.substring(5));
 62         }
 63         // XXX else, memory credential cache
 64         // default is file credential cache.
 65         return FileCredentialsCache.acquireInstance(null, cache);
 66     }
 67 
 68     public static CredentialsCache getInstance(PrincipalName principal,
 69                                                String cache) {
 70 
 71         // XXX Modify this to use URL framework of the JDK
 72         if (cache != null &amp;&amp;
 73             (cache.length() &gt;= 5) &amp;&amp;
</pre>
<hr />
<pre>
103         }
104         // else return file credentials cache
105         // default is file credentials cache.
106         return (FileCredentialsCache.New(principal, name));
107     }
108 
109     public static CredentialsCache create(PrincipalName principal) {
110         // create a default credentials cache for a specified principal
111         return (FileCredentialsCache.New(principal));
112     }
113 
114     public static String cacheName() {
115         return cacheName;
116     }
117 
118     public abstract PrincipalName getPrimaryPrincipal();
119     public abstract void update(Credentials c);
120     public abstract void save() throws IOException, KrbException;
121     public abstract Credentials[] getCredsList();
122     public abstract Credentials getDefaultCreds();

123     public abstract Credentials getCreds(PrincipalName sname);
124     public abstract Credentials getCreds(LoginOptions options, PrincipalName sname);























































125 }
</pre>
</td>
<td>
<hr />
<pre>
 15  *
 16  * You should have received a copy of the GNU General Public License version
 17  * 2 along with this work; if not, write to the Free Software Foundation,
 18  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 19  *
 20  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 21  * or visit www.oracle.com if you need additional information or have any
 22  * questions.
 23  */
 24 
 25 /*
 26  *
 27  *  (C) Copyright IBM Corp. 1999 All Rights Reserved.
 28  *  Copyright 1997 The Open Group Research Institute.  All rights reserved.
 29  */
 30 
 31 package sun.security.krb5.internal.ccache;
 32 
 33 import sun.security.krb5.*;
 34 import sun.security.krb5.internal.*;
<span class="line-modified"> 35 </span>
<span class="line-modified"> 36 import java.util.List;</span>
 37 import java.io.IOException;





 38 
 39 /**
 40  * CredentialsCache stores credentials(tickets, session keys, etc) in a semi-permanent store
 41  * for later use by different program.
 42  *
 43  * @author Yanni Zhang
 44  */
 45 public abstract class CredentialsCache {
 46     static CredentialsCache singleton = null;
 47     static String cacheName;

 48 
 49     public static CredentialsCache getInstance(PrincipalName principal) {
 50         return FileCredentialsCache.acquireInstance(principal, null);
 51     }
 52 
 53     public static CredentialsCache getInstance(String cache) {
 54         if ((cache.length() &gt;= 5) &amp;&amp; cache.substring(0, 5).equalsIgnoreCase(&quot;FILE:&quot;)) {
 55             return FileCredentialsCache.acquireInstance(null, cache.substring(5));
 56         }
 57         // XXX else, memory credential cache
 58         // default is file credential cache.
 59         return FileCredentialsCache.acquireInstance(null, cache);
 60     }
 61 
 62     public static CredentialsCache getInstance(PrincipalName principal,
 63                                                String cache) {
 64 
 65         // XXX Modify this to use URL framework of the JDK
 66         if (cache != null &amp;&amp;
 67             (cache.length() &gt;= 5) &amp;&amp;
</pre>
<hr />
<pre>
 97         }
 98         // else return file credentials cache
 99         // default is file credentials cache.
100         return (FileCredentialsCache.New(principal, name));
101     }
102 
103     public static CredentialsCache create(PrincipalName principal) {
104         // create a default credentials cache for a specified principal
105         return (FileCredentialsCache.New(principal));
106     }
107 
108     public static String cacheName() {
109         return cacheName;
110     }
111 
112     public abstract PrincipalName getPrimaryPrincipal();
113     public abstract void update(Credentials c);
114     public abstract void save() throws IOException, KrbException;
115     public abstract Credentials[] getCredsList();
116     public abstract Credentials getDefaultCreds();
<span class="line-added">117     public abstract sun.security.krb5.Credentials getInitialCreds();</span>
118     public abstract Credentials getCreds(PrincipalName sname);
119     public abstract Credentials getCreds(LoginOptions options, PrincipalName sname);
<span class="line-added">120     public abstract void addConfigEntry(ConfigEntry e);</span>
<span class="line-added">121     public abstract List&lt;ConfigEntry&gt; getConfigEntries();</span>
<span class="line-added">122 </span>
<span class="line-added">123     public ConfigEntry getConfigEntry(String name) {</span>
<span class="line-added">124         List&lt;ConfigEntry&gt; entries = getConfigEntries();</span>
<span class="line-added">125         if (entries != null) {</span>
<span class="line-added">126             for (ConfigEntry e : entries) {</span>
<span class="line-added">127                 if (e.getName().equals(name)) {</span>
<span class="line-added">128                     return e;</span>
<span class="line-added">129                 }</span>
<span class="line-added">130             }</span>
<span class="line-added">131         }</span>
<span class="line-added">132         return null;</span>
<span class="line-added">133     }</span>
<span class="line-added">134 </span>
<span class="line-added">135     public static class ConfigEntry {</span>
<span class="line-added">136 </span>
<span class="line-added">137         public ConfigEntry(String name, PrincipalName princ, byte[] data) {</span>
<span class="line-added">138             this.name = name;</span>
<span class="line-added">139             this.princ = princ;</span>
<span class="line-added">140             this.data = data;</span>
<span class="line-added">141         }</span>
<span class="line-added">142 </span>
<span class="line-added">143         private final String name;</span>
<span class="line-added">144         private final PrincipalName princ;</span>
<span class="line-added">145         private final byte[] data; // not worth cloning</span>
<span class="line-added">146 </span>
<span class="line-added">147         public String getName() {</span>
<span class="line-added">148             return name;</span>
<span class="line-added">149         }</span>
<span class="line-added">150 </span>
<span class="line-added">151         public PrincipalName getPrinc() {</span>
<span class="line-added">152             return princ;</span>
<span class="line-added">153         }</span>
<span class="line-added">154 </span>
<span class="line-added">155         public byte[] getData() {</span>
<span class="line-added">156             return data;</span>
<span class="line-added">157         }</span>
<span class="line-added">158 </span>
<span class="line-added">159         @Override</span>
<span class="line-added">160         public String toString() {</span>
<span class="line-added">161             return name + (princ != null ? (&quot;.&quot; + princ) : &quot;&quot;)</span>
<span class="line-added">162                     + &quot;: &quot; + new String(data);</span>
<span class="line-added">163         }</span>
<span class="line-added">164 </span>
<span class="line-added">165         public PrincipalName getSName() {</span>
<span class="line-added">166             try {</span>
<span class="line-added">167                 return new PrincipalName(&quot;krb5_ccache_conf_data/&quot; + name</span>
<span class="line-added">168                         + (princ != null ? (&quot;/&quot; + princ) : &quot;&quot;)</span>
<span class="line-added">169                         + &quot;@X-CACHECONF:&quot;);</span>
<span class="line-added">170             } catch (RealmException e) {</span>
<span class="line-added">171                 throw new AssertionError(e);</span>
<span class="line-added">172             }</span>
<span class="line-added">173         }</span>
<span class="line-added">174     }</span>
175 }
</pre>
</td>
</tr>
</table>
<center><a href="Credentials.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="FileCredentialsCache.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>