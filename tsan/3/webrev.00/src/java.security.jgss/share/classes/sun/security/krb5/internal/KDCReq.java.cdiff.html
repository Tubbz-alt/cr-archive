<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.security.jgss/share/classes/sun/security/krb5/internal/KDCReq.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="KDCOptions.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="KRBError.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.security.jgss/share/classes/sun/security/krb5/internal/KDCReq.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 57,13 ***</span>
   * http://www.ietf.org/rfc/rfc4120.txt&lt;/a&gt;.
   */
  public class KDCReq {
  
      public KDCReqBody reqBody;
      private int pvno;
      private int msgType;
<span class="line-removed">-     private PAData[] pAData = null; //optional</span>
  
      public KDCReq(PAData[] new_pAData, KDCReqBody new_reqBody,
              int req_type) throws IOException {
          pvno = Krb5.PVNO;
          msgType = req_type;
<span class="line-new-header">--- 57,13 ---</span>
   * http://www.ietf.org/rfc/rfc4120.txt&lt;/a&gt;.
   */
  public class KDCReq {
  
      public KDCReqBody reqBody;
<span class="line-added">+     public PAData[] pAData = null; //optional</span>
      private int pvno;
      private int msgType;
  
      public KDCReq(PAData[] new_pAData, KDCReqBody new_reqBody,
              int req_type) throws IOException {
          pvno = Krb5.PVNO;
          msgType = req_type;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 142,27 ***</span>
                  throw new KrbApErrException(Krb5.KRB_AP_ERR_MSG_TYPE);
              }
          } else {
              throw new Asn1Exception(Krb5.ASN1_BAD_ID);
          }
<span class="line-modified">!         if ((der.getData().peekByte() &amp; 0x1F) == 0x03) {</span>
<span class="line-removed">-             subDer = der.getData().getDerValue();</span>
<span class="line-removed">-             DerValue subsubDer = subDer.getData().getDerValue();</span>
<span class="line-removed">-             if (subsubDer.getTag() != DerValue.tag_SequenceOf) {</span>
<span class="line-removed">-                 throw new Asn1Exception(Krb5.ASN1_BAD_ID);</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-             Vector&lt;PAData&gt; v = new Vector&lt;&gt;();</span>
<span class="line-removed">-             while (subsubDer.getData().available() &gt; 0) {</span>
<span class="line-removed">-                 v.addElement(new PAData(subsubDer.getData().getDerValue()));</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-             if (v.size() &gt; 0) {</span>
<span class="line-removed">-                 pAData = new PAData[v.size()];</span>
<span class="line-removed">-                 v.copyInto(pAData);</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-         } else {</span>
<span class="line-removed">-             pAData = null;</span>
<span class="line-removed">-         }</span>
          subDer = der.getData().getDerValue();
          if ((subDer.getTag() &amp; 0x01F) == 0x04) {
              DerValue subsubDer = subDer.getData().getDerValue();
              reqBody = new KDCReqBody(subsubDer, msgType);
          } else {
<span class="line-new-header">--- 142,11 ---</span>
                  throw new KrbApErrException(Krb5.KRB_AP_ERR_MSG_TYPE);
              }
          } else {
              throw new Asn1Exception(Krb5.ASN1_BAD_ID);
          }
<span class="line-modified">!         pAData = PAData.parseSequence(der.getData(), (byte) 0x03, true);</span>
          subDer = der.getData().getDerValue();
          if ((subDer.getTag() &amp; 0x01F) == 0x04) {
              DerValue subsubDer = subDer.getData().getDerValue();
              reqBody = new KDCReqBody(subsubDer, msgType);
          } else {
</pre>
<center><a href="KDCOptions.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="KRBError.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>