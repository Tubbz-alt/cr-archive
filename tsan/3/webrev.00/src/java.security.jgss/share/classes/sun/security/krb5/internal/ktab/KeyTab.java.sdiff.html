<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.security.jgss/share/classes/sun/security/krb5/internal/ktab/KeyTab.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../crypto/dk/DkCrypto.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="KeyTabEntry.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.security.jgss/share/classes/sun/security/krb5/internal/ktab/KeyTab.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
283      * @return an array containing all the service keys, never null
284      */
285     public EncryptionKey[] readServiceKeys(PrincipalName service) {
286         KeyTabEntry entry;
287         EncryptionKey key;
288         int size = entries.size();
289         ArrayList&lt;EncryptionKey&gt; keys = new ArrayList&lt;&gt;(size);
290         if (DEBUG) {
291             System.out.println(&quot;Looking for keys for: &quot; + service);
292         }
293         for (int i = size-1; i &gt;= 0; i--) {
294             entry = entries.elementAt(i);
295             if (entry.service.match(service)) {
296                 if (EType.isSupported(entry.keyType)) {
297                     key = new EncryptionKey(entry.keyblock,
298                                         entry.keyType,
299                                         entry.keyVersion);
300                     keys.add(key);
301                     if (DEBUG) {
302                         System.out.println(&quot;Added key: &quot; + entry.keyType +
<span class="line-modified">303                             &quot;version: &quot; + entry.keyVersion);</span>
304                     }
305                 } else if (DEBUG) {
306                     System.out.println(&quot;Found unsupported keytype (&quot; +
307                         entry.keyType + &quot;) for &quot; + service);
308                 }
309             }
310         }
311         size = keys.size();
312         EncryptionKey[] retVal = keys.toArray(new EncryptionKey[size]);
313 
314         // Sort the keys by kvno. Sometimes we must choose a single key (say,
315         // generate encrypted timestamp in AS-REQ). A key with a higher KVNO
316         // sounds like a newer one.
317         Arrays.sort(retVal, new Comparator&lt;EncryptionKey&gt;() {
318             @Override
319             public int compare(EncryptionKey o1, EncryptionKey o2) {
320                 return o2.getKeyVersionNumber().intValue()
321                         - o1.getKeyVersionNumber().intValue();
322             }
323         });
</pre>
</td>
<td>
<hr />
<pre>
283      * @return an array containing all the service keys, never null
284      */
285     public EncryptionKey[] readServiceKeys(PrincipalName service) {
286         KeyTabEntry entry;
287         EncryptionKey key;
288         int size = entries.size();
289         ArrayList&lt;EncryptionKey&gt; keys = new ArrayList&lt;&gt;(size);
290         if (DEBUG) {
291             System.out.println(&quot;Looking for keys for: &quot; + service);
292         }
293         for (int i = size-1; i &gt;= 0; i--) {
294             entry = entries.elementAt(i);
295             if (entry.service.match(service)) {
296                 if (EType.isSupported(entry.keyType)) {
297                     key = new EncryptionKey(entry.keyblock,
298                                         entry.keyType,
299                                         entry.keyVersion);
300                     keys.add(key);
301                     if (DEBUG) {
302                         System.out.println(&quot;Added key: &quot; + entry.keyType +
<span class="line-modified">303                             &quot;, version: &quot; + entry.keyVersion);</span>
304                     }
305                 } else if (DEBUG) {
306                     System.out.println(&quot;Found unsupported keytype (&quot; +
307                         entry.keyType + &quot;) for &quot; + service);
308                 }
309             }
310         }
311         size = keys.size();
312         EncryptionKey[] retVal = keys.toArray(new EncryptionKey[size]);
313 
314         // Sort the keys by kvno. Sometimes we must choose a single key (say,
315         // generate encrypted timestamp in AS-REQ). A key with a higher KVNO
316         // sounds like a newer one.
317         Arrays.sort(retVal, new Comparator&lt;EncryptionKey&gt;() {
318             @Override
319             public int compare(EncryptionKey o1, EncryptionKey o2) {
320                 return o2.getKeyVersionNumber().intValue()
321                         - o1.getKeyVersionNumber().intValue();
322             }
323         });
</pre>
</td>
</tr>
</table>
<center><a href="../crypto/dk/DkCrypto.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="KeyTabEntry.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>