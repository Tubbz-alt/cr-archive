<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.security.jgss/share/classes/sun/security/krb5/internal/TicketFlags.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Ticket.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="ccache/CCacheInputStream.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.security.jgss/share/classes/sun/security/krb5/internal/TicketFlags.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 34 import sun.security.krb5.internal.util.KerberosFlags;
 35 import sun.security.util.*;
 36 import java.io.IOException;
 37 
 38 /**
 39  * Implements the ASN.1TicketFlags type.
 40  *
 41  *    TicketFlags ::= BIT STRING
 42  *                  {
 43  *                   reserved(0),
 44  *                   forwardable(1),
 45  *                   forwarded(2),
 46  *                   proxiable(3),
 47  *                   proxy(4),
 48  *                   may-postdate(5),
 49  *                   postdated(6),
 50  *                   invalid(7),
 51  *                   renewable(8),
 52  *                   initial(9),
 53  *                   pre-authent(10),
<span class="line-modified"> 54  *                   hw-authent(11)</span>

 55  *                  }
 56  */
 57 public class TicketFlags extends KerberosFlags {
 58     public TicketFlags() {
 59         super(Krb5.TKT_OPTS_MAX + 1);
 60     }
 61 
 62     public TicketFlags (boolean[] flags) throws Asn1Exception {
 63         super(flags);
 64         if (flags.length &gt; Krb5.TKT_OPTS_MAX + 1) {
 65             throw new Asn1Exception(Krb5.BITSTRING_BAD_LENGTH);
 66         }
 67     }
 68 

 69     public TicketFlags(int size, byte[] data) throws Asn1Exception {
 70         super(size, data);
 71         if ((size &gt; data.length * BITS_PER_UNIT) || (size &gt; Krb5.TKT_OPTS_MAX + 1))
 72             throw new Asn1Exception(Krb5.BITSTRING_BAD_LENGTH);
 73     }
 74 
 75     public TicketFlags(DerValue encoding) throws IOException, Asn1Exception {
 76         this(encoding.getUnalignedBitString(true).toBooleanArray());
 77     }
 78 
 79     /**
 80      * Parse (unmarshal) a ticket flag from a DER input stream.  This form
 81      * parsing might be used when expanding a value which is part of
 82      * a constructed sequence and uses explicitly tagged type.
 83      *
 84      * @exception Asn1Exception on error.
 85      * @param data the Der input stream value, which contains one or more marshaled value.
 86      * @param explicitTag tag number.
 87      * @param optional indicate if this data field is optional
 88      * @return an instance of TicketFlags.
</pre>
<hr />
<pre>
161                     sb.append(&quot;MAY-POSTDATE;&quot;);
162                     break;
163                 case 6:
164                     sb.append(&quot;POSTDATED;&quot;);
165                     break;
166                 case 7:
167                     sb.append(&quot;INVALID;&quot;);
168                     break;
169                 case 8:
170                     sb.append(&quot;RENEWABLE;&quot;);
171                     break;
172                 case 9:
173                     sb.append(&quot;INITIAL;&quot;);
174                     break;
175                 case 10:
176                     sb.append(&quot;PRE-AUTHENT;&quot;);
177                     break;
178                 case 11:
179                     sb.append(&quot;HW-AUTHENT;&quot;);
180                     break;



181                 }
182             }
183         }
184         String result = sb.toString();
185         if (result.length() &gt; 0) {
186             result = result.substring(0, result.length() - 1);
187         }
188         return result;
189     }
190 }
</pre>
</td>
<td>
<hr />
<pre>
 34 import sun.security.krb5.internal.util.KerberosFlags;
 35 import sun.security.util.*;
 36 import java.io.IOException;
 37 
 38 /**
 39  * Implements the ASN.1TicketFlags type.
 40  *
 41  *    TicketFlags ::= BIT STRING
 42  *                  {
 43  *                   reserved(0),
 44  *                   forwardable(1),
 45  *                   forwarded(2),
 46  *                   proxiable(3),
 47  *                   proxy(4),
 48  *                   may-postdate(5),
 49  *                   postdated(6),
 50  *                   invalid(7),
 51  *                   renewable(8),
 52  *                   initial(9),
 53  *                   pre-authent(10),
<span class="line-modified"> 54  *                   hw-authent(11),</span>
<span class="line-added"> 55  *                   enc-pa-rep(15)</span>
 56  *                  }
 57  */
 58 public class TicketFlags extends KerberosFlags {
 59     public TicketFlags() {
 60         super(Krb5.TKT_OPTS_MAX + 1);
 61     }
 62 
 63     public TicketFlags (boolean[] flags) throws Asn1Exception {
 64         super(flags);
 65         if (flags.length &gt; Krb5.TKT_OPTS_MAX + 1) {
 66             throw new Asn1Exception(Krb5.BITSTRING_BAD_LENGTH);
 67         }
 68     }
 69 
<span class="line-added"> 70     // Warning: called by NativeCreds.c and nativeccache.c</span>
 71     public TicketFlags(int size, byte[] data) throws Asn1Exception {
 72         super(size, data);
 73         if ((size &gt; data.length * BITS_PER_UNIT) || (size &gt; Krb5.TKT_OPTS_MAX + 1))
 74             throw new Asn1Exception(Krb5.BITSTRING_BAD_LENGTH);
 75     }
 76 
 77     public TicketFlags(DerValue encoding) throws IOException, Asn1Exception {
 78         this(encoding.getUnalignedBitString(true).toBooleanArray());
 79     }
 80 
 81     /**
 82      * Parse (unmarshal) a ticket flag from a DER input stream.  This form
 83      * parsing might be used when expanding a value which is part of
 84      * a constructed sequence and uses explicitly tagged type.
 85      *
 86      * @exception Asn1Exception on error.
 87      * @param data the Der input stream value, which contains one or more marshaled value.
 88      * @param explicitTag tag number.
 89      * @param optional indicate if this data field is optional
 90      * @return an instance of TicketFlags.
</pre>
<hr />
<pre>
163                     sb.append(&quot;MAY-POSTDATE;&quot;);
164                     break;
165                 case 6:
166                     sb.append(&quot;POSTDATED;&quot;);
167                     break;
168                 case 7:
169                     sb.append(&quot;INVALID;&quot;);
170                     break;
171                 case 8:
172                     sb.append(&quot;RENEWABLE;&quot;);
173                     break;
174                 case 9:
175                     sb.append(&quot;INITIAL;&quot;);
176                     break;
177                 case 10:
178                     sb.append(&quot;PRE-AUTHENT;&quot;);
179                     break;
180                 case 11:
181                     sb.append(&quot;HW-AUTHENT;&quot;);
182                     break;
<span class="line-added">183                 case 15:</span>
<span class="line-added">184                     sb.append(&quot;ENC-PA-REP;&quot;);</span>
<span class="line-added">185                     break;</span>
186                 }
187             }
188         }
189         String result = sb.toString();
190         if (result.length() &gt; 0) {
191             result = result.substring(0, result.length() - 1);
192         }
193         return result;
194     }
195 }
</pre>
</td>
</tr>
</table>
<center><a href="Ticket.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="ccache/CCacheInputStream.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>