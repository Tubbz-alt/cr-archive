<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.security.jgss/share/classes/javax/security/auth/kerberos/DelegationPermission.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../macosx/native/libosxkrb5/nativeccache.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="JavaxSecurityAuthKerberosAccessImpl.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.security.jgss/share/classes/javax/security/auth/kerberos/DelegationPermission.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 61  *  DelegationPermission(&quot;\&quot;backup/bar.example.com@EXAMPLE.COM\&quot; \&quot;nfs/home.EXAMPLE.COM@EXAMPLE.COM\&quot;&quot;);
 62  * &lt;/pre&gt;
 63  *
 64  * @since 1.4
 65  */
 66 
 67 public final class DelegationPermission extends BasicPermission
 68     implements java.io.Serializable {
 69 
 70     private static final long serialVersionUID = 883133252142523922L;
 71 
 72     private transient String subordinate, service;
 73 
 74     /**
 75      * Create a new {@code DelegationPermission}
 76      * with the specified subordinate and target principals.
 77      *
 78      * @param principals the name of the subordinate and target principals
 79      *
 80      * @throws NullPointerException if {@code principals} is {@code null}.
<span class="line-modified"> 81      * @throws IllegalArgumentException if {@code principals} is empty.</span>

 82      */
 83     public DelegationPermission(String principals) {
 84         super(principals);
 85         init(principals);
 86     }
 87 
 88     /**
 89      * Create a new {@code DelegationPermission}
 90      * with the specified subordinate and target principals.
 91      *
 92      * @param principals the name of the subordinate and target principals
 93      *
 94      * @param actions should be null.
 95      *
 96      * @throws NullPointerException if {@code principals} is {@code null}.
<span class="line-modified"> 97      * @throws IllegalArgumentException if {@code principals} is empty.</span>

 98      */
 99     public DelegationPermission(String principals, String actions) {
100         super(principals, actions);
101         init(principals);
102     }
103 
104 
105     /**
106      * Initialize the DelegationPermission object.
107      */
108     private void init(String target) {
109 
<span class="line-modified">110         StringTokenizer t = null;</span>
<span class="line-modified">111         if (!target.startsWith(&quot;\&quot;&quot;)) {</span>
<span class="line-modified">112             throw new IllegalArgumentException</span>
<span class="line-modified">113                 (&quot;service principal [&quot; + target +</span>
<span class="line-modified">114                  &quot;] syntax invalid: &quot; +</span>
<span class="line-modified">115                  &quot;improperly quoted&quot;);</span>
<span class="line-modified">116         } else {</span>
<span class="line-modified">117             t = new StringTokenizer(target, &quot;\&quot;&quot;, false);</span>
<span class="line-removed">118             subordinate = t.nextToken();</span>
<span class="line-removed">119             if (t.countTokens() == 2) {</span>
<span class="line-removed">120                 t.nextToken();  // bypass whitespace</span>
<span class="line-removed">121                 service = t.nextToken();</span>
<span class="line-removed">122             } else if (t.countTokens() &gt; 0) {</span>
<span class="line-removed">123                 throw new IllegalArgumentException</span>
<span class="line-removed">124                     (&quot;service principal [&quot; + t.nextToken() +</span>
<span class="line-removed">125                      &quot;] syntax invalid: &quot; +</span>
<span class="line-removed">126                      &quot;improperly quoted&quot;);</span>
127             }
























128         }
129     }
130 
131     /**
132      * Checks if this Kerberos delegation permission object &quot;implies&quot; the
133      * specified permission.
134      * &lt;P&gt;
135      * This method returns true if this {@code DelegationPermission}
136      * is equal to {@code p}, and returns false otherwise.
137      *
138      * @param p the permission to check against.
139      *
140      * @return true if the specified permission is implied by this object,
141      * false if not.
142      */
143     @Override
144     public boolean implies(Permission p) {
145         return equals(p);
146     }
147 
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 61  *  DelegationPermission(&quot;\&quot;backup/bar.example.com@EXAMPLE.COM\&quot; \&quot;nfs/home.EXAMPLE.COM@EXAMPLE.COM\&quot;&quot;);
 62  * &lt;/pre&gt;
 63  *
 64  * @since 1.4
 65  */
 66 
 67 public final class DelegationPermission extends BasicPermission
 68     implements java.io.Serializable {
 69 
 70     private static final long serialVersionUID = 883133252142523922L;
 71 
 72     private transient String subordinate, service;
 73 
 74     /**
 75      * Create a new {@code DelegationPermission}
 76      * with the specified subordinate and target principals.
 77      *
 78      * @param principals the name of the subordinate and target principals
 79      *
 80      * @throws NullPointerException if {@code principals} is {@code null}.
<span class="line-modified"> 81      * @throws IllegalArgumentException if {@code principals} is empty,</span>
<span class="line-added"> 82      *      or does not contain a pair of principals, or is improperly quoted</span>
 83      */
 84     public DelegationPermission(String principals) {
 85         super(principals);
 86         init(principals);
 87     }
 88 
 89     /**
 90      * Create a new {@code DelegationPermission}
 91      * with the specified subordinate and target principals.
 92      *
 93      * @param principals the name of the subordinate and target principals
 94      *
 95      * @param actions should be null.
 96      *
 97      * @throws NullPointerException if {@code principals} is {@code null}.
<span class="line-modified"> 98      * @throws IllegalArgumentException if {@code principals} is empty,</span>
<span class="line-added"> 99      *      or does not contain a pair of principals, or is improperly quoted</span>
100      */
101     public DelegationPermission(String principals, String actions) {
102         super(principals, actions);
103         init(principals);
104     }
105 
106 
107     /**
108      * Initialize the DelegationPermission object.
109      */
110     private void init(String target) {
111 
<span class="line-modified">112         // 7 tokens in a string:</span>
<span class="line-modified">113         //    &quot;subordinate@R1&quot; &quot;service@R2&quot;</span>
<span class="line-modified">114         //    1&lt;------2-----&gt;345&lt;----6---&gt;7</span>
<span class="line-modified">115         StringTokenizer t = new StringTokenizer(target, &quot;\&quot;&quot;, true);</span>
<span class="line-modified">116         try {</span>
<span class="line-modified">117             if (!t.nextToken().equals(&quot;\&quot;&quot;)) { // 1</span>
<span class="line-modified">118                 throw new IllegalArgumentException(&quot;Illegal input [&quot; + target</span>
<span class="line-modified">119                         + &quot;]: improperly quoted&quot;);</span>









120             }
<span class="line-added">121             subordinate = t.nextToken(); // 2</span>
<span class="line-added">122             if (subordinate.equals(&quot;\&quot;&quot;)) {</span>
<span class="line-added">123                 throw new IllegalArgumentException(&quot;Illegal input [&quot; + target</span>
<span class="line-added">124                         + &quot;]: bad subordinate name&quot;);</span>
<span class="line-added">125             }</span>
<span class="line-added">126             t.nextToken(); // 3</span>
<span class="line-added">127             if (!t.nextToken().trim().isEmpty()) { // 4</span>
<span class="line-added">128                 throw new IllegalArgumentException(&quot;Illegal input [&quot; + target</span>
<span class="line-added">129                         + &quot;]: improperly separated&quot;);</span>
<span class="line-added">130             }</span>
<span class="line-added">131             t.nextToken(); // 5</span>
<span class="line-added">132             service = t.nextToken(); // 6</span>
<span class="line-added">133             if (service.equals(&quot;\&quot;&quot;)) {</span>
<span class="line-added">134                 throw new IllegalArgumentException(&quot;Illegal input [&quot; + target</span>
<span class="line-added">135                         + &quot;]: bad service name&quot;);</span>
<span class="line-added">136             }</span>
<span class="line-added">137             t.nextToken(); // 7</span>
<span class="line-added">138         } catch (NoSuchElementException e) {</span>
<span class="line-added">139             throw new IllegalArgumentException(&quot;Illegal input [&quot; + target</span>
<span class="line-added">140                     + &quot;]: not enough input&quot;);</span>
<span class="line-added">141         }</span>
<span class="line-added">142         if (t.hasMoreTokens()) {</span>
<span class="line-added">143             throw new IllegalArgumentException(&quot;Illegal input [&quot; + target</span>
<span class="line-added">144                     + &quot;]: extra input&quot;);</span>
145         }
146     }
147 
148     /**
149      * Checks if this Kerberos delegation permission object &quot;implies&quot; the
150      * specified permission.
151      * &lt;P&gt;
152      * This method returns true if this {@code DelegationPermission}
153      * is equal to {@code p}, and returns false otherwise.
154      *
155      * @param p the permission to check against.
156      *
157      * @return true if the specified permission is implied by this object,
158      * false if not.
159      */
160     @Override
161     public boolean implies(Permission p) {
162         return equals(p);
163     }
164 
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../macosx/native/libosxkrb5/nativeccache.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="JavaxSecurityAuthKerberosAccessImpl.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>