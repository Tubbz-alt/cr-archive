<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/langtools/tools/javac/classreader/8171132/BadConstantValue.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../classfiles/attributes/EnclosingMethod/EnclosingMethodTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../defaultMethods/BadClassfile.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/langtools/tools/javac/classreader/8171132/BadConstantValue.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 132,10 ***</span>
<span class="line-new-header">--- 132,12 ---</span>
          // B is of type &quot;type&quot; and is initialized to that type&#39;s default value.
          File lib = writeFile(classesdir, &quot;Lib.java&quot;, String.format(
                  &quot;class Lib { static final int A = %s; static final %s B = %s; }&quot;,
                  value, type, (type.equals(&quot;boolean&quot;) ? &quot;false&quot; : &quot;0&quot;)));
          compile(&quot;-d&quot;, classesdir.getPath(), lib.getPath());
<span class="line-added">+         // Lib.class may possibly not get a newer timestamp. Make sure .java file won&#39;t get used.</span>
<span class="line-added">+         lib.delete();</span>
          File libClass = new File(classesdir, &quot;Lib.class&quot;);
          // Rewrite the class to only have field B of type &quot;type&quot; and with &quot;value&quot; (potentially
          // out of range).
          swapConstantValues(libClass);
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 145,10 ***</span>
<span class="line-new-header">--- 147,12 ---</span>
          // create a class file with field that has an invalid CONSTANT_String ConstantValue
          File lib = writeFile(classesdir, &quot;Lib.java&quot;, String.format(
                  &quot;class Lib { static final String A = \&quot;hello\&quot;; static final %s CONST = %s; }&quot;,
                  type, type.equals(&quot;boolean&quot;) ? &quot;false&quot; : &quot;0&quot;));
          compile(&quot;-d&quot;, classesdir.getPath(), lib.getPath());
<span class="line-added">+         // Lib.class may possibly not get a newer timestamp. Make sure .java file won&#39;t get used.</span>
<span class="line-added">+         lib.delete();</span>
          File libClass = new File(classesdir, &quot;Lib.class&quot;);
          swapConstantValues(libClass);
  
          BadClassFile badClassFile = loadBadClass(&quot;Lib&quot;);
  
</pre>
<center><a href="../../classfiles/attributes/EnclosingMethod/EnclosingMethodTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../defaultMethods/BadClassfile.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>