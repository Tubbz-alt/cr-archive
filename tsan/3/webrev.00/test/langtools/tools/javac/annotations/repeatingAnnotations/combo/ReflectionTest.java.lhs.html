<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames test/langtools/tools/javac/annotations/repeatingAnnotations/combo/ReflectionTest.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>   1 /*
<a name="1" id="anc1"></a><span class="line-modified">   2  * Copyright (c) 2013, 2016, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.
   8  *
   9  * This code is distributed in the hope that it will be useful, but WITHOUT
  10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  12  * version 2 for more details (a copy is included in the LICENSE file that
  13  * accompanied this code).
  14  *
  15  * You should have received a copy of the GNU General Public License version
  16  * 2 along with this work; if not, write to the Free Software Foundation,
  17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18  *
  19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20  * or visit www.oracle.com if you need additional information or have any
  21  * questions.
  22  */
  23 
  24 /**
  25  * @test
  26  * @bug      8001457 8027477 8163113
  27  * @author   sogoel
  28  * @summary  Reflection api tests
  29  * @modules jdk.compiler
  30  * @build    Helper
  31  * @compile  expectedFiles/ExpectedBase.java expectedFiles/ExpectedContainer.java
  32  * @run main ReflectionTest
  33  */
  34 import java.io.File;
  35 import java.io.IOException;
  36 import java.lang.annotation.Annotation;
  37 import java.net.MalformedURLException;
  38 import java.net.URL;
  39 import java.net.URLClassLoader;
  40 import java.util.ArrayList;
  41 import java.util.Arrays;
  42 import java.util.List;
  43 
  44 import javax.tools.DiagnosticCollector;
  45 import javax.tools.JavaFileObject;
  46 
  47 import expectedFiles.ExpectedBase;
  48 import expectedFiles.ExpectedContainer;
  49 import java.util.Iterator;
  50 import java.util.regex.Pattern;
  51 
  52 /*
  53  * Objective:
  54  * Test the following 6 methods from java.lang.reflect.AnnotatedElement:
  55  * - getAnnotation(Class&lt;T&gt;)
  56  * - getAnnotations()
  57  * - getDeclaredAnnotations()
  58  * - getDeclaredAnnotation(Class&lt;T&gt;)  // new method in JDK8
  59  * - getAnnotationsByType(Class&lt;T&gt;)         // new method in JDK8
  60  * - getDeclaredAnnotationsByType(Class&lt;T&gt;) // new method in JDK8
  61  * for multiple test cases, for example, BasicNonRepeatable case, BasicRepeatable case
  62  * for each of the src types - class, method, field, package
  63  *
  64  * This test uses following three enums:
  65  * 1. TestCase - Defines the ExpectedBase/ExpectedContainer values for each testCase
  66  *             - getTestFiles() - Creates list of JavaFileObjects for the primary
  67  *                                src types (class, method, field, package)
  68  *             - Each testCase is a new scenario with a combination of @Repeatable
  69  *               relationship present/absent in conjunction with @Inherited.
  70  *               For eg: BasicNonRepeatable_Legacy - It is a pre-JDK8 way of writing a single
  71  *                       annotation on a given srcType( class, method, field, package)
  72  *                       BasicRepeatable - It is a JDK8 way of writing repeating annotations
  73  *                       on a given srcType with a @Repeatable relationship
  74  *                       defined between Foo and FooContainer.
  75  *
  76  * 2. SrcType - Defines templates used in creation of test src
  77  *            - Defines getExpectedBase() and getExpectedContainer() for primary src types
  78  * 3. TestMethod - Defines getActualAnnoBase(), getActualAnnoContainer(), getExpectedAnnoBase(),
  79  *                 and getExpectedAnnoContainer() for each of the 6 methods that are being tested
  80  *                 in java.lang.reflect.AnnotatedElement
  81  *
  82  * Test execution flow:
  83  * - Loop over each of the src types and each test cases
  84  * - Creates test src for each flow, compile it, load the class object
  85  * - Run all 6 methods on this class object
  86  * - Get expected and actual annotations for each object and compare them.
  87  * - Increment the error counter if the annotations don&#39;t match.
  88  *
  89  * The test fails if the number of errors is greater than 0.
  90  */
  91 public class ReflectionTest {
  92 
  93     static int errors = 0;
  94     // Variables used in creating test src for a given testcase/testSrcType
  95     static final String TESTPKG = &quot;testpkg&quot;;
  96     static final String TESTMETHOD = &quot;testMethod&quot;;
  97     static final String TESTFIELD = &quot;testField&quot;;
  98     static final String PKGINFONAME = TESTPKG + &quot;.package-info&quot;;
  99     static final String SUPERCLASS = &quot;SuperClass&quot;;
 100     static final String TESTINTERFACE = &quot;TestInterface&quot;;
 101     /*
 102      *  Set it to true to get more debug information
 103      */
 104     static final boolean DEBUG = false;
 105     static boolean CHECKORDERING;
 106 
 107     public static void main(String args[]) throws Exception {
 108         ReflectionTest test = new ReflectionTest();
 109         test.runTest();
 110     }
 111 
 112     public void runTest() throws Exception {
 113 
 114         ClassLoader parentClassLoader = getLoader();
 115         String className = &quot;&quot;;
 116         Iterable&lt;? extends JavaFileObject&gt; files = null;
 117 
 118         for (SrcType srcType : SrcType.getSrcTypes()) {
 119             for (TestCase testCase : TestCase.values()) {
 120                 className = testCase + &quot;_&quot; + srcType;
 121                 debugPrint(&quot;*****************************************&quot;);
 122                 System.out.println(&quot;Running Test for ClassName: &quot; + className);
 123 
 124                 // @Inherited only applicable for class, exclude cases for
 125                 // package, method, field
 126                 if (testCase.name().contains(&quot;Inherited&quot;)
 127                         &amp;&amp; (srcType != SrcType.CLASS)) {
 128                     continue;
 129                 }
 130 
 131                 // Get list of JavaFileObjects to be compiled
 132                 files = testCase.getTestFiles(srcType, className);
 133                 if (srcType == SrcType.PACKAGE) {
 134                     className = TESTPKG + &quot;.&quot; + className;
 135                 }
 136                 DiagnosticCollector&lt;JavaFileObject&gt; diagnostics = new DiagnosticCollector&lt;&gt;();
 137 
 138                 // Compile the list of JavaFileObjects
 139                 try {
 140                     Helper.compileCode(diagnostics, files);
 141                 } catch (Exception ex) {
 142                     printTestSrc(files);
 143                     throw new RuntimeException(
 144                             &quot;Exception when compiling class &quot; + className, ex);
 145                 }
 146 
 147                 // Get Class object for the compiled class
 148                 Class&lt;?&gt; c = loadClass(className, parentClassLoader, Helper.destDir);
 149                 if (c != null) {
 150                     // For the loaded class object, compare expected and actual annotation values
 151                     // for each of the methods under test from java.lang.reflect.AnnotatedElement
 152 
 153 
 154                     // Ignoring following test cases since for now they are
 155                     // failing with ordering issues.
 156                     // @ignore 8025924: Several test cases in repeatingAnnotations/combo/ReflectionTest
 157                     // fail with ordering issues
 158                     List&lt;String&gt; orderingTestFailures = Arrays.asList(
 159                             &quot;SingleOnSuperContainerOnSub_Inherited_Legacy&quot;,
 160                             &quot;SingleOnSuperContainerAndSingleOnSub_Inherited_Legacy&quot;,
 161                             &quot;ContainerAndSingleOnSuperSingleOnSub_Inherited_Legacy&quot;,
 162                             &quot;SingleAnnoWithContainer&quot;,
 163                             &quot;SingleOnSuperContainerAndSingleOnSub_Inherited&quot;,
 164                             &quot;RepeatableOnSuperSingleOnSub_Inherited&quot;,
 165                             &quot;SingleOnSuperRepeatableOnSub_Inherited&quot;,
 166                             &quot;ContainerOnSuperSingleOnSub_Inherited&quot;,
 167                             &quot;SingleOnSuperContainerOnSub_Inherited&quot;,
 168                             &quot;ContainerAndSingleOnSuperSingleOnSub_Inherited&quot;);
 169                     if (orderingTestFailures.contains(testCase.toString())) {
 170                         CHECKORDERING = false;
 171                     } else
 172                         CHECKORDERING = true;
 173 
 174                     checkAnnoValues(srcType, c);
 175                 } else {
 176                     error(&quot;Could not load className = &quot; + c);
 177                 }
 178             }
 179         }
 180 
 181         if (getNumErrors() &gt; 0) {
 182             System.err.println(&quot;Test failed with &quot; + getNumErrors() + &quot; errors&quot;);
 183             throw new RuntimeException();
 184         }
 185     }
 186 
 187     /*
 188      *  Each test case in this enum has the following:
 189      *  - Define each test case with its @ExpectedBase and @ExpectedContainer annotations
 190      *  - Override getTestFiles() that creates list of JavaFileObjects for each case
 191      *    based on the src type.
 192      */
 193     enum TestCase {
 194         BasicNonRepeatable_Legacy(
 195         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="2" id="anc2"></a><span class="line-modified"> 196                 + &quot;getAnnotationVal = \&quot;@Foo(value=0)\&quot;, &quot;</span>
<span class="line-modified"> 197                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;}, &quot;</span>
<span class="line-modified"> 198                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;}, &quot;</span>
<span class="line-modified"> 199                 + &quot;getDeclAnnoVal = \&quot;@Foo(value=0)\&quot;, &quot;</span>
<span class="line-modified"> 200                 + &quot;getAnnosArgs = {\&quot;@Foo(value=0)\&quot;}, &quot;</span>
<span class="line-modified"> 201                 + &quot;getDeclAnnosArgs = {\&quot;@Foo(value=0)\&quot;}) &quot;,</span>
 202         &quot;@ExpectedContainer&quot;) {
 203 
 204             @Override
 205             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
 206                     String className) {
 207                 String anno = &quot;&quot;;
 208                 String replaceVal = &quot;&quot;;
 209                 String testSrc = &quot;&quot;;
 210                 String pkgInfoContents = &quot;&quot;;
 211                 String contents = &quot;&quot;;
 212 
 213                 JavaFileObject pkgFileObj = null;
 214                 JavaFileObject srcFileObj = null;
 215                 Iterable&lt;? extends JavaFileObject&gt; files = null;
 216 
 217                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
 218                         + getExpectedContainer() + &quot;\n&quot;;
 219                 StringBuilder commonStmts = new StringBuilder();
 220                 anno = Helper.ContentVars.BASEANNO.getVal();
 221                 commonStmts.append(Helper.ContentVars.IMPORTEXPECTED.getVal())
 222                         .append(Helper.ContentVars.IMPORTSTMTS.getVal())
 223                         .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
 224                         .append(Helper.ContentVars.BASE.getVal());
 225                 switch (srcType) {
 226                     case PACKAGE:
 227                         /*
 228                         Sample package-info.java
 229                         @ExpectedBase
 230                         @ExpectedContainer
 231                         @Foo(0)
 232                         package testpkg;
 233 
 234                         @Retention(RetentionPolicy.RUNTIME)
 235                         @interface Foo {int value() default Integer.MAX_VALUE;}
 236 
 237                         Sample testSrc:
 238                         package testpkg;
 239                         class A {}
 240                          */
 241                         testSrc = srcType.getTemplate().replace(&quot;#CN&quot;, className);
 242                         contents = testSrc;
 243                         srcFileObj = Helper.getFile(className, contents);
 244 
 245                         replaceVal = expectedVals + &quot;\n&quot; + anno;
 246                         pkgInfoContents = SrcType.PKGINFO.getTemplate()
 247                                 .replace(&quot;#REPLACE1&quot;, replaceVal)
 248                                 .replace(&quot;#REPLACE2&quot;, commonStmts);
 249                         pkgFileObj = Helper.getFile(PKGINFONAME, pkgInfoContents);
 250 
 251                         files = Arrays.asList(pkgFileObj, srcFileObj);
 252                         break;
 253                     default:
 254                         // class, method, field
 255                     /*
 256                         Sample testSrc for class
 257                         @Retention(RetentionPolicy.RUNTIME)
 258                         @interface Foo {int value() default Integer.MAX_VALUE;}
 259 
 260                         @ExpectedBase
 261                         @ExpectedContainer
 262                         @Foo(0)
 263                         class A {}
 264                          */
 265                         replaceVal = expectedVals + anno;
 266                         testSrc = srcType.getTemplate().replace(&quot;#CN&quot;, className)
 267                                 .replace(&quot;#REPLACE&quot;, replaceVal);
 268                         contents = commonStmts + testSrc;
 269                         srcFileObj = Helper.getFile(className, contents);
 270                         files = Arrays.asList(srcFileObj);
 271                 }
 272                 return files;
 273             }
 274         },
 275         SingleAnnoInherited_Legacy(
 276         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="3" id="anc3"></a><span class="line-modified"> 277                 + &quot;getAnnotationVal = \&quot;@Foo(value=0)\&quot;, &quot;</span>
<span class="line-modified"> 278                 + &quot;getAnnotationsVals = {\&quot;@Foo(value=0)\&quot;, \&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;}, &quot;</span>
 279                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;}, &quot;
 280                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;, &quot;
<a name="4" id="anc4"></a><span class="line-modified"> 281                 + &quot;getAnnosArgs = {\&quot;@Foo(value=0)\&quot;}, &quot;</span>
 282                 + &quot;getDeclAnnosArgs = {})&quot;,
 283         &quot;@ExpectedContainer&quot;) {
 284 
 285             @Override
 286             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
 287                     String className) {
 288                 String anno = &quot;&quot;;
 289                 String replaceVal = &quot;&quot;;
 290                 String contents = &quot;&quot;;
 291                 JavaFileObject srcFileObj = null;
 292                 Iterable&lt;? extends JavaFileObject&gt; files = null;
 293 
 294                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
 295                         + getExpectedContainer() + &quot;\n&quot;;
 296                 StringBuilder commonStmts = new StringBuilder();
 297 
 298                 /*
 299                 Sample testSrc:
 300                 @Retention(RetentionPolicy.RUNTIME)
 301                 @Inherited
 302                 @interface Foo {int value() default Integer.MAX_VALUE;}
 303 
 304                 @Foo(0)
 305                 class SuperClass { }
 306 
 307                 @ExpectedBase
 308                 @ExpectedContainer
 309                 class SubClass extends SuperClass {}
 310                  */
 311 
 312                 // @Inherited only works for classes, no switch cases for
 313                 // method, field, package
 314                 anno = Helper.ContentVars.BASEANNO.getVal();
 315                 commonStmts.append(Helper.ContentVars.IMPORTEXPECTED.getVal())
 316                         .append(Helper.ContentVars.IMPORTSTMTS.getVal())
 317                         .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
 318                         .append(Helper.ContentVars.INHERITED.getVal())
 319                         .append(Helper.ContentVars.BASE.getVal());
 320 
 321                 if (srcType == SrcType.CLASS) {
 322                     // Contents for SuperClass
 323                     replaceVal = commonStmts + &quot;\n&quot; + anno;
 324                     String superClassContents = srcType.getTemplate()
 325                             .replace(&quot;#CN&quot;, SUPERCLASS).replace(&quot;#REPLACE&quot;, replaceVal);
 326 
 327                     // Contents for SubClass that extends SuperClass
 328                     replaceVal = expectedVals;
 329                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
 330                             .replace(&quot;#CN&quot;, className).replace(&quot;#SN&quot;, SUPERCLASS)
 331                             .replace(&quot;#REPLACE&quot;, replaceVal);
 332 
 333                     contents = superClassContents + subClassContents;
 334                     srcFileObj = Helper.getFile(className, contents);
 335                     files = Arrays.asList(srcFileObj);
 336                 }
 337                 return files;
 338             }
 339         },
 340         InheritedAnnoOnInterface_Legacy(
 341         &quot;@ExpectedBase(value=Foo.class, &quot;
 342                 + &quot;getAnnotationVal = \&quot;NULL\&quot;, &quot;
 343                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;}, &quot;
 344                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;},&quot;
 345                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;,&quot; + &quot;getAnnosArgs = {},&quot;
 346                 + &quot;getDeclAnnosArgs = {})&quot;,
 347         &quot;@ExpectedContainer&quot;) {
 348 
 349             @Override
 350             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
 351                     String className) {
 352                 String anno = &quot;&quot;;
 353                 String replaceVal = &quot;&quot;;
 354                 String contents = &quot;&quot;;
 355                 JavaFileObject srcFileObj = null;
 356                 Iterable&lt;? extends JavaFileObject&gt; files = null;
 357 
 358                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
 359                         + getExpectedContainer() + &quot;\n&quot;;
 360                 StringBuilder commonStmts = new StringBuilder();
 361 
 362                 /*
 363                 Sample test src:
 364                 @Retention(RetentionPolicy.RUNTIME)
 365                 @Inherited
 366                 @interface Foo {int value() default Integer.MAX_VALUE;}
 367 
 368                 @Foo(0)
 369                 interface TestInterface { }
 370 
 371                 @ExpectedBase
 372                 @ExpectedContainer
 373                 class A implements TestInterface {}
 374                  */
 375                 anno = Helper.ContentVars.BASEANNO.getVal();
 376                 commonStmts.append(Helper.ContentVars.IMPORTEXPECTED.getVal())
 377                         .append(Helper.ContentVars.IMPORTSTMTS.getVal())
 378                         .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
 379                         .append(Helper.ContentVars.INHERITED.getVal())
 380                         .append(Helper.ContentVars.BASE.getVal());
 381 
 382                 if (srcType == SrcType.CLASS) {
 383                     // Contents for TestInterface
 384                     replaceVal = commonStmts + &quot;\n&quot; + anno;
 385                     String interfaceContents = SrcType.INTERFACE.getTemplate()
 386                             .replace(&quot;#IN&quot;, TESTINTERFACE)
 387                             .replace(&quot;#REPLACE&quot;, replaceVal);
 388 
 389                     // Contents for class implementing TestInterface
 390                     replaceVal = expectedVals;
 391                     String classContents = SrcType.INTERFACEIMPL.getTemplate()
 392                             .replace(&quot;#CN&quot;, className).replace(&quot;#IN&quot;, TESTINTERFACE)
 393                             .replace(&quot;#REPLACE&quot;, replaceVal);
 394 
 395                     contents = interfaceContents + classContents;
 396                     srcFileObj = Helper.getFile(className, contents);
 397                     files = Arrays.asList(srcFileObj);
 398                 }
 399                 return files;
 400             }
 401         },
 402         AnnoOnSuperAndSubClass_Inherited_Legacy(
 403         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="5" id="anc5"></a><span class="line-modified"> 404                 + &quot;getAnnotationVal = \&quot;@Foo(value=2)\&quot;, &quot;</span>
<span class="line-modified"> 405                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=2)\&quot;}, &quot;</span>
 406                 + // override every annotation on superClass
<a name="6" id="anc6"></a><span class="line-modified"> 407                 &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=2)\&quot;}, &quot;</span>
 408                 + // ignores inherited annotations
<a name="7" id="anc7"></a><span class="line-modified"> 409                 &quot;getDeclAnnoVal = \&quot;@Foo(value=2)\&quot;, &quot; // ignores inherited</span>
<span class="line-modified"> 410                 + &quot;getAnnosArgs = {\&quot;@Foo(value=2)\&quot;}, &quot;</span>
<span class="line-modified"> 411                 + &quot;getDeclAnnosArgs = { \&quot;@Foo(value=2)\&quot; })&quot;, // ignores inherited</span>
 412         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
 413                 + &quot;getAnnotationVal = \&quot;NULL\&quot;, &quot;
<a name="8" id="anc8"></a><span class="line-modified"> 414                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=2)\&quot;}, &quot;</span>
<span class="line-modified"> 415                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=2)\&quot;}, &quot;</span>
 416                 + // ignores inherited annotations
 417                 &quot;getDeclAnnoVal = \&quot;NULL\&quot;, &quot; + // ignores inherited
 418                 &quot;getAnnosArgs = {}, &quot; + &quot;getDeclAnnosArgs = {})&quot;) { // ignores inherited
 419 
 420             @Override
 421             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
 422                     String className) {
 423                 String anno = &quot;&quot;;
 424                 String replaceVal = &quot;&quot;;
 425                 String contents = &quot;&quot;;
 426                 JavaFileObject srcFileObj = null;
 427                 Iterable&lt;? extends JavaFileObject&gt; files = null;
 428 
 429                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
 430                         + getExpectedContainer() + &quot;\n&quot;;
 431                 StringBuilder commonStmts = new StringBuilder();
 432 
 433                 /*
 434                 Sample test src
 435                 @Retention(RetentionPolicy.RUNTIME)
 436                 @Inherited
 437                 @interface Foo {int value() default Integer.MAX_VALUE;}
 438 
 439                 @Inherited
 440                 @interface FooContainer {
 441                 Foo[] value();
 442                 }
 443 
 444                 @Foo(1)
 445                 class SuperClass { }
 446 
 447                 @ExpectedBase
 448                 @ExpectedContainer
 449                 @Foo(2)
 450                 class SubClass extends SuperClass {}
 451                  */
 452                 // @Inherited only works for classes, no switch cases for
 453                 // method, field, package
 454                 commonStmts.append(Helper.ContentVars.IMPORTEXPECTED.getVal())
 455                         .append(Helper.ContentVars.IMPORTSTMTS.getVal())
 456                         .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
 457                         .append(Helper.ContentVars.INHERITED.getVal())
 458                         .append(Helper.ContentVars.BASE.getVal())
 459                         .append(Helper.ContentVars.INHERITED.getVal())
 460                         .append(Helper.ContentVars.CONTAINER.getVal());
 461 
 462                 if (srcType == SrcType.CLASS) {
 463                     // Contents for SuperClass
 464                     anno = &quot;@Foo(1)&quot;;
 465                     replaceVal = commonStmts + &quot;\n&quot; + anno;
 466                     String superClassContents = srcType.getTemplate()
 467                             .replace(&quot;#CN&quot;, SUPERCLASS).replace(&quot;#REPLACE&quot;, replaceVal);
 468 
 469                     // Contents for SubClass that extends SuperClass
 470                     anno = &quot;@Foo(2)&quot;;
 471                     replaceVal = expectedVals + &quot;\n&quot; + anno;
 472                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
 473                             .replace(&quot;#CN&quot;, className).replace(&quot;#SN&quot;, SUPERCLASS)
 474                             .replace(&quot;#REPLACE&quot;, replaceVal);
 475 
 476                     contents = superClassContents + subClassContents;
 477                     srcFileObj = Helper.getFile(className, contents);
 478                     files = Arrays.asList(srcFileObj);
 479                 }
 480                 return files;
 481             }
 482         },
 483         BasicContainer_Legacy(
<a name="9" id="anc9"></a><span class="line-modified"> 484         &quot;@ExpectedBase(value = Foo.class, &quot;</span>
 485                 + &quot;getAnnotationVal = \&quot;NULL\&quot;,&quot;
<a name="10" id="anc10"></a><span class="line-modified"> 486                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified"> 487                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
 488                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;, &quot; + &quot;getAnnosArgs = {}, &quot;
 489                 + &quot;getDeclAnnosArgs = {} )&quot;,
 490         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="11" id="anc11"></a><span class="line-modified"> 491                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
<span class="line-modified"> 492                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified"> 493                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified"> 494                 + &quot;getDeclAnnoVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
<span class="line-modified"> 495                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified"> 496                 + &quot;getDeclAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;} )&quot;) {</span>
 497 
 498             @Override
 499             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
 500                     String className) {
 501                 String anno = &quot;&quot;;
 502                 String replaceVal = &quot;&quot;;
 503                 String testSrc = &quot;&quot;;
 504                 String pkgInfoContents = &quot;&quot;;
 505                 String contents = &quot;&quot;;
 506 
 507                 JavaFileObject pkgFileObj = null;
 508                 JavaFileObject srcFileObj = null;
 509                 Iterable&lt;? extends JavaFileObject&gt; files = null;
 510 
 511                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
 512                         + getExpectedContainer() + &quot;\n&quot;;
 513                 StringBuilder commonStmts = new StringBuilder();
 514 
 515                 anno = Helper.ContentVars.LEGACYCONTAINER.getVal();
 516                 commonStmts.append(Helper.ContentVars.IMPORTEXPECTED.getVal())
 517                         .append(Helper.ContentVars.IMPORTSTMTS.getVal())
 518                         .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
 519                         .append(Helper.ContentVars.BASE.getVal())
 520                         .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
 521                         .append(Helper.ContentVars.CONTAINER.getVal());
 522                 switch (srcType) {
 523                     case PACKAGE:
 524                         /*
 525                         Sample package-info.java
 526                         @ExpectedBase
 527                         @ExpectedContainer
 528                         @FooContainer(value = {@Foo(1), @Foo(2)})
 529                         package testpkg;
 530 
 531                         @Retention(RetentionPolicy.RUNTIME)
 532                         @interface Foo {int value() default Integer.MAX_VALUE;}
 533 
 534                         @Retention(RetentionPolicy.RUNTIME)
 535                         @interface FooContainer {
 536                         Foo[] value();
 537                         }
 538 
 539                         Sample testSrc:
 540                         package testpkg;
 541                         class A {}
 542                          */
 543                         testSrc = srcType.getTemplate().replace(&quot;#CN&quot;, className);
 544                         contents = testSrc;
 545                         srcFileObj = Helper.getFile(className, contents);
 546 
 547                         replaceVal = &quot;\n&quot; + expectedVals + &quot;\n&quot; + anno;
 548                         pkgInfoContents = SrcType.PKGINFO.getTemplate()
 549                                 .replace(&quot;#REPLACE1&quot;, replaceVal)
 550                                 .replace(&quot;#REPLACE2&quot;, commonStmts);
 551                         pkgFileObj = Helper.getFile(PKGINFONAME, pkgInfoContents);
 552                         files = Arrays.asList(pkgFileObj, srcFileObj);
 553                         break;
 554                     default:
 555                         /*
 556                         Sample testSrc for class:
 557                         @Retention(RetentionPolicy.RUNTIME)
 558                         @Inherited
 559                         @interface Foo {int value() default Integer.MAX_VALUE;}
 560 
 561                         @Retention(RetentionPolicy.RUNTIME)
 562                         @Inherited
 563                         @interface FooContainer {
 564                         Foo[] value();
 565                         }
 566 
 567                         @ExpectedBase
 568                         @ExpectedContainer
 569                         @FooContainer(value = {@Foo(1), @Foo(2)})
 570                         class A {}
 571                          */
 572                         replaceVal = expectedVals + anno;
 573                         testSrc = srcType.getTemplate().replace(&quot;#CN&quot;, className)
 574                                 .replace(&quot;#REPLACE&quot;, replaceVal);
 575                         contents = commonStmts + testSrc;
 576                         srcFileObj = Helper.getFile(className, contents);
 577                         files = Arrays.asList(srcFileObj);
 578                 }
 579                 return files;
 580             }
 581         },
 582         SingleAndContainerOnSuper_Legacy(
<a name="12" id="anc12"></a><span class="line-modified"> 583         &quot;@ExpectedBase(value = Foo.class, &quot;</span>
<span class="line-modified"> 584                 + &quot;getAnnotationVal = \&quot;@Foo(value=0)\&quot;,&quot;</span>
 585                 + &quot;getAnnotationsVals = {&quot;
<a name="13" id="anc13"></a><span class="line-modified"> 586                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
 587                 + &quot;getDeclAnnosVals = {&quot;
<a name="14" id="anc14"></a><span class="line-modified"> 588                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified"> 589                 + &quot;getDeclAnnoVal = \&quot;@Foo(value=0)\&quot;, &quot;</span>
<span class="line-modified"> 590                 + &quot;getAnnosArgs = {\&quot;@Foo(value=0)\&quot;}, &quot;</span>
<span class="line-modified"> 591                 + &quot;getDeclAnnosArgs = {\&quot;@Foo(value=0)\&quot;} )&quot;,</span>
 592         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="15" id="anc15"></a><span class="line-modified"> 593                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
 594                 + &quot;getAnnotationsVals = {&quot;
<a name="16" id="anc16"></a><span class="line-modified"> 595                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
 596                 + &quot;getDeclAnnosVals = {&quot;
<a name="17" id="anc17"></a><span class="line-modified"> 597                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified"> 598                 + &quot;getDeclAnnoVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
<span class="line-modified"> 599                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified"> 600                 + &quot;getDeclAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;} )&quot;) {</span>
 601 
 602             @Override
 603             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
 604                     String className) {
 605                 String anno = &quot;&quot;;
 606                 String replaceVal = &quot;&quot;;
 607                 String testSrc = &quot;&quot;;
 608                 String pkgInfoContents = &quot;&quot;;
 609                 String contents = &quot;&quot;;
 610 
 611                 JavaFileObject pkgFileObj = null;
 612                 JavaFileObject srcFileObj = null;
 613                 Iterable&lt;? extends JavaFileObject&gt; files = null;
 614 
 615                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
 616                         + getExpectedContainer() + &quot;\n&quot;;
 617                 StringBuilder commonStmts = new StringBuilder();
 618 
 619                 anno = Helper.ContentVars.BASEANNO.getVal() +
 620                        Helper.ContentVars.LEGACYCONTAINER.getVal();
 621                 commonStmts.append(Helper.ContentVars.IMPORTEXPECTED.getVal())
 622                         .append(Helper.ContentVars.IMPORTSTMTS.getVal())
 623                         .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
 624                         .append(Helper.ContentVars.BASE.getVal())
 625                         .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
 626                         .append(Helper.ContentVars.CONTAINER.getVal());
 627                 switch (srcType) {
 628                     case PACKAGE:
 629                         /*
 630                         Sample package-info.java
 631                         @ExpectedBase
 632                         @ExpectedContainer
 633                         @Foo(0)
 634                         @FooContainer(value = {@Foo(1), @Foo(2)})
 635                         package testpkg;
 636 
 637                         @Retention(RetentionPolicy.RUNTIME)
 638                         @interface Foo {int value() default Integer.MAX_VALUE;}
 639 
 640                         @Retention(RetentionPolicy.RUNTIME)
 641                         @interface FooContainer {
 642                         Foo[] value();
 643                         }
 644 
 645                         Sample testSrc:
 646                         package testpkg;
 647                         class A {}
 648                          */
 649                         testSrc = srcType.getTemplate().replace(&quot;#CN&quot;, className);
 650                         contents = testSrc;
 651 
 652                         srcFileObj = Helper.getFile(className, contents);
 653 
 654                         replaceVal = &quot;\n&quot; + expectedVals + &quot;\n&quot; + anno;
 655                         pkgInfoContents = SrcType.PKGINFO.getTemplate()
 656                                 .replace(&quot;#REPLACE1&quot;, replaceVal)
 657                                 .replace(&quot;#REPLACE2&quot;, commonStmts);
 658                         pkgFileObj = Helper.getFile(PKGINFONAME, pkgInfoContents);
 659                         files = Arrays.asList(pkgFileObj, srcFileObj);
 660                         break;
 661                     default:
 662                         /*
 663                         Sample testSrc for class:
 664                         @Retention(RetentionPolicy.RUNTIME)
 665                         @Inherited
 666                         @interface Foo {int value() default Integer.MAX_VALUE;}
 667 
 668                         @Retention(RetentionPolicy.RUNTIME)
 669                         @Inherited
 670                         @interface FooContainer {
 671                         Foo[] value();
 672                         }
 673 
 674                         @ExpectedBase
 675                         @ExpectedContainer
 676                         @Foo(0)
 677                         @FooContainer(value = {@Foo(1), @Foo(2)})
 678                         class A {}
 679                          */
 680                         replaceVal = expectedVals + anno;
 681                         testSrc = srcType.getTemplate().replace(&quot;#CN&quot;, className)
 682                                 .replace(&quot;#REPLACE&quot;, replaceVal);
 683                         contents = commonStmts + testSrc;
 684 
 685                         srcFileObj = Helper.getFile(className, contents);
 686                         files = Arrays.asList(srcFileObj);
 687                 }
 688                 return files;
 689             }
 690         },
 691         BasicContainer_Inherited_Legacy(
<a name="18" id="anc18"></a><span class="line-modified"> 692         &quot;@ExpectedBase(value = Foo.class, &quot;</span>
 693                 + &quot;getAnnotationVal = \&quot;NULL\&quot;,&quot;
<a name="19" id="anc19"></a><span class="line-modified"> 694                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
 695                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;}, &quot;
 696                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;, &quot;
 697                 + &quot;getAnnosArgs = {}, &quot;
 698                 + &quot;getDeclAnnosArgs = {} )&quot;,
 699         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="20" id="anc20"></a><span class="line-modified"> 700                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
<span class="line-modified"> 701                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
 702                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;}, &quot;
 703                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;, &quot;
<a name="21" id="anc21"></a><span class="line-modified"> 704                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
 705                 + &quot;getDeclAnnosArgs = {} )&quot;) {
 706 
 707             @Override
 708             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
 709                     String className) {
 710                 String anno = &quot;&quot;;
 711                 String replaceVal = &quot;&quot;;
 712                 String contents = &quot;&quot;;
 713                 JavaFileObject srcFileObj = null;
 714                 Iterable&lt;? extends JavaFileObject&gt; files = null;
 715 
 716                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
 717                         + getExpectedContainer() + &quot;\n&quot;;
 718                 StringBuilder commonStmts = getCommonStmts(false);
 719 
 720                 /*
 721                 Sample testSrc:
 722                 @Retention(RetentionPolicy.RUNTIME)
 723                 @Inherited
 724                 @interface Foo {int value() default Integer.MAX_VALUE;}
 725 
 726                 @Retention(RetentionPolicy.RUNTIME)
 727                 @Inherited
 728                 @interface FooContainer {
 729                 Foo[] value();
 730                 }
 731 
 732                 @FooContainer(value = {@Foo(1), @Foo(2)})
 733                 class SuperClass { }
 734 
 735                 @ExpectedBase
 736                 @ExpectedContainer
 737                 class SubClass extends SuperClass {}
 738                  */
 739                 // @Inherited only works for classes, no switch cases for
 740                 // method, field, package
 741 
 742                 if (srcType == SrcType.CLASS) {
 743                     // Contents for SuperClass
 744                     anno = Helper.ContentVars.LEGACYCONTAINER.getVal();
 745                     replaceVal = commonStmts + &quot;\n&quot; + anno;
 746                     String superClassContents = srcType.getTemplate()
 747                             .replace(&quot;#CN&quot;, SUPERCLASS)
 748                             .replace(&quot;#REPLACE&quot;, replaceVal);
 749 
 750                     // Contents for SubClass that extends SuperClass
 751                     replaceVal = expectedVals;
 752                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
 753                             .replace(&quot;#CN&quot;, className)
 754                             .replace(&quot;#SN&quot;, SUPERCLASS)
 755                             .replace(&quot;#REPLACE&quot;, replaceVal);
 756 
 757                     contents = superClassContents + subClassContents;
 758                     srcFileObj = Helper.getFile(className, contents);
 759                     files = Arrays.asList(srcFileObj);
 760                 }
 761                 return files;
 762             }
 763         },
 764         ContainerOnSuperSingleOnSub_Inherited_Legacy(
 765         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="22" id="anc22"></a><span class="line-modified"> 766                 + &quot;getAnnotationVal = \&quot;@Foo(value=0)\&quot;, &quot;</span>
 767                 + &quot;getAnnotationsVals = {&quot;
<a name="23" id="anc23"></a><span class="line-modified"> 768                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, \&quot;@Foo(value=0)\&quot;}, &quot;</span>
<span class="line-modified"> 769                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;},&quot;</span>
<span class="line-modified"> 770                 + &quot;getDeclAnnoVal = \&quot;@Foo(value=0)\&quot;,&quot;</span>
<span class="line-modified"> 771                 + &quot;getAnnosArgs = {\&quot;@Foo(value=0)\&quot;},&quot;</span>
<span class="line-modified"> 772                 + &quot;getDeclAnnosArgs = {\&quot;@Foo(value=0)\&quot;})&quot;,</span>
 773         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="24" id="anc24"></a><span class="line-modified"> 774                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
 775                 + &quot;getAnnotationsVals = {&quot;
<a name="25" id="anc25"></a><span class="line-modified"> 776                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, \&quot;@Foo(value=0)\&quot;}, &quot;</span>
<span class="line-modified"> 777                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;},&quot;</span>
 778                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;,&quot;
<a name="26" id="anc26"></a><span class="line-modified"> 779                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
 780                 + &quot;getDeclAnnosArgs = {})&quot;) {
 781 
 782             @Override
 783             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
 784                     String className) {
 785                 String anno = &quot;&quot;;
 786                 String replaceVal = &quot;&quot;;
 787                 String contents = &quot;&quot;;
 788                 JavaFileObject srcFileObj = null;
 789                 Iterable&lt;? extends JavaFileObject&gt; files = null;
 790 
 791                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
 792                         + getExpectedContainer() + &quot;\n&quot;;
 793                 StringBuilder commonStmts = getCommonStmts(false);
 794 
 795                 /*
 796                 Sample testSrc:
 797                 @Retention(RetentionPolicy.RUNTIME)
 798                 @Inherited
 799                 @interface Foo {int value() default Integer.MAX_VALUE;}
 800 
 801                 @Retention(RetentionPolicy.RUNTIME)
 802                 @Inherited
 803                 @interface FooContainer {
 804                 Foo[] value();
 805                 }
 806 
 807                 @FooContainer(value = {@Foo(1), @Foo(2)})
 808                 class SuperClass { }
 809 
 810                 @ExpectedBase
 811                 @ExpectedContainer
 812                 @Foo(0)
 813                 class SubClass extends SuperClass {}
 814                  */
 815                 // @Inherited only works for classes, no switch cases for
 816                 // method, field, package
 817 
 818                 if (srcType == SrcType.CLASS) {
 819                     // Contents for SuperClass
 820                     anno = Helper.ContentVars.LEGACYCONTAINER.getVal();
 821                     replaceVal = commonStmts + &quot;\n&quot; + anno;
 822                     String superClassContents = srcType.getTemplate()
 823                             .replace(&quot;#CN&quot;, SUPERCLASS)
 824                             .replace(&quot;#REPLACE&quot;, replaceVal);
 825 
 826                     // Contents for SubClass that extends SuperClass
 827                     anno = Helper.ContentVars.BASEANNO.getVal();
 828                     replaceVal = expectedVals + &quot;\n&quot; + anno;
 829                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
 830                             .replace(&quot;#CN&quot;, className)
 831                             .replace(&quot;#SN&quot;, SUPERCLASS)
 832                             .replace(&quot;#REPLACE&quot;, replaceVal);
 833 
 834                     contents = superClassContents + subClassContents;
 835                     srcFileObj = Helper.getFile(className, contents);
 836                     files = Arrays.asList(srcFileObj);
 837                 }
 838                 return files;
 839             }
 840         },
 841         // @ignore 8025924: Several test cases in repeatingAnnotations/combo/ReflectionTest
 842         // fail with ordering issues
 843         ContainerAndSingleOnSuperSingleOnSub_Inherited_Legacy(
 844         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="27" id="anc27"></a><span class="line-modified"> 845                 + &quot;getAnnotationVal = \&quot;@Foo(value=0)\&quot;, &quot;</span>
 846                 + &quot;getAnnotationsVals = {&quot;
<a name="28" id="anc28"></a><span class="line-modified"> 847                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, \&quot;@Foo(value=0)\&quot;}, &quot;</span>
<span class="line-modified"> 848                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;},&quot;</span>
<span class="line-modified"> 849                 + &quot;getDeclAnnoVal = \&quot;@Foo(value=0)\&quot;,&quot;</span>
<span class="line-modified"> 850                 + &quot;getAnnosArgs = {\&quot;@Foo(value=0)\&quot;},&quot;</span>
<span class="line-modified"> 851                 + &quot;getDeclAnnosArgs = {\&quot;@Foo(value=0)\&quot;})&quot;,</span>
 852         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="29" id="anc29"></a><span class="line-modified"> 853                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
 854                 + &quot;getAnnotationsVals = {&quot;
<a name="30" id="anc30"></a><span class="line-modified"> 855                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, \&quot;@Foo(value=0)\&quot;}, &quot;</span>
<span class="line-modified"> 856                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;},&quot;</span>
 857                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;,&quot;
<a name="31" id="anc31"></a><span class="line-modified"> 858                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
 859                 + &quot;getDeclAnnosArgs = {})&quot;) {
 860 
 861             @Override
 862             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
 863                     String className) {
 864                 String anno = &quot;&quot;;
 865                 String replaceVal = &quot;&quot;;
 866                 String contents = &quot;&quot;;
 867                 JavaFileObject srcFileObj = null;
 868                 Iterable&lt;? extends JavaFileObject&gt; files = null;
 869 
 870                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
 871                         + getExpectedContainer() + &quot;\n&quot;;
 872                 StringBuilder commonStmts = getCommonStmts(false);
 873 
 874                 /*
 875                 Sample testSrc:
 876                 @Retention(RetentionPolicy.RUNTIME)
 877                 @Inherited
 878                 @interface Foo {int value() default Integer.MAX_VALUE;}
 879 
 880                 @Retention(RetentionPolicy.RUNTIME)
 881                 @Inherited
 882                 @interface FooContainer {
 883                 Foo[] value();
 884                 }
 885 
 886                 @FooContainer(value = {@Foo(1), @Foo(2)}) @Foo(3)
 887                 class SuperClass { }
 888 
 889                 @ExpectedBase
 890                 @ExpectedContainer
 891                 @Foo(0)
 892                 class SubClass extends SuperClass {}
 893                  */
 894                 // @Inherited only works for classes, no switch cases for
 895                 // method, field, package
 896 
 897                 if (srcType == SrcType.CLASS) {
 898                     // Contents for SuperClass
 899                     anno = Helper.ContentVars.LEGACYCONTAINER.getVal()
 900                             + &quot;@Foo(3)&quot;;
 901                     replaceVal = commonStmts + &quot;\n&quot; + anno;
 902                     String superClassContents = srcType.getTemplate()
 903                             .replace(&quot;#CN&quot;, SUPERCLASS)
 904                             .replace(&quot;#REPLACE&quot;, replaceVal);
 905 
 906                     // Contents for SubClass that extends SuperClass
 907                     anno = Helper.ContentVars.BASEANNO.getVal();
 908                     replaceVal = expectedVals + &quot;\n&quot; + anno;
 909                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
 910                             .replace(&quot;#CN&quot;, className).replace(&quot;#SN&quot;, SUPERCLASS)
 911                             .replace(&quot;#REPLACE&quot;, replaceVal);
 912 
 913                     contents = superClassContents + subClassContents;
 914                     srcFileObj = Helper.getFile(className, contents);
 915                     files = Arrays.asList(srcFileObj);
 916                 }
 917                 return files;
 918             }
 919         },
 920         // @ignore 8025924: Several test cases in repeatingAnnotations/combo/ReflectionTest
 921         // fail with ordering issues
 922         SingleOnSuperContainerOnSub_Inherited_Legacy(
 923         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="32" id="anc32"></a><span class="line-modified"> 924                 + &quot;getAnnotationVal = \&quot;@Foo(value=0)\&quot;, &quot;</span>
 925                 + &quot;getAnnotationsVals = {&quot;
<a name="33" id="anc33"></a><span class="line-modified"> 926                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified"> 927                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
 928                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;,&quot;
<a name="34" id="anc34"></a><span class="line-modified"> 929                 + &quot;getAnnosArgs = {\&quot;@Foo(value=0)\&quot;},&quot;</span>
 930                 + &quot;getDeclAnnosArgs = {})&quot;,
 931         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="35" id="anc35"></a><span class="line-modified"> 932                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
 933                 + &quot;getAnnotationsVals = {&quot;
<a name="36" id="anc36"></a><span class="line-modified"> 934                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified"> 935                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
<span class="line-modified"> 936                 + &quot;getDeclAnnoVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;,&quot;</span>
<span class="line-modified"> 937                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
<span class="line-modified"> 938                 + &quot;getDeclAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;})&quot;) {</span>
 939 
 940             @Override
 941             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
 942                     String className) {
 943                 String anno = &quot;&quot;;
 944                 String replaceVal = &quot;&quot;;
 945                 String contents = &quot;&quot;;
 946 
 947                 JavaFileObject srcFileObj = null;
 948                 Iterable&lt;? extends JavaFileObject&gt; files = null;
 949 
 950                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
 951                         + getExpectedContainer() + &quot;\n&quot;;
 952                 StringBuilder commonStmts = getCommonStmts(false);
 953 
 954                 /*
 955                 Sample testSrc:
 956                 @Retention(RetentionPolicy.RUNTIME)
 957                 @Inherited
 958                 @interface Foo {int value() default Integer.MAX_VALUE;}
 959 
 960                 @Retention(RetentionPolicy.RUNTIME)
 961                 @Inherited
 962                 @interface FooContainer {
 963                 Foo[] value();
 964                 }
 965 
 966                 @Foo(0)
 967                 class SuperClass { }
 968 
 969                 @ExpectedBase
 970                 @ExpectedContainer
 971                 @FooContainer(value = {@Foo(1), @Foo(2)})
 972                 class SubClass extends SuperClass {}
 973                  */
 974 
 975                 if (srcType == SrcType.CLASS) {
 976                     //Contents for SuperClass
 977                     anno = Helper.ContentVars.BASEANNO.getVal();
 978                     replaceVal = commonStmts + &quot;\n&quot; + anno;
 979                     String superClassContents = srcType.getTemplate()
 980                             .replace(&quot;#CN&quot;, SUPERCLASS)
 981                             .replace(&quot;#REPLACE&quot;, replaceVal);
 982 
 983                     //Contents for SubClass that extends SuperClass
 984                     anno = Helper.ContentVars.LEGACYCONTAINER.getVal();
 985                     replaceVal = expectedVals + &quot;\n&quot; + anno;
 986                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
 987                             .replace(&quot;#CN&quot;, className).replace(&quot;#SN&quot;, SUPERCLASS)
 988                             .replace(&quot;#REPLACE&quot;, replaceVal);
 989 
 990                     contents = superClassContents + subClassContents;
 991                     srcFileObj = Helper.getFile(className, contents);
 992                     files = Arrays.asList(srcFileObj);
 993                 }
 994                 return files;
 995             }
 996         },
 997         // @ignore 8025924: Several test cases in repeatingAnnotations/combo/ReflectionTest
 998         // fail with ordering issues
 999         SingleOnSuperContainerAndSingleOnSub_Inherited_Legacy(
1000         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="37" id="anc37"></a><span class="line-modified">1001                 + &quot;getAnnotationVal = \&quot;@Foo(value=3)\&quot;, &quot;</span>
1002                 + &quot;getAnnotationsVals = {&quot;
<a name="38" id="anc38"></a><span class="line-modified">1003                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, \&quot;@Foo(value=3)\&quot;}, &quot;</span>
1004                 + &quot;getDeclAnnosVals = {&quot;
<a name="39" id="anc39"></a><span class="line-modified">1005                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, \&quot;@Foo(value=3)\&quot;},&quot;</span>
<span class="line-modified">1006                 + &quot;getDeclAnnoVal = \&quot;@Foo(value=3)\&quot;,&quot;</span>
<span class="line-modified">1007                 + &quot;getAnnosArgs = {\&quot;@Foo(value=3)\&quot;},&quot;</span>
<span class="line-modified">1008                 + &quot;getDeclAnnosArgs = {\&quot;@Foo(value=3)\&quot;})&quot;,</span>
1009         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="40" id="anc40"></a><span class="line-modified">1010                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
1011                 + &quot;getAnnotationsVals = {&quot;
<a name="41" id="anc41"></a><span class="line-modified">1012                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, \&quot;@Foo(value=3)\&quot;}, &quot;</span>
1013                 + &quot;getDeclAnnosVals = {&quot;
<a name="42" id="anc42"></a><span class="line-modified">1014                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, \&quot;@Foo(value=3)\&quot;},&quot;</span>
<span class="line-modified">1015                 + &quot;getDeclAnnoVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;,&quot;</span>
<span class="line-modified">1016                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
<span class="line-modified">1017                 + &quot;getDeclAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;})&quot;) {</span>
1018 
1019             @Override
1020             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
1021                     String className) {
1022                 String anno = &quot;&quot;;
1023                 String replaceVal = &quot;&quot;;
1024                 String contents = &quot;&quot;;
1025 
1026                 JavaFileObject srcFileObj = null;
1027                 Iterable&lt;? extends JavaFileObject&gt; files = null;
1028 
1029                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
1030                         + getExpectedContainer() + &quot;\n&quot;;
1031                 StringBuilder commonStmts = getCommonStmts(false);
1032 
1033                 /*
1034                 Sample testSrc:
1035                 @Retention(RetentionPolicy.RUNTIME)
1036                 @Inherited
1037                 @interface Foo {int value() default Integer.MAX_VALUE;}
1038 
1039                 @Retention(RetentionPolicy.RUNTIME)
1040                 @Inherited
1041                 @interface FooContainer {
1042                 Foo[] value();
1043                 }
1044 
1045                 @Foo(0)
1046                 class SuperClass { }
1047 
1048                 @ExpectedBase
1049                 @ExpectedContainer
1050                 @FooContainer(value = {@Foo(1), @Foo(2)}) @Foo(3)
1051                 class SubClass extends SuperClass {}
1052                  */
1053 
1054                 if (srcType == SrcType.CLASS) {
1055                     //Contents for SuperClass
1056                     anno = Helper.ContentVars.BASEANNO.getVal();
1057                     replaceVal = commonStmts + &quot;\n&quot; + anno;
1058                     String superClassContents = srcType.getTemplate()
1059                             .replace(&quot;#CN&quot;, SUPERCLASS)
1060                             .replace(&quot;#REPLACE&quot;, replaceVal);
1061 
1062                     //Contents for SubClass that extends SuperClass
1063                     anno = Helper.ContentVars.LEGACYCONTAINER.getVal()
1064                             + &quot;@Foo(3)&quot;;
1065                     replaceVal = expectedVals + &quot;\n&quot; + anno;
1066                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
1067                             .replace(&quot;#CN&quot;, className).replace(&quot;#SN&quot;, SUPERCLASS)
1068                             .replace(&quot;#REPLACE&quot;, replaceVal);
1069 
1070                     contents = superClassContents + subClassContents;
1071                     srcFileObj = Helper.getFile(className, contents);
1072                     files = Arrays.asList(srcFileObj);
1073                 }
1074                 return files;
1075             }
1076         },
1077         BasicRepeatable(
1078         &quot;@ExpectedBase(value=Foo.class, &quot;
1079                 + &quot;getAnnotationVal = \&quot;NULL\&quot;, &quot;
<a name="43" id="anc43"></a><span class="line-modified">1080                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot; }, &quot;</span>
<span class="line-modified">1081                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
1082                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;,&quot;
<a name="44" id="anc44"></a><span class="line-modified">1083                 + &quot;getAnnosArgs = {\&quot;@Foo(value=1)\&quot;, \&quot;@Foo(value=2)\&quot;},&quot;</span>
<span class="line-modified">1084                 + &quot;getDeclAnnosArgs = {\&quot;@Foo(value=1)\&quot;, \&quot;@Foo(value=2)\&quot;})&quot;,</span>
1085         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="45" id="anc45"></a><span class="line-modified">1086                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;,&quot;</span>
<span class="line-modified">1087                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
<span class="line-modified">1088                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified">1089                 + &quot;getDeclAnnoVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;,&quot;</span>
<span class="line-modified">1090                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
<span class="line-modified">1091                 + &quot;getDeclAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;} )&quot;) {</span>
1092 
1093             @Override
1094             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
1095                     String className) {
1096                 String anno = &quot;&quot;;
1097                 String replaceVal = &quot;&quot;;
1098                 String testSrc = &quot;&quot;;
1099                 String pkgInfoContents = &quot;&quot;;
1100                 String contents = &quot;&quot;;
1101 
1102                 JavaFileObject pkgFileObj = null;
1103                 JavaFileObject srcFileObj = null;
1104                 Iterable&lt;? extends JavaFileObject&gt; files = null;
1105 
1106                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
1107                         + getExpectedContainer() + &quot;\n&quot;;
1108                 StringBuilder commonStmts = new StringBuilder();
1109 
1110                 anno = Helper.ContentVars.REPEATABLEANNO.getVal();
1111                 commonStmts.append(Helper.ContentVars.IMPORTEXPECTED.getVal())
1112                         .append(Helper.ContentVars.IMPORTSTMTS.getVal())
1113                         .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
1114                         .append(Helper.ContentVars.REPEATABLE.getVal())
1115                         .append(Helper.ContentVars.BASE.getVal())
1116                         .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
1117                         .append(Helper.ContentVars.CONTAINER.getVal());
1118                 switch (srcType) {
1119                     case PACKAGE:
1120                         /*
1121                         Sample package-info.java
1122                         @ExpectedBase
1123                         @ExpectedContainer
1124                         @Foo(1) @Foo(2)
1125                         package testpkg;
1126 
1127                         @Retention(RetentionPolicy.RUNTIME)
1128                         @Repeatable(FooContainer.class)
1129                         @interface Foo {int value() default Integer.MAX_VALUE;}
1130 
1131                         @Retention(RetentionPolicy.RUNTIME)
1132                         @interface FooContainer {
1133                         Foo[] value();
1134                         }
1135 
1136                         Sample testSrc:
1137                         package testpkg;
1138                         class A {}
1139                          */
1140                         testSrc = srcType.getTemplate().replace(&quot;#CN&quot;, className);
1141                         contents = testSrc;
1142                         srcFileObj = Helper.getFile(className, contents);
1143 
1144                         replaceVal = expectedVals + &quot;\n&quot; + anno;
1145                         pkgInfoContents = SrcType.PKGINFO.getTemplate()
1146                                 .replace(&quot;#REPLACE1&quot;, replaceVal)
1147                                 .replace(&quot;#REPLACE2&quot;, commonStmts);
1148                         pkgFileObj = Helper.getFile(PKGINFONAME, pkgInfoContents);
1149                         files = Arrays.asList(pkgFileObj, srcFileObj);
1150                         break;
1151                     default:
1152                         /*
1153                         Sample testSrc for class:
1154                         @Retention(RetentionPolicy.RUNTIME)
1155                         @Repeatable(FooContainer.class)
1156                         @interface Foo {int value() default Integer.MAX_VALUE;}
1157 
1158                         @Retention(RetentionPolicy.RUNTIME)
1159                         @interface FooContainer {
1160                         Foo[] value();
1161                         }
1162 
1163                         @ExpectedBase
1164                         @ExpectedContainer
1165                         @Foo(1) @Foo(2)
1166                         class A { }
1167                          */
1168                         replaceVal = expectedVals + anno;
1169                         testSrc = srcType.getTemplate().replace(&quot;#CN&quot;, className)
1170                                 .replace(&quot;#REPLACE&quot;, replaceVal);
1171                         contents = commonStmts + testSrc;
1172                         srcFileObj = Helper.getFile(className, contents);
1173                         files = Arrays.asList(srcFileObj);
1174                 }
1175                 return files;
1176             }
1177         },
1178         BasicContainerRepeatable(
1179         &quot;@ExpectedBase(value=Foo.class, &quot;
1180                 + &quot;getAnnotationVal = \&quot;NULL\&quot;, &quot;
1181                 + &quot;getAnnotationsVals = {&quot;
<a name="46" id="anc46"></a><span class="line-modified">1182                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
1183                 + &quot;getDeclAnnosVals = {&quot;
<a name="47" id="anc47"></a><span class="line-modified">1184                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
1185                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;,&quot;
<a name="48" id="anc48"></a><span class="line-modified">1186                 + &quot;getAnnosArgs = {\&quot;@Foo(value=1)\&quot;, \&quot;@Foo(value=2)\&quot;},&quot;</span>
<span class="line-modified">1187                 + &quot;getDeclAnnosArgs = {\&quot;@Foo(value=1)\&quot;, \&quot;@Foo(value=2)\&quot;})&quot;,</span>
1188         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="49" id="anc49"></a><span class="line-modified">1189                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;,&quot;</span>
1190                 + &quot;getAnnotationsVals = {&quot;
<a name="50" id="anc50"></a><span class="line-modified">1191                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
1192                 + &quot;getDeclAnnosVals = {&quot;
<a name="51" id="anc51"></a><span class="line-modified">1193                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified">1194                 + &quot;getDeclAnnoVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;,&quot;</span>
<span class="line-modified">1195                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
<span class="line-modified">1196                 + &quot;getDeclAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;} )&quot;) {</span>
1197 
1198             @Override
1199             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
1200                     String className) {
1201                 String anno = &quot;&quot;;
1202                 String replaceVal = &quot;&quot;;
1203                 String testSrc = &quot;&quot;;
1204                 String pkgInfoContents = &quot;&quot;;
1205                 String contents = &quot;&quot;;
1206 
1207                 JavaFileObject pkgFileObj = null;
1208                 JavaFileObject srcFileObj = null;
1209                 Iterable&lt;? extends JavaFileObject&gt; files = null;
1210 
1211                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
1212                         + getExpectedContainer() + &quot;\n&quot;;
1213                 StringBuilder commonStmts = new StringBuilder();
1214 
1215                 anno = Helper.ContentVars.LEGACYCONTAINER.getVal();
1216                 commonStmts.append(Helper.ContentVars.IMPORTEXPECTED.getVal())
1217                         .append(Helper.ContentVars.IMPORTSTMTS.getVal())
1218                         .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
1219                         .append(Helper.ContentVars.REPEATABLE.getVal())
1220                         .append(Helper.ContentVars.BASE.getVal())
1221                         .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
1222                         .append(Helper.ContentVars.CONTAINER.getVal());
1223                 switch (srcType) {
1224                     case PACKAGE:
1225                         /*
1226                         Sample package-info.java
1227                         @ExpectedBase
1228                         @ExpectedContainer
1229                         @FooContainer(value = {@Foo(1), @Foo(2)})
1230                         package testpkg;
1231 
1232                         @Retention(RetentionPolicy.RUNTIME)
1233                         @Repeatable(FooContainer.class)
1234                         @interface Foo {int value() default Integer.MAX_VALUE;}
1235 
1236                         @Retention(RetentionPolicy.RUNTIME)
1237                         @interface FooContainer {
1238                         Foo[] value();
1239                         }
1240 
1241                         Sample testSrc:
1242                         package testpkg;
1243                         class A {}
1244                          */
1245                         testSrc = srcType.getTemplate().replace(&quot;#CN&quot;, className);
1246                         contents = testSrc;
1247                         srcFileObj = Helper.getFile(className, contents);
1248 
1249                         replaceVal = expectedVals + &quot;\n&quot; + anno;
1250                         pkgInfoContents = SrcType.PKGINFO.getTemplate()
1251                                 .replace(&quot;#REPLACE1&quot;, replaceVal)
1252                                 .replace(&quot;#REPLACE2&quot;, commonStmts);
1253                         pkgFileObj = Helper.getFile(PKGINFONAME, pkgInfoContents);
1254                         files = Arrays.asList(pkgFileObj, srcFileObj);
1255                         break;
1256                     default:
1257                         /*
1258                         Sample testSrc for class:
1259                         @Retention(RetentionPolicy.RUNTIME)
1260                         @Repeatable(FooContainer.class)
1261                         @interface Foo {int value() default Integer.MAX_VALUE;}
1262 
1263                         @Retention(RetentionPolicy.RUNTIME)
1264                         @interface FooContainer {
1265                         Foo[] value();
1266                         }
1267 
1268                         @ExpectedBase
1269                         @ExpectedContainer
1270                         @FooContainer(value = {@Foo(1), @Foo(2)})
1271                         class A { }
1272                          */
1273                         replaceVal = expectedVals + anno;
1274                         testSrc = srcType.getTemplate().replace(&quot;#CN&quot;, className)
1275                                 .replace(&quot;#REPLACE&quot;, replaceVal);
1276                         contents = commonStmts + testSrc;
1277                         srcFileObj = Helper.getFile(className, contents);
1278                         files = Arrays.asList(srcFileObj);
1279                 }
1280                 return files;
1281             }
1282         },
1283         BasicContainerRepeatable_Inherited(
1284         &quot;@ExpectedBase(value=Foo.class, &quot;
1285                 + &quot;getAnnotationVal = \&quot;NULL\&quot;, &quot;
<a name="52" id="anc52"></a><span class="line-modified">1286                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
1287                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;}, &quot;
1288                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;, &quot;
<a name="53" id="anc53"></a><span class="line-modified">1289                 + &quot;getAnnosArgs = {\&quot;@Foo(value=1)\&quot;, \&quot;@Foo(value=2)\&quot;}, &quot;</span>
1290                 + &quot;getDeclAnnosArgs = {})&quot;,
1291         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="54" id="anc54"></a><span class="line-modified">1292                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
<span class="line-modified">1293                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
1294                 + &quot;getDeclAnnosVals = { \&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;}, &quot;
1295                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;, &quot;
<a name="55" id="anc55"></a><span class="line-modified">1296                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
1297                 + &quot;getDeclAnnosArgs = {})&quot;) {
1298 
1299             @Override
1300             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
1301                     String className) {
1302                 String anno = &quot;&quot;;
1303                 String replaceVal = &quot;&quot;;
1304                 String contents = &quot;&quot;;
1305                 JavaFileObject srcFileObj = null;
1306                 Iterable&lt;? extends JavaFileObject&gt; files = null;
1307 
1308                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
1309                         + getExpectedContainer() + &quot;\n&quot;;
1310                 StringBuilder commonStmts = getCommonStmts(true);
1311                 /*
1312                 Sample testSrc:
1313                 @Retention(RetentionPolicy.RUNTIME)
1314                 @Inherited
1315                 @Repeatable(FooContainer.class)
1316                 @interface Foo {int value() default Integer.MAX_VALUE;}
1317 
1318                 @Retention(RetentionPolicy.RUNTIME)
1319                 @Inherited
1320                 @interface FooContainer {
1321                 Foo[] value();
1322                 }
1323 
1324                 @FooContainer(value = {@Foo(1), @Foo(2)})
1325                 class SuperClass { }
1326 
1327                 @ExpectedBase
1328                 @ExpectedContainer
1329                 class SubClass extends SuperClass { }
1330                  */
1331                 // @Inherited only works for classes, no switch cases for
1332                 // method, field, package
1333                 anno = Helper.ContentVars.LEGACYCONTAINER.getVal();
1334 
1335                 if (srcType == SrcType.CLASS) {
1336                     // Contents for SuperClass
1337                     replaceVal = commonStmts + &quot;\n&quot; + anno;
1338                     String superClassContents = srcType.getTemplate()
1339                             .replace(&quot;#CN&quot;, SUPERCLASS)
1340                             .replace(&quot;#REPLACE&quot;, replaceVal);
1341 
1342                     // Contents for SubClass that extends SuperClass
1343                     replaceVal = expectedVals;
1344                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
1345                             .replace(&quot;#CN&quot;, className)
1346                             .replace(&quot;#SN&quot;, SUPERCLASS)
1347                             .replace(&quot;#REPLACE&quot;, replaceVal);
1348 
1349                     contents = superClassContents + subClassContents;
1350                     srcFileObj = Helper.getFile(className, contents);
1351                     files = Arrays.asList(srcFileObj);
1352                 }
1353                 return files;
1354             }
1355         },
1356         RepeatableAnnoInherited(
1357         &quot;@ExpectedBase(value=Foo.class, &quot;
1358                 + &quot;getAnnotationVal = \&quot;NULL\&quot;, &quot;
<a name="56" id="anc56"></a><span class="line-modified">1359                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
1360                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;}, &quot;
1361                 + // ignores inherited annotations
1362                 &quot;getDeclAnnoVal = \&quot;NULL\&quot;, &quot;
1363                 + // ignores inherited
<a name="57" id="anc57"></a><span class="line-modified">1364                 &quot;getAnnosArgs = {\&quot;@Foo(value=1)\&quot;, \&quot;@Foo(value=2)\&quot;}, &quot;</span>
1365                 + &quot;getDeclAnnosArgs = {})&quot;, // ignores inherited
1366         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="58" id="anc58"></a><span class="line-modified">1367                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
<span class="line-modified">1368                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
1369                 + &quot;getDeclAnnosVals = { \&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;}, &quot;
1370                 + // ignores inherited annotations
1371                 &quot;getDeclAnnoVal = \&quot;NULL\&quot;, &quot;
1372                 + // ignores inherited
<a name="59" id="anc59"></a><span class="line-modified">1373                 &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
1374                 + &quot;getDeclAnnosArgs = {})&quot;) { // ignores inherited
1375 
1376             @Override
1377             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
1378                     String className) {
1379                 String anno = &quot;&quot;;
1380                 String replaceVal = &quot;&quot;;
1381                 String contents = &quot;&quot;;
1382                 JavaFileObject srcFileObj = null;
1383                 Iterable&lt;? extends JavaFileObject&gt; files = null;
1384 
1385                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
1386                         + getExpectedContainer() + &quot;\n&quot;;
1387                 StringBuilder commonStmts = getCommonStmts(true);
1388                 /*
1389                 Sample testSrc:
1390                 @Retention(RetentionPolicy.RUNTIME)
1391                 @Inherited
1392                 @Repeatable(FooContainer.class)
1393                 @interface Foo {int value() default Integer.MAX_VALUE;}
1394 
1395                 @Retention(RetentionPolicy.RUNTIME)
1396                 @Inherited
1397                 @interface FooContainer {
1398                 Foo[] value();
1399                 }
1400 
1401                 @Foo(1) @Foo(2)
1402                 class SuperClass { }
1403 
1404                 @ExpectedBase
1405                 @ExpectedContainer
1406                 class SubClass extends SuperClass { }
1407                  */
1408                 // @Inherited only works for classes, no switch cases for
1409                 // method, field, package
1410                 anno = Helper.ContentVars.REPEATABLEANNO.getVal();
1411 
1412                 if (srcType == SrcType.CLASS) {
1413                     // Contents for SuperClass
1414                     replaceVal = commonStmts + &quot;\n&quot; + anno;
1415                     String superClassContents = srcType.getTemplate()
1416                             .replace(&quot;#CN&quot;, SUPERCLASS)
1417                             .replace(&quot;#REPLACE&quot;, replaceVal);
1418 
1419                     // Contents for SubClass that extends SuperClass
1420                     replaceVal = expectedVals;
1421                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
1422                             .replace(&quot;#CN&quot;, className)
1423                             .replace(&quot;#SN&quot;, SUPERCLASS)
1424                             .replace(&quot;#REPLACE&quot;, replaceVal);
1425 
1426                     contents = superClassContents + subClassContents;
1427                     srcFileObj = Helper.getFile(className, contents);
1428                     files = Arrays.asList(srcFileObj);
1429                 }
1430                 return files;
1431             }
1432         },
1433         // @ignore 8025924: Several test cases in repeatingAnnotations/combo/ReflectionTest
1434         // fail with ordering issues
1435         SingleAnnoWithContainer(
1436         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="60" id="anc60"></a><span class="line-modified">1437                 + &quot;getAnnotationVal = \&quot;@Foo(value=0)\&quot;, &quot;</span>
1438                 + &quot;getAnnotationsVals = {&quot;
<a name="61" id="anc61"></a><span class="line-modified">1439                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
1440                 + &quot;getDeclAnnosVals = {&quot;
<a name="62" id="anc62"></a><span class="line-modified">1441                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
<span class="line-modified">1442                 + &quot;getDeclAnnoVal = \&quot;@Foo(value=0)\&quot;,&quot;</span>
<span class="line-modified">1443                 + &quot;getAnnosArgs = {\&quot;@Foo(value=0)\&quot;, \&quot;@Foo(value=1)\&quot;, \&quot;@Foo(value=2)\&quot;},&quot;</span>
<span class="line-modified">1444                 + &quot;getDeclAnnosArgs = {\&quot;@Foo(value=0)\&quot;, \&quot;@Foo(value=1)\&quot;,\&quot;@Foo(value=2)\&quot;})&quot;,</span>
1445         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="63" id="anc63"></a><span class="line-modified">1446                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
1447                 + &quot;getAnnotationsVals = {&quot;
<a name="64" id="anc64"></a><span class="line-modified">1448                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
1449                 + &quot;getDeclAnnosVals = {&quot;
<a name="65" id="anc65"></a><span class="line-modified">1450                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified">1451                 + &quot;getDeclAnnoVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;,&quot;</span>
<span class="line-modified">1452                 + &quot;getDeclAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
<span class="line-modified">1453                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;})&quot;) {</span>
1454 
1455             @Override
1456             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
1457                     String className) {
1458                 String anno = &quot;&quot;;
1459                 String replaceVal = &quot;&quot;;
1460                 String testSrc = &quot;&quot;;
1461                 String pkgInfoContents = &quot;&quot;;
1462                 String contents = &quot;&quot;;
1463 
1464                 JavaFileObject pkgFileObj = null;
1465                 JavaFileObject srcFileObj = null;
1466                 Iterable&lt;? extends JavaFileObject&gt; files = null;
1467 
1468                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
1469                         + getExpectedContainer() + &quot;\n&quot;;
1470                 StringBuilder commonStmts = new StringBuilder();
1471 
1472                 anno = Helper.ContentVars.BASEANNO.getVal() + &quot; &quot;
1473                         + Helper.ContentVars.LEGACYCONTAINER.getVal();
1474                 commonStmts.append(Helper.ContentVars.IMPORTEXPECTED.getVal())
1475                         .append(Helper.ContentVars.IMPORTSTMTS.getVal())
1476                         .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
1477                         .append(Helper.ContentVars.REPEATABLE.getVal())
1478                         .append(Helper.ContentVars.BASE.getVal())
1479                         .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
1480                         .append(Helper.ContentVars.CONTAINER.getVal());
1481                 switch (srcType) {
1482                     case PACKAGE:
1483                         /*
1484                         Sample package-info.java
1485                         @ExpectedBase
1486                         @ExpectedContainer
1487                         @Foo(0) @FooContainer(value = {@Foo(1), @Foo(2)})
1488                         package testpkg;
1489 
1490                         @Retention(RetentionPolicy.RUNTIME)
1491                         @Repeatable(FooContainer.class)
1492                         @interface Foo {int value() default Integer.MAX_VALUE;}
1493 
1494                         @Retention(RetentionPolicy.RUNTIME)
1495                         @interface FooContainer {
1496                         Foo[] value();
1497                         }
1498 
1499                         Sample testSrc:
1500                         package testpkg;
1501                         class A {}
1502                          */
1503                         testSrc = srcType.getTemplate().replace(&quot;#CN&quot;, className);
1504                         contents = testSrc;
1505                         srcFileObj = Helper.getFile(className, contents);
1506 
1507                         replaceVal = expectedVals + &quot;\n&quot; + anno;
1508                         pkgInfoContents = SrcType.PKGINFO.getTemplate()
1509                                 .replace(&quot;#REPLACE1&quot;, replaceVal)
1510                                 .replace(&quot;#REPLACE2&quot;, commonStmts);
1511                         pkgFileObj = Helper.getFile(PKGINFONAME, pkgInfoContents);
1512                         files = Arrays.asList(pkgFileObj, srcFileObj);
1513                         break;
1514                     default:
1515                         /*
1516                         Sample testSrc:
1517                         @Retention(RetentionPolicy.RUNTIME)
1518                         @Inherited
1519                         @Repeatable(FooContainer.class)
1520                         @interface Foo {int value() default Integer.MAX_VALUE;}
1521 
1522                         @Retention(RetentionPolicy.RUNTIME)
1523                         @Inherited
1524                         @interface FooContainer {
1525                         Foo[] value();
1526                         }
1527 
1528                         @ExpectedBase
1529                         @ExpectedContainer
1530                         @Foo(0) @FooContainer(value = {@Foo(1), @Foo(2)})
1531                         class A { }
1532                          */
1533                         replaceVal = expectedVals + anno;
1534                         testSrc = srcType.getTemplate()
1535                                 .replace(&quot;#CN&quot;, className)
1536                                 .replace(&quot;#REPLACE&quot;, replaceVal);
1537                         contents = commonStmts + testSrc;
1538                         srcFileObj = Helper.getFile(className, contents);
1539                         files = Arrays.asList(srcFileObj);
1540                 }
1541                 return files;
1542             }
1543         },
1544         AnnoOnSuperAndSubClass_Inherited(
1545         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="66" id="anc66"></a><span class="line-modified">1546                 + &quot;getAnnotationVal = \&quot;@Foo(value=1)\&quot;, &quot;</span>
<span class="line-modified">1547                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=1)\&quot; }, &quot;</span>
1548                 + // override every annotation on superClass
<a name="67" id="anc67"></a><span class="line-modified">1549                 &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=1)\&quot;}, &quot;</span>
1550                 + // ignores inherited annotations
<a name="68" id="anc68"></a><span class="line-modified">1551                 &quot;getDeclAnnoVal = \&quot;@Foo(value=1)\&quot;, &quot; // ignores inherited</span>
<span class="line-modified">1552                 + &quot;getAnnosArgs = {\&quot;@Foo(value=1)\&quot;}, &quot;</span>
<span class="line-modified">1553                 + &quot;getDeclAnnosArgs = { \&quot;@Foo(value=1)\&quot; })&quot;, // ignores inherited</span>
1554         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
1555                 + &quot;getAnnotationVal = \&quot;NULL\&quot;, &quot;
<a name="69" id="anc69"></a><span class="line-modified">1556                 + &quot;getAnnotationsVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=1)\&quot; }, &quot;</span>
<span class="line-modified">1557                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=1)\&quot;}, &quot;</span>
1558                 + // ignores inherited annotations
1559                 &quot;getDeclAnnoVal = \&quot;NULL\&quot;, &quot; + // ignores inherited
1560                 &quot;getAnnosArgs = {}, &quot; + &quot;getDeclAnnosArgs = {})&quot;) {
1561 
1562             @Override
1563             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
1564                     String className) {
1565                 String anno = &quot;&quot;;
1566                 String replaceVal = &quot;&quot;;
1567                 String contents = &quot;&quot;;
1568                 JavaFileObject srcFileObj = null;
1569                 Iterable&lt;? extends JavaFileObject&gt; files = null;
1570 
1571                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
1572                         + getExpectedContainer() + &quot;\n&quot;;
1573                 StringBuilder commonStmts = getCommonStmts(true);
1574 
1575                 /*
1576                 Sample testSrc:
1577                 @Retention(RetentionPolicy.RUNTIME)
1578                 @Inherited
1579                 @Repeatable(FooContainer.class)
1580                 @interface Foo {int value() default Integer.MAX_VALUE;}
1581 
1582                 @Retention(RetentionPolicy.RUNTIME)
1583                 @Inherited
1584                 @interface FooContainer {
1585                 Foo[] value();
1586                 }
1587 
1588                 @Foo(0)
1589                 class SuperClass { }
1590 
1591                 @ExpectedBase
1592                 @ExpectedContainer
1593                 @Foo(1)
1594                 class SubClass extends SuperClass { }
1595                  */
1596                 // @Inherited only works for classes, no switch cases for
1597                 // method, field, package
1598 
1599                 if (srcType == SrcType.CLASS) {
1600                     // Contents for SuperClass
1601                     anno = Helper.ContentVars.BASEANNO.getVal();
1602                     replaceVal = commonStmts + &quot;\n&quot; + anno;
1603                     String superClassContents = srcType.getTemplate()
1604                             .replace(&quot;#CN&quot;, SUPERCLASS)
1605                             .replace(&quot;#REPLACE&quot;, replaceVal);
1606 
1607                     // Contents for SubClass that extends SuperClass
1608                     replaceVal = expectedVals + &quot;\n&quot; + &quot;@Foo(1)&quot;;
1609                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
1610                             .replace(&quot;#CN&quot;, className)
1611                             .replace(&quot;#SN&quot;, SUPERCLASS)
1612                             .replace(&quot;#REPLACE&quot;, replaceVal);
1613 
1614                     contents = superClassContents + subClassContents;
1615                     srcFileObj = Helper.getFile(className, contents);
1616                     files = Arrays.asList(srcFileObj);
1617                 }
1618                 return files;
1619             }
1620         },
1621         // @ignore 8025924: Several test cases in repeatingAnnotations/combo/ReflectionTest
1622         // fail with ordering issues
1623         RepeatableOnSuperSingleOnSub_Inherited(
1624         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="70" id="anc70"></a><span class="line-modified">1625                 + &quot;getAnnotationVal = \&quot;@Foo(value=3)\&quot;, &quot;</span>
1626                 + &quot;getAnnotationsVals = {&quot;
<a name="71" id="anc71"></a><span class="line-modified">1627                 + &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=3)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
1628                 + //override every annotation on superClass
<a name="72" id="anc72"></a><span class="line-modified">1629                 &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=3)\&quot;}, &quot;</span>
1630                 + // ignores inherited annotations
<a name="73" id="anc73"></a><span class="line-modified">1631                 &quot;getDeclAnnoVal = \&quot;@Foo(value=3)\&quot;, &quot; // ignores inherited</span>
<span class="line-modified">1632                 + &quot;getAnnosArgs = {\&quot;@Foo(value=3)\&quot;}, &quot;</span>
<span class="line-modified">1633                 + &quot;getDeclAnnosArgs = { \&quot;@Foo(value=3)\&quot; })&quot;, // ignores inherited</span>
1634         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="74" id="anc74"></a><span class="line-modified">1635                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
1636                 + &quot;getAnnotationsVals = {&quot;
<a name="75" id="anc75"></a><span class="line-modified">1637                 + &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=3)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified">1638                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=3)\&quot;}, &quot;</span>
1639                 + // ignores inherited annotations
1640                 &quot;getDeclAnnoVal = \&quot;NULL\&quot;, &quot;
<a name="76" id="anc76"></a><span class="line-modified">1641                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
1642                 + &quot;getDeclAnnosArgs = {}) // ignores inherited &quot;) {
1643 
1644             @Override
1645             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
1646                     String className) {
1647                 String anno = &quot;&quot;;
1648                 String replaceVal = &quot;&quot;;
1649                 String contents = &quot;&quot;;
1650                 JavaFileObject srcFileObj = null;
1651                 Iterable&lt;? extends JavaFileObject&gt; files = null;
1652 
1653                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
1654                         + getExpectedContainer() + &quot;\n&quot;;
1655                 StringBuilder commonStmts = getCommonStmts(true);
1656 
1657                 /*
1658                  Sample testSrc:
1659                  @Retention(RetentionPolicy.RUNTIME)
1660                  @Inherited
1661                  @Repeatable(FooContainer.class)
1662                  @interface Foo {int value() default Integer.MAX_VALUE;}
1663 
1664                  @Retention(RetentionPolicy.RUNTIME)
1665                  @Inherited
1666                  @interface FooContainer {
1667                  Foo[] value();
1668                  }
1669 
1670                  @Foo(1) @Foo(2)
1671                  class SuperClass { }
1672 
1673                  @ExpectedBase
1674                  @ExpectedContainer
1675                  @Foo(3)
1676                  class SubClass extends SuperClass { }
1677                  */
1678                 //@Inherited only works for classes, no switch cases for method, field, package
1679                 if (srcType == SrcType.CLASS) {
1680                     //Contents for SuperClass
1681                     anno = Helper.ContentVars.REPEATABLEANNO.getVal();
1682                     replaceVal = commonStmts + &quot;\n&quot; + anno;
1683                     String superClassContents = srcType.getTemplate()
1684                             .replace(&quot;#CN&quot;, SUPERCLASS)
1685                             .replace(&quot;#REPLACE&quot;, replaceVal);
1686 
1687                     //Contents for SubClass that extends SuperClass
1688                     anno = &quot;@Foo(3)&quot;;
1689                     replaceVal = expectedVals + &quot;\n&quot; + anno;
1690                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
1691                             .replace(&quot;#CN&quot;, className)
1692                             .replace(&quot;#SN&quot;, SUPERCLASS)
1693                             .replace(&quot;#REPLACE&quot;, replaceVal);
1694                     contents = superClassContents + subClassContents;
1695                     srcFileObj = Helper.getFile(className, contents);
1696                     files = Arrays.asList(srcFileObj);
1697                 }
1698                 return files;
1699             }
1700         },
1701         // @ignore 8025924: Several test cases in repeatingAnnotations/combo/ReflectionTest
1702         // fail with ordering issues
1703         SingleOnSuperRepeatableOnSub_Inherited(
1704         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="77" id="anc77"></a><span class="line-modified">1705                 + &quot;getAnnotationVal = \&quot;@Foo(value=0)\&quot;, &quot;</span>
1706                 + &quot;getAnnotationsVals = {&quot;
<a name="78" id="anc78"></a><span class="line-modified">1707                 + &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
1708                 + //override every annotation on superClass
<a name="79" id="anc79"></a><span class="line-modified">1709                 &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
1710                 + // ignores inherited annotations
1711                 &quot;getDeclAnnoVal = \&quot;NULL\&quot;,&quot;// ignores inherited
<a name="80" id="anc80"></a><span class="line-modified">1712                 + &quot;getAnnosArgs = {\&quot;@Foo(value=1)\&quot;, \&quot;@Foo(value=2)\&quot;}, &quot;</span>
<span class="line-modified">1713                 + &quot;getDeclAnnosArgs = { \&quot;@Foo(value=1)\&quot;, \&quot;@Foo(value=2)\&quot;})&quot;,</span>
1714         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="81" id="anc81"></a><span class="line-modified">1715                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
1716                 + &quot;getAnnotationsVals = {&quot;
<a name="82" id="anc82"></a><span class="line-modified">1717                 + &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified">1718                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
1719                 + // ignores inherited annotations
<a name="83" id="anc83"></a><span class="line-modified">1720                 &quot;getDeclAnnoVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;// ignores inherited</span>
<span class="line-modified">1721                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified">1722                 + &quot;getDeclAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;})&quot;) {</span>
1723 
1724             @Override
1725             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
1726                     String className) {
1727                 String anno = &quot;&quot;;
1728                 String replaceVal = &quot;&quot;;
1729                 String contents = &quot;&quot;;
1730                 JavaFileObject srcFileObj = null;
1731                 Iterable&lt;? extends JavaFileObject&gt; files = null;
1732 
1733                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
1734                         + getExpectedContainer() + &quot;\n&quot;;
1735                 StringBuilder commonStmts = getCommonStmts(true);
1736 
1737                 /*
1738                  Sample testSrc:
1739                  @Retention(RetentionPolicy.RUNTIME)
1740                  @Inherited
1741                  @Repeatable(FooContainer.class)
1742                  @interface Foo {int value() default Integer.MAX_VALUE;}
1743 
1744                  @Retention(RetentionPolicy.RUNTIME)
1745                  @Inherited
1746                  @interface FooContainer {
1747                  Foo[] value();
1748                  }
1749 
1750                  @Foo(0)
1751                  class SuperClass { }
1752 
1753                  @ExpectedBase
1754                  @ExpectedContainer
1755                  @Foo(1) @Foo(2)
1756                  class SubClass extends SuperClass { }
1757                  */
1758                 //@Inherited only works for classes, no switch cases for method, field, package
1759                 if (srcType == SrcType.CLASS) {
1760                     //Contents for SuperClass
1761                     anno = Helper.ContentVars.BASEANNO.getVal();
1762                     replaceVal = commonStmts + &quot;\n&quot; + anno;
1763                     String superClassContents = srcType.getTemplate()
1764                             .replace(&quot;#CN&quot;, SUPERCLASS)
1765                             .replace(&quot;#REPLACE&quot;, replaceVal);
1766 
1767                     //Contents for SubClass that extends SuperClass
1768                     anno = Helper.ContentVars.REPEATABLEANNO.getVal();
1769                     replaceVal = expectedVals + &quot;\n&quot; + anno;
1770                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
1771                             .replace(&quot;#CN&quot;, className)
1772                             .replace(&quot;#SN&quot;, SUPERCLASS)
1773                             .replace(&quot;#REPLACE&quot;, replaceVal);
1774 
1775                     contents = superClassContents + subClassContents;
1776                     srcFileObj = Helper.getFile(className, contents);
1777                     files = Arrays.asList(srcFileObj);
1778                 }
1779                 return files;
1780             }
1781         },
1782         // @ignore 8025924: Several test cases in repeatingAnnotations/combo/ReflectionTest
1783         // fail with ordering issues
1784         ContainerOnSuperSingleOnSub_Inherited(
1785         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="84" id="anc84"></a><span class="line-modified">1786                 + &quot;getAnnotationVal = \&quot;@Foo(value=0)\&quot;, &quot;</span>
1787                 + &quot;getAnnotationsVals = {&quot;
<a name="85" id="anc85"></a><span class="line-modified">1788                 + &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified">1789                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;},&quot;</span>
<span class="line-modified">1790                 + &quot;getDeclAnnoVal = \&quot;@Foo(value=0)\&quot;,&quot;</span>
<span class="line-modified">1791                 + &quot;getAnnosArgs = {\&quot;@Foo(value=0)\&quot;},&quot;</span>
<span class="line-modified">1792                 + &quot;getDeclAnnosArgs = {\&quot;@Foo(value=0)\&quot;})&quot;,</span>
1793         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="86" id="anc86"></a><span class="line-modified">1794                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
1795                 + &quot;getAnnotationsVals = {&quot;
<a name="87" id="anc87"></a><span class="line-modified">1796                 + &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified">1797                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;},&quot;</span>
1798                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;,&quot;
<a name="88" id="anc88"></a><span class="line-modified">1799                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
1800                 + &quot;getDeclAnnosArgs = {})&quot;) {
1801 
1802             @Override
1803             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
1804                     String className) {
1805                 String anno = &quot;&quot;;
1806                 String replaceVal = &quot;&quot;;
1807                 String contents = &quot;&quot;;
1808                 JavaFileObject srcFileObj = null;
1809                 Iterable&lt;? extends JavaFileObject&gt; files = null;
1810 
1811                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
1812                         + getExpectedContainer() + &quot;\n&quot;;
1813                 StringBuilder commonStmts = getCommonStmts(true);
1814 
1815                 /*
1816                  Sample testSrc:
1817                  @Retention(RetentionPolicy.RUNTIME)
1818                  @Inherited
1819                  @Repeatable(FooContainer.class)
1820                  @interface Foo {int value() default Integer.MAX_VALUE;}
1821 
1822                  @Retention(RetentionPolicy.RUNTIME)
1823                  @Inherited
1824                  @interface FooContainer {
1825                  Foo[] value();
1826                  }
1827 
1828                  @FooContainer(value = {@Foo(1), @Foo(2)})
1829                  class SuperClass { }
1830 
1831                  @ExpectedBase
1832                  @ExpectedContainer
1833                  @Foo(0)
1834                  class SubClass extends SuperClass { }
1835                  */
1836                 //@Inherited only works for classes, no switch cases for method, field, package
1837                 if (srcType == SrcType.CLASS) {
1838                     //Contents for SuperClass
1839                     anno = Helper.ContentVars.LEGACYCONTAINER.getVal();
1840                     replaceVal = commonStmts + &quot;\n&quot; + anno;
1841                     String superClassContents = srcType.getTemplate()
1842                             .replace(&quot;#CN&quot;, SUPERCLASS)
1843                             .replace(&quot;#REPLACE&quot;, replaceVal);
1844 
1845                     //Contents for SubClass that extends SuperClass
1846                     anno = Helper.ContentVars.BASEANNO.getVal();
1847                     replaceVal = expectedVals + &quot;\n&quot; + anno;
1848                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
1849                             .replace(&quot;#CN&quot;, className)
1850                             .replace(&quot;#SN&quot;, SUPERCLASS)
1851                             .replace(&quot;#REPLACE&quot;, replaceVal);
1852 
1853                     contents = superClassContents + subClassContents;
1854                     srcFileObj = Helper.getFile(className, contents);
1855                     files = Arrays.asList(srcFileObj);
1856                 }
1857                 return files;
1858             }
1859         },
1860         // @ignore 8025924: Several test cases in repeatingAnnotations/combo/ReflectionTest
1861         // fail with ordering issues
1862         SingleOnSuperContainerOnSub_Inherited(
1863         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="89" id="anc89"></a><span class="line-modified">1864                 + &quot;getAnnotationVal = \&quot;@Foo(value=0)\&quot;, &quot;</span>
1865                 + &quot;getAnnotationsVals = {&quot;
<a name="90" id="anc90"></a><span class="line-modified">1866                 + &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified">1867                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
1868                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;,&quot;
<a name="91" id="anc91"></a><span class="line-modified">1869                 + &quot;getAnnosArgs = {\&quot;@Foo(value=1)\&quot;, \&quot;@Foo(value=2)\&quot;},&quot;</span>
<span class="line-modified">1870                 + &quot;getDeclAnnosArgs = {\&quot;@Foo(value=1)\&quot;, \&quot;@Foo(value=2)\&quot;})&quot;,</span>
1871         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="92" id="anc92"></a><span class="line-modified">1872                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
1873                 + &quot;getAnnotationsVals = {&quot;
<a name="93" id="anc93"></a><span class="line-modified">1874                 + &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified">1875                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
<span class="line-modified">1876                 + &quot;getDeclAnnoVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;,&quot;</span>
<span class="line-modified">1877                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
<span class="line-modified">1878                 + &quot;getDeclAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;})&quot;) {</span>
1879 
1880             @Override
1881             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
1882                      String className) {
1883                 String anno = &quot;&quot;;
1884                 String replaceVal = &quot;&quot;;
1885                 String contents = &quot;&quot;;
1886                 JavaFileObject srcFileObj = null;
1887                 Iterable&lt;? extends JavaFileObject&gt; files = null;
1888 
1889                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
1890                         + getExpectedContainer() + &quot;\n&quot;;
1891                 StringBuilder commonStmts = getCommonStmts(true);
1892 
1893                 /*
1894                  Sample testSrc:
1895                  @Retention(RetentionPolicy.RUNTIME)
1896                  @Inherited
1897                  @Repeatable(FooContainer.class)
1898                  @interface Foo {int value() default Integer.MAX_VALUE;}
1899 
1900                  @Retention(RetentionPolicy.RUNTIME)
1901                  @Inherited
1902                  @interface FooContainer {
1903                  Foo[] value();
1904                  }
1905 
1906                  @Foo(0)
1907                  class SuperClass { }
1908 
1909                  @ExpectedBase
1910                  @ExpectedContainer
1911                  @FooContainer(value = {@Foo(1), @Foo(2)})
1912                  class SubClass extends SuperClass { }
1913                  */
1914                 //@Inherited only works for classes, no switch cases for method, field, package
1915                 if (srcType == SrcType.CLASS) {
1916                     //Contents for SuperClass
1917                     anno = Helper.ContentVars.BASEANNO.getVal();
1918                     replaceVal = commonStmts + &quot;\n&quot; + anno;
1919                     String superClassContents = srcType.getTemplate()
1920                             .replace(&quot;#CN&quot;, SUPERCLASS)
1921                             .replace(&quot;#REPLACE&quot;, replaceVal);
1922 
1923                     //Contents for SubClass that extends SuperClass
1924                     anno = Helper.ContentVars.LEGACYCONTAINER.getVal();
1925                     replaceVal = expectedVals + &quot;\n&quot; + anno;
1926                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
1927                             .replace(&quot;#CN&quot;, className)
1928                             .replace(&quot;#SN&quot;, SUPERCLASS)
1929                             .replace(&quot;#REPLACE&quot;, replaceVal);
1930 
1931                     contents = superClassContents + subClassContents;
1932                     srcFileObj = Helper.getFile(className, contents);
1933                     files = Arrays.asList(srcFileObj);
1934                 }
1935                 return files;
1936             }
1937         },
1938         // @ignore 8025924: Several test cases in repeatingAnnotations/combo/ReflectionTest
1939         // fail with ordering issues
1940         SingleOnSuperContainerAndSingleOnSub_Inherited(
1941         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="94" id="anc94"></a><span class="line-modified">1942                 + &quot;getAnnotationVal = \&quot;@Foo(value=3)\&quot;, &quot;</span>
1943                 + &quot;getAnnotationsVals = {&quot;
<a name="95" id="anc95"></a><span class="line-modified">1944                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, \&quot;@Foo(value=3)\&quot;}, &quot;</span>
1945                 + &quot;getDeclAnnosVals = {&quot;
<a name="96" id="anc96"></a><span class="line-modified">1946                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, \&quot;@Foo(value=3)\&quot;},&quot;</span>
<span class="line-modified">1947                 + &quot;getDeclAnnoVal = \&quot;@Foo(value=3)\&quot;,&quot;</span>
<span class="line-modified">1948                 + &quot;getAnnosArgs = {\&quot;@Foo(value=1)\&quot;, \&quot;@Foo(value=2)\&quot;, \&quot;@Foo(value=3)\&quot;},&quot;</span>
<span class="line-modified">1949                 + &quot;getDeclAnnosArgs = {\&quot;@Foo(value=1)\&quot;, \&quot;@Foo(value=2)\&quot;, \&quot;@Foo(value=3)\&quot;})&quot;,</span>
1950         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="97" id="anc97"></a><span class="line-modified">1951                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
1952                 + &quot;getAnnotationsVals = {&quot;
<a name="98" id="anc98"></a><span class="line-modified">1953                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, \&quot;@Foo(value=3)\&quot;}, &quot;</span>
1954                 + &quot;getDeclAnnosVals = {&quot;
<a name="99" id="anc99"></a><span class="line-modified">1955                 +       &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, \&quot;@Foo(value=3)\&quot;},&quot;</span>
<span class="line-modified">1956                 + &quot;getDeclAnnoVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;,&quot;</span>
<span class="line-modified">1957                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
<span class="line-modified">1958                 + &quot;getDeclAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;})&quot;) {</span>
1959 
1960             @Override
1961             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
1962                     String className) {
1963                 String anno = &quot;&quot;;
1964                 String replaceVal = &quot;&quot;;
1965                 String contents = &quot;&quot;;
1966                 JavaFileObject srcFileObj = null;
1967                 Iterable&lt;? extends JavaFileObject&gt; files = null;
1968                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
1969                         + getExpectedContainer() + &quot;\n&quot;;
1970                 StringBuilder commonStmts = getCommonStmts(true);
1971 
1972                 /*
1973                 Sample testSrc:
1974                 @Retention(RetentionPolicy.RUNTIME)
1975                 @Inherited
1976                 @interface Foo {int value() default Integer.MAX_VALUE;}
1977 
1978                 @Retention(RetentionPolicy.RUNTIME)
1979                 @Inherited
1980                 @Repeatable(FooContainer.class)
1981                 @interface FooContainer {
1982                 Foo[] value();
1983                 }
1984 
1985                 @Foo(0)
1986                 class SuperClass { }
1987 
1988                 @ExpectedBase
1989                 @ExpectedContainer
1990                 @FooContainer(value = {@Foo(1), @Foo(2)}) @Foo(3)
1991                 class SubClass extends SuperClass {}
1992                  */
1993 
1994                 if (srcType == SrcType.CLASS) {
1995                     //Contents for SuperClass
1996                     anno = Helper.ContentVars.BASEANNO.getVal();
1997                     replaceVal = commonStmts + &quot;\n&quot; + anno;
1998                     String superClassContents = srcType.getTemplate()
1999                             .replace(&quot;#CN&quot;, SUPERCLASS)
2000                             .replace(&quot;#REPLACE&quot;, replaceVal);
2001 
2002                     //Contents for SubClass that extends SuperClass
2003                     anno = Helper.ContentVars.LEGACYCONTAINER.getVal()
2004                             + &quot;@Foo(3)&quot;;
2005                     replaceVal = expectedVals + &quot;\n&quot; + anno;
2006                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
2007                             .replace(&quot;#CN&quot;, className)
2008                             .replace(&quot;#SN&quot;, SUPERCLASS)
2009                             .replace(&quot;#REPLACE&quot;, replaceVal);
2010 
2011                     contents = superClassContents + subClassContents;
2012                     srcFileObj = Helper.getFile(className, contents);
2013                     files = Arrays.asList(srcFileObj);
2014                 }
2015                 return files;
2016             }
2017         },
2018         // @ignore 8025924: Several test cases in repeatingAnnotations/combo/ReflectionTest
2019         // fail with ordering issues
2020         ContainerAndSingleOnSuperSingleOnSub_Inherited(
2021         &quot;@ExpectedBase(value=Foo.class, &quot;
<a name="100" id="anc100"></a><span class="line-modified">2022                 + &quot;getAnnotationVal = \&quot;@Foo(value=0)\&quot;, &quot;</span>
2023                 + &quot;getAnnotationsVals = {&quot;
<a name="101" id="anc101"></a><span class="line-modified">2024                 + &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified">2025                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;},&quot;</span>
<span class="line-modified">2026                 + &quot;getDeclAnnoVal = \&quot;@Foo(value=0)\&quot;,&quot;</span>
<span class="line-modified">2027                 + &quot;getAnnosArgs = {\&quot;@Foo(value=0)\&quot;},&quot;</span>
<span class="line-modified">2028                 + &quot;getDeclAnnosArgs = {\&quot;@Foo(value=0)\&quot;})&quot;,</span>
2029         &quot;@ExpectedContainer(value=FooContainer.class, &quot;
<a name="102" id="anc102"></a><span class="line-modified">2030                 + &quot;getAnnotationVal = \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;, &quot;</span>
2031                 + &quot;getAnnotationsVals = {&quot;
<a name="103" id="anc103"></a><span class="line-modified">2032                 + &quot;\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;, \&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;}, &quot;</span>
<span class="line-modified">2033                 + &quot;getDeclAnnosVals = {\&quot;ExpectedBase\&quot;, \&quot;ExpectedContainer\&quot;, \&quot;@Foo(value=0)\&quot;},&quot;</span>
2034                 + &quot;getDeclAnnoVal = \&quot;NULL\&quot;,&quot;
<a name="104" id="anc104"></a><span class="line-modified">2035                 + &quot;getAnnosArgs = {\&quot;@FooContainer(value={@Foo(value=1), @Foo(value=2)})\&quot;},&quot;</span>
2036                 + &quot;getDeclAnnosArgs = {})&quot;) {
2037 
2038             @Override
2039             public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
2040                     String className) {
2041                 String anno = &quot;&quot;;
2042                 String replaceVal = &quot;&quot;;
2043                 String contents = &quot;&quot;;
2044                 JavaFileObject srcFileObj = null;
2045                 Iterable&lt;? extends JavaFileObject&gt; files = null;
2046 
2047                 String expectedVals = &quot;\n&quot; + getExpectedBase() + &quot;\n&quot;
2048                         + getExpectedContainer() + &quot;\n&quot;;
2049                 StringBuilder commonStmts = getCommonStmts(true);
2050 
2051                 /*
2052                  Sample testSrc:
2053                  @Retention(RetentionPolicy.RUNTIME)
2054                  @Inherited
2055                  @Repeatable(FooContainer.class)
2056                  @interface Foo {int value() default Integer.MAX_VALUE;}
2057 
2058                  @Retention(RetentionPolicy.RUNTIME)
2059                  @Inherited
2060                  @interface FooContainer {
2061                  Foo[] value();
2062                  }
2063 
2064                  @FooContainer(value = {@Foo(1), @Foo(2)})
2065                  @Foo(3)
2066                  class SuperClass { }
2067 
2068                  @ExpectedBase
2069                  @ExpectedContainer
2070                  @Foo(0)
2071                  class SubClass extends SuperClass { }
2072                  */
2073 
2074                 //@Inherited only works for classes, no switch cases for method, field, package
2075                 if (srcType == SrcType.CLASS) {
2076                     //Contents for SuperClass
2077                     anno = Helper.ContentVars.LEGACYCONTAINER.getVal()
2078                             + &quot;@Foo(3)&quot; ;
2079                     replaceVal = commonStmts + &quot;\n&quot; + anno;
2080                     String superClassContents = srcType.getTemplate()
2081                             .replace(&quot;#CN&quot;, SUPERCLASS)
2082                             .replace(&quot;#REPLACE&quot;, replaceVal);
2083 
2084                     //Contents for SubClass that extends SuperClass
2085                     anno = Helper.ContentVars.BASEANNO.getVal();
2086                     replaceVal = expectedVals + &quot;\n&quot; + anno;
2087                     String subClassContents = SrcType.CLASSEXTENDS.getTemplate()
2088                             .replace(&quot;#CN&quot;, className)
2089                             .replace(&quot;#SN&quot;, SUPERCLASS)
2090                             .replace(&quot;#REPLACE&quot;, replaceVal);
2091 
2092                     contents = superClassContents + subClassContents;
2093                     srcFileObj = Helper.getFile(className, contents);
2094                     files = Arrays.asList(srcFileObj);
2095                 }
2096                 return files;
2097             }
2098         };
2099 
2100          private String expectedBase, expectedContainer;
2101 
2102          private TestCase(String expectedBase, String expectedContainer) {
2103              this.expectedBase = expectedBase;
2104              this.expectedContainer = expectedContainer;
2105          }
2106 
2107          public String getExpectedBase() {
2108              return expectedBase;
2109          }
2110 
2111          public String getExpectedContainer() {
2112              return expectedContainer;
2113          }
2114 
2115          // Each enum element should override this method
2116          public Iterable&lt;? extends JavaFileObject&gt; getTestFiles(SrcType srcType,
2117                  String className) {
2118              return null;
2119          }
2120     }
2121 
2122     /*
2123      * Each srctype has its template defined used for test src generation
2124      * Primary src types: class, method, field, package define
2125      *                    getExpectedBase() and getExpectedContainer()
2126      */
2127     enum SrcType {
2128 
2129         CLASS(&quot;\n#REPLACE\nclass #CN { } &quot;) {
2130 
2131             @Override
2132             public ExpectedBase getExpectedBase(Class&lt;?&gt; c) {
2133                 return c.getAnnotation(ExpectedBase.class);
2134             }
2135 
2136             @Override
2137             public ExpectedContainer getExpectedContainer(Class&lt;?&gt; c) {
2138                 return c.getAnnotation(ExpectedContainer.class);
2139             }
2140         },
2141         METHOD(&quot;class #CN  {\n&quot; + &quot;   &quot; + &quot;#REPLACE\n&quot; + &quot;   void &quot;
2142         + TESTMETHOD + &quot;() {} \n&quot; + &quot;}\n&quot;) {
2143 
2144             @Override
2145             public ExpectedBase getExpectedBase(Class&lt;?&gt; c) {
2146                 ExpectedBase ret = null;
2147                 try {
2148                     ret = c.getDeclaredMethod(TESTMETHOD).getAnnotation(
2149                             ExpectedBase.class);
2150                 } catch (NoSuchMethodException nme) {
2151                     error(&quot;Could not get &quot; + TESTMETHOD + &quot; for className &quot;
2152                             + c.getName() + &quot; Exception:\n&quot; + nme);
2153                 }
2154                 return ret;
2155             }
2156 
2157             @Override
2158             public ExpectedContainer getExpectedContainer(Class&lt;?&gt; c) {
2159                 ExpectedContainer ret = null;
2160                 try {
2161                     ret = c.getDeclaredMethod(TESTMETHOD).getAnnotation(
2162                             ExpectedContainer.class);
2163                 } catch (NoSuchMethodException nme) {
2164                     error(&quot;Could not get &quot; + TESTMETHOD + &quot; for className &quot;
2165                             + c.getName() + &quot; Exception:\n&quot; + nme);
2166                 }
2167                 return ret;
2168 
2169             }
2170         },
2171         FIELD(&quot;class #CN  {\n&quot; + &quot;   &quot; + &quot;#REPLACE\n&quot; + &quot;   int &quot; + TESTFIELD
2172         + &quot; = 0; \n&quot; + &quot;}\n&quot;) {
2173 
2174             @Override
2175             public ExpectedBase getExpectedBase(Class&lt;?&gt; c) {
2176                 ExpectedBase ret = null;
2177                 try {
2178                     ret = c.getDeclaredField(TESTFIELD).getAnnotation(
2179                             ExpectedBase.class);
2180                 } catch (NoSuchFieldException nme) {
2181                     error(&quot;Could not get &quot; + TESTFIELD + &quot; for className &quot;
2182                             + c.getName() + &quot; Exception:\n&quot; + nme);
2183                 }
2184                 return ret;
2185             }
2186 
2187             @Override
2188             public ExpectedContainer getExpectedContainer(Class&lt;?&gt; c) {
2189                 ExpectedContainer ret = null;
2190                 try {
2191                     ret = c.getDeclaredField(TESTFIELD).getAnnotation(
2192                             ExpectedContainer.class);
2193                 } catch (NoSuchFieldException nme) {
2194                     error(&quot;Could not get &quot; + TESTFIELD + &quot; for className &quot;
2195                             + c.getName() + &quot; Exception:\n&quot; + nme);
2196                 }
2197                 return ret;
2198 
2199             }
2200         },
2201         PACKAGE(&quot;package &quot; + TESTPKG + &quot;; \n&quot; + &quot;class #CN {}&quot;) {
2202 
2203             @Override
2204             public ExpectedBase getExpectedBase(Class&lt;?&gt; c) {
2205                 return c.getPackage().getAnnotation(ExpectedBase.class);
2206             }
2207 
2208             @Override
2209             public ExpectedContainer getExpectedContainer(Class&lt;?&gt; c) {
2210                 return c.getPackage().getAnnotation(ExpectedContainer.class);
2211             }
2212         },
2213         PKGINFO(&quot;#REPLACE1\npackage &quot; + TESTPKG + &quot;; \n&quot; + &quot;#REPLACE2&quot;),
2214         INTERFACE(&quot;#REPLACE\ninterface #IN { } &quot;),
2215         INTERFACEIMPL(&quot;#REPLACE\nclass #CN implements #IN {}&quot;),
2216         CLASSEXTENDS(&quot;#REPLACE\nclass #CN extends #SN {}&quot;);
2217         String template;
2218 
2219         private SrcType(String template) {
2220             this.template = template;
2221         }
2222 
2223         public String getTemplate() {
2224             return template;
2225         }
2226 
2227         // Elements should override
2228         public ExpectedBase getExpectedBase(Class&lt;?&gt; c) {
2229             return null;
2230         }
2231 
2232         public ExpectedContainer getExpectedContainer(Class&lt;?&gt; c) {
2233             return null;
2234         }
2235 
2236         /*
2237          * Returns only primary src types ;
2238          */
2239         public static SrcType[] getSrcTypes() {
2240             return new SrcType[]{CLASS, PACKAGE, METHOD, FIELD};
2241         }
2242     }
2243 
2244     /*
2245      * Each enum constant is one of the 6 methods from AnnotatedElement interface
2246      * that needs to be tested.
2247      * Each enum constant overrides these 4 methods:
2248      * - getActualAnnoBase(SrcType srcType, Class&lt;?&gt; c)
2249      * - getActualAnnoContainer(SrcType srcType, Class&lt;?&gt; c)
2250      * - getExpectedAnnoBase(SrcType srcType, Class&lt;?&gt; c)
2251      * - getExpectedAnnoContainer(SrcType srcType, Class&lt;?&gt; c)
2252      */
2253     enum TestMethod {
2254 
2255         GET_ANNO(&quot;getAnnotation&quot;) {
2256 
2257             @Override
2258             public Annotation[] getActualAnnoBase(SrcType srcType, Class&lt;?&gt; c) {
2259                 Annotation[] actualAnno = new Annotation[1];
2260                 switch (srcType) {
2261                     case CLASS:
2262                         actualAnno[0] = c.getAnnotation(srcType.getExpectedBase(c).value());
2263                         break;
2264                     case PACKAGE:
2265                         actualAnno[0] = c.getPackage().getAnnotation(
2266                                 srcType.getExpectedBase(c).value());
2267                         break;
2268                     case METHOD:
2269                         try {
2270                             actualAnno[0] = c.getDeclaredMethod(TESTMETHOD).getAnnotation(
2271                                     srcType.getExpectedBase(c).value());
2272                         } catch (NoSuchMethodException nme) {
2273                             error(&quot;Could not get &quot; + TESTMETHOD
2274                                     + &quot; for className = &quot; + c.getName()
2275                                     + &quot;Exception = &quot; + nme);
2276                         }
2277                         break;
2278                     case FIELD:
2279                         try {
2280                             actualAnno[0] = c.getDeclaredField(TESTFIELD).getAnnotation(
2281                                     srcType.getExpectedBase(c).value());
2282                         } catch (NoSuchFieldException nfe) {
2283                             error(&quot;Could not get &quot; + TESTFIELD
2284                                     + &quot; for className = &quot; + c.getName()
2285                                     + &quot;Exception = &quot; + nfe);
2286                         }
2287                         break;
2288                 }
2289                 return actualAnno;
2290             }
2291 
2292             @Override
2293             public Annotation[] getActualAnnoContainer(SrcType srcType,
2294                     Class&lt;?&gt; c) {
2295                 Annotation[] actualAnno = new Annotation[1];
2296                 switch (srcType) {
2297                     case CLASS:
2298                         actualAnno[0] = c.getAnnotation(srcType.getExpectedContainer(c).value());
2299                         break;
2300                     case PACKAGE:
2301                         actualAnno[0] = c.getPackage().getAnnotation(
2302                                 srcType.getExpectedContainer(c).value());
2303                         break;
2304                     case METHOD:
2305                         try {
2306                             actualAnno[0] = c.getDeclaredMethod(TESTMETHOD).getAnnotation(
2307                                     srcType.getExpectedContainer(c).value());
2308                         } catch (NoSuchMethodException nme) {
2309                             error(&quot;Could not get &quot; + TESTMETHOD
2310                                     + &quot; for className = &quot; + c.getName()
2311                                     + &quot;Exception = &quot; + nme);
2312                         }
2313                         break;
2314                     case FIELD:
2315                         try {
2316                             actualAnno[0] = c.getDeclaredField(TESTFIELD).getAnnotation(
2317                                     srcType.getExpectedContainer(c).value());
2318                         } catch (NoSuchFieldException nfe) {
2319                             error(&quot;Could not get &quot; + TESTFIELD
2320                                     + &quot; for className = &quot; + c.getName()
2321                                     + &quot;Exception = &quot; + nfe);
2322                         }
2323                         break;
2324                 }
2325                 return actualAnno;
2326             }
2327 
2328             @Override
2329             public String[] getExpectedAnnoBase(SrcType srcType, Class&lt;?&gt; c) {
2330                 String[] expAnno = {srcType.getExpectedBase(c).getAnnotationVal()};
2331                 return expAnno;
2332             }
2333 
2334             @Override
2335             public String[] getExpectedAnnoContainer(SrcType srcType, Class&lt;?&gt; c) {
2336                 String[] expAnno = {srcType.getExpectedContainer(c).getAnnotationVal()};
2337                 return expAnno;
2338             }
2339         },
2340         GET_ANNOS(&quot;getAnnotations&quot;) {
2341 
2342             @Override
2343             public Annotation[] getActualAnnoBase(SrcType srcType, Class&lt;?&gt; c) {
2344                 Annotation[] actualAnnos = null;
2345                 switch (srcType) {
2346                     case CLASS:
2347                         actualAnnos = c.getAnnotations();
2348                         break;
2349                     case PACKAGE:
2350                         actualAnnos = c.getPackage().getAnnotations();
2351                         break;
2352                     case METHOD:
2353                         try {
2354                             actualAnnos = c.getDeclaredMethod(TESTMETHOD).getAnnotations();
2355                         } catch (NoSuchMethodException nme) {
2356                             error(&quot;Could not get &quot; + TESTMETHOD
2357                                     + &quot; for className = &quot; + c.getName()
2358                                     + &quot;Exception = &quot; + nme);
2359                         }
2360                         break;
2361                     case FIELD:
2362                         try {
2363                             actualAnnos = c.getDeclaredField(TESTFIELD).getAnnotations();
2364                         } catch (NoSuchFieldException nfe) {
2365                             error(&quot;Could not get &quot; + TESTFIELD
2366                                     + &quot; for className = &quot; + c.getName()
2367                                     + &quot;Exception = &quot; + nfe);
2368                         }
2369                         break;
2370                 }
2371                 return actualAnnos;
2372             }
2373 
2374             @Override
2375             public Annotation[] getActualAnnoContainer(SrcType srcType,
2376                     Class&lt;?&gt; c) {
2377                 Annotation[] actualAnnos = null;
2378                 switch (srcType) {
2379                     case CLASS:
2380                         actualAnnos = c.getAnnotations();
2381                         break;
2382                     case PACKAGE:
2383                         actualAnnos = c.getPackage().getAnnotations();
2384                         break;
2385                     case METHOD:
2386                         try {
2387                             actualAnnos = c.getDeclaredMethod(TESTMETHOD).getAnnotations();
2388                         } catch (NoSuchMethodException nme) {
2389                             error(&quot;Could not get &quot; + TESTMETHOD
2390                                     + &quot; for className = &quot; + c.getName()
2391                                     + &quot;Exception = &quot; + nme);
2392                         }
2393                         break;
2394                     case FIELD:
2395                         try {
2396                             actualAnnos = c.getDeclaredField(TESTFIELD).getAnnotations();
2397                         } catch (NoSuchFieldException nfe) {
2398                             error(&quot;Could not get &quot; + TESTFIELD
2399                                     + &quot; for className = &quot; + c.getName()
2400                                     + &quot;Exception = &quot; + nfe);
2401                         }
2402                         break;
2403                 }
2404                 return actualAnnos;
2405             }
2406 
2407             @Override
2408             public String[] getExpectedAnnoBase(SrcType srcType, Class&lt;?&gt; c) {
2409                 return srcType.getExpectedBase(c).getAnnotationsVals();
2410             }
2411 
2412             @Override
2413             public String[] getExpectedAnnoContainer(SrcType srcType, Class&lt;?&gt; c) {
2414                 return srcType.getExpectedContainer(c).getAnnotationsVals();
2415             }
2416         },
2417         GET_DECL_ANNOS(&quot;getDeclaredAnnotations&quot;) {
2418 
2419             @Override
2420             public Annotation[] getActualAnnoBase(SrcType srcType, Class&lt;?&gt; c) {
2421                 Annotation[] actualDeclAnnos = null;
2422                 switch (srcType) {
2423                     case CLASS:
2424                         actualDeclAnnos = c.getDeclaredAnnotations();
2425                         break;
2426                     case PACKAGE:
2427                         actualDeclAnnos = c.getPackage().getDeclaredAnnotations();
2428                         break;
2429                     case METHOD:
2430                         try {
2431                             actualDeclAnnos = c.getDeclaredMethod(TESTMETHOD)
2432                                     .getDeclaredAnnotations();
2433                         } catch (NoSuchMethodException nme) {
2434                             error(&quot;Could not get &quot; + TESTMETHOD
2435                                     + &quot; for className = &quot; + c.getName()
2436                                     + &quot;Exception = &quot; + nme);
2437                         }
2438                         break;
2439                     case FIELD:
2440                         try {
2441                             actualDeclAnnos = c.getDeclaredField(TESTFIELD)
2442                                     .getDeclaredAnnotations();
2443                         } catch (NoSuchFieldException nfe) {
2444                             error(&quot;Could not get &quot; + TESTFIELD
2445                                     + &quot; for className = &quot; + c.getName()
2446                                     + &quot;Exception = &quot; + nfe);
2447                         }
2448                         break;
2449                 }
2450                 return actualDeclAnnos;
2451             }
2452 
2453             @Override
2454             public Annotation[] getActualAnnoContainer(SrcType srcType,
2455                     Class&lt;?&gt; c) {
2456                 Annotation[] actualDeclAnnos = null;
2457                 switch (srcType) {
2458                     case CLASS:
2459                         actualDeclAnnos = c.getDeclaredAnnotations();
2460                         break;
2461                     case PACKAGE:
2462                         actualDeclAnnos = c.getPackage().getDeclaredAnnotations();
2463                         break;
2464                     case METHOD:
2465                         try {
2466                             actualDeclAnnos = c.getDeclaredMethod(TESTMETHOD)
2467                                     .getDeclaredAnnotations();
2468                         } catch (NoSuchMethodException nme) {
2469                             error(&quot;Could not get &quot; + TESTMETHOD
2470                                     + &quot; for className = &quot; + c.getName()
2471                                     + &quot;Exception = &quot; + nme);
2472                         }
2473                         break;
2474                     case FIELD:
2475                         try {
2476                             actualDeclAnnos = c.getDeclaredField(TESTFIELD)
2477                                     .getDeclaredAnnotations();
2478                         } catch (NoSuchFieldException nfe) {
2479                             error(&quot;Could not get &quot; + TESTFIELD
2480                                     + &quot; for className = &quot; + c.getName()
2481                                     + &quot;Exception = &quot; + nfe);
2482                         }
2483                         break;
2484                 }
2485                 return actualDeclAnnos;
2486             }
2487 
2488             @Override
2489             public String[] getExpectedAnnoBase(SrcType srcType, Class&lt;?&gt; c) {
2490                 return srcType.getExpectedBase(c).getDeclAnnosVals();
2491             }
2492 
2493             @Override
2494             public String[] getExpectedAnnoContainer(SrcType srcType, Class&lt;?&gt; c) {
2495                 return srcType.getExpectedContainer(c).getDeclAnnosVals();
2496             }
2497         },
2498         GET_DECL_ANNO(&quot;getDeclaredAnnotation&quot;) {
2499 
2500             @Override
2501             public Annotation[] getActualAnnoBase(SrcType srcType, Class&lt;?&gt; c) {
2502                 Annotation[] actualDeclAnno = new Annotation[1];
2503                 switch (srcType) {
2504                     case CLASS:
2505                         actualDeclAnno[0] = c.getDeclaredAnnotation(
2506                                 srcType.getExpectedBase(c).value());
2507                         break;
2508                     case PACKAGE:
2509                         actualDeclAnno[0] = c.getPackage().getDeclaredAnnotation(
2510                                 srcType.getExpectedBase(c).value());
2511                         break;
2512                     case METHOD:
2513                         try {
2514                             actualDeclAnno[0] = c.getDeclaredMethod(TESTMETHOD)
2515                                     .getDeclaredAnnotation(
2516                                         srcType.getExpectedBase(c).value());
2517                         } catch (NoSuchMethodException nme) {
2518                             error(&quot;Could not get &quot; + TESTMETHOD
2519                                     + &quot; for className = &quot; + c.getName()
2520                                     + &quot;Exception = &quot; + nme);
2521                         }
2522                         break;
2523                     case FIELD:
2524                         try {
2525                             actualDeclAnno[0] = c.getDeclaredField(TESTFIELD)
2526                                     .getDeclaredAnnotation(
2527                                         srcType.getExpectedBase(c).value());
2528                         } catch (NoSuchFieldException nfe) {
2529                             error(&quot;Could not get &quot; + TESTFIELD
2530                                     + &quot; for className = &quot; + c.getName()
2531                                     + &quot;Exception = &quot; + nfe);
2532                         }
2533                         break;
2534                 }
2535                 return actualDeclAnno;
2536             }
2537 
2538             @Override
2539             public Annotation[] getActualAnnoContainer(SrcType srcType,
2540                     Class&lt;?&gt; c) {
2541                 Annotation[] actualDeclAnno = new Annotation[1];
2542                 switch (srcType) {
2543                     case CLASS:
2544                         actualDeclAnno[0] = c.getDeclaredAnnotation(
2545                                 srcType.getExpectedContainer(c).value());
2546                         break;
2547                     case PACKAGE:
2548                         actualDeclAnno[0] = c.getPackage().getDeclaredAnnotation(
2549                                 srcType.getExpectedContainer(c).value());
2550                         break;
2551                     case METHOD:
2552                         try {
2553                             actualDeclAnno[0] = c.getDeclaredMethod(TESTMETHOD)
2554                                     .getDeclaredAnnotation(
2555                                         srcType.getExpectedContainer(c).value());
2556                         } catch (NoSuchMethodException nme) {
2557                             error(&quot;Could not get &quot; + TESTMETHOD
2558                                     + &quot; for className = &quot; + c.getName()
2559                                     + &quot;Exception = &quot; + nme);
2560                         }
2561                         break;
2562                     case FIELD:
2563                         try {
2564                             actualDeclAnno[0] = c.getDeclaredField(TESTFIELD)
2565                                     .getDeclaredAnnotation(
2566                                         srcType.getExpectedContainer(c).value());
2567                         } catch (NoSuchFieldException nfe) {
2568                             error(&quot;Could not get &quot; + TESTFIELD
2569                                     + &quot; for className = &quot; + c.getName()
2570                                     + &quot;Exception = &quot; + nfe);
2571                         }
2572                         break;
2573                 }
2574                 return actualDeclAnno;
2575             }
2576 
2577             @Override
2578             public String[] getExpectedAnnoBase(SrcType srcType, Class&lt;?&gt; c) {
2579                 String[] expAnno = {srcType.getExpectedBase(c).getDeclAnnoVal()};
2580                 return expAnno;
2581             }
2582 
2583             @Override
2584             public String[] getExpectedAnnoContainer(SrcType srcType, Class&lt;?&gt; c) {
2585                 String[] expAnno = {srcType.getExpectedContainer(c).getDeclAnnoVal()};
2586                 return expAnno;
2587             }
2588         }, // new
2589         GET_ANNOS_ARG(&quot;getAnnotationsArg&quot;) {
2590 
2591             @Override
2592             public Annotation[] getActualAnnoBase(SrcType srcType, Class&lt;?&gt; c) {
2593                 Annotation[] actualAnnoArgs = null;
2594                 switch (srcType) {
2595                     case CLASS:
2596                         actualAnnoArgs = c.getAnnotationsByType(srcType.getExpectedBase(c).value());
2597                         break;
2598                     case PACKAGE:
2599                         actualAnnoArgs = c.getPackage().getAnnotationsByType(
2600                                 srcType.getExpectedBase(c).value());
2601                         break;
2602                     case METHOD:
2603                         try {
2604                             actualAnnoArgs = c.getDeclaredMethod(TESTMETHOD)
2605                                     .getAnnotationsByType(
2606                                         srcType.getExpectedBase(c).value());
2607                         } catch (NoSuchMethodException nme) {
2608                             error(&quot;Could not get &quot; + TESTMETHOD
2609                                     + &quot; for className = &quot; + c.getName()
2610                                     + &quot;Exception = &quot; + nme);
2611                         }
2612                         break;
2613                     case FIELD:
2614                         try {
2615                             actualAnnoArgs = c.getDeclaredField(TESTFIELD)
2616                                     .getAnnotationsByType(
2617                                         srcType.getExpectedBase(c).value());
2618                         } catch (NoSuchFieldException nfe) {
2619                             error(&quot;Could not get &quot; + TESTFIELD
2620                                     + &quot; for className = &quot; + c.getName()
2621                                     + &quot;Exception = &quot; + nfe);
2622                         }
2623                         break;
2624                 }
2625                 return actualAnnoArgs;
2626             }
2627 
2628             @Override
2629             public Annotation[] getActualAnnoContainer(SrcType srcType,
2630                     Class&lt;?&gt; c) {
2631                 Annotation[] actualAnnoArgs = null;
2632                 switch (srcType) {
2633                     case CLASS:
2634                         actualAnnoArgs = c.getAnnotationsByType(srcType.getExpectedContainer(c).value());
2635                         break;
2636                     case PACKAGE:
2637                         actualAnnoArgs = c.getPackage().getAnnotationsByType(
2638                                 srcType.getExpectedContainer(c).value());
2639                         break;
2640                     case METHOD:
2641                         try {
2642                             actualAnnoArgs = c.getDeclaredMethod(TESTMETHOD)
2643                                     .getAnnotationsByType(
2644                                         srcType.getExpectedContainer(c).value());
2645                         } catch (NoSuchMethodException nme) {
2646                             error(&quot;Could not get &quot; + TESTMETHOD
2647                                     + &quot; for className = &quot; + c.getName()
2648                                     + &quot;Exception = &quot; + nme);
2649                         }
2650                         break;
2651                     case FIELD:
2652                         try {
2653                             actualAnnoArgs = c.getDeclaredField(TESTFIELD)
2654                                     .getAnnotationsByType(
2655                                         srcType.getExpectedContainer(c).value());
2656                         } catch (NoSuchFieldException nfe) {
2657                             error(&quot;Could not get &quot; + TESTFIELD
2658                                     + &quot; for className = &quot; + c.getName()
2659                                     + &quot;Exception = &quot; + nfe);
2660                         }
2661                         break;
2662                 }
2663                 return actualAnnoArgs;
2664             }
2665 
2666             @Override
2667             public String[] getExpectedAnnoBase(SrcType srcType, Class&lt;?&gt; c) {
2668                 return srcType.getExpectedBase(c).getAnnosArgs();
2669             }
2670 
2671             @Override
2672             public String[] getExpectedAnnoContainer(SrcType srcType, Class&lt;?&gt; c) {
2673                 return srcType.getExpectedContainer(c).getAnnosArgs();
2674             }
2675         }, // new
2676         GET_DECL_ANNOS_ARG(&quot;getDeclAnnosArg&quot;) {
2677 
2678             @Override
2679             public Annotation[] getActualAnnoBase(SrcType srcType, Class&lt;?&gt; c) {
2680                 Annotation[] actualDeclAnnosArgs = null;
2681                 switch (srcType) {
2682                     case CLASS:
2683                         actualDeclAnnosArgs = c.getDeclaredAnnotationsByType(
2684                                 srcType.getExpectedBase(c).value());
2685                         break;
2686                     case PACKAGE:
2687                         actualDeclAnnosArgs = c.getPackage().getDeclaredAnnotationsByType(
2688                                 srcType.getExpectedBase(c).value());
2689                         break;
2690                     case METHOD:
2691                         try {
2692                             actualDeclAnnosArgs = c.getDeclaredMethod(TESTMETHOD)
2693                                     .getDeclaredAnnotationsByType(
2694                                         srcType.getExpectedBase(c).value());
2695                         } catch (NoSuchMethodException nme) {
2696                             error(&quot;Could not get &quot; + TESTMETHOD
2697                                     + &quot; for className = &quot; + c.getName()
2698                                     + &quot;Exception = &quot; + nme);
2699                         }
2700                         break;
2701                     case FIELD:
2702                         try {
2703                             actualDeclAnnosArgs = c.getDeclaredField(TESTFIELD)
2704                                     .getDeclaredAnnotationsByType(
2705                                         srcType.getExpectedBase(c).value());
2706                         } catch (NoSuchFieldException nfe) {
2707                             error(&quot;Could not get &quot; + TESTFIELD
2708                                     + &quot; for className = &quot; + c.getName()
2709                                     + &quot;Exception = &quot; + nfe);
2710                         }
2711                         break;
2712                 }
2713                 return actualDeclAnnosArgs;
2714             }
2715 
2716             @Override
2717             public Annotation[] getActualAnnoContainer(SrcType srcType,
2718                     Class&lt;?&gt; c) {
2719                 Annotation[] actualDeclAnnosArgs = null;
2720                 switch (srcType) {
2721                     case CLASS:
2722                         actualDeclAnnosArgs = c.getDeclaredAnnotationsByType(
2723                                 srcType.getExpectedContainer(c).value());
2724                         break;
2725                     case PACKAGE:
2726                         actualDeclAnnosArgs = c.getPackage().getDeclaredAnnotationsByType(
2727                                 srcType.getExpectedContainer(c).value());
2728                         break;
2729                     case METHOD:
2730                         try {
2731                             actualDeclAnnosArgs = c.getDeclaredMethod(TESTMETHOD)
2732                                     .getDeclaredAnnotationsByType(
2733                                         srcType.getExpectedContainer(c).value());
2734                         } catch (NoSuchMethodException nme) {
2735                             error(&quot;Could not get &quot; + TESTMETHOD
2736                                     + &quot; for className = &quot; + c.getName()
2737                                     + &quot;Exception = &quot; + nme);
2738                         }
2739                         break;
2740                     case FIELD:
2741                         try {
2742                             actualDeclAnnosArgs = c.getDeclaredField(TESTFIELD)
2743                                    .getDeclaredAnnotationsByType(
2744                                         srcType.getExpectedContainer(c).value());
2745                         } catch (NoSuchFieldException nfe) {
2746                             error(&quot;Could not get &quot; + TESTFIELD
2747                                     + &quot; for className = &quot; + c.getName()
2748                                     + &quot;Exception = &quot; + nfe);
2749                         }
2750                         break;
2751                 }
2752                 return actualDeclAnnosArgs;
2753             }
2754 
2755             @Override
2756             public String[] getExpectedAnnoBase(SrcType srcType, Class&lt;?&gt; c) {
2757                 return srcType.getExpectedBase(c).getDeclAnnosArgs();
2758             }
2759 
2760             @Override
2761             public String[] getExpectedAnnoContainer(SrcType srcType, Class&lt;?&gt; c) {
2762                 return srcType.getExpectedContainer(c).getDeclAnnosArgs();
2763             }
2764         }; // new
2765         String name;
2766 
2767         private TestMethod(String name) {
2768             this.name = name;
2769         }
2770 
2771         public Annotation[] getActualAnnoBase(SrcType srcType, Class&lt;?&gt; c) {
2772             return null;
2773         }
2774 
2775         public Annotation[] getActualAnnoContainer(SrcType srcType, Class&lt;?&gt; c) {
2776             return null;
2777         }
2778 
2779         public String[] getExpectedAnnoBase(SrcType srcType, Class&lt;?&gt; c) {
2780             return null;
2781         }
2782 
2783         public String[] getExpectedAnnoContainer(SrcType srcType, Class&lt;?&gt; c) {
2784             return null;
2785         }
2786     }
2787 
2788     /*
2789      * For a given srcType and class object, compare expectedBase and actualBase
2790      * annotations as well as expectedContainer and actualContainer annotations.
2791      *
2792      * Return true if both comparisons are true else return false.
2793      *
2794      */
2795     protected static void checkAnnoValues(SrcType srcType, Class&lt;?&gt; c) {
2796 
2797         // Load @ExpectedBase and @ExpectedContainer
2798         ExpectedBase eb = srcType.getExpectedBase(c);
2799         ExpectedContainer ec = srcType.getExpectedContainer(c);
2800         if (eb == null) {
2801             error(&quot;Did not find ExpectedBase Annotation, Test will exit&quot;);
2802             throw new RuntimeException();
2803         }
2804         if (ec == null) {
2805             error(&quot;Did not find ExpectedContainer Annotation, Test will exit&quot;);
2806             throw new RuntimeException();
2807         }
2808 
2809         for (TestMethod testMethod : TestMethod.values()) {
2810             debugPrint(&quot;---------------------------------------------&quot;);
2811             debugPrint(&quot;Test method = &quot; + testMethod);
2812             boolean isBasePass = true;
2813             boolean isConPass = true;
2814             // ExpectedBase = Annotation, no annotation is defined, skip comparison
2815             if (!eb.value().getSimpleName().equalsIgnoreCase(&quot;Annotation&quot;)) {
2816                 isBasePass = compareAnnotations(
2817                         testMethod.getActualAnnoBase(srcType, c),
2818                         testMethod.getExpectedAnnoBase(srcType, c));
2819             }
2820 
2821             // ExpectedContainer = Annotation, no annotation is defined, skip comparison
2822             if (!ec.value().getSimpleName().equalsIgnoreCase(&quot;Annotation&quot;)) {
2823                 isConPass = compareAnnotations(
2824                         testMethod.getActualAnnoContainer(srcType, c),
2825                         testMethod.getExpectedAnnoContainer(srcType, c));
2826             }
2827             if (isBasePass &amp;&amp; isConPass) {
2828                 debugPrint(&quot;Testcase passed for &quot; + testMethod +
2829                         &quot; for className = &quot; + c.getName());
2830             } else {
2831                 debugPrint(&quot;Testcase failed for &quot; + testMethod +
2832                         &quot; for className = &quot; + c.getName());
2833             }
2834         }
2835     }
2836 
2837     // Annotation comparison: Length should be same and all expected values
2838     // should be present in actualAnno[].
2839     private static boolean compareAnnotations(Annotation[] actualAnnos,
2840             String[] expectedAnnos) {
2841         boolean compOrder = false;
2842 
2843         // Length is different
2844         if (actualAnnos.length != expectedAnnos.length) {
2845             error(&quot;Length not same, Actual length = &quot; + actualAnnos.length
2846                     + &quot; Expected length = &quot; + expectedAnnos.length);
2847             printArrContents(actualAnnos);
2848             printArrContents(expectedAnnos);
2849             return false;
2850         } else {
2851             int i = 0;
2852             // Length is same and 0
2853             if (actualAnnos.length == 0) {
2854                 // Expected/actual lengths already checked for
2855                 // equality; no more checks do to
2856                 return true;
2857             }
2858             // Expected annotation should be NULL
2859             if (actualAnnos[0] == null) {
2860                 if (expectedAnnos[0].equals(&quot;NULL&quot;)) {
2861                     debugPrint(&quot;Arr values are NULL as expected&quot;);
2862                     return true;
2863                 } else {
2864                     error(&quot;Array values are not NULL&quot;);
2865                     printArrContents(actualAnnos);
2866                     printArrContents(expectedAnnos);
2867                     return false;
2868                 }
2869             }
2870             // Lengths are same, compare array contents
2871             String[] actualArr = new String[actualAnnos.length];
2872             for (Annotation a : actualAnnos) {
2873                 if (a.annotationType().getSimpleName().contains(&quot;Expected&quot;))
2874                 actualArr[i++] = a.annotationType().getSimpleName();
2875                  else if (a.annotationType().getName().contains(TESTPKG)) {
2876                     String replaced = a.toString().replaceAll(Pattern.quote(&quot;testpkg.&quot;),&quot;&quot;);
2877                     actualArr[i++] = replaced;
2878                 } else
2879                     actualArr[i++] = a.toString();
2880             }
2881             List&lt;String&gt; actualList = new ArrayList&lt;String&gt;(Arrays.asList(actualArr));
2882             List&lt;String&gt; expectedList = new ArrayList&lt;String&gt;(Arrays.asList(expectedAnnos));
2883             if (!actualList.containsAll(expectedList)) {
2884                 error(&quot;Array values are not same&quot;);
2885                 printArrContents(actualAnnos);
2886                 printArrContents(expectedAnnos);
2887                 return false;
2888             } else {
2889                 debugPrint(&quot;Arr values are same as expected&quot;);
2890                 if (CHECKORDERING) {
2891                     debugPrint(&quot;Checking if annotation ordering is as expected..&quot;);
2892                     compOrder = compareOrdering(actualList, expectedList);
2893                     if (compOrder)
2894                         debugPrint(&quot;Arr values ordering is as expected&quot;);
2895                     else
2896                         error(&quot;Arr values ordering is not as expected! actual values: &quot;
2897                             + actualList + &quot; expected values: &quot; + expectedList);
2898                 } else
2899                     compOrder = true;
2900             }
2901         }
2902         return compOrder;
2903     }
2904 
2905     // Annotation ordering comparison
2906     private static boolean compareOrdering(List&lt;String&gt; actualList, List&lt;String&gt; expectedList) {
2907         boolean order = true;
2908         // Discarding Expected* annotations before comparison of ordering
2909         actualList = iterateList(actualList);
2910         expectedList = iterateList(expectedList);
2911         // Length is different
2912         if (actualList.size() != expectedList.size()) {
2913             error(&quot;Length not same, Actual list length = &quot; + actualList.size()
2914                     + &quot; Expected list length = &quot; + expectedList.size());
2915             return false;
2916         } else {
2917             if (actualList.isEmpty() &amp;&amp; expectedList.isEmpty()) {
2918         return true;
2919     }
2920             boolean tmp = true;
2921             for (int i = 0; i &lt; actualList.size(); i++) {
2922                 // Checking ordering
2923                 if (order) {
2924                     if (!actualList.get(i).equals(expectedList.get(i))) {
2925                         tmp = false;
2926                         debugPrint(&quot;Odering is false&quot;);
2927                         debugPrint(&quot;actualList values: &quot; + actualList
2928                                 + &quot; expectedList values: &quot; + expectedList);
2929                     }
2930                 }
2931             }
2932             order = tmp;
2933         }
2934         return order;
2935     }
2936 
2937     private static List&lt;String&gt; iterateList(List&lt;String&gt; list) {
2938         Iterator&lt;String&gt; iter = list.iterator();
2939         while (iter.hasNext()) {
2940             String anno = iter.next();
2941             if (anno.contains(&quot;Expected&quot;)) {
2942                 iter.remove();
2943             }
2944         }
2945         return list;
2946     }
2947 
2948     private static void printArrContents(Annotation[] actualAnnos) {
2949         System.out.print(&quot;Actual Arr Values: &quot;);
2950         for (Annotation a : actualAnnos) {
2951             if (a != null &amp;&amp; a.annotationType() != null) {
2952                 System.out.print(&quot;[&quot; + a.toString() + &quot;]&quot;);
2953             } else {
2954                 System.out.println(&quot;[null]&quot;);
2955             }
2956         }
2957         System.out.println();
2958     }
2959 
2960     private static void printArrContents(String[] expectedAnnos) {
2961         System.out.print(&quot;Expected Arr Values: &quot;);
2962         for (String s : expectedAnnos) {
2963             System.out.print(&quot;[&quot; + s + &quot;]&quot;);
2964         }
2965         System.out.println();
2966     }
2967 
2968     private ClassLoader getLoader() {
2969         return getClass().getClassLoader();
2970     }
2971 
2972     private static Class&lt;?&gt; loadClass(String className, ClassLoader parentClassLoader, File... destDirs) {
2973         try {
2974             List&lt;URL&gt; list = new ArrayList&lt;&gt;();
2975             for (File f : destDirs) {
2976                 list.add(new URL(&quot;file:&quot; + f.toString().replace(&quot;\\&quot;, &quot;/&quot;) + &quot;/&quot;));
2977             }
2978             return Class.forName(className, true, new URLClassLoader(
2979                     list.toArray(new URL[list.size()]), parentClassLoader));
2980         } catch (ClassNotFoundException | MalformedURLException e) {
2981             throw new RuntimeException(&quot;Error loading class &quot; + className, e);
2982         }
2983     }
2984 
2985     private static void printTestSrc(Iterable&lt;? extends JavaFileObject&gt; files) {
2986         for (JavaFileObject f : files) {
2987             System.out.println(&quot;Test file &quot; + f.getName() + &quot;:&quot;);
2988             try {
2989                 System.out.println(&quot;&quot; + f.getCharContent(true));
2990             } catch (IOException e) {
2991                 throw new RuntimeException(
2992                         &quot;Exception when printing test src contents for class &quot; +
2993                                 f.getName(), e);
2994             }
2995         }
2996 
2997     }
2998 
2999     public static StringBuilder getCommonStmts(boolean isRepeatable) {
3000         StringBuilder sb = new StringBuilder();
3001 
3002         sb.append(Helper.ContentVars.IMPORTEXPECTED.getVal())
3003           .append(Helper.ContentVars.IMPORTSTMTS.getVal())
3004           .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
3005           .append(Helper.ContentVars.INHERITED.getVal());
3006         if(isRepeatable) {
3007             sb.append(Helper.ContentVars.REPEATABLE.getVal());
3008         }
3009         sb.append(Helper.ContentVars.BASE.getVal())
3010           .append(Helper.ContentVars.RETENTIONRUNTIME.getVal())
3011           .append(Helper.ContentVars.INHERITED.getVal())
3012           .append(Helper.ContentVars.CONTAINER.getVal());
3013         return sb;
3014     }
3015 
3016     private static int getNumErrors() {
3017         return errors;
3018     }
3019 
3020     private static void error(String msg) {
3021         System.out.println(&quot;error: &quot; + msg);
3022         errors++;
3023     }
3024 
3025     private static void debugPrint(String string) {
3026         if(DEBUG)
3027             System.out.println(string);
3028     }
3029 }
<a name="105" id="anc105"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="105" type="hidden" />
</body>
</html>