<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/langtools/tools/javac/lambda/deduplication/DeduplicationTest.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="Deduplication.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../lambdaExpression/LambdaTest6.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/langtools/tools/javac/lambda/deduplication/DeduplicationTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 82,20 ***</span>
          JavacFileManager fileManager = new JavacFileManager(new Context(), false, UTF_8);
          JavacTool javacTool = JavacTool.create();
          Listener diagnosticListener = new Listener();
          Path testSrc = Paths.get(System.getProperty(&quot;test.src&quot;));
          Path file = testSrc.resolve(&quot;Deduplication.java&quot;);
          JavacTask task =
                  javacTool.getTask(
                          null,
                          null,
                          diagnosticListener,
                          Arrays.asList(
                                  &quot;-d&quot;,
                                  &quot;.&quot;,
                                  &quot;-XDdebug.dumpLambdaToMethodDeduplication&quot;,
<span class="line-modified">!                                 &quot;-XDdebug.dumpLambdaToMethodStats&quot;),</span>
                          null,
                          fileManager.getJavaFileObjects(file));
          Map&lt;JCLambda, JCLambda&gt; dedupedLambdas = new LinkedHashMap&lt;&gt;();
          task.addTaskListener(new TreeDiffHashTaskListener(dedupedLambdas));
          Iterable&lt;? extends JavaFileObject&gt; generated = task.generate();
<span class="line-new-header">--- 82,22 ---</span>
          JavacFileManager fileManager = new JavacFileManager(new Context(), false, UTF_8);
          JavacTool javacTool = JavacTool.create();
          Listener diagnosticListener = new Listener();
          Path testSrc = Paths.get(System.getProperty(&quot;test.src&quot;));
          Path file = testSrc.resolve(&quot;Deduplication.java&quot;);
<span class="line-added">+         String sourceVersion = Integer.toString(Runtime.version().feature());</span>
          JavacTask task =
                  javacTool.getTask(
                          null,
                          null,
                          diagnosticListener,
                          Arrays.asList(
                                  &quot;-d&quot;,
                                  &quot;.&quot;,
                                  &quot;-XDdebug.dumpLambdaToMethodDeduplication&quot;,
<span class="line-modified">!                                 &quot;-XDdebug.dumpLambdaToMethodStats&quot;,</span>
<span class="line-added">+                                 &quot;--enable-preview&quot;, &quot;-source&quot;, sourceVersion),</span>
                          null,
                          fileManager.getJavaFileObjects(file));
          Map&lt;JCLambda, JCLambda&gt; dedupedLambdas = new LinkedHashMap&lt;&gt;();
          task.addTaskListener(new TreeDiffHashTaskListener(dedupedLambdas));
          Iterable&lt;? extends JavaFileObject&gt; generated = task.generate();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 190,10 ***</span>
<span class="line-new-header">--- 192,13 ---</span>
                  case &quot;compiler.note.verbose.l2m.deduplicate&quot;:
                      deduped.put(
                              (JCLambda) d.getDiagnosticPosition().getTree(),
                              (MethodSymbol) d.getArgs()[0]);
                      break;
<span class="line-added">+                 case &quot;compiler.note.preview.filename&quot;:</span>
<span class="line-added">+                 case &quot;compiler.note.preview.recompile&quot;:</span>
<span class="line-added">+                     break; //ignore</span>
                  default:
                      unexpected.add(diagnostic);
              }
          }
  
</pre>
<center><a href="Deduplication.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../lambdaExpression/LambdaTest6.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>