<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/langtools/tools/javac/modules/AnnotationProcessing.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../lvti/harness/LocalVariableInferenceTester.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="AnnotationsOnModules.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/langtools/tools/javac/modules/AnnotationProcessing.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2015, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.
   8  *
   9  * This code is distributed in the hope that it will be useful, but WITHOUT
  10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  12  * version 2 for more details (a copy is included in the LICENSE file that
  13  * accompanied this code).
  14  *
  15  * You should have received a copy of the GNU General Public License version
  16  * 2 along with this work; if not, write to the Free Software Foundation,
  17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18  *
  19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20  * or visit www.oracle.com if you need additional information or have any
  21  * questions.
  22  */
</pre>
<hr />
<pre>
  58 
  59 import javax.annotation.processing.AbstractProcessor;
  60 import javax.annotation.processing.Filer;
  61 import javax.annotation.processing.FilerException;
  62 import javax.annotation.processing.Messager;
  63 import javax.annotation.processing.ProcessingEnvironment;
  64 import javax.annotation.processing.RoundEnvironment;
  65 import javax.annotation.processing.SupportedAnnotationTypes;
  66 import javax.annotation.processing.SupportedOptions;
  67 import javax.lang.model.SourceVersion;
  68 import javax.lang.model.element.Element;
  69 import javax.lang.model.element.ElementKind;
  70 import javax.lang.model.element.ModuleElement;
  71 import javax.lang.model.element.ModuleElement.ProvidesDirective;
  72 import javax.lang.model.element.ModuleElement.UsesDirective;
  73 import javax.lang.model.element.PackageElement;
  74 import javax.lang.model.element.TypeElement;
  75 import javax.lang.model.element.VariableElement;
  76 import javax.lang.model.type.TypeKind;
  77 import javax.lang.model.util.ElementFilter;
<span class="line-modified">  78 import javax.lang.model.util.ElementScanner9;</span>
  79 import javax.tools.Diagnostic.Kind;
  80 import javax.tools.FileObject;
  81 import javax.tools.JavaCompiler;
  82 import javax.tools.JavaCompiler.CompilationTask;
  83 import javax.tools.JavaFileManager;
  84 import javax.tools.JavaFileManager.Location;
  85 import javax.tools.JavaFileObject;
  86 import javax.tools.StandardJavaFileManager;
  87 import javax.tools.StandardLocation;
  88 import javax.tools.ToolProvider;
  89 
  90 import toolbox.JavacTask;
  91 import toolbox.Task;
  92 import toolbox.Task.Mode;
  93 import toolbox.Task.OutputKind;
  94 
  95 public class AnnotationProcessing extends ModuleTestBase {
  96 
  97     public static void main(String... args) throws Exception {
  98         System.out.println(System.getProperties());
</pre>
<hr />
<pre>
 172 
 173                 String expectedEnclosedElements =
 174                         processingEnv.getOptions().get(&quot;expectedEnclosedElements&quot;);
 175 
 176                 for (String moduleDef : expectedEnclosedElements.split(&quot;,&quot;)) {
 177                     String[] module2Packages = moduleDef.split(&quot;=&gt;&quot;);
 178 
 179                     module2ExpectedEnclosedElements.put(module2Packages[0],
 180                                                         List.of(module2Packages[1].split(&quot;:&quot;)));
 181                 }
 182             }
 183 
 184             //verify ModuleType and ModuleSymbol behavior:
 185             for (Element root : roundEnv.getRootElements()) {
 186                 ModuleElement module = processingEnv.getElementUtils().getModuleOf(root);
 187 
 188                 assertEquals(TypeKind.MODULE, module.asType().getKind());
 189 
 190                 boolean[] seenModule = new boolean[1];
 191 
<span class="line-modified"> 192                 module.accept(new ElementScanner9&lt;Void, Void&gt;() {</span>
 193                     @Override
 194                     public Void visitModule(ModuleElement e, Void p) {
 195                         seenModule[0] = true;
 196                         return null;
 197                     }
 198                     @Override
 199                     public Void scan(Element e, Void p) {
 200                         throw new AssertionError(&quot;Shouldn&#39;t get here.&quot;);
 201                     }
 202                 }, null);
 203 
 204                 assertEquals(true, seenModule[0]);
 205 
 206                 List&lt;String&gt; actualElements =
 207                         module.getEnclosedElements()
 208                               .stream()
 209                               .map(s -&gt; (PackageElement) s)
 210                               .map(p -&gt; p.getQualifiedName().toString())
 211                               .collect(Collectors.toList());
 212 
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2015, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.
   8  *
   9  * This code is distributed in the hope that it will be useful, but WITHOUT
  10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  12  * version 2 for more details (a copy is included in the LICENSE file that
  13  * accompanied this code).
  14  *
  15  * You should have received a copy of the GNU General Public License version
  16  * 2 along with this work; if not, write to the Free Software Foundation,
  17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18  *
  19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20  * or visit www.oracle.com if you need additional information or have any
  21  * questions.
  22  */
</pre>
<hr />
<pre>
  58 
  59 import javax.annotation.processing.AbstractProcessor;
  60 import javax.annotation.processing.Filer;
  61 import javax.annotation.processing.FilerException;
  62 import javax.annotation.processing.Messager;
  63 import javax.annotation.processing.ProcessingEnvironment;
  64 import javax.annotation.processing.RoundEnvironment;
  65 import javax.annotation.processing.SupportedAnnotationTypes;
  66 import javax.annotation.processing.SupportedOptions;
  67 import javax.lang.model.SourceVersion;
  68 import javax.lang.model.element.Element;
  69 import javax.lang.model.element.ElementKind;
  70 import javax.lang.model.element.ModuleElement;
  71 import javax.lang.model.element.ModuleElement.ProvidesDirective;
  72 import javax.lang.model.element.ModuleElement.UsesDirective;
  73 import javax.lang.model.element.PackageElement;
  74 import javax.lang.model.element.TypeElement;
  75 import javax.lang.model.element.VariableElement;
  76 import javax.lang.model.type.TypeKind;
  77 import javax.lang.model.util.ElementFilter;
<span class="line-modified">  78 import javax.lang.model.util.ElementScanner14;</span>
  79 import javax.tools.Diagnostic.Kind;
  80 import javax.tools.FileObject;
  81 import javax.tools.JavaCompiler;
  82 import javax.tools.JavaCompiler.CompilationTask;
  83 import javax.tools.JavaFileManager;
  84 import javax.tools.JavaFileManager.Location;
  85 import javax.tools.JavaFileObject;
  86 import javax.tools.StandardJavaFileManager;
  87 import javax.tools.StandardLocation;
  88 import javax.tools.ToolProvider;
  89 
  90 import toolbox.JavacTask;
  91 import toolbox.Task;
  92 import toolbox.Task.Mode;
  93 import toolbox.Task.OutputKind;
  94 
  95 public class AnnotationProcessing extends ModuleTestBase {
  96 
  97     public static void main(String... args) throws Exception {
  98         System.out.println(System.getProperties());
</pre>
<hr />
<pre>
 172 
 173                 String expectedEnclosedElements =
 174                         processingEnv.getOptions().get(&quot;expectedEnclosedElements&quot;);
 175 
 176                 for (String moduleDef : expectedEnclosedElements.split(&quot;,&quot;)) {
 177                     String[] module2Packages = moduleDef.split(&quot;=&gt;&quot;);
 178 
 179                     module2ExpectedEnclosedElements.put(module2Packages[0],
 180                                                         List.of(module2Packages[1].split(&quot;:&quot;)));
 181                 }
 182             }
 183 
 184             //verify ModuleType and ModuleSymbol behavior:
 185             for (Element root : roundEnv.getRootElements()) {
 186                 ModuleElement module = processingEnv.getElementUtils().getModuleOf(root);
 187 
 188                 assertEquals(TypeKind.MODULE, module.asType().getKind());
 189 
 190                 boolean[] seenModule = new boolean[1];
 191 
<span class="line-modified"> 192                 module.accept(new ElementScanner14&lt;Void, Void&gt;() {</span>
 193                     @Override
 194                     public Void visitModule(ModuleElement e, Void p) {
 195                         seenModule[0] = true;
 196                         return null;
 197                     }
 198                     @Override
 199                     public Void scan(Element e, Void p) {
 200                         throw new AssertionError(&quot;Shouldn&#39;t get here.&quot;);
 201                     }
 202                 }, null);
 203 
 204                 assertEquals(true, seenModule[0]);
 205 
 206                 List&lt;String&gt; actualElements =
 207                         module.getEnclosedElements()
 208                               .stream()
 209                               .map(s -&gt; (PackageElement) s)
 210                               .map(p -&gt; p.getQualifiedName().toString())
 211                               .collect(Collectors.toList());
 212 
</pre>
</td>
</tr>
</table>
<center><a href="../lvti/harness/LocalVariableInferenceTester.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="AnnotationsOnModules.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>