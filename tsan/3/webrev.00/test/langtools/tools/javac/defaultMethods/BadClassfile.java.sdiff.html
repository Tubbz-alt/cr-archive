<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/langtools/tools/javac/defaultMethods/BadClassfile.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../classreader/8171132/BadConstantValue.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="static/hiding/InterfaceMethodHidingTest.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/langtools/tools/javac/defaultMethods/BadClassfile.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 62         ClassFile cf = ClassFile.read(classfile);
 63 
 64         cf = new ClassFile(cf.magic, Target.JDK1_7.minorVersion,
 65                  Target.JDK1_7.majorVersion, cf.constant_pool, cf.access_flags,
 66                 cf.this_class, cf.super_class, cf.interfaces, cf.fields,
 67                 cf.methods, cf.attributes);
 68 
 69         new ClassWriter().write(cf, classfile);
 70 
 71         JavaCompiler c = ToolProvider.getSystemJavaCompiler();
 72         JavacTaskImpl task = (JavacTaskImpl) c.getTask(null, null, null, Arrays.asList(&quot;-classpath&quot;, System.getProperty(&quot;test.classes&quot;, &quot;.&quot;)), null, null);
 73         Symtab syms = Symtab.instance(task.getContext());
 74 
 75         task.ensureEntered();
 76 
 77         try {
 78             Symbol clazz = com.sun.tools.javac.main.JavaCompiler.instance(task.getContext()).resolveIdent(syms.unnamedModule, classname);
 79 
 80             clazz.complete();
 81         } catch (BadClassFile f) {
<span class="line-modified"> 82             JCDiagnostic embeddedDiag = (JCDiagnostic) f.diag.getArgs()[1];</span>
 83             assertEquals(expected, embeddedDiag.getCode());
 84             assertEquals(Integer.toString(Target.JDK1_7.majorVersion), embeddedDiag.getArgs()[0]);
 85             assertEquals(Integer.toString(Target.JDK1_7.minorVersion), embeddedDiag.getArgs()[1]);
 86         }
 87     }
 88 
 89     private static void assertEquals(Object expected, Object actual) {
 90         Assert.check(Objects.equals(expected, actual),
 91                      &quot;expected: &quot; + expected + &quot;, but was: &quot; + actual);
 92     }
 93 
 94     interface DefaultMethodTest {
 95         default void test() { }
 96     }
 97     interface StaticMethodTest {
 98         static void test() { }
 99     }
100 }
</pre>
</td>
<td>
<hr />
<pre>
 62         ClassFile cf = ClassFile.read(classfile);
 63 
 64         cf = new ClassFile(cf.magic, Target.JDK1_7.minorVersion,
 65                  Target.JDK1_7.majorVersion, cf.constant_pool, cf.access_flags,
 66                 cf.this_class, cf.super_class, cf.interfaces, cf.fields,
 67                 cf.methods, cf.attributes);
 68 
 69         new ClassWriter().write(cf, classfile);
 70 
 71         JavaCompiler c = ToolProvider.getSystemJavaCompiler();
 72         JavacTaskImpl task = (JavacTaskImpl) c.getTask(null, null, null, Arrays.asList(&quot;-classpath&quot;, System.getProperty(&quot;test.classes&quot;, &quot;.&quot;)), null, null);
 73         Symtab syms = Symtab.instance(task.getContext());
 74 
 75         task.ensureEntered();
 76 
 77         try {
 78             Symbol clazz = com.sun.tools.javac.main.JavaCompiler.instance(task.getContext()).resolveIdent(syms.unnamedModule, classname);
 79 
 80             clazz.complete();
 81         } catch (BadClassFile f) {
<span class="line-modified"> 82             JCDiagnostic embeddedDiag = (JCDiagnostic) f.getDiagnostic().getArgs()[1];</span>
 83             assertEquals(expected, embeddedDiag.getCode());
 84             assertEquals(Integer.toString(Target.JDK1_7.majorVersion), embeddedDiag.getArgs()[0]);
 85             assertEquals(Integer.toString(Target.JDK1_7.minorVersion), embeddedDiag.getArgs()[1]);
 86         }
 87     }
 88 
 89     private static void assertEquals(Object expected, Object actual) {
 90         Assert.check(Objects.equals(expected, actual),
 91                      &quot;expected: &quot; + expected + &quot;, but was: &quot; + actual);
 92     }
 93 
 94     interface DefaultMethodTest {
 95         default void test() { }
 96     }
 97     interface StaticMethodTest {
 98         static void test() { }
 99     }
100 }
</pre>
</td>
</tr>
</table>
<center><a href="../classreader/8171132/BadConstantValue.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="static/hiding/InterfaceMethodHidingTest.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>