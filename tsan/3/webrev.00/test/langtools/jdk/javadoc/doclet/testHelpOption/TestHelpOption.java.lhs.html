<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames test/langtools/jdk/javadoc/doclet/testHelpOption/TestHelpOption.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 /*
 25  * @test
 26  * @bug      4934778 4777599 6553182 8146427 8146475 8175055 8185371
 27  * @summary  Make sure that --help, -helpfile and -nohelp options work correctly.
<a name="1" id="anc1"></a><span class="line-removed"> 28  * @author   jamieh</span>
 29  * @library ../../lib
 30  * @modules jdk.javadoc/jdk.javadoc.internal.tool
 31  * @build    javadoc.tester.* TestHelpOption
 32  * @run main TestHelpOption
 33  */
 34 
 35 import java.util.*;
 36 import java.util.stream.*;
 37 
 38 import javadoc.tester.JavadocTester;
 39 
 40 public class TestHelpOption extends JavadocTester {
 41 
 42     public static void main(String... args) throws Exception {
 43         TestHelpOption tester = new TestHelpOption();
 44         tester.runTests();
 45     }
 46 
 47     @Test
 48     public void testLineLengths() {
 49         javadoc(&quot;-d&quot;, &quot;out1&quot;,
 50                 &quot;-sourcepath&quot;, testSrc,
 51                 &quot;-X&quot;,
 52                 testSrc(&quot;TestXOption.java&quot;));
 53         checkExit(Exit.OK);
 54         List&lt;String&gt; longLines = getOutputLines(Output.OUT).stream()
 55                 .filter(s -&gt; s.length() &gt; 80)
 56                 .collect(Collectors.toList());
 57         checking(&quot;line lengths&quot;);
 58         if (longLines.isEmpty()) {
 59             passed(&quot;all lines OK&quot;);
 60         } else {
 61             out.println(&quot;long lines:&quot;);
 62             longLines.stream().forEach(s -&gt; out.println(&quot;&gt;&gt;&gt;&quot; + s + &quot;&lt;&lt;&lt;&quot;));
 63             failed(longLines.size() + &quot; long lines&quot;);
 64         }
 65     }
 66 
 67     @Test
 68     public void testWithOption() {
 69         javadoc(&quot;-d&quot;, &quot;out1&quot;,
 70                 &quot;-sourcepath&quot;, testSrc,
 71                 &quot;--help&quot;,
 72                 testSrc(&quot;Sample.java&quot;));
 73         checkExit(Exit.OK);
 74 
 75         checkOutput(true);
 76     }
 77 
 78     @Test
 79     public void testWithoutOption() {
 80         javadoc(&quot;-d&quot;, &quot;out2&quot;,
 81                 &quot;-sourcepath&quot;, testSrc,
 82                 testSrc(&quot;Sample.java&quot;));
 83         checkExit(Exit.OK);
 84     }
 85 
 86     @Test
 87     public void testNohelpOption() {
 88         javadoc(&quot;-d&quot;, &quot;out3&quot;,
 89                 &quot;-sourcepath&quot;, testSrc,
 90                 &quot;-nohelp&quot;,
 91                 testSrc(&quot;Sample.java&quot;));
 92         checkOutput(&quot;Sample.html&quot;, false, &quot;&lt;li&gt;&lt;a href=\&quot;../help-doc.html\&quot;&gt;Help&lt;/a&gt;&lt;/li&gt;&quot;);
 93         checkExit(Exit.OK);
 94     }
 95 
 96     @Test
 97     public void testHelpfileOption() {
 98         javadoc(&quot;-d&quot;, &quot;out4&quot;,
 99                 &quot;-sourcepath&quot;, testSrc,
100                 &quot;-helpfile&quot;, testSrc(&quot;test-help.html&quot;),
101                 testSrc(&quot;Sample.java&quot;));
102         checkExit(Exit.OK);
103         checkOutput(&quot;Sample.html&quot;, true,
104                 &quot;&lt;li&gt;&lt;a href=\&quot;test-help.html\&quot;&gt;Help&lt;/a&gt;&lt;/li&gt;&quot;);
105         checkOutput(&quot;test-help.html&quot;, true,
106                 &quot;Help, help.&quot;);
107     }
108 
109     @Test
110     public void testHelpfileReuseOption() {
111         javadoc(&quot;-d&quot;, &quot;out5&quot;,
112                 &quot;-sourcepath&quot;, testSrc,
113                 &quot;-helpfile&quot;, testSrc(&quot;test-help.html&quot;),
114                 &quot;-helpfile&quot;, testSrc(&quot;test-help.html&quot;),
115                 testSrc(&quot;Sample.java&quot;));
116         checkExit(Exit.CMDERR);
117     }
118 
119     @Test
120     public void testHelpfileNohelpConflict() {
121         javadoc(&quot;-d&quot;, &quot;out6&quot;,
122                 &quot;-sourcepath&quot;, testSrc,
123                 &quot;-helpfile&quot;, testSrc(&quot;test-help.html&quot;),
124                 &quot;-nohelp&quot;,
125                 testSrc(&quot;Sample.java&quot;));
126         checkExit(Exit.CMDERR);
127     }
128 
129     private void checkOutput(boolean withOption) {
130         checkOutput(Output.OUT, withOption,
131                 &quot;-d &quot;,
132                 &quot;-use &quot;,
133                 &quot;-version &quot;,
134                 &quot;-author &quot;,
135                 &quot;-docfilessubdirs\n&quot;,
136                 &quot;-splitindex &quot;,
137                 &quot;-windowtitle &quot;,
138                 &quot;-doctitle &quot;,
139                 &quot;-header &quot;,
140                 &quot;-footer &quot;,
141                 &quot;-bottom &quot;,
142                 &quot;-link &quot;,
143                 &quot;-linkoffline &quot;,
144                 &quot;-excludedocfilessubdir &quot;,
145                 &quot;-group &quot;,
146                 &quot;-nocomment &quot;,
147                 &quot;-nodeprecated\n&quot;,
148                 &quot;-noqualifier &quot;,
149                 &quot;-nosince &quot;,
150                 &quot;-notimestamp &quot;,
151                 &quot;-nodeprecatedlist\n&quot;,
152                 &quot;-notree &quot;,
153                 &quot;-noindex &quot;,
154                 &quot;-nohelp &quot;,
155                 &quot;-nonavbar &quot;,
156                 &quot;-serialwarn &quot;,
157                 &quot;-tag &quot;,
158                 &quot;-taglet &quot;,
159                 &quot;-tagletpath &quot;,
160                 &quot;-charset &quot;,
161                 &quot;-helpfile &quot;,
162                 &quot;-linksource &quot;,
163                 &quot;-sourcetab &quot;,
164                 &quot;-keywords &quot;,
165                 &quot;-stylesheetfile &quot;,
166                 &quot;--add-stylesheet &quot;,
167                 &quot;-docencoding &quot;,
168                 &quot;-html5 &quot;,
169                 &quot;-top &quot;,
170                 &quot;-author &quot;,
171                 &quot;-noqualifier &quot;,
172                 &quot;-nosince &quot;,
173                 &quot;-notimestamp &quot;,
174                 &quot;-sourcetab &quot;);
175 
176         checkFileAndOutput(&quot;Sample.html&quot;, !withOption,
177                 &quot;&lt;li&gt;&lt;a href=\&quot;help-doc.html\&quot;&gt;Help&lt;/a&gt;&lt;/li&gt;&quot;);
178     }
179 }
<a name="2" id="anc2"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="2" type="hidden" />
</body>
</html>