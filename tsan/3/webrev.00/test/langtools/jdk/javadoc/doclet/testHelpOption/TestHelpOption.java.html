<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New test/langtools/jdk/javadoc/doclet/testHelpOption/TestHelpOption.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 /*
 25  * @test
 26  * @bug      4934778 4777599 6553182 8146427 8146475 8175055 8185371
 27  * @summary  Make sure that --help, -helpfile and -nohelp options work correctly.
 28  * @library ../../lib
 29  * @modules jdk.javadoc/jdk.javadoc.internal.tool
 30  * @build    javadoc.tester.* TestHelpOption
 31  * @run main TestHelpOption
 32  */
 33 
 34 import java.util.*;
 35 import java.util.stream.*;
 36 
 37 import javadoc.tester.JavadocTester;
 38 
 39 public class TestHelpOption extends JavadocTester {
 40 
 41     public static void main(String... args) throws Exception {
 42         TestHelpOption tester = new TestHelpOption();
 43         tester.runTests();
 44     }
 45 
 46     @Test
 47     public void testLineLengths() {
 48         javadoc(&quot;-d&quot;, &quot;out1&quot;,
 49                 &quot;-sourcepath&quot;, testSrc,
 50                 &quot;-X&quot;,
 51                 testSrc(&quot;TestXOption.java&quot;));
 52         checkExit(Exit.OK);
 53         List&lt;String&gt; longLines = getOutputLines(Output.OUT).stream()
 54                 .filter(s -&gt; s.length() &gt; 80)
 55                 .collect(Collectors.toList());
 56         checking(&quot;line lengths&quot;);
 57         if (longLines.isEmpty()) {
 58             passed(&quot;all lines OK&quot;);
 59         } else {
 60             out.println(&quot;long lines:&quot;);
 61             longLines.stream().forEach(s -&gt; out.println(&quot;&gt;&gt;&gt;&quot; + s + &quot;&lt;&lt;&lt;&quot;));
 62             failed(longLines.size() + &quot; long lines&quot;);
 63         }
 64     }
 65 
 66     @Test
 67     public void testWithOption() {
 68         javadoc(&quot;-d&quot;, &quot;out1&quot;,
 69                 &quot;-sourcepath&quot;, testSrc,
 70                 &quot;--help&quot;,
 71                 testSrc(&quot;Sample.java&quot;));
 72         checkExit(Exit.OK);
 73 
 74         checkOutput(true);
 75     }
 76 
 77     @Test
 78     public void testWithoutOption() {
 79         javadoc(&quot;-d&quot;, &quot;out2&quot;,
 80                 &quot;-sourcepath&quot;, testSrc,
 81                 testSrc(&quot;Sample.java&quot;));
 82         checkExit(Exit.OK);
 83     }
 84 
 85     @Test
 86     public void testNohelpOption() {
 87         javadoc(&quot;-d&quot;, &quot;out3&quot;,
 88                 &quot;-sourcepath&quot;, testSrc,
 89                 &quot;-nohelp&quot;,
 90                 testSrc(&quot;Sample.java&quot;));
 91         checkOutput(&quot;Sample.html&quot;, false, &quot;&lt;li&gt;&lt;a href=\&quot;../help-doc.html\&quot;&gt;Help&lt;/a&gt;&lt;/li&gt;&quot;);
 92         checkExit(Exit.OK);
 93     }
 94 
 95     @Test
 96     public void testHelpfileOption() {
 97         javadoc(&quot;-d&quot;, &quot;out4&quot;,
 98                 &quot;-sourcepath&quot;, testSrc,
 99                 &quot;-helpfile&quot;, testSrc(&quot;test-help.html&quot;),
100                 testSrc(&quot;Sample.java&quot;));
101         checkExit(Exit.OK);
102         checkOutput(&quot;Sample.html&quot;, true,
103                 &quot;&lt;li&gt;&lt;a href=\&quot;test-help.html\&quot;&gt;Help&lt;/a&gt;&lt;/li&gt;&quot;);
104         checkOutput(&quot;test-help.html&quot;, true,
105                 &quot;Help, help.&quot;);
106     }
107 
108     @Test
109     public void testHelpfileReuseOption() {
110         javadoc(&quot;-d&quot;, &quot;out5&quot;,
111                 &quot;-sourcepath&quot;, testSrc,
112                 &quot;-helpfile&quot;, testSrc(&quot;test-help.html&quot;),
113                 &quot;-helpfile&quot;, testSrc(&quot;test-help.html&quot;),
114                 testSrc(&quot;Sample.java&quot;));
115         checkExit(Exit.CMDERR);
116     }
117 
118     @Test
119     public void testHelpfileNohelpConflict() {
120         javadoc(&quot;-d&quot;, &quot;out6&quot;,
121                 &quot;-sourcepath&quot;, testSrc,
122                 &quot;-helpfile&quot;, testSrc(&quot;test-help.html&quot;),
123                 &quot;-nohelp&quot;,
124                 testSrc(&quot;Sample.java&quot;));
125         checkExit(Exit.CMDERR);
126     }
127 
128     private void checkOutput(boolean withOption) {
129         checkOutput(Output.OUT, withOption,
130                 &quot;-d &quot;,
131                 &quot;-use &quot;,
132                 &quot;-version &quot;,
133                 &quot;-author &quot;,
134                 &quot;-docfilessubdirs\n&quot;,
135                 &quot;-splitindex &quot;,
136                 &quot;-windowtitle &quot;,
137                 &quot;-doctitle &quot;,
138                 &quot;-header &quot;,
139                 &quot;-footer &quot;,
140                 &quot;-bottom &quot;,
141                 &quot;-link &quot;,
142                 &quot;-linkoffline &quot;,
143                 &quot;-excludedocfilessubdir &quot;,
144                 &quot;-group &quot;,
145                 &quot;-nocomment &quot;,
146                 &quot;-nodeprecated\n&quot;,
147                 &quot;-noqualifier &quot;,
148                 &quot;-nosince &quot;,
149                 &quot;-notimestamp &quot;,
150                 &quot;-nodeprecatedlist\n&quot;,
151                 &quot;-notree &quot;,
152                 &quot;-noindex &quot;,
153                 &quot;-nohelp &quot;,
154                 &quot;-nonavbar &quot;,
155                 &quot;-serialwarn &quot;,
156                 &quot;-tag &quot;,
157                 &quot;-taglet &quot;,
158                 &quot;-tagletpath &quot;,
159                 &quot;-charset &quot;,
160                 &quot;-helpfile &quot;,
161                 &quot;-linksource &quot;,
162                 &quot;-sourcetab &quot;,
163                 &quot;-keywords &quot;,
164                 &quot;-stylesheetfile &quot;,
165                 &quot;--add-stylesheet &quot;,
166                 &quot;-docencoding &quot;,
167                 &quot;-html5 &quot;,
168                 &quot;-top &quot;,
169                 &quot;-author &quot;,
170                 &quot;-noqualifier &quot;,
171                 &quot;-nosince &quot;,
172                 &quot;-notimestamp &quot;,
173                 &quot;-sourcetab &quot;);
174 
175         checkFileAndOutput(&quot;Sample.html&quot;, !withOption,
176                 &quot;&lt;li&gt;&lt;a href=\&quot;help-doc.html\&quot;&gt;Help&lt;/a&gt;&lt;/li&gt;&quot;);
177     }
178 }
    </pre>
  </body>
</html>