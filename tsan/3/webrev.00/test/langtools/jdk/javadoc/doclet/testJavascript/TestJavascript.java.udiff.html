<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/langtools/jdk/javadoc/doclet/testJavascript/TestJavascript.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../testJavaFX/TestJavaFX.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../testLambdaFeature/TestLambdaFeature.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/langtools/jdk/javadoc/doclet/testJavascript/TestJavascript.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -21,13 +21,12 @@</span>
   * questions.
   */
  
  /*
   * @test
<span class="udiff-line-modified-removed">-  * @bug      4665566 4855876 7025314 8012375 8015997 8016328 8024756 8148985 8151921 8151743 8196202</span>
<span class="udiff-line-modified-added">+  * @bug      4665566 4855876 7025314 8012375 8015997 8016328 8024756 8148985 8151921 8151743 8196202 8223378</span>
   * @summary  Verify that the output has the right javascript.
<span class="udiff-line-removed">-  * @author   jamieh</span>
   * @library  ../../lib
   * @modules jdk.javadoc/jdk.javadoc.internal.tool
   * @build    javadoc.tester.*
   * @run main TestJavascript
   */
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -42,94 +41,26 @@</span>
      }
  
      @Test
      public void test() {
          javadoc(&quot;-d&quot;, &quot;out&quot;,
<span class="udiff-line-removed">-                 &quot;--frames&quot;,</span>
                  &quot;-sourcepath&quot;, testSrc,
                  &quot;pkg&quot;, testSrc(&quot;TestJavascript.java&quot;));
          checkExit(Exit.OK);
  
<span class="udiff-line-modified-removed">-         checkOutput(&quot;pkg/C.html&quot;, true,</span>
<span class="udiff-line-removed">-                 &quot;&lt;a href=\&quot;../index.html?pkg/C.html\&quot; target=\&quot;_top\&quot;&gt;Frames&lt;/a&gt;&quot;,</span>
<span class="udiff-line-modified-added">+         checkOutput(&quot;pkg/C.html&quot;, false,</span>
                  &quot;&lt;script type=\&quot;text/javascript\&quot;&gt;&lt;!--\n&quot;
                  + &quot;$(&#39;.navPadding&#39;).css(&#39;padding-top&#39;, $(&#39;.fixedNav&#39;).css(\&quot;height\&quot;));\n&quot;
                  + &quot;//--&gt;\n&quot;
                  + &quot;&lt;/script&gt;&quot;);
  
<span class="udiff-line-modified-removed">-         checkOutput(&quot;TestJavascript.html&quot;, true,</span>
<span class="udiff-line-modified-removed">-                 &quot;&lt;a href=\&quot;index.html?TestJavascript.html\&quot; target=\&quot;_top\&quot;&gt;Frames&lt;/a&gt;&quot;);</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-         checkOutput(&quot;index.html&quot;, true,</span>
<span class="udiff-line-removed">-                 &quot;&lt;script type=\&quot;text/javascript\&quot;&gt;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;    tmpTargetPage = \&quot;\&quot; + window.location.search;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;    if (tmpTargetPage != \&quot;\&quot; &amp;&amp; tmpTargetPage != \&quot;undefined\&quot;)\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        tmpTargetPage = tmpTargetPage.substring(1);\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;    if (tmpTargetPage.indexOf(\&quot;:\&quot;) != -1 || (tmpTargetPage != \&quot;\&quot; &amp;&amp; !validURL(tmpTargetPage)))\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        tmpTargetPage = \&quot;undefined\&quot;;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;    targetPage = tmpTargetPage;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;    function validURL(url) {\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        try {\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;            url = decodeURIComponent(url);\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        }\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        catch (error) {\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;            return false;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        }\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        var pos = url.indexOf(\&quot;.html\&quot;);\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        if (pos == -1 || pos != url.length - 5)\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;            return false;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        var allowNumber = false;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        var allowSep = false;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        var seenDot = false;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        for (var i = 0; i &lt; url.length - 5; i++) {\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;            var ch = url.charAt(i);\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;            if (&#39;a&#39; &lt;= ch &amp;&amp; ch &lt;= &#39;z&#39; ||\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                    &#39;A&#39; &lt;= ch &amp;&amp; ch &lt;= &#39;Z&#39; ||\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                    ch == &#39;$&#39; ||\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                    ch == &#39;_&#39; ||\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                    ch.charCodeAt(0) &gt; 127) {\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                allowNumber = true;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                allowSep = true;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;            } else if (&#39;0&#39; &lt;= ch &amp;&amp; ch &lt;= &#39;9&#39;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                    || ch == &#39;-&#39;) {\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                if (!allowNumber)\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                     return false;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;            } else if (ch == &#39;/&#39; || ch == &#39;.&#39;) {\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                if (!allowSep)\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                    return false;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                allowNumber = false;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                allowSep = false;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                if (ch == &#39;.&#39;)\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                     seenDot = true;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                if (ch == &#39;/&#39; &amp;&amp; seenDot)\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                     return false;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;            } else {\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;                return false;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;            }\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        }\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        return true;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;    }\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;    function loadFrames() {\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        if (targetPage != \&quot;\&quot; &amp;&amp; targetPage != \&quot;undefined\&quot;)\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;             top.classFrame.location = top.targetPage;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;    }\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;&lt;/script&gt;&quot;);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         checkOutput(&quot;index.html&quot;, true,</span>
<span class="udiff-line-removed">-                 &quot;&lt;body class=\&quot;frames\&quot; onload=\&quot;loadFrames()\&quot;&quot;);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         //Make sure title javascript only runs if is-external is not true</span>
<span class="udiff-line-removed">-         checkOutput(&quot;pkg/C.html&quot;, true,</span>
<span class="udiff-line-removed">-                 &quot;    try {\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        if (location.href.indexOf(&#39;is-external=true&#39;) == -1) {\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;            parent.document.title=\&quot;C\&quot;;\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;        }\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;    }\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;    catch(err) {\n&quot;</span>
<span class="udiff-line-removed">-                 + &quot;    }&quot;);</span>
<span class="udiff-line-modified-added">+         checkOutput(&quot;index.html&quot;, false,</span>
<span class="udiff-line-modified-added">+                 &quot;&lt;script type=\&quot;text/javascript\&quot;&gt;&lt;!--\n&quot;</span>
<span class="udiff-line-modified-added">+                 + &quot;$(&#39;.navPadding&#39;).css(&#39;padding-top&#39;, $(&#39;.fixedNav&#39;).css(\&quot;height\&quot;));\n&quot;</span>
<span class="udiff-line-modified-added">+                 + &quot;//--&gt;\n&quot;);</span>
  
<span class="udiff-line-modified-removed">-         checkOutput(&quot;script.js&quot;, true,</span>
<span class="udiff-line-modified-added">+         checkOutput(&quot;script.js&quot;, false,</span>
                  &quot;$(window).resize(function() {\n&quot;
                  + &quot;        $(&#39;.navPadding&#39;).css(&#39;padding-top&#39;, $(&#39;.fixedNav&#39;).css(\&quot;height\&quot;));\n&quot;
                  + &quot;    });&quot;);
      }
  }
</pre>
<center><a href="../testJavaFX/TestJavaFX.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../testLambdaFeature/TestLambdaFeature.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>