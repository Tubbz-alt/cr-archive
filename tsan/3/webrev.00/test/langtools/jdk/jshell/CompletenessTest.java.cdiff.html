<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/langtools/jdk/jshell/CompletenessTest.java</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="ClassesTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="CompletionSuggestionTest.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/langtools/jdk/jshell/CompletenessTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2015, 2016, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2015, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 21,23 ***</span>
   * questions.
   */
  
  /*
   * @test
<span class="line-modified">!  * @bug 8149524 8131024 8165211 8080071 8130454 8167343 8129559 8114842 8182268</span>
   * @summary Test SourceCodeAnalysis
   * @build KullaTesting TestingInputStream
   * @run testng CompletenessTest
   */
  
  import java.util.Map;
  import java.util.HashMap;
  
  import org.testng.annotations.Test;
  import jdk.jshell.SourceCodeAnalysis.Completeness;
  
  import static jdk.jshell.SourceCodeAnalysis.Completeness.*;
  
  @Test
  public class CompletenessTest extends KullaTesting {
  
      // Add complete units that end with semicolon to complete_with_semi (without
<span class="line-new-header">--- 21,27 ---</span>
   * questions.
   */
  
  /*
   * @test
<span class="line-modified">!  * @bug 8149524 8131024 8165211 8080071 8130454 8167343 8129559 8114842 8182268 8223782 8235474</span>
   * @summary Test SourceCodeAnalysis
   * @build KullaTesting TestingInputStream
   * @run testng CompletenessTest
   */
  
  import java.util.Map;
  import java.util.HashMap;
<span class="line-added">+ import java.util.function.Consumer;</span>
<span class="line-added">+ import javax.lang.model.SourceVersion;</span>
<span class="line-added">+ import jdk.jshell.JShell;</span>
  
  import org.testng.annotations.Test;
  import jdk.jshell.SourceCodeAnalysis.Completeness;
  
  import static jdk.jshell.SourceCodeAnalysis.Completeness.*;
<span class="line-added">+ import org.testng.annotations.BeforeMethod;</span>
  
  @Test
  public class CompletenessTest extends KullaTesting {
  
      // Add complete units that end with semicolon to complete_with_semi (without
</pre>
<hr />
<pre>
<span class="line-old-header">*** 61,11 ***</span>
          &quot;try { } finally { }&quot;,
          &quot;try (java.util.zip.ZipFile zf = new java.util.zip.ZipFile(zipFileName)) { }&quot;,
          &quot;foo: while (true) { printf(\&quot;Innn\&quot;); break foo; }&quot;,
          &quot;class Case&lt;E1 extends Enum&lt;E1&gt;, E2 extends Enum&lt;E2&gt;, E3 extends Enum&lt;E3&gt;&gt; {}&quot;,
          &quot;;&quot;,
<span class="line-modified">!         &quot;enum Tt { FOO, BAR, BAZ,; }&quot;</span>
      };
  
      static final String[] expression = new String[] {
          &quot;test&quot;,
          &quot;x + y&quot;,
<span class="line-new-header">--- 65,13 ---</span>
          &quot;try { } finally { }&quot;,
          &quot;try (java.util.zip.ZipFile zf = new java.util.zip.ZipFile(zipFileName)) { }&quot;,
          &quot;foo: while (true) { printf(\&quot;Innn\&quot;); break foo; }&quot;,
          &quot;class Case&lt;E1 extends Enum&lt;E1&gt;, E2 extends Enum&lt;E2&gt;, E3 extends Enum&lt;E3&gt;&gt; {}&quot;,
          &quot;;&quot;,
<span class="line-modified">!         &quot;enum Tt { FOO, BAR, BAZ,; }&quot;,</span>
<span class="line-added">+         &quot;record D(int i) {}&quot;,</span>
<span class="line-added">+         &quot;static record D(int i) {}&quot;,</span>
      };
  
      static final String[] expression = new String[] {
          &quot;test&quot;,
          &quot;x + y&quot;,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 78,10 ***</span>
<span class="line-new-header">--- 84,14 ---</span>
          &quot;new int[] {1, 2,3}&quot;,
          &quot;new Foo() {}&quot;,
          &quot;i &gt;= 0 &amp;&amp; Character.isWhitespace(s.charAt(i))&quot;,
          &quot;int.class&quot;,
          &quot;String.class&quot;,
<span class="line-added">+         &quot;record.any&quot;,</span>
<span class="line-added">+         &quot;record()&quot;,</span>
<span class="line-added">+         &quot;record(1)&quot;,</span>
<span class="line-added">+         &quot;record.length()&quot;</span>
      };
  
      static final String[] complete_with_semi = new String[] {
          &quot;int mm&quot;,
          &quot;if (t) ddd&quot;,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 189,10 ***</span>
<span class="line-new-header">--- 199,32 ---</span>
          &quot;switch (x) {&quot;,
          &quot;var v = switch (x) {&quot;,
          &quot;var v = switch (x) { case &quot;,
          &quot;var v = switch (x) { case 0:&quot;,
          &quot;var v = switch (x) { case 0: break 12; &quot;,
<span class="line-added">+         &quot;record D&quot;,</span>
<span class="line-added">+         &quot;record D(&quot;,</span>
<span class="line-added">+         &quot;record D(String&quot;,</span>
<span class="line-added">+         &quot;record D(String i&quot;,</span>
<span class="line-added">+         &quot;record D(String i,&quot;,</span>
<span class="line-added">+         &quot;record D(String i, String&quot;,</span>
<span class="line-added">+         &quot;record D(String i, String j&quot;,</span>
<span class="line-added">+         &quot;record D(String i)&quot;,</span>
<span class="line-added">+         &quot;record D(String i, String j)&quot;,</span>
<span class="line-added">+         &quot;record D(String i) {&quot;,</span>
<span class="line-added">+         &quot;record D(String i, String j) {&quot;,</span>
<span class="line-added">+         &quot;static record D&quot;,</span>
<span class="line-added">+         &quot;static record D(&quot;,</span>
<span class="line-added">+         &quot;static record D(String&quot;,</span>
<span class="line-added">+         &quot;static record D(String i&quot;,</span>
<span class="line-added">+         &quot;static record D(String i,&quot;,</span>
<span class="line-added">+         &quot;static record D(String i, String&quot;,</span>
<span class="line-added">+         &quot;static record D(String i, String j&quot;,</span>
<span class="line-added">+         &quot;static record D(String i)&quot;,</span>
<span class="line-added">+         &quot;static record D(String i, String j)&quot;,</span>
<span class="line-added">+         &quot;static record D(String i) {&quot;,</span>
<span class="line-added">+         &quot;static record D(String i, String j) {&quot;,</span>
      };
  
      static final String[] unknown = new String[] {
          &quot;new ;&quot;
      };
</pre>
<hr />
<pre>
<span class="line-old-header">*** 237,11 ***</span>
              assertStatus(input, status, input);
          }
      }
  
      public void test_complete() {
<span class="line-modified">!         assertStatus(complete, COMPLETE);</span>
      }
  
      public void test_expression() {
          assertStatus(expression, COMPLETE);
      }
<span class="line-new-header">--- 269,11 ---</span>
              assertStatus(input, status, input);
          }
      }
  
      public void test_complete() {
<span class="line-modified">!          assertStatus(complete, COMPLETE);</span>
      }
  
      public void test_expression() {
          assertStatus(expression, COMPLETE);
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 326,13 ***</span>
<span class="line-new-header">--- 358,31 ---</span>
      public void testOpenComment() {
          assertStatus(&quot;int xx; /* hello&quot;, DEFINITELY_INCOMPLETE, null);
          assertStatus(&quot;/**  test&quot;, DEFINITELY_INCOMPLETE, null);
      }
  
<span class="line-added">+     public void testTextBlocks() {</span>
<span class="line-added">+         assertStatus(&quot;\&quot;\&quot;\&quot;&quot;, DEFINITELY_INCOMPLETE, null);</span>
<span class="line-added">+         assertStatus(&quot;\&quot;\&quot;\&quot;broken&quot;, DEFINITELY_INCOMPLETE, null);</span>
<span class="line-added">+         assertStatus(&quot;\&quot;\&quot;\&quot;\ntext&quot;, DEFINITELY_INCOMPLETE, null);</span>
<span class="line-added">+         assertStatus(&quot;\&quot;\&quot;\&quot;\ntext\&quot;\&quot;&quot;, DEFINITELY_INCOMPLETE, &quot;\&quot;\&quot;\&quot;\ntext\&quot;\&quot;\&quot;&quot;);</span>
<span class="line-added">+         assertStatus(&quot;\&quot;\&quot;\&quot;\ntext\&quot;\&quot;\&quot;&quot;, COMPLETE, &quot;\&quot;\&quot;\&quot;\ntext\&quot;\&quot;\&quot;&quot;);</span>
<span class="line-added">+         assertStatus(&quot;\&quot;\&quot;\&quot;\ntext\\\&quot;\&quot;\&quot;\&quot;&quot;, COMPLETE, &quot;\&quot;\&quot;\&quot;\ntext\\\&quot;\&quot;\&quot;\&quot;&quot;);</span>
<span class="line-added">+         assertStatus(&quot;\&quot;\&quot;\&quot;\ntext\\\&quot;\&quot;\&quot;&quot;, DEFINITELY_INCOMPLETE, null);</span>
<span class="line-added">+         assertStatus(&quot;\&quot;\&quot;\&quot;\ntext\\\&quot;\&quot;\&quot;\\\&quot;\&quot;\&quot;&quot;, DEFINITELY_INCOMPLETE, null);</span>
<span class="line-added">+         assertStatus(&quot;\&quot;\&quot;\&quot;\ntext\\\&quot;\&quot;\&quot;\\\&quot;\&quot;\&quot;\&quot;\&quot;\&quot;&quot;, COMPLETE, &quot;\&quot;\&quot;\&quot;\ntext\\\&quot;\&quot;\&quot;\\\&quot;\&quot;\&quot;\&quot;\&quot;\&quot;&quot;);</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      public void testMiscSource() {
          assertStatus(&quot;if (t) if &quot;, DEFINITELY_INCOMPLETE, &quot;if (t) if&quot;); //Bug
          assertStatus(&quot;int m() {} dfd&quot;, COMPLETE, &quot;int m() {}&quot;);
          assertStatus(&quot;int p = &quot;, DEFINITELY_INCOMPLETE, &quot;int p =&quot;); //Bug
          assertStatus(&quot;int[] m = {1, 2}, n = new int[0];  int i;&quot;, COMPLETE,
                       &quot;int[] m = {1, 2}, n = new int[0];&quot;);
      }
<span class="line-added">+ </span>
<span class="line-added">+     @BeforeMethod</span>
<span class="line-added">+     public void setUp() {</span>
<span class="line-added">+         setUp(b -&gt; b.compilerOptions(&quot;--enable-preview&quot;, &quot;-source&quot;, String.valueOf(SourceVersion.latest().ordinal())));</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
  }
</pre>
<center><a href="ClassesTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="CompletionSuggestionTest.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>