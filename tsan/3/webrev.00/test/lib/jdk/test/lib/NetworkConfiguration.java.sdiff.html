<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/lib/jdk/test/lib/NetworkConfiguration.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="ByteCodeLoader.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="Platform.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/lib/jdk/test/lib/NetworkConfiguration.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 package jdk.test.lib;
 25 
 26 import java.io.IOException;
 27 import java.io.PrintStream;
 28 import java.io.UncheckedIOException;
 29 import java.net.Inet4Address;
 30 import java.net.Inet6Address;
 31 import java.net.InetAddress;
 32 import java.net.NetworkInterface;
 33 import java.util.Arrays;
 34 import java.util.HashMap;
 35 import java.util.LinkedList;
 36 import java.util.List;
 37 import java.util.Map;
 38 import java.util.stream.Collectors;
 39 import java.util.stream.Stream;


 40 
 41 import static java.net.NetworkInterface.getNetworkInterfaces;
 42 import static java.util.Collections.list;
 43 
 44 /**
 45  * Helper class for retrieving network interfaces and local addresses
 46  * suitable for testing.
 47  */
 48 public class NetworkConfiguration {
 49 
 50     private Map&lt;NetworkInterface,List&lt;Inet4Address&gt;&gt; ip4Interfaces;
 51     private Map&lt;NetworkInterface,List&lt;Inet6Address&gt;&gt; ip6Interfaces;
 52     private final boolean isIPv6Available;
 53     private boolean has_testableipv6address = false;
 54     private boolean has_sitelocaladdress = false;
 55     private boolean has_linklocaladdress = false;
 56     private boolean has_globaladdress = false;
 57 
 58     private NetworkConfiguration(
 59             Map&lt;NetworkInterface,List&lt;Inet4Address&gt;&gt; ip4Interfaces,
</pre>
<hr />
<pre>
363               .append(nif.isVirtual())
364               .append(&quot;\n&quot;);
365             sb.append(&quot;Hardware address: &quot;)
366               .append(Arrays.toString(nif.getHardwareAddress()))
367               .append(&quot;\n&quot;);
368             sb.append(&quot;MTU: &quot;)
369               .append(nif.getMTU())
370               .append(&quot;\n&quot;);
371             sb.append(&quot;Index: &quot;)
372               .append(nif.getIndex())
373               .append(&quot;\n&quot;);
374             sb.append(&quot;\n&quot;);
375             return sb.toString();
376         } catch (IOException e) {
377             throw new UncheckedIOException(e);
378         }
379     }
380 
381     /** Prints all the system interface information to the give stream. */
382     public static void printSystemConfiguration(PrintStream out) {

383         try {
384             out.println(&quot;*** all system network interface configuration ***&quot;);
385             for (NetworkInterface nif : list(getNetworkInterfaces())) {
386                 out.print(interfaceInformation(nif));
387             }
388             out.println(&quot;*** end ***&quot;);

389         } catch (IOException e) {
390             throw new UncheckedIOException(e);
<span class="line-modified">391         }</span>

392     }
393 }
</pre>
</td>
<td>
<hr />
<pre>
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 package jdk.test.lib;
 25 
 26 import java.io.IOException;
 27 import java.io.PrintStream;
 28 import java.io.UncheckedIOException;
 29 import java.net.Inet4Address;
 30 import java.net.Inet6Address;
 31 import java.net.InetAddress;
 32 import java.net.NetworkInterface;
 33 import java.util.Arrays;
 34 import java.util.HashMap;
 35 import java.util.LinkedList;
 36 import java.util.List;
 37 import java.util.Map;
 38 import java.util.stream.Collectors;
 39 import java.util.stream.Stream;
<span class="line-added"> 40 import java.security.AccessController;</span>
<span class="line-added"> 41 import java.security.PrivilegedAction;</span>
 42 
 43 import static java.net.NetworkInterface.getNetworkInterfaces;
 44 import static java.util.Collections.list;
 45 
 46 /**
 47  * Helper class for retrieving network interfaces and local addresses
 48  * suitable for testing.
 49  */
 50 public class NetworkConfiguration {
 51 
 52     private Map&lt;NetworkInterface,List&lt;Inet4Address&gt;&gt; ip4Interfaces;
 53     private Map&lt;NetworkInterface,List&lt;Inet6Address&gt;&gt; ip6Interfaces;
 54     private final boolean isIPv6Available;
 55     private boolean has_testableipv6address = false;
 56     private boolean has_sitelocaladdress = false;
 57     private boolean has_linklocaladdress = false;
 58     private boolean has_globaladdress = false;
 59 
 60     private NetworkConfiguration(
 61             Map&lt;NetworkInterface,List&lt;Inet4Address&gt;&gt; ip4Interfaces,
</pre>
<hr />
<pre>
365               .append(nif.isVirtual())
366               .append(&quot;\n&quot;);
367             sb.append(&quot;Hardware address: &quot;)
368               .append(Arrays.toString(nif.getHardwareAddress()))
369               .append(&quot;\n&quot;);
370             sb.append(&quot;MTU: &quot;)
371               .append(nif.getMTU())
372               .append(&quot;\n&quot;);
373             sb.append(&quot;Index: &quot;)
374               .append(nif.getIndex())
375               .append(&quot;\n&quot;);
376             sb.append(&quot;\n&quot;);
377             return sb.toString();
378         } catch (IOException e) {
379             throw new UncheckedIOException(e);
380         }
381     }
382 
383     /** Prints all the system interface information to the give stream. */
384     public static void printSystemConfiguration(PrintStream out) {
<span class="line-added">385         PrivilegedAction&lt;Void&gt; pa = () -&gt; {</span>
386         try {
387             out.println(&quot;*** all system network interface configuration ***&quot;);
388             for (NetworkInterface nif : list(getNetworkInterfaces())) {
389                 out.print(interfaceInformation(nif));
390             }
391             out.println(&quot;*** end ***&quot;);
<span class="line-added">392             return null;</span>
393         } catch (IOException e) {
394             throw new UncheckedIOException(e);
<span class="line-modified">395         }};</span>
<span class="line-added">396         AccessController.doPrivileged(pa);</span>
397     }
398 }
</pre>
</td>
</tr>
</table>
<center><a href="ByteCodeLoader.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="Platform.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>