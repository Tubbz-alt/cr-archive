<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/lib/jdk/test/lib/jfr/GCHelper.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="Events.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../process/OutputAnalyzer.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/lib/jdk/test/lib/jfr/GCHelper.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2013, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2013, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -66,22 +66,21 @@</span>
      public static final String event_phases_level_1 = EventNames.GCPhasePauseLevel1;
      public static final String event_phases_level_2 = EventNames.GCPhasePauseLevel2;
      public static final String event_phases_level_3 = EventNames.GCPhasePauseLevel3;
  
      public static final String gcG1New = &quot;G1New&quot;;
<span class="udiff-line-removed">-     public static final String gcParNew = &quot;ParNew&quot;;</span>
      public static final String gcDefNew = &quot;DefNew&quot;;
      public static final String gcParallelScavenge = &quot;ParallelScavenge&quot;;
      public static final String gcG1Old = &quot;G1Old&quot;;
      public static final String gcG1Full = &quot;G1Full&quot;;
<span class="udiff-line-removed">-     public static final String gcConcurrentMarkSweep = &quot;ConcurrentMarkSweep&quot;;</span>
      public static final String gcSerialOld = &quot;SerialOld&quot;;
      public static final String gcPSMarkSweep = &quot;PSMarkSweep&quot;;
      public static final String gcParallelOld = &quot;ParallelOld&quot;;
      public static final String pauseLevelEvent = &quot;GCPhasePauseLevel&quot;;
  
      private static final List&lt;String&gt; g1HeapRegionTypes;
<span class="udiff-line-added">+     private static final List&lt;String&gt; shenandoahHeapRegionStates;</span>
      private static PrintStream defaultErrorLog = null;
  
      public static int getGcId(RecordedEvent event) {
          return Events.assertField(event, &quot;gcId&quot;).getValue();
      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -171,30 +170,25 @@</span>
      static {
          // young GarbageCollectionMXBeans.
          beanCollectorTypes.put(&quot;G1 Young Generation&quot;, true);
          beanCollectorTypes.put(&quot;Copy&quot;, true);
          beanCollectorTypes.put(&quot;PS Scavenge&quot;, true);
<span class="udiff-line-removed">-         beanCollectorTypes.put(&quot;ParNew&quot;, true);</span>
  
          // old GarbageCollectionMXBeans.
          beanCollectorTypes.put(&quot;G1 Old Generation&quot;, false);
<span class="udiff-line-removed">-         beanCollectorTypes.put(&quot;ConcurrentMarkSweep&quot;, false);</span>
          beanCollectorTypes.put(&quot;PS MarkSweep&quot;, false);
          beanCollectorTypes.put(&quot;MarkSweepCompact&quot;, false);
  
          // List of expected collector overrides. &quot;A.B&quot; means that collector A may use collector B.
          collectorOverrides.add(&quot;G1Old.G1Full&quot;);
<span class="udiff-line-removed">-         collectorOverrides.add(&quot;ConcurrentMarkSweep.SerialOld&quot;);</span>
          collectorOverrides.add(&quot;SerialOld.PSMarkSweep&quot;);
  
          requiredEvents.put(gcG1New, new String[] {event_heap_summary, event_young_garbage_collection});
<span class="udiff-line-removed">-         requiredEvents.put(gcParNew, new String[] {event_heap_summary, event_heap_metaspace_summary, event_phases_pause, event_phases_level_1, event_young_garbage_collection});</span>
          requiredEvents.put(gcDefNew, new String[] {event_heap_summary, event_heap_metaspace_summary, event_phases_pause, event_phases_level_1, event_young_garbage_collection});
          requiredEvents.put(gcParallelScavenge, new String[] {event_heap_summary, event_heap_ps_summary, event_heap_metaspace_summary, event_reference_statistics, event_phases_pause, event_phases_level_1, event_young_garbage_collection});
          requiredEvents.put(gcG1Old, new String[] {event_heap_summary, event_old_garbage_collection});
          requiredEvents.put(gcG1Full, new String[] {event_heap_summary, event_heap_metaspace_summary, event_phases_pause, event_phases_level_1, event_old_garbage_collection});
<span class="udiff-line-removed">-         requiredEvents.put(gcConcurrentMarkSweep, new String[] {event_phases_pause, event_phases_level_1, event_old_garbage_collection});</span>
          requiredEvents.put(gcSerialOld, new String[] {event_heap_summary, event_heap_metaspace_summary, event_phases_pause, event_phases_level_1, event_old_garbage_collection});
          requiredEvents.put(gcParallelOld, new String[] {event_heap_summary, event_heap_ps_summary, event_heap_metaspace_summary, event_reference_statistics, event_phases_pause, event_phases_level_1, event_old_garbage_collection, event_parold_garbage_collection});
  
          String[] g1HeapRegionTypeLiterals = new String[] {
                                                             &quot;Free&quot;,
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -205,10 +199,25 @@</span>
                                                             &quot;Old&quot;,
                                                             &quot;Archive&quot;
                                                           };
  
          g1HeapRegionTypes = Collections.unmodifiableList(Arrays.asList(g1HeapRegionTypeLiterals));
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         String[] shenandoahHeapRegionStateLiterals = new String[] {</span>
<span class="udiff-line-added">+                                                                     &quot;Empty Uncommitted&quot;,</span>
<span class="udiff-line-added">+                                                                     &quot;Empty Committed&quot;,</span>
<span class="udiff-line-added">+                                                                     &quot;Regular&quot;,</span>
<span class="udiff-line-added">+                                                                     &quot;Humongous Start&quot;,</span>
<span class="udiff-line-added">+                                                                     &quot;Humongous Continuation&quot;,</span>
<span class="udiff-line-added">+                                                                     &quot;Humongous Start, Pinned&quot;,</span>
<span class="udiff-line-added">+                                                                     &quot;Collection Set&quot;,</span>
<span class="udiff-line-added">+                                                                     &quot;Pinned&quot;,</span>
<span class="udiff-line-added">+                                                                     &quot;Collection Set, Pinned&quot;,</span>
<span class="udiff-line-added">+                                                                     &quot;Trash&quot;</span>
<span class="udiff-line-added">+         };</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         shenandoahHeapRegionStates = Collections.unmodifiableList(Arrays.asList(shenandoahHeapRegionStateLiterals));</span>
      }
  
      /**
       * Contains all GC events belonging to the same GC (same gcId).
       */
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -441,10 +450,17 @@</span>
  
      public static boolean isValidG1HeapRegionType(final String type) {
          return g1HeapRegionTypes.contains(type);
      }
  
<span class="udiff-line-added">+     public static boolean assertIsValidShenandoahHeapRegionState(final String state) {</span>
<span class="udiff-line-added">+         if (!shenandoahHeapRegionStates.contains(state)) {</span>
<span class="udiff-line-added">+             throw new AssertionError(&quot;Unknown state &#39;&quot; + state + &quot;&#39;, valid heap region states are &quot; + shenandoahHeapRegionStates);</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+         return true;</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
      /**
       * Helper function to align heap size up.
       *
       * @param value
       * @param alignment
</pre>
<center><a href="Events.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../process/OutputAnalyzer.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>