<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/sanity/client/SwingSet/src/ColorChooserDemoTest.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="ButtonDemoScreenshotTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="EditorPaneDemoTest.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/sanity/client/SwingSet/src/ColorChooserDemoTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 51 import com.sun.swingset3.demos.colorchooser.BezierAnimationPanel.BezierColor;
 52 import com.sun.swingset3.demos.colorchooser.ColorChooserDemo;
 53 
 54 /*
 55 * @test
 56 * @key headful
 57 * @summary Verifies SwingSet3 ColorChooserDemo by performing simple interaction
 58 *  with all the controls that are shown in the ColorChooserDialog.
 59 *
 60 * @library /sanity/client/lib/jemmy/src
 61 * @library /sanity/client/lib/Extensions/src
 62 * @library /sanity/client/lib/SwingSet3/src
 63 * @modules java.desktop
 64 *          java.logging
 65 * @build com.sun.swingset3.demos.colorchooser.ColorChooserDemo
 66 * @run testng ColorChooserDemoTest
 67 */
 68 @Listeners(GuiTestListener.class)
 69 public class ColorChooserDemoTest {
 70 
<span class="line-modified"> 71 private static final String OK_BUTTON_TITLE = &quot;OK&quot;;</span>
<span class="line-modified"> 72 private static final String CANCEL_BUTTON_TITLE = &quot;Cancel&quot;;</span>
<span class="line-modified"> 73 private static final String RESET_BUTTON_TITLE = &quot;Reset&quot;;</span>
<span class="line-modified"> 74 private static final String HSV = &quot;HSV&quot;;</span>
<span class="line-modified"> 75 private static final String RGB = &quot;RGB&quot;;</span>
<span class="line-modified"> 76 private static final String HSL = &quot;HSL&quot;;</span>
<span class="line-modified"> 77 private static final String CMYK = &quot;CMYK&quot;;</span>
<span class="line-modified"> 78 private static final int HSV_NUMBER_OF_SLIDERS_AND_SPINNERS = 4;</span>
<span class="line-modified"> 79 private static final int RGB_NUMBER_OF_SLIDERS_AND_SPINNERS = 4;</span>
<span class="line-modified"> 80 private static final int HSL_NUMBER_OF_SLIDERS_AND_SPINNERS = 4;</span>
<span class="line-modified"> 81 private static final int CMYK_NUMBER_OF_SLIDERS_AND_SPINNERS = 5;</span>
<span class="line-modified"> 82 private static final int HSV_HUE_INDEX = 0;</span>
<span class="line-modified"> 83 private static final int HSV_SATURATION_INDEX = 1;</span>
<span class="line-modified"> 84 private static final int HSV_VALUE_INDEX = 2;</span>
<span class="line-modified"> 85 private static final int HSV_TRANSPARENCY_INDEX = 3;</span>
<span class="line-modified"> 86 private static final int HSL_HUE_INDEX = 0;</span>
<span class="line-modified"> 87 private static final int HSL_SATURATION_INDEX = 1;</span>
<span class="line-modified"> 88 private static final int HSL_LIGHTNESS_INDEX = 2;</span>
<span class="line-modified"> 89 private static final int HSL_TRANSPARENCY_INDEX = 3;</span>
<span class="line-modified"> 90 private static final int RGB_RED_INDEX = 0;</span>
<span class="line-modified"> 91 private static final int RGB_GREEN_INDEX = 1;</span>
<span class="line-modified"> 92 private static final int RGB_BLUE_INDEX = 2;</span>
<span class="line-modified"> 93 private static final int RGB_ALPHA_INDEX = 3;</span>
<span class="line-modified"> 94 private static final int RGB_COLORCODE_TEXT_FIELD_INDEX = 4;</span>
<span class="line-modified"> 95 private static final int CMYK_CYAN_INDEX = 0;</span>
<span class="line-modified"> 96 private static final int CMYK_MAGENTA_INDEX = 1;</span>
<span class="line-modified"> 97 private static final int CMYK_YELLOW_INDEX = 2;</span>
<span class="line-modified"> 98 private static final int CMYK_BLACK_INDEX = 3;</span>
<span class="line-modified"> 99 private static final int CMYK_ALPHA_INDEX = 4;</span>
<span class="line-modified">100 </span>
<span class="line-modified">101 private final Color resetColor = new Color(125, 125, 125);</span>
<span class="line-modified">102 </span>
<span class="line-modified">103 private JDialogOperator colorChooserDialog;</span>
<span class="line-modified">104 private JButtonOperator okButton;</span>
<span class="line-modified">105 private JButtonOperator cancelButton;</span>
<span class="line-modified">106 private JButtonOperator resetButton;</span>
<span class="line-modified">107 private JColorChooserOperator colorChooser;</span>
<span class="line-modified">108 private JButtonOperator backgroundButton;</span>
<span class="line-modified">109 private JButtonOperator gradient1Button;</span>
<span class="line-modified">110 private JButtonOperator gradient2Button;</span>
<span class="line-modified">111 private JButtonOperator perimeterButton;</span>
<span class="line-modified">112 private JTabbedPaneOperator tabOperator;</span>
<span class="line-modified">113 private JComponentOperator bezierAnimationPanel;</span>
<span class="line-modified">114 private JSliderOperator[] sliders = new JSliderOperator[5];</span>
<span class="line-modified">115 private JSpinnerOperator[] spinners = new JSpinnerOperator[5];</span>
<span class="line-modified">116 private JButtonOperator lastFocusedButton;</span>
<span class="line-modified">117 </span>
<span class="line-modified">118 @Test</span>
<span class="line-modified">119 public void test() throws Exception {</span>
<span class="line-modified">120 new ClassReference(ColorChooserDemo.class.getCanonicalName()).startApplication();</span>
<span class="line-modified">121 JFrameOperator frame = new JFrameOperator(DEMO_TITLE);</span>
<span class="line-modified">122 bezierAnimationPanel = new JComponentOperator(frame, new ByClassChooser(BezierAnimationPanel.class));</span>
<span class="line-modified">123 initializePanelButtons(frame);</span>
<span class="line-modified">124 checkBackgroundColorChooser();</span>
<span class="line-modified">125 checkGradient1ColorChooser();</span>
<span class="line-modified">126 checkGradient2ColorChooser();</span>
<span class="line-modified">127 checkPerimeterColorChooser();</span>








































































































































































































128 }
129 
<span class="line-removed">130 private void checkBackgroundColorChooser() throws Exception {</span>
<span class="line-removed">131 basicCheck(backgroundButton, BezierColor.BACKGROUND);</span>
<span class="line-removed">132 checkAllColorChoosers(backgroundButton);</span>
<span class="line-removed">133 }</span>
<span class="line-removed">134 </span>
<span class="line-removed">135 private void checkGradient1ColorChooser() throws Exception {</span>
<span class="line-removed">136 basicCheck(gradient1Button, BezierColor.GRADIENT_A);</span>
<span class="line-removed">137 }</span>
<span class="line-removed">138 </span>
<span class="line-removed">139 private void checkGradient2ColorChooser() throws Exception {</span>
<span class="line-removed">140 basicCheck(gradient2Button, BezierColor.GRADIENT_B);</span>
<span class="line-removed">141 }</span>
<span class="line-removed">142 </span>
<span class="line-removed">143 private void checkPerimeterColorChooser() throws Exception {</span>
<span class="line-removed">144 basicCheck(perimeterButton, BezierColor.OUTER);</span>
<span class="line-removed">145 }</span>
<span class="line-removed">146 </span>
<span class="line-removed">147 private void pushButtonAndInitialize(JButtonOperator jbo) throws InterruptedException {</span>
<span class="line-removed">148 // Wait for focus to return to last focused button</span>
<span class="line-removed">149 lastFocusedButton.waitHasFocus();</span>
<span class="line-removed">150 jbo.pushNoBlock();</span>
<span class="line-removed">151 lastFocusedButton = jbo;</span>
<span class="line-removed">152 // Wait till the ColorChooserDemo Dialog Opens</span>
<span class="line-removed">153 new DialogWaiter().waitDialog(CHOOSER_TITLE, false, false);</span>
<span class="line-removed">154 initializeDialog();</span>
<span class="line-removed">155 }</span>
<span class="line-removed">156 </span>
<span class="line-removed">157 private void initializePanelButtons(JFrameOperator frame) {</span>
<span class="line-removed">158 backgroundButton = new JButtonOperator(frame, BACKGROUND);</span>
<span class="line-removed">159 gradient1Button = new JButtonOperator(frame, GRADIENT_1);</span>
<span class="line-removed">160 gradient2Button = new JButtonOperator(frame, GRADIENT_2);</span>
<span class="line-removed">161 perimeterButton = new JButtonOperator(frame, PERIMETER);</span>
<span class="line-removed">162 lastFocusedButton = backgroundButton;</span>
<span class="line-removed">163 }</span>
<span class="line-removed">164 </span>
<span class="line-removed">165 private void initializeDialog() {</span>
<span class="line-removed">166 colorChooserDialog = new JDialogOperator(CHOOSER_TITLE);</span>
<span class="line-removed">167 tabOperator = new JTabbedPaneOperator(colorChooserDialog);</span>
<span class="line-removed">168 colorChooser = new JColorChooserOperator(colorChooserDialog);</span>
<span class="line-removed">169 okButton = new JButtonOperator(colorChooserDialog, OK_BUTTON_TITLE);</span>
<span class="line-removed">170 cancelButton = new JButtonOperator(colorChooserDialog, CANCEL_BUTTON_TITLE);</span>
<span class="line-removed">171 resetButton = new JButtonOperator(colorChooserDialog, RESET_BUTTON_TITLE);</span>
<span class="line-removed">172 }</span>
<span class="line-removed">173 </span>
<span class="line-removed">174 private void basicCheck(JButtonOperator jbo, BezierColor bezierColor) throws Exception {</span>
<span class="line-removed">175 Color testColor = new Color(100, 26, 155);</span>
<span class="line-removed">176 Color testColor2 = new Color(10, 40, 50);</span>
<span class="line-removed">177 checkDefaultColorChooser(jbo, testColor, bezierColor);</span>
<span class="line-removed">178 checkCancelButton(jbo, testColor2);</span>
<span class="line-removed">179 checkResetButton(jbo, testColor2);</span>
<span class="line-removed">180 }</span>
<span class="line-removed">181 </span>
<span class="line-removed">182 private void checkDefaultColorChooser(JButtonOperator jbo, Color testColor, BezierColor bezierColor)</span>
<span class="line-removed">183 throws Exception {</span>
<span class="line-removed">184 BezierAnimationPanel bezierPanel;</span>
<span class="line-removed">185 pushButtonAndInitialize(jbo);</span>
<span class="line-removed">186 // Check ColorChooser color is being set and used accordingly</span>
<span class="line-removed">187 // in the animation panel</span>
<span class="line-removed">188 setAndWaitColor(testColor);</span>
<span class="line-removed">189 pushButtonAndWaitDialogClosed(okButton);</span>
<span class="line-removed">190 bezierPanel = (BezierAnimationPanel) bezierAnimationPanel.getSource();</span>
<span class="line-removed">191 colorChooser.waitStateOnQueue(jColorChooser -&gt; (bezierPanel.getBezierColor(bezierColor).equals(testColor)));</span>
<span class="line-removed">192 }</span>
<span class="line-removed">193 </span>
<span class="line-removed">194 private void checkCancelButton(JButtonOperator jbo, Color testColor) throws Exception {</span>
<span class="line-removed">195 pushButtonAndInitialize(jbo);</span>
<span class="line-removed">196 setAndWaitColor(testColor);</span>
<span class="line-removed">197 pushButtonAndWaitDialogClosed(cancelButton);</span>
<span class="line-removed">198 }</span>
<span class="line-removed">199 </span>
<span class="line-removed">200 private void checkResetButton(JButtonOperator jbo, Color testColor) throws Exception {</span>
<span class="line-removed">201 pushButtonAndInitialize(jbo);</span>
<span class="line-removed">202 Color initialColor = colorChooser.getColor();</span>
<span class="line-removed">203 setAndWaitColor(testColor);</span>
<span class="line-removed">204 resetButton.push();</span>
<span class="line-removed">205 waitJColorChooserColor(initialColor);</span>
<span class="line-removed">206 pushButtonAndWaitDialogClosed(okButton);</span>
<span class="line-removed">207 }</span>
<span class="line-removed">208 </span>
<span class="line-removed">209 private void checkAllColorChoosers(JButtonOperator jbo) throws Exception {</span>
<span class="line-removed">210 pushButtonAndInitialize(jbo);</span>
<span class="line-removed">211 checkHSV();</span>
<span class="line-removed">212 checkHSL();</span>
<span class="line-removed">213 checkRGB();</span>
<span class="line-removed">214 checkCMYK();</span>
<span class="line-removed">215 pushButtonAndWaitDialogClosed(okButton);</span>
<span class="line-removed">216 }</span>
<span class="line-removed">217 </span>
<span class="line-removed">218 private void waitJColorChooserColor(Color expectedColor) {</span>
<span class="line-removed">219 colorChooser.waitStateOnQueue(jColorChooser -&gt; colorChooser.getColor().equals(expectedColor));</span>
<span class="line-removed">220 }</span>
<span class="line-removed">221 </span>
<span class="line-removed">222 private void setAndWaitColor(Color color) {</span>
<span class="line-removed">223 colorChooser.setColor(color);</span>
<span class="line-removed">224 // Wait for the Color to be set</span>
<span class="line-removed">225 waitJColorChooserColor(color);</span>
<span class="line-removed">226 }</span>
<span class="line-removed">227 </span>
<span class="line-removed">228 private void resetColor() {</span>
<span class="line-removed">229 colorChooser.setColor(resetColor);</span>
<span class="line-removed">230 // Wait for the Color to be reset</span>
<span class="line-removed">231 waitJColorChooserColor(resetColor);</span>
<span class="line-removed">232 }</span>
<span class="line-removed">233 </span>
<span class="line-removed">234 private void checkHSV() {</span>
<span class="line-removed">235 tabOperator.selectPage(HSV);</span>
<span class="line-removed">236 initializeSliderAndSpinner(HSV_NUMBER_OF_SLIDERS_AND_SPINNERS);</span>
<span class="line-removed">237 resetColor();</span>
<span class="line-removed">238 setAndCheckSlider(sliders[HSV_SATURATION_INDEX], 50, new Color(125, 62, 62));</span>
<span class="line-removed">239 setAndCheckSlider(sliders[HSV_VALUE_INDEX], 80, new Color(204, 102, 102));</span>
<span class="line-removed">240 setAndCheckSlider(sliders[HSV_HUE_INDEX], 50, new Color(204, 187, 102));</span>
<span class="line-removed">241 setAndCheckSlider(sliders[HSV_TRANSPARENCY_INDEX], 50, new Color(204, 187, 102, 127));</span>
<span class="line-removed">242 setAndCheckSpinner(spinners[HSV_SATURATION_INDEX], 25, new Color(204, 195, 153, 127));</span>
<span class="line-removed">243 setAndCheckSpinner(spinners[HSV_VALUE_INDEX], 40, new Color(102, 97, 76, 127));</span>
<span class="line-removed">244 setAndCheckSpinner(spinners[HSV_HUE_INDEX], 25, new Color(102, 87, 76, 127));</span>
<span class="line-removed">245 setAndCheckSpinner(spinners[HSV_TRANSPARENCY_INDEX], 100, new Color(102, 87, 76, 0));</span>
<span class="line-removed">246 }</span>
<span class="line-removed">247 </span>
<span class="line-removed">248 private void checkHSL() {</span>
<span class="line-removed">249 tabOperator.selectPage(HSL);</span>
<span class="line-removed">250 initializeSliderAndSpinner(HSL_NUMBER_OF_SLIDERS_AND_SPINNERS);</span>
<span class="line-removed">251 resetColor();</span>
<span class="line-removed">252 setAndCheckSlider(sliders[HSL_SATURATION_INDEX], 50, new Color(187, 62, 62));</span>
<span class="line-removed">253 setAndCheckSlider(sliders[HSL_LIGHTNESS_INDEX], 80, new Color(229, 178, 178));</span>
<span class="line-removed">254 setAndCheckSlider(sliders[HSL_HUE_INDEX], 180, new Color(178, 229, 229));</span>
<span class="line-removed">255 setAndCheckSlider(sliders[HSL_TRANSPARENCY_INDEX], 50, new Color(178, 229, 229, 127));</span>
<span class="line-removed">256 setAndCheckSpinner(spinners[HSL_SATURATION_INDEX], 25, new Color(191, 216, 216, 127));</span>
<span class="line-removed">257 setAndCheckSpinner(spinners[HSL_LIGHTNESS_INDEX], 40, new Color(76, 127, 127, 127));</span>
<span class="line-removed">258 setAndCheckSpinner(spinners[HSL_HUE_INDEX], 25, new Color(127, 97, 76, 127));</span>
<span class="line-removed">259 setAndCheckSpinner(spinners[HSL_TRANSPARENCY_INDEX], 50, new Color(127, 97, 76, 127));</span>
<span class="line-removed">260 }</span>
<span class="line-removed">261 </span>
<span class="line-removed">262 private void checkRGB() {</span>
<span class="line-removed">263 String sampleColor = &quot;111111&quot;;</span>
<span class="line-removed">264 tabOperator.selectPage(RGB);</span>
<span class="line-removed">265 initializeSliderAndSpinner(RGB_NUMBER_OF_SLIDERS_AND_SPINNERS);</span>
<span class="line-removed">266 JTextFieldOperator colorCode = new JTextFieldOperator(colorChooserDialog, RGB_COLORCODE_TEXT_FIELD_INDEX);</span>
<span class="line-removed">267 resetColor();</span>
<span class="line-removed">268 setAndCheckSlider(sliders[RGB_GREEN_INDEX], 50, new Color(125, 50, 125, 255));</span>
<span class="line-removed">269 setAndCheckSlider(sliders[RGB_BLUE_INDEX], 80, new Color(125, 50, 80, 255));</span>
<span class="line-removed">270 setAndCheckSlider(sliders[RGB_RED_INDEX], 50, new Color(50, 50, 80, 255));</span>
<span class="line-removed">271 setAndCheckSlider(sliders[RGB_ALPHA_INDEX], 125, new Color(50, 50, 80, 125));</span>
<span class="line-removed">272 setAndCheckSpinner(spinners[RGB_GREEN_INDEX], 25, new Color(50, 25, 80, 125));</span>
<span class="line-removed">273 setAndCheckSpinner(spinners[RGB_BLUE_INDEX], 40, new Color(50, 25, 40, 125));</span>
<span class="line-removed">274 setAndCheckSpinner(spinners[RGB_RED_INDEX], 25, new Color(25, 25, 40, 125));</span>
<span class="line-removed">275 setAndCheckSpinner(spinners[RGB_ALPHA_INDEX], 255, new Color(25, 25, 40, 255));</span>
<span class="line-removed">276 </span>
<span class="line-removed">277 colorCode.setText(sampleColor);</span>
<span class="line-removed">278 // Wait for the sampleColor to be set in the color code text field.</span>
<span class="line-removed">279 colorCode.waitText(sampleColor);</span>
<span class="line-removed">280 colorCode.getFocus();</span>
<span class="line-removed">281 colorCode.pressKey(KeyEvent.VK_TAB);</span>
<span class="line-removed">282 // Wait for the color to be set</span>
<span class="line-removed">283 waitJColorChooserColor(new Color(17, 17, 17, 255));</span>
<span class="line-removed">284 }</span>
<span class="line-removed">285 </span>
<span class="line-removed">286 private void checkCMYK() {</span>
<span class="line-removed">287 tabOperator.selectPage(CMYK);</span>
<span class="line-removed">288 initializeSliderAndSpinner(CMYK_NUMBER_OF_SLIDERS_AND_SPINNERS);</span>
<span class="line-removed">289 resetColor();</span>
<span class="line-removed">290 setAndCheckSlider(sliders[CMYK_MAGENTA_INDEX], 50, new Color(125, 100, 125, 255));</span>
<span class="line-removed">291 setAndCheckSlider(sliders[CMYK_YELLOW_INDEX], 80, new Color(125, 100, 85, 255));</span>
<span class="line-removed">292 setAndCheckSlider(sliders[CMYK_CYAN_INDEX], 50, new Color(100, 100, 85, 255));</span>
<span class="line-removed">293 setAndCheckSlider(sliders[CMYK_BLACK_INDEX], 50, new Color(164, 164, 140, 255));</span>
<span class="line-removed">294 setAndCheckSlider(sliders[CMYK_ALPHA_INDEX], 125, new Color(164, 164, 140, 125));</span>
<span class="line-removed">295 setAndCheckSpinner(spinners[CMYK_MAGENTA_INDEX], 25, new Color(164, 184, 140, 125));</span>
<span class="line-removed">296 setAndCheckSpinner(spinners[CMYK_YELLOW_INDEX], 40, new Color(164, 184, 172, 125));</span>
<span class="line-removed">297 setAndCheckSpinner(spinners[CMYK_CYAN_INDEX], 25, new Color(184, 184, 172, 125));</span>
<span class="line-removed">298 setAndCheckSpinner(spinners[CMYK_BLACK_INDEX], 100, new Color(139, 139, 130, 125));</span>
<span class="line-removed">299 setAndCheckSpinner(spinners[CMYK_ALPHA_INDEX], 255, new Color(139, 139, 130, 255));</span>
<span class="line-removed">300 }</span>
<span class="line-removed">301 </span>
<span class="line-removed">302 private void setAndCheckSlider(JSliderOperator slider, int sliderValue, Color expectedColor) {</span>
<span class="line-removed">303 slider.setValue(sliderValue);</span>
<span class="line-removed">304 // Wait for slider to attain the specified value</span>
<span class="line-removed">305 slider.waitStateOnQueue(jSlider -&gt; slider.getValue() == sliderValue);</span>
<span class="line-removed">306 colorChooser.waitStateOnQueue(jColorChooser -&gt; (colorChooser.getColor().equals(expectedColor)));</span>
<span class="line-removed">307 }</span>
<span class="line-removed">308 </span>
<span class="line-removed">309 private void setAndCheckSpinner(JSpinnerOperator spinner, int spinnerValue, Color expectedColor) {</span>
<span class="line-removed">310 spinner.setValue(spinnerValue);</span>
<span class="line-removed">311 // Wait for spinner to attain the specified value</span>
<span class="line-removed">312 spinner.waitStateOnQueue(jSpinner -&gt; (int) spinner.getValue() == spinnerValue);</span>
<span class="line-removed">313 colorChooser.waitStateOnQueue(jColorChooser -&gt; (colorChooser.getColor().equals(expectedColor)));</span>
<span class="line-removed">314 }</span>
<span class="line-removed">315 </span>
<span class="line-removed">316 private void initializeSliderAndSpinner(int numberOfSlidersAndSpinners) {</span>
<span class="line-removed">317 for (int i = 0; i &lt; numberOfSlidersAndSpinners; i++) {</span>
<span class="line-removed">318 sliders[i] = new JSliderOperator(colorChooserDialog, i);</span>
<span class="line-removed">319 spinners[i] = new JSpinnerOperator(colorChooserDialog, i);</span>
<span class="line-removed">320 }</span>
<span class="line-removed">321 }</span>
<span class="line-removed">322 </span>
<span class="line-removed">323 private void pushButtonAndWaitDialogClosed(JButtonOperator button) {</span>
<span class="line-removed">324 button.push();</span>
<span class="line-removed">325 // Wait for the color chooser dialog to close.</span>
<span class="line-removed">326 colorChooserDialog.waitClosed();</span>
<span class="line-removed">327 }</span>
<span class="line-removed">328 }</span>
</pre>
</td>
<td>
<hr />
<pre>
 51 import com.sun.swingset3.demos.colorchooser.BezierAnimationPanel.BezierColor;
 52 import com.sun.swingset3.demos.colorchooser.ColorChooserDemo;
 53 
 54 /*
 55 * @test
 56 * @key headful
 57 * @summary Verifies SwingSet3 ColorChooserDemo by performing simple interaction
 58 *  with all the controls that are shown in the ColorChooserDialog.
 59 *
 60 * @library /sanity/client/lib/jemmy/src
 61 * @library /sanity/client/lib/Extensions/src
 62 * @library /sanity/client/lib/SwingSet3/src
 63 * @modules java.desktop
 64 *          java.logging
 65 * @build com.sun.swingset3.demos.colorchooser.ColorChooserDemo
 66 * @run testng ColorChooserDemoTest
 67 */
 68 @Listeners(GuiTestListener.class)
 69 public class ColorChooserDemoTest {
 70 
<span class="line-modified"> 71     private static final String OK_BUTTON_TITLE = &quot;OK&quot;;</span>
<span class="line-modified"> 72     private static final String CANCEL_BUTTON_TITLE = &quot;Cancel&quot;;</span>
<span class="line-modified"> 73     private static final String RESET_BUTTON_TITLE = &quot;Reset&quot;;</span>
<span class="line-modified"> 74     private static final String HSV = &quot;HSV&quot;;</span>
<span class="line-modified"> 75     private static final String RGB = &quot;RGB&quot;;</span>
<span class="line-modified"> 76     private static final String HSL = &quot;HSL&quot;;</span>
<span class="line-modified"> 77     private static final String CMYK = &quot;CMYK&quot;;</span>
<span class="line-modified"> 78     private static final int HSV_NUMBER_OF_SLIDERS_AND_SPINNERS = 4;</span>
<span class="line-modified"> 79     private static final int RGB_NUMBER_OF_SLIDERS_AND_SPINNERS = 4;</span>
<span class="line-modified"> 80     private static final int HSL_NUMBER_OF_SLIDERS_AND_SPINNERS = 4;</span>
<span class="line-modified"> 81     private static final int CMYK_NUMBER_OF_SLIDERS_AND_SPINNERS = 5;</span>
<span class="line-modified"> 82     private static final int HSV_HUE_INDEX = 0;</span>
<span class="line-modified"> 83     private static final int HSV_SATURATION_INDEX = 1;</span>
<span class="line-modified"> 84     private static final int HSV_VALUE_INDEX = 2;</span>
<span class="line-modified"> 85     private static final int HSV_TRANSPARENCY_INDEX = 3;</span>
<span class="line-modified"> 86     private static final int HSL_HUE_INDEX = 0;</span>
<span class="line-modified"> 87     private static final int HSL_SATURATION_INDEX = 1;</span>
<span class="line-modified"> 88     private static final int HSL_LIGHTNESS_INDEX = 2;</span>
<span class="line-modified"> 89     private static final int HSL_TRANSPARENCY_INDEX = 3;</span>
<span class="line-modified"> 90     private static final int RGB_RED_INDEX = 0;</span>
<span class="line-modified"> 91     private static final int RGB_GREEN_INDEX = 1;</span>
<span class="line-modified"> 92     private static final int RGB_BLUE_INDEX = 2;</span>
<span class="line-modified"> 93     private static final int RGB_ALPHA_INDEX = 3;</span>
<span class="line-modified"> 94     private static final int RGB_COLORCODE_TEXT_FIELD_INDEX = 4;</span>
<span class="line-modified"> 95     private static final int CMYK_CYAN_INDEX = 0;</span>
<span class="line-modified"> 96     private static final int CMYK_MAGENTA_INDEX = 1;</span>
<span class="line-modified"> 97     private static final int CMYK_YELLOW_INDEX = 2;</span>
<span class="line-modified"> 98     private static final int CMYK_BLACK_INDEX = 3;</span>
<span class="line-modified"> 99     private static final int CMYK_ALPHA_INDEX = 4;</span>
<span class="line-modified">100 </span>
<span class="line-modified">101     private final Color resetColor = new Color(125, 125, 125);</span>
<span class="line-modified">102 </span>
<span class="line-modified">103     private JDialogOperator colorChooserDialog;</span>
<span class="line-modified">104     private JButtonOperator okButton;</span>
<span class="line-modified">105     private JButtonOperator cancelButton;</span>
<span class="line-modified">106     private JButtonOperator resetButton;</span>
<span class="line-modified">107     private JColorChooserOperator colorChooser;</span>
<span class="line-modified">108     private JButtonOperator backgroundButton;</span>
<span class="line-modified">109     private JButtonOperator gradient1Button;</span>
<span class="line-modified">110     private JButtonOperator gradient2Button;</span>
<span class="line-modified">111     private JButtonOperator perimeterButton;</span>
<span class="line-modified">112     private JTabbedPaneOperator tabOperator;</span>
<span class="line-modified">113     private JComponentOperator bezierAnimationPanel;</span>
<span class="line-modified">114     private JSliderOperator[] sliders = new JSliderOperator[5];</span>
<span class="line-modified">115     private JSpinnerOperator[] spinners = new JSpinnerOperator[5];</span>
<span class="line-modified">116     private JButtonOperator lastFocusedButton;</span>
<span class="line-modified">117 </span>
<span class="line-modified">118     @Test</span>
<span class="line-modified">119     public void test() throws Exception {</span>
<span class="line-modified">120         new ClassReference(ColorChooserDemo.class.getCanonicalName()).startApplication();</span>
<span class="line-modified">121         JFrameOperator frame = new JFrameOperator(DEMO_TITLE);</span>
<span class="line-modified">122         bezierAnimationPanel = new JComponentOperator(frame, new ByClassChooser(BezierAnimationPanel.class));</span>
<span class="line-modified">123         initializePanelButtons(frame);</span>
<span class="line-modified">124         checkBackgroundColorChooser();</span>
<span class="line-modified">125         checkGradient1ColorChooser();</span>
<span class="line-modified">126         checkGradient2ColorChooser();</span>
<span class="line-modified">127         checkPerimeterColorChooser();</span>
<span class="line-added">128     }</span>
<span class="line-added">129 </span>
<span class="line-added">130     private void checkBackgroundColorChooser() throws Exception {</span>
<span class="line-added">131         basicCheck(backgroundButton, BezierColor.BACKGROUND);</span>
<span class="line-added">132         checkAllColorChoosers(backgroundButton);</span>
<span class="line-added">133     }</span>
<span class="line-added">134 </span>
<span class="line-added">135     private void checkGradient1ColorChooser() throws Exception {</span>
<span class="line-added">136         basicCheck(gradient1Button, BezierColor.GRADIENT_A);</span>
<span class="line-added">137     }</span>
<span class="line-added">138 </span>
<span class="line-added">139     private void checkGradient2ColorChooser() throws Exception {</span>
<span class="line-added">140         basicCheck(gradient2Button, BezierColor.GRADIENT_B);</span>
<span class="line-added">141     }</span>
<span class="line-added">142 </span>
<span class="line-added">143     private void checkPerimeterColorChooser() throws Exception {</span>
<span class="line-added">144         basicCheck(perimeterButton, BezierColor.OUTER);</span>
<span class="line-added">145     }</span>
<span class="line-added">146 </span>
<span class="line-added">147     private void pushButtonAndInitialize(JButtonOperator jbo) throws InterruptedException {</span>
<span class="line-added">148         // Wait for focus to return to last focused button</span>
<span class="line-added">149         lastFocusedButton.waitHasFocus();</span>
<span class="line-added">150         jbo.pushNoBlock();</span>
<span class="line-added">151         lastFocusedButton = jbo;</span>
<span class="line-added">152         // Wait till the ColorChooserDemo Dialog Opens</span>
<span class="line-added">153         new DialogWaiter().waitDialog(CHOOSER_TITLE, false, false);</span>
<span class="line-added">154         initializeDialog();</span>
<span class="line-added">155     }</span>
<span class="line-added">156 </span>
<span class="line-added">157     private void initializePanelButtons(JFrameOperator frame) {</span>
<span class="line-added">158         backgroundButton = new JButtonOperator(frame, BACKGROUND);</span>
<span class="line-added">159         gradient1Button = new JButtonOperator(frame, GRADIENT_1);</span>
<span class="line-added">160         gradient2Button = new JButtonOperator(frame, GRADIENT_2);</span>
<span class="line-added">161         perimeterButton = new JButtonOperator(frame, PERIMETER);</span>
<span class="line-added">162         lastFocusedButton = backgroundButton;</span>
<span class="line-added">163     }</span>
<span class="line-added">164 </span>
<span class="line-added">165     private void initializeDialog() {</span>
<span class="line-added">166         colorChooserDialog = new JDialogOperator(CHOOSER_TITLE);</span>
<span class="line-added">167         tabOperator = new JTabbedPaneOperator(colorChooserDialog);</span>
<span class="line-added">168         colorChooser = new JColorChooserOperator(colorChooserDialog);</span>
<span class="line-added">169         okButton = new JButtonOperator(colorChooserDialog, OK_BUTTON_TITLE);</span>
<span class="line-added">170         cancelButton = new JButtonOperator(colorChooserDialog, CANCEL_BUTTON_TITLE);</span>
<span class="line-added">171         resetButton = new JButtonOperator(colorChooserDialog, RESET_BUTTON_TITLE);</span>
<span class="line-added">172     }</span>
<span class="line-added">173 </span>
<span class="line-added">174     private void basicCheck(JButtonOperator jbo, BezierColor bezierColor) throws Exception {</span>
<span class="line-added">175         Color testColor = new Color(100, 26, 155);</span>
<span class="line-added">176         Color testColor2 = new Color(10, 40, 50);</span>
<span class="line-added">177         checkDefaultColorChooser(jbo, testColor, bezierColor);</span>
<span class="line-added">178         checkCancelButton(jbo, testColor2);</span>
<span class="line-added">179         checkResetButton(jbo, testColor2);</span>
<span class="line-added">180     }</span>
<span class="line-added">181 </span>
<span class="line-added">182     private void checkDefaultColorChooser(JButtonOperator jbo, Color testColor, BezierColor bezierColor)</span>
<span class="line-added">183             throws Exception {</span>
<span class="line-added">184         BezierAnimationPanel bezierPanel;</span>
<span class="line-added">185         pushButtonAndInitialize(jbo);</span>
<span class="line-added">186         // Check ColorChooser color is being set and used accordingly</span>
<span class="line-added">187         // in the animation panel</span>
<span class="line-added">188         setAndWaitColor(testColor);</span>
<span class="line-added">189         pushButtonAndWaitDialogClosed(okButton);</span>
<span class="line-added">190         bezierPanel = (BezierAnimationPanel) bezierAnimationPanel.getSource();</span>
<span class="line-added">191         colorChooser.waitStateOnQueue(jColorChooser -&gt; (bezierPanel.getBezierColor(bezierColor).equals(testColor)));</span>
<span class="line-added">192     }</span>
<span class="line-added">193 </span>
<span class="line-added">194     private void checkCancelButton(JButtonOperator jbo, Color testColor) throws Exception {</span>
<span class="line-added">195         pushButtonAndInitialize(jbo);</span>
<span class="line-added">196         setAndWaitColor(testColor);</span>
<span class="line-added">197         pushButtonAndWaitDialogClosed(cancelButton);</span>
<span class="line-added">198     }</span>
<span class="line-added">199 </span>
<span class="line-added">200     private void checkResetButton(JButtonOperator jbo, Color testColor) throws Exception {</span>
<span class="line-added">201         pushButtonAndInitialize(jbo);</span>
<span class="line-added">202         Color initialColor = colorChooser.getColor();</span>
<span class="line-added">203         setAndWaitColor(testColor);</span>
<span class="line-added">204         resetButton.push();</span>
<span class="line-added">205         waitJColorChooserColor(initialColor);</span>
<span class="line-added">206         pushButtonAndWaitDialogClosed(okButton);</span>
<span class="line-added">207     }</span>
<span class="line-added">208 </span>
<span class="line-added">209     private void checkAllColorChoosers(JButtonOperator jbo) throws Exception {</span>
<span class="line-added">210         pushButtonAndInitialize(jbo);</span>
<span class="line-added">211         checkHSV();</span>
<span class="line-added">212         checkHSL();</span>
<span class="line-added">213         checkRGB();</span>
<span class="line-added">214         checkCMYK();</span>
<span class="line-added">215         pushButtonAndWaitDialogClosed(okButton);</span>
<span class="line-added">216     }</span>
<span class="line-added">217 </span>
<span class="line-added">218     private void waitJColorChooserColor(Color expectedColor) {</span>
<span class="line-added">219         colorChooser.waitStateOnQueue(jColorChooser -&gt; colorChooser.getColor().equals(expectedColor));</span>
<span class="line-added">220     }</span>
<span class="line-added">221 </span>
<span class="line-added">222     private void setAndWaitColor(Color color) {</span>
<span class="line-added">223         colorChooser.setColor(color);</span>
<span class="line-added">224         // Wait for the Color to be set</span>
<span class="line-added">225         waitJColorChooserColor(color);</span>
<span class="line-added">226     }</span>
<span class="line-added">227 </span>
<span class="line-added">228     private void resetColor() {</span>
<span class="line-added">229         colorChooser.setColor(resetColor);</span>
<span class="line-added">230         // Wait for the Color to be reset</span>
<span class="line-added">231         waitJColorChooserColor(resetColor);</span>
<span class="line-added">232     }</span>
<span class="line-added">233 </span>
<span class="line-added">234     private void checkHSV() {</span>
<span class="line-added">235         tabOperator.selectPage(HSV);</span>
<span class="line-added">236         initializeSliderAndSpinner(HSV_NUMBER_OF_SLIDERS_AND_SPINNERS);</span>
<span class="line-added">237         resetColor();</span>
<span class="line-added">238         setAndCheckSlider(sliders[HSV_SATURATION_INDEX], 50, new Color(125, 62, 62));</span>
<span class="line-added">239         setAndCheckSlider(sliders[HSV_VALUE_INDEX], 80, new Color(204, 102, 102));</span>
<span class="line-added">240         setAndCheckSlider(sliders[HSV_HUE_INDEX], 50, new Color(204, 187, 102));</span>
<span class="line-added">241         setAndCheckSlider(sliders[HSV_TRANSPARENCY_INDEX], 50, new Color(204, 187, 102, 127));</span>
<span class="line-added">242         setAndCheckSpinner(spinners[HSV_SATURATION_INDEX], 25, new Color(204, 195, 153, 127));</span>
<span class="line-added">243         setAndCheckSpinner(spinners[HSV_VALUE_INDEX], 40, new Color(102, 97, 76, 127));</span>
<span class="line-added">244         setAndCheckSpinner(spinners[HSV_HUE_INDEX], 25, new Color(102, 87, 76, 127));</span>
<span class="line-added">245         setAndCheckSpinner(spinners[HSV_TRANSPARENCY_INDEX], 100, new Color(102, 87, 76, 0));</span>
<span class="line-added">246     }</span>
<span class="line-added">247 </span>
<span class="line-added">248     private void checkHSL() {</span>
<span class="line-added">249         tabOperator.selectPage(HSL);</span>
<span class="line-added">250         initializeSliderAndSpinner(HSL_NUMBER_OF_SLIDERS_AND_SPINNERS);</span>
<span class="line-added">251         resetColor();</span>
<span class="line-added">252         setAndCheckSlider(sliders[HSL_SATURATION_INDEX], 50, new Color(187, 62, 62));</span>
<span class="line-added">253         setAndCheckSlider(sliders[HSL_LIGHTNESS_INDEX], 80, new Color(229, 178, 178));</span>
<span class="line-added">254         setAndCheckSlider(sliders[HSL_HUE_INDEX], 180, new Color(178, 229, 229));</span>
<span class="line-added">255         setAndCheckSlider(sliders[HSL_TRANSPARENCY_INDEX], 50, new Color(178, 229, 229, 127));</span>
<span class="line-added">256         setAndCheckSpinner(spinners[HSL_SATURATION_INDEX], 25, new Color(191, 216, 216, 127));</span>
<span class="line-added">257         setAndCheckSpinner(spinners[HSL_LIGHTNESS_INDEX], 40, new Color(76, 127, 127, 127));</span>
<span class="line-added">258         setAndCheckSpinner(spinners[HSL_HUE_INDEX], 25, new Color(127, 97, 76, 127));</span>
<span class="line-added">259         setAndCheckSpinner(spinners[HSL_TRANSPARENCY_INDEX], 50, new Color(127, 97, 76, 127));</span>
<span class="line-added">260     }</span>
<span class="line-added">261 </span>
<span class="line-added">262     private void checkRGB() {</span>
<span class="line-added">263         String sampleColor = &quot;111111&quot;;</span>
<span class="line-added">264         tabOperator.selectPage(RGB);</span>
<span class="line-added">265         initializeSliderAndSpinner(RGB_NUMBER_OF_SLIDERS_AND_SPINNERS);</span>
<span class="line-added">266         JTextFieldOperator colorCode = new JTextFieldOperator(colorChooserDialog, RGB_COLORCODE_TEXT_FIELD_INDEX);</span>
<span class="line-added">267         resetColor();</span>
<span class="line-added">268         setAndCheckSlider(sliders[RGB_GREEN_INDEX], 50, new Color(125, 50, 125, 255));</span>
<span class="line-added">269         setAndCheckSlider(sliders[RGB_BLUE_INDEX], 80, new Color(125, 50, 80, 255));</span>
<span class="line-added">270         setAndCheckSlider(sliders[RGB_RED_INDEX], 50, new Color(50, 50, 80, 255));</span>
<span class="line-added">271         setAndCheckSlider(sliders[RGB_ALPHA_INDEX], 125, new Color(50, 50, 80, 125));</span>
<span class="line-added">272         setAndCheckSpinner(spinners[RGB_GREEN_INDEX], 25, new Color(50, 25, 80, 125));</span>
<span class="line-added">273         setAndCheckSpinner(spinners[RGB_BLUE_INDEX], 40, new Color(50, 25, 40, 125));</span>
<span class="line-added">274         setAndCheckSpinner(spinners[RGB_RED_INDEX], 25, new Color(25, 25, 40, 125));</span>
<span class="line-added">275         setAndCheckSpinner(spinners[RGB_ALPHA_INDEX], 255, new Color(25, 25, 40, 255));</span>
<span class="line-added">276 </span>
<span class="line-added">277         colorCode.setText(sampleColor);</span>
<span class="line-added">278         // Wait for the sampleColor to be set in the color code text field.</span>
<span class="line-added">279         colorCode.waitText(sampleColor);</span>
<span class="line-added">280         colorCode.getFocus();</span>
<span class="line-added">281         colorCode.pressKey(KeyEvent.VK_TAB);</span>
<span class="line-added">282         // Wait for the color to be set</span>
<span class="line-added">283         waitJColorChooserColor(new Color(17, 17, 17, 255));</span>
<span class="line-added">284     }</span>
<span class="line-added">285 </span>
<span class="line-added">286     private void checkCMYK() {</span>
<span class="line-added">287         tabOperator.selectPage(CMYK);</span>
<span class="line-added">288         initializeSliderAndSpinner(CMYK_NUMBER_OF_SLIDERS_AND_SPINNERS);</span>
<span class="line-added">289         resetColor();</span>
<span class="line-added">290         setAndCheckSlider(sliders[CMYK_MAGENTA_INDEX], 50, new Color(125, 100, 125, 255));</span>
<span class="line-added">291         setAndCheckSlider(sliders[CMYK_YELLOW_INDEX], 80, new Color(125, 100, 85, 255));</span>
<span class="line-added">292         setAndCheckSlider(sliders[CMYK_CYAN_INDEX], 50, new Color(100, 100, 85, 255));</span>
<span class="line-added">293         setAndCheckSlider(sliders[CMYK_BLACK_INDEX], 50, new Color(164, 164, 140, 255));</span>
<span class="line-added">294         setAndCheckSlider(sliders[CMYK_ALPHA_INDEX], 125, new Color(164, 164, 140, 125));</span>
<span class="line-added">295         setAndCheckSpinner(spinners[CMYK_MAGENTA_INDEX], 25, new Color(164, 184, 140, 125));</span>
<span class="line-added">296         setAndCheckSpinner(spinners[CMYK_YELLOW_INDEX], 40, new Color(164, 184, 172, 125));</span>
<span class="line-added">297         setAndCheckSpinner(spinners[CMYK_CYAN_INDEX], 25, new Color(184, 184, 172, 125));</span>
<span class="line-added">298         setAndCheckSpinner(spinners[CMYK_BLACK_INDEX], 100, new Color(139, 139, 130, 125));</span>
<span class="line-added">299         setAndCheckSpinner(spinners[CMYK_ALPHA_INDEX], 255, new Color(139, 139, 130, 255));</span>
<span class="line-added">300     }</span>
<span class="line-added">301 </span>
<span class="line-added">302     private void setAndCheckSlider(JSliderOperator slider, int sliderValue, Color expectedColor) {</span>
<span class="line-added">303         slider.setValue(sliderValue);</span>
<span class="line-added">304         // Wait for slider to attain the specified value</span>
<span class="line-added">305         slider.waitStateOnQueue(jSlider -&gt; slider.getValue() == sliderValue);</span>
<span class="line-added">306         colorChooser.waitStateOnQueue(jColorChooser -&gt; (colorChooser.getColor().equals(expectedColor)));</span>
<span class="line-added">307     }</span>
<span class="line-added">308 </span>
<span class="line-added">309     private void setAndCheckSpinner(JSpinnerOperator spinner, int spinnerValue, Color expectedColor) {</span>
<span class="line-added">310         spinner.setValue(spinnerValue);</span>
<span class="line-added">311         // Wait for spinner to attain the specified value</span>
<span class="line-added">312         spinner.waitStateOnQueue(jSpinner -&gt; (int) spinner.getValue() == spinnerValue);</span>
<span class="line-added">313         colorChooser.waitStateOnQueue(jColorChooser -&gt; (colorChooser.getColor().equals(expectedColor)));</span>
<span class="line-added">314     }</span>
<span class="line-added">315 </span>
<span class="line-added">316     private void initializeSliderAndSpinner(int numberOfSlidersAndSpinners) {</span>
<span class="line-added">317         for (int i = 0; i &lt; numberOfSlidersAndSpinners; i++) {</span>
<span class="line-added">318             sliders[i] = new JSliderOperator(colorChooserDialog, i);</span>
<span class="line-added">319             spinners[i] = new JSpinnerOperator(colorChooserDialog, i);</span>
<span class="line-added">320         }</span>
<span class="line-added">321     }</span>
<span class="line-added">322 </span>
<span class="line-added">323     private void pushButtonAndWaitDialogClosed(JButtonOperator button) {</span>
<span class="line-added">324         button.push();</span>
<span class="line-added">325         // Wait for the color chooser dialog to close.</span>
<span class="line-added">326         colorChooserDialog.waitClosed();</span>
<span class="line-added">327     }</span>
328 }
329 







































































































































































































</pre>
</td>
</tr>
</table>
<center><a href="ButtonDemoScreenshotTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="EditorPaneDemoTest.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>