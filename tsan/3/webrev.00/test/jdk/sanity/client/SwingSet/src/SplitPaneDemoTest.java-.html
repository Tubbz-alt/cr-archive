<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old test/jdk/sanity/client/SwingSet/src/SplitPaneDemoTest.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2010, 2018, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 import com.sun.swingset3.demos.splitpane.SplitPaneDemo;
 25 import static com.sun.swingset3.demos.splitpane.SplitPaneDemo.*;
 26 
 27 import java.awt.Component;
 28 import java.awt.event.KeyEvent;
 29 import javax.swing.JSplitPane;
 30 import javax.swing.UIManager;
 31 
 32 import static org.jemmy2ext.JemmyExt.*;
 33 
 34 import org.jtregext.GuiTestListener;
 35 
 36 import org.netbeans.jemmy.ClassReference;
 37 import org.netbeans.jemmy.ComponentChooser;
 38 import org.netbeans.jemmy.operators.JButtonOperator;
 39 import org.netbeans.jemmy.operators.JCheckBoxOperator;
 40 import org.netbeans.jemmy.operators.JFrameOperator;
 41 import org.netbeans.jemmy.operators.JRadioButtonOperator;
 42 import org.netbeans.jemmy.operators.JSplitPaneOperator;
 43 import org.netbeans.jemmy.operators.JTextFieldOperator;
 44 
 45 import org.testng.annotations.Listeners;
 46 import org.testng.annotations.Test;
 47 import static org.testng.AssertJUnit.*;
 48 
 49 /*
 50  * @test
 51  * @key headful
 52  * @summary Verifies SwingSet3 SplitPaneDemo by performing OneClick expansion,
 53  *          changing size of the divier, moving the divider to different positions
 54  *          and changing the divider orientation.
 55  *
 56  * @library /sanity/client/lib/jemmy/src
 57  * @library /sanity/client/lib/Extensions/src
 58  * @library /sanity/client/lib/SwingSet3/src
 59  * @modules java.desktop
 60  *          java.logging
 61  * @build org.jemmy2ext.JemmyExt
 62  * @build com.sun.swingset3.demos.splitpane.SplitPaneDemo
 63  * @run testng/timeout=600 SplitPaneDemoTest
 64  */
 65 @Listeners(GuiTestListener.class)
 66 public class SplitPaneDemoTest {
 67 
 68     @Test(dataProvider = &quot;availableLookAndFeels&quot;, dataProviderClass = TestHelpers.class)
 69     public void test(String lookAndFeel) throws Exception {
 70         UIManager.setLookAndFeel(lookAndFeel);
 71 
 72         new ClassReference(SplitPaneDemo.class.getCanonicalName()).startApplication();
 73 
 74         JFrameOperator frame = new JFrameOperator(DEMO_TITLE);
 75 
 76         JSplitPaneOperator splitPane = new JSplitPaneOperator(frame);
 77 
 78         // OneTouch feature is not available in GTK L&amp;F
 79         if(!&quot;GTK&quot;.equals(UIManager.getLookAndFeel().getID())) {
 80             // Toggle OneTouch Expandable
 81             checkOneTouch(frame, splitPane, true);
 82             checkOneTouch(frame, splitPane, false);
 83         }
 84 
 85         // Check changing divider size to minimum and maximum values
 86         changeDividerSize(frame, splitPane, 50);
 87         changeDividerSize(frame, splitPane, 6);
 88 
 89 
 90         // TODO Skipping this code for Motif L&amp;F as the fix for &quot;CODETOOLS-7902324&quot;
 91         // is deferred now
 92         if(!(&quot;Motif&quot;.equals(UIManager.getLookAndFeel().getID()))) {
 93             // Check moving the divider
 94             checkDividerMoves(frame, splitPane, false);
 95             checkDividerMoves(frame, splitPane, true);
 96 
 97             // Check different minumum Day/Night sizes
 98             changeMinimumSizes(frame, splitPane, 100);
 99             changeMinimumSizes(frame, splitPane, 0);
100         }
101     }
102 
103     // Check for different day and night minimum size
104     public void changeMinimumSizes(JFrameOperator frame, JSplitPaneOperator splitPane, int amount) throws Exception {
105         for (String label : new String[]{FIRST_COMPONENT_MIN_SIZE, SECOND_COMPONENT_MIN_SIZE}) {
106             JTextFieldOperator size = new JTextFieldOperator(getLabeledContainerOperator(frame, label));
107             size.enterText(Integer.toString(amount));
108             size.pressKey(KeyEvent.VK_ENTER);
109         }
110         checkDividerMoves(frame, splitPane, false);
111         checkDividerMoves(frame, splitPane, true);
112     }
113 
114     // Check moving of divider
115     public void checkDividerMoves(JFrameOperator frame, JSplitPaneOperator splitPane, boolean isVertical) throws Exception {
116         if (isVertical) {
117             new JRadioButtonOperator(frame, VERTICAL_SPLIT).doClick();
118         } else {
119             new JRadioButtonOperator(frame, HORIZONTAL_SPLIT).doClick();
120         }
121 
122         splitPane.moveDivider(0.0);
123         assertEquals(&quot;Move Minimum, dividerLocation is at minimumDividerLocation&quot;,
124                 splitPane.getMinimumDividerLocation(), splitPane.getDividerLocation());
125 
126         // use getMaximumDividerLocation() to move divider to here because using proportion 1.0 does not work
127         splitPane.moveDivider(1.0);
128 
129         assertEquals(&quot;Move Maximum, dividerLocation is at maximumDividerLocation&quot;,
130                 splitPane.getMaximumDividerLocation(), splitPane.getDividerLocation());
131 
132         splitPane.moveDivider(0.5);
133         assertEquals(&quot;Move Middle, dividerLocation is at the artithmetic average of minimum and maximum DividerLocations&quot;,
134                 (splitPane.getMaximumDividerLocation() + splitPane.getMinimumDividerLocation()) / 2, splitPane.getDividerLocation());
135     }
136 
137     private void waitDividerSize(JSplitPaneOperator splitPane, int size) {
138         splitPane.waitState(new ComponentChooser() {
139             public boolean checkComponent(Component c) {
140                 return splitPane.getDividerSize() == size;
141             }
142             public String getDescription() {
143                 return &quot;Divider size to be &quot; + size;
144             }
145         });
146     }
147 
148     // Check changing the size of the divider
149     public void changeDividerSize(JFrameOperator frame, JSplitPaneOperator splitPane, int amount) throws Exception {
150         JTextFieldOperator size = new JTextFieldOperator(getLabeledContainerOperator(frame, DIVIDER_SIZE));
151         size.enterText(Integer.toString(amount));
152         waitDividerSize(splitPane, amount);
153     }
154 
155     private void waitDividerLocation(JSplitPaneOperator splitPane, int location) {
156         splitPane.waitState(new ComponentChooser() {
157             public boolean checkComponent(Component c) {
158                 return splitPane.getDividerLocation() == location;
159             }
160             public String getDescription() {
161                 return &quot;Divider location to be &quot; + location;
162             }
163         });
164     }
165 
166     public void checkOneTouch(JFrameOperator frame, JSplitPaneOperator splitPane, boolean oneTouch) throws Exception {
167         JCheckBoxOperator checkBox = new JCheckBoxOperator(frame, ONE_TOUCH_EXPANDABLE);
168         JButtonOperator buttonLeft = new JButtonOperator(splitPane.getDivider(), 0);
169         JButtonOperator buttonRight = new JButtonOperator(splitPane.getDivider(), 1);
170         int initDividerLocation = splitPane.getDividerLocation();
171 
172         if (oneTouch) {
173             if (!checkBox.isSelected()) {
174                 // uncheck
175                 checkBox.doClick();
176             }
177 
178             int left = getUIValue(splitPane, (JSplitPane sp) -&gt; sp.getInsets().left);
179             System.out.println(&quot;left = &quot; + left);
180             int right = getUIValue(splitPane, (JSplitPane sp) -&gt; sp.getInsets().right);
181             System.out.println(&quot;right = &quot; + right);
182 
183             // expand full left
184             buttonLeft.push();
185             waitDividerLocation(splitPane, left);
186 
187             // expand back from full left
188             buttonRight.push();
189             waitDividerLocation(splitPane, initDividerLocation);
190 
191             // expand all the way right
192             buttonRight.push();
193             waitDividerLocation(splitPane, splitPane.getWidth() - splitPane.getDividerSize() - right);
194 
195             // Click to move back from right expansion
196             buttonLeft.push();
197             waitDividerLocation(splitPane, initDividerLocation);
198         }
199 
200         // Test for case where one touch expandable is disabled
201         if (!oneTouch) {
202             if (checkBox.isSelected()) {
203                 // uncheck
204                 checkBox.doClick();
205             }
206             splitPane.waitState(new ComponentChooser() {
207                 public boolean checkComponent(Component c) {
208                     return !splitPane.isOneTouchExpandable();
209                 }
210                 public String getDescription() {
211                     return &quot;Split pane not to be one touch expandable&quot;;
212                 }
213             });
214         }
215     }
216 
217 }
    </pre>
  </body>
</html>