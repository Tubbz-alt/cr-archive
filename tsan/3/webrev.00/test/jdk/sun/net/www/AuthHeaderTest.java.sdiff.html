<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/sun/net/www/AuthHeaderTest.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../idn/TestStringPrep.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="ftptest/FtpCommandHandler.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/sun/net/www/AuthHeaderTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 68             }
 69             count ++;
 70         } catch (IOException e) {
 71             e.printStackTrace();
 72         }
 73     }
 74 
 75     static void read (InputStream is) throws IOException {
 76         int c;
 77         System.out.println (&quot;reading&quot;);
 78         while ((c=is.read()) != -1) {
 79             System.out.write (c);
 80         }
 81         System.out.println (&quot;&quot;);
 82         System.out.println (&quot;finished reading&quot;);
 83     }
 84 
 85     static void client (String u) throws Exception {
 86         URL url = new URL (u);
 87         System.out.println (&quot;client opening connection to: &quot; + u);
<span class="line-modified"> 88         URLConnection urlc = url.openConnection ();</span>
 89         InputStream is = urlc.getInputStream ();
 90         read (is);
 91         is.close();
 92     }
 93 
 94     static TestHttpServer server;
 95 
 96     public static void main (String[] args) throws Exception {
 97         MyAuthenticator auth = new MyAuthenticator ();
 98         Authenticator.setDefault (auth);

 99         try {
<span class="line-modified">100             server = new TestHttpServer (new AuthHeaderTest(), 1, 10, 0);</span>
<span class="line-modified">101             System.out.println (&quot;Server: listening on port: &quot; + server.getLocalPort());</span>
<span class="line-modified">102             client (&quot;http://localhost:&quot;+server.getLocalPort()+&quot;/d1/foo.html&quot;);</span>
103         } catch (Exception e) {
104             if (server != null) {
105                 server.terminate();
106             }
107             throw e;
108         }
109         int f = auth.getCount();
110         if (f != 1) {
111             except (&quot;Authenticator was called &quot;+f+&quot; times. Should be 1&quot;);
112         }
113         server.terminate();
114     }
115 
116     public static void except (String s) {
117         server.terminate();
118         throw new RuntimeException (s);
119     }
120 
121     static class MyAuthenticator extends Authenticator {
122         MyAuthenticator () {
</pre>
</td>
<td>
<hr />
<pre>
 68             }
 69             count ++;
 70         } catch (IOException e) {
 71             e.printStackTrace();
 72         }
 73     }
 74 
 75     static void read (InputStream is) throws IOException {
 76         int c;
 77         System.out.println (&quot;reading&quot;);
 78         while ((c=is.read()) != -1) {
 79             System.out.write (c);
 80         }
 81         System.out.println (&quot;&quot;);
 82         System.out.println (&quot;finished reading&quot;);
 83     }
 84 
 85     static void client (String u) throws Exception {
 86         URL url = new URL (u);
 87         System.out.println (&quot;client opening connection to: &quot; + u);
<span class="line-modified"> 88         URLConnection urlc = url.openConnection (Proxy.NO_PROXY);</span>
 89         InputStream is = urlc.getInputStream ();
 90         read (is);
 91         is.close();
 92     }
 93 
 94     static TestHttpServer server;
 95 
 96     public static void main (String[] args) throws Exception {
 97         MyAuthenticator auth = new MyAuthenticator ();
 98         Authenticator.setDefault (auth);
<span class="line-added"> 99         InetAddress loopback = InetAddress.getLoopbackAddress();</span>
100         try {
<span class="line-modified">101             server = new TestHttpServer (new AuthHeaderTest(), 1, 10, loopback, 0);</span>
<span class="line-modified">102             System.out.println (&quot;Server: listening on port: &quot; + server.getAuthority());</span>
<span class="line-modified">103             client (&quot;http://&quot; + server.getAuthority() + &quot;/d1/foo.html&quot;);</span>
104         } catch (Exception e) {
105             if (server != null) {
106                 server.terminate();
107             }
108             throw e;
109         }
110         int f = auth.getCount();
111         if (f != 1) {
112             except (&quot;Authenticator was called &quot;+f+&quot; times. Should be 1&quot;);
113         }
114         server.terminate();
115     }
116 
117     public static void except (String s) {
118         server.terminate();
119         throw new RuntimeException (s);
120     }
121 
122     static class MyAuthenticator extends Authenticator {
123         MyAuthenticator () {
</pre>
</td>
</tr>
</table>
<center><a href="../idn/TestStringPrep.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="ftptest/FtpCommandHandler.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>