<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/sun/net/www/protocol/https/NewImpl/JavaxHostnameVerifier.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="JavaxHTTPSConnection.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../TestHttpsServer.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/sun/net/www/protocol/https/NewImpl/JavaxHostnameVerifier.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2001, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
</pre>
<hr />
<pre>
118      * @return the bytes for the file
119      * @exception FileNotFoundException if the file corresponding
120      * to &lt;b&gt;path&lt;/b&gt; could not be loaded.
121      */
122     private byte[] getBytes(String path)
123         throws IOException
124     {
125         return &quot;Hello world, I am here&quot;.getBytes();
126     }
127 
128     /*
129      * Define the server side of the test.
130      *
131      * If the server prematurely exits, serverReady will be set to true
132      * to avoid infinite hangs.
133      */
134     void doServerSide() throws Exception {
135 
136         SSLServerSocketFactory sslssf =
137           (SSLServerSocketFactory) SSLServerSocketFactory.getDefault();





138         SSLServerSocket sslServerSocket =
<span class="line-modified">139             (SSLServerSocket) sslssf.createServerSocket(serverPort);</span>

140         serverPort = sslServerSocket.getLocalPort();
141 
142         String ciphers[]= { &quot;SSL_DH_anon_WITH_3DES_EDE_CBC_SHA&quot; };
143         sslServerSocket.setEnabledCipherSuites(ciphers);
144 
145         /*
146          * Signal Client, we&#39;re ready for his connect.
147          */
148         serverReady = true;
149 
150         SSLSocket sslSocket = (SSLSocket) sslServerSocket.accept();
151         DataOutputStream out =
152                 new DataOutputStream(sslSocket.getOutputStream());
153 
154         try {
155              // get path to class file from header
156              DataInputStream in =
157                         new DataInputStream(sslSocket.getInputStream());
158              String path = getPath(in);
159              // retrieve bytecodes
</pre>
<hr />
<pre>
188      * Define the client side of the test.
189      *
190      * If the server prematurely exits, serverReady will be set to true
191      * to avoid infinite hangs.
192      */
193     void doClientSide() throws Exception {
194         /*
195          * Wait for server to get started.
196          */
197         while (!serverReady) {
198             Thread.sleep(50);
199         }
200 
201         System.setProperty(&quot;https.cipherSuites&quot;,
202                 &quot;SSL_DH_anon_WITH_3DES_EDE_CBC_SHA&quot;);
203 
204         // use the default hostname verifier
205 
206         URL url = new URL(&quot;https://&quot; + &quot;localhost:&quot; + serverPort +
207                                 &quot;/etc/hosts&quot;);
<span class="line-modified">208         URLConnection urlc = url.openConnection();</span>
209 
210         if (!(urlc instanceof javax.net.ssl.HttpsURLConnection)) {
211             throw new Exception(
212                 &quot;URLConnection ! instanceof javax.net.ssl.HttpsURLConnection&quot;);
213         }
214 
215         BufferedReader in = null;
216         try {
217             in = new BufferedReader(new InputStreamReader(
218                                urlc.getInputStream()));
219             String inputLine;
220             System.out.print(&quot;Client reading... &quot;);
221             while ((inputLine = in.readLine()) != null)
222                 System.out.println(inputLine);
223             System.out.println(&quot;Cipher Suite: &quot; +
224                 ((HttpsURLConnection)urlc).getCipherSuite());
225             in.close();
226         } catch (SSLException e) {
227             if (in != null)
228                 in.close();
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2001, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
</pre>
<hr />
<pre>
118      * @return the bytes for the file
119      * @exception FileNotFoundException if the file corresponding
120      * to &lt;b&gt;path&lt;/b&gt; could not be loaded.
121      */
122     private byte[] getBytes(String path)
123         throws IOException
124     {
125         return &quot;Hello world, I am here&quot;.getBytes();
126     }
127 
128     /*
129      * Define the server side of the test.
130      *
131      * If the server prematurely exits, serverReady will be set to true
132      * to avoid infinite hangs.
133      */
134     void doServerSide() throws Exception {
135 
136         SSLServerSocketFactory sslssf =
137           (SSLServerSocketFactory) SSLServerSocketFactory.getDefault();
<span class="line-added">138 </span>
<span class="line-added">139         // doClientSide() connects to &quot;localhost&quot;</span>
<span class="line-added">140         InetAddress localHost = InetAddress.getByName(&quot;localhost&quot;);</span>
<span class="line-added">141         InetSocketAddress address = new InetSocketAddress(localHost, serverPort);</span>
<span class="line-added">142 </span>
143         SSLServerSocket sslServerSocket =
<span class="line-modified">144             (SSLServerSocket) sslssf.createServerSocket();</span>
<span class="line-added">145         sslServerSocket.bind(address);</span>
146         serverPort = sslServerSocket.getLocalPort();
147 
148         String ciphers[]= { &quot;SSL_DH_anon_WITH_3DES_EDE_CBC_SHA&quot; };
149         sslServerSocket.setEnabledCipherSuites(ciphers);
150 
151         /*
152          * Signal Client, we&#39;re ready for his connect.
153          */
154         serverReady = true;
155 
156         SSLSocket sslSocket = (SSLSocket) sslServerSocket.accept();
157         DataOutputStream out =
158                 new DataOutputStream(sslSocket.getOutputStream());
159 
160         try {
161              // get path to class file from header
162              DataInputStream in =
163                         new DataInputStream(sslSocket.getInputStream());
164              String path = getPath(in);
165              // retrieve bytecodes
</pre>
<hr />
<pre>
194      * Define the client side of the test.
195      *
196      * If the server prematurely exits, serverReady will be set to true
197      * to avoid infinite hangs.
198      */
199     void doClientSide() throws Exception {
200         /*
201          * Wait for server to get started.
202          */
203         while (!serverReady) {
204             Thread.sleep(50);
205         }
206 
207         System.setProperty(&quot;https.cipherSuites&quot;,
208                 &quot;SSL_DH_anon_WITH_3DES_EDE_CBC_SHA&quot;);
209 
210         // use the default hostname verifier
211 
212         URL url = new URL(&quot;https://&quot; + &quot;localhost:&quot; + serverPort +
213                                 &quot;/etc/hosts&quot;);
<span class="line-modified">214         URLConnection urlc = url.openConnection(Proxy.NO_PROXY);</span>
215 
216         if (!(urlc instanceof javax.net.ssl.HttpsURLConnection)) {
217             throw new Exception(
218                 &quot;URLConnection ! instanceof javax.net.ssl.HttpsURLConnection&quot;);
219         }
220 
221         BufferedReader in = null;
222         try {
223             in = new BufferedReader(new InputStreamReader(
224                                urlc.getInputStream()));
225             String inputLine;
226             System.out.print(&quot;Client reading... &quot;);
227             while ((inputLine = in.readLine()) != null)
228                 System.out.println(inputLine);
229             System.out.println(&quot;Cipher Suite: &quot; +
230                 ((HttpsURLConnection)urlc).getCipherSuite());
231             in.close();
232         } catch (SSLException e) {
233             if (in != null)
234                 in.close();
</pre>
</td>
</tr>
</table>
<center><a href="JavaxHTTPSConnection.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../TestHttpsServer.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>