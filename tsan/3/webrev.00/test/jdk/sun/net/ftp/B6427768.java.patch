diff a/test/jdk/sun/net/ftp/B6427768.java b/test/jdk/sun/net/ftp/B6427768.java
--- a/test/jdk/sun/net/ftp/B6427768.java
+++ b/test/jdk/sun/net/ftp/B6427768.java
@@ -1,7 +1,7 @@
 /*
- * Copyright (c) 2006, Oracle and/or its affiliates. All rights reserved.
+ * Copyright (c) 2006, 2019, Oracle and/or its affiliates. All rights reserved.
  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  *
  * This code is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License version 2 only, as
  * published by the Free Software Foundation.
@@ -103,17 +103,18 @@
             return false;
         }
     }
 
     public static void main(String[] args) throws IOException {
-        FtpServer server = new FtpServer(0);
+        InetAddress loopback = InetAddress.getLoopbackAddress();
+        FtpServer server = new FtpServer(loopback, 0);
         int port = server.getLocalPort();
         server.setFileSystemHandler(new MyFileSystemHandler("/"));
         server.setAuthHandler(new MyAuthHandler());
         server.start();
-        URL url = new URL("ftp://user:passwd@localhost:" + port + "/foo.txt");
-        URLConnection con = url.openConnection();
+        URL url = new URL("ftp://user:passwd@" + server.getAuthority() + "/foo.txt");
+        URLConnection con = url.openConnection(Proxy.NO_PROXY);
         // triggers the connection
         try {
             con.getInputStream();
         } catch(sun.net.ftp.FtpLoginException e) {
             // Give some time to the client thread to properly terminate.
