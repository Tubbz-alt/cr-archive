<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames test/jdk/sun/security/tools/jarsigner/compatibility/README</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre><a name="1" id="anc1"></a><span class="line-modified">  1 # Copyright (c) 2017, Oracle and/or its affiliates. All rights reserved.</span>
  2 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  3 #
  4 # This code is free software; you can redistribute it and/or modify it
  5 # under the terms of the GNU General Public License version 2 only, as
  6 # published by the Free Software Foundation.
  7 #
  8 # This code is distributed in the hope that it will be useful, but WITHOUT
  9 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 10 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 11 # version 2 for more details (a copy is included in the LICENSE file that
 12 # accompanied this code).
 13 #
 14 # You should have received a copy of the GNU General Public License version
 15 # 2 along with this work; if not, write to the Free Software Foundation,
 16 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 17 #
 18 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 19 # or visit www.oracle.com if you need additional information or have any
 20 # questions.
 21 
 22 ##### Summary #####
 23 This test is used to verify the compatibility on jarsigner cross different JDK
 24 releases. It also can be used to check jar signing (w/ and w/o TSA) and verifying
 25 on some specific key algorithms and digest algorithms.
 26 
 27 ##### Output #####
 28 The test will generate a report, at JTwork/scratch/report.html, to display the
 29 key parameters for signing and the status of signing and verifying. And it will
 30 generate another report, at JTwork/scratch/failedReport.html, to collect all of
 31 failed cases.
 32 
 33 Please note that, the test may output a great deal of logs if the jdk list and
 34 TSA list are big, and that would lead to jtreg output overflow. So, it redirects
 35 stdout and stderr to file JTwork/scratch/details.out.
 36 
 37 ##### Report Columns #####
<a name="2" id="anc2"></a>



 38 Certificate
 39     Certificate identifier. The identifier consists of specific attributes of
 40     the certificate. Generally, the naming convention is:
 41     KeyAlgorithm_DigestAlgorithm_[KeySize][_Expired]
 42 
 43 Signer JDK
 44     The JDK version that signs jar.
 45 
 46 Signature Algorithm
<a name="3" id="anc3"></a><span class="line-modified"> 47     The signature algorithm used by signing.</span>











 48 
<a name="4" id="anc4"></a><span class="line-modified"> 49 TSA Digest</span>
<span class="line-modified"> 50     The timestamp digest algorithm used by signing.</span>


 51 
 52 TSA
 53     TSA URL index. All of TSA URLs and their indices can be found at the top
 54     of this report.
 55 
 56 Signing Status
 57     Signing process result status. The status are the followings:
 58     [1]NONE, no action.
 59     [2]NORMAL, no any error and warning.
 60     [3]WARNING, no any error but some warnings raise.
 61     [4]ERROR, some errors raise.
 62 
 63 Verifier JDK
 64     The JDK version that verifies signed jars.
 65 
 66 Verifying Status
 67     Verifying process result status. The status are the same as those for
 68     &quot;Status of Signing&quot;.
 69 
 70 Delay Verifying Status
 71     Delay verifying process result status. The status are the same as those
 72     for &quot;Status of Signing&quot;.
 73 
 74 Failed
 75     It highlights which case fails. The failed cases (rows) are marked with
 76     letter X.
 77 
 78 ##### Usages #####
 79 jtreg [-options] \
 80     -jdk:&lt;path/to/testing/JDK&gt;
 81     [-DproxyHost=&lt;host&gt; \
 82      -DproxyPort=&lt;port&gt; \
<a name="5" id="anc5"></a>
 83      -DtsaListFile=&lt;/url/to/tsaListFile&gt; \
<a name="6" id="anc6"></a><span class="line-modified"> 84      -DtsaList=&lt;/path/to/tsa1#/path/to/tsa2#/path/to/tsa3#...&gt; \</span>
 85      -DjdkListFile=&lt;/path/to/jdkListFile&gt; \
 86      -DjdkList=&lt;/path/to/jdk1#/path/to/jdk2#/path/to/jdk3#...&gt; \
 87      -DjavaSecurityFile=&lt;/path/to/java/security/properties/file&gt; \
 88      -DdelayVerify=&lt;true|false&gt; \
 89      -DcertValidity=&lt;[1, 1440]&gt;] \
<a name="7" id="anc7"></a><span class="line-modified"> 90     &lt;JDK_REPO&gt;/jdk/test/sun/security/tools/jarsigner/compatibility/Compatibility.java</span>
 91 
 92 Besides the common jtreg options, like -jdk, this test introduces a set of
 93 properties for receiving users&#39; inputs and making the test more flexible. These
<a name="8" id="anc8"></a><span class="line-modified"> 94 properties are:</span>

 95 proxyHost=&lt;host&gt;
 96     This property indicates proxy host.
 97 
 98 proxyPort=&lt;port&gt;
 99     This property indicates proxy port. The default value is 80.
100 
<a name="9" id="anc9"></a>











101 tsaListFile=&lt;/path/to/tsaListFile&gt;
102     This property indicates a local file, which contains a set of TSA URLs and
103     the supported digest algorithms (by optional parameter digests). The format
104     of the file content looks like the below,
105     http://path/to/tsa1
106     http://path/to/tsa2;digests=SHA-1,SHA-256
107     https://path/to/tsa3
108     ...
109 
110     If a TSA line does not list the supported digest algorithms, that means
111     the TSA supports SHA-1, SHA-256 and SHA-512. Because the test only focus
112     on SHA-1, SHA-256 and SHA-512. So, if other digest algorithms, like SHA-224
113     and SHA-384, are listed, they just be ignored.
114 
<a name="10" id="anc10"></a><span class="line-modified">115 tsaList=&lt;/path/to/tsa1#/path/to/tsa2;digests=SHA-1,SHA-256#...&gt;</span>
116     This property directly lists a set of TSAs in command. &quot;#&quot; is the delimiter.
117     Note that, if both of tsaListFile and tsaList are specified, only property
<a name="11" id="anc11"></a><span class="line-modified">118     jdkListFile is selected. If neither of tsaListFile and tsaList is specified,</span>
<span class="line-modified">119     the test will fails immediately.</span>

120 
121 jdkListFile=&lt;/path/to/jdkListFile&gt;
122     This property indicates a local file, which contains a set of local JDK
123     paths. The style of the file content looks like the below,
124     /path/to/jdk1
125     /path/to/jdk2
126     /path/to/jdk3
127     ...
128 
129 jdkList=&lt;/path/to/jdk1#/path/to/jdk2#/path/to/jdk3#...&gt;
130     This property directly lists a set of local JDK paths in command. &quot;#&quot; is
131     the delimiter.
<a name="12" id="anc12"></a>








132     Note that, if both of jdkListFile and jdkList are specified, only property
133     jdkListFile is selected. If neither of jdkListFile nor jdkList is specified,
<a name="13" id="anc13"></a><span class="line-modified">134     the testing JDK, which is specified by jtreg option -jdk will be used as</span>
135     the only one JDK in the JDK list.
136 
<a name="14" id="anc14"></a>





















137 javaSecurityFile=&lt;/path/to/java/security/properties/file&gt;
138     This property indicates an alternative java security properties file. The
139     default file is the path of file java.scurity that is distributed with
140     this test.
141 
142 delayVerify=&lt;true|false&gt;
143     This property indicates if doing an additional verifying after all of valid
144     certificates expire. The default value is false.
145 
<a name="15" id="anc15"></a>




146 certValidity=&lt;[1, 1440]&gt;
147     This property indicates the remaining validity period in minutes for valid
148     certificates. The value range is [1, 1440]. The default value is 1440.
149     Note that, if delayVerify is false, this property doesn&#39;t take effect.
150 
<a name="16" id="anc16"></a><span class="line-modified">151 The testing JDK, which is specified by jtreg option &quot;-jdk&quot;, should include the</span>
<span class="line-modified">152 fix for JDK-8163304. Otherwise, the signature algorithm and timestamp digest</span>
<span class="line-modified">153 algorithm cannot be extracted from verification output. And this JDK should</span>
<span class="line-modified">154 support as many as possible signature algorithms. Anyway the latest JDK build</span>
<span class="line-modified">155 is always recommended.</span>















156 
157 ##### Examples #####
158 $ cat /path/to/jdkList
159 /path/to/jdk6u171-b05
160 /path/to/jdk7u161-b05
161 /path/to/jdk8u144-b01
162 /path/to/jdk9-179 
163 
164 $ cat /path/to/tsaList
165 http://timestamp.comodoca.com/rfc3161
166 http://sha256timestamp.ws.symantec.com/sha256/timestamp
167 http://tsa.starfieldtech.com
168 http://timestamp.entrust.net/TSS/RFC3161sha1TS;digests=SHA-1,SHA-256
169 http://timestamp.entrust.net/TSS/RFC3161sha2TS;digests=SHA-1,SHA-256
170 http://rfc3161timestamp.globalsign.com/advanced;digests=SHA-256,SHA-512
171 http://rfc3161timestamp.globalsign.com/standard
172 http://timestamp.globalsign.com/scripts/timstamp.dll
173 http://timestamp.globalsign.com/?signature=sha2;digests=SHA-256,SHA-512
174 http://timestamp.digicert.com
175 http://time.certum.pl
176 http://tsa.swisssign.net
177 http://zeitstempel.dfn.de
178 https://tsp.iaik.tugraz.at/tsp/TspRequest
179 
<a name="17" id="anc17"></a><span class="line-modified">180 $ jtreg -va -nr -timeout:100 \</span>
181     -jdk:/path/to/latest/jdk \
182     -DproxyHost=&lt;proxy&gt; -DproxyPort=&lt;port&gt; \
183     -DjdkListFile=/path/to/jdkList \
184     -DtsaListFile=/path/to/tsaList \
185     -DdelayVerify=true -DcertValidity=60 \
<a name="18" id="anc18"></a><span class="line-modified">186     &lt;JDK_REPO&gt;/jdk/test/sun/security/tools/jarsigner/compatibility/Compatibility.java</span>
187 
188 The above is a comprehensive usage example. File &quot;jdkList&quot; lists the paths of
189 testing JDK builds, and file &quot;tsaList&quot; lists the URLs of TSA services. Some TSAs,
190 like http://timestamp.entrust.net/TSS/RFC3161sha1TS, specify the supported digest
191 algorithms. Other TSAs, which don&#39;t specify parameter digests, are regarded to
192 support SHA-1, SHA-256 and SHA-512. The test uses a proxy to access TSA services.
193 And it enables delay verifying and set the certificate validity period to 60
194 minutes. So, after the first verification is done, the test will wait for all
195 of valid certificates expire and then does verification again.
196 
197 If don&#39;t want to provide such JDK list and TSA list files, the test allows to
198 specify JDKs and TSAs (via properties jdkList and tsaList respectively) in the
199 command directly, like the below style,
<a name="19" id="anc19"></a><span class="line-modified">200 $ jtreg -va -nr -timeout:100 \</span>
201     -jdk:/path/to/latest/jdk \
202     -DproxyHost=&lt;proxy&gt; -DproxyPort=&lt;port&gt; \
203     -DjdkList=/path/to/jdk6u171-b05#/path/to/jdk7u161-b05#/path/to/jdk8u144-b01#/path/to/jdk9-179 \
204     -DtsaList=http://timestamp.comodoca.com/rfc3161#http://timestamp.entrust.net/TSS/RFC3161sha1TS;digests=SHA-1,SHA-256 \
205     -DdelayVerify=true -DcertValidity=60 \
<a name="20" id="anc20"></a><span class="line-modified">206     &lt;JDK_REPO&gt;/jdk/test/sun/security/tools/jarsigner/compatibility/Compatibility.java</span>
207 
208 Furthermore, here introduces one of the simplest usages. It doesn&#39;t specify any
209 JDK list, so the testing JDK, which is specified by jtreg option &quot;-jdk&quot;, will
210 be tested. And it doesn&#39;t apply delay verifying, and no proxy is used, and use
211 only one TSA. Now, the command is pretty simple and looks like the followings,
<a name="21" id="anc21"></a><span class="line-modified">212 $ jtreg -va -nr -timeout:100 \</span>
213     -jdk:/path/to/latest/jdk \
214     -DtsaList=http://timestamp.comodoca.com/rfc3161 \
<a name="22" id="anc22"></a><span class="line-modified">215     &lt;JDK_REPO&gt;/jdk/test/sun/security/tools/jarsigner/compatibility/Compatibility.java</span>









<a name="23" id="anc23"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="23" type="hidden" />
</body>
</html>