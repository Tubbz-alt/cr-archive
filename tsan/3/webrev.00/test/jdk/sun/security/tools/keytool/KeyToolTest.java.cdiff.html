<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/jdk/sun/security/tools/keytool/KeyToolTest.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="ImportPrompt.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="NssTest.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/sun/security/tools/keytool/KeyToolTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2005, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2005, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 21,11 ***</span>
   * questions.
   */
  
  /*
   * @test
<span class="line-modified">!  * @author weijun.wang</span>
   * @summary Testing keytool
   *
   * Run through autotest.sh and manualtest.sh
   *
   * Testing non-PKCS11 keystores:
<span class="line-new-header">--- 21,11 ---</span>
   * questions.
   */
  
  /*
   * @test
<span class="line-modified">!  * @bug 6251120 8231950</span>
   * @summary Testing keytool
   *
   * Run through autotest.sh and manualtest.sh
   *
   * Testing non-PKCS11 keystores:
</pre>
<hr />
<pre>
<span class="line-old-header">*** 195,11 ***</span>
          try {
              // Workaround for &quot;8057810: Make SHA256withDSA the default
              // jarsigner and keytool algorithm for DSA keys&quot;. Unfortunately
              // SunPKCS11-NSS does not support SHA256withDSA yet.
              if (cmd.contains(&quot;p11-nss.txt&quot;) &amp;&amp; cmd.contains(&quot;-genkey&quot;)
<span class="line-modified">!                     &amp;&amp; !cmd.contains(&quot;-keyalg&quot;)) {</span>
                  cmd += &quot; -sigalg SHA1withDSA -keysize 1024&quot;;
              }
              test(input, cmd);
          } catch(Exception e) {
              afterFail(input, cmd, &quot;OK&quot;);
<span class="line-new-header">--- 195,11 ---</span>
          try {
              // Workaround for &quot;8057810: Make SHA256withDSA the default
              // jarsigner and keytool algorithm for DSA keys&quot;. Unfortunately
              // SunPKCS11-NSS does not support SHA256withDSA yet.
              if (cmd.contains(&quot;p11-nss.txt&quot;) &amp;&amp; cmd.contains(&quot;-genkey&quot;)
<span class="line-modified">!                     &amp;&amp; cmd.contains(&quot;DSA&quot;)) {</span>
                  cmd += &quot; -sigalg SHA1withDSA -keysize 1024&quot;;
              }
              test(input, cmd);
          } catch(Exception e) {
              afterFail(input, cmd, &quot;OK&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 350,11 ***</span>
  
          // name changes: genkeypair, importcert, exportcert
          remove(&quot;x.jks&quot;);
          remove(&quot;x.jks.p1.cert&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -alias p1 -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-exportcert -alias p1 -file x.jks.p1.cert&quot;);
          ks = loadStore(&quot;x.jks&quot;, &quot;changeit&quot;, &quot;JKS&quot;);
          assertTrue(ks.getKey(&quot;p1&quot;, &quot;changeit&quot;.toCharArray()) != null,
              &quot;key not DSA&quot;);
<span class="line-new-header">--- 350,11 ---</span>
  
          // name changes: genkeypair, importcert, exportcert
          remove(&quot;x.jks&quot;);
          remove(&quot;x.jks.p1.cert&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -alias p1 -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-exportcert -alias p1 -file x.jks.p1.cert&quot;);
          ks = loadStore(&quot;x.jks&quot;, &quot;changeit&quot;, &quot;JKS&quot;);
          assertTrue(ks.getKey(&quot;p1&quot;, &quot;changeit&quot;.toCharArray()) != null,
              &quot;key not DSA&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 375,11 ***</span>
          X509CertImpl certImpl = new X509CertImpl(encoded);
          assertTrue(certImpl.getVersion() == 3, &quot;Version is not 3&quot;);
  
          // changealias and keyclone
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -alias p1 -dname CN=olala&quot;);</span>
          testOK(&quot;changeit\n&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-changealias -alias p1 -destalias p11&quot;);
          testOK(&quot;changeit\n&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-changealias -alias c1 -destalias c11&quot;);
          // press ENTER when prompt for p111&#39;s keypass
<span class="line-new-header">--- 375,11 ---</span>
          X509CertImpl certImpl = new X509CertImpl(encoded);
          assertTrue(certImpl.getVersion() == 3, &quot;Version is not 3&quot;);
  
          // changealias and keyclone
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -alias p1 -dname CN=olala&quot;);</span>
          testOK(&quot;changeit\n&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-changealias -alias p1 -destalias p11&quot;);
          testOK(&quot;changeit\n&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-changealias -alias c1 -destalias c11&quot;);
          // press ENTER when prompt for p111&#39;s keypass
</pre>
<hr />
<pre>
<span class="line-old-header">*** 394,14 ***</span>
  
          // genSecKey
          remove(&quot;x.jceks&quot;);
          // DES, no need keysize
          testOK(&quot;changeit\nchangeit\n\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
<span class="line-modified">!                 &quot;-genseckey -alias s1&quot;);</span>
          // DES, keysize cannot be 128
          testFail(&quot;changeit\n\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
<span class="line-modified">!                 &quot;-genseckey -alias s11 -keysize 128&quot;);</span>
          // DESede. no need keysize
          testOK(&quot;changeit\n\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
                  &quot;-genseckey -keyalg DESede -alias s2&quot;);
          // AES, need keysize
          testFail(&quot;changeit\n\n&quot;, &quot;-keystore x.jceks -storetype AES &quot; +
<span class="line-new-header">--- 394,14 ---</span>
  
          // genSecKey
          remove(&quot;x.jceks&quot;);
          // DES, no need keysize
          testOK(&quot;changeit\nchangeit\n\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
<span class="line-modified">!                 &quot;-genseckey -keyalg DES -alias s1&quot;);</span>
          // DES, keysize cannot be 128
          testFail(&quot;changeit\n\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
<span class="line-modified">!                 &quot;-genseckey -keyalg DES -alias s11 -keysize 128&quot;);</span>
          // DESede. no need keysize
          testOK(&quot;changeit\n\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
                  &quot;-genseckey -keyalg DESede -alias s2&quot;);
          // AES, need keysize
          testFail(&quot;changeit\n\n&quot;, &quot;-keystore x.jceks -storetype AES &quot; +
</pre>
<hr />
<pre>
<span class="line-old-header">*** 409,23 ***</span>
          testOK(&quot;changeit\n\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
                  &quot;-genseckey -keyalg AES -alias s3 -keysize 128&quot;);
          // about keypass
          // can accept storepass
          testOK(&quot;\n&quot;, &quot;-keystore x.jceks -storetype JCEKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-genseckey -alias s4&quot;);</span>
          // or a new one
          testOK(&quot;keypass\nkeypass\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
<span class="line-modified">!                 &quot;-storepass changeit -genseckey -alias s5&quot;);</span>
          // keypass must be valid (prompt 3 times)
          testOK(&quot;bad\n\bad\nkeypass\nkeypass\n&quot;, &quot;-keystore x.jceks &quot; +
<span class="line-modified">!                 &quot;-storetype JCEKS -storepass changeit -genseckey -alias s6&quot;);</span>
          // keypass must be valid (prompt 3 times)
          testFail(&quot;bad\n\bad\nbad\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
<span class="line-modified">!                 &quot;-storepass changeit -genseckey -alias s7&quot;);</span>
          // keypass must be valid (prompt 3 times)
          testFail(&quot;bad\n\bad\nbad\nkeypass\n&quot;, &quot;-keystore x.jceks &quot; +
<span class="line-modified">!                 &quot;-storetype JCEKS -storepass changeit -genseckey -alias s7&quot;);</span>
          ks = loadStore(&quot;x.jceks&quot;, &quot;changeit&quot;, &quot;JCEKS&quot;);
          assertTrue(ks.getKey(&quot;s1&quot;, &quot;changeit&quot;.toCharArray())
                  .getAlgorithm().equalsIgnoreCase(&quot;DES&quot;), &quot;s1 is DES&quot;);
          assertTrue(ks.getKey(&quot;s1&quot;, &quot;changeit&quot;.toCharArray())
                  .getEncoded().length == 8,  &quot;DES is 56&quot;);
<span class="line-new-header">--- 409,24 ---</span>
          testOK(&quot;changeit\n\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
                  &quot;-genseckey -keyalg AES -alias s3 -keysize 128&quot;);
          // about keypass
          // can accept storepass
          testOK(&quot;\n&quot;, &quot;-keystore x.jceks -storetype JCEKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-genseckey -keyalg DES -alias s4&quot;);</span>
          // or a new one
          testOK(&quot;keypass\nkeypass\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
<span class="line-modified">!                 &quot;-storepass changeit -genseckey -keyalg DES -alias s5&quot;);</span>
          // keypass must be valid (prompt 3 times)
          testOK(&quot;bad\n\bad\nkeypass\nkeypass\n&quot;, &quot;-keystore x.jceks &quot; +
<span class="line-modified">!                 &quot;-storetype JCEKS -storepass changeit -genseckey &quot; +</span>
<span class="line-added">+                 &quot;-keyalg DES -alias s6&quot;);</span>
          // keypass must be valid (prompt 3 times)
          testFail(&quot;bad\n\bad\nbad\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
<span class="line-modified">!                 &quot;-storepass changeit -genseckey -keyalg DES -alias s7&quot;);</span>
          // keypass must be valid (prompt 3 times)
          testFail(&quot;bad\n\bad\nbad\nkeypass\n&quot;, &quot;-keystore x.jceks &quot; +
<span class="line-modified">!                 &quot;-storetype JCEKS -storepass changeit -genseckey -keyalg DES -alias s7&quot;);</span>
          ks = loadStore(&quot;x.jceks&quot;, &quot;changeit&quot;, &quot;JCEKS&quot;);
          assertTrue(ks.getKey(&quot;s1&quot;, &quot;changeit&quot;.toCharArray())
                  .getAlgorithm().equalsIgnoreCase(&quot;DES&quot;), &quot;s1 is DES&quot;);
          assertTrue(ks.getKey(&quot;s1&quot;, &quot;changeit&quot;.toCharArray())
                  .getEncoded().length == 8,  &quot;DES is 56&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 450,11 ***</span>
          // importKeyStore
          remove(&quot;x.jks&quot;);
          remove(&quot;x.jceks&quot;);
          // create 2 entries...
          testOK(&quot;changeit\nchangeit\n\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
<span class="line-modified">!                 &quot;-genkeypair -alias p1 -dname CN=Olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jceks -storetype JCEKS -storepass changeit &quot; +
                  &quot;-importcert -alias c1 -file x.jks.p1.cert -noprompt&quot;);
          ks = loadStore(&quot;x.jceks&quot;, &quot;changeit&quot;, &quot;JCEKS&quot;);
          assertTrue(ks.size() == 2, &quot;2 entries in JCEKS&quot;);
          // import, shouldn&#39;t mention destalias/srckeypass/destkeypass
<span class="line-new-header">--- 451,11 ---</span>
          // importKeyStore
          remove(&quot;x.jks&quot;);
          remove(&quot;x.jceks&quot;);
          // create 2 entries...
          testOK(&quot;changeit\nchangeit\n\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
<span class="line-modified">!                 &quot;-genkeypair -keyalg DSA -alias p1 -dname CN=Olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jceks -storetype JCEKS -storepass changeit &quot; +
                  &quot;-importcert -alias c1 -file x.jks.p1.cert -noprompt&quot;);
          ks = loadStore(&quot;x.jceks&quot;, &quot;changeit&quot;, &quot;JCEKS&quot;);
          assertTrue(ks.size() == 2, &quot;2 entries in JCEKS&quot;);
          // import, shouldn&#39;t mention destalias/srckeypass/destkeypass
</pre>
<hr />
<pre>
<span class="line-old-header">*** 530,11 ***</span>
  
          // importkeystore single, different keypass
          remove(&quot;x.jks&quot;);
          // generate entry with different keypass
          testOK(&quot;changeit\nkeypass\nkeypass\n&quot;, &quot;-keystore x.jceks &quot; +
<span class="line-modified">!                 &quot;-storetype JCEKS -genkeypair -alias p2 -dname CN=Olala&quot;);</span>
          // prompt
          testOK(&quot;changeit\nchangeit\nchangeit\nkeypass\n&quot;, &quot;-importkeystore &quot; +
                  &quot;-srckeystore x.jceks -srcstoretype JCEKS &quot; +
                  &quot;-destkeystore x.jks -deststoretype JKS -srcalias p2&quot;);
          ks = loadStore(&quot;x.jks&quot;, &quot;changeit&quot;, &quot;JKS&quot;);
<span class="line-new-header">--- 531,11 ---</span>
  
          // importkeystore single, different keypass
          remove(&quot;x.jks&quot;);
          // generate entry with different keypass
          testOK(&quot;changeit\nkeypass\nkeypass\n&quot;, &quot;-keystore x.jceks &quot; +
<span class="line-modified">!                 &quot;-storetype JCEKS -genkeypair -keyalg DSA -alias p2 -dname CN=Olala&quot;);</span>
          // prompt
          testOK(&quot;changeit\nchangeit\nchangeit\nkeypass\n&quot;, &quot;-importkeystore &quot; +
                  &quot;-srckeystore x.jceks -srcstoretype JCEKS &quot; +
                  &quot;-destkeystore x.jks -deststoretype JKS -srcalias p2&quot;);
          ks = loadStore(&quot;x.jks&quot;, &quot;changeit&quot;, &quot;JKS&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 579,14 ***</span>
  
          // importkeystore, secretkey
          remove(&quot;x.jks&quot;);
          // create SecretKeyEntry
          testOK(&quot;changeit\n\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
<span class="line-modified">!                 &quot;-genseckey -alias s1&quot;);</span>
          // create SecretKeyEntry
          testOK(&quot;changeit\n\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
<span class="line-modified">!                 &quot;-genseckey -alias s2&quot;);</span>
          // remove the keypass!=storepass one
          testOK(&quot;changeit\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
                  &quot;-delete -alias p2&quot;);
          ks = loadStore(&quot;x.jceks&quot;, &quot;changeit&quot;, &quot;JCEKS&quot;);
          // p1, c1, s1, s2
<span class="line-new-header">--- 580,14 ---</span>
  
          // importkeystore, secretkey
          remove(&quot;x.jks&quot;);
          // create SecretKeyEntry
          testOK(&quot;changeit\n\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
<span class="line-modified">!                 &quot;-genseckey -keyalg DES -alias s1&quot;);</span>
          // create SecretKeyEntry
          testOK(&quot;changeit\n\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
<span class="line-modified">!                 &quot;-genseckey -keyalg DES -alias s2&quot;);</span>
          // remove the keypass!=storepass one
          testOK(&quot;changeit\n&quot;, &quot;-keystore x.jceks -storetype JCEKS &quot; +
                  &quot;-delete -alias p2&quot;);
          ks = loadStore(&quot;x.jceks&quot;, &quot;changeit&quot;, &quot;JCEKS&quot;);
          // p1, c1, s1, s2
</pre>
<hr />
<pre>
<span class="line-old-header">*** 627,17 ***</span>
          testFail(&quot;changeit\nchangeit\n&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-genkeypair -alias p1 -dname CN=olala&quot;);
          remove(&quot;x.jks&quot;);
          // just type ENTER means keypass=storepass
          testOK(&quot;changeit\nchangeit\n\n&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
<span class="line-modified">!                 &quot;-genkeypair -alias p1 -dname CN=olala&quot;);</span>
          remove(&quot;x.p12&quot;);
          // PKCS12 only need storepass
          testOK(&quot;&quot;, &quot;-keystore x.p12 -storetype PKCS12 -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-genkeypair -alias p0 -dname CN=olala&quot;);</span>
          testOK(&quot;changeit\n&quot;, &quot;-keystore x.p12 -storetype PKCS12 &quot; +
<span class="line-modified">!                 &quot;-genkeypair -alias p1 -dname CN=olala&quot;);</span>
          // when specify keypass, make sure keypass==storepass...
          testOK(&quot;changeit\n&quot;, &quot;-keystore x.p12 -keypass changeit &quot; +
                  &quot;-storetype PKCS12 -genkeypair -keyalg DSA -alias p3 -dname CN=olala&quot;);
          assertTrue(err.indexOf(&quot;Warning&quot;) == -1,
                  &quot;PKCS12 silent when keypass == storepass&quot;);
<span class="line-new-header">--- 628,17 ---</span>
          testFail(&quot;changeit\nchangeit\n&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-genkeypair -alias p1 -dname CN=olala&quot;);
          remove(&quot;x.jks&quot;);
          // just type ENTER means keypass=storepass
          testOK(&quot;changeit\nchangeit\n\n&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
<span class="line-modified">!                 &quot;-genkeypair -keyalg DSA -alias p1 -dname CN=olala&quot;);</span>
          remove(&quot;x.p12&quot;);
          // PKCS12 only need storepass
          testOK(&quot;&quot;, &quot;-keystore x.p12 -storetype PKCS12 -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-genkeypair -keyalg DSA -alias p0 -dname CN=olala&quot;);</span>
          testOK(&quot;changeit\n&quot;, &quot;-keystore x.p12 -storetype PKCS12 &quot; +
<span class="line-modified">!                 &quot;-genkeypair -keyalg DSA -alias p1 -dname CN=olala&quot;);</span>
          // when specify keypass, make sure keypass==storepass...
          testOK(&quot;changeit\n&quot;, &quot;-keystore x.p12 -keypass changeit &quot; +
                  &quot;-storetype PKCS12 -genkeypair -keyalg DSA -alias p3 -dname CN=olala&quot;);
          assertTrue(err.indexOf(&quot;Warning&quot;) == -1,
                  &quot;PKCS12 silent when keypass == storepass&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 656,13 ***</span>
  
          // pkcs12
          remove(&quot;x.p12&quot;);
          // PKCS12 only need storepass
          testOK(&quot;&quot;, &quot;-keystore x.p12 -storetype PKCS12 -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-genkeypair -alias p0 -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-storepass changeit -keystore x.p12 -storetype PKCS12 &quot; +
<span class="line-modified">!                 &quot;-genkeypair -alias p1 -dname CN=olala&quot;);</span>
          // when specify keypass, make sure keypass==storepass...
          testOK(&quot;&quot;, &quot;-storepass changeit -keystore x.p12 -keypass changeit &quot; +
                  &quot;-storetype PKCS12 -genkeypair -keyalg DSA -alias p3 -dname CN=olala&quot;);
          assertTrue(err.indexOf(&quot;Warning&quot;) == -1,
                  &quot;PKCS12 silent when keypass == storepass&quot;);
<span class="line-new-header">--- 657,13 ---</span>
  
          // pkcs12
          remove(&quot;x.p12&quot;);
          // PKCS12 only need storepass
          testOK(&quot;&quot;, &quot;-keystore x.p12 -storetype PKCS12 -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-genkeypair -keyalg DSA -alias p0 -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-storepass changeit -keystore x.p12 -storetype PKCS12 &quot; +
<span class="line-modified">!                 &quot;-genkeypair -keyalg DSA -alias p1 -dname CN=olala&quot;);</span>
          // when specify keypass, make sure keypass==storepass...
          testOK(&quot;&quot;, &quot;-storepass changeit -keystore x.p12 -keypass changeit &quot; +
                  &quot;-storetype PKCS12 -genkeypair -keyalg DSA -alias p3 -dname CN=olala&quot;);
          assertTrue(err.indexOf(&quot;Warning&quot;) == -1,
                  &quot;PKCS12 silent when keypass == storepass&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 694,18 ***</span>
          assertTrue(out.indexOf(&quot;Your keystore contains 0 entries&quot;) != -1,
                  &quot;*** MAKE SURE YOU HAVE NO ENTRIES IN YOUR PKCS11 KEYSTORE &quot; +
                          &quot;BEFORE THIS TEST ***&quot;);
  
          testOK(&quot;&quot;, p11Arg +
<span class="line-modified">!                 &quot;-storepass test12 -genkeypair -alias p1 -dname CN=olala&quot;);</span>
<span class="line-modified">!         testOK(&quot;test12\n&quot;, p11Arg + &quot;-genkeypair -alias p2 -dname CN=olala2&quot;);</span>
          // cannot provide keypass for PKCS11
          testFail(&quot;test12\n&quot;, p11Arg +
<span class="line-modified">!                 &quot;-keypass test12 -genkeypair -alias p3 -dname CN=olala3&quot;);</span>
          // cannot provide keypass for PKCS11
          testFail(&quot;test12\n&quot;, p11Arg +
<span class="line-modified">!                 &quot;-keypass nonsense -genkeypair -alias p3 -dname CN=olala3&quot;);</span>
  
          testOK(&quot;&quot;, p11Arg + &quot;-storepass test12 -list&quot;);
          assertTrue(out.indexOf(&quot;Your keystore contains 2 entries&quot;) != -1,
                  &quot;2 entries in p11&quot;);
  
<span class="line-new-header">--- 695,18 ---</span>
          assertTrue(out.indexOf(&quot;Your keystore contains 0 entries&quot;) != -1,
                  &quot;*** MAKE SURE YOU HAVE NO ENTRIES IN YOUR PKCS11 KEYSTORE &quot; +
                          &quot;BEFORE THIS TEST ***&quot;);
  
          testOK(&quot;&quot;, p11Arg +
<span class="line-modified">!                 &quot;-storepass test12 -genkeypair -keyalg DSA -alias p1 -dname CN=olala&quot;);</span>
<span class="line-modified">!         testOK(&quot;test12\n&quot;, p11Arg + &quot;-genkeypair -keyalg DSA -alias p2 -dname CN=olala2&quot;);</span>
          // cannot provide keypass for PKCS11
          testFail(&quot;test12\n&quot;, p11Arg +
<span class="line-modified">!                 &quot;-keypass test12 -genkeypair -keyalg DSA -alias p3 -dname CN=olala3&quot;);</span>
          // cannot provide keypass for PKCS11
          testFail(&quot;test12\n&quot;, p11Arg +
<span class="line-modified">!                 &quot;-keypass nonsense -genkeypair -keyalg DSA -alias p3 -dname CN=olala3&quot;);</span>
  
          testOK(&quot;&quot;, p11Arg + &quot;-storepass test12 -list&quot;);
          assertTrue(out.indexOf(&quot;Your keystore contains 2 entries&quot;) != -1,
                  &quot;2 entries in p11&quot;);
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 736,12 ***</span>
  
      void testPKCS11ImportKeyStore() throws Exception {
  
          KeyStore ks;
          testOK(&quot;&quot;, p11Arg +
<span class="line-modified">!                 &quot;-storepass test12 -genkeypair -alias p1 -dname CN=olala&quot;);</span>
<span class="line-modified">!         testOK(&quot;test12\n&quot;, p11Arg + &quot;-genkeypair -alias p2 -dname CN=olala2&quot;);</span>
          // test importkeystore for pkcs11
  
          remove(&quot;x.jks&quot;);
          // pkcs11 -&gt; jks
          testOK(&quot;changeit\nchangeit\ntest12\n&quot;, srcP11Arg +
<span class="line-new-header">--- 737,12 ---</span>
  
      void testPKCS11ImportKeyStore() throws Exception {
  
          KeyStore ks;
          testOK(&quot;&quot;, p11Arg +
<span class="line-modified">!                 &quot;-storepass test12 -genkeypair -keyalg DSA -alias p1 -dname CN=olala&quot;);</span>
<span class="line-modified">!         testOK(&quot;test12\n&quot;, p11Arg + &quot;-genkeypair -keyalg DSA -alias p2 -dname CN=olala2&quot;);</span>
          // test importkeystore for pkcs11
  
          remove(&quot;x.jks&quot;);
          // pkcs11 -&gt; jks
          testOK(&quot;changeit\nchangeit\ntest12\n&quot;, srcP11Arg +
</pre>
<hr />
<pre>
<span class="line-old-header">*** 807,11 ***</span>
      // Import: cacert, prompt, trusted, non-trusted, bad chain, not match
      void sqeImportTest() throws Exception {
          KeyStore ks;
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-exportcert -file x.jks.p1.cert&quot;);
          /* deleted */ testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-storepass changeit -delete -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-new-header">--- 808,11 ---</span>
      // Import: cacert, prompt, trusted, non-trusted, bad chain, not match
      void sqeImportTest() throws Exception {
          KeyStore ks;
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-exportcert -file x.jks.p1.cert&quot;);
          /* deleted */ testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-storepass changeit -delete -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
</pre>
<hr />
<pre>
<span class="line-old-header">*** 840,11 ***</span>
      }
      // keyclone: exist. nonexist err, cert err, dest exist, misc
      void sqeKeyclonetest() throws Exception {
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala&quot;);</span>
          // new pass
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -new newpass -keyclone -dest p0&quot;);
          // new pass
          testOK(&quot;\n&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-new-header">--- 841,11 ---</span>
      }
      // keyclone: exist. nonexist err, cert err, dest exist, misc
      void sqeKeyclonetest() throws Exception {
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala&quot;);</span>
          // new pass
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -new newpass -keyclone -dest p0&quot;);
          // new pass
          testOK(&quot;\n&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
</pre>
<hr />
<pre>
<span class="line-old-header">*** 869,11 ***</span>
      }
      // keypasswd: exist, short, nonexist err, cert err, misc
      void sqeKeypasswdTest() throws Exception {
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -keypasswd -new newpass&quot;);
          /*change back*/ testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-storepass changeit -keypass newpass -keypasswd -new changeit&quot;);
          testOK(&quot;newpass\nnewpass\n&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
<span class="line-new-header">--- 870,11 ---</span>
      }
      // keypasswd: exist, short, nonexist err, cert err, misc
      void sqeKeypasswdTest() throws Exception {
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -keypasswd -new newpass&quot;);
          /*change back*/ testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-storepass changeit -keypass newpass -keypasswd -new changeit&quot;);
          testOK(&quot;newpass\nnewpass\n&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
</pre>
<hr />
<pre>
<span class="line-old-header">*** 907,11 ***</span>
                  &quot;-keypass changeit -keypasswd -new newpass&quot;);
          // diff pass
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-delete -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass keypass -genkeypair -dname CN=olala&quot;);</span>
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypasswd -new newpass&quot;);
          testOK(&quot;keypass\n&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-storepass changeit -keypasswd -new newpass&quot;);
          // i hate those misc test
<span class="line-new-header">--- 908,11 ---</span>
                  &quot;-keypass changeit -keypasswd -new newpass&quot;);
          // diff pass
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-delete -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass keypass -genkeypair -keyalg DSA -dname CN=olala&quot;);</span>
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypasswd -new newpass&quot;);
          testOK(&quot;keypass\n&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-storepass changeit -keypasswd -new newpass&quot;);
          // i hate those misc test
</pre>
<hr />
<pre>
<span class="line-old-header">*** 920,11 ***</span>
      // list: -f -alias, exist, nonexist err;
      // otherwise, check all shows, -rfc shows more, and misc
      void sqeListTest() throws Exception {
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit -list&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-list -alias mykey&quot;);
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-list -alias notexist&quot;);
<span class="line-new-header">--- 921,11 ---</span>
      // list: -f -alias, exist, nonexist err;
      // otherwise, check all shows, -rfc shows more, and misc
      void sqeListTest() throws Exception {
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit -list&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-list -alias mykey&quot;);
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-list -alias notexist&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 946,11 ***</span>
      }
      // selfcert: exist, non-exist err, cert err, sig, dname, wrong keypass, misc
      void sqeSelfCertTest() throws Exception {
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit -selfcert&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -selfcert&quot;);
          // not exist
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-new-header">--- 947,11 ---</span>
      }
      // selfcert: exist, non-exist err, cert err, sig, dname, wrong keypass, misc
      void sqeSelfCertTest() throws Exception {
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit -selfcert&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -selfcert&quot;);
          // not exist
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
</pre>
<hr />
<pre>
<span class="line-old-header">*** 972,11 ***</span>
          testFail(&quot;&quot;, &quot;-keystore aa//dd\\gg -storepass changeit &quot; +
                  &quot;-keypass changeit -selfcert&quot;);
          // diff pass
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass keypass -genkeypair -dname CN=olala&quot;);</span>
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-storepass changeit -selfcert&quot;);
          testOK(&quot;keypass\n&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-storepass changeit -selfcert&quot;);
  
<span class="line-new-header">--- 973,11 ---</span>
          testFail(&quot;&quot;, &quot;-keystore aa//dd\\gg -storepass changeit &quot; +
                  &quot;-keypass changeit -selfcert&quot;);
          // diff pass
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass keypass -genkeypair -keyalg DSA -dname CN=olala&quot;);</span>
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-storepass changeit -selfcert&quot;);
          testOK(&quot;keypass\n&quot;, &quot;-keystore x.jks -storetype JKS &quot; +
                  &quot;-storepass changeit -selfcert&quot;);
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 993,11 ***</span>
      }
      // storepass: bad old, short new, misc
      void sqeStorepassTest() throws Exception {
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala&quot;);</span>
          // all in arg
          testOK(&quot;&quot;, &quot;-storepasswd -keystore x.jks -storetype JKS &quot; +
                  &quot;-storepass changeit -new newstore&quot;);
          /* Change back */ testOK(&quot;&quot;, &quot;-storepasswd -keystore x.jks&quot; +
                  &quot; -storetype JKS -storepass newstore -new changeit&quot;);
<span class="line-new-header">--- 994,11 ---</span>
      }
      // storepass: bad old, short new, misc
      void sqeStorepassTest() throws Exception {
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala&quot;);</span>
          // all in arg
          testOK(&quot;&quot;, &quot;-storepasswd -keystore x.jks -storetype JKS &quot; +
                  &quot;-storepass changeit -new newstore&quot;);
          /* Change back */ testOK(&quot;&quot;, &quot;-storepasswd -keystore x.jks&quot; +
                  &quot; -storetype JKS -storepass newstore -new changeit&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1042,40 ***</span>
  
      void sqeGenkeyTest() throws Exception {
  
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala&quot;);</span>
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala -alias newentry&quot;);</span>
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala -alias newentry&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -genkeypair -dname CN=olala -keyalg DSA &quot; +
                  &quot;-alias n1&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -genkeypair -dname CN=olala -keyalg RSA &quot; +
                  &quot;-alias n2&quot;);
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -genkeypair -dname CN=olala &quot; +
                  &quot;-keyalg NoSuchAlg -alias n3&quot;);
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala -keysize 56 &quot; +</span>
                  &quot;-alias n4&quot;);
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala -keysize 999 &quot; +</span>
                  &quot;-alias n5&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala -keysize 512 &quot; +</span>
                  &quot;-alias n6&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala -keysize 1024 &quot; +</span>
                  &quot;-alias n7&quot;);
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala &quot; +</span>
                  &quot;-sigalg NoSuchAlg -alias n8&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -genkeypair -dname CN=olala -keyalg RSA &quot; +
                  &quot;-sigalg MD2withRSA -alias n9&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-new-header">--- 1043,40 ---</span>
  
      void sqeGenkeyTest() throws Exception {
  
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala&quot;);</span>
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala -alias newentry&quot;);</span>
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala -alias newentry&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -genkeypair -dname CN=olala -keyalg DSA &quot; +
                  &quot;-alias n1&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -genkeypair -dname CN=olala -keyalg RSA &quot; +
                  &quot;-alias n2&quot;);
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -genkeypair -dname CN=olala &quot; +
                  &quot;-keyalg NoSuchAlg -alias n3&quot;);
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala -keysize 56 &quot; +</span>
                  &quot;-alias n4&quot;);
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala -keysize 999 &quot; +</span>
                  &quot;-alias n5&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala -keysize 512 &quot; +</span>
                  &quot;-alias n6&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala -keysize 1024 &quot; +</span>
                  &quot;-alias n7&quot;);
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala &quot; +</span>
                  &quot;-sigalg NoSuchAlg -alias n8&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -genkeypair -dname CN=olala -keyalg RSA &quot; +
                  &quot;-sigalg MD2withRSA -alias n9&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1086,26 ***</span>
                  &quot;-sigalg SHA1withRSA -alias n11&quot;);
          testFail(&quot;&quot;, &quot;-keystore aa\\bb//cc\\dd -storepass changeit &quot; +
                  &quot;-keypass changeit -genkeypair -dname CN=olala -keyalg RSA &quot; +
                  &quot;-sigalg NoSuchAlg -alias n12&quot;);
          testFail(&quot;&quot;, &quot;-keystore badkeystore -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala &quot; +</span>
                  &quot;-alias n14&quot;);
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass badpass &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala -alias n16&quot;);</span>
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CNN=olala -alias n17&quot;);</span>
          remove(&quot;x.jks&quot;);
      }
  
      void sqeExportTest() throws Exception {
          remove(&quot;x.jks&quot;);
          // nonexist
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-export -file mykey.cert -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-export -file mykey.cert -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-delete -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-new-header">--- 1087,26 ---</span>
                  &quot;-sigalg SHA1withRSA -alias n11&quot;);
          testFail(&quot;&quot;, &quot;-keystore aa\\bb//cc\\dd -storepass changeit &quot; +
                  &quot;-keypass changeit -genkeypair -dname CN=olala -keyalg RSA &quot; +
                  &quot;-sigalg NoSuchAlg -alias n12&quot;);
          testFail(&quot;&quot;, &quot;-keystore badkeystore -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala &quot; +</span>
                  &quot;-alias n14&quot;);
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass badpass &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala -alias n16&quot;);</span>
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CNN=olala -alias n17&quot;);</span>
          remove(&quot;x.jks&quot;);
      }
  
      void sqeExportTest() throws Exception {
          remove(&quot;x.jks&quot;);
          // nonexist
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-export -file mykey.cert -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-export -file mykey.cert -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-delete -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1129,15 ***</span>
          remove(&quot;x.jks&quot;);
          // nonexist
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-delete -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-delete -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala&quot;);</span>
          // keystore name illegal
          testFail(&quot;&quot;, &quot;-keystore aa\\bb//cc\\dd -storepass changeit &quot; +
                  &quot;-delete -alias mykey&quot;);
          // keystore not exist
          testFail(&quot;&quot;, &quot;-keystore nonexistkeystore -storepass changeit &quot; +
<span class="line-new-header">--- 1130,15 ---</span>
          remove(&quot;x.jks&quot;);
          // nonexist
          testFail(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-delete -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-delete -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala&quot;);</span>
          // keystore name illegal
          testFail(&quot;&quot;, &quot;-keystore aa\\bb//cc\\dd -storepass changeit &quot; +
                  &quot;-delete -alias mykey&quot;);
          // keystore not exist
          testFail(&quot;&quot;, &quot;-keystore nonexistkeystore -storepass changeit &quot; +
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1155,11 ***</span>
          remove(&quot;x.jks&quot;);
          remove(&quot;x.jks.p1.cert&quot;);
          remove(&quot;csr1&quot;);
          // PrivateKeyEntry can do certreq
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala -keysize 1024&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-certreq -file csr1 -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-certreq -file csr1&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-new-header">--- 1156,11 ---</span>
          remove(&quot;x.jks&quot;);
          remove(&quot;x.jks.p1.cert&quot;);
          remove(&quot;csr1&quot;);
          // PrivateKeyEntry can do certreq
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala -keysize 1024&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-certreq -file csr1 -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-certreq -file csr1&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1219,11 ***</span>
      void sqePrintcertTest() throws Exception {
          remove(&quot;x.jks&quot;);
          remove(&quot;mykey.cert&quot;);
          remove(&quot;myweakkey.cert&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-export -file mykey.cert -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -genkeypair -dname CN=weak -keyalg rsa &quot; +
                  &quot;-keysize 512 -sigalg MD5withRSA -alias myweakkey&quot;);
<span class="line-new-header">--- 1220,11 ---</span>
      void sqePrintcertTest() throws Exception {
          remove(&quot;x.jks&quot;);
          remove(&quot;mykey.cert&quot;);
          remove(&quot;myweakkey.cert&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
<span class="line-modified">!                 &quot;-keypass changeit -genkeypair -keyalg DSA -dname CN=olala&quot;);</span>
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-export -file mykey.cert -alias mykey&quot;);
          testOK(&quot;&quot;, &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -genkeypair -dname CN=weak -keyalg rsa &quot; +
                  &quot;-keysize 512 -sigalg MD5withRSA -alias myweakkey&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1262,11 ***</span>
      void v3extTest(String keyAlg) throws Exception {
          KeyStore ks;
          remove(&quot;x.jks&quot;);
          String simple = &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -noprompt -keyalg &quot; + keyAlg + &quot; &quot;;
<span class="line-modified">!         String pre = simple + &quot;-genkeypair -dname CN=Olala -alias &quot;;</span>
  
          // Version and SKID
          testOK(&quot;&quot;, pre + &quot;o1&quot;);
  
          ks = loadStore(&quot;x.jks&quot;, &quot;changeit&quot;, &quot;JKS&quot;);
<span class="line-new-header">--- 1263,11 ---</span>
      void v3extTest(String keyAlg) throws Exception {
          KeyStore ks;
          remove(&quot;x.jks&quot;);
          String simple = &quot;-keystore x.jks -storetype JKS -storepass changeit &quot; +
                  &quot;-keypass changeit -noprompt -keyalg &quot; + keyAlg + &quot; &quot;;
<span class="line-modified">!         String pre = simple + &quot;-genkeypair -keyalg DSA -dname CN=Olala -alias &quot;;</span>
  
          // Version and SKID
          testOK(&quot;&quot;, pre + &quot;o1&quot;);
  
          ks = loadStore(&quot;x.jks&quot;, &quot;changeit&quot;, &quot;JKS&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1317,15 ***</span>
          // ambigous value
          testFail(&quot;&quot;, pre + &quot;ku5 -ext KU=d&quot;);
          // cRLSign cannot be cs
          testFail(&quot;&quot;, pre + &quot;ku6 -ext KU=cs&quot;);
          testOK(&quot;&quot;, pre + &quot;ku11 -ext KU=nr&quot;);
<span class="line-modified">!         // ke also means keyAgreement</span>
          testFail(&quot;&quot;, pre + &quot;ku12 -ext KU=ke&quot;);
          testOK(&quot;&quot;, pre + &quot;ku12 -ext KU=keyE&quot;);
          // de also means decipherOnly
<span class="line-modified">!         testFail(&quot;&quot;, pre + &quot;ku13 -ext KU=de&quot;);</span>
          testOK(&quot;&quot;, pre + &quot;ku13 -ext KU=dataE&quot;);
          testOK(&quot;&quot;, pre + &quot;ku14 -ext KU=ka&quot;);
          testOK(&quot;&quot;, pre + &quot;ku15 -ext KU=kcs&quot;);
          testOK(&quot;&quot;, pre + &quot;ku16 -ext KU=crls&quot;);
          testOK(&quot;&quot;, pre + &quot;ku17 -ext KU=eo&quot;);
<span class="line-new-header">--- 1318,17 ---</span>
          // ambigous value
          testFail(&quot;&quot;, pre + &quot;ku5 -ext KU=d&quot;);
          // cRLSign cannot be cs
          testFail(&quot;&quot;, pre + &quot;ku6 -ext KU=cs&quot;);
          testOK(&quot;&quot;, pre + &quot;ku11 -ext KU=nr&quot;);
<span class="line-modified">!         // ke means keyAgreement and keyCertSign...</span>
          testFail(&quot;&quot;, pre + &quot;ku12 -ext KU=ke&quot;);
          testOK(&quot;&quot;, pre + &quot;ku12 -ext KU=keyE&quot;);
<span class="line-added">+         testOK(&quot;&quot;, pre + &quot;ku12a -ext KU=kE&quot;); // kE is only keyEncipherment</span>
          // de also means decipherOnly
<span class="line-modified">!         testOK(&quot;&quot;, pre + &quot;ku13a -ext KU=de&quot;); // de is decipherOnly</span>
<span class="line-added">+         testOK(&quot;&quot;, pre + &quot;ku13b -ext KU=dE&quot;); // dE is dataEncipherment</span>
          testOK(&quot;&quot;, pre + &quot;ku13 -ext KU=dataE&quot;);
          testOK(&quot;&quot;, pre + &quot;ku14 -ext KU=ka&quot;);
          testOK(&quot;&quot;, pre + &quot;ku15 -ext KU=kcs&quot;);
          testOK(&quot;&quot;, pre + &quot;ku16 -ext KU=crls&quot;);
          testOK(&quot;&quot;, pre + &quot;ku17 -ext KU=eo&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1674,34 ***</span>
      void i18nTest() throws Exception {
          //   1.  keytool -help
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-help&quot;);
  
<span class="line-modified">!         //   2. keytool -genkey -v -keysize 512 Enter &quot;a&quot; for the keystore</span>
          // password. Check error (password too short). Enter &quot;password&quot; for
          // the keystore password. Hit &#39;return&#39; for &quot;first and last name&quot;,
          // &quot;organizational unit&quot;, &quot;City&quot;, &quot;State&quot;, and &quot;Country Code&quot;.
          // Type &quot;yes&quot; when they ask you if everything is correct.
          // Type &#39;return&#39; for new key password.
          testOK(&quot;a\npassword\npassword\nMe\nHere\nNow\nPlace\nPlace\nUS\nyes\n\n&quot;,
<span class="line-modified">!                 &quot;-genkey -v -keysize 512 -keystore x.jks -storetype JKS&quot;);</span>
          //   3. keytool -list -v -storepass password
          testOK(&quot;&quot;, &quot;-list -v -storepass password -keystore x.jks -storetype JKS&quot;);
          //   4. keytool -list -v Type &quot;a&quot; for the keystore password.
          // Check error (wrong keystore password).
          testFail(&quot;a\n&quot;, &quot;-list -v -keystore x.jks -storetype JKS&quot;);
          assertTrue(ex.indexOf(&quot;password was incorrect&quot;) != -1);
<span class="line-modified">!         //   5. keytool -genkey -v -keysize 512 Enter &quot;password&quot; as the password.</span>
          // Check error (alias &#39;mykey&#39; already exists).
<span class="line-modified">!         testFail(&quot;password\n&quot;, &quot;-genkey -v -keysize 512&quot; +</span>
                  &quot; -keystore x.jks -storetype JKS&quot;);
          assertTrue(ex.indexOf(&quot;alias &lt;mykey&gt; already exists&quot;) != -1);
<span class="line-modified">!         //   6. keytool -genkey -v -keysize 512 -alias mykey2 -storepass password</span>
          // Hit &#39;return&#39; for &quot;first and last name&quot;, &quot;organizational unit&quot;, &quot;City&quot;,
          // &quot;State&quot;, and &quot;Country Code&quot;. Type &quot;yes&quot; when they ask you if
          // everything is correct. Type &#39;return&#39; for new key password.
<span class="line-modified">!         testOK(&quot;\n\n\n\n\n\nyes\n\n&quot;, &quot;-genkey -v -keysize 512 -alias mykey2&quot; +</span>
                  &quot; -storepass password -keystore x.jks -storetype JKS&quot;);
          //   7. keytool -list -v Type &#39;password&#39; for the store password.
          testOK(&quot;password\n&quot;, &quot;-list -v -keystore x.jks -storetype JKS&quot;);
          //   8. keytool -keypasswd -v -alias mykey2 -storepass password
          // Type &quot;a&quot; for the new key password. Type &quot;aaaaaa&quot; for the new key
<span class="line-new-header">--- 1677,34 ---</span>
      void i18nTest() throws Exception {
          //   1.  keytool -help
          remove(&quot;x.jks&quot;);
          testOK(&quot;&quot;, &quot;-help&quot;);
  
<span class="line-modified">!         //   2. keytool -genkey -keyalg DSA -v -keysize 512 Enter &quot;a&quot; for the keystore</span>
          // password. Check error (password too short). Enter &quot;password&quot; for
          // the keystore password. Hit &#39;return&#39; for &quot;first and last name&quot;,
          // &quot;organizational unit&quot;, &quot;City&quot;, &quot;State&quot;, and &quot;Country Code&quot;.
          // Type &quot;yes&quot; when they ask you if everything is correct.
          // Type &#39;return&#39; for new key password.
          testOK(&quot;a\npassword\npassword\nMe\nHere\nNow\nPlace\nPlace\nUS\nyes\n\n&quot;,
<span class="line-modified">!                 &quot;-genkey -keyalg DSA -v -keysize 512 -keystore x.jks -storetype JKS&quot;);</span>
          //   3. keytool -list -v -storepass password
          testOK(&quot;&quot;, &quot;-list -v -storepass password -keystore x.jks -storetype JKS&quot;);
          //   4. keytool -list -v Type &quot;a&quot; for the keystore password.
          // Check error (wrong keystore password).
          testFail(&quot;a\n&quot;, &quot;-list -v -keystore x.jks -storetype JKS&quot;);
          assertTrue(ex.indexOf(&quot;password was incorrect&quot;) != -1);
<span class="line-modified">!         //   5. keytool - -keyalg DSA -v -keysize 512 Enter &quot;password&quot; as the password.</span>
          // Check error (alias &#39;mykey&#39; already exists).
<span class="line-modified">!         testFail(&quot;password\n&quot;, &quot;-genkey -keyalg DSA -v -keysize 512&quot; +</span>
                  &quot; -keystore x.jks -storetype JKS&quot;);
          assertTrue(ex.indexOf(&quot;alias &lt;mykey&gt; already exists&quot;) != -1);
<span class="line-modified">!         //   6. keytool -genkey -keyalg DSA -v -keysize 512 -alias mykey2 -storepass password</span>
          // Hit &#39;return&#39; for &quot;first and last name&quot;, &quot;organizational unit&quot;, &quot;City&quot;,
          // &quot;State&quot;, and &quot;Country Code&quot;. Type &quot;yes&quot; when they ask you if
          // everything is correct. Type &#39;return&#39; for new key password.
<span class="line-modified">!         testOK(&quot;\n\n\n\n\n\nyes\n\n&quot;, &quot;-genkey -keyalg DSA -v -keysize 512 -alias mykey2&quot; +</span>
                  &quot; -storepass password -keystore x.jks -storetype JKS&quot;);
          //   7. keytool -list -v Type &#39;password&#39; for the store password.
          testOK(&quot;password\n&quot;, &quot;-list -v -keystore x.jks -storetype JKS&quot;);
          //   8. keytool -keypasswd -v -alias mykey2 -storepass password
          // Type &quot;a&quot; for the new key password. Type &quot;aaaaaa&quot; for the new key
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1806,11 ***</span>
  
      // tesing new option -srcProviderName
      void sszzTest() throws Exception {
          testAnyway(&quot;&quot;, NSS_P11_ARG+&quot;-delete -alias nss -storepass test12&quot;);
          testAnyway(&quot;&quot;, NZZ_P11_ARG+&quot;-delete -alias nss -storepass test12&quot;);
<span class="line-modified">!         testOK(&quot;&quot;, NSS_P11_ARG+&quot;-genkeypair -dname CN=NSS &quot; +</span>
                  &quot;-alias nss -storepass test12&quot;);
          testOK(&quot;&quot;, NSS_SRC_P11_ARG + NZZ_P11_ARG +
                  &quot;-importkeystore -srcstorepass test12 -deststorepass test12&quot;);
          testAnyway(&quot;&quot;, NSS_P11_ARG+&quot;-delete -alias nss -storepass test12&quot;);
          testAnyway(&quot;&quot;, NZZ_P11_ARG+&quot;-delete -alias nss -storepass test12&quot;);
<span class="line-new-header">--- 1809,11 ---</span>
  
      // tesing new option -srcProviderName
      void sszzTest() throws Exception {
          testAnyway(&quot;&quot;, NSS_P11_ARG+&quot;-delete -alias nss -storepass test12&quot;);
          testAnyway(&quot;&quot;, NZZ_P11_ARG+&quot;-delete -alias nss -storepass test12&quot;);
<span class="line-modified">!         testOK(&quot;&quot;, NSS_P11_ARG+&quot;-genkeypair -keyalg DSA -dname CN=NSS &quot; +</span>
                  &quot;-alias nss -storepass test12&quot;);
          testOK(&quot;&quot;, NSS_SRC_P11_ARG + NZZ_P11_ARG +
                  &quot;-importkeystore -srcstorepass test12 -deststorepass test12&quot;);
          testAnyway(&quot;&quot;, NSS_P11_ARG+&quot;-delete -alias nss -storepass test12&quot;);
          testAnyway(&quot;&quot;, NZZ_P11_ARG+&quot;-delete -alias nss -storepass test12&quot;);
</pre>
<center><a href="ImportPrompt.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="NssTest.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>