<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/sun/security/tools/jarsigner/EntriesOrder.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="AltProvider.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="LineBrokenMultiByteCharacter.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/sun/security/tools/jarsigner/EntriesOrder.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 47 
 48     public static void main(String[] args) throws Exception {
 49 
 50         String[] entries = {
 51                 &quot;META-INF/&quot;,
 52                 &quot;META-INF/MANIFEST.MF&quot;,
 53                 &quot;META-INF/A.RSA&quot;,
 54                 &quot;META-INF/A.SF&quot;,
 55                 &quot;META-INF/inf&quot;,
 56                 &quot;a&quot;};
 57 
 58         Map&lt;String,byte[]&gt; content = new HashMap&lt;&gt;();
 59 
 60         // We will create a jar containing entries above. Try all permutations
 61         // and confirm 1) When opened as a JarFile, we can always get 3 signed
 62         // ones (MANIFEST, inf, a), and 2) When opened as a JarInputStream,
 63         // when the order is correct (MANIFEST at beginning, followed by RSA/SF,
 64         // directory ignored), we can get 2 signed ones (inf, a).
 65 
 66         // Prepares raw files
<span class="line-modified"> 67         Files.write(Paths.get(&quot;a&quot;), &quot;a&quot;.getBytes());</span>
 68         Files.createDirectory(Paths.get(&quot;META-INF/&quot;));
<span class="line-modified"> 69         Files.write(Paths.get(&quot;META-INF/inf&quot;), &quot;inf&quot;.getBytes());</span>
 70 
 71         // Pack, sign, and extract to get all files
 72         sun.tools.jar.Main m =
 73                 new sun.tools.jar.Main(System.out, System.err, &quot;jar&quot;);
 74         if (!m.run(&quot;cvf a.jar a META-INF/inf&quot;.split(&quot; &quot;))) {
 75             throw new Exception(&quot;jar creation failed&quot;);
 76         }
 77         sun.security.tools.keytool.Main.main(
 78                 (&quot;-keystore jks -storepass changeit -keypass changeit -dname&quot; +
 79                         &quot; CN=A -alias a -genkeypair -keyalg rsa&quot;).split(&quot; &quot;));
 80         sun.security.tools.jarsigner.Main.main(
 81                 &quot;-keystore jks -storepass changeit a.jar a&quot;.split(&quot; &quot;));
 82         m = new sun.tools.jar.Main(System.out, System.err, &quot;jar&quot;);
 83         if (!m.run(&quot;xvf a.jar&quot;.split(&quot; &quot;))) {
 84             throw new Exception(&quot;jar extraction failed&quot;);
 85         }
 86 
 87         // Data
 88         for (String s: entries) {
 89             if (!s.endsWith(&quot;/&quot;)) {
</pre>
</td>
<td>
<hr />
<pre>
 47 
 48     public static void main(String[] args) throws Exception {
 49 
 50         String[] entries = {
 51                 &quot;META-INF/&quot;,
 52                 &quot;META-INF/MANIFEST.MF&quot;,
 53                 &quot;META-INF/A.RSA&quot;,
 54                 &quot;META-INF/A.SF&quot;,
 55                 &quot;META-INF/inf&quot;,
 56                 &quot;a&quot;};
 57 
 58         Map&lt;String,byte[]&gt; content = new HashMap&lt;&gt;();
 59 
 60         // We will create a jar containing entries above. Try all permutations
 61         // and confirm 1) When opened as a JarFile, we can always get 3 signed
 62         // ones (MANIFEST, inf, a), and 2) When opened as a JarInputStream,
 63         // when the order is correct (MANIFEST at beginning, followed by RSA/SF,
 64         // directory ignored), we can get 2 signed ones (inf, a).
 65 
 66         // Prepares raw files
<span class="line-modified"> 67         Files.write(Paths.get(&quot;a&quot;), List.of(&quot;a&quot;));</span>
 68         Files.createDirectory(Paths.get(&quot;META-INF/&quot;));
<span class="line-modified"> 69         Files.write(Paths.get(&quot;META-INF/inf&quot;), List.of(&quot;inf&quot;));</span>
 70 
 71         // Pack, sign, and extract to get all files
 72         sun.tools.jar.Main m =
 73                 new sun.tools.jar.Main(System.out, System.err, &quot;jar&quot;);
 74         if (!m.run(&quot;cvf a.jar a META-INF/inf&quot;.split(&quot; &quot;))) {
 75             throw new Exception(&quot;jar creation failed&quot;);
 76         }
 77         sun.security.tools.keytool.Main.main(
 78                 (&quot;-keystore jks -storepass changeit -keypass changeit -dname&quot; +
 79                         &quot; CN=A -alias a -genkeypair -keyalg rsa&quot;).split(&quot; &quot;));
 80         sun.security.tools.jarsigner.Main.main(
 81                 &quot;-keystore jks -storepass changeit a.jar a&quot;.split(&quot; &quot;));
 82         m = new sun.tools.jar.Main(System.out, System.err, &quot;jar&quot;);
 83         if (!m.run(&quot;xvf a.jar&quot;.split(&quot; &quot;))) {
 84             throw new Exception(&quot;jar extraction failed&quot;);
 85         }
 86 
 87         // Data
 88         for (String s: entries) {
 89             if (!s.endsWith(&quot;/&quot;)) {
</pre>
</td>
</tr>
</table>
<center><a href="AltProvider.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="LineBrokenMultiByteCharacter.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>