<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/sun/security/tools/keytool/WeakAlg.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="StorePasswords.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="console.sh.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/sun/security/tools/keytool/WeakAlg.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
161         kt(&quot;-genkeypair -keyalg DSA -alias a -dname CN=A&quot;)
162                 .shouldNotContain(&quot;Warning:&quot;);
163         kt(&quot;-list&quot;)
164                 .shouldNotContain(&quot;Warning:&quot;);
165         kt(&quot;-list -storetype jks&quot;) // no warning if PKCS12 used as JKS
166                 .shouldNotContain(&quot;Warning:&quot;);
167         kt(&quot;-exportcert -alias a -file a.crt&quot;)
168                 .shouldNotContain(&quot;Warning:&quot;);
169 
170         // warn if migrating to JKS
171         importkeystore(&quot;ks&quot;, &quot;ks2&quot;, &quot;-deststoretype jks&quot;)
172                 .shouldContain(&quot;JKS keystore uses a proprietary format&quot;);
173 
174         rm(&quot;ks&quot;);
175         rm(&quot;ks2&quot;);
176         rm(&quot;ks3&quot;);
177 
178         // no warning if all certs
179         kt(&quot;-importcert -alias b -file a.crt -storetype jks -noprompt&quot;)
180                 .shouldNotContain(&quot;Warning:&quot;);
<span class="line-modified">181         kt(&quot;-genkeypair -alias a -dname CN=A&quot;)</span>
182                 .shouldContain(&quot;JKS keystore uses a proprietary format&quot;);
183         kt(&quot;-list&quot;)
184                 .shouldContain(&quot;JKS keystore uses a proprietary format&quot;);
185         kt(&quot;-list -storetype pkcs12&quot;) // warn if JKS used as PKCS12
186                 .shouldContain(&quot;JKS keystore uses a proprietary format&quot;);
187         kt(&quot;-exportcert -alias a -file a.crt&quot;)
188                 .shouldContain(&quot;JKS keystore uses a proprietary format&quot;);
189         kt(&quot;-printcert -file a.crt&quot;) // no warning if keystore not touched
190                 .shouldNotContain(&quot;Warning:&quot;);
191         kt(&quot;-certreq -alias a -file a.req&quot;)
192                 .shouldContain(&quot;JKS keystore uses a proprietary format&quot;);
193         kt(&quot;-printcertreq -file a.req&quot;) // no warning if keystore not touched
194                 .shouldNotContain(&quot;Warning:&quot;);
195 
196         // No warning if migrating from JKS
197         importkeystore(&quot;ks&quot;, &quot;ks2&quot;, &quot;&quot;)
198                 .shouldNotContain(&quot;Warning:&quot;);
199 
200         importkeystore(&quot;ks&quot;, &quot;ks3&quot;, &quot;-deststoretype pkcs12&quot;)
201                 .shouldNotContain(&quot;Warning:&quot;);
202 
203         rm(&quot;ks&quot;);
204 
<span class="line-modified">205         kt(&quot;-genkeypair -alias a -dname CN=A -storetype jceks&quot;)</span>
206                 .shouldContain(&quot;JCEKS keystore uses a proprietary format&quot;);
207         kt(&quot;-list&quot;)
208                 .shouldContain(&quot;JCEKS keystore uses a proprietary format&quot;);
209         kt(&quot;-importcert -alias b -file a.crt -noprompt&quot;)
210                 .shouldContain(&quot;JCEKS keystore uses a proprietary format&quot;);
211         kt(&quot;-exportcert -alias a -file a.crt&quot;)
212                 .shouldContain(&quot;JCEKS keystore uses a proprietary format&quot;);
213         kt(&quot;-printcert -file a.crt&quot;)
214                 .shouldNotContain(&quot;Warning:&quot;);
215         kt(&quot;-certreq -alias a -file a.req&quot;)
216                 .shouldContain(&quot;JCEKS keystore uses a proprietary format&quot;);
217         kt(&quot;-printcertreq -file a.req&quot;)
218                 .shouldNotContain(&quot;Warning:&quot;);
219         kt(&quot;-genseckey -alias c -keyalg AES -keysize 128&quot;)
220                 .shouldContain(&quot;JCEKS keystore uses a proprietary format&quot;);
221     }
222 
223     static void checkImportKeyStore() throws Exception {
224 
225         rm(&quot;ks2&quot;);
226         rm(&quot;ks3&quot;);
227 
228         importkeystore(&quot;ks&quot;, &quot;ks2&quot;, &quot;&quot;)
229                 .shouldContain(&quot;3 entries successfully imported&quot;)
230                 .shouldContain(&quot;Warning&quot;)
231                 .shouldMatch(&quot;&lt;b&gt;.*512-bit RSA key.*risk&quot;)
232                 .shouldMatch(&quot;&lt;a&gt;.*MD5withRSA.*risk&quot;);
233 
234         importkeystore(&quot;ks&quot;, &quot;ks3&quot;, &quot;-srcalias a&quot;)
235                 .shouldContain(&quot;Warning&quot;)
236                 .shouldMatch(&quot;&lt;a&gt;.*MD5withRSA.*risk&quot;);
237     }
238 
239     static void checkInplaceImportKeyStore() throws Exception {
240 
241         rm(&quot;ks&quot;);
<span class="line-modified">242         genkeypair(&quot;a&quot;, &quot;&quot;);</span>
243 
244         // Same type backup
245         importkeystore(&quot;ks&quot;, &quot;ks&quot;, &quot;&quot;)
246                 .shouldContain(&quot;Warning:&quot;)
247                 .shouldMatch(&quot;original.*ks.old&quot;);
248 
249         importkeystore(&quot;ks&quot;, &quot;ks&quot;, &quot;&quot;)
250                 .shouldContain(&quot;Warning:&quot;)
251                 .shouldMatch(&quot;original.*ks.old2&quot;);
252 
253         importkeystore(&quot;ks&quot;, &quot;ks&quot;, &quot;-srcstoretype jks&quot;) // it knows real type
254                 .shouldContain(&quot;Warning:&quot;)
255                 .shouldMatch(&quot;original.*ks.old3&quot;);
256 
257         String cPath = new File(&quot;ks&quot;).getCanonicalPath();
258 
259         importkeystore(&quot;ks&quot;, cPath, &quot;&quot;)
260                 .shouldContain(&quot;Warning:&quot;)
261                 .shouldMatch(&quot;original.*ks.old4&quot;);
262 
</pre>
</td>
<td>
<hr />
<pre>
161         kt(&quot;-genkeypair -keyalg DSA -alias a -dname CN=A&quot;)
162                 .shouldNotContain(&quot;Warning:&quot;);
163         kt(&quot;-list&quot;)
164                 .shouldNotContain(&quot;Warning:&quot;);
165         kt(&quot;-list -storetype jks&quot;) // no warning if PKCS12 used as JKS
166                 .shouldNotContain(&quot;Warning:&quot;);
167         kt(&quot;-exportcert -alias a -file a.crt&quot;)
168                 .shouldNotContain(&quot;Warning:&quot;);
169 
170         // warn if migrating to JKS
171         importkeystore(&quot;ks&quot;, &quot;ks2&quot;, &quot;-deststoretype jks&quot;)
172                 .shouldContain(&quot;JKS keystore uses a proprietary format&quot;);
173 
174         rm(&quot;ks&quot;);
175         rm(&quot;ks2&quot;);
176         rm(&quot;ks3&quot;);
177 
178         // no warning if all certs
179         kt(&quot;-importcert -alias b -file a.crt -storetype jks -noprompt&quot;)
180                 .shouldNotContain(&quot;Warning:&quot;);
<span class="line-modified">181         kt(&quot;-genkeypair -keyalg DSA -alias a -dname CN=A&quot;)</span>
182                 .shouldContain(&quot;JKS keystore uses a proprietary format&quot;);
183         kt(&quot;-list&quot;)
184                 .shouldContain(&quot;JKS keystore uses a proprietary format&quot;);
185         kt(&quot;-list -storetype pkcs12&quot;) // warn if JKS used as PKCS12
186                 .shouldContain(&quot;JKS keystore uses a proprietary format&quot;);
187         kt(&quot;-exportcert -alias a -file a.crt&quot;)
188                 .shouldContain(&quot;JKS keystore uses a proprietary format&quot;);
189         kt(&quot;-printcert -file a.crt&quot;) // no warning if keystore not touched
190                 .shouldNotContain(&quot;Warning:&quot;);
191         kt(&quot;-certreq -alias a -file a.req&quot;)
192                 .shouldContain(&quot;JKS keystore uses a proprietary format&quot;);
193         kt(&quot;-printcertreq -file a.req&quot;) // no warning if keystore not touched
194                 .shouldNotContain(&quot;Warning:&quot;);
195 
196         // No warning if migrating from JKS
197         importkeystore(&quot;ks&quot;, &quot;ks2&quot;, &quot;&quot;)
198                 .shouldNotContain(&quot;Warning:&quot;);
199 
200         importkeystore(&quot;ks&quot;, &quot;ks3&quot;, &quot;-deststoretype pkcs12&quot;)
201                 .shouldNotContain(&quot;Warning:&quot;);
202 
203         rm(&quot;ks&quot;);
204 
<span class="line-modified">205         kt(&quot;-genkeypair -keyalg DSA -alias a -dname CN=A -storetype jceks&quot;)</span>
206                 .shouldContain(&quot;JCEKS keystore uses a proprietary format&quot;);
207         kt(&quot;-list&quot;)
208                 .shouldContain(&quot;JCEKS keystore uses a proprietary format&quot;);
209         kt(&quot;-importcert -alias b -file a.crt -noprompt&quot;)
210                 .shouldContain(&quot;JCEKS keystore uses a proprietary format&quot;);
211         kt(&quot;-exportcert -alias a -file a.crt&quot;)
212                 .shouldContain(&quot;JCEKS keystore uses a proprietary format&quot;);
213         kt(&quot;-printcert -file a.crt&quot;)
214                 .shouldNotContain(&quot;Warning:&quot;);
215         kt(&quot;-certreq -alias a -file a.req&quot;)
216                 .shouldContain(&quot;JCEKS keystore uses a proprietary format&quot;);
217         kt(&quot;-printcertreq -file a.req&quot;)
218                 .shouldNotContain(&quot;Warning:&quot;);
219         kt(&quot;-genseckey -alias c -keyalg AES -keysize 128&quot;)
220                 .shouldContain(&quot;JCEKS keystore uses a proprietary format&quot;);
221     }
222 
223     static void checkImportKeyStore() throws Exception {
224 
225         rm(&quot;ks2&quot;);
226         rm(&quot;ks3&quot;);
227 
228         importkeystore(&quot;ks&quot;, &quot;ks2&quot;, &quot;&quot;)
229                 .shouldContain(&quot;3 entries successfully imported&quot;)
230                 .shouldContain(&quot;Warning&quot;)
231                 .shouldMatch(&quot;&lt;b&gt;.*512-bit RSA key.*risk&quot;)
232                 .shouldMatch(&quot;&lt;a&gt;.*MD5withRSA.*risk&quot;);
233 
234         importkeystore(&quot;ks&quot;, &quot;ks3&quot;, &quot;-srcalias a&quot;)
235                 .shouldContain(&quot;Warning&quot;)
236                 .shouldMatch(&quot;&lt;a&gt;.*MD5withRSA.*risk&quot;);
237     }
238 
239     static void checkInplaceImportKeyStore() throws Exception {
240 
241         rm(&quot;ks&quot;);
<span class="line-modified">242         genkeypair(&quot;a&quot;, &quot;-keyalg DSA&quot;);</span>
243 
244         // Same type backup
245         importkeystore(&quot;ks&quot;, &quot;ks&quot;, &quot;&quot;)
246                 .shouldContain(&quot;Warning:&quot;)
247                 .shouldMatch(&quot;original.*ks.old&quot;);
248 
249         importkeystore(&quot;ks&quot;, &quot;ks&quot;, &quot;&quot;)
250                 .shouldContain(&quot;Warning:&quot;)
251                 .shouldMatch(&quot;original.*ks.old2&quot;);
252 
253         importkeystore(&quot;ks&quot;, &quot;ks&quot;, &quot;-srcstoretype jks&quot;) // it knows real type
254                 .shouldContain(&quot;Warning:&quot;)
255                 .shouldMatch(&quot;original.*ks.old3&quot;);
256 
257         String cPath = new File(&quot;ks&quot;).getCanonicalPath();
258 
259         importkeystore(&quot;ks&quot;, cPath, &quot;&quot;)
260                 .shouldContain(&quot;Warning:&quot;)
261                 .shouldMatch(&quot;original.*ks.old4&quot;);
262 
</pre>
</td>
</tr>
</table>
<center><a href="StorePasswords.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="console.sh.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>