<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New test/jdk/sun/security/tools/keytool/fakegen/java.base/sun/security/provider/DSAKeyPairGenerator.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 package sun.security.provider;
 25 
 26 import java.math.BigInteger;
 27 
 28 import java.security.*;
 29 import java.security.SecureRandom;
 30 import java.security.spec.AlgorithmParameterSpec;
 31 
 32 /**
 33  * A fake DSA key pair generator
 34  */
 35 class DSAKeyPairGenerator extends KeyPairGenerator {
 36 
 37     private int plen;
 38 
 39     DSAKeyPairGenerator(int defaultKeySize) {
 40         super(&quot;DSA&quot;);
 41         this.plen = defaultKeySize;
 42     }
 43 
 44     public void initialize(int modlen, SecureRandom random) {
 45         this.plen = modlen;
 46     }
 47 
 48     public void initialize(AlgorithmParameterSpec params, SecureRandom random) {
 49         throw new UnsupportedOperationException();
 50     }
 51 
 52     public KeyPair generateKeyPair() {
 53         BigInteger p, q, g, x, y;
 54         switch (plen) {
 55             case 1024:
 56                 p = new BigInteger(&quot;178011905478542266528237562450159990145232&quot;
 57                         + &quot;156369120674273274450314442865788737020770612695252&quot;
 58                         + &quot;123463079567156784778466449970650770920727857050009&quot;
 59                         + &quot;668388144034129745221171818506047231150039301079959&quot;
 60                         + &quot;358067395348717066319802262019714966524135060945913&quot;
 61                         + &quot;707594956514672855690606794135837542707371727429551&quot;
 62                         + &quot;343320695239&quot;);
 63                 q = new BigInteger(&quot;864205495604807476120572616017955259175325&quot;
 64                         + &quot;408501&quot;);
 65                 g = new BigInteger(&quot;174068207532402095185811980123523436538604&quot;
 66                         + &quot;490794561350978495831040599953488455823147851597408&quot;
 67                         + &quot;940950725307797094915759492368300574252438761037084&quot;
 68                         + &quot;473467180148876118103083043754985190983472601550494&quot;
 69                         + &quot;691329488083395492313850000361646482644608492304078&quot;
 70                         + &quot;721818959999056496097769368017749273708962006689187&quot;
 71                         + &quot;956744210730&quot;);
 72                 x = new BigInteger(&quot;442684721233431748836258763370873041965448&quot;
 73                         + &quot;305045&quot;);
 74                 y = new BigInteger(&quot;123777377875361061959303516913138943002334&quot;
 75                         + &quot;907914087825062123737715425120688699041350157178201&quot;
 76                         + &quot;400875613890444051801751930684745642628053940339973&quot;
 77                         + &quot;838660880918443284038995141330502246221730915504106&quot;
 78                         + &quot;313025753680709037893119973285385498869618080832350&quot;
 79                         + &quot;844717549458284541384384444940685082987448444197127&quot;
 80                         + &quot;109727215326&quot;);
 81                 break;
 82             case 3072:
 83                 p = new BigInteger(&quot;532424770282957507167558442446475365039221&quot;
 84                         + &quot;865310725601984444684810811113744209961033785957055&quot;
 85                         + &quot;545569814329215072178264469737927701168579964248618&quot;
 86                         + &quot;212671015750272795670312875451455848633455356647610&quot;
 87                         + &quot;802537682630581977793580392148938495801039643027210&quot;
 88                         + &quot;168055234243089546290868853109011307872303192870862&quot;
 89                         + &quot;928522910714047973751079687063489704904165319118754&quot;
 90                         + &quot;414656318529199596549052269402875554159175957058778&quot;
 91                         + &quot;440558421673575502884909440510567191072050738584727&quot;
 92                         + &quot;120524174557883883057055053123583287619621138916493&quot;
 93                         + &quot;103747092870334536468061850120264153241617645557971&quot;
 94                         + &quot;369719361654590867807897284715299844320510777830158&quot;
 95                         + &quot;726099043158186232574541934847234927190558272654504&quot;
 96                         + &quot;899757279197741136733127726856995584055651857157703&quot;
 97                         + &quot;730144527174175430693903863066052387871964460507889&quot;
 98                         + &quot;647358151911550149297202134918108185581732063173116&quot;
 99                         + &quot;923323722454275514471399056679497166381315291238166&quot;
100                         + &quot;678637058042047687405023560967657729197010282296512&quot;
101                         + &quot;1019243318222397&quot;);
102                 q = new BigInteger(&quot;890750162030504407723769200757822201430799&quot;
103                         + &quot;34855896740921457815099167207156753&quot;);
104                 g = new BigInteger(&quot;151817606774376623890824510431247991418389&quot;
105                         + &quot;715779225250508738780526725946562383344295250350988&quot;
106                         + &quot;771843988677909140611473778208677098146023000408394&quot;
107                         + &quot;159085130929460916510001933636711147155614261913281&quot;
108                         + &quot;024881629605746742555704817858764668833915862917006&quot;
109                         + &quot;598838541275997577579609978297421111961935816027196&quot;
110                         + &quot;483840098753346970227821715342000582711792748060856&quot;
111                         + &quot;726896896804543780217869880654497603605897208724113&quot;
112                         + &quot;159746510357451233393865294043543249227656881945445&quot;
113                         + &quot;911394836487973565655780621125471620102365417701222&quot;
114                         + &quot;942700788591992318925980959657031578942777920589286&quot;
115                         + &quot;616050851348109471636081284309144953091734152913609&quot;
116                         + &quot;446411782660994503265873790796828974300693496175976&quot;
117                         + &quot;687169380996928285288177682058646187108156643041984&quot;
118                         + &quot;849723272840833108573298006600021948389582796433112&quot;
119                         + &quot;947515654733901137745000270350091408182905439114222&quot;
120                         + &quot;789179830877253611946986888461931792357280552721443&quot;
121                         + &quot;254779196196933589018709692301251250169609249601817&quot;
122                         + &quot;4795480503442737&quot;);
123                 x = new BigInteger(&quot;837184725379267020693579006510066460977336&quot;
124                         + &quot;11851797067505263114214549968402803&quot;);
125                 y = new BigInteger(&quot;395340495486576955293430186860596538887519&quot;
126                         + &quot;532234445217156133155957480616804094258448364164620&quot;
127                         + &quot;019669119585215430588435624960233328621409901309332&quot;
128                         + &quot;192899527076171337665680476899693664056285881110265&quot;
129                         + &quot;747619109873269836751712303602309960796986216520795&quot;
130                         + &quot;801714761851172570535758859846766099312622783018124&quot;
131                         + &quot;479033035974495130498276693342256396509951099944860&quot;
132                         + &quot;886247767918456849069941054372775951688384599525157&quot;
133                         + &quot;707186634084399395289878437457318095050730531728857&quot;
134                         + &quot;772445883395712924633196197942869159234956079072812&quot;
135                         + &quot;033713932103618702222793066673087288841096282175640&quot;
136                         + &quot;243353943285718935517693389945339235110435667386410&quot;
137                         + &quot;827568246083609394541667076709869892137539964277111&quot;
138                         + &quot;881671381034966060604088870102183420000265271778711&quot;
139                         + &quot;380501229707440889595235145225482336904915838699846&quot;
140                         + &quot;941323450568220944649213026904670943083185766542427&quot;
141                         + &quot;196471392765688014947830444837953042683779059773143&quot;
142                         + &quot;877079141940001705246446188097009313372159366032655&quot;
143                         + &quot;5436444354063312&quot;);
144                 break;
145             default:
146                 throw new AssertionError(&quot;Unknown keySize &quot; + plen);
147         }
148 
149         try {
150             return new KeyPair(new DSAPublicKeyImpl(y, p, q, g),
151                     new DSAPrivateKey(x, p, q, g));
152         } catch (InvalidKeyException e) {
153             throw new ProviderException(e);
154         }
155     }
156 }
    </pre>
  </body>
</html>