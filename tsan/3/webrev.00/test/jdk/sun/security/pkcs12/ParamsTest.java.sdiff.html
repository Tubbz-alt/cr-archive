<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/sun/security/pkcs12/ParamsTest.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="PBES2Encoding.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="SameDN.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/sun/security/pkcs12/ParamsTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 97 
 98         // keytool
 99 
100         // Current default pkcs12 setting
101         keytool(&quot;-importkeystore -srckeystore ks -srcstorepass changeit &quot;
102                 + &quot;-destkeystore ksnormal -deststorepass changeit&quot;);
103         data = Files.readAllBytes(Path.of(&quot;ksnormal&quot;));
104         checkInt(data, &quot;22&quot;, 100000); // Mac ic
105         checkAlg(data, &quot;2000&quot;, SHA_oid); // Mac alg
106         checkAlg(data, &quot;110c010c01000&quot;, pbeWithSHA1AndDESede_oid); // key alg
107         checkInt(data, &quot;110c010c010011&quot;, 50000); // key ic
108         checkAlg(data, &quot;110c10&quot;, ENCRYPTED_DATA_OID);
109         checkAlg(data, &quot;110c110110&quot;, pbeWithSHA1AndRC2_40_oid); // cert alg
110         checkInt(data, &quot;110c1101111&quot;, 50000); // cert ic
111 
112         check(&quot;ksnormal&quot;, &quot;a&quot;, &quot;changeit&quot;, &quot;changeit&quot;, true, true, true);
113         check(&quot;ksnormal&quot;, &quot;a&quot;, null, &quot;changeit&quot;, true, false, true);
114         check(&quot;ksnormal&quot;, &quot;a&quot;, &quot;wrongpass&quot;, &quot;-&quot;, IOException.class, &quot;-&quot;, &quot;-&quot;);
115 
116         // Add a new entry with password-less settings, still has a storepass
<span class="line-modified">117         keytool(&quot;-keystore ksnormal -genkeypair -storepass changeit -alias b -dname CN=b &quot;</span>

118                 + &quot;-J-Dkeystore.pkcs12.certProtectionAlgorithm=NONE &quot;
119                 + &quot;-J-Dkeystore.pkcs12.macAlgorithm=NONE&quot;);
120         data = Files.readAllBytes(Path.of(&quot;ksnormal&quot;));
121         checkInt(data, &quot;22&quot;, 100000); // Mac ic
122         checkAlg(data, &quot;2000&quot;, SHA_oid); // Mac alg
123         checkAlg(data, &quot;110c010c01000&quot;, pbeWithSHA1AndDESede_oid); // key alg
124         checkInt(data, &quot;110c010c010011&quot;, 50000); // key ic
125         checkAlg(data, &quot;110c010c11000&quot;, pbeWithSHA1AndDESede_oid); // new key alg
126         checkInt(data, &quot;110c010c110011&quot;, 50000); // new key ic
127         checkAlg(data, &quot;110c10&quot;, ENCRYPTED_DATA_OID);
128         checkAlg(data, &quot;110c110110&quot;, pbeWithSHA1AndRC2_40_oid); // cert alg
129         checkInt(data, &quot;110c1101111&quot;, 50000); // cert ic
130         check(&quot;ksnormal&quot;, &quot;b&quot;, null, &quot;changeit&quot;, true, false, true);
131         check(&quot;ksnormal&quot;, &quot;b&quot;, &quot;changeit&quot;, &quot;changeit&quot;, true, true, true);
132 
133         // Different keypbe alg, no cert pbe and no mac
134         keytool(&quot;-importkeystore -srckeystore ks -srcstorepass changeit &quot;
135                 + &quot;-destkeystore ksnopass -deststorepass changeit &quot;
136                 + &quot;-J-Dkeystore.pkcs12.keyProtectionAlgorithm=PBEWithSHA1AndRC4_128 &quot;
137                 + &quot;-J-Dkeystore.pkcs12.certProtectionAlgorithm=NONE &quot;
138                 + &quot;-J-Dkeystore.pkcs12.macAlgorithm=NONE&quot;);
139         data = Files.readAllBytes(Path.of(&quot;ksnopass&quot;));
140         shouldNotExist(data, &quot;2&quot;); // no Mac
141         checkAlg(data, &quot;110c010c01000&quot;, pbeWithSHA1AndRC4_128_oid);
142         checkInt(data, &quot;110c010c010011&quot;, 50000);
143         checkAlg(data, &quot;110c10&quot;, DATA_OID);
144         check(&quot;ksnopass&quot;, &quot;a&quot;, null, &quot;changeit&quot;, true, true, true);
145         check(&quot;ksnopass&quot;, &quot;a&quot;, &quot;changeit&quot;, &quot;changeit&quot;, true, true, true);
146         check(&quot;ksnopass&quot;, &quot;a&quot;, &quot;wrongpass&quot;, &quot;changeit&quot;, true, true, true);
147 
148         // Add a new entry with normal settings, still password-less
<span class="line-modified">149         keytool(&quot;-keystore ksnopass -genkeypair -storepass changeit -alias b -dname CN=B&quot;);</span>

150         data = Files.readAllBytes(Path.of(&quot;ksnopass&quot;));
151         shouldNotExist(data, &quot;2&quot;); // no Mac
152         checkAlg(data, &quot;110c010c01000&quot;, pbeWithSHA1AndRC4_128_oid);
153         checkInt(data, &quot;110c010c010011&quot;, 50000);
154         checkAlg(data, &quot;110c010c11000&quot;, pbeWithSHA1AndDESede_oid);
155         checkInt(data, &quot;110c010c110011&quot;, 50000);
156         checkAlg(data, &quot;110c10&quot;, DATA_OID);
157         check(&quot;ksnopass&quot;, &quot;a&quot;, null, &quot;changeit&quot;, true, true, true);
158         check(&quot;ksnopass&quot;, &quot;b&quot;, null, &quot;changeit&quot;, true, true, true);
159 
160         keytool(&quot;-importkeystore -srckeystore ks -srcstorepass changeit &quot;
161                 + &quot;-destkeystore ksnewic -deststorepass changeit &quot;
162                 + &quot;-J-Dkeystore.pkcs12.macIterationCount=5555 &quot;
163                 + &quot;-J-Dkeystore.pkcs12.certPbeIterationCount=6666 &quot;
164                 + &quot;-J-Dkeystore.pkcs12.keyPbeIterationCount=7777&quot;);
165         data = Files.readAllBytes(Path.of(&quot;ksnewic&quot;));
166         checkInt(data, &quot;22&quot;, 5555); // Mac ic
167         checkAlg(data, &quot;2000&quot;, SHA_oid); // Mac alg
168         checkAlg(data, &quot;110c010c01000&quot;, pbeWithSHA1AndDESede_oid); // key alg
169         checkInt(data, &quot;110c010c010011&quot;, 7777); // key ic
170         checkAlg(data, &quot;110c110110&quot;, pbeWithSHA1AndRC2_40_oid); // cert alg
171         checkInt(data, &quot;110c1101111&quot;, 6666); // cert ic
172 
173         // keypbe alg cannot be NONE
<span class="line-modified">174         keytool(&quot;-keystore ksnewic -genkeypair -storepass changeit -alias b -dname CN=B &quot;</span>

175                 + &quot;-J-Dkeystore.pkcs12.keyProtectionAlgorithm=NONE&quot;)
176                 .shouldContain(&quot;NONE AlgorithmParameters not available&quot;)
177                 .shouldHaveExitValue(1);
178 
179         // new entry new keypbe alg (and default ic), else unchanged
<span class="line-modified">180         keytool(&quot;-keystore ksnewic -genkeypair -storepass changeit -alias b -dname CN=B &quot;</span>

181                 + &quot;-J-Dkeystore.pkcs12.keyProtectionAlgorithm=PBEWithSHA1AndRC4_128&quot;);
182         data = Files.readAllBytes(Path.of(&quot;ksnewic&quot;));
183         checkInt(data, &quot;22&quot;, 5555); // Mac ic
184         checkAlg(data, &quot;2000&quot;, SHA_oid); // Mac alg
185         checkAlg(data, &quot;110c010c01000&quot;, pbeWithSHA1AndDESede_oid); // key alg
186         checkInt(data, &quot;110c010c010011&quot;, 7777); // key ic
187         checkAlg(data, &quot;110c010c11000&quot;, pbeWithSHA1AndRC4_128_oid); // new key alg
188         checkInt(data, &quot;110c010c110011&quot;, 50000); // new key ic
189         checkAlg(data, &quot;110c110110&quot;, pbeWithSHA1AndRC2_40_oid); // cert alg
190         checkInt(data, &quot;110c1101111&quot;, 6666); // cert ic
191 
192         // Check KeyStore loading multiple keystores
193         KeyStore ks = KeyStore.getInstance(&quot;pkcs12&quot;);
194         try (FileInputStream fis = new FileInputStream(&quot;ksnormal&quot;);
195                 FileOutputStream fos = new FileOutputStream(&quot;ksnormaldup&quot;)) {
196             ks.load(fis, &quot;changeit&quot;.toCharArray());
197             ks.store(fos, &quot;changeit&quot;.toCharArray());
198         }
199         data = Files.readAllBytes(Path.of(&quot;ksnormaldup&quot;));
200         checkInt(data, &quot;22&quot;, 100000); // Mac ic
</pre>
<hr />
<pre>
319         // create a new password-less keystore
320         keytool(&quot;-keystore ksnopass -exportcert -alias a -file a.cert -rfc&quot;);
321 
322         // Normally storepass is prompted for
323         keytool(&quot;-keystore kscert1 -importcert -alias a -file a.cert -noprompt&quot;)
324                 .shouldContain(&quot;Enter keystore password:&quot;);
325         keytool(&quot;-keystore kscert2 -importcert -alias a -file a.cert -noprompt &quot;
326                 + &quot;-J-Dkeystore.pkcs12.certProtectionAlgorithm=NONE&quot;)
327                 .shouldContain(&quot;Enter keystore password:&quot;);
328         keytool(&quot;-keystore kscert3 -importcert -alias a -file a.cert -noprompt &quot;
329                 + &quot;-J-Dkeystore.pkcs12.macAlgorithm=NONE&quot;)
330                 .shouldContain(&quot;Enter keystore password:&quot;);
331         // ... but not if it&#39;s password-less
332         keytool(&quot;-keystore kscert4 -importcert -alias a -file a.cert -noprompt &quot;
333                 + &quot;-J-Dkeystore.pkcs12.certProtectionAlgorithm=NONE &quot;
334                 + &quot;-J-Dkeystore.pkcs12.macAlgorithm=NONE&quot;)
335                 .shouldNotContain(&quot;Enter keystore password:&quot;);
336 
337         // still prompt for keypass for genkeypair and certreq
338         SecurityTools.setResponse(&quot;changeit&quot;, &quot;changeit&quot;);
<span class="line-modified">339         keytool(&quot;-keystore ksnopassnew -genkeypair -alias a -dname CN=A &quot;</span>

340                 + &quot;-J-Dkeystore.pkcs12.certProtectionAlgorithm=NONE &quot;
341                 + &quot;-J-Dkeystore.pkcs12.macAlgorithm=NONE&quot;)
342                 .shouldNotContain(&quot;Enter keystore password:&quot;)
343                 .shouldContain(&quot;Enter key password for &lt;a&gt;&quot;);
344         keytool(&quot;-keystore ksnopassnew -certreq -alias a&quot;)
345                 .shouldNotContain(&quot;Enter keystore password:&quot;)
346                 .shouldContain(&quot;Enter key password for &lt;a&gt;&quot;);
347         keytool(&quot;-keystore ksnopassnew -list -v -alias a&quot;)
348                 .shouldNotContain(&quot;Enter keystore password:&quot;)
349                 .shouldNotContain(&quot;Enter key password for &lt;a&gt;&quot;);
350 
351         // params only read on demand
352 
353         // keyPbeIterationCount is used by -genkeypair
<span class="line-modified">354         keytool(&quot;-keystore ksgenbadkeyic -genkeypair -alias a -dname CN=A &quot;</span>

355                 + &quot;-storepass changeit &quot;
356                 + &quot;-J-Dkeystore.pkcs12.keyPbeIterationCount=abc&quot;)
357                 .shouldContain(&quot;keyPbeIterationCount is not a number: abc&quot;)
358                 .shouldHaveExitValue(1);
359 
360         keytool(&quot;-keystore ksnopassnew -exportcert -alias a -file a.cert&quot;);
361 
362         // but not used by -importcert
363         keytool(&quot;-keystore ksimpbadkeyic -importcert -alias a -file a.cert &quot;
364                 + &quot;-noprompt -storepass changeit &quot;
365                 + &quot;-J-Dkeystore.pkcs12.keyPbeIterationCount=abc&quot;)
366                 .shouldHaveExitValue(0);
367 
368         // None is used by -list
369         keytool(&quot;-keystore ksnormal -storepass changeit -list &quot;
370                 + &quot;-J-Dkeystore.pkcs12.keyPbeIterationCount=abc &quot;
371                 + &quot;-J-Dkeystore.pkcs12.certPbeIterationCount=abc &quot;
372                 + &quot;-J-Dkeystore.pkcs12.macIterationCount=abc&quot;)
373                 .shouldHaveExitValue(0);
374     }
</pre>
</td>
<td>
<hr />
<pre>
 97 
 98         // keytool
 99 
100         // Current default pkcs12 setting
101         keytool(&quot;-importkeystore -srckeystore ks -srcstorepass changeit &quot;
102                 + &quot;-destkeystore ksnormal -deststorepass changeit&quot;);
103         data = Files.readAllBytes(Path.of(&quot;ksnormal&quot;));
104         checkInt(data, &quot;22&quot;, 100000); // Mac ic
105         checkAlg(data, &quot;2000&quot;, SHA_oid); // Mac alg
106         checkAlg(data, &quot;110c010c01000&quot;, pbeWithSHA1AndDESede_oid); // key alg
107         checkInt(data, &quot;110c010c010011&quot;, 50000); // key ic
108         checkAlg(data, &quot;110c10&quot;, ENCRYPTED_DATA_OID);
109         checkAlg(data, &quot;110c110110&quot;, pbeWithSHA1AndRC2_40_oid); // cert alg
110         checkInt(data, &quot;110c1101111&quot;, 50000); // cert ic
111 
112         check(&quot;ksnormal&quot;, &quot;a&quot;, &quot;changeit&quot;, &quot;changeit&quot;, true, true, true);
113         check(&quot;ksnormal&quot;, &quot;a&quot;, null, &quot;changeit&quot;, true, false, true);
114         check(&quot;ksnormal&quot;, &quot;a&quot;, &quot;wrongpass&quot;, &quot;-&quot;, IOException.class, &quot;-&quot;, &quot;-&quot;);
115 
116         // Add a new entry with password-less settings, still has a storepass
<span class="line-modified">117         keytool(&quot;-keystore ksnormal -genkeypair -keyalg DSA &quot;</span>
<span class="line-added">118                 + &quot;-storepass changeit -alias b -dname CN=b &quot;</span>
119                 + &quot;-J-Dkeystore.pkcs12.certProtectionAlgorithm=NONE &quot;
120                 + &quot;-J-Dkeystore.pkcs12.macAlgorithm=NONE&quot;);
121         data = Files.readAllBytes(Path.of(&quot;ksnormal&quot;));
122         checkInt(data, &quot;22&quot;, 100000); // Mac ic
123         checkAlg(data, &quot;2000&quot;, SHA_oid); // Mac alg
124         checkAlg(data, &quot;110c010c01000&quot;, pbeWithSHA1AndDESede_oid); // key alg
125         checkInt(data, &quot;110c010c010011&quot;, 50000); // key ic
126         checkAlg(data, &quot;110c010c11000&quot;, pbeWithSHA1AndDESede_oid); // new key alg
127         checkInt(data, &quot;110c010c110011&quot;, 50000); // new key ic
128         checkAlg(data, &quot;110c10&quot;, ENCRYPTED_DATA_OID);
129         checkAlg(data, &quot;110c110110&quot;, pbeWithSHA1AndRC2_40_oid); // cert alg
130         checkInt(data, &quot;110c1101111&quot;, 50000); // cert ic
131         check(&quot;ksnormal&quot;, &quot;b&quot;, null, &quot;changeit&quot;, true, false, true);
132         check(&quot;ksnormal&quot;, &quot;b&quot;, &quot;changeit&quot;, &quot;changeit&quot;, true, true, true);
133 
134         // Different keypbe alg, no cert pbe and no mac
135         keytool(&quot;-importkeystore -srckeystore ks -srcstorepass changeit &quot;
136                 + &quot;-destkeystore ksnopass -deststorepass changeit &quot;
137                 + &quot;-J-Dkeystore.pkcs12.keyProtectionAlgorithm=PBEWithSHA1AndRC4_128 &quot;
138                 + &quot;-J-Dkeystore.pkcs12.certProtectionAlgorithm=NONE &quot;
139                 + &quot;-J-Dkeystore.pkcs12.macAlgorithm=NONE&quot;);
140         data = Files.readAllBytes(Path.of(&quot;ksnopass&quot;));
141         shouldNotExist(data, &quot;2&quot;); // no Mac
142         checkAlg(data, &quot;110c010c01000&quot;, pbeWithSHA1AndRC4_128_oid);
143         checkInt(data, &quot;110c010c010011&quot;, 50000);
144         checkAlg(data, &quot;110c10&quot;, DATA_OID);
145         check(&quot;ksnopass&quot;, &quot;a&quot;, null, &quot;changeit&quot;, true, true, true);
146         check(&quot;ksnopass&quot;, &quot;a&quot;, &quot;changeit&quot;, &quot;changeit&quot;, true, true, true);
147         check(&quot;ksnopass&quot;, &quot;a&quot;, &quot;wrongpass&quot;, &quot;changeit&quot;, true, true, true);
148 
149         // Add a new entry with normal settings, still password-less
<span class="line-modified">150         keytool(&quot;-keystore ksnopass -genkeypair -keyalg DSA &quot;</span>
<span class="line-added">151                 + &quot;-storepass changeit -alias b -dname CN=B&quot;);</span>
152         data = Files.readAllBytes(Path.of(&quot;ksnopass&quot;));
153         shouldNotExist(data, &quot;2&quot;); // no Mac
154         checkAlg(data, &quot;110c010c01000&quot;, pbeWithSHA1AndRC4_128_oid);
155         checkInt(data, &quot;110c010c010011&quot;, 50000);
156         checkAlg(data, &quot;110c010c11000&quot;, pbeWithSHA1AndDESede_oid);
157         checkInt(data, &quot;110c010c110011&quot;, 50000);
158         checkAlg(data, &quot;110c10&quot;, DATA_OID);
159         check(&quot;ksnopass&quot;, &quot;a&quot;, null, &quot;changeit&quot;, true, true, true);
160         check(&quot;ksnopass&quot;, &quot;b&quot;, null, &quot;changeit&quot;, true, true, true);
161 
162         keytool(&quot;-importkeystore -srckeystore ks -srcstorepass changeit &quot;
163                 + &quot;-destkeystore ksnewic -deststorepass changeit &quot;
164                 + &quot;-J-Dkeystore.pkcs12.macIterationCount=5555 &quot;
165                 + &quot;-J-Dkeystore.pkcs12.certPbeIterationCount=6666 &quot;
166                 + &quot;-J-Dkeystore.pkcs12.keyPbeIterationCount=7777&quot;);
167         data = Files.readAllBytes(Path.of(&quot;ksnewic&quot;));
168         checkInt(data, &quot;22&quot;, 5555); // Mac ic
169         checkAlg(data, &quot;2000&quot;, SHA_oid); // Mac alg
170         checkAlg(data, &quot;110c010c01000&quot;, pbeWithSHA1AndDESede_oid); // key alg
171         checkInt(data, &quot;110c010c010011&quot;, 7777); // key ic
172         checkAlg(data, &quot;110c110110&quot;, pbeWithSHA1AndRC2_40_oid); // cert alg
173         checkInt(data, &quot;110c1101111&quot;, 6666); // cert ic
174 
175         // keypbe alg cannot be NONE
<span class="line-modified">176         keytool(&quot;-keystore ksnewic -genkeypair -keyalg DSA &quot;</span>
<span class="line-added">177                 + &quot;-storepass changeit -alias b -dname CN=B &quot;</span>
178                 + &quot;-J-Dkeystore.pkcs12.keyProtectionAlgorithm=NONE&quot;)
179                 .shouldContain(&quot;NONE AlgorithmParameters not available&quot;)
180                 .shouldHaveExitValue(1);
181 
182         // new entry new keypbe alg (and default ic), else unchanged
<span class="line-modified">183         keytool(&quot;-keystore ksnewic -genkeypair -keyalg DSA &quot;</span>
<span class="line-added">184                 + &quot;-storepass changeit -alias b -dname CN=B &quot;</span>
185                 + &quot;-J-Dkeystore.pkcs12.keyProtectionAlgorithm=PBEWithSHA1AndRC4_128&quot;);
186         data = Files.readAllBytes(Path.of(&quot;ksnewic&quot;));
187         checkInt(data, &quot;22&quot;, 5555); // Mac ic
188         checkAlg(data, &quot;2000&quot;, SHA_oid); // Mac alg
189         checkAlg(data, &quot;110c010c01000&quot;, pbeWithSHA1AndDESede_oid); // key alg
190         checkInt(data, &quot;110c010c010011&quot;, 7777); // key ic
191         checkAlg(data, &quot;110c010c11000&quot;, pbeWithSHA1AndRC4_128_oid); // new key alg
192         checkInt(data, &quot;110c010c110011&quot;, 50000); // new key ic
193         checkAlg(data, &quot;110c110110&quot;, pbeWithSHA1AndRC2_40_oid); // cert alg
194         checkInt(data, &quot;110c1101111&quot;, 6666); // cert ic
195 
196         // Check KeyStore loading multiple keystores
197         KeyStore ks = KeyStore.getInstance(&quot;pkcs12&quot;);
198         try (FileInputStream fis = new FileInputStream(&quot;ksnormal&quot;);
199                 FileOutputStream fos = new FileOutputStream(&quot;ksnormaldup&quot;)) {
200             ks.load(fis, &quot;changeit&quot;.toCharArray());
201             ks.store(fos, &quot;changeit&quot;.toCharArray());
202         }
203         data = Files.readAllBytes(Path.of(&quot;ksnormaldup&quot;));
204         checkInt(data, &quot;22&quot;, 100000); // Mac ic
</pre>
<hr />
<pre>
323         // create a new password-less keystore
324         keytool(&quot;-keystore ksnopass -exportcert -alias a -file a.cert -rfc&quot;);
325 
326         // Normally storepass is prompted for
327         keytool(&quot;-keystore kscert1 -importcert -alias a -file a.cert -noprompt&quot;)
328                 .shouldContain(&quot;Enter keystore password:&quot;);
329         keytool(&quot;-keystore kscert2 -importcert -alias a -file a.cert -noprompt &quot;
330                 + &quot;-J-Dkeystore.pkcs12.certProtectionAlgorithm=NONE&quot;)
331                 .shouldContain(&quot;Enter keystore password:&quot;);
332         keytool(&quot;-keystore kscert3 -importcert -alias a -file a.cert -noprompt &quot;
333                 + &quot;-J-Dkeystore.pkcs12.macAlgorithm=NONE&quot;)
334                 .shouldContain(&quot;Enter keystore password:&quot;);
335         // ... but not if it&#39;s password-less
336         keytool(&quot;-keystore kscert4 -importcert -alias a -file a.cert -noprompt &quot;
337                 + &quot;-J-Dkeystore.pkcs12.certProtectionAlgorithm=NONE &quot;
338                 + &quot;-J-Dkeystore.pkcs12.macAlgorithm=NONE&quot;)
339                 .shouldNotContain(&quot;Enter keystore password:&quot;);
340 
341         // still prompt for keypass for genkeypair and certreq
342         SecurityTools.setResponse(&quot;changeit&quot;, &quot;changeit&quot;);
<span class="line-modified">343         keytool(&quot;-keystore ksnopassnew -genkeypair -keyalg DSA &quot;</span>
<span class="line-added">344                 + &quot;-alias a -dname CN=A &quot;</span>
345                 + &quot;-J-Dkeystore.pkcs12.certProtectionAlgorithm=NONE &quot;
346                 + &quot;-J-Dkeystore.pkcs12.macAlgorithm=NONE&quot;)
347                 .shouldNotContain(&quot;Enter keystore password:&quot;)
348                 .shouldContain(&quot;Enter key password for &lt;a&gt;&quot;);
349         keytool(&quot;-keystore ksnopassnew -certreq -alias a&quot;)
350                 .shouldNotContain(&quot;Enter keystore password:&quot;)
351                 .shouldContain(&quot;Enter key password for &lt;a&gt;&quot;);
352         keytool(&quot;-keystore ksnopassnew -list -v -alias a&quot;)
353                 .shouldNotContain(&quot;Enter keystore password:&quot;)
354                 .shouldNotContain(&quot;Enter key password for &lt;a&gt;&quot;);
355 
356         // params only read on demand
357 
358         // keyPbeIterationCount is used by -genkeypair
<span class="line-modified">359         keytool(&quot;-keystore ksgenbadkeyic -genkeypair -keyalg DSA &quot;</span>
<span class="line-added">360                 + &quot;-alias a -dname CN=A &quot;</span>
361                 + &quot;-storepass changeit &quot;
362                 + &quot;-J-Dkeystore.pkcs12.keyPbeIterationCount=abc&quot;)
363                 .shouldContain(&quot;keyPbeIterationCount is not a number: abc&quot;)
364                 .shouldHaveExitValue(1);
365 
366         keytool(&quot;-keystore ksnopassnew -exportcert -alias a -file a.cert&quot;);
367 
368         // but not used by -importcert
369         keytool(&quot;-keystore ksimpbadkeyic -importcert -alias a -file a.cert &quot;
370                 + &quot;-noprompt -storepass changeit &quot;
371                 + &quot;-J-Dkeystore.pkcs12.keyPbeIterationCount=abc&quot;)
372                 .shouldHaveExitValue(0);
373 
374         // None is used by -list
375         keytool(&quot;-keystore ksnormal -storepass changeit -list &quot;
376                 + &quot;-J-Dkeystore.pkcs12.keyPbeIterationCount=abc &quot;
377                 + &quot;-J-Dkeystore.pkcs12.certPbeIterationCount=abc &quot;
378                 + &quot;-J-Dkeystore.pkcs12.macIterationCount=abc&quot;)
379                 .shouldHaveExitValue(0);
380     }
</pre>
</td>
</tr>
</table>
<center><a href="PBES2Encoding.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="SameDN.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>