<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/jdk/sun/security/pkcs12/ParamsTest.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="PBES2Encoding.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="SameDN.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/sun/security/pkcs12/ParamsTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -112,11 +112,12 @@</span>
          check(&quot;ksnormal&quot;, &quot;a&quot;, &quot;changeit&quot;, &quot;changeit&quot;, true, true, true);
          check(&quot;ksnormal&quot;, &quot;a&quot;, null, &quot;changeit&quot;, true, false, true);
          check(&quot;ksnormal&quot;, &quot;a&quot;, &quot;wrongpass&quot;, &quot;-&quot;, IOException.class, &quot;-&quot;, &quot;-&quot;);
  
          // Add a new entry with password-less settings, still has a storepass
<span class="udiff-line-modified-removed">-         keytool(&quot;-keystore ksnormal -genkeypair -storepass changeit -alias b -dname CN=b &quot;</span>
<span class="udiff-line-modified-added">+         keytool(&quot;-keystore ksnormal -genkeypair -keyalg DSA &quot;</span>
<span class="udiff-line-added">+                 + &quot;-storepass changeit -alias b -dname CN=b &quot;</span>
                  + &quot;-J-Dkeystore.pkcs12.certProtectionAlgorithm=NONE &quot;
                  + &quot;-J-Dkeystore.pkcs12.macAlgorithm=NONE&quot;);
          data = Files.readAllBytes(Path.of(&quot;ksnormal&quot;));
          checkInt(data, &quot;22&quot;, 100000); // Mac ic
          checkAlg(data, &quot;2000&quot;, SHA_oid); // Mac alg
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -144,11 +145,12 @@</span>
          check(&quot;ksnopass&quot;, &quot;a&quot;, null, &quot;changeit&quot;, true, true, true);
          check(&quot;ksnopass&quot;, &quot;a&quot;, &quot;changeit&quot;, &quot;changeit&quot;, true, true, true);
          check(&quot;ksnopass&quot;, &quot;a&quot;, &quot;wrongpass&quot;, &quot;changeit&quot;, true, true, true);
  
          // Add a new entry with normal settings, still password-less
<span class="udiff-line-modified-removed">-         keytool(&quot;-keystore ksnopass -genkeypair -storepass changeit -alias b -dname CN=B&quot;);</span>
<span class="udiff-line-modified-added">+         keytool(&quot;-keystore ksnopass -genkeypair -keyalg DSA &quot;</span>
<span class="udiff-line-added">+                 + &quot;-storepass changeit -alias b -dname CN=B&quot;);</span>
          data = Files.readAllBytes(Path.of(&quot;ksnopass&quot;));
          shouldNotExist(data, &quot;2&quot;); // no Mac
          checkAlg(data, &quot;110c010c01000&quot;, pbeWithSHA1AndRC4_128_oid);
          checkInt(data, &quot;110c010c010011&quot;, 50000);
          checkAlg(data, &quot;110c010c11000&quot;, pbeWithSHA1AndDESede_oid);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -169,17 +171,19 @@</span>
          checkInt(data, &quot;110c010c010011&quot;, 7777); // key ic
          checkAlg(data, &quot;110c110110&quot;, pbeWithSHA1AndRC2_40_oid); // cert alg
          checkInt(data, &quot;110c1101111&quot;, 6666); // cert ic
  
          // keypbe alg cannot be NONE
<span class="udiff-line-modified-removed">-         keytool(&quot;-keystore ksnewic -genkeypair -storepass changeit -alias b -dname CN=B &quot;</span>
<span class="udiff-line-modified-added">+         keytool(&quot;-keystore ksnewic -genkeypair -keyalg DSA &quot;</span>
<span class="udiff-line-added">+                 + &quot;-storepass changeit -alias b -dname CN=B &quot;</span>
                  + &quot;-J-Dkeystore.pkcs12.keyProtectionAlgorithm=NONE&quot;)
                  .shouldContain(&quot;NONE AlgorithmParameters not available&quot;)
                  .shouldHaveExitValue(1);
  
          // new entry new keypbe alg (and default ic), else unchanged
<span class="udiff-line-modified-removed">-         keytool(&quot;-keystore ksnewic -genkeypair -storepass changeit -alias b -dname CN=B &quot;</span>
<span class="udiff-line-modified-added">+         keytool(&quot;-keystore ksnewic -genkeypair -keyalg DSA &quot;</span>
<span class="udiff-line-added">+                 + &quot;-storepass changeit -alias b -dname CN=B &quot;</span>
                  + &quot;-J-Dkeystore.pkcs12.keyProtectionAlgorithm=PBEWithSHA1AndRC4_128&quot;);
          data = Files.readAllBytes(Path.of(&quot;ksnewic&quot;));
          checkInt(data, &quot;22&quot;, 5555); // Mac ic
          checkAlg(data, &quot;2000&quot;, SHA_oid); // Mac alg
          checkAlg(data, &quot;110c010c01000&quot;, pbeWithSHA1AndDESede_oid); // key alg
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -334,11 +338,12 @@</span>
                  + &quot;-J-Dkeystore.pkcs12.macAlgorithm=NONE&quot;)
                  .shouldNotContain(&quot;Enter keystore password:&quot;);
  
          // still prompt for keypass for genkeypair and certreq
          SecurityTools.setResponse(&quot;changeit&quot;, &quot;changeit&quot;);
<span class="udiff-line-modified-removed">-         keytool(&quot;-keystore ksnopassnew -genkeypair -alias a -dname CN=A &quot;</span>
<span class="udiff-line-modified-added">+         keytool(&quot;-keystore ksnopassnew -genkeypair -keyalg DSA &quot;</span>
<span class="udiff-line-added">+                 + &quot;-alias a -dname CN=A &quot;</span>
                  + &quot;-J-Dkeystore.pkcs12.certProtectionAlgorithm=NONE &quot;
                  + &quot;-J-Dkeystore.pkcs12.macAlgorithm=NONE&quot;)
                  .shouldNotContain(&quot;Enter keystore password:&quot;)
                  .shouldContain(&quot;Enter key password for &lt;a&gt;&quot;);
          keytool(&quot;-keystore ksnopassnew -certreq -alias a&quot;)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -349,11 +354,12 @@</span>
                  .shouldNotContain(&quot;Enter key password for &lt;a&gt;&quot;);
  
          // params only read on demand
  
          // keyPbeIterationCount is used by -genkeypair
<span class="udiff-line-modified-removed">-         keytool(&quot;-keystore ksgenbadkeyic -genkeypair -alias a -dname CN=A &quot;</span>
<span class="udiff-line-modified-added">+         keytool(&quot;-keystore ksgenbadkeyic -genkeypair -keyalg DSA &quot;</span>
<span class="udiff-line-added">+                 + &quot;-alias a -dname CN=A &quot;</span>
                  + &quot;-storepass changeit &quot;
                  + &quot;-J-Dkeystore.pkcs12.keyPbeIterationCount=abc&quot;)
                  .shouldContain(&quot;keyPbeIterationCount is not a number: abc&quot;)
                  .shouldHaveExitValue(1);
  
</pre>
<center><a href="PBES2Encoding.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="SameDN.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>