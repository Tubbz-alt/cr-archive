<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/jdk/java/io/Serializable/checkModifiers/CheckModifiers.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../badSubstByReplace/BadSubstByReplace.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../class/SerialA_2/A.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/io/Serializable/checkModifiers/CheckModifiers.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 1999, 2010, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 1999, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 34,11 ***</span>
<span class="line-new-header">--- 34,14 ---</span>
   *
   */
  
  import java.io.*;
  class TestClass1 implements Serializable {
<span class="line-added">+     private static final long serialVersionUID = 1L;</span>
<span class="line-added">+ </span>
      // Missing the &quot;final&quot; modifier
<span class="line-added">+     @SuppressWarnings(&quot;serial&quot;) /* Incorrect declarations are being tested */</span>
      private static ObjectStreamField[] serialPersistentFields = {
          new ObjectStreamField(&quot;field1&quot;, Integer.class),
          new ObjectStreamField(&quot;field2&quot;, Double.TYPE),
      };
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 56,11 ***</span>
  
      private void readObject(ObjectInputStream ois)
          throws IOException, ClassNotFoundException {
          ObjectInputStream.GetField pfields = ois.readFields();
  
<span class="line-modified">!         field1 = (Integer) pfields.get(&quot;field1&quot;, new Integer(100));</span>
          field2 = pfields.get(&quot;field2&quot;, 99.99);
  
          /* These fields must be present in the stream */
          try {
              field3 = pfields.get(&quot;field3&quot;, 99);
<span class="line-new-header">--- 59,11 ---</span>
  
      private void readObject(ObjectInputStream ois)
          throws IOException, ClassNotFoundException {
          ObjectInputStream.GetField pfields = ois.readFields();
  
<span class="line-modified">!         field1 = (Integer) pfields.get(&quot;field1&quot;, Integer.valueOf(100));</span>
          field2 = pfields.get(&quot;field2&quot;, 99.99);
  
          /* These fields must be present in the stream */
          try {
              field3 = pfields.get(&quot;field3&quot;, 99);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 77,11 ***</span>
<span class="line-new-header">--- 80,14 ---</span>
      }
  };
  
  
  class TestClass2 implements Serializable {
<span class="line-added">+     private static final long serialVersionUID = 1L;</span>
<span class="line-added">+ </span>
      // public instead of private
<span class="line-added">+     @SuppressWarnings(&quot;serial&quot;) /* Incorrect declarations are being tested */</span>
      public static final ObjectStreamField[] serialPersistentFields = {
          new ObjectStreamField(&quot;field1&quot;, Integer.class),
          new ObjectStreamField(&quot;field2&quot;, Double.TYPE),
      };
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 99,11 ***</span>
  
      private void readObject(ObjectInputStream ois)
          throws IOException, ClassNotFoundException {
          ObjectInputStream.GetField pfields = ois.readFields();
  
<span class="line-modified">!         field1 = (Integer) pfields.get(&quot;field1&quot;, new Integer(100));</span>
          field2 = pfields.get(&quot;field2&quot;, 99.99);
  
          /* These fields must be present in the stream */
          try {
              field3 = pfields.get(&quot;field3&quot;, 99);
<span class="line-new-header">--- 105,11 ---</span>
  
      private void readObject(ObjectInputStream ois)
          throws IOException, ClassNotFoundException {
          ObjectInputStream.GetField pfields = ois.readFields();
  
<span class="line-modified">!         field1 = (Integer) pfields.get(&quot;field1&quot;, Integer.valueOf(100));</span>
          field2 = pfields.get(&quot;field2&quot;, 99.99);
  
          /* These fields must be present in the stream */
          try {
              field3 = pfields.get(&quot;field3&quot;, 99);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 119,11 ***</span>
<span class="line-new-header">--- 125,14 ---</span>
          }
      }
  };
  
  class TestClass3 implements Serializable{
<span class="line-added">+     private static final long serialVersionUID = 1L;</span>
<span class="line-added">+ </span>
      // Not of type ObjectStreamField
<span class="line-added">+     @SuppressWarnings(&quot;serial&quot;) /* Incorrect declarations are being tested */</span>
      private final String[] serialPersistentFields =  {&quot;Foo&quot;,&quot;Foobar&quot;};;
      Integer field1;
      double field2;
      int field3;
      String field4;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 137,11 ***</span>
  
      private void readObject(ObjectInputStream ois)
          throws IOException, ClassNotFoundException {
          ObjectInputStream.GetField pfields = ois.readFields();
  
<span class="line-modified">!         field1 = (Integer) pfields.get(&quot;field1&quot;, new Integer(100));</span>
          field2 = pfields.get(&quot;field2&quot;, 99.99);
          field3 = pfields.get(&quot;field3&quot;, 99);
          field4 = (String) pfields.get(&quot;field4&quot;, &quot;Default string&quot;);
  
          try {
<span class="line-new-header">--- 146,11 ---</span>
  
      private void readObject(ObjectInputStream ois)
          throws IOException, ClassNotFoundException {
          ObjectInputStream.GetField pfields = ois.readFields();
  
<span class="line-modified">!         field1 = (Integer) pfields.get(&quot;field1&quot;, Integer.valueOf(100));</span>
          field2 = pfields.get(&quot;field2&quot;, 99.99);
          field3 = pfields.get(&quot;field3&quot;, 99);
          field4 = (String) pfields.get(&quot;field4&quot;, &quot;Default string&quot;);
  
          try {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 154,10 ***</span>
<span class="line-new-header">--- 163,12 ---</span>
          }
      }
  };
  
  class TestClass4 implements Serializable {
<span class="line-added">+     private static final long serialVersionUID = 1L;</span>
<span class="line-added">+ </span>
      // Correct format
      private static final ObjectStreamField[] serialPersistentFields = {
          new ObjectStreamField(&quot;field1&quot;, Integer.class),
          new ObjectStreamField(&quot;field2&quot;, Double.TYPE),
      };
</pre>
<hr />
<pre>
<span class="line-old-header">*** 176,11 ***</span>
  
      private void readObject(ObjectInputStream ois)
          throws IOException, ClassNotFoundException {
          ObjectInputStream.GetField pfields = ois.readFields();
  
<span class="line-modified">!         field1 = (Integer) pfields.get(&quot;field1&quot;, new Integer(100));</span>
          field2 = pfields.get(&quot;field2&quot;, 99.99);
  
          try {
              field3 = pfields.get(&quot;field3&quot;, 99);
              throw new Error(&quot;data field: field3 in the persistent stream&quot;);
<span class="line-new-header">--- 187,11 ---</span>
  
      private void readObject(ObjectInputStream ois)
          throws IOException, ClassNotFoundException {
          ObjectInputStream.GetField pfields = ois.readFields();
  
<span class="line-modified">!         field1 = (Integer) pfields.get(&quot;field1&quot;, Integer.valueOf(100));</span>
          field2 = pfields.get(&quot;field2&quot;, 99.99);
  
          try {
              field3 = pfields.get(&quot;field3&quot;, 99);
              throw new Error(&quot;data field: field3 in the persistent stream&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 197,20 ***</span>
  };
  
  public class CheckModifiers {
      public static void main(String[] args)
          throws ClassNotFoundException, IOException{
<span class="line-modified">!         TestClass1 tc1 = new TestClass1(new Integer(100), 25.56, 2000,</span>
              new String(&quot;Test modifiers of serialPersistentFields&quot;));
  
<span class="line-modified">!         TestClass2 tc2 = new TestClass2(new Integer(100), 25.56, 2000,</span>
              new String(&quot;Test modifiers of serialPersistentFields&quot;));
  
<span class="line-modified">!         TestClass3 tc3 = new TestClass3(new Integer(100), 25.56, 2000,</span>
              new String(&quot;Test Type of serialPersistentFields&quot;));
  
<span class="line-modified">!         TestClass4 tc4 = new TestClass4(new Integer(100), 25.56, 2000,</span>
              new String(&quot;Test modifiers of serialPersistentFields&quot;));
  
  
          FileOutputStream fos = new FileOutputStream(&quot;fields.ser&quot;);
          try {
<span class="line-new-header">--- 208,20 ---</span>
  };
  
  public class CheckModifiers {
      public static void main(String[] args)
          throws ClassNotFoundException, IOException{
<span class="line-modified">!         TestClass1 tc1 = new TestClass1(100, 25.56, 2000,</span>
              new String(&quot;Test modifiers of serialPersistentFields&quot;));
  
<span class="line-modified">!         TestClass2 tc2 = new TestClass2(100, 25.56, 2000,</span>
              new String(&quot;Test modifiers of serialPersistentFields&quot;));
  
<span class="line-modified">!         TestClass3 tc3 = new TestClass3(100, 25.56, 2000,</span>
              new String(&quot;Test Type of serialPersistentFields&quot;));
  
<span class="line-modified">!         TestClass4 tc4 = new TestClass4(100, 25.56, 2000,</span>
              new String(&quot;Test modifiers of serialPersistentFields&quot;));
  
  
          FileOutputStream fos = new FileOutputStream(&quot;fields.ser&quot;);
          try {
</pre>
<center><a href="../badSubstByReplace/BadSubstByReplace.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../class/SerialA_2/A.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>