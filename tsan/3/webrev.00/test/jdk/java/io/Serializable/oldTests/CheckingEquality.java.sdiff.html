<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/io/Serializable/oldTests/CheckingEquality.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="CheckForException.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="CircularList.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/io/Serializable/oldTests/CheckingEquality.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2005, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
</pre>
<hr />
<pre>
 66         } catch (Exception e) {
 67             System.err.print(&quot;TEST FAILED: &quot;);
 68             e.printStackTrace();
 69 
 70             System.err.println(&quot;\nInput remaining&quot;);
 71             int ch;
 72             try {
 73                 while ((ch = istream.read()) != -1) {
 74                     System.out.print(Integer.toString(ch, 16) + &quot; &quot;);
 75                 }
 76                 System.err.println(&quot;\n&quot;);
 77             } catch (Exception f) {
 78                 throw new Error();
 79             }
 80             throw new Error();
 81         }
 82     }
 83 }
 84 
 85 class Firstpsio implements java.io.Serializable {


 86     String one;
 87     int two;
 88     float three[];
 89 
 90     void init() { /* called only before writing */
 91         one = &quot;one&quot;;
 92         two = 2;
 93         three = new float[5];
 94         float f = 3.0f;
 95         for (int i=0; i&lt;5 ; i++) {
 96             f += 0.11;
 97             three[i] = f;
 98         }
 99     }
100 
101     /* Compare two first objects */
102     boolean equals(Firstpsio other) {
103         boolean ret = true;
104 
105         if (!one.equals(other.one)) {
</pre>
<hr />
<pre>
108             ret = false;
109         }
110         if (two != other.two) {
111             System.err.println(&quot;\nfirstpsio: expected &quot; + two +
112                 &quot; actual &quot; + other.two);
113             ret = false;
114         }
115 
116         for (int i = 0; i &lt; three.length; i++ ) {
117             if (three[i] != other.three[i]) {
118                 System.err.println(&quot;\nfirstpsio: three[&quot; + i + &quot;] expected &quot; +
119                     three[i] + &quot; actual &quot; + other.three[i]);
120                 ret = false;
121             }
122         }
123         return ret;
124     }
125 }
126 
127 class Secondpsio extends Firstpsio  {


128     String quatre;
129     int cinq;
130 
131     private void writeObject(ObjectOutputStream pw) throws IOException {
132         pw.writeObject(quatre);
133         pw.writeInt(cinq);
134     }
135 
136     private void readObject(ObjectInputStream pr)
137         throws StreamCorruptedException, IOException, ClassNotFoundException
138     {
139         if (one == null) {
140             System.err.println(
141                 &quot;\nTEST FAILED: Superclass not serialized when &quot; +
142                 &quot;it should have been&quot;);
143             throw new StreamCorruptedException(&quot;Superclass not serialized &quot; +
144                                                &quot;when it should have been&quot;);
145         }
146 
147         quatre = (String)pr.readObject();
</pre>
<hr />
<pre>
156                 &quot; actual &quot; + other.quatre);
157             ret = false;
158         }
159         if (cinq != other.cinq) {
160             System.err.println(&quot;\nsecondpsio: cinq expected &quot; + cinq +
161                 &quot; actual &quot; + other.cinq);
162             ret = false;
163         }
164         return ret;
165     }
166 
167     /* called only before writing */
168     void init() {
169         quatre = &quot;4444&quot;;
170         cinq = 5;
171         super.init();
172     }
173 }
174 
175 class Thirdpsio extends Secondpsio {

176 
177     static String ign = &quot;ignored&quot;;
178     transient Object oh;
179 
180     int six;
181 
182     private static int seven[];
183     protected byte eight = (byte)9;
184     static final byte dcare = (byte) 128;
185     private short nine = 8888;
186     long ten;
<span class="line-modified">187     java.util.Enumeration zero;</span>

188 
189 
190     boolean equals(Thirdpsio other) {
191         boolean ret = super.equals(other);
192 
193         if (six != other.six) {
194             System.err.println(&quot;\nthirdpsio six &quot; + six +
195                 &quot; actual &quot; + other.six);
196             ret = false;
197         }
198         if (eight != other.eight) {
199             System.err.println(&quot;\nthirdpsio eight - expected &quot; + eight +
200                 &quot; actual &quot; + other.eight);
201             ret = false;
202         }
203         if (nine != other.nine) {
204             System.err.println(&quot;\nthirdpsio nine - expected &quot; + nine +
205                &quot; actual &quot; + other.nine);
206             ret = false;
207         }
</pre>
<hr />
<pre>
210                 &quot; actual &quot; + other.ten);
211             ret = false;
212         }
213         if (zero != other.zero) {
214             System.err.println(&quot;\nthirdpsio zero - expected &quot; + zero +
215                 &quot; actual &quot; + other.zero);
216             ret = false;
217         }
218         return ret;
219     }
220 
221     /* called only before writing */
222     void init() {
223         six = 666;
224 
225         int s7[] = { 7, 7, 7 };
226         seven = s7;
227         eight = (byte)8;
228         nine = (short)9;
229         ten = (long)100000;
<span class="line-modified">230         java.util.Enumeration em = null; /* default */</span>
231 
232         super.init();
233     }
234 }
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2005, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
</pre>
<hr />
<pre>
 66         } catch (Exception e) {
 67             System.err.print(&quot;TEST FAILED: &quot;);
 68             e.printStackTrace();
 69 
 70             System.err.println(&quot;\nInput remaining&quot;);
 71             int ch;
 72             try {
 73                 while ((ch = istream.read()) != -1) {
 74                     System.out.print(Integer.toString(ch, 16) + &quot; &quot;);
 75                 }
 76                 System.err.println(&quot;\n&quot;);
 77             } catch (Exception f) {
 78                 throw new Error();
 79             }
 80             throw new Error();
 81         }
 82     }
 83 }
 84 
 85 class Firstpsio implements java.io.Serializable {
<span class="line-added"> 86     private static final long serialVersionUID = 1L;</span>
<span class="line-added"> 87 </span>
 88     String one;
 89     int two;
 90     float three[];
 91 
 92     void init() { /* called only before writing */
 93         one = &quot;one&quot;;
 94         two = 2;
 95         three = new float[5];
 96         float f = 3.0f;
 97         for (int i=0; i&lt;5 ; i++) {
 98             f += 0.11;
 99             three[i] = f;
100         }
101     }
102 
103     /* Compare two first objects */
104     boolean equals(Firstpsio other) {
105         boolean ret = true;
106 
107         if (!one.equals(other.one)) {
</pre>
<hr />
<pre>
110             ret = false;
111         }
112         if (two != other.two) {
113             System.err.println(&quot;\nfirstpsio: expected &quot; + two +
114                 &quot; actual &quot; + other.two);
115             ret = false;
116         }
117 
118         for (int i = 0; i &lt; three.length; i++ ) {
119             if (three[i] != other.three[i]) {
120                 System.err.println(&quot;\nfirstpsio: three[&quot; + i + &quot;] expected &quot; +
121                     three[i] + &quot; actual &quot; + other.three[i]);
122                 ret = false;
123             }
124         }
125         return ret;
126     }
127 }
128 
129 class Secondpsio extends Firstpsio  {
<span class="line-added">130     private static final long serialVersionUID = 1L;</span>
<span class="line-added">131 </span>
132     String quatre;
133     int cinq;
134 
135     private void writeObject(ObjectOutputStream pw) throws IOException {
136         pw.writeObject(quatre);
137         pw.writeInt(cinq);
138     }
139 
140     private void readObject(ObjectInputStream pr)
141         throws StreamCorruptedException, IOException, ClassNotFoundException
142     {
143         if (one == null) {
144             System.err.println(
145                 &quot;\nTEST FAILED: Superclass not serialized when &quot; +
146                 &quot;it should have been&quot;);
147             throw new StreamCorruptedException(&quot;Superclass not serialized &quot; +
148                                                &quot;when it should have been&quot;);
149         }
150 
151         quatre = (String)pr.readObject();
</pre>
<hr />
<pre>
160                 &quot; actual &quot; + other.quatre);
161             ret = false;
162         }
163         if (cinq != other.cinq) {
164             System.err.println(&quot;\nsecondpsio: cinq expected &quot; + cinq +
165                 &quot; actual &quot; + other.cinq);
166             ret = false;
167         }
168         return ret;
169     }
170 
171     /* called only before writing */
172     void init() {
173         quatre = &quot;4444&quot;;
174         cinq = 5;
175         super.init();
176     }
177 }
178 
179 class Thirdpsio extends Secondpsio {
<span class="line-added">180     private static final long serialVersionUID = 1L;</span>
181 
182     static String ign = &quot;ignored&quot;;
183     transient Object oh;
184 
185     int six;
186 
187     private static int seven[];
188     protected byte eight = (byte)9;
189     static final byte dcare = (byte) 128;
190     private short nine = 8888;
191     long ten;
<span class="line-modified">192     @SuppressWarnings(&quot;serial&quot;) /* Incorrect declarations are being tested */</span>
<span class="line-added">193     java.util.Enumeration&lt;?&gt; zero;</span>
194 
195 
196     boolean equals(Thirdpsio other) {
197         boolean ret = super.equals(other);
198 
199         if (six != other.six) {
200             System.err.println(&quot;\nthirdpsio six &quot; + six +
201                 &quot; actual &quot; + other.six);
202             ret = false;
203         }
204         if (eight != other.eight) {
205             System.err.println(&quot;\nthirdpsio eight - expected &quot; + eight +
206                 &quot; actual &quot; + other.eight);
207             ret = false;
208         }
209         if (nine != other.nine) {
210             System.err.println(&quot;\nthirdpsio nine - expected &quot; + nine +
211                &quot; actual &quot; + other.nine);
212             ret = false;
213         }
</pre>
<hr />
<pre>
216                 &quot; actual &quot; + other.ten);
217             ret = false;
218         }
219         if (zero != other.zero) {
220             System.err.println(&quot;\nthirdpsio zero - expected &quot; + zero +
221                 &quot; actual &quot; + other.zero);
222             ret = false;
223         }
224         return ret;
225     }
226 
227     /* called only before writing */
228     void init() {
229         six = 666;
230 
231         int s7[] = { 7, 7, 7 };
232         seven = s7;
233         eight = (byte)8;
234         nine = (short)9;
235         ten = (long)100000;
<span class="line-modified">236         java.util.Enumeration&lt;?&gt; em = null; /* default */</span>
237 
238         super.init();
239     }
240 }
</pre>
</td>
</tr>
</table>
<center><a href="CheckForException.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="CircularList.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>