<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/jdk/java/net/ipv6tests/UdpTest.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="TcpTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../../nio/Buffer/Basic-X.java.template.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/net/ipv6tests/UdpTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 22,15 ***</span>
   */
  
  /*
   * @test
   * @bug 4868820
<span class="line-modified">!  * @summary IPv6 support for Windows XP and 2003 server</span>
   * @library /test/lib
   * @build jdk.test.lib.NetworkConfiguration
   *        jdk.test.lib.Platform
<span class="line-modified">!  * @run main UdpTest</span>
   */
  
  import java.net.DatagramPacket;
  import java.net.DatagramSocket;
  import java.net.Inet4Address;
<span class="line-new-header">--- 22,18 ---</span>
   */
  
  /*
   * @test
   * @bug 4868820
<span class="line-modified">!  * @key intermittent</span>
<span class="line-added">+  * @summary IPv6 support for Windows XP and 2003 server.</span>
<span class="line-added">+  *          This test requires binding to the wildcard address and as such</span>
<span class="line-added">+  *          may fail intermittently on some platforms.</span>
   * @library /test/lib
   * @build jdk.test.lib.NetworkConfiguration
   *        jdk.test.lib.Platform
<span class="line-modified">!  * @run main UdpTest -d</span>
   */
  
  import java.net.DatagramPacket;
  import java.net.DatagramSocket;
  import java.net.Inet4Address;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 68,10 ***</span>
<span class="line-new-header">--- 71,14 ---</span>
          ia4addr = getFirstLocalIPv4Address ();
      }
  
      public static void main (String[] args) throws Exception {
          checkDebug(args);
<span class="line-added">+         if (ia4addr == null) {</span>
<span class="line-added">+             System.out.println (&quot;No local IPv4 addresses: exiting now&quot;);</span>
<span class="line-added">+             return;</span>
<span class="line-added">+         }</span>
          if (ia6addr == null) {
              System.out.println (&quot;No local IPv6 addresses: exiting now&quot;);
              return;
          }
          dprintln (&quot;Local Addresses&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 86,10 ***</span>
<span class="line-new-header">--- 93,11 ---</span>
      }
  
      /* basic UDP connectivity test using IPv6 only and IPv4/IPv6 together */
  
      static void test1 () throws Exception {
<span class="line-added">+         System.out.println(&quot;Test1 starting&quot;);</span>
          s1 = new DatagramSocket ();
          s2 = new DatagramSocket ();
          simpleDataExchange (s1, ia4addr, s2, ia4addr);
          s1.close (); s2.close ();
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 124,10 ***</span>
<span class="line-new-header">--- 132,11 ---</span>
      }
  
      /* check timeouts on receive */
  
      static void test2 () throws Exception {
<span class="line-added">+         System.out.println(&quot;Test2 starting&quot;);</span>
          s1 = new DatagramSocket ();
          s2 = new DatagramSocket ();
          s1.setSoTimeout (4000);
          long t1 = System.currentTimeMillis();
          try {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 174,10 ***</span>
<span class="line-new-header">--- 183,11 ---</span>
      }
  
      /* check connected sockets */
  
      static void test3 () throws Exception {
<span class="line-added">+         System.out.println(&quot;Test3 starting&quot;);</span>
          s1 = new DatagramSocket ();
          s2 = new DatagramSocket ();
          s1.connect (ia6addr, s2.getLocalPort());
          datagramEcho (s1, s2, null);
          s1.close (); s2.close();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 185,10 ***</span>
<span class="line-new-header">--- 195,11 ---</span>
      }
  
      /* check PortUnreachable */
  
      static void test4 () throws Exception {
<span class="line-added">+         System.out.println(&quot;Test4 starting&quot;);</span>
          s1 = new DatagramSocket ();
          s1.connect (ia6addr, 5000);
          s1.setSoTimeout (3000);
          try {
              DatagramPacket p = new DatagramPacket (&quot;HelloWorld&quot;.getBytes(), &quot;HelloWorld&quot;.length());
</pre>
<center><a href="TcpTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../../nio/Buffer/Basic-X.java.template.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>