diff a/test/jdk/java/net/Socks/SocksProxyVersion.java b/test/jdk/java/net/Socks/SocksProxyVersion.java
--- a/test/jdk/java/net/Socks/SocksProxyVersion.java
+++ b/test/jdk/java/net/Socks/SocksProxyVersion.java
@@ -1,7 +1,7 @@
 /*
- * Copyright (c) 2011, 2015, Oracle and/or its affiliates. All rights reserved.
+ * Copyright (c) 2011, 2019, Oracle and/or its affiliates. All rights reserved.
  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  *
  * This code is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License version 2 only, as
  * published by the Free Software Foundation.
@@ -22,10 +22,11 @@
  */
 
 /*
  * @test
  * @bug 6964547 5001942 8129444
+ * @library /test/lib
  * @run main/othervm SocksProxyVersion
  * @summary test socksProxyVersion system property
  */
 
 import java.net.InetSocketAddress;
@@ -33,10 +34,11 @@
 import java.net.Socket;
 import java.net.SocketException;
 import java.io.IOException;
 import java.net.InetAddress;
 import java.net.Proxy;
+import jdk.test.lib.net.IPSupport;
 
 public class SocksProxyVersion implements Runnable {
     final ServerSocket ss;
     volatile boolean failed;
     volatile boolean stopped = false;
@@ -49,11 +51,11 @@
         }
         new SocksProxyVersion();
     }
 
     public SocksProxyVersion() throws Exception {
-        ss = new ServerSocket(0);
+        ss = new ServerSocket(0, 0, InetAddress.getLocalHost());
         int port = ss.getLocalPort();
         Thread serverThread = new Thread(this);
         serverThread.start();
         try (ServerSocket socket = ss) {
             runTest(port);
@@ -78,18 +80,20 @@
         System.setProperty("socksProxyPort", Integer.toString(port));
 
         Proxy proxy = new Proxy(Proxy.Type.SOCKS,
                                 new InetSocketAddress(addr, port));
 
-        // SOCKS V4
-        System.setProperty("socksProxyVersion", Integer.toString(4));
-        this.expected = 4;
-        check(new Socket(), addr, port);
-        check(new Socket(proxy), addr, port);
+        if (IPSupport.hasIPv4()) {
+            // SOCKS V4 (requires IPv4)
+            System.setProperty("socksProxyVersion", "4");
+            this.expected = 4;
+            check(new Socket(), addr, port);
+            check(new Socket(proxy), addr, port);
+        }
 
         // SOCKS V5
-        System.setProperty("socksProxyVersion", Integer.toString(5));
+        System.setProperty("socksProxyVersion", "5");
         this.expected = 5;
         check(new Socket(), addr, port);
         check(new Socket(proxy), addr, port);
     }
 
