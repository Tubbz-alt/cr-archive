diff a/test/jdk/java/net/Socket/UrgentDataTest.java b/test/jdk/java/net/Socket/UrgentDataTest.java
--- a/test/jdk/java/net/Socket/UrgentDataTest.java
+++ b/test/jdk/java/net/Socket/UrgentDataTest.java
@@ -22,17 +22,19 @@
  */
 
 /*
  * @test
  * @bug 4092038
+ * @library /test/lib
  * @summary TCP Urgent data support
  * @run main UrgentDataTest
  * @run main/othervm -Djava.net.preferIPv4Stack=true UrgentDataTest
  */
 
 import java.net.*;
 import java.io.*;
+import jdk.test.lib.net.IPSupport;
 
 public class UrgentDataTest {
 
     Object opref;
     boolean isClient, isServer;
@@ -49,17 +51,21 @@
         System.out.println ("   usage: java UrgentDataTest -client host port <runs client and connects to"+
             " specified server>");
     }
 
     public static void main (String args[]) {
+        IPSupport.throwSkippedExceptionIfNonOperational();
+
         try {
             UrgentDataTest test = new UrgentDataTest ();
             if (args.length == 0) {
-                test.listener = new ServerSocket (0);
+                InetAddress loopback = InetAddress.getLoopbackAddress();
+                test.listener = new ServerSocket ();
+                test.listener.bind(new InetSocketAddress(loopback, 0));
                 test.isClient = true;
                 test.isServer = true;
-                test.clHost = InetAddress.getLoopbackAddress().getHostAddress();
+                test.clHost = loopback.getHostAddress();
                 test.clPort = test.listener.getLocalPort();
                 test.run();
             } else if (args[0].equals ("-server")) {
                 test.listener = new ServerSocket (0);
                 System.out.println ("Server listening on port " + test.listener.getLocalPort());
