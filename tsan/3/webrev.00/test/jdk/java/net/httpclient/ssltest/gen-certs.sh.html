<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New test/jdk/java/net/httpclient/ssltest/gen-certs.sh</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
  <body>
    <pre>
 1 # Copyright (c) 2020, Oracle and/or its affiliates. All rights reserved.
 2 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 3 #
 4 # This code is free software; you can redistribute it and/or modify it
 5 # under the terms of the GNU General Public License version 2 only, as
 6 # published by the Free Software Foundation.
 7 #
 8 # This code is distributed in the hope that it will be useful, but WITHOUT
 9 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
10 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
11 # version 2 for more details (a copy is included in the LICENSE file that
12 # accompanied this code).
13 #
14 # You should have received a copy of the GNU General Public License version
15 # 2 along with this work; if not, write to the Free Software Foundation,
16 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
17 #
18 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
19 # or visit www.oracle.com if you need additional information or have any
20 # questions.
21 
22 # Generate OpenSSL configuration file
23 echo &quot;[req]&quot; &gt; openssl.conf
24 echo &quot;distinguished_name = dn&quot; &gt;&gt; openssl.conf
25 echo &quot;x509_extensions = v3_ext&quot; &gt;&gt; openssl.conf
26 echo &quot;[dn]&quot; &gt;&gt; openssl.conf
27 echo &quot;[v3_ext]&quot; &gt;&gt; openssl.conf
28 echo &quot;subjectKeyIdentifier = hash&quot; &gt;&gt; openssl.conf
29 echo &quot;authorityKeyIdentifier = keyid&quot; &gt;&gt; openssl.conf
30 echo &quot;basicConstraints = critical,CA:FALSE&quot; &gt;&gt; openssl.conf
31 
32 # Generate X.509 version 3 extension file
33 echo &quot;subjectKeyIdentifier = hash&quot; &gt; v3.ext
34 echo &quot;authorityKeyIdentifier = keyid,issuer&quot; &gt;&gt; v3.ext
35 
36 # Generate good cert
37 openssl genpkey -algorithm rsa -pkeyopt rsa_keygen_bits:2048 -pkeyopt rsa_keygen_pubexp:65537 -out good.key
38 openssl req -config openssl.conf -new -key good.key -subj &quot;/CN=localhost&quot; -sha256 -out good.csr
39 openssl x509 -extfile v3.ext -req -CAcreateserial -days 3650 -in good.csr -sha256 -signkey good.key -out good.cer
40 
41 # Generate bad cert
42 openssl genpkey -algorithm rsa -pkeyopt rsa_keygen_bits:2048 -pkeyopt rsa_keygen_pubexp:65537 -out bad.key
43 openssl req -config openssl.conf -new -key bad.key -subj &quot;/CN=evil&quot; -sha256 -out bad.csr
44 openssl x509 -extfile v3.ext -req -CAcreateserial -days 3650 -in bad.csr -sha256 -signkey bad.key -out bad.cer
45 
46 # Generate loopback cert with subject alternative name
47 echo &quot;subjectAltName = @alt_names&quot; &gt;&gt; v3.ext
48 echo &quot;[alt_names]&quot; &gt;&gt; v3.ext
49 echo &quot;IP.1 = 127.0.0.1&quot; &gt;&gt; v3.ext
50 
51 openssl genpkey -algorithm rsa -pkeyopt rsa_keygen_bits:2048 -pkeyopt rsa_keygen_pubexp:65537 -out loopback.key
52 openssl req -config openssl.conf -new -key loopback.key -subj &quot;/CN=unknown&quot; -sha256 -out loopback.csr
53 openssl x509 -extfile v3.ext -req -CAcreateserial -days 3650 -in loopback.csr -sha256 -signkey loopback.key -out loopback.cer
    </pre>
  </body>
</html>