<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/net/httpclient/whitebox/java.net.http/jdk/internal/net/http/Http1HeaderParserTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ConnectionPoolTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../ipv6tests/B6521014.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/net/httpclient/whitebox/java.net.http/jdk/internal/net/http/Http1HeaderParserTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
358         assertEquals(decoderMap1, decoderMap2, &quot;decoder maps not equal&quot;);
359 
360     }
361 
362     @DataProvider(name = &quot;errors&quot;)
363     public Object[][] errors() {
364         List&lt;String&gt; responses = new ArrayList&lt;&gt;();
365 
366         // These responses are parsed, somewhat, by MessageHeaders but give
367         // nonsensible results. They, correctly, fail with the Http1HeaderParser.
368         String[] bad =
369            {// &quot;HTTP/1.1 402 Payment Required\r\n&quot; +
370             // &quot;Content-Length: 65\r\n\r&quot;,   // missing trailing LF   //TODO: incomplete
371 
372              &quot;HTTP/1.1 402 Payment Required\r\n&quot; +
373              &quot;Content-Length: 65\r\n\rT\r\n\r\nGGGGGG&quot;,
374 
375              &quot;HTTP/1.1 200OK\r\n\rT&quot;,
376 
377              &quot;HTTP/1.1 200OK\rT&quot;,











378            };
379         Arrays.stream(bad).forEach(responses::add);
380 
381         return responses.stream().map(p -&gt; new Object[] { p }).toArray(Object[][]::new);
382     }
383 
384     @Test(dataProvider = &quot;errors&quot;, expectedExceptions = ProtocolException.class)
385     public void errors(String respString) throws ProtocolException {
386         byte[] bytes = respString.getBytes(US_ASCII);
387         Http1HeaderParser decoder = new Http1HeaderParser();
388         ByteBuffer b = ByteBuffer.wrap(bytes);
389         decoder.parse(b);
390     }
391 
392     void assertHeadersEqual(Map&lt;String,List&lt;String&gt;&gt; expected,
393                             Map&lt;String,List&lt;String&gt;&gt; actual,
394                             String msg) {
395 
396         if (expected.equals(actual))
397             return;
</pre>
</td>
<td>
<hr />
<pre>
358         assertEquals(decoderMap1, decoderMap2, &quot;decoder maps not equal&quot;);
359 
360     }
361 
362     @DataProvider(name = &quot;errors&quot;)
363     public Object[][] errors() {
364         List&lt;String&gt; responses = new ArrayList&lt;&gt;();
365 
366         // These responses are parsed, somewhat, by MessageHeaders but give
367         // nonsensible results. They, correctly, fail with the Http1HeaderParser.
368         String[] bad =
369            {// &quot;HTTP/1.1 402 Payment Required\r\n&quot; +
370             // &quot;Content-Length: 65\r\n\r&quot;,   // missing trailing LF   //TODO: incomplete
371 
372              &quot;HTTP/1.1 402 Payment Required\r\n&quot; +
373              &quot;Content-Length: 65\r\n\rT\r\n\r\nGGGGGG&quot;,
374 
375              &quot;HTTP/1.1 200OK\r\n\rT&quot;,
376 
377              &quot;HTTP/1.1 200OK\rT&quot;,
<span class="line-added">378 </span>
<span class="line-added">379              &quot;HTTP/1.0 FOO\r\n&quot;,</span>
<span class="line-added">380 </span>
<span class="line-added">381              &quot;HTTP/1.1 BAR\r\n&quot;,</span>
<span class="line-added">382 </span>
<span class="line-added">383              &quot;HTTP/1.1 +99\r\n&quot;,</span>
<span class="line-added">384 </span>
<span class="line-added">385              &quot;HTTP/1.1 -22\r\n&quot;,</span>
<span class="line-added">386 </span>
<span class="line-added">387              &quot;HTTP/1.1 -20 \r\n&quot;</span>
<span class="line-added">388 </span>
389            };
390         Arrays.stream(bad).forEach(responses::add);
391 
392         return responses.stream().map(p -&gt; new Object[] { p }).toArray(Object[][]::new);
393     }
394 
395     @Test(dataProvider = &quot;errors&quot;, expectedExceptions = ProtocolException.class)
396     public void errors(String respString) throws ProtocolException {
397         byte[] bytes = respString.getBytes(US_ASCII);
398         Http1HeaderParser decoder = new Http1HeaderParser();
399         ByteBuffer b = ByteBuffer.wrap(bytes);
400         decoder.parse(b);
401     }
402 
403     void assertHeadersEqual(Map&lt;String,List&lt;String&gt;&gt; expected,
404                             Map&lt;String,List&lt;String&gt;&gt; actual,
405                             String msg) {
406 
407         if (expected.equals(actual))
408             return;
</pre>
</td>
</tr>
</table>
<center><a href="ConnectionPoolTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../ipv6tests/B6521014.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>