<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames test/jdk/java/net/httpclient/websocket/Abort.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 /*
 25  * @test
 26  * @build DummyWebSocketServer
 27  * @run testng/othervm
 28  *      -Djdk.internal.httpclient.websocket.debug=true
 29  *       Abort
 30  */
 31 
<a name="2" id="anc2"></a><span class="line-removed"> 32 import org.testng.annotations.AfterTest;</span>
 33 import org.testng.annotations.Test;
 34 
 35 import java.io.IOException;
 36 import java.net.ProtocolException;
 37 import java.net.http.WebSocket;
 38 import java.nio.ByteBuffer;
 39 import java.util.Arrays;
 40 import java.util.List;
 41 import java.util.concurrent.CompletableFuture;
 42 import java.util.concurrent.CompletionStage;
 43 import java.util.concurrent.TimeUnit;
 44 import java.util.concurrent.TimeoutException;
 45 
 46 import static java.net.http.HttpClient.newHttpClient;
 47 import static java.net.http.WebSocket.NORMAL_CLOSURE;
 48 import static org.testng.Assert.assertEquals;
 49 import static org.testng.Assert.assertThrows;
 50 import static org.testng.Assert.assertTrue;
 51 import static org.testng.Assert.fail;
 52 
 53 public class Abort {
 54 
 55     private static final Class&lt;NullPointerException&gt; NPE = NullPointerException.class;
 56     private static final Class&lt;IllegalArgumentException&gt; IAE = IllegalArgumentException.class;
 57     private static final Class&lt;IOException&gt; IOE = IOException.class;
 58 
<a name="3" id="anc3"></a><span class="line-removed"> 59     private DummyWebSocketServer server;</span>
<span class="line-removed"> 60     private WebSocket webSocket;</span>
<span class="line-removed"> 61 </span>
<span class="line-removed"> 62     @AfterTest</span>
<span class="line-removed"> 63     public void cleanup() {</span>
<span class="line-removed"> 64         server.close();</span>
<span class="line-removed"> 65         webSocket.abort();</span>
<span class="line-removed"> 66     }</span>
 67 
 68     @Test
 69     public void onOpenThenAbort() throws Exception {
 70         int[] bytes = new int[]{
 71                 0x88, 0x00, // opcode=close
 72         };
<a name="4" id="anc4"></a><span class="line-modified"> 73         server = Support.serverWithCannedData(bytes);</span>
<span class="line-modified"> 74         server.open();</span>
<span class="line-modified"> 75         // messages are available</span>
<span class="line-modified"> 76         MockListener listener = new MockListener() {</span>
<span class="line-modified"> 77             @Override</span>
<span class="line-modified"> 78             protected void onOpen0(WebSocket webSocket) {</span>
<span class="line-modified"> 79                 // unbounded request</span>
<span class="line-modified"> 80                 webSocket.request(Long.MAX_VALUE);</span>












 81                 webSocket.abort();
 82             }
<a name="5" id="anc5"></a><span class="line-modified"> 83         };</span>
<span class="line-removed"> 84         webSocket = newHttpClient().newWebSocketBuilder()</span>
<span class="line-removed"> 85                 .buildAsync(server.getURI(), listener)</span>
<span class="line-removed"> 86                 .join();</span>
<span class="line-removed"> 87         TimeUnit.SECONDS.sleep(5);</span>
<span class="line-removed"> 88         List&lt;MockListener.Invocation&gt; inv = listener.invocationsSoFar();</span>
<span class="line-removed"> 89         // no more invocations after onOpen as WebSocket was aborted</span>
<span class="line-removed"> 90         assertEquals(inv, List.of(MockListener.Invocation.onOpen(webSocket)));</span>
 91     }
 92 
 93     @Test
 94     public void onOpenThenOnTextThenAbort() throws Exception {
 95         int[] bytes = new int[]{
 96                 0x81, 0x00, // opcode=text, fin=true
 97                 0x88, 0x00, // opcode=close
 98         };
<a name="6" id="anc6"></a><span class="line-modified"> 99         server = Support.serverWithCannedData(bytes);</span>
<span class="line-modified">100         server.open();</span>
<span class="line-modified">101         MockListener listener = new MockListener() {</span>
<span class="line-modified">102             @Override</span>
<span class="line-modified">103             protected void onOpen0(WebSocket webSocket) {</span>
<span class="line-modified">104                 // unbounded request</span>
<span class="line-modified">105                 webSocket.request(Long.MAX_VALUE);</span>
<span class="line-modified">106             }</span>
107 
<a name="7" id="anc7"></a><span class="line-modified">108             @Override</span>
<span class="line-modified">109             protected CompletionStage&lt;?&gt; onText0(WebSocket webSocket,</span>
<span class="line-modified">110                                                  CharSequence message,</span>
<span class="line-modified">111                                                  boolean last) {</span>
















112                 webSocket.abort();
<a name="8" id="anc8"></a><span class="line-removed">113                 return super.onText0(webSocket, message, last);</span>
114             }
<a name="9" id="anc9"></a><span class="line-modified">115         };</span>
<span class="line-removed">116         webSocket = newHttpClient().newWebSocketBuilder()</span>
<span class="line-removed">117                 .buildAsync(server.getURI(), listener)</span>
<span class="line-removed">118                 .join();</span>
<span class="line-removed">119         TimeUnit.SECONDS.sleep(5);</span>
<span class="line-removed">120         List&lt;MockListener.Invocation&gt; inv = listener.invocationsSoFar();</span>
<span class="line-removed">121         // no more invocations after onOpen, onBinary as WebSocket was aborted</span>
<span class="line-removed">122         List&lt;MockListener.Invocation&gt; expected = List.of(</span>
<span class="line-removed">123                 MockListener.Invocation.onOpen(webSocket),</span>
<span class="line-removed">124                 MockListener.Invocation.onText(webSocket, &quot;&quot;, true));</span>
<span class="line-removed">125         assertEquals(inv, expected);</span>
126     }
127 
128     @Test
129     public void onOpenThenOnBinaryThenAbort() throws Exception {
130         int[] bytes = new int[]{
131                 0x82, 0x00, // opcode=binary, fin=true
132                 0x88, 0x00, // opcode=close
133         };
<a name="10" id="anc10"></a><span class="line-modified">134         server = Support.serverWithCannedData(bytes);</span>
<span class="line-modified">135         server.open();</span>
<span class="line-modified">136         MockListener listener = new MockListener() {</span>
<span class="line-modified">137             @Override</span>
<span class="line-modified">138             protected void onOpen0(WebSocket webSocket) {</span>
<span class="line-modified">139                 // unbounded request</span>
<span class="line-modified">140                 webSocket.request(Long.MAX_VALUE);</span>
<span class="line-modified">141             }</span>
142 
<a name="11" id="anc11"></a><span class="line-modified">143             @Override</span>
<span class="line-modified">144             protected CompletionStage&lt;?&gt; onBinary0(WebSocket webSocket,</span>
<span class="line-modified">145                                                    ByteBuffer message,</span>
<span class="line-modified">146                                                    boolean last) {</span>
















147                 webSocket.abort();
<a name="12" id="anc12"></a><span class="line-removed">148                 return super.onBinary0(webSocket, message, last);</span>
149             }
<a name="13" id="anc13"></a><span class="line-modified">150         };</span>
<span class="line-removed">151         webSocket = newHttpClient().newWebSocketBuilder()</span>
<span class="line-removed">152                 .buildAsync(server.getURI(), listener)</span>
<span class="line-removed">153                 .join();</span>
<span class="line-removed">154         TimeUnit.SECONDS.sleep(5);</span>
<span class="line-removed">155         List&lt;MockListener.Invocation&gt; inv = listener.invocationsSoFar();</span>
<span class="line-removed">156         // no more invocations after onOpen, onBinary as WebSocket was aborted</span>
<span class="line-removed">157         List&lt;MockListener.Invocation&gt; expected = List.of(</span>
<span class="line-removed">158                 MockListener.Invocation.onOpen(webSocket),</span>
<span class="line-removed">159                 MockListener.Invocation.onBinary(webSocket, ByteBuffer.allocate(0), true));</span>
<span class="line-removed">160         assertEquals(inv, expected);</span>
161     }
162 
163     @Test
164     public void onOpenThenOnPingThenAbort() throws Exception {
165         int[] bytes = {
166                 0x89, 0x00, // opcode=ping
167                 0x88, 0x00, // opcode=close
168         };
<a name="14" id="anc14"></a><span class="line-modified">169         server = Support.serverWithCannedData(bytes);</span>
<span class="line-modified">170         server.open();</span>
<span class="line-modified">171         MockListener listener = new MockListener() {</span>
<span class="line-modified">172             @Override</span>
<span class="line-modified">173             protected void onOpen0(WebSocket webSocket) {</span>
<span class="line-modified">174                 // unbounded request</span>
<span class="line-modified">175                 webSocket.request(Long.MAX_VALUE);</span>
<span class="line-modified">176             }</span>
177 
<a name="15" id="anc15"></a><span class="line-modified">178             @Override</span>
<span class="line-modified">179             protected CompletionStage&lt;?&gt; onPing0(WebSocket webSocket,</span>
<span class="line-modified">180                                                  ByteBuffer message) {</span>
















181                 webSocket.abort();
<a name="16" id="anc16"></a><span class="line-removed">182                 return super.onPing0(webSocket, message);</span>
183             }
<a name="17" id="anc17"></a><span class="line-modified">184         };</span>
<span class="line-removed">185         webSocket = newHttpClient().newWebSocketBuilder()</span>
<span class="line-removed">186                 .buildAsync(server.getURI(), listener)</span>
<span class="line-removed">187                 .join();</span>
<span class="line-removed">188         TimeUnit.SECONDS.sleep(5);</span>
<span class="line-removed">189         List&lt;MockListener.Invocation&gt; inv = listener.invocationsSoFar();</span>
<span class="line-removed">190         // no more invocations after onOpen, onPing as WebSocket was aborted</span>
<span class="line-removed">191         List&lt;MockListener.Invocation&gt; expected = List.of(</span>
<span class="line-removed">192                 MockListener.Invocation.onOpen(webSocket),</span>
<span class="line-removed">193                 MockListener.Invocation.onPing(webSocket, ByteBuffer.allocate(0)));</span>
<span class="line-removed">194         assertEquals(inv, expected);</span>
195     }
196 
197     @Test
198     public void onOpenThenOnPongThenAbort() throws Exception {
199         int[] bytes = {
200                 0x8a, 0x00, // opcode=pong
201                 0x88, 0x00, // opcode=close
202         };
<a name="18" id="anc18"></a><span class="line-modified">203         server = Support.serverWithCannedData(bytes);</span>
<span class="line-modified">204         server.open();</span>
<span class="line-modified">205         MockListener listener = new MockListener() {</span>
<span class="line-modified">206             @Override</span>
<span class="line-modified">207             protected void onOpen0(WebSocket webSocket) {</span>
<span class="line-modified">208                 // unbounded request</span>
<span class="line-modified">209                 webSocket.request(Long.MAX_VALUE);</span>
<span class="line-modified">210             }</span>
211 
<a name="19" id="anc19"></a><span class="line-modified">212             @Override</span>
<span class="line-modified">213             protected CompletionStage&lt;?&gt; onPong0(WebSocket webSocket,</span>
<span class="line-modified">214                                                  ByteBuffer message) {</span>
















215                 webSocket.abort();
<a name="20" id="anc20"></a><span class="line-removed">216                 return super.onPong0(webSocket, message);</span>
217             }
<a name="21" id="anc21"></a><span class="line-modified">218         };</span>
<span class="line-removed">219         webSocket = newHttpClient().newWebSocketBuilder()</span>
<span class="line-removed">220                 .buildAsync(server.getURI(), listener)</span>
<span class="line-removed">221                 .join();</span>
<span class="line-removed">222         TimeUnit.SECONDS.sleep(5);</span>
<span class="line-removed">223         List&lt;MockListener.Invocation&gt; inv = listener.invocationsSoFar();</span>
<span class="line-removed">224         // no more invocations after onOpen, onPong as WebSocket was aborted</span>
<span class="line-removed">225         List&lt;MockListener.Invocation&gt; expected = List.of(</span>
<span class="line-removed">226                 MockListener.Invocation.onOpen(webSocket),</span>
<span class="line-removed">227                 MockListener.Invocation.onPong(webSocket, ByteBuffer.allocate(0)));</span>
<span class="line-removed">228         assertEquals(inv, expected);</span>
229     }
230 
231     @Test
232     public void onOpenThenOnCloseThenAbort() throws Exception {
233         int[] bytes = {
234                 0x88, 0x00, // opcode=close
235                 0x8a, 0x00, // opcode=pong
236         };
<a name="22" id="anc22"></a><span class="line-modified">237         server = Support.serverWithCannedData(bytes);</span>
<span class="line-modified">238         server.open();</span>
<span class="line-modified">239         MockListener listener = new MockListener() {</span>
<span class="line-modified">240             @Override</span>
<span class="line-modified">241             protected void onOpen0(WebSocket webSocket) {</span>
<span class="line-modified">242                 // unbounded request</span>
<span class="line-modified">243                 webSocket.request(Long.MAX_VALUE);</span>
<span class="line-modified">244             }</span>
245 
<a name="23" id="anc23"></a><span class="line-modified">246             @Override</span>
<span class="line-modified">247             protected CompletionStage&lt;?&gt; onClose0(WebSocket webSocket,</span>
<span class="line-modified">248                                                   int statusCode,</span>
<span class="line-modified">249                                                   String reason) {</span>
















250                 webSocket.abort();
<a name="24" id="anc24"></a><span class="line-removed">251                 return super.onClose0(webSocket, statusCode, reason);</span>
252             }
<a name="25" id="anc25"></a><span class="line-modified">253         };</span>
<span class="line-removed">254         webSocket = newHttpClient().newWebSocketBuilder()</span>
<span class="line-removed">255                 .buildAsync(server.getURI(), listener)</span>
<span class="line-removed">256                 .join();</span>
<span class="line-removed">257         TimeUnit.SECONDS.sleep(5);</span>
<span class="line-removed">258         List&lt;MockListener.Invocation&gt; inv = listener.invocationsSoFar();</span>
<span class="line-removed">259         // no more invocations after onOpen, onClose</span>
<span class="line-removed">260         List&lt;MockListener.Invocation&gt; expected = List.of(</span>
<span class="line-removed">261                 MockListener.Invocation.onOpen(webSocket),</span>
<span class="line-removed">262                 MockListener.Invocation.onClose(webSocket, 1005, &quot;&quot;));</span>
<span class="line-removed">263         assertEquals(inv, expected);</span>
264     }
265 
266     @Test
267     public void onOpenThenOnErrorThenAbort() throws Exception {
268         // A header of 128 bytes long Ping (which is a protocol error)
269         int[] badPingHeader = new int[]{0x89, 0x7e, 0x00, 0x80};
270         int[] closeMessage = new int[]{0x88, 0x00};
271         int[] bytes = new int[badPingHeader.length + 128 + closeMessage.length];
272         System.arraycopy(badPingHeader, 0, bytes, 0, badPingHeader.length);
273         System.arraycopy(closeMessage, 0, bytes, badPingHeader.length + 128, closeMessage.length);
<a name="26" id="anc26"></a><span class="line-modified">274         server = Support.serverWithCannedData(bytes);</span>
<span class="line-modified">275         server.open();</span>
<span class="line-modified">276         MockListener listener = new MockListener() {</span>
<span class="line-modified">277             @Override</span>
<span class="line-modified">278             protected void onOpen0(WebSocket webSocket) {</span>
<span class="line-modified">279                 // unbounded request</span>
<span class="line-modified">280                 webSocket.request(Long.MAX_VALUE);</span>
<span class="line-modified">281             }</span>
282 
<a name="27" id="anc27"></a><span class="line-modified">283             @Override</span>
<span class="line-modified">284             protected void onError0(WebSocket webSocket, Throwable error) {</span>

















285                 webSocket.abort();
<a name="28" id="anc28"></a><span class="line-removed">286                 super.onError0(webSocket, error);</span>
287             }
<a name="29" id="anc29"></a><span class="line-modified">288         };</span>
<span class="line-removed">289         webSocket = newHttpClient().newWebSocketBuilder()</span>
<span class="line-removed">290                 .buildAsync(server.getURI(), listener)</span>
<span class="line-removed">291                 .join();</span>
<span class="line-removed">292         TimeUnit.SECONDS.sleep(5);</span>
<span class="line-removed">293         List&lt;MockListener.Invocation&gt; inv = listener.invocationsSoFar();</span>
<span class="line-removed">294         // no more invocations after onOpen, onError</span>
<span class="line-removed">295         List&lt;MockListener.Invocation&gt; expected = List.of(</span>
<span class="line-removed">296                 MockListener.Invocation.onOpen(webSocket),</span>
<span class="line-removed">297                 MockListener.Invocation.onError(webSocket, ProtocolException.class));</span>
<span class="line-removed">298         System.out.println(&quot;actual invocations:&quot; + Arrays.toString(inv.toArray()));</span>
<span class="line-removed">299         assertEquals(inv, expected);</span>
300     }
301 
302     @Test
303     public void immediateAbort() throws Exception {
304         CompletableFuture&lt;Void&gt; messageReceived = new CompletableFuture&lt;&gt;();
305         WebSocket.Listener listener = new WebSocket.Listener() {
306 
307             @Override
308             public void onOpen(WebSocket webSocket) {
309                 /* no initial request */
310             }
311 
312             @Override
313             public CompletionStage&lt;?&gt; onText(WebSocket webSocket,
314                                              CharSequence message,
315                                              boolean last) {
316                 messageReceived.complete(null);
317                 return null;
318             }
319 
320             @Override
321             public CompletionStage&lt;?&gt; onBinary(WebSocket webSocket,
322                                                ByteBuffer message,
323                                                boolean last) {
324                 messageReceived.complete(null);
325                 return null;
326             }
327 
328             @Override
329             public CompletionStage&lt;?&gt; onPing(WebSocket webSocket,
330                                              ByteBuffer message) {
331                 messageReceived.complete(null);
332                 return null;
333             }
334 
335             @Override
336             public CompletionStage&lt;?&gt; onPong(WebSocket webSocket,
337                                              ByteBuffer message) {
338                 messageReceived.complete(null);
339                 return null;
340             }
341 
342             @Override
343             public CompletionStage&lt;?&gt; onClose(WebSocket webSocket,
344                                               int statusCode,
345                                               String reason) {
346                 messageReceived.complete(null);
347                 return null;
348             }
349         };
350 
351         int[] bytes = new int[]{
352                 0x82, 0x00, // opcode=binary, fin=true
353                 0x88, 0x00, // opcode=close
354         };
<a name="30" id="anc30"></a><span class="line-modified">355         server = Support.serverWithCannedData(bytes);</span>
<span class="line-modified">356         server.open();</span>
357 
<a name="31" id="anc31"></a><span class="line-modified">358         WebSocket ws = newHttpClient()</span>
<span class="line-modified">359                 .newWebSocketBuilder()</span>
<span class="line-modified">360                 .buildAsync(server.getURI(), listener)</span>
<span class="line-modified">361                 .join();</span>
<span class="line-modified">362         for (int i = 0; i &lt; 3; i++) {</span>
<span class="line-modified">363             System.out.printf(&quot;iteration #%s%n&quot;, i);</span>
<span class="line-modified">364             // after the first abort() each consecutive one must be a no-op,</span>
<span class="line-modified">365             // moreover, query methods should continue to return consistent</span>
<span class="line-modified">366             // values</span>
<span class="line-modified">367             for (int j = 0; j &lt; 3; j++) {</span>
<span class="line-modified">368                 System.out.printf(&quot;abort #%s%n&quot;, j);</span>
















































369                 ws.abort();
<a name="32" id="anc32"></a><span class="line-removed">370                 assertTrue(ws.isInputClosed());</span>
<span class="line-removed">371                 assertTrue(ws.isOutputClosed());</span>
<span class="line-removed">372                 assertEquals(ws.getSubprotocol(), &quot;&quot;);</span>
<span class="line-removed">373             }</span>
<span class="line-removed">374             // at this point valid requests MUST be a no-op:</span>
<span class="line-removed">375             for (int j = 0; j &lt; 3; j++) {</span>
<span class="line-removed">376                 System.out.printf(&quot;request #%s%n&quot;, j);</span>
<span class="line-removed">377                 ws.request(1);</span>
<span class="line-removed">378                 ws.request(2);</span>
<span class="line-removed">379                 ws.request(8);</span>
<span class="line-removed">380                 ws.request(Integer.MAX_VALUE);</span>
<span class="line-removed">381                 ws.request(Long.MAX_VALUE);</span>
<span class="line-removed">382                 // invalid requests MUST throw IAE:</span>
<span class="line-removed">383                 assertThrows(IAE, () -&gt; ws.request(Integer.MIN_VALUE));</span>
<span class="line-removed">384                 assertThrows(IAE, () -&gt; ws.request(Long.MIN_VALUE));</span>
<span class="line-removed">385                 assertThrows(IAE, () -&gt; ws.request(-1));</span>
<span class="line-removed">386                 assertThrows(IAE, () -&gt; ws.request(0));</span>
387             }
388         }
<a name="33" id="anc33"></a><span class="line-removed">389         // even though there is a bunch of messages readily available on the</span>
<span class="line-removed">390         // wire we shouldn&#39;t have received any of them as we aborted before</span>
<span class="line-removed">391         // the first request</span>
<span class="line-removed">392         try {</span>
<span class="line-removed">393             messageReceived.get(5, TimeUnit.SECONDS);</span>
<span class="line-removed">394             fail();</span>
<span class="line-removed">395         } catch (TimeoutException expected) {</span>
<span class="line-removed">396             System.out.println(&quot;Finished waiting&quot;);</span>
<span class="line-removed">397         }</span>
<span class="line-removed">398         for (int i = 0; i &lt; 3; i++) {</span>
<span class="line-removed">399             System.out.printf(&quot;send #%s%n&quot;, i);</span>
<span class="line-removed">400             Support.assertFails(IOE, ws.sendText(&quot;text!&quot;, false));</span>
<span class="line-removed">401             Support.assertFails(IOE, ws.sendText(&quot;text!&quot;, true));</span>
<span class="line-removed">402             Support.assertFails(IOE, ws.sendBinary(ByteBuffer.allocate(16), false));</span>
<span class="line-removed">403             Support.assertFails(IOE, ws.sendBinary(ByteBuffer.allocate(16), true));</span>
<span class="line-removed">404             Support.assertFails(IOE, ws.sendPing(ByteBuffer.allocate(16)));</span>
<span class="line-removed">405             Support.assertFails(IOE, ws.sendPong(ByteBuffer.allocate(16)));</span>
<span class="line-removed">406             Support.assertFails(IOE, ws.sendClose(NORMAL_CLOSURE, &quot;a reason&quot;));</span>
<span class="line-removed">407             assertThrows(NPE, () -&gt; ws.sendText(null, false));</span>
<span class="line-removed">408             assertThrows(NPE, () -&gt; ws.sendText(null, true));</span>
<span class="line-removed">409             assertThrows(NPE, () -&gt; ws.sendBinary(null, false));</span>
<span class="line-removed">410             assertThrows(NPE, () -&gt; ws.sendBinary(null, true));</span>
<span class="line-removed">411             assertThrows(NPE, () -&gt; ws.sendPing(null));</span>
<span class="line-removed">412             assertThrows(NPE, () -&gt; ws.sendPong(null));</span>
<span class="line-removed">413             assertThrows(NPE, () -&gt; ws.sendClose(NORMAL_CLOSURE, null));</span>
<span class="line-removed">414         }</span>
415     }
416 }
<a name="34" id="anc34"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="34" type="hidden" />
</body>
</html>