<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old test/jdk/java/lang/Character/CheckUnicode.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2018, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 /**
 27  * @test
 28  * @bug      4114080 6565620 6959267 7070436 7198195 8032446 8072600
 29  * @summary  Make sure the attributes of Unicode characters, as
 30  * returned by the Character API, are as expected.  Do this by
 31  * comparing them to a baseline file together with a list of
 32  * known diffs.
 33  * @build UnicodeSpec CharCheck
 34  * @run main CheckUnicode
 35  * @author Alan Liu
 36  * @author John O&#39;Conner
 37  */
 38 
 39 import java.io.*;
 40 
 41 public class CheckUnicode {
 42     public static void main(String args[]) throws Exception {
 43 
 44         // 1. Check that the dumped property files for planes 0, 1, 2, 3, 14, 15, and 16
 45         //    are the  same as in the current Character properties.
 46                 int[] planes = {0, 1, 2, 3, 14, 15, 16};
 47                 String[] fileNames = {&quot;charprop00.bin&quot;, &quot;charprop01.bin&quot;, &quot;charprop02.bin&quot;, &quot;charprop03.bin&quot;,
 48                                         &quot;charprop0E.bin&quot;, &quot;charprop0F.bin&quot;, &quot;charprop10.bin&quot; };
 49 
 50         // Read in the Unicode 4.0 data
 51 
 52                 for (int x=0; x &lt; planes.length &amp;&amp; x &lt; fileNames.length; ++x) {
 53                 File unicodeProp = new File(System.getProperty(&quot;test.src&quot;, &quot;.&quot;), fileNames[x]);
 54                 ObjectInputStream ois = new ObjectInputStream(new FileInputStream(unicodeProp));
 55                 // Find differences -- should be none
 56                 int diffs = CharCheck.load(planes[x], ois);
 57                 if (diffs != 0) {
 58                     throw new RuntimeException(&quot;Bug 4114080 - Unicode properties have changed &quot; +
 59                                        &quot;in an unexpected way&quot;);
 60             }
 61                 }
 62 
 63 
 64 
 65 
 66         // 2. Check that the current 4.0 spec file is handled by the current
 67         // version of Character.
 68         File unicodeSpec = new File(System.getProperty(&quot;test.src&quot;, &quot;.&quot;), &quot;UnicodeData.txt&quot;);
 69                 for (int x=0; x&lt;planes.length; ++x) {
 70                 int diffs = CharCheck.check(planes[x], unicodeSpec);
 71                 if (diffs != 0) {
 72                     throw new RuntimeException(&quot;Bug 4114080 - Unicode properties have changed &quot; +
 73                                                &quot;in an unexpected way&quot;);
 74                 }
 75                 }
 76 
 77         // 3. Check that Java identifiers are recognized correctly.
 78         // test a few characters that are good id starts
 79         char[] idStartChar = {&#39;$&#39;, &#39;\u20AC&#39;, &#39;a&#39;, &#39;A&#39;, &#39;z&#39;, &#39;Z&#39;, &#39;_&#39;, &#39;\u0E3F&#39;,
 80             &#39;\u1004&#39;, &#39;\u10A0&#39;, &#39;\u3400&#39;, &#39;\u4E00&#39;, &#39;\uAC00&#39; };
 81         for (int x = 0; x &lt; idStartChar.length; x++) {
 82             if (Character.isJavaIdentifierStart(idStartChar[x]) != true) {
 83                 throw new RuntimeException(&quot;Java id start characters are not recognized.&quot;);
 84             }
 85         }
 86 
 87         // test a few characters that are good id parts
 88         char[] idPartChar = {&#39;0&#39;, &#39;9&#39;, &#39;\u0000&#39;, &#39;\u0008&#39;, &#39;\u000E&#39;, &#39;\u007F&#39;};
 89         for (int x=0; x&lt; idStartChar.length; x++) {
 90             if (Character.isJavaIdentifierPart(idStartChar[x]) != true) {
 91                 throw new RuntimeException(&quot;Java id part characters are not recognized.&quot;);
 92             }
 93         }
 94         for (int x=0; x&lt;idPartChar.length; x++) {
 95             if (Character.isJavaIdentifierPart(idPartChar[x]) != true) {
 96                 throw new RuntimeException(&quot;Java id part characters are not recognized.&quot;);
 97             }
 98         }
 99 
100         // now do some negative checks
101         for (int x=0; x&lt; idPartChar.length; x++) {
102             if (Character.isJavaIdentifierStart(idPartChar[x]) != false) {
103                 throw new RuntimeException(&quot;These Java id part characters&quot; +
104                     &quot;should not be start characters.&quot;);
105             }
106         }
107 
108 
109 
110     }
111 }
    </pre>
  </body>
</html>