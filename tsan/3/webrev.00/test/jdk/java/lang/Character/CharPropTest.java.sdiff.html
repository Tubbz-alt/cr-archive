<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/lang/Character/CharPropTest.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../../io/Serializable/wrongReturnTypes/Write.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="CheckProp.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/lang/Character/CharPropTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 /*
 25  * @test
<span class="line-modified"> 26  * @bug 8202771</span>
 27  * @summary Check j.l.Character.isDigit/isLetter/isLetterOrDigit/isSpaceChar
 28  * /isWhitespace/isTitleCase/isISOControl/isIdentifierIgnorable
 29  * /isJavaIdentifierStart/isJavaIdentifierPart/isUnicodeIdentifierStart
 30  * /isUnicodeIdentifierPart

 31  * @run main CharPropTest
 32  */
 33 
 34 import java.nio.file.Files;
<span class="line-removed"> 35 import java.nio.file.Path;</span>
<span class="line-removed"> 36 import java.nio.file.Paths;</span>
 37 import java.util.stream.Stream;
 38 
 39 public class CharPropTest {
 40     private static int diffs = 0;
 41     private static int rangeStart = 0x0000;
 42     private static boolean isRange = false;
 43 
 44     public static void main(String[] args) throws Exception {
<span class="line-modified"> 45         Path path = Paths.get(System.getProperty(&quot;test.src&quot;, &quot;.&quot;),</span>
<span class="line-removed"> 46                 &quot;UnicodeData.txt&quot;);</span>
<span class="line-removed"> 47         try (Stream&lt;String&gt; lines = Files.lines(path)) {</span>
 48             lines.map(String::trim)
 49                  .filter(line -&gt; line.length() != 0 &amp;&amp; line.charAt(0) != &#39;#&#39;)
 50                  .forEach(line -&gt; handleOneLine(line));
 51 
 52             if (diffs != 0) {
 53                 throw new RuntimeException(&quot;Total differences: &quot; + diffs);
 54             }
 55         }
 56     }
 57 
 58     private static void handleOneLine(String line) {
 59         String[] fields = line.split(&quot;;&quot;);
 60         int currentCp = Integer.parseInt(fields[0], 16);
 61         String name = fields[1];
 62         String category = fields[2];
 63 
 64         // Except single code point, also handle ranges like the following:
 65         // 3400;&lt;CJK Ideograph Extension A, First&gt;;Lo;0;L;;;;;N;;;;;
 66         // 4DB5;&lt;CJK Ideograph Extension A, Last&gt;;Lo;0;L;;;;;N;;;;
 67         if (isRange) {
</pre>
<hr />
<pre>
168     }
169 
170     private static void isJavaIdentifierStartTest(int codePoint, String category) {
171         boolean actual = Character.isJavaIdentifierStart(codePoint);
172         boolean expected = isJavaIdentifierStart(category);
173         if (actual != expected) {
174             printDiff(codePoint, &quot;isJavaIdentifierStart&quot;, actual, expected);
175         }
176     }
177 
178     private static void isJavaIdentifierPartTest(int codePoint, String category) {
179         boolean actual = Character.isJavaIdentifierPart(codePoint);
180         boolean expected = isJavaIdentifierPart(codePoint, category);
181         if (actual != expected) {
182             printDiff(codePoint, &quot;isJavaIdentifierPart&quot;, actual, expected);
183         }
184     }
185 
186     private static void isUnicodeIdentifierStartTest(int codePoint, String category) {
187         boolean actual = Character.isUnicodeIdentifierStart(codePoint);
<span class="line-modified">188         boolean expected = isUnicodeIdentifierStart(category);</span>
189         if (actual != expected) {
190             printDiff(codePoint, &quot;isUnicodeIdentifierStart&quot;, actual, expected);
191         }
192     }
193 
194     private static void isUnicodeIdentifierPartTest(int codePoint, String category) {
195         boolean actual = Character.isUnicodeIdentifierPart(codePoint);
196         boolean expected = isUnicodeIdentifierPart(codePoint, category);
197         if (actual != expected) {
198             printDiff(codePoint, &quot;isUnicodeIdentifierPart&quot;, actual, expected);
199         }
200     }
201 
202     private static boolean isLetter(String category) {
203         return category.equals(&quot;Lu&quot;) || category.equals(&quot;Ll&quot;)
204                || category.equals(&quot;Lt&quot;) || category.equals(&quot;Lm&quot;)
205                || category.equals(&quot;Lo&quot;);
206     }
207 
208     private static boolean isSpaceChar(String category) {
</pre>
<hr />
<pre>
252                     || (codePoint &gt; c1 &amp;&amp; codePoint &lt; c2) || (codePoint == a1 || codePoint == a2
253                     || codePoint == b1 || codePoint == b2 || codePoint == c1 || codePoint == c2)) {
254                 return true;
255             }
256         }
257         return false;
258     }
259 
260     private static boolean isJavaIdentifierStart(String category) {
261         return isLetter(category) || category.equals(&quot;Nl&quot;) || category.equals(&quot;Sc&quot;)
262                || category.equals(&quot;Pc&quot;);
263     }
264 
265     private static boolean isJavaIdentifierPart(int codePoint, String category) {
266         return isLetter(category) || category.equals(&quot;Sc&quot;) || category.equals(&quot;Pc&quot;)
267                || category.equals(&quot;Nd&quot;) || category.equals(&quot;Nl&quot;)
268                || category.equals(&quot;Mc&quot;) || category.equals(&quot;Mn&quot;)
269                || isIdentifierIgnorable(codePoint, category);
270     }
271 
<span class="line-modified">272     private static boolean isUnicodeIdentifierStart(String category) {</span>
<span class="line-modified">273         return isLetter(category) || category.equals(&quot;Nl&quot;);</span>

274     }
275 
276     private static boolean isUnicodeIdentifierPart(int codePoint, String category) {
277         return isLetter(category) || category.equals(&quot;Pc&quot;) || category.equals(&quot;Nd&quot;)
278                || category.equals(&quot;Nl&quot;) || category.equals(&quot;Mc&quot;) || category.equals(&quot;Mn&quot;)
<span class="line-modified">279                || isIdentifierIgnorable(codePoint, category);</span>


















280     }
281 
282     private static void printDiff(int codePoint, String method, boolean actual, boolean expected) {
283         System.out.println(&quot;Not equal at codePoint &lt;&quot; + Integer.toHexString(codePoint)
284                 + &quot;&gt;, method: &quot; + method
285                 + &quot;, actual: &quot; + actual + &quot;, expected: &quot; + expected);
286         diffs++;
287     }
288 }
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2018, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 /*
 25  * @test
<span class="line-modified"> 26  * @bug 8202771 8221431 8229831</span>
 27  * @summary Check j.l.Character.isDigit/isLetter/isLetterOrDigit/isSpaceChar
 28  * /isWhitespace/isTitleCase/isISOControl/isIdentifierIgnorable
 29  * /isJavaIdentifierStart/isJavaIdentifierPart/isUnicodeIdentifierStart
 30  * /isUnicodeIdentifierPart
<span class="line-added"> 31  * @library /lib/testlibrary/java/lang</span>
 32  * @run main CharPropTest
 33  */
 34 
 35 import java.nio.file.Files;


 36 import java.util.stream.Stream;
 37 
 38 public class CharPropTest {
 39     private static int diffs = 0;
 40     private static int rangeStart = 0x0000;
 41     private static boolean isRange = false;
 42 
 43     public static void main(String[] args) throws Exception {
<span class="line-modified"> 44         try (Stream&lt;String&gt; lines = Files.lines(UCDFiles.UNICODE_DATA)) {</span>


 45             lines.map(String::trim)
 46                  .filter(line -&gt; line.length() != 0 &amp;&amp; line.charAt(0) != &#39;#&#39;)
 47                  .forEach(line -&gt; handleOneLine(line));
 48 
 49             if (diffs != 0) {
 50                 throw new RuntimeException(&quot;Total differences: &quot; + diffs);
 51             }
 52         }
 53     }
 54 
 55     private static void handleOneLine(String line) {
 56         String[] fields = line.split(&quot;;&quot;);
 57         int currentCp = Integer.parseInt(fields[0], 16);
 58         String name = fields[1];
 59         String category = fields[2];
 60 
 61         // Except single code point, also handle ranges like the following:
 62         // 3400;&lt;CJK Ideograph Extension A, First&gt;;Lo;0;L;;;;;N;;;;;
 63         // 4DB5;&lt;CJK Ideograph Extension A, Last&gt;;Lo;0;L;;;;;N;;;;
 64         if (isRange) {
</pre>
<hr />
<pre>
165     }
166 
167     private static void isJavaIdentifierStartTest(int codePoint, String category) {
168         boolean actual = Character.isJavaIdentifierStart(codePoint);
169         boolean expected = isJavaIdentifierStart(category);
170         if (actual != expected) {
171             printDiff(codePoint, &quot;isJavaIdentifierStart&quot;, actual, expected);
172         }
173     }
174 
175     private static void isJavaIdentifierPartTest(int codePoint, String category) {
176         boolean actual = Character.isJavaIdentifierPart(codePoint);
177         boolean expected = isJavaIdentifierPart(codePoint, category);
178         if (actual != expected) {
179             printDiff(codePoint, &quot;isJavaIdentifierPart&quot;, actual, expected);
180         }
181     }
182 
183     private static void isUnicodeIdentifierStartTest(int codePoint, String category) {
184         boolean actual = Character.isUnicodeIdentifierStart(codePoint);
<span class="line-modified">185         boolean expected = isUnicodeIdentifierStart(codePoint, category);</span>
186         if (actual != expected) {
187             printDiff(codePoint, &quot;isUnicodeIdentifierStart&quot;, actual, expected);
188         }
189     }
190 
191     private static void isUnicodeIdentifierPartTest(int codePoint, String category) {
192         boolean actual = Character.isUnicodeIdentifierPart(codePoint);
193         boolean expected = isUnicodeIdentifierPart(codePoint, category);
194         if (actual != expected) {
195             printDiff(codePoint, &quot;isUnicodeIdentifierPart&quot;, actual, expected);
196         }
197     }
198 
199     private static boolean isLetter(String category) {
200         return category.equals(&quot;Lu&quot;) || category.equals(&quot;Ll&quot;)
201                || category.equals(&quot;Lt&quot;) || category.equals(&quot;Lm&quot;)
202                || category.equals(&quot;Lo&quot;);
203     }
204 
205     private static boolean isSpaceChar(String category) {
</pre>
<hr />
<pre>
249                     || (codePoint &gt; c1 &amp;&amp; codePoint &lt; c2) || (codePoint == a1 || codePoint == a2
250                     || codePoint == b1 || codePoint == b2 || codePoint == c1 || codePoint == c2)) {
251                 return true;
252             }
253         }
254         return false;
255     }
256 
257     private static boolean isJavaIdentifierStart(String category) {
258         return isLetter(category) || category.equals(&quot;Nl&quot;) || category.equals(&quot;Sc&quot;)
259                || category.equals(&quot;Pc&quot;);
260     }
261 
262     private static boolean isJavaIdentifierPart(int codePoint, String category) {
263         return isLetter(category) || category.equals(&quot;Sc&quot;) || category.equals(&quot;Pc&quot;)
264                || category.equals(&quot;Nd&quot;) || category.equals(&quot;Nl&quot;)
265                || category.equals(&quot;Mc&quot;) || category.equals(&quot;Mn&quot;)
266                || isIdentifierIgnorable(codePoint, category);
267     }
268 
<span class="line-modified">269     private static boolean isUnicodeIdentifierStart(int codePoint, String category) {</span>
<span class="line-modified">270         return isLetter(category) || category.equals(&quot;Nl&quot;)</span>
<span class="line-added">271                || isOtherIDStart(codePoint);</span>
272     }
273 
274     private static boolean isUnicodeIdentifierPart(int codePoint, String category) {
275         return isLetter(category) || category.equals(&quot;Pc&quot;) || category.equals(&quot;Nd&quot;)
276                || category.equals(&quot;Nl&quot;) || category.equals(&quot;Mc&quot;) || category.equals(&quot;Mn&quot;)
<span class="line-modified">277                || isIdentifierIgnorable(codePoint, category)</span>
<span class="line-added">278                || isOtherIDStart(codePoint)</span>
<span class="line-added">279                || isOtherIDContinue(codePoint);</span>
<span class="line-added">280     }</span>
<span class="line-added">281 </span>
<span class="line-added">282     private static boolean isOtherIDStart(int codePoint) {</span>
<span class="line-added">283         return codePoint == 0x1885 ||</span>
<span class="line-added">284                codePoint == 0x1886 ||</span>
<span class="line-added">285                codePoint == 0x2118 ||</span>
<span class="line-added">286                codePoint == 0x212E ||</span>
<span class="line-added">287                codePoint == 0x309B ||</span>
<span class="line-added">288                codePoint == 0x309C;</span>
<span class="line-added">289     }</span>
<span class="line-added">290 </span>
<span class="line-added">291     private static boolean isOtherIDContinue(int codePoint) {</span>
<span class="line-added">292         return codePoint == 0x00B7 ||</span>
<span class="line-added">293                codePoint == 0x0387 ||</span>
<span class="line-added">294               (codePoint &gt;= 0x1369 &amp;&amp; codePoint &lt;= 0x1371) ||</span>
<span class="line-added">295                codePoint == 0x19DA;</span>
296     }
297 
298     private static void printDiff(int codePoint, String method, boolean actual, boolean expected) {
299         System.out.println(&quot;Not equal at codePoint &lt;&quot; + Integer.toHexString(codePoint)
300                 + &quot;&gt;, method: &quot; + method
301                 + &quot;, actual: &quot; + actual + &quot;, expected: &quot; + expected);
302         diffs++;
303     }
304 }
</pre>
</td>
</tr>
</table>
<center><a href="../../io/Serializable/wrongReturnTypes/Write.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="CheckProp.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>