<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/lang/Character/CheckUnicode.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="CheckScript.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="UnicodeBlock/CheckBlocks.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/lang/Character/CheckUnicode.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 /**
 27  * @test
<span class="line-modified"> 28  * @bug      4114080 6565620 6959267 7070436 7198195 8032446 8072600</span>
 29  * @summary  Make sure the attributes of Unicode characters, as
 30  * returned by the Character API, are as expected.  Do this by
 31  * comparing them to a baseline file together with a list of
 32  * known diffs.

 33  * @build UnicodeSpec CharCheck
 34  * @run main CheckUnicode
 35  * @author Alan Liu
 36  * @author John O&#39;Conner
 37  */
 38 
 39 import java.io.*;
 40 
 41 public class CheckUnicode {
 42     public static void main(String args[]) throws Exception {
 43 
<span class="line-modified"> 44         // 1. Check that the dumped property files for planes 0, 1, 2, 3, 14, 15, and 16</span>
<span class="line-removed"> 45         //    are the  same as in the current Character properties.</span>
<span class="line-removed"> 46                 int[] planes = {0, 1, 2, 3, 14, 15, 16};</span>
<span class="line-removed"> 47                 String[] fileNames = {&quot;charprop00.bin&quot;, &quot;charprop01.bin&quot;, &quot;charprop02.bin&quot;, &quot;charprop03.bin&quot;,</span>
<span class="line-removed"> 48                                         &quot;charprop0E.bin&quot;, &quot;charprop0F.bin&quot;, &quot;charprop10.bin&quot; };</span>
<span class="line-removed"> 49 </span>
<span class="line-removed"> 50         // Read in the Unicode 4.0 data</span>
<span class="line-removed"> 51 </span>
<span class="line-removed"> 52                 for (int x=0; x &lt; planes.length &amp;&amp; x &lt; fileNames.length; ++x) {</span>
<span class="line-removed"> 53                 File unicodeProp = new File(System.getProperty(&quot;test.src&quot;, &quot;.&quot;), fileNames[x]);</span>
<span class="line-removed"> 54                 ObjectInputStream ois = new ObjectInputStream(new FileInputStream(unicodeProp));</span>
<span class="line-removed"> 55                 // Find differences -- should be none</span>
<span class="line-removed"> 56                 int diffs = CharCheck.load(planes[x], ois);</span>
<span class="line-removed"> 57                 if (diffs != 0) {</span>
<span class="line-removed"> 58                     throw new RuntimeException(&quot;Bug 4114080 - Unicode properties have changed &quot; +</span>
<span class="line-removed"> 59                                        &quot;in an unexpected way&quot;);</span>
<span class="line-removed"> 60             }</span>
<span class="line-removed"> 61                 }</span>
<span class="line-removed"> 62 </span>
<span class="line-removed"> 63 </span>
<span class="line-removed"> 64 </span>
<span class="line-removed"> 65 </span>
<span class="line-removed"> 66         // 2. Check that the current 4.0 spec file is handled by the current</span>
 67         // version of Character.
<span class="line-modified"> 68         File unicodeSpec = new File(System.getProperty(&quot;test.src&quot;, &quot;.&quot;), &quot;UnicodeData.txt&quot;);</span>
<span class="line-modified"> 69                 for (int x=0; x&lt;planes.length; ++x) {</span>
<span class="line-modified"> 70                 int diffs = CharCheck.check(planes[x], unicodeSpec);</span>
<span class="line-modified"> 71                 if (diffs != 0) {</span>
<span class="line-modified"> 72                     throw new RuntimeException(&quot;Bug 4114080 - Unicode properties have changed &quot; +</span>
<span class="line-modified"> 73                                                &quot;in an unexpected way&quot;);</span>
<span class="line-modified"> 74                 }</span>
<span class="line-modified"> 75                 }</span>
 76 
<span class="line-modified"> 77         // 3. Check that Java identifiers are recognized correctly.</span>
 78         // test a few characters that are good id starts
 79         char[] idStartChar = {&#39;$&#39;, &#39;\u20AC&#39;, &#39;a&#39;, &#39;A&#39;, &#39;z&#39;, &#39;Z&#39;, &#39;_&#39;, &#39;\u0E3F&#39;,
 80             &#39;\u1004&#39;, &#39;\u10A0&#39;, &#39;\u3400&#39;, &#39;\u4E00&#39;, &#39;\uAC00&#39; };
 81         for (int x = 0; x &lt; idStartChar.length; x++) {
 82             if (Character.isJavaIdentifierStart(idStartChar[x]) != true) {
 83                 throw new RuntimeException(&quot;Java id start characters are not recognized.&quot;);
 84             }
 85         }
 86 
 87         // test a few characters that are good id parts
 88         char[] idPartChar = {&#39;0&#39;, &#39;9&#39;, &#39;\u0000&#39;, &#39;\u0008&#39;, &#39;\u000E&#39;, &#39;\u007F&#39;};
 89         for (int x=0; x&lt; idStartChar.length; x++) {
 90             if (Character.isJavaIdentifierPart(idStartChar[x]) != true) {
 91                 throw new RuntimeException(&quot;Java id part characters are not recognized.&quot;);
 92             }
 93         }
 94         for (int x=0; x&lt;idPartChar.length; x++) {
 95             if (Character.isJavaIdentifierPart(idPartChar[x]) != true) {
 96                 throw new RuntimeException(&quot;Java id part characters are not recognized.&quot;);
 97             }
 98         }
 99 
100         // now do some negative checks
101         for (int x=0; x&lt; idPartChar.length; x++) {
102             if (Character.isJavaIdentifierStart(idPartChar[x]) != false) {
103                 throw new RuntimeException(&quot;These Java id part characters&quot; +
104                     &quot;should not be start characters.&quot;);
105             }
106         }
<span class="line-removed">107 </span>
<span class="line-removed">108 </span>
<span class="line-removed">109 </span>
110     }
111 }
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2018, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 /**
 27  * @test
<span class="line-modified"> 28  * @bug      4114080 6565620 6959267 7070436 7198195 8032446 8072600 8221431</span>
 29  * @summary  Make sure the attributes of Unicode characters, as
 30  * returned by the Character API, are as expected.  Do this by
 31  * comparing them to a baseline file together with a list of
 32  * known diffs.
<span class="line-added"> 33  * @library /lib/testlibrary/java/lang</span>
 34  * @build UnicodeSpec CharCheck
 35  * @run main CheckUnicode
 36  * @author Alan Liu
 37  * @author John O&#39;Conner
 38  */
 39 
 40 import java.io.*;
 41 
 42 public class CheckUnicode {
 43     public static void main(String args[]) throws Exception {
 44 
<span class="line-modified"> 45         // 1. Check that the current 12.1 spec file is handled by the current</span>






















 46         // version of Character.
<span class="line-modified"> 47         File unicodeSpec = UCDFiles.UNICODE_DATA.toFile();</span>
<span class="line-modified"> 48         for (int x = 0; x &lt; 16; ++x) {</span>
<span class="line-modified"> 49             int diffs = CharCheck.check(x, unicodeSpec);</span>
<span class="line-modified"> 50             if (diffs != 0) {</span>
<span class="line-modified"> 51                 throw new RuntimeException(&quot;Unicode properties have changed &quot; +</span>
<span class="line-modified"> 52                                            &quot;in an unexpected way&quot;);</span>
<span class="line-modified"> 53             }</span>
<span class="line-modified"> 54         }</span>
 55 
<span class="line-modified"> 56         // 2. Check that Java identifiers are recognized correctly.</span>
 57         // test a few characters that are good id starts
 58         char[] idStartChar = {&#39;$&#39;, &#39;\u20AC&#39;, &#39;a&#39;, &#39;A&#39;, &#39;z&#39;, &#39;Z&#39;, &#39;_&#39;, &#39;\u0E3F&#39;,
 59             &#39;\u1004&#39;, &#39;\u10A0&#39;, &#39;\u3400&#39;, &#39;\u4E00&#39;, &#39;\uAC00&#39; };
 60         for (int x = 0; x &lt; idStartChar.length; x++) {
 61             if (Character.isJavaIdentifierStart(idStartChar[x]) != true) {
 62                 throw new RuntimeException(&quot;Java id start characters are not recognized.&quot;);
 63             }
 64         }
 65 
 66         // test a few characters that are good id parts
 67         char[] idPartChar = {&#39;0&#39;, &#39;9&#39;, &#39;\u0000&#39;, &#39;\u0008&#39;, &#39;\u000E&#39;, &#39;\u007F&#39;};
 68         for (int x=0; x&lt; idStartChar.length; x++) {
 69             if (Character.isJavaIdentifierPart(idStartChar[x]) != true) {
 70                 throw new RuntimeException(&quot;Java id part characters are not recognized.&quot;);
 71             }
 72         }
 73         for (int x=0; x&lt;idPartChar.length; x++) {
 74             if (Character.isJavaIdentifierPart(idPartChar[x]) != true) {
 75                 throw new RuntimeException(&quot;Java id part characters are not recognized.&quot;);
 76             }
 77         }
 78 
 79         // now do some negative checks
 80         for (int x=0; x&lt; idPartChar.length; x++) {
 81             if (Character.isJavaIdentifierStart(idPartChar[x]) != false) {
 82                 throw new RuntimeException(&quot;These Java id part characters&quot; +
 83                     &quot;should not be start characters.&quot;);
 84             }
 85         }



 86     }
 87 }
</pre>
</td>
</tr>
</table>
<center><a href="CheckScript.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="UnicodeBlock/CheckBlocks.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>