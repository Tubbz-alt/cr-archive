<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/jdk/java/lang/Character/CheckUnicode.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="CheckScript.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="UnicodeBlock/CheckBlocks.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/lang/Character/CheckUnicode.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2018, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -23,15 +23,16 @@</span>
   * questions.
   */
  
  /**
   * @test
<span class="udiff-line-modified-removed">-  * @bug      4114080 6565620 6959267 7070436 7198195 8032446 8072600</span>
<span class="udiff-line-modified-added">+  * @bug      4114080 6565620 6959267 7070436 7198195 8032446 8072600 8221431</span>
   * @summary  Make sure the attributes of Unicode characters, as
   * returned by the Character API, are as expected.  Do this by
   * comparing them to a baseline file together with a list of
   * known diffs.
<span class="udiff-line-added">+  * @library /lib/testlibrary/java/lang</span>
   * @build UnicodeSpec CharCheck
   * @run main CheckUnicode
   * @author Alan Liu
   * @author John O&#39;Conner
   */
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -39,44 +40,22 @@</span>
  import java.io.*;
  
  public class CheckUnicode {
      public static void main(String args[]) throws Exception {
  
<span class="udiff-line-modified-removed">-         // 1. Check that the dumped property files for planes 0, 1, 2, 3, 14, 15, and 16</span>
<span class="udiff-line-removed">-         //    are the  same as in the current Character properties.</span>
<span class="udiff-line-removed">-                 int[] planes = {0, 1, 2, 3, 14, 15, 16};</span>
<span class="udiff-line-removed">-                 String[] fileNames = {&quot;charprop00.bin&quot;, &quot;charprop01.bin&quot;, &quot;charprop02.bin&quot;, &quot;charprop03.bin&quot;,</span>
<span class="udiff-line-removed">-                                         &quot;charprop0E.bin&quot;, &quot;charprop0F.bin&quot;, &quot;charprop10.bin&quot; };</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // Read in the Unicode 4.0 data</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-                 for (int x=0; x &lt; planes.length &amp;&amp; x &lt; fileNames.length; ++x) {</span>
<span class="udiff-line-removed">-                 File unicodeProp = new File(System.getProperty(&quot;test.src&quot;, &quot;.&quot;), fileNames[x]);</span>
<span class="udiff-line-removed">-                 ObjectInputStream ois = new ObjectInputStream(new FileInputStream(unicodeProp));</span>
<span class="udiff-line-removed">-                 // Find differences -- should be none</span>
<span class="udiff-line-removed">-                 int diffs = CharCheck.load(planes[x], ois);</span>
<span class="udiff-line-removed">-                 if (diffs != 0) {</span>
<span class="udiff-line-removed">-                     throw new RuntimeException(&quot;Bug 4114080 - Unicode properties have changed &quot; +</span>
<span class="udiff-line-removed">-                                        &quot;in an unexpected way&quot;);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // 2. Check that the current 4.0 spec file is handled by the current</span>
<span class="udiff-line-modified-added">+         // 1. Check that the current 12.1 spec file is handled by the current</span>
          // version of Character.
<span class="udiff-line-modified-removed">-         File unicodeSpec = new File(System.getProperty(&quot;test.src&quot;, &quot;.&quot;), &quot;UnicodeData.txt&quot;);</span>
<span class="udiff-line-modified-removed">-                 for (int x=0; x&lt;planes.length; ++x) {</span>
<span class="udiff-line-modified-removed">-                 int diffs = CharCheck.check(planes[x], unicodeSpec);</span>
<span class="udiff-line-modified-removed">-                 if (diffs != 0) {</span>
<span class="udiff-line-modified-removed">-                     throw new RuntimeException(&quot;Bug 4114080 - Unicode properties have changed &quot; +</span>
<span class="udiff-line-modified-removed">-                                                &quot;in an unexpected way&quot;);</span>
<span class="udiff-line-modified-removed">-                 }</span>
<span class="udiff-line-modified-removed">-                 }</span>
<span class="udiff-line-modified-added">+         File unicodeSpec = UCDFiles.UNICODE_DATA.toFile();</span>
<span class="udiff-line-modified-added">+         for (int x = 0; x &lt; 16; ++x) {</span>
<span class="udiff-line-modified-added">+             int diffs = CharCheck.check(x, unicodeSpec);</span>
<span class="udiff-line-modified-added">+             if (diffs != 0) {</span>
<span class="udiff-line-modified-added">+                 throw new RuntimeException(&quot;Unicode properties have changed &quot; +</span>
<span class="udiff-line-modified-added">+                                            &quot;in an unexpected way&quot;);</span>
<span class="udiff-line-modified-added">+             }</span>
<span class="udiff-line-modified-added">+         }</span>
  
<span class="udiff-line-modified-removed">-         // 3. Check that Java identifiers are recognized correctly.</span>
<span class="udiff-line-modified-added">+         // 2. Check that Java identifiers are recognized correctly.</span>
          // test a few characters that are good id starts
          char[] idStartChar = {&#39;$&#39;, &#39;\u20AC&#39;, &#39;a&#39;, &#39;A&#39;, &#39;z&#39;, &#39;Z&#39;, &#39;_&#39;, &#39;\u0E3F&#39;,
              &#39;\u1004&#39;, &#39;\u10A0&#39;, &#39;\u3400&#39;, &#39;\u4E00&#39;, &#39;\uAC00&#39; };
          for (int x = 0; x &lt; idStartChar.length; x++) {
              if (Character.isJavaIdentifierStart(idStartChar[x]) != true) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -102,10 +81,7 @@</span>
              if (Character.isJavaIdentifierStart(idPartChar[x]) != false) {
                  throw new RuntimeException(&quot;These Java id part characters&quot; +
                      &quot;should not be start characters.&quot;);
              }
          }
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- </span>
      }
  }
</pre>
<center><a href="CheckScript.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="UnicodeBlock/CheckBlocks.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>