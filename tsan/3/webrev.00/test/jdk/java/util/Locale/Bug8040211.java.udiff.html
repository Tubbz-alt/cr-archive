<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/jdk/java/util/Locale/Bug8040211.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../HashMap/WhiteBoxResizeTest.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="Bug8179071.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/util/Locale/Bug8040211.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2016, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2016, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -21,13 +21,13 @@</span>
   * questions.
   */
  
  /*
   * @test
<span class="udiff-line-modified-removed">-  * @bug 8040211 8191404 8203872</span>
<span class="udiff-line-modified-added">+  * @bug 8040211 8191404 8203872 8222980 8225435</span>
   * @summary Checks the IANA language subtag registry data update
<span class="udiff-line-modified-removed">-  *          (LSR Revision: 2018-04-23) with Locale and Locale.LanguageRange</span>
<span class="udiff-line-modified-added">+  *          (LSR Revision: 2019-09-16) with Locale and Locale.LanguageRange</span>
   *          class methods.
   * @run main Bug8040211
   */
  
  import java.util.ArrayList;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -40,10 +40,88 @@</span>
  
  public class Bug8040211 {
  
      static boolean err = false;
  
<span class="udiff-line-added">+     private static final String ACCEPT_LANGUAGE =</span>
<span class="udiff-line-added">+         &quot;Accept-Language: aam, adp, aog, aue, bcg, cey, cqu, dif, ema,&quot;</span>
<span class="udiff-line-added">+         + &quot; en-gb-oed, gti, kdz, koj, kwq, kxe, lii, lmm, lsn, lsv, lvi, mtm,&quot;</span>
<span class="udiff-line-added">+         + &quot; ngv, nns, oyb, phr, pnd, pub, snz, suj, szy,taj, tjj, tjp, tvx,&quot;</span>
<span class="udiff-line-added">+         + &quot; uss, uth, wkr;q=0.9, ar-hyw;q=0.8, yug;q=0.5, gfx;q=0.4&quot;;</span>
<span class="udiff-line-added">+     private static final List&lt;LanguageRange&gt; EXPECTED_RANGE_LIST = List.of(</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;aam&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;aas&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;adp&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;dz&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;aog&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;myd&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;aue&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;ktz&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;bcg&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;bgm&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;cey&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;cqu&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;quh&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;dif&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;dit&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;ema&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;uok&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;en-gb-oed&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;en-gb-oxendict&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;gti&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;nyc&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;kdz&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;ncp&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;koj&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;kwv&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;kwq&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;yam&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;kxe&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;tvd&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;lii&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;raq&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;lmm&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;rmx&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;lsn&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;lsv&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;lvi&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;mtm&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;ymt&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;ngv&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;nnx&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;nns&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;nbr&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;oyb&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;thx&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;skk&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;jeg&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;phr&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;pmu&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;pnd&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;pub&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;puz&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;snz&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;asd&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;suj&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;szy&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;taj&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;tsf&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;tjj&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;tjp&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;tvx&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;uss&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;uth&quot;, 1.0),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;wkr&quot;, 0.9),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;ar-hyw&quot;, 0.8),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;yug&quot;, 0.5),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;yuu&quot;, 0.5),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;gfx&quot;, 0.4),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;oun&quot;, 0.4),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;mwj&quot;, 0.4),</span>
<span class="udiff-line-added">+             new LanguageRange(&quot;vaj&quot;, 0.4)</span>
<span class="udiff-line-added">+         );</span>
<span class="udiff-line-added">+ </span>
      public static void main(String[] args) {
          testLanguageRange();
          testLocale();
  
          if (err) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -64,75 +142,19 @@</span>
          test_lookupTag();
      }
  
      private static void test_parse() {
          boolean error = false;
<span class="udiff-line-modified-removed">-         String str = &quot;Accept-Language: aam, adp, aue, bcg, cqu, ema,&quot;</span>
<span class="udiff-line-modified-removed">-                 + &quot; en-gb-oed, gti, kdz, koj, kwq, kxe, lii, lmm, mtm, ngv,&quot;</span>
<span class="udiff-line-removed">-                 + &quot; oyb, phr, pub, suj, taj;q=0.9, ar-hyw;q=0.8, yug;q=0.5, gfx;q=0.4&quot;;</span>
<span class="udiff-line-removed">-         ArrayList&lt;LanguageRange&gt; expected = new ArrayList&lt;&gt;();</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;aam&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;aas&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;adp&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;dz&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;aue&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;ktz&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;bcg&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;bgm&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;cqu&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;quh&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;ema&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;uok&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;en-gb-oed&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;en-gb-oxendict&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;gti&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;nyc&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;kdz&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;ncp&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;koj&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;kwv&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;kwq&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;yam&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;kxe&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;tvd&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;lii&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;raq&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;lmm&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;rmx&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;mtm&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;ymt&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;ngv&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;nnx&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;oyb&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;thx&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;skk&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;jeg&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;phr&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;pmu&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;pub&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;puz&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;suj&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;xsj&quot;, 1.0));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;taj&quot;, 0.9));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;tsf&quot;, 0.9));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;ar-hyw&quot;, 0.8));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;ar-arevmda&quot;, 0.8));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;yug&quot;, 0.5));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;yuu&quot;, 0.5));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;gfx&quot;, 0.4));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;oun&quot;, 0.4));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;mwj&quot;, 0.4));</span>
<span class="udiff-line-removed">-         expected.add(new LanguageRange(&quot;vaj&quot;, 0.4));</span>
<span class="udiff-line-removed">-         List&lt;LanguageRange&gt; got = LanguageRange.parse(str);</span>
<span class="udiff-line-removed">-         if (!areEqual(expected, got)) {</span>
<span class="udiff-line-modified-added">+         List&lt;LanguageRange&gt; got = LanguageRange.parse(ACCEPT_LANGUAGE);</span>
<span class="udiff-line-modified-added">+         if (!areEqual(EXPECTED_RANGE_LIST, got)) {</span>
              error = true;
              System.err.println(&quot;    language parse() test failed.&quot;);
          }
  
          if (error) {
              err = true;
<span class="udiff-line-modified-removed">-             System.err.println(&quot;  test_parse() failed.&quot;);</span>
<span class="udiff-line-modified-added">+             System.out.println(&quot;  test_parse() failed.&quot;);</span>
          } else {
              System.out.println(&quot;  test_parse() passed.&quot;);
          }
  
      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -151,11 +173,11 @@</span>
              for (LanguageRange lr : expected) {
                  System.err.println(&quot;    range=&quot; + lr.getRange()
                          + &quot;, weight=&quot; + lr.getWeight());
              }
  
<span class="udiff-line-modified-removed">-             System.out.println(&quot;  Actual size=&quot; + actualSize);</span>
<span class="udiff-line-modified-added">+             System.err.println(&quot;  Actual size=&quot; + actualSize);</span>
              for (LanguageRange lr : got) {
                  System.err.println(&quot;    range=&quot; + lr.getRange()
                          + &quot;, weight=&quot; + lr.getWeight());
              }
          } else {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -186,11 +208,11 @@</span>
  
          List&lt;LanguageRange&gt; priorityList = LanguageRange.parse(ranges);
          List&lt;Locale&gt; tagList = generateLocales(tags);
          String actualLocales
                  = showLocales(Locale.filter(priorityList, tagList, mode));
<span class="udiff-line-modified-removed">-         String expectedLocales = &quot;mtm-RU, ymt-RU, en-GB-oxendict, nts, pij, ar-arevela&quot;;</span>
<span class="udiff-line-modified-added">+         String expectedLocales = &quot;mtm-RU, ymt-RU, en-GB-oxendict, nts, pij&quot;;</span>
  
          if (!expectedLocales.equals(actualLocales)) {
              error = true;
              showErrorMessage(&quot;#1 filter(&quot; + mode + &quot;)&quot;,
                      ranges, tags, expectedLocales, actualLocales);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -350,14 +372,14 @@</span>
      private static void showErrorMessage(String methodName,
              String priorityList,
              String tags,
              String expectedTags,
              String actualTags) {
<span class="udiff-line-modified-removed">-         System.out.println(&quot;\nIncorrect &quot; + methodName + &quot; result.&quot;);</span>
<span class="udiff-line-modified-removed">-         System.out.println(&quot;  Priority list  :  &quot; + priorityList);</span>
<span class="udiff-line-modified-removed">-         System.out.println(&quot;  Language tags  :  &quot; + tags);</span>
<span class="udiff-line-modified-removed">-         System.out.println(&quot;  Expected value : &quot; + expectedTags);</span>
<span class="udiff-line-modified-removed">-         System.out.println(&quot;  Actual value   : &quot; + actualTags);</span>
<span class="udiff-line-modified-added">+         System.err.println(&quot;\nIncorrect &quot; + methodName + &quot; result.&quot;);</span>
<span class="udiff-line-modified-added">+         System.err.println(&quot;  Priority list  :  &quot; + priorityList);</span>
<span class="udiff-line-modified-added">+         System.err.println(&quot;  Language tags  :  &quot; + tags);</span>
<span class="udiff-line-modified-added">+         System.err.println(&quot;  Expected value : &quot; + expectedTags);</span>
<span class="udiff-line-modified-added">+         System.err.println(&quot;  Actual value   : &quot; + actualTags);</span>
      }
  
  }
  
</pre>
<center><a href="../HashMap/WhiteBoxResizeTest.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="Bug8179071.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>