<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/util/concurrent/ScheduledThreadPoolExecutor/GCRetention.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../Phaser/TieredArriveLoops.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../TimeUnit/Basic.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/util/concurrent/ScheduledThreadPoolExecutor/GCRetention.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 69                 public V get(long x, TimeUnit y)
 70                     throws InterruptedException,ExecutionException,TimeoutException
 71                     { return task.get(x, y); }
 72                 public boolean isDone() { return task.isDone(); }
 73                 public boolean isCancelled() { return task.isCancelled(); }
 74                 public boolean cancel(boolean x) { return task.cancel(x); }
 75                 public long getDelay(TimeUnit x) { return task.getDelay(x); }
 76                 public int compareTo(Delayed x) { return task.compareTo(x); }
 77             };
 78         }
 79     }
 80 
 81     void removeAll(ReferenceQueue&lt;?&gt; q, int n) throws InterruptedException {
 82         for (int j = n; j--&gt; 0; ) {
 83             if (q.poll() == null) {
 84                 for (;;) {
 85                     System.gc();
 86                     if (q.remove(1000) != null)
 87                         break;
 88                     System.out.printf(
<span class="line-modified"> 89                         &quot;%d/%d unqueued references remaining%n&quot;, j, n);</span>
 90                 }
 91             }
 92         }
 93         check(q.poll() == null);
 94     }
 95 
 96     void test(String[] args) throws Throwable {
 97         final CustomPool pool = new CustomPool(10);
 98         final int size = 100;
 99         final ReferenceQueue&lt;Object&gt; q = new ReferenceQueue&lt;&gt;();
100         final List&lt;WeakReference&lt;?&gt;&gt; refs = new ArrayList&lt;&gt;(size);
101         final List&lt;Future&lt;?&gt;&gt; futures = new ArrayList&lt;&gt;(size);
102 
103         // Schedule custom tasks with strong references.
104         class Task implements Runnable {
105             final Object x;
106             Task() { refs.add(new WeakReference&lt;&gt;(x = new Object(), q)); }
107             public void run() { System.out.println(x); }
108         }
109         // Give tasks added later earlier expiration, to ensure
</pre>
</td>
<td>
<hr />
<pre>
 69                 public V get(long x, TimeUnit y)
 70                     throws InterruptedException,ExecutionException,TimeoutException
 71                     { return task.get(x, y); }
 72                 public boolean isDone() { return task.isDone(); }
 73                 public boolean isCancelled() { return task.isCancelled(); }
 74                 public boolean cancel(boolean x) { return task.cancel(x); }
 75                 public long getDelay(TimeUnit x) { return task.getDelay(x); }
 76                 public int compareTo(Delayed x) { return task.compareTo(x); }
 77             };
 78         }
 79     }
 80 
 81     void removeAll(ReferenceQueue&lt;?&gt; q, int n) throws InterruptedException {
 82         for (int j = n; j--&gt; 0; ) {
 83             if (q.poll() == null) {
 84                 for (;;) {
 85                     System.gc();
 86                     if (q.remove(1000) != null)
 87                         break;
 88                     System.out.printf(
<span class="line-modified"> 89                         &quot;%d/%d unqueued references remaining%n&quot;, j + 1, n);</span>
 90                 }
 91             }
 92         }
 93         check(q.poll() == null);
 94     }
 95 
 96     void test(String[] args) throws Throwable {
 97         final CustomPool pool = new CustomPool(10);
 98         final int size = 100;
 99         final ReferenceQueue&lt;Object&gt; q = new ReferenceQueue&lt;&gt;();
100         final List&lt;WeakReference&lt;?&gt;&gt; refs = new ArrayList&lt;&gt;(size);
101         final List&lt;Future&lt;?&gt;&gt; futures = new ArrayList&lt;&gt;(size);
102 
103         // Schedule custom tasks with strong references.
104         class Task implements Runnable {
105             final Object x;
106             Task() { refs.add(new WeakReference&lt;&gt;(x = new Object(), q)); }
107             public void run() { System.out.println(x); }
108         }
109         // Give tasks added later earlier expiration, to ensure
</pre>
</td>
</tr>
</table>
<center><a href="../Phaser/TieredArriveLoops.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../TimeUnit/Basic.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>