<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/jdk/java/util/concurrent/tck/Atomic8Test.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="ArrayBlockingQueueTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="AtomicIntegerArray9Test.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/util/concurrent/tck/Atomic8Test.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 516,78 ***</span>
      /**
       * All Atomic getAndUpdate methods throw NullPointerException on
       * null function argument
       */
      public void testGetAndUpdateNPE() {
<span class="line-modified">!         Runnable[] throwingActions = {</span>
              () -&gt; new AtomicLong().getAndUpdate(null),
              () -&gt; new AtomicInteger().getAndUpdate(null),
              () -&gt; new AtomicReference().getAndUpdate(null),
              () -&gt; new AtomicLongArray(1).getAndUpdate(0, null),
              () -&gt; new AtomicIntegerArray(1).getAndUpdate(0, null),
              () -&gt; new AtomicReferenceArray(1).getAndUpdate(0, null),
              () -&gt; aLongFieldUpdater().getAndUpdate(this, null),
              () -&gt; anIntFieldUpdater().getAndUpdate(this, null),
<span class="line-modified">!             () -&gt; anIntegerFieldUpdater().getAndUpdate(this, null),</span>
<span class="line-removed">-         };</span>
<span class="line-removed">-         assertThrows(NullPointerException.class, throwingActions);</span>
      }
  
      /**
       * All Atomic updateAndGet methods throw NullPointerException on null function argument
       */
      public void testUpdateAndGetNPE() {
<span class="line-modified">!         Runnable[] throwingActions = {</span>
              () -&gt; new AtomicLong().updateAndGet(null),
              () -&gt; new AtomicInteger().updateAndGet(null),
              () -&gt; new AtomicReference().updateAndGet(null),
              () -&gt; new AtomicLongArray(1).updateAndGet(0, null),
              () -&gt; new AtomicIntegerArray(1).updateAndGet(0, null),
              () -&gt; new AtomicReferenceArray(1).updateAndGet(0, null),
              () -&gt; aLongFieldUpdater().updateAndGet(this, null),
              () -&gt; anIntFieldUpdater().updateAndGet(this, null),
<span class="line-modified">!             () -&gt; anIntegerFieldUpdater().updateAndGet(this, null),</span>
<span class="line-removed">-         };</span>
<span class="line-removed">-         assertThrows(NullPointerException.class, throwingActions);</span>
      }
  
      /**
       * All Atomic getAndAccumulate methods throw NullPointerException
       * on null function argument
       */
      public void testGetAndAccumulateNPE() {
<span class="line-modified">!         Runnable[] throwingActions = {</span>
              () -&gt; new AtomicLong().getAndAccumulate(1L, null),
              () -&gt; new AtomicInteger().getAndAccumulate(1, null),
              () -&gt; new AtomicReference().getAndAccumulate(one, null),
              () -&gt; new AtomicLongArray(1).getAndAccumulate(0, 1L, null),
              () -&gt; new AtomicIntegerArray(1).getAndAccumulate(0, 1, null),
              () -&gt; new AtomicReferenceArray(1).getAndAccumulate(0, one, null),
              () -&gt; aLongFieldUpdater().getAndAccumulate(this, 1L, null),
              () -&gt; anIntFieldUpdater().getAndAccumulate(this, 1, null),
<span class="line-modified">!             () -&gt; anIntegerFieldUpdater().getAndAccumulate(this, one, null),</span>
<span class="line-removed">-         };</span>
<span class="line-removed">-         assertThrows(NullPointerException.class, throwingActions);</span>
      }
  
      /**
       * All Atomic accumulateAndGet methods throw NullPointerException
       * on null function argument
       */
      public void testAccumulateAndGetNPE() {
<span class="line-modified">!         Runnable[] throwingActions = {</span>
              () -&gt; new AtomicLong().accumulateAndGet(1L, null),
              () -&gt; new AtomicInteger().accumulateAndGet(1, null),
              () -&gt; new AtomicReference().accumulateAndGet(one, null),
              () -&gt; new AtomicLongArray(1).accumulateAndGet(0, 1L, null),
              () -&gt; new AtomicIntegerArray(1).accumulateAndGet(0, 1, null),
              () -&gt; new AtomicReferenceArray(1).accumulateAndGet(0, one, null),
              () -&gt; aLongFieldUpdater().accumulateAndGet(this, 1L, null),
              () -&gt; anIntFieldUpdater().accumulateAndGet(this, 1, null),
<span class="line-modified">!             () -&gt; anIntegerFieldUpdater().accumulateAndGet(this, one, null),</span>
<span class="line-removed">-         };</span>
<span class="line-removed">-         assertThrows(NullPointerException.class, throwingActions);</span>
      }
  
      /**
       * Object arguments for parameters of type T that are not
       * instances of the class passed to the newUpdater call will
<span class="line-new-header">--- 516,74 ---</span>
      /**
       * All Atomic getAndUpdate methods throw NullPointerException on
       * null function argument
       */
      public void testGetAndUpdateNPE() {
<span class="line-modified">!         assertThrows(</span>
<span class="line-added">+             NullPointerException.class,</span>
              () -&gt; new AtomicLong().getAndUpdate(null),
              () -&gt; new AtomicInteger().getAndUpdate(null),
              () -&gt; new AtomicReference().getAndUpdate(null),
              () -&gt; new AtomicLongArray(1).getAndUpdate(0, null),
              () -&gt; new AtomicIntegerArray(1).getAndUpdate(0, null),
              () -&gt; new AtomicReferenceArray(1).getAndUpdate(0, null),
              () -&gt; aLongFieldUpdater().getAndUpdate(this, null),
              () -&gt; anIntFieldUpdater().getAndUpdate(this, null),
<span class="line-modified">!             () -&gt; anIntegerFieldUpdater().getAndUpdate(this, null));</span>
      }
  
      /**
       * All Atomic updateAndGet methods throw NullPointerException on null function argument
       */
      public void testUpdateAndGetNPE() {
<span class="line-modified">!         assertThrows(</span>
<span class="line-added">+             NullPointerException.class,</span>
              () -&gt; new AtomicLong().updateAndGet(null),
              () -&gt; new AtomicInteger().updateAndGet(null),
              () -&gt; new AtomicReference().updateAndGet(null),
              () -&gt; new AtomicLongArray(1).updateAndGet(0, null),
              () -&gt; new AtomicIntegerArray(1).updateAndGet(0, null),
              () -&gt; new AtomicReferenceArray(1).updateAndGet(0, null),
              () -&gt; aLongFieldUpdater().updateAndGet(this, null),
              () -&gt; anIntFieldUpdater().updateAndGet(this, null),
<span class="line-modified">!             () -&gt; anIntegerFieldUpdater().updateAndGet(this, null));</span>
      }
  
      /**
       * All Atomic getAndAccumulate methods throw NullPointerException
       * on null function argument
       */
      public void testGetAndAccumulateNPE() {
<span class="line-modified">!         assertThrows(</span>
<span class="line-added">+             NullPointerException.class,</span>
              () -&gt; new AtomicLong().getAndAccumulate(1L, null),
              () -&gt; new AtomicInteger().getAndAccumulate(1, null),
              () -&gt; new AtomicReference().getAndAccumulate(one, null),
              () -&gt; new AtomicLongArray(1).getAndAccumulate(0, 1L, null),
              () -&gt; new AtomicIntegerArray(1).getAndAccumulate(0, 1, null),
              () -&gt; new AtomicReferenceArray(1).getAndAccumulate(0, one, null),
              () -&gt; aLongFieldUpdater().getAndAccumulate(this, 1L, null),
              () -&gt; anIntFieldUpdater().getAndAccumulate(this, 1, null),
<span class="line-modified">!             () -&gt; anIntegerFieldUpdater().getAndAccumulate(this, one, null));</span>
      }
  
      /**
       * All Atomic accumulateAndGet methods throw NullPointerException
       * on null function argument
       */
      public void testAccumulateAndGetNPE() {
<span class="line-modified">!         assertThrows(</span>
<span class="line-added">+             NullPointerException.class,</span>
              () -&gt; new AtomicLong().accumulateAndGet(1L, null),
              () -&gt; new AtomicInteger().accumulateAndGet(1, null),
              () -&gt; new AtomicReference().accumulateAndGet(one, null),
              () -&gt; new AtomicLongArray(1).accumulateAndGet(0, 1L, null),
              () -&gt; new AtomicIntegerArray(1).accumulateAndGet(0, 1, null),
              () -&gt; new AtomicReferenceArray(1).accumulateAndGet(0, one, null),
              () -&gt; aLongFieldUpdater().accumulateAndGet(this, 1L, null),
              () -&gt; anIntFieldUpdater().accumulateAndGet(this, 1, null),
<span class="line-modified">!             () -&gt; anIntegerFieldUpdater().accumulateAndGet(this, one, null));</span>
      }
  
      /**
       * Object arguments for parameters of type T that are not
       * instances of the class passed to the newUpdater call will
</pre>
<hr />
<pre>
<span class="line-old-header">*** 596,13 ***</span>
      public void testFieldUpdaters_ClassCastException() {
          // Use raw types to allow passing wrong object type, provoking CCE
          final AtomicLongFieldUpdater longUpdater = aLongFieldUpdater();
          final AtomicIntegerFieldUpdater intUpdater = anIntFieldUpdater();
          final AtomicReferenceFieldUpdater refUpdater = anIntegerFieldUpdater();
<span class="line-removed">-         final Object obj = new Object();</span>
          for (Object x : new Object[]{ new Object(), null }) {
<span class="line-modified">!             Runnable[] throwingActions = {</span>
                  () -&gt; longUpdater.get(x),
                  () -&gt; intUpdater.get(x),
                  () -&gt; refUpdater.get(x),
  
                  () -&gt; longUpdater.set(x, 17L),
<span class="line-new-header">--- 592,13 ---</span>
      public void testFieldUpdaters_ClassCastException() {
          // Use raw types to allow passing wrong object type, provoking CCE
          final AtomicLongFieldUpdater longUpdater = aLongFieldUpdater();
          final AtomicIntegerFieldUpdater intUpdater = anIntFieldUpdater();
          final AtomicReferenceFieldUpdater refUpdater = anIntegerFieldUpdater();
          for (Object x : new Object[]{ new Object(), null }) {
<span class="line-modified">!             assertThrows(</span>
<span class="line-added">+                 ClassCastException.class,</span>
                  () -&gt; longUpdater.get(x),
                  () -&gt; intUpdater.get(x),
                  () -&gt; refUpdater.get(x),
  
                  () -&gt; longUpdater.set(x, 17L),
</pre>
<hr />
<pre>
<span class="line-old-header">*** 616,12 ***</span>
                  () -&gt; intUpdater.getAndUpdate(x, y -&gt; y),
                  () -&gt; refUpdater.getAndUpdate(x, y -&gt; y),
  
                  () -&gt; longUpdater.compareAndSet(x, 17L, 42L),
                  () -&gt; intUpdater.compareAndSet(x, 17, 42),
<span class="line-modified">!                 () -&gt; refUpdater.compareAndSet(x, (Integer) 17, (Integer) 42),</span>
<span class="line-removed">-             };</span>
<span class="line-removed">-             assertThrows(ClassCastException.class, throwingActions);</span>
          }
      }
  
  }
<span class="line-new-header">--- 612,10 ---</span>
                  () -&gt; intUpdater.getAndUpdate(x, y -&gt; y),
                  () -&gt; refUpdater.getAndUpdate(x, y -&gt; y),
  
                  () -&gt; longUpdater.compareAndSet(x, 17L, 42L),
                  () -&gt; intUpdater.compareAndSet(x, 17, 42),
<span class="line-modified">!                 () -&gt; refUpdater.compareAndSet(x, (Integer) 17, (Integer) 42));</span>
          }
      }
  
  }
</pre>
<center><a href="ArrayBlockingQueueTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="AtomicIntegerArray9Test.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>