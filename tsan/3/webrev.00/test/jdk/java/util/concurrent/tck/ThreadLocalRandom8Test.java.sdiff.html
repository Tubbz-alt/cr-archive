<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/util/concurrent/tck/ThreadLocalRandom8Test.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="SynchronousQueueTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="ThreadPoolExecutorSubclassTest.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/util/concurrent/tck/ThreadLocalRandom8Test.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 46     public static Test suite() {
 47         return new TestSuite(ThreadLocalRandom8Test.class);
 48     }
 49 
 50     // max sampled int bound
 51     static final int MAX_INT_BOUND = (1 &lt;&lt; 26);
 52 
 53     // max sampled long bound
 54     static final long MAX_LONG_BOUND = (1L &lt;&lt; 42);
 55 
 56     // Number of replications for other checks
 57     static final int REPS =
 58         Integer.getInteger(&quot;ThreadLocalRandom8Test.reps&quot;, 4);
 59 
 60     /**
 61      * Invoking sized ints, long, doubles, with negative sizes throws
 62      * IllegalArgumentException
 63      */
 64     public void testBadStreamSize() {
 65         ThreadLocalRandom r = ThreadLocalRandom.current();
<span class="line-modified"> 66         Runnable[] throwingActions = {</span>

 67             () -&gt; r.ints(-1L),
 68             () -&gt; r.ints(-1L, 2, 3),
 69             () -&gt; r.longs(-1L),
 70             () -&gt; r.longs(-1L, -1L, 1L),
 71             () -&gt; r.doubles(-1L),
<span class="line-modified"> 72             () -&gt; r.doubles(-1L, .5, .6),</span>
<span class="line-removed"> 73         };</span>
<span class="line-removed"> 74         assertThrows(IllegalArgumentException.class, throwingActions);</span>
 75     }
 76 
 77     /**
 78      * Invoking bounded ints, long, doubles, with illegal bounds throws
 79      * IllegalArgumentException
 80      */
 81     public void testBadStreamBounds() {
 82         ThreadLocalRandom r = ThreadLocalRandom.current();
<span class="line-modified"> 83         Runnable[] throwingActions = {</span>

 84             () -&gt; r.ints(2, 1),
 85             () -&gt; r.ints(10, 42, 42),
 86             () -&gt; r.longs(-1L, -1L),
 87             () -&gt; r.longs(10, 1L, -2L),
 88             () -&gt; r.doubles(0.0, 0.0),
<span class="line-modified"> 89             () -&gt; r.doubles(10, .5, .4),</span>
<span class="line-removed"> 90         };</span>
<span class="line-removed"> 91         assertThrows(IllegalArgumentException.class, throwingActions);</span>
 92     }
 93 
 94     /**
 95      * A parallel sized stream of ints generates the given number of values
 96      */
 97     public void testIntsCount() {
 98         LongAdder counter = new LongAdder();
 99         ThreadLocalRandom r = ThreadLocalRandom.current();
100         long size = 0;
101         for (int reps = 0; reps &lt; REPS; ++reps) {
102             counter.reset();
103             r.ints(size).parallel().forEach(x -&gt; counter.increment());
104             assertEquals(size, counter.sum());
105             size += 524959;
106         }
107     }
108 
109     /**
110      * A parallel sized stream of longs generates the given number of values
111      */
</pre>
</td>
<td>
<hr />
<pre>
 46     public static Test suite() {
 47         return new TestSuite(ThreadLocalRandom8Test.class);
 48     }
 49 
 50     // max sampled int bound
 51     static final int MAX_INT_BOUND = (1 &lt;&lt; 26);
 52 
 53     // max sampled long bound
 54     static final long MAX_LONG_BOUND = (1L &lt;&lt; 42);
 55 
 56     // Number of replications for other checks
 57     static final int REPS =
 58         Integer.getInteger(&quot;ThreadLocalRandom8Test.reps&quot;, 4);
 59 
 60     /**
 61      * Invoking sized ints, long, doubles, with negative sizes throws
 62      * IllegalArgumentException
 63      */
 64     public void testBadStreamSize() {
 65         ThreadLocalRandom r = ThreadLocalRandom.current();
<span class="line-modified"> 66         assertThrows(</span>
<span class="line-added"> 67             IllegalArgumentException.class,</span>
 68             () -&gt; r.ints(-1L),
 69             () -&gt; r.ints(-1L, 2, 3),
 70             () -&gt; r.longs(-1L),
 71             () -&gt; r.longs(-1L, -1L, 1L),
 72             () -&gt; r.doubles(-1L),
<span class="line-modified"> 73             () -&gt; r.doubles(-1L, .5, .6));</span>


 74     }
 75 
 76     /**
 77      * Invoking bounded ints, long, doubles, with illegal bounds throws
 78      * IllegalArgumentException
 79      */
 80     public void testBadStreamBounds() {
 81         ThreadLocalRandom r = ThreadLocalRandom.current();
<span class="line-modified"> 82         assertThrows(</span>
<span class="line-added"> 83             IllegalArgumentException.class,</span>
 84             () -&gt; r.ints(2, 1),
 85             () -&gt; r.ints(10, 42, 42),
 86             () -&gt; r.longs(-1L, -1L),
 87             () -&gt; r.longs(10, 1L, -2L),
 88             () -&gt; r.doubles(0.0, 0.0),
<span class="line-modified"> 89             () -&gt; r.doubles(10, .5, .4));</span>


 90     }
 91 
 92     /**
 93      * A parallel sized stream of ints generates the given number of values
 94      */
 95     public void testIntsCount() {
 96         LongAdder counter = new LongAdder();
 97         ThreadLocalRandom r = ThreadLocalRandom.current();
 98         long size = 0;
 99         for (int reps = 0; reps &lt; REPS; ++reps) {
100             counter.reset();
101             r.ints(size).parallel().forEach(x -&gt; counter.increment());
102             assertEquals(size, counter.sum());
103             size += 524959;
104         }
105     }
106 
107     /**
108      * A parallel sized stream of longs generates the given number of values
109      */
</pre>
</td>
</tr>
</table>
<center><a href="SynchronousQueueTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="ThreadPoolExecutorSubclassTest.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>