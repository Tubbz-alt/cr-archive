<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/util/concurrent/tck/CompletableFutureTest.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="Collection8Test.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="ConcurrentHashMapTest.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/util/concurrent/tck/CompletableFutureTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
3448             CompletableFuture&lt;Object&gt; f = CompletableFuture.anyOf(fs);
3449             checkIncomplete(f);
3450             for (int i = k - 1; i &gt;= 0; i--) {
3451                 fs[i].completeExceptionally(exs[i]);
3452                 checkCompletedWithWrappedException(f, exs[k - 1]);
3453                 checkCompletedWithWrappedCFException(CompletableFuture.anyOf(fs));
3454             }
3455         }
3456     }
3457 
3458     /**
3459      * Completion methods throw NullPointerException with null arguments
3460      */
3461     @SuppressWarnings(&quot;FutureReturnValueIgnored&quot;)
3462     public void testNPE() {
3463         CompletableFuture&lt;Integer&gt; f = new CompletableFuture&lt;&gt;();
3464         CompletableFuture&lt;Integer&gt; g = new CompletableFuture&lt;&gt;();
3465         CompletableFuture&lt;Integer&gt; nullFuture = (CompletableFuture&lt;Integer&gt;)null;
3466         ThreadExecutor exec = new ThreadExecutor();
3467 
<span class="line-modified">3468         Runnable[] throwingActions = {</span>


3469             () -&gt; CompletableFuture.supplyAsync(null),
3470             () -&gt; CompletableFuture.supplyAsync(null, exec),
3471             () -&gt; CompletableFuture.supplyAsync(new IntegerSupplier(ExecutionMode.SYNC, 42), null),
3472 
3473             () -&gt; CompletableFuture.runAsync(null),
3474             () -&gt; CompletableFuture.runAsync(null, exec),
3475             () -&gt; CompletableFuture.runAsync(() -&gt; {}, null),
3476 
3477             () -&gt; f.completeExceptionally(null),
3478 
3479             () -&gt; f.thenApply(null),
3480             () -&gt; f.thenApplyAsync(null),
3481             () -&gt; f.thenApplyAsync(x -&gt; x, null),
3482             () -&gt; f.thenApplyAsync(null, exec),
3483 
3484             () -&gt; f.thenAccept(null),
3485             () -&gt; f.thenAcceptAsync(null),
3486             () -&gt; f.thenAcceptAsync(x -&gt; {} , null),
3487             () -&gt; f.thenAcceptAsync(null, exec),
3488 
</pre>
<hr />
<pre>
3551             () -&gt; CompletableFuture.allOf((CompletableFuture&lt;?&gt;)null),
3552             () -&gt; CompletableFuture.allOf((CompletableFuture&lt;?&gt;[])null),
3553             () -&gt; CompletableFuture.allOf(f, null),
3554             () -&gt; CompletableFuture.allOf(null, f),
3555 
3556             () -&gt; CompletableFuture.anyOf((CompletableFuture&lt;?&gt;)null),
3557             () -&gt; CompletableFuture.anyOf((CompletableFuture&lt;?&gt;[])null),
3558             () -&gt; CompletableFuture.anyOf(f, null),
3559             () -&gt; CompletableFuture.anyOf(null, f),
3560 
3561             () -&gt; f.obtrudeException(null),
3562 
3563             () -&gt; CompletableFuture.delayedExecutor(1L, SECONDS, null),
3564             () -&gt; CompletableFuture.delayedExecutor(1L, null, exec),
3565             () -&gt; CompletableFuture.delayedExecutor(1L, null),
3566 
3567             () -&gt; f.orTimeout(1L, null),
3568             () -&gt; f.completeOnTimeout(42, 1L, null),
3569 
3570             () -&gt; CompletableFuture.failedFuture(null),
<span class="line-modified">3571             () -&gt; CompletableFuture.failedStage(null),</span>
<span class="line-removed">3572         };</span>
3573 
<span class="line-removed">3574         assertThrows(NullPointerException.class, throwingActions);</span>
3575         assertEquals(0, exec.count.get());
3576     }
3577 
3578     /**
3579      * Test submissions to an executor that rejects all tasks.
3580      */
3581     public void testRejectingExecutor() {
3582         for (Integer v : new Integer[] { 1, null })
3583     {
3584         final CountingRejectingExecutor e = new CountingRejectingExecutor();
3585 
3586         final CompletableFuture&lt;Integer&gt; complete = CompletableFuture.completedFuture(v);
3587         final CompletableFuture&lt;Integer&gt; incomplete = new CompletableFuture&lt;&gt;();
3588 
3589         List&lt;CompletableFuture&lt;?&gt;&gt; futures = new ArrayList&lt;&gt;();
3590 
3591         List&lt;CompletableFuture&lt;Integer&gt;&gt; srcs = new ArrayList&lt;&gt;();
3592         srcs.add(complete);
3593         srcs.add(incomplete);
3594 
</pre>
</td>
<td>
<hr />
<pre>
3448             CompletableFuture&lt;Object&gt; f = CompletableFuture.anyOf(fs);
3449             checkIncomplete(f);
3450             for (int i = k - 1; i &gt;= 0; i--) {
3451                 fs[i].completeExceptionally(exs[i]);
3452                 checkCompletedWithWrappedException(f, exs[k - 1]);
3453                 checkCompletedWithWrappedCFException(CompletableFuture.anyOf(fs));
3454             }
3455         }
3456     }
3457 
3458     /**
3459      * Completion methods throw NullPointerException with null arguments
3460      */
3461     @SuppressWarnings(&quot;FutureReturnValueIgnored&quot;)
3462     public void testNPE() {
3463         CompletableFuture&lt;Integer&gt; f = new CompletableFuture&lt;&gt;();
3464         CompletableFuture&lt;Integer&gt; g = new CompletableFuture&lt;&gt;();
3465         CompletableFuture&lt;Integer&gt; nullFuture = (CompletableFuture&lt;Integer&gt;)null;
3466         ThreadExecutor exec = new ThreadExecutor();
3467 
<span class="line-modified">3468         assertThrows(</span>
<span class="line-added">3469             NullPointerException.class,</span>
<span class="line-added">3470 </span>
3471             () -&gt; CompletableFuture.supplyAsync(null),
3472             () -&gt; CompletableFuture.supplyAsync(null, exec),
3473             () -&gt; CompletableFuture.supplyAsync(new IntegerSupplier(ExecutionMode.SYNC, 42), null),
3474 
3475             () -&gt; CompletableFuture.runAsync(null),
3476             () -&gt; CompletableFuture.runAsync(null, exec),
3477             () -&gt; CompletableFuture.runAsync(() -&gt; {}, null),
3478 
3479             () -&gt; f.completeExceptionally(null),
3480 
3481             () -&gt; f.thenApply(null),
3482             () -&gt; f.thenApplyAsync(null),
3483             () -&gt; f.thenApplyAsync(x -&gt; x, null),
3484             () -&gt; f.thenApplyAsync(null, exec),
3485 
3486             () -&gt; f.thenAccept(null),
3487             () -&gt; f.thenAcceptAsync(null),
3488             () -&gt; f.thenAcceptAsync(x -&gt; {} , null),
3489             () -&gt; f.thenAcceptAsync(null, exec),
3490 
</pre>
<hr />
<pre>
3553             () -&gt; CompletableFuture.allOf((CompletableFuture&lt;?&gt;)null),
3554             () -&gt; CompletableFuture.allOf((CompletableFuture&lt;?&gt;[])null),
3555             () -&gt; CompletableFuture.allOf(f, null),
3556             () -&gt; CompletableFuture.allOf(null, f),
3557 
3558             () -&gt; CompletableFuture.anyOf((CompletableFuture&lt;?&gt;)null),
3559             () -&gt; CompletableFuture.anyOf((CompletableFuture&lt;?&gt;[])null),
3560             () -&gt; CompletableFuture.anyOf(f, null),
3561             () -&gt; CompletableFuture.anyOf(null, f),
3562 
3563             () -&gt; f.obtrudeException(null),
3564 
3565             () -&gt; CompletableFuture.delayedExecutor(1L, SECONDS, null),
3566             () -&gt; CompletableFuture.delayedExecutor(1L, null, exec),
3567             () -&gt; CompletableFuture.delayedExecutor(1L, null),
3568 
3569             () -&gt; f.orTimeout(1L, null),
3570             () -&gt; f.completeOnTimeout(42, 1L, null),
3571 
3572             () -&gt; CompletableFuture.failedFuture(null),
<span class="line-modified">3573             () -&gt; CompletableFuture.failedStage(null));</span>

3574 

3575         assertEquals(0, exec.count.get());
3576     }
3577 
3578     /**
3579      * Test submissions to an executor that rejects all tasks.
3580      */
3581     public void testRejectingExecutor() {
3582         for (Integer v : new Integer[] { 1, null })
3583     {
3584         final CountingRejectingExecutor e = new CountingRejectingExecutor();
3585 
3586         final CompletableFuture&lt;Integer&gt; complete = CompletableFuture.completedFuture(v);
3587         final CompletableFuture&lt;Integer&gt; incomplete = new CompletableFuture&lt;&gt;();
3588 
3589         List&lt;CompletableFuture&lt;?&gt;&gt; futures = new ArrayList&lt;&gt;();
3590 
3591         List&lt;CompletableFuture&lt;Integer&gt;&gt; srcs = new ArrayList&lt;&gt;();
3592         srcs.add(complete);
3593         srcs.add(incomplete);
3594 
</pre>
</td>
</tr>
</table>
<center><a href="Collection8Test.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="ConcurrentHashMapTest.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>