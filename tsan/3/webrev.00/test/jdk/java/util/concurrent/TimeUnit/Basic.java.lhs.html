<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames test/jdk/java/util/concurrent/TimeUnit/Basic.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (c) 2005, 2006, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 /* @test
 25  * @bug 5057341 6363898
 26  * @summary Basic tests for TimeUnit
<a name="1" id="anc1"></a>
 27  * @author Martin Buchholz
 28  */
 29 
 30 import static java.util.concurrent.TimeUnit.DAYS;
 31 import static java.util.concurrent.TimeUnit.HOURS;
 32 import static java.util.concurrent.TimeUnit.MICROSECONDS;
 33 import static java.util.concurrent.TimeUnit.MILLISECONDS;
 34 import static java.util.concurrent.TimeUnit.MINUTES;
 35 import static java.util.concurrent.TimeUnit.NANOSECONDS;
 36 import static java.util.concurrent.TimeUnit.SECONDS;
 37 
 38 import java.io.ByteArrayInputStream;
 39 import java.io.ByteArrayOutputStream;
 40 import java.io.IOException;
 41 import java.io.InputStream;
<a name="2" id="anc2"></a>
 42 import java.io.ObjectOutputStream;
 43 import java.io.ObjectInputStream;
 44 import java.util.Arrays;
<a name="3" id="anc3"></a>

 45 import java.util.concurrent.TimeUnit;
<a name="4" id="anc4"></a>


 46 
 47 public class Basic {
<a name="5" id="anc5"></a>

 48     private static void realMain(String[] args) throws Throwable {
 49 
 50         for (TimeUnit u : TimeUnit.values()) {
 51             System.out.println(u);
 52             check(u instanceof TimeUnit);
 53             equal(42L, u.convert(42, u));
 54             for (TimeUnit v : TimeUnit.values())
 55                 if (u.convert(42, v) &gt;= 42)
 56                     equal(42L, v.convert(u.convert(42, v), u));
 57             check(readObject(serializedForm(u)) == u);
 58         }
 59 
 60         equal(  24L, HOURS.convert       (1, DAYS));
 61         equal(  60L, MINUTES.convert     (1, HOURS));
 62         equal(  60L, SECONDS.convert     (1, MINUTES));
 63         equal(1000L, MILLISECONDS.convert(1, SECONDS));
 64         equal(1000L, MICROSECONDS.convert(1, MILLISECONDS));
 65         equal(1000L, NANOSECONDS.convert (1, MICROSECONDS));
 66 
 67         equal(  24L, DAYS.toHours(1));
 68         equal(  60L, HOURS.toMinutes(1));
 69         equal(  60L, MINUTES.toSeconds(1));
 70         equal(1000L, SECONDS.toMillis(1));
 71         equal(1000L, MILLISECONDS.toMicros(1));
 72         equal(1000L, MICROSECONDS.toNanos(1));
 73 
<a name="6" id="anc6"></a><span class="line-modified"> 74         long t0 = System.nanoTime();</span>
<span class="line-modified"> 75         MILLISECONDS.sleep(3); /* See windows bug 6313903, might not sleep */</span>
<span class="line-modified"> 76         long elapsedMillis = (System.nanoTime() - t0)/(1000L * 1000L);</span>
<span class="line-modified"> 77         System.out.printf(&quot;elapsed=%d%n&quot;, elapsedMillis);</span>
<span class="line-modified"> 78         check(elapsedMillis &gt;= 0);</span>
<span class="line-modified"> 79         /* Might not sleep on windows: check(elapsedMillis &gt;= 3); */</span>
<span class="line-modified"> 80         check(elapsedMillis &lt; 1000);</span>















 81 
 82         //----------------------------------------------------------------
 83         // Tests for serialized form compatibility with previous release
 84         //----------------------------------------------------------------
<a name="7" id="anc7"></a><span class="line-modified"> 85         byte[] serializedForm = /* Generated using tiger */</span>
 86             {-84, -19, 0, 5, &#39;~&#39;, &#39;r&#39;, 0, 29, &#39;j&#39;, &#39;a&#39;, &#39;v&#39;, &#39;a&#39;, &#39;.&#39;,
 87              &#39;u&#39;, &#39;t&#39;, &#39;i&#39;, &#39;l&#39;, &#39;.&#39;, &#39;c&#39;, &#39;o&#39;, &#39;n&#39;, &#39;c&#39;, &#39;u&#39;, &#39;r&#39;, &#39;r&#39;, &#39;e&#39;,
 88              &#39;n&#39;, &#39;t&#39;, &#39;.&#39;, &#39;T&#39;, &#39;i&#39;, &#39;m&#39;, &#39;e&#39;, &#39;U&#39;, &#39;n&#39;, &#39;i&#39;, &#39;t&#39;, 0, 0,
 89              0, 0, 0, 0, 0, 0, 18, 0, 0, &#39;x&#39;, &#39;r&#39;, 0, 14,
 90              &#39;j&#39;, &#39;a&#39;, &#39;v&#39;, &#39;a&#39;, &#39;.&#39;, &#39;l&#39;, &#39;a&#39;, &#39;n&#39;, &#39;g&#39;, &#39;.&#39;, &#39;E&#39;, &#39;n&#39;, &#39;u&#39;,
 91              &#39;m&#39;, 0, 0, 0, 0, 0, 0, 0, 0, 18, 0, 0, &#39;x&#39;,
 92              &#39;p&#39;, &#39;t&#39;, 0, 7, &#39;S&#39;, &#39;E&#39;, &#39;C&#39;, &#39;O&#39;, &#39;N&#39;, &#39;D&#39;, &#39;S&#39;, };
 93         check(Arrays.equals(serializedForm(SECONDS), serializedForm));
 94     }
 95 
 96     //--------------------- Infrastructure ---------------------------
 97     static volatile int passed = 0, failed = 0;
 98     static void pass() {passed++;}
 99     static void fail() {failed++; Thread.dumpStack();}
100     static void fail(String msg) {System.out.println(msg); fail();}
101     static void unexpected(Throwable t) {failed++; t.printStackTrace();}
102     static void check(boolean cond) {if (cond) pass(); else fail();}
103     static void equal(Object x, Object y) {
104         if (x == null ? y == null : x.equals(y)) pass();
105         else fail(x + &quot; not equal to &quot; + y);}
106     public static void main(String[] args) throws Throwable {
107         try {realMain(args);} catch (Throwable t) {unexpected(t);}
108         System.out.printf(&quot;%nPassed = %d, failed = %d%n%n&quot;, passed, failed);
109         if (failed &gt; 0) throw new AssertionError(&quot;Some tests failed&quot;);}
110     static byte[] serializedForm(Object obj) throws IOException {
111         ByteArrayOutputStream baos = new ByteArrayOutputStream();
112         new ObjectOutputStream(baos).writeObject(obj);
113         return baos.toByteArray();
114     }
115     static Object readObject(byte[] bytes)
116         throws IOException, ClassNotFoundException {
117         InputStream is = new ByteArrayInputStream(bytes);
118         return new ObjectInputStream(is).readObject();
119     }
120 }
<a name="8" id="anc8"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="8" type="hidden" />
</body>
</html>