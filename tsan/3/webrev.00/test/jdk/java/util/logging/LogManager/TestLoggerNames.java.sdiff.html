<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/util/logging/LogManager/TestLoggerNames.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="RootLogger/setLevel/TestRootLoggerLevel.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../LogManagerAppContextDeadlock.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/util/logging/LogManager/TestLoggerNames.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
116         List&lt;String&gt; loggerNames = Collections.list(names);
117         if (!loggerNames.contains(&quot;&quot;)) {
118             throw new RuntimeException(&quot;\&quot;\&quot;&quot; +
119                     &quot; not found in &quot; + loggerNames);
120         }
121         if (!loggerNames.contains(&quot;global&quot;)) {
122             throw new RuntimeException(&quot;global&quot; +
123                     &quot; not found in &quot; + loggerNames);
124         }
125         for (Logger l : loggers) {
126             if (!loggerNames.contains(l.getName())) {
127                 throw new RuntimeException(l.getName() +
128                         &quot; not found in &quot; + loggerNames);
129             }
130         }
131         System.out.println(&quot;Got all expected logger names&quot;);
132     }
133 
134 
135     public static void main(String[] args) throws InterruptedException {
<span class="line-modified">136         LogManager.getLogManager().addLogger(new TestLogger(&quot;com.foo.bar.zzz&quot;, null));</span>

137         try {
138             Logger.getLogger(null);
139             throw new RuntimeException(&quot;Logger.getLogger(null) didn&#39;t throw expected NPE&quot;);
140         } catch (NullPointerException x) {
141             System.out.println(&quot;Got expected NullPointerException for Logger.getLogger(null)&quot;);
142         }
143         List&lt;Logger&gt; loggers = new CopyOnWriteArrayList&lt;&gt;();
144         loggers.add(Logger.getLogger(&quot;one.two.addMeAChild&quot;));
145         loggers.add(Logger.getLogger(&quot;aaa.bbb.replaceMe&quot;));
146         loggers.add(Logger.getLogger(&quot;bbb.aaa.addMeAChild&quot;));
<span class="line-modified">147         TestLogger test = (TestLogger)Logger.getLogger(&quot;com.foo.bar.zzz&quot;);</span>


148         loggers.add(Logger.getLogger(&quot;ddd.aaa.addMeAChild&quot;));
149 
150         checkLoggerNames(loggers);
151 
152         Thread loggerNamesThread = new Thread(() -&gt; {
153             try {
154                 while (!stop) {
155                     // Make a defensive copy of the list of loggers that we pass
156                     // to checkLoggerNames - in order to make sure that
157                     // we won&#39;t see new loggers that might appear after
158                     // checkLoggerNames has called LogManager.getLoggerNames().
159                     // (&#39;loggers&#39; is a live list and the main thread adds and
160                     //  and removes loggers from it concurrently to this thread).
161                     checkLoggerNames(new ArrayList&lt;&gt;(loggers));
162                     Thread.sleep(10);
163                     if (!stop) {
164                         phaser.arriveAndAwaitAdvance();
165                     }
166                 }
167             } catch (Throwable t) {
</pre>
</td>
<td>
<hr />
<pre>
116         List&lt;String&gt; loggerNames = Collections.list(names);
117         if (!loggerNames.contains(&quot;&quot;)) {
118             throw new RuntimeException(&quot;\&quot;\&quot;&quot; +
119                     &quot; not found in &quot; + loggerNames);
120         }
121         if (!loggerNames.contains(&quot;global&quot;)) {
122             throw new RuntimeException(&quot;global&quot; +
123                     &quot; not found in &quot; + loggerNames);
124         }
125         for (Logger l : loggers) {
126             if (!loggerNames.contains(l.getName())) {
127                 throw new RuntimeException(l.getName() +
128                         &quot; not found in &quot; + loggerNames);
129             }
130         }
131         System.out.println(&quot;Got all expected logger names&quot;);
132     }
133 
134 
135     public static void main(String[] args) throws InterruptedException {
<span class="line-modified">136         TestLogger test = new TestLogger(&quot;com.foo.bar.zzz&quot;, null);</span>
<span class="line-added">137         LogManager.getLogManager().addLogger(test);</span>
138         try {
139             Logger.getLogger(null);
140             throw new RuntimeException(&quot;Logger.getLogger(null) didn&#39;t throw expected NPE&quot;);
141         } catch (NullPointerException x) {
142             System.out.println(&quot;Got expected NullPointerException for Logger.getLogger(null)&quot;);
143         }
144         List&lt;Logger&gt; loggers = new CopyOnWriteArrayList&lt;&gt;();
145         loggers.add(Logger.getLogger(&quot;one.two.addMeAChild&quot;));
146         loggers.add(Logger.getLogger(&quot;aaa.bbb.replaceMe&quot;));
147         loggers.add(Logger.getLogger(&quot;bbb.aaa.addMeAChild&quot;));
<span class="line-modified">148         if (test != Logger.getLogger(&quot;com.foo.bar.zzz&quot;)) {</span>
<span class="line-added">149             throw new AssertionError(&quot;wrong logger returned&quot;);</span>
<span class="line-added">150         }</span>
151         loggers.add(Logger.getLogger(&quot;ddd.aaa.addMeAChild&quot;));
152 
153         checkLoggerNames(loggers);
154 
155         Thread loggerNamesThread = new Thread(() -&gt; {
156             try {
157                 while (!stop) {
158                     // Make a defensive copy of the list of loggers that we pass
159                     // to checkLoggerNames - in order to make sure that
160                     // we won&#39;t see new loggers that might appear after
161                     // checkLoggerNames has called LogManager.getLoggerNames().
162                     // (&#39;loggers&#39; is a live list and the main thread adds and
163                     //  and removes loggers from it concurrently to this thread).
164                     checkLoggerNames(new ArrayList&lt;&gt;(loggers));
165                     Thread.sleep(10);
166                     if (!stop) {
167                         phaser.arriveAndAwaitAdvance();
168                     }
169                 }
170             } catch (Throwable t) {
</pre>
</td>
</tr>
</table>
<center><a href="RootLogger/setLevel/TestRootLoggerLevel.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../LogManagerAppContextDeadlock.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>