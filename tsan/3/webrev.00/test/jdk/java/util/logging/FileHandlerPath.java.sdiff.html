<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/util/logging/FileHandlerPath.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="FileHandlerLongLimit.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="FileHandlerPatternExceptions.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/util/logging/FileHandlerPath.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2014, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
</pre>
<hr />
<pre>
253             perms.add(p);
254             return this;
255         }
256         public PermissionsBuilder addAll(PermissionCollection col) {
257             if (col != null) {
258                 for (Enumeration&lt;Permission&gt; e = col.elements(); e.hasMoreElements(); ) {
259                     perms.add(e.nextElement());
260                 }
261             }
262             return this;
263         }
264         public Permissions toPermissions() {
265             final PermissionsBuilder builder = new PermissionsBuilder();
266             builder.addAll(perms);
267             return builder.perms;
268         }
269     }
270 
271     public static class SimplePolicy extends Policy {
272 


273         final Permissions permissions;
274         final Permissions allPermissions;
275         final AtomicBoolean allowAll;
276         public SimplePolicy(TestCase test, AtomicBoolean allowAll) {
277             this.allowAll = allowAll;
278             permissions = new Permissions();
279             permissions.add(new LoggingPermission(&quot;control&quot;, null)); // needed by new FileHandler()
280             permissions.add(new FilePermission(&quot;&lt;&lt;ALL FILES&gt;&gt;&quot;, &quot;read&quot;)); // needed by new FileHandler()
281             permissions.add(new FilePermission(logFile, &quot;write,delete&quot;)); // needed by new FileHandler()
282             permissions.add(new FilePermission(logFile+&quot;.lck&quot;, &quot;write,delete&quot;)); // needed by FileHandler.close()
283             permissions.add(new FilePermission(logFile+&quot;.1&quot;, &quot;write,delete&quot;)); // needed by new FileHandler()
284             permissions.add(new FilePermission(logFile+&quot;.1.lck&quot;, &quot;write,delete&quot;)); // needed by FileHandler.close()
285             permissions.add(new FilePermission(tmpLogFile, &quot;write,delete&quot;)); // needed by new FileHandler()
286             permissions.add(new FilePermission(tmpLogFile+&quot;.lck&quot;, &quot;write,delete&quot;)); // needed by FileHandler.close()
287             permissions.add(new FilePermission(tmpLogFile+&quot;.1&quot;, &quot;write,delete&quot;)); // needed by new FileHandler()
288             permissions.add(new FilePermission(tmpLogFile+&quot;.1.lck&quot;, &quot;write,delete&quot;)); // needed by FileHandler.close()
289             permissions.add(new FilePermission(userDir, &quot;write&quot;)); // needed by new FileHandler()
290             permissions.add(new FilePermission(tmpDir, &quot;write&quot;)); // needed by new FileHandler()
291             permissions.add(new PropertyPermission(&quot;user.dir&quot;, &quot;read&quot;));
292             permissions.add(new PropertyPermission(&quot;java.io.tmpdir&quot;, &quot;read&quot;));
293             allPermissions = new Permissions();
294             allPermissions.add(new java.security.AllPermission());
295         }
296 
297         @Override
298         public boolean implies(ProtectionDomain domain, Permission permission) {
299             if (allowAll.get()) return allPermissions.implies(permission);
<span class="line-modified">300             return permissions.implies(permission);</span>
301         }
302 
303         @Override
304         public PermissionCollection getPermissions(CodeSource codesource) {
305             return new PermissionsBuilder().addAll(allowAll.get()
306                     ? allPermissions : permissions).toPermissions();
307         }
308 
309         @Override
310         public PermissionCollection getPermissions(ProtectionDomain domain) {
311             return new PermissionsBuilder().addAll(allowAll.get()
312                     ? allPermissions : permissions).toPermissions();
313         }
314     }
315 
316 }
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2014, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
</pre>
<hr />
<pre>
253             perms.add(p);
254             return this;
255         }
256         public PermissionsBuilder addAll(PermissionCollection col) {
257             if (col != null) {
258                 for (Enumeration&lt;Permission&gt; e = col.elements(); e.hasMoreElements(); ) {
259                     perms.add(e.nextElement());
260                 }
261             }
262             return this;
263         }
264         public Permissions toPermissions() {
265             final PermissionsBuilder builder = new PermissionsBuilder();
266             builder.addAll(perms);
267             return builder.perms;
268         }
269     }
270 
271     public static class SimplePolicy extends Policy {
272 
<span class="line-added">273         static final Policy DEFAULT_POLICY = Policy.getPolicy();</span>
<span class="line-added">274 </span>
275         final Permissions permissions;
276         final Permissions allPermissions;
277         final AtomicBoolean allowAll;
278         public SimplePolicy(TestCase test, AtomicBoolean allowAll) {
279             this.allowAll = allowAll;
280             permissions = new Permissions();
281             permissions.add(new LoggingPermission(&quot;control&quot;, null)); // needed by new FileHandler()
282             permissions.add(new FilePermission(&quot;&lt;&lt;ALL FILES&gt;&gt;&quot;, &quot;read&quot;)); // needed by new FileHandler()
283             permissions.add(new FilePermission(logFile, &quot;write,delete&quot;)); // needed by new FileHandler()
284             permissions.add(new FilePermission(logFile+&quot;.lck&quot;, &quot;write,delete&quot;)); // needed by FileHandler.close()
285             permissions.add(new FilePermission(logFile+&quot;.1&quot;, &quot;write,delete&quot;)); // needed by new FileHandler()
286             permissions.add(new FilePermission(logFile+&quot;.1.lck&quot;, &quot;write,delete&quot;)); // needed by FileHandler.close()
287             permissions.add(new FilePermission(tmpLogFile, &quot;write,delete&quot;)); // needed by new FileHandler()
288             permissions.add(new FilePermission(tmpLogFile+&quot;.lck&quot;, &quot;write,delete&quot;)); // needed by FileHandler.close()
289             permissions.add(new FilePermission(tmpLogFile+&quot;.1&quot;, &quot;write,delete&quot;)); // needed by new FileHandler()
290             permissions.add(new FilePermission(tmpLogFile+&quot;.1.lck&quot;, &quot;write,delete&quot;)); // needed by FileHandler.close()
291             permissions.add(new FilePermission(userDir, &quot;write&quot;)); // needed by new FileHandler()
292             permissions.add(new FilePermission(tmpDir, &quot;write&quot;)); // needed by new FileHandler()
293             permissions.add(new PropertyPermission(&quot;user.dir&quot;, &quot;read&quot;));
294             permissions.add(new PropertyPermission(&quot;java.io.tmpdir&quot;, &quot;read&quot;));
295             allPermissions = new Permissions();
296             allPermissions.add(new java.security.AllPermission());
297         }
298 
299         @Override
300         public boolean implies(ProtectionDomain domain, Permission permission) {
301             if (allowAll.get()) return allPermissions.implies(permission);
<span class="line-modified">302             return permissions.implies(permission) || DEFAULT_POLICY.implies(domain, permission);</span>
303         }
304 
305         @Override
306         public PermissionCollection getPermissions(CodeSource codesource) {
307             return new PermissionsBuilder().addAll(allowAll.get()
308                     ? allPermissions : permissions).toPermissions();
309         }
310 
311         @Override
312         public PermissionCollection getPermissions(ProtectionDomain domain) {
313             return new PermissionsBuilder().addAll(allowAll.get()
314                     ? allPermissions : permissions).toPermissions();
315         }
316     }
317 
318 }
</pre>
</td>
</tr>
</table>
<center><a href="FileHandlerLongLimit.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="FileHandlerPatternExceptions.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>