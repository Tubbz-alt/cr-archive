<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/util/logging/FileHandlerPatternExceptions.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="FileHandlerPath.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="LogManager/Configuration/ParentLoggerWithHandlerGC.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/util/logging/FileHandlerPatternExceptions.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2014, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
</pre>
<hr />
<pre>
277             perms.add(p);
278             return this;
279         }
280         public PermissionsBuilder addAll(PermissionCollection col) {
281             if (col != null) {
282                 for (Enumeration&lt;Permission&gt; e = col.elements(); e.hasMoreElements(); ) {
283                     perms.add(e.nextElement());
284                 }
285             }
286             return this;
287         }
288         public Permissions toPermissions() {
289             final PermissionsBuilder builder = new PermissionsBuilder();
290             builder.addAll(perms);
291             return builder.perms;
292         }
293     }
294 
295     public static class SimplePolicy extends Policy {
296 


297         final Permissions permissions;
298         final Permissions allPermissions;
299         final AtomicBoolean allowAll;
300         public SimplePolicy(TestCase test, AtomicBoolean allowAll) {
301             this.allowAll = allowAll;
302             // we don&#39;t actually need any permission to create our
303             // FileHandlers because we&#39;re passing invalid parameters
304             // which will make the creation fail...
305             permissions = new Permissions();
306 
307             // these are used for configuring the test itself...
308             allPermissions = new Permissions();
309             allPermissions.add(new java.security.AllPermission());
310 
311         }
312 
313         @Override
314         public boolean implies(ProtectionDomain domain, Permission permission) {
315             if (allowAll.get()) return allPermissions.implies(permission);
<span class="line-modified">316             return permissions.implies(permission);</span>
317         }
318 
319         @Override
320         public PermissionCollection getPermissions(CodeSource codesource) {
321             return new PermissionsBuilder().addAll(allowAll.get()
322                     ? allPermissions : permissions).toPermissions();
323         }
324 
325         @Override
326         public PermissionCollection getPermissions(ProtectionDomain domain) {
327             return new PermissionsBuilder().addAll(allowAll.get()
328                     ? allPermissions : permissions).toPermissions();
329         }
330     }
331 
332 }
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2014, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
</pre>
<hr />
<pre>
277             perms.add(p);
278             return this;
279         }
280         public PermissionsBuilder addAll(PermissionCollection col) {
281             if (col != null) {
282                 for (Enumeration&lt;Permission&gt; e = col.elements(); e.hasMoreElements(); ) {
283                     perms.add(e.nextElement());
284                 }
285             }
286             return this;
287         }
288         public Permissions toPermissions() {
289             final PermissionsBuilder builder = new PermissionsBuilder();
290             builder.addAll(perms);
291             return builder.perms;
292         }
293     }
294 
295     public static class SimplePolicy extends Policy {
296 
<span class="line-added">297         static final Policy DEFAULT_POLICY = Policy.getPolicy();</span>
<span class="line-added">298 </span>
299         final Permissions permissions;
300         final Permissions allPermissions;
301         final AtomicBoolean allowAll;
302         public SimplePolicy(TestCase test, AtomicBoolean allowAll) {
303             this.allowAll = allowAll;
304             // we don&#39;t actually need any permission to create our
305             // FileHandlers because we&#39;re passing invalid parameters
306             // which will make the creation fail...
307             permissions = new Permissions();
308 
309             // these are used for configuring the test itself...
310             allPermissions = new Permissions();
311             allPermissions.add(new java.security.AllPermission());
312 
313         }
314 
315         @Override
316         public boolean implies(ProtectionDomain domain, Permission permission) {
317             if (allowAll.get()) return allPermissions.implies(permission);
<span class="line-modified">318             return permissions.implies(permission) || DEFAULT_POLICY.implies(domain, permission);</span>
319         }
320 
321         @Override
322         public PermissionCollection getPermissions(CodeSource codesource) {
323             return new PermissionsBuilder().addAll(allowAll.get()
324                     ? allPermissions : permissions).toPermissions();
325         }
326 
327         @Override
328         public PermissionCollection getPermissions(ProtectionDomain domain) {
329             return new PermissionsBuilder().addAll(allowAll.get()
330                     ? allPermissions : permissions).toPermissions();
331         }
332     }
333 
334 }
</pre>
</td>
</tr>
</table>
<center><a href="FileHandlerPath.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="LogManager/Configuration/ParentLoggerWithHandlerGC.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>