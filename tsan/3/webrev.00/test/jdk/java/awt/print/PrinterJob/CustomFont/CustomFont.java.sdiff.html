<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/awt/print/PrinterJob/CustomFont/CustomFont.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../image/DrawImage/IncorrectUnmanagedImageSourceOffset.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../LandscapeStackOverflow.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/awt/print/PrinterJob/CustomFont/CustomFont.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2007, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 /*
 25   @test
<span class="line-modified"> 26   @bug 4386025</span>
 27   @summary fonts not in win32 font directory print incorrectly.
 28   @author prr: area=PrinterJob
 29   @run main/manual CustomFont
 30 */
 31 import java.io.*;
 32 import java.awt.*;
 33 import java.awt.event.*;
 34 import java.awt.print.*;
 35 
 36 
 37 public class CustomFont implements Printable {
 38 
 39    private Image opaqueimg,transimg;
 40 
 41    private static void init() {
 42 
 43         //*** Create instructions for the user here ***
 44 
 45         String[] instructions = {
 46          &quot;On-screen inspection is not possible for this printing-specific&quot;,
</pre>
<hr />
<pre>
 66         book.append(new CustomFont(),portrait);
 67 
 68         pjob.setPageable(book);
 69 
 70         if (pjob.printDialog()) {
 71             try {
 72                 pjob.print();
 73             } catch (PrinterException e) {
 74                 System.err.println(e);
 75                 e.printStackTrace();
 76             }
 77         }
 78         System.out.println(&quot;Done Printing&quot;);
 79 
 80     }//End  init()
 81 
 82 
 83   Font customFont;
 84   public CustomFont() {
 85        try {
<span class="line-modified"> 86              FileInputStream fin = new FileInputStream(&quot;A.ttf&quot;);</span>


 87              Font cf = Font.createFont(Font.TRUETYPE_FONT, fin);
 88              customFont = cf.deriveFont(Font.PLAIN, 14);
 89         } catch (Exception ioe) {
<span class="line-modified"> 90              System.err.println(ioe.getMessage());</span>
<span class="line-removed"> 91              customFont = new Font(&quot;serif&quot;, Font.PLAIN, 14);</span>
 92         }
 93   }
 94 
 95   public int print(Graphics g, PageFormat pgFmt, int pgIndex) {
 96 
 97        Graphics2D g2D = (Graphics2D) g;
 98        g2D.translate(pgFmt.getImageableX(), pgFmt.getImageableY());
 99 
100        g2D.setColor(Color.black);
101        g2D.setFont(customFont);
<span class="line-modified">102        String str = &quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;;</span>
103        g.drawString(str, 100, 100);
104 
105        return Printable.PAGE_EXISTS;
106   }
107 
108   /**
109    * The graphics is scaled and the font and the positions
110    * are reduced in respect to the scaling, so that all
111    * printing should be the same.
112    *
113    * @param g2D     graphics2D to paint on
114    * @param font    font to paint
115    * @param scale   scale for the painting
116    * @param x       x position
117    * @param y       y position
118    */
119   private void printScale(Graphics2D g2D, Font font,
120                            float scale, float x, float y) {
121 
122     int RES = 72;
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2007, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 /*
 25   @test
<span class="line-modified"> 26   @bug 4386025 8231243</span>
 27   @summary fonts not in win32 font directory print incorrectly.
 28   @author prr: area=PrinterJob
 29   @run main/manual CustomFont
 30 */
 31 import java.io.*;
 32 import java.awt.*;
 33 import java.awt.event.*;
 34 import java.awt.print.*;
 35 
 36 
 37 public class CustomFont implements Printable {
 38 
 39    private Image opaqueimg,transimg;
 40 
 41    private static void init() {
 42 
 43         //*** Create instructions for the user here ***
 44 
 45         String[] instructions = {
 46          &quot;On-screen inspection is not possible for this printing-specific&quot;,
</pre>
<hr />
<pre>
 66         book.append(new CustomFont(),portrait);
 67 
 68         pjob.setPageable(book);
 69 
 70         if (pjob.printDialog()) {
 71             try {
 72                 pjob.print();
 73             } catch (PrinterException e) {
 74                 System.err.println(e);
 75                 e.printStackTrace();
 76             }
 77         }
 78         System.out.println(&quot;Done Printing&quot;);
 79 
 80     }//End  init()
 81 
 82 
 83   Font customFont;
 84   public CustomFont() {
 85        try {
<span class="line-modified"> 86              String dir = System.getProperty(&quot;test.src&quot;, &quot;.&quot;);</span>
<span class="line-added"> 87              String fileName = dir + File.separator + &quot;A.ttf&quot;;</span>
<span class="line-added"> 88              FileInputStream fin = new FileInputStream(fileName);</span>
 89              Font cf = Font.createFont(Font.TRUETYPE_FONT, fin);
 90              customFont = cf.deriveFont(Font.PLAIN, 14);
 91         } catch (Exception ioe) {
<span class="line-modified"> 92              throw new RuntimeException(ioe);</span>

 93         }
 94   }
 95 
 96   public int print(Graphics g, PageFormat pgFmt, int pgIndex) {
 97 
 98        Graphics2D g2D = (Graphics2D) g;
 99        g2D.translate(pgFmt.getImageableX(), pgFmt.getImageableY());
100 
101        g2D.setColor(Color.black);
102        g2D.setFont(customFont);
<span class="line-modified">103        String str = &quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;;</span>
104        g.drawString(str, 100, 100);
105 
106        return Printable.PAGE_EXISTS;
107   }
108 
109   /**
110    * The graphics is scaled and the font and the positions
111    * are reduced in respect to the scaling, so that all
112    * printing should be the same.
113    *
114    * @param g2D     graphics2D to paint on
115    * @param font    font to paint
116    * @param scale   scale for the painting
117    * @param x       x position
118    * @param y       y position
119    */
120   private void printScale(Graphics2D g2D, Font font,
121                            float scale, float x, float y) {
122 
123     int RES = 72;
</pre>
</td>
</tr>
</table>
<center><a href="../../../image/DrawImage/IncorrectUnmanagedImageSourceOffset.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../LandscapeStackOverflow.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>