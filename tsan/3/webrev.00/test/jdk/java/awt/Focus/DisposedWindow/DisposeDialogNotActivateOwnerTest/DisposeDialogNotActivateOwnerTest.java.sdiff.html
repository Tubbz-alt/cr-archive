<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/awt/Focus/DisposedWindow/DisposeDialogNotActivateOwnerTest/DisposeDialogNotActivateOwnerTest.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../DeiconifiedFrameLoosesFocus/DeiconifiedFrameLoosesFocus.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../FocusEmbeddedFrameTest/FocusEmbeddedFrameTest.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/awt/Focus/DisposedWindow/DisposeDialogNotActivateOwnerTest/DisposeDialogNotActivateOwnerTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 45     Frame frame;
 46     Frame dialogInvisibleOwner;
 47     Dialog dialog;
 48     Button frameButton;
 49     static volatile boolean buttonReceivedFocus = false;
 50 
 51     public static void main(String[] args) {
 52         DisposeDialogNotActivateOwnerTest test =
 53                 new DisposeDialogNotActivateOwnerTest();
 54         test.performTest();
 55         test.dispose();
 56     }
 57 
 58     public DisposeDialogNotActivateOwnerTest() {
 59         try {
 60             robot = new Robot();
 61         } catch (AWTException e) {
 62             throw new RuntimeException(&quot;Error: unable to create robot&quot;);
 63         }
 64 

 65         dialogInvisibleOwner = new Frame(&quot;Dialog Invisible Owner Frame&quot;);
 66         dialog = new Dialog(dialogInvisibleOwner, &quot;Owned Dialog&quot;);
 67 
 68         frame = new Frame(&quot;A Frame&quot;);
 69         frameButton = new Button(&quot;button&quot;);
 70         frameButton.addFocusListener(new FocusAdapter() {
 71             public void focusGained(FocusEvent e) {
 72                 buttonReceivedFocus = true;
 73             }
 74         });
 75         frame.setBounds(0, 0, 400, 200);
 76         frame.add(frameButton);
 77         dialog.setBounds(100, 50, 200, 100);
 78     }
 79 
 80     public void performTest() {
 81         frame.setVisible(true);

 82         robot.waitForIdle();
 83         clickOnTitle(frame);

 84         robot.waitForIdle();
 85         robot.delay(200);
 86         if (!frame.isFocused()) {
 87             dispose();
 88             throw new RuntimeException(&quot;Error: frame didn&#39;t get initial focus&quot;);
 89         }
 90 
 91         dialog.setVisible(true);

 92         robot.waitForIdle();
 93         robot.delay(200);
 94         if (!dialog.isFocused()) {
 95             dispose();
 96             throw new RuntimeException(&quot;Error: dialog didn&#39;t get initial focus&quot;);
 97         }
 98 
 99         dialog.dispose();
100         robot.waitForIdle();
101         robot.delay(200);
102         if (!buttonReceivedFocus) {
103             dispose();
104             throw new RuntimeException(
105                 &quot;Test failed: Dialog activates invisible owner when disposed!&quot;);
106         }
107     }
108 
109     public void dispose() {
110         frame.dispose();
111         dialog.dispose();
112         dialogInvisibleOwner.dispose();
113     }
114 
115     void clickOnTitle(Component c) {
116         Point p = c.getLocationOnScreen();
117         Dimension d = c.getSize();
118         robot.mouseMove(p.x + (int)(d.getWidth() / 2),
119                         p.y + ((Frame)c).getInsets().top / 2);
120         robot.mousePress(InputEvent.BUTTON1_MASK);
<span class="line-removed">121         robot.delay(20);</span>
122         robot.mouseRelease(InputEvent.BUTTON1_MASK);
123     }
124 }
</pre>
</td>
<td>
<hr />
<pre>
 45     Frame frame;
 46     Frame dialogInvisibleOwner;
 47     Dialog dialog;
 48     Button frameButton;
 49     static volatile boolean buttonReceivedFocus = false;
 50 
 51     public static void main(String[] args) {
 52         DisposeDialogNotActivateOwnerTest test =
 53                 new DisposeDialogNotActivateOwnerTest();
 54         test.performTest();
 55         test.dispose();
 56     }
 57 
 58     public DisposeDialogNotActivateOwnerTest() {
 59         try {
 60             robot = new Robot();
 61         } catch (AWTException e) {
 62             throw new RuntimeException(&quot;Error: unable to create robot&quot;);
 63         }
 64 
<span class="line-added"> 65         robot.setAutoDelay(200);</span>
 66         dialogInvisibleOwner = new Frame(&quot;Dialog Invisible Owner Frame&quot;);
 67         dialog = new Dialog(dialogInvisibleOwner, &quot;Owned Dialog&quot;);
 68 
 69         frame = new Frame(&quot;A Frame&quot;);
 70         frameButton = new Button(&quot;button&quot;);
 71         frameButton.addFocusListener(new FocusAdapter() {
 72             public void focusGained(FocusEvent e) {
 73                 buttonReceivedFocus = true;
 74             }
 75         });
 76         frame.setBounds(0, 0, 400, 200);
 77         frame.add(frameButton);
 78         dialog.setBounds(100, 50, 200, 100);
 79     }
 80 
 81     public void performTest() {
 82         frame.setVisible(true);
<span class="line-added"> 83         robot.delay(200);</span>
 84         robot.waitForIdle();
 85         clickOnTitle(frame);
<span class="line-added"> 86         robot.delay(200);</span>
 87         robot.waitForIdle();
 88         robot.delay(200);
 89         if (!frame.isFocused()) {
 90             dispose();
 91             throw new RuntimeException(&quot;Error: frame didn&#39;t get initial focus&quot;);
 92         }
 93 
 94         dialog.setVisible(true);
<span class="line-added"> 95         robot.delay(200);</span>
 96         robot.waitForIdle();
 97         robot.delay(200);
 98         if (!dialog.isFocused()) {
 99             dispose();
100             throw new RuntimeException(&quot;Error: dialog didn&#39;t get initial focus&quot;);
101         }
102 
103         dialog.dispose();
104         robot.waitForIdle();
105         robot.delay(200);
106         if (!buttonReceivedFocus) {
107             dispose();
108             throw new RuntimeException(
109                 &quot;Test failed: Dialog activates invisible owner when disposed!&quot;);
110         }
111     }
112 
113     public void dispose() {
114         frame.dispose();
115         dialog.dispose();
116         dialogInvisibleOwner.dispose();
117     }
118 
119     void clickOnTitle(Component c) {
120         Point p = c.getLocationOnScreen();
121         Dimension d = c.getSize();
122         robot.mouseMove(p.x + (int)(d.getWidth() / 2),
123                         p.y + ((Frame)c).getInsets().top / 2);
124         robot.mousePress(InputEvent.BUTTON1_MASK);

125         robot.mouseRelease(InputEvent.BUTTON1_MASK);
126     }
127 }
</pre>
</td>
</tr>
</table>
<center><a href="../../DeiconifiedFrameLoosesFocus/DeiconifiedFrameLoosesFocus.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../FocusEmbeddedFrameTest/FocusEmbeddedFrameTest.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>