<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/security/Signature/Offsets.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../Provider/TestProvider.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../SignedObject/Chain.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/security/Signature/Offsets.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
106         // create signature instance
107         Signature signature = Signature.getInstance(algorithm, provider);
108 
109         String keyAlgo;
110         int keySize = 2048;
111         if (algorithm.contains(&quot;RSA&quot;)) {
112             keyAlgo = &quot;RSA&quot;;
113         } else if (algorithm.contains(&quot;ECDSA&quot;)) {
114             keyAlgo = &quot;EC&quot;;
115             keySize = 256;
116         } else if (algorithm.contains(&quot;DSA&quot;)) {
117             keyAlgo = &quot;DSA&quot;;
118             if (algorithm.startsWith(&quot;SHAwith&quot;) ||
119                     algorithm.startsWith(&quot;SHA1with&quot;)) {
120                 keySize = 1024;
121             }
122         } else {
123             throw new RuntimeException(&quot;Test doesn&#39;t support this signature &quot;
124                     + &quot;algorithm: &quot; + algorithm);
125         }
<span class="line-modified">126 </span>
<span class="line-modified">127         KeyPairGenerator kpg = KeyPairGenerator.getInstance(keyAlgo, provider);</span>





128         kpg.initialize(keySize);
129         KeyPair kp = kpg.generateKeyPair();
130         PublicKey pubkey = kp.getPublic();
131         PrivateKey privkey = kp.getPrivate();
132 
133         return new Offsets(signature, pubkey, privkey, size, cleartext);
134     }
135 
136     public static void main(String[] args) throws NoSuchAlgorithmException,
137             InvalidKeyException, SignatureException {
138         if (args.length &lt; 2) {
139             throw new RuntimeException(&quot;Wrong parameters&quot;);
140         }
141 
142         boolean result = true;
143         try {
144             Offsets test = init(args[0], args[1]);
145 
146             // We are trying 3 different offsets, data size has nothing to do
147             // with signature length
</pre>
</td>
<td>
<hr />
<pre>
106         // create signature instance
107         Signature signature = Signature.getInstance(algorithm, provider);
108 
109         String keyAlgo;
110         int keySize = 2048;
111         if (algorithm.contains(&quot;RSA&quot;)) {
112             keyAlgo = &quot;RSA&quot;;
113         } else if (algorithm.contains(&quot;ECDSA&quot;)) {
114             keyAlgo = &quot;EC&quot;;
115             keySize = 256;
116         } else if (algorithm.contains(&quot;DSA&quot;)) {
117             keyAlgo = &quot;DSA&quot;;
118             if (algorithm.startsWith(&quot;SHAwith&quot;) ||
119                     algorithm.startsWith(&quot;SHA1with&quot;)) {
120                 keySize = 1024;
121             }
122         } else {
123             throw new RuntimeException(&quot;Test doesn&#39;t support this signature &quot;
124                     + &quot;algorithm: &quot; + algorithm);
125         }
<span class="line-modified">126         KeyPairGenerator kpg = null;</span>
<span class="line-modified">127         // first try matching provider, fallback to most preferred if none available</span>
<span class="line-added">128         try {</span>
<span class="line-added">129             kpg = KeyPairGenerator.getInstance(keyAlgo, provider);</span>
<span class="line-added">130         } catch (NoSuchAlgorithmException nsae) {</span>
<span class="line-added">131             kpg = KeyPairGenerator.getInstance(keyAlgo);</span>
<span class="line-added">132         }</span>
133         kpg.initialize(keySize);
134         KeyPair kp = kpg.generateKeyPair();
135         PublicKey pubkey = kp.getPublic();
136         PrivateKey privkey = kp.getPrivate();
137 
138         return new Offsets(signature, pubkey, privkey, size, cleartext);
139     }
140 
141     public static void main(String[] args) throws NoSuchAlgorithmException,
142             InvalidKeyException, SignatureException {
143         if (args.length &lt; 2) {
144             throw new RuntimeException(&quot;Wrong parameters&quot;);
145         }
146 
147         boolean result = true;
148         try {
149             Offsets test = init(args[0], args[1]);
150 
151             // We are trying 3 different offsets, data size has nothing to do
152             // with signature length
</pre>
</td>
</tr>
</table>
<center><a href="../Provider/TestProvider.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../SignedObject/Chain.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>