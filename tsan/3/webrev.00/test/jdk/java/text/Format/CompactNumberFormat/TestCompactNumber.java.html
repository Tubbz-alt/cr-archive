<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New test/jdk/java/text/Format/CompactNumberFormat/TestCompactNumber.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2018, 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 /*
 24  * @test
 25  * @bug 8177552 8217721 8222756
 26  * @summary Checks the functioning of compact number format
 27  * @modules jdk.localedata
 28  * @run testng/othervm TestCompactNumber
 29  */
 30 import java.math.BigDecimal;
 31 import java.math.BigInteger;
 32 import java.text.FieldPosition;
 33 import java.text.Format;
 34 import java.text.NumberFormat;
 35 import java.text.ParseException;
 36 import java.text.ParsePosition;
 37 import java.util.Locale;
 38 import java.util.stream.Stream;
 39 import static org.testng.Assert.*;
 40 import org.testng.annotations.DataProvider;
 41 import org.testng.annotations.Test;
 42 
 43 public class TestCompactNumber {
 44 
 45     private static final NumberFormat FORMAT_DZ_LONG = NumberFormat
 46             .getCompactNumberInstance(new Locale(&quot;dz&quot;), NumberFormat.Style.LONG);
 47 
 48     private static final NumberFormat FORMAT_EN_US_SHORT = NumberFormat
 49             .getCompactNumberInstance(Locale.US, NumberFormat.Style.SHORT);
 50 
 51     private static final NumberFormat FORMAT_EN_LONG = NumberFormat
 52             .getCompactNumberInstance(new Locale(&quot;en&quot;), NumberFormat.Style.LONG);
 53 
 54     private static final NumberFormat FORMAT_HI_IN_LONG = NumberFormat
 55             .getCompactNumberInstance(new Locale(&quot;hi&quot;, &quot;IN&quot;), NumberFormat.Style.LONG);
 56 
 57     private static final NumberFormat FORMAT_JA_JP_SHORT = NumberFormat
 58             .getCompactNumberInstance(Locale.JAPAN, NumberFormat.Style.SHORT);
 59 
 60     private static final NumberFormat FORMAT_IT_SHORT = NumberFormat
 61             .getCompactNumberInstance(new Locale(&quot;it&quot;), NumberFormat.Style.SHORT);
 62 
 63     private static final NumberFormat FORMAT_CA_LONG = NumberFormat
 64             .getCompactNumberInstance(new Locale(&quot;ca&quot;), NumberFormat.Style.LONG);
 65 
 66     private static final NumberFormat FORMAT_AS_LONG = NumberFormat
 67             .getCompactNumberInstance(new Locale(&quot;as&quot;), NumberFormat.Style.LONG);
 68 
 69     private static final NumberFormat FORMAT_BRX_SHORT = NumberFormat
 70             .getCompactNumberInstance(new Locale(&quot;brx&quot;), NumberFormat.Style.SHORT);
 71 
 72     private static final NumberFormat FORMAT_SW_LONG = NumberFormat
 73             .getCompactNumberInstance(new Locale(&quot;sw&quot;), NumberFormat.Style.LONG);
 74 
 75     private static final NumberFormat FORMAT_SE_SHORT = NumberFormat
 76             .getCompactNumberInstance(new Locale(&quot;se&quot;), NumberFormat.Style.SHORT);
 77 
 78     private static final NumberFormat FORMAT_DE_LONG = NumberFormat
 79             .getCompactNumberInstance(Locale.GERMAN, NumberFormat.Style.LONG);
 80 
 81     private static final NumberFormat FORMAT_SL_LONG = NumberFormat
 82             .getCompactNumberInstance(new Locale(&quot;sl&quot;), NumberFormat.Style.LONG);
 83 
 84     @DataProvider(name = &quot;format&quot;)
 85     Object[][] compactFormatData() {
 86         return new Object[][]{
 87             // compact number format instance, number to format, formatted output
 88             {FORMAT_DZ_LONG, 1000.09, &quot;\u0F66\u0F9F\u0F7C\u0F44\u0F0B\u0F55&quot;
 89                 + &quot;\u0FB2\u0F42 \u0F21&quot;},
 90             {FORMAT_DZ_LONG, -999.99, &quot;-\u0F66\u0F9F\u0F7C\u0F44\u0F0B\u0F55&quot;
 91                 + &quot;\u0FB2\u0F42 \u0F21&quot;},
 92             {FORMAT_DZ_LONG, -0.0, &quot;-\u0F20&quot;},
 93             {FORMAT_DZ_LONG, 3000L, &quot;\u0F66\u0F9F\u0F7C\u0F44\u0F0B\u0F55&quot;
 94                 + &quot;\u0FB2\u0F42 \u0F23&quot;},
 95             {FORMAT_DZ_LONG, new BigInteger(&quot;12345678901234567890&quot;), &quot;\u0F51&quot;
 96                 + &quot;\u0F74\u0F44\u0F0B\u0F55\u0FB1\u0F74\u0F62\u0F0B\u0F66&quot;
 97                 + &quot;\u0F0B\u0F61\u0F0B \u0F21\u0F22\u0F23\u0F24\u0F25\u0F27&quot;},
 98             // negative
 99             {FORMAT_DZ_LONG, new BigInteger(&quot;-12345678901234567890&quot;), &quot;-\u0F51&quot;
100                 + &quot;\u0F74\u0F44\u0F0B\u0F55\u0FB1\u0F74\u0F62\u0F0B\u0F66&quot;
101                 + &quot;\u0F0B\u0F61\u0F0B \u0F21\u0F22\u0F23\u0F24\u0F25\u0F27&quot;},
102             {FORMAT_DZ_LONG, new BigDecimal(&quot;12345678901234567890.89&quot;), &quot;\u0F51&quot;
103                 + &quot;\u0F74\u0F44\u0F0B\u0F55\u0FB1\u0F74\u0F62\u0F0B\u0F66&quot;
104                 + &quot;\u0F0B\u0F61\u0F0B \u0F21\u0F22\u0F23\u0F24\u0F25\u0F27&quot;},
105             {FORMAT_DZ_LONG, new BigDecimal(&quot;-12345678901234567890.89&quot;), &quot;-\u0F51&quot;
106                 + &quot;\u0F74\u0F44\u0F0B\u0F55\u0FB1\u0F74\u0F62\u0F0B\u0F66&quot;
107                 + &quot;\u0F0B\u0F61\u0F0B \u0F21\u0F22\u0F23\u0F24\u0F25\u0F27&quot;},
108             // Zeros
109             {FORMAT_EN_US_SHORT, 0, &quot;0&quot;},
110             {FORMAT_EN_US_SHORT, 0.0, &quot;0&quot;},
111             {FORMAT_EN_US_SHORT, -0.0, &quot;-0&quot;},
112             // Less than 1000 no suffix
113             {FORMAT_EN_US_SHORT, 499, &quot;499&quot;},
114             // Boundary number
115             {FORMAT_EN_US_SHORT, 1000.0, &quot;1K&quot;},
116             // Long
117             {FORMAT_EN_US_SHORT, 3000L, &quot;3K&quot;},
118             {FORMAT_EN_US_SHORT, 30000L, &quot;30K&quot;},
119             {FORMAT_EN_US_SHORT, 300000L, &quot;300K&quot;},
120             {FORMAT_EN_US_SHORT, 3000000L, &quot;3M&quot;},
121             {FORMAT_EN_US_SHORT, 30000000L, &quot;30M&quot;},
122             {FORMAT_EN_US_SHORT, 300000000L, &quot;300M&quot;},
123             {FORMAT_EN_US_SHORT, 3000000000L, &quot;3B&quot;},
124             {FORMAT_EN_US_SHORT, 30000000000L, &quot;30B&quot;},
125             {FORMAT_EN_US_SHORT, 300000000000L, &quot;300B&quot;},
126             {FORMAT_EN_US_SHORT, 3000000000000L, &quot;3T&quot;},
127             {FORMAT_EN_US_SHORT, 30000000000000L, &quot;30T&quot;},
128             {FORMAT_EN_US_SHORT, 300000000000000L, &quot;300T&quot;},
129             {FORMAT_EN_US_SHORT, 3000000000000000L, &quot;3000T&quot;},
130             // Negatives
131             {FORMAT_EN_US_SHORT, -3000L, &quot;-3K&quot;},
132             {FORMAT_EN_US_SHORT, -30000L, &quot;-30K&quot;},
133             {FORMAT_EN_US_SHORT, -300000L, &quot;-300K&quot;},
134             {FORMAT_EN_US_SHORT, -3000000L, &quot;-3M&quot;},
135             {FORMAT_EN_US_SHORT, -30000000L, &quot;-30M&quot;},
136             {FORMAT_EN_US_SHORT, -300000000L, &quot;-300M&quot;},
137             {FORMAT_EN_US_SHORT, -3000000000L, &quot;-3B&quot;},
138             {FORMAT_EN_US_SHORT, -30000000000L, &quot;-30B&quot;},
139             {FORMAT_EN_US_SHORT, -300000000000L, &quot;-300B&quot;},
140             {FORMAT_EN_US_SHORT, -3000000000000L, &quot;-3T&quot;},
141             {FORMAT_EN_US_SHORT, -30000000000000L, &quot;-30T&quot;},
142             {FORMAT_EN_US_SHORT, -300000000000000L, &quot;-300T&quot;},
143             {FORMAT_EN_US_SHORT, -3000000000000000L, &quot;-3000T&quot;},
144             // Double
145             {FORMAT_EN_US_SHORT, 3000.0, &quot;3K&quot;},
146             {FORMAT_EN_US_SHORT, 30000.0, &quot;30K&quot;},
147             {FORMAT_EN_US_SHORT, 300000.0, &quot;300K&quot;},
148             {FORMAT_EN_US_SHORT, 3000000.0, &quot;3M&quot;},
149             {FORMAT_EN_US_SHORT, 30000000.0, &quot;30M&quot;},
150             {FORMAT_EN_US_SHORT, 300000000.0, &quot;300M&quot;},
151             {FORMAT_EN_US_SHORT, 3000000000.0, &quot;3B&quot;},
152             {FORMAT_EN_US_SHORT, 30000000000.0, &quot;30B&quot;},
153             {FORMAT_EN_US_SHORT, 300000000000.0, &quot;300B&quot;},
154             {FORMAT_EN_US_SHORT, 3000000000000.0, &quot;3T&quot;},
155             {FORMAT_EN_US_SHORT, 30000000000000.0, &quot;30T&quot;},
156             {FORMAT_EN_US_SHORT, 300000000000000.0, &quot;300T&quot;},
157             {FORMAT_EN_US_SHORT, 3000000000000000.0, &quot;3000T&quot;},
158             // Negatives
159             {FORMAT_EN_US_SHORT, -3000.0, &quot;-3K&quot;},
160             {FORMAT_EN_US_SHORT, -30000.0, &quot;-30K&quot;},
161             {FORMAT_EN_US_SHORT, -300000.0, &quot;-300K&quot;},
162             {FORMAT_EN_US_SHORT, -3000000.0, &quot;-3M&quot;},
163             {FORMAT_EN_US_SHORT, -30000000.0, &quot;-30M&quot;},
164             {FORMAT_EN_US_SHORT, -300000000.0, &quot;-300M&quot;},
165             {FORMAT_EN_US_SHORT, -3000000000.0, &quot;-3B&quot;},
166             {FORMAT_EN_US_SHORT, -30000000000.0, &quot;-30B&quot;},
167             {FORMAT_EN_US_SHORT, -300000000000.0, &quot;-300B&quot;},
168             {FORMAT_EN_US_SHORT, -3000000000000.0, &quot;-3T&quot;},
169             {FORMAT_EN_US_SHORT, -30000000000000.0, &quot;-30T&quot;},
170             {FORMAT_EN_US_SHORT, -300000000000000.0, &quot;-300T&quot;},
171             {FORMAT_EN_US_SHORT, -3000000000000000.0, &quot;-3000T&quot;},
172             // BigInteger
173             {FORMAT_EN_US_SHORT, new BigInteger(&quot;12345678901234567890&quot;),
174                 &quot;12345679T&quot;},
175             {FORMAT_EN_US_SHORT, new BigInteger(&quot;-12345678901234567890&quot;),
176                 &quot;-12345679T&quot;},
177             //BigDecimal
178             {FORMAT_EN_US_SHORT, new BigDecimal(&quot;12345678901234567890.89&quot;),
179                 &quot;12345679T&quot;},
180             {FORMAT_EN_US_SHORT, new BigDecimal(&quot;-12345678901234567890.89&quot;),
181                 &quot;-12345679T&quot;},
182             {FORMAT_EN_US_SHORT, new BigDecimal(&quot;12345678901234567890123466767.89&quot;),
183                 &quot;12345678901234568T&quot;},
184             {FORMAT_EN_US_SHORT, new BigDecimal(
185                 &quot;12345678901234567890878732267863209.89&quot;),
186                 &quot;12345678901234567890879T&quot;},
187             // number as exponent
188             {FORMAT_EN_US_SHORT, 9.78313E+3, &quot;10K&quot;},
189             // Less than 1000 no suffix
190             {FORMAT_EN_LONG, 999, &quot;999&quot;},
191             // Round the value and then format
192             {FORMAT_EN_LONG, 999.99, &quot;1 thousand&quot;},
193             // 10 thousand
194             {FORMAT_EN_LONG, 99000, &quot;99 thousand&quot;},
195             // Long path
196             {FORMAT_EN_LONG, 330000, &quot;330 thousand&quot;},
197             // Double path
198             {FORMAT_EN_LONG, 3000.90, &quot;3 thousand&quot;},
199             // BigInteger path
200             {FORMAT_EN_LONG, new BigInteger(&quot;12345678901234567890&quot;),
201                 &quot;12345679 trillion&quot;},
202             //BigDecimal path
203             {FORMAT_EN_LONG, new BigDecimal(&quot;12345678901234567890.89&quot;),
204                 &quot;12345679 trillion&quot;},
205             // Less than 1000 no suffix
206             {FORMAT_HI_IN_LONG, -999, &quot;-999&quot;},
207             // Round the value with 0 fraction digits and format it
208             {FORMAT_HI_IN_LONG, -999.99, &quot;-1 \u0939\u091C\u093C\u093E\u0930&quot;},
209             // 10 thousand
210             {FORMAT_HI_IN_LONG, 99000, &quot;99 \u0939\u091C\u093C\u093E\u0930&quot;},
211             // Long path
212             {FORMAT_HI_IN_LONG, 330000, &quot;3 \u0932\u093E\u0916&quot;},
213             // Double path
214             {FORMAT_HI_IN_LONG, 3000.90, &quot;3 \u0939\u091C\u093C\u093E\u0930&quot;},
215             // BigInteger path
216             {FORMAT_HI_IN_LONG, new BigInteger(&quot;12345678901234567890&quot;),
217                 &quot;123456789 \u0916\u0930\u092C&quot;},
218             // BigDecimal path
219             {FORMAT_HI_IN_LONG, new BigDecimal(&quot;12345678901234567890.89&quot;),
220                 &quot;123456789 \u0916\u0930\u092C&quot;},
221             // 1000 does not have any suffix in &quot;ja&quot; locale
222             {FORMAT_JA_JP_SHORT, -999.99, &quot;-1,000&quot;},
223             // 0-9999 does not have any suffix
224             {FORMAT_JA_JP_SHORT, 9999, &quot;9,999&quot;},
225             // 99000/10000 =&gt; 9.9\u4E07 rounded to 10\u4E07
226             {FORMAT_JA_JP_SHORT, 99000, &quot;10\u4E07&quot;},
227             // Negative
228             {FORMAT_JA_JP_SHORT, -99000, &quot;-10\u4E07&quot;},
229             // Long path
230             {FORMAT_JA_JP_SHORT, 330000, &quot;33\u4E07&quot;},
231             // Double path
232             {FORMAT_JA_JP_SHORT, 3000.90, &quot;3,001&quot;},
233             // BigInteger path
234             {FORMAT_JA_JP_SHORT, new BigInteger(&quot;12345678901234567890&quot;),
235                 &quot;12345679\u5146&quot;},
236             // BigDecimal path
237             {FORMAT_JA_JP_SHORT, new BigDecimal(&quot;12345678901234567890.89&quot;),
238                 &quot;12345679\u5146&quot;},
239             // less than 1000 no suffix
240             {FORMAT_IT_SHORT, 499, &quot;499&quot;},
241             // Boundary number
242             {FORMAT_IT_SHORT, 1000, &quot;1.000&quot;},
243             // Long path
244             {FORMAT_IT_SHORT, 3000000L, &quot;3\u00a0Mln&quot;},
245             // Double path
246             {FORMAT_IT_SHORT, 3000000.0, &quot;3\u00a0Mln&quot;},
247             // BigInteger path
248             {FORMAT_IT_SHORT, new BigInteger(&quot;12345678901234567890&quot;),
249                 &quot;12345679\u00a0Bln&quot;},
250             // BigDecimal path
251             {FORMAT_IT_SHORT, new BigDecimal(&quot;12345678901234567890.89&quot;),
252                 &quot;12345679\u00a0Bln&quot;},
253             {FORMAT_CA_LONG, 999, &quot;999&quot;},
254             {FORMAT_CA_LONG, 999.99, &quot;1 miler&quot;},
255             {FORMAT_CA_LONG, 99000, &quot;99 milers&quot;},
256             {FORMAT_CA_LONG, 330000, &quot;330 milers&quot;},
257             {FORMAT_CA_LONG, 3000.90, &quot;3 milers&quot;},
258             {FORMAT_CA_LONG, 1000000, &quot;1 mili\u00f3&quot;},
259             {FORMAT_CA_LONG, new BigInteger(&quot;12345678901234567890&quot;),
260                 &quot;12345679 bilions&quot;},
261             {FORMAT_CA_LONG, new BigDecimal(&quot;12345678901234567890.89&quot;),
262                 &quot;12345679 bilions&quot;},
263             {FORMAT_AS_LONG, 5000.0, &quot;\u09eb \u09b9\u09be\u099c\u09be\u09f0&quot;},
264             {FORMAT_AS_LONG, 50000.0, &quot;\u09eb\u09e6 \u09b9\u09be\u099c\u09be\u09f0&quot;},
265             {FORMAT_AS_LONG, 500000.0, &quot;\u09eb \u09b2\u09be\u0996&quot;},
266             {FORMAT_AS_LONG, 5000000.0, &quot;\u09eb \u09a8\u09bf\u09af\u09c1\u09a4&quot;},
267             {FORMAT_AS_LONG, 50000000.0, &quot;\u09eb\u09e6 \u09a8\u09bf\u09af\u09c1\u09a4&quot;},
268             {FORMAT_AS_LONG, 500000000.0, &quot;\u09eb\u09e6\u09e6 \u09a8\u09bf\u09af\u09c1\u09a4&quot;},
269             {FORMAT_AS_LONG, 5000000000.0, &quot;\u09eb \u09b6\u09a4 \u0995\u09cb\u099f\u09bf&quot;},
270             {FORMAT_AS_LONG, 50000000000.0, &quot;\u09eb\u09e6 \u09b6\u09a4 \u0995\u09cb\u099f\u09bf&quot;},
271             {FORMAT_AS_LONG, 500000000000.0, &quot;\u09eb\u09e6\u09e6 \u09b6\u09a4 \u0995\u09cb\u099f\u09bf&quot;},
272             {FORMAT_AS_LONG, 5000000000000.0, &quot;\u09eb \u09b6\u09a4 \u09aa\u09f0\u09be\u09f0\u09cd\u09a6\u09cd\u09a7&quot;},
273             {FORMAT_AS_LONG, 50000000000000.0, &quot;\u09eb\u09e6 \u09b6\u09a4 \u09aa\u09f0\u09be\u09f0\u09cd\u09a6\u09cd\u09a7&quot;},
274             {FORMAT_AS_LONG, 500000000000000.0, &quot;\u09eb\u09e6\u09e6 \u09b6\u09a4 \u09aa\u09f0\u09be\u09f0\u09cd\u09a6\u09cd\u09a7&quot;},
275             {FORMAT_AS_LONG, 5000000000000000.0, &quot;\u09eb\u09e6\u09e6\u09e6 \u09b6\u09a4 \u09aa\u09f0\u09be\u09f0\u09cd\u09a6\u09cd\u09a7&quot;},
276             {FORMAT_AS_LONG, new BigInteger(&quot;12345678901234567890&quot;),
277                 &quot;\u09e7\u09e8\u09e9\u09ea\u09eb\u09ec\u09ed\u09ef \u09b6\u09a4 \u09aa\u09f0\u09be\u09f0\u09cd\u09a6\u09cd\u09a7&quot;},
278             {FORMAT_AS_LONG, new BigDecimal(&quot;12345678901234567890123466767.89&quot;),
279                 &quot;\u09e7\u09e8\u09e9\u09ea\u09eb\u09ec\u09ed\u09ee\u09ef\u09e6\u09e7\u09e8\u09e9\u09ea\u09eb\u09ec\u09ee \u09b6\u09a4 \u09aa\u09f0\u09be\u09f0\u09cd\u09a6\u09cd\u09a7&quot;},
280             {FORMAT_BRX_SHORT, 999, &quot;999&quot;},
281             {FORMAT_BRX_SHORT, 999.99, &quot;1K&quot;},
282             {FORMAT_BRX_SHORT, 99000, &quot;99K&quot;},
283             {FORMAT_BRX_SHORT, 330000, &quot;330K&quot;},
284             {FORMAT_BRX_SHORT, 3000.90, &quot;3K&quot;},
285             {FORMAT_BRX_SHORT, 1000000, &quot;1M&quot;},
286             {FORMAT_BRX_SHORT, new BigInteger(&quot;12345678901234567890&quot;),
287                     &quot;12345679T&quot;},
288             {FORMAT_BRX_SHORT, new BigDecimal(&quot;12345678901234567890.89&quot;),
289                     &quot;12345679T&quot;},
290             // Less than 1000 no suffix
291             {FORMAT_SW_LONG, 499, &quot;499&quot;},
292             // Boundary number
293             {FORMAT_SW_LONG, 1000, &quot;elfu 1&quot;},
294             // Long path
295             {FORMAT_SW_LONG, 3000000L, &quot;milioni 3&quot;},
296             // Long path, negative
297             {FORMAT_SW_LONG, -3000000L, &quot;milioni -3&quot;},
298             // Double path
299             {FORMAT_SW_LONG, 3000000.0, &quot;milioni 3&quot;},
300             // Double path, negative
301             {FORMAT_SW_LONG, -3000000.0, &quot;milioni -3&quot;},
302             // BigInteger path
303             {FORMAT_SW_LONG, new BigInteger(&quot;12345678901234567890&quot;),
304                 &quot;trilioni 12345679&quot;},
305             // BigDecimal path
306             {FORMAT_SW_LONG, new BigDecimal(&quot;12345678901234567890.89&quot;),
307                 &quot;trilioni 12345679&quot;},
308             // Positives
309             // No compact form
310             {FORMAT_SE_SHORT, 999, &quot;999&quot;},
311             // Long
312             {FORMAT_SE_SHORT, 8000000L, &quot;8\u00a0mn&quot;},
313             // Double
314             {FORMAT_SE_SHORT, 8000.98, &quot;8\u00a0dt&quot;},
315             // Big integer
316             {FORMAT_SE_SHORT, new BigInteger(&quot;12345678901234567890&quot;), &quot;12345679\u00a0bn&quot;},
317             // Big decimal
318             {FORMAT_SE_SHORT, new BigDecimal(&quot;12345678901234567890.98&quot;), &quot;12345679\u00a0bn&quot;},
319             // Negatives
320             // No compact form
321             {FORMAT_SE_SHORT, -999, &quot;\u2212999&quot;},
322             // Long
323             {FORMAT_SE_SHORT, -8000000L, &quot;\u22128\u00a0mn&quot;},
324             // Double
325             {FORMAT_SE_SHORT, -8000.98, &quot;\u22128\u00a0dt&quot;},
326             // BigInteger
327             {FORMAT_SE_SHORT, new BigInteger(&quot;-12345678901234567890&quot;), &quot;\u221212345679\u00a0bn&quot;},
328             // BigDecimal
329             {FORMAT_SE_SHORT, new BigDecimal(&quot;-12345678901234567890.98&quot;), &quot;\u221212345679\u00a0bn&quot;},
330 
331             // Plurals
332             // DE: one:i = 1 and v = 0
333             {FORMAT_DE_LONG, 1_000_000, &quot;1 Million&quot;},
334             {FORMAT_DE_LONG, 2_000_000, &quot;2 Millionen&quot;},
335             // SL: one:v = 0 and i % 100 = 1
336             //     two:v = 0 and i % 100 = 2
337             //     few:v = 0 and i % 100 = 3..4 or v != 0
338             {FORMAT_SL_LONG, 1_000_000, &quot;1 milijon&quot;},
339             {FORMAT_SL_LONG, 2_000_000, &quot;2 milijona&quot;},
340             {FORMAT_SL_LONG, 3_000_000, &quot;3 milijone&quot;},
341             {FORMAT_SL_LONG, 5_000_000, &quot;5 milijonov&quot;},
342         };
343     }
344 
345     @DataProvider(name = &quot;parse&quot;)
346     Object[][] compactParseData() {
347         return new Object[][]{
348                 // compact number format instance, string to parse, parsed number, return type
349                 {FORMAT_DZ_LONG, &quot;\u0F66\u0F9F\u0F7C\u0F44\u0F0B\u0F55\u0FB2&quot;
350                         + &quot;\u0F42 \u0F21&quot;, 1000L, Long.class},
351                 {FORMAT_DZ_LONG, &quot;-\u0F66\u0F9F\u0F7C\u0F44\u0F0B\u0F55\u0FB2&quot;
352                         + &quot;\u0F42 \u0F23&quot;, -3000L, Long.class},
353                 {FORMAT_DZ_LONG, &quot;\u0F51\u0F74\u0F44\u0F0B\u0F55\u0FB1\u0F74\u0F62&quot;
354                         + &quot;\u0F0B\u0F66\u0F0B\u0F61\u0F0B \u0F21&quot;
355                         + &quot;\u0F22\u0F23\u0F24\u0F25\u0F27&quot;, 1.23457E19, Double.class},
356                 {FORMAT_DZ_LONG, &quot;-\u0F51\u0F74\u0F44\u0F0B\u0F55\u0FB1\u0F74\u0F62&quot;
357                         + &quot;\u0F0B\u0F66\u0F0B\u0F61\u0F0B \u0F21&quot;
358                         + &quot;\u0F22\u0F23\u0F24\u0F25\u0F27&quot;, -1.23457E19, Double.class},
359                 {FORMAT_EN_US_SHORT, &quot;-0.0&quot;, -0.0, Double.class},
360                 {FORMAT_EN_US_SHORT, &quot;-0&quot;, -0.0, Double.class},
361                 {FORMAT_EN_US_SHORT, &quot;0&quot;, 0L, Long.class},
362                 {FORMAT_EN_US_SHORT, &quot;499&quot;, 499L, Long.class},
363                 {FORMAT_EN_US_SHORT, &quot;-499&quot;, -499L, Long.class},
364                 {FORMAT_EN_US_SHORT, &quot;499.89&quot;, 499.89, Double.class},
365                 {FORMAT_EN_US_SHORT, &quot;-499.89&quot;, -499.89, Double.class},
366                 {FORMAT_EN_US_SHORT, &quot;1K&quot;, 1000L, Long.class},
367                 {FORMAT_EN_US_SHORT, &quot;-1K&quot;, -1000L, Long.class},
368                 {FORMAT_EN_US_SHORT, &quot;3K&quot;, 3000L, Long.class},
369                 {FORMAT_EN_US_SHORT, &quot;17K&quot;, 17000L, Long.class},
370                 {FORMAT_EN_US_SHORT, &quot;-17K&quot;, -17000L, Long.class},
371                 {FORMAT_EN_US_SHORT, &quot;-3K&quot;, -3000L, Long.class},
372                 {FORMAT_EN_US_SHORT, &quot;12345678901234567890&quot;, 1.2345678901234567E19, Double.class},
373                 {FORMAT_EN_US_SHORT, &quot;12345679T&quot;, 1.2345679E19, Double.class},
374                 {FORMAT_EN_US_SHORT, &quot;-12345679T&quot;, -1.2345679E19, Double.class},
375                 {FORMAT_EN_US_SHORT, &quot;599.01K&quot;, 599010L, Long.class},
376                 {FORMAT_EN_US_SHORT, &quot;-599.01K&quot;, -599010L, Long.class},
377                 {FORMAT_EN_US_SHORT, &quot;599444444.90T&quot;, 5.994444449E20, Double.class},
378                 {FORMAT_EN_US_SHORT, &quot;-599444444.90T&quot;, -5.994444449E20, Double.class},
379                 {FORMAT_EN_US_SHORT, &quot;123456789012345.5678K&quot;, 123456789012345568L, Long.class},
380                 {FORMAT_EN_US_SHORT, &quot;17.000K&quot;, 17000L, Long.class},
381                 {FORMAT_EN_US_SHORT, &quot;123.56678K&quot;, 123566.78000, Double.class},
382                 {FORMAT_EN_US_SHORT, &quot;-123.56678K&quot;, -123566.78000, Double.class},
383                 {FORMAT_EN_LONG, &quot;999&quot;, 999L, Long.class},
384                 {FORMAT_EN_LONG, &quot;1 thousand&quot;, 1000L, Long.class},
385                 {FORMAT_EN_LONG, &quot;3 thousand&quot;, 3000L, Long.class},
386                 {FORMAT_EN_LONG, &quot;12345679 trillion&quot;, 1.2345679E19, Double.class},
387                 {FORMAT_HI_IN_LONG, &quot;999&quot;, 999L, Long.class},
388                 {FORMAT_HI_IN_LONG, &quot;-999&quot;, -999L, Long.class},
389                 {FORMAT_HI_IN_LONG, &quot;1 \u0939\u091C\u093C\u093E\u0930&quot;, 1000L, Long.class},
390                 {FORMAT_HI_IN_LONG, &quot;-1 \u0939\u091C\u093C\u093E\u0930&quot;, -1000L, Long.class},
391                 {FORMAT_HI_IN_LONG, &quot;3 \u0939\u091C\u093C\u093E\u0930&quot;, 3000L, Long.class},
392                 {FORMAT_HI_IN_LONG, &quot;12345679 \u0916\u0930\u092C&quot;, 1234567900000000000L, Long.class},
393                 {FORMAT_HI_IN_LONG, &quot;-12345679 \u0916\u0930\u092C&quot;, -1234567900000000000L, Long.class},
394                 {FORMAT_JA_JP_SHORT, &quot;-99&quot;, -99L, Long.class},
395                 {FORMAT_JA_JP_SHORT, &quot;1\u4E07&quot;, 10000L, Long.class},
396                 {FORMAT_JA_JP_SHORT, &quot;30\u4E07&quot;, 300000L, Long.class},
397                 {FORMAT_JA_JP_SHORT, &quot;-30\u4E07&quot;, -300000L, Long.class},
398                 {FORMAT_JA_JP_SHORT, &quot;12345679\u5146&quot;, 1.2345679E19, Double.class},
399                 {FORMAT_JA_JP_SHORT, &quot;-12345679\u5146&quot;, -1.2345679E19, Double.class},
400                 {FORMAT_IT_SHORT, &quot;-99&quot;, -99L, Long.class},
401                 {FORMAT_IT_SHORT, &quot;1\u00a0Mln&quot;, 1000000L, Long.class},
402                 {FORMAT_IT_SHORT, &quot;30\u00a0Mln&quot;, 30000000L, Long.class},
403                 {FORMAT_IT_SHORT, &quot;-30\u00a0Mln&quot;, -30000000L, Long.class},
404                 {FORMAT_IT_SHORT, &quot;12345679\u00a0Bln&quot;, 1.2345679E19, Double.class},
405                 {FORMAT_IT_SHORT, &quot;-12345679\u00a0Bln&quot;, -1.2345679E19, Double.class},
406                 {FORMAT_SW_LONG, &quot;-0.0&quot;, -0.0, Double.class},
407                 {FORMAT_SW_LONG, &quot;499&quot;, 499L, Long.class},
408                 {FORMAT_SW_LONG, &quot;elfu 1&quot;, 1000L, Long.class},
409                 {FORMAT_SW_LONG, &quot;elfu 3&quot;, 3000L, Long.class},
410                 {FORMAT_SW_LONG, &quot;elfu 17&quot;, 17000L, Long.class},
411                 {FORMAT_SW_LONG, &quot;elfu -3&quot;, -3000L, Long.class},
412                 {FORMAT_SW_LONG, &quot;499&quot;, 499L, Long.class},
413                 {FORMAT_SW_LONG, &quot;-499&quot;, -499L, Long.class},
414                 {FORMAT_SW_LONG, &quot;elfu 1&quot;, 1000L, Long.class},
415                 {FORMAT_SW_LONG, &quot;elfu 3&quot;, 3000L, Long.class},
416                 {FORMAT_SW_LONG, &quot;elfu -3&quot;, -3000L, Long.class},
417                 {FORMAT_SW_LONG, &quot;elfu 17&quot;, 17000L, Long.class},
418                 {FORMAT_SW_LONG, &quot;trilioni 12345679&quot;, 1.2345679E19, Double.class},
419                 {FORMAT_SW_LONG, &quot;trilioni -12345679&quot;, -1.2345679E19, Double.class},
420                 {FORMAT_SW_LONG, &quot;elfu 599.01&quot;, 599010L, Long.class},
421                 {FORMAT_SW_LONG, &quot;elfu -599.01&quot;, -599010L, Long.class},
422                 {FORMAT_SE_SHORT, &quot;999&quot;, 999L, Long.class},
423                 {FORMAT_SE_SHORT, &quot;8\u00a0mn&quot;, 8000000L, Long.class},
424                 {FORMAT_SE_SHORT, &quot;8\u00a0dt&quot;, 8000L, Long.class},
425                 {FORMAT_SE_SHORT, &quot;12345679\u00a0bn&quot;, 1.2345679E19, Double.class},
426                 {FORMAT_SE_SHORT, &quot;12345679,89\u00a0bn&quot;, 1.2345679890000001E19, Double.class},
427                 {FORMAT_SE_SHORT, &quot;\u2212999&quot;, -999L, Long.class},
428                 {FORMAT_SE_SHORT, &quot;\u22128\u00a0mn&quot;, -8000000L, Long.class},
429                 {FORMAT_SE_SHORT, &quot;\u22128\u00a0dt&quot;, -8000L, Long.class},
430                 {FORMAT_SE_SHORT, &quot;\u221212345679\u00a0bn&quot;, -1.2345679E19, Double.class},
431                 {FORMAT_SE_SHORT, &quot;\u221212345679,89\u00a0bn&quot;, -1.2345679890000001E19, Double.class},
432 
433                 // Plurals
434                 // DE: one:i = 1 and v = 0
435                 {FORMAT_DE_LONG, &quot;1 Million&quot;,   1_000_000L, Long.class},
436                 {FORMAT_DE_LONG, &quot;2 Millionen&quot;, 2_000_000L, Long.class},
437                 // SL: one:v = 0 and i % 100 = 1
438                 //     two:v = 0 and i % 100 = 2
439                 //     few:v = 0 and i % 100 = 3..4 or v != 0
440                 {FORMAT_SL_LONG, &quot;1 milijon&quot;,   1_000_000L, Long.class},
441                 {FORMAT_SL_LONG, &quot;2 milijona&quot;,  2_000_000L, Long.class},
442                 {FORMAT_SL_LONG, &quot;3 milijone&quot;,  3_000_000L, Long.class},
443                 {FORMAT_SL_LONG, &quot;5 milijonov&quot;, 5_000_000L, Long.class},
444         };
445     }
446 
447     @DataProvider(name = &quot;exceptionParse&quot;)
448     Object[][] exceptionParseData() {
449         return new Object[][]{
450             // compact number instance, string to parse, null (no o/p; must throws exception)
451             // no number
452             {FORMAT_DZ_LONG, &quot;\u0F66\u0F9F\u0F7C\u0F44\u0F0B\u0F55\u0FB2&quot;
453                 + &quot;\u0F42&quot;, null},
454             // Invalid prefix
455             {FORMAT_DZ_LONG, &quot;-\u0F66\u0F9F\u0F7C\u0F44,\u0F0B\u0F55\u0FB2&quot;
456                 + &quot;\u0F42 \u0F23&quot;, null},
457             // Invalid prefix for en_US
458             {FORMAT_EN_US_SHORT, &quot;K12,347&quot;, null},
459             // Invalid prefix for ja_JP
460             {FORMAT_JA_JP_SHORT, &quot;\u4E071&quot;, null},
461             // Localized minus sign should be used
462             {FORMAT_SE_SHORT, &quot;-8\u00a0mn&quot;, null},};
463     }
464 
465     @DataProvider(name = &quot;invalidParse&quot;)
466     Object[][] invalidParseData() {
467         return new Object[][]{
468             // compact number instance, string to parse, parsed number
469             // Prefix and suffix do not match
470             {FORMAT_DZ_LONG, &quot;\u0F66\u0F9F\u0F7C\u0F44\u0F0B\u0F55\u0FB2&quot;
471                 + &quot;\u0F42 \u0F21 KM&quot;, 1000L},
472             // Exponents are unparseable
473             {FORMAT_EN_US_SHORT, &quot;-1.05E4K&quot;, -1.05},
474             // Default instance does not allow grouping
475             {FORMAT_EN_US_SHORT, &quot;12,347&quot;, 12L},
476             // Take partial suffix &quot;K&quot; as 1000 for en_US_SHORT patterns
477             {FORMAT_EN_US_SHORT, &quot;12KM&quot;, 12000L},
478             // Invalid suffix
479             {FORMAT_HI_IN_LONG, &quot;-1 \u00a0\u0915.&quot;, -1L},
480 
481             // invalid plurals
482             {FORMAT_DE_LONG, &quot;2 Million&quot;, 2L},
483             {FORMAT_SL_LONG, &quot;2 milijon&quot;, 2L},
484             {FORMAT_SL_LONG, &quot;2 milijone&quot;, 2L},
485             {FORMAT_SL_LONG, &quot;2 milijonv&quot;, 2L},
486             {FORMAT_SL_LONG, &quot;3 milijon&quot;, 3L},
487             {FORMAT_SL_LONG, &quot;3 milijona&quot;, 3L},
488             {FORMAT_SL_LONG, &quot;3 milijonv&quot;, 3L},
489             {FORMAT_SL_LONG, &quot;5 milijon&quot;, 5L},
490             {FORMAT_SL_LONG, &quot;5 milijona&quot;, 5L},
491             {FORMAT_SL_LONG, &quot;5 milijone&quot;, 5L},
492         };
493     }
494 
495     @DataProvider(name = &quot;fieldPosition&quot;)
496     Object[][] formatFieldPositionData() {
497         return new Object[][]{
498             //compact number instance, number to format, field, start position, end position, formatted string
499             {FORMAT_DZ_LONG, -3500, NumberFormat.Field.SIGN, 0, 1, &quot;-\u0F66\u0F9F\u0F7C\u0F44\u0F0B\u0F55\u0FB2\u0F42 \u0F24&quot;},
500             {FORMAT_DZ_LONG, 3500, NumberFormat.Field.INTEGER, 9, 10, &quot;\u0F66\u0F9F\u0F7C\u0F44\u0F0B\u0F55\u0FB2\u0F42 \u0F24&quot;},
501             {FORMAT_DZ_LONG, -3500, NumberFormat.Field.INTEGER, 10, 11, &quot;-\u0F66\u0F9F\u0F7C\u0F44\u0F0B\u0F55\u0FB2\u0F42 \u0F24&quot;},
502             {FORMAT_DZ_LONG, 999, NumberFormat.Field.INTEGER, 0, 3, &quot;\u0F29\u0F29\u0F29&quot;},
503             {FORMAT_DZ_LONG, -999, NumberFormat.Field.INTEGER, 1, 4, &quot;-\u0F29\u0F29\u0F29&quot;},
504             {FORMAT_DZ_LONG, 3500, NumberFormat.Field.PREFIX, 0, 9, &quot;\u0F66\u0F9F\u0F7C\u0F44\u0F0B\u0F55\u0FB2\u0F42 \u0F24&quot;},
505             {FORMAT_DZ_LONG, -3500, NumberFormat.Field.PREFIX, 0, 10, &quot;-\u0F66\u0F9F\u0F7C\u0F44\u0F0B\u0F55\u0FB2\u0F42 \u0F24&quot;},
506             {FORMAT_DZ_LONG, 999, NumberFormat.Field.PREFIX, 0, 0, &quot;\u0F29\u0F29\u0F29&quot;},
507             {FORMAT_EN_US_SHORT, -3500, NumberFormat.Field.SIGN, 0, 1, &quot;-4K&quot;},
508             {FORMAT_EN_US_SHORT, 3500, NumberFormat.Field.INTEGER, 0, 1, &quot;4K&quot;},
509             {FORMAT_EN_US_SHORT, 14900000067L, NumberFormat.Field.INTEGER, 0, 2, &quot;15B&quot;},
510             {FORMAT_EN_US_SHORT, -1000, NumberFormat.Field.PREFIX, 0, 1, &quot;-1K&quot;},
511             {FORMAT_EN_US_SHORT, 3500, NumberFormat.Field.SUFFIX, 1, 2, &quot;4K&quot;},
512             {FORMAT_EN_US_SHORT, 14900000067L, NumberFormat.Field.SUFFIX, 2, 3, &quot;15B&quot;},
513             {FORMAT_EN_LONG, 3500, NumberFormat.Field.INTEGER, 0, 1, &quot;4 thousand&quot;},
514             {FORMAT_EN_LONG, 14900000067L, NumberFormat.Field.INTEGER, 0, 2, &quot;15 billion&quot;},
515             {FORMAT_EN_LONG, 3500, NumberFormat.Field.SUFFIX, 1, 10, &quot;4 thousand&quot;},
516             {FORMAT_EN_LONG, 14900000067L, NumberFormat.Field.SUFFIX, 2, 10, &quot;15 billion&quot;},
517             {FORMAT_JA_JP_SHORT, 14900000067L, NumberFormat.Field.INTEGER, 0, 3, &quot;149\u5104&quot;},
518             {FORMAT_JA_JP_SHORT, -999.99, NumberFormat.Field.INTEGER, 1, 6, &quot;-1,000&quot;},
519             {FORMAT_JA_JP_SHORT, 14900000067L, NumberFormat.Field.SUFFIX, 3, 4, &quot;149\u5104&quot;},
520             {FORMAT_JA_JP_SHORT, -999.99, NumberFormat.Field.SUFFIX, 0, 0, &quot;-1,000&quot;},
521             {FORMAT_JA_JP_SHORT, -999.99, NumberFormat.Field.SIGN, 0, 1, &quot;-1,000&quot;},
522             {FORMAT_HI_IN_LONG, -14900000067L, NumberFormat.Field.SIGN, 0, 1,
523                 &quot;-15 \u0905\u0930\u092C&quot;},
524             {FORMAT_HI_IN_LONG, 3500, NumberFormat.Field.INTEGER, 0, 1,
525                 &quot;4 \u0939\u091C\u093C\u093E\u0930&quot;},
526             {FORMAT_HI_IN_LONG, 14900000067L, NumberFormat.Field.INTEGER, 0, 2,
527                 &quot;15 \u0905\u0930\u092C&quot;},
528             {FORMAT_HI_IN_LONG, 3500, NumberFormat.Field.SUFFIX, 1, 7,
529                 &quot;4 \u0939\u091C\u093C\u093E\u0930&quot;},
530             {FORMAT_HI_IN_LONG, 14900000067L, NumberFormat.Field.SUFFIX, 2, 6,
531                 &quot;15 \u0905\u0930\u092C&quot;},
532             {FORMAT_SE_SHORT, 8000000L, NumberFormat.Field.SUFFIX, 1, 4, &quot;8\u00a0mn&quot;},
533             {FORMAT_SE_SHORT, 8000.98, NumberFormat.Field.SUFFIX, 1, 4, &quot;8\u00a0dt&quot;},
534             {FORMAT_SE_SHORT, new BigInteger(&quot;12345678901234567890&quot;), NumberFormat.Field.SUFFIX, 8, 11, &quot;12345679\u00a0bn&quot;},
535             {FORMAT_SE_SHORT, new BigDecimal(&quot;12345678901234567890.98&quot;), NumberFormat.Field.SUFFIX, 8, 11, &quot;12345679\u00a0bn&quot;},
536             {FORMAT_SE_SHORT, -8000000L, NumberFormat.Field.INTEGER, 1, 2, &quot;\u22128\u00a0mn&quot;},
537             {FORMAT_SE_SHORT, -8000.98, NumberFormat.Field.SIGN, 0, 1, &quot;\u22128\u00a0dt&quot;},
538             {FORMAT_SE_SHORT, new BigDecimal(&quot;-48982865901234567890.98&quot;), NumberFormat.Field.INTEGER, 1, 9, &quot;\u221248982866\u00a0bn&quot;},};
539     }
540 
541     @DataProvider(name = &quot;varParsePosition&quot;)
542     Object[][] varParsePosition() {
543         return new Object[][]{
544                 // compact number instance, parse string, parsed number,
545                 // start position, end position, error index
546                 {FORMAT_DZ_LONG, &quot;\u0F66\u0F9F\u0F7C\u0F44\u0F0B\u0F55\u0FB2&quot;
547                         + &quot;\u0F42 \u0F21 KM&quot;, 1000L, 0, 10, -1},
548                 // Invalid prefix returns null
549                 {FORMAT_DZ_LONG, &quot;Number is: -\u0F66\u0F9F\u0F7C\u0F44,\u0F0B\u0F55\u0FB2&quot;
550                         + &quot;\u0F42 \u0F23&quot;, null, 11, 11, 11},
551                 // Returns null
552                 {FORMAT_DZ_LONG, &quot;\u0F66\u0F9F\u0F7C\u0F44\u0F0B\u0F55\u0FB2&quot;
553                         + &quot;\u0F42&quot;, null, 0, 0, 0},
554                 {FORMAT_EN_US_SHORT, &quot;Exponent: -1.05E4K&quot;, -1.05, 10, 15, -1},
555                 // Default instance does not allow grouping
556                 {FORMAT_EN_US_SHORT, &quot;12,347&quot;, 12L, 0, 2, -1},
557                 // Invalid suffix &quot;KM&quot; for en_US_SHORT patterns
558                 {FORMAT_EN_US_SHORT, &quot;12KM&quot;, 12000L, 0, 3, -1},
559                 // Invalid suffix
560                 {FORMAT_HI_IN_LONG, &quot;-1 \u00a0\u0915.&quot;, -1L, 0, 2, -1},
561                 {FORMAT_EN_LONG, &quot;Number is: 12345679 trillion&quot;,
562                         1.2345679E19, 11, 28, -1},
563                 {FORMAT_EN_LONG, &quot;Number is: -12345679 trillion&quot;,
564                         -1.2345679E19, 11, 29, -1},
565                 {FORMAT_EN_LONG, &quot;parse 12 thousand and four&quot;, 12000L, 6, 17, -1},};
566     }
567 
568     @Test
569     public void testInstanceCreation() {
570         Stream.of(NumberFormat.getAvailableLocales()).forEach(l -&gt; NumberFormat
571                 .getCompactNumberInstance(l, NumberFormat.Style.SHORT).format(10000));
572         Stream.of(NumberFormat.getAvailableLocales()).forEach(l -&gt; NumberFormat
573                 .getCompactNumberInstance(l, NumberFormat.Style.LONG).format(10000));
574     }
575 
576     @Test(expectedExceptions = IllegalArgumentException.class)
577     public void testFormatWithNullParam() {
578         FORMAT_EN_US_SHORT.format(null);
579     }
580 
581     @Test(dataProvider = &quot;format&quot;)
582     public void testFormat(NumberFormat cnf, Object number,
583             String expected) {
584         CompactFormatAndParseHelper.testFormat(cnf, number, expected);
585     }
586 
587     @Test(dataProvider = &quot;parse&quot;)
588     public void testParse(NumberFormat cnf, String parseString,
589             Number expected, Class&lt;? extends Number&gt; returnType) throws ParseException {
590         CompactFormatAndParseHelper.testParse(cnf, parseString, expected, null, returnType);
591     }
592 
593     @Test(dataProvider = &quot;parse&quot;)
594     public void testParsePosition(NumberFormat cnf, String parseString,
595             Number expected, Class&lt;? extends Number&gt; returnType) throws ParseException {
596         ParsePosition pos = new ParsePosition(0);
597         CompactFormatAndParseHelper.testParse(cnf, parseString, expected, pos, returnType);
598         assertEquals(pos.getIndex(), parseString.length());
599         assertEquals(pos.getErrorIndex(), -1);
600     }
601 
602     @Test(dataProvider = &quot;varParsePosition&quot;)
603     public void testVarParsePosition(NumberFormat cnf, String parseString,
604             Number expected, int startPosition, int indexPosition,
605             int errPosition) throws ParseException {
606         ParsePosition pos = new ParsePosition(startPosition);
607         CompactFormatAndParseHelper.testParse(cnf, parseString, expected, pos, null);
608         assertEquals(pos.getIndex(), indexPosition);
609         assertEquals(pos.getErrorIndex(), errPosition);
610     }
611 
612     @Test(dataProvider = &quot;exceptionParse&quot;, expectedExceptions = ParseException.class)
613     public void throwsParseException(NumberFormat cnf, String parseString,
614             Number expected) throws ParseException {
615         CompactFormatAndParseHelper.testParse(cnf, parseString, expected, null, null);
616     }
617 
618     @Test(dataProvider = &quot;invalidParse&quot;)
619     public void testInvalidParse(NumberFormat cnf, String parseString,
620             Number expected) throws ParseException {
621         CompactFormatAndParseHelper.testParse(cnf, parseString, expected, null, null);
622     }
623 
624     @Test(dataProvider = &quot;fieldPosition&quot;)
625     public void testFormatWithFieldPosition(NumberFormat nf,
626             Object number, Format.Field field, int posStartExpected,
627             int posEndExpected, String expected) {
628         FieldPosition pos = new FieldPosition(field);
629         StringBuffer buf = new StringBuffer();
630         StringBuffer result = nf.format(number, buf, pos);
631         assertEquals(result.toString(), expected, &quot;Incorrect formatting of the number &#39;&quot;
632                 + number + &quot;&#39;&quot;);
633         assertEquals(pos.getBeginIndex(), posStartExpected, &quot;Incorrect start position&quot;
634                 + &quot; while formatting the number &#39;&quot; + number + &quot;&#39;, for the field &quot; + field);
635         assertEquals(pos.getEndIndex(), posEndExpected, &quot;Incorrect end position&quot;
636                 + &quot; while formatting the number &#39;&quot; + number + &quot;&#39;, for the field &quot; + field);
637     }
638 
639 }
    </pre>
  </body>
</html>