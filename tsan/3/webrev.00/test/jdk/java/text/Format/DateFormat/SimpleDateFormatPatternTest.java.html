<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New test/jdk/java/text/Format/DateFormat/SimpleDateFormatPatternTest.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 /**
 25  * @test
 26  * @bug 4326988 6990146 8231213
 27  * @summary test SimpleDateFormat, check its pattern in the constructor
 28  * @run testng/othervm SimpleDateFormatPatternTest
 29  */
 30 import java.lang.IllegalArgumentException;
 31 import java.text.DateFormat;
 32 import java.text.DateFormatSymbols;
 33 import java.text.SimpleDateFormat;
 34 import java.util.Locale;
 35 
 36 import org.testng.annotations.DataProvider;
 37 import org.testng.annotations.Test;
 38 
 39 public class SimpleDateFormatPatternTest {
 40     private static String[] validPat = {
 41             &quot;yyyy-MM-dd h.mm.ss.a z&quot;,
 42             &quot;yyyy&#39;M&#39;d&#39; ahh&#39;mm&#39;ss&#39; z&quot;,
 43             &quot;dd MMMM yyyy hh:mm:ss&quot;,
 44             &quot;d MMM yy HH:mm:ss&quot;,
 45             &quot;dd/MM/yyyy HH:mm:ss&quot;,
 46             &quot;d&#39; / &#39;MMMM&#39; / &#39;yyyy HH:mm:ss z&quot;,
 47             &quot;d.M.yyyy H:mm:ss&quot;,
 48             &quot;d&#39; de &#39;MMMM&#39; de &#39;yyyy H&#39;h&#39;m&#39;min&#39;s&#39;s&#39; z&quot;,
 49             &quot;dd. MMMM yyyy HH:mm:ss z&quot;,
 50             &quot;d-M-yyyy H:mm:ss&quot;,
 51             &quot;EEEE&#39;&#39;d MMMM G yyyy, H&#39;  &#39;m&#39;  &#39;ss&#39; &#39;&quot;,
 52             &quot;dd.MMM.yyyy HH:mm:ss&quot;,
 53             &quot;yy-MM-dd h:mm:ss.a&quot;,
 54             &quot;d&#39; de &#39;MMMM&#39; de &#39;yyyy hh:mm:ss a z&quot;,
 55             &quot;EEEE d MMMM yyyy H&#39; h &#39;mm&#39; min &#39;ss&#39; s &#39;z&quot;,
 56             &quot;d MMMM yyyy H:mm:ss&quot;,
 57             &quot;d/MM/yyyy hh:mm:ss a&quot;,
 58             &quot;EEEE, d, MMMM yyyy HH:mm:ss z&quot;,
 59             &quot;EEEE, d. MMMM yyyy HH.mm.&#39; h&#39; z&quot;,
 60             &quot;EEEE, d&#39; / &#39;MMMM&#39; / &#39;yyyy HH:mm:ss z&quot;,
 61             &quot;d/MM/yyyy HH:mm:ss&quot;,
 62             &quot;d MMMM yyyy H:mm:ss z&quot;,
 63             &quot;MMMM d, yyyy h:mm:ss a z&quot;,
 64             &quot;yyyy. MMMM d. H:mm:ss z&quot;,
 65             &quot;d&#39; de &#39;MMMM&#39; de &#39;yyyy H:mm:ss z&quot;,
 66             &quot;EEEE, MMMM d, yyyy h:mm:ss a z&quot;,
 67             &quot;d/M/yyyy H:mm:ss&quot;,
 68             &quot;d-MMM-yy HH:mm:ss&quot;,
 69             &quot;EEEE d&#39; de &#39;MMMM&#39; de &#39;yyyy hh:mm:ss a z&quot;,
 70             &quot;yyyy&#39;M&#39;d&#39; ahh&#39;mm&#39;ss&#39;&quot;,
 71             &quot;yyyy&#39;MM&#39;dd&#39; EEEE ahh&#39;mm&#39;ss&#39;&quot;,
 72             &quot;EEEE, d MMMM yyyy HH:mm:ss z&quot;,
 73 
 74             //6990146: &#39;Y&#39; for year; &#39;X&#39; for time zone; &#39;u&#39; for day number of the week
 75             &quot;d/M/YYYY H:mm:ss&quot;,
 76             &quot;d-MMM-YY HH:mm:ss&quot;,
 77             &quot;EEEE d&#39; de &#39;MMMM&#39; de &#39;YYYY hh:mm:ss a X&quot;,
 78             &quot;YYYY M d ahh:mm:ss&quot;,
 79             &quot;YYYY MM dd EEEE u ahh/mm/ss&quot;,
 80             &quot;EEEE, u, d MMMM YYYY HH:mm:ss X&quot;,
 81             &quot;YYYY M d Z ahh mm ss&quot;,
 82             &quot;YYYY-MM-dd EEEE u ahh-mm-ss&quot;,
 83 
 84             //*added for sr-Latn*
 85             &quot;EEEE, dd. MMMM y. HH.mm.ss zzzz&quot;,
 86             &quot;dd. MMMM y. HH.mm.ss z&quot;,
 87             &quot;dd.MM.y. HH.mm.ss&quot;,
 88             &quot;d.M.yy. HH.mm&quot;
 89     };
 90 
 91     private static String[] invalidPat = {
 92             &quot;yyyy&#39;M&#39;d&#39; ahh:mm:ss&quot;,
 93             &quot;EEEe d MM MM yyyy HH&#39; h &#39;mm zzzZ&quot;,
 94             &quot;d MMMM\\ yyyy, H&#39;  &#39;m&#39; &#39;g&quot;,
 95             &quot;EEEE d&#39; @# MMMMde &#39;yyys HHH&#39;mm z&quot;,
 96             &quot;yyyy&#39;MMe 2 #dd&#39; EEEEahh&#39;mm&#39;ss&#39; z,z&quot;,
 97             &quot;yyyy.M.d H;mm.ses&quot;,
 98             &quot;EEEe, d MMMM yyyy h:mm:ss a z&quot;,
 99             &quot;EEEE, MMMM d, &#39;y y y y h:mm:ss &#39;o&#39;&#39;clock&#39; a z&quot;,
100             &quot;dd MMMM yyyy 0HHcl:mm:ss z&quot;,
101             &quot;d.M_M_y.yy1yy HextH:mm|45:&quot;,
102             &quot;d,D MMMTTTTTTTTTKM yy|+yy HH:m m:ss z&quot;,
103             &quot;d-MDtM M-yy H:mm:ss&quot;,
104             &quot;yyyy/M///m/nM/d Dd H:m$m:s s&quot;,
105             &quot;EEEE, dd. MMMM yyyy HH:m&#39;&#39;&#39;m&#39; Uhr &#39;z&quot;,
106             //6990146
107             &quot;EEEE d&#39; de &#39;MMMM&#39; de &#39;YYYY hh:mm:ss a x&quot;,
108             &quot;EEEE, U, d MMMM YYYY HH:mm:ss Z&quot;
109     };
110 
111     private static Locale[] locales = DateFormat.getAvailableLocales();
112     private static Object[][] dfAllLocalesObj = createAllLocales();
113     private static Object[][] invalidPatObj = createPatternObj(invalidPat);
114     private static Object[][] validPatObj = createPatternObj(validPat);
115 
116     private static Object[][] createAllLocales() {
117         Object[][] objArray = new Object[locales.length][];
118         for (int i = 0; i &lt; locales.length; i++) {
119             objArray[i] = new Object[1];
120             objArray[i][0] = locales[i];
121         }
122         return objArray;
123     }
124 
125     private static Object[][] createPatternObj(String[] pattern){
126         Object[][] objArray = new Object[locales.length * pattern.length][];
127         int k = 0;
128         for (int i = 0; i &lt; locales.length; i++) {
129             for (int j = 0; j &lt; pattern.length; j++) {
130                 objArray[k] = new Object[2];
131                 objArray[k][0] = pattern[j];
132                 objArray[k][1] = locales[i];
133                 k = k + 1;
134             }
135         }
136         return objArray;
137     }
138 
139     @DataProvider(name = &quot;dfAllLocalesObj&quot;)
140     Object[][] dfAllLocalesObj() {
141         return dfAllLocalesObj;
142     }
143 
144     @DataProvider(name = &quot;invalidPatternObj&quot;)
145     Object[][] invalidPatternObj() {
146         return invalidPatObj;
147     }
148 
149     @DataProvider(name = &quot;validPatternObj&quot;)
150     Object[][] validPatternObj() {
151         return validPatObj;
152     }
153 
154     //check Constructors for invalid pattern
155     @Test(dataProvider = &quot;invalidPatternObj&quot;,
156             expectedExceptions = IllegalArgumentException.class)
157     public void testIllegalArgumentException1(String pattern, Locale loc)
158             throws IllegalArgumentException {
159         Locale.setDefault(loc);
160         new SimpleDateFormat(pattern);
161     }
162 
163     @Test(dataProvider = &quot;invalidPatternObj&quot;,
164             expectedExceptions = IllegalArgumentException.class)
165     public void testIllegalArgumentException2(String pattern, Locale loc)
166             throws IllegalArgumentException {
167         Locale.setDefault(loc);
168         new SimpleDateFormat(pattern, new DateFormatSymbols());
169     }
170 
171     @Test(dataProvider = &quot;invalidPatternObj&quot;,
172             expectedExceptions = IllegalArgumentException.class)
173     public void testIllegalArgumentException3 (String pattern, Locale loc)
174             throws IllegalArgumentException {
175         Locale.setDefault(loc);
176         new SimpleDateFormat(pattern, Locale.getDefault());
177     }
178 
179     @Test(dataProvider = &quot;invalidPatternObj&quot;,
180             expectedExceptions = IllegalArgumentException.class)
181     public void testIllegalArgumentException4(String pattern, Locale loc)
182             throws IllegalArgumentException {
183         Locale.setDefault(loc);
184         new SimpleDateFormat().applyPattern(pattern);
185     }
186 
187     //check Constructors for null pattern
188     @Test(dataProvider = &quot;dfAllLocalesObj&quot;,
189             expectedExceptions = NullPointerException.class)
190     public void testNullPointerException1(Locale loc)
191             throws NullPointerException {
192         Locale.setDefault(loc);
193         new SimpleDateFormat(null);
194     }
195 
196     @Test(dataProvider = &quot;dfAllLocalesObj&quot;,
197             expectedExceptions = NullPointerException.class)
198     public void testNullPointerException2(Locale loc)
199             throws NullPointerException {
200         Locale.setDefault(loc);
201         new SimpleDateFormat(null, new DateFormatSymbols());
202     }
203 
204     @Test(dataProvider = &quot;dfAllLocalesObj&quot;,
205             expectedExceptions = NullPointerException.class)
206     public void testNullPointerException3(Locale loc)
207             throws NullPointerException {
208         Locale.setDefault(loc);
209         new SimpleDateFormat(null, Locale.getDefault());
210     }
211 
212     @Test(dataProvider = &quot;dfAllLocalesObj&quot;,
213             expectedExceptions = NullPointerException.class)
214     public void testNullPointerException4(Locale loc)
215             throws NullPointerException {
216         Locale.setDefault(loc);
217         new SimpleDateFormat().applyPattern(null);
218     }
219 
220     @Test(dataProvider = &quot;validPatternObj&quot;)
221     //check Constructors for valid pattern
222     public void testValidPattern(String pattern, Locale loc) {
223         Locale.setDefault(loc);
224         new SimpleDateFormat(pattern);
225         new SimpleDateFormat(pattern, new DateFormatSymbols());
226         new SimpleDateFormat(pattern, Locale.getDefault());
227         new SimpleDateFormat().applyPattern(pattern);
228     }
229 }
    </pre>
  </body>
</html>