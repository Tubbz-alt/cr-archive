<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/jdk/java/text/Format/NumberFormat/NumberRegression.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="CurrencyFormat.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../Normalizer/NormalizerAPITest.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/text/Format/NumberFormat/NumberRegression.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 1997, 2016, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 1997, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -27,11 +27,11 @@</span>
   * 4071492 4071859 4074454 4074620 4075713 4083018 4086575 4087244 4087245
   * 4087251 4087535 4088161 4088503 4090489 4090504 4092480 4092561 4095713
   * 4098741 4099404 4101481 4106658 4106662 4106664 4108738 4110936 4122840
   * 4125885 4134034 4134300 4140009 4141750 4145457 4147295 4147706 4162198
   * 4162852 4167494 4170798 4176114 4179818 4185761 4212072 4212073 4216742
<span class="udiff-line-modified-removed">-  * 4217661 4243011 4243108 4330377 4233840 4241880 4833877 8008577</span>
<span class="udiff-line-modified-added">+  * 4217661 4243011 4243108 4330377 4233840 4241880 4833877 8008577 8227313</span>
   * @summary Regression tests for NumberFormat and associated classes
   * @library /java/text/testlib
   * @build IntlTest HexDumpReader TestUtils
   * @modules java.base/sun.util.resources
   *          jdk.localedata
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1800,10 +1800,70 @@</span>
                          &quot;, got: &quot; + result);
              }
          }
          Locale.setDefault(savedLocale);
      }
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     /**</span>
<span class="udiff-line-added">+      * Test for get/setMonetaryGroupingSeparator() methods.</span>
<span class="udiff-line-added">+      * @since 15</span>
<span class="udiff-line-added">+      */</span>
<span class="udiff-line-added">+     public void test8227313() throws ParseException {</span>
<span class="udiff-line-added">+         var nrmSep = &#39;n&#39;;</span>
<span class="udiff-line-added">+         var monSep = &#39;m&#39;;</span>
<span class="udiff-line-added">+         var curSym = &quot;Cur&quot;;</span>
<span class="udiff-line-added">+         var inputNum = 10;</span>
<span class="udiff-line-added">+         var nrmPattern = &quot;,#&quot;;</span>
<span class="udiff-line-added">+         var monPattern = &quot;\u00a4 ,#&quot;;</span>
<span class="udiff-line-added">+         var expectedNrmFmt = &quot;1n0&quot;;</span>
<span class="udiff-line-added">+         var expectedMonFmt = &quot;Cur 1m0&quot;;</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         var ndfs = DecimalFormatSymbols.getInstance();</span>
<span class="udiff-line-added">+         ndfs.setGroupingSeparator(nrmSep);</span>
<span class="udiff-line-added">+         var nf = new DecimalFormat(nrmPattern, ndfs);</span>
<span class="udiff-line-added">+         var mdfs = DecimalFormatSymbols.getInstance();</span>
<span class="udiff-line-added">+         mdfs.setMonetaryGroupingSeparator(monSep);</span>
<span class="udiff-line-added">+         mdfs.setCurrencySymbol(curSym);</span>
<span class="udiff-line-added">+         var mf = new DecimalFormat(monPattern, mdfs);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // get test</span>
<span class="udiff-line-added">+         char gotNrmSep = mdfs.getGroupingSeparator();</span>
<span class="udiff-line-added">+         char gotMonSep = mdfs.getMonetaryGroupingSeparator();</span>
<span class="udiff-line-added">+         if (gotMonSep != monSep) {</span>
<span class="udiff-line-added">+             errln(&quot;FAIL: getMonetaryGroupingSeparator() returned incorrect value. expected: &quot;</span>
<span class="udiff-line-added">+                     + monSep + &quot;, got: &quot; + gotMonSep);</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+         if (gotMonSep == gotNrmSep) {</span>
<span class="udiff-line-added">+             errln(&quot;FAIL: getMonetaryGroupingSeparator() returned the same value with &quot; +</span>
<span class="udiff-line-added">+                     &quot;getGroupingSeparator(): monetary sep: &quot; + gotMonSep +</span>
<span class="udiff-line-added">+                     &quot;, normal sep: &quot; + gotNrmSep);</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // format test</span>
<span class="udiff-line-added">+         var formatted = mf.format(inputNum);</span>
<span class="udiff-line-added">+         if (!formatted.equals(expectedMonFmt)) {</span>
<span class="udiff-line-added">+             errln(&quot;FAIL: format failed. expected: &quot; + expectedMonFmt +</span>
<span class="udiff-line-added">+                     &quot;, got: &quot; + formatted);</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+         formatted = nf.format(inputNum);</span>
<span class="udiff-line-added">+         if (!formatted.equals(expectedNrmFmt)) {</span>
<span class="udiff-line-added">+             errln(&quot;FAIL: normal format failed. expected: &quot; + expectedNrmFmt +</span>
<span class="udiff-line-added">+                     &quot;, got: &quot; + formatted);</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // parse test</span>
<span class="udiff-line-added">+         Number parsed = mf.parse(expectedMonFmt);</span>
<span class="udiff-line-added">+         if (parsed.intValue() != inputNum) {</span>
<span class="udiff-line-added">+             errln(&quot;FAIL: parse failed. expected: &quot; + inputNum +</span>
<span class="udiff-line-added">+                     &quot;, got: &quot; + parsed);</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+         parsed = nf.parse(expectedNrmFmt);</span>
<span class="udiff-line-added">+         if (parsed.intValue() != inputNum) {</span>
<span class="udiff-line-added">+             errln(&quot;FAIL: normal parse failed. expected: &quot; + inputNum +</span>
<span class="udiff-line-added">+                     &quot;, got: &quot; + parsed);</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+     }</span>
  }
  
  @SuppressWarnings(&quot;serial&quot;)
  class myformat implements Serializable
  {
</pre>
<center><a href="CurrencyFormat.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../Normalizer/NormalizerAPITest.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>