<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/text/Format/NumberFormat/NumberRegression.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="CurrencyFormat.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../Normalizer/NormalizerAPITest.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/text/Format/NumberFormat/NumberRegression.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 1997, 2016, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.
   8  *
   9  * This code is distributed in the hope that it will be useful, but WITHOUT
  10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  12  * version 2 for more details (a copy is included in the LICENSE file that
  13  * accompanied this code).
  14  *
  15  * You should have received a copy of the GNU General Public License version
  16  * 2 along with this work; if not, write to the Free Software Foundation,
  17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18  *
  19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20  * or visit www.oracle.com if you need additional information or have any
  21  * questions.
  22  */
  23 
  24 /**
  25  * @test
  26  * @bug 4052223 4059870 4061302 4062486 4066646 4068693 4070798 4071005 4071014
  27  * 4071492 4071859 4074454 4074620 4075713 4083018 4086575 4087244 4087245
  28  * 4087251 4087535 4088161 4088503 4090489 4090504 4092480 4092561 4095713
  29  * 4098741 4099404 4101481 4106658 4106662 4106664 4108738 4110936 4122840
  30  * 4125885 4134034 4134300 4140009 4141750 4145457 4147295 4147706 4162198
  31  * 4162852 4167494 4170798 4176114 4179818 4185761 4212072 4212073 4216742
<span class="line-modified">  32  * 4217661 4243011 4243108 4330377 4233840 4241880 4833877 8008577</span>
  33  * @summary Regression tests for NumberFormat and associated classes
  34  * @library /java/text/testlib
  35  * @build IntlTest HexDumpReader TestUtils
  36  * @modules java.base/sun.util.resources
  37  *          jdk.localedata
  38  * @compile -XDignore.symbol.file NumberRegression.java
  39  * @run main/othervm -Djava.locale.providers=COMPAT,SPI NumberRegression
  40  */
  41 
  42 /*
  43 (C) Copyright Taligent, Inc. 1996 - All Rights Reserved
  44 (C) Copyright IBM Corp. 1996 - All Rights Reserved
  45 
  46   The original version of this source code and documentation is copyrighted and
  47 owned by Taligent, Inc., a wholly-owned subsidiary of IBM. These materials are
  48 provided under terms of a License Agreement between Taligent and Sun. This
  49 technology is protected by multiple US and International patents. This notice and
  50 attribution to Taligent may not be removed.
  51   Taligent is a registered trademark of Taligent, Inc.
  52 */
</pre>
<hr />
<pre>
1785                 &quot;#,##0.00&quot;, &quot;#,##0.000&quot;, &quot;#,##0.000&quot;,
1786         };
1787         String[] expected = {
1788                 &quot;2%&quot;, &quot;1%&quot;, &quot;2%&quot;, &quot;2%&quot;, &quot;1%&quot;,
1789                 &quot;0%&quot;, &quot;0%&quot;, &quot;1%&quot;, &quot;1%&quot;, &quot;1%&quot;,
1790                 &quot;0&quot;, &quot;2&quot;, &quot;0.2&quot;, &quot;0.6&quot;, &quot;0.04&quot;,
1791                 &quot;0.04&quot;, &quot;0.000&quot;, &quot;0.002&quot;,
1792         };
1793         for (int i = 0; i &lt; input.length; i++) {
1794             DecimalFormat format = new DecimalFormat(pattern[i]);
1795             String result = format.format(input[i]);
1796             if (!result.equals(expected[i])) {
1797                 errln(&quot;FAIL: input: &quot; + input[i] +
1798                         &quot;, pattern: &quot; + pattern[i] +
1799                         &quot;, expected: &quot; + expected[i] +
1800                         &quot;, got: &quot; + result);
1801             }
1802         }
1803         Locale.setDefault(savedLocale);
1804     }




























































1805 }
1806 
1807 @SuppressWarnings(&quot;serial&quot;)
1808 class myformat implements Serializable
1809 {
1810     DateFormat _dateFormat = DateFormat.getDateInstance();
1811 
1812     public String Now()
1813     {
1814         GregorianCalendar calendar = new GregorianCalendar();
1815         Date t = calendar.getTime();
1816         String nowStr = _dateFormat.format(t);
1817         return nowStr;
1818     }
1819 }
1820 
1821 @SuppressWarnings(&quot;serial&quot;)
1822 class MyNumberFormatTest extends NumberFormat {
1823     public StringBuffer format(double number, StringBuffer toAppendTo, FieldPosition pos) {
1824         return new StringBuffer(&quot;&quot;);
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 1997, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.
   8  *
   9  * This code is distributed in the hope that it will be useful, but WITHOUT
  10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  12  * version 2 for more details (a copy is included in the LICENSE file that
  13  * accompanied this code).
  14  *
  15  * You should have received a copy of the GNU General Public License version
  16  * 2 along with this work; if not, write to the Free Software Foundation,
  17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18  *
  19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20  * or visit www.oracle.com if you need additional information or have any
  21  * questions.
  22  */
  23 
  24 /**
  25  * @test
  26  * @bug 4052223 4059870 4061302 4062486 4066646 4068693 4070798 4071005 4071014
  27  * 4071492 4071859 4074454 4074620 4075713 4083018 4086575 4087244 4087245
  28  * 4087251 4087535 4088161 4088503 4090489 4090504 4092480 4092561 4095713
  29  * 4098741 4099404 4101481 4106658 4106662 4106664 4108738 4110936 4122840
  30  * 4125885 4134034 4134300 4140009 4141750 4145457 4147295 4147706 4162198
  31  * 4162852 4167494 4170798 4176114 4179818 4185761 4212072 4212073 4216742
<span class="line-modified">  32  * 4217661 4243011 4243108 4330377 4233840 4241880 4833877 8008577 8227313</span>
  33  * @summary Regression tests for NumberFormat and associated classes
  34  * @library /java/text/testlib
  35  * @build IntlTest HexDumpReader TestUtils
  36  * @modules java.base/sun.util.resources
  37  *          jdk.localedata
  38  * @compile -XDignore.symbol.file NumberRegression.java
  39  * @run main/othervm -Djava.locale.providers=COMPAT,SPI NumberRegression
  40  */
  41 
  42 /*
  43 (C) Copyright Taligent, Inc. 1996 - All Rights Reserved
  44 (C) Copyright IBM Corp. 1996 - All Rights Reserved
  45 
  46   The original version of this source code and documentation is copyrighted and
  47 owned by Taligent, Inc., a wholly-owned subsidiary of IBM. These materials are
  48 provided under terms of a License Agreement between Taligent and Sun. This
  49 technology is protected by multiple US and International patents. This notice and
  50 attribution to Taligent may not be removed.
  51   Taligent is a registered trademark of Taligent, Inc.
  52 */
</pre>
<hr />
<pre>
1785                 &quot;#,##0.00&quot;, &quot;#,##0.000&quot;, &quot;#,##0.000&quot;,
1786         };
1787         String[] expected = {
1788                 &quot;2%&quot;, &quot;1%&quot;, &quot;2%&quot;, &quot;2%&quot;, &quot;1%&quot;,
1789                 &quot;0%&quot;, &quot;0%&quot;, &quot;1%&quot;, &quot;1%&quot;, &quot;1%&quot;,
1790                 &quot;0&quot;, &quot;2&quot;, &quot;0.2&quot;, &quot;0.6&quot;, &quot;0.04&quot;,
1791                 &quot;0.04&quot;, &quot;0.000&quot;, &quot;0.002&quot;,
1792         };
1793         for (int i = 0; i &lt; input.length; i++) {
1794             DecimalFormat format = new DecimalFormat(pattern[i]);
1795             String result = format.format(input[i]);
1796             if (!result.equals(expected[i])) {
1797                 errln(&quot;FAIL: input: &quot; + input[i] +
1798                         &quot;, pattern: &quot; + pattern[i] +
1799                         &quot;, expected: &quot; + expected[i] +
1800                         &quot;, got: &quot; + result);
1801             }
1802         }
1803         Locale.setDefault(savedLocale);
1804     }
<span class="line-added">1805 </span>
<span class="line-added">1806     /**</span>
<span class="line-added">1807      * Test for get/setMonetaryGroupingSeparator() methods.</span>
<span class="line-added">1808      * @since 15</span>
<span class="line-added">1809      */</span>
<span class="line-added">1810     public void test8227313() throws ParseException {</span>
<span class="line-added">1811         var nrmSep = &#39;n&#39;;</span>
<span class="line-added">1812         var monSep = &#39;m&#39;;</span>
<span class="line-added">1813         var curSym = &quot;Cur&quot;;</span>
<span class="line-added">1814         var inputNum = 10;</span>
<span class="line-added">1815         var nrmPattern = &quot;,#&quot;;</span>
<span class="line-added">1816         var monPattern = &quot;\u00a4 ,#&quot;;</span>
<span class="line-added">1817         var expectedNrmFmt = &quot;1n0&quot;;</span>
<span class="line-added">1818         var expectedMonFmt = &quot;Cur 1m0&quot;;</span>
<span class="line-added">1819 </span>
<span class="line-added">1820         var ndfs = DecimalFormatSymbols.getInstance();</span>
<span class="line-added">1821         ndfs.setGroupingSeparator(nrmSep);</span>
<span class="line-added">1822         var nf = new DecimalFormat(nrmPattern, ndfs);</span>
<span class="line-added">1823         var mdfs = DecimalFormatSymbols.getInstance();</span>
<span class="line-added">1824         mdfs.setMonetaryGroupingSeparator(monSep);</span>
<span class="line-added">1825         mdfs.setCurrencySymbol(curSym);</span>
<span class="line-added">1826         var mf = new DecimalFormat(monPattern, mdfs);</span>
<span class="line-added">1827 </span>
<span class="line-added">1828         // get test</span>
<span class="line-added">1829         char gotNrmSep = mdfs.getGroupingSeparator();</span>
<span class="line-added">1830         char gotMonSep = mdfs.getMonetaryGroupingSeparator();</span>
<span class="line-added">1831         if (gotMonSep != monSep) {</span>
<span class="line-added">1832             errln(&quot;FAIL: getMonetaryGroupingSeparator() returned incorrect value. expected: &quot;</span>
<span class="line-added">1833                     + monSep + &quot;, got: &quot; + gotMonSep);</span>
<span class="line-added">1834         }</span>
<span class="line-added">1835         if (gotMonSep == gotNrmSep) {</span>
<span class="line-added">1836             errln(&quot;FAIL: getMonetaryGroupingSeparator() returned the same value with &quot; +</span>
<span class="line-added">1837                     &quot;getGroupingSeparator(): monetary sep: &quot; + gotMonSep +</span>
<span class="line-added">1838                     &quot;, normal sep: &quot; + gotNrmSep);</span>
<span class="line-added">1839         }</span>
<span class="line-added">1840 </span>
<span class="line-added">1841         // format test</span>
<span class="line-added">1842         var formatted = mf.format(inputNum);</span>
<span class="line-added">1843         if (!formatted.equals(expectedMonFmt)) {</span>
<span class="line-added">1844             errln(&quot;FAIL: format failed. expected: &quot; + expectedMonFmt +</span>
<span class="line-added">1845                     &quot;, got: &quot; + formatted);</span>
<span class="line-added">1846         }</span>
<span class="line-added">1847         formatted = nf.format(inputNum);</span>
<span class="line-added">1848         if (!formatted.equals(expectedNrmFmt)) {</span>
<span class="line-added">1849             errln(&quot;FAIL: normal format failed. expected: &quot; + expectedNrmFmt +</span>
<span class="line-added">1850                     &quot;, got: &quot; + formatted);</span>
<span class="line-added">1851         }</span>
<span class="line-added">1852 </span>
<span class="line-added">1853         // parse test</span>
<span class="line-added">1854         Number parsed = mf.parse(expectedMonFmt);</span>
<span class="line-added">1855         if (parsed.intValue() != inputNum) {</span>
<span class="line-added">1856             errln(&quot;FAIL: parse failed. expected: &quot; + inputNum +</span>
<span class="line-added">1857                     &quot;, got: &quot; + parsed);</span>
<span class="line-added">1858         }</span>
<span class="line-added">1859         parsed = nf.parse(expectedNrmFmt);</span>
<span class="line-added">1860         if (parsed.intValue() != inputNum) {</span>
<span class="line-added">1861             errln(&quot;FAIL: normal parse failed. expected: &quot; + inputNum +</span>
<span class="line-added">1862                     &quot;, got: &quot; + parsed);</span>
<span class="line-added">1863         }</span>
<span class="line-added">1864     }</span>
1865 }
1866 
1867 @SuppressWarnings(&quot;serial&quot;)
1868 class myformat implements Serializable
1869 {
1870     DateFormat _dateFormat = DateFormat.getDateInstance();
1871 
1872     public String Now()
1873     {
1874         GregorianCalendar calendar = new GregorianCalendar();
1875         Date t = calendar.getTime();
1876         String nowStr = _dateFormat.format(t);
1877         return nowStr;
1878     }
1879 }
1880 
1881 @SuppressWarnings(&quot;serial&quot;)
1882 class MyNumberFormatTest extends NumberFormat {
1883     public StringBuffer format(double number, StringBuffer toAppendTo, FieldPosition pos) {
1884         return new StringBuffer(&quot;&quot;);
</pre>
</td>
</tr>
</table>
<center><a href="CurrencyFormat.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../Normalizer/NormalizerAPITest.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>