<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/demo/jfc/J2Ddemo/J2DdemoTest.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../../../com/sun/nio/sctp/SctpMultiChannel/SocketOptionTests.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../../../java/awt/Choice/ChoiceKeyEventReaction/ChoiceKeyEventReaction.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/demo/jfc/J2Ddemo/J2DdemoTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 22  */
 23 
 24 /* @test
 25  * @key headful
 26  * @summary Test J2Ddemo.jar
 27  * @run main/timeout=200 J2DdemoTest
 28  */
 29 
 30 import java.io.InputStream;
 31 import java.io.IOException;
 32 import java.io.File;
 33 import java.io.BufferedInputStream;
 34 import java.io.PrintStream;
 35 
 36 public class J2DdemoTest {
 37 
 38     public static void main(String args[]) throws Exception {
 39         DemoRun test;
 40 
 41         /* Run the J2Ddemo.jar with the -runs=1 option */
<span class="line-modified"> 42         test = new DemoRun(&quot;demo/jfc/J2Ddemo/J2Ddemo.jar&quot;, &quot;-runs=1&quot;);</span>
 43         test.runit();
 44 
 45         /* Make sure patterns in output look ok */
 46         if (test.output_contains(&quot;ERROR&quot;)) {
 47             throw new RuntimeException(&quot;Test failed - ERROR seen in output&quot;);
 48         }
 49         if (test.output_contains(&quot;Exception&quot;)) {
 50             throw new RuntimeException(&quot;Test failed - Exception seen in output&quot;);
 51         }
 52 
 53         /* Must be a pass. */
 54         System.out.println(&quot;Test passed - cleanly terminated&quot;);
 55     }
 56 
 57     /*
 58      * Helper class to direct process output to a StringBuffer
 59      */
 60     static class MyInputStream implements Runnable {
 61         private String              name;
 62         private BufferedInputStream in;
</pre>
<hr />
<pre>
141                 vm_opts = vopts.split(&quot;\\p{Space}+&quot;);
142             } else {
143                 vm_opts = new String[0];
144             }
145 
146             /* Command line */
147             String cmd[] = new String[1 + vm_opts.length + 3];
148             String cmdLine;
149             int i;
150 
151             i = 0;
152             cmdLine = &quot;&quot;;
153             cmdLine += (cmd[i++] = java);
154             cmdLine += &quot; &quot;;
155             for ( String vopt : vm_opts ) {
156                 cmdLine += (cmd[i++] = vopt);
157                 cmdLine += &quot; &quot;;
158             }
159             cmdLine += (cmd[i++] = &quot;-jar&quot;);
160             cmdLine += &quot; &quot;;
<span class="line-modified">161             cmdLine += (cmd[i++] = sdk_home + File.separator + demo_name);</span>











162             cmdLine += &quot; &quot;;
163             cmdLine += (cmd[i++] = demo_options);
164 
165             /* Begin process */
166             Process p;
167 
168             System.out.println(&quot;Starting: &quot; + cmdLine);
169             try {
170                 p = Runtime.getRuntime().exec(cmd);
171             } catch ( IOException e ) {
172                 throw new RuntimeException(&quot;Test failed - exec got IO exception&quot;);
173             }
174 
175             /* Save process output in StringBuffers */
176             output = new MyInputStream(&quot;Input Stream&quot;, p.getInputStream());
177             error  = new MyInputStream(&quot;Error Stream&quot;, p.getErrorStream());
178 
179             /* Wait for process to complete, and if exit code is non-zero we fail */
180             int exitStatus;
181             try {
</pre>
</td>
<td>
<hr />
<pre>
 22  */
 23 
 24 /* @test
 25  * @key headful
 26  * @summary Test J2Ddemo.jar
 27  * @run main/timeout=200 J2DdemoTest
 28  */
 29 
 30 import java.io.InputStream;
 31 import java.io.IOException;
 32 import java.io.File;
 33 import java.io.BufferedInputStream;
 34 import java.io.PrintStream;
 35 
 36 public class J2DdemoTest {
 37 
 38     public static void main(String args[]) throws Exception {
 39         DemoRun test;
 40 
 41         /* Run the J2Ddemo.jar with the -runs=1 option */
<span class="line-modified"> 42         test = new DemoRun(&quot;jfc/J2Ddemo/J2Ddemo.jar&quot;, &quot;-runs=1&quot;);</span>
 43         test.runit();
 44 
 45         /* Make sure patterns in output look ok */
 46         if (test.output_contains(&quot;ERROR&quot;)) {
 47             throw new RuntimeException(&quot;Test failed - ERROR seen in output&quot;);
 48         }
 49         if (test.output_contains(&quot;Exception&quot;)) {
 50             throw new RuntimeException(&quot;Test failed - Exception seen in output&quot;);
 51         }
 52 
 53         /* Must be a pass. */
 54         System.out.println(&quot;Test passed - cleanly terminated&quot;);
 55     }
 56 
 57     /*
 58      * Helper class to direct process output to a StringBuffer
 59      */
 60     static class MyInputStream implements Runnable {
 61         private String              name;
 62         private BufferedInputStream in;
</pre>
<hr />
<pre>
141                 vm_opts = vopts.split(&quot;\\p{Space}+&quot;);
142             } else {
143                 vm_opts = new String[0];
144             }
145 
146             /* Command line */
147             String cmd[] = new String[1 + vm_opts.length + 3];
148             String cmdLine;
149             int i;
150 
151             i = 0;
152             cmdLine = &quot;&quot;;
153             cmdLine += (cmd[i++] = java);
154             cmdLine += &quot; &quot;;
155             for ( String vopt : vm_opts ) {
156                 cmdLine += (cmd[i++] = vopt);
157                 cmdLine += &quot; &quot;;
158             }
159             cmdLine += (cmd[i++] = &quot;-jar&quot;);
160             cmdLine += &quot; &quot;;
<span class="line-modified">161             String demo_path;</span>
<span class="line-added">162             String test_dir = System.getenv(&quot;TEST_IMAGE_DIR&quot;);</span>
<span class="line-added">163             System.out.println(&quot;TEST_IMAGE_DIR=&quot;+test_dir);</span>
<span class="line-added">164             if (test_dir != null) {</span>
<span class="line-added">165                 demo_path = test_dir + File.separator + &quot;jdk&quot; + File.separator +</span>
<span class="line-added">166                             &quot;demos&quot; + File.separator + demo_name;</span>
<span class="line-added">167             } else {</span>
<span class="line-added">168                 demo_path = sdk_home + File.separator +</span>
<span class="line-added">169                             &quot;demo&quot; + File.separator + demo_name;</span>
<span class="line-added">170             }</span>
<span class="line-added">171             System.out.println(&quot;demo_path=&quot;+demo_path);</span>
<span class="line-added">172             cmdLine += cmd[i++] = demo_path;</span>
173             cmdLine += &quot; &quot;;
174             cmdLine += (cmd[i++] = demo_options);
175 
176             /* Begin process */
177             Process p;
178 
179             System.out.println(&quot;Starting: &quot; + cmdLine);
180             try {
181                 p = Runtime.getRuntime().exec(cmd);
182             } catch ( IOException e ) {
183                 throw new RuntimeException(&quot;Test failed - exec got IO exception&quot;);
184             }
185 
186             /* Save process output in StringBuffers */
187             output = new MyInputStream(&quot;Input Stream&quot;, p.getInputStream());
188             error  = new MyInputStream(&quot;Error Stream&quot;, p.getErrorStream());
189 
190             /* Wait for process to complete, and if exit code is non-zero we fail */
191             int exitStatus;
192             try {
</pre>
</td>
</tr>
</table>
<center><a href="../../../com/sun/nio/sctp/SctpMultiChannel/SocketOptionTests.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../../../java/awt/Choice/ChoiceKeyEventReaction/ChoiceKeyEventReaction.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>