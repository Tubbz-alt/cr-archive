<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/javax/swing/JFrame/4962534/bug4962534.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../JFileChooser/ShellFolderQueries/ShellFolderQueriesTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../8175301/ScaledFrameBackgroundTest.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/javax/swing/JFrame/4962534/bug4962534.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2012, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 /*
<span class="line-modified"> 25  test</span>
<span class="line-modified"> 26  @bug 4962534 7104594</span>
<span class="line-modified"> 27  @summary JFrame dances very badly</span>
<span class="line-modified"> 28  @author dav@sparc.spb.su area=</span>
<span class="line-modified"> 29  @run applet bug4962534.html</span>
 30  */
<span class="line-modified"> 31 import java.applet.Applet;</span>
 32 import java.awt.*;
 33 import java.awt.event.*;
 34 import java.util.Random;
 35 import javax.swing.*;
 36 
<span class="line-modified"> 37 public class bug4962534 extends Applet {</span>
 38 
 39     Robot robot;
 40     volatile Point framePosition;
 41     volatile Point newFrameLocation;
<span class="line-modified"> 42     JFrame frame;</span>
 43     Rectangle gcBounds;
 44     Component titleComponent;
 45     JLayeredPane lPane;
 46     volatile boolean titleFound = false;
 47     public static Object LOCK = new Object();
 48 
<span class="line-modified"> 49     @Override</span>









 50     public void init() {
 51         try {
 52             SwingUtilities.invokeAndWait(new Runnable() {
 53                 @Override
 54                 public void run() {
 55                     createAndShowGUI();
 56                 }
 57             });
 58         } catch (Exception ex) {
 59             throw new RuntimeException(&quot;Init failed. &quot; + ex.getMessage());
 60         }
 61     }//End  init()
 62 
<span class="line-removed"> 63     @Override</span>
 64     public void start() {
<span class="line-removed"> 65         validate();</span>
<span class="line-removed"> 66 </span>
 67         try {
 68             setJLayeredPaneEDT();
 69             setTitleComponentEDT();
 70         } catch (Exception ex) {
 71             ex.printStackTrace();
 72             throw new RuntimeException(&quot;Test failed. &quot; + ex.getMessage());
 73         }
 74 
 75         if (!titleFound) {
 76             throw new RuntimeException(&quot;Test Failed. Unable to determine title&#39;s size.&quot;);
 77         }
 78 
 79         Random r = new Random();
 80 
 81         for (int iteration = 0; iteration &lt; 10; iteration++) {
 82             try {
 83                 setFramePosEDT();
 84             } catch (Exception ex) {
 85                 ex.printStackTrace();
 86                 throw new RuntimeException(&quot;Test failed.&quot;);
</pre>
<hr />
<pre>
132 
133             if (frameIsOutOfScreen) {
134                 throw new RuntimeException(&quot;Test failed. JFrame is out of screen.&quot;);
135             }
136 
137         } //for iteration
138         System.out.println(&quot;Test passed.&quot;);
139     }// start()
140 
141     private void createAndShowGUI() {
142         try {
143             UIManager.setLookAndFeel(
144                     &quot;javax.swing.plaf.metal.MetalLookAndFeel&quot;);
145         } catch (Exception ex) {
146             throw new RuntimeException(ex.getMessage());
147         }
148         JFrame.setDefaultLookAndFeelDecorated(true);
149         frame = new JFrame(&quot;JFrame Dance Test&quot;);
150         frame.pack();
151         frame.setSize(450, 260);

152         frame.setVisible(true);
153     }
154 
155     private void setJLayeredPaneEDT() throws Exception {
156 
157         SwingUtilities.invokeAndWait(new Runnable() {
158             @Override
159             public void run() {
160                 lPane = frame.getLayeredPane();
161                 System.out.println(&quot;JFrame&#39;s LayeredPane &quot; + lPane);
162             }
163         });
164     }
165 
166     private void setTitleComponentEDT() throws Exception {
167 
168         SwingUtilities.invokeAndWait(new Runnable() {
169             @Override
170             public void run() {
171                 for (int j = 0; j &lt; lPane.getComponentsInLayer(JLayeredPane.FRAME_CONTENT_LAYER.intValue()).length; j++) {
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2012, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 /*
<span class="line-modified"> 25   @test</span>
<span class="line-modified"> 26   @key headful</span>
<span class="line-modified"> 27   @bug 4962534</span>
<span class="line-modified"> 28   @summary JFrame dances very badly</span>
<span class="line-modified"> 29   @run main bug4962534</span>
 30  */
<span class="line-modified"> 31 </span>
 32 import java.awt.*;
 33 import java.awt.event.*;
 34 import java.util.Random;
 35 import javax.swing.*;
 36 
<span class="line-modified"> 37 public class bug4962534 {</span>
 38 
 39     Robot robot;
 40     volatile Point framePosition;
 41     volatile Point newFrameLocation;
<span class="line-modified"> 42     static JFrame frame;</span>
 43     Rectangle gcBounds;
 44     Component titleComponent;
 45     JLayeredPane lPane;
 46     volatile boolean titleFound = false;
 47     public static Object LOCK = new Object();
 48 
<span class="line-modified"> 49     public static void main(final String[] args) throws Exception {</span>
<span class="line-added"> 50         try {</span>
<span class="line-added"> 51             bug4962534 app = new bug4962534();</span>
<span class="line-added"> 52             app.init();</span>
<span class="line-added"> 53             app.start();</span>
<span class="line-added"> 54         } finally {</span>
<span class="line-added"> 55             if (frame != null) SwingUtilities.invokeAndWait(() -&gt; frame.dispose());</span>
<span class="line-added"> 56         }</span>
<span class="line-added"> 57     }</span>
<span class="line-added"> 58 </span>
 59     public void init() {
 60         try {
 61             SwingUtilities.invokeAndWait(new Runnable() {
 62                 @Override
 63                 public void run() {
 64                     createAndShowGUI();
 65                 }
 66             });
 67         } catch (Exception ex) {
 68             throw new RuntimeException(&quot;Init failed. &quot; + ex.getMessage());
 69         }
 70     }//End  init()
 71 

 72     public void start() {


 73         try {
 74             setJLayeredPaneEDT();
 75             setTitleComponentEDT();
 76         } catch (Exception ex) {
 77             ex.printStackTrace();
 78             throw new RuntimeException(&quot;Test failed. &quot; + ex.getMessage());
 79         }
 80 
 81         if (!titleFound) {
 82             throw new RuntimeException(&quot;Test Failed. Unable to determine title&#39;s size.&quot;);
 83         }
 84 
 85         Random r = new Random();
 86 
 87         for (int iteration = 0; iteration &lt; 10; iteration++) {
 88             try {
 89                 setFramePosEDT();
 90             } catch (Exception ex) {
 91                 ex.printStackTrace();
 92                 throw new RuntimeException(&quot;Test failed.&quot;);
</pre>
<hr />
<pre>
138 
139             if (frameIsOutOfScreen) {
140                 throw new RuntimeException(&quot;Test failed. JFrame is out of screen.&quot;);
141             }
142 
143         } //for iteration
144         System.out.println(&quot;Test passed.&quot;);
145     }// start()
146 
147     private void createAndShowGUI() {
148         try {
149             UIManager.setLookAndFeel(
150                     &quot;javax.swing.plaf.metal.MetalLookAndFeel&quot;);
151         } catch (Exception ex) {
152             throw new RuntimeException(ex.getMessage());
153         }
154         JFrame.setDefaultLookAndFeelDecorated(true);
155         frame = new JFrame(&quot;JFrame Dance Test&quot;);
156         frame.pack();
157         frame.setSize(450, 260);
<span class="line-added">158         frame.setLocationRelativeTo(null);</span>
159         frame.setVisible(true);
160     }
161 
162     private void setJLayeredPaneEDT() throws Exception {
163 
164         SwingUtilities.invokeAndWait(new Runnable() {
165             @Override
166             public void run() {
167                 lPane = frame.getLayeredPane();
168                 System.out.println(&quot;JFrame&#39;s LayeredPane &quot; + lPane);
169             }
170         });
171     }
172 
173     private void setTitleComponentEDT() throws Exception {
174 
175         SwingUtilities.invokeAndWait(new Runnable() {
176             @Override
177             public void run() {
178                 for (int j = 0; j &lt; lPane.getComponentsInLayer(JLayeredPane.FRAME_CONTENT_LAYER.intValue()).length; j++) {
</pre>
</td>
</tr>
</table>
<center><a href="../../JFileChooser/ShellFolderQueries/ShellFolderQueriesTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../8175301/ScaledFrameBackgroundTest.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>