<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/javax/swing/JComboBox/8057893/bug8057893.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../7195179/Test7195179.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../JComponent/4337267/bug4337267.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/javax/swing/JComboBox/8057893/bug8057893.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
26 import java.awt.Toolkit;
27 import java.awt.event.ActionEvent;
28 import java.awt.event.ActionListener;
29 import java.awt.event.KeyEvent;
30 import javax.swing.JComboBox;
31 import javax.swing.JFrame;
32 import javax.swing.WindowConstants;
33 
34 /**
35  * @test
36  * @key headful
37  * @bug 8057893
38  * @author Alexander Scherbatiy
39  * @summary JComboBox actionListener never receives &quot;comboBoxEdited&quot;
40  *   from getActionCommand
41  * @run main bug8057893
42  */
43 public class bug8057893 {
44 
45     private static volatile boolean isComboBoxEdited = false;

46 
47     public static void main(String[] args) throws Exception {
48         Robot robot = new Robot();
49         robot.setAutoDelay(50);
50 
51         EventQueue.invokeAndWait(() -&gt; {
<span class="line-modified">52             JFrame frame = new JFrame();</span>
53             frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
54             JComboBox&lt;String&gt; comboBox = new JComboBox&lt;&gt;(new String[]{&quot;one&quot;, &quot;two&quot;});
55             comboBox.setEditable(true);
56             comboBox.addActionListener(new ActionListener() {
57 
58                 @Override
59                 public void actionPerformed(ActionEvent e) {
60                     if (&quot;comboBoxEdited&quot;.equals(e.getActionCommand())) {
61                         isComboBoxEdited = true;
62                     }
63                 }
64             });
65             frame.add(comboBox);
66             frame.pack();
67             frame.setVisible(true);
68             comboBox.requestFocusInWindow();
69         });
70 
71         robot.waitForIdle();
72 
73         robot.keyPress(KeyEvent.VK_A);
74         robot.keyRelease(KeyEvent.VK_A);
75         robot.keyPress(KeyEvent.VK_ENTER);
76         robot.keyRelease(KeyEvent.VK_ENTER);
77         robot.waitForIdle();
78 

79         if(!isComboBoxEdited){
80             throw new RuntimeException(&quot;ComboBoxEdited event is not fired!&quot;);
81         }
82     }
83 }
</pre>
</td>
<td>
<hr />
<pre>
26 import java.awt.Toolkit;
27 import java.awt.event.ActionEvent;
28 import java.awt.event.ActionListener;
29 import java.awt.event.KeyEvent;
30 import javax.swing.JComboBox;
31 import javax.swing.JFrame;
32 import javax.swing.WindowConstants;
33 
34 /**
35  * @test
36  * @key headful
37  * @bug 8057893
38  * @author Alexander Scherbatiy
39  * @summary JComboBox actionListener never receives &quot;comboBoxEdited&quot;
40  *   from getActionCommand
41  * @run main bug8057893
42  */
43 public class bug8057893 {
44 
45     private static volatile boolean isComboBoxEdited = false;
<span class="line-added">46     private static JFrame frame;</span>
47 
48     public static void main(String[] args) throws Exception {
49         Robot robot = new Robot();
50         robot.setAutoDelay(50);
51 
52         EventQueue.invokeAndWait(() -&gt; {
<span class="line-modified">53             frame = new JFrame();</span>
54             frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
55             JComboBox&lt;String&gt; comboBox = new JComboBox&lt;&gt;(new String[]{&quot;one&quot;, &quot;two&quot;});
56             comboBox.setEditable(true);
57             comboBox.addActionListener(new ActionListener() {
58 
59                 @Override
60                 public void actionPerformed(ActionEvent e) {
61                     if (&quot;comboBoxEdited&quot;.equals(e.getActionCommand())) {
62                         isComboBoxEdited = true;
63                     }
64                 }
65             });
66             frame.add(comboBox);
67             frame.pack();
68             frame.setVisible(true);
69             comboBox.requestFocusInWindow();
70         });
71 
72         robot.waitForIdle();
73 
74         robot.keyPress(KeyEvent.VK_A);
75         robot.keyRelease(KeyEvent.VK_A);
76         robot.keyPress(KeyEvent.VK_ENTER);
77         robot.keyRelease(KeyEvent.VK_ENTER);
78         robot.waitForIdle();
79 
<span class="line-added">80         if (frame != null) EventQueue.invokeAndWait(() -&gt; frame.dispose());</span>
81         if(!isComboBoxEdited){
82             throw new RuntimeException(&quot;ComboBoxEdited event is not fired!&quot;);
83         }
84     }
85 }
</pre>
</td>
</tr>
</table>
<center><a href="../7195179/Test7195179.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../JComponent/4337267/bug4337267.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>