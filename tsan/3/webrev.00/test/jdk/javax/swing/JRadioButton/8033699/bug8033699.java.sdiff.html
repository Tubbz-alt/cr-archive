<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/javax/swing/JRadioButton/8033699/bug8033699.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../JPopupMenu/6987844/bug6987844.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../8041561/bug8041561.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/javax/swing/JRadioButton/8033699/bug8033699.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2014, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24  /*
 25  * @test
 26  * @key headful
 27  * @library ../../regtesthelpers
 28  * @build Util
<span class="line-modified"> 29  * @bug 8033699 8154043 8167160 8208640</span>
 30  * @summary  Incorrect radio button behavior when pressing tab key
 31  * @run main bug8033699
 32  */
 33 import java.awt.KeyboardFocusManager;
 34 import java.awt.Robot;

 35 import java.awt.event.KeyEvent;
 36 import java.util.logging.Level;
 37 import java.util.logging.Logger;
 38 import javax.swing.BorderFactory;
 39 import javax.swing.BoxLayout;
 40 import javax.swing.ButtonGroup;
 41 import javax.swing.JButton;
 42 import javax.swing.JFrame;
 43 import javax.swing.JPanel;
 44 import javax.swing.JRadioButton;
 45 import javax.swing.SwingUtilities;
 46 import javax.swing.UIManager;
 47 import javax.swing.UnsupportedLookAndFeelException;
 48 
 49 public class bug8033699 {
 50 
 51     private static JFrame mainFrame;
 52     private static Robot robot;
 53     private static JButton btnStart;
 54     private static JButton btnEnd;
</pre>
<hr />
<pre>
 76         runTest2();
 77 
 78         // shift tab key test grouped and non grouped radio button
 79         runTest3();
 80 
 81         // left/up key test in grouped radio button
 82         runTest4();
 83 
 84         // down/right key test in grouped radio button
 85         runTest5();
 86 
 87         // tab from radio button in group to next component in the middle of button group layout
 88         runTest6();
 89 
 90         // tab to radio button in group from component in the middle of button group layout
 91         runTest7();
 92 
 93         // down key circle back to first button in grouped radio button
 94         runTest8();
 95 



 96         SwingUtilities.invokeAndWait(() -&gt; mainFrame.dispose());
 97     }
 98 
 99     private static void changeLAF() {
100         String currentLAF = UIManager.getLookAndFeel().toString();
101         System.out.println(currentLAF);
102         currentLAF = currentLAF.toLowerCase();
103         if (currentLAF.contains(&quot;nimbus&quot;)) {
104             try {
105                 UIManager.setLookAndFeel(&quot;javax.swing.plaf.metal.MetalLookAndFeel&quot;);
106             } catch (Exception ex) {
107                 ex.printStackTrace();
108             }
109         }
110     }
111 
112     private static void createAndShowGUI() {
113         mainFrame = new JFrame(&quot;Bug 8033699 - 8 Tests for Grouped/Non Group Radio Buttons&quot;);
114         btnStart = new JButton(&quot;Start&quot;);
115         btnEnd = new JButton(&quot;End&quot;);
</pre>
<hr />
<pre>
228     private static void runTest7() throws Exception {
229         hitKey(robot, KeyEvent.VK_TAB);
230         SwingUtilities.invokeAndWait(() -&gt; {
231             if (KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusOwner() != btnMiddle) {
232                 System.out.println(&quot;Separate Component added in button group layout&quot;);
233                 throw new RuntimeException(&quot;Focus is not on Middle Button as Expected&quot;);
234             }
235         });
236     }
237 
238     private static void runTest8() throws Exception {
239         hitKey(robot, KeyEvent.VK_TAB);
240         SwingUtilities.invokeAndWait(() -&gt; {
241             if (KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusOwner() != radioBtnSingle) {
242                 System.out.println(&quot;Separate Component added in button group layout&quot;);
243                 throw new RuntimeException(&quot;Focus is not on Radio Button Single as Expected&quot;);
244             }
245         });
246     }
247 







































248     private static void hitKey(Robot robot, int keycode) {
249         robot.keyPress(keycode);
250         robot.keyRelease(keycode);
251         robot.waitForIdle();
252     }
253 
254     private static void hitKey(Robot robot, int mode, int keycode) {
255         robot.keyPress(mode);
256         robot.keyPress(keycode);
257         robot.keyRelease(mode);
258         robot.keyRelease(keycode);
259         robot.waitForIdle();
260     }
261 }
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2014, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24  /*
 25  * @test
 26  * @key headful
 27  * @library ../../regtesthelpers
 28  * @build Util
<span class="line-modified"> 29  * @bug 8033699 8154043 8167160 8208640 8226892</span>
 30  * @summary  Incorrect radio button behavior when pressing tab key
 31  * @run main bug8033699
 32  */
 33 import java.awt.KeyboardFocusManager;
 34 import java.awt.Robot;
<span class="line-added"> 35 import java.awt.event.ActionListener;</span>
 36 import java.awt.event.KeyEvent;
 37 import java.util.logging.Level;
 38 import java.util.logging.Logger;
 39 import javax.swing.BorderFactory;
 40 import javax.swing.BoxLayout;
 41 import javax.swing.ButtonGroup;
 42 import javax.swing.JButton;
 43 import javax.swing.JFrame;
 44 import javax.swing.JPanel;
 45 import javax.swing.JRadioButton;
 46 import javax.swing.SwingUtilities;
 47 import javax.swing.UIManager;
 48 import javax.swing.UnsupportedLookAndFeelException;
 49 
 50 public class bug8033699 {
 51 
 52     private static JFrame mainFrame;
 53     private static Robot robot;
 54     private static JButton btnStart;
 55     private static JButton btnEnd;
</pre>
<hr />
<pre>
 77         runTest2();
 78 
 79         // shift tab key test grouped and non grouped radio button
 80         runTest3();
 81 
 82         // left/up key test in grouped radio button
 83         runTest4();
 84 
 85         // down/right key test in grouped radio button
 86         runTest5();
 87 
 88         // tab from radio button in group to next component in the middle of button group layout
 89         runTest6();
 90 
 91         // tab to radio button in group from component in the middle of button group layout
 92         runTest7();
 93 
 94         // down key circle back to first button in grouped radio button
 95         runTest8();
 96 
<span class="line-added"> 97         // Verify that ActionListener is called when a RadioButton is selected using arrow key.</span>
<span class="line-added"> 98         runTest9();</span>
<span class="line-added"> 99 </span>
100         SwingUtilities.invokeAndWait(() -&gt; mainFrame.dispose());
101     }
102 
103     private static void changeLAF() {
104         String currentLAF = UIManager.getLookAndFeel().toString();
105         System.out.println(currentLAF);
106         currentLAF = currentLAF.toLowerCase();
107         if (currentLAF.contains(&quot;nimbus&quot;)) {
108             try {
109                 UIManager.setLookAndFeel(&quot;javax.swing.plaf.metal.MetalLookAndFeel&quot;);
110             } catch (Exception ex) {
111                 ex.printStackTrace();
112             }
113         }
114     }
115 
116     private static void createAndShowGUI() {
117         mainFrame = new JFrame(&quot;Bug 8033699 - 8 Tests for Grouped/Non Group Radio Buttons&quot;);
118         btnStart = new JButton(&quot;Start&quot;);
119         btnEnd = new JButton(&quot;End&quot;);
</pre>
<hr />
<pre>
232     private static void runTest7() throws Exception {
233         hitKey(robot, KeyEvent.VK_TAB);
234         SwingUtilities.invokeAndWait(() -&gt; {
235             if (KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusOwner() != btnMiddle) {
236                 System.out.println(&quot;Separate Component added in button group layout&quot;);
237                 throw new RuntimeException(&quot;Focus is not on Middle Button as Expected&quot;);
238             }
239         });
240     }
241 
242     private static void runTest8() throws Exception {
243         hitKey(robot, KeyEvent.VK_TAB);
244         SwingUtilities.invokeAndWait(() -&gt; {
245             if (KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusOwner() != radioBtnSingle) {
246                 System.out.println(&quot;Separate Component added in button group layout&quot;);
247                 throw new RuntimeException(&quot;Focus is not on Radio Button Single as Expected&quot;);
248             }
249         });
250     }
251 
<span class="line-added">252     private static Boolean actRB1 = false;</span>
<span class="line-added">253     private static Boolean actRB2 = false;</span>
<span class="line-added">254     private static Boolean actRB3 = false;</span>
<span class="line-added">255 </span>
<span class="line-added">256     // JDK-8226892: Verify that ActionListener is called when a RadioButton is selected using arrow key.</span>
<span class="line-added">257     private static void runTest9() throws Exception {</span>
<span class="line-added">258         SwingUtilities.invokeAndWait(() -&gt; {</span>
<span class="line-added">259             radioBtn1.setSelected(true);</span>
<span class="line-added">260             radioBtn1.requestFocusInWindow();</span>
<span class="line-added">261         });</span>
<span class="line-added">262 </span>
<span class="line-added">263         ActionListener actLrRB1 = e -&gt; actRB1 = true;</span>
<span class="line-added">264         ActionListener actLrRB2 = e -&gt; actRB2 = true;</span>
<span class="line-added">265         ActionListener actLrRB3 = e -&gt; actRB3 = true;</span>
<span class="line-added">266 </span>
<span class="line-added">267         radioBtn1.addActionListener(actLrRB1);</span>
<span class="line-added">268         radioBtn2.addActionListener(actLrRB2);</span>
<span class="line-added">269         radioBtn3.addActionListener(actLrRB3);</span>
<span class="line-added">270 </span>
<span class="line-added">271         hitKey(robot, KeyEvent.VK_DOWN);</span>
<span class="line-added">272         hitKey(robot, KeyEvent.VK_DOWN);</span>
<span class="line-added">273         hitKey(robot, KeyEvent.VK_DOWN);</span>
<span class="line-added">274 </span>
<span class="line-added">275         String failMessage = &quot;ActionListener not invoked when selected using arrow key.&quot;;</span>
<span class="line-added">276         if (!actRB2) {</span>
<span class="line-added">277             throw new RuntimeException(&quot;RadioButton 2: &quot; + failMessage);</span>
<span class="line-added">278         }</span>
<span class="line-added">279         if (!actRB3) {</span>
<span class="line-added">280             throw new RuntimeException(&quot;RadioButton 3: &quot; + failMessage);</span>
<span class="line-added">281         }</span>
<span class="line-added">282         if (!actRB1) {</span>
<span class="line-added">283             throw new RuntimeException(&quot;RadioButton 1: &quot; + failMessage);</span>
<span class="line-added">284         }</span>
<span class="line-added">285 </span>
<span class="line-added">286         radioBtn1.removeActionListener(actLrRB1);</span>
<span class="line-added">287         radioBtn2.removeActionListener(actLrRB2);</span>
<span class="line-added">288         radioBtn3.removeActionListener(actLrRB3);</span>
<span class="line-added">289     }</span>
<span class="line-added">290 </span>
291     private static void hitKey(Robot robot, int keycode) {
292         robot.keyPress(keycode);
293         robot.keyRelease(keycode);
294         robot.waitForIdle();
295     }
296 
297     private static void hitKey(Robot robot, int mode, int keycode) {
298         robot.keyPress(mode);
299         robot.keyPress(keycode);
300         robot.keyRelease(mode);
301         robot.keyRelease(keycode);
302         robot.waitForIdle();
303     }
304 }
</pre>
</td>
</tr>
</table>
<center><a href="../../JPopupMenu/6987844/bug6987844.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../8041561/bug8041561.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>