<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/javax/swing/JScrollBar/bug4202954/bug4202954.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../6542335/bug6542335.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../JSpinner/4973721/bug4973721.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/javax/swing/JScrollBar/bug4202954/bug4202954.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 23 /*
 24    @test
 25    @key headful
 26    @bug 4202954
 27    @library /test/lib
 28    @library ../../regtesthelpers
 29    @build Util jdk.test.lib.Platform
 30    @author Michael C. Albers
 31    @run main bug4202954
 32  */
 33 
 34 import java.awt.*;
 35 import java.awt.event.InputEvent;
 36 import javax.swing.*;
 37 
 38 import jdk.test.lib.Platform;
 39 
 40 public class bug4202954 {
 41     static JScrollPane buttonScrollPane;
 42     static Robot robot;

 43     public static void main(String[] args) throws Exception {
<span class="line-modified"> 44         if (Platform.isOSX()) {</span>
<span class="line-modified"> 45             UIManager.setLookAndFeel(UIManager.getCrossPlatformLookAndFeelClassName());</span>
<span class="line-modified"> 46         }</span>
<span class="line-removed"> 47 </span>
<span class="line-removed"> 48         SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="line-removed"> 49             public void run() {</span>
<span class="line-removed"> 50                 createAndShowGUI();</span>
 51             }
<span class="line-removed"> 52         });</span>
<span class="line-removed"> 53         Point centerOfScrollPane = Util.getCenterPoint(buttonScrollPane);</span>
<span class="line-removed"> 54         JButton rightScrollButton = findJButton(buttonScrollPane.getHorizontalScrollBar(), centerOfScrollPane.x, centerOfScrollPane.y);</span>
<span class="line-removed"> 55         JButton bottomScrollButton = findJButton(buttonScrollPane.getVerticalScrollBar(), centerOfScrollPane.x, centerOfScrollPane.y);</span>
 56 
<span class="line-modified"> 57         if (rightScrollButton == null || bottomScrollButton == null) {</span>
<span class="line-modified"> 58             String errMessage = &quot;Test can&#39;t be executed: &quot;;</span>
<span class="line-modified"> 59             errMessage = errMessage + (rightScrollButton == null ? &quot;can&#39;t find right button for horizontal scroll bar; &quot; : &quot;&quot;</span>









 60                     + (bottomScrollButton == null ? &quot;can&#39;t find bottom scroll button for vertical scroll bar&quot; : &quot;&quot;));
<span class="line-modified"> 61             throw new RuntimeException(errMessage);</span>
<span class="line-modified"> 62         }</span>
 63 
<span class="line-modified"> 64         robot = new Robot();</span>
<span class="line-modified"> 65         robot.setAutoDelay(50);</span>
 66 
<span class="line-modified"> 67         // test right, left and middle mouse buttons for horizontal scroll bar</span>
<span class="line-modified"> 68         if (!doTest(rightScrollButton, InputEvent.BUTTON1_DOWN_MASK, true)) {</span>
<span class="line-modified"> 69             throw new RuntimeException(&quot;Test failed: right arrow button didn&#39;t respond on left mouse button.&quot;);</span>
<span class="line-modified"> 70         }</span>
<span class="line-modified"> 71         if (!doTest(rightScrollButton, InputEvent.BUTTON2_DOWN_MASK, false)) {</span>
<span class="line-modified"> 72             throw new RuntimeException(&quot;Test failed: right arrow button respond on right mouse button.&quot;);</span>
<span class="line-modified"> 73         }</span>
<span class="line-modified"> 74         if (!doTest(rightScrollButton, InputEvent.BUTTON3_DOWN_MASK, false)) {</span>
<span class="line-modified"> 75             throw new RuntimeException(&quot;Test failed: right arrow button respond on middle mouse button.&quot;);</span>
<span class="line-modified"> 76         }</span>
 77 
<span class="line-modified"> 78         // test right, left and middle mouse buttons for vertical scroll bar</span>
<span class="line-modified"> 79         if (!doTest(bottomScrollButton, InputEvent.BUTTON1_DOWN_MASK, true)) {</span>
<span class="line-modified"> 80             throw new RuntimeException(&quot;Test failed: bottom arrow button didn&#39;t respond on left mouse button.&quot;);</span>
<span class="line-modified"> 81         }</span>
<span class="line-modified"> 82         if (!doTest(bottomScrollButton, InputEvent.BUTTON2_DOWN_MASK, false)) {</span>
<span class="line-modified"> 83             throw new RuntimeException(&quot;Test failed: bottom arrow button respond on right mouse button.&quot;);</span>
<span class="line-modified"> 84         }</span>
<span class="line-modified"> 85         if (!doTest(bottomScrollButton, InputEvent.BUTTON3_DOWN_MASK, false)) {</span>
<span class="line-modified"> 86             throw new RuntimeException(&quot;Test failed: bottom arrow button respond on middle mouse button.&quot;);</span>



 87         }
 88     }
 89     public static void createAndShowGUI() {
 90         JPanel buttonPanel = new JPanel();
 91         buttonPanel.setLayout(new GridLayout(5,5, 15,15));
 92         int buttonCount = 1;
 93         while (buttonCount &lt;= 25) {
 94             buttonPanel.add(new JButton(&quot;Button #&quot;+buttonCount));
 95             buttonCount++;
 96         }
 97         buttonScrollPane = new JScrollPane();
 98         buttonScrollPane.setViewportView(buttonPanel);
 99 
<span class="line-modified">100         JFrame testFrame = new JFrame(&quot;bug4202954&quot;);</span>
101         testFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
102         testFrame.setLayout(new BorderLayout());
103         testFrame.add(BorderLayout.CENTER, buttonScrollPane);
104         testFrame.setSize(450, 100);
105         testFrame.setVisible(true);
106     }
107     public static JButton findJButton(final JScrollBar scrollBar, final int minX, final int minY) throws Exception {
108         JButton button = Util.invokeOnEDT(new java.util.concurrent.Callable&lt;JButton&gt;() {
109             @Override
110             public JButton call() throws Exception {
111                 int currentXorY = 0;
112                 JButton scrollButton = null;
113                  for (Component c: scrollBar.getComponents()) {
114                      if (c instanceof JButton) {
115                          Point p = c.getLocationOnScreen();
116                          if (scrollBar.getOrientation() == Adjustable.VERTICAL){
117                              if (currentXorY &lt;= p.y){
118                                  currentXorY = p.y;
119                                  scrollButton = (JButton)c;
120                              }
</pre>
</td>
<td>
<hr />
<pre>
 23 /*
 24    @test
 25    @key headful
 26    @bug 4202954
 27    @library /test/lib
 28    @library ../../regtesthelpers
 29    @build Util jdk.test.lib.Platform
 30    @author Michael C. Albers
 31    @run main bug4202954
 32  */
 33 
 34 import java.awt.*;
 35 import java.awt.event.InputEvent;
 36 import javax.swing.*;
 37 
 38 import jdk.test.lib.Platform;
 39 
 40 public class bug4202954 {
 41     static JScrollPane buttonScrollPane;
 42     static Robot robot;
<span class="line-added"> 43     static JFrame testFrame;</span>
 44     public static void main(String[] args) throws Exception {
<span class="line-modified"> 45         try {</span>
<span class="line-modified"> 46             if (Platform.isOSX()) {</span>
<span class="line-modified"> 47                 UIManager.setLookAndFeel(UIManager.getCrossPlatformLookAndFeelClassName());</span>




 48             }




 49 
<span class="line-modified"> 50             SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="line-modified"> 51                 public void run() {</span>
<span class="line-modified"> 52                     createAndShowGUI();</span>
<span class="line-added"> 53                 }</span>
<span class="line-added"> 54             });</span>
<span class="line-added"> 55             Point centerOfScrollPane = Util.getCenterPoint(buttonScrollPane);</span>
<span class="line-added"> 56             JButton rightScrollButton = findJButton(buttonScrollPane.getHorizontalScrollBar(), centerOfScrollPane.x, centerOfScrollPane.y);</span>
<span class="line-added"> 57             JButton bottomScrollButton = findJButton(buttonScrollPane.getVerticalScrollBar(), centerOfScrollPane.x, centerOfScrollPane.y);</span>
<span class="line-added"> 58 </span>
<span class="line-added"> 59             if (rightScrollButton == null || bottomScrollButton == null) {</span>
<span class="line-added"> 60                 String errMessage = &quot;Test can&#39;t be executed: &quot;;</span>
<span class="line-added"> 61                 errMessage = errMessage + (rightScrollButton == null ? &quot;can&#39;t find right button for horizontal scroll bar; &quot; : &quot;&quot;</span>
 62                     + (bottomScrollButton == null ? &quot;can&#39;t find bottom scroll button for vertical scroll bar&quot; : &quot;&quot;));
<span class="line-modified"> 63                 throw new RuntimeException(errMessage);</span>
<span class="line-modified"> 64             }</span>
 65 
<span class="line-modified"> 66             robot = new Robot();</span>
<span class="line-modified"> 67             robot.setAutoDelay(50);</span>
 68 
<span class="line-modified"> 69             // test right, left and middle mouse buttons for horizontal scroll bar</span>
<span class="line-modified"> 70             if (!doTest(rightScrollButton, InputEvent.BUTTON1_DOWN_MASK, true)) {</span>
<span class="line-modified"> 71                 throw new RuntimeException(&quot;Test failed: right arrow button didn&#39;t respond on left mouse button.&quot;);</span>
<span class="line-modified"> 72             }</span>
<span class="line-modified"> 73             if (!doTest(rightScrollButton, InputEvent.BUTTON2_DOWN_MASK, false)) {</span>
<span class="line-modified"> 74                 throw new RuntimeException(&quot;Test failed: right arrow button respond on right mouse button.&quot;);</span>
<span class="line-modified"> 75             }</span>
<span class="line-modified"> 76             if (!doTest(rightScrollButton, InputEvent.BUTTON3_DOWN_MASK, false)) {</span>
<span class="line-modified"> 77                 throw new RuntimeException(&quot;Test failed: right arrow button respond on middle mouse button.&quot;);</span>
<span class="line-modified"> 78             }</span>
 79 
<span class="line-modified"> 80             // test right, left and middle mouse buttons for vertical scroll bar</span>
<span class="line-modified"> 81             if (!doTest(bottomScrollButton, InputEvent.BUTTON1_DOWN_MASK, true)) {</span>
<span class="line-modified"> 82                 throw new RuntimeException(&quot;Test failed: bottom arrow button didn&#39;t respond on left mouse button.&quot;);</span>
<span class="line-modified"> 83             }</span>
<span class="line-modified"> 84             if (!doTest(bottomScrollButton, InputEvent.BUTTON2_DOWN_MASK, false)) {</span>
<span class="line-modified"> 85                 throw new RuntimeException(&quot;Test failed: bottom arrow button respond on right mouse button.&quot;);</span>
<span class="line-modified"> 86             }</span>
<span class="line-modified"> 87             if (!doTest(bottomScrollButton, InputEvent.BUTTON3_DOWN_MASK, false)) {</span>
<span class="line-modified"> 88                 throw new RuntimeException(&quot;Test failed: bottom arrow button respond on middle mouse button.&quot;);</span>
<span class="line-added"> 89             }</span>
<span class="line-added"> 90         } finally {</span>
<span class="line-added"> 91                 if (testFrame != null) SwingUtilities.invokeAndWait(() -&gt; testFrame.dispose());</span>
 92         }
 93     }
 94     public static void createAndShowGUI() {
 95         JPanel buttonPanel = new JPanel();
 96         buttonPanel.setLayout(new GridLayout(5,5, 15,15));
 97         int buttonCount = 1;
 98         while (buttonCount &lt;= 25) {
 99             buttonPanel.add(new JButton(&quot;Button #&quot;+buttonCount));
100             buttonCount++;
101         }
102         buttonScrollPane = new JScrollPane();
103         buttonScrollPane.setViewportView(buttonPanel);
104 
<span class="line-modified">105         testFrame = new JFrame(&quot;bug4202954&quot;);</span>
106         testFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
107         testFrame.setLayout(new BorderLayout());
108         testFrame.add(BorderLayout.CENTER, buttonScrollPane);
109         testFrame.setSize(450, 100);
110         testFrame.setVisible(true);
111     }
112     public static JButton findJButton(final JScrollBar scrollBar, final int minX, final int minY) throws Exception {
113         JButton button = Util.invokeOnEDT(new java.util.concurrent.Callable&lt;JButton&gt;() {
114             @Override
115             public JButton call() throws Exception {
116                 int currentXorY = 0;
117                 JButton scrollButton = null;
118                  for (Component c: scrollBar.getComponents()) {
119                      if (c instanceof JButton) {
120                          Point p = c.getLocationOnScreen();
121                          if (scrollBar.getOrientation() == Adjustable.VERTICAL){
122                              if (currentXorY &lt;= p.y){
123                                  currentXorY = p.y;
124                                  scrollButton = (JButton)c;
125                              }
</pre>
</td>
</tr>
</table>
<center><a href="../6542335/bug6542335.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../JSpinner/4973721/bug4973721.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>