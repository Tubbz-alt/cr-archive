<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/javax/swing/JMenuItem/4171437/bug4171437.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../JMenuBar/4750590/bug4750590.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../4654927/bug4654927.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/javax/swing/JMenuItem/4171437/bug4171437.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 23 
 24 /*
 25  * @test
 26  * @key headful
 27  * @bug 4171437
 28  * @library ../../regtesthelpers
 29  * @build Util
 30  * @author Georges Saab
 31  * @run main bug4171437
 32  */
 33 
 34 import java.awt.*;
 35 import java.awt.event.*;
 36 import java.util.ArrayList;
 37 import javax.swing.*;
 38 import javax.swing.event.*;
 39 
 40 public class bug4171437 {
 41     static volatile boolean closeActivated = false;
 42     static volatile boolean customActivated = false;

 43 
 44     public static void main(String[] args) throws Exception {
<span class="line-modified"> 45         SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="line-modified"> 46             public void run() {</span>
<span class="line-modified"> 47                 createAndShowGUI();</span>
<span class="line-modified"> 48             }</span>
<span class="line-modified"> 49         });</span>

 50 
<span class="line-modified"> 51         Robot robot = new Robot();</span>
<span class="line-modified"> 52         robot.setAutoDelay(50);</span>
<span class="line-modified"> 53         robot.waitForIdle();</span>
 54 
<span class="line-modified"> 55         Util.hitMnemonics(robot, KeyEvent.VK_F);</span>
<span class="line-modified"> 56         Util.hitKeys(robot, KeyEvent.VK_C);</span>
 57 
<span class="line-modified"> 58         robot.waitForIdle();</span>
<span class="line-modified"> 59         Thread.sleep(1000);</span>
 60 
<span class="line-modified"> 61         if (!closeActivated || customActivated) {</span>
<span class="line-modified"> 62             throw new RuntimeException(&quot;Didn&#39;t pass the muster&quot;);</span>



 63         }
 64     }
 65     public static void createAndShowGUI() {
 66         JMenuBar menubar = new JMenuBar();
 67 
 68         JMenu fileMenu = new JMenu(&quot;File&quot;);
 69         fileMenu.setMnemonic(&#39;f&#39;);
 70 
 71         JMenuItem fmi1 = new JMenuItem();
 72         fmi1 = new JMenuItem(&quot;Open&quot;);
 73         JMenuItem fmi2 = new JMenuItem();
 74         fmi2 = new JMenuItem(&quot;Close&quot;);
 75         fmi2.setMnemonic(&#39;c&#39;);
 76         fmi2.addActionListener(new ActionListener() {
 77             public void actionPerformed(ActionEvent e) {
 78                 closeActivated = true;
 79             }
 80         });
 81 
 82         fileMenu.add( fmi1);
 83         fileMenu.add( fmi2);
 84 
 85         menubar.add( fileMenu);
 86 
 87         JMenu custom = new JMenu(&quot;Custom&quot;);
 88         custom.setMnemonic(&#39;c&#39;);
 89         JMenuItem cmi = new JMenuItem();
 90         cmi = new JMenuItem(&quot;Properties&quot;);
 91         cmi.setMnemonic(&#39;p&#39;);
 92         custom.add( cmi);
 93         custom.addMenuListener(new MenuListener() {
 94             public void menuSelected(MenuEvent e) {
 95                 customActivated = true;
 96             }
 97             public void menuDeselected(MenuEvent e) {}
 98             public void menuCanceled(MenuEvent e) {}
 99         });
100         menubar.add( custom);
101 
<span class="line-modified">102         JFrame frame = new JFrame();</span>
103         frame.setJMenuBar( menubar);
104         frame.setSize(300, 300);
105         frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
106         frame.pack();
107         frame.setVisible(true);
108     }
109 }
</pre>
</td>
<td>
<hr />
<pre>
 23 
 24 /*
 25  * @test
 26  * @key headful
 27  * @bug 4171437
 28  * @library ../../regtesthelpers
 29  * @build Util
 30  * @author Georges Saab
 31  * @run main bug4171437
 32  */
 33 
 34 import java.awt.*;
 35 import java.awt.event.*;
 36 import java.util.ArrayList;
 37 import javax.swing.*;
 38 import javax.swing.event.*;
 39 
 40 public class bug4171437 {
 41     static volatile boolean closeActivated = false;
 42     static volatile boolean customActivated = false;
<span class="line-added"> 43     static JFrame frame;</span>
 44 
 45     public static void main(String[] args) throws Exception {
<span class="line-modified"> 46         try {</span>
<span class="line-modified"> 47             SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="line-modified"> 48                 public void run() {</span>
<span class="line-modified"> 49                     createAndShowGUI();</span>
<span class="line-modified"> 50                 }</span>
<span class="line-added"> 51             });</span>
 52 
<span class="line-modified"> 53             Robot robot = new Robot();</span>
<span class="line-modified"> 54             robot.setAutoDelay(50);</span>
<span class="line-modified"> 55             robot.waitForIdle();</span>
 56 
<span class="line-modified"> 57             Util.hitMnemonics(robot, KeyEvent.VK_F);</span>
<span class="line-modified"> 58             Util.hitKeys(robot, KeyEvent.VK_C);</span>
 59 
<span class="line-modified"> 60             robot.waitForIdle();</span>
<span class="line-modified"> 61             Thread.sleep(1000);</span>
 62 
<span class="line-modified"> 63             if (!closeActivated || customActivated) {</span>
<span class="line-modified"> 64                 throw new RuntimeException(&quot;Didn&#39;t pass the muster&quot;);</span>
<span class="line-added"> 65             }</span>
<span class="line-added"> 66         } finally {</span>
<span class="line-added"> 67             if (frame != null) SwingUtilities.invokeAndWait(() -&gt; frame.dispose());</span>
 68         }
 69     }
 70     public static void createAndShowGUI() {
 71         JMenuBar menubar = new JMenuBar();
 72 
 73         JMenu fileMenu = new JMenu(&quot;File&quot;);
 74         fileMenu.setMnemonic(&#39;f&#39;);
 75 
 76         JMenuItem fmi1 = new JMenuItem();
 77         fmi1 = new JMenuItem(&quot;Open&quot;);
 78         JMenuItem fmi2 = new JMenuItem();
 79         fmi2 = new JMenuItem(&quot;Close&quot;);
 80         fmi2.setMnemonic(&#39;c&#39;);
 81         fmi2.addActionListener(new ActionListener() {
 82             public void actionPerformed(ActionEvent e) {
 83                 closeActivated = true;
 84             }
 85         });
 86 
 87         fileMenu.add( fmi1);
 88         fileMenu.add( fmi2);
 89 
 90         menubar.add( fileMenu);
 91 
 92         JMenu custom = new JMenu(&quot;Custom&quot;);
 93         custom.setMnemonic(&#39;c&#39;);
 94         JMenuItem cmi = new JMenuItem();
 95         cmi = new JMenuItem(&quot;Properties&quot;);
 96         cmi.setMnemonic(&#39;p&#39;);
 97         custom.add( cmi);
 98         custom.addMenuListener(new MenuListener() {
 99             public void menuSelected(MenuEvent e) {
100                 customActivated = true;
101             }
102             public void menuDeselected(MenuEvent e) {}
103             public void menuCanceled(MenuEvent e) {}
104         });
105         menubar.add( custom);
106 
<span class="line-modified">107         frame = new JFrame();</span>
108         frame.setJMenuBar( menubar);
109         frame.setSize(300, 300);
110         frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
111         frame.pack();
112         frame.setVisible(true);
113     }
114 }
</pre>
</td>
</tr>
</table>
<center><a href="../../JMenuBar/4750590/bug4750590.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../4654927/bug4654927.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>