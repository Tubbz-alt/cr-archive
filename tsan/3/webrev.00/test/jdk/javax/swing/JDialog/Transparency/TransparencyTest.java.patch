diff a/test/jdk/javax/swing/JDialog/Transparency/TransparencyTest.java b/test/jdk/javax/swing/JDialog/Transparency/TransparencyTest.java
--- a/test/jdk/javax/swing/JDialog/Transparency/TransparencyTest.java
+++ b/test/jdk/javax/swing/JDialog/Transparency/TransparencyTest.java
@@ -57,10 +57,11 @@
         dialog.setUndecorated(true);
         dialog.setLocation(400, 300);
         dlgPos = dialog.getLocation();
         backgroundDialog = new JDialog(frame, false);
         backgroundDialog.setSize(250, 250);
+        backgroundDialog.setUndecorated(true);
         backgroundDialog.getContentPane().setBackground(Color.red);
         backgroundDialog.setLocation(dlgPos.x, dlgPos.y);
 
         frame.setVisible(true);
         backgroundDialog.setVisible(true);
@@ -73,11 +74,11 @@
         GraphicsDevice gd = ge.getDefaultScreenDevice();
         GraphicsDevice.WindowTranslucency mode = GraphicsDevice.WindowTranslucency.TRANSLUCENT;
         boolean translucencyCheck = gd.isWindowTranslucencySupported(mode);
         if(!translucencyCheck) {
             return;
-    }
+        }
 
         Robot robot = new Robot();
         // create a GUI
         SwingUtilities.invokeAndWait(new Runnable() {
 
@@ -85,43 +86,50 @@
             public void run() {
                 createAndShowGUI();
             }
         });
         robot.waitForIdle();
-        Color opaque = robot.getPixelColor(dlgPos.x + 100, dlgPos.y + 100);
+        robot.delay(200);
+
+        int x = dlgPos.x + 100;
+        int y = dlgPos.y + 100;
+        Color opaque = robot.getPixelColor(x, y);
 
         // set Dialog Opacity
         SwingUtilities.invokeAndWait(new Runnable() {
 
             @Override
             public void run() {
                 dialog.setOpacity(OPACITY);
             }
         });
         robot.waitForIdle();
+        robot.delay(200);
 
         // iconify frame
         SwingUtilities.invokeAndWait(new Runnable() {
 
             @Override
             public void run() {
                 frame.setExtendedState(JFrame.ICONIFIED);
             }
         });
         robot.waitForIdle();
+        robot.delay(500);
 
         // deiconify frame
         SwingUtilities.invokeAndWait(new Runnable() {
 
             @Override
             public void run() {
                 frame.setExtendedState(JFrame.NORMAL);
             }
         });
         robot.waitForIdle();
+        robot.delay(500);
 
-        Color transparent = robot.getPixelColor(dlgPos.x + 100, dlgPos.y + 100);
+        Color transparent = robot.getPixelColor(x, y);
         if (transparent.equals(opaque)) {
             frame.dispose();
             throw new RuntimeException("JDialog transparency lost "
                     + "upon iconify/deiconify sequence");
         }
