<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/jdk/javax/swing/JComponent/7154030/bug7154030.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../6989617/bug6989617.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../JDialog/Transparency/TransparencyTest.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/javax/swing/JComponent/7154030/bug7154030.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 54,117 ***</span>
   */
  
  public class bug7154030 {
  
      private static JButton button = null;
  
      public static void main(String[] args) throws Exception {
<span class="line-modified">!         BufferedImage imageInit = null;</span>
<span class="line-modified">! </span>
<span class="line-modified">!         BufferedImage imageShow = null;</span>
<span class="line-modified">! </span>
<span class="line-modified">!         BufferedImage imageHide = null;</span>
<span class="line-modified">! </span>
<span class="line-modified">!         ExtendedRobot robot = new ExtendedRobot();</span>
<span class="line-modified">! </span>
<span class="line-modified">!         SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="line-modified">! </span>
<span class="line-modified">!             @Override</span>
<span class="line-modified">!             public void run() {</span>
<span class="line-modified">!                 JDesktopPane desktop = new JDesktopPane();</span>
<span class="line-modified">!                 button = new JButton(&quot;button&quot;);</span>
<span class="line-modified">!                 JFrame frame = new JFrame();</span>
<span class="line-modified">! </span>
<span class="line-modified">!                 button.setSize(200, 200);</span>
<span class="line-modified">!                 button.setLocation(100, 100);</span>
<span class="line-modified">!                 button.setForeground(Color.RED);</span>
<span class="line-modified">!                 button.setBackground(Color.RED);</span>
<span class="line-modified">!                 button.setOpaque(true);</span>
<span class="line-modified">!                 button.setVisible(false);</span>
<span class="line-modified">!                 desktop.add(button);</span>
<span class="line-modified">! </span>
<span class="line-modified">!                 frame.setContentPane(desktop);</span>
<span class="line-modified">!                 frame.setSize(300, 300);</span>
<span class="line-modified">!                 frame.setLocation(0, 0);</span>
<span class="line-modified">!                 frame.setVisible(true);</span>
<span class="line-modified">!                 frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</span>
              }
<span class="line-removed">-         });</span>
  
<span class="line-modified">!         robot.waitForIdle(500);</span>
<span class="line-removed">-         imageInit = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
  
<span class="line-modified">!         SwingUtilities.invokeAndWait(new Runnable() {</span>
  
<span class="line-modified">!             @Override</span>
<span class="line-modified">!             public void run() {</span>
<span class="line-removed">-                 button.show();</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-         });</span>
<span class="line-removed">- </span>
<span class="line-removed">-         robot.waitForIdle(500);</span>
<span class="line-removed">-         imageShow = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
<span class="line-removed">-         if (Util.compareBufferedImages(imageInit, imageShow)) {</span>
<span class="line-removed">-             throw new Exception(&quot;Failed to show opaque button&quot;);</span>
<span class="line-removed">-         }</span>
  
<span class="line-modified">!         robot.waitForIdle();</span>
<span class="line-modified">! </span>
<span class="line-removed">-         SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="line-removed">- </span>
<span class="line-removed">-             @Override</span>
<span class="line-removed">-             public void run() {</span>
<span class="line-removed">-                 button.hide();</span>
              }
<span class="line-removed">-         });</span>
  
<span class="line-modified">!         robot.waitForIdle(500);</span>
<span class="line-removed">-         imageHide = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
  
<span class="line-modified">!         if (!Util.compareBufferedImages(imageInit, imageHide)) {</span>
<span class="line-modified">!             throw new Exception(&quot;Failed to hide opaque button&quot;);</span>
<span class="line-modified">!         }</span>
  
<span class="line-modified">!         SwingUtilities.invokeAndWait(new Runnable() {</span>
  
<span class="line-modified">!             @Override</span>
<span class="line-removed">-             public void run() {</span>
<span class="line-removed">-                 button.setOpaque(false);</span>
<span class="line-removed">-                 button.setBackground(new Color(128, 128, 0));</span>
<span class="line-removed">-                 button.setVisible(false);</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-         });</span>
  
<span class="line-modified">!         robot.waitForIdle(500);</span>
<span class="line-modified">!         imageInit = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
  
<span class="line-modified">!         SwingUtilities.invokeAndWait(new Runnable() {</span>
  
<span class="line-modified">!             @Override</span>
<span class="line-removed">-             public void run() {</span>
<span class="line-removed">-                 button.show();</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-         });</span>
  
<span class="line-modified">!         robot.waitForIdle(500);</span>
<span class="line-modified">!         imageShow = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
  
<span class="line-modified">!         SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="line-modified">! </span>
<span class="line-removed">-             @Override</span>
<span class="line-removed">-             public void run() {</span>
<span class="line-removed">-                 button.hide();</span>
              }
<span class="line-removed">-         });</span>
<span class="line-removed">- </span>
<span class="line-removed">-         if (Util.compareBufferedImages(imageInit, imageShow)) {</span>
<span class="line-removed">-             throw new Exception(&quot;Failed to show non-opaque button&quot;);</span>
<span class="line-removed">-         }</span>
  
<span class="line-modified">!         robot.waitForIdle(500);</span>
<span class="line-modified">!         imageHide = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
  
<span class="line-modified">!         if (!Util.compareBufferedImages(imageInit, imageHide)) {</span>
<span class="line-modified">!             throw new Exception(&quot;Failed to hide non-opaque button&quot;);</span>
          }
      }
  }
<span class="line-new-header">--- 54,121 ---</span>
   */
  
  public class bug7154030 {
  
      private static JButton button = null;
<span class="line-added">+     private static JFrame frame;</span>
  
      public static void main(String[] args) throws Exception {
<span class="line-modified">!         try {</span>
<span class="line-modified">!             BufferedImage imageInit = null;</span>
<span class="line-modified">! </span>
<span class="line-modified">!             BufferedImage imageShow = null;</span>
<span class="line-modified">! </span>
<span class="line-modified">!             BufferedImage imageHide = null;</span>
<span class="line-modified">! </span>
<span class="line-modified">!             ExtendedRobot robot = new ExtendedRobot();</span>
<span class="line-modified">! </span>
<span class="line-modified">!             SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="line-modified">! </span>
<span class="line-modified">!                 @Override</span>
<span class="line-modified">!                 public void run() {</span>
<span class="line-modified">!                     JDesktopPane desktop = new JDesktopPane();</span>
<span class="line-modified">!                     button = new JButton(&quot;button&quot;);</span>
<span class="line-modified">!                     frame = new JFrame();</span>
<span class="line-modified">! </span>
<span class="line-modified">!                     button.setSize(200, 200);</span>
<span class="line-modified">!                     button.setLocation(100, 100);</span>
<span class="line-modified">!                     button.setForeground(Color.RED);</span>
<span class="line-modified">!                     button.setBackground(Color.RED);</span>
<span class="line-modified">!                     button.setOpaque(true);</span>
<span class="line-modified">!                     button.setVisible(false);</span>
<span class="line-modified">!                     desktop.add(button);</span>
<span class="line-modified">! </span>
<span class="line-modified">!                     frame.setContentPane(desktop);</span>
<span class="line-modified">!                     frame.setSize(300, 300);</span>
<span class="line-modified">!                     frame.setLocation(0, 0);</span>
<span class="line-modified">!                     frame.setVisible(true);</span>
<span class="line-added">+                     frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</span>
<span class="line-added">+                 }</span>
<span class="line-added">+             });</span>
<span class="line-added">+ </span>
<span class="line-added">+             robot.waitForIdle(500);</span>
<span class="line-added">+             imageInit = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
<span class="line-added">+ </span>
<span class="line-added">+             SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="line-added">+ </span>
<span class="line-added">+                 @Override</span>
<span class="line-added">+                 public void run() {</span>
<span class="line-added">+                     button.show();</span>
<span class="line-added">+                 }</span>
<span class="line-added">+             });</span>
<span class="line-added">+ </span>
<span class="line-added">+             robot.waitForIdle(500);</span>
<span class="line-added">+             imageShow = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
<span class="line-added">+             if (Util.compareBufferedImages(imageInit, imageShow)) {</span>
<span class="line-added">+                 throw new Exception(&quot;Failed to show opaque button&quot;);</span>
              }
  
<span class="line-modified">!             robot.waitForIdle();</span>
  
<span class="line-modified">!             SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="line-added">+                 @Override</span>
<span class="line-added">+                 public void run() {</span>
<span class="line-added">+                     button.hide();</span>
<span class="line-added">+                 }</span>
<span class="line-added">+             });</span>
  
<span class="line-modified">!             robot.waitForIdle(500);</span>
<span class="line-modified">!             imageHide = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
  
<span class="line-modified">!             if (!Util.compareBufferedImages(imageInit, imageHide)) {</span>
<span class="line-modified">!                 throw new Exception(&quot;Failed to hide opaque button&quot;);</span>
              }
  
<span class="line-modified">!             SwingUtilities.invokeAndWait(new Runnable() {</span>
  
<span class="line-modified">!                 @Override</span>
<span class="line-modified">!                 public void run() {</span>
<span class="line-modified">!                     button.setOpaque(false);</span>
<span class="line-added">+                     button.setBackground(new Color(128, 128, 0));</span>
<span class="line-added">+                     button.setVisible(false);</span>
<span class="line-added">+                 }</span>
<span class="line-added">+             });</span>
  
<span class="line-modified">!             robot.waitForIdle(500);</span>
<span class="line-added">+             imageInit = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
  
<span class="line-modified">!             SwingUtilities.invokeAndWait(new Runnable() {</span>
  
<span class="line-modified">!                 @Override</span>
<span class="line-modified">!                 public void run() {</span>
<span class="line-added">+                     button.show();</span>
<span class="line-added">+                 }</span>
<span class="line-added">+             });</span>
  
<span class="line-modified">!             robot.waitForIdle(500);</span>
<span class="line-added">+             imageShow = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
  
<span class="line-modified">!             SwingUtilities.invokeAndWait(new Runnable() {</span>
  
<span class="line-modified">!                 @Override</span>
<span class="line-modified">!                 public void run() {</span>
<span class="line-added">+                     button.hide();</span>
<span class="line-added">+                 }</span>
<span class="line-added">+             });</span>
  
<span class="line-modified">!             if (Util.compareBufferedImages(imageInit, imageShow)) {</span>
<span class="line-modified">!                 throw new Exception(&quot;Failed to show non-opaque button&quot;);</span>
              }
  
<span class="line-modified">!             robot.waitForIdle(500);</span>
<span class="line-modified">!             imageHide = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
  
<span class="line-modified">!             if (!Util.compareBufferedImages(imageInit, imageHide)) {</span>
<span class="line-modified">!                 throw new Exception(&quot;Failed to hide non-opaque button&quot;);</span>
<span class="line-added">+             }</span>
<span class="line-added">+         } finally {</span>
<span class="line-added">+             if (frame != null) SwingUtilities.invokeAndWait(() -&gt; frame.dispose());</span>
          }
      }
  }
</pre>
<center><a href="../6989617/bug6989617.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../JDialog/Transparency/TransparencyTest.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>