<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/jdk/javax/swing/JComponent/7154030/bug7154030.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../6989617/bug6989617.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../JDialog/Transparency/TransparencyTest.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/javax/swing/JComponent/7154030/bug7154030.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -54,117 +54,121 @@</span>
   */
  
  public class bug7154030 {
  
      private static JButton button = null;
<span class="udiff-line-added">+     private static JFrame frame;</span>
  
      public static void main(String[] args) throws Exception {
<span class="udiff-line-modified-removed">-         BufferedImage imageInit = null;</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-         BufferedImage imageShow = null;</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-         BufferedImage imageHide = null;</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-         ExtendedRobot robot = new ExtendedRobot();</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-         SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-             @Override</span>
<span class="udiff-line-modified-removed">-             public void run() {</span>
<span class="udiff-line-modified-removed">-                 JDesktopPane desktop = new JDesktopPane();</span>
<span class="udiff-line-modified-removed">-                 button = new JButton(&quot;button&quot;);</span>
<span class="udiff-line-modified-removed">-                 JFrame frame = new JFrame();</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-                 button.setSize(200, 200);</span>
<span class="udiff-line-modified-removed">-                 button.setLocation(100, 100);</span>
<span class="udiff-line-modified-removed">-                 button.setForeground(Color.RED);</span>
<span class="udiff-line-modified-removed">-                 button.setBackground(Color.RED);</span>
<span class="udiff-line-modified-removed">-                 button.setOpaque(true);</span>
<span class="udiff-line-modified-removed">-                 button.setVisible(false);</span>
<span class="udiff-line-modified-removed">-                 desktop.add(button);</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-                 frame.setContentPane(desktop);</span>
<span class="udiff-line-modified-removed">-                 frame.setSize(300, 300);</span>
<span class="udiff-line-modified-removed">-                 frame.setLocation(0, 0);</span>
<span class="udiff-line-modified-removed">-                 frame.setVisible(true);</span>
<span class="udiff-line-modified-removed">-                 frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</span>
<span class="udiff-line-modified-added">+         try {</span>
<span class="udiff-line-modified-added">+             BufferedImage imageInit = null;</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+             BufferedImage imageShow = null;</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+             BufferedImage imageHide = null;</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+             ExtendedRobot robot = new ExtendedRobot();</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+             SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+                 @Override</span>
<span class="udiff-line-modified-added">+                 public void run() {</span>
<span class="udiff-line-modified-added">+                     JDesktopPane desktop = new JDesktopPane();</span>
<span class="udiff-line-modified-added">+                     button = new JButton(&quot;button&quot;);</span>
<span class="udiff-line-modified-added">+                     frame = new JFrame();</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+                     button.setSize(200, 200);</span>
<span class="udiff-line-modified-added">+                     button.setLocation(100, 100);</span>
<span class="udiff-line-modified-added">+                     button.setForeground(Color.RED);</span>
<span class="udiff-line-modified-added">+                     button.setBackground(Color.RED);</span>
<span class="udiff-line-modified-added">+                     button.setOpaque(true);</span>
<span class="udiff-line-modified-added">+                     button.setVisible(false);</span>
<span class="udiff-line-modified-added">+                     desktop.add(button);</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+                     frame.setContentPane(desktop);</span>
<span class="udiff-line-modified-added">+                     frame.setSize(300, 300);</span>
<span class="udiff-line-modified-added">+                     frame.setLocation(0, 0);</span>
<span class="udiff-line-modified-added">+                     frame.setVisible(true);</span>
<span class="udiff-line-added">+                     frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</span>
<span class="udiff-line-added">+                 }</span>
<span class="udiff-line-added">+             });</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+             robot.waitForIdle(500);</span>
<span class="udiff-line-added">+             imageInit = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+             SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+                 @Override</span>
<span class="udiff-line-added">+                 public void run() {</span>
<span class="udiff-line-added">+                     button.show();</span>
<span class="udiff-line-added">+                 }</span>
<span class="udiff-line-added">+             });</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+             robot.waitForIdle(500);</span>
<span class="udiff-line-added">+             imageShow = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
<span class="udiff-line-added">+             if (Util.compareBufferedImages(imageInit, imageShow)) {</span>
<span class="udiff-line-added">+                 throw new Exception(&quot;Failed to show opaque button&quot;);</span>
              }
<span class="udiff-line-removed">-         });</span>
  
<span class="udiff-line-modified-removed">-         robot.waitForIdle(500);</span>
<span class="udiff-line-removed">-         imageInit = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
<span class="udiff-line-modified-added">+             robot.waitForIdle();</span>
  
<span class="udiff-line-modified-removed">-         SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="udiff-line-modified-added">+             SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="udiff-line-added">+                 @Override</span>
<span class="udiff-line-added">+                 public void run() {</span>
<span class="udiff-line-added">+                     button.hide();</span>
<span class="udiff-line-added">+                 }</span>
<span class="udiff-line-added">+             });</span>
  
<span class="udiff-line-modified-removed">-             @Override</span>
<span class="udiff-line-modified-removed">-             public void run() {</span>
<span class="udiff-line-removed">-                 button.show();</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-         });</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         robot.waitForIdle(500);</span>
<span class="udiff-line-removed">-         imageShow = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
<span class="udiff-line-removed">-         if (Util.compareBufferedImages(imageInit, imageShow)) {</span>
<span class="udiff-line-removed">-             throw new Exception(&quot;Failed to show opaque button&quot;);</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-modified-added">+             robot.waitForIdle(500);</span>
<span class="udiff-line-modified-added">+             imageHide = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
  
<span class="udiff-line-modified-removed">-         robot.waitForIdle();</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-removed">-         SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             @Override</span>
<span class="udiff-line-removed">-             public void run() {</span>
<span class="udiff-line-removed">-                 button.hide();</span>
<span class="udiff-line-modified-added">+             if (!Util.compareBufferedImages(imageInit, imageHide)) {</span>
<span class="udiff-line-modified-added">+                 throw new Exception(&quot;Failed to hide opaque button&quot;);</span>
              }
<span class="udiff-line-removed">-         });</span>
  
<span class="udiff-line-modified-removed">-         robot.waitForIdle(500);</span>
<span class="udiff-line-removed">-         imageHide = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
<span class="udiff-line-modified-added">+             SwingUtilities.invokeAndWait(new Runnable() {</span>
  
<span class="udiff-line-modified-removed">-         if (!Util.compareBufferedImages(imageInit, imageHide)) {</span>
<span class="udiff-line-modified-removed">-             throw new Exception(&quot;Failed to hide opaque button&quot;);</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-added">+                 @Override</span>
<span class="udiff-line-modified-added">+                 public void run() {</span>
<span class="udiff-line-modified-added">+                     button.setOpaque(false);</span>
<span class="udiff-line-added">+                     button.setBackground(new Color(128, 128, 0));</span>
<span class="udiff-line-added">+                     button.setVisible(false);</span>
<span class="udiff-line-added">+                 }</span>
<span class="udiff-line-added">+             });</span>
  
<span class="udiff-line-modified-removed">-         SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="udiff-line-modified-added">+             robot.waitForIdle(500);</span>
<span class="udiff-line-added">+             imageInit = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
  
<span class="udiff-line-modified-removed">-             @Override</span>
<span class="udiff-line-removed">-             public void run() {</span>
<span class="udiff-line-removed">-                 button.setOpaque(false);</span>
<span class="udiff-line-removed">-                 button.setBackground(new Color(128, 128, 0));</span>
<span class="udiff-line-removed">-                 button.setVisible(false);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-         });</span>
<span class="udiff-line-modified-added">+             SwingUtilities.invokeAndWait(new Runnable() {</span>
  
<span class="udiff-line-modified-removed">-         robot.waitForIdle(500);</span>
<span class="udiff-line-modified-removed">-         imageInit = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
<span class="udiff-line-modified-added">+                 @Override</span>
<span class="udiff-line-modified-added">+                 public void run() {</span>
<span class="udiff-line-added">+                     button.show();</span>
<span class="udiff-line-added">+                 }</span>
<span class="udiff-line-added">+             });</span>
  
<span class="udiff-line-modified-removed">-         SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="udiff-line-modified-added">+             robot.waitForIdle(500);</span>
<span class="udiff-line-added">+             imageShow = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
  
<span class="udiff-line-modified-removed">-             @Override</span>
<span class="udiff-line-removed">-             public void run() {</span>
<span class="udiff-line-removed">-                 button.show();</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-         });</span>
<span class="udiff-line-modified-added">+             SwingUtilities.invokeAndWait(new Runnable() {</span>
  
<span class="udiff-line-modified-removed">-         robot.waitForIdle(500);</span>
<span class="udiff-line-modified-removed">-         imageShow = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
<span class="udiff-line-modified-added">+                 @Override</span>
<span class="udiff-line-modified-added">+                 public void run() {</span>
<span class="udiff-line-added">+                     button.hide();</span>
<span class="udiff-line-added">+                 }</span>
<span class="udiff-line-added">+             });</span>
  
<span class="udiff-line-modified-removed">-         SwingUtilities.invokeAndWait(new Runnable() {</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-removed">-             @Override</span>
<span class="udiff-line-removed">-             public void run() {</span>
<span class="udiff-line-removed">-                 button.hide();</span>
<span class="udiff-line-modified-added">+             if (Util.compareBufferedImages(imageInit, imageShow)) {</span>
<span class="udiff-line-modified-added">+                 throw new Exception(&quot;Failed to show non-opaque button&quot;);</span>
              }
<span class="udiff-line-removed">-         });</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         if (Util.compareBufferedImages(imageInit, imageShow)) {</span>
<span class="udiff-line-removed">-             throw new Exception(&quot;Failed to show non-opaque button&quot;);</span>
<span class="udiff-line-removed">-         }</span>
  
<span class="udiff-line-modified-removed">-         robot.waitForIdle(500);</span>
<span class="udiff-line-modified-removed">-         imageHide = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
<span class="udiff-line-modified-added">+             robot.waitForIdle(500);</span>
<span class="udiff-line-modified-added">+             imageHide = robot.createScreenCapture(new Rectangle(0, 0, 300, 300));</span>
  
<span class="udiff-line-modified-removed">-         if (!Util.compareBufferedImages(imageInit, imageHide)) {</span>
<span class="udiff-line-modified-removed">-             throw new Exception(&quot;Failed to hide non-opaque button&quot;);</span>
<span class="udiff-line-modified-added">+             if (!Util.compareBufferedImages(imageInit, imageHide)) {</span>
<span class="udiff-line-modified-added">+                 throw new Exception(&quot;Failed to hide non-opaque button&quot;);</span>
<span class="udiff-line-added">+             }</span>
<span class="udiff-line-added">+         } finally {</span>
<span class="udiff-line-added">+             if (frame != null) SwingUtilities.invokeAndWait(() -&gt; frame.dispose());</span>
          }
      }
  }
</pre>
<center><a href="../6989617/bug6989617.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../JDialog/Transparency/TransparencyTest.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>