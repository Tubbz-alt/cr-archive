<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/jdk/javax/net/ssl/sanity/ciphersuites/CheckCipherSuites.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../compatibility/Utils.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="CipherSuitesInOrder.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/javax/net/ssl/sanity/ciphersuites/CheckCipherSuites.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -21,13 +21,13 @@</span>
   * questions.
   */
  
  /*
   * @test
<span class="udiff-line-modified-removed">-  * @bug 4750141 4895631 8217579</span>
<span class="udiff-line-modified-added">+  * @bug 4750141 4895631 8217579 8163326</span>
   * @summary Check enabled and supported ciphersuites are correct
<span class="udiff-line-modified-removed">-  * @run main CheckCipherSuites default</span>
<span class="udiff-line-modified-added">+  * @run main/othervm CheckCipherSuites default</span>
   * @run main/othervm CheckCipherSuites limited
   */
  
  import java.util.*;
  import java.security.Security;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -36,168 +36,254 @@</span>
  public class CheckCipherSuites {
  
      // List of enabled cipher suites when the &quot;crypto.policy&quot; security
      // property is set to &quot;unlimited&quot; (the default value).
      private final static String[] ENABLED_DEFAULT = {
<span class="udiff-line-modified-removed">-         &quot;TLS_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-modified-added">+         // TLS 1.3 cipher suites</span>
          &quot;TLS_AES_256_GCM_SHA384&quot;,
<span class="udiff-line-added">+         &quot;TLS_AES_128_GCM_SHA256&quot;,</span>
          &quot;TLS_CHACHA20_POLY1305_SHA256&quot;,
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // Suite B compliant cipher suites</span>
          &quot;TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384&quot;,
          &quot;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256&quot;,
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // Not suite B, but we want it to position the suite early</span>
          &quot;TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256&quot;,
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_256(GCM) - ECDHE - forward screcy</span>
          &quot;TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384&quot;,
          &quot;TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256&quot;,
<span class="udiff-line-modified-removed">-         &quot;TLS_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         // AES_128(GCM) - ECDHE - forward screcy</span>
<span class="udiff-line-modified-added">+         &quot;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_256(GCM) - DHE - forward screcy</span>
          &quot;TLS_DHE_RSA_WITH_AES_256_GCM_SHA384&quot;,
          &quot;TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256&quot;,
          &quot;TLS_DHE_DSS_WITH_AES_256_GCM_SHA384&quot;,
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         // AES_128(GCM) - DHE - forward screcy</span>
          &quot;TLS_DHE_RSA_WITH_AES_128_GCM_SHA256&quot;,
          &quot;TLS_DHE_DSS_WITH_AES_128_GCM_SHA256&quot;,
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_256(CBC) - ECDHE - forward screcy</span>
          &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384&quot;,
          &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384&quot;,
<span class="udiff-line-modified-removed">-         &quot;TLS_RSA_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         // AES_256(CBC) - ECDHE - forward screcy</span>
          &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256&quot;,
          &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256&quot;,
<span class="udiff-line-modified-removed">-         &quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         // AES_256(CBC) - DHE - forward screcy</span>
<span class="udiff-line-modified-added">+         &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_128(CBC) - DHE - forward screcy</span>
          &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA256&quot;,
          &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA256&quot;,
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_256(GCM) - not forward screcy</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_128(GCM) - not forward screcy</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_256(CBC) - not forward screcy</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_128(CBC) - not forward screcy</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_256(CBC) - ECDHE - using SHA</span>
<span class="udiff-line-added">+         &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_128(CBC) - ECDHE - using SHA</span>
          &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA&quot;,
          &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;,
<span class="udiff-line-modified-removed">-         &quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         // AES_256(CBC) - DHE - using SHA</span>
<span class="udiff-line-modified-added">+         &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_128(CBC) - DHE - using SHA</span>
          &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA&quot;,
          &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA&quot;,
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_256(CBC) - using SHA, not forward screcy</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_128(CBC) - using SHA, not forward screcy</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // deprecated</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
          &quot;TLS_EMPTY_RENEGOTIATION_INFO_SCSV&quot;
      };
  
      // List of enabled cipher suites when the &quot;crypto.policy&quot; security
      // property is set to &quot;limited&quot;.
      private final static String[] ENABLED_LIMITED = {
          &quot;TLS_AES_128_GCM_SHA256&quot;,
          &quot;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256&quot;,
          &quot;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256&quot;,
<span class="udiff-line-removed">-         &quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
          &quot;TLS_DHE_RSA_WITH_AES_128_GCM_SHA256&quot;,
          &quot;TLS_DHE_DSS_WITH_AES_128_GCM_SHA256&quot;,
          &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256&quot;,
          &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256&quot;,
<span class="udiff-line-removed">-         &quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
          &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA256&quot;,
          &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA256&quot;,
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
          &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA&quot;,
          &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;,
<span class="udiff-line-removed">-         &quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
          &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA&quot;,
          &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA&quot;,
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
          &quot;TLS_EMPTY_RENEGOTIATION_INFO_SCSV&quot;
      };
  
      // List of supported cipher suites when the &quot;crypto.policy&quot; security
      // property is set to &quot;unlimited&quot; (the default value).
      private final static String[] SUPPORTED_DEFAULT = {
<span class="udiff-line-modified-removed">-         &quot;TLS_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-modified-added">+         // TLS 1.3 cipher suites</span>
          &quot;TLS_AES_256_GCM_SHA384&quot;,
<span class="udiff-line-added">+         &quot;TLS_AES_128_GCM_SHA256&quot;,</span>
          &quot;TLS_CHACHA20_POLY1305_SHA256&quot;,
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // Suite B compliant cipher suites</span>
          &quot;TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384&quot;,
          &quot;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256&quot;,
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // Not suite B, but we want it to position the suite early</span>
          &quot;TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256&quot;,
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_256(GCM) - ECDHE - forward screcy</span>
          &quot;TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384&quot;,
          &quot;TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256&quot;,
<span class="udiff-line-modified-removed">-         &quot;TLS_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         // AES_128(GCM) - ECDHE - forward screcy</span>
<span class="udiff-line-modified-added">+         &quot;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_256(GCM) - DHE - forward screcy</span>
          &quot;TLS_DHE_RSA_WITH_AES_256_GCM_SHA384&quot;,
          &quot;TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256&quot;,
          &quot;TLS_DHE_DSS_WITH_AES_256_GCM_SHA384&quot;,
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         // AES_128(GCM) - DHE - forward screcy</span>
          &quot;TLS_DHE_RSA_WITH_AES_128_GCM_SHA256&quot;,
          &quot;TLS_DHE_DSS_WITH_AES_128_GCM_SHA256&quot;,
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_256(CBC) - ECDHE - forward screcy</span>
          &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384&quot;,
          &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384&quot;,
<span class="udiff-line-modified-removed">-         &quot;TLS_RSA_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         // AES_256(CBC) - ECDHE - forward screcy</span>
          &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256&quot;,
          &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256&quot;,
<span class="udiff-line-modified-removed">-         &quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         // AES_256(CBC) - DHE - forward screcy</span>
<span class="udiff-line-modified-added">+         &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_128(CBC) - DHE - forward screcy</span>
          &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA256&quot;,
          &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA256&quot;,
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_256(GCM) - not forward screcy</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_128(GCM) - not forward screcy</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_256(CBC) - not forward screcy</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_128(CBC) - not forward screcy</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_256(CBC) - ECDHE - using SHA</span>
<span class="udiff-line-added">+         &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_128(CBC) - ECDHE - using SHA</span>
          &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA&quot;,
          &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;,
<span class="udiff-line-modified-removed">-         &quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-modified-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         // AES_256(CBC) - DHE - using SHA</span>
<span class="udiff-line-modified-added">+         &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_128(CBC) - DHE - using SHA</span>
          &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA&quot;,
          &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA&quot;,
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_256(CBC) - using SHA, not forward screcy</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // AES_128(CBC) - using SHA, not forward screcy</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         // deprecated</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
          &quot;TLS_EMPTY_RENEGOTIATION_INFO_SCSV&quot;
      };
  
      // List of supported cipher suites when the &quot;crypto.policy&quot; security
      // property is set to &quot;limited&quot;.
      private final static String[] SUPPORTED_LIMITED = {
          &quot;TLS_AES_128_GCM_SHA256&quot;,
          &quot;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256&quot;,
          &quot;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256&quot;,
<span class="udiff-line-removed">-         &quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
          &quot;TLS_DHE_RSA_WITH_AES_128_GCM_SHA256&quot;,
          &quot;TLS_DHE_DSS_WITH_AES_128_GCM_SHA256&quot;,
          &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256&quot;,
          &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256&quot;,
<span class="udiff-line-removed">-         &quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
          &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA256&quot;,
          &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA256&quot;,
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
          &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA&quot;,
          &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;,
<span class="udiff-line-removed">-         &quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-removed">-         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
          &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA&quot;,
          &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA&quot;,
<span class="udiff-line-added">+         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="udiff-line-added">+         &quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
          &quot;TLS_EMPTY_RENEGOTIATION_INFO_SCSV&quot;
      };
  
      private static void showSuites(String[] suites) {
          if ((suites == null) || (suites.length == 0)) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -226,11 +312,12 @@</span>
              SUPPORTED = SUPPORTED_LIMITED;
          } else {
              throw new Exception(&quot;Illegal argument&quot;);
          }
  
<span class="udiff-line-modified-removed">-         SSLSocketFactory factory = (SSLSocketFactory)SSLSocketFactory.getDefault();</span>
<span class="udiff-line-modified-added">+         SSLSocketFactory factory =</span>
<span class="udiff-line-added">+                 (SSLSocketFactory)SSLSocketFactory.getDefault();</span>
          SSLSocket socket = (SSLSocket)factory.createSocket();
          String[] enabled = socket.getEnabledCipherSuites();
  
          System.out.println(&quot;Default enabled ciphersuites:&quot;);
          showSuites(enabled);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -255,7 +342,6 @@</span>
          System.out.println(&quot;OK&quot;);
  
          long end = System.currentTimeMillis();
          System.out.println(&quot;Done (&quot; + (end - start) + &quot; ms).&quot;);
      }
<span class="udiff-line-removed">- </span>
  }
</pre>
<center><a href="../../compatibility/Utils.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="CipherSuitesInOrder.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>