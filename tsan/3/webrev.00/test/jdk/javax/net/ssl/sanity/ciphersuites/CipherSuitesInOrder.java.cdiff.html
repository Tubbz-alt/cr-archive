<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/jdk/javax/net/ssl/sanity/ciphersuites/CipherSuitesInOrder.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="CheckCipherSuites.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../interop/JSSEServer.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/javax/net/ssl/sanity/ciphersuites/CipherSuitesInOrder.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2012, 2015, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2012, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 26,147 ***</span>
  // system properties in samevm/agentvm mode.
  //
  
  /*
   * @test
<span class="line-modified">!  * @bug 7174244</span>
<span class="line-modified">!  * @summary NPE in Krb5ProxyImpl.getServerKeys()</span>
<span class="line-removed">-  * @ignore the dependent implementation details are changed</span>
   * @run main/othervm CipherSuitesInOrder
   */
<span class="line-removed">- </span>
  import java.util.*;
  import javax.net.ssl.*;
<span class="line-removed">- import java.security.Security;</span>
  
  public class CipherSuitesInOrder {
  
<span class="line-modified">!     // supported ciphersuites</span>
<span class="line-modified">!     private final static List&lt;String&gt; supportedCipherSuites =</span>
<span class="line-modified">!             Arrays.&lt;String&gt;asList(</span>
<span class="line-modified">!         &quot;TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!         &quot;TLS_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!         &quot;TLS_DHE_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!         &quot;TLS_DHE_DSS_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_DHE_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_DHE_DSS_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">! </span>
<span class="line-modified">!         &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="line-modified">!         &quot;TLS_RSA_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="line-modified">!         &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">! </span>
<span class="line-modified">!         &quot;TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">! </span>
<span class="line-modified">!         &quot;TLS_EMPTY_RENEGOTIATION_INFO_SCSV&quot;,</span>
<span class="line-modified">! </span>
<span class="line-modified">!         &quot;TLS_DH_anon_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!         &quot;TLS_DH_anon_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">! </span>
<span class="line-modified">!         &quot;TLS_DH_anon_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_anon_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_DH_anon_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_DH_anon_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_anon_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_DH_anon_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_DH_anon_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">! </span>
<span class="line-modified">!         &quot;TLS_ECDHE_ECDSA_WITH_RC4_128_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDHE_RSA_WITH_RC4_128_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_RSA_WITH_RC4_128_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_ECDSA_WITH_RC4_128_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_RSA_WITH_RC4_128_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_RSA_WITH_RC4_128_MD5&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_anon_WITH_RC4_128_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_DH_anon_WITH_RC4_128_MD5&quot;,</span>
<span class="line-modified">! </span>
<span class="line-modified">!         &quot;SSL_RSA_WITH_DES_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_DHE_RSA_WITH_DES_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_DHE_DSS_WITH_DES_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_DH_anon_WITH_DES_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA&quot;,</span>
<span class="line-modified">! </span>
<span class="line-modified">!         &quot;SSL_RSA_EXPORT_WITH_RC4_40_MD5&quot;,</span>
<span class="line-modified">!         &quot;SSL_DH_anon_EXPORT_WITH_RC4_40_MD5&quot;,</span>
<span class="line-modified">! </span>
<span class="line-modified">!         &quot;TLS_RSA_WITH_NULL_SHA256&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDHE_ECDSA_WITH_NULL_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDHE_RSA_WITH_NULL_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_RSA_WITH_NULL_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_ECDSA_WITH_NULL_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_RSA_WITH_NULL_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_ECDH_anon_WITH_NULL_SHA&quot;,</span>
<span class="line-modified">!         &quot;SSL_RSA_WITH_NULL_MD5&quot;,</span>
<span class="line-modified">! </span>
<span class="line-modified">!         &quot;TLS_KRB5_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_KRB5_WITH_3DES_EDE_CBC_MD5&quot;,</span>
<span class="line-modified">!         &quot;TLS_KRB5_WITH_RC4_128_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_KRB5_WITH_RC4_128_MD5&quot;,</span>
<span class="line-modified">!         &quot;TLS_KRB5_WITH_DES_CBC_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_KRB5_WITH_DES_CBC_MD5&quot;,</span>
<span class="line-modified">!         &quot;TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5&quot;,</span>
<span class="line-modified">!         &quot;TLS_KRB5_EXPORT_WITH_RC4_40_SHA&quot;,</span>
<span class="line-modified">!         &quot;TLS_KRB5_EXPORT_WITH_RC4_40_MD5&quot;</span>
<span class="line-modified">!     );</span>
  
      private final static String[] protocols = {
<span class="line-modified">!         &quot;&quot;, &quot;SSL&quot;, &quot;TLS&quot;, &quot;SSLv3&quot;, &quot;TLSv1&quot;, &quot;TLSv1.1&quot;, &quot;TLSv1.2&quot;</span>
      };
  
<span class="line-removed">- </span>
      public static void main(String[] args) throws Exception {
          // show all of the supported cipher suites
          showSuites(supportedCipherSuites.toArray(new String[0]),
<span class="line-modified">!                                 &quot;All supported cipher suites&quot;);</span>
  
          for (String protocol : protocols) {
              System.out.println(&quot;//&quot;);
<span class="line-modified">!             System.out.println(&quot;// &quot; +</span>
<span class="line-modified">!                         &quot;Testing for SSLContext of &quot; + protocol);</span>
              System.out.println(&quot;//&quot;);
              checkForProtocols(protocol);
          }
      }
  
<span class="line-new-header">--- 26,183 ---</span>
  // system properties in samevm/agentvm mode.
  //
  
  /*
   * @test
<span class="line-modified">!  * @bug 7174244 8234728</span>
<span class="line-modified">!  * @summary Test for ciphersuites order</span>
   * @run main/othervm CipherSuitesInOrder
   */
  import java.util.*;
  import javax.net.ssl.*;
  
  public class CipherSuitesInOrder {
  
<span class="line-modified">!     // Supported ciphersuites</span>
<span class="line-modified">!     private final static List&lt;String&gt; supportedCipherSuites</span>
<span class="line-modified">!             = Arrays.&lt;String&gt;asList(</span>
<span class="line-modified">!                     // TLS 1.3 cipher suites.</span>
<span class="line-modified">!                     &quot;TLS_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!                     &quot;TLS_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!                     &quot;TLS_CHACHA20_POLY1305_SHA256&quot;,</span>
<span class="line-modified">!                     // Suite B compliant cipher suites, see RFC 6460.</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!                     // Not suite B, but we want it to position the suite early</span>
<span class="line-modified">!                     //in the list of 1.2 suites.</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256&quot;,</span>
<span class="line-modified">!                     //</span>
<span class="line-modified">!                     // Forward secrecy cipher suites.</span>
<span class="line-modified">!                     //</span>
<span class="line-modified">!                     // AES_256(GCM) - ECDHE</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256&quot;,</span>
<span class="line-modified">!                     // AES_128(GCM) - ECDHE</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!                     // AES_256(GCM) - DHE</span>
<span class="line-modified">!                     &quot;TLS_DHE_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!                     &quot;TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256&quot;,</span>
<span class="line-modified">!                     &quot;TLS_DHE_DSS_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!                     // AES_128(GCM) - DHE</span>
<span class="line-modified">!                     &quot;TLS_DHE_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!                     &quot;TLS_DHE_DSS_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!                     // AES_256(CBC) - ECDHE</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="line-modified">!                     // AES_128(CBC) - ECDHE</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!                     // AES_256(CBC) - DHE</span>
<span class="line-modified">!                     &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="line-modified">!                     &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="line-modified">!                     // AES_128(CBC) - DHE</span>
<span class="line-modified">!                     &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!                     &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!                     //</span>
<span class="line-modified">!                     // Not forward secret cipher suites.</span>
<span class="line-modified">!                     //</span>
<span class="line-modified">!                     // AES_256(GCM)</span>
<span class="line-modified">!                     &quot;TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!                     // AES_128(GCM)</span>
<span class="line-modified">!                     &quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!                     // AES_256(CBC)</span>
<span class="line-modified">!                     &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384&quot;,</span>
<span class="line-modified">!                     // AES_128(CBC)</span>
<span class="line-modified">!                     &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!                     //</span>
<span class="line-modified">!                     // Legacy, used for compatibility</span>
<span class="line-modified">!                     //</span>
<span class="line-modified">!                     // AES_256(CBC) - ECDHE - Using SHA</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!                     // AES_128(CBC) - ECDHE - using SHA</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!                     // AES_256(CBC) - DHE - Using SHA</span>
<span class="line-modified">!                     &quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!                     &quot;TLS_DHE_DSS_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!                     // AES_128(CBC) - DHE - using SHA</span>
<span class="line-modified">!                     &quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!                     &quot;TLS_DHE_DSS_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!                     // AES_256(CBC) - using SHA, not forward secrecy</span>
<span class="line-modified">!                     &quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!                     // AES_128(CBC) - using SHA, not forward secrecy</span>
<span class="line-modified">!                     &quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!                     //</span>
<span class="line-modified">!                     // Deprecated, used for compatibility</span>
<span class="line-modified">!                     //</span>
<span class="line-modified">!                     // RSA, AES_256(GCM)</span>
<span class="line-modified">!                     &quot;TLS_RSA_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!                     // RSA, AES_128(GCM)</span>
<span class="line-modified">!                     &quot;TLS_RSA_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!                     // RSA, AES_256(CBC)</span>
<span class="line-modified">!                     &quot;TLS_RSA_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="line-modified">!                     // RSA, AES_128(CBC)</span>
<span class="line-modified">!                     &quot;TLS_RSA_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-modified">!                     // RSA, AES_256(CBC) - using SHA, not forward secrecy</span>
<span class="line-modified">!                     &quot;TLS_RSA_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!                     // RSA, AES_128(CBC) - using SHA, not forward secrecy</span>
<span class="line-modified">!                     &quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-modified">!                     // 3DES_EDE, forward secrecy.</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!                     &quot;SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!                     &quot;SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!                     // 3DES_EDE, not forward secrecy.</span>
<span class="line-modified">!                     &quot;TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!                     &quot;SSL_RSA_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-modified">!                     // Renegotiation protection request Signalling</span>
<span class="line-modified">!                     // Cipher Suite Value (SCSV).</span>
<span class="line-modified">!                     &quot;TLS_EMPTY_RENEGOTIATION_INFO_SCSV&quot;,</span>
<span class="line-modified">!                     // Definition of the Cipher Suites that are supported but not</span>
<span class="line-modified">!                     // enabled by default.</span>
<span class="line-modified">!                     &quot;TLS_DH_anon_WITH_AES_256_GCM_SHA384&quot;,</span>
<span class="line-modified">!                     &quot;TLS_DH_anon_WITH_AES_128_GCM_SHA256&quot;,</span>
<span class="line-modified">!                     &quot;TLS_DH_anon_WITH_AES_256_CBC_SHA256&quot;,</span>
<span class="line-modified">!                     &quot;TLS_ECDH_anon_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-modified">!                     &quot;TLS_DH_anon_WITH_AES_256_CBC_SHA&quot;,</span>
<span class="line-added">+                     &quot;TLS_DH_anon_WITH_AES_128_CBC_SHA256&quot;,</span>
<span class="line-added">+                     &quot;TLS_ECDH_anon_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-added">+                     &quot;TLS_DH_anon_WITH_AES_128_CBC_SHA&quot;,</span>
<span class="line-added">+                     &quot;TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-added">+                     &quot;SSL_DH_anon_WITH_3DES_EDE_CBC_SHA&quot;,</span>
<span class="line-added">+                     // RC4</span>
<span class="line-added">+                     &quot;TLS_ECDHE_ECDSA_WITH_RC4_128_SHA&quot;,</span>
<span class="line-added">+                     &quot;TLS_ECDHE_RSA_WITH_RC4_128_SHA&quot;,</span>
<span class="line-added">+                     &quot;SSL_RSA_WITH_RC4_128_SHA&quot;,</span>
<span class="line-added">+                     &quot;TLS_ECDH_ECDSA_WITH_RC4_128_SHA&quot;,</span>
<span class="line-added">+                     &quot;TLS_ECDH_RSA_WITH_RC4_128_SHA&quot;,</span>
<span class="line-added">+                     &quot;SSL_RSA_WITH_RC4_128_MD5&quot;,</span>
<span class="line-added">+                     &quot;TLS_ECDH_anon_WITH_RC4_128_SHA&quot;,</span>
<span class="line-added">+                     &quot;SSL_DH_anon_WITH_RC4_128_MD5&quot;,</span>
<span class="line-added">+                     // Weak cipher suites obsoleted in TLS 1.2 [RFC 5246]</span>
<span class="line-added">+                     &quot;SSL_RSA_WITH_DES_CBC_SHA&quot;,</span>
<span class="line-added">+                     &quot;SSL_DHE_RSA_WITH_DES_CBC_SHA&quot;,</span>
<span class="line-added">+                     &quot;SSL_DHE_DSS_WITH_DES_CBC_SHA&quot;,</span>
<span class="line-added">+                     &quot;SSL_DH_anon_WITH_DES_CBC_SHA&quot;,</span>
<span class="line-added">+                     // Weak cipher suites obsoleted in TLS 1.1  [RFC 4346]</span>
<span class="line-added">+                     &quot;SSL_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,</span>
<span class="line-added">+                     &quot;SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA&quot;,</span>
<span class="line-added">+                     &quot;SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA&quot;,</span>
<span class="line-added">+                     &quot;SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA&quot;,</span>
<span class="line-added">+                     &quot;SSL_RSA_EXPORT_WITH_RC4_40_MD5&quot;,</span>
<span class="line-added">+                     &quot;SSL_DH_anon_EXPORT_WITH_RC4_40_MD5&quot;,</span>
<span class="line-added">+                     // No traffic encryption cipher suites</span>
<span class="line-added">+                     &quot;TLS_RSA_WITH_NULL_SHA256&quot;,</span>
<span class="line-added">+                     &quot;TLS_ECDHE_ECDSA_WITH_NULL_SHA&quot;,</span>
<span class="line-added">+                     &quot;TLS_ECDHE_RSA_WITH_NULL_SHA&quot;,</span>
<span class="line-added">+                     &quot;SSL_RSA_WITH_NULL_SHA&quot;,</span>
<span class="line-added">+                     &quot;TLS_ECDH_ECDSA_WITH_NULL_SHA&quot;,</span>
<span class="line-added">+                     &quot;TLS_ECDH_RSA_WITH_NULL_SHA&quot;,</span>
<span class="line-added">+                     &quot;TLS_ECDH_anon_WITH_NULL_SHA&quot;,</span>
<span class="line-added">+                     &quot;SSL_RSA_WITH_NULL_MD5&quot;,</span>
<span class="line-added">+                     // Definition of the cipher suites that are not supported but the names</span>
<span class="line-added">+                     // are known.</span>
<span class="line-added">+                     &quot;TLS_AES_128_CCM_SHA256&quot;,</span>
<span class="line-added">+                     &quot;TLS_AES_128_CCM_8_SHA256&quot;</span>
<span class="line-added">+             );</span>
  
      private final static String[] protocols = {
<span class="line-modified">!         &quot;&quot;, &quot;SSL&quot;, &quot;TLS&quot;, &quot;SSLv3&quot;, &quot;TLSv1&quot;, &quot;TLSv1.1&quot;, &quot;TLSv1.2&quot;, &quot;TLSv1.3&quot;</span>
      };
  
      public static void main(String[] args) throws Exception {
          // show all of the supported cipher suites
          showSuites(supportedCipherSuites.toArray(new String[0]),
<span class="line-modified">!                 &quot;All supported cipher suites&quot;);</span>
  
          for (String protocol : protocols) {
              System.out.println(&quot;//&quot;);
<span class="line-modified">!             System.out.println(&quot;// &quot;</span>
<span class="line-modified">!                     + &quot;Testing for SSLContext of &quot; + protocol);</span>
              System.out.println(&quot;//&quot;);
              checkForProtocols(protocol);
          }
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 187,11 ***</span>
          // check the order of supported cipher suites of SSLContext
          parameters = context.getSupportedSSLParameters();
          checkSuites(parameters.getCipherSuites(),
                  &quot;Supported cipher suites in SSLContext&quot;);
  
<span class="line-removed">- </span>
          //
          // Check the cipher suites order of SSLEngine
          //
          SSLEngine engine = context.createSSLEngine();
  
<span class="line-new-header">--- 223,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 207,38 ***</span>
  
          //
          // Check the cipher suites order of SSLSocket
          //
          SSLSocketFactory factory = context.getSocketFactory();
<span class="line-modified">!         try (SSLSocket socket = (SSLSocket)factory.createSocket()) {</span>
  
              // check the order of endabled cipher suites
              ciphers = socket.getEnabledCipherSuites();
              checkSuites(ciphers,
<span class="line-modified">!                 &quot;Enabled cipher suites in SSLSocket&quot;);</span>
  
              // check the order of supported cipher suites
              ciphers = socket.getSupportedCipherSuites();
              checkSuites(ciphers,
<span class="line-modified">!                 &quot;Supported cipher suites in SSLSocket&quot;);</span>
          }
  
          //
          // Check the cipher suites order of SSLServerSocket
          //
          SSLServerSocketFactory serverFactory = context.getServerSocketFactory();
<span class="line-modified">!         try (SSLServerSocket serverSocket =</span>
<span class="line-modified">!                 (SSLServerSocket)serverFactory.createServerSocket()) {</span>
              // check the order of endabled cipher suites
              ciphers = serverSocket.getEnabledCipherSuites();
              checkSuites(ciphers,
<span class="line-modified">!                 &quot;Enabled cipher suites in SSLServerSocket&quot;);</span>
  
              // check the order of supported cipher suites
              ciphers = serverSocket.getSupportedCipherSuites();
              checkSuites(ciphers,
<span class="line-modified">!                 &quot;Supported cipher suites in SSLServerSocket&quot;);</span>
          }
      }
  
      private static void checkSuites(String[] suites, String title) {
          showSuites(suites, title);
<span class="line-new-header">--- 242,38 ---</span>
  
          //
          // Check the cipher suites order of SSLSocket
          //
          SSLSocketFactory factory = context.getSocketFactory();
<span class="line-modified">!         try (SSLSocket socket = (SSLSocket) factory.createSocket()) {</span>
  
              // check the order of endabled cipher suites
              ciphers = socket.getEnabledCipherSuites();
              checkSuites(ciphers,
<span class="line-modified">!                     &quot;Enabled cipher suites in SSLSocket&quot;);</span>
  
              // check the order of supported cipher suites
              ciphers = socket.getSupportedCipherSuites();
              checkSuites(ciphers,
<span class="line-modified">!                     &quot;Supported cipher suites in SSLSocket&quot;);</span>
          }
  
          //
          // Check the cipher suites order of SSLServerSocket
          //
          SSLServerSocketFactory serverFactory = context.getServerSocketFactory();
<span class="line-modified">!         try (SSLServerSocket serverSocket</span>
<span class="line-modified">!                 = (SSLServerSocket) serverFactory.createServerSocket()) {</span>
              // check the order of endabled cipher suites
              ciphers = serverSocket.getEnabledCipherSuites();
              checkSuites(ciphers,
<span class="line-modified">!                     &quot;Enabled cipher suites in SSLServerSocket&quot;);</span>
  
              // check the order of supported cipher suites
              ciphers = serverSocket.getSupportedCipherSuites();
              checkSuites(ciphers,
<span class="line-modified">!                     &quot;Supported cipher suites in SSLServerSocket&quot;);</span>
          }
      }
  
      private static void checkSuites(String[] suites, String title) {
          showSuites(suites, title);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 248,11 ***</span>
          for (String suite : suites) {
              index = supportedCipherSuites.indexOf(suite);
              if (index &lt;= loc) {
                  throw new RuntimeException(suite + &quot; is not in order&quot;);
              }
<span class="line-removed">- </span>
              loc = index;
          }
      }
  
      private static void showSuites(String[] suites, String title) {
<span class="line-new-header">--- 283,10 ---</span>
</pre>
<center><a href="CheckCipherSuites.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../interop/JSSEServer.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>