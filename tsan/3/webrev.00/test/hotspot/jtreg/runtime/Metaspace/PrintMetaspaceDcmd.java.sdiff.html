<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/runtime/Metaspace/PrintMetaspaceDcmd.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="DefineClass.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../NMT/CheckForProperDetailStackTrace.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/runtime/Metaspace/PrintMetaspaceDcmd.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 50 
 51 public class PrintMetaspaceDcmd {
 52 
 53     // Run jcmd VM.metaspace against a VM with CompressedClassPointers on.
 54     // The report should detail Non-Class and Class portions separately.
 55     private static void doTheTest(boolean usesCompressedClassSpace) throws Exception {
 56         ProcessBuilder pb = new ProcessBuilder();
 57         OutputAnalyzer output;
 58         // Grab my own PID
 59         String pid = Long.toString(ProcessTools.getProcessId());
 60 
 61         pb.command(new String[] { JDKToolFinder.getJDKTool(&quot;jcmd&quot;), pid, &quot;VM.metaspace&quot;, &quot;basic&quot;});
 62         output = new OutputAnalyzer(pb.start());
 63         output.shouldHaveExitValue(0);
 64         if (usesCompressedClassSpace) {
 65             output.shouldContain(&quot;Non-Class:&quot;);
 66             output.shouldContain(&quot;Class:&quot;);
 67         }
 68         output.shouldContain(&quot;Virtual space:&quot;);
 69         output.shouldContain(&quot;Chunk freelists:&quot;);
<span class="line-modified"> 70 </span>
 71 
 72         pb.command(new String[] { JDKToolFinder.getJDKTool(&quot;jcmd&quot;), pid, &quot;VM.metaspace&quot;});
 73         output = new OutputAnalyzer(pb.start());
 74         output.shouldHaveExitValue(0);
 75         if (usesCompressedClassSpace) {
 76             output.shouldContain(&quot;Non-Class:&quot;);
 77             output.shouldContain(&quot;Class:&quot;);
 78         }
 79         output.shouldContain(&quot;Virtual space:&quot;);
 80         output.shouldContain(&quot;Chunk freelist&quot;);
 81         output.shouldContain(&quot;Waste&quot;);
 82         output.shouldMatch(&quot;MaxMetaspaceSize:.*201.00.*MB&quot;);
 83 
 84         pb.command(new String[] { JDKToolFinder.getJDKTool(&quot;jcmd&quot;), pid, &quot;VM.metaspace&quot;, &quot;show-loaders&quot;});
 85         output = new OutputAnalyzer(pb.start());
 86         output.shouldHaveExitValue(0);
 87         output.shouldMatch(&quot;CLD.*&lt;bootstrap&gt;&quot;);
 88 
 89         pb.command(new String[] { JDKToolFinder.getJDKTool(&quot;jcmd&quot;), pid, &quot;VM.metaspace&quot;, &quot;by-chunktype&quot;});
 90         output = new OutputAnalyzer(pb.start());
</pre>
</td>
<td>
<hr />
<pre>
 50 
 51 public class PrintMetaspaceDcmd {
 52 
 53     // Run jcmd VM.metaspace against a VM with CompressedClassPointers on.
 54     // The report should detail Non-Class and Class portions separately.
 55     private static void doTheTest(boolean usesCompressedClassSpace) throws Exception {
 56         ProcessBuilder pb = new ProcessBuilder();
 57         OutputAnalyzer output;
 58         // Grab my own PID
 59         String pid = Long.toString(ProcessTools.getProcessId());
 60 
 61         pb.command(new String[] { JDKToolFinder.getJDKTool(&quot;jcmd&quot;), pid, &quot;VM.metaspace&quot;, &quot;basic&quot;});
 62         output = new OutputAnalyzer(pb.start());
 63         output.shouldHaveExitValue(0);
 64         if (usesCompressedClassSpace) {
 65             output.shouldContain(&quot;Non-Class:&quot;);
 66             output.shouldContain(&quot;Class:&quot;);
 67         }
 68         output.shouldContain(&quot;Virtual space:&quot;);
 69         output.shouldContain(&quot;Chunk freelists:&quot;);
<span class="line-modified"> 70         output.shouldMatch(&quot;MaxMetaspaceSize:.*201.00.*MB&quot;);</span>
 71 
 72         pb.command(new String[] { JDKToolFinder.getJDKTool(&quot;jcmd&quot;), pid, &quot;VM.metaspace&quot;});
 73         output = new OutputAnalyzer(pb.start());
 74         output.shouldHaveExitValue(0);
 75         if (usesCompressedClassSpace) {
 76             output.shouldContain(&quot;Non-Class:&quot;);
 77             output.shouldContain(&quot;Class:&quot;);
 78         }
 79         output.shouldContain(&quot;Virtual space:&quot;);
 80         output.shouldContain(&quot;Chunk freelist&quot;);
 81         output.shouldContain(&quot;Waste&quot;);
 82         output.shouldMatch(&quot;MaxMetaspaceSize:.*201.00.*MB&quot;);
 83 
 84         pb.command(new String[] { JDKToolFinder.getJDKTool(&quot;jcmd&quot;), pid, &quot;VM.metaspace&quot;, &quot;show-loaders&quot;});
 85         output = new OutputAnalyzer(pb.start());
 86         output.shouldHaveExitValue(0);
 87         output.shouldMatch(&quot;CLD.*&lt;bootstrap&gt;&quot;);
 88 
 89         pb.command(new String[] { JDKToolFinder.getJDKTool(&quot;jcmd&quot;), pid, &quot;VM.metaspace&quot;, &quot;by-chunktype&quot;});
 90         output = new OutputAnalyzer(pb.start());
</pre>
</td>
</tr>
</table>
<center><a href="DefineClass.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../NMT/CheckForProperDetailStackTrace.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>