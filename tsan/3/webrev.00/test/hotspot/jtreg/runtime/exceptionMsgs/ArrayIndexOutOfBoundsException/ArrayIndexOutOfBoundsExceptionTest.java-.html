<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old test/hotspot/jtreg/runtime/exceptionMsgs/ArrayIndexOutOfBoundsException/ArrayIndexOutOfBoundsExceptionTest.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2018, 2019, Oracle and/or its affiliates. All rights reserved.
  3  * Copyright (c) 2018, 2019 SAP SE. All rights reserved.
  4  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  5  *
  6  * This code is free software; you can redistribute it and/or modify it
  7  * under the terms of the GNU General Public License version 2 only, as
  8  * published by the Free Software Foundation.
  9  *
 10  * This code is distributed in the hope that it will be useful, but WITHOUT
 11  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 12  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 13  * version 2 for more details (a copy is included in the LICENSE file that
 14  * accompanied this code).
 15  *
 16  * You should have received a copy of the GNU General Public License version
 17  * 2 along with this work; if not, write to the Free Software Foundation,
 18  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 19  *
 20  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 21  * or visit www.oracle.com if you need additional information or have any
 22  * questions.
 23  */
 24 
 25 /**
 26  * @test
 27  * @summary Test extended ArrayIndexOutOfBoundsException message. The
 28  *   message lists information about the array and the indexes involved.
 29  * @compile ArrayIndexOutOfBoundsExceptionTest.java
 30  * @run testng ArrayIndexOutOfBoundsExceptionTest
 31  * @run testng/othervm -Xcomp -XX:-TieredCompilation  ArrayIndexOutOfBoundsExceptionTest
 32  * @run testng/othervm -Xcomp -XX:TieredStopAtLevel=1 ArrayIndexOutOfBoundsExceptionTest
 33  */
 34 
 35 import java.io.ByteArrayInputStream;
 36 import java.io.ByteArrayOutputStream;
 37 import java.io.ObjectInputStream;
 38 import java.io.ObjectOutputStream;
 39 import java.util.ArrayList;
 40 
 41 import org.testng.annotations.Test;
 42 
 43 import static org.testng.Assert.assertEquals;
 44 import static org.testng.Assert.assertNull;
 45 import static org.testng.Assert.assertNotNull;
 46 import static org.testng.Assert.assertTrue;
 47 import static org.testng.Assert.fail;
 48 
 49 /**
 50  * Tests the detailed messages of the ArrayIndexOutOfBoundsException.
 51  */
 52 public class ArrayIndexOutOfBoundsExceptionTest {
 53 
 54     static {
 55         System.loadLibrary(&quot;ArrayIndexOutOfBoundsExceptionTest&quot;);
 56     }
 57 
 58     // Some fields used in the test.
 59     static int[] staticArray = new int[0];
 60     static long[][] staticLongArray = new long[0][0];
 61     ArrayList&lt;String&gt; names = new ArrayList&lt;&gt;();
 62     ArrayList&lt;String&gt; curr;
 63 
 64     public static void main(String[] args) {
 65         ArrayIndexOutOfBoundsExceptionTest t = new ArrayIndexOutOfBoundsExceptionTest();
 66         try {
 67             t.testAIOOBMessages();
 68         } catch (Exception e) {}
 69     }
 70 
 71     /**
 72      *
 73      */
 74     public static class ArrayGenerator {
 75 
 76         /**
 77          * @param dummy1
 78          * @return Object Array
 79          */
 80         public static Object[] arrayReturner(boolean dummy1) {
 81             return new Object[0];
 82         }
 83 
 84         /**
 85          * @param dummy1
 86          * @param dummy2
 87          * @param dummy3
 88          * @return Object Array
 89          */
 90         public Object[] returnMyArray(double dummy1, long dummy2, short dummy3) {
 91             return new Object[0];
 92         }
 93     }
 94 
 95     static native void  doNativeArrayStore(Object[] dst, Object element, int index);
 96     static native Object doNativeArrayLoad(Object[] src, int index);
 97 
 98     static native void doNativeBooleanArrayRegionLoad (boolean[] source, int start, int len);
 99     static native void doNativeBooleanArrayRegionStore(boolean[] source, int start, int len);
100     static native void doNativeByteArrayRegionLoad    (byte[] source,    int start, int len);
101     static native void doNativeByteArrayRegionStore   (byte[] source,    int start, int len);
102     static native void doNativeShortArrayRegionLoad   (short[] source,   int start, int len);
103     static native void doNativeShortArrayRegionStore  (short[] source,   int start, int len);
104     static native void doNativeCharArrayRegionLoad    (char[] source,    int start, int len);
105     static native void doNativeCharArrayRegionStore   (char[] source,    int start, int len);
106     static native void doNativeIntArrayRegionLoad     (int[] source,     int start, int len);
107     static native void doNativeIntArrayRegionStore    (int[] source,     int start, int len);
108     static native void doNativeLongArrayRegionLoad    (long[] source,    int start, int len);
109     static native void doNativeLongArrayRegionStore   (long[] source,    int start, int len);
110     static native void doNativeFloatArrayRegionLoad   (float[] source,   int start, int len);
111     static native void doNativeFloatArrayRegionStore  (float[] source,   int start, int len);
112     static native void doNativeDoubleArrayRegionLoad  (double[] source,  int start, int len);
113     static native void doNativeDoubleArrayRegionStore (double[] source,  int start, int len);
114 
115     /**
116      *
117      */
118     @Test
119     public void testAIOOBMessages() {
120         boolean[] za1 = new boolean[0];
121         byte[]    ba1 = new byte[0];
122         short[]   sa1 = new short[0];
123         char[]    ca1 = new char[0];
124         int[]     ia1 = new int[0];
125         long[]    la1 = new long[0];
126         float[]   fa1 = new float[0];
127         double[]  da1 = new double[0];
128         Object[]  oa1 = new Object[10];
129         Object[]  oa2 = new Object[5];
130 
131         boolean[] za2 = new boolean[10];
132         boolean[] za3 = new boolean[5];
133         byte[]    ba2 = new byte[10];
134         byte[]    ba3 = new byte[5];
135         short[]   sa2 = new short[10];
136         short[]   sa3 = new short[5];
137         char[]    ca2 = new char[10];
138         char[]    ca3 = new char[5];
139         int[]     ia2 = new int[10];
140         int[]     ia3 = new int[5];
141         long[]    la2 = new long[10];
142         long[]    la3 = new long[5];
143         float[]   fa2 = new float[10];
144         float[]   fa3 = new float[5];
145         double[]  da2 = new double[10];
146         double[]  da3 = new double[5];
147 
148         try {
149             System.out.println(za1[-5]);
150             fail();
151         }
152         catch (ArrayIndexOutOfBoundsException e) {
153             assertEquals(e.getMessage(),
154                 &quot;Index -5 out of bounds for length 0&quot;);
155         }
156 
157         try {
158             System.out.println(ba1[0]);
159             fail();
160         }
161         catch (ArrayIndexOutOfBoundsException e) {
162             assertEquals(e.getMessage(),
163                 &quot;Index 0 out of bounds for length 0&quot;);
164         }
165 
166         try {
167             System.out.println(sa1[0]);
168             fail();
169         }
170         catch (ArrayIndexOutOfBoundsException e) {
171             assertEquals(e.getMessage(),
172                 &quot;Index 0 out of bounds for length 0&quot;);
173         }
174 
175         try {
176             System.out.println(ca1[0]);
177             fail();
178         }
179         catch (ArrayIndexOutOfBoundsException e) {
180             assertEquals(e.getMessage(),
181                 &quot;Index 0 out of bounds for length 0&quot;);
182         }
183 
184         try {
185             System.out.println(ia1[0]);
186             fail();
187         }
188         catch (ArrayIndexOutOfBoundsException e) {
189             assertEquals(e.getMessage(),
190                 &quot;Index 0 out of bounds for length 0&quot;);
191         }
192 
193         try {
194             System.out.println(la1[0]);
195             fail();
196         }
197         catch (ArrayIndexOutOfBoundsException e) {
198             assertEquals(e.getMessage(),
199                 &quot;Index 0 out of bounds for length 0&quot;);
200         }
201 
202         try {
203             System.out.println(fa1[0]);
204             fail();
205         }
206         catch (ArrayIndexOutOfBoundsException e) {
207             assertEquals(e.getMessage(),
208                 &quot;Index 0 out of bounds for length 0&quot;);
209         }
210 
211         try {
212             System.out.println(da1[0]);
213             fail();
214         }
215         catch (ArrayIndexOutOfBoundsException e) {
216             assertEquals(e.getMessage(),
217                 &quot;Index 0 out of bounds for length 0&quot;);
218         }
219 
220         try {
221             System.out.println(oa1[12]);
222             fail();
223         }
224         catch (ArrayIndexOutOfBoundsException e) {
225             assertEquals(e.getMessage(),
226                 &quot;Index 12 out of bounds for length 10&quot;);
227         }
228 
229         try {
230             System.out.println(za1[0] = false);
231             fail();
232         }
233         catch (ArrayIndexOutOfBoundsException e) {
234             assertEquals(e.getMessage(),
235                 &quot;Index 0 out of bounds for length 0&quot;);
236         }
237 
238         try {
239             System.out.println(ba1[0] = 0);
240             fail();
241         }
242         catch (ArrayIndexOutOfBoundsException e) {
243             assertEquals(e.getMessage(),
244                 &quot;Index 0 out of bounds for length 0&quot;);
245         }
246 
247         try {
248             System.out.println(sa1[0] = 0);
249             fail();
250         }
251         catch (ArrayIndexOutOfBoundsException e) {
252             assertEquals(e.getMessage(),
253                 &quot;Index 0 out of bounds for length 0&quot;);
254         }
255 
256         try {
257             System.out.println(ca1[0] = 0);
258             fail();
259         }
260         catch (ArrayIndexOutOfBoundsException e) {
261             assertEquals(e.getMessage(),
262                 &quot;Index 0 out of bounds for length 0&quot;);
263         }
264 
265         try {
266             System.out.println(ia1[0] = 0);
267             fail();
268         }
269         catch (ArrayIndexOutOfBoundsException e) {
270             assertEquals(e.getMessage(),
271                 &quot;Index 0 out of bounds for length 0&quot;);
272         }
273 
274         try {
275             System.out.println(la1[0] = 0);
276             fail();
277         }
278         catch (ArrayIndexOutOfBoundsException e) {
279             assertEquals(e.getMessage(),
280                 &quot;Index 0 out of bounds for length 0&quot;);
281         }
282 
283         try {
284             System.out.println(fa1[0] = 0);
285             fail();
286         }
287         catch (ArrayIndexOutOfBoundsException e) {
288             assertEquals(e.getMessage(),
289                 &quot;Index 0 out of bounds for length 0&quot;);
290         }
291 
292         try {
293             System.out.println(da1[0] = 0);
294             fail();
295         }
296         catch (ArrayIndexOutOfBoundsException e) {
297             assertEquals(e.getMessage(),
298                 &quot;Index 0 out of bounds for length 0&quot;);
299         }
300 
301         try {
302             System.out.println(oa1[-2] = null);
303             fail();
304         }
305         catch (ArrayIndexOutOfBoundsException e) {
306             assertEquals(e.getMessage(),
307                 &quot;Index -2 out of bounds for length 10&quot;);
308         }
309 
310         try {
311             assertTrue((ArrayGenerator.arrayReturner(false))[0] == null);
312             fail();
313         } catch (ArrayIndexOutOfBoundsException e) {
314             assertEquals(e.getMessage(),
315                 &quot;Index 0 out of bounds for length 0&quot;);
316         }
317         try {
318             staticArray[0] = 2;
319             fail();
320         } catch (ArrayIndexOutOfBoundsException e) {
321             assertEquals(e.getMessage(),
322                 &quot;Index 0 out of bounds for length 0&quot;);
323         }
324 
325         // Test all five possible messages of arraycopy exceptions thrown in ObjArrayKlass::copy_array().
326 
327         try {
328             System.arraycopy(oa1, -17, oa2, 0, 5);
329             fail();
330         } catch (ArrayIndexOutOfBoundsException e) {
331             assertEquals(e.getMessage(),
332                 &quot;arraycopy: source index -17 out of bounds for object array[10]&quot;);
333         }
334 
335         try {
336             System.arraycopy(oa1, 2, oa2, -18, 5);
337             fail();
338         } catch (ArrayIndexOutOfBoundsException e) {
339             assertEquals(e.getMessage(),
340                 &quot;arraycopy: destination index -18 out of bounds for object array[5]&quot;);
341         }
342 
343         try {
344             System.arraycopy(oa1, 2, oa2, 0, -19);
345             fail();
346         } catch (ArrayIndexOutOfBoundsException e) {
347             assertEquals(e.getMessage(),
348                 &quot;arraycopy: length -19 is negative&quot;);
349         }
350 
351         try {
352             System.arraycopy(oa1, 8, oa2, 0, 5);
353             fail();
354         } catch (ArrayIndexOutOfBoundsException e) {
355             assertEquals(e.getMessage(),
356                 &quot;arraycopy: last source index 13 out of bounds for object array[10]&quot;);
357         }
358 
359         try {
360             System.arraycopy(oa1, 1, oa2, 0, 7);
361             fail();
362         } catch (ArrayIndexOutOfBoundsException e) {
363             assertEquals(e.getMessage(),
364                 &quot;arraycopy: last destination index 7 out of bounds for object array[5]&quot;);
365         }
366 
367         // Test all five possible messages of arraycopy exceptions thrown in TypeArrayKlass::copy_array().
368 
369         try {
370             System.arraycopy(da2, -17, da3, 0, 5);
371             fail();
372         } catch (ArrayIndexOutOfBoundsException e) {
373             assertEquals(e.getMessage(),
374                 &quot;arraycopy: source index -17 out of bounds for double[10]&quot;);
375         }
376 
377         try {
378             System.arraycopy(da2, 2, da3, -18, 5);
379             fail();
380         } catch (ArrayIndexOutOfBoundsException e) {
381             assertEquals(e.getMessage(),
382                 &quot;arraycopy: destination index -18 out of bounds for double[5]&quot;);
383         }
384 
385         try {
386             System.arraycopy(da2, 2, da3, 0, -19);
387             fail();
388         } catch (ArrayIndexOutOfBoundsException e) {
389             assertEquals(e.getMessage(),
390                 &quot;arraycopy: length -19 is negative&quot;);
391         }
392 
393         try {
394             System.arraycopy(da2, 8, da3, 0, 5);
395             fail();
396         } catch (ArrayIndexOutOfBoundsException e) {
397             assertEquals(e.getMessage(),
398                 &quot;arraycopy: last source index 13 out of bounds for double[10]&quot;);
399         }
400 
401         try {
402             System.arraycopy(da2, 1, da3, 0, 7);
403             fail();
404         } catch (ArrayIndexOutOfBoundsException e) {
405             assertEquals(e.getMessage(),
406                 &quot;arraycopy: last destination index 7 out of bounds for double[5]&quot;);
407         }
408 
409         // Test all possible basic types in the messages of arraycopy exceptions thrown in TypeArrayKlass::copy_array().
410 
411         try {
412             System.arraycopy(za2, -17, za3, 0, 5);
413             fail();
414         } catch (ArrayIndexOutOfBoundsException e) {
415             assertEquals(e.getMessage(),
416                 &quot;arraycopy: source index -17 out of bounds for boolean[10]&quot;);
417         }
418 
419         try {
420             System.arraycopy(ba2, 2, ba3, -18, 5);
421             fail();
422         } catch (ArrayIndexOutOfBoundsException e) {
423             assertEquals(e.getMessage(),
424                 &quot;arraycopy: destination index -18 out of bounds for byte[5]&quot;);
425         }
426 
427         try {
428             System.arraycopy(sa2, 2, sa3, 0, -19);
429             fail();
430         } catch (ArrayIndexOutOfBoundsException e) {
431             assertEquals(e.getMessage(),
432                 &quot;arraycopy: length -19 is negative&quot;);
433         }
434 
435         try {
436             System.arraycopy(ca2, 8, ca3, 0, 5);
437             fail();
438         } catch (ArrayIndexOutOfBoundsException e) {
439             assertEquals(e.getMessage(),
440                 &quot;arraycopy: last source index 13 out of bounds for char[10]&quot;);
441         }
442 
443         try {
444             System.arraycopy(ia2, 2, ia3, 0, -19);
445             fail();
446         } catch (ArrayIndexOutOfBoundsException e) {
447             assertEquals(e.getMessage(),
448                 &quot;arraycopy: length -19 is negative&quot;);
449         }
450 
451         try {
452             System.arraycopy(la2, 1, la3, 0, 7);
453             fail();
454         } catch (ArrayIndexOutOfBoundsException e) {
455             assertEquals(e.getMessage(),
456                 &quot;arraycopy: last destination index 7 out of bounds for long[5]&quot;);
457         }
458 
459         try {
460             System.arraycopy(fa2, 1, fa3, 0, 7);
461             fail();
462         } catch (ArrayIndexOutOfBoundsException e) {
463             assertEquals(e.getMessage(),
464                 &quot;arraycopy: last destination index 7 out of bounds for float[5]&quot;);
465         }
466 
467 
468         // Test native array access.
469 
470 
471         try {
472             System.out.println(doNativeArrayLoad(oa2, 77));
473             fail();
474         } catch (ArrayIndexOutOfBoundsException e) {
475             assertEquals(e.getMessage(),
476                 &quot;Index 77 out of bounds for length 5&quot;);
477         }
478         try {
479             System.out.println(doNativeArrayLoad(oa1, -1));
480             fail();
481         } catch (ArrayIndexOutOfBoundsException e) {
482             assertEquals(e.getMessage(),
483                 &quot;Index -1 out of bounds for length 10&quot;);
484         }
485 
486         try {
487             doNativeArrayStore(oa1, &quot;Some String&quot;, Integer.MIN_VALUE);
488             fail();
489         } catch (ArrayIndexOutOfBoundsException e) {
490             assertEquals(e.getMessage(),
491                 &quot;Index -2147483648 out of bounds for length 10&quot;);
492         }
493         try {
494             doNativeArrayStore(oa1, &quot;Some String&quot;, 13);
495             fail();
496         } catch (ArrayIndexOutOfBoundsException e) {
497             assertEquals(e.getMessage(),
498                 &quot;Index 13 out of bounds for length 10&quot;);
499         }
500 
501         // Boolean
502 
503         // Native array region loads.
504         // Boolean, len negative.
505         try {
506             doNativeBooleanArrayRegionLoad(za2, 3, -77);
507             fail();
508         } catch (ArrayIndexOutOfBoundsException e) {
509             assertEquals(e.getMessage(),
510                 &quot;Length -77 is negative&quot;);
511         }
512         // Boolean, index negative.
513         try {
514             doNativeBooleanArrayRegionLoad(za2, -3, 3);
515             fail();
516         } catch (ArrayIndexOutOfBoundsException e) {
517             assertEquals(e.getMessage(),
518                 &quot;Array region -3..0 out of bounds for length 10&quot;);
519         }
520         // Boolean, index+len too big.
521         try {
522             doNativeBooleanArrayRegionLoad(za2, 3, Integer.MAX_VALUE-1);
523             fail();
524         } catch (ArrayIndexOutOfBoundsException e) {
525             assertEquals(e.getMessage(),
526                 &quot;Array region 3..2147483649 out of bounds for length 10&quot;);
527         }
528         // Native array region stores
529         // Boolean, len negative.
530         try {
531             doNativeBooleanArrayRegionStore(za2, 3, -77);
532             fail();
533         } catch (ArrayIndexOutOfBoundsException e) {
534             assertEquals(e.getMessage(),
535                 &quot;Length -77 is negative&quot;);
536         }
537         // Boolean, index negative.
538         try {
539             doNativeBooleanArrayRegionStore(za2, -3, 3);
540             fail();
541         } catch (ArrayIndexOutOfBoundsException e) {
542             assertEquals(e.getMessage(),
543                 &quot;Array region -3..0 out of bounds for length 10&quot;);
544         }
545         // Boolean, index+len too big.
546         try {
547             doNativeBooleanArrayRegionStore(za2, 3, Integer.MAX_VALUE);
548             fail();
549         } catch (ArrayIndexOutOfBoundsException e) {
550             assertEquals(e.getMessage(),
551                 &quot;Array region 3..2147483650 out of bounds for length 10&quot;);
552         }
553 
554         // Byte
555 
556         // Native array region loads.
557         // Byte, len negative.
558         try {
559             doNativeByteArrayRegionLoad(ba1, 3, -77);
560             fail();
561         } catch (ArrayIndexOutOfBoundsException e) {
562             assertEquals(e.getMessage(),
563                 &quot;Length -77 is negative&quot;);
564         }
565         // Byte, index negative.
566         try {
567             doNativeByteArrayRegionLoad(ba1, -3, 3);
568             fail();
569         } catch (ArrayIndexOutOfBoundsException e) {
570             assertEquals(e.getMessage(),
571                 &quot;Array region -3..0 out of bounds for length 0&quot;);
572         }
573         // Byte, index+len too big.
574         try {
575             doNativeByteArrayRegionLoad(ba2, 3, Integer.MAX_VALUE-1);
576             fail();
577         } catch (ArrayIndexOutOfBoundsException e) {
578             assertEquals(e.getMessage(),
579                 &quot;Array region 3..2147483649 out of bounds for length 10&quot;);
580         }
581         // Native array region stores
582         // Byte, len negative.
583         try {
584             doNativeByteArrayRegionStore(ba2, 3, -77);
585             fail();
586         } catch (ArrayIndexOutOfBoundsException e) {
587             assertEquals(e.getMessage(),
588                 &quot;Length -77 is negative&quot;);
589         }
590         // Byte, index negative.
591         try {
592             doNativeByteArrayRegionStore(ba2, -3, 3);
593             fail();
594         } catch (ArrayIndexOutOfBoundsException e) {
595             assertEquals(e.getMessage(),
596                 &quot;Array region -3..0 out of bounds for length 10&quot;);
597         }
598         // Byte, index+len too big.
599         try {
600             doNativeByteArrayRegionStore(ba2, 3, Integer.MAX_VALUE);
601             fail();
602         } catch (ArrayIndexOutOfBoundsException e) {
603             assertEquals(e.getMessage(),
604                 &quot;Array region 3..2147483650 out of bounds for length 10&quot;);
605         }
606 
607         // Short
608 
609         // Native array region loads.
610         // Short, len negative.
611         try {
612             doNativeShortArrayRegionLoad(sa2, 3, -77);
613             fail();
614         } catch (ArrayIndexOutOfBoundsException e) {
615             assertEquals(e.getMessage(),
616                 &quot;Length -77 is negative&quot;);
617         }
618         // Short, index negative.
619         try {
620             doNativeShortArrayRegionLoad(sa2, -3, 3);
621             fail();
622         } catch (ArrayIndexOutOfBoundsException e) {
623             assertEquals(e.getMessage(),
624                 &quot;Array region -3..0 out of bounds for length 10&quot;);
625         }
626         // Short, index+len too big.
627         try {
628             doNativeShortArrayRegionLoad(sa2, 3, Integer.MAX_VALUE-1);
629             fail();
630         } catch (ArrayIndexOutOfBoundsException e) {
631             assertEquals(e.getMessage(),
632                 &quot;Array region 3..2147483649 out of bounds for length 10&quot;);
633         }
634         // Native array region stores
635         // Short, len negative.
636         try {
637             doNativeShortArrayRegionStore(sa2, 3, -77);
638             fail();
639         } catch (ArrayIndexOutOfBoundsException e) {
640             assertEquals(e.getMessage(),
641                 &quot;Length -77 is negative&quot;);
642         }
643         // Short, index negative.
644         try {
645             doNativeShortArrayRegionStore(sa2, -3, 3);
646             fail();
647         } catch (ArrayIndexOutOfBoundsException e) {
648             assertEquals(e.getMessage(),
649                 &quot;Array region -3..0 out of bounds for length 10&quot;);
650         }
651         // Short, index+len too big.
652         try {
653             doNativeShortArrayRegionStore(sa2, 3, Integer.MAX_VALUE);
654             fail();
655         } catch (ArrayIndexOutOfBoundsException e) {
656             assertEquals(e.getMessage(),
657                 &quot;Array region 3..2147483650 out of bounds for length 10&quot;);
658         }
659 
660         // Char
661 
662         // Native array region loads.
663         // Char, len negative.
664         try {
665             doNativeCharArrayRegionLoad(ca2, 3, -77);
666             fail();
667         } catch (ArrayIndexOutOfBoundsException e) {
668             assertEquals(e.getMessage(),
669                 &quot;Length -77 is negative&quot;);
670         }
671         // Char, index negative.
672         try {
673             doNativeCharArrayRegionLoad(ca2, -3, 3);
674             fail();
675         } catch (ArrayIndexOutOfBoundsException e) {
676             assertEquals(e.getMessage(),
677                 &quot;Array region -3..0 out of bounds for length 10&quot;);
678         }
679         // Char, index+len too big.
680         try {
681             doNativeCharArrayRegionLoad(ca2, 3, Integer.MAX_VALUE-1);
682             fail();
683         } catch (ArrayIndexOutOfBoundsException e) {
684             assertEquals(e.getMessage(),
685                 &quot;Array region 3..2147483649 out of bounds for length 10&quot;);
686         }
687         // Native array region stores
688         // Char, len negative.
689         try {
690             doNativeCharArrayRegionStore(ca2, 3, -77);
691             fail();
692         } catch (ArrayIndexOutOfBoundsException e) {
693             assertEquals(e.getMessage(),
694                 &quot;Length -77 is negative&quot;);
695         }
696         // Char, index negative.
697         try {
698             doNativeCharArrayRegionStore(ca2, -3, 3);
699             fail();
700         } catch (ArrayIndexOutOfBoundsException e) {
701             assertEquals(e.getMessage(),
702                 &quot;Array region -3..0 out of bounds for length 10&quot;);
703         }
704         // Char, index+len too big.
705         try {
706             doNativeCharArrayRegionStore(ca2, 3, Integer.MAX_VALUE);
707             fail();
708         } catch (ArrayIndexOutOfBoundsException e) {
709             assertEquals(e.getMessage(),
710                 &quot;Array region 3..2147483650 out of bounds for length 10&quot;);
711         }
712 
713         // Int
714 
715         // Native array region loads.
716         // Int, len negative.
717         try {
718             doNativeIntArrayRegionLoad(ia2, 3, -77);
719             fail();
720         } catch (ArrayIndexOutOfBoundsException e) {
721             assertEquals(e.getMessage(),
722                 &quot;Length -77 is negative&quot;);
723         }
724         // Int, index negative.
725         try {
726             doNativeIntArrayRegionLoad(ia2, -3, 3);
727             fail();
728         } catch (ArrayIndexOutOfBoundsException e) {
729             assertEquals(e.getMessage(),
730                 &quot;Array region -3..0 out of bounds for length 10&quot;);
731         }
732         // Int, index+len too big.
733         try {
734             doNativeIntArrayRegionLoad(ia2, 3, Integer.MAX_VALUE-1);
735             fail();
736         } catch (ArrayIndexOutOfBoundsException e) {
737             assertEquals(e.getMessage(),
738                 &quot;Array region 3..2147483649 out of bounds for length 10&quot;);
739         }
740         // Native array region stores
741         // Int, len negative.
742         try {
743             doNativeIntArrayRegionStore(ia2, 3, -77);
744             fail();
745         } catch (ArrayIndexOutOfBoundsException e) {
746             assertEquals(e.getMessage(),
747                 &quot;Length -77 is negative&quot;);
748         }
749         // Int, index negative.
750         try {
751             doNativeIntArrayRegionStore(ia2, -3, 3);
752             fail();
753         } catch (ArrayIndexOutOfBoundsException e) {
754             assertEquals(e.getMessage(),
755                 &quot;Array region -3..0 out of bounds for length 10&quot;);
756         }
757         // Int, index+len too big.
758         try {
759             doNativeIntArrayRegionStore(ia2, 3, Integer.MAX_VALUE);
760             fail();
761         } catch (ArrayIndexOutOfBoundsException e) {
762             assertEquals(e.getMessage(),
763                 &quot;Array region 3..2147483650 out of bounds for length 10&quot;);
764         }
765 
766         // Long
767 
768         // Native array region loads.
769         // Long, len negative.
770         try {
771             doNativeLongArrayRegionLoad(la2, 3, -77);
772             fail();
773         } catch (ArrayIndexOutOfBoundsException e) {
774             assertEquals(e.getMessage(),
775                 &quot;Length -77 is negative&quot;);
776         }
777         // Long, index negative.
778         try {
779             doNativeLongArrayRegionLoad(la2, -3, 3);
780             fail();
781         } catch (ArrayIndexOutOfBoundsException e) {
782             assertEquals(e.getMessage(),
783                 &quot;Array region -3..0 out of bounds for length 10&quot;);
784         }
785         // Long, index+len too big.
786         try {
787             doNativeLongArrayRegionLoad(la2, 3, Integer.MAX_VALUE-1);
788             fail();
789         } catch (ArrayIndexOutOfBoundsException e) {
790             assertEquals(e.getMessage(),
791                 &quot;Array region 3..2147483649 out of bounds for length 10&quot;);
792         }
793         // Native array region stores
794         // Long, len negative.
795         try {
796             doNativeLongArrayRegionStore(la2, 3, -77);
797             fail();
798         } catch (ArrayIndexOutOfBoundsException e) {
799             assertEquals(e.getMessage(),
800                 &quot;Length -77 is negative&quot;);
801         }
802         // Long, index negative.
803         try {
804             doNativeLongArrayRegionStore(la2, -3, 3);
805             fail();
806         } catch (ArrayIndexOutOfBoundsException e) {
807             assertEquals(e.getMessage(),
808                 &quot;Array region -3..0 out of bounds for length 10&quot;);
809         }
810         // Long, index+len too big.
811         try {
812             doNativeLongArrayRegionStore(la2, 3, Integer.MAX_VALUE);
813             fail();
814         } catch (ArrayIndexOutOfBoundsException e) {
815             assertEquals(e.getMessage(),
816                 &quot;Array region 3..2147483650 out of bounds for length 10&quot;);
817         }
818 
819         // Float
820 
821         // Native array region loads.
822         // Float, len negative.
823         try {
824             doNativeFloatArrayRegionLoad(fa2, 3, -77);
825             fail();
826         } catch (ArrayIndexOutOfBoundsException e) {
827             assertEquals(e.getMessage(),
828                 &quot;Length -77 is negative&quot;);
829         }
830         // Float, index negative.
831         try {
832             doNativeFloatArrayRegionLoad(fa2, -3, 3);
833             fail();
834         } catch (ArrayIndexOutOfBoundsException e) {
835             assertEquals(e.getMessage(),
836                 &quot;Array region -3..0 out of bounds for length 10&quot;);
837         }
838         // Float, index+len too big.
839         try {
840             doNativeFloatArrayRegionLoad(fa2, 3, Integer.MAX_VALUE-1);
841             fail();
842         } catch (ArrayIndexOutOfBoundsException e) {
843             assertEquals(e.getMessage(),
844                 &quot;Array region 3..2147483649 out of bounds for length 10&quot;);
845         }
846         // Native array region stores
847         // Float, len negative.
848         try {
849             doNativeFloatArrayRegionStore(fa2, 3, -77);
850             fail();
851         } catch (ArrayIndexOutOfBoundsException e) {
852             assertEquals(e.getMessage(),
853                 &quot;Length -77 is negative&quot;);
854         }
855         // Float, index negative.
856         try {
857             doNativeFloatArrayRegionStore(fa2, -3, 3);
858             fail();
859         } catch (ArrayIndexOutOfBoundsException e) {
860             assertEquals(e.getMessage(),
861                 &quot;Array region -3..0 out of bounds for length 10&quot;);
862         }
863         // Float, index+len too big.
864         try {
865             doNativeFloatArrayRegionStore(fa2, 3, Integer.MAX_VALUE);
866             fail();
867         } catch (ArrayIndexOutOfBoundsException e) {
868             assertEquals(e.getMessage(),
869                 &quot;Array region 3..2147483650 out of bounds for length 10&quot;);
870         }
871 
872         // Double
873 
874         // Native array region loads.
875         // Double, len negative.
876         try {
877             doNativeDoubleArrayRegionLoad(da2, 3, -77);
878             fail();
879         } catch (ArrayIndexOutOfBoundsException e) {
880             assertEquals(e.getMessage(),
881                 &quot;Length -77 is negative&quot;);
882         }
883         // Double, index negative.
884         try {
885             doNativeDoubleArrayRegionLoad(da2, -3, 3);
886             fail();
887         } catch (ArrayIndexOutOfBoundsException e) {
888             assertEquals(e.getMessage(),
889                 &quot;Array region -3..0 out of bounds for length 10&quot;);
890         }
891         // Double, index+len too big.
892         try {
893             doNativeDoubleArrayRegionLoad(da2, 3, Integer.MAX_VALUE-1);
894             fail();
895         } catch (ArrayIndexOutOfBoundsException e) {
896             assertEquals(e.getMessage(),
897                 &quot;Array region 3..2147483649 out of bounds for length 10&quot;);
898         }
899         // Native array region stores
900         // Double, len negative.
901         try {
902             doNativeDoubleArrayRegionStore(da2, 3, -77);
903             fail();
904         } catch (ArrayIndexOutOfBoundsException e) {
905             assertEquals(e.getMessage(),
906                 &quot;Length -77 is negative&quot;);
907         }
908         // Double, index negative.
909         try {
910             doNativeDoubleArrayRegionStore(da2, -3, 3);
911             fail();
912         } catch (ArrayIndexOutOfBoundsException e) {
913             assertEquals(e.getMessage(),
914                 &quot;Array region -3..0 out of bounds for length 10&quot;);
915         }
916         // Double, index+len too big.
917         try {
918             doNativeDoubleArrayRegionStore(da2, 3, Integer.MAX_VALUE);
919             fail();
920         } catch (ArrayIndexOutOfBoundsException e) {
921             assertEquals(e.getMessage(),
922                 &quot;Array region 3..2147483650 out of bounds for length 10&quot;);
923         }
924     }
925 }
    </pre>
  </body>
</html>