<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/runtime/CompressedOops/UseCompressedOops.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="CompressedClassPointers.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../CreateMirror/ArraysNewInstanceBug.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/runtime/CompressedOops/UseCompressedOops.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 41 
 42 import sun.hotspot.code.Compiler;
 43 
 44 public class UseCompressedOops {
 45 
 46     public static void main(String[] args) throws Exception {
 47         testCompressedOopsModesGCs();
 48         if (!Platform.isOSX() &amp;&amp; !Platform.isAix()) {
 49             testCompressedOopsModesGCs(&quot;-XX:+UseLargePages&quot;);
 50         }
 51     }
 52 
 53     public static void testCompressedOopsModesGCs(String... flags) throws Exception {
 54         ArrayList&lt;String&gt; args = new ArrayList&lt;&gt;();
 55         Collections.addAll(args, flags);
 56 
 57         // Test default.
 58         testCompressedOopsModes(args);
 59         // Test GCs.
 60         testCompressedOopsModes(args, &quot;-XX:+UseG1GC&quot;);
<span class="line-removed"> 61         if (!Compiler.isGraalEnabled()) { // Graal does not support CMS</span>
<span class="line-removed"> 62             testCompressedOopsModes(args, &quot;-XX:+UseConcMarkSweepGC&quot;);</span>
<span class="line-removed"> 63         }</span>
 64         testCompressedOopsModes(args, &quot;-XX:+UseSerialGC&quot;);
 65         testCompressedOopsModes(args, &quot;-XX:+UseParallelGC&quot;);
<span class="line-removed"> 66         testCompressedOopsModes(args, &quot;-XX:+UseParallelOldGC&quot;);</span>
 67         if (GC.Shenandoah.isSupported()) {
 68             testCompressedOopsModes(args, &quot;-XX:+UnlockExperimentalVMOptions&quot;, &quot;-XX:+UseShenandoahGC&quot;);
 69         }
 70     }
 71 
 72     public static void testCompressedOopsModes(ArrayList&lt;String&gt; flags1, String... flags2) throws Exception {
 73         ArrayList&lt;String&gt; args = new ArrayList&lt;&gt;();
 74         args.addAll(flags1);
 75         Collections.addAll(args, flags2);
 76 
 77         if (Platform.is64bit()) {
 78             // Explicitly turn off compressed oops
 79             testCompressedOops(args, &quot;-XX:-UseCompressedOops&quot;, &quot;-Xmx32m&quot;)
 80                 .shouldNotContain(&quot;Compressed Oops&quot;)
 81                 .shouldHaveExitValue(0);
 82 
 83             // Compressed oops should be on by default
 84             testCompressedOops(args, &quot;-Xmx32m&quot;)
 85                 .shouldContain(&quot;Compressed Oops mode&quot;)
 86                 .shouldHaveExitValue(0);
</pre>
</td>
<td>
<hr />
<pre>
 41 
 42 import sun.hotspot.code.Compiler;
 43 
 44 public class UseCompressedOops {
 45 
 46     public static void main(String[] args) throws Exception {
 47         testCompressedOopsModesGCs();
 48         if (!Platform.isOSX() &amp;&amp; !Platform.isAix()) {
 49             testCompressedOopsModesGCs(&quot;-XX:+UseLargePages&quot;);
 50         }
 51     }
 52 
 53     public static void testCompressedOopsModesGCs(String... flags) throws Exception {
 54         ArrayList&lt;String&gt; args = new ArrayList&lt;&gt;();
 55         Collections.addAll(args, flags);
 56 
 57         // Test default.
 58         testCompressedOopsModes(args);
 59         // Test GCs.
 60         testCompressedOopsModes(args, &quot;-XX:+UseG1GC&quot;);



 61         testCompressedOopsModes(args, &quot;-XX:+UseSerialGC&quot;);
 62         testCompressedOopsModes(args, &quot;-XX:+UseParallelGC&quot;);

 63         if (GC.Shenandoah.isSupported()) {
 64             testCompressedOopsModes(args, &quot;-XX:+UnlockExperimentalVMOptions&quot;, &quot;-XX:+UseShenandoahGC&quot;);
 65         }
 66     }
 67 
 68     public static void testCompressedOopsModes(ArrayList&lt;String&gt; flags1, String... flags2) throws Exception {
 69         ArrayList&lt;String&gt; args = new ArrayList&lt;&gt;();
 70         args.addAll(flags1);
 71         Collections.addAll(args, flags2);
 72 
 73         if (Platform.is64bit()) {
 74             // Explicitly turn off compressed oops
 75             testCompressedOops(args, &quot;-XX:-UseCompressedOops&quot;, &quot;-Xmx32m&quot;)
 76                 .shouldNotContain(&quot;Compressed Oops&quot;)
 77                 .shouldHaveExitValue(0);
 78 
 79             // Compressed oops should be on by default
 80             testCompressedOops(args, &quot;-Xmx32m&quot;)
 81                 .shouldContain(&quot;Compressed Oops mode&quot;)
 82                 .shouldHaveExitValue(0);
</pre>
</td>
</tr>
</table>
<center><a href="CompressedClassPointers.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../CreateMirror/ArraysNewInstanceBug.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>