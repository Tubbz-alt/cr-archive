<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/hotspot/jtreg/runtime/Safepoint/TestAbortVMOnSafepointTimeout.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../Nestmates/privateMethods/TestInvokeErrors.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../StackGuardPages/exeinvoke.c.udiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/runtime/Safepoint/TestAbortVMOnSafepointTimeout.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -25,11 +25,11 @@</span>
  import jdk.test.lib.process.*;
  
  /*
   * @test TestAbortVMOnSafepointTimeout
   * @summary Check if VM can kill thread which doesn&#39;t reach safepoint.
<span class="udiff-line-modified-removed">-  * @bug 8219584</span>
<span class="udiff-line-modified-added">+  * @bug 8219584 8227528</span>
   * @requires vm.compiler2.enabled
   * @library /test/lib
   * @modules java.base/jdk.internal.misc
   *          java.management
   */
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -56,12 +56,20 @@</span>
          }
          return sum;
      }
  
      public static void testWith(int sfpt_interval, int timeout_delay) throws Exception {
<span class="udiff-line-added">+         // -XX:-UseCountedLoopSafepoints - is used to prevent the loop</span>
<span class="udiff-line-added">+         // in test_loop() to poll for safepoints.</span>
<span class="udiff-line-added">+         // -XX:LoopStripMiningIter=0 and -XX:LoopUnrollLimit=0 - are</span>
<span class="udiff-line-added">+         // used to prevent optimizations over the loop in test_loop()</span>
<span class="udiff-line-added">+         // since we actually want it to provoke a safepoint timeout.</span>
<span class="udiff-line-added">+         // -XX:-UseBiasedLocking - is used to prevent biased locking</span>
<span class="udiff-line-added">+         // handshakes from changing the timing of this test.</span>
          ProcessBuilder pb = ProcessTools.createJavaProcessBuilder(
                  &quot;-XX:+UnlockDiagnosticVMOptions&quot;,
<span class="udiff-line-added">+                 &quot;-XX:-UseBiasedLocking&quot;,</span>
                  &quot;-XX:+SafepointTimeout&quot;,
                  &quot;-XX:+SafepointALot&quot;,
                  &quot;-XX:+AbortVMOnSafepointTimeout&quot;,
                  &quot;-XX:SafepointTimeoutDelay=&quot; + timeout_delay,
                  &quot;-XX:GuaranteedSafepointInterval=&quot; + sfpt_interval,
</pre>
<center><a href="../Nestmates/privateMethods/TestInvokeErrors.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../StackGuardPages/exeinvoke.c.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>