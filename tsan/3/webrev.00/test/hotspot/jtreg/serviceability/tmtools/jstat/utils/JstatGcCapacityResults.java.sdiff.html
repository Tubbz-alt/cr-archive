<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/serviceability/tmtools/jstat/utils/JstatGcCapacityResults.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../sa/sadebugd/SADebugDTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../share/common/ToolRunner.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/serviceability/tmtools/jstat/utils/JstatGcCapacityResults.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 53 import java.util.Arrays;
 54 import java.util.List;
 55 
 56 public class JstatGcCapacityResults extends JstatResults {
 57 
 58     public JstatGcCapacityResults(ToolResults rawResults) {
 59         super(rawResults);
 60     }
 61 
 62     /**
 63      * Checks the overall consistency of the results reported by the tool
 64      */
 65     @Override
 66     public void assertConsistency() {
 67 
 68         // Check exit code
 69         assertThat(getExitCode() == 0, &quot;Unexpected exit code: &quot; + getExitCode());
 70 
 71         // Check Young Gen consistency
 72         float NGCMN = getFloatValue(&quot;NGCMN&quot;);

 73         float NGCMX = getFloatValue(&quot;NGCMX&quot;);
 74         assertThat(NGCMX &gt;= NGCMN, &quot;NGCMN &gt; NGCMX (min generation capacity &gt; max generation capacity)&quot;);
 75 
 76         float NGC = getFloatValue(&quot;NGC&quot;);
 77         assertThat(NGC &gt;= NGCMN, &quot;NGC &lt; NGCMN (generation capacity &lt; min generation capacity)&quot;);
 78         assertThat(NGC &lt;= NGCMX, &quot;NGC &gt; NGCMX (generation capacity &gt; max generation capacity)&quot;);
 79 
 80         float S0C = getFloatValue(&quot;S0C&quot;);
 81         assertThat(S0C &lt;= NGC, &quot;S0C &gt; NGC (survivor space 0 capacity &gt; new generation capacity)&quot;);
 82 
 83         float S1C = getFloatValue(&quot;S1C&quot;);
 84         assertThat(S1C &lt;= NGC, &quot;S1C &gt; NGC (survivor space 1 capacity &gt; new generation capacity)&quot;);
 85 
 86         float EC = getFloatValue(&quot;EC&quot;);
 87         assertThat(EC &lt;= NGC, &quot;EC &gt; NGC (eden space capacity &gt; new generation capacity)&quot;);
 88 
 89         // Verify relative size of NGC and S0C + S1C + EC.
 90         // The rule depends on if the tenured GC is parallel or not.
 91         // For parallell GC:     NGC &gt;= S0C + S1C + EC
 92         // For non-parallell GC: NGC == S0C + S1C + EC
 93         boolean isTenuredParallelGC = isTenuredParallelGC();
 94         String errMsg = String.format(
 95                 &quot;NGC %s (S0C + S1C + EC) (NGC = %.1f, S0C = %.1f, S1C = %.1f, EC = %.1f, (S0C + S1C + EC) = %.1f)&quot;,
 96                 isTenuredParallelGC ? &quot;&lt;&quot; : &quot;!=&quot;, NGC, S0C, S1C, EC, S0C + S1C + EC);
 97         if (isTenuredParallelGC) {
 98             assertThat(NGC &gt;= S0C + S1C + EC, errMsg);
 99         } else {
100             assertThat(checkFloatIsSum(NGC, S0C, S1C, EC), errMsg);
101         }
102 
103         // Check Old Gen consistency
104         float OGCMN = getFloatValue(&quot;OGCMN&quot;);

105         float OGCMX = getFloatValue(&quot;OGCMX&quot;);
106         assertThat(OGCMX &gt;= OGCMN, &quot;OGCMN &gt; OGCMX (min generation capacity &gt; max generation capacity)&quot;);
107 
108         float OGC = getFloatValue(&quot;OGC&quot;);
109         assertThat(OGC &gt;= OGCMN, &quot;OGC &lt; OGCMN (generation capacity &lt; min generation capacity)&quot;);
110         assertThat(OGC &lt;= OGCMX, &quot;OGC &gt; OGCMX (generation capacity &gt; max generation capacity)&quot;);
111         float OC = getFloatValue(&quot;OC&quot;);
112         assertThat(OC == OGC, &quot;OC != OGC (old generation capacity != old space capacity (these values should be equal since old space is made up only from one old generation))&quot;);
113 
114         // Check Metaspace consistency
115         float MCMN = getFloatValue(&quot;MCMN&quot;);
116         float MCMX = getFloatValue(&quot;MCMX&quot;);
117         assertThat(MCMX &gt;= MCMN, &quot;MCMN &gt; MCMX (min generation capacity &gt; max generation capacity)&quot;);
118         float MC = getFloatValue(&quot;MC&quot;);
119         assertThat(MC &gt;= MCMN, &quot;MC &lt; MCMN (generation capacity &lt; min generation capacity)&quot;);
120         assertThat(MC &lt;= MCMX, &quot;MGC &gt; MCMX (generation capacity &gt; max generation capacity)&quot;);
121     }
122 
123     /**
124      * Check if the tenured generation are currently using a parallel GC.
</pre>
</td>
<td>
<hr />
<pre>
 53 import java.util.Arrays;
 54 import java.util.List;
 55 
 56 public class JstatGcCapacityResults extends JstatResults {
 57 
 58     public JstatGcCapacityResults(ToolResults rawResults) {
 59         super(rawResults);
 60     }
 61 
 62     /**
 63      * Checks the overall consistency of the results reported by the tool
 64      */
 65     @Override
 66     public void assertConsistency() {
 67 
 68         // Check exit code
 69         assertThat(getExitCode() == 0, &quot;Unexpected exit code: &quot; + getExitCode());
 70 
 71         // Check Young Gen consistency
 72         float NGCMN = getFloatValue(&quot;NGCMN&quot;);
<span class="line-added"> 73         assertThat(NGCMN &gt;= 0, &quot;NGCMN &lt; 0 (min generation capacity is negative)&quot;);</span>
 74         float NGCMX = getFloatValue(&quot;NGCMX&quot;);
 75         assertThat(NGCMX &gt;= NGCMN, &quot;NGCMN &gt; NGCMX (min generation capacity &gt; max generation capacity)&quot;);
 76 
 77         float NGC = getFloatValue(&quot;NGC&quot;);
 78         assertThat(NGC &gt;= NGCMN, &quot;NGC &lt; NGCMN (generation capacity &lt; min generation capacity)&quot;);
 79         assertThat(NGC &lt;= NGCMX, &quot;NGC &gt; NGCMX (generation capacity &gt; max generation capacity)&quot;);
 80 
 81         float S0C = getFloatValue(&quot;S0C&quot;);
 82         assertThat(S0C &lt;= NGC, &quot;S0C &gt; NGC (survivor space 0 capacity &gt; new generation capacity)&quot;);
 83 
 84         float S1C = getFloatValue(&quot;S1C&quot;);
 85         assertThat(S1C &lt;= NGC, &quot;S1C &gt; NGC (survivor space 1 capacity &gt; new generation capacity)&quot;);
 86 
 87         float EC = getFloatValue(&quot;EC&quot;);
 88         assertThat(EC &lt;= NGC, &quot;EC &gt; NGC (eden space capacity &gt; new generation capacity)&quot;);
 89 
 90         // Verify relative size of NGC and S0C + S1C + EC.
 91         // The rule depends on if the tenured GC is parallel or not.
 92         // For parallell GC:     NGC &gt;= S0C + S1C + EC
 93         // For non-parallell GC: NGC == S0C + S1C + EC
 94         boolean isTenuredParallelGC = isTenuredParallelGC();
 95         String errMsg = String.format(
 96                 &quot;NGC %s (S0C + S1C + EC) (NGC = %.1f, S0C = %.1f, S1C = %.1f, EC = %.1f, (S0C + S1C + EC) = %.1f)&quot;,
 97                 isTenuredParallelGC ? &quot;&lt;&quot; : &quot;!=&quot;, NGC, S0C, S1C, EC, S0C + S1C + EC);
 98         if (isTenuredParallelGC) {
 99             assertThat(NGC &gt;= S0C + S1C + EC, errMsg);
100         } else {
101             assertThat(checkFloatIsSum(NGC, S0C, S1C, EC), errMsg);
102         }
103 
104         // Check Old Gen consistency
105         float OGCMN = getFloatValue(&quot;OGCMN&quot;);
<span class="line-added">106         assertThat(OGCMN &gt;= 0, &quot;OGCMN &lt; 0 (min generation capacity is negative)&quot;);</span>
107         float OGCMX = getFloatValue(&quot;OGCMX&quot;);
108         assertThat(OGCMX &gt;= OGCMN, &quot;OGCMN &gt; OGCMX (min generation capacity &gt; max generation capacity)&quot;);
109 
110         float OGC = getFloatValue(&quot;OGC&quot;);
111         assertThat(OGC &gt;= OGCMN, &quot;OGC &lt; OGCMN (generation capacity &lt; min generation capacity)&quot;);
112         assertThat(OGC &lt;= OGCMX, &quot;OGC &gt; OGCMX (generation capacity &gt; max generation capacity)&quot;);
113         float OC = getFloatValue(&quot;OC&quot;);
114         assertThat(OC == OGC, &quot;OC != OGC (old generation capacity != old space capacity (these values should be equal since old space is made up only from one old generation))&quot;);
115 
116         // Check Metaspace consistency
117         float MCMN = getFloatValue(&quot;MCMN&quot;);
118         float MCMX = getFloatValue(&quot;MCMX&quot;);
119         assertThat(MCMX &gt;= MCMN, &quot;MCMN &gt; MCMX (min generation capacity &gt; max generation capacity)&quot;);
120         float MC = getFloatValue(&quot;MC&quot;);
121         assertThat(MC &gt;= MCMN, &quot;MC &lt; MCMN (generation capacity &lt; min generation capacity)&quot;);
122         assertThat(MC &lt;= MCMX, &quot;MGC &gt; MCMX (generation capacity &gt; max generation capacity)&quot;);
123     }
124 
125     /**
126      * Check if the tenured generation are currently using a parallel GC.
</pre>
</td>
</tr>
</table>
<center><a href="../../../sa/sadebugd/SADebugDTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../share/common/ToolRunner.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>