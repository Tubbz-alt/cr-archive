<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/hotspot/jtreg/serviceability/dcmd/framework/TestProcessLauncher.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="InvalidCommandTest.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="VMVersionTest.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/serviceability/dcmd/framework/TestProcessLauncher.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -24,18 +24,24 @@</span>
  
  import nsk.share.*;
  import nsk.share.jpda.*;
  import nsk.share.jdi.*;
  
<span class="udiff-line-added">+ import java.nio.file.FileSystems;</span>
<span class="udiff-line-added">+ import java.nio.file.Path;</span>
<span class="udiff-line-added">+ </span>
  /**
   * Launches a new Java process that uses a communication pipe to interact
   * with the test.
   */
  
  public class TestProcessLauncher {
  
<span class="udiff-line-modified-removed">-     private final String className;</span>
<span class="udiff-line-modified-added">+     protected static final Path USER_DIR = FileSystems.getDefault().getPath(System.getProperty(&quot;user.dir&quot;, &quot;.&quot;));</span>
<span class="udiff-line-added">+     protected static final Path TEST_CLASSES_DIR = FileSystems.getDefault().getPath(System.getProperty(&quot;test.classes&quot;));</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     protected final String className;</span>
      private final ArgumentHandler argHandler;
  
      private IOPipe pipe;
  
      public TestProcessLauncher(String className, ArgumentHandler argHandler) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -53,11 +59,11 @@</span>
  
          Log log = new Log(System.out, argHandler);
          Binder binder = new Binder(argHandler, log);
          binder.prepareForPipeConnection(argHandler);
  
<span class="udiff-line-modified-removed">-         String cmd = java + &quot; &quot; + className + &quot; -pipe.port=&quot; + argHandler.getPipePort();</span>
<span class="udiff-line-modified-added">+         String cmd = prepareLaunch(java, argHandler.getPipePort());</span>
  
          Debugee debuggee = binder.startLocalDebugee(cmd);
          debuggee.redirectOutput(log);
  
          pipe = new IOPipe(debuggee);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -73,6 +79,10 @@</span>
          if (pipe != null) {
              pipe.println(&quot;quit&quot;);
          }
      }
  
<span class="udiff-line-added">+     protected String prepareLaunch(String javaExec, String pipePort) {</span>
<span class="udiff-line-added">+         return  javaExec + &quot; &quot; + className + &quot; -pipe.port=&quot; + pipePort;</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
  }
</pre>
<center><a href="InvalidCommandTest.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="VMVersionTest.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>