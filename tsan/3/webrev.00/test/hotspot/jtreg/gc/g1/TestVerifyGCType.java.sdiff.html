<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/gc/g1/TestVerifyGCType.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="TestShrinkDefragmentedHeap.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="humongousObjects/TestNoAllocationsInHRegions.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/gc/g1/TestVerifyGCType.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
157         ProcessBuilder procBuilder =  ProcessTools.createJavaProcessBuilder(basicOpts.toArray(
158                                                                             new String[basicOpts.size()]));
159         OutputAnalyzer analyzer = new OutputAnalyzer(procBuilder.start());
160         return analyzer;
161     }
162 
163     private static void verifyCollection(String name, boolean expectBefore, boolean expectDuring, boolean expectAfter, String data) {
164         CollectionInfo ci = CollectionInfo.parseFirst(name, data);
165         Asserts.assertTrue(ci != null, &quot;Expected GC not found: &quot; + name + &quot;\n&quot; + data);
166 
167         // Verify Before
168         verifyType(ci, expectBefore, VERIFY_BEFORE);
169         // Verify During
170         verifyType(ci, expectDuring, VERIFY_DURING);
171         // Verify After
172         verifyType(ci, expectAfter, VERIFY_AFTER);
173     }
174 
175     private static void verifyType(CollectionInfo ci, boolean shouldExist, String pattern) {
176         if (shouldExist) {
<span class="line-modified">177             Asserts.assertTrue(ci.containsVerification(pattern), &quot;Missing expected verification for: &quot; + ci.getName());</span>
178         } else {
<span class="line-modified">179             Asserts.assertFalse(ci.containsVerification(pattern), &quot;Found unexpected verification for: &quot; + ci.getName());</span>
180         }
181     }
182 
183     public static class CollectionInfo {
184         String name;
185         ArrayList&lt;String&gt; verification;
186         public CollectionInfo(String name) {
187             this.name = name;
188             this.verification = new ArrayList&lt;&gt;();
189             System.out.println(&quot;Created CollectionInfo: &quot; + name);
190         }
191 
192         public String getName() {
193             return name;
194         }
195 
196         public void addVerification(String verify) {
197             System.out.println(&quot;Adding: &quot; + verify);
198             verification.add(verify);
199         }
</pre>
</td>
<td>
<hr />
<pre>
157         ProcessBuilder procBuilder =  ProcessTools.createJavaProcessBuilder(basicOpts.toArray(
158                                                                             new String[basicOpts.size()]));
159         OutputAnalyzer analyzer = new OutputAnalyzer(procBuilder.start());
160         return analyzer;
161     }
162 
163     private static void verifyCollection(String name, boolean expectBefore, boolean expectDuring, boolean expectAfter, String data) {
164         CollectionInfo ci = CollectionInfo.parseFirst(name, data);
165         Asserts.assertTrue(ci != null, &quot;Expected GC not found: &quot; + name + &quot;\n&quot; + data);
166 
167         // Verify Before
168         verifyType(ci, expectBefore, VERIFY_BEFORE);
169         // Verify During
170         verifyType(ci, expectDuring, VERIFY_DURING);
171         // Verify After
172         verifyType(ci, expectAfter, VERIFY_AFTER);
173     }
174 
175     private static void verifyType(CollectionInfo ci, boolean shouldExist, String pattern) {
176         if (shouldExist) {
<span class="line-modified">177             Asserts.assertTrue(ci.containsVerification(pattern), &quot;Missing expected verification pattern &quot; + pattern + &quot; for: &quot; + ci.getName());</span>
178         } else {
<span class="line-modified">179             Asserts.assertFalse(ci.containsVerification(pattern), &quot;Found unexpected verification pattern &quot; + pattern + &quot; for: &quot; + ci.getName());</span>
180         }
181     }
182 
183     public static class CollectionInfo {
184         String name;
185         ArrayList&lt;String&gt; verification;
186         public CollectionInfo(String name) {
187             this.name = name;
188             this.verification = new ArrayList&lt;&gt;();
189             System.out.println(&quot;Created CollectionInfo: &quot; + name);
190         }
191 
192         public String getName() {
193             return name;
194         }
195 
196         public void addVerification(String verify) {
197             System.out.println(&quot;Adding: &quot; + verify);
198             verification.add(verify);
199         }
</pre>
</td>
</tr>
</table>
<center><a href="TestShrinkDefragmentedHeap.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="humongousObjects/TestNoAllocationsInHRegions.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>