<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/hotspot/jtreg/gc/survivorAlignment/SurvivorAlignmentTestMain.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../stress/systemgc/TestSystemGCWithShenandoah.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="TestAllocationInEden.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/gc/survivorAlignment/SurvivorAlignmentTestMain.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 69,26 ***</span>
      private static final String PS_EDEN = &quot;PS Eden Space&quot;;
      private static final String PS_SURVIVOR = &quot;PS Survivor Space&quot;;
      private static final String G1_EDEN = &quot;G1 Eden Space&quot;;
      private static final String G1_SURVIVOR = &quot;G1 Survivor Space&quot;;
      private static final String SERIAL_TENURED = &quot;Tenured Gen&quot;;
<span class="line-removed">-     private static final String CMS_TENURED = &quot;CMS Old Gen&quot;;</span>
      private static final String PS_TENURED = &quot;PS Old Gen&quot;;
      private static final String G1_TENURED = &quot;G1 Old Gen&quot;;
  
      private static final long G1_HEAP_REGION_SIZE = Optional.ofNullable(
              SurvivorAlignmentTestMain.WHITE_BOX.getUintxVMFlag(
                      &quot;G1HeapRegionSize&quot;)).orElse(-1L);
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Min size of free chunk in CMS generation.</span>
<span class="line-removed">-      * An object allocated in CMS generation will at least occupy this amount</span>
<span class="line-removed">-      * of bytes.</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     private static final long CMS_MIN_FREE_CHUNK_SIZE</span>
<span class="line-removed">-             = 3L * Unsafe.ADDRESS_SIZE;</span>
<span class="line-removed">- </span>
      private static final AlignmentHelper EDEN_SPACE_HELPER;
      private static final AlignmentHelper SURVIVOR_SPACE_HELPER;
      private static final AlignmentHelper TENURED_SPACE_HELPER;
      /**
       * Amount of memory that should be filled during a test run.
<span class="line-new-header">--- 69,17 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 123,15 ***</span>
       * Note that regardless to GC object&#39;s alignment in survivor space is
       * expected to be equal to {@code SurvivorAlignmentInBytes} value and
       * alignment in other spaces is expected to be equal to
       * {@code ObjectAlignmentInBytes} value.
       *
<span class="line-removed">-      * In CMS generation we can&#39;t allocate less then {@code MinFreeChunk} value,</span>
<span class="line-removed">-      * for other CGs we expect that object of size {@code MIN_OBJECT_SIZE}</span>
<span class="line-removed">-      * could be allocated as it is (of course, its size could be aligned</span>
<span class="line-removed">-      * according to alignment value used in a particular space).</span>
<span class="line-removed">-      *</span>
       * For G1 GC MXBeans could report memory usage only with region size
       * precision (if an object allocated in some G1 heap region, then all region
       * will claimed as used), so for G1&#39;s spaces precision is equal to
       * {@code G1HeapRegionSize} value.
       */
<span class="line-new-header">--- 114,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 185,19 ***</span>
                      tenuredHelper = new AlignmentHelper(
                              AlignmentHelper.OBJECT_ALIGNMENT_IN_BYTES,
                              AlignmentHelper.OBJECT_ALIGNMENT_IN_BYTES,
                              AlignmentHelper.MIN_OBJECT_SIZE, pool);
                      break;
<span class="line-removed">-                 case SurvivorAlignmentTestMain.CMS_TENURED:</span>
<span class="line-removed">-                     Asserts.assertNull(tenuredHelper,</span>
<span class="line-removed">-                             &quot;Only one bean for tenured space is expected.&quot;);</span>
<span class="line-removed">-                     tenuredHelper = new AlignmentHelper(</span>
<span class="line-removed">-                             AlignmentHelper.OBJECT_ALIGNMENT_IN_BYTES,</span>
<span class="line-removed">-                             AlignmentHelper.OBJECT_ALIGNMENT_IN_BYTES,</span>
<span class="line-removed">-                             SurvivorAlignmentTestMain.CMS_MIN_FREE_CHUNK_SIZE,</span>
<span class="line-removed">-                             pool);</span>
<span class="line-removed">-                     break;</span>
              }
          }
          EDEN_SPACE_HELPER = Objects.requireNonNull(edenHelper,
                  &quot;AlignmentHelper for eden space should be initialized.&quot;);
          SURVIVOR_SPACE_HELPER = Objects.requireNonNull(survivorHelper,
<span class="line-new-header">--- 171,10 ---</span>
</pre>
<center><a href="../stress/systemgc/TestSystemGCWithShenandoah.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="TestAllocationInEden.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>