<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New test/hotspot/jtreg/compiler/codegen/TestCharVect2.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
  <body>
    <pre>
   1 /*
   2  * Copyright (c) 2012, Oracle and/or its affiliates. All rights reserved.
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.
   8  *
   9  * This code is distributed in the hope that it will be useful, but WITHOUT
  10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  12  * version 2 for more details (a copy is included in the LICENSE file that
  13  * accompanied this code).
  14  *
  15  * You should have received a copy of the GNU General Public License version
  16  * 2 along with this work; if not, write to the Free Software Foundation,
  17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18  *
  19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20  * or visit www.oracle.com if you need additional information or have any
  21  * questions.
  22  */
  23 
  24 /**
  25  * @test
  26  * @bug 8001183
  27  * @summary incorrect results of char vectors right shift operation
  28  *
  29  * @run main/othervm/timeout=400 -Xbatch -Xmx128m compiler.codegen.TestCharVect2
  30  */
  31 
  32 /**
  33  * @test
  34  * @bug 8001183
  35  * @summary incorrect results of char vectors right shift operation
  36  * @requires vm.compiler2.enabled | vm.graal.enabled
  37  *
  38  * @run main/othervm/timeout=400 -Xbatch -Xmx128m -XX:MaxVectorSize=8 compiler.codegen.TestCharVect2
  39  * @run main/othervm/timeout=400 -Xbatch -Xmx128m -XX:MaxVectorSize=16 compiler.codegen.TestCharVect2
  40  * @run main/othervm/timeout=400 -Xbatch -Xmx128m -XX:MaxVectorSize=32 compiler.codegen.TestCharVect2
  41  */
  42 
  43 package compiler.codegen;
  44 
  45 public class TestCharVect2 {
  46   private static final int ARRLEN = 997;
  47   private static final int ITERS  = 11000;
  48   private static final int ADD_INIT = Character.MAX_VALUE-500;
  49   private static final int BIT_MASK = 0xB731;
  50   private static final int VALUE = 7;
  51   private static final int SHIFT = 16;
  52 
  53   public static void main(String args[]) {
  54     System.out.println(&quot;Testing Char vectors&quot;);
  55     int errn = test();
  56     if (errn &gt; 0) {
  57       System.err.println(&quot;FAILED: &quot; + errn + &quot; errors&quot;);
  58       System.exit(97);
  59     }
  60     System.out.println(&quot;PASSED&quot;);
  61   }
  62 
  63   static int test() {
  64     char[] a0 = new char[ARRLEN];
  65     char[] a1 = new char[ARRLEN];
  66     short[] a2 = new short[ARRLEN];
  67     short[] a3 = new short[ARRLEN];
  68     short[] a4 = new short[ARRLEN];
  69      int[] p2 = new  int[ARRLEN/2];
  70     long[] p4 = new long[ARRLEN/4];
  71     // Initialize
  72     int gold_sum = 0;
  73     for (int i=0; i&lt;ARRLEN; i++) {
  74       char val = (char)(ADD_INIT+i);
  75       gold_sum += val;
  76       a1[i] = val;
  77       a2[i] = VALUE;
  78       a3[i] = -VALUE;
  79       a4[i] = (short)BIT_MASK;
  80     }
  81     System.out.println(&quot;Warmup&quot;);
  82     for (int i=0; i&lt;ITERS; i++) {
  83       test_sum(a1);
  84       test_addc(a0, a1);
  85       test_addv(a0, a1, (char)VALUE);
  86       test_adda(a0, a1, a2);
  87       test_subc(a0, a1);
  88       test_subv(a0, a1, (char)VALUE);
  89       test_suba(a0, a1, a2);
  90 
  91       test_mulc(a0, a1);
  92       test_mulv(a0, a1, (char)VALUE);
  93       test_mula(a0, a1, a2);
  94       test_divc(a0, a1);
  95       test_divv(a0, a1, VALUE);
  96       test_diva(a0, a1, a2);
  97       test_mulc_n(a0, a1);
  98       test_mulv(a0, a1, (char)-VALUE);
  99       test_mula(a0, a1, a3);
 100       test_divc_n(a0, a1);
 101       test_divv(a0, a1, -VALUE);
 102       test_diva(a0, a1, a3);
 103 
 104       test_andc(a0, a1);
 105       test_andv(a0, a1, (short)BIT_MASK);
 106       test_anda(a0, a1, a4);
 107       test_orc(a0, a1);
 108       test_orv(a0, a1, (short)BIT_MASK);
 109       test_ora(a0, a1, a4);
 110       test_xorc(a0, a1);
 111       test_xorv(a0, a1, (short)BIT_MASK);
 112       test_xora(a0, a1, a4);
 113 
 114       test_sllc(a0, a1);
 115       test_sllv(a0, a1, VALUE);
 116       test_srlc(a0, a1);
 117       test_srlv(a0, a1, VALUE);
 118       test_srac(a0, a1);
 119       test_srav(a0, a1, VALUE);
 120 
 121       test_sllc_n(a0, a1);
 122       test_sllv(a0, a1, -VALUE);
 123       test_srlc_n(a0, a1);
 124       test_srlv(a0, a1, -VALUE);
 125       test_srac_n(a0, a1);
 126       test_srav(a0, a1, -VALUE);
 127 
 128       test_sllc_o(a0, a1);
 129       test_sllv(a0, a1, SHIFT);
 130       test_srlc_o(a0, a1);
 131       test_srlv(a0, a1, SHIFT);
 132       test_srac_o(a0, a1);
 133       test_srav(a0, a1, SHIFT);
 134 
 135       test_sllc_on(a0, a1);
 136       test_sllv(a0, a1, -SHIFT);
 137       test_srlc_on(a0, a1);
 138       test_srlv(a0, a1, -SHIFT);
 139       test_srac_on(a0, a1);
 140       test_srav(a0, a1, -SHIFT);
 141 
 142       test_sllc_add(a0, a1);
 143       test_sllv_add(a0, a1, ADD_INIT);
 144       test_srlc_add(a0, a1);
 145       test_srlv_add(a0, a1, ADD_INIT);
 146       test_srac_add(a0, a1);
 147       test_srav_add(a0, a1, ADD_INIT);
 148 
 149       test_sllc_and(a0, a1);
 150       test_sllv_and(a0, a1, BIT_MASK);
 151       test_srlc_and(a0, a1);
 152       test_srlv_and(a0, a1, BIT_MASK);
 153       test_srac_and(a0, a1);
 154       test_srav_and(a0, a1, BIT_MASK);
 155 
 156       test_pack2(p2, a1);
 157       test_unpack2(a0, p2);
 158       test_pack2_swap(p2, a1);
 159       test_unpack2_swap(a0, p2);
 160       test_pack4(p4, a1);
 161       test_unpack4(a0, p4);
 162       test_pack4_swap(p4, a1);
 163       test_unpack4_swap(a0, p4);
 164     }
 165     // Test and verify results
 166     System.out.println(&quot;Verification&quot;);
 167     int errn = 0;
 168     {
 169       int sum = test_sum(a1);
 170       if (sum != gold_sum) {
 171         System.err.println(&quot;test_sum:  &quot; + sum + &quot; != &quot; + gold_sum);
 172         errn++;
 173       }
 174 
 175       test_addc(a0, a1);
 176       for (int i=0; i&lt;ARRLEN; i++) {
 177         errn += verify(&quot;test_addc: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)+VALUE));
 178       }
 179       test_addv(a0, a1, (char)VALUE);
 180       for (int i=0; i&lt;ARRLEN; i++) {
 181         errn += verify(&quot;test_addv: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)+VALUE));
 182       }
 183       test_adda(a0, a1, a2);
 184       for (int i=0; i&lt;ARRLEN; i++) {
 185         errn += verify(&quot;test_adda: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)+VALUE));
 186       }
 187 
 188       test_subc(a0, a1);
 189       for (int i=0; i&lt;ARRLEN; i++) {
 190         errn += verify(&quot;test_subc: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)-VALUE));
 191       }
 192       test_subv(a0, a1, (char)VALUE);
 193       for (int i=0; i&lt;ARRLEN; i++) {
 194         errn += verify(&quot;test_subv: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)-VALUE));
 195       }
 196       test_suba(a0, a1, a2);
 197       for (int i=0; i&lt;ARRLEN; i++) {
 198         errn += verify(&quot;test_suba: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)-VALUE));
 199       }
 200 
 201       test_mulc(a0, a1);
 202       for (int i=0; i&lt;ARRLEN; i++) {
 203         errn += verify(&quot;test_mulc: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)*VALUE));
 204       }
 205       test_mulv(a0, a1, (char)VALUE);
 206       for (int i=0; i&lt;ARRLEN; i++) {
 207         errn += verify(&quot;test_mulv: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)*VALUE));
 208       }
 209       test_mula(a0, a1, a2);
 210       for (int i=0; i&lt;ARRLEN; i++) {
 211         errn += verify(&quot;test_mula: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)*VALUE));
 212       }
 213 
 214       test_divc(a0, a1);
 215       for (int i=0; i&lt;ARRLEN; i++) {
 216         errn += verify(&quot;test_divc: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)/VALUE));
 217       }
 218       test_divv(a0, a1, VALUE);
 219       for (int i=0; i&lt;ARRLEN; i++) {
 220         errn += verify(&quot;test_divv: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)/VALUE));
 221       }
 222       test_diva(a0, a1, a2);
 223       for (int i=0; i&lt;ARRLEN; i++) {
 224         errn += verify(&quot;test_diva: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)/VALUE));
 225       }
 226 
 227       test_mulc_n(a0, a1);
 228       for (int i=0; i&lt;ARRLEN; i++) {
 229         errn += verify(&quot;test_mulc_n: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)*(-VALUE)));
 230       }
 231       test_mulv(a0, a1, (char)-VALUE);
 232       for (int i=0; i&lt;ARRLEN; i++) {
 233         errn += verify(&quot;test_mulv_n: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)*(-VALUE)));
 234       }
 235       test_mula(a0, a1, a3);
 236       for (int i=0; i&lt;ARRLEN; i++) {
 237         errn += verify(&quot;test_mula_n: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)*(-VALUE)));
 238       }
 239 
 240       test_divc_n(a0, a1);
 241       for (int i=0; i&lt;ARRLEN; i++) {
 242         errn += verify(&quot;test_divc_n: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)/(-VALUE)));
 243       }
 244       test_divv(a0, a1, -VALUE);
 245       for (int i=0; i&lt;ARRLEN; i++) {
 246         errn += verify(&quot;test_divv_n: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)/(-VALUE)));
 247       }
 248       test_diva(a0, a1, a3);
 249       for (int i=0; i&lt;ARRLEN; i++) {
 250         errn += verify(&quot;test_diva_n: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)/(-VALUE)));
 251       }
 252 
 253       test_andc(a0, a1);
 254       for (int i=0; i&lt;ARRLEN; i++) {
 255         errn += verify(&quot;test_andc: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&amp;BIT_MASK));
 256       }
 257       test_andv(a0, a1, (short)BIT_MASK);
 258       for (int i=0; i&lt;ARRLEN; i++) {
 259         errn += verify(&quot;test_andv: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&amp;BIT_MASK));
 260       }
 261       test_anda(a0, a1, a4);
 262       for (int i=0; i&lt;ARRLEN; i++) {
 263         errn += verify(&quot;test_anda: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&amp;BIT_MASK));
 264       }
 265 
 266       test_orc(a0, a1);
 267       for (int i=0; i&lt;ARRLEN; i++) {
 268         errn += verify(&quot;test_orc: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)|BIT_MASK));
 269       }
 270       test_orv(a0, a1, (short)BIT_MASK);
 271       for (int i=0; i&lt;ARRLEN; i++) {
 272         errn += verify(&quot;test_orv: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)|BIT_MASK));
 273       }
 274       test_ora(a0, a1, a4);
 275       for (int i=0; i&lt;ARRLEN; i++) {
 276         errn += verify(&quot;test_ora: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)|BIT_MASK));
 277       }
 278 
 279       test_xorc(a0, a1);
 280       for (int i=0; i&lt;ARRLEN; i++) {
 281         errn += verify(&quot;test_xorc: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)^BIT_MASK));
 282       }
 283       test_xorv(a0, a1, (short)BIT_MASK);
 284       for (int i=0; i&lt;ARRLEN; i++) {
 285         errn += verify(&quot;test_xorv: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)^BIT_MASK));
 286       }
 287       test_xora(a0, a1, a4);
 288       for (int i=0; i&lt;ARRLEN; i++) {
 289         errn += verify(&quot;test_xora: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)^BIT_MASK));
 290       }
 291 
 292       test_sllc(a0, a1);
 293       for (int i=0; i&lt;ARRLEN; i++) {
 294         errn += verify(&quot;test_sllc: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&lt;&lt;VALUE));
 295       }
 296       test_sllv(a0, a1, VALUE);
 297       for (int i=0; i&lt;ARRLEN; i++) {
 298         errn += verify(&quot;test_sllv: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&lt;&lt;VALUE));
 299       }
 300 
 301       test_srlc(a0, a1);
 302       for (int i=0; i&lt;ARRLEN; i++) {
 303         errn += verify(&quot;test_srlc: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;&gt;VALUE));
 304       }
 305       test_srlv(a0, a1, VALUE);
 306       for (int i=0; i&lt;ARRLEN; i++) {
 307         errn += verify(&quot;test_srlv: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;&gt;VALUE));
 308       }
 309 
 310       test_srac(a0, a1);
 311       for (int i=0; i&lt;ARRLEN; i++) {
 312         errn += verify(&quot;test_srac: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;VALUE));
 313       }
 314       test_srav(a0, a1, VALUE);
 315       for (int i=0; i&lt;ARRLEN; i++) {
 316         errn += verify(&quot;test_srav: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;VALUE));
 317       }
 318 
 319       test_sllc_n(a0, a1);
 320       for (int i=0; i&lt;ARRLEN; i++) {
 321         errn += verify(&quot;test_sllc_n: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&lt;&lt;(-VALUE)));
 322       }
 323       test_sllv(a0, a1, -VALUE);
 324       for (int i=0; i&lt;ARRLEN; i++) {
 325         errn += verify(&quot;test_sllv_n: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&lt;&lt;(-VALUE)));
 326       }
 327 
 328       test_srlc_n(a0, a1);
 329       for (int i=0; i&lt;ARRLEN; i++) {
 330         errn += verify(&quot;test_srlc_n: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;&gt;(-VALUE)));
 331       }
 332       test_srlv(a0, a1, -VALUE);
 333       for (int i=0; i&lt;ARRLEN; i++) {
 334         errn += verify(&quot;test_srlv_n: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;&gt;(-VALUE)));
 335       }
 336 
 337       test_srac_n(a0, a1);
 338       for (int i=0; i&lt;ARRLEN; i++) {
 339         errn += verify(&quot;test_srac_n: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;(-VALUE)));
 340       }
 341       test_srav(a0, a1, -VALUE);
 342       for (int i=0; i&lt;ARRLEN; i++) {
 343         errn += verify(&quot;test_srav_n: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;(-VALUE)));
 344       }
 345 
 346       test_sllc_o(a0, a1);
 347       for (int i=0; i&lt;ARRLEN; i++) {
 348         errn += verify(&quot;test_sllc_o: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&lt;&lt;SHIFT));
 349       }
 350       test_sllv(a0, a1, SHIFT);
 351       for (int i=0; i&lt;ARRLEN; i++) {
 352         errn += verify(&quot;test_sllv_o: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&lt;&lt;SHIFT));
 353       }
 354 
 355       test_srlc_o(a0, a1);
 356       for (int i=0; i&lt;ARRLEN; i++) {
 357         errn += verify(&quot;test_srlc_o: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;&gt;SHIFT));
 358       }
 359       test_srlv(a0, a1, SHIFT);
 360       for (int i=0; i&lt;ARRLEN; i++) {
 361         errn += verify(&quot;test_srlv_o: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;&gt;SHIFT));
 362       }
 363 
 364       test_srac_o(a0, a1);
 365       for (int i=0; i&lt;ARRLEN; i++) {
 366         errn += verify(&quot;test_srac_o: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;SHIFT));
 367       }
 368       test_srav(a0, a1, SHIFT);
 369       for (int i=0; i&lt;ARRLEN; i++) {
 370         errn += verify(&quot;test_srav_o: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;SHIFT));
 371       }
 372 
 373       test_sllc_on(a0, a1);
 374       for (int i=0; i&lt;ARRLEN; i++) {
 375         errn += verify(&quot;test_sllc_on: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&lt;&lt;(-SHIFT)));
 376       }
 377       test_sllv(a0, a1, -SHIFT);
 378       for (int i=0; i&lt;ARRLEN; i++) {
 379         errn += verify(&quot;test_sllv_on: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&lt;&lt;(-SHIFT)));
 380       }
 381 
 382       test_srlc_on(a0, a1);
 383       for (int i=0; i&lt;ARRLEN; i++) {
 384         errn += verify(&quot;test_srlc_on: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;&gt;(-SHIFT)));
 385       }
 386       test_srlv(a0, a1, -SHIFT);
 387       for (int i=0; i&lt;ARRLEN; i++) {
 388         errn += verify(&quot;test_srlv_on: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;&gt;(-SHIFT)));
 389       }
 390 
 391       test_srac_on(a0, a1);
 392       for (int i=0; i&lt;ARRLEN; i++) {
 393         errn += verify(&quot;test_srac_on: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;(-SHIFT)));
 394       }
 395       test_srav(a0, a1, -SHIFT);
 396       for (int i=0; i&lt;ARRLEN; i++) {
 397         errn += verify(&quot;test_srav_on: &quot;, i, a0[i], (char)((char)(ADD_INIT+i)&gt;&gt;(-SHIFT)));
 398       }
 399 
 400       test_sllc_add(a0, a1);
 401       for (int i=0; i&lt;ARRLEN; i++) {
 402         errn += verify(&quot;test_sllc_add: &quot;, i, a0[i], (char)(((char)(ADD_INIT+i) + ADD_INIT)&lt;&lt;VALUE));
 403       }
 404       test_sllv_add(a0, a1, ADD_INIT);
 405       for (int i=0; i&lt;ARRLEN; i++) {
 406         errn += verify(&quot;test_sllv_add: &quot;, i, a0[i], (char)(((char)(ADD_INIT+i) + ADD_INIT)&lt;&lt;VALUE));
 407       }
 408 
 409       test_srlc_add(a0, a1);
 410       for (int i=0; i&lt;ARRLEN; i++) {
 411         errn += verify(&quot;test_srlc_add: &quot;, i, a0[i], (char)(((char)(ADD_INIT+i) + ADD_INIT)&gt;&gt;&gt;VALUE));
 412       }
 413       test_srlv_add(a0, a1, ADD_INIT);
 414       for (int i=0; i&lt;ARRLEN; i++) {
 415         errn += verify(&quot;test_srlv_add: &quot;, i, a0[i], (char)(((char)(ADD_INIT+i) + ADD_INIT)&gt;&gt;&gt;VALUE));
 416       }
 417 
 418       test_srac_add(a0, a1);
 419       for (int i=0; i&lt;ARRLEN; i++) {
 420         errn += verify(&quot;test_srac_add: &quot;, i, a0[i], (char)(((char)(ADD_INIT+i) + ADD_INIT)&gt;&gt;VALUE));
 421       }
 422       test_srav_add(a0, a1, ADD_INIT);
 423       for (int i=0; i&lt;ARRLEN; i++) {
 424         errn += verify(&quot;test_srav_add: &quot;, i, a0[i], (char)(((char)(ADD_INIT+i) + ADD_INIT)&gt;&gt;VALUE));
 425       }
 426 
 427       test_sllc_and(a0, a1);
 428       for (int i=0; i&lt;ARRLEN; i++) {
 429         errn += verify(&quot;test_sllc_and: &quot;, i, a0[i], (char)(((char)(ADD_INIT+i) &amp; BIT_MASK)&lt;&lt;VALUE));
 430       }
 431       test_sllv_and(a0, a1, BIT_MASK);
 432       for (int i=0; i&lt;ARRLEN; i++) {
 433         errn += verify(&quot;test_sllv_and: &quot;, i, a0[i], (char)(((char)(ADD_INIT+i) &amp; BIT_MASK)&lt;&lt;VALUE));
 434       }
 435 
 436       test_srlc_and(a0, a1);
 437       for (int i=0; i&lt;ARRLEN; i++) {
 438         errn += verify(&quot;test_srlc_and: &quot;, i, a0[i], (char)(((char)(ADD_INIT+i) &amp; BIT_MASK)&gt;&gt;&gt;VALUE));
 439       }
 440       test_srlv_and(a0, a1, BIT_MASK);
 441       for (int i=0; i&lt;ARRLEN; i++) {
 442         errn += verify(&quot;test_srlv_and: &quot;, i, a0[i], (char)(((char)(ADD_INIT+i) &amp; BIT_MASK)&gt;&gt;&gt;VALUE));
 443       }
 444 
 445       test_srac_and(a0, a1);
 446       for (int i=0; i&lt;ARRLEN; i++) {
 447         errn += verify(&quot;test_srac_and: &quot;, i, a0[i], (char)(((char)(ADD_INIT+i) &amp; BIT_MASK)&gt;&gt;VALUE));
 448       }
 449       test_srav_and(a0, a1, BIT_MASK);
 450       for (int i=0; i&lt;ARRLEN; i++) {
 451         errn += verify(&quot;test_srav_and: &quot;, i, a0[i], (char)(((char)(ADD_INIT+i) &amp; BIT_MASK)&gt;&gt;VALUE));
 452       }
 453 
 454       test_pack2(p2, a1);
 455       for (int i=0; i&lt;ARRLEN/2; i++) {
 456         errn += verify(&quot;test_pack2: &quot;, i, p2[i], ((int)(ADD_INIT+2*i) &amp; 0xFFFF) | ((int)(ADD_INIT+2*i+1) &lt;&lt; 16));
 457       }
 458       for (int i=0; i&lt;ARRLEN; i++) {
 459         a0[i] = (char)-1;
 460       }
 461       test_unpack2(a0, p2);
 462       for (int i=0; i&lt;(ARRLEN&amp;(-2)); i++) {
 463         errn += verify(&quot;test_unpack2: &quot;, i, a0[i], (char)(ADD_INIT+i));
 464       }
 465 
 466       test_pack2_swap(p2, a1);
 467       for (int i=0; i&lt;ARRLEN/2; i++) {
 468         errn += verify(&quot;test_pack2_swap: &quot;, i, p2[i], ((int)(ADD_INIT+2*i+1) &amp; 0xFFFF) | ((int)(ADD_INIT+2*i) &lt;&lt; 16));
 469       }
 470       for (int i=0; i&lt;ARRLEN; i++) {
 471         a0[i] = (char)-1;
 472       }
 473       test_unpack2_swap(a0, p2);
 474       for (int i=0; i&lt;(ARRLEN&amp;(-2)); i++) {
 475         errn += verify(&quot;test_unpack2_swap: &quot;, i, a0[i], (char)(ADD_INIT+i));
 476       }
 477 
 478       test_pack4(p4, a1);
 479       for (int i=0; i&lt;ARRLEN/4; i++) {
 480         errn += verify(&quot;test_pack4: &quot;, i, p4[i],  ((long)(ADD_INIT+4*i+0) &amp; 0xFFFFl) |
 481                                                  (((long)(ADD_INIT+4*i+1) &amp; 0xFFFFl) &lt;&lt; 16)  |
 482                                                  (((long)(ADD_INIT+4*i+2) &amp; 0xFFFFl) &lt;&lt; 32)  |
 483                                                  (((long)(ADD_INIT+4*i+3) &amp; 0xFFFFl) &lt;&lt; 48));
 484       }
 485       for (int i=0; i&lt;ARRLEN; i++) {
 486         a0[i] = (char)-1;
 487       }
 488       test_unpack4(a0, p4);
 489       for (int i=0; i&lt;(ARRLEN&amp;(-4)); i++) {
 490         errn += verify(&quot;test_unpack4: &quot;, i, a0[i], (char)(ADD_INIT+i));
 491       }
 492 
 493       test_pack4_swap(p4, a1);
 494       for (int i=0; i&lt;ARRLEN/4; i++) {
 495         errn += verify(&quot;test_pack4_swap: &quot;, i, p4[i],  ((long)(ADD_INIT+4*i+3) &amp; 0xFFFFl) |
 496                                                       (((long)(ADD_INIT+4*i+2) &amp; 0xFFFFl) &lt;&lt; 16)  |
 497                                                       (((long)(ADD_INIT+4*i+1) &amp; 0xFFFFl) &lt;&lt; 32)  |
 498                                                       (((long)(ADD_INIT+4*i+0) &amp; 0xFFFFl) &lt;&lt; 48));
 499       }
 500       for (int i=0; i&lt;ARRLEN; i++) {
 501         a0[i] = (char)-1;
 502       }
 503       test_unpack4_swap(a0, p4);
 504       for (int i=0; i&lt;(ARRLEN&amp;(-4)); i++) {
 505         errn += verify(&quot;test_unpack4_swap: &quot;, i, a0[i], (char)(ADD_INIT+i));
 506       }
 507 
 508     }
 509 
 510     if (errn &gt; 0)
 511       return errn;
 512 
 513     System.out.println(&quot;Time&quot;);
 514     long start, end;
 515 
 516     start = System.currentTimeMillis();
 517     for (int i=0; i&lt;ITERS; i++) {
 518       test_sum(a1);
 519     }
 520     end = System.currentTimeMillis();
 521     System.out.println(&quot;test_sum: &quot; + (end - start));
 522 
 523     start = System.currentTimeMillis();
 524     for (int i=0; i&lt;ITERS; i++) {
 525       test_addc(a0, a1);
 526     }
 527     end = System.currentTimeMillis();
 528     System.out.println(&quot;test_addc: &quot; + (end - start));
 529     start = System.currentTimeMillis();
 530     for (int i=0; i&lt;ITERS; i++) {
 531       test_addv(a0, a1, (char)VALUE);
 532     }
 533     end = System.currentTimeMillis();
 534     System.out.println(&quot;test_addv: &quot; + (end - start));
 535     start = System.currentTimeMillis();
 536     for (int i=0; i&lt;ITERS; i++) {
 537       test_adda(a0, a1, a2);
 538     }
 539     end = System.currentTimeMillis();
 540     System.out.println(&quot;test_adda: &quot; + (end - start));
 541 
 542     start = System.currentTimeMillis();
 543     for (int i=0; i&lt;ITERS; i++) {
 544       test_subc(a0, a1);
 545     }
 546     end = System.currentTimeMillis();
 547     System.out.println(&quot;test_subc: &quot; + (end - start));
 548     start = System.currentTimeMillis();
 549     for (int i=0; i&lt;ITERS; i++) {
 550       test_subv(a0, a1, (char)VALUE);
 551     }
 552     end = System.currentTimeMillis();
 553     System.out.println(&quot;test_subv: &quot; + (end - start));
 554     start = System.currentTimeMillis();
 555     for (int i=0; i&lt;ITERS; i++) {
 556       test_suba(a0, a1, a2);
 557     }
 558     end = System.currentTimeMillis();
 559     System.out.println(&quot;test_suba: &quot; + (end - start));
 560 
 561     start = System.currentTimeMillis();
 562     for (int i=0; i&lt;ITERS; i++) {
 563       test_mulc(a0, a1);
 564     }
 565     end = System.currentTimeMillis();
 566     System.out.println(&quot;test_mulc: &quot; + (end - start));
 567     start = System.currentTimeMillis();
 568     for (int i=0; i&lt;ITERS; i++) {
 569       test_mulv(a0, a1, (char)VALUE);
 570     }
 571     end = System.currentTimeMillis();
 572     System.out.println(&quot;test_mulv: &quot; + (end - start));
 573     start = System.currentTimeMillis();
 574     for (int i=0; i&lt;ITERS; i++) {
 575       test_mula(a0, a1, a2);
 576     }
 577     end = System.currentTimeMillis();
 578     System.out.println(&quot;test_mula: &quot; + (end - start));
 579 
 580     start = System.currentTimeMillis();
 581     for (int i=0; i&lt;ITERS; i++) {
 582       test_divc(a0, a1);
 583     }
 584     end = System.currentTimeMillis();
 585     System.out.println(&quot;test_divc: &quot; + (end - start));
 586     start = System.currentTimeMillis();
 587     for (int i=0; i&lt;ITERS; i++) {
 588       test_divv(a0, a1, VALUE);
 589     }
 590     end = System.currentTimeMillis();
 591     System.out.println(&quot;test_divv: &quot; + (end - start));
 592     start = System.currentTimeMillis();
 593     for (int i=0; i&lt;ITERS; i++) {
 594       test_diva(a0, a1, a2);
 595     }
 596     end = System.currentTimeMillis();
 597     System.out.println(&quot;test_diva: &quot; + (end - start));
 598 
 599     start = System.currentTimeMillis();
 600     for (int i=0; i&lt;ITERS; i++) {
 601       test_mulc_n(a0, a1);
 602     }
 603     end = System.currentTimeMillis();
 604     System.out.println(&quot;test_mulc_n: &quot; + (end - start));
 605     start = System.currentTimeMillis();
 606     for (int i=0; i&lt;ITERS; i++) {
 607       test_mulv(a0, a1, (char)-VALUE);
 608     }
 609     end = System.currentTimeMillis();
 610     System.out.println(&quot;test_mulv_n: &quot; + (end - start));
 611     start = System.currentTimeMillis();
 612     for (int i=0; i&lt;ITERS; i++) {
 613       test_mula(a0, a1, a3);
 614     }
 615     end = System.currentTimeMillis();
 616     System.out.println(&quot;test_mula_n: &quot; + (end - start));
 617 
 618     start = System.currentTimeMillis();
 619     for (int i=0; i&lt;ITERS; i++) {
 620       test_divc_n(a0, a1);
 621     }
 622     end = System.currentTimeMillis();
 623     System.out.println(&quot;test_divc_n: &quot; + (end - start));
 624     start = System.currentTimeMillis();
 625     for (int i=0; i&lt;ITERS; i++) {
 626       test_divv(a0, a1, -VALUE);
 627     }
 628     end = System.currentTimeMillis();
 629     System.out.println(&quot;test_divv_n: &quot; + (end - start));
 630     start = System.currentTimeMillis();
 631     for (int i=0; i&lt;ITERS; i++) {
 632       test_diva(a0, a1, a3);
 633     }
 634     end = System.currentTimeMillis();
 635     System.out.println(&quot;test_diva_n: &quot; + (end - start));
 636 
 637     start = System.currentTimeMillis();
 638     for (int i=0; i&lt;ITERS; i++) {
 639       test_andc(a0, a1);
 640     }
 641     end = System.currentTimeMillis();
 642     System.out.println(&quot;test_andc: &quot; + (end - start));
 643     start = System.currentTimeMillis();
 644     for (int i=0; i&lt;ITERS; i++) {
 645       test_andv(a0, a1, (short)BIT_MASK);
 646     }
 647     end = System.currentTimeMillis();
 648     System.out.println(&quot;test_andv: &quot; + (end - start));
 649     start = System.currentTimeMillis();
 650     for (int i=0; i&lt;ITERS; i++) {
 651       test_anda(a0, a1, a4);
 652     }
 653     end = System.currentTimeMillis();
 654     System.out.println(&quot;test_anda: &quot; + (end - start));
 655 
 656     start = System.currentTimeMillis();
 657     for (int i=0; i&lt;ITERS; i++) {
 658       test_orc(a0, a1);
 659     }
 660     end = System.currentTimeMillis();
 661     System.out.println(&quot;test_orc: &quot; + (end - start));
 662     start = System.currentTimeMillis();
 663     for (int i=0; i&lt;ITERS; i++) {
 664       test_orv(a0, a1, (short)BIT_MASK);
 665     }
 666     end = System.currentTimeMillis();
 667     System.out.println(&quot;test_orv: &quot; + (end - start));
 668     start = System.currentTimeMillis();
 669     for (int i=0; i&lt;ITERS; i++) {
 670       test_ora(a0, a1, a4);
 671     }
 672     end = System.currentTimeMillis();
 673     System.out.println(&quot;test_ora: &quot; + (end - start));
 674 
 675     start = System.currentTimeMillis();
 676     for (int i=0; i&lt;ITERS; i++) {
 677       test_xorc(a0, a1);
 678     }
 679     end = System.currentTimeMillis();
 680     System.out.println(&quot;test_xorc: &quot; + (end - start));
 681     start = System.currentTimeMillis();
 682     for (int i=0; i&lt;ITERS; i++) {
 683       test_xorv(a0, a1, (short)BIT_MASK);
 684     }
 685     end = System.currentTimeMillis();
 686     System.out.println(&quot;test_xorv: &quot; + (end - start));
 687     start = System.currentTimeMillis();
 688     for (int i=0; i&lt;ITERS; i++) {
 689       test_xora(a0, a1, a4);
 690     }
 691     end = System.currentTimeMillis();
 692     System.out.println(&quot;test_xora: &quot; + (end - start));
 693 
 694     start = System.currentTimeMillis();
 695     for (int i=0; i&lt;ITERS; i++) {
 696       test_sllc(a0, a1);
 697     }
 698     end = System.currentTimeMillis();
 699     System.out.println(&quot;test_sllc: &quot; + (end - start));
 700     start = System.currentTimeMillis();
 701     for (int i=0; i&lt;ITERS; i++) {
 702       test_sllv(a0, a1, VALUE);
 703     }
 704     end = System.currentTimeMillis();
 705     System.out.println(&quot;test_sllv: &quot; + (end - start));
 706 
 707     start = System.currentTimeMillis();
 708     for (int i=0; i&lt;ITERS; i++) {
 709       test_srlc(a0, a1);
 710     }
 711     end = System.currentTimeMillis();
 712     System.out.println(&quot;test_srlc: &quot; + (end - start));
 713     start = System.currentTimeMillis();
 714     for (int i=0; i&lt;ITERS; i++) {
 715       test_srlv(a0, a1, VALUE);
 716     }
 717     end = System.currentTimeMillis();
 718     System.out.println(&quot;test_srlv: &quot; + (end - start));
 719 
 720     start = System.currentTimeMillis();
 721     for (int i=0; i&lt;ITERS; i++) {
 722       test_srac(a0, a1);
 723     }
 724     end = System.currentTimeMillis();
 725     System.out.println(&quot;test_srac: &quot; + (end - start));
 726     start = System.currentTimeMillis();
 727     for (int i=0; i&lt;ITERS; i++) {
 728       test_srav(a0, a1, VALUE);
 729     }
 730     end = System.currentTimeMillis();
 731     System.out.println(&quot;test_srav: &quot; + (end - start));
 732 
 733     start = System.currentTimeMillis();
 734     for (int i=0; i&lt;ITERS; i++) {
 735       test_sllc_n(a0, a1);
 736     }
 737     end = System.currentTimeMillis();
 738     System.out.println(&quot;test_sllc_n: &quot; + (end - start));
 739     start = System.currentTimeMillis();
 740     for (int i=0; i&lt;ITERS; i++) {
 741       test_sllv(a0, a1, -VALUE);
 742     }
 743     end = System.currentTimeMillis();
 744     System.out.println(&quot;test_sllv_n: &quot; + (end - start));
 745 
 746     start = System.currentTimeMillis();
 747     for (int i=0; i&lt;ITERS; i++) {
 748       test_srlc_n(a0, a1);
 749     }
 750     end = System.currentTimeMillis();
 751     System.out.println(&quot;test_srlc_n: &quot; + (end - start));
 752     start = System.currentTimeMillis();
 753     for (int i=0; i&lt;ITERS; i++) {
 754       test_srlv(a0, a1, -VALUE);
 755     }
 756     end = System.currentTimeMillis();
 757     System.out.println(&quot;test_srlv_n: &quot; + (end - start));
 758 
 759     start = System.currentTimeMillis();
 760     for (int i=0; i&lt;ITERS; i++) {
 761       test_srac_n(a0, a1);
 762     }
 763     end = System.currentTimeMillis();
 764     System.out.println(&quot;test_srac_n: &quot; + (end - start));
 765     start = System.currentTimeMillis();
 766     for (int i=0; i&lt;ITERS; i++) {
 767       test_srav(a0, a1, -VALUE);
 768     }
 769     end = System.currentTimeMillis();
 770     System.out.println(&quot;test_srav_n: &quot; + (end - start));
 771 
 772     start = System.currentTimeMillis();
 773     for (int i=0; i&lt;ITERS; i++) {
 774       test_sllc_o(a0, a1);
 775     }
 776     end = System.currentTimeMillis();
 777     System.out.println(&quot;test_sllc_o: &quot; + (end - start));
 778     start = System.currentTimeMillis();
 779     for (int i=0; i&lt;ITERS; i++) {
 780       test_sllv(a0, a1, SHIFT);
 781     }
 782     end = System.currentTimeMillis();
 783     System.out.println(&quot;test_sllv_o: &quot; + (end - start));
 784 
 785     start = System.currentTimeMillis();
 786     for (int i=0; i&lt;ITERS; i++) {
 787       test_srlc_o(a0, a1);
 788     }
 789     end = System.currentTimeMillis();
 790     System.out.println(&quot;test_srlc_o: &quot; + (end - start));
 791     start = System.currentTimeMillis();
 792     for (int i=0; i&lt;ITERS; i++) {
 793       test_srlv(a0, a1, SHIFT);
 794     }
 795     end = System.currentTimeMillis();
 796     System.out.println(&quot;test_srlv_o: &quot; + (end - start));
 797 
 798     start = System.currentTimeMillis();
 799     for (int i=0; i&lt;ITERS; i++) {
 800       test_srac_o(a0, a1);
 801     }
 802     end = System.currentTimeMillis();
 803     System.out.println(&quot;test_srac_o: &quot; + (end - start));
 804     start = System.currentTimeMillis();
 805     for (int i=0; i&lt;ITERS; i++) {
 806       test_srav(a0, a1, SHIFT);
 807     }
 808     end = System.currentTimeMillis();
 809     System.out.println(&quot;test_srav_o: &quot; + (end - start));
 810 
 811     start = System.currentTimeMillis();
 812     for (int i=0; i&lt;ITERS; i++) {
 813       test_sllc_on(a0, a1);
 814     }
 815     end = System.currentTimeMillis();
 816     System.out.println(&quot;test_sllc_on: &quot; + (end - start));
 817     start = System.currentTimeMillis();
 818     for (int i=0; i&lt;ITERS; i++) {
 819       test_sllv(a0, a1, -SHIFT);
 820     }
 821     end = System.currentTimeMillis();
 822     System.out.println(&quot;test_sllv_on: &quot; + (end - start));
 823 
 824     start = System.currentTimeMillis();
 825     for (int i=0; i&lt;ITERS; i++) {
 826       test_srlc_on(a0, a1);
 827     }
 828     end = System.currentTimeMillis();
 829     System.out.println(&quot;test_srlc_on: &quot; + (end - start));
 830     start = System.currentTimeMillis();
 831     for (int i=0; i&lt;ITERS; i++) {
 832       test_srlv(a0, a1, -SHIFT);
 833     }
 834     end = System.currentTimeMillis();
 835     System.out.println(&quot;test_srlv_on: &quot; + (end - start));
 836 
 837     start = System.currentTimeMillis();
 838     for (int i=0; i&lt;ITERS; i++) {
 839       test_srac_on(a0, a1);
 840     }
 841     end = System.currentTimeMillis();
 842     System.out.println(&quot;test_srac_on: &quot; + (end - start));
 843     start = System.currentTimeMillis();
 844     for (int i=0; i&lt;ITERS; i++) {
 845       test_srav(a0, a1, -SHIFT);
 846     }
 847     end = System.currentTimeMillis();
 848     System.out.println(&quot;test_srav_on: &quot; + (end - start));
 849 
 850     start = System.currentTimeMillis();
 851     for (int i=0; i&lt;ITERS; i++) {
 852       test_sllc_add(a0, a1);
 853     }
 854     end = System.currentTimeMillis();
 855     System.out.println(&quot;test_sllc_add: &quot; + (end - start));
 856     start = System.currentTimeMillis();
 857     for (int i=0; i&lt;ITERS; i++) {
 858       test_sllv_add(a0, a1, ADD_INIT);
 859     }
 860     end = System.currentTimeMillis();
 861     System.out.println(&quot;test_sllv_add: &quot; + (end - start));
 862 
 863     start = System.currentTimeMillis();
 864     for (int i=0; i&lt;ITERS; i++) {
 865       test_srlc_add(a0, a1);
 866     }
 867     end = System.currentTimeMillis();
 868     System.out.println(&quot;test_srlc_add: &quot; + (end - start));
 869     start = System.currentTimeMillis();
 870     for (int i=0; i&lt;ITERS; i++) {
 871       test_srlv_add(a0, a1, ADD_INIT);
 872     }
 873     end = System.currentTimeMillis();
 874     System.out.println(&quot;test_srlv_add: &quot; + (end - start));
 875 
 876     start = System.currentTimeMillis();
 877     for (int i=0; i&lt;ITERS; i++) {
 878       test_srac_add(a0, a1);
 879     }
 880     end = System.currentTimeMillis();
 881     System.out.println(&quot;test_srac_add: &quot; + (end - start));
 882     start = System.currentTimeMillis();
 883     for (int i=0; i&lt;ITERS; i++) {
 884       test_srav_add(a0, a1, ADD_INIT);
 885     }
 886     end = System.currentTimeMillis();
 887     System.out.println(&quot;test_srav_add: &quot; + (end - start));
 888 
 889     start = System.currentTimeMillis();
 890     for (int i=0; i&lt;ITERS; i++) {
 891       test_sllc_and(a0, a1);
 892     }
 893     end = System.currentTimeMillis();
 894     System.out.println(&quot;test_sllc_and: &quot; + (end - start));
 895     start = System.currentTimeMillis();
 896     for (int i=0; i&lt;ITERS; i++) {
 897       test_sllv_and(a0, a1, BIT_MASK);
 898     }
 899     end = System.currentTimeMillis();
 900     System.out.println(&quot;test_sllv_and: &quot; + (end - start));
 901 
 902     start = System.currentTimeMillis();
 903     for (int i=0; i&lt;ITERS; i++) {
 904       test_srlc_and(a0, a1);
 905     }
 906     end = System.currentTimeMillis();
 907     System.out.println(&quot;test_srlc_and: &quot; + (end - start));
 908     start = System.currentTimeMillis();
 909     for (int i=0; i&lt;ITERS; i++) {
 910       test_srlv_and(a0, a1, BIT_MASK);
 911     }
 912     end = System.currentTimeMillis();
 913     System.out.println(&quot;test_srlv_and: &quot; + (end - start));
 914 
 915     start = System.currentTimeMillis();
 916     for (int i=0; i&lt;ITERS; i++) {
 917       test_srac_and(a0, a1);
 918     }
 919     end = System.currentTimeMillis();
 920     System.out.println(&quot;test_srac_and: &quot; + (end - start));
 921     start = System.currentTimeMillis();
 922     for (int i=0; i&lt;ITERS; i++) {
 923       test_srav_and(a0, a1, BIT_MASK);
 924     }
 925     end = System.currentTimeMillis();
 926     System.out.println(&quot;test_srav_and: &quot; + (end - start));
 927 
 928     start = System.currentTimeMillis();
 929     for (int i=0; i&lt;ITERS; i++) {
 930       test_pack2(p2, a1);
 931     }
 932     end = System.currentTimeMillis();
 933     System.out.println(&quot;test_pack2: &quot; + (end - start));
 934     start = System.currentTimeMillis();
 935     for (int i=0; i&lt;ITERS; i++) {
 936       test_unpack2(a0, p2);
 937     }
 938     end = System.currentTimeMillis();
 939     System.out.println(&quot;test_unpack2: &quot; + (end - start));
 940     start = System.currentTimeMillis();
 941     for (int i=0; i&lt;ITERS; i++) {
 942       test_pack2_swap(p2, a1);
 943     }
 944     end = System.currentTimeMillis();
 945     System.out.println(&quot;test_pack2_swap: &quot; + (end - start));
 946     start = System.currentTimeMillis();
 947     for (int i=0; i&lt;ITERS; i++) {
 948       test_unpack2_swap(a0, p2);
 949     }
 950     end = System.currentTimeMillis();
 951     System.out.println(&quot;test_unpack2_swap: &quot; + (end - start));
 952 
 953     start = System.currentTimeMillis();
 954     for (int i=0; i&lt;ITERS; i++) {
 955       test_pack4(p4, a1);
 956     }
 957     end = System.currentTimeMillis();
 958     System.out.println(&quot;test_pack4: &quot; + (end - start));
 959     start = System.currentTimeMillis();
 960     for (int i=0; i&lt;ITERS; i++) {
 961       test_unpack4(a0, p4);
 962     }
 963     end = System.currentTimeMillis();
 964     System.out.println(&quot;test_unpack4: &quot; + (end - start));
 965     start = System.currentTimeMillis();
 966     for (int i=0; i&lt;ITERS; i++) {
 967       test_pack4_swap(p4, a1);
 968     }
 969     end = System.currentTimeMillis();
 970     System.out.println(&quot;test_pack4_swap: &quot; + (end - start));
 971     start = System.currentTimeMillis();
 972     for (int i=0; i&lt;ITERS; i++) {
 973       test_unpack4_swap(a0, p4);
 974     }
 975     end = System.currentTimeMillis();
 976     System.out.println(&quot;test_unpack4_swap: &quot; + (end - start));
 977 
 978     return errn;
 979   }
 980 
 981   static int test_sum(char[] a1) {
 982     int sum = 0;
 983     for (int i = 0; i &lt; a1.length; i+=1) {
 984       sum += a1[i];
 985     }
 986     return sum;
 987   }
 988 
 989   static void test_addc(char[] a0, char[] a1) {
 990     for (int i = 0; i &lt; a0.length; i+=1) {
 991       a0[i] = (char)(a1[i]+VALUE);
 992     }
 993   }
 994   static void test_addv(char[] a0, char[] a1, char b) {
 995     for (int i = 0; i &lt; a0.length; i+=1) {
 996       a0[i] = (char)(a1[i]+b);
 997     }
 998   }
 999   static void test_adda(char[] a0, char[] a1, short[] a2) {
1000     for (int i = 0; i &lt; a0.length; i+=1) {
1001       a0[i] = (char)(a1[i]+a2[i]);
1002     }
1003   }
1004 
1005   static void test_subc(char[] a0, char[] a1) {
1006     for (int i = 0; i &lt; a0.length; i+=1) {
1007       a0[i] = (char)(a1[i]-VALUE);
1008     }
1009   }
1010   static void test_subv(char[] a0, char[] a1, char b) {
1011     for (int i = 0; i &lt; a0.length; i+=1) {
1012       a0[i] = (char)(a1[i]-b);
1013     }
1014   }
1015   static void test_suba(char[] a0, char[] a1, short[] a2) {
1016     for (int i = 0; i &lt; a0.length; i+=1) {
1017       a0[i] = (char)(a1[i]-a2[i]);
1018     }
1019   }
1020 
1021   static void test_mulc(char[] a0, char[] a1) {
1022     for (int i = 0; i &lt; a0.length; i+=1) {
1023       a0[i] = (char)(a1[i]*VALUE);
1024     }
1025   }
1026   static void test_mulc_n(char[] a0, char[] a1) {
1027     for (int i = 0; i &lt; a0.length; i+=1) {
1028       a0[i] = (char)(a1[i]*(-VALUE));
1029     }
1030   }
1031   static void test_mulv(char[] a0, char[] a1, char b) {
1032     for (int i = 0; i &lt; a0.length; i+=1) {
1033       a0[i] = (char)(a1[i]*b);
1034     }
1035   }
1036   static void test_mula(char[] a0, char[] a1, short[] a2) {
1037     for (int i = 0; i &lt; a0.length; i+=1) {
1038       a0[i] = (char)(a1[i]*a2[i]);
1039     }
1040   }
1041 
1042   static void test_divc(char[] a0, char[] a1) {
1043     for (int i = 0; i &lt; a0.length; i+=1) {
1044       a0[i] = (char)(a1[i]/VALUE);
1045     }
1046   }
1047   static void test_divc_n(char[] a0, char[] a1) {
1048     for (int i = 0; i &lt; a0.length; i+=1) {
1049       a0[i] = (char)(a1[i]/(-VALUE));
1050     }
1051   }
1052   static void test_divv(char[] a0, char[] a1, int b) {
1053     for (int i = 0; i &lt; a0.length; i+=1) {
1054       a0[i] = (char)(a1[i]/b);
1055     }
1056   }
1057   static void test_diva(char[] a0, char[] a1, short[] a2) {
1058     for (int i = 0; i &lt; a0.length; i+=1) {
1059       a0[i] = (char)(a1[i]/a2[i]);
1060     }
1061   }
1062 
1063   static void test_andc(char[] a0, char[] a1) {
1064     for (int i = 0; i &lt; a0.length; i+=1) {
1065       a0[i] = (char)(a1[i]&amp;BIT_MASK);
1066     }
1067   }
1068   static void test_andv(char[] a0, char[] a1, short b) {
1069     for (int i = 0; i &lt; a0.length; i+=1) {
1070       a0[i] = (char)(a1[i]&amp;b);
1071     }
1072   }
1073   static void test_anda(char[] a0, char[] a1, short[] a2) {
1074     for (int i = 0; i &lt; a0.length; i+=1) {
1075       a0[i] = (char)(a1[i]&amp;a2[i]);
1076     }
1077   }
1078 
1079   static void test_orc(char[] a0, char[] a1) {
1080     for (int i = 0; i &lt; a0.length; i+=1) {
1081       a0[i] = (char)(a1[i]|BIT_MASK);
1082     }
1083   }
1084   static void test_orv(char[] a0, char[] a1, short b) {
1085     for (int i = 0; i &lt; a0.length; i+=1) {
1086       a0[i] = (char)(a1[i]|b);
1087     }
1088   }
1089   static void test_ora(char[] a0, char[] a1, short[] a2) {
1090     for (int i = 0; i &lt; a0.length; i+=1) {
1091       a0[i] = (char)(a1[i]|a2[i]);
1092     }
1093   }
1094 
1095   static void test_xorc(char[] a0, char[] a1) {
1096     for (int i = 0; i &lt; a0.length; i+=1) {
1097       a0[i] = (char)(a1[i]^BIT_MASK);
1098     }
1099   }
1100   static void test_xorv(char[] a0, char[] a1, short b) {
1101     for (int i = 0; i &lt; a0.length; i+=1) {
1102       a0[i] = (char)(a1[i]^b);
1103     }
1104   }
1105   static void test_xora(char[] a0, char[] a1, short[] a2) {
1106     for (int i = 0; i &lt; a0.length; i+=1) {
1107       a0[i] = (char)(a1[i]^a2[i]);
1108     }
1109   }
1110 
1111   static void test_sllc(char[] a0, char[] a1) {
1112     for (int i = 0; i &lt; a0.length; i+=1) {
1113       a0[i] = (char)(a1[i]&lt;&lt;VALUE);
1114     }
1115   }
1116   static void test_sllc_n(char[] a0, char[] a1) {
1117     for (int i = 0; i &lt; a0.length; i+=1) {
1118       a0[i] = (char)(a1[i]&lt;&lt;(-VALUE));
1119     }
1120   }
1121   static void test_sllc_o(char[] a0, char[] a1) {
1122     for (int i = 0; i &lt; a0.length; i+=1) {
1123       a0[i] = (char)(a1[i]&lt;&lt;SHIFT);
1124     }
1125   }
1126   static void test_sllc_on(char[] a0, char[] a1) {
1127     for (int i = 0; i &lt; a0.length; i+=1) {
1128       a0[i] = (char)(a1[i]&lt;&lt;(-SHIFT));
1129     }
1130   }
1131   static void test_sllv(char[] a0, char[] a1, int b) {
1132     for (int i = 0; i &lt; a0.length; i+=1) {
1133       a0[i] = (char)(a1[i]&lt;&lt;b);
1134     }
1135   }
1136   static void test_sllc_add(char[] a0, char[] a1) {
1137     for (int i = 0; i &lt; a0.length; i+=1) {
1138       a0[i] = (char)((a1[i] + ADD_INIT)&lt;&lt;VALUE);
1139     }
1140   }
1141   static void test_sllv_add(char[] a0, char[] a1, int b) {
1142     for (int i = 0; i &lt; a0.length; i+=1) {
1143       a0[i] = (char)((a1[i] + b)&lt;&lt;VALUE);
1144     }
1145   }
1146   static void test_sllc_and(char[] a0, char[] a1) {
1147     for (int i = 0; i &lt; a0.length; i+=1) {
1148       a0[i] = (char)((a1[i] &amp; BIT_MASK)&lt;&lt;VALUE);
1149     }
1150   }
1151   static void test_sllv_and(char[] a0, char[] a1, int b) {
1152     for (int i = 0; i &lt; a0.length; i+=1) {
1153       a0[i] = (char)((a1[i] &amp; b)&lt;&lt;VALUE);
1154     }
1155   }
1156 
1157   static void test_srlc(char[] a0, char[] a1) {
1158     for (int i = 0; i &lt; a0.length; i+=1) {
1159       a0[i] = (char)(a1[i]&gt;&gt;&gt;VALUE);
1160     }
1161   }
1162   static void test_srlc_n(char[] a0, char[] a1) {
1163     for (int i = 0; i &lt; a0.length; i+=1) {
1164       a0[i] = (char)(a1[i]&gt;&gt;&gt;(-VALUE));
1165     }
1166   }
1167   static void test_srlc_o(char[] a0, char[] a1) {
1168     for (int i = 0; i &lt; a0.length; i+=1) {
1169       a0[i] = (char)(a1[i]&gt;&gt;&gt;SHIFT);
1170     }
1171   }
1172   static void test_srlc_on(char[] a0, char[] a1) {
1173     for (int i = 0; i &lt; a0.length; i+=1) {
1174       a0[i] = (char)(a1[i]&gt;&gt;&gt;(-SHIFT));
1175     }
1176   }
1177   static void test_srlv(char[] a0, char[] a1, int b) {
1178     for (int i = 0; i &lt; a0.length; i+=1) {
1179       a0[i] = (char)(a1[i]&gt;&gt;&gt;b);
1180     }
1181   }
1182   static void test_srlc_add(char[] a0, char[] a1) {
1183     for (int i = 0; i &lt; a0.length; i+=1) {
1184       a0[i] = (char)((a1[i] + ADD_INIT)&gt;&gt;&gt;VALUE);
1185     }
1186   }
1187   static void test_srlv_add(char[] a0, char[] a1, int b) {
1188     for (int i = 0; i &lt; a0.length; i+=1) {
1189       a0[i] = (char)((a1[i] + b)&gt;&gt;&gt;VALUE);
1190     }
1191   }
1192   static void test_srlc_and(char[] a0, char[] a1) {
1193     for (int i = 0; i &lt; a0.length; i+=1) {
1194       a0[i] = (char)((a1[i] &amp; BIT_MASK)&gt;&gt;&gt;VALUE);
1195     }
1196   }
1197   static void test_srlv_and(char[] a0, char[] a1, int b) {
1198     for (int i = 0; i &lt; a0.length; i+=1) {
1199       a0[i] = (char)((a1[i] &amp; b)&gt;&gt;&gt;VALUE);
1200     }
1201   }
1202 
1203   static void test_srac(char[] a0, char[] a1) {
1204     for (int i = 0; i &lt; a0.length; i+=1) {
1205       a0[i] = (char)(a1[i]&gt;&gt;VALUE);
1206     }
1207   }
1208   static void test_srac_n(char[] a0, char[] a1) {
1209     for (int i = 0; i &lt; a0.length; i+=1) {
1210       a0[i] = (char)(a1[i]&gt;&gt;(-VALUE));
1211     }
1212   }
1213   static void test_srac_o(char[] a0, char[] a1) {
1214     for (int i = 0; i &lt; a0.length; i+=1) {
1215       a0[i] = (char)(a1[i]&gt;&gt;SHIFT);
1216     }
1217   }
1218   static void test_srac_on(char[] a0, char[] a1) {
1219     for (int i = 0; i &lt; a0.length; i+=1) {
1220       a0[i] = (char)(a1[i]&gt;&gt;(-SHIFT));
1221     }
1222   }
1223   static void test_srav(char[] a0, char[] a1, int b) {
1224     for (int i = 0; i &lt; a0.length; i+=1) {
1225       a0[i] = (char)(a1[i]&gt;&gt;b);
1226     }
1227   }
1228   static void test_srac_add(char[] a0, char[] a1) {
1229     for (int i = 0; i &lt; a0.length; i+=1) {
1230       a0[i] = (char)((a1[i] + ADD_INIT)&gt;&gt;VALUE);
1231     }
1232   }
1233   static void test_srav_add(char[] a0, char[] a1, int b) {
1234     for (int i = 0; i &lt; a0.length; i+=1) {
1235       a0[i] = (char)((a1[i] + b)&gt;&gt;VALUE);
1236     }
1237   }
1238   static void test_srac_and(char[] a0, char[] a1) {
1239     for (int i = 0; i &lt; a0.length; i+=1) {
1240       a0[i] = (char)((a1[i] &amp; BIT_MASK)&gt;&gt;VALUE);
1241     }
1242   }
1243   static void test_srav_and(char[] a0, char[] a1, int b) {
1244     for (int i = 0; i &lt; a0.length; i+=1) {
1245       a0[i] = (char)((a1[i] &amp; b)&gt;&gt;VALUE);
1246     }
1247   }
1248 
1249   static void test_pack2(int[] p2, char[] a1) {
1250     if (p2.length*2 &gt; a1.length) return;
1251     for (int i = 0; i &lt; p2.length; i+=1) {
1252       int l0 = (int)a1[i*2+0];
1253       int l1 = (int)a1[i*2+1];
1254       p2[i] = (l1 &lt;&lt; 16) | (l0 &amp; 0xFFFF);
1255     }
1256   }
1257   static void test_unpack2(char[] a0, int[] p2) {
1258     if (p2.length*2 &gt; a0.length) return;
1259     for (int i = 0; i &lt; p2.length; i+=1) {
1260       int l = p2[i];
1261       a0[i*2+0] = (char)(l &amp; 0xFFFF);
1262       a0[i*2+1] = (char)(l &gt;&gt; 16);
1263     }
1264   }
1265   static void test_pack2_swap(int[] p2, char[] a1) {
1266     if (p2.length*2 &gt; a1.length) return;
1267     for (int i = 0; i &lt; p2.length; i+=1) {
1268       int l0 = (int)a1[i*2+0];
1269       int l1 = (int)a1[i*2+1];
1270       p2[i] = (l0 &lt;&lt; 16) | (l1 &amp; 0xFFFF);
1271     }
1272   }
1273   static void test_unpack2_swap(char[] a0, int[] p2) {
1274     if (p2.length*2 &gt; a0.length) return;
1275     for (int i = 0; i &lt; p2.length; i+=1) {
1276       int l = p2[i];
1277       a0[i*2+0] = (char)(l &gt;&gt; 16);
1278       a0[i*2+1] = (char)(l &amp; 0xFFFF);
1279     }
1280   }
1281 
1282   static void test_pack4(long[] p4, char[] a1) {
1283     if (p4.length*4 &gt; a1.length) return;
1284     for (int i = 0; i &lt; p4.length; i+=1) {
1285       long l0 = (long)a1[i*4+0];
1286       long l1 = (long)a1[i*4+1];
1287       long l2 = (long)a1[i*4+2];
1288       long l3 = (long)a1[i*4+3];
1289       p4[i] = (l0 &amp; 0xFFFFl) |
1290              ((l1 &amp; 0xFFFFl) &lt;&lt; 16) |
1291              ((l2 &amp; 0xFFFFl) &lt;&lt; 32) |
1292              ((l3 &amp; 0xFFFFl) &lt;&lt; 48);
1293     }
1294   }
1295   static void test_unpack4(char[] a0, long[] p4) {
1296     if (p4.length*4 &gt; a0.length) return;
1297     for (int i = 0; i &lt; p4.length; i+=1) {
1298       long l = p4[i];
1299       a0[i*4+0] = (char)(l &amp; 0xFFFFl);
1300       a0[i*4+1] = (char)(l &gt;&gt; 16);
1301       a0[i*4+2] = (char)(l &gt;&gt; 32);
1302       a0[i*4+3] = (char)(l &gt;&gt; 48);
1303     }
1304   }
1305   static void test_pack4_swap(long[] p4, char[] a1) {
1306     if (p4.length*4 &gt; a1.length) return;
1307     for (int i = 0; i &lt; p4.length; i+=1) {
1308       long l0 = (long)a1[i*4+0];
1309       long l1 = (long)a1[i*4+1];
1310       long l2 = (long)a1[i*4+2];
1311       long l3 = (long)a1[i*4+3];
1312       p4[i] = (l3 &amp; 0xFFFFl) |
1313              ((l2 &amp; 0xFFFFl) &lt;&lt; 16) |
1314              ((l1 &amp; 0xFFFFl) &lt;&lt; 32) |
1315              ((l0 &amp; 0xFFFFl) &lt;&lt; 48);
1316     }
1317   }
1318   static void test_unpack4_swap(char[] a0, long[] p4) {
1319     if (p4.length*4 &gt; a0.length) return;
1320     for (int i = 0; i &lt; p4.length; i+=1) {
1321       long l = p4[i];
1322       a0[i*4+0] = (char)(l &gt;&gt; 48);
1323       a0[i*4+1] = (char)(l &gt;&gt; 32);
1324       a0[i*4+2] = (char)(l &gt;&gt; 16);
1325       a0[i*4+3] = (char)(l &amp; 0xFFFFl);
1326     }
1327   }
1328 
1329   static int verify(String text, int i, int elem, int val) {
1330     if (elem != val) {
1331       System.err.println(text + &quot;[&quot; + i + &quot;] = &quot; + elem + &quot; != &quot; + val);
1332       return 1;
1333     }
1334     return 0;
1335   }
1336 
1337   static int verify(String text, int i, long elem, long val) {
1338     if (elem != val) {
1339       System.err.println(text + &quot;[&quot; + i + &quot;] = &quot; + Long.toHexString(elem) + &quot; != &quot; + Long.toHexString(val));
1340       return 1;
1341     }
1342     return 0;
1343   }
1344 }
    </pre>
  </body>
</html>