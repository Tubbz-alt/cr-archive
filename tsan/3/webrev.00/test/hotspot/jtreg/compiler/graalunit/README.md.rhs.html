<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames test/hotspot/jtreg/compiler/graalunit/README.md</title>
    <link rel="stylesheet" href="../../../../../style.css" />
    <script type="text/javascript" src="../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre> 1 This directory contains jtreg tests which are wrapper tests to execute Graal unit tests similar way they are run in Graal project.
 2 The tests use compiler.graalunit.common.GraalUnitTestLauncher helper class to run Graal unit tests where the set of tests to execute
 3 is specified by &#39;-prefix&#39; argument. GraalUnitTestLauncher launches ported com.oracle.mxtool.junit.MxJUnitWrapper to run Graal unit
 4 tests as it is done by &quot;mx unittest&quot; command from Graal project.
 5 
 6 All compiler/graalunit/*.java tests were automatically generated by generateTests.sh script which reads
 7 &quot;testName -&gt; testPrefix [requiresStatement]&quot; mapping from TestPackages.txt file and generates corresponding &lt;testName&gt;Test.java
 8 tests. The mapping takes into account tests execution time to avoid very long test runs.
 9 
10 Graal unit tests depends on following external jar files:
11  asm-5.0.4.jar:
12  https://lafo.ssw.uni-linz.ac.at/pub/graal-external-deps/asm-5.0.4.jar
13 
14  asm-tree-5.0.4.jar:
15  https://lafo.ssw.uni-linz.ac.at/pub/graal-external-deps/asm-tree-5.0.4.jar
16 
17  junit-4.12.jar:
18  https://lafo.ssw.uni-linz.ac.at/pub/graal-external-deps/junit-4.12.jar
19 
20  hamcrest-core-1.3.jar:
21  https://lafo.ssw.uni-linz.ac.at/pub/graal-external-deps/hamcrest-core-1.3.jar
22 
23  java-allocation-instrumenter.jar:
<a name="1" id="anc1"></a><span class="line-modified">24  https://lafo.ssw.uni-linz.ac.at/pub/java-allocation-instrumenter/java-allocation-instrumenter.jar</span>
25 
26 Before running the tests you need to download these jars from above locations in build/&lt;platform&gt;/images/test/hotspot/jtreg/graal/
<a name="2" id="anc2"></a><span class="line-modified">27 directory. You can use &#39;downloadLibs.sh&#39; script which will try to download all these libs using wget.</span>
<span class="line-modified">28 </span>
<span class="line-added">29 </span>
<span class="line-added">30 Then you can run Graal unit test(s) using &#39;make run-test&#39;:</span>
<span class="line-added">31 </span>
<span class="line-added">32 &gt; make run-test TEST=&quot;compiler/graalunit/ApiTest.java&quot; TEST_VM_OPTS=&quot;-server -XX:+UnlockExperimentalVMOptions -XX:+EnableJVMCI&quot;</span>
<span class="line-added">33 </span>
<span class="line-added">34 </span>
<span class="line-added">35 If you want to use jtreg directly you need to say jtreg where to find external jars.</span>
<span class="line-added">36 You can do it by passing additional option &quot;-vmoptions:-Dgraalunit.libs=&quot; or setting environment variable by using &quot;-e:TEST_IMAGE_GRAAL_DIR=...&quot;</span>
37 
38 Example:
<a name="3" id="anc3"></a><span class="line-modified">39 &gt; jtreg -vt -jdk:&lt;TESTED_JDK&gt; -vmoptions:&quot;-server -XX:+UnlockExperimentalVMOptions -XX:+EnableJVMCI&quot;</span>
<span class="line-added">40         -vmoptions:&quot;-Dgraalunit.libs=build/&lt;platform&gt;/images/test/hotspot/jtreg/graal&quot;</span>
41         compiler/graalunit/UtilTest.java
42 
43 To run Graal unit tests in Graal as JIT mode pass additional -vmoptions to jtreg:
44  -XX:+UnlockExperimentalVMOptions -XX:+EnableJVMCI -XX:+TieredCompilation -XX:+UseJVMCICompiler -Djvmci.Compiler=graal
45 
<a name="4" id="anc4"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="4" type="hidden" />
</body>
</html>