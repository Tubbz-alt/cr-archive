<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/hotspot/jtreg/compiler/intrinsics/klass/TestIsPrimitive.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="CastNullCheckDroppingsTest.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../sha/cli/SHAOptionsBase.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/compiler/intrinsics/klass/TestIsPrimitive.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -22,16 +22,17 @@</span>
   */
  
  /*
   * @test
   * @bug 8150669
<span class="udiff-line-added">+  * @bug 8233019</span>
   * @summary C1 intrinsic for Class.isPrimitive
   * @modules java.base/jdk.internal.misc
   *
   * @run main/othervm -ea -Diters=200   -Xint
   *      compiler.intrinsics.klass.TestIsPrimitive
<span class="udiff-line-modified-removed">-  * @run main/othervm -ea -Diters=30000 -XX:TieredStopAtLevel=1</span>
<span class="udiff-line-modified-added">+  * @run main/othervm -ea -XX:-UseSharedSpaces -Diters=30000 -XX:TieredStopAtLevel=1</span>
   *      compiler.intrinsics.klass.TestIsPrimitive
   * @run main/othervm -ea -Diters=30000 -XX:TieredStopAtLevel=4
   *      compiler.intrinsics.klass.TestIsPrimitive
   */
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -51,10 +52,11 @@</span>
          testOK(true,  InlineConstants::testFloat);
          testOK(true,  InlineConstants::testLong);
          testOK(true,  InlineConstants::testDouble);
          testOK(false, InlineConstants::testObject);
          testOK(false, InlineConstants::testArray);
<span class="udiff-line-added">+         testOK(false, InlineConstants::testBooleanArray);</span>
  
          testOK(true,  StaticConstants::testBoolean);
          testOK(true,  StaticConstants::testByte);
          testOK(true,  StaticConstants::testShort);
          testOK(true,  StaticConstants::testChar);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -62,10 +64,11 @@</span>
          testOK(true,  StaticConstants::testFloat);
          testOK(true,  StaticConstants::testLong);
          testOK(true,  StaticConstants::testDouble);
          testOK(false, StaticConstants::testObject);
          testOK(false, StaticConstants::testArray);
<span class="udiff-line-added">+         testOK(false, StaticConstants::testBooleanArray);</span>
          testNPE(      StaticConstants::testNull);
  
          testOK(true,  NoConstants::testBoolean);
          testOK(true,  NoConstants::testByte);
          testOK(true,  NoConstants::testShort);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -74,10 +77,11 @@</span>
          testOK(true,  NoConstants::testFloat);
          testOK(true,  NoConstants::testLong);
          testOK(true,  NoConstants::testDouble);
          testOK(false, NoConstants::testObject);
          testOK(false, NoConstants::testArray);
<span class="udiff-line-added">+         testOK(false, NoConstants::testBooleanArray);</span>
          testNPE(      NoConstants::testNull);
      }
  
      public static void testOK(boolean expected, Callable&lt;Object&gt; test) throws Exception {
          for (int c = 0; c &lt; ITERS; c++) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -110,10 +114,11 @@</span>
      static volatile Class&lt;?&gt; classLong    = long.class;
      static volatile Class&lt;?&gt; classDouble  = double.class;
      static volatile Class&lt;?&gt; classObject  = Object.class;
      static volatile Class&lt;?&gt; classArray   = Object[].class;
      static volatile Class&lt;?&gt; classNull    = null;
<span class="udiff-line-added">+     static volatile Class&lt;?&gt; classBooleanArray = boolean[].class;</span>
  
      static final Class&lt;?&gt; staticClassBoolean = boolean.class;
      static final Class&lt;?&gt; staticClassByte    = byte.class;
      static final Class&lt;?&gt; staticClassShort   = short.class;
      static final Class&lt;?&gt; staticClassChar    = char.class;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -122,10 +127,11 @@</span>
      static final Class&lt;?&gt; staticClassLong    = long.class;
      static final Class&lt;?&gt; staticClassDouble  = double.class;
      static final Class&lt;?&gt; staticClassObject  = Object.class;
      static final Class&lt;?&gt; staticClassArray   = Object[].class;
      static final Class&lt;?&gt; staticClassNull    = null;
<span class="udiff-line-added">+     static final Class&lt;?&gt; staticClassBooleanArray = boolean[].class;</span>
  
      static class InlineConstants {
          static boolean testBoolean() { return boolean.class.isPrimitive();  }
          static boolean testByte()    { return byte.class.isPrimitive();     }
          static boolean testShort()   { return short.class.isPrimitive();    }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -134,10 +140,11 @@</span>
          static boolean testFloat()   { return float.class.isPrimitive();    }
          static boolean testLong()    { return long.class.isPrimitive();     }
          static boolean testDouble()  { return double.class.isPrimitive();   }
          static boolean testObject()  { return Object.class.isPrimitive();   }
          static boolean testArray()   { return Object[].class.isPrimitive(); }
<span class="udiff-line-added">+         static boolean testBooleanArray() { return boolean[].class.isPrimitive(); }</span>
      }
  
      static class StaticConstants {
          static boolean testBoolean() { return staticClassBoolean.isPrimitive(); }
          static boolean testByte()    { return staticClassByte.isPrimitive();    }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -148,10 +155,11 @@</span>
          static boolean testLong()    { return staticClassLong.isPrimitive();    }
          static boolean testDouble()  { return staticClassDouble.isPrimitive();  }
          static boolean testObject()  { return staticClassObject.isPrimitive();  }
          static boolean testArray()   { return staticClassArray.isPrimitive();   }
          static boolean testNull()    { return staticClassNull.isPrimitive();    }
<span class="udiff-line-added">+         static boolean testBooleanArray() { return staticClassBooleanArray.isPrimitive(); }</span>
      }
  
      static class NoConstants {
          static boolean testBoolean() { return classBoolean.isPrimitive(); }
          static boolean testByte()    { return classByte.isPrimitive();    }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -162,9 +170,11 @@</span>
          static boolean testLong()    { return classLong.isPrimitive();    }
          static boolean testDouble()  { return classDouble.isPrimitive();  }
          static boolean testObject()  { return classObject.isPrimitive();  }
          static boolean testArray()   { return classArray.isPrimitive();   }
          static boolean testNull()    { return classNull.isPrimitive();    }
<span class="udiff-line-added">+         static boolean testBooleanArray() { return classBooleanArray.isPrimitive();    }</span>
      }
  
<span class="udiff-line-added">+ </span>
  }
  
</pre>
<center><a href="CastNullCheckDroppingsTest.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../sha/cli/SHAOptionsBase.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>