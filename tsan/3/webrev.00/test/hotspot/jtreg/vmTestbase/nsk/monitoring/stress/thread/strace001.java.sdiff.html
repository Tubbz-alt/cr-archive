<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/vmTestbase/nsk/monitoring/stress/thread/strace001.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../share/thread/SynchronizerLockingThreads.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../share/README.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/vmTestbase/nsk/monitoring/stress/thread/strace001.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
345             log.display(&quot;OutOfMemoryError is thrown in thread &quot; + num);
346         } catch (StackOverflowError e) {
347             // Recursion is too deep, so exit peacefully
348             log.display(&quot;StackOverflowError is thrown in thread &quot; + num);
349         }
350     } // run()
351 
352     private void recursionJava(int maxDepth, int currentDepth) {
353         // A short delay. Otherwise the method will reach the specified depth
354         // almost instantly
355         try {
356             sleep(1);
357         } catch (InterruptedException e) {
358             log.complain(&quot;Unexpected exception&quot;);
359             e.printStackTrace(log.getOutStream());
360             strace001.testFailed = true;
361         }
362 
363         currentDepth++;
364         if (maxDepth &gt; currentDepth) {
<span class="line-modified">365             yield();</span>
366             if (mixed) {
367                 int result = recursionNative(maxDepth, currentDepth, true);
368 
369                  if (result == 1) {
370                      log.display(&quot;Fatal error (OutOfMemoryError or &quot;
371                                + &quot;StackOverflow) is thrown in native method of &quot;
372                                + &quot; thread &quot; + num);
373                      return;
374                  } else if (result == 2) {
375                      log.complain(&quot;Unexpected exception is thrown in native &quot;
376                                 + &quot;method of thread &quot; + num);
377                      strace001.testFailed = true;
378                      return;
379                  }
380             } else
381                 recursionJava(maxDepth, currentDepth);
382         }
383 
384         waitForSign();
385     } // recursionJava()
</pre>
</td>
<td>
<hr />
<pre>
345             log.display(&quot;OutOfMemoryError is thrown in thread &quot; + num);
346         } catch (StackOverflowError e) {
347             // Recursion is too deep, so exit peacefully
348             log.display(&quot;StackOverflowError is thrown in thread &quot; + num);
349         }
350     } // run()
351 
352     private void recursionJava(int maxDepth, int currentDepth) {
353         // A short delay. Otherwise the method will reach the specified depth
354         // almost instantly
355         try {
356             sleep(1);
357         } catch (InterruptedException e) {
358             log.complain(&quot;Unexpected exception&quot;);
359             e.printStackTrace(log.getOutStream());
360             strace001.testFailed = true;
361         }
362 
363         currentDepth++;
364         if (maxDepth &gt; currentDepth) {
<span class="line-modified">365             Thread.yield();</span>
366             if (mixed) {
367                 int result = recursionNative(maxDepth, currentDepth, true);
368 
369                  if (result == 1) {
370                      log.display(&quot;Fatal error (OutOfMemoryError or &quot;
371                                + &quot;StackOverflow) is thrown in native method of &quot;
372                                + &quot; thread &quot; + num);
373                      return;
374                  } else if (result == 2) {
375                      log.complain(&quot;Unexpected exception is thrown in native &quot;
376                                 + &quot;method of thread &quot; + num);
377                      strace001.testFailed = true;
378                      return;
379                  }
380             } else
381                 recursionJava(maxDepth, currentDepth);
382         }
383 
384         waitForSign();
385     } // recursionJava()
</pre>
</td>
</tr>
</table>
<center><a href="../../share/thread/SynchronizerLockingThreads.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../share/README.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>