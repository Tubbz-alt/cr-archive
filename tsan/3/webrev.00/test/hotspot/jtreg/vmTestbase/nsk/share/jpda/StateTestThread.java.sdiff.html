<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/vmTestbase/nsk/share/jpda/StateTestThread.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../jni/README.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../jvmti/jvmti_tools.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/vmTestbase/nsk/share/jpda/StateTestThread.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 94 
 95         // try acquire the same lock as auxiliaryThread, switch state to &#39;wait on monitor&#39;
 96         synchronized (this) {
 97 
 98         }
 99     }
100 
101     private int currentState = 1;
102 
103     public void nextState() {
104         // check is thread states change as expected
105         if (isExecutedWithErrors)
106             throw new TestBug(errorMessage);
107 
108         switch (currentState++) {
109         case 1:
110             // start thread
111             start();
112 
113             while (!isRunning)
<span class="line-modified">114                 yield();</span>
115 
116             break;
117         case 2:
118             // stop running
119             isRunning = false;
120 
121             while (this.getState() != Thread.State.TIMED_WAITING)
<span class="line-modified">122                 yield();</span>
123 
124             break;
125         case 3:
126             waitState = true;
127 
128             // stop sleeping
129             interrupt();
130 
131             while (getState() != Thread.State.WAITING)
<span class="line-modified">132                 yield();</span>
133 
134             break;
135         case 4:
136             waitState = false;
137 
138             // stop wait
139             synchronized (waitOnObject) {
140                 waitOnObject.notify();
141             }
142 
143             while (!readyToBeBlocked || (getState() != Thread.State.BLOCKED))
<span class="line-modified">144                 yield();</span>
145 
146             break;
147         case 5:
148             // let StateTestThread thread acquire lock
149             auxiliaryThread.releaseLock();
150             try {
151                 join();
152             } catch (InterruptedException e) {
153                 throw new TestBug(&quot;Unexpected exception: &quot; + e);
154             }
155             break;
156 
157         default:
158             throw new TestBug(&quot;Invalid thread state&quot;);
159         }
160     }
161 }
</pre>
</td>
<td>
<hr />
<pre>
 94 
 95         // try acquire the same lock as auxiliaryThread, switch state to &#39;wait on monitor&#39;
 96         synchronized (this) {
 97 
 98         }
 99     }
100 
101     private int currentState = 1;
102 
103     public void nextState() {
104         // check is thread states change as expected
105         if (isExecutedWithErrors)
106             throw new TestBug(errorMessage);
107 
108         switch (currentState++) {
109         case 1:
110             // start thread
111             start();
112 
113             while (!isRunning)
<span class="line-modified">114                 Thread.yield();</span>
115 
116             break;
117         case 2:
118             // stop running
119             isRunning = false;
120 
121             while (this.getState() != Thread.State.TIMED_WAITING)
<span class="line-modified">122                 Thread.yield();</span>
123 
124             break;
125         case 3:
126             waitState = true;
127 
128             // stop sleeping
129             interrupt();
130 
131             while (getState() != Thread.State.WAITING)
<span class="line-modified">132                 Thread.yield();</span>
133 
134             break;
135         case 4:
136             waitState = false;
137 
138             // stop wait
139             synchronized (waitOnObject) {
140                 waitOnObject.notify();
141             }
142 
143             while (!readyToBeBlocked || (getState() != Thread.State.BLOCKED))
<span class="line-modified">144                 Thread.yield();</span>
145 
146             break;
147         case 5:
148             // let StateTestThread thread acquire lock
149             auxiliaryThread.releaseLock();
150             try {
151                 join();
152             } catch (InterruptedException e) {
153                 throw new TestBug(&quot;Unexpected exception: &quot; + e);
154             }
155             break;
156 
157         default:
158             throw new TestBug(&quot;Invalid thread state&quot;);
159         }
160     }
161 }
</pre>
</td>
</tr>
</table>
<center><a href="../jni/README.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../jvmti/jvmti_tools.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>