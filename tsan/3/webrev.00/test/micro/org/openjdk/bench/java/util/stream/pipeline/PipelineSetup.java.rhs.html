<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames test/micro/org/openjdk/bench/java/util/stream/pipeline/PipelineSetup.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 2014, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 package org.openjdk.bench.java.util.stream.pipeline;
 24 
 25 import org.openjdk.jmh.annotations.Benchmark;
 26 import org.openjdk.jmh.annotations.BenchmarkMode;
 27 import org.openjdk.jmh.annotations.Mode;
 28 import org.openjdk.jmh.annotations.OutputTimeUnit;
 29 import org.openjdk.jmh.annotations.Param;
 30 import org.openjdk.jmh.annotations.Scope;
 31 import org.openjdk.jmh.annotations.State;
 32 
 33 import java.util.concurrent.TimeUnit;
 34 import java.util.stream.LongStream;
 35 
 36 /**
 37  * Benchmark tests the pipeline construction costs.
 38  */
 39 @BenchmarkMode(Mode.AverageTime)
 40 @OutputTimeUnit(TimeUnit.NANOSECONDS)
 41 @State(Scope.Thread)
 42 public class PipelineSetup {
 43 
 44     /**
 45      * This is one of the few benchmarks where measuring running time makes sense.
 46      */
 47 
 48     @Param(&quot;100000&quot;)
 49     private int size;
 50 
 51     @Benchmark
 52     public Object baseline_newObject() {
 53         return new Object();
 54     }
 55 
 56     @Benchmark
 57     public LongStream seq_test00() {
 58         return LongStream.range(0, size);
 59     }
 60 
 61     @Benchmark
 62     public LongStream seq_test01() {
 63         return LongStream.range(0, size)
 64                 .filter((x) -&gt; false);
 65     }
 66 
 67     @Benchmark
 68     public LongStream seq_test02() {
 69         return LongStream.range(0, size)
 70                 .filter((x) -&gt; false)
 71                 .filter((x) -&gt; false);
 72     }
 73 
 74     @Benchmark
 75     public LongStream seq_test04() {
 76         return LongStream.range(0, size)
 77                 .filter((x) -&gt; false)
 78                 .filter((x) -&gt; false)
 79                 .filter((x) -&gt; false)
 80                 .filter((x) -&gt; false);
 81     }
 82 
 83     @Benchmark
 84     public LongStream seq_test08() {
 85         return LongStream.range(0, size)
 86                 .filter((x) -&gt; false)
 87                 .filter((x) -&gt; false)
 88                 .filter((x) -&gt; false)
 89                 .filter((x) -&gt; false)
 90 
 91                 .filter((x) -&gt; false)
 92                 .filter((x) -&gt; false)
 93                 .filter((x) -&gt; false)
 94                 .filter((x) -&gt; false);
 95     }
 96 
 97     @Benchmark
 98     public LongStream seq_test16() {
 99         return LongStream.range(0, size)
100                 .filter((x) -&gt; false)
101                 .filter((x) -&gt; false)
102                 .filter((x) -&gt; false)
103                 .filter((x) -&gt; false)
104 
105                 .filter((x) -&gt; false)
106                 .filter((x) -&gt; false)
107                 .filter((x) -&gt; false)
108                 .filter((x) -&gt; false)
109 
110                 .filter((x) -&gt; false)
111                 .filter((x) -&gt; false)
112                 .filter((x) -&gt; false)
113                 .filter((x) -&gt; false)
114 
115                 .filter((x) -&gt; false)
116                 .filter((x) -&gt; false)
117                 .filter((x) -&gt; false)
118                 .filter((x) -&gt; false);
119     }
120 
121     @Benchmark
122     public LongStream par_test00() {
123         return LongStream.range(0, size).parallel();
124     }
125 
126     @Benchmark
127     public LongStream par_test01() {
128         return LongStream.range(0, size).parallel()
129                 .filter((x) -&gt; false);
130     }
131 
132     @Benchmark
133     public LongStream par_test02() {
134         return LongStream.range(0, size).parallel()
135                 .filter((x) -&gt; false)
136                 .filter((x) -&gt; false);
137     }
138 
139     @Benchmark
140     public LongStream par_test04() {
141         return LongStream.range(0, size).parallel()
142                 .filter((x) -&gt; false)
143                 .filter((x) -&gt; false)
144                 .filter((x) -&gt; false)
145                 .filter((x) -&gt; false);
146     }
147 
148     @Benchmark
149     public LongStream par_test08() {
150         return LongStream.range(0, size).parallel()
151                 .filter((x) -&gt; false)
152                 .filter((x) -&gt; false)
153                 .filter((x) -&gt; false)
154                 .filter((x) -&gt; false)
155 
156                 .filter((x) -&gt; false)
157                 .filter((x) -&gt; false)
158                 .filter((x) -&gt; false)
159                 .filter((x) -&gt; false);
160     }
161 
162     @Benchmark
163     public LongStream par_test16() {
164         return LongStream.range(0, size).parallel()
165                 .filter((x) -&gt; false)
166                 .filter((x) -&gt; false)
167                 .filter((x) -&gt; false)
168                 .filter((x) -&gt; false)
169 
170                 .filter((x) -&gt; false)
171                 .filter((x) -&gt; false)
172                 .filter((x) -&gt; false)
173                 .filter((x) -&gt; false)
174 
175                 .filter((x) -&gt; false)
176                 .filter((x) -&gt; false)
177                 .filter((x) -&gt; false)
178                 .filter((x) -&gt; false)
179 
180                 .filter((x) -&gt; false)
181                 .filter((x) -&gt; false)
182                 .filter((x) -&gt; false)
183                 .filter((x) -&gt; false);
184     }
185 
186 }
<a name="2" id="anc2"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="2" type="hidden" />
</body>
</html>