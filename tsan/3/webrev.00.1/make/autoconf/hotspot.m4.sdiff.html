<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/autoconf/hotspot.m4</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../index.html" target="_top">index</a> <a href="spec.gmk.in.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/autoconf/hotspot.m4</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
 23 # questions.
 24 #
 25 
 26 # All valid JVM features, regardless of platform
 27 VALID_JVM_FEATURES=&quot;compiler1 compiler2 zero minimal dtrace jvmti jvmci \
 28     graal vm-structs jni-check services management epsilongc g1gc parallelgc serialgc shenandoahgc zgc nmt cds \
<span class="line-modified"> 29     static-build link-time-opt aot jfr&quot;</span>
 30 
 31 # Deprecated JVM features (these are ignored, but with a warning)
 32 DEPRECATED_JVM_FEATURES=&quot;trace cmsgc&quot;
 33 
 34 # All valid JVM variants
 35 VALID_JVM_VARIANTS=&quot;server client minimal core zero custom&quot;
 36 
 37 ###############################################################################
 38 # Check if the specified JVM variant should be built. To be used in shell if
 39 # constructs, like this:
 40 # if HOTSPOT_CHECK_JVM_VARIANT(server); then
 41 #
 42 # Only valid to use after HOTSPOT_SETUP_JVM_VARIANTS has setup variants.
 43 
 44 # Definition kept in one line to allow inlining in if statements.
 45 # Additional [] needed to keep m4 from mangling shell constructs.
 46 AC_DEFUN([HOTSPOT_CHECK_JVM_VARIANT],
 47 [ [ [[ &quot; $JVM_VARIANTS &quot; =~ &quot; $1 &quot; ]] ] ])
 48 
 49 ###############################################################################
</pre>
<hr />
<pre>
532       fi
533     fi
534   fi
535 
536   AC_MSG_CHECKING([if cds should be enabled])
537   if test &quot;x$ENABLE_CDS&quot; = &quot;xtrue&quot;; then
538     if test &quot;x$enable_cds&quot; = &quot;xyes&quot;; then
539       AC_MSG_RESULT([yes, forced])
540     else
541       AC_MSG_RESULT([yes])
542     fi
543     NON_MINIMAL_FEATURES=&quot;$NON_MINIMAL_FEATURES cds&quot;
544   else
545     if test &quot;x$enable_cds&quot; = &quot;xno&quot;; then
546       AC_MSG_RESULT([no, forced])
547     else
548       AC_MSG_RESULT([no])
549     fi
550   fi
551 









































552   # Enable features depending on variant.
553   JVM_FEATURES_server=&quot;compiler1 compiler2 $NON_MINIMAL_FEATURES $JVM_FEATURES $JVM_FEATURES_jvmci $JVM_FEATURES_aot $JVM_FEATURES_graal&quot;
554   JVM_FEATURES_client=&quot;compiler1 $NON_MINIMAL_FEATURES $JVM_FEATURES&quot;
555   JVM_FEATURES_core=&quot;$NON_MINIMAL_FEATURES $JVM_FEATURES&quot;
556   JVM_FEATURES_minimal=&quot;compiler1 minimal serialgc $JVM_FEATURES $JVM_FEATURES_link_time_opt&quot;
557   JVM_FEATURES_zero=&quot;zero $NON_MINIMAL_FEATURES $JVM_FEATURES&quot;
558   JVM_FEATURES_custom=&quot;$JVM_FEATURES&quot;
559 
560   AC_SUBST(JVM_FEATURES_server)
561   AC_SUBST(JVM_FEATURES_client)
562   AC_SUBST(JVM_FEATURES_core)
563   AC_SUBST(JVM_FEATURES_minimal)
564   AC_SUBST(JVM_FEATURES_zero)
565   AC_SUBST(JVM_FEATURES_custom)
566 
567   # Used for verification of Makefiles by check-jvm-feature
568   AC_SUBST(VALID_JVM_FEATURES)
569 
570   # --with-cpu-port is no longer supported
571   BASIC_DEPRECATED_ARG_WITH(with-cpu-port)
</pre>
</td>
<td>
<hr />
<pre>
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
 23 # questions.
 24 #
 25 
 26 # All valid JVM features, regardless of platform
 27 VALID_JVM_FEATURES=&quot;compiler1 compiler2 zero minimal dtrace jvmti jvmci \
 28     graal vm-structs jni-check services management epsilongc g1gc parallelgc serialgc shenandoahgc zgc nmt cds \
<span class="line-modified"> 29     static-build link-time-opt aot jfr tsan&quot;</span>
 30 
 31 # Deprecated JVM features (these are ignored, but with a warning)
 32 DEPRECATED_JVM_FEATURES=&quot;trace cmsgc&quot;
 33 
 34 # All valid JVM variants
 35 VALID_JVM_VARIANTS=&quot;server client minimal core zero custom&quot;
 36 
 37 ###############################################################################
 38 # Check if the specified JVM variant should be built. To be used in shell if
 39 # constructs, like this:
 40 # if HOTSPOT_CHECK_JVM_VARIANT(server); then
 41 #
 42 # Only valid to use after HOTSPOT_SETUP_JVM_VARIANTS has setup variants.
 43 
 44 # Definition kept in one line to allow inlining in if statements.
 45 # Additional [] needed to keep m4 from mangling shell constructs.
 46 AC_DEFUN([HOTSPOT_CHECK_JVM_VARIANT],
 47 [ [ [[ &quot; $JVM_VARIANTS &quot; =~ &quot; $1 &quot; ]] ] ])
 48 
 49 ###############################################################################
</pre>
<hr />
<pre>
532       fi
533     fi
534   fi
535 
536   AC_MSG_CHECKING([if cds should be enabled])
537   if test &quot;x$ENABLE_CDS&quot; = &quot;xtrue&quot;; then
538     if test &quot;x$enable_cds&quot; = &quot;xyes&quot;; then
539       AC_MSG_RESULT([yes, forced])
540     else
541       AC_MSG_RESULT([yes])
542     fi
543     NON_MINIMAL_FEATURES=&quot;$NON_MINIMAL_FEATURES cds&quot;
544   else
545     if test &quot;x$enable_cds&quot; = &quot;xno&quot;; then
546       AC_MSG_RESULT([no, forced])
547     else
548       AC_MSG_RESULT([no])
549     fi
550   fi
551 
<span class="line-added">552   AC_MSG_CHECKING([if tsan should be built])</span>
<span class="line-added">553   # Check if user explicitly disabled tsan</span>
<span class="line-added">554   if HOTSPOT_IS_JVM_FEATURE_DISABLED(tsan); then</span>
<span class="line-added">555     AC_MSG_RESULT([no, forced])</span>
<span class="line-added">556     INCLUDE_TSAN=&quot;false&quot;</span>
<span class="line-added">557   # Only enable ThreadSanitizer on supported platforms</span>
<span class="line-added">558   elif test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xlinux&quot; &amp;&amp; test &quot;x$OPENJDK_TARGET_CPU&quot; = &quot;xx86_64&quot;; then</span>
<span class="line-added">559     AC_MSG_RESULT([yes])</span>
<span class="line-added">560     NON_MINIMAL_FEATURES=&quot;$NON_MINIMAL_FEATURES tsan&quot;</span>
<span class="line-added">561     INCLUDE_TSAN=&quot;true&quot;</span>
<span class="line-added">562   else</span>
<span class="line-added">563     AC_MSG_RESULT([no, platform not supported])</span>
<span class="line-added">564     INCLUDE_TSAN=&quot;false&quot;</span>
<span class="line-added">565     if HOTSPOT_CHECK_JVM_FEATURE(tsan); then</span>
<span class="line-added">566       AC_MSG_ERROR([ThreadSanitizer is currently not supported on this platform.])</span>
<span class="line-added">567     fi</span>
<span class="line-added">568   fi</span>
<span class="line-added">569 </span>
<span class="line-added">570   # Add a configure option --&lt;enable|disable&gt;-tsan-launcher to allow</span>
<span class="line-added">571   # more control on whether to link TSAN runtime with the launcher.</span>
<span class="line-added">572   AC_ARG_ENABLE([tsan-launcher], [AS_HELP_STRING([--enable-tsan-launcher],</span>
<span class="line-added">573       [link tsan runtime with the default JDK launcher. Default is consistent with whether tsan feature is enabled.])])</span>
<span class="line-added">574   AC_MSG_CHECKING([if tsan should be linked with JDK launcher])</span>
<span class="line-added">575   if test &quot;x$INCLUDE_TSAN&quot; = &quot;xtrue&quot;; then</span>
<span class="line-added">576     if test &quot;x$enable_tsan_launcher&quot; = &quot;xyes&quot;; then</span>
<span class="line-added">577       AC_MSG_RESULT([yes, forced])</span>
<span class="line-added">578     elif test &quot;x$enable_tsan_launcher&quot; = &quot;xno&quot;; then</span>
<span class="line-added">579       AC_MSG_RESULT([no, forced])</span>
<span class="line-added">580       INCLUDE_TSAN=&quot;false&quot;</span>
<span class="line-added">581     else</span>
<span class="line-added">582       AC_MSG_RESULT([yes, default])</span>
<span class="line-added">583     fi</span>
<span class="line-added">584   else</span>
<span class="line-added">585     AC_MSG_RESULT([no, tsan feature is disabled])</span>
<span class="line-added">586     if test &quot;x$enable_tsan_launcher&quot; = &quot;xyes&quot;; then</span>
<span class="line-added">587       AC_MSG_ERROR([--enable-tsan-launcher can only be used when tsan feature is enabled.])</span>
<span class="line-added">588     fi</span>
<span class="line-added">589   fi</span>
<span class="line-added">590 </span>
<span class="line-added">591   AC_SUBST(INCLUDE_TSAN)</span>
<span class="line-added">592 </span>
593   # Enable features depending on variant.
594   JVM_FEATURES_server=&quot;compiler1 compiler2 $NON_MINIMAL_FEATURES $JVM_FEATURES $JVM_FEATURES_jvmci $JVM_FEATURES_aot $JVM_FEATURES_graal&quot;
595   JVM_FEATURES_client=&quot;compiler1 $NON_MINIMAL_FEATURES $JVM_FEATURES&quot;
596   JVM_FEATURES_core=&quot;$NON_MINIMAL_FEATURES $JVM_FEATURES&quot;
597   JVM_FEATURES_minimal=&quot;compiler1 minimal serialgc $JVM_FEATURES $JVM_FEATURES_link_time_opt&quot;
598   JVM_FEATURES_zero=&quot;zero $NON_MINIMAL_FEATURES $JVM_FEATURES&quot;
599   JVM_FEATURES_custom=&quot;$JVM_FEATURES&quot;
600 
601   AC_SUBST(JVM_FEATURES_server)
602   AC_SUBST(JVM_FEATURES_client)
603   AC_SUBST(JVM_FEATURES_core)
604   AC_SUBST(JVM_FEATURES_minimal)
605   AC_SUBST(JVM_FEATURES_zero)
606   AC_SUBST(JVM_FEATURES_custom)
607 
608   # Used for verification of Makefiles by check-jvm-feature
609   AC_SUBST(VALID_JVM_FEATURES)
610 
611   # --with-cpu-port is no longer supported
612   BASIC_DEPRECATED_ARG_WITH(with-cpu-port)
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../index.html" target="_top">index</a> <a href="spec.gmk.in.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>