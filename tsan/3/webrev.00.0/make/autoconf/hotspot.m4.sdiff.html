<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/autoconf/hotspot.m4</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../index.html" target="_top">index</a> <a href="spec.gmk.in.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/autoconf/hotspot.m4</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 #
<span class="line-modified">  2 # Copyright (c) 2011, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
 23 # questions.
 24 #
 25 
 26 # All valid JVM features, regardless of platform
 27 VALID_JVM_FEATURES=&quot;compiler1 compiler2 zero minimal dtrace jvmti jvmci \
<span class="line-modified"> 28     graal vm-structs jni-check services management cmsgc epsilongc g1gc parallelgc serialgc shenandoahgc zgc nmt cds \</span>
 29     static-build link-time-opt aot jfr tsan&quot;
 30 
 31 # Deprecated JVM features (these are ignored, but with a warning)
<span class="line-modified"> 32 DEPRECATED_JVM_FEATURES=&quot;trace&quot;</span>
 33 
 34 # All valid JVM variants
 35 VALID_JVM_VARIANTS=&quot;server client minimal core zero custom&quot;
 36 
 37 ###############################################################################
 38 # Check if the specified JVM variant should be built. To be used in shell if
 39 # constructs, like this:
 40 # if HOTSPOT_CHECK_JVM_VARIANT(server); then
 41 #
 42 # Only valid to use after HOTSPOT_SETUP_JVM_VARIANTS has setup variants.
 43 
 44 # Definition kept in one line to allow inlining in if statements.
 45 # Additional [] needed to keep m4 from mangling shell constructs.
 46 AC_DEFUN([HOTSPOT_CHECK_JVM_VARIANT],
 47 [ [ [[ &quot; $JVM_VARIANTS &quot; =~ &quot; $1 &quot; ]] ] ])
 48 
 49 ###############################################################################
 50 # Check if the specified JVM feature is enabled. To be used in shell if
 51 # constructs, like this:
 52 # if HOTSPOT_CHECK_JVM_FEATURE(jvmti); then
</pre>
<hr />
<pre>
309 
310   # Override hotspot cpu definitions for ARM platforms
311   if test &quot;x$OPENJDK_TARGET_CPU&quot; = xarm; then
312     HOTSPOT_TARGET_CPU=arm_32
313     HOTSPOT_TARGET_CPU_DEFINE=&quot;ARM32&quot;
314   fi
315 
316   # Verify that dependencies are met for explicitly set features.
317   if HOTSPOT_CHECK_JVM_FEATURE(jvmti) &amp;&amp; ! HOTSPOT_CHECK_JVM_FEATURE(services); then
318     AC_MSG_ERROR([Specified JVM feature &#39;jvmti&#39; requires feature &#39;services&#39;])
319   fi
320 
321   if HOTSPOT_CHECK_JVM_FEATURE(management) &amp;&amp; ! HOTSPOT_CHECK_JVM_FEATURE(nmt); then
322     AC_MSG_ERROR([Specified JVM feature &#39;management&#39; requires feature &#39;nmt&#39;])
323   fi
324 
325   if HOTSPOT_CHECK_JVM_FEATURE(jvmci) &amp;&amp; ! (HOTSPOT_CHECK_JVM_FEATURE(compiler1) || HOTSPOT_CHECK_JVM_FEATURE(compiler2)); then
326     AC_MSG_ERROR([Specified JVM feature &#39;jvmci&#39; requires feature &#39;compiler2&#39; or &#39;compiler1&#39;])
327   fi
328 
<span class="line-removed">329   if HOTSPOT_CHECK_JVM_FEATURE(cmsgc) &amp;&amp; ! HOTSPOT_CHECK_JVM_FEATURE(serialgc); then</span>
<span class="line-removed">330     AC_MSG_ERROR([Specified JVM feature &#39;cmsgc&#39; requires feature &#39;serialgc&#39;])</span>
<span class="line-removed">331   fi</span>
<span class="line-removed">332 </span>
333   # Enable JFR by default, except for Zero, linux-sparcv9 and on minimal.
334   if ! HOTSPOT_CHECK_JVM_VARIANT(zero); then
335     if test &quot;x$OPENJDK_TARGET_OS&quot; != xaix; then
336       if test &quot;x$OPENJDK_TARGET_OS&quot; != xlinux || test &quot;x$OPENJDK_TARGET_CPU&quot; != xsparcv9; then
337         NON_MINIMAL_FEATURES=&quot;$NON_MINIMAL_FEATURES jfr&quot;
338       fi
339     fi
340   fi
341 
342   # Only enable Shenandoah on supported arches
343   AC_MSG_CHECKING([if shenandoah can be built])
<span class="line-modified">344   if test &quot;x$OPENJDK_TARGET_CPU&quot; = &quot;xx86_64&quot; || test &quot;x$OPENJDK_TARGET_CPU&quot; = &quot;xaarch64&quot; ; then</span>
345     AC_MSG_RESULT([yes])
346   else
347     DISABLED_JVM_FEATURES=&quot;$DISABLED_JVM_FEATURES shenandoahgc&quot;
348     AC_MSG_RESULT([no, platform not supported])
349   fi
350 
351   # Only enable ZGC on supported platforms

















352   AC_MSG_CHECKING([if zgc can be built])
<span class="line-modified">353   if test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xlinux&quot; &amp;&amp; test &quot;x$OPENJDK_TARGET_CPU&quot; = &quot;xx86_64&quot;; then</span>



354     AC_MSG_RESULT([yes])
355   else
356     DISABLED_JVM_FEATURES=&quot;$DISABLED_JVM_FEATURES zgc&quot;
357     AC_MSG_RESULT([no, platform not supported])
358   fi
359 
360   # Disable unsupported GCs for Zero
361   if HOTSPOT_CHECK_JVM_VARIANT(zero); then
362     DISABLED_JVM_FEATURES=&quot;$DISABLED_JVM_FEATURES epsilongc g1gc zgc shenandoahgc&quot;
363   fi
364 
365   # Turn on additional features based on other parts of configure
366   if test &quot;x$INCLUDE_DTRACE&quot; = &quot;xtrue&quot;; then
367     JVM_FEATURES=&quot;$JVM_FEATURES dtrace&quot;
368   else
369     if HOTSPOT_CHECK_JVM_FEATURE(dtrace); then
370       AC_MSG_ERROR([To enable dtrace, you must use --enable-dtrace])
371     fi
372   fi
373 
</pre>
<hr />
<pre>
375     JVM_FEATURES=&quot;$JVM_FEATURES static-build&quot;
376   else
377     if HOTSPOT_CHECK_JVM_FEATURE(static-build); then
378       AC_MSG_ERROR([To enable static-build, you must use --enable-static-build])
379     fi
380   fi
381 
382   if ! HOTSPOT_CHECK_JVM_VARIANT(zero); then
383     if HOTSPOT_CHECK_JVM_FEATURE(zero); then
384       AC_MSG_ERROR([To enable zero, you must use --with-jvm-variants=zero])
385     fi
386   fi
387 
388   AC_MSG_CHECKING([if jvmci module jdk.internal.vm.ci should be built])
389   # Check if jvmci is diabled
390   if HOTSPOT_IS_JVM_FEATURE_DISABLED(jvmci); then
391     AC_MSG_RESULT([no, forced])
392     JVM_FEATURES_jvmci=&quot;&quot;
393     INCLUDE_JVMCI=&quot;false&quot;
394   else
<span class="line-modified">395     # Only enable jvmci on x86_64, sparcv9 and aarch64</span>
396     if test &quot;x$OPENJDK_TARGET_CPU&quot; = &quot;xx86_64&quot; || \
<span class="line-removed">397        test &quot;x$OPENJDK_TARGET_CPU&quot; = &quot;xsparcv9&quot; || \</span>
398        test &quot;x$OPENJDK_TARGET_CPU&quot; = &quot;xaarch64&quot; ; then
399       AC_MSG_RESULT([yes])
400       JVM_FEATURES_jvmci=&quot;jvmci&quot;
401       INCLUDE_JVMCI=&quot;true&quot;
402     else
403       AC_MSG_RESULT([no])
404       JVM_FEATURES_jvmci=&quot;&quot;
405       INCLUDE_JVMCI=&quot;false&quot;
406       if HOTSPOT_CHECK_JVM_FEATURE(jvmci); then
407         AC_MSG_ERROR([JVMCI is currently not supported on this platform.])
408       fi
409     fi
410   fi
411 
412   AC_SUBST(INCLUDE_JVMCI)
413 
414   AC_MSG_CHECKING([if graal module jdk.internal.vm.compiler should be built])
415   # Check if graal is diabled
416   if HOTSPOT_IS_JVM_FEATURE_DISABLED(graal); then
417     AC_MSG_RESULT([no, forced])
</pre>
<hr />
<pre>
473       AC_MSG_RESULT([no, forced])
474     else
475       AC_MSG_RESULT([no])
476     fi
477     JVM_FEATURES_aot=&quot;&quot;
478     if HOTSPOT_CHECK_JVM_FEATURE(aot); then
479       AC_MSG_ERROR([To enable aot, you must use --enable-aot])
480     fi
481   fi
482 
483   AC_SUBST(ENABLE_AOT)
484 
485   if test &quot;x$OPENJDK_TARGET_CPU&quot; = xarm ; then
486     # Default to use link time optimizations on minimal on arm
487     JVM_FEATURES_link_time_opt=&quot;link-time-opt&quot;
488   else
489     JVM_FEATURES_link_time_opt=&quot;&quot;
490   fi
491 
492   # All variants but minimal (and custom) get these features
<span class="line-modified">493   NON_MINIMAL_FEATURES=&quot;$NON_MINIMAL_FEATURES cmsgc g1gc parallelgc serialgc epsilongc shenandoahgc jni-check jvmti management nmt services vm-structs zgc&quot;</span>
494 
495   # Disable CDS on AIX.
496   if test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xaix&quot;; then
497     ENABLE_CDS=&quot;false&quot;
498     if test &quot;x$enable_cds&quot; = &quot;xyes&quot;; then
499       AC_MSG_ERROR([CDS is currently not supported on AIX. Remove --enable-cds.])
500     fi
501   fi
502 
503   # Disable CDS if user requested it with --with-jvm-features=-cds.
504   if HOTSPOT_IS_JVM_FEATURE_DISABLED(cds); then
505     ENABLE_CDS=&quot;false&quot;
506     if test &quot;x$enable_cds&quot; = &quot;xyes&quot;; then
507       AC_MSG_ERROR([CDS was disabled by --with-jvm-features=-cds. Remove --enable-cds.])
508     fi
509   fi
510 
<span class="line-modified">511   # Disable CDS for zero, minimal, core..</span>
<span class="line-removed">512   if HOTSPOT_CHECK_JVM_VARIANT(zero) || HOTSPOT_CHECK_JVM_VARIANT(minimal) || HOTSPOT_CHECK_JVM_VARIANT(core); then</span>
513     # ..except when the user explicitely requested it with --enable-jvm-features
514     if ! HOTSPOT_CHECK_JVM_FEATURE(cds); then
515       ENABLE_CDS=&quot;false&quot;
516       if test &quot;x$enable_cds&quot; = &quot;xyes&quot;; then
517         AC_MSG_ERROR([CDS not implemented for variants zero, minimal, core. Remove --enable-cds.])
518       fi
519     fi
520   fi
521 
522   AC_MSG_CHECKING([if cds should be enabled])
523   if test &quot;x$ENABLE_CDS&quot; = &quot;xtrue&quot;; then
524     if test &quot;x$enable_cds&quot; = &quot;xyes&quot;; then
525       AC_MSG_RESULT([yes, forced])
526     else
527       AC_MSG_RESULT([yes])
528     fi
529     NON_MINIMAL_FEATURES=&quot;$NON_MINIMAL_FEATURES cds&quot;
530   else
531     if test &quot;x$enable_cds&quot; = &quot;xno&quot;; then
532       AC_MSG_RESULT([no, forced])
</pre>
</td>
<td>
<hr />
<pre>
  1 #
<span class="line-modified">  2 # Copyright (c) 2011, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
 23 # questions.
 24 #
 25 
 26 # All valid JVM features, regardless of platform
 27 VALID_JVM_FEATURES=&quot;compiler1 compiler2 zero minimal dtrace jvmti jvmci \
<span class="line-modified"> 28     graal vm-structs jni-check services management epsilongc g1gc parallelgc serialgc shenandoahgc zgc nmt cds \</span>
 29     static-build link-time-opt aot jfr tsan&quot;
 30 
 31 # Deprecated JVM features (these are ignored, but with a warning)
<span class="line-modified"> 32 DEPRECATED_JVM_FEATURES=&quot;trace cmsgc&quot;</span>
 33 
 34 # All valid JVM variants
 35 VALID_JVM_VARIANTS=&quot;server client minimal core zero custom&quot;
 36 
 37 ###############################################################################
 38 # Check if the specified JVM variant should be built. To be used in shell if
 39 # constructs, like this:
 40 # if HOTSPOT_CHECK_JVM_VARIANT(server); then
 41 #
 42 # Only valid to use after HOTSPOT_SETUP_JVM_VARIANTS has setup variants.
 43 
 44 # Definition kept in one line to allow inlining in if statements.
 45 # Additional [] needed to keep m4 from mangling shell constructs.
 46 AC_DEFUN([HOTSPOT_CHECK_JVM_VARIANT],
 47 [ [ [[ &quot; $JVM_VARIANTS &quot; =~ &quot; $1 &quot; ]] ] ])
 48 
 49 ###############################################################################
 50 # Check if the specified JVM feature is enabled. To be used in shell if
 51 # constructs, like this:
 52 # if HOTSPOT_CHECK_JVM_FEATURE(jvmti); then
</pre>
<hr />
<pre>
309 
310   # Override hotspot cpu definitions for ARM platforms
311   if test &quot;x$OPENJDK_TARGET_CPU&quot; = xarm; then
312     HOTSPOT_TARGET_CPU=arm_32
313     HOTSPOT_TARGET_CPU_DEFINE=&quot;ARM32&quot;
314   fi
315 
316   # Verify that dependencies are met for explicitly set features.
317   if HOTSPOT_CHECK_JVM_FEATURE(jvmti) &amp;&amp; ! HOTSPOT_CHECK_JVM_FEATURE(services); then
318     AC_MSG_ERROR([Specified JVM feature &#39;jvmti&#39; requires feature &#39;services&#39;])
319   fi
320 
321   if HOTSPOT_CHECK_JVM_FEATURE(management) &amp;&amp; ! HOTSPOT_CHECK_JVM_FEATURE(nmt); then
322     AC_MSG_ERROR([Specified JVM feature &#39;management&#39; requires feature &#39;nmt&#39;])
323   fi
324 
325   if HOTSPOT_CHECK_JVM_FEATURE(jvmci) &amp;&amp; ! (HOTSPOT_CHECK_JVM_FEATURE(compiler1) || HOTSPOT_CHECK_JVM_FEATURE(compiler2)); then
326     AC_MSG_ERROR([Specified JVM feature &#39;jvmci&#39; requires feature &#39;compiler2&#39; or &#39;compiler1&#39;])
327   fi
328 




329   # Enable JFR by default, except for Zero, linux-sparcv9 and on minimal.
330   if ! HOTSPOT_CHECK_JVM_VARIANT(zero); then
331     if test &quot;x$OPENJDK_TARGET_OS&quot; != xaix; then
332       if test &quot;x$OPENJDK_TARGET_OS&quot; != xlinux || test &quot;x$OPENJDK_TARGET_CPU&quot; != xsparcv9; then
333         NON_MINIMAL_FEATURES=&quot;$NON_MINIMAL_FEATURES jfr&quot;
334       fi
335     fi
336   fi
337 
338   # Only enable Shenandoah on supported arches
339   AC_MSG_CHECKING([if shenandoah can be built])
<span class="line-modified">340   if test &quot;x$OPENJDK_TARGET_CPU_ARCH&quot; = &quot;xx86&quot; || test &quot;x$OPENJDK_TARGET_CPU&quot; = &quot;xaarch64&quot; ; then</span>
341     AC_MSG_RESULT([yes])
342   else
343     DISABLED_JVM_FEATURES=&quot;$DISABLED_JVM_FEATURES shenandoahgc&quot;
344     AC_MSG_RESULT([no, platform not supported])
345   fi
346 
347   # Only enable ZGC on supported platforms
<span class="line-added">348   if (test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xwindows&quot; &amp;&amp; test &quot;x$OPENJDK_TARGET_CPU&quot; = &quot;xx86_64&quot;); then</span>
<span class="line-added">349     AC_MSG_CHECKING([if zgc can be built on windows])</span>
<span class="line-added">350     AC_COMPILE_IFELSE(</span>
<span class="line-added">351       [AC_LANG_PROGRAM([[#include &lt;windows.h&gt;]],</span>
<span class="line-added">352         [[struct MEM_EXTENDED_PARAMETER x;]])</span>
<span class="line-added">353       ],</span>
<span class="line-added">354       [</span>
<span class="line-added">355         AC_MSG_RESULT([yes])</span>
<span class="line-added">356         CAN_BUILD_ZGC_ON_WINDOWS=&quot;yes&quot;</span>
<span class="line-added">357       ],</span>
<span class="line-added">358       [</span>
<span class="line-added">359         AC_MSG_RESULT([no, missing required APIs])</span>
<span class="line-added">360         CAN_BUILD_ZGC_ON_WINDOWS=&quot;no&quot;</span>
<span class="line-added">361       ]</span>
<span class="line-added">362     )</span>
<span class="line-added">363   fi</span>
<span class="line-added">364 </span>
365   AC_MSG_CHECKING([if zgc can be built])
<span class="line-modified">366   if (test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xlinux&quot; &amp;&amp; test &quot;x$OPENJDK_TARGET_CPU&quot; = &quot;xx86_64&quot;) || \</span>
<span class="line-added">367      (test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xlinux&quot; &amp;&amp; test &quot;x$OPENJDK_TARGET_CPU&quot; = &quot;xaarch64&quot;) || \</span>
<span class="line-added">368      (test &quot;x$CAN_BUILD_ZGC_ON_WINDOWS&quot; = &quot;xyes&quot;) || \</span>
<span class="line-added">369      (test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xmacosx&quot; &amp;&amp; test &quot;x$OPENJDK_TARGET_CPU&quot; = &quot;xx86_64&quot;); then</span>
370     AC_MSG_RESULT([yes])
371   else
372     DISABLED_JVM_FEATURES=&quot;$DISABLED_JVM_FEATURES zgc&quot;
373     AC_MSG_RESULT([no, platform not supported])
374   fi
375 
376   # Disable unsupported GCs for Zero
377   if HOTSPOT_CHECK_JVM_VARIANT(zero); then
378     DISABLED_JVM_FEATURES=&quot;$DISABLED_JVM_FEATURES epsilongc g1gc zgc shenandoahgc&quot;
379   fi
380 
381   # Turn on additional features based on other parts of configure
382   if test &quot;x$INCLUDE_DTRACE&quot; = &quot;xtrue&quot;; then
383     JVM_FEATURES=&quot;$JVM_FEATURES dtrace&quot;
384   else
385     if HOTSPOT_CHECK_JVM_FEATURE(dtrace); then
386       AC_MSG_ERROR([To enable dtrace, you must use --enable-dtrace])
387     fi
388   fi
389 
</pre>
<hr />
<pre>
391     JVM_FEATURES=&quot;$JVM_FEATURES static-build&quot;
392   else
393     if HOTSPOT_CHECK_JVM_FEATURE(static-build); then
394       AC_MSG_ERROR([To enable static-build, you must use --enable-static-build])
395     fi
396   fi
397 
398   if ! HOTSPOT_CHECK_JVM_VARIANT(zero); then
399     if HOTSPOT_CHECK_JVM_FEATURE(zero); then
400       AC_MSG_ERROR([To enable zero, you must use --with-jvm-variants=zero])
401     fi
402   fi
403 
404   AC_MSG_CHECKING([if jvmci module jdk.internal.vm.ci should be built])
405   # Check if jvmci is diabled
406   if HOTSPOT_IS_JVM_FEATURE_DISABLED(jvmci); then
407     AC_MSG_RESULT([no, forced])
408     JVM_FEATURES_jvmci=&quot;&quot;
409     INCLUDE_JVMCI=&quot;false&quot;
410   else
<span class="line-modified">411     # Only enable jvmci on x86_64 and aarch64</span>
412     if test &quot;x$OPENJDK_TARGET_CPU&quot; = &quot;xx86_64&quot; || \

413        test &quot;x$OPENJDK_TARGET_CPU&quot; = &quot;xaarch64&quot; ; then
414       AC_MSG_RESULT([yes])
415       JVM_FEATURES_jvmci=&quot;jvmci&quot;
416       INCLUDE_JVMCI=&quot;true&quot;
417     else
418       AC_MSG_RESULT([no])
419       JVM_FEATURES_jvmci=&quot;&quot;
420       INCLUDE_JVMCI=&quot;false&quot;
421       if HOTSPOT_CHECK_JVM_FEATURE(jvmci); then
422         AC_MSG_ERROR([JVMCI is currently not supported on this platform.])
423       fi
424     fi
425   fi
426 
427   AC_SUBST(INCLUDE_JVMCI)
428 
429   AC_MSG_CHECKING([if graal module jdk.internal.vm.compiler should be built])
430   # Check if graal is diabled
431   if HOTSPOT_IS_JVM_FEATURE_DISABLED(graal); then
432     AC_MSG_RESULT([no, forced])
</pre>
<hr />
<pre>
488       AC_MSG_RESULT([no, forced])
489     else
490       AC_MSG_RESULT([no])
491     fi
492     JVM_FEATURES_aot=&quot;&quot;
493     if HOTSPOT_CHECK_JVM_FEATURE(aot); then
494       AC_MSG_ERROR([To enable aot, you must use --enable-aot])
495     fi
496   fi
497 
498   AC_SUBST(ENABLE_AOT)
499 
500   if test &quot;x$OPENJDK_TARGET_CPU&quot; = xarm ; then
501     # Default to use link time optimizations on minimal on arm
502     JVM_FEATURES_link_time_opt=&quot;link-time-opt&quot;
503   else
504     JVM_FEATURES_link_time_opt=&quot;&quot;
505   fi
506 
507   # All variants but minimal (and custom) get these features
<span class="line-modified">508   NON_MINIMAL_FEATURES=&quot;$NON_MINIMAL_FEATURES g1gc parallelgc serialgc epsilongc shenandoahgc jni-check jvmti management nmt services vm-structs zgc&quot;</span>
509 
510   # Disable CDS on AIX.
511   if test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xaix&quot;; then
512     ENABLE_CDS=&quot;false&quot;
513     if test &quot;x$enable_cds&quot; = &quot;xyes&quot;; then
514       AC_MSG_ERROR([CDS is currently not supported on AIX. Remove --enable-cds.])
515     fi
516   fi
517 
518   # Disable CDS if user requested it with --with-jvm-features=-cds.
519   if HOTSPOT_IS_JVM_FEATURE_DISABLED(cds); then
520     ENABLE_CDS=&quot;false&quot;
521     if test &quot;x$enable_cds&quot; = &quot;xyes&quot;; then
522       AC_MSG_ERROR([CDS was disabled by --with-jvm-features=-cds. Remove --enable-cds.])
523     fi
524   fi
525 
<span class="line-modified">526   if ! HOTSPOT_CHECK_JVM_VARIANT(server) &amp;&amp; ! HOTSPOT_CHECK_JVM_VARIANT(client); then</span>

527     # ..except when the user explicitely requested it with --enable-jvm-features
528     if ! HOTSPOT_CHECK_JVM_FEATURE(cds); then
529       ENABLE_CDS=&quot;false&quot;
530       if test &quot;x$enable_cds&quot; = &quot;xyes&quot;; then
531         AC_MSG_ERROR([CDS not implemented for variants zero, minimal, core. Remove --enable-cds.])
532       fi
533     fi
534   fi
535 
536   AC_MSG_CHECKING([if cds should be enabled])
537   if test &quot;x$ENABLE_CDS&quot; = &quot;xtrue&quot;; then
538     if test &quot;x$enable_cds&quot; = &quot;xyes&quot;; then
539       AC_MSG_RESULT([yes, forced])
540     else
541       AC_MSG_RESULT([yes])
542     fi
543     NON_MINIMAL_FEATURES=&quot;$NON_MINIMAL_FEATURES cds&quot;
544   else
545     if test &quot;x$enable_cds&quot; = &quot;xno&quot;; then
546       AC_MSG_RESULT([no, forced])
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../index.html" target="_top">index</a> <a href="spec.gmk.in.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>