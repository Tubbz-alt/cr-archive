<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/repositories.html</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
  <body>
    <pre>
  1 &lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;
  2 &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;
  3     &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;
  4 
  5 &lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
  6 &lt;head&gt;
  7   &lt;title&gt;The OpenJDK Developers&amp;apos; Guide: Repositories&lt;/title&gt;
  8   &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;guidestyle.css&quot; /&gt;
  9 &lt;/head&gt;
 10 
 11 &lt;body&gt;
 12 
 13 &lt;h1&gt;Repositories&lt;/h1&gt;
 14 
 15 &lt;div class=&quot;version&quot;&gt;version 0.02&lt;/div&gt;
 16 &lt;div class=&quot;NavBit&quot;&gt;
 17   &lt;a href=&quot;processWorkflow.html&quot;&gt;&amp;laquo;&amp;nbsp;Previous&lt;/a&gt;&amp;nbsp;&amp;bull;&amp;nbsp;&lt;a href=&quot;index.html&quot;&gt;TOC&lt;/a&gt;&amp;nbsp;&amp;bull;&amp;nbsp;&lt;a href=&quot;mailingLists.html&quot;&gt;Next&amp;nbsp;&amp;raquo;&lt;/a&gt;
 18 &lt;/div&gt;
 19 
 20 &lt;p&gt; This section describes the OpenJDK repository terminology and naming
 21 scheme.  It also includes minimal instructions to acquire source from the
 22 OpenJDK repository, 
 23 &lt;a href=&quot;http://hg.openjdk.java.net/&quot;&gt;&lt;code&gt;http://hg.openjdk.java.net/&lt;/code&gt;&lt;/a&gt;. &lt;/p&gt;
 24 
 25 &lt;blockquote&gt;&lt;hr /&gt;
 26 &lt;p&gt; Note that source may be available from other locations, for
 27 example &lt;code&gt;src.zip&lt;/code&gt; from a full JDK distribution.  However, OpenJDK 
 28 contributions must use source from the 
 29 &lt;a href=&quot;http://hg.openjdk.java.net/&quot;&gt;OpenJDK Mercurial repository&lt;/a&gt;
 30 since other source distributions may contain older code or code which differs
 31 due to licensing. &lt;/p&gt;
 32 &lt;hr /&gt;&lt;/blockquote&gt;
 33 
 34 &lt;p&gt; Operations which are performed repeatedly, such as creating changesets,
 35 merging, and pushing are described in &lt;a
 36 href=&quot;producingChangeset.html&quot;&gt;Producing a Changeset&lt;/a&gt;. &lt;/p&gt;
 37 
 38 &lt;ul&gt;
 39 &lt;li&gt;&lt;a href=&quot;#term&quot;&gt;Terminology and Naming Scheme&lt;/a&gt; defines the nomenclature
 40     used by OpenJDK. &lt;/li&gt;
 41 &lt;li&gt;&lt;a href=&quot;#installConfig&quot;&gt;Installing and Configuring Mercurial&lt;/a&gt;
 42     enumerates the required software, provides links for download, and
 43     describes basic installation and configuration. &lt;/li&gt;
 44 &lt;li&gt;&lt;a href=&quot;#clone&quot;&gt;Cloning&lt;/a&gt; covers the procedure for obtaining private
 45     copies of source repositories. &lt;/li&gt;
 46 &lt;/ul&gt;
 47 
 48 &lt;p&gt; This document assumes familiarity with the first two chapters of the
 49 free on-line book &lt;a href=&quot;http://hgbook.red-bean.com&quot;&gt;Mercurial: The
 50 Definitive Guide&lt;/a&gt;. &lt;/p&gt; 
 51 
 52 &lt;h2&gt;&lt;a name=&quot;term&quot;&gt;Terminology and Naming Scheme&lt;/a&gt;&lt;/h2&gt;
 53 
 54 &lt;p&gt; The OpenJDK code base for all 
 55 &lt;a href=&quot;http://openjdk.java.net/bylaws#_6&quot;&gt;Projects&lt;/a&gt; is stored in
 56 Mercurial repositories which contain the source files and their change
 57 history.  Some Projects may choose to organize their code into multiple,
 58 possibly related, Mercurial repositories.  For
 59 instance, &lt;a href=&quot;http://openjdk.java.net/projects/jdk9&quot;&gt;JDK 9&lt;/a&gt; uses a
 60 forest of multiple related repositories which contain components of the entire
 61 JDK.  Projects which are based on the JDK, such as
 62 &lt;a href=&quot;http://openjdk.java.net/projects/icedtea&quot;&gt;IcedTea&lt;/a&gt; and
 63 &lt;a href=&quot;http://openjdk.java.net/projects/jigsaw&quot;&gt;Jigsaw&lt;/a&gt; also
 64 use this model.  In contrast, 
 65 &lt;a href=&quot;http://openjdk.java.net/projects/code-tools&quot;&gt;Code Tools&lt;/a&gt;
 66 uses an unrelated repository for each tool and 
 67 &lt;a href=&quot;http://openjdk.java.net/projects/graal&quot;&gt;Graal&lt;/a&gt; uses only a single
 68 repository.  Regardless of how a Project has chosen to store their code, each 
 69 &lt;a href=&quot;http://openjdk.java.net/bylaws#contributor&quot;&gt;Contributor&lt;/a&gt; clones
 70 the repository associated with the code they are modifying. &lt;/p&gt; 
 71 
 72 &lt;blockquote&gt;&lt;hr /&gt;
 73 &lt;p&gt; Consult the Project&#39;s documentation or
 74 &lt;a href=&quot;http://mail.openjdk.java.net&quot;&gt;mailing list&lt;/a&gt; to determine the
 75 appropriate repository, development conventions, and helpful tools. &lt;/p&gt;
 76 &lt;hr /&gt;&lt;/blockquote&gt;
 77 
 78 &lt;p&gt; This is the typical development model: &lt;/p&gt;
 79 
 80 &lt;p style=&quot;text-align:center;&quot;&gt;
 81 &lt;img src=&quot;devModel.gif&quot;
 82 alt=&quot;Diagram of server repos and user&#39;s clone&quot;/&gt;
 83 &lt;/p&gt;
 84 
 85 &lt;p&gt; A Contributor creates a &lt;em&gt;clone&lt;/em&gt; (a local copy called &quot;9dev&quot;) of a
 86 read/write repository (&quot;jdk9/dev&quot;) which resides on the OpenJDK Mercurial
 87 server.  They work on their change in the clone and locally &lt;em&gt;commit&lt;/em&gt; a
 88 changeset.  After the new changeset(s) are verified, they&#39;re
 89 either &lt;em&gt;pushed&lt;/em&gt; directly from the clone or &lt;em&gt;exported&lt;/em&gt; and
 90 delivered to a
 91 &lt;a href=&quot;http://openjdk.java.net/bylaws#committer&quot;&gt;Committer&lt;/a&gt; who can
 92 perform the push into the server repository for all to see. &lt;/p&gt;
 93 
 94 &lt;blockquote&gt;&lt;hr /&gt;
 95 &lt;p&gt; The use of &lt;em&gt;gate repositories&lt;/em&gt; was eliminated when the Mercurial
 96 servers were upgraded in March 2014. &lt;/p&gt;
 97 &lt;hr /&gt;&lt;/blockquote&gt;
 98 
 99 &lt;p&gt; The repositories use the following naming scheme: &lt;/p&gt;
100 
101 &lt;blockquote&gt;&lt;p&gt;&lt;code&gt;
102 &amp;lt;project&amp;gt;/&amp;lt;component_path&amp;gt;
103 &lt;/code&gt;&lt;/p&gt;&lt;/blockquote&gt;
104 
105 &lt;p&gt; where &lt;/p&gt;
106 &lt;blockquote&gt;&lt;table summary=&quot;naming_scheme&quot;&gt;
107   &lt;tr&gt;
108     &lt;td style=&quot;vertical-align: top; padding-right: 1em;&quot;&gt;&lt;em&gt;project&lt;/em&gt;&lt;/td&gt;
109     &lt;td style=&quot;vertical-align: top; padding-right: 1em;&quot;&gt;::&lt;/td&gt;
110     &lt;td&gt;the short name of an OpenJDK
111         &lt;a href=&quot;http://openjdk.java.net/bylaws#_6&quot;&gt;Project&lt;/a&gt; such as &quot;jdk9&quot;,
112           &quot;openjfx&quot;, or &quot;sumatra&quot;&lt;/td&gt;
113   &lt;/tr&gt;&lt;tr&gt;
114     &lt;td style=&quot;vertical-align: top; padding-right: 1em;&quot;&gt;&lt;em&gt;component_path&lt;/em&gt;&lt;/td&gt;
115     &lt;td style=&quot;vertical-align: top; padding-right: 1em;&quot;&gt;::&lt;/td&gt;
116     &lt;td&gt;the path to a repository containing the code base as designated by the
117         &lt;a href=&quot;http://openjdk.java.net/bylaws#project-lead&quot;&gt;Project Lead&lt;/a&gt;.
118         &lt;/td&gt;  
119   &lt;/tr&gt;
120 &lt;/table&gt;&lt;/blockquote&gt;
121 
122 &lt;h2&gt;&lt;a name=&quot;installConfig&quot;&gt;Installing and Configuring Mercurial&lt;/a&gt;&lt;/h2&gt;
123 
124 &lt;p&gt; Mercurial is a free, cross-platform, distributed source management tool.
125 Source bundles and binary packages for Mercurial are available at
126 &lt;a href=&quot;http://www.selenic.com/mercurial/wiki/index.cgi/Mercurial&quot;&gt;http://www.selenic.com/mercurial/wiki/index.cgi&lt;/a&gt;.
127 The OpenJDK repositories recommend installation of Mercurial 2.6.3 (or later).
128 A Mercurial installation is sufficient to clone a repository.  Contributors
129 who wish to submit changes will need some additional configuration as
130 described below. &lt;/p&gt;
131 
132 &lt;p&gt; Some Projects may recommend additional tools or scripts that help
133 with repository manipulation and code development.  For instance, in
134 JDK 9, the utility script &lt;code&gt;common/bin/hgforest.sh&lt;/code&gt; may be used
135 to apply commands to all the repositories in
136 the &lt;a href=&quot;glossary.html#forest&quot;&gt;forest&lt;/a&gt;.  Popular extensions for
137 OpenJDK developers include
138 &lt;a href=&quot;http://openjdk.java.net/projects/code-tools/jcheck/&quot;&gt;jcheck&lt;/a&gt;,
139 &lt;a href=&quot;http://openjdk.java.net/projects/code-tools/trees/&quot;&gt;trees&lt;/a&gt;, and 
140 &lt;a href=&quot;http://hgbook.red-bean.com/read/managing-change-with-mercurial-queues.html&quot;&gt;Mercurial Queues&lt;/a&gt; (mq).  Note that &lt;code&gt;trees&lt;/code&gt; is enabled on 
141 the OpenJDK Mercurial server. &lt;/p&gt; 
142 
143 &lt;p&gt; Create and edit the &lt;code&gt;~/.hgrc&lt;/code&gt; file to minimally contain the
144 following entry:&lt;/p&gt;
145 
146 &lt;blockquote&gt;&lt;pre&gt;
147 [ui]
148 username = &amp;lt;openjdk_username&amp;gt;
149 &lt;/pre&gt;&lt;/blockquote&gt;
150 
151 &lt;p&gt; &lt;em&gt;openjdk_username&lt;/em&gt; is a plain lowercase, alphanumeric token (not an
152 e-mail address) with twelve characters or less. The first character should be
153 alphabetic.  This username will be publicly visible in all Mercurial changeset
154 logs.  It will be used to verify that the changeset author is at least an
155 &lt;a href=&quot;http://openjdk.java.net/bylaws#author&quot;&gt;Author&lt;/a&gt; for the Project and
156 that the person pushing the changeset is at least a 
157 &lt;a href=&quot;http://openjdk.java.net/bylaws#committer&quot;&gt;Committer&lt;/a&gt;.  It is
158 recommended that the &lt;em&gt;openjdk_username&lt;/em&gt; be somehow related to the
159 Author&#39;s full name, such as the first character of the Author&#39;s first name
160 followed by the Author&#39;s last name.  Refer to
161 the 
162 &lt;a href=&quot;../projects/index.html#project-author&quot;&gt;Becoming an Author&lt;/a&gt; section
163 of the &lt;a href=&quot;../projects/index.html&quot;&gt;Project&lt;/a&gt; page 
164 for additional information. &lt;/p&gt;
165 
166 &lt;p&gt; An alphabetical list of all of the assigned &lt;em&gt;openjdk_usernames&lt;/em&gt; may
167 be found on the &lt;a href=&quot;http://db.openjdk.java.net/people&quot;&gt;OpenJDK
168 people&lt;/a&gt; list.  The &lt;a href=&quot;../census&quot;&gt;Census&lt;/a&gt; shows the structure of
169 the OpenJDK Community. &lt;/p&gt;
170 
171 &lt;h3&gt;&lt;a name=&quot;verify&quot;&gt;Verifying the Configuration&lt;/a&gt;&lt;/h3&gt;
172 
173 &lt;p&gt; After installing and configuring Mercurial, validate the configuration
174 using the following steps. &lt;/p&gt;
175 
176 &lt;ol&gt;
177 &lt;li&gt; Verify that Mercurial is version 2.6.3 (or newer).
178 
179 &lt;blockquote&gt;&lt;pre&gt;
180 $ hg version
181 Mercurial Distributed SCM (version 2.9)
182 (see http://mercurial.selenic.com for more information)
183 
184 Copyright (C) 2005-2014 Matt Mackall and others
185 This is free software; see the source for copying conditions. There is NO
186 warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
187 &lt;/pre&gt;&lt;/blockquote&gt;&lt;/li&gt;
188 
189 &lt;li&gt; Verify that the list of enabled extensions includes fetch and mq.
190 
191 &lt;blockquote&gt;&lt;pre&gt;
192 $ hg help
193 &lt;a href=&quot;hgHelp.html&quot;&gt;full output&lt;/a&gt;
194 &lt;/pre&gt;&lt;/blockquote&gt;&lt;/li&gt;
195 
196 &lt;li&gt; Verify that the &lt;code&gt;~/.hgrc&lt;/code&gt; configuration looks correct.
197 Minimally it should contain the following entries:
198 
199 &lt;blockquote&gt;&lt;pre&gt;
200 $ hg showconfig
201 ui.username=iris
202 &lt;/pre&gt;&lt;/blockquote&gt;&lt;/li&gt;
203 
204 &lt;/ol&gt;
205 
206 &lt;p&gt; At this point, it should be possible to start retrieving source from
207 the repositories. &lt;/p&gt;
208 
209 &lt;h2&gt;&lt;a name=&quot;clone&quot;&gt;Cloning&lt;/a&gt;&lt;/h2&gt;
210 
211 &lt;p&gt; With Mercurial each developer works with a clone of the repository which is
212 a snapshot of the files at the time the clone was taken.  To update the clone,
213 see &lt;a href=&quot;producingChangeset.html&quot;&gt;Producing a Changeset&lt;/a&gt;. &lt;/p&gt;
214 
215 &lt;h3&gt;&lt;a name=&quot;cloneSandbox&quot;&gt;&amp;hellip; a Sandbox Repository&lt;/a&gt;&lt;/h3&gt;
216 
217 &lt;p&gt; In addition to the Project repositories, there are some test repositories
218 that may be used to run test commands against Mercurial without fear of causing
219 damage to development source.  Use them freely but with discretion; content in
220 them may be deleted at any time. &lt;/p&gt;
221 
222 &lt;blockquote&gt;&lt;pre&gt;
223 $ mkdir sandbox; cd sandbox
224 $ hg clone http://hg.openjdk.java.net/sandbox/box
225 destination directory: box
226 requesting all changes
227 adding changesets
228 adding manifests
229 adding file changes
230 added 23 changesets with 24 changes to 5 files
231 4 files updated, 0 files merged, 0 files removed, 0 files unresolved
232 $ du -s box
233 46      box
234 &lt;/pre&gt;&lt;/blockquote&gt;
235 
236 &lt;h3&gt;&lt;a name=&quot;cloneForest&quot;&gt;&amp;hellip; a Forest&lt;/a&gt;&lt;/h3&gt;
237 
238 &lt;p&gt; If a Project uses a forest, It is strongly recommended for developers to
239 clone an entire forest, rather than a single repository.  This is the only
240 means to ensure consistency in builds.  The following examples illustrate two
241 alternatives for cloning the entire
242 &lt;em&gt;jdk9/dev&lt;/em&gt; forest into the directory &lt;code&gt;9dev&lt;/code&gt;. &lt;/p&gt;
243 
244 &lt;ol&gt;
245 &lt;li&gt;&lt;p&gt;To clone the forest using the
246 &lt;a href=&quot;http://openjdk.java.net/projects/code-tools/trees/&quot;&gt;trees&lt;/a&gt;
247 extension just use &lt;code&gt;tclone&lt;/code&gt;:&lt;/p&gt;
248 
249 &lt;blockquote&gt;&lt;pre&gt;
250 $ hg tclone http://hg.openjdk.java.net/jdk9/dev 9dev
251 &lt;a href=&quot;tClone.html&quot;&gt;full output&lt;/a&gt;
252 &lt;/pre&gt;&lt;/blockquote&gt;
253 &lt;/li&gt;
254 
255 &lt;li&gt;&lt;p&gt;To clone the forest using &lt;code&gt;get_source.sh&lt;/code&gt;, first clone the
256 main tree:&lt;/p&gt;
257 
258 &lt;blockquote&gt;&lt;pre&gt;
259 $ hg clone http://hg.openjdk.java.net/jdk9/dev 9dev
260 requesting all changes
261 adding changesets
262 adding manifests
263 adding file changes
264 added 997 changesets with 1477 changes to 138 files
265 updating to branch default
266 82 files updated, 0 files merged, 0 files removed, 0 files unresolved
267 &lt;/pre&gt;&lt;/blockquote&gt;
268 
269 &lt;p&gt;Then clone the repositories in the forest:&lt;/p&gt;
270 &lt;blockquote&gt;&lt;pre&gt;
271 $ cd 9dev
272 $ sh ./get_source.sh
273 &lt;a href=&quot;getSource.html&quot;&gt;full output&lt;/a&gt;
274 &lt;/pre&gt;&lt;/blockquote&gt;
275 &lt;/li&gt;
276 &lt;/ol&gt;
277 
278 &lt;p&gt;Regardless of how the forest was cloned, this is the resulting populated
279 forest. &lt;/p&gt; 
280 
281 &lt;blockquote&gt;&lt;pre&gt;
282 $ du -s 
283 934532  .
284 $ ls
285 ASSEMBLY_EXCEPTION  hotspot    LICENSE   README-builds.html
286 common              jaxp       make      test
287 configure           jaxws      Makefile  THIRD_PARTY_README
288 corba               jdk        nashorn
289 get_source.sh       langtools  README
290 &lt;/pre&gt;&lt;/blockquote&gt;
291 
292 &lt;h3&gt;&lt;a name=&quot;cloneSingle&quot;&gt;&amp;hellip; a Single Repository&lt;/a&gt;&lt;/h3&gt;
293 
294 &lt;p&gt; If the source for the Project is contained within a single repository or
295 reading a limited portion of the source is the only goal, it is possible to
296 clone a single repository (even if it&#39;s part of a forest).  For instance, this
297 example shows how to clone the &lt;code&gt;langtools&lt;/code&gt; repository from
298 &lt;em&gt;jdk9/dev&lt;/em&gt; into the default destination directory. &lt;/p&gt;
299 
300 &lt;blockquote&gt;&lt;pre&gt;
301 $ hg clone http://hg.openjdk.java.net/jdk9/dev/langtools
302 destination directory: langtools
303 requesting all changes
304 adding changesets
305 adding manifests
306 adding file changes
307 added 2289 changesets with 21194 changes to 7004 files
308 updating to branch default
309 6212 files updated, 0 files merged, 0 files removed, 0 files unresolved
310 $ du -s langtools
311 84396	langtools
312 &lt;/pre&gt;&lt;/blockquote&gt;
313 
314 &lt;div class=&quot;version&quot;&gt;version 0.02&lt;/div&gt;
315 &lt;div class=&quot;NavBit&quot;&gt;
316   &lt;a href=&quot;processWorkflow.html&quot;&gt;&amp;laquo;&amp;nbsp;Previous&lt;/a&gt;&amp;nbsp;&amp;bull;&amp;nbsp;&lt;a href=&quot;index.html&quot;&gt;TOC&lt;/a&gt;&amp;nbsp;&amp;bull;&amp;nbsp;&lt;a href=&quot;mailingLists.html&quot;&gt;Next&amp;nbsp;&amp;raquo;&lt;/a&gt;
317 &lt;/div&gt;
318 
319 &lt;/body&gt;
320 &lt;/html&gt;
    </pre>
  </body>
</html>