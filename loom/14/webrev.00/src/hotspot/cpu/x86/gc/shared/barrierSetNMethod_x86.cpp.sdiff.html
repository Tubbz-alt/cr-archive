<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/cpu/x86/gc/shared/barrierSetNMethod_x86.cpp</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../frame_x86.inline.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../../../share/code/nmethod.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/x86/gc/shared/barrierSetNMethod_x86.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
159 // not find the expected native instruction at this offset, which needs updating.
160 // Note that this offset is invariant of PreserveFramePointer.
161 static const int entry_barrier_offset = LP64_ONLY(-19) NOT_LP64(-18);
162 
163 static NativeNMethodCmpBarrier* native_nmethod_barrier(nmethod* nm) {
164   address barrier_address = nm-&gt;code_begin() + nm-&gt;frame_complete_offset() + entry_barrier_offset;
165   NativeNMethodCmpBarrier* barrier = reinterpret_cast&lt;NativeNMethodCmpBarrier*&gt;(barrier_address);
166   debug_only(barrier-&gt;verify());
167   return barrier;
168 }
169 
170 void BarrierSetNMethod::disarm(nmethod* nm) {
171   if (!supports_entry_barrier(nm)) {
172     return;
173   }
174 
175   NativeNMethodCmpBarrier* cmp = native_nmethod_barrier(nm);
176   cmp-&gt;set_immediate(disarmed_value());
177 }
178 









179 bool BarrierSetNMethod::is_armed(nmethod* nm) {
180   if (!supports_entry_barrier(nm)) {
181     return false;
182   }
183 
184   NativeNMethodCmpBarrier* cmp = native_nmethod_barrier(nm);
185   return (disarmed_value() != cmp-&gt;get_immedate());
186 }
</pre>
</td>
<td>
<hr />
<pre>
159 // not find the expected native instruction at this offset, which needs updating.
160 // Note that this offset is invariant of PreserveFramePointer.
161 static const int entry_barrier_offset = LP64_ONLY(-19) NOT_LP64(-18);
162 
163 static NativeNMethodCmpBarrier* native_nmethod_barrier(nmethod* nm) {
164   address barrier_address = nm-&gt;code_begin() + nm-&gt;frame_complete_offset() + entry_barrier_offset;
165   NativeNMethodCmpBarrier* barrier = reinterpret_cast&lt;NativeNMethodCmpBarrier*&gt;(barrier_address);
166   debug_only(barrier-&gt;verify());
167   return barrier;
168 }
169 
170 void BarrierSetNMethod::disarm(nmethod* nm) {
171   if (!supports_entry_barrier(nm)) {
172     return;
173   }
174 
175   NativeNMethodCmpBarrier* cmp = native_nmethod_barrier(nm);
176   cmp-&gt;set_immediate(disarmed_value());
177 }
178 
<span class="line-added">179 void BarrierSetNMethod::arm(nmethod* nm, int arm_value) {</span>
<span class="line-added">180   if (!supports_entry_barrier(nm)) {</span>
<span class="line-added">181     return;</span>
<span class="line-added">182   }</span>
<span class="line-added">183 </span>
<span class="line-added">184   NativeNMethodCmpBarrier* cmp = native_nmethod_barrier(nm);</span>
<span class="line-added">185   cmp-&gt;set_immediate(arm_value);</span>
<span class="line-added">186 }</span>
<span class="line-added">187 </span>
188 bool BarrierSetNMethod::is_armed(nmethod* nm) {
189   if (!supports_entry_barrier(nm)) {
190     return false;
191   }
192 
193   NativeNMethodCmpBarrier* cmp = native_nmethod_barrier(nm);
194   return (disarmed_value() != cmp-&gt;get_immedate());
195 }
</pre>
</td>
</tr>
</table>
<center><a href="../../frame_x86.inline.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../../../share/code/nmethod.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>