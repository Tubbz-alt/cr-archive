<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/conf/jib-profiles.js</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="../autoconf/toolchain.m4.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="../../test/lib/jdk/test/lib/process/ProcessTools.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/conf/jib-profiles.js</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 229  *
 230  * @param input External data to use for generating the configuration
 231  * @returns Common values
 232  */
 233 var getJibProfilesCommon = function (input, data) {
 234     var common = {};
 235 
 236     common.organization = &quot;jpg.infra.builddeps&quot;;
 237     common.build_id = getBuildId(input);
 238     common.build_number = input.build_number != null ? input.build_number : &quot;0&quot;;
 239 
 240     // List of the main profile names used for iteration
 241     common.main_profile_names = [
 242         &quot;linux-x64&quot;, &quot;linux-x86&quot;, &quot;macosx-x64&quot;, &quot;solaris-x64&quot;,
 243         &quot;solaris-sparcv9&quot;, &quot;windows-x64&quot;, &quot;windows-x86&quot;,
 244         &quot;linux-aarch64&quot;, &quot;linux-arm32&quot;, &quot;linux-ppc64le&quot;, &quot;linux-s390x&quot;
 245     ];
 246 
 247     // These are the base setttings for all the main build profiles.
 248     common.main_profile_base = {
<span class="line-modified"> 249         dependencies: [&quot;boot_jdk&quot;, &quot;gnumake&quot;, &quot;jtreg&quot;, &quot;jib&quot;, &quot;autoconf&quot;, &quot;jmh&quot;, &quot;jcov&quot;],</span>
 250         default_make_targets: [&quot;product-bundles&quot;, &quot;test-bundles&quot;, &quot;static-libs-bundles&quot;],
 251         configure_args: concat([&quot;--enable-jtreg-failure-handler&quot;],
 252             &quot;--with-exclude-translations=de,es,fr,it,ko,pt_BR,sv,ca,tr,cs,sk,ja_JP_A,ja_JP_HA,ja_JP_HI,ja_JP_I,zh_TW,zh_HK&quot;,
 253             &quot;--disable-manpages&quot;,
 254             &quot;--disable-jvm-feature-shenandoahgc&quot;,
 255             versionArgs(input, common))
 256     };
 257     // Extra settings for debug profiles
 258     common.debug_suffix = &quot;-debug&quot;;
 259     common.debug_profile_base = {
 260         configure_args: [&quot;--enable-debug&quot;],
 261         labels: &quot;debug&quot;
 262     };
 263     // Extra settings for slowdebug profiles
 264     common.slowdebug_suffix = &quot;-slowdebug&quot;;
 265     common.slowdebug_profile_base = {
 266         configure_args: [&quot;--with-debug-level=slowdebug&quot;],
 267         labels: &quot;slowdebug&quot;
 268     };
 269     // Extra settings for openjdk only profiles
</pre>
<hr />
<pre>
 823                         &quot;bundles/&quot; + pf + &quot;/jdk-&quot; + data.version + &quot;_&quot; + pf + &quot;_bin-gcov-tests.tar.gz&quot;,
 824                     ],
 825                     exploded: &quot;images/test&quot;
 826             },
 827             jdk_symbols: {
 828                     local: &quot;bundles/\\(jdk.*bin-symbols.tar.gz\\)&quot;,
 829                     remote: [
 830                         &quot;bundles/&quot; + pf + &quot;/jdk-&quot; + data.version + &quot;_&quot; + pf + &quot;_bin-gcov-symbols.tar.gz&quot;,
 831                     ],
 832                     subdir: jdk_subdir,
 833                     exploded: &quot;images/jdk&quot;
 834                 },
 835             };
 836     });
 837 
 838     // Profiles used to run tests.
 839     var testOnlyProfiles = {
 840         &quot;run-test&quot;: {
 841             target_os: input.build_os,
 842             target_cpu: input.build_cpu,
<span class="line-modified"> 843             dependencies: [ &quot;jtreg&quot;, &quot;gnumake&quot;, &quot;boot_jdk&quot;, &quot;devkit&quot;, &quot;jib&quot; ],</span>
 844             labels: &quot;test&quot;,
 845             environment: {
 846                 &quot;JT_JAVA&quot;: common.boot_jdk_home
 847             }
 848         }
 849     };
 850     profiles = concatObjects(profiles, testOnlyProfiles);
 851 
 852     // Profiles used to run tests using Jib for internal dependencies.
 853     var testedProfile = input.testedProfile;
 854     if (testedProfile == null) {
 855         testedProfile = input.build_os + &quot;-&quot; + input.build_cpu;
 856     }
 857     var testedProfileJdk = testedProfile + &quot;.jdk&quot;;
 858     // Make it possible to use the test image from a different profile
 859     var testImageProfile;
 860     if (input.testImageProfile != null) {
 861         testImageProfile = input.testImageProfile;
 862     } else if (testedProfile.endsWith(&quot;-jcov&quot;)) {
 863         testImageProfile = testedProfile.substring(0, testedProfile.length - &quot;-jcov&quot;.length);
 864     } else {
 865         testImageProfile = testedProfile;
 866     }
 867     var testedProfileTest = testImageProfile + &quot;.test&quot;
 868     var testOnlyMake = [ &quot;test-prebuilt&quot;, &quot;LOG_CMDLINES=true&quot;, &quot;JTREG_VERBOSE=fail,error,time&quot; ];
 869     if (testedProfile.endsWith(&quot;-gcov&quot;)) {
 870         testOnlyMake = concat(testOnlyMake, &quot;GCOV_ENABLED=true&quot;)
 871     }
 872     var testOnlyProfilesPrebuilt = {
 873         &quot;run-test-prebuilt&quot;: {
 874             target_os: input.build_os,
 875             target_cpu: input.build_cpu,
 876             dependencies: [
<span class="line-modified"> 877                 &quot;jtreg&quot;, &quot;gnumake&quot;, &quot;boot_jdk&quot;, &quot;devkit&quot;, &quot;jib&quot;, &quot;jcov&quot;, testedProfileJdk,</span>
 878                 testedProfileTest
 879             ],
 880             src: &quot;src.conf&quot;,
 881             make_args: testOnlyMake,
 882             environment: {
 883                 &quot;BOOT_JDK&quot;: common.boot_jdk_home,
 884                 &quot;JDK_IMAGE_DIR&quot;: input.get(testedProfileJdk, &quot;home_path&quot;),
 885                 &quot;TEST_IMAGE_DIR&quot;: input.get(testedProfileTest, &quot;home_path&quot;)
 886             },
 887             labels: &quot;test&quot;
 888         }
 889     };
 890 
 891     // If actually running the run-test-prebuilt profile, verify that the input
 892     // variable is valid and if so, add the appropriate target_* values from
 893     // the tested profile. Use testImageProfile value as backup.
 894     if (input.profile == &quot;run-test-prebuilt&quot;) {
 895         if (profiles[testedProfile] == null &amp;&amp; profiles[testImageProfile] == null) {
 896             error(&quot;testedProfile is not defined: &quot; + testedProfile + &quot; &quot; + testImageProfile);
 897         }
</pre>
<hr />
<pre>
1045             revision: devkit_platform_revisions[input.build_platform]
1046         },
1047 
1048         cups: {
1049             organization: common.organization,
1050             ext: &quot;tar.gz&quot;,
1051             revision: &quot;1.0118+1.0&quot;
1052         },
1053 
1054         jtreg: {
1055             server: &quot;jpg&quot;,
1056             product: &quot;jtreg&quot;,
1057             version: &quot;5.0&quot;,
1058             build_number: &quot;b01&quot;,
1059             checksum_file: &quot;MD5_VALUES&quot;,
1060             file: &quot;bundles/jtreg_bin-5.0.zip&quot;,
1061             environment_name: &quot;JT_HOME&quot;,
1062             environment_path: input.get(&quot;jtreg&quot;, &quot;install_path&quot;) + &quot;/jtreg/bin&quot;
1063         },
1064 








1065         jmh: {
1066             organization: common.organization,
1067             ext: &quot;tar.gz&quot;,
1068             revision: &quot;1.21+1.0&quot;
1069         },
1070 
1071         jcov: {
1072             // Until an official build of JCov is available, use custom
1073             // build to support classfile version 57.
1074             // See CODETOOLS-7902358 for more info.
1075             // server: &quot;jpg&quot;,
1076             // product: &quot;jcov&quot;,
1077             // version: &quot;3.0&quot;,
1078             // build_number: &quot;b07&quot;,
1079             // file: &quot;bundles/jcov-3_0.zip&quot;,
1080             organization: common.organization,
1081             revision: &quot;3.0-59-support+1.0&quot;,
1082             ext: &quot;zip&quot;,
1083             environment_name: &quot;JCOV_HOME&quot;,
1084         },
</pre>
</td>
<td>
<hr />
<pre>
 229  *
 230  * @param input External data to use for generating the configuration
 231  * @returns Common values
 232  */
 233 var getJibProfilesCommon = function (input, data) {
 234     var common = {};
 235 
 236     common.organization = &quot;jpg.infra.builddeps&quot;;
 237     common.build_id = getBuildId(input);
 238     common.build_number = input.build_number != null ? input.build_number : &quot;0&quot;;
 239 
 240     // List of the main profile names used for iteration
 241     common.main_profile_names = [
 242         &quot;linux-x64&quot;, &quot;linux-x86&quot;, &quot;macosx-x64&quot;, &quot;solaris-x64&quot;,
 243         &quot;solaris-sparcv9&quot;, &quot;windows-x64&quot;, &quot;windows-x86&quot;,
 244         &quot;linux-aarch64&quot;, &quot;linux-arm32&quot;, &quot;linux-ppc64le&quot;, &quot;linux-s390x&quot;
 245     ];
 246 
 247     // These are the base setttings for all the main build profiles.
 248     common.main_profile_base = {
<span class="line-modified"> 249         dependencies: [&quot;boot_jdk&quot;, &quot;gnumake&quot;, &quot;jtreg&quot;, &quot;jtregMW&quot;, &quot;jib&quot;, &quot;autoconf&quot;, &quot;jmh&quot;, &quot;jcov&quot;],</span>
 250         default_make_targets: [&quot;product-bundles&quot;, &quot;test-bundles&quot;, &quot;static-libs-bundles&quot;],
 251         configure_args: concat([&quot;--enable-jtreg-failure-handler&quot;],
 252             &quot;--with-exclude-translations=de,es,fr,it,ko,pt_BR,sv,ca,tr,cs,sk,ja_JP_A,ja_JP_HA,ja_JP_HI,ja_JP_I,zh_TW,zh_HK&quot;,
 253             &quot;--disable-manpages&quot;,
 254             &quot;--disable-jvm-feature-shenandoahgc&quot;,
 255             versionArgs(input, common))
 256     };
 257     // Extra settings for debug profiles
 258     common.debug_suffix = &quot;-debug&quot;;
 259     common.debug_profile_base = {
 260         configure_args: [&quot;--enable-debug&quot;],
 261         labels: &quot;debug&quot;
 262     };
 263     // Extra settings for slowdebug profiles
 264     common.slowdebug_suffix = &quot;-slowdebug&quot;;
 265     common.slowdebug_profile_base = {
 266         configure_args: [&quot;--with-debug-level=slowdebug&quot;],
 267         labels: &quot;slowdebug&quot;
 268     };
 269     // Extra settings for openjdk only profiles
</pre>
<hr />
<pre>
 823                         &quot;bundles/&quot; + pf + &quot;/jdk-&quot; + data.version + &quot;_&quot; + pf + &quot;_bin-gcov-tests.tar.gz&quot;,
 824                     ],
 825                     exploded: &quot;images/test&quot;
 826             },
 827             jdk_symbols: {
 828                     local: &quot;bundles/\\(jdk.*bin-symbols.tar.gz\\)&quot;,
 829                     remote: [
 830                         &quot;bundles/&quot; + pf + &quot;/jdk-&quot; + data.version + &quot;_&quot; + pf + &quot;_bin-gcov-symbols.tar.gz&quot;,
 831                     ],
 832                     subdir: jdk_subdir,
 833                     exploded: &quot;images/jdk&quot;
 834                 },
 835             };
 836     });
 837 
 838     // Profiles used to run tests.
 839     var testOnlyProfiles = {
 840         &quot;run-test&quot;: {
 841             target_os: input.build_os,
 842             target_cpu: input.build_cpu,
<span class="line-modified"> 843             dependencies: [ &quot;jtreg&quot;, &quot;jtregMW&quot;, &quot;gnumake&quot;, &quot;boot_jdk&quot;, &quot;devkit&quot;, &quot;jib&quot; ],</span>
 844             labels: &quot;test&quot;,
 845             environment: {
 846                 &quot;JT_JAVA&quot;: common.boot_jdk_home
 847             }
 848         }
 849     };
 850     profiles = concatObjects(profiles, testOnlyProfiles);
 851 
 852     // Profiles used to run tests using Jib for internal dependencies.
 853     var testedProfile = input.testedProfile;
 854     if (testedProfile == null) {
 855         testedProfile = input.build_os + &quot;-&quot; + input.build_cpu;
 856     }
 857     var testedProfileJdk = testedProfile + &quot;.jdk&quot;;
 858     // Make it possible to use the test image from a different profile
 859     var testImageProfile;
 860     if (input.testImageProfile != null) {
 861         testImageProfile = input.testImageProfile;
 862     } else if (testedProfile.endsWith(&quot;-jcov&quot;)) {
 863         testImageProfile = testedProfile.substring(0, testedProfile.length - &quot;-jcov&quot;.length);
 864     } else {
 865         testImageProfile = testedProfile;
 866     }
 867     var testedProfileTest = testImageProfile + &quot;.test&quot;
 868     var testOnlyMake = [ &quot;test-prebuilt&quot;, &quot;LOG_CMDLINES=true&quot;, &quot;JTREG_VERBOSE=fail,error,time&quot; ];
 869     if (testedProfile.endsWith(&quot;-gcov&quot;)) {
 870         testOnlyMake = concat(testOnlyMake, &quot;GCOV_ENABLED=true&quot;)
 871     }
 872     var testOnlyProfilesPrebuilt = {
 873         &quot;run-test-prebuilt&quot;: {
 874             target_os: input.build_os,
 875             target_cpu: input.build_cpu,
 876             dependencies: [
<span class="line-modified"> 877                 &quot;jtreg&quot;, &quot;jtregMW&quot;, &quot;gnumake&quot;, &quot;boot_jdk&quot;, &quot;devkit&quot;, &quot;jib&quot;, &quot;jcov&quot;, testedProfileJdk,</span>
 878                 testedProfileTest
 879             ],
 880             src: &quot;src.conf&quot;,
 881             make_args: testOnlyMake,
 882             environment: {
 883                 &quot;BOOT_JDK&quot;: common.boot_jdk_home,
 884                 &quot;JDK_IMAGE_DIR&quot;: input.get(testedProfileJdk, &quot;home_path&quot;),
 885                 &quot;TEST_IMAGE_DIR&quot;: input.get(testedProfileTest, &quot;home_path&quot;)
 886             },
 887             labels: &quot;test&quot;
 888         }
 889     };
 890 
 891     // If actually running the run-test-prebuilt profile, verify that the input
 892     // variable is valid and if so, add the appropriate target_* values from
 893     // the tested profile. Use testImageProfile value as backup.
 894     if (input.profile == &quot;run-test-prebuilt&quot;) {
 895         if (profiles[testedProfile] == null &amp;&amp; profiles[testImageProfile] == null) {
 896             error(&quot;testedProfile is not defined: &quot; + testedProfile + &quot; &quot; + testImageProfile);
 897         }
</pre>
<hr />
<pre>
1045             revision: devkit_platform_revisions[input.build_platform]
1046         },
1047 
1048         cups: {
1049             organization: common.organization,
1050             ext: &quot;tar.gz&quot;,
1051             revision: &quot;1.0118+1.0&quot;
1052         },
1053 
1054         jtreg: {
1055             server: &quot;jpg&quot;,
1056             product: &quot;jtreg&quot;,
1057             version: &quot;5.0&quot;,
1058             build_number: &quot;b01&quot;,
1059             checksum_file: &quot;MD5_VALUES&quot;,
1060             file: &quot;bundles/jtreg_bin-5.0.zip&quot;,
1061             environment_name: &quot;JT_HOME&quot;,
1062             environment_path: input.get(&quot;jtreg&quot;, &quot;install_path&quot;) + &quot;/jtreg/bin&quot;
1063         },
1064 
<span class="line-added">1065         jtregMW: {</span>
<span class="line-added">1066             organization: common.organization,</span>
<span class="line-added">1067             ext: &quot;zip&quot;,</span>
<span class="line-added">1068             revision: &quot;5.0-virtual-1.1&quot;,</span>
<span class="line-added">1069             environment_name: &quot;JT_HOME_MW&quot;,</span>
<span class="line-added">1070             environment_path: input.get(&quot;jtreg&quot;, &quot;install_path&quot;) + &quot;/jtreg/bin&quot;</span>
<span class="line-added">1071         },</span>
<span class="line-added">1072 </span>
1073         jmh: {
1074             organization: common.organization,
1075             ext: &quot;tar.gz&quot;,
1076             revision: &quot;1.21+1.0&quot;
1077         },
1078 
1079         jcov: {
1080             // Until an official build of JCov is available, use custom
1081             // build to support classfile version 57.
1082             // See CODETOOLS-7902358 for more info.
1083             // server: &quot;jpg&quot;,
1084             // product: &quot;jcov&quot;,
1085             // version: &quot;3.0&quot;,
1086             // build_number: &quot;b07&quot;,
1087             // file: &quot;bundles/jcov-3_0.zip&quot;,
1088             organization: common.organization,
1089             revision: &quot;3.0-59-support+1.0&quot;,
1090             ext: &quot;zip&quot;,
1091             environment_name: &quot;JCOV_HOME&quot;,
1092         },
</pre>
</td>
</tr>
</table>
<center><a href="../autoconf/toolchain.m4.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="../../test/lib/jdk/test/lib/process/ProcessTools.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>