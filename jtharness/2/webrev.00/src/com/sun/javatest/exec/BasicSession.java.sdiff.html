<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/com/sun/javatest/exec/BasicSession.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../TestSuite.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="ET_FilterHandler.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/com/sun/javatest/exec/BasicSession.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 21  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 22  *
 23  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 24  * or visit www.oracle.com if you need additional information or have any
 25  * questions.
 26  */
 27 
 28 package com.sun.javatest.exec;
 29 
 30 import com.sun.javatest.InterviewParameters;
 31 import com.sun.javatest.Parameters;
 32 import com.sun.javatest.TestFilter;
 33 import com.sun.javatest.TestSuite;
 34 import com.sun.javatest.WorkDirectory;
 35 import com.sun.javatest.util.Debug;
 36 import com.sun.javatest.util.I18NResourceBundle;
 37 
 38 import java.io.File;
 39 import java.io.FileNotFoundException;
 40 import java.util.ArrayList;


 41 import java.util.List;
 42 import java.util.Map;
 43 import java.util.logging.Logger;
 44 
 45 /**
 46  * The very classic implementation of Session that encapsulates the WorkDirectory
 47  * instance and InterviewParameters instance.
 48  *
 49  * @author Dmitry Fazunenko
 50  */
 51 public class BasicSession implements SessionExt {
 52 
 53     public static final String CONFIG_NAME_PROP = &quot;Configuration&quot;;
 54     public static final String WD_PROP = &quot;WorkDir&quot;;
 55     static final String EL_FILTER = &quot;ExcludeList&quot;;
 56     static final String PRIOR_FILTER = &quot;PriorStatus&quot;;
 57     static final String KWD_FILTER = &quot;Keywords&quot;;
 58     static final String RELEVANT_FILTER = &quot;Relevant&quot;;
 59     private static I18NResourceBundle i18n = I18NResourceBundle.getBundleForClass(BasicSession.class);
 60     private static int debug = Debug.getInt(ExecTool.class);
</pre>
<hr />
<pre>
207     }
208 
209     /**
210      * Sorts observers by their order.
211      */
212     private void sortObservers() {
213         observers.sort((o1, o2) -&gt; {
214             long order1 = 0;
215             if (o1 instanceof OrderedObserver) {
216                 order1 = ((OrderedObserver) o1).order();
217             }
218             long order2 = 0;
219             if (o2 instanceof OrderedObserver) {
220                 order2 = ((OrderedObserver) o2).order();
221             }
222             return (int) (order1 - order2); // long is used to avoid overflow
223         });
224         isSorted = true;
225     }
226 
<span class="line-modified">227     public TestFilter getTestFilter(String name) {</span>
228         if (config == null) {
229             throw new IllegalStateException(i18n.getString(&quot;bc.configNotReady.err&quot;));
230         }
<span class="line-modified">231         TestFilter tf;</span>
232         if (filterNames.contains(name)) {
<span class="line-modified">233             tf = findFilter(name);</span>
<span class="line-modified">234             if (tf != null) {</span>
<span class="line-modified">235                 return tf;</span>
236             }
237         }
238         throw new IllegalArgumentException(i18n.getString(&quot;bc.unknownFilter.err&quot;, name));
239     }
240 
241     /**
242      * Supposed to be overridden when extra filters added
243      *
244      * @param name
245      * @return found filter or null, if not found.
246      */
<span class="line-modified">247     protected TestFilter findFilter(String name) {</span>
248         if (EL_FILTER.equals(name)) {
<span class="line-modified">249             return config.getExcludeListFilter();</span>
250         } else if (KWD_FILTER.equals(name)) {
<span class="line-modified">251             return config.getKeywordsFilter();</span>
252         } else if (PRIOR_FILTER.equals(name)) {
<span class="line-modified">253             return config.getPriorStatusFilter();</span>
254         } else if (RELEVANT_FILTER.equals(name)) {
<span class="line-modified">255             return config.getRelevantTestFilter();</span>
256         }
<span class="line-modified">257         return null;</span>
258     }
259 
260     public List&lt;String&gt; getTestFilterNames() {
261         return filterNames;
262     }
263 
264     @Override
265     public void save(Map&lt;String, String&gt; map) {
266         if (wd != null) {
267             map.put(&quot;workDir&quot;, wd.getPath());
268         }
269         // save name of interview file
270         if (config != null &amp;&amp; config.getFile() != null) {
271             map.put(&quot;config&quot;, config.getFile().getPath());
272         }
273     }
274 
275     @Override
276     public void restore(Map&lt;String, String&gt; map) throws Fault {
277         if (map == null) {
</pre>
</td>
<td>
<hr />
<pre>
 21  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 22  *
 23  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 24  * or visit www.oracle.com if you need additional information or have any
 25  * questions.
 26  */
 27 
 28 package com.sun.javatest.exec;
 29 
 30 import com.sun.javatest.InterviewParameters;
 31 import com.sun.javatest.Parameters;
 32 import com.sun.javatest.TestFilter;
 33 import com.sun.javatest.TestSuite;
 34 import com.sun.javatest.WorkDirectory;
 35 import com.sun.javatest.util.Debug;
 36 import com.sun.javatest.util.I18NResourceBundle;
 37 
 38 import java.io.File;
 39 import java.io.FileNotFoundException;
 40 import java.util.ArrayList;
<span class="line-added"> 41 import java.util.Arrays;</span>
<span class="line-added"> 42 import java.util.Collections;</span>
 43 import java.util.List;
 44 import java.util.Map;
 45 import java.util.logging.Logger;
 46 
 47 /**
 48  * The very classic implementation of Session that encapsulates the WorkDirectory
 49  * instance and InterviewParameters instance.
 50  *
 51  * @author Dmitry Fazunenko
 52  */
 53 public class BasicSession implements SessionExt {
 54 
 55     public static final String CONFIG_NAME_PROP = &quot;Configuration&quot;;
 56     public static final String WD_PROP = &quot;WorkDir&quot;;
 57     static final String EL_FILTER = &quot;ExcludeList&quot;;
 58     static final String PRIOR_FILTER = &quot;PriorStatus&quot;;
 59     static final String KWD_FILTER = &quot;Keywords&quot;;
 60     static final String RELEVANT_FILTER = &quot;Relevant&quot;;
 61     private static I18NResourceBundle i18n = I18NResourceBundle.getBundleForClass(BasicSession.class);
 62     private static int debug = Debug.getInt(ExecTool.class);
</pre>
<hr />
<pre>
209     }
210 
211     /**
212      * Sorts observers by their order.
213      */
214     private void sortObservers() {
215         observers.sort((o1, o2) -&gt; {
216             long order1 = 0;
217             if (o1 instanceof OrderedObserver) {
218                 order1 = ((OrderedObserver) o1).order();
219             }
220             long order2 = 0;
221             if (o2 instanceof OrderedObserver) {
222                 order2 = ((OrderedObserver) o2).order();
223             }
224             return (int) (order1 - order2); // long is used to avoid overflow
225         });
226         isSorted = true;
227     }
228 
<span class="line-modified">229     public List&lt;TestFilter&gt; getTestFilter(String name) {</span>
230         if (config == null) {
231             throw new IllegalStateException(i18n.getString(&quot;bc.configNotReady.err&quot;));
232         }
<span class="line-modified">233         List&lt;TestFilter&gt; filters;</span>
234         if (filterNames.contains(name)) {
<span class="line-modified">235             filters = findFilter(name);</span>
<span class="line-modified">236             if (!filters.isEmpty()) {</span>
<span class="line-modified">237                 return filters;</span>
238             }
239         }
240         throw new IllegalArgumentException(i18n.getString(&quot;bc.unknownFilter.err&quot;, name));
241     }
242 
243     /**
244      * Supposed to be overridden when extra filters added
245      *
246      * @param name
247      * @return found filter or null, if not found.
248      */
<span class="line-modified">249     protected List&lt;TestFilter&gt; findFilter(String name) {</span>
250         if (EL_FILTER.equals(name)) {
<span class="line-modified">251             return Arrays.asList(config.getExcludeListFilter());</span>
252         } else if (KWD_FILTER.equals(name)) {
<span class="line-modified">253             return Arrays.asList(config.getKeywordsFilter());</span>
254         } else if (PRIOR_FILTER.equals(name)) {
<span class="line-modified">255             return Arrays.asList(config.getPriorStatusFilter());</span>
256         } else if (RELEVANT_FILTER.equals(name)) {
<span class="line-modified">257             return config.getAllRelevantFiltersInTheSuite();</span>
258         }
<span class="line-modified">259         return Collections.emptyList();</span>
260     }
261 
262     public List&lt;String&gt; getTestFilterNames() {
263         return filterNames;
264     }
265 
266     @Override
267     public void save(Map&lt;String, String&gt; map) {
268         if (wd != null) {
269             map.put(&quot;workDir&quot;, wd.getPath());
270         }
271         // save name of interview file
272         if (config != null &amp;&amp; config.getFile() != null) {
273             map.put(&quot;config&quot;, config.getFile().getPath());
274         }
275     }
276 
277     @Override
278     public void restore(Map&lt;String, String&gt; map) throws Fault {
279         if (map == null) {
</pre>
</td>
</tr>
</table>
<center><a href="../TestSuite.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="ET_FilterHandler.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>