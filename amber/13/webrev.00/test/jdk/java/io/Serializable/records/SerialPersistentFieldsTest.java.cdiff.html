<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/jdk/java/io/Serializable/records/SerialPersistentFieldsTest.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../beans/XMLEncoder/Test4625418.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../../lang/Boolean/GetBoolean.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/io/Serializable/records/SerialPersistentFieldsTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 30,18 ***</span>
   * @run testng/othervm --enable-preview SerialPersistentFieldsTest
   */
  
  import java.io.ByteArrayInputStream;
  import java.io.ByteArrayOutputStream;
<span class="line-removed">- import java.io.FileOutputStream;</span>
  import java.io.IOException;
  import java.io.ObjectInputStream;
  import java.io.ObjectOutputStream;
  import java.io.ObjectStreamClass;
  import java.io.ObjectStreamField;
  import java.io.Serializable;
<span class="line-removed">- import java.io.UncheckedIOException;</span>
  import java.lang.reflect.Field;
  import java.lang.reflect.Modifier;
  import java.math.BigDecimal;
  import jdk.internal.org.objectweb.asm.ClassReader;
  import jdk.internal.org.objectweb.asm.ClassVisitor;
<span class="line-new-header">--- 30,16 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 227,17 ***</span>
      static byte[] addSerialPersistentFields(byte[] classBytes,
                                              ObjectStreamField[] spf) {
          ClassReader reader = new ClassReader(classBytes);
          ClassWriter writer = new ClassWriter(reader, COMPUTE_MAXS | COMPUTE_FRAMES);
          reader.accept(new SerialPersistentFieldsVisitor(writer, spf), 0);
<span class="line-removed">-         try {</span>
<span class="line-removed">-             FileOutputStream fos = new FileOutputStream(&quot;R1.class&quot;);</span>
<span class="line-removed">-             fos.write(writer.toByteArray());</span>
<span class="line-removed">-             fos.close();</span>
<span class="line-removed">-         } catch (IOException ioe) {</span>
<span class="line-removed">-             throw new UncheckedIOException(ioe);</span>
<span class="line-removed">-         }</span>
          return writer.toByteArray();
      }
  
      /** A visitor that adds a serialPersistentFields field, and assigns it in clinit. */
      static final class SerialPersistentFieldsVisitor extends ClassVisitor {
<span class="line-new-header">--- 225,10 ---</span>
</pre>
<center><a href="../../../beans/XMLEncoder/Test4625418.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../../lang/Boolean/GetBoolean.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>