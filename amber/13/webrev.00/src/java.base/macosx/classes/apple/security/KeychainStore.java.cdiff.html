<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/macosx/classes/apple/security/KeychainStore.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../linux/native/libnio/ch/EPoll.c.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../java/net/DefaultInterface.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/macosx/classes/apple/security/KeychainStore.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 125,11 ***</span>
       * its own integrity
       */
      public KeychainStore() { }
  
      /**
<span class="line-modified">!         * Returns the key associated with the given alias, using the given</span>
       * password to recover it.
       *
       * @param alias the alias name
       * @param password the password for recovering the key. This password is
       *        used internally as the key is exported in a PKCS12 format.
<span class="line-new-header">--- 125,11 ---</span>
       * its own integrity
       */
      public KeychainStore() { }
  
      /**
<span class="line-modified">!      * Returns the key associated with the given alias, using the given</span>
       * password to recover it.
       *
       * @param alias the alias name
       * @param password the password for recovering the key. This password is
       *        used internally as the key is exported in a PKCS12 format.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 238,14 ***</span>
       * Returns the certificate chain associated with the given alias.
       *
       * @param alias the alias name
       *
       * @return the certificate chain (ordered with the user&#39;s certificate first
<span class="line-modified">!                                       * and the root certificate authority last), or null if the given alias</span>
       * does not exist or does not contain a certificate chain (i.e., the given
<span class="line-modified">!                                                                * alias identifies either a &lt;i&gt;trusted certificate entry&lt;/i&gt; or a</span>
<span class="line-modified">!                                                                * &lt;i&gt;key entry&lt;/i&gt; without a certificate chain).</span>
       */
      public Certificate[] engineGetCertificateChain(String alias) {
          permissionCheck();
  
          Object entry = entries.get(alias.toLowerCase());
<span class="line-new-header">--- 238,14 ---</span>
       * Returns the certificate chain associated with the given alias.
       *
       * @param alias the alias name
       *
       * @return the certificate chain (ordered with the user&#39;s certificate first
<span class="line-modified">!      * and the root certificate authority last), or null if the given alias</span>
       * does not exist or does not contain a certificate chain (i.e., the given
<span class="line-modified">!      * alias identifies either a &lt;i&gt;trusted certificate entry&lt;/i&gt; or a</span>
<span class="line-modified">!      * &lt;i&gt;key entry&lt;/i&gt; without a certificate chain).</span>
       */
      public Certificate[] engineGetCertificateChain(String alias) {
          permissionCheck();
  
          Object entry = entries.get(alias.toLowerCase());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 295,11 ***</span>
              return null;
          }
      }
  
      /**
<span class="line-modified">!         * Returns the creation date of the entry identified by the given alias.</span>
       *
       * @param alias the alias name
       *
       * @return the creation date of this entry, or null if the given alias does
       * not exist
<span class="line-new-header">--- 295,11 ---</span>
              return null;
          }
      }
  
      /**
<span class="line-modified">!      * Returns the creation date of the entry identified by the given alias.</span>
       *
       * @param alias the alias name
       *
       * @return the creation date of this entry, or null if the given alias does
       * not exist
</pre>
<hr />
<pre>
<span class="line-old-header">*** 319,27 ***</span>
              return null;
          }
      }
  
      /**
<span class="line-modified">!         * Assigns the given key to the given alias, protecting it with the given</span>
       * password.
       *
       * &lt;p&gt;If the given key is of type &lt;code&gt;java.security.PrivateKey&lt;/code&gt;,
       * it must be accompanied by a certificate chain certifying the
       * corresponding public key.
       *
       * &lt;p&gt;If the given alias already exists, the keystore information
       * associated with it is overridden by the given key (and possibly
<span class="line-modified">!                                                           * certificate chain).</span>
       *
       * @param alias the alias name
       * @param key the key to be associated with the alias
       * @param password the password to protect the key
       * @param chain the certificate chain for the corresponding public
       * key (only required if the given key is of type
<span class="line-modified">!             * &lt;code&gt;java.security.PrivateKey&lt;/code&gt;).</span>
       *
       * @exception KeyStoreException if the given key cannot be protected, or
       * this operation fails for some other reason
       */
      public void engineSetKeyEntry(String alias, Key key, char[] password,
<span class="line-new-header">--- 319,27 ---</span>
              return null;
          }
      }
  
      /**
<span class="line-modified">!      * Assigns the given key to the given alias, protecting it with the given</span>
       * password.
       *
       * &lt;p&gt;If the given key is of type &lt;code&gt;java.security.PrivateKey&lt;/code&gt;,
       * it must be accompanied by a certificate chain certifying the
       * corresponding public key.
       *
       * &lt;p&gt;If the given alias already exists, the keystore information
       * associated with it is overridden by the given key (and possibly
<span class="line-modified">!      * certificate chain).</span>
       *
       * @param alias the alias name
       * @param key the key to be associated with the alias
       * @param password the password to protect the key
       * @param chain the certificate chain for the corresponding public
       * key (only required if the given key is of type
<span class="line-modified">!      * &lt;code&gt;java.security.PrivateKey&lt;/code&gt;).</span>
       *
       * @exception KeyStoreException if the given key cannot be protected, or
       * this operation fails for some other reason
       */
      public void engineSetKeyEntry(String alias, Key key, char[] password,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 389,11 ***</span>
              }
          }
      }
  
      /**
<span class="line-modified">!         * Assigns the given key (that has already been protected) to the given</span>
       * alias.
       *
       * &lt;p&gt;If the protected key is of type
       * &lt;code&gt;java.security.PrivateKey&lt;/code&gt;, it must be accompanied by a
       * certificate chain certifying the corresponding public key. If the
<span class="line-new-header">--- 389,11 ---</span>
              }
          }
      }
  
      /**
<span class="line-modified">!      * Assigns the given key (that has already been protected) to the given</span>
       * alias.
       *
       * &lt;p&gt;If the protected key is of type
       * &lt;code&gt;java.security.PrivateKey&lt;/code&gt;, it must be accompanied by a
       * certificate chain certifying the corresponding public key. If the
</pre>
<hr />
<pre>
<span class="line-old-header">*** 401,17 ***</span>
       * &lt;code&gt;key&lt;/code&gt; must be encoded as an
       * &lt;code&gt;EncryptedPrivateKeyInfo&lt;/code&gt; as defined in the PKCS #8 standard.
       *
       * &lt;p&gt;If the given alias already exists, the keystore information
       * associated with it is overridden by the given key (and possibly
<span class="line-modified">!                                                           * certificate chain).</span>
       *
       * @param alias the alias name
       * @param key the key (in protected format) to be associated with the alias
       * @param chain the certificate chain for the corresponding public
       * key (only useful if the protected key is of type
<span class="line-modified">!             * &lt;code&gt;java.security.PrivateKey&lt;/code&gt;).</span>
       *
       * @exception KeyStoreException if this operation fails.
       */
      public void engineSetKeyEntry(String alias, byte[] key,
                                    Certificate[] chain)
<span class="line-new-header">--- 401,17 ---</span>
       * &lt;code&gt;key&lt;/code&gt; must be encoded as an
       * &lt;code&gt;EncryptedPrivateKeyInfo&lt;/code&gt; as defined in the PKCS #8 standard.
       *
       * &lt;p&gt;If the given alias already exists, the keystore information
       * associated with it is overridden by the given key (and possibly
<span class="line-modified">!      * certificate chain).</span>
       *
       * @param alias the alias name
       * @param key the key (in protected format) to be associated with the alias
       * @param chain the certificate chain for the corresponding public
       * key (only useful if the protected key is of type
<span class="line-modified">!      * &lt;code&gt;java.security.PrivateKey&lt;/code&gt;).</span>
       *
       * @exception KeyStoreException if this operation fails.
       */
      public void engineSetKeyEntry(String alias, byte[] key,
                                    Certificate[] chain)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 447,11 ***</span>
              addedEntries.put(lowerAlias, entry);
          }
      }
  
      /**
<span class="line-modified">!         * Assigns the given certificate to the given alias.</span>
       *
       * &lt;p&gt;If the given alias already exists in this keystore and identifies a
       * &lt;i&gt;trusted certificate entry&lt;/i&gt;, the certificate associated with it is
       * overridden by the given certificate.
       *
<span class="line-new-header">--- 447,11 ---</span>
              addedEntries.put(lowerAlias, entry);
          }
      }
  
      /**
<span class="line-modified">!      * Assigns the given certificate to the given alias.</span>
       *
       * &lt;p&gt;If the given alias already exists in this keystore and identifies a
       * &lt;i&gt;trusted certificate entry&lt;/i&gt;, the certificate associated with it is
       * overridden by the given certificate.
       *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 499,11 ***</span>
              addedEntries.put(lowerAlias, trustedCertEntry);
          }
      }
  
      /**
<span class="line-modified">!         * Deletes the entry identified by the given alias from this keystore.</span>
       *
       * @param alias the alias name
       *
       * @exception KeyStoreException if the entry cannot be removed.
       */
<span class="line-new-header">--- 499,11 ---</span>
              addedEntries.put(lowerAlias, trustedCertEntry);
          }
      }
  
      /**
<span class="line-modified">!      * Deletes the entry identified by the given alias from this keystore.</span>
       *
       * @param alias the alias name
       *
       * @exception KeyStoreException if the entry cannot be removed.
       */
</pre>
<hr />
<pre>
<span class="line-old-header">*** 517,21 ***</span>
              deletedEntries.put(alias.toLowerCase(), entry);
          }
      }
  
      /**
<span class="line-modified">!         * Lists all the alias names of this keystore.</span>
       *
       * @return enumeration of the alias names
       */
      public Enumeration&lt;String&gt; engineAliases() {
          permissionCheck();
          return entries.keys();
      }
  
      /**
<span class="line-modified">!         * Checks if the given alias exists in this keystore.</span>
       *
       * @param alias the alias name
       *
       * @return true if the alias exists, false otherwise
       */
<span class="line-new-header">--- 517,21 ---</span>
              deletedEntries.put(alias.toLowerCase(), entry);
          }
      }
  
      /**
<span class="line-modified">!      * Lists all the alias names of this keystore.</span>
       *
       * @return enumeration of the alias names
       */
      public Enumeration&lt;String&gt; engineAliases() {
          permissionCheck();
          return entries.keys();
      }
  
      /**
<span class="line-modified">!      * Checks if the given alias exists in this keystore.</span>
       *
       * @param alias the alias name
       *
       * @return true if the alias exists, false otherwise
       */
</pre>
<hr />
<pre>
<span class="line-old-header">*** 539,21 ***</span>
          permissionCheck();
          return entries.containsKey(alias.toLowerCase());
      }
  
      /**
<span class="line-modified">!         * Retrieves the number of entries in this keystore.</span>
       *
       * @return the number of entries in this keystore
       */
      public int engineSize() {
          permissionCheck();
          return entries.size();
      }
  
      /**
<span class="line-modified">!         * Returns true if the entry identified by the given alias is a</span>
       * &lt;i&gt;key entry&lt;/i&gt;, and false otherwise.
       *
       * @return true if the entry identified by the given alias is a
       * &lt;i&gt;key entry&lt;/i&gt;, false otherwise.
       */
<span class="line-new-header">--- 539,21 ---</span>
          permissionCheck();
          return entries.containsKey(alias.toLowerCase());
      }
  
      /**
<span class="line-modified">!      * Retrieves the number of entries in this keystore.</span>
       *
       * @return the number of entries in this keystore
       */
      public int engineSize() {
          permissionCheck();
          return entries.size();
      }
  
      /**
<span class="line-modified">!      * Returns true if the entry identified by the given alias is a</span>
       * &lt;i&gt;key entry&lt;/i&gt;, and false otherwise.
       *
       * @return true if the entry identified by the given alias is a
       * &lt;i&gt;key entry&lt;/i&gt;, false otherwise.
       */
</pre>
<hr />
<pre>
<span class="line-old-header">*** 566,11 ***</span>
              return false;
          }
      }
  
      /**
<span class="line-modified">!         * Returns true if the entry identified by the given alias is a</span>
       * &lt;i&gt;trusted certificate entry&lt;/i&gt;, and false otherwise.
       *
       * @return true if the entry identified by the given alias is a
       * &lt;i&gt;trusted certificate entry&lt;/i&gt;, false otherwise.
       */
<span class="line-new-header">--- 566,11 ---</span>
              return false;
          }
      }
  
      /**
<span class="line-modified">!      * Returns true if the entry identified by the given alias is a</span>
       * &lt;i&gt;trusted certificate entry&lt;/i&gt;, and false otherwise.
       *
       * @return true if the entry identified by the given alias is a
       * &lt;i&gt;trusted certificate entry&lt;/i&gt;, false otherwise.
       */
</pre>
<hr />
<pre>
<span class="line-old-header">*** 583,11 ***</span>
              return false;
          }
      }
  
      /**
<span class="line-modified">!         * Returns the (alias) name of the first keystore entry whose certificate</span>
       * matches the given certificate.
       *
       * &lt;p&gt;This method attempts to match the given certificate with each
       * keystore entry. If the entry being considered
       * is a &lt;i&gt;trusted certificate entry&lt;/i&gt;, the given certificate is
<span class="line-new-header">--- 583,11 ---</span>
              return false;
          }
      }
  
      /**
<span class="line-modified">!      * Returns the (alias) name of the first keystore entry whose certificate</span>
       * matches the given certificate.
       *
       * &lt;p&gt;This method attempts to match the given certificate with each
       * keystore entry. If the entry being considered
       * is a &lt;i&gt;trusted certificate entry&lt;/i&gt;, the given certificate is
</pre>
<hr />
<pre>
<span class="line-old-header">*** 622,11 ***</span>
          }
          return null;
      }
  
      /**
<span class="line-modified">!         * Stores this keystore to the given output stream, and protects its</span>
       * integrity with the given password.
       *
       * @param stream Ignored. the output stream to which this keystore is written.
       * @param password the password to generate the keystore integrity check
       *
<span class="line-new-header">--- 622,11 ---</span>
          }
          return null;
      }
  
      /**
<span class="line-modified">!      * Stores this keystore to the given output stream, and protects its</span>
       * integrity with the given password.
       *
       * @param stream Ignored. the output stream to which this keystore is written.
       * @param password the password to generate the keystore integrity check
       *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 716,11 ***</span>
      private native long _addItemToKeychain(String alias, boolean isCertificate, byte[] datablob, char[] password);
      private native int _removeItemFromKeychain(long certRef);
      private native void _releaseKeychainItemRef(long keychainItemRef);
  
      /**
<span class="line-modified">!       * Loads the keystore from the Keychain.</span>
       *
       * @param stream Ignored - here for API compatibility.
       * @param password Ignored - if user needs to unlock keychain Security
       * framework will post any dialogs.
       *
<span class="line-new-header">--- 716,11 ---</span>
      private native long _addItemToKeychain(String alias, boolean isCertificate, byte[] datablob, char[] password);
      private native int _removeItemFromKeychain(long certRef);
      private native void _releaseKeychainItemRef(long keychainItemRef);
  
      /**
<span class="line-modified">!      * Loads the keystore from the Keychain.</span>
       *
       * @param stream Ignored - here for API compatibility.
       * @param password Ignored - if user needs to unlock keychain Security
       * framework will post any dialogs.
       *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 916,11 ***</span>
          if (version != 3) {
              throw new IOException(&quot;PKCS12 keystore not in version 3 format&quot;);
          }
  
          /*
<span class="line-modified">!             * Read the authSafe.</span>
           */
          byte[] authSafeData;
          ContentInfo authSafe = new ContentInfo(s);
          ObjectIdentifier contentType = authSafe.getContentType();
  
<span class="line-new-header">--- 916,11 ---</span>
          if (version != 3) {
              throw new IOException(&quot;PKCS12 keystore not in version 3 format&quot;);
          }
  
          /*
<span class="line-modified">!          * Read the authSafe.</span>
           */
          byte[] authSafeData;
          ContentInfo authSafe = new ContentInfo(s);
          ObjectIdentifier contentType = authSafe.getContentType();
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1001,11 ***</span>
  
          return returnValue;
      }
  
      /*
<span class="line-modified">!         * Generate PBE Algorithm Parameters</span>
       */
      private AlgorithmParameters getAlgorithmParameters(String algorithm)
          throws IOException
      {
          AlgorithmParameters algParams = null;
<span class="line-new-header">--- 1001,11 ---</span>
  
          return returnValue;
      }
  
      /*
<span class="line-modified">!      * Generate PBE Algorithm Parameters</span>
       */
      private AlgorithmParameters getAlgorithmParameters(String algorithm)
          throws IOException
      {
          AlgorithmParameters algParams = null;
</pre>
<center><a href="../../../../linux/native/libnio/ch/EPoll.c.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../java/net/DefaultInterface.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>