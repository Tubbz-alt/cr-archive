<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/sun/security/ssl/SSLExtension.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="RenegoInfoExtension.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="SSLExtensions.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/ssl/SSLExtension.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
125                                 CertStatusExtension.certStatusRespStringizer),
126 
127     // extensions defined in RFC 4681
128     USER_MAPPING            (0x0006, &quot;user_mapping&quot;),
129 
130     // extensions defined in RFC 5878
131     CLIENT_AUTHZ            (0x0007, &quot;client_authz&quot;),
132     SERVER_AUTHZ            (0x0008, &quot;server_authz&quot;),
133 
134     // extensions defined in RFC 5081
135     CERT_TYPE               (0x0009, &quot;cert_type&quot;),
136 
137     // extensions defined in RFC 4492 (ECC)
138     CH_SUPPORTED_GROUPS     (0x000A, &quot;supported_groups&quot;,
139                                 SSLHandshake.CLIENT_HELLO,
140                                 ProtocolVersion.PROTOCOLS_TO_13,
141                                 SupportedGroupsExtension.chNetworkProducer,
142                                 SupportedGroupsExtension.chOnLoadConsumer,
143                                 null,
144                                 null,
<span class="line-modified">145                                 null,</span>
146                                 SupportedGroupsExtension.sgsStringizer),
147     EE_SUPPORTED_GROUPS     (0x000A, &quot;supported_groups&quot;,
148                                 SSLHandshake.ENCRYPTED_EXTENSIONS,
149                                 ProtocolVersion.PROTOCOLS_OF_13,
150                                 SupportedGroupsExtension.eeNetworkProducer,
151                                 SupportedGroupsExtension.eeOnLoadConsumer,
152                                 null,
153                                 null,
154                                 null,
155                                 SupportedGroupsExtension.sgsStringizer),
156 
157     CH_EC_POINT_FORMATS     (0x000B, &quot;ec_point_formats&quot;,
158                                 SSLHandshake.CLIENT_HELLO,
159                                 ProtocolVersion.PROTOCOLS_TO_12,
160                                 ECPointFormatsExtension.chNetworkProducer,
161                                 ECPointFormatsExtension.chOnLoadConsumer,
162                                 null,
163                                 null,
164                                 null,
165                                 ECPointFormatsExtension.epfStringizer),
</pre>
<hr />
<pre>
399                                 CookieExtension.cookieStringizer),
400 
401     PSK_KEY_EXCHANGE_MODES  (0x002D, &quot;psk_key_exchange_modes&quot;,
402                                 SSLHandshake.CLIENT_HELLO,
403                                 ProtocolVersion.PROTOCOLS_OF_13,
404                                 PskKeyExchangeModesExtension.chNetworkProducer,
405                                 PskKeyExchangeModesExtension.chOnLoadConsumer,
406                                 PskKeyExchangeModesExtension.chOnLoadAbsence,
407                                 null,
408                                 PskKeyExchangeModesExtension.chOnTradeAbsence,
409                                 PskKeyExchangeModesExtension.pkemStringizer),
410     CERTIFICATE_AUTHORITIES (0x002F, &quot;certificate_authorities&quot;),
411     OID_FILTERS             (0x0030, &quot;oid_filters&quot;),
412     POST_HANDSHAKE_AUTH     (0x0030, &quot;post_handshake_auth&quot;),
413 
414     CH_KEY_SHARE            (0x0033, &quot;key_share&quot;,
415                                 SSLHandshake.CLIENT_HELLO,
416                                 ProtocolVersion.PROTOCOLS_OF_13,
417                                 KeyShareExtension.chNetworkProducer,
418                                 KeyShareExtension.chOnLoadConsumer,
<span class="line-modified">419                                 null, null, null,</span>


420                                 KeyShareExtension.chStringizer),
421     SH_KEY_SHARE            (0x0033, &quot;key_share&quot;,
422                                 SSLHandshake.SERVER_HELLO,
423                                 ProtocolVersion.PROTOCOLS_OF_13,
424                                 KeyShareExtension.shNetworkProducer,
425                                 KeyShareExtension.shOnLoadConsumer,
426                                 KeyShareExtension.shOnLoadAbsence,
427                                 null,
428                                 null,
429                                 KeyShareExtension.shStringizer),
430     HRR_KEY_SHARE           (0x0033, &quot;key_share&quot;,
431                                 SSLHandshake.HELLO_RETRY_REQUEST,
432                                 ProtocolVersion.PROTOCOLS_OF_13,
433                                 KeyShareExtension.hrrNetworkProducer,
434                                 KeyShareExtension.hrrOnLoadConsumer,
435                                 null, null, null,
436                                 KeyShareExtension.hrrStringizer),
437     MH_KEY_SHARE            (0x0033, &quot;key_share&quot;,
438                                 SSLHandshake.MESSAGE_HASH,
439                                 ProtocolVersion.PROTOCOLS_OF_13,
</pre>
<hr />
<pre>
452                                 null,
453                                 RenegoInfoExtension.rniStringizer),
454     SH_RENEGOTIATION_INFO   (0xff01, &quot;renegotiation_info&quot;,
455                                 SSLHandshake.SERVER_HELLO,
456                                 ProtocolVersion.PROTOCOLS_TO_12,
457                                 RenegoInfoExtension.shNetworkProducer,
458                                 RenegoInfoExtension.shOnLoadConsumer,
459                                 RenegoInfoExtension.shOnLoadAbsence,
460                                 null,
461                                 null,
462                                 RenegoInfoExtension.rniStringizer),
463 
464     // TLS 1.3 PSK extension must be last
465     CH_PRE_SHARED_KEY       (0x0029, &quot;pre_shared_key&quot;,
466                                 SSLHandshake.CLIENT_HELLO,
467                                 ProtocolVersion.PROTOCOLS_OF_13,
468                                 PreSharedKeyExtension.chNetworkProducer,
469                                 PreSharedKeyExtension.chOnLoadConsumer,
470                                 PreSharedKeyExtension.chOnLoadAbsence,
471                                 PreSharedKeyExtension.chOnTradeConsumer,
<span class="line-modified">472                                 null,</span>
473                                 PreSharedKeyExtension.chStringizer),
474     SH_PRE_SHARED_KEY       (0x0029, &quot;pre_shared_key&quot;,
475                                 SSLHandshake.SERVER_HELLO,
476                                 ProtocolVersion.PROTOCOLS_OF_13,
477                                 PreSharedKeyExtension.shNetworkProducer,
478                                 PreSharedKeyExtension.shOnLoadConsumer,
479                                 PreSharedKeyExtension.shOnLoadAbsence,
480                                 null, null,
481                                 PreSharedKeyExtension.shStringizer);
482 
483     final int id;
484     final SSLHandshake handshakeType;
485     final String name;
486     final ProtocolVersion[] supportedProtocols;
487 
488     /*
489      * networkProducer: produces outbound handshake data.
490      *
491      * onLoadConsumer:  parses inbound data.  It may not be appropriate
492      *                  to act until all of the message inputs have
</pre>
<hr />
<pre>
624                     &quot;Not yet supported extension absence processing.&quot;);
625         }
626     }
627 
628     public boolean isAvailable(ProtocolVersion protocolVersion) {
629         for (int i = 0; i &lt; supportedProtocols.length; i++) {
630             if (supportedProtocols[i] == protocolVersion) {
631                 return true;
632             }
633         }
634 
635         return false;
636     }
637 
638     @Override
639     public String toString() {
640         return name;
641     }
642 
643     @Override
<span class="line-modified">644     public String toString(ByteBuffer byteBuffer) {</span>

645         MessageFormat messageFormat = new MessageFormat(
646             &quot;\&quot;{0} ({1})\&quot;: &#39;{&#39;\n&quot; +
647             &quot;{2}\n&quot; +
648             &quot;&#39;}&#39;&quot;,
649             Locale.ENGLISH);
650 
651         String extData;
652         if (stringizer == null) {
653             HexDumpEncoder hexEncoder = new HexDumpEncoder();
654             String encoded = hexEncoder.encode(byteBuffer.duplicate());
655             extData = encoded;
656         } else {
<span class="line-modified">657             extData = stringizer.toString(byteBuffer);</span>
658         }
659 
660         Object[] messageFields = {
661             this.name,
662             this.id,
663             Utilities.indent(extData)
664         };
665 
666         return messageFormat.format(messageFields);
667     }
668 
669     //////////////////////////////////////////////////////
670     // Nested extension, consumer and producer interfaces.
671 
672     static interface ExtensionConsumer {
673         void consume(ConnectionContext context,
674                 HandshakeMessage message, ByteBuffer buffer) throws IOException;
675     }
676 
677     /**
</pre>
</td>
<td>
<hr />
<pre>
125                                 CertStatusExtension.certStatusRespStringizer),
126 
127     // extensions defined in RFC 4681
128     USER_MAPPING            (0x0006, &quot;user_mapping&quot;),
129 
130     // extensions defined in RFC 5878
131     CLIENT_AUTHZ            (0x0007, &quot;client_authz&quot;),
132     SERVER_AUTHZ            (0x0008, &quot;server_authz&quot;),
133 
134     // extensions defined in RFC 5081
135     CERT_TYPE               (0x0009, &quot;cert_type&quot;),
136 
137     // extensions defined in RFC 4492 (ECC)
138     CH_SUPPORTED_GROUPS     (0x000A, &quot;supported_groups&quot;,
139                                 SSLHandshake.CLIENT_HELLO,
140                                 ProtocolVersion.PROTOCOLS_TO_13,
141                                 SupportedGroupsExtension.chNetworkProducer,
142                                 SupportedGroupsExtension.chOnLoadConsumer,
143                                 null,
144                                 null,
<span class="line-modified">145                                 SupportedGroupsExtension.chOnTradAbsence,</span>
146                                 SupportedGroupsExtension.sgsStringizer),
147     EE_SUPPORTED_GROUPS     (0x000A, &quot;supported_groups&quot;,
148                                 SSLHandshake.ENCRYPTED_EXTENSIONS,
149                                 ProtocolVersion.PROTOCOLS_OF_13,
150                                 SupportedGroupsExtension.eeNetworkProducer,
151                                 SupportedGroupsExtension.eeOnLoadConsumer,
152                                 null,
153                                 null,
154                                 null,
155                                 SupportedGroupsExtension.sgsStringizer),
156 
157     CH_EC_POINT_FORMATS     (0x000B, &quot;ec_point_formats&quot;,
158                                 SSLHandshake.CLIENT_HELLO,
159                                 ProtocolVersion.PROTOCOLS_TO_12,
160                                 ECPointFormatsExtension.chNetworkProducer,
161                                 ECPointFormatsExtension.chOnLoadConsumer,
162                                 null,
163                                 null,
164                                 null,
165                                 ECPointFormatsExtension.epfStringizer),
</pre>
<hr />
<pre>
399                                 CookieExtension.cookieStringizer),
400 
401     PSK_KEY_EXCHANGE_MODES  (0x002D, &quot;psk_key_exchange_modes&quot;,
402                                 SSLHandshake.CLIENT_HELLO,
403                                 ProtocolVersion.PROTOCOLS_OF_13,
404                                 PskKeyExchangeModesExtension.chNetworkProducer,
405                                 PskKeyExchangeModesExtension.chOnLoadConsumer,
406                                 PskKeyExchangeModesExtension.chOnLoadAbsence,
407                                 null,
408                                 PskKeyExchangeModesExtension.chOnTradeAbsence,
409                                 PskKeyExchangeModesExtension.pkemStringizer),
410     CERTIFICATE_AUTHORITIES (0x002F, &quot;certificate_authorities&quot;),
411     OID_FILTERS             (0x0030, &quot;oid_filters&quot;),
412     POST_HANDSHAKE_AUTH     (0x0030, &quot;post_handshake_auth&quot;),
413 
414     CH_KEY_SHARE            (0x0033, &quot;key_share&quot;,
415                                 SSLHandshake.CLIENT_HELLO,
416                                 ProtocolVersion.PROTOCOLS_OF_13,
417                                 KeyShareExtension.chNetworkProducer,
418                                 KeyShareExtension.chOnLoadConsumer,
<span class="line-modified">419                                 null,</span>
<span class="line-added">420                                 null,</span>
<span class="line-added">421                                 KeyShareExtension.chOnTradAbsence,</span>
422                                 KeyShareExtension.chStringizer),
423     SH_KEY_SHARE            (0x0033, &quot;key_share&quot;,
424                                 SSLHandshake.SERVER_HELLO,
425                                 ProtocolVersion.PROTOCOLS_OF_13,
426                                 KeyShareExtension.shNetworkProducer,
427                                 KeyShareExtension.shOnLoadConsumer,
428                                 KeyShareExtension.shOnLoadAbsence,
429                                 null,
430                                 null,
431                                 KeyShareExtension.shStringizer),
432     HRR_KEY_SHARE           (0x0033, &quot;key_share&quot;,
433                                 SSLHandshake.HELLO_RETRY_REQUEST,
434                                 ProtocolVersion.PROTOCOLS_OF_13,
435                                 KeyShareExtension.hrrNetworkProducer,
436                                 KeyShareExtension.hrrOnLoadConsumer,
437                                 null, null, null,
438                                 KeyShareExtension.hrrStringizer),
439     MH_KEY_SHARE            (0x0033, &quot;key_share&quot;,
440                                 SSLHandshake.MESSAGE_HASH,
441                                 ProtocolVersion.PROTOCOLS_OF_13,
</pre>
<hr />
<pre>
454                                 null,
455                                 RenegoInfoExtension.rniStringizer),
456     SH_RENEGOTIATION_INFO   (0xff01, &quot;renegotiation_info&quot;,
457                                 SSLHandshake.SERVER_HELLO,
458                                 ProtocolVersion.PROTOCOLS_TO_12,
459                                 RenegoInfoExtension.shNetworkProducer,
460                                 RenegoInfoExtension.shOnLoadConsumer,
461                                 RenegoInfoExtension.shOnLoadAbsence,
462                                 null,
463                                 null,
464                                 RenegoInfoExtension.rniStringizer),
465 
466     // TLS 1.3 PSK extension must be last
467     CH_PRE_SHARED_KEY       (0x0029, &quot;pre_shared_key&quot;,
468                                 SSLHandshake.CLIENT_HELLO,
469                                 ProtocolVersion.PROTOCOLS_OF_13,
470                                 PreSharedKeyExtension.chNetworkProducer,
471                                 PreSharedKeyExtension.chOnLoadConsumer,
472                                 PreSharedKeyExtension.chOnLoadAbsence,
473                                 PreSharedKeyExtension.chOnTradeConsumer,
<span class="line-modified">474                                 PreSharedKeyExtension.chOnTradAbsence,</span>
475                                 PreSharedKeyExtension.chStringizer),
476     SH_PRE_SHARED_KEY       (0x0029, &quot;pre_shared_key&quot;,
477                                 SSLHandshake.SERVER_HELLO,
478                                 ProtocolVersion.PROTOCOLS_OF_13,
479                                 PreSharedKeyExtension.shNetworkProducer,
480                                 PreSharedKeyExtension.shOnLoadConsumer,
481                                 PreSharedKeyExtension.shOnLoadAbsence,
482                                 null, null,
483                                 PreSharedKeyExtension.shStringizer);
484 
485     final int id;
486     final SSLHandshake handshakeType;
487     final String name;
488     final ProtocolVersion[] supportedProtocols;
489 
490     /*
491      * networkProducer: produces outbound handshake data.
492      *
493      * onLoadConsumer:  parses inbound data.  It may not be appropriate
494      *                  to act until all of the message inputs have
</pre>
<hr />
<pre>
626                     &quot;Not yet supported extension absence processing.&quot;);
627         }
628     }
629 
630     public boolean isAvailable(ProtocolVersion protocolVersion) {
631         for (int i = 0; i &lt; supportedProtocols.length; i++) {
632             if (supportedProtocols[i] == protocolVersion) {
633                 return true;
634             }
635         }
636 
637         return false;
638     }
639 
640     @Override
641     public String toString() {
642         return name;
643     }
644 
645     @Override
<span class="line-modified">646     public String toString(</span>
<span class="line-added">647             HandshakeContext handshakeContext, ByteBuffer byteBuffer) {</span>
648         MessageFormat messageFormat = new MessageFormat(
649             &quot;\&quot;{0} ({1})\&quot;: &#39;{&#39;\n&quot; +
650             &quot;{2}\n&quot; +
651             &quot;&#39;}&#39;&quot;,
652             Locale.ENGLISH);
653 
654         String extData;
655         if (stringizer == null) {
656             HexDumpEncoder hexEncoder = new HexDumpEncoder();
657             String encoded = hexEncoder.encode(byteBuffer.duplicate());
658             extData = encoded;
659         } else {
<span class="line-modified">660             extData = stringizer.toString(handshakeContext, byteBuffer);</span>
661         }
662 
663         Object[] messageFields = {
664             this.name,
665             this.id,
666             Utilities.indent(extData)
667         };
668 
669         return messageFormat.format(messageFields);
670     }
671 
672     //////////////////////////////////////////////////////
673     // Nested extension, consumer and producer interfaces.
674 
675     static interface ExtensionConsumer {
676         void consume(ConnectionContext context,
677                 HandshakeMessage message, ByteBuffer buffer) throws IOException;
678     }
679 
680     /**
</pre>
</td>
</tr>
</table>
<center><a href="RenegoInfoExtension.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="SSLExtensions.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>