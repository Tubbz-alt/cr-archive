<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/markup/HtmlTree.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (c) 2010, 2020, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package jdk.javadoc.internal.doclets.formats.html.markup;
 27 
 28 import java.io.IOException;
 29 import java.io.Writer;
<a name="1" id="anc1"></a><span class="line-modified"> 30 import java.nio.charset.StandardCharsets;</span>
 31 import java.util.ArrayList;
 32 import java.util.BitSet;
<a name="2" id="anc2"></a>
 33 import java.util.Iterator;
 34 import java.util.LinkedHashMap;
 35 import java.util.List;
 36 import java.util.Map;
<a name="3" id="anc3"></a><span class="line-added"> 37 import java.util.Objects;</span>
 38 
 39 import jdk.javadoc.internal.doclets.formats.html.markup.HtmlAttr.Role;
 40 import jdk.javadoc.internal.doclets.toolkit.Content;
 41 import jdk.javadoc.internal.doclets.toolkit.util.DocletConstants;
 42 
 43 /**
<a name="4" id="anc4"></a><span class="line-modified"> 44  * A tree node representing an HTML element, containing the name of the element,</span>
<span class="line-added"> 45  * a collection of attributes, and content.</span>
<span class="line-added"> 46  *</span>
<span class="line-added"> 47  * Except where otherwise stated, all methods in this class will throw</span>
<span class="line-added"> 48  * {@code NullPointerException} for any arguments that are {@code null}</span>
<span class="line-added"> 49  * or that are arrays or collections that contain {@code null}.</span>
<span class="line-added"> 50  *</span>
<span class="line-added"> 51  * Many methods in this class return {@code this}, to enable a series</span>
<span class="line-added"> 52  * of chained method calls on a single object.</span>
<span class="line-added"> 53  *</span>
<span class="line-added"> 54  * Terminology: An HTML element is typically composed of a start tag, some</span>
<span class="line-added"> 55  * enclosed content and typically an end tag. The start tag contains any</span>
<span class="line-added"> 56  * attributes for the element. See:</span>
<span class="line-added"> 57  * &lt;a href=&quot;https://en.wikipedia.org/wiki/HTML_element&quot;&gt;HTML element&lt;/a&gt;.</span>
 58  *
 59  *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
 60  *  If you write code that depends on this, you do so at your own risk.
 61  *  This code and its internal interfaces are subject to change or
 62  *  deletion without notice.&lt;/b&gt;
<a name="5" id="anc5"></a><span class="line-added"> 63  *</span>
<span class="line-added"> 64  * @see &lt;a href=&quot;https://html.spec.whatwg.org/multipage/syntax.html#normal-elements&quot;&gt;WhatWG: Normal Elements&lt;/a&gt;</span>
<span class="line-added"> 65  * @see &lt;a href=&quot;https://www.w3.org/TR/html51/syntax.html#writing-html-documents-elements&quot;&gt;HTML 5.1: Elements&lt;/a&gt;</span>
 66  */
 67 public class HtmlTree extends Content {
 68 
<a name="6" id="anc6"></a><span class="line-modified"> 69     /**</span>
<span class="line-modified"> 70      * The name of the HTML element.</span>
<span class="line-modified"> 71      * This value is never {@code null}.</span>
<span class="line-modified"> 72      */</span>
<span class="line-added"> 73     public final TagName tagName;</span>
 74 
 75     /**
<a name="7" id="anc7"></a><span class="line-modified"> 76      * The attributes for the HTML element.</span>
<span class="line-modified"> 77      * The keys and values in this map are never {@code null}.</span>

 78      */
<a name="8" id="anc8"></a><span class="line-modified"> 79     private Map&lt;HtmlAttr, String&gt; attrs = Map.of();</span>


 80 
 81     /**
<a name="9" id="anc9"></a><span class="line-modified"> 82      * The enclosed content (&quot;inner HTML&quot;) for this HTML element.</span>
<span class="line-modified"> 83      * The items in this list are never null.</span>


 84      */
<a name="10" id="anc10"></a><span class="line-modified"> 85     private List&lt;Content&gt; content = List.of();</span>
<span class="line-modified"> 86 </span>
<span class="line-modified"> 87     /**</span>
<span class="line-modified"> 88      * A sentinel value to explicitly indicate empty content.</span>
<span class="line-modified"> 89      */</span>
<span class="line-added"> 90     public static final Content EMPTY = new StringContent(&quot;&quot;);</span>
 91 
 92     /**
<a name="11" id="anc11"></a><span class="line-modified"> 93      * Creates an {@code HTMLTree} object representing an HTML element</span>
<span class="line-added"> 94      * with the given name.</span>
 95      *
<a name="12" id="anc12"></a><span class="line-modified"> 96      * @param tagName the name</span>

 97      */
<a name="13" id="anc13"></a><span class="line-modified"> 98     public HtmlTree(TagName tagName) {</span>
<span class="line-modified"> 99         this.tagName = Objects.requireNonNull(tagName);</span>


100     }
101 
102     /**
<a name="14" id="anc14"></a><span class="line-modified">103      * Adds an attribute.</span>
104      *
<a name="15" id="anc15"></a><span class="line-modified">105      * @param attrName  the name of the attribute</span>
<span class="line-modified">106      * @param attrValue the value of the attribute</span>
107      * @return this object
108      */
109     public HtmlTree put(HtmlAttr attrName, String attrValue) {
110         if (attrs.isEmpty())
111             attrs = new LinkedHashMap&lt;&gt;(3);
<a name="16" id="anc16"></a><span class="line-modified">112         attrs.put(Objects.requireNonNull(attrName), Entity.escapeHtmlChars(attrValue));</span>
113         return this;
114     }
115 
116     /**
<a name="17" id="anc17"></a><span class="line-modified">117      * Sets the {@code id} attribute.</span>
118      *
<a name="18" id="anc18"></a><span class="line-modified">119      * @param id the value for the attribute</span>
120      * @return this object
121      */
122     public HtmlTree setId(String id) {
<a name="19" id="anc19"></a><span class="line-modified">123         return put(HtmlAttr.ID, id);</span>

124     }
125 
126     /**
<a name="20" id="anc20"></a><span class="line-modified">127      * Sets the {@code title} attribute.</span>
<span class="line-modified">128      * Any nested start or end tags in the content will be removed.</span>
129      *
130      * @param body the content for the title attribute
131      * @return this object
132      */
133     public HtmlTree setTitle(Content body) {
<a name="21" id="anc21"></a><span class="line-modified">134         return put(HtmlAttr.TITLE, stripHtml(body));</span>

135     }
136 
137     /**
<a name="22" id="anc22"></a><span class="line-modified">138      * Sets the {@code role} attribute.</span>
139      *
140      * @param role the role
141      * @return this object
142      */
143     public HtmlTree setRole(Role role) {
<a name="23" id="anc23"></a><span class="line-modified">144         return put(HtmlAttr.ROLE, role.toString());</span>

145     }
146 
147     /**
<a name="24" id="anc24"></a><span class="line-modified">148      * Sets the {@code class} attribute.</span>
149      *
<a name="25" id="anc25"></a><span class="line-modified">150      * @param style the value for the attribute</span>
151      * @return this object
152      */
153     public HtmlTree setStyle(HtmlStyle style) {
<a name="26" id="anc26"></a><span class="line-modified">154         return put(HtmlAttr.CLASS, style.cssName());</span>

155     }
156 
157     /**
<a name="27" id="anc27"></a><span class="line-modified">158      * Adds additional content for the HTML element.</span>
159      *
<a name="28" id="anc28"></a><span class="line-modified">160      * @param content the content</span>
161      */
162     @Override
<a name="29" id="anc29"></a><span class="line-modified">163     public HtmlTree add(Content content) {</span>
<span class="line-modified">164         if (content instanceof ContentBuilder) {</span>
<span class="line-modified">165             ((ContentBuilder) content).contents.forEach(this::add);</span>


166         }
<a name="30" id="anc30"></a><span class="line-modified">167         else if (content == HtmlTree.EMPTY || content.isValid()) {</span>
<span class="line-modified">168             // quietly avoid adding empty or invalid nodes (except EMPTY)</span>
<span class="line-modified">169             if (this.content.isEmpty())</span>
<span class="line-modified">170                 this.content = new ArrayList&lt;&gt;();</span>
<span class="line-added">171             this.content.add(content);</span>
172         }
<a name="31" id="anc31"></a><span class="line-added">173         return this;</span>
174     }
175 
176     /**
<a name="32" id="anc32"></a><span class="line-modified">177      * Adds text content for the HTML element.</span>
<span class="line-modified">178      *</span>
<span class="line-modified">179      * If the last content member that was added is a {@code StringContent},</span>
<span class="line-added">180      * appends the string to that item; otherwise, creates and uses a new {@code StringContent}</span>
<span class="line-added">181      * for the new text content.</span>
182      *
183      * @param stringContent string content that needs to be added
184      */
185     @Override
<a name="33" id="anc33"></a><span class="line-modified">186     public HtmlTree add(CharSequence stringContent) {</span>
187         if (!content.isEmpty()) {
188             Content lastContent = content.get(content.size() - 1);
189             if (lastContent instanceof StringContent)
190                 lastContent.add(stringContent);
<a name="34" id="anc34"></a><span class="line-modified">191             else {</span>
192                 add(new StringContent(stringContent));
<a name="35" id="anc35"></a><span class="line-added">193             }</span>
194         }
<a name="36" id="anc36"></a><span class="line-modified">195         else {</span>
196             add(new StringContent(stringContent));
<a name="37" id="anc37"></a><span class="line-added">197         }</span>
<span class="line-added">198         return this;</span>
<span class="line-added">199     }</span>
<span class="line-added">200 </span>
<span class="line-added">201     /**</span>
<span class="line-added">202      * Adds each of a list of content items.</span>
<span class="line-added">203      *</span>
<span class="line-added">204      * @param list the list</span>
<span class="line-added">205      * @return this object</span>
<span class="line-added">206      */</span>
<span class="line-added">207     public HtmlTree add(List&lt;? extends Content&gt; list) {</span>
<span class="line-added">208         list.forEach(this::add);</span>
<span class="line-added">209         return this;</span>
210     }
211 
212     @Override
213     public int charCount() {
214         int n = 0;
<a name="38" id="anc38"></a><span class="line-modified">215         for (Content c : content) {</span>
216             n += c.charCount();
<a name="39" id="anc39"></a><span class="line-added">217         }</span>
218         return n;
219     }
220 
221     /*
222      * The sets of ASCII URI characters to be left unencoded.
223      * See &quot;Uniform Resource Identifier (URI): Generic Syntax&quot;
224      * IETF RFC 3986. https://tools.ietf.org/html/rfc3986
225      */
226     public static final BitSet MAIN_CHARS;
227     public static final BitSet QUERY_FRAGMENT_CHARS;
228 
229     static {
230         BitSet alphaDigit = bitSet(bitSet(&#39;A&#39;, &#39;Z&#39;), bitSet(&#39;a&#39;, &#39;z&#39;), bitSet(&#39;0&#39;, &#39;9&#39;));
231         BitSet unreserved = bitSet(alphaDigit, bitSet(&quot;-._~&quot;));
232         BitSet genDelims = bitSet(&quot;:/?#[]@&quot;);
233         BitSet subDelims = bitSet(&quot;!$&amp;&#39;()*+,;=&quot;);
234         MAIN_CHARS = bitSet(unreserved, genDelims, subDelims);
235         BitSet pchar = bitSet(unreserved, subDelims, bitSet(&quot;:@&quot;));
236         QUERY_FRAGMENT_CHARS = bitSet(pchar, bitSet(&quot;/?&quot;));
237     }
238 
239     private static BitSet bitSet(String s) {
240         BitSet result = new BitSet();
241         for (int i = 0; i &lt; s.length(); i++) {
242            result.set(s.charAt(i));
243         }
244         return result;
245     }
246 
247     private static BitSet bitSet(char from, char to) {
248         BitSet result = new BitSet();
249         result.set(from, to + 1);
250         return result;
251     }
252 
253     private static BitSet bitSet(BitSet... sets) {
254         BitSet result = new BitSet();
255         for (BitSet set : sets) {
256             result.or(set);
257         }
258         return result;
259     }
260 
261     /**
262      * Apply percent-encoding to a URL.
263      * This is similar to {@link java.net.URLEncoder} but
264      * is less aggressive about encoding some characters,
265      * like &#39;(&#39;, &#39;)&#39;, &#39;,&#39; which are used in the anchor
266      * names for Java methods in HTML5 mode.
267      *
268      * @param url the url to be percent-encoded.
269      * @return a percent-encoded string.
270      */
271     public static String encodeURL(String url) {
272         BitSet nonEncodingChars = MAIN_CHARS;
273         StringBuilder sb = new StringBuilder();
<a name="40" id="anc40"></a><span class="line-modified">274         for (byte c : url.getBytes(StandardCharsets.UTF_8)) {</span>
275             if (c == &#39;?&#39; || c == &#39;#&#39;) {
276                 sb.append((char) c);
277                 // switch to the more restrictive set inside
278                 // the query and/or fragment
279                 nonEncodingChars = QUERY_FRAGMENT_CHARS;
280             } else if (nonEncodingChars.get(c &amp; 0xFF)) {
281                 sb.append((char) c);
282             } else {
283                 sb.append(String.format(&quot;%%%02X&quot;, c &amp; 0xFF));
284             }
285         }
286         return sb.toString();
287     }
288 
289     /**
<a name="41" id="anc41"></a><span class="line-modified">290      * Creates an HTML {@code A} element.</span>
291      *
<a name="42" id="anc42"></a><span class="line-modified">292      * @param ref the value for the {@code href} attribute}</span>
<span class="line-modified">293      * @param body the content for element</span>
<span class="line-modified">294      * @return the element</span>
295      */
296     public static HtmlTree A(String ref, Content body) {
<a name="43" id="anc43"></a><span class="line-modified">297         return new HtmlTree(TagName.A)</span>
<span class="line-modified">298                 .put(HtmlAttr.HREF, encodeURL(ref))</span>
<span class="line-modified">299                 .add(body);</span>
300     }
301 
302     /**
<a name="44" id="anc44"></a><span class="line-modified">303      * Creates an HTML {@code CAPTION} element with the given content.</span>
304      *
<a name="45" id="anc45"></a><span class="line-modified">305      * @param body content for the element</span>
<span class="line-modified">306      * @return the element</span>
307      */
308     public static HtmlTree CAPTION(Content body) {
<a name="46" id="anc46"></a><span class="line-modified">309         return new HtmlTree(TagName.CAPTION)</span>
<span class="line-modified">310                 .add(body);</span>
311     }
312 
313     /**
<a name="47" id="anc47"></a><span class="line-modified">314      * Creates an HTML {@code CODE} element with the given content.</span>
315      *
<a name="48" id="anc48"></a><span class="line-modified">316      * @param body content for the element</span>
<span class="line-modified">317      * @return the element</span>
318      */
319     public static HtmlTree CODE(Content body) {
<a name="49" id="anc49"></a><span class="line-modified">320         return new HtmlTree(TagName.CODE)</span>
<span class="line-modified">321                 .add(body);</span>
322     }
323 
324     /**
<a name="50" id="anc50"></a><span class="line-modified">325      * Creates an HTML {@code DD} element with the given content.</span>
326      *
<a name="51" id="anc51"></a><span class="line-modified">327      * @param body content for the element</span>
<span class="line-modified">328      * @return the element</span>
329      */
330     public static HtmlTree DD(Content body) {
<a name="52" id="anc52"></a><span class="line-modified">331         return new HtmlTree(TagName.DD)</span>
<span class="line-modified">332                 .add(body);</span>
333     }
334 
335     /**
<a name="53" id="anc53"></a><span class="line-modified">336      * Creates an HTML {@code DL} element with the given style.</span>
337      *
338      * @param style the style
<a name="54" id="anc54"></a><span class="line-modified">339      * @return the element</span>
340      */
341     public static HtmlTree DL(HtmlStyle style) {
<a name="55" id="anc55"></a><span class="line-modified">342         return new HtmlTree(TagName.DL)</span>
<span class="line-added">343                 .setStyle(style);</span>
344     }
345 
346     /**
<a name="56" id="anc56"></a><span class="line-modified">347      * Creates an HTML {@code DL} element with the given style and content.</span>
348      *
<a name="57" id="anc57"></a><span class="line-modified">349      * @param style the style</span>
<span class="line-modified">350      * @param body  the content</span>
<span class="line-modified">351      * @return the element</span>
352      */
353     public static HtmlTree DL(HtmlStyle style, Content body) {
<a name="58" id="anc58"></a><span class="line-modified">354         return new HtmlTree(TagName.DL)</span>
<span class="line-added">355                 .setStyle(style)</span>
<span class="line-added">356                 .add(body);</span>
<span class="line-added">357     }</span>
<span class="line-added">358 </span>
<span class="line-added">359     /**</span>
<span class="line-added">360      * Creates an HTML {@code DIV} element with the given style.</span>
<span class="line-added">361      *</span>
<span class="line-added">362      * @param style the style</span>
<span class="line-added">363      * @return the element</span>
<span class="line-added">364      */</span>
<span class="line-added">365     public static HtmlTree DIV(HtmlStyle style) {</span>
<span class="line-added">366         return new HtmlTree(TagName.DIV)</span>
<span class="line-added">367                 .setStyle(style);</span>
368     }
369 
370     /**
<a name="59" id="anc59"></a><span class="line-modified">371      * Creates an HTML {@code DIV} element with the given style and content.</span>

372      *
<a name="60" id="anc60"></a><span class="line-modified">373      * @param style the style</span>
<span class="line-modified">374      * @param body  the content</span>
<span class="line-modified">375      * @return the element</span>
376      */
<a name="61" id="anc61"></a><span class="line-modified">377     public static HtmlTree DIV(HtmlStyle style, Content body) {</span>
<span class="line-modified">378         return new HtmlTree(TagName.DIV)</span>
<span class="line-modified">379                 .setStyle(style)</span>
<span class="line-modified">380                 .add(body);</span>

381     }
382 
383     /**
<a name="62" id="anc62"></a><span class="line-modified">384      * Creates an HTML {@code DIV} element with the given content.</span>
385      *
<a name="63" id="anc63"></a><span class="line-modified">386      * @param body the content</span>
<span class="line-modified">387      * @return the element</span>
388      */
389     public static HtmlTree DIV(Content body) {
<a name="64" id="anc64"></a><span class="line-modified">390         return new HtmlTree(TagName.DIV)</span>
<span class="line-added">391                 .add(body);</span>
392     }
393 
394     /**
<a name="65" id="anc65"></a><span class="line-modified">395      * Creates an HTML {@code DT} element with the given content.</span>
396      *
<a name="66" id="anc66"></a><span class="line-modified">397      * @param body the content</span>
<span class="line-modified">398      * @return the element</span>
399      */
400     public static HtmlTree DT(Content body) {
<a name="67" id="anc67"></a><span class="line-modified">401         return new HtmlTree(TagName.DT)</span>
<span class="line-modified">402                 .add(body);</span>
403     }
404 
405     /**
<a name="68" id="anc68"></a><span class="line-modified">406      * Creates an HTML {@code FOOTER} element.</span>
<span class="line-added">407      * The role is set to {@code contentinfo}.</span>
408      *
<a name="69" id="anc69"></a><span class="line-modified">409      * @return the element</span>
410      */
411     public static HtmlTree FOOTER() {
<a name="70" id="anc70"></a><span class="line-modified">412         return new HtmlTree(TagName.FOOTER)</span>
<span class="line-modified">413                 .setRole(Role.CONTENTINFO);</span>

414     }
415 
416     /**
<a name="71" id="anc71"></a><span class="line-modified">417      * Creates an HTML {@code HEADER} element.</span>
<span class="line-added">418      * The role is set to {@code banner}.</span>
419      *
<a name="72" id="anc72"></a><span class="line-modified">420      * @return the element</span>
421      */
422     public static HtmlTree HEADER() {
<a name="73" id="anc73"></a><span class="line-modified">423         return new HtmlTree(TagName.HEADER)</span>
<span class="line-modified">424                 .setRole(Role.BANNER);</span>

425     }
426 
427     /**
<a name="74" id="anc74"></a><span class="line-modified">428      * Creates an HTML heading element with the given content.</span>

429      *
<a name="75" id="anc75"></a><span class="line-modified">430      * @param headingTag the tag for the heading</span>
<span class="line-modified">431      * @param body       the content</span>
<span class="line-modified">432      * @return the element</span>


433      */
<a name="76" id="anc76"></a><span class="line-modified">434     public static HtmlTree HEADING(TagName headingTag, Content body) {</span>
<span class="line-modified">435         return new HtmlTree(checkHeading(headingTag))</span>
<span class="line-modified">436                 .add(body);</span>





437     }
438 
439     /**
<a name="77" id="anc77"></a><span class="line-modified">440      * Creates an HTML heading element with the given style and content.</span>

441      *
<a name="78" id="anc78"></a><span class="line-modified">442      * @param headingTag the tag for the heading</span>
<span class="line-modified">443      * @param style      the stylesheet class</span>
<span class="line-modified">444      * @param body       the content</span>
<span class="line-modified">445      * @return the element</span>
446      */
<a name="79" id="anc79"></a><span class="line-modified">447     public static HtmlTree HEADING(TagName headingTag, HtmlStyle style, Content body) {</span>
<span class="line-modified">448         return new HtmlTree(checkHeading(headingTag))</span>
<span class="line-added">449                 .setStyle(style)</span>
<span class="line-added">450                 .add(body);</span>
451     }
452 
453     /**
<a name="80" id="anc80"></a><span class="line-modified">454      * Creates an HTML heading element with the given style and content.</span>
<span class="line-modified">455      * The {@code title} attribute is set from the content.</span>
456      *
<a name="81" id="anc81"></a><span class="line-modified">457      * @param headingTag the tag for the heading</span>
<span class="line-modified">458      * @param style      the stylesheet class</span>
<span class="line-modified">459      * @param body       the content</span>
<span class="line-modified">460      * @return the element</span>
461      */
<a name="82" id="anc82"></a><span class="line-modified">462     public static HtmlTree HEADING_TITLE(TagName headingTag,</span>
<span class="line-modified">463                                          HtmlStyle style, Content body) {</span>
<span class="line-added">464         return new HtmlTree(checkHeading(headingTag))</span>
<span class="line-added">465                 .setTitle(body)</span>
<span class="line-added">466                 .setStyle(style)</span>
<span class="line-added">467                 .add(body);</span>
468     }
469 
470     /**
<a name="83" id="anc83"></a><span class="line-modified">471      * Creates an HTML heading element with the given style and content.</span>
<span class="line-added">472      * The {@code title} attribute is set from the content.</span>
473      *
<a name="84" id="anc84"></a><span class="line-modified">474      * @param headingTag the tag for the heading</span>
<span class="line-modified">475      * @param body       the content</span>
<span class="line-modified">476      * @return the element</span>
477      */
<a name="85" id="anc85"></a><span class="line-modified">478     public static HtmlTree HEADING_TITLE(TagName headingTag, Content body) {</span>
<span class="line-modified">479         return new HtmlTree(checkHeading(headingTag))</span>
<span class="line-added">480                 .setTitle(body)</span>
<span class="line-added">481                 .add(body);</span>
482     }
483 
<a name="86" id="anc86"></a><span class="line-modified">484     private static TagName checkHeading(TagName headingTag) {</span>
<span class="line-modified">485         switch (headingTag) {</span>
<span class="line-modified">486             case H1: case H2: case H3: case H4: case H5: case H6:</span>
<span class="line-modified">487                 return headingTag;</span>
<span class="line-modified">488             default:</span>
<span class="line-modified">489                 throw new IllegalArgumentException(headingTag.toString());</span>
<span class="line-modified">490         }</span>






491     }
492 
493     /**
<a name="87" id="anc87"></a><span class="line-modified">494      * Craetes an HTML {@code HTML} element with the given {@code lang} attribute,</span>
<span class="line-added">495      * and {@code HEAD} and {@code BODY} contents.</span>
496      *
<a name="88" id="anc88"></a><span class="line-modified">497      * @param lang the value for the {@code lang} attribute</span>
<span class="line-modified">498      * @param head the {@code HEAD} element</span>
<span class="line-modified">499      * @param body the {@code BODY} element</span>
<span class="line-modified">500      * @return the {@code HTML} element</span>
501      */
<a name="89" id="anc89"></a><span class="line-modified">502     public static HtmlTree HTML(String lang, Content head, Content body) {</span>
<span class="line-modified">503         return new HtmlTree(TagName.HTML)</span>
<span class="line-modified">504                 .put(HtmlAttr.LANG, lang)</span>
<span class="line-modified">505                 .add(head)</span>
<span class="line-modified">506                 .add(body);</span>

507     }
508 
509     /**
<a name="90" id="anc90"></a><span class="line-modified">510      * Creates an HTML {@code INPUT} element with the given id and initial value.</span>
<span class="line-added">511      * The element as marked as initially disabled.</span>
512      *
<a name="91" id="anc91"></a><span class="line-modified">513      * @param type  the type of input</span>
<span class="line-modified">514      * @param id    the id</span>
<span class="line-modified">515      * @param value the initial value</span>
<span class="line-modified">516      * @return the element</span>
517      */
518     public static HtmlTree INPUT(String type, String id, String value) {
<a name="92" id="anc92"></a><span class="line-modified">519         return new HtmlTree(TagName.INPUT)</span>
<span class="line-modified">520                 .put(HtmlAttr.TYPE, type)</span>
<span class="line-modified">521                 .put(HtmlAttr.ID, id)</span>
<span class="line-modified">522                 .put(HtmlAttr.VALUE, value)</span>
<span class="line-modified">523                 .put(HtmlAttr.DISABLED, &quot;disabled&quot;);</span>

524     }
525 
526     /**
<a name="93" id="anc93"></a><span class="line-modified">527      * Creates an HTML {@code LABEL} element with the given content.</span>
528      *
<a name="94" id="anc94"></a><span class="line-modified">529      * @param forLabel the value of the {@code for} attribute</span>
<span class="line-modified">530      * @param body     the content</span>
<span class="line-modified">531      * @return the element</span>
532      */
533     public static HtmlTree LABEL(String forLabel, Content body) {
<a name="95" id="anc95"></a><span class="line-modified">534         return new HtmlTree(TagName.LABEL)</span>
<span class="line-modified">535                 .put(HtmlAttr.FOR, forLabel)</span>
<span class="line-modified">536                 .add(body);</span>
537     }
538 
539     /**
<a name="96" id="anc96"></a><span class="line-modified">540      * Creates an HTML {@code LI} element with the given content.</span>
541      *
<a name="97" id="anc97"></a><span class="line-modified">542      * @param body the content</span>
<span class="line-modified">543      * @return the element</span>
544      */
545     public static HtmlTree LI(Content body) {
<a name="98" id="anc98"></a><span class="line-modified">546         return new HtmlTree(TagName.LI)</span>
<span class="line-added">547                 .add(body);</span>
548     }
549 
550     /**
<a name="99" id="anc99"></a><span class="line-modified">551      * Creates an HTML {@code LI} element with the given style and the given content.</span>
552      *
<a name="100" id="anc100"></a><span class="line-modified">553      * @param style the style</span>
<span class="line-modified">554      * @param body  the content</span>
<span class="line-modified">555      * @return the element</span>
556      */
<a name="101" id="anc101"></a><span class="line-modified">557     public static HtmlTree LI(HtmlStyle style, Content body) {</span>
<span class="line-modified">558         return LI(body)</span>
<span class="line-modified">559                 .setStyle(style);</span>


560     }
561 
562     /**
<a name="102" id="anc102"></a><span class="line-modified">563      * Creates an HTML {@code LINK} tag with the given attributes.</span>
564      *
<a name="103" id="anc103"></a><span class="line-modified">565      * @param rel   the relevance of the link: the {@code rel} attribute</span>
<span class="line-modified">566      * @param type  the type of link: the {@code type} attribute</span>
<span class="line-modified">567      * @param href  the path for the link: the {@code href} attribute</span>
<span class="line-modified">568      * @param title title for the link: the {@code title} attribute</span>
<span class="line-modified">569      * @return the element</span>
570      */
571     public static HtmlTree LINK(String rel, String type, String href, String title) {
<a name="104" id="anc104"></a><span class="line-modified">572         return new HtmlTree(TagName.LINK)</span>
<span class="line-modified">573                 .put(HtmlAttr.REL, rel)</span>
<span class="line-modified">574                 .put(HtmlAttr.TYPE, type)</span>
<span class="line-modified">575                 .put(HtmlAttr.HREF, href)</span>
<span class="line-modified">576                 .put(HtmlAttr.TITLE, title);</span>

577     }
578 
579     /**
<a name="105" id="anc105"></a><span class="line-modified">580      * Creates an HTML {@code MAIN} element.</span>
<span class="line-added">581      * The role is set to {@code main}.</span>
582      *
<a name="106" id="anc106"></a><span class="line-modified">583      * @return the element</span>
584      */
585     public static HtmlTree MAIN() {
<a name="107" id="anc107"></a><span class="line-modified">586         return new HtmlTree(TagName.MAIN)</span>
<span class="line-modified">587                 .setRole(Role.MAIN);</span>

588     }
589 
590     /**
<a name="108" id="anc108"></a><span class="line-modified">591      * Creates an HTML {@code MAIN} element with the given content.</span>
<span class="line-added">592      * The role is set to {@code main}.</span>
593      *
<a name="109" id="anc109"></a><span class="line-modified">594      * @return the element</span>

595      */
596     public static HtmlTree MAIN(Content body) {
<a name="110" id="anc110"></a><span class="line-modified">597         return new HtmlTree(TagName.MAIN)</span>
<span class="line-modified">598                 .setRole(Role.MAIN)</span>
<span class="line-modified">599                 .add(body);</span>
600     }
601 
602     /**
<a name="111" id="anc111"></a><span class="line-modified">603      * Creates an HTML {@code META} element with {@code http-equiv} and {@code content} attributes.</span>
604      *
<a name="112" id="anc112"></a><span class="line-modified">605      * @param httpEquiv the value for the {@code http-equiv} attribute</span>
<span class="line-modified">606      * @param content   the type of content, to be used in the {@code content} attribute</span>
<span class="line-modified">607      * @param charset   the character set for the document, to be used in the {@code content} attribute</span>
<span class="line-modified">608      * @return the element</span>
609      */
<a name="113" id="anc113"></a><span class="line-modified">610     public static HtmlTree META(String httpEquiv, String content, String charset) {</span>
<span class="line-modified">611         return new HtmlTree(TagName.META)</span>
<span class="line-modified">612                 .put(HtmlAttr.HTTP_EQUIV, httpEquiv)</span>
<span class="line-modified">613                 .put(HtmlAttr.CONTENT, content + &quot;; charset=&quot; + charset);</span>


614     }
615 
616     /**
<a name="114" id="anc114"></a><span class="line-modified">617      * Creates an HTML {@code META} element with {@code name} and {@code content} attributes.</span>
618      *
<a name="115" id="anc115"></a><span class="line-modified">619      * @param name    the value for the {@code name} attribute</span>
<span class="line-modified">620      * @param content the value for the {@code content} attribute</span>
<span class="line-modified">621      * @return the element</span>
622      */
623     public static HtmlTree META(String name, String content) {
<a name="116" id="anc116"></a><span class="line-modified">624         return new HtmlTree(TagName.META)</span>
<span class="line-modified">625                 .put(HtmlAttr.NAME, name)</span>
<span class="line-modified">626                 .put(HtmlAttr.CONTENT, content);</span>

627     }
628 
629     /**
<a name="117" id="anc117"></a><span class="line-modified">630      * Creates an HTML {@code NAV} element.</span>
<span class="line-added">631      * The role is set to {@code navigation}.</span>
632      *
<a name="118" id="anc118"></a><span class="line-modified">633      * @return the element</span>
634      */
635     public static HtmlTree NAV() {
<a name="119" id="anc119"></a><span class="line-modified">636         return new HtmlTree(TagName.NAV)</span>
<span class="line-modified">637                 .setRole(Role.NAVIGATION);</span>

638     }
639 
640     /**
<a name="120" id="anc120"></a><span class="line-modified">641      * Creates an HTML {@code NOSCRIPT} element with some content.</span>
642      *
<a name="121" id="anc121"></a><span class="line-modified">643      * @param body the content</span>
<span class="line-modified">644      * @return the element</span>
645      */
646     public static HtmlTree NOSCRIPT(Content body) {
<a name="122" id="anc122"></a><span class="line-modified">647         return new HtmlTree(TagName.NOSCRIPT)</span>
<span class="line-modified">648                 .add(body);</span>
649     }
650 
651     /**
<a name="123" id="anc123"></a><span class="line-modified">652      * Creates an HTML {@code P} element with some content.</span>
653      *
<a name="124" id="anc124"></a><span class="line-modified">654      * @param body the content</span>
<span class="line-modified">655      * @return the element</span>
656      */
657     public static HtmlTree P(Content body) {
<a name="125" id="anc125"></a><span class="line-modified">658         return new HtmlTree(TagName.P)</span>
<span class="line-added">659                 .add(body);</span>
660     }
661 
662     /**
<a name="126" id="anc126"></a><span class="line-modified">663      * Creates an HTML {@code P} element with the given style and some content.</span>
664      *
<a name="127" id="anc127"></a><span class="line-modified">665      * @param style the style</span>
<span class="line-modified">666      * @param body  the content</span>
<span class="line-modified">667      * @return the element</span>
668      */
<a name="128" id="anc128"></a><span class="line-modified">669     public static HtmlTree P(HtmlStyle style, Content body) {</span>
<span class="line-modified">670         return P(body)</span>
<span class="line-modified">671                 .setStyle(style);</span>


672     }
673 
674     /**
<a name="129" id="anc129"></a><span class="line-modified">675      * Creates an HTML {@code SCRIPT} element with some script content.</span>
<span class="line-added">676      * The type of the script is set to {@code text/javascript}.</span>
677      *
<a name="130" id="anc130"></a><span class="line-modified">678      * @param src the content</span>
<span class="line-modified">679      * @return the element</span>
680      */
681     public static HtmlTree SCRIPT(String src) {
<a name="131" id="anc131"></a><span class="line-modified">682         return new HtmlTree(TagName.SCRIPT)</span>
<span class="line-modified">683                 .put(HtmlAttr.TYPE, &quot;text/javascript&quot;)</span>
<span class="line-modified">684                 .put(HtmlAttr.SRC, src);</span>
<span class="line-modified">685 </span>
686     }
687 
688     /**
<a name="132" id="anc132"></a><span class="line-modified">689      * Creates an HTML {@code SECTION} element with the given style.</span>
690      *
<a name="133" id="anc133"></a><span class="line-modified">691      * @param style the style</span>
<span class="line-modified">692      * @return the element</span>
693      */
<a name="134" id="anc134"></a><span class="line-modified">694     public static HtmlTree SECTION(HtmlStyle style) {</span>
<span class="line-modified">695         return new HtmlTree(TagName.SECTION)</span>
<span class="line-modified">696                 .setStyle(style);</span>

697     }
698 
699     /**
<a name="135" id="anc135"></a><span class="line-modified">700      * Creates an HTML {@code SECTION} element with the given style and some content.</span>
701      *
<a name="136" id="anc136"></a><span class="line-modified">702      * @param style the style</span>
<span class="line-modified">703      * @param body  the content</span>
<span class="line-modified">704      * @return the element</span>
705      */
<a name="137" id="anc137"></a><span class="line-modified">706     public static HtmlTree SECTION(HtmlStyle style, Content body) {</span>
<span class="line-modified">707         return new HtmlTree(TagName.SECTION)</span>
<span class="line-modified">708                 .setStyle(style)</span>
<span class="line-modified">709                 .add(body);</span>


710     }
711 
712     /**
<a name="138" id="anc138"></a><span class="line-modified">713      * Creates an HTML {@code SMALL} element with some content.</span>
714      *
<a name="139" id="anc139"></a><span class="line-modified">715      * @param body  the content</span>
<span class="line-modified">716      * @return the element</span>
717      */
718     public static HtmlTree SMALL(Content body) {
<a name="140" id="anc140"></a><span class="line-modified">719         return new HtmlTree(TagName.SMALL)</span>
<span class="line-modified">720                 .add(body);</span>
721     }
722 
723     /**
<a name="141" id="anc141"></a><span class="line-modified">724      * Creates an HTML {@code SPAN} element with some content.</span>
725      *
<a name="142" id="anc142"></a><span class="line-modified">726      * @param body  the content</span>
<span class="line-modified">727      * @return the element</span>
728      */
729     public static HtmlTree SPAN(Content body) {
<a name="143" id="anc143"></a><span class="line-modified">730         return new HtmlTree(TagName.SPAN)</span>
<span class="line-added">731                 .add(body);</span>
732     }
733 
734     /**
<a name="144" id="anc144"></a><span class="line-modified">735      * Creates an HTML {@code SPAN} element with the given style and some content.</span>
736      *
<a name="145" id="anc145"></a><span class="line-modified">737      * @param styleClass the style</span>
<span class="line-modified">738      * @param body       the content</span>
<span class="line-modified">739      * @return the element</span>
740      */
741     public static HtmlTree SPAN(HtmlStyle styleClass, Content body) {
<a name="146" id="anc146"></a><span class="line-modified">742         return SPAN(body)</span>
<span class="line-modified">743                 .setStyle(styleClass);</span>


744     }
745 
746     /**
<a name="147" id="anc147"></a><span class="line-modified">747      * Creates an HTML {@code SPAN} element with the given id and some content.</span>
748      *
<a name="148" id="anc148"></a><span class="line-modified">749      * @param id    the id</span>
<span class="line-modified">750      * @param body  the content</span>
<span class="line-modified">751      * @return the element</span>
752      */
753     public static HtmlTree SPAN_ID(String id, Content body) {
<a name="149" id="anc149"></a><span class="line-modified">754         return new HtmlTree(TagName.SPAN)</span>
<span class="line-modified">755                 .setId(id)</span>
<span class="line-modified">756                 .add(body);</span>
















































757     }
758 
759     /**
<a name="150" id="anc150"></a><span class="line-modified">760      * Creates an HTML {@code SPAN} element with the given id and style, and some content.</span>
761      *
<a name="151" id="anc151"></a><span class="line-modified">762      * @param id    the id</span>
<span class="line-modified">763      * @param style the style</span>
<span class="line-modified">764      * @param body  the content</span>
<span class="line-added">765      * @return the element</span>
766      */
<a name="152" id="anc152"></a><span class="line-modified">767     public static HtmlTree SPAN(String id, HtmlStyle style, Content body) {</span>
<span class="line-modified">768         return new HtmlTree(TagName.SPAN)</span>
<span class="line-modified">769                 .setId(id)</span>
<span class="line-modified">770                 .setStyle(style)</span>
<span class="line-modified">771                 .add(body);</span>
772     }
773 
774     /**
<a name="153" id="anc153"></a><span class="line-modified">775      * Creates an HTML {@code TD} element with the given style and some content.</span>
776      *
<a name="154" id="anc154"></a><span class="line-modified">777      * @param style the style</span>
<span class="line-modified">778      * @param body  the content</span>
<span class="line-added">779      * @return the element</span>
780      */
<a name="155" id="anc155"></a><span class="line-modified">781     public static HtmlTree TD(HtmlStyle style, Content body) {</span>
<span class="line-modified">782         return new HtmlTree(TagName.TD)</span>
<span class="line-added">783                 .setStyle(style)</span>
<span class="line-added">784                 .add(body);</span>
785     }
786 
787     /**
<a name="156" id="anc156"></a><span class="line-modified">788      * Creates an HTML {@code TH} element with the given style and scope, and some content.</span>
789      *
<a name="157" id="anc157"></a><span class="line-modified">790      * @param style the style</span>
<span class="line-modified">791      * @param scope the value for the {@code scope} attribute</span>
<span class="line-modified">792      * @param body  the content</span>
<span class="line-modified">793      * @return the element</span>
794      */
<a name="158" id="anc158"></a><span class="line-modified">795     public static HtmlTree TH(HtmlStyle style, String scope, Content body) {</span>
<span class="line-modified">796         return new HtmlTree(TagName.TH)</span>
<span class="line-modified">797                 .setStyle(style)</span>
<span class="line-modified">798                 .put(HtmlAttr.SCOPE, scope)</span>
<span class="line-modified">799                 .add(body);</span>

800     }
801 
802     /**
<a name="159" id="anc159"></a><span class="line-modified">803      * Creates an HTML {@code TH} element with the given scope, and some content.</span>
804      *
<a name="160" id="anc160"></a><span class="line-modified">805      * @param scope the value for the {@code scope} attribute</span>
<span class="line-modified">806      * @param body  the content</span>
<span class="line-modified">807      * @return the element</span>
808      */
809     public static HtmlTree TH(String scope, Content body) {
<a name="161" id="anc161"></a><span class="line-modified">810         return new HtmlTree(TagName.TH)</span>
<span class="line-modified">811                 .put(HtmlAttr.SCOPE, scope)</span>
<span class="line-modified">812                 .add(body);</span>









813     }
814 
815     /**
<a name="162" id="anc162"></a><span class="line-modified">816      * Creates an HTML {@code TITLE} element with some content.</span>
817      *
<a name="163" id="anc163"></a><span class="line-modified">818      * @param body the content</span>
<span class="line-modified">819      * @return the element</span>
820      */
821     public static HtmlTree TITLE(String body) {
<a name="164" id="anc164"></a><span class="line-modified">822         return new HtmlTree(TagName.TITLE)</span>
<span class="line-modified">823             .add(body);</span>











824     }
825 
826     /**
<a name="165" id="anc165"></a><span class="line-modified">827      * Creates an HTML {@code UL} element with the given style and some content.</span>
828      *
<a name="166" id="anc166"></a><span class="line-modified">829      * @param style the style</span>
<span class="line-modified">830      * @param first the initial content</span>
<span class="line-modified">831      * @param more  additional content</span>
<span class="line-modified">832      * @return the element</span>
<span class="line-modified">833      */</span>
<span class="line-modified">834     public static HtmlTree UL(HtmlStyle style, Content first, Content... more) {</span>
<span class="line-modified">835         HtmlTree htmlTree = new HtmlTree(TagName.UL)</span>
<span class="line-modified">836                 .setStyle(style);</span>
<span class="line-added">837         htmlTree.add(first);</span>
838         for (Content c : more) {
<a name="167" id="anc167"></a><span class="line-modified">839             htmlTree.add(c);</span>
840         }
<a name="168" id="anc168"></a>
841         return htmlTree;
842     }
843 
844     @Override
845     public boolean isEmpty() {
846         return (!hasContent() &amp;&amp; !hasAttrs());
847     }
848 
849     /**
850      * Returns true if the HTML tree has content.
851      *
852      * @return true if the HTML tree has content else return false
853      */
854     public boolean hasContent() {
855         return (!content.isEmpty());
856     }
857 
858     /**
859      * Returns true if the HTML tree has attributes.
860      *
861      * @return true if the HTML tree has attributes else return false
862      */
863     public boolean hasAttrs() {
864         return (!attrs.isEmpty());
865     }
866 
867     /**
868      * Returns true if the HTML tree has a specific attribute.
869      *
870      * @param attrName name of the attribute to check within the HTML tree
871      * @return true if the HTML tree has the specified attribute else return false
872      */
873     public boolean hasAttr(HtmlAttr attrName) {
874         return (attrs.containsKey(attrName));
875     }
876 
877     /**
878      * Returns true if the HTML tree is valid. This check is more specific to
879      * standard doclet and not exactly similar to W3C specifications. But it
880      * ensures HTML validation.
881      *
882      * @return true if the HTML tree is valid
883      */
884     @Override
885     public boolean isValid() {
<a name="169" id="anc169"></a><span class="line-modified">886         switch (tagName) {</span>
<span class="line-modified">887             case A:</span>
<span class="line-modified">888                 return (hasAttr(HtmlAttr.ID) || (hasAttr(HtmlAttr.HREF) &amp;&amp; hasContent()));</span>
<span class="line-modified">889             case BR:</span>
890                 return (!hasContent() &amp;&amp; (!hasAttrs() || hasAttr(HtmlAttr.CLEAR)));
<a name="170" id="anc170"></a><span class="line-modified">891             case HR:</span>


892             case INPUT:
893                 return (!hasContent());
<a name="171" id="anc171"></a><span class="line-modified">894             case IMG:</span>
895                 return (hasAttr(HtmlAttr.SRC) &amp;&amp; hasAttr(HtmlAttr.ALT) &amp;&amp; !hasContent());
<a name="172" id="anc172"></a><span class="line-modified">896             case LINK:</span>
897                 return (hasAttr(HtmlAttr.HREF) &amp;&amp; !hasContent());
<a name="173" id="anc173"></a><span class="line-modified">898             case META:</span>
899                 return (hasAttr(HtmlAttr.CONTENT) &amp;&amp; !hasContent());
<a name="174" id="anc174"></a><span class="line-modified">900             case SCRIPT:</span>
901                 return ((hasAttr(HtmlAttr.TYPE) &amp;&amp; hasAttr(HtmlAttr.SRC) &amp;&amp; !hasContent()) ||
902                         (hasAttr(HtmlAttr.TYPE) &amp;&amp; hasContent()));
<a name="175" id="anc175"></a><span class="line-modified">903             case SPAN:</span>
904                 return (hasAttr(HtmlAttr.ID) || hasContent());
905             default :
906                 return hasContent();
907         }
908     }
909 
910     /**
<a name="176" id="anc176"></a><span class="line-modified">911      * Returns true if the element is a normal element that is &lt;em&gt;phrasing content&lt;/em&gt;.</span>
912      *
913      * @return true if the HTML tag is an inline element
<a name="177" id="anc177"></a><span class="line-added">914      *</span>
<span class="line-added">915      * @see &lt;a href=&quot;https://www.w3.org/TR/html51/dom.html#kinds-of-content-phrasing-content&quot;&gt;Phrasing Content&lt;/a&gt;</span>
916      */
917     public boolean isInline() {
<a name="178" id="anc178"></a><span class="line-modified">918         switch (tagName) {</span>
<span class="line-added">919             case A: case BUTTON: case BR: case CODE: case EM: case I: case IMG:</span>
<span class="line-added">920             case LABEL: case SMALL: case SPAN: case STRONG: case SUB:</span>
<span class="line-added">921                 return true;</span>
<span class="line-added">922             default:</span>
<span class="line-added">923                 return false;</span>
<span class="line-added">924         }</span>
<span class="line-added">925     }</span>
<span class="line-added">926 </span>
<span class="line-added">927     /**</span>
<span class="line-added">928      * Returns whether or not this is a &lt;em&gt;void&lt;/em&gt; element.</span>
<span class="line-added">929      *</span>
<span class="line-added">930      * @return whether or not this is a void element</span>
<span class="line-added">931      *</span>
<span class="line-added">932      * @see &lt;a href=&quot;https://www.w3.org/TR/html51/syntax.html#void-elements&quot;&gt;Void Elements&lt;/a&gt;</span>
<span class="line-added">933      */</span>
<span class="line-added">934     public boolean isVoid() {</span>
<span class="line-added">935         switch (tagName) {</span>
<span class="line-added">936             case BR: case HR: case IMG: case INPUT: case LINK: case META:</span>
<span class="line-added">937                 return true;</span>
<span class="line-added">938             default:</span>
<span class="line-added">939                 return false;</span>
<span class="line-added">940         }</span>
941     }
942 
943     @Override
944     public boolean write(Writer out, boolean atNewline) throws IOException {
<a name="179" id="anc179"></a><span class="line-modified">945         boolean isInline = isInline();</span>
<span class="line-added">946         if (!isInline &amp;&amp; !atNewline)</span>
947             out.write(DocletConstants.NL);
<a name="180" id="anc180"></a><span class="line-modified">948         String tagString = tagName.toString();</span>
949         out.write(&quot;&lt;&quot;);
950         out.write(tagString);
951         Iterator&lt;HtmlAttr&gt; iterator = attrs.keySet().iterator();
952         HtmlAttr key;
953         String value;
954         while (iterator.hasNext()) {
955             key = iterator.next();
956             value = attrs.get(key);
957             out.write(&quot; &quot;);
958             out.write(key.toString());
959             if (!value.isEmpty()) {
960                 out.write(&quot;=\&quot;&quot;);
961                 out.write(value);
962                 out.write(&quot;\&quot;&quot;);
963             }
964         }
965         out.write(&quot;&gt;&quot;);
966         boolean nl = false;
967         for (Content c : content)
968             nl = c.write(out, nl);
<a name="181" id="anc181"></a><span class="line-modified">969         if (!isVoid()) {</span>
970             out.write(&quot;&lt;/&quot;);
971             out.write(tagString);
972             out.write(&quot;&gt;&quot;);
973         }
<a name="182" id="anc182"></a><span class="line-modified">974         if (!isInline) {</span>
975             out.write(DocletConstants.NL);
976             return true;
977         } else {
978             return false;
979         }
980     }
981 
982     /**
983      * Given a Content node, strips all html characters and
984      * return the result.
985      *
986      * @param body The content node to check.
987      * @return the plain text from the content node
988      *
989      */
990     private static String stripHtml(Content body) {
991         String rawString = body.toString();
992         // remove HTML tags
<a name="183" id="anc183"></a><span class="line-modified">993         rawString = rawString.replaceAll(&quot;&lt;.*?&gt;&quot;, &quot; &quot;);</span>
994         // consolidate multiple spaces between a word to a single space
995         rawString = rawString.replaceAll(&quot;\\b\\s{2,}\\b&quot;, &quot; &quot;);
996         // remove extra whitespaces
997         return rawString.trim();
998     }
999 }
<a name="184" id="anc184"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="184" type="hidden" />
</body>
</html>