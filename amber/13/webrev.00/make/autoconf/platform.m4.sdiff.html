<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/autoconf/platform.m4</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="lib-ffi.m4.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="spec.gmk.in.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/autoconf/platform.m4</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 #
<span class="line-modified">  2 # Copyright (c) 2011, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
103       VAR_CPU_ENDIAN=little
104       ;;
105     powerpc)
106       VAR_CPU=ppc
107       VAR_CPU_ARCH=ppc
108       VAR_CPU_BITS=32
109       VAR_CPU_ENDIAN=big
110       ;;
111     powerpc64)
112       VAR_CPU=ppc64
113       VAR_CPU_ARCH=ppc
114       VAR_CPU_BITS=64
115       VAR_CPU_ENDIAN=big
116       ;;
117     powerpc64le)
118       VAR_CPU=ppc64le
119       VAR_CPU_ARCH=ppc
120       VAR_CPU_BITS=64
121       VAR_CPU_ENDIAN=little
122       ;;






123     s390)
124       VAR_CPU=s390
125       VAR_CPU_ARCH=s390
126       VAR_CPU_BITS=32
127       VAR_CPU_ENDIAN=big
128       ;;
129     s390x)
130       VAR_CPU=s390x
131       VAR_CPU_ARCH=s390
132       VAR_CPU_BITS=64
133       VAR_CPU_ENDIAN=big
134       ;;
135     sh*eb)
136       VAR_CPU=sh
137       VAR_CPU_ARCH=sh
138       VAR_CPU_BITS=32
139       VAR_CPU_ENDIAN=big
140       ;;
141     sh*)
142       VAR_CPU=sh
</pre>
<hr />
<pre>
468   elif test &quot;x$OPENJDK_$1_CPU&quot; = xx32; then
469     HOTSPOT_$1_CPU_DEFINE=X32
470   elif test &quot;x$OPENJDK_$1_CPU&quot; = xsparcv9; then
471     HOTSPOT_$1_CPU_DEFINE=SPARC
472   elif test &quot;x$OPENJDK_$1_CPU&quot; = xaarch64; then
473     HOTSPOT_$1_CPU_DEFINE=AARCH64
474   elif test &quot;x$OPENJDK_$1_CPU&quot; = xppc64; then
475     HOTSPOT_$1_CPU_DEFINE=PPC64
476   elif test &quot;x$OPENJDK_$1_CPU&quot; = xppc64le; then
477     HOTSPOT_$1_CPU_DEFINE=PPC64
478 
479   # The cpu defines below are for zero, we don&#39;t support them directly.
480   elif test &quot;x$OPENJDK_$1_CPU&quot; = xsparc; then
481     HOTSPOT_$1_CPU_DEFINE=SPARC
482   elif test &quot;x$OPENJDK_$1_CPU&quot; = xppc; then
483     HOTSPOT_$1_CPU_DEFINE=PPC32
484   elif test &quot;x$OPENJDK_$1_CPU&quot; = xs390; then
485     HOTSPOT_$1_CPU_DEFINE=S390
486   elif test &quot;x$OPENJDK_$1_CPU&quot; = xs390x; then
487     HOTSPOT_$1_CPU_DEFINE=S390


488   elif test &quot;x$OPENJDK_$1_CPU&quot; != x; then
489     HOTSPOT_$1_CPU_DEFINE=$(echo $OPENJDK_$1_CPU | tr a-z A-Z)
490   fi
491   AC_SUBST(HOTSPOT_$1_CPU_DEFINE)
492 
493   # For historical reasons, the OS include directories have odd names.
494   OPENJDK_$1_OS_INCLUDE_SUBDIR=&quot;$OPENJDK_TARGET_OS&quot;
495   if test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xwindows&quot;; then
496     OPENJDK_$1_OS_INCLUDE_SUBDIR=&quot;win32&quot;
497   elif test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xmacosx&quot;; then
498     OPENJDK_$1_OS_INCLUDE_SUBDIR=&quot;darwin&quot;
499   fi
500   AC_SUBST(OPENJDK_$1_OS_INCLUDE_SUBDIR)
501 ])
502 
503 AC_DEFUN([PLATFORM_SET_RELEASE_FILE_OS_VALUES],
504 [
505   if test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xsolaris&quot;; then
506     RELEASE_FILE_OS_NAME=SunOS
507   fi
</pre>
<hr />
<pre>
546 [
547   # Figure out the build and target systems. # Note that in autoconf terminology, &quot;build&quot; is obvious, but &quot;target&quot;
548   # is confusing; it assumes you are cross-compiling a cross-compiler (!)  and &quot;target&quot; is thus the target of the
549   # product you&#39;re building. The target of this build is called &quot;host&quot;. Since this is confusing to most people, we
550   # have not adopted that system, but use &quot;target&quot; as the platform we are building for. In some places though we need
551   # to use the configure naming style.
552   AC_CANONICAL_BUILD
553   AC_CANONICAL_HOST
554   AC_CANONICAL_TARGET
555 
556   PLATFORM_EXTRACT_TARGET_AND_BUILD
557   PLATFORM_SETUP_TARGET_CPU_BITS
558   PLATFORM_SET_MODULE_TARGET_OS_VALUES
559   PLATFORM_SET_RELEASE_FILE_OS_VALUES
560   PLATFORM_SETUP_LEGACY_VARS
561   PLATFORM_CHECK_DEPRECATION
562 ])
563 
564 AC_DEFUN([PLATFORM_CHECK_DEPRECATION],
565 [
<span class="line-modified">566   AC_ARG_ENABLE(deprecated-ports, [AS_HELP_STRING([--enable-deprecated-ports@&lt;:@=yes/no@:&gt;@],</span>
<span class="line-modified">567        [Suppress the error when configuring for a deprecated port @&lt;:@no@:&gt;@])])</span>
<span class="line-modified">568 </span>
<span class="line-modified">569   if test &quot;x$OPENJDK_TARGET_OS&quot; = xsolaris || (test &quot;x$OPENJDK_TARGET_CPU_ARCH&quot; = xsparc &amp;&amp; test &quot;x$with_jvm_variants&quot; != xzero); then</span>
<span class="line-modified">570     if test &quot;x$enable_deprecated_ports&quot; = &quot;xyes&quot;; then</span>



571       AC_MSG_WARN([The Solaris and SPARC ports are deprecated and may be removed in a future release.])
572     else
573       AC_MSG_ERROR(m4_normalize([The Solaris and SPARC ports are deprecated and may be removed in a
574         future release. Use --enable-deprecated-ports=yes to suppress this error.]))
575     fi
576   fi
577 ])
578 
579 AC_DEFUN_ONCE([PLATFORM_SETUP_OPENJDK_BUILD_OS_VERSION],
580 [
581   ###############################################################################
582 
583   # Note that this is the build platform OS version!
584 
585   OS_VERSION=&quot;`uname -r | ${SED} &#39;s!\.! !g&#39; | ${SED} &#39;s!-! !g&#39;`&quot;
586   OS_VERSION_MAJOR=&quot;`${ECHO} ${OS_VERSION} | ${CUT} -f 1 -d &#39; &#39;`&quot;
587   OS_VERSION_MINOR=&quot;`${ECHO} ${OS_VERSION} | ${CUT} -f 2 -d &#39; &#39;`&quot;
588   OS_VERSION_MICRO=&quot;`${ECHO} ${OS_VERSION} | ${CUT} -f 3 -d &#39; &#39;`&quot;
589   AC_SUBST(OS_VERSION_MAJOR)
590   AC_SUBST(OS_VERSION_MINOR)
</pre>
</td>
<td>
<hr />
<pre>
  1 #
<span class="line-modified">  2 # Copyright (c) 2011, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
103       VAR_CPU_ENDIAN=little
104       ;;
105     powerpc)
106       VAR_CPU=ppc
107       VAR_CPU_ARCH=ppc
108       VAR_CPU_BITS=32
109       VAR_CPU_ENDIAN=big
110       ;;
111     powerpc64)
112       VAR_CPU=ppc64
113       VAR_CPU_ARCH=ppc
114       VAR_CPU_BITS=64
115       VAR_CPU_ENDIAN=big
116       ;;
117     powerpc64le)
118       VAR_CPU=ppc64le
119       VAR_CPU_ARCH=ppc
120       VAR_CPU_BITS=64
121       VAR_CPU_ENDIAN=little
122       ;;
<span class="line-added">123     riscv64)</span>
<span class="line-added">124       VAR_CPU=riscv64</span>
<span class="line-added">125       VAR_CPU_ARCH=riscv</span>
<span class="line-added">126       VAR_CPU_BITS=64</span>
<span class="line-added">127       VAR_CPU_ENDIAN=little</span>
<span class="line-added">128       ;;</span>
129     s390)
130       VAR_CPU=s390
131       VAR_CPU_ARCH=s390
132       VAR_CPU_BITS=32
133       VAR_CPU_ENDIAN=big
134       ;;
135     s390x)
136       VAR_CPU=s390x
137       VAR_CPU_ARCH=s390
138       VAR_CPU_BITS=64
139       VAR_CPU_ENDIAN=big
140       ;;
141     sh*eb)
142       VAR_CPU=sh
143       VAR_CPU_ARCH=sh
144       VAR_CPU_BITS=32
145       VAR_CPU_ENDIAN=big
146       ;;
147     sh*)
148       VAR_CPU=sh
</pre>
<hr />
<pre>
474   elif test &quot;x$OPENJDK_$1_CPU&quot; = xx32; then
475     HOTSPOT_$1_CPU_DEFINE=X32
476   elif test &quot;x$OPENJDK_$1_CPU&quot; = xsparcv9; then
477     HOTSPOT_$1_CPU_DEFINE=SPARC
478   elif test &quot;x$OPENJDK_$1_CPU&quot; = xaarch64; then
479     HOTSPOT_$1_CPU_DEFINE=AARCH64
480   elif test &quot;x$OPENJDK_$1_CPU&quot; = xppc64; then
481     HOTSPOT_$1_CPU_DEFINE=PPC64
482   elif test &quot;x$OPENJDK_$1_CPU&quot; = xppc64le; then
483     HOTSPOT_$1_CPU_DEFINE=PPC64
484 
485   # The cpu defines below are for zero, we don&#39;t support them directly.
486   elif test &quot;x$OPENJDK_$1_CPU&quot; = xsparc; then
487     HOTSPOT_$1_CPU_DEFINE=SPARC
488   elif test &quot;x$OPENJDK_$1_CPU&quot; = xppc; then
489     HOTSPOT_$1_CPU_DEFINE=PPC32
490   elif test &quot;x$OPENJDK_$1_CPU&quot; = xs390; then
491     HOTSPOT_$1_CPU_DEFINE=S390
492   elif test &quot;x$OPENJDK_$1_CPU&quot; = xs390x; then
493     HOTSPOT_$1_CPU_DEFINE=S390
<span class="line-added">494   elif test &quot;x$OPENJDK_$1_CPU&quot; = xriscv64; then</span>
<span class="line-added">495     HOTSPOT_$1_CPU_DEFINE=RISCV</span>
496   elif test &quot;x$OPENJDK_$1_CPU&quot; != x; then
497     HOTSPOT_$1_CPU_DEFINE=$(echo $OPENJDK_$1_CPU | tr a-z A-Z)
498   fi
499   AC_SUBST(HOTSPOT_$1_CPU_DEFINE)
500 
501   # For historical reasons, the OS include directories have odd names.
502   OPENJDK_$1_OS_INCLUDE_SUBDIR=&quot;$OPENJDK_TARGET_OS&quot;
503   if test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xwindows&quot;; then
504     OPENJDK_$1_OS_INCLUDE_SUBDIR=&quot;win32&quot;
505   elif test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xmacosx&quot;; then
506     OPENJDK_$1_OS_INCLUDE_SUBDIR=&quot;darwin&quot;
507   fi
508   AC_SUBST(OPENJDK_$1_OS_INCLUDE_SUBDIR)
509 ])
510 
511 AC_DEFUN([PLATFORM_SET_RELEASE_FILE_OS_VALUES],
512 [
513   if test &quot;x$OPENJDK_TARGET_OS&quot; = &quot;xsolaris&quot;; then
514     RELEASE_FILE_OS_NAME=SunOS
515   fi
</pre>
<hr />
<pre>
554 [
555   # Figure out the build and target systems. # Note that in autoconf terminology, &quot;build&quot; is obvious, but &quot;target&quot;
556   # is confusing; it assumes you are cross-compiling a cross-compiler (!)  and &quot;target&quot; is thus the target of the
557   # product you&#39;re building. The target of this build is called &quot;host&quot;. Since this is confusing to most people, we
558   # have not adopted that system, but use &quot;target&quot; as the platform we are building for. In some places though we need
559   # to use the configure naming style.
560   AC_CANONICAL_BUILD
561   AC_CANONICAL_HOST
562   AC_CANONICAL_TARGET
563 
564   PLATFORM_EXTRACT_TARGET_AND_BUILD
565   PLATFORM_SETUP_TARGET_CPU_BITS
566   PLATFORM_SET_MODULE_TARGET_OS_VALUES
567   PLATFORM_SET_RELEASE_FILE_OS_VALUES
568   PLATFORM_SETUP_LEGACY_VARS
569   PLATFORM_CHECK_DEPRECATION
570 ])
571 
572 AC_DEFUN([PLATFORM_CHECK_DEPRECATION],
573 [
<span class="line-modified">574   UTIL_ARG_ENABLE(NAME: deprecated-ports, DEFAULT: false,</span>
<span class="line-modified">575       RESULT: ENABLE_DEPRECATED_PORTS,</span>
<span class="line-modified">576       DESC: [suppress the error when configuring for a deprecated port])</span>
<span class="line-modified">577 </span>
<span class="line-modified">578   if test &quot;x$OPENJDK_TARGET_OS&quot; = xsolaris || \</span>
<span class="line-added">579       (test &quot;x$OPENJDK_TARGET_CPU_ARCH&quot; = xsparc &amp;&amp; \</span>
<span class="line-added">580       test &quot;x$with_jvm_variants&quot; != xzero); then</span>
<span class="line-added">581     if test &quot;x$ENABLE_DEPRECATED_PORTS&quot; = &quot;xtrue&quot;; then</span>
582       AC_MSG_WARN([The Solaris and SPARC ports are deprecated and may be removed in a future release.])
583     else
584       AC_MSG_ERROR(m4_normalize([The Solaris and SPARC ports are deprecated and may be removed in a
585         future release. Use --enable-deprecated-ports=yes to suppress this error.]))
586     fi
587   fi
588 ])
589 
590 AC_DEFUN_ONCE([PLATFORM_SETUP_OPENJDK_BUILD_OS_VERSION],
591 [
592   ###############################################################################
593 
594   # Note that this is the build platform OS version!
595 
596   OS_VERSION=&quot;`uname -r | ${SED} &#39;s!\.! !g&#39; | ${SED} &#39;s!-! !g&#39;`&quot;
597   OS_VERSION_MAJOR=&quot;`${ECHO} ${OS_VERSION} | ${CUT} -f 1 -d &#39; &#39;`&quot;
598   OS_VERSION_MINOR=&quot;`${ECHO} ${OS_VERSION} | ${CUT} -f 2 -d &#39; &#39;`&quot;
599   OS_VERSION_MICRO=&quot;`${ECHO} ${OS_VERSION} | ${CUT} -f 3 -d &#39; &#39;`&quot;
600   AC_SUBST(OS_VERSION_MAJOR)
601   AC_SUBST(OS_VERSION_MINOR)
</pre>
</td>
</tr>
</table>
<center><a href="lib-ffi.m4.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="spec.gmk.in.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>