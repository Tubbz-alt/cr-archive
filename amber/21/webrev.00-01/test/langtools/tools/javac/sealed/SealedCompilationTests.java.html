<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New test/langtools/tools/javac/sealed/SealedCompilationTests.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 /**
 27  * SealedCompilationTests
 28  *
 29  * @test
 30  * @summary Negative compilation tests, and positive compilation (smoke) tests for sealed classes
 31  * @library /lib/combo /tools/lib
 32  * @modules
 33  *     jdk.compiler/com.sun.tools.javac.util
 34  *     jdk.compiler/com.sun.tools.javac.api
 35  *     jdk.compiler/com.sun.tools.javac.main
 36  * @build toolbox.ToolBox toolbox.JavacTask
 37  * @compile --enable-preview -source ${jdk.version} SealedCompilationTests.java
 38  * @run testng/othervm --enable-preview SealedCompilationTests
 39  */
 40 
 41 import java.lang.constant.ClassDesc;
 42 
 43 import java.io.File;
 44 
 45 import java.io.IOException;
 46 import java.nio.file.Files;
 47 import java.nio.file.Path;
 48 import java.nio.file.Paths;
 49 
 50 import java.util.ArrayList;
 51 import java.util.List;
 52 import java.util.Set;
 53 
 54 import com.sun.tools.javac.util.Assert;
 55 
 56 import static org.testng.Assert.assertEquals;
 57 import static org.testng.Assert.assertTrue;
 58 import static org.testng.Assert.fail;
 59 import org.testng.annotations.Test;
 60 import tools.javac.combo.CompilationTestCase;
 61 
 62 import toolbox.ToolBox;
 63 import toolbox.JavacTask;
 64 import toolbox.Task;
 65 import toolbox.Task.OutputKind;
 66 
 67 @Test
 68 public class SealedCompilationTests extends CompilationTestCase {
 69 
 70     ToolBox tb = new ToolBox();
 71 
 72     // When sealed classes become a permanent feature, we don&#39;t need these any more
 73     private static String[] PREVIEW_OPTIONS = {&quot;--enable-preview&quot;, &quot;-source&quot;,
 74                                                Integer.toString(Runtime.version().feature())};
 75 
 76     {
 77         setDefaultFilename(&quot;SealedTest.java&quot;);
 78         setCompileOptions(PREVIEW_OPTIONS);
 79     }
 80 
 81     private static final String NO_SHELL = &quot;&quot;&quot;
 82                  #
 83                  &quot;&quot;&quot;;
 84     private static final String NEST_SHELL = &quot;&quot;&quot;
 85                  class SealedTest {
 86                      #
 87                  }
 88                  &quot;&quot;&quot;;
 89     private static final String AUX_SHELL = &quot;&quot;&quot;
 90                  class SealedTest {
 91                  }
 92                  #
 93                  &quot;&quot;&quot;;
 94     private static final List&lt;String&gt; SHELLS = List.of(NO_SHELL, NEST_SHELL, AUX_SHELL);
 95 
 96     public void testSimpleExtension() {
 97         String CC1 =
 98             &quot;&quot;&quot;
 99             sealed class Sup # { }
100             # class Sub extends Sup { }
101             &quot;&quot;&quot;;
102 
103         String CC2 =
104                 &quot;&quot;&quot;
105                 sealed class Sup&lt;T&gt; # { }
106                 # class Sub&lt;T&gt; extends Sup&lt;T&gt; { }
107                 &quot;&quot;&quot;;
108         String CC3 =
109                 &quot;&quot;&quot;
110                 sealed class Sup&lt;T&gt; # { }
111                     # class Sub extends Sup&lt;String&gt; { }
112                 &quot;&quot;&quot;;
113         String AC1 =
114             &quot;&quot;&quot;
115             sealed abstract class Sup # { }
116             # class Sub extends Sup { }
117             &quot;&quot;&quot;;
118         String AC2 =
119                 &quot;&quot;&quot;
120                 sealed abstract class Sup&lt;T&gt; # { }
121                     # class Sub&lt;T&gt; extends Sup&lt;T&gt; { }
122                 &quot;&quot;&quot;;
123         String AC3 =
124                 &quot;&quot;&quot;
125                 sealed abstract class Sup&lt;T&gt; # { }
126                     # class Sub extends Sup&lt;String&gt; { }
127                 &quot;&quot;&quot;;
128         String I1 =
129             &quot;&quot;&quot;
130             sealed interface Sup # { }
131             # class Sub implements Sup { }
132             &quot;&quot;&quot;;
133         String I11 =
134                 &quot;&quot;&quot;
135                 sealed interface Sup&lt;T&gt; # { }
136                 # class Sub&lt;T&gt; implements Sup&lt;T&gt; { }
137                 &quot;&quot;&quot;;
138         String I12 =
139                 &quot;&quot;&quot;
140                 sealed interface Sup&lt;T&gt; # { }
141                 # class Sub&lt;T&gt; implements Sup&lt;String&gt; { }
142                 &quot;&quot;&quot;;
143         String I2 =
144             &quot;&quot;&quot;
145             sealed interface Sup # { }
146             # class Sub1 implements Sup { }
147             # class Sub2 implements Sup { }
148             &quot;&quot;&quot;;
149 
150         // Assert that all combinations work:
151         // { class, abs class, interface } x { implicit permits, explicit permits }
152         //                                 x { final, non-sealed subtype }
153         for (String shell : SHELLS)
154             for (String b : List.of(CC1, CC2, CC3, AC1, AC2, AC3, I1, I11, I12))
155                 for (String p : List.of(&quot;&quot;, &quot;permits Sub&quot;))
156                     for (String m : List.of(&quot;final&quot;, &quot;non-sealed&quot;))
157                         assertOK(shell, b, p, m);
158 
159 
160         // Same for type with two subtypes
161         for (String shell : SHELLS)
162             for (String p : List.of(&quot;&quot;, &quot;permits Sub1, Sub2&quot;))
163                 for (String m : List.of(&quot;final&quot;, &quot;non-sealed&quot;))
164                     assertOK(shell, expandMarkers(I2, p, m, m));
165 
166         // Expect failure if there is no explicit final / sealed / non-sealed
167         for (String shell : SHELLS)
168             for (String b : List.of(CC1, CC2, CC3, AC1, AC2, AC3, I1, I11, I12))
169                 for (String p : List.of(&quot;&quot;, &quot;permits Sub&quot;))
170                     for (String m : List.of(&quot;&quot;))
171                         assertFail(&quot;compiler.err.non.sealed.sealed.or.final.expected&quot;, shell, expandMarkers(b, p, m));
172     }
173 
174     public void testSealedAndRecords() {
175         String P =
176             &quot;&quot;&quot;
177             sealed interface Sup # { }
178             record A(int a) implements Sup { }
179             record B(int b) implements Sup { }
180             record C(int c) implements Sup { }
181             &quot;&quot;&quot;;
182 
183         for (String shell : SHELLS)
184             for (String b : List.of(P))
185                 for (String p : List.of(&quot;&quot;, &quot;permits A, B, C&quot;))
186                     assertOK(shell, b, p);
187     }
188 
189     // Test that a type that explicitly permits one type, can&#39;t be extended by another
190     public void testBadExtension() {
191         String CC2 =
192                 &quot;&quot;&quot;
193                 sealed class Sup permits Sub1 { }
194                 final class Sub1 extends Sup { }
195                 final class Sub2 extends Sup { }
196                 &quot;&quot;&quot;;
197         String AC2 =
198                 &quot;&quot;&quot;
199                 sealed abstract class Sup permits Sub1 { }
200                 final class Sub1 extends Sup { }
201                 final class Sub2 extends Sup { }
202                 &quot;&quot;&quot;;
203         String I2c =
204                 &quot;&quot;&quot;
205                 sealed interface Sup permits Sub1 { }
206                 final class Sub1 implements Sup { }
207                 final class Sub2 implements Sup { }
208                 &quot;&quot;&quot;;
209         String I2i =
210                 &quot;&quot;&quot;
211                 sealed interface Sup permits Sub1 { }
212                 non-sealed interface Sub1 extends Sup { }
213                 non-sealed interface Sub2 extends Sup { }
214                 &quot;&quot;&quot;;
215 
216         for (String shell : SHELLS)
217             for (String b : List.of(CC2, AC2, I2c, I2i))
218                 assertFail(&quot;compiler.err.cant.inherit.from.sealed&quot;, shell, b);
219     }
220 
221     public void testRestrictedKeyword() {
222         for (String s : List.of(
223                 &quot;class SealedTest { String sealed; }&quot;,
224                 &quot;class SealedTest { int sealed = 0; int non = 0; int ns = non-sealed; }&quot;,
225                 &quot;class SealedTest { void test(String sealed) { } }&quot;,
226                 &quot;class SealedTest { void sealed(String sealed) { } }&quot;,
227                 &quot;class SealedTest { void test() { String sealed = null; } }&quot;,
228                 &quot;class sealed {}&quot;)) {
229             assertOK(s);
230         }
231     }
232 
233     public void testRejectPermitsInNonSealedClass() {
234         assertFail(&quot;compiler.err.invalid.permits.clause&quot;,
235                 &quot;class SealedTest {\n&quot; +
236                 &quot;    class NotSealed permits Sub {}\n&quot; +
237                 &quot;    class Sub extends NotSealed {}\n&quot; +
238                 &quot;}&quot;);
239         assertFail(&quot;compiler.err.invalid.permits.clause&quot;,
240                 &quot;class SealedTest {\n&quot; +
241                 &quot;    interface NotSealed permits Sub {}\n&quot; +
242                 &quot;    class Sub implements NotSealed {}\n&quot; +
243                 &quot;}&quot;);
244     }
245 
246     public void testTypeInPermitsIsSameClassOrSuper() {
247         assertFail(&quot;compiler.err.invalid.permits.clause&quot;,
248                 &quot;&quot;&quot;
249                 sealed class Sealed permits Sealed {}
250                 &quot;&quot;&quot;
251                 );
252         assertFail(&quot;compiler.err.invalid.permits.clause&quot;,
253                 &quot;&quot;&quot;
254                 interface I {}
255                 sealed class Sealed implements I permits I {}
256                 &quot;&quot;&quot;
257                 );
258         assertFail(&quot;compiler.err.invalid.permits.clause&quot;,
259                 &quot;&quot;&quot;
260                 interface I {}
261                 interface I2 extends I {}
262                 sealed class Sealed implements I2 permits I {}
263                 &quot;&quot;&quot;
264                 );
265     }
266 
267     /* It is a compile-time error if a class declaration has more than one of the class modifiers
268      * sealed, non-sealed and final
269      */
270     public void testBadModifiers() {
271         assertFail(&quot;compiler.err.non.sealed.with.no.sealed.supertype&quot;,
272                 &quot;class SealedTest { non-sealed class NoSealedSuper {} }&quot;);
273         assertFail(&quot;compiler.err.mod.not.allowed.here&quot;,
274                    &quot;class SealedTest { sealed public void m() {} }&quot;);
275         for (String s : List.of(
276                 &quot;class SealedTest { sealed non-sealed class Super {} }&quot;,
277                 &quot;class SealedTest { final non-sealed class Super {} }&quot;,
278                 &quot;class SealedTest { final sealed class Super {} }&quot;,
279                 &quot;class SealedTest { final sealed non-sealed class Super {} }&quot;,
280                 &quot;class SealedTest {\n&quot; +
281                 &quot;    sealed class Super {}\n&quot; +
282                 &quot;    sealed non-sealed class Sub extends Super {}\n&quot; +
283                 &quot;}&quot;))
284             assertFail(&quot;compiler.err.illegal.combination.of.modifiers&quot;, s);
285     }
286 
287     public void testAnonymousAndLambdaCantExtendSealed() {
288         for (String s : List.of(
289                 &quot;&quot;&quot;
290                 sealed interface I1 extends Runnable {
291                     public static I1 i = () -&gt; {};
292                 }
293                 &quot;&quot;&quot;
294                 ))
295             assertFail(&quot;compiler.err.cant.inherit.from.sealed&quot;, s);
296 
297         for (String s : List.of(
298                 &quot;&quot;&quot;
299                 sealed interface I2 extends Runnable {
300                     public static void foo() { new I2() { public void run() { } }; }
301                 }
302                 final class C implements I2 {
303                     @Override public void run() {}
304                 }
305                 &quot;&quot;&quot;
306                 ))
307                 assertFail(&quot;compiler.err.local.classes.cant.extend.sealed&quot;, s);
308     }
309 
310     public void testNoLocalSealedClasses() {
311         for (String s : List.of(
312                 &quot;&quot;&quot;
313                 sealed class C {
314                     void m() {
315                         sealed class D { }
316                     }
317                 }
318                 &quot;&quot;&quot;,
319                 &quot;&quot;&quot;
320                 sealed class C {
321                     void m() {
322                         non-sealed class D { }
323                     }
324                 }
325                 &quot;&quot;&quot;))
326             assertFail(&quot;compiler.err.sealed.or.non.sealed.local.classes.not.allowed&quot;, s);
327     }
328 
329     public void testLocalCantExtendSealed() {
330         for (String s : List.of(
331                 &quot;&quot;&quot;
332                 sealed class C {
333                     void m() {
334                         final class D extends C { }
335                     }
336                 }
337                 &quot;&quot;&quot;))
338             assertFail(&quot;compiler.err.local.classes.cant.extend.sealed&quot;, s);
339     }
340 
341     public void testSealedInterfaceAndAbstracClasses() {
342         for (String s : List.of(
343                 &quot;&quot;&quot;
344                 sealed interface I {}
345                 &quot;&quot;&quot;,
346                 &quot;&quot;&quot;
347                 sealed abstract class AC {}
348                 &quot;&quot;&quot;,
349                 &quot;&quot;&quot;
350                 sealed class C {}
351                 &quot;&quot;&quot;))
352             assertFail(&quot;compiler.err.sealed.class.must.have.subclasses&quot;, s);
353 
354         for (String s : List.of(
355                 &quot;&quot;&quot;
356                 sealed interface I {}
357 
358                 non-sealed interface I2 extends I {}
359                 &quot;&quot;&quot;,
360                 &quot;&quot;&quot;
361                 sealed interface I {}
362 
363                 sealed interface I2 extends I {}
364 
365                 non-sealed interface I3 extends I2 {}
366                 &quot;&quot;&quot;,
367                 &quot;&quot;&quot;
368                 sealed interface I permits I2 {}
369 
370                 non-sealed interface I2 extends I {}
371                 &quot;&quot;&quot;,
372                 &quot;&quot;&quot;
373                 sealed interface I permits I2 {}
374 
375                 sealed interface I2 extends I permits I3 {}
376 
377                 non-sealed interface I3 extends I2 {}
378                 &quot;&quot;&quot;
379                 ))
380             assertOK(s);
381     }
382 
383     public void testEnumsCantBeSealedOrNonSealed() {
384         for (String s : List.of(
385                 &quot;&quot;&quot;
386                 sealed interface I {}
387 
388                 sealed enum E implements I {E1}
389                 &quot;&quot;&quot;,
390                 &quot;&quot;&quot;
391                 sealed interface I {}
392 
393                 non-sealed enum E implements I {E1}
394                 &quot;&quot;&quot;))
395             assertFail(&quot;compiler.err.mod.not.allowed.here&quot;, s);
396     }
397 
398     public void testEnumsCanImplementSealedInterfaces() {
399         for (String s : List.of(
400                 &quot;&quot;&quot;
401                 sealed interface I {}
402 
403                 enum E implements I {E1}
404                 &quot;&quot;&quot;))
405             assertOK(s);
406     }
407 
408     public void testClassesCanExtendNonSealed() {
409         for (String s : List.of(
410                 &quot;&quot;&quot;
411                 sealed class C {}
412 
413                 non-sealed class Sub extends C {}
414 
415                 class Sub2 extends Sub {}
416                 &quot;&quot;&quot;)) {
417             assertOK(s);
418         }
419     }
420 
421     public void testEmptyPermits() {
422         for (String s : List.of(
423             &quot;&quot;&quot;
424             sealed class C permits {}
425             non-sealed class Sub extends C {}
426             &quot;&quot;&quot;)) {
427             assertFail(&quot;compiler.err.illegal.start.of.type&quot;, s);
428         }
429     }
430 
431     public void testTypeVarInPermits() {
432         for (String s : List.of(
433             &quot;&quot;&quot;
434             class Outer&lt;T&gt; {
435                 sealed class C permits T  {}
436             }
437             &quot;&quot;&quot;)) {
438             assertFail(&quot;compiler.err.invalid.permits.clause&quot;, s);
439         }
440     }
441 
442     public void testRepeatedTypeInPermits() {
443         for (String s : List.of(
444             &quot;&quot;&quot;
445             sealed class C permits Sub, Sub {}
446 
447             final class Sub extends C {}
448             &quot;&quot;&quot;)) {
449             assertFail(&quot;compiler.err.invalid.permits.clause&quot;, s);
450         }
451     }
452 
453     public void testSubtypeDoesntExtendSealed() {
454         for (String s : List.of(
455             &quot;&quot;&quot;
456             sealed class C permits Sub {}
457 
458             final class Sub {}
459             &quot;&quot;&quot;,
460             &quot;&quot;&quot;
461             sealed interface I permits Sub {}
462 
463             final class Sub {}
464             &quot;&quot;&quot;,
465             &quot;&quot;&quot;
466             sealed class C permits Sub1, Sub2 {}
467 
468             sealed class Sub1 extends C permits Sub2 {}
469 
470             final class Sub2 extends Sub1 {}
471             &quot;&quot;&quot;
472             )) {
473             assertFail(&quot;compiler.err.invalid.permits.clause&quot;, s);
474         }
475     }
476 
477     public void testAPIForPrimitiveAndArrayClasses() {
478         for (Class&lt;?&gt; c : new Class[]{byte.class, byte[].class, short.class, short[].class, int.class, int[].class, long.class, long[].class,
479             float.class, float[].class, double.class, double[].class, char.class, char[].class, boolean.class, boolean[].class, void.class,
480             String[].class}) {
481             Assert.check(!c.isSealed());
482             Assert.check(c.getPermittedSubclasses().length == 0);
483         }
484     }
485 
486     public void testPrinting() throws Exception {
487         Path base = Paths.get(&quot;testPrinting&quot;);
488         Path src = base.resolve(&quot;src&quot;);
489         Path test = src.resolve(&quot;Test&quot;);
490 
491         tb.writeJavaFiles(test,
492             &quot;&quot;&quot;
493             sealed class SealedClassNoPermits {}
494 
495             final class FinalSubClass extends SealedClassNoPermits {}
496 
497             non-sealed class NonSealedSubClass extends SealedClassNoPermits {}
498 
499             sealed interface SealedInterfaceNoPermits {}
500 
501             non-sealed interface NonSealedInterface extends SealedInterfaceNoPermits {}
502 
503             final class FinalSubClass2 implements SealedInterfaceNoPermits {}
504 
505 
506             sealed class SealedClassWithPermits permits SealedClassWithPermits, NonSealedSubClass2 {}
507 
508             final class FinalSubClass3 extends SealedClassWithPermits {}
509 
510             non-sealed class NonSealedSubClass2 extends SealedClassWithPermits {}
511 
512             sealed interface SealedInterfaceWithPermits permits NonSealedInterface2, FinalSubClass4 {}
513 
514             non-sealed interface NonSealedInterface2 extends SealedInterfaceWithPermits {}
515 
516             final class FinalSubClass4 implements SealedInterfaceWithPermits {}
517 
518 
519             enum SealedEnum {
520                 E {}
521             }
522 
523             enum Enum {
524                 E
525             }
526             &quot;&quot;&quot;
527         );
528 
529         Path out = base.resolve(&quot;out&quot;);
530 
531         Files.createDirectories(out);
532 
533         List&lt;String&gt; output = new JavacTask(tb)
534             .outdir(out)
535             .options(&quot;--enable-preview&quot;, &quot;-source&quot;, Integer.toString(Runtime.version().feature()), &quot;-Xprint&quot;)
536             .files(findJavaFiles(test))
537             .run()
538             .writeAll()
539             .getOutputLines(OutputKind.STDOUT);
540 
541         List&lt;String&gt; expected = List.of(
542             &quot;&quot;,
543             &quot;sealed class SealedClassNoPermits permits FinalSubClass, NonSealedSubClass {&quot;,
544             &quot;&quot;,
545             &quot;  SealedClassNoPermits();&quot;,
546             &quot;}&quot;,
547             &quot;&quot;,
548             &quot;final class FinalSubClass extends SealedClassNoPermits {&quot;,
549             &quot;&quot;,
550             &quot;  FinalSubClass();&quot;,
551             &quot;}&quot;,
552             &quot;&quot;,
553             &quot;non-sealed class NonSealedSubClass extends SealedClassNoPermits {&quot;,
554             &quot;&quot;,
555             &quot;  NonSealedSubClass();&quot;,
556             &quot;}&quot;,
557             &quot;&quot;,
558             &quot;sealed interface SealedInterfaceNoPermits permits NonSealedInterface, FinalSubClass2 {&quot;,
559             &quot;}&quot;,
560             &quot;&quot;,
561             &quot;non-sealed interface NonSealedInterface extends SealedInterfaceNoPermits {&quot;,
562             &quot;}&quot;,
563             &quot;&quot;,
564             &quot;final class FinalSubClass2 implements SealedInterfaceNoPermits {&quot;,
565             &quot;&quot;,
566             &quot;  FinalSubClass2();&quot;,
567             &quot;}&quot;,
568             &quot;&quot;,
569             &quot;sealed class SealedClassWithPermits permits SealedClassWithPermits, NonSealedSubClass2 {&quot;,
570             &quot;&quot;,
571             &quot;  SealedClassWithPermits();&quot;,
572             &quot;}&quot;,
573             &quot;&quot;,
574             &quot;final class FinalSubClass3 extends SealedClassWithPermits {&quot;,
575             &quot;&quot;,
576             &quot;  FinalSubClass3();&quot;,
577             &quot;}&quot;,
578             &quot;&quot;,
579             &quot;non-sealed class NonSealedSubClass2 extends SealedClassWithPermits {&quot;,
580             &quot;&quot;,
581             &quot;  NonSealedSubClass2();&quot;,
582             &quot;}&quot;,
583             &quot;&quot;,
584             &quot;sealed interface SealedInterfaceWithPermits permits NonSealedInterface2, FinalSubClass4 {&quot;,
585             &quot;}&quot;,
586             &quot;&quot;,
587             &quot;non-sealed interface NonSealedInterface2 extends SealedInterfaceWithPermits {&quot;,
588             &quot;}&quot;,
589             &quot;&quot;,
590             &quot;final class FinalSubClass4 implements SealedInterfaceWithPermits {&quot;,
591             &quot;&quot;,
592             &quot;  FinalSubClass4();&quot;,
593             &quot;}&quot;,
594             &quot;&quot;,
595             &quot;sealed enum SealedEnum {&quot;,
596             &quot;&quot;,
597             &quot;  E;&quot;,
598             &quot;&quot;,
599             &quot;&quot;,
600             &quot;  public static SealedEnum[] values();&quot;,
601             &quot;&quot;,
602             &quot;  public static SealedEnum valueOf(java.lang.String name);&quot;,
603             &quot;&quot;,
604             &quot;  private SealedEnum();&quot;,
605             &quot;}&quot;,
606             &quot;&quot;,
607             &quot;enum Enum {&quot;,
608             &quot;&quot;,
609             &quot;  E;&quot;,
610             &quot;&quot;,
611             &quot;&quot;,
612             &quot;  public static Enum[] values();&quot;,
613             &quot;&quot;,
614             &quot;  public static Enum valueOf(java.lang.String name);&quot;,
615             &quot;&quot;,
616             &quot;  private Enum();&quot;,
617             &quot;}&quot;
618         );
619         if (!output.containsAll(expected)) {
620             throw new AssertionError(&quot;Expected output not found. Expected: &quot; + expected);
621         }
622     }
623 
624     public void testNonSealedErroneousSuper() {
625         assertFail(&quot;compiler.err.cant.resolve&quot;,
626                    d -&gt; {
627                        if (diags.keys().size() != 1) {
628                            fail(&quot;Unexpected errors: &quot; + diags.keys());
629                        }
630                    },
631                    &quot;&quot;&quot;
632                    non-sealed class C extends Undefined {}
633                    &quot;&quot;&quot;);
634     }
635 
636     private Path[] findJavaFiles(Path... paths) throws IOException {
637         return tb.findJavaFiles(paths);
638     }
639 }
    </pre>
  </body>
</html>