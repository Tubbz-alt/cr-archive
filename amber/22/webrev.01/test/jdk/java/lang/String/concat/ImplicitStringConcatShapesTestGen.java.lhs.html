<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames test/jdk/java/lang/String/concat/ImplicitStringConcatShapesTestGen.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 2015, 2016, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 import java.io.IOException;
 25 import java.io.PrintWriter;
 26 import java.nio.file.Files;
 27 import java.nio.file.Paths;
 28 import java.util.*;
 29 
 30 public class ImplicitStringConcatShapesTestGen {
 31     public static String escapeToUnicode(String str) {
 32         StringBuilder b = new StringBuilder();
 33         for (char c : str.toCharArray()) {
 34             if (c &lt; 128) {
 35                 b.append(c);
 36             } else {
 37                 b.append(&quot;\\u&quot;).append(String.format(&quot;%04X&quot;, (int) c));
 38             }
 39         }
 40         return b.toString();
 41     }
 42 
 43     public static void main(String... args) throws IOException {
 44         PrintWriter pw = new PrintWriter(System.out);
 45 
 46         String[] types = {
 47                 &quot;boolean&quot;,
 48                 &quot;byte&quot;,
 49                 &quot;byteMinus&quot;,
 50                 &quot;char&quot;,
 51                 &quot;short&quot;,
 52                 &quot;shortMinus&quot;,
 53                 &quot;int&quot;,
 54                 &quot;intMinus&quot;,
 55                 &quot;integer&quot;,
 56                 &quot;integerNull&quot;,
 57                 &quot;float&quot;,
 58                 &quot;floatMinus&quot;,
 59                 &quot;long&quot;,
 60                 &quot;longMinus&quot;,
 61                 &quot;double&quot;,
 62                 &quot;doubleMinus&quot;,
 63                 &quot;object&quot;,
 64                 &quot;objectNull&quot;,
 65                 &quot;objectNullToString&quot;,
 66                 &quot;String&quot;,
 67                 &quot;StringUTF16&quot;,
 68                 &quot;StringU1&quot;,
 69                 &quot;StringU2&quot;,
 70                 &quot;intArrayNull&quot;,
 71                 &quot;objectArrayNull&quot;,
 72         };
 73 
 74         for (String t : Files.readAllLines(Paths.get(&quot;ImplicitStringConcatShapes-head.template&quot;))) {
 75             pw.println(t);
 76         }
 77 
 78         Map&lt;String, String&gt; values = new HashMap&lt;&gt;();
 79 
 80         Random current = new Random(12345);
 81         for (int mode = 0; mode &lt;= 2; mode++) {
 82             for (String type : types) {
 83                 int i = current.nextInt(100);
 84                 boolean isStatic = (mode | 1) == 1;
 85                 boolean isFinal = (mode | 2) == 2;
 86                 String fieldName = (isStatic ? &quot;s&quot; : &quot;&quot;) + (isFinal ? &quot;f&quot; : &quot;&quot;) + &quot;_&quot; + typeSig(type);
 87                 String value = initValue(type, i);
 88                 String stringValue = stringValue(type, i);
 89                 values.put(fieldName, stringValue);
 90                 pw.printf(&quot;    %s %s %s %s = %s;%n&quot;, isStatic ? &quot;static&quot; : &quot;&quot;, isFinal ? &quot;final&quot; : &quot;&quot;, typeValue(type, i), fieldName, value);
 91             }
 92         }
 93 
 94         pw.println();
 95 
 96         List&lt;String&gt; lines = new ArrayList&lt;&gt;();
 97         List&lt;String&gt; l = new ArrayList&lt;&gt;(values.keySet());
 98 
 99         for (String l1 : l) {
100             lines.add(String.format(&quot;test(\&quot;%s\&quot;, \&quot;\&quot; + %s);&quot;,
101                     escapeToUnicode(values.get(l1)),
102                     l1
103             ));
<a name="2" id="anc2"></a>











104         }
105 
106         for (String l1 : l) {
107             for (String l2 : l) {
108                 lines.add(String.format(&quot;test(\&quot;%s\&quot;, \&quot;\&quot; + %s + %s);&quot;,
109                         escapeToUnicode(values.get(l1) + values.get(l2)),
110                         l1, l2
111                 ));
<a name="3" id="anc3"></a>







112             }
113         }
114 
115         final int STRIDE = 1000;
116         int strides = lines.size() / STRIDE + 1;
117 
118         pw.println(&quot;    public void run() {&quot;);
119         for (int c = 0; c &lt; strides; c++) {
120             pw.println(&quot;        run&quot; + c + &quot;();&quot;);
121         }
122         pw.println(&quot;    }&quot;);
123         pw.println();
124 
125         for (int c = 0; c &lt; strides; c++) {
126             pw.println(&quot;    public void run&quot; + c + &quot;() {&quot;);
127             for (String line : lines.subList(c * STRIDE, Math.min(lines.size(), (c+1) * STRIDE))) {
128                 pw.println(&quot;        &quot; + line);
129             }
130             pw.println(&quot;    }&quot;);
131             pw.println();
132         }
133 
134         pw.println(&quot;}&quot;);
135 
136         pw.flush();
137         pw.close();
138     }
139 
140     private static String typeSig(String type) {
141         switch (type) {
142             case &quot;boolean&quot;:             return &quot;bl&quot;;
143             case &quot;byte&quot;:                return &quot;b&quot;;
144             case &quot;byteMinus&quot;:           return &quot;bM&quot;;
145             case &quot;short&quot;:               return &quot;s&quot;;
146             case &quot;shortMinus&quot;:          return &quot;sM&quot;;
147             case &quot;char&quot;:                return &quot;c&quot;;
148             case &quot;int&quot;:                 return &quot;i&quot;;
149             case &quot;intMinus&quot;:            return &quot;iM&quot;;
150             case &quot;integer&quot;:             return &quot;I&quot;;
151             case &quot;integerNull&quot;:         return &quot;IN&quot;;
152             case &quot;float&quot;:               return &quot;f&quot;;
153             case &quot;floatMinus&quot;:          return &quot;fM&quot;;
154             case &quot;long&quot;:                return &quot;l&quot;;
155             case &quot;longMinus&quot;:           return &quot;lM&quot;;
156             case &quot;double&quot;:              return &quot;d&quot;;
157             case &quot;doubleMinus&quot;:         return &quot;dM&quot;;
158             case &quot;String&quot;:              return &quot;str&quot;;
159             case &quot;StringUTF16&quot;:         return &quot;strU&quot;;
160             case &quot;StringU1&quot;:            return &quot;strU1&quot;;
161             case &quot;StringU2&quot;:            return &quot;strU2&quot;;
162             case &quot;object&quot;:              return &quot;o&quot;;
163             case &quot;objectNull&quot;:          return &quot;oN&quot;;
164             case &quot;objectNullToString&quot;:  return &quot;oNtS&quot;;
165             case &quot;intArrayNull&quot;:        return &quot;iAN&quot;;
166             case &quot;objectArrayNull&quot;:     return &quot;oAN&quot;;
167             default:
168                 throw new IllegalStateException();
169         }
170     }
171 
172     private static String typeValue(String type, int i) {
173         switch (type) {
174             case &quot;boolean&quot;:
175             case &quot;byte&quot;:
176             case &quot;byteMinus&quot;:
177             case &quot;char&quot;:
178             case &quot;short&quot;:
179             case &quot;shortMinus&quot;:
180             case &quot;int&quot;:
181             case &quot;intMinus&quot;:
182             case &quot;float&quot;:
183             case &quot;floatMinus&quot;:
184             case &quot;long&quot;:
185             case &quot;longMinus&quot;:
186             case &quot;double&quot;:
187             case &quot;doubleMinus&quot;:
188                 return type.replace(&quot;Minus&quot;, &quot;&quot;);
189             case &quot;String&quot;:
190             case &quot;StringUTF16&quot;:
191             case &quot;StringU1&quot;:
192             case &quot;StringU2&quot;:
193                 return &quot;String&quot;;
194             case &quot;object&quot;:
195             case &quot;objectNull&quot;:
196             case &quot;objectNullToString&quot;:
197                 return &quot;Object&quot;;
198             case &quot;integer&quot;:
199             case &quot;integerNull&quot;:
200                 return &quot;Integer&quot;;
201             case &quot;intArrayNull&quot;:
202                 return &quot;int[]&quot;;
203             case &quot;objectArrayNull&quot;:
204                 return &quot;Object[]&quot;;
205             default:
206                 throw new IllegalStateException();
207         }
208     }
209 
210     private static String initValue(String type, int i) {
211         switch (type) {
212             case &quot;boolean&quot;:
213                 return String.valueOf((i &amp; 1) == 1);
214             case &quot;byte&quot;:
215                 return String.valueOf(i);
216             case &quot;byteMinus&quot;:
217                 return String.valueOf(-i);
218             case &quot;short&quot;:
219                 return String.valueOf(i*100);
220             case &quot;shortMinus&quot;:
221                 return String.valueOf(-i*100);
222             case &quot;intMinus&quot;:
223                 return String.valueOf(-i*1_000_000);
224             case &quot;int&quot;:
225             case &quot;integer&quot;:
226                 return String.valueOf(i*1_000_000);
227             case &quot;long&quot;:
228                 return String.valueOf(i*1_000_000_000) + &quot;L&quot;;
229             case &quot;longMinus&quot;:
230                 return String.valueOf(-i*1_000_000_000) + &quot;L&quot;;
231             case &quot;char&quot;:
232                 return &quot;&#39;&quot; + (char)(i % 26 + 65) + &quot;&#39;&quot;;
233             case &quot;double&quot;:
234                 return String.valueOf(i) + &quot;.0d&quot;;
235             case &quot;doubleMinus&quot;:
236                 return &quot;-&quot; + String.valueOf(i) + &quot;.0d&quot;;
237             case &quot;float&quot;:
238                 return String.valueOf(i) + &quot;.0f&quot;;
239             case &quot;floatMinus&quot;:
240                 return &quot;-&quot; + String.valueOf(i) + &quot;.0f&quot;;
241             case &quot;object&quot;:
242                 return &quot;new MyClass(&quot; + i + &quot;)&quot;;
243             case &quot;objectNullToString&quot;:
244                 return &quot;new MyClassNullToString()&quot;;
245             case &quot;integerNull&quot;:
246             case &quot;objectNull&quot;:
247             case &quot;intArrayNull&quot;:
248             case &quot;objectArrayNull&quot;:
249                 return &quot;null&quot;;
250             case &quot;String&quot;:
251                 return &quot;\&quot;&quot; + i + &quot;\&quot;&quot;;
252             case &quot;StringUTF16&quot;:
253                 return &quot;\&quot;\\u0451&quot; + i + &quot;\&quot;&quot;;
254             case &quot;StringU1&quot;:
255                 return &quot;\&quot;\\u0001&quot; + i + &quot;\&quot;&quot;;
256             case &quot;StringU2&quot;:
257                 return &quot;\&quot;\\u0002&quot; + i + &quot;\&quot;&quot;;
258             default:
259                 throw new IllegalStateException();
260         }
261     }
262 
263     private static String stringValue(String type, int i) {
264         switch (type) {
265             case &quot;boolean&quot;:
266                 return String.valueOf((i &amp; 1) == 1);
267             case &quot;byte&quot;:
268                 return String.valueOf(i);
269             case &quot;byteMinus&quot;:
270                 return String.valueOf(-i);
271             case &quot;short&quot;:
272                 return String.valueOf(i*100);
273             case &quot;shortMinus&quot;:
274                 return String.valueOf(-i*100);
275             case &quot;intMinus&quot;:
276                 return String.valueOf(-i*1_000_000);
277             case &quot;int&quot;:
278             case &quot;integer&quot;:
279                 return String.valueOf(i*1_000_000);
280             case &quot;long&quot;:
281                 return String.valueOf(i*1_000_000_000);
282             case &quot;longMinus&quot;:
283                 return String.valueOf(-i*1_000_000_000);
284             case &quot;char&quot;:
285                 return String.valueOf((char) (i % 26 + 65));
286             case &quot;double&quot;:
287             case &quot;float&quot;:
288                 return String.valueOf(i) + &quot;.0&quot;;
289             case &quot;doubleMinus&quot;:
290             case &quot;floatMinus&quot;:
291                 return &quot;-&quot; + String.valueOf(i) + &quot;.0&quot;;
292             case &quot;object&quot;:
293                 return &quot;C(&quot; + i + &quot;)&quot;;
294             case &quot;integerNull&quot;:
295             case &quot;objectNull&quot;:
296             case &quot;objectNullToString&quot;:
297             case &quot;intArrayNull&quot;:
298             case &quot;objectArrayNull&quot;:
299                 return &quot;null&quot;;
300             case &quot;String&quot;:
301                 return &quot;&quot; + i;
302             case &quot;StringUTF16&quot;:
303                 return &quot;\u0451&quot; + i;
304             case &quot;StringU1&quot;:
305                 return &quot;\u0001&quot; + i;
306             case &quot;StringU2&quot;:
307                 return &quot;\u0002&quot; + i;
308             default:
309                 throw new IllegalStateException();
310         }
311     }
312 
313 }
<a name="4" id="anc4"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="4" type="hidden" />
</body>
</html>