<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/gc/shenandoah/shenandoahCollectionSet.hpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="shenandoahCollectionSet.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="shenandoahCollectionSet.inline.hpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/shenandoah/shenandoahCollectionSet.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 26,10 ***</span>
<span class="line-new-header">--- 26,11 ---</span>
  #define SHARE_GC_SHENANDOAH_SHENANDOAHCOLLECTIONSET_HPP
  
  #include &quot;memory/allocation.hpp&quot;
  #include &quot;gc/shenandoah/shenandoahHeap.hpp&quot;
  #include &quot;gc/shenandoah/shenandoahHeapRegion.hpp&quot;
<span class="line-added">+ #include &quot;gc/shenandoah/shenandoahPadding.hpp&quot;</span>
  
  class ShenandoahCollectionSet : public CHeapObj&lt;mtGC&gt; {
    friend class ShenandoahHeap;
  private:
    size_t const          _map_size;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 44,28 ***</span>
    size_t                _garbage;
    size_t                _live_data;
    size_t                _used;
    size_t                _region_count;
  
<span class="line-modified">!   DEFINE_PAD_MINUS_SIZE(0, DEFAULT_CACHE_LINE_SIZE, sizeof(volatile size_t));</span>
    volatile jint         _current_index;
<span class="line-modified">!   DEFINE_PAD_MINUS_SIZE(1, DEFAULT_CACHE_LINE_SIZE, 0);</span>
  
  public:
    ShenandoahCollectionSet(ShenandoahHeap* heap, char* heap_base, size_t size);
  
    // Add region to collection set
    void add_region(ShenandoahHeapRegion* r);
<span class="line-removed">-   bool add_region_check_for_duplicates(ShenandoahHeapRegion* r);</span>
<span class="line-removed">- </span>
<span class="line-removed">-   // Bring per-region statuses to consistency with this collection.</span>
<span class="line-removed">-   // TODO: This is a transitional interface that bridges the gap between</span>
<span class="line-removed">-   // region statuses and this collection. Should go away after we merge them.</span>
<span class="line-removed">-   void update_region_status();</span>
<span class="line-removed">- </span>
<span class="line-removed">-   // Remove region from collection set</span>
<span class="line-removed">-   void remove_region(ShenandoahHeapRegion* r);</span>
  
    // MT version
    ShenandoahHeapRegion* claim_next();
  
    // Single-thread version
<span class="line-new-header">--- 45,19 ---</span>
    size_t                _garbage;
    size_t                _live_data;
    size_t                _used;
    size_t                _region_count;
  
<span class="line-modified">!   shenandoah_padding(0);</span>
    volatile jint         _current_index;
<span class="line-modified">!   shenandoah_padding(1);</span>
  
  public:
    ShenandoahCollectionSet(ShenandoahHeap* heap, char* heap_base, size_t size);
  
    // Add region to collection set
    void add_region(ShenandoahHeapRegion* r);
  
    // MT version
    ShenandoahHeapRegion* claim_next();
  
    // Single-thread version
</pre>
<hr />
<pre>
<span class="line-old-header">*** 77,13 ***</span>
    void clear_current_index() {
      _current_index = 0;
    }
  
    inline bool is_in(ShenandoahHeapRegion* r) const;
<span class="line-modified">!   inline bool is_in(size_t region_number)    const;</span>
<span class="line-removed">-   inline bool is_in(HeapWord* loc)           const;</span>
    inline bool is_in(oop obj)                 const;
  
    void print_on(outputStream* out) const;
  
    size_t used()      const { return _used; }
    size_t live_data() const { return _live_data; }
<span class="line-new-header">--- 69,13 ---</span>
    void clear_current_index() {
      _current_index = 0;
    }
  
    inline bool is_in(ShenandoahHeapRegion* r) const;
<span class="line-modified">!   inline bool is_in(size_t region_idx)       const;</span>
    inline bool is_in(oop obj)                 const;
<span class="line-added">+   inline bool is_in_loc(void* loc)           const;</span>
  
    void print_on(outputStream* out) const;
  
    size_t used()      const { return _used; }
    size_t live_data() const { return _live_data; }
</pre>
<center><a href="shenandoahCollectionSet.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="shenandoahCollectionSet.inline.hpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>