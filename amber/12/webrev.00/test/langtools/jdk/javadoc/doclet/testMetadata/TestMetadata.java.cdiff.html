<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/langtools/jdk/javadoc/doclet/testMetadata/TestMetadata.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../testMemberSummary/TestMemberSummary.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../testMethodSignature/TestMethodSignature.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/langtools/jdk/javadoc/doclet/testMetadata/TestMetadata.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2019, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 21,11 ***</span>
   * questions.
   */
  
  /*
   * @test
<span class="line-modified">!  * @bug 8218998 8219946 8219060</span>
   * @summary Add metadata to generated API documentation files
   * @library /tools/lib ../../lib
   * @modules jdk.javadoc/jdk.javadoc.internal.tool
   * @modules jdk.compiler/com.sun.tools.javac.api
   *          jdk.compiler/com.sun.tools.javac.main
<span class="line-new-header">--- 21,11 ---</span>
   * questions.
   */
  
  /*
   * @test
<span class="line-modified">!  * @bug 8218998 8219946 8219060 8241190 8242056</span>
   * @summary Add metadata to generated API documentation files
   * @library /tools/lib ../../lib
   * @modules jdk.javadoc/jdk.javadoc.internal.tool
   * @modules jdk.compiler/com.sun.tools.javac.api
   *          jdk.compiler/com.sun.tools.javac.main
</pre>
<hr />
<pre>
<span class="line-old-header">*** 135,31 ***</span>
      }
  
      final Pattern nl = Pattern.compile(&quot;[\\r\\n]+&quot;);
      final Pattern bodyPattern = Pattern.compile(&quot;&lt;body [^&gt;]*class=\&quot;([^\&quot;]+)\&quot;&quot;);
      final Set&lt;String&gt; allBodyClasses = Set.of(
<span class="line-modified">!         &quot;all-classes-index&quot;,</span>
<span class="line-modified">!         &quot;all-packages-index&quot;,</span>
<span class="line-modified">!         &quot;class-declaration&quot;,</span>
<span class="line-modified">!         &quot;class-use&quot;,</span>
<span class="line-modified">!         &quot;constants-summary&quot;,</span>
<span class="line-modified">!         &quot;deprecated-list&quot;,</span>
<span class="line-modified">!         &quot;doc-file&quot;,</span>
<span class="line-modified">!         &quot;help&quot;,</span>
<span class="line-modified">!         &quot;index-redirect&quot;,</span>
<span class="line-modified">!         &quot;module-declaration&quot;,</span>
<span class="line-modified">!         &quot;module-index&quot;,</span>
<span class="line-modified">!         &quot;package-declaration&quot;,</span>
<span class="line-modified">!         &quot;package-index&quot;,</span>
<span class="line-modified">!         &quot;package-tree&quot;,</span>
<span class="line-modified">!         &quot;package-use&quot;,</span>
<span class="line-modified">!         &quot;serialized-form&quot;,</span>
<span class="line-modified">!         &quot;single-index&quot;,</span>
<span class="line-modified">!         &quot;source&quot;,</span>
<span class="line-modified">!         &quot;split-index&quot;,</span>
<span class="line-modified">!         &quot;system-properties&quot;,</span>
<span class="line-modified">!         &quot;tree&quot;</span>
      );
  
      void checkBodyClasses() throws IOException {
          Path outputDirPath = outputDir.toPath();
          for (Path p : tb.findFiles(&quot;.html&quot;, outputDirPath)) {
<span class="line-new-header">--- 135,31 ---</span>
      }
  
      final Pattern nl = Pattern.compile(&quot;[\\r\\n]+&quot;);
      final Pattern bodyPattern = Pattern.compile(&quot;&lt;body [^&gt;]*class=\&quot;([^\&quot;]+)\&quot;&quot;);
      final Set&lt;String&gt; allBodyClasses = Set.of(
<span class="line-modified">!         &quot;all-classes-index-page&quot;,</span>
<span class="line-modified">!         &quot;all-packages-index-page&quot;,</span>
<span class="line-modified">!         &quot;class-declaration-page&quot;,</span>
<span class="line-modified">!         &quot;class-use-page&quot;,</span>
<span class="line-modified">!         &quot;constants-summary-page&quot;,</span>
<span class="line-modified">!         &quot;deprecated-list-page&quot;,</span>
<span class="line-modified">!         &quot;doc-file-page&quot;,</span>
<span class="line-modified">!         &quot;help-page&quot;,</span>
<span class="line-modified">!         &quot;index-redirect-page&quot;,</span>
<span class="line-modified">!         &quot;module-declaration-page&quot;,</span>
<span class="line-modified">!         &quot;module-index-page&quot;,</span>
<span class="line-modified">!         &quot;package-declaration-page&quot;,</span>
<span class="line-modified">!         &quot;package-index-page&quot;,</span>
<span class="line-modified">!         &quot;package-tree-page&quot;,</span>
<span class="line-modified">!         &quot;package-use-page&quot;,</span>
<span class="line-modified">!         &quot;serialized-form-page&quot;,</span>
<span class="line-modified">!         &quot;single-index-page&quot;,</span>
<span class="line-modified">!         &quot;source-page&quot;,</span>
<span class="line-modified">!         &quot;split-index-page&quot;,</span>
<span class="line-modified">!         &quot;system-properties-page&quot;,</span>
<span class="line-modified">!         &quot;tree-page&quot;</span>
      );
  
      void checkBodyClasses() throws IOException {
          Path outputDirPath = outputDir.toPath();
          for (Path p : tb.findFiles(&quot;.html&quot;, outputDirPath)) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 204,11 ***</span>
      final Pattern contentPattern = Pattern.compile(&quot;content=\&quot;([^\&quot;]+)\&quot;&gt;&quot;);
      final Pattern generatorPattern = Pattern.compile(&quot;content=\&quot;javadoc/([^\&quot;]+)\&quot;&gt;&quot;);
      final Set&lt;String&gt; allGenerators = Set.of(
              &quot;AllClassesIndexWriter&quot;,
              &quot;AllPackagesIndexWriter&quot;,
<span class="line-removed">-             &quot;AnnotationTypeWriterImpl&quot;,</span>
              &quot;ClassUseWriter&quot;,
              &quot;ClassWriterImpl&quot;,
              &quot;ConstantsSummaryWriterImpl&quot;,
              &quot;DeprecatedListWriter&quot;,
              &quot;DocFileWriter&quot;,
<span class="line-new-header">--- 204,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 384,11 ***</span>
      Path genSource(Source s) throws IOException {
          Path src = Path.of(&quot;src-&quot; + s);
          switch (s) {
              case PACKAGES:
                  tb.writeJavaFiles(src,
<span class="line-modified">!                     &quot;/** Package pA. */ package pA;&quot;,</span>
                      &quot;/** Class pA.CA. */ package pA; public class CA { }&quot;,
                      &quot;/** Anno pA.Anno, */ package pA; public @interface Anno { }&quot;,
                      &quot;/** Serializable pA.Ser, */ package pA; public class Ser implements java.io.Serializable { }&quot;,
                      &quot;/** Package pB. */ package pB;&quot;,
                      &quot;/** Class pB.CB. */ package pB; public class CB { }&quot;);
<span class="line-new-header">--- 383,11 ---</span>
      Path genSource(Source s) throws IOException {
          Path src = Path.of(&quot;src-&quot; + s);
          switch (s) {
              case PACKAGES:
                  tb.writeJavaFiles(src,
<span class="line-modified">!                     &quot;/** Package pA. {@systemProperty exampleProperty} */ package pA;&quot;,</span>
                      &quot;/** Class pA.CA. */ package pA; public class CA { }&quot;,
                      &quot;/** Anno pA.Anno, */ package pA; public @interface Anno { }&quot;,
                      &quot;/** Serializable pA.Ser, */ package pA; public class Ser implements java.io.Serializable { }&quot;,
                      &quot;/** Package pB. */ package pB;&quot;,
                      &quot;/** Class pB.CB. */ package pB; public class CB { }&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 411,6 ***</span>
          }
  
          return src;
      }
  }
<span class="line-removed">- </span>
<span class="line-new-header">--- 410,5 ---</span>
</pre>
<center><a href="../testMemberSummary/TestMemberSummary.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../testMethodSignature/TestMethodSignature.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>