<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/jdk/jdk/jfr/api/consumer/TestRecordedEvent.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="TestRecordedClassLoader.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TestRecordedEventGetThread.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/jdk/jfr/api/consumer/TestRecordedEvent.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -49,62 +49,60 @@</span>
  
      static class MyClass {
      }
  
      static class TestEvent extends Event {
<span class="udiff-line-removed">- </span>
          @Description(&quot;MyField&quot;)
          Class&lt;?&gt; clzField = String.class;
          int intField;
          String stringField = &quot;myString&quot;;
          Class&lt;?&gt; myClass = MyClass.class;
      }
  
      public static void main(String[] args) throws Throwable {
<span class="udiff-line-modified-removed">-         Recording r = new Recording();</span>
<span class="udiff-line-modified-removed">-         r.start();</span>
<span class="udiff-line-modified-removed">-         TestEvent t = new TestEvent();</span>
<span class="udiff-line-modified-removed">-         t.commit();</span>
<span class="udiff-line-modified-removed">-         r.stop();</span>
<span class="udiff-line-removed">-         List&lt;RecordedEvent&gt; events = Events.fromRecording(r);</span>
<span class="udiff-line-removed">-         Events.hasEvents(events);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         Asserts.assertEquals(events.size(), 1);</span>
<span class="udiff-line-modified-added">+         try (Recording r = new Recording()) {</span>
<span class="udiff-line-modified-added">+             r.start();</span>
<span class="udiff-line-modified-added">+             TestEvent t = new TestEvent();</span>
<span class="udiff-line-modified-added">+             t.commit();</span>
<span class="udiff-line-modified-added">+             r.stop();</span>
  
<span class="udiff-line-modified-removed">-         RecordedEvent event = events.get(0);</span>
<span class="udiff-line-modified-added">+             List&lt;RecordedEvent&gt; events = Events.fromRecording(r);</span>
<span class="udiff-line-added">+             Events.hasEvents(events);</span>
<span class="udiff-line-added">+             Asserts.assertEquals(events.size(), 1);</span>
<span class="udiff-line-added">+             RecordedEvent event = events.get(0);</span>
  
<span class="udiff-line-modified-removed">-         List&lt;ValueDescriptor&gt; descriptors = event.getFields();</span>
<span class="udiff-line-modified-added">+             List&lt;ValueDescriptor&gt; descriptors = event.getFields();</span>
  
<span class="udiff-line-modified-removed">-         System.out.println(&quot;Descriptors&quot;);</span>
<span class="udiff-line-modified-removed">-         for (ValueDescriptor descriptor : descriptors) {</span>
<span class="udiff-line-modified-removed">-             System.out.println(descriptor.getName());</span>
<span class="udiff-line-modified-removed">-             System.out.println(descriptor.getTypeName());</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-         System.out.println(&quot;Descriptors end&quot;);</span>
<span class="udiff-line-modified-added">+             System.out.println(&quot;Descriptors&quot;);</span>
<span class="udiff-line-modified-added">+             for (ValueDescriptor descriptor : descriptors) {</span>
<span class="udiff-line-modified-added">+                 System.out.println(descriptor.getName());</span>
<span class="udiff-line-modified-added">+                 System.out.println(descriptor.getTypeName());</span>
<span class="udiff-line-modified-added">+             }</span>
<span class="udiff-line-modified-added">+             System.out.println(&quot;Descriptors end&quot;);</span>
  
<span class="udiff-line-modified-removed">-         Object recordedClass = event.getValue(&quot;clzField&quot;);</span>
<span class="udiff-line-modified-removed">-         Asserts.assertTrue(recordedClass instanceof RecordedClass, &quot;Expected Recorded Class got &quot; + recordedClass);</span>
<span class="udiff-line-modified-added">+             Object recordedClass = event.getValue(&quot;clzField&quot;);</span>
<span class="udiff-line-modified-added">+             Asserts.assertTrue(recordedClass instanceof RecordedClass, &quot;Expected Recorded Class got &quot; + recordedClass);</span>
  
<span class="udiff-line-modified-removed">-         Object recordedInt = event.getValue(&quot;intField&quot;);</span>
<span class="udiff-line-modified-removed">-         Asserts.assertTrue(recordedInt instanceof Integer);</span>
<span class="udiff-line-modified-added">+             Object recordedInt = event.getValue(&quot;intField&quot;);</span>
<span class="udiff-line-modified-added">+             Asserts.assertTrue(recordedInt instanceof Integer);</span>
  
<span class="udiff-line-modified-removed">-         Object recordedString = event.getValue(&quot;stringField&quot;);</span>
<span class="udiff-line-modified-removed">-         System.out.println(&quot;recordedString class: &quot; + recordedString.getClass());</span>
<span class="udiff-line-modified-removed">-         Asserts.assertTrue(recordedString instanceof String);</span>
<span class="udiff-line-modified-added">+             Object recordedString = event.getValue(&quot;stringField&quot;);</span>
<span class="udiff-line-modified-added">+             System.out.println(&quot;recordedString class: &quot; + recordedString.getClass());</span>
<span class="udiff-line-modified-added">+             Asserts.assertTrue(recordedString instanceof String);</span>
  
<span class="udiff-line-modified-removed">-         Object myClass = event.getValue(&quot;myClass&quot;);</span>
<span class="udiff-line-modified-removed">-         Asserts.assertTrue(myClass instanceof RecordedClass, &quot;Expected Recorded Class got &quot; + recordedClass);</span>
<span class="udiff-line-modified-added">+             Object myClass = event.getValue(&quot;myClass&quot;);</span>
<span class="udiff-line-modified-added">+             Asserts.assertTrue(myClass instanceof RecordedClass, &quot;Expected Recorded Class got &quot; + recordedClass);</span>
  
<span class="udiff-line-modified-removed">-         RecordedClass myRecClass = (RecordedClass) myClass;</span>
<span class="udiff-line-modified-removed">-         Asserts.assertEquals(MyClass.class.getName(), myRecClass.getName(), &quot;Got &quot; + myRecClass.getName());</span>
<span class="udiff-line-modified-added">+             RecordedClass myRecClass = (RecordedClass) myClass;</span>
<span class="udiff-line-modified-added">+             Asserts.assertEquals(MyClass.class.getName(), myRecClass.getName(), &quot;Got &quot; + myRecClass.getName());</span>
  
<span class="udiff-line-modified-removed">-         Object recordedClassLoader = myRecClass.getValue(&quot;classLoader&quot;);</span>
<span class="udiff-line-modified-removed">-         Asserts.assertTrue(recordedClassLoader instanceof RecordedClassLoader, &quot;Expected Recorded ClassLoader got &quot; + recordedClassLoader);</span>
<span class="udiff-line-modified-added">+             Object recordedClassLoader = myRecClass.getValue(&quot;classLoader&quot;);</span>
<span class="udiff-line-modified-added">+             Asserts.assertTrue(recordedClassLoader instanceof RecordedClassLoader, &quot;Expected Recorded ClassLoader got &quot; + recordedClassLoader);</span>
  
<span class="udiff-line-modified-removed">-         RecordedClassLoader myRecClassLoader = (RecordedClassLoader)recordedClassLoader;</span>
<span class="udiff-line-modified-removed">-         ClassLoader cl = MyClass.class.getClassLoader();</span>
<span class="udiff-line-modified-removed">-         Asserts.assertEquals(cl.getClass().getName(), myRecClassLoader.getType().getName(), &quot;Expected Recorded ClassLoader type to equal loader type&quot;);</span>
<span class="udiff-line-modified-added">+             RecordedClassLoader myRecClassLoader = (RecordedClassLoader) recordedClassLoader;</span>
<span class="udiff-line-modified-added">+             ClassLoader cl = MyClass.class.getClassLoader();</span>
<span class="udiff-line-modified-added">+             Asserts.assertEquals(cl.getClass().getName(), myRecClassLoader.getType().getName(), &quot;Expected Recorded ClassLoader type to equal loader type&quot;);</span>
  
<span class="udiff-line-modified-removed">-         Asserts.assertNotNull(myRecClass.getModifiers());</span>
<span class="udiff-line-modified-added">+             Asserts.assertNotNull(myRecClass.getModifiers());</span>
<span class="udiff-line-added">+         }</span>
      }
<span class="udiff-line-removed">- </span>
  }
</pre>
<center><a href="TestRecordedClassLoader.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TestRecordedEventGetThread.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>