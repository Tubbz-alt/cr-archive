<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.lir.amd64/src/org/graalvm/compiler/lir/amd64/AMD64MathSinOp.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="AMD64MathPowOp.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="AMD64MathTanOp.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.lir.amd64/src/org/graalvm/compiler/lir/amd64/AMD64MathSinOp.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2018, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * Copyright (c) 2016, Intel Corporation. All rights reserved.
   * Intel Math Library (LIBM) Source Code
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2018, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * Copyright (c) 2016, Intel Corporation. All rights reserved.
   * Intel Math Library (LIBM) Source Code
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
</pre>
<hr />
<pre>
<span class="line-old-header">*** 456,12 ***</span>
          masm.movl(rax, new AMD64Address(rsp, 12));
          masm.movq(xmm1, recordExternalAddress(crb, pi32Inv));          // 0x6dc9c883, 0x40245f30
          masm.movq(xmm2, recordExternalAddress(crb, shifter));          // 0x00000000, 0x43380000
          masm.andl(rax, 2147418112);
          masm.subl(rax, 808452096);
<span class="line-modified">!         masm.cmpl(rax, 281346048);</span>
<span class="line-removed">-         masm.jcc(ConditionFlag.Above, block0);</span>
          masm.mulsd(xmm1, xmm0);
          masm.movdqu(xmm5, recordExternalAddress(crb, onehalf));        // 0x00000000, 0x3fe00000,
                                                                         // 0x00000000, 0x3fe00000
          masm.movq(xmm4, recordExternalAddress(crb, signMask));         // 0x00000000, 0x80000000
          masm.pand(xmm4, xmm0);
<span class="line-new-header">--- 456,11 ---</span>
          masm.movl(rax, new AMD64Address(rsp, 12));
          masm.movq(xmm1, recordExternalAddress(crb, pi32Inv));          // 0x6dc9c883, 0x40245f30
          masm.movq(xmm2, recordExternalAddress(crb, shifter));          // 0x00000000, 0x43380000
          masm.andl(rax, 2147418112);
          masm.subl(rax, 808452096);
<span class="line-modified">!         masm.cmplAndJcc(rax, 281346048, ConditionFlag.Above, block0, false);</span>
          masm.mulsd(xmm1, xmm0);
          masm.movdqu(xmm5, recordExternalAddress(crb, onehalf));        // 0x00000000, 0x3fe00000,
                                                                         // 0x00000000, 0x3fe00000
          masm.movq(xmm4, recordExternalAddress(crb, signMask));         // 0x00000000, 0x80000000
          masm.pand(xmm4, xmm0);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 547,12 ***</span>
          masm.jmp(block14);
  
          masm.bind(block0);
          masm.jcc(ConditionFlag.Greater, block1);
          masm.shrl(rax, 20);
<span class="line-modified">!         masm.cmpl(rax, 3325);</span>
<span class="line-removed">-         masm.jcc(ConditionFlag.NotEqual, block2);</span>
          masm.mulsd(xmm0, recordExternalAddress(crb, allOnes));         // 0xffffffff, 0x3fefffff
          masm.jmp(block14);
  
          masm.bind(block2);
          masm.movq(xmm3, recordExternalAddress(crb, twoPow55));         // 0x00000000, 0x43600000
<span class="line-new-header">--- 546,11 ---</span>
          masm.jmp(block14);
  
          masm.bind(block0);
          masm.jcc(ConditionFlag.Greater, block1);
          masm.shrl(rax, 20);
<span class="line-modified">!         masm.cmplAndJcc(rax, 3325, ConditionFlag.NotEqual, block2, false);</span>
          masm.mulsd(xmm0, recordExternalAddress(crb, allOnes));         // 0xffffffff, 0x3fefffff
          masm.jmp(block14);
  
          masm.bind(block2);
          masm.movq(xmm3, recordExternalAddress(crb, twoPow55));         // 0x00000000, 0x43600000
</pre>
<hr />
<pre>
<span class="line-old-header">*** 562,12 ***</span>
          masm.jmp(block14);
  
          masm.bind(block1);
          masm.pextrw(rax, xmm0, 3);
          masm.andl(rax, 32752);
<span class="line-modified">!         masm.cmpl(rax, 32752);</span>
<span class="line-removed">-         masm.jcc(ConditionFlag.Equal, block3);</span>
          masm.pextrw(rcx, xmm0, 3);
          masm.andl(rcx, 32752);
          masm.subl(rcx, 16224);
          masm.shrl(rcx, 7);
          masm.andl(rcx, 65532);
<span class="line-new-header">--- 560,11 ---</span>
          masm.jmp(block14);
  
          masm.bind(block1);
          masm.pextrw(rax, xmm0, 3);
          masm.andl(rax, 32752);
<span class="line-modified">!         masm.cmplAndJcc(rax, 32752, ConditionFlag.Equal, block3, false);</span>
          masm.pextrw(rcx, xmm0, 3);
          masm.andl(rcx, 32752);
          masm.subl(rcx, 16224);
          masm.shrl(rcx, 7);
          masm.andl(rcx, 65532);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 655,36 ***</span>
          masm.subl(rbx, 1023);
          masm.subl(rcx, rbx);
          masm.addq(r9, AMD64.rdx);
          masm.movl(rdx, rcx);
          masm.addl(rdx, 32);
<span class="line-modified">!         masm.cmpl(rcx, 1);</span>
<span class="line-removed">-         masm.jcc(ConditionFlag.Less, block4);</span>
          masm.negl(rcx);
          masm.addl(rcx, 29);
          masm.shll(r9);
          masm.movl(rdi, r9);
          masm.andl(r9, 536870911);
<span class="line-modified">!         masm.testl(r9, 268435456);</span>
<span class="line-removed">-         masm.jcc(ConditionFlag.NotEqual, block5);</span>
          masm.shrl(r9);
          masm.movl(rbx, 0);
          masm.shlq(r9, 32);
          masm.orq(r9, r11);
  
          masm.bind(block6);
  
          masm.bind(block7);
  
<span class="line-modified">!         masm.cmpq(r9, 0);</span>
<span class="line-removed">-         masm.jcc(ConditionFlag.Equal, block8);</span>
  
          masm.bind(block9);
          masm.bsrq(r11, r9);
          masm.movl(rcx, 29);
<span class="line-modified">!         masm.subl(rcx, r11);</span>
<span class="line-removed">-         masm.jcc(ConditionFlag.LessEqual, block10);</span>
          masm.shlq(r9);
          masm.movq(AMD64.rax, r10);
          masm.shlq(r10);
          masm.addl(rdx, rcx);
          masm.negl(rcx);
<span class="line-new-header">--- 652,32 ---</span>
          masm.subl(rbx, 1023);
          masm.subl(rcx, rbx);
          masm.addq(r9, AMD64.rdx);
          masm.movl(rdx, rcx);
          masm.addl(rdx, 32);
<span class="line-modified">!         masm.cmplAndJcc(rcx, 1, ConditionFlag.Less, block4, false);</span>
          masm.negl(rcx);
          masm.addl(rcx, 29);
          masm.shll(r9);
          masm.movl(rdi, r9);
          masm.andl(r9, 536870911);
<span class="line-modified">!         masm.testlAndJcc(r9, 268435456, ConditionFlag.NotEqual, block5, false);</span>
          masm.shrl(r9);
          masm.movl(rbx, 0);
          masm.shlq(r9, 32);
          masm.orq(r9, r11);
  
          masm.bind(block6);
  
          masm.bind(block7);
  
<span class="line-modified">!         masm.cmpqAndJcc(r9, 0, ConditionFlag.Equal, block8, false);</span>
  
          masm.bind(block9);
          masm.bsrq(r11, r9);
          masm.movl(rcx, 29);
<span class="line-modified">!         masm.sublAndJcc(rcx, r11, ConditionFlag.LessEqual, block10, false);</span>
          masm.shlq(r9);
          masm.movq(AMD64.rax, r10);
          masm.shlq(r10);
          masm.addl(rdx, rcx);
          masm.negl(rcx);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 815,17 ***</span>
          masm.bind(block8);
          masm.addl(rdx, 64);
          masm.movq(r9, r10);
          masm.movq(r10, r8);
          masm.movl(r8, 0);
<span class="line-modified">!         masm.cmpq(r9, 0);</span>
<span class="line-removed">-         masm.jcc(ConditionFlag.NotEqual, block9);</span>
          masm.addl(rdx, 64);
          masm.movq(r9, r10);
          masm.movq(r10, r8);
<span class="line-modified">!         masm.cmpq(r9, 0);</span>
<span class="line-removed">-         masm.jcc(ConditionFlag.NotEqual, block9);</span>
          masm.xorpd(xmm0, xmm0);
          masm.xorpd(xmm6, xmm6);
          masm.jmp(block12);
  
          masm.bind(block10);
<span class="line-new-header">--- 808,15 ---</span>
          masm.bind(block8);
          masm.addl(rdx, 64);
          masm.movq(r9, r10);
          masm.movq(r10, r8);
          masm.movl(r8, 0);
<span class="line-modified">!         masm.cmpqAndJcc(r9, 0, ConditionFlag.NotEqual, block9, false);</span>
          masm.addl(rdx, 64);
          masm.movq(r9, r10);
          masm.movq(r10, r8);
<span class="line-modified">!         masm.cmpqAndJcc(r9, 0, ConditionFlag.NotEqual, block9, false);</span>
          masm.xorpd(xmm0, xmm0);
          masm.xorpd(xmm6, xmm6);
          masm.jmp(block12);
  
          masm.bind(block10);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 845,12 ***</span>
          masm.negl(rcx);
          masm.shlq(r9, 32);
          masm.orq(r9, r11);
          masm.shlq(r9);
          masm.movq(rdi, r9);
<span class="line-modified">!         masm.testl(r9, Integer.MIN_VALUE);</span>
<span class="line-removed">-         masm.jcc(ConditionFlag.NotEqual, block13);</span>
          masm.shrl(r9);
          masm.movl(rbx, 0);
          masm.shrq(rdi, 3);
          masm.jmp(block7);
  
<span class="line-new-header">--- 836,11 ---</span>
          masm.negl(rcx);
          masm.shlq(r9, 32);
          masm.orq(r9, r11);
          masm.shlq(r9);
          masm.movq(rdi, r9);
<span class="line-modified">!         masm.testlAndJcc(r9, Integer.MIN_VALUE, ConditionFlag.NotEqual, block13, false);</span>
          masm.shrl(r9);
          masm.movl(rbx, 0);
          masm.shrq(rdi, 3);
          masm.jmp(block7);
  
</pre>
<center><a href="AMD64MathPowOp.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="AMD64MathTanOp.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>