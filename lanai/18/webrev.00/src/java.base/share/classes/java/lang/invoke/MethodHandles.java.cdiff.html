<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/java/lang/invoke/MethodHandles.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="MethodHandleInfo.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="MethodType.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/lang/invoke/MethodHandles.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2008, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2008, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 316,11 ***</span>
       * &lt;h2&gt;&lt;a id=&quot;lookups&quot;&gt;&lt;/a&gt;Lookup Factory Methods&lt;/h2&gt;
       * The factory methods on a {@code Lookup} object correspond to all major
       * use cases for methods, constructors, and fields.
       * Each method handle created by a factory method is the functional
       * equivalent of a particular &lt;em&gt;bytecode behavior&lt;/em&gt;.
<span class="line-modified">!      * (Bytecode behaviors are described in section 5.4.3.5 of the Java Virtual Machine Specification.)</span>
       * Here is a summary of the correspondence between these factory methods and
       * the behavior of the resulting method handles:
       * &lt;table class=&quot;striped&quot;&gt;
       * &lt;caption style=&quot;display:none&quot;&gt;lookup method behaviors&lt;/caption&gt;
       * &lt;thead&gt;
<span class="line-new-header">--- 316,12 ---</span>
       * &lt;h2&gt;&lt;a id=&quot;lookups&quot;&gt;&lt;/a&gt;Lookup Factory Methods&lt;/h2&gt;
       * The factory methods on a {@code Lookup} object correspond to all major
       * use cases for methods, constructors, and fields.
       * Each method handle created by a factory method is the functional
       * equivalent of a particular &lt;em&gt;bytecode behavior&lt;/em&gt;.
<span class="line-modified">!      * (Bytecode behaviors are described in section {@jvms 5.4.3.5} of</span>
<span class="line-added">+      * the Java Virtual Machine Specification.)</span>
       * Here is a summary of the correspondence between these factory methods and
       * the behavior of the resulting method handles:
       * &lt;table class=&quot;striped&quot;&gt;
       * &lt;caption style=&quot;display:none&quot;&gt;lookup method behaviors&lt;/caption&gt;
       * &lt;thead&gt;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 500,11 ***</span>
       * independently of any {@code Lookup} object.
       * &lt;p&gt;
       * If the desired member is {@code protected}, the usual JVM rules apply,
       * including the requirement that the lookup class must either be in the
       * same package as the desired member, or must inherit that member.
<span class="line-modified">!      * (See the Java Virtual Machine Specification, sections 4.9.2, 5.4.3.5, and 6.4.)</span>
       * In addition, if the desired member is a non-static field or method
       * in a different package, the resulting method handle may only be applied
       * to objects of the lookup class or one of its subclasses.
       * This requirement is enforced by narrowing the type of the leading
       * {@code this} parameter from {@code C}
<span class="line-new-header">--- 501,12 ---</span>
       * independently of any {@code Lookup} object.
       * &lt;p&gt;
       * If the desired member is {@code protected}, the usual JVM rules apply,
       * including the requirement that the lookup class must either be in the
       * same package as the desired member, or must inherit that member.
<span class="line-modified">!      * (See the Java Virtual Machine Specification, sections {@jvms</span>
<span class="line-added">+      * 4.9.2}, {@jvms 5.4.3.5}, and {@jvms 6.4}.)</span>
       * In addition, if the desired member is a non-static field or method
       * in a different package, the resulting method handle may only be applied
       * to objects of the lookup class or one of its subclasses.
       * This requirement is enforced by narrowing the type of the leading
       * {@code this} parameter from {@code C}
</pre>
<hr />
<pre>
<span class="line-old-header">*** 513,21 ***</span>
       * &lt;p&gt;
       * The JVM imposes a similar requirement on {@code invokespecial} instruction,
       * that the receiver argument must match both the resolved method &lt;em&gt;and&lt;/em&gt;
       * the current class.  Again, this requirement is enforced by narrowing the
       * type of the leading parameter to the resulting method handle.
<span class="line-modified">!      * (See the Java Virtual Machine Specification, section 4.10.1.9.)</span>
       * &lt;p&gt;
       * The JVM represents constructors and static initializer blocks as internal methods
       * with special names ({@code &quot;&lt;init&gt;&quot;} and {@code &quot;&lt;clinit&gt;&quot;}).
       * The internal syntax of invocation instructions allows them to refer to such internal
       * methods as if they were normal methods, but the JVM bytecode verifier rejects them.
       * A lookup of such an internal method will produce a {@code NoSuchMethodException}.
       * &lt;p&gt;
       * If the relationship between nested types is expressed directly through the
       * {@code NestHost} and {@code NestMembers} attributes
<span class="line-modified">!      * (see the Java Virtual Machine Specification, sections 4.7.28 and 4.7.29),</span>
       * then the associated {@code Lookup} object provides direct access to
       * the lookup class and all of its nestmates
       * (see {@link java.lang.Class#getNestHost Class.getNestHost}).
       * Otherwise, access between nested classes is obtained by the Java compiler creating
       * a wrapper method to access a private method of another class in the same nest.
<span class="line-new-header">--- 515,22 ---</span>
       * &lt;p&gt;
       * The JVM imposes a similar requirement on {@code invokespecial} instruction,
       * that the receiver argument must match both the resolved method &lt;em&gt;and&lt;/em&gt;
       * the current class.  Again, this requirement is enforced by narrowing the
       * type of the leading parameter to the resulting method handle.
<span class="line-modified">!      * (See the Java Virtual Machine Specification, section {@jmvs 4.10.1.9}.)</span>
       * &lt;p&gt;
       * The JVM represents constructors and static initializer blocks as internal methods
       * with special names ({@code &quot;&lt;init&gt;&quot;} and {@code &quot;&lt;clinit&gt;&quot;}).
       * The internal syntax of invocation instructions allows them to refer to such internal
       * methods as if they were normal methods, but the JVM bytecode verifier rejects them.
       * A lookup of such an internal method will produce a {@code NoSuchMethodException}.
       * &lt;p&gt;
       * If the relationship between nested types is expressed directly through the
       * {@code NestHost} and {@code NestMembers} attributes
<span class="line-modified">!      * (see the Java Virtual Machine Specification, sections {@jvms</span>
<span class="line-added">+      * 4.7.28} and {@jvms 4.7.29}),</span>
       * then the associated {@code Lookup} object provides direct access to
       * the lookup class and all of its nestmates
       * (see {@link java.lang.Class#getNestHost Class.getNestHost}).
       * Otherwise, access between nested classes is obtained by the Java compiler creating
       * a wrapper method to access a private method of another class in the same nest.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 735,15 ***</span>
       * &lt;h2&gt;&lt;a id=&quot;access-modes&quot;&gt;&lt;/a&gt;Access modes&lt;/h2&gt;
       *
       * The table below shows the access modes of a {@code Lookup} produced by
       * any of the following factory or transformation methods:
       * &lt;ul&gt;
<span class="line-modified">!      * &lt;li&gt;{@link #lookup() MethodHandles.lookup()}&lt;/li&gt;</span>
<span class="line-modified">!      * &lt;li&gt;{@link #publicLookup() MethodHandles.publicLookup()}&lt;/li&gt;</span>
<span class="line-modified">!      * &lt;li&gt;{@link #privateLookupIn(Class, Lookup) MethodHandles.privateLookupIn}&lt;/li&gt;</span>
<span class="line-modified">!      * &lt;li&gt;{@link Lookup#in}&lt;/li&gt;</span>
<span class="line-modified">!      * &lt;li&gt;{@link Lookup#dropLookupMode(int)}&lt;/li&gt;</span>
       * &lt;/ul&gt;
       *
       * &lt;table class=&quot;striped&quot;&gt;
       * &lt;caption style=&quot;display:none&quot;&gt;
       * Access mode summary
<span class="line-new-header">--- 738,15 ---</span>
       * &lt;h2&gt;&lt;a id=&quot;access-modes&quot;&gt;&lt;/a&gt;Access modes&lt;/h2&gt;
       *
       * The table below shows the access modes of a {@code Lookup} produced by
       * any of the following factory or transformation methods:
       * &lt;ul&gt;
<span class="line-modified">!      * &lt;li&gt;{@link #lookup() MethodHandles::lookup}&lt;/li&gt;</span>
<span class="line-modified">!      * &lt;li&gt;{@link #publicLookup() MethodHandles::publicLookup}&lt;/li&gt;</span>
<span class="line-modified">!      * &lt;li&gt;{@link #privateLookupIn(Class, Lookup) MethodHandles::privateLookupIn}&lt;/li&gt;</span>
<span class="line-modified">!      * &lt;li&gt;{@link Lookup#in Lookup::in}&lt;/li&gt;</span>
<span class="line-modified">!      * &lt;li&gt;{@link Lookup#dropLookupMode(int) Lookup::dropLookupMode}&lt;/li&gt;</span>
       * &lt;/ul&gt;
       *
       * &lt;table class=&quot;striped&quot;&gt;
       * &lt;caption style=&quot;display:none&quot;&gt;
       * Access mode summary
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1519,18 ***</span>
  
          /**
           * Creates a lookup on the same lookup class which this lookup object
           * finds members, but with a lookup mode that has lost the given lookup mode.
           * The lookup mode to drop is one of {@link #PUBLIC PUBLIC}, {@link #MODULE
<span class="line-modified">!          * MODULE}, {@link #PACKAGE PACKAGE}, {@link #PROTECTED PROTECTED} or {@link #PRIVATE PRIVATE}.</span>
<span class="line-modified">!          * {@link #PROTECTED PROTECTED} is always</span>
<span class="line-modified">!          * dropped and so the resulting lookup mode will never have this access capability.</span>
<span class="line-modified">!          * When dropping {@code PACKAGE} then the resulting lookup will not have {@code PACKAGE}</span>
<span class="line-modified">!          * or {@code PRIVATE} access. When dropping {@code MODULE} then the resulting lookup will</span>
<span class="line-modified">!          * not have {@code MODULE}, {@code PACKAGE}, or {@code PRIVATE} access. If {@code PUBLIC}</span>
<span class="line-modified">!          * is dropped then the resulting lookup has no access. If {@code UNCONDITIONAL}</span>
<span class="line-modified">!          * is dropped then the resulting lookup has no access.</span>
           *
           * @apiNote
           * A lookup with {@code PACKAGE} but not {@code PRIVATE} mode can safely
           * delegate non-public access within the package of the lookup class without
           * conferring  &lt;a href=&quot;MethodHandles.Lookup.html#privacc&quot;&gt;private access&lt;/a&gt;.
<span class="line-new-header">--- 1522,26 ---</span>
  
          /**
           * Creates a lookup on the same lookup class which this lookup object
           * finds members, but with a lookup mode that has lost the given lookup mode.
           * The lookup mode to drop is one of {@link #PUBLIC PUBLIC}, {@link #MODULE
<span class="line-modified">!          * MODULE}, {@link #PACKAGE PACKAGE}, {@link #PROTECTED PROTECTED},</span>
<span class="line-modified">!          * {@link #PRIVATE PRIVATE}, or {@link #UNCONDITIONAL UNCONDITIONAL}.</span>
<span class="line-modified">!          *</span>
<span class="line-modified">!          * &lt;p&gt; If this lookup is a {@linkplain MethodHandles#publicLookup() public lookup},</span>
<span class="line-modified">!          * this lookup has {@code UNCONDITIONAL} mode set and it has no other mode set.</span>
<span class="line-modified">!          * When dropping {@code UNCONDITIONAL} on a public lookup then the resulting</span>
<span class="line-modified">!          * lookup has no access.</span>
<span class="line-modified">!          *</span>
<span class="line-added">+          * &lt;p&gt; If this lookup is not a public lookup, then the following applies</span>
<span class="line-added">+          * regardless of its {@linkplain #lookupModes() lookup modes}.</span>
<span class="line-added">+          * {@link #PROTECTED PROTECTED} is always dropped and so the resulting lookup</span>
<span class="line-added">+          * mode will never have this access capability. When dropping {@code PACKAGE}</span>
<span class="line-added">+          * then the resulting lookup will not have {@code PACKAGE} or {@code PRIVATE}</span>
<span class="line-added">+          * access. When dropping {@code MODULE} then the resulting lookup will not</span>
<span class="line-added">+          * have {@code MODULE}, {@code PACKAGE}, or {@code PRIVATE} access.</span>
<span class="line-added">+          * When dropping {@code PUBLIC} then the resulting lookup has no access.</span>
           *
           * @apiNote
           * A lookup with {@code PACKAGE} but not {@code PRIVATE} mode can safely
           * delegate non-public access within the package of the lookup class without
           * conferring  &lt;a href=&quot;MethodHandles.Lookup.html#privacc&quot;&gt;private access&lt;/a&gt;.
</pre>
<center><a href="MethodHandleInfo.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="MethodType.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>