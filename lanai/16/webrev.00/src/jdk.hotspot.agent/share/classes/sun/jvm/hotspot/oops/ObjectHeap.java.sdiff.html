<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/oops/ObjectHeap.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MethodData.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="Symbol.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/oops/ObjectHeap.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
216   private void iterateSubtypes(HeapVisitor visitor, final Klass k) {
217     iterateLiveRegions(collectLiveRegions(), visitor, new ObjectFilter() {
218           public boolean canInclude(Oop obj) {
219             Klass tk = obj.getKlass();
220             // null Klass is seen sometimes!
221             return (tk != null &amp;&amp; tk.isSubtypeOf(k));
222           }
223         });
224   }
225 
226   private void iterateLiveRegions(List liveRegions, HeapVisitor visitor, ObjectFilter of) {
227     // Summarize size
228     long totalSize = 0;
229     for (int i = 0; i &lt; liveRegions.size(); i += 2) {
230       Address bottom = (Address) liveRegions.get(i);
231       Address top    = (Address) liveRegions.get(i+1);
232       totalSize += top.minus(bottom);
233     }
234     visitor.prologue(totalSize);
235 
<span class="line-removed">236     CollectedHeap heap = VM.getVM().getUniverse().heap();</span>
<span class="line-removed">237 </span>
<span class="line-removed">238     if (heap instanceof GenCollectedHeap) {</span>
<span class="line-removed">239       GenCollectedHeap genHeap = (GenCollectedHeap) heap;</span>
<span class="line-removed">240       Generation genOld = genHeap.getGen(1);</span>
<span class="line-removed">241     }</span>
<span class="line-removed">242 </span>
243     for (int i = 0; i &lt; liveRegions.size(); i += 2) {
244       Address bottom = (Address) liveRegions.get(i);
245       Address top    = (Address) liveRegions.get(i+1);
246 
247       try {
248         // Traverses the space from bottom to top
249         OopHandle handle = bottom.addOffsetToAsOopHandle(0);
250 
251         while (handle.lessThan(top)) {
252           Oop obj = null;
253 
254           try {
255             obj = newOop(handle);
256           } catch (UnknownOopException exp) {
257             if (DEBUG) {
258               throw new RuntimeException(&quot; UnknownOopException  &quot; + exp);
259             }
260           }
261           if (obj == null) {
262               throw new UnknownOopException();
</pre>
</td>
<td>
<hr />
<pre>
216   private void iterateSubtypes(HeapVisitor visitor, final Klass k) {
217     iterateLiveRegions(collectLiveRegions(), visitor, new ObjectFilter() {
218           public boolean canInclude(Oop obj) {
219             Klass tk = obj.getKlass();
220             // null Klass is seen sometimes!
221             return (tk != null &amp;&amp; tk.isSubtypeOf(k));
222           }
223         });
224   }
225 
226   private void iterateLiveRegions(List liveRegions, HeapVisitor visitor, ObjectFilter of) {
227     // Summarize size
228     long totalSize = 0;
229     for (int i = 0; i &lt; liveRegions.size(); i += 2) {
230       Address bottom = (Address) liveRegions.get(i);
231       Address top    = (Address) liveRegions.get(i+1);
232       totalSize += top.minus(bottom);
233     }
234     visitor.prologue(totalSize);
235 







236     for (int i = 0; i &lt; liveRegions.size(); i += 2) {
237       Address bottom = (Address) liveRegions.get(i);
238       Address top    = (Address) liveRegions.get(i+1);
239 
240       try {
241         // Traverses the space from bottom to top
242         OopHandle handle = bottom.addOffsetToAsOopHandle(0);
243 
244         while (handle.lessThan(top)) {
245           Oop obj = null;
246 
247           try {
248             obj = newOop(handle);
249           } catch (UnknownOopException exp) {
250             if (DEBUG) {
251               throw new RuntimeException(&quot; UnknownOopException  &quot; + exp);
252             }
253           }
254           if (obj == null) {
255               throw new UnknownOopException();
</pre>
</td>
</tr>
</table>
<center><a href="MethodData.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="Symbol.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>