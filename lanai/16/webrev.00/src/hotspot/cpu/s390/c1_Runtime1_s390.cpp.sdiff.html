<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/cpu/s390/c1_Runtime1_s390.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="c1_LIRGenerator_s390.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="c1_globals_s390.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/s390/c1_Runtime1_s390.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 21  * or visit www.oracle.com if you need additional information or have any
 22  * questions.
 23  *
 24  */
 25 
 26 #include &quot;precompiled.hpp&quot;
 27 #include &quot;asm/macroAssembler.inline.hpp&quot;
 28 #include &quot;c1/c1_Defs.hpp&quot;
 29 #include &quot;c1/c1_MacroAssembler.hpp&quot;
 30 #include &quot;c1/c1_Runtime1.hpp&quot;
 31 #include &quot;ci/ciUtilities.hpp&quot;
 32 #include &quot;gc/shared/cardTable.hpp&quot;
 33 #include &quot;gc/shared/cardTableBarrierSet.hpp&quot;
 34 #include &quot;interpreter/interpreter.hpp&quot;
 35 #include &quot;memory/universe.hpp&quot;
 36 #include &quot;nativeInst_s390.hpp&quot;
 37 #include &quot;oops/compiledICHolder.hpp&quot;
 38 #include &quot;oops/oop.inline.hpp&quot;
 39 #include &quot;prims/jvmtiExport.hpp&quot;
 40 #include &quot;register_s390.hpp&quot;

 41 #include &quot;runtime/sharedRuntime.hpp&quot;
 42 #include &quot;runtime/signature.hpp&quot;
 43 #include &quot;runtime/vframeArray.hpp&quot;
 44 #include &quot;utilities/macros.hpp&quot;

 45 #include &quot;vmreg_s390.inline.hpp&quot;
<span class="line-removed"> 46 #include &quot;registerSaver_s390.hpp&quot;</span>
 47 
 48 // Implementation of StubAssembler
 49 
 50 int StubAssembler::call_RT(Register oop_result1, Register metadata_result, address entry_point, int number_of_arguments) {
 51   set_num_rt_args(0); // Nothing on stack.
 52   assert(!(oop_result1-&gt;is_valid() || metadata_result-&gt;is_valid()) || oop_result1 != metadata_result, &quot;registers must be different&quot;);
 53 
 54   // We cannot trust that code generated by the C++ compiler saves R14
 55   // to z_abi_160.return_pc, because sometimes it spills R14 using stmg at
 56   // z_abi_160.gpr14 (e.g. InterpreterRuntime::_new()).
 57   // Therefore we load the PC into Z_R1_scratch and let set_last_Java_frame() save
 58   // it into the frame anchor.
 59   address pc = get_PC(Z_R1_scratch);
 60   int call_offset = (int)(pc - addr_at(0));
 61   set_last_Java_frame(Z_SP, Z_R1_scratch);
 62 
 63   // ARG1 must hold thread address.
 64   z_lgr(Z_ARG1, Z_thread);
 65 
 66   address return_pc = NULL;
</pre>
</td>
<td>
<hr />
<pre>
 21  * or visit www.oracle.com if you need additional information or have any
 22  * questions.
 23  *
 24  */
 25 
 26 #include &quot;precompiled.hpp&quot;
 27 #include &quot;asm/macroAssembler.inline.hpp&quot;
 28 #include &quot;c1/c1_Defs.hpp&quot;
 29 #include &quot;c1/c1_MacroAssembler.hpp&quot;
 30 #include &quot;c1/c1_Runtime1.hpp&quot;
 31 #include &quot;ci/ciUtilities.hpp&quot;
 32 #include &quot;gc/shared/cardTable.hpp&quot;
 33 #include &quot;gc/shared/cardTableBarrierSet.hpp&quot;
 34 #include &quot;interpreter/interpreter.hpp&quot;
 35 #include &quot;memory/universe.hpp&quot;
 36 #include &quot;nativeInst_s390.hpp&quot;
 37 #include &quot;oops/compiledICHolder.hpp&quot;
 38 #include &quot;oops/oop.inline.hpp&quot;
 39 #include &quot;prims/jvmtiExport.hpp&quot;
 40 #include &quot;register_s390.hpp&quot;
<span class="line-added"> 41 #include &quot;registerSaver_s390.hpp&quot;</span>
 42 #include &quot;runtime/sharedRuntime.hpp&quot;
 43 #include &quot;runtime/signature.hpp&quot;
 44 #include &quot;runtime/vframeArray.hpp&quot;
 45 #include &quot;utilities/macros.hpp&quot;
<span class="line-added"> 46 #include &quot;utilities/powerOfTwo.hpp&quot;</span>
 47 #include &quot;vmreg_s390.inline.hpp&quot;

 48 
 49 // Implementation of StubAssembler
 50 
 51 int StubAssembler::call_RT(Register oop_result1, Register metadata_result, address entry_point, int number_of_arguments) {
 52   set_num_rt_args(0); // Nothing on stack.
 53   assert(!(oop_result1-&gt;is_valid() || metadata_result-&gt;is_valid()) || oop_result1 != metadata_result, &quot;registers must be different&quot;);
 54 
 55   // We cannot trust that code generated by the C++ compiler saves R14
 56   // to z_abi_160.return_pc, because sometimes it spills R14 using stmg at
 57   // z_abi_160.gpr14 (e.g. InterpreterRuntime::_new()).
 58   // Therefore we load the PC into Z_R1_scratch and let set_last_Java_frame() save
 59   // it into the frame anchor.
 60   address pc = get_PC(Z_R1_scratch);
 61   int call_offset = (int)(pc - addr_at(0));
 62   set_last_Java_frame(Z_SP, Z_R1_scratch);
 63 
 64   // ARG1 must hold thread address.
 65   z_lgr(Z_ARG1, Z_thread);
 66 
 67   address return_pc = NULL;
</pre>
</td>
</tr>
</table>
<center><a href="c1_LIRGenerator_s390.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="c1_globals_s390.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>