<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/opto/graphKit.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="graphKit.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="idealGraphPrinter.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/opto/graphKit.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
808   // Helper functions to build synchronizations
809   int next_monitor();
810   Node* insert_mem_bar(int opcode, Node* precedent = NULL);
811   Node* insert_mem_bar_volatile(int opcode, int alias_idx, Node* precedent = NULL);
812   // Optional &#39;precedent&#39; is appended as an extra edge, to force ordering.
813   FastLockNode* shared_lock(Node* obj);
814   void shared_unlock(Node* box, Node* obj);
815 
816   // helper functions for the fast path/slow path idioms
817   Node* fast_and_slow(Node* in, const Type *result_type, Node* null_result, IfNode* fast_test, Node* fast_result, address slow_call, const TypeFunc *slow_call_type, Node* slow_arg, Klass* ex_klass, Node* slow_result);
818 
819   // Generate an instance-of idiom.  Used by both the instance-of bytecode
820   // and the reflective instance-of call.
821   Node* gen_instanceof(Node *subobj, Node* superkls, bool safe_for_replace = false);
822 
823   // Generate a check-cast idiom.  Used by both the check-cast bytecode
824   // and the array-store bytecode
825   Node* gen_checkcast( Node *subobj, Node* superkls,
826                        Node* *failure_control = NULL );
827 
<span class="line-modified">828   Node* gen_subtype_check(Node* subklass, Node* superklass) {</span>
<span class="line-removed">829     MergeMemNode* mem = merged_memory();</span>
<span class="line-removed">830     Node* ctrl = control();</span>
<span class="line-removed">831     Node* n = Phase::gen_subtype_check(subklass, superklass, &amp;ctrl, mem, &amp;_gvn);</span>
<span class="line-removed">832     set_control(ctrl);</span>
<span class="line-removed">833     return n;</span>
<span class="line-removed">834   }</span>
835 
836   // Exact type check used for predicted calls and casts.
837   // Rewrites (*casted_receiver) to be casted to the stronger type.
838   // (Caller is responsible for doing replace_in_map.)
839   Node* type_check_receiver(Node* receiver, ciKlass* klass, float prob,
840                             Node* *casted_receiver);
841 
842   // Inexact type check used for predicted calls.
843   Node* subtype_check_receiver(Node* receiver, ciKlass* klass,
844                                Node** casted_receiver);
845 
846   // implementation of object creation
847   Node* set_output_for_allocation(AllocateNode* alloc,
848                                   const TypeOopPtr* oop_type,
849                                   bool deoptimize_on_exception=false);
850   Node* get_layout_helper(Node* klass_node, jint&amp; constant_value);
851   Node* new_instance(Node* klass_node,
852                      Node* slow_test = NULL,
853                      Node* *return_size_val = NULL,
854                      bool deoptimize_on_exception = false);
</pre>
<hr />
<pre>
867   void inflate_string(Node* src, Node* dst, const TypeAryPtr* dst_type, Node* count);
868   void inflate_string_slow(Node* src, Node* dst, Node* start, Node* count);
869 
870   // Handy for making control flow
871   IfNode* create_and_map_if(Node* ctrl, Node* tst, float prob, float cnt) {
872     IfNode* iff = new IfNode(ctrl, tst, prob, cnt);// New IfNode&#39;s
873     _gvn.set_type(iff, iff-&gt;Value(&amp;_gvn)); // Value may be known at parse-time
874     // Place &#39;if&#39; on worklist if it will be in graph
875     if (!tst-&gt;is_Con())  record_for_igvn(iff);     // Range-check and Null-check removal is later
876     return iff;
877   }
878 
879   IfNode* create_and_xform_if(Node* ctrl, Node* tst, float prob, float cnt) {
880     IfNode* iff = new IfNode(ctrl, tst, prob, cnt);// New IfNode&#39;s
881     _gvn.transform(iff);                           // Value may be known at parse-time
882     // Place &#39;if&#39; on worklist if it will be in graph
883     if (!tst-&gt;is_Con())  record_for_igvn(iff);     // Range-check and Null-check removal is later
884     return iff;
885   }
886 
<span class="line-modified">887   // Insert a loop predicate into the graph</span>
<span class="line-modified">888   void add_predicate(int nargs = 0);</span>
<span class="line-removed">889   void add_predicate_impl(Deoptimization::DeoptReason reason, int nargs);</span>
890 
891   Node* make_constant_from_field(ciField* field, Node* obj);
892 };
893 
894 // Helper class to support building of control flow branches. Upon
895 // creation the map and sp at bci are cloned and restored upon de-
896 // struction. Typical use:
897 //
898 // { PreserveJVMState pjvms(this);
899 //   // code of new branch
900 // }
901 // // here the JVM state at bci is established
902 
903 class PreserveJVMState: public StackObj {
904  protected:
905   GraphKit*      _kit;
906 #ifdef ASSERT
907   int            _block;  // PO of current block, if a Parse
908   int            _bci;
909 #endif
</pre>
</td>
<td>
<hr />
<pre>
808   // Helper functions to build synchronizations
809   int next_monitor();
810   Node* insert_mem_bar(int opcode, Node* precedent = NULL);
811   Node* insert_mem_bar_volatile(int opcode, int alias_idx, Node* precedent = NULL);
812   // Optional &#39;precedent&#39; is appended as an extra edge, to force ordering.
813   FastLockNode* shared_lock(Node* obj);
814   void shared_unlock(Node* box, Node* obj);
815 
816   // helper functions for the fast path/slow path idioms
817   Node* fast_and_slow(Node* in, const Type *result_type, Node* null_result, IfNode* fast_test, Node* fast_result, address slow_call, const TypeFunc *slow_call_type, Node* slow_arg, Klass* ex_klass, Node* slow_result);
818 
819   // Generate an instance-of idiom.  Used by both the instance-of bytecode
820   // and the reflective instance-of call.
821   Node* gen_instanceof(Node *subobj, Node* superkls, bool safe_for_replace = false);
822 
823   // Generate a check-cast idiom.  Used by both the check-cast bytecode
824   // and the array-store bytecode
825   Node* gen_checkcast( Node *subobj, Node* superkls,
826                        Node* *failure_control = NULL );
827 
<span class="line-modified">828   Node* gen_subtype_check(Node* obj, Node* superklass);</span>






829 
830   // Exact type check used for predicted calls and casts.
831   // Rewrites (*casted_receiver) to be casted to the stronger type.
832   // (Caller is responsible for doing replace_in_map.)
833   Node* type_check_receiver(Node* receiver, ciKlass* klass, float prob,
834                             Node* *casted_receiver);
835 
836   // Inexact type check used for predicted calls.
837   Node* subtype_check_receiver(Node* receiver, ciKlass* klass,
838                                Node** casted_receiver);
839 
840   // implementation of object creation
841   Node* set_output_for_allocation(AllocateNode* alloc,
842                                   const TypeOopPtr* oop_type,
843                                   bool deoptimize_on_exception=false);
844   Node* get_layout_helper(Node* klass_node, jint&amp; constant_value);
845   Node* new_instance(Node* klass_node,
846                      Node* slow_test = NULL,
847                      Node* *return_size_val = NULL,
848                      bool deoptimize_on_exception = false);
</pre>
<hr />
<pre>
861   void inflate_string(Node* src, Node* dst, const TypeAryPtr* dst_type, Node* count);
862   void inflate_string_slow(Node* src, Node* dst, Node* start, Node* count);
863 
864   // Handy for making control flow
865   IfNode* create_and_map_if(Node* ctrl, Node* tst, float prob, float cnt) {
866     IfNode* iff = new IfNode(ctrl, tst, prob, cnt);// New IfNode&#39;s
867     _gvn.set_type(iff, iff-&gt;Value(&amp;_gvn)); // Value may be known at parse-time
868     // Place &#39;if&#39; on worklist if it will be in graph
869     if (!tst-&gt;is_Con())  record_for_igvn(iff);     // Range-check and Null-check removal is later
870     return iff;
871   }
872 
873   IfNode* create_and_xform_if(Node* ctrl, Node* tst, float prob, float cnt) {
874     IfNode* iff = new IfNode(ctrl, tst, prob, cnt);// New IfNode&#39;s
875     _gvn.transform(iff);                           // Value may be known at parse-time
876     // Place &#39;if&#39; on worklist if it will be in graph
877     if (!tst-&gt;is_Con())  record_for_igvn(iff);     // Range-check and Null-check removal is later
878     return iff;
879   }
880 
<span class="line-modified">881   void add_empty_predicates(int nargs = 0);</span>
<span class="line-modified">882   void add_empty_predicate_impl(Deoptimization::DeoptReason reason, int nargs);</span>

883 
884   Node* make_constant_from_field(ciField* field, Node* obj);
885 };
886 
887 // Helper class to support building of control flow branches. Upon
888 // creation the map and sp at bci are cloned and restored upon de-
889 // struction. Typical use:
890 //
891 // { PreserveJVMState pjvms(this);
892 //   // code of new branch
893 // }
894 // // here the JVM state at bci is established
895 
896 class PreserveJVMState: public StackObj {
897  protected:
898   GraphKit*      _kit;
899 #ifdef ASSERT
900   int            _block;  // PO of current block, if a Parse
901   int            _bci;
902 #endif
</pre>
</td>
</tr>
</table>
<center><a href="graphKit.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="idealGraphPrinter.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>