<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/macosx/native/libawt_lwawt/java2d/metal/MTLUtils.m</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="MTLBlitLoops.m.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>src/java.desktop/macosx/native/libawt_lwawt/java2d/metal/MTLUtils.m</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 1 #include &quot;MTLUtils.h&quot;
 2 
 3 #include &lt;jni.h&gt;
 4 #include &lt;simd/simd.h&gt;


 5 #include &quot;common.h&quot;
 6 #include &quot;Trace.h&quot;
 7 
 8 extern void J2dTraceImpl(int level, jboolean cr, const char *string, ...);
 9 void J2dTraceTraceVector(simd_float4 pt) {
10     J2dTraceImpl(J2D_TRACE_VERBOSE, JNI_FALSE, &quot;[%lf %lf %lf %lf]&quot;, pt.x, pt.y, pt.z, pt.w);
11 }
12 
13 void checkTransform(float * position, simd_float4x4 transform4x4) {
14     J2dTraceImpl(J2D_TRACE_VERBOSE, JNI_FALSE, &quot;check transform: &quot;);
15 
16     simd_float4 fpt = simd_make_float4(position[0], position[1], position[2], 1.f);
17     simd_float4 fpt_trans = simd_mul(transform4x4, fpt);
18     J2dTraceTraceVector(fpt);
19     J2dTraceImpl(J2D_TRACE_VERBOSE, JNI_FALSE, &quot;  ===&gt;&gt;&gt;  &quot;);
20     J2dTraceTraceVector(fpt_trans);
21     J2dTraceImpl(J2D_TRACE_VERBOSE, JNI_TRUE, &quot; &quot;);
22 }
23 
24 static void traceMatrix(simd_float4x4 * mtx) {
</pre>
<hr />
<pre>
28     }
29 }
30 
31 void traceRaster(char * p, int width, int height, int stride) {
32     for (int y = 0; y &lt; height; ++y) {
33         for (int x = 0; x &lt; width; ++x) {
34             unsigned char pix0 = p[y*stride + x*4];
35             unsigned char pix1 = p[y*stride + x*4 + 1];
36             unsigned char pix2 = p[y*stride + x*4 + 2];
37             unsigned char pix3 = p[y*stride + x*4 + 3];
38             J2dTraceImpl(J2D_TRACE_INFO, JNI_FALSE,&quot;[%u,%u,%u,%u], &quot;, pix0, pix1, pix2, pix3);
39         }
40         J2dTraceImpl(J2D_TRACE_INFO, JNI_TRUE, &quot;&quot;);
41     }
42 }
43 
44 void tracePoints(jint nPoints, jint *xPoints, jint *yPoints) {
45     for (int i = 0; i &lt; nPoints; i++)
46         J2dTraceImpl(J2D_TRACE_INFO, JNI_TRUE, &quot;\t(%d, %d)&quot;, *(xPoints++), *(yPoints++));
47 }










</pre>
</td>
<td>
<hr />
<pre>
 1 #include &quot;MTLUtils.h&quot;
 2 
 3 #include &lt;jni.h&gt;
 4 #include &lt;simd/simd.h&gt;
<span class="line-added"> 5 #import &lt;ThreadUtilities.h&gt;</span>
<span class="line-added"> 6 #import &lt;PropertiesUtilities.h&gt;</span>
 7 #include &quot;common.h&quot;
 8 #include &quot;Trace.h&quot;
 9 
10 extern void J2dTraceImpl(int level, jboolean cr, const char *string, ...);
11 void J2dTraceTraceVector(simd_float4 pt) {
12     J2dTraceImpl(J2D_TRACE_VERBOSE, JNI_FALSE, &quot;[%lf %lf %lf %lf]&quot;, pt.x, pt.y, pt.z, pt.w);
13 }
14 
15 void checkTransform(float * position, simd_float4x4 transform4x4) {
16     J2dTraceImpl(J2D_TRACE_VERBOSE, JNI_FALSE, &quot;check transform: &quot;);
17 
18     simd_float4 fpt = simd_make_float4(position[0], position[1], position[2], 1.f);
19     simd_float4 fpt_trans = simd_mul(transform4x4, fpt);
20     J2dTraceTraceVector(fpt);
21     J2dTraceImpl(J2D_TRACE_VERBOSE, JNI_FALSE, &quot;  ===&gt;&gt;&gt;  &quot;);
22     J2dTraceTraceVector(fpt_trans);
23     J2dTraceImpl(J2D_TRACE_VERBOSE, JNI_TRUE, &quot; &quot;);
24 }
25 
26 static void traceMatrix(simd_float4x4 * mtx) {
</pre>
<hr />
<pre>
30     }
31 }
32 
33 void traceRaster(char * p, int width, int height, int stride) {
34     for (int y = 0; y &lt; height; ++y) {
35         for (int x = 0; x &lt; width; ++x) {
36             unsigned char pix0 = p[y*stride + x*4];
37             unsigned char pix1 = p[y*stride + x*4 + 1];
38             unsigned char pix2 = p[y*stride + x*4 + 2];
39             unsigned char pix3 = p[y*stride + x*4 + 3];
40             J2dTraceImpl(J2D_TRACE_INFO, JNI_FALSE,&quot;[%u,%u,%u,%u], &quot;, pix0, pix1, pix2, pix3);
41         }
42         J2dTraceImpl(J2D_TRACE_INFO, JNI_TRUE, &quot;&quot;);
43     }
44 }
45 
46 void tracePoints(jint nPoints, jint *xPoints, jint *yPoints) {
47     for (int i = 0; i &lt; nPoints; i++)
48         J2dTraceImpl(J2D_TRACE_INFO, JNI_TRUE, &quot;\t(%d, %d)&quot;, *(xPoints++), *(yPoints++));
49 }
<span class="line-added">50 </span>
<span class="line-added">51 </span>
<span class="line-added">52 jboolean isOptionEnabled(const char * option) {</span>
<span class="line-added">53     JNIEnv *env = [ThreadUtilities getJNIEnvUncached];</span>
<span class="line-added">54 </span>
<span class="line-added">55     NSString * optionProp = [PropertiesUtilities</span>
<span class="line-added">56             javaSystemPropertyForKey:[NSString stringWithUTF8String:option] withEnv:env];</span>
<span class="line-added">57     NSString * lowerCaseProp = [optionProp localizedLowercaseString];</span>
<span class="line-added">58     return [@&quot;true&quot; isEqual:lowerCaseProp];</span>
<span class="line-added">59 }</span>
</pre>
</td>
</tr>
</table>
<center><a href="MTLBlitLoops.m.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>