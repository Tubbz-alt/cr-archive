<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old src/java.desktop/macosx/native/libawt_lwawt/java2d/metal/MTLUtils.m</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
  <body>
    <pre>
 1 #include &quot;MTLUtils.h&quot;
 2 
 3 #include &lt;jni.h&gt;
 4 #include &lt;simd/simd.h&gt;
 5 #include &quot;common.h&quot;
 6 #include &quot;Trace.h&quot;
 7 
 8 extern void J2dTraceImpl(int level, jboolean cr, const char *string, ...);
 9 void J2dTraceTraceVector(simd_float4 pt) {
10     J2dTraceImpl(J2D_TRACE_VERBOSE, JNI_FALSE, &quot;[%lf %lf %lf %lf]&quot;, pt.x, pt.y, pt.z, pt.w);
11 }
12 
13 void checkTransform(float * position, simd_float4x4 transform4x4) {
14     J2dTraceImpl(J2D_TRACE_VERBOSE, JNI_FALSE, &quot;check transform: &quot;);
15 
16     simd_float4 fpt = simd_make_float4(position[0], position[1], position[2], 1.f);
17     simd_float4 fpt_trans = simd_mul(transform4x4, fpt);
18     J2dTraceTraceVector(fpt);
19     J2dTraceImpl(J2D_TRACE_VERBOSE, JNI_FALSE, &quot;  ===&gt;&gt;&gt;  &quot;);
20     J2dTraceTraceVector(fpt_trans);
21     J2dTraceImpl(J2D_TRACE_VERBOSE, JNI_TRUE, &quot; &quot;);
22 }
23 
24 static void traceMatrix(simd_float4x4 * mtx) {
25     for (int row = 0; row &lt; 4; ++row) {
26         J2dTraceImpl(J2D_TRACE_VERBOSE, JNI_FALSE, &quot;  [%lf %lf %lf %lf]&quot;,
27                     mtx-&gt;columns[0][row], mtx-&gt;columns[1][row], mtx-&gt;columns[2][row], mtx-&gt;columns[3][row]);
28     }
29 }
30 
31 void traceRaster(char * p, int width, int height, int stride) {
32     for (int y = 0; y &lt; height; ++y) {
33         for (int x = 0; x &lt; width; ++x) {
34             unsigned char pix0 = p[y*stride + x*4];
35             unsigned char pix1 = p[y*stride + x*4 + 1];
36             unsigned char pix2 = p[y*stride + x*4 + 2];
37             unsigned char pix3 = p[y*stride + x*4 + 3];
38             J2dTraceImpl(J2D_TRACE_INFO, JNI_FALSE,&quot;[%u,%u,%u,%u], &quot;, pix0, pix1, pix2, pix3);
39         }
40         J2dTraceImpl(J2D_TRACE_INFO, JNI_TRUE, &quot;&quot;);
41     }
42 }
43 
44 void tracePoints(jint nPoints, jint *xPoints, jint *yPoints) {
45     for (int i = 0; i &lt; nPoints; i++)
46         J2dTraceImpl(J2D_TRACE_INFO, JNI_TRUE, &quot;\t(%d, %d)&quot;, *(xPoints++), *(yPoints++));
47 }
    </pre>
  </body>
</html>