<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/macosx/native/libawt_lwawt/java2d/metal/MTLRenderQueue.m</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="MTLRenderQueue.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>src/java.desktop/macosx/native/libawt_lwawt/java2d/metal/MTLRenderQueue.m</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 315,10 ***</span>
<span class="line-new-header">--- 315,14 ---</span>
      }
  
      J2dTraceLn1(J2D_TRACE_VERBOSE,
                  &quot;MTLRenderQueue_CheckPreviousOp: new op=%d&quot;, op);
  
<span class="line-added">+     if (op == MTL_OP_SET_COLOR) {</span>
<span class="line-added">+         return; // SET_COLOR should not cause endEncoder</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      if (mtlPreviousOp == MTL_OP_INIT) {
          mtlPreviousOp = op;
          return;
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 828,11 ***</span>
                [mtlc resetPaint];
              }
              break;
          case sun_java2d_pipe_BufferedOpCodes_SET_COLOR:
              {
<span class="line-modified">!                 CHECK_PREVIOUS_OP(MTL_OP_OTHER);</span>
                  jint pixel = NEXT_INT(b);
                  [mtlc setColorPaint:pixel];
              }
              break;
          case sun_java2d_pipe_BufferedOpCodes_SET_GRADIENT_PAINT:
<span class="line-new-header">--- 832,11 ---</span>
                [mtlc resetPaint];
              }
              break;
          case sun_java2d_pipe_BufferedOpCodes_SET_COLOR:
              {
<span class="line-modified">!                 CHECK_PREVIOUS_OP(MTL_OP_SET_COLOR);</span>
                  jint pixel = NEXT_INT(b);
                  [mtlc setColorPaint:pixel];
              }
              break;
          case sun_java2d_pipe_BufferedOpCodes_SET_GRADIENT_PAINT:
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1001,11 ***</span>
                  &quot;MTLRenderQueue_flushBuffer: invalid opcode=%d&quot;, opcode);
              return;
          }
      }
  
<span class="line-removed">-     CHECK_PREVIOUS_OP(MTL_OP_INIT);</span>
      if (mtlc != NULL) {
          [mtlc.encoderManager endEncoder];
          MTLCommandBufferWrapper * cbwrapper = [mtlc pullCommandBufferWrapper];
          id&lt;MTLCommandBuffer&gt; commandbuf = [cbwrapper getCommandBuffer];
          [commandbuf addCompletedHandler:^(id &lt;MTLCommandBuffer&gt; commandbuf) {
<span class="line-new-header">--- 1005,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1025,10 ***</span>
<span class="line-new-header">--- 1028,11 ---</span>
                      [layer setNeedsDisplay];
                  }];
              }
          }
      }
<span class="line-added">+     RESET_PREVIOUS_OP();</span>
  }
  
  /**
   * Returns a pointer to the &quot;current&quot; context, as set by the last SET_SURFACES
   * or SET_SCRATCH_SURFACE operation.
</pre>
<center><a href="MTLRenderQueue.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>