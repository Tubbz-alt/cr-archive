<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.desktop/macosx/native/libawt_lwawt/java2d/metal/EncoderManager.m</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../index.html" target="_top">index</a> <a href="MTLRenderQueue.h.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/macosx/native/libawt_lwawt/java2d/metal/EncoderManager.m</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -14,11 +14,10 @@</span>
  
  - (id)init;
  - (void)dealloc;
  
  - (void)reset:(id&lt;MTLTexture&gt;)destination
<span class="udiff-line-removed">-                 aaDest:(id&lt;MTLTexture&gt;)aaDestination</span>
             isDstOpaque:(jboolean)isDstOpaque
      isDstPremultiplied:(jboolean)isDstPremultiplied
                    isAA:(jboolean)isAA;
  
  - (void)updateEncoder:(id&lt;MTLRenderCommandEncoder&gt;)encoder
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -37,11 +36,10 @@</span>
      MTLPipelineStatesStorage * _pipelineStateStorage;
      id&lt;MTLDevice&gt; _device;
  
      // Persistent encoder properties
      id&lt;MTLTexture&gt; _destination;
<span class="udiff-line-removed">-     id&lt;MTLTexture&gt; _aaDestination;</span>
      SurfaceRasterFlags _dstFlags;
  
      //
      // Cached &#39;mutable&#39; states of encoder
      //
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -67,11 +65,10 @@</span>
  
  - (id)init {
      self = [super init];
      if (self) {
          _destination = nil;
<span class="udiff-line-removed">-         _aaDestination = nil;</span>
          _composite = [[MTLComposite alloc] init];
          _paint = [[MTLPaint alloc] init];
          _transform = [[MTLTransform alloc] init];
          _clip = [[MTLClip alloc] init];
      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -89,17 +86,14 @@</span>
      self-&gt;_pipelineStateStorage = mtlc.pipelineStateStorage;
      self-&gt;_device = mtlc.device;
  }
  
  - (void)reset:(id&lt;MTLTexture&gt;)destination
<span class="udiff-line-removed">-                 aaDest:(id&lt;MTLTexture&gt;)aaDestination</span>
             isDstOpaque:(jboolean)isDstOpaque
      isDstPremultiplied:(jboolean)isDstPremultiplied
<span class="udiff-line-modified-removed">-                   isAA:(jboolean)isAA</span>
<span class="udiff-line-removed">- {</span>
<span class="udiff-line-modified-added">+                   isAA:(jboolean)isAA {</span>
      _destination = destination;
<span class="udiff-line-removed">-     _aaDestination = aaDestination;</span>
      _dstFlags.isOpaque = isDstOpaque;
      _dstFlags.isPremultiplied = isDstPremultiplied;
      _isAA = isAA;
      // NOTE: probably it&#39;s better to invalidate/reset all cached states now
  }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -202,21 +196,14 @@</span>
  
      if (!forceUpdate &amp;&amp; [_clip isEqual:clip])
          return;
  
      [_clip copyFrom:clip];
<span class="udiff-line-modified-removed">-     if (_aaDestination != nil) {</span>
<span class="udiff-line-modified-removed">-       [_clip setScissorOrStencil:encoder</span>
<span class="udiff-line-modified-removed">-                        destWidth:_aaDestination.width</span>
<span class="udiff-line-modified-removed">-                       destHeight:_aaDestination.height</span>
<span class="udiff-line-removed">-                           device:_device];</span>
<span class="udiff-line-removed">-     } else {</span>
<span class="udiff-line-removed">-       [_clip setScissorOrStencil:encoder</span>
<span class="udiff-line-removed">-                        destWidth:_destination.width</span>
<span class="udiff-line-removed">-                       destHeight:_destination.height</span>
<span class="udiff-line-removed">-                           device:_device];</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-modified-added">+     [_clip setScissorOrStencil:encoder</span>
<span class="udiff-line-modified-added">+                      destWidth:_destination.width</span>
<span class="udiff-line-modified-added">+                     destHeight:_destination.height</span>
<span class="udiff-line-modified-added">+                         device:_device];</span>
  }
  
  - (void)updateTransform:(id &lt;MTLRenderCommandEncoder&gt;)encoder
                transform:(MTLTransform *)transform
              forceUpdate:(jboolean)forceUpdate
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -224,20 +211,13 @@</span>
      if (!forceUpdate
          &amp;&amp; [_transform isEqual:transform])
          return;
  
      [_transform copyFrom:transform];
<span class="udiff-line-modified-removed">-     if (_aaDestination != nil) {</span>
<span class="udiff-line-removed">-       [_transform setVertexMatrix:encoder</span>
<span class="udiff-line-removed">-                         destWidth:_aaDestination.width</span>
<span class="udiff-line-removed">-                        destHeight:_aaDestination.height];</span>
<span class="udiff-line-removed">-     } else {</span>
<span class="udiff-line-removed">-       [_transform setVertexMatrix:encoder</span>
<span class="udiff-line-modified-added">+     [_transform setVertexMatrix:encoder</span>
                          destWidth:_destination.width
                         destHeight:_destination.height];
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     }</span>
  }
  
  @end
  
  @implementation EncoderManager {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -415,11 +395,10 @@</span>
      // tex=%p&quot;, dest);
      _encoder = [[cbw getCommandBuffer] renderCommandEncoderWithDescriptor:rpd];
      [rpd release];
  
      [_encoderStates reset:dest
<span class="udiff-line-removed">-                aaDest:_aaDestination</span>
                 isDstOpaque:isOpaque
          isDstPremultiplied:YES
                        isAA:isAA];
    }
  
</pre>
<center>&lt; prev <a href="../../../../../../../index.html" target="_top">index</a> <a href="MTLRenderQueue.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>