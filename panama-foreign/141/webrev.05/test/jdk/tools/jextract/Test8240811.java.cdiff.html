<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/jdk/tools/jextract/Test8240811.java</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="RepeatedDeclsTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="UniondeclTest.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/tools/jextract/Test8240811.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 22,11 ***</span>
   */
  
  import java.nio.file.Path;
  import jdk.incubator.foreign.GroupLayout;
  import jdk.incubator.foreign.MemoryLayout;
<span class="line-modified">! import jdk.incubator.foreign.SystemABI.Type;</span>
  import org.testng.annotations.Test;
  import static org.testng.Assert.assertNotNull;
  import static org.testng.Assert.assertTrue;
  
  /*
<span class="line-new-header">--- 22,12 ---</span>
   */
  
  import java.nio.file.Path;
  import jdk.incubator.foreign.GroupLayout;
  import jdk.incubator.foreign.MemoryLayout;
<span class="line-modified">! import jdk.incubator.foreign.SystemABI;</span>
<span class="line-added">+ import jdk.incubator.jextract.Type;</span>
  import org.testng.annotations.Test;
  import static org.testng.Assert.assertNotNull;
  import static org.testng.Assert.assertTrue;
  
  /*
</pre>
<hr />
<pre>
<span class="line-old-header">*** 51,24 ***</span>
              // check foo layout
              Class&lt;?&gt; fooCls = loader.loadClass(&quot;name_collision_h$Cfoo&quot;);
              MemoryLayout fooLayout = findLayout(fooCls);
              assertNotNull(fooLayout);
              assertTrue(((GroupLayout)fooLayout).isStruct());
<span class="line-modified">!             checkFieldABIType(fooLayout, &quot;x&quot;,  Type.INT);</span>
<span class="line-modified">!             checkFieldABIType(fooLayout, &quot;y&quot;,  Type.INT);</span>
<span class="line-modified">!             checkFieldABIType(fooLayout, &quot;z&quot;,  Type.INT);</span>
  
              MemoryLayout fooVarLayout = findLayout(cls, &quot;foo&quot;);
              assertNotNull(fooVarLayout);
  
              // check foo2 layout
              Class&lt;?&gt; foo2Cls = loader.loadClass(&quot;name_collision_h$Cfoo2&quot;);
              MemoryLayout foo2Layout = findLayout(foo2Cls);
              assertNotNull(foo2Layout);
              assertTrue(((GroupLayout)foo2Layout).isUnion());
<span class="line-modified">!             checkFieldABIType(foo2Layout, &quot;i&quot;,  Type.INT);</span>
<span class="line-modified">!             checkFieldABIType(foo2Layout, &quot;l&quot;,  Type.LONG);</span>
  
              MemoryLayout foo2VarLayout = findLayout(cls, &quot;foo2&quot;);
              assertNotNull(foo2VarLayout);
  
              MemoryLayout barVarLayout = findLayout(cls, &quot;bar&quot;);
<span class="line-new-header">--- 52,24 ---</span>
              // check foo layout
              Class&lt;?&gt; fooCls = loader.loadClass(&quot;name_collision_h$Cfoo&quot;);
              MemoryLayout fooLayout = findLayout(fooCls);
              assertNotNull(fooLayout);
              assertTrue(((GroupLayout)fooLayout).isStruct());
<span class="line-modified">!             checkField(fooLayout, &quot;x&quot;,  SystemABI.C_INT);</span>
<span class="line-modified">!             checkField(fooLayout, &quot;y&quot;,  SystemABI.C_INT);</span>
<span class="line-modified">!             checkField(fooLayout, &quot;z&quot;,  SystemABI.C_INT);</span>
  
              MemoryLayout fooVarLayout = findLayout(cls, &quot;foo&quot;);
              assertNotNull(fooVarLayout);
  
              // check foo2 layout
              Class&lt;?&gt; foo2Cls = loader.loadClass(&quot;name_collision_h$Cfoo2&quot;);
              MemoryLayout foo2Layout = findLayout(foo2Cls);
              assertNotNull(foo2Layout);
              assertTrue(((GroupLayout)foo2Layout).isUnion());
<span class="line-modified">!             checkField(foo2Layout, &quot;i&quot;,  SystemABI.C_INT);</span>
<span class="line-modified">!             checkField(foo2Layout, &quot;l&quot;,  SystemABI.C_LONG);</span>
  
              MemoryLayout foo2VarLayout = findLayout(cls, &quot;foo2&quot;);
              assertNotNull(foo2VarLayout);
  
              MemoryLayout barVarLayout = findLayout(cls, &quot;bar&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 77,23 ***</span>
              // check bar layout
              Class&lt;?&gt; barCls = loader.loadClass(&quot;name_collision_h$Cbar&quot;);
              MemoryLayout barLayout = findLayout(barCls);
              assertNotNull(barLayout);
              assertTrue(((GroupLayout)barLayout).isStruct());
<span class="line-modified">!             checkFieldABIType(barLayout, &quot;f1&quot;,  Type.FLOAT);</span>
<span class="line-modified">!             checkFieldABIType(barLayout, &quot;f2&quot;,  Type.FLOAT);</span>
  
              MemoryLayout bar2VarLayout = findLayout(cls, &quot;bar2&quot;);
              assertNotNull(bar2VarLayout);
  
              // check bar layout
              Class&lt;?&gt; bar2Cls = loader.loadClass(&quot;name_collision_h$Cbar2&quot;);
              MemoryLayout bar2Layout = findLayout(bar2Cls);
              assertNotNull(bar2Layout);
              assertTrue(((GroupLayout)bar2Layout).isUnion());
<span class="line-modified">!             checkFieldABIType(bar2Layout, &quot;f&quot;,  Type.FLOAT);</span>
<span class="line-modified">!             checkFieldABIType(bar2Layout, &quot;d&quot;,  Type.DOUBLE);</span>
          } finally {
              deleteDir(nameCollisionOutput);
          }
      }
  }
<span class="line-new-header">--- 78,23 ---</span>
              // check bar layout
              Class&lt;?&gt; barCls = loader.loadClass(&quot;name_collision_h$Cbar&quot;);
              MemoryLayout barLayout = findLayout(barCls);
              assertNotNull(barLayout);
              assertTrue(((GroupLayout)barLayout).isStruct());
<span class="line-modified">!             checkField(barLayout, &quot;f1&quot;,  SystemABI.C_FLOAT);</span>
<span class="line-modified">!             checkField(barLayout, &quot;f2&quot;,  SystemABI.C_FLOAT);</span>
  
              MemoryLayout bar2VarLayout = findLayout(cls, &quot;bar2&quot;);
              assertNotNull(bar2VarLayout);
  
              // check bar layout
              Class&lt;?&gt; bar2Cls = loader.loadClass(&quot;name_collision_h$Cbar2&quot;);
              MemoryLayout bar2Layout = findLayout(bar2Cls);
              assertNotNull(bar2Layout);
              assertTrue(((GroupLayout)bar2Layout).isUnion());
<span class="line-modified">!             checkField(bar2Layout, &quot;f&quot;,  SystemABI.C_FLOAT);</span>
<span class="line-modified">!             checkField(bar2Layout, &quot;d&quot;,  SystemABI.C_DOUBLE);</span>
          } finally {
              deleteDir(nameCollisionOutput);
          }
      }
  }
</pre>
<center><a href="RepeatedDeclsTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="UniondeclTest.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>