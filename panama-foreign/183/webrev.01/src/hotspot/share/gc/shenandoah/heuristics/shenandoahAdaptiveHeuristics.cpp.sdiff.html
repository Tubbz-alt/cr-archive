<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/gc/shenandoah/heuristics/shenandoahAdaptiveHeuristics.cpp</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../c2/shenandoahSupport.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="shenandoahAdaptiveHeuristics.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/shenandoah/heuristics/shenandoahAdaptiveHeuristics.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
144 
145   double average_gc = _gc_time_history-&gt;avg();
146   double time_since_last = time_since_last_gc();
147   double allocation_rate = heap-&gt;bytes_allocated_since_gc_start() / time_since_last;
148 
149   if (average_gc &gt; allocation_headroom / allocation_rate) {
150     log_info(gc)(&quot;Trigger: Average GC time (%.2f ms) is above the time for allocation rate (%.0f %sB/s) to deplete free headroom (&quot; SIZE_FORMAT &quot;%s)&quot;,
151                  average_gc * 1000,
152                  byte_size_in_proper_unit(allocation_rate),     proper_unit_for_byte_size(allocation_rate),
153                  byte_size_in_proper_unit(allocation_headroom), proper_unit_for_byte_size(allocation_headroom));
154     log_info(gc, ergo)(&quot;Free headroom: &quot; SIZE_FORMAT &quot;%s (free) - &quot; SIZE_FORMAT &quot;%s (spike) - &quot; SIZE_FORMAT &quot;%s (penalties) = &quot; SIZE_FORMAT &quot;%s&quot;,
155                  byte_size_in_proper_unit(available),           proper_unit_for_byte_size(available),
156                  byte_size_in_proper_unit(spike_headroom),      proper_unit_for_byte_size(spike_headroom),
157                  byte_size_in_proper_unit(penalties),           proper_unit_for_byte_size(penalties),
158                  byte_size_in_proper_unit(allocation_headroom), proper_unit_for_byte_size(allocation_headroom));
159     return true;
160   }
161 
162   return ShenandoahHeuristics::should_start_gc();
163 }
<span class="line-removed">164 </span>
<span class="line-removed">165 const char* ShenandoahAdaptiveHeuristics::name() {</span>
<span class="line-removed">166   return &quot;adaptive&quot;;</span>
<span class="line-removed">167 }</span>
<span class="line-removed">168 </span>
<span class="line-removed">169 bool ShenandoahAdaptiveHeuristics::is_diagnostic() {</span>
<span class="line-removed">170   return false;</span>
<span class="line-removed">171 }</span>
<span class="line-removed">172 </span>
<span class="line-removed">173 bool ShenandoahAdaptiveHeuristics::is_experimental() {</span>
<span class="line-removed">174   return false;</span>
<span class="line-removed">175 }</span>
</pre>
</td>
<td>
<hr />
<pre>
144 
145   double average_gc = _gc_time_history-&gt;avg();
146   double time_since_last = time_since_last_gc();
147   double allocation_rate = heap-&gt;bytes_allocated_since_gc_start() / time_since_last;
148 
149   if (average_gc &gt; allocation_headroom / allocation_rate) {
150     log_info(gc)(&quot;Trigger: Average GC time (%.2f ms) is above the time for allocation rate (%.0f %sB/s) to deplete free headroom (&quot; SIZE_FORMAT &quot;%s)&quot;,
151                  average_gc * 1000,
152                  byte_size_in_proper_unit(allocation_rate),     proper_unit_for_byte_size(allocation_rate),
153                  byte_size_in_proper_unit(allocation_headroom), proper_unit_for_byte_size(allocation_headroom));
154     log_info(gc, ergo)(&quot;Free headroom: &quot; SIZE_FORMAT &quot;%s (free) - &quot; SIZE_FORMAT &quot;%s (spike) - &quot; SIZE_FORMAT &quot;%s (penalties) = &quot; SIZE_FORMAT &quot;%s&quot;,
155                  byte_size_in_proper_unit(available),           proper_unit_for_byte_size(available),
156                  byte_size_in_proper_unit(spike_headroom),      proper_unit_for_byte_size(spike_headroom),
157                  byte_size_in_proper_unit(penalties),           proper_unit_for_byte_size(penalties),
158                  byte_size_in_proper_unit(allocation_headroom), proper_unit_for_byte_size(allocation_headroom));
159     return true;
160   }
161 
162   return ShenandoahHeuristics::should_start_gc();
163 }












</pre>
</td>
</tr>
</table>
<center><a href="../c2/shenandoahSupport.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="shenandoahAdaptiveHeuristics.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>