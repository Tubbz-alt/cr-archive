<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.incubator.foreign/share/classes/jdk/incubator/foreign/LibraryLookup.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>src/jdk.incubator.foreign/share/classes/jdk/incubator/foreign/LibraryLookup.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 34,14 ***</span>
  /**
   * A native library lookup. Exposes lookup operation for searching symbols, see {@link LibraryLookup#lookup(String)}.
   * A given native library remains loaded as long as there is at least one &lt;em&gt;live&lt;/em&gt; library lookup instance referring
   * to it.
   * &lt;p&gt;
<span class="line-modified">!  * Memory address instances generated by a library lookup will contain a strong reference to the originating lookup object,</span>
<span class="line-modified">!  * therefore preventing library unloading; in turn method handle instances obtained from</span>
   * {@link ForeignLinker#downcallHandle(Addressable, MethodType, FunctionDescriptor)}) also maintain a strong reference
<span class="line-modified">!  * to the memory address parameter used for their construction. This means that there is always a strong reachability chain</span>
   * from a native method handle to a lookup object (the one that was used to lookup the native library symbol the method handle
   * refers to); this is useful to prevent situations where a native library is unloaded in the middle of a native call.
   * &lt;p&gt;
   * To allow for a library to be unloaded, a client will have to discard any strong references it
   * maintains, directly, or indirectly to a lookup object associated with given library.
<span class="line-new-header">--- 34,14 ---</span>
  /**
   * A native library lookup. Exposes lookup operation for searching symbols, see {@link LibraryLookup#lookup(String)}.
   * A given native library remains loaded as long as there is at least one &lt;em&gt;live&lt;/em&gt; library lookup instance referring
   * to it.
   * &lt;p&gt;
<span class="line-modified">!  * All symbol instances (see {@link LibraryLookup.Symbol}) generated by a given library lookup object contain a strong reference</span>
<span class="line-modified">!  * to said lookup object, therefore preventing library unloading; in turn method handle instances obtained from</span>
   * {@link ForeignLinker#downcallHandle(Addressable, MethodType, FunctionDescriptor)}) also maintain a strong reference
<span class="line-modified">!  * to the addressable parameter used for their construction. This means that there is always a strong reachability chain</span>
   * from a native method handle to a lookup object (the one that was used to lookup the native library symbol the method handle
   * refers to); this is useful to prevent situations where a native library is unloaded in the middle of a native call.
   * &lt;p&gt;
   * To allow for a library to be unloaded, a client will have to discard any strong references it
   * maintains, directly, or indirectly to a lookup object associated with given library.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 73,14 ***</span>
          @Override
          MemoryAddress address();
      }
  
      /**
<span class="line-modified">!      * Lookups a symbol with given name in this library. The returned address has the same temporal bounds</span>
<span class="line-removed">-      * as this lookup object.</span>
       * @param name the symbol name.
<span class="line-modified">!      * @return the library symbol (if any)</span>
       * @throws NoSuchMethodException if no symbol with given name could be found.
       */
      Symbol lookup(String name) throws NoSuchMethodException;
  
      /**
<span class="line-new-header">--- 73,13 ---</span>
          @Override
          MemoryAddress address();
      }
  
      /**
<span class="line-modified">!      * Lookups a symbol with given name in this library. The returned symbol maintains a strong reference to this lookup object.</span>
       * @param name the symbol name.
<span class="line-modified">!      * @return the library symbol (if any).</span>
       * @throws NoSuchMethodException if no symbol with given name could be found.
       */
      Symbol lookup(String name) throws NoSuchMethodException;
  
      /**
</pre>
<center>&lt; prev <a href="../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>