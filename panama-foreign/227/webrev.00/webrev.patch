diff a/src/hotspot/share/opto/output.cpp b/src/hotspot/share/opto/output.cpp
--- a/src/hotspot/share/opto/output.cpp
+++ b/src/hotspot/share/opto/output.cpp
@@ -3298,10 +3298,13 @@
     address* native_stubs = NULL;
     int num_stubs = 0;
     if (!C->native_stubs()->is_empty()) {
       num_stubs = C->native_stubs()->length();
       native_stubs = NEW_C_HEAP_ARRAY(address, num_stubs, mtInternal);
+      for (int i = 0; i < num_stubs; i++) {
+        native_stubs[i] = C->native_stubs()->at(i);
+      }
     }
 
     C->env()->register_method(target,
                                      entry_bci,
                                      &_code_offsets,
