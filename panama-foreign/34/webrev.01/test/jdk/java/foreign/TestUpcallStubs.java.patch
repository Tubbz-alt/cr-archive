diff a/test/jdk/java/foreign/TestUpcallStubs.java b/test/jdk/java/foreign/TestUpcallStubs.java
--- a/test/jdk/java/foreign/TestUpcallStubs.java
+++ b/test/jdk/java/foreign/TestUpcallStubs.java
@@ -56,11 +56,11 @@
 
     private static MemoryAddress getStub() {
         return abi.upcallStub(MH_dummy, FunctionDescriptor.ofVoid());
     }
 
-    @Test(expectedExceptions = IndexOutOfBoundsException.class)
+    @Test(expectedExceptions = UnsupportedOperationException.class)
     public void testNoAccess() {
         MemoryAddress stub = getStub();
         try {
             VarHandle vh = JAVA_INT.varHandle(int.class);
             vh.set(stub, 10);
