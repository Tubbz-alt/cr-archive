<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/classfile/systemDictionary.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="modules.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="vmSymbols.hpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/classfile/systemDictionary.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1258,29 ***</span>
  bool SystemDictionary::check_shared_class_super_type(InstanceKlass* child, InstanceKlass* super_type,
                                                       Handle class_loader,  Handle protection_domain,
                                                       bool is_superclass, TRAPS) {
    assert(super_type-&gt;is_shared(), &quot;must be&quot;);
  
<span class="line-removed">-   // Quick check if the super type has been already loaded.</span>
<span class="line-removed">-   // + Don&#39;t do it for unregistered classes -- they can be unloaded so</span>
<span class="line-removed">-   //   super_type-&gt;class_loader_data() could be stale.</span>
<span class="line-removed">-   // + Don&#39;t take the lock if loader data is NULL.</span>
<span class="line-removed">-   if (!super_type-&gt;is_shared_unregistered_class() &amp;&amp; super_type-&gt;class_loader_data() != NULL) {</span>
<span class="line-removed">-     MutexLocker mu1(THREAD, SystemDictionary_lock);</span>
<span class="line-removed">-     // Read loader_data again inside the lock for thread safety</span>
<span class="line-removed">-     ClassLoaderData* loader_data = super_type-&gt;class_loader_data();</span>
<span class="line-removed">-     if (loader_data != NULL) {</span>
<span class="line-removed">-       Symbol* name = super_type-&gt;name();</span>
<span class="line-removed">-       Dictionary* dictionary = loader_data-&gt;dictionary();</span>
<span class="line-removed">-       unsigned int d_hash = dictionary-&gt;compute_hash(name);</span>
<span class="line-removed">-       if (SystemDictionary::find_class(d_hash, name, dictionary) != super_type) {</span>
<span class="line-removed">-         return true;</span>
<span class="line-removed">-       }</span>
<span class="line-removed">-     }</span>
<span class="line-removed">-   }</span>
<span class="line-removed">- </span>
<span class="line-removed">-   // Not sure if super type is loaded. Do it the slow way.</span>
    Klass *found = resolve_super_or_fail(child-&gt;name(), super_type-&gt;name(),
                                         class_loader, protection_domain, is_superclass, CHECK_0);
    if (found == super_type) {
      return true;
    } else {
<span class="line-new-header">--- 1258,10 ---</span>
</pre>
<center><a href="modules.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="vmSymbols.hpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>