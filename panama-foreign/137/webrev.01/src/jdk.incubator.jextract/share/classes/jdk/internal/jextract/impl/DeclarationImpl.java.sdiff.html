<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.incubator.jextract/share/classes/jdk/internal/jextract/impl/DeclarationImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../incubator/jextract/tool/OutputFactory.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="PrettyPrinter.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.incubator.jextract/share/classes/jdk/internal/jextract/impl/DeclarationImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 82         var attrs = attributes.map(HashMap::new).orElseGet(HashMap::new);
 83         attrs.put(name, List.of(values));
 84         return withAttributes(attrs);
 85     }
 86 
 87     abstract protected Declaration withAttributes(Map&lt;String, List&lt;Constable&gt;&gt; attrs);
 88 
 89     @Override
 90     public boolean equals(Object o) {
 91         if (this == o) return true;
 92         if (!(o instanceof Declaration)) return false;
 93         Declaration decl = (Declaration) o;
 94         return name().equals(decl.name());
 95     }
 96 
 97     @Override
 98     public int hashCode() {
 99         return Objects.hash(name);
100     }
101 












































102     public static final class VariableImpl extends DeclarationImpl implements Declaration.Variable {
103 
104         final Variable.Kind kind;
105         final Type type;
106         final Optional&lt;MemoryLayout&gt; layout;
107 
108         private VariableImpl(Type type, Optional&lt;MemoryLayout&gt; layout, Variable.Kind kind, String name, Position pos, Map&lt;String, List&lt;Constable&gt;&gt; attrs) {
109             super(name, pos, attrs);
110             this.kind = Objects.requireNonNull(kind);
111             this.type = Objects.requireNonNull(type);
112             this.layout = Objects.requireNonNull(layout);
113         }
114 
115         public VariableImpl(Type type, Variable.Kind kind, String name, Position pos) {
116             this(type, LayoutUtils.getLayout(type), kind, name, pos, null);
117         }
118 
119         public VariableImpl(Type type, MemoryLayout layout, Variable.Kind kind, String name, Position pos) {
120             this(type, Optional.of(layout), kind, name, pos, null);
121         }
</pre>
<hr />
<pre>
137 
138         @Override
139         public Optional&lt;MemoryLayout&gt; layout() {
140             return layout;
141         }
142 
143         @Override
144         public Variable withAttributes(Map&lt;String, List&lt;Constable&gt;&gt; attrs) {
145             return new VariableImpl(type, layout, kind, name(), pos(), attrs);
146         }
147 
148         @Override
149         public Variable stripAttributes() {
150             return new VariableImpl(type, layout, kind, name(), pos(), null);
151         }
152 
153         @Override
154         public boolean equals(Object o) {
155             if (this == o) return true;
156             if (!(o instanceof Declaration.Variable)) return false;
<span class="line-modified">157             if (!super.equals(o)) return false;</span>
158             Declaration.Variable variable = (Declaration.Variable) o;





159             return kind == variable.kind() &amp;&amp;
160                     type.equals(variable.type());
161         }
162 
163         @Override
164         public int hashCode() {
165             return Objects.hash(super.hashCode(), kind, type);
166         }
167     }
168 
169     public static final class FunctionImpl extends DeclarationImpl implements Declaration.Function {
170 
171         final List&lt;Variable&gt; params;
172         final Type.Function type;
173 
174         public FunctionImpl(Type.Function type, List&lt;Variable&gt; params, String name, Position pos) {
175             this(type, params, name, pos, null);
176         }
177 
178         public FunctionImpl(Type.Function type, List&lt;Variable&gt; params, String name, Position pos, Map&lt;String, List&lt;Constable&gt;&gt; attrs) {
</pre>
</td>
<td>
<hr />
<pre>
 82         var attrs = attributes.map(HashMap::new).orElseGet(HashMap::new);
 83         attrs.put(name, List.of(values));
 84         return withAttributes(attrs);
 85     }
 86 
 87     abstract protected Declaration withAttributes(Map&lt;String, List&lt;Constable&gt;&gt; attrs);
 88 
 89     @Override
 90     public boolean equals(Object o) {
 91         if (this == o) return true;
 92         if (!(o instanceof Declaration)) return false;
 93         Declaration decl = (Declaration) o;
 94         return name().equals(decl.name());
 95     }
 96 
 97     @Override
 98     public int hashCode() {
 99         return Objects.hash(name);
100     }
101 
<span class="line-added">102     public static final class TypedefImpl extends DeclarationImpl implements Declaration.Typedef {</span>
<span class="line-added">103         final Type type;</span>
<span class="line-added">104 </span>
<span class="line-added">105         public TypedefImpl(Type type, String name, Position pos, Map&lt;String, List&lt;Constable&gt;&gt; attrs) {</span>
<span class="line-added">106             super(name, pos, attrs);</span>
<span class="line-added">107             this.type = Objects.requireNonNull(type);</span>
<span class="line-added">108         }</span>
<span class="line-added">109 </span>
<span class="line-added">110         @Override</span>
<span class="line-added">111         public &lt;R, D&gt; R accept(Visitor&lt;R, D&gt; visitor, D data) {</span>
<span class="line-added">112             return visitor.visitTypedef(this, data);</span>
<span class="line-added">113         }</span>
<span class="line-added">114 </span>
<span class="line-added">115         @Override</span>
<span class="line-added">116         public Type type() {</span>
<span class="line-added">117             return type;</span>
<span class="line-added">118         }</span>
<span class="line-added">119 </span>
<span class="line-added">120         @Override</span>
<span class="line-added">121         public Typedef withAttributes(Map&lt;String, List&lt;Constable&gt;&gt; attrs) {</span>
<span class="line-added">122             return new TypedefImpl(type, name(), pos(), attrs);</span>
<span class="line-added">123         }</span>
<span class="line-added">124 </span>
<span class="line-added">125         @Override</span>
<span class="line-added">126         public Typedef stripAttributes() {</span>
<span class="line-added">127             return new TypedefImpl(type, name(), pos(), null);</span>
<span class="line-added">128         }</span>
<span class="line-added">129 </span>
<span class="line-added">130         @Override</span>
<span class="line-added">131         public boolean equals(Object o) {</span>
<span class="line-added">132             if (this == o) return true;</span>
<span class="line-added">133             if (!(o instanceof Declaration.Typedef)) return false;</span>
<span class="line-added">134 </span>
<span class="line-added">135             Declaration.Typedef other = (Declaration.Typedef) o;</span>
<span class="line-added">136             return name().equals(other.name()) &amp;&amp;</span>
<span class="line-added">137                     type.equals(other.type());</span>
<span class="line-added">138         }</span>
<span class="line-added">139 </span>
<span class="line-added">140         @Override</span>
<span class="line-added">141         public int hashCode() {</span>
<span class="line-added">142             return Objects.hash(super.hashCode(), type);</span>
<span class="line-added">143         }</span>
<span class="line-added">144     }</span>
<span class="line-added">145 </span>
146     public static final class VariableImpl extends DeclarationImpl implements Declaration.Variable {
147 
148         final Variable.Kind kind;
149         final Type type;
150         final Optional&lt;MemoryLayout&gt; layout;
151 
152         private VariableImpl(Type type, Optional&lt;MemoryLayout&gt; layout, Variable.Kind kind, String name, Position pos, Map&lt;String, List&lt;Constable&gt;&gt; attrs) {
153             super(name, pos, attrs);
154             this.kind = Objects.requireNonNull(kind);
155             this.type = Objects.requireNonNull(type);
156             this.layout = Objects.requireNonNull(layout);
157         }
158 
159         public VariableImpl(Type type, Variable.Kind kind, String name, Position pos) {
160             this(type, LayoutUtils.getLayout(type), kind, name, pos, null);
161         }
162 
163         public VariableImpl(Type type, MemoryLayout layout, Variable.Kind kind, String name, Position pos) {
164             this(type, Optional.of(layout), kind, name, pos, null);
165         }
</pre>
<hr />
<pre>
181 
182         @Override
183         public Optional&lt;MemoryLayout&gt; layout() {
184             return layout;
185         }
186 
187         @Override
188         public Variable withAttributes(Map&lt;String, List&lt;Constable&gt;&gt; attrs) {
189             return new VariableImpl(type, layout, kind, name(), pos(), attrs);
190         }
191 
192         @Override
193         public Variable stripAttributes() {
194             return new VariableImpl(type, layout, kind, name(), pos(), null);
195         }
196 
197         @Override
198         public boolean equals(Object o) {
199             if (this == o) return true;
200             if (!(o instanceof Declaration.Variable)) return false;
<span class="line-modified">201 </span>
202             Declaration.Variable variable = (Declaration.Variable) o;
<span class="line-added">203             if (variable.kind() == Kind.TYPE) {</span>
<span class="line-added">204                 if (!variable.name().equals(name())) return false;</span>
<span class="line-added">205             } else {</span>
<span class="line-added">206                 if (!super.equals(o)) return false;</span>
<span class="line-added">207             }</span>
208             return kind == variable.kind() &amp;&amp;
209                     type.equals(variable.type());
210         }
211 
212         @Override
213         public int hashCode() {
214             return Objects.hash(super.hashCode(), kind, type);
215         }
216     }
217 
218     public static final class FunctionImpl extends DeclarationImpl implements Declaration.Function {
219 
220         final List&lt;Variable&gt; params;
221         final Type.Function type;
222 
223         public FunctionImpl(Type.Function type, List&lt;Variable&gt; params, String name, Position pos) {
224             this(type, params, name, pos, null);
225         }
226 
227         public FunctionImpl(Type.Function type, List&lt;Variable&gt; params, String name, Position pos, Map&lt;String, List&lt;Constable&gt;&gt; attrs) {
</pre>
</td>
</tr>
</table>
<center><a href="../../../incubator/jextract/tool/OutputFactory.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="PrettyPrinter.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>