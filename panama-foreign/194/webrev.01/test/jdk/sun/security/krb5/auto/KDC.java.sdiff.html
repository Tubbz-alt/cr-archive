<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/sun/security/krb5/auto/KDC.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../jdk/jfr/javaagent/TestLoadedAgent.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../tools/keytool/fakegen/java.base/sun/security/rsa/RSAKeyPairGenerator.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/sun/security/krb5/auto/KDC.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2008, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.
   8  *
   9  * This code is distributed in the hope that it will be useful, but WITHOUT
  10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  12  * version 2 for more details (a copy is included in the LICENSE file that
  13  * accompanied this code).
  14  *
  15  * You should have received a copy of the GNU General Public License version
  16  * 2 along with this work; if not, write to the Free Software Foundation,
  17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18  *
  19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20  * or visit www.oracle.com if you need additional information or have any
  21  * questions.
  22  */
</pre>
<hr />
<pre>
1151                         &amp;&amp; sensitives.contains(body.cname.toString())) {
1152                     // Cannot make FORWARDABLE
1153                 } else {
1154                     bFlags[Krb5.TKT_OPTS_FORWARDABLE] = true;
1155                 }
1156             }
1157             if (body.kdcOptions.get(KDCOptions.RENEWABLE)) {
1158                 bFlags[Krb5.TKT_OPTS_RENEWABLE] = true;
1159                 //renew = timeAfter(3600 * 24 * 7);
1160             }
1161             if (body.kdcOptions.get(KDCOptions.PROXIABLE)) {
1162                 bFlags[Krb5.TKT_OPTS_PROXIABLE] = true;
1163             }
1164             if (body.kdcOptions.get(KDCOptions.POSTDATED)) {
1165                 bFlags[Krb5.TKT_OPTS_POSTDATED] = true;
1166             }
1167             if (body.kdcOptions.get(KDCOptions.ALLOW_POSTDATE)) {
1168                 bFlags[Krb5.TKT_OPTS_MAY_POSTDATE] = true;
1169             }
1170             bFlags[Krb5.TKT_OPTS_INITIAL] = true;



1171 
1172             // Creating PA-DATA
1173             DerValue[] pas2 = null, pas = null;
1174             if (options.containsKey(KDC.Option.DUP_ETYPE)) {
1175                 int n = (Integer)options.get(KDC.Option.DUP_ETYPE);
1176                 switch (n) {
1177                     case 1:     // customer&#39;s case in 7067974
1178                         pas2 = new DerValue[] {
1179                             new DerValue(new ETypeInfo2(1, null, null).asn1Encode()),
1180                             new DerValue(new ETypeInfo2(1, &quot;&quot;, null).asn1Encode()),
1181                             new DerValue(new ETypeInfo2(
1182                                     1, realm, new byte[]{1}).asn1Encode()),
1183                         };
1184                         pas = new DerValue[] {
1185                             new DerValue(new ETypeInfo(1, null).asn1Encode()),
1186                             new DerValue(new ETypeInfo(1, &quot;&quot;).asn1Encode()),
1187                             new DerValue(new ETypeInfo(1, realm).asn1Encode()),
1188                         };
1189                         break;
1190                     case 2:     // we still reject non-null s2kparams and prefer E2 over E
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2008, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.
   8  *
   9  * This code is distributed in the hope that it will be useful, but WITHOUT
  10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  12  * version 2 for more details (a copy is included in the LICENSE file that
  13  * accompanied this code).
  14  *
  15  * You should have received a copy of the GNU General Public License version
  16  * 2 along with this work; if not, write to the Free Software Foundation,
  17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18  *
  19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20  * or visit www.oracle.com if you need additional information or have any
  21  * questions.
  22  */
</pre>
<hr />
<pre>
1151                         &amp;&amp; sensitives.contains(body.cname.toString())) {
1152                     // Cannot make FORWARDABLE
1153                 } else {
1154                     bFlags[Krb5.TKT_OPTS_FORWARDABLE] = true;
1155                 }
1156             }
1157             if (body.kdcOptions.get(KDCOptions.RENEWABLE)) {
1158                 bFlags[Krb5.TKT_OPTS_RENEWABLE] = true;
1159                 //renew = timeAfter(3600 * 24 * 7);
1160             }
1161             if (body.kdcOptions.get(KDCOptions.PROXIABLE)) {
1162                 bFlags[Krb5.TKT_OPTS_PROXIABLE] = true;
1163             }
1164             if (body.kdcOptions.get(KDCOptions.POSTDATED)) {
1165                 bFlags[Krb5.TKT_OPTS_POSTDATED] = true;
1166             }
1167             if (body.kdcOptions.get(KDCOptions.ALLOW_POSTDATE)) {
1168                 bFlags[Krb5.TKT_OPTS_MAY_POSTDATE] = true;
1169             }
1170             bFlags[Krb5.TKT_OPTS_INITIAL] = true;
<span class="line-added">1171             if (System.getProperty(&quot;test.kdc.always.enc.pa.rep&quot;) != null) {</span>
<span class="line-added">1172                 bFlags[Krb5.TKT_OPTS_ENC_PA_REP] = true;</span>
<span class="line-added">1173             }</span>
1174 
1175             // Creating PA-DATA
1176             DerValue[] pas2 = null, pas = null;
1177             if (options.containsKey(KDC.Option.DUP_ETYPE)) {
1178                 int n = (Integer)options.get(KDC.Option.DUP_ETYPE);
1179                 switch (n) {
1180                     case 1:     // customer&#39;s case in 7067974
1181                         pas2 = new DerValue[] {
1182                             new DerValue(new ETypeInfo2(1, null, null).asn1Encode()),
1183                             new DerValue(new ETypeInfo2(1, &quot;&quot;, null).asn1Encode()),
1184                             new DerValue(new ETypeInfo2(
1185                                     1, realm, new byte[]{1}).asn1Encode()),
1186                         };
1187                         pas = new DerValue[] {
1188                             new DerValue(new ETypeInfo(1, null).asn1Encode()),
1189                             new DerValue(new ETypeInfo(1, &quot;&quot;).asn1Encode()),
1190                             new DerValue(new ETypeInfo(1, realm).asn1Encode()),
1191                         };
1192                         break;
1193                     case 2:     // we still reject non-null s2kparams and prefer E2 over E
</pre>
</td>
</tr>
</table>
<center><a href="../../../../jdk/jfr/javaagent/TestLoadedAgent.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../tools/keytool/fakegen/java.base/sun/security/rsa/RSAKeyPairGenerator.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>