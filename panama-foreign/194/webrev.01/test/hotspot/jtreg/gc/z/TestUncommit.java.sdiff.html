<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/gc/z/TestUncommit.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../../compiler/jvmci/TestEnableJVMCIProduct.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../../runtime/cds/SharedBaseAddress.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/gc/z/TestUncommit.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 81         final var beforeUncommit = capacity();
 82 
 83         // Wait longer than the uncommit delay
 84         Thread.sleep(delay * 1000);
 85 
 86         final var afterUncommit = capacity();
 87 
 88         System.out.println(&quot;  Uncommit Enabled: &quot; + enabled);
 89         System.out.println(&quot;    Uncommit Delay: &quot; + delay);
 90         System.out.println(&quot;       Object Size: &quot; + objectSize);
 91         System.out.println(&quot;        Alloc Size: &quot; + allocSize);
 92         System.out.println(&quot;      Before Alloc: &quot; + beforeAlloc);
 93         System.out.println(&quot;       After Alloc: &quot; + afterAlloc);
 94         System.out.println(&quot;   Before Uncommit: &quot; + beforeUncommit);
 95         System.out.println(&quot;    After Uncommit: &quot; + afterUncommit);
 96         System.out.println();
 97 
 98         // Verify
 99         if (enabled) {
100             if (beforeUncommit == beforeAlloc) {
<span class="line-modified">101                 throw new Exception(&quot;Uncommitted too fast&quot;);</span>

102             }
103 
104             if (afterUncommit &gt;= afterAlloc) {
105                 throw new Exception(&quot;Uncommitted too slow&quot;);
106             }
107 
108             if (afterUncommit &lt; beforeAlloc) {
109                 throw new Exception(&quot;Uncommitted too much&quot;);
110             }
111 
112             if (afterUncommit &gt; beforeAlloc) {
113                 throw new Exception(&quot;Uncommitted too little&quot;);
114             }
115         } else {
116             if (afterAlloc &gt; beforeUncommit ||
117                 afterAlloc &gt; afterUncommit) {
118                 throw new Exception(&quot;Should not uncommit&quot;);
119             }
120         }
121     }
</pre>
</td>
<td>
<hr />
<pre>
 81         final var beforeUncommit = capacity();
 82 
 83         // Wait longer than the uncommit delay
 84         Thread.sleep(delay * 1000);
 85 
 86         final var afterUncommit = capacity();
 87 
 88         System.out.println(&quot;  Uncommit Enabled: &quot; + enabled);
 89         System.out.println(&quot;    Uncommit Delay: &quot; + delay);
 90         System.out.println(&quot;       Object Size: &quot; + objectSize);
 91         System.out.println(&quot;        Alloc Size: &quot; + allocSize);
 92         System.out.println(&quot;      Before Alloc: &quot; + beforeAlloc);
 93         System.out.println(&quot;       After Alloc: &quot; + afterAlloc);
 94         System.out.println(&quot;   Before Uncommit: &quot; + beforeUncommit);
 95         System.out.println(&quot;    After Uncommit: &quot; + afterUncommit);
 96         System.out.println();
 97 
 98         // Verify
 99         if (enabled) {
100             if (beforeUncommit == beforeAlloc) {
<span class="line-modified">101                 // Temporarily disabled pending JDK-8245208</span>
<span class="line-added">102                 // throw new Exception(&quot;Uncommitted too fast&quot;);</span>
103             }
104 
105             if (afterUncommit &gt;= afterAlloc) {
106                 throw new Exception(&quot;Uncommitted too slow&quot;);
107             }
108 
109             if (afterUncommit &lt; beforeAlloc) {
110                 throw new Exception(&quot;Uncommitted too much&quot;);
111             }
112 
113             if (afterUncommit &gt; beforeAlloc) {
114                 throw new Exception(&quot;Uncommitted too little&quot;);
115             }
116         } else {
117             if (afterAlloc &gt; beforeUncommit ||
118                 afterAlloc &gt; afterUncommit) {
119                 throw new Exception(&quot;Should not uncommit&quot;);
120             }
121         }
122     }
</pre>
</td>
</tr>
</table>
<center><a href="../../compiler/jvmci/TestEnableJVMCIProduct.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../../runtime/cds/SharedBaseAddress.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>