<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/utilities/vmError.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="hashtable.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../../java.base/share/classes/java/io/ObjectInputStream.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/utilities/vmError.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 26,10 ***</span>
<span class="line-new-header">--- 26,11 ---</span>
  #include &quot;jvm.h&quot;
  #include &quot;code/codeCache.hpp&quot;
  #include &quot;compiler/compileBroker.hpp&quot;
  #include &quot;compiler/disassembler.hpp&quot;
  #include &quot;gc/shared/gcConfig.hpp&quot;
<span class="line-added">+ #include &quot;gc/shared/gcLogPrecious.hpp&quot;</span>
  #include &quot;logging/logConfiguration.hpp&quot;
  #include &quot;memory/metaspace.hpp&quot;
  #include &quot;memory/metaspaceShared.hpp&quot;
  #include &quot;memory/resourceArea.hpp&quot;
  #include &quot;memory/universe.hpp&quot;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 774,11 ***</span>
       }
  
    STEP(&quot;printing register info&quot;)
  
       // decode register contents if possible
<span class="line-modified">!      if (_verbose &amp;&amp; _context &amp;&amp; Universe::is_fully_initialized()) {</span>
         os::print_register_info(st, _context);
         st-&gt;cr();
       }
  
    STEP(&quot;printing registers, top of stack, instructions near pc&quot;)
<span class="line-new-header">--- 775,12 ---</span>
       }
  
    STEP(&quot;printing register info&quot;)
  
       // decode register contents if possible
<span class="line-modified">!      if (_verbose &amp;&amp; _context &amp;&amp; _thread &amp;&amp; Universe::is_fully_initialized()) {</span>
<span class="line-added">+        ResourceMark rm(_thread);</span>
         os::print_register_info(st, _context);
         st-&gt;cr();
       }
  
    STEP(&quot;printing registers, top of stack, instructions near pc&quot;)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 790,19 ***</span>
       }
  
    STEP(&quot;inspecting top of stack&quot;)
  
       // decode stack contents if possible
<span class="line-modified">!      if (_verbose &amp;&amp; _context &amp;&amp; Universe::is_fully_initialized()) {</span>
         frame fr = os::fetch_frame_from_context(_context);
         const int slots = 8;
         const intptr_t *start = fr.sp();
         const intptr_t *end = start + slots;
         if (is_aligned(start, sizeof(intptr_t)) &amp;&amp; os::is_readable_range(start, end)) {
           st-&gt;print_cr(&quot;Stack slot to memory mapping:&quot;);
           for (int i = 0; i &lt; slots; ++i) {
             st-&gt;print(&quot;stack at sp + %d slots: &quot;, i);
             os::print_location(st, *(start + i));
           }
         }
         st-&gt;cr();
       }
<span class="line-new-header">--- 792,20 ---</span>
       }
  
    STEP(&quot;inspecting top of stack&quot;)
  
       // decode stack contents if possible
<span class="line-modified">!      if (_verbose &amp;&amp; _context &amp;&amp; _thread &amp;&amp; Universe::is_fully_initialized()) {</span>
         frame fr = os::fetch_frame_from_context(_context);
         const int slots = 8;
         const intptr_t *start = fr.sp();
         const intptr_t *end = start + slots;
         if (is_aligned(start, sizeof(intptr_t)) &amp;&amp; os::is_readable_range(start, end)) {
           st-&gt;print_cr(&quot;Stack slot to memory mapping:&quot;);
           for (int i = 0; i &lt; slots; ++i) {
             st-&gt;print(&quot;stack at sp + %d slots: &quot;, i);
<span class="line-added">+            ResourceMark rm(_thread);</span>
             os::print_location(st, *(start + i));
           }
         }
         st-&gt;cr();
       }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 923,15 ***</span>
       }
  #endif
  
    STEP(&quot;printing heap information&quot;)
  
<span class="line-modified">!      if (_verbose &amp;&amp; Universe::is_fully_initialized()) {</span>
<span class="line-modified">!        Universe::heap()-&gt;print_on_error(st);</span>
<span class="line-modified">!        st-&gt;cr();</span>
<span class="line-modified">!        st-&gt;print_cr(&quot;Polling page: &quot; INTPTR_FORMAT, p2i(SafepointMechanism::get_polling_page()));</span>
<span class="line-modified">!        st-&gt;cr();</span>
       }
  
    STEP(&quot;printing metaspace information&quot;)
  
       if (_verbose &amp;&amp; Universe::is_fully_initialized()) {
<span class="line-new-header">--- 926,22 ---</span>
       }
  #endif
  
    STEP(&quot;printing heap information&quot;)
  
<span class="line-modified">!      if (_verbose) {</span>
<span class="line-modified">!        GCLogPrecious::print_on_error(st);</span>
<span class="line-modified">! </span>
<span class="line-modified">!        if (Universe::heap() != NULL) {</span>
<span class="line-modified">!          Universe::heap()-&gt;print_on_error(st);</span>
<span class="line-added">+          st-&gt;cr();</span>
<span class="line-added">+        }</span>
<span class="line-added">+ </span>
<span class="line-added">+        if (Universe::is_fully_initialized()) {</span>
<span class="line-added">+          st-&gt;print_cr(&quot;Polling page: &quot; INTPTR_FORMAT, p2i(SafepointMechanism::get_polling_page()));</span>
<span class="line-added">+          st-&gt;cr();</span>
<span class="line-added">+        }</span>
       }
  
    STEP(&quot;printing metaspace information&quot;)
  
       if (_verbose &amp;&amp; Universe::is_fully_initialized()) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1129,10 ***</span>
<span class="line-new-header">--- 1139,11 ---</span>
  
    // STEP(&quot;printing heap information&quot;)
  
    if (Universe::is_fully_initialized()) {
      MutexLocker hl(Heap_lock);
<span class="line-added">+     GCLogPrecious::print_on_error(st);</span>
      Universe::heap()-&gt;print_on_error(st);
      st-&gt;cr();
      st-&gt;print_cr(&quot;Polling page: &quot; INTPTR_FORMAT, p2i(SafepointMechanism::get_polling_page()));
      st-&gt;cr();
    }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1735,22 ***</span>
  
  }
  
  #ifndef PRODUCT
  typedef void (*voidfun_t)();
  // Crash with an authentic sigfpe
  static void crash_with_sigfpe() {
    // generate a native synchronous SIGFPE where possible;
    // if that did not cause a signal (e.g. on ppc), just
    // raise the signal.
<span class="line-removed">-   volatile int x = 0;</span>
<span class="line-removed">-   volatile int y = 1/x;</span>
  #ifndef _WIN32
    // OSX implements raise(sig) incorrectly so we need to
    // explicitly target the current thread
    pthread_kill(pthread_self(), SIGFPE);
  #endif
  } // end: crash_with_sigfpe
  
  // crash with sigsegv at non-null address.
  static void crash_with_segfault() {
  
<span class="line-new-header">--- 1746,26 ---</span>
  
  }
  
  #ifndef PRODUCT
  typedef void (*voidfun_t)();
<span class="line-added">+ </span>
  // Crash with an authentic sigfpe
<span class="line-added">+ volatile int sigfpe_int = 0;</span>
  static void crash_with_sigfpe() {
<span class="line-added">+ </span>
    // generate a native synchronous SIGFPE where possible;
<span class="line-added">+   sigfpe_int = sigfpe_int/sigfpe_int;</span>
<span class="line-added">+ </span>
    // if that did not cause a signal (e.g. on ppc), just
    // raise the signal.
  #ifndef _WIN32
    // OSX implements raise(sig) incorrectly so we need to
    // explicitly target the current thread
    pthread_kill(pthread_self(), SIGFPE);
  #endif
<span class="line-added">+ </span>
  } // end: crash_with_sigfpe
  
  // crash with sigsegv at non-null address.
  static void crash_with_segfault() {
  
</pre>
<center><a href="hashtable.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../../java.base/share/classes/java/io/ObjectInputStream.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>