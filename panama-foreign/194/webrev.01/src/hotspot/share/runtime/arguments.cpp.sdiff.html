<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/runtime/arguments.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../prims/whitebox.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="arguments.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/runtime/arguments.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  68 char** Arguments::_jvm_args_array               = NULL;
  69 int    Arguments::_num_jvm_args                 = 0;
  70 char*  Arguments::_java_command                 = NULL;
  71 SystemProperty* Arguments::_system_properties   = NULL;
  72 const char*  Arguments::_gc_log_filename        = NULL;
  73 size_t Arguments::_conservative_max_heap_alignment = 0;
  74 Arguments::Mode Arguments::_mode                = _mixed;
  75 bool   Arguments::_java_compiler                = false;
  76 bool   Arguments::_xdebug_mode                  = false;
  77 const char*  Arguments::_java_vendor_url_bug    = NULL;
  78 const char*  Arguments::_sun_java_launcher      = DEFAULT_JAVA_LAUNCHER;
  79 bool   Arguments::_sun_java_launcher_is_altjvm  = false;
  80 
  81 // These parameters are reset in method parse_vm_init_args()
  82 bool   Arguments::_AlwaysCompileLoopMethods     = AlwaysCompileLoopMethods;
  83 bool   Arguments::_UseOnStackReplacement        = UseOnStackReplacement;
  84 bool   Arguments::_BackgroundCompilation        = BackgroundCompilation;
  85 bool   Arguments::_ClipInlining                 = ClipInlining;
  86 intx   Arguments::_Tier3InvokeNotifyFreqLog     = Tier3InvokeNotifyFreqLog;
  87 intx   Arguments::_Tier4InvocationThreshold     = Tier4InvocationThreshold;
<span class="line-modified">  88 size_t Arguments::_SharedBaseAddress            = SharedBaseAddress;</span>
  89 
  90 bool   Arguments::_enable_preview               = false;
  91 
  92 char*  Arguments::SharedArchivePath             = NULL;
  93 char*  Arguments::SharedDynamicArchivePath      = NULL;
  94 
  95 AgentLibraryList Arguments::_libraryList;
  96 AgentLibraryList Arguments::_agentList;
  97 
  98 // These are not set by the JDK&#39;s built-in launchers, but they can be set by
  99 // programs that embed the JVM using JNI_CreateJavaVM. See comments around
 100 // JavaVMOption in jni.h.
 101 abort_hook_t     Arguments::_abort_hook         = NULL;
 102 exit_hook_t      Arguments::_exit_hook          = NULL;
 103 vfprintf_hook_t  Arguments::_vfprintf_hook      = NULL;
 104 
 105 
 106 SystemProperty *Arguments::_sun_boot_library_path = NULL;
 107 SystemProperty *Arguments::_java_library_path = NULL;
 108 SystemProperty *Arguments::_java_home = NULL;
</pre>
<hr />
<pre>
2264 }
2265 
2266 // Parse JavaVMInitArgs structure
2267 
2268 jint Arguments::parse_vm_init_args(const JavaVMInitArgs *vm_options_args,
2269                                    const JavaVMInitArgs *java_tool_options_args,
2270                                    const JavaVMInitArgs *java_options_args,
2271                                    const JavaVMInitArgs *cmd_line_args) {
2272   bool patch_mod_javabase = false;
2273 
2274   // Save default settings for some mode flags
2275   Arguments::_AlwaysCompileLoopMethods = AlwaysCompileLoopMethods;
2276   Arguments::_UseOnStackReplacement    = UseOnStackReplacement;
2277   Arguments::_ClipInlining             = ClipInlining;
2278   Arguments::_BackgroundCompilation    = BackgroundCompilation;
2279   if (TieredCompilation) {
2280     Arguments::_Tier3InvokeNotifyFreqLog = Tier3InvokeNotifyFreqLog;
2281     Arguments::_Tier4InvocationThreshold = Tier4InvocationThreshold;
2282   }
2283 
<span class="line-modified">2284   // CDS dumping always write the archive to the default value of SharedBaseAddress.</span>
<span class="line-modified">2285   Arguments::_SharedBaseAddress = SharedBaseAddress;</span>
2286 
2287   // Setup flags for mixed which is the default
2288   set_mode_flags(_mixed);
2289 
2290   // Parse args structure generated from java.base vm options resource
2291   jint result = parse_each_vm_init_arg(vm_options_args, &amp;patch_mod_javabase, JVMFlag::JIMAGE_RESOURCE);
2292   if (result != JNI_OK) {
2293     return result;
2294   }
2295 
2296   // Parse args structure generated from JAVA_TOOL_OPTIONS environment
2297   // variable (if present).
2298   result = parse_each_vm_init_arg(java_tool_options_args, &amp;patch_mod_javabase, JVMFlag::ENVIRON_VAR);
2299   if (result != JNI_OK) {
2300     return result;
2301   }
2302 
2303   // Parse args structure generated from the command line flags.
2304   result = parse_each_vm_init_arg(cmd_line_args, &amp;patch_mod_javabase, JVMFlag::COMMAND_LINE);
2305   if (result != JNI_OK) {
</pre>
<hr />
<pre>
3025       }
3026       // disable scavenge before parallel mark-compact
3027       if (FLAG_SET_CMDLINE(ScavengeBeforeFullGC, false) != JVMFlag::SUCCESS) {
3028         return JNI_EINVAL;
3029       }
3030 #endif
3031 #if !INCLUDE_MANAGEMENT
3032     } else if (match_option(option, &quot;-XX:+ManagementServer&quot;)) {
3033         jio_fprintf(defaultStream::error_stream(),
3034           &quot;ManagementServer is not supported in this VM.\n&quot;);
3035         return JNI_ERR;
3036 #endif // INCLUDE_MANAGEMENT
3037 #if INCLUDE_JVMCI
3038     } else if (match_option(option, &quot;-XX:-EnableJVMCIProduct&quot;)) {
3039       if (EnableJVMCIProduct) {
3040         jio_fprintf(defaultStream::error_stream(),
3041                   &quot;-XX:-EnableJVMCIProduct cannot come after -XX:+EnableJVMCIProduct\n&quot;);
3042         return JNI_EINVAL;
3043       }
3044     } else if (match_option(option, &quot;-XX:+EnableJVMCIProduct&quot;)) {




3045       JVMFlag *jvmciFlag = JVMFlag::find_flag(&quot;EnableJVMCIProduct&quot;);
3046       // Allow this flag if it has been unlocked.
3047       if (jvmciFlag != NULL &amp;&amp; jvmciFlag-&gt;is_unlocked()) {
3048         if (!JVMCIGlobals::enable_jvmci_product_mode(origin)) {
3049           jio_fprintf(defaultStream::error_stream(),
3050             &quot;Unable to enable JVMCI in product mode&quot;);
3051           return JNI_ERR;
3052         }
3053       }
3054       // The flag was locked so process normally to report that error
3055       else if (!process_argument(&quot;EnableJVMCIProduct&quot;, args-&gt;ignoreUnrecognized, origin)) {
3056         return JNI_EINVAL;
3057       }
3058 #endif // INCLUDE_JVMCI
3059 #if INCLUDE_JFR
3060     } else if (match_jfr_option(&amp;option)) {
3061       return JNI_EINVAL;
3062 #endif
3063     } else if (match_option(option, &quot;-XX:&quot;, &amp;tail)) { // -XX:xxxx
3064       // Skip -XX:Flags= and -XX:VMOptionsFile= since those cases have
</pre>
</td>
<td>
<hr />
<pre>
  68 char** Arguments::_jvm_args_array               = NULL;
  69 int    Arguments::_num_jvm_args                 = 0;
  70 char*  Arguments::_java_command                 = NULL;
  71 SystemProperty* Arguments::_system_properties   = NULL;
  72 const char*  Arguments::_gc_log_filename        = NULL;
  73 size_t Arguments::_conservative_max_heap_alignment = 0;
  74 Arguments::Mode Arguments::_mode                = _mixed;
  75 bool   Arguments::_java_compiler                = false;
  76 bool   Arguments::_xdebug_mode                  = false;
  77 const char*  Arguments::_java_vendor_url_bug    = NULL;
  78 const char*  Arguments::_sun_java_launcher      = DEFAULT_JAVA_LAUNCHER;
  79 bool   Arguments::_sun_java_launcher_is_altjvm  = false;
  80 
  81 // These parameters are reset in method parse_vm_init_args()
  82 bool   Arguments::_AlwaysCompileLoopMethods     = AlwaysCompileLoopMethods;
  83 bool   Arguments::_UseOnStackReplacement        = UseOnStackReplacement;
  84 bool   Arguments::_BackgroundCompilation        = BackgroundCompilation;
  85 bool   Arguments::_ClipInlining                 = ClipInlining;
  86 intx   Arguments::_Tier3InvokeNotifyFreqLog     = Tier3InvokeNotifyFreqLog;
  87 intx   Arguments::_Tier4InvocationThreshold     = Tier4InvocationThreshold;
<span class="line-modified">  88 size_t Arguments::_default_SharedBaseAddress    = SharedBaseAddress;</span>
  89 
  90 bool   Arguments::_enable_preview               = false;
  91 
  92 char*  Arguments::SharedArchivePath             = NULL;
  93 char*  Arguments::SharedDynamicArchivePath      = NULL;
  94 
  95 AgentLibraryList Arguments::_libraryList;
  96 AgentLibraryList Arguments::_agentList;
  97 
  98 // These are not set by the JDK&#39;s built-in launchers, but they can be set by
  99 // programs that embed the JVM using JNI_CreateJavaVM. See comments around
 100 // JavaVMOption in jni.h.
 101 abort_hook_t     Arguments::_abort_hook         = NULL;
 102 exit_hook_t      Arguments::_exit_hook          = NULL;
 103 vfprintf_hook_t  Arguments::_vfprintf_hook      = NULL;
 104 
 105 
 106 SystemProperty *Arguments::_sun_boot_library_path = NULL;
 107 SystemProperty *Arguments::_java_library_path = NULL;
 108 SystemProperty *Arguments::_java_home = NULL;
</pre>
<hr />
<pre>
2264 }
2265 
2266 // Parse JavaVMInitArgs structure
2267 
2268 jint Arguments::parse_vm_init_args(const JavaVMInitArgs *vm_options_args,
2269                                    const JavaVMInitArgs *java_tool_options_args,
2270                                    const JavaVMInitArgs *java_options_args,
2271                                    const JavaVMInitArgs *cmd_line_args) {
2272   bool patch_mod_javabase = false;
2273 
2274   // Save default settings for some mode flags
2275   Arguments::_AlwaysCompileLoopMethods = AlwaysCompileLoopMethods;
2276   Arguments::_UseOnStackReplacement    = UseOnStackReplacement;
2277   Arguments::_ClipInlining             = ClipInlining;
2278   Arguments::_BackgroundCompilation    = BackgroundCompilation;
2279   if (TieredCompilation) {
2280     Arguments::_Tier3InvokeNotifyFreqLog = Tier3InvokeNotifyFreqLog;
2281     Arguments::_Tier4InvocationThreshold = Tier4InvocationThreshold;
2282   }
2283 
<span class="line-modified">2284   // Remember the default value of SharedBaseAddress.</span>
<span class="line-modified">2285   Arguments::_default_SharedBaseAddress = SharedBaseAddress;</span>
2286 
2287   // Setup flags for mixed which is the default
2288   set_mode_flags(_mixed);
2289 
2290   // Parse args structure generated from java.base vm options resource
2291   jint result = parse_each_vm_init_arg(vm_options_args, &amp;patch_mod_javabase, JVMFlag::JIMAGE_RESOURCE);
2292   if (result != JNI_OK) {
2293     return result;
2294   }
2295 
2296   // Parse args structure generated from JAVA_TOOL_OPTIONS environment
2297   // variable (if present).
2298   result = parse_each_vm_init_arg(java_tool_options_args, &amp;patch_mod_javabase, JVMFlag::ENVIRON_VAR);
2299   if (result != JNI_OK) {
2300     return result;
2301   }
2302 
2303   // Parse args structure generated from the command line flags.
2304   result = parse_each_vm_init_arg(cmd_line_args, &amp;patch_mod_javabase, JVMFlag::COMMAND_LINE);
2305   if (result != JNI_OK) {
</pre>
<hr />
<pre>
3025       }
3026       // disable scavenge before parallel mark-compact
3027       if (FLAG_SET_CMDLINE(ScavengeBeforeFullGC, false) != JVMFlag::SUCCESS) {
3028         return JNI_EINVAL;
3029       }
3030 #endif
3031 #if !INCLUDE_MANAGEMENT
3032     } else if (match_option(option, &quot;-XX:+ManagementServer&quot;)) {
3033         jio_fprintf(defaultStream::error_stream(),
3034           &quot;ManagementServer is not supported in this VM.\n&quot;);
3035         return JNI_ERR;
3036 #endif // INCLUDE_MANAGEMENT
3037 #if INCLUDE_JVMCI
3038     } else if (match_option(option, &quot;-XX:-EnableJVMCIProduct&quot;)) {
3039       if (EnableJVMCIProduct) {
3040         jio_fprintf(defaultStream::error_stream(),
3041                   &quot;-XX:-EnableJVMCIProduct cannot come after -XX:+EnableJVMCIProduct\n&quot;);
3042         return JNI_EINVAL;
3043       }
3044     } else if (match_option(option, &quot;-XX:+EnableJVMCIProduct&quot;)) {
<span class="line-added">3045       // Just continue, since &quot;-XX:+EnableJVMCIProduct&quot; has been specified before</span>
<span class="line-added">3046       if (EnableJVMCIProduct) {</span>
<span class="line-added">3047         continue;</span>
<span class="line-added">3048       }</span>
3049       JVMFlag *jvmciFlag = JVMFlag::find_flag(&quot;EnableJVMCIProduct&quot;);
3050       // Allow this flag if it has been unlocked.
3051       if (jvmciFlag != NULL &amp;&amp; jvmciFlag-&gt;is_unlocked()) {
3052         if (!JVMCIGlobals::enable_jvmci_product_mode(origin)) {
3053           jio_fprintf(defaultStream::error_stream(),
3054             &quot;Unable to enable JVMCI in product mode&quot;);
3055           return JNI_ERR;
3056         }
3057       }
3058       // The flag was locked so process normally to report that error
3059       else if (!process_argument(&quot;EnableJVMCIProduct&quot;, args-&gt;ignoreUnrecognized, origin)) {
3060         return JNI_EINVAL;
3061       }
3062 #endif // INCLUDE_JVMCI
3063 #if INCLUDE_JFR
3064     } else if (match_jfr_option(&amp;option)) {
3065       return JNI_EINVAL;
3066 #endif
3067     } else if (match_option(option, &quot;-XX:&quot;, &amp;tail)) { // -XX:xxxx
3068       // Skip -XX:Flags= and -XX:VMOptionsFile= since those cases have
</pre>
</td>
</tr>
</table>
<center><a href="../prims/whitebox.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="arguments.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>