<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/jdk.incubator.jpackage/macosx/classes/jdk/incubator/jpackage/internal/MacAppImageBuilder.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MacAppBundler.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="resources/MacResources.properties.udiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.incubator.jpackage/macosx/classes/jdk/incubator/jpackage/internal/MacAppImageBuilder.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -108,33 +108,11 @@</span>
                          String identifier = extractBundleIdentifier(params);
                          if (identifier != null) {
                              return identifier;
                          }
  
<span class="udiff-line-modified-removed">-                         identifier = IDENTIFIER.fetchFrom(params);</span>
<span class="udiff-line-removed">-                         if (identifier != null) {</span>
<span class="udiff-line-removed">-                             return identifier;</span>
<span class="udiff-line-removed">-                         }</span>
<span class="udiff-line-removed">-                         // the IDENTIFIER (above) will default to derive from</span>
<span class="udiff-line-removed">-                         // the main-class, in case there is no main-class</span>
<span class="udiff-line-removed">-                         // (such as runtime installer) revert to the name.</span>
<span class="udiff-line-removed">-                         // any of these could be invalid, so check later.</span>
<span class="udiff-line-removed">-                         return APP_NAME.fetchFrom(params);</span>
<span class="udiff-line-removed">-                     },</span>
<span class="udiff-line-removed">-                     (s, p) -&gt; s);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     public static final BundlerParamInfo&lt;String&gt; MAC_CF_BUNDLE_VERSION =</span>
<span class="udiff-line-removed">-             new StandardBundlerParam&lt;&gt;(</span>
<span class="udiff-line-removed">-                     &quot;mac.CFBundleVersion&quot;,</span>
<span class="udiff-line-removed">-                     String.class,</span>
<span class="udiff-line-removed">-                     p -&gt; {</span>
<span class="udiff-line-removed">-                         String s = VERSION.fetchFrom(p);</span>
<span class="udiff-line-removed">-                         if (validCFBundleVersion(s)) {</span>
<span class="udiff-line-removed">-                             return s;</span>
<span class="udiff-line-removed">-                         } else {</span>
<span class="udiff-line-removed">-                             return &quot;100&quot;;</span>
<span class="udiff-line-removed">-                         }</span>
<span class="udiff-line-modified-added">+                         return MacAppBundler.getIdentifier(params);</span>
                      },
                      (s, p) -&gt; s);
  
      public static final BundlerParamInfo&lt;File&gt; ICON_ICNS =
              new StandardBundlerParam&lt;&gt;(
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -186,63 +164,10 @@</span>
      private void writeEntry(InputStream in, Path dstFile) throws IOException {
          Files.createDirectories(dstFile.getParent());
          Files.copy(in, dstFile);
      }
  
<span class="udiff-line-removed">-     public static boolean validCFBundleVersion(String v) {</span>
<span class="udiff-line-removed">-         // CFBundleVersion (String - iOS, OS X) specifies the build version</span>
<span class="udiff-line-removed">-         // number of the bundle, which identifies an iteration (released or</span>
<span class="udiff-line-removed">-         // unreleased) of the bundle. The build version number should be a</span>
<span class="udiff-line-removed">-         // string comprised of three non-negative, period-separated integers</span>
<span class="udiff-line-removed">-         // with the first integer being greater than zero. The string should</span>
<span class="udiff-line-removed">-         // only contain numeric (0-9) and period (.) characters. Leading zeros</span>
<span class="udiff-line-removed">-         // are truncated from each integer and will be ignored (that is,</span>
<span class="udiff-line-removed">-         // 1.02.3 is equivalent to 1.2.3). This key is not localizable.</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         if (v == null) {</span>
<span class="udiff-line-removed">-             return false;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         String p[] = v.split(&quot;\\.&quot;);</span>
<span class="udiff-line-removed">-         if (p.length &gt; 3 || p.length &lt; 1) {</span>
<span class="udiff-line-removed">-             Log.verbose(I18N.getString(</span>
<span class="udiff-line-removed">-                     &quot;message.version-string-too-many-components&quot;));</span>
<span class="udiff-line-removed">-             return false;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         try {</span>
<span class="udiff-line-removed">-             BigInteger n = new BigInteger(p[0]);</span>
<span class="udiff-line-removed">-             if (BigInteger.ONE.compareTo(n) &gt; 0) {</span>
<span class="udiff-line-removed">-                 Log.verbose(I18N.getString(</span>
<span class="udiff-line-removed">-                         &quot;message.version-string-first-number-not-zero&quot;));</span>
<span class="udiff-line-removed">-                 return false;</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-             if (p.length &gt; 1) {</span>
<span class="udiff-line-removed">-                 n = new BigInteger(p[1]);</span>
<span class="udiff-line-removed">-                 if (BigInteger.ZERO.compareTo(n) &gt; 0) {</span>
<span class="udiff-line-removed">-                     Log.verbose(I18N.getString(</span>
<span class="udiff-line-removed">-                             &quot;message.version-string-no-negative-numbers&quot;));</span>
<span class="udiff-line-removed">-                     return false;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-             if (p.length &gt; 2) {</span>
<span class="udiff-line-removed">-                 n = new BigInteger(p[2]);</span>
<span class="udiff-line-removed">-                 if (BigInteger.ZERO.compareTo(n) &gt; 0) {</span>
<span class="udiff-line-removed">-                     Log.verbose(I18N.getString(</span>
<span class="udiff-line-removed">-                             &quot;message.version-string-no-negative-numbers&quot;));</span>
<span class="udiff-line-removed">-                     return false;</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-         } catch (NumberFormatException ne) {</span>
<span class="udiff-line-removed">-             Log.verbose(I18N.getString(&quot;message.version-string-numbers-only&quot;));</span>
<span class="udiff-line-removed">-             Log.verbose(ne);</span>
<span class="udiff-line-removed">-             return false;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         return true;</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">- </span>
      @Override
      public Path getAppDir() {
          return appDir;
      }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -467,20 +392,14 @@</span>
          data.put(&quot;DEPLOY_ICON_FILE&quot;, APP_NAME.fetchFrom(params) + &quot;.icns&quot;);
          data.put(&quot;DEPLOY_BUNDLE_IDENTIFIER&quot;,
                  MAC_CF_BUNDLE_IDENTIFIER.fetchFrom(params));
          data.put(&quot;DEPLOY_BUNDLE_NAME&quot;,
                  getBundleName(params));
<span class="udiff-line-modified-removed">-         data.put(&quot;DEPLOY_BUNDLE_COPYRIGHT&quot;,</span>
<span class="udiff-line-removed">-                 COPYRIGHT.fetchFrom(params) != null ?</span>
<span class="udiff-line-removed">-                 COPYRIGHT.fetchFrom(params) : &quot;Unknown&quot;);</span>
<span class="udiff-line-modified-added">+         data.put(&quot;DEPLOY_BUNDLE_COPYRIGHT&quot;, COPYRIGHT.fetchFrom(params));</span>
          data.put(&quot;DEPLOY_LAUNCHER_NAME&quot;, getLauncherName(params));
<span class="udiff-line-modified-removed">-         data.put(&quot;DEPLOY_BUNDLE_SHORT_VERSION&quot;,</span>
<span class="udiff-line-modified-removed">-                 VERSION.fetchFrom(params) != null ?</span>
<span class="udiff-line-removed">-                 VERSION.fetchFrom(params) : &quot;1.0.0&quot;);</span>
<span class="udiff-line-removed">-         data.put(&quot;DEPLOY_BUNDLE_CFBUNDLE_VERSION&quot;,</span>
<span class="udiff-line-removed">-                 MAC_CF_BUNDLE_VERSION.fetchFrom(params) != null ?</span>
<span class="udiff-line-removed">-                 MAC_CF_BUNDLE_VERSION.fetchFrom(params) : &quot;100&quot;);</span>
<span class="udiff-line-modified-added">+         data.put(&quot;DEPLOY_BUNDLE_SHORT_VERSION&quot;, VERSION.fetchFrom(params));</span>
<span class="udiff-line-modified-added">+         data.put(&quot;DEPLOY_BUNDLE_CFBUNDLE_VERSION&quot;, VERSION.fetchFrom(params));</span>
  
          boolean hasMainJar = MAIN_JAR.fetchFrom(params) != null;
          boolean hasMainModule =
                  StandardBundlerParam.MODULE.fetchFrom(params) != null;
  
</pre>
<center><a href="MacAppBundler.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="resources/MacResources.properties.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>