<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.jdeps/share/classes/com/sun/tools/javap/AttributeWriter.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../classfile/Code_attribute.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../jdk.jfr/share/classes/jdk/jfr/events/AbstractBufferStatisticsEvent.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.jdeps/share/classes/com/sun/tools/javap/AttributeWriter.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2007, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
  51 import com.sun.tools.classfile.LineNumberTable_attribute;
  52 import com.sun.tools.classfile.LocalVariableTable_attribute;
  53 import com.sun.tools.classfile.LocalVariableTypeTable_attribute;
  54 import com.sun.tools.classfile.MethodParameters_attribute;
  55 import com.sun.tools.classfile.Module_attribute;
  56 import com.sun.tools.classfile.ModuleHashes_attribute;
  57 import com.sun.tools.classfile.ModuleMainClass_attribute;
  58 import com.sun.tools.classfile.ModulePackages_attribute;
  59 import com.sun.tools.classfile.ModuleResolution_attribute;
  60 import com.sun.tools.classfile.ModuleTarget_attribute;
  61 import com.sun.tools.classfile.NestHost_attribute;
  62 import com.sun.tools.classfile.NestMembers_attribute;
  63 import com.sun.tools.classfile.Record_attribute;
  64 import com.sun.tools.classfile.RuntimeInvisibleAnnotations_attribute;
  65 import com.sun.tools.classfile.RuntimeInvisibleParameterAnnotations_attribute;
  66 import com.sun.tools.classfile.RuntimeInvisibleTypeAnnotations_attribute;
  67 import com.sun.tools.classfile.RuntimeParameterAnnotations_attribute;
  68 import com.sun.tools.classfile.RuntimeVisibleAnnotations_attribute;
  69 import com.sun.tools.classfile.RuntimeVisibleParameterAnnotations_attribute;
  70 import com.sun.tools.classfile.RuntimeVisibleTypeAnnotations_attribute;
<span class="line-modified">  71 import com.sun.tools.classfile.Signature;</span>
  72 import com.sun.tools.classfile.Signature_attribute;
  73 import com.sun.tools.classfile.SourceDebugExtension_attribute;
  74 import com.sun.tools.classfile.SourceFile_attribute;
  75 import com.sun.tools.classfile.SourceID_attribute;
  76 import com.sun.tools.classfile.StackMapTable_attribute;
  77 import com.sun.tools.classfile.StackMap_attribute;
  78 import com.sun.tools.classfile.Synthetic_attribute;
  79 import com.sun.tools.classfile.Type;
  80 
  81 import static com.sun.tools.classfile.AccessFlags.*;
  82 
  83 import com.sun.tools.javac.util.Assert;
  84 import com.sun.tools.javac.util.StringUtils;
  85 
<span class="line-removed">  86 import java.util.stream.Collectors;</span>
<span class="line-removed">  87 import java.util.stream.IntStream;</span>
<span class="line-removed">  88 import java.util.stream.Stream;</span>
<span class="line-removed">  89 </span>
  90 /*
  91  *  A writer for writing Attributes as text.
  92  *
  93  *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
  94  *  If you write code that depends on this, you do so at your own risk.
  95  *  This code and its internal interfaces are subject to change or
  96  *  deletion without notice.&lt;/b&gt;
  97  */
  98 public class AttributeWriter extends BasicWriter
  99         implements Attribute.Visitor&lt;Void,Void&gt;
 100 {
 101     public static AttributeWriter instance(Context context) {
 102         AttributeWriter instance = context.get(AttributeWriter.class);
 103         if (instance == null)
 104             instance = new AttributeWriter(context);
 105         return instance;
 106     }
 107 
 108     protected AttributeWriter(Context context) {
 109         super(context);
</pre>
<hr />
<pre>
 868                 annotationWriter.write(attr.parameter_annotations[param][i]);
 869                 println();
 870             }
 871             indent(-1);
 872         }
 873         indent(-1);
 874     }
 875 
 876     @Override
 877     public Void visitRuntimeVisibleParameterAnnotations(RuntimeVisibleParameterAnnotations_attribute attr, Void ignore) {
 878         visitParameterAnnotations(&quot;RuntimeVisibleParameterAnnotations:&quot;, (RuntimeParameterAnnotations_attribute) attr);
 879         return null;
 880     }
 881 
 882     @Override
 883     public Void visitRuntimeInvisibleParameterAnnotations(RuntimeInvisibleParameterAnnotations_attribute attr, Void ignore) {
 884         visitParameterAnnotations(&quot;RuntimeInvisibleParameterAnnotations:&quot;, (RuntimeParameterAnnotations_attribute) attr);
 885         return null;
 886     }
 887 
















 888     @Override
 889     public Void visitSignature(Signature_attribute attr, Void ignore) {
 890         print(&quot;Signature: #&quot; + attr.signature_index);
 891         tab();
 892         println(&quot;// &quot; + getSignature(attr));
 893         return null;
 894     }
 895 
 896     String getSignature(Signature_attribute info) {
 897         try {
 898             return info.getSignature(constant_pool);
 899         } catch (ConstantPoolException e) {
 900             return report(e);
 901         }
 902     }
 903 
 904     @Override
 905     public Void visitSourceDebugExtension(SourceDebugExtension_attribute attr, Void ignore) {
 906         println(&quot;SourceDebugExtension:&quot;);
 907         indent(+1);
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2007, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
  51 import com.sun.tools.classfile.LineNumberTable_attribute;
  52 import com.sun.tools.classfile.LocalVariableTable_attribute;
  53 import com.sun.tools.classfile.LocalVariableTypeTable_attribute;
  54 import com.sun.tools.classfile.MethodParameters_attribute;
  55 import com.sun.tools.classfile.Module_attribute;
  56 import com.sun.tools.classfile.ModuleHashes_attribute;
  57 import com.sun.tools.classfile.ModuleMainClass_attribute;
  58 import com.sun.tools.classfile.ModulePackages_attribute;
  59 import com.sun.tools.classfile.ModuleResolution_attribute;
  60 import com.sun.tools.classfile.ModuleTarget_attribute;
  61 import com.sun.tools.classfile.NestHost_attribute;
  62 import com.sun.tools.classfile.NestMembers_attribute;
  63 import com.sun.tools.classfile.Record_attribute;
  64 import com.sun.tools.classfile.RuntimeInvisibleAnnotations_attribute;
  65 import com.sun.tools.classfile.RuntimeInvisibleParameterAnnotations_attribute;
  66 import com.sun.tools.classfile.RuntimeInvisibleTypeAnnotations_attribute;
  67 import com.sun.tools.classfile.RuntimeParameterAnnotations_attribute;
  68 import com.sun.tools.classfile.RuntimeVisibleAnnotations_attribute;
  69 import com.sun.tools.classfile.RuntimeVisibleParameterAnnotations_attribute;
  70 import com.sun.tools.classfile.RuntimeVisibleTypeAnnotations_attribute;
<span class="line-modified">  71 import com.sun.tools.classfile.PermittedSubclasses_attribute;</span>
  72 import com.sun.tools.classfile.Signature_attribute;
  73 import com.sun.tools.classfile.SourceDebugExtension_attribute;
  74 import com.sun.tools.classfile.SourceFile_attribute;
  75 import com.sun.tools.classfile.SourceID_attribute;
  76 import com.sun.tools.classfile.StackMapTable_attribute;
  77 import com.sun.tools.classfile.StackMap_attribute;
  78 import com.sun.tools.classfile.Synthetic_attribute;
  79 import com.sun.tools.classfile.Type;
  80 
  81 import static com.sun.tools.classfile.AccessFlags.*;
  82 
  83 import com.sun.tools.javac.util.Assert;
  84 import com.sun.tools.javac.util.StringUtils;
  85 




  86 /*
  87  *  A writer for writing Attributes as text.
  88  *
  89  *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
  90  *  If you write code that depends on this, you do so at your own risk.
  91  *  This code and its internal interfaces are subject to change or
  92  *  deletion without notice.&lt;/b&gt;
  93  */
  94 public class AttributeWriter extends BasicWriter
  95         implements Attribute.Visitor&lt;Void,Void&gt;
  96 {
  97     public static AttributeWriter instance(Context context) {
  98         AttributeWriter instance = context.get(AttributeWriter.class);
  99         if (instance == null)
 100             instance = new AttributeWriter(context);
 101         return instance;
 102     }
 103 
 104     protected AttributeWriter(Context context) {
 105         super(context);
</pre>
<hr />
<pre>
 864                 annotationWriter.write(attr.parameter_annotations[param][i]);
 865                 println();
 866             }
 867             indent(-1);
 868         }
 869         indent(-1);
 870     }
 871 
 872     @Override
 873     public Void visitRuntimeVisibleParameterAnnotations(RuntimeVisibleParameterAnnotations_attribute attr, Void ignore) {
 874         visitParameterAnnotations(&quot;RuntimeVisibleParameterAnnotations:&quot;, (RuntimeParameterAnnotations_attribute) attr);
 875         return null;
 876     }
 877 
 878     @Override
 879     public Void visitRuntimeInvisibleParameterAnnotations(RuntimeInvisibleParameterAnnotations_attribute attr, Void ignore) {
 880         visitParameterAnnotations(&quot;RuntimeInvisibleParameterAnnotations:&quot;, (RuntimeParameterAnnotations_attribute) attr);
 881         return null;
 882     }
 883 
<span class="line-added"> 884     @Override</span>
<span class="line-added"> 885     public Void visitPermittedSubclasses(PermittedSubclasses_attribute attr, Void ignore) {</span>
<span class="line-added"> 886         println(&quot;PermittedSubclasses:&quot;);</span>
<span class="line-added"> 887         indent(+1);</span>
<span class="line-added"> 888         try {</span>
<span class="line-added"> 889             CONSTANT_Class_info[] subtypes = attr.getSubtypes(constant_pool);</span>
<span class="line-added"> 890             for (int i = 0; i &lt; subtypes.length; i++) {</span>
<span class="line-added"> 891                 println(constantWriter.stringValue(subtypes[i]));</span>
<span class="line-added"> 892             }</span>
<span class="line-added"> 893             indent(-1);</span>
<span class="line-added"> 894         } catch (ConstantPoolException ex) {</span>
<span class="line-added"> 895             throw new AssertionError(ex);</span>
<span class="line-added"> 896         }</span>
<span class="line-added"> 897         return null;</span>
<span class="line-added"> 898     }</span>
<span class="line-added"> 899 </span>
 900     @Override
 901     public Void visitSignature(Signature_attribute attr, Void ignore) {
 902         print(&quot;Signature: #&quot; + attr.signature_index);
 903         tab();
 904         println(&quot;// &quot; + getSignature(attr));
 905         return null;
 906     }
 907 
 908     String getSignature(Signature_attribute info) {
 909         try {
 910             return info.getSignature(constant_pool);
 911         } catch (ConstantPoolException e) {
 912             return report(e);
 913         }
 914     }
 915 
 916     @Override
 917     public Void visitSourceDebugExtension(SourceDebugExtension_attribute attr, Void ignore) {
 918         println(&quot;SourceDebugExtension:&quot;);
 919         indent(+1);
</pre>
</td>
</tr>
</table>
<center><a href="../classfile/Code_attribute.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../jdk.jfr/share/classes/jdk/jfr/events/AbstractBufferStatisticsEvent.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>