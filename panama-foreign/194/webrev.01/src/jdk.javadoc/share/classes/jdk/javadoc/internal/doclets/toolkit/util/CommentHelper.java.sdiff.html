<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/util/CommentHelper.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../BaseConfiguration.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="DocPaths.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/util/CommentHelper.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
174         if (dcTree == null &amp;&amp; overriddenElement != null) {
175             CommentHelper ovch = utils.getCommentHelper(overriddenElement);
176             return ovch.getElement(rtree);
177         }
178         if (dcTree == null) {
179             return null;
180         }
181         DocTreePath docTreePath = DocTreePath.getPath(path, dcTree, rtree);
182         if (docTreePath == null) {
183             // Case B.
184             if (overriddenElement != null) {
185                 CommentHelper ovch = utils.getCommentHelper(overriddenElement);
186                 return ovch.getElement(rtree);
187             }
188             return null;
189         }
190         DocTrees doctrees = configuration.docEnv.getDocTrees();
191         return doctrees.getElement(docTreePath);
192     }
193 









194     public Element getException(DocTree dtree) {
195         if (dtree.getKind() == THROWS || dtree.getKind() == EXCEPTION) {
196             ThrowsTree tt = (ThrowsTree)dtree;
197             ReferenceTree exceptionName = tt.getExceptionName();
198             return getElement(exceptionName);
199         }
200         return null;
201     }
202 
203     public List&lt;? extends DocTree&gt; getDescription(DocTree dtree) {
204         return getTags(dtree);
205     }
206 
207     public String getText(List&lt;? extends DocTree&gt; list) {
208         StringBuilder sb = new StringBuilder();
209         for (DocTree dt : list) {
210             sb.append(getText0(dt));
211         }
212         return sb.toString();
213     }
</pre>
<hr />
<pre>
406     }
407 
408     public PackageElement getReferencedPackage(DocTree dtree) {
409         Element e = getReferencedElement(dtree);
410         if (e != null) {
411             Utils utils = configuration.utils;
412             return utils.containingPackage(e);
413         }
414         return null;
415     }
416 
417     public List&lt;? extends DocTree&gt; getFirstSentenceTrees(List&lt;? extends DocTree&gt; body) {
418         return configuration.docEnv.getDocTrees().getFirstSentence(body);
419     }
420 
421     public List&lt;? extends DocTree&gt; getFirstSentenceTrees(DocTree dtree) {
422         return getFirstSentenceTrees(getBody(dtree));
423     }
424 
425     private Element getReferencedElement(DocTree dtree) {
<span class="line-modified">426         return new SimpleDocTreeVisitor&lt;Element, Void&gt;() {</span>
<span class="line-removed">427             @Override</span>
<span class="line-removed">428             public Element visitSee(SeeTree node, Void p) {</span>
<span class="line-removed">429                 for (DocTree dt : node.getReference()) {</span>
<span class="line-removed">430                     return visit(dt, null);</span>
<span class="line-removed">431                 }</span>
<span class="line-removed">432                 return null;</span>
<span class="line-removed">433             }</span>
<span class="line-removed">434 </span>
<span class="line-removed">435             @Override</span>
<span class="line-removed">436             public Element visitLink(LinkTree node, Void p) {</span>
<span class="line-removed">437                 return visit(node.getReference(), null);</span>
<span class="line-removed">438             }</span>
<span class="line-removed">439 </span>
<span class="line-removed">440             @Override</span>
<span class="line-removed">441             public Element visitProvides(ProvidesTree node, Void p) {</span>
<span class="line-removed">442                 return visit(node.getServiceType(), null);</span>
<span class="line-removed">443             }</span>
<span class="line-removed">444 </span>
<span class="line-removed">445             @Override</span>
<span class="line-removed">446             public Element visitValue(ValueTree node, Void p) {</span>
<span class="line-removed">447                 return visit(node.getReference(), null);</span>
<span class="line-removed">448             }</span>
<span class="line-removed">449 </span>
450             @Override
451             public Element visitReference(ReferenceTree node, Void p) {
452                 return getElement(node);
453             }


454 


455             @Override
<span class="line-modified">456             public Element visitSerialField(SerialFieldTree node, Void p) {</span>
<span class="line-modified">457                 return visit(node.getType(), null);</span>
<span class="line-removed">458             }</span>
<span class="line-removed">459 </span>
<span class="line-removed">460             @Override</span>
<span class="line-removed">461             public Element visitUses(UsesTree node, Void p) {</span>
<span class="line-removed">462                 return visit(node.getServiceType(), null);</span>
<span class="line-removed">463             }</span>
<span class="line-removed">464 </span>
<span class="line-removed">465             @Override</span>
<span class="line-removed">466             protected Element defaultAction(DocTree node, Void p) {</span>
<span class="line-removed">467                return null;</span>
468             }
469         }.visit(dtree, null);
470     }
471 
472     public TypeElement getServiceType(DocTree dtree) {
473         Element e = getReferencedElement(dtree);
474         if (e != null) {
475             Utils utils = configuration.utils;
476             return utils.isTypeElement(e) ? (TypeElement) e : null;
477         }
478         return null;
479     }
480 
481     public  String getReferencedSignature(DocTree dtree) {
<span class="line-modified">482         return new SimpleDocTreeVisitor&lt;String, Void&gt;() {</span>
483             @Override
<span class="line-modified">484             public String visitSee(SeeTree node, Void p) {</span>
<span class="line-modified">485                 for (DocTree dt : node.getReference()) {</span>
<span class="line-removed">486                     return visit(dt, null);</span>
<span class="line-removed">487                 }</span>
<span class="line-removed">488                 return null;</span>
489             }


490 
<span class="line-modified">491             @Override</span>
<span class="line-modified">492             public String visitLink(LinkTree node, Void p) {</span>
<span class="line-modified">493                 return visit(node.getReference(), null);</span>


494             }


495 
<span class="line-modified">496             @Override</span>
<span class="line-modified">497             public String visitValue(ValueTree node, Void p) {</span>
<span class="line-modified">498                 return visit(node.getReference(), null);</span>
<span class="line-modified">499             }</span>
500 
<span class="line-modified">501             @Override</span>
<span class="line-modified">502             public String visitReference(ReferenceTree node, Void p) {</span>
<span class="line-modified">503                 return node.getSignature();</span>
<span class="line-modified">504             }</span>
505 
<span class="line-modified">506             @Override</span>
<span class="line-modified">507             public String visitSerialField(SerialFieldTree node, Void p) {</span>
<span class="line-modified">508                 return visit(node.getType(), null);</span>
<span class="line-modified">509             }</span>
510 
<span class="line-modified">511             @Override</span>
<span class="line-modified">512             protected String defaultAction(DocTree node, Void p) {</span>
<span class="line-modified">513                return null;</span>
<span class="line-modified">514             }</span>
<span class="line-modified">515         }.visit(dtree, null);</span>









516     }
517 
518     public List&lt;? extends DocTree&gt; getReference(DocTree dtree) {
519         return dtree.getKind() == SEE ? ((SeeTree)dtree).getReference() : null;
520     }
521 
522     public ReferenceTree getExceptionName(DocTree dtree) {
523         return (dtree.getKind() == THROWS || dtree.getKind() == EXCEPTION)
524                 ? ((ThrowsTree)dtree).getExceptionName()
525                 : null;
526     }
527 
528     public IdentifierTree getName(DocTree dtree) {
529         switch (dtree.getKind()) {
530             case PARAM:
531                 return ((ParamTree)dtree).getName();
532             case SERIAL_FIELD:
533                 return ((SerialFieldTree)dtree).getName();
534             default:
535                 return null;
</pre>
</td>
<td>
<hr />
<pre>
174         if (dcTree == null &amp;&amp; overriddenElement != null) {
175             CommentHelper ovch = utils.getCommentHelper(overriddenElement);
176             return ovch.getElement(rtree);
177         }
178         if (dcTree == null) {
179             return null;
180         }
181         DocTreePath docTreePath = DocTreePath.getPath(path, dcTree, rtree);
182         if (docTreePath == null) {
183             // Case B.
184             if (overriddenElement != null) {
185                 CommentHelper ovch = utils.getCommentHelper(overriddenElement);
186                 return ovch.getElement(rtree);
187             }
188             return null;
189         }
190         DocTrees doctrees = configuration.docEnv.getDocTrees();
191         return doctrees.getElement(docTreePath);
192     }
193 
<span class="line-added">194     public TypeMirror getType(ReferenceTree rtree) {</span>
<span class="line-added">195         DocTreePath docTreePath = DocTreePath.getPath(path, dcTree, rtree);</span>
<span class="line-added">196         if (docTreePath != null) {</span>
<span class="line-added">197             DocTrees doctrees = configuration.docEnv.getDocTrees();</span>
<span class="line-added">198             return doctrees.getType(docTreePath);</span>
<span class="line-added">199         }</span>
<span class="line-added">200         return null;</span>
<span class="line-added">201     }</span>
<span class="line-added">202 </span>
203     public Element getException(DocTree dtree) {
204         if (dtree.getKind() == THROWS || dtree.getKind() == EXCEPTION) {
205             ThrowsTree tt = (ThrowsTree)dtree;
206             ReferenceTree exceptionName = tt.getExceptionName();
207             return getElement(exceptionName);
208         }
209         return null;
210     }
211 
212     public List&lt;? extends DocTree&gt; getDescription(DocTree dtree) {
213         return getTags(dtree);
214     }
215 
216     public String getText(List&lt;? extends DocTree&gt; list) {
217         StringBuilder sb = new StringBuilder();
218         for (DocTree dt : list) {
219             sb.append(getText0(dt));
220         }
221         return sb.toString();
222     }
</pre>
<hr />
<pre>
415     }
416 
417     public PackageElement getReferencedPackage(DocTree dtree) {
418         Element e = getReferencedElement(dtree);
419         if (e != null) {
420             Utils utils = configuration.utils;
421             return utils.containingPackage(e);
422         }
423         return null;
424     }
425 
426     public List&lt;? extends DocTree&gt; getFirstSentenceTrees(List&lt;? extends DocTree&gt; body) {
427         return configuration.docEnv.getDocTrees().getFirstSentence(body);
428     }
429 
430     public List&lt;? extends DocTree&gt; getFirstSentenceTrees(DocTree dtree) {
431         return getFirstSentenceTrees(getBody(dtree));
432     }
433 
434     private Element getReferencedElement(DocTree dtree) {
<span class="line-modified">435         return new ReferenceDocTreeVisitor&lt;Element&gt;() {</span>























436             @Override
437             public Element visitReference(ReferenceTree node, Void p) {
438                 return getElement(node);
439             }
<span class="line-added">440         }.visit(dtree, null);</span>
<span class="line-added">441     }</span>
442 
<span class="line-added">443     public TypeMirror getReferencedType(DocTree dtree) {</span>
<span class="line-added">444         return new ReferenceDocTreeVisitor&lt;TypeMirror&gt;() {</span>
445             @Override
<span class="line-modified">446             public TypeMirror visitReference(ReferenceTree node, Void p) {</span>
<span class="line-modified">447                 return getType(node);</span>










448             }
449         }.visit(dtree, null);
450     }
451 
452     public TypeElement getServiceType(DocTree dtree) {
453         Element e = getReferencedElement(dtree);
454         if (e != null) {
455             Utils utils = configuration.utils;
456             return utils.isTypeElement(e) ? (TypeElement) e : null;
457         }
458         return null;
459     }
460 
461     public  String getReferencedSignature(DocTree dtree) {
<span class="line-modified">462         return new ReferenceDocTreeVisitor&lt;String&gt;() {</span>
463             @Override
<span class="line-modified">464             public String visitReference(ReferenceTree node, Void p) {</span>
<span class="line-modified">465                 return node.getSignature();</span>



466             }
<span class="line-added">467         }.visit(dtree, null);</span>
<span class="line-added">468     }</span>
469 
<span class="line-modified">470     private static class ReferenceDocTreeVisitor&lt;R&gt; extends SimpleDocTreeVisitor&lt;R, Void&gt; {</span>
<span class="line-modified">471         @Override</span>
<span class="line-modified">472         public R visitSee(SeeTree node, Void p) {</span>
<span class="line-added">473             for (DocTree dt : node.getReference()) {</span>
<span class="line-added">474                 return visit(dt, null);</span>
475             }
<span class="line-added">476             return null;</span>
<span class="line-added">477         }</span>
478 
<span class="line-modified">479         @Override</span>
<span class="line-modified">480         public R visitLink(LinkTree node, Void p) {</span>
<span class="line-modified">481             return visit(node.getReference(), null);</span>
<span class="line-modified">482         }</span>
483 
<span class="line-modified">484         @Override</span>
<span class="line-modified">485         public R visitProvides(ProvidesTree node, Void p) {</span>
<span class="line-modified">486             return visit(node.getServiceType(), null);</span>
<span class="line-modified">487         }</span>
488 
<span class="line-modified">489         @Override</span>
<span class="line-modified">490         public R visitValue(ValueTree node, Void p) {</span>
<span class="line-modified">491             return visit(node.getReference(), null);</span>
<span class="line-modified">492         }</span>
493 
<span class="line-modified">494         @Override</span>
<span class="line-modified">495         public R visitSerialField(SerialFieldTree node, Void p) {</span>
<span class="line-modified">496             return visit(node.getType(), null);</span>
<span class="line-modified">497         }</span>
<span class="line-modified">498 </span>
<span class="line-added">499         @Override</span>
<span class="line-added">500         public R visitUses(UsesTree node, Void p) {</span>
<span class="line-added">501             return visit(node.getServiceType(), null);</span>
<span class="line-added">502         }</span>
<span class="line-added">503 </span>
<span class="line-added">504         @Override</span>
<span class="line-added">505         protected R defaultAction(DocTree node, Void p) {</span>
<span class="line-added">506             return null;</span>
<span class="line-added">507         }</span>
508     }
509 
510     public List&lt;? extends DocTree&gt; getReference(DocTree dtree) {
511         return dtree.getKind() == SEE ? ((SeeTree)dtree).getReference() : null;
512     }
513 
514     public ReferenceTree getExceptionName(DocTree dtree) {
515         return (dtree.getKind() == THROWS || dtree.getKind() == EXCEPTION)
516                 ? ((ThrowsTree)dtree).getExceptionName()
517                 : null;
518     }
519 
520     public IdentifierTree getName(DocTree dtree) {
521         switch (dtree.getKind()) {
522             case PARAM:
523                 return ((ParamTree)dtree).getName();
524             case SERIAL_FIELD:
525                 return ((SerialFieldTree)dtree).getName();
526             default:
527                 return null;
</pre>
</td>
</tr>
</table>
<center><a href="../BaseConfiguration.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="DocPaths.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>