diff a/src/jdk.incubator.jextract/share/classes/jdk/internal/clang/Index.java b/src/jdk.incubator.jextract/share/classes/jdk/internal/clang/Index.java
--- a/src/jdk.incubator.jextract/share/classes/jdk/internal/clang/Index.java
+++ b/src/jdk.incubator.jextract/share/classes/jdk/internal/clang/Index.java
@@ -25,10 +25,11 @@
  */
 
 package jdk.internal.clang;
 
 import jdk.incubator.foreign.MemoryAddress;
+import jdk.incubator.foreign.MemoryHandles;
 import jdk.incubator.foreign.MemorySegment;
 import jdk.internal.clang.libclang.Index_h;
 
 import java.lang.invoke.VarHandle;
 import java.nio.file.Path;
@@ -73,11 +74,12 @@
             this.srcFile = srcFile;
             this.code = code;
         }
     }
 
-    private static final VarHandle VH_MemoryAddress = C_POINTER.varHandle(MemoryAddress.class);
+    private static final VarHandle VH_MemoryAddress =
+            MemoryHandles.asAddressVarHandle(C_POINTER.varHandle(long.class));
 
     public TranslationUnit parseTU(String file, Consumer<Diagnostic> dh, int options, String... args)
     throws ParsingFailedException {
         try (MemorySegment src = Utils.toNativeString(file) ;
              MemorySegment cargs = Utils.toNativeStringArray(args);
