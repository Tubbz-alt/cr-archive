<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.incubator.foreign/share/classes/jdk/incubator/foreign/CSupport.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>src/jdk.incubator.foreign/share/classes/jdk/incubator/foreign/CSupport.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
516         public static final ValueLayout C_DOUBLE = MemoryLayouts.BITS_64_LE
517                 .withAttribute(CLASS_ATTRIBUTE_NAME, ArgumentClass.VECTOR);
518 
519         /**
520          * The {@code long double} native type.
521          */
522         public static final ValueLayout C_LONGDOUBLE = MemoryLayout.ofValueBits(128, ByteOrder.LITTLE_ENDIAN)
523                 .withAttribute(CLASS_ATTRIBUTE_NAME, ArgumentClass.VECTOR);
524 
525         /**
526          * The {@code T*} native type.
527          */
528         public static final ValueLayout C_POINTER = MemoryLayouts.BITS_64_LE
529                 .withAttribute(CLASS_ATTRIBUTE_NAME, ArgumentClass.POINTER);
530     }
531 
532     private final static VarHandle byteArrHandle =
533             MemoryLayout.ofSequence(C_CHAR).varHandle(byte.class, MemoryLayout.PathElement.sequenceElement());
534 
535     /**
<span class="line-modified">536      * Convert a Java string into a null-terminated C string, using the given</span>
<span class="line-modified">537      * {@linkplain java.nio.charset.Charset charset}, storing the result into a</span>
<span class="line-removed">538      * new native memory segment.</span>
539      * &lt;p&gt;
540      * This method always replaces malformed-input and unmappable-character
541      * sequences with this charset&#39;s default replacement byte array.  The
542      * {@link java.nio.charset.CharsetEncoder} class should be used when more
543      * control over the encoding process is required.
544      *
545      * @param str the Java string to be converted into a C string.
546      * @return a new native memory segment containing the converted C string.
547      * @throws NullPointerException if either {@code str == null}.
548      */
549     public static MemorySegment toCString(String str) {
550         Objects.requireNonNull(str);
551         return toCString(str.getBytes());
552     }
553 
554     /**
<span class="line-modified">555      * Convert a Java string into a null-terminated C string, using the</span>
<span class="line-modified">556      * platform&#39;s default charset, storing the result into a new native memory segment.</span>
557      * &lt;p&gt;
558      * This method always replaces malformed-input and unmappable-character
559      * sequences with this charset&#39;s default replacement byte array.  The
560      * {@link java.nio.charset.CharsetEncoder} class should be used when more
561      * control over the encoding process is required.
562      *
563      * @param str the Java string to be converted into a C string.
564      * @param charset The {@linkplain java.nio.charset.Charset} to be used to compute the contents of the C string.
565      * @return a new native memory segment containing the converted C string.
566      * @throws NullPointerException if either {@code str == null} or {@code charset == null}.
567      */
568     public static MemorySegment toCString(String str, Charset charset) {
569         Objects.requireNonNull(str);
570         Objects.requireNonNull(charset);
571         return toCString(str.getBytes(charset));
572     }
573 
574     /**
<span class="line-modified">575      * Convert a Java string into a null-terminated C string, using the given</span>
<span class="line-modified">576      * {@linkplain java.nio.charset.Charset charset}, storing the result into a</span>
<span class="line-removed">577      * native memory segment allocated using the provided scope.</span>
578      * &lt;p&gt;
579      * This method always replaces malformed-input and unmappable-character
580      * sequences with this charset&#39;s default replacement byte array.  The
581      * {@link java.nio.charset.CharsetEncoder} class should be used when more
582      * control over the encoding process is required.
583      *
584      * @param str the Java string to be converted into a C string.
585      * @param scope the scope to be used for the native segment allocation.
586      * @return a new native memory segment containing the converted C string.
587      * @throws NullPointerException if either {@code str == null} or {@code scope == null}.
588      */
589     public static MemoryAddress toCString(String str, NativeScope scope) {
590         Objects.requireNonNull(str);
591         Objects.requireNonNull(scope);
592         return toCString(str.getBytes(), scope);
593     }
594 
595     /**
<span class="line-modified">596      * Convert a Java string into a null-terminated C string, using the</span>
<span class="line-modified">597      * platform&#39;s default charset, storing the result into a new native memory segment</span>
<span class="line-removed">598      * native memory segment allocated using the provided scope.</span>
599      * &lt;p&gt;
600      * This method always replaces malformed-input and unmappable-character
601      * sequences with this charset&#39;s default replacement byte array.  The
602      * {@link java.nio.charset.CharsetEncoder} class should be used when more
603      * control over the encoding process is required.
604      *
605      * @param str the Java string to be converted into a C string.
606      * @param charset The {@linkplain java.nio.charset.Charset} to be used to compute the contents of the C string.
607      * @param scope the scope to be used for the native segment allocation.
608      * @return a new native memory segment containing the converted C string.
609      * @throws NullPointerException if either {@code str == null}, {@code charset == null} or {@code scope == null}.
610      */
611     public static MemoryAddress toCString(String str, Charset charset, NativeScope scope) {
612         Objects.requireNonNull(str);
613         Objects.requireNonNull(charset);
614         Objects.requireNonNull(scope);
615         return toCString(str.getBytes(charset), scope);
616     }
617 
618     /**
</pre>
</td>
<td>
<hr />
<pre>
516         public static final ValueLayout C_DOUBLE = MemoryLayouts.BITS_64_LE
517                 .withAttribute(CLASS_ATTRIBUTE_NAME, ArgumentClass.VECTOR);
518 
519         /**
520          * The {@code long double} native type.
521          */
522         public static final ValueLayout C_LONGDOUBLE = MemoryLayout.ofValueBits(128, ByteOrder.LITTLE_ENDIAN)
523                 .withAttribute(CLASS_ATTRIBUTE_NAME, ArgumentClass.VECTOR);
524 
525         /**
526          * The {@code T*} native type.
527          */
528         public static final ValueLayout C_POINTER = MemoryLayouts.BITS_64_LE
529                 .withAttribute(CLASS_ATTRIBUTE_NAME, ArgumentClass.POINTER);
530     }
531 
532     private final static VarHandle byteArrHandle =
533             MemoryLayout.ofSequence(C_CHAR).varHandle(byte.class, MemoryLayout.PathElement.sequenceElement());
534 
535     /**
<span class="line-modified">536      * Convert a Java string into a null-terminated C string, using the</span>
<span class="line-modified">537      * platform&#39;s default charset, storing the result into a new native memory segment.</span>

538      * &lt;p&gt;
539      * This method always replaces malformed-input and unmappable-character
540      * sequences with this charset&#39;s default replacement byte array.  The
541      * {@link java.nio.charset.CharsetEncoder} class should be used when more
542      * control over the encoding process is required.
543      *
544      * @param str the Java string to be converted into a C string.
545      * @return a new native memory segment containing the converted C string.
546      * @throws NullPointerException if either {@code str == null}.
547      */
548     public static MemorySegment toCString(String str) {
549         Objects.requireNonNull(str);
550         return toCString(str.getBytes());
551     }
552 
553     /**
<span class="line-modified">554      * Convert a Java string into a null-terminated C string, using the given {@linkplain java.nio.charset.Charset charset},</span>
<span class="line-modified">555      * storing the result into a new native memory segment.</span>
556      * &lt;p&gt;
557      * This method always replaces malformed-input and unmappable-character
558      * sequences with this charset&#39;s default replacement byte array.  The
559      * {@link java.nio.charset.CharsetEncoder} class should be used when more
560      * control over the encoding process is required.
561      *
562      * @param str the Java string to be converted into a C string.
563      * @param charset The {@linkplain java.nio.charset.Charset} to be used to compute the contents of the C string.
564      * @return a new native memory segment containing the converted C string.
565      * @throws NullPointerException if either {@code str == null} or {@code charset == null}.
566      */
567     public static MemorySegment toCString(String str, Charset charset) {
568         Objects.requireNonNull(str);
569         Objects.requireNonNull(charset);
570         return toCString(str.getBytes(charset));
571     }
572 
573     /**
<span class="line-modified">574      * Convert a Java string into a null-terminated C string, using the platform&#39;s default charset,</span>
<span class="line-modified">575      * storing the result into a native memory segment allocated using the provided scope.</span>

576      * &lt;p&gt;
577      * This method always replaces malformed-input and unmappable-character
578      * sequences with this charset&#39;s default replacement byte array.  The
579      * {@link java.nio.charset.CharsetEncoder} class should be used when more
580      * control over the encoding process is required.
581      *
582      * @param str the Java string to be converted into a C string.
583      * @param scope the scope to be used for the native segment allocation.
584      * @return a new native memory segment containing the converted C string.
585      * @throws NullPointerException if either {@code str == null} or {@code scope == null}.
586      */
587     public static MemoryAddress toCString(String str, NativeScope scope) {
588         Objects.requireNonNull(str);
589         Objects.requireNonNull(scope);
590         return toCString(str.getBytes(), scope);
591     }
592 
593     /**
<span class="line-modified">594      * Convert a Java string into a null-terminated C string, using the given {@linkplain java.nio.charset.Charset charset},</span>
<span class="line-modified">595      * storing the result into a new native memory segment native memory segment allocated using the provided scope.</span>

596      * &lt;p&gt;
597      * This method always replaces malformed-input and unmappable-character
598      * sequences with this charset&#39;s default replacement byte array.  The
599      * {@link java.nio.charset.CharsetEncoder} class should be used when more
600      * control over the encoding process is required.
601      *
602      * @param str the Java string to be converted into a C string.
603      * @param charset The {@linkplain java.nio.charset.Charset} to be used to compute the contents of the C string.
604      * @param scope the scope to be used for the native segment allocation.
605      * @return a new native memory segment containing the converted C string.
606      * @throws NullPointerException if either {@code str == null}, {@code charset == null} or {@code scope == null}.
607      */
608     public static MemoryAddress toCString(String str, Charset charset, NativeScope scope) {
609         Objects.requireNonNull(str);
610         Objects.requireNonNull(charset);
611         Objects.requireNonNull(scope);
612         return toCString(str.getBytes(charset), scope);
613     }
614 
615     /**
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>