<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New make/CompileToolsHotspot.gmk</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
  <body>
    <pre>
  1 #
  2 # Copyright (c) 2016, 2020, Oracle and/or its affiliates. All rights reserved.
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
 23 # questions.
 24 #
 25 
 26 # This must be the first rule
 27 default: all
 28 
 29 include $(SPEC)
 30 include MakeBase.gmk
 31 
 32 include JavaCompilation.gmk
 33 
 34 TARGETS :=
 35 
 36 # Hook to include the corresponding custom file, if present.
 37 $(eval $(call IncludeCustomExtension, hotspot/CompileTools.gmk))
 38 
 39 ################################################################################
 40 # Build tools needed for the JFR source code generation
 41 
 42 HOTSPOT_TOOLS_SRCDIR := $(TOPDIR)/make/src/classes
 43 
 44 HOTSPOT_TOOLS_OUTPUTDIR := $(BUILDTOOLS_OUTPUTDIR)/buildtools/hotspot_tools_classes
 45 
 46 $(eval $(call SetupJavaCompilation, BUILD_TOOLS_HOTSPOT, \
 47     COMPILER := bootjdk, \
 48     SRC := $(HOTSPOT_TOOLS_SRCDIR), \
 49     BIN := $(HOTSPOT_TOOLS_OUTPUTDIR), \
 50 ))
 51 
 52 TARGETS += $(BUILD_TOOLS_HOTSPOT)
 53 
 54 
 55 ################################################################################
 56 # Graal build tools
 57 ifeq ($(INCLUDE_GRAAL), true)
 58   VM_CI_SRC_DIR := $(TOPDIR)/src/jdk.internal.vm.ci/share/classes
 59 
 60   SRC_DIR := $(TOPDIR)/src/jdk.internal.vm.compiler/share/classes
 61 
 62   ##############################################################################
 63   # Compile the annotation processors
 64   $(eval $(call SetupJavaCompilation, BUILD_VM_COMPILER_MATCH_PROCESSOR, \
 65       TARGET_RELEASE := $(TARGET_RELEASE_BOOTJDK), \
 66       SRC := \
 67           $(SRC_DIR)/org.graalvm.compiler.processor/src \
 68           $(SRC_DIR)/org.graalvm.compiler.core.match.processor/src \
 69           , \
 70       EXCLUDE_FILES := $(EXCLUDE_FILES), \
 71       BIN := $(BUILDTOOLS_OUTPUTDIR)/jdk.vm.compiler.match.processor, \
 72       JAR := $(BUILDTOOLS_OUTPUTDIR)/jdk.vm.compiler.match.processor.jar, \
 73       DISABLED_WARNINGS := options, \
 74   ))
 75 
 76   TARGETS += $(BUILD_VM_COMPILER_MATCH_PROCESSOR)
 77 
 78   ##############################################################################
 79 
 80   $(eval $(call SetupJavaCompilation, BUILD_VM_COMPILER_NODEINFO_PROCESSOR, \
 81       TARGET_RELEASE := $(TARGET_RELEASE_BOOTJDK), \
 82       SRC := \
 83           $(SRC_DIR)/org.graalvm.compiler.processor/src \
 84           $(SRC_DIR)/org.graalvm.compiler.nodeinfo.processor/src \
 85           , \
 86       BIN := $(BUILDTOOLS_OUTPUTDIR)/jdk.vm.compiler.nodeinfo.processor, \
 87       JAR := $(BUILDTOOLS_OUTPUTDIR)/jdk.vm.compiler.nodeinfo.processor.jar, \
 88       DISABLED_WARNINGS := options, \
 89   ))
 90 
 91   TARGETS += $(BUILD_VM_COMPILER_NODEINFO_PROCESSOR)
 92 
 93   ##############################################################################
 94 
 95   $(eval $(call SetupJavaCompilation, BUILD_VM_COMPILER_OPTIONS_PROCESSOR, \
 96       TARGET_RELEASE := $(TARGET_RELEASE_BOOTJDK), \
 97       DISABLED_WARNINGS := options, \
 98       SRC := \
 99           $(SRC_DIR)/org.graalvm.compiler.processor/src \
100           $(SRC_DIR)/org.graalvm.compiler.options.processor/src \
101           , \
102       BIN := $(BUILDTOOLS_OUTPUTDIR)/jdk.vm.compiler.options.processor, \
103       JAR := $(BUILDTOOLS_OUTPUTDIR)/jdk.vm.compiler.options.processor.jar, \
104   ))
105 
106   TARGETS += $(BUILD_VM_COMPILER_OPTIONS_PROCESSOR)
107 
108   ##############################################################################
109 
110   $(eval $(call SetupJavaCompilation, BUILD_VM_COMPILER_REPLACEMENTS_PROCESSOR, \
111       TARGET_RELEASE := $(TARGET_RELEASE_BOOTJDK), \
112       SRC := \
113           $(SRC_DIR)/org.graalvm.compiler.processor/src \
114           $(SRC_DIR)/org.graalvm.compiler.replacements.processor/src \
115           , \
116       EXCLUDE_FILES := $(EXCLUDE_FILES), \
117       BIN := $(BUILDTOOLS_OUTPUTDIR)/jdk.vm.compiler.replacements.verifier, \
118       JAR := $(BUILDTOOLS_OUTPUTDIR)/jdk.vm.compiler.replacements.verifier.jar, \
119       DISABLED_WARNINGS := options, \
120   ))
121 
122   TARGETS += $(BUILD_VM_COMPILER_REPLACEMENTS_PROCESSOR)
123 
124   ##############################################################################
125 
126   $(eval $(call SetupJavaCompilation, BUILD_VM_COMPILER_SERVICEPROVIDER_PROCESSOR, \
127       TARGET_RELEASE := $(TARGET_RELEASE_BOOTJDK), \
128       SRC := \
129           $(SRC_DIR)/org.graalvm.compiler.processor/src \
130           $(SRC_DIR)/org.graalvm.compiler.serviceprovider.processor/src \
131           , \
132       EXCLUDE_FILES := $(EXCLUDE_FILES), \
133       BIN := $(BUILDTOOLS_OUTPUTDIR)/jdk.vm.compiler.serviceprovider.processor, \
134       JAR := $(BUILDTOOLS_OUTPUTDIR)/jdk.vm.compiler.serviceprovider.processor.jar, \
135       DISABLED_WARNINGS := options, \
136   ))
137 
138   TARGETS += $(BUILD_VM_COMPILER_SERVICEPROVIDER_PROCESSOR)
139 
140   ##############################################################################
141 endif
142 
143 all: $(TARGETS)
144 
145 .PHONY: all
    </pre>
  </body>
</html>