<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/langtools/src/classes/build/tools/symbolgenerator/CreateSymbols.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../hotspot/lib/JvmOverrideFiles.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../modules/jdk.jfr/Copy.gmk.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/langtools/src/classes/build/tools/symbolgenerator/CreateSymbols.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
1050 
1051         for (AnnotationDescription ad : desc) {
1052             result[i++] = createAnnotation(constantPool, ad);
1053         }
1054 
1055         return result;
1056     }
1057 
1058     private Annotation[][] createParameterAnnotations(List&lt;CPInfo&gt; constantPool, List&lt;List&lt;AnnotationDescription&gt;&gt; desc) {
1059         Annotation[][] result = new Annotation[desc.size()][];
1060         int i = 0;
1061 
1062         for (List&lt;AnnotationDescription&gt; paramAnnos : desc) {
1063             result[i++] = createAnnotations(constantPool, paramAnnos);
1064         }
1065 
1066         return result;
1067     }
1068 
1069     private Annotation createAnnotation(List&lt;CPInfo&gt; constantPool, AnnotationDescription desc) {








1070         return new Annotation(null,
<span class="line-modified">1071                               addString(constantPool, desc.annotationType),</span>
1072                               createElementPairs(constantPool, desc.values));
1073     }





1074 
1075     private element_value_pair[] createElementPairs(List&lt;CPInfo&gt; constantPool, Map&lt;String, Object&gt; annotationAttributes) {
1076         element_value_pair[] pairs = new element_value_pair[annotationAttributes.size()];
1077         int i = 0;
1078 
1079         for (Entry&lt;String, Object&gt; e : annotationAttributes.entrySet()) {
1080             int elementNameString = addString(constantPool, e.getKey());
1081             element_value value = createAttributeValue(constantPool, e.getValue());
1082             pairs[i++] = new element_value_pair(elementNameString, value);
1083         }
1084 
1085         return pairs;
1086     }
1087 
1088     private element_value createAttributeValue(List&lt;CPInfo&gt; constantPool, Object value) {
1089         Pair&lt;Integer, Character&gt; constantPoolEntry = addConstant(constantPool, value, true);
1090         if (constantPoolEntry != null) {
1091             return new Primitive_element_value(constantPoolEntry.fst, constantPoolEntry.snd);
1092         } else if (value instanceof EnumConstant) {
1093             EnumConstant ec = (EnumConstant) value;
</pre>
</td>
<td>
<hr />
<pre>
1050 
1051         for (AnnotationDescription ad : desc) {
1052             result[i++] = createAnnotation(constantPool, ad);
1053         }
1054 
1055         return result;
1056     }
1057 
1058     private Annotation[][] createParameterAnnotations(List&lt;CPInfo&gt; constantPool, List&lt;List&lt;AnnotationDescription&gt;&gt; desc) {
1059         Annotation[][] result = new Annotation[desc.size()][];
1060         int i = 0;
1061 
1062         for (List&lt;AnnotationDescription&gt; paramAnnos : desc) {
1063             result[i++] = createAnnotations(constantPool, paramAnnos);
1064         }
1065 
1066         return result;
1067     }
1068 
1069     private Annotation createAnnotation(List&lt;CPInfo&gt; constantPool, AnnotationDescription desc) {
<span class="line-added">1070         String annotationType = desc.annotationType;</span>
<span class="line-added">1071 </span>
<span class="line-added">1072         if (PREVIEW_FEATURE_ANNOTATION.equals(annotationType)) {</span>
<span class="line-added">1073             //the non-public PreviewFeature annotation will not be available in ct.sym,</span>
<span class="line-added">1074             //replace with purely synthetic javac-internal annotation:</span>
<span class="line-added">1075             annotationType = PREVIEW_FEATURE_ANNOTATION_INTERNAL;</span>
<span class="line-added">1076         }</span>
<span class="line-added">1077 </span>
1078         return new Annotation(null,
<span class="line-modified">1079                               addString(constantPool, annotationType),</span>
1080                               createElementPairs(constantPool, desc.values));
1081     }
<span class="line-added">1082     //where:</span>
<span class="line-added">1083         private static final String PREVIEW_FEATURE_ANNOTATION =</span>
<span class="line-added">1084                 &quot;Ljdk/internal/PreviewFeature;&quot;;</span>
<span class="line-added">1085         private static final String PREVIEW_FEATURE_ANNOTATION_INTERNAL =</span>
<span class="line-added">1086                 &quot;Ljdk/internal/PreviewFeature+Annotation;&quot;;</span>
1087 
1088     private element_value_pair[] createElementPairs(List&lt;CPInfo&gt; constantPool, Map&lt;String, Object&gt; annotationAttributes) {
1089         element_value_pair[] pairs = new element_value_pair[annotationAttributes.size()];
1090         int i = 0;
1091 
1092         for (Entry&lt;String, Object&gt; e : annotationAttributes.entrySet()) {
1093             int elementNameString = addString(constantPool, e.getKey());
1094             element_value value = createAttributeValue(constantPool, e.getValue());
1095             pairs[i++] = new element_value_pair(elementNameString, value);
1096         }
1097 
1098         return pairs;
1099     }
1100 
1101     private element_value createAttributeValue(List&lt;CPInfo&gt; constantPool, Object value) {
1102         Pair&lt;Integer, Character&gt; constantPoolEntry = addConstant(constantPool, value, true);
1103         if (constantPoolEntry != null) {
1104             return new Primitive_element_value(constantPoolEntry.fst, constantPoolEntry.snd);
1105         } else if (value instanceof EnumConstant) {
1106             EnumConstant ec = (EnumConstant) value;
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../hotspot/lib/JvmOverrideFiles.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../modules/jdk.jfr/Copy.gmk.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>