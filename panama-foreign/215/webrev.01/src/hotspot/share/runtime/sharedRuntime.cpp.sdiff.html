<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/runtime/sharedRuntime.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="safepoint.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="sweeper.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/runtime/sharedRuntime.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 754   if (delayed) {
 755     java_lang_Throwable::set_message(exception_oop,
 756                                      Universe::delayed_stack_overflow_error_message());
 757   }
 758   Handle exception (thread, exception_oop);
 759   if (StackTraceInThrowable) {
 760     java_lang_Throwable::fill_in_stack_trace(exception);
 761   }
 762   // Increment counter for hs_err file reporting
 763   Atomic::inc(&amp;Exceptions::_stack_overflow_errors);
 764   throw_and_post_jvmti_exception(thread, exception);
 765 }
 766 
 767 address SharedRuntime::continuation_for_implicit_exception(JavaThread* thread,
 768                                                            address pc,
 769                                                            ImplicitExceptionKind exception_kind)
 770 {
 771   address target_pc = NULL;
 772 
 773   if (Interpreter::contains(pc)) {
<span class="line-removed"> 774 #ifdef CC_INTERP</span>
<span class="line-removed"> 775     // C++ interpreter doesn&#39;t throw implicit exceptions</span>
<span class="line-removed"> 776     ShouldNotReachHere();</span>
<span class="line-removed"> 777 #else</span>
 778     switch (exception_kind) {
 779       case IMPLICIT_NULL:           return Interpreter::throw_NullPointerException_entry();
 780       case IMPLICIT_DIVIDE_BY_ZERO: return Interpreter::throw_ArithmeticException_entry();
 781       case STACK_OVERFLOW:          return Interpreter::throw_StackOverflowError_entry();
 782       default:                      ShouldNotReachHere();
 783     }
<span class="line-removed"> 784 #endif // !CC_INTERP</span>
 785   } else {
 786     switch (exception_kind) {
 787       case STACK_OVERFLOW: {
 788         // Stack overflow only occurs upon frame setup; the callee is
 789         // going to be unwound. Dispatch to a shared runtime stub
 790         // which will cause the StackOverflowError to be fabricated
 791         // and processed.
 792         // Stack overflow should never occur during deoptimization:
 793         // the compiled method bangs the stack by as much as the
 794         // interpreter would need in case of a deoptimization. The
 795         // deoptimization blob and uncommon trap blob bang the stack
 796         // in a debug VM to verify the correctness of the compiled
 797         // method stack banging.
 798         assert(thread-&gt;deopt_mark() == NULL, &quot;no stack overflow from deopt blob/uncommon trap&quot;);
 799         Events::log_exception(thread, &quot;StackOverflowError at &quot; INTPTR_FORMAT, p2i(pc));
 800         return StubRoutines::throw_StackOverflowError_entry();
 801       }
 802 
 803       case IMPLICIT_NULL: {
 804         if (VtableStubs::contains(pc)) {
</pre>
</td>
<td>
<hr />
<pre>
 754   if (delayed) {
 755     java_lang_Throwable::set_message(exception_oop,
 756                                      Universe::delayed_stack_overflow_error_message());
 757   }
 758   Handle exception (thread, exception_oop);
 759   if (StackTraceInThrowable) {
 760     java_lang_Throwable::fill_in_stack_trace(exception);
 761   }
 762   // Increment counter for hs_err file reporting
 763   Atomic::inc(&amp;Exceptions::_stack_overflow_errors);
 764   throw_and_post_jvmti_exception(thread, exception);
 765 }
 766 
 767 address SharedRuntime::continuation_for_implicit_exception(JavaThread* thread,
 768                                                            address pc,
 769                                                            ImplicitExceptionKind exception_kind)
 770 {
 771   address target_pc = NULL;
 772 
 773   if (Interpreter::contains(pc)) {




 774     switch (exception_kind) {
 775       case IMPLICIT_NULL:           return Interpreter::throw_NullPointerException_entry();
 776       case IMPLICIT_DIVIDE_BY_ZERO: return Interpreter::throw_ArithmeticException_entry();
 777       case STACK_OVERFLOW:          return Interpreter::throw_StackOverflowError_entry();
 778       default:                      ShouldNotReachHere();
 779     }

 780   } else {
 781     switch (exception_kind) {
 782       case STACK_OVERFLOW: {
 783         // Stack overflow only occurs upon frame setup; the callee is
 784         // going to be unwound. Dispatch to a shared runtime stub
 785         // which will cause the StackOverflowError to be fabricated
 786         // and processed.
 787         // Stack overflow should never occur during deoptimization:
 788         // the compiled method bangs the stack by as much as the
 789         // interpreter would need in case of a deoptimization. The
 790         // deoptimization blob and uncommon trap blob bang the stack
 791         // in a debug VM to verify the correctness of the compiled
 792         // method stack banging.
 793         assert(thread-&gt;deopt_mark() == NULL, &quot;no stack overflow from deopt blob/uncommon trap&quot;);
 794         Events::log_exception(thread, &quot;StackOverflowError at &quot; INTPTR_FORMAT, p2i(pc));
 795         return StubRoutines::throw_StackOverflowError_entry();
 796       }
 797 
 798       case IMPLICIT_NULL: {
 799         if (VtableStubs::contains(pc)) {
</pre>
</td>
</tr>
</table>
<center><a href="safepoint.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="sweeper.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>