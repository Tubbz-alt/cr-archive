<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/langtools/jdk/javadoc/lib/javadoc/tester/JavadocTester.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../doclet/testTypeAnnotations/TestTypeAnnotations.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../tool/doclint/DocLintTest.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/langtools/jdk/javadoc/lib/javadoc/tester/JavadocTester.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -60,11 +60,11 @@</span>
   * Test framework for running javadoc and performing tests on the resulting output.
   *
   * &lt;p&gt;
   * Tests are typically written as subtypes of JavadocTester, with a main
   * method that creates an instance of the test class and calls the runTests()
<span class="udiff-line-modified-removed">-  * method. The runTests() methods calls all the test methods declared in the class,</span>
<span class="udiff-line-modified-added">+  * method. The runTests() method calls all the test methods declared in the class,</span>
   * and then calls a method to print a summary, and throw an exception if
   * any of the test methods reported a failure.
   *
   * &lt;p&gt;
   * Test methods are identified with a @Test annotation. They have no parameters.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -109,25 +109,26 @@</span>
   * &lt;/code&gt;&lt;/pre&gt;
   *
   * &lt;p&gt;
   * If javadoc is run more than once in a test method, you can compare the
   * results that are generated with the diff method. Since files written by
<span class="udiff-line-modified-removed">-  * javadoc typically contain a timestamp, you may want to use the -notimestamp</span>
<span class="udiff-line-modified-added">+  * javadoc typically contain a timestamp, you may want to use the {@code -notimestamp}</span>
   * option if you are going to compare the results from two runs of javadoc.
   *
   * &lt;p&gt;
   * If you have many calls of checkOutput that are very similar, you can write
   * your own check... method to reduce the amount of duplication. For example,
   * if you want to check that many files contain the same string, you could
   * write a method that takes a varargs list of files and calls checkOutput
   * on each file in turn with the string to be checked.
   *
   * &lt;p&gt;
<span class="udiff-line-modified-removed">-  * You can also write you own custom check methods, which can use</span>
<span class="udiff-line-modified-removed">-  * readFile to get the contents of a file generated by javadoc,</span>
<span class="udiff-line-modified-removed">-  * and then use pass(...) or fail(...) to report whether the check</span>
<span class="udiff-line-modified-removed">-  * succeeded or not.</span>
<span class="udiff-line-modified-added">+  * You can also write your own custom check methods. After any setup or</span>
<span class="udiff-line-modified-added">+  * argument checking, the method should call {@code checking(...)},</span>
<span class="udiff-line-modified-added">+  * and then eventually call either {@code passed(...)} or {@code failed(...)}</span>
<span class="udiff-line-modified-added">+  * to report whether the check succeeded or not.</span>
<span class="udiff-line-added">+  * Use {@code readFile} to get the contents of a file generated by javadoc.</span>
   *
   * &lt;p&gt;
   * You can have many separate test methods, each identified with a @Test
   * annotation. However, you should &lt;b&gt;not&lt;/b&gt; assume they will be called
   * in the order declared in your source file.  If the order of a series
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -571,11 +572,12 @@</span>
      /**
       * Shows the heading structure for each of the specified files.
       * The structure is is printed in plain text to the main output stream.
       * No errors are reported (unless there is a problem reading a file)
       * but missing headings are noted within the output.
<span class="udiff-line-modified-removed">-      * @params the files</span>
<span class="udiff-line-modified-added">+      *</span>
<span class="udiff-line-added">+      * @param paths the files</span>
       */
      public void showHeadings(String... paths) {
          ShowHeadings s = new ShowHeadings(out, this::readFile);
          for (String p : paths) {
              try {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -811,30 +813,68 @@</span>
          } catch (IOException e) {
              throw new Error(&quot;Error reading file: &quot; + fileName + &quot;: &quot; + e);
          }
      }
  
<span class="udiff-line-added">+     /**</span>
<span class="udiff-line-added">+      * Starts a check.</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * &lt;p&gt;This method should be called before subsequently calling {@code pass(...)}</span>
<span class="udiff-line-added">+      * or {@code fail(...)}.</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * @param message a short description of the check</span>
<span class="udiff-line-added">+      */</span>
      protected void checking(String message) {
          numTestsRun++;
          javadocTestNum++;
          print(&quot;Starting subtest &quot; + javadocRunNum + &quot;.&quot; + javadocTestNum, message);
      }
  
<span class="udiff-line-added">+     /**</span>
<span class="udiff-line-added">+      * Concludes a check for a file, reporting that the check succeeded.</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * &lt;p&gt;This method should be called after previously calling {@code checking(...)}.</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * @param file the file that was the focus of the check</span>
<span class="udiff-line-added">+      * @param message a short description of the outcome</span>
<span class="udiff-line-added">+      */</span>
      protected void passed(File file, String message) {
          passed(file + &quot;: &quot; + message);
      }
  
<span class="udiff-line-added">+     /**</span>
<span class="udiff-line-added">+      * Concludes a check, reporting that the check succeeded.</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * &lt;p&gt;This method should be called after previously calling {@code checking(...)}.</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * @param message a short description of the outcome</span>
<span class="udiff-line-added">+      */</span>
      protected void passed(String message) {
          numTestsPassed++;
          print(&quot;Passed&quot;, message);
          out.println();
      }
  
<span class="udiff-line-added">+     /**</span>
<span class="udiff-line-added">+      * Concludes a check for a file, reporting that the check failed.</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * &lt;p&gt;This method should be called after previously calling {@code checking(...)}.</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * @param file the file that was the focus of the check</span>
<span class="udiff-line-added">+      * @param message a short description of the outcome</span>
<span class="udiff-line-added">+      */</span>
      protected void failed(File file, String message) {
          failed(file + &quot;: &quot; + message);
      }
  
<span class="udiff-line-added">+     /**</span>
<span class="udiff-line-added">+      * Concludes a check for a file, reporting that the check failed.</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * &lt;p&gt;This method should be called after previously calling {@code checking(...)}.</span>
<span class="udiff-line-added">+      *</span>
<span class="udiff-line-added">+      * @param message a short description of the outcome</span>
<span class="udiff-line-added">+      */</span>
      protected void failed(String message) {
          print(&quot;FAILED&quot;, message);
          StackWalker.getInstance().walk(s -&gt; {
              s.dropWhile(f -&gt; f.getMethodName().equals(&quot;failed&quot;))
                      .takeWhile(f -&gt; !f.getMethodName().equals(&quot;runTests&quot;))
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -899,12 +939,10 @@</span>
       * Compares the two given files.
       *
       * @param baseDir1 the directory in which to locate the first file
       * @param baseDir2 the directory in which to locate the second file
       * @param file the file to compare in the two base directories
<span class="udiff-line-removed">-      * an error if the files do not match.</span>
<span class="udiff-line-removed">-      * @return true if the files are the same and false otherwise.</span>
       */
      private void diff(File baseDir1, File baseDir2, String file) {
          String file1Contents = readFile(baseDir1, file);
          String file2Contents = readFile(baseDir2, file);
          checking(&quot;diff &quot; + new File(baseDir1, file) + &quot;, &quot; + new File(baseDir2, file));
</pre>
<center><a href="../../../doclet/testTypeAnnotations/TestTypeAnnotations.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../tool/doclint/DocLintTest.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>