<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New test/hotspot/jtreg/compiler/stringopts/TestLongStringConcat.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
  <body>
    <pre>
 1 /*
 2  * Copyright (c) 2020, Oracle and/or its affiliates. All rights reserved.
 3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 4  *
 5  * This code is free software; you can redistribute it and/or modify it
 6  * under the terms of the GNU General Public License version 2 only, as
 7  * published by the Free Software Foundation.
 8  *
 9  * This code is distributed in the hope that it will be useful, but WITHOUT
10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
12  * version 2 for more details (a copy is included in the LICENSE file that
13  * accompanied this code).
14  *
15  * You should have received a copy of the GNU General Public License version
16  * 2 along with this work; if not, write to the Free Software Foundation,
17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
18  *
19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
20  * or visit www.oracle.com if you need additional information or have any
21  * questions.
22  */
23 
24 /*
25  * @test
26  * @bug 8237950
27  * @summary Test very long chain of StringBuilder append calls.
28  * @run main/othervm -Xbatch compiler.stringopts.TestLongStringConcat
29  */
30 
31 package compiler.stringopts;
32 
33 public class TestLongStringConcat {
34 
35     public static String test() {
36         return (new StringBuilder(&quot;&quot;)).append(&quot;1&quot;).append(&quot;2&quot;).append(&quot;3&quot;).append(&quot;4&quot;).
37             append(&quot;5&quot;).append(&quot;6&quot;).append(&quot;7&quot;).append(&quot;8&quot;).append(&quot;9&quot;).append(&quot;10&quot;).
38             append(&quot;11&quot;).append(&quot;12&quot;).append(&quot;13&quot;).append(&quot;14&quot;).append(&quot;15&quot;).append(&quot;16&quot;).
39             append(&quot;17&quot;).append(&quot;18&quot;).append(&quot;19&quot;).append(&quot;20&quot;).append(&quot;21&quot;).append(&quot;22&quot;).
40             append(&quot;23&quot;).append(&quot;24&quot;).append(&quot;25&quot;).append(&quot;26&quot;).append(&quot;27&quot;).append(&quot;28&quot;).
41             append(&quot;29&quot;).append(&quot;30&quot;).append(&quot;31&quot;).append(&quot;32&quot;).append(&quot;33&quot;).append(&quot;34&quot;).
42             append(&quot;35&quot;).append(&quot;36&quot;).append(&quot;37&quot;).append(&quot;38&quot;).append(&quot;39&quot;).append(&quot;40&quot;).
43             append(&quot;41&quot;).append(&quot;42&quot;).append(&quot;43&quot;).append(&quot;44&quot;).append(&quot;45&quot;).append(&quot;46&quot;).
44             append(&quot;47&quot;).append(&quot;48&quot;).append(&quot;49&quot;).append(&quot;50&quot;).append(&quot;51&quot;).append(&quot;52&quot;).
45             append(&quot;53&quot;).append(&quot;54&quot;).append(&quot;55&quot;).append(&quot;56&quot;).append(&quot;57&quot;).append(&quot;58&quot;).
46             append(&quot;59&quot;).append(&quot;60&quot;).append(&quot;61&quot;).append(&quot;62&quot;).append(&quot;63&quot;).append(&quot;64&quot;).
47             append(&quot;65&quot;).append(&quot;66&quot;).append(&quot;67&quot;).append(&quot;68&quot;).append(&quot;69&quot;).append(&quot;70&quot;).
48             append(&quot;71&quot;).append(&quot;72&quot;).append(&quot;73&quot;).append(&quot;74&quot;).append(&quot;75&quot;).append(&quot;76&quot;).
49             append(&quot;77&quot;).append(&quot;78&quot;).append(&quot;79&quot;).append(&quot;80&quot;).append(&quot;81&quot;).append(&quot;82&quot;).
50             append(&quot;83&quot;).append(&quot;84&quot;).append(&quot;85&quot;).append(&quot;86&quot;).append(&quot;87&quot;).append(&quot;88&quot;).
51             append(&quot;89&quot;).append(&quot;90&quot;).append(&quot;91&quot;).append(&quot;92&quot;).append(&quot;93&quot;).append(&quot;94&quot;).
52             append(&quot;95&quot;).append(&quot;96&quot;).append(&quot;97&quot;).append(&quot;98&quot;).append(&quot;99&quot;).append(&quot;100&quot;).
53             append(&quot;101&quot;).append(&quot;102&quot;).append(&quot;103&quot;).append(&quot;104&quot;).append(&quot;105&quot;).
54             append(&quot;106&quot;).append(&quot;107&quot;).append(&quot;108&quot;).append(&quot;109&quot;).append(&quot;110&quot;).
55             append(&quot;111&quot;).append(&quot;112&quot;).append(&quot;113&quot;).append(&quot;114&quot;).append(&quot;115&quot;).
56             append(&quot;116&quot;).append(&quot;117&quot;).append(&quot;118&quot;).append(&quot;119&quot;).append(&quot;120&quot;).
57             append(&quot;121&quot;).append(&quot;122&quot;).append(&quot;123&quot;).append(&quot;124&quot;).append(&quot;125&quot;).
58             append(&quot;126&quot;).append(&quot;127&quot;).append(&quot;128&quot;).append(&quot;129&quot;).append(&quot;130&quot;).
59             append(&quot;131&quot;).append(&quot;132&quot;).append(&quot;133&quot;).append(&quot;134&quot;).append(&quot;135&quot;).
60             append(&quot;136&quot;).append(&quot;137&quot;).append(&quot;138&quot;).append(&quot;139&quot;).append(&quot;140&quot;).
61             append(&quot;141&quot;).append(&quot;142&quot;).append(&quot;143&quot;).append(&quot;144&quot;).append(&quot;145&quot;).
62             append(&quot;146&quot;).append(&quot;147&quot;).append(&quot;148&quot;).append(&quot;149&quot;).append(&quot;150&quot;).
63             append(&quot;151&quot;).append(&quot;152&quot;).append(&quot;153&quot;).append(&quot;154&quot;).append(&quot;155&quot;).
64             append(&quot;156&quot;).append(&quot;157&quot;).append(&quot;158&quot;).append(&quot;159&quot;).append(&quot;160&quot;).
65             append(&quot;161&quot;).append(&quot;162&quot;).append(&quot;163&quot;).append(&quot;164&quot;).append(&quot;165&quot;).
66             append(&quot;166&quot;).append(&quot;167&quot;).append(&quot;168&quot;).append(&quot;169&quot;).append(&quot;170&quot;).
67             append(&quot;171&quot;).append(&quot;172&quot;).append(&quot;173&quot;).append(&quot;174&quot;).append(&quot;175&quot;).
68             append(&quot;176&quot;).append(&quot;177&quot;).append(&quot;178&quot;).append(&quot;179&quot;).append(&quot;180&quot;).
69             append(&quot;181&quot;).append(&quot;182&quot;).append(&quot;183&quot;).append(&quot;184&quot;).append(&quot;185&quot;).
70             append(&quot;186&quot;).append(&quot;187&quot;).append(&quot;188&quot;).append(&quot;189&quot;).append(&quot;190&quot;).
71             append(&quot;191&quot;).append(&quot;192&quot;).append(&quot;193&quot;).append(&quot;194&quot;).append(&quot;195&quot;).
72             append(&quot;196&quot;).append(&quot;197&quot;).append(&quot;198&quot;).append(&quot;199&quot;).append(&quot;200&quot;).
73             toString();
74     }
75 
76     public static void main(String[] args) {
77         for (int i = 0; i &lt; 100_000; ++i) {
78             test();
79         }
80     }
81 }
    </pre>
  </body>
</html>