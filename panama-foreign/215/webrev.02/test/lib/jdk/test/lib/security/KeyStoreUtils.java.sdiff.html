<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/lib/jdk/test/lib/security/KeyStoreUtils.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../langtools/tools/javac/sealed/SealedCompilationTests.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../../../sun/hotspot/WhiteBox.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/lib/jdk/test/lib/security/KeyStoreUtils.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 package jdk.test.lib.security;
 25 

 26 import java.io.ByteArrayInputStream;
 27 import java.io.FileInputStream;
 28 import java.io.InputStream;
 29 import java.security.KeyStore;
 30 import java.security.PrivateKey;
 31 import java.security.cert.Certificate;


 32 import java.util.ArrayList;
 33 import java.util.Base64;
 34 import java.util.List;
 35 
 36 /*
 37  * Utilities for creating key store.
 38  */
 39 public class KeyStoreUtils {
 40 
 41     private static final String DEFAULT_TYPE = KeyStore.getDefaultType();
 42 
 43     /**
 44      * Create key store with a given input stream.
 45      *
 46      * @param type the key store type
 47      * @param input the input stream containing a key store
 48      * @param password the password used to check the integrity of the key store
 49      * @return the key store
 50      * @throws Exception on errors
 51      */
</pre>
<hr />
<pre>
272                 new String[] { CertUtils.RSA_CERT, CertUtils.ECDSA_CERT,
273                         CertUtils.RSASSAPSS_CERT, CertUtils.DSA_CERT });
274     }
275 
276     /**
277      * The default key store that contains RSA, ECDSA, RSASSA-PSS and DSA
278      * certificates.
279      */
280     public static KeyStore defaultKeyStore() throws Exception {
281         List&lt;KeyEntry&gt; entries = new ArrayList&lt;&gt;();
282         entries.add(new KeyEntry(&quot;RSA&quot;, CertUtils.RSA_KEY,
283                 new String[] { CertUtils.RSA_CERT }));
284         entries.add(new KeyEntry(&quot;EC&quot;, CertUtils.ECDSA_KEY,
285                 new String[] { CertUtils.ECDSA_CERT }));
286         entries.add(new KeyEntry(&quot;RSASSA-PSS&quot;, CertUtils.RSASSAPSS_KEY,
287                 new String[] { CertUtils.RSASSAPSS_CERT }));
288         entries.add(new KeyEntry(&quot;DSA&quot;, CertUtils.DSA_KEY,
289                 new String[] { CertUtils.DSA_CERT }));
290         return createKeyStore(entries.toArray(new KeyEntry[entries.size()]));
291     }





















292 }
</pre>
</td>
<td>
<hr />
<pre>
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 package jdk.test.lib.security;
 25 
<span class="line-added"> 26 import java.io.*;</span>
 27 import java.io.ByteArrayInputStream;
 28 import java.io.FileInputStream;
 29 import java.io.InputStream;
 30 import java.security.KeyStore;
 31 import java.security.PrivateKey;
 32 import java.security.cert.Certificate;
<span class="line-added"> 33 import java.security.cert.CertificateFactory;</span>
<span class="line-added"> 34 import java.security.KeyStore;</span>
 35 import java.util.ArrayList;
 36 import java.util.Base64;
 37 import java.util.List;
 38 
 39 /*
 40  * Utilities for creating key store.
 41  */
 42 public class KeyStoreUtils {
 43 
 44     private static final String DEFAULT_TYPE = KeyStore.getDefaultType();
 45 
 46     /**
 47      * Create key store with a given input stream.
 48      *
 49      * @param type the key store type
 50      * @param input the input stream containing a key store
 51      * @param password the password used to check the integrity of the key store
 52      * @return the key store
 53      * @throws Exception on errors
 54      */
</pre>
<hr />
<pre>
275                 new String[] { CertUtils.RSA_CERT, CertUtils.ECDSA_CERT,
276                         CertUtils.RSASSAPSS_CERT, CertUtils.DSA_CERT });
277     }
278 
279     /**
280      * The default key store that contains RSA, ECDSA, RSASSA-PSS and DSA
281      * certificates.
282      */
283     public static KeyStore defaultKeyStore() throws Exception {
284         List&lt;KeyEntry&gt; entries = new ArrayList&lt;&gt;();
285         entries.add(new KeyEntry(&quot;RSA&quot;, CertUtils.RSA_KEY,
286                 new String[] { CertUtils.RSA_CERT }));
287         entries.add(new KeyEntry(&quot;EC&quot;, CertUtils.ECDSA_KEY,
288                 new String[] { CertUtils.ECDSA_CERT }));
289         entries.add(new KeyEntry(&quot;RSASSA-PSS&quot;, CertUtils.RSASSAPSS_KEY,
290                 new String[] { CertUtils.RSASSAPSS_CERT }));
291         entries.add(new KeyEntry(&quot;DSA&quot;, CertUtils.DSA_KEY,
292                 new String[] { CertUtils.DSA_CERT }));
293         return createKeyStore(entries.toArray(new KeyEntry[entries.size()]));
294     }
<span class="line-added">295 </span>
<span class="line-added">296     /**</span>
<span class="line-added">297      * Creates cacerts keystore with the trusted certificate(s)</span>
<span class="line-added">298      * @param args arguments to cacerts keystore name and trusted certificates</span>
<span class="line-added">299      * @throws Exception if there is an error</span>
<span class="line-added">300      *</span>
<span class="line-added">301      */</span>
<span class="line-added">302     public static void createCacerts(String ks, String... crts) throws Exception {</span>
<span class="line-added">303         try (OutputStream os = new FileOutputStream(ks)) {</span>
<span class="line-added">304             KeyStore k = KeyStore.getInstance(&quot;JKS&quot;);</span>
<span class="line-added">305             k.load(null, null);</span>
<span class="line-added">306             CertificateFactory cf = CertificateFactory.getInstance(&quot;X.509&quot;);</span>
<span class="line-added">307             for (int pos = 0; pos &lt; crts.length; pos++) {</span>
<span class="line-added">308                 try (InputStream is = new FileInputStream(crts[pos])) {</span>
<span class="line-added">309                     k.setCertificateEntry(&quot;root&quot; + pos,</span>
<span class="line-added">310                             cf.generateCertificate(is));</span>
<span class="line-added">311                 }</span>
<span class="line-added">312             }</span>
<span class="line-added">313             k.store(os, &quot;changeit&quot;.toCharArray());</span>
<span class="line-added">314         }</span>
<span class="line-added">315     }</span>
316 }
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../langtools/tools/javac/sealed/SealedCompilationTests.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../../../sun/hotspot/WhiteBox.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>