<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.incubator.foreign/share/classes/jdk/incubator/foreign/MemoryLayout.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../jdk.hotspot.agent/share/classes/sun/jvm/hotspot/utilities/GenericGrowableArray.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="MemorySegment.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.incubator.foreign/share/classes/jdk/incubator/foreign/MemoryLayout.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
130 long valueOffset = taggedValues.bitOffset(PathElement.sequenceElement(0),
131                                           PathElement.groupElement(&quot;value&quot;)); // yields 32
132  * }&lt;/pre&gt;&lt;/blockquote&gt;
133  *
134  * Similarly, we can select the member layout named {@code value}, as follows:
135  * &lt;blockquote&gt;&lt;pre&gt;{@code
136 MemoryLayout value = taggedValues.select(PathElement.sequenceElement(),
137                                          PathElement.groupElement(&quot;value&quot;));
138  * }&lt;/pre&gt;&lt;/blockquote&gt;
139  *
140  * And, we can also replace the layout named {@code value} with another layout, as follows:
141  * &lt;blockquote&gt;&lt;pre&gt;{@code
142 MemoryLayout taggedValuesWithHole = taggedValues.map(l -&gt; MemoryLayout.ofPadding(32),
143                                             PathElement.sequenceElement(), PathElement.groupElement(&quot;value&quot;));
144  * }&lt;/pre&gt;&lt;/blockquote&gt;
145  *
146  * That is, the above declaration is identical to the following, more verbose one:
147  * &lt;blockquote&gt;&lt;pre&gt;{@code
148 MemoryLayout taggedValuesWithHole = MemoryLayout.ofSequence(5,
149     MemoryLayout.ofStruct(
<span class="line-modified">150         MemoryLayout.ofPaddingBits(8, ByteOrder.nativeOrder()).withName(&quot;kind&quot;).</span>
151         MemoryLayout.ofPaddingBits(32),
152         MemoryLayout.ofPaddingBits(32)
153 ));
154  * }&lt;/pre&gt;&lt;/blockquote&gt;
155  *
156  * Layout paths can feature one or more &lt;em&gt;free dimensions&lt;/em&gt;. For instance, a layout path traversing
157  * an unspecified sequence element (that is, where one of the path component was obtained with the
158  * {@link PathElement#sequenceElement()} method) features an additional free dimension, which will have to be bound at runtime.
159  * This is important when obtaining memory access var handle from layouts, as in the following code:
160  *
161  * &lt;blockquote&gt;&lt;pre&gt;{@code
162 VarHandle valueHandle = taggedValues.varHandle(int.class,
163                                                PathElement.sequenceElement(),
164                                                PathElement.groupElement(&quot;value&quot;));
165  * }&lt;/pre&gt;&lt;/blockquote&gt;
166  *
167  * Since the layout path constructed in the above example features exactly one free dimension (as it doesn&#39;t specify
168  * &lt;em&gt;which&lt;/em&gt; member layout named {@code value} should be selected from the enclosing sequence layout),
169  * it follows that the memory access var handle {@code valueHandle} will feature an &lt;em&gt;additional&lt;/em&gt; {@code long}
170  * access coordinate.
</pre>
</td>
<td>
<hr />
<pre>
130 long valueOffset = taggedValues.bitOffset(PathElement.sequenceElement(0),
131                                           PathElement.groupElement(&quot;value&quot;)); // yields 32
132  * }&lt;/pre&gt;&lt;/blockquote&gt;
133  *
134  * Similarly, we can select the member layout named {@code value}, as follows:
135  * &lt;blockquote&gt;&lt;pre&gt;{@code
136 MemoryLayout value = taggedValues.select(PathElement.sequenceElement(),
137                                          PathElement.groupElement(&quot;value&quot;));
138  * }&lt;/pre&gt;&lt;/blockquote&gt;
139  *
140  * And, we can also replace the layout named {@code value} with another layout, as follows:
141  * &lt;blockquote&gt;&lt;pre&gt;{@code
142 MemoryLayout taggedValuesWithHole = taggedValues.map(l -&gt; MemoryLayout.ofPadding(32),
143                                             PathElement.sequenceElement(), PathElement.groupElement(&quot;value&quot;));
144  * }&lt;/pre&gt;&lt;/blockquote&gt;
145  *
146  * That is, the above declaration is identical to the following, more verbose one:
147  * &lt;blockquote&gt;&lt;pre&gt;{@code
148 MemoryLayout taggedValuesWithHole = MemoryLayout.ofSequence(5,
149     MemoryLayout.ofStruct(
<span class="line-modified">150         MemoryLayout.ofValueBits(8, ByteOrder.nativeOrder()).withName(&quot;kind&quot;).</span>
151         MemoryLayout.ofPaddingBits(32),
152         MemoryLayout.ofPaddingBits(32)
153 ));
154  * }&lt;/pre&gt;&lt;/blockquote&gt;
155  *
156  * Layout paths can feature one or more &lt;em&gt;free dimensions&lt;/em&gt;. For instance, a layout path traversing
157  * an unspecified sequence element (that is, where one of the path component was obtained with the
158  * {@link PathElement#sequenceElement()} method) features an additional free dimension, which will have to be bound at runtime.
159  * This is important when obtaining memory access var handle from layouts, as in the following code:
160  *
161  * &lt;blockquote&gt;&lt;pre&gt;{@code
162 VarHandle valueHandle = taggedValues.varHandle(int.class,
163                                                PathElement.sequenceElement(),
164                                                PathElement.groupElement(&quot;value&quot;));
165  * }&lt;/pre&gt;&lt;/blockquote&gt;
166  *
167  * Since the layout path constructed in the above example features exactly one free dimension (as it doesn&#39;t specify
168  * &lt;em&gt;which&lt;/em&gt; member layout named {@code value} should be selected from the enclosing sequence layout),
169  * it follows that the memory access var handle {@code valueHandle} will feature an &lt;em&gt;additional&lt;/em&gt; {@code long}
170  * access coordinate.
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../jdk.hotspot.agent/share/classes/sun/jvm/hotspot/utilities/GenericGrowableArray.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="MemorySegment.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>