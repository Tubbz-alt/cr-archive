<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old doc/panama_jextract.html</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
  <body>
    <pre>
  1 &lt;!DOCTYPE html&gt;
  2 &lt;html&gt;
  3 &lt;head&gt;
  4   &lt;meta charset=&quot;utf-8&quot;&gt;
  5   &lt;meta name=&quot;generator&quot; content=&quot;pandoc&quot;&gt;
  6   &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, user-scalable=yes&quot;&gt;
  7   &lt;title&gt;Using Panama &amp;quot;foreign&amp;quot; JDK&lt;/title&gt;
  8   &lt;style type=&quot;text/css&quot;&gt;code{white-space: pre;}&lt;/style&gt;
  9   &lt;style type=&quot;text/css&quot;&gt;
 10 div.sourceCode { overflow-x: auto; }
 11 table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
 12   margin: 0; padding: 0; vertical-align: baseline; border: none; }
 13 table.sourceCode { width: 100%; line-height: 100%; }
 14 td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
 15 td.sourceCode { padding-left: 5px; }
 16 code &gt; span.kw { color: #007020; font-weight: bold; } /* Keyword */
 17 code &gt; span.dt { color: #902000; } /* DataType */
 18 code &gt; span.dv { color: #40a070; } /* DecVal */
 19 code &gt; span.bn { color: #40a070; } /* BaseN */
 20 code &gt; span.fl { color: #40a070; } /* Float */
 21 code &gt; span.ch { color: #4070a0; } /* Char */
 22 code &gt; span.st { color: #4070a0; } /* String */
 23 code &gt; span.co { color: #60a0b0; font-style: italic; } /* Comment */
 24 code &gt; span.ot { color: #007020; } /* Other */
 25 code &gt; span.al { color: #ff0000; font-weight: bold; } /* Alert */
 26 code &gt; span.fu { color: #06287e; } /* Function */
 27 code &gt; span.er { color: #ff0000; font-weight: bold; } /* Error */
 28 code &gt; span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
 29 code &gt; span.cn { color: #880000; } /* Constant */
 30 code &gt; span.sc { color: #4070a0; } /* SpecialChar */
 31 code &gt; span.vs { color: #4070a0; } /* VerbatimString */
 32 code &gt; span.ss { color: #bb6688; } /* SpecialString */
 33 code &gt; span.im { } /* Import */
 34 code &gt; span.va { color: #19177c; } /* Variable */
 35 code &gt; span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
 36 code &gt; span.op { color: #666666; } /* Operator */
 37 code &gt; span.bu { } /* BuiltIn */
 38 code &gt; span.ex { } /* Extension */
 39 code &gt; span.pp { color: #bc7a00; } /* Preprocessor */
 40 code &gt; span.at { color: #7d9029; } /* Attribute */
 41 code &gt; span.do { color: #ba2121; font-style: italic; } /* Documentation */
 42 code &gt; span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
 43 code &gt; span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
 44 code &gt; span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
 45   &lt;/style&gt;
 46   &lt;link rel=&quot;stylesheet&quot; href=&quot;../make/data/docs-resources/resources/jdk-default.css&quot;&gt;
 47   &lt;!--[if lt IE 9]&gt;
 48     &lt;script src=&quot;//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js&quot;&gt;&lt;/script&gt;
 49   &lt;![endif]--&gt;
 50 &lt;/head&gt;
 51 &lt;body&gt;
 52 &lt;header&gt;
 53 &lt;h1 class=&quot;title&quot;&gt;Using Panama &amp;quot;foreign&amp;quot; JDK&lt;/h1&gt;
 54 &lt;/header&gt;
 55 &lt;nav id=&quot;TOC&quot;&gt;
 56 &lt;ul&gt;
 57 &lt;li&gt;&lt;a href=&quot;#using-panama-foreign-jextract-jdk&quot;&gt;Using Panama &amp;quot;foreign-jextract&amp;quot; JDK&lt;/a&gt;&lt;ul&gt;
 58 &lt;li&gt;&lt;a href=&quot;#hello-world&quot;&gt;Hello World&lt;/a&gt;&lt;ul&gt;
 59 &lt;li&gt;&lt;a href=&quot;#hello-world-c-header-helloworld.h&quot;&gt;Hello World C Header (helloworld.h)&lt;/a&gt;&lt;/li&gt;
 60 &lt;li&gt;&lt;a href=&quot;#hello-world-c-source-helloworld.c&quot;&gt;Hello World C Source (helloworld.c)&lt;/a&gt;&lt;/li&gt;
 61 &lt;li&gt;&lt;a href=&quot;#building-hello-world&quot;&gt;Building Hello World&lt;/a&gt;&lt;/li&gt;
 62 &lt;li&gt;&lt;a href=&quot;#jextract-a-jar-file-for-helloworld.h&quot;&gt;jextract a Jar file for helloworld.h&lt;/a&gt;&lt;/li&gt;
 63 &lt;li&gt;&lt;a href=&quot;#java-program-that-uses-extracted-helloworld-interface&quot;&gt;Java program that uses extracted helloworld interface&lt;/a&gt;&lt;/li&gt;
 64 &lt;li&gt;&lt;a href=&quot;#running-the-java-code-that-invokes-helloworld&quot;&gt;Running the Java code that invokes helloworld&lt;/a&gt;&lt;/li&gt;
 65 &lt;/ul&gt;&lt;/li&gt;
 66 &lt;li&gt;&lt;a href=&quot;#embedding-python-interpreter-in-your-java-program-mac-os&quot;&gt;Embedding Python interpreter in your Java program (Mac OS)&lt;/a&gt;&lt;ul&gt;
 67 &lt;li&gt;&lt;a href=&quot;#jextract-a-jar-file-for-python.h&quot;&gt;jextract a Jar file for Python.h&lt;/a&gt;&lt;/li&gt;
 68 &lt;li&gt;&lt;a href=&quot;#java-program-that-uses-extracted-python-interface&quot;&gt;Java program that uses extracted Python interface&lt;/a&gt;&lt;/li&gt;
 69 &lt;li&gt;&lt;a href=&quot;#running-the-java-code-that-calls-python-interpreter&quot;&gt;Running the Java code that calls Python interpreter&lt;/a&gt;&lt;/li&gt;
 70 &lt;/ul&gt;&lt;/li&gt;
 71 &lt;li&gt;&lt;a href=&quot;#using-readline-library-from-java-code-mac-os&quot;&gt;Using readline library from Java code (Mac OS)&lt;/a&gt;&lt;ul&gt;
 72 &lt;li&gt;&lt;a href=&quot;#jextract-a-jar-file-for-readline.h&quot;&gt;jextract a jar file for readline.h&lt;/a&gt;&lt;/li&gt;
 73 &lt;li&gt;&lt;a href=&quot;#java-code-that-uses-readline&quot;&gt;Java code that uses readline&lt;/a&gt;&lt;/li&gt;
 74 &lt;li&gt;&lt;a href=&quot;#running-the-java-code-that-uses-readline&quot;&gt;Running the java code that uses readline&lt;/a&gt;&lt;/li&gt;
 75 &lt;/ul&gt;&lt;/li&gt;
 76 &lt;li&gt;&lt;a href=&quot;#using-libcurl-from-java-mac-os&quot;&gt;Using libcurl from Java (Mac OS)&lt;/a&gt;&lt;ul&gt;
 77 &lt;li&gt;&lt;a href=&quot;#jextract-a-jar-for-curl.h&quot;&gt;jextract a jar for curl.h&lt;/a&gt;&lt;/li&gt;
 78 &lt;li&gt;&lt;a href=&quot;#java-code-that-uses-libcurl&quot;&gt;Java code that uses libcurl&lt;/a&gt;&lt;/li&gt;
 79 &lt;li&gt;&lt;a href=&quot;#running-the-java-code-that-uses-libcurl&quot;&gt;Running the java code that uses libcurl&lt;/a&gt;&lt;/li&gt;
 80 &lt;/ul&gt;&lt;/li&gt;
 81 &lt;li&gt;&lt;a href=&quot;#using-blas-library&quot;&gt;Using BLAS library&lt;/a&gt;&lt;ul&gt;
 82 &lt;li&gt;&lt;a href=&quot;#installing-openblas-mac-os&quot;&gt;Installing OpenBLAS (Mac OS)&lt;/a&gt;&lt;/li&gt;
 83 &lt;li&gt;&lt;a href=&quot;#jextracting-cblas.h-macos&quot;&gt;jextracting cblas.h (MacOS)&lt;/a&gt;&lt;/li&gt;
 84 &lt;li&gt;&lt;a href=&quot;#java-sample-code-that-uses-cblas-library&quot;&gt;Java sample code that uses cblas library&lt;/a&gt;&lt;/li&gt;
 85 &lt;li&gt;&lt;a href=&quot;#compiling-and-running-the-above-lapack-sample&quot;&gt;Compiling and running the above LAPACK sample&lt;/a&gt;&lt;/li&gt;
 86 &lt;/ul&gt;&lt;/li&gt;
 87 &lt;/ul&gt;&lt;/li&gt;
 88 &lt;/ul&gt;
 89 &lt;/nav&gt;
 90 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 91 &lt;h1 id=&quot;using-panama-foreign-jextract-jdk&quot;&gt;Using Panama &amp;quot;foreign-jextract&amp;quot; JDK&lt;/h1&gt;
 92 &lt;p&gt;You can build &amp;quot;foreign-jextract&amp;quot; branch of panama repo &lt;a href=&quot;https://github.com/openjdk/panama-foreign&quot; class=&quot;uri&quot;&gt;https://github.com/openjdk/panama-foreign&lt;/a&gt;&lt;/p&gt;
 93 &lt;p&gt;Using foreign function call in Java involves the following two steps:&lt;/p&gt;
 94 &lt;ol type=&quot;1&quot;&gt;
 95 &lt;li&gt;Use &lt;strong&gt;jextract&lt;/strong&gt; tool to generate java interface for your C header file(s)&lt;/li&gt;
 96 &lt;li&gt;Invoke C functions via the jextracted Java interface&lt;/li&gt;
 97 &lt;/ol&gt;
 98 &lt;h2 id=&quot;hello-world&quot;&gt;Hello World&lt;/h2&gt;
 99 &lt;h3 id=&quot;hello-world-c-header-helloworld.h&quot;&gt;Hello World C Header (helloworld.h)&lt;/h3&gt;
100 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode c&quot;&gt;&lt;code class=&quot;sourceCode c&quot;&gt;
101 &lt;span class=&quot;pp&quot;&gt;#ifndef helloworld_h&lt;/span&gt;
102 &lt;span class=&quot;pp&quot;&gt;#define helloworld_h&lt;/span&gt;
103 
104 &lt;span class=&quot;kw&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;void&lt;/span&gt; helloworld(&lt;span class=&quot;dt&quot;&gt;void&lt;/span&gt;);
105 
106 &lt;span class=&quot;pp&quot;&gt;#endif &lt;/span&gt;&lt;span class=&quot;co&quot;&gt;/* helloworld_h */&lt;/span&gt;
107 &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
108 &lt;h3 id=&quot;hello-world-c-source-helloworld.c&quot;&gt;Hello World C Source (helloworld.c)&lt;/h3&gt;
109 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode c&quot;&gt;&lt;code class=&quot;sourceCode c&quot;&gt;
110 &lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;
111 
112 &lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;quot;helloworld.h&amp;quot;&lt;/span&gt;
113 
114 &lt;span class=&quot;dt&quot;&gt;void&lt;/span&gt; helloworld(&lt;span class=&quot;dt&quot;&gt;void&lt;/span&gt;) {
115     printf(&lt;span class=&quot;st&quot;&gt;&amp;quot;Hello World!&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;);
116 }&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
117 &lt;h3 id=&quot;building-hello-world&quot;&gt;Building Hello World&lt;/h3&gt;
118 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode sh&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;
119 &lt;span class=&quot;fu&quot;&gt;cc&lt;/span&gt; -shared -o libhelloworld.dylib helloworld.c&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
120 &lt;h3 id=&quot;jextract-a-jar-file-for-helloworld.h&quot;&gt;jextract a Jar file for helloworld.h&lt;/h3&gt;
121 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode sh&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;
122 &lt;span class=&quot;ex&quot;&gt;jextract&lt;/span&gt; -t org.hello -lhelloworld helloworld.h&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
123 &lt;h3 id=&quot;java-program-that-uses-extracted-helloworld-interface&quot;&gt;Java program that uses extracted helloworld interface&lt;/h3&gt;
124 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode java&quot;&gt;&lt;code class=&quot;sourceCode java&quot;&gt;
125 &lt;span class=&quot;kw&quot;&gt;import static&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; org.hello.helloworld_h.*;&lt;/span&gt;
126 
127 &lt;span class=&quot;kw&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;class&lt;/span&gt; HelloWorld {
128     &lt;span class=&quot;kw&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;main&lt;/span&gt;(&lt;span class=&quot;bu&quot;&gt;String&lt;/span&gt;[] args) {
129         &lt;span class=&quot;fu&quot;&gt;helloworld&lt;/span&gt;();
130     }
131 }&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
132 &lt;h3 id=&quot;running-the-java-code-that-invokes-helloworld&quot;&gt;Running the Java code that invokes helloworld&lt;/h3&gt;
133 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode sh&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;
134 &lt;span class=&quot;ex&quot;&gt;java&lt;/span&gt; -Djdk.incubator.foreign.Foreign=permit --add-modules jdk.incubator.foreign HelloWorld.java&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
135 &lt;h2 id=&quot;embedding-python-interpreter-in-your-java-program-mac-os&quot;&gt;Embedding Python interpreter in your Java program (Mac OS)&lt;/h2&gt;
136 &lt;h3 id=&quot;jextract-a-jar-file-for-python.h&quot;&gt;jextract a Jar file for Python.h&lt;/h3&gt;
137 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode sh&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;
138 &lt;span class=&quot;ex&quot;&gt;jextract&lt;/span&gt; -l python2.7 \
139   -I /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include \
140   -I /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/python2.7/ \
141   -t org.python \
142   --filter pythonrun.h \
143   --filter python.h \
144    /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/python2.7/Python.h&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
145 &lt;h3 id=&quot;java-program-that-uses-extracted-python-interface&quot;&gt;Java program that uses extracted Python interface&lt;/h3&gt;
146 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode java&quot;&gt;&lt;code class=&quot;sourceCode java&quot;&gt;
147 &lt;span class=&quot;kw&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; jdk.incubator.foreign.Foreign;&lt;/span&gt;
148 &lt;span class=&quot;kw&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; org.python.Cstring;&lt;/span&gt;
149 &lt;span class=&quot;kw&quot;&gt;import static&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; jdk.incubator.foreign.MemoryAddress.NULL;&lt;/span&gt;
150 &lt;span class=&quot;co&quot;&gt;// import jextracted python &amp;#39;header&amp;#39; class&lt;/span&gt;
151 &lt;span class=&quot;kw&quot;&gt;import static&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; org.python.RuntimeHelper.*;&lt;/span&gt;
152 &lt;span class=&quot;kw&quot;&gt;import static&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; org.python.Python_h.*;&lt;/span&gt;
153 
154 &lt;span class=&quot;kw&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;class&lt;/span&gt; PythonMain {
155     &lt;span class=&quot;kw&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;main&lt;/span&gt;(&lt;span class=&quot;bu&quot;&gt;String&lt;/span&gt;[] args) {
156         &lt;span class=&quot;bu&quot;&gt;String&lt;/span&gt; script = &lt;span class=&quot;st&quot;&gt;&amp;quot;print(sum([33, 55, 66])); print(&amp;#39;Hello from Python!&amp;#39;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;;
157 
158         &lt;span class=&quot;fu&quot;&gt;Py_Initialize&lt;/span&gt;();
159         &lt;span class=&quot;kw&quot;&gt;try&lt;/span&gt; (var s = Cstring.&lt;span class=&quot;fu&quot;&gt;toCString&lt;/span&gt;(script)) {
160             var str = s.&lt;span class=&quot;fu&quot;&gt;baseAddress&lt;/span&gt;();
161             &lt;span class=&quot;fu&quot;&gt;PyRun_SimpleStringFlags&lt;/span&gt;(str, NULL);
162             &lt;span class=&quot;fu&quot;&gt;Py_Finalize&lt;/span&gt;();
163         }
164     }
165 }&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
166 &lt;h3 id=&quot;running-the-java-code-that-calls-python-interpreter&quot;&gt;Running the Java code that calls Python interpreter&lt;/h3&gt;
167 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode sh&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;
168 &lt;span class=&quot;ex&quot;&gt;java&lt;/span&gt; -Djdk.incubator.foreign.Foreign=permit --add-modules jdk.incubator.foreign \
169     -Djava.library.path=/System/Library/Frameworks/Python.framework/Versions/2.7/lib PythonMain.java&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
170 &lt;h2 id=&quot;using-readline-library-from-java-code-mac-os&quot;&gt;Using readline library from Java code (Mac OS)&lt;/h2&gt;
171 &lt;h3 id=&quot;jextract-a-jar-file-for-readline.h&quot;&gt;jextract a jar file for readline.h&lt;/h3&gt;
172 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode sh&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;
173 &lt;span class=&quot;ex&quot;&gt;jextract&lt;/span&gt; -l readline -t org.unix \
174   -I /Library/Developer/CommandLineTools/SDKs/MacOSX10.14.sdk/usr/include \
175   --filter readline.h \
176    /Library/Developer/CommandLineTools/SDKs/MacOSX10.14.sdk/usr/include/readline/readline.h&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
177 &lt;h3 id=&quot;java-code-that-uses-readline&quot;&gt;Java code that uses readline&lt;/h3&gt;
178 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode java&quot;&gt;&lt;code class=&quot;sourceCode java&quot;&gt;
179 &lt;span class=&quot;kw&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; jdk.incubator.foreign.Foreign;&lt;/span&gt;
180 &lt;span class=&quot;kw&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; org.unix.Cstring;&lt;/span&gt;
181 &lt;span class=&quot;kw&quot;&gt;import static&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; org.unix.RuntimeHelper.*;&lt;/span&gt;
182 &lt;span class=&quot;kw&quot;&gt;import static&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; org.unix.readline_h.*;&lt;/span&gt;
183 
184 &lt;span class=&quot;kw&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;class&lt;/span&gt; Readline {
185     &lt;span class=&quot;kw&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;main&lt;/span&gt;(&lt;span class=&quot;bu&quot;&gt;String&lt;/span&gt;[] args) {
186         &lt;span class=&quot;kw&quot;&gt;try&lt;/span&gt; (var s = Cstring.&lt;span class=&quot;fu&quot;&gt;toCString&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;name? &amp;quot;&lt;/span&gt;)) {
187             var pstr = s.&lt;span class=&quot;fu&quot;&gt;baseAddress&lt;/span&gt;();
188             &lt;span class=&quot;co&quot;&gt;// call &amp;quot;readline&amp;quot; API&lt;/span&gt;
189             var p = &lt;span class=&quot;fu&quot;&gt;readline&lt;/span&gt;(pstr);
190 
191             &lt;span class=&quot;co&quot;&gt;// print char* as is&lt;/span&gt;
192             &lt;span class=&quot;bu&quot;&gt;System&lt;/span&gt;.&lt;span class=&quot;fu&quot;&gt;out&lt;/span&gt;.&lt;span class=&quot;fu&quot;&gt;println&lt;/span&gt;(p);
193             &lt;span class=&quot;co&quot;&gt;// convert char* ptr from readline as Java String &amp;amp; print it&lt;/span&gt;
194             &lt;span class=&quot;bu&quot;&gt;System&lt;/span&gt;.&lt;span class=&quot;fu&quot;&gt;out&lt;/span&gt;.&lt;span class=&quot;fu&quot;&gt;println&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Hello, &amp;quot;&lt;/span&gt; + Cstring.&lt;span class=&quot;fu&quot;&gt;toJavaString&lt;/span&gt;(p));
195         }
196     }
197 }&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
198 &lt;h3 id=&quot;running-the-java-code-that-uses-readline&quot;&gt;Running the java code that uses readline&lt;/h3&gt;
199 &lt;pre&gt;&lt;code&gt;java -Djdk.incubator.foreign.Foreign=permit --add-modules jdk.incubator.foreign \
200     -Djava.library.path=/usr/local/opt/readline/lib/ Readline.java
201 &lt;/code&gt;&lt;/pre&gt;
202 &lt;h2 id=&quot;using-libcurl-from-java-mac-os&quot;&gt;Using libcurl from Java (Mac OS)&lt;/h2&gt;
203 &lt;h3 id=&quot;jextract-a-jar-for-curl.h&quot;&gt;jextract a jar for curl.h&lt;/h3&gt;
204 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode sh&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;
205 &lt;span class=&quot;ex&quot;&gt;jextract&lt;/span&gt; -t org.unix -lcurl \
206   -I /Library/Developer/CommandLineTools/SDKs/MacOSX10.14.sdk/usr/include/ \
207   -I /Library/Developer/CommandLineTools/SDKs/MacOSX10.14.sdk/usr/include/curl/ \
208   --filter easy.h \
209   --filter curl.h \
210   /Library/Developer/CommandLineTools/SDKs/MacOSX10.14.sdk/usr/include/curl/curl.h&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
211 &lt;h3 id=&quot;java-code-that-uses-libcurl&quot;&gt;Java code that uses libcurl&lt;/h3&gt;
212 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode java&quot;&gt;&lt;code class=&quot;sourceCode java&quot;&gt;
213 &lt;span class=&quot;kw&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; jdk.incubator.foreign.Foreign;&lt;/span&gt;
214 &lt;span class=&quot;kw&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; org.unix.Cstring;&lt;/span&gt;
215 &lt;span class=&quot;kw&quot;&gt;import static&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; jdk.incubator.foreign.MemoryAddress.NULL;&lt;/span&gt;
216 &lt;span class=&quot;kw&quot;&gt;import static&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; org.unix.RuntimeHelper.*;&lt;/span&gt;
217 &lt;span class=&quot;kw&quot;&gt;import static&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; org.unix.curl_h.*;&lt;/span&gt;
218 
219 &lt;span class=&quot;kw&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;class&lt;/span&gt; CurlMain {
220    &lt;span class=&quot;kw&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;main&lt;/span&gt;(&lt;span class=&quot;bu&quot;&gt;String&lt;/span&gt;[] args) {
221        var urlStr = args[&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;];
222        &lt;span class=&quot;fu&quot;&gt;curl_global_init&lt;/span&gt;(CURL_GLOBAL_DEFAULT);
223        var curl = &lt;span class=&quot;fu&quot;&gt;curl_easy_init&lt;/span&gt;();
224        &lt;span class=&quot;kw&quot;&gt;if&lt;/span&gt;(!curl.&lt;span class=&quot;fu&quot;&gt;equals&lt;/span&gt;(NULL)) {
225            &lt;span class=&quot;kw&quot;&gt;try&lt;/span&gt; (var s = Cstring.&lt;span class=&quot;fu&quot;&gt;toCString&lt;/span&gt;(urlStr)) {
226                var url = s.&lt;span class=&quot;fu&quot;&gt;baseAddress&lt;/span&gt;();
227                &lt;span class=&quot;fu&quot;&gt;curl_easy_setopt&lt;/span&gt;(curl, CURLOPT_URL, url);
228                &lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; res = &lt;span class=&quot;fu&quot;&gt;curl_easy_perform&lt;/span&gt;(curl);
229                &lt;span class=&quot;kw&quot;&gt;if&lt;/span&gt; (res != CURLE_OK) {
230                    &lt;span class=&quot;fu&quot;&gt;curl_easy_cleanup&lt;/span&gt;(curl);
231                }
232            }
233        }
234        &lt;span class=&quot;fu&quot;&gt;curl_global_cleanup&lt;/span&gt;();
235    }
236 }&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
237 &lt;h3 id=&quot;running-the-java-code-that-uses-libcurl&quot;&gt;Running the java code that uses libcurl&lt;/h3&gt;
238 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode sh&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;
239 &lt;span class=&quot;co&quot;&gt;# run this shell script by passing a URL as first argument&lt;/span&gt;
240 &lt;span class=&quot;ex&quot;&gt;java&lt;/span&gt; -Djdk.incubator.foreign.Foreign=permit --add-modules \
241     jdk.incubator.foreign -Djava.library.path=/usr/lib CurlMain.java &lt;span class=&quot;va&quot;&gt;$*&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
242 &lt;h2 id=&quot;using-blas-library&quot;&gt;Using BLAS library&lt;/h2&gt;
243 &lt;p&gt;BLAS is a popular library that allows fast matrix and vector computation: &lt;a href=&quot;http://www.netlib.org/blas/&quot; class=&quot;uri&quot;&gt;http://www.netlib.org/blas/&lt;/a&gt;.&lt;/p&gt;
244 &lt;h3 id=&quot;installing-openblas-mac-os&quot;&gt;Installing OpenBLAS (Mac OS)&lt;/h3&gt;
245 &lt;p&gt;On Mac, blas is available as part of the OpenBLAS library: &lt;a href=&quot;https://github.com/xianyi/OpenBLAS/wiki&quot; class=&quot;uri&quot;&gt;https://github.com/xianyi/OpenBLAS/wiki&lt;/a&gt;&lt;/p&gt;
246 &lt;p&gt;OpenBLAS is an optimized BLAS library based on GotoBLAS2 1.13 BSD version.&lt;/p&gt;
247 &lt;p&gt;You can install openblas using HomeBrew&lt;/p&gt;
248 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode sh&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;
249 &lt;span class=&quot;ex&quot;&gt;brew&lt;/span&gt; install openblas&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
250 &lt;p&gt;It installs include and lib directories under /usr/local/opt/openblas&lt;/p&gt;
251 &lt;h3 id=&quot;jextracting-cblas.h-macos&quot;&gt;jextracting cblas.h (MacOS)&lt;/h3&gt;
252 &lt;p&gt;The following command can be used to extract cblas.h on MacOs&lt;/p&gt;
253 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode sh&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;
254 &lt;span class=&quot;ex&quot;&gt;jextract&lt;/span&gt; -C &lt;span class=&quot;st&quot;&gt;&amp;quot;-D FORCE_OPENBLAS_COMPLEX_STRUCT&amp;quot;&lt;/span&gt; \
255   -I /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include \
256   --filter cblas.h \
257   -l openblas -t blas /usr/local/opt/openblas/include/cblas.h&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
258 &lt;h3 id=&quot;java-sample-code-that-uses-cblas-library&quot;&gt;Java sample code that uses cblas library&lt;/h3&gt;
259 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode java&quot;&gt;&lt;code class=&quot;sourceCode java&quot;&gt;
260 &lt;span class=&quot;kw&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; jdk.incubator.foreign.NativeAllocationScope;&lt;/span&gt;
261 &lt;span class=&quot;kw&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; blas.*;&lt;/span&gt;
262 &lt;span class=&quot;kw&quot;&gt;import static&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; blas.RuntimeHelper.*;&lt;/span&gt;
263 &lt;span class=&quot;kw&quot;&gt;import static&lt;/span&gt;&lt;span class=&quot;im&quot;&gt; blas.cblas_h.*;&lt;/span&gt;
264 
265 &lt;span class=&quot;kw&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;class&lt;/span&gt; TestBlas {
266     &lt;span class=&quot;kw&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;fu&quot;&gt;main&lt;/span&gt;(&lt;span class=&quot;bu&quot;&gt;String&lt;/span&gt;[] args) {
267         &lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; Layout;
268         &lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; transa;
269 
270         &lt;span class=&quot;dt&quot;&gt;double&lt;/span&gt; alpha, beta;
271         &lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; m, n, lda, incx, incy, i;
272 
273         Layout = CblasColMajor;
274         transa = CblasNoTrans;
275 
276         m = &lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;; &lt;span class=&quot;co&quot;&gt;/* Size of Column ( the number of rows ) */&lt;/span&gt;
277         n = &lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;; &lt;span class=&quot;co&quot;&gt;/* Size of Row ( the number of columns ) */&lt;/span&gt;
278         lda = &lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;; &lt;span class=&quot;co&quot;&gt;/* Leading dimension of 5 * 4 matrix is 5 */&lt;/span&gt;
279         incx = &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;;
280         incy = &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;;
281         alpha = &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;;
282         beta = &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;;
283         &lt;span class=&quot;kw&quot;&gt;try&lt;/span&gt; (NativeAllocationScope scope = NativeAllocationScope.&lt;span class=&quot;fu&quot;&gt;unboundedScope&lt;/span&gt;()) {
284             var a = Cdouble.&lt;span class=&quot;fu&quot;&gt;allocateArray&lt;/span&gt;(m*n, scope);
285             var x = Cdouble.&lt;span class=&quot;fu&quot;&gt;allocateArray&lt;/span&gt;(n, scope);
286             var y = Cdouble.&lt;span class=&quot;fu&quot;&gt;allocateArray&lt;/span&gt;(n, scope);
287 
288             &lt;span class=&quot;co&quot;&gt;/* The elements of the first column */&lt;/span&gt;
289             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;1.0&lt;/span&gt;);
290             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;2.0&lt;/span&gt;);
291             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;3.0&lt;/span&gt;);
292             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;4.0&lt;/span&gt;);
293             &lt;span class=&quot;co&quot;&gt;/* The elements of the second column */&lt;/span&gt;
294             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, m, &lt;span class=&quot;fl&quot;&gt;1.0&lt;/span&gt;);
295             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, m + &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;1.0&lt;/span&gt;);
296             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, m + &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;1.0&lt;/span&gt;);
297             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, m + &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;1.0&lt;/span&gt;);
298             &lt;span class=&quot;co&quot;&gt;/* The elements of the third column */&lt;/span&gt;
299             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, m*&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;3.0&lt;/span&gt;);
300             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, m*&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;4.0&lt;/span&gt;);
301             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, m*&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;5.0&lt;/span&gt;);
302             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, m*&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;6.0&lt;/span&gt;);
303             &lt;span class=&quot;co&quot;&gt;/* The elements of the fourth column */&lt;/span&gt;
304             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, m*&lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;5.0&lt;/span&gt;);
305             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, m*&lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt; + &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;6.0&lt;/span&gt;);
306             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, m*&lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt; + &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;7.0&lt;/span&gt;);
307             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(a, m*&lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt; + &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;8.0&lt;/span&gt;);
308             &lt;span class=&quot;co&quot;&gt;/* The elemetns of x and y */&lt;/span&gt;
309             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(x, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;1.0&lt;/span&gt;);
310             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(x, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;2.0&lt;/span&gt;);
311             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(x, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;1.0&lt;/span&gt;);
312             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(x, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;1.0&lt;/span&gt;);
313             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(y, &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;0.0&lt;/span&gt;);
314             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(y, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;0.0&lt;/span&gt;);
315             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(y, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;0.0&lt;/span&gt;);
316             Cdouble.&lt;span class=&quot;fu&quot;&gt;set&lt;/span&gt;(y, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;0.0&lt;/span&gt;);
317             &lt;span class=&quot;fu&quot;&gt;cblas_dgemv&lt;/span&gt;(Layout, transa, m, n, alpha, a, lda, x, incx, beta, y, incy);
318             &lt;span class=&quot;co&quot;&gt;/* Print y */&lt;/span&gt;
319             &lt;span class=&quot;kw&quot;&gt;for&lt;/span&gt; (i = &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; i++) {
320                 &lt;span class=&quot;bu&quot;&gt;System&lt;/span&gt;.&lt;span class=&quot;fu&quot;&gt;out&lt;/span&gt;.&lt;span class=&quot;fu&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;bu&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;fu&quot;&gt;.format&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot; y&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; = &lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;%f\n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;, i, Cdouble.&lt;span class=&quot;fu&quot;&gt;get&lt;/span&gt;(y, (&lt;span class=&quot;dt&quot;&gt;long&lt;/span&gt;)i)));
321             }
322         }
323     }
324 }&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
325 &lt;h3 id=&quot;compiling-and-running-the-above-lapack-sample&quot;&gt;Compiling and running the above LAPACK sample&lt;/h3&gt;
326 &lt;div class=&quot;sourceCode&quot;&gt;&lt;pre class=&quot;sourceCode sh&quot;&gt;&lt;code class=&quot;sourceCode bash&quot;&gt;
327 &lt;span class=&quot;ex&quot;&gt;java&lt;/span&gt; -Djdk.incubator.foreign.Foreign=permit --add-modules jdk.incubator.foreign \
328     -Djava.library.path=/usr/local/opt/openblas/lib \
329     TestBlas.java&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
330 &lt;/body&gt;
331 &lt;/html&gt;
    </pre>
  </body>
</html>