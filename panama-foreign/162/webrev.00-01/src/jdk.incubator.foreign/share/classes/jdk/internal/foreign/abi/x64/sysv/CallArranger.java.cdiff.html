<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.incubator.foreign/share/classes/jdk/internal/foreign/abi/x64/sysv/CallArranger.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../../../test/jdk/java/foreign/callarranger/TestSysVCallArranger.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.incubator.foreign/share/classes/jdk/internal/foreign/abi/x64/sysv/CallArranger.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 457,10 ***</span>
<span class="line-new-header">--- 457,11 ---</span>
  
          for (int i = 0; i &lt; classes.size(); i++) {
              ArgumentClassImpl c = classes.get(i);
  
              if (c == ArgumentClassImpl.MEMORY) {
<span class="line-added">+                 // if any of the eightbytes was passed in memory, pass the whole thing in memory</span>
                  return createMemoryClassArray(classes.size());
              }
  
              if (c == ArgumentClassImpl.X87UP) {
                  if (i == 0) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 539,11 ***</span>
              List&lt;ArgumentClassImpl&gt; layouts = groups[(int)offset / 8];
              if (layouts == null) {
                  layouts = new ArrayList&lt;&gt;();
                  groups[(int)offset / 8] = layouts;
              }
<span class="line-modified">!             layouts.add(classifyValueType((ValueLayout)l));</span>
          } else {
              throw new IllegalStateException(&quot;Unexpected layout: &quot; + l);
          }
      }
  }
<span class="line-new-header">--- 540,15 ---</span>
              List&lt;ArgumentClassImpl&gt; layouts = groups[(int)offset / 8];
              if (layouts == null) {
                  layouts = new ArrayList&lt;&gt;();
                  groups[(int)offset / 8] = layouts;
              }
<span class="line-modified">!             // if the aggregate contains unaligned fields, it has class MEMORY</span>
<span class="line-added">+             ArgumentClassImpl argumentClass = (offset % l.byteAlignment()) == 0 ?</span>
<span class="line-added">+                     classifyValueType((ValueLayout)l) :</span>
<span class="line-added">+                     ArgumentClassImpl.MEMORY;</span>
<span class="line-added">+             layouts.add(argumentClass);</span>
          } else {
              throw new IllegalStateException(&quot;Unexpected layout: &quot; + l);
          }
      }
  }
</pre>
<center>&lt; prev <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../../../test/jdk/java/foreign/callarranger/TestSysVCallArranger.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>