<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/sun/tools/jstack/DeadlockDetectionTest.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="BasicJStackTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../jstat/JStatInterval.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/sun/tools/jstack/DeadlockDetectionTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
33 import jdk.test.lib.Utils;
34 
35 import jtreg.SkippedException;
36 
37 /**
38  * @test
39  * @summary Test deadlock detection
40  * @requires vm.hasSA
41  * @library /test/lib
42  * @build jdk.test.lib.apps.*
43  * @build DeadlockDetectionTest
44  * @run main DeadlockDetectionTest
45  */
46 public class DeadlockDetectionTest {
47 
48     private static LingeredAppWithDeadlock theApp = null;
49     private static ProcessBuilder processBuilder = new ProcessBuilder();
50 
51     private static OutputAnalyzer jstack(String... toolArgs) throws Exception {
52         JDKToolLauncher launcher = JDKToolLauncher.createUsingTestJDK(&quot;jstack&quot;);

53         launcher.addVMArg(&quot;-XX:+UsePerfData&quot;);
54         if (toolArgs != null) {
55             for (String toolArg : toolArgs) {
56                 launcher.addToolArg(toolArg);
57             }
58         }
59 
60         processBuilder.command(launcher.getCommand());
61         System.out.println(processBuilder.command().stream().collect(Collectors.joining(&quot; &quot;)));
62         OutputAnalyzer output = ProcessTools.executeProcess(processBuilder);
63         System.out.println(output.getOutput());
64 
65         return output;
66     }
67 
68     public static void main(String[] args) throws Exception {
69         System.out.println(&quot;Starting DeadlockDetectionTest&quot;);
70 
71         if (!LingeredApp.isLastModifiedWorking()) {
72             // Exact behaviour of the test depends on operating system and the test nature,
</pre>
</td>
<td>
<hr />
<pre>
33 import jdk.test.lib.Utils;
34 
35 import jtreg.SkippedException;
36 
37 /**
38  * @test
39  * @summary Test deadlock detection
40  * @requires vm.hasSA
41  * @library /test/lib
42  * @build jdk.test.lib.apps.*
43  * @build DeadlockDetectionTest
44  * @run main DeadlockDetectionTest
45  */
46 public class DeadlockDetectionTest {
47 
48     private static LingeredAppWithDeadlock theApp = null;
49     private static ProcessBuilder processBuilder = new ProcessBuilder();
50 
51     private static OutputAnalyzer jstack(String... toolArgs) throws Exception {
52         JDKToolLauncher launcher = JDKToolLauncher.createUsingTestJDK(&quot;jstack&quot;);
<span class="line-added">53         launcher.addVMArgs(Utils.getFilteredTestJavaOpts(&quot;-XX:+UsePerfData&quot;));</span>
54         launcher.addVMArg(&quot;-XX:+UsePerfData&quot;);
55         if (toolArgs != null) {
56             for (String toolArg : toolArgs) {
57                 launcher.addToolArg(toolArg);
58             }
59         }
60 
61         processBuilder.command(launcher.getCommand());
62         System.out.println(processBuilder.command().stream().collect(Collectors.joining(&quot; &quot;)));
63         OutputAnalyzer output = ProcessTools.executeProcess(processBuilder);
64         System.out.println(output.getOutput());
65 
66         return output;
67     }
68 
69     public static void main(String[] args) throws Exception {
70         System.out.println(&quot;Starting DeadlockDetectionTest&quot;);
71 
72         if (!LingeredApp.isLastModifiedWorking()) {
73             // Exact behaviour of the test depends on operating system and the test nature,
</pre>
</td>
</tr>
</table>
<center><a href="BasicJStackTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../jstat/JStatInterval.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>