diff a/test/jdk/tools/jpackage/windows/WinUpgradeUUIDTest.java b/test/jdk/tools/jpackage/windows/WinUpgradeUUIDTest.java
--- a/test/jdk/tools/jpackage/windows/WinUpgradeUUIDTest.java
+++ b/test/jdk/tools/jpackage/windows/WinUpgradeUUIDTest.java
@@ -180,23 +180,29 @@
 
     static abstract class PropertyVerifier {
         void assertEquals(PackageTest x, PackageTest y) {
             var entryX = propertyValues().get(x);
             var entryY = propertyValues().get(y);
-            TKit.assertEquals(entryX.getValue(), entryY.getValue(),
+            // if MsiBundler is not supported, these will be null
+            if (entryX != null && entryY != null) {
+                TKit.assertEquals(entryX.getValue(), entryY.getValue(),
                     String.format(
                             "Check %s is the same for %s and %s command lines",
                             propertyName(), entryX.getKey(), entryY.getKey()));
+            }
         }
 
         void assertNotEquals(PackageTest x, PackageTest y) {
             var entryX = propertyValues().get(x);
             var entryY = propertyValues().get(y);
-            TKit.assertNotEquals(entryX.getValue(), entryY.getValue(),
+            // if MsiBundler is not supported, these will be null
+            if (entryX != null && entryY != null) {
+                TKit.assertNotEquals(entryX.getValue(), entryY.getValue(),
                     String.format(
                             "Check %s is different for %s and %s command lines",
                             propertyName(), entryX.getKey(), entryY.getKey()));
+            }
         }
 
         protected abstract String propertyName();
         protected abstract Map<PackageTest, Map.Entry<String, String>> propertyValues();
     }
