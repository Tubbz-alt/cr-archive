<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames test/jdk/javax/swing/JRadioButton/FocusTraversal/FocusTraversal.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (c) 2015, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 /* @test
 25  * @key headful
 26  * @bug 8129940 8132770 8161470 8163169
 27  * @summary JRadioButton should run custom FocusTraversalKeys for all LaFs
 28  * @run main FocusTraversal
 29  */
 30 import java.awt.BorderLayout;
 31 import java.awt.Component;
 32 import java.awt.KeyboardFocusManager;
 33 import java.awt.Robot;
 34 import java.awt.event.KeyEvent;
 35 import java.util.HashSet;
 36 import java.util.Set;
 37 import javax.swing.ButtonGroup;
 38 import javax.swing.FocusManager;
 39 import javax.swing.JButton;
 40 import javax.swing.JFrame;
 41 import javax.swing.JPanel;
 42 import javax.swing.JRadioButton;
 43 import javax.swing.JTextField;
 44 import javax.swing.KeyStroke;
 45 import javax.swing.SwingUtilities;
 46 import javax.swing.UIManager;
 47 import javax.swing.UnsupportedLookAndFeelException;
 48 
 49 public class FocusTraversal {
 50 
 51     private static JFrame frame;
 52     private static JRadioButton a;
 53     private static JRadioButton b;
 54     private static JRadioButton c;
 55     private static JRadioButton d;
 56     private static JTextField next;
 57     private static JTextField prev;
 58     private static Robot robot;
 59 
 60     public static void main(String[] args) throws Exception {
 61 
 62         robot = new Robot();
 63         robot.setAutoDelay(100);
 64         robot.waitForIdle();
 65         UIManager.LookAndFeelInfo[] lookAndFeelArray
 66                 = UIManager.getInstalledLookAndFeels();
 67         for (UIManager.LookAndFeelInfo lookAndFeelItem : lookAndFeelArray) {
 68             executeCase(lookAndFeelItem.getClassName());
 69         }
 70     }
 71 
 72     private static void executeCase(String lookAndFeelString)
 73             throws Exception {
 74         if (tryLookAndFeel(lookAndFeelString)) {
 75             createUI(lookAndFeelString);
 76             robot.waitForIdle();
 77             runTestCase();
 78             robot.waitForIdle();
 79             cleanUp();
 80             robot.waitForIdle();
 81         }
 82     }
 83 
 84     private static void createUI(final String lookAndFeelString)
 85             throws Exception {
 86         SwingUtilities.invokeAndWait(new Runnable() {
 87             @Override
 88             public void run() {
 89                 Set&lt;KeyStroke&gt; keystrokes = new HashSet&lt;KeyStroke&gt;();
 90                 keystrokes.add(KeyStroke.getKeyStroke(&quot;TAB&quot;));
 91                 keystrokes.add(KeyStroke.getKeyStroke(&quot;ENTER&quot;));
 92                 frame = new JFrame(&quot;FocusTraversalTest &quot; + lookAndFeelString);
 93                 frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
 94                 frame.setUndecorated(true);
 95                 frame.setFocusTraversalKeys(
 96                         KeyboardFocusManager.FORWARD_TRAVERSAL_KEYS,
 97                         keystrokes);
 98 
 99                 a = new JRadioButton(&quot;a&quot;);
100                 b = new JRadioButton(&quot;b&quot;);
101                 c = new JRadioButton(&quot;c&quot;);
102                 d = new JRadioButton(&quot;d&quot;);
103 
104                 ButtonGroup radioButtonGroup = new ButtonGroup();
105                 radioButtonGroup.add(a);
106                 radioButtonGroup.add(b);
107                 radioButtonGroup.add(c);
108                 radioButtonGroup.add(d);
109 
110                 JPanel panel = new JPanel();
111                 prev = new JTextField(&quot;text&quot;);
112                 panel.add(prev);
113                 panel.add(a);
114                 panel.add(b);
115                 panel.add(c);
116                 panel.add(d);
117                 next = new JTextField(&quot;text&quot;);
118                 panel.add(next);
119 
120                 JPanel root = new JPanel();
121                 root.setLayout(new BorderLayout());
122                 root.add(panel, BorderLayout.CENTER);
123                 root.add(new JButton(&quot;OK&quot;), BorderLayout.SOUTH);
124 
125                 frame.add(root);
126                 frame.pack();
127                 frame.setLocationRelativeTo(null);
128                 frame.setVisible(true);
129                 frame.toFront();
130             }
131         });
132     }
133 
134     private static void runTestCase() throws Exception {
135         focusOn(a);
136 
<a name="1" id="anc1"></a>

137         robot.keyPress(KeyEvent.VK_ENTER);
138         robot.keyRelease(KeyEvent.VK_ENTER);
139         robot.waitForIdle();
140         isFocusOwner(next, &quot;forward&quot;);
141         robot.keyPress(KeyEvent.VK_SHIFT);
142         robot.keyPress(KeyEvent.VK_TAB);
143         robot.keyRelease(KeyEvent.VK_TAB);
144         robot.keyRelease(KeyEvent.VK_SHIFT);
145         robot.waitForIdle();
146         isFocusOwner(a, &quot;backward&quot;);
147 
148     }
149 
150     private static void focusOn(Component component)
151             throws Exception {
152         SwingUtilities.invokeAndWait(new Runnable() {
153             @Override
154             public void run() {
155                 component.requestFocusInWindow();
156             }
157         });
158     }
159 
160     private static void isFocusOwner(Component queriedFocusOwner,
161             String direction)
162             throws Exception {
163         SwingUtilities.invokeAndWait(new Runnable() {
164             @Override
165             public void run() {
166                 Component actualFocusOwner
167                         = FocusManager.getCurrentManager().getFocusOwner();
168                 if (actualFocusOwner != queriedFocusOwner) {
169                     frame.dispose();
170                     throw new RuntimeException(
171                             &quot;Focus component is wrong after &quot; + direction
172                             + &quot; direction &quot;);
173 
174                 }
175             }
176         });
177     }
178 
179     private static boolean tryLookAndFeel(String lookAndFeelString)
180             throws Exception {
181 
182         try {
183             UIManager.setLookAndFeel(
184                     lookAndFeelString);
185 
186         } catch (UnsupportedLookAndFeelException
187                 | ClassNotFoundException
188                 | InstantiationException
189                 | IllegalAccessException e) {
190             return false;
191         }
<a name="2" id="anc2"></a>
192         return true;
193     }
194 
195     private static void cleanUp() throws Exception {
196         SwingUtilities.invokeAndWait(new Runnable() {
197             @Override
198             public void run() {
199                 frame.dispose();
200             }
201         });
202     }
203 }
<a name="3" id="anc3"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="3" type="hidden" />
</body>
</html>