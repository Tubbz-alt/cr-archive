<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/runtime/cds/appcds/TestZGCWithCDS.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="TestCommon.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="dynamicArchive/AppendClasspath.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/runtime/cds/appcds/TestZGCWithCDS.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 45     public static void main(String... args) throws Exception {
 46          String helloJar = JarBuilder.build(&quot;hello&quot;, &quot;Hello&quot;);
 47          System.out.println(&quot;0. Dump with ZGC&quot;);
 48          OutputAnalyzer out = TestCommon
 49                                   .dump(helloJar,
 50                                         new String[] {&quot;Hello&quot;},
 51                                         &quot;-XX:+UseZGC&quot;,
 52                                         &quot;-Xlog:cds&quot;);
 53          out.shouldContain(&quot;Dumping shared data to file:&quot;);
 54          out.shouldHaveExitValue(0);
 55 
 56          System.out.println(&quot;1. Run with same args of dump&quot;);
 57          out = TestCommon
 58                    .exec(helloJar,
 59                          &quot;-XX:+UseZGC&quot;,
 60                          &quot;-Xlog:cds&quot;,
 61                          &quot;Hello&quot;);
 62          out.shouldContain(HELLO);
 63          out.shouldHaveExitValue(0);
 64 
<span class="line-modified"> 65          System.out.println(&quot;2. Run with -UseCompressedOops -UseCompressedClassPointers&quot;);</span>












 66          out = TestCommon
 67                    .exec(helloJar,
 68                          &quot;-XX:+UseSerialGC&quot;,
 69                          &quot;-XX:-UseCompressedOops&quot;,
 70                          &quot;-XX:-UseCompressedClassPointers&quot;,
 71                          &quot;-Xlog:cds&quot;,
 72                          &quot;Hello&quot;);












 73          out.shouldContain(HELLO);
 74          out.shouldHaveExitValue(0);
 75 
<span class="line-modified"> 76          System.out.println(&quot;3. Run with +UseCompressedOops -UseCompressedClassPointers&quot;);</span>
 77          out = TestCommon
 78                    .exec(helloJar,
 79                          &quot;-XX:+UseSerialGC&quot;,
 80                          &quot;-XX:+UseCompressedOops&quot;,
 81                          &quot;-XX:-UseCompressedClassPointers&quot;,
 82                          &quot;-Xlog:cds&quot;,
 83                          &quot;Hello&quot;);
 84          out.shouldContain(UNABLE_TO_USE_ARCHIVE);
 85          out.shouldContain(ERR_MSG);
 86          out.shouldHaveExitValue(1);
 87 
<span class="line-modified"> 88          System.out.println(&quot;4. Run with +UseCompressedOops +UseCompressedClassPointers&quot;);</span>
 89          out = TestCommon
 90                    .exec(helloJar,
 91                          &quot;-XX:+UseSerialGC&quot;,
 92                          &quot;-XX:+UseCompressedOops&quot;,
 93                          &quot;-XX:+UseCompressedClassPointers&quot;,
 94                          &quot;-Xlog:cds&quot;,
 95                          &quot;Hello&quot;);
 96          out.shouldContain(UNABLE_TO_USE_ARCHIVE);
 97          out.shouldContain(ERR_MSG);
 98          out.shouldHaveExitValue(1);
 99 
<span class="line-modified">100          System.out.println(&quot;5. Dump with -UseCompressedOops -UseCompressedClassPointers&quot;);</span>
101          out = TestCommon
102                    .dump(helloJar,
103                          new String[] {&quot;Hello&quot;},
104                          &quot;-XX:+UseSerialGC&quot;,
105                          &quot;-XX:-UseCompressedOops&quot;,
<span class="line-modified">106                          &quot;-XX:-UseCompressedClassPointers&quot;,</span>
107                          &quot;-Xlog:cds&quot;);
108          out.shouldContain(&quot;Dumping shared data to file:&quot;);
109          out.shouldHaveExitValue(0);
110 
<span class="line-modified">111          System.out.println(&quot;6. Run with ZGC&quot;);</span>
112          out = TestCommon
113                    .exec(helloJar,
114                          &quot;-XX:+UseZGC&quot;,
115                          &quot;-Xlog:cds&quot;,
116                          &quot;Hello&quot;);
117          out.shouldContain(HELLO);
118          out.shouldHaveExitValue(0);
119     }
120 }
</pre>
</td>
<td>
<hr />
<pre>
 45     public static void main(String... args) throws Exception {
 46          String helloJar = JarBuilder.build(&quot;hello&quot;, &quot;Hello&quot;);
 47          System.out.println(&quot;0. Dump with ZGC&quot;);
 48          OutputAnalyzer out = TestCommon
 49                                   .dump(helloJar,
 50                                         new String[] {&quot;Hello&quot;},
 51                                         &quot;-XX:+UseZGC&quot;,
 52                                         &quot;-Xlog:cds&quot;);
 53          out.shouldContain(&quot;Dumping shared data to file:&quot;);
 54          out.shouldHaveExitValue(0);
 55 
 56          System.out.println(&quot;1. Run with same args of dump&quot;);
 57          out = TestCommon
 58                    .exec(helloJar,
 59                          &quot;-XX:+UseZGC&quot;,
 60                          &quot;-Xlog:cds&quot;,
 61                          &quot;Hello&quot;);
 62          out.shouldContain(HELLO);
 63          out.shouldHaveExitValue(0);
 64 
<span class="line-modified"> 65          System.out.println(&quot;2. Run with +UseCompressedOops +UseCompressedClassPointers&quot;);</span>
<span class="line-added"> 66          out = TestCommon</span>
<span class="line-added"> 67                    .exec(helloJar,</span>
<span class="line-added"> 68                          &quot;-XX:-UseZGC&quot;,</span>
<span class="line-added"> 69                          &quot;-XX:+UseCompressedOops&quot;,           // in case turned off by vmoptions</span>
<span class="line-added"> 70                          &quot;-XX:+UseCompressedClassPointers&quot;,  // by jtreg</span>
<span class="line-added"> 71                          &quot;-Xlog:cds&quot;,</span>
<span class="line-added"> 72                          &quot;Hello&quot;);</span>
<span class="line-added"> 73          out.shouldContain(UNABLE_TO_USE_ARCHIVE);</span>
<span class="line-added"> 74          out.shouldContain(ERR_MSG);</span>
<span class="line-added"> 75          out.shouldHaveExitValue(1);</span>
<span class="line-added"> 76 </span>
<span class="line-added"> 77          System.out.println(&quot;3. Run with -UseCompressedOops -UseCompressedClassPointers&quot;);</span>
 78          out = TestCommon
 79                    .exec(helloJar,
 80                          &quot;-XX:+UseSerialGC&quot;,
 81                          &quot;-XX:-UseCompressedOops&quot;,
 82                          &quot;-XX:-UseCompressedClassPointers&quot;,
 83                          &quot;-Xlog:cds&quot;,
 84                          &quot;Hello&quot;);
<span class="line-added"> 85          out.shouldContain(UNABLE_TO_USE_ARCHIVE);</span>
<span class="line-added"> 86          out.shouldContain(ERR_MSG);</span>
<span class="line-added"> 87          out.shouldHaveExitValue(1);</span>
<span class="line-added"> 88 </span>
<span class="line-added"> 89          System.out.println(&quot;4. Run with -UseCompressedOops +UseCompressedClassPointers&quot;);</span>
<span class="line-added"> 90          out = TestCommon</span>
<span class="line-added"> 91                    .exec(helloJar,</span>
<span class="line-added"> 92                          &quot;-XX:+UseSerialGC&quot;,</span>
<span class="line-added"> 93                          &quot;-XX:-UseCompressedOops&quot;,</span>
<span class="line-added"> 94                          &quot;-XX:+UseCompressedClassPointers&quot;,</span>
<span class="line-added"> 95                          &quot;-Xlog:cds&quot;,</span>
<span class="line-added"> 96                          &quot;Hello&quot;);</span>
 97          out.shouldContain(HELLO);
 98          out.shouldHaveExitValue(0);
 99 
<span class="line-modified">100          System.out.println(&quot;5. Run with +UseCompressedOops -UseCompressedClassPointers&quot;);</span>
101          out = TestCommon
102                    .exec(helloJar,
103                          &quot;-XX:+UseSerialGC&quot;,
104                          &quot;-XX:+UseCompressedOops&quot;,
105                          &quot;-XX:-UseCompressedClassPointers&quot;,
106                          &quot;-Xlog:cds&quot;,
107                          &quot;Hello&quot;);
108          out.shouldContain(UNABLE_TO_USE_ARCHIVE);
109          out.shouldContain(ERR_MSG);
110          out.shouldHaveExitValue(1);
111 
<span class="line-modified">112          System.out.println(&quot;6. Run with +UseCompressedOops +UseCompressedClassPointers&quot;);</span>
113          out = TestCommon
114                    .exec(helloJar,
115                          &quot;-XX:+UseSerialGC&quot;,
116                          &quot;-XX:+UseCompressedOops&quot;,
117                          &quot;-XX:+UseCompressedClassPointers&quot;,
118                          &quot;-Xlog:cds&quot;,
119                          &quot;Hello&quot;);
120          out.shouldContain(UNABLE_TO_USE_ARCHIVE);
121          out.shouldContain(ERR_MSG);
122          out.shouldHaveExitValue(1);
123 
<span class="line-modified">124          System.out.println(&quot;7. Dump with -UseCompressedOops -UseCompressedClassPointers&quot;);</span>
125          out = TestCommon
126                    .dump(helloJar,
127                          new String[] {&quot;Hello&quot;},
128                          &quot;-XX:+UseSerialGC&quot;,
129                          &quot;-XX:-UseCompressedOops&quot;,
<span class="line-modified">130                          &quot;-XX:+UseCompressedClassPointers&quot;,</span>
131                          &quot;-Xlog:cds&quot;);
132          out.shouldContain(&quot;Dumping shared data to file:&quot;);
133          out.shouldHaveExitValue(0);
134 
<span class="line-modified">135          System.out.println(&quot;8. Run with ZGC&quot;);</span>
136          out = TestCommon
137                    .exec(helloJar,
138                          &quot;-XX:+UseZGC&quot;,
139                          &quot;-Xlog:cds&quot;,
140                          &quot;Hello&quot;);
141          out.shouldContain(HELLO);
142          out.shouldHaveExitValue(0);
143     }
144 }
</pre>
</td>
</tr>
</table>
<center><a href="TestCommon.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="dynamicArchive/AppendClasspath.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>