<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff make/common/JavaCompilation.gmk</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="../autoconf/util_windows.m4.udiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="MakeBase.gmk.udiff.html" target="_top">next &gt;</a></center>    <h2>make/common/JavaCompilation.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -380,10 +380,12 @@</span>
      # Create a sed expression to remove the source roots and to replace / with .
      # and remove .java at the end.
      $1_REWRITE_INTO_CLASSES:=$$(foreach i,$$($1_SRC),-e &#39;s|$$i/||g&#39;) -e &#39;s|/|.|g&#39; -e &#39;s|.java$$$$||g&#39;
  
      $1_COMPILE_TARGET := $$($1_BIN)$$($1_MODULE_SUBDIR)/_the.$1_batch
<span class="udiff-line-added">+     $1_FILELIST := $$($1_BIN)$$($1_MODULE_SUBDIR)/_the.$1_batch.filelist</span>
<span class="udiff-line-added">+ </span>
      $1_API_TARGET := $$($1_BIN)$$($1_MODULE_SUBDIR)/_the.$1_pubapi
  
      # Put headers in a temp dir to filter out those that actually
      # changed before copying them to the real header dir.
      ifneq (,$$($1_HEADERS))
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -419,21 +421,27 @@</span>
            #
  
        $1_EXTRA_DEPS := $$(BUILDTOOLS_OUTPUTDIR)/depend/_the.COMPILE_DEPEND_batch
      endif
  
<span class="udiff-line-modified-removed">-     # Pass along all sources to javac using an @file.</span>
<span class="udiff-line-modified-removed">-     $$($1_COMPILE_TARGET): $$($1_SRCS) $$($1_DEPENDS) $$($1_VARDEPS_FILE) \</span>
<span class="udiff-line-modified-removed">-         $$($1_EXTRA_DEPS)</span>
<span class="udiff-line-modified-added">+     # Create a file with all sources, to pass to javac in an @file.</span>
<span class="udiff-line-modified-added">+     # $$($1_VARDEPS_FILE) is used as dependency to track changes in set of</span>
<span class="udiff-line-modified-added">+     # list of files.</span>
<span class="udiff-line-added">+     $$($1_FILELIST): $$($1_SRCS) $$($1_VARDEPS_FILE)</span>
  		$$(call MakeDir, $$(@D))
<span class="udiff-line-removed">- 		$$(eval $$(call ListPathsSafely,$1_SRCS, $$@.tmp))</span>
  		$$(call LogWarn, Compiling $$(words $$($1_SRCS)) files for $1)
<span class="udiff-line-added">+ 		$$(eval $$(call ListPathsSafely, $1_SRCS, $$($1_FILELIST)))</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     # Do the actual compilation</span>
<span class="udiff-line-added">+     $$($1_COMPILE_TARGET): $$($1_SRCS) $$($1_FILELIST) $$($1_DEPENDS) \</span>
<span class="udiff-line-added">+         $$($1_VARDEPS_FILE) $$($1_EXTRA_DEPS)</span>
<span class="udiff-line-added">+ 		$$(call MakeDir, $$(@D))</span>
  		$$(call ExecuteWithLog, $$($1_BIN)$$($1_MODULE_SUBDIR)/_the.$$($1_SAFE_NAME)_batch, \
  		    $$($1_JAVAC_CMD) $$($1_FLAGS) \
  		        $$($1_API_DIGEST_FLAGS) \
<span class="udiff-line-modified-removed">- 		        -d $$($1_BIN) $$($1_HEADERS_ARG) @$$@.tmp) &amp;&amp; \</span>
<span class="udiff-line-modified-removed">- 		$(MV) $$@.tmp $$@</span>
<span class="udiff-line-modified-added">+ 		        -d $$($1_BIN) $$($1_HEADERS_ARG) @$$($1_FILELIST)) &amp;&amp; \</span>
<span class="udiff-line-modified-added">+ 		$(TOUCH) $$@</span>
  
      # Add all targets to main variable
      $1 := $$($1_ALL_COPY_TARGETS) $$($1_ALL_COPY_CLEAN_TARGETS) $$($1_COMPILE_TARGET) \
          $$($1_HEADER_TARGETS)
  
</pre>
<center><a href="../autoconf/util_windows.m4.udiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="MakeBase.gmk.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>