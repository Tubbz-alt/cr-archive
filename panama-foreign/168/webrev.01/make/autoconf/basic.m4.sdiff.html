<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/autoconf/basic.m4</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="../TestImage.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="basic_tools.m4.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/autoconf/basic.m4</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
406   # a non-zero exit code is given
407   if test &quot;x$DF&quot; = x; then
408     if test &quot;x$OPENJDK_BUILD_OS_ENV&quot; = &quot;xwindows.msys&quot;; then
409       # msys does not have df; use Windows &quot;net use&quot; instead.
410       IS_NETWORK_DISK=`net use | grep \`pwd -W | cut -d &quot;:&quot; -f 1 | tr a-z A-Z\`:`
411       if test &quot;x$IS_NETWORK_DISK&quot; = x; then
412         $2
413       else
414         $3
415       fi
416     else
417       # No df here, say it&#39;s local
418       $2
419     fi
420   else
421     # JDK-8189619
422     # df on AIX does not understand -l. On modern AIXes it understands &quot;-T local&quot; which
423     # is the same. On older AIXes we just continue to live with a &quot;not local build&quot; warning.
424     if test &quot;x$OPENJDK_TARGET_OS&quot; = xaix; then
425       DF_LOCAL_ONLY_OPTION=&#39;-T local&#39;



426     else
427       DF_LOCAL_ONLY_OPTION=&#39;-l&#39;
428     fi
429     if $DF $DF_LOCAL_ONLY_OPTION $1 &gt; /dev/null 2&gt;&amp;1; then
430       $2
431     else
<span class="line-modified">432       # In WSL, local Windows drives are considered remote by df, but we are</span>
<span class="line-removed">433       # required to build into a directory accessible from windows, so consider</span>
<span class="line-removed">434       # them local here.</span>
<span class="line-removed">435       if test &quot;x$OPENJDK_BUILD_OS_ENV&quot; = &quot;xwindows.wsl&quot;; then</span>
<span class="line-removed">436         if $DF $1 | $GREP -q &quot;^[[A-Z]]:&quot;; then</span>
<span class="line-removed">437           $2</span>
<span class="line-removed">438         else</span>
<span class="line-removed">439           $3</span>
<span class="line-removed">440         fi</span>
<span class="line-removed">441       else</span>
<span class="line-removed">442         $3</span>
<span class="line-removed">443       fi</span>
444     fi
445   fi
446 ])
447 
448 ###############################################################################
449 # Check that source files have basic read permissions set. This might
450 # not be the case in cygwin in certain conditions.
451 AC_DEFUN_ONCE([BASIC_CHECK_SRC_PERMS],
452 [
453   if test &quot;x$OPENJDK_BUILD_OS_ENV&quot; = &quot;xwindows.cygwin&quot;; then
454     file_to_test=&quot;$TOPDIR/LICENSE&quot;
455     if test `$STAT -c &#39;%a&#39; &quot;$file_to_test&quot;` -lt 400; then
456       AC_MSG_ERROR([Bad file permissions on src files. This is usually caused by cloning the repositories with a non cygwin hg in a directory not created in cygwin.])
457     fi
458   fi
459 ])
460 
461 ###############################################################################
462 AC_DEFUN_ONCE([BASIC_TEST_USABILITY_ISSUES],
463 [
</pre>
</td>
<td>
<hr />
<pre>
406   # a non-zero exit code is given
407   if test &quot;x$DF&quot; = x; then
408     if test &quot;x$OPENJDK_BUILD_OS_ENV&quot; = &quot;xwindows.msys&quot;; then
409       # msys does not have df; use Windows &quot;net use&quot; instead.
410       IS_NETWORK_DISK=`net use | grep \`pwd -W | cut -d &quot;:&quot; -f 1 | tr a-z A-Z\`:`
411       if test &quot;x$IS_NETWORK_DISK&quot; = x; then
412         $2
413       else
414         $3
415       fi
416     else
417       # No df here, say it&#39;s local
418       $2
419     fi
420   else
421     # JDK-8189619
422     # df on AIX does not understand -l. On modern AIXes it understands &quot;-T local&quot; which
423     # is the same. On older AIXes we just continue to live with a &quot;not local build&quot; warning.
424     if test &quot;x$OPENJDK_TARGET_OS&quot; = xaix; then
425       DF_LOCAL_ONLY_OPTION=&#39;-T local&#39;
<span class="line-added">426     elif test &quot;x$OPENJDK_BUILD_OS_ENV&quot; = &quot;xwindows.wsl&quot;; then</span>
<span class="line-added">427       # In WSL, we can only build on a drvfs file system (that is, a mounted real Windows drive)</span>
<span class="line-added">428       DF_LOCAL_ONLY_OPTION=&#39;-t drvfs&#39;</span>
429     else
430       DF_LOCAL_ONLY_OPTION=&#39;-l&#39;
431     fi
432     if $DF $DF_LOCAL_ONLY_OPTION $1 &gt; /dev/null 2&gt;&amp;1; then
433       $2
434     else
<span class="line-modified">435       $3</span>











436     fi
437   fi
438 ])
439 
440 ###############################################################################
441 # Check that source files have basic read permissions set. This might
442 # not be the case in cygwin in certain conditions.
443 AC_DEFUN_ONCE([BASIC_CHECK_SRC_PERMS],
444 [
445   if test &quot;x$OPENJDK_BUILD_OS_ENV&quot; = &quot;xwindows.cygwin&quot;; then
446     file_to_test=&quot;$TOPDIR/LICENSE&quot;
447     if test `$STAT -c &#39;%a&#39; &quot;$file_to_test&quot;` -lt 400; then
448       AC_MSG_ERROR([Bad file permissions on src files. This is usually caused by cloning the repositories with a non cygwin hg in a directory not created in cygwin.])
449     fi
450   fi
451 ])
452 
453 ###############################################################################
454 AC_DEFUN_ONCE([BASIC_TEST_USABILITY_ISSUES],
455 [
</pre>
</td>
</tr>
</table>
<center><a href="../TestImage.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="basic_tools.m4.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>