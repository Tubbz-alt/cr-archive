<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff make/autoconf/toolchain.m4</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="lib-tests.m4.cdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="toolchain_windows.m4.cdiff.html" target="_top">next &gt;</a></center>    <h2>make/autoconf/toolchain.m4</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 632,11 ***</span>
<span class="line-new-header">--- 632,16 ---</span>
      LINKER_VERSION_NUMBER=&quot;0.0&quot;
    elif test  &quot;x$TOOLCHAIN_TYPE&quot; = xmicrosoft; then
      # There is no specific version flag, but all output starts with a version string.
      # First line typically looks something like:
      #   Microsoft (R) Incremental Linker Version 12.00.31101.0
<span class="line-added">+     # Reset PATH since it can contain a mix of WSL/linux paths and Windows paths from VS,</span>
<span class="line-added">+     # which, in combination with WSLENV, will make the WSL layer complain</span>
<span class="line-added">+     old_path=&quot;$PATH&quot;</span>
<span class="line-added">+     PATH=</span>
      LINKER_VERSION_STRING=`$LD 2&gt;&amp;1 | $HEAD -n 1 | $TR -d &#39;\r&#39;`
<span class="line-added">+     PATH=&quot;$old_path&quot;</span>
      # Extract version number
      [ LINKER_VERSION_NUMBER=`$ECHO $LINKER_VERSION_STRING | \
          $SED -e &#39;s/.* \([0-9][0-9]*\(\.[0-9][0-9]*\)*\).*/\1/&#39;` ]
    elif test  &quot;x$TOOLCHAIN_TYPE&quot; = xgcc; then
      # gcc -Wl,-version output typically looks like:
</pre>
<hr />
<pre>
<span class="line-old-header">*** 730,17 ***</span>
<span class="line-new-header">--- 735,27 ---</span>
      # a cygwin program for something completely different.
      AC_CHECK_PROG([LD], [link$EXE_SUFFIX],[link$EXE_SUFFIX],,, [$CYGWIN_LINK])
      UTIL_FIXUP_EXECUTABLE(LD)
      # Verify that we indeed succeeded with this trick.
      AC_MSG_CHECKING([if the found link.exe is actually the Visual Studio linker])
<span class="line-added">+ </span>
<span class="line-added">+     # Reset PATH since it can contain a mix of WSL/linux paths and Windows paths from VS,</span>
<span class="line-added">+     # which, in combination with WSLENV, will make the WSL layer complain</span>
<span class="line-added">+     old_path=&quot;$PATH&quot;</span>
<span class="line-added">+     PATH=</span>
<span class="line-added">+ </span>
      &quot;$LD&quot; --version &gt; /dev/null
<span class="line-added">+ </span>
      if test $? -eq 0 ; then
        AC_MSG_RESULT([no])
        AC_MSG_ERROR([This is the Cygwin link tool. Please check your PATH and rerun configure.])
      else
        AC_MSG_RESULT([yes])
      fi
<span class="line-added">+ </span>
<span class="line-added">+     PATH=&quot;$old_path&quot;</span>
<span class="line-added">+ </span>
      LDCXX=&quot;$LD&quot;
      # jaotc being a windows program expects the linker to be supplied with exe suffix.
      LD_JAOTC=&quot;$LD$EXE_SUFFIX&quot;
    else
      # All other toolchains use the compiler to link.
</pre>
<center><a href="lib-tests.m4.cdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="toolchain_windows.m4.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>