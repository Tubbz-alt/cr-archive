<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.compiler/share/classes/com/sun/tools/javac/main/CommandLine.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Arguments.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="Main.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.compiler/share/classes/com/sun/tools/javac/main/CommandLine.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 39  *
 40  *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
 41  *  If you write code that depends on this, you do so at your own risk.
 42  *  This code and its internal interfaces are subject to change or
 43  *  deletion without notice.&lt;/b&gt;
 44  */
 45 public class CommandLine {
 46     /**
 47      * Process Win32-style command files for the specified command line
 48      * arguments and return the resulting arguments. A command file argument
 49      * is of the form &#39;@file&#39; where &#39;file&#39; is the name of the file whose
 50      * contents are to be parsed for additional arguments. The contents of
 51      * the command file are parsed using StreamTokenizer and the original
 52      * &#39;@file&#39; argument replaced with the resulting tokens. Recursive command
 53      * files are not supported. The &#39;@&#39; character itself can be quoted with
 54      * the sequence &#39;@@&#39;.
 55      * @param args the arguments that may contain @files
 56      * @return the arguments, with @files expanded
 57      * @throws IOException if there is a problem reading any of the @files
 58      */
<span class="line-modified"> 59     public static String[] parse(String[] args) throws IOException {</span>
 60         List&lt;String&gt; newArgs = new ArrayList&lt;&gt;();
<span class="line-modified"> 61         appendParsedCommandArgs(newArgs, Arrays.asList(args));</span>
<span class="line-modified"> 62         return newArgs.toArray(new String[newArgs.size()]);</span>
 63     }
 64 
 65     private static void appendParsedCommandArgs(List&lt;String&gt; newArgs, List&lt;String&gt; args) throws IOException {
 66         for (String arg : args) {
 67             if (arg.length() &gt; 1 &amp;&amp; arg.charAt(0) == &#39;@&#39;) {
 68                 arg = arg.substring(1);
 69                 if (arg.charAt(0) == &#39;@&#39;) {
 70                     newArgs.add(arg);
 71                 } else {
 72                     loadCmdFile(arg, newArgs);
 73                 }
 74             } else {
 75                 newArgs.add(arg);
 76             }
 77         }
 78     }
 79 
 80     /**
 81      * Process the given environment variable and appends any Win32-style
 82      * command files for the specified command line arguments and return
</pre>
<hr />
<pre>
 87      * &#39;@file&#39; argument replaced with the resulting tokens. Recursive command
 88      * files are not supported. The &#39;@&#39; character itself can be quoted with
 89      * the sequence &#39;@@&#39;.
 90      * @param envVariable the env variable to process
 91      * @param args the arguments that may contain @files
 92      * @return the arguments, with environment variable&#39;s content and expansion of @files
 93      * @throws IOException if there is a problem reading any of the @files
 94      * @throws com.sun.tools.javac.main.CommandLine.UnmatchedQuote
 95      */
 96     public static List&lt;String&gt; parse(String envVariable, List&lt;String&gt; args)
 97             throws IOException, UnmatchedQuote {
 98 
 99         List&lt;String&gt; inArgs = new ArrayList&lt;&gt;();
100         appendParsedEnvVariables(inArgs, envVariable);
101         inArgs.addAll(args);
102         List&lt;String&gt; newArgs = new ArrayList&lt;&gt;();
103         appendParsedCommandArgs(newArgs, inArgs);
104         return newArgs;
105     }
106 
<span class="line-removed">107     /**</span>
<span class="line-removed">108      * Process the given environment variable and appends any Win32-style</span>
<span class="line-removed">109      * command files for the specified command line arguments and return</span>
<span class="line-removed">110      * the resulting arguments. A command file argument</span>
<span class="line-removed">111      * is of the form &#39;@file&#39; where &#39;file&#39; is the name of the file whose</span>
<span class="line-removed">112      * contents are to be parsed for additional arguments. The contents of</span>
<span class="line-removed">113      * the command file are parsed using StreamTokenizer and the original</span>
<span class="line-removed">114      * &#39;@file&#39; argument replaced with the resulting tokens. Recursive command</span>
<span class="line-removed">115      * files are not supported. The &#39;@&#39; character itself can be quoted with</span>
<span class="line-removed">116      * the sequence &#39;@@&#39;.</span>
<span class="line-removed">117      * @param envVariable the env variable to process</span>
<span class="line-removed">118      * @param args the arguments that may contain @files</span>
<span class="line-removed">119      * @return the arguments, with environment variable&#39;s content and expansion of @files</span>
<span class="line-removed">120      * @throws IOException if there is a problem reading any of the @files</span>
<span class="line-removed">121      * @throws com.sun.tools.javac.main.CommandLine.UnmatchedQuote</span>
<span class="line-removed">122      */</span>
<span class="line-removed">123     public static String[] parse(String envVariable, String[] args) throws IOException, UnmatchedQuote {</span>
<span class="line-removed">124         List&lt;String&gt; out = parse(envVariable, Arrays.asList(args));</span>
<span class="line-removed">125         return out.toArray(new String[out.size()]);</span>
<span class="line-removed">126     }</span>
<span class="line-removed">127 </span>
128     private static void loadCmdFile(String name, List&lt;String&gt; args) throws IOException {
129         try (Reader r = Files.newBufferedReader(Paths.get(name), Charset.defaultCharset())) {
130             Tokenizer t = new Tokenizer(r);
131             String s;
132             while ((s = t.nextToken()) != null) {
133                 args.add(s);
134             }
135         }
136     }
137 
138     public static class Tokenizer {
139         private final Reader in;
140         private int ch;
141 
142         public Tokenizer(Reader in) throws IOException {
143             this.in = in;
144             ch = in.read();
145         }
146 
147         public String nextToken() throws IOException {
</pre>
</td>
<td>
<hr />
<pre>
 39  *
 40  *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
 41  *  If you write code that depends on this, you do so at your own risk.
 42  *  This code and its internal interfaces are subject to change or
 43  *  deletion without notice.&lt;/b&gt;
 44  */
 45 public class CommandLine {
 46     /**
 47      * Process Win32-style command files for the specified command line
 48      * arguments and return the resulting arguments. A command file argument
 49      * is of the form &#39;@file&#39; where &#39;file&#39; is the name of the file whose
 50      * contents are to be parsed for additional arguments. The contents of
 51      * the command file are parsed using StreamTokenizer and the original
 52      * &#39;@file&#39; argument replaced with the resulting tokens. Recursive command
 53      * files are not supported. The &#39;@&#39; character itself can be quoted with
 54      * the sequence &#39;@@&#39;.
 55      * @param args the arguments that may contain @files
 56      * @return the arguments, with @files expanded
 57      * @throws IOException if there is a problem reading any of the @files
 58      */
<span class="line-modified"> 59     public static List&lt;String&gt; parse(List&lt;String&gt; args) throws IOException {</span>
 60         List&lt;String&gt; newArgs = new ArrayList&lt;&gt;();
<span class="line-modified"> 61         appendParsedCommandArgs(newArgs, args);</span>
<span class="line-modified"> 62         return newArgs;</span>
 63     }
 64 
 65     private static void appendParsedCommandArgs(List&lt;String&gt; newArgs, List&lt;String&gt; args) throws IOException {
 66         for (String arg : args) {
 67             if (arg.length() &gt; 1 &amp;&amp; arg.charAt(0) == &#39;@&#39;) {
 68                 arg = arg.substring(1);
 69                 if (arg.charAt(0) == &#39;@&#39;) {
 70                     newArgs.add(arg);
 71                 } else {
 72                     loadCmdFile(arg, newArgs);
 73                 }
 74             } else {
 75                 newArgs.add(arg);
 76             }
 77         }
 78     }
 79 
 80     /**
 81      * Process the given environment variable and appends any Win32-style
 82      * command files for the specified command line arguments and return
</pre>
<hr />
<pre>
 87      * &#39;@file&#39; argument replaced with the resulting tokens. Recursive command
 88      * files are not supported. The &#39;@&#39; character itself can be quoted with
 89      * the sequence &#39;@@&#39;.
 90      * @param envVariable the env variable to process
 91      * @param args the arguments that may contain @files
 92      * @return the arguments, with environment variable&#39;s content and expansion of @files
 93      * @throws IOException if there is a problem reading any of the @files
 94      * @throws com.sun.tools.javac.main.CommandLine.UnmatchedQuote
 95      */
 96     public static List&lt;String&gt; parse(String envVariable, List&lt;String&gt; args)
 97             throws IOException, UnmatchedQuote {
 98 
 99         List&lt;String&gt; inArgs = new ArrayList&lt;&gt;();
100         appendParsedEnvVariables(inArgs, envVariable);
101         inArgs.addAll(args);
102         List&lt;String&gt; newArgs = new ArrayList&lt;&gt;();
103         appendParsedCommandArgs(newArgs, inArgs);
104         return newArgs;
105     }
106 





















107     private static void loadCmdFile(String name, List&lt;String&gt; args) throws IOException {
108         try (Reader r = Files.newBufferedReader(Paths.get(name), Charset.defaultCharset())) {
109             Tokenizer t = new Tokenizer(r);
110             String s;
111             while ((s = t.nextToken()) != null) {
112                 args.add(s);
113             }
114         }
115     }
116 
117     public static class Tokenizer {
118         private final Reader in;
119         private int ch;
120 
121         public Tokenizer(Reader in) throws IOException {
122             this.in = in;
123             ch = in.read();
124         }
125 
126         public String nextToken() throws IOException {
</pre>
</td>
</tr>
</table>
<center><a href="Arguments.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="Main.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>