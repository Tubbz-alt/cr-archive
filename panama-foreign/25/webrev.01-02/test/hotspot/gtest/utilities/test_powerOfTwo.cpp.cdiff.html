<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/hotspot/gtest/utilities/test_powerOfTwo.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../gc/z/test_zForwarding.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../jtreg/compiler/jvmci/events/JvmciNotifyBootstrapFinishedEventTest.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/gtest/utilities/test_powerOfTwo.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 29,10 ***</span>
<span class="line-new-header">--- 29,44 ---</span>
  
  template &lt;typename T&gt; T max_pow2() {
    T max_val = max_value&lt;T&gt;();
    return max_val - (max_val &gt;&gt; 1);
  }
<span class="line-added">+ </span>
<span class="line-added">+ template &lt;typename T&gt; static void test_is_power_of_2() {</span>
<span class="line-added">+   EXPECT_FALSE(is_power_of_2(T(0)));</span>
<span class="line-added">+   EXPECT_FALSE(is_power_of_2(~T(0)));</span>
<span class="line-added">+ </span>
<span class="line-added">+   // Test true</span>
<span class="line-added">+   for (T i = max_pow2&lt;T&gt;(); i &gt; 0; i = (i &gt;&gt; 1)) {</span>
<span class="line-added">+     EXPECT_TRUE(is_power_of_2(i)) &lt;&lt; &quot;value = &quot; &lt;&lt; T(i);</span>
<span class="line-added">+   }</span>
<span class="line-added">+ </span>
<span class="line-added">+   // Test one less</span>
<span class="line-added">+   for (T i = max_pow2&lt;T&gt;(); i &gt; 2; i = (i &gt;&gt; 1)) {</span>
<span class="line-added">+     EXPECT_FALSE(is_power_of_2(i - 1)) &lt;&lt; &quot;value = &quot; &lt;&lt; T(i - 1);</span>
<span class="line-added">+   }</span>
<span class="line-added">+ </span>
<span class="line-added">+   // Test one more</span>
<span class="line-added">+   for (T i = max_pow2&lt;T&gt;(); i &gt; 1; i = (i &gt;&gt; 1)) {</span>
<span class="line-added">+     EXPECT_FALSE(is_power_of_2(i + 1)) &lt;&lt; &quot;value = &quot; &lt;&lt; T(i + 1);</span>
<span class="line-added">+   }</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ TEST(power_of_2, is_power_of_2) {</span>
<span class="line-added">+   test_is_power_of_2&lt;int8_t&gt;();</span>
<span class="line-added">+   test_is_power_of_2&lt;int16_t&gt;();</span>
<span class="line-added">+   test_is_power_of_2&lt;int32_t&gt;();</span>
<span class="line-added">+   test_is_power_of_2&lt;int64_t&gt;();</span>
<span class="line-added">+   test_is_power_of_2&lt;int8_t&gt;();</span>
<span class="line-added">+   test_is_power_of_2&lt;int16_t&gt;();</span>
<span class="line-added">+   test_is_power_of_2&lt;int32_t&gt;();</span>
<span class="line-added">+   test_is_power_of_2&lt;int64_t&gt;();</span>
<span class="line-added">+ </span>
<span class="line-added">+   test_is_power_of_2&lt;jint&gt;();</span>
<span class="line-added">+   test_is_power_of_2&lt;jlong&gt;();</span>
<span class="line-added">+ }</span>
  
  template &lt;typename T&gt; void round_up_power_of_2() {
    EXPECT_EQ(round_up_power_of_2(T(1)), T(1)) &lt;&lt; &quot;value = &quot; &lt;&lt; T(1);
    EXPECT_EQ(round_up_power_of_2(T(2)), T(2)) &lt;&lt; &quot;value = &quot; &lt;&lt; T(2);
    EXPECT_EQ(round_up_power_of_2(T(3)), T(4)) &lt;&lt; &quot;value = &quot; &lt;&lt; T(3);
</pre>
<center><a href="../gc/z/test_zForwarding.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../jtreg/compiler/jvmci/events/JvmciNotifyBootstrapFinishedEventTest.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>