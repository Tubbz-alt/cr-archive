<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/HtmlDocletWriter.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="HtmlDoclet.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="LinkFactoryImpl.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/HtmlDocletWriter.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 186      * To check whether the container annotations is documented or not.
 187      */
 188     private boolean isContainerDocumented = false;
 189 
 190     /**
 191      * The window title of this file.
 192      */
 193     protected String winTitle;
 194 
 195     protected Script mainBodyScript;
 196 
 197     /**
 198      * A table of the anchors used for at-index and related tags,
 199      * so that they can be made unique by appending a suitable suffix.
 200      * (Ideally, javadoc should be tracking all id&#39;s generated in a file
 201      * to avoid generating duplicates.)
 202      */
 203     Map&lt;String, Integer&gt; indexAnchorTable = new HashMap&lt;&gt;();
 204 
 205     /**
<span class="line-modified"> 206      * Constructor to construct the HtmlStandardWriter object.</span>
 207      *
 208      * @param configuration the configuration for this doclet
 209      * @param path the file to be generated.
 210      */
 211     public HtmlDocletWriter(HtmlConfiguration configuration, DocPath path) {
 212         this.configuration = configuration;
 213         this.options = configuration.getOptions();
 214         this.contents = configuration.contents;
 215         this.messages = configuration.messages;
 216         this.resources = configuration.docResources;
 217         this.links = new Links(path);
 218         this.utils = configuration.utils;
 219         this.path = path;
 220         this.pathToRoot = path.parent().invert();
 221         this.filename = path.basename();
 222         this.docPaths = configuration.docPaths;
 223         this.mainBodyScript = new Script();
 224 
 225         messages.notice(&quot;doclet.Generating_0&quot;,
 226             DocFile.createFileForOutput(configuration, path).getPath());
</pre>
<hr />
<pre>
1307         }
1308         return true;
1309     }
1310 
1311     // Notify the next DocTree handler to take necessary action
1312     private boolean commentRemoved = false;
1313 
1314     /**
1315      * Converts inline tags and text to Content, expanding the
1316      * inline tags along the way.  Called wherever text can contain
1317      * an inline tag, such as in comments or in free-form text arguments
1318      * to block tags.
1319      *
1320      * @param holderTag    specific tag where comment resides
1321      * @param element    specific element where comment resides
1322      * @param tags   array of text tags and inline tags (often alternating)
1323                present in the text of interest for this element
1324      * @param isFirstSentence  true if text is first sentence
1325      * @return a Content object
1326      */
<span class="line-modified">1327     public Content commentTagsToContent(DocTree holderTag, Element element,</span>
<span class="line-modified">1328             List&lt;? extends DocTree&gt; tags, boolean isFirstSentence) {</span>



1329         return commentTagsToContent(holderTag, element, tags, isFirstSentence, false);
1330     }
1331 
1332     /**
1333      * Converts inline tags and text to text strings, expanding the
1334      * inline tags along the way.  Called wherever text can contain
1335      * an inline tag, such as in comments or in free-form text arguments
1336      * to block tags.
1337      *
1338      * @param holderTag       specific tag where comment resides
1339      * @param element         specific element where comment resides
1340      * @param trees           array of text tags and inline tags (often alternating)
1341      *                        present in the text of interest for this element
1342      * @param isFirstSentence true if text is first sentence
1343      * @param inSummary       if the comment tags are added into the summary section
1344      * @return a Content object
1345      */
<span class="line-modified">1346     public Content commentTagsToContent(DocTree holderTag, Element element,</span>
<span class="line-modified">1347             List&lt;? extends DocTree&gt; trees, boolean isFirstSentence, boolean inSummary) {</span>
<span class="line-modified">1348 </span>



1349         final Content result = new ContentBuilder() {
1350             @Override
1351             public void add(CharSequence text) {
1352                 super.add(utils.normalizeNewlines(text));
1353             }
1354         };
1355         CommentHelper ch = utils.getCommentHelper(element);
1356         // Array of all possible inline tags for this javadoc run
1357         configuration.tagletManager.checkTags(element, trees, true);
1358         commentRemoved = false;
1359 
1360         for (ListIterator&lt;? extends DocTree&gt; iterator = trees.listIterator(); iterator.hasNext();) {
1361             boolean isFirstNode = !iterator.hasPrevious();
1362             DocTree tag = iterator.next();
1363             boolean isLastNode  = !iterator.hasNext();
1364 
1365             if (isFirstSentence) {
1366                 // Ignore block tags
1367                 if (ignoreNonInlineTag(tag))
1368                     continue;
</pre>
<hr />
<pre>
1392                             return htag != null &amp;&amp; htag.equals(com.sun.tools.doclint.HtmlTag.A);
1393                         }
1394                     }
1395                     return false;
1396                 }
1397 
1398                 @Override
1399                 public Boolean visitAttribute(AttributeTree node, Content c) {
1400                     StringBuilder sb = new StringBuilder(SPACER).append(node.getName());
1401                     if (node.getValueKind() == ValueKind.EMPTY) {
1402                         result.add(sb);
1403                         return false;
1404                     }
1405                     sb.append(&quot;=&quot;);
1406                     String quote;
1407                     switch (node.getValueKind()) {
1408                         case DOUBLE:
1409                             quote = &quot;\&quot;&quot;;
1410                             break;
1411                         case SINGLE:
<span class="line-modified">1412                             quote = &quot;\&#39;&quot;;</span>
1413                             break;
1414                         default:
1415                             quote = &quot;&quot;;
1416                             break;
1417                     }
1418                     sb.append(quote);
1419                     result.add(sb);
1420                     Content docRootContent = new ContentBuilder();
1421 
1422                     boolean isHRef = inAnAtag() &amp;&amp; node.getName().toString().equalsIgnoreCase(&quot;href&quot;);
1423                     for (DocTree dt : node.getValue()) {
1424                         if (utils.isText(dt) &amp;&amp; isHRef) {
1425                             String text = ((TextTree) dt).getBody();
1426                             if (text.startsWith(&quot;/..&quot;) &amp;&amp; !options.docrootParent().isEmpty()) {
1427                                 result.add(options.docrootParent());
1428                                 docRootContent = new ContentBuilder();
1429                                 result.add(textCleanup(text.substring(3), isLastNode));
1430                             } else {
1431                                 if (!docRootContent.isEmpty()) {
1432                                     docRootContent = copyDocRootContent(docRootContent);
</pre>
</td>
<td>
<hr />
<pre>
 186      * To check whether the container annotations is documented or not.
 187      */
 188     private boolean isContainerDocumented = false;
 189 
 190     /**
 191      * The window title of this file.
 192      */
 193     protected String winTitle;
 194 
 195     protected Script mainBodyScript;
 196 
 197     /**
 198      * A table of the anchors used for at-index and related tags,
 199      * so that they can be made unique by appending a suitable suffix.
 200      * (Ideally, javadoc should be tracking all id&#39;s generated in a file
 201      * to avoid generating duplicates.)
 202      */
 203     Map&lt;String, Integer&gt; indexAnchorTable = new HashMap&lt;&gt;();
 204 
 205     /**
<span class="line-modified"> 206      * Creates an {@code HtmlDocletWriter}.</span>
 207      *
 208      * @param configuration the configuration for this doclet
 209      * @param path the file to be generated.
 210      */
 211     public HtmlDocletWriter(HtmlConfiguration configuration, DocPath path) {
 212         this.configuration = configuration;
 213         this.options = configuration.getOptions();
 214         this.contents = configuration.contents;
 215         this.messages = configuration.messages;
 216         this.resources = configuration.docResources;
 217         this.links = new Links(path);
 218         this.utils = configuration.utils;
 219         this.path = path;
 220         this.pathToRoot = path.parent().invert();
 221         this.filename = path.basename();
 222         this.docPaths = configuration.docPaths;
 223         this.mainBodyScript = new Script();
 224 
 225         messages.notice(&quot;doclet.Generating_0&quot;,
 226             DocFile.createFileForOutput(configuration, path).getPath());
</pre>
<hr />
<pre>
1307         }
1308         return true;
1309     }
1310 
1311     // Notify the next DocTree handler to take necessary action
1312     private boolean commentRemoved = false;
1313 
1314     /**
1315      * Converts inline tags and text to Content, expanding the
1316      * inline tags along the way.  Called wherever text can contain
1317      * an inline tag, such as in comments or in free-form text arguments
1318      * to block tags.
1319      *
1320      * @param holderTag    specific tag where comment resides
1321      * @param element    specific element where comment resides
1322      * @param tags   array of text tags and inline tags (often alternating)
1323                present in the text of interest for this element
1324      * @param isFirstSentence  true if text is first sentence
1325      * @return a Content object
1326      */
<span class="line-modified">1327     public Content commentTagsToContent(DocTree holderTag,</span>
<span class="line-modified">1328                                         Element element,</span>
<span class="line-added">1329                                         List&lt;? extends DocTree&gt; tags,</span>
<span class="line-added">1330                                         boolean isFirstSentence)</span>
<span class="line-added">1331     {</span>
1332         return commentTagsToContent(holderTag, element, tags, isFirstSentence, false);
1333     }
1334 
1335     /**
1336      * Converts inline tags and text to text strings, expanding the
1337      * inline tags along the way.  Called wherever text can contain
1338      * an inline tag, such as in comments or in free-form text arguments
1339      * to block tags.
1340      *
1341      * @param holderTag       specific tag where comment resides
1342      * @param element         specific element where comment resides
1343      * @param trees           array of text tags and inline tags (often alternating)
1344      *                        present in the text of interest for this element
1345      * @param isFirstSentence true if text is first sentence
1346      * @param inSummary       if the comment tags are added into the summary section
1347      * @return a Content object
1348      */
<span class="line-modified">1349     public Content commentTagsToContent(DocTree holderTag,</span>
<span class="line-modified">1350                                         Element element,</span>
<span class="line-modified">1351                                         List&lt;? extends DocTree&gt; trees,</span>
<span class="line-added">1352                                         boolean isFirstSentence,</span>
<span class="line-added">1353                                         boolean inSummary)</span>
<span class="line-added">1354     {</span>
1355         final Content result = new ContentBuilder() {
1356             @Override
1357             public void add(CharSequence text) {
1358                 super.add(utils.normalizeNewlines(text));
1359             }
1360         };
1361         CommentHelper ch = utils.getCommentHelper(element);
1362         // Array of all possible inline tags for this javadoc run
1363         configuration.tagletManager.checkTags(element, trees, true);
1364         commentRemoved = false;
1365 
1366         for (ListIterator&lt;? extends DocTree&gt; iterator = trees.listIterator(); iterator.hasNext();) {
1367             boolean isFirstNode = !iterator.hasPrevious();
1368             DocTree tag = iterator.next();
1369             boolean isLastNode  = !iterator.hasNext();
1370 
1371             if (isFirstSentence) {
1372                 // Ignore block tags
1373                 if (ignoreNonInlineTag(tag))
1374                     continue;
</pre>
<hr />
<pre>
1398                             return htag != null &amp;&amp; htag.equals(com.sun.tools.doclint.HtmlTag.A);
1399                         }
1400                     }
1401                     return false;
1402                 }
1403 
1404                 @Override
1405                 public Boolean visitAttribute(AttributeTree node, Content c) {
1406                     StringBuilder sb = new StringBuilder(SPACER).append(node.getName());
1407                     if (node.getValueKind() == ValueKind.EMPTY) {
1408                         result.add(sb);
1409                         return false;
1410                     }
1411                     sb.append(&quot;=&quot;);
1412                     String quote;
1413                     switch (node.getValueKind()) {
1414                         case DOUBLE:
1415                             quote = &quot;\&quot;&quot;;
1416                             break;
1417                         case SINGLE:
<span class="line-modified">1418                             quote = &quot;&#39;&quot;;</span>
1419                             break;
1420                         default:
1421                             quote = &quot;&quot;;
1422                             break;
1423                     }
1424                     sb.append(quote);
1425                     result.add(sb);
1426                     Content docRootContent = new ContentBuilder();
1427 
1428                     boolean isHRef = inAnAtag() &amp;&amp; node.getName().toString().equalsIgnoreCase(&quot;href&quot;);
1429                     for (DocTree dt : node.getValue()) {
1430                         if (utils.isText(dt) &amp;&amp; isHRef) {
1431                             String text = ((TextTree) dt).getBody();
1432                             if (text.startsWith(&quot;/..&quot;) &amp;&amp; !options.docrootParent().isEmpty()) {
1433                                 result.add(options.docrootParent());
1434                                 docRootContent = new ContentBuilder();
1435                                 result.add(textCleanup(text.substring(3), isLastNode));
1436                             } else {
1437                                 if (!docRootContent.isEmpty()) {
1438                                     docRootContent = copyDocRootContent(docRootContent);
</pre>
</td>
</tr>
</table>
<center><a href="HtmlDoclet.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="LinkFactoryImpl.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>