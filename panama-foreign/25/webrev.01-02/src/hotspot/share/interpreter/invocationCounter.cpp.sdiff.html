<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/interpreter/invocationCounter.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../gc/z/zRelocationSetSelector.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../jfr/metadata/metadata.xml.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/interpreter/invocationCounter.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 71 }
 72 
 73 void InvocationCounter::decay() {
 74   update(count() &gt;&gt; 1);
 75 }
 76 
 77 void InvocationCounter::print() {
 78   uint counter = raw_counter();
 79   tty-&gt;print_cr(&quot;invocation count: up = %d, limit = %d, carry = %s&quot;,
 80                                    extract_count(counter), limit(),
 81                                    extract_carry(counter) ? &quot;true&quot; : &quot;false&quot;);
 82 }
 83 
 84 #ifdef CC_INTERP
 85 int                       InvocationCounter::InterpreterInvocationLimit;
 86 int                       InvocationCounter::InterpreterBackwardBranchLimit;
 87 #endif
 88 
 89 void invocationCounter_init() {
 90 #ifdef CC_INTERP
<span class="line-modified"> 91   InterpreterInvocationLimit = CompileThreshold &lt;&lt; number_of_noncount_bits;</span>

 92 
 93   // When methodData is collected, the backward branch limit is compared against a
 94   // methodData counter, rather than an InvocationCounter.  In the former case, we
 95   // don&#39;t need the shift by number_of_noncount_bits, but we do need to adjust
 96   // the factor by which we scale the threshold.
 97   if (ProfileInterpreter) {
<span class="line-modified"> 98     InterpreterBackwardBranchLimit = (int)((int64_t)CompileThreshold * (OnStackReplacePercentage - InterpreterProfilePercentage) / 100);</span>


 99   } else {
<span class="line-modified">100     InterpreterBackwardBranchLimit = (int)(((int64_t)CompileThreshold * OnStackReplacePercentage / 100) &lt;&lt; number_of_noncount_bits);</span>


101   }
102 
<span class="line-modified">103   assert(0 &lt;= InterpreterBackwardBranchLimit, &quot;OSR threshold should be non-negative&quot;);</span>

104 #endif
105 }
</pre>
</td>
<td>
<hr />
<pre>
 71 }
 72 
 73 void InvocationCounter::decay() {
 74   update(count() &gt;&gt; 1);
 75 }
 76 
 77 void InvocationCounter::print() {
 78   uint counter = raw_counter();
 79   tty-&gt;print_cr(&quot;invocation count: up = %d, limit = %d, carry = %s&quot;,
 80                                    extract_count(counter), limit(),
 81                                    extract_carry(counter) ? &quot;true&quot; : &quot;false&quot;);
 82 }
 83 
 84 #ifdef CC_INTERP
 85 int                       InvocationCounter::InterpreterInvocationLimit;
 86 int                       InvocationCounter::InterpreterBackwardBranchLimit;
 87 #endif
 88 
 89 void invocationCounter_init() {
 90 #ifdef CC_INTERP
<span class="line-modified"> 91   InvocationCounter::InterpreterInvocationLimit =</span>
<span class="line-added"> 92     CompileThreshold &lt;&lt; InvocationCounter::count_shift;</span>
 93 
 94   // When methodData is collected, the backward branch limit is compared against a
 95   // methodData counter, rather than an InvocationCounter.  In the former case, we
 96   // don&#39;t need the shift by number_of_noncount_bits, but we do need to adjust
 97   // the factor by which we scale the threshold.
 98   if (ProfileInterpreter) {
<span class="line-modified"> 99     InvocationCounter::InterpreterBackwardBranchLimit =</span>
<span class="line-added">100       (int)((int64_t)CompileThreshold</span>
<span class="line-added">101             * (OnStackReplacePercentage - InterpreterProfilePercentage) / 100);</span>
102   } else {
<span class="line-modified">103     InvocationCounter::InterpreterBackwardBranchLimit =</span>
<span class="line-added">104       (int)(((int64_t)CompileThreshold * OnStackReplacePercentage / 100)</span>
<span class="line-added">105             &lt;&lt; InvocationCounter::count_shift);</span>
106   }
107 
<span class="line-modified">108   assert(0 &lt;= InvocationCounter::InterpreterBackwardBranchLimit,</span>
<span class="line-added">109          &quot;OSR threshold should be non-negative&quot;);</span>
110 #endif
111 }
</pre>
</td>
</tr>
</table>
<center><a href="../gc/z/zRelocationSetSelector.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../jfr/metadata/metadata.xml.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>