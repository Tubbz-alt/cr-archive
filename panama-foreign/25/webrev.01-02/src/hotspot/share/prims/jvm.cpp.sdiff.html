<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/prims/jvm.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../opto/vectornode.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="jvmtiEnv.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/prims/jvm.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
3354   char ebuf[1024];
3355   void *load_result;
3356   {
3357     ThreadToNativeFromVM ttnfvm(thread);
3358     load_result = os::dll_load(name, ebuf, sizeof ebuf);
3359   }
3360   if (load_result == NULL) {
3361     char msg[1024];
3362     jio_snprintf(msg, sizeof msg, &quot;%s: %s&quot;, name, ebuf);
3363     // Since &#39;ebuf&#39; may contain a string encoded using
3364     // platform encoding scheme, we need to pass
3365     // Exceptions::unsafe_to_utf8 to the new_exception method
3366     // as the last argument. See bug 6367357.
3367     Handle h_exception =
3368       Exceptions::new_exception(thread,
3369                                 vmSymbols::java_lang_UnsatisfiedLinkError(),
3370                                 msg, Exceptions::unsafe_to_utf8);
3371 
3372     THROW_HANDLE_0(h_exception);
3373   }

3374   return load_result;
3375 JVM_END
3376 
3377 
3378 JVM_LEAF(void, JVM_UnloadLibrary(void* handle))
3379   JVMWrapper(&quot;JVM_UnloadLibrary&quot;);
3380   os::dll_unload(handle);

3381 JVM_END
3382 
3383 
3384 JVM_LEAF(void*, JVM_FindLibraryEntry(void* handle, const char* name))
3385   JVMWrapper(&quot;JVM_FindLibraryEntry&quot;);
<span class="line-modified">3386   return os::dll_lookup(handle, name);</span>




3387 JVM_END
3388 
3389 
3390 // JNI version ///////////////////////////////////////////////////////////////////////////////
3391 
3392 JVM_LEAF(jboolean, JVM_IsSupportedJNIVersion(jint version))
3393   JVMWrapper(&quot;JVM_IsSupportedJNIVersion&quot;);
3394   return Threads::is_supported_jni_version_including_1_1(version);
3395 JVM_END
3396 
3397 
3398 // String support ///////////////////////////////////////////////////////////////////////////
3399 
3400 JVM_ENTRY(jstring, JVM_InternString(JNIEnv *env, jstring str))
3401   JVMWrapper(&quot;JVM_InternString&quot;);
3402   JvmtiVMObjectAllocEventCollector oam;
3403   if (str == NULL) return NULL;
3404   oop string = JNIHandles::resolve_non_null(str);
3405   oop result = StringTable::intern(string, CHECK_NULL);
3406   return (jstring) JNIHandles::make_local(env, result);
</pre>
</td>
<td>
<hr />
<pre>
3354   char ebuf[1024];
3355   void *load_result;
3356   {
3357     ThreadToNativeFromVM ttnfvm(thread);
3358     load_result = os::dll_load(name, ebuf, sizeof ebuf);
3359   }
3360   if (load_result == NULL) {
3361     char msg[1024];
3362     jio_snprintf(msg, sizeof msg, &quot;%s: %s&quot;, name, ebuf);
3363     // Since &#39;ebuf&#39; may contain a string encoded using
3364     // platform encoding scheme, we need to pass
3365     // Exceptions::unsafe_to_utf8 to the new_exception method
3366     // as the last argument. See bug 6367357.
3367     Handle h_exception =
3368       Exceptions::new_exception(thread,
3369                                 vmSymbols::java_lang_UnsatisfiedLinkError(),
3370                                 msg, Exceptions::unsafe_to_utf8);
3371 
3372     THROW_HANDLE_0(h_exception);
3373   }
<span class="line-added">3374   log_info(library)(&quot;Loaded library %s, handle &quot; INTPTR_FORMAT, name, p2i(load_result));</span>
3375   return load_result;
3376 JVM_END
3377 
3378 
3379 JVM_LEAF(void, JVM_UnloadLibrary(void* handle))
3380   JVMWrapper(&quot;JVM_UnloadLibrary&quot;);
3381   os::dll_unload(handle);
<span class="line-added">3382   log_info(library)(&quot;Unloaded library with handle &quot; INTPTR_FORMAT, p2i(handle));</span>
3383 JVM_END
3384 
3385 
3386 JVM_LEAF(void*, JVM_FindLibraryEntry(void* handle, const char* name))
3387   JVMWrapper(&quot;JVM_FindLibraryEntry&quot;);
<span class="line-modified">3388   void* find_result = os::dll_lookup(handle, name);</span>
<span class="line-added">3389   log_info(library)(&quot;%s %s in library with handle &quot; INTPTR_FORMAT,</span>
<span class="line-added">3390                     find_result != NULL ? &quot;Found&quot; : &quot;Failed to find&quot;,</span>
<span class="line-added">3391                     name, p2i(handle));</span>
<span class="line-added">3392   return find_result;</span>
3393 JVM_END
3394 
3395 
3396 // JNI version ///////////////////////////////////////////////////////////////////////////////
3397 
3398 JVM_LEAF(jboolean, JVM_IsSupportedJNIVersion(jint version))
3399   JVMWrapper(&quot;JVM_IsSupportedJNIVersion&quot;);
3400   return Threads::is_supported_jni_version_including_1_1(version);
3401 JVM_END
3402 
3403 
3404 // String support ///////////////////////////////////////////////////////////////////////////
3405 
3406 JVM_ENTRY(jstring, JVM_InternString(JNIEnv *env, jstring str))
3407   JVMWrapper(&quot;JVM_InternString&quot;);
3408   JvmtiVMObjectAllocEventCollector oam;
3409   if (str == NULL) return NULL;
3410   oop string = JNIHandles::resolve_non_null(str);
3411   oop result = StringTable::intern(string, CHECK_NULL);
3412   return (jstring) JNIHandles::make_local(env, result);
</pre>
</td>
</tr>
</table>
<center><a href="../opto/vectornode.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="jvmtiEnv.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>