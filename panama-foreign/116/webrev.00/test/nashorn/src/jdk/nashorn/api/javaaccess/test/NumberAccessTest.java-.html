<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old test/nashorn/src/jdk/nashorn/api/javaaccess/test/NumberAccessTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2010, 2013, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package jdk.nashorn.api.javaaccess.test;
 27 
 28 import static org.testng.AssertJUnit.assertEquals;
 29 import static org.testng.AssertJUnit.assertTrue;
 30 import static org.testng.internal.junit.ArrayAsserts.assertArrayEquals;
 31 import javax.script.ScriptEngine;
 32 import javax.script.ScriptEngineManager;
 33 import javax.script.ScriptException;
 34 import org.testng.TestNG;
 35 import org.testng.annotations.AfterClass;
 36 import org.testng.annotations.BeforeClass;
 37 import org.testng.annotations.Test;
 38 
 39 /**
 40  * @test
 41  * @build jdk.nashorn.api.javaaccess.test.SharedObject jdk.nashorn.api.javaaccess.test.Person jdk.nashorn.api.javaaccess.test.NumberAccessTest
 42  * @run testng/othervm jdk.nashorn.api.javaaccess.test.NumberAccessTest
 43  */
 44 @SuppressWarnings(&quot;javadoc&quot;)
 45 public class NumberAccessTest {
 46 
 47     private static ScriptEngine e;
 48     private static SharedObject o;
 49 
 50     public static void main(final String[] args) {
 51         TestNG.main(args);
 52     }
 53 
 54     @BeforeClass
 55     public static void setUpClass() throws ScriptException {
 56         final ScriptEngineManager m = new ScriptEngineManager();
 57         e = m.getEngineByName(&quot;nashorn&quot;);
 58         o = new SharedObject();
 59         e.put(&quot;o&quot;, o);
 60         e.eval(&quot;var SharedObject = Packages.jdk.nashorn.api.javaaccess.test.SharedObject;&quot;);
 61     }
 62 
 63     @AfterClass
 64     public static void tearDownClass() {
 65         e = null;
 66         o = null;
 67     }
 68 
 69     // --------------------------------long
 70     // tests------------------------------------
 71     @Test
 72     public void accessFieldLong() throws ScriptException {
 73         e.eval(&quot;var p_long = o.publicLong;&quot;);
 74         assertEquals(o.publicLong, e.get(&quot;p_long&quot;));
 75         e.eval(&quot;o.publicLong = 12;&quot;);
 76         assertEquals(12, o.publicLong);
 77     }
 78 
 79     @Test
 80     public void accessFieldLongArray() throws ScriptException {
 81         e.eval(&quot;var p_long_array = o.publicLongArray;&quot;);
 82         assertEquals(o.publicLongArray[0], e.eval(&quot;o.publicLongArray[0];&quot;));
 83         assertArrayEquals(o.publicLongArray, (long[])e.get(&quot;p_long_array&quot;));
 84         e.eval(&quot;var t_long_arr = new (Java.type(\&quot;long[]\&quot;))(3);&quot; +
 85                 &quot;t_long_arr[0] = -189009;&quot; +
 86                 &quot;t_long_arr[1] = 456;&quot; +
 87                 &quot;t_long_arr[2] = 600000001;&quot; +
 88                 &quot;o.publicLongArray = t_long_arr;&quot;);
 89         // e.eval(&quot;o.publicIntArray = [-189009,456,600000001];&quot;);
 90         assertArrayEquals(new long[] { -189009, 456, 600000001 }, o.publicLongArray);
 91         e.eval(&quot;o.publicLongArray[0] = 10;&quot;);
 92         assertEquals(10, o.publicLongArray[0]);
 93     }
 94 
 95     @Test
 96     public void accessStaticFieldLong() throws ScriptException {
 97         e.eval(&quot;var ps_long = SharedObject.publicStaticLong;&quot;);
 98         assertEquals(SharedObject.publicStaticLong, e.get(&quot;ps_long&quot;));
 99         e.eval(&quot;SharedObject.publicStaticLong = 120;&quot;);
100         assertEquals(120, SharedObject.publicStaticLong);
101     }
102 
103     @Test
104     public void accessStaticFieldLongArray() throws ScriptException {
105         e.eval(&quot;var ps_long_array = SharedObject.publicStaticLongArray;&quot;);
106         assertEquals(SharedObject.publicStaticLongArray[0], e.eval(&quot;SharedObject.publicStaticLongArray[0];&quot;));
107         assertArrayEquals(SharedObject.publicStaticLongArray, (long[])e.get(&quot;ps_long_array&quot;));
108         e.eval(&quot;var ts_long_arr = new (Java.type(\&quot;long[]\&quot;))(3);&quot; +
109                 &quot;ts_long_arr[0] = -189009;&quot; +
110                 &quot;ts_long_arr[1] = 456;&quot; +
111                 &quot;ts_long_arr[2] = 600000001;&quot; +
112                 &quot;SharedObject.publicStaticLongArray = ts_long_arr;&quot;);
113         // e.eval(&quot;o.publicIntArray = [-189009,456,600000001];&quot;);
114         assertArrayEquals(new long[] { -189009, 456, 600000001 }, SharedObject.publicStaticLongArray);
115         e.eval(&quot;SharedObject.publicStaticLongArray[0] = 10;&quot;);
116         assertEquals(10, SharedObject.publicStaticLongArray[0]);
117     }
118 
119     @Test
120     public void accessFinalFieldLong() throws ScriptException {
121         e.eval(&quot;var pf_long = o.publicFinalLong;&quot;);
122         assertEquals(o.publicFinalLong, e.get(&quot;pf_long&quot;));
123         e.eval(&quot;o.publicFinalLong = 120;&quot;);
124         assertEquals(13353333333333333L, o.publicFinalLong);
125     }
126 
127     @Test
128     public void accessFinalFieldLongArray() throws ScriptException {
129         e.eval(&quot;var pf_long_array = o.publicFinalLongArray;&quot;);
130         assertEquals(o.publicFinalLongArray[0], e.eval(&quot;o.publicFinalLongArray[0];&quot;));
131         assertArrayEquals(o.publicFinalLongArray, (long[])e.get(&quot;pf_long_array&quot;));
132         e.eval(&quot;var tf_long_arr = new (Java.type(\&quot;long[]\&quot;))(3);&quot; +
133                 &quot;tf_long_arr[0] = -189009;&quot; +
134                 &quot;tf_long_arr[1] = 456;&quot; +
135                 &quot;tf_long_arr[2] = 600000001;&quot; +
136                 &quot;o.publicFinalLongArray = tf_long_arr;&quot;);
137         // e.eval(&quot;o.publicIntArray = [-189009,456,600000001];&quot;);
138         assertArrayEquals(new long[] { 1901733333333L, -2247355555L, 3977377777L }, o.publicFinalLongArray);
139         e.eval(&quot;o.publicFinalLongArray[0] = 10;&quot;);
140         assertEquals(10, o.publicFinalLongArray[0]);
141     }
142 
143     @Test
144     public void accessStaticFinalFieldLong() throws ScriptException {
145         e.eval(&quot;var psf_long = SharedObject.publicStaticFinalLong;&quot;);
146         assertEquals(SharedObject.publicStaticFinalLong, ((Number) e.get(&quot;psf_long&quot;)).longValue());
147         e.eval(&quot;SharedObject.publicStaticFinalLong = 120;&quot;);
148         assertEquals(8333333333333L, SharedObject.publicStaticFinalLong);
149     }
150 
151     @Test
152     public void accessStaticFinalFieldLongArray() throws ScriptException {
153         e.eval(&quot;var psf_long_array = SharedObject.publicStaticFinalLongArray;&quot;);
154         assertEquals(SharedObject.publicStaticFinalLongArray[0], e.eval(&quot;SharedObject.publicStaticFinalLongArray[0];&quot;));
155         assertArrayEquals(SharedObject.publicStaticFinalLongArray, (long[])e.get(&quot;psf_long_array&quot;));
156         e.eval(&quot;var tsf_long_arr = new (Java.type(\&quot;long[]\&quot;))(3);&quot; +
157                 &quot;tsf_long_arr[0] = -189009;&quot; +
158                 &quot;tsf_long_arr[1] = 456;&quot; +
159                 &quot;tsf_long_arr[2] = 600000001;&quot; +
160                 &quot;SharedObject.publicStaticFinalLongArray = tsf_long_arr;&quot;);
161         // e.eval(&quot;o.publicIntArray = [-189009,456,600000001];&quot;);
162         assertArrayEquals(new long[] { 19017383333L, -2247358L, 39773787L }, SharedObject.publicStaticFinalLongArray);
163         e.eval(&quot;SharedObject.publicStaticFinalLongArray[0] = 10;&quot;);
164         assertEquals(10, SharedObject.publicStaticFinalLongArray[0]);
165     }
166 
167     // --------------------------------int
168     // tests------------------------------------
169     @Test
170     public void accessFieldInt() throws ScriptException {
171         e.eval(&quot;var p_int = o.publicInt;&quot;);
172         assertEquals(o.publicInt, e.get(&quot;p_int&quot;));
173         e.eval(&quot;o.publicInt = 14;&quot;);
174         assertEquals(14, o.publicInt);
175     }
176 
177     @Test
178     public void accessFieldIntArray() throws ScriptException {
179         e.eval(&quot;var p_int_array = o.publicIntArray;&quot;);
180         assertEquals(o.publicIntArray[0], e.eval(&quot;o.publicIntArray[0];&quot;));
181         assertArrayEquals(o.publicIntArray, (int[])e.get(&quot;p_int_array&quot;));
182         e.eval(&quot;var t_int_arr = new (Java.type(\&quot;int[]\&quot;))(3);&quot; +
183                 &quot;t_int_arr[0] = 4;&quot; +
184                 &quot;t_int_arr[1] = 5;&quot; +
185                 &quot;t_int_arr[2] = 6;&quot; +
186                 &quot;o.publicIntArray = t_int_arr;&quot;);
187         assertArrayEquals(new int[] { 4, 5, 6 }, o.publicIntArray);
188         e.eval(&quot;o.publicIntArray[0] = 100;&quot;);
189         assertEquals(100, o.publicIntArray[0]);
190     }
191 
192     @Test
193     public void accessStaticFieldInt() throws ScriptException {
194         e.eval(&quot;var ps_int = SharedObject.publicStaticInt;&quot;);
195         assertEquals(SharedObject.publicStaticInt, e.get(&quot;ps_int&quot;));
196         e.eval(&quot;SharedObject.publicStaticInt = 140;&quot;);
197         assertEquals(140, SharedObject.publicStaticInt);
198     }
199 
200     @Test
201     public void accessStaticFieldIntArray() throws ScriptException {
202         e.eval(&quot;var ps_int_array = SharedObject.publicStaticIntArray;&quot;);
203         assertEquals(SharedObject.publicStaticIntArray[0], e.eval(&quot;SharedObject.publicStaticIntArray[0];&quot;));
204         assertArrayEquals(SharedObject.publicStaticIntArray, (int[])e.get(&quot;ps_int_array&quot;));
205         e.eval(&quot;var ts_int_arr = new (Java.type(\&quot;int[]\&quot;))(3);&quot; +
206                 &quot;ts_int_arr[0] = 4;&quot; +
207                 &quot;ts_int_arr[1] = 5;&quot; +
208                 &quot;ts_int_arr[2] = 6;&quot; +
209                 &quot;SharedObject.publicStaticIntArray = ts_int_arr;&quot;);
210         assertArrayEquals(new int[] { 4, 5, 6 }, SharedObject.publicStaticIntArray);
211         e.eval(&quot;SharedObject.publicStaticIntArray[0] = 100;&quot;);
212         assertEquals(100, SharedObject.publicStaticIntArray[0]);
213     }
214 
215     @Test
216     public void accessFinalFieldInt() throws ScriptException {
217         e.eval(&quot;var pf_int = o.publicFinalInt;&quot;);
218         assertEquals(o.publicFinalInt, e.get(&quot;pf_int&quot;));
219 
220         e.eval(&quot;o.publicFinalInt = 10;&quot;);
221         assertEquals(20712023, o.publicFinalInt);
222     }
223 
224     @Test
225     public void accessFinalFieldIntArray() throws ScriptException {
226         e.eval(&quot;var pf_int_array = o.publicFinalIntArray;&quot;);
227         assertEquals(o.publicFinalIntArray[0], e.eval(&quot;o.publicFinalIntArray[0];&quot;));
228         assertArrayEquals(o.publicFinalIntArray, (int[])e.get(&quot;pf_int_array&quot;));
229         e.eval(&quot;var tf_int_arr = new (Java.type(\&quot;int[]\&quot;))(3);&quot; +
230                 &quot;tf_int_arr[0] = 4;&quot; +
231                 &quot;tf_int_arr[1] = 5;&quot; +
232                 &quot;tf_int_arr[2] = 6;&quot; +
233                 &quot;o.publicFinalIntArray = tf_int_arr;&quot;);
234         assertArrayEquals(new int[] { 50, 80, 130, 210, 340 }, o.publicFinalIntArray);
235         e.eval(&quot;o.publicFinalIntArray[0] = 100;&quot;);
236         assertEquals(100, o.publicFinalIntArray[0]);
237     }
238 
239     @Test
240     public void accessStaticFinalFieldInt() throws ScriptException {
241         e.eval(&quot;var psf_int = SharedObject.publicStaticFinalInt;&quot;);
242         assertEquals(SharedObject.publicStaticFinalInt, e.get(&quot;psf_int&quot;));
243         e.eval(&quot;SharedObject.publicStaticFinalInt = 140;&quot;);
244         assertEquals(207182023, SharedObject.publicStaticFinalInt);
245     }
246 
247     @Test
248     public void accessStaticFinalFieldIntArray() throws ScriptException {
249         e.eval(&quot;var psf_int_array = SharedObject.publicStaticFinalIntArray;&quot;);
250         assertEquals(SharedObject.publicStaticFinalIntArray[0], e.eval(&quot;SharedObject.publicStaticFinalIntArray[0];&quot;));
251         assertArrayEquals(SharedObject.publicStaticFinalIntArray, (int[])e.get(&quot;psf_int_array&quot;));
252         e.eval(&quot;var tsf_int_arr = new (Java.type(\&quot;int[]\&quot;))(3);&quot; +
253                 &quot;tsf_int_arr[0] = 4;&quot; +
254                 &quot;tsf_int_arr[1] = 5;&quot; +
255                 &quot;tsf_int_arr[2] = 6;&quot; +
256                 &quot;SharedObject.publicStaticFinalIntArray = tsf_int_arr;&quot;);
257         assertArrayEquals(new int[] { 1308, 210, 340 }, SharedObject.publicStaticFinalIntArray);
258         e.eval(&quot;SharedObject.publicStaticFinalIntArray[0] = 100;&quot;);
259         assertEquals(100, SharedObject.publicStaticFinalIntArray[0]);
260     }
261 
262     // --------------------------------byte
263     // tests------------------------------------
264     @Test
265     public void accessFieldByte() throws ScriptException {
266         e.eval(&quot;var p_byte = o.publicByte;&quot;);
267         assertEquals((double)o.publicByte, ((Number)e.get(&quot;p_byte&quot;)).doubleValue());
268         e.eval(&quot;o.publicByte = 16;&quot;);
269         assertEquals(16, o.publicByte);
270     }
271 
272     @Test
273     public void accessFieldByteArray() throws ScriptException {
274         e.eval(&quot;var p_byte_array = o.publicByteArray;&quot;);
275         assertEquals(o.publicByteArray[0], e.eval(&quot;o.publicByteArray[0];&quot;));
276         assertArrayEquals(o.publicByteArray, (byte[])e.get(&quot;p_byte_array&quot;));
277         e.eval(&quot;var t_byte_arr = new (Java.type(\&quot;byte[]\&quot;))(3);&quot; +
278                 &quot;t_byte_arr[0] = -18;&quot; +
279                 &quot;t_byte_arr[1] = 56;&quot; +
280                 &quot;t_byte_arr[2] = 60;&quot; +
281                 &quot;o.publicByteArray = t_byte_arr;&quot;);
282         assertArrayEquals(new byte[] { -18, 56, 60 }, o.publicByteArray);
283         e.eval(&quot;o.publicByteArray[0] = 100;&quot;);
284         assertEquals(100, o.publicByteArray[0]);
285     }
286 
287     @Test
288     public void accessStaticFieldByte() throws ScriptException {
289         e.eval(&quot;var ps_byte = SharedObject.publicStaticByte;&quot;);
290         assertEquals((double)SharedObject.publicStaticByte, ((Number)e.get(&quot;ps_byte&quot;)).doubleValue());
291         e.eval(&quot;SharedObject.publicStaticByte = 16;&quot;);
292         assertEquals(16, SharedObject.publicStaticByte);
293     }
294 
295     @Test
296     public void accessStaticFieldByteArray() throws ScriptException {
297         e.eval(&quot;var ps_byte_array = SharedObject.publicStaticByteArray;&quot;);
298         assertEquals(SharedObject.publicStaticByteArray[0], e.eval(&quot;SharedObject.publicStaticByteArray[0];&quot;));
299         assertArrayEquals(SharedObject.publicStaticByteArray, (byte[])e.get(&quot;ps_byte_array&quot;));
300         e.eval(&quot;var ts_byte_arr = new (Java.type(\&quot;byte[]\&quot;))(3);&quot; +
301                 &quot;ts_byte_arr[0] = -18;&quot; +
302                 &quot;ts_byte_arr[1] = 56;&quot; +
303                 &quot;ts_byte_arr[2] = 60;&quot; +
304                 &quot;SharedObject.publicStaticByteArray = ts_byte_arr;&quot;);
305         assertArrayEquals(new byte[] { -18, 56, 60 }, SharedObject.publicStaticByteArray);
306         e.eval(&quot;SharedObject.publicStaticByteArray[0] = -90;&quot;);
307         assertEquals(-90, SharedObject.publicStaticByteArray[0]);
308     }
309 
310     @Test
311     public void accessFinalFieldByte() throws ScriptException {
312         e.eval(&quot;var pf_byte = o.publicFinalByte;&quot;);
313         assertEquals((double)o.publicFinalByte, ((Number)e.get(&quot;pf_byte&quot;)).doubleValue());
314         e.eval(&quot;o.publicFinalByte = 16;&quot;);
315         assertEquals(-7, o.publicFinalByte);
316     }
317 
318     @Test
319     public void accessFinalFieldByteArray() throws ScriptException {
320         e.eval(&quot;var pf_byte_array = o.publicFinalByteArray;&quot;);
321         assertEquals(o.publicFinalByteArray[0], e.eval(&quot;o.publicFinalByteArray[0];&quot;));
322         assertArrayEquals(o.publicFinalByteArray, (byte[])e.get(&quot;pf_byte_array&quot;));
323         e.eval(&quot;var tf_byte_arr = new (Java.type(\&quot;byte[]\&quot;))(3);&quot; +
324                 &quot;tf_byte_arr[0] = -18;&quot; +
325                 &quot;tf_byte_arr[1] = 56;&quot; +
326                 &quot;tf_byte_arr[2] = 60;&quot; +
327                 &quot;o.publicFinalByteArray = tf_byte_arr;&quot;);
328         assertArrayEquals(new byte[] { 1, 3, 6, 17, -128 }, o.publicFinalByteArray);
329         e.eval(&quot;o.publicFinalByteArray[0] = -90;&quot;);
330         assertEquals(-90, o.publicFinalByteArray[0]);
331     }
332 
333     @Test
334     public void accessStaticFinalFieldByte() throws ScriptException {
335         e.eval(&quot;var psf_byte = SharedObject.publicStaticFinalByte;&quot;);
336         assertEquals((double)SharedObject.publicStaticFinalByte, ((Number)e.get(&quot;psf_byte&quot;)).doubleValue());
337         e.eval(&quot;SharedObject.publicStaticFinalByte = 16;&quot;);
338         assertEquals(-70, SharedObject.publicStaticFinalByte);
339     }
340 
341     @Test
342     public void accessStaticFinalFieldByteArray() throws ScriptException {
343         e.eval(&quot;var psf_byte_array = SharedObject.publicStaticFinalByteArray;&quot;);
344         assertEquals(SharedObject.publicStaticFinalByteArray[0], e.eval(&quot;SharedObject.publicStaticFinalByteArray[0];&quot;));
345         assertArrayEquals(SharedObject.publicStaticFinalByteArray, (byte[])e.get(&quot;psf_byte_array&quot;));
346         e.eval(&quot;var tsf_byte_arr = new (Java.type(\&quot;byte[]\&quot;))(3);&quot; +
347                 &quot;tsf_byte_arr[0] = -18;&quot; +
348                 &quot;tsf_byte_arr[1] = 56;&quot; +
349                 &quot;tsf_byte_arr[2] = 60;&quot; +
350                 &quot;SharedObject.publicStaticFinalByteArray = tsf_byte_arr;&quot;);
351         assertArrayEquals(new byte[] { 17, -128, 81 }, SharedObject.publicStaticFinalByteArray);
352         e.eval(&quot;SharedObject.publicStaticFinalByteArray[0] = -90;&quot;);
353         assertEquals(-90, SharedObject.publicStaticFinalByteArray[0]);
354     }
355 
356     // --------------------------------short
357     // tests------------------------------------
358     @Test
359     public void accessFieldShort() throws ScriptException {
360         e.eval(&quot;var p_short = o.publicShort;&quot;);
361         assertEquals((double)o.publicShort, ((Number)e.get(&quot;p_short&quot;)).doubleValue());
362         e.eval(&quot;o.publicShort = 18;&quot;);
363         assertEquals(18, o.publicShort);
364     }
365 
366     @Test
367     public void accessFieldShortArray() throws ScriptException {
368         e.eval(&quot;var p_short_array = o.publicShortArray;&quot;);
369         assertEquals(o.publicShortArray[0], e.eval(&quot;o.publicShortArray[0];&quot;));
370         assertArrayEquals(o.publicShortArray, (short[])e.get(&quot;p_short_array&quot;));
371         e.eval(&quot;var t_short_arr = new (Java.type(\&quot;short[]\&quot;))(3);&quot; +
372                 &quot;t_short_arr[0] = 90;&quot; +
373                 &quot;t_short_arr[1] = 5;&quot; +
374                 &quot;t_short_arr[2] = -6000;&quot; +
375                 &quot;o.publicShortArray = t_short_arr;&quot;);
376         assertArrayEquals(new short[] { 90, 5, -6000 }, o.publicShortArray);
377         e.eval(&quot;o.publicShortArray[0] = -1000;&quot;);
378         assertEquals(-1000, o.publicShortArray[0]);
379     }
380 
381     @Test
382     public void accessStaticFieldShort() throws ScriptException {
383         e.eval(&quot;var ps_short = SharedObject.publicStaticShort;&quot;);
384         assertEquals((double)SharedObject.publicStaticShort, ((Number)e.get(&quot;ps_short&quot;)).doubleValue());
385         e.eval(&quot;SharedObject.publicStaticShort = 180;&quot;);
386         assertEquals(180, SharedObject.publicStaticShort);
387     }
388 
389     @Test
390     public void accessStaticFieldShortArray() throws ScriptException {
391         e.eval(&quot;var ps_short_array = SharedObject.publicStaticShortArray;&quot;);
392         assertEquals(SharedObject.publicStaticShortArray[0], e.eval(&quot;SharedObject.publicStaticShortArray[0];&quot;));
393         assertArrayEquals(SharedObject.publicStaticShortArray, (short[])e.get(&quot;ps_short_array&quot;));
394         e.eval(&quot;var ts_short_arr = new (Java.type(\&quot;short[]\&quot;))(3);&quot; +
395                 &quot;ts_short_arr[0] = 90;&quot; +
396                 &quot;ts_short_arr[1] = 5;&quot; +
397                 &quot;ts_short_arr[2] = -6000;&quot; +
398                 &quot;SharedObject.publicStaticShortArray = ts_short_arr;&quot;);
399         assertArrayEquals(new short[] { 90, 5, -6000 }, SharedObject.publicStaticShortArray);
400         e.eval(&quot;SharedObject.publicStaticShortArray[0] = -1000;&quot;);
401         assertEquals(-1000, SharedObject.publicStaticShortArray[0]);
402     }
403 
404     @Test
405     public void accessFinalFieldShort() throws ScriptException {
406         e.eval(&quot;var pf_short = o.publicFinalShort;&quot;);
407         assertEquals((double)o.publicFinalShort, ((Number)e.get(&quot;pf_short&quot;)).doubleValue());
408         e.eval(&quot;o.publicFinalShort = 180;&quot;);
409         assertEquals(31220, o.publicFinalShort);
410     }
411 
412     @Test
413     public void accessFinalFieldShortArray() throws ScriptException {
414         e.eval(&quot;var pf_short_array = o.publicFinalShortArray;&quot;);
415         assertEquals(o.publicFinalShortArray[0], e.eval(&quot;o.publicFinalShortArray[0];&quot;));
416         assertArrayEquals(o.publicFinalShortArray, (short[])e.get(&quot;pf_short_array&quot;));
417         e.eval(&quot;var tf_short_arr = new (Java.type(\&quot;short[]\&quot;))(3);&quot; +
418                 &quot;tf_short_arr[0] = 90;&quot; +
419                 &quot;tf_short_arr[1] = 5;&quot; +
420                 &quot;tf_short_arr[2] = -6000;&quot; +
421                 &quot;o.publicFinalShortArray = tf_short_arr;&quot;);
422         assertArrayEquals(new short[] { 12240, 9200, -17289, 1200, 12 }, o.publicFinalShortArray);
423         e.eval(&quot;o.publicFinalShortArray[0] = -1000;&quot;);
424         assertEquals(-1000, o.publicFinalShortArray[0]);
425     }
426 
427     @Test
428     public void accessStaticFinalFieldShort() throws ScriptException {
429         e.eval(&quot;var psf_short = SharedObject.publicStaticFinalShort;&quot;);
430         assertEquals((double)SharedObject.publicStaticFinalShort, ((Number)e.get(&quot;psf_short&quot;)).doubleValue());
431         e.eval(&quot;SharedObject.publicStaticFinalShort = 180;&quot;);
432         assertEquals(8888, SharedObject.publicStaticFinalShort);
433     }
434 
435     @Test
436     public void accessStaticFinalFieldShortArray() throws ScriptException {
437         e.eval(&quot;var psf_short_array = SharedObject.publicStaticFinalShortArray;&quot;);
438         assertEquals(SharedObject.publicStaticFinalShortArray[0], e.eval(&quot;SharedObject.publicStaticFinalShortArray[0];&quot;));
439         assertArrayEquals(SharedObject.publicStaticFinalShortArray, (short[])e.get(&quot;psf_short_array&quot;));
440         e.eval(&quot;var tsf_short_arr = new (Java.type(\&quot;short[]\&quot;))(3);&quot; +
441                 &quot;tsf_short_arr[0] = 90;&quot; +
442                 &quot;tsf_short_arr[1] = 5;&quot; +
443                 &quot;tsf_short_arr[2] = -6000;&quot; +
444                 &quot;SharedObject.publicStaticFinalShortArray = tsf_short_arr;&quot;);
445         assertArrayEquals(new short[] { 8240, 9280, -1289, 120, 812 }, SharedObject.publicStaticFinalShortArray);
446         e.eval(&quot;SharedObject.publicStaticFinalShortArray[0] = -1000;&quot;);
447         assertEquals(-1000, SharedObject.publicStaticFinalShortArray[0]);
448     }
449 
450     // --------------------------------char
451     // tests------------------------------------
452     @Test
453     public void accessFieldChar() throws ScriptException {
454         e.eval(&quot;var p_char = o.publicChar;&quot;);
455         assertEquals(o.publicChar, e.get(&quot;p_char&quot;));
456         e.eval(&quot;o.publicChar = &#39;S&#39;;&quot;);
457         assertEquals(&#39;S&#39;, o.publicChar);
458         e.eval(&quot;o.publicChar = 10;&quot;);
459         assertEquals(10, o.publicChar);
460         e.eval(&quot;try {&quot;
461                 + &quot;    o.publicChar = &#39;Big string&#39;;&quot; +
462                 &quot;} catch(e) {&quot; +
463                 &quot;    var isThrown = true;&quot; +
464                 &quot;}&quot;);
465         assertEquals(&quot;Exception thrown&quot;, true, e.get(&quot;isThrown&quot;));
466         assertEquals(10, o.publicChar);
467     }
468 
469     @Test
470     public void accessFieldCharArray() throws ScriptException {
471         e.eval(&quot;var p_char_array = o.publicCharArray;&quot;);
472         assertEquals(o.publicCharArray[0], e.eval(&quot;o.publicCharArray[0];&quot;));
473         assertArrayEquals(o.publicCharArray, (char[])e.get(&quot;p_char_array&quot;));
474         e.eval(&quot;var t_char_arr = new (Java.type(\&quot;char[]\&quot;))(3);&quot; +
475                 &quot;t_char_arr[0] = &#39;F&#39;;&quot; +
476                 &quot;t_char_arr[1] = &#39;o&#39;;&quot; +
477                 &quot;t_char_arr[2] = &#39;o&#39;;&quot; +
478                 &quot;o.publicCharArray = t_char_arr;&quot;);
479         assertArrayEquals(&quot;Foo&quot;.toCharArray(), o.publicCharArray);
480         e.eval(&quot;o.publicCharArray[0] = &#39;Z&#39;;&quot;);
481         assertEquals(&#39;Z&#39;, o.publicCharArray[0]);
482     }
483 
484     @Test
485     public void accessStaticFieldChar() throws ScriptException {
486         e.eval(&quot;var ps_char = SharedObject.publicStaticChar;&quot;);
487         assertEquals(SharedObject.publicStaticChar, e.get(&quot;ps_char&quot;));
488         e.eval(&quot;SharedObject.publicStaticChar = &#39;Z&#39;;&quot;);
489         assertEquals(&#39;Z&#39;, SharedObject.publicStaticChar);
490     }
491 
492     @Test
493     public void accessStaticFieldCharArray() throws ScriptException {
494         e.eval(&quot;var ps_char_array = SharedObject.publicStaticCharArray;&quot;);
495         assertEquals(SharedObject.publicStaticCharArray[0], e.eval(&quot;SharedObject.publicStaticCharArray[0];&quot;));
496         assertArrayEquals(SharedObject.publicStaticCharArray, (char[])e.get(&quot;ps_char_array&quot;));
497         e.eval(&quot;var ts_char_arr = new (Java.type(\&quot;char[]\&quot;))(3);&quot; +
498                 &quot;ts_char_arr[0] = &#39;G&#39;;&quot; +
499                 &quot;ts_char_arr[1] = &#39;o&#39;;&quot; +
500                 &quot;ts_char_arr[2] = &#39;o&#39;;&quot; +
501                 &quot;SharedObject.publicStaticCharArray = ts_char_arr;&quot;);
502         assertArrayEquals(&quot;Goo&quot;.toCharArray(), SharedObject.publicStaticCharArray);
503         e.eval(&quot;SharedObject.publicStaticCharArray[0] = &#39;Z&#39;;&quot;);
504         assertEquals(&#39;Z&#39;, SharedObject.publicStaticCharArray[0]);
505     }
506 
507     @Test
508     public void accessFinalFieldChar() throws ScriptException {
509         e.eval(&quot;var pf_char = o.publicFinalChar;&quot;);
510         assertEquals(o.publicFinalChar, e.get(&quot;pf_char&quot;));
511         e.eval(&quot;o.publicFinalChar = &#39;S&#39;;&quot;);
512         assertEquals(&#39;E&#39;, o.publicFinalChar);
513     }
514 
515     @Test
516     public void accessFinalCharArray() throws ScriptException {
517         e.eval(&quot;var pf_char_array = o.publicFinalCharArray;&quot;);
518         assertEquals(o.publicFinalCharArray[0], e.eval(&quot;o.publicFinalCharArray[0];&quot;));
519         assertArrayEquals(o.publicFinalCharArray, (char[])e.get(&quot;pf_char_array&quot;));
520         e.eval(&quot;var tf_char_arr = new (Java.type(\&quot;char[]\&quot;))(3);&quot; +
521                 &quot;tf_char_arr[0] = &#39;F&#39;;&quot; +
522                 &quot;tf_char_arr[1] = &#39;o&#39;;&quot; +
523                 &quot;tf_char_arr[2] = &#39;o&#39;;&quot; +
524                 &quot;o.publicFinalCharArray = tf_char_arr;&quot;);
525         assertArrayEquals(&quot;Nashorn hello&quot;.toCharArray(), o.publicFinalCharArray);
526         e.eval(&quot;o.publicFinalCharArray[0] = &#39;Z&#39;;&quot;);
527         assertEquals(&#39;Z&#39;, o.publicFinalCharArray[0]);
528     }
529 
530     @Test
531     public void accessStaticFinalFieldChar() throws ScriptException {
532         e.eval(&quot;var psf_char = SharedObject.publicStaticFinalChar;&quot;);
533         assertEquals(SharedObject.publicStaticFinalChar, e.get(&quot;psf_char&quot;));
534         e.eval(&quot;SharedObject.publicStaticFinalChar = &#39;Z&#39;;&quot;);
535         assertEquals(&#39;K&#39;, SharedObject.publicStaticFinalChar);
536     }
537 
538     @Test
539     public void accessStaticFinalFieldCharArray() throws ScriptException {
540         e.eval(&quot;var psf_char_array = SharedObject.publicStaticFinalCharArray;&quot;);
541         assertEquals(SharedObject.publicStaticFinalCharArray[0], e.eval(&quot;SharedObject.publicStaticFinalCharArray[0];&quot;));
542         assertArrayEquals(SharedObject.publicStaticFinalCharArray, (char[])e.get(&quot;psf_char_array&quot;));
543         e.eval(&quot;var tsf_char_arr = new (Java.type(\&quot;char[]\&quot;))(3);&quot; +
544                 &quot;tsf_char_arr[0] = &#39;Z&#39;;&quot; +
545                 &quot;tsf_char_arr[1] = &#39;o&#39;;&quot; +
546                 &quot;tsf_char_arr[2] = &#39;o&#39;;&quot; +
547                 &quot;SharedObject.publicStaticFinalCharArray = tsf_char_arr;&quot;);
548         assertArrayEquals(&quot;StaticString&quot;.toCharArray(), SharedObject.publicStaticFinalCharArray);
549         e.eval(&quot;SharedObject.publicStaticFinalCharArray[0] = &#39;Z&#39;;&quot;);
550         assertEquals(&#39;Z&#39;, SharedObject.publicStaticFinalCharArray[0]);
551     }
552 
553     // --------------------------------float
554     // tests------------------------------------
555     @Test
556     public void accessFieldFloat() throws ScriptException {
557         e.eval(&quot;var p_float = o.publicFloat;&quot;);
558         assertEquals((double)o.publicFloat, ((Number)e.get(&quot;p_float&quot;)).doubleValue());
559         o.publicFloat = 0.0f / 0.0f;
560         assertEquals(true, e.eval(&quot;isNaN(o.publicFloat)&quot;));
561         o.publicFloat = 1.0f / 0.0f;
562         assertEquals(true, e.eval(&quot;Number.POSITIVE_INFINITY === o.publicFloat&quot;));
563         o.publicFloat = -1.0f / 0.0f;
564         assertEquals(true, e.eval(&quot;Number.NEGATIVE_INFINITY === o.publicFloat&quot;));
565         e.eval(&quot;o.publicFloat = 20;&quot;);
566         assertEquals(20, o.publicFloat, 1e-10);
567         e.eval(&quot;o.publicFloat = 0.0/0.0;&quot;);
568         assertTrue(Float.isNaN(o.publicFloat));
569         e.eval(&quot;o.publicFloat = 1.0/0.0;&quot;);
570         assertEquals(Float.floatToIntBits(Float.POSITIVE_INFINITY), Float.floatToIntBits(o.publicFloat));
571         e.eval(&quot;o.publicFloat = -1.0/0.0;&quot;);
572         assertEquals(Float.NEGATIVE_INFINITY, o.publicFloat, 1e-10);
573     }
574 
575     @Test
576     public void accessFieldFloatArray() throws ScriptException {
577         e.eval(&quot;var p_float_array = o.publicFloatArray;&quot;);
578         assertEquals(o.publicFloatArray[0], e.eval(&quot;o.publicFloatArray[0];&quot;));
579         assertArrayEquals(o.publicFloatArray, (float[])e.get(&quot;p_float_array&quot;), 1e-10f);
580         e.eval(&quot;var t_float_arr = new (Java.type(\&quot;float[]\&quot;))(3);&quot; +
581                 &quot;t_float_arr[0] = 9.0;&quot; +
582                 &quot;t_float_arr[1] = 5.12345;&quot; +
583                 &quot;t_float_arr[2] = -60.03;&quot; +
584                 &quot;o.publicFloatArray = t_float_arr;&quot;);
585         assertArrayEquals(new float[] { 9.0f, 5.12345f, -60.03f }, o.publicFloatArray, 1e-10f);
586         e.eval(&quot;o.publicFloatArray[0] = -513.2;&quot;);
587         assertArrayEquals(new float[] { -513.2f, 5.12345f, -60.03f }, o.publicFloatArray, 1e-10f);
588     }
589 
590     @Test
591     public void accessStaticFieldFloat() throws ScriptException {
592         e.eval(&quot;var ps_float = SharedObject.publicStaticFloat;&quot;);
593         assertEquals((double)SharedObject.publicStaticFloat, ((Number)e.get(&quot;ps_float&quot;)).doubleValue());
594         SharedObject.publicStaticFloat = 0.0f / 0.0f;
595         assertEquals(true, e.eval(&quot;isNaN(SharedObject.publicStaticFloat)&quot;));
596         SharedObject.publicStaticFloat = 1.0f / 0.0f;
597         assertEquals(true, e.eval(&quot;Number.POSITIVE_INFINITY === SharedObject.publicStaticFloat&quot;));
598         SharedObject.publicStaticFloat = -1.0f / 0.0f;
599         assertEquals(true, e.eval(&quot;Number.NEGATIVE_INFINITY === SharedObject.publicStaticFloat&quot;));
600         e.eval(&quot;SharedObject.publicStaticFloat = 20.0;&quot;);
601         assertEquals(20.0f, SharedObject.publicStaticFloat, 1e-10);
602         e.eval(&quot;SharedObject.publicStaticFloat = 0.0/0.0;&quot;);
603         assertTrue(Float.isNaN(SharedObject.publicStaticFloat));
604         e.eval(&quot;SharedObject.publicStaticFloat = 1.0/0.0;&quot;);
605         assertEquals(Float.floatToIntBits(Float.POSITIVE_INFINITY), Float.floatToIntBits(SharedObject.publicStaticFloat));
606         e.eval(&quot;SharedObject.publicStaticFloat = -1.0/0.0;&quot;);
607         assertEquals(Float.floatToIntBits(Float.NEGATIVE_INFINITY), Float.floatToIntBits(SharedObject.publicStaticFloat));
608     }
609 
610     @Test
611     public void accessStaticFieldFloatArray() throws ScriptException {
612         e.eval(&quot;var ps_float_array = SharedObject.publicStaticFloatArray;&quot;);
613         assertEquals(SharedObject.publicStaticFloatArray[0], e.eval(&quot;SharedObject.publicStaticFloatArray[0];&quot;));
614         assertArrayEquals(SharedObject.publicStaticFloatArray, (float[])e.get(&quot;ps_float_array&quot;), 1e-10f);
615         e.eval(&quot;var ts_float_arr = new (Java.type(\&quot;float[]\&quot;))(3);&quot; +
616                 &quot;ts_float_arr[0] = 9.0;&quot; +
617                 &quot;ts_float_arr[1] = 5.12345;&quot; +
618                 &quot;ts_float_arr[2] = -60.03;&quot; +
619                 &quot;SharedObject.publicStaticFloatArray = ts_float_arr;&quot;);
620         assertArrayEquals(new float[] { 9.0f, 5.12345f, -60.03f }, SharedObject.publicStaticFloatArray, 1e-10f);
621         e.eval(&quot;SharedObject.publicStaticFloatArray[0] = -513.2;&quot;);
622         assertArrayEquals(new float[] { -513.2f, 5.12345f, -60.03f }, SharedObject.publicStaticFloatArray, 1e-10f);
623     }
624 
625     @Test
626     public void accessFinalFloat() throws ScriptException {
627         e.eval(&quot;var pf_float = o.publicFinalFloat;&quot;);
628         assertEquals((double)o.publicFinalFloat, ((Number)e.get(&quot;pf_float&quot;)).doubleValue());
629         e.eval(&quot;o.publicFinalFloat = 20.0;&quot;);
630         assertEquals(7.72e8f, o.publicFinalFloat, 1e-10);
631     }
632 
633     @Test
634     public void accessFinalFloatArray() throws ScriptException {
635         e.eval(&quot;var pf_float_array = o.publicFinalFloatArray;&quot;);
636         assertEquals(o.publicFinalFloatArray[0], e.eval(&quot;o.publicFinalFloatArray[0];&quot;));
637         assertArrayEquals(o.publicFinalFloatArray, (float[])e.get(&quot;pf_float_array&quot;), 1e-10f);
638         e.eval(&quot;var tf_float_arr = new (Java.type(\&quot;float[]\&quot;))(3);&quot; +
639                 &quot;tf_float_arr[0] = 9.0;&quot; +
640                 &quot;tf_float_arr[1] = 5.12345;&quot; +
641                 &quot;tf_float_arr[2] = -60.03;&quot; +
642                 &quot;o.publicFinalFloatArray = tf_float_arr;&quot;);
643         assertArrayEquals(new float[] { -131.012f, 189.32f, -31.32e8f, 3.72f }, o.publicFinalFloatArray, 1e-10f);
644         e.eval(&quot;o.publicFinalFloatArray[0] = -513.2;&quot;);
645         assertEquals(-513.2f, o.publicFinalFloatArray[0], 1e-10f);
646     }
647 
648     @Test
649     public void accessStaticFinalFieldFloat() throws ScriptException {
650         e.eval(&quot;var psf_float = SharedObject.publicStaticFinalFloat;&quot;);
651         assertEquals((double)SharedObject.publicStaticFinalFloat, ((Number)e.get(&quot;psf_float&quot;)).doubleValue());
652         e.eval(&quot;SharedObject.publicStaticFinalFloat = 20.0;&quot;);
653         assertEquals(0.72e8f, SharedObject.publicStaticFinalFloat, 1e-10);
654     }
655 
656     @Test
657     public void accessStaticFinalFieldFloatArray() throws ScriptException {
658         e.eval(&quot;var psf_float_array = SharedObject.publicStaticFinalFloatArray;&quot;);
659         assertEquals(SharedObject.publicStaticFinalFloatArray[0], e.eval(&quot;SharedObject.publicStaticFinalFloatArray[0];&quot;));
660         assertArrayEquals(SharedObject.publicStaticFinalFloatArray, (float[])e.get(&quot;psf_float_array&quot;), 1e-10f);
661         e.eval(&quot;var tsf_float_arr = new (Java.type(\&quot;float[]\&quot;))(3);&quot; +
662                 &quot;tsf_float_arr[0] = 9.0;&quot; +
663                 &quot;tsf_float_arr[1] = 5.12345;&quot; +
664                 &quot;tsf_float_arr[2] = -60.03;&quot; +
665                 &quot;SharedObject.publicStaticFinalFloatArray = tsf_float_arr;&quot;);
666         assertArrayEquals(new float[] { -8131.012f, 9.32f, -138.32e8f, 0.72f }, SharedObject.publicStaticFinalFloatArray, 1e-10f);
667         e.eval(&quot;SharedObject.publicStaticFinalFloatArray[0] = -513.2;&quot;);
668         assertEquals(-513.2f, SharedObject.publicStaticFinalFloatArray[0], 1e-10f);
669     }
670 
671     // --------------------------------double
672     // tests------------------------------------
673     @Test
674     public void accessFieldDouble() throws ScriptException {
675         e.eval(&quot;var p_double = o.publicDouble;&quot;);
676         assertEquals(o.publicDouble, e.get(&quot;p_double&quot;));
677         o.publicDouble = 0.0 / 0.0;
678         assertEquals(true, e.eval(&quot;isNaN(o.publicDouble)&quot;));
679         o.publicDouble = 1.0 / 0.0;
680         assertEquals(true, e.eval(&quot;Number.POSITIVE_INFINITY === o.publicDouble&quot;));
681         o.publicDouble = -1.0 / 0.0;
682         assertEquals(true, e.eval(&quot;Number.NEGATIVE_INFINITY === o.publicDouble&quot;));
683         e.eval(&quot;o.publicDouble = 30;&quot;);
684         assertEquals(Double.doubleToLongBits(30.0), Double.doubleToLongBits(o.publicDouble));
685         e.eval(&quot;o.publicDouble = 0.0/0.0;&quot;);
686         assertTrue(Double.isNaN(o.publicDouble));
687         e.eval(&quot;o.publicDouble = 1.0/0.0;&quot;);
688         assertEquals(Double.doubleToLongBits(Double.POSITIVE_INFINITY), Double.doubleToLongBits(o.publicDouble));
689         e.eval(&quot;o.publicDouble = -1.0/0.0;&quot;);
690         assertEquals(Double.doubleToLongBits(Double.NEGATIVE_INFINITY), Double.doubleToLongBits(o.publicDouble));
691     }
692 
693     @Test
694     public void accessFieldDoubleArrayRead() throws ScriptException {
695         e.eval(&quot;var p_double_array = o.publicDoubleArray;&quot;);
696         assertEquals(o.publicDoubleArray[0], e.eval(&quot;o.publicDoubleArray[0];&quot;));
697         assertArrayEquals(o.publicDoubleArray, (double[])e.get(&quot;p_double_array&quot;), 1e-10);
698         e.eval(&quot;var t_double_arr = new (Java.type(\&quot;double[]\&quot;))(3);&quot; +
699                 &quot;t_double_arr[0] = 9e10;&quot; +
700                 &quot;t_double_arr[1] = 0.677777;&quot; +
701                 &quot;t_double_arr[2] = -0.0000001;&quot; +
702                 &quot;o.publicDoubleArray = t_double_arr;&quot;);
703         assertArrayEquals(new double[] { 9e10, 0.677777, -0.0000001 }, o.publicDoubleArray, 1e-10f);
704         e.eval(&quot;o.publicDoubleArray[0] = -5.2e10;&quot;);
705         assertEquals(-5.2e10, o.publicDoubleArray[0], 1e-10f);
706     }
707 
708     @Test
709     public void accessStaticFieldDouble() throws ScriptException {
710         e.eval(&quot;var ps_double = SharedObject.publicStaticDouble;&quot;);
711         assertEquals(SharedObject.publicStaticDouble, e.get(&quot;ps_double&quot;));
712         SharedObject.publicStaticDouble = 0.0 / 0.0;
713         assertEquals(true, e.eval(&quot;isNaN(SharedObject.publicStaticDouble)&quot;));
714         SharedObject.publicStaticDouble = 1.0 / 0.0;
715         assertEquals(true, e.eval(&quot;Number.POSITIVE_INFINITY === SharedObject.publicStaticDouble&quot;));
716         SharedObject.publicStaticDouble = -1.0 / 0.0;
717         assertEquals(true, e.eval(&quot;Number.NEGATIVE_INFINITY === SharedObject.publicStaticDouble&quot;));
718         e.eval(&quot;SharedObject.publicStaticDouble = 40.0;&quot;);
719         assertEquals(Double.doubleToLongBits(40.0), Double.doubleToLongBits(SharedObject.publicStaticDouble));
720         e.eval(&quot;SharedObject.publicStaticDouble = 0.0/0.0;&quot;);
721         assertTrue(Double.isNaN(SharedObject.publicStaticDouble));
722         e.eval(&quot;SharedObject.publicStaticDouble = 1.0/0.0;&quot;);
723         assertEquals(Double.doubleToLongBits(Double.POSITIVE_INFINITY), Double.doubleToLongBits(SharedObject.publicStaticDouble));
724         e.eval(&quot;SharedObject.publicStaticDouble = -1.0/0.0;&quot;);
725         assertEquals(Double.doubleToLongBits(Double.NEGATIVE_INFINITY), Double.doubleToLongBits(SharedObject.publicStaticDouble));
726     }
727 
728     @Test
729     public void accessStaticFieldDoubleArrayRead() throws ScriptException {
730         e.eval(&quot;var ps_double_array = SharedObject.publicStaticDoubleArray;&quot;);
731         assertEquals(SharedObject.publicStaticDoubleArray[0], e.eval(&quot;SharedObject.publicStaticDoubleArray[0];&quot;));
732         assertArrayEquals(SharedObject.publicStaticDoubleArray, (double[])e.get(&quot;ps_double_array&quot;), 1e-10);
733         e.eval(&quot;var ts_double_arr = new (Java.type(\&quot;double[]\&quot;))(3);&quot; +
734                 &quot;ts_double_arr[0] = 9e10;&quot; +
735                 &quot;ts_double_arr[1] = 0.677777;&quot; +
736                 &quot;ts_double_arr[2] = -0.0000001;&quot; +
737                 &quot;SharedObject.publicStaticDoubleArray = ts_double_arr;&quot;);
738         assertArrayEquals(new double[] { 9e10, 0.677777, -0.0000001 }, SharedObject.publicStaticDoubleArray, 1e-10f);
739         e.eval(&quot;SharedObject.publicStaticDoubleArray[0] = -5.2e10;&quot;);
740         assertEquals(-5.2e10, SharedObject.publicStaticDoubleArray[0], 1e-10f);
741     }
742 
743     @Test
744     public void accessFinalFieldDouble() throws ScriptException {
745         e.eval(&quot;var pf_double = o.publicFinalDouble;&quot;);
746         assertEquals(o.publicFinalDouble, e.get(&quot;pf_double&quot;));
747         e.eval(&quot;o.publicFinalDouble = 30.0;&quot;);
748         assertEquals(Double.doubleToLongBits(1.3412e20), Double.doubleToLongBits(o.publicFinalDouble));
749     }
750 
751     @Test
752     public void accessFinalFieldDoubleArrayRead() throws ScriptException {
753         e.eval(&quot;var pf_double_array = o.publicFinalDoubleArray;&quot;);
754         assertEquals(o.publicFinalDoubleArray[0], e.eval(&quot;o.publicFinalDoubleArray[0];&quot;));
755         assertArrayEquals(o.publicFinalDoubleArray, (double[])e.get(&quot;pf_double_array&quot;), 1e-10);
756         e.eval(&quot;var tf_double_arr = new (Java.type(\&quot;double[]\&quot;))(3);&quot; +
757                 &quot;tf_double_arr[0] = 9e10;&quot; +
758                 &quot;tf_double_arr[1] = 0.677777;&quot; +
759                 &quot;tf_double_arr[2] = -0.0000001;&quot; +
760                 &quot;o.publicFinalDoubleArray = tf_double_arr;&quot;);
761         assertArrayEquals(new double[] { 0.725e80, 0.12e10, 8e-3, 1.00077 }, o.publicFinalDoubleArray, 1e-10f);
762         e.eval(&quot;o.publicFinalDoubleArray[0] = -5.2e10;&quot;);
763         assertEquals(-5.2e10, o.publicFinalDoubleArray[0], 1e-10f);
764     }
765 
766     @Test
767     public void accessStaticFinalFieldDouble() throws ScriptException {
768         e.eval(&quot;var psf_double = SharedObject.publicStaticFinalDouble;&quot;);
769         assertEquals(SharedObject.publicStaticFinalDouble, e.get(&quot;psf_double&quot;));
770         e.eval(&quot;SharedObject.publicStaticFinalDouble = 40.0;&quot;);
771         assertEquals(Double.doubleToLongBits(1.8e12), Double.doubleToLongBits(SharedObject.publicStaticFinalDouble));
772     }
773 
774     @Test
775     public void accessStaticFinalFieldDoubleArrayRead() throws ScriptException {
776         e.eval(&quot;var psf_double_array = SharedObject.publicStaticFinalDoubleArray;&quot;);
777         assertEquals(SharedObject.publicStaticFinalDoubleArray[0], e.eval(&quot;SharedObject.publicStaticFinalDoubleArray[0];&quot;));
778         assertArrayEquals(SharedObject.publicStaticFinalDoubleArray, (double[])e.get(&quot;psf_double_array&quot;), 1e-10);
779         e.eval(&quot;var tsf_double_arr = new (Java.type(\&quot;double[]\&quot;))(3);&quot; +
780                 &quot;tsf_double_arr[0] = 9e10;&quot; +
781                 &quot;tsf_double_arr[1] = 0.677777;&quot; +
782                 &quot;tsf_double_arr[2] = -0.0000001;&quot; +
783                 &quot;SharedObject.publicStaticFinalDoubleArray = tsf_double_arr;&quot;);
784         assertArrayEquals(new double[] { 8.725e80, 0.82e10, 18e-3, 1.08077 }, SharedObject.publicStaticFinalDoubleArray, 1e-10f);
785         e.eval(&quot;SharedObject.publicStaticFinalDoubleArray[0] = -5.2e10;&quot;);
786         assertEquals(-5.2e10, SharedObject.publicStaticFinalDoubleArray[0], 1e-10f);
787     }
788 
789 }
    </pre>
  </body>
</html>