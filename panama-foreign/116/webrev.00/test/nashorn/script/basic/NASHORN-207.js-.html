<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old test/nashorn/script/basic/NASHORN-207.js</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2010, 2013, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 /**
 25  * NASHORN-207 : implement strict mode
 26  *
 27  * @test
 28  * @run
 29  */
 30 
 31 &#39;use strict&#39;;
 32 
 33 // cannot delete a variable
 34 try {
 35     eval(&quot;var fooVar = 3; delete fooVar;&quot;);
 36     fail(&quot;#1 should have thrown SyntaxError&quot;);
 37 } catch (e) {
 38     if (! (e instanceof SyntaxError)) {
 39         fail(&quot;#2 SyntaxError expected but got &quot; + e);
 40     }
 41 }
 42 
 43 // cannot delete function parameter variable
 44 try {
 45     eval(&quot;function func(a) { delete a; }; func(2);&quot;);
 46     fail(&quot;#3 should have thrown SyntaxError&quot;);
 47 } catch(e) {
 48     if (! (e instanceof SyntaxError)) {
 49         fail(&quot;#4 SyntaxError expected but got &quot; + e);
 50     }
 51 }
 52 
 53 // assignment can&#39;t be used to define as new variable
 54 try {
 55     bar = 3;
 56     fail(&quot;#5 should have thrown ReferenceError&quot;);
 57 } catch (e) {
 58     if (! (e instanceof ReferenceError)) {
 59         fail(&quot;#6 ReferenceError expected but got &quot; + e);
 60     }
 61 }
 62 
 63 // repeated property definition is not allowed in an object literal
 64 try {
 65     eval(&quot;var obj = { foo: 33, foo: 44 }&quot;);
 66     fail(&quot;#7 should have thrown SyntaxError&quot;);
 67 } catch(e) {
 68     if (! (e instanceof SyntaxError)) {
 69         fail(&quot;#8 SyntaxError expected but got &quot; + e);
 70     }
 71 }
 72 
 73 // can&#39;t assign to &quot;eval&quot;
 74 try {
 75     eval(&quot;var eval = 3&quot;);
 76     fail(&quot;#9 should have thrown SyntaxError&quot;);
 77 } catch(e) {
 78     if (! (e instanceof SyntaxError)) {
 79         fail(&quot;#10 SyntaxError expected but got &quot; + e);
 80     }
 81 }
 82 
 83 // can&#39;t assign to &#39;arguments&#39;
 84 try {
 85     eval(&quot;function func() { arguments = 34; }&quot;);
 86     fail(&quot;#11 should have thrown SyntaxError&quot;);
 87 } catch(e) {
 88     if (! (e instanceof SyntaxError)) {
 89         fail(&quot;#12 SyntaxError expected but got &quot; + e);
 90     }
 91 }
 92 
 93 // can&#39;t delete non-configurable properties
 94 try {
 95     delete Object.prototype;
 96     fail(&quot;#13 should have thrown TypeError&quot;);
 97 } catch (e) {
 98     if (! (e instanceof TypeError)) {
 99         fail(&quot;#14 TypeError expected but got &quot; + e);
100     }
101 }
102 
103 // cannot re-use function parameter name
104 try {
105     eval(&quot;function func(a, a) {}&quot;);
106     fail(&quot;#15 should have thrown SyntaxError&quot;);
107 } catch (e) {
108     if (! (e instanceof SyntaxError)) {
109         fail(&quot;#16 SyntaxError expected but got &quot; + e);
110     }
111 }
112 
113 // strict eval creates own scope and caller&#39;s scope is untouched!
114 eval(&quot;var myVar = 4;&quot;);
115 if (typeof myVar !== &#39;undefined&#39;) {
116     fail(&quot;#17 eval var &#39;myVar&#39; created in global scope&quot;);
117 }
118 
119 eval(&quot;function myNewFunc() {}&quot;);
120 if (typeof myNewFunc !== &#39;undefined&#39;) {
121     fail(&quot;#18 eval function &#39;myNewFunc&#39; created in global scope&quot;);
122 }
123 
124 // no octal in strict mode
125 try {
126     eval(&quot;var x = 010;&quot;);
127     fail(&quot;#19 should have thrown SyntaxError&quot;);
128 } catch (e) {
129     if (! (e instanceof SyntaxError)) {
130         fail(&quot;#20 SyntaxError expected but got &quot; + e);
131     }
132 }
    </pre>
  </body>
</html>