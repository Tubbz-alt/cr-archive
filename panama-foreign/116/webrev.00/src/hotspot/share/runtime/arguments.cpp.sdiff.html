<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/runtime/arguments.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../prims/methodHandles.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="globals.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/runtime/arguments.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 569   const char* real_name;
 570 } AliasedFlag;
 571 
 572 static AliasedFlag const aliased_jvm_flags[] = {
 573   { &quot;DefaultMaxRAMFraction&quot;,    &quot;MaxRAMFraction&quot;    },
 574   { &quot;CreateMinidumpOnCrash&quot;,    &quot;CreateCoredumpOnCrash&quot; },
 575   { NULL, NULL}
 576 };
 577 
 578 // NOTE: A compatibility request will be necessary for each alias to be removed.
 579 static AliasedLoggingFlag const aliased_logging_flags[] = {
 580   { &quot;PrintCompressedOopsMode&quot;,   LogLevel::Info,  true,  LOG_TAGS(gc, heap, coops) },
 581   { &quot;PrintSharedSpaces&quot;,         LogLevel::Info,  true,  LOG_TAGS(cds) },
 582   { &quot;TraceBiasedLocking&quot;,        LogLevel::Info,  true,  LOG_TAGS(biasedlocking) },
 583   { &quot;TraceClassLoading&quot;,         LogLevel::Info,  true,  LOG_TAGS(class, load) },
 584   { &quot;TraceClassLoadingPreorder&quot;, LogLevel::Debug, true,  LOG_TAGS(class, preorder) },
 585   { &quot;TraceClassPaths&quot;,           LogLevel::Info,  true,  LOG_TAGS(class, path) },
 586   { &quot;TraceClassResolution&quot;,      LogLevel::Debug, true,  LOG_TAGS(class, resolve) },
 587   { &quot;TraceClassUnloading&quot;,       LogLevel::Info,  true,  LOG_TAGS(class, unload) },
 588   { &quot;TraceExceptions&quot;,           LogLevel::Info,  true,  LOG_TAGS(exceptions) },

 589   { &quot;TraceLoaderConstraints&quot;,    LogLevel::Info,  true,  LOG_TAGS(class, loader, constraints) },

 590   { &quot;TraceMonitorInflation&quot;,     LogLevel::Trace, true,  LOG_TAGS(monitorinflation) },
 591   { &quot;TraceSafepointCleanupTime&quot;, LogLevel::Info,  true,  LOG_TAGS(safepoint, cleanup) },
 592   { &quot;TraceJVMTIObjectTagging&quot;,   LogLevel::Debug, true,  LOG_TAGS(jvmti, objecttagging) },
 593   { &quot;TraceRedefineClasses&quot;,      LogLevel::Info,  false, LOG_TAGS(redefine, class) },
 594   { &quot;PrintJNIResolving&quot;,         LogLevel::Debug, true,  LOG_TAGS(jni, resolve) },
 595   { NULL,                        LogLevel::Off,   false, LOG_TAGS(_NO_TAG) }
 596 };
 597 
 598 #ifndef PRODUCT
 599 // These options are removed in jdk9. Remove this code for jdk10.
 600 static AliasedFlag const removed_develop_logging_flags[] = {
 601   { &quot;TraceClassInitialization&quot;,   &quot;-Xlog:class+init&quot; },
 602   { &quot;TraceClassLoaderData&quot;,       &quot;-Xlog:class+loader+data&quot; },
 603   { &quot;TraceDefaultMethods&quot;,        &quot;-Xlog:defaultmethods=debug&quot; },
 604   { &quot;TraceItables&quot;,               &quot;-Xlog:itables=debug&quot; },
 605   { &quot;TraceMonitorMismatch&quot;,       &quot;-Xlog:monitormismatch=info&quot; },
 606   { &quot;TraceSafepoint&quot;,             &quot;-Xlog:safepoint=debug&quot; },
 607   { &quot;TraceStartupTime&quot;,           &quot;-Xlog:startuptime&quot; },
 608   { &quot;TraceVMOperation&quot;,           &quot;-Xlog:vmoperation=debug&quot; },
 609   { &quot;PrintVtables&quot;,               &quot;-Xlog:vtables=debug&quot; },
</pre>
<hr />
<pre>
 701 static bool lookup_special_flag(const char *flag_name, size_t skip_index) {
 702   for (size_t i = 0; special_jvm_flags[i].name != NULL; i++) {
 703     if ((i != skip_index) &amp;&amp; (strcmp(special_jvm_flags[i].name, flag_name) == 0)) {
 704       return true;
 705     }
 706   }
 707   return false;
 708 }
 709 
 710 // Verifies the correctness of the entries in the special_jvm_flags table.
 711 // If there is a semantic error (i.e. a bug in the table) such as the obsoletion
 712 // version being earlier than the deprecation version, then a warning is issued
 713 // and verification fails - by returning false. If it is detected that the table
 714 // is out of date, with respect to the current version, then ideally a warning is
 715 // issued but verification does not fail. This allows the VM to operate when the
 716 // version is first updated, without needing to update all the impacted flags at
 717 // the same time. In practice we can&#39;t issue the warning immediately when the version
 718 // is updated as it occurs for every test and some tests are not prepared to handle
 719 // unexpected output - see 8196739. Instead we only check if the table is up-to-date
 720 // if the check_globals flag is true, and in addition allow a grace period and only
<span class="line-modified"> 721 // check for stale flags when we hit build 20 (which is far enough into the 6 month</span>
 722 // release cycle that all flag updates should have been processed, whilst still
 723 // leaving time to make the change before RDP2).
 724 // We use a gtest to call this, passing true, so that we can detect stale flags before
 725 // the end of the release cycle.
 726 
<span class="line-modified"> 727 static const int SPECIAL_FLAG_VALIDATION_BUILD = 20;</span>
 728 
 729 bool Arguments::verify_special_jvm_flags(bool check_globals) {
 730   bool success = true;
 731   for (size_t i = 0; special_jvm_flags[i].name != NULL; i++) {
 732     const SpecialFlag&amp; flag = special_jvm_flags[i];
 733     if (lookup_special_flag(flag.name, i)) {
 734       warning(&quot;Duplicate special flag declaration \&quot;%s\&quot;&quot;, flag.name);
 735       success = false;
 736     }
 737     if (flag.deprecated_in.is_undefined() &amp;&amp;
 738         flag.obsolete_in.is_undefined()) {
 739       warning(&quot;Special flag entry \&quot;%s\&quot; must declare version deprecated and/or obsoleted in.&quot;, flag.name);
 740       success = false;
 741     }
 742 
 743     if (!flag.deprecated_in.is_undefined()) {
 744       if (!version_less_than(flag.deprecated_in, flag.obsolete_in)) {
 745         warning(&quot;Special flag entry \&quot;%s\&quot; must be deprecated before obsoleted.&quot;, flag.name);
 746         success = false;
 747       }
</pre>
</td>
<td>
<hr />
<pre>
 569   const char* real_name;
 570 } AliasedFlag;
 571 
 572 static AliasedFlag const aliased_jvm_flags[] = {
 573   { &quot;DefaultMaxRAMFraction&quot;,    &quot;MaxRAMFraction&quot;    },
 574   { &quot;CreateMinidumpOnCrash&quot;,    &quot;CreateCoredumpOnCrash&quot; },
 575   { NULL, NULL}
 576 };
 577 
 578 // NOTE: A compatibility request will be necessary for each alias to be removed.
 579 static AliasedLoggingFlag const aliased_logging_flags[] = {
 580   { &quot;PrintCompressedOopsMode&quot;,   LogLevel::Info,  true,  LOG_TAGS(gc, heap, coops) },
 581   { &quot;PrintSharedSpaces&quot;,         LogLevel::Info,  true,  LOG_TAGS(cds) },
 582   { &quot;TraceBiasedLocking&quot;,        LogLevel::Info,  true,  LOG_TAGS(biasedlocking) },
 583   { &quot;TraceClassLoading&quot;,         LogLevel::Info,  true,  LOG_TAGS(class, load) },
 584   { &quot;TraceClassLoadingPreorder&quot;, LogLevel::Debug, true,  LOG_TAGS(class, preorder) },
 585   { &quot;TraceClassPaths&quot;,           LogLevel::Info,  true,  LOG_TAGS(class, path) },
 586   { &quot;TraceClassResolution&quot;,      LogLevel::Debug, true,  LOG_TAGS(class, resolve) },
 587   { &quot;TraceClassUnloading&quot;,       LogLevel::Info,  true,  LOG_TAGS(class, unload) },
 588   { &quot;TraceExceptions&quot;,           LogLevel::Info,  true,  LOG_TAGS(exceptions) },
<span class="line-added"> 589   { &quot;TraceInvokeDynamic&quot;,        LogLevel::Debug, true,  LOG_TAGS(methodhandles, indy) },</span>
 590   { &quot;TraceLoaderConstraints&quot;,    LogLevel::Info,  true,  LOG_TAGS(class, loader, constraints) },
<span class="line-added"> 591   { &quot;TraceMethodHandles&quot;,        LogLevel::Info,  true,  LOG_TAGS(methodhandles) },</span>
 592   { &quot;TraceMonitorInflation&quot;,     LogLevel::Trace, true,  LOG_TAGS(monitorinflation) },
 593   { &quot;TraceSafepointCleanupTime&quot;, LogLevel::Info,  true,  LOG_TAGS(safepoint, cleanup) },
 594   { &quot;TraceJVMTIObjectTagging&quot;,   LogLevel::Debug, true,  LOG_TAGS(jvmti, objecttagging) },
 595   { &quot;TraceRedefineClasses&quot;,      LogLevel::Info,  false, LOG_TAGS(redefine, class) },
 596   { &quot;PrintJNIResolving&quot;,         LogLevel::Debug, true,  LOG_TAGS(jni, resolve) },
 597   { NULL,                        LogLevel::Off,   false, LOG_TAGS(_NO_TAG) }
 598 };
 599 
 600 #ifndef PRODUCT
 601 // These options are removed in jdk9. Remove this code for jdk10.
 602 static AliasedFlag const removed_develop_logging_flags[] = {
 603   { &quot;TraceClassInitialization&quot;,   &quot;-Xlog:class+init&quot; },
 604   { &quot;TraceClassLoaderData&quot;,       &quot;-Xlog:class+loader+data&quot; },
 605   { &quot;TraceDefaultMethods&quot;,        &quot;-Xlog:defaultmethods=debug&quot; },
 606   { &quot;TraceItables&quot;,               &quot;-Xlog:itables=debug&quot; },
 607   { &quot;TraceMonitorMismatch&quot;,       &quot;-Xlog:monitormismatch=info&quot; },
 608   { &quot;TraceSafepoint&quot;,             &quot;-Xlog:safepoint=debug&quot; },
 609   { &quot;TraceStartupTime&quot;,           &quot;-Xlog:startuptime&quot; },
 610   { &quot;TraceVMOperation&quot;,           &quot;-Xlog:vmoperation=debug&quot; },
 611   { &quot;PrintVtables&quot;,               &quot;-Xlog:vtables=debug&quot; },
</pre>
<hr />
<pre>
 703 static bool lookup_special_flag(const char *flag_name, size_t skip_index) {
 704   for (size_t i = 0; special_jvm_flags[i].name != NULL; i++) {
 705     if ((i != skip_index) &amp;&amp; (strcmp(special_jvm_flags[i].name, flag_name) == 0)) {
 706       return true;
 707     }
 708   }
 709   return false;
 710 }
 711 
 712 // Verifies the correctness of the entries in the special_jvm_flags table.
 713 // If there is a semantic error (i.e. a bug in the table) such as the obsoletion
 714 // version being earlier than the deprecation version, then a warning is issued
 715 // and verification fails - by returning false. If it is detected that the table
 716 // is out of date, with respect to the current version, then ideally a warning is
 717 // issued but verification does not fail. This allows the VM to operate when the
 718 // version is first updated, without needing to update all the impacted flags at
 719 // the same time. In practice we can&#39;t issue the warning immediately when the version
 720 // is updated as it occurs for every test and some tests are not prepared to handle
 721 // unexpected output - see 8196739. Instead we only check if the table is up-to-date
 722 // if the check_globals flag is true, and in addition allow a grace period and only
<span class="line-modified"> 723 // check for stale flags when we hit build 25 (which is far enough into the 6 month</span>
 724 // release cycle that all flag updates should have been processed, whilst still
 725 // leaving time to make the change before RDP2).
 726 // We use a gtest to call this, passing true, so that we can detect stale flags before
 727 // the end of the release cycle.
 728 
<span class="line-modified"> 729 static const int SPECIAL_FLAG_VALIDATION_BUILD = 25;</span>
 730 
 731 bool Arguments::verify_special_jvm_flags(bool check_globals) {
 732   bool success = true;
 733   for (size_t i = 0; special_jvm_flags[i].name != NULL; i++) {
 734     const SpecialFlag&amp; flag = special_jvm_flags[i];
 735     if (lookup_special_flag(flag.name, i)) {
 736       warning(&quot;Duplicate special flag declaration \&quot;%s\&quot;&quot;, flag.name);
 737       success = false;
 738     }
 739     if (flag.deprecated_in.is_undefined() &amp;&amp;
 740         flag.obsolete_in.is_undefined()) {
 741       warning(&quot;Special flag entry \&quot;%s\&quot; must declare version deprecated and/or obsoleted in.&quot;, flag.name);
 742       success = false;
 743     }
 744 
 745     if (!flag.deprecated_in.is_undefined()) {
 746       if (!version_less_than(flag.deprecated_in, flag.obsolete_in)) {
 747         warning(&quot;Special flag entry \&quot;%s\&quot; must be deprecated before obsoleted.&quot;, flag.name);
 748         success = false;
 749       }
</pre>
</td>
</tr>
</table>
<center><a href="../prims/methodHandles.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="globals.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>