<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/unix/native/libawt_xawt/awt/multiVis.c</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="gtk3_interface.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../java2d/x11/XRBackendNative.c.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/unix/native/libawt_xawt/awt/multiVis.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 420 
 421 static XImage *
 422 ReadRegionsInList(Display *disp, Visual *fakeVis, int depth, int format,
 423                   unsigned int width, unsigned int height,
 424                   XRectangle bbox,      /* bounding box of grabbed area */
 425                   list_ptr regions)     /* list of regions to read from */
 426 {
 427     image_region_type   *reg;
 428     int                 dst_x, dst_y;   /* where in pixmap to write (UL) */
 429     int                 diff;
 430 
 431     XImage              *reg_image,*ximage ;
 432     int                 srcRect_x,srcRect_y,srcRect_width,srcRect_height ;
 433     int                 bytes_per_line;
 434 
 435     ximage = XCreateImage(disp,fakeVis,depth,format,0,NULL,width,height,
 436                  8,0) ;
 437     bytes_per_line = ximage-&gt;bytes_per_line;
 438 
 439     if (format == ZPixmap)
<span class="line-modified"> 440           ximage-&gt;data = malloc(height*bytes_per_line);</span>
 441     else
<span class="line-modified"> 442         ximage-&gt;data = malloc(height*bytes_per_line*depth);</span>
 443 
 444     ximage-&gt;bits_per_pixel = depth; /** Valid only if format is ZPixmap ***/
 445 
 446     for (reg = (image_region_type *) first_in_list( regions); reg;
 447          reg = (image_region_type *) next_in_list( regions))
 448     {
 449                 int rect;
 450                 struct my_XRegion *vis_reg;
 451                 vis_reg = (struct my_XRegion *)(reg-&gt;visible_region);
 452                 for (rect = 0;
 453                      rect &lt; vis_reg-&gt;numRects;
 454                      rect++)
 455                 {
 456                 /** ------------------------------------------------------------------------
 457                         Intersect bbox with visible part of region giving src rect &amp; output
 458                         location.  Width is the min right side minus the max left side.
 459                         Similar for height.  Offset src rect so x,y are relative to
 460                         origin of win, not the root-relative visible rect of win.
 461                     ------------------------------------------------------------------------ **/
 462                     srcRect_width  = MIN( vis_reg-&gt;rects[rect].x2, bbox.width + bbox.x) -
</pre>
</td>
<td>
<hr />
<pre>
 420 
 421 static XImage *
 422 ReadRegionsInList(Display *disp, Visual *fakeVis, int depth, int format,
 423                   unsigned int width, unsigned int height,
 424                   XRectangle bbox,      /* bounding box of grabbed area */
 425                   list_ptr regions)     /* list of regions to read from */
 426 {
 427     image_region_type   *reg;
 428     int                 dst_x, dst_y;   /* where in pixmap to write (UL) */
 429     int                 diff;
 430 
 431     XImage              *reg_image,*ximage ;
 432     int                 srcRect_x,srcRect_y,srcRect_width,srcRect_height ;
 433     int                 bytes_per_line;
 434 
 435     ximage = XCreateImage(disp,fakeVis,depth,format,0,NULL,width,height,
 436                  8,0) ;
 437     bytes_per_line = ximage-&gt;bytes_per_line;
 438 
 439     if (format == ZPixmap)
<span class="line-modified"> 440           ximage-&gt;data = malloc((size_t) height * bytes_per_line);</span>
 441     else
<span class="line-modified"> 442         ximage-&gt;data = malloc((size_t) height * bytes_per_line * depth);</span>
 443 
 444     ximage-&gt;bits_per_pixel = depth; /** Valid only if format is ZPixmap ***/
 445 
 446     for (reg = (image_region_type *) first_in_list( regions); reg;
 447          reg = (image_region_type *) next_in_list( regions))
 448     {
 449                 int rect;
 450                 struct my_XRegion *vis_reg;
 451                 vis_reg = (struct my_XRegion *)(reg-&gt;visible_region);
 452                 for (rect = 0;
 453                      rect &lt; vis_reg-&gt;numRects;
 454                      rect++)
 455                 {
 456                 /** ------------------------------------------------------------------------
 457                         Intersect bbox with visible part of region giving src rect &amp; output
 458                         location.  Width is the min right side minus the max left side.
 459                         Similar for height.  Offset src rect so x,y are relative to
 460                         origin of win, not the root-relative visible rect of win.
 461                     ------------------------------------------------------------------------ **/
 462                     srcRect_width  = MIN( vis_reg-&gt;rects[rect].x2, bbox.width + bbox.x) -
</pre>
</td>
</tr>
</table>
<center><a href="gtk3_interface.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../java2d/x11/XRBackendNative.c.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>