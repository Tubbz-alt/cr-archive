<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/classes/sun/font/FileFontStrike.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../javax/swing/text/html/FormView.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="FontScaler.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/classes/sun/font/FileFontStrike.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
134                 algoStyle = true;
135                 italic = 0.7f;
136             }
137             if ((desc.style &amp; Font.BOLD) == Font.BOLD &amp;&amp;
138                 ((fileFont.style &amp; Font.BOLD) == 0)) {
139                 algoStyle = true;
140                 boldness = 1.33f;
141             }
142         }
143         double[] matrix = new double[4];
144         AffineTransform at = desc.glyphTx;
145         at.getMatrix(matrix);
146         if (!desc.devTx.isIdentity() &amp;&amp;
147             desc.devTx.getType() != AffineTransform.TYPE_TRANSLATION) {
148             try {
149                 invertDevTx = desc.devTx.createInverse();
150             } catch (NoninvertibleTransformException e) {
151             }
152         }
153 
<span class="line-removed">154         /* Amble fonts are better rendered unhinted although there&#39;s the</span>
<span class="line-removed">155          * inevitable fuzziness that accompanies this due to no longer</span>
<span class="line-removed">156          * snapping stems to the pixel grid. The exception is that in B&amp;W</span>
<span class="line-removed">157          * mode they are worse without hinting. The down side to that is that</span>
<span class="line-removed">158          * B&amp;W metrics will differ which normally isn&#39;t the case, although</span>
<span class="line-removed">159          * since AA mode is part of the measuring context that should be OK.</span>
<span class="line-removed">160          * We don&#39;t expect Amble to be installed in the Windows fonts folder.</span>
<span class="line-removed">161          * If we were to, then we&#39;d also might want to disable using the</span>
<span class="line-removed">162          * native rasteriser path which is used for LCD mode for platform</span>
<span class="line-removed">163          * fonts. since we have no way to disable hinting by GDI.</span>
<span class="line-removed">164          * In the case of Amble, since its &#39;gasp&#39; table says to disable</span>
<span class="line-removed">165          * hinting, I&#39;d expect GDI to follow that, so likely it should</span>
<span class="line-removed">166          * all be consistent even if GDI used.</span>
<span class="line-removed">167          */</span>
<span class="line-removed">168         boolean disableHinting = desc.aaHint != INTVAL_TEXT_ANTIALIAS_OFF &amp;&amp;</span>
<span class="line-removed">169                                  fileFont.familyName.startsWith(&quot;Amble&quot;);</span>
<span class="line-removed">170 </span>
171         /* If any of the values is NaN then substitute the null scaler context.
172          * This will return null images, zero advance, and empty outlines
173          * as no rendering need take place in this case.
174          * We pass in the null scaler as the singleton null context
175          * requires it. However
176          */
177         if (Double.isNaN(matrix[0]) || Double.isNaN(matrix[1]) ||
178             Double.isNaN(matrix[2]) || Double.isNaN(matrix[3]) ||
179             fileFont.getScaler() == null) {
180             pScalerContext = NullFontScaler.getNullScalerContext();
181         } else {
182             pScalerContext = fileFont.getScaler().createScalerContext(matrix,
183                                     desc.aaHint, desc.fmHint,
<span class="line-modified">184                                     boldness, italic, disableHinting);</span>
185         }
186 
187         mapper = fileFont.getMapper();
188         int numGlyphs = mapper.getNumGlyphs();
189 
190         /* Always segment for fonts with &gt; 256 glyphs, but also for smaller
191          * fonts with non-typical sizes and transforms.
192          * Segmenting for all non-typical pt sizes helps to minimize memory
193          * usage when very many distinct strikes are created.
194          * The size range of 0-&gt;5 and 37-&gt;INF for segmenting is arbitrary
195          * but the intention is that typical GUI integer point sizes (6-&gt;36)
196          * should not segment unless there&#39;s another reason to do so.
197          */
198         float ptSize = (float)matrix[3]; // interpreted only when meaningful.
199         int iSize = intPtSize = (int)ptSize;
200         boolean isSimpleTx = (at.getType() &amp; complexTX) == 0;
201         segmentedCache =
202             (numGlyphs &gt; SEGSIZE &lt;&lt; 3) ||
203             ((numGlyphs &gt; SEGSIZE &lt;&lt; 1) &amp;&amp;
204              (!isSimpleTx || ptSize != iSize || iSize &lt; 6 || iSize &gt; 36));
</pre>
</td>
<td>
<hr />
<pre>
134                 algoStyle = true;
135                 italic = 0.7f;
136             }
137             if ((desc.style &amp; Font.BOLD) == Font.BOLD &amp;&amp;
138                 ((fileFont.style &amp; Font.BOLD) == 0)) {
139                 algoStyle = true;
140                 boldness = 1.33f;
141             }
142         }
143         double[] matrix = new double[4];
144         AffineTransform at = desc.glyphTx;
145         at.getMatrix(matrix);
146         if (!desc.devTx.isIdentity() &amp;&amp;
147             desc.devTx.getType() != AffineTransform.TYPE_TRANSLATION) {
148             try {
149                 invertDevTx = desc.devTx.createInverse();
150             } catch (NoninvertibleTransformException e) {
151             }
152         }
153 

















154         /* If any of the values is NaN then substitute the null scaler context.
155          * This will return null images, zero advance, and empty outlines
156          * as no rendering need take place in this case.
157          * We pass in the null scaler as the singleton null context
158          * requires it. However
159          */
160         if (Double.isNaN(matrix[0]) || Double.isNaN(matrix[1]) ||
161             Double.isNaN(matrix[2]) || Double.isNaN(matrix[3]) ||
162             fileFont.getScaler() == null) {
163             pScalerContext = NullFontScaler.getNullScalerContext();
164         } else {
165             pScalerContext = fileFont.getScaler().createScalerContext(matrix,
166                                     desc.aaHint, desc.fmHint,
<span class="line-modified">167                                     boldness, italic);</span>
168         }
169 
170         mapper = fileFont.getMapper();
171         int numGlyphs = mapper.getNumGlyphs();
172 
173         /* Always segment for fonts with &gt; 256 glyphs, but also for smaller
174          * fonts with non-typical sizes and transforms.
175          * Segmenting for all non-typical pt sizes helps to minimize memory
176          * usage when very many distinct strikes are created.
177          * The size range of 0-&gt;5 and 37-&gt;INF for segmenting is arbitrary
178          * but the intention is that typical GUI integer point sizes (6-&gt;36)
179          * should not segment unless there&#39;s another reason to do so.
180          */
181         float ptSize = (float)matrix[3]; // interpreted only when meaningful.
182         int iSize = intPtSize = (int)ptSize;
183         boolean isSimpleTx = (at.getType() &amp; complexTX) == 0;
184         segmentedCache =
185             (numGlyphs &gt; SEGSIZE &lt;&lt; 3) ||
186             ((numGlyphs &gt; SEGSIZE &lt;&lt; 1) &amp;&amp;
187              (!isSimpleTx || ptSize != iSize || iSize &lt; 6 || iSize &gt; 36));
</pre>
</td>
</tr>
</table>
<center><a href="../../javax/swing/text/html/FormView.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="FontScaler.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>