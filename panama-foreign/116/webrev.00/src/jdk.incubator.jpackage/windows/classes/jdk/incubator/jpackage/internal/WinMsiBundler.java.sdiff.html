<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.incubator.jpackage/windows/classes/jdk/incubator/jpackage/internal/WinMsiBundler.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../share/classes/jdk/incubator/jpackage/internal/resources/MainResources_zh_CN.properties.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../native/libapplauncher/WindowsPlatform.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.incubator.jpackage/windows/classes/jdk/incubator/jpackage/internal/WinMsiBundler.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
241                         &quot;message.tool-version&quot;), toolInfo.path.getFileName(),
242                         toolInfo.version));
243             }
244 
245             wixSourcesBuilder.setWixVersion(wixToolset.get(WixTool.Light).version);
246 
247             wixSourcesBuilder.logWixFeatures();
248 
249             /********* validate bundle parameters *************/
250 
251             String version = PRODUCT_VERSION.fetchFrom(params);
252             if (!isVersionStringValid(version)) {
253                 throw new ConfigException(
254                         MessageFormat.format(I18N.getString(
255                                 &quot;error.version-string-wrong-format&quot;), version),
256                         MessageFormat.format(I18N.getString(
257                                 &quot;error.version-string-wrong-format.advice&quot;),
258                                 PRODUCT_VERSION.getID()));
259             }
260 
<span class="line-modified">261             // only one mime type per association, at least one file extension</span>
<span class="line-removed">262             List&lt;Map&lt;String, ? super Object&gt;&gt; associations =</span>
<span class="line-removed">263                     FILE_ASSOCIATIONS.fetchFrom(params);</span>
<span class="line-removed">264             if (associations != null) {</span>
<span class="line-removed">265                 for (int i = 0; i &lt; associations.size(); i++) {</span>
<span class="line-removed">266                     Map&lt;String, ? super Object&gt; assoc = associations.get(i);</span>
<span class="line-removed">267                     List&lt;String&gt; mimes = FA_CONTENT_TYPE.fetchFrom(assoc);</span>
<span class="line-removed">268                     if (mimes.size() &gt; 1) {</span>
<span class="line-removed">269                         throw new ConfigException(MessageFormat.format(</span>
<span class="line-removed">270                                 I18N.getString(&quot;error.too-many-content-types-for-file-association&quot;), i),</span>
<span class="line-removed">271                                 I18N.getString(&quot;error.too-many-content-types-for-file-association.advice&quot;));</span>
<span class="line-removed">272                     }</span>
<span class="line-removed">273                 }</span>
<span class="line-removed">274             }</span>
275 
276             return true;
277         } catch (RuntimeException re) {
278             if (re.getCause() instanceof ConfigException) {
279                 throw (ConfigException) re.getCause();
280             } else {
281                 throw new ConfigException(re);
282             }
283         }
284     }
285 
286     // https://msdn.microsoft.com/en-us/library/aa370859%28v=VS.85%29.aspx
287     // The format of the string is as follows:
288     //     major.minor.build
289     // The first field is the major version and has a maximum value of 255.
290     // The second field is the minor version and has a maximum value of 255.
291     // The third field is called the build version or the update version and
292     // has a maximum value of 65,535.
293     static boolean isVersionStringValid(String v) {
294         if (v == null) {
</pre>
</td>
<td>
<hr />
<pre>
241                         &quot;message.tool-version&quot;), toolInfo.path.getFileName(),
242                         toolInfo.version));
243             }
244 
245             wixSourcesBuilder.setWixVersion(wixToolset.get(WixTool.Light).version);
246 
247             wixSourcesBuilder.logWixFeatures();
248 
249             /********* validate bundle parameters *************/
250 
251             String version = PRODUCT_VERSION.fetchFrom(params);
252             if (!isVersionStringValid(version)) {
253                 throw new ConfigException(
254                         MessageFormat.format(I18N.getString(
255                                 &quot;error.version-string-wrong-format&quot;), version),
256                         MessageFormat.format(I18N.getString(
257                                 &quot;error.version-string-wrong-format.advice&quot;),
258                                 PRODUCT_VERSION.getID()));
259             }
260 
<span class="line-modified">261             FileAssociation.verify(FileAssociation.fetchFrom(params));</span>













262 
263             return true;
264         } catch (RuntimeException re) {
265             if (re.getCause() instanceof ConfigException) {
266                 throw (ConfigException) re.getCause();
267             } else {
268                 throw new ConfigException(re);
269             }
270         }
271     }
272 
273     // https://msdn.microsoft.com/en-us/library/aa370859%28v=VS.85%29.aspx
274     // The format of the string is as follows:
275     //     major.minor.build
276     // The first field is the major version and has a maximum value of 255.
277     // The second field is the minor version and has a maximum value of 255.
278     // The third field is called the build version or the update version and
279     // has a maximum value of 65,535.
280     static boolean isVersionStringValid(String v) {
281         if (v == null) {
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../share/classes/jdk/incubator/jpackage/internal/resources/MainResources_zh_CN.properties.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../native/libapplauncher/WindowsPlatform.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>