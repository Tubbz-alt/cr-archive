<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/ModuleWriterImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MethodWriterImpl.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="NestedClassWriterImpl.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/ModuleWriterImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
207         Content moduleHead = new RawHtml(heading);
208         tHeading.add(moduleHead);
209         div.add(tHeading);
210         bodyContents.setHeader(headerContent)
211                 .addMainContent(div);
212         return bodyTree;
213     }
214 
215     /**
216      * Get the content header.
217      */
218     @Override
219     public Content getContentHeader() {
220         return new ContentBuilder();
221     }
222 
223     /**
224      * Get the summary section header.
225      */
226     @Override
<span class="line-modified">227     public Content getSummaryHeader() {</span>
<span class="line-modified">228         HtmlTree ul = new HtmlTree(TagName.UL);</span>
<span class="line-removed">229         ul.setStyle(HtmlStyle.blockList);</span>
<span class="line-removed">230         return ul;</span>
231     }
232 
233     /**
234      * Get the summary tree.
235      *
236      * @param summaryContentTree the content tree to be added to the summary tree.
237      */
238     @Override
239     public Content getSummaryTree(Content summaryContentTree) {
240         return HtmlTree.SECTION(HtmlStyle.summary, summaryContentTree);
241     }
242 
243     /**
244      * Compute the modules data that will be displayed in various tables on the module summary page.
245      */
246     public void computeModulesData() {
247         CommentHelper ch = utils.getCommentHelper(mdle);
248         // Get module dependencies using the module&#39;s transitive closure.
249         Map&lt;ModuleElement, String&gt; dependentModules = utils.getDependentModules(mdle);
250         // Add all dependent modules to indirect modules set. We will remove the modules,
</pre>
<hr />
<pre>
466 
467     /**
468      * Get a table, with three columns, with the second column being the defining column.
469      *
470      * @param caption the table caption
471      * @param tableSummary the summary for the table
472      * @param tableStyle the table style
473      * @param tableHeader the table header
474      * @return a content object
475      */
476     private Table getTable3(Content caption, String tableSummary, HtmlStyle tableStyle,
477             TableHeader tableHeader) {
478         return new Table(tableStyle)
479                 .setCaption(caption)
480                 .setHeader(tableHeader)
481                 .setRowScopeColumn(1)
482                 .setColumnStyles(HtmlStyle.colFirst, HtmlStyle.colSecond, HtmlStyle.colLast);
483     }
484 
485     @Override
<span class="line-modified">486     public void addModulesSummary(Content summaryContentTree) {</span>
487         if (display(requires) || display(indirectModules)) {
488             TableHeader requiresTableHeader =
489                     new TableHeader(contents.modifierLabel, contents.moduleLabel,
490                             contents.descriptionLabel);
491             HtmlTree section = HtmlTree.SECTION(HtmlStyle.modulesSummary)
492                     .setId(SectionName.MODULES.getName());
493             addSummaryHeader(MarkerComments.START_OF_MODULES_SUMMARY, contents.navModules, section);
494             if (display(requires)) {
495                 String text = resources.getText(&quot;doclet.Requires_Summary&quot;);
496                 String tableSummary = resources.getText(&quot;doclet.Member_Table_Summary&quot;,
497                         text,
498                         resources.getText(&quot;doclet.modules&quot;));
499                 Content caption = getTableCaption(new StringContent(text));
500                 Table table = getTable3(caption, tableSummary, HtmlStyle.requiresSummary,
501                             requiresTableHeader);
502                 addModulesList(requires, table);
503                 section.add(table);
504             }
505             // Display indirect modules table in both &quot;api&quot; and &quot;all&quot; mode.
506             if (display(indirectModules)) {
507                 String amrText = resources.getText(&quot;doclet.Indirect_Requires_Summary&quot;);
508                 String amrTableSummary = resources.getText(&quot;doclet.Member_Table_Summary&quot;,
509                         amrText,
510                         resources.getText(&quot;doclet.modules&quot;));
511                 Content amrCaption = getTableCaption(new StringContent(amrText));
512                 Table amrTable = getTable3(amrCaption, amrTableSummary, HtmlStyle.requiresSummary,
513                             requiresTableHeader);
514                 addModulesList(indirectModules, amrTable);
515                 section.add(amrTable);
516             }
<span class="line-modified">517             summaryContentTree.add(HtmlTree.LI(section));</span>
518         }
519     }
520 
521     /**
522      * Add the list of modules.
523      *
524      * @param mdleMap map of modules and modifiers
525      * @param table the table to which the list will be added
526      */
527     private void addModulesList(Map&lt;ModuleElement, Content&gt; mdleMap, Table table) {
528         for (ModuleElement m : mdleMap.keySet()) {
529             Content modifiers = mdleMap.get(m);
530             Content moduleLink = getModuleLink(m, new StringContent(m.getQualifiedName()));
531             Content moduleSummary = new ContentBuilder();
532             addSummaryComment(m, moduleSummary);
533             table.addRow(modifiers, moduleLink, moduleSummary);
534         }
535     }
536 
537     @Override
<span class="line-modified">538     public void addPackagesSummary(Content summaryContentTree) {</span>
539         if (display(packages)
540                 || display(indirectPackages) || display(indirectOpenPackages)) {
541             HtmlTree section = HtmlTree.SECTION(HtmlStyle.packagesSummary)
542                     .setId(SectionName.PACKAGES.getName());;
543             addSummaryHeader(MarkerComments.START_OF_PACKAGES_SUMMARY, contents.navPackages, section);
544             if (display(packages)) {
545                 addPackageSummary(section);
546             }
547             TableHeader indirectPackagesHeader =
548                     new TableHeader(contents.fromLabel, contents.packagesLabel);
549             if (display(indirectPackages)) {
550                 String aepText = resources.getText(&quot;doclet.Indirect_Exports_Summary&quot;);
551                 Table aepTable = getTable2(new StringContent(aepText),
552                         HtmlStyle.packagesSummary, indirectPackagesHeader);
553                 addIndirectPackages(aepTable, indirectPackages);
554                 section.add(aepTable);
555             }
556             if (display(indirectOpenPackages)) {
557                 String aopText = resources.getText(&quot;doclet.Indirect_Opens_Summary&quot;);
558                 Table aopTable = getTable2(new StringContent(aopText), HtmlStyle.packagesSummary,
559                         indirectPackagesHeader);
560                 addIndirectPackages(aopTable, indirectOpenPackages);
561                 section.add(aopTable);
562             }
<span class="line-modified">563             summaryContentTree.add(HtmlTree.LI(section));</span>
564         }
565     }
566 
567     /**
568      * Add the package summary for the module.
569      *
570      * @param li
571      */
572     public void addPackageSummary(HtmlTree li) {
573         Table table = new Table(HtmlStyle.packagesSummary)
574                 .setDefaultTab(resources.getText(&quot;doclet.All_Packages&quot;))
575                 .addTab(resources.getText(&quot;doclet.Exported_Packages_Summary&quot;), this::isExported)
576                 .addTab(resources.getText(&quot;doclet.Opened_Packages_Summary&quot;), this::isOpened)
577                 .addTab(resources.getText(&quot;doclet.Concealed_Packages_Summary&quot;), this::isConcealed)
578                 .setTabScript(i -&gt; String.format(&quot;show(%d);&quot;, i));
579 
580         // Determine whether to show the &quot;Exported To&quot; and &quot;Opened To&quot; columns,
581         // based on whether such columns would provide &quot;useful&quot; info.
582         int numExports = 0;
583         int numUnqualifiedExports = 0;
</pre>
<hr />
<pre>
689      * @param table the table to which the content rows will be added
690      * @param ip indirect packages to be added
691      */
692     public void addIndirectPackages(Table table, Map&lt;ModuleElement, SortedSet&lt;PackageElement&gt;&gt; ip) {
693         for (Map.Entry&lt;ModuleElement, SortedSet&lt;PackageElement&gt;&gt; entry : ip.entrySet()) {
694             ModuleElement m = entry.getKey();
695             SortedSet&lt;PackageElement&gt; pkgList = entry.getValue();
696             Content moduleLinkContent = getModuleLink(m, new StringContent(m.getQualifiedName()));
697             Content list = new ContentBuilder();
698             String sep = &quot;&quot;;
699             for (PackageElement pkg : pkgList) {
700                 list.add(sep);
701                 list.add(getPackageLink(pkg, new StringContent(utils.getPackageName(pkg))));
702                 sep = &quot; &quot;;
703             }
704             table.addRow(moduleLinkContent, list);
705         }
706     }
707 
708     @Override
<span class="line-modified">709     public void addServicesSummary(Content summaryContentTree) {</span>
710 
711         boolean haveUses = displayServices(uses, usesTrees);
712         boolean haveProvides = displayServices(provides.keySet(), providesTrees);
713 
714         if (haveProvides || haveUses) {
715             HtmlTree section = HtmlTree.SECTION(HtmlStyle.servicesSummary)
716                     .setId(SectionName.SERVICES.getName());
717             addSummaryHeader(MarkerComments.START_OF_SERVICES_SUMMARY, contents.navServices, section);
718             TableHeader usesProvidesTableHeader =
719                     new TableHeader(contents.typeLabel, contents.descriptionLabel);
720             if (haveProvides) {
721                 String label = resources.getText(&quot;doclet.Provides_Summary&quot;);
722                 Table table = getTable2(new StringContent(label), HtmlStyle.providesSummary,
723                         usesProvidesTableHeader);
724                 addProvidesList(table);
725                 if (!table.isEmpty()) {
726                     section.add(table);
727                 }
728             }
729             if (haveUses){
730                 String label = resources.getText(&quot;doclet.Uses_Summary&quot;);
731                 Table table = getTable2(new StringContent(label), HtmlStyle.usesSummary,
732                         usesProvidesTableHeader);
733                 addUsesList(table);
734                 if (!table.isEmpty()) {
735                     section.add(table);
736                 }
737             }
<span class="line-modified">738             summaryContentTree.add(HtmlTree.LI(section));</span>
739         }
740     }
741 
742     /**
743      * Add the uses list for the module.
744      *
745      * @param table the table to which the services used will be added
746      */
747     public void addUsesList(Table table) {
748         Content typeLinkContent;
749         Content description;
750         for (TypeElement t : uses) {
751             if (!displayServiceDirective(t, usesTrees)) {
752                 continue;
753             }
754             typeLinkContent = getLink(new LinkInfoImpl(configuration, LinkInfoImpl.Kind.PACKAGE, t));
755             Content summary = new ContentBuilder();
756             if (display(usesTrees)) {
757                 description = usesTrees.get(t);
758                 if (description != null &amp;&amp; !description.isEmpty()) {
</pre>
</td>
<td>
<hr />
<pre>
207         Content moduleHead = new RawHtml(heading);
208         tHeading.add(moduleHead);
209         div.add(tHeading);
210         bodyContents.setHeader(headerContent)
211                 .addMainContent(div);
212         return bodyTree;
213     }
214 
215     /**
216      * Get the content header.
217      */
218     @Override
219     public Content getContentHeader() {
220         return new ContentBuilder();
221     }
222 
223     /**
224      * Get the summary section header.
225      */
226     @Override
<span class="line-modified">227     public Content getSummariesList() {</span>
<span class="line-modified">228         return new HtmlTree(TagName.UL).setStyle(HtmlStyle.summaryList);</span>


229     }
230 
231     /**
232      * Get the summary tree.
233      *
234      * @param summaryContentTree the content tree to be added to the summary tree.
235      */
236     @Override
237     public Content getSummaryTree(Content summaryContentTree) {
238         return HtmlTree.SECTION(HtmlStyle.summary, summaryContentTree);
239     }
240 
241     /**
242      * Compute the modules data that will be displayed in various tables on the module summary page.
243      */
244     public void computeModulesData() {
245         CommentHelper ch = utils.getCommentHelper(mdle);
246         // Get module dependencies using the module&#39;s transitive closure.
247         Map&lt;ModuleElement, String&gt; dependentModules = utils.getDependentModules(mdle);
248         // Add all dependent modules to indirect modules set. We will remove the modules,
</pre>
<hr />
<pre>
464 
465     /**
466      * Get a table, with three columns, with the second column being the defining column.
467      *
468      * @param caption the table caption
469      * @param tableSummary the summary for the table
470      * @param tableStyle the table style
471      * @param tableHeader the table header
472      * @return a content object
473      */
474     private Table getTable3(Content caption, String tableSummary, HtmlStyle tableStyle,
475             TableHeader tableHeader) {
476         return new Table(tableStyle)
477                 .setCaption(caption)
478                 .setHeader(tableHeader)
479                 .setRowScopeColumn(1)
480                 .setColumnStyles(HtmlStyle.colFirst, HtmlStyle.colSecond, HtmlStyle.colLast);
481     }
482 
483     @Override
<span class="line-modified">484     public void addModulesSummary(Content summariesList) {</span>
485         if (display(requires) || display(indirectModules)) {
486             TableHeader requiresTableHeader =
487                     new TableHeader(contents.modifierLabel, contents.moduleLabel,
488                             contents.descriptionLabel);
489             HtmlTree section = HtmlTree.SECTION(HtmlStyle.modulesSummary)
490                     .setId(SectionName.MODULES.getName());
491             addSummaryHeader(MarkerComments.START_OF_MODULES_SUMMARY, contents.navModules, section);
492             if (display(requires)) {
493                 String text = resources.getText(&quot;doclet.Requires_Summary&quot;);
494                 String tableSummary = resources.getText(&quot;doclet.Member_Table_Summary&quot;,
495                         text,
496                         resources.getText(&quot;doclet.modules&quot;));
497                 Content caption = getTableCaption(new StringContent(text));
498                 Table table = getTable3(caption, tableSummary, HtmlStyle.requiresSummary,
499                             requiresTableHeader);
500                 addModulesList(requires, table);
501                 section.add(table);
502             }
503             // Display indirect modules table in both &quot;api&quot; and &quot;all&quot; mode.
504             if (display(indirectModules)) {
505                 String amrText = resources.getText(&quot;doclet.Indirect_Requires_Summary&quot;);
506                 String amrTableSummary = resources.getText(&quot;doclet.Member_Table_Summary&quot;,
507                         amrText,
508                         resources.getText(&quot;doclet.modules&quot;));
509                 Content amrCaption = getTableCaption(new StringContent(amrText));
510                 Table amrTable = getTable3(amrCaption, amrTableSummary, HtmlStyle.requiresSummary,
511                             requiresTableHeader);
512                 addModulesList(indirectModules, amrTable);
513                 section.add(amrTable);
514             }
<span class="line-modified">515             summariesList.add(HtmlTree.LI(section));</span>
516         }
517     }
518 
519     /**
520      * Add the list of modules.
521      *
522      * @param mdleMap map of modules and modifiers
523      * @param table the table to which the list will be added
524      */
525     private void addModulesList(Map&lt;ModuleElement, Content&gt; mdleMap, Table table) {
526         for (ModuleElement m : mdleMap.keySet()) {
527             Content modifiers = mdleMap.get(m);
528             Content moduleLink = getModuleLink(m, new StringContent(m.getQualifiedName()));
529             Content moduleSummary = new ContentBuilder();
530             addSummaryComment(m, moduleSummary);
531             table.addRow(modifiers, moduleLink, moduleSummary);
532         }
533     }
534 
535     @Override
<span class="line-modified">536     public void addPackagesSummary(Content summariesList) {</span>
537         if (display(packages)
538                 || display(indirectPackages) || display(indirectOpenPackages)) {
539             HtmlTree section = HtmlTree.SECTION(HtmlStyle.packagesSummary)
540                     .setId(SectionName.PACKAGES.getName());;
541             addSummaryHeader(MarkerComments.START_OF_PACKAGES_SUMMARY, contents.navPackages, section);
542             if (display(packages)) {
543                 addPackageSummary(section);
544             }
545             TableHeader indirectPackagesHeader =
546                     new TableHeader(contents.fromLabel, contents.packagesLabel);
547             if (display(indirectPackages)) {
548                 String aepText = resources.getText(&quot;doclet.Indirect_Exports_Summary&quot;);
549                 Table aepTable = getTable2(new StringContent(aepText),
550                         HtmlStyle.packagesSummary, indirectPackagesHeader);
551                 addIndirectPackages(aepTable, indirectPackages);
552                 section.add(aepTable);
553             }
554             if (display(indirectOpenPackages)) {
555                 String aopText = resources.getText(&quot;doclet.Indirect_Opens_Summary&quot;);
556                 Table aopTable = getTable2(new StringContent(aopText), HtmlStyle.packagesSummary,
557                         indirectPackagesHeader);
558                 addIndirectPackages(aopTable, indirectOpenPackages);
559                 section.add(aopTable);
560             }
<span class="line-modified">561             summariesList.add(HtmlTree.LI(section));</span>
562         }
563     }
564 
565     /**
566      * Add the package summary for the module.
567      *
568      * @param li
569      */
570     public void addPackageSummary(HtmlTree li) {
571         Table table = new Table(HtmlStyle.packagesSummary)
572                 .setDefaultTab(resources.getText(&quot;doclet.All_Packages&quot;))
573                 .addTab(resources.getText(&quot;doclet.Exported_Packages_Summary&quot;), this::isExported)
574                 .addTab(resources.getText(&quot;doclet.Opened_Packages_Summary&quot;), this::isOpened)
575                 .addTab(resources.getText(&quot;doclet.Concealed_Packages_Summary&quot;), this::isConcealed)
576                 .setTabScript(i -&gt; String.format(&quot;show(%d);&quot;, i));
577 
578         // Determine whether to show the &quot;Exported To&quot; and &quot;Opened To&quot; columns,
579         // based on whether such columns would provide &quot;useful&quot; info.
580         int numExports = 0;
581         int numUnqualifiedExports = 0;
</pre>
<hr />
<pre>
687      * @param table the table to which the content rows will be added
688      * @param ip indirect packages to be added
689      */
690     public void addIndirectPackages(Table table, Map&lt;ModuleElement, SortedSet&lt;PackageElement&gt;&gt; ip) {
691         for (Map.Entry&lt;ModuleElement, SortedSet&lt;PackageElement&gt;&gt; entry : ip.entrySet()) {
692             ModuleElement m = entry.getKey();
693             SortedSet&lt;PackageElement&gt; pkgList = entry.getValue();
694             Content moduleLinkContent = getModuleLink(m, new StringContent(m.getQualifiedName()));
695             Content list = new ContentBuilder();
696             String sep = &quot;&quot;;
697             for (PackageElement pkg : pkgList) {
698                 list.add(sep);
699                 list.add(getPackageLink(pkg, new StringContent(utils.getPackageName(pkg))));
700                 sep = &quot; &quot;;
701             }
702             table.addRow(moduleLinkContent, list);
703         }
704     }
705 
706     @Override
<span class="line-modified">707     public void addServicesSummary(Content summariesList) {</span>
708 
709         boolean haveUses = displayServices(uses, usesTrees);
710         boolean haveProvides = displayServices(provides.keySet(), providesTrees);
711 
712         if (haveProvides || haveUses) {
713             HtmlTree section = HtmlTree.SECTION(HtmlStyle.servicesSummary)
714                     .setId(SectionName.SERVICES.getName());
715             addSummaryHeader(MarkerComments.START_OF_SERVICES_SUMMARY, contents.navServices, section);
716             TableHeader usesProvidesTableHeader =
717                     new TableHeader(contents.typeLabel, contents.descriptionLabel);
718             if (haveProvides) {
719                 String label = resources.getText(&quot;doclet.Provides_Summary&quot;);
720                 Table table = getTable2(new StringContent(label), HtmlStyle.providesSummary,
721                         usesProvidesTableHeader);
722                 addProvidesList(table);
723                 if (!table.isEmpty()) {
724                     section.add(table);
725                 }
726             }
727             if (haveUses){
728                 String label = resources.getText(&quot;doclet.Uses_Summary&quot;);
729                 Table table = getTable2(new StringContent(label), HtmlStyle.usesSummary,
730                         usesProvidesTableHeader);
731                 addUsesList(table);
732                 if (!table.isEmpty()) {
733                     section.add(table);
734                 }
735             }
<span class="line-modified">736             summariesList.add(HtmlTree.LI(section));</span>
737         }
738     }
739 
740     /**
741      * Add the uses list for the module.
742      *
743      * @param table the table to which the services used will be added
744      */
745     public void addUsesList(Table table) {
746         Content typeLinkContent;
747         Content description;
748         for (TypeElement t : uses) {
749             if (!displayServiceDirective(t, usesTrees)) {
750                 continue;
751             }
752             typeLinkContent = getLink(new LinkInfoImpl(configuration, LinkInfoImpl.Kind.PACKAGE, t));
753             Content summary = new ContentBuilder();
754             if (display(usesTrees)) {
755                 description = usesTrees.get(t);
756                 if (description != null &amp;&amp; !description.isEmpty()) {
</pre>
</td>
</tr>
</table>
<center><a href="MethodWriterImpl.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="NestedClassWriterImpl.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>