<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/ui/SourceCodePanel.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="SAPanel.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="action/FindAction.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/ui/SourceCodePanel.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2001, 2002, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2001, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 24,10 ***</span>
<span class="line-new-header">--- 24,11 ---</span>
  
  package sun.jvm.hotspot.ui;
  
  import java.awt.*;
  import java.awt.event.*;
<span class="line-added">+ import java.awt.geom.Rectangle2D;</span>
  import java.io.*;
  import java.net.*;
  import java.util.*;
  import javax.swing.*;
  import javax.swing.text.BadLocationException;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 48,11 ***</span>
    private static Icon topFrameCurLine;
    private static Icon lowerFrameCurLine;
    private static Icon breakpoint;
    // State
    private int highlightedLine = -1;
<span class="line-modified">!   private Set/*&lt;Integer&gt;*/ breakpoints = new HashSet(); // Zero-based lines internally</span>
    // Parent Editor container and EditorCommands object for setting breakpoints
    private EditorCommands comm;
    private Editor parent;
  
    /** Support for displaying icons and line numbers in row header of
<span class="line-new-header">--- 49,11 ---</span>
    private static Icon topFrameCurLine;
    private static Icon lowerFrameCurLine;
    private static Icon breakpoint;
    // State
    private int highlightedLine = -1;
<span class="line-modified">!   private Set&lt;Integer&gt; breakpoints = new HashSet&lt;&gt;(); // Zero-based lines internally</span>
    // Parent Editor container and EditorCommands object for setting breakpoints
    private EditorCommands comm;
    private Editor parent;
  
    /** Support for displaying icons and line numbers in row header of
</pre>
<hr />
<pre>
<span class="line-old-header">*** 93,11 ***</span>
            String str = Integer.toString(i + 1);
            int strWidth = GraphicsUtilities.getStringWidth(str, fm);
            g.drawString(str, width - strWidth - LINE_NO_SPACE, ascent + rowHeight * i);
  
            // Draw breakpoint if necessary
<span class="line-modified">!           if (breakpoints.contains(new Integer(i))) {</span>
              breakpoint.paintIcon(this, g, LINE_NO_SPACE, rowHeight * i);
            }
  
            // Draw current line icon if necessary
            if (i == highlightedLine) {
<span class="line-new-header">--- 94,11 ---</span>
            String str = Integer.toString(i + 1);
            int strWidth = GraphicsUtilities.getStringWidth(str, fm);
            g.drawString(str, width - strWidth - LINE_NO_SPACE, ascent + rowHeight * i);
  
            // Draw breakpoint if necessary
<span class="line-modified">!           if (breakpoints.contains(i)) {</span>
              breakpoint.paintIcon(this, g, LINE_NO_SPACE, rowHeight * i);
            }
  
            // Draw current line icon if necessary
            if (i == highlightedLine) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 253,14 ***</span>
  
    /** Line number is one-based */
    public void showLineNumber(int lineNo) {
      try {
        int offset = source.getLineStartOffset(lineNo - 1);
<span class="line-modified">!       Rectangle rect = source.modelToView(offset);</span>
<span class="line-modified">!       if (rect == null) {</span>
          return;
        }
        source.scrollRectToVisible(rect);
      } catch (BadLocationException e) {
        e.printStackTrace();
      }
    }
<span class="line-new-header">--- 254,16 ---</span>
  
    /** Line number is one-based */
    public void showLineNumber(int lineNo) {
      try {
        int offset = source.getLineStartOffset(lineNo - 1);
<span class="line-modified">!       Rectangle2D rect2d = source.modelToView2D(offset);</span>
<span class="line-modified">!       if (rect2d == null) {</span>
          return;
        }
<span class="line-added">+       Rectangle rect = new Rectangle((int) rect2d.getX(), (int) rect2d.getY(),</span>
<span class="line-added">+               (int) rect2d.getWidth(), (int) rect2d.getHeight());</span>
        source.scrollRectToVisible(rect);
      } catch (BadLocationException e) {
        e.printStackTrace();
      }
    }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 268,13 ***</span>
    /** Line number is one-based */
    public void highlightLineNumber(int lineNo) {
      highlightedLine = lineNo - 1;
    }
  
<span class="line-modified">!   public void showBreakpointAtLine(int lineNo)  { breakpoints.add(new Integer(lineNo - 1));    repaint(); }</span>
<span class="line-modified">!   public boolean hasBreakpointAtLine(int lineNo){ return breakpoints.contains(new Integer(lineNo - 1));   }</span>
<span class="line-modified">!   public void clearBreakpointAtLine(int lineNo) { breakpoints.remove(new Integer(lineNo - 1)); repaint(); }</span>
    public void clearBreakpoints()                { breakpoints.clear();                         repaint(); }
  
    public void setEditorCommands(EditorCommands comm, Editor parent) {
      this.comm = comm;
      this.parent = parent;
<span class="line-new-header">--- 271,13 ---</span>
    /** Line number is one-based */
    public void highlightLineNumber(int lineNo) {
      highlightedLine = lineNo - 1;
    }
  
<span class="line-modified">!   public void showBreakpointAtLine(int lineNo)  { breakpoints.add(lineNo - 1);    repaint(); }</span>
<span class="line-modified">!   public boolean hasBreakpointAtLine(int lineNo){ return breakpoints.contains(lineNo - 1);   }</span>
<span class="line-modified">!   public void clearBreakpointAtLine(int lineNo) { breakpoints.remove(lineNo - 1); repaint(); }</span>
    public void clearBreakpoints()                { breakpoints.clear();                         repaint(); }
  
    public void setEditorCommands(EditorCommands comm, Editor parent) {
      this.comm = comm;
      this.parent = parent;
</pre>
<center><a href="SAPanel.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="action/FindAction.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>