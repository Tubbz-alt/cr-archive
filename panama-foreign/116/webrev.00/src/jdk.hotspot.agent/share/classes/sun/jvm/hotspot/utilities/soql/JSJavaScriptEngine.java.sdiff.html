<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/utilities/soql/JSJavaScriptEngine.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="JSJavaMethod.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="JSJavaThread.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/utilities/soql/JSJavaScriptEngine.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2004, 2012, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  *
</pre>
<hr />
<pre>
223         println(&quot;identityHash(jobject)    returns the hashCode of the Java object&quot;);
224         println(&quot;mirror(jobject)          returns a local mirror of the Java object&quot;);
225         println(&quot;load([file1, file2,...]) loads JavaScript file(s). With no files, reads &lt;stdin&gt;&quot;);
226         println(&quot;object(string)           converts a string address into Java object&quot;);
227         println(&quot;owner(jobject)           returns the owner thread of this monitor or null&quot;);
228         println(&quot;sizeof(jobject)          returns the size of Java object in bytes&quot;);
229         println(&quot;staticof(jclass, field)  returns a static field of the given Java class&quot;);
230         println(&quot;read([prompt])           reads a single line from standard input&quot;);
231         println(&quot;quit()                   quits the interactive load call&quot;);
232         println(&quot;jvm                      the target jvm that is being debugged&quot;);
233     }
234 
235     /**
236        identityHash function gets identity hash code value of given
237        JSJavaObject. For other type of objects, the result is undefined.
238     */
239     public Object identityHash(Object[] args) {
240         if (args.length != 1) return UNDEFINED;
241         Object o = args[0];
242         if (o != null &amp;&amp; o instanceof JSJavaObject) {
<span class="line-modified">243             return new Long(((JSJavaObject)o).getOop().identityHash());</span>
244         } else {
245             return UNDEFINED;
246         }
247     }
248 
249 
250     /**
251      * Load and execute a set of JavaScript source files.
252      * This method is defined as a JavaScript function.
253      */
254     public void load(Object[] args) {
255        for (int i = 0; i &lt; args.length; i++) {
256          processSource(args[i].toString());
257        }
258     }
259 
260     /**
261        mirror function creats local copy of the Oop wrapper supplied.
262        if mirror can not be created, return undefined. For other types,
263        mirror is undefined.
</pre>
<hr />
<pre>
307     public Object object(Object[] args) {
308         Object o = args[0];
309         if (o != null &amp;&amp; o instanceof String) {
310             VM vm = VM.getVM();
311             Address addr = vm.getDebugger().parseAddress((String)o);
312             Oop oop = vm.getObjectHeap().newOop(addr.addOffsetToAsOopHandle(0));
313             return getJSJavaFactory().newJSJavaObject(oop);
314         } else {
315             return UNDEFINED;
316         }
317     }
318 
319     /**
320        sizeof function returns size of a Java object in bytes. For other type
321        of objects, the result is undefined.
322     */
323     public Object sizeof(Object[] args) {
324         if (args.length != 1) return UNDEFINED;
325         Object o = args[0];
326         if (o != null &amp;&amp; o instanceof JSJavaObject) {
<span class="line-modified">327             return new Long(((JSJavaObject)o).getOop().getObjectSize());</span>
328         } else {
329             return UNDEFINED;
330         }
331     }
332 
333     /**
334        staticof function gets static field of given class. Both class and
335        field name are specified as strings. undefined is returned if there is
336        no such named field.
337     */
338     public Object staticof(Object[] args) {
339         Object classname = args[0];
340         Object fieldname = args[1];
341         if (fieldname == null || classname == null ||
342             !(fieldname instanceof String)) {
343             return UNDEFINED;
344         }
345 
346         InstanceKlass ik = null;
347         if (classname instanceof JSJavaClass) {
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2004, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  *
</pre>
<hr />
<pre>
223         println(&quot;identityHash(jobject)    returns the hashCode of the Java object&quot;);
224         println(&quot;mirror(jobject)          returns a local mirror of the Java object&quot;);
225         println(&quot;load([file1, file2,...]) loads JavaScript file(s). With no files, reads &lt;stdin&gt;&quot;);
226         println(&quot;object(string)           converts a string address into Java object&quot;);
227         println(&quot;owner(jobject)           returns the owner thread of this monitor or null&quot;);
228         println(&quot;sizeof(jobject)          returns the size of Java object in bytes&quot;);
229         println(&quot;staticof(jclass, field)  returns a static field of the given Java class&quot;);
230         println(&quot;read([prompt])           reads a single line from standard input&quot;);
231         println(&quot;quit()                   quits the interactive load call&quot;);
232         println(&quot;jvm                      the target jvm that is being debugged&quot;);
233     }
234 
235     /**
236        identityHash function gets identity hash code value of given
237        JSJavaObject. For other type of objects, the result is undefined.
238     */
239     public Object identityHash(Object[] args) {
240         if (args.length != 1) return UNDEFINED;
241         Object o = args[0];
242         if (o != null &amp;&amp; o instanceof JSJavaObject) {
<span class="line-modified">243             return ((JSJavaObject) o).getOop().identityHash();</span>
244         } else {
245             return UNDEFINED;
246         }
247     }
248 
249 
250     /**
251      * Load and execute a set of JavaScript source files.
252      * This method is defined as a JavaScript function.
253      */
254     public void load(Object[] args) {
255        for (int i = 0; i &lt; args.length; i++) {
256          processSource(args[i].toString());
257        }
258     }
259 
260     /**
261        mirror function creats local copy of the Oop wrapper supplied.
262        if mirror can not be created, return undefined. For other types,
263        mirror is undefined.
</pre>
<hr />
<pre>
307     public Object object(Object[] args) {
308         Object o = args[0];
309         if (o != null &amp;&amp; o instanceof String) {
310             VM vm = VM.getVM();
311             Address addr = vm.getDebugger().parseAddress((String)o);
312             Oop oop = vm.getObjectHeap().newOop(addr.addOffsetToAsOopHandle(0));
313             return getJSJavaFactory().newJSJavaObject(oop);
314         } else {
315             return UNDEFINED;
316         }
317     }
318 
319     /**
320        sizeof function returns size of a Java object in bytes. For other type
321        of objects, the result is undefined.
322     */
323     public Object sizeof(Object[] args) {
324         if (args.length != 1) return UNDEFINED;
325         Object o = args[0];
326         if (o != null &amp;&amp; o instanceof JSJavaObject) {
<span class="line-modified">327             return ((JSJavaObject) o).getOop().getObjectSize();</span>
328         } else {
329             return UNDEFINED;
330         }
331     }
332 
333     /**
334        staticof function gets static field of given class. Both class and
335        field name are specified as strings. undefined is returned if there is
336        no such named field.
337     */
338     public Object staticof(Object[] args) {
339         Object classname = args[0];
340         Object fieldname = args[1];
341         if (fieldname == null || classname == null ||
342             !(fieldname instanceof String)) {
343             return UNDEFINED;
344         }
345 
346         InstanceKlass ik = null;
347         if (classname instanceof JSJavaClass) {
</pre>
</td>
</tr>
</table>
<center><a href="JSJavaMethod.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="JSJavaThread.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>