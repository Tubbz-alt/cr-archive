<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/oops/InstanceKlass.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="InstanceClassLoaderKlass.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="InstanceMirrorKlass.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/oops/InstanceKlass.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 31,10 ***</span>
<span class="line-new-header">--- 31,12 ---</span>
  import sun.jvm.hotspot.memory.*;
  import sun.jvm.hotspot.memory.Dictionary;
  import sun.jvm.hotspot.runtime.*;
  import sun.jvm.hotspot.types.*;
  import sun.jvm.hotspot.utilities.*;
<span class="line-added">+ import sun.jvm.hotspot.utilities.Observable;</span>
<span class="line-added">+ import sun.jvm.hotspot.utilities.Observer;</span>
  
  // An InstanceKlass is the VM level representation of a Java class.
  
  public class InstanceKlass extends Klass {
    static {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 680,18 ***</span>
    }
  
    public Field[] getStaticFields() {
      U2Array fields = getFields();
      int length = getJavaFieldsCount();
<span class="line-modified">!     ArrayList result = new ArrayList();</span>
      for (int index = 0; index &lt; length; index++) {
        Field f = newField(index);
        if (f.isStatic()) {
          result.add(f);
        }
      }
<span class="line-modified">!     return (Field[])result.toArray(new Field[result.size()]);</span>
    }
  
    public void iterateNonStaticFields(OopVisitor visitor, Oop obj) {
      if (getSuper() != null) {
        ((InstanceKlass) getSuper()).iterateNonStaticFields(visitor, obj);
<span class="line-new-header">--- 682,18 ---</span>
    }
  
    public Field[] getStaticFields() {
      U2Array fields = getFields();
      int length = getJavaFieldsCount();
<span class="line-modified">!     ArrayList&lt;Field&gt; result = new ArrayList&lt;&gt;();</span>
      for (int index = 0; index &lt; length; index++) {
        Field f = newField(index);
        if (f.isStatic()) {
          result.add(f);
        }
      }
<span class="line-modified">!     return result.toArray(new Field[result.size()]);</span>
    }
  
    public void iterateNonStaticFields(OopVisitor visitor, Oop obj) {
      if (getSuper() != null) {
        ((InstanceKlass) getSuper()).iterateNonStaticFields(visitor, obj);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 782,15 ***</span>
  
      /** Return a List of SA Fields for the fields declared in this class.
          Inherited fields are not included.
          Return an empty list if there are no fields declared in this class.
          Only designed for use in a debugging system. */
<span class="line-modified">!     public List getImmediateFields() {</span>
          // A list of Fields for each field declared in this class/interface,
          // not including inherited fields.
          int length = getJavaFieldsCount();
<span class="line-modified">!         List immediateFields = new ArrayList(length);</span>
          for (int index = 0; index &lt; length; index++) {
              immediateFields.add(getFieldByIndex(index));
          }
  
          return immediateFields;
<span class="line-new-header">--- 784,15 ---</span>
  
      /** Return a List of SA Fields for the fields declared in this class.
          Inherited fields are not included.
          Return an empty list if there are no fields declared in this class.
          Only designed for use in a debugging system. */
<span class="line-modified">!     public List&lt;Field&gt; getImmediateFields() {</span>
          // A list of Fields for each field declared in this class/interface,
          // not including inherited fields.
          int length = getJavaFieldsCount();
<span class="line-modified">!         List&lt;Field&gt; immediateFields = new ArrayList&lt;&gt;(length);</span>
          for (int index = 0; index &lt; length; index++) {
              immediateFields.add(getFieldByIndex(index));
          }
  
          return immediateFields;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 800,14 ***</span>
          including all inherited fields.  This includes hidden
          fields.  Thus the returned list can contain fields with
          the same name.
          Return an empty list if there are no fields.
          Only designed for use in a debugging system. */
<span class="line-modified">!     public List getAllFields() {</span>
          // Contains a Field for each field in this class, including immediate
          // fields and inherited fields.
<span class="line-modified">!         List  allFields = getImmediateFields();</span>
  
          // transitiveInterfaces contains all interfaces implemented
          // by this class and its superclass chain with no duplicates.
  
          KlassArray interfaces = getTransitiveInterfaces();
<span class="line-new-header">--- 802,14 ---</span>
          including all inherited fields.  This includes hidden
          fields.  Thus the returned list can contain fields with
          the same name.
          Return an empty list if there are no fields.
          Only designed for use in a debugging system. */
<span class="line-modified">!     public List&lt;Field&gt; getAllFields() {</span>
          // Contains a Field for each field in this class, including immediate
          // fields and inherited fields.
<span class="line-modified">!         List&lt;Field&gt; allFields = getImmediateFields();</span>
  
          // transitiveInterfaces contains all interfaces implemented
          // by this class and its superclass chain with no duplicates.
  
          KlassArray interfaces = getTransitiveInterfaces();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 836,17 ***</span>
  
      /** Return a List of SA Methods declared directly in this class/interface.
          Return an empty list if there are none, or if this isn&#39;t a class/
          interface.
      */
<span class="line-modified">!     public List getImmediateMethods() {</span>
        // Contains a Method for each method declared in this class/interface
        // not including inherited methods.
  
        MethodArray methods = getMethods();
        int length = methods.length();
<span class="line-modified">!       Object[] tmp = new Object[length];</span>
  
        IntArray methodOrdering = getMethodOrdering();
        if (methodOrdering.length() != length) {
           // no ordering info present
           for (int index = 0; index &lt; length; index++) {
<span class="line-new-header">--- 838,17 ---</span>
  
      /** Return a List of SA Methods declared directly in this class/interface.
          Return an empty list if there are none, or if this isn&#39;t a class/
          interface.
      */
<span class="line-modified">!     public List&lt;Method&gt; getImmediateMethods() {</span>
        // Contains a Method for each method declared in this class/interface
        // not including inherited methods.
  
        MethodArray methods = getMethods();
        int length = methods.length();
<span class="line-modified">!       Method[] tmp = new Method[length];</span>
  
        IntArray methodOrdering = getMethodOrdering();
        if (methodOrdering.length() != length) {
           // no ordering info present
           for (int index = 0; index &lt; length; index++) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 863,17 ***</span>
      }
  
      /** Return a List containing an SA InstanceKlass for each
          interface named in this class&#39;s &#39;implements&#39; clause.
      */
<span class="line-modified">!     public List getDirectImplementedInterfaces() {</span>
          // Contains an InstanceKlass for each interface in this classes
          // &#39;implements&#39; clause.
  
          KlassArray interfaces = getLocalInterfaces();
          int length = interfaces.length();
<span class="line-modified">!         List directImplementedInterfaces = new ArrayList(length);</span>
  
          for (int index = 0; index &lt; length; index ++) {
              directImplementedInterfaces.add(interfaces.getAt(index));
          }
  
<span class="line-new-header">--- 865,17 ---</span>
      }
  
      /** Return a List containing an SA InstanceKlass for each
          interface named in this class&#39;s &#39;implements&#39; clause.
      */
<span class="line-modified">!     public List&lt;Klass&gt; getDirectImplementedInterfaces() {</span>
          // Contains an InstanceKlass for each interface in this classes
          // &#39;implements&#39; clause.
  
          KlassArray interfaces = getLocalInterfaces();
          int length = interfaces.length();
<span class="line-modified">!         List&lt;Klass&gt; directImplementedInterfaces = new ArrayList&lt;&gt;(length);</span>
  
          for (int index = 0; index &lt; length; index ++) {
              directImplementedInterfaces.add(interfaces.getAt(index));
          }
  
</pre>
<center><a href="InstanceClassLoaderKlass.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="InstanceMirrorKlass.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>