<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/java/io/ObjectInputStream.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../com/sun/crypto/provider/SymmetricCipher.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="ObjectStreamClass.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/io/ObjectInputStream.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
1841         return cl;
1842     }
1843 
1844     /**
1845      * Reads in and returns (possibly null) class descriptor.  Sets passHandle
1846      * to class descriptor&#39;s assigned handle.  If class descriptor cannot be
1847      * resolved to a class in the local VM, a ClassNotFoundException is
1848      * associated with the class descriptor&#39;s handle.
1849      */
1850     private ObjectStreamClass readClassDesc(boolean unshared)
1851         throws IOException
1852     {
1853         byte tc = bin.peekByte();
1854         ObjectStreamClass descriptor;
1855         switch (tc) {
1856             case TC_NULL:
1857                 descriptor = (ObjectStreamClass) readNull();
1858                 break;
1859             case TC_REFERENCE:
1860                 descriptor = (ObjectStreamClass) readHandle(unshared);


1861                 break;
1862             case TC_PROXYCLASSDESC:
1863                 descriptor = readProxyDesc(unshared);
1864                 break;
1865             case TC_CLASSDESC:
1866                 descriptor = readNonProxyDesc(unshared);
1867                 break;
1868             default:
1869                 throw new StreamCorruptedException(
1870                     String.format(&quot;invalid type code: %02X&quot;, tc));
1871         }
1872         return descriptor;
1873     }
1874 
1875     private boolean isCustomSubclass() {
1876         // Return true if this class is a custom subclass of ObjectInputStream
1877         return getClass().getClassLoader()
1878                     != ObjectInputStream.class.getClassLoader();
1879     }
1880 
</pre>
</td>
<td>
<hr />
<pre>
1841         return cl;
1842     }
1843 
1844     /**
1845      * Reads in and returns (possibly null) class descriptor.  Sets passHandle
1846      * to class descriptor&#39;s assigned handle.  If class descriptor cannot be
1847      * resolved to a class in the local VM, a ClassNotFoundException is
1848      * associated with the class descriptor&#39;s handle.
1849      */
1850     private ObjectStreamClass readClassDesc(boolean unshared)
1851         throws IOException
1852     {
1853         byte tc = bin.peekByte();
1854         ObjectStreamClass descriptor;
1855         switch (tc) {
1856             case TC_NULL:
1857                 descriptor = (ObjectStreamClass) readNull();
1858                 break;
1859             case TC_REFERENCE:
1860                 descriptor = (ObjectStreamClass) readHandle(unshared);
<span class="line-added">1861                 // Should only reference initialized class descriptors</span>
<span class="line-added">1862                 descriptor.checkInitialized();</span>
1863                 break;
1864             case TC_PROXYCLASSDESC:
1865                 descriptor = readProxyDesc(unshared);
1866                 break;
1867             case TC_CLASSDESC:
1868                 descriptor = readNonProxyDesc(unshared);
1869                 break;
1870             default:
1871                 throw new StreamCorruptedException(
1872                     String.format(&quot;invalid type code: %02X&quot;, tc));
1873         }
1874         return descriptor;
1875     }
1876 
1877     private boolean isCustomSubclass() {
1878         // Return true if this class is a custom subclass of ObjectInputStream
1879         return getClass().getClassLoader()
1880                     != ObjectInputStream.class.getClassLoader();
1881     }
1882 
</pre>
</td>
</tr>
</table>
<center><a href="../../com/sun/crypto/provider/SymmetricCipher.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="ObjectStreamClass.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>