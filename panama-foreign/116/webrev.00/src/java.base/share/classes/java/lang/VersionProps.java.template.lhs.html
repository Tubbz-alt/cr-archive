<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.base/share/classes/java/lang/VersionProps.java.template</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 1999, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package java.lang;
 27 
 28 import java.io.PrintStream;
 29 import java.util.Arrays;
 30 import java.util.List;
 31 import java.util.Map;
 32 import java.util.Optional;
 33 
 34 class VersionProps {
 35 
 36     private static final String launcher_name =
 37         &quot;@@LAUNCHER_NAME@@&quot;;
 38 
 39     private static final String java_version =
 40         &quot;@@VERSION_SHORT@@&quot;;
 41 
 42     private static final String java_version_date =
 43         &quot;@@VERSION_DATE@@&quot;;
 44 
 45     // This field is read by HotSpot
 46     private static final String java_runtime_name =
 47         &quot;@@RUNTIME_NAME@@&quot;;
 48 
 49     // This field is read by HotSpot
 50     private static final String java_runtime_version =
 51         &quot;@@VERSION_STRING@@&quot;;
 52 
 53     private static final String VERSION_NUMBER =
 54         &quot;@@VERSION_NUMBER@@&quot;;
 55 
 56     private static final String VERSION_SPECIFICATION =
 57         &quot;@@VERSION_SPECIFICATION@@&quot;;
 58 
 59     private static final String VERSION_BUILD =
 60         &quot;@@VERSION_BUILD@@&quot;;
 61 
 62     private static final String VERSION_PRE =
 63         &quot;@@VERSION_PRE@@&quot;;
 64 
 65     private static final String VERSION_OPT =
 66         &quot;@@VERSION_OPT@@&quot;;
 67 
 68     private static final boolean isLTS =
 69         &quot;@@VERSION_OPT@@&quot;.startsWith(&quot;LTS&quot;);
 70 
 71     private static final String CLASSFILE_MAJOR_MINOR =
 72         &quot;@@VERSION_CLASSFILE_MAJOR@@.@@VERSION_CLASSFILE_MINOR@@&quot;;
 73 
 74     private static final String VENDOR =
 75         &quot;@@VENDOR@@&quot;;
 76 
 77     private static final String VENDOR_URL =
 78         &quot;@@VENDOR_URL@@&quot;;
 79 
 80     // The remaining VENDOR_* fields must not be final,
 81     // so that they can be redefined by jlink plugins
 82 
 83     // This field is read by HotSpot
 84     private static String VENDOR_VERSION =
 85         &quot;@@VENDOR_VERSION_STRING@@&quot;;
 86 
 87     private static String VENDOR_URL_BUG =
 88         &quot;@@VENDOR_URL_BUG@@&quot;;
 89 
 90     // This field is read by HotSpot
<a name="2" id="anc2"></a>
 91     private static String VENDOR_URL_VM_BUG =
 92         &quot;@@VENDOR_URL_VM_BUG@@&quot;;
 93 
 94     /**
 95      * Initialize system properties using build provided values.
 96      *
 97      * @param props Map instance in which to insert the properties
 98      */
 99     public static void init(Map&lt;String, String&gt; props) {
100         props.put(&quot;java.version&quot;, java_version);
101         props.put(&quot;java.version.date&quot;, java_version_date);
102         props.put(&quot;java.runtime.version&quot;, java_runtime_version);
103         props.put(&quot;java.runtime.name&quot;, java_runtime_name);
104         if (!VENDOR_VERSION.isEmpty())
105             props.put(&quot;java.vendor.version&quot;, VENDOR_VERSION);
106 
107         props.put(&quot;java.class.version&quot;, CLASSFILE_MAJOR_MINOR);
108 
109         props.put(&quot;java.specification.version&quot;, VERSION_SPECIFICATION);
110         props.put(&quot;java.specification.name&quot;, &quot;Java Platform API Specification&quot;);
111         props.put(&quot;java.specification.vendor&quot;, &quot;Oracle Corporation&quot;);
112 
113         props.put(&quot;java.vendor&quot;, VENDOR);
114         props.put(&quot;java.vendor.url&quot;, VENDOR_URL);
115         props.put(&quot;java.vendor.url.bug&quot;, VENDOR_URL_BUG);
116     }
117 
118     private static int parseVersionNumber(String version, int prevIndex, int index) {
119         if (index - prevIndex &gt; 1 &amp;&amp;
120             Character.digit(version.charAt(prevIndex), 10) &lt;= 0)
121             throw new IllegalArgumentException(&quot;Leading zeros not supported (&quot; +
122                     version.substring(prevIndex, index) + &quot;)&quot;);
123         return Integer.parseInt(version, prevIndex, index, 10);
124     }
125 
126     // This method is reflectively used by regression tests.
127     static List&lt;Integer&gt; parseVersionNumbers(String version) {
128         // Let&#39;s find the size of an array required to hold $VNUM components
129         int size = 0;
130         int prevIndex = 0;
131         do {
132             prevIndex = version.indexOf(&#39;.&#39;, prevIndex) + 1;
133             size++;
134         } while (prevIndex &gt; 0);
135         Integer[] verNumbers = new Integer[size];
136 
137         // Fill in the array with $VNUM components
138         int n = 0;
139         prevIndex = 0;
140         int index = version.indexOf(&#39;.&#39;);
141         while (index &gt; -1) {
142             verNumbers[n] = parseVersionNumber(version, prevIndex, index);
143             prevIndex = index + 1; // Skip the period
144             index = version.indexOf(&#39;.&#39;, prevIndex);
145             n++;
146         }
147         verNumbers[n] = parseVersionNumber(version, prevIndex, version.length());
148 
149         if (verNumbers[0] == 0 || verNumbers[n] == 0)
150             throw new IllegalArgumentException(&quot;Leading/trailing zeros not allowed (&quot; +
151                     Arrays.toString(verNumbers) + &quot;)&quot;);
152 
153         return List.of(verNumbers);
154     }
155 
156     static List&lt;Integer&gt; versionNumbers() {
157         return parseVersionNumbers(VERSION_NUMBER);
158     }
159 
160     static Optional&lt;String&gt; pre() {
161         return optionalOf(VERSION_PRE);
162     }
163 
164     static Optional&lt;Integer&gt; build() {
165         return VERSION_BUILD.isEmpty() ?
166                 Optional.empty() :
167                 Optional.of(Integer.parseInt(VERSION_BUILD));
168     }
169 
170     static Optional&lt;String&gt; optional() {
171         return optionalOf(VERSION_OPT);
172     }
173 
174     // Treat empty strings as value not being present
175     private static Optional&lt;String&gt; optionalOf(String value) {
176         if (!value.isEmpty()) {
177             return Optional.of(value);
178         } else {
179             return Optional.empty();
180         }
181     }
182 
183     /**
184      * In case you were wondering this method is called by java -version.
185      */
186     public static void print(boolean err) {
187         print(err, false);
188     }
189 
190     /**
191      * This is the same as print except that it adds an extra line-feed
192      * at the end, typically used by the -showversion in the launcher
193      */
194     public static void println(boolean err) {
195         print(err, true);
196     }
197 
198     /**
199      * Print version info.
200      */
201     private static void print(boolean err, boolean newln) {
202         PrintStream ps = err ? System.err : System.out;
203 
204         /* First line: platform version. */
205         if (err) {
206             ps.println(launcher_name + &quot; version \&quot;&quot; + java_version + &quot;\&quot;&quot;
207                        + &quot; &quot; + java_version_date
208                        + (isLTS ? &quot; LTS&quot; : &quot;&quot;));
209         } else {
210             /* Use a format more in line with GNU conventions */
211             ps.println(launcher_name + &quot; &quot; + java_version
212                        + &quot; &quot; + java_version_date
213                        + (isLTS ? &quot; LTS&quot; : &quot;&quot;));
214         }
215 
216         /* Second line: runtime version (ie, libraries). */
217         String jdk_debug_level = System.getProperty(&quot;jdk.debug&quot;, &quot;release&quot;);
218         if (&quot;release&quot;.equals(jdk_debug_level)) {
219            /* Do not show debug level &quot;release&quot; builds */
220             jdk_debug_level = &quot;&quot;;
221         } else {
222             jdk_debug_level = jdk_debug_level + &quot; &quot;;
223         }
224 
225         String vendor_version = (VENDOR_VERSION.isEmpty()
226                                  ? &quot;&quot; : &quot; &quot; + VENDOR_VERSION);
227 
228         ps.println(java_runtime_name + vendor_version
229                    + &quot; (&quot; + jdk_debug_level + &quot;build &quot; + java_runtime_version + &quot;)&quot;);
230 
231         /* Third line: JVM information. */
232         String java_vm_name    = System.getProperty(&quot;java.vm.name&quot;);
233         String java_vm_version = System.getProperty(&quot;java.vm.version&quot;);
234         String java_vm_info    = System.getProperty(&quot;java.vm.info&quot;);
235         ps.println(java_vm_name + vendor_version
236                    + &quot; (&quot; + jdk_debug_level + &quot;build &quot; + java_vm_version + &quot;, &quot;
237                             + java_vm_info + &quot;)&quot;);
238 
239     }
240 
241 }
<a name="3" id="anc3"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="3" type="hidden" />
</body>
</html>