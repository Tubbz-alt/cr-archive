<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/lib/Awt2dLibraries.gmk</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="../launcher/LauncherCommon.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="CoreLibraries.gmk.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/lib/Awt2dLibraries.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
 23 # questions.
 24 #
 25 
 26 $(eval $(call IncludeCustomExtension, lib/Awt2dLibraries-pre.gmk))
 27 
 28 WIN_AWT_LIB := $(SUPPORT_OUTPUTDIR)/native/$(MODULE)/libawt/awt.lib
 29 
 30 LIBAWT_DEFAULT_HEADER_DIRS := \
 31     libawt/awt/image \
 32     libawt/awt/image/cvutils \
 33     libawt/java2d \
 34     libawt/java2d/loops \
 35     libawt/java2d/pipe \
 36     #
 37 
 38 ################################################################################
 39 
<span class="line-removed"> 40 # We must not include java.desktop/unix/native/libmlib_image, which is only</span>
<span class="line-removed"> 41 # for usage by solaris-sparc in libmlib_image_v.</span>
<span class="line-removed"> 42 BUILD_LIBMLIB_EXCLUDE_SRC_PATTERNS := /unix/</span>
<span class="line-removed"> 43 </span>
 44 BUILD_LIBMLIB_CFLAGS := -D__USE_J2D_NAMES -D__MEDIALIB_OLD_NAMES -DMLIB_NO_LIBSUNMATH
 45 
 46 ifeq ($(call isTargetCpuBits, 64), true)
 47   BUILD_LIBMLIB_CFLAGS += -DMLIB_OS64BIT
 48 endif
 49 
 50 $(eval $(call SetupJdkLibrary, BUILD_LIBMLIB_IMAGE, \
 51     NAME := mlib_image, \
 52     EXTRA_SRC := common/awt/medialib, \
 53     EXCLUDE_FILES := mlib_c_ImageBlendTable.c, \
 54     EXCLUDE_SRC_PATTERNS := $(BUILD_LIBMLIB_EXCLUDE_SRC_PATTERNS), \
 55     OPTIMIZATION := HIGHEST, \
 56     CFLAGS := $(CFLAGS_JDKLIB) \
 57         $(BUILD_LIBMLIB_CFLAGS), \
 58     DISABLED_WARNINGS_gcc := unused-function, \
 59     LDFLAGS := $(LDFLAGS_JDKLIB) \
 60         $(call SET_SHARED_LIBRARY_ORIGIN), \
 61     LIBS := $(JDKLIB_LIBS), \
 62     LIBS_unix := $(LIBM) $(LIBDL), \
 63 ))
 64 
 65 $(BUILD_LIBMLIB_IMAGE): $(call FindLib, java.base, java)
 66 
 67 TARGETS += $(BUILD_LIBMLIB_IMAGE)
 68 
 69 ################################################################################
 70 
<span class="line-removed"> 71 ifeq ($(call And, $(call isTargetOs, solaris) $(call isTargetCpuArch, sparc)), true)</span>
<span class="line-removed"> 72 </span>
<span class="line-removed"> 73   # libmlib_image_v is basically built from mlib_image sources, with some additions</span>
<span class="line-removed"> 74   # and some exclusions.</span>
<span class="line-removed"> 75   LIBMLIB_IMAGE_V_SRC := \</span>
<span class="line-removed"> 76      libmlib_image \</span>
<span class="line-removed"> 77      common/awt/medialib \</span>
<span class="line-removed"> 78      #</span>
<span class="line-removed"> 79 </span>
<span class="line-removed"> 80   LIBMLIB_IMAGE_V_CFLAGS := -xarch=sparcvis -D__USE_J2D_NAMES -D__MEDIALIB_OLD_NAMES \</span>
<span class="line-removed"> 81       $(TOPDIR)/src/$(MODULE)/unix/native/libmlib_image/vis_$(OPENJDK_TARGET_CPU_BITS).il</span>
<span class="line-removed"> 82 </span>
<span class="line-removed"> 83   ifeq ($(call isTargetCpuBits, 64), true)</span>
<span class="line-removed"> 84     LIBMLIB_IMAGE_V_CFLAGS += -DMLIB_OS64BIT</span>
<span class="line-removed"> 85   endif</span>
<span class="line-removed"> 86 </span>
<span class="line-removed"> 87   BUILD_LIBMLIB_IMAGE_V_EXFILES := \</span>
<span class="line-removed"> 88       awt_ImagingLib.c \</span>
<span class="line-removed"> 89       mlib_c_ImageAffine_BC.c \</span>
<span class="line-removed"> 90       mlib_c_ImageAffine_BC_S16.c \</span>
<span class="line-removed"> 91       mlib_c_ImageAffine_BC_U16.c \</span>
<span class="line-removed"> 92       mlib_c_ImageAffine_BL.c \</span>
<span class="line-removed"> 93       mlib_c_ImageAffine_BL_S16.c \</span>
<span class="line-removed"> 94       mlib_c_ImageAffine_BL_U16.c \</span>
<span class="line-removed"> 95       mlib_c_ImageAffine_NN.c \</span>
<span class="line-removed"> 96       mlib_c_ImageConvClearEdge.c \</span>
<span class="line-removed"> 97       mlib_c_ImageConvCopyEdge.c \</span>
<span class="line-removed"> 98       mlib_c_ImageConv_f.c \</span>
<span class="line-removed"> 99       mlib_c_ImageConvVersion.c \</span>
<span class="line-removed">100       mlib_c_ImageCopy.c \</span>
<span class="line-removed">101       mlib_c_ImageLookUp.c \</span>
<span class="line-removed">102       mlib_c_ImageLookUp_f.c \</span>
<span class="line-removed">103       #</span>
<span class="line-removed">104 </span>
<span class="line-removed">105   $(eval $(call SetupJdkLibrary, BUILD_LIBMLIB_IMAGE_V, \</span>
<span class="line-removed">106       NAME := mlib_image_v, \</span>
<span class="line-removed">107       SRC := $(LIBMLIB_IMAGE_V_SRC), \</span>
<span class="line-removed">108       EXCLUDE_FILES := $(BUILD_LIBMLIB_IMAGE_V_EXFILES), \</span>
<span class="line-removed">109       OPTIMIZATION := HIGHEST, \</span>
<span class="line-removed">110       CFLAGS := $(CFLAGS_JDKLIB) \</span>
<span class="line-removed">111           $(LIBMLIB_IMAGE_V_CFLAGS), \</span>
<span class="line-removed">112       LDFLAGS := $(LDFLAGS_JDKLIB) \</span>
<span class="line-removed">113           $(call SET_SHARED_LIBRARY_ORIGIN), \</span>
<span class="line-removed">114       LIBS := -ljava -ljvm $(LIBM) $(LIBDL), \</span>
<span class="line-removed">115   ))</span>
<span class="line-removed">116 </span>
<span class="line-removed">117   $(BUILD_LIBMLIB_IMAGE_V): $(call FindLib, java.base, java)</span>
<span class="line-removed">118 </span>
<span class="line-removed">119   TARGETS += $(BUILD_LIBMLIB_IMAGE_V)</span>
<span class="line-removed">120 </span>
<span class="line-removed">121 endif</span>
<span class="line-removed">122 </span>
<span class="line-removed">123 ################################################################################</span>
<span class="line-removed">124 </span>
125 LIBAWT_EXTRA_SRC := \
126     common/awt/debug \
127     $(TOPDIR)/src/$(MODULE)/$(OPENJDK_TARGET_OS_TYPE)/native/common/awt \
128     #
129 
130 ifeq ($(call And, $(call isTargetOs, solaris) $(call isTargetCpuArch, sparc)), true)
131   LIBAWT_EXTRA_SRC += $(TOPDIR)/src/$(MODULE)/share/native/common/awt/medialib
132 endif
133 
134 ifeq ($(call isTargetOs, windows), true)
135   LIBAWT_EXTRA_SRC += \
136       $(TOPDIR)/src/$(MODULE)/share/native/common/awt/utility \
137       $(TOPDIR)/src/$(MODULE)/share/native/common/font \
138       $(TOPDIR)/src/$(MODULE)/share/native/common/java2d/opengl \
139       $(TOPDIR)/src/$(MODULE)/$(OPENJDK_TARGET_OS_TYPE)/native/common/awt/systemscale \
140       #
141 endif
142 
143 ifeq ($(call isTargetOs, solaris linux macosx aix), true)
144   LIBAWT_EXFILES += awt_Font.c CUPSfuncs.c fontpath.c X11Color.c
145 endif
146 
147 ifeq ($(call isTargetOs, macosx), true)
148   LIBAWT_EXFILES += initIDs.c awt/image/cvutils/img_colors.c
149 endif
150 
151 ifeq ($(call isTargetOs, windows), true)
152   LIBAWT_EXFILES += \
153       java2d/d3d/D3DShaderGen.c \
154       awt/image/cvutils/img_colors.c \
155       #
156 endif
157 
<span class="line-removed">158 ifeq ($(call And, $(call isTargetOs, solaris) $(call isTargetCpu, sparcv9)), true)</span>
<span class="line-removed">159   LIBAWT_EXFILES += java2d/loops/MapAccelFunc.c</span>
<span class="line-removed">160 else</span>
<span class="line-removed">161   LIBAWT_EXCLUDES += \</span>
<span class="line-removed">162       $(TOPDIR)/src/$(MODULE)/unix/native/libawt/awt/medialib \</span>
<span class="line-removed">163       $(TOPDIR)/src/$(MODULE)/unix/native/libawt/java2d/loops \</span>
<span class="line-removed">164       $(TOPDIR)/src/$(MODULE)/unix/native/common/awt/medialib \</span>
<span class="line-removed">165       #</span>
<span class="line-removed">166 endif</span>
<span class="line-removed">167 </span>
168 LIBAWT_EXTRA_HEADER_DIRS := \
169     $(LIBAWT_DEFAULT_HEADER_DIRS) \
170     $(call GetJavaHeaderDir, java.base) \
171     libawt/awt/medialib \
172     libawt/java2d/d3d \
173     libawt/java2d/opengl \
174     libawt/java2d/windows \
175     libawt/windows \
176     common/awt/medialib \
177     libmlib_image \
178     include \
179     java.base:libjava \
180     java.base:include \
181     #
182 
183 LIBAWT_CFLAGS += -D__MEDIALIB_OLD_NAMES -D__USE_J2D_NAMES $(X_CFLAGS)
184 
185 ifeq ($(call And, $(call isTargetOs, solaris) $(call isTargetCpu, sparcv9)), true)
<span class="line-removed">186   LIBAWT_CFLAGS += -xarch=sparcvis -DMLIB_ADD_SUFF \</span>
<span class="line-removed">187       $(TOPDIR)/src/$(MODULE)/unix/native/libmlib_image/vis_$(OPENJDK_TARGET_CPU_BITS).il</span>
<span class="line-removed">188 </span>
189   LIBAWT_ASFLAGS = -P -xarch=v9a
190 endif
191 
192 ifeq ($(call isTargetOs, solaris), false)
193   LIBAWT_CFLAGS += -DMLIB_NO_LIBSUNMATH
194 endif
195 
196 ifeq ($(call isTargetOs, windows), true)
197   LIBAWT_CFLAGS += -EHsc -DUNICODE -D_UNICODE
198   ifeq ($(call isTargetCpuBits, 64), true)
199     LIBAWT_CFLAGS += -DMLIB_OS64BIT
200   endif
201 
202   LIBAWT_RC_FLAGS ?= -I $(TOPDIR)/src/java.base/windows/native/launcher/icons
203   LIBAWT_VERSIONINFO_RESOURCE := $(TOPDIR)/src/$(MODULE)/windows/native/libawt/windows/awt.rc
204 endif
205 
206 ifeq ($(call isTargetOs, linux), true)
207   # FIXME: This is probably not what we want to do, but keep it now for compatibility.
208   LIBAWT_CFLAGS += $(EXPORT_ALL_SYMBOLS)
</pre>
</td>
<td>
<hr />
<pre>
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
 23 # questions.
 24 #
 25 
 26 $(eval $(call IncludeCustomExtension, lib/Awt2dLibraries-pre.gmk))
 27 
 28 WIN_AWT_LIB := $(SUPPORT_OUTPUTDIR)/native/$(MODULE)/libawt/awt.lib
 29 
 30 LIBAWT_DEFAULT_HEADER_DIRS := \
 31     libawt/awt/image \
 32     libawt/awt/image/cvutils \
 33     libawt/java2d \
 34     libawt/java2d/loops \
 35     libawt/java2d/pipe \
 36     #
 37 
 38 ################################################################################
 39 




 40 BUILD_LIBMLIB_CFLAGS := -D__USE_J2D_NAMES -D__MEDIALIB_OLD_NAMES -DMLIB_NO_LIBSUNMATH
 41 
 42 ifeq ($(call isTargetCpuBits, 64), true)
 43   BUILD_LIBMLIB_CFLAGS += -DMLIB_OS64BIT
 44 endif
 45 
 46 $(eval $(call SetupJdkLibrary, BUILD_LIBMLIB_IMAGE, \
 47     NAME := mlib_image, \
 48     EXTRA_SRC := common/awt/medialib, \
 49     EXCLUDE_FILES := mlib_c_ImageBlendTable.c, \
 50     EXCLUDE_SRC_PATTERNS := $(BUILD_LIBMLIB_EXCLUDE_SRC_PATTERNS), \
 51     OPTIMIZATION := HIGHEST, \
 52     CFLAGS := $(CFLAGS_JDKLIB) \
 53         $(BUILD_LIBMLIB_CFLAGS), \
 54     DISABLED_WARNINGS_gcc := unused-function, \
 55     LDFLAGS := $(LDFLAGS_JDKLIB) \
 56         $(call SET_SHARED_LIBRARY_ORIGIN), \
 57     LIBS := $(JDKLIB_LIBS), \
 58     LIBS_unix := $(LIBM) $(LIBDL), \
 59 ))
 60 
 61 $(BUILD_LIBMLIB_IMAGE): $(call FindLib, java.base, java)
 62 
 63 TARGETS += $(BUILD_LIBMLIB_IMAGE)
 64 
 65 ################################################################################
 66 






















































 67 LIBAWT_EXTRA_SRC := \
 68     common/awt/debug \
 69     $(TOPDIR)/src/$(MODULE)/$(OPENJDK_TARGET_OS_TYPE)/native/common/awt \
 70     #
 71 
 72 ifeq ($(call And, $(call isTargetOs, solaris) $(call isTargetCpuArch, sparc)), true)
 73   LIBAWT_EXTRA_SRC += $(TOPDIR)/src/$(MODULE)/share/native/common/awt/medialib
 74 endif
 75 
 76 ifeq ($(call isTargetOs, windows), true)
 77   LIBAWT_EXTRA_SRC += \
 78       $(TOPDIR)/src/$(MODULE)/share/native/common/awt/utility \
 79       $(TOPDIR)/src/$(MODULE)/share/native/common/font \
 80       $(TOPDIR)/src/$(MODULE)/share/native/common/java2d/opengl \
 81       $(TOPDIR)/src/$(MODULE)/$(OPENJDK_TARGET_OS_TYPE)/native/common/awt/systemscale \
 82       #
 83 endif
 84 
 85 ifeq ($(call isTargetOs, solaris linux macosx aix), true)
 86   LIBAWT_EXFILES += awt_Font.c CUPSfuncs.c fontpath.c X11Color.c
 87 endif
 88 
 89 ifeq ($(call isTargetOs, macosx), true)
 90   LIBAWT_EXFILES += initIDs.c awt/image/cvutils/img_colors.c
 91 endif
 92 
 93 ifeq ($(call isTargetOs, windows), true)
 94   LIBAWT_EXFILES += \
 95       java2d/d3d/D3DShaderGen.c \
 96       awt/image/cvutils/img_colors.c \
 97       #
 98 endif
 99 










100 LIBAWT_EXTRA_HEADER_DIRS := \
101     $(LIBAWT_DEFAULT_HEADER_DIRS) \
102     $(call GetJavaHeaderDir, java.base) \
103     libawt/awt/medialib \
104     libawt/java2d/d3d \
105     libawt/java2d/opengl \
106     libawt/java2d/windows \
107     libawt/windows \
108     common/awt/medialib \
109     libmlib_image \
110     include \
111     java.base:libjava \
112     java.base:include \
113     #
114 
115 LIBAWT_CFLAGS += -D__MEDIALIB_OLD_NAMES -D__USE_J2D_NAMES $(X_CFLAGS)
116 
117 ifeq ($(call And, $(call isTargetOs, solaris) $(call isTargetCpu, sparcv9)), true)



118   LIBAWT_ASFLAGS = -P -xarch=v9a
119 endif
120 
121 ifeq ($(call isTargetOs, solaris), false)
122   LIBAWT_CFLAGS += -DMLIB_NO_LIBSUNMATH
123 endif
124 
125 ifeq ($(call isTargetOs, windows), true)
126   LIBAWT_CFLAGS += -EHsc -DUNICODE -D_UNICODE
127   ifeq ($(call isTargetCpuBits, 64), true)
128     LIBAWT_CFLAGS += -DMLIB_OS64BIT
129   endif
130 
131   LIBAWT_RC_FLAGS ?= -I $(TOPDIR)/src/java.base/windows/native/launcher/icons
132   LIBAWT_VERSIONINFO_RESOURCE := $(TOPDIR)/src/$(MODULE)/windows/native/libawt/windows/awt.rc
133 endif
134 
135 ifeq ($(call isTargetOs, linux), true)
136   # FIXME: This is probably not what we want to do, but keep it now for compatibility.
137   LIBAWT_CFLAGS += $(EXPORT_ALL_SYMBOLS)
</pre>
</td>
</tr>
</table>
<center><a href="../launcher/LauncherCommon.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="CoreLibraries.gmk.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>