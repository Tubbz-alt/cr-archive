<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/devkit/createWindowsDevkit2019.sh</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="../copy/Copy-java.base.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="../gensrc/GensrcCharacterData.gmk.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/devkit/createWindowsDevkit2019.sh</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 #!/bin/bash
  2 #
<span class="line-modified">  3 # Copyright (c) 2019, Oracle and/or its affiliates. All rights reserved.</span>
  4 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  5 #
  6 # This code is free software; you can redistribute it and/or modify it
  7 # under the terms of the GNU General Public License version 2 only, as
  8 # published by the Free Software Foundation.  Oracle designates this
  9 # particular file as subject to the &quot;Classpath&quot; exception as provided
 10 # by Oracle in the LICENSE file that accompanied this code.
 11 #
 12 # This code is distributed in the hope that it will be useful, but WITHOUT
 13 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 14 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 15 # version 2 for more details (a copy is included in the LICENSE file that
 16 # accompanied this code).
 17 #
 18 # You should have received a copy of the GNU General Public License version
 19 # 2 along with this work; if not, write to the Free Software Foundation,
 20 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 21 #
 22 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 23 # or visit www.oracle.com if you need additional information or have any
 24 # questions.
 25 #
 26 
 27 # This script copies parts of a Visual Studio installation into a devkit
 28 # suitable for building OpenJDK and OracleJDK. Needs to run in Cygwin or WSL.
 29 # erik.joelsson@oracle.com
 30 
 31 VS_VERSION=&quot;2019&quot;
 32 VS_VERSION_NUM_NODOT=&quot;160&quot;
 33 VS_DLL_VERSION=&quot;140&quot;
 34 SDK_VERSION=&quot;10&quot;
 35 SDK_FULL_VERSION=&quot;10.0.17763.0&quot;
<span class="line-modified"> 36 MSVC_DIR=&quot;Microsoft.VC141.CRT&quot;</span>
 37 MSVC_FULL_VERSION=&quot;14.12.27508&quot;
 38 REDIST_FULL_VERSION=&quot;14.20.27508&quot;
 39 
 40 SCRIPT_DIR=&quot;$(cd &quot;$(dirname $0)&quot; &gt; /dev/null &amp;&amp; pwd)&quot;
 41 BUILD_DIR=&quot;${SCRIPT_DIR}/../../build/devkit&quot;
 42 
 43 ################################################################################
 44 # Prepare settings
 45 
 46 UNAME_SYSTEM=`uname -s`
 47 UNAME_RELEASE=`uname -r`
 48 
 49 # Detect cygwin or WSL
 50 IS_CYGWIN=`echo $UNAME_SYSTEM | grep -i CYGWIN`
 51 IS_WSL=`echo $UNAME_RELEASE | grep Microsoft`
 52 if test &quot;x$IS_CYGWIN&quot; != &quot;x&quot;; then
 53     BUILD_ENV=&quot;cygwin&quot;
 54 elif test &quot;x$IS_WSL&quot; != &quot;x&quot;; then
 55     BUILD_ENV=&quot;wsl&quot;
 56 else
</pre>
<hr />
<pre>
 85         # Remove SemnaticVersion=
 86         VS_VERSION_SP=&quot;${VS_VERSION_SP#*=}&quot;
 87         # Remove suffix of too detailed numbering starting with +
 88         VS_VERSION_SP=&quot;${VS_VERSION_SP%+*}&quot;
 89         break
 90     fi
 91 done
 92 if [ -z &quot;$VS_VERSION_SP&quot; ]; then
 93     echo &quot;Failed to find SP version&quot;
 94     exit 1
 95 fi
 96 echo &quot;Found Version SP: $VS_VERSION_SP&quot;
 97 
 98 # Setup output dirs
 99 DEVKIT_ROOT=&quot;${BUILD_DIR}/VS${VS_VERSION}-${VS_VERSION_SP}-devkit&quot;
100 DEVKIT_BUNDLE=&quot;${DEVKIT_ROOT}.tar.gz&quot;
101 
102 echo &quot;Creating devkit in $DEVKIT_ROOT&quot;
103 
104 MSVCR_DLL=${MSVC_DIR}/vcruntime${VS_DLL_VERSION}.dll

105 MSVCP_DLL=${MSVC_DIR}/msvcp${VS_DLL_VERSION}.dll
106 
107 ################################################################################
108 # Copy Visual Studio files
109 
110 TOOLS_VERSION=&quot;$(ls &quot;$VS_INSTALL_DIR/VC/Tools/MSVC&quot; | sort -r -n | head -n1)&quot;
111 echo &quot;Found Tools version: $TOOLS_VERSION&quot;
112 VC_SUBDIR=&quot;VC/Tools/MSVC/$TOOLS_VERSION&quot;
113 REDIST_VERSION=&quot;$(ls &quot;$VS_INSTALL_DIR/VC/Redist/MSVC&quot; | sort -r -n | head -n1)&quot;
114 echo &quot;Found Redist version: $REDIST_VERSION&quot;
115 REDIST_SUBDIR=&quot;VC/Redist/MSVC/$REDIST_VERSION&quot;
116 echo &quot;Copying VC...&quot;
117 rm -rf $DEVKIT_ROOT/VC
118 mkdir -p $DEVKIT_ROOT/VC/bin
119 cp -r &quot;$VS_INSTALL_DIR/${VC_SUBDIR}/bin/Hostx64/x64&quot; $DEVKIT_ROOT/VC/bin/
120 cp -r &quot;$VS_INSTALL_DIR/${VC_SUBDIR}/bin/Hostx86/x86&quot; $DEVKIT_ROOT/VC/bin/
121 mkdir -p $DEVKIT_ROOT/VC/lib
122 cp -r &quot;$VS_INSTALL_DIR/${VC_SUBDIR}/lib/x64&quot; $DEVKIT_ROOT/VC/lib/
123 cp -r &quot;$VS_INSTALL_DIR/${VC_SUBDIR}/lib/x86&quot; $DEVKIT_ROOT/VC/lib/
124 cp -r &quot;$VS_INSTALL_DIR/${VC_SUBDIR}/include&quot; $DEVKIT_ROOT/VC/
</pre>
<hr />
<pre>
171     echo &quot;$1&quot; &gt;&gt; $DEVKIT_ROOT/devkit.info
172 }
173 
174 echo &quot;Generating devkit.info...&quot;
175 rm -f $DEVKIT_ROOT/devkit.info
176 echo-info &quot;# This file describes to configure how to interpret the contents of this devkit&quot;
177 echo-info &quot;DEVKIT_NAME=\&quot;Microsoft Visual Studio $VS_VERSION $VS_VERSION_SP (devkit)\&quot;&quot;
178 echo-info &quot;DEVKIT_VS_VERSION=\&quot;$VS_VERSION\&quot;&quot;
179 echo-info &quot;&quot;
180 echo-info &quot;DEVKIT_TOOLCHAIN_PATH_x86=\&quot;\$DEVKIT_ROOT/VC/bin/x86:\$DEVKIT_ROOT/$SDK_VERSION/bin/x86\&quot;&quot;
181 echo-info &quot;DEVKIT_VS_INCLUDE_x86=\&quot;\$DEVKIT_ROOT/VC/include;\$DEVKIT_ROOT/VC/atlmfc/include;\$DEVKIT_ROOT/$SDK_VERSION/include/shared;\$DEVKIT_ROOT/$SDK_VERSION/include/ucrt;\$DEVKIT_ROOT/$SDK_VERSION/include/um;\$DEVKIT_ROOT/$SDK_VERSION/include/winrt\&quot;&quot;
182 echo-info &quot;DEVKIT_VS_LIB_x86=\&quot;\$DEVKIT_ROOT/VC/lib/x86;\$DEVKIT_ROOT/VC/atlmfc/lib/x86;\$DEVKIT_ROOT/$SDK_VERSION/lib/x86\&quot;&quot;
183 echo-info &quot;DEVKIT_MSVCR_DLL_x86=\&quot;\$DEVKIT_ROOT/VC/redist/x86/$MSVCR_DLL\&quot;&quot;
184 echo-info &quot;DEVKIT_MSVCP_DLL_x86=\&quot;\$DEVKIT_ROOT/VC/redist/x86/$MSVCP_DLL\&quot;&quot;
185 echo-info &quot;DEVKIT_UCRT_DLL_DIR_x86=\&quot;\$DEVKIT_ROOT/10/Redist/ucrt/DLLs/x86\&quot;&quot;
186 echo-info &quot;&quot;
187 echo-info &quot;DEVKIT_TOOLCHAIN_PATH_x86_64=\&quot;\$DEVKIT_ROOT/VC/bin/x64:\$DEVKIT_ROOT/$SDK_VERSION/bin/x64:\$DEVKIT_ROOT/$SDK_VERSION/bin/x86\&quot;&quot;
188 echo-info &quot;DEVKIT_VS_INCLUDE_x86_64=\&quot;\$DEVKIT_ROOT/VC/include;\$DEVKIT_ROOT/VC/atlmfc/include;\$DEVKIT_ROOT/$SDK_VERSION/include/shared;\$DEVKIT_ROOT/$SDK_VERSION/include/ucrt;\$DEVKIT_ROOT/$SDK_VERSION/include/um;\$DEVKIT_ROOT/$SDK_VERSION/include/winrt\&quot;&quot;
189 echo-info &quot;DEVKIT_VS_LIB_x86_64=\&quot;\$DEVKIT_ROOT/VC/lib/x64;\$DEVKIT_ROOT/VC/atlmfc/lib/x64;\$DEVKIT_ROOT/$SDK_VERSION/lib/x64\&quot;&quot;
190 echo-info &quot;DEVKIT_MSVCR_DLL_x86_64=\&quot;\$DEVKIT_ROOT/VC/redist/x64/$MSVCR_DLL\&quot;&quot;

191 echo-info &quot;DEVKIT_MSVCP_DLL_x86_64=\&quot;\$DEVKIT_ROOT/VC/redist/x64/$MSVCP_DLL\&quot;&quot;
192 echo-info &quot;DEVKIT_UCRT_DLL_DIR_x86_64=\&quot;\$DEVKIT_ROOT/10/Redist/ucrt/DLLs/x64\&quot;&quot;
193 echo-info &quot;&quot;
194 echo-info &quot;DEVKIT_TOOLS_VERSION=\&quot;$TOOLS_VERSION\&quot;&quot;
195 echo-info &quot;DEVKIT_REDIST_VERSION=\&quot;$REDIST_VERSION\&quot;&quot;
196 echo-info &quot;DEVKIT_SDK_VERSION=\&quot;$SDK_FULL_VERSION\&quot;&quot;
197 echo-info &quot;DEVKIT_UCRT_VERSION=\&quot;$UCRT_VERSION\&quot;&quot;
198 
199 ################################################################################
200 # Copy this script
201 
202 echo &quot;Copying this script...&quot;
203 cp $0 $DEVKIT_ROOT/
204 
205 ################################################################################
206 # Create bundle
207 
208 echo &quot;Creating bundle: $DEVKIT_BUNDLE&quot;
209 (cd &quot;$DEVKIT_ROOT&quot; &amp;&amp; tar zcf &quot;$DEVKIT_BUNDLE&quot; .)
</pre>
</td>
<td>
<hr />
<pre>
  1 #!/bin/bash
  2 #
<span class="line-modified">  3 # Copyright (c) 2019, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  4 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  5 #
  6 # This code is free software; you can redistribute it and/or modify it
  7 # under the terms of the GNU General Public License version 2 only, as
  8 # published by the Free Software Foundation.  Oracle designates this
  9 # particular file as subject to the &quot;Classpath&quot; exception as provided
 10 # by Oracle in the LICENSE file that accompanied this code.
 11 #
 12 # This code is distributed in the hope that it will be useful, but WITHOUT
 13 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 14 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 15 # version 2 for more details (a copy is included in the LICENSE file that
 16 # accompanied this code).
 17 #
 18 # You should have received a copy of the GNU General Public License version
 19 # 2 along with this work; if not, write to the Free Software Foundation,
 20 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 21 #
 22 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 23 # or visit www.oracle.com if you need additional information or have any
 24 # questions.
 25 #
 26 
 27 # This script copies parts of a Visual Studio installation into a devkit
 28 # suitable for building OpenJDK and OracleJDK. Needs to run in Cygwin or WSL.
 29 # erik.joelsson@oracle.com
 30 
 31 VS_VERSION=&quot;2019&quot;
 32 VS_VERSION_NUM_NODOT=&quot;160&quot;
 33 VS_DLL_VERSION=&quot;140&quot;
 34 SDK_VERSION=&quot;10&quot;
 35 SDK_FULL_VERSION=&quot;10.0.17763.0&quot;
<span class="line-modified"> 36 MSVC_DIR=&quot;Microsoft.VC142.CRT&quot;</span>
 37 MSVC_FULL_VERSION=&quot;14.12.27508&quot;
 38 REDIST_FULL_VERSION=&quot;14.20.27508&quot;
 39 
 40 SCRIPT_DIR=&quot;$(cd &quot;$(dirname $0)&quot; &gt; /dev/null &amp;&amp; pwd)&quot;
 41 BUILD_DIR=&quot;${SCRIPT_DIR}/../../build/devkit&quot;
 42 
 43 ################################################################################
 44 # Prepare settings
 45 
 46 UNAME_SYSTEM=`uname -s`
 47 UNAME_RELEASE=`uname -r`
 48 
 49 # Detect cygwin or WSL
 50 IS_CYGWIN=`echo $UNAME_SYSTEM | grep -i CYGWIN`
 51 IS_WSL=`echo $UNAME_RELEASE | grep Microsoft`
 52 if test &quot;x$IS_CYGWIN&quot; != &quot;x&quot;; then
 53     BUILD_ENV=&quot;cygwin&quot;
 54 elif test &quot;x$IS_WSL&quot; != &quot;x&quot;; then
 55     BUILD_ENV=&quot;wsl&quot;
 56 else
</pre>
<hr />
<pre>
 85         # Remove SemnaticVersion=
 86         VS_VERSION_SP=&quot;${VS_VERSION_SP#*=}&quot;
 87         # Remove suffix of too detailed numbering starting with +
 88         VS_VERSION_SP=&quot;${VS_VERSION_SP%+*}&quot;
 89         break
 90     fi
 91 done
 92 if [ -z &quot;$VS_VERSION_SP&quot; ]; then
 93     echo &quot;Failed to find SP version&quot;
 94     exit 1
 95 fi
 96 echo &quot;Found Version SP: $VS_VERSION_SP&quot;
 97 
 98 # Setup output dirs
 99 DEVKIT_ROOT=&quot;${BUILD_DIR}/VS${VS_VERSION}-${VS_VERSION_SP}-devkit&quot;
100 DEVKIT_BUNDLE=&quot;${DEVKIT_ROOT}.tar.gz&quot;
101 
102 echo &quot;Creating devkit in $DEVKIT_ROOT&quot;
103 
104 MSVCR_DLL=${MSVC_DIR}/vcruntime${VS_DLL_VERSION}.dll
<span class="line-added">105 VCRUNTIME_1_DLL=${MSVC_DIR}/vcruntime${VS_DLL_VERSION}_1.dll</span>
106 MSVCP_DLL=${MSVC_DIR}/msvcp${VS_DLL_VERSION}.dll
107 
108 ################################################################################
109 # Copy Visual Studio files
110 
111 TOOLS_VERSION=&quot;$(ls &quot;$VS_INSTALL_DIR/VC/Tools/MSVC&quot; | sort -r -n | head -n1)&quot;
112 echo &quot;Found Tools version: $TOOLS_VERSION&quot;
113 VC_SUBDIR=&quot;VC/Tools/MSVC/$TOOLS_VERSION&quot;
114 REDIST_VERSION=&quot;$(ls &quot;$VS_INSTALL_DIR/VC/Redist/MSVC&quot; | sort -r -n | head -n1)&quot;
115 echo &quot;Found Redist version: $REDIST_VERSION&quot;
116 REDIST_SUBDIR=&quot;VC/Redist/MSVC/$REDIST_VERSION&quot;
117 echo &quot;Copying VC...&quot;
118 rm -rf $DEVKIT_ROOT/VC
119 mkdir -p $DEVKIT_ROOT/VC/bin
120 cp -r &quot;$VS_INSTALL_DIR/${VC_SUBDIR}/bin/Hostx64/x64&quot; $DEVKIT_ROOT/VC/bin/
121 cp -r &quot;$VS_INSTALL_DIR/${VC_SUBDIR}/bin/Hostx86/x86&quot; $DEVKIT_ROOT/VC/bin/
122 mkdir -p $DEVKIT_ROOT/VC/lib
123 cp -r &quot;$VS_INSTALL_DIR/${VC_SUBDIR}/lib/x64&quot; $DEVKIT_ROOT/VC/lib/
124 cp -r &quot;$VS_INSTALL_DIR/${VC_SUBDIR}/lib/x86&quot; $DEVKIT_ROOT/VC/lib/
125 cp -r &quot;$VS_INSTALL_DIR/${VC_SUBDIR}/include&quot; $DEVKIT_ROOT/VC/
</pre>
<hr />
<pre>
172     echo &quot;$1&quot; &gt;&gt; $DEVKIT_ROOT/devkit.info
173 }
174 
175 echo &quot;Generating devkit.info...&quot;
176 rm -f $DEVKIT_ROOT/devkit.info
177 echo-info &quot;# This file describes to configure how to interpret the contents of this devkit&quot;
178 echo-info &quot;DEVKIT_NAME=\&quot;Microsoft Visual Studio $VS_VERSION $VS_VERSION_SP (devkit)\&quot;&quot;
179 echo-info &quot;DEVKIT_VS_VERSION=\&quot;$VS_VERSION\&quot;&quot;
180 echo-info &quot;&quot;
181 echo-info &quot;DEVKIT_TOOLCHAIN_PATH_x86=\&quot;\$DEVKIT_ROOT/VC/bin/x86:\$DEVKIT_ROOT/$SDK_VERSION/bin/x86\&quot;&quot;
182 echo-info &quot;DEVKIT_VS_INCLUDE_x86=\&quot;\$DEVKIT_ROOT/VC/include;\$DEVKIT_ROOT/VC/atlmfc/include;\$DEVKIT_ROOT/$SDK_VERSION/include/shared;\$DEVKIT_ROOT/$SDK_VERSION/include/ucrt;\$DEVKIT_ROOT/$SDK_VERSION/include/um;\$DEVKIT_ROOT/$SDK_VERSION/include/winrt\&quot;&quot;
183 echo-info &quot;DEVKIT_VS_LIB_x86=\&quot;\$DEVKIT_ROOT/VC/lib/x86;\$DEVKIT_ROOT/VC/atlmfc/lib/x86;\$DEVKIT_ROOT/$SDK_VERSION/lib/x86\&quot;&quot;
184 echo-info &quot;DEVKIT_MSVCR_DLL_x86=\&quot;\$DEVKIT_ROOT/VC/redist/x86/$MSVCR_DLL\&quot;&quot;
185 echo-info &quot;DEVKIT_MSVCP_DLL_x86=\&quot;\$DEVKIT_ROOT/VC/redist/x86/$MSVCP_DLL\&quot;&quot;
186 echo-info &quot;DEVKIT_UCRT_DLL_DIR_x86=\&quot;\$DEVKIT_ROOT/10/Redist/ucrt/DLLs/x86\&quot;&quot;
187 echo-info &quot;&quot;
188 echo-info &quot;DEVKIT_TOOLCHAIN_PATH_x86_64=\&quot;\$DEVKIT_ROOT/VC/bin/x64:\$DEVKIT_ROOT/$SDK_VERSION/bin/x64:\$DEVKIT_ROOT/$SDK_VERSION/bin/x86\&quot;&quot;
189 echo-info &quot;DEVKIT_VS_INCLUDE_x86_64=\&quot;\$DEVKIT_ROOT/VC/include;\$DEVKIT_ROOT/VC/atlmfc/include;\$DEVKIT_ROOT/$SDK_VERSION/include/shared;\$DEVKIT_ROOT/$SDK_VERSION/include/ucrt;\$DEVKIT_ROOT/$SDK_VERSION/include/um;\$DEVKIT_ROOT/$SDK_VERSION/include/winrt\&quot;&quot;
190 echo-info &quot;DEVKIT_VS_LIB_x86_64=\&quot;\$DEVKIT_ROOT/VC/lib/x64;\$DEVKIT_ROOT/VC/atlmfc/lib/x64;\$DEVKIT_ROOT/$SDK_VERSION/lib/x64\&quot;&quot;
191 echo-info &quot;DEVKIT_MSVCR_DLL_x86_64=\&quot;\$DEVKIT_ROOT/VC/redist/x64/$MSVCR_DLL\&quot;&quot;
<span class="line-added">192 echo-info &quot;DEVKIT_VCRUNTIME_1_DLL_x86_64=\&quot;\$DEVKIT_ROOT/VC/redist/x64/$VCRUNTIME_1_DLL\&quot;&quot;</span>
193 echo-info &quot;DEVKIT_MSVCP_DLL_x86_64=\&quot;\$DEVKIT_ROOT/VC/redist/x64/$MSVCP_DLL\&quot;&quot;
194 echo-info &quot;DEVKIT_UCRT_DLL_DIR_x86_64=\&quot;\$DEVKIT_ROOT/10/Redist/ucrt/DLLs/x64\&quot;&quot;
195 echo-info &quot;&quot;
196 echo-info &quot;DEVKIT_TOOLS_VERSION=\&quot;$TOOLS_VERSION\&quot;&quot;
197 echo-info &quot;DEVKIT_REDIST_VERSION=\&quot;$REDIST_VERSION\&quot;&quot;
198 echo-info &quot;DEVKIT_SDK_VERSION=\&quot;$SDK_FULL_VERSION\&quot;&quot;
199 echo-info &quot;DEVKIT_UCRT_VERSION=\&quot;$UCRT_VERSION\&quot;&quot;
200 
201 ################################################################################
202 # Copy this script
203 
204 echo &quot;Copying this script...&quot;
205 cp $0 $DEVKIT_ROOT/
206 
207 ################################################################################
208 # Create bundle
209 
210 echo &quot;Creating bundle: $DEVKIT_BUNDLE&quot;
211 (cd &quot;$DEVKIT_ROOT&quot; &amp;&amp; tar zcf &quot;$DEVKIT_BUNDLE&quot; .)
</pre>
</td>
</tr>
</table>
<center><a href="../copy/Copy-java.base.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="../gensrc/GensrcCharacterData.gmk.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>