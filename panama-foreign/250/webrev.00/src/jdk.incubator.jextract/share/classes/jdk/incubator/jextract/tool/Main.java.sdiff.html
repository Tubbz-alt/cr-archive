<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.incubator.jextract/share/classes/jdk/incubator/jextract/tool/Main.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> <a href="resources/Messages.properties.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.incubator.jextract/share/classes/jdk/incubator/jextract/tool/Main.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
133 
134         if (optionSet.has(&quot;C&quot;)) {
135             optionSet.valuesOf(&quot;C&quot;).forEach(p -&gt; builder.addClangArg((String) p));
136         }
137 
138         if (optionSet.has(&quot;filter&quot;)) {
139             optionSet.valuesOf(&quot;filter&quot;).forEach(p -&gt; builder.addFilter((String) p));
140         }
141 
142         if (optionSet.has(&quot;d&quot;)) {
143             builder.setOutputDir(optionSet.valueOf(&quot;d&quot;).toString());
144         }
145 
146         if (optionSet.has(&quot;source&quot;)) {
147             builder.setGenerateSource();
148         }
149         boolean librariesSpecified = optionSet.has(&quot;l&quot;);
150         if (librariesSpecified) {
151             for (Object arg : optionSet.valuesOf(&quot;l&quot;)) {
152                 String lib = (String)arg;
<span class="line-modified">153                 if (lib.indexOf(File.separatorChar) != -1) {</span>
<span class="line-modified">154                     err.println(format(&quot;l.name.should.not.be.path&quot;, lib));</span>
<span class="line-modified">155                     return OPTION_ERROR;</span>







156                 }
<span class="line-removed">157                 builder.addLibraryName(lib);</span>
158             }
159         }
160 
161         String targetPackage = optionSet.has(&quot;t&quot;) ? (String) optionSet.valueOf(&quot;t&quot;) : &quot;&quot;;
162         builder.setTargetPackage(targetPackage);
163 
164         Options options = builder.build();
165 
166         Path header = Paths.get(optionSet.nonOptionArguments().get(0).toString());
167         if (!Files.isReadable(header)) {
168             err.println(format(&quot;cannot.read.header.file&quot;, header));
169             return INPUT_ERROR;
170         }
171 
172         //parse    //generate
173         try {
174             JextractTask jextractTask = JextractTask.newTask(!options.source, header);
175             Declaration.Scoped toplevel = jextractTask.parse(options.clangArgs.toArray(new String[0]));
176 
177             //filter
</pre>
</td>
<td>
<hr />
<pre>
133 
134         if (optionSet.has(&quot;C&quot;)) {
135             optionSet.valuesOf(&quot;C&quot;).forEach(p -&gt; builder.addClangArg((String) p));
136         }
137 
138         if (optionSet.has(&quot;filter&quot;)) {
139             optionSet.valuesOf(&quot;filter&quot;).forEach(p -&gt; builder.addFilter((String) p));
140         }
141 
142         if (optionSet.has(&quot;d&quot;)) {
143             builder.setOutputDir(optionSet.valueOf(&quot;d&quot;).toString());
144         }
145 
146         if (optionSet.has(&quot;source&quot;)) {
147             builder.setGenerateSource();
148         }
149         boolean librariesSpecified = optionSet.has(&quot;l&quot;);
150         if (librariesSpecified) {
151             for (Object arg : optionSet.valuesOf(&quot;l&quot;)) {
152                 String lib = (String)arg;
<span class="line-modified">153                 if (lib.indexOf(File.separatorChar) == -1) {</span>
<span class="line-modified">154                     builder.addLibraryName(lib);</span>
<span class="line-modified">155                 } else {</span>
<span class="line-added">156                     Path libPath = Paths.get(lib);</span>
<span class="line-added">157                     if (libPath.isAbsolute() &amp;&amp; Files.isRegularFile(libPath)) {</span>
<span class="line-added">158                         builder.addLibraryName(lib);</span>
<span class="line-added">159                     } else {</span>
<span class="line-added">160                         err.println(format(&quot;l.option.value.invalid&quot;, lib));</span>
<span class="line-added">161                         return OPTION_ERROR;</span>
<span class="line-added">162                     }</span>
163                 }

164             }
165         }
166 
167         String targetPackage = optionSet.has(&quot;t&quot;) ? (String) optionSet.valueOf(&quot;t&quot;) : &quot;&quot;;
168         builder.setTargetPackage(targetPackage);
169 
170         Options options = builder.build();
171 
172         Path header = Paths.get(optionSet.nonOptionArguments().get(0).toString());
173         if (!Files.isReadable(header)) {
174             err.println(format(&quot;cannot.read.header.file&quot;, header));
175             return INPUT_ERROR;
176         }
177 
178         //parse    //generate
179         try {
180             JextractTask jextractTask = JextractTask.newTask(!options.source, header);
181             Declaration.Scoped toplevel = jextractTask.parse(options.clangArgs.toArray(new String[0]));
182 
183             //filter
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> <a href="resources/Messages.properties.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>