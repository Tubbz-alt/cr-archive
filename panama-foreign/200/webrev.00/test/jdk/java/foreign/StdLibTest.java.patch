diff a/test/jdk/java/foreign/StdLibTest.java b/test/jdk/java/foreign/StdLibTest.java
--- a/test/jdk/java/foreign/StdLibTest.java
+++ b/test/jdk/java/foreign/StdLibTest.java
@@ -225,11 +225,11 @@
                 char[] chars = s1.toCharArray();
                 for (long i = 0 ; i < chars.length ; i++) {
                     byteArrHandle.set(buf.baseAddress(), i, (byte)chars[(int)i]);
                 }
                 byteArrHandle.set(buf.baseAddress(), (long)chars.length, (byte)'\0');
-                return toJavaString(((MemoryAddress)strcat.invokeExact(buf.baseAddress(), other.baseAddress())).rebase(buf));
+                return toJavaStringRestricted(((MemoryAddress)strcat.invokeExact(buf.baseAddress(), other.baseAddress())));
             }
         }
 
         int strcmp(String s1, String s2) throws Throwable {
             try (MemorySegment ns1 = toCString(s1) ;
@@ -440,14 +440,6 @@
                                 //drop n
                                 perms.stream());
                     }).collect(Collectors.toCollection(LinkedHashSet::new));
         }
     }
-
-    static MemorySegment toCString(String value) {
-        return Cstring.toCString(value);
-    }
-
-    static String toJavaString(MemoryAddress address) {
-        return Cstring.toJavaString(address);
-    }
 }
