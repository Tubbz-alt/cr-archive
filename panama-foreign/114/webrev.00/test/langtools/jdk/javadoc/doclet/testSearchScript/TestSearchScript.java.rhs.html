<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames test/langtools/jdk/javadoc/doclet/testSearchScript/TestSearchScript.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (c) 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 /*
 25  * @test
<a name="1" id="anc1"></a><span class="line-modified"> 26  * @bug 8178982 8220497 8210683 8241982</span>
 27  * @summary Test the search feature of javadoc.
 28  * @library ../../lib
 29  * @modules jdk.javadoc/jdk.javadoc.internal.tool
 30  * @build javadoc.tester.*
 31  * @run main TestSearchScript
 32  */
 33 
 34 import javadoc.tester.JavadocTester;
 35 
<a name="2" id="anc2"></a><span class="line-added"> 36 import javax.script.Bindings;</span>
 37 import javax.script.Invocable;
<a name="3" id="anc3"></a><span class="line-added"> 38 import javax.script.ScriptContext;</span>
 39 import javax.script.ScriptEngine;
 40 import javax.script.ScriptEngineManager;
 41 import javax.script.ScriptException;
 42 import java.io.BufferedReader;
 43 import java.io.File;
 44 import java.io.FileReader;
 45 import java.io.IOException;
 46 import java.util.List;
 47 
 48 /*
<a name="4" id="anc4"></a><span class="line-modified"> 49  * Tests for the search feature using any available javax.script JavaScript engine.</span>
<span class="line-added"> 50  * The test is skipped if no JavaScript engine is available.</span>
 51  */
 52 public class TestSearchScript extends JavadocTester {
 53 
 54     public static void main(String... args) throws Exception {
 55         TestSearchScript tester = new TestSearchScript();
 56         tester.runTests();
 57     }
 58 
 59     private Invocable getEngine() throws ScriptException, IOException, NoSuchMethodException {
 60         ScriptEngineManager engineManager = new ScriptEngineManager();
<a name="5" id="anc5"></a><span class="line-modified"> 61         // Use &quot;js&quot; engine name to use any available JavaScript engine.</span>
<span class="line-added"> 62         ScriptEngine engine = engineManager.getEngineByName(&quot;js&quot;);</span>
<span class="line-added"> 63         if (engine == null) {</span>
<span class="line-added"> 64             return null;</span>
<span class="line-added"> 65         }</span>
<span class="line-added"> 66         // For GraalJS set Nashorn compatibility mode via Bindings,</span>
<span class="line-added"> 67         // see https://github.com/graalvm/graaljs/blob/master/docs/user/ScriptEngine.md</span>
<span class="line-added"> 68         Bindings bindings = engine.getBindings(ScriptContext.ENGINE_SCOPE);</span>
<span class="line-added"> 69         bindings.put(&quot;polyglot.js.nashorn-compat&quot;, true);</span>
 70         engine.eval(new BufferedReader(new FileReader(new File(testSrc, &quot;javadoc-search.js&quot;))));
 71         Invocable inv = (Invocable) engine;
 72         inv.invokeFunction(&quot;loadIndexFiles&quot;, outputDir.getAbsolutePath());
 73         return inv;
 74     }
 75 
 76     @Test
 77     public void testModuleSearch() throws ScriptException, IOException, NoSuchMethodException {
 78         javadoc(&quot;-d&quot;, &quot;out-full&quot;,
 79                 &quot;-Xdoclint:none&quot;,
 80                 &quot;-use&quot;,
 81                 &quot;--module-source-path&quot;, testSrc,
 82                 &quot;--module&quot;, &quot;mapmodule&quot;,
 83                 &quot;mappkg&quot;, &quot;mappkg.impl&quot;);
 84         checkExit(Exit.OK);
 85 
 86         Invocable inv = getEngine();
 87 
<a name="6" id="anc6"></a><span class="line-added"> 88         if (inv == null) {</span>
<span class="line-added"> 89             out.println(&quot;No JavaScript engine available. Test skipped.&quot;);</span>
<span class="line-added"> 90             return;</span>
<span class="line-added"> 91         }</span>
<span class="line-added"> 92 </span>
 93         // exact match, case sensitivity
 94         checkSearch(inv, &quot;mapmodule&quot;, List.of(&quot;mapmodule&quot;));
 95         checkSearch(inv, &quot;mappkg&quot;, List.of(&quot;mapmodule/mappkg&quot;, &quot;mapmodule/mappkg.impl&quot;, &quot;mappkg.system.property&quot;));
 96         checkSearch(inv, &quot;Mapmodule&quot;, List.of());
 97         checkSearch(inv, &quot;Mappkg&quot;, List.of());
 98         checkSearch(inv, &quot;mymap&quot;, List.of(&quot;mappkg.impl.MyMap&quot;, &quot;mappkg.impl.MyMap.MyMap()&quot;, &quot;mappkg.impl.MyMap.MyMap(Map)&quot;));
 99         checkSearch(inv, &quot;MyMap&quot;, List.of(&quot;mappkg.impl.MyMap&quot;, &quot;mappkg.impl.MyMap.MyMap()&quot;, &quot;mappkg.impl.MyMap.MyMap(Map)&quot;));
100         checkSearch(inv, &quot;mymap(&quot;, List.of(&quot;mappkg.impl.MyMap.MyMap()&quot;, &quot;mappkg.impl.MyMap.MyMap(Map)&quot;));
101         checkSearch(inv, &quot;MyMap(&quot;, List.of(&quot;mappkg.impl.MyMap.MyMap()&quot;, &quot;mappkg.impl.MyMap.MyMap(Map)&quot;));
102         checkSearch(inv, &quot;mymap()&quot;, List.of(&quot;mappkg.impl.MyMap.MyMap()&quot;));
103         checkSearch(inv, &quot;MyMap()&quot;, List.of(&quot;mappkg.impl.MyMap.MyMap()&quot;));
104         checkSearch(inv, &quot;Mymap&quot;, List.of());
105         checkSearch(inv, &quot;Mymap()&quot;, List.of());
106 
107         // left boundaries, ranking
108         checkSearch(inv, &quot;map&quot;, List.of(&quot;mapmodule&quot;, &quot;mapmodule/mappkg&quot;, &quot;mapmodule/mappkg.impl&quot;, &quot;mappkg.Map&quot;, &quot;mappkg.impl.MyMap&quot;,
109                                         &quot;mappkg.impl.MyMap.MyMap()&quot;, &quot;mappkg.impl.MyMap.MyMap(Map)&quot;, &quot;mappkg.system.property&quot;));
110         checkSearch(inv, &quot;Map&quot;, List.of(&quot;mappkg.Map&quot;, &quot;mappkg.impl.MyMap&quot;, &quot;mappkg.impl.MyMap.MyMap()&quot;,
111                                         &quot;mappkg.impl.MyMap.MyMap(Map)&quot;));
112         checkSearch(inv, &quot;MAP&quot;, List.of());
113         checkSearch(inv, &quot;value&quot;, List.of(&quot;mappkg.impl.MyMap.OTHER_VALUE&quot;, &quot;mappkg.impl.MyMap.some_value&quot;));
114         checkSearch(inv, &quot;VALUE&quot;, List.of(&quot;mappkg.impl.MyMap.OTHER_VALUE&quot;));
115         checkSearch(inv, &quot;map.other&quot;, List.of(&quot;mappkg.impl.MyMap.OTHER_VALUE&quot;));
116         checkSearch(inv, &quot;Map.some_&quot;, List.of(&quot;mappkg.impl.MyMap.some_value&quot;));
117 
118         checkSearch(inv, &quot;Mm&quot;, List.of());
119         checkSearch(inv, &quot;mym&quot;, List.of(&quot;mappkg.impl.MyMap&quot;, &quot;mappkg.impl.MyMap.MyMap()&quot;, &quot;mappkg.impl.MyMap.MyMap(Map)&quot;));
120         checkSearch(inv, &quot;imp.mym.mym(&quot;, List.of(&quot;mappkg.impl.MyMap.MyMap()&quot;, &quot;mappkg.impl.MyMap.MyMap(Map)&quot;));
121         checkSearch(inv, &quot;imp.mym.mym(m&quot;, List.of(&quot;mappkg.impl.MyMap.MyMap(Map)&quot;));
122 
123         // camel case
124         checkSearch(inv, &quot;MM&quot;, List.of(&quot;mappkg.impl.MyMap&quot;, &quot;mappkg.impl.MyMap.MyMap()&quot;, &quot;mappkg.impl.MyMap.MyMap(Map)&quot;));
125         checkSearch(inv, &quot;MyM&quot;, List.of(&quot;mappkg.impl.MyMap&quot;, &quot;mappkg.impl.MyMap.MyMap()&quot;, &quot;mappkg.impl.MyMap.MyMap(Map)&quot;));
126         checkSearch(inv, &quot;Mym&quot;, List.of());
127         checkSearch(inv, &quot;i.MyM.MyM(&quot;, List.of(&quot;mappkg.impl.MyMap.MyMap()&quot;, &quot;mappkg.impl.MyMap.MyMap(Map)&quot;));
128         checkSearch(inv, &quot;i.MMa.MMa(&quot;, List.of(&quot;mappkg.impl.MyMap.MyMap()&quot;, &quot;mappkg.impl.MyMap.MyMap(Map)&quot;));
129         checkSearch(inv, &quot;i.MyM.MyM(Ma&quot;, List.of(&quot;mappkg.impl.MyMap.MyMap(Map)&quot;));
130         checkSearch(inv, &quot;i.MMa.MMa(M&quot;, List.of(&quot;mappkg.impl.MyMap.MyMap(Map)&quot;));
131         checkSearch(inv, &quot;i.Mym.MyM(&quot;, List.of());
132         checkSearch(inv, &quot;i.Mym.Ma(&quot;, List.of());
133 
134         checkSearch(inv, &quot;mapm&quot;, List.of(&quot;mapmodule&quot;));
135 
136         // child entity listing
137         checkSearch(inv, &quot;mapmodule/&quot;, List.of(&quot;mapmodule/mappkg&quot;, &quot;mapmodule/mappkg.impl&quot;));
138         checkSearch(inv, &quot;mapmod/&quot;, List.of(&quot;mapmodule/mappkg&quot;, &quot;mapmodule/mappkg.impl&quot;));
139         checkSearch(inv, &quot;module/&quot;, List.of());
140         checkSearch(inv, &quot;le/&quot;, List.of());
141         checkSearch(inv, &quot;mapmodule.&quot;, List.of());
142         checkSearch(inv, &quot;mapmod.&quot;, List.of());
143         checkSearch(inv, &quot;mappkg.&quot;, List.of(&quot;mapmodule/mappkg.impl&quot;, &quot;mappkg.Map&quot;, &quot;mappkg.system.property&quot;));
144         checkSearch(inv, &quot;mappkg.&quot;, List.of(&quot;mapmodule/mappkg.impl&quot;, &quot;mappkg.Map&quot;, &quot;mappkg.system.property&quot;));
145         checkSearch(inv, &quot;Map.&quot;, List.of(&quot;mappkg.Map.contains(Object)&quot;, &quot;mappkg.Map.get(Object)&quot;, &quot;mappkg.Map.iterate()&quot;,
146                                          &quot;mappkg.Map.put(Object, Object)&quot;, &quot;mappkg.Map.remove(Object)&quot;,
147                                          &quot;mappkg.impl.MyMap.contains(Object)&quot;, &quot;mappkg.impl.MyMap.get(Object)&quot;,
148                                          &quot;mappkg.impl.MyMap.iterate()&quot;, &quot;mappkg.impl.MyMap.MyMap()&quot;,
149                                          &quot;mappkg.impl.MyMap.MyMap(Map)&quot;, &quot;mappkg.impl.MyMap.OTHER_VALUE&quot;,
150                                          &quot;mappkg.impl.MyMap.put(Object, Object)&quot;, &quot;mappkg.impl.MyMap.remove(Object)&quot;,
151                                          &quot;mappkg.impl.MyMap.some_value&quot;));
152         checkSearch(inv, &quot;mym.&quot;, List.of(&quot;mappkg.impl.MyMap.contains(Object)&quot;, &quot;mappkg.impl.MyMap.get(Object)&quot;,
153                                          &quot;mappkg.impl.MyMap.iterate()&quot;, &quot;mappkg.impl.MyMap.MyMap()&quot;,
154                                          &quot;mappkg.impl.MyMap.MyMap(Map)&quot;, &quot;mappkg.impl.MyMap.OTHER_VALUE&quot;,
155                                          &quot;mappkg.impl.MyMap.put(Object, Object)&quot;, &quot;mappkg.impl.MyMap.remove(Object)&quot;,
156                                          &quot;mappkg.impl.MyMap.some_value&quot;));
157         checkSearch(inv, &quot;MyMap.i&quot;, List.of(&quot;mappkg.impl.MyMap.iterate()&quot;));
158 
159         // system properties
160         checkSearch(inv, &quot;mappkg.system.property&quot;, List.of(&quot;mappkg.system.property&quot;));
161         checkSearch(inv, &quot;system.property&quot;, List.of(&quot;mappkg.system.property&quot;));
162         checkSearch(inv, &quot;property&quot;, List.of(&quot;mappkg.system.property&quot;));
163         checkSearch(inv, &quot;sys.prop&quot;, List.of(&quot;mappkg.system.property&quot;));
164         checkSearch(inv, &quot;m.s.p&quot;, List.of(&quot;mappkg.system.property&quot;));
165         checkSearch(inv, &quot;operty&quot;, List.of());
166 
167         // search tag
168         checkSearch(inv, &quot;search tag&quot;, List.of(&quot;multiline search tag&quot;, &quot;search tag&quot;));
169         checkSearch(inv, &quot;search   tag&quot;, List.of(&quot;multiline search tag&quot;, &quot;search tag&quot;));
170         checkSearch(inv, &quot;search &quot;, List.of(&quot;multiline search tag&quot;, &quot;search tag&quot;));
171         checkSearch(inv, &quot;tag&quot;, List.of(&quot;multiline search tag&quot;, &quot;search tag&quot;));
172         checkSearch(inv, &quot;sea&quot;, List.of(&quot;multiline search tag&quot;, &quot;search tag&quot;));
173         checkSearch(inv, &quot;multi&quot;, List.of(&quot;multiline search tag&quot;));
174         checkSearch(inv, &quot;ear&quot;, List.of());
175     }
176 
177 
178     @Test
179     public void testPackageSource() throws ScriptException, IOException, NoSuchMethodException {
180         javadoc(&quot;-d&quot;, &quot;out-overload&quot;,
181                 &quot;-Xdoclint:none&quot;,
182                 &quot;-use&quot;,
183                 &quot;-sourcepath&quot;, testSrc,
184                 &quot;listpkg&quot;);
185         checkExit(Exit.OK);
186 
187         Invocable inv = getEngine();
188 
<a name="7" id="anc7"></a><span class="line-added">189         if (inv == null) {</span>
<span class="line-added">190             out.println(&quot;No JavaScript engine available. Test skipped.&quot;);</span>
<span class="line-added">191             return;</span>
<span class="line-added">192         }</span>
<span class="line-added">193 </span>
194         // exact match, case sensitvity, left boundaries
195         checkSearch(inv, &quot;list&quot;, List.of(&quot;listpkg&quot;, &quot;listpkg.List&quot;, &quot;listpkg.ListProvider&quot;, &quot;listpkg.MyList&quot;,
196                                          &quot;listpkg.MyListFactory&quot;, &quot;listpkg.ListProvider.ListProvider()&quot;,
197                                          &quot;listpkg.MyListFactory.createList(ListProvider, MyListFactory)&quot;,
198                                          &quot;listpkg.ListProvider.makeNewList()&quot;,
199                                          &quot;listpkg.MyList.MyList()&quot;, &quot;listpkg.MyListFactory.MyListFactory()&quot;));
200         checkSearch(inv, &quot;List&quot;, List.of(&quot;listpkg.List&quot;, &quot;listpkg.ListProvider&quot;, &quot;listpkg.MyList&quot;,
201                                          &quot;listpkg.MyListFactory&quot;, &quot;listpkg.ListProvider.ListProvider()&quot;,
202                                          &quot;listpkg.MyListFactory.createList(ListProvider, MyListFactory)&quot;,
203                                          &quot;listpkg.ListProvider.makeNewList()&quot;,
204                                          &quot;listpkg.MyList.MyList()&quot;, &quot;listpkg.MyListFactory.MyListFactory()&quot;));
205 
206         // partial match
207         checkSearch(inv, &quot;fact&quot;, List.of(&quot;listpkg.MyListFactory&quot;, &quot;listpkg.MyListFactory.MyListFactory()&quot;));
208         checkSearch(inv, &quot;pro&quot;, List.of(&quot;listpkg.ListProvider&quot;, &quot;listpkg.ListProvider.ListProvider()&quot;));
209         checkSearch(inv, &quot;listpro&quot;, List.of(&quot;listpkg.ListProvider&quot;, &quot;listpkg.ListProvider.ListProvider()&quot;));
210 
211         // camel case
212         checkSearch(inv, &quot;l.MLF.cL(LP, MLF)&quot;, List.of(&quot;listpkg.MyListFactory.createList(ListProvider, MyListFactory)&quot;));
213         checkSearch(inv, &quot;Fact.creaLi(LiPro,MLiFact)&quot;, List.of(&quot;listpkg.MyListFactory.createList(ListProvider, MyListFactory)&quot;));
214         checkSearch(inv, &quot;(LP,ML&quot;, List.of(&quot;listpkg.MyListFactory.createList(ListProvider, MyListFactory)&quot;));
215 
216         // ranking of overloaded methods JDK-8210683
217         checkSearch(inv, &quot;list.of&quot;,
218                 List.of(&quot;listpkg.List.of()&quot;, &quot;listpkg.List.of(E)&quot;, &quot;listpkg.List.of(E, E)&quot;,
219                         &quot;listpkg.List.of(E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E)&quot;,
220                         &quot;listpkg.List.of(E, E, E, E, E)&quot;, &quot;listpkg.List.of(E...)&quot;));
221         checkSearch(inv, &quot;Li.of&quot;,
222                 List.of(&quot;listpkg.List.of()&quot;, &quot;listpkg.List.of(E)&quot;, &quot;listpkg.List.of(E, E)&quot;,
223                         &quot;listpkg.List.of(E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E)&quot;,
224                         &quot;listpkg.List.of(E, E, E, E, E)&quot;, &quot;listpkg.List.of(E...)&quot;));
225         checkSearch(inv, &quot;li.Li.o&quot;,
226                 List.of(&quot;listpkg.List.of()&quot;, &quot;listpkg.List.of(E)&quot;, &quot;listpkg.List.of(E, E)&quot;,
227                         &quot;listpkg.List.of(E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E)&quot;,
228                         &quot;listpkg.List.of(E, E, E, E, E)&quot;, &quot;listpkg.List.of(E...)&quot;));
229         checkSearch(inv, &quot;l.l.o&quot;,
230                 List.of(&quot;listpkg.List.of()&quot;, &quot;listpkg.List.of(E)&quot;, &quot;listpkg.List.of(E, E)&quot;,
231                         &quot;listpkg.List.of(E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E)&quot;,
232                         &quot;listpkg.List.of(E, E, E, E, E)&quot;, &quot;listpkg.List.of(E...)&quot;));
233         checkSearch(inv, &quot;L.l.o&quot;, List.of());
234 
235         // whitespace
236         checkSearch(inv, &quot;(e,e,e&quot;,
237                 List.of(&quot;listpkg.List.of(E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E)&quot;,
238                         &quot;listpkg.List.of(E, E, E, E, E)&quot;));
239         checkSearch(inv, &quot;(e, e,e&quot;,
240                 List.of(&quot;listpkg.List.of(E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E)&quot;,
241                         &quot;listpkg.List.of(E, E, E, E, E)&quot;));
242         checkSearch(inv, &quot;(e, e, e&quot;,
243                 List.of(&quot;listpkg.List.of(E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E)&quot;,
244                         &quot;listpkg.List.of(E, E, E, E, E)&quot;));
245         checkSearch(inv, &quot;(e,   e,  e&quot;,
246                 List.of(&quot;listpkg.List.of(E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E)&quot;,
247                 &quot;listpkg.List.of(E, E, E, E, E)&quot;));
248         checkSearch(inv, &quot;(e, e, e ,&quot;,
249                 List.of(&quot;listpkg.List.of(E, E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E, E)&quot;));
250         checkSearch(inv, &quot;(e   ,   e,  e,&quot;,
251                 List.of(&quot;listpkg.List.of(E, E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E, E)&quot;));
252         checkSearch(inv, &quot;  listpkg  .list .of &quot;,
253                 List.of(&quot;listpkg.List.of()&quot;, &quot;listpkg.List.of(E)&quot;, &quot;listpkg.List.of(E, E)&quot;,
254                         &quot;listpkg.List.of(E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E)&quot;,
255                         &quot;listpkg.List.of(E, E, E, E, E)&quot;, &quot;listpkg.List.of(E...)&quot;));
256         checkSearch(inv, &quot; l. l. o&quot;,
257                 List.of(&quot;listpkg.List.of()&quot;, &quot;listpkg.List.of(E)&quot;, &quot;listpkg.List.of(E, E)&quot;,
258                         &quot;listpkg.List.of(E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E)&quot;,
259                         &quot;listpkg.List.of(E, E, E, E, E)&quot;, &quot;listpkg.List.of(E...)&quot;));
260         checkSearch(inv, &quot;list . of&quot;,
261                 List.of(&quot;listpkg.List.of()&quot;, &quot;listpkg.List.of(E)&quot;, &quot;listpkg.List.of(E, E)&quot;,
262                         &quot;listpkg.List.of(E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E)&quot;,
263                         &quot;listpkg.List.of(E, E, E, E, E)&quot;, &quot;listpkg.List.of(E...)&quot;));
264         checkSearch(inv, &quot;lis t.of&quot;, List.of());
265         checkSearch(inv, &quot;list . of(e,e,e,&quot;,
266                 List.of(&quot;listpkg.List.of(E, E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E, E)&quot;));
267         checkSearch(inv, &quot;l . o (e,e,e,&quot;,
268                 List.of(&quot;listpkg.List.of(E, E, E, E)&quot;, &quot;listpkg.List.of(E, E, E, E, E)&quot;));
269         checkSearch(inv, &quot;search    \tt&quot;, List.of(&quot;other search tag&quot;));
270         checkSearch(inv, &quot;sear ch&quot;, List.of());
271         checkSearch(inv, &quot;( e ..&quot;, List.of(&quot;listpkg.List.of(E...)&quot;));
272         checkSearch(inv, &quot;( i [ ]&quot;, List.of(&quot;listpkg.Nolist.withArrayArg(int[])&quot;));
273 
274         // empty/white space search should not trigger results
275         checkNullSearch(inv, &quot;&quot;);
276         checkNullSearch(inv, &quot; &quot;);
277         checkNullSearch(inv, &quot;    &quot;);
278         checkNullSearch(inv, &quot; \t\t &quot;);
279 
280 
281         // _ word boundaries and case sensitivity
282         checkSearch(inv, &quot;some&quot;, List.of(&quot;listpkg.Nolist.SOME_INT_CONSTANT&quot;));
283         checkSearch(inv, &quot;SOME&quot;, List.of(&quot;listpkg.Nolist.SOME_INT_CONSTANT&quot;));
284         checkSearch(inv, &quot;Some&quot;, List.of());
285         checkSearch(inv, &quot;int&quot;, List.of(&quot;listpkg.Nolist.SOME_INT_CONSTANT&quot;));
286         checkSearch(inv, &quot;INT&quot;, List.of(&quot;listpkg.Nolist.SOME_INT_CONSTANT&quot;));
287         checkSearch(inv, &quot;Int&quot;, List.of());
288         checkSearch(inv, &quot;int_con&quot;, List.of(&quot;listpkg.Nolist.SOME_INT_CONSTANT&quot;));
289         checkSearch(inv, &quot;INT_CON&quot;, List.of(&quot;listpkg.Nolist.SOME_INT_CONSTANT&quot;));
290         checkSearch(inv, &quot;NT&quot;, List.of());
291         checkSearch(inv, &quot;NT_&quot;, List.of());
292         checkSearch(inv, &quot;_const&quot;, List.of(&quot;listpkg.Nolist.SOME_INT_CONSTANT&quot;));
293         checkSearch(inv, &quot;_CONST&quot;, List.of(&quot;listpkg.Nolist.SOME_INT_CONSTANT&quot;));
294 
295         // Test for all packages, all classes links
296         checkSearch(inv, &quot;all&quot;, List.of(&quot;All Packages&quot;, &quot;All Classes&quot;));
297         checkSearch(inv, &quot;All&quot;, List.of(&quot;All Packages&quot;, &quot;All Classes&quot;));
298         checkSearch(inv, &quot;ALL&quot;, List.of());
299 
300         // test for generic types, var-arg and array args
301         checkSearch(inv, &quot;(map&lt;string, ? ext collection&gt;)&quot;,
302                 List.of(&quot;listpkg.Nolist.withTypeParams(Map&lt;String, ? extends Collection&gt;)&quot;));
303         checkSearch(inv, &quot;(m&lt;str,? ext coll&gt;&quot;,
304                 List.of(&quot;listpkg.Nolist.withTypeParams(Map&lt;String, ? extends Collection&gt;)&quot;));
305         checkSearch(inv, &quot;(object...&quot;, List.of(&quot;listpkg.Nolist.withVarArgs(Object...)&quot;));
306         checkSearch(inv, &quot;(obj...&quot;, List.of(&quot;listpkg.Nolist.withVarArgs(Object...)&quot;));
307         checkSearch(inv, &quot;(e..&quot;, List.of(&quot;listpkg.List.of(E...)&quot;));
308         checkSearch(inv, &quot;(int[]&quot;, List.of(&quot;listpkg.Nolist.withArrayArg(int[])&quot;));
309         checkSearch(inv, &quot;(i[]&quot;, List.of(&quot;listpkg.Nolist.withArrayArg(int[])&quot;));
310     }
311 
312     void checkSearch(Invocable inv, String query, List&lt;String&gt; results) throws ScriptException, NoSuchMethodException {
313         checkList((List) inv.invokeFunction(&quot;search&quot;, query), results);
314     }
315 
316     void checkList(List&lt;?&gt; result, List&lt;?&gt; expected) {
317         checking(&quot;Checking list: &quot; + result);
318         if (!expected.equals(result)) {
319             failed(&quot;Expected: &quot; + expected + &quot;, got: &quot; + result);
320         } else {
321             passed(&quot;List matches expected result&quot;);
322         }
323     }
324 
325     void checkNullSearch(Invocable inv, String query) throws ScriptException, NoSuchMethodException {
326         Object result = inv.invokeFunction(&quot;search&quot;, query);
327         checking(&quot;Checking null result&quot;);
328         if (result == null) {
329             passed(&quot;Result is null as expected&quot;);
330         } else {
331             failed(&quot;Expected: null, got: &quot; + result);
332         }
333     }
334 }
<a name="8" id="anc8"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="8" type="hidden" />
</body>
</html>