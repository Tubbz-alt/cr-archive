<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/jdk/com/sun/crypto/provider/Mac/MacKAT.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../ProblemList.txt.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../../java/awt/Choice/UnfocusableToplevel/UnfocusableToplevel.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/com/sun/crypto/provider/Mac/MacKAT.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2012, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 21,11 ***</span>
   * questions.
   */
  
  /**
   * @test
<span class="line-modified">!  * @bug 4846410 6313661 4963723</span>
   * @summary Basic known-answer-test for Hmac and SslMac algorithms
   * @author Andreas Sterbenz
   */
  
  import java.io.*;
<span class="line-new-header">--- 21,11 ---</span>
   * questions.
   */
  
  /**
   * @test
<span class="line-modified">!  * @bug 4846410 6313661 4963723 8172680</span>
   * @summary Basic known-answer-test for Hmac and SslMac algorithms
   * @author Andreas Sterbenz
   */
  
  import java.io.*;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 38,30 ***</span>
  
  public class MacKAT {
  
      private final static char[] hexDigits = &quot;0123456789abcdef&quot;.toCharArray();
  
      public static String toString(byte[] b) {
          if (b == null) {
              return &quot;(null)&quot;;
          }
          StringBuffer sb = new StringBuffer(b.length * 3);
          for (int i = 0; i &lt; b.length; i++) {
              int k = b[i] &amp; 0xff;
              if (i != 0) {
<span class="line-modified">!                 sb.append(&#39;:&#39;);</span>
              }
              sb.append(hexDigits[k &gt;&gt;&gt; 4]);
              sb.append(hexDigits[k &amp; 0xf]);
          }
          return sb.toString();
      }
  
      public static byte[] parse(String s) {
          try {
              int n = s.length();
<span class="line-modified">!             ByteArrayOutputStream out = new ByteArrayOutputStream(n / 3);</span>
              StringReader r = new StringReader(s);
              while (true) {
                  int b1 = nextNibble(r);
                  if (b1 &lt; 0) {
                      break;
<span class="line-new-header">--- 38,40 ---</span>
  
  public class MacKAT {
  
      private final static char[] hexDigits = &quot;0123456789abcdef&quot;.toCharArray();
  
<span class="line-added">+     private final static char SEP = &#39;:&#39;;</span>
<span class="line-added">+ </span>
<span class="line-added">+     static boolean testFailed = false;</span>
<span class="line-added">+ </span>
      public static String toString(byte[] b) {
          if (b == null) {
              return &quot;(null)&quot;;
          }
          StringBuffer sb = new StringBuffer(b.length * 3);
          for (int i = 0; i &lt; b.length; i++) {
              int k = b[i] &amp; 0xff;
              if (i != 0) {
<span class="line-modified">!                 sb.append(SEP);</span>
              }
              sb.append(hexDigits[k &gt;&gt;&gt; 4]);
              sb.append(hexDigits[k &amp; 0xf]);
          }
          return sb.toString();
      }
  
      public static byte[] parse(String s) {
          try {
              int n = s.length();
<span class="line-modified">!             ByteArrayOutputStream out;</span>
<span class="line-added">+             if (s.indexOf(SEP) == -1) {</span>
<span class="line-added">+                 out = new ByteArrayOutputStream(n / 2);</span>
<span class="line-added">+             } else {</span>
<span class="line-added">+                 out = new ByteArrayOutputStream(n / 3);</span>
<span class="line-added">+             }</span>
<span class="line-added">+ </span>
              StringReader r = new StringReader(s);
              while (true) {
                  int b1 = nextNibble(r);
                  if (b1 &lt; 0) {
                      break;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 111,27 ***</span>
              this.alg = alg;
              this.input = input;
              this.macvalue = macvalue;
              this.key = key;
          }
<span class="line-modified">!         void run(Provider p) throws Exception {</span>
<span class="line-modified">!             Mac mac = Mac.getInstance(alg, p);</span>
<span class="line-modified">!             SecretKey keySpec = new SecretKeySpec(key, alg);</span>
<span class="line-modified">!             mac.init(keySpec);</span>
<span class="line-modified">!             mac.update(input);</span>
<span class="line-modified">!             byte[] macv = mac.doFinal();</span>
              if (Arrays.equals(macvalue, macv) == false) {
                  System.out.println(&quot;Mac test for &quot; + alg + &quot; failed:&quot;);
                  if (input.length &lt; 256) {
                      System.out.println(&quot;input:       &quot; + toString(input));
                  }
                  System.out.println(&quot;key:        &quot; + toString(key));
                  System.out.println(&quot;macvalue:   &quot; + toString(macvalue));
                  System.out.println(&quot;calculated: &quot; + toString(macv));
<span class="line-modified">!                 throw new Exception(&quot;Mac test for &quot; + alg + &quot; failed&quot;);</span>
              }
<span class="line-removed">-             System.out.println(&quot;passed: &quot; + alg);</span>
          }
          private static String toString(byte[] b) {
              return MacKAT.toString(b);
          }
      }
<span class="line-new-header">--- 121,54 ---</span>
              this.alg = alg;
              this.input = input;
              this.macvalue = macvalue;
              this.key = key;
          }
<span class="line-modified">!         void run(Provider p) {</span>
<span class="line-modified">!             Mac mac = null;</span>
<span class="line-modified">!             try {</span>
<span class="line-modified">!                 mac = Mac.getInstance(alg, p);</span>
<span class="line-modified">!             } catch (NoSuchAlgorithmException nsae) {</span>
<span class="line-modified">!                 System.out.println(&quot;Skip test for &quot; + alg +</span>
<span class="line-added">+                     &quot; due to lack of support&quot;);</span>
<span class="line-added">+                 return;</span>
<span class="line-added">+             }</span>
<span class="line-added">+             // ensure there is matching KeyGenerator support</span>
<span class="line-added">+             if (!alg.startsWith(&quot;SslMac&quot;)) {</span>
<span class="line-added">+                 try {</span>
<span class="line-added">+                     KeyGenerator.getInstance(alg, p);</span>
<span class="line-added">+                 } catch (NoSuchAlgorithmException nsae) {</span>
<span class="line-added">+                     System.out.println(&quot;Test Failed due to &quot; + nsae);</span>
<span class="line-added">+                     MacKAT.testFailed = true;</span>
<span class="line-added">+                     return;</span>
<span class="line-added">+                 }</span>
<span class="line-added">+             }</span>
<span class="line-added">+             byte[] macv = null;</span>
<span class="line-added">+             try {</span>
<span class="line-added">+                 SecretKey keySpec = new SecretKeySpec(key, alg);</span>
<span class="line-added">+                 mac.init(keySpec);</span>
<span class="line-added">+                 mac.update(input);</span>
<span class="line-added">+                 macv = mac.doFinal();</span>
<span class="line-added">+             } catch (Exception e) {</span>
<span class="line-added">+                 System.out.println(&quot;Unexpected ex when testing &quot; + alg + &quot;: &quot;);</span>
<span class="line-added">+                 e.printStackTrace();</span>
<span class="line-added">+                 MacKAT.testFailed = true;</span>
<span class="line-added">+                 return;</span>
<span class="line-added">+             }</span>
<span class="line-added">+ </span>
              if (Arrays.equals(macvalue, macv) == false) {
                  System.out.println(&quot;Mac test for &quot; + alg + &quot; failed:&quot;);
                  if (input.length &lt; 256) {
                      System.out.println(&quot;input:       &quot; + toString(input));
                  }
                  System.out.println(&quot;key:        &quot; + toString(key));
                  System.out.println(&quot;macvalue:   &quot; + toString(macvalue));
                  System.out.println(&quot;calculated: &quot; + toString(macv));
<span class="line-modified">!                 MacKAT.testFailed = true;</span>
<span class="line-added">+             } else {</span>
<span class="line-added">+                 System.out.println(&quot;passed: &quot; + alg);</span>
              }
          }
          private static String toString(byte[] b) {
              return MacKAT.toString(b);
          }
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 155,31 ***</span>
      }
  
      private static Test t(String alg, byte[] input, String macvalue, byte[] key) {
          return new MacTest(alg, input, b(macvalue), key);
      }
<span class="line-modified">!     private final static byte[] ALONG, BLONG, BKEY;</span>
<span class="line-modified">!     private final static byte[] BKEY_20, DDDATA_50, AAKEY_20, CDDATA_50, AAKEY_131;</span>
  
      static {
          ALONG = new byte[1024 * 128];
          Arrays.fill(ALONG, (byte)&#39;a&#39;);
          BLONG = new byte[1024 * 128];
          Random random = new Random(12345678);
          random.nextBytes(BLONG);
          BKEY = new byte[128];
          random.nextBytes(BKEY);
          BKEY_20 = new byte[20];
          Arrays.fill(BKEY_20, (byte) 0x0b);
<span class="line-modified">!         DDDATA_50 = new byte[50];</span>
<span class="line-modified">!         Arrays.fill(DDDATA_50, (byte) 0xdd);</span>
          AAKEY_20 = new byte[20];
          Arrays.fill(AAKEY_20, (byte) 0xaa);
<span class="line-removed">-         CDDATA_50 = new byte[50];</span>
<span class="line-removed">-         Arrays.fill(CDDATA_50, (byte) 0xcd);</span>
          AAKEY_131 = new byte[131];
          Arrays.fill(AAKEY_131, (byte) 0xaa);
      }
  
      private final static Test[] tests = {
          t(&quot;SslMacMD5&quot;, ALONG, &quot;f4:ad:01:71:51:f6:89:56:72:a3:32:bf:d9:2a:f2:a5&quot;,
                  &quot;1b:34:61:29:05:0d:73:db:25:d0:dd:64:06:29:f6:8a&quot;),
<span class="line-new-header">--- 192,59 ---</span>
      }
  
      private static Test t(String alg, byte[] input, String macvalue, byte[] key) {
          return new MacTest(alg, input, b(macvalue), key);
      }
<span class="line-modified">!     private final static byte[] ALONG, BLONG, DDDATA_50, CDDATA_50;</span>
<span class="line-modified">!     private final static byte[] STR_HI_THERE, STR_WHAT_DO_YA_WANT;</span>
<span class="line-added">+     private final static byte[] STR_TEST_USING1, STR_TEST_USING2;</span>
<span class="line-added">+     private final static byte[] STR_NIST1, STR_NIST2, STR_NIST3;</span>
<span class="line-added">+     private final static byte[] BKEY, BKEY_20, CKEY_20;</span>
<span class="line-added">+     private final static byte[] AAKEY_20, AAKEY_131, AAKEY_147, INCKEY_25;</span>
<span class="line-added">+     private final static byte[] NISTKEY_172;</span>
  
      static {
          ALONG = new byte[1024 * 128];
          Arrays.fill(ALONG, (byte)&#39;a&#39;);
          BLONG = new byte[1024 * 128];
          Random random = new Random(12345678);
          random.nextBytes(BLONG);
<span class="line-added">+         DDDATA_50 = new byte[50];</span>
<span class="line-added">+         Arrays.fill(DDDATA_50, (byte) 0xdd);</span>
<span class="line-added">+         CDDATA_50 = new byte[50];</span>
<span class="line-added">+         Arrays.fill(CDDATA_50, (byte) 0xcd);</span>
<span class="line-added">+ </span>
<span class="line-added">+         STR_HI_THERE = s(&quot;Hi There&quot;);</span>
<span class="line-added">+         STR_WHAT_DO_YA_WANT = s(&quot;what do ya want for nothing?&quot;);</span>
<span class="line-added">+         STR_TEST_USING1 = s(&quot;Test Using Larger Than Block-Size Key - Hash Key First&quot;);</span>
<span class="line-added">+         STR_TEST_USING2 = s(&quot;This is a test using a larger than block-size key and a larger than block-size data. The key needs to be hashed before being used by the HMAC algorithm.&quot;);</span>
<span class="line-added">+ </span>
<span class="line-added">+         STR_NIST1 = s(&quot;Sample message for keylen&lt;blocklen&quot;);</span>
<span class="line-added">+         STR_NIST2 = s(&quot;Sample message for keylen=blocklen&quot;);</span>
<span class="line-added">+         STR_NIST3 = s(&quot;Sample message for keylen&gt;blocklen&quot;);</span>
<span class="line-added">+ </span>
          BKEY = new byte[128];
          random.nextBytes(BKEY);
          BKEY_20 = new byte[20];
          Arrays.fill(BKEY_20, (byte) 0x0b);
<span class="line-modified">!         CKEY_20 = new byte[20];</span>
<span class="line-modified">!         Arrays.fill(CKEY_20, (byte) 0x0c);</span>
          AAKEY_20 = new byte[20];
          Arrays.fill(AAKEY_20, (byte) 0xaa);
          AAKEY_131 = new byte[131];
          Arrays.fill(AAKEY_131, (byte) 0xaa);
<span class="line-added">+         AAKEY_147 = new byte[147];</span>
<span class="line-added">+         Arrays.fill(AAKEY_147, (byte) 0xaa);</span>
<span class="line-added">+         INCKEY_25 = new byte[25];</span>
<span class="line-added">+         for (int i = 0; i &lt; INCKEY_25.length; i++) {</span>
<span class="line-added">+             INCKEY_25[i] = (byte)(i+1);</span>
<span class="line-added">+         }</span>
<span class="line-added">+         NISTKEY_172 = new byte[172];</span>
<span class="line-added">+         for (int i = 0; i &lt; NISTKEY_172.length; i++) {</span>
<span class="line-added">+             NISTKEY_172[i] = (byte)i;</span>
<span class="line-added">+         }</span>
<span class="line-added">+ </span>
      }
  
      private final static Test[] tests = {
          t(&quot;SslMacMD5&quot;, ALONG, &quot;f4:ad:01:71:51:f6:89:56:72:a3:32:bf:d9:2a:f2:a5&quot;,
                  &quot;1b:34:61:29:05:0d:73:db:25:d0:dd:64:06:29:f6:8a&quot;),
</pre>
<hr />
<pre>
<span class="line-old-header">*** 214,39 ***</span>
          t(&quot;HmacSHA512&quot;, ALONG, &quot;41:ea:4c:e5:31:3f:7c:18:0e:5e:95:a9:25:0a:10:58:e6:40:53:88:82:4f:5a:da:6f:29:de:04:7b:8e:d7:ed:7c:4d:b8:2a:48:2d:17:2a:2d:59:bb:81:9c:bf:33:40:04:77:44:fb:45:25:1f:fd:b9:29:f4:a6:69:a3:43:6f&quot;,
                  &quot;1b:34:61:29:05:0d:73:db:25:d0:dd:64:06:29:f6:8a&quot;),
          t(&quot;HmacSHA512&quot;, BLONG, &quot;fb:cf:4b:c6:d5:49:5a:5b:0b:d9:2a:32:f5:fa:68:d2:68:a4:0f:ae:53:fc:49:12:e6:1d:53:cf:b2:cb:c5:c5:f2:2d:86:bd:14:61:30:c3:a6:6f:44:1f:77:9b:aa:a1:22:48:a9:dd:d0:45:86:d1:a1:82:53:13:c4:03:06:a3&quot;,
                  BKEY),
          // Test vectors From RFC4231
<span class="line-modified">!         t(&quot;HmacSHA224&quot;, s(&quot;Hi There&quot;), &quot;89:6f:b1:12:8a:bb:df:19:68:32:10:7c:d4:9d:f3:3f:47:b4:b1:16:99:12:ba:4f:53:68:4b:22&quot;, BKEY_20),</span>
<span class="line-modified">!         t(&quot;HmacSHA224&quot;, s(&quot;what do ya want for nothing?&quot;), &quot;a3:0e:01:09:8b:c6:db:bf:45:69:0f:3a:7e:9e:6d:0f:8b:be:a2:a3:9e:61:48:00:8f:d0:5e:44&quot;, s(&quot;Jefe&quot;)),</span>
<span class="line-modified">!         t(&quot;HmacSHA224&quot;, DDDATA_50, &quot;7f:b3:cb:35:88:c6:c1:f6:ff:a9:69:4d:7d:6a:d2:64:93:65:b0:c1:f6:5d:69:d1:ec:83:33:ea&quot;, AAKEY_20),</span>
<span class="line-modified">!         t(&quot;HmacSHA224&quot;, CDDATA_50, &quot;6c:11:50:68:74:01:3c:ac:6a:2a:bc:1b:b3:82:62:7c:ec:6a:90:d8:6e:fc:01:2d:e7:af:ec:5a&quot;, &quot;01:02:03:04:05:06:07:08:09:0a:0b:0c:0d:0e:0f:10:11:12:13:14:15:16:17:18:19&quot;),</span>
<span class="line-modified">!         t(&quot;HmacSHA224&quot;, s(&quot;Test Using Larger Than Block-Size Key - Hash Key First&quot;), &quot;95:e9:a0:db:96:20:95:ad:ae:be:9b:2d:6f:0d:bc:e2:d4:99:f1:12:f2:d2:b7:27:3f:a6:87:0e&quot;, AAKEY_131),</span>
<span class="line-modified">!         t(&quot;HmacSHA224&quot;, s(&quot;This is a test using a larger than block-size key and a larger than block-size data. The key needs to be hashed before being used by the HMAC algorithm.&quot;), &quot;3a:85:41:66:ac:5d:9f:02:3f:54:d5:17:d0:b3:9d:bd:94:67:70:db:9c:2b:95:c9:f6:f5:65:d1&quot;, AAKEY_131),</span>
      };
  
      static void runTests(Test[] tests) throws Exception {
          long start = System.currentTimeMillis();
          Provider p = Security.getProvider(&quot;SunJCE&quot;);
          System.out.println(&quot;Testing provider &quot; + p.getName() + &quot;...&quot;);
<span class="line-removed">-         Mac.getInstance(&quot;HmacSHA224&quot;, p);</span>
<span class="line-removed">-         Mac.getInstance(&quot;HmacSHA256&quot;, p);</span>
<span class="line-removed">-         Mac.getInstance(&quot;HmacSHA384&quot;, p);</span>
<span class="line-removed">-         Mac.getInstance(&quot;HmacSHA512&quot;, p);</span>
<span class="line-removed">-         KeyGenerator.getInstance(&quot;HmacSHA224&quot;, p);</span>
<span class="line-removed">-         KeyGenerator.getInstance(&quot;HmacSHA256&quot;, p);</span>
<span class="line-removed">-         KeyGenerator.getInstance(&quot;HmacSHA384&quot;, p);</span>
<span class="line-removed">-         KeyGenerator.getInstance(&quot;HmacSHA512&quot;, p);</span>
          for (int i = 0; i &lt; tests.length; i++) {
              Test test = tests[i];
              test.run(p);
          }
<span class="line-removed">-         System.out.println(&quot;All tests passed&quot;);</span>
          long stop = System.currentTimeMillis();
          System.out.println(&quot;Done (&quot; + (stop - start) + &quot; ms).&quot;);
      }
  
      public static void main(String[] args) throws Exception {
          runTests(tests);
      }
<span class="line-removed">- </span>
  }
<span class="line-new-header">--- 279,77 ---</span>
          t(&quot;HmacSHA512&quot;, ALONG, &quot;41:ea:4c:e5:31:3f:7c:18:0e:5e:95:a9:25:0a:10:58:e6:40:53:88:82:4f:5a:da:6f:29:de:04:7b:8e:d7:ed:7c:4d:b8:2a:48:2d:17:2a:2d:59:bb:81:9c:bf:33:40:04:77:44:fb:45:25:1f:fd:b9:29:f4:a6:69:a3:43:6f&quot;,
                  &quot;1b:34:61:29:05:0d:73:db:25:d0:dd:64:06:29:f6:8a&quot;),
          t(&quot;HmacSHA512&quot;, BLONG, &quot;fb:cf:4b:c6:d5:49:5a:5b:0b:d9:2a:32:f5:fa:68:d2:68:a4:0f:ae:53:fc:49:12:e6:1d:53:cf:b2:cb:c5:c5:f2:2d:86:bd:14:61:30:c3:a6:6f:44:1f:77:9b:aa:a1:22:48:a9:dd:d0:45:86:d1:a1:82:53:13:c4:03:06:a3&quot;,
                  BKEY),
          // Test vectors From RFC4231
<span class="line-modified">!         // Test Case 1</span>
<span class="line-modified">!         t(&quot;HmacSHA224&quot;, STR_HI_THERE, &quot;896fb1128abbdf196832107cd49df33f47b4b1169912ba4f53684b22&quot;, BKEY_20),</span>
<span class="line-modified">!         t(&quot;HmacSHA256&quot;, STR_HI_THERE, &quot;b0344c61d8db38535ca8afceaf0bf12b881dc200c9833da726e9376c2e32cff7&quot;, BKEY_20),</span>
<span class="line-modified">!         t(&quot;HmacSHA384&quot;, STR_HI_THERE, &quot;afd03944d84895626b0825f4ab46907f15f9dadbe4101ec682aa034c7cebc59cfaea9ea9076ede7f4af152e8b2fa9cb6&quot;, BKEY_20),</span>
<span class="line-modified">!         t(&quot;HmacSHA512&quot;, STR_HI_THERE, &quot;87aa7cdea5ef619d4ff0b4241a1d6cb02379f4e2ce4ec2787ad0b30545e17cdedaa833b7d6b8a702038b274eaea3f4e4be9d914eeb61f1702e696c203a126854&quot;, BKEY_20),</span>
<span class="line-modified">!         // Test Case 2</span>
<span class="line-added">+         t(&quot;HmacSHA224&quot;, STR_WHAT_DO_YA_WANT, &quot;a30e01098bc6dbbf45690f3a7e9e6d0f8bbea2a39e6148008fd05e44&quot;, s(&quot;Jefe&quot;)),</span>
<span class="line-added">+         t(&quot;HmacSHA256&quot;, STR_WHAT_DO_YA_WANT, &quot;5bdcc146bf60754e6a042426089575c75a003f089d2739839dec58b964ec3843&quot;, s(&quot;Jefe&quot;)),</span>
<span class="line-added">+         t(&quot;HmacSHA384&quot;, STR_WHAT_DO_YA_WANT, &quot;af45d2e376484031617f78d2b58a6b1b9c7ef464f5a01b47e42ec3736322445e8e2240ca5e69e2c78b3239ecfab21649&quot;, s(&quot;Jefe&quot;)),</span>
<span class="line-added">+         t(&quot;HmacSHA512&quot;, STR_WHAT_DO_YA_WANT, &quot;164b7a7bfcf819e2e395fbe73b56e0a387bd64222e831fd610270cd7ea2505549758bf75c05a994a6d034f65f8f0e6fdcaeab1a34d4a6b4b636e070a38bce737&quot;, s(&quot;Jefe&quot;)),</span>
<span class="line-added">+         // Test Case 3</span>
<span class="line-added">+         t(&quot;HmacSHA224&quot;, DDDATA_50, &quot;7fb3cb3588c6c1f6ffa9694d7d6ad2649365b0c1f65d69d1ec8333ea&quot;, AAKEY_20),</span>
<span class="line-added">+         t(&quot;HmacSHA256&quot;, DDDATA_50, &quot;773ea91e36800e46854db8ebd09181a72959098b3ef8c122d9635514ced565fe&quot;, AAKEY_20),</span>
<span class="line-added">+         t(&quot;HmacSHA384&quot;, DDDATA_50, &quot;88062608d3e6ad8a0aa2ace014c8a86f0aa635d947ac9febe83ef4e55966144b2a5ab39dc13814b94e3ab6e101a34f27&quot;, AAKEY_20),</span>
<span class="line-added">+         t(&quot;HmacSHA512&quot;, DDDATA_50, &quot;fa73b0089d56a284efb0f0756c890be9b1b5dbdd8ee81a3655f83e33b2279d39bf3e848279a722c806b485a47e67c807b946a337bee8942674278859e13292fb&quot;, AAKEY_20),</span>
<span class="line-added">+         // Test Case 4</span>
<span class="line-added">+         t(&quot;HmacSHA224&quot;, CDDATA_50, &quot;6c11506874013cac6a2abc1bb382627cec6a90d86efc012de7afec5a&quot;, INCKEY_25),</span>
<span class="line-added">+         t(&quot;HmacSHA256&quot;, CDDATA_50, &quot;82558a389a443c0ea4cc819899f2083a85f0faa3e578f8077a2e3ff46729665b&quot;, INCKEY_25),</span>
<span class="line-added">+         t(&quot;HmacSHA384&quot;, CDDATA_50, &quot;3e8a69b7783c25851933ab6290af6ca77a9981480850009cc5577c6e1f573b4e6801dd23c4a7d679ccf8a386c674cffb&quot;, INCKEY_25),</span>
<span class="line-added">+         t(&quot;HmacSHA512&quot;, CDDATA_50, &quot;b0ba465637458c6990e5a8c5f61d4af7e576d97ff94b872de76f8050361ee3dba91ca5c11aa25eb4d679275cc5788063a5f19741120c4f2de2adebeb10a298dd&quot;, INCKEY_25),</span>
<span class="line-added">+         // skip Test Case 5 which truncates all output to 128 bits</span>
<span class="line-added">+         // Test Case 6</span>
<span class="line-added">+         t(&quot;HmacSHA224&quot;, STR_TEST_USING1, &quot;95e9a0db962095adaebe9b2d6f0dbce2d499f112f2d2b7273fa6870e&quot;, AAKEY_131),</span>
<span class="line-added">+         t(&quot;HmacSHA256&quot;, STR_TEST_USING1, &quot;60e431591ee0b67f0d8a26aacbf5b77f8e0bc6213728c5140546040f0ee37f54&quot;, AAKEY_131),</span>
<span class="line-added">+         t(&quot;HmacSHA384&quot;, STR_TEST_USING1, &quot;4ece084485813e9088d2c63a041bc5b44f9ef1012a2b588f3cd11f05033ac4c60c2ef6ab4030fe8296248df163f44952&quot;, AAKEY_131),</span>
<span class="line-added">+         t(&quot;HmacSHA512&quot;, STR_TEST_USING1, &quot;80b24263c7c1a3ebb71493c1dd7be8b49b46d1f41b4aeec1121b013783f8f3526b56d037e05f2598bd0fd2215d6a1e5295e64f73f63f0aec8b915a985d786598&quot;, AAKEY_131),</span>
<span class="line-added">+         // Test Case 7</span>
<span class="line-added">+         t(&quot;HmacSHA224&quot;, STR_TEST_USING2, &quot;3a854166ac5d9f023f54d517d0b39dbd946770db9c2b95c9f6f565d1&quot;, AAKEY_131),</span>
<span class="line-added">+         t(&quot;HmacSHA256&quot;, STR_TEST_USING2, &quot;9b09ffa71b942fcb27635fbcd5b0e944bfdc63644f0713938a7f51535c3a35e2&quot;, AAKEY_131),</span>
<span class="line-added">+         t(&quot;HmacSHA384&quot;, STR_TEST_USING2, &quot;6617178e941f020d351e2f254e8fd32c602420feb0b8fb9adccebb82461e99c5a678cc31e799176d3860e6110c46523e&quot;, AAKEY_131),</span>
<span class="line-added">+         t(&quot;HmacSHA512&quot;, STR_TEST_USING2, &quot;e37b6a775dc87dbaa4dfa9f96e5e3ffddebd71f8867289865df5a32d20cdc944b6022cac3c4982b10d5eeb55c3e4de15134676fb6de0446065c97440fa8c6a58&quot;, AAKEY_131),</span>
<span class="line-added">+         // NIST Example Values</span>
<span class="line-added">+         // https://csrc.nist.gov/projects/cryptographic-standards-and-guidelines/example-values#aMsgAuth</span>
<span class="line-added">+         t(&quot;HmacSHA3-224&quot;, STR_NIST1, &quot;332cfd59347fdb8e576e77260be4aba2d6dc53117b3bfb52c6d18c04&quot;, Arrays.copyOf(NISTKEY_172, 28)),</span>
<span class="line-added">+         t(&quot;HmacSHA3-224&quot;, STR_NIST2, &quot;d8b733bcf66c644a12323d564e24dcf3fc75f231f3b67968359100c7&quot;, Arrays.copyOf(NISTKEY_172, 144)),</span>
<span class="line-added">+         t(&quot;HmacSHA3-224&quot;, STR_NIST3, &quot;078695eecc227c636ad31d063a15dd05a7e819a66ec6d8de1e193e59&quot;, NISTKEY_172),</span>
<span class="line-added">+ </span>
<span class="line-added">+         t(&quot;HmacSHA3-256&quot;, STR_NIST1, &quot;4fe8e202c4f058e8dddc23d8c34e467343e23555e24fc2f025d598f558f67205&quot;, Arrays.copyOf(NISTKEY_172, 32)),</span>
<span class="line-added">+         t(&quot;HmacSHA3-256&quot;, STR_NIST2, &quot;68b94e2e538a9be4103bebb5aa016d47961d4d1aa906061313b557f8af2c3faa&quot;, Arrays.copyOf(NISTKEY_172, 136)),</span>
<span class="line-added">+         t(&quot;HmacSHA3-256&quot;, STR_NIST3, &quot;9bcf2c238e235c3ce88404e813bd2f3a97185ac6f238c63d6229a00b07974258&quot;, Arrays.copyOf(NISTKEY_172, 168)),</span>
<span class="line-added">+ </span>
<span class="line-added">+         t(&quot;HmacSHA3-384&quot;, STR_NIST1, &quot;d588a3c51f3f2d906e8298c1199aa8ff6296218127f6b38a90b6afe2c5617725bc99987f79b22a557b6520db710b7f42&quot;, Arrays.copyOf(NISTKEY_172, 48)),</span>
<span class="line-added">+         t(&quot;HmacSHA3-384&quot;, STR_NIST2, &quot;a27d24b592e8c8cbf6d4ce6fc5bf62d8fc98bf2d486640d9eb8099e24047837f5f3bffbe92dcce90b4ed5b1e7e44fa90&quot;, Arrays.copyOf(NISTKEY_172, 104)),</span>
<span class="line-added">+         t(&quot;HmacSHA3-384&quot;, STR_NIST3, &quot;e5ae4c739f455279368ebf36d4f5354c95aa184c899d3870e460ebc288ef1f9470053f73f7c6da2a71bcaec38ce7d6ac&quot;, Arrays.copyOf(NISTKEY_172, 152)),</span>
<span class="line-added">+ </span>
<span class="line-added">+         t(&quot;HmacSHA3-512&quot;, STR_NIST1, &quot;4efd629d6c71bf86162658f29943b1c308ce27cdfa6db0d9c3ce81763f9cbce5f7ebe9868031db1a8f8eb7b6b95e5c5e3f657a8996c86a2f6527e307f0213196&quot;, Arrays.copyOf(NISTKEY_172, 64)),</span>
<span class="line-added">+         t(&quot;HmacSHA3-512&quot;, STR_NIST2, &quot;544e257ea2a3e5ea19a590e6a24b724ce6327757723fe2751b75bf007d80f6b360744bf1b7a88ea585f9765b47911976d3191cf83c039f5ffab0d29cc9d9b6da&quot;, Arrays.copyOf(NISTKEY_172, 72)),</span>
<span class="line-added">+         t(&quot;HmacSHA3-512&quot;, STR_NIST3, &quot;5f464f5e5b7848e3885e49b2c385f0694985d0e38966242dc4a5fe3fea4b37d46b65ceced5dcf59438dd840bab22269f0ba7febdb9fcf74602a35666b2a32915&quot;, Arrays.copyOf(NISTKEY_172, 136)),</span>
      };
  
      static void runTests(Test[] tests) throws Exception {
          long start = System.currentTimeMillis();
          Provider p = Security.getProvider(&quot;SunJCE&quot;);
          System.out.println(&quot;Testing provider &quot; + p.getName() + &quot;...&quot;);
          for (int i = 0; i &lt; tests.length; i++) {
              Test test = tests[i];
              test.run(p);
          }
          long stop = System.currentTimeMillis();
          System.out.println(&quot;Done (&quot; + (stop - start) + &quot; ms).&quot;);
<span class="line-added">+ </span>
<span class="line-added">+         if (!testFailed) {</span>
<span class="line-added">+             System.out.println(&quot;All tests passed&quot;);</span>
<span class="line-added">+         } else {</span>
<span class="line-added">+             throw new RuntimeException(&quot;One or more tests failed&quot;);</span>
<span class="line-added">+         }</span>
      }
  
      public static void main(String[] args) throws Exception {
          runTests(tests);
      }
  }
</pre>
<center><a href="../../../../../ProblemList.txt.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../../java/awt/Choice/UnfocusableToplevel/UnfocusableToplevel.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>