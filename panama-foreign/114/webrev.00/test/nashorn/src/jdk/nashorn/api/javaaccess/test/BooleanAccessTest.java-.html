<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old test/nashorn/src/jdk/nashorn/api/javaaccess/test/BooleanAccessTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2010, 2013, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package jdk.nashorn.api.javaaccess.test;
 27 
 28 import static org.testng.AssertJUnit.assertEquals;
 29 import static org.testng.AssertJUnit.assertTrue;
 30 import java.util.Arrays;
 31 import javax.script.ScriptEngine;
 32 import javax.script.ScriptEngineManager;
 33 import javax.script.ScriptException;
 34 import org.testng.TestNG;
 35 import org.testng.annotations.AfterClass;
 36 import org.testng.annotations.BeforeClass;
 37 import org.testng.annotations.Test;
 38 
 39 /**
 40  * @test
 41  * @build jdk.nashorn.api.javaaccess.test.SharedObject jdk.nashorn.api.javaaccess.test.Person jdk.nashorn.api.javaaccess.test.BooleanAccessTest
 42  * @run testng/othervm jdk.nashorn.api.javaaccess.test.BooleanAccessTest
 43  */
 44 @SuppressWarnings(&quot;javadoc&quot;)
 45 public class BooleanAccessTest {
 46 
 47     private static ScriptEngine e = null;
 48     private static SharedObject o = null;
 49 
 50     public static void main(final String[] args) {
 51         TestNG.main(args);
 52     }
 53 
 54     @BeforeClass
 55     public static void setUpClass() throws ScriptException {
 56         final ScriptEngineManager m = new ScriptEngineManager();
 57         e = m.getEngineByName(&quot;nashorn&quot;);
 58         o = new SharedObject();
 59         e.put(&quot;o&quot;, o);
 60         e.eval(&quot;var SharedObject = Packages.jdk.nashorn.api.javaaccess.test.SharedObject;&quot;);
 61     }
 62 
 63     @AfterClass
 64     public static void tearDownClass() {
 65         e = null;
 66         o = null;
 67     }
 68 
 69     @Test
 70     public void accessFieldBoolean() throws ScriptException {
 71         e.eval(&quot;var p_boolean = o.publicBoolean;&quot;);
 72         assertEquals(o.publicBoolean, e.get(&quot;p_boolean&quot;));
 73         assertEquals(&quot;boolean&quot;, e.eval(&quot;typeof p_boolean;&quot;));
 74         e.eval(&quot;o.publicBoolean = false;&quot;);
 75         assertEquals(false, o.publicBoolean);
 76     }
 77 
 78     @Test
 79     public void accessFieldBooleanArray() throws ScriptException {
 80         e.eval(&quot;var p_boolean_array = o.publicBooleanArray;&quot;);
 81         assertEquals(o.publicBooleanArray[0], e.eval(&quot;o.publicBooleanArray[0]&quot;));
 82         assertTrue(Arrays.equals(o.publicBooleanArray, (boolean[])e.get(&quot;p_boolean_array&quot;)));
 83         e.eval(&quot;var t_boolean_arr = new (Java.type(\&quot;boolean[]\&quot;))(3);&quot; +
 84                 &quot;t_boolean_arr[0] = true;&quot; +
 85                 &quot;t_boolean_arr[1] = false;&quot; +
 86                 &quot;t_boolean_arr[2] = false;&quot; +
 87                 &quot;o.publicBooleanArray = t_boolean_arr;&quot;);
 88         assertTrue(Arrays.equals(new boolean[] { true, false, false }, o.publicBooleanArray));
 89         e.eval(&quot;o.publicBooleanArray[0] = false;&quot;);
 90         assertEquals(false, o.publicBooleanArray[0]);
 91     }
 92 
 93     @Test
 94     public void accessStaticFieldBoolean() throws ScriptException {
 95         e.eval(&quot;var ps_boolean = SharedObject.publicStaticBoolean;&quot;);
 96         assertEquals(SharedObject.publicStaticBoolean, e.get(&quot;ps_boolean&quot;));
 97         assertEquals(&quot;boolean&quot;, e.eval(&quot;typeof ps_boolean;&quot;));
 98         e.eval(&quot;SharedObject.publicStaticBoolean = false;&quot;);
 99         assertEquals(false, SharedObject.publicStaticBoolean);
100     }
101 
102     @Test
103     public void accessStaticFieldBooleanArray() throws ScriptException {
104         e.eval(&quot;var ps_boolean_array = SharedObject.publicStaticBooleanArray;&quot;);
105         assertEquals(SharedObject.publicStaticBooleanArray[0], e.eval(&quot;SharedObject.publicStaticBooleanArray[0]&quot;));
106         assertTrue(Arrays.equals(SharedObject.publicStaticBooleanArray, (boolean[])e.get(&quot;ps_boolean_array&quot;)));
107         e.eval(&quot;var ts_boolean_arr = new (Java.type(\&quot;boolean[]\&quot;))(3);&quot; +
108                 &quot;ts_boolean_arr[0] = true;&quot; +
109                 &quot;ts_boolean_arr[1] = false;&quot; +
110                 &quot;ts_boolean_arr[2] = true;&quot; +
111                 &quot;SharedObject.publicStaticBooleanArray = ts_boolean_arr;&quot;);
112         assertTrue(Arrays.equals(new boolean[] { true, false, true }, SharedObject.publicStaticBooleanArray));
113         e.eval(&quot;SharedObject.publicStaticBooleanArray[0] = false;&quot;);
114         assertEquals(false, SharedObject.publicStaticBooleanArray[0]);
115     }
116 
117     @Test
118     public void accessFinalFieldBoolean() throws ScriptException {
119         e.eval(&quot;var pf_boolean = o.publicFinalBoolean;&quot;);
120         assertEquals(o.publicFinalBoolean, e.get(&quot;pf_boolean&quot;));
121         assertEquals(&quot;boolean&quot;, e.eval(&quot;typeof pf_boolean;&quot;));
122         e.eval(&quot;o.publicFinalBoolean = false;&quot;);
123         assertEquals(true, o.publicFinalBoolean);
124     }
125 
126     @Test
127     public void accessFinalFieldBooleanArray() throws ScriptException {
128         e.eval(&quot;var pf_boolean_array = o.publicFinalBooleanArray;&quot;);
129         assertEquals(o.publicFinalBooleanArray[0], e.eval(&quot;o.publicFinalBooleanArray[0]&quot;));
130         assertTrue(Arrays.equals(o.publicFinalBooleanArray, (boolean[])e.get(&quot;pf_boolean_array&quot;)));
131         e.eval(&quot;var tf_boolean_arr = new (Java.type(\&quot;boolean[]\&quot;))(3);&quot; +
132                 &quot;tf_boolean_arr[0] = false;&quot; +
133                 &quot;tf_boolean_arr[1] = false;&quot; +
134                 &quot;tf_boolean_arr[2] = true;&quot; +
135                 &quot;o.publicOFinalbjectArray = tf_boolean_arr;&quot;);
136         assertTrue(Arrays.equals(new boolean[] { false, false, true, false }, o.publicFinalBooleanArray));
137         e.eval(&quot;o.publicFinalBooleanArray[0] = true;&quot;);
138         assertEquals(true, o.publicFinalBooleanArray[0]);
139     }
140 
141     @Test
142     public void accessStaticFinalFieldBoolean() throws ScriptException {
143         e.eval(&quot;var psf_boolean = SharedObject.publicStaticFinalBoolean;&quot;);
144         assertEquals(SharedObject.publicStaticFinalBoolean, e.get(&quot;psf_boolean&quot;));
145         assertEquals(&quot;boolean&quot;, e.eval(&quot;typeof psf_boolean;&quot;));
146         e.eval(&quot;SharedObject.publicStaticFinalBoolean = false;&quot;);
147         assertEquals(true, SharedObject.publicStaticFinalBoolean);
148     }
149 
150     @Test
151     public void accessStaticFinalFieldBooleanArray() throws ScriptException {
152         e.eval(&quot;var psf_boolean_array = SharedObject.publicStaticFinalBooleanArray;&quot;);
153         assertEquals(SharedObject.publicStaticFinalBooleanArray[0], e.eval(&quot;SharedObject.publicStaticFinalBooleanArray[0]&quot;));
154         assertTrue(Arrays.equals(SharedObject.publicStaticFinalBooleanArray, (boolean[])e.get(&quot;psf_boolean_array&quot;)));
155         e.eval(&quot;var tsf_boolean_arr = new (Java.type(\&quot;boolean[]\&quot;))(3);&quot; +
156                 &quot;tsf_boolean_arr[0] = false;&quot; +
157                 &quot;tsf_boolean_arr[1] = true;&quot; +
158                 &quot;tsf_boolean_arr[2] = false;&quot; +
159                 &quot;SharedObject.publicStaticFinalBooleanArray = tsf_boolean_arr;&quot;);
160         assertTrue(Arrays.equals(new boolean[] { false, true, false, false }, SharedObject.publicStaticFinalBooleanArray));
161         e.eval(&quot;SharedObject.publicStaticFinalBooleanArray[0] = true;&quot;);
162         assertEquals(true, SharedObject.publicStaticFinalBooleanArray[0]);
163     }
164 
165     @Test
166     public void accessFieldBooleanBoxing() throws ScriptException {
167         e.eval(&quot;var p_boolean_box = o.publicBooleanBox;&quot;);
168         assertEquals(o.publicBooleanBox, e.get(&quot;p_boolean_box&quot;));
169         assertEquals(&quot;boolean&quot;, e.eval(&quot;typeof p_boolean_box;&quot;));
170         e.eval(&quot;o.publicBooleanBox = false;&quot;);
171         assertEquals(false, (boolean)o.publicBooleanBox);
172     }
173 
174     @Test
175     public void accessStaticFieldBooleanBoxing() throws ScriptException {
176         e.eval(&quot;var ps_boolean_box = SharedObject.publicStaticBooleanBox;&quot;);
177         assertEquals(SharedObject.publicStaticBooleanBox, e.get(&quot;ps_boolean_box&quot;));
178         assertEquals(&quot;boolean&quot;, e.eval(&quot;typeof ps_boolean_box;&quot;));
179         e.eval(&quot;SharedObject.publicStaticBooleanBox = false;&quot;);
180         assertEquals(false, (boolean)SharedObject.publicStaticBooleanBox);
181     }
182 
183     @Test
184     public void accessFinalFieldBooleanBoxing() throws ScriptException {
185         e.eval(&quot;var pf_boolean_box = o.publicFinalBooleanBox;&quot;);
186         assertEquals(o.publicFinalBooleanBox, e.get(&quot;pf_boolean_box&quot;));
187         assertEquals(&quot;boolean&quot;, e.eval(&quot;typeof pf_boolean_box;&quot;));
188         e.eval(&quot;o.publicFinalBooleanBox = false;&quot;);
189         assertEquals(true, (boolean)o.publicFinalBooleanBox);
190     }
191 
192     @Test
193     public void accessStaticFinalFieldBooleanBoxing() throws ScriptException {
194         e.eval(&quot;var psf_boolean_box = SharedObject.publicStaticFinalBooleanBox;&quot;);
195         assertEquals(SharedObject.publicStaticFinalBooleanBox, e.get(&quot;psf_boolean_box&quot;));
196         assertEquals(&quot;boolean&quot;, e.eval(&quot;typeof psf_boolean_box;&quot;));
197         e.eval(&quot;SharedObject.publicStaticFinalBooleanBox = false;&quot;);
198         assertEquals(true, (boolean)SharedObject.publicStaticFinalBooleanBox);
199     }
200 
201     @Test
202     public void accessVolatileField() throws ScriptException {
203         e.eval(&quot;var pv_boolean = o.volatileBoolean;&quot;);
204         assertEquals(o.volatileBoolean, e.get(&quot;pv_boolean&quot;));
205         assertEquals(&quot;boolean&quot;, e.eval(&quot;typeof pv_boolean;&quot;));
206         e.eval(&quot;o.volatileBoolean = false;&quot;);
207         assertEquals(false, o.volatileBoolean);
208     }
209 
210     @Test
211     public void accessTransientField() throws ScriptException {
212         e.eval(&quot;var pt_boolean = o.transientBoolean;&quot;);
213         assertEquals(o.transientBoolean, e.get(&quot;pt_boolean&quot;));
214         assertEquals(&quot;boolean&quot;, e.eval(&quot;typeof pt_boolean;&quot;));
215         e.eval(&quot;o.transientBoolean = false;&quot;);
216         assertEquals(false, o.transientBoolean);
217     }
218 
219 }
    </pre>
  </body>
</html>