diff a/src/hotspot/os/windows/os_windows.cpp b/src/hotspot/os/windows/os_windows.cpp
--- a/src/hotspot/os/windows/os_windows.cpp
+++ b/src/hotspot/os/windows/os_windows.cpp
@@ -4141,21 +4141,21 @@
   }
 }
 
 static errno_t convert_to_unicode(char const* char_path, LPWSTR* unicode_path) {
   // Get required buffer size to convert to Unicode
-  int unicode_path_len = MultiByteToWideChar(CP_THREAD_ACP,
+  int unicode_path_len = MultiByteToWideChar(CP_ACP,
                                              MB_ERR_INVALID_CHARS,
                                              char_path, -1,
                                              NULL, 0);
   if (unicode_path_len == 0) {
     return EINVAL;
   }
 
   *unicode_path = NEW_C_HEAP_ARRAY(WCHAR, unicode_path_len, mtInternal);
 
-  int result = MultiByteToWideChar(CP_THREAD_ACP,
+  int result = MultiByteToWideChar(CP_ACP,
                                    MB_ERR_INVALID_CHARS,
                                    char_path, -1,
                                    *unicode_path, unicode_path_len);
   assert(result == unicode_path_len, "length already checked above");
 
