<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/unix/native/libawt_xawt/awt/gtk2_interface.c</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../libawt/awt/awt_Mlib.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="gtk3_interface.c.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/unix/native/libawt_xawt/awt/gtk2_interface.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
2506     }
2507 
2508     if (pixbuf) {
2509         int nchan = (*fp_gdk_pixbuf_get_n_channels)(pixbuf);
2510         int stride = (*fp_gdk_pixbuf_get_rowstride)(pixbuf);
2511 
2512         if ((*fp_gdk_pixbuf_get_width)(pixbuf) == width
2513                 &amp;&amp; (*fp_gdk_pixbuf_get_height)(pixbuf) == height
2514                 &amp;&amp; (*fp_gdk_pixbuf_get_bits_per_sample)(pixbuf) == 8
2515                 &amp;&amp; (*fp_gdk_pixbuf_get_colorspace)(pixbuf) == GDK_COLORSPACE_RGB
2516                 &amp;&amp; nchan &gt;= 3
2517                 ) {
2518             guchar *p, *pix = (*fp_gdk_pixbuf_get_pixels)(pixbuf);
2519 
2520             ary = (*env)-&gt;GetPrimitiveArrayCritical(env, pixelArray, NULL);
2521             if (ary) {
2522                 jint _x, _y;
2523                 int index;
2524                 for (_y = 0; _y &lt; height; _y++) {
2525                     for (_x = 0; _x &lt; width; _x++) {
<span class="line-modified">2526                         p = pix + _y * stride + _x * nchan;</span>
2527 
2528                         index = (_y + dy) * jwidth + (_x + dx);
2529                         ary[index] = 0xff000000
2530                                         | (p[0] &lt;&lt; 16)
2531                                         | (p[1] &lt;&lt; 8)
2532                                         | (p[2]);
2533 
2534                     }
2535                 }
2536                 (*env)-&gt;ReleasePrimitiveArrayCritical(env, pixelArray, ary, 0);
2537             }
2538         }
2539         (*fp_g_object_unref)(pixbuf);
2540     }
2541     return JNI_FALSE;
2542 }
2543 
2544 static GdkWindow* gtk2_get_window(void *widget) {
2545     return ((GtkWidget*)widget)-&gt;window;
2546 }
</pre>
</td>
<td>
<hr />
<pre>
2506     }
2507 
2508     if (pixbuf) {
2509         int nchan = (*fp_gdk_pixbuf_get_n_channels)(pixbuf);
2510         int stride = (*fp_gdk_pixbuf_get_rowstride)(pixbuf);
2511 
2512         if ((*fp_gdk_pixbuf_get_width)(pixbuf) == width
2513                 &amp;&amp; (*fp_gdk_pixbuf_get_height)(pixbuf) == height
2514                 &amp;&amp; (*fp_gdk_pixbuf_get_bits_per_sample)(pixbuf) == 8
2515                 &amp;&amp; (*fp_gdk_pixbuf_get_colorspace)(pixbuf) == GDK_COLORSPACE_RGB
2516                 &amp;&amp; nchan &gt;= 3
2517                 ) {
2518             guchar *p, *pix = (*fp_gdk_pixbuf_get_pixels)(pixbuf);
2519 
2520             ary = (*env)-&gt;GetPrimitiveArrayCritical(env, pixelArray, NULL);
2521             if (ary) {
2522                 jint _x, _y;
2523                 int index;
2524                 for (_y = 0; _y &lt; height; _y++) {
2525                     for (_x = 0; _x &lt; width; _x++) {
<span class="line-modified">2526                         p = pix + (intptr_t) _y * stride + _x * nchan;</span>
2527 
2528                         index = (_y + dy) * jwidth + (_x + dx);
2529                         ary[index] = 0xff000000
2530                                         | (p[0] &lt;&lt; 16)
2531                                         | (p[1] &lt;&lt; 8)
2532                                         | (p[2]);
2533 
2534                     }
2535                 }
2536                 (*env)-&gt;ReleasePrimitiveArrayCritical(env, pixelArray, ary, 0);
2537             }
2538         }
2539         (*fp_g_object_unref)(pixbuf);
2540     }
2541     return JNI_FALSE;
2542 }
2543 
2544 static GdkWindow* gtk2_get_window(void *widget) {
2545     return ((GtkWidget*)widget)-&gt;window;
2546 }
</pre>
</td>
</tr>
</table>
<center><a href="../../libawt/awt/awt_Mlib.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="gtk3_interface.c.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>