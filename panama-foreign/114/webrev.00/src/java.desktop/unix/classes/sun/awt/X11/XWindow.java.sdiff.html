<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/unix/classes/sun/awt/X11/XWindow.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="XToolkit.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../native/common/awt/X11Color.c.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/unix/classes/sun/awt/X11/XWindow.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2002, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
  25 
  26 package sun.awt.X11;
  27 
<span class="line-modified">  28 import java.awt.*;</span>
<span class="line-modified">  29 import java.awt.event.*;</span>
<span class="line-modified">  30 import java.awt.peer.ComponentPeer;</span>



















  31 import java.awt.image.ColorModel;
<span class="line-modified">  32 </span>
  33 import java.lang.ref.WeakReference;
  34 

  35 import sun.awt.AWTAccessor.ComponentAccessor;
<span class="line-modified">  36 import sun.util.logging.PlatformLogger;</span>
<span class="line-modified">  37 </span>
<span class="line-modified">  38 import sun.awt.*;</span>
<span class="line-modified">  39 </span>
<span class="line-modified">  40 import sun.awt.image.PixelConverter;</span>
<span class="line-removed">  41 </span>
  42 import sun.java2d.SunGraphics2D;
  43 import sun.java2d.SurfaceData;

  44 
  45 class XWindow extends XBaseWindow implements X11ComponentPeer {
  46     private static PlatformLogger log = PlatformLogger.getLogger(&quot;sun.awt.X11.XWindow&quot;);
  47     private static PlatformLogger insLog = PlatformLogger.getLogger(&quot;sun.awt.X11.insets.XWindow&quot;);
  48     private static PlatformLogger eventLog = PlatformLogger.getLogger(&quot;sun.awt.X11.event.XWindow&quot;);
  49     private static final PlatformLogger focusLog = PlatformLogger.getLogger(&quot;sun.awt.X11.focus.XWindow&quot;);
  50     private static PlatformLogger keyEventLog = PlatformLogger.getLogger(&quot;sun.awt.X11.kye.XWindow&quot;);
  51   /* If a motion comes in while a multi-click is pending,
  52    * allow a smudge factor so that moving the mouse by a small
  53    * amount does not wipe out the multi-click state variables.
  54    */
  55     private static final int AWT_MULTICLICK_SMUDGE = 4;
  56     // ButtonXXX events stuff
  57     static int lastX = 0, lastY = 0;
  58     static long lastTime = 0;
  59     static long lastButton = 0;
  60     static WeakReference&lt;XWindow&gt; lastWindowRef = null;
  61     static int clickCount = 0;
  62 
  63     // used to check if we need to re-create surfaceData.
</pre>
<hr />
<pre>
 100 
 101     // fallback default font object
 102     private static Font defaultFont;
 103 
 104     static synchronized Font getDefaultFont() {
 105         if (null == defaultFont) {
 106             defaultFont = new Font(Font.DIALOG, Font.PLAIN, 12);
 107         }
 108         return defaultFont;
 109     }
 110 
 111     /* A bitmask keeps the button&#39;s numbers as Button1Mask, Button2Mask, Button3Mask
 112      * which are allowed to
 113      * generate the CLICK event after the RELEASE has happened.
 114      * There are conditions that must be true for that sending CLICK event:
 115      * 1) button was initially PRESSED
 116      * 2) no movement or drag has happened until RELEASE
 117     */
 118     private int mouseButtonClickAllowed = 0;
 119 
<span class="line-removed"> 120     native int getNativeColor(Color clr, GraphicsConfiguration gc);</span>
<span class="line-removed"> 121     native void getWMInsets(long window, long left, long top, long right, long bottom, long border);</span>
<span class="line-removed"> 122     native long getTopWindow(long window, long rootWin);</span>
<span class="line-removed"> 123     native void getWindowBounds(long window, long x, long y, long width, long height);</span>
 124     private static native void initIDs();
 125 
 126     static {
 127         initIDs();
 128     }
 129 
 130     XWindow(XCreateWindowParams params) {
 131         super(params);
 132     }
 133 
 134     XWindow() {
 135     }
 136 
 137     XWindow(long parentWindow, Rectangle bounds) {
 138         super(new XCreateWindowParams(new Object[] {
 139             BOUNDS, bounds,
 140             PARENT_WINDOW, Long.valueOf(parentWindow)}));
 141     }
 142 
 143     XWindow(Component target, long parentWindow, Rectangle bounds) {
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2002, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
  25 
  26 package sun.awt.X11;
  27 
<span class="line-modified">  28 import java.awt.AWTEvent;</span>
<span class="line-modified">  29 import java.awt.AWTKeyStroke;</span>
<span class="line-modified">  30 import java.awt.Color;</span>
<span class="line-added">  31 import java.awt.Component;</span>
<span class="line-added">  32 import java.awt.Container;</span>
<span class="line-added">  33 import java.awt.Cursor;</span>
<span class="line-added">  34 import java.awt.Font;</span>
<span class="line-added">  35 import java.awt.FontMetrics;</span>
<span class="line-added">  36 import java.awt.Graphics;</span>
<span class="line-added">  37 import java.awt.GraphicsConfiguration;</span>
<span class="line-added">  38 import java.awt.Point;</span>
<span class="line-added">  39 import java.awt.Rectangle;</span>
<span class="line-added">  40 import java.awt.SystemColor;</span>
<span class="line-added">  41 import java.awt.Toolkit;</span>
<span class="line-added">  42 import java.awt.Window;</span>
<span class="line-added">  43 import java.awt.event.ComponentEvent;</span>
<span class="line-added">  44 import java.awt.event.FocusEvent;</span>
<span class="line-added">  45 import java.awt.event.InputEvent;</span>
<span class="line-added">  46 import java.awt.event.KeyEvent;</span>
<span class="line-added">  47 import java.awt.event.MouseEvent;</span>
<span class="line-added">  48 import java.awt.event.MouseWheelEvent;</span>
<span class="line-added">  49 import java.awt.event.PaintEvent;</span>
  50 import java.awt.image.ColorModel;
<span class="line-modified">  51 import java.awt.peer.ComponentPeer;</span>
  52 import java.lang.ref.WeakReference;
  53 
<span class="line-added">  54 import sun.awt.AWTAccessor;</span>
  55 import sun.awt.AWTAccessor.ComponentAccessor;
<span class="line-modified">  56 import sun.awt.PaintEventDispatcher;</span>
<span class="line-modified">  57 import sun.awt.PeerEvent;</span>
<span class="line-modified">  58 import sun.awt.SunToolkit;</span>
<span class="line-modified">  59 import sun.awt.X11ComponentPeer;</span>
<span class="line-modified">  60 import sun.awt.X11GraphicsConfig;</span>

  61 import sun.java2d.SunGraphics2D;
  62 import sun.java2d.SurfaceData;
<span class="line-added">  63 import sun.util.logging.PlatformLogger;</span>
  64 
  65 class XWindow extends XBaseWindow implements X11ComponentPeer {
  66     private static PlatformLogger log = PlatformLogger.getLogger(&quot;sun.awt.X11.XWindow&quot;);
  67     private static PlatformLogger insLog = PlatformLogger.getLogger(&quot;sun.awt.X11.insets.XWindow&quot;);
  68     private static PlatformLogger eventLog = PlatformLogger.getLogger(&quot;sun.awt.X11.event.XWindow&quot;);
  69     private static final PlatformLogger focusLog = PlatformLogger.getLogger(&quot;sun.awt.X11.focus.XWindow&quot;);
  70     private static PlatformLogger keyEventLog = PlatformLogger.getLogger(&quot;sun.awt.X11.kye.XWindow&quot;);
  71   /* If a motion comes in while a multi-click is pending,
  72    * allow a smudge factor so that moving the mouse by a small
  73    * amount does not wipe out the multi-click state variables.
  74    */
  75     private static final int AWT_MULTICLICK_SMUDGE = 4;
  76     // ButtonXXX events stuff
  77     static int lastX = 0, lastY = 0;
  78     static long lastTime = 0;
  79     static long lastButton = 0;
  80     static WeakReference&lt;XWindow&gt; lastWindowRef = null;
  81     static int clickCount = 0;
  82 
  83     // used to check if we need to re-create surfaceData.
</pre>
<hr />
<pre>
 120 
 121     // fallback default font object
 122     private static Font defaultFont;
 123 
 124     static synchronized Font getDefaultFont() {
 125         if (null == defaultFont) {
 126             defaultFont = new Font(Font.DIALOG, Font.PLAIN, 12);
 127         }
 128         return defaultFont;
 129     }
 130 
 131     /* A bitmask keeps the button&#39;s numbers as Button1Mask, Button2Mask, Button3Mask
 132      * which are allowed to
 133      * generate the CLICK event after the RELEASE has happened.
 134      * There are conditions that must be true for that sending CLICK event:
 135      * 1) button was initially PRESSED
 136      * 2) no movement or drag has happened until RELEASE
 137     */
 138     private int mouseButtonClickAllowed = 0;
 139 




 140     private static native void initIDs();
 141 
 142     static {
 143         initIDs();
 144     }
 145 
 146     XWindow(XCreateWindowParams params) {
 147         super(params);
 148     }
 149 
 150     XWindow() {
 151     }
 152 
 153     XWindow(long parentWindow, Rectangle bounds) {
 154         super(new XCreateWindowParams(new Object[] {
 155             BOUNDS, bounds,
 156             PARENT_WINDOW, Long.valueOf(parentWindow)}));
 157     }
 158 
 159     XWindow(Component target, long parentWindow, Rectangle bounds) {
</pre>
</td>
</tr>
</table>
<center><a href="XToolkit.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../native/common/awt/X11Color.c.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>