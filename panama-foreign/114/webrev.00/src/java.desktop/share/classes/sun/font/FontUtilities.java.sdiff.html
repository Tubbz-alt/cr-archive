<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/classes/sun/font/FontUtilities.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="FontStrikeDesc.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="FreetypeFontScaler.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/classes/sun/font/FontUtilities.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 32 import java.io.InputStreamReader;
 33 import java.lang.ref.SoftReference;
 34 import java.util.concurrent.ConcurrentHashMap;
 35 import java.security.AccessController;
 36 
 37 import java.security.PrivilegedAction;
 38 import javax.swing.plaf.FontUIResource;
 39 
 40 import sun.util.logging.PlatformLogger;
 41 
 42 /**
 43  * A collection of utility methods.
 44  */
 45 public final class FontUtilities {
 46 
 47     public static boolean isSolaris;
 48 
 49     public static boolean isLinux;
 50 
 51     public static boolean isMacOSX;

 52 
 53     public static boolean useJDKScaler;
 54 
 55     public static boolean isWindows;
 56 
 57     private static boolean debugFonts = false;
 58     private static PlatformLogger logger = null;
 59     private static boolean logging;
 60 
 61     // This static initializer block figures out the OS constants.
 62     static {
 63 
 64         AccessController.doPrivileged(new PrivilegedAction&lt;Object&gt;() {
 65             @SuppressWarnings(&quot;deprecation&quot;) // PlatformLogger.setLevel is deprecated.
 66             @Override
 67             public Object run() {
 68                 String osName = System.getProperty(&quot;os.name&quot;, &quot;unknownOS&quot;);
 69                 isSolaris = osName.startsWith(&quot;SunOS&quot;);
 70 
 71                 isLinux = osName.startsWith(&quot;Linux&quot;);
 72 
 73                 isMacOSX = osName.contains(&quot;OS X&quot;); // TODO: MacOSX
<span class="line-modified"> 74 </span>


















 75                 /* If set to &quot;jdk&quot;, use the JDK&#39;s scaler rather than
 76                  * the platform one. This may be a no-op on platforms where
 77                  * JDK has been configured so that it always relies on the
 78                  * platform scaler. The principal case where it has an
 79                  * effect is that on Windows, 2D will never use GDI.
 80                  */
 81                 String scalerStr = System.getProperty(&quot;sun.java2d.font.scaler&quot;);
 82                 if (scalerStr != null) {
 83                     useJDKScaler = &quot;jdk&quot;.equals(scalerStr);
 84                 } else {
 85                     useJDKScaler = false;
 86                 }
 87                 isWindows = osName.startsWith(&quot;Windows&quot;);
 88                 String debugLevel =
 89                     System.getProperty(&quot;sun.java2d.debugfonts&quot;);
 90 
 91                 if (debugLevel != null &amp;&amp; !debugLevel.equals(&quot;false&quot;)) {
 92                     debugFonts = true;
 93                     logger = PlatformLogger.getLogger(&quot;sun.java2d&quot;);
 94                     if (debugLevel.equals(&quot;warning&quot;)) {
</pre>
</td>
<td>
<hr />
<pre>
 32 import java.io.InputStreamReader;
 33 import java.lang.ref.SoftReference;
 34 import java.util.concurrent.ConcurrentHashMap;
 35 import java.security.AccessController;
 36 
 37 import java.security.PrivilegedAction;
 38 import javax.swing.plaf.FontUIResource;
 39 
 40 import sun.util.logging.PlatformLogger;
 41 
 42 /**
 43  * A collection of utility methods.
 44  */
 45 public final class FontUtilities {
 46 
 47     public static boolean isSolaris;
 48 
 49     public static boolean isLinux;
 50 
 51     public static boolean isMacOSX;
<span class="line-added"> 52     public static boolean isMacOSX14;</span>
 53 
 54     public static boolean useJDKScaler;
 55 
 56     public static boolean isWindows;
 57 
 58     private static boolean debugFonts = false;
 59     private static PlatformLogger logger = null;
 60     private static boolean logging;
 61 
 62     // This static initializer block figures out the OS constants.
 63     static {
 64 
 65         AccessController.doPrivileged(new PrivilegedAction&lt;Object&gt;() {
 66             @SuppressWarnings(&quot;deprecation&quot;) // PlatformLogger.setLevel is deprecated.
 67             @Override
 68             public Object run() {
 69                 String osName = System.getProperty(&quot;os.name&quot;, &quot;unknownOS&quot;);
 70                 isSolaris = osName.startsWith(&quot;SunOS&quot;);
 71 
 72                 isLinux = osName.startsWith(&quot;Linux&quot;);
 73 
 74                 isMacOSX = osName.contains(&quot;OS X&quot;); // TODO: MacOSX
<span class="line-modified"> 75                 if (isMacOSX) {</span>
<span class="line-added"> 76                     // os.version has values like 10.13.6, 10.14.6</span>
<span class="line-added"> 77                     // If it is not positively recognised as 10.13 or less,</span>
<span class="line-added"> 78                     // assume it means 10.14 or some later version.</span>
<span class="line-added"> 79                     isMacOSX14 = true;</span>
<span class="line-added"> 80                     String version = System.getProperty(&quot;os.version&quot;, &quot;&quot;);</span>
<span class="line-added"> 81                     if (version.startsWith(&quot;10.&quot;)) {</span>
<span class="line-added"> 82                         version = version.substring(3);</span>
<span class="line-added"> 83                         int periodIndex = version.indexOf(&#39;.&#39;);</span>
<span class="line-added"> 84                         if (periodIndex != -1) {</span>
<span class="line-added"> 85                             version = version.substring(0, periodIndex);</span>
<span class="line-added"> 86                         }</span>
<span class="line-added"> 87                         try {</span>
<span class="line-added"> 88                             int v = Integer.parseInt(version);</span>
<span class="line-added"> 89                             isMacOSX14 = (v &gt;= 14);</span>
<span class="line-added"> 90                         } catch (NumberFormatException e) {</span>
<span class="line-added"> 91                         }</span>
<span class="line-added"> 92                      }</span>
<span class="line-added"> 93                  }</span>
 94                 /* If set to &quot;jdk&quot;, use the JDK&#39;s scaler rather than
 95                  * the platform one. This may be a no-op on platforms where
 96                  * JDK has been configured so that it always relies on the
 97                  * platform scaler. The principal case where it has an
 98                  * effect is that on Windows, 2D will never use GDI.
 99                  */
100                 String scalerStr = System.getProperty(&quot;sun.java2d.font.scaler&quot;);
101                 if (scalerStr != null) {
102                     useJDKScaler = &quot;jdk&quot;.equals(scalerStr);
103                 } else {
104                     useJDKScaler = false;
105                 }
106                 isWindows = osName.startsWith(&quot;Windows&quot;);
107                 String debugLevel =
108                     System.getProperty(&quot;sun.java2d.debugfonts&quot;);
109 
110                 if (debugLevel != null &amp;&amp; !debugLevel.equals(&quot;false&quot;)) {
111                     debugFonts = true;
112                     logger = PlatformLogger.getLogger(&quot;sun.java2d&quot;);
113                     if (debugLevel.equals(&quot;warning&quot;)) {
</pre>
</td>
</tr>
</table>
<center><a href="FontStrikeDesc.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="FreetypeFontScaler.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>