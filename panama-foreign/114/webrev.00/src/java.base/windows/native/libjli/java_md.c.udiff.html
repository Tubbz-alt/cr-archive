<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.base/windows/native/libjli/java_md.c</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../libjava/canonicalize_md.c.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../../../../java.desktop/macosx/classes/com/apple/laf/AquaLookAndFeel.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/windows/native/libjli/java_md.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -249,10 +249,27 @@</span>
                      return JNI_FALSE;
                  }
              }
          }
  #endif /* MSVCR_DLL_NAME */
<span class="udiff-line-added">+ #ifdef VCRUNTIME_1_DLL_NAME</span>
<span class="udiff-line-added">+         if (GetJREPath(crtpath, MAXPATHLEN)) {</span>
<span class="udiff-line-added">+             if (JLI_StrLen(crtpath) + JLI_StrLen(&quot;\\bin\\&quot;) +</span>
<span class="udiff-line-added">+                     JLI_StrLen(VCRUNTIME_1_DLL_NAME) &gt;= MAXPATHLEN) {</span>
<span class="udiff-line-added">+                 JLI_ReportErrorMessage(JRE_ERROR11);</span>
<span class="udiff-line-added">+                 return JNI_FALSE;</span>
<span class="udiff-line-added">+             }</span>
<span class="udiff-line-added">+             (void)JLI_StrCat(crtpath, &quot;\\bin\\&quot; VCRUNTIME_1_DLL_NAME);   /* Add crt dll */</span>
<span class="udiff-line-added">+             JLI_TraceLauncher(&quot;CRT path is %s\n&quot;, crtpath);</span>
<span class="udiff-line-added">+             if (_access(crtpath, 0) == 0) {</span>
<span class="udiff-line-added">+                 if (LoadLibrary(crtpath) == 0) {</span>
<span class="udiff-line-added">+                     JLI_ReportErrorMessage(DLL_ERROR4, crtpath);</span>
<span class="udiff-line-added">+                     return JNI_FALSE;</span>
<span class="udiff-line-added">+                 }</span>
<span class="udiff-line-added">+             }</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+ #endif /* VCRUNTIME_1_DLL_NAME */</span>
  #ifdef MSVCP_DLL_NAME
          if (GetJREPath(crtpath, MAXPATHLEN)) {
              if (JLI_StrLen(crtpath) + JLI_StrLen(&quot;\\bin\\&quot;) +
                      JLI_StrLen(MSVCP_DLL_NAME) &gt;= MAXPATHLEN) {
                  JLI_ReportErrorMessage(JRE_ERROR11);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -502,11 +519,11 @@</span>
  
      /*
       * Get required buffer size to convert to Unicode.
       * The return value includes the terminating null character.
       */
<span class="udiff-line-modified-removed">-     unicode_path_len = MultiByteToWideChar(CP_THREAD_ACP, MB_ERR_INVALID_CHARS,</span>
<span class="udiff-line-modified-added">+     unicode_path_len = MultiByteToWideChar(CP_ACP, MB_ERR_INVALID_CHARS,</span>
                                             path, -1, NULL, 0);
      if (unicode_path_len == 0) {
          return EINVAL;
      }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -516,11 +533,11 @@</span>
      if (*wpath == NULL) {
          return ENOMEM;
      }
  
      wcsncpy(*wpath, prefix, prefix_len);
<span class="udiff-line-modified-removed">-     if (MultiByteToWideChar(CP_THREAD_ACP, MB_ERR_INVALID_CHARS,</span>
<span class="udiff-line-modified-added">+     if (MultiByteToWideChar(CP_ACP, MB_ERR_INVALID_CHARS,</span>
                              path, -1, &amp;((*wpath)[prefix_len]), (int)wpath_len) == 0) {
          JLI_MemFree(*wpath);
          *wpath = NULL;
          return EINVAL;
      }
</pre>
<center><a href="../libjava/canonicalize_md.c.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../../../../java.desktop/macosx/classes/com/apple/laf/AquaLookAndFeel.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>