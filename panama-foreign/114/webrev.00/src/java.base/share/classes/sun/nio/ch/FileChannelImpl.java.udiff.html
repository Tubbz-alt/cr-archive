<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.base/share/classes/sun/nio/ch/FileChannelImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="DatagramSocketAdaptor.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../security/jca/ProviderConfig.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/nio/ch/FileChannelImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -43,15 +43,15 @@</span>
  import java.nio.channels.SelectableChannel;
  import java.nio.channels.WritableByteChannel;
  import java.util.Objects;
  
  import jdk.internal.access.JavaIOFileDescriptorAccess;
<span class="udiff-line-removed">- import jdk.internal.access.JavaNioAccess;</span>
  import jdk.internal.access.SharedSecrets;
  import jdk.internal.misc.ExtendedMapMode;
  import jdk.internal.misc.Unsafe;
  import jdk.internal.misc.VM;
<span class="udiff-line-added">+ import jdk.internal.misc.VM.BufferPool;</span>
  import jdk.internal.ref.Cleaner;
  import jdk.internal.ref.CleanerFactory;
  
  import jdk.internal.access.foreign.UnmapperProxy;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -238,12 +238,11 @@</span>
      }
  
      public long read(ByteBuffer[] dsts, int offset, int length)
          throws IOException
      {
<span class="udiff-line-modified-removed">-         if ((offset &lt; 0) || (length &lt; 0) || (offset &gt; dsts.length - length))</span>
<span class="udiff-line-removed">-             throw new IndexOutOfBoundsException();</span>
<span class="udiff-line-modified-added">+         Objects.checkFromIndexSize(offset, length, dsts.length);</span>
          ensureOpen();
          if (!readable)
              throw new NonReadableChannelException();
          synchronized (positionLock) {
              if (direct)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -295,12 +294,11 @@</span>
      }
  
      public long write(ByteBuffer[] srcs, int offset, int length)
          throws IOException
      {
<span class="udiff-line-modified-removed">-         if ((offset &lt; 0) || (length &lt; 0) || (offset &gt; srcs.length - length))</span>
<span class="udiff-line-removed">-             throw new IndexOutOfBoundsException();</span>
<span class="udiff-line-modified-added">+         Objects.checkFromIndexSize(offset, length, srcs.length);</span>
          ensureOpen();
          if (!writable)
              throw new NonWritableChannelException();
          synchronized (positionLock) {
              if (direct)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -787,15 +785,15 @@</span>
      public int read(ByteBuffer dst, long position) throws IOException {
          if (dst == null)
              throw new NullPointerException();
          if (position &lt; 0)
              throw new IllegalArgumentException(&quot;Negative position&quot;);
<span class="udiff-line-added">+         ensureOpen();</span>
          if (!readable)
              throw new NonReadableChannelException();
          if (direct)
              Util.checkChannelPositionAligned(position, alignment);
<span class="udiff-line-removed">-         ensureOpen();</span>
          if (nd.needsPositionLock()) {
              synchronized (positionLock) {
                  return readInternal(dst, position);
              }
          } else {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -827,15 +825,15 @@</span>
      public int write(ByteBuffer src, long position) throws IOException {
          if (src == null)
              throw new NullPointerException();
          if (position &lt; 0)
              throw new IllegalArgumentException(&quot;Negative position&quot;);
<span class="udiff-line-added">+         ensureOpen();</span>
          if (!writable)
              throw new NonWritableChannelException();
          if (direct)
              Util.checkChannelPositionAligned(position, alignment);
<span class="udiff-line-removed">-         ensureOpen();</span>
          if (nd.needsPositionLock()) {
              synchronized (positionLock) {
                  return writeInternal(src, position);
              }
          } else {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1158,12 +1156,12 @@</span>
  
      /**
       * Invoked by sun.management.ManagementFactoryHelper to create the management
       * interface for mapped buffers.
       */
<span class="udiff-line-modified-removed">-     public static JavaNioAccess.BufferPool getMappedBufferPool() {</span>
<span class="udiff-line-modified-removed">-         return new JavaNioAccess.BufferPool() {</span>
<span class="udiff-line-modified-added">+     public static BufferPool getMappedBufferPool() {</span>
<span class="udiff-line-modified-added">+         return new BufferPool() {</span>
              @Override
              public String getName() {
                  return &quot;mapped&quot;;
              }
              @Override
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1183,12 +1181,12 @@</span>
  
      /**
       * Invoked by sun.management.ManagementFactoryHelper to create the management
       * interface for sync mapped buffers.
       */
<span class="udiff-line-modified-removed">-     public static JavaNioAccess.BufferPool getSyncMappedBufferPool() {</span>
<span class="udiff-line-modified-removed">-         return new JavaNioAccess.BufferPool() {</span>
<span class="udiff-line-modified-added">+     public static BufferPool getSyncMappedBufferPool() {</span>
<span class="udiff-line-modified-added">+         return new BufferPool() {</span>
              @Override
              public String getName() {
                  return &quot;mapped - &#39;non-volatile memory&#39;&quot;;
              }
              @Override
</pre>
<center><a href="DatagramSocketAdaptor.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../security/jca/ProviderConfig.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>