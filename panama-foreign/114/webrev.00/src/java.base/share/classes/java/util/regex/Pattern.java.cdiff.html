<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/java/util/regex/Pattern.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="Grapheme.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../zip/ZipFile.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/util/regex/Pattern.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 4033,21 ***</span>
  
          boolean match(Matcher matcher, int i, CharSequence seq) {
              if (i &lt; matcher.to) {
                  int ch0 = Character.codePointAt(seq, i);
                  int n = Character.charCount(ch0);
<span class="line-modified">!                 int j = i + n;</span>
<span class="line-modified">!                 // Fast check if it&#39;s necessary to call Normalizer;</span>
<span class="line-removed">-                 // testing Grapheme.isBoundary is enough for this case</span>
<span class="line-removed">-                 while (j &lt; matcher.to) {</span>
<span class="line-removed">-                     int ch1 = Character.codePointAt(seq, j);</span>
<span class="line-removed">-                     if (Grapheme.isBoundary(ch0, ch1))</span>
<span class="line-removed">-                         break;</span>
<span class="line-removed">-                     ch0 = ch1;</span>
<span class="line-removed">-                     j += Character.charCount(ch1);</span>
<span class="line-removed">-                 }</span>
<span class="line-removed">-                 if (i + n == j) {    // single, assume nfc cp</span>
                      if (predicate.is(ch0))
                          return next.match(matcher, j, seq);
                  } else {
                      while (i + n &lt; j) {
                          String nfc = Normalizer.normalize(
<span class="line-new-header">--- 4033,12 ---</span>
  
          boolean match(Matcher matcher, int i, CharSequence seq) {
              if (i &lt; matcher.to) {
                  int ch0 = Character.codePointAt(seq, i);
                  int n = Character.charCount(ch0);
<span class="line-modified">!                 int j = Grapheme.nextBoundary(seq, i, matcher.to);</span>
<span class="line-modified">!                 if (i + n == j) { // single cp grapheme, assume nfc</span>
                      if (predicate.is(ch0))
                          return next.match(matcher, j, seq);
                  } else {
                      while (i + n &lt; j) {
                          String nfc = Normalizer.normalize(
</pre>
<hr />
<pre>
<span class="line-old-header">*** 4107,17 ***</span>
              if (matcher.transparentBounds) {
                  startIndex = 0;
                  endIndex = matcher.getTextLength();
              }
              if (i == startIndex) {
<span class="line-modified">!                 return next.match(matcher, i, seq);</span>
<span class="line-modified">!             }</span>
<span class="line-modified">!             if (i &lt; endIndex) {</span>
<span class="line-modified">!                 if (Character.isSurrogatePair(seq.charAt(i-1), seq.charAt(i)) ||</span>
<span class="line-modified">!                     Grapheme.nextBoundary(seq,</span>
<span class="line-modified">!                         i - Character.charCount(Character.codePointBefore(seq, i)),</span>
<span class="line-removed">-                         i + Character.charCount(Character.codePointAt(seq, i))) &gt; i) {</span>
                      return false;
                  }
              } else {
                  matcher.hitEnd = true;
                  matcher.requireEnd = true;
<span class="line-new-header">--- 4098,16 ---</span>
              if (matcher.transparentBounds) {
                  startIndex = 0;
                  endIndex = matcher.getTextLength();
              }
              if (i == startIndex) {
<span class="line-modified">!                 // continue with return below</span>
<span class="line-modified">!             } else if (i &lt; endIndex) {</span>
<span class="line-modified">!                 if (Character.isSurrogatePair(seq.charAt(i - 1), seq.charAt(i))) {</span>
<span class="line-modified">!                     return false;</span>
<span class="line-modified">!                 }</span>
<span class="line-modified">!                 if (Grapheme.nextBoundary(seq, matcher.last, endIndex) &gt; i) {</span>
                      return false;
                  }
              } else {
                  matcher.hitEnd = true;
                  matcher.requireEnd = true;
</pre>
<center><a href="Grapheme.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../zip/ZipFile.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>