<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.crypto.ec/share/native/libsunec/impl/mpi.c</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../jdk.crypto.cryptoki/share/native/libj2pkcs11/pkcs11wrapper.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../../../../jdk.hotspot.agent/share/classes/com/sun/java/swing/action/AboutAction.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.crypto.ec/share/native/libsunec/impl/mpi.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2007, 2016, Oracle and/or its affiliates. All rights reserved.</span>
   3  * Use is subject to license terms.
   4  *
   5  * This library is free software; you can redistribute it and/or
   6  * modify it under the terms of the GNU Lesser General Public
   7  * License as published by the Free Software Foundation; either
   8  * version 2.1 of the License, or (at your option) any later version.
   9  *
  10  * This library is distributed in the hope that it will be useful,
  11  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  12  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  13  * Lesser General Public License for more details.
  14  *
  15  * You should have received a copy of the GNU Lesser General Public License
  16  * along with this library; if not, write to the Free Software Foundation,
  17  * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
  18  *
  19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20  * or visit www.oracle.com if you need additional information or have any
  21  * questions.
  22  */
  23 
  24 /* *********************************************************************
  25  *
  26  * The Original Code is the MPI Arbitrary Precision Integer Arithmetic library.
  27  *
  28  * The Initial Developer of the Original Code is
  29  * Michael J. Fromberger.
  30  * Portions created by the Initial Developer are Copyright (C) 1998
  31  * the Initial Developer. All Rights Reserved.
  32  *
  33  * Contributor(s):
  34  *   Netscape Communications Corporation
  35  *   Douglas Stebila &lt;douglas@stebila.ca&gt; of Sun Laboratories.
  36  *
<span class="line-modified">  37  * Last Modified Date from the Original Code: Nov 2016</span>
  38  *********************************************************************** */
  39 
  40 /*  Arbitrary precision integer arithmetic library */
  41 
  42 #include &quot;mpi-priv.h&quot;
  43 #if defined(OSF1)
  44 #include &lt;c_asm.h&gt;
  45 #endif
  46 
  47 #if MP_LOGTAB
  48 /*
  49   A table of the logs of 2 for various bases (the 0 and 1 entries of
  50   this table are meaningless and should not be referenced).
  51 
  52   This table is used to compute output lengths for the mp_toradix()
  53   function.  Since a number n in radix r takes up about log_r(n)
  54   digits, we estimate the output size by taking the least integer
  55   greater than log_r(n), where:
  56 
  57   log_r(n) = log_2(n) * log_r(2)
</pre>
<hr />
<pre>
2119       res = k;
2120       break;
2121     }
2122     diff_sign = mp_cmp(&amp;f, &amp;g);
2123     if (diff_sign &lt; 0) {                /* f &lt; g */
2124       s_mp_exch(&amp;f, &amp;g);
2125       s_mp_exch(c, &amp;d);
2126     } else if (diff_sign == 0) {                /* f == g */
2127       res = MP_UNDEF;           /* a and p are not relatively prime */
2128       break;
2129     }
2130     if ((MP_DIGIT(&amp;f,0) % 4) == (MP_DIGIT(&amp;g,0) % 4)) {
2131       MP_CHECKOK( mp_sub(&amp;f, &amp;g, &amp;f) ); /* f = f - g */
2132       MP_CHECKOK( mp_sub(c,  &amp;d,  c) ); /* c = c - d */
2133     } else {
2134       MP_CHECKOK( mp_add(&amp;f, &amp;g, &amp;f) ); /* f = f + g */
2135       MP_CHECKOK( mp_add(c,  &amp;d,  c) ); /* c = c + d */
2136     }
2137   }
2138   if (res &gt;= 0) {
<span class="line-modified">2139     while (MP_SIGN(c) != MP_ZPOS) {</span>



2140       MP_CHECKOK( mp_add(c, p, c) );
2141     }
2142     res = k;
2143   }
2144 
2145 CLEANUP:
2146   mp_clear(&amp;d);
2147   mp_clear(&amp;f);
2148   mp_clear(&amp;g);
2149   return res;
2150 }
2151 
2152 /* Compute T = (P ** -1) mod MP_RADIX.  Also works for 16-bit mp_digits.
2153 ** This technique from the paper &quot;Fast Modular Reciprocals&quot; (unpublished)
2154 ** by Richard Schroeppel (a.k.a. Captain Nemo).
2155 */
2156 mp_digit  s_mp_invmod_radix(mp_digit P)
2157 {
2158   mp_digit T = P;
2159   T *= 2 - (P * T);
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2007, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   3  * Use is subject to license terms.
   4  *
   5  * This library is free software; you can redistribute it and/or
   6  * modify it under the terms of the GNU Lesser General Public
   7  * License as published by the Free Software Foundation; either
   8  * version 2.1 of the License, or (at your option) any later version.
   9  *
  10  * This library is distributed in the hope that it will be useful,
  11  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  12  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  13  * Lesser General Public License for more details.
  14  *
  15  * You should have received a copy of the GNU Lesser General Public License
  16  * along with this library; if not, write to the Free Software Foundation,
  17  * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
  18  *
  19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20  * or visit www.oracle.com if you need additional information or have any
  21  * questions.
  22  */
  23 
  24 /* *********************************************************************
  25  *
  26  * The Original Code is the MPI Arbitrary Precision Integer Arithmetic library.
  27  *
  28  * The Initial Developer of the Original Code is
  29  * Michael J. Fromberger.
  30  * Portions created by the Initial Developer are Copyright (C) 1998
  31  * the Initial Developer. All Rights Reserved.
  32  *
  33  * Contributor(s):
  34  *   Netscape Communications Corporation
  35  *   Douglas Stebila &lt;douglas@stebila.ca&gt; of Sun Laboratories.
  36  *
<span class="line-modified">  37  * Last Modified Date from the Original Code: Nov 2019</span>
  38  *********************************************************************** */
  39 
  40 /*  Arbitrary precision integer arithmetic library */
  41 
  42 #include &quot;mpi-priv.h&quot;
  43 #if defined(OSF1)
  44 #include &lt;c_asm.h&gt;
  45 #endif
  46 
  47 #if MP_LOGTAB
  48 /*
  49   A table of the logs of 2 for various bases (the 0 and 1 entries of
  50   this table are meaningless and should not be referenced).
  51 
  52   This table is used to compute output lengths for the mp_toradix()
  53   function.  Since a number n in radix r takes up about log_r(n)
  54   digits, we estimate the output size by taking the least integer
  55   greater than log_r(n), where:
  56 
  57   log_r(n) = log_2(n) * log_r(2)
</pre>
<hr />
<pre>
2119       res = k;
2120       break;
2121     }
2122     diff_sign = mp_cmp(&amp;f, &amp;g);
2123     if (diff_sign &lt; 0) {                /* f &lt; g */
2124       s_mp_exch(&amp;f, &amp;g);
2125       s_mp_exch(c, &amp;d);
2126     } else if (diff_sign == 0) {                /* f == g */
2127       res = MP_UNDEF;           /* a and p are not relatively prime */
2128       break;
2129     }
2130     if ((MP_DIGIT(&amp;f,0) % 4) == (MP_DIGIT(&amp;g,0) % 4)) {
2131       MP_CHECKOK( mp_sub(&amp;f, &amp;g, &amp;f) ); /* f = f - g */
2132       MP_CHECKOK( mp_sub(c,  &amp;d,  c) ); /* c = c - d */
2133     } else {
2134       MP_CHECKOK( mp_add(&amp;f, &amp;g, &amp;f) ); /* f = f + g */
2135       MP_CHECKOK( mp_add(c,  &amp;d,  c) ); /* c = c + d */
2136     }
2137   }
2138   if (res &gt;= 0) {
<span class="line-modified">2139     if (s_mp_cmp(c, p) &gt;= 0) {</span>
<span class="line-added">2140       MP_CHECKOK( mp_div(c, p, NULL, c));</span>
<span class="line-added">2141     }</span>
<span class="line-added">2142     if (MP_SIGN(c) != MP_ZPOS) {</span>
2143       MP_CHECKOK( mp_add(c, p, c) );
2144     }
2145     res = k;
2146   }
2147 
2148 CLEANUP:
2149   mp_clear(&amp;d);
2150   mp_clear(&amp;f);
2151   mp_clear(&amp;g);
2152   return res;
2153 }
2154 
2155 /* Compute T = (P ** -1) mod MP_RADIX.  Also works for 16-bit mp_digits.
2156 ** This technique from the paper &quot;Fast Modular Reciprocals&quot; (unpublished)
2157 ** by Richard Schroeppel (a.k.a. Captain Nemo).
2158 */
2159 mp_digit  s_mp_invmod_radix(mp_digit P)
2160 {
2161   mp_digit T = P;
2162   T *= 2 - (P * T);
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../jdk.crypto.cryptoki/share/native/libj2pkcs11/pkcs11wrapper.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../../../../jdk.hotspot.agent/share/classes/com/sun/java/swing/action/AboutAction.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>