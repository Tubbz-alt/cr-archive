<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/ui/ProcessListPanel.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ObjectListPanel.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SAPanel.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/ui/ProcessListPanel.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2001, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2001, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 34,11 ***</span>
  import sun.jvm.hotspot.debugger.*;
  
  public class ProcessListPanel extends JPanel {
    private Debugger           dbg;
    private AbstractTableModel dataModel;
<span class="line-modified">!   private java.util.List     els;</span>
    private boolean            sortByName   = true;
    private boolean            sortReversed = false;
    private javax.swing.Timer  timer;
    private JTable             table;
  
<span class="line-new-header">--- 34,11 ---</span>
  import sun.jvm.hotspot.debugger.*;
  
  public class ProcessListPanel extends JPanel {
    private Debugger           dbg;
    private AbstractTableModel dataModel;
<span class="line-modified">!   private java.util.List&lt;ProcessInfo&gt; els;</span>
    private boolean            sortByName   = true;
    private boolean            sortReversed = false;
    private javax.swing.Timer  timer;
    private JTable             table;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 71,11 ***</span>
  
            switch (col) {
            case 0:
              return info.getName();
            case 1:
<span class="line-modified">!             return new Integer(info.getPid());</span>
            default:
              throw new RuntimeException(&quot;Index (&quot; + col + &quot;, &quot; + row + &quot;) out of bounds&quot;);
            }
          }
        };
<span class="line-new-header">--- 71,11 ---</span>
  
            switch (col) {
            case 0:
              return info.getName();
            case 1:
<span class="line-modified">!             return info.getPid();</span>
            default:
              throw new RuntimeException(&quot;Index (&quot; + col + &quot;, &quot; + row + &quot;) out of bounds&quot;);
            }
          }
        };
</pre>
<hr />
<pre>
<span class="line-old-header">*** 147,11 ***</span>
    /** Call this to update the panel&#39;s notion of the process list */
    public synchronized void update() {
      if (!dbg.hasProcessList()) {
        throw new RuntimeException(&quot;ProcessListPanel requires that debugger supports getProcessList()&quot;);
      }
<span class="line-modified">!     java.util.List newEls = dbg.getProcessList();</span>
      sort(newEls);
      if (table != null) {
        // Keep the current selection if possible
        int i = table.getSelectedRow();
        int pid = getPid(els, i);
<span class="line-new-header">--- 147,11 ---</span>
    /** Call this to update the panel&#39;s notion of the process list */
    public synchronized void update() {
      if (!dbg.hasProcessList()) {
        throw new RuntimeException(&quot;ProcessListPanel requires that debugger supports getProcessList()&quot;);
      }
<span class="line-modified">!     java.util.List&lt;ProcessInfo&gt; newEls = dbg.getProcessList();</span>
      sort(newEls);
      if (table != null) {
        // Keep the current selection if possible
        int i = table.getSelectedRow();
        int pid = getPid(els, i);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 174,28 ***</span>
    public synchronized ProcessInfo getSelectedProcess() {
      int i = table.getSelectedRow();
      if (i &lt; 0) {
        return null;
      }
<span class="line-modified">!     return (ProcessInfo) els.get(i);</span>
    }
  
<span class="line-modified">!   private synchronized void sort(java.util.List els) {</span>
<span class="line-modified">!     Comparator c;</span>
      if (sortByName) {
<span class="line-modified">!       c = new Comparator() {</span>
<span class="line-modified">!           public int compare(Object o1, Object o2) {</span>
              int scale = (sortReversed ? -1 : 1);
<span class="line-modified">!             return scale * ((ProcessInfo) o1).getName().compareToIgnoreCase(((ProcessInfo) o2).getName());</span>
            }
          };
      } else {
<span class="line-modified">!       c = new Comparator() {</span>
<span class="line-modified">!           public int compare(Object o1, Object o2) {</span>
              int scale = (sortReversed ? -1 : 1);
<span class="line-modified">!             int pid1 = ((ProcessInfo) o1).getPid();</span>
<span class="line-modified">!             int pid2 = ((ProcessInfo) o2).getPid();</span>
              int ret;
              if      (pid1 &lt;  pid2) ret = -1;
              else if (pid1 == pid2) ret = 0;
              else ret = 1;
              return ret * scale;
<span class="line-new-header">--- 174,28 ---</span>
    public synchronized ProcessInfo getSelectedProcess() {
      int i = table.getSelectedRow();
      if (i &lt; 0) {
        return null;
      }
<span class="line-modified">!     return els.get(i);</span>
    }
  
<span class="line-modified">!   private synchronized void sort(java.util.List&lt;ProcessInfo&gt; els) {</span>
<span class="line-modified">!     Comparator&lt;ProcessInfo&gt; c;</span>
      if (sortByName) {
<span class="line-modified">!       c = new Comparator&lt;&gt;() {</span>
<span class="line-modified">!           public int compare(ProcessInfo o1, ProcessInfo o2) {</span>
              int scale = (sortReversed ? -1 : 1);
<span class="line-modified">!             return scale * o1.getName().compareToIgnoreCase(o2.getName());</span>
            }
          };
      } else {
<span class="line-modified">!       c = new Comparator&lt;&gt;() {</span>
<span class="line-modified">!           public int compare(ProcessInfo o1, ProcessInfo o2) {</span>
              int scale = (sortReversed ? -1 : 1);
<span class="line-modified">!             int pid1 = o1.getPid();</span>
<span class="line-modified">!             int pid2 = o2.getPid();</span>
              int ret;
              if      (pid1 &lt;  pid2) ret = -1;
              else if (pid1 == pid2) ret = 0;
              else ret = 1;
              return ret * scale;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 214,17 ***</span>
          });
      }
      return timer;
    }
  
<span class="line-modified">!   private synchronized int getPid(java.util.List els, int index) {</span>
<span class="line-modified">!     return ((ProcessInfo) els.get(index)).getPid();</span>
    }
  
<span class="line-modified">!   private synchronized int findPid(java.util.List els, int pid) {</span>
      for (int i = 0; i &lt; els.size(); i++) {
<span class="line-modified">!       ProcessInfo info = (ProcessInfo) els.get(i);</span>
        if (info.getPid() == pid) {
          return i;
        }
      }
      return -1;
<span class="line-new-header">--- 214,17 ---</span>
          });
      }
      return timer;
    }
  
<span class="line-modified">!   private synchronized int getPid(java.util.List&lt;ProcessInfo&gt; els, int index) {</span>
<span class="line-modified">!     return els.get(index).getPid();</span>
    }
  
<span class="line-modified">!   private synchronized int findPid(java.util.List&lt;ProcessInfo&gt; els, int pid) {</span>
      for (int i = 0; i &lt; els.size(); i++) {
<span class="line-modified">!       ProcessInfo info = els.get(i);</span>
        if (info.getPid() == pid) {
          return i;
        }
      }
      return -1;
</pre>
<center><a href="ObjectListPanel.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SAPanel.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>