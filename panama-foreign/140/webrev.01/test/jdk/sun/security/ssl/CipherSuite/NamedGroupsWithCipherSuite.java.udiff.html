<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/jdk/sun/security/ssl/CipherSuite/NamedGroupsWithCipherSuite.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../pkcs/pkcs9/UnknownAttribute.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../SSLSocketImpl/SSLSocketKeyLimit.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/sun/security/ssl/CipherSuite/NamedGroupsWithCipherSuite.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -79,17 +79,17 @@</span>
  
      private SSLSocketTemplate.Cert[] trustedCerts = TRUSTED_CERTS;
      private SSLSocketTemplate.Cert[] endEntityCerts = END_ENTITY_CERTS;
  
      NamedGroupsWithCipherSuite(
<span class="udiff-line-modified-removed">-             String protocol,</span>
<span class="udiff-line-modified-removed">-             String cipher,</span>
<span class="udiff-line-modified-added">+             Protocol protocol,</span>
<span class="udiff-line-modified-added">+             CipherSuite cipher,</span>
              String namedGroup) {
<span class="udiff-line-modified-removed">-         this.protocol = protocol;</span>
<span class="udiff-line-modified-removed">-         this.cipher = cipher;</span>
<span class="udiff-line-modified-added">+         this.protocol = protocol.name;</span>
<span class="udiff-line-modified-added">+         this.cipher = cipher.name();</span>
  
<span class="udiff-line-modified-removed">-         if (cipher.startsWith(&quot;TLS_ECDHE_ECDSA&quot;)) {</span>
<span class="udiff-line-modified-added">+         if (cipher.keyExAlgorithm == KeyExAlgorithm.ECDHE_ECDSA) {</span>
              switch (namedGroup) {
              case &quot;secp256r1&quot;:
                  trustedCerts = new SSLSocketTemplate.Cert[] {
                          SSLSocketTemplate.Cert.CA_ECDSA_SECP256R1 };
                  endEntityCerts = new SSLSocketTemplate.Cert[] {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -105,10 +105,16 @@</span>
                  trustedCerts = new SSLSocketTemplate.Cert[] {
                          SSLSocketTemplate.Cert.CA_ECDSA_SECP521R1 };
                  endEntityCerts = new SSLSocketTemplate.Cert[] {
                          SSLSocketTemplate.Cert.EE_ECDSA_SECP521R1 };
              }
<span class="udiff-line-added">+         } else if (protocol.id &lt; Protocol.TLSV1_2.id</span>
<span class="udiff-line-added">+                 &amp;&amp; cipher.keyExAlgorithm == KeyExAlgorithm.DHE_DSS) {</span>
<span class="udiff-line-added">+             trustedCerts = new SSLSocketTemplate.Cert[] {</span>
<span class="udiff-line-added">+                     SSLSocketTemplate.Cert.CA_DSA_1024 };</span>
<span class="udiff-line-added">+             endEntityCerts = new SSLSocketTemplate.Cert[] {</span>
<span class="udiff-line-added">+                     SSLSocketTemplate.Cert.EE_DSA_1024 };</span>
          }
      }
  
      protected SSLContext createClientSSLContext() throws Exception {
          return createSSLContext(trustedCerts, endEntityCerts,
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -148,12 +154,12 @@</span>
                                  cipherSuite)) {
                      System.out.printf(&quot;Protocol: %s, cipher suite: %s%n&quot;,
                              protocol, cipherSuite);
                      // Named group converted to lower case just
                      // to satisfy Test condition
<span class="udiff-line-modified-removed">-                     new NamedGroupsWithCipherSuite(protocol.name,</span>
<span class="udiff-line-modified-removed">-                             cipherSuite.name(), namedGroup.toLowerCase()).run();</span>
<span class="udiff-line-modified-added">+                     new NamedGroupsWithCipherSuite(protocol,</span>
<span class="udiff-line-modified-added">+                             cipherSuite, namedGroup.toLowerCase()).run();</span>
                  }
              }
          }
      }
  
</pre>
<center><a href="../../pkcs/pkcs9/UnknownAttribute.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../SSLSocketImpl/SSLSocketKeyLimit.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>