<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/jdk/jfr/event/compiler/TestDeoptimization.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="TestCompilerPhase.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../gc/collection/TestG1ParallelPhases.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/jdk/jfr/event/compiler/TestDeoptimization.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 41 
 42 // Careful if moving this class or method somewhere since verifyDeoptimizationEventFields asserts the linenumber
 43 class Dummy {
 44     public static void dummyMethod(boolean b) {
 45         if (b) {
 46             System.out.println(&quot;Deoptimized&quot;);
 47         }
 48     }
 49 }
 50 
 51 /**
 52  * @test
 53  * @key jfr
 54  * @summary sanity test for Deoptimization event, depends on Compilation event
 55  * @requires vm.hasJFR
 56  * @requires vm.compMode != &quot;Xint&quot;
 57  * @requires vm.flavor == &quot;server&quot; &amp; (vm.opt.TieredStopAtLevel == 4 | vm.opt.TieredStopAtLevel == null)
 58  * @library /test/lib
 59  * @build sun.hotspot.WhiteBox
 60  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
<span class="line-removed"> 61  *                                sun.hotspot.WhiteBox$WhiteBoxPermission</span>
 62  * @run main/othervm -XX:-BackgroundCompilation -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI jdk.jfr.event.compiler.TestDeoptimization
 63  */
 64 public class TestDeoptimization {
 65     private static final WhiteBox WHITE_BOX = WhiteBox.getWhiteBox();
 66     private final static String TYPE_NAME = Dummy.class.getName().replace(&quot;.&quot;, &quot;/&quot;);
 67     private final static String METHOD_NAME = &quot;dummyMethod&quot;;
 68     private static final String METHOD_DESCRIPTOR = &quot;(Z)V&quot;;
 69     private static final String[] COMPILER =  { &quot;c2&quot;,  &quot;jvmci&quot; };
 70 
 71     public static void main(String[] args) throws Throwable {
 72         new TestDeoptimization().doTest();
 73     }
 74 
 75     public void doTest() throws Throwable {
 76         Method dummyMethodDesc = Dummy.class.getDeclaredMethod(&quot;dummyMethod&quot;, boolean.class);
 77 
 78         System.out.println(&quot;Deoptimization Test&quot;);
 79 
 80         Recording recording = new Recording();
 81         recording.enable(EventNames.Deoptimization);
</pre>
</td>
<td>
<hr />
<pre>
 41 
 42 // Careful if moving this class or method somewhere since verifyDeoptimizationEventFields asserts the linenumber
 43 class Dummy {
 44     public static void dummyMethod(boolean b) {
 45         if (b) {
 46             System.out.println(&quot;Deoptimized&quot;);
 47         }
 48     }
 49 }
 50 
 51 /**
 52  * @test
 53  * @key jfr
 54  * @summary sanity test for Deoptimization event, depends on Compilation event
 55  * @requires vm.hasJFR
 56  * @requires vm.compMode != &quot;Xint&quot;
 57  * @requires vm.flavor == &quot;server&quot; &amp; (vm.opt.TieredStopAtLevel == 4 | vm.opt.TieredStopAtLevel == null)
 58  * @library /test/lib
 59  * @build sun.hotspot.WhiteBox
 60  * @run driver ClassFileInstaller sun.hotspot.WhiteBox

 61  * @run main/othervm -XX:-BackgroundCompilation -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI jdk.jfr.event.compiler.TestDeoptimization
 62  */
 63 public class TestDeoptimization {
 64     private static final WhiteBox WHITE_BOX = WhiteBox.getWhiteBox();
 65     private final static String TYPE_NAME = Dummy.class.getName().replace(&quot;.&quot;, &quot;/&quot;);
 66     private final static String METHOD_NAME = &quot;dummyMethod&quot;;
 67     private static final String METHOD_DESCRIPTOR = &quot;(Z)V&quot;;
 68     private static final String[] COMPILER =  { &quot;c2&quot;,  &quot;jvmci&quot; };
 69 
 70     public static void main(String[] args) throws Throwable {
 71         new TestDeoptimization().doTest();
 72     }
 73 
 74     public void doTest() throws Throwable {
 75         Method dummyMethodDesc = Dummy.class.getDeclaredMethod(&quot;dummyMethod&quot;, boolean.class);
 76 
 77         System.out.println(&quot;Deoptimization Test&quot;);
 78 
 79         Recording recording = new Recording();
 80         recording.enable(EventNames.Deoptimization);
</pre>
</td>
</tr>
</table>
<center><a href="TestCompilerPhase.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../gc/collection/TestG1ParallelPhases.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>