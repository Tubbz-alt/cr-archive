<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/gc/g1/ihop/TestIHOPErgo.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../humongousObjects/objectGraphTest/TestObjectGraphAfterGC.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TestIHOPStatic.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/gc/g1/ihop/TestIHOPErgo.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
111                 &quot;-XX:&quot; + (isIhopAdaptive ? &quot;+&quot; : &quot;-&quot;) + &quot;G1UseAdaptiveIHOP&quot;
112         );
113 
114         Collections.addAll(options, COMMON_OPTIONS);
115         options.add(AppIHOP.class.getName());
116         OutputAnalyzer out = executeTest(options);
117 
118         // Checks that log contains message which indicates that IHOP prediction is active
119         if (isIhopAdaptive) {
120             IhopUtils.checkAdaptiveIHOPWasActivated(out);
121         }
122         // Checks that log contains messages which indicates that VM initiates/checks heap occupancy
123         // and tries to start concurrent cycle.
124         IhopUtils.checkErgoMessagesExist(out);
125 
126         // Checks threshold and occupancy values
127         IhopUtils.checkIhopLogValues(out);
128     }
129 
130     private static OutputAnalyzer executeTest(List&lt;String&gt; options) throws Throwable, RuntimeException {
<span class="line-modified">131         OutputAnalyzer out;</span>
<span class="line-removed">132         out = ProcessTools.executeTestJvm(options.toArray(new String[options.size()]));</span>
133         if (out.getExitValue() != 0) {
134             System.out.println(out.getOutput());
135             throw new RuntimeException(&quot;AppIHOP failed with exit code&quot; + out.getExitValue());
136         }
137         return out;
138     }
139 
140     /**
141      * The AppIHOP fills 60% of heap and allocates and frees 30% of existing
142      * heap &#39;iterations&#39; times to achieve IHOP activation. To be executed in
143      * separate VM. Expected properties:
144      * heap.size - heap size which is used to calculate amount of memory
145      *             to be allocated and freed
146      * sleep.time - short pause between filling each MB
147      */
148     public static class AppIHOP {
149 
150         public final static LinkedList&lt;Object&gt; GARBAGE = new LinkedList&lt;&gt;();
151 
152         private final int ITERATIONS = 10;
</pre>
</td>
<td>
<hr />
<pre>
111                 &quot;-XX:&quot; + (isIhopAdaptive ? &quot;+&quot; : &quot;-&quot;) + &quot;G1UseAdaptiveIHOP&quot;
112         );
113 
114         Collections.addAll(options, COMMON_OPTIONS);
115         options.add(AppIHOP.class.getName());
116         OutputAnalyzer out = executeTest(options);
117 
118         // Checks that log contains message which indicates that IHOP prediction is active
119         if (isIhopAdaptive) {
120             IhopUtils.checkAdaptiveIHOPWasActivated(out);
121         }
122         // Checks that log contains messages which indicates that VM initiates/checks heap occupancy
123         // and tries to start concurrent cycle.
124         IhopUtils.checkErgoMessagesExist(out);
125 
126         // Checks threshold and occupancy values
127         IhopUtils.checkIhopLogValues(out);
128     }
129 
130     private static OutputAnalyzer executeTest(List&lt;String&gt; options) throws Throwable, RuntimeException {
<span class="line-modified">131         OutputAnalyzer out = ProcessTools.executeTestJvm(options);</span>

132         if (out.getExitValue() != 0) {
133             System.out.println(out.getOutput());
134             throw new RuntimeException(&quot;AppIHOP failed with exit code&quot; + out.getExitValue());
135         }
136         return out;
137     }
138 
139     /**
140      * The AppIHOP fills 60% of heap and allocates and frees 30% of existing
141      * heap &#39;iterations&#39; times to achieve IHOP activation. To be executed in
142      * separate VM. Expected properties:
143      * heap.size - heap size which is used to calculate amount of memory
144      *             to be allocated and freed
145      * sleep.time - short pause between filling each MB
146      */
147     public static class AppIHOP {
148 
149         public final static LinkedList&lt;Object&gt; GARBAGE = new LinkedList&lt;&gt;();
150 
151         private final int ITERATIONS = 10;
</pre>
</td>
</tr>
</table>
<center><a href="../humongousObjects/objectGraphTest/TestObjectGraphAfterGC.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TestIHOPStatic.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>