<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/gc/g1/TestRemsetLoggingTools.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="TestRemsetLoggingThreads.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="TestSharedArchiveWithPreTouch.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/gc/g1/TestRemsetLoggingTools.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 60             &quot;-XX:+UseG1GC&quot;,
 61             &quot;-Xmn4m&quot;,
 62             &quot;-Xint&quot;, // -Xint makes the test run faster
 63             &quot;-Xms20m&quot;,
 64             &quot;-Xmx20m&quot;,
 65             &quot;-XX:ParallelGCThreads=1&quot;,
 66             &quot;-XX:InitiatingHeapOccupancyPercent=100&quot;, // we don&#39;t want the additional GCs due to initial marking
 67             &quot;-XX:+UnlockDiagnosticVMOptions&quot;,
 68             &quot;-XX:G1HeapRegionSize=1M&quot;,
 69         };
 70 
 71         finalargs.addAll(Arrays.asList(defaultArgs));
 72 
 73         if (additionalArgs != null) {
 74             finalargs.addAll(Arrays.asList(additionalArgs));
 75         }
 76 
 77         finalargs.add(VerifySummaryOutput.class.getName());
 78         finalargs.add(String.valueOf(numGCs));
 79 
<span class="line-modified"> 80         ProcessBuilder pb = ProcessTools.createJavaProcessBuilder(</span>
<span class="line-removed"> 81             finalargs.toArray(new String[0]));</span>
 82         OutputAnalyzer output = new OutputAnalyzer(pb.start());
 83 
 84         output.shouldHaveExitValue(0);
 85 
 86         String result = output.getStdout();
 87         return result;
 88     }
 89 
 90     private static void checkCounts(int expected, int actual, String which) throws Exception {
 91         if (expected != actual) {
 92             throw new Exception(&quot;RSet summaries mention &quot; + which + &quot; regions an incorrect number of times. Expected &quot; + expected + &quot;, got &quot; + actual);
 93         }
 94     }
 95 
 96     public static void expectPerRegionRSetSummaries(String result, int expectedCumulative, int expectedPeriodic) throws Exception {
 97         expectRSetSummaries(result, expectedCumulative, expectedPeriodic);
 98         int actualYoung = result.split(&quot;Young regions&quot;).length - 1;
 99         int actualHumongous = result.split(&quot;Humongous regions&quot;).length - 1;
100         int actualFree = result.split(&quot;Free regions&quot;).length - 1;
101         int actualOther = result.split(&quot;Old regions&quot;).length - 1;
</pre>
</td>
<td>
<hr />
<pre>
 60             &quot;-XX:+UseG1GC&quot;,
 61             &quot;-Xmn4m&quot;,
 62             &quot;-Xint&quot;, // -Xint makes the test run faster
 63             &quot;-Xms20m&quot;,
 64             &quot;-Xmx20m&quot;,
 65             &quot;-XX:ParallelGCThreads=1&quot;,
 66             &quot;-XX:InitiatingHeapOccupancyPercent=100&quot;, // we don&#39;t want the additional GCs due to initial marking
 67             &quot;-XX:+UnlockDiagnosticVMOptions&quot;,
 68             &quot;-XX:G1HeapRegionSize=1M&quot;,
 69         };
 70 
 71         finalargs.addAll(Arrays.asList(defaultArgs));
 72 
 73         if (additionalArgs != null) {
 74             finalargs.addAll(Arrays.asList(additionalArgs));
 75         }
 76 
 77         finalargs.add(VerifySummaryOutput.class.getName());
 78         finalargs.add(String.valueOf(numGCs));
 79 
<span class="line-modified"> 80         ProcessBuilder pb = ProcessTools.createJavaProcessBuilder(finalargs);</span>

 81         OutputAnalyzer output = new OutputAnalyzer(pb.start());
 82 
 83         output.shouldHaveExitValue(0);
 84 
 85         String result = output.getStdout();
 86         return result;
 87     }
 88 
 89     private static void checkCounts(int expected, int actual, String which) throws Exception {
 90         if (expected != actual) {
 91             throw new Exception(&quot;RSet summaries mention &quot; + which + &quot; regions an incorrect number of times. Expected &quot; + expected + &quot;, got &quot; + actual);
 92         }
 93     }
 94 
 95     public static void expectPerRegionRSetSummaries(String result, int expectedCumulative, int expectedPeriodic) throws Exception {
 96         expectRSetSummaries(result, expectedCumulative, expectedPeriodic);
 97         int actualYoung = result.split(&quot;Young regions&quot;).length - 1;
 98         int actualHumongous = result.split(&quot;Humongous regions&quot;).length - 1;
 99         int actualFree = result.split(&quot;Free regions&quot;).length - 1;
100         int actualOther = result.split(&quot;Old regions&quot;).length - 1;
</pre>
</td>
</tr>
</table>
<center><a href="TestRemsetLoggingThreads.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="TestSharedArchiveWithPreTouch.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>