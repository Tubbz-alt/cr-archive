<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/gc/stress/TestStressG1Humongous.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="TestReclaimStringsLeaksMemory.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="TestStressRSetCoarsening.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/gc/stress/TestStressG1Humongous.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 55         run(heapSize, 16, 5, 2.1, 120);
 56         run(heapSize, 32, 4, 0.6, 120);
 57         run(heapSize, 1, 7, 0.6, 600);
 58     }
 59 
 60     private static void run(int heapSize, int regionSize, int threads, double humongousSize, int timeout)
 61             throws Exception {
 62         ArrayList&lt;String&gt; options = new ArrayList&lt;&gt;();
 63         Collections.addAll(options, Utils.getTestJavaOpts());
 64         Collections.addAll(options,
 65                 &quot;-Xlog:gc=debug&quot;,
 66                 &quot;-Xmx&quot; + heapSize + &quot;m&quot;,
 67                 &quot;-XX:+UseG1GC&quot;,
 68                 &quot;-XX:G1HeapRegionSize=&quot; + regionSize + &quot;m&quot;,
 69                 &quot;-Dtimeout=&quot; + timeout,
 70                 &quot;-Dthreads=&quot; + threads,
 71                 &quot;-Dhumongoussize=&quot; + humongousSize,
 72                 &quot;-Dregionsize=&quot; + regionSize,
 73                 TestStressG1HumongousImpl.class.getName()
 74         );
<span class="line-modified"> 75         ProcessBuilder pb = ProcessTools.createJavaProcessBuilder(options.toArray(new String[options.size()]));</span>
 76         OutputAnalyzer output = new OutputAnalyzer(pb.start());
 77         output.shouldHaveExitValue(0);
 78     }
 79 }
 80 
 81 class TestStressG1HumongousImpl {
 82     // Timeout in seconds
 83     private static final int TIMEOUT = Integer.getInteger(&quot;timeout&quot;, 60);
 84     private static final int THREAD_COUNT = Integer.getInteger(&quot;threads&quot;, 2);
 85     private static final int REGION_SIZE = Integer.getInteger(&quot;regionsize&quot;, 1) * 1024 * 1024;
 86     private static final int HUMONGOUS_SIZE = (int) (REGION_SIZE * Double.parseDouble(System.getProperty(&quot;humongoussize&quot;, &quot;1.5&quot;)));
 87     private static final int NUMBER_OF_FREE_REGIONS = 2;
 88 
 89     private volatile boolean isRunning;
 90     private final Thread[] threads;
 91     private final AtomicInteger alocatedObjectsCount;
 92     private CountDownLatch countDownLatch;
 93     public static final List&lt;Object&gt; GARBAGE = Collections.synchronizedList(new ArrayList&lt;&gt;());
 94 
 95     public static void main(String[] args) throws InterruptedException {
</pre>
</td>
<td>
<hr />
<pre>
 55         run(heapSize, 16, 5, 2.1, 120);
 56         run(heapSize, 32, 4, 0.6, 120);
 57         run(heapSize, 1, 7, 0.6, 600);
 58     }
 59 
 60     private static void run(int heapSize, int regionSize, int threads, double humongousSize, int timeout)
 61             throws Exception {
 62         ArrayList&lt;String&gt; options = new ArrayList&lt;&gt;();
 63         Collections.addAll(options, Utils.getTestJavaOpts());
 64         Collections.addAll(options,
 65                 &quot;-Xlog:gc=debug&quot;,
 66                 &quot;-Xmx&quot; + heapSize + &quot;m&quot;,
 67                 &quot;-XX:+UseG1GC&quot;,
 68                 &quot;-XX:G1HeapRegionSize=&quot; + regionSize + &quot;m&quot;,
 69                 &quot;-Dtimeout=&quot; + timeout,
 70                 &quot;-Dthreads=&quot; + threads,
 71                 &quot;-Dhumongoussize=&quot; + humongousSize,
 72                 &quot;-Dregionsize=&quot; + regionSize,
 73                 TestStressG1HumongousImpl.class.getName()
 74         );
<span class="line-modified"> 75         ProcessBuilder pb = ProcessTools.createJavaProcessBuilder(options);</span>
 76         OutputAnalyzer output = new OutputAnalyzer(pb.start());
 77         output.shouldHaveExitValue(0);
 78     }
 79 }
 80 
 81 class TestStressG1HumongousImpl {
 82     // Timeout in seconds
 83     private static final int TIMEOUT = Integer.getInteger(&quot;timeout&quot;, 60);
 84     private static final int THREAD_COUNT = Integer.getInteger(&quot;threads&quot;, 2);
 85     private static final int REGION_SIZE = Integer.getInteger(&quot;regionsize&quot;, 1) * 1024 * 1024;
 86     private static final int HUMONGOUS_SIZE = (int) (REGION_SIZE * Double.parseDouble(System.getProperty(&quot;humongoussize&quot;, &quot;1.5&quot;)));
 87     private static final int NUMBER_OF_FREE_REGIONS = 2;
 88 
 89     private volatile boolean isRunning;
 90     private final Thread[] threads;
 91     private final AtomicInteger alocatedObjectsCount;
 92     private CountDownLatch countDownLatch;
 93     public static final List&lt;Object&gt; GARBAGE = Collections.synchronizedList(new ArrayList&lt;&gt;());
 94 
 95     public static void main(String[] args) throws InterruptedException {
</pre>
</td>
</tr>
</table>
<center><a href="TestReclaimStringsLeaksMemory.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="TestStressRSetCoarsening.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>