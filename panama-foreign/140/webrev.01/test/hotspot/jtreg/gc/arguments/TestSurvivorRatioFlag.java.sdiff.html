<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/gc/arguments/TestSurvivorRatioFlag.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="TestSurvivorAlignmentInBytesOption.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="TestTargetSurvivorRatioFlag.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/gc/arguments/TestSurvivorRatioFlag.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 72      */
 73     public static void testSurvivorRatio(int ratio, LinkedList&lt;String&gt; options) throws Exception {
 74 
 75         LinkedList&lt;String&gt; vmOptions = new LinkedList&lt;&gt;(options);
 76 
 77         Collections.addAll(vmOptions,
 78                 &quot;-Xbootclasspath/a:.&quot;,
 79                 &quot;--add-exports=java.base/jdk.internal.misc=ALL-UNNAMED&quot;,
 80                 &quot;-XX:+UnlockDiagnosticVMOptions&quot;,
 81                 &quot;-XX:+WhiteBoxAPI&quot;,
 82                 &quot;-XX:GCLockerEdenExpansionPercent=0&quot;,
 83                 &quot;-XX:MaxNewSize=&quot; + NEW_SIZE,
 84                 &quot;-XX:NewSize=&quot; + NEW_SIZE,
 85                 &quot;-Xmx&quot; + HEAP_SIZE,
 86                 &quot;-Xms&quot; + HEAP_SIZE,
 87                 &quot;-XX:SurvivorRatio=&quot; + ratio,
 88                 SurvivorRatioVerifier.class.getName(),
 89                 Integer.toString(ratio)
 90         );
 91 
<span class="line-modified"> 92         ProcessBuilder procBuilder = GCArguments.createJavaProcessBuilder(vmOptions.toArray(new String[vmOptions.size()]));</span>
 93         OutputAnalyzer analyzer = new OutputAnalyzer(procBuilder.start());
 94         analyzer.shouldHaveExitValue(0);
 95     }
 96 
 97     /**
 98      * Class that verifies survivor ratio.
 99      */
100     public static class SurvivorRatioVerifier {
101 
102         static WhiteBox wb = WhiteBox.getWhiteBox();
103 
104         public static final int MAX_ITERATIONS = 10;
105         public static final int ARRAY_LENGTH = 10000;
106         public static final int CHUNK_SIZE = 10000;
107 
108         public static void main(String args[]) throws Exception {
109             if (args.length != 1) {
110                 throw new IllegalArgumentException(&quot;Expected 1 arg: &lt;ratio&gt;&quot;);
111             }
112             final int ratio = Integer.valueOf(args[0]);
</pre>
</td>
<td>
<hr />
<pre>
 72      */
 73     public static void testSurvivorRatio(int ratio, LinkedList&lt;String&gt; options) throws Exception {
 74 
 75         LinkedList&lt;String&gt; vmOptions = new LinkedList&lt;&gt;(options);
 76 
 77         Collections.addAll(vmOptions,
 78                 &quot;-Xbootclasspath/a:.&quot;,
 79                 &quot;--add-exports=java.base/jdk.internal.misc=ALL-UNNAMED&quot;,
 80                 &quot;-XX:+UnlockDiagnosticVMOptions&quot;,
 81                 &quot;-XX:+WhiteBoxAPI&quot;,
 82                 &quot;-XX:GCLockerEdenExpansionPercent=0&quot;,
 83                 &quot;-XX:MaxNewSize=&quot; + NEW_SIZE,
 84                 &quot;-XX:NewSize=&quot; + NEW_SIZE,
 85                 &quot;-Xmx&quot; + HEAP_SIZE,
 86                 &quot;-Xms&quot; + HEAP_SIZE,
 87                 &quot;-XX:SurvivorRatio=&quot; + ratio,
 88                 SurvivorRatioVerifier.class.getName(),
 89                 Integer.toString(ratio)
 90         );
 91 
<span class="line-modified"> 92         ProcessBuilder procBuilder = GCArguments.createJavaProcessBuilder(vmOptions);</span>
 93         OutputAnalyzer analyzer = new OutputAnalyzer(procBuilder.start());
 94         analyzer.shouldHaveExitValue(0);
 95     }
 96 
 97     /**
 98      * Class that verifies survivor ratio.
 99      */
100     public static class SurvivorRatioVerifier {
101 
102         static WhiteBox wb = WhiteBox.getWhiteBox();
103 
104         public static final int MAX_ITERATIONS = 10;
105         public static final int ARRAY_LENGTH = 10000;
106         public static final int CHUNK_SIZE = 10000;
107 
108         public static void main(String args[]) throws Exception {
109             if (args.length != 1) {
110                 throw new IllegalArgumentException(&quot;Expected 1 arg: &lt;ratio&gt;&quot;);
111             }
112             final int ratio = Integer.valueOf(args[0]);
</pre>
</td>
</tr>
</table>
<center><a href="TestSurvivorAlignmentInBytesOption.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="TestTargetSurvivorRatioFlag.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>