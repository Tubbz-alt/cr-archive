<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/hotspot/jtreg/runtime/CommandLine/PrintTouchedMethods.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="OptionsValidation/common/optionsvalidation/JVMOptionsUtils.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="TestHexArguments.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/runtime/CommandLine/PrintTouchedMethods.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 38,20 ***</span>
  import jdk.test.lib.JDKToolFinder;
  
  public class PrintTouchedMethods {
  
      public static void main(String args[]) throws Exception {
<span class="line-modified">!       String[] javaArgs1 = {&quot;-XX:-UnlockDiagnosticVMOptions&quot;, &quot;-XX:+LogTouchedMethods&quot;, &quot;-XX:+PrintTouchedMethodsAtExit&quot;, &quot;TestLogTouchedMethods&quot;};</span>
<span class="line-modified">!       ProcessBuilder pb = ProcessTools.createJavaProcessBuilder(javaArgs1);</span>
  
        // UnlockDiagnostic turned off, should fail
        OutputAnalyzer output = new OutputAnalyzer(pb.start());
        output.shouldContain(&quot;Error: VM option &#39;LogTouchedMethods&#39; is diagnostic and must be enabled via -XX:+UnlockDiagnosticVMOptions.&quot;);
        output.shouldContain(&quot;Error: Could not create the Java Virtual Machine.&quot;);
  
<span class="line-modified">!       String[] javaArgs2 = {&quot;-XX:+UnlockDiagnosticVMOptions&quot;, &quot;-XX:+LogTouchedMethods&quot;, &quot;-XX:+PrintTouchedMethodsAtExit&quot;, &quot;TestLogTouchedMethods&quot;};</span>
<span class="line-modified">!       pb = ProcessTools.createJavaProcessBuilder(javaArgs2);</span>
        output = new OutputAnalyzer(pb.start());
        // check order:
        // 1 &quot;# Method::print_touched_methods version 1&quot; is the first in first line
        // 2 should contain TestLogMethods.methodA:()V
        // 3 should not contain TestLogMethods.methodB:()V
<span class="line-new-header">--- 38,26 ---</span>
  import jdk.test.lib.JDKToolFinder;
  
  public class PrintTouchedMethods {
  
      public static void main(String args[]) throws Exception {
<span class="line-modified">!       ProcessBuilder pb = ProcessTools.createJavaProcessBuilder(</span>
<span class="line-modified">!           &quot;-XX:-UnlockDiagnosticVMOptions&quot;,</span>
<span class="line-added">+           &quot;-XX:+LogTouchedMethods&quot;,</span>
<span class="line-added">+           &quot;-XX:+PrintTouchedMethodsAtExit&quot;,</span>
<span class="line-added">+           &quot;TestLogTouchedMethods&quot;);</span>
  
        // UnlockDiagnostic turned off, should fail
        OutputAnalyzer output = new OutputAnalyzer(pb.start());
        output.shouldContain(&quot;Error: VM option &#39;LogTouchedMethods&#39; is diagnostic and must be enabled via -XX:+UnlockDiagnosticVMOptions.&quot;);
        output.shouldContain(&quot;Error: Could not create the Java Virtual Machine.&quot;);
  
<span class="line-modified">!       pb = ProcessTools.createJavaProcessBuilder(</span>
<span class="line-modified">!           &quot;-XX:+UnlockDiagnosticVMOptions&quot;,</span>
<span class="line-added">+           &quot;-XX:+LogTouchedMethods&quot;,</span>
<span class="line-added">+           &quot;-XX:+PrintTouchedMethodsAtExit&quot;,</span>
<span class="line-added">+           &quot;TestLogTouchedMethods&quot;);</span>
        output = new OutputAnalyzer(pb.start());
        // check order:
        // 1 &quot;# Method::print_touched_methods version 1&quot; is the first in first line
        // 2 should contain TestLogMethods.methodA:()V
        // 3 should not contain TestLogMethods.methodB:()V
</pre>
<hr />
<pre>
<span class="line-old-header">*** 69,12 ***</span>
  
        output.shouldContain(&quot;TestLogTouchedMethods.methodA:()V&quot;);
        output.shouldNotContain(&quot;TestLogTouchedMethods.methodB:()V&quot;);
        output.shouldHaveExitValue(0);
  
<span class="line-modified">!       String[] javaArgs3 = {&quot;-XX:+UnlockDiagnosticVMOptions&quot;, &quot;-Xint&quot;, &quot;-XX:+LogTouchedMethods&quot;, &quot;-XX:+PrintTouchedMethodsAtExit&quot;, &quot;TestLogTouchedMethods&quot;};</span>
<span class="line-modified">!       pb = ProcessTools.createJavaProcessBuilder(javaArgs3);</span>
        output = new OutputAnalyzer(pb.start());
        lines = output.asLines();
  
        if (lines.size() &lt; 1) {
          throw new Exception(&quot;Empty output&quot;);
<span class="line-new-header">--- 75,16 ---</span>
  
        output.shouldContain(&quot;TestLogTouchedMethods.methodA:()V&quot;);
        output.shouldNotContain(&quot;TestLogTouchedMethods.methodB:()V&quot;);
        output.shouldHaveExitValue(0);
  
<span class="line-modified">!       pb = ProcessTools.createJavaProcessBuilder(</span>
<span class="line-modified">!           &quot;-XX:+UnlockDiagnosticVMOptions&quot;,</span>
<span class="line-added">+           &quot;-Xint&quot;,</span>
<span class="line-added">+           &quot;-XX:+LogTouchedMethods&quot;,</span>
<span class="line-added">+           &quot;-XX:+PrintTouchedMethodsAtExit&quot;,</span>
<span class="line-added">+           &quot;TestLogTouchedMethods&quot;);</span>
        output = new OutputAnalyzer(pb.start());
        lines = output.asLines();
  
        if (lines.size() &lt; 1) {
          throw new Exception(&quot;Empty output&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 87,12 ***</span>
  
        output.shouldContain(&quot;TestLogTouchedMethods.methodA:()V&quot;);
        output.shouldNotContain(&quot;TestLogTouchedMethods.methodB:()V&quot;);
        output.shouldHaveExitValue(0);
  
<span class="line-modified">!       String[] javaArgs4 = {&quot;-XX:+UnlockDiagnosticVMOptions&quot;, &quot;-Xint&quot;, &quot;-XX:+LogTouchedMethods&quot;, &quot;-XX:+PrintTouchedMethodsAtExit&quot;, &quot;-XX:-TieredCompilation&quot;, &quot;TestLogTouchedMethods&quot;};</span>
<span class="line-modified">!       pb = ProcessTools.createJavaProcessBuilder(javaArgs4);</span>
        output = new OutputAnalyzer(pb.start());
        lines = output.asLines();
  
        if (lines.size() &lt; 1) {
          throw new Exception(&quot;Empty output&quot;);
<span class="line-new-header">--- 97,17 ---</span>
  
        output.shouldContain(&quot;TestLogTouchedMethods.methodA:()V&quot;);
        output.shouldNotContain(&quot;TestLogTouchedMethods.methodB:()V&quot;);
        output.shouldHaveExitValue(0);
  
<span class="line-modified">!       pb = ProcessTools.createJavaProcessBuilder(</span>
<span class="line-modified">!           &quot;-XX:+UnlockDiagnosticVMOptions&quot;,</span>
<span class="line-added">+           &quot;-Xint&quot;,</span>
<span class="line-added">+           &quot;-XX:+LogTouchedMethods&quot;,</span>
<span class="line-added">+           &quot;-XX:+PrintTouchedMethodsAtExit&quot;,</span>
<span class="line-added">+           &quot;-XX:-TieredCompilation&quot;,</span>
<span class="line-added">+           &quot;TestLogTouchedMethods&quot;);</span>
        output = new OutputAnalyzer(pb.start());
        lines = output.asLines();
  
        if (lines.size() &lt; 1) {
          throw new Exception(&quot;Empty output&quot;);
</pre>
<center><a href="OptionsValidation/common/optionsvalidation/JVMOptionsUtils.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="TestHexArguments.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>