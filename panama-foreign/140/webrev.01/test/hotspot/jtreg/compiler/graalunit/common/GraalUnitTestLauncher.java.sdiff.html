<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/compiler/graalunit/common/GraalUnitTestLauncher.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../TestPackages.txt.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../interpreter/DisableOSRTest.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/compiler/graalunit/common/GraalUnitTestLauncher.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
261         String graalJarsCP = graalJars.stream()
262                                       .map(s -&gt; String.join(File.separator, libsDir, s))
263                                       .collect(Collectors.joining(File.pathSeparator));
264 
265         javaFlags.add(&quot;-cp&quot;);
266         // Existing classpath returned by System.getProperty(&quot;java.class.path&quot;) may contain another
267         // version of junit with which the jtreg tool is built. It may be incompatible with required
268         // junit version. So we put graalJarsCP before existing classpath when generating a new one
269         // to avoid incompatibility issues.
270         javaFlags.add(String.join(File.pathSeparator, graalJarsCP, System.getProperty(&quot;java.class.path&quot;)));
271 
272         //
273         javaFlags.add(&quot;com.oracle.mxtool.junit.MxJUnitWrapper&quot;);
274         javaFlags.add(&quot;-JUnitVerbose&quot;);
275         javaFlags.add(&quot;-JUnitEagerStackTrace&quot;);
276         javaFlags.add(&quot;-JUnitEnableTiming&quot;);
277 
278         javaFlags.add(&quot;@&quot;+GENERATED_TESTCLASSES_FILENAME);
279 
280         ProcessBuilder javaPB = ProcessTools.createJavaProcessBuilder(true,
<span class="line-modified">281                 javaFlags.toArray(new String[javaFlags.size()]));</span>
282 
283         // Some tests rely on MX_SUBPROCESS_COMMAND_FILE env variable which contains
284         // name of the file with java executable and java args used to launch the current process.
285         Path cmdFile = Files.createTempFile(Path.of(&quot;&quot;), &quot;mx_subprocess_&quot;, &quot;.cmd&quot;);
286         Files.write(cmdFile, javaPB.command());
287         javaPB.environment().put(&quot;MX_SUBPROCESS_COMMAND_FILE&quot;, cmdFile.toAbsolutePath().toString());
288 
289         System.out.println(&quot;INFO: run command: &quot; + String.join(&quot; &quot;, javaPB.command()));
290 
291         OutputAnalyzer outputAnalyzer = new OutputAnalyzer(javaPB.start());
292         System.out.println(&quot;INFO: execution result: &quot; + outputAnalyzer.getOutput());
293         outputAnalyzer.shouldHaveExitValue(0);
294     }
295 }
</pre>
</td>
<td>
<hr />
<pre>
261         String graalJarsCP = graalJars.stream()
262                                       .map(s -&gt; String.join(File.separator, libsDir, s))
263                                       .collect(Collectors.joining(File.pathSeparator));
264 
265         javaFlags.add(&quot;-cp&quot;);
266         // Existing classpath returned by System.getProperty(&quot;java.class.path&quot;) may contain another
267         // version of junit with which the jtreg tool is built. It may be incompatible with required
268         // junit version. So we put graalJarsCP before existing classpath when generating a new one
269         // to avoid incompatibility issues.
270         javaFlags.add(String.join(File.pathSeparator, graalJarsCP, System.getProperty(&quot;java.class.path&quot;)));
271 
272         //
273         javaFlags.add(&quot;com.oracle.mxtool.junit.MxJUnitWrapper&quot;);
274         javaFlags.add(&quot;-JUnitVerbose&quot;);
275         javaFlags.add(&quot;-JUnitEagerStackTrace&quot;);
276         javaFlags.add(&quot;-JUnitEnableTiming&quot;);
277 
278         javaFlags.add(&quot;@&quot;+GENERATED_TESTCLASSES_FILENAME);
279 
280         ProcessBuilder javaPB = ProcessTools.createJavaProcessBuilder(true,
<span class="line-modified">281                 javaFlags);</span>
282 
283         // Some tests rely on MX_SUBPROCESS_COMMAND_FILE env variable which contains
284         // name of the file with java executable and java args used to launch the current process.
285         Path cmdFile = Files.createTempFile(Path.of(&quot;&quot;), &quot;mx_subprocess_&quot;, &quot;.cmd&quot;);
286         Files.write(cmdFile, javaPB.command());
287         javaPB.environment().put(&quot;MX_SUBPROCESS_COMMAND_FILE&quot;, cmdFile.toAbsolutePath().toString());
288 
289         System.out.println(&quot;INFO: run command: &quot; + String.join(&quot; &quot;, javaPB.command()));
290 
291         OutputAnalyzer outputAnalyzer = new OutputAnalyzer(javaPB.start());
292         System.out.println(&quot;INFO: execution result: &quot; + outputAnalyzer.getOutput());
293         outputAnalyzer.shouldHaveExitValue(0);
294     }
295 }
</pre>
</td>
</tr>
</table>
<center><a href="../TestPackages.txt.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../interpreter/DisableOSRTest.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>