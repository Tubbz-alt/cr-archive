<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/CompileJavaModules.gmk</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
<body>
<center><a href="CompileInterimLangtools.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="CompileModuleTools.gmk.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/CompileJavaModules.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
 23 # questions.
 24 #
 25 
 26 # This must be the first rule
 27 default: all
 28 
 29 include $(SPEC)
 30 include MakeBase.gmk
 31 include Modules.gmk
 32 include JavaCompilation.gmk
<span class="line-removed"> 33 include SetupJavaCompilers.gmk</span>
 34 
 35 # Hook to include the corresponding custom file, if present.
 36 $(eval $(call IncludeCustomExtension, CompileJavaModules.gmk))
 37 
 38 ################################################################################
 39 # Module specific build settings
 40 
<span class="line-modified"> 41 java.base_ADD_JAVAC_FLAGS += -Xdoclint:all/protected,-reference,-accessibility &#39;-Xdoclint/package:java.*,javax.*&#39; -XDstringConcat=inline</span>
<span class="line-modified"> 42 java.base_COPY += .icu .dat .spp .nrm content-types.properties hijrah-config-Hijrah-umalqura_islamic-umalqura.properties</span>



 43 java.base_CLEAN += intrinsic.properties
 44 
 45 java.base_EXCLUDE_FILES += \
 46   $(TOPDIR)/src/java.base/share/classes/jdk/internal/module/ModuleLoaderMap.java
 47 
 48 java.base_EXCLUDES += java/lang/doc-files
 49 
 50 # Exclude BreakIterator classes that are just used in compile process to generate
 51 # data files and shouldn&#39;t go in the product
 52 java.base_EXCLUDE_FILES += sun/text/resources/BreakIteratorRules.java
 53 
 54 ifeq ($(call isTargetOs, solaris), false)
 55   java.base_EXCLUDE_FILES += \
 56       SolarisLoginModule.java \
 57       SolarisSystem.java \
 58       #
 59 endif
 60 
 61 ifeq ($(call isTargetOs, solaris macosx aix), false)
 62   java.base_EXCLUDE_FILES += sun/nio/fs/PollingWatchService.java
 63 endif
 64 
 65 ifeq ($(call isTargetOs, windows), true)
 66   java.base_EXCLUDE_FILES += \
 67       sun/nio/ch/SimpleAsynchronousFileChannelImpl.java \
 68       #
 69 endif
 70 
 71 ################################################################################
 72 
<span class="line-modified"> 73 java.compiler_ADD_JAVAC_FLAGS += -Xdoclint:all/protected &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

 74 
 75 ################################################################################
 76 
<span class="line-modified"> 77 java.datatransfer_ADD_JAVAC_FLAGS += -Xdoclint:all/protected,-reference &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

 78 java.datatransfer_COPY += flavormap.properties
 79 
 80 ################################################################################
 81 
<span class="line-modified"> 82 java.desktop_ADD_JAVAC_FLAGS += -Xdoclint:all/protected,-reference \</span>
<span class="line-modified"> 83     &#39;-Xdoclint/package:java.*,javax.*&#39; \</span>
<span class="line-removed"> 84     --doclint-format html4</span>
 85 java.desktop_COPY += .gif .png .wav .txt .xml .css .pf
 86 java.desktop_CLEAN += iio-plugin.properties cursors.properties
 87 
 88 java.desktop_EXCLUDES += \
 89     java/awt/doc-files \
 90     javax/swing/doc-files \
 91     javax/swing/text/doc-files \
 92     javax/swing/plaf/synth/doc-files \
 93     javax/swing/undo/doc-files \
 94     sun/awt/X11/doc-files \
 95     #
 96 
 97 java.desktop_EXCLUDE_FILES += \
 98     javax/swing/plaf/nimbus/InternalFrameTitlePanePainter.java \
 99     javax/swing/plaf/nimbus/OptionPaneMessageAreaPainter.java \
100     javax/swing/plaf/nimbus/ScrollBarPainter.java \
101     javax/swing/plaf/nimbus/SliderPainter.java \
102     javax/swing/plaf/nimbus/SpinnerPainter.java \
103     javax/swing/plaf/nimbus/SplitPanePainter.java \
104     javax/swing/plaf/nimbus/TabbedPanePainter.java \
</pre>
<hr />
<pre>
197 
198 # These files do not appear in the build result of the old build. This
199 # is because they are generated sources, but the AUTO_JAVA_FILES won&#39;t
200 # pick them up since they aren&#39;t generated when the source dirs are
201 # searched and they aren&#39;t referenced by any other classes so they won&#39;t
202 # be picked up by implicit compilation. On a rebuild, they are picked up
203 # and compiled. Exclude them here to produce the same rt.jar as the old
204 # build does when building just once.
205 java.desktop_EXCLUDE_FILES += \
206     javax/swing/plaf/nimbus/InternalFrameTitlePanePainter.java \
207     javax/swing/plaf/nimbus/OptionPaneMessageAreaPainter.java \
208     javax/swing/plaf/nimbus/ScrollBarPainter.java \
209     javax/swing/plaf/nimbus/SliderPainter.java \
210     javax/swing/plaf/nimbus/SpinnerPainter.java \
211     javax/swing/plaf/nimbus/SplitPanePainter.java \
212     javax/swing/plaf/nimbus/TabbedPanePainter.java \
213     #
214 
215 ################################################################################
216 
<span class="line-modified">217 java.scripting_ADD_JAVAC_FLAGS += -Xdoclint:all/protected &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

218 java.scripting_COPY += .js
219 java.scripting_CLEAN += .properties
220 
221 ################################################################################
222 
<span class="line-modified">223 java.instrument_ADD_JAVAC_FLAGS += -Xdoclint:all/protected,-accessibility &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

224 
225 ################################################################################
226 
<span class="line-modified">227 java.logging_ADD_JAVAC_FLAGS += -Xdoclint:all/protected,-reference,-accessibility &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

228 
229 ################################################################################
230 
<span class="line-modified">231 java.management_ADD_JAVAC_FLAGS += -Xdoclint:all/protected,-reference,-accessibility &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

232 
233 ################################################################################
234 
<span class="line-modified">235 java.management.rmi_ADD_JAVAC_FLAGS += -Xdoclint:all/protected &#39;-Xdoclint/package:javax.*&#39;</span>

236 
237 ################################################################################
238 
<span class="line-modified">239 java.prefs_ADD_JAVAC_FLAGS += -Xdoclint:all/protected &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

240 
241 ################################################################################
242 
<span class="line-modified">243 java.transaction.xa_ADD_JAVAC_FLAGS += -Xdoclint:all/protected &#39;-Xdoclint/package:javax.*&#39;</span>

244 
245 ################################################################################
246 
<span class="line-modified">247 java.sql_ADD_JAVAC_FLAGS += -Xdoclint:all/protected &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

248 
249 ################################################################################
250 
<span class="line-modified">251 java.sql.rowset_ADD_JAVAC_FLAGS += -Xdoclint:all/protected,-accessibility &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

252 java.sql.rowset_CLEAN_FILES += $(wildcard \
253     $(TOPDIR)/src/java.sql.rowset/share/classes/com/sun/rowset/*.properties \
254     $(TOPDIR)/src/java.sql.rowset/share/classes/javax/sql/rowset/*.properties)
255 
256 ################################################################################
257 
<span class="line-modified">258 java.rmi_ADD_JAVAC_FLAGS += -Xdoclint:all/protected &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

259 java.rmi_CLEAN_FILES += $(wildcard \
260     $(TOPDIR)/src/java.rmi/share/classes/sun/rmi/registry/resources/*.properties \
261     $(TOPDIR)/src/java.rmi/share/classes/sun/rmi/server/resources/*.properties)
262 
263 ################################################################################
264 
<span class="line-modified">265 java.xml_ADD_JAVAC_FLAGS += -Xdoclint:all/protected,-accessibility \</span>
266     &#39;-Xdoclint/package:$(call CommaList, javax.xml.catalog javax.xml.datatype \
267     javax.xml.transform javax.xml.validation javax.xml.xpath)&#39;
268 java.xml_CLEAN += .properties
269 
270 ################################################################################
271 
<span class="line-modified">272 java.naming_ADD_JAVAC_FLAGS += -Xdoclint:all/protected,-accessibility &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

273 java.naming_CLEAN += jndiprovider.properties
274 
275 ################################################################################
276 
<span class="line-modified">277 java.security.jgss_ADD_JAVAC_FLAGS += -Xdoclint:all/protected &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

278 
279 ################################################################################
280 
<span class="line-modified">281 java.smartcardio_ADD_JAVAC_FLAGS += -Xdoclint:all/protected,-accessibility &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

282 
283 ################################################################################
284 
<span class="line-modified">285 java.xml.crypto_ADD_JAVAC_FLAGS += -Xdoclint:all/protected &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

286 java.xml.crypto_COPY += .dtd .xml
287 java.xml.crypto_CLEAN += .properties
288 
289 ################################################################################
290 
291 jdk.charsets_COPY += .dat
292 
293 ################################################################################
294 
295 ################################################################################
296 
<span class="line-modified">297 jdk.compiler_ADD_JAVAC_FLAGS += -Xdoclint:all/protected \</span>
<span class="line-modified">298     &#39;-Xdoclint/package:-com.sun.tools.*,-jdk.internal.*,sun.tools.serialver.resources.*&#39; \</span>
<span class="line-modified">299     -XDstringConcat=inline</span>
300 jdk.compiler_CLEAN_FILES += $(wildcard \
301     $(patsubst %, $(TOPDIR)/src/jdk.compiler/share/classes/%/*.properties, \
302         sun/tools/serialver/resources))
303 
304 ################################################################################
305 
306 jdk.hotspot.agent_DISABLED_WARNINGS += rawtypes serial cast static overrides \
307     fallthrough
308 jdk.hotspot.agent_COPY += .gif .png sa.js .properties
309 
310 ################################################################################
311 
312 jdk.editpad_COPY += .properties
313 
314 ################################################################################
315 
316 jdk.jshell_COPY += .jsh .properties
317 
318 ################################################################################
319 
320 jdk.internal.le_COPY += .properties .caps .txt
321 
322 ################################################################################
323 
324 jdk.internal.opt_COPY += .properties
325 
326 ################################################################################
327 
328 jdk.jcmd_COPY += _options
329 
330 ################################################################################
331 
332 jdk.dynalink_CLEAN += .properties
333 
334 ################################################################################
335 
336 jdk.javadoc_COPY += .xml .css .js .png
337 
338 ################################################################################
339 
<span class="line-modified">340 jdk.jartool_ADD_JAVAC_FLAGS += -XDstringConcat=inline</span>
<span class="line-removed">341 </span>
<span class="line-removed">342 ################################################################################</span>
<span class="line-removed">343 </span>
<span class="line-removed">344 jdk.scripting.nashorn_DISABLED_WARNINGS += removal</span>
<span class="line-removed">345 jdk.scripting.nashorn_COPY := .properties .js</span>
<span class="line-removed">346 </span>
<span class="line-removed">347 ################################################################################</span>
<span class="line-removed">348 </span>
<span class="line-removed">349 jdk.scripting.nashorn.shell_DISABLED_WARNINGS += removal</span>
<span class="line-removed">350 jdk.scripting.nashorn.shell_COPY += .js .properties</span>
351 
352 ################################################################################
353 
354 # No SCTP implementation on Mac OS X or AIX. These classes should be excluded.
355 SCTP_IMPL_CLASSES = \
356     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/AssociationChange.java \
357     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/AssociationImpl.java \
358     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/PeerAddrChange.java \
359     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/ResultContainer.java \
360     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/SctpChannelImpl.java \
361     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/SctpMultiChannelImpl.java \
362     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/SctpNet.java \
363     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/SctpNotification.java \
364     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/SctpServerChannelImpl.java \
365     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/SendFailed.java \
366     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/Shutdown.java
367 
368 ifeq ($(call isTargetOs, macosx), true)
369   jdk.sctp_EXCLUDE_FILES += $(SCTP_IMPL_CLASSES)
370 endif
371 
372 ifeq ($(call isTargetOs, aix), true)
373   jdk.sctp_EXCLUDE_FILES += $(SCTP_IMPL_CLASSES)
374 endif
375 
376 ################################################################################
377 
<span class="line-modified">378 jdk.incubator.jpackage_COPY += .gif .png .txt .spec .script .prerm .preinst .postrm .postinst .list .sh \</span>
<span class="line-modified">379     .desktop .copyright .control .plist .template .icns .scpt .entitlements .wxs .wxl .wxi .ico .bmp .tiff</span>

380 
381 jdk.incubator.jpackage_CLEAN += .properties
382 
383 ################################################################################
384 
385 jdk.jconsole_COPY += .gif .png
386 
387 jdk.jconsole_CLEAN_FILES += $(wildcard \
388     $(TOPDIR)/src/jdk.jconsole/share/classes/sun/tools/jconsole/resources/*.properties)
389 
390 ################################################################################
391 
392 jdk.jdeps_COPY += .txt
393 
394 jdk.jdeps_CLEAN_FILES += $(wildcard \
395     $(TOPDIR)/src/jdk.jdeps/share/classes/com/sun/tools/jdeps/resources/*.properties \
396     $(TOPDIR)/src/jdk.jdeps/share/classes/com/sun/tools/javap/resources/*.properties)
397 
398 ################################################################################
399 
</pre>
<hr />
<pre>
413         com/sun/tools/script/shell))
414 
415 jdk.dev_COPY += .js oqlhelp.html .txt
416 
417 ################################################################################
418 
419 jdk.internal.jvmstat_COPY += aliasmap
420 
421 ################################################################################
422 
423 jdk.incubator.jextract_COPY += .properties .template
424 
425 ################################################################################
426 
427 # -parameters provides method&#39;s parameters information in class file,
428 # JVMCI compilers make use of that information for various sanity checks.
429 # Don&#39;t use Indy strings concatenation to have good JVMCI startup performance.
430 # The exports are needed since JVMCI is dynamically exported (see
431 # jdk.vm.ci.services.internal.ReflectionAccessJDK::openJVMCITo).
432 
<span class="line-modified">433 jdk.internal.vm.ci_ADD_JAVAC_FLAGS += -parameters -XDstringConcat=inline</span>
434 
435 ################################################################################
436 
<span class="line-modified">437 jdk.internal.vm.compiler_ADD_JAVAC_FLAGS += -parameters -XDstringConcat=inline \</span>
438     --add-exports jdk.internal.vm.ci/jdk.vm.ci.aarch64=jdk.internal.vm.compiler \
439     --add-exports jdk.internal.vm.ci/jdk.vm.ci.amd64=jdk.internal.vm.compiler \
440     --add-exports jdk.internal.vm.ci/jdk.vm.ci.code=jdk.internal.vm.compiler \
441     --add-exports jdk.internal.vm.ci/jdk.vm.ci.code.site=jdk.internal.vm.compiler \
442     --add-exports jdk.internal.vm.ci/jdk.vm.ci.code.stack=jdk.internal.vm.compiler \
443     --add-exports jdk.internal.vm.ci/jdk.vm.ci.common=jdk.internal.vm.compiler \
444     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot=jdk.internal.vm.compiler \
445     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot.aarch64=jdk.internal.vm.compiler \
446     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot.amd64=jdk.internal.vm.compiler \
447     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot.sparc=jdk.internal.vm.compiler \
448     --add-exports jdk.internal.vm.ci/jdk.vm.ci.meta=jdk.internal.vm.compiler \
449     --add-exports jdk.internal.vm.ci/jdk.vm.ci.runtime=jdk.internal.vm.compiler \
450     --add-exports jdk.internal.vm.ci/jdk.vm.ci.sparc=jdk.internal.vm.compiler \
451     #
452 
453 jdk.internal.vm.compiler_EXCLUDES += \
454     jdk.internal.vm.compiler.collections.test \
455     jdk.tools.jaotc.test \
456     org.graalvm.compiler.api.directives.test \
457     org.graalvm.compiler.api.test \
458     org.graalvm.compiler.asm.aarch64.test \
459     org.graalvm.compiler.asm.amd64.test \
460     org.graalvm.compiler.asm.sparc.test \
461     org.graalvm.compiler.asm.test \
462     org.graalvm.compiler.core.aarch64.test \
463     org.graalvm.compiler.core.amd64.test \
464     org.graalvm.compiler.core.jdk9.test \
465     org.graalvm.compiler.core.match.processor \
466     org.graalvm.compiler.core.test \
467     org.graalvm.compiler.debug.test \
468     org.graalvm.compiler.graph.test \
469     org.graalvm.compiler.hotspot.aarch64.test \
470     org.graalvm.compiler.hotspot.amd64.test \

471     org.graalvm.compiler.hotspot.jdk9.test \
472     org.graalvm.compiler.hotspot.lir.test \
473     org.graalvm.compiler.hotspot.sparc.test \
474     org.graalvm.compiler.hotspot.test \
475     org.graalvm.compiler.jtt \
476     org.graalvm.compiler.lir.jtt \
477     org.graalvm.compiler.lir.test \
478     org.graalvm.compiler.loop.test \
479     org.graalvm.compiler.microbenchmarks \
480     org.graalvm.compiler.nodeinfo.processor \
481     org.graalvm.compiler.nodes.test \
482     org.graalvm.compiler.options.processor \
483     org.graalvm.compiler.options.test \
484     org.graalvm.compiler.phases.common.test \
485     org.graalvm.compiler.processor \
486     org.graalvm.compiler.replacements.jdk12.test \
487     org.graalvm.compiler.replacements.jdk9.test \
488     org.graalvm.compiler.replacements.processor \
489     org.graalvm.compiler.replacements.test \
490     org.graalvm.compiler.serviceprovider.processor \
491     org.graalvm.compiler.test \
492     org.graalvm.compiler.virtual.bench \
493     org.graalvm.micro.benchmarks \
494     org.graalvm.util.test \
495     #
496 
497 ################################################################################
498 
499 # -parameters provides method&#39;s parameters information in class file,
500 # JVMCI compilers make use of that information for various sanity checks.
501 # Don&#39;t use Indy strings concatenation to have good JAOTC startup performance.
502 # The exports are needed since JVMCI is dynamically exported (see
503 # jdk.vm.ci.services.internal.ReflectionAccessJDK::openJVMCITo).
504 
<span class="line-modified">505 jdk.aot_ADD_JAVAC_FLAGS += -parameters -XDstringConcat=inline \</span>
506     --add-exports jdk.internal.vm.ci/jdk.vm.ci.aarch64=jdk.internal.vm.compiler,jdk.aot \
507     --add-exports jdk.internal.vm.ci/jdk.vm.ci.amd64=jdk.internal.vm.compiler,jdk.aot \
508     --add-exports jdk.internal.vm.ci/jdk.vm.ci.code=jdk.internal.vm.compiler,jdk.aot \
509     --add-exports jdk.internal.vm.ci/jdk.vm.ci.code.site=jdk.internal.vm.compiler,jdk.aot \
510     --add-exports jdk.internal.vm.ci/jdk.vm.ci.code.stack=jdk.internal.vm.compiler,jdk.aot \
511     --add-exports jdk.internal.vm.ci/jdk.vm.ci.common=jdk.internal.vm.compiler,jdk.aot \
512     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot=jdk.internal.vm.compiler,jdk.aot \
513     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot.aarch64=jdk.internal.vm.compiler,jdk.aot \
514     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot.amd64=jdk.internal.vm.compiler,jdk.aot \
515     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot.sparc=jdk.internal.vm.compiler,jdk.aot \
516     --add-exports jdk.internal.vm.ci/jdk.vm.ci.meta=jdk.internal.vm.compiler,jdk.aot \
517     --add-exports jdk.internal.vm.ci/jdk.vm.ci.runtime=jdk.internal.vm.compiler,jdk.aot \
518     --add-exports jdk.internal.vm.ci/jdk.vm.ci.sparc=jdk.internal.vm.compiler,jdk.aot \
519     #
520 
521 jdk.aot_EXCLUDES += \
522     jdk.tools.jaotc.test
523     #
524 
525 ################################################################################
526 
527 sun.charsets_COPY += .dat
528 
529 ################################################################################
530 
531 jdk.localedata_COPY += _dict _th
532 # Exclude BreakIterator classes that are just used in compile process to generate
533 # data files and shouldn&#39;t go in the product
534 jdk.localedata_EXCLUDE_FILES += sun/text/resources/ext/BreakIteratorRules_th.java
535 jdk.localedata_KEEP_ALL_TRANSLATIONS := true
536 ################################################################################
537 
538 jdk.jfr_DISABLED_WARNINGS += exports
539 jdk.jfr_COPY := .xsd .xml .dtd
<span class="line-modified">540 jdk.jfr_ADD_JAVAC_FLAGS := -XDstringConcat=inline</span>
541 
542 ################################################################################
543 # If this is an imported module that has prebuilt classes, only compile
544 # module-info.java.
545 ifneq ($(IMPORT_MODULES_CLASSES), )
546   IMPORT_MODULE_DIR := $(IMPORT_MODULES_CLASSES)/$(MODULE)
547   ifneq ($(wildcard $(IMPORT_MODULE_DIR)), )
548     $(MODULE)_INCLUDE_FILES := module-info.java
549   endif
550 else
551   IMPORT_MODULE_DIR :=
552 endif
553 
554 ################################################################################
555 # Setup the compilation for the module
556 #
557 MODULE_SRC_DIRS := $(call FindModuleSrcDirs, $(MODULE))
558 
559 # The JDK_USER_DEFINED_FILTER is a poor man&#39;s incremental build: by specifying
560 # JDK_FILTER at the make command line, only a subset of the JDK java files will
</pre>
<hr />
<pre>
583   MODULESOURCEPATH := $(call PathList, $(JVMCI_MODULESOURCEPATH))
584 endif
585 
586 ifeq ($(MODULE), jdk.internal.vm.compiler)
587   ## WORKAROUND jdk.internal.vm.compiler source structure issue
588   VM_COMPILER_MODULESOURCEPATH := $(MODULESOURCEPATH) \
589       $(subst /$(MODULE)/,/*/, $(filter-out %processor/src %test/src %jtt/src %bench/src %microbenchmarks/src, \
590           $(wildcard $(TOPDIR)/src/$(MODULE)/share/classes/*/src)))
591   MODULESOURCEPATH := $(call PathList, $(VM_COMPILER_MODULESOURCEPATH))
592 endif
593 
594 ifeq ($(MODULE), jdk.aot)
595   ## WORKAROUND jdk.aot source structure issue
596   AOT_MODULESOURCEPATH := $(MODULESOURCEPATH) \
597       $(subst /$(MODULE)/,/*/, $(filter-out %processor/src, \
598           $(wildcard $(TOPDIR)/src/$(MODULE)/share/classes/*/src)))
599   MODULESOURCEPATH := $(call PathList, $(AOT_MODULESOURCEPATH))
600 endif
601 
602 $(eval $(call SetupJavaCompilation, $(MODULE), \
<span class="line-modified">603     SETUP := $(if $($(MODULE)_SETUP), $($(MODULE)_SETUP), GENERATE_JDKBYTECODE), \</span>
604     MODULE := $(MODULE), \
605     SRC := $(wildcard $(MODULE_SRC_DIRS)), \
606     INCLUDES := $(JDK_USER_DEFINED_FILTER), \
607     FAIL_NO_SRC := $(FAIL_NO_SRC), \
608     BIN := $(if $($(MODULE)_BIN), $($(MODULE)_BIN), $(JDK_OUTPUTDIR)/modules), \
609     HEADERS := $(SUPPORT_OUTPUTDIR)/headers, \
610     CREATE_API_DIGEST := true, \
<span class="line-modified">611     ADD_JAVAC_FLAGS := \</span>
<span class="line-modified">612         $($(MODULE)_ADD_JAVAC_FLAGS) \</span>

613         --module-source-path $(MODULESOURCEPATH) \
614         --module-path $(MODULEPATH) \
615         --system none, \
616 ))
617 
618 TARGETS += $($(MODULE)) $($(MODULE)_COPY_EXTRA)
619 
620 # Declare dependencies between java compilations of different modules.
621 # Since the other modules are declared in different invocations of this file,
622 # use the macro to find the correct target file to depend on.
623 # Only the javac compilation actually depends on other modules so limit
624 # dependency declaration to that by using the *_COMPILE_TARGET variable.
625 $($(MODULE)_COMPILE_TARGET): $(foreach d, $(call FindDepsForModule, $(MODULE)), \
626     $(call SetupJavaCompilationApiTarget, $d, \
627         $(if $($d_BIN), $($d_BIN), $(JDK_OUTPUTDIR)/modules/$d)))
628 
629 ################################################################################
630 # Copy zh_HK properties files from zh_TW
631 
632 $(JDK_OUTPUTDIR)/modules/%_zh_HK.properties: $(JDK_OUTPUTDIR)/modules/%_zh_TW.properties
</pre>
</td>
<td>
<hr />
<pre>
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
 23 # questions.
 24 #
 25 
 26 # This must be the first rule
 27 default: all
 28 
 29 include $(SPEC)
 30 include MakeBase.gmk
 31 include Modules.gmk
 32 include JavaCompilation.gmk

 33 
 34 # Hook to include the corresponding custom file, if present.
 35 $(eval $(call IncludeCustomExtension, CompileJavaModules.gmk))
 36 
 37 ################################################################################
 38 # Module specific build settings
 39 
<span class="line-modified"> 40 java.base_DOCLINT += -Xdoclint:all/protected,-reference,-accessibility \</span>
<span class="line-modified"> 41     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
<span class="line-added"> 42 java.base_JAVAC_FLAGS += -XDstringConcat=inline</span>
<span class="line-added"> 43 java.base_COPY += .icu .dat .spp .nrm content-types.properties \</span>
<span class="line-added"> 44     hijrah-config-Hijrah-umalqura_islamic-umalqura.properties</span>
 45 java.base_CLEAN += intrinsic.properties
 46 
 47 java.base_EXCLUDE_FILES += \
 48   $(TOPDIR)/src/java.base/share/classes/jdk/internal/module/ModuleLoaderMap.java
 49 
 50 java.base_EXCLUDES += java/lang/doc-files
 51 
 52 # Exclude BreakIterator classes that are just used in compile process to generate
 53 # data files and shouldn&#39;t go in the product
 54 java.base_EXCLUDE_FILES += sun/text/resources/BreakIteratorRules.java
 55 
 56 ifeq ($(call isTargetOs, solaris), false)
 57   java.base_EXCLUDE_FILES += \
 58       SolarisLoginModule.java \
 59       SolarisSystem.java \
 60       #
 61 endif
 62 
 63 ifeq ($(call isTargetOs, solaris macosx aix), false)
 64   java.base_EXCLUDE_FILES += sun/nio/fs/PollingWatchService.java
 65 endif
 66 
 67 ifeq ($(call isTargetOs, windows), true)
 68   java.base_EXCLUDE_FILES += \
 69       sun/nio/ch/SimpleAsynchronousFileChannelImpl.java \
 70       #
 71 endif
 72 
 73 ################################################################################
 74 
<span class="line-modified"> 75 java.compiler_DOCLINT += -Xdoclint:all/protected \</span>
<span class="line-added"> 76     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
 77 
 78 ################################################################################
 79 
<span class="line-modified"> 80 java.datatransfer_DOCLINT += -Xdoclint:all/protected,-reference \</span>
<span class="line-added"> 81     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
 82 java.datatransfer_COPY += flavormap.properties
 83 
 84 ################################################################################
 85 
<span class="line-modified"> 86 java.desktop_DOCLINT += -Xdoclint:all/protected,-reference \</span>
<span class="line-modified"> 87     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>

 88 java.desktop_COPY += .gif .png .wav .txt .xml .css .pf
 89 java.desktop_CLEAN += iio-plugin.properties cursors.properties
 90 
 91 java.desktop_EXCLUDES += \
 92     java/awt/doc-files \
 93     javax/swing/doc-files \
 94     javax/swing/text/doc-files \
 95     javax/swing/plaf/synth/doc-files \
 96     javax/swing/undo/doc-files \
 97     sun/awt/X11/doc-files \
 98     #
 99 
100 java.desktop_EXCLUDE_FILES += \
101     javax/swing/plaf/nimbus/InternalFrameTitlePanePainter.java \
102     javax/swing/plaf/nimbus/OptionPaneMessageAreaPainter.java \
103     javax/swing/plaf/nimbus/ScrollBarPainter.java \
104     javax/swing/plaf/nimbus/SliderPainter.java \
105     javax/swing/plaf/nimbus/SpinnerPainter.java \
106     javax/swing/plaf/nimbus/SplitPanePainter.java \
107     javax/swing/plaf/nimbus/TabbedPanePainter.java \
</pre>
<hr />
<pre>
200 
201 # These files do not appear in the build result of the old build. This
202 # is because they are generated sources, but the AUTO_JAVA_FILES won&#39;t
203 # pick them up since they aren&#39;t generated when the source dirs are
204 # searched and they aren&#39;t referenced by any other classes so they won&#39;t
205 # be picked up by implicit compilation. On a rebuild, they are picked up
206 # and compiled. Exclude them here to produce the same rt.jar as the old
207 # build does when building just once.
208 java.desktop_EXCLUDE_FILES += \
209     javax/swing/plaf/nimbus/InternalFrameTitlePanePainter.java \
210     javax/swing/plaf/nimbus/OptionPaneMessageAreaPainter.java \
211     javax/swing/plaf/nimbus/ScrollBarPainter.java \
212     javax/swing/plaf/nimbus/SliderPainter.java \
213     javax/swing/plaf/nimbus/SpinnerPainter.java \
214     javax/swing/plaf/nimbus/SplitPanePainter.java \
215     javax/swing/plaf/nimbus/TabbedPanePainter.java \
216     #
217 
218 ################################################################################
219 
<span class="line-modified">220 java.scripting_DOCLINT += -Xdoclint:all/protected \</span>
<span class="line-added">221     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
222 java.scripting_COPY += .js
223 java.scripting_CLEAN += .properties
224 
225 ################################################################################
226 
<span class="line-modified">227 java.instrument_DOCLINT += -Xdoclint:all/protected,-accessibility \</span>
<span class="line-added">228     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
229 
230 ################################################################################
231 
<span class="line-modified">232 java.logging_DOCLINT += -Xdoclint:all/protected,-reference,-accessibility \</span>
<span class="line-added">233     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
234 
235 ################################################################################
236 
<span class="line-modified">237 java.management_DOCLINT += -Xdoclint:all/protected,-reference,-accessibility \</span>
<span class="line-added">238     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
239 
240 ################################################################################
241 
<span class="line-modified">242 java.management.rmi_DOCLINT += -Xdoclint:all/protected \</span>
<span class="line-added">243     &#39;-Xdoclint/package:javax.*&#39;</span>
244 
245 ################################################################################
246 
<span class="line-modified">247 java.prefs_DOCLINT += -Xdoclint:all/protected \</span>
<span class="line-added">248     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
249 
250 ################################################################################
251 
<span class="line-modified">252 java.transaction.xa_DOCLINT += -Xdoclint:all/protected \</span>
<span class="line-added">253     &#39;-Xdoclint/package:javax.*&#39;</span>
254 
255 ################################################################################
256 
<span class="line-modified">257 java.sql_DOCLINT += -Xdoclint:all/protected \</span>
<span class="line-added">258     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
259 
260 ################################################################################
261 
<span class="line-modified">262 java.sql.rowset_DOCLINT += -Xdoclint:all/protected,-accessibility \</span>
<span class="line-added">263     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
264 java.sql.rowset_CLEAN_FILES += $(wildcard \
265     $(TOPDIR)/src/java.sql.rowset/share/classes/com/sun/rowset/*.properties \
266     $(TOPDIR)/src/java.sql.rowset/share/classes/javax/sql/rowset/*.properties)
267 
268 ################################################################################
269 
<span class="line-modified">270 java.rmi_DOCLINT += -Xdoclint:all/protected \</span>
<span class="line-added">271     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
272 java.rmi_CLEAN_FILES += $(wildcard \
273     $(TOPDIR)/src/java.rmi/share/classes/sun/rmi/registry/resources/*.properties \
274     $(TOPDIR)/src/java.rmi/share/classes/sun/rmi/server/resources/*.properties)
275 
276 ################################################################################
277 
<span class="line-modified">278 java.xml_DOCLINT += -Xdoclint:all/protected,-accessibility \</span>
279     &#39;-Xdoclint/package:$(call CommaList, javax.xml.catalog javax.xml.datatype \
280     javax.xml.transform javax.xml.validation javax.xml.xpath)&#39;
281 java.xml_CLEAN += .properties
282 
283 ################################################################################
284 
<span class="line-modified">285 java.naming_DOCLINT += -Xdoclint:all/protected,-accessibility \</span>
<span class="line-added">286     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
287 java.naming_CLEAN += jndiprovider.properties
288 
289 ################################################################################
290 
<span class="line-modified">291 java.security.jgss_DOCLINT += -Xdoclint:all/protected \</span>
<span class="line-added">292     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
293 
294 ################################################################################
295 
<span class="line-modified">296 java.smartcardio_DOCLINT += -Xdoclint:all/protected,-accessibility \</span>
<span class="line-added">297     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
298 
299 ################################################################################
300 
<span class="line-modified">301 java.xml.crypto_DOCLINT += -Xdoclint:all/protected \</span>
<span class="line-added">302     &#39;-Xdoclint/package:java.*,javax.*&#39;</span>
303 java.xml.crypto_COPY += .dtd .xml
304 java.xml.crypto_CLEAN += .properties
305 
306 ################################################################################
307 
308 jdk.charsets_COPY += .dat
309 
310 ################################################################################
311 
312 ################################################################################
313 
<span class="line-modified">314 jdk.compiler_DOCLINT += -Xdoclint:all/protected \</span>
<span class="line-modified">315     &#39;-Xdoclint/package:-com.sun.tools.*,-jdk.internal.*,sun.tools.serialver.resources.*&#39;</span>
<span class="line-modified">316 jdk.compiler_JAVAC_FLAGS += -XDstringConcat=inline</span>
317 jdk.compiler_CLEAN_FILES += $(wildcard \
318     $(patsubst %, $(TOPDIR)/src/jdk.compiler/share/classes/%/*.properties, \
319         sun/tools/serialver/resources))
320 
321 ################################################################################
322 
323 jdk.hotspot.agent_DISABLED_WARNINGS += rawtypes serial cast static overrides \
324     fallthrough
325 jdk.hotspot.agent_COPY += .gif .png sa.js .properties
326 
327 ################################################################################
328 
329 jdk.editpad_COPY += .properties
330 
331 ################################################################################
332 
333 jdk.jshell_COPY += .jsh .properties
334 
335 ################################################################################
336 
337 jdk.internal.le_COPY += .properties .caps .txt
338 
339 ################################################################################
340 
341 jdk.internal.opt_COPY += .properties
342 
343 ################################################################################
344 
345 jdk.jcmd_COPY += _options
346 
347 ################################################################################
348 
349 jdk.dynalink_CLEAN += .properties
350 
351 ################################################################################
352 
353 jdk.javadoc_COPY += .xml .css .js .png
354 
355 ################################################################################
356 
<span class="line-modified">357 jdk.jartool_JAVAC_FLAGS += -XDstringConcat=inline</span>










358 
359 ################################################################################
360 
361 # No SCTP implementation on Mac OS X or AIX. These classes should be excluded.
362 SCTP_IMPL_CLASSES = \
363     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/AssociationChange.java \
364     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/AssociationImpl.java \
365     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/PeerAddrChange.java \
366     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/ResultContainer.java \
367     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/SctpChannelImpl.java \
368     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/SctpMultiChannelImpl.java \
369     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/SctpNet.java \
370     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/SctpNotification.java \
371     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/SctpServerChannelImpl.java \
372     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/SendFailed.java \
373     $(TOPDIR)/src/jdk.sctp/unix/classes/sun/nio/ch/sctp/Shutdown.java
374 
375 ifeq ($(call isTargetOs, macosx), true)
376   jdk.sctp_EXCLUDE_FILES += $(SCTP_IMPL_CLASSES)
377 endif
378 
379 ifeq ($(call isTargetOs, aix), true)
380   jdk.sctp_EXCLUDE_FILES += $(SCTP_IMPL_CLASSES)
381 endif
382 
383 ################################################################################
384 
<span class="line-modified">385 jdk.incubator.jpackage_COPY += .gif .png .txt .spec .script .prerm .preinst \</span>
<span class="line-modified">386     .postrm .postinst .list .sh .desktop .copyright .control .plist .template \</span>
<span class="line-added">387     .icns .scpt .entitlements .wxs .wxl .wxi .ico .bmp .tiff</span>
388 
389 jdk.incubator.jpackage_CLEAN += .properties
390 
391 ################################################################################
392 
393 jdk.jconsole_COPY += .gif .png
394 
395 jdk.jconsole_CLEAN_FILES += $(wildcard \
396     $(TOPDIR)/src/jdk.jconsole/share/classes/sun/tools/jconsole/resources/*.properties)
397 
398 ################################################################################
399 
400 jdk.jdeps_COPY += .txt
401 
402 jdk.jdeps_CLEAN_FILES += $(wildcard \
403     $(TOPDIR)/src/jdk.jdeps/share/classes/com/sun/tools/jdeps/resources/*.properties \
404     $(TOPDIR)/src/jdk.jdeps/share/classes/com/sun/tools/javap/resources/*.properties)
405 
406 ################################################################################
407 
</pre>
<hr />
<pre>
421         com/sun/tools/script/shell))
422 
423 jdk.dev_COPY += .js oqlhelp.html .txt
424 
425 ################################################################################
426 
427 jdk.internal.jvmstat_COPY += aliasmap
428 
429 ################################################################################
430 
431 jdk.incubator.jextract_COPY += .properties .template
432 
433 ################################################################################
434 
435 # -parameters provides method&#39;s parameters information in class file,
436 # JVMCI compilers make use of that information for various sanity checks.
437 # Don&#39;t use Indy strings concatenation to have good JVMCI startup performance.
438 # The exports are needed since JVMCI is dynamically exported (see
439 # jdk.vm.ci.services.internal.ReflectionAccessJDK::openJVMCITo).
440 
<span class="line-modified">441 jdk.internal.vm.ci_JAVAC_FLAGS += -parameters -XDstringConcat=inline</span>
442 
443 ################################################################################
444 
<span class="line-modified">445 jdk.internal.vm.compiler_JAVAC_FLAGS += -parameters -XDstringConcat=inline \</span>
446     --add-exports jdk.internal.vm.ci/jdk.vm.ci.aarch64=jdk.internal.vm.compiler \
447     --add-exports jdk.internal.vm.ci/jdk.vm.ci.amd64=jdk.internal.vm.compiler \
448     --add-exports jdk.internal.vm.ci/jdk.vm.ci.code=jdk.internal.vm.compiler \
449     --add-exports jdk.internal.vm.ci/jdk.vm.ci.code.site=jdk.internal.vm.compiler \
450     --add-exports jdk.internal.vm.ci/jdk.vm.ci.code.stack=jdk.internal.vm.compiler \
451     --add-exports jdk.internal.vm.ci/jdk.vm.ci.common=jdk.internal.vm.compiler \
452     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot=jdk.internal.vm.compiler \
453     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot.aarch64=jdk.internal.vm.compiler \
454     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot.amd64=jdk.internal.vm.compiler \
455     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot.sparc=jdk.internal.vm.compiler \
456     --add-exports jdk.internal.vm.ci/jdk.vm.ci.meta=jdk.internal.vm.compiler \
457     --add-exports jdk.internal.vm.ci/jdk.vm.ci.runtime=jdk.internal.vm.compiler \
458     --add-exports jdk.internal.vm.ci/jdk.vm.ci.sparc=jdk.internal.vm.compiler \
459     #
460 
461 jdk.internal.vm.compiler_EXCLUDES += \
462     jdk.internal.vm.compiler.collections.test \
463     jdk.tools.jaotc.test \
464     org.graalvm.compiler.api.directives.test \
465     org.graalvm.compiler.api.test \
466     org.graalvm.compiler.asm.aarch64.test \
467     org.graalvm.compiler.asm.amd64.test \
468     org.graalvm.compiler.asm.sparc.test \
469     org.graalvm.compiler.asm.test \
470     org.graalvm.compiler.core.aarch64.test \
471     org.graalvm.compiler.core.amd64.test \
472     org.graalvm.compiler.core.jdk9.test \
473     org.graalvm.compiler.core.match.processor \
474     org.graalvm.compiler.core.test \
475     org.graalvm.compiler.debug.test \
476     org.graalvm.compiler.graph.test \
477     org.graalvm.compiler.hotspot.aarch64.test \
478     org.graalvm.compiler.hotspot.amd64.test \
<span class="line-added">479     org.graalvm.compiler.hotspot.jdk15.test \</span>
480     org.graalvm.compiler.hotspot.jdk9.test \
481     org.graalvm.compiler.hotspot.lir.test \
482     org.graalvm.compiler.hotspot.sparc.test \
483     org.graalvm.compiler.hotspot.test \
484     org.graalvm.compiler.jtt \
485     org.graalvm.compiler.lir.jtt \
486     org.graalvm.compiler.lir.test \
487     org.graalvm.compiler.loop.test \
488     org.graalvm.compiler.microbenchmarks \
489     org.graalvm.compiler.nodeinfo.processor \
490     org.graalvm.compiler.nodes.test \
491     org.graalvm.compiler.options.processor \
492     org.graalvm.compiler.options.test \
493     org.graalvm.compiler.phases.common.test \
494     org.graalvm.compiler.processor \
495     org.graalvm.compiler.replacements.jdk12.test \
496     org.graalvm.compiler.replacements.jdk9.test \
497     org.graalvm.compiler.replacements.processor \
498     org.graalvm.compiler.replacements.test \
499     org.graalvm.compiler.serviceprovider.processor \
500     org.graalvm.compiler.test \
501     org.graalvm.compiler.virtual.bench \
502     org.graalvm.micro.benchmarks \
503     org.graalvm.util.test \
504     #
505 
506 ################################################################################
507 
508 # -parameters provides method&#39;s parameters information in class file,
509 # JVMCI compilers make use of that information for various sanity checks.
510 # Don&#39;t use Indy strings concatenation to have good JAOTC startup performance.
511 # The exports are needed since JVMCI is dynamically exported (see
512 # jdk.vm.ci.services.internal.ReflectionAccessJDK::openJVMCITo).
513 
<span class="line-modified">514 jdk.aot_JAVAC_FLAGS += -parameters -XDstringConcat=inline \</span>
515     --add-exports jdk.internal.vm.ci/jdk.vm.ci.aarch64=jdk.internal.vm.compiler,jdk.aot \
516     --add-exports jdk.internal.vm.ci/jdk.vm.ci.amd64=jdk.internal.vm.compiler,jdk.aot \
517     --add-exports jdk.internal.vm.ci/jdk.vm.ci.code=jdk.internal.vm.compiler,jdk.aot \
518     --add-exports jdk.internal.vm.ci/jdk.vm.ci.code.site=jdk.internal.vm.compiler,jdk.aot \
519     --add-exports jdk.internal.vm.ci/jdk.vm.ci.code.stack=jdk.internal.vm.compiler,jdk.aot \
520     --add-exports jdk.internal.vm.ci/jdk.vm.ci.common=jdk.internal.vm.compiler,jdk.aot \
521     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot=jdk.internal.vm.compiler,jdk.aot \
522     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot.aarch64=jdk.internal.vm.compiler,jdk.aot \
523     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot.amd64=jdk.internal.vm.compiler,jdk.aot \
524     --add-exports jdk.internal.vm.ci/jdk.vm.ci.hotspot.sparc=jdk.internal.vm.compiler,jdk.aot \
525     --add-exports jdk.internal.vm.ci/jdk.vm.ci.meta=jdk.internal.vm.compiler,jdk.aot \
526     --add-exports jdk.internal.vm.ci/jdk.vm.ci.runtime=jdk.internal.vm.compiler,jdk.aot \
527     --add-exports jdk.internal.vm.ci/jdk.vm.ci.sparc=jdk.internal.vm.compiler,jdk.aot \
528     #
529 
530 jdk.aot_EXCLUDES += \
531     jdk.tools.jaotc.test
532     #
533 
534 ################################################################################
535 
536 sun.charsets_COPY += .dat
537 
538 ################################################################################
539 
540 jdk.localedata_COPY += _dict _th
541 # Exclude BreakIterator classes that are just used in compile process to generate
542 # data files and shouldn&#39;t go in the product
543 jdk.localedata_EXCLUDE_FILES += sun/text/resources/ext/BreakIteratorRules_th.java
544 jdk.localedata_KEEP_ALL_TRANSLATIONS := true
545 ################################################################################
546 
547 jdk.jfr_DISABLED_WARNINGS += exports
548 jdk.jfr_COPY := .xsd .xml .dtd
<span class="line-modified">549 jdk.jfr_JAVAC_FLAGS := -XDstringConcat=inline</span>
550 
551 ################################################################################
552 # If this is an imported module that has prebuilt classes, only compile
553 # module-info.java.
554 ifneq ($(IMPORT_MODULES_CLASSES), )
555   IMPORT_MODULE_DIR := $(IMPORT_MODULES_CLASSES)/$(MODULE)
556   ifneq ($(wildcard $(IMPORT_MODULE_DIR)), )
557     $(MODULE)_INCLUDE_FILES := module-info.java
558   endif
559 else
560   IMPORT_MODULE_DIR :=
561 endif
562 
563 ################################################################################
564 # Setup the compilation for the module
565 #
566 MODULE_SRC_DIRS := $(call FindModuleSrcDirs, $(MODULE))
567 
568 # The JDK_USER_DEFINED_FILTER is a poor man&#39;s incremental build: by specifying
569 # JDK_FILTER at the make command line, only a subset of the JDK java files will
</pre>
<hr />
<pre>
592   MODULESOURCEPATH := $(call PathList, $(JVMCI_MODULESOURCEPATH))
593 endif
594 
595 ifeq ($(MODULE), jdk.internal.vm.compiler)
596   ## WORKAROUND jdk.internal.vm.compiler source structure issue
597   VM_COMPILER_MODULESOURCEPATH := $(MODULESOURCEPATH) \
598       $(subst /$(MODULE)/,/*/, $(filter-out %processor/src %test/src %jtt/src %bench/src %microbenchmarks/src, \
599           $(wildcard $(TOPDIR)/src/$(MODULE)/share/classes/*/src)))
600   MODULESOURCEPATH := $(call PathList, $(VM_COMPILER_MODULESOURCEPATH))
601 endif
602 
603 ifeq ($(MODULE), jdk.aot)
604   ## WORKAROUND jdk.aot source structure issue
605   AOT_MODULESOURCEPATH := $(MODULESOURCEPATH) \
606       $(subst /$(MODULE)/,/*/, $(filter-out %processor/src, \
607           $(wildcard $(TOPDIR)/src/$(MODULE)/share/classes/*/src)))
608   MODULESOURCEPATH := $(call PathList, $(AOT_MODULESOURCEPATH))
609 endif
610 
611 $(eval $(call SetupJavaCompilation, $(MODULE), \
<span class="line-modified">612     SMALL_JAVA := false, \</span>
613     MODULE := $(MODULE), \
614     SRC := $(wildcard $(MODULE_SRC_DIRS)), \
615     INCLUDES := $(JDK_USER_DEFINED_FILTER), \
616     FAIL_NO_SRC := $(FAIL_NO_SRC), \
617     BIN := $(if $($(MODULE)_BIN), $($(MODULE)_BIN), $(JDK_OUTPUTDIR)/modules), \
618     HEADERS := $(SUPPORT_OUTPUTDIR)/headers, \
619     CREATE_API_DIGEST := true, \
<span class="line-modified">620     JAVAC_FLAGS := \</span>
<span class="line-modified">621         $($(MODULE)_DOCLINT) \</span>
<span class="line-added">622         $($(MODULE)_JAVAC_FLAGS) \</span>
623         --module-source-path $(MODULESOURCEPATH) \
624         --module-path $(MODULEPATH) \
625         --system none, \
626 ))
627 
628 TARGETS += $($(MODULE)) $($(MODULE)_COPY_EXTRA)
629 
630 # Declare dependencies between java compilations of different modules.
631 # Since the other modules are declared in different invocations of this file,
632 # use the macro to find the correct target file to depend on.
633 # Only the javac compilation actually depends on other modules so limit
634 # dependency declaration to that by using the *_COMPILE_TARGET variable.
635 $($(MODULE)_COMPILE_TARGET): $(foreach d, $(call FindDepsForModule, $(MODULE)), \
636     $(call SetupJavaCompilationApiTarget, $d, \
637         $(if $($d_BIN), $($d_BIN), $(JDK_OUTPUTDIR)/modules/$d)))
638 
639 ################################################################################
640 # Copy zh_HK properties files from zh_TW
641 
642 $(JDK_OUTPUTDIR)/modules/%_zh_HK.properties: $(JDK_OUTPUTDIR)/modules/%_zh_TW.properties
</pre>
</td>
</tr>
</table>
<center><a href="CompileInterimLangtools.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="CompileModuleTools.gmk.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>