<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.incubator.jpackage/macosx/classes/jdk/incubator/jpackage/internal/MacAppImageBuilder.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../../jdk.hotspot.agent/share/classes/sun/jvm/hotspot/runtime/x86/X86Frame.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../share/classes/jdk/incubator/jpackage/internal/ApplicationLayout.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.incubator.jpackage/macosx/classes/jdk/incubator/jpackage/internal/MacAppImageBuilder.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
822                         toThrow.set(ioe);
823                     }
824                 }
825             });
826         }
827         IOException ioe = toThrow.get();
828         if (ioe != null) {
829             throw ioe;
830         }
831 
832         // sign all runtime and frameworks
833         Consumer&lt;? super Path&gt; signIdentifiedByPList = path -&gt; {
834             //noinspection ThrowableResultOfMethodCallIgnored
835             if (toThrow.get() != null) return;
836 
837             try {
838                 List&lt;String&gt; args = new ArrayList&lt;&gt;();
839                 args.addAll(Arrays.asList(&quot;codesign&quot;,
840                         &quot;--timestamp&quot;,
841                         &quot;--options&quot;, &quot;runtime&quot;,
<span class="line-removed">842                         &quot;--deep&quot;,</span>
843                         &quot;--force&quot;,
844                         &quot;-s&quot;, signingIdentity, // sign with this key
845                         &quot;--prefix&quot;, identifierPrefix,
846                         // use the identifier as a prefix
847                         &quot;-vvvv&quot;));
848 
849                 if (keyChain != null &amp;&amp; !keyChain.isEmpty()) {
850                     args.add(&quot;--keychain&quot;);
851                     args.add(keyChain);
852                 }
853                 args.add(path.toString());
854                 ProcessBuilder pb = new ProcessBuilder(args);
855 
856                 IOUtils.exec(pb);
857             } catch (IOException e) {
858                 toThrow.set(e);
859             }
860         };
861 
862         Path javaPath = appLocation.resolve(&quot;Contents/runtime&quot;);
</pre>
<hr />
<pre>
867             if (ioe != null) {
868                 throw ioe;
869             }
870         }
871         Path frameworkPath = appLocation.resolve(&quot;Contents/Frameworks&quot;);
872         if (Files.isDirectory(frameworkPath)) {
873             Files.list(frameworkPath)
874                     .forEach(signIdentifiedByPList);
875 
876             ioe = toThrow.get();
877             if (ioe != null) {
878                 throw ioe;
879             }
880         }
881 
882         // sign the app itself
883         List&lt;String&gt; args = new ArrayList&lt;&gt;();
884         args.addAll(Arrays.asList(&quot;codesign&quot;,
885                 &quot;--timestamp&quot;,
886                 &quot;--options&quot;, &quot;runtime&quot;,
<span class="line-removed">887                 &quot;--deep&quot;,</span>
888                 &quot;--force&quot;,
889                 &quot;-s&quot;, signingIdentity,
890                 &quot;-vvvv&quot;));
891 
892         if (keyChain != null &amp;&amp; !keyChain.isEmpty()) {
893             args.add(&quot;--keychain&quot;);
894             args.add(keyChain);
895         }
896 
897         if (entitlements != null) {
898             args.add(&quot;--entitlements&quot;);
899             args.add(entitlements.toString());
900         }
901 
902         args.add(appLocation.toString());
903 
904         ProcessBuilder pb =
905                 new ProcessBuilder(args.toArray(new String[args.size()]));
906 
907         IOUtils.exec(pb);
</pre>
</td>
<td>
<hr />
<pre>
822                         toThrow.set(ioe);
823                     }
824                 }
825             });
826         }
827         IOException ioe = toThrow.get();
828         if (ioe != null) {
829             throw ioe;
830         }
831 
832         // sign all runtime and frameworks
833         Consumer&lt;? super Path&gt; signIdentifiedByPList = path -&gt; {
834             //noinspection ThrowableResultOfMethodCallIgnored
835             if (toThrow.get() != null) return;
836 
837             try {
838                 List&lt;String&gt; args = new ArrayList&lt;&gt;();
839                 args.addAll(Arrays.asList(&quot;codesign&quot;,
840                         &quot;--timestamp&quot;,
841                         &quot;--options&quot;, &quot;runtime&quot;,

842                         &quot;--force&quot;,
843                         &quot;-s&quot;, signingIdentity, // sign with this key
844                         &quot;--prefix&quot;, identifierPrefix,
845                         // use the identifier as a prefix
846                         &quot;-vvvv&quot;));
847 
848                 if (keyChain != null &amp;&amp; !keyChain.isEmpty()) {
849                     args.add(&quot;--keychain&quot;);
850                     args.add(keyChain);
851                 }
852                 args.add(path.toString());
853                 ProcessBuilder pb = new ProcessBuilder(args);
854 
855                 IOUtils.exec(pb);
856             } catch (IOException e) {
857                 toThrow.set(e);
858             }
859         };
860 
861         Path javaPath = appLocation.resolve(&quot;Contents/runtime&quot;);
</pre>
<hr />
<pre>
866             if (ioe != null) {
867                 throw ioe;
868             }
869         }
870         Path frameworkPath = appLocation.resolve(&quot;Contents/Frameworks&quot;);
871         if (Files.isDirectory(frameworkPath)) {
872             Files.list(frameworkPath)
873                     .forEach(signIdentifiedByPList);
874 
875             ioe = toThrow.get();
876             if (ioe != null) {
877                 throw ioe;
878             }
879         }
880 
881         // sign the app itself
882         List&lt;String&gt; args = new ArrayList&lt;&gt;();
883         args.addAll(Arrays.asList(&quot;codesign&quot;,
884                 &quot;--timestamp&quot;,
885                 &quot;--options&quot;, &quot;runtime&quot;,

886                 &quot;--force&quot;,
887                 &quot;-s&quot;, signingIdentity,
888                 &quot;-vvvv&quot;));
889 
890         if (keyChain != null &amp;&amp; !keyChain.isEmpty()) {
891             args.add(&quot;--keychain&quot;);
892             args.add(keyChain);
893         }
894 
895         if (entitlements != null) {
896             args.add(&quot;--entitlements&quot;);
897             args.add(entitlements.toString());
898         }
899 
900         args.add(appLocation.toString());
901 
902         ProcessBuilder pb =
903                 new ProcessBuilder(args.toArray(new String[args.size()]));
904 
905         IOUtils.exec(pb);
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../../jdk.hotspot.agent/share/classes/sun/jvm/hotspot/runtime/x86/X86Frame.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../share/classes/jdk/incubator/jpackage/internal/ApplicationLayout.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>