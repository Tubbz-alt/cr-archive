<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/runtime/bsd_amd64/BsdAMD64JavaThreadPDAccess.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../ThreadStackTrace.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../win32_amd64/Win32AMD64JavaThreadPDAccess.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/runtime/bsd_amd64/BsdAMD64JavaThreadPDAccess.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 86     Address fp = thread.getLastJavaFP();
 87     if (fp == null) {
 88       return null; // no information
 89     }
 90     return new X86Frame(thread.getLastJavaSP(), fp);
 91   }
 92 
 93   public    RegisterMap newRegisterMap(JavaThread thread, boolean updateMap) {
 94     return new X86RegisterMap(thread, updateMap);
 95   }
 96 
 97   public    Frame getCurrentFrameGuess(JavaThread thread, Address addr) {
 98     ThreadProxy t = getThreadProxy(addr);
 99     AMD64ThreadContext context = (AMD64ThreadContext) t.getContext();
100     AMD64CurrentFrameGuess guesser = new AMD64CurrentFrameGuess(context, thread);
101     if (!guesser.run(GUESS_SCAN_RANGE)) {
102       return null;
103     }
104     if (guesser.getPC() == null) {
105       return new X86Frame(guesser.getSP(), guesser.getFP());




106     } else {
107       return new X86Frame(guesser.getSP(), guesser.getFP(), guesser.getPC());
108     }
109   }
110 
111   public    void printThreadIDOn(Address addr, PrintStream tty) {
112     tty.print(getThreadProxy(addr));
113   }
114 
115   public    void printInfoOn(Address threadAddr, PrintStream tty) {
116     tty.print(&quot;Thread id: &quot;);
117     printThreadIDOn(threadAddr, tty);
118 //    tty.println(&quot;\nPostJavaState: &quot; + getPostJavaState(threadAddr));
119   }
120 
121   public    Address getLastSP(Address addr) {
122     ThreadProxy t = getThreadProxy(addr);
123     AMD64ThreadContext context = (AMD64ThreadContext) t.getContext();
124     return context.getRegisterAsAddress(AMD64ThreadContext.RSP);
125   }
</pre>
</td>
<td>
<hr />
<pre>
 86     Address fp = thread.getLastJavaFP();
 87     if (fp == null) {
 88       return null; // no information
 89     }
 90     return new X86Frame(thread.getLastJavaSP(), fp);
 91   }
 92 
 93   public    RegisterMap newRegisterMap(JavaThread thread, boolean updateMap) {
 94     return new X86RegisterMap(thread, updateMap);
 95   }
 96 
 97   public    Frame getCurrentFrameGuess(JavaThread thread, Address addr) {
 98     ThreadProxy t = getThreadProxy(addr);
 99     AMD64ThreadContext context = (AMD64ThreadContext) t.getContext();
100     AMD64CurrentFrameGuess guesser = new AMD64CurrentFrameGuess(context, thread);
101     if (!guesser.run(GUESS_SCAN_RANGE)) {
102       return null;
103     }
104     if (guesser.getPC() == null) {
105       return new X86Frame(guesser.getSP(), guesser.getFP());
<span class="line-added">106     } else if (VM.getVM().getInterpreter().contains(guesser.getPC())) {</span>
<span class="line-added">107       // pass the value of R13 which contains the bcp for the top level frame</span>
<span class="line-added">108       Address bcp = context.getRegisterAsAddress(AMD64ThreadContext.R13);</span>
<span class="line-added">109       return new X86Frame(guesser.getSP(), guesser.getFP(), guesser.getPC(), null, bcp);</span>
110     } else {
111       return new X86Frame(guesser.getSP(), guesser.getFP(), guesser.getPC());
112     }
113   }
114 
115   public    void printThreadIDOn(Address addr, PrintStream tty) {
116     tty.print(getThreadProxy(addr));
117   }
118 
119   public    void printInfoOn(Address threadAddr, PrintStream tty) {
120     tty.print(&quot;Thread id: &quot;);
121     printThreadIDOn(threadAddr, tty);
122 //    tty.println(&quot;\nPostJavaState: &quot; + getPostJavaState(threadAddr));
123   }
124 
125   public    Address getLastSP(Address addr) {
126     ThreadProxy t = getThreadProxy(addr);
127     AMD64ThreadContext context = (AMD64ThreadContext) t.getContext();
128     return context.getRegisterAsAddress(AMD64ThreadContext.RSP);
129   }
</pre>
</td>
</tr>
</table>
<center><a href="../ThreadStackTrace.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../win32_amd64/Win32AMD64JavaThreadPDAccess.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>