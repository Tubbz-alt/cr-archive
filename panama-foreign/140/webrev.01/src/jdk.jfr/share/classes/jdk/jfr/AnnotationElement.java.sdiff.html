<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.jfr/share/classes/jdk/jfr/AnnotationElement.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/resources/stylesheet.css.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="BooleanFlag.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.jfr/share/classes/jdk/jfr/AnnotationElement.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2016, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 29 import java.lang.reflect.Method;
 30 import java.util.ArrayList;
 31 import java.util.Collections;
 32 import java.util.HashMap;
 33 import java.util.HashSet;
 34 import java.util.List;
 35 import java.util.Map;
 36 import java.util.Objects;
 37 import java.util.Set;
 38 import java.util.StringJoiner;
 39 
 40 import jdk.jfr.internal.Type;
 41 import jdk.jfr.internal.TypeLibrary;
 42 import jdk.jfr.internal.Utils;
 43 
 44 /**
 45  * Describes event metadata, such as labels, descriptions and units.
 46  * &lt;p&gt;
 47  * The following example shows how {@code AnnotationElement} can be used to dynamically define events.
 48  *
<span class="line-modified"> 49  * &lt;pre&gt;</span>
<span class="line-modified"> 50  * &lt;code&gt;</span>
<span class="line-modified"> 51  *   List{@literal &lt;}AnnotationElement{@literal &gt;} typeAnnotations = new ArrayList{@literal &lt;}{@literal &gt;}();</span>
<span class="line-removed"> 52  *   typeannotations.add(new AnnotationElement(Name.class, &quot;com.example.HelloWorld&quot;);</span>
 53  *   typeAnnotations.add(new AnnotationElement(Label.class, &quot;Hello World&quot;));
 54  *   typeAnnotations.add(new AnnotationElement(Description.class, &quot;Helps programmer getting started&quot;));
 55  *
<span class="line-modified"> 56  *   List{@literal &lt;}AnnotationElement{@literal &gt;} fieldAnnotations = new ArrayList{@literal &lt;}{@literal &gt;}();</span>
 57  *   fieldAnnotations.add(new AnnotationElement(Label.class, &quot;Message&quot;));
 58  *
<span class="line-modified"> 59  *   List{@literal &lt;}ValueDescriptor{@literal &gt;} fields = new ArrayList{@literal &lt;}{@literal &gt;}();</span>
 60  *   fields.add(new ValueDescriptor(String.class, &quot;message&quot;, fieldAnnotations));
 61  *
 62  *   EventFactory f = EventFactory.create(typeAnnotations, fields);
 63  *   Event event = f.newEvent();
 64  *   event.commit();
<span class="line-modified"> 65  * &lt;/code&gt;</span>
<span class="line-removed"> 66  * &lt;/pre&gt;</span>
 67  *
 68  * @since 9
 69  */
 70 public final class AnnotationElement {
 71     private final Type type;
 72     private final List&lt;Object&gt; annotationValues;
 73     private final List&lt;String&gt; annotationNames;
 74     private final boolean inBootClassLoader;
 75 
 76     // package private
 77     AnnotationElement(Type type, List&lt;Object&gt; objects, boolean boot) {
 78         Objects.requireNonNull(type);
 79         Objects.requireNonNull(objects);
 80         this.type = type;
 81         if (objects.size() != type.getFields().size()) {
 82             StringJoiner descriptors = new StringJoiner(&quot;,&quot;, &quot;[&quot;, &quot;]&quot;);
 83             for (ValueDescriptor v : type.getFields()) {
 84                 descriptors.add(v.getName());
 85             }
 86             StringJoiner values = new StringJoiner(&quot;,&quot;, &quot;[&quot;, &quot;]&quot;);
</pre>
<hr />
<pre>
340      * @return {@code true} if method exists, {@code false} otherwise
341      */
342     public boolean hasValue(String name) {
343         Objects.requireNonNull(name);
344         for (String n : annotationNames) {
345             if (name.equals(n)) {
346                 return true;
347             }
348         }
349         return false;
350     }
351 
352     /**
353      * Returns the first annotation for the specified type if an
354      * {@code AnnotationElement} with the same name exists, else {@code null}.
355      *
356      * @param &lt;A&gt; the type of the annotation to query for and return if it exists
357      * @param annotationType the {@code Class object} corresponding to the annotation type,
358      *        not {@code null}
359      * @return this element&#39;s annotation for the specified annotation type if
<span class="line-modified">360      *         it it exists, else {@code null}</span>
361      */
362     public final &lt;A&gt; A getAnnotation(Class&lt;? extends Annotation&gt; annotationType) {
363         Objects.requireNonNull(annotationType);
364         return type.getAnnotation(annotationType);
365     }
366 
367     /**
368      * Returns the type ID for this {@code AnnotationElement}.
369      * &lt;p&gt;
370      * The ID is a unique identifier for the type in the Java Virtual Machine (JVM). The ID might not
371      * be the same between JVM instances.
372      *
373      * @return the type ID, not negative
374      */
375     public long getTypeId() {
376         return type.getId();
377     }
378 
379     // package private
380     Type getType() {
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2016, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 29 import java.lang.reflect.Method;
 30 import java.util.ArrayList;
 31 import java.util.Collections;
 32 import java.util.HashMap;
 33 import java.util.HashSet;
 34 import java.util.List;
 35 import java.util.Map;
 36 import java.util.Objects;
 37 import java.util.Set;
 38 import java.util.StringJoiner;
 39 
 40 import jdk.jfr.internal.Type;
 41 import jdk.jfr.internal.TypeLibrary;
 42 import jdk.jfr.internal.Utils;
 43 
 44 /**
 45  * Describes event metadata, such as labels, descriptions and units.
 46  * &lt;p&gt;
 47  * The following example shows how {@code AnnotationElement} can be used to dynamically define events.
 48  *
<span class="line-modified"> 49  * &lt;pre&gt;{@literal</span>
<span class="line-modified"> 50  *   List&lt;AnnotationElement&gt; typeAnnotations = new ArrayList&lt;&gt;();</span>
<span class="line-modified"> 51  *   typeAnnotations.add(new AnnotationElement(Name.class, &quot;com.example.HelloWorld&quot;));</span>

 52  *   typeAnnotations.add(new AnnotationElement(Label.class, &quot;Hello World&quot;));
 53  *   typeAnnotations.add(new AnnotationElement(Description.class, &quot;Helps programmer getting started&quot;));
 54  *
<span class="line-modified"> 55  *   List&lt;AnnotationElement&gt; fieldAnnotations = new ArrayList&lt;&gt;();</span>
 56  *   fieldAnnotations.add(new AnnotationElement(Label.class, &quot;Message&quot;));
 57  *
<span class="line-modified"> 58  *   List&lt;ValueDescriptor&gt; fields = new ArrayList&lt;&gt;();</span>
 59  *   fields.add(new ValueDescriptor(String.class, &quot;message&quot;, fieldAnnotations));
 60  *
 61  *   EventFactory f = EventFactory.create(typeAnnotations, fields);
 62  *   Event event = f.newEvent();
 63  *   event.commit();
<span class="line-modified"> 64  * }&lt;/pre&gt;</span>

 65  *
 66  * @since 9
 67  */
 68 public final class AnnotationElement {
 69     private final Type type;
 70     private final List&lt;Object&gt; annotationValues;
 71     private final List&lt;String&gt; annotationNames;
 72     private final boolean inBootClassLoader;
 73 
 74     // package private
 75     AnnotationElement(Type type, List&lt;Object&gt; objects, boolean boot) {
 76         Objects.requireNonNull(type);
 77         Objects.requireNonNull(objects);
 78         this.type = type;
 79         if (objects.size() != type.getFields().size()) {
 80             StringJoiner descriptors = new StringJoiner(&quot;,&quot;, &quot;[&quot;, &quot;]&quot;);
 81             for (ValueDescriptor v : type.getFields()) {
 82                 descriptors.add(v.getName());
 83             }
 84             StringJoiner values = new StringJoiner(&quot;,&quot;, &quot;[&quot;, &quot;]&quot;);
</pre>
<hr />
<pre>
338      * @return {@code true} if method exists, {@code false} otherwise
339      */
340     public boolean hasValue(String name) {
341         Objects.requireNonNull(name);
342         for (String n : annotationNames) {
343             if (name.equals(n)) {
344                 return true;
345             }
346         }
347         return false;
348     }
349 
350     /**
351      * Returns the first annotation for the specified type if an
352      * {@code AnnotationElement} with the same name exists, else {@code null}.
353      *
354      * @param &lt;A&gt; the type of the annotation to query for and return if it exists
355      * @param annotationType the {@code Class object} corresponding to the annotation type,
356      *        not {@code null}
357      * @return this element&#39;s annotation for the specified annotation type if
<span class="line-modified">358      *         it exists, else {@code null}</span>
359      */
360     public final &lt;A&gt; A getAnnotation(Class&lt;? extends Annotation&gt; annotationType) {
361         Objects.requireNonNull(annotationType);
362         return type.getAnnotation(annotationType);
363     }
364 
365     /**
366      * Returns the type ID for this {@code AnnotationElement}.
367      * &lt;p&gt;
368      * The ID is a unique identifier for the type in the Java Virtual Machine (JVM). The ID might not
369      * be the same between JVM instances.
370      *
371      * @return the type ID, not negative
372      */
373     public long getTypeId() {
374         return type.getId();
375     }
376 
377     // package private
378     Type getType() {
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/resources/stylesheet.css.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="BooleanFlag.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>