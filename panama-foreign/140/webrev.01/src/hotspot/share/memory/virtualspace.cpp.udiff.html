<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/memory/virtualspace.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="metaspaceTracer.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="virtualspace.hpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/memory/virtualspace.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 1997, 2019, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 1997, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -64,16 +64,10 @@</span>
                               bool large,
                               char* requested_address) : _fd_for_heap(-1) {
    initialize(size, alignment, large, requested_address, false);
  }
  
<span class="udiff-line-removed">- ReservedSpace::ReservedSpace(size_t size, size_t alignment,</span>
<span class="udiff-line-removed">-                              bool large,</span>
<span class="udiff-line-removed">-                              bool executable) : _fd_for_heap(-1) {</span>
<span class="udiff-line-removed">-   initialize(size, alignment, large, NULL, executable);</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
  ReservedSpace::ReservedSpace(char* base, size_t size, size_t alignment,
                               bool special, bool executable) : _fd_for_heap(-1) {
    assert((size % os::vm_allocation_granularity()) == 0,
           &quot;size not allocation aligned&quot;);
    _base = base;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -644,12 +638,12 @@</span>
  
  // Reserve space for code segment.  Same as Java heap only we mark this as
  // executable.
  ReservedCodeSpace::ReservedCodeSpace(size_t r_size,
                                       size_t rs_align,
<span class="udiff-line-modified-removed">-                                      bool large) :</span>
<span class="udiff-line-modified-removed">-   ReservedSpace(r_size, rs_align, large, /*executable*/ true) {</span>
<span class="udiff-line-modified-added">+                                      bool large) : ReservedSpace() {</span>
<span class="udiff-line-modified-added">+   initialize(r_size, rs_align, large, /*requested address*/ NULL, /*executable*/ true);</span>
    MemTracker::record_virtual_memory_type((address)base(), mtCode);
  }
  
  // VirtualSpace
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1125,11 +1119,11 @@</span>
      assert(is_aligned(size, os::vm_allocation_granularity()), &quot;Must be at least AG aligned&quot;);
      assert(is_aligned(size, alignment), &quot;Must be at least aligned against alignment&quot;);
  
      bool large = maybe_large &amp;&amp; UseLargePages &amp;&amp; size &gt;= os::large_page_size();
  
<span class="udiff-line-modified-removed">-     ReservedSpace rs(size, alignment, large, false);</span>
<span class="udiff-line-modified-added">+     ReservedSpace rs(size, alignment, large);</span>
  
      assert(rs.base() != NULL, &quot;Must be&quot;);
      assert(rs.size() == size, &quot;Must be&quot;);
  
      if (rs.special()) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1253,11 +1247,11 @@</span>
        return ReservedSpace(reserve_size_aligned);
      case Disable:
      case Commit:
        return ReservedSpace(reserve_size_aligned,
                             os::vm_allocation_granularity(),
<span class="udiff-line-modified-removed">-                            /* large */ false, /* exec */ false);</span>
<span class="udiff-line-modified-added">+                            /* large */ false);</span>
      }
    }
  
    static bool initialize_virtual_space(VirtualSpace&amp; vs, ReservedSpace rs, TestLargePages mode) {
      switch(mode) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1308,11 +1302,11 @@</span>
        return;
      }
  
      size_t large_page_size = os::large_page_size();
  
<span class="udiff-line-modified-removed">-     ReservedSpace reserved(large_page_size, large_page_size, true, false);</span>
<span class="udiff-line-modified-added">+     ReservedSpace reserved(large_page_size, large_page_size, true);</span>
  
      assert(reserved.is_reserved(), &quot;Must be&quot;);
  
      VirtualSpace vs;
      bool initialized = vs.initialize(reserved, 0);
</pre>
<center><a href="metaspaceTracer.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="virtualspace.hpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>