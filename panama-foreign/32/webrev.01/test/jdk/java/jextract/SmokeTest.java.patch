diff a/test/jdk/java/jextract/SmokeTest.java b/test/jdk/java/jextract/SmokeTest.java
--- a/test/jdk/java/jextract/SmokeTest.java
+++ b/test/jdk/java/jextract/SmokeTest.java
@@ -25,11 +25,11 @@
  */
 
 /*
  * @test
  * @build JextractApiTestBase
- * @run testng SmokeTest
+ * @run testng/othervm -Djdk.incubator.foreign.restrictedMethods=permit SmokeTest
  */
 
 import jdk.incubator.jextract.Declaration;
 import jdk.incubator.jextract.Type;
 import org.testng.annotations.Test;
