<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.incubator.foreign/share/classes/jdk/internal/foreign/abi/x64/sysv/CallArranger.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../aarch64/AArch64ABI.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="SysVx64ABI.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.incubator.foreign/share/classes/jdk/internal/foreign/abi/x64/sysv/CallArranger.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
523                 .filter(ArgumentClassImpl.COMPLEX_X87::equals)
524                 .isPresent()) {
525             return COMPLEX_X87_CLASSES;
526         }
527 
528         long nWords = Utils.alignUp((type.byteSize()), 8) / 8;
529         if (nWords &gt; MAX_AGGREGATE_REGS_SIZE) {
530             return createMemoryClassArray(nWords);
531         }
532 
533         ArrayList&lt;ArgumentClassImpl&gt; classes = new ArrayList&lt;&gt;();
534 
535         for (long i = 0; i &lt; nWords; i++) {
536             classes.add(ArgumentClassImpl.NO_CLASS);
537         }
538 
539         long offset = 0;
540         final int count = type.memberLayouts().size();
541         for (int idx = 0; idx &lt; count; idx++) {
542             MemoryLayout t = type.memberLayouts().get(idx);
<span class="line-modified">543             if (Utils.isPadding(t)) {</span>
544                 continue;
545             }
546             // ignore zero-length array for now
547             // TODO: handle zero length arrays here
548             if (t instanceof SequenceLayout) {
549                 if (((SequenceLayout) t).elementCount().orElseThrow() == 0) {
550                     continue;
551                 }
552             }
553             offset = SharedUtils.align(t, false, offset);
554             List&lt;ArgumentClassImpl&gt; subclasses = classifyType(t);
555             if (subclasses.isEmpty()) {
556                 return classes;
557             }
558 
559             for (int i = 0; i &lt; subclasses.size(); i++) {
560                 int pos = (int)(offset / 8);
561                 ArgumentClassImpl newClass = classes.get(i + pos).merge(subclasses.get(i));
562                 classes.set(i + pos, newClass);
563             }
</pre>
</td>
<td>
<hr />
<pre>
523                 .filter(ArgumentClassImpl.COMPLEX_X87::equals)
524                 .isPresent()) {
525             return COMPLEX_X87_CLASSES;
526         }
527 
528         long nWords = Utils.alignUp((type.byteSize()), 8) / 8;
529         if (nWords &gt; MAX_AGGREGATE_REGS_SIZE) {
530             return createMemoryClassArray(nWords);
531         }
532 
533         ArrayList&lt;ArgumentClassImpl&gt; classes = new ArrayList&lt;&gt;();
534 
535         for (long i = 0; i &lt; nWords; i++) {
536             classes.add(ArgumentClassImpl.NO_CLASS);
537         }
538 
539         long offset = 0;
540         final int count = type.memberLayouts().size();
541         for (int idx = 0; idx &lt; count; idx++) {
542             MemoryLayout t = type.memberLayouts().get(idx);
<span class="line-modified">543             if (t.isPadding()) {</span>
544                 continue;
545             }
546             // ignore zero-length array for now
547             // TODO: handle zero length arrays here
548             if (t instanceof SequenceLayout) {
549                 if (((SequenceLayout) t).elementCount().orElseThrow() == 0) {
550                     continue;
551                 }
552             }
553             offset = SharedUtils.align(t, false, offset);
554             List&lt;ArgumentClassImpl&gt; subclasses = classifyType(t);
555             if (subclasses.isEmpty()) {
556                 return classes;
557             }
558 
559             for (int i = 0; i &lt; subclasses.size(); i++) {
560                 int pos = (int)(offset / 8);
561                 ArgumentClassImpl newClass = classes.get(i + pos).merge(subclasses.get(i));
562                 classes.set(i + pos, newClass);
563             }
</pre>
</td>
</tr>
</table>
<center><a href="../../aarch64/AArch64ABI.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="SysVx64ABI.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>