<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff doc/panama_jextract.md</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
<body>
<center><a href="panama_jextract.html.sdiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> next &gt;</center>    <h2>doc/panama_jextract.md</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
142 ```
143 
144 ### Java code that uses readline
145 
146 ```java
147 
148 import org.unix.Cstring;
149 import static org.unix.RuntimeHelper.*;
150 import static org.unix.readline_h.*;
151 
152 public class Readline {
153     public static void main(String[] args) {
154         try (var s = Cstring.toCString(&quot;name? &quot;)) {
155             var pstr = s.baseAddress();
156             // call &quot;readline&quot; API
157             var p = readline(pstr);
158 
159             // print char* as is
160             System.out.println(p);
161             // convert char* ptr from readline as Java String &amp; print it
<span class="line-modified">162             System.out.println(&quot;Hello, &quot; + Cstring.toJavaString(p));</span>
163         }
164     }
165 }
166 
167 ```
168 
169 ### Running the java code that uses readline
170 
171 ```
172 java -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \
173     -Djava.library.path=/usr/local/opt/readline/lib/ Readline.java
174 
175 ```
176 
177 ## Using libcurl from Java (Mac OS)
178 
179 ### jextract curl.h
180 
181 ```sh
182 
</pre>
<hr />
<pre>
592                 System.err.println(&quot;sqlite3_open failed: &quot; + rc);
593                 return;
594             } else {
595                 System.out.println(&quot;employee db opened&quot;);
596             }
597 
598             // sqlite3* dbPtr;
599             var dbPtr = Cpointer.get(dbPtrPtr);
600 
601             // create a new table
602             var sql = Cstring.toCString(
603                 &quot;CREATE TABLE EMPLOYEE (&quot;  +
604                 &quot;  ID INT PRIMARY KEY NOT NULL,&quot; +
605                 &quot;  NAME TEXT NOT NULL,&quot;    +
606                 &quot;  SALARY REAL NOT NULL )&quot;, scope);
607 
608             rc = sqlite3_exec(dbPtr, sql, NULL, NULL, errMsgPtrPtr);
609 
610             if (rc != 0) {
611                 System.err.println(&quot;sqlite3_exec failed: &quot; + rc);
<span class="line-modified">612                 System.err.println(&quot;SQL error: &quot; + Cstring.toJavaString(Cpointer.get(errMsgPtrPtr)));</span>
613                 sqlite3_free(Cpointer.get(errMsgPtrPtr));
614             } else {
615                 System.out.println(&quot;employee table created&quot;);
616             }
617 
618             // insert two rows
619             sql = Cstring.toCString(
620                 &quot;INSERT INTO EMPLOYEE (ID,NAME,SALARY) &quot; +
621                     &quot;VALUES (134, &#39;Xyz&#39;, 200000.0); &quot; +
622                 &quot;INSERT INTO EMPLOYEE (ID,NAME,SALARY) &quot; +
623                     &quot;VALUES (333, &#39;Abc&#39;, 100000.0);&quot;, scope
624             );
625             rc = sqlite3_exec(dbPtr, sql, NULL, NULL, errMsgPtrPtr);
626 
627             if (rc != 0) {
628                 System.err.println(&quot;sqlite3_exec failed: &quot; + rc);
<span class="line-modified">629                 System.err.println(&quot;SQL error: &quot; + Cstring.toJavaString(Cpointer.get(errMsgPtrPtr)));</span>
630                 sqlite3_free(Cpointer.get(errMsgPtrPtr));
631             } else {
632                 System.out.println(&quot;rows inserted&quot;);
633             }
634 
635             int[] rowNum = new int[1];
636             // callback to print rows from SELECT query
637             var callback = sqlite3_exec$callback.allocate((a, argc, argv, columnNames) -&gt; {
638                 System.out.println(&quot;Row num: &quot; + rowNum[0]++);
639                 System.out.println(&quot;numColumns = &quot; + argc);
<span class="line-modified">640                 argv = Cpointer.asArray(argv, argc);</span>
<span class="line-modified">641                 columnNames = Cpointer.asArray(columnNames, argc);</span>
642                 for (int i = 0; i &lt; argc; i++) {
<span class="line-modified">643                      String name = Cstring.toJavaString(Cpointer.get(columnNames, i));</span>
<span class="line-modified">644                      String value = Cstring.toJavaString(Cpointer.get(argv, i));</span>
645                      System.out.printf(&quot;%s = %s\n&quot;, name, value);
646                 }
647                 return 0;
648             }, scope);
649 
650             // select query
651             sql = Cstring.toCString(&quot;SELECT * FROM EMPLOYEE&quot;, scope);
652             rc = sqlite3_exec(dbPtr, sql, callback, NULL, errMsgPtrPtr);
653 
654             if (rc != 0) {
655                 System.err.println(&quot;sqlite3_exec failed: &quot; + rc);
<span class="line-modified">656                 System.err.println(&quot;SQL error: &quot; + Cstring.toJavaString(Cpointer.get(errMsgPtrPtr)));</span>
657                 sqlite3_free(Cpointer.get(errMsgPtrPtr));
658             } else {
659                 System.out.println(&quot;done&quot;);
660             }
661 
662             sqlite3_close(dbPtr);
663         }
664     }
665 }
666 ```
667 
668 ### Compiling and running the sqlite3 sample
669 
670 ```sh
671 
672 java -Dforeign.restricted=permit \
673    --add-modules jdk.incubator.foreign \
674    -Djava.library.path=/usr/lib SqliteMain.java
675 
676 ```
</pre>
</td>
<td>
<hr />
<pre>
142 ```
143 
144 ### Java code that uses readline
145 
146 ```java
147 
148 import org.unix.Cstring;
149 import static org.unix.RuntimeHelper.*;
150 import static org.unix.readline_h.*;
151 
152 public class Readline {
153     public static void main(String[] args) {
154         try (var s = Cstring.toCString(&quot;name? &quot;)) {
155             var pstr = s.baseAddress();
156             // call &quot;readline&quot; API
157             var p = readline(pstr);
158 
159             // print char* as is
160             System.out.println(p);
161             // convert char* ptr from readline as Java String &amp; print it
<span class="line-modified">162             System.out.println(&quot;Hello, &quot; + Cstring.toJavaStringRestricted(p));</span>
163         }
164     }
165 }
166 
167 ```
168 
169 ### Running the java code that uses readline
170 
171 ```
172 java -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \
173     -Djava.library.path=/usr/local/opt/readline/lib/ Readline.java
174 
175 ```
176 
177 ## Using libcurl from Java (Mac OS)
178 
179 ### jextract curl.h
180 
181 ```sh
182 
</pre>
<hr />
<pre>
592                 System.err.println(&quot;sqlite3_open failed: &quot; + rc);
593                 return;
594             } else {
595                 System.out.println(&quot;employee db opened&quot;);
596             }
597 
598             // sqlite3* dbPtr;
599             var dbPtr = Cpointer.get(dbPtrPtr);
600 
601             // create a new table
602             var sql = Cstring.toCString(
603                 &quot;CREATE TABLE EMPLOYEE (&quot;  +
604                 &quot;  ID INT PRIMARY KEY NOT NULL,&quot; +
605                 &quot;  NAME TEXT NOT NULL,&quot;    +
606                 &quot;  SALARY REAL NOT NULL )&quot;, scope);
607 
608             rc = sqlite3_exec(dbPtr, sql, NULL, NULL, errMsgPtrPtr);
609 
610             if (rc != 0) {
611                 System.err.println(&quot;sqlite3_exec failed: &quot; + rc);
<span class="line-modified">612                 System.err.println(&quot;SQL error: &quot; + Cstring.toJavaStringRestricted(Cpointer.get(errMsgPtrPtr)));</span>
613                 sqlite3_free(Cpointer.get(errMsgPtrPtr));
614             } else {
615                 System.out.println(&quot;employee table created&quot;);
616             }
617 
618             // insert two rows
619             sql = Cstring.toCString(
620                 &quot;INSERT INTO EMPLOYEE (ID,NAME,SALARY) &quot; +
621                     &quot;VALUES (134, &#39;Xyz&#39;, 200000.0); &quot; +
622                 &quot;INSERT INTO EMPLOYEE (ID,NAME,SALARY) &quot; +
623                     &quot;VALUES (333, &#39;Abc&#39;, 100000.0);&quot;, scope
624             );
625             rc = sqlite3_exec(dbPtr, sql, NULL, NULL, errMsgPtrPtr);
626 
627             if (rc != 0) {
628                 System.err.println(&quot;sqlite3_exec failed: &quot; + rc);
<span class="line-modified">629                 System.err.println(&quot;SQL error: &quot; + Cstring.toJavaStringRestricted(Cpointer.get(errMsgPtrPtr)));</span>
630                 sqlite3_free(Cpointer.get(errMsgPtrPtr));
631             } else {
632                 System.out.println(&quot;rows inserted&quot;);
633             }
634 
635             int[] rowNum = new int[1];
636             // callback to print rows from SELECT query
637             var callback = sqlite3_exec$callback.allocate((a, argc, argv, columnNames) -&gt; {
638                 System.out.println(&quot;Row num: &quot; + rowNum[0]++);
639                 System.out.println(&quot;numColumns = &quot; + argc);
<span class="line-modified">640                 argv = Cpointer.asArrayRestricted(argv, argc);</span>
<span class="line-modified">641                 columnNames = Cpointer.asArrayRestricted(columnNames, argc);</span>
642                 for (int i = 0; i &lt; argc; i++) {
<span class="line-modified">643                      String name = Cstring.toJavaStringRestricted(Cpointer.get(columnNames, i));</span>
<span class="line-modified">644                      String value = Cstring.toJavaStringRestricted(Cpointer.get(argv, i));</span>
645                      System.out.printf(&quot;%s = %s\n&quot;, name, value);
646                 }
647                 return 0;
648             }, scope);
649 
650             // select query
651             sql = Cstring.toCString(&quot;SELECT * FROM EMPLOYEE&quot;, scope);
652             rc = sqlite3_exec(dbPtr, sql, callback, NULL, errMsgPtrPtr);
653 
654             if (rc != 0) {
655                 System.err.println(&quot;sqlite3_exec failed: &quot; + rc);
<span class="line-modified">656                 System.err.println(&quot;SQL error: &quot; + Cstring.toJavaStringRestricted(Cpointer.get(errMsgPtrPtr)));</span>
657                 sqlite3_free(Cpointer.get(errMsgPtrPtr));
658             } else {
659                 System.out.println(&quot;done&quot;);
660             }
661 
662             sqlite3_close(dbPtr);
663         }
664     }
665 }
666 ```
667 
668 ### Compiling and running the sqlite3 sample
669 
670 ```sh
671 
672 java -Dforeign.restricted=permit \
673    --add-modules jdk.incubator.foreign \
674    -Djava.library.path=/usr/lib SqliteMain.java
675 
676 ```
</pre>
</td>
</tr>
</table>
<center><a href="panama_jextract.html.sdiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>