<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.incubator.foreign/share/classes/jdk/incubator/foreign/MemoryAccess.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../test/micro/org/openjdk/bench/jdk/incubator/foreign/LoopOverNonConstant.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.incubator.foreign/share/classes/jdk/incubator/foreign/MemoryAccess.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 package jdk.incubator.foreign;
   2 



   3 import java.lang.invoke.VarHandle;
   4 import java.nio.ByteOrder;
   5 
   6 /**
   7  * This class defines ready-made static accessors which can be used to dereference memory segments in many ways.
   8  * &lt;p&gt;
   9  * The most primitive accessors (see {@link #getIntAtOffset(MemoryAddress, long)} (MemoryAddress, long)}) take a &lt;em&gt;base&lt;/em&gt; address and an offset (expressed in bytes).
  10  * The final address at which the dereference will occur will be computed by offsetting the base address by
  11  * the specified offset, as if by calling {@link MemoryAddress#addOffset(long)} on the specified base address.
  12  * &lt;p&gt;
  13  * In cases where no offset is required, overloads are provided (see {@link #getInt(MemoryAddress)}) so that
  14  * clients can omit the offset coordinate.
  15  * &lt;p&gt;
  16  * To help dereferencing in array-like use cases (e.g. where the layout of a given memory segment is a sequence
  17  * layout of given size an element count), higher-level overloads are also provided (see {@link #getIntAtIndex(MemoryAddress, long)}),
  18  * which take an &lt;em&gt;base&lt;/em&gt; address and a &lt;em&gt;logical&lt;/em&gt; element index. The formula to obtain the byte offset {@code O} from an
  19  * index {@code I} is given by {@code O = I * S} where {@code S} is the size (expressed in bytes) of the element to
  20  * be dereferenced.
  21  */
  22 public final class MemoryAccess {
</pre>
<hr />
<pre>
1397      * @param addr base address.
1398      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1399      * @param value the byte value to be written.
1400      */
1401     public static void setByteAtIndex_LE(MemoryAddress addr, long index, byte value) {
1402         setByteAtOffset_LE(addr, index, value);
1403     }
1404 
1405     /**
1406      * Read a char from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1407      * &lt;p&gt;
1408      * This is equivalent to the following code:
1409      * &lt;blockquote&gt;&lt;pre&gt;{@code
1410     char value = getCharAtOffset_LE(addr, 2 * index);
1411      * }&lt;/pre&gt;&lt;/blockquote&gt;
1412      * @param addr base address.
1413      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1414      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1415      */
1416     public static char getCharAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1417         return getCharAtOffset_LE(addr, 2 * index);</span>
1418     }
1419 
1420     /**
1421      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1422      * &lt;p&gt;
1423      * This is equivalent to the following code:
1424      * &lt;blockquote&gt;&lt;pre&gt;{@code
1425     setCharAtOffset_LE(addr, 2 * index, value);
1426      * }&lt;/pre&gt;&lt;/blockquote&gt;
1427      * @param addr base address.
1428      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1429      * @param value the char value to be written.
1430      */
1431     public static void setCharAtIndex_LE(MemoryAddress addr, long index, char value) {
<span class="line-modified">1432         setCharAtOffset_LE(addr, 2 * index, value);</span>
1433     }
1434 
1435     /**
1436      * Read a short from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1437      * &lt;p&gt;
1438      * This is equivalent to the following code:
1439      * &lt;blockquote&gt;&lt;pre&gt;{@code
1440     short value = getShortAtOffset_LE(addr, 2 * index);
1441      * }&lt;/pre&gt;&lt;/blockquote&gt;
1442      * @param addr base address.
1443      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1444      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1445      */
1446     public static short getShortAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1447         return getShortAtOffset_LE(addr, 2 * index);</span>
1448     }
1449 
1450     /**
1451      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1452      * &lt;p&gt;
1453      * This is equivalent to the following code:
1454      * &lt;blockquote&gt;&lt;pre&gt;{@code
1455     setShortAtOffset_LE(addr, 2 * index, value);
1456      * }&lt;/pre&gt;&lt;/blockquote&gt;
1457      * @param addr base address.
1458      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1459      * @param value the short value to be written.
1460      */
1461     public static void setShortAtIndex_LE(MemoryAddress addr, long index, short value) {
<span class="line-modified">1462         setShortAtOffset_LE(addr, 2 * index, value);</span>
1463     }
1464 
1465     /**
1466      * Read an int from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1467      * &lt;p&gt;
1468      * This is equivalent to the following code:
1469      * &lt;blockquote&gt;&lt;pre&gt;{@code
1470     int value = getIntAtOffset_LE(addr, 4 * index);
1471      * }&lt;/pre&gt;&lt;/blockquote&gt;
1472      * @param addr base address.
1473      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1474      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1475      */
1476     public static int getIntAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1477         return getIntAtOffset_LE(addr, 4 * index);</span>
1478     }
1479 
1480     /**
1481      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1482      * &lt;p&gt;
1483      * This is equivalent to the following code:
1484      * &lt;blockquote&gt;&lt;pre&gt;{@code
1485     setIntAtOffset_LE(addr, 4 * index, value);
1486      * }&lt;/pre&gt;&lt;/blockquote&gt;
1487      * @param addr base address.
1488      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1489      * @param value the int value to be written.
1490      */
1491     public static void setIntAtIndex_LE(MemoryAddress addr, long index, int value) {
<span class="line-modified">1492         setIntAtOffset_LE(addr, 4 * index, value);</span>
1493     }
1494 
1495     /**
1496      * Read a float from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1497      * &lt;p&gt;
1498      * This is equivalent to the following code:
1499      * &lt;blockquote&gt;&lt;pre&gt;{@code
1500     float value = getFloatAtOffset_LE(addr, 4 * index);
1501      * }&lt;/pre&gt;&lt;/blockquote&gt;
1502      * @param addr base address.
1503      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1504      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1505      */
1506     public static float getFloatAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1507         return getFloatAtOffset_LE(addr, 4 * index);</span>
1508     }
1509 
1510     /**
1511      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1512      * &lt;p&gt;
1513      * This is equivalent to the following code:
1514      * &lt;blockquote&gt;&lt;pre&gt;{@code
1515     setFloatAtOffset_LE(addr, 4 * index, value);
1516      * }&lt;/pre&gt;&lt;/blockquote&gt;
1517      * @param addr base address.
1518      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1519      * @param value the float value to be written.
1520      */
1521     public static void setFloatAtIndex_LE(MemoryAddress addr, long index, float value) {
<span class="line-modified">1522         setFloatAtOffset_LE(addr, 4 * index, value);</span>
1523     }
1524 
1525     /**
1526      * Read a long from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1527      * &lt;p&gt;
1528      * This is equivalent to the following code:
1529      * &lt;blockquote&gt;&lt;pre&gt;{@code
1530     return getLongAtOffset_LE(addr, 8 * index);
1531      * }&lt;/pre&gt;&lt;/blockquote&gt;
1532      * @param addr base address.
1533      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1534      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1535      */
1536     public static long getLongAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1537         return getLongAtOffset_LE(addr, 8 * index);</span>
1538     }
1539 
1540     /**
1541      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1542      * &lt;p&gt;
1543      * This is equivalent to the following code:
1544      * &lt;blockquote&gt;&lt;pre&gt;{@code
1545     setLongAtOffset_LE(addr, 8 * index, value);
1546      * }&lt;/pre&gt;&lt;/blockquote&gt;
1547      * @param addr base address.
1548      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1549      * @param value the long value to be written.
1550      */
1551     public static void setLongAtIndex_LE(MemoryAddress addr, long index, long value) {
<span class="line-modified">1552         setLongAtOffset_LE(addr, 8 * index, value);</span>
1553     }
1554 
1555     /**
1556      * Read a double from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1557      * &lt;p&gt;
1558      * This is equivalent to the following code:
1559      * &lt;blockquote&gt;&lt;pre&gt;{@code
1560     return getDoubleAtOffset_LE(addr, 8 * index);
1561      * }&lt;/pre&gt;&lt;/blockquote&gt;
1562      * @param addr base address.
1563      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1564      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1565      */
1566     public static double getDoubleAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1567         return getDoubleAtOffset_LE(addr, 8 * index);</span>
1568     }
1569 
1570     /**
1571      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1572      * &lt;p&gt;
1573      * This is equivalent to the following code:
1574      * &lt;blockquote&gt;&lt;pre&gt;{@code
1575     setDoubleAtOffset_LE(addr, 8 * index, value);
1576      * }&lt;/pre&gt;&lt;/blockquote&gt;
1577      * @param addr base address.
1578      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1579      * @param value the double value to be written.
1580      */
1581     public static void setDoubleAtIndex_LE(MemoryAddress addr, long index, double value) {
<span class="line-modified">1582         setDoubleAtOffset_LE(addr, 8 * index, value);</span>
1583     }
1584 
1585     /**
1586      * Read a byte from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1587      * &lt;p&gt;
1588      * This is equivalent to the following code:
1589      * &lt;blockquote&gt;&lt;pre&gt;{@code
1590     byte value = getByteAtOffset_BE(addr, index);
1591      * }&lt;/pre&gt;&lt;/blockquote&gt;
1592      *
1593      * @param addr base address.
1594      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1595      * @return a byte value read from {@code addr} at the element index specified by {@code index}.
1596      */
1597     public static byte getByteAtIndex_BE(MemoryAddress addr, long index) {
1598         return getByteAtOffset_BE(addr, index);
1599     }
1600 
1601     /**
1602      * Writes a byte at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
</pre>
<hr />
<pre>
1608      * @param addr base address.
1609      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1610      * @param value the byte value to be written.
1611      */
1612     public static void setByteAtIndex_BE(MemoryAddress addr, long index, byte value) {
1613         setByteAtOffset_BE(addr, index, value);
1614     }
1615 
1616     /**
1617      * Read a char from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1618      * &lt;p&gt;
1619      * This is equivalent to the following code:
1620      * &lt;blockquote&gt;&lt;pre&gt;{@code
1621     char value = getCharAtOffset_BE(addr, 2 * index);
1622      * }&lt;/pre&gt;&lt;/blockquote&gt;
1623      * @param addr base address.
1624      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1625      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1626      */
1627     public static char getCharAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1628         return getCharAtOffset_BE(addr, 2 * index);</span>
1629     }
1630 
1631     /**
1632      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1633      * &lt;p&gt;
1634      * This is equivalent to the following code:
1635      * &lt;blockquote&gt;&lt;pre&gt;{@code
1636     setCharAtOffset_BE(addr, 2 * index, value);
1637      * }&lt;/pre&gt;&lt;/blockquote&gt;
1638      * @param addr base address.
1639      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1640      * @param value the char value to be written.
1641      */
1642     public static void setCharAtIndex_BE(MemoryAddress addr, long index, char value) {
<span class="line-modified">1643         setCharAtOffset_BE(addr, 2 * index, value);</span>
1644     }
1645 
1646     /**
1647      * Read a short from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1648      * &lt;p&gt;
1649      * This is equivalent to the following code:
1650      * &lt;blockquote&gt;&lt;pre&gt;{@code
1651     short value = getShortAtOffset_BE(addr, 2 * index);
1652      * }&lt;/pre&gt;&lt;/blockquote&gt;
1653      * @param addr base address.
1654      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1655      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1656      */
1657     public static short getShortAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1658         return getShortAtOffset_BE(addr, 2 * index);</span>
1659     }
1660 
1661     /**
1662      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1663      * &lt;p&gt;
1664      * This is equivalent to the following code:
1665      * &lt;blockquote&gt;&lt;pre&gt;{@code
1666     setShortAtOffset_BE(addr, 2 * index, value);
1667      * }&lt;/pre&gt;&lt;/blockquote&gt;
1668      * @param addr base address.
1669      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1670      * @param value the short value to be written.
1671      */
1672     public static void setShortAtIndex_BE(MemoryAddress addr, long index, short value) {
<span class="line-modified">1673         setShortAtOffset_BE(addr, 2 * index, value);</span>
1674     }
1675 
1676     /**
1677      * Read an int from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1678      * &lt;p&gt;
1679      * This is equivalent to the following code:
1680      * &lt;blockquote&gt;&lt;pre&gt;{@code
1681     int value = getIntAtOffset_BE(addr, 4 * index);
1682      * }&lt;/pre&gt;&lt;/blockquote&gt;
1683      * @param addr base address.
1684      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1685      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1686      */
1687     public static int getIntAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1688         return getIntAtOffset_BE(addr, 4 * index);</span>
1689     }
1690 
1691     /**
1692      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1693      * &lt;p&gt;
1694      * This is equivalent to the following code:
1695      * &lt;blockquote&gt;&lt;pre&gt;{@code
1696     setIntAtOffset_BE(addr, 4 * index, value);
1697      * }&lt;/pre&gt;&lt;/blockquote&gt;
1698      * @param addr base address.
1699      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1700      * @param value the int value to be written.
1701      */
1702     public static void setIntAtIndex_BE(MemoryAddress addr, long index, int value) {
<span class="line-modified">1703         setIntAtOffset_BE(addr, 4 * index, value);</span>
1704     }
1705 
1706     /**
1707      * Read a float from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1708      * &lt;p&gt;
1709      * This is equivalent to the following code:
1710      * &lt;blockquote&gt;&lt;pre&gt;{@code
1711     float value = getFloatAtOffset_BE(addr, 4 * index);
1712      * }&lt;/pre&gt;&lt;/blockquote&gt;
1713      * @param addr base address.
1714      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1715      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1716      */
1717     public static float getFloatAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1718         return getFloatAtOffset_BE(addr, 4 * index);</span>
1719     }
1720 
1721     /**
1722      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1723      * &lt;p&gt;
1724      * This is equivalent to the following code:
1725      * &lt;blockquote&gt;&lt;pre&gt;{@code
1726     setFloatAtOffset_BE(addr, 4 * index, value);
1727      * }&lt;/pre&gt;&lt;/blockquote&gt;
1728      * @param addr base address.
1729      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1730      * @param value the float value to be written.
1731      */
1732     public static void setFloatAtIndex_BE(MemoryAddress addr, long index, float value) {
<span class="line-modified">1733         setFloatAtOffset_BE(addr, 4 * index, value);</span>
1734     }
1735 
1736     /**
1737      * Read a long from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1738      * &lt;p&gt;
1739      * This is equivalent to the following code:
1740      * &lt;blockquote&gt;&lt;pre&gt;{@code
1741     return getLongAtOffset_BE(addr, 8 * index);
1742      * }&lt;/pre&gt;&lt;/blockquote&gt;
1743      * @param addr base address.
1744      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1745      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1746      */
1747     public static long getLongAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1748         return getLongAtOffset_BE(addr, 8 * index);</span>
1749     }
1750 
1751     /**
1752      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1753      * &lt;p&gt;
1754      * This is equivalent to the following code:
1755      * &lt;blockquote&gt;&lt;pre&gt;{@code
1756     setLongAtOffset_BE(addr, 8 * index, value);
1757      * }&lt;/pre&gt;&lt;/blockquote&gt;
1758      * @param addr base address.
1759      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1760      * @param value the long value to be written.
1761      */
1762     public static void setLongAtIndex_BE(MemoryAddress addr, long index, long value) {
<span class="line-modified">1763         setLongAtOffset_BE(addr, 8 * index, value);</span>
1764     }
1765 
1766     /**
1767      * Read a double from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1768      * &lt;p&gt;
1769      * This is equivalent to the following code:
1770      * &lt;blockquote&gt;&lt;pre&gt;{@code
1771     return getDoubleAtOffset_BE(addr, 8 * index);
1772      * }&lt;/pre&gt;&lt;/blockquote&gt;
1773      * @param addr base address.
1774      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1775      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1776      */
1777     public static double getDoubleAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1778         return getDoubleAtOffset_BE(addr, 8 * index);</span>
1779     }
1780 
1781     /**
1782      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1783      * &lt;p&gt;
1784      * This is equivalent to the following code:
1785      * &lt;blockquote&gt;&lt;pre&gt;{@code
1786     setDoubleAtOffset_BE(addr, 8 * index, value);
1787      * }&lt;/pre&gt;&lt;/blockquote&gt;
1788      * @param addr base address.
1789      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1790      * @param value the double value to be written.
1791      */
1792     public static void setDoubleAtIndex_BE(MemoryAddress addr, long index, double value) {
<span class="line-modified">1793         setDoubleAtOffset_BE(addr, 8 * index, value);</span>
1794     }
1795 
1796     /**
1797      * Read a byte from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1798      * &lt;p&gt;
1799      * This is equivalent to the following code:
1800      * &lt;blockquote&gt;&lt;pre&gt;{@code
1801     byte value = getByteAtOffset(addr, index);
1802      * }&lt;/pre&gt;&lt;/blockquote&gt;
1803      *
1804      * @param addr base address.
1805      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1806      * @return a byte value read from {@code addr} at the element index specified by {@code index}.
1807      */
1808     public static byte getByteAtIndex(MemoryAddress addr, long index) {
1809         return getByteAtOffset(addr, index);
1810     }
1811 
1812     /**
1813      * Writes a byte at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
</pre>
<hr />
<pre>
1819      * @param addr base address.
1820      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1821      * @param value the byte value to be written.
1822      */
1823     public static void setByteAtIndex(MemoryAddress addr, long index, byte value) {
1824         setByteAtOffset(addr, index, value);
1825     }
1826 
1827     /**
1828      * Read a char from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1829      * &lt;p&gt;
1830      * This is equivalent to the following code:
1831      * &lt;blockquote&gt;&lt;pre&gt;{@code
1832     char value = getCharAtOffset(addr, 2 * index);
1833      * }&lt;/pre&gt;&lt;/blockquote&gt;
1834      * @param addr base address.
1835      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1836      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1837      */
1838     public static char getCharAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1839         return getCharAtOffset(addr, 2 * index);</span>
1840     }
1841 
1842     /**
1843      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1844      * &lt;p&gt;
1845      * This is equivalent to the following code:
1846      * &lt;blockquote&gt;&lt;pre&gt;{@code
1847     setCharAtOffset(addr, 2 * index, value);
1848      * }&lt;/pre&gt;&lt;/blockquote&gt;
1849      * @param addr base address.
1850      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1851      * @param value the char value to be written.
1852      */
1853     public static void setCharAtIndex(MemoryAddress addr, long index, char value) {
<span class="line-modified">1854         setCharAtOffset(addr, 2 * index, value);</span>
1855     }
1856 
1857     /**
1858      * Read a short from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1859      * &lt;p&gt;
1860      * This is equivalent to the following code:
1861      * &lt;blockquote&gt;&lt;pre&gt;{@code
1862     short value = getShortAtOffset(addr, 2 * index);
1863      * }&lt;/pre&gt;&lt;/blockquote&gt;
1864      * @param addr base address.
1865      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1866      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1867      */
1868     public static short getShortAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1869         return getShortAtOffset(addr, 2 * index);</span>
1870     }
1871 
1872     /**
1873      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1874      * &lt;p&gt;
1875      * This is equivalent to the following code:
1876      * &lt;blockquote&gt;&lt;pre&gt;{@code
1877     setShortAtOffset(addr, 2 * index, value);
1878      * }&lt;/pre&gt;&lt;/blockquote&gt;
1879      * @param addr base address.
1880      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1881      * @param value the short value to be written.
1882      */
1883     public static void setShortAtIndex(MemoryAddress addr, long index, short value) {
<span class="line-modified">1884         setShortAtOffset(addr, 2 * index, value);</span>
1885     }
1886 
1887     /**
1888      * Read an int from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1889      * &lt;p&gt;
1890      * This is equivalent to the following code:
1891      * &lt;blockquote&gt;&lt;pre&gt;{@code
1892     int value = getIntAtOffset(addr, 4 * index);
1893      * }&lt;/pre&gt;&lt;/blockquote&gt;
1894      * @param addr base address.
1895      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1896      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1897      */
1898     public static int getIntAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1899         return getIntAtOffset(addr, 4 * index);</span>
1900     }
1901 
1902     /**
1903      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1904      * &lt;p&gt;
1905      * This is equivalent to the following code:
1906      * &lt;blockquote&gt;&lt;pre&gt;{@code
1907     setIntAtOffset(addr, 4 * index, value);
1908      * }&lt;/pre&gt;&lt;/blockquote&gt;
1909      * @param addr base address.
1910      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1911      * @param value the int value to be written.
1912      */
1913     public static void setIntAtIndex(MemoryAddress addr, long index, int value) {
<span class="line-modified">1914         setIntAtOffset(addr, 4 * index, value);</span>
1915     }
1916 
1917     /**
1918      * Read a float from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1919      * &lt;p&gt;
1920      * This is equivalent to the following code:
1921      * &lt;blockquote&gt;&lt;pre&gt;{@code
1922     float value = getFloatAtOffset(addr, 4 * index);
1923      * }&lt;/pre&gt;&lt;/blockquote&gt;
1924      * @param addr base address.
1925      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1926      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1927      */
1928     public static float getFloatAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1929         return getFloatAtOffset(addr, 4 * index);</span>
1930     }
1931 
1932     /**
1933      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1934      * &lt;p&gt;
1935      * This is equivalent to the following code:
1936      * &lt;blockquote&gt;&lt;pre&gt;{@code
1937     setFloatAtOffset(addr, 4 * index, value);
1938      * }&lt;/pre&gt;&lt;/blockquote&gt;
1939      * @param addr base address.
1940      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1941      * @param value the float value to be written.
1942      */
1943     public static void setFloatAtIndex(MemoryAddress addr, long index, float value) {
<span class="line-modified">1944         setFloatAtOffset(addr, 4 * index, value);</span>
1945     }
1946 
1947     /**
1948      * Read a long from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1949      * &lt;p&gt;
1950      * This is equivalent to the following code:
1951      * &lt;blockquote&gt;&lt;pre&gt;{@code
1952     return getLongAtOffset(addr, 8 * index);
1953      * }&lt;/pre&gt;&lt;/blockquote&gt;
1954      * @param addr base address.
1955      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1956      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1957      */
1958     public static long getLongAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1959         return getLongAtOffset(addr, 8 * index);</span>
1960     }
1961 
1962     /**
1963      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1964      * &lt;p&gt;
1965      * This is equivalent to the following code:
1966      * &lt;blockquote&gt;&lt;pre&gt;{@code
1967     setLongAtOffset(addr, 8 * index, value);
1968      * }&lt;/pre&gt;&lt;/blockquote&gt;
1969      * @param addr base address.
1970      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1971      * @param value the long value to be written.
1972      */
1973     public static void setLongAtIndex(MemoryAddress addr, long index, long value) {
<span class="line-modified">1974         setLongAtOffset(addr, 8 * index, value);</span>
1975     }
1976 
1977     /**
1978      * Read a double from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1979      * &lt;p&gt;
1980      * This is equivalent to the following code:
1981      * &lt;blockquote&gt;&lt;pre&gt;{@code
1982     return getDoubleAtOffset(addr, 8 * index);
1983      * }&lt;/pre&gt;&lt;/blockquote&gt;
1984      * @param addr base address.
1985      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1986      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1987      */
1988     public static double getDoubleAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1989         return getDoubleAtOffset(addr, 8 * index);</span>
1990     }
1991 
1992     /**
1993      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1994      * &lt;p&gt;
1995      * This is equivalent to the following code:
1996      * &lt;blockquote&gt;&lt;pre&gt;{@code
1997     setDoubleAtOffset(addr, 8 * index, value);
1998      * }&lt;/pre&gt;&lt;/blockquote&gt;
1999      * @param addr base address.
2000      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2001      * @param value the double value to be written.
2002      */
2003     public static void setDoubleAtIndex(MemoryAddress addr, long index, double value) {
<span class="line-modified">2004         setDoubleAtOffset(addr, 8 * index, value);</span>
2005     }
2006 
2007     /**
2008      * Read a memory address from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
2009      * &lt;p&gt;
2010      * This is equivalent to the following code:
2011      * &lt;blockquote&gt;&lt;pre&gt;{@code
2012     return getAddressAtOffset(addr, index * 8);
2013      * }&lt;/pre&gt;&lt;/blockquote&gt;
2014      * @param addr base address.
2015      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2016      * @return a memory address read from {@code addr} at the element index specified by {@code index}.
2017      */
2018     public static MemoryAddress getAddressAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">2019         return getAddressAtOffset(addr, index * 8);</span>
2020     }
2021 
2022     /**
2023      * Writes a memory address at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
2024      * &lt;p&gt;
2025      * This is equivalent to the following code:
2026      * &lt;blockquote&gt;&lt;pre&gt;{@code
2027     setAddressAtOffset(addr, index * 8, value);
2028      * }&lt;/pre&gt;&lt;/blockquote&gt;
2029      * @param addr base address.
2030      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2031      * @param value the memory address to be written.
2032      */
2033     public static void setAddressAtIndex(MemoryAddress addr, long index, MemoryAddress value) {
<span class="line-modified">2034         setAddressAtOffset(addr, index * 8, value);</span>





2035     }
2036 }
</pre>
</td>
<td>
<hr />
<pre>
   1 package jdk.incubator.foreign;
   2 
<span class="line-added">   3 import jdk.internal.access.foreign.MemoryAddressProxy;</span>
<span class="line-added">   4 import jdk.internal.vm.annotation.ForceInline;</span>
<span class="line-added">   5 </span>
   6 import java.lang.invoke.VarHandle;
   7 import java.nio.ByteOrder;
   8 
   9 /**
  10  * This class defines ready-made static accessors which can be used to dereference memory segments in many ways.
  11  * &lt;p&gt;
  12  * The most primitive accessors (see {@link #getIntAtOffset(MemoryAddress, long)} (MemoryAddress, long)}) take a &lt;em&gt;base&lt;/em&gt; address and an offset (expressed in bytes).
  13  * The final address at which the dereference will occur will be computed by offsetting the base address by
  14  * the specified offset, as if by calling {@link MemoryAddress#addOffset(long)} on the specified base address.
  15  * &lt;p&gt;
  16  * In cases where no offset is required, overloads are provided (see {@link #getInt(MemoryAddress)}) so that
  17  * clients can omit the offset coordinate.
  18  * &lt;p&gt;
  19  * To help dereferencing in array-like use cases (e.g. where the layout of a given memory segment is a sequence
  20  * layout of given size an element count), higher-level overloads are also provided (see {@link #getIntAtIndex(MemoryAddress, long)}),
  21  * which take an &lt;em&gt;base&lt;/em&gt; address and a &lt;em&gt;logical&lt;/em&gt; element index. The formula to obtain the byte offset {@code O} from an
  22  * index {@code I} is given by {@code O = I * S} where {@code S} is the size (expressed in bytes) of the element to
  23  * be dereferenced.
  24  */
  25 public final class MemoryAccess {
</pre>
<hr />
<pre>
1400      * @param addr base address.
1401      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1402      * @param value the byte value to be written.
1403      */
1404     public static void setByteAtIndex_LE(MemoryAddress addr, long index, byte value) {
1405         setByteAtOffset_LE(addr, index, value);
1406     }
1407 
1408     /**
1409      * Read a char from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1410      * &lt;p&gt;
1411      * This is equivalent to the following code:
1412      * &lt;blockquote&gt;&lt;pre&gt;{@code
1413     char value = getCharAtOffset_LE(addr, 2 * index);
1414      * }&lt;/pre&gt;&lt;/blockquote&gt;
1415      * @param addr base address.
1416      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1417      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1418      */
1419     public static char getCharAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1420         return getCharAtOffset_LE(addr, scale(addr, index, 2));</span>
1421     }
1422 
1423     /**
1424      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1425      * &lt;p&gt;
1426      * This is equivalent to the following code:
1427      * &lt;blockquote&gt;&lt;pre&gt;{@code
1428     setCharAtOffset_LE(addr, 2 * index, value);
1429      * }&lt;/pre&gt;&lt;/blockquote&gt;
1430      * @param addr base address.
1431      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1432      * @param value the char value to be written.
1433      */
1434     public static void setCharAtIndex_LE(MemoryAddress addr, long index, char value) {
<span class="line-modified">1435         setCharAtOffset_LE(addr, scale(addr, index, 2), value);</span>
1436     }
1437 
1438     /**
1439      * Read a short from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1440      * &lt;p&gt;
1441      * This is equivalent to the following code:
1442      * &lt;blockquote&gt;&lt;pre&gt;{@code
1443     short value = getShortAtOffset_LE(addr, 2 * index);
1444      * }&lt;/pre&gt;&lt;/blockquote&gt;
1445      * @param addr base address.
1446      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1447      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1448      */
1449     public static short getShortAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1450         return getShortAtOffset_LE(addr, scale(addr, index, 2));</span>
1451     }
1452 
1453     /**
1454      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1455      * &lt;p&gt;
1456      * This is equivalent to the following code:
1457      * &lt;blockquote&gt;&lt;pre&gt;{@code
1458     setShortAtOffset_LE(addr, 2 * index, value);
1459      * }&lt;/pre&gt;&lt;/blockquote&gt;
1460      * @param addr base address.
1461      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1462      * @param value the short value to be written.
1463      */
1464     public static void setShortAtIndex_LE(MemoryAddress addr, long index, short value) {
<span class="line-modified">1465         setShortAtOffset_LE(addr, scale(addr, index, 2), value);</span>
1466     }
1467 
1468     /**
1469      * Read an int from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1470      * &lt;p&gt;
1471      * This is equivalent to the following code:
1472      * &lt;blockquote&gt;&lt;pre&gt;{@code
1473     int value = getIntAtOffset_LE(addr, 4 * index);
1474      * }&lt;/pre&gt;&lt;/blockquote&gt;
1475      * @param addr base address.
1476      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1477      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1478      */
1479     public static int getIntAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1480         return getIntAtOffset_LE(addr, scale(addr, index, 4));</span>
1481     }
1482 
1483     /**
1484      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1485      * &lt;p&gt;
1486      * This is equivalent to the following code:
1487      * &lt;blockquote&gt;&lt;pre&gt;{@code
1488     setIntAtOffset_LE(addr, 4 * index, value);
1489      * }&lt;/pre&gt;&lt;/blockquote&gt;
1490      * @param addr base address.
1491      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1492      * @param value the int value to be written.
1493      */
1494     public static void setIntAtIndex_LE(MemoryAddress addr, long index, int value) {
<span class="line-modified">1495         setIntAtOffset_LE(addr, scale(addr, index, 4), value);</span>
1496     }
1497 
1498     /**
1499      * Read a float from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1500      * &lt;p&gt;
1501      * This is equivalent to the following code:
1502      * &lt;blockquote&gt;&lt;pre&gt;{@code
1503     float value = getFloatAtOffset_LE(addr, 4 * index);
1504      * }&lt;/pre&gt;&lt;/blockquote&gt;
1505      * @param addr base address.
1506      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1507      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1508      */
1509     public static float getFloatAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1510         return getFloatAtOffset_LE(addr, scale(addr, index, 4));</span>
1511     }
1512 
1513     /**
1514      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1515      * &lt;p&gt;
1516      * This is equivalent to the following code:
1517      * &lt;blockquote&gt;&lt;pre&gt;{@code
1518     setFloatAtOffset_LE(addr, 4 * index, value);
1519      * }&lt;/pre&gt;&lt;/blockquote&gt;
1520      * @param addr base address.
1521      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1522      * @param value the float value to be written.
1523      */
1524     public static void setFloatAtIndex_LE(MemoryAddress addr, long index, float value) {
<span class="line-modified">1525         setFloatAtOffset_LE(addr, scale(addr, index, 4), value);</span>
1526     }
1527 
1528     /**
1529      * Read a long from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1530      * &lt;p&gt;
1531      * This is equivalent to the following code:
1532      * &lt;blockquote&gt;&lt;pre&gt;{@code
1533     return getLongAtOffset_LE(addr, 8 * index);
1534      * }&lt;/pre&gt;&lt;/blockquote&gt;
1535      * @param addr base address.
1536      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1537      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1538      */
1539     public static long getLongAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1540         return getLongAtOffset_LE(addr, scale(addr, index, 8));</span>
1541     }
1542 
1543     /**
1544      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1545      * &lt;p&gt;
1546      * This is equivalent to the following code:
1547      * &lt;blockquote&gt;&lt;pre&gt;{@code
1548     setLongAtOffset_LE(addr, 8 * index, value);
1549      * }&lt;/pre&gt;&lt;/blockquote&gt;
1550      * @param addr base address.
1551      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1552      * @param value the long value to be written.
1553      */
1554     public static void setLongAtIndex_LE(MemoryAddress addr, long index, long value) {
<span class="line-modified">1555         setLongAtOffset_LE(addr, scale(addr, index, 8), value);</span>
1556     }
1557 
1558     /**
1559      * Read a double from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1560      * &lt;p&gt;
1561      * This is equivalent to the following code:
1562      * &lt;blockquote&gt;&lt;pre&gt;{@code
1563     return getDoubleAtOffset_LE(addr, 8 * index);
1564      * }&lt;/pre&gt;&lt;/blockquote&gt;
1565      * @param addr base address.
1566      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1567      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1568      */
1569     public static double getDoubleAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1570         return getDoubleAtOffset_LE(addr, scale(addr, index, 8));</span>
1571     }
1572 
1573     /**
1574      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1575      * &lt;p&gt;
1576      * This is equivalent to the following code:
1577      * &lt;blockquote&gt;&lt;pre&gt;{@code
1578     setDoubleAtOffset_LE(addr, 8 * index, value);
1579      * }&lt;/pre&gt;&lt;/blockquote&gt;
1580      * @param addr base address.
1581      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1582      * @param value the double value to be written.
1583      */
1584     public static void setDoubleAtIndex_LE(MemoryAddress addr, long index, double value) {
<span class="line-modified">1585         setDoubleAtOffset_LE(addr, scale(addr, index, 8), value);</span>
1586     }
1587 
1588     /**
1589      * Read a byte from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1590      * &lt;p&gt;
1591      * This is equivalent to the following code:
1592      * &lt;blockquote&gt;&lt;pre&gt;{@code
1593     byte value = getByteAtOffset_BE(addr, index);
1594      * }&lt;/pre&gt;&lt;/blockquote&gt;
1595      *
1596      * @param addr base address.
1597      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1598      * @return a byte value read from {@code addr} at the element index specified by {@code index}.
1599      */
1600     public static byte getByteAtIndex_BE(MemoryAddress addr, long index) {
1601         return getByteAtOffset_BE(addr, index);
1602     }
1603 
1604     /**
1605      * Writes a byte at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
</pre>
<hr />
<pre>
1611      * @param addr base address.
1612      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1613      * @param value the byte value to be written.
1614      */
1615     public static void setByteAtIndex_BE(MemoryAddress addr, long index, byte value) {
1616         setByteAtOffset_BE(addr, index, value);
1617     }
1618 
1619     /**
1620      * Read a char from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1621      * &lt;p&gt;
1622      * This is equivalent to the following code:
1623      * &lt;blockquote&gt;&lt;pre&gt;{@code
1624     char value = getCharAtOffset_BE(addr, 2 * index);
1625      * }&lt;/pre&gt;&lt;/blockquote&gt;
1626      * @param addr base address.
1627      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1628      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1629      */
1630     public static char getCharAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1631         return getCharAtOffset_BE(addr, scale(addr, index, 2));</span>
1632     }
1633 
1634     /**
1635      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1636      * &lt;p&gt;
1637      * This is equivalent to the following code:
1638      * &lt;blockquote&gt;&lt;pre&gt;{@code
1639     setCharAtOffset_BE(addr, 2 * index, value);
1640      * }&lt;/pre&gt;&lt;/blockquote&gt;
1641      * @param addr base address.
1642      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1643      * @param value the char value to be written.
1644      */
1645     public static void setCharAtIndex_BE(MemoryAddress addr, long index, char value) {
<span class="line-modified">1646         setCharAtOffset_BE(addr, scale(addr, index, 2), value);</span>
1647     }
1648 
1649     /**
1650      * Read a short from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1651      * &lt;p&gt;
1652      * This is equivalent to the following code:
1653      * &lt;blockquote&gt;&lt;pre&gt;{@code
1654     short value = getShortAtOffset_BE(addr, 2 * index);
1655      * }&lt;/pre&gt;&lt;/blockquote&gt;
1656      * @param addr base address.
1657      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1658      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1659      */
1660     public static short getShortAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1661         return getShortAtOffset_BE(addr, scale(addr, index, 2));</span>
1662     }
1663 
1664     /**
1665      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1666      * &lt;p&gt;
1667      * This is equivalent to the following code:
1668      * &lt;blockquote&gt;&lt;pre&gt;{@code
1669     setShortAtOffset_BE(addr, 2 * index, value);
1670      * }&lt;/pre&gt;&lt;/blockquote&gt;
1671      * @param addr base address.
1672      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1673      * @param value the short value to be written.
1674      */
1675     public static void setShortAtIndex_BE(MemoryAddress addr, long index, short value) {
<span class="line-modified">1676         setShortAtOffset_BE(addr, scale(addr, index, 2), value);</span>
1677     }
1678 
1679     /**
1680      * Read an int from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1681      * &lt;p&gt;
1682      * This is equivalent to the following code:
1683      * &lt;blockquote&gt;&lt;pre&gt;{@code
1684     int value = getIntAtOffset_BE(addr, 4 * index);
1685      * }&lt;/pre&gt;&lt;/blockquote&gt;
1686      * @param addr base address.
1687      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1688      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1689      */
1690     public static int getIntAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1691         return getIntAtOffset_BE(addr, scale(addr, index, 4));</span>
1692     }
1693 
1694     /**
1695      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1696      * &lt;p&gt;
1697      * This is equivalent to the following code:
1698      * &lt;blockquote&gt;&lt;pre&gt;{@code
1699     setIntAtOffset_BE(addr, 4 * index, value);
1700      * }&lt;/pre&gt;&lt;/blockquote&gt;
1701      * @param addr base address.
1702      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1703      * @param value the int value to be written.
1704      */
1705     public static void setIntAtIndex_BE(MemoryAddress addr, long index, int value) {
<span class="line-modified">1706         setIntAtOffset_BE(addr, scale(addr, index, 4), value);</span>
1707     }
1708 
1709     /**
1710      * Read a float from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1711      * &lt;p&gt;
1712      * This is equivalent to the following code:
1713      * &lt;blockquote&gt;&lt;pre&gt;{@code
1714     float value = getFloatAtOffset_BE(addr, 4 * index);
1715      * }&lt;/pre&gt;&lt;/blockquote&gt;
1716      * @param addr base address.
1717      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1718      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1719      */
1720     public static float getFloatAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1721         return getFloatAtOffset_BE(addr, scale(addr, index, 4));</span>
1722     }
1723 
1724     /**
1725      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1726      * &lt;p&gt;
1727      * This is equivalent to the following code:
1728      * &lt;blockquote&gt;&lt;pre&gt;{@code
1729     setFloatAtOffset_BE(addr, 4 * index, value);
1730      * }&lt;/pre&gt;&lt;/blockquote&gt;
1731      * @param addr base address.
1732      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1733      * @param value the float value to be written.
1734      */
1735     public static void setFloatAtIndex_BE(MemoryAddress addr, long index, float value) {
<span class="line-modified">1736         setFloatAtOffset_BE(addr, scale(addr, index, 4), value);</span>
1737     }
1738 
1739     /**
1740      * Read a long from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1741      * &lt;p&gt;
1742      * This is equivalent to the following code:
1743      * &lt;blockquote&gt;&lt;pre&gt;{@code
1744     return getLongAtOffset_BE(addr, 8 * index);
1745      * }&lt;/pre&gt;&lt;/blockquote&gt;
1746      * @param addr base address.
1747      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1748      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1749      */
1750     public static long getLongAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1751         return getLongAtOffset_BE(addr, scale(addr, index, 8));</span>
1752     }
1753 
1754     /**
1755      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1756      * &lt;p&gt;
1757      * This is equivalent to the following code:
1758      * &lt;blockquote&gt;&lt;pre&gt;{@code
1759     setLongAtOffset_BE(addr, 8 * index, value);
1760      * }&lt;/pre&gt;&lt;/blockquote&gt;
1761      * @param addr base address.
1762      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1763      * @param value the long value to be written.
1764      */
1765     public static void setLongAtIndex_BE(MemoryAddress addr, long index, long value) {
<span class="line-modified">1766         setLongAtOffset_BE(addr, scale(addr, index, 8), value);</span>
1767     }
1768 
1769     /**
1770      * Read a double from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1771      * &lt;p&gt;
1772      * This is equivalent to the following code:
1773      * &lt;blockquote&gt;&lt;pre&gt;{@code
1774     return getDoubleAtOffset_BE(addr, 8 * index);
1775      * }&lt;/pre&gt;&lt;/blockquote&gt;
1776      * @param addr base address.
1777      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1778      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1779      */
1780     public static double getDoubleAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1781         return getDoubleAtOffset_BE(addr, scale(addr, index, 8));</span>
1782     }
1783 
1784     /**
1785      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1786      * &lt;p&gt;
1787      * This is equivalent to the following code:
1788      * &lt;blockquote&gt;&lt;pre&gt;{@code
1789     setDoubleAtOffset_BE(addr, 8 * index, value);
1790      * }&lt;/pre&gt;&lt;/blockquote&gt;
1791      * @param addr base address.
1792      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1793      * @param value the double value to be written.
1794      */
1795     public static void setDoubleAtIndex_BE(MemoryAddress addr, long index, double value) {
<span class="line-modified">1796         setDoubleAtOffset_BE(addr, scale(addr, index, 8), value);</span>
1797     }
1798 
1799     /**
1800      * Read a byte from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1801      * &lt;p&gt;
1802      * This is equivalent to the following code:
1803      * &lt;blockquote&gt;&lt;pre&gt;{@code
1804     byte value = getByteAtOffset(addr, index);
1805      * }&lt;/pre&gt;&lt;/blockquote&gt;
1806      *
1807      * @param addr base address.
1808      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1809      * @return a byte value read from {@code addr} at the element index specified by {@code index}.
1810      */
1811     public static byte getByteAtIndex(MemoryAddress addr, long index) {
1812         return getByteAtOffset(addr, index);
1813     }
1814 
1815     /**
1816      * Writes a byte at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
</pre>
<hr />
<pre>
1822      * @param addr base address.
1823      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1824      * @param value the byte value to be written.
1825      */
1826     public static void setByteAtIndex(MemoryAddress addr, long index, byte value) {
1827         setByteAtOffset(addr, index, value);
1828     }
1829 
1830     /**
1831      * Read a char from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1832      * &lt;p&gt;
1833      * This is equivalent to the following code:
1834      * &lt;blockquote&gt;&lt;pre&gt;{@code
1835     char value = getCharAtOffset(addr, 2 * index);
1836      * }&lt;/pre&gt;&lt;/blockquote&gt;
1837      * @param addr base address.
1838      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1839      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1840      */
1841     public static char getCharAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1842         return getCharAtOffset(addr, scale(addr, index, 2));</span>
1843     }
1844 
1845     /**
1846      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1847      * &lt;p&gt;
1848      * This is equivalent to the following code:
1849      * &lt;blockquote&gt;&lt;pre&gt;{@code
1850     setCharAtOffset(addr, 2 * index, value);
1851      * }&lt;/pre&gt;&lt;/blockquote&gt;
1852      * @param addr base address.
1853      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1854      * @param value the char value to be written.
1855      */
1856     public static void setCharAtIndex(MemoryAddress addr, long index, char value) {
<span class="line-modified">1857         setCharAtOffset(addr, scale(addr, index, 2), value);</span>
1858     }
1859 
1860     /**
1861      * Read a short from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1862      * &lt;p&gt;
1863      * This is equivalent to the following code:
1864      * &lt;blockquote&gt;&lt;pre&gt;{@code
1865     short value = getShortAtOffset(addr, 2 * index);
1866      * }&lt;/pre&gt;&lt;/blockquote&gt;
1867      * @param addr base address.
1868      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1869      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1870      */
1871     public static short getShortAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1872         return getShortAtOffset(addr, scale(addr, index, 2));</span>
1873     }
1874 
1875     /**
1876      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1877      * &lt;p&gt;
1878      * This is equivalent to the following code:
1879      * &lt;blockquote&gt;&lt;pre&gt;{@code
1880     setShortAtOffset(addr, 2 * index, value);
1881      * }&lt;/pre&gt;&lt;/blockquote&gt;
1882      * @param addr base address.
1883      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1884      * @param value the short value to be written.
1885      */
1886     public static void setShortAtIndex(MemoryAddress addr, long index, short value) {
<span class="line-modified">1887         setShortAtOffset(addr, scale(addr, index, 2), value);</span>
1888     }
1889 
1890     /**
1891      * Read an int from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1892      * &lt;p&gt;
1893      * This is equivalent to the following code:
1894      * &lt;blockquote&gt;&lt;pre&gt;{@code
1895     int value = getIntAtOffset(addr, 4 * index);
1896      * }&lt;/pre&gt;&lt;/blockquote&gt;
1897      * @param addr base address.
1898      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1899      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1900      */
1901     public static int getIntAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1902         return getIntAtOffset(addr, scale(addr, index, 4));</span>
1903     }
1904 
1905     /**
1906      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1907      * &lt;p&gt;
1908      * This is equivalent to the following code:
1909      * &lt;blockquote&gt;&lt;pre&gt;{@code
1910     setIntAtOffset(addr, 4 * index, value);
1911      * }&lt;/pre&gt;&lt;/blockquote&gt;
1912      * @param addr base address.
1913      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1914      * @param value the int value to be written.
1915      */
1916     public static void setIntAtIndex(MemoryAddress addr, long index, int value) {
<span class="line-modified">1917         setIntAtOffset(addr, scale(addr, index, 4), value);</span>
1918     }
1919 
1920     /**
1921      * Read a float from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1922      * &lt;p&gt;
1923      * This is equivalent to the following code:
1924      * &lt;blockquote&gt;&lt;pre&gt;{@code
1925     float value = getFloatAtOffset(addr, 4 * index);
1926      * }&lt;/pre&gt;&lt;/blockquote&gt;
1927      * @param addr base address.
1928      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1929      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1930      */
1931     public static float getFloatAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1932         return getFloatAtOffset(addr, scale(addr, index, 4));</span>
1933     }
1934 
1935     /**
1936      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1937      * &lt;p&gt;
1938      * This is equivalent to the following code:
1939      * &lt;blockquote&gt;&lt;pre&gt;{@code
1940     setFloatAtOffset(addr, 4 * index, value);
1941      * }&lt;/pre&gt;&lt;/blockquote&gt;
1942      * @param addr base address.
1943      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1944      * @param value the float value to be written.
1945      */
1946     public static void setFloatAtIndex(MemoryAddress addr, long index, float value) {
<span class="line-modified">1947         setFloatAtOffset(addr, scale(addr, index, 4), value);</span>
1948     }
1949 
1950     /**
1951      * Read a long from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1952      * &lt;p&gt;
1953      * This is equivalent to the following code:
1954      * &lt;blockquote&gt;&lt;pre&gt;{@code
1955     return getLongAtOffset(addr, 8 * index);
1956      * }&lt;/pre&gt;&lt;/blockquote&gt;
1957      * @param addr base address.
1958      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1959      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1960      */
1961     public static long getLongAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1962         return getLongAtOffset(addr, scale(addr, index, 8));</span>
1963     }
1964 
1965     /**
1966      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1967      * &lt;p&gt;
1968      * This is equivalent to the following code:
1969      * &lt;blockquote&gt;&lt;pre&gt;{@code
1970     setLongAtOffset(addr, 8 * index, value);
1971      * }&lt;/pre&gt;&lt;/blockquote&gt;
1972      * @param addr base address.
1973      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1974      * @param value the long value to be written.
1975      */
1976     public static void setLongAtIndex(MemoryAddress addr, long index, long value) {
<span class="line-modified">1977         setLongAtOffset(addr, scale(addr, index, 8), value);</span>
1978     }
1979 
1980     /**
1981      * Read a double from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1982      * &lt;p&gt;
1983      * This is equivalent to the following code:
1984      * &lt;blockquote&gt;&lt;pre&gt;{@code
1985     return getDoubleAtOffset(addr, 8 * index);
1986      * }&lt;/pre&gt;&lt;/blockquote&gt;
1987      * @param addr base address.
1988      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1989      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1990      */
1991     public static double getDoubleAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1992         return getDoubleAtOffset(addr, scale(addr, index, 8));</span>
1993     }
1994 
1995     /**
1996      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1997      * &lt;p&gt;
1998      * This is equivalent to the following code:
1999      * &lt;blockquote&gt;&lt;pre&gt;{@code
2000     setDoubleAtOffset(addr, 8 * index, value);
2001      * }&lt;/pre&gt;&lt;/blockquote&gt;
2002      * @param addr base address.
2003      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2004      * @param value the double value to be written.
2005      */
2006     public static void setDoubleAtIndex(MemoryAddress addr, long index, double value) {
<span class="line-modified">2007         setDoubleAtOffset(addr, scale(addr, index, 8), value);</span>
2008     }
2009 
2010     /**
2011      * Read a memory address from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
2012      * &lt;p&gt;
2013      * This is equivalent to the following code:
2014      * &lt;blockquote&gt;&lt;pre&gt;{@code
2015     return getAddressAtOffset(addr, index * 8);
2016      * }&lt;/pre&gt;&lt;/blockquote&gt;
2017      * @param addr base address.
2018      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2019      * @return a memory address read from {@code addr} at the element index specified by {@code index}.
2020      */
2021     public static MemoryAddress getAddressAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">2022         return getAddressAtOffset(addr, scale(addr, index, 8));</span>
2023     }
2024 
2025     /**
2026      * Writes a memory address at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
2027      * &lt;p&gt;
2028      * This is equivalent to the following code:
2029      * &lt;blockquote&gt;&lt;pre&gt;{@code
2030     setAddressAtOffset(addr, index * 8, value);
2031      * }&lt;/pre&gt;&lt;/blockquote&gt;
2032      * @param addr base address.
2033      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2034      * @param value the memory address to be written.
2035      */
2036     public static void setAddressAtIndex(MemoryAddress addr, long index, MemoryAddress value) {
<span class="line-modified">2037         setAddressAtOffset(addr, scale(addr, index, 8), value);</span>
<span class="line-added">2038     }</span>
<span class="line-added">2039 </span>
<span class="line-added">2040     @ForceInline</span>
<span class="line-added">2041     private static long scale(MemoryAddress address, long index, int size) {</span>
<span class="line-added">2042         return MemoryAddressProxy.multiplyOffsets(index, size, (MemoryAddressProxy)address);</span>
2043     }
2044 }
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../test/micro/org/openjdk/bench/jdk/incubator/foreign/LoopOverNonConstant.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>