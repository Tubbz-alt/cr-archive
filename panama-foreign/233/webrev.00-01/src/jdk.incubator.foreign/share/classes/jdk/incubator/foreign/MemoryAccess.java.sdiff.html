<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.incubator.foreign/share/classes/jdk/incubator/foreign/MemoryAccess.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>src/jdk.incubator.foreign/share/classes/jdk/incubator/foreign/MemoryAccess.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 package jdk.incubator.foreign;
   2 

   3 import jdk.internal.vm.annotation.ForceInline;
   4 
   5 import java.lang.invoke.VarHandle;
   6 import java.nio.ByteOrder;
   7 
   8 /**
   9  * This class defines ready-made static accessors which can be used to dereference memory segments in many ways.
  10  * &lt;p&gt;
  11  * The most primitive accessors (see {@link #getIntAtOffset(MemoryAddress, long)} (MemoryAddress, long)}) take a &lt;em&gt;base&lt;/em&gt; address and an offset (expressed in bytes).
  12  * The final address at which the dereference will occur will be computed by offsetting the base address by
  13  * the specified offset, as if by calling {@link MemoryAddress#addOffset(long)} on the specified base address.
  14  * &lt;p&gt;
  15  * In cases where no offset is required, overloads are provided (see {@link #getInt(MemoryAddress)}) so that
  16  * clients can omit the offset coordinate.
  17  * &lt;p&gt;
  18  * To help dereferencing in array-like use cases (e.g. where the layout of a given memory segment is a sequence
  19  * layout of given size an element count), higher-level overloads are also provided (see {@link #getIntAtIndex(MemoryAddress, long)}),
  20  * which take an &lt;em&gt;base&lt;/em&gt; address and a &lt;em&gt;logical&lt;/em&gt; element index. The formula to obtain the byte offset {@code O} from an
  21  * index {@code I} is given by {@code O = I * S} where {@code S} is the size (expressed in bytes) of the element to
  22  * be dereferenced.
</pre>
<hr />
<pre>
1399      * @param addr base address.
1400      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1401      * @param value the byte value to be written.
1402      */
1403     public static void setByteAtIndex_LE(MemoryAddress addr, long index, byte value) {
1404         setByteAtOffset_LE(addr, index, value);
1405     }
1406 
1407     /**
1408      * Read a char from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1409      * &lt;p&gt;
1410      * This is equivalent to the following code:
1411      * &lt;blockquote&gt;&lt;pre&gt;{@code
1412     char value = getCharAtOffset_LE(addr, 2 * index);
1413      * }&lt;/pre&gt;&lt;/blockquote&gt;
1414      * @param addr base address.
1415      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1416      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1417      */
1418     public static char getCharAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1419         return getCharAtOffset_LE(addr, scale(index, 2));</span>
1420     }
1421 
1422     /**
1423      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1424      * &lt;p&gt;
1425      * This is equivalent to the following code:
1426      * &lt;blockquote&gt;&lt;pre&gt;{@code
1427     setCharAtOffset_LE(addr, 2 * index, value);
1428      * }&lt;/pre&gt;&lt;/blockquote&gt;
1429      * @param addr base address.
1430      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1431      * @param value the char value to be written.
1432      */
1433     public static void setCharAtIndex_LE(MemoryAddress addr, long index, char value) {
<span class="line-modified">1434         setCharAtOffset_LE(addr, scale(index, 2), value);</span>
1435     }
1436 
1437     /**
1438      * Read a short from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1439      * &lt;p&gt;
1440      * This is equivalent to the following code:
1441      * &lt;blockquote&gt;&lt;pre&gt;{@code
1442     short value = getShortAtOffset_LE(addr, 2 * index);
1443      * }&lt;/pre&gt;&lt;/blockquote&gt;
1444      * @param addr base address.
1445      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1446      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1447      */
1448     public static short getShortAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1449         return getShortAtOffset_LE(addr, scale(index, 2));</span>
1450     }
1451 
1452     /**
1453      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1454      * &lt;p&gt;
1455      * This is equivalent to the following code:
1456      * &lt;blockquote&gt;&lt;pre&gt;{@code
1457     setShortAtOffset_LE(addr, 2 * index, value);
1458      * }&lt;/pre&gt;&lt;/blockquote&gt;
1459      * @param addr base address.
1460      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1461      * @param value the short value to be written.
1462      */
1463     public static void setShortAtIndex_LE(MemoryAddress addr, long index, short value) {
<span class="line-modified">1464         setShortAtOffset_LE(addr, scale(index, 2), value);</span>
1465     }
1466 
1467     /**
1468      * Read an int from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1469      * &lt;p&gt;
1470      * This is equivalent to the following code:
1471      * &lt;blockquote&gt;&lt;pre&gt;{@code
1472     int value = getIntAtOffset_LE(addr, 4 * index);
1473      * }&lt;/pre&gt;&lt;/blockquote&gt;
1474      * @param addr base address.
1475      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1476      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1477      */
1478     public static int getIntAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1479         return getIntAtOffset_LE(addr, scale(index, 4));</span>
1480     }
1481 
1482     /**
1483      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1484      * &lt;p&gt;
1485      * This is equivalent to the following code:
1486      * &lt;blockquote&gt;&lt;pre&gt;{@code
1487     setIntAtOffset_LE(addr, 4 * index, value);
1488      * }&lt;/pre&gt;&lt;/blockquote&gt;
1489      * @param addr base address.
1490      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1491      * @param value the int value to be written.
1492      */
1493     public static void setIntAtIndex_LE(MemoryAddress addr, long index, int value) {
<span class="line-modified">1494         setIntAtOffset_LE(addr, scale(index, 4), value);</span>
1495     }
1496 
1497     /**
1498      * Read a float from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1499      * &lt;p&gt;
1500      * This is equivalent to the following code:
1501      * &lt;blockquote&gt;&lt;pre&gt;{@code
1502     float value = getFloatAtOffset_LE(addr, 4 * index);
1503      * }&lt;/pre&gt;&lt;/blockquote&gt;
1504      * @param addr base address.
1505      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1506      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1507      */
1508     public static float getFloatAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1509         return getFloatAtOffset_LE(addr, scale(index, 4));</span>
1510     }
1511 
1512     /**
1513      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1514      * &lt;p&gt;
1515      * This is equivalent to the following code:
1516      * &lt;blockquote&gt;&lt;pre&gt;{@code
1517     setFloatAtOffset_LE(addr, 4 * index, value);
1518      * }&lt;/pre&gt;&lt;/blockquote&gt;
1519      * @param addr base address.
1520      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1521      * @param value the float value to be written.
1522      */
1523     public static void setFloatAtIndex_LE(MemoryAddress addr, long index, float value) {
<span class="line-modified">1524         setFloatAtOffset_LE(addr, scale(index, 4), value);</span>
1525     }
1526 
1527     /**
1528      * Read a long from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1529      * &lt;p&gt;
1530      * This is equivalent to the following code:
1531      * &lt;blockquote&gt;&lt;pre&gt;{@code
1532     return getLongAtOffset_LE(addr, 8 * index);
1533      * }&lt;/pre&gt;&lt;/blockquote&gt;
1534      * @param addr base address.
1535      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1536      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1537      */
1538     public static long getLongAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1539         return getLongAtOffset_LE(addr, scale(index, 8));</span>
1540     }
1541 
1542     /**
1543      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1544      * &lt;p&gt;
1545      * This is equivalent to the following code:
1546      * &lt;blockquote&gt;&lt;pre&gt;{@code
1547     setLongAtOffset_LE(addr, 8 * index, value);
1548      * }&lt;/pre&gt;&lt;/blockquote&gt;
1549      * @param addr base address.
1550      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1551      * @param value the long value to be written.
1552      */
1553     public static void setLongAtIndex_LE(MemoryAddress addr, long index, long value) {
<span class="line-modified">1554         setLongAtOffset_LE(addr, scale(index, 8), value);</span>
1555     }
1556 
1557     /**
1558      * Read a double from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1559      * &lt;p&gt;
1560      * This is equivalent to the following code:
1561      * &lt;blockquote&gt;&lt;pre&gt;{@code
1562     return getDoubleAtOffset_LE(addr, 8 * index);
1563      * }&lt;/pre&gt;&lt;/blockquote&gt;
1564      * @param addr base address.
1565      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1566      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1567      */
1568     public static double getDoubleAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1569         return getDoubleAtOffset_LE(addr, scale(index, 8));</span>
1570     }
1571 
1572     /**
1573      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1574      * &lt;p&gt;
1575      * This is equivalent to the following code:
1576      * &lt;blockquote&gt;&lt;pre&gt;{@code
1577     setDoubleAtOffset_LE(addr, 8 * index, value);
1578      * }&lt;/pre&gt;&lt;/blockquote&gt;
1579      * @param addr base address.
1580      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1581      * @param value the double value to be written.
1582      */
1583     public static void setDoubleAtIndex_LE(MemoryAddress addr, long index, double value) {
<span class="line-modified">1584         setDoubleAtOffset_LE(addr, scale(index, 8), value);</span>
1585     }
1586 
1587     /**
1588      * Read a byte from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1589      * &lt;p&gt;
1590      * This is equivalent to the following code:
1591      * &lt;blockquote&gt;&lt;pre&gt;{@code
1592     byte value = getByteAtOffset_BE(addr, index);
1593      * }&lt;/pre&gt;&lt;/blockquote&gt;
1594      *
1595      * @param addr base address.
1596      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1597      * @return a byte value read from {@code addr} at the element index specified by {@code index}.
1598      */
1599     public static byte getByteAtIndex_BE(MemoryAddress addr, long index) {
1600         return getByteAtOffset_BE(addr, index);
1601     }
1602 
1603     /**
1604      * Writes a byte at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
</pre>
<hr />
<pre>
1610      * @param addr base address.
1611      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1612      * @param value the byte value to be written.
1613      */
1614     public static void setByteAtIndex_BE(MemoryAddress addr, long index, byte value) {
1615         setByteAtOffset_BE(addr, index, value);
1616     }
1617 
1618     /**
1619      * Read a char from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1620      * &lt;p&gt;
1621      * This is equivalent to the following code:
1622      * &lt;blockquote&gt;&lt;pre&gt;{@code
1623     char value = getCharAtOffset_BE(addr, 2 * index);
1624      * }&lt;/pre&gt;&lt;/blockquote&gt;
1625      * @param addr base address.
1626      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1627      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1628      */
1629     public static char getCharAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1630         return getCharAtOffset_BE(addr, scale(index, 2));</span>
1631     }
1632 
1633     /**
1634      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1635      * &lt;p&gt;
1636      * This is equivalent to the following code:
1637      * &lt;blockquote&gt;&lt;pre&gt;{@code
1638     setCharAtOffset_BE(addr, 2 * index, value);
1639      * }&lt;/pre&gt;&lt;/blockquote&gt;
1640      * @param addr base address.
1641      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1642      * @param value the char value to be written.
1643      */
1644     public static void setCharAtIndex_BE(MemoryAddress addr, long index, char value) {
<span class="line-modified">1645         setCharAtOffset_BE(addr, scale(index, 2), value);</span>
1646     }
1647 
1648     /**
1649      * Read a short from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1650      * &lt;p&gt;
1651      * This is equivalent to the following code:
1652      * &lt;blockquote&gt;&lt;pre&gt;{@code
1653     short value = getShortAtOffset_BE(addr, 2 * index);
1654      * }&lt;/pre&gt;&lt;/blockquote&gt;
1655      * @param addr base address.
1656      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1657      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1658      */
1659     public static short getShortAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1660         return getShortAtOffset_BE(addr, scale(index, 2));</span>
1661     }
1662 
1663     /**
1664      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1665      * &lt;p&gt;
1666      * This is equivalent to the following code:
1667      * &lt;blockquote&gt;&lt;pre&gt;{@code
1668     setShortAtOffset_BE(addr, 2 * index, value);
1669      * }&lt;/pre&gt;&lt;/blockquote&gt;
1670      * @param addr base address.
1671      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1672      * @param value the short value to be written.
1673      */
1674     public static void setShortAtIndex_BE(MemoryAddress addr, long index, short value) {
<span class="line-modified">1675         setShortAtOffset_BE(addr, scale(index, 2), value);</span>
1676     }
1677 
1678     /**
1679      * Read an int from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1680      * &lt;p&gt;
1681      * This is equivalent to the following code:
1682      * &lt;blockquote&gt;&lt;pre&gt;{@code
1683     int value = getIntAtOffset_BE(addr, 4 * index);
1684      * }&lt;/pre&gt;&lt;/blockquote&gt;
1685      * @param addr base address.
1686      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1687      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1688      */
1689     public static int getIntAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1690         return getIntAtOffset_BE(addr, scale(index, 4));</span>
1691     }
1692 
1693     /**
1694      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1695      * &lt;p&gt;
1696      * This is equivalent to the following code:
1697      * &lt;blockquote&gt;&lt;pre&gt;{@code
1698     setIntAtOffset_BE(addr, 4 * index, value);
1699      * }&lt;/pre&gt;&lt;/blockquote&gt;
1700      * @param addr base address.
1701      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1702      * @param value the int value to be written.
1703      */
1704     public static void setIntAtIndex_BE(MemoryAddress addr, long index, int value) {
<span class="line-modified">1705         setIntAtOffset_BE(addr, scale(index, 4), value);</span>
1706     }
1707 
1708     /**
1709      * Read a float from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1710      * &lt;p&gt;
1711      * This is equivalent to the following code:
1712      * &lt;blockquote&gt;&lt;pre&gt;{@code
1713     float value = getFloatAtOffset_BE(addr, 4 * index);
1714      * }&lt;/pre&gt;&lt;/blockquote&gt;
1715      * @param addr base address.
1716      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1717      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1718      */
1719     public static float getFloatAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1720         return getFloatAtOffset_BE(addr, scale(index, 4));</span>
1721     }
1722 
1723     /**
1724      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1725      * &lt;p&gt;
1726      * This is equivalent to the following code:
1727      * &lt;blockquote&gt;&lt;pre&gt;{@code
1728     setFloatAtOffset_BE(addr, 4 * index, value);
1729      * }&lt;/pre&gt;&lt;/blockquote&gt;
1730      * @param addr base address.
1731      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1732      * @param value the float value to be written.
1733      */
1734     public static void setFloatAtIndex_BE(MemoryAddress addr, long index, float value) {
<span class="line-modified">1735         setFloatAtOffset_BE(addr, scale(index, 4), value);</span>
1736     }
1737 
1738     /**
1739      * Read a long from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1740      * &lt;p&gt;
1741      * This is equivalent to the following code:
1742      * &lt;blockquote&gt;&lt;pre&gt;{@code
1743     return getLongAtOffset_BE(addr, 8 * index);
1744      * }&lt;/pre&gt;&lt;/blockquote&gt;
1745      * @param addr base address.
1746      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1747      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1748      */
1749     public static long getLongAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1750         return getLongAtOffset_BE(addr, scale(index, 8));</span>
1751     }
1752 
1753     /**
1754      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1755      * &lt;p&gt;
1756      * This is equivalent to the following code:
1757      * &lt;blockquote&gt;&lt;pre&gt;{@code
1758     setLongAtOffset_BE(addr, 8 * index, value);
1759      * }&lt;/pre&gt;&lt;/blockquote&gt;
1760      * @param addr base address.
1761      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1762      * @param value the long value to be written.
1763      */
1764     public static void setLongAtIndex_BE(MemoryAddress addr, long index, long value) {
<span class="line-modified">1765         setLongAtOffset_BE(addr, scale(index, 8), value);</span>
1766     }
1767 
1768     /**
1769      * Read a double from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1770      * &lt;p&gt;
1771      * This is equivalent to the following code:
1772      * &lt;blockquote&gt;&lt;pre&gt;{@code
1773     return getDoubleAtOffset_BE(addr, 8 * index);
1774      * }&lt;/pre&gt;&lt;/blockquote&gt;
1775      * @param addr base address.
1776      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1777      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1778      */
1779     public static double getDoubleAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1780         return getDoubleAtOffset_BE(addr, scale(index, 8));</span>
1781     }
1782 
1783     /**
1784      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1785      * &lt;p&gt;
1786      * This is equivalent to the following code:
1787      * &lt;blockquote&gt;&lt;pre&gt;{@code
1788     setDoubleAtOffset_BE(addr, 8 * index, value);
1789      * }&lt;/pre&gt;&lt;/blockquote&gt;
1790      * @param addr base address.
1791      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1792      * @param value the double value to be written.
1793      */
1794     public static void setDoubleAtIndex_BE(MemoryAddress addr, long index, double value) {
<span class="line-modified">1795         setDoubleAtOffset_BE(addr, scale(index, 8), value);</span>
1796     }
1797 
1798     /**
1799      * Read a byte from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1800      * &lt;p&gt;
1801      * This is equivalent to the following code:
1802      * &lt;blockquote&gt;&lt;pre&gt;{@code
1803     byte value = getByteAtOffset(addr, index);
1804      * }&lt;/pre&gt;&lt;/blockquote&gt;
1805      *
1806      * @param addr base address.
1807      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1808      * @return a byte value read from {@code addr} at the element index specified by {@code index}.
1809      */
1810     public static byte getByteAtIndex(MemoryAddress addr, long index) {
1811         return getByteAtOffset(addr, index);
1812     }
1813 
1814     /**
1815      * Writes a byte at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
</pre>
<hr />
<pre>
1821      * @param addr base address.
1822      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1823      * @param value the byte value to be written.
1824      */
1825     public static void setByteAtIndex(MemoryAddress addr, long index, byte value) {
1826         setByteAtOffset(addr, index, value);
1827     }
1828 
1829     /**
1830      * Read a char from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1831      * &lt;p&gt;
1832      * This is equivalent to the following code:
1833      * &lt;blockquote&gt;&lt;pre&gt;{@code
1834     char value = getCharAtOffset(addr, 2 * index);
1835      * }&lt;/pre&gt;&lt;/blockquote&gt;
1836      * @param addr base address.
1837      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1838      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1839      */
1840     public static char getCharAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1841         return getCharAtOffset(addr, scale(index, 2));</span>
1842     }
1843 
1844     /**
1845      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1846      * &lt;p&gt;
1847      * This is equivalent to the following code:
1848      * &lt;blockquote&gt;&lt;pre&gt;{@code
1849     setCharAtOffset(addr, 2 * index, value);
1850      * }&lt;/pre&gt;&lt;/blockquote&gt;
1851      * @param addr base address.
1852      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1853      * @param value the char value to be written.
1854      */
1855     public static void setCharAtIndex(MemoryAddress addr, long index, char value) {
<span class="line-modified">1856         setCharAtOffset(addr, scale(index, 2), value);</span>
1857     }
1858 
1859     /**
1860      * Read a short from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1861      * &lt;p&gt;
1862      * This is equivalent to the following code:
1863      * &lt;blockquote&gt;&lt;pre&gt;{@code
1864     short value = getShortAtOffset(addr, 2 * index);
1865      * }&lt;/pre&gt;&lt;/blockquote&gt;
1866      * @param addr base address.
1867      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1868      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1869      */
1870     public static short getShortAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1871         return getShortAtOffset(addr, scale(index, 2));</span>
1872     }
1873 
1874     /**
1875      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1876      * &lt;p&gt;
1877      * This is equivalent to the following code:
1878      * &lt;blockquote&gt;&lt;pre&gt;{@code
1879     setShortAtOffset(addr, 2 * index, value);
1880      * }&lt;/pre&gt;&lt;/blockquote&gt;
1881      * @param addr base address.
1882      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1883      * @param value the short value to be written.
1884      */
1885     public static void setShortAtIndex(MemoryAddress addr, long index, short value) {
<span class="line-modified">1886         setShortAtOffset(addr, scale(index, 2), value);</span>
1887     }
1888 
1889     /**
1890      * Read an int from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1891      * &lt;p&gt;
1892      * This is equivalent to the following code:
1893      * &lt;blockquote&gt;&lt;pre&gt;{@code
1894     int value = getIntAtOffset(addr, 4 * index);
1895      * }&lt;/pre&gt;&lt;/blockquote&gt;
1896      * @param addr base address.
1897      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1898      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1899      */
1900     public static int getIntAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1901         return getIntAtOffset(addr, scale(index, 4));</span>
1902     }
1903 
1904     /**
1905      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1906      * &lt;p&gt;
1907      * This is equivalent to the following code:
1908      * &lt;blockquote&gt;&lt;pre&gt;{@code
1909     setIntAtOffset(addr, 4 * index, value);
1910      * }&lt;/pre&gt;&lt;/blockquote&gt;
1911      * @param addr base address.
1912      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1913      * @param value the int value to be written.
1914      */
1915     public static void setIntAtIndex(MemoryAddress addr, long index, int value) {
<span class="line-modified">1916         setIntAtOffset(addr, scale(index, 4), value);</span>
1917     }
1918 
1919     /**
1920      * Read a float from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1921      * &lt;p&gt;
1922      * This is equivalent to the following code:
1923      * &lt;blockquote&gt;&lt;pre&gt;{@code
1924     float value = getFloatAtOffset(addr, 4 * index);
1925      * }&lt;/pre&gt;&lt;/blockquote&gt;
1926      * @param addr base address.
1927      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1928      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1929      */
1930     public static float getFloatAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1931         return getFloatAtOffset(addr, scale(index, 4));</span>
1932     }
1933 
1934     /**
1935      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1936      * &lt;p&gt;
1937      * This is equivalent to the following code:
1938      * &lt;blockquote&gt;&lt;pre&gt;{@code
1939     setFloatAtOffset(addr, 4 * index, value);
1940      * }&lt;/pre&gt;&lt;/blockquote&gt;
1941      * @param addr base address.
1942      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1943      * @param value the float value to be written.
1944      */
1945     public static void setFloatAtIndex(MemoryAddress addr, long index, float value) {
<span class="line-modified">1946         setFloatAtOffset(addr, scale(index, 4), value);</span>
1947     }
1948 
1949     /**
1950      * Read a long from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1951      * &lt;p&gt;
1952      * This is equivalent to the following code:
1953      * &lt;blockquote&gt;&lt;pre&gt;{@code
1954     return getLongAtOffset(addr, 8 * index);
1955      * }&lt;/pre&gt;&lt;/blockquote&gt;
1956      * @param addr base address.
1957      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1958      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1959      */
1960     public static long getLongAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1961         return getLongAtOffset(addr, scale(index, 8));</span>
1962     }
1963 
1964     /**
1965      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1966      * &lt;p&gt;
1967      * This is equivalent to the following code:
1968      * &lt;blockquote&gt;&lt;pre&gt;{@code
1969     setLongAtOffset(addr, 8 * index, value);
1970      * }&lt;/pre&gt;&lt;/blockquote&gt;
1971      * @param addr base address.
1972      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1973      * @param value the long value to be written.
1974      */
1975     public static void setLongAtIndex(MemoryAddress addr, long index, long value) {
<span class="line-modified">1976         setLongAtOffset(addr, scale(index, 8), value);</span>
1977     }
1978 
1979     /**
1980      * Read a double from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1981      * &lt;p&gt;
1982      * This is equivalent to the following code:
1983      * &lt;blockquote&gt;&lt;pre&gt;{@code
1984     return getDoubleAtOffset(addr, 8 * index);
1985      * }&lt;/pre&gt;&lt;/blockquote&gt;
1986      * @param addr base address.
1987      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1988      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1989      */
1990     public static double getDoubleAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1991         return getDoubleAtOffset(addr, scale(index, 8));</span>
1992     }
1993 
1994     /**
1995      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1996      * &lt;p&gt;
1997      * This is equivalent to the following code:
1998      * &lt;blockquote&gt;&lt;pre&gt;{@code
1999     setDoubleAtOffset(addr, 8 * index, value);
2000      * }&lt;/pre&gt;&lt;/blockquote&gt;
2001      * @param addr base address.
2002      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2003      * @param value the double value to be written.
2004      */
2005     public static void setDoubleAtIndex(MemoryAddress addr, long index, double value) {
<span class="line-modified">2006         setDoubleAtOffset(addr, scale(index, 8), value);</span>
2007     }
2008 
2009     /**
2010      * Read a memory address from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
2011      * &lt;p&gt;
2012      * This is equivalent to the following code:
2013      * &lt;blockquote&gt;&lt;pre&gt;{@code
2014     return getAddressAtOffset(addr, index * 8);
2015      * }&lt;/pre&gt;&lt;/blockquote&gt;
2016      * @param addr base address.
2017      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2018      * @return a memory address read from {@code addr} at the element index specified by {@code index}.
2019      */
2020     public static MemoryAddress getAddressAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">2021         return getAddressAtOffset(addr, scale(index, 8));</span>
2022     }
2023 
2024     /**
2025      * Writes a memory address at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
2026      * &lt;p&gt;
2027      * This is equivalent to the following code:
2028      * &lt;blockquote&gt;&lt;pre&gt;{@code
2029     setAddressAtOffset(addr, index * 8, value);
2030      * }&lt;/pre&gt;&lt;/blockquote&gt;
2031      * @param addr base address.
2032      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2033      * @param value the memory address to be written.
2034      */
2035     public static void setAddressAtIndex(MemoryAddress addr, long index, MemoryAddress value) {
<span class="line-modified">2036         setAddressAtOffset(addr, scale(index, 8), value);</span>
2037     }
2038 
2039     @ForceInline
<span class="line-modified">2040     private static long scale(long index, int size) {</span>
<span class="line-modified">2041         if (index &lt; Integer.MAX_VALUE) {</span>
<span class="line-removed">2042             return (int)index * size;</span>
<span class="line-removed">2043         } else {</span>
<span class="line-removed">2044             return index * size;</span>
<span class="line-removed">2045         }</span>
2046     }
2047 }
</pre>
</td>
<td>
<hr />
<pre>
   1 package jdk.incubator.foreign;
   2 
<span class="line-added">   3 import jdk.internal.access.foreign.MemoryAddressProxy;</span>
   4 import jdk.internal.vm.annotation.ForceInline;
   5 
   6 import java.lang.invoke.VarHandle;
   7 import java.nio.ByteOrder;
   8 
   9 /**
  10  * This class defines ready-made static accessors which can be used to dereference memory segments in many ways.
  11  * &lt;p&gt;
  12  * The most primitive accessors (see {@link #getIntAtOffset(MemoryAddress, long)} (MemoryAddress, long)}) take a &lt;em&gt;base&lt;/em&gt; address and an offset (expressed in bytes).
  13  * The final address at which the dereference will occur will be computed by offsetting the base address by
  14  * the specified offset, as if by calling {@link MemoryAddress#addOffset(long)} on the specified base address.
  15  * &lt;p&gt;
  16  * In cases where no offset is required, overloads are provided (see {@link #getInt(MemoryAddress)}) so that
  17  * clients can omit the offset coordinate.
  18  * &lt;p&gt;
  19  * To help dereferencing in array-like use cases (e.g. where the layout of a given memory segment is a sequence
  20  * layout of given size an element count), higher-level overloads are also provided (see {@link #getIntAtIndex(MemoryAddress, long)}),
  21  * which take an &lt;em&gt;base&lt;/em&gt; address and a &lt;em&gt;logical&lt;/em&gt; element index. The formula to obtain the byte offset {@code O} from an
  22  * index {@code I} is given by {@code O = I * S} where {@code S} is the size (expressed in bytes) of the element to
  23  * be dereferenced.
</pre>
<hr />
<pre>
1400      * @param addr base address.
1401      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1402      * @param value the byte value to be written.
1403      */
1404     public static void setByteAtIndex_LE(MemoryAddress addr, long index, byte value) {
1405         setByteAtOffset_LE(addr, index, value);
1406     }
1407 
1408     /**
1409      * Read a char from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1410      * &lt;p&gt;
1411      * This is equivalent to the following code:
1412      * &lt;blockquote&gt;&lt;pre&gt;{@code
1413     char value = getCharAtOffset_LE(addr, 2 * index);
1414      * }&lt;/pre&gt;&lt;/blockquote&gt;
1415      * @param addr base address.
1416      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1417      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1418      */
1419     public static char getCharAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1420         return getCharAtOffset_LE(addr, scale(addr, index, 2));</span>
1421     }
1422 
1423     /**
1424      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1425      * &lt;p&gt;
1426      * This is equivalent to the following code:
1427      * &lt;blockquote&gt;&lt;pre&gt;{@code
1428     setCharAtOffset_LE(addr, 2 * index, value);
1429      * }&lt;/pre&gt;&lt;/blockquote&gt;
1430      * @param addr base address.
1431      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1432      * @param value the char value to be written.
1433      */
1434     public static void setCharAtIndex_LE(MemoryAddress addr, long index, char value) {
<span class="line-modified">1435         setCharAtOffset_LE(addr, scale(addr, index, 2), value);</span>
1436     }
1437 
1438     /**
1439      * Read a short from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1440      * &lt;p&gt;
1441      * This is equivalent to the following code:
1442      * &lt;blockquote&gt;&lt;pre&gt;{@code
1443     short value = getShortAtOffset_LE(addr, 2 * index);
1444      * }&lt;/pre&gt;&lt;/blockquote&gt;
1445      * @param addr base address.
1446      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1447      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1448      */
1449     public static short getShortAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1450         return getShortAtOffset_LE(addr, scale(addr, index, 2));</span>
1451     }
1452 
1453     /**
1454      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1455      * &lt;p&gt;
1456      * This is equivalent to the following code:
1457      * &lt;blockquote&gt;&lt;pre&gt;{@code
1458     setShortAtOffset_LE(addr, 2 * index, value);
1459      * }&lt;/pre&gt;&lt;/blockquote&gt;
1460      * @param addr base address.
1461      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1462      * @param value the short value to be written.
1463      */
1464     public static void setShortAtIndex_LE(MemoryAddress addr, long index, short value) {
<span class="line-modified">1465         setShortAtOffset_LE(addr, scale(addr, index, 2), value);</span>
1466     }
1467 
1468     /**
1469      * Read an int from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1470      * &lt;p&gt;
1471      * This is equivalent to the following code:
1472      * &lt;blockquote&gt;&lt;pre&gt;{@code
1473     int value = getIntAtOffset_LE(addr, 4 * index);
1474      * }&lt;/pre&gt;&lt;/blockquote&gt;
1475      * @param addr base address.
1476      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1477      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1478      */
1479     public static int getIntAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1480         return getIntAtOffset_LE(addr, scale(addr, index, 4));</span>
1481     }
1482 
1483     /**
1484      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1485      * &lt;p&gt;
1486      * This is equivalent to the following code:
1487      * &lt;blockquote&gt;&lt;pre&gt;{@code
1488     setIntAtOffset_LE(addr, 4 * index, value);
1489      * }&lt;/pre&gt;&lt;/blockquote&gt;
1490      * @param addr base address.
1491      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1492      * @param value the int value to be written.
1493      */
1494     public static void setIntAtIndex_LE(MemoryAddress addr, long index, int value) {
<span class="line-modified">1495         setIntAtOffset_LE(addr, scale(addr, index, 4), value);</span>
1496     }
1497 
1498     /**
1499      * Read a float from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1500      * &lt;p&gt;
1501      * This is equivalent to the following code:
1502      * &lt;blockquote&gt;&lt;pre&gt;{@code
1503     float value = getFloatAtOffset_LE(addr, 4 * index);
1504      * }&lt;/pre&gt;&lt;/blockquote&gt;
1505      * @param addr base address.
1506      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1507      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1508      */
1509     public static float getFloatAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1510         return getFloatAtOffset_LE(addr, scale(addr, index, 4));</span>
1511     }
1512 
1513     /**
1514      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1515      * &lt;p&gt;
1516      * This is equivalent to the following code:
1517      * &lt;blockquote&gt;&lt;pre&gt;{@code
1518     setFloatAtOffset_LE(addr, 4 * index, value);
1519      * }&lt;/pre&gt;&lt;/blockquote&gt;
1520      * @param addr base address.
1521      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1522      * @param value the float value to be written.
1523      */
1524     public static void setFloatAtIndex_LE(MemoryAddress addr, long index, float value) {
<span class="line-modified">1525         setFloatAtOffset_LE(addr, scale(addr, index, 4), value);</span>
1526     }
1527 
1528     /**
1529      * Read a long from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1530      * &lt;p&gt;
1531      * This is equivalent to the following code:
1532      * &lt;blockquote&gt;&lt;pre&gt;{@code
1533     return getLongAtOffset_LE(addr, 8 * index);
1534      * }&lt;/pre&gt;&lt;/blockquote&gt;
1535      * @param addr base address.
1536      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1537      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1538      */
1539     public static long getLongAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1540         return getLongAtOffset_LE(addr, scale(addr, index, 8));</span>
1541     }
1542 
1543     /**
1544      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1545      * &lt;p&gt;
1546      * This is equivalent to the following code:
1547      * &lt;blockquote&gt;&lt;pre&gt;{@code
1548     setLongAtOffset_LE(addr, 8 * index, value);
1549      * }&lt;/pre&gt;&lt;/blockquote&gt;
1550      * @param addr base address.
1551      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1552      * @param value the long value to be written.
1553      */
1554     public static void setLongAtIndex_LE(MemoryAddress addr, long index, long value) {
<span class="line-modified">1555         setLongAtOffset_LE(addr, scale(addr, index, 8), value);</span>
1556     }
1557 
1558     /**
1559      * Read a double from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1560      * &lt;p&gt;
1561      * This is equivalent to the following code:
1562      * &lt;blockquote&gt;&lt;pre&gt;{@code
1563     return getDoubleAtOffset_LE(addr, 8 * index);
1564      * }&lt;/pre&gt;&lt;/blockquote&gt;
1565      * @param addr base address.
1566      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1567      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1568      */
1569     public static double getDoubleAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1570         return getDoubleAtOffset_LE(addr, scale(addr, index, 8));</span>
1571     }
1572 
1573     /**
1574      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1575      * &lt;p&gt;
1576      * This is equivalent to the following code:
1577      * &lt;blockquote&gt;&lt;pre&gt;{@code
1578     setDoubleAtOffset_LE(addr, 8 * index, value);
1579      * }&lt;/pre&gt;&lt;/blockquote&gt;
1580      * @param addr base address.
1581      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1582      * @param value the double value to be written.
1583      */
1584     public static void setDoubleAtIndex_LE(MemoryAddress addr, long index, double value) {
<span class="line-modified">1585         setDoubleAtOffset_LE(addr, scale(addr, index, 8), value);</span>
1586     }
1587 
1588     /**
1589      * Read a byte from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1590      * &lt;p&gt;
1591      * This is equivalent to the following code:
1592      * &lt;blockquote&gt;&lt;pre&gt;{@code
1593     byte value = getByteAtOffset_BE(addr, index);
1594      * }&lt;/pre&gt;&lt;/blockquote&gt;
1595      *
1596      * @param addr base address.
1597      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1598      * @return a byte value read from {@code addr} at the element index specified by {@code index}.
1599      */
1600     public static byte getByteAtIndex_BE(MemoryAddress addr, long index) {
1601         return getByteAtOffset_BE(addr, index);
1602     }
1603 
1604     /**
1605      * Writes a byte at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
</pre>
<hr />
<pre>
1611      * @param addr base address.
1612      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1613      * @param value the byte value to be written.
1614      */
1615     public static void setByteAtIndex_BE(MemoryAddress addr, long index, byte value) {
1616         setByteAtOffset_BE(addr, index, value);
1617     }
1618 
1619     /**
1620      * Read a char from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1621      * &lt;p&gt;
1622      * This is equivalent to the following code:
1623      * &lt;blockquote&gt;&lt;pre&gt;{@code
1624     char value = getCharAtOffset_BE(addr, 2 * index);
1625      * }&lt;/pre&gt;&lt;/blockquote&gt;
1626      * @param addr base address.
1627      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1628      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1629      */
1630     public static char getCharAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1631         return getCharAtOffset_BE(addr, scale(addr, index, 2));</span>
1632     }
1633 
1634     /**
1635      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1636      * &lt;p&gt;
1637      * This is equivalent to the following code:
1638      * &lt;blockquote&gt;&lt;pre&gt;{@code
1639     setCharAtOffset_BE(addr, 2 * index, value);
1640      * }&lt;/pre&gt;&lt;/blockquote&gt;
1641      * @param addr base address.
1642      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1643      * @param value the char value to be written.
1644      */
1645     public static void setCharAtIndex_BE(MemoryAddress addr, long index, char value) {
<span class="line-modified">1646         setCharAtOffset_BE(addr, scale(addr, index, 2), value);</span>
1647     }
1648 
1649     /**
1650      * Read a short from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1651      * &lt;p&gt;
1652      * This is equivalent to the following code:
1653      * &lt;blockquote&gt;&lt;pre&gt;{@code
1654     short value = getShortAtOffset_BE(addr, 2 * index);
1655      * }&lt;/pre&gt;&lt;/blockquote&gt;
1656      * @param addr base address.
1657      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1658      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1659      */
1660     public static short getShortAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1661         return getShortAtOffset_BE(addr, scale(addr, index, 2));</span>
1662     }
1663 
1664     /**
1665      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1666      * &lt;p&gt;
1667      * This is equivalent to the following code:
1668      * &lt;blockquote&gt;&lt;pre&gt;{@code
1669     setShortAtOffset_BE(addr, 2 * index, value);
1670      * }&lt;/pre&gt;&lt;/blockquote&gt;
1671      * @param addr base address.
1672      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1673      * @param value the short value to be written.
1674      */
1675     public static void setShortAtIndex_BE(MemoryAddress addr, long index, short value) {
<span class="line-modified">1676         setShortAtOffset_BE(addr, scale(addr, index, 2), value);</span>
1677     }
1678 
1679     /**
1680      * Read an int from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1681      * &lt;p&gt;
1682      * This is equivalent to the following code:
1683      * &lt;blockquote&gt;&lt;pre&gt;{@code
1684     int value = getIntAtOffset_BE(addr, 4 * index);
1685      * }&lt;/pre&gt;&lt;/blockquote&gt;
1686      * @param addr base address.
1687      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1688      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1689      */
1690     public static int getIntAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1691         return getIntAtOffset_BE(addr, scale(addr, index, 4));</span>
1692     }
1693 
1694     /**
1695      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1696      * &lt;p&gt;
1697      * This is equivalent to the following code:
1698      * &lt;blockquote&gt;&lt;pre&gt;{@code
1699     setIntAtOffset_BE(addr, 4 * index, value);
1700      * }&lt;/pre&gt;&lt;/blockquote&gt;
1701      * @param addr base address.
1702      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1703      * @param value the int value to be written.
1704      */
1705     public static void setIntAtIndex_BE(MemoryAddress addr, long index, int value) {
<span class="line-modified">1706         setIntAtOffset_BE(addr, scale(addr, index, 4), value);</span>
1707     }
1708 
1709     /**
1710      * Read a float from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1711      * &lt;p&gt;
1712      * This is equivalent to the following code:
1713      * &lt;blockquote&gt;&lt;pre&gt;{@code
1714     float value = getFloatAtOffset_BE(addr, 4 * index);
1715      * }&lt;/pre&gt;&lt;/blockquote&gt;
1716      * @param addr base address.
1717      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1718      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1719      */
1720     public static float getFloatAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1721         return getFloatAtOffset_BE(addr, scale(addr, index, 4));</span>
1722     }
1723 
1724     /**
1725      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1726      * &lt;p&gt;
1727      * This is equivalent to the following code:
1728      * &lt;blockquote&gt;&lt;pre&gt;{@code
1729     setFloatAtOffset_BE(addr, 4 * index, value);
1730      * }&lt;/pre&gt;&lt;/blockquote&gt;
1731      * @param addr base address.
1732      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1733      * @param value the float value to be written.
1734      */
1735     public static void setFloatAtIndex_BE(MemoryAddress addr, long index, float value) {
<span class="line-modified">1736         setFloatAtOffset_BE(addr, scale(addr, index, 4), value);</span>
1737     }
1738 
1739     /**
1740      * Read a long from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1741      * &lt;p&gt;
1742      * This is equivalent to the following code:
1743      * &lt;blockquote&gt;&lt;pre&gt;{@code
1744     return getLongAtOffset_BE(addr, 8 * index);
1745      * }&lt;/pre&gt;&lt;/blockquote&gt;
1746      * @param addr base address.
1747      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1748      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1749      */
1750     public static long getLongAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1751         return getLongAtOffset_BE(addr, scale(addr, index, 8));</span>
1752     }
1753 
1754     /**
1755      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1756      * &lt;p&gt;
1757      * This is equivalent to the following code:
1758      * &lt;blockquote&gt;&lt;pre&gt;{@code
1759     setLongAtOffset_BE(addr, 8 * index, value);
1760      * }&lt;/pre&gt;&lt;/blockquote&gt;
1761      * @param addr base address.
1762      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1763      * @param value the long value to be written.
1764      */
1765     public static void setLongAtIndex_BE(MemoryAddress addr, long index, long value) {
<span class="line-modified">1766         setLongAtOffset_BE(addr, scale(addr, index, 8), value);</span>
1767     }
1768 
1769     /**
1770      * Read a double from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1771      * &lt;p&gt;
1772      * This is equivalent to the following code:
1773      * &lt;blockquote&gt;&lt;pre&gt;{@code
1774     return getDoubleAtOffset_BE(addr, 8 * index);
1775      * }&lt;/pre&gt;&lt;/blockquote&gt;
1776      * @param addr base address.
1777      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1778      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1779      */
1780     public static double getDoubleAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1781         return getDoubleAtOffset_BE(addr, scale(addr, index, 8));</span>
1782     }
1783 
1784     /**
1785      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1786      * &lt;p&gt;
1787      * This is equivalent to the following code:
1788      * &lt;blockquote&gt;&lt;pre&gt;{@code
1789     setDoubleAtOffset_BE(addr, 8 * index, value);
1790      * }&lt;/pre&gt;&lt;/blockquote&gt;
1791      * @param addr base address.
1792      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1793      * @param value the double value to be written.
1794      */
1795     public static void setDoubleAtIndex_BE(MemoryAddress addr, long index, double value) {
<span class="line-modified">1796         setDoubleAtOffset_BE(addr, scale(addr, index, 8), value);</span>
1797     }
1798 
1799     /**
1800      * Read a byte from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1801      * &lt;p&gt;
1802      * This is equivalent to the following code:
1803      * &lt;blockquote&gt;&lt;pre&gt;{@code
1804     byte value = getByteAtOffset(addr, index);
1805      * }&lt;/pre&gt;&lt;/blockquote&gt;
1806      *
1807      * @param addr base address.
1808      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1809      * @return a byte value read from {@code addr} at the element index specified by {@code index}.
1810      */
1811     public static byte getByteAtIndex(MemoryAddress addr, long index) {
1812         return getByteAtOffset(addr, index);
1813     }
1814 
1815     /**
1816      * Writes a byte at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
</pre>
<hr />
<pre>
1822      * @param addr base address.
1823      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1824      * @param value the byte value to be written.
1825      */
1826     public static void setByteAtIndex(MemoryAddress addr, long index, byte value) {
1827         setByteAtOffset(addr, index, value);
1828     }
1829 
1830     /**
1831      * Read a char from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1832      * &lt;p&gt;
1833      * This is equivalent to the following code:
1834      * &lt;blockquote&gt;&lt;pre&gt;{@code
1835     char value = getCharAtOffset(addr, 2 * index);
1836      * }&lt;/pre&gt;&lt;/blockquote&gt;
1837      * @param addr base address.
1838      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1839      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1840      */
1841     public static char getCharAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1842         return getCharAtOffset(addr, scale(addr, index, 2));</span>
1843     }
1844 
1845     /**
1846      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1847      * &lt;p&gt;
1848      * This is equivalent to the following code:
1849      * &lt;blockquote&gt;&lt;pre&gt;{@code
1850     setCharAtOffset(addr, 2 * index, value);
1851      * }&lt;/pre&gt;&lt;/blockquote&gt;
1852      * @param addr base address.
1853      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1854      * @param value the char value to be written.
1855      */
1856     public static void setCharAtIndex(MemoryAddress addr, long index, char value) {
<span class="line-modified">1857         setCharAtOffset(addr, scale(addr, index, 2), value);</span>
1858     }
1859 
1860     /**
1861      * Read a short from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1862      * &lt;p&gt;
1863      * This is equivalent to the following code:
1864      * &lt;blockquote&gt;&lt;pre&gt;{@code
1865     short value = getShortAtOffset(addr, 2 * index);
1866      * }&lt;/pre&gt;&lt;/blockquote&gt;
1867      * @param addr base address.
1868      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1869      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1870      */
1871     public static short getShortAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1872         return getShortAtOffset(addr, scale(addr, index, 2));</span>
1873     }
1874 
1875     /**
1876      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1877      * &lt;p&gt;
1878      * This is equivalent to the following code:
1879      * &lt;blockquote&gt;&lt;pre&gt;{@code
1880     setShortAtOffset(addr, 2 * index, value);
1881      * }&lt;/pre&gt;&lt;/blockquote&gt;
1882      * @param addr base address.
1883      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1884      * @param value the short value to be written.
1885      */
1886     public static void setShortAtIndex(MemoryAddress addr, long index, short value) {
<span class="line-modified">1887         setShortAtOffset(addr, scale(addr, index, 2), value);</span>
1888     }
1889 
1890     /**
1891      * Read an int from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1892      * &lt;p&gt;
1893      * This is equivalent to the following code:
1894      * &lt;blockquote&gt;&lt;pre&gt;{@code
1895     int value = getIntAtOffset(addr, 4 * index);
1896      * }&lt;/pre&gt;&lt;/blockquote&gt;
1897      * @param addr base address.
1898      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1899      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1900      */
1901     public static int getIntAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1902         return getIntAtOffset(addr, scale(addr, index, 4));</span>
1903     }
1904 
1905     /**
1906      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1907      * &lt;p&gt;
1908      * This is equivalent to the following code:
1909      * &lt;blockquote&gt;&lt;pre&gt;{@code
1910     setIntAtOffset(addr, 4 * index, value);
1911      * }&lt;/pre&gt;&lt;/blockquote&gt;
1912      * @param addr base address.
1913      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1914      * @param value the int value to be written.
1915      */
1916     public static void setIntAtIndex(MemoryAddress addr, long index, int value) {
<span class="line-modified">1917         setIntAtOffset(addr, scale(addr, index, 4), value);</span>
1918     }
1919 
1920     /**
1921      * Read a float from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1922      * &lt;p&gt;
1923      * This is equivalent to the following code:
1924      * &lt;blockquote&gt;&lt;pre&gt;{@code
1925     float value = getFloatAtOffset(addr, 4 * index);
1926      * }&lt;/pre&gt;&lt;/blockquote&gt;
1927      * @param addr base address.
1928      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1929      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1930      */
1931     public static float getFloatAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1932         return getFloatAtOffset(addr, scale(addr, index, 4));</span>
1933     }
1934 
1935     /**
1936      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1937      * &lt;p&gt;
1938      * This is equivalent to the following code:
1939      * &lt;blockquote&gt;&lt;pre&gt;{@code
1940     setFloatAtOffset(addr, 4 * index, value);
1941      * }&lt;/pre&gt;&lt;/blockquote&gt;
1942      * @param addr base address.
1943      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1944      * @param value the float value to be written.
1945      */
1946     public static void setFloatAtIndex(MemoryAddress addr, long index, float value) {
<span class="line-modified">1947         setFloatAtOffset(addr, scale(addr, index, 4), value);</span>
1948     }
1949 
1950     /**
1951      * Read a long from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1952      * &lt;p&gt;
1953      * This is equivalent to the following code:
1954      * &lt;blockquote&gt;&lt;pre&gt;{@code
1955     return getLongAtOffset(addr, 8 * index);
1956      * }&lt;/pre&gt;&lt;/blockquote&gt;
1957      * @param addr base address.
1958      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1959      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1960      */
1961     public static long getLongAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1962         return getLongAtOffset(addr, scale(addr, index, 8));</span>
1963     }
1964 
1965     /**
1966      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1967      * &lt;p&gt;
1968      * This is equivalent to the following code:
1969      * &lt;blockquote&gt;&lt;pre&gt;{@code
1970     setLongAtOffset(addr, 8 * index, value);
1971      * }&lt;/pre&gt;&lt;/blockquote&gt;
1972      * @param addr base address.
1973      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1974      * @param value the long value to be written.
1975      */
1976     public static void setLongAtIndex(MemoryAddress addr, long index, long value) {
<span class="line-modified">1977         setLongAtOffset(addr, scale(addr, index, 8), value);</span>
1978     }
1979 
1980     /**
1981      * Read a double from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1982      * &lt;p&gt;
1983      * This is equivalent to the following code:
1984      * &lt;blockquote&gt;&lt;pre&gt;{@code
1985     return getDoubleAtOffset(addr, 8 * index);
1986      * }&lt;/pre&gt;&lt;/blockquote&gt;
1987      * @param addr base address.
1988      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1989      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1990      */
1991     public static double getDoubleAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1992         return getDoubleAtOffset(addr, scale(addr, index, 8));</span>
1993     }
1994 
1995     /**
1996      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1997      * &lt;p&gt;
1998      * This is equivalent to the following code:
1999      * &lt;blockquote&gt;&lt;pre&gt;{@code
2000     setDoubleAtOffset(addr, 8 * index, value);
2001      * }&lt;/pre&gt;&lt;/blockquote&gt;
2002      * @param addr base address.
2003      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2004      * @param value the double value to be written.
2005      */
2006     public static void setDoubleAtIndex(MemoryAddress addr, long index, double value) {
<span class="line-modified">2007         setDoubleAtOffset(addr, scale(addr, index, 8), value);</span>
2008     }
2009 
2010     /**
2011      * Read a memory address from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
2012      * &lt;p&gt;
2013      * This is equivalent to the following code:
2014      * &lt;blockquote&gt;&lt;pre&gt;{@code
2015     return getAddressAtOffset(addr, index * 8);
2016      * }&lt;/pre&gt;&lt;/blockquote&gt;
2017      * @param addr base address.
2018      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2019      * @return a memory address read from {@code addr} at the element index specified by {@code index}.
2020      */
2021     public static MemoryAddress getAddressAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">2022         return getAddressAtOffset(addr, scale(addr, index, 8));</span>
2023     }
2024 
2025     /**
2026      * Writes a memory address at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
2027      * &lt;p&gt;
2028      * This is equivalent to the following code:
2029      * &lt;blockquote&gt;&lt;pre&gt;{@code
2030     setAddressAtOffset(addr, index * 8, value);
2031      * }&lt;/pre&gt;&lt;/blockquote&gt;
2032      * @param addr base address.
2033      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2034      * @param value the memory address to be written.
2035      */
2036     public static void setAddressAtIndex(MemoryAddress addr, long index, MemoryAddress value) {
<span class="line-modified">2037         setAddressAtOffset(addr, scale(addr, index, 8), value);</span>
2038     }
2039 
2040     @ForceInline
<span class="line-modified">2041     private static long scale(MemoryAddress address, long index, int size) {</span>
<span class="line-modified">2042         return MemoryAddressProxy.multiplyOffsets(index, size, (MemoryAddressProxy)address);</span>




2043     }
2044 }
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>