<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.incubator.foreign/share/classes/jdk/incubator/foreign/MemoryAccess.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../test/micro/org/openjdk/bench/jdk/incubator/foreign/LoopOverNonConstant.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.incubator.foreign/share/classes/jdk/incubator/foreign/MemoryAccess.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 package jdk.incubator.foreign;
   2 


   3 import java.lang.invoke.VarHandle;
   4 import java.nio.ByteOrder;
   5 
   6 /**
   7  * This class defines ready-made static accessors which can be used to dereference memory segments in many ways.
   8  * &lt;p&gt;
   9  * The most primitive accessors (see {@link #getIntAtOffset(MemoryAddress, long)} (MemoryAddress, long)}) take a &lt;em&gt;base&lt;/em&gt; address and an offset (expressed in bytes).
  10  * The final address at which the dereference will occur will be computed by offsetting the base address by
  11  * the specified offset, as if by calling {@link MemoryAddress#addOffset(long)} on the specified base address.
  12  * &lt;p&gt;
  13  * In cases where no offset is required, overloads are provided (see {@link #getInt(MemoryAddress)}) so that
  14  * clients can omit the offset coordinate.
  15  * &lt;p&gt;
  16  * To help dereferencing in array-like use cases (e.g. where the layout of a given memory segment is a sequence
  17  * layout of given size an element count), higher-level overloads are also provided (see {@link #getIntAtIndex(MemoryAddress, long)}),
  18  * which take an &lt;em&gt;base&lt;/em&gt; address and a &lt;em&gt;logical&lt;/em&gt; element index. The formula to obtain the byte offset {@code O} from an
  19  * index {@code I} is given by {@code O = I * S} where {@code S} is the size (expressed in bytes) of the element to
  20  * be dereferenced.
  21  */
  22 public final class MemoryAccess {
</pre>
<hr />
<pre>
1397      * @param addr base address.
1398      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1399      * @param value the byte value to be written.
1400      */
1401     public static void setByteAtIndex_LE(MemoryAddress addr, long index, byte value) {
1402         setByteAtOffset_LE(addr, index, value);
1403     }
1404 
1405     /**
1406      * Read a char from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1407      * &lt;p&gt;
1408      * This is equivalent to the following code:
1409      * &lt;blockquote&gt;&lt;pre&gt;{@code
1410     char value = getCharAtOffset_LE(addr, 2 * index);
1411      * }&lt;/pre&gt;&lt;/blockquote&gt;
1412      * @param addr base address.
1413      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1414      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1415      */
1416     public static char getCharAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1417         return getCharAtOffset_LE(addr, 2 * index);</span>
1418     }
1419 
1420     /**
1421      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1422      * &lt;p&gt;
1423      * This is equivalent to the following code:
1424      * &lt;blockquote&gt;&lt;pre&gt;{@code
1425     setCharAtOffset_LE(addr, 2 * index, value);
1426      * }&lt;/pre&gt;&lt;/blockquote&gt;
1427      * @param addr base address.
1428      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1429      * @param value the char value to be written.
1430      */
1431     public static void setCharAtIndex_LE(MemoryAddress addr, long index, char value) {
<span class="line-modified">1432         setCharAtOffset_LE(addr, 2 * index, value);</span>
1433     }
1434 
1435     /**
1436      * Read a short from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1437      * &lt;p&gt;
1438      * This is equivalent to the following code:
1439      * &lt;blockquote&gt;&lt;pre&gt;{@code
1440     short value = getShortAtOffset_LE(addr, 2 * index);
1441      * }&lt;/pre&gt;&lt;/blockquote&gt;
1442      * @param addr base address.
1443      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1444      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1445      */
1446     public static short getShortAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1447         return getShortAtOffset_LE(addr, 2 * index);</span>
1448     }
1449 
1450     /**
1451      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1452      * &lt;p&gt;
1453      * This is equivalent to the following code:
1454      * &lt;blockquote&gt;&lt;pre&gt;{@code
1455     setShortAtOffset_LE(addr, 2 * index, value);
1456      * }&lt;/pre&gt;&lt;/blockquote&gt;
1457      * @param addr base address.
1458      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1459      * @param value the short value to be written.
1460      */
1461     public static void setShortAtIndex_LE(MemoryAddress addr, long index, short value) {
<span class="line-modified">1462         setShortAtOffset_LE(addr, 2 * index, value);</span>
1463     }
1464 
1465     /**
1466      * Read an int from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1467      * &lt;p&gt;
1468      * This is equivalent to the following code:
1469      * &lt;blockquote&gt;&lt;pre&gt;{@code
1470     int value = getIntAtOffset_LE(addr, 4 * index);
1471      * }&lt;/pre&gt;&lt;/blockquote&gt;
1472      * @param addr base address.
1473      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1474      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1475      */
1476     public static int getIntAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1477         return getIntAtOffset_LE(addr, 4 * index);</span>
1478     }
1479 
1480     /**
1481      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1482      * &lt;p&gt;
1483      * This is equivalent to the following code:
1484      * &lt;blockquote&gt;&lt;pre&gt;{@code
1485     setIntAtOffset_LE(addr, 4 * index, value);
1486      * }&lt;/pre&gt;&lt;/blockquote&gt;
1487      * @param addr base address.
1488      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1489      * @param value the int value to be written.
1490      */
1491     public static void setIntAtIndex_LE(MemoryAddress addr, long index, int value) {
<span class="line-modified">1492         setIntAtOffset_LE(addr, 4 * index, value);</span>
1493     }
1494 
1495     /**
1496      * Read a float from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1497      * &lt;p&gt;
1498      * This is equivalent to the following code:
1499      * &lt;blockquote&gt;&lt;pre&gt;{@code
1500     float value = getFloatAtOffset_LE(addr, 4 * index);
1501      * }&lt;/pre&gt;&lt;/blockquote&gt;
1502      * @param addr base address.
1503      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1504      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1505      */
1506     public static float getFloatAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1507         return getFloatAtOffset_LE(addr, 4 * index);</span>
1508     }
1509 
1510     /**
1511      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1512      * &lt;p&gt;
1513      * This is equivalent to the following code:
1514      * &lt;blockquote&gt;&lt;pre&gt;{@code
1515     setFloatAtOffset_LE(addr, 4 * index, value);
1516      * }&lt;/pre&gt;&lt;/blockquote&gt;
1517      * @param addr base address.
1518      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1519      * @param value the float value to be written.
1520      */
1521     public static void setFloatAtIndex_LE(MemoryAddress addr, long index, float value) {
<span class="line-modified">1522         setFloatAtOffset_LE(addr, 4 * index, value);</span>
1523     }
1524 
1525     /**
1526      * Read a long from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1527      * &lt;p&gt;
1528      * This is equivalent to the following code:
1529      * &lt;blockquote&gt;&lt;pre&gt;{@code
1530     return getLongAtOffset_LE(addr, 8 * index);
1531      * }&lt;/pre&gt;&lt;/blockquote&gt;
1532      * @param addr base address.
1533      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1534      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1535      */
1536     public static long getLongAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1537         return getLongAtOffset_LE(addr, 8 * index);</span>
1538     }
1539 
1540     /**
1541      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1542      * &lt;p&gt;
1543      * This is equivalent to the following code:
1544      * &lt;blockquote&gt;&lt;pre&gt;{@code
1545     setLongAtOffset_LE(addr, 8 * index, value);
1546      * }&lt;/pre&gt;&lt;/blockquote&gt;
1547      * @param addr base address.
1548      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1549      * @param value the long value to be written.
1550      */
1551     public static void setLongAtIndex_LE(MemoryAddress addr, long index, long value) {
<span class="line-modified">1552         setLongAtOffset_LE(addr, 8 * index, value);</span>
1553     }
1554 
1555     /**
1556      * Read a double from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1557      * &lt;p&gt;
1558      * This is equivalent to the following code:
1559      * &lt;blockquote&gt;&lt;pre&gt;{@code
1560     return getDoubleAtOffset_LE(addr, 8 * index);
1561      * }&lt;/pre&gt;&lt;/blockquote&gt;
1562      * @param addr base address.
1563      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1564      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1565      */
1566     public static double getDoubleAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1567         return getDoubleAtOffset_LE(addr, 8 * index);</span>
1568     }
1569 
1570     /**
1571      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1572      * &lt;p&gt;
1573      * This is equivalent to the following code:
1574      * &lt;blockquote&gt;&lt;pre&gt;{@code
1575     setDoubleAtOffset_LE(addr, 8 * index, value);
1576      * }&lt;/pre&gt;&lt;/blockquote&gt;
1577      * @param addr base address.
1578      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1579      * @param value the double value to be written.
1580      */
1581     public static void setDoubleAtIndex_LE(MemoryAddress addr, long index, double value) {
<span class="line-modified">1582         setDoubleAtOffset_LE(addr, 8 * index, value);</span>
1583     }
1584 
1585     /**
1586      * Read a byte from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1587      * &lt;p&gt;
1588      * This is equivalent to the following code:
1589      * &lt;blockquote&gt;&lt;pre&gt;{@code
1590     byte value = getByteAtOffset_BE(addr, index);
1591      * }&lt;/pre&gt;&lt;/blockquote&gt;
1592      *
1593      * @param addr base address.
1594      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1595      * @return a byte value read from {@code addr} at the element index specified by {@code index}.
1596      */
1597     public static byte getByteAtIndex_BE(MemoryAddress addr, long index) {
1598         return getByteAtOffset_BE(addr, index);
1599     }
1600 
1601     /**
1602      * Writes a byte at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
</pre>
<hr />
<pre>
1608      * @param addr base address.
1609      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1610      * @param value the byte value to be written.
1611      */
1612     public static void setByteAtIndex_BE(MemoryAddress addr, long index, byte value) {
1613         setByteAtOffset_BE(addr, index, value);
1614     }
1615 
1616     /**
1617      * Read a char from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1618      * &lt;p&gt;
1619      * This is equivalent to the following code:
1620      * &lt;blockquote&gt;&lt;pre&gt;{@code
1621     char value = getCharAtOffset_BE(addr, 2 * index);
1622      * }&lt;/pre&gt;&lt;/blockquote&gt;
1623      * @param addr base address.
1624      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1625      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1626      */
1627     public static char getCharAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1628         return getCharAtOffset_BE(addr, 2 * index);</span>
1629     }
1630 
1631     /**
1632      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1633      * &lt;p&gt;
1634      * This is equivalent to the following code:
1635      * &lt;blockquote&gt;&lt;pre&gt;{@code
1636     setCharAtOffset_BE(addr, 2 * index, value);
1637      * }&lt;/pre&gt;&lt;/blockquote&gt;
1638      * @param addr base address.
1639      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1640      * @param value the char value to be written.
1641      */
1642     public static void setCharAtIndex_BE(MemoryAddress addr, long index, char value) {
<span class="line-modified">1643         setCharAtOffset_BE(addr, 2 * index, value);</span>
1644     }
1645 
1646     /**
1647      * Read a short from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1648      * &lt;p&gt;
1649      * This is equivalent to the following code:
1650      * &lt;blockquote&gt;&lt;pre&gt;{@code
1651     short value = getShortAtOffset_BE(addr, 2 * index);
1652      * }&lt;/pre&gt;&lt;/blockquote&gt;
1653      * @param addr base address.
1654      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1655      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1656      */
1657     public static short getShortAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1658         return getShortAtOffset_BE(addr, 2 * index);</span>
1659     }
1660 
1661     /**
1662      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1663      * &lt;p&gt;
1664      * This is equivalent to the following code:
1665      * &lt;blockquote&gt;&lt;pre&gt;{@code
1666     setShortAtOffset_BE(addr, 2 * index, value);
1667      * }&lt;/pre&gt;&lt;/blockquote&gt;
1668      * @param addr base address.
1669      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1670      * @param value the short value to be written.
1671      */
1672     public static void setShortAtIndex_BE(MemoryAddress addr, long index, short value) {
<span class="line-modified">1673         setShortAtOffset_BE(addr, 2 * index, value);</span>
1674     }
1675 
1676     /**
1677      * Read an int from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1678      * &lt;p&gt;
1679      * This is equivalent to the following code:
1680      * &lt;blockquote&gt;&lt;pre&gt;{@code
1681     int value = getIntAtOffset_BE(addr, 4 * index);
1682      * }&lt;/pre&gt;&lt;/blockquote&gt;
1683      * @param addr base address.
1684      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1685      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1686      */
1687     public static int getIntAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1688         return getIntAtOffset_BE(addr, 4 * index);</span>
1689     }
1690 
1691     /**
1692      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1693      * &lt;p&gt;
1694      * This is equivalent to the following code:
1695      * &lt;blockquote&gt;&lt;pre&gt;{@code
1696     setIntAtOffset_BE(addr, 4 * index, value);
1697      * }&lt;/pre&gt;&lt;/blockquote&gt;
1698      * @param addr base address.
1699      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1700      * @param value the int value to be written.
1701      */
1702     public static void setIntAtIndex_BE(MemoryAddress addr, long index, int value) {
<span class="line-modified">1703         setIntAtOffset_BE(addr, 4 * index, value);</span>
1704     }
1705 
1706     /**
1707      * Read a float from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1708      * &lt;p&gt;
1709      * This is equivalent to the following code:
1710      * &lt;blockquote&gt;&lt;pre&gt;{@code
1711     float value = getFloatAtOffset_BE(addr, 4 * index);
1712      * }&lt;/pre&gt;&lt;/blockquote&gt;
1713      * @param addr base address.
1714      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1715      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1716      */
1717     public static float getFloatAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1718         return getFloatAtOffset_BE(addr, 4 * index);</span>
1719     }
1720 
1721     /**
1722      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1723      * &lt;p&gt;
1724      * This is equivalent to the following code:
1725      * &lt;blockquote&gt;&lt;pre&gt;{@code
1726     setFloatAtOffset_BE(addr, 4 * index, value);
1727      * }&lt;/pre&gt;&lt;/blockquote&gt;
1728      * @param addr base address.
1729      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1730      * @param value the float value to be written.
1731      */
1732     public static void setFloatAtIndex_BE(MemoryAddress addr, long index, float value) {
<span class="line-modified">1733         setFloatAtOffset_BE(addr, 4 * index, value);</span>
1734     }
1735 
1736     /**
1737      * Read a long from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1738      * &lt;p&gt;
1739      * This is equivalent to the following code:
1740      * &lt;blockquote&gt;&lt;pre&gt;{@code
1741     return getLongAtOffset_BE(addr, 8 * index);
1742      * }&lt;/pre&gt;&lt;/blockquote&gt;
1743      * @param addr base address.
1744      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1745      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1746      */
1747     public static long getLongAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1748         return getLongAtOffset_BE(addr, 8 * index);</span>
1749     }
1750 
1751     /**
1752      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1753      * &lt;p&gt;
1754      * This is equivalent to the following code:
1755      * &lt;blockquote&gt;&lt;pre&gt;{@code
1756     setLongAtOffset_BE(addr, 8 * index, value);
1757      * }&lt;/pre&gt;&lt;/blockquote&gt;
1758      * @param addr base address.
1759      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1760      * @param value the long value to be written.
1761      */
1762     public static void setLongAtIndex_BE(MemoryAddress addr, long index, long value) {
<span class="line-modified">1763         setLongAtOffset_BE(addr, 8 * index, value);</span>
1764     }
1765 
1766     /**
1767      * Read a double from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1768      * &lt;p&gt;
1769      * This is equivalent to the following code:
1770      * &lt;blockquote&gt;&lt;pre&gt;{@code
1771     return getDoubleAtOffset_BE(addr, 8 * index);
1772      * }&lt;/pre&gt;&lt;/blockquote&gt;
1773      * @param addr base address.
1774      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1775      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1776      */
1777     public static double getDoubleAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1778         return getDoubleAtOffset_BE(addr, 8 * index);</span>
1779     }
1780 
1781     /**
1782      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1783      * &lt;p&gt;
1784      * This is equivalent to the following code:
1785      * &lt;blockquote&gt;&lt;pre&gt;{@code
1786     setDoubleAtOffset_BE(addr, 8 * index, value);
1787      * }&lt;/pre&gt;&lt;/blockquote&gt;
1788      * @param addr base address.
1789      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1790      * @param value the double value to be written.
1791      */
1792     public static void setDoubleAtIndex_BE(MemoryAddress addr, long index, double value) {
<span class="line-modified">1793         setDoubleAtOffset_BE(addr, 8 * index, value);</span>
1794     }
1795 
1796     /**
1797      * Read a byte from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1798      * &lt;p&gt;
1799      * This is equivalent to the following code:
1800      * &lt;blockquote&gt;&lt;pre&gt;{@code
1801     byte value = getByteAtOffset(addr, index);
1802      * }&lt;/pre&gt;&lt;/blockquote&gt;
1803      *
1804      * @param addr base address.
1805      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1806      * @return a byte value read from {@code addr} at the element index specified by {@code index}.
1807      */
1808     public static byte getByteAtIndex(MemoryAddress addr, long index) {
1809         return getByteAtOffset(addr, index);
1810     }
1811 
1812     /**
1813      * Writes a byte at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
</pre>
<hr />
<pre>
1819      * @param addr base address.
1820      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1821      * @param value the byte value to be written.
1822      */
1823     public static void setByteAtIndex(MemoryAddress addr, long index, byte value) {
1824         setByteAtOffset(addr, index, value);
1825     }
1826 
1827     /**
1828      * Read a char from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1829      * &lt;p&gt;
1830      * This is equivalent to the following code:
1831      * &lt;blockquote&gt;&lt;pre&gt;{@code
1832     char value = getCharAtOffset(addr, 2 * index);
1833      * }&lt;/pre&gt;&lt;/blockquote&gt;
1834      * @param addr base address.
1835      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1836      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1837      */
1838     public static char getCharAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1839         return getCharAtOffset(addr, 2 * index);</span>
1840     }
1841 
1842     /**
1843      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1844      * &lt;p&gt;
1845      * This is equivalent to the following code:
1846      * &lt;blockquote&gt;&lt;pre&gt;{@code
1847     setCharAtOffset(addr, 2 * index, value);
1848      * }&lt;/pre&gt;&lt;/blockquote&gt;
1849      * @param addr base address.
1850      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1851      * @param value the char value to be written.
1852      */
1853     public static void setCharAtIndex(MemoryAddress addr, long index, char value) {
<span class="line-modified">1854         setCharAtOffset(addr, 2 * index, value);</span>
1855     }
1856 
1857     /**
1858      * Read a short from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1859      * &lt;p&gt;
1860      * This is equivalent to the following code:
1861      * &lt;blockquote&gt;&lt;pre&gt;{@code
1862     short value = getShortAtOffset(addr, 2 * index);
1863      * }&lt;/pre&gt;&lt;/blockquote&gt;
1864      * @param addr base address.
1865      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1866      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1867      */
1868     public static short getShortAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1869         return getShortAtOffset(addr, 2 * index);</span>
1870     }
1871 
1872     /**
1873      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1874      * &lt;p&gt;
1875      * This is equivalent to the following code:
1876      * &lt;blockquote&gt;&lt;pre&gt;{@code
1877     setShortAtOffset(addr, 2 * index, value);
1878      * }&lt;/pre&gt;&lt;/blockquote&gt;
1879      * @param addr base address.
1880      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1881      * @param value the short value to be written.
1882      */
1883     public static void setShortAtIndex(MemoryAddress addr, long index, short value) {
<span class="line-modified">1884         setShortAtOffset(addr, 2 * index, value);</span>
1885     }
1886 
1887     /**
1888      * Read an int from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1889      * &lt;p&gt;
1890      * This is equivalent to the following code:
1891      * &lt;blockquote&gt;&lt;pre&gt;{@code
1892     int value = getIntAtOffset(addr, 4 * index);
1893      * }&lt;/pre&gt;&lt;/blockquote&gt;
1894      * @param addr base address.
1895      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1896      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1897      */
1898     public static int getIntAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1899         return getIntAtOffset(addr, 4 * index);</span>
1900     }
1901 
1902     /**
1903      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1904      * &lt;p&gt;
1905      * This is equivalent to the following code:
1906      * &lt;blockquote&gt;&lt;pre&gt;{@code
1907     setIntAtOffset(addr, 4 * index, value);
1908      * }&lt;/pre&gt;&lt;/blockquote&gt;
1909      * @param addr base address.
1910      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1911      * @param value the int value to be written.
1912      */
1913     public static void setIntAtIndex(MemoryAddress addr, long index, int value) {
<span class="line-modified">1914         setIntAtOffset(addr, 4 * index, value);</span>
1915     }
1916 
1917     /**
1918      * Read a float from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1919      * &lt;p&gt;
1920      * This is equivalent to the following code:
1921      * &lt;blockquote&gt;&lt;pre&gt;{@code
1922     float value = getFloatAtOffset(addr, 4 * index);
1923      * }&lt;/pre&gt;&lt;/blockquote&gt;
1924      * @param addr base address.
1925      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1926      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1927      */
1928     public static float getFloatAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1929         return getFloatAtOffset(addr, 4 * index);</span>
1930     }
1931 
1932     /**
1933      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1934      * &lt;p&gt;
1935      * This is equivalent to the following code:
1936      * &lt;blockquote&gt;&lt;pre&gt;{@code
1937     setFloatAtOffset(addr, 4 * index, value);
1938      * }&lt;/pre&gt;&lt;/blockquote&gt;
1939      * @param addr base address.
1940      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1941      * @param value the float value to be written.
1942      */
1943     public static void setFloatAtIndex(MemoryAddress addr, long index, float value) {
<span class="line-modified">1944         setFloatAtOffset(addr, 4 * index, value);</span>
1945     }
1946 
1947     /**
1948      * Read a long from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1949      * &lt;p&gt;
1950      * This is equivalent to the following code:
1951      * &lt;blockquote&gt;&lt;pre&gt;{@code
1952     return getLongAtOffset(addr, 8 * index);
1953      * }&lt;/pre&gt;&lt;/blockquote&gt;
1954      * @param addr base address.
1955      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1956      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1957      */
1958     public static long getLongAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1959         return getLongAtOffset(addr, 8 * index);</span>
1960     }
1961 
1962     /**
1963      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1964      * &lt;p&gt;
1965      * This is equivalent to the following code:
1966      * &lt;blockquote&gt;&lt;pre&gt;{@code
1967     setLongAtOffset(addr, 8 * index, value);
1968      * }&lt;/pre&gt;&lt;/blockquote&gt;
1969      * @param addr base address.
1970      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1971      * @param value the long value to be written.
1972      */
1973     public static void setLongAtIndex(MemoryAddress addr, long index, long value) {
<span class="line-modified">1974         setLongAtOffset(addr, 8 * index, value);</span>
1975     }
1976 
1977     /**
1978      * Read a double from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1979      * &lt;p&gt;
1980      * This is equivalent to the following code:
1981      * &lt;blockquote&gt;&lt;pre&gt;{@code
1982     return getDoubleAtOffset(addr, 8 * index);
1983      * }&lt;/pre&gt;&lt;/blockquote&gt;
1984      * @param addr base address.
1985      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1986      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1987      */
1988     public static double getDoubleAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1989         return getDoubleAtOffset(addr, 8 * index);</span>
1990     }
1991 
1992     /**
1993      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1994      * &lt;p&gt;
1995      * This is equivalent to the following code:
1996      * &lt;blockquote&gt;&lt;pre&gt;{@code
1997     setDoubleAtOffset(addr, 8 * index, value);
1998      * }&lt;/pre&gt;&lt;/blockquote&gt;
1999      * @param addr base address.
2000      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2001      * @param value the double value to be written.
2002      */
2003     public static void setDoubleAtIndex(MemoryAddress addr, long index, double value) {
<span class="line-modified">2004         setDoubleAtOffset(addr, 8 * index, value);</span>
2005     }
2006 
2007     /**
2008      * Read a memory address from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
2009      * &lt;p&gt;
2010      * This is equivalent to the following code:
2011      * &lt;blockquote&gt;&lt;pre&gt;{@code
2012     return getAddressAtOffset(addr, index * 8);
2013      * }&lt;/pre&gt;&lt;/blockquote&gt;
2014      * @param addr base address.
2015      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2016      * @return a memory address read from {@code addr} at the element index specified by {@code index}.
2017      */
2018     public static MemoryAddress getAddressAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">2019         return getAddressAtOffset(addr, index * 8);</span>
2020     }
2021 
2022     /**
2023      * Writes a memory address at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
2024      * &lt;p&gt;
2025      * This is equivalent to the following code:
2026      * &lt;blockquote&gt;&lt;pre&gt;{@code
2027     setAddressAtOffset(addr, index * 8, value);
2028      * }&lt;/pre&gt;&lt;/blockquote&gt;
2029      * @param addr base address.
2030      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2031      * @param value the memory address to be written.
2032      */
2033     public static void setAddressAtIndex(MemoryAddress addr, long index, MemoryAddress value) {
<span class="line-modified">2034         setAddressAtOffset(addr, index * 8, value);</span>









2035     }
2036 }
</pre>
</td>
<td>
<hr />
<pre>
   1 package jdk.incubator.foreign;
   2 
<span class="line-added">   3 import jdk.internal.vm.annotation.ForceInline;</span>
<span class="line-added">   4 </span>
   5 import java.lang.invoke.VarHandle;
   6 import java.nio.ByteOrder;
   7 
   8 /**
   9  * This class defines ready-made static accessors which can be used to dereference memory segments in many ways.
  10  * &lt;p&gt;
  11  * The most primitive accessors (see {@link #getIntAtOffset(MemoryAddress, long)} (MemoryAddress, long)}) take a &lt;em&gt;base&lt;/em&gt; address and an offset (expressed in bytes).
  12  * The final address at which the dereference will occur will be computed by offsetting the base address by
  13  * the specified offset, as if by calling {@link MemoryAddress#addOffset(long)} on the specified base address.
  14  * &lt;p&gt;
  15  * In cases where no offset is required, overloads are provided (see {@link #getInt(MemoryAddress)}) so that
  16  * clients can omit the offset coordinate.
  17  * &lt;p&gt;
  18  * To help dereferencing in array-like use cases (e.g. where the layout of a given memory segment is a sequence
  19  * layout of given size an element count), higher-level overloads are also provided (see {@link #getIntAtIndex(MemoryAddress, long)}),
  20  * which take an &lt;em&gt;base&lt;/em&gt; address and a &lt;em&gt;logical&lt;/em&gt; element index. The formula to obtain the byte offset {@code O} from an
  21  * index {@code I} is given by {@code O = I * S} where {@code S} is the size (expressed in bytes) of the element to
  22  * be dereferenced.
  23  */
  24 public final class MemoryAccess {
</pre>
<hr />
<pre>
1399      * @param addr base address.
1400      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1401      * @param value the byte value to be written.
1402      */
1403     public static void setByteAtIndex_LE(MemoryAddress addr, long index, byte value) {
1404         setByteAtOffset_LE(addr, index, value);
1405     }
1406 
1407     /**
1408      * Read a char from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1409      * &lt;p&gt;
1410      * This is equivalent to the following code:
1411      * &lt;blockquote&gt;&lt;pre&gt;{@code
1412     char value = getCharAtOffset_LE(addr, 2 * index);
1413      * }&lt;/pre&gt;&lt;/blockquote&gt;
1414      * @param addr base address.
1415      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1416      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1417      */
1418     public static char getCharAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1419         return getCharAtOffset_LE(addr, scale(index, 2));</span>
1420     }
1421 
1422     /**
1423      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1424      * &lt;p&gt;
1425      * This is equivalent to the following code:
1426      * &lt;blockquote&gt;&lt;pre&gt;{@code
1427     setCharAtOffset_LE(addr, 2 * index, value);
1428      * }&lt;/pre&gt;&lt;/blockquote&gt;
1429      * @param addr base address.
1430      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1431      * @param value the char value to be written.
1432      */
1433     public static void setCharAtIndex_LE(MemoryAddress addr, long index, char value) {
<span class="line-modified">1434         setCharAtOffset_LE(addr, scale(index, 2), value);</span>
1435     }
1436 
1437     /**
1438      * Read a short from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1439      * &lt;p&gt;
1440      * This is equivalent to the following code:
1441      * &lt;blockquote&gt;&lt;pre&gt;{@code
1442     short value = getShortAtOffset_LE(addr, 2 * index);
1443      * }&lt;/pre&gt;&lt;/blockquote&gt;
1444      * @param addr base address.
1445      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1446      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1447      */
1448     public static short getShortAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1449         return getShortAtOffset_LE(addr, scale(index, 2));</span>
1450     }
1451 
1452     /**
1453      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1454      * &lt;p&gt;
1455      * This is equivalent to the following code:
1456      * &lt;blockquote&gt;&lt;pre&gt;{@code
1457     setShortAtOffset_LE(addr, 2 * index, value);
1458      * }&lt;/pre&gt;&lt;/blockquote&gt;
1459      * @param addr base address.
1460      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1461      * @param value the short value to be written.
1462      */
1463     public static void setShortAtIndex_LE(MemoryAddress addr, long index, short value) {
<span class="line-modified">1464         setShortAtOffset_LE(addr, scale(index, 2), value);</span>
1465     }
1466 
1467     /**
1468      * Read an int from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1469      * &lt;p&gt;
1470      * This is equivalent to the following code:
1471      * &lt;blockquote&gt;&lt;pre&gt;{@code
1472     int value = getIntAtOffset_LE(addr, 4 * index);
1473      * }&lt;/pre&gt;&lt;/blockquote&gt;
1474      * @param addr base address.
1475      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1476      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1477      */
1478     public static int getIntAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1479         return getIntAtOffset_LE(addr, scale(index, 4));</span>
1480     }
1481 
1482     /**
1483      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1484      * &lt;p&gt;
1485      * This is equivalent to the following code:
1486      * &lt;blockquote&gt;&lt;pre&gt;{@code
1487     setIntAtOffset_LE(addr, 4 * index, value);
1488      * }&lt;/pre&gt;&lt;/blockquote&gt;
1489      * @param addr base address.
1490      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1491      * @param value the int value to be written.
1492      */
1493     public static void setIntAtIndex_LE(MemoryAddress addr, long index, int value) {
<span class="line-modified">1494         setIntAtOffset_LE(addr, scale(index, 4), value);</span>
1495     }
1496 
1497     /**
1498      * Read a float from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1499      * &lt;p&gt;
1500      * This is equivalent to the following code:
1501      * &lt;blockquote&gt;&lt;pre&gt;{@code
1502     float value = getFloatAtOffset_LE(addr, 4 * index);
1503      * }&lt;/pre&gt;&lt;/blockquote&gt;
1504      * @param addr base address.
1505      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1506      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1507      */
1508     public static float getFloatAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1509         return getFloatAtOffset_LE(addr, scale(index, 4));</span>
1510     }
1511 
1512     /**
1513      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1514      * &lt;p&gt;
1515      * This is equivalent to the following code:
1516      * &lt;blockquote&gt;&lt;pre&gt;{@code
1517     setFloatAtOffset_LE(addr, 4 * index, value);
1518      * }&lt;/pre&gt;&lt;/blockquote&gt;
1519      * @param addr base address.
1520      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1521      * @param value the float value to be written.
1522      */
1523     public static void setFloatAtIndex_LE(MemoryAddress addr, long index, float value) {
<span class="line-modified">1524         setFloatAtOffset_LE(addr, scale(index, 4), value);</span>
1525     }
1526 
1527     /**
1528      * Read a long from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1529      * &lt;p&gt;
1530      * This is equivalent to the following code:
1531      * &lt;blockquote&gt;&lt;pre&gt;{@code
1532     return getLongAtOffset_LE(addr, 8 * index);
1533      * }&lt;/pre&gt;&lt;/blockquote&gt;
1534      * @param addr base address.
1535      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1536      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1537      */
1538     public static long getLongAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1539         return getLongAtOffset_LE(addr, scale(index, 8));</span>
1540     }
1541 
1542     /**
1543      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1544      * &lt;p&gt;
1545      * This is equivalent to the following code:
1546      * &lt;blockquote&gt;&lt;pre&gt;{@code
1547     setLongAtOffset_LE(addr, 8 * index, value);
1548      * }&lt;/pre&gt;&lt;/blockquote&gt;
1549      * @param addr base address.
1550      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1551      * @param value the long value to be written.
1552      */
1553     public static void setLongAtIndex_LE(MemoryAddress addr, long index, long value) {
<span class="line-modified">1554         setLongAtOffset_LE(addr, scale(index, 8), value);</span>
1555     }
1556 
1557     /**
1558      * Read a double from given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1559      * &lt;p&gt;
1560      * This is equivalent to the following code:
1561      * &lt;blockquote&gt;&lt;pre&gt;{@code
1562     return getDoubleAtOffset_LE(addr, 8 * index);
1563      * }&lt;/pre&gt;&lt;/blockquote&gt;
1564      * @param addr base address.
1565      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1566      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1567      */
1568     public static double getDoubleAtIndex_LE(MemoryAddress addr, long index) {
<span class="line-modified">1569         return getDoubleAtOffset_LE(addr, scale(index, 8));</span>
1570     }
1571 
1572     /**
1573      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#LITTLE_ENDIAN}.
1574      * &lt;p&gt;
1575      * This is equivalent to the following code:
1576      * &lt;blockquote&gt;&lt;pre&gt;{@code
1577     setDoubleAtOffset_LE(addr, 8 * index, value);
1578      * }&lt;/pre&gt;&lt;/blockquote&gt;
1579      * @param addr base address.
1580      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1581      * @param value the double value to be written.
1582      */
1583     public static void setDoubleAtIndex_LE(MemoryAddress addr, long index, double value) {
<span class="line-modified">1584         setDoubleAtOffset_LE(addr, scale(index, 8), value);</span>
1585     }
1586 
1587     /**
1588      * Read a byte from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1589      * &lt;p&gt;
1590      * This is equivalent to the following code:
1591      * &lt;blockquote&gt;&lt;pre&gt;{@code
1592     byte value = getByteAtOffset_BE(addr, index);
1593      * }&lt;/pre&gt;&lt;/blockquote&gt;
1594      *
1595      * @param addr base address.
1596      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1597      * @return a byte value read from {@code addr} at the element index specified by {@code index}.
1598      */
1599     public static byte getByteAtIndex_BE(MemoryAddress addr, long index) {
1600         return getByteAtOffset_BE(addr, index);
1601     }
1602 
1603     /**
1604      * Writes a byte at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
</pre>
<hr />
<pre>
1610      * @param addr base address.
1611      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1612      * @param value the byte value to be written.
1613      */
1614     public static void setByteAtIndex_BE(MemoryAddress addr, long index, byte value) {
1615         setByteAtOffset_BE(addr, index, value);
1616     }
1617 
1618     /**
1619      * Read a char from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1620      * &lt;p&gt;
1621      * This is equivalent to the following code:
1622      * &lt;blockquote&gt;&lt;pre&gt;{@code
1623     char value = getCharAtOffset_BE(addr, 2 * index);
1624      * }&lt;/pre&gt;&lt;/blockquote&gt;
1625      * @param addr base address.
1626      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1627      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1628      */
1629     public static char getCharAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1630         return getCharAtOffset_BE(addr, scale(index, 2));</span>
1631     }
1632 
1633     /**
1634      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1635      * &lt;p&gt;
1636      * This is equivalent to the following code:
1637      * &lt;blockquote&gt;&lt;pre&gt;{@code
1638     setCharAtOffset_BE(addr, 2 * index, value);
1639      * }&lt;/pre&gt;&lt;/blockquote&gt;
1640      * @param addr base address.
1641      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1642      * @param value the char value to be written.
1643      */
1644     public static void setCharAtIndex_BE(MemoryAddress addr, long index, char value) {
<span class="line-modified">1645         setCharAtOffset_BE(addr, scale(index, 2), value);</span>
1646     }
1647 
1648     /**
1649      * Read a short from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1650      * &lt;p&gt;
1651      * This is equivalent to the following code:
1652      * &lt;blockquote&gt;&lt;pre&gt;{@code
1653     short value = getShortAtOffset_BE(addr, 2 * index);
1654      * }&lt;/pre&gt;&lt;/blockquote&gt;
1655      * @param addr base address.
1656      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1657      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1658      */
1659     public static short getShortAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1660         return getShortAtOffset_BE(addr, scale(index, 2));</span>
1661     }
1662 
1663     /**
1664      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1665      * &lt;p&gt;
1666      * This is equivalent to the following code:
1667      * &lt;blockquote&gt;&lt;pre&gt;{@code
1668     setShortAtOffset_BE(addr, 2 * index, value);
1669      * }&lt;/pre&gt;&lt;/blockquote&gt;
1670      * @param addr base address.
1671      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1672      * @param value the short value to be written.
1673      */
1674     public static void setShortAtIndex_BE(MemoryAddress addr, long index, short value) {
<span class="line-modified">1675         setShortAtOffset_BE(addr, scale(index, 2), value);</span>
1676     }
1677 
1678     /**
1679      * Read an int from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1680      * &lt;p&gt;
1681      * This is equivalent to the following code:
1682      * &lt;blockquote&gt;&lt;pre&gt;{@code
1683     int value = getIntAtOffset_BE(addr, 4 * index);
1684      * }&lt;/pre&gt;&lt;/blockquote&gt;
1685      * @param addr base address.
1686      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1687      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1688      */
1689     public static int getIntAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1690         return getIntAtOffset_BE(addr, scale(index, 4));</span>
1691     }
1692 
1693     /**
1694      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1695      * &lt;p&gt;
1696      * This is equivalent to the following code:
1697      * &lt;blockquote&gt;&lt;pre&gt;{@code
1698     setIntAtOffset_BE(addr, 4 * index, value);
1699      * }&lt;/pre&gt;&lt;/blockquote&gt;
1700      * @param addr base address.
1701      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1702      * @param value the int value to be written.
1703      */
1704     public static void setIntAtIndex_BE(MemoryAddress addr, long index, int value) {
<span class="line-modified">1705         setIntAtOffset_BE(addr, scale(index, 4), value);</span>
1706     }
1707 
1708     /**
1709      * Read a float from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1710      * &lt;p&gt;
1711      * This is equivalent to the following code:
1712      * &lt;blockquote&gt;&lt;pre&gt;{@code
1713     float value = getFloatAtOffset_BE(addr, 4 * index);
1714      * }&lt;/pre&gt;&lt;/blockquote&gt;
1715      * @param addr base address.
1716      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1717      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1718      */
1719     public static float getFloatAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1720         return getFloatAtOffset_BE(addr, scale(index, 4));</span>
1721     }
1722 
1723     /**
1724      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1725      * &lt;p&gt;
1726      * This is equivalent to the following code:
1727      * &lt;blockquote&gt;&lt;pre&gt;{@code
1728     setFloatAtOffset_BE(addr, 4 * index, value);
1729      * }&lt;/pre&gt;&lt;/blockquote&gt;
1730      * @param addr base address.
1731      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1732      * @param value the float value to be written.
1733      */
1734     public static void setFloatAtIndex_BE(MemoryAddress addr, long index, float value) {
<span class="line-modified">1735         setFloatAtOffset_BE(addr, scale(index, 4), value);</span>
1736     }
1737 
1738     /**
1739      * Read a long from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1740      * &lt;p&gt;
1741      * This is equivalent to the following code:
1742      * &lt;blockquote&gt;&lt;pre&gt;{@code
1743     return getLongAtOffset_BE(addr, 8 * index);
1744      * }&lt;/pre&gt;&lt;/blockquote&gt;
1745      * @param addr base address.
1746      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1747      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1748      */
1749     public static long getLongAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1750         return getLongAtOffset_BE(addr, scale(index, 8));</span>
1751     }
1752 
1753     /**
1754      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1755      * &lt;p&gt;
1756      * This is equivalent to the following code:
1757      * &lt;blockquote&gt;&lt;pre&gt;{@code
1758     setLongAtOffset_BE(addr, 8 * index, value);
1759      * }&lt;/pre&gt;&lt;/blockquote&gt;
1760      * @param addr base address.
1761      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1762      * @param value the long value to be written.
1763      */
1764     public static void setLongAtIndex_BE(MemoryAddress addr, long index, long value) {
<span class="line-modified">1765         setLongAtOffset_BE(addr, scale(index, 8), value);</span>
1766     }
1767 
1768     /**
1769      * Read a double from given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1770      * &lt;p&gt;
1771      * This is equivalent to the following code:
1772      * &lt;blockquote&gt;&lt;pre&gt;{@code
1773     return getDoubleAtOffset_BE(addr, 8 * index);
1774      * }&lt;/pre&gt;&lt;/blockquote&gt;
1775      * @param addr base address.
1776      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1777      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1778      */
1779     public static double getDoubleAtIndex_BE(MemoryAddress addr, long index) {
<span class="line-modified">1780         return getDoubleAtOffset_BE(addr, scale(index, 8));</span>
1781     }
1782 
1783     /**
1784      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#BIG_ENDIAN}.
1785      * &lt;p&gt;
1786      * This is equivalent to the following code:
1787      * &lt;blockquote&gt;&lt;pre&gt;{@code
1788     setDoubleAtOffset_BE(addr, 8 * index, value);
1789      * }&lt;/pre&gt;&lt;/blockquote&gt;
1790      * @param addr base address.
1791      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1792      * @param value the double value to be written.
1793      */
1794     public static void setDoubleAtIndex_BE(MemoryAddress addr, long index, double value) {
<span class="line-modified">1795         setDoubleAtOffset_BE(addr, scale(index, 8), value);</span>
1796     }
1797 
1798     /**
1799      * Read a byte from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1800      * &lt;p&gt;
1801      * This is equivalent to the following code:
1802      * &lt;blockquote&gt;&lt;pre&gt;{@code
1803     byte value = getByteAtOffset(addr, index);
1804      * }&lt;/pre&gt;&lt;/blockquote&gt;
1805      *
1806      * @param addr base address.
1807      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1808      * @return a byte value read from {@code addr} at the element index specified by {@code index}.
1809      */
1810     public static byte getByteAtIndex(MemoryAddress addr, long index) {
1811         return getByteAtOffset(addr, index);
1812     }
1813 
1814     /**
1815      * Writes a byte at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
</pre>
<hr />
<pre>
1821      * @param addr base address.
1822      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index)}.
1823      * @param value the byte value to be written.
1824      */
1825     public static void setByteAtIndex(MemoryAddress addr, long index, byte value) {
1826         setByteAtOffset(addr, index, value);
1827     }
1828 
1829     /**
1830      * Read a char from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1831      * &lt;p&gt;
1832      * This is equivalent to the following code:
1833      * &lt;blockquote&gt;&lt;pre&gt;{@code
1834     char value = getCharAtOffset(addr, 2 * index);
1835      * }&lt;/pre&gt;&lt;/blockquote&gt;
1836      * @param addr base address.
1837      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1838      * @return a char value read from {@code addr} at the element index specified by {@code index}.
1839      */
1840     public static char getCharAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1841         return getCharAtOffset(addr, scale(index, 2));</span>
1842     }
1843 
1844     /**
1845      * Writes a char at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1846      * &lt;p&gt;
1847      * This is equivalent to the following code:
1848      * &lt;blockquote&gt;&lt;pre&gt;{@code
1849     setCharAtOffset(addr, 2 * index, value);
1850      * }&lt;/pre&gt;&lt;/blockquote&gt;
1851      * @param addr base address.
1852      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1853      * @param value the char value to be written.
1854      */
1855     public static void setCharAtIndex(MemoryAddress addr, long index, char value) {
<span class="line-modified">1856         setCharAtOffset(addr, scale(index, 2), value);</span>
1857     }
1858 
1859     /**
1860      * Read a short from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1861      * &lt;p&gt;
1862      * This is equivalent to the following code:
1863      * &lt;blockquote&gt;&lt;pre&gt;{@code
1864     short value = getShortAtOffset(addr, 2 * index);
1865      * }&lt;/pre&gt;&lt;/blockquote&gt;
1866      * @param addr base address.
1867      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1868      * @return a short value read from {@code addr} at the element index specified by {@code index}.
1869      */
1870     public static short getShortAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1871         return getShortAtOffset(addr, scale(index, 2));</span>
1872     }
1873 
1874     /**
1875      * Writes a short at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1876      * &lt;p&gt;
1877      * This is equivalent to the following code:
1878      * &lt;blockquote&gt;&lt;pre&gt;{@code
1879     setShortAtOffset(addr, 2 * index, value);
1880      * }&lt;/pre&gt;&lt;/blockquote&gt;
1881      * @param addr base address.
1882      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 2)}.
1883      * @param value the short value to be written.
1884      */
1885     public static void setShortAtIndex(MemoryAddress addr, long index, short value) {
<span class="line-modified">1886         setShortAtOffset(addr, scale(index, 2), value);</span>
1887     }
1888 
1889     /**
1890      * Read an int from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1891      * &lt;p&gt;
1892      * This is equivalent to the following code:
1893      * &lt;blockquote&gt;&lt;pre&gt;{@code
1894     int value = getIntAtOffset(addr, 4 * index);
1895      * }&lt;/pre&gt;&lt;/blockquote&gt;
1896      * @param addr base address.
1897      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1898      * @return an int value read from {@code addr} at the element index specified by {@code index}.
1899      */
1900     public static int getIntAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1901         return getIntAtOffset(addr, scale(index, 4));</span>
1902     }
1903 
1904     /**
1905      * Writes an int at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1906      * &lt;p&gt;
1907      * This is equivalent to the following code:
1908      * &lt;blockquote&gt;&lt;pre&gt;{@code
1909     setIntAtOffset(addr, 4 * index, value);
1910      * }&lt;/pre&gt;&lt;/blockquote&gt;
1911      * @param addr base address.
1912      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1913      * @param value the int value to be written.
1914      */
1915     public static void setIntAtIndex(MemoryAddress addr, long index, int value) {
<span class="line-modified">1916         setIntAtOffset(addr, scale(index, 4), value);</span>
1917     }
1918 
1919     /**
1920      * Read a float from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1921      * &lt;p&gt;
1922      * This is equivalent to the following code:
1923      * &lt;blockquote&gt;&lt;pre&gt;{@code
1924     float value = getFloatAtOffset(addr, 4 * index);
1925      * }&lt;/pre&gt;&lt;/blockquote&gt;
1926      * @param addr base address.
1927      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1928      * @return a float value read from {@code addr} at the element index specified by {@code index}.
1929      */
1930     public static float getFloatAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1931         return getFloatAtOffset(addr, scale(index, 4));</span>
1932     }
1933 
1934     /**
1935      * Writes a float at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1936      * &lt;p&gt;
1937      * This is equivalent to the following code:
1938      * &lt;blockquote&gt;&lt;pre&gt;{@code
1939     setFloatAtOffset(addr, 4 * index, value);
1940      * }&lt;/pre&gt;&lt;/blockquote&gt;
1941      * @param addr base address.
1942      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 4)}.
1943      * @param value the float value to be written.
1944      */
1945     public static void setFloatAtIndex(MemoryAddress addr, long index, float value) {
<span class="line-modified">1946         setFloatAtOffset(addr, scale(index, 4), value);</span>
1947     }
1948 
1949     /**
1950      * Read a long from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1951      * &lt;p&gt;
1952      * This is equivalent to the following code:
1953      * &lt;blockquote&gt;&lt;pre&gt;{@code
1954     return getLongAtOffset(addr, 8 * index);
1955      * }&lt;/pre&gt;&lt;/blockquote&gt;
1956      * @param addr base address.
1957      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1958      * @return a long value read from {@code addr} at the element index specified by {@code index}.
1959      */
1960     public static long getLongAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1961         return getLongAtOffset(addr, scale(index, 8));</span>
1962     }
1963 
1964     /**
1965      * Writes a long at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1966      * &lt;p&gt;
1967      * This is equivalent to the following code:
1968      * &lt;blockquote&gt;&lt;pre&gt;{@code
1969     setLongAtOffset(addr, 8 * index, value);
1970      * }&lt;/pre&gt;&lt;/blockquote&gt;
1971      * @param addr base address.
1972      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1973      * @param value the long value to be written.
1974      */
1975     public static void setLongAtIndex(MemoryAddress addr, long index, long value) {
<span class="line-modified">1976         setLongAtOffset(addr, scale(index, 8), value);</span>
1977     }
1978 
1979     /**
1980      * Read a double from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1981      * &lt;p&gt;
1982      * This is equivalent to the following code:
1983      * &lt;blockquote&gt;&lt;pre&gt;{@code
1984     return getDoubleAtOffset(addr, 8 * index);
1985      * }&lt;/pre&gt;&lt;/blockquote&gt;
1986      * @param addr base address.
1987      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
1988      * @return a double value read from {@code addr} at the element index specified by {@code index}.
1989      */
1990     public static double getDoubleAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">1991         return getDoubleAtOffset(addr, scale(index, 8));</span>
1992     }
1993 
1994     /**
1995      * Writes a double at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
1996      * &lt;p&gt;
1997      * This is equivalent to the following code:
1998      * &lt;blockquote&gt;&lt;pre&gt;{@code
1999     setDoubleAtOffset(addr, 8 * index, value);
2000      * }&lt;/pre&gt;&lt;/blockquote&gt;
2001      * @param addr base address.
2002      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2003      * @param value the double value to be written.
2004      */
2005     public static void setDoubleAtIndex(MemoryAddress addr, long index, double value) {
<span class="line-modified">2006         setDoubleAtOffset(addr, scale(index, 8), value);</span>
2007     }
2008 
2009     /**
2010      * Read a memory address from given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
2011      * &lt;p&gt;
2012      * This is equivalent to the following code:
2013      * &lt;blockquote&gt;&lt;pre&gt;{@code
2014     return getAddressAtOffset(addr, index * 8);
2015      * }&lt;/pre&gt;&lt;/blockquote&gt;
2016      * @param addr base address.
2017      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2018      * @return a memory address read from {@code addr} at the element index specified by {@code index}.
2019      */
2020     public static MemoryAddress getAddressAtIndex(MemoryAddress addr, long index) {
<span class="line-modified">2021         return getAddressAtOffset(addr, scale(index, 8));</span>
2022     }
2023 
2024     /**
2025      * Writes a memory address at given address and element index, with byte order set to {@link ByteOrder#nativeOrder()}.
2026      * &lt;p&gt;
2027      * This is equivalent to the following code:
2028      * &lt;blockquote&gt;&lt;pre&gt;{@code
2029     setAddressAtOffset(addr, index * 8, value);
2030      * }&lt;/pre&gt;&lt;/blockquote&gt;
2031      * @param addr base address.
2032      * @param index element index (relative to {@code addr}). The final address of this read operation can be expressed as {@code addr.addOffset(index * 8)}.
2033      * @param value the memory address to be written.
2034      */
2035     public static void setAddressAtIndex(MemoryAddress addr, long index, MemoryAddress value) {
<span class="line-modified">2036         setAddressAtOffset(addr, scale(index, 8), value);</span>
<span class="line-added">2037     }</span>
<span class="line-added">2038 </span>
<span class="line-added">2039     @ForceInline</span>
<span class="line-added">2040     private static long scale(long index, int size) {</span>
<span class="line-added">2041         if (index &lt; Integer.MAX_VALUE) {</span>
<span class="line-added">2042             return (int)index * size;</span>
<span class="line-added">2043         } else {</span>
<span class="line-added">2044             return index * size;</span>
<span class="line-added">2045         }</span>
2046     }
2047 }
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../test/micro/org/openjdk/bench/jdk/incubator/foreign/LoopOverNonConstant.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>