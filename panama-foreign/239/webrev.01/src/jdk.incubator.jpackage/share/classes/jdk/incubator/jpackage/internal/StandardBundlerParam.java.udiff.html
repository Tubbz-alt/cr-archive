<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/jdk.incubator.jpackage/share/classes/jdk/incubator/jpackage/internal/StandardBundlerParam.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ScriptRunner.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="resources/HelpResources_ja.properties.udiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.incubator.jpackage/share/classes/jdk/incubator/jpackage/internal/StandardBundlerParam.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -118,16 +118,16 @@</span>
                          return LAUNCHER_DATA.fetchFrom(params).qualifiedClassName();
                      },
                      (s, p) -&gt; s
              );
  
<span class="udiff-line-modified-removed">-     static final StandardBundlerParam&lt;File&gt; PREDEFINED_RUNTIME_IMAGE =</span>
<span class="udiff-line-modified-added">+     static final StandardBundlerParam&lt;Path&gt; PREDEFINED_RUNTIME_IMAGE =</span>
              new StandardBundlerParam&lt;&gt;(
                      Arguments.CLIOptions.PREDEFINED_RUNTIME_IMAGE.getId(),
<span class="udiff-line-modified-removed">-                     File.class,</span>
<span class="udiff-line-modified-added">+                     Path.class,</span>
                      params -&gt; null,
<span class="udiff-line-modified-removed">-                     (s, p) -&gt; new File(s)</span>
<span class="udiff-line-modified-added">+                     (s, p) -&gt; Path.of(s)</span>
              );
  
      static final StandardBundlerParam&lt;String&gt; APP_NAME =
              new StandardBundlerParam&lt;&gt;(
                      Arguments.CLIOptions.NAME.getId(),
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -139,26 +139,26 @@</span>
                              if (idx &gt;= 0) {
                                  return s.substring(idx+1);
                              }
                              return s;
                          } else if (isRuntimeInstaller(params)) {
<span class="udiff-line-modified-removed">-                             File f = PREDEFINED_RUNTIME_IMAGE.fetchFrom(params);</span>
<span class="udiff-line-modified-added">+                             Path f = PREDEFINED_RUNTIME_IMAGE.fetchFrom(params);</span>
                              if (f != null) {
<span class="udiff-line-modified-removed">-                                 return f.getName();</span>
<span class="udiff-line-modified-added">+                                 return f.getFileName().toString();</span>
                              }
                          }
                          return null;
                      },
                      (s, p) -&gt; s
              );
  
<span class="udiff-line-modified-removed">-     static final StandardBundlerParam&lt;File&gt; ICON =</span>
<span class="udiff-line-modified-added">+     static final StandardBundlerParam&lt;Path&gt; ICON =</span>
              new StandardBundlerParam&lt;&gt;(
                      Arguments.CLIOptions.ICON.getId(),
<span class="udiff-line-modified-removed">-                     File.class,</span>
<span class="udiff-line-modified-added">+                     Path.class,</span>
                      params -&gt; null,
<span class="udiff-line-modified-removed">-                     (s, p) -&gt; new File(s)</span>
<span class="udiff-line-modified-added">+                     (s, p) -&gt; Path.of(s)</span>
              );
  
      static final StandardBundlerParam&lt;String&gt; VENDOR =
              new StandardBundlerParam&lt;&gt;(
                      Arguments.CLIOptions.VENDOR.getId(),
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -227,33 +227,35 @@</span>
                      String.class,
                      params -&gt; null,
                      (s, p) -&gt; s
              );
  
<span class="udiff-line-modified-removed">-     static final StandardBundlerParam&lt;File&gt; TEMP_ROOT =</span>
<span class="udiff-line-modified-added">+     static final StandardBundlerParam&lt;Path&gt; TEMP_ROOT =</span>
              new StandardBundlerParam&lt;&gt;(
                      Arguments.CLIOptions.TEMP_ROOT.getId(),
<span class="udiff-line-modified-removed">-                     File.class,</span>
<span class="udiff-line-modified-added">+                     Path.class,</span>
                      params -&gt; {
                          try {
<span class="udiff-line-modified-removed">-                             return Files.createTempDirectory(</span>
<span class="udiff-line-removed">-                                     &quot;jdk.incubator.jpackage&quot;).toFile();</span>
<span class="udiff-line-modified-added">+                             return Files.createTempDirectory(&quot;jdk.incubator.jpackage&quot;);</span>
                          } catch (IOException ioe) {
                              return null;
                          }
                      },
<span class="udiff-line-modified-removed">-                     (s, p) -&gt; new File(s)</span>
<span class="udiff-line-modified-added">+                     (s, p) -&gt; Path.of(s)</span>
              );
  
<span class="udiff-line-modified-removed">-     public static final StandardBundlerParam&lt;File&gt; CONFIG_ROOT =</span>
<span class="udiff-line-modified-added">+     public static final StandardBundlerParam&lt;Path&gt; CONFIG_ROOT =</span>
              new StandardBundlerParam&lt;&gt;(
                  &quot;configRoot&quot;,
<span class="udiff-line-modified-removed">-                 File.class,</span>
<span class="udiff-line-modified-added">+                 Path.class,</span>
                  params -&gt; {
<span class="udiff-line-modified-removed">-                     File root =</span>
<span class="udiff-line-modified-removed">-                             new File(TEMP_ROOT.fetchFrom(params), &quot;config&quot;);</span>
<span class="udiff-line-modified-removed">-                     root.mkdirs();</span>
<span class="udiff-line-modified-added">+                     Path root = TEMP_ROOT.fetchFrom(params).resolve(&quot;config&quot;);</span>
<span class="udiff-line-modified-added">+                     try {</span>
<span class="udiff-line-modified-added">+                         Files.createDirectories(root);</span>
<span class="udiff-line-added">+                     } catch (IOException ioe) {</span>
<span class="udiff-line-added">+                         return null;</span>
<span class="udiff-line-added">+                     }</span>
                      return root;
                  },
                  (s, p) -&gt; null
              );
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -275,32 +277,32 @@</span>
                      // valueOf(null) is false, and we actually do want null
                      (s, p) -&gt; (s == null || &quot;null&quot;.equalsIgnoreCase(s)) ?
                              true : Boolean.valueOf(s)
              );
  
<span class="udiff-line-modified-removed">-     static final StandardBundlerParam&lt;File&gt; RESOURCE_DIR =</span>
<span class="udiff-line-modified-added">+     static final StandardBundlerParam&lt;Path&gt; RESOURCE_DIR =</span>
              new StandardBundlerParam&lt;&gt;(
                      Arguments.CLIOptions.RESOURCE_DIR.getId(),
<span class="udiff-line-modified-removed">-                     File.class,</span>
<span class="udiff-line-modified-added">+                     Path.class,</span>
                      params -&gt; null,
<span class="udiff-line-modified-removed">-                     (s, p) -&gt; new File(s)</span>
<span class="udiff-line-modified-added">+                     (s, p) -&gt; Path.of(s)</span>
              );
  
      static final BundlerParamInfo&lt;String&gt; INSTALL_DIR =
              new StandardBundlerParam&lt;&gt;(
                      Arguments.CLIOptions.INSTALL_DIR.getId(),
                      String.class,
                       params -&gt; null,
                      (s, p) -&gt; s
      );
  
<span class="udiff-line-modified-removed">-     static final StandardBundlerParam&lt;File&gt; PREDEFINED_APP_IMAGE =</span>
<span class="udiff-line-modified-added">+     static final StandardBundlerParam&lt;Path&gt; PREDEFINED_APP_IMAGE =</span>
              new StandardBundlerParam&lt;&gt;(
              Arguments.CLIOptions.PREDEFINED_APP_IMAGE.getId(),
<span class="udiff-line-modified-removed">-             File.class,</span>
<span class="udiff-line-modified-added">+             Path.class,</span>
              params -&gt; null,
<span class="udiff-line-modified-removed">-             (s, p) -&gt; new File(s));</span>
<span class="udiff-line-modified-added">+             (s, p) -&gt; Path.of(s));</span>
  
      @SuppressWarnings(&quot;unchecked&quot;)
      static final StandardBundlerParam&lt;List&lt;Map&lt;String, ? super Object&gt;&gt;&gt; ADD_LAUNCHERS =
              new StandardBundlerParam&lt;&gt;(
                      Arguments.CLIOptions.ADD_LAUNCHER.getId(),
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -344,20 +346,20 @@</span>
  
      static final StandardBundlerParam&lt;String&gt; FA_DESCRIPTION =
              new StandardBundlerParam&lt;&gt;(
                      &quot;fileAssociation.description&quot;,
                      String.class,
<span class="udiff-line-modified-removed">-                     params -&gt; APP_NAME.fetchFrom(params) + &quot; File&quot;,</span>
<span class="udiff-line-modified-added">+                     params -&gt; APP_NAME.fetchFrom(params) + &quot; Path&quot;,</span>
                      null
              );
  
<span class="udiff-line-modified-removed">-     static final StandardBundlerParam&lt;File&gt; FA_ICON =</span>
<span class="udiff-line-modified-added">+     static final StandardBundlerParam&lt;Path&gt; FA_ICON =</span>
              new StandardBundlerParam&lt;&gt;(
                      &quot;fileAssociation.icon&quot;,
<span class="udiff-line-modified-removed">-                     File.class,</span>
<span class="udiff-line-modified-added">+                     Path.class,</span>
                      ICON::fetchFrom,
<span class="udiff-line-modified-removed">-                     (s, p) -&gt; new File(s)</span>
<span class="udiff-line-modified-added">+                     (s, p) -&gt; Path.of(s)</span>
              );
  
      @SuppressWarnings(&quot;unchecked&quot;)
      static final BundlerParamInfo&lt;List&lt;Path&gt;&gt; MODULE_PATH =
              new StandardBundlerParam&lt;&gt;(
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -447,13 +449,13 @@</span>
          // runtime installer requires --runtime-image, if this is false
          // here then we should have thrown error validating args.
          return params.containsKey(PREDEFINED_RUNTIME_IMAGE.getID());
      }
  
<span class="udiff-line-modified-removed">-     static File getPredefinedAppImage(Map&lt;String, ? super Object&gt; params) {</span>
<span class="udiff-line-modified-removed">-         File applicationImage = PREDEFINED_APP_IMAGE.fetchFrom(params);</span>
<span class="udiff-line-modified-removed">-         if (applicationImage != null &amp;&amp; !applicationImage.exists()) {</span>
<span class="udiff-line-modified-added">+     static Path getPredefinedAppImage(Map&lt;String, ? super Object&gt; params) {</span>
<span class="udiff-line-modified-added">+         Path applicationImage = PREDEFINED_APP_IMAGE.fetchFrom(params);</span>
<span class="udiff-line-modified-added">+         if (applicationImage != null &amp;&amp; !IOUtils.exists(applicationImage)) {</span>
              throw new RuntimeException(
                      MessageFormat.format(I18N.getString(
                              &quot;message.app-image-dir-does-not-exist&quot;),
                              PREDEFINED_APP_IMAGE.getID(),
                              applicationImage.toString()));
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -461,12 +463,12 @@</span>
          return applicationImage;
      }
  
      static void copyPredefinedRuntimeImage(Map&lt;String, ? super Object&gt; params,
              ApplicationLayout appLayout) throws IOException, ConfigException {
<span class="udiff-line-modified-removed">-         File topImage = PREDEFINED_RUNTIME_IMAGE.fetchFrom(params);</span>
<span class="udiff-line-modified-removed">-         if (!topImage.exists()) {</span>
<span class="udiff-line-modified-added">+         Path topImage = PREDEFINED_RUNTIME_IMAGE.fetchFrom(params);</span>
<span class="udiff-line-modified-added">+         if (!IOUtils.exists(topImage)) {</span>
              throw new ConfigException(
                      MessageFormat.format(I18N.getString(
                      &quot;message.runtime-image-dir-does-not-exist&quot;),
                      PREDEFINED_RUNTIME_IMAGE.getID(),
                      topImage.toString()),
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -475,21 +477,21 @@</span>
                      PREDEFINED_RUNTIME_IMAGE.getID()));
          }
  
          if (Platform.isMac()) {
              // On Mac topImage can be runtime root or runtime home.
<span class="udiff-line-modified-removed">-             Path runtimeHome = topImage.toPath().resolve(&quot;Contents/Home&quot;);</span>
<span class="udiff-line-modified-added">+             Path runtimeHome = topImage.resolve(&quot;Contents/Home&quot;);</span>
              if (Files.isDirectory(runtimeHome)) {
                  // topImage references runtime root, adjust it to pick data from
                  // runtime home
<span class="udiff-line-modified-removed">-                 topImage = runtimeHome.toFile();</span>
<span class="udiff-line-modified-added">+                 topImage = runtimeHome;</span>
              }
          }
  
          // copy whole runtime, need to skip jmods and src.zip
          final List&lt;String&gt; excludes = Arrays.asList(&quot;jmods&quot;, &quot;src.zip&quot;);
<span class="udiff-line-modified-removed">-         IOUtils.copyRecursive(topImage.toPath(),</span>
<span class="udiff-line-modified-added">+         IOUtils.copyRecursive(topImage,</span>
                  appLayout.runtimeHomeDirectory(), excludes);
  
          // if module-path given - copy modules to appDir/mods
          List&lt;Path&gt; modulePath = MODULE_PATH.fetchFrom(params);
          List&lt;Path&gt; defaultModulePath = getDefaultModulePath();
</pre>
<center><a href="ScriptRunner.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="resources/HelpResources_ja.properties.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>