<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff agent/src/main/java/org/openjdk/jmc/agent/impl/DefaultTransformRegistry.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../../../.classpath.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../resources/org/openjdk/jmc/agent/impl/jfrprobes_schema.xsd.sdiff.html" target="_top">next &gt;</a></center>    <h2>agent/src/main/java/org/openjdk/jmc/agent/impl/DefaultTransformRegistry.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 97 			PROBE_SCHEMA = factory
 98 					.newSchema(new StreamSource(DefaultTransformRegistry.class.getResourceAsStream(PROBE_SCHEMA_XSD)));
 99 		} catch (SAXException e) {
100 			throw new ExceptionInInitializerError(e);
101 		}
102 	}
103 
104 	@Override
105 	public boolean hasPendingTransforms(String className) {
106 		List&lt;TransformDescriptor&gt; transforms = transformData.get(className);
107 		if (transforms == null || !isPendingTransforms(transforms)) {
108 			return false;
109 		}
110 		return true;
111 	}
112 
113 	public static TransformRegistry empty() {
114 		return new DefaultTransformRegistry();
115 	}
116 
<span class="line-modified">117 	private static void validateProbeDefinition(InputStream in) throws XMLStreamException {</span>
118 		try {
119 			Validator validator = PROBE_SCHEMA.newValidator();
120 			validator.validate(new StreamSource(in));
121 		} catch (IOException | SAXException e) {
122 			throw new XMLStreamException(e);
123 		}
124 	}
125 
<span class="line-modified">126 	private static void validateProbeDefinition(String configuration) throws XMLStreamException {</span>
127 		validateProbeDefinition(new ByteArrayInputStream(configuration.getBytes()));
128 	}
129 
130 	public static TransformRegistry from(InputStream in) throws XMLStreamException {
131 		byte[] buf;
132 		InputStream configuration;
133 		try {
134 			buf = IOToolkit.readFully(in, -1, true);
135 			configuration = new ByteArrayInputStream(buf);
136 			configuration.mark(0);
137 			validateProbeDefinition(configuration);
138 			configuration.reset();
139 		} catch (IOException e) {
140 			throw new XMLStreamException(e);
141 		}
142 
143 		HashMap&lt;String, String&gt; globalDefaults = new HashMap&lt;&gt;();
144 		DefaultTransformRegistry registry = new DefaultTransformRegistry();
145 		XMLInputFactory inputFactory = XMLInputFactory.newInstance();
146 		XMLStreamReader streamReader = inputFactory.createXMLStreamReader(configuration);
</pre>
</td>
<td>
<hr />
<pre>
 97 			PROBE_SCHEMA = factory
 98 					.newSchema(new StreamSource(DefaultTransformRegistry.class.getResourceAsStream(PROBE_SCHEMA_XSD)));
 99 		} catch (SAXException e) {
100 			throw new ExceptionInInitializerError(e);
101 		}
102 	}
103 
104 	@Override
105 	public boolean hasPendingTransforms(String className) {
106 		List&lt;TransformDescriptor&gt; transforms = transformData.get(className);
107 		if (transforms == null || !isPendingTransforms(transforms)) {
108 			return false;
109 		}
110 		return true;
111 	}
112 
113 	public static TransformRegistry empty() {
114 		return new DefaultTransformRegistry();
115 	}
116 
<span class="line-modified">117 	public static void validateProbeDefinition(InputStream in) throws XMLStreamException {</span>
118 		try {
119 			Validator validator = PROBE_SCHEMA.newValidator();
120 			validator.validate(new StreamSource(in));
121 		} catch (IOException | SAXException e) {
122 			throw new XMLStreamException(e);
123 		}
124 	}
125 
<span class="line-modified">126 	public static void validateProbeDefinition(String configuration) throws XMLStreamException {</span>
127 		validateProbeDefinition(new ByteArrayInputStream(configuration.getBytes()));
128 	}
129 
130 	public static TransformRegistry from(InputStream in) throws XMLStreamException {
131 		byte[] buf;
132 		InputStream configuration;
133 		try {
134 			buf = IOToolkit.readFully(in, -1, true);
135 			configuration = new ByteArrayInputStream(buf);
136 			configuration.mark(0);
137 			validateProbeDefinition(configuration);
138 			configuration.reset();
139 		} catch (IOException e) {
140 			throw new XMLStreamException(e);
141 		}
142 
143 		HashMap&lt;String, String&gt; globalDefaults = new HashMap&lt;&gt;();
144 		DefaultTransformRegistry registry = new DefaultTransformRegistry();
145 		XMLInputFactory inputFactory = XMLInputFactory.newInstance();
146 		XMLStreamReader streamReader = inputFactory.createXMLStreamReader(configuration);
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../../../.classpath.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../resources/org/openjdk/jmc/agent/impl/jfrprobes_schema.xsd.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>