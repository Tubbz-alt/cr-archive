<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff core/org.openjdk.jmc.flightrecorder/src/main/java/org/openjdk/jmc/flightrecorder/internal/parser/v1/ChunkLoaderV1.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../v0/ReaderFactory.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../index.html" target="_top">index</a> <a href="TypeManager.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>core/org.openjdk.jmc.flightrecorder/src/main/java/org/openjdk/jmc/flightrecorder/internal/parser/v1/ChunkLoaderV1.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 68 		TypeManager manager = new TypeManager(classes, context, header);
 69 
 70 		// Read constants
 71 		long constantPoolOffset = 0;
 72 		// An initial constantPoolOffset of 0 indicates no constant pools.
 73 		long delta = header.getConstantPoolOffset();
 74 		while (delta != 0) {
 75 			constantPoolOffset += delta;
 76 			input.seek(constantPoolOffset);
 77 			delta = readConstantPoolEvent(input, manager);
 78 		}
 79 		manager.resolveConstants();
 80 
 81 		// Read events
 82 		long index = header.getBodyStartOffset();
 83 		while (index &lt; header.getChunkSize()) {
 84 			input.seek(index);
 85 			int size = input.readInt();
 86 			long type = input.readLong();
 87 			if (size == 0) {
<span class="line-modified"> 88 				throw new CouldNotLoadRecordingException(&quot;Found event with invalid size (0)&quot;);</span>
 89 			}
 90 			if (type != CONSTANT_POOL_EVENT_TYPE &amp;&amp; type != ChunkMetadata.METADATA_EVENT_TYPE) {
 91 				manager.readEvent(type, input);
 92 			}
 93 			index += size;
 94 		}
 95 		return data;
 96 	}
 97 
 98 	private static long readConstantPoolEvent(IDataInput input, TypeManager manager)
 99 			throws IOException, InvalidJfrFileException {
100 		input.readInt(); // size
101 		ParserToolkit.assertValue(input.readLong(), CONSTANT_POOL_EVENT_TYPE); // type;
102 		input.readLong(); // start
103 		input.readLong(); // duration
104 		long delta = input.readLong();
105 		input.readBoolean(); // flush
106 		int poolCount = input.readInt();
107 		for (int i = 0; i &lt; poolCount; i++) {
108 			long classId = input.readLong();
</pre>
</td>
<td>
<hr />
<pre>
 68 		TypeManager manager = new TypeManager(classes, context, header);
 69 
 70 		// Read constants
 71 		long constantPoolOffset = 0;
 72 		// An initial constantPoolOffset of 0 indicates no constant pools.
 73 		long delta = header.getConstantPoolOffset();
 74 		while (delta != 0) {
 75 			constantPoolOffset += delta;
 76 			input.seek(constantPoolOffset);
 77 			delta = readConstantPoolEvent(input, manager);
 78 		}
 79 		manager.resolveConstants();
 80 
 81 		// Read events
 82 		long index = header.getBodyStartOffset();
 83 		while (index &lt; header.getChunkSize()) {
 84 			input.seek(index);
 85 			int size = input.readInt();
 86 			long type = input.readLong();
 87 			if (size == 0) {
<span class="line-modified"> 88 				throw new CouldNotLoadRecordingException(&quot;Found event with invalid size (0)&quot;); //$NON-NLS-1$</span>
 89 			}
 90 			if (type != CONSTANT_POOL_EVENT_TYPE &amp;&amp; type != ChunkMetadata.METADATA_EVENT_TYPE) {
 91 				manager.readEvent(type, input);
 92 			}
 93 			index += size;
 94 		}
 95 		return data;
 96 	}
 97 
 98 	private static long readConstantPoolEvent(IDataInput input, TypeManager manager)
 99 			throws IOException, InvalidJfrFileException {
100 		input.readInt(); // size
101 		ParserToolkit.assertValue(input.readLong(), CONSTANT_POOL_EVENT_TYPE); // type;
102 		input.readLong(); // start
103 		input.readLong(); // duration
104 		long delta = input.readLong();
105 		input.readBoolean(); // flush
106 		int poolCount = input.readInt();
107 		for (int i = 0; i &lt; poolCount; i++) {
108 			long classId = input.readLong();
</pre>
</td>
</tr>
</table>
<center><a href="../v0/ReaderFactory.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../index.html" target="_top">index</a> <a href="TypeManager.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>