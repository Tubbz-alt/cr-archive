<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff application/org.openjdk.jmc.flightrecorder.flameview/src/main/java/org/openjdk/jmc/flightrecorder/flameview/tree/TraceTreeUtils.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>application/org.openjdk.jmc.flightrecorder.flameview/src/main/java/org/openjdk/jmc/flightrecorder/flameview/tree/TraceTreeUtils.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 83,12 ***</span>
  	public final static FrameSeparator DEFAULT_FRAME_SEPARATOR = new FrameSeparator(FrameCategorization.METHOD, false);
  
  	/**
  	 * Traces a TraceTree from a {@link StacktraceModel}.
  	 * 
<span class="line-modified">! 	 * @param root  the root with description</span>
<span class="line-modified">! 	 * @param model the model to trace the tree from</span>
  	 * @return the root
  	 */
  	public static TraceNode createTree(TraceNode root, StacktraceModel model) {
  		Fork rootFork = model.getRootFork();
  		for (Branch branch : rootFork.getBranches()) {
<span class="line-new-header">--- 83,14 ---</span>
  	public final static FrameSeparator DEFAULT_FRAME_SEPARATOR = new FrameSeparator(FrameCategorization.METHOD, false);
  
  	/**
  	 * Traces a TraceTree from a {@link StacktraceModel}.
  	 * 
<span class="line-modified">! 	 * @param root</span>
<span class="line-modified">! 	 *            the root with description</span>
<span class="line-added">+ 	 * @param model</span>
<span class="line-added">+ 	 *            the model to trace the tree from</span>
  	 * @return the root
  	 */
  	public static TraceNode createTree(TraceNode root, StacktraceModel model) {
  		Fork rootFork = model.getRootFork();
  		for (Branch branch : rootFork.getBranches()) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 98,12 ***</span>
  	}
  
  	/**
  	 * Root of Traces from the selection {@link IItemCollection}
  	 * 
<span class="line-modified">! 	 * @param items       the items from the selection</span>
<span class="line-modified">! 	 * @param branchCount branch count from {@link StacktraceModel} model</span>
  	 * @return root
  	 */
  	public static TraceNode createRootWithDescription(IItemCollection items, int branchCount) {
  
  		StringBuilder titleSb = new StringBuilder();
<span class="line-new-header">--- 100,14 ---</span>
  	}
  
  	/**
  	 * Root of Traces from the selection {@link IItemCollection}
  	 * 
<span class="line-modified">! 	 * @param items</span>
<span class="line-modified">! 	 *            the items from the selection</span>
<span class="line-added">+ 	 * @param branchCount</span>
<span class="line-added">+ 	 *            branch count from {@link StacktraceModel} model</span>
  	 * @return root
  	 */
  	public static TraceNode createRootWithDescription(IItemCollection items, int branchCount) {
  
  		StringBuilder titleSb = new StringBuilder();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 123,11 ***</span>
  	}
  
  	/**
  	 * Print the tree by the trace node
  	 * 
<span class="line-modified">! 	 * @param node trace node</span>
  	 * @return tree
  	 */
  	public static String printTree(TraceNode node) {
  		StringBuilder builder = new StringBuilder();
  		builder.append(&quot;=== Tree Printout ===&quot;);
<span class="line-new-header">--- 127,12 ---</span>
  	}
  
  	/**
  	 * Print the tree by the trace node
  	 * 
<span class="line-modified">! 	 * @param node</span>
<span class="line-added">+ 	 *            trace node</span>
  	 * @return tree
  	 */
  	public static String printTree(TraceNode node) {
  		StringBuilder builder = new StringBuilder();
  		builder.append(&quot;=== Tree Printout ===&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 176,12 ***</span>
  			builder.append(&quot;   &quot;);
  		}
  		return builder.toString();
  	}
  
<span class="line-modified">! 	private static Map&lt;String, Integer&gt; eventTypeNameWithCountSorted(IItemCollection items,</span>
<span class="line-modified">! 			AtomicInteger totalEventTypeSum) {</span>
  		final HashMap&lt;String, Integer&gt; map = new HashMap&lt;&gt;();
  		IAggregator&lt;IQuantity, ?&gt; build = GroupingAggregator.build(EMPTY_STRING, EMPTY_STRING, JfrAttributes.EVENT_TYPE,
  				Aggregators.count(), new GroupingAggregator.IGroupsFinisher&lt;IQuantity, IType&lt;?&gt;, CountConsumer&gt;() {
  
  					@Override
<span class="line-new-header">--- 181,12 ---</span>
  			builder.append(&quot;   &quot;);
  		}
  		return builder.toString();
  	}
  
<span class="line-modified">! 	private static Map&lt;String, Integer&gt; eventTypeNameWithCountSorted(</span>
<span class="line-modified">! 		IItemCollection items, AtomicInteger totalEventTypeSum) {</span>
  		final HashMap&lt;String, Integer&gt; map = new HashMap&lt;&gt;();
  		IAggregator&lt;IQuantity, ?&gt; build = GroupingAggregator.build(EMPTY_STRING, EMPTY_STRING, JfrAttributes.EVENT_TYPE,
  				Aggregators.count(), new GroupingAggregator.IGroupsFinisher&lt;IQuantity, IType&lt;?&gt;, CountConsumer&gt;() {
  
  					@Override
</pre>
<hr />
<pre>
<span class="line-old-header">*** 202,19 ***</span>
  				});
  		items.getAggregate(build);
  		return RulesToolkit.sortMap(map, false);
  	}
  
<span class="line-modified">! 	private static void createNodeTitleAndDescription(StringBuilder titleSb, StringBuilder descSb,</span>
<span class="line-modified">! 			Map&lt;String, Integer&gt; orderedItemCountByType) {</span>
  
  		int i = 0;
  		long restEventCount = 0;
  		boolean writeTitle = true;
  		int maxEventsInTile = orderedItemCountByType.size() &gt; DEFAULT_ROOT_TITLE_MAX_EVENTS
<span class="line-modified">! 				? DEFAULT_ROOT_TITLE_MAX_EVENTS</span>
<span class="line-removed">- 				: orderedItemCountByType.size() - 1;</span>
  
  		for (Map.Entry&lt;String, Integer&gt; e : orderedItemCountByType.entrySet()) {
  			if (writeTitle) {
  				String eventType = getFlameviewMessage(FLAMEVIEW_SELECT_TITLE_EVENT_PATTERN, e.getKey(),
  						String.valueOf(e.getValue()));
<span class="line-new-header">--- 207,18 ---</span>
  				});
  		items.getAggregate(build);
  		return RulesToolkit.sortMap(map, false);
  	}
  
<span class="line-modified">! 	private static void createNodeTitleAndDescription(</span>
<span class="line-modified">! 		StringBuilder titleSb, StringBuilder descSb, Map&lt;String, Integer&gt; orderedItemCountByType) {</span>
  
  		int i = 0;
  		long restEventCount = 0;
  		boolean writeTitle = true;
  		int maxEventsInTile = orderedItemCountByType.size() &gt; DEFAULT_ROOT_TITLE_MAX_EVENTS
<span class="line-modified">! 				? DEFAULT_ROOT_TITLE_MAX_EVENTS : orderedItemCountByType.size() - 1;</span>
  
  		for (Map.Entry&lt;String, Integer&gt; e : orderedItemCountByType.entrySet()) {
  			if (writeTitle) {
  				String eventType = getFlameviewMessage(FLAMEVIEW_SELECT_TITLE_EVENT_PATTERN, e.getKey(),
  						String.valueOf(e.getValue()));
</pre>
<center>&lt; prev <a href="../../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>