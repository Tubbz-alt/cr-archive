<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff application/org.openjdk.jmc.flightrecorder.flameview/src/main/js/flameview.js</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="flameview.css.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>application/org.openjdk.jmc.flightrecorder.flameview/src/main/js/flameview.js</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -142,40 +142,47 @@</span>
  };
  
  
  const adjustTip = function(d) {
  	var tipMessage = &quot;&quot;.concat(d.data.n, htmlTagBr);
<span class="udiff-line-modified-removed">- 	if (d.data.v === undefined) {</span>
<span class="udiff-line-modified-removed">- 		tipMessage += createRootTable(d.data.d);</span>
<span class="udiff-line-modified-removed">- 	} else {</span>
<span class="udiff-line-modified-removed">- 		tipMessage += createNodeTipTable(d.data);</span>
<span class="udiff-line-modified-added">+ 	</span>
<span class="udiff-line-modified-added">+ 	if (nodeContainsChildren(d.data)) {</span>
<span class="udiff-line-modified-added">+ 		if (d.data.v === undefined) {</span>
<span class="udiff-line-modified-added">+ 			tipMessage += createRootTable(d.data.d);</span>
<span class="udiff-line-added">+ 		} else {</span>
<span class="udiff-line-added">+ 			tipMessage += createNodeTipTable(d.data);</span>
<span class="udiff-line-added">+ 		}</span>
  	}
<span class="udiff-line-added">+ 	</span>
  	return tipMessage;
  }
  
<span class="udiff-line-added">+ const nodeContainsChildren = function(data) {</span>
<span class="udiff-line-added">+ 	return Array.isArray(data.c) &amp;&amp; data.c.length;</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
  const createNodeTipTable = function(data) {
  	var table = &quot;&quot;.concat(tagOpen(&quot;table class=&#39;d3-flame-graph-tip&#39;&quot;), tagOpen(&quot;tbody&quot;))
  	if (data.d === undefined) {
<span class="udiff-line-modified-removed">- 		table = table.concat(addTableRow(tootlipPackage, data.p), addTableRow(tootlipSamples, data.v));</span>
<span class="udiff-line-modified-added">+ 		table = table.concat(addTableRow(tootlipPackage, data.p, &quot;tdLabel&quot;), </span>
<span class="udiff-line-added">+ 				addTableRow(tootlipSamples, data.v, &quot;tdLabel&quot;));</span>
  	} else {
<span class="udiff-line-modified-removed">- 		table += addTableRow(tootlipDescription, data.d);</span>
<span class="udiff-line-modified-added">+ 		table += addTableRow(tootlipDescription, data.d, &quot;tdCount&quot;);</span>
  	}
  	return table.concat(tagClose(&quot;tbody&quot;), tagClose(&quot;table&quot;));
  }
  
  const createRootTable = function(input) {
  	var table = &quot;&quot;;
  	var tableRows = input.split(&quot;|&quot;);
<span class="udiff-line-modified-removed">- 	if(tableRows.length &gt; 1) {</span>
<span class="udiff-line-modified-removed">- 		table = table.concat(tagOpen(&quot;table class=&#39;d3-flame-graph-tip&#39;&quot;), createTableHeader(), tagOpen(&quot;tbody&quot;));</span>
<span class="udiff-line-modified-removed">- 		var prevCount = 0;</span>
<span class="udiff-line-modified-removed">- 		for(var i=0; i &lt; tableRows.length - 1; i++) {</span>
<span class="udiff-line-modified-removed">- 			const rowValue = tableRows[i].split(&quot;:&quot;);</span>
<span class="udiff-line-removed">- 			table += addTableRow(parseInt(rowValue[0]), rowValue[1]);</span>
<span class="udiff-line-removed">- 		}</span>
<span class="udiff-line-removed">- 		table = table.concat(tagClose(&quot;tbody&quot;), tagClose(&quot;table&quot;));</span>
<span class="udiff-line-modified-added">+ 	table = table.concat(tagOpen(&quot;table class=&#39;d3-flame-graph-tip&#39;&quot;), createTableHeader(), tagOpen(&quot;tbody&quot;));</span>
<span class="udiff-line-modified-added">+ 	var prevCount = 0;</span>
<span class="udiff-line-modified-added">+ 	for(var i=0; i &lt; tableRows.length - 1; i++) {</span>
<span class="udiff-line-modified-added">+ 		const rowValue = tableRows[i].split(&quot;:&quot;);</span>
<span class="udiff-line-modified-added">+ 		table += addTableRow(parseInt(rowValue[0]), rowValue[1], &quot;tdCount&quot;);</span>
  	}
<span class="udiff-line-added">+ 	table = table.concat(tagClose(&quot;tbody&quot;), tagClose(&quot;table&quot;));</span>
  	return table;
  }
  
  const tagOpen = function(tag, cssClass) {
  	var result = &quot;\u003C&quot; + tag;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -189,16 +196,16 @@</span>
  }
  const tagClose = function(tag) {
  	return &quot;\u003C\u002F &quot;+ tag + &quot;\u003E&quot;;
  }
  
<span class="udiff-line-modified-removed">- const addTableRow = function(eventCount, eventName) {</span>
<span class="udiff-line-modified-removed">- 	return tableTr(tableTd(eventCount, &quot;tdCount&quot;), tableTd(eventName));</span>
<span class="udiff-line-modified-added">+ const addTableRow = function(eventCount, eventName, cssStartTd) {</span>
<span class="udiff-line-modified-added">+ 	return tableTr(tableTd(eventCount, cssStartTd), tableTd(eventName));</span>
  }
  
  const createTableHeader = function() { 
<span class="udiff-line-modified-removed">- 	return tagOpen(&quot;thead&quot;).concat(tableTr(tableTh(tooltipTableThCount, &quot;tdCount&quot;), tableTh(tooltipTableThEventType)),tagClose(&quot;thead&quot;));</span>
<span class="udiff-line-modified-added">+ 	return tagOpen(&quot;thead&quot;).concat(tableTr(tableTh(tooltipTableThCount, &quot;tdLabel&quot;), tableTh(tooltipTableThEventType)),tagClose(&quot;thead&quot;));</span>
  }
  
  const tableTh = function(value, css) {
  	return tagOpen(&quot;th&quot;, css).concat(value, tagClose(&quot;th&quot;));
  }
</pre>
<center><a href="flameview.css.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>