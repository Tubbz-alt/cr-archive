<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/conf/jib-profiles.js</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="../autoconf/spec.gmk.in.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="../../src/hotspot/os/linux/os_linux.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/conf/jib-profiles.js</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2015, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 240     var common = {};
 241 
 242     common.organization = &quot;jpg.infra.builddeps&quot;;
 243     common.build_id = getBuildId(input);
 244     common.build_number = input.build_number != null ? input.build_number : &quot;0&quot;;
 245 
 246     // List of the main profile names used for iteration
 247     common.main_profile_names = [
 248         &quot;linux-x64&quot;, &quot;linux-x64-musl&quot;, &quot;linux-x86&quot;, &quot;macosx-x64&quot;, &quot;solaris-x64&quot;,
 249         &quot;solaris-sparcv9&quot;, &quot;windows-x64&quot;, &quot;windows-x86&quot;,
 250         &quot;linux-aarch64&quot;, &quot;linux-arm32&quot;, &quot;linux-ppc64le&quot;, &quot;linux-s390x&quot;
 251     ];
 252 
 253     // These are the base setttings for all the main build profiles.
 254     common.main_profile_base = {
 255         dependencies: [&quot;boot_jdk&quot;, &quot;gnumake&quot;, &quot;jtreg&quot;, &quot;jib&quot;, &quot;autoconf&quot;, &quot;jmh&quot;, &quot;jcov&quot;],
 256         default_make_targets: [&quot;product-bundles&quot;, &quot;test-bundles&quot;, &quot;static-libs-bundles&quot;],
 257         configure_args: concat([&quot;--enable-jtreg-failure-handler&quot;],
 258             &quot;--with-exclude-translations=de,es,fr,it,ko,pt_BR,sv,ca,tr,cs,sk,ja_JP_A,ja_JP_HA,ja_JP_HI,ja_JP_I,zh_TW,zh_HK&quot;,
 259             &quot;--disable-manpages&quot;,
<span class="line-modified"> 260             &quot;--with-jvm-features=-shenandoahgc&quot;,</span>
 261             versionArgs(input, common))
 262     };
 263     // Extra settings for debug profiles
 264     common.debug_suffix = &quot;-debug&quot;;
 265     common.debug_profile_base = {
 266         configure_args: [&quot;--enable-debug&quot;],
 267         labels: &quot;debug&quot;
 268     };
 269     // Extra settings for slowdebug profiles
 270     common.slowdebug_suffix = &quot;-slowdebug&quot;;
 271     common.slowdebug_profile_base = {
 272         configure_args: [&quot;--with-debug-level=slowdebug&quot;],
 273         labels: &quot;slowdebug&quot;
 274     };
 275     // Extra settings for openjdk only profiles
 276     common.open_suffix = &quot;-open&quot;;
 277     common.open_profile_base = {
 278         configure_args: [&quot;--enable-openjdk-only&quot;],
 279         labels: &quot;open&quot;
 280     };
</pre>
<hr />
<pre>
 463             target_os: &quot;windows&quot;,
 464             target_cpu: &quot;x64&quot;,
 465             dependencies: [&quot;devkit&quot;, &quot;pandoc&quot;, &quot;graalunit_lib&quot;],
 466             configure_args: concat(common.configure_args_64bit),
 467         },
 468 
 469         &quot;windows-x86&quot;: {
 470             target_os: &quot;windows&quot;,
 471             target_cpu: &quot;x86&quot;,
 472             build_cpu: &quot;x64&quot;,
 473             dependencies: [&quot;devkit&quot;],
 474             configure_args: concat(common.configure_args_32bit),
 475         },
 476 
 477         &quot;linux-aarch64&quot;: {
 478             target_os: &quot;linux&quot;,
 479             target_cpu: &quot;aarch64&quot;,
 480             build_cpu: &quot;x64&quot;,
 481             dependencies: [&quot;devkit&quot;, &quot;build_devkit&quot;, &quot;cups&quot;],
 482             configure_args: [
<span class="line-modified"> 483                 &quot;--openjdk-target=aarch64-linux-gnu&quot;, &quot;--with-freetype=bundled&quot;,</span>
<span class="line-removed"> 484                 &quot;--disable-warnings-as-errors&quot;</span>
 485             ],
 486         },
 487 
 488         &quot;linux-arm32&quot;: {
 489             target_os: &quot;linux&quot;,
 490             target_cpu: &quot;arm&quot;,
 491             build_cpu: &quot;x64&quot;,
 492             dependencies: [&quot;devkit&quot;, &quot;build_devkit&quot;, &quot;cups&quot;],
 493             configure_args: [
 494                 &quot;--openjdk-target=arm-linux-gnueabihf&quot;, &quot;--with-freetype=bundled&quot;,
 495                 &quot;--with-abi-profile=arm-vfp-hflt&quot;, &quot;--disable-warnings-as-errors&quot;
 496             ],
 497         },
 498 
 499         &quot;linux-ppc64le&quot;: {
 500             target_os: &quot;linux&quot;,
 501             target_cpu: &quot;ppc64le&quot;,
 502             build_cpu: &quot;x64&quot;,
 503             dependencies: [&quot;devkit&quot;, &quot;build_devkit&quot;, &quot;cups&quot;],
 504             configure_args: [
</pre>
<hr />
<pre>
 536         profiles[debugName] = concatObjects(profiles[name],
 537                                             common.slowdebug_profile_base);
 538     });
 539     // Generate testmake profiles for the main profile of each build host
 540     // platform. This profile only runs the makefile tests.
 541     // Ant is needed to run the idea project generator test.
 542     var testmakeBase = {
 543         dependencies: [ &quot;ant&quot; ],
 544         environment: {
 545             &quot;ANT_HOME&quot;: input.get(&quot;ant&quot;, &quot;home_path&quot;)
 546         }
 547     };
 548     [ &quot;linux-x64&quot;, &quot;macosx-x64&quot;, &quot;solaris-sparcv9&quot;, &quot;solaris-x64&quot;, &quot;windows-x64&quot;]
 549         .forEach(function (name) {
 550             var maketestName = name + &quot;-testmake&quot;;
 551             profiles[maketestName] = concatObjects(profiles[name], testmakeBase);
 552             profiles[maketestName].default_make_targets = [ &quot;test-make&quot; ];
 553         });
 554 
 555     // Generate -gcov profiles
<span class="line-modified"> 556     [ &quot;linux-x64&quot;, &quot;macosx-x64&quot; ].forEach(function (name) {</span>
 557         var gcovName = name + &quot;-gcov&quot;;
 558         profiles[gcovName] = clone(profiles[name]);
 559         profiles[gcovName].default_make_targets = [&quot;product-bundles&quot;, &quot;test-bundles&quot;];
 560         profiles[gcovName].configure_args = concat(profiles[gcovName].configure_args,
 561             [&quot;--enable-native-coverage&quot;, &quot;--disable-warnings-as-errors&quot;]);
 562     });
 563 
 564     // Profiles for building the zero jvm variant. These are used for verification.
 565     var zeroProfiles = {
 566         &quot;linux-x64-zero&quot;: {
 567             target_os: &quot;linux&quot;,
 568             target_cpu: &quot;x64&quot;,
 569             dependencies: [&quot;devkit&quot;],
 570             configure_args: concat(common.configure_args_64bit, [
 571                 &quot;--with-zlib=system&quot;,
 572                 &quot;--with-jvm-variants=zero&quot;,
 573                 &quot;--enable-libffi-bundling&quot;
 574             ])
 575         },
 576 
</pre>
<hr />
<pre>
 623         .forEach(function (name) {
 624             var bootcycleName = name + &quot;-bootcycle&quot;;
 625             var bootcyclePrebuiltName = name + &quot;-bootcycle-prebuilt&quot;;
 626             // The base bootcycle profile just changes the default target
 627             // compared to the base profile
 628             profiles[bootcycleName] = clone(profiles[name]);
 629             profiles[bootcycleName].default_make_targets = [ &quot;bootcycle-images&quot; ];
 630             // The prebuilt bootcycle variant modifies the boot jdk argument
 631             var bootcyclePrebuiltBase = {
 632                 dependencies: [ name + &quot;.jdk&quot; ],
 633                 configure_args: &quot;--with-boot-jdk=&quot; + input.get(name + &quot;.jdk&quot;, &quot;home_path&quot;),
 634             }
 635             profiles[bootcyclePrebuiltName] = concatObjects(profiles[name],
 636                 bootcyclePrebuiltBase);
 637             var bootJdkIndex = profiles[bootcyclePrebuiltName].dependencies.indexOf(&quot;boot_jdk&quot;);
 638             delete profiles[bootcyclePrebuiltName].dependencies[bootJdkIndex];
 639             profiles[bootcyclePrebuiltName].default_make_targets = [ &quot;product-images&quot; ];
 640         });
 641 
 642     // JCov profiles build JCov-instrumented JDK image based on images provided through dependencies.
<span class="line-modified"> 643     [ &quot;linux-x64&quot;, &quot;macosx-x64&quot;, &quot;solaris-sparcv9&quot;, &quot;windows-x64&quot;]</span>
 644         .forEach(function (name) {
 645             var jcovName = name + &quot;-jcov&quot;;
 646             profiles[jcovName] = clone(common.main_profile_base);
 647             profiles[jcovName].target_os = profiles[name].target_os
 648             profiles[jcovName].target_cpu = profiles[name].target_cpu
 649             profiles[jcovName].default_make_targets = [ &quot;jcov-bundles&quot; ];
 650             profiles[jcovName].dependencies = concat(profiles[jcovName].dependencies,
 651                 [ name + &quot;.jdk&quot;, &quot;devkit&quot; ]);
 652             profiles[jcovName].configure_args = concat(profiles[jcovName].configure_args,
 653                 [&quot;--with-jcov-input-jdk=&quot; + input.get(name + &quot;.jdk&quot;, &quot;home_path&quot;)]);
 654         });
 655 
 656     //
 657     // Define artifacts for profiles
 658     //
 659     // Macosx bundles are named osx
 660     // tar.gz.
 661     var artifactData = {
 662         &quot;linux-x64&quot;: {
 663             platform: &quot;linux-x64&quot;,
</pre>
<hr />
<pre>
 784     // corresponding debug profile. This profile does a compare build run with no
 785     // changes to verify that the compare script has a clean baseline
 786     common.main_profile_names.forEach(function (name) {
 787         [ &quot;&quot;, common.open_suffix ].forEach(function (suffix) {
 788             var cmpBaselineName = name + suffix + &quot;-cmp-baseline&quot;;
 789             profiles[cmpBaselineName] = clone(profiles[name + suffix]);
 790             // Only compare the images target. This should pressumably be expanded
 791             // to include more build targets when possible.
 792             profiles[cmpBaselineName].default_make_targets = [ &quot;images&quot;, &quot;test-image&quot; ];
 793             if (name == &quot;linux-x64&quot;) {
 794                 profiles[cmpBaselineName].default_make_targets
 795                     = concat(profiles[cmpBaselineName].default_make_targets, &quot;docs&quot;);
 796             }
 797             profiles[cmpBaselineName].make_args = [ &quot;COMPARE_BUILD=CONF=&quot; ];
 798             // Do not inherit artifact definitions from base profile
 799             delete profiles[cmpBaselineName].artifacts;
 800         });
 801     });
 802 
 803     // Artifacts of JCov profiles
<span class="line-modified"> 804     [ &quot;linux-x64&quot;, &quot;macosx-x64&quot;, &quot;solaris-sparcv9&quot;, &quot;windows-x64&quot;]</span>
 805         .forEach(function (name) {
 806             var o = artifactData[name]
 807             var jdk_subdir = (o.jdk_subdir != null ? o.jdk_subdir : &quot;jdk-&quot; + data.version);
 808             var jdk_suffix = (o.jdk_suffix != null ? o.jdk_suffix : &quot;tar.gz&quot;);
 809             var pf = o.platform
 810             var jcovName = name + &quot;-jcov&quot;;
 811             profiles[jcovName].artifacts = {
 812                 jdk: {
 813                     local: &quot;bundles/\\(jdk-jcov.*bin.&quot; + jdk_suffix + &quot;\\)&quot;,
 814                     remote: [
 815                         &quot;bundles/&quot; + pf + &quot;/jdk-jcov-&quot; + data.version + &quot;_&quot; + pf + &quot;_bin.&quot; + jdk_suffix
 816                     ],
 817                     subdir: jdk_subdir,
 818                     exploded: &quot;images/jdk-jcov&quot;
 819                 }
 820             };
 821         });
 822 
 823     // Artifacts of gcov (native-code-coverage) profiles
<span class="line-modified"> 824     [ &quot;linux-x64&quot;, &quot;macosx-x64&quot; ].forEach(function (name) {</span>
 825         var o = artifactData[name]
 826         var pf = o.platform
 827         var jdk_subdir = (o.jdk_subdir != null ? o.jdk_subdir : &quot;jdk-&quot; + data.version);
 828         var jdk_suffix = (o.jdk_suffix != null ? o.jdk_suffix : &quot;tar.gz&quot;);
 829         var gcovName = name + &quot;-gcov&quot;;
 830         profiles[gcovName].artifacts = {
 831             jdk: {
 832                 local: &quot;bundles/\\(jdk.*bin.&quot; + jdk_suffix + &quot;\\)&quot;,
 833                 remote: [
 834                     &quot;bundles/&quot; + pf + &quot;/jdk-&quot; + data.version + &quot;_&quot; + pf + &quot;_bin-gcov.&quot; + jdk_suffix,
 835                 ],
 836                 subdir: jdk_subdir,
 837                 exploded: &quot;images/jdk&quot;,
 838             },
 839             test: {
 840                     local: &quot;bundles/\\(jdk.*bin-tests.tar.gz\\)&quot;,
 841                     remote: [
 842                         &quot;bundles/&quot; + pf + &quot;/jdk-&quot; + data.version + &quot;_&quot; + pf + &quot;_bin-gcov-tests.tar.gz&quot;,
 843                     ],
 844                     exploded: &quot;images/test&quot;
</pre>
<hr />
<pre>
 867         }
 868     };
 869     profiles = concatObjects(profiles, testOnlyProfiles);
 870 
 871     // Profiles used to run tests using Jib for internal dependencies.
 872     var testedProfile = input.testedProfile;
 873     if (testedProfile == null) {
 874         testedProfile = input.build_os + &quot;-&quot; + input.build_cpu;
 875     }
 876     var testedProfileJdk = testedProfile + &quot;.jdk&quot;;
 877     // Make it possible to use the test image from a different profile
 878     var testImageProfile;
 879     if (input.testImageProfile != null) {
 880         testImageProfile = input.testImageProfile;
 881     } else if (testedProfile.endsWith(&quot;-jcov&quot;)) {
 882         testImageProfile = testedProfile.substring(0, testedProfile.length - &quot;-jcov&quot;.length);
 883     } else {
 884         testImageProfile = testedProfile;
 885     }
 886     var testedProfileTest = testImageProfile + &quot;.test&quot;
<span class="line-modified"> 887     var testOnlyMake = [ &quot;run-test-prebuilt&quot;, &quot;LOG_CMDLINES=true&quot;, &quot;JTREG_VERBOSE=fail,error,time&quot; ];</span>
 888     if (testedProfile.endsWith(&quot;-gcov&quot;)) {
 889         testOnlyMake = concat(testOnlyMake, &quot;GCOV_ENABLED=true&quot;)
 890     }
 891     var testOnlyProfilesPrebuilt = {
 892         &quot;run-test-prebuilt&quot;: {
 893             target_os: input.build_os,
 894             target_cpu: input.build_cpu,
 895             dependencies: [
 896                 &quot;jtreg&quot;, &quot;gnumake&quot;, &quot;boot_jdk&quot;, &quot;devkit&quot;, &quot;jib&quot;, &quot;jcov&quot;, testedProfileJdk,
 897                 testedProfileTest
 898             ],
 899             src: &quot;src.conf&quot;,
 900             make_args: testOnlyMake,
 901             environment: {
 902                 &quot;BOOT_JDK&quot;: common.boot_jdk_home,
 903                 &quot;JDK_IMAGE_DIR&quot;: input.get(testedProfileJdk, &quot;home_path&quot;),
 904                 &quot;TEST_IMAGE_DIR&quot;: input.get(testedProfileTest, &quot;home_path&quot;)
 905             },
 906             labels: &quot;test&quot;
 907         }
</pre>
<hr />
<pre>
1055             revision: devkit_platform_revisions[devkit_platform],
1056             environment: {
1057                 &quot;DEVKIT_HOME&quot;: input.get(&quot;devkit&quot;, &quot;home_path&quot;),
1058             }
1059         },
1060 
1061         build_devkit: {
1062             organization: common.organization,
1063             ext: &quot;tar.gz&quot;,
1064             module: &quot;devkit-&quot; + input.build_platform,
1065             revision: devkit_platform_revisions[input.build_platform]
1066         },
1067 
1068         cups: {
1069             organization: common.organization,
1070             ext: &quot;tar.gz&quot;,
1071             revision: &quot;1.0118+1.0&quot;
1072         },
1073 
1074         jtreg: {
<span class="line-modified">1075             server: &quot;javare&quot;,</span>
<span class="line-modified">1076             revision: &quot;4.2&quot;,</span>
<span class="line-modified">1077             build_number: &quot;b16&quot;,</span>

1078             checksum_file: &quot;MD5_VALUES&quot;,
<span class="line-modified">1079             file: &quot;jtreg_bin-4.2.zip&quot;,</span>
1080             environment_name: &quot;JT_HOME&quot;,
1081             environment_path: input.get(&quot;jtreg&quot;, &quot;install_path&quot;) + &quot;/jtreg/bin&quot;
1082         },
1083 
1084         jmh: {
1085             organization: common.organization,
1086             ext: &quot;tar.gz&quot;,
1087             revision: &quot;1.21+1.0&quot;
1088         },
1089 
1090         jcov: {
1091             // Until an official build of JCov is available, use custom
1092             // build to support classfile version 57.
1093             // See CODETOOLS-7902358 for more info.
1094             // server: &quot;jpg&quot;,
1095             // product: &quot;jcov&quot;,
1096             // version: &quot;3.0&quot;,
1097             // build_number: &quot;b07&quot;,
1098             // file: &quot;bundles/jcov-3_0.zip&quot;,
1099             organization: common.organization,
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 2015, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 240     var common = {};
 241 
 242     common.organization = &quot;jpg.infra.builddeps&quot;;
 243     common.build_id = getBuildId(input);
 244     common.build_number = input.build_number != null ? input.build_number : &quot;0&quot;;
 245 
 246     // List of the main profile names used for iteration
 247     common.main_profile_names = [
 248         &quot;linux-x64&quot;, &quot;linux-x64-musl&quot;, &quot;linux-x86&quot;, &quot;macosx-x64&quot;, &quot;solaris-x64&quot;,
 249         &quot;solaris-sparcv9&quot;, &quot;windows-x64&quot;, &quot;windows-x86&quot;,
 250         &quot;linux-aarch64&quot;, &quot;linux-arm32&quot;, &quot;linux-ppc64le&quot;, &quot;linux-s390x&quot;
 251     ];
 252 
 253     // These are the base setttings for all the main build profiles.
 254     common.main_profile_base = {
 255         dependencies: [&quot;boot_jdk&quot;, &quot;gnumake&quot;, &quot;jtreg&quot;, &quot;jib&quot;, &quot;autoconf&quot;, &quot;jmh&quot;, &quot;jcov&quot;],
 256         default_make_targets: [&quot;product-bundles&quot;, &quot;test-bundles&quot;, &quot;static-libs-bundles&quot;],
 257         configure_args: concat([&quot;--enable-jtreg-failure-handler&quot;],
 258             &quot;--with-exclude-translations=de,es,fr,it,ko,pt_BR,sv,ca,tr,cs,sk,ja_JP_A,ja_JP_HA,ja_JP_HI,ja_JP_I,zh_TW,zh_HK&quot;,
 259             &quot;--disable-manpages&quot;,
<span class="line-modified"> 260             &quot;--disable-jvm-feature-shenandoahgc&quot;,</span>
 261             versionArgs(input, common))
 262     };
 263     // Extra settings for debug profiles
 264     common.debug_suffix = &quot;-debug&quot;;
 265     common.debug_profile_base = {
 266         configure_args: [&quot;--enable-debug&quot;],
 267         labels: &quot;debug&quot;
 268     };
 269     // Extra settings for slowdebug profiles
 270     common.slowdebug_suffix = &quot;-slowdebug&quot;;
 271     common.slowdebug_profile_base = {
 272         configure_args: [&quot;--with-debug-level=slowdebug&quot;],
 273         labels: &quot;slowdebug&quot;
 274     };
 275     // Extra settings for openjdk only profiles
 276     common.open_suffix = &quot;-open&quot;;
 277     common.open_profile_base = {
 278         configure_args: [&quot;--enable-openjdk-only&quot;],
 279         labels: &quot;open&quot;
 280     };
</pre>
<hr />
<pre>
 463             target_os: &quot;windows&quot;,
 464             target_cpu: &quot;x64&quot;,
 465             dependencies: [&quot;devkit&quot;, &quot;pandoc&quot;, &quot;graalunit_lib&quot;],
 466             configure_args: concat(common.configure_args_64bit),
 467         },
 468 
 469         &quot;windows-x86&quot;: {
 470             target_os: &quot;windows&quot;,
 471             target_cpu: &quot;x86&quot;,
 472             build_cpu: &quot;x64&quot;,
 473             dependencies: [&quot;devkit&quot;],
 474             configure_args: concat(common.configure_args_32bit),
 475         },
 476 
 477         &quot;linux-aarch64&quot;: {
 478             target_os: &quot;linux&quot;,
 479             target_cpu: &quot;aarch64&quot;,
 480             build_cpu: &quot;x64&quot;,
 481             dependencies: [&quot;devkit&quot;, &quot;build_devkit&quot;, &quot;cups&quot;],
 482             configure_args: [
<span class="line-modified"> 483                 &quot;--openjdk-target=aarch64-linux-gnu&quot;,</span>

 484             ],
 485         },
 486 
 487         &quot;linux-arm32&quot;: {
 488             target_os: &quot;linux&quot;,
 489             target_cpu: &quot;arm&quot;,
 490             build_cpu: &quot;x64&quot;,
 491             dependencies: [&quot;devkit&quot;, &quot;build_devkit&quot;, &quot;cups&quot;],
 492             configure_args: [
 493                 &quot;--openjdk-target=arm-linux-gnueabihf&quot;, &quot;--with-freetype=bundled&quot;,
 494                 &quot;--with-abi-profile=arm-vfp-hflt&quot;, &quot;--disable-warnings-as-errors&quot;
 495             ],
 496         },
 497 
 498         &quot;linux-ppc64le&quot;: {
 499             target_os: &quot;linux&quot;,
 500             target_cpu: &quot;ppc64le&quot;,
 501             build_cpu: &quot;x64&quot;,
 502             dependencies: [&quot;devkit&quot;, &quot;build_devkit&quot;, &quot;cups&quot;],
 503             configure_args: [
</pre>
<hr />
<pre>
 535         profiles[debugName] = concatObjects(profiles[name],
 536                                             common.slowdebug_profile_base);
 537     });
 538     // Generate testmake profiles for the main profile of each build host
 539     // platform. This profile only runs the makefile tests.
 540     // Ant is needed to run the idea project generator test.
 541     var testmakeBase = {
 542         dependencies: [ &quot;ant&quot; ],
 543         environment: {
 544             &quot;ANT_HOME&quot;: input.get(&quot;ant&quot;, &quot;home_path&quot;)
 545         }
 546     };
 547     [ &quot;linux-x64&quot;, &quot;macosx-x64&quot;, &quot;solaris-sparcv9&quot;, &quot;solaris-x64&quot;, &quot;windows-x64&quot;]
 548         .forEach(function (name) {
 549             var maketestName = name + &quot;-testmake&quot;;
 550             profiles[maketestName] = concatObjects(profiles[name], testmakeBase);
 551             profiles[maketestName].default_make_targets = [ &quot;test-make&quot; ];
 552         });
 553 
 554     // Generate -gcov profiles
<span class="line-modified"> 555     [ &quot;linux-aarch64&quot;, &quot;linux-x64&quot;, &quot;macosx-x64&quot; ].forEach(function (name) {</span>
 556         var gcovName = name + &quot;-gcov&quot;;
 557         profiles[gcovName] = clone(profiles[name]);
 558         profiles[gcovName].default_make_targets = [&quot;product-bundles&quot;, &quot;test-bundles&quot;];
 559         profiles[gcovName].configure_args = concat(profiles[gcovName].configure_args,
 560             [&quot;--enable-native-coverage&quot;, &quot;--disable-warnings-as-errors&quot;]);
 561     });
 562 
 563     // Profiles for building the zero jvm variant. These are used for verification.
 564     var zeroProfiles = {
 565         &quot;linux-x64-zero&quot;: {
 566             target_os: &quot;linux&quot;,
 567             target_cpu: &quot;x64&quot;,
 568             dependencies: [&quot;devkit&quot;],
 569             configure_args: concat(common.configure_args_64bit, [
 570                 &quot;--with-zlib=system&quot;,
 571                 &quot;--with-jvm-variants=zero&quot;,
 572                 &quot;--enable-libffi-bundling&quot;
 573             ])
 574         },
 575 
</pre>
<hr />
<pre>
 622         .forEach(function (name) {
 623             var bootcycleName = name + &quot;-bootcycle&quot;;
 624             var bootcyclePrebuiltName = name + &quot;-bootcycle-prebuilt&quot;;
 625             // The base bootcycle profile just changes the default target
 626             // compared to the base profile
 627             profiles[bootcycleName] = clone(profiles[name]);
 628             profiles[bootcycleName].default_make_targets = [ &quot;bootcycle-images&quot; ];
 629             // The prebuilt bootcycle variant modifies the boot jdk argument
 630             var bootcyclePrebuiltBase = {
 631                 dependencies: [ name + &quot;.jdk&quot; ],
 632                 configure_args: &quot;--with-boot-jdk=&quot; + input.get(name + &quot;.jdk&quot;, &quot;home_path&quot;),
 633             }
 634             profiles[bootcyclePrebuiltName] = concatObjects(profiles[name],
 635                 bootcyclePrebuiltBase);
 636             var bootJdkIndex = profiles[bootcyclePrebuiltName].dependencies.indexOf(&quot;boot_jdk&quot;);
 637             delete profiles[bootcyclePrebuiltName].dependencies[bootJdkIndex];
 638             profiles[bootcyclePrebuiltName].default_make_targets = [ &quot;product-images&quot; ];
 639         });
 640 
 641     // JCov profiles build JCov-instrumented JDK image based on images provided through dependencies.
<span class="line-modified"> 642     [ &quot;linux-aarch64&quot;, &quot;linux-x64&quot;, &quot;macosx-x64&quot;, &quot;solaris-sparcv9&quot;, &quot;windows-x64&quot;]</span>
 643         .forEach(function (name) {
 644             var jcovName = name + &quot;-jcov&quot;;
 645             profiles[jcovName] = clone(common.main_profile_base);
 646             profiles[jcovName].target_os = profiles[name].target_os
 647             profiles[jcovName].target_cpu = profiles[name].target_cpu
 648             profiles[jcovName].default_make_targets = [ &quot;jcov-bundles&quot; ];
 649             profiles[jcovName].dependencies = concat(profiles[jcovName].dependencies,
 650                 [ name + &quot;.jdk&quot;, &quot;devkit&quot; ]);
 651             profiles[jcovName].configure_args = concat(profiles[jcovName].configure_args,
 652                 [&quot;--with-jcov-input-jdk=&quot; + input.get(name + &quot;.jdk&quot;, &quot;home_path&quot;)]);
 653         });
 654 
 655     //
 656     // Define artifacts for profiles
 657     //
 658     // Macosx bundles are named osx
 659     // tar.gz.
 660     var artifactData = {
 661         &quot;linux-x64&quot;: {
 662             platform: &quot;linux-x64&quot;,
</pre>
<hr />
<pre>
 783     // corresponding debug profile. This profile does a compare build run with no
 784     // changes to verify that the compare script has a clean baseline
 785     common.main_profile_names.forEach(function (name) {
 786         [ &quot;&quot;, common.open_suffix ].forEach(function (suffix) {
 787             var cmpBaselineName = name + suffix + &quot;-cmp-baseline&quot;;
 788             profiles[cmpBaselineName] = clone(profiles[name + suffix]);
 789             // Only compare the images target. This should pressumably be expanded
 790             // to include more build targets when possible.
 791             profiles[cmpBaselineName].default_make_targets = [ &quot;images&quot;, &quot;test-image&quot; ];
 792             if (name == &quot;linux-x64&quot;) {
 793                 profiles[cmpBaselineName].default_make_targets
 794                     = concat(profiles[cmpBaselineName].default_make_targets, &quot;docs&quot;);
 795             }
 796             profiles[cmpBaselineName].make_args = [ &quot;COMPARE_BUILD=CONF=&quot; ];
 797             // Do not inherit artifact definitions from base profile
 798             delete profiles[cmpBaselineName].artifacts;
 799         });
 800     });
 801 
 802     // Artifacts of JCov profiles
<span class="line-modified"> 803     [ &quot;linux-aarch64&quot;, &quot;linux-x64&quot;, &quot;macosx-x64&quot;, &quot;solaris-sparcv9&quot;, &quot;windows-x64&quot;]</span>
 804         .forEach(function (name) {
 805             var o = artifactData[name]
 806             var jdk_subdir = (o.jdk_subdir != null ? o.jdk_subdir : &quot;jdk-&quot; + data.version);
 807             var jdk_suffix = (o.jdk_suffix != null ? o.jdk_suffix : &quot;tar.gz&quot;);
 808             var pf = o.platform
 809             var jcovName = name + &quot;-jcov&quot;;
 810             profiles[jcovName].artifacts = {
 811                 jdk: {
 812                     local: &quot;bundles/\\(jdk-jcov.*bin.&quot; + jdk_suffix + &quot;\\)&quot;,
 813                     remote: [
 814                         &quot;bundles/&quot; + pf + &quot;/jdk-jcov-&quot; + data.version + &quot;_&quot; + pf + &quot;_bin.&quot; + jdk_suffix
 815                     ],
 816                     subdir: jdk_subdir,
 817                     exploded: &quot;images/jdk-jcov&quot;
 818                 }
 819             };
 820         });
 821 
 822     // Artifacts of gcov (native-code-coverage) profiles
<span class="line-modified"> 823     [ &quot;linux-aarch64&quot;, &quot;linux-x64&quot;, &quot;macosx-x64&quot; ].forEach(function (name) {</span>
 824         var o = artifactData[name]
 825         var pf = o.platform
 826         var jdk_subdir = (o.jdk_subdir != null ? o.jdk_subdir : &quot;jdk-&quot; + data.version);
 827         var jdk_suffix = (o.jdk_suffix != null ? o.jdk_suffix : &quot;tar.gz&quot;);
 828         var gcovName = name + &quot;-gcov&quot;;
 829         profiles[gcovName].artifacts = {
 830             jdk: {
 831                 local: &quot;bundles/\\(jdk.*bin.&quot; + jdk_suffix + &quot;\\)&quot;,
 832                 remote: [
 833                     &quot;bundles/&quot; + pf + &quot;/jdk-&quot; + data.version + &quot;_&quot; + pf + &quot;_bin-gcov.&quot; + jdk_suffix,
 834                 ],
 835                 subdir: jdk_subdir,
 836                 exploded: &quot;images/jdk&quot;,
 837             },
 838             test: {
 839                     local: &quot;bundles/\\(jdk.*bin-tests.tar.gz\\)&quot;,
 840                     remote: [
 841                         &quot;bundles/&quot; + pf + &quot;/jdk-&quot; + data.version + &quot;_&quot; + pf + &quot;_bin-gcov-tests.tar.gz&quot;,
 842                     ],
 843                     exploded: &quot;images/test&quot;
</pre>
<hr />
<pre>
 866         }
 867     };
 868     profiles = concatObjects(profiles, testOnlyProfiles);
 869 
 870     // Profiles used to run tests using Jib for internal dependencies.
 871     var testedProfile = input.testedProfile;
 872     if (testedProfile == null) {
 873         testedProfile = input.build_os + &quot;-&quot; + input.build_cpu;
 874     }
 875     var testedProfileJdk = testedProfile + &quot;.jdk&quot;;
 876     // Make it possible to use the test image from a different profile
 877     var testImageProfile;
 878     if (input.testImageProfile != null) {
 879         testImageProfile = input.testImageProfile;
 880     } else if (testedProfile.endsWith(&quot;-jcov&quot;)) {
 881         testImageProfile = testedProfile.substring(0, testedProfile.length - &quot;-jcov&quot;.length);
 882     } else {
 883         testImageProfile = testedProfile;
 884     }
 885     var testedProfileTest = testImageProfile + &quot;.test&quot;
<span class="line-modified"> 886     var testOnlyMake = [ &quot;test-prebuilt&quot;, &quot;LOG_CMDLINES=true&quot;, &quot;JTREG_VERBOSE=fail,error,time&quot; ];</span>
 887     if (testedProfile.endsWith(&quot;-gcov&quot;)) {
 888         testOnlyMake = concat(testOnlyMake, &quot;GCOV_ENABLED=true&quot;)
 889     }
 890     var testOnlyProfilesPrebuilt = {
 891         &quot;run-test-prebuilt&quot;: {
 892             target_os: input.build_os,
 893             target_cpu: input.build_cpu,
 894             dependencies: [
 895                 &quot;jtreg&quot;, &quot;gnumake&quot;, &quot;boot_jdk&quot;, &quot;devkit&quot;, &quot;jib&quot;, &quot;jcov&quot;, testedProfileJdk,
 896                 testedProfileTest
 897             ],
 898             src: &quot;src.conf&quot;,
 899             make_args: testOnlyMake,
 900             environment: {
 901                 &quot;BOOT_JDK&quot;: common.boot_jdk_home,
 902                 &quot;JDK_IMAGE_DIR&quot;: input.get(testedProfileJdk, &quot;home_path&quot;),
 903                 &quot;TEST_IMAGE_DIR&quot;: input.get(testedProfileTest, &quot;home_path&quot;)
 904             },
 905             labels: &quot;test&quot;
 906         }
</pre>
<hr />
<pre>
1054             revision: devkit_platform_revisions[devkit_platform],
1055             environment: {
1056                 &quot;DEVKIT_HOME&quot;: input.get(&quot;devkit&quot;, &quot;home_path&quot;),
1057             }
1058         },
1059 
1060         build_devkit: {
1061             organization: common.organization,
1062             ext: &quot;tar.gz&quot;,
1063             module: &quot;devkit-&quot; + input.build_platform,
1064             revision: devkit_platform_revisions[input.build_platform]
1065         },
1066 
1067         cups: {
1068             organization: common.organization,
1069             ext: &quot;tar.gz&quot;,
1070             revision: &quot;1.0118+1.0&quot;
1071         },
1072 
1073         jtreg: {
<span class="line-modified">1074             server: &quot;jpg&quot;,</span>
<span class="line-modified">1075             product: &quot;jtreg&quot;,</span>
<span class="line-modified">1076             version: &quot;5.0&quot;,</span>
<span class="line-added">1077             build_number: &quot;b01&quot;,</span>
1078             checksum_file: &quot;MD5_VALUES&quot;,
<span class="line-modified">1079             file: &quot;bundles/jtreg_bin-5.0.zip&quot;,</span>
1080             environment_name: &quot;JT_HOME&quot;,
1081             environment_path: input.get(&quot;jtreg&quot;, &quot;install_path&quot;) + &quot;/jtreg/bin&quot;
1082         },
1083 
1084         jmh: {
1085             organization: common.organization,
1086             ext: &quot;tar.gz&quot;,
1087             revision: &quot;1.21+1.0&quot;
1088         },
1089 
1090         jcov: {
1091             // Until an official build of JCov is available, use custom
1092             // build to support classfile version 57.
1093             // See CODETOOLS-7902358 for more info.
1094             // server: &quot;jpg&quot;,
1095             // product: &quot;jcov&quot;,
1096             // version: &quot;3.0&quot;,
1097             // build_number: &quot;b07&quot;,
1098             // file: &quot;bundles/jcov-3_0.zip&quot;,
1099             organization: common.organization,
</pre>
</td>
</tr>
</table>
<center><a href="../autoconf/spec.gmk.in.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="../../src/hotspot/os/linux/os_linux.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>