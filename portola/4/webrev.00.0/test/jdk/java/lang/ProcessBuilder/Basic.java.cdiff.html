<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/jdk/java/lang/ProcessBuilder/Basic.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../hotspot/jtreg/runtime/8176717/TestInheritFD.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>test/jdk/java/lang/ProcessBuilder/Basic.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 72,10 ***</span>
<span class="line-new-header">--- 72,14 ---</span>
      static final String cfUserTextEncoding = System.getenv(&quot;__CF_USER_TEXT_ENCODING&quot;);
  
      /* used for AIX only */
      static final String libpath = System.getenv(&quot;LIBPATH&quot;);
  
<span class="line-added">+     /* Used for regex String matching for long error messages */</span>
<span class="line-added">+     static final String PERMISSION_DENIED_ERROR_MSG = &quot;(Permission denied|error=13)&quot;;</span>
<span class="line-added">+     static final String NO_SUCH_FILE_ERROR_MSG = &quot;(No such file|error=2)&quot;;</span>
<span class="line-added">+ </span>
      /**
       * Returns the number of milliseconds since time given by
       * startNanoTime, which must have been previously returned from a
       * call to {@link System.nanoTime()}.
       */
</pre>
<hr />
<pre>
<span class="line-old-header">*** 303,11 ***</span>
              pb.start();
              fail(&quot;Expected IOException not thrown&quot;);
          } catch (IOException e) {
              String m = e.getMessage();
              if (EnglishUnix.is() &amp;&amp;
<span class="line-modified">!                 ! matches(m, &quot;Permission denied&quot;))</span>
                  unexpected(e);
          } catch (Throwable t) { unexpected(t); }
      }
  
      public static class JavaChild {
<span class="line-new-header">--- 307,11 ---</span>
              pb.start();
              fail(&quot;Expected IOException not thrown&quot;);
          } catch (IOException e) {
              String m = e.getMessage();
              if (EnglishUnix.is() &amp;&amp;
<span class="line-modified">!                 ! matches(m, PERMISSION_DENIED_ERROR_MSG))</span>
                  unexpected(e);
          } catch (Throwable t) { unexpected(t); }
      }
  
      public static class JavaChild {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 413,11 ***</span>
                              pb.start();
                              fail(&quot;Expected IOException not thrown&quot;);
                          } catch (IOException e) {
                              String m = e.getMessage();
                              if (EnglishUnix.is() &amp;&amp;
<span class="line-modified">!                                 ! matches(m, &quot;No such file&quot;))</span>
                                  unexpected(e);
                          } catch (Throwable t) { unexpected(t); }
  
                          // Not on PATH at all; directories exist
                          new File(&quot;dir1&quot;).mkdirs();
<span class="line-new-header">--- 417,11 ---</span>
                              pb.start();
                              fail(&quot;Expected IOException not thrown&quot;);
                          } catch (IOException e) {
                              String m = e.getMessage();
                              if (EnglishUnix.is() &amp;&amp;
<span class="line-modified">!                                 ! matches(m, NO_SUCH_FILE_ERROR_MSG))</span>
                                  unexpected(e);
                          } catch (Throwable t) { unexpected(t); }
  
                          // Not on PATH at all; directories exist
                          new File(&quot;dir1&quot;).mkdirs();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 426,11 ***</span>
                              pb.start();
                              fail(&quot;Expected IOException not thrown&quot;);
                          } catch (IOException e) {
                              String m = e.getMessage();
                              if (EnglishUnix.is() &amp;&amp;
<span class="line-modified">!                                 ! matches(m, &quot;No such file&quot;))</span>
                                  unexpected(e);
                          } catch (Throwable t) { unexpected(t); }
  
                          // Can&#39;t execute a directory -- permission denied
                          // Report EACCES errno
<span class="line-new-header">--- 430,11 ---</span>
                              pb.start();
                              fail(&quot;Expected IOException not thrown&quot;);
                          } catch (IOException e) {
                              String m = e.getMessage();
                              if (EnglishUnix.is() &amp;&amp;
<span class="line-modified">!                                 ! matches(m, NO_SUCH_FILE_ERROR_MSG))</span>
                                  unexpected(e);
                          } catch (Throwable t) { unexpected(t); }
  
                          // Can&#39;t execute a directory -- permission denied
                          // Report EACCES errno
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2026,11 ***</span>
              new ProcessBuilder(&quot;&quot;).start();
              fail(&quot;Expected IOException not thrown&quot;);
          } catch (IOException e) {
              String m = e.getMessage();
              if (EnglishUnix.is() &amp;&amp;
<span class="line-modified">!                 ! matches(m, &quot;No such file or directory&quot;))</span>
                  unexpected(e);
          } catch (Throwable t) { unexpected(t); }
  
          //----------------------------------------------------------------
          // Check that attempt to execute program name with funny
<span class="line-new-header">--- 2030,11 ---</span>
              new ProcessBuilder(&quot;&quot;).start();
              fail(&quot;Expected IOException not thrown&quot;);
          } catch (IOException e) {
              String m = e.getMessage();
              if (EnglishUnix.is() &amp;&amp;
<span class="line-modified">!                 ! matches(m, NO_SUCH_FILE_ERROR_MSG))</span>
                  unexpected(e);
          } catch (Throwable t) { unexpected(t); }
  
          //----------------------------------------------------------------
          // Check that attempt to execute program name with funny
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2042,12 ***</span>
                  fail(&quot;Expected IOException not thrown&quot;);
              } catch (IOException e) {
                  String m = e.getMessage();
                  Pattern p = Pattern.compile(programName);
                  if (! matches(m, programName)
<span class="line-modified">!                     || (EnglishUnix.is()</span>
<span class="line-modified">!                         &amp;&amp; ! matches(m, &quot;No such file or directory&quot;)))</span>
                      unexpected(e);
              } catch (Throwable t) { unexpected(t); }
  
          //----------------------------------------------------------------
          // Attempt to start process in nonexistent directory fails.
<span class="line-new-header">--- 2046,12 ---</span>
                  fail(&quot;Expected IOException not thrown&quot;);
              } catch (IOException e) {
                  String m = e.getMessage();
                  Pattern p = Pattern.compile(programName);
                  if (! matches(m, programName)
<span class="line-modified">!                     || (EnglishUnix.is() &amp;&amp;</span>
<span class="line-modified">!                         ! matches(m, NO_SUCH_FILE_ERROR_MSG)))</span>
                      unexpected(e);
              } catch (Throwable t) { unexpected(t); }
  
          //----------------------------------------------------------------
          // Attempt to start process in nonexistent directory fails.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2059,11 ***</span>
              fail(&quot;Expected IOException not thrown&quot;);
          } catch (IOException e) {
              String m = e.getMessage();
              if (! matches(m, &quot;in directory&quot;)
                  || (EnglishUnix.is() &amp;&amp;
<span class="line-modified">!                     ! matches(m, &quot;No such file or directory&quot;)))</span>
                  unexpected(e);
          } catch (Throwable t) { unexpected(t); }
  
          //----------------------------------------------------------------
          // Attempt to write 4095 bytes to the pipe buffer without a
<span class="line-new-header">--- 2063,11 ---</span>
              fail(&quot;Expected IOException not thrown&quot;);
          } catch (IOException e) {
              String m = e.getMessage();
              if (! matches(m, &quot;in directory&quot;)
                  || (EnglishUnix.is() &amp;&amp;
<span class="line-modified">!                     ! matches(m, NO_SUCH_FILE_ERROR_MSG)))</span>
                  unexpected(e);
          } catch (Throwable t) { unexpected(t); }
  
          //----------------------------------------------------------------
          // Attempt to write 4095 bytes to the pipe buffer without a
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2339,11 ***</span>
              fail(&quot;Expected IOException not thrown&quot;);
          } catch (IOException e) {
              new File(&quot;./emptyCommand&quot;).delete();
              String m = e.getMessage();
              if (EnglishUnix.is() &amp;&amp;
<span class="line-modified">!                 ! matches(m, &quot;Permission denied&quot;))</span>
                  unexpected(e);
          } catch (Throwable t) { unexpected(t); }
  
          new File(&quot;emptyCommand&quot;).delete();
  
<span class="line-new-header">--- 2343,11 ---</span>
              fail(&quot;Expected IOException not thrown&quot;);
          } catch (IOException e) {
              new File(&quot;./emptyCommand&quot;).delete();
              String m = e.getMessage();
              if (EnglishUnix.is() &amp;&amp;
<span class="line-modified">!                 ! matches(m, PERMISSION_DENIED_ERROR_MSG))</span>
                  unexpected(e);
          } catch (Throwable t) { unexpected(t); }
  
          new File(&quot;emptyCommand&quot;).delete();
  
</pre>
<center><a href="../../../../hotspot/jtreg/runtime/8176717/TestInheritFD.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>