<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/runtime/valhalla/valuetypes/ValueTypeArray.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../src/jdk.unsupported/share/classes/sun/misc/Unsafe.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../../../../jdk/valhalla/valuetypes/ArrayElementVarHandleTest.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/runtime/valhalla/valuetypes/ValueTypeArray.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
202         assertEquals(multiPoints[0][0].length, 4, &quot;3rd dim length&quot;);
203 
204         Point defaultPoint = multiPoints[1][2][3];
205         assertEquals(defaultPoint.x, 0, &quot;invalid point x value&quot;);
206         assertEquals(defaultPoint.y, 0, &quot;invalid point x value&quot;);
207     }
208 
209     void testReflectArray() {
210         // Check the java.lang.reflect.Array.newInstance methods...
211         Class&lt;?&gt; cls = (Class&lt;?&gt;) Point[].class;
212         Point[][] array = (Point[][]) Array.newInstance(cls, 1);
213         assertEquals(array.length, 1, &quot;Incorrect length&quot;);
214         assertTrue(array[0] == null, &quot;Expected NULL&quot;);
215 
216         Point[][][] array3 = (Point[][][]) Array.newInstance(cls, 1, 2);
217         assertEquals(array3.length, 1, &quot;Incorrect length&quot;);
218         assertEquals(array3[0].length, 2, &quot;Incorrect length&quot;);
219         assertTrue(array3[0][0] == null, &quot;Expected NULL&quot;);
220 
221         // Now create ObjArrays of ValueArray...
<span class="line-modified">222         cls = (Class&lt;?&gt;) Point.class.asIndirectType();</span>
<span class="line-removed">223         Point.ref[][] barray = (Point.ref[][]) Array.newInstance(cls, 1, 2);</span>
224         assertEquals(barray.length, 1, &quot;Incorrect length&quot;);
225         assertEquals(barray[0].length, 2, &quot;Incorrect length&quot;);
226         barray[0][1] = Point.createPoint(1, 2);
227         Point.ref pb = barray[0][1];
228         int x = pb.getX();
229         assertEquals(x, 1, &quot;Bad Point Value&quot;);
230     }
231 
232     static final inline class MyInt implements Comparable&lt;MyInt.ref&gt; {
233         final int value;
234 
235         private MyInt() { this(0); }
236         private MyInt(int v) { value = v; }
237         public int getValue() { return value; }
238         public String toString() { return &quot;MyInt: &quot; + getValue(); }
239         public int compareTo(MyInt.ref that) { return Integer.compare(this.getValue(), that.getValue()); }
240         public boolean equals(Object o) {
241             if (o instanceof MyInt) {
242                 return this.getValue() == ((MyInt) o).getValue();
243             }
</pre>
</td>
<td>
<hr />
<pre>
202         assertEquals(multiPoints[0][0].length, 4, &quot;3rd dim length&quot;);
203 
204         Point defaultPoint = multiPoints[1][2][3];
205         assertEquals(defaultPoint.x, 0, &quot;invalid point x value&quot;);
206         assertEquals(defaultPoint.y, 0, &quot;invalid point x value&quot;);
207     }
208 
209     void testReflectArray() {
210         // Check the java.lang.reflect.Array.newInstance methods...
211         Class&lt;?&gt; cls = (Class&lt;?&gt;) Point[].class;
212         Point[][] array = (Point[][]) Array.newInstance(cls, 1);
213         assertEquals(array.length, 1, &quot;Incorrect length&quot;);
214         assertTrue(array[0] == null, &quot;Expected NULL&quot;);
215 
216         Point[][][] array3 = (Point[][][]) Array.newInstance(cls, 1, 2);
217         assertEquals(array3.length, 1, &quot;Incorrect length&quot;);
218         assertEquals(array3[0].length, 2, &quot;Incorrect length&quot;);
219         assertTrue(array3[0][0] == null, &quot;Expected NULL&quot;);
220 
221         // Now create ObjArrays of ValueArray...
<span class="line-modified">222         Point.ref[][] barray = (Point.ref[][]) Array.newInstance(Point.ref.class, 1, 2);</span>

223         assertEquals(barray.length, 1, &quot;Incorrect length&quot;);
224         assertEquals(barray[0].length, 2, &quot;Incorrect length&quot;);
225         barray[0][1] = Point.createPoint(1, 2);
226         Point.ref pb = barray[0][1];
227         int x = pb.getX();
228         assertEquals(x, 1, &quot;Bad Point Value&quot;);
229     }
230 
231     static final inline class MyInt implements Comparable&lt;MyInt.ref&gt; {
232         final int value;
233 
234         private MyInt() { this(0); }
235         private MyInt(int v) { value = v; }
236         public int getValue() { return value; }
237         public String toString() { return &quot;MyInt: &quot; + getValue(); }
238         public int compareTo(MyInt.ref that) { return Integer.compare(this.getValue(), that.getValue()); }
239         public boolean equals(Object o) {
240             if (o instanceof MyInt) {
241                 return this.getValue() == ((MyInt) o).getValue();
242             }
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../src/jdk.unsupported/share/classes/sun/misc/Unsafe.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../../../../jdk/valhalla/valuetypes/ArrayElementVarHandleTest.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>