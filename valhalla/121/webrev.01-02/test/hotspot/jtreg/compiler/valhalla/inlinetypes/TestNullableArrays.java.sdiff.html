<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/compiler/valhalla/inlinetypes/TestNullableArrays.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="TestLWorld.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TestNullableInlineTypes.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/compiler/valhalla/inlinetypes/TestNullableArrays.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  86             va[0] = null;
  87         }
  88         for (int i = 1; i &lt; len; ++i) {
  89             va[i] = MyValue1.createWithFieldsDontInline(rI, rL);
  90         }
  91         return va;
  92     }
  93 
  94     @DontCompile
  95     public void test1_verifier(boolean warmup) {
  96         int len = Math.abs(rI % 10);
  97         MyValue1.ref[] va = test1(len);
  98         if (len &gt; 0) {
  99             Asserts.assertEQ(va[0], null);
 100         }
 101         for (int i = 1; i &lt; len; ++i) {
 102             Asserts.assertEQ(va[i].hash(), hash());
 103         }
 104     }
 105 
<span class="line-modified"> 106     // Test creation of a inline type array and element access</span>
 107     @Test
 108     // TODO 8227588
 109     // @Test(failOn = ALLOC + ALLOCA + LOOP + LOAD + STORE + TRAP)
 110     public long test2() {
 111         MyValue1.ref[] va = new MyValue1.ref[1];
 112         va[0] = MyValue1.createWithFieldsInline(rI, rL);
 113         return va[0].hash();
 114     }
 115 
 116     @DontCompile
 117     public void test2_verifier(boolean warmup) {
 118         long result = test2();
 119         Asserts.assertEQ(result, hash());
 120     }
 121 
<span class="line-modified"> 122     // Test receiving a inline type array from the interpreter,</span>
 123     // updating its elements in a loop and computing a hash.
 124     @Test(failOn = ALLOCA)
 125     public long test3(MyValue1.ref[] va) {
 126         long result = 0;
 127         for (int i = 0; i &lt; 10; ++i) {
 128             if (va[i] != null) {
 129                 result += va[i].hash();
 130             }
 131             va[i] = MyValue1.createWithFieldsInline(rI + 1, rL + 1);
 132         }
 133         va[0] = null;
 134         return result;
 135     }
 136 
 137     @DontCompile
 138     public void test3_verifier(boolean warmup) {
 139         MyValue1.ref[] va = new MyValue1.ref[10];
 140         long expected = 0;
 141         for (int i = 1; i &lt; 10; ++i) {
 142             va[i] = MyValue1.createWithFieldsDontInline(rI + i, rL + i);
</pre>
</td>
<td>
<hr />
<pre>
  86             va[0] = null;
  87         }
  88         for (int i = 1; i &lt; len; ++i) {
  89             va[i] = MyValue1.createWithFieldsDontInline(rI, rL);
  90         }
  91         return va;
  92     }
  93 
  94     @DontCompile
  95     public void test1_verifier(boolean warmup) {
  96         int len = Math.abs(rI % 10);
  97         MyValue1.ref[] va = test1(len);
  98         if (len &gt; 0) {
  99             Asserts.assertEQ(va[0], null);
 100         }
 101         for (int i = 1; i &lt; len; ++i) {
 102             Asserts.assertEQ(va[i].hash(), hash());
 103         }
 104     }
 105 
<span class="line-modified"> 106     // Test creation of an inline type array and element access</span>
 107     @Test
 108     // TODO 8227588
 109     // @Test(failOn = ALLOC + ALLOCA + LOOP + LOAD + STORE + TRAP)
 110     public long test2() {
 111         MyValue1.ref[] va = new MyValue1.ref[1];
 112         va[0] = MyValue1.createWithFieldsInline(rI, rL);
 113         return va[0].hash();
 114     }
 115 
 116     @DontCompile
 117     public void test2_verifier(boolean warmup) {
 118         long result = test2();
 119         Asserts.assertEQ(result, hash());
 120     }
 121 
<span class="line-modified"> 122     // Test receiving an inline type array from the interpreter,</span>
 123     // updating its elements in a loop and computing a hash.
 124     @Test(failOn = ALLOCA)
 125     public long test3(MyValue1.ref[] va) {
 126         long result = 0;
 127         for (int i = 0; i &lt; 10; ++i) {
 128             if (va[i] != null) {
 129                 result += va[i].hash();
 130             }
 131             va[i] = MyValue1.createWithFieldsInline(rI + 1, rL + 1);
 132         }
 133         va[0] = null;
 134         return result;
 135     }
 136 
 137     @DontCompile
 138     public void test3_verifier(boolean warmup) {
 139         MyValue1.ref[] va = new MyValue1.ref[10];
 140         long expected = 0;
 141         for (int i = 1; i &lt; 10; ++i) {
 142             va[i] = MyValue1.createWithFieldsDontInline(rI + i, rL + i);
</pre>
</td>
</tr>
</table>
<center><a href="TestLWorld.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TestNullableInlineTypes.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>