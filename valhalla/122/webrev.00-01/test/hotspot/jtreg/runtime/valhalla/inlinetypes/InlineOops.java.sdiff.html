<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/runtime/valhalla/inlinetypes/InlineOops.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="FlattenableSemanticTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="InlineTypeCreation.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/runtime/valhalla/inlinetypes/InlineOops.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 23 
 24 package runtime.valhalla.inlinetypes;
 25 
 26 import java.lang.invoke.*;
 27 import java.lang.ref.*;
 28 import java.util.concurrent.*;
 29 
 30 import static jdk.test.lib.Asserts.*;
 31 import jdk.test.lib.Utils;
 32 import sun.hotspot.WhiteBox;
 33 
 34 import jdk.experimental.value.MethodHandleBuilder;
 35 
 36 /**
 37  * @test InlineOops_int_Serial
 38  * @requires vm.gc.Serial
 39  * @summary Test embedding oops into Inline types
 40  * @modules java.base/jdk.experimental.bytecode
 41  *          java.base/jdk.experimental.value
 42  * @library /test/lib
<span class="line-modified"> 43  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator Person.java</span>
<span class="line-modified"> 44  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator InlineOops.java</span>
 45  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
 46  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
 47  * @run main/othervm -Xint -XX:+UseSerialGC -Xmx128m
 48  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
 49  *                   runtime.valhalla.inlinetypes.InlineOops
 50  */
 51 
 52 /**
 53  * @test InlineOops_int_G1
 54  * @requires vm.gc.G1
 55  * @summary Test embedding oops into Inline types
 56  * @modules java.base/jdk.experimental.bytecode
 57  *          java.base/jdk.experimental.value
 58  * @library /test/lib
<span class="line-modified"> 59  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator Person.java</span>
<span class="line-modified"> 60  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator InlineOops.java</span>
 61  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
 62  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
 63  * @run main/othervm -Xint  -XX:+UseG1GC -Xmx128m
 64  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
 65  *                   runtime.valhalla.inlinetypes.InlineOops 20
 66  */
 67 
 68 /**
 69  * @test InlineOops_int_Parallel
 70  * @requires vm.gc.Parallel
 71  * @summary Test embedding oops into Inline types
 72  * @modules java.base/jdk.experimental.bytecode
 73  *          java.base/jdk.experimental.value
 74  * @library /test/lib
<span class="line-modified"> 75  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator Person.java</span>
<span class="line-modified"> 76  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator InlineOops.java</span>
 77  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
 78  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
 79  * @run main/othervm -Xint -XX:+UseParallelGC -Xmx128m
 80  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
 81  *                   runtime.valhalla.inlinetypes.InlineOops
 82  */
 83 
 84 /**
 85  * @test InlineOops_int_Z
 86  * @requires vm.gc.Z
 87  * @summary Test embedding oops into Inline types
 88  * @modules java.base/jdk.experimental.bytecode
 89  *          java.base/jdk.experimental.value
 90  * @library /test/lib
<span class="line-modified"> 91  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator Person.java</span>
<span class="line-modified"> 92  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator InlineOops.java</span>
 93  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
 94  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
 95  * @run main/othervm -Xint -XX:+UnlockExperimentalVMOptions -XX:+UseZGC -Xmx128m
 96  *                   -XX:+UnlockDiagnosticVMOptions -XX:+ZVerifyViews
 97  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
 98  *                   runtime.valhalla.inlinetypes.InlineOops
 99  */
100 
101 /**
102  * @test InlineOops_comp_serial
103  * @requires vm.gc.Serial
104  * @summary Test embedding oops into Inline types
105  * @modules java.base/jdk.experimental.bytecode
106  *          java.base/jdk.experimental.value
107  * @library /test/lib
<span class="line-modified">108  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator Person.java</span>
<span class="line-modified">109  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator InlineOops.java</span>
110  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
111  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
112  * @run main/othervm -Xcomp -XX:+UseSerialGC -Xmx128m
113  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
114  *                   runtime.valhalla.inlinetypes.InlineOops
115  */
116 
117 /**
118  * @test InlineOops_comp_G1
119  * @requires vm.gc.G1
120  * @summary Test embedding oops into Inline types
121  * @modules java.base/jdk.experimental.bytecode
122  *          java.base/jdk.experimental.value
123  * @library /test/lib
<span class="line-modified">124  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator Person.java</span>
<span class="line-modified">125  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator InlineOops.java</span>
126  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
127  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
128  * @run main/othervm -Xcomp -XX:+UseG1GC -Xmx128m
129  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
130  *                   runtime.valhalla.inlinetypes.InlineOops 20
131  */
132 
133 /**
134  * @test InlineOops_comp_Parallel
135  * @requires vm.gc.Parallel
136  * @summary Test embedding oops into Inline types
137  * @modules java.base/jdk.experimental.bytecode
138  *          java.base/jdk.experimental.value
139  * @library /test/lib
<span class="line-modified">140  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator Person.java</span>
<span class="line-modified">141  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator InlineOops.java</span>
142  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
143  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
144  * @run main/othervm -Xcomp -XX:+UseParallelGC -Xmx128m
145  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
146  *                   runtime.valhalla.inlinetypes.InlineOops
147  */
148 
149 /**
150  * @test InlineOops_comp_Z
151  * @requires vm.gc.Z
152  * @summary Test embedding oops into Inline types
153  * @modules java.base/jdk.experimental.bytecode
154  *          java.base/jdk.experimental.value
155  * @library /test/lib
<span class="line-modified">156  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator Person.java</span>
<span class="line-modified">157  * @compile -XDemitQtypes -XDenableValueTypes -XDallowWithFieldOperator InlineOops.java</span>
158  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
159  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
160  * @run main/othervm -Xcomp -XX:+UnlockExperimentalVMOptions -XX:+UseZGC -Xmx128m
161  *                   -XX:+UnlockDiagnosticVMOptions -XX:+ZVerifyViews
162  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
163  *                   runtime.valhalla.inlinetypes.InlineOops
164  */
165 public class InlineOops {
166 
167     // Extra debug: -XX:+VerifyOops -XX:+VerifyStack -XX:+VerifyLastFrame -XX:+VerifyBeforeGC -XX:+VerifyAfterGC -XX:+VerifyDuringGC -XX:VerifySubSet=threads,heap
168     // Even more debugging: -XX:+TraceNewOopMapGeneration -Xlog:gc*=info
169 
170     static final int NOF_PEOPLE = 10000; // Exercise arrays of this size
171 
172     static int MIN_ACTIVE_GC_COUNT = 10; // Run active workload for this number of GC passes
173 
174     static int MED_ACTIVE_GC_COUNT = 4;  // Medium life span in terms of GC passes
175 
176     static final String TEST_STRING1 = &quot;Test String 1&quot;;
177     static final String TEST_STRING2 = &quot;Test String 2&quot;;
</pre>
</td>
<td>
<hr />
<pre>
 23 
 24 package runtime.valhalla.inlinetypes;
 25 
 26 import java.lang.invoke.*;
 27 import java.lang.ref.*;
 28 import java.util.concurrent.*;
 29 
 30 import static jdk.test.lib.Asserts.*;
 31 import jdk.test.lib.Utils;
 32 import sun.hotspot.WhiteBox;
 33 
 34 import jdk.experimental.value.MethodHandleBuilder;
 35 
 36 /**
 37  * @test InlineOops_int_Serial
 38  * @requires vm.gc.Serial
 39  * @summary Test embedding oops into Inline types
 40  * @modules java.base/jdk.experimental.bytecode
 41  *          java.base/jdk.experimental.value
 42  * @library /test/lib
<span class="line-modified"> 43  * @compile -XDallowWithFieldOperator Person.java</span>
<span class="line-modified"> 44  * @compile -XDallowWithFieldOperator InlineOops.java</span>
 45  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
 46  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
 47  * @run main/othervm -Xint -XX:+UseSerialGC -Xmx128m
 48  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
 49  *                   runtime.valhalla.inlinetypes.InlineOops
 50  */
 51 
 52 /**
 53  * @test InlineOops_int_G1
 54  * @requires vm.gc.G1
 55  * @summary Test embedding oops into Inline types
 56  * @modules java.base/jdk.experimental.bytecode
 57  *          java.base/jdk.experimental.value
 58  * @library /test/lib
<span class="line-modified"> 59  * @compile -XDallowWithFieldOperator Person.java</span>
<span class="line-modified"> 60  * @compile -XDallowWithFieldOperator InlineOops.java</span>
 61  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
 62  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
 63  * @run main/othervm -Xint  -XX:+UseG1GC -Xmx128m
 64  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
 65  *                   runtime.valhalla.inlinetypes.InlineOops 20
 66  */
 67 
 68 /**
 69  * @test InlineOops_int_Parallel
 70  * @requires vm.gc.Parallel
 71  * @summary Test embedding oops into Inline types
 72  * @modules java.base/jdk.experimental.bytecode
 73  *          java.base/jdk.experimental.value
 74  * @library /test/lib
<span class="line-modified"> 75  * @compile -XDallowWithFieldOperator Person.java</span>
<span class="line-modified"> 76  * @compile -XDallowWithFieldOperator InlineOops.java</span>
 77  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
 78  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
 79  * @run main/othervm -Xint -XX:+UseParallelGC -Xmx128m
 80  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
 81  *                   runtime.valhalla.inlinetypes.InlineOops
 82  */
 83 
 84 /**
 85  * @test InlineOops_int_Z
 86  * @requires vm.gc.Z
 87  * @summary Test embedding oops into Inline types
 88  * @modules java.base/jdk.experimental.bytecode
 89  *          java.base/jdk.experimental.value
 90  * @library /test/lib
<span class="line-modified"> 91  * @compile -XDallowWithFieldOperator Person.java</span>
<span class="line-modified"> 92  * @compile -XDallowWithFieldOperator InlineOops.java</span>
 93  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
 94  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
 95  * @run main/othervm -Xint -XX:+UnlockExperimentalVMOptions -XX:+UseZGC -Xmx128m
 96  *                   -XX:+UnlockDiagnosticVMOptions -XX:+ZVerifyViews
 97  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
 98  *                   runtime.valhalla.inlinetypes.InlineOops
 99  */
100 
101 /**
102  * @test InlineOops_comp_serial
103  * @requires vm.gc.Serial
104  * @summary Test embedding oops into Inline types
105  * @modules java.base/jdk.experimental.bytecode
106  *          java.base/jdk.experimental.value
107  * @library /test/lib
<span class="line-modified">108  * @compile -XDallowWithFieldOperator Person.java</span>
<span class="line-modified">109  * @compile -XDallowWithFieldOperator InlineOops.java</span>
110  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
111  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
112  * @run main/othervm -Xcomp -XX:+UseSerialGC -Xmx128m
113  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
114  *                   runtime.valhalla.inlinetypes.InlineOops
115  */
116 
117 /**
118  * @test InlineOops_comp_G1
119  * @requires vm.gc.G1
120  * @summary Test embedding oops into Inline types
121  * @modules java.base/jdk.experimental.bytecode
122  *          java.base/jdk.experimental.value
123  * @library /test/lib
<span class="line-modified">124  * @compile -XDallowWithFieldOperator Person.java</span>
<span class="line-modified">125  * @compile -XDallowWithFieldOperator InlineOops.java</span>
126  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
127  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
128  * @run main/othervm -Xcomp -XX:+UseG1GC -Xmx128m
129  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
130  *                   runtime.valhalla.inlinetypes.InlineOops 20
131  */
132 
133 /**
134  * @test InlineOops_comp_Parallel
135  * @requires vm.gc.Parallel
136  * @summary Test embedding oops into Inline types
137  * @modules java.base/jdk.experimental.bytecode
138  *          java.base/jdk.experimental.value
139  * @library /test/lib
<span class="line-modified">140  * @compile -XDallowWithFieldOperator Person.java</span>
<span class="line-modified">141  * @compile -XDallowWithFieldOperator InlineOops.java</span>
142  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
143  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
144  * @run main/othervm -Xcomp -XX:+UseParallelGC -Xmx128m
145  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
146  *                   runtime.valhalla.inlinetypes.InlineOops
147  */
148 
149 /**
150  * @test InlineOops_comp_Z
151  * @requires vm.gc.Z
152  * @summary Test embedding oops into Inline types
153  * @modules java.base/jdk.experimental.bytecode
154  *          java.base/jdk.experimental.value
155  * @library /test/lib
<span class="line-modified">156  * @compile -XDallowWithFieldOperator Person.java</span>
<span class="line-modified">157  * @compile -XDallowWithFieldOperator InlineOops.java</span>
158  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
159  *                   sun.hotspot.WhiteBox$WhiteBoxPermission
160  * @run main/othervm -Xcomp -XX:+UnlockExperimentalVMOptions -XX:+UseZGC -Xmx128m
161  *                   -XX:+UnlockDiagnosticVMOptions -XX:+ZVerifyViews
162  *                   -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
163  *                   runtime.valhalla.inlinetypes.InlineOops
164  */
165 public class InlineOops {
166 
167     // Extra debug: -XX:+VerifyOops -XX:+VerifyStack -XX:+VerifyLastFrame -XX:+VerifyBeforeGC -XX:+VerifyAfterGC -XX:+VerifyDuringGC -XX:VerifySubSet=threads,heap
168     // Even more debugging: -XX:+TraceNewOopMapGeneration -Xlog:gc*=info
169 
170     static final int NOF_PEOPLE = 10000; // Exercise arrays of this size
171 
172     static int MIN_ACTIVE_GC_COUNT = 10; // Run active workload for this number of GC passes
173 
174     static int MED_ACTIVE_GC_COUNT = 4;  // Medium life span in terms of GC passes
175 
176     static final String TEST_STRING1 = &quot;Test String 1&quot;;
177     static final String TEST_STRING2 = &quot;Test String 2&quot;;
</pre>
</td>
</tr>
</table>
<center><a href="FlattenableSemanticTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="InlineTypeCreation.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>