<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/runtime/arguments.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../prims/whitebox.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="globals.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/runtime/arguments.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
2144   status = CompilerConfig::check_args_consistency(status);
2145 #if INCLUDE_JVMCI
2146   if (status &amp;&amp; EnableJVMCI) {
2147     PropertyList_unique_add(&amp;_system_properties, &quot;jdk.internal.vm.ci.enabled&quot;, &quot;true&quot;,
2148         AddProperty, UnwriteableProperty, InternalProperty);
2149     if (!create_numbered_module_property(&quot;jdk.module.addmods&quot;, &quot;jdk.internal.vm.ci&quot;, addmods_count++)) {
2150       return false;
2151     }
2152   }
2153 #endif
2154 
2155 #ifndef SUPPORT_RESERVED_STACK_AREA
2156   if (StackReservedPages != 0) {
2157     FLAG_SET_CMDLINE(StackReservedPages, 0);
2158     warning(&quot;Reserved Stack Area not supported on this platform&quot;);
2159   }
2160 #endif
2161 
2162   status = status &amp;&amp; GCArguments::check_args_consistency();
2163 










2164   return status;
2165 }
2166 
2167 bool Arguments::is_bad_option(const JavaVMOption* option, jboolean ignore,
2168   const char* option_type) {
2169   if (ignore) return false;
2170 
2171   const char* spacer = &quot; &quot;;
2172   if (option_type == NULL) {
2173     option_type = ++spacer; // Set both to the empty string.
2174   }
2175 
2176   jio_fprintf(defaultStream::error_stream(),
2177               &quot;Unrecognized %s%soption: %s\n&quot;, option_type, spacer,
2178               option-&gt;optionString);
2179   return true;
2180 }
2181 
2182 static const char* user_assertion_options[] = {
2183   &quot;-da&quot;, &quot;-ea&quot;, &quot;-disableassertions&quot;, &quot;-enableassertions&quot;, 0
</pre>
<hr />
<pre>
3062 #endif // INCLUDE_JVMCI
3063 #if INCLUDE_JFR
3064     } else if (match_jfr_option(&amp;option)) {
3065       return JNI_EINVAL;
3066 #endif
3067     } else if (match_option(option, &quot;-XX:&quot;, &amp;tail)) { // -XX:xxxx
3068       // Skip -XX:Flags= and -XX:VMOptionsFile= since those cases have
3069       // already been handled
3070       if ((strncmp(tail, &quot;Flags=&quot;, strlen(&quot;Flags=&quot;)) != 0) &amp;&amp;
3071           (strncmp(tail, &quot;VMOptionsFile=&quot;, strlen(&quot;VMOptionsFile=&quot;)) != 0)) {
3072         if (!process_argument(tail, args-&gt;ignoreUnrecognized, origin)) {
3073           return JNI_EINVAL;
3074         }
3075       }
3076     // Unknown option
3077     } else if (is_bad_option(option, args-&gt;ignoreUnrecognized)) {
3078       return JNI_ERR;
3079     }
3080   }
3081 


















3082   // PrintSharedArchiveAndExit will turn on
3083   //   -Xshare:on
3084   //   -Xlog:class+path=info
3085   if (PrintSharedArchiveAndExit) {
3086     if (FLAG_SET_CMDLINE(UseSharedSpaces, true) != JVMFlag::SUCCESS) {
3087       return JNI_EINVAL;
3088     }
3089     if (FLAG_SET_CMDLINE(RequireSharedSpaces, true) != JVMFlag::SUCCESS) {
3090       return JNI_EINVAL;
3091     }
3092     LogConfiguration::configure_stdout(LogLevel::Info, true, LOG_TAGS(class, path));
3093   }
3094 
3095   fix_appclasspath();
3096 
3097   return JNI_OK;
3098 }
3099 
3100 void Arguments::add_patch_mod_prefix(const char* module_name, const char* path, bool* patch_mod_javabase) {
3101   // For java.base check for duplicate --patch-module options being specified on the command line.
</pre>
<hr />
<pre>
4156   FLAG_SET_DEFAULT(UseBiasedLocking, false);
4157   LP64_ONLY(FLAG_SET_DEFAULT(UseCompressedOops, false));
4158   LP64_ONLY(FLAG_SET_DEFAULT(UseCompressedClassPointers, false));
4159 #endif // CC_INTERP
4160 
4161   if (PrintAssembly &amp;&amp; FLAG_IS_DEFAULT(DebugNonSafepoints)) {
4162     warning(&quot;PrintAssembly is enabled; turning on DebugNonSafepoints to gain additional output&quot;);
4163     DebugNonSafepoints = true;
4164   }
4165 
4166   if (FLAG_IS_CMDLINE(CompressedClassSpaceSize) &amp;&amp; !UseCompressedClassPointers) {
4167     warning(&quot;Setting CompressedClassSpaceSize has no effect when compressed class pointers are not used&quot;);
4168   }
4169 
4170   // Treat the odd case where local verification is enabled but remote
4171   // verification is not as if both were enabled.
4172   if (BytecodeVerificationLocal &amp;&amp; !BytecodeVerificationRemote) {
4173     log_info(verification)(&quot;Turning on remote verification because local verification is on&quot;);
4174     FLAG_SET_DEFAULT(BytecodeVerificationRemote, true);
4175   }





4176 
4177 #ifndef PRODUCT
4178   if (!LogVMOutput &amp;&amp; FLAG_IS_DEFAULT(LogVMOutput)) {
4179     if (use_vm_log()) {
4180       LogVMOutput = true;
4181     }
4182   }
4183 #endif // PRODUCT
4184 
4185   if (PrintCommandLineFlags) {
4186     JVMFlag::printSetFlags(tty);
4187   }
4188 
4189   // Apply CPU specific policy for the BiasedLocking
4190   if (UseBiasedLocking) {
4191     if (!VM_Version::use_biased_locking() &amp;&amp;
4192         !(FLAG_IS_CMDLINE(UseBiasedLocking))) {
4193       UseBiasedLocking = false;
4194     }
4195   }
</pre>
</td>
<td>
<hr />
<pre>
2144   status = CompilerConfig::check_args_consistency(status);
2145 #if INCLUDE_JVMCI
2146   if (status &amp;&amp; EnableJVMCI) {
2147     PropertyList_unique_add(&amp;_system_properties, &quot;jdk.internal.vm.ci.enabled&quot;, &quot;true&quot;,
2148         AddProperty, UnwriteableProperty, InternalProperty);
2149     if (!create_numbered_module_property(&quot;jdk.module.addmods&quot;, &quot;jdk.internal.vm.ci&quot;, addmods_count++)) {
2150       return false;
2151     }
2152   }
2153 #endif
2154 
2155 #ifndef SUPPORT_RESERVED_STACK_AREA
2156   if (StackReservedPages != 0) {
2157     FLAG_SET_CMDLINE(StackReservedPages, 0);
2158     warning(&quot;Reserved Stack Area not supported on this platform&quot;);
2159   }
2160 #endif
2161 
2162   status = status &amp;&amp; GCArguments::check_args_consistency();
2163 
<span class="line-added">2164   if (AMD64_ONLY(false &amp;&amp;) !FLAG_IS_DEFAULT(InlineTypePassFieldsAsArgs)) {</span>
<span class="line-added">2165     FLAG_SET_CMDLINE(InlineTypePassFieldsAsArgs, false);</span>
<span class="line-added">2166     warning(&quot;InlineTypePassFieldsAsArgs is not supported on this platform&quot;);</span>
<span class="line-added">2167   }</span>
<span class="line-added">2168 </span>
<span class="line-added">2169   if (AMD64_ONLY(false &amp;&amp;) !FLAG_IS_DEFAULT(InlineTypeReturnedAsFields)) {</span>
<span class="line-added">2170     FLAG_SET_CMDLINE(InlineTypeReturnedAsFields, false);</span>
<span class="line-added">2171     warning(&quot;InlineTypeReturnedAsFields is not supported on this platform&quot;);</span>
<span class="line-added">2172   }</span>
<span class="line-added">2173 </span>
2174   return status;
2175 }
2176 
2177 bool Arguments::is_bad_option(const JavaVMOption* option, jboolean ignore,
2178   const char* option_type) {
2179   if (ignore) return false;
2180 
2181   const char* spacer = &quot; &quot;;
2182   if (option_type == NULL) {
2183     option_type = ++spacer; // Set both to the empty string.
2184   }
2185 
2186   jio_fprintf(defaultStream::error_stream(),
2187               &quot;Unrecognized %s%soption: %s\n&quot;, option_type, spacer,
2188               option-&gt;optionString);
2189   return true;
2190 }
2191 
2192 static const char* user_assertion_options[] = {
2193   &quot;-da&quot;, &quot;-ea&quot;, &quot;-disableassertions&quot;, &quot;-enableassertions&quot;, 0
</pre>
<hr />
<pre>
3072 #endif // INCLUDE_JVMCI
3073 #if INCLUDE_JFR
3074     } else if (match_jfr_option(&amp;option)) {
3075       return JNI_EINVAL;
3076 #endif
3077     } else if (match_option(option, &quot;-XX:&quot;, &amp;tail)) { // -XX:xxxx
3078       // Skip -XX:Flags= and -XX:VMOptionsFile= since those cases have
3079       // already been handled
3080       if ((strncmp(tail, &quot;Flags=&quot;, strlen(&quot;Flags=&quot;)) != 0) &amp;&amp;
3081           (strncmp(tail, &quot;VMOptionsFile=&quot;, strlen(&quot;VMOptionsFile=&quot;)) != 0)) {
3082         if (!process_argument(tail, args-&gt;ignoreUnrecognized, origin)) {
3083           return JNI_EINVAL;
3084         }
3085       }
3086     // Unknown option
3087     } else if (is_bad_option(option, args-&gt;ignoreUnrecognized)) {
3088       return JNI_ERR;
3089     }
3090   }
3091 
<span class="line-added">3092   if (EnableValhalla) {</span>
<span class="line-added">3093     // create_property(&quot;valhalla.enableValhalla&quot;, &quot;true&quot;, InternalProperty)</span>
<span class="line-added">3094     const char* prop_name = &quot;valhalla.enableValhalla&quot;;</span>
<span class="line-added">3095     const char* prop_value = &quot;true&quot;;</span>
<span class="line-added">3096     const size_t prop_len = strlen(prop_name) + strlen(prop_value) + 2;</span>
<span class="line-added">3097     char* property = AllocateHeap(prop_len, mtArguments);</span>
<span class="line-added">3098     int ret = jio_snprintf(property, prop_len, &quot;%s=%s&quot;, prop_name, prop_value);</span>
<span class="line-added">3099     if (ret &lt; 0 || ret &gt;= (int)prop_len) {</span>
<span class="line-added">3100       FreeHeap(property);</span>
<span class="line-added">3101       return JNI_ENOMEM;</span>
<span class="line-added">3102     }</span>
<span class="line-added">3103     bool added = add_property(property, UnwriteableProperty, InternalProperty);</span>
<span class="line-added">3104     FreeHeap(property);</span>
<span class="line-added">3105     if (!added) {</span>
<span class="line-added">3106       return JNI_ENOMEM;</span>
<span class="line-added">3107     }</span>
<span class="line-added">3108   }</span>
<span class="line-added">3109 </span>
3110   // PrintSharedArchiveAndExit will turn on
3111   //   -Xshare:on
3112   //   -Xlog:class+path=info
3113   if (PrintSharedArchiveAndExit) {
3114     if (FLAG_SET_CMDLINE(UseSharedSpaces, true) != JVMFlag::SUCCESS) {
3115       return JNI_EINVAL;
3116     }
3117     if (FLAG_SET_CMDLINE(RequireSharedSpaces, true) != JVMFlag::SUCCESS) {
3118       return JNI_EINVAL;
3119     }
3120     LogConfiguration::configure_stdout(LogLevel::Info, true, LOG_TAGS(class, path));
3121   }
3122 
3123   fix_appclasspath();
3124 
3125   return JNI_OK;
3126 }
3127 
3128 void Arguments::add_patch_mod_prefix(const char* module_name, const char* path, bool* patch_mod_javabase) {
3129   // For java.base check for duplicate --patch-module options being specified on the command line.
</pre>
<hr />
<pre>
4184   FLAG_SET_DEFAULT(UseBiasedLocking, false);
4185   LP64_ONLY(FLAG_SET_DEFAULT(UseCompressedOops, false));
4186   LP64_ONLY(FLAG_SET_DEFAULT(UseCompressedClassPointers, false));
4187 #endif // CC_INTERP
4188 
4189   if (PrintAssembly &amp;&amp; FLAG_IS_DEFAULT(DebugNonSafepoints)) {
4190     warning(&quot;PrintAssembly is enabled; turning on DebugNonSafepoints to gain additional output&quot;);
4191     DebugNonSafepoints = true;
4192   }
4193 
4194   if (FLAG_IS_CMDLINE(CompressedClassSpaceSize) &amp;&amp; !UseCompressedClassPointers) {
4195     warning(&quot;Setting CompressedClassSpaceSize has no effect when compressed class pointers are not used&quot;);
4196   }
4197 
4198   // Treat the odd case where local verification is enabled but remote
4199   // verification is not as if both were enabled.
4200   if (BytecodeVerificationLocal &amp;&amp; !BytecodeVerificationRemote) {
4201     log_info(verification)(&quot;Turning on remote verification because local verification is on&quot;);
4202     FLAG_SET_DEFAULT(BytecodeVerificationRemote, true);
4203   }
<span class="line-added">4204   if (!EnableValhalla || (is_interpreter_only() &amp;&amp; !is_dumping_archive())) {</span>
<span class="line-added">4205     // Disable calling convention optimizations if value types are not supported</span>
<span class="line-added">4206     InlineTypePassFieldsAsArgs = false;</span>
<span class="line-added">4207     InlineTypeReturnedAsFields = false;</span>
<span class="line-added">4208   }</span>
4209 
4210 #ifndef PRODUCT
4211   if (!LogVMOutput &amp;&amp; FLAG_IS_DEFAULT(LogVMOutput)) {
4212     if (use_vm_log()) {
4213       LogVMOutput = true;
4214     }
4215   }
4216 #endif // PRODUCT
4217 
4218   if (PrintCommandLineFlags) {
4219     JVMFlag::printSetFlags(tty);
4220   }
4221 
4222   // Apply CPU specific policy for the BiasedLocking
4223   if (UseBiasedLocking) {
4224     if (!VM_Version::use_biased_locking() &amp;&amp;
4225         !(FLAG_IS_CMDLINE(UseBiasedLocking))) {
4226       UseBiasedLocking = false;
4227     }
4228   }
</pre>
</td>
</tr>
</table>
<center><a href="../prims/whitebox.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="globals.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>