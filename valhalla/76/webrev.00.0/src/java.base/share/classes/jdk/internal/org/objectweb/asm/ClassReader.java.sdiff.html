<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/jdk/internal/org/objectweb/asm/ClassReader.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../java/lang/invoke/VarHandles.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="Constants.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/jdk/internal/org/objectweb/asm/ClassReader.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 482         // - The string corresponding to the SourceDebugExtension attribute, or null.
 483         String sourceDebugExtension = null;
 484         // - The offset of the RuntimeVisibleAnnotations attribute, or 0.
 485         int runtimeVisibleAnnotationsOffset = 0;
 486         // - The offset of the RuntimeInvisibleAnnotations attribute, or 0.
 487         int runtimeInvisibleAnnotationsOffset = 0;
 488         // - The offset of the RuntimeVisibleTypeAnnotations attribute, or 0.
 489         int runtimeVisibleTypeAnnotationsOffset = 0;
 490         // - The offset of the RuntimeInvisibleTypeAnnotations attribute, or 0.
 491         int runtimeInvisibleTypeAnnotationsOffset = 0;
 492         // - The offset of the Module attribute, or 0.
 493         int moduleOffset = 0;
 494         // - The offset of the ModulePackages attribute, or 0.
 495         int modulePackagesOffset = 0;
 496         // - The string corresponding to the ModuleMainClass attribute, or null.
 497         String moduleMainClass = null;
 498         // - The string corresponding to the NestHost attribute, or null.
 499         String nestHostClass = null;
 500         // - The offset of the NestMembers attribute, or 0.
 501         int nestMembersOffset = 0;
<span class="line-modified"> 502         // - The offset of the PermittedSubtypes attribute, or 0</span>
<span class="line-modified"> 503         int permittedSubtypesOffset = 0;</span>
 504         // - The offset of the Record attribute, or 0.
 505         int recordOffset = 0;
 506         // - The non standard attributes (linked with their {@link Attribute#nextAttribute} field).
 507         //   This list in the &lt;i&gt;reverse order&lt;/i&gt; or their order in the ClassFile structure.
 508         Attribute attributes = null;
 509 
 510         int currentAttributeOffset = getFirstAttributeOffset();
 511         for (int i = readUnsignedShort(currentAttributeOffset - 2); i &gt; 0; --i) {
 512             // Read the attribute_info&#39;s attribute_name and attribute_length fields.
 513             String attributeName = readUTF8(currentAttributeOffset, charBuffer);
 514             int attributeLength = readInt(currentAttributeOffset + 2);
 515             currentAttributeOffset += 6;
 516             // The tests are sorted in decreasing frequency order (based on frequencies observed on
 517             // typical classes).
 518             if (Constants.SOURCE_FILE.equals(attributeName)) {
 519                 sourceFile = readUTF8(currentAttributeOffset, charBuffer);
 520             } else if (Constants.INNER_CLASSES.equals(attributeName)) {
 521                 innerClassesOffset = currentAttributeOffset;
 522             } else if (Constants.ENCLOSING_METHOD.equals(attributeName)) {
 523                 enclosingMethodOffset = currentAttributeOffset;
 524             } else if (Constants.NEST_HOST.equals(attributeName)) {
 525                 nestHostClass = readClass(currentAttributeOffset, charBuffer);
 526             } else if (Constants.NEST_MEMBERS.equals(attributeName)) {
 527                 nestMembersOffset = currentAttributeOffset;
<span class="line-modified"> 528             } else if (Constants.PERMITTED_SUBTYPES.equals(attributeName)) {</span>
<span class="line-modified"> 529                 permittedSubtypesOffset = currentAttributeOffset;</span>
 530             } else if (Constants.SIGNATURE.equals(attributeName)) {
 531                 signature = readUTF8(currentAttributeOffset, charBuffer);
 532             } else if (Constants.RUNTIME_VISIBLE_ANNOTATIONS.equals(attributeName)) {
 533                 runtimeVisibleAnnotationsOffset = currentAttributeOffset;
 534             } else if (Constants.RUNTIME_VISIBLE_TYPE_ANNOTATIONS.equals(attributeName)) {
 535                 runtimeVisibleTypeAnnotationsOffset = currentAttributeOffset;
 536             } else if (Constants.DEPRECATED.equals(attributeName)) {
 537                 accessFlags |= Opcodes.ACC_DEPRECATED;
 538             } else if (Constants.SYNTHETIC.equals(attributeName)) {
 539                 accessFlags |= Opcodes.ACC_SYNTHETIC;
 540             } else if (Constants.SOURCE_DEBUG_EXTENSION.equals(attributeName)) {
 541                 sourceDebugExtension =
 542                         readUtf(currentAttributeOffset, attributeLength, new char[attributeLength]);
 543             } else if (Constants.RUNTIME_INVISIBLE_ANNOTATIONS.equals(attributeName)) {
 544                 runtimeInvisibleAnnotationsOffset = currentAttributeOffset;
 545             } else if (Constants.RUNTIME_INVISIBLE_TYPE_ANNOTATIONS.equals(attributeName)) {
 546                 runtimeInvisibleTypeAnnotationsOffset = currentAttributeOffset;
 547             } else if (Constants.RECORD.equals(attributeName)) {
 548                 recordOffset = currentAttributeOffset;
 549                 accessFlags |= Opcodes.ACC_RECORD;
</pre>
<hr />
<pre>
 687 
 688         // Visit the non standard attributes.
 689         while (attributes != null) {
 690             // Copy and reset the nextAttribute field so that it can also be used in ClassWriter.
 691             Attribute nextAttribute = attributes.nextAttribute;
 692             attributes.nextAttribute = null;
 693             classVisitor.visitAttribute(attributes);
 694             attributes = nextAttribute;
 695         }
 696 
 697         // Visit the NestedMembers attribute.
 698         if (nestMembersOffset != 0) {
 699             int numberOfNestMembers = readUnsignedShort(nestMembersOffset);
 700             int currentNestMemberOffset = nestMembersOffset + 2;
 701             while (numberOfNestMembers-- &gt; 0) {
 702                 classVisitor.visitNestMember(readClass(currentNestMemberOffset, charBuffer));
 703                 currentNestMemberOffset += 2;
 704             }
 705         }
 706 
<span class="line-modified"> 707         // Visit the PermittedSubtypes attribute.</span>
<span class="line-modified"> 708         if (permittedSubtypesOffset != 0) {</span>
<span class="line-modified"> 709             int numberOfPermittedSubtypes = readUnsignedShort(permittedSubtypesOffset);</span>
<span class="line-modified"> 710             int currentPermittedSubtypeOffset = permittedSubtypesOffset + 2;</span>
<span class="line-modified"> 711             while (numberOfPermittedSubtypes-- &gt; 0) {</span>
<span class="line-modified"> 712                 classVisitor.visitPermittedSubtypeExperimental(</span>
<span class="line-modified"> 713                         readClass(currentPermittedSubtypeOffset, charBuffer));</span>
<span class="line-modified"> 714                 currentPermittedSubtypeOffset += 2;</span>
 715             }
 716         }
 717 
 718         // Visit the InnerClasses attribute.
 719         if (innerClassesOffset != 0) {
 720             int numberOfClasses = readUnsignedShort(innerClassesOffset);
 721             int currentClassesOffset = innerClassesOffset + 2;
 722             while (numberOfClasses-- &gt; 0) {
 723                 classVisitor.visitInnerClass(
 724                         readClass(currentClassesOffset, charBuffer),
 725                         readClass(currentClassesOffset + 2, charBuffer),
 726                         readUTF8(currentClassesOffset + 4, charBuffer),
 727                         readUnsignedShort(currentClassesOffset + 6));
 728                 currentClassesOffset += 8;
 729             }
 730         }
 731 
 732         // Visit Record components.
 733         if (recordOffset != 0) {
 734             int recordComponentsCount = readUnsignedShort(recordOffset);
</pre>
</td>
<td>
<hr />
<pre>
 482         // - The string corresponding to the SourceDebugExtension attribute, or null.
 483         String sourceDebugExtension = null;
 484         // - The offset of the RuntimeVisibleAnnotations attribute, or 0.
 485         int runtimeVisibleAnnotationsOffset = 0;
 486         // - The offset of the RuntimeInvisibleAnnotations attribute, or 0.
 487         int runtimeInvisibleAnnotationsOffset = 0;
 488         // - The offset of the RuntimeVisibleTypeAnnotations attribute, or 0.
 489         int runtimeVisibleTypeAnnotationsOffset = 0;
 490         // - The offset of the RuntimeInvisibleTypeAnnotations attribute, or 0.
 491         int runtimeInvisibleTypeAnnotationsOffset = 0;
 492         // - The offset of the Module attribute, or 0.
 493         int moduleOffset = 0;
 494         // - The offset of the ModulePackages attribute, or 0.
 495         int modulePackagesOffset = 0;
 496         // - The string corresponding to the ModuleMainClass attribute, or null.
 497         String moduleMainClass = null;
 498         // - The string corresponding to the NestHost attribute, or null.
 499         String nestHostClass = null;
 500         // - The offset of the NestMembers attribute, or 0.
 501         int nestMembersOffset = 0;
<span class="line-modified"> 502         // - The offset of the PermittedSubclasses attribute, or 0</span>
<span class="line-modified"> 503         int permittedSubclassesOffset = 0;</span>
 504         // - The offset of the Record attribute, or 0.
 505         int recordOffset = 0;
 506         // - The non standard attributes (linked with their {@link Attribute#nextAttribute} field).
 507         //   This list in the &lt;i&gt;reverse order&lt;/i&gt; or their order in the ClassFile structure.
 508         Attribute attributes = null;
 509 
 510         int currentAttributeOffset = getFirstAttributeOffset();
 511         for (int i = readUnsignedShort(currentAttributeOffset - 2); i &gt; 0; --i) {
 512             // Read the attribute_info&#39;s attribute_name and attribute_length fields.
 513             String attributeName = readUTF8(currentAttributeOffset, charBuffer);
 514             int attributeLength = readInt(currentAttributeOffset + 2);
 515             currentAttributeOffset += 6;
 516             // The tests are sorted in decreasing frequency order (based on frequencies observed on
 517             // typical classes).
 518             if (Constants.SOURCE_FILE.equals(attributeName)) {
 519                 sourceFile = readUTF8(currentAttributeOffset, charBuffer);
 520             } else if (Constants.INNER_CLASSES.equals(attributeName)) {
 521                 innerClassesOffset = currentAttributeOffset;
 522             } else if (Constants.ENCLOSING_METHOD.equals(attributeName)) {
 523                 enclosingMethodOffset = currentAttributeOffset;
 524             } else if (Constants.NEST_HOST.equals(attributeName)) {
 525                 nestHostClass = readClass(currentAttributeOffset, charBuffer);
 526             } else if (Constants.NEST_MEMBERS.equals(attributeName)) {
 527                 nestMembersOffset = currentAttributeOffset;
<span class="line-modified"> 528             } else if (Constants.PERMITTED_SUBCLASSES.equals(attributeName)) {</span>
<span class="line-modified"> 529                 permittedSubclassesOffset = currentAttributeOffset;</span>
 530             } else if (Constants.SIGNATURE.equals(attributeName)) {
 531                 signature = readUTF8(currentAttributeOffset, charBuffer);
 532             } else if (Constants.RUNTIME_VISIBLE_ANNOTATIONS.equals(attributeName)) {
 533                 runtimeVisibleAnnotationsOffset = currentAttributeOffset;
 534             } else if (Constants.RUNTIME_VISIBLE_TYPE_ANNOTATIONS.equals(attributeName)) {
 535                 runtimeVisibleTypeAnnotationsOffset = currentAttributeOffset;
 536             } else if (Constants.DEPRECATED.equals(attributeName)) {
 537                 accessFlags |= Opcodes.ACC_DEPRECATED;
 538             } else if (Constants.SYNTHETIC.equals(attributeName)) {
 539                 accessFlags |= Opcodes.ACC_SYNTHETIC;
 540             } else if (Constants.SOURCE_DEBUG_EXTENSION.equals(attributeName)) {
 541                 sourceDebugExtension =
 542                         readUtf(currentAttributeOffset, attributeLength, new char[attributeLength]);
 543             } else if (Constants.RUNTIME_INVISIBLE_ANNOTATIONS.equals(attributeName)) {
 544                 runtimeInvisibleAnnotationsOffset = currentAttributeOffset;
 545             } else if (Constants.RUNTIME_INVISIBLE_TYPE_ANNOTATIONS.equals(attributeName)) {
 546                 runtimeInvisibleTypeAnnotationsOffset = currentAttributeOffset;
 547             } else if (Constants.RECORD.equals(attributeName)) {
 548                 recordOffset = currentAttributeOffset;
 549                 accessFlags |= Opcodes.ACC_RECORD;
</pre>
<hr />
<pre>
 687 
 688         // Visit the non standard attributes.
 689         while (attributes != null) {
 690             // Copy and reset the nextAttribute field so that it can also be used in ClassWriter.
 691             Attribute nextAttribute = attributes.nextAttribute;
 692             attributes.nextAttribute = null;
 693             classVisitor.visitAttribute(attributes);
 694             attributes = nextAttribute;
 695         }
 696 
 697         // Visit the NestedMembers attribute.
 698         if (nestMembersOffset != 0) {
 699             int numberOfNestMembers = readUnsignedShort(nestMembersOffset);
 700             int currentNestMemberOffset = nestMembersOffset + 2;
 701             while (numberOfNestMembers-- &gt; 0) {
 702                 classVisitor.visitNestMember(readClass(currentNestMemberOffset, charBuffer));
 703                 currentNestMemberOffset += 2;
 704             }
 705         }
 706 
<span class="line-modified"> 707         // Visit the PermittedSubclasses attribute.</span>
<span class="line-modified"> 708         if (permittedSubclassesOffset != 0) {</span>
<span class="line-modified"> 709             int numberOfPermittedSubclasses = readUnsignedShort(permittedSubclassesOffset);</span>
<span class="line-modified"> 710             int currentPermittedSubclassOffset = permittedSubclassesOffset + 2;</span>
<span class="line-modified"> 711             while (numberOfPermittedSubclasses-- &gt; 0) {</span>
<span class="line-modified"> 712                 classVisitor.visitPermittedSubclassExperimental(</span>
<span class="line-modified"> 713                         readClass(currentPermittedSubclassOffset, charBuffer));</span>
<span class="line-modified"> 714                 currentPermittedSubclassOffset += 2;</span>
 715             }
 716         }
 717 
 718         // Visit the InnerClasses attribute.
 719         if (innerClassesOffset != 0) {
 720             int numberOfClasses = readUnsignedShort(innerClassesOffset);
 721             int currentClassesOffset = innerClassesOffset + 2;
 722             while (numberOfClasses-- &gt; 0) {
 723                 classVisitor.visitInnerClass(
 724                         readClass(currentClassesOffset, charBuffer),
 725                         readClass(currentClassesOffset + 2, charBuffer),
 726                         readUTF8(currentClassesOffset + 4, charBuffer),
 727                         readUnsignedShort(currentClassesOffset + 6));
 728                 currentClassesOffset += 8;
 729             }
 730         }
 731 
 732         // Visit Record components.
 733         if (recordOffset != 0) {
 734             int recordComponentsCount = readUnsignedShort(recordOffset);
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../java/lang/invoke/VarHandles.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="Constants.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>