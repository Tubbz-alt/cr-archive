<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/cpu/x86/templateInterpreterGenerator_x86.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="methodHandles_x86.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../share/c1/c1_GraphBuilder.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/x86/templateInterpreterGenerator_x86.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 707 address TemplateInterpreterGenerator::generate_Reference_get_entry(void) {
 708   // Code: _aload_0, _getfield, _areturn
 709   // parameter size = 1
 710   //
 711   // The code that gets generated by this routine is split into 2 parts:
 712   //    1. The &quot;intrinsified&quot; code performing an ON_WEAK_OOP_REF load,
 713   //    2. The slow path - which is an expansion of the regular method entry.
 714   //
 715   // Notes:-
 716   // * An intrinsic is always executed, where an ON_WEAK_OOP_REF load is performed.
 717   // * We may jump to the slow path iff the receiver is null. If the
 718   //   Reference object is null then we no longer perform an ON_WEAK_OOP_REF load
 719   //   Thus we can use the regular method entry code to generate the NPE.
 720   //
 721   // rbx: Method*
 722 
 723   // r13: senderSP must preserve for slow path, set SP to it on fast path
 724 
 725   address entry = __ pc();
 726 
<span class="line-modified"> 727   const int referent_offset = java_lang_ref_Reference::referent_offset;</span>
<span class="line-removed"> 728   guarantee(referent_offset &gt; 0, &quot;referent offset not initialized&quot;);</span>
 729 
 730   Label slow_path;
 731   // rbx: method
 732 
 733   // Check if local 0 != NULL
 734   // If the receiver is null then it is OK to jump to the slow path.
 735   __ movptr(rax, Address(rsp, wordSize));
 736 
 737   __ testptr(rax, rax);
 738   __ jcc(Assembler::zero, slow_path);
 739 
 740   // rax: local 0
 741   // rbx: method (but can be used as scratch now)
 742   // rdx: scratch
 743   // rdi: scratch
 744 
 745   // Preserve the sender sp in case the load barrier
 746   // calls the runtime
 747   NOT_LP64(__ push(rsi));
 748 
</pre>
</td>
<td>
<hr />
<pre>
 707 address TemplateInterpreterGenerator::generate_Reference_get_entry(void) {
 708   // Code: _aload_0, _getfield, _areturn
 709   // parameter size = 1
 710   //
 711   // The code that gets generated by this routine is split into 2 parts:
 712   //    1. The &quot;intrinsified&quot; code performing an ON_WEAK_OOP_REF load,
 713   //    2. The slow path - which is an expansion of the regular method entry.
 714   //
 715   // Notes:-
 716   // * An intrinsic is always executed, where an ON_WEAK_OOP_REF load is performed.
 717   // * We may jump to the slow path iff the receiver is null. If the
 718   //   Reference object is null then we no longer perform an ON_WEAK_OOP_REF load
 719   //   Thus we can use the regular method entry code to generate the NPE.
 720   //
 721   // rbx: Method*
 722 
 723   // r13: senderSP must preserve for slow path, set SP to it on fast path
 724 
 725   address entry = __ pc();
 726 
<span class="line-modified"> 727   const int referent_offset = java_lang_ref_Reference::referent_offset();</span>

 728 
 729   Label slow_path;
 730   // rbx: method
 731 
 732   // Check if local 0 != NULL
 733   // If the receiver is null then it is OK to jump to the slow path.
 734   __ movptr(rax, Address(rsp, wordSize));
 735 
 736   __ testptr(rax, rax);
 737   __ jcc(Assembler::zero, slow_path);
 738 
 739   // rax: local 0
 740   // rbx: method (but can be used as scratch now)
 741   // rdx: scratch
 742   // rdi: scratch
 743 
 744   // Preserve the sender sp in case the load barrier
 745   // calls the runtime
 746   NOT_LP64(__ push(rsi));
 747 
</pre>
</td>
</tr>
</table>
<center><a href="methodHandles_x86.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../share/c1/c1_GraphBuilder.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>