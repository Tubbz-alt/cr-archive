<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/classfile/javaClasses.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="javaClasses.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="vmSymbols.hpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/classfile/javaClasses.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 79,10 ***</span>
<span class="line-new-header">--- 79,12 ---</span>
  
  #define BASIC_JAVA_CLASSES_DO(f) \
          BASIC_JAVA_CLASSES_DO_PART1(f) \
          BASIC_JAVA_CLASSES_DO_PART2(f)
  
<span class="line-added">+ #define CHECK_INIT(offset)  assert(offset != 0, &quot;should be initialized&quot;); return offset;</span>
<span class="line-added">+ </span>
  // Interface to java.lang.Object objects
  
  class java_lang_Object : AllStatic {
   public:
    static void register_natives(TRAPS);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 90,16 ***</span>
  
  // Interface to java.lang.String objects
  
  class java_lang_String : AllStatic {
   private:
<span class="line-modified">!   static int value_offset;</span>
<span class="line-modified">!   static int hash_offset;</span>
<span class="line-modified">!   static int hashIsZero_offset;</span>
<span class="line-modified">!   static int coder_offset;</span>
  
<span class="line-modified">!   static bool initialized;</span>
  
    static Handle basic_create(int length, bool byte_arr, TRAPS);
  
    static inline void set_coder(oop string, jbyte coder);
  
<span class="line-new-header">--- 92,16 ---</span>
  
  // Interface to java.lang.String objects
  
  class java_lang_String : AllStatic {
   private:
<span class="line-modified">!   static int _value_offset;</span>
<span class="line-modified">!   static int _hash_offset;</span>
<span class="line-modified">!   static int _hashIsZero_offset;</span>
<span class="line-modified">!   static int _coder_offset;</span>
  
<span class="line-modified">!   static bool _initialized;</span>
  
    static Handle basic_create(int length, bool byte_arr, TRAPS);
  
    static inline void set_coder(oop string, jbyte coder);
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 123,26 ***</span>
    static Handle create_from_platform_dependent_str(const char* str, TRAPS);
    static Handle char_converter(Handle java_string, jchar from_char, jchar to_char, TRAPS);
  
    static void set_compact_strings(bool value);
  
<span class="line-modified">!   static int value_offset_in_bytes()  {</span>
<span class="line-modified">!     assert(initialized &amp;&amp; (value_offset &gt; 0), &quot;Must be initialized&quot;);</span>
<span class="line-removed">-     return value_offset;</span>
<span class="line-removed">-   }</span>
<span class="line-removed">-   static int hash_offset_in_bytes()   {</span>
<span class="line-removed">-     assert(initialized &amp;&amp; (hash_offset &gt; 0), &quot;Must be initialized&quot;);</span>
<span class="line-removed">-     return hash_offset;</span>
<span class="line-removed">-   }</span>
<span class="line-removed">-   static int hashIsZero_offset_in_bytes()   {</span>
<span class="line-removed">-     assert(initialized &amp;&amp; (hashIsZero_offset &gt; 0), &quot;Must be initialized&quot;);</span>
<span class="line-removed">-     return hashIsZero_offset;</span>
<span class="line-removed">-   }</span>
<span class="line-removed">-   static int coder_offset_in_bytes()   {</span>
<span class="line-removed">-     assert(initialized &amp;&amp; (coder_offset &gt; 0), &quot;Must be initialized&quot;);</span>
<span class="line-removed">-     return coder_offset;</span>
<span class="line-removed">-   }</span>
  
    static inline void set_value_raw(oop string, typeArrayOop buffer);
    static inline void set_value(oop string, typeArrayOop buffer);
  
    // Accessors
<span class="line-new-header">--- 125,12 ---</span>
    static Handle create_from_platform_dependent_str(const char* str, TRAPS);
    static Handle char_converter(Handle java_string, jchar from_char, jchar to_char, TRAPS);
  
    static void set_compact_strings(bool value);
  
<span class="line-modified">!   static int value_offset() { CHECK_INIT(_value_offset); }</span>
<span class="line-modified">!   static int coder_offset() { CHECK_INIT(_coder_offset); }</span>
  
    static inline void set_value_raw(oop string, typeArrayOop buffer);
    static inline void set_value(oop string, typeArrayOop buffer);
  
    // Accessors
</pre>
<hr />
<pre>
<span class="line-old-header">*** 236,10 ***</span>
<span class="line-new-header">--- 224,11 ---</span>
  class java_lang_Class : AllStatic {
    friend class VMStructs;
    friend class JVMCIVMStructs;
  
   private:
<span class="line-added">+ </span>
    // The fake offsets are added by the class loader when java.lang.Class is loaded
  
    static int _klass_offset;
    static int _array_klass_offset;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 255,13 ***</span>
    static int _name_offset;
    static int _source_file_offset;
    static int _val_type_mirror_offset;
    static int _ref_type_mirror_offset;
    static int _classData_offset;
  
<span class="line-modified">!   static bool offsets_computed;</span>
<span class="line-removed">-   static int classRedefinedCount_offset;</span>
  
    static GrowableArray&lt;Klass*&gt;* _fixup_mirror_list;
    static GrowableArray&lt;Klass*&gt;* _fixup_module_field_list;
  
    static void set_init_lock(oop java_class, oop init_lock);
<span class="line-new-header">--- 244,13 ---</span>
    static int _name_offset;
    static int _source_file_offset;
    static int _val_type_mirror_offset;
    static int _ref_type_mirror_offset;
    static int _classData_offset;
<span class="line-added">+   static int _classRedefinedCount_offset;</span>
  
<span class="line-modified">!   static bool _offsets_computed;</span>
  
    static GrowableArray&lt;Klass*&gt;* _fixup_mirror_list;
    static GrowableArray&lt;Klass*&gt;* _fixup_module_field_list;
  
    static void set_init_lock(oop java_class, oop init_lock);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 311,20 ***</span>
    static oop primitive_mirror(BasicType t);
    // JVM_NewArray support
    static Klass* array_klass_acquire(oop java_class);
    static void release_set_array_klass(oop java_class, Klass* klass);
    // compiler support for class operations
<span class="line-modified">!   static int klass_offset_in_bytes()                { return _klass_offset; }</span>
<span class="line-modified">!   static int array_klass_offset_in_bytes()          { return _array_klass_offset; }</span>
<span class="line-modified">!   static int component_mirror_offset_in_bytes()     { return _component_mirror_offset; }</span>
    // Support for classRedefinedCount field
    static int classRedefinedCount(oop the_class_mirror);
    static void set_classRedefinedCount(oop the_class_mirror, int value);
  
    // Support for embedded per-class oops
    static oop  protection_domain(oop java_class);
    static oop  init_lock(oop java_class);
    static oop  component_mirror(oop java_class);
    static objArrayOop  signers(oop java_class);
    static void set_signers(oop java_class, objArrayOop signers);
    static oop  class_data(oop java_class);
    static void set_class_data(oop java_class, oop classData);
<span class="line-new-header">--- 300,23 ---</span>
    static oop primitive_mirror(BasicType t);
    // JVM_NewArray support
    static Klass* array_klass_acquire(oop java_class);
    static void release_set_array_klass(oop java_class, Klass* klass);
    // compiler support for class operations
<span class="line-modified">!   static int klass_offset()                { CHECK_INIT(_klass_offset); }</span>
<span class="line-modified">!   static int array_klass_offset()          { CHECK_INIT(_array_klass_offset); }</span>
<span class="line-modified">!   static int component_mirror_offset()     { CHECK_INIT(_component_mirror_offset); }</span>
    // Support for classRedefinedCount field
    static int classRedefinedCount(oop the_class_mirror);
    static void set_classRedefinedCount(oop the_class_mirror, int value);
  
    // Support for embedded per-class oops
    static oop  protection_domain(oop java_class);
    static oop  init_lock(oop java_class);
<span class="line-added">+   static void clear_init_lock(oop java_class) {</span>
<span class="line-added">+     set_init_lock(java_class, NULL);</span>
<span class="line-added">+   }</span>
    static oop  component_mirror(oop java_class);
    static objArrayOop  signers(oop java_class);
    static void set_signers(oop java_class, objArrayOop signers);
    static oop  class_data(oop java_class);
    static void set_class_data(oop java_class, oop classData);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 365,12 ***</span>
      _fixup_module_field_list = v;
    }
  
    // Debugging
    friend class JavaClasses;
<span class="line-removed">-   friend class InstanceKlass;   // verification code accesses offsets</span>
<span class="line-removed">-   friend class ClassFileParser; // access to number_of_fake_fields</span>
  };
  
  // Interface to java.lang.Thread objects
  
  class java_lang_Thread : AllStatic {
<span class="line-new-header">--- 357,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 537,15 ***</span>
      trace_hidden_offset  = 5,
      trace_size           = 6,
      trace_chunk_size     = 32
    };
  
<span class="line-modified">!   static int backtrace_offset;</span>
<span class="line-modified">!   static int detailMessage_offset;</span>
<span class="line-modified">!   static int stackTrace_offset;</span>
<span class="line-modified">!   static int depth_offset;</span>
<span class="line-modified">!   static int static_unassigned_stacktrace_offset;</span>
  
    // StackTrace (programmatic access, new since 1.4)
    static void clear_stacktrace(oop throwable);
    // Stacktrace (post JDK 1.7.0 to allow immutability protocol to be followed)
    static void set_stacktrace(oop throwable, oop st_element_array);
<span class="line-new-header">--- 527,15 ---</span>
      trace_hidden_offset  = 5,
      trace_size           = 6,
      trace_chunk_size     = 32
    };
  
<span class="line-modified">!   static int _backtrace_offset;</span>
<span class="line-modified">!   static int _detailMessage_offset;</span>
<span class="line-modified">!   static int _stackTrace_offset;</span>
<span class="line-modified">!   static int _depth_offset;</span>
<span class="line-modified">!   static int _static_unassigned_stacktrace_offset;</span>
  
    // StackTrace (programmatic access, new since 1.4)
    static void clear_stacktrace(oop throwable);
    // Stacktrace (post JDK 1.7.0 to allow immutability protocol to be followed)
    static void set_stacktrace(oop throwable, oop st_element_array);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 555,13 ***</span>
    // Backtrace
    static oop backtrace(oop throwable);
    static void set_backtrace(oop throwable, oop value);
    static int depth(oop throwable);
    static void set_depth(oop throwable, int value);
<span class="line-modified">!   // Needed by JVMTI to filter out this internal field.</span>
<span class="line-removed">-   static int get_backtrace_offset() { return backtrace_offset;}</span>
<span class="line-removed">-   static int get_detailMessage_offset() { return detailMessage_offset;}</span>
    // Message
    static oop message(oop throwable);
    static void set_message(oop throwable, oop value);
    static Symbol* detail_message(oop throwable);
    static void print_stack_element(outputStream *st, Method* method, int bci);
<span class="line-new-header">--- 545,11 ---</span>
    // Backtrace
    static oop backtrace(oop throwable);
    static void set_backtrace(oop throwable, oop value);
    static int depth(oop throwable);
    static void set_depth(oop throwable, int value);
<span class="line-modified">!   static int get_detailMessage_offset() { CHECK_INIT(_detailMessage_offset); }</span>
    // Message
    static oop message(oop throwable);
    static void set_message(oop throwable, oop value);
    static Symbol* detail_message(oop throwable);
    static void print_stack_element(outputStream *st, Method* method, int bci);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 594,11 ***</span>
  
  class java_lang_reflect_AccessibleObject: AllStatic {
   private:
    // Note that to reduce dependencies on the JDK we compute these
    // offsets at run-time.
<span class="line-modified">!   static int override_offset;</span>
  
    static void compute_offsets();
  
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
<span class="line-new-header">--- 582,11 ---</span>
  
  class java_lang_reflect_AccessibleObject: AllStatic {
   private:
    // Note that to reduce dependencies on the JDK we compute these
    // offsets at run-time.
<span class="line-modified">!   static int _override_offset;</span>
  
    static void compute_offsets();
  
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 616,21 ***</span>
  
  class java_lang_reflect_Method : public java_lang_reflect_AccessibleObject {
   private:
    // Note that to reduce dependencies on the JDK we compute these
    // offsets at run-time.
<span class="line-modified">!   static int clazz_offset;</span>
<span class="line-modified">!   static int name_offset;</span>
<span class="line-modified">!   static int returnType_offset;</span>
<span class="line-modified">!   static int parameterTypes_offset;</span>
<span class="line-modified">!   static int exceptionTypes_offset;</span>
<span class="line-modified">!   static int slot_offset;</span>
<span class="line-modified">!   static int modifiers_offset;</span>
<span class="line-modified">!   static int signature_offset;</span>
<span class="line-modified">!   static int annotations_offset;</span>
<span class="line-modified">!   static int parameter_annotations_offset;</span>
<span class="line-modified">!   static int annotation_default_offset;</span>
  
    static void compute_offsets();
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  
<span class="line-new-header">--- 604,21 ---</span>
  
  class java_lang_reflect_Method : public java_lang_reflect_AccessibleObject {
   private:
    // Note that to reduce dependencies on the JDK we compute these
    // offsets at run-time.
<span class="line-modified">!   static int _clazz_offset;</span>
<span class="line-modified">!   static int _name_offset;</span>
<span class="line-modified">!   static int _returnType_offset;</span>
<span class="line-modified">!   static int _parameterTypes_offset;</span>
<span class="line-modified">!   static int _exceptionTypes_offset;</span>
<span class="line-modified">!   static int _slot_offset;</span>
<span class="line-modified">!   static int _modifiers_offset;</span>
<span class="line-modified">!   static int _signature_offset;</span>
<span class="line-modified">!   static int _annotations_offset;</span>
<span class="line-modified">!   static int _parameter_annotations_offset;</span>
<span class="line-modified">!   static int _annotation_default_offset;</span>
  
    static void compute_offsets();
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 668,18 ***</span>
  
  class java_lang_reflect_Constructor : public java_lang_reflect_AccessibleObject {
   private:
    // Note that to reduce dependencies on the JDK we compute these
    // offsets at run-time.
<span class="line-modified">!   static int clazz_offset;</span>
<span class="line-modified">!   static int parameterTypes_offset;</span>
<span class="line-modified">!   static int exceptionTypes_offset;</span>
<span class="line-modified">!   static int slot_offset;</span>
<span class="line-modified">!   static int modifiers_offset;</span>
<span class="line-modified">!   static int signature_offset;</span>
<span class="line-modified">!   static int annotations_offset;</span>
<span class="line-modified">!   static int parameter_annotations_offset;</span>
  
    static void compute_offsets();
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  
<span class="line-new-header">--- 656,18 ---</span>
  
  class java_lang_reflect_Constructor : public java_lang_reflect_AccessibleObject {
   private:
    // Note that to reduce dependencies on the JDK we compute these
    // offsets at run-time.
<span class="line-modified">!   static int _clazz_offset;</span>
<span class="line-modified">!   static int _parameterTypes_offset;</span>
<span class="line-modified">!   static int _exceptionTypes_offset;</span>
<span class="line-modified">!   static int _slot_offset;</span>
<span class="line-modified">!   static int _modifiers_offset;</span>
<span class="line-modified">!   static int _signature_offset;</span>
<span class="line-modified">!   static int _annotations_offset;</span>
<span class="line-modified">!   static int _parameter_annotations_offset;</span>
  
    static void compute_offsets();
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 711,17 ***</span>
  
  class java_lang_reflect_Field : public java_lang_reflect_AccessibleObject {
   private:
    // Note that to reduce dependencies on the JDK we compute these
    // offsets at run-time.
<span class="line-modified">!   static int clazz_offset;</span>
<span class="line-modified">!   static int name_offset;</span>
<span class="line-modified">!   static int type_offset;</span>
<span class="line-modified">!   static int slot_offset;</span>
<span class="line-modified">!   static int modifiers_offset;</span>
<span class="line-modified">!   static int signature_offset;</span>
<span class="line-modified">!   static int annotations_offset;</span>
  
    static void compute_offsets();
  
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
<span class="line-new-header">--- 699,17 ---</span>
  
  class java_lang_reflect_Field : public java_lang_reflect_AccessibleObject {
   private:
    // Note that to reduce dependencies on the JDK we compute these
    // offsets at run-time.
<span class="line-modified">!   static int _clazz_offset;</span>
<span class="line-modified">!   static int _name_offset;</span>
<span class="line-modified">!   static int _type_offset;</span>
<span class="line-modified">!   static int _slot_offset;</span>
<span class="line-modified">!   static int _modifiers_offset;</span>
<span class="line-modified">!   static int _signature_offset;</span>
<span class="line-modified">!   static int _annotations_offset;</span>
  
    static void compute_offsets();
  
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 756,14 ***</span>
  
  class java_lang_reflect_Parameter {
   private:
    // Note that to reduce dependencies on the JDK we compute these
    // offsets at run-time.
<span class="line-modified">!   static int name_offset;</span>
<span class="line-modified">!   static int modifiers_offset;</span>
<span class="line-modified">!   static int index_offset;</span>
<span class="line-modified">!   static int executable_offset;</span>
  
    static void compute_offsets();
  
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
<span class="line-new-header">--- 744,14 ---</span>
  
  class java_lang_reflect_Parameter {
   private:
    // Note that to reduce dependencies on the JDK we compute these
    // offsets at run-time.
<span class="line-modified">!   static int _name_offset;</span>
<span class="line-modified">!   static int _modifiers_offset;</span>
<span class="line-modified">!   static int _index_offset;</span>
<span class="line-modified">!   static int _executable_offset;</span>
  
    static void compute_offsets();
  
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 790,13 ***</span>
  #define MODULE_INJECTED_FIELDS(macro)                            \
    macro(java_lang_Module, module_entry, intptr_signature, false)
  
  class java_lang_Module {
    private:
<span class="line-modified">!     static int loader_offset;</span>
<span class="line-modified">!     static int name_offset;</span>
      static int _module_entry_offset;
      static void compute_offsets();
  
    public:
      static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  
<span class="line-new-header">--- 778,14 ---</span>
  #define MODULE_INJECTED_FIELDS(macro)                            \
    macro(java_lang_Module, module_entry, intptr_signature, false)
  
  class java_lang_Module {
    private:
<span class="line-modified">!     static int _loader_offset;</span>
<span class="line-modified">!     static int _name_offset;</span>
      static int _module_entry_offset;
<span class="line-added">+ </span>
      static void compute_offsets();
  
    public:
      static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 834,13 ***</span>
    // Allocation
    static Handle create(TRAPS);
  
    // Accessors
    static void set_cp(oop reflect, ConstantPool* value);
<span class="line-modified">!   static int oop_offset() {</span>
<span class="line-removed">-     return _oop_offset;</span>
<span class="line-removed">-   }</span>
  
    static ConstantPool* get_cp(oop reflect);
  
    // Debugging
    friend class JavaClasses;
<span class="line-new-header">--- 823,11 ---</span>
    // Allocation
    static Handle create(TRAPS);
  
    // Accessors
    static void set_cp(oop reflect, ConstantPool* value);
<span class="line-modified">!   static int oop_offset() { CHECK_INIT(_oop_offset); }</span>
  
    static ConstantPool* get_cp(oop reflect);
  
    // Debugging
    friend class JavaClasses;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 853,13 ***</span>
    static void compute_offsets();
  
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  
<span class="line-modified">!   static int base_offset() {</span>
<span class="line-removed">-     return _base_offset;</span>
<span class="line-removed">-   }</span>
  
    // Debugging
    friend class JavaClasses;
  };
  
<span class="line-new-header">--- 840,11 ---</span>
    static void compute_offsets();
  
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  
<span class="line-modified">!   static int base_offset() { CHECK_INIT(_base_offset); }</span>
  
    // Debugging
    friend class JavaClasses;
  };
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 875,13 ***</span>
  
  // This could be separated out into 8 individual classes.
  
  class java_lang_boxing_object: AllStatic {
   private:
<span class="line-modified">!   static int value_offset;</span>
<span class="line-modified">!   static int long_value_offset;</span>
  
    static oop initialize_and_allocate(BasicType type, TRAPS);
   public:
    // Allocation. Returns a boxed value, or NULL for invalid type.
    static oop create(BasicType type, jvalue* value, TRAPS);
    // Accessors. Returns the basic type being boxed, or T_ILLEGAL for invalid oop.
<span class="line-new-header">--- 860,14 ---</span>
  
  // This could be separated out into 8 individual classes.
  
  class java_lang_boxing_object: AllStatic {
   private:
<span class="line-modified">!   static int _value_offset;</span>
<span class="line-modified">!   static int _long_value_offset;</span>
  
<span class="line-added">+   static void compute_offsets();</span>
    static oop initialize_and_allocate(BasicType type, TRAPS);
   public:
    // Allocation. Returns a boxed value, or NULL for invalid type.
    static oop create(BasicType type, jvalue* value, TRAPS);
    // Accessors. Returns the basic type being boxed, or T_ILLEGAL for invalid oop.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 891,35 ***</span>
    static bool is_instance(oop box)                 { return basic_type(box) != T_ILLEGAL; }
    static bool is_instance(oop box, BasicType type) { return basic_type(box) == type; }
    static void print(oop box, outputStream* st)     { jvalue value;  print(get_value(box, &amp;value), &amp;value, st); }
    static void print(BasicType type, jvalue* value, outputStream* st);
  
<span class="line-modified">!   static int value_offset_in_bytes(BasicType type) {</span>
<span class="line-modified">!     return ( type == T_LONG || type == T_DOUBLE ) ? long_value_offset :</span>
<span class="line-removed">-                                                     value_offset;</span>
    }
  
<span class="line-modified">!   static void compute_offsets();</span>
<span class="line-removed">-   static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;</span>
  
    // Debugging
    friend class JavaClasses;
  };
  
  
  
  // Interface to java.lang.ref.Reference objects
  
  class java_lang_ref_Reference: AllStatic {
    static bool _offsets_initialized;
  
   public:
<span class="line-removed">-   static int referent_offset;</span>
<span class="line-removed">-   static int queue_offset;</span>
<span class="line-removed">-   static int next_offset;</span>
<span class="line-removed">-   static int discovered_offset;</span>
<span class="line-removed">- </span>
    // Accessors
    static inline oop referent(oop ref);
    static inline void set_referent(oop ref, oop value);
    static inline void set_referent_raw(oop ref, oop value);
    static inline HeapWord* referent_addr_raw(oop ref);
<span class="line-new-header">--- 877,33 ---</span>
    static bool is_instance(oop box)                 { return basic_type(box) != T_ILLEGAL; }
    static bool is_instance(oop box, BasicType type) { return basic_type(box) == type; }
    static void print(oop box, outputStream* st)     { jvalue value;  print(get_value(box, &amp;value), &amp;value, st); }
    static void print(BasicType type, jvalue* value, outputStream* st);
  
<span class="line-modified">!   static int value_offset(BasicType type) {</span>
<span class="line-modified">!     return is_double_word_type(type) ? _long_value_offset : _value_offset;</span>
    }
  
<span class="line-modified">!   static void serialize_offsets(SerializeClosure* f);</span>
  
    // Debugging
    friend class JavaClasses;
  };
  
  
  
  // Interface to java.lang.ref.Reference objects
  
  class java_lang_ref_Reference: AllStatic {
<span class="line-added">+   static int _referent_offset;</span>
<span class="line-added">+   static int _queue_offset;</span>
<span class="line-added">+   static int _next_offset;</span>
<span class="line-added">+   static int _discovered_offset;</span>
<span class="line-added">+ </span>
    static bool _offsets_initialized;
  
   public:
    // Accessors
    static inline oop referent(oop ref);
    static inline void set_referent(oop ref, oop value);
    static inline void set_referent_raw(oop ref, oop value);
    static inline HeapWord* referent_addr_raw(oop ref);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 935,22 ***</span>
    static inline void set_queue(oop ref, oop value);
    static bool is_referent_field(oop obj, ptrdiff_t offset);
    static inline bool is_final(oop ref);
    static inline bool is_phantom(oop ref);
  
    static void compute_offsets();
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  };
  
  
  // Interface to java.lang.ref.SoftReference objects
  
  class java_lang_ref_SoftReference: public java_lang_ref_Reference {
<span class="line-modified">!  public:</span>
<span class="line-modified">!   static int timestamp_offset;</span>
<span class="line-removed">-   static int static_clock_offset;</span>
  
    // Accessors
    static jlong timestamp(oop ref);
  
    // Accessors for statics
    static jlong clock();
<span class="line-new-header">--- 919,27 ---</span>
    static inline void set_queue(oop ref, oop value);
    static bool is_referent_field(oop obj, ptrdiff_t offset);
    static inline bool is_final(oop ref);
    static inline bool is_phantom(oop ref);
  
<span class="line-added">+   static int referent_offset()    { CHECK_INIT(_referent_offset); }</span>
<span class="line-added">+   static int queue_offset()       { CHECK_INIT(_queue_offset); }</span>
<span class="line-added">+   static int next_offset()        { CHECK_INIT(_next_offset); }</span>
<span class="line-added">+   static int discovered_offset()  { CHECK_INIT(_discovered_offset); }</span>
<span class="line-added">+ </span>
    static void compute_offsets();
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  };
  
  
  // Interface to java.lang.ref.SoftReference objects
  
  class java_lang_ref_SoftReference: public java_lang_ref_Reference {
<span class="line-modified">!   static int _timestamp_offset;</span>
<span class="line-modified">!   static int _static_clock_offset;</span>
  
<span class="line-added">+  public:</span>
    // Accessors
    static jlong timestamp(oop ref);
  
    // Accessors for statics
    static jlong clock();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 988,12 ***</span>
      return klass-&gt;is_subclass_of(SystemDictionary::MethodHandle_klass());
    }
    static bool is_instance(oop obj);
  
    // Accessors for code generation:
<span class="line-modified">!   static int type_offset_in_bytes()             { return _type_offset; }</span>
<span class="line-modified">!   static int form_offset_in_bytes()             { return _form_offset; }</span>
  };
  
  // Interface to java.lang.invoke.DirectMethodHandle objects
  
  class java_lang_invoke_DirectMethodHandle: AllStatic {
<span class="line-new-header">--- 977,12 ---</span>
      return klass-&gt;is_subclass_of(SystemDictionary::MethodHandle_klass());
    }
    static bool is_instance(oop obj);
  
    // Accessors for code generation:
<span class="line-modified">!   static int type_offset()             { CHECK_INIT(_type_offset); }</span>
<span class="line-modified">!   static int form_offset()             { CHECK_INIT(_form_offset); }</span>
  };
  
  // Interface to java.lang.invoke.DirectMethodHandle objects
  
  class java_lang_invoke_DirectMethodHandle: AllStatic {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1015,11 ***</span>
      return klass-&gt;is_subclass_of(SystemDictionary::DirectMethodHandle_klass());
    }
    static bool is_instance(oop obj);
  
    // Accessors for code generation:
<span class="line-modified">!   static int member_offset_in_bytes()           { return _member_offset; }</span>
  };
  
  // Interface to java.lang.invoke.LambdaForm objects
  // (These are a private interface for managing adapter code generation.)
  
<span class="line-new-header">--- 1004,11 ---</span>
      return klass-&gt;is_subclass_of(SystemDictionary::DirectMethodHandle_klass());
    }
    static bool is_instance(oop obj);
  
    // Accessors for code generation:
<span class="line-modified">!   static int member_offset()           { CHECK_INIT(_member_offset); }</span>
  };
  
  // Interface to java.lang.invoke.LambdaForm objects
  // (These are a private interface for managing adapter code generation.)
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1044,11 ***</span>
        klass-&gt;is_subclass_of(SystemDictionary::LambdaForm_klass());
    }
    static bool is_instance(oop obj);
  
    // Accessors for code generation:
<span class="line-modified">!   static int vmentry_offset_in_bytes()          { return _vmentry_offset; }</span>
  };
  
  
  // Interface to java.lang.invoke.MemberName objects
  // (These are a private interface for Java code to query the class hierarchy.)
<span class="line-new-header">--- 1033,11 ---</span>
        klass-&gt;is_subclass_of(SystemDictionary::LambdaForm_klass());
    }
    static bool is_instance(oop obj);
  
    // Accessors for code generation:
<span class="line-modified">!   static int vmentry_offset()          { CHECK_INIT(_vmentry_offset); }</span>
  };
  
  
  // Interface to java.lang.invoke.MemberName objects
  // (These are a private interface for Java code to query the class hierarchy.)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1065,11 ***</span>
  
    static void compute_offsets();
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  
<span class="line-modified">!   static int vmtarget_offset_in_bytes() { return _vmtarget_offset; }</span>
  
    static Method* vmtarget(oop resolved_method);
    static void set_vmtarget(oop resolved_method, Method* method);
  
    static void set_vmholder(oop resolved_method, oop holder);
<span class="line-new-header">--- 1054,11 ---</span>
  
    static void compute_offsets();
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  
<span class="line-modified">!   static int vmtarget_offset() { CHECK_INIT(_vmtarget_offset); }</span>
  
    static Method* vmtarget(oop resolved_method);
    static void set_vmtarget(oop resolved_method, Method* method);
  
    static void set_vmholder(oop resolved_method, oop holder);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1152,16 ***</span>
      MN_STRONG_LOADER_LINK    = 0x00000004,
      MN_ACCESS_VM_ANNOTATIONS = 0x00000008
    };
  
    // Accessors for code generation:
<span class="line-modified">!   static int clazz_offset_in_bytes()            { return _clazz_offset; }</span>
<span class="line-modified">!   static int type_offset_in_bytes()             { return _type_offset; }</span>
<span class="line-modified">!   static int name_offset_in_bytes()             { return _name_offset; }</span>
<span class="line-modified">!   static int flags_offset_in_bytes()            { return _flags_offset; }</span>
<span class="line-modified">!   static int method_offset_in_bytes()           { return _method_offset; }</span>
<span class="line-removed">-   static int vmindex_offset_in_bytes()          { return _vmindex_offset; }</span>
  };
  
  
  // Interface to java.lang.invoke.MethodType objects
  
<span class="line-new-header">--- 1141,15 ---</span>
      MN_STRONG_LOADER_LINK    = 0x00000004,
      MN_ACCESS_VM_ANNOTATIONS = 0x00000008
    };
  
    // Accessors for code generation:
<span class="line-modified">!   static int clazz_offset()   { CHECK_INIT(_clazz_offset); }</span>
<span class="line-modified">!   static int type_offset()    { CHECK_INIT(_type_offset); }</span>
<span class="line-modified">!   static int flags_offset()   { CHECK_INIT(_flags_offset); }</span>
<span class="line-modified">!   static int method_offset()  { CHECK_INIT(_method_offset); }</span>
<span class="line-modified">!   static int vmindex_offset() { CHECK_INIT(_vmindex_offset); }</span>
  };
  
  
  // Interface to java.lang.invoke.MethodType objects
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1192,12 ***</span>
    static bool is_instance(oop obj);
  
    static bool equals(oop mt1, oop mt2);
  
    // Accessors for code generation:
<span class="line-modified">!   static int rtype_offset_in_bytes()            { return _rtype_offset; }</span>
<span class="line-modified">!   static int ptypes_offset_in_bytes()           { return _ptypes_offset; }</span>
  };
  
  
  // Interface to java.lang.invoke.CallSite objects
  
<span class="line-new-header">--- 1180,12 ---</span>
    static bool is_instance(oop obj);
  
    static bool equals(oop mt1, oop mt2);
  
    // Accessors for code generation:
<span class="line-modified">!   static int rtype_offset()  { CHECK_INIT(_rtype_offset); }</span>
<span class="line-modified">!   static int ptypes_offset() { CHECK_INIT(_ptypes_offset); }</span>
  };
  
  
  // Interface to java.lang.invoke.CallSite objects
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1224,11 ***</span>
      return klass-&gt;is_subclass_of(SystemDictionary::CallSite_klass());
    }
    static bool is_instance(oop obj);
  
    // Accessors for code generation:
<span class="line-modified">!   static int target_offset_in_bytes()           { return _target_offset; }</span>
  };
  
  // Interface to java.lang.invoke.ConstantCallSite objects
  
  class java_lang_invoke_ConstantCallSite: AllStatic {
<span class="line-new-header">--- 1212,12 ---</span>
      return klass-&gt;is_subclass_of(SystemDictionary::CallSite_klass());
    }
    static bool is_instance(oop obj);
  
    // Accessors for code generation:
<span class="line-modified">!   static int target_offset()  { CHECK_INIT(_target_offset); }</span>
<span class="line-added">+   static int context_offset() { CHECK_INIT(_context_offset); }</span>
  };
  
  // Interface to java.lang.invoke.ConstantCallSite objects
  
  class java_lang_invoke_ConstantCallSite: AllStatic {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1307,18 ***</span>
    macro(java_lang_ClassLoader, loader_data,  intptr_signature, false)
  
  class java_lang_ClassLoader : AllStatic {
   private:
    static int _loader_data_offset;
<span class="line-modified">!   static bool offsets_computed;</span>
<span class="line-modified">!   static int parent_offset;</span>
<span class="line-modified">!   static int parallelCapable_offset;</span>
<span class="line-modified">!   static int name_offset;</span>
<span class="line-modified">!   static int nameAndId_offset;</span>
<span class="line-removed">-   static int unnamedModule_offset;</span>
  
<span class="line-modified">!  public:</span>
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  
    static ClassLoaderData* loader_data_acquire(oop loader);
    static ClassLoaderData* loader_data_raw(oop loader);
<span class="line-new-header">--- 1296,18 ---</span>
    macro(java_lang_ClassLoader, loader_data,  intptr_signature, false)
  
  class java_lang_ClassLoader : AllStatic {
   private:
    static int _loader_data_offset;
<span class="line-modified">!   static int _parent_offset;</span>
<span class="line-modified">!   static int _parallelCapable_offset;</span>
<span class="line-modified">!   static int _name_offset;</span>
<span class="line-modified">!   static int _nameAndId_offset;</span>
<span class="line-modified">!   static int _unnamedModule_offset;</span>
  
<span class="line-modified">!   static void compute_offsets();</span>
<span class="line-added">+ </span>
   public:
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  
    static ClassLoaderData* loader_data_acquire(oop loader);
    static ClassLoaderData* loader_data_raw(oop loader);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1349,27 ***</span>
  
    static oop unnamedModule(oop loader);
  
    // Debugging
    friend class JavaClasses;
<span class="line-removed">-   friend class ClassFileParser; // access to number_of_fake_fields</span>
  };
  
  
  // Interface to java.lang.System objects
  
  class java_lang_System : AllStatic {
   private:
<span class="line-modified">!   static int  static_in_offset;</span>
<span class="line-modified">!   static int static_out_offset;</span>
<span class="line-modified">!   static int static_err_offset;</span>
<span class="line-modified">!   static int static_security_offset;</span>
  
   public:
<span class="line-modified">!   static int  in_offset_in_bytes();</span>
<span class="line-modified">!   static int out_offset_in_bytes();</span>
<span class="line-modified">!   static int err_offset_in_bytes();</span>
  
    static void compute_offsets();
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  
    // Debugging
<span class="line-new-header">--- 1338,26 ---</span>
  
    static oop unnamedModule(oop loader);
  
    // Debugging
    friend class JavaClasses;
  };
  
  
  // Interface to java.lang.System objects
  
  class java_lang_System : AllStatic {
   private:
<span class="line-modified">!   static int _static_in_offset;</span>
<span class="line-modified">!   static int _static_out_offset;</span>
<span class="line-modified">!   static int _static_err_offset;</span>
<span class="line-modified">!   static int _static_security_offset;</span>
  
   public:
<span class="line-modified">!   static int  in_offset() { CHECK_INIT(_static_in_offset); }</span>
<span class="line-modified">!   static int out_offset() { CHECK_INIT(_static_out_offset); }</span>
<span class="line-modified">!   static int err_offset() { CHECK_INIT(_static_err_offset); }</span>
  
    static void compute_offsets();
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  
    // Debugging
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1379,18 ***</span>
  
  // Interface to java.lang.StackTraceElement objects
  
  class java_lang_StackTraceElement: AllStatic {
   private:
<span class="line-modified">!   static int declaringClassObject_offset;</span>
<span class="line-modified">!   static int classLoaderName_offset;</span>
<span class="line-modified">!   static int moduleName_offset;</span>
<span class="line-modified">!   static int moduleVersion_offset;</span>
<span class="line-modified">!   static int declaringClass_offset;</span>
<span class="line-modified">!   static int methodName_offset;</span>
<span class="line-modified">!   static int fileName_offset;</span>
<span class="line-modified">!   static int lineNumber_offset;</span>
  
    // Setters
    static void set_classLoaderName(oop element, oop value);
    static void set_moduleName(oop element, oop value);
    static void set_moduleVersion(oop element, oop value);
<span class="line-new-header">--- 1367,18 ---</span>
  
  // Interface to java.lang.StackTraceElement objects
  
  class java_lang_StackTraceElement: AllStatic {
   private:
<span class="line-modified">!   static int _declaringClassObject_offset;</span>
<span class="line-modified">!   static int _classLoaderName_offset;</span>
<span class="line-modified">!   static int _moduleName_offset;</span>
<span class="line-modified">!   static int _moduleVersion_offset;</span>
<span class="line-modified">!   static int _declaringClass_offset;</span>
<span class="line-modified">!   static int _methodName_offset;</span>
<span class="line-modified">!   static int _fileName_offset;</span>
<span class="line-modified">!   static int _lineNumber_offset;</span>
  
    // Setters
    static void set_classLoaderName(oop element, oop value);
    static void set_moduleName(oop element, oop value);
    static void set_moduleVersion(oop element, oop value);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1490,17 ***</span>
  
  // Interface to java.lang.reflect.RecordComponent objects
  
  class java_lang_reflect_RecordComponent: AllStatic {
   private:
<span class="line-modified">!   static int clazz_offset;</span>
<span class="line-modified">!   static int name_offset;</span>
<span class="line-modified">!   static int type_offset;</span>
<span class="line-modified">!   static int accessor_offset;</span>
<span class="line-modified">!   static int signature_offset;</span>
<span class="line-modified">!   static int annotations_offset;</span>
<span class="line-modified">!   static int typeAnnotations_offset;</span>
  
    // Setters
    static void set_clazz(oop element, oop value);
    static void set_name(oop element, oop value);
    static void set_type(oop element, oop value);
<span class="line-new-header">--- 1478,17 ---</span>
  
  // Interface to java.lang.reflect.RecordComponent objects
  
  class java_lang_reflect_RecordComponent: AllStatic {
   private:
<span class="line-modified">!   static int _clazz_offset;</span>
<span class="line-modified">!   static int _name_offset;</span>
<span class="line-modified">!   static int _type_offset;</span>
<span class="line-modified">!   static int _accessor_offset;</span>
<span class="line-modified">!   static int _signature_offset;</span>
<span class="line-modified">!   static int _annotations_offset;</span>
<span class="line-modified">!   static int _typeAnnotations_offset;</span>
  
    // Setters
    static void set_clazz(oop element, oop value);
    static void set_name(oop element, oop value);
    static void set_type(oop element, oop value);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1523,15 ***</span>
  
  // Interface to java.lang.AssertionStatusDirectives objects
  
  class java_lang_AssertionStatusDirectives: AllStatic {
   private:
<span class="line-modified">!   static int classes_offset;</span>
<span class="line-modified">!   static int classEnabled_offset;</span>
<span class="line-modified">!   static int packages_offset;</span>
<span class="line-modified">!   static int packageEnabled_offset;</span>
<span class="line-modified">!   static int deflt_offset;</span>
  
   public:
    // Setters
    static void set_classes(oop obj, oop val);
    static void set_classEnabled(oop obj, oop val);
<span class="line-new-header">--- 1511,15 ---</span>
  
  // Interface to java.lang.AssertionStatusDirectives objects
  
  class java_lang_AssertionStatusDirectives: AllStatic {
   private:
<span class="line-modified">!   static int _classes_offset;</span>
<span class="line-modified">!   static int _classEnabled_offset;</span>
<span class="line-modified">!   static int _packages_offset;</span>
<span class="line-modified">!   static int _packageEnabled_offset;</span>
<span class="line-modified">!   static int _deflt_offset;</span>
  
   public:
    // Setters
    static void set_classes(oop obj, oop val);
    static void set_classEnabled(oop obj, oop val);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1550,11 ***</span>
  class java_nio_Buffer: AllStatic {
   private:
    static int _limit_offset;
  
   public:
<span class="line-modified">!   static int  limit_offset();</span>
    static void compute_offsets();
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  };
  
  class java_util_concurrent_locks_AbstractOwnableSynchronizer : AllStatic {
<span class="line-new-header">--- 1538,11 ---</span>
  class java_nio_Buffer: AllStatic {
   private:
    static int _limit_offset;
  
   public:
<span class="line-modified">!   static int  limit_offset() { CHECK_INIT(_limit_offset); }</span>
    static void compute_offsets();
    static void serialize_offsets(SerializeClosure* f) NOT_CDS_RETURN;
  };
  
  class java_util_concurrent_locks_AbstractOwnableSynchronizer : AllStatic {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1751,6 ***</span>
<span class="line-new-header">--- 1739,7 ---</span>
    static bool is_supported_for_archiving(oop obj) NOT_CDS_JAVA_HEAP_RETURN_(false);
  };
  
  #undef DECLARE_INJECTED_FIELD_ENUM
  
<span class="line-added">+ #undef CHECK_INIT</span>
  #endif // SHARE_CLASSFILE_JAVACLASSES_HPP
</pre>
<center><a href="javaClasses.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="vmSymbols.hpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>