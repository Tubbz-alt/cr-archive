<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/oops/instanceKlass.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="instanceKlass.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../opto/c2_globals.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/oops/instanceKlass.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 210   // the InnerClasses attribute exists, the _inner_classes array length is
 211   // number_of_inner_classes * 4. If the class has both InnerClasses
 212   // and EnclosingMethod attributes the _inner_classes array length is
 213   // number_of_inner_classes * 4 + enclosing_method_attribute_size.
 214   Array&lt;jushort&gt;* _inner_classes;
 215 
 216   // The NestMembers attribute. An array of shorts, where each is a
 217   // class info index for the class that is a nest member. This data
 218   // has not been validated.
 219   Array&lt;jushort&gt;* _nest_members;
 220 
 221   // Resolved nest-host klass: either true nest-host or self if we are not
 222   // nested, or an error occurred resolving or validating the nominated
 223   // nest-host. Can also be set directly by JDK API&#39;s that establish nest
 224   // relationships.
 225   // By always being set it makes nest-member access checks simpler.
 226   InstanceKlass* _nest_host;
 227 
 228   Array&lt;InlineTypes&gt;* _inline_types;
 229 




 230   // The contents of the Record attribute.
 231   Array&lt;RecordComponent*&gt;* _record_components;
 232 
 233   // the source debug extension for this klass, NULL if not specified.
 234   // Specified as UTF-8 string without terminating zero byte in the classfile,
 235   // it is stored in the instanceklass as a NULL-terminated UTF-8 string
 236   const char*     _source_debug_extension;
 237 
 238   // Number of heapOopSize words used by non-static fields in this klass
 239   // (including inherited fields but after header_size()).
 240   int             _nonstatic_field_size;
 241   int             _static_field_size;    // number words used by static fields (oop and non-oop) in this klass
 242 
 243   int             _nonstatic_oop_map_size;// size in words of nonstatic oop map blocks
 244   int             _itable_len;           // length of Java itable (in words)
 245 
 246   // The NestHost attribute. The class info index for the class
 247   // that is the nest-host of this class. This data has not been validated.
 248   u2              _nest_host_index;
 249   u2              _this_class_index;              // constant pool entry
</pre>
<hr />
<pre>
 559   Array&lt;u2&gt;* inner_classes() const       { return _inner_classes; }
 560   void set_inner_classes(Array&lt;u2&gt;* f)   { _inner_classes = f; }
 561 
 562   // nest members
 563   Array&lt;u2&gt;* nest_members() const     { return _nest_members; }
 564   void set_nest_members(Array&lt;u2&gt;* m) { _nest_members = m; }
 565 
 566   // nest-host index
 567   jushort nest_host_index() const { return _nest_host_index; }
 568   void set_nest_host_index(u2 i)  { _nest_host_index = i; }
 569   // dynamic nest member support
 570   void set_nest_host(InstanceKlass* host, TRAPS);
 571 
 572   // record components
 573   Array&lt;RecordComponent*&gt;* record_components() const { return _record_components; }
 574   void set_record_components(Array&lt;RecordComponent*&gt;* record_components) {
 575     _record_components = record_components;
 576   }
 577   bool is_record() const { return _record_components != NULL; }
 578 




 579 private:
 580   // Called to verify that k is a member of this nest - does not look at k&#39;s nest-host
 581   bool has_nest_member(InstanceKlass* k, TRAPS) const;
 582 
 583 public:
 584   // Used to construct informative IllegalAccessError messages at a higher level,
 585   // if there was an issue resolving or validating the nest host.
 586   // Returns NULL if there was no error.
 587   const char* nest_host_error(TRAPS);
 588   // Returns nest-host class, resolving and validating it if needed.
 589   // Returns NULL if resolution is not possible from the calling context.
 590   InstanceKlass* nest_host(TRAPS);
 591   // Check if this klass is a nestmate of k - resolves this nest-host and k&#39;s
 592   bool has_nestmate_access_to(InstanceKlass* k, TRAPS);
 593 



 594   enum InnerClassAttributeOffset {
 595     // From http://mirror.eng/products/jdk/1.1/docs/guide/innerclasses/spec/innerclasses.doc10.html#18814
 596     inner_class_inner_class_info_offset = 0,
 597     inner_class_outer_class_info_offset = 1,
 598     inner_class_inner_name_offset = 2,
 599     inner_class_access_flags_offset = 3,
 600     inner_class_next_offset = 4
 601   };
 602 
 603   enum EnclosingMethodAttributeOffset {
 604     enclosing_method_class_index_offset = 0,
 605     enclosing_method_method_index_offset = 1,
 606     enclosing_method_attribute_size = 2
 607   };
 608 
 609   // method override check
 610   bool is_override(const methodHandle&amp; super_method, Handle targetclassloader, Symbol* targetclassname, TRAPS);
 611 
 612   // package
 613   PackageEntry* package() const     { return _package_entry; }
</pre>
<hr />
<pre>
 631   // Find InnerClasses attribute and return outer_class_info_index &amp; inner_name_index.
 632   bool find_inner_classes_attr(int* ooff, int* noff, TRAPS) const;
 633 
 634  private:
 635   // Check prohibited package (&quot;java/&quot; only loadable by boot or platform loaders)
 636   static void check_prohibited_package(Symbol* class_name,
 637                                        ClassLoaderData* loader_data,
 638                                        TRAPS);
 639  public:
 640   // initialization state
 641   bool is_loaded() const                   { return _init_state &gt;= loaded; }
 642   bool is_linked() const                   { return _init_state &gt;= linked; }
 643   bool is_initialized() const              { return _init_state == fully_initialized; }
 644   bool is_not_initialized() const          { return _init_state &lt;  being_initialized; }
 645   bool is_being_initialized() const        { return _init_state == being_initialized; }
 646   bool is_in_error_state() const           { return _init_state == initialization_error; }
 647   bool is_reentrant_initialization(Thread *thread)  { return thread == _init_thread; }
 648   ClassState  init_state()                 { return (ClassState)_init_state; }
 649   bool is_rewritten() const                { return (_misc_flags &amp; _misc_rewritten) != 0; }
 650 



 651   // defineClass specified verification
 652   bool should_verify_class() const         {
 653     return (_misc_flags &amp; _misc_should_verify_class) != 0;
 654   }
 655   void set_should_verify_class(bool value) {
 656     if (value) {
 657       _misc_flags |= _misc_should_verify_class;
 658     } else {
 659       _misc_flags &amp;= ~_misc_should_verify_class;
 660     }
 661   }
 662 
 663   // marking
 664   bool is_marked_dependent() const         { return _is_marked_dependent; }
 665   void set_is_marked_dependent(bool value) { _is_marked_dependent = value; }
 666 
 667   static ByteSize kind_offset() { return in_ByteSize(offset_of(InstanceKlass, _kind)); }
 668   static ByteSize misc_flags_offset() { return in_ByteSize(offset_of(InstanceKlass, _misc_flags)); }
 669   static u4 misc_flags_is_empty_inline_type() { return _misc_is_empty_inline_type; }
 670 
</pre>
</td>
<td>
<hr />
<pre>
 210   // the InnerClasses attribute exists, the _inner_classes array length is
 211   // number_of_inner_classes * 4. If the class has both InnerClasses
 212   // and EnclosingMethod attributes the _inner_classes array length is
 213   // number_of_inner_classes * 4 + enclosing_method_attribute_size.
 214   Array&lt;jushort&gt;* _inner_classes;
 215 
 216   // The NestMembers attribute. An array of shorts, where each is a
 217   // class info index for the class that is a nest member. This data
 218   // has not been validated.
 219   Array&lt;jushort&gt;* _nest_members;
 220 
 221   // Resolved nest-host klass: either true nest-host or self if we are not
 222   // nested, or an error occurred resolving or validating the nominated
 223   // nest-host. Can also be set directly by JDK API&#39;s that establish nest
 224   // relationships.
 225   // By always being set it makes nest-member access checks simpler.
 226   InstanceKlass* _nest_host;
 227 
 228   Array&lt;InlineTypes&gt;* _inline_types;
 229 
<span class="line-added"> 230   // The PermittedSubclasses attribute. An array of shorts, where each is a</span>
<span class="line-added"> 231   // class info index for the class that is a permitted subclass.</span>
<span class="line-added"> 232   Array&lt;jushort&gt;* _permitted_subclasses;</span>
<span class="line-added"> 233 </span>
 234   // The contents of the Record attribute.
 235   Array&lt;RecordComponent*&gt;* _record_components;
 236 
 237   // the source debug extension for this klass, NULL if not specified.
 238   // Specified as UTF-8 string without terminating zero byte in the classfile,
 239   // it is stored in the instanceklass as a NULL-terminated UTF-8 string
 240   const char*     _source_debug_extension;
 241 
 242   // Number of heapOopSize words used by non-static fields in this klass
 243   // (including inherited fields but after header_size()).
 244   int             _nonstatic_field_size;
 245   int             _static_field_size;    // number words used by static fields (oop and non-oop) in this klass
 246 
 247   int             _nonstatic_oop_map_size;// size in words of nonstatic oop map blocks
 248   int             _itable_len;           // length of Java itable (in words)
 249 
 250   // The NestHost attribute. The class info index for the class
 251   // that is the nest-host of this class. This data has not been validated.
 252   u2              _nest_host_index;
 253   u2              _this_class_index;              // constant pool entry
</pre>
<hr />
<pre>
 563   Array&lt;u2&gt;* inner_classes() const       { return _inner_classes; }
 564   void set_inner_classes(Array&lt;u2&gt;* f)   { _inner_classes = f; }
 565 
 566   // nest members
 567   Array&lt;u2&gt;* nest_members() const     { return _nest_members; }
 568   void set_nest_members(Array&lt;u2&gt;* m) { _nest_members = m; }
 569 
 570   // nest-host index
 571   jushort nest_host_index() const { return _nest_host_index; }
 572   void set_nest_host_index(u2 i)  { _nest_host_index = i; }
 573   // dynamic nest member support
 574   void set_nest_host(InstanceKlass* host, TRAPS);
 575 
 576   // record components
 577   Array&lt;RecordComponent*&gt;* record_components() const { return _record_components; }
 578   void set_record_components(Array&lt;RecordComponent*&gt;* record_components) {
 579     _record_components = record_components;
 580   }
 581   bool is_record() const { return _record_components != NULL; }
 582 
<span class="line-added"> 583   // permitted subclasses</span>
<span class="line-added"> 584   Array&lt;u2&gt;* permitted_subclasses() const     { return _permitted_subclasses; }</span>
<span class="line-added"> 585   void set_permitted_subclasses(Array&lt;u2&gt;* s) { _permitted_subclasses = s; }</span>
<span class="line-added"> 586 </span>
 587 private:
 588   // Called to verify that k is a member of this nest - does not look at k&#39;s nest-host
 589   bool has_nest_member(InstanceKlass* k, TRAPS) const;
 590 
 591 public:
 592   // Used to construct informative IllegalAccessError messages at a higher level,
 593   // if there was an issue resolving or validating the nest host.
 594   // Returns NULL if there was no error.
 595   const char* nest_host_error(TRAPS);
 596   // Returns nest-host class, resolving and validating it if needed.
 597   // Returns NULL if resolution is not possible from the calling context.
 598   InstanceKlass* nest_host(TRAPS);
 599   // Check if this klass is a nestmate of k - resolves this nest-host and k&#39;s
 600   bool has_nestmate_access_to(InstanceKlass* k, TRAPS);
 601 
<span class="line-added"> 602   // Called to verify that k is a permitted subclass of this class</span>
<span class="line-added"> 603   bool has_as_permitted_subclass(const InstanceKlass* k) const;</span>
<span class="line-added"> 604 </span>
 605   enum InnerClassAttributeOffset {
 606     // From http://mirror.eng/products/jdk/1.1/docs/guide/innerclasses/spec/innerclasses.doc10.html#18814
 607     inner_class_inner_class_info_offset = 0,
 608     inner_class_outer_class_info_offset = 1,
 609     inner_class_inner_name_offset = 2,
 610     inner_class_access_flags_offset = 3,
 611     inner_class_next_offset = 4
 612   };
 613 
 614   enum EnclosingMethodAttributeOffset {
 615     enclosing_method_class_index_offset = 0,
 616     enclosing_method_method_index_offset = 1,
 617     enclosing_method_attribute_size = 2
 618   };
 619 
 620   // method override check
 621   bool is_override(const methodHandle&amp; super_method, Handle targetclassloader, Symbol* targetclassname, TRAPS);
 622 
 623   // package
 624   PackageEntry* package() const     { return _package_entry; }
</pre>
<hr />
<pre>
 642   // Find InnerClasses attribute and return outer_class_info_index &amp; inner_name_index.
 643   bool find_inner_classes_attr(int* ooff, int* noff, TRAPS) const;
 644 
 645  private:
 646   // Check prohibited package (&quot;java/&quot; only loadable by boot or platform loaders)
 647   static void check_prohibited_package(Symbol* class_name,
 648                                        ClassLoaderData* loader_data,
 649                                        TRAPS);
 650  public:
 651   // initialization state
 652   bool is_loaded() const                   { return _init_state &gt;= loaded; }
 653   bool is_linked() const                   { return _init_state &gt;= linked; }
 654   bool is_initialized() const              { return _init_state == fully_initialized; }
 655   bool is_not_initialized() const          { return _init_state &lt;  being_initialized; }
 656   bool is_being_initialized() const        { return _init_state == being_initialized; }
 657   bool is_in_error_state() const           { return _init_state == initialization_error; }
 658   bool is_reentrant_initialization(Thread *thread)  { return thread == _init_thread; }
 659   ClassState  init_state()                 { return (ClassState)_init_state; }
 660   bool is_rewritten() const                { return (_misc_flags &amp; _misc_rewritten) != 0; }
 661 
<span class="line-added"> 662   // is this a sealed class</span>
<span class="line-added"> 663   bool is_sealed() const;</span>
<span class="line-added"> 664 </span>
 665   // defineClass specified verification
 666   bool should_verify_class() const         {
 667     return (_misc_flags &amp; _misc_should_verify_class) != 0;
 668   }
 669   void set_should_verify_class(bool value) {
 670     if (value) {
 671       _misc_flags |= _misc_should_verify_class;
 672     } else {
 673       _misc_flags &amp;= ~_misc_should_verify_class;
 674     }
 675   }
 676 
 677   // marking
 678   bool is_marked_dependent() const         { return _is_marked_dependent; }
 679   void set_is_marked_dependent(bool value) { _is_marked_dependent = value; }
 680 
 681   static ByteSize kind_offset() { return in_ByteSize(offset_of(InstanceKlass, _kind)); }
 682   static ByteSize misc_flags_offset() { return in_ByteSize(offset_of(InstanceKlass, _misc_flags)); }
 683   static u4 misc_flags_is_empty_inline_type() { return _misc_is_empty_inline_type; }
 684 
</pre>
</td>
</tr>
</table>
<center><a href="instanceKlass.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../opto/c2_globals.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>