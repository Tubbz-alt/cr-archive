<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/cpu/x86/sharedRuntime_x86_32.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="macroAssembler_x86.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="sharedRuntime_x86_64.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/x86/sharedRuntime_x86_32.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
3154   // Discard arg
3155   __ pop(rcx);
3156 
3157   Label noException;
3158 
3159   // Clear last_Java_sp again
3160   __ get_thread(java_thread);
3161   __ reset_last_Java_frame(java_thread, false);
3162 
3163   __ cmpptr(Address(java_thread, Thread::pending_exception_offset()), (int32_t)NULL_WORD);
3164   __ jcc(Assembler::equal, noException);
3165 
3166   // Exception pending
3167   RegisterSaver::restore_live_registers(masm, save_vectors);
3168 
3169   __ jump(RuntimeAddress(StubRoutines::forward_exception_entry()));
3170 
3171   __ bind(noException);
3172 
3173   Label no_adjust, bail, not_special;
<span class="line-modified">3174   if (SafepointMechanism::uses_thread_local_poll() &amp;&amp; !cause_return) {</span>
3175     // If our stashed return pc was modified by the runtime we avoid touching it
3176     __ cmpptr(rbx, Address(rbp, wordSize));
3177     __ jccb(Assembler::notEqual, no_adjust);
3178 
3179     // Skip over the poll instruction.
3180     // See NativeInstruction::is_safepoint_poll()
3181     // Possible encodings:
3182     //      85 00       test   %eax,(%rax)
3183     //      85 01       test   %eax,(%rcx)
3184     //      85 02       test   %eax,(%rdx)
3185     //      85 03       test   %eax,(%rbx)
3186     //      85 06       test   %eax,(%rsi)
3187     //      85 07       test   %eax,(%rdi)
3188     //
3189     //      85 04 24    test   %eax,(%rsp)
3190     //      85 45 00    test   %eax,0x0(%rbp)
3191 
3192 #ifdef ASSERT
3193     __ movptr(rax, rbx); // remember where 0x85 should be, for verification below
3194 #endif
</pre>
</td>
<td>
<hr />
<pre>
3154   // Discard arg
3155   __ pop(rcx);
3156 
3157   Label noException;
3158 
3159   // Clear last_Java_sp again
3160   __ get_thread(java_thread);
3161   __ reset_last_Java_frame(java_thread, false);
3162 
3163   __ cmpptr(Address(java_thread, Thread::pending_exception_offset()), (int32_t)NULL_WORD);
3164   __ jcc(Assembler::equal, noException);
3165 
3166   // Exception pending
3167   RegisterSaver::restore_live_registers(masm, save_vectors);
3168 
3169   __ jump(RuntimeAddress(StubRoutines::forward_exception_entry()));
3170 
3171   __ bind(noException);
3172 
3173   Label no_adjust, bail, not_special;
<span class="line-modified">3174   if (!cause_return) {</span>
3175     // If our stashed return pc was modified by the runtime we avoid touching it
3176     __ cmpptr(rbx, Address(rbp, wordSize));
3177     __ jccb(Assembler::notEqual, no_adjust);
3178 
3179     // Skip over the poll instruction.
3180     // See NativeInstruction::is_safepoint_poll()
3181     // Possible encodings:
3182     //      85 00       test   %eax,(%rax)
3183     //      85 01       test   %eax,(%rcx)
3184     //      85 02       test   %eax,(%rdx)
3185     //      85 03       test   %eax,(%rbx)
3186     //      85 06       test   %eax,(%rsi)
3187     //      85 07       test   %eax,(%rdi)
3188     //
3189     //      85 04 24    test   %eax,(%rsp)
3190     //      85 45 00    test   %eax,0x0(%rbp)
3191 
3192 #ifdef ASSERT
3193     __ movptr(rax, rbx); // remember where 0x85 should be, for verification below
3194 #endif
</pre>
</td>
</tr>
</table>
<center><a href="macroAssembler_x86.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="sharedRuntime_x86_64.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>