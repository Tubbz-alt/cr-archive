<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.jdi/share/classes/com/sun/tools/jdi/VirtualMachineImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../../jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/util/Utils.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../test/hotspot/jtreg/ProblemList.txt.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.jdi/share/classes/com/sun/tools/jdi/VirtualMachineImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 1998, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 298          * if (shutdown) {
 299          *    throw new VMDisconnectedException();
 300          * }
 301          */
 302     }
 303 
 304     public boolean equals(Object obj) {
 305         return this == obj;
 306     }
 307 
 308     public int hashCode() {
 309         return System.identityHashCode(this);
 310     }
 311 
 312     public List&lt;ModuleReference&gt; allModules() {
 313         validateVM();
 314         List&lt;ModuleReference&gt; modules = retrieveAllModules();
 315         return Collections.unmodifiableList(modules);
 316     }
 317 
<span class="line-removed"> 318      List&lt;ReferenceType&gt; classesBySignature(String signature) {</span>
<span class="line-removed"> 319         validateVM();</span>
<span class="line-removed"> 320         List&lt;ReferenceType&gt; list;</span>
<span class="line-removed"> 321         if (retrievedAllTypes) {</span>
<span class="line-removed"> 322             list = findReferenceTypes(signature);</span>
<span class="line-removed"> 323         } else {</span>
<span class="line-removed"> 324             list = retrieveClassesBySignature(signature);</span>
<span class="line-removed"> 325         }</span>
<span class="line-removed"> 326         return Collections.unmodifiableList(list);</span>
<span class="line-removed"> 327     }</span>
<span class="line-removed"> 328 </span>
 329     private static boolean isReferenceArray(String signature) {
 330         int i = signature.lastIndexOf(&#39;[&#39;);
 331         if (i &gt; -1 &amp;&amp; signature.charAt(i+1) == &#39;L&#39;) {
 332             return true;
 333         }
 334         return false;
 335     }
 336 
 337     public List&lt;ReferenceType&gt; classesByName(String className) {
 338         validateVM();
<span class="line-modified"> 339         String signature = JNITypeParser.typeNameToSignature(className);</span>




 340         List&lt;ReferenceType&gt; list;
 341         if (retrievedAllTypes) {
<span class="line-modified"> 342            list = findReferenceTypes(signature);</span>
 343         } else {
<span class="line-modified"> 344            list = retrieveClassesBySignature(signature);</span>
 345         }
 346         // HACK: add second request to cover the case where className
 347         // is the name of an inline type. This is done only if the
 348         // first signature is either a reference type or an array
 349         // of a reference type.
 350         if (signature.length() &gt; 1 &amp;&amp;
 351                 (signature.charAt(0) == &#39;L&#39; || isReferenceArray((signature)))) {
 352             List&lt;ReferenceType&gt; listInlineTypes;
<span class="line-modified"> 353             signature = JNITypeParser.inlineTypeNameToSignature(className);</span>
 354             if (retrievedAllTypes) {
 355                 listInlineTypes = findReferenceTypes(signature);
 356             } else {
 357                 listInlineTypes = retrieveClassesBySignature(signature);
 358             }
 359             if (!listInlineTypes.isEmpty()) {
 360                 list.addAll(listInlineTypes);
 361             }
 362         }
 363 
 364         return Collections.unmodifiableList(list);
 365     }
 366 
 367     public List&lt;ReferenceType&gt; allClasses() {
 368         validateVM();
 369 
 370         if (!retrievedAllTypes) {
 371             retrieveAllClasses();
 372         }
 373         ArrayList&lt;ReferenceType&gt; a;
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (c) 1998, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 298          * if (shutdown) {
 299          *    throw new VMDisconnectedException();
 300          * }
 301          */
 302     }
 303 
 304     public boolean equals(Object obj) {
 305         return this == obj;
 306     }
 307 
 308     public int hashCode() {
 309         return System.identityHashCode(this);
 310     }
 311 
 312     public List&lt;ModuleReference&gt; allModules() {
 313         validateVM();
 314         List&lt;ModuleReference&gt; modules = retrieveAllModules();
 315         return Collections.unmodifiableList(modules);
 316     }
 317 











 318     private static boolean isReferenceArray(String signature) {
 319         int i = signature.lastIndexOf(&#39;[&#39;);
 320         if (i &gt; -1 &amp;&amp; signature.charAt(i+1) == &#39;L&#39;) {
 321             return true;
 322         }
 323         return false;
 324     }
 325 
 326     public List&lt;ReferenceType&gt; classesByName(String className) {
 327         validateVM();
<span class="line-modified"> 328         return classesBySignature(JNITypeParser.typeNameToSignature(className));</span>
<span class="line-added"> 329     }</span>
<span class="line-added"> 330 </span>
<span class="line-added"> 331     List&lt;ReferenceType&gt; classesBySignature(String signature) {</span>
<span class="line-added"> 332         validateVM();</span>
 333         List&lt;ReferenceType&gt; list;
 334         if (retrievedAllTypes) {
<span class="line-modified"> 335             list = findReferenceTypes(signature);</span>
 336         } else {
<span class="line-modified"> 337             list = retrieveClassesBySignature(signature);</span>
 338         }
 339         // HACK: add second request to cover the case where className
 340         // is the name of an inline type. This is done only if the
 341         // first signature is either a reference type or an array
 342         // of a reference type.
 343         if (signature.length() &gt; 1 &amp;&amp;
 344                 (signature.charAt(0) == &#39;L&#39; || isReferenceArray((signature)))) {
 345             List&lt;ReferenceType&gt; listInlineTypes;
<span class="line-modified"> 346             signature = signature.replaceFirst(&quot;L&quot;, &quot;Q&quot;);</span>
 347             if (retrievedAllTypes) {
 348                 listInlineTypes = findReferenceTypes(signature);
 349             } else {
 350                 listInlineTypes = retrieveClassesBySignature(signature);
 351             }
 352             if (!listInlineTypes.isEmpty()) {
 353                 list.addAll(listInlineTypes);
 354             }
 355         }
 356 
 357         return Collections.unmodifiableList(list);
 358     }
 359 
 360     public List&lt;ReferenceType&gt; allClasses() {
 361         validateVM();
 362 
 363         if (!retrievedAllTypes) {
 364             retrieveAllClasses();
 365         }
 366         ArrayList&lt;ReferenceType&gt; a;
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../../jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/util/Utils.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../test/hotspot/jtreg/ProblemList.txt.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>