<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.jdi/share/classes/com/sun/tools/jdi/VirtualMachineImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../../jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/util/Utils.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../test/hotspot/jtreg/ProblemList.txt.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.jdi/share/classes/com/sun/tools/jdi/VirtualMachineImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 298          * if (shutdown) {
 299          *    throw new VMDisconnectedException();
 300          * }
 301          */
 302     }
 303 
 304     public boolean equals(Object obj) {
 305         return this == obj;
 306     }
 307 
 308     public int hashCode() {
 309         return System.identityHashCode(this);
 310     }
 311 
 312     public List&lt;ModuleReference&gt; allModules() {
 313         validateVM();
 314         List&lt;ModuleReference&gt; modules = retrieveAllModules();
 315         return Collections.unmodifiableList(modules);
 316     }
 317 








 318     public List&lt;ReferenceType&gt; classesByName(String className) {
 319         validateVM();
 320         return classesBySignature(JNITypeParser.typeNameToSignature(className));
 321     }
 322 
 323     List&lt;ReferenceType&gt; classesBySignature(String signature) {
 324         validateVM();
 325         List&lt;ReferenceType&gt; list;
 326         if (retrievedAllTypes) {
 327             list = findReferenceTypes(signature);
 328         } else {
 329             list = retrieveClassesBySignature(signature);
 330         }


















 331         return Collections.unmodifiableList(list);
 332     }
 333 
 334     public List&lt;ReferenceType&gt; allClasses() {
 335         validateVM();
 336 
 337         if (!retrievedAllTypes) {
 338             retrieveAllClasses();
 339         }
 340         ArrayList&lt;ReferenceType&gt; a;
 341         synchronized (this) {
 342             a = new ArrayList&lt;&gt;(typesBySignature);
 343         }
 344         return Collections.unmodifiableList(a);
 345     }
 346 
 347     /**
 348      * Performs an action for each loaded type.
 349      */
 350     public void forEachClass(Consumer&lt;ReferenceType&gt; action) {
</pre>
<hr />
<pre>
1381             return null;
1382         }
1383         ObjectReferenceImpl object = null;
1384         Long key = id;
1385 
1386         /*
1387          * Attempt to retrieve an existing object reference
1388          */
1389         SoftObjectReference ref = objectsByID.get(key);
1390         if (ref != null) {
1391             object = ref.object();
1392         }
1393 
1394         /*
1395          * If the object wasn&#39;t in the table, or it&#39;s soft reference was
1396          * cleared, create a new instance.
1397          */
1398         if (object == null) {
1399             switch (tag) {
1400                 case JDWP.Tag.OBJECT:

1401                     object = new ObjectReferenceImpl(vm, id);
1402                     break;
1403                 case JDWP.Tag.STRING:
1404                     object = new StringReferenceImpl(vm, id);
1405                     break;
1406                 case JDWP.Tag.ARRAY:
1407                     object = new ArrayReferenceImpl(vm, id);
1408                     break;
1409                 case JDWP.Tag.THREAD:
1410                     ThreadReferenceImpl thread =
1411                         new ThreadReferenceImpl(vm, id);
1412                     thread.addListener(this);
1413                     object = thread;
1414                     break;
1415                 case JDWP.Tag.THREAD_GROUP:
1416                     object = new ThreadGroupReferenceImpl(vm, id);
1417                     break;
1418                 case JDWP.Tag.CLASS_LOADER:
1419                     object = new ClassLoaderReferenceImpl(vm, id);
1420                     break;
</pre>
</td>
<td>
<hr />
<pre>
 298          * if (shutdown) {
 299          *    throw new VMDisconnectedException();
 300          * }
 301          */
 302     }
 303 
 304     public boolean equals(Object obj) {
 305         return this == obj;
 306     }
 307 
 308     public int hashCode() {
 309         return System.identityHashCode(this);
 310     }
 311 
 312     public List&lt;ModuleReference&gt; allModules() {
 313         validateVM();
 314         List&lt;ModuleReference&gt; modules = retrieveAllModules();
 315         return Collections.unmodifiableList(modules);
 316     }
 317 
<span class="line-added"> 318     private static boolean isReferenceArray(String signature) {</span>
<span class="line-added"> 319         int i = signature.lastIndexOf(&#39;[&#39;);</span>
<span class="line-added"> 320         if (i &gt; -1 &amp;&amp; signature.charAt(i+1) == &#39;L&#39;) {</span>
<span class="line-added"> 321             return true;</span>
<span class="line-added"> 322         }</span>
<span class="line-added"> 323         return false;</span>
<span class="line-added"> 324     }</span>
<span class="line-added"> 325 </span>
 326     public List&lt;ReferenceType&gt; classesByName(String className) {
 327         validateVM();
 328         return classesBySignature(JNITypeParser.typeNameToSignature(className));
 329     }
 330 
 331     List&lt;ReferenceType&gt; classesBySignature(String signature) {
 332         validateVM();
 333         List&lt;ReferenceType&gt; list;
 334         if (retrievedAllTypes) {
 335             list = findReferenceTypes(signature);
 336         } else {
 337             list = retrieveClassesBySignature(signature);
 338         }
<span class="line-added"> 339         // HACK: add second request to cover the case where className</span>
<span class="line-added"> 340         // is the name of an inline type. This is done only if the</span>
<span class="line-added"> 341         // first signature is either a reference type or an array</span>
<span class="line-added"> 342         // of a reference type.</span>
<span class="line-added"> 343         if (signature.length() &gt; 1 &amp;&amp;</span>
<span class="line-added"> 344                 (signature.charAt(0) == &#39;L&#39; || isReferenceArray((signature)))) {</span>
<span class="line-added"> 345             List&lt;ReferenceType&gt; listInlineTypes;</span>
<span class="line-added"> 346             signature = signature.replaceFirst(&quot;L&quot;, &quot;Q&quot;);</span>
<span class="line-added"> 347             if (retrievedAllTypes) {</span>
<span class="line-added"> 348                 listInlineTypes = findReferenceTypes(signature);</span>
<span class="line-added"> 349             } else {</span>
<span class="line-added"> 350                 listInlineTypes = retrieveClassesBySignature(signature);</span>
<span class="line-added"> 351             }</span>
<span class="line-added"> 352             if (!listInlineTypes.isEmpty()) {</span>
<span class="line-added"> 353                 list.addAll(listInlineTypes);</span>
<span class="line-added"> 354             }</span>
<span class="line-added"> 355         }</span>
<span class="line-added"> 356 </span>
 357         return Collections.unmodifiableList(list);
 358     }
 359 
 360     public List&lt;ReferenceType&gt; allClasses() {
 361         validateVM();
 362 
 363         if (!retrievedAllTypes) {
 364             retrieveAllClasses();
 365         }
 366         ArrayList&lt;ReferenceType&gt; a;
 367         synchronized (this) {
 368             a = new ArrayList&lt;&gt;(typesBySignature);
 369         }
 370         return Collections.unmodifiableList(a);
 371     }
 372 
 373     /**
 374      * Performs an action for each loaded type.
 375      */
 376     public void forEachClass(Consumer&lt;ReferenceType&gt; action) {
</pre>
<hr />
<pre>
1407             return null;
1408         }
1409         ObjectReferenceImpl object = null;
1410         Long key = id;
1411 
1412         /*
1413          * Attempt to retrieve an existing object reference
1414          */
1415         SoftObjectReference ref = objectsByID.get(key);
1416         if (ref != null) {
1417             object = ref.object();
1418         }
1419 
1420         /*
1421          * If the object wasn&#39;t in the table, or it&#39;s soft reference was
1422          * cleared, create a new instance.
1423          */
1424         if (object == null) {
1425             switch (tag) {
1426                 case JDWP.Tag.OBJECT:
<span class="line-added">1427                 case JDWP.Tag.INLINE_OBJECT:</span>
1428                     object = new ObjectReferenceImpl(vm, id);
1429                     break;
1430                 case JDWP.Tag.STRING:
1431                     object = new StringReferenceImpl(vm, id);
1432                     break;
1433                 case JDWP.Tag.ARRAY:
1434                     object = new ArrayReferenceImpl(vm, id);
1435                     break;
1436                 case JDWP.Tag.THREAD:
1437                     ThreadReferenceImpl thread =
1438                         new ThreadReferenceImpl(vm, id);
1439                     thread.addListener(this);
1440                     object = thread;
1441                     break;
1442                 case JDWP.Tag.THREAD_GROUP:
1443                     object = new ThreadGroupReferenceImpl(vm, id);
1444                     break;
1445                 case JDWP.Tag.CLASS_LOADER:
1446                     object = new ClassLoaderReferenceImpl(vm, id);
1447                     break;
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../../jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/util/Utils.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../test/hotspot/jtreg/ProblemList.txt.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>