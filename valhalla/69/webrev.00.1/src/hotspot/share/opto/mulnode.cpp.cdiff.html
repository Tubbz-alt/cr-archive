<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/opto/mulnode.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="machnode.hpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="phasetype.hpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/opto/mulnode.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 154,10 ***</span>
<span class="line-new-header">--- 154,22 ---</span>
      const Type *zero = add_id();        // The multiplicative zero
      if( t1-&gt;higher_equal( zero ) ) return zero;
      if( t2-&gt;higher_equal( zero ) ) return zero;
    }
  
<span class="line-added">+   // Code pattern on return from a call that returns an __Value.  Can</span>
<span class="line-added">+   // be optimized away if the return value turns out to be an oop.</span>
<span class="line-added">+   if (op == Op_AndX &amp;&amp;</span>
<span class="line-added">+       in(1) != NULL &amp;&amp;</span>
<span class="line-added">+       in(1)-&gt;Opcode() == Op_CastP2X &amp;&amp;</span>
<span class="line-added">+       in(1)-&gt;in(1) != NULL &amp;&amp;</span>
<span class="line-added">+       phase-&gt;type(in(1)-&gt;in(1))-&gt;isa_oopptr() &amp;&amp;</span>
<span class="line-added">+       t2-&gt;isa_intptr_t()-&gt;_lo &gt;= 0 &amp;&amp;</span>
<span class="line-added">+       t2-&gt;isa_intptr_t()-&gt;_hi &lt;= MinObjAlignmentInBytesMask) {</span>
<span class="line-added">+     return add_id();</span>
<span class="line-added">+   }</span>
<span class="line-added">+ </span>
    // Either input is BOTTOM ==&gt; the result is the local BOTTOM
    if( t1 == Type::BOTTOM || t2 == Type::BOTTOM )
      return bottom_type();
  
  #if defined(IA32)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 583,10 ***</span>
<span class="line-new-header">--- 595,17 ---</span>
          jlong mask = max_julong &gt;&gt; shift;
          if( (mask&amp;con) == mask )  // If AND is useless, skip it
            return usr;
        }
      }
<span class="line-added">+ </span>
<span class="line-added">+     if (con == markWord::always_locked_pattern) {</span>
<span class="line-added">+       assert(EnableValhalla, &quot;should only be used for value types&quot;);</span>
<span class="line-added">+       if (in(1)-&gt;is_Load() &amp;&amp; phase-&gt;type(in(1)-&gt;in(MemNode::Address))-&gt;is_valuetypeptr()) {</span>
<span class="line-added">+         return in(2); // Obj is known to be a value type</span>
<span class="line-added">+       }</span>
<span class="line-added">+     }</span>
    }
    return MulNode::Identity(phase);
  }
  
  //------------------------------Ideal------------------------------------------
</pre>
<center><a href="machnode.hpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="phasetype.hpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>