<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/hotspot/jtreg/compiler/valhalla/valuetypes/TestArrays.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="TestArrayAccessDeopt.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TestC2CCalls.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/compiler/valhalla/valuetypes/TestArrays.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1965,11 ***</span>
          return array[i];
      }
  
      @DontCompile
      public void test84_verifier(boolean warmup) {
<span class="line-modified">!         NotFlattenable?[] array1 = new NotFlattenable?[2];</span>
          Object[] array2 = new Object[2];
          Object result = test84(array1, 0);
          Asserts.assertEquals(array1[0], null);
          Asserts.assertEquals(result, null);
          result = test84(array2, 1);
<span class="line-new-header">--- 1965,11 ---</span>
          return array[i];
      }
  
      @DontCompile
      public void test84_verifier(boolean warmup) {
<span class="line-modified">!         NotFlattenable.ref[] array1 = new NotFlattenable.ref[2];</span>
          Object[] array2 = new Object[2];
          Object result = test84(array1, 0);
          Asserts.assertEquals(array1[0], null);
          Asserts.assertEquals(result, null);
          result = test84(array2, 1);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2021,11 ***</span>
          }
      }
  
      // Same as test85 but with not-flattenable inline type array
      @Test(failOn = ALLOC_G + ALLOCA_G + LOAD_UNKNOWN_VALUE + STORE_UNKNOWN_VALUE, match = { VALUE_ARRAY_NULL_GUARD }, matchCount = { 2 })
<span class="line-modified">!     public void test86(NotFlattenable?[] array, NotFlattenable? o, boolean b) {</span>
          if (b) {
              array[0] = null;
          } else {
              array[1] = null;
          }
<span class="line-new-header">--- 2021,11 ---</span>
          }
      }
  
      // Same as test85 but with not-flattenable inline type array
      @Test(failOn = ALLOC_G + ALLOCA_G + LOAD_UNKNOWN_VALUE + STORE_UNKNOWN_VALUE, match = { VALUE_ARRAY_NULL_GUARD }, matchCount = { 2 })
<span class="line-modified">!     public void test86(NotFlattenable.ref[] array, NotFlattenable.ref o, boolean b) {</span>
          if (b) {
              array[0] = null;
          } else {
              array[1] = null;
          }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2033,11 ***</span>
      }
  
      @DontCompile
      public void test86_verifier(boolean warmup) {
          NotFlattenable vt = new NotFlattenable();
<span class="line-modified">!         NotFlattenable?[] array1 = new NotFlattenable?[2];</span>
          test86(array1, vt, true);
          Asserts.assertEquals(array1[1], vt);
          test86(array1, null, false);
          Asserts.assertEquals(array1[1], null);
          if (!warmup) {
<span class="line-new-header">--- 2033,11 ---</span>
      }
  
      @DontCompile
      public void test86_verifier(boolean warmup) {
          NotFlattenable vt = new NotFlattenable();
<span class="line-modified">!         NotFlattenable.ref[] array1 = new NotFlattenable.ref[2];</span>
          test86(array1, vt, true);
          Asserts.assertEquals(array1[1], vt);
          test86(array1, null, false);
          Asserts.assertEquals(array1[1], null);
          if (!warmup) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2051,11 ***</span>
          }
      }
  
      // Same as test85 but with inline type array
      @Test(failOn = ALLOC_G + ALLOCA_G + LOAD_UNKNOWN_VALUE + STORE_UNKNOWN_VALUE, match = { VALUE_ARRAY_NULL_GUARD }, matchCount = { 2 })
<span class="line-modified">!     public void test87(MyValue1?[] array, MyValue1? o, boolean b) {</span>
          if (b) {
              array[0] = null;
          } else {
              array[1] = null;
          }
<span class="line-new-header">--- 2051,11 ---</span>
          }
      }
  
      // Same as test85 but with inline type array
      @Test(failOn = ALLOC_G + ALLOCA_G + LOAD_UNKNOWN_VALUE + STORE_UNKNOWN_VALUE, match = { VALUE_ARRAY_NULL_GUARD }, matchCount = { 2 })
<span class="line-modified">!     public void test87(MyValue1.ref[] array, MyValue1.ref o, boolean b) {</span>
          if (b) {
              array[0] = null;
          } else {
              array[1] = null;
          }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2063,11 ***</span>
      }
  
      @DontCompile
      public void test87_verifier(boolean warmup) {
          MyValue1 vt = MyValue1.createWithFieldsInline(rI, rL);
<span class="line-modified">!         MyValue1?[] array1 = new MyValue1?[2];</span>
          test87(array1, vt, true);
          Asserts.assertEquals(array1[1], vt);
          test87(array1, null, false);
          Asserts.assertEquals(array1[1], null);
          if (!warmup) {
<span class="line-new-header">--- 2063,11 ---</span>
      }
  
      @DontCompile
      public void test87_verifier(boolean warmup) {
          MyValue1 vt = MyValue1.createWithFieldsInline(rI, rL);
<span class="line-modified">!         MyValue1.ref[] array1 = new MyValue1.ref[2];</span>
          test87(array1, vt, true);
          Asserts.assertEquals(array1[1], vt);
          test87(array1, null, false);
          Asserts.assertEquals(array1[1], null);
          if (!warmup) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2105,18 ***</span>
              }
          }
      }
  
      @Test()
<span class="line-modified">!     public void test89(MyValue1?[] array, Integer v) {</span>
          Object o = v;
<span class="line-modified">!         array[0] = (MyValue1?)o;</span>
      }
  
      @DontCompile
      public void test89_verifier(boolean warmup) {
<span class="line-modified">!         MyValue1?[] array1 = new MyValue1?[1];</span>
          test89(array1, null);
          Asserts.assertEquals(array1[0], null);
          if (!warmup) {
              MyValue1[] array2 = new MyValue1[1];
              try {
<span class="line-new-header">--- 2105,18 ---</span>
              }
          }
      }
  
      @Test()
<span class="line-modified">!     public void test89(MyValue1.ref[] array, Integer v) {</span>
          Object o = v;
<span class="line-modified">!         array[0] = (MyValue1.ref)o;</span>
      }
  
      @DontCompile
      public void test89_verifier(boolean warmup) {
<span class="line-modified">!         MyValue1.ref[] array1 = new MyValue1.ref[1];</span>
          test89(array1, null);
          Asserts.assertEquals(array1[0], null);
          if (!warmup) {
              MyValue1[] array2 = new MyValue1[1];
              try {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2131,20 ***</span>
      @Test
      public boolean test90() {
          boolean b = true;
  
          MyValue1[] qArray = new MyValue1[0];
<span class="line-modified">!         MyValue1?[] lArray = new MyValue1?[0];</span>
  
          b = b &amp;&amp; (qArray instanceof MyValue1[]);
<span class="line-modified">!         b = b &amp;&amp; (lArray instanceof MyValue1?[]);</span>
  
          MyValue1[][] qArray2 = new MyValue1[0][0];
<span class="line-modified">!         MyValue1?[][] lArray2 = new MyValue1?[0][0];</span>
  
          b = b &amp;&amp; (qArray2 instanceof MyValue1[][]);
<span class="line-modified">!         b = b &amp;&amp; (lArray2 instanceof MyValue1?[][]);</span>
  
          return b;
      }
  
      @DontCompile
<span class="line-new-header">--- 2131,20 ---</span>
      @Test
      public boolean test90() {
          boolean b = true;
  
          MyValue1[] qArray = new MyValue1[0];
<span class="line-modified">!         MyValue1.ref[] lArray = new MyValue1.ref[0];</span>
  
          b = b &amp;&amp; (qArray instanceof MyValue1[]);
<span class="line-modified">!         b = b &amp;&amp; (lArray instanceof MyValue1.ref[]);</span>
  
          MyValue1[][] qArray2 = new MyValue1[0][0];
<span class="line-modified">!         MyValue1.ref[][] lArray2 = new MyValue1.ref[0][0];</span>
  
          b = b &amp;&amp; (qArray2 instanceof MyValue1[][]);
<span class="line-modified">!         b = b &amp;&amp; (lArray2 instanceof MyValue1.ref[][]);</span>
  
          return b;
      }
  
      @DontCompile
</pre>
<center><a href="TestArrayAccessDeopt.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TestC2CCalls.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>