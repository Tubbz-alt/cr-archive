<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/hotspot/jtreg/compiler/valhalla/valuetypes/TestUnloadedValueTypeArray.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="TestOnStackReplacement.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TestWithfieldC1.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/compiler/valhalla/valuetypes/TestUnloadedValueTypeArray.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -139,11 +139,11 @@</span>
  
      public MyValue6Box(int n) {
          foo = n;
      }
  
<span class="udiff-line-modified-removed">-     public MyValue6Box(MyValue6Box v, MyValue6Box?[] dummy) {</span>
<span class="udiff-line-modified-added">+     public MyValue6Box(MyValue6Box v, MyValue6Box.ref[] dummy) {</span>
          foo = v.foo + 1;
      }
  }
  
  final inline class MyValue7 {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -194,12 +194,12 @@</span>
  
      static void test1() {
          target1();
      }
  
<span class="udiff-line-modified-removed">-     static MyValue1Box?[] target1Box() {</span>
<span class="udiff-line-modified-removed">-         return new MyValue1Box?[10];</span>
<span class="udiff-line-modified-added">+     static MyValue1Box.ref[] target1Box() {</span>
<span class="udiff-line-modified-added">+         return new MyValue1Box.ref[10];</span>
      }
  
      static void test1Box() {
          target1Box();
      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -228,11 +228,11 @@</span>
              m = test2(arr);
          }
          Asserts.assertEQ(m, 5678);
      }
  
<span class="udiff-line-modified-removed">-     static int test2Box(MyValue2Box?[] arr) {</span>
<span class="udiff-line-modified-added">+     static int test2Box(MyValue2Box.ref[] arr) {</span>
          if (arr != null) {
              return arr[1].foo;
          } else {
              return 1234;
          }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -245,11 +245,11 @@</span>
          for (int i=0; i&lt;n; i++) {
              m = test2Box(null);
          }
          Asserts.assertEQ(m, 1234);
  
<span class="udiff-line-modified-removed">-         MyValue2Box?[] arr = new MyValue2Box?[2];</span>
<span class="udiff-line-modified-added">+         MyValue2Box.ref[] arr = new MyValue2Box.ref[2];</span>
          arr[1] = new MyValue2Box(5678);
          m = 9999;
          for (int i=0; i&lt;n; i++) {
              m = test2Box(arr);
          }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -274,11 +274,11 @@</span>
              test3(arr);
          }
          Asserts.assertEQ(arr[1].foo, 2345);
      }
  
<span class="udiff-line-modified-removed">-     static void test3Box(MyValue3Box?[] arr) {</span>
<span class="udiff-line-modified-added">+     static void test3Box(MyValue3Box.ref[] arr) {</span>
          if (arr != null) {
              arr[0] = null;
              arr[1] = new MyValue3Box(2345);
          }
      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -288,11 +288,11 @@</span>
  
          for (int i=0; i&lt;n; i++) {
              test3Box(null);
          }
  
<span class="udiff-line-modified-removed">-         MyValue3Box?[] arr = new MyValue3Box?[2];</span>
<span class="udiff-line-modified-added">+         MyValue3Box.ref[] arr = new MyValue3Box.ref[2];</span>
          for (int i=0; i&lt;n; i++) {
              test3Box(arr);
          }
          Asserts.assertEQ(arr[0], null);
          Asserts.assertEQ(arr[1].foo, 2345);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -321,14 +321,14 @@</span>
              arr = test4(true);
          }
          Asserts.assertEQ(arr[1].foo, 2345);
      }
  
<span class="udiff-line-modified-removed">-     static MyValue4Box?[] test4Box(boolean b) {</span>
<span class="udiff-line-modified-added">+     static MyValue4Box.ref[] test4Box(boolean b) {</span>
          // range check elimination
          if (b) {
<span class="udiff-line-modified-removed">-             MyValue4Box?[] arr = new MyValue4Box?[10];</span>
<span class="udiff-line-modified-added">+             MyValue4Box.ref[] arr = new MyValue4Box.ref[10];</span>
              arr[0] = null;
              arr[1] = new MyValue4Box(2345);
              return arr;
          } else {
              return null;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -340,11 +340,11 @@</span>
  
          for (int i=0; i&lt;n; i++) {
              test4Box(false);
          }
  
<span class="udiff-line-modified-removed">-         MyValue4Box?[] arr = null;</span>
<span class="udiff-line-modified-added">+         MyValue4Box.ref[] arr = null;</span>
          for (int i=0; i&lt;n; i++) {
              arr = test4Box(true);
          }
          Asserts.assertEQ(arr[0], null);
          Asserts.assertEQ(arr[1].foo, 2345);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -357,11 +357,11 @@</span>
          } else if (n == 1) {
              MyValue5[] arr = new MyValue5[10];
              arr[1] = new MyValue5(12345);
              return arr;
          } else {
<span class="udiff-line-modified-removed">-             MyValue5?[] arr = new MyValue5?[10];</span>
<span class="udiff-line-modified-added">+             MyValue5.ref[] arr = new MyValue5.ref[10];</span>
              arr[1] = new MyValue5(22345);
              return arr;
          }
      }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -378,13 +378,13 @@</span>
                  arr = (MyValue5[])test5(1);
              }
              Asserts.assertEQ(arr[1].foo, 12345);
          }
          {
<span class="udiff-line-modified-removed">-             MyValue5?[] arr = null;</span>
<span class="udiff-line-modified-added">+             MyValue5.ref[] arr = null;</span>
              for (int i=0; i&lt;n; i++) {
<span class="udiff-line-modified-removed">-                 arr = (MyValue5?[])test5(2);</span>
<span class="udiff-line-modified-added">+                 arr = (MyValue5.ref[])test5(2);</span>
              }
              Asserts.assertEQ(arr[1].foo, 22345);
          }
      }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -433,11 +433,11 @@</span>
              m = test7(arr);
          }
          Asserts.assertEQ(m, 5678);
      }
  
<span class="udiff-line-modified-removed">-     static int test7Box(MyValue7Box?[][] arr) {</span>
<span class="udiff-line-modified-added">+     static int test7Box(MyValue7Box.ref[][] arr) {</span>
          if (arr != null) {
              arr[0][0] = null;
              return arr[0][1].foo;
          } else {
              return 1234;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -451,11 +451,11 @@</span>
          for (int i=0; i&lt;n; i++) {
              m = test7Box(null);
          }
          Asserts.assertEQ(m, 1234);
  
<span class="udiff-line-modified-removed">-         MyValue7Box?[][] arr = new MyValue7Box?[2][2];</span>
<span class="udiff-line-modified-added">+         MyValue7Box.ref[][] arr = new MyValue7Box.ref[2][2];</span>
          Object[] oa = arr[1];
          Asserts.assertEQ(oa[0], null);
  
          arr[0][1] = new MyValue7Box(5678);
          m = 9999;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -465,32 +465,32 @@</span>
          Asserts.assertEQ(m, 5678);
          Asserts.assertEQ(arr[0][0], null);
      }
  
      static void test8() {
<span class="udiff-line-modified-removed">-         MyValue8? a[] = new MyValue8?[0];</span>
<span class="udiff-line-modified-added">+         MyValue8.ref a[] = new MyValue8.ref[0];</span>
          Asserts.assertEQ(MyValue8_inited, false);
  
          MyValue8  b[] = new MyValue8 [0];
          Asserts.assertEQ(MyValue8_inited, true);
      }
  
      static void test9() {
<span class="udiff-line-modified-removed">-         MyValue9? a[][] = new MyValue9?[10][0];</span>
<span class="udiff-line-modified-added">+         MyValue9.ref a[][] = new MyValue9.ref[10][0];</span>
          Asserts.assertEQ(MyValue9_inited, false);
  
          MyValue9  b[][] = new MyValue9 [10][0];
          Asserts.assertEQ(MyValue9_inited, true);
      }
  
<span class="udiff-line-modified-removed">-     static void test10(MyValue10? dummy) {</span>
<span class="udiff-line-modified-added">+     static void test10(MyValue10.ref dummy) {</span>
          MyValue10[][] a = new MyValue10[1][1];
          if (a[0][0].equals(null)) throw new RuntimeException(&quot;test10 failed&quot;);
      }
  
<span class="udiff-line-modified-removed">-     static void test11(MyValue10? dummy) {</span>
<span class="udiff-line-modified-removed">-         MyValue11?[][] a = new MyValue11?[1][1];</span>
<span class="udiff-line-modified-added">+     static void test11(MyValue10.ref dummy) {</span>
<span class="udiff-line-modified-added">+         MyValue11.ref[][] a = new MyValue11.ref[1][1];</span>
          if (a[0][0] != null) throw new RuntimeException(&quot;test11 failed&quot;);
      }
  
      static public void main(String[] args) {
          test1();
</pre>
<center><a href="TestOnStackReplacement.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TestWithfieldC1.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>