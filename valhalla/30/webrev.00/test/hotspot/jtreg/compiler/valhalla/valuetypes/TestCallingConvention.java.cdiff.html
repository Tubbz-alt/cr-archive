<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/hotspot/jtreg/compiler/valhalla/valuetypes/TestCallingConvention.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="TestC2CCalls.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TestCallingConventionC1.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/compiler/valhalla/valuetypes/TestCallingConvention.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 438,11 ***</span>
          MyValue3 vt = test21();
          test21_vt.verify(vt);
      }
  
      // Test returning a non-flattened value type as fields
<span class="line-modified">!     MyValue3? test22_vt = MyValue3.create();</span>
  
      @Test
      public MyValue3 test22() {
          return (MyValue3) test22_vt;
      }
<span class="line-new-header">--- 438,11 ---</span>
          MyValue3 vt = test21();
          test21_vt.verify(vt);
      }
  
      // Test returning a non-flattened value type as fields
<span class="line-modified">!     MyValue3.ref test22_vt = MyValue3.create();</span>
  
      @Test
      public MyValue3 test22() {
          return (MyValue3) test22_vt;
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 490,38 ***</span>
          Asserts.assertEQ(res2, res3);
      }
  
      // Should not return a nullable value type as fields
      @Test
<span class="line-modified">!     public MyValue2? test24() {</span>
          return null;
      }
  
      @DontCompile
      public void test24_verifier(boolean warmup) {
<span class="line-modified">!         MyValue2? vt = test24();</span>
          Asserts.assertEQ(vt, null);
      }
  
      // Same as test24 but with control flow and inlining
      @ForceInline
<span class="line-modified">!     public MyValue2? test26_callee(boolean b) {</span>
          if (b) {
              return null;
          } else {
              return MyValue2.createWithFieldsInline(rI, true);
          }
      }
  
      @Test
<span class="line-modified">!     public MyValue2? test26(boolean b) {</span>
          return test26_callee(b);
      }
  
      @DontCompile
      public void test26_verifier(boolean warmup) {
<span class="line-modified">!         MyValue2? vt = test26(true);</span>
          Asserts.assertEQ(vt, null);
          vt = test26(false);
          Asserts.assertEQ(vt.hash(), MyValue2.createWithFieldsInline(rI, true).hash());
      }
  
<span class="line-new-header">--- 490,38 ---</span>
          Asserts.assertEQ(res2, res3);
      }
  
      // Should not return a nullable value type as fields
      @Test
<span class="line-modified">!     public MyValue2.ref test24() {</span>
          return null;
      }
  
      @DontCompile
      public void test24_verifier(boolean warmup) {
<span class="line-modified">!         MyValue2.ref vt = test24();</span>
          Asserts.assertEQ(vt, null);
      }
  
      // Same as test24 but with control flow and inlining
      @ForceInline
<span class="line-modified">!     public MyValue2.ref test26_callee(boolean b) {</span>
          if (b) {
              return null;
          } else {
              return MyValue2.createWithFieldsInline(rI, true);
          }
      }
  
      @Test
<span class="line-modified">!     public MyValue2.ref test26(boolean b) {</span>
          return test26_callee(b);
      }
  
      @DontCompile
      public void test26_verifier(boolean warmup) {
<span class="line-modified">!         MyValue2.ref vt = test26(true);</span>
          Asserts.assertEQ(vt, null);
          vt = test26(false);
          Asserts.assertEQ(vt.hash(), MyValue2.createWithFieldsInline(rI, true).hash());
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 577,11 ***</span>
          Test27Value1 val1 = new Test27Value1(val2);
          int result = test27(val1);
          Asserts.assertEQ(result, 8*rI);
      }
  
<span class="line-modified">!     static final MyValue1? test28Val = MyValue1.createWithFieldsDontInline(rI, rL);</span>
  
      @Test
      @Warmup(0)
      public String test28() {
          return test28Val.toString();
<span class="line-new-header">--- 577,11 ---</span>
          Test27Value1 val1 = new Test27Value1(val2);
          int result = test27(val1);
          Asserts.assertEQ(result, 8*rI);
      }
  
<span class="line-modified">!     static final MyValue1.ref test28Val = MyValue1.createWithFieldsDontInline(rI, rL);</span>
  
      @Test
      @Warmup(0)
      public String test28() {
          return test28Val.toString();
</pre>
<center><a href="TestC2CCalls.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TestCallingConventionC1.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>