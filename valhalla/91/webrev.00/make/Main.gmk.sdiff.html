<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/Main.gmk</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
<body>
<center><a href="../.hgtags.sdiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="RunTests.gmk.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/Main.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 623 ))
 624 
 625 $(eval $(call SetupTarget, test-image-hotspot-jtreg-native, \
 626     MAKEFILE := test/JtregNativeHotspot, \
 627     TARGET := test-image-hotspot-jtreg-native, \
 628     DEPS := build-test-hotspot-jtreg-native, \
 629 ))
 630 
 631 $(eval $(call SetupTarget, build-test-jdk-jtreg-native, \
 632     MAKEFILE := test/JtregNativeJdk, \
 633     TARGET := build-test-jdk-jtreg-native, \
 634     DEPS := buildtools-jdk java.base-libs, \
 635 ))
 636 
 637 $(eval $(call SetupTarget, test-image-jdk-jtreg-native, \
 638     MAKEFILE := test/JtregNativeJdk, \
 639     TARGET := test-image-jdk-jtreg-native, \
 640     DEPS := build-test-jdk-jtreg-native, \
 641 ))
 642 












 643 $(eval $(call SetupTarget, build-test-hotspot-jtreg-graal, \
 644     MAKEFILE := test/JtregGraalUnit, \
 645     TARGET := build-test-hotspot-jtreg-graal, \
 646     DEPS := exploded-image, \
 647 ))
 648 
 649 $(eval $(call SetupTarget, test-image-hotspot-jtreg-graal, \
 650     MAKEFILE := test/JtregGraalUnit, \
 651     TARGET := test-image-hotspot-jtreg-graal, \
 652     DEPS := build-test-hotspot-jtreg-graal, \
 653 ))
 654 
 655 ifneq ($GTEST_FRAMEWORK_SRC), )
 656   $(eval $(call SetupTarget, test-image-hotspot-gtest, \
 657       MAKEFILE := hotspot/test/GtestImage, \
 658       DEPS := hotspot, \
 659   ))
 660 endif
 661 
 662 $(eval $(call SetupTarget, build-test-lib, \
</pre>
<hr />
<pre>
 965   docs-reference-api-javadoc: $(GENSRC_TARGETS)
 966 
 967   # If not already set, then set the JVM specific docs targets
 968   JVM_DOCS_TARGETS ?= hotspot-$(JVM_VARIANT_MAIN)-gensrc
 969 
 970   # The gensrc steps for hotspot create html spec files.
 971   docs-jdk-specs: $(JVM_DOCS_TARGETS)
 972 
 973   # Tests
 974   test-make: clean-test-make compile-commands
 975 
 976   test-make-compile-commands: compile-commands
 977 
 978   # Declare dependency for all generated test targets
 979   $(foreach t, $(filter-out test-make%, $(ALL_TEST_TARGETS)), $(eval $t: jdk-image test-image))
 980   $(foreach t, $(ALL_EXPLODED_TEST_TARGETS), $(eval $t: exploded-image test-image))
 981 
 982   interim-image: $(INTERIM_JMOD_TARGETS)
 983 
 984   build-test-hotspot-jtreg-native: hotspot-$(JVM_VARIANT_MAIN)-libs

 985 
 986 endif
 987 
 988 ################################################################################
 989 # Virtual targets without recipes
 990 
 991 # If not already set, set the JVM specific tools targets
 992 JVM_TOOLS_TARGETS ?= buildtools-hotspot
 993 buildtools: buildtools-langtools interim-langtools \
 994     buildtools-jdk $(JVM_TOOLS_TARGETS)
 995 
 996 # Declare dependencies from hotspot-&lt;variant&gt; targets
 997 $(foreach v, $(JVM_VARIANTS), \
 998   $(eval hotspot-$v: hotspot-$v-gensrc hotspot-$v-libs) \
 999 )
1000 hotspot: $(HOTSPOT_VARIANT_TARGETS)
1001 
1002 # Create targets hotspot-libs and hotspot-gensrc.
1003 $(foreach v, $(JVM_VARIANTS), \
1004   $(eval hotspot-libs: hotspot-$v-libs) \
</pre>
<hr />
<pre>
1088 # The module summary cannot be run when:
1089 # * Cross compiling and building a partial BUILDJDK for the build host
1090 # * An external buildjdk has been supplied since it may not match the
1091 #   module selection of the target jdk
1092 ifneq ($(CREATE_BUILDJDK), true)
1093   ifeq ($(EXTERNAL_BUILDJDK), false)
1094     product-images: generate-summary
1095   endif
1096 endif
1097 
1098 ifeq ($(call isTargetOs, macosx), true)
1099   product-images: mac-jdk-bundle
1100 
1101   legacy-images: mac-legacy-jre-bundle
1102 endif
1103 
1104 # This target builds the documentation image
1105 docs-image: docs-jdk
1106 
1107 # This target builds the test image
<span class="line-modified">1108 test-image: prepare-test-image test-image-jdk-jtreg-native test-image-demos-jdk</span>
1109 
1110 ifneq ($(JVM_TEST_IMAGE_TARGETS), )
1111   # If JVM_TEST_IMAGE_TARGETS is externally defined, use it instead of the
1112   # standard hotspot set of tests.
1113   test-image: $(JVM_TEST_IMAGE_TARGETS)
1114 else
1115   test-image: test-image-hotspot-jtreg-native
1116   ifneq ($(GTEST_FRAMEWORK_SRC), )
1117     test-image: test-image-hotspot-gtest
1118   endif
1119 
1120   ifeq ($(INCLUDE_GRAAL), true)
1121     test-image: test-image-hotspot-jtreg-graal
1122   endif
1123 endif
1124 
1125 ifeq ($(BUILD_FAILURE_HANDLER), true)
1126   test-image: test-image-failure-handler
1127 endif
1128 
</pre>
</td>
<td>
<hr />
<pre>
 623 ))
 624 
 625 $(eval $(call SetupTarget, test-image-hotspot-jtreg-native, \
 626     MAKEFILE := test/JtregNativeHotspot, \
 627     TARGET := test-image-hotspot-jtreg-native, \
 628     DEPS := build-test-hotspot-jtreg-native, \
 629 ))
 630 
 631 $(eval $(call SetupTarget, build-test-jdk-jtreg-native, \
 632     MAKEFILE := test/JtregNativeJdk, \
 633     TARGET := build-test-jdk-jtreg-native, \
 634     DEPS := buildtools-jdk java.base-libs, \
 635 ))
 636 
 637 $(eval $(call SetupTarget, test-image-jdk-jtreg-native, \
 638     MAKEFILE := test/JtregNativeJdk, \
 639     TARGET := test-image-jdk-jtreg-native, \
 640     DEPS := build-test-jdk-jtreg-native, \
 641 ))
 642 
<span class="line-added"> 643 $(eval $(call SetupTarget, build-test-libtest-jtreg-native, \</span>
<span class="line-added"> 644     MAKEFILE := test/JtregNativeLibTest, \</span>
<span class="line-added"> 645     TARGET := build-test-libtest-jtreg-native, \</span>
<span class="line-added"> 646     DEPS := buildtools-jdk, \</span>
<span class="line-added"> 647 ))</span>
<span class="line-added"> 648 </span>
<span class="line-added"> 649 $(eval $(call SetupTarget, test-image-libtest-jtreg-native, \</span>
<span class="line-added"> 650     MAKEFILE := test/JtregNativeLibTest, \</span>
<span class="line-added"> 651     TARGET := test-image-libtest-jtreg-native, \</span>
<span class="line-added"> 652     DEPS := build-test-libtest-jtreg-native, \</span>
<span class="line-added"> 653 ))</span>
<span class="line-added"> 654 </span>
 655 $(eval $(call SetupTarget, build-test-hotspot-jtreg-graal, \
 656     MAKEFILE := test/JtregGraalUnit, \
 657     TARGET := build-test-hotspot-jtreg-graal, \
 658     DEPS := exploded-image, \
 659 ))
 660 
 661 $(eval $(call SetupTarget, test-image-hotspot-jtreg-graal, \
 662     MAKEFILE := test/JtregGraalUnit, \
 663     TARGET := test-image-hotspot-jtreg-graal, \
 664     DEPS := build-test-hotspot-jtreg-graal, \
 665 ))
 666 
 667 ifneq ($GTEST_FRAMEWORK_SRC), )
 668   $(eval $(call SetupTarget, test-image-hotspot-gtest, \
 669       MAKEFILE := hotspot/test/GtestImage, \
 670       DEPS := hotspot, \
 671   ))
 672 endif
 673 
 674 $(eval $(call SetupTarget, build-test-lib, \
</pre>
<hr />
<pre>
 977   docs-reference-api-javadoc: $(GENSRC_TARGETS)
 978 
 979   # If not already set, then set the JVM specific docs targets
 980   JVM_DOCS_TARGETS ?= hotspot-$(JVM_VARIANT_MAIN)-gensrc
 981 
 982   # The gensrc steps for hotspot create html spec files.
 983   docs-jdk-specs: $(JVM_DOCS_TARGETS)
 984 
 985   # Tests
 986   test-make: clean-test-make compile-commands
 987 
 988   test-make-compile-commands: compile-commands
 989 
 990   # Declare dependency for all generated test targets
 991   $(foreach t, $(filter-out test-make%, $(ALL_TEST_TARGETS)), $(eval $t: jdk-image test-image))
 992   $(foreach t, $(ALL_EXPLODED_TEST_TARGETS), $(eval $t: exploded-image test-image))
 993 
 994   interim-image: $(INTERIM_JMOD_TARGETS)
 995 
 996   build-test-hotspot-jtreg-native: hotspot-$(JVM_VARIANT_MAIN)-libs
<span class="line-added"> 997   build-test-libtest-jtreg-native: hotspot-$(JVM_VARIANT_MAIN)-libs</span>
 998 
 999 endif
1000 
1001 ################################################################################
1002 # Virtual targets without recipes
1003 
1004 # If not already set, set the JVM specific tools targets
1005 JVM_TOOLS_TARGETS ?= buildtools-hotspot
1006 buildtools: buildtools-langtools interim-langtools \
1007     buildtools-jdk $(JVM_TOOLS_TARGETS)
1008 
1009 # Declare dependencies from hotspot-&lt;variant&gt; targets
1010 $(foreach v, $(JVM_VARIANTS), \
1011   $(eval hotspot-$v: hotspot-$v-gensrc hotspot-$v-libs) \
1012 )
1013 hotspot: $(HOTSPOT_VARIANT_TARGETS)
1014 
1015 # Create targets hotspot-libs and hotspot-gensrc.
1016 $(foreach v, $(JVM_VARIANTS), \
1017   $(eval hotspot-libs: hotspot-$v-libs) \
</pre>
<hr />
<pre>
1101 # The module summary cannot be run when:
1102 # * Cross compiling and building a partial BUILDJDK for the build host
1103 # * An external buildjdk has been supplied since it may not match the
1104 #   module selection of the target jdk
1105 ifneq ($(CREATE_BUILDJDK), true)
1106   ifeq ($(EXTERNAL_BUILDJDK), false)
1107     product-images: generate-summary
1108   endif
1109 endif
1110 
1111 ifeq ($(call isTargetOs, macosx), true)
1112   product-images: mac-jdk-bundle
1113 
1114   legacy-images: mac-legacy-jre-bundle
1115 endif
1116 
1117 # This target builds the documentation image
1118 docs-image: docs-jdk
1119 
1120 # This target builds the test image
<span class="line-modified">1121 test-image: prepare-test-image test-image-jdk-jtreg-native test-image-demos-jdk test-image-libtest-jtreg-native</span>
1122 
1123 ifneq ($(JVM_TEST_IMAGE_TARGETS), )
1124   # If JVM_TEST_IMAGE_TARGETS is externally defined, use it instead of the
1125   # standard hotspot set of tests.
1126   test-image: $(JVM_TEST_IMAGE_TARGETS)
1127 else
1128   test-image: test-image-hotspot-jtreg-native
1129   ifneq ($(GTEST_FRAMEWORK_SRC), )
1130     test-image: test-image-hotspot-gtest
1131   endif
1132 
1133   ifeq ($(INCLUDE_GRAAL), true)
1134     test-image: test-image-hotspot-jtreg-graal
1135   endif
1136 endif
1137 
1138 ifeq ($(BUILD_FAILURE_HANDLER), true)
1139   test-image: test-image-failure-handler
1140 endif
1141 
</pre>
</td>
</tr>
</table>
<center><a href="../.hgtags.sdiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="RunTests.gmk.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>