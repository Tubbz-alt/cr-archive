<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/oops/methodData.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="methodCounters.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="methodData.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/oops/methodData.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 228 }
 229 
 230 class ArgumentOffsetComputer : public SignatureIterator {
 231 private:
 232   int _max;
 233   int _offset;
 234   GrowableArray&lt;int&gt; _offsets;
 235 
 236   friend class SignatureIterator;  // so do_parameters_on can call do_type
 237   void do_type(BasicType type) {
 238     if (is_reference_type(type) &amp;&amp; _offsets.length() &lt; _max) {
 239       _offsets.push(_offset);
 240     }
 241     _offset += parameter_type_word_count(type);
 242   }
 243 
 244  public:
 245   ArgumentOffsetComputer(Symbol* signature, int max)
 246     : SignatureIterator(signature),
 247       _max(max), _offset(0),
<span class="line-modified"> 248       _offsets(Thread::current(), max) {</span>
 249     do_parameters_on(this);  // non-virtual template execution
 250   }
 251 
 252   int off_at(int i) const { return _offsets.at(i); }
 253 };
 254 
 255 void TypeStackSlotEntries::post_initialize(Symbol* signature, bool has_receiver, bool include_receiver) {
 256   ResourceMark rm;
 257   int start = 0;
 258   // Parameter profiling include the receiver
 259   if (include_receiver &amp;&amp; has_receiver) {
 260     set_stack_slot(0, 0);
 261     set_type(0, type_none());
 262     start += 1;
 263   }
 264   ArgumentOffsetComputer aos(signature, _number_of_entries-start);
 265   for (int i = start; i &lt; _number_of_entries; i++) {
 266     set_stack_slot(i, aos.off_at(i-start) + (has_receiver ? 1 : 0));
 267     set_type(i, type_none());
 268   }
</pre>
</td>
<td>
<hr />
<pre>
 228 }
 229 
 230 class ArgumentOffsetComputer : public SignatureIterator {
 231 private:
 232   int _max;
 233   int _offset;
 234   GrowableArray&lt;int&gt; _offsets;
 235 
 236   friend class SignatureIterator;  // so do_parameters_on can call do_type
 237   void do_type(BasicType type) {
 238     if (is_reference_type(type) &amp;&amp; _offsets.length() &lt; _max) {
 239       _offsets.push(_offset);
 240     }
 241     _offset += parameter_type_word_count(type);
 242   }
 243 
 244  public:
 245   ArgumentOffsetComputer(Symbol* signature, int max)
 246     : SignatureIterator(signature),
 247       _max(max), _offset(0),
<span class="line-modified"> 248       _offsets(max) {</span>
 249     do_parameters_on(this);  // non-virtual template execution
 250   }
 251 
 252   int off_at(int i) const { return _offsets.at(i); }
 253 };
 254 
 255 void TypeStackSlotEntries::post_initialize(Symbol* signature, bool has_receiver, bool include_receiver) {
 256   ResourceMark rm;
 257   int start = 0;
 258   // Parameter profiling include the receiver
 259   if (include_receiver &amp;&amp; has_receiver) {
 260     set_stack_slot(0, 0);
 261     set_type(0, type_none());
 262     start += 1;
 263   }
 264   ArgumentOffsetComputer aos(signature, _number_of_entries-start);
 265   for (int i = start; i &lt; _number_of_entries; i++) {
 266     set_stack_slot(i, aos.off_at(i-start) + (has_receiver ? 1 : 0));
 267     set_type(i, type_none());
 268   }
</pre>
</td>
</tr>
</table>
<center><a href="methodCounters.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="methodData.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>