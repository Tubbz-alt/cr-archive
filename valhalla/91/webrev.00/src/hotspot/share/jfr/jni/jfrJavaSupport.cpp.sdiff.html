<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/jfr/jni/jfrJavaSupport.cpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../../interpreter/interpreterRuntime.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../leakprofiler/checkpoint/objectSampleCheckpoint.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/jfr/jni/jfrJavaSupport.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
664   return -1 == find_exclusion_thread_idx(thread);
665 }
666 
667 static bool thread_is_not_excluded(jobject thread) {
668   return thread_is_not_excluded(as_handle(thread));
669 }
670 
671 static bool is_thread_excluded(jobject thread) {
672   return !thread_is_not_excluded(thread);
673 }
674 
675 #ifdef ASSERT
676 static bool is_thread_excluded(Handle thread) {
677   return !thread_is_not_excluded(thread);
678 }
679 #endif // ASSERT
680 
681 static int add_thread_to_exclusion_list(jobject thread) {
682   ThreadExclusionListAccess lock;
683   if (exclusion_list == NULL) {
<span class="line-modified">684     exclusion_list = new (ResourceObj::C_HEAP, mtTracing) GrowableArray&lt;jweak&gt;(10, true, mtTracing);</span>
685   }
686   assert(exclusion_list != NULL, &quot;invariant&quot;);
687   assert(thread_is_not_excluded(thread), &quot;invariant&quot;);
688   jweak ref = JfrJavaSupport::global_weak_jni_handle(thread, Thread::current());
689   const int idx = exclusion_list-&gt;append(ref);
690   assert(is_thread_excluded(thread), &quot;invariant&quot;);
691   return idx;
692 }
693 
694 static void remove_thread_from_exclusion_list(Handle thread) {
695   assert(exclusion_list != NULL, &quot;invariant&quot;);
696   assert(is_thread_excluded(thread), &quot;invariant&quot;);
697   assert(exclusion_list != NULL, &quot;invariant&quot;);
698   const int idx = find_exclusion_thread_idx(thread);
699   assert(idx &gt;= 0, &quot;invariant&quot;);
700   assert(idx &lt; exclusion_list-&gt;length(), &quot;invariant&quot;);
701   JfrJavaSupport::destroy_global_weak_jni_handle(exclusion_list-&gt;at(idx));
702   exclusion_list-&gt;delete_at(idx);
703   assert(thread_is_not_excluded(thread), &quot;invariant&quot;);
704   if (0 == exclusion_list-&gt;length()) {
</pre>
</td>
<td>
<hr />
<pre>
664   return -1 == find_exclusion_thread_idx(thread);
665 }
666 
667 static bool thread_is_not_excluded(jobject thread) {
668   return thread_is_not_excluded(as_handle(thread));
669 }
670 
671 static bool is_thread_excluded(jobject thread) {
672   return !thread_is_not_excluded(thread);
673 }
674 
675 #ifdef ASSERT
676 static bool is_thread_excluded(Handle thread) {
677   return !thread_is_not_excluded(thread);
678 }
679 #endif // ASSERT
680 
681 static int add_thread_to_exclusion_list(jobject thread) {
682   ThreadExclusionListAccess lock;
683   if (exclusion_list == NULL) {
<span class="line-modified">684     exclusion_list = new (ResourceObj::C_HEAP, mtTracing) GrowableArray&lt;jweak&gt;(10, mtTracing);</span>
685   }
686   assert(exclusion_list != NULL, &quot;invariant&quot;);
687   assert(thread_is_not_excluded(thread), &quot;invariant&quot;);
688   jweak ref = JfrJavaSupport::global_weak_jni_handle(thread, Thread::current());
689   const int idx = exclusion_list-&gt;append(ref);
690   assert(is_thread_excluded(thread), &quot;invariant&quot;);
691   return idx;
692 }
693 
694 static void remove_thread_from_exclusion_list(Handle thread) {
695   assert(exclusion_list != NULL, &quot;invariant&quot;);
696   assert(is_thread_excluded(thread), &quot;invariant&quot;);
697   assert(exclusion_list != NULL, &quot;invariant&quot;);
698   const int idx = find_exclusion_thread_idx(thread);
699   assert(idx &gt;= 0, &quot;invariant&quot;);
700   assert(idx &lt; exclusion_list-&gt;length(), &quot;invariant&quot;);
701   JfrJavaSupport::destroy_global_weak_jni_handle(exclusion_list-&gt;at(idx));
702   exclusion_list-&gt;delete_at(idx);
703   assert(thread_is_not_excluded(thread), &quot;invariant&quot;);
704   if (0 == exclusion_list-&gt;length()) {
</pre>
</td>
</tr>
</table>
<center><a href="../../interpreter/interpreterRuntime.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../leakprofiler/checkpoint/objectSampleCheckpoint.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>