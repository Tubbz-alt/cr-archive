<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/jdk/tools/jpackage/share/jdk/jpackage/tests/BasicTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../macosx/base/SigningCheck.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../langtools/ProblemList.txt.udiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/tools/jpackage/share/jdk/jpackage/tests/BasicTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -301,63 +301,10 @@</span>
          // Verify output of jpackage command.
          cmd.assertImageCreated();
          HelloApp.executeLauncherAndVerifyOutput(cmd);
      }
  
<span class="udiff-line-removed">-     @Parameter(&quot;Hello&quot;)</span>
<span class="udiff-line-removed">-     @Parameter(&quot;com.foo/com.foo.main.Aloha&quot;)</span>
<span class="udiff-line-removed">-     @Test</span>
<span class="udiff-line-removed">-     public void testJLinkRuntime(String javaAppDesc) throws IOException {</span>
<span class="udiff-line-removed">-         JavaAppDesc appDesc = JavaAppDesc.parse(javaAppDesc);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         JPackageCommand cmd = JPackageCommand.helloAppImage(appDesc);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         final String moduleName = appDesc.moduleName();</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         if (moduleName != null) {</span>
<span class="udiff-line-removed">-             // Build module jar.</span>
<span class="udiff-line-removed">-             cmd.executePrerequisiteActions();</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         final Path runtimeDir = TKit.createTempDirectory(&quot;runtime&quot;).resolve(&quot;data&quot;);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // List of modules required for test app.</span>
<span class="udiff-line-removed">-         final var modules = new String[] {</span>
<span class="udiff-line-removed">-             &quot;java.base&quot;,</span>
<span class="udiff-line-removed">-             &quot;java.desktop&quot;</span>
<span class="udiff-line-removed">-         };</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         Executor jlink = getToolProvider(JavaTool.JLINK)</span>
<span class="udiff-line-removed">-         .saveOutput(false)</span>
<span class="udiff-line-removed">-         .addArguments(</span>
<span class="udiff-line-removed">-                 &quot;--add-modules&quot;, String.join(&quot;,&quot;, modules),</span>
<span class="udiff-line-removed">-                 &quot;--output&quot;, runtimeDir.toString(),</span>
<span class="udiff-line-removed">-                 &quot;--strip-debug&quot;,</span>
<span class="udiff-line-removed">-                 &quot;--no-header-files&quot;,</span>
<span class="udiff-line-removed">-                 &quot;--no-man-pages&quot;);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         TKit.trace(&quot;jlink output BEGIN&quot;);</span>
<span class="udiff-line-removed">-         try (Stream&lt;Path&gt; paths = Files.walk(runtimeDir)) {</span>
<span class="udiff-line-removed">-             paths.filter(Files::isRegularFile)</span>
<span class="udiff-line-removed">-                     .map(runtimeDir::relativize)</span>
<span class="udiff-line-removed">-                     .map(Path::toString)</span>
<span class="udiff-line-removed">-                     .forEach(TKit::trace);</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-         TKit.trace(&quot;jlink output END&quot;);</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         if (moduleName != null) {</span>
<span class="udiff-line-removed">-             jlink.addArguments(&quot;--add-modules&quot;, moduleName, &quot;--module-path&quot;,</span>
<span class="udiff-line-removed">-                     Path.of(cmd.getArgumentValue(&quot;--module-path&quot;)).resolve(</span>
<span class="udiff-line-removed">-                             &quot;hello.jar&quot;).toString());</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         jlink.execute();</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         cmd.addArguments(&quot;--runtime-image&quot;, runtimeDir);</span>
<span class="udiff-line-removed">-         cmd.executeAndAssertHelloAppImageCreated();</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">- </span>
      private static Executor getJPackageToolProvider() {
          return getToolProvider(JavaTool.JPACKAGE);
      }
  
      private static Executor getToolProvider(JavaTool tool) {
</pre>
<center><a href="../../../../macosx/base/SigningCheck.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../langtools/ProblemList.txt.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>