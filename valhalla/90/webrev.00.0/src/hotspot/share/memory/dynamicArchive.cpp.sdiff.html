<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/memory/dynamicArchive.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="allocation.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="heapInspection.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/memory/dynamicArchive.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 518 
 519   void init_first_dump_space(address reserved_bottom) {
 520     DumpRegion* mc_space = MetaspaceShared::misc_code_dump_space();
 521     DumpRegion* rw_space = MetaspaceShared::read_write_dump_space();
 522 
 523     // Use the same MC-&gt;RW-&gt;RO ordering as in the base archive.
 524     MetaspaceShared::init_shared_dump_space(mc_space);
 525     _current_dump_space = mc_space;
 526     _last_verified_top = reserved_bottom;
 527     _num_dump_regions_used = 1;
 528   }
 529 
 530   void reserve_buffers_for_trampolines() {
 531     size_t n = _estimated_trampoline_bytes;
 532     assert(n &gt;= SharedRuntime::trampoline_size(), &quot;dont want to be empty&quot;);
 533     MetaspaceShared::misc_code_space_alloc(n);
 534   }
 535 
 536 public:
 537   DynamicArchiveBuilder() {
<span class="line-modified"> 538     _klasses = new (ResourceObj::C_HEAP, mtClass) GrowableArray&lt;InstanceKlass*&gt;(100, true, mtInternal);</span>
<span class="line-modified"> 539     _symbols = new (ResourceObj::C_HEAP, mtClass) GrowableArray&lt;Symbol*&gt;(1000, true, mtInternal);</span>
 540 
 541     _estimated_metsapceobj_bytes = 0;
 542     _estimated_hashtable_bytes = 0;
 543     _estimated_trampoline_bytes = 0;
 544 
 545     _num_dump_regions_used = 0;
 546   }
 547 
 548   void start_dump_space(DumpRegion* next) {
 549     address bottom = _last_verified_top;
 550     address top = (address)(current_dump_space()-&gt;top());
 551     _other_region_used_bytes += size_t(top - bottom);
 552 
 553     MetaspaceShared::pack_dump_space(current_dump_space(), next, MetaspaceShared::shared_rs());
 554     _current_dump_space = next;
 555     _num_dump_regions_used ++;
 556 
 557     _last_verified_top = (address)(current_dump_space()-&gt;top());
 558   }
 559 
</pre>
</td>
<td>
<hr />
<pre>
 518 
 519   void init_first_dump_space(address reserved_bottom) {
 520     DumpRegion* mc_space = MetaspaceShared::misc_code_dump_space();
 521     DumpRegion* rw_space = MetaspaceShared::read_write_dump_space();
 522 
 523     // Use the same MC-&gt;RW-&gt;RO ordering as in the base archive.
 524     MetaspaceShared::init_shared_dump_space(mc_space);
 525     _current_dump_space = mc_space;
 526     _last_verified_top = reserved_bottom;
 527     _num_dump_regions_used = 1;
 528   }
 529 
 530   void reserve_buffers_for_trampolines() {
 531     size_t n = _estimated_trampoline_bytes;
 532     assert(n &gt;= SharedRuntime::trampoline_size(), &quot;dont want to be empty&quot;);
 533     MetaspaceShared::misc_code_space_alloc(n);
 534   }
 535 
 536 public:
 537   DynamicArchiveBuilder() {
<span class="line-modified"> 538     _klasses = new (ResourceObj::C_HEAP, mtClass) GrowableArray&lt;InstanceKlass*&gt;(100, mtClass);</span>
<span class="line-modified"> 539     _symbols = new (ResourceObj::C_HEAP, mtClass) GrowableArray&lt;Symbol*&gt;(1000, mtClass);</span>
 540 
 541     _estimated_metsapceobj_bytes = 0;
 542     _estimated_hashtable_bytes = 0;
 543     _estimated_trampoline_bytes = 0;
 544 
 545     _num_dump_regions_used = 0;
 546   }
 547 
 548   void start_dump_space(DumpRegion* next) {
 549     address bottom = _last_verified_top;
 550     address top = (address)(current_dump_space()-&gt;top());
 551     _other_region_used_bytes += size_t(top - bottom);
 552 
 553     MetaspaceShared::pack_dump_space(current_dump_space(), next, MetaspaceShared::shared_rs());
 554     _current_dump_space = next;
 555     _num_dump_regions_used ++;
 556 
 557     _last_verified_top = (address)(current_dump_space()-&gt;top());
 558   }
 559 
</pre>
</td>
</tr>
</table>
<center><a href="allocation.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="heapInspection.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>