<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/Contents.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 1998, 2020, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package jdk.javadoc.internal.doclets.formats.html;
 27 
 28 import java.util.EnumMap;
 29 import java.util.Objects;
 30 import java.util.regex.Matcher;
 31 import java.util.regex.Pattern;
 32 
 33 import jdk.javadoc.internal.doclets.formats.html.markup.Comment;
 34 import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;
 35 import jdk.javadoc.internal.doclets.formats.html.markup.Entity;
 36 import jdk.javadoc.internal.doclets.formats.html.markup.FixedStringContent;
 37 import jdk.javadoc.internal.doclets.formats.html.markup.StringContent;
 38 import jdk.javadoc.internal.doclets.toolkit.Content;
 39 import jdk.javadoc.internal.doclets.toolkit.Resources;
 40 import jdk.javadoc.internal.doclets.toolkit.util.DocletConstants;
 41 import jdk.javadoc.internal.doclets.toolkit.util.VisibleMemberTable;
 42 
 43 
 44 /**
 45  * Constants and factory methods for common fragments of content
 46  * used by HtmlDoclet. The string content of these fragments is
 47  * generally obtained from the {@link Resources resources} found
 48  * in the doclet&#39;s configuration.
 49  *
 50  * @implNote
 51  * Many constants are made available in this class, so that they are
 52  * only created once per doclet-instance, instead of once per generated page.
 53  */
 54 public class Contents {
 55 
 56     public final Content allClassesLabel;
 57     public final Content allImplementedInterfacesLabel;
 58     public final Content allModulesLabel;
 59     public final Content allPackagesLabel;
 60     public final Content allSuperinterfacesLabel;
 61     public final Content also;
 62     public final Content annotationTypeOptionalMemberLabel;
 63     public final Content annotationTypeRequiredMemberLabel;
 64     public final Content annotateTypeOptionalMemberSummaryLabel;
 65     public final Content annotateTypeRequiredMemberSummaryLabel;
 66     public final Content annotationType;
 67     public final Content annotationTypeDetailsLabel;
 68     public final Content annotationTypeMemberDetail;
 69     public final Content annotationtypes;
 70     public final Content annotationTypes;
 71     public final Content classLabel;
 72     public final Content classes;
 73     public final Content constantFieldLabel;
 74     public final Content constantsSummaryTitle;
 75     public final Content constructorLabel;
 76     public final Content constructorDetailsLabel;
 77     public final Content constructorSummaryLabel;
 78     public final Content constructors;
 79     public final Content contentsHeading;
 80     public final Content defaultPackageLabel;
 81     public final Content default_;
 82     public final Content deprecatedAPI;
 83     public final Content deprecatedLabel;
 84     public final Content deprecatedPhrase;
 85     public final Content deprecatedForRemovalPhrase;
 86     public final Content descfrmClassLabel;
 87     public final Content descfrmInterfaceLabel;
 88     public final Content descriptionLabel;
 89     public final Content detailLabel;
 90     public final Content enclosingClassLabel;
 91     public final Content enclosingInterfaceLabel;
 92     public final Content enumConstantLabel;
 93     public final Content enumConstantDetailLabel;
 94     public final Content enumConstantSummary;
 95     public final Content enum_;
 96     public final Content enums;
 97     public final Content error;
 98     public final Content errors;
 99     public final Content exception;
100     public final Content exceptions;
101     public final Content exportedTo;
102     public final Content fieldLabel;
103     public final Content fieldDetailsLabel;
104     public final Content fieldSummaryLabel;
105     public final Content fields;
106     public final Content framesLabel;
107     public final Content fromLabel;
108     public final Content functionalInterface;
109     public final Content functionalInterfaceMessage;
110     public final Content helpLabel;
111     public final Content hierarchyForAllPackages;
112     public final Content implementation;
113     public final Content implementingClassesLabel;
114     public final Content inClass;
115     public final Content inInterface;
116     public final Content indexLabel;
117     public final Content interfaceLabel;
118     public final Content interfaces;
119     public final Content methodDetailLabel;
120     public final Content methodLabel;
121     public final Content methodSummary;
122     public final Content methods;
123     public final Content modifierAndTypeLabel;
124     public final Content modifierLabel;
125     public final Content moduleLabel;
126     public final Content module_;
127     public final Content moduleSubNavLabel;
128     public final Content modulesLabel;
129     public final Content navAnnotationTypeMember;
130     public final Content navAnnotationTypeOptionalMember;
131     public final Content navAnnotationTypeRequiredMember;
132     public final Content navConstructor;
133     public final Content navEnum;
134     public final Content navField;
135     public final Content navMethod;
136     public final Content navModuleDescription;
137     public final Content navModules;
138     public final Content navNested;
139     public final Content navPackages;
140     public final Content navProperty;
141     public final Content navServices;
142     public final Content nestedClassSummary;
143     public final Content newPage;
144     public final Content noFramesLabel;
145     public final Content noScriptMessage;
146     public final Content openModuleLabel;
147     public final Content openedTo;
148     public final Content overridesLabel;
149     public final Content overviewLabel;
150     public final Content packageHierarchies;
151     public final Content packageLabel;
152     public final Content package_;
153     public final Content packagesLabel;
154     public final Content parameters;
155     public final Content properties;
156     public final Content propertyLabel;
157     public final Content propertyDetailsLabel;
158     public final Content propertySummaryLabel;
159     public final Content record;
160     public final Content recordComponents;
161     public final Content referencedIn;
162     public final Content returns;
163     public final Content seeAlso;
164     public final Content serializedForm;
165     public final Content servicesLabel;
166     public final Content specifiedByLabel;
167     public final Content subclassesLabel;
168     public final Content subinterfacesLabel;
169     public final Content summaryLabel;
170     public final Content systemPropertiesLabel;
171     public final Content systemPropertiesSummaryLabel;
172     public final Content throws_;
173     public final Content treeLabel;
174     public final Content typeLabel;
175     public final Content typeParameters;
176     public final Content useLabel;
177     public final Content valueLabel;
178 
179     private final EnumMap&lt;VisibleMemberTable.Kind, Content&gt; navLinkLabels;
180 
181     private final Resources resources;
182 
183     /**
184      * Creates a {@code Contents} object.
185      *
186      * @param configuration the configuration in which to find the
187      * resources used to look up resource keys, and other details.
188      */
189     Contents(HtmlConfiguration configuration) {
190         this.resources = configuration.getDocResources();
191 
192         allClassesLabel = getNonBreakContent(&quot;doclet.All_Classes&quot;);
193         allImplementedInterfacesLabel = getContent(&quot;doclet.All_Implemented_Interfaces&quot;);
194         allModulesLabel = getNonBreakContent(&quot;doclet.All_Modules&quot;);
195         allPackagesLabel = getNonBreakContent(&quot;doclet.All_Packages&quot;);
196         allSuperinterfacesLabel = getContent(&quot;doclet.All_Superinterfaces&quot;);
197         also = getContent(&quot;doclet.also&quot;);
198         annotationTypeOptionalMemberLabel = getContent(&quot;doclet.Annotation_Type_Optional_Member&quot;);
199         annotationTypeRequiredMemberLabel = getContent(&quot;doclet.Annotation_Type_Required_Member&quot;);
200         annotateTypeOptionalMemberSummaryLabel = getContent(&quot;doclet.Annotation_Type_Optional_Member_Summary&quot;);
201         annotateTypeRequiredMemberSummaryLabel = getContent(&quot;doclet.Annotation_Type_Required_Member_Summary&quot;);
202         annotationType = getContent(&quot;doclet.AnnotationType&quot;);
203         annotationTypeDetailsLabel = getContent(&quot;doclet.Annotation_Type_Member_Detail&quot;);
204         annotationTypeMemberDetail = getContent(&quot;doclet.Annotation_Type_Member_Detail&quot;);
205         annotationTypes = getContent(&quot;doclet.AnnotationTypes&quot;);
206         annotationtypes = getContent(&quot;doclet.annotationtypes&quot;);
207         classLabel = getContent(&quot;doclet.Class&quot;);
208         classes = getContent(&quot;doclet.Classes&quot;);
209         constantFieldLabel = getContent(&quot;doclet.ConstantField&quot;);
210         constantsSummaryTitle = getContent(&quot;doclet.Constants_Summary&quot;);
211         constructorLabel = getContent(&quot;doclet.Constructor&quot;);
212         constructorDetailsLabel = getContent(&quot;doclet.Constructor_Detail&quot;);
213         constructorSummaryLabel = getContent(&quot;doclet.Constructor_Summary&quot;);
214         constructors = getContent(&quot;doclet.Constructors&quot;);
215         contentsHeading = getContent(&quot;doclet.Contents&quot;);
216         defaultPackageLabel = new StringContent(DocletConstants.DEFAULT_PACKAGE_NAME);
217         default_ = getContent(&quot;doclet.Default&quot;);
218         deprecatedAPI = getContent(&quot;doclet.Deprecated_API&quot;);
219         deprecatedLabel = getContent(&quot;doclet.navDeprecated&quot;);
220         deprecatedPhrase = getContent(&quot;doclet.Deprecated&quot;);
221         deprecatedForRemovalPhrase = getContent(&quot;doclet.DeprecatedForRemoval&quot;);
222         descfrmClassLabel = getContent(&quot;doclet.Description_From_Class&quot;);
223         descfrmInterfaceLabel = getContent(&quot;doclet.Description_From_Interface&quot;);
224         descriptionLabel = getContent(&quot;doclet.Description&quot;);
225         detailLabel = getContent(&quot;doclet.Detail&quot;);
226         enclosingClassLabel = getContent(&quot;doclet.Enclosing_Class&quot;);
227         enclosingInterfaceLabel = getContent(&quot;doclet.Enclosing_Interface&quot;);
228         enumConstantLabel = getContent(&quot;doclet.Enum_Constant&quot;);
229         enumConstantDetailLabel = getContent(&quot;doclet.Enum_Constant_Detail&quot;);
230         enumConstantSummary = getContent(&quot;doclet.Enum_Constant_Summary&quot;);
231         enum_ = getContent(&quot;doclet.Enum&quot;);
232         enums = getContent(&quot;doclet.Enums&quot;);
233         error = getContent(&quot;doclet.Error&quot;);
234         errors = getContent(&quot;doclet.Errors&quot;);
235         exception = getContent(&quot;doclet.Exception&quot;);
236         exceptions = getContent(&quot;doclet.Exceptions&quot;);
237         exportedTo = getContent(&quot;doclet.ExportedTo&quot;);
238         fieldDetailsLabel = getContent(&quot;doclet.Field_Detail&quot;);
239         fieldSummaryLabel = getContent(&quot;doclet.Field_Summary&quot;);
240         fieldLabel = getContent(&quot;doclet.Field&quot;);
241         fields = getContent(&quot;doclet.Fields&quot;);
242         framesLabel = getContent(&quot;doclet.Frames&quot;);
243         fromLabel = getContent(&quot;doclet.From&quot;);
244         functionalInterface = getContent(&quot;doclet.Functional_Interface&quot;);
245         functionalInterfaceMessage = getContent(&quot;doclet.Functional_Interface_Message&quot;);
246         helpLabel = getContent(&quot;doclet.Help&quot;);
247         hierarchyForAllPackages = getContent(&quot;doclet.Hierarchy_For_All_Packages&quot;);
248         implementation = getContent(&quot;doclet.Implementation&quot;);
249         implementingClassesLabel = getContent(&quot;doclet.Implementing_Classes&quot;);
250         inClass = getContent(&quot;doclet.in_class&quot;);
251         inInterface = getContent(&quot;doclet.in_interface&quot;);
252         indexLabel = getContent(&quot;doclet.Index&quot;);
253         interfaceLabel = getContent(&quot;doclet.Interface&quot;);
254         interfaces = getContent(&quot;doclet.Interfaces&quot;);
255         methodDetailLabel = getContent(&quot;doclet.Method_Detail&quot;);
256         methodSummary = getContent(&quot;doclet.Method_Summary&quot;);
257         methodLabel = getContent(&quot;doclet.Method&quot;);
258         methods = getContent(&quot;doclet.Methods&quot;);
259         modifierLabel = getContent(&quot;doclet.Modifier&quot;);
260         modifierAndTypeLabel = getContent(&quot;doclet.Modifier_and_Type&quot;);
261         moduleLabel = getContent(&quot;doclet.Module&quot;);
262         module_ = getContent(&quot;doclet.module&quot;);
263         moduleSubNavLabel = getContent(&quot;doclet.Module_Sub_Nav&quot;);
264         modulesLabel = getContent(&quot;doclet.Modules&quot;);
265         navAnnotationTypeMember = getContent(&quot;doclet.navAnnotationTypeMember&quot;);
266         navAnnotationTypeOptionalMember = getContent(&quot;doclet.navAnnotationTypeOptionalMember&quot;);
267         navAnnotationTypeRequiredMember = getContent(&quot;doclet.navAnnotationTypeRequiredMember&quot;);
268         navConstructor = getContent(&quot;doclet.navConstructor&quot;);
269         navEnum = getContent(&quot;doclet.navEnum&quot;);
270         navField = getContent(&quot;doclet.navField&quot;);
271         navMethod = getContent(&quot;doclet.navMethod&quot;);
272         navModuleDescription = getContent(&quot;doclet.navModuleDescription&quot;);
273         navModules = getContent(&quot;doclet.navModules&quot;);
274         navNested = getContent(&quot;doclet.navNested&quot;);
275         navPackages = getContent(&quot;doclet.navPackages&quot;);
276         navProperty = getContent(&quot;doclet.navProperty&quot;);
277         navServices = getContent(&quot;doclet.navServices&quot;);
278         nestedClassSummary = getContent(&quot;doclet.Nested_Class_Summary&quot;);
279         newPage = new Comment(resources.getText(&quot;doclet.New_Page&quot;));
280         noFramesLabel = getNonBreakContent(&quot;doclet.No_Frames&quot;);
281         noScriptMessage = getContent(&quot;doclet.No_Script_Message&quot;);
282         openedTo = getContent(&quot;doclet.OpenedTo&quot;);
283         openModuleLabel = getContent(&quot;doclet.Open_Module&quot;);
284         overridesLabel = getContent(&quot;doclet.Overrides&quot;);
285         overviewLabel = getContent(&quot;doclet.Overview&quot;);
286         packageHierarchies = getContent(&quot;doclet.Package_Hierarchies&quot;);
287         packageLabel = getContent(&quot;doclet.Package&quot;);
288         package_ = getContent(&quot;doclet.package&quot;);
289         packagesLabel = getContent(&quot;doclet.Packages&quot;);
290         parameters = getContent(&quot;doclet.Parameters&quot;);
291         properties = getContent(&quot;doclet.Properties&quot;);
292         propertyLabel = getContent(&quot;doclet.Property&quot;);
293         propertyDetailsLabel = getContent(&quot;doclet.Property_Detail&quot;);
294         propertySummaryLabel = getContent(&quot;doclet.Property_Summary&quot;);
295         record = getContent(&quot;doclet.Record&quot;);
296         recordComponents = getContent(&quot;doclet.RecordComponents&quot;);
297         referencedIn = getContent(&quot;doclet.ReferencedIn&quot;);
298         returns = getContent(&quot;doclet.Returns&quot;);
299         seeAlso = getContent(&quot;doclet.See_Also&quot;);
300         serializedForm = getContent(&quot;doclet.Serialized_Form&quot;);
301         servicesLabel = getContent(&quot;doclet.Services&quot;);
302         specifiedByLabel = getContent(&quot;doclet.Specified_By&quot;);
303         subclassesLabel = getContent(&quot;doclet.Subclasses&quot;);
304         subinterfacesLabel = getContent(&quot;doclet.Subinterfaces&quot;);
305         summaryLabel = getContent(&quot;doclet.Summary&quot;);
306         systemPropertiesLabel = getContent(&quot;doclet.systemProperties&quot;);
307         systemPropertiesSummaryLabel = getContent(&quot;doclet.systemPropertiesSummary&quot;);
308         throws_ = getContent(&quot;doclet.Throws&quot;);
309         treeLabel = getContent(&quot;doclet.Tree&quot;);
310         typeLabel = getContent(&quot;doclet.Type&quot;);
311         typeParameters = getContent(&quot;doclet.TypeParameters&quot;);
312         useLabel = getContent(&quot;doclet.navClassUse&quot;);
313         valueLabel = getContent(&quot;doclet.Value&quot;);
314 
315         navLinkLabels = new EnumMap&lt;&gt;(VisibleMemberTable.Kind.class);
316         navLinkLabels.put(VisibleMemberTable.Kind.INNER_CLASSES, getContent(&quot;doclet.navNested&quot;));
317         navLinkLabels.put(VisibleMemberTable.Kind.ENUM_CONSTANTS, getContent(&quot;doclet.navEnum&quot;));
318         navLinkLabels.put(VisibleMemberTable.Kind.FIELDS, getContent(&quot;doclet.navField&quot;));
319         navLinkLabels.put(VisibleMemberTable.Kind.CONSTRUCTORS, getContent(&quot;doclet.navConstructor&quot;));
320         navLinkLabels.put(VisibleMemberTable.Kind.METHODS, getContent(&quot;doclet.navMethod&quot;));
321     }
322 
323     /**
324      * Gets a {@code Content} object, containing the string for
325      * a given key in the doclet&#39;s resources.
326      *
327      * @param key the key for the desired string
328      * @return a content tree for the string
329      */
330     public Content getContent(String key) {
331         return new FixedStringContent(resources.getText(key));
332     }
333 
334     /**
335      * Gets a {@code Content} object, containing the string for
336      * a given key in the doclet&#39;s resources, formatted with
337      * given arguments.
338      *
339      * @param key the key for the desired string
340      * @param o0  string or content argument to be formatted into the result
341      * @return a content tree for the text
342      */
343     public Content getContent(String key, Object o0) {
344         return getContent(key, o0, null, null);
345     }
346 
347     /**
348      * Gets a {@code Content} object, containing the string for
349      * a given key in the doclet&#39;s resources, formatted with
350      * given arguments.
351 
352      * @param key the key for the desired string
353      * @param o0  string or content argument to be formatted into the result
354      * @param o1  string or content argument to be formatted into the result
355      * @return a content tree for the text
356      */
357     public Content getContent(String key, Object o0, Object o1) {
358         return getContent(key, o0, o1, null);
359     }
360 
361     /**
362      * Gets a {@code Content} object, containing the string for
363      * a given key in the doclet&#39;s resources, formatted with
364      * given arguments.
365      *
366      * @param key the key for the desired string
367      * @param o0  string or content argument to be formatted into the result
368      * @param o1  string or content argument to be formatted into the result
369      * @param o2  string or content argument to be formatted into the result
370      * @return a content tree for the text
371      */
372     public Content getContent(String key, Object o0, Object o1, Object o2) {
373         Content c = new ContentBuilder();
374         Pattern p = Pattern.compile(&quot;\\{([012])\\}&quot;);
375         String text = resources.getText(key); // TODO: cache
376         Matcher m = p.matcher(text);
377         int start = 0;
378         while (m.find(start)) {
379             c.add(text.substring(start, m.start()));
380 
381             Object o = null;
382             switch (m.group(1).charAt(0)) {
383                 case &#39;0&#39;: o = o0; break;
384                 case &#39;1&#39;: o = o1; break;
385                 case &#39;2&#39;: o = o2; break;
386             }
387 
388             if (o == null) {
389                 c.add(&quot;{&quot; + m.group(1) + &quot;}&quot;);
390             } else if (o instanceof String) {
391                 c.add((String) o);
392             } else if (o instanceof Content) {
393                 c.add((Content) o);
394             }
395 
396             start = m.end();
397         }
398 
399         c.add(text.substring(start));
400         return c;
401     }
402 
403     /**
404      * Gets a {@code Content} object, containing the string for
405      * a given key in the doclet&#39;s resources, substituting
406      * &lt;code&gt;&amp;nbsp;&lt;/code&gt; for any space characters found in
407      * the named resource string.
408      *
409      * @param key the key for the desired string
410      * @return a content tree for the string
411      */
412     private Content getNonBreakContent(String key) {
413         String text = resources.getText(key); // TODO: cache
414         Content c = new ContentBuilder();
415         int start = 0;
416         int p;
417         while ((p = text.indexOf(&quot; &quot;, start)) != -1) {
418             c.add(text.substring(start, p));
419             c.add(Entity.NO_BREAK_SPACE);
420             start = p + 1;
421         }
422         c.add(text.substring(start));
423         return c; // TODO: should be made immutable
424     }
425 
426     /**
427      * Returns a content for a visible member kind.
428      * @param kind the visible member table kind.
429      * @return the string content
430      */
431     public Content getNavLinkLabelContent(VisibleMemberTable.Kind kind) {
432         return Objects.requireNonNull(navLinkLabels.get(kind));
433     }
434 }
    </pre>
  </body>
</html>