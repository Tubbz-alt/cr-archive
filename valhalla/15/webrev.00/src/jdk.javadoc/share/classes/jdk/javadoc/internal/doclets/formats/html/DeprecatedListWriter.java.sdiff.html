<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/DeprecatedListWriter.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Contents.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="DocFilesHandlerImpl.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/DeprecatedListWriter.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package jdk.javadoc.internal.doclets.formats.html;
 27 
 28 import jdk.javadoc.internal.doclets.formats.html.markup.Table;
 29 import jdk.javadoc.internal.doclets.formats.html.markup.TableHeader;
 30 
 31 import java.util.EnumMap;
 32 import java.util.List;
 33 import java.util.SortedSet;
 34 
 35 import javax.lang.model.element.Element;
 36 import javax.lang.model.element.ModuleElement;
 37 import javax.lang.model.element.PackageElement;
 38 
 39 import com.sun.source.doctree.DocTree;
 40 import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;
 41 import jdk.javadoc.internal.doclets.formats.html.markup.HtmlStyle;
<span class="line-modified"> 42 import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTag;</span>
 43 import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTree;
<span class="line-modified"> 44 import jdk.javadoc.internal.doclets.formats.html.markup.Navigation;</span>
<span class="line-removed"> 45 import jdk.javadoc.internal.doclets.formats.html.markup.Navigation.PageMode;</span>
 46 import jdk.javadoc.internal.doclets.formats.html.markup.StringContent;
 47 import jdk.javadoc.internal.doclets.toolkit.Content;
 48 import jdk.javadoc.internal.doclets.toolkit.util.DeprecatedAPIListBuilder;
 49 import jdk.javadoc.internal.doclets.toolkit.util.DeprecatedAPIListBuilder.DeprElementKind;
 50 import jdk.javadoc.internal.doclets.toolkit.util.DocFileIOException;
 51 import jdk.javadoc.internal.doclets.toolkit.util.DocPath;
 52 import jdk.javadoc.internal.doclets.toolkit.util.DocPaths;
 53 
 54 /**
 55  * Generate File to list all the deprecated classes and class members with the
 56  * appropriate links.
 57  *
 58  *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
 59  *  If you write code that depends on this, you do so at your own risk.
 60  *  This code and its internal interfaces are subject to change or
 61  *  deletion without notice.&lt;/b&gt;
 62  *
 63  * @see java.util.List
 64  */
 65 public class DeprecatedListWriter extends SubWriterHolderWriter {
</pre>
<hr />
<pre>
266      * @throws DocFileIOException if there is a problem writing the deprecated list
267      */
268     public static void generate(HtmlConfiguration configuration) throws DocFileIOException {
269         DocPath filename = DocPaths.DEPRECATED_LIST;
270         DeprecatedListWriter depr = new DeprecatedListWriter(configuration, filename);
271         depr.generateDeprecatedListFile(
272                new DeprecatedAPIListBuilder(configuration));
273     }
274 
275     /**
276      * Generate the deprecated API list.
277      *
278      * @param deprapi list of deprecated API built already.
279      * @throws DocFileIOException if there is a problem writing the deprecated list
280      */
281     protected void generateDeprecatedListFile(DeprecatedAPIListBuilder deprapi)
282             throws DocFileIOException {
283         HtmlTree body = getHeader();
284         bodyContents.addMainContent(getContentsList(deprapi));
285         String memberTableSummary;
<span class="line-modified">286         HtmlTree div = new HtmlTree(HtmlTag.DIV);</span>
<span class="line-removed">287         div.setStyle(HtmlStyle.contentContainer);</span>
288         for (DeprElementKind kind : DeprElementKind.values()) {
289             if (deprapi.hasDocumentation(kind)) {
290                 memberTableSummary = resources.getText(&quot;doclet.Member_Table_Summary&quot;,
291                         resources.getText(getHeadingKey(kind)),
292                         resources.getText(getSummaryKey(kind)));
293                 TableHeader memberTableHeader = new TableHeader(
294                         contents.getContent(getHeaderKey(kind)), contents.descriptionLabel);
295                 addDeprecatedAPI(deprapi.getSet(kind), getAnchorName(kind),
<span class="line-modified">296                             getHeadingKey(kind), memberTableSummary, memberTableHeader, div);</span>
297             }
298         }
<span class="line-modified">299         bodyContents.addMainContent(div);</span>
300         HtmlTree htmlTree = HtmlTree.FOOTER();
301         navBar.setUserFooter(getUserHeaderFooter(false));
<span class="line-modified">302         htmlTree.add(navBar.getContent(false));</span>
303         addBottom(htmlTree);
304         bodyContents.setFooter(htmlTree);
305         String description = &quot;deprecated elements&quot;;
<span class="line-modified">306         body.add(bodyContents.toContent());</span>
307         printHtmlDocument(null, description, body);
308     }
309 
310     /**
311      * Add the index link.
312      *
313      * @param builder the deprecated list builder
314      * @param kind the kind of list being documented
315      * @param contentTree the content tree to which the index link will be added
316      */
317     private void addIndexLink(DeprecatedAPIListBuilder builder,
318             DeprElementKind kind, Content contentTree) {
319         if (builder.hasDocumentation(kind)) {
320             Content li = HtmlTree.LI(links.createLink(getAnchorName(kind),
321                     contents.getContent(getHeadingKey(kind))));
322             contentTree.add(li);
323         }
324     }
325 
326     /**
327      * Get the contents list.
328      *
329      * @param deprapi the deprecated list builder
330      * @return a content tree for the contents list
331      */
332     public Content getContentsList(DeprecatedAPIListBuilder deprapi) {
333         Content headContent = contents.deprecatedAPI;
<span class="line-modified">334         Content heading = HtmlTree.HEADING(Headings.PAGE_TITLE_HEADING, true,</span>
335                 HtmlStyle.title, headContent);
336         Content div = HtmlTree.DIV(HtmlStyle.header, heading);
337         Content headingContent = contents.contentsHeading;
<span class="line-modified">338         div.add(HtmlTree.HEADING(Headings.CONTENT_HEADING, true,</span>
339                 headingContent));
<span class="line-modified">340         Content ul = new HtmlTree(HtmlTag.UL);</span>
341         for (DeprElementKind kind : DeprElementKind.values()) {
342             addIndexLink(deprapi, kind, ul);
343         }
344         div.add(ul);
345         return div;
346     }
347 
348     /**
349      * Get the header for the deprecated API Listing.
350      *
351      * @return a content tree for the header
352      */
353     public HtmlTree getHeader() {
354         String title = resources.getText(&quot;doclet.Window_Deprecated_List&quot;);
355         HtmlTree bodyTree = getBody(getWindowTitle(title));
356         Content headerContent = new ContentBuilder();
357         addTop(headerContent);
358         navBar.setUserHeader(getUserHeaderFooter(true));
<span class="line-modified">359         headerContent.add(navBar.getContent(true));</span>
360         bodyContents.setHeader(headerContent);
361         return bodyTree;
362     }
363 
364     /**
365      * Add deprecated information to the documentation tree
366      *
367      * @param deprList list of deprecated API elements
368      * @param id the id attribute of the table
369      * @param headingKey the caption for the deprecated table
370      * @param tableSummary the summary for the deprecated table
371      * @param tableHeader table headers for the deprecated table
372      * @param contentTree the content tree to which the deprecated table will be added
373      */
374     protected void addDeprecatedAPI(SortedSet&lt;Element&gt; deprList, String id, String headingKey,
375             String tableSummary, TableHeader tableHeader, Content contentTree) {
376         if (deprList.size() &gt; 0) {
377             Content caption = contents.getContent(headingKey);
378             Table table = new Table(HtmlStyle.deprecatedSummary)
379                     .setCaption(caption)
</pre>
<hr />
<pre>
386                     case MODULE:
387                         ModuleElement m = (ModuleElement) e;
388                         link = getModuleLink(m, new StringContent(m.getQualifiedName()));
389                         break;
390                     case PACKAGE:
391                         PackageElement pkg = (PackageElement) e;
392                         link = getPackageLink(pkg, getPackageName(pkg));
393                         break;
394                     default:
395                         link = getDeprecatedLink(e);
396                 }
397                 Content desc = new ContentBuilder();
398                 List&lt;? extends DocTree&gt; tags = utils.getDeprecatedTrees(e);
399                 if (!tags.isEmpty()) {
400                     addInlineDeprecatedComment(e, tags.get(0), desc);
401                 } else {
402                     desc.add(HtmlTree.EMPTY);
403                 }
404                 table.addRow(link, desc);
405             }
<span class="line-modified">406             Content li = HtmlTree.LI(HtmlStyle.blockList, table.toContent());</span>
407             Content ul = HtmlTree.UL(HtmlStyle.blockList, li);
408             contentTree.add(ul);
409         }
410     }
411 
412     protected Content getDeprecatedLink(Element e) {
413         AbstractMemberWriter writer;
414         switch (e.getKind()) {
415             case INTERFACE:
416             case CLASS:
417             case ENUM:
418             case ANNOTATION_TYPE:
419                 writer = new NestedClassWriterImpl(this);
420                 break;
421             case FIELD:
422                 writer = new FieldWriterImpl(this);
423                 break;
424             case METHOD:
425                 writer = new MethodWriterImpl(this);
426                 break;
</pre>
</td>
<td>
<hr />
<pre>
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package jdk.javadoc.internal.doclets.formats.html;
 27 
 28 import jdk.javadoc.internal.doclets.formats.html.markup.Table;
 29 import jdk.javadoc.internal.doclets.formats.html.markup.TableHeader;
 30 
 31 import java.util.EnumMap;
 32 import java.util.List;
 33 import java.util.SortedSet;
 34 
 35 import javax.lang.model.element.Element;
 36 import javax.lang.model.element.ModuleElement;
 37 import javax.lang.model.element.PackageElement;
 38 
 39 import com.sun.source.doctree.DocTree;
 40 import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;
 41 import jdk.javadoc.internal.doclets.formats.html.markup.HtmlStyle;
<span class="line-modified"> 42 import jdk.javadoc.internal.doclets.formats.html.markup.TagName;</span>
 43 import jdk.javadoc.internal.doclets.formats.html.markup.HtmlTree;
<span class="line-modified"> 44 import jdk.javadoc.internal.doclets.formats.html.Navigation.PageMode;</span>

 45 import jdk.javadoc.internal.doclets.formats.html.markup.StringContent;
 46 import jdk.javadoc.internal.doclets.toolkit.Content;
 47 import jdk.javadoc.internal.doclets.toolkit.util.DeprecatedAPIListBuilder;
 48 import jdk.javadoc.internal.doclets.toolkit.util.DeprecatedAPIListBuilder.DeprElementKind;
 49 import jdk.javadoc.internal.doclets.toolkit.util.DocFileIOException;
 50 import jdk.javadoc.internal.doclets.toolkit.util.DocPath;
 51 import jdk.javadoc.internal.doclets.toolkit.util.DocPaths;
 52 
 53 /**
 54  * Generate File to list all the deprecated classes and class members with the
 55  * appropriate links.
 56  *
 57  *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
 58  *  If you write code that depends on this, you do so at your own risk.
 59  *  This code and its internal interfaces are subject to change or
 60  *  deletion without notice.&lt;/b&gt;
 61  *
 62  * @see java.util.List
 63  */
 64 public class DeprecatedListWriter extends SubWriterHolderWriter {
</pre>
<hr />
<pre>
265      * @throws DocFileIOException if there is a problem writing the deprecated list
266      */
267     public static void generate(HtmlConfiguration configuration) throws DocFileIOException {
268         DocPath filename = DocPaths.DEPRECATED_LIST;
269         DeprecatedListWriter depr = new DeprecatedListWriter(configuration, filename);
270         depr.generateDeprecatedListFile(
271                new DeprecatedAPIListBuilder(configuration));
272     }
273 
274     /**
275      * Generate the deprecated API list.
276      *
277      * @param deprapi list of deprecated API built already.
278      * @throws DocFileIOException if there is a problem writing the deprecated list
279      */
280     protected void generateDeprecatedListFile(DeprecatedAPIListBuilder deprapi)
281             throws DocFileIOException {
282         HtmlTree body = getHeader();
283         bodyContents.addMainContent(getContentsList(deprapi));
284         String memberTableSummary;
<span class="line-modified">285         Content content = new ContentBuilder();</span>

286         for (DeprElementKind kind : DeprElementKind.values()) {
287             if (deprapi.hasDocumentation(kind)) {
288                 memberTableSummary = resources.getText(&quot;doclet.Member_Table_Summary&quot;,
289                         resources.getText(getHeadingKey(kind)),
290                         resources.getText(getSummaryKey(kind)));
291                 TableHeader memberTableHeader = new TableHeader(
292                         contents.getContent(getHeaderKey(kind)), contents.descriptionLabel);
293                 addDeprecatedAPI(deprapi.getSet(kind), getAnchorName(kind),
<span class="line-modified">294                             getHeadingKey(kind), memberTableSummary, memberTableHeader, content);</span>
295             }
296         }
<span class="line-modified">297         bodyContents.addMainContent(content);</span>
298         HtmlTree htmlTree = HtmlTree.FOOTER();
299         navBar.setUserFooter(getUserHeaderFooter(false));
<span class="line-modified">300         htmlTree.add(navBar.getContent(Navigation.Position.BOTTOM));</span>
301         addBottom(htmlTree);
302         bodyContents.setFooter(htmlTree);
303         String description = &quot;deprecated elements&quot;;
<span class="line-modified">304         body.add(bodyContents);</span>
305         printHtmlDocument(null, description, body);
306     }
307 
308     /**
309      * Add the index link.
310      *
311      * @param builder the deprecated list builder
312      * @param kind the kind of list being documented
313      * @param contentTree the content tree to which the index link will be added
314      */
315     private void addIndexLink(DeprecatedAPIListBuilder builder,
316             DeprElementKind kind, Content contentTree) {
317         if (builder.hasDocumentation(kind)) {
318             Content li = HtmlTree.LI(links.createLink(getAnchorName(kind),
319                     contents.getContent(getHeadingKey(kind))));
320             contentTree.add(li);
321         }
322     }
323 
324     /**
325      * Get the contents list.
326      *
327      * @param deprapi the deprecated list builder
328      * @return a content tree for the contents list
329      */
330     public Content getContentsList(DeprecatedAPIListBuilder deprapi) {
331         Content headContent = contents.deprecatedAPI;
<span class="line-modified">332         Content heading = HtmlTree.HEADING_TITLE(Headings.PAGE_TITLE_HEADING,</span>
333                 HtmlStyle.title, headContent);
334         Content div = HtmlTree.DIV(HtmlStyle.header, heading);
335         Content headingContent = contents.contentsHeading;
<span class="line-modified">336         div.add(HtmlTree.HEADING_TITLE(Headings.CONTENT_HEADING,</span>
337                 headingContent));
<span class="line-modified">338         Content ul = new HtmlTree(TagName.UL);</span>
339         for (DeprElementKind kind : DeprElementKind.values()) {
340             addIndexLink(deprapi, kind, ul);
341         }
342         div.add(ul);
343         return div;
344     }
345 
346     /**
347      * Get the header for the deprecated API Listing.
348      *
349      * @return a content tree for the header
350      */
351     public HtmlTree getHeader() {
352         String title = resources.getText(&quot;doclet.Window_Deprecated_List&quot;);
353         HtmlTree bodyTree = getBody(getWindowTitle(title));
354         Content headerContent = new ContentBuilder();
355         addTop(headerContent);
356         navBar.setUserHeader(getUserHeaderFooter(true));
<span class="line-modified">357         headerContent.add(navBar.getContent(Navigation.Position.TOP));</span>
358         bodyContents.setHeader(headerContent);
359         return bodyTree;
360     }
361 
362     /**
363      * Add deprecated information to the documentation tree
364      *
365      * @param deprList list of deprecated API elements
366      * @param id the id attribute of the table
367      * @param headingKey the caption for the deprecated table
368      * @param tableSummary the summary for the deprecated table
369      * @param tableHeader table headers for the deprecated table
370      * @param contentTree the content tree to which the deprecated table will be added
371      */
372     protected void addDeprecatedAPI(SortedSet&lt;Element&gt; deprList, String id, String headingKey,
373             String tableSummary, TableHeader tableHeader, Content contentTree) {
374         if (deprList.size() &gt; 0) {
375             Content caption = contents.getContent(headingKey);
376             Table table = new Table(HtmlStyle.deprecatedSummary)
377                     .setCaption(caption)
</pre>
<hr />
<pre>
384                     case MODULE:
385                         ModuleElement m = (ModuleElement) e;
386                         link = getModuleLink(m, new StringContent(m.getQualifiedName()));
387                         break;
388                     case PACKAGE:
389                         PackageElement pkg = (PackageElement) e;
390                         link = getPackageLink(pkg, getPackageName(pkg));
391                         break;
392                     default:
393                         link = getDeprecatedLink(e);
394                 }
395                 Content desc = new ContentBuilder();
396                 List&lt;? extends DocTree&gt; tags = utils.getDeprecatedTrees(e);
397                 if (!tags.isEmpty()) {
398                     addInlineDeprecatedComment(e, tags.get(0), desc);
399                 } else {
400                     desc.add(HtmlTree.EMPTY);
401                 }
402                 table.addRow(link, desc);
403             }
<span class="line-modified">404             Content li = HtmlTree.LI(HtmlStyle.blockList, table);</span>
405             Content ul = HtmlTree.UL(HtmlStyle.blockList, li);
406             contentTree.add(ul);
407         }
408     }
409 
410     protected Content getDeprecatedLink(Element e) {
411         AbstractMemberWriter writer;
412         switch (e.getKind()) {
413             case INTERFACE:
414             case CLASS:
415             case ENUM:
416             case ANNOTATION_TYPE:
417                 writer = new NestedClassWriterImpl(this);
418                 break;
419             case FIELD:
420                 writer = new FieldWriterImpl(this);
421                 break;
422             case METHOD:
423                 writer = new MethodWriterImpl(this);
424                 break;
</pre>
</td>
</tr>
</table>
<center><a href="Contents.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="DocFilesHandlerImpl.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>