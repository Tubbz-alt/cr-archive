<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/markup/HtmlTree.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="HtmlStyle.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="RawHtml.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/markup/HtmlTree.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
  25 
  26 package jdk.javadoc.internal.doclets.formats.html.markup;
  27 
  28 import java.io.IOException;
  29 import java.io.Writer;
<span class="line-modified">  30 import java.nio.charset.Charset;</span>
  31 import java.util.ArrayList;
  32 import java.util.BitSet;
<span class="line-removed">  33 import java.util.Collections;</span>
  34 import java.util.Iterator;
  35 import java.util.LinkedHashMap;
  36 import java.util.List;
  37 import java.util.Map;

  38 
  39 import jdk.javadoc.internal.doclets.formats.html.markup.HtmlAttr.Role;
  40 import jdk.javadoc.internal.doclets.toolkit.Content;
  41 import jdk.javadoc.internal.doclets.toolkit.util.DocletConstants;
  42 
  43 /**
<span class="line-modified">  44  * Class for generating HTML tree for javadoc output.</span>













  45  *
  46  *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
  47  *  If you write code that depends on this, you do so at your own risk.
  48  *  This code and its internal interfaces are subject to change or
  49  *  deletion without notice.&lt;/b&gt;



  50  */
  51 public class HtmlTree extends Content {
  52 
<span class="line-modified">  53     public final HtmlTag htmlTag;</span>
<span class="line-modified">  54     private Map&lt;HtmlAttr,String&gt; attrs = Collections.emptyMap();</span>
<span class="line-modified">  55     private List&lt;Content&gt; content = Collections.emptyList();</span>
<span class="line-modified">  56     public static final Content EMPTY = new StringContent(&quot;&quot;);</span>

  57 
  58     /**
<span class="line-modified">  59      * Constructor to construct HtmlTree object.</span>
<span class="line-modified">  60      *</span>
<span class="line-removed">  61      * @param tag HTML tag for the HtmlTree object</span>
  62      */
<span class="line-modified">  63     public HtmlTree(HtmlTag tag) {</span>
<span class="line-removed">  64         htmlTag = nullCheck(tag);</span>
<span class="line-removed">  65     }</span>
  66 
  67     /**
<span class="line-modified">  68      * Constructor to construct HtmlTree object.</span>
<span class="line-modified">  69      *</span>
<span class="line-removed">  70      * @param tag HTML tag for the HtmlTree object</span>
<span class="line-removed">  71      * @param contents contents to be added to the tree</span>
  72      */
<span class="line-modified">  73     public HtmlTree(HtmlTag tag, Content... contents) {</span>
<span class="line-removed">  74         this(tag);</span>
<span class="line-removed">  75         for (Content c: contents)</span>
<span class="line-removed">  76             add(c);</span>
<span class="line-removed">  77     }</span>
  78 
  79     /**
<span class="line-modified">  80      * Constructor to construct HtmlTree object.</span>






  81      *
<span class="line-modified">  82      * @param tag HTML tag for the HtmlTree object</span>
<span class="line-removed">  83      * @param contents contents to be added to the tree</span>
  84      */
<span class="line-modified">  85     public HtmlTree(HtmlTag tag, List&lt;Content&gt; contents) {</span>
<span class="line-modified">  86         this(tag);</span>
<span class="line-removed">  87         for (Content c: contents)</span>
<span class="line-removed">  88             add(c);</span>
  89     }
  90 
  91     /**
<span class="line-modified">  92      * Adds an attribute for the HTML tag.</span>
  93      *
<span class="line-modified">  94      * @param attrName name of the attribute</span>
<span class="line-modified">  95      * @param attrValue value of the attribute</span>
  96      * @return this object
  97      */
  98     public HtmlTree put(HtmlAttr attrName, String attrValue) {
  99         if (attrs.isEmpty())
 100             attrs = new LinkedHashMap&lt;&gt;(3);
<span class="line-modified"> 101         attrs.put(nullCheck(attrName), Entity.escapeHtmlChars(attrValue));</span>
 102         return this;
 103     }
 104 
 105     /**
<span class="line-modified"> 106      * Sets the &quot;id&quot; attribute for this tag.</span>
 107      *
<span class="line-modified"> 108      * @param id the value for the id attribute</span>
 109      * @return this object
 110      */
 111     public HtmlTree setId(String id) {
<span class="line-modified"> 112         put(HtmlAttr.ID, id);</span>
<span class="line-removed"> 113         return this;</span>
 114     }
 115 
 116     /**
<span class="line-modified"> 117      * Sets the &quot;title&quot; attribute for this tag.</span>
<span class="line-modified"> 118      * Any HTML tags in the content will be removed.</span>
 119      *
 120      * @param body the content for the title attribute
 121      * @return this object
 122      */
 123     public HtmlTree setTitle(Content body) {
<span class="line-modified"> 124         put(HtmlAttr.TITLE, stripHtml(body));</span>
<span class="line-removed"> 125         return this;</span>
 126     }
 127 
 128     /**
<span class="line-modified"> 129      * Sets the &quot;role&quot; attribute for this tag.</span>
 130      *
 131      * @param role the role
 132      * @return this object
 133      */
 134     public HtmlTree setRole(Role role) {
<span class="line-modified"> 135         put(HtmlAttr.ROLE, role.toString());</span>
<span class="line-removed"> 136         return this;</span>
 137     }
 138 
 139     /**
<span class="line-modified"> 140      * Sets the style for the HTML tag.</span>
 141      *
<span class="line-modified"> 142      * @param style style to be added</span>
 143      * @return this object
 144      */
 145     public HtmlTree setStyle(HtmlStyle style) {
<span class="line-modified"> 146         put(HtmlAttr.CLASS, style.toString());</span>
<span class="line-removed"> 147         return this;</span>
 148     }
 149 
 150     /**
<span class="line-modified"> 151      * Adds content for the HTML tag.</span>
 152      *
<span class="line-modified"> 153      * @param tagContent tag content to be added</span>
 154      */
 155     @Override
<span class="line-modified"> 156     public void add(Content tagContent) {</span>
<span class="line-modified"> 157         if (tagContent instanceof ContentBuilder) {</span>
<span class="line-modified"> 158             for (Content c: ((ContentBuilder)tagContent).contents) {</span>
<span class="line-removed"> 159                 add(c);</span>
<span class="line-removed"> 160             }</span>
 161         }
<span class="line-modified"> 162         else if (tagContent == HtmlTree.EMPTY || tagContent.isValid()) {</span>
<span class="line-modified"> 163             if (content.isEmpty())</span>
<span class="line-modified"> 164                 content = new ArrayList&lt;&gt;();</span>
<span class="line-modified"> 165             content.add(tagContent);</span>

 166         }

 167     }
 168 
 169     /**
<span class="line-modified"> 170      * Adds String content to the HTML tree. If the last content member</span>
<span class="line-modified"> 171      * added is a StringContent, append the string to that StringContent or else</span>
<span class="line-modified"> 172      * create a new StringContent and add it to the HTML tree.</span>


 173      *
 174      * @param stringContent string content that needs to be added
 175      */
 176     @Override
<span class="line-modified"> 177     public void add(CharSequence stringContent) {</span>
 178         if (!content.isEmpty()) {
 179             Content lastContent = content.get(content.size() - 1);
 180             if (lastContent instanceof StringContent)
 181                 lastContent.add(stringContent);
<span class="line-modified"> 182             else</span>
 183                 add(new StringContent(stringContent));

 184         }
<span class="line-modified"> 185         else</span>
 186             add(new StringContent(stringContent));













 187     }
 188 
 189     @Override
 190     public int charCount() {
 191         int n = 0;
<span class="line-modified"> 192         for (Content c : content)</span>
 193             n += c.charCount();

 194         return n;
 195     }
 196 
 197     /*
 198      * The sets of ASCII URI characters to be left unencoded.
 199      * See &quot;Uniform Resource Identifier (URI): Generic Syntax&quot;
 200      * IETF RFC 3986. https://tools.ietf.org/html/rfc3986
 201      */
 202     public static final BitSet MAIN_CHARS;
 203     public static final BitSet QUERY_FRAGMENT_CHARS;
 204 
 205     static {
 206         BitSet alphaDigit = bitSet(bitSet(&#39;A&#39;, &#39;Z&#39;), bitSet(&#39;a&#39;, &#39;z&#39;), bitSet(&#39;0&#39;, &#39;9&#39;));
 207         BitSet unreserved = bitSet(alphaDigit, bitSet(&quot;-._~&quot;));
 208         BitSet genDelims = bitSet(&quot;:/?#[]@&quot;);
 209         BitSet subDelims = bitSet(&quot;!$&amp;&#39;()*+,;=&quot;);
 210         MAIN_CHARS = bitSet(unreserved, genDelims, subDelims);
 211         BitSet pchar = bitSet(unreserved, subDelims, bitSet(&quot;:@&quot;));
 212         QUERY_FRAGMENT_CHARS = bitSet(pchar, bitSet(&quot;/?&quot;));
 213     }
</pre>
<hr />
<pre>
 230         BitSet result = new BitSet();
 231         for (BitSet set : sets) {
 232             result.or(set);
 233         }
 234         return result;
 235     }
 236 
 237     /**
 238      * Apply percent-encoding to a URL.
 239      * This is similar to {@link java.net.URLEncoder} but
 240      * is less aggressive about encoding some characters,
 241      * like &#39;(&#39;, &#39;)&#39;, &#39;,&#39; which are used in the anchor
 242      * names for Java methods in HTML5 mode.
 243      *
 244      * @param url the url to be percent-encoded.
 245      * @return a percent-encoded string.
 246      */
 247     public static String encodeURL(String url) {
 248         BitSet nonEncodingChars = MAIN_CHARS;
 249         StringBuilder sb = new StringBuilder();
<span class="line-modified"> 250         for (byte c : url.getBytes(Charset.forName(&quot;UTF-8&quot;))) {</span>
 251             if (c == &#39;?&#39; || c == &#39;#&#39;) {
 252                 sb.append((char) c);
 253                 // switch to the more restrictive set inside
 254                 // the query and/or fragment
 255                 nonEncodingChars = QUERY_FRAGMENT_CHARS;
 256             } else if (nonEncodingChars.get(c &amp; 0xFF)) {
 257                 sb.append((char) c);
 258             } else {
 259                 sb.append(String.format(&quot;%%%02X&quot;, c &amp; 0xFF));
 260             }
 261         }
 262         return sb.toString();
 263     }
 264 
 265     /**
<span class="line-modified"> 266      * Generates an HTML anchor tag.</span>
 267      *
<span class="line-modified"> 268      * @param ref reference url for the anchor tag</span>
<span class="line-modified"> 269      * @param body content for the anchor tag</span>
<span class="line-modified"> 270      * @return an HtmlTree object</span>
 271      */
 272     public static HtmlTree A(String ref, Content body) {
<span class="line-modified"> 273         HtmlTree htmltree = new HtmlTree(HtmlTag.A, nullCheck(body));</span>
<span class="line-modified"> 274         htmltree.put(HtmlAttr.HREF, encodeURL(ref));</span>
<span class="line-modified"> 275         return htmltree;</span>
 276     }
 277 
 278     /**
<span class="line-modified"> 279      * Generates a CAPTION tag with some content.</span>
 280      *
<span class="line-modified"> 281      * @param body content for the tag</span>
<span class="line-modified"> 282      * @return an HtmlTree object for the CAPTION tag</span>
 283      */
 284     public static HtmlTree CAPTION(Content body) {
<span class="line-modified"> 285         HtmlTree htmltree = new HtmlTree(HtmlTag.CAPTION, nullCheck(body));</span>
<span class="line-modified"> 286         return htmltree;</span>
 287     }
 288 
 289     /**
<span class="line-modified"> 290      * Generates a CODE tag with some content.</span>
 291      *
<span class="line-modified"> 292      * @param body content for the tag</span>
<span class="line-modified"> 293      * @return an HtmlTree object for the CODE tag</span>
 294      */
 295     public static HtmlTree CODE(Content body) {
<span class="line-modified"> 296         HtmlTree htmltree = new HtmlTree(HtmlTag.CODE, nullCheck(body));</span>
<span class="line-modified"> 297         return htmltree;</span>
 298     }
 299 
 300     /**
<span class="line-modified"> 301      * Generates a DD tag with some content.</span>
 302      *
<span class="line-modified"> 303      * @param body content for the tag</span>
<span class="line-modified"> 304      * @return an HtmlTree object for the DD tag</span>
 305      */
 306     public static HtmlTree DD(Content body) {
<span class="line-modified"> 307         HtmlTree htmltree = new HtmlTree(HtmlTag.DD, nullCheck(body));</span>
<span class="line-modified"> 308         return htmltree;</span>
 309     }
 310 
 311     /**
<span class="line-modified"> 312      * Generates a DL tag with some content.</span>
 313      *
<span class="line-modified"> 314      * @param body content for the tag</span>
<span class="line-modified"> 315      * @return an HtmlTree object for the DL tag</span>
 316      */
<span class="line-modified"> 317     public static HtmlTree DL(Content body) {</span>
<span class="line-modified"> 318         HtmlTree htmltree = new HtmlTree(HtmlTag.DL, nullCheck(body));</span>
<span class="line-modified"> 319         return htmltree;</span>
 320     }
 321 
 322     /**
<span class="line-modified"> 323      * Generates a DIV tag with the style class attributes. It also encloses</span>
<span class="line-removed"> 324      * a content.</span>
 325      *
<span class="line-modified"> 326      * @param styleClass stylesheet class for the tag</span>
<span class="line-modified"> 327      * @param body content for the tag</span>
<span class="line-modified"> 328      * @return an HtmlTree object for the DIV tag</span>
 329      */
<span class="line-modified"> 330     public static HtmlTree DIV(HtmlStyle styleClass, Content body) {</span>
<span class="line-modified"> 331         HtmlTree htmltree = new HtmlTree(HtmlTag.DIV, nullCheck(body));</span>
<span class="line-modified"> 332         if (styleClass != null)</span>
<span class="line-modified"> 333             htmltree.setStyle(styleClass);</span>
<span class="line-removed"> 334         return htmltree;</span>
 335     }
 336 
 337     /**
<span class="line-modified"> 338      * Generates a DIV tag with some content.</span>
 339      *
<span class="line-modified"> 340      * @param body content for the tag</span>
<span class="line-modified"> 341      * @return an HtmlTree object for the DIV tag</span>
























 342      */
 343     public static HtmlTree DIV(Content body) {
<span class="line-modified"> 344         return DIV(null, body);</span>

 345     }
 346 
 347     /**
<span class="line-modified"> 348      * Generates a DT tag with some content.</span>
 349      *
<span class="line-modified"> 350      * @param body content for the tag</span>
<span class="line-modified"> 351      * @return an HtmlTree object for the DT tag</span>
 352      */
 353     public static HtmlTree DT(Content body) {
<span class="line-modified"> 354         HtmlTree htmltree = new HtmlTree(HtmlTag.DT, nullCheck(body));</span>
<span class="line-modified"> 355         return htmltree;</span>
 356     }
 357 
 358     /**
<span class="line-modified"> 359      * Generates a FOOTER tag with role attribute.</span>

 360      *
<span class="line-modified"> 361      * @return an HtmlTree object for the FOOTER tag</span>
 362      */
 363     public static HtmlTree FOOTER() {
<span class="line-modified"> 364         HtmlTree htmltree = new HtmlTree(HtmlTag.FOOTER);</span>
<span class="line-modified"> 365         htmltree.setRole(Role.CONTENTINFO);</span>
<span class="line-removed"> 366         return htmltree;</span>
 367     }
 368 
 369     /**
<span class="line-modified"> 370      * Generates a HEADER tag with role attribute.</span>

 371      *
<span class="line-modified"> 372      * @return an HtmlTree object for the HEADER tag</span>
 373      */
 374     public static HtmlTree HEADER() {
<span class="line-modified"> 375         HtmlTree htmltree = new HtmlTree(HtmlTag.HEADER);</span>
<span class="line-modified"> 376         htmltree.setRole(Role.BANNER);</span>
<span class="line-removed"> 377         return htmltree;</span>
 378     }
 379 
 380     /**
<span class="line-modified"> 381      * Generates a heading tag (h1 to h6) with the title and style class attributes. It also encloses</span>
<span class="line-removed"> 382      * a content.</span>
 383      *
<span class="line-modified"> 384      * @param headingTag the heading tag to be generated</span>
<span class="line-modified"> 385      * @param printTitle true if title for the tag needs to be printed else false</span>
<span class="line-modified"> 386      * @param styleClass stylesheet class for the tag</span>
<span class="line-removed"> 387      * @param body content for the tag</span>
<span class="line-removed"> 388      * @return an HtmlTree object for the tag</span>
 389      */
<span class="line-modified"> 390     public static HtmlTree HEADING(HtmlTag headingTag, boolean printTitle,</span>
<span class="line-modified"> 391             HtmlStyle styleClass, Content body) {</span>
<span class="line-modified"> 392         HtmlTree htmltree = new HtmlTree(headingTag, nullCheck(body));</span>
<span class="line-removed"> 393         if (printTitle)</span>
<span class="line-removed"> 394             htmltree.setTitle(body);</span>
<span class="line-removed"> 395         if (styleClass != null)</span>
<span class="line-removed"> 396             htmltree.setStyle(styleClass);</span>
<span class="line-removed"> 397         return htmltree;</span>
 398     }
 399 
 400     /**
<span class="line-modified"> 401      * Generates a heading tag (h1 to h6) with style class attribute. It also encloses</span>
<span class="line-removed"> 402      * a content.</span>
 403      *
<span class="line-modified"> 404      * @param headingTag the heading tag to be generated</span>
<span class="line-modified"> 405      * @param styleClass stylesheet class for the tag</span>
<span class="line-modified"> 406      * @param body content for the tag</span>
<span class="line-modified"> 407      * @return an HtmlTree object for the tag</span>
 408      */
<span class="line-modified"> 409     public static HtmlTree HEADING(HtmlTag headingTag, HtmlStyle styleClass, Content body) {</span>
<span class="line-modified"> 410         return HEADING(headingTag, false, styleClass, body);</span>


 411     }
 412 
 413     /**
<span class="line-modified"> 414      * Generates a heading tag (h1 to h6) with the title attribute. It also encloses</span>
<span class="line-modified"> 415      * a content.</span>
 416      *
<span class="line-modified"> 417      * @param headingTag the heading tag to be generated</span>
<span class="line-modified"> 418      * @param printTitle true if the title for the tag needs to be printed else false</span>
<span class="line-modified"> 419      * @param body content for the tag</span>
<span class="line-modified"> 420      * @return an HtmlTree object for the tag</span>
 421      */
<span class="line-modified"> 422     public static HtmlTree HEADING(HtmlTag headingTag, boolean printTitle, Content body) {</span>
<span class="line-modified"> 423         return HEADING(headingTag, printTitle, null, body);</span>




 424     }
 425 
 426     /**
<span class="line-modified"> 427      * Generates a heading tag (h1 to h6)  with some content.</span>

 428      *
<span class="line-modified"> 429      * @param headingTag the heading tag to be generated</span>
<span class="line-modified"> 430      * @param body content for the tag</span>
<span class="line-modified"> 431      * @return an HtmlTree object for the tag</span>
 432      */
<span class="line-modified"> 433     public static HtmlTree HEADING(HtmlTag headingTag, Content body) {</span>
<span class="line-modified"> 434         return HEADING(headingTag, false, null, body);</span>


 435     }
 436 
<span class="line-modified"> 437     /**</span>
<span class="line-modified"> 438      * Generates an HTML tag with lang attribute. It also adds head and body</span>
<span class="line-modified"> 439      * content to the HTML tree.</span>
<span class="line-modified"> 440      *</span>
<span class="line-modified"> 441      * @param lang language for the HTML document</span>
<span class="line-modified"> 442      * @param head head for the HTML tag</span>
<span class="line-modified"> 443      * @param body body for the HTML tag</span>
<span class="line-removed"> 444      * @return an HtmlTree object for the HTML tag</span>
<span class="line-removed"> 445      */</span>
<span class="line-removed"> 446     public static HtmlTree HTML(String lang, Content head, Content body) {</span>
<span class="line-removed"> 447         HtmlTree htmltree = new HtmlTree(HtmlTag.HTML, nullCheck(head), nullCheck(body));</span>
<span class="line-removed"> 448         htmltree.put(HtmlAttr.LANG, nullCheck(lang));</span>
<span class="line-removed"> 449         return htmltree;</span>
 450     }
 451 
 452     /**
<span class="line-modified"> 453      * Generates a IFRAME tag.</span>

 454      *
<span class="line-modified"> 455      * @param src the url of the document to be shown in the frame</span>
<span class="line-modified"> 456      * @param name specifies the name of the frame</span>
<span class="line-modified"> 457      * @param title the title for the frame</span>
<span class="line-modified"> 458      * @return an HtmlTree object for the IFRAME tag</span>
 459      */
<span class="line-modified"> 460     public static HtmlTree IFRAME(String src, String name, String title) {</span>
<span class="line-modified"> 461         HtmlTree htmltree = new HtmlTree(HtmlTag.IFRAME);</span>
<span class="line-modified"> 462         htmltree.put(HtmlAttr.SRC, nullCheck(src));</span>
<span class="line-modified"> 463         htmltree.put(HtmlAttr.NAME, nullCheck(name));</span>
<span class="line-modified"> 464         htmltree.put(HtmlAttr.TITLE, nullCheck(title));</span>
<span class="line-removed"> 465         return htmltree;</span>
 466     }
 467 
 468     /**
<span class="line-modified"> 469      * Generates a INPUT tag with some id.</span>

 470      *
<span class="line-modified"> 471      * @param type the type of input</span>
<span class="line-modified"> 472      * @param id id for the tag</span>
<span class="line-modified"> 473      * @param value value for the tag</span>
<span class="line-modified"> 474      * @return an HtmlTree object for the INPUT tag</span>
 475      */
 476     public static HtmlTree INPUT(String type, String id, String value) {
<span class="line-modified"> 477         HtmlTree htmltree = new HtmlTree(HtmlTag.INPUT);</span>
<span class="line-modified"> 478         htmltree.put(HtmlAttr.TYPE, nullCheck(type));</span>
<span class="line-modified"> 479         htmltree.put(HtmlAttr.ID, nullCheck(id));</span>
<span class="line-modified"> 480         htmltree.put(HtmlAttr.VALUE, nullCheck(value));</span>
<span class="line-modified"> 481         htmltree.put(HtmlAttr.DISABLED, &quot;disabled&quot;);</span>
<span class="line-removed"> 482         return htmltree;</span>
 483     }
 484 
 485     /**
<span class="line-modified"> 486      * Generates a LABEL tag with some content.</span>
 487      *
<span class="line-modified"> 488      * @param forLabel value of &quot;for&quot; attribute of the LABEL tag</span>
<span class="line-modified"> 489      * @param body content for the tag</span>
<span class="line-modified"> 490      * @return an HtmlTree object for the LABEL tag</span>
 491      */
 492     public static HtmlTree LABEL(String forLabel, Content body) {
<span class="line-modified"> 493         HtmlTree htmltree = new HtmlTree(HtmlTag.LABEL, nullCheck(body));</span>
<span class="line-modified"> 494         htmltree.put(HtmlAttr.FOR, nullCheck(forLabel));</span>
<span class="line-modified"> 495         return htmltree;</span>
 496     }
 497 
 498     /**
<span class="line-modified"> 499      * Generates a LI tag with some content.</span>
 500      *
<span class="line-modified"> 501      * @param body content for the tag</span>
<span class="line-modified"> 502      * @return an HtmlTree object for the LI tag</span>
 503      */
 504     public static HtmlTree LI(Content body) {
<span class="line-modified"> 505         return LI(null, body);</span>

 506     }
 507 
 508     /**
<span class="line-modified"> 509      * Generates a LI tag with some content.</span>
 510      *
<span class="line-modified"> 511      * @param styleClass style for the tag</span>
<span class="line-modified"> 512      * @param body content for the tag</span>
<span class="line-modified"> 513      * @return an HtmlTree object for the LI tag</span>
 514      */
<span class="line-modified"> 515     public static HtmlTree LI(HtmlStyle styleClass, Content body) {</span>
<span class="line-modified"> 516         HtmlTree htmltree = new HtmlTree(HtmlTag.LI, nullCheck(body));</span>
<span class="line-modified"> 517         if (styleClass != null)</span>
<span class="line-removed"> 518             htmltree.setStyle(styleClass);</span>
<span class="line-removed"> 519         return htmltree;</span>
 520     }
 521 
 522     /**
<span class="line-modified"> 523      * Generates a LINK tag with the rel, type, href and title attributes.</span>
 524      *
<span class="line-modified"> 525      * @param rel relevance of the link</span>
<span class="line-modified"> 526      * @param type type of link</span>
<span class="line-modified"> 527      * @param href the path for the link</span>
<span class="line-modified"> 528      * @param title title for the link</span>
<span class="line-modified"> 529      * @return an HtmlTree object for the LINK tag</span>
 530      */
 531     public static HtmlTree LINK(String rel, String type, String href, String title) {
<span class="line-modified"> 532         HtmlTree htmltree = new HtmlTree(HtmlTag.LINK);</span>
<span class="line-modified"> 533         htmltree.put(HtmlAttr.REL, nullCheck(rel));</span>
<span class="line-modified"> 534         htmltree.put(HtmlAttr.TYPE, nullCheck(type));</span>
<span class="line-modified"> 535         htmltree.put(HtmlAttr.HREF, nullCheck(href));</span>
<span class="line-modified"> 536         htmltree.put(HtmlAttr.TITLE, nullCheck(title));</span>
<span class="line-removed"> 537         return htmltree;</span>
 538     }
 539 
 540     /**
<span class="line-modified"> 541      * Generates a MAIN tag with role attribute.</span>

 542      *
<span class="line-modified"> 543      * @return an HtmlTree object for the MAIN tag</span>
 544      */
 545     public static HtmlTree MAIN() {
<span class="line-modified"> 546         HtmlTree htmltree = new HtmlTree(HtmlTag.MAIN);</span>
<span class="line-modified"> 547         htmltree.setRole(Role.MAIN);</span>
<span class="line-removed"> 548         return htmltree;</span>
 549     }
 550 
 551     /**
<span class="line-modified"> 552      * Generates a MAIN tag with role attribute and some content.</span>

 553      *
<span class="line-modified"> 554      * @param body content of the MAIN tag</span>
<span class="line-removed"> 555      * @return an HtmlTree object for the MAIN tag</span>
 556      */
 557     public static HtmlTree MAIN(Content body) {
<span class="line-modified"> 558         HtmlTree htmltree = new HtmlTree(HtmlTag.MAIN, nullCheck(body));</span>
<span class="line-modified"> 559         htmltree.setRole(Role.MAIN);</span>
<span class="line-modified"> 560         return htmltree;</span>
 561     }
 562 
 563     /**
<span class="line-modified"> 564      * Generates a META tag with the http-equiv, content and charset attributes.</span>
 565      *
<span class="line-modified"> 566      * @param httpEquiv http equiv attribute for the META tag</span>
<span class="line-modified"> 567      * @param content type of content</span>
<span class="line-modified"> 568      * @param charSet character set used</span>
<span class="line-modified"> 569      * @return an HtmlTree object for the META tag</span>
 570      */
<span class="line-modified"> 571     public static HtmlTree META(String httpEquiv, String content, String charSet) {</span>
<span class="line-modified"> 572         HtmlTree htmltree = new HtmlTree(HtmlTag.META);</span>
<span class="line-modified"> 573         String contentCharset = content + &quot;; charset=&quot; + charSet;</span>
<span class="line-modified"> 574         htmltree.put(HtmlAttr.HTTP_EQUIV, nullCheck(httpEquiv));</span>
<span class="line-removed"> 575         htmltree.put(HtmlAttr.CONTENT, contentCharset);</span>
<span class="line-removed"> 576         return htmltree;</span>
 577     }
 578 
 579     /**
<span class="line-modified"> 580      * Generates a META tag with the name and content attributes.</span>
 581      *
<span class="line-modified"> 582      * @param name name attribute</span>
<span class="line-modified"> 583      * @param content type of content</span>
<span class="line-modified"> 584      * @return an HtmlTree object for the META tag</span>
 585      */
 586     public static HtmlTree META(String name, String content) {
<span class="line-modified"> 587         HtmlTree htmltree = new HtmlTree(HtmlTag.META);</span>
<span class="line-modified"> 588         htmltree.put(HtmlAttr.NAME, nullCheck(name));</span>
<span class="line-modified"> 589         htmltree.put(HtmlAttr.CONTENT, nullCheck(content));</span>
<span class="line-removed"> 590         return htmltree;</span>
 591     }
 592 
 593     /**
<span class="line-modified"> 594      * Generates a NAV tag with the role attribute.</span>

 595      *
<span class="line-modified"> 596      * @return an HtmlTree object for the NAV tag</span>
 597      */
 598     public static HtmlTree NAV() {
<span class="line-modified"> 599         HtmlTree htmltree = new HtmlTree(HtmlTag.NAV);</span>
<span class="line-modified"> 600         htmltree.setRole(Role.NAVIGATION);</span>
<span class="line-removed"> 601         return htmltree;</span>
 602     }
 603 
 604     /**
<span class="line-modified"> 605      * Generates a NOSCRIPT tag with some content.</span>
 606      *
<span class="line-modified"> 607      * @param body content of the noscript tag</span>
<span class="line-modified"> 608      * @return an HtmlTree object for the NOSCRIPT tag</span>
 609      */
 610     public static HtmlTree NOSCRIPT(Content body) {
<span class="line-modified"> 611         HtmlTree htmltree = new HtmlTree(HtmlTag.NOSCRIPT, nullCheck(body));</span>
<span class="line-modified"> 612         return htmltree;</span>
 613     }
 614 
 615     /**
<span class="line-modified"> 616      * Generates a P tag with some content.</span>
 617      *
<span class="line-modified"> 618      * @param body content of the Paragraph tag</span>
<span class="line-modified"> 619      * @return an HtmlTree object for the P tag</span>
 620      */
 621     public static HtmlTree P(Content body) {
<span class="line-modified"> 622         return P(null, body);</span>

 623     }
 624 
 625     /**
<span class="line-modified"> 626      * Generates a P tag with some content.</span>
 627      *
<span class="line-modified"> 628      * @param styleClass style of the Paragraph tag</span>
<span class="line-modified"> 629      * @param body content of the Paragraph tag</span>
<span class="line-modified"> 630      * @return an HtmlTree object for the P tag</span>
 631      */
<span class="line-modified"> 632     public static HtmlTree P(HtmlStyle styleClass, Content body) {</span>
<span class="line-modified"> 633         HtmlTree htmltree = new HtmlTree(HtmlTag.P, nullCheck(body));</span>
<span class="line-modified"> 634         if (styleClass != null)</span>
<span class="line-removed"> 635             htmltree.setStyle(styleClass);</span>
<span class="line-removed"> 636         return htmltree;</span>
 637     }
 638 
 639     /**
<span class="line-modified"> 640      * Generates a SCRIPT tag with the type and src attributes.</span>

 641      *
<span class="line-modified"> 642      * @param src the path for the script</span>
<span class="line-modified"> 643      * @return an HtmlTree object for the SCRIPT tag</span>
 644      */
 645     public static HtmlTree SCRIPT(String src) {
<span class="line-modified"> 646         HtmlTree htmltree = new HtmlTree(HtmlTag.SCRIPT);</span>
<span class="line-modified"> 647         htmltree.put(HtmlAttr.TYPE, &quot;text/javascript&quot;);</span>
<span class="line-modified"> 648         htmltree.put(HtmlAttr.SRC, nullCheck(src));</span>
<span class="line-modified"> 649         return htmltree;</span>
 650     }
 651 
 652     /**
<span class="line-modified"> 653      * Generates a SECTION tag with style class attribute.</span>
 654      *
<span class="line-modified"> 655      * @param styleClass the style class for the tag</span>
<span class="line-modified"> 656      * @return an HtmlTree object for the SECTION tag</span>
 657      */
<span class="line-modified"> 658     public static HtmlTree SECTION(HtmlStyle styleClass) {</span>
<span class="line-modified"> 659         HtmlTree htmlTree = new HtmlTree(HtmlTag.SECTION);</span>
<span class="line-modified"> 660         htmlTree.setStyle(styleClass);</span>
<span class="line-removed"> 661         return htmlTree;</span>
 662     }
 663 
 664     /**
<span class="line-modified"> 665      * Generates a SECTION tag with style class attribute and some content.</span>
 666      *
<span class="line-modified"> 667      * @param styleClass the style class for the tag</span>
<span class="line-modified"> 668      * @param body content of the section tag</span>
<span class="line-modified"> 669      * @return an HtmlTree object for the SECTION tag</span>
 670      */
<span class="line-modified"> 671     public static HtmlTree SECTION(HtmlStyle styleClass, Content body) {</span>
<span class="line-modified"> 672         HtmlTree htmlTree = new HtmlTree(HtmlTag.SECTION, nullCheck(body));</span>
<span class="line-modified"> 673         if (styleClass != null) {</span>
<span class="line-modified"> 674             htmlTree.setStyle(styleClass);</span>
<span class="line-removed"> 675         }</span>
<span class="line-removed"> 676         return htmlTree;</span>
 677     }
 678 
 679     /**
<span class="line-modified"> 680      * Generates a SMALL tag with some content.</span>
 681      *
<span class="line-modified"> 682      * @param body content for the tag</span>
<span class="line-modified"> 683      * @return an HtmlTree object for the SMALL tag</span>
 684      */
 685     public static HtmlTree SMALL(Content body) {
<span class="line-modified"> 686         HtmlTree htmltree = new HtmlTree(HtmlTag.SMALL, nullCheck(body));</span>
<span class="line-modified"> 687         return htmltree;</span>
 688     }
 689 
 690     /**
<span class="line-modified"> 691      * Generates a SPAN tag with some content.</span>
 692      *
<span class="line-modified"> 693      * @param body content for the tag</span>
<span class="line-modified"> 694      * @return an HtmlTree object for the SPAN tag</span>
 695      */
 696     public static HtmlTree SPAN(Content body) {
<span class="line-modified"> 697         return SPAN(null, body);</span>

 698     }
 699 
 700     /**
<span class="line-modified"> 701      * Generates a SPAN tag with style class attribute and some content.</span>
 702      *
<span class="line-modified"> 703      * @param styleClass style class for the tag</span>
<span class="line-modified"> 704      * @param body content for the tag</span>
<span class="line-modified"> 705      * @return an HtmlTree object for the SPAN tag</span>
 706      */
 707     public static HtmlTree SPAN(HtmlStyle styleClass, Content body) {
<span class="line-modified"> 708         HtmlTree htmltree = new HtmlTree(HtmlTag.SPAN, nullCheck(body));</span>
<span class="line-modified"> 709         if (styleClass != null)</span>
<span class="line-removed"> 710             htmltree.setStyle(styleClass);</span>
<span class="line-removed"> 711         return htmltree;</span>
 712     }
 713 
 714     /**
<span class="line-modified"> 715      * Generates an SPAN tag with id attribute and a body.</span>
 716      *
<span class="line-modified"> 717      * @param id id for the tag</span>
<span class="line-modified"> 718      * @param body body for the tag</span>
<span class="line-modified"> 719      * @return an HtmlTree object for the SPAN tag</span>
 720      */
 721     public static HtmlTree SPAN_ID(String id, Content body) {
<span class="line-modified"> 722         HtmlTree htmltree = new HtmlTree(HtmlTag.SPAN, nullCheck(body));</span>
<span class="line-modified"> 723         htmltree.put(HtmlAttr.ID, nullCheck(id));</span>
<span class="line-modified"> 724         return htmltree;</span>
<span class="line-removed"> 725     }</span>
<span class="line-removed"> 726 </span>
<span class="line-removed"> 727     /**</span>
<span class="line-removed"> 728      * Generates a SPAN tag with id and style class attributes. It also encloses</span>
<span class="line-removed"> 729      * a content.</span>
<span class="line-removed"> 730      *</span>
<span class="line-removed"> 731      * @param id the id for the tag</span>
<span class="line-removed"> 732      * @param styleClass stylesheet class for the tag</span>
<span class="line-removed"> 733      * @param body content for the tag</span>
<span class="line-removed"> 734      * @return an HtmlTree object for the SPAN tag</span>
<span class="line-removed"> 735      */</span>
<span class="line-removed"> 736     public static HtmlTree SPAN(String id, HtmlStyle styleClass, Content body) {</span>
<span class="line-removed"> 737         HtmlTree htmltree = new HtmlTree(HtmlTag.SPAN, nullCheck(body));</span>
<span class="line-removed"> 738         htmltree.put(HtmlAttr.ID, nullCheck(id));</span>
<span class="line-removed"> 739         if (styleClass != null)</span>
<span class="line-removed"> 740             htmltree.setStyle(styleClass);</span>
<span class="line-removed"> 741         return htmltree;</span>
<span class="line-removed"> 742     }</span>
<span class="line-removed"> 743 </span>
<span class="line-removed"> 744     /**</span>
<span class="line-removed"> 745      * Generates a Table tag with style class and summary attributes and some content.</span>
<span class="line-removed"> 746      *</span>
<span class="line-removed"> 747      * @param styleClass style of the table</span>
<span class="line-removed"> 748      * @param summary summary for the table</span>
<span class="line-removed"> 749      * @param body content for the table</span>
<span class="line-removed"> 750      * @return an HtmlTree object for the TABLE tag</span>
<span class="line-removed"> 751      */</span>
<span class="line-removed"> 752     public static HtmlTree TABLE(HtmlStyle styleClass, String summary, Content body) {</span>
<span class="line-removed"> 753         HtmlTree htmltree = new HtmlTree(HtmlTag.TABLE, nullCheck(body));</span>
<span class="line-removed"> 754         if (styleClass != null)</span>
<span class="line-removed"> 755             htmltree.setStyle(styleClass);</span>
<span class="line-removed"> 756         htmltree.put(HtmlAttr.SUMMARY, nullCheck(summary));</span>
<span class="line-removed"> 757         return htmltree;</span>
<span class="line-removed"> 758     }</span>
<span class="line-removed"> 759 </span>
<span class="line-removed"> 760     /**</span>
<span class="line-removed"> 761      * Generates a Table tag with style class attribute and some content.</span>
<span class="line-removed"> 762      *</span>
<span class="line-removed"> 763      * @param styleClass style of the table</span>
<span class="line-removed"> 764      * @param body content for the table</span>
<span class="line-removed"> 765      * @return an HtmlTree object for the TABLE tag</span>
<span class="line-removed"> 766      */</span>
<span class="line-removed"> 767     public static HtmlTree TABLE(HtmlStyle styleClass, Content body) {</span>
<span class="line-removed"> 768         HtmlTree htmltree = new HtmlTree(HtmlTag.TABLE, nullCheck(body));</span>
<span class="line-removed"> 769         if (styleClass != null) {</span>
<span class="line-removed"> 770             htmltree.setStyle(styleClass);</span>
<span class="line-removed"> 771         }</span>
<span class="line-removed"> 772         return htmltree;</span>
 773     }
 774 
 775     /**
<span class="line-modified"> 776      * Generates a TD tag with style class attribute and some content.</span>
 777      *
<span class="line-modified"> 778      * @param styleClass style for the tag</span>
<span class="line-modified"> 779      * @param body content for the tag</span>
<span class="line-modified"> 780      * @return an HtmlTree object for the TD tag</span>

 781      */
<span class="line-modified"> 782     public static HtmlTree TD(HtmlStyle styleClass, Content body) {</span>
<span class="line-modified"> 783         HtmlTree htmltree = new HtmlTree(HtmlTag.TD, nullCheck(body));</span>
<span class="line-modified"> 784         if (styleClass != null)</span>
<span class="line-modified"> 785             htmltree.setStyle(styleClass);</span>
<span class="line-modified"> 786         return htmltree;</span>
 787     }
 788 
 789     /**
<span class="line-modified"> 790      * Generates a TD tag for an HTML table with some content.</span>
 791      *
<span class="line-modified"> 792      * @param body content for the tag</span>
<span class="line-modified"> 793      * @return an HtmlTree object for the TD tag</span>

 794      */
<span class="line-modified"> 795     public static HtmlTree TD(Content body) {</span>
<span class="line-modified"> 796         return TD(null, body);</span>


 797     }
 798 
 799     /**
<span class="line-modified"> 800      * Generates a TH tag with style class and scope attributes and some content.</span>
 801      *
<span class="line-modified"> 802      * @param styleClass style for the tag</span>
<span class="line-modified"> 803      * @param scope scope of the tag</span>
<span class="line-modified"> 804      * @param body content for the tag</span>
<span class="line-modified"> 805      * @return an HtmlTree object for the TH tag</span>
 806      */
<span class="line-modified"> 807     public static HtmlTree TH(HtmlStyle styleClass, String scope, Content body) {</span>
<span class="line-modified"> 808         HtmlTree htmltree = new HtmlTree(HtmlTag.TH, nullCheck(body));</span>
<span class="line-modified"> 809         if (styleClass != null)</span>
<span class="line-modified"> 810             htmltree.setStyle(styleClass);</span>
<span class="line-modified"> 811         htmltree.put(HtmlAttr.SCOPE, nullCheck(scope));</span>
<span class="line-removed"> 812         return htmltree;</span>
 813     }
 814 
 815     /**
<span class="line-modified"> 816      * Generates a TH tag with scope attribute and some content.</span>
 817      *
<span class="line-modified"> 818      * @param scope scope of the tag</span>
<span class="line-modified"> 819      * @param body content for the tag</span>
<span class="line-modified"> 820      * @return an HtmlTree object for the TH tag</span>
 821      */
 822     public static HtmlTree TH(String scope, Content body) {
<span class="line-modified"> 823         return TH(null, scope, body);</span>


 824     }
 825 
 826     /**
<span class="line-modified"> 827      * Generates a TH tag with style class, scope attribute and some content.</span>
 828      *
<span class="line-modified"> 829      * @param styleClass style for the tag</span>
<span class="line-modified"> 830      * @param body content for the tag</span>
<span class="line-removed"> 831      * @return an HtmlTree object for the TH tag</span>
<span class="line-removed"> 832      */</span>
<span class="line-removed"> 833     public static HtmlTree TH_ROW_SCOPE(HtmlStyle styleClass, Content body) {</span>
<span class="line-removed"> 834         return TH(styleClass, &quot;row&quot;, body);</span>
<span class="line-removed"> 835     }</span>
<span class="line-removed"> 836 </span>
<span class="line-removed"> 837     /**</span>
<span class="line-removed"> 838      * Generates a TITLE tag with some content.</span>
<span class="line-removed"> 839      *</span>
<span class="line-removed"> 840      * @param body content for the tag</span>
<span class="line-removed"> 841      * @return an HtmlTree object for the TITLE tag</span>
 842      */
 843     public static HtmlTree TITLE(String body) {
<span class="line-modified"> 844         HtmlTree htmltree = new HtmlTree(HtmlTag.TITLE, new StringContent(body));</span>
<span class="line-modified"> 845         return htmltree;</span>
<span class="line-removed"> 846     }</span>
<span class="line-removed"> 847 </span>
<span class="line-removed"> 848     /**</span>
<span class="line-removed"> 849      * Generates a TR tag for an HTML table with some content.</span>
<span class="line-removed"> 850      *</span>
<span class="line-removed"> 851      * @param body content for the tag</span>
<span class="line-removed"> 852      * @return an HtmlTree object for the TR tag</span>
<span class="line-removed"> 853      */</span>
<span class="line-removed"> 854     public static HtmlTree TR(Content body) {</span>
<span class="line-removed"> 855         HtmlTree htmltree = new HtmlTree(HtmlTag.TR, nullCheck(body));</span>
<span class="line-removed"> 856         return htmltree;</span>
 857     }
 858 
 859     /**
<span class="line-modified"> 860      * Generates a UL tag with the style class attribute and some content.</span>
 861      *
<span class="line-modified"> 862      * @param styleClass style for the tag</span>
<span class="line-modified"> 863      * @param first initial content to be added</span>
<span class="line-modified"> 864      * @param more a series of additional content nodes to be added</span>
<span class="line-modified"> 865      * @return an HtmlTree object for the UL tag</span>
 866      */
<span class="line-modified"> 867     public static HtmlTree UL(HtmlStyle styleClass, Content first, Content... more) {</span>
<span class="line-modified"> 868         HtmlTree htmlTree = new HtmlTree(HtmlTag.UL);</span>
<span class="line-modified"> 869         htmlTree.add(nullCheck(first));</span>

 870         for (Content c : more) {
<span class="line-modified"> 871             htmlTree.add(nullCheck(c));</span>
 872         }
<span class="line-removed"> 873         htmlTree.setStyle(nullCheck(styleClass));</span>
 874         return htmlTree;
 875     }
 876 
 877     @Override
 878     public boolean isEmpty() {
 879         return (!hasContent() &amp;&amp; !hasAttrs());
 880     }
 881 
 882     /**
 883      * Returns true if the HTML tree has content.
 884      *
 885      * @return true if the HTML tree has content else return false
 886      */
 887     public boolean hasContent() {
 888         return (!content.isEmpty());
 889     }
 890 
 891     /**
 892      * Returns true if the HTML tree has attributes.
 893      *
</pre>
<hr />
<pre>
 899 
 900     /**
 901      * Returns true if the HTML tree has a specific attribute.
 902      *
 903      * @param attrName name of the attribute to check within the HTML tree
 904      * @return true if the HTML tree has the specified attribute else return false
 905      */
 906     public boolean hasAttr(HtmlAttr attrName) {
 907         return (attrs.containsKey(attrName));
 908     }
 909 
 910     /**
 911      * Returns true if the HTML tree is valid. This check is more specific to
 912      * standard doclet and not exactly similar to W3C specifications. But it
 913      * ensures HTML validation.
 914      *
 915      * @return true if the HTML tree is valid
 916      */
 917     @Override
 918     public boolean isValid() {
<span class="line-modified"> 919         switch (htmlTag) {</span>
<span class="line-modified"> 920             case A :</span>
<span class="line-modified"> 921                 return (hasAttr(HtmlAttr.NAME) || hasAttr(HtmlAttr.ID) || (hasAttr(HtmlAttr.HREF) &amp;&amp; hasContent()));</span>
<span class="line-modified"> 922             case BR :</span>
 923                 return (!hasContent() &amp;&amp; (!hasAttrs() || hasAttr(HtmlAttr.CLEAR)));
<span class="line-modified"> 924             case IFRAME :</span>
<span class="line-removed"> 925                 return (hasAttr(HtmlAttr.SRC) &amp;&amp; !hasContent());</span>
<span class="line-removed"> 926             case HR :</span>
 927             case INPUT:
 928                 return (!hasContent());
<span class="line-modified"> 929             case IMG :</span>
 930                 return (hasAttr(HtmlAttr.SRC) &amp;&amp; hasAttr(HtmlAttr.ALT) &amp;&amp; !hasContent());
<span class="line-modified"> 931             case LINK :</span>
 932                 return (hasAttr(HtmlAttr.HREF) &amp;&amp; !hasContent());
<span class="line-modified"> 933             case META :</span>
 934                 return (hasAttr(HtmlAttr.CONTENT) &amp;&amp; !hasContent());
<span class="line-modified"> 935             case SCRIPT :</span>
 936                 return ((hasAttr(HtmlAttr.TYPE) &amp;&amp; hasAttr(HtmlAttr.SRC) &amp;&amp; !hasContent()) ||
 937                         (hasAttr(HtmlAttr.TYPE) &amp;&amp; hasContent()));
<span class="line-modified"> 938             case SPAN :</span>
 939                 return (hasAttr(HtmlAttr.ID) || hasContent());
 940             default :
 941                 return hasContent();
 942         }
 943     }
 944 
 945     /**
<span class="line-modified"> 946      * Returns true if the element is an inline element.</span>
 947      *
 948      * @return true if the HTML tag is an inline element


 949      */
 950     public boolean isInline() {
<span class="line-modified"> 951         return (htmlTag.blockType == HtmlTag.BlockType.INLINE);</span>






















 952     }
 953 
 954     @Override
 955     public boolean write(Writer out, boolean atNewline) throws IOException {
<span class="line-modified"> 956         if (!isInline() &amp;&amp; !atNewline)</span>

 957             out.write(DocletConstants.NL);
<span class="line-modified"> 958         String tagString = htmlTag.toString();</span>
 959         out.write(&quot;&lt;&quot;);
 960         out.write(tagString);
 961         Iterator&lt;HtmlAttr&gt; iterator = attrs.keySet().iterator();
 962         HtmlAttr key;
 963         String value;
 964         while (iterator.hasNext()) {
 965             key = iterator.next();
 966             value = attrs.get(key);
 967             out.write(&quot; &quot;);
 968             out.write(key.toString());
 969             if (!value.isEmpty()) {
 970                 out.write(&quot;=\&quot;&quot;);
 971                 out.write(value);
 972                 out.write(&quot;\&quot;&quot;);
 973             }
 974         }
 975         out.write(&quot;&gt;&quot;);
 976         boolean nl = false;
 977         for (Content c : content)
 978             nl = c.write(out, nl);
<span class="line-modified"> 979         if (htmlTag.endTagRequired()) {</span>
 980             out.write(&quot;&lt;/&quot;);
 981             out.write(tagString);
 982             out.write(&quot;&gt;&quot;);
 983         }
<span class="line-modified"> 984         if (!isInline()) {</span>
 985             out.write(DocletConstants.NL);
 986             return true;
 987         } else {
 988             return false;
 989         }
 990     }
 991 
 992     /**
 993      * Given a Content node, strips all html characters and
 994      * return the result.
 995      *
 996      * @param body The content node to check.
 997      * @return the plain text from the content node
 998      *
 999      */
1000     private static String stripHtml(Content body) {
1001         String rawString = body.toString();
1002         // remove HTML tags
<span class="line-modified">1003         rawString = rawString.replaceAll(&quot;\\&lt;.*?&gt;&quot;, &quot; &quot;);</span>
1004         // consolidate multiple spaces between a word to a single space
1005         rawString = rawString.replaceAll(&quot;\\b\\s{2,}\\b&quot;, &quot; &quot;);
1006         // remove extra whitespaces
1007         return rawString.trim();
1008     }
1009 }
</pre>
</td>
<td>
<hr />
<pre>
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
  25 
  26 package jdk.javadoc.internal.doclets.formats.html.markup;
  27 
  28 import java.io.IOException;
  29 import java.io.Writer;
<span class="line-modified">  30 import java.nio.charset.StandardCharsets;</span>
  31 import java.util.ArrayList;
  32 import java.util.BitSet;

  33 import java.util.Iterator;
  34 import java.util.LinkedHashMap;
  35 import java.util.List;
  36 import java.util.Map;
<span class="line-added">  37 import java.util.Objects;</span>
  38 
  39 import jdk.javadoc.internal.doclets.formats.html.markup.HtmlAttr.Role;
  40 import jdk.javadoc.internal.doclets.toolkit.Content;
  41 import jdk.javadoc.internal.doclets.toolkit.util.DocletConstants;
  42 
  43 /**
<span class="line-modified">  44  * A tree node representing an HTML element, containing the name of the element,</span>
<span class="line-added">  45  * a collection of attributes, and content.</span>
<span class="line-added">  46  *</span>
<span class="line-added">  47  * Except where otherwise stated, all methods in this class will throw</span>
<span class="line-added">  48  * {@code NullPointerException} for any arguments that are {@code null}</span>
<span class="line-added">  49  * or that are arrays or collections that contain {@code null}.</span>
<span class="line-added">  50  *</span>
<span class="line-added">  51  * Many methods in this class return {@code this}, to enable a series</span>
<span class="line-added">  52  * of chained method calls on a single object.</span>
<span class="line-added">  53  *</span>
<span class="line-added">  54  * Terminology: An HTML element is typically composed of a start tag, some</span>
<span class="line-added">  55  * enclosed content and typically an end tag. The start tag contains any</span>
<span class="line-added">  56  * attributes for the element. See:</span>
<span class="line-added">  57  * &lt;a href=&quot;https://en.wikipedia.org/wiki/HTML_element&quot;&gt;HTML element&lt;/a&gt;.</span>
  58  *
  59  *  &lt;p&gt;&lt;b&gt;This is NOT part of any supported API.
  60  *  If you write code that depends on this, you do so at your own risk.
  61  *  This code and its internal interfaces are subject to change or
  62  *  deletion without notice.&lt;/b&gt;
<span class="line-added">  63  *</span>
<span class="line-added">  64  * @see &lt;a href=&quot;https://html.spec.whatwg.org/multipage/syntax.html#normal-elements&quot;&gt;WhatWG: Normal Elements&lt;/a&gt;</span>
<span class="line-added">  65  * @see &lt;a href=&quot;https://www.w3.org/TR/html51/syntax.html#writing-html-documents-elements&quot;&gt;HTML 5.1: Elements&lt;/a&gt;</span>
  66  */
  67 public class HtmlTree extends Content {
  68 
<span class="line-modified">  69     /**</span>
<span class="line-modified">  70      * The name of the HTML element.</span>
<span class="line-modified">  71      * This value is never {@code null}.</span>
<span class="line-modified">  72      */</span>
<span class="line-added">  73     public final TagName tagName;</span>
  74 
  75     /**
<span class="line-modified">  76      * The attributes for the HTML element.</span>
<span class="line-modified">  77      * The keys and values in this map are never {@code null}.</span>

  78      */
<span class="line-modified">  79     private Map&lt;HtmlAttr, String&gt; attrs = Map.of();</span>


  80 
  81     /**
<span class="line-modified">  82      * The enclosed content (&quot;inner HTML&quot;) for this HTML element.</span>
<span class="line-modified">  83      * The items in this list are never null.</span>


  84      */
<span class="line-modified">  85     private List&lt;Content&gt; content = List.of();</span>




  86 
  87     /**
<span class="line-modified">  88      * A sentinel value to explicitly indicate empty content.</span>
<span class="line-added">  89      */</span>
<span class="line-added">  90     public static final Content EMPTY = new StringContent(&quot;&quot;);</span>
<span class="line-added">  91 </span>
<span class="line-added">  92     /**</span>
<span class="line-added">  93      * Creates an {@code HTMLTree} object representing an HTML element</span>
<span class="line-added">  94      * with the given name.</span>
  95      *
<span class="line-modified">  96      * @param tagName the name</span>

  97      */
<span class="line-modified">  98     public HtmlTree(TagName tagName) {</span>
<span class="line-modified">  99         this.tagName = Objects.requireNonNull(tagName);</span>


 100     }
 101 
 102     /**
<span class="line-modified"> 103      * Adds an attribute.</span>
 104      *
<span class="line-modified"> 105      * @param attrName  the name of the attribute</span>
<span class="line-modified"> 106      * @param attrValue the value of the attribute</span>
 107      * @return this object
 108      */
 109     public HtmlTree put(HtmlAttr attrName, String attrValue) {
 110         if (attrs.isEmpty())
 111             attrs = new LinkedHashMap&lt;&gt;(3);
<span class="line-modified"> 112         attrs.put(Objects.requireNonNull(attrName), Entity.escapeHtmlChars(attrValue));</span>
 113         return this;
 114     }
 115 
 116     /**
<span class="line-modified"> 117      * Sets the {@code id} attribute.</span>
 118      *
<span class="line-modified"> 119      * @param id the value for the attribute</span>
 120      * @return this object
 121      */
 122     public HtmlTree setId(String id) {
<span class="line-modified"> 123         return put(HtmlAttr.ID, id);</span>

 124     }
 125 
 126     /**
<span class="line-modified"> 127      * Sets the {@code title} attribute.</span>
<span class="line-modified"> 128      * Any nested start or end tags in the content will be removed.</span>
 129      *
 130      * @param body the content for the title attribute
 131      * @return this object
 132      */
 133     public HtmlTree setTitle(Content body) {
<span class="line-modified"> 134         return put(HtmlAttr.TITLE, stripHtml(body));</span>

 135     }
 136 
 137     /**
<span class="line-modified"> 138      * Sets the {@code role} attribute.</span>
 139      *
 140      * @param role the role
 141      * @return this object
 142      */
 143     public HtmlTree setRole(Role role) {
<span class="line-modified"> 144         return put(HtmlAttr.ROLE, role.toString());</span>

 145     }
 146 
 147     /**
<span class="line-modified"> 148      * Sets the {@code class} attribute.</span>
 149      *
<span class="line-modified"> 150      * @param style the value for the attribute</span>
 151      * @return this object
 152      */
 153     public HtmlTree setStyle(HtmlStyle style) {
<span class="line-modified"> 154         return put(HtmlAttr.CLASS, style.cssName());</span>

 155     }
 156 
 157     /**
<span class="line-modified"> 158      * Adds additional content for the HTML element.</span>
 159      *
<span class="line-modified"> 160      * @param content the content</span>
 161      */
 162     @Override
<span class="line-modified"> 163     public HtmlTree add(Content content) {</span>
<span class="line-modified"> 164         if (content instanceof ContentBuilder) {</span>
<span class="line-modified"> 165             ((ContentBuilder) content).contents.forEach(this::add);</span>


 166         }
<span class="line-modified"> 167         else if (content == HtmlTree.EMPTY || content.isValid()) {</span>
<span class="line-modified"> 168             // quietly avoid adding empty or invalid nodes (except EMPTY)</span>
<span class="line-modified"> 169             if (this.content.isEmpty())</span>
<span class="line-modified"> 170                 this.content = new ArrayList&lt;&gt;();</span>
<span class="line-added"> 171             this.content.add(content);</span>
 172         }
<span class="line-added"> 173         return this;</span>
 174     }
 175 
 176     /**
<span class="line-modified"> 177      * Adds text content for the HTML element.</span>
<span class="line-modified"> 178      *</span>
<span class="line-modified"> 179      * If the last content member that was added is a {@code StringContent},</span>
<span class="line-added"> 180      * appends the string to that item; otherwise, creates and uses a new {@code StringContent}</span>
<span class="line-added"> 181      * for the new text content.</span>
 182      *
 183      * @param stringContent string content that needs to be added
 184      */
 185     @Override
<span class="line-modified"> 186     public HtmlTree add(CharSequence stringContent) {</span>
 187         if (!content.isEmpty()) {
 188             Content lastContent = content.get(content.size() - 1);
 189             if (lastContent instanceof StringContent)
 190                 lastContent.add(stringContent);
<span class="line-modified"> 191             else {</span>
 192                 add(new StringContent(stringContent));
<span class="line-added"> 193             }</span>
 194         }
<span class="line-modified"> 195         else {</span>
 196             add(new StringContent(stringContent));
<span class="line-added"> 197         }</span>
<span class="line-added"> 198         return this;</span>
<span class="line-added"> 199     }</span>
<span class="line-added"> 200 </span>
<span class="line-added"> 201     /**</span>
<span class="line-added"> 202      * Adds each of a list of content items.</span>
<span class="line-added"> 203      *</span>
<span class="line-added"> 204      * @param list the list</span>
<span class="line-added"> 205      * @return this object</span>
<span class="line-added"> 206      */</span>
<span class="line-added"> 207     public HtmlTree add(List&lt;? extends Content&gt; list) {</span>
<span class="line-added"> 208         list.forEach(this::add);</span>
<span class="line-added"> 209         return this;</span>
 210     }
 211 
 212     @Override
 213     public int charCount() {
 214         int n = 0;
<span class="line-modified"> 215         for (Content c : content) {</span>
 216             n += c.charCount();
<span class="line-added"> 217         }</span>
 218         return n;
 219     }
 220 
 221     /*
 222      * The sets of ASCII URI characters to be left unencoded.
 223      * See &quot;Uniform Resource Identifier (URI): Generic Syntax&quot;
 224      * IETF RFC 3986. https://tools.ietf.org/html/rfc3986
 225      */
 226     public static final BitSet MAIN_CHARS;
 227     public static final BitSet QUERY_FRAGMENT_CHARS;
 228 
 229     static {
 230         BitSet alphaDigit = bitSet(bitSet(&#39;A&#39;, &#39;Z&#39;), bitSet(&#39;a&#39;, &#39;z&#39;), bitSet(&#39;0&#39;, &#39;9&#39;));
 231         BitSet unreserved = bitSet(alphaDigit, bitSet(&quot;-._~&quot;));
 232         BitSet genDelims = bitSet(&quot;:/?#[]@&quot;);
 233         BitSet subDelims = bitSet(&quot;!$&amp;&#39;()*+,;=&quot;);
 234         MAIN_CHARS = bitSet(unreserved, genDelims, subDelims);
 235         BitSet pchar = bitSet(unreserved, subDelims, bitSet(&quot;:@&quot;));
 236         QUERY_FRAGMENT_CHARS = bitSet(pchar, bitSet(&quot;/?&quot;));
 237     }
</pre>
<hr />
<pre>
 254         BitSet result = new BitSet();
 255         for (BitSet set : sets) {
 256             result.or(set);
 257         }
 258         return result;
 259     }
 260 
 261     /**
 262      * Apply percent-encoding to a URL.
 263      * This is similar to {@link java.net.URLEncoder} but
 264      * is less aggressive about encoding some characters,
 265      * like &#39;(&#39;, &#39;)&#39;, &#39;,&#39; which are used in the anchor
 266      * names for Java methods in HTML5 mode.
 267      *
 268      * @param url the url to be percent-encoded.
 269      * @return a percent-encoded string.
 270      */
 271     public static String encodeURL(String url) {
 272         BitSet nonEncodingChars = MAIN_CHARS;
 273         StringBuilder sb = new StringBuilder();
<span class="line-modified"> 274         for (byte c : url.getBytes(StandardCharsets.UTF_8)) {</span>
 275             if (c == &#39;?&#39; || c == &#39;#&#39;) {
 276                 sb.append((char) c);
 277                 // switch to the more restrictive set inside
 278                 // the query and/or fragment
 279                 nonEncodingChars = QUERY_FRAGMENT_CHARS;
 280             } else if (nonEncodingChars.get(c &amp; 0xFF)) {
 281                 sb.append((char) c);
 282             } else {
 283                 sb.append(String.format(&quot;%%%02X&quot;, c &amp; 0xFF));
 284             }
 285         }
 286         return sb.toString();
 287     }
 288 
 289     /**
<span class="line-modified"> 290      * Creates an HTML {@code A} element.</span>
 291      *
<span class="line-modified"> 292      * @param ref the value for the {@code href} attribute}</span>
<span class="line-modified"> 293      * @param body the content for element</span>
<span class="line-modified"> 294      * @return the element</span>
 295      */
 296     public static HtmlTree A(String ref, Content body) {
<span class="line-modified"> 297         return new HtmlTree(TagName.A)</span>
<span class="line-modified"> 298                 .put(HtmlAttr.HREF, encodeURL(ref))</span>
<span class="line-modified"> 299                 .add(body);</span>
 300     }
 301 
 302     /**
<span class="line-modified"> 303      * Creates an HTML {@code CAPTION} element with the given content.</span>
 304      *
<span class="line-modified"> 305      * @param body content for the element</span>
<span class="line-modified"> 306      * @return the element</span>
 307      */
 308     public static HtmlTree CAPTION(Content body) {
<span class="line-modified"> 309         return new HtmlTree(TagName.CAPTION)</span>
<span class="line-modified"> 310                 .add(body);</span>
 311     }
 312 
 313     /**
<span class="line-modified"> 314      * Creates an HTML {@code CODE} element with the given content.</span>
 315      *
<span class="line-modified"> 316      * @param body content for the element</span>
<span class="line-modified"> 317      * @return the element</span>
 318      */
 319     public static HtmlTree CODE(Content body) {
<span class="line-modified"> 320         return new HtmlTree(TagName.CODE)</span>
<span class="line-modified"> 321                 .add(body);</span>
 322     }
 323 
 324     /**
<span class="line-modified"> 325      * Creates an HTML {@code DD} element with the given content.</span>
 326      *
<span class="line-modified"> 327      * @param body content for the element</span>
<span class="line-modified"> 328      * @return the element</span>
 329      */
 330     public static HtmlTree DD(Content body) {
<span class="line-modified"> 331         return new HtmlTree(TagName.DD)</span>
<span class="line-modified"> 332                 .add(body);</span>
 333     }
 334 
 335     /**
<span class="line-modified"> 336      * Creates an HTML {@code DL} element with the given style.</span>
 337      *
<span class="line-modified"> 338      * @param style the style</span>
<span class="line-modified"> 339      * @return the element</span>
 340      */
<span class="line-modified"> 341     public static HtmlTree DL(HtmlStyle style) {</span>
<span class="line-modified"> 342         return new HtmlTree(TagName.DL)</span>
<span class="line-modified"> 343                 .setStyle(style);</span>
 344     }
 345 
 346     /**
<span class="line-modified"> 347      * Creates an HTML {@code DL} element with the given style and content.</span>

 348      *
<span class="line-modified"> 349      * @param style the style</span>
<span class="line-modified"> 350      * @param body  the content</span>
<span class="line-modified"> 351      * @return the element</span>
 352      */
<span class="line-modified"> 353     public static HtmlTree DL(HtmlStyle style, Content body) {</span>
<span class="line-modified"> 354         return new HtmlTree(TagName.DL)</span>
<span class="line-modified"> 355                 .setStyle(style)</span>
<span class="line-modified"> 356                 .add(body);</span>

 357     }
 358 
 359     /**
<span class="line-modified"> 360      * Creates an HTML {@code DIV} element with the given style.</span>
 361      *
<span class="line-modified"> 362      * @param style the style</span>
<span class="line-modified"> 363      * @return the element</span>
<span class="line-added"> 364      */</span>
<span class="line-added"> 365     public static HtmlTree DIV(HtmlStyle style) {</span>
<span class="line-added"> 366         return new HtmlTree(TagName.DIV)</span>
<span class="line-added"> 367                 .setStyle(style);</span>
<span class="line-added"> 368     }</span>
<span class="line-added"> 369 </span>
<span class="line-added"> 370     /**</span>
<span class="line-added"> 371      * Creates an HTML {@code DIV} element with the given style and content.</span>
<span class="line-added"> 372      *</span>
<span class="line-added"> 373      * @param style the style</span>
<span class="line-added"> 374      * @param body  the content</span>
<span class="line-added"> 375      * @return the element</span>
<span class="line-added"> 376      */</span>
<span class="line-added"> 377     public static HtmlTree DIV(HtmlStyle style, Content body) {</span>
<span class="line-added"> 378         return new HtmlTree(TagName.DIV)</span>
<span class="line-added"> 379                 .setStyle(style)</span>
<span class="line-added"> 380                 .add(body);</span>
<span class="line-added"> 381     }</span>
<span class="line-added"> 382 </span>
<span class="line-added"> 383     /**</span>
<span class="line-added"> 384      * Creates an HTML {@code DIV} element with the given content.</span>
<span class="line-added"> 385      *</span>
<span class="line-added"> 386      * @param body the content</span>
<span class="line-added"> 387      * @return the element</span>
 388      */
 389     public static HtmlTree DIV(Content body) {
<span class="line-modified"> 390         return new HtmlTree(TagName.DIV)</span>
<span class="line-added"> 391                 .add(body);</span>
 392     }
 393 
 394     /**
<span class="line-modified"> 395      * Creates an HTML {@code DT} element with the given content.</span>
 396      *
<span class="line-modified"> 397      * @param body the content</span>
<span class="line-modified"> 398      * @return the element</span>
 399      */
 400     public static HtmlTree DT(Content body) {
<span class="line-modified"> 401         return new HtmlTree(TagName.DT)</span>
<span class="line-modified"> 402                 .add(body);</span>
 403     }
 404 
 405     /**
<span class="line-modified"> 406      * Creates an HTML {@code FOOTER} element.</span>
<span class="line-added"> 407      * The role is set to {@code contentinfo}.</span>
 408      *
<span class="line-modified"> 409      * @return the element</span>
 410      */
 411     public static HtmlTree FOOTER() {
<span class="line-modified"> 412         return new HtmlTree(TagName.FOOTER)</span>
<span class="line-modified"> 413                 .setRole(Role.CONTENTINFO);</span>

 414     }
 415 
 416     /**
<span class="line-modified"> 417      * Creates an HTML {@code HEADER} element.</span>
<span class="line-added"> 418      * The role is set to {@code banner}.</span>
 419      *
<span class="line-modified"> 420      * @return the element</span>
 421      */
 422     public static HtmlTree HEADER() {
<span class="line-modified"> 423         return new HtmlTree(TagName.HEADER)</span>
<span class="line-modified"> 424                 .setRole(Role.BANNER);</span>

 425     }
 426 
 427     /**
<span class="line-modified"> 428      * Creates an HTML heading element with the given content.</span>

 429      *
<span class="line-modified"> 430      * @param headingTag the tag for the heading</span>
<span class="line-modified"> 431      * @param body       the content</span>
<span class="line-modified"> 432      * @return the element</span>


 433      */
<span class="line-modified"> 434     public static HtmlTree HEADING(TagName headingTag, Content body) {</span>
<span class="line-modified"> 435         return new HtmlTree(checkHeading(headingTag))</span>
<span class="line-modified"> 436                 .add(body);</span>





 437     }
 438 
 439     /**
<span class="line-modified"> 440      * Creates an HTML heading element with the given style and content.</span>

 441      *
<span class="line-modified"> 442      * @param headingTag the tag for the heading</span>
<span class="line-modified"> 443      * @param style      the stylesheet class</span>
<span class="line-modified"> 444      * @param body       the content</span>
<span class="line-modified"> 445      * @return the element</span>
 446      */
<span class="line-modified"> 447     public static HtmlTree HEADING(TagName headingTag, HtmlStyle style, Content body) {</span>
<span class="line-modified"> 448         return new HtmlTree(checkHeading(headingTag))</span>
<span class="line-added"> 449                 .setStyle(style)</span>
<span class="line-added"> 450                 .add(body);</span>
 451     }
 452 
 453     /**
<span class="line-modified"> 454      * Creates an HTML heading element with the given style and content.</span>
<span class="line-modified"> 455      * The {@code title} attribute is set from the content.</span>
 456      *
<span class="line-modified"> 457      * @param headingTag the tag for the heading</span>
<span class="line-modified"> 458      * @param style      the stylesheet class</span>
<span class="line-modified"> 459      * @param body       the content</span>
<span class="line-modified"> 460      * @return the element</span>
 461      */
<span class="line-modified"> 462     public static HtmlTree HEADING_TITLE(TagName headingTag,</span>
<span class="line-modified"> 463                                          HtmlStyle style, Content body) {</span>
<span class="line-added"> 464         return new HtmlTree(checkHeading(headingTag))</span>
<span class="line-added"> 465                 .setTitle(body)</span>
<span class="line-added"> 466                 .setStyle(style)</span>
<span class="line-added"> 467                 .add(body);</span>
 468     }
 469 
 470     /**
<span class="line-modified"> 471      * Creates an HTML heading element with the given style and content.</span>
<span class="line-added"> 472      * The {@code title} attribute is set from the content.</span>
 473      *
<span class="line-modified"> 474      * @param headingTag the tag for the heading</span>
<span class="line-modified"> 475      * @param body       the content</span>
<span class="line-modified"> 476      * @return the element</span>
 477      */
<span class="line-modified"> 478     public static HtmlTree HEADING_TITLE(TagName headingTag, Content body) {</span>
<span class="line-modified"> 479         return new HtmlTree(checkHeading(headingTag))</span>
<span class="line-added"> 480                 .setTitle(body)</span>
<span class="line-added"> 481                 .add(body);</span>
 482     }
 483 
<span class="line-modified"> 484     private static TagName checkHeading(TagName headingTag) {</span>
<span class="line-modified"> 485         switch (headingTag) {</span>
<span class="line-modified"> 486             case H1: case H2: case H3: case H4: case H5: case H6:</span>
<span class="line-modified"> 487                 return headingTag;</span>
<span class="line-modified"> 488             default:</span>
<span class="line-modified"> 489                 throw new IllegalArgumentException(headingTag.toString());</span>
<span class="line-modified"> 490         }</span>






 491     }
 492 
 493     /**
<span class="line-modified"> 494      * Craetes an HTML {@code HTML} element with the given {@code lang} attribute,</span>
<span class="line-added"> 495      * and {@code HEAD} and {@code BODY} contents.</span>
 496      *
<span class="line-modified"> 497      * @param lang the value for the {@code lang} attribute</span>
<span class="line-modified"> 498      * @param head the {@code HEAD} element</span>
<span class="line-modified"> 499      * @param body the {@code BODY} element</span>
<span class="line-modified"> 500      * @return the {@code HTML} element</span>
 501      */
<span class="line-modified"> 502     public static HtmlTree HTML(String lang, Content head, Content body) {</span>
<span class="line-modified"> 503         return new HtmlTree(TagName.HTML)</span>
<span class="line-modified"> 504                 .put(HtmlAttr.LANG, lang)</span>
<span class="line-modified"> 505                 .add(head)</span>
<span class="line-modified"> 506                 .add(body);</span>

 507     }
 508 
 509     /**
<span class="line-modified"> 510      * Creates an HTML {@code INPUT} element with the given id and initial value.</span>
<span class="line-added"> 511      * The element as marked as initially disabled.</span>
 512      *
<span class="line-modified"> 513      * @param type  the type of input</span>
<span class="line-modified"> 514      * @param id    the id</span>
<span class="line-modified"> 515      * @param value the initial value</span>
<span class="line-modified"> 516      * @return the element</span>
 517      */
 518     public static HtmlTree INPUT(String type, String id, String value) {
<span class="line-modified"> 519         return new HtmlTree(TagName.INPUT)</span>
<span class="line-modified"> 520                 .put(HtmlAttr.TYPE, type)</span>
<span class="line-modified"> 521                 .put(HtmlAttr.ID, id)</span>
<span class="line-modified"> 522                 .put(HtmlAttr.VALUE, value)</span>
<span class="line-modified"> 523                 .put(HtmlAttr.DISABLED, &quot;disabled&quot;);</span>

 524     }
 525 
 526     /**
<span class="line-modified"> 527      * Creates an HTML {@code LABEL} element with the given content.</span>
 528      *
<span class="line-modified"> 529      * @param forLabel the value of the {@code for} attribute</span>
<span class="line-modified"> 530      * @param body     the content</span>
<span class="line-modified"> 531      * @return the element</span>
 532      */
 533     public static HtmlTree LABEL(String forLabel, Content body) {
<span class="line-modified"> 534         return new HtmlTree(TagName.LABEL)</span>
<span class="line-modified"> 535                 .put(HtmlAttr.FOR, forLabel)</span>
<span class="line-modified"> 536                 .add(body);</span>
 537     }
 538 
 539     /**
<span class="line-modified"> 540      * Creates an HTML {@code LI} element with the given content.</span>
 541      *
<span class="line-modified"> 542      * @param body the content</span>
<span class="line-modified"> 543      * @return the element</span>
 544      */
 545     public static HtmlTree LI(Content body) {
<span class="line-modified"> 546         return new HtmlTree(TagName.LI)</span>
<span class="line-added"> 547                 .add(body);</span>
 548     }
 549 
 550     /**
<span class="line-modified"> 551      * Creates an HTML {@code LI} element with the given style and the given content.</span>
 552      *
<span class="line-modified"> 553      * @param style the style</span>
<span class="line-modified"> 554      * @param body  the content</span>
<span class="line-modified"> 555      * @return the element</span>
 556      */
<span class="line-modified"> 557     public static HtmlTree LI(HtmlStyle style, Content body) {</span>
<span class="line-modified"> 558         return LI(body)</span>
<span class="line-modified"> 559                 .setStyle(style);</span>


 560     }
 561 
 562     /**
<span class="line-modified"> 563      * Creates an HTML {@code LINK} tag with the given attributes.</span>
 564      *
<span class="line-modified"> 565      * @param rel   the relevance of the link: the {@code rel} attribute</span>
<span class="line-modified"> 566      * @param type  the type of link: the {@code type} attribute</span>
<span class="line-modified"> 567      * @param href  the path for the link: the {@code href} attribute</span>
<span class="line-modified"> 568      * @param title title for the link: the {@code title} attribute</span>
<span class="line-modified"> 569      * @return the element</span>
 570      */
 571     public static HtmlTree LINK(String rel, String type, String href, String title) {
<span class="line-modified"> 572         return new HtmlTree(TagName.LINK)</span>
<span class="line-modified"> 573                 .put(HtmlAttr.REL, rel)</span>
<span class="line-modified"> 574                 .put(HtmlAttr.TYPE, type)</span>
<span class="line-modified"> 575                 .put(HtmlAttr.HREF, href)</span>
<span class="line-modified"> 576                 .put(HtmlAttr.TITLE, title);</span>

 577     }
 578 
 579     /**
<span class="line-modified"> 580      * Creates an HTML {@code MAIN} element.</span>
<span class="line-added"> 581      * The role is set to {@code main}.</span>
 582      *
<span class="line-modified"> 583      * @return the element</span>
 584      */
 585     public static HtmlTree MAIN() {
<span class="line-modified"> 586         return new HtmlTree(TagName.MAIN)</span>
<span class="line-modified"> 587                 .setRole(Role.MAIN);</span>

 588     }
 589 
 590     /**
<span class="line-modified"> 591      * Creates an HTML {@code MAIN} element with the given content.</span>
<span class="line-added"> 592      * The role is set to {@code main}.</span>
 593      *
<span class="line-modified"> 594      * @return the element</span>

 595      */
 596     public static HtmlTree MAIN(Content body) {
<span class="line-modified"> 597         return new HtmlTree(TagName.MAIN)</span>
<span class="line-modified"> 598                 .setRole(Role.MAIN)</span>
<span class="line-modified"> 599                 .add(body);</span>
 600     }
 601 
 602     /**
<span class="line-modified"> 603      * Creates an HTML {@code META} element with {@code http-equiv} and {@code content} attributes.</span>
 604      *
<span class="line-modified"> 605      * @param httpEquiv the value for the {@code http-equiv} attribute</span>
<span class="line-modified"> 606      * @param content   the type of content, to be used in the {@code content} attribute</span>
<span class="line-modified"> 607      * @param charset   the character set for the document, to be used in the {@code content} attribute</span>
<span class="line-modified"> 608      * @return the element</span>
 609      */
<span class="line-modified"> 610     public static HtmlTree META(String httpEquiv, String content, String charset) {</span>
<span class="line-modified"> 611         return new HtmlTree(TagName.META)</span>
<span class="line-modified"> 612                 .put(HtmlAttr.HTTP_EQUIV, httpEquiv)</span>
<span class="line-modified"> 613                 .put(HtmlAttr.CONTENT, content + &quot;; charset=&quot; + charset);</span>


 614     }
 615 
 616     /**
<span class="line-modified"> 617      * Creates an HTML {@code META} element with {@code name} and {@code content} attributes.</span>
 618      *
<span class="line-modified"> 619      * @param name    the value for the {@code name} attribute</span>
<span class="line-modified"> 620      * @param content the value for the {@code content} attribute</span>
<span class="line-modified"> 621      * @return the element</span>
 622      */
 623     public static HtmlTree META(String name, String content) {
<span class="line-modified"> 624         return new HtmlTree(TagName.META)</span>
<span class="line-modified"> 625                 .put(HtmlAttr.NAME, name)</span>
<span class="line-modified"> 626                 .put(HtmlAttr.CONTENT, content);</span>

 627     }
 628 
 629     /**
<span class="line-modified"> 630      * Creates an HTML {@code NAV} element.</span>
<span class="line-added"> 631      * The role is set to {@code navigation}.</span>
 632      *
<span class="line-modified"> 633      * @return the element</span>
 634      */
 635     public static HtmlTree NAV() {
<span class="line-modified"> 636         return new HtmlTree(TagName.NAV)</span>
<span class="line-modified"> 637                 .setRole(Role.NAVIGATION);</span>

 638     }
 639 
 640     /**
<span class="line-modified"> 641      * Creates an HTML {@code NOSCRIPT} element with some content.</span>
 642      *
<span class="line-modified"> 643      * @param body the content</span>
<span class="line-modified"> 644      * @return the element</span>
 645      */
 646     public static HtmlTree NOSCRIPT(Content body) {
<span class="line-modified"> 647         return new HtmlTree(TagName.NOSCRIPT)</span>
<span class="line-modified"> 648                 .add(body);</span>
 649     }
 650 
 651     /**
<span class="line-modified"> 652      * Creates an HTML {@code P} element with some content.</span>
 653      *
<span class="line-modified"> 654      * @param body the content</span>
<span class="line-modified"> 655      * @return the element</span>
 656      */
 657     public static HtmlTree P(Content body) {
<span class="line-modified"> 658         return new HtmlTree(TagName.P)</span>
<span class="line-added"> 659                 .add(body);</span>
 660     }
 661 
 662     /**
<span class="line-modified"> 663      * Creates an HTML {@code P} element with the given style and some content.</span>
 664      *
<span class="line-modified"> 665      * @param style the style</span>
<span class="line-modified"> 666      * @param body  the content</span>
<span class="line-modified"> 667      * @return the element</span>
 668      */
<span class="line-modified"> 669     public static HtmlTree P(HtmlStyle style, Content body) {</span>
<span class="line-modified"> 670         return P(body)</span>
<span class="line-modified"> 671                 .setStyle(style);</span>


 672     }
 673 
 674     /**
<span class="line-modified"> 675      * Creates an HTML {@code SCRIPT} element with some script content.</span>
<span class="line-added"> 676      * The type of the script is set to {@code text/javascript}.</span>
 677      *
<span class="line-modified"> 678      * @param src the content</span>
<span class="line-modified"> 679      * @return the element</span>
 680      */
 681     public static HtmlTree SCRIPT(String src) {
<span class="line-modified"> 682         return new HtmlTree(TagName.SCRIPT)</span>
<span class="line-modified"> 683                 .put(HtmlAttr.TYPE, &quot;text/javascript&quot;)</span>
<span class="line-modified"> 684                 .put(HtmlAttr.SRC, src);</span>
<span class="line-modified"> 685 </span>
 686     }
 687 
 688     /**
<span class="line-modified"> 689      * Creates an HTML {@code SECTION} element with the given style.</span>
 690      *
<span class="line-modified"> 691      * @param style the style</span>
<span class="line-modified"> 692      * @return the element</span>
 693      */
<span class="line-modified"> 694     public static HtmlTree SECTION(HtmlStyle style) {</span>
<span class="line-modified"> 695         return new HtmlTree(TagName.SECTION)</span>
<span class="line-modified"> 696                 .setStyle(style);</span>

 697     }
 698 
 699     /**
<span class="line-modified"> 700      * Creates an HTML {@code SECTION} element with the given style and some content.</span>
 701      *
<span class="line-modified"> 702      * @param style the style</span>
<span class="line-modified"> 703      * @param body  the content</span>
<span class="line-modified"> 704      * @return the element</span>
 705      */
<span class="line-modified"> 706     public static HtmlTree SECTION(HtmlStyle style, Content body) {</span>
<span class="line-modified"> 707         return new HtmlTree(TagName.SECTION)</span>
<span class="line-modified"> 708                 .setStyle(style)</span>
<span class="line-modified"> 709                 .add(body);</span>


 710     }
 711 
 712     /**
<span class="line-modified"> 713      * Creates an HTML {@code SMALL} element with some content.</span>
 714      *
<span class="line-modified"> 715      * @param body  the content</span>
<span class="line-modified"> 716      * @return the element</span>
 717      */
 718     public static HtmlTree SMALL(Content body) {
<span class="line-modified"> 719         return new HtmlTree(TagName.SMALL)</span>
<span class="line-modified"> 720                 .add(body);</span>
 721     }
 722 
 723     /**
<span class="line-modified"> 724      * Creates an HTML {@code SPAN} element with some content.</span>
 725      *
<span class="line-modified"> 726      * @param body  the content</span>
<span class="line-modified"> 727      * @return the element</span>
 728      */
 729     public static HtmlTree SPAN(Content body) {
<span class="line-modified"> 730         return new HtmlTree(TagName.SPAN)</span>
<span class="line-added"> 731                 .add(body);</span>
 732     }
 733 
 734     /**
<span class="line-modified"> 735      * Creates an HTML {@code SPAN} element with the given style and some content.</span>
 736      *
<span class="line-modified"> 737      * @param styleClass the style</span>
<span class="line-modified"> 738      * @param body       the content</span>
<span class="line-modified"> 739      * @return the element</span>
 740      */
 741     public static HtmlTree SPAN(HtmlStyle styleClass, Content body) {
<span class="line-modified"> 742         return SPAN(body)</span>
<span class="line-modified"> 743                 .setStyle(styleClass);</span>


 744     }
 745 
 746     /**
<span class="line-modified"> 747      * Creates an HTML {@code SPAN} element with the given id and some content.</span>
 748      *
<span class="line-modified"> 749      * @param id    the id</span>
<span class="line-modified"> 750      * @param body  the content</span>
<span class="line-modified"> 751      * @return the element</span>
 752      */
 753     public static HtmlTree SPAN_ID(String id, Content body) {
<span class="line-modified"> 754         return new HtmlTree(TagName.SPAN)</span>
<span class="line-modified"> 755                 .setId(id)</span>
<span class="line-modified"> 756                 .add(body);</span>
















































 757     }
 758 
 759     /**
<span class="line-modified"> 760      * Creates an HTML {@code SPAN} element with the given id and style, and some content.</span>
 761      *
<span class="line-modified"> 762      * @param id    the id</span>
<span class="line-modified"> 763      * @param style the style</span>
<span class="line-modified"> 764      * @param body  the content</span>
<span class="line-added"> 765      * @return the element</span>
 766      */
<span class="line-modified"> 767     public static HtmlTree SPAN(String id, HtmlStyle style, Content body) {</span>
<span class="line-modified"> 768         return new HtmlTree(TagName.SPAN)</span>
<span class="line-modified"> 769                 .setId(id)</span>
<span class="line-modified"> 770                 .setStyle(style)</span>
<span class="line-modified"> 771                 .add(body);</span>
 772     }
 773 
 774     /**
<span class="line-modified"> 775      * Creates an HTML {@code TD} element with the given style and some content.</span>
 776      *
<span class="line-modified"> 777      * @param style the style</span>
<span class="line-modified"> 778      * @param body  the content</span>
<span class="line-added"> 779      * @return the element</span>
 780      */
<span class="line-modified"> 781     public static HtmlTree TD(HtmlStyle style, Content body) {</span>
<span class="line-modified"> 782         return new HtmlTree(TagName.TD)</span>
<span class="line-added"> 783                 .setStyle(style)</span>
<span class="line-added"> 784                 .add(body);</span>
 785     }
 786 
 787     /**
<span class="line-modified"> 788      * Creates an HTML {@code TH} element with the given style and scope, and some content.</span>
 789      *
<span class="line-modified"> 790      * @param style the style</span>
<span class="line-modified"> 791      * @param scope the value for the {@code scope} attribute</span>
<span class="line-modified"> 792      * @param body  the content</span>
<span class="line-modified"> 793      * @return the element</span>
 794      */
<span class="line-modified"> 795     public static HtmlTree TH(HtmlStyle style, String scope, Content body) {</span>
<span class="line-modified"> 796         return new HtmlTree(TagName.TH)</span>
<span class="line-modified"> 797                 .setStyle(style)</span>
<span class="line-modified"> 798                 .put(HtmlAttr.SCOPE, scope)</span>
<span class="line-modified"> 799                 .add(body);</span>

 800     }
 801 
 802     /**
<span class="line-modified"> 803      * Creates an HTML {@code TH} element with the given scope, and some content.</span>
 804      *
<span class="line-modified"> 805      * @param scope the value for the {@code scope} attribute</span>
<span class="line-modified"> 806      * @param body  the content</span>
<span class="line-modified"> 807      * @return the element</span>
 808      */
 809     public static HtmlTree TH(String scope, Content body) {
<span class="line-modified"> 810         return new HtmlTree(TagName.TH)</span>
<span class="line-added"> 811                 .put(HtmlAttr.SCOPE, scope)</span>
<span class="line-added"> 812                 .add(body);</span>
 813     }
 814 
 815     /**
<span class="line-modified"> 816      * Creates an HTML {@code TITLE} element with some content.</span>
 817      *
<span class="line-modified"> 818      * @param body the content</span>
<span class="line-modified"> 819      * @return the element</span>











 820      */
 821     public static HtmlTree TITLE(String body) {
<span class="line-modified"> 822         return new HtmlTree(TagName.TITLE)</span>
<span class="line-modified"> 823             .add(body);</span>











 824     }
 825 
 826     /**
<span class="line-modified"> 827      * Creates an HTML {@code UL} element with the given style and some content.</span>
 828      *
<span class="line-modified"> 829      * @param style the style</span>
<span class="line-modified"> 830      * @param first the initial content</span>
<span class="line-modified"> 831      * @param more  additional content</span>
<span class="line-modified"> 832      * @return the element</span>
 833      */
<span class="line-modified"> 834     public static HtmlTree UL(HtmlStyle style, Content first, Content... more) {</span>
<span class="line-modified"> 835         HtmlTree htmlTree = new HtmlTree(TagName.UL)</span>
<span class="line-modified"> 836                 .setStyle(style);</span>
<span class="line-added"> 837         htmlTree.add(first);</span>
 838         for (Content c : more) {
<span class="line-modified"> 839             htmlTree.add(c);</span>
 840         }

 841         return htmlTree;
 842     }
 843 
 844     @Override
 845     public boolean isEmpty() {
 846         return (!hasContent() &amp;&amp; !hasAttrs());
 847     }
 848 
 849     /**
 850      * Returns true if the HTML tree has content.
 851      *
 852      * @return true if the HTML tree has content else return false
 853      */
 854     public boolean hasContent() {
 855         return (!content.isEmpty());
 856     }
 857 
 858     /**
 859      * Returns true if the HTML tree has attributes.
 860      *
</pre>
<hr />
<pre>
 866 
 867     /**
 868      * Returns true if the HTML tree has a specific attribute.
 869      *
 870      * @param attrName name of the attribute to check within the HTML tree
 871      * @return true if the HTML tree has the specified attribute else return false
 872      */
 873     public boolean hasAttr(HtmlAttr attrName) {
 874         return (attrs.containsKey(attrName));
 875     }
 876 
 877     /**
 878      * Returns true if the HTML tree is valid. This check is more specific to
 879      * standard doclet and not exactly similar to W3C specifications. But it
 880      * ensures HTML validation.
 881      *
 882      * @return true if the HTML tree is valid
 883      */
 884     @Override
 885     public boolean isValid() {
<span class="line-modified"> 886         switch (tagName) {</span>
<span class="line-modified"> 887             case A:</span>
<span class="line-modified"> 888                 return (hasAttr(HtmlAttr.ID) || (hasAttr(HtmlAttr.HREF) &amp;&amp; hasContent()));</span>
<span class="line-modified"> 889             case BR:</span>
 890                 return (!hasContent() &amp;&amp; (!hasAttrs() || hasAttr(HtmlAttr.CLEAR)));
<span class="line-modified"> 891             case HR:</span>


 892             case INPUT:
 893                 return (!hasContent());
<span class="line-modified"> 894             case IMG:</span>
 895                 return (hasAttr(HtmlAttr.SRC) &amp;&amp; hasAttr(HtmlAttr.ALT) &amp;&amp; !hasContent());
<span class="line-modified"> 896             case LINK:</span>
 897                 return (hasAttr(HtmlAttr.HREF) &amp;&amp; !hasContent());
<span class="line-modified"> 898             case META:</span>
 899                 return (hasAttr(HtmlAttr.CONTENT) &amp;&amp; !hasContent());
<span class="line-modified"> 900             case SCRIPT:</span>
 901                 return ((hasAttr(HtmlAttr.TYPE) &amp;&amp; hasAttr(HtmlAttr.SRC) &amp;&amp; !hasContent()) ||
 902                         (hasAttr(HtmlAttr.TYPE) &amp;&amp; hasContent()));
<span class="line-modified"> 903             case SPAN:</span>
 904                 return (hasAttr(HtmlAttr.ID) || hasContent());
 905             default :
 906                 return hasContent();
 907         }
 908     }
 909 
 910     /**
<span class="line-modified"> 911      * Returns true if the element is a normal element that is &lt;em&gt;phrasing content&lt;/em&gt;.</span>
 912      *
 913      * @return true if the HTML tag is an inline element
<span class="line-added"> 914      *</span>
<span class="line-added"> 915      * @see &lt;a href=&quot;https://www.w3.org/TR/html51/dom.html#kinds-of-content-phrasing-content&quot;&gt;Phrasing Content&lt;/a&gt;</span>
 916      */
 917     public boolean isInline() {
<span class="line-modified"> 918         switch (tagName) {</span>
<span class="line-added"> 919             case A: case BUTTON: case BR: case CODE: case EM: case I: case IMG:</span>
<span class="line-added"> 920             case LABEL: case SMALL: case SPAN: case STRONG: case SUB:</span>
<span class="line-added"> 921                 return true;</span>
<span class="line-added"> 922             default:</span>
<span class="line-added"> 923                 return false;</span>
<span class="line-added"> 924         }</span>
<span class="line-added"> 925     }</span>
<span class="line-added"> 926 </span>
<span class="line-added"> 927     /**</span>
<span class="line-added"> 928      * Returns whether or not this is a &lt;em&gt;void&lt;/em&gt; element.</span>
<span class="line-added"> 929      *</span>
<span class="line-added"> 930      * @return whether or not this is a void element</span>
<span class="line-added"> 931      *</span>
<span class="line-added"> 932      * @see &lt;a href=&quot;https://www.w3.org/TR/html51/syntax.html#void-elements&quot;&gt;Void Elements&lt;/a&gt;</span>
<span class="line-added"> 933      */</span>
<span class="line-added"> 934     public boolean isVoid() {</span>
<span class="line-added"> 935         switch (tagName) {</span>
<span class="line-added"> 936             case BR: case HR: case IMG: case INPUT: case LINK: case META:</span>
<span class="line-added"> 937                 return true;</span>
<span class="line-added"> 938             default:</span>
<span class="line-added"> 939                 return false;</span>
<span class="line-added"> 940         }</span>
 941     }
 942 
 943     @Override
 944     public boolean write(Writer out, boolean atNewline) throws IOException {
<span class="line-modified"> 945         boolean isInline = isInline();</span>
<span class="line-added"> 946         if (!isInline &amp;&amp; !atNewline)</span>
 947             out.write(DocletConstants.NL);
<span class="line-modified"> 948         String tagString = tagName.toString();</span>
 949         out.write(&quot;&lt;&quot;);
 950         out.write(tagString);
 951         Iterator&lt;HtmlAttr&gt; iterator = attrs.keySet().iterator();
 952         HtmlAttr key;
 953         String value;
 954         while (iterator.hasNext()) {
 955             key = iterator.next();
 956             value = attrs.get(key);
 957             out.write(&quot; &quot;);
 958             out.write(key.toString());
 959             if (!value.isEmpty()) {
 960                 out.write(&quot;=\&quot;&quot;);
 961                 out.write(value);
 962                 out.write(&quot;\&quot;&quot;);
 963             }
 964         }
 965         out.write(&quot;&gt;&quot;);
 966         boolean nl = false;
 967         for (Content c : content)
 968             nl = c.write(out, nl);
<span class="line-modified"> 969         if (!isVoid()) {</span>
 970             out.write(&quot;&lt;/&quot;);
 971             out.write(tagString);
 972             out.write(&quot;&gt;&quot;);
 973         }
<span class="line-modified"> 974         if (!isInline) {</span>
 975             out.write(DocletConstants.NL);
 976             return true;
 977         } else {
 978             return false;
 979         }
 980     }
 981 
 982     /**
 983      * Given a Content node, strips all html characters and
 984      * return the result.
 985      *
 986      * @param body The content node to check.
 987      * @return the plain text from the content node
 988      *
 989      */
 990     private static String stripHtml(Content body) {
 991         String rawString = body.toString();
 992         // remove HTML tags
<span class="line-modified"> 993         rawString = rawString.replaceAll(&quot;&lt;.*?&gt;&quot;, &quot; &quot;);</span>
 994         // consolidate multiple spaces between a word to a single space
 995         rawString = rawString.replaceAll(&quot;\\b\\s{2,}\\b&quot;, &quot; &quot;);
 996         // remove extra whitespaces
 997         return rawString.trim();
 998     }
 999 }
</pre>
</td>
</tr>
</table>
<center><a href="HtmlStyle.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="RawHtml.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>