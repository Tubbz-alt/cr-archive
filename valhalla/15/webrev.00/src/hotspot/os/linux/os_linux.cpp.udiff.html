<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/os/linux/os_linux.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="cgroupSubsystem_linux.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../solaris/os_solaris.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/os/linux/os_linux.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -2300,10 +2300,23 @@</span>
  
  void os::Linux::print_full_memory_info(outputStream* st) {
    st-&gt;print(&quot;\n/proc/meminfo:\n&quot;);
    _print_ascii_file(&quot;/proc/meminfo&quot;, st);
    st-&gt;cr();
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   // some information regarding THPs; for details see</span>
<span class="udiff-line-added">+   // https://www.kernel.org/doc/Documentation/vm/transhuge.txt</span>
<span class="udiff-line-added">+   st-&gt;print_cr(&quot;/sys/kernel/mm/transparent_hugepage/enabled:&quot;);</span>
<span class="udiff-line-added">+   if (!_print_ascii_file(&quot;/sys/kernel/mm/transparent_hugepage/enabled&quot;, st)) {</span>
<span class="udiff-line-added">+     st-&gt;print_cr(&quot;  &lt;Not Available&gt;&quot;);</span>
<span class="udiff-line-added">+   }</span>
<span class="udiff-line-added">+   st-&gt;cr();</span>
<span class="udiff-line-added">+   st-&gt;print_cr(&quot;/sys/kernel/mm/transparent_hugepage/defrag (defrag/compaction efforts parameter):&quot;);</span>
<span class="udiff-line-added">+   if (!_print_ascii_file(&quot;/sys/kernel/mm/transparent_hugepage/defrag&quot;, st)) {</span>
<span class="udiff-line-added">+     st-&gt;print_cr(&quot;  &lt;Not Available&gt;&quot;);</span>
<span class="udiff-line-added">+   }</span>
<span class="udiff-line-added">+   st-&gt;cr();</span>
  }
  
  void os::Linux::print_ld_preload_file(outputStream* st) {
    _print_ascii_file(&quot;/etc/ld.so.preload&quot;, st, &quot;\n/etc/ld.so.preload:&quot;);
    st-&gt;cr();
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -4130,12 +4143,12 @@</span>
    } else {
      return reserve_memory_special_huge_tlbfs_mixed(bytes, alignment, req_addr, exec);
    }
  }
  
<span class="udiff-line-modified-removed">- char* os::reserve_memory_special(size_t bytes, size_t alignment,</span>
<span class="udiff-line-modified-removed">-                                  char* req_addr, bool exec) {</span>
<span class="udiff-line-modified-added">+ char* os::pd_reserve_memory_special(size_t bytes, size_t alignment,</span>
<span class="udiff-line-modified-added">+                                     char* req_addr, bool exec) {</span>
    assert(UseLargePages, &quot;only for large pages&quot;);
  
    char* addr;
    if (UseSHM) {
      addr = os::Linux::reserve_memory_special_shm(bytes, alignment, req_addr, exec);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -4146,13 +4159,10 @@</span>
  
    if (addr != NULL) {
      if (UseNUMAInterleaving) {
        numa_make_global(addr, bytes);
      }
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     // The memory is committed</span>
<span class="udiff-line-removed">-     MemTracker::record_virtual_memory_reserve_and_commit((address)addr, bytes, CALLER_PC);</span>
    }
  
    return addr;
  }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -4163,26 +4173,11 @@</span>
  
  bool os::Linux::release_memory_special_huge_tlbfs(char* base, size_t bytes) {
    return pd_release_memory(base, bytes);
  }
  
<span class="udiff-line-modified-removed">- bool os::release_memory_special(char* base, size_t bytes) {</span>
<span class="udiff-line-removed">-   bool res;</span>
<span class="udiff-line-removed">-   if (MemTracker::tracking_level() &gt; NMT_minimal) {</span>
<span class="udiff-line-removed">-     Tracker tkr(Tracker::release);</span>
<span class="udiff-line-removed">-     res = os::Linux::release_memory_special_impl(base, bytes);</span>
<span class="udiff-line-removed">-     if (res) {</span>
<span class="udiff-line-removed">-       tkr.record((address)base, bytes);</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-   } else {</span>
<span class="udiff-line-removed">-     res = os::Linux::release_memory_special_impl(base, bytes);</span>
<span class="udiff-line-removed">-   }</span>
<span class="udiff-line-removed">-   return res;</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- bool os::Linux::release_memory_special_impl(char* base, size_t bytes) {</span>
<span class="udiff-line-modified-added">+ bool os::pd_release_memory_special(char* base, size_t bytes) {</span>
    assert(UseLargePages, &quot;only for large pages&quot;);
    bool res;
  
    if (UseSHM) {
      res = os::Linux::release_memory_special_shm(base, bytes);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -4317,11 +4312,11 @@</span>
  };
  
  static int prio_init() {
    if (ThreadPriorityPolicy == 1) {
      if (geteuid() != 0) {
<span class="udiff-line-modified-removed">-       if (!FLAG_IS_DEFAULT(ThreadPriorityPolicy)) {</span>
<span class="udiff-line-modified-added">+       if (!FLAG_IS_DEFAULT(ThreadPriorityPolicy) &amp;&amp; !FLAG_IS_JIMAGE_RESOURCE(ThreadPriorityPolicy)) {</span>
          warning(&quot;-XX:ThreadPriorityPolicy=1 may require system level permission, &quot; \
                  &quot;e.g., being the root user. If the necessary permission is not &quot; \
                  &quot;possessed, changes to priority will be silently ignored.&quot;);
        }
      }
</pre>
<center><a href="cgroupSubsystem_linux.hpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../solaris/os_solaris.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>