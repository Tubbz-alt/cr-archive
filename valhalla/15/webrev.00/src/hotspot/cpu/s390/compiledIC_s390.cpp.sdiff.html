<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/cpu/s390/compiledIC_s390.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../ppc/vm_version_ppc.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="macroAssembler_s390.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/s390/compiledIC_s390.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 37 
 38 // ----------------------------------------------------------------------------
 39 
 40 #undef  __
 41 #define __ _masm.
 42 
 43 address CompiledStaticCall::emit_to_interp_stub(CodeBuffer &amp;cbuf, address mark/* = NULL*/) {
 44 #ifdef COMPILER2
 45   // Stub is fixed up when the corresponding call is converted from calling
 46   // compiled code to calling interpreted code.
 47   if (mark == NULL) {
 48     // Get the mark within main instrs section which is set to the address of the call.
 49     mark = cbuf.insts_mark();
 50   }
 51   assert(mark != NULL, &quot;mark must not be NULL&quot;);
 52 
 53   // Note that the code buffer&#39;s insts_mark is always relative to insts.
 54   // That&#39;s why we must use the macroassembler to generate a stub.
 55   MacroAssembler _masm(&amp;cbuf);
 56 
<span class="line-modified"> 57   address stub = __ start_a_stub(Compile::MAX_stubs_size);</span>
 58   if (stub == NULL) {
 59     return NULL;  // CodeBuffer::expand failed.
 60   }
 61   __ relocate(static_stub_Relocation::spec(mark));
 62 
 63   AddressLiteral meta = __ allocate_metadata_address(NULL);
 64   bool success = __ load_const_from_toc(as_Register(Matcher::inline_cache_reg_encode()), meta);
 65 
 66   __ set_inst_mark();
 67   AddressLiteral a((address)-1);
 68   success = success &amp;&amp; __ load_const_from_toc(Z_R1, a);
 69   if (!success) {
 70     return NULL;  // CodeCache is full.
 71   }
 72 
 73   __ z_br(Z_R1);
 74   __ end_a_stub(); // Update current stubs pointer and restore insts_end.
 75   return stub;
 76 #else
 77   ShouldNotReachHere();
</pre>
</td>
<td>
<hr />
<pre>
 37 
 38 // ----------------------------------------------------------------------------
 39 
 40 #undef  __
 41 #define __ _masm.
 42 
 43 address CompiledStaticCall::emit_to_interp_stub(CodeBuffer &amp;cbuf, address mark/* = NULL*/) {
 44 #ifdef COMPILER2
 45   // Stub is fixed up when the corresponding call is converted from calling
 46   // compiled code to calling interpreted code.
 47   if (mark == NULL) {
 48     // Get the mark within main instrs section which is set to the address of the call.
 49     mark = cbuf.insts_mark();
 50   }
 51   assert(mark != NULL, &quot;mark must not be NULL&quot;);
 52 
 53   // Note that the code buffer&#39;s insts_mark is always relative to insts.
 54   // That&#39;s why we must use the macroassembler to generate a stub.
 55   MacroAssembler _masm(&amp;cbuf);
 56 
<span class="line-modified"> 57   address stub = __ start_a_stub(CompiledStaticCall::to_interp_stub_size());</span>
 58   if (stub == NULL) {
 59     return NULL;  // CodeBuffer::expand failed.
 60   }
 61   __ relocate(static_stub_Relocation::spec(mark));
 62 
 63   AddressLiteral meta = __ allocate_metadata_address(NULL);
 64   bool success = __ load_const_from_toc(as_Register(Matcher::inline_cache_reg_encode()), meta);
 65 
 66   __ set_inst_mark();
 67   AddressLiteral a((address)-1);
 68   success = success &amp;&amp; __ load_const_from_toc(Z_R1, a);
 69   if (!success) {
 70     return NULL;  // CodeCache is full.
 71   }
 72 
 73   __ z_br(Z_R1);
 74   __ end_a_stub(); // Update current stubs pointer and restore insts_end.
 75   return stub;
 76 #else
 77   ShouldNotReachHere();
</pre>
</td>
</tr>
</table>
<center><a href="../ppc/vm_version_ppc.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="macroAssembler_s390.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>