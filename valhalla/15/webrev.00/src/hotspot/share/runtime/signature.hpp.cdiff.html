<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/runtime/signature.hpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="signature.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="thread.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/runtime/signature.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 625,10 ***</span>
<span class="line-new-header">--- 625,56 ---</span>
  class SigEntryFilter {
  public:
    bool operator()(const SigEntry&amp; entry) { return entry._bt != T_VALUETYPE &amp;&amp; entry._bt != T_VOID; }
  };
  
<span class="line-added">+ // Specialized SignatureStream: used for invoking SystemDictionary to either find</span>
<span class="line-added">+ //                              or resolve the underlying type when iterating over a</span>
<span class="line-added">+ //                              Java descriptor (or parts of it).</span>
<span class="line-added">+ class ResolvingSignatureStream : public SignatureStream {</span>
<span class="line-added">+   Klass*       _load_origin;</span>
<span class="line-added">+   bool         _handles_cached;</span>
<span class="line-added">+   Handle       _class_loader;       // cached when needed</span>
<span class="line-added">+   Handle       _protection_domain;  // cached when needed</span>
<span class="line-added">+ </span>
<span class="line-added">+   void initialize_load_origin(Klass* load_origin) {</span>
<span class="line-added">+     _load_origin = load_origin;</span>
<span class="line-added">+     _handles_cached = (load_origin == NULL);</span>
<span class="line-added">+   }</span>
<span class="line-added">+   void need_handles(TRAPS) {</span>
<span class="line-added">+     if (!_handles_cached) {</span>
<span class="line-added">+       cache_handles(THREAD);</span>
<span class="line-added">+       _handles_cached = true;</span>
<span class="line-added">+     }</span>
<span class="line-added">+   }</span>
<span class="line-added">+   void cache_handles(TRAPS);</span>
<span class="line-added">+ </span>
<span class="line-added">+  public:</span>
<span class="line-added">+   ResolvingSignatureStream(Symbol* signature, Klass* load_origin, bool is_method = true);</span>
<span class="line-added">+   ResolvingSignatureStream(Symbol* signature, Handle class_loader, Handle protection_domain, bool is_method = true);</span>
<span class="line-added">+   ResolvingSignatureStream(const Method* method);</span>
<span class="line-added">+   ResolvingSignatureStream(fieldDescriptor&amp; field);</span>
<span class="line-added">+ </span>
<span class="line-added">+   Klass* load_origin()            { return _load_origin; }</span>
<span class="line-added">+   Handle class_loader(TRAPS)      { need_handles(THREAD); return _class_loader; }</span>
<span class="line-added">+   Handle protection_domain(TRAPS) { need_handles(THREAD); return _protection_domain; }</span>
<span class="line-added">+ </span>
<span class="line-added">+   Klass* as_klass_if_loaded(TRAPS);</span>
<span class="line-added">+   Klass* as_klass(FailureMode failure_mode, TRAPS) {</span>
<span class="line-added">+     need_handles(THREAD);</span>
<span class="line-added">+     return SignatureStream::as_klass(_class_loader, _protection_domain,</span>
<span class="line-added">+                                      failure_mode, THREAD);</span>
<span class="line-added">+   }</span>
<span class="line-added">+   oop as_java_mirror(FailureMode failure_mode, TRAPS) {</span>
<span class="line-added">+     if (is_reference()) {</span>
<span class="line-added">+       need_handles(THREAD);</span>
<span class="line-added">+     }</span>
<span class="line-added">+     return SignatureStream::as_java_mirror(_class_loader, _protection_domain,</span>
<span class="line-added">+                                            failure_mode, THREAD);</span>
<span class="line-added">+   }</span>
<span class="line-added">+ };</span>
<span class="line-added">+ </span>
  // Here is how all the SignatureIterator classes invoke the
  // SignatureStream engine to do their parsing.
  template&lt;typename T&gt; inline
  void SignatureIterator::do_parameters_on(T* callback) {
    fingerprint_t unaccumulator = _fingerprint;
</pre>
<center><a href="signature.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="thread.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>