<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/memory/universe.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="metaspaceShared.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../oops/arrayKlass.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/memory/universe.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 845   initialize_known_method(_is_substitutable_cache,
 846                           SystemDictionary::ValueBootstrapMethods_klass(),
 847                           vmSymbols::isSubstitutable_name()-&gt;as_C_string(),
 848                           vmSymbols::object_object_boolean_signature(), true, CHECK);
 849 }
 850 
 851 void universe2_init() {
 852   EXCEPTION_MARK;
 853   Universe::genesis(CATCH);
 854 }
 855 
 856 // Set after initialization of the module runtime, call_initModuleRuntime
 857 void universe_post_module_init() {
 858   Universe::_module_initialized = true;
 859 }
 860 
 861 bool universe_post_init() {
 862   assert(!is_init_completed(), &quot;Error: initialization not yet completed!&quot;);
 863   Universe::_fully_initialized = true;
 864   EXCEPTION_MARK;
<span class="line-modified"> 865   { ResourceMark rm;</span>
<span class="line-modified"> 866     Interpreter::initialize();      // needed for interpreter entry points</span>
<span class="line-modified"> 867     if (!UseSharedSpaces) {</span>
<span class="line-modified"> 868       Universe::reinitialize_vtables(CHECK_false);</span>
<span class="line-removed"> 869       Universe::reinitialize_itables(CHECK_false);</span>
<span class="line-removed"> 870     }</span>
 871   }
 872 
 873   HandleMark hm(THREAD);
 874   // Setup preallocated empty java.lang.Class array
 875   Universe::_the_empty_class_klass_array = oopFactory::new_objArray(SystemDictionary::Class_klass(), 0, CHECK_false);
 876 
 877   // Setup preallocated OutOfMemoryError errors
<span class="line-modified"> 878   Klass* k = SystemDictionary::resolve_or_fail(vmSymbols::java_lang_OutOfMemoryError(), true, CHECK_false);</span>
 879   InstanceKlass* ik = InstanceKlass::cast(k);
 880   Universe::_out_of_memory_error_java_heap = ik-&gt;allocate_instance(CHECK_false);
 881   Universe::_out_of_memory_error_metaspace = ik-&gt;allocate_instance(CHECK_false);
 882   Universe::_out_of_memory_error_class_metaspace = ik-&gt;allocate_instance(CHECK_false);
 883   Universe::_out_of_memory_error_array_size = ik-&gt;allocate_instance(CHECK_false);
 884   Universe::_out_of_memory_error_gc_overhead_limit =
 885     ik-&gt;allocate_instance(CHECK_false);
 886   Universe::_out_of_memory_error_realloc_objects = ik-&gt;allocate_instance(CHECK_false);
 887   Universe::_out_of_memory_error_retry = ik-&gt;allocate_instance(CHECK_false);
 888 
 889   // Setup preallocated cause message for delayed StackOverflowError
 890   if (StackReservedPages &gt; 0) {
 891     Universe::_delayed_stack_overflow_error_message =
 892       java_lang_String::create_oop_from_str(&quot;Delayed StackOverflowError due to ReservedStackAccess annotated method&quot;, CHECK_false);
 893   }
 894 
 895   // Setup preallocated NullPointerException
 896   // (this is currently used for a cheap &amp; dirty solution in compiler exception handling)
 897   k = SystemDictionary::resolve_or_fail(vmSymbols::java_lang_NullPointerException(), true, CHECK_false);
 898   Universe::_null_ptr_exception_instance = InstanceKlass::cast(k)-&gt;allocate_instance(CHECK_false);
 899   // Setup preallocated ArithmeticException
 900   // (this is currently used for a cheap &amp; dirty solution in compiler exception handling)
 901   k = SystemDictionary::resolve_or_fail(vmSymbols::java_lang_ArithmeticException(), true, CHECK_false);
 902   Universe::_arithmetic_exception_instance = InstanceKlass::cast(k)-&gt;allocate_instance(CHECK_false);
 903   // Virtual Machine Error for when we get into a situation we can&#39;t resolve
<span class="line-modified"> 904   k = SystemDictionary::resolve_or_fail(</span>
<span class="line-removed"> 905     vmSymbols::java_lang_VirtualMachineError(), true, CHECK_false);</span>
 906   bool linked = InstanceKlass::cast(k)-&gt;link_class_or_fail(CHECK_false);
 907   if (!linked) {
 908      tty-&gt;print_cr(&quot;Unable to link/verify VirtualMachineError class&quot;);
 909      return false; // initialization failed
 910   }
 911   Universe::_virtual_machine_error_instance =
 912     InstanceKlass::cast(k)-&gt;allocate_instance(CHECK_false);
 913 
 914   Universe::_vm_exception = InstanceKlass::cast(k)-&gt;allocate_instance(CHECK_false);
 915 
 916   Handle msg = java_lang_String::create_from_str(&quot;Java heap space&quot;, CHECK_false);
 917   java_lang_Throwable::set_message(Universe::_out_of_memory_error_java_heap, msg());
 918 
 919   msg = java_lang_String::create_from_str(&quot;Metaspace&quot;, CHECK_false);
 920   java_lang_Throwable::set_message(Universe::_out_of_memory_error_metaspace, msg());
 921   msg = java_lang_String::create_from_str(&quot;Compressed class space&quot;, CHECK_false);
 922   java_lang_Throwable::set_message(Universe::_out_of_memory_error_class_metaspace, msg());
 923 
 924   msg = java_lang_String::create_from_str(&quot;Requested array size exceeds VM limit&quot;, CHECK_false);
 925   java_lang_Throwable::set_message(Universe::_out_of_memory_error_array_size, msg());
</pre>
</td>
<td>
<hr />
<pre>
 845   initialize_known_method(_is_substitutable_cache,
 846                           SystemDictionary::ValueBootstrapMethods_klass(),
 847                           vmSymbols::isSubstitutable_name()-&gt;as_C_string(),
 848                           vmSymbols::object_object_boolean_signature(), true, CHECK);
 849 }
 850 
 851 void universe2_init() {
 852   EXCEPTION_MARK;
 853   Universe::genesis(CATCH);
 854 }
 855 
 856 // Set after initialization of the module runtime, call_initModuleRuntime
 857 void universe_post_module_init() {
 858   Universe::_module_initialized = true;
 859 }
 860 
 861 bool universe_post_init() {
 862   assert(!is_init_completed(), &quot;Error: initialization not yet completed!&quot;);
 863   Universe::_fully_initialized = true;
 864   EXCEPTION_MARK;
<span class="line-modified"> 865   if (!UseSharedSpaces) {</span>
<span class="line-modified"> 866     ResourceMark rm;</span>
<span class="line-modified"> 867     Universe::reinitialize_vtables(CHECK_false);</span>
<span class="line-modified"> 868     Universe::reinitialize_itables(CHECK_false);</span>


 869   }
 870 
 871   HandleMark hm(THREAD);
 872   // Setup preallocated empty java.lang.Class array
 873   Universe::_the_empty_class_klass_array = oopFactory::new_objArray(SystemDictionary::Class_klass(), 0, CHECK_false);
 874 
 875   // Setup preallocated OutOfMemoryError errors
<span class="line-modified"> 876   Klass* k = SystemDictionary::OutOfMemoryError_klass();</span>
 877   InstanceKlass* ik = InstanceKlass::cast(k);
 878   Universe::_out_of_memory_error_java_heap = ik-&gt;allocate_instance(CHECK_false);
 879   Universe::_out_of_memory_error_metaspace = ik-&gt;allocate_instance(CHECK_false);
 880   Universe::_out_of_memory_error_class_metaspace = ik-&gt;allocate_instance(CHECK_false);
 881   Universe::_out_of_memory_error_array_size = ik-&gt;allocate_instance(CHECK_false);
 882   Universe::_out_of_memory_error_gc_overhead_limit =
 883     ik-&gt;allocate_instance(CHECK_false);
 884   Universe::_out_of_memory_error_realloc_objects = ik-&gt;allocate_instance(CHECK_false);
 885   Universe::_out_of_memory_error_retry = ik-&gt;allocate_instance(CHECK_false);
 886 
 887   // Setup preallocated cause message for delayed StackOverflowError
 888   if (StackReservedPages &gt; 0) {
 889     Universe::_delayed_stack_overflow_error_message =
 890       java_lang_String::create_oop_from_str(&quot;Delayed StackOverflowError due to ReservedStackAccess annotated method&quot;, CHECK_false);
 891   }
 892 
 893   // Setup preallocated NullPointerException
 894   // (this is currently used for a cheap &amp; dirty solution in compiler exception handling)
 895   k = SystemDictionary::resolve_or_fail(vmSymbols::java_lang_NullPointerException(), true, CHECK_false);
 896   Universe::_null_ptr_exception_instance = InstanceKlass::cast(k)-&gt;allocate_instance(CHECK_false);
 897   // Setup preallocated ArithmeticException
 898   // (this is currently used for a cheap &amp; dirty solution in compiler exception handling)
 899   k = SystemDictionary::resolve_or_fail(vmSymbols::java_lang_ArithmeticException(), true, CHECK_false);
 900   Universe::_arithmetic_exception_instance = InstanceKlass::cast(k)-&gt;allocate_instance(CHECK_false);
 901   // Virtual Machine Error for when we get into a situation we can&#39;t resolve
<span class="line-modified"> 902   k = SystemDictionary::VirtualMachineError_klass();</span>

 903   bool linked = InstanceKlass::cast(k)-&gt;link_class_or_fail(CHECK_false);
 904   if (!linked) {
 905      tty-&gt;print_cr(&quot;Unable to link/verify VirtualMachineError class&quot;);
 906      return false; // initialization failed
 907   }
 908   Universe::_virtual_machine_error_instance =
 909     InstanceKlass::cast(k)-&gt;allocate_instance(CHECK_false);
 910 
 911   Universe::_vm_exception = InstanceKlass::cast(k)-&gt;allocate_instance(CHECK_false);
 912 
 913   Handle msg = java_lang_String::create_from_str(&quot;Java heap space&quot;, CHECK_false);
 914   java_lang_Throwable::set_message(Universe::_out_of_memory_error_java_heap, msg());
 915 
 916   msg = java_lang_String::create_from_str(&quot;Metaspace&quot;, CHECK_false);
 917   java_lang_Throwable::set_message(Universe::_out_of_memory_error_metaspace, msg());
 918   msg = java_lang_String::create_from_str(&quot;Compressed class space&quot;, CHECK_false);
 919   java_lang_Throwable::set_message(Universe::_out_of_memory_error_class_metaspace, msg());
 920 
 921   msg = java_lang_String::create_from_str(&quot;Requested array size exceeds VM limit&quot;, CHECK_false);
 922   java_lang_Throwable::set_message(Universe::_out_of_memory_error_array_size, msg());
</pre>
</td>
</tr>
</table>
<center><a href="metaspaceShared.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../oops/arrayKlass.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>