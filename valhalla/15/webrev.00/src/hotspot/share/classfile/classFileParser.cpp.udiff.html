<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/hotspot/share/classfile/classFileParser.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../ci/ciEnv.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="classListParser.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/classfile/classFileParser.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -5682,11 +5682,11 @@</span>
            int newlen = c - (char*) signature;
            bool legal = verify_unqualified_name(signature, newlen, LegalClass);
            if (!legal) {
              classfile_parse_error(&quot;Class name is empty or contains illegal character &quot;
                                    &quot;in descriptor in class file %s&quot;,
<span class="udiff-line-modified-removed">-                                   CHECK_0);</span>
<span class="udiff-line-modified-added">+                                   CHECK_NULL);</span>
              return NULL;
            }
            return signature + newlen + 1;
          }
        }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -5694,11 +5694,11 @@</span>
      }
      case JVM_SIGNATURE_ARRAY:
        array_dim++;
        if (array_dim &gt; 255) {
          // 4277370: array descriptor is valid only if it represents 255 or fewer dimensions.
<span class="udiff-line-modified-removed">-         classfile_parse_error(&quot;Array type descriptor has more than 255 dimensions in class file %s&quot;, CHECK_0);</span>
<span class="udiff-line-modified-added">+         classfile_parse_error(&quot;Array type descriptor has more than 255 dimensions in class file %s&quot;, CHECK_NULL);</span>
        }
        // The rest of what&#39;s there better be a legal signature
        signature++;
        length--;
        void_ok = false;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -6354,20 +6354,20 @@</span>
  // its _class_name field.
  void ClassFileParser::prepend_host_package_name(const InstanceKlass* unsafe_anonymous_host, TRAPS) {
    ResourceMark rm(THREAD);
    assert(strrchr(_class_name-&gt;as_C_string(), JVM_SIGNATURE_SLASH) == NULL,
           &quot;Unsafe anonymous class should not be in a package&quot;);
<span class="udiff-line-modified-removed">-   const char* host_pkg_name =</span>
<span class="udiff-line-modified-removed">-     ClassLoader::package_from_name(unsafe_anonymous_host-&gt;name()-&gt;as_C_string(), NULL);</span>
<span class="udiff-line-modified-added">+   TempNewSymbol host_pkg_name =</span>
<span class="udiff-line-modified-added">+     ClassLoader::package_from_class_name(unsafe_anonymous_host-&gt;name());</span>
  
    if (host_pkg_name != NULL) {
<span class="udiff-line-modified-removed">-     int host_pkg_len = (int)strlen(host_pkg_name);</span>
<span class="udiff-line-modified-added">+     int host_pkg_len = host_pkg_name-&gt;utf8_length();</span>
      int class_name_len = _class_name-&gt;utf8_length();
      int symbol_len = host_pkg_len + 1 + class_name_len;
      char* new_anon_name = NEW_RESOURCE_ARRAY(char, symbol_len + 1);
<span class="udiff-line-modified-removed">-     int n = os::snprintf(new_anon_name, symbol_len + 1, &quot;%s/%.*s&quot;,</span>
<span class="udiff-line-modified-removed">-                          host_pkg_name, class_name_len, _class_name-&gt;base());</span>
<span class="udiff-line-modified-added">+     int n = os::snprintf(new_anon_name, symbol_len + 1, &quot;%.*s/%.*s&quot;,</span>
<span class="udiff-line-modified-added">+                          host_pkg_len, host_pkg_name-&gt;base(), class_name_len, _class_name-&gt;base());</span>
      assert(n == symbol_len, &quot;Unexpected number of characters in string&quot;);
  
      // Decrement old _class_name to avoid leaking.
      _class_name-&gt;decrement_refcount();
  
</pre>
<center><a href="../ci/ciEnv.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="classListParser.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>