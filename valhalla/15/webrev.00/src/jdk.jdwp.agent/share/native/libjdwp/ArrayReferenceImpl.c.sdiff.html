<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.jdwp.agent/share/native/libjdwp/ArrayReferenceImpl.c</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../jdk.jdi/share/native/libdt_shmem/shmemBase.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="ThreadGroupReferenceImpl.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.jdwp.agent/share/native/libjdwp/ArrayReferenceImpl.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
396 
397 static jdwpError
398 readIntComponents(JNIEnv *env, PacketInputStream *in,
399                    jarray array, int index, int length)
400 {
401     int i;
402     jint component;
403 
404     for (i = 0; (i &lt; length) &amp;&amp; !inStream_error(in); i++) {
405         component = inStream_readInt(in);
406         JNI_FUNC_PTR(env,SetIntArrayRegion)(env, array, index + i, 1, &amp;component);
407     }
408     return inStream_error(in);
409 }
410 
411 static jdwpError
412 readLongComponents(JNIEnv *env, PacketInputStream *in,
413                    jarray array, int index, int length)
414 {
415     int i;



416     jlong component;
417 
418     for (i = 0; (i &lt; length) &amp;&amp; !inStream_error(in); i++) {
419         component = inStream_readLong(in);
420         JNI_FUNC_PTR(env,SetLongArrayRegion)(env, array, index + i, 1, &amp;component);
421     }
422     return inStream_error(in);
423 }
424 
425 static jdwpError
426 readFloatComponents(JNIEnv *env, PacketInputStream *in,
427                    jarray array, int index, int length)
428 {
429     int i;
430     jfloat component;
431 
432     for (i = 0; (i &lt; length) &amp;&amp; !inStream_error(in); i++) {
433         component = inStream_readFloat(in);
434         JNI_FUNC_PTR(env,SetFloatArrayRegion)(env, array, index + i, 1, &amp;component);
435     }
436     return inStream_error(in);
437 }
438 
439 static jdwpError
440 readDoubleComponents(JNIEnv *env, PacketInputStream *in,
441                    jarray array, int index, int length)
442 {
443     int i;



444     jdouble component;
445 
446     for (i = 0; (i &lt; length) &amp;&amp; !inStream_error(in); i++) {
447         component = inStream_readDouble(in);
448         JNI_FUNC_PTR(env,SetDoubleArrayRegion)(env, array, index + i, 1, &amp;component);
449     }
450     return inStream_error(in);
451 }
452 
453 
454 static jdwpError
455 readObjectComponents(JNIEnv *env, PacketInputStream *in,
456                    jarray array, int index, int length)
457                    /* char *componentSignature) */
458 {
459     int i;
460 
461     for (i = 0; i &lt; length; i++) {
462         jobject object = inStream_readObjectRef(env, in);
463 
</pre>
<hr />
<pre>
507         return JNI_TRUE;
508     }
509 
510     WITH_LOCAL_REFS(env, 1)  {
511 
512         jclass arrayClass;
513         char *signature = NULL;
514         char *componentSignature;
515         jvmtiError error;
516 
517         arrayClass = JNI_FUNC_PTR(env,GetObjectClass)(env, array);
518         error = classSignature(arrayClass, &amp;signature, NULL);
519         if (error != JVMTI_ERROR_NONE) {
520             goto err;
521         }
522         componentSignature = &amp;signature[1];
523 
524         switch (componentSignature[0]) {
525             case JDWP_TAG(OBJECT):
526             case JDWP_TAG(ARRAY):
<span class="line-modified">527 	    case JDWP_TAG(INLINE_OBJECT):</span>
528                 serror = readObjectComponents(env, in, array, index, length);
529                 break;
530 
531             case JDWP_TAG(BYTE):
532                 serror = readByteComponents(env, in, array, index, length);
533                 break;
534 
535             case JDWP_TAG(CHAR):
536                 serror = readCharComponents(env, in, array, index, length);
537                 break;
538 
539             case JDWP_TAG(FLOAT):
540                 serror = readFloatComponents(env, in, array, index, length);
541                 break;
542 
543             case JDWP_TAG(DOUBLE):
544                 serror = readDoubleComponents(env, in, array, index, length);
545                 break;
546 
547             case JDWP_TAG(INT):
</pre>
</td>
<td>
<hr />
<pre>
396 
397 static jdwpError
398 readIntComponents(JNIEnv *env, PacketInputStream *in,
399                    jarray array, int index, int length)
400 {
401     int i;
402     jint component;
403 
404     for (i = 0; (i &lt; length) &amp;&amp; !inStream_error(in); i++) {
405         component = inStream_readInt(in);
406         JNI_FUNC_PTR(env,SetIntArrayRegion)(env, array, index + i, 1, &amp;component);
407     }
408     return inStream_error(in);
409 }
410 
411 static jdwpError
412 readLongComponents(JNIEnv *env, PacketInputStream *in,
413                    jarray array, int index, int length)
414 {
415     int i;
<span class="line-added">416 #if defined (_WIN32) &amp;&amp; defined (_MSC_VER)</span>
<span class="line-added">417     __declspec(align(8))</span>
<span class="line-added">418 #endif</span>
419     jlong component;
420 
421     for (i = 0; (i &lt; length) &amp;&amp; !inStream_error(in); i++) {
422         component = inStream_readLong(in);
423         JNI_FUNC_PTR(env,SetLongArrayRegion)(env, array, index + i, 1, &amp;component);
424     }
425     return inStream_error(in);
426 }
427 
428 static jdwpError
429 readFloatComponents(JNIEnv *env, PacketInputStream *in,
430                    jarray array, int index, int length)
431 {
432     int i;
433     jfloat component;
434 
435     for (i = 0; (i &lt; length) &amp;&amp; !inStream_error(in); i++) {
436         component = inStream_readFloat(in);
437         JNI_FUNC_PTR(env,SetFloatArrayRegion)(env, array, index + i, 1, &amp;component);
438     }
439     return inStream_error(in);
440 }
441 
442 static jdwpError
443 readDoubleComponents(JNIEnv *env, PacketInputStream *in,
444                    jarray array, int index, int length)
445 {
446     int i;
<span class="line-added">447 #if defined (_WIN32) &amp;&amp; defined (_MSC_VER)</span>
<span class="line-added">448     __declspec(align(8))</span>
<span class="line-added">449 #endif</span>
450     jdouble component;
451 
452     for (i = 0; (i &lt; length) &amp;&amp; !inStream_error(in); i++) {
453         component = inStream_readDouble(in);
454         JNI_FUNC_PTR(env,SetDoubleArrayRegion)(env, array, index + i, 1, &amp;component);
455     }
456     return inStream_error(in);
457 }
458 
459 
460 static jdwpError
461 readObjectComponents(JNIEnv *env, PacketInputStream *in,
462                    jarray array, int index, int length)
463                    /* char *componentSignature) */
464 {
465     int i;
466 
467     for (i = 0; i &lt; length; i++) {
468         jobject object = inStream_readObjectRef(env, in);
469 
</pre>
<hr />
<pre>
513         return JNI_TRUE;
514     }
515 
516     WITH_LOCAL_REFS(env, 1)  {
517 
518         jclass arrayClass;
519         char *signature = NULL;
520         char *componentSignature;
521         jvmtiError error;
522 
523         arrayClass = JNI_FUNC_PTR(env,GetObjectClass)(env, array);
524         error = classSignature(arrayClass, &amp;signature, NULL);
525         if (error != JVMTI_ERROR_NONE) {
526             goto err;
527         }
528         componentSignature = &amp;signature[1];
529 
530         switch (componentSignature[0]) {
531             case JDWP_TAG(OBJECT):
532             case JDWP_TAG(ARRAY):
<span class="line-modified">533             case JDWP_TAG(INLINE_OBJECT):</span>
534                 serror = readObjectComponents(env, in, array, index, length);
535                 break;
536 
537             case JDWP_TAG(BYTE):
538                 serror = readByteComponents(env, in, array, index, length);
539                 break;
540 
541             case JDWP_TAG(CHAR):
542                 serror = readCharComponents(env, in, array, index, length);
543                 break;
544 
545             case JDWP_TAG(FLOAT):
546                 serror = readFloatComponents(env, in, array, index, length);
547                 break;
548 
549             case JDWP_TAG(DOUBLE):
550                 serror = readDoubleComponents(env, in, array, index, length);
551                 break;
552 
553             case JDWP_TAG(INT):
</pre>
</td>
</tr>
</table>
<center><a href="../../../../jdk.jdi/share/native/libdt_shmem/shmemBase.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="ThreadGroupReferenceImpl.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>