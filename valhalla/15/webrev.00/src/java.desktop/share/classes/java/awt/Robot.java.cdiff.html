<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/share/classes/java/awt/Robot.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="Rectangle.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../javax/swing/JList.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/classes/java/awt/Robot.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 1999, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 1999, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 88,13 ***</span>
       * @see     java.awt.GraphicsEnvironment#isHeadless
       * @see     SecurityManager#checkPermission
       * @see     AWTPermission
       */
      public Robot() throws AWTException {
<span class="line-modified">!         if (GraphicsEnvironment.isHeadless()) {</span>
<span class="line-removed">-             throw new AWTException(&quot;headless environment&quot;);</span>
<span class="line-removed">-         }</span>
          init(GraphicsEnvironment.getLocalGraphicsEnvironment()
              .getDefaultScreenDevice());
      }
  
      /**
<span class="line-new-header">--- 88,11 ---</span>
       * @see     java.awt.GraphicsEnvironment#isHeadless
       * @see     SecurityManager#checkPermission
       * @see     AWTPermission
       */
      public Robot() throws AWTException {
<span class="line-modified">!         checkHeadless();</span>
          init(GraphicsEnvironment.getLocalGraphicsEnvironment()
              .getDefaultScreenDevice());
      }
  
      /**
</pre>
<hr />
<pre>
<span class="line-old-header">*** 123,19 ***</span>
       * @see     GraphicsDevice
       * @see     SecurityManager#checkPermission
       * @see     AWTPermission
       */
      public Robot(GraphicsDevice screen) throws AWTException {
          checkIsScreenDevice(screen);
          init(screen);
      }
  
      private void init(GraphicsDevice screen) throws AWTException {
          checkRobotAllowed();
          Toolkit toolkit = Toolkit.getDefaultToolkit();
          if (toolkit instanceof ComponentFactory) {
<span class="line-modified">!             peer = ((ComponentFactory)toolkit).createRobot(this, screen);</span>
          }
          initLegalButtonMask();
      }
  
      @SuppressWarnings(&quot;deprecation&quot;)
<span class="line-new-header">--- 121,20 ---</span>
       * @see     GraphicsDevice
       * @see     SecurityManager#checkPermission
       * @see     AWTPermission
       */
      public Robot(GraphicsDevice screen) throws AWTException {
<span class="line-added">+         checkHeadless();</span>
          checkIsScreenDevice(screen);
          init(screen);
      }
  
      private void init(GraphicsDevice screen) throws AWTException {
          checkRobotAllowed();
          Toolkit toolkit = Toolkit.getDefaultToolkit();
          if (toolkit instanceof ComponentFactory) {
<span class="line-modified">!             peer = ((ComponentFactory)toolkit).createRobot(screen);</span>
          }
          initLegalButtonMask();
      }
  
      @SuppressWarnings(&quot;deprecation&quot;)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 159,19 ***</span>
              InputEvent.BUTTON3_DOWN_MASK;
          LEGAL_BUTTON_MASK = tmpMask;
      }
  
      /* determine if the security policy allows Robot&#39;s to be created */
<span class="line-modified">!     private void checkRobotAllowed() {</span>
          SecurityManager security = System.getSecurityManager();
          if (security != null) {
              security.checkPermission(AWTPermissions.CREATE_ROBOT_PERMISSION);
          }
      }
  
      /* check if the given device is a screen device */
<span class="line-modified">!     private void checkIsScreenDevice(GraphicsDevice device) {</span>
          if (device == null || device.getType() != GraphicsDevice.TYPE_RASTER_SCREEN) {
              throw new IllegalArgumentException(&quot;not a valid screen device&quot;);
          }
      }
  
<span class="line-new-header">--- 158,28 ---</span>
              InputEvent.BUTTON3_DOWN_MASK;
          LEGAL_BUTTON_MASK = tmpMask;
      }
  
      /* determine if the security policy allows Robot&#39;s to be created */
<span class="line-modified">!     private static void checkRobotAllowed() {</span>
          SecurityManager security = System.getSecurityManager();
          if (security != null) {
              security.checkPermission(AWTPermissions.CREATE_ROBOT_PERMISSION);
          }
      }
  
<span class="line-added">+     /**</span>
<span class="line-added">+      * Check for headless state and throw {@code AWTException} if headless.</span>
<span class="line-added">+      */</span>
<span class="line-added">+     private static void checkHeadless() throws AWTException {</span>
<span class="line-added">+         if (GraphicsEnvironment.isHeadless()) {</span>
<span class="line-added">+             throw new AWTException(&quot;headless environment&quot;);</span>
<span class="line-added">+         }</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      /* check if the given device is a screen device */
<span class="line-modified">!     private static void checkIsScreenDevice(GraphicsDevice device) {</span>
          if (device == null || device.getType() != GraphicsDevice.TYPE_RASTER_SCREEN) {
              throw new IllegalArgumentException(&quot;not a valid screen device&quot;);
          }
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 298,11 ***</span>
          checkButtonsArgument(buttons);
          peer.mouseRelease(buttons);
          afterEvent();
      }
  
<span class="line-modified">!     private void checkButtonsArgument(int buttons) {</span>
          if ( (buttons|LEGAL_BUTTON_MASK) != LEGAL_BUTTON_MASK ) {
              throw new IllegalArgumentException(&quot;Invalid combination of button flags&quot;);
          }
      }
  
<span class="line-new-header">--- 306,11 ---</span>
          checkButtonsArgument(buttons);
          peer.mouseRelease(buttons);
          afterEvent();
      }
  
<span class="line-modified">!     private static void checkButtonsArgument(int buttons) {</span>
          if ( (buttons|LEGAL_BUTTON_MASK) != LEGAL_BUTTON_MASK ) {
              throw new IllegalArgumentException(&quot;Invalid combination of button flags&quot;);
          }
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 357,11 ***</span>
          checkKeycodeArgument(keycode);
          peer.keyRelease(keycode);
          afterEvent();
      }
  
<span class="line-modified">!     private void checkKeycodeArgument(int keycode) {</span>
          // rather than build a big table or switch statement here, we&#39;ll
          // just check that the key isn&#39;t VK_UNDEFINED and assume that the
          // peer implementations will throw an exception for other bogus
          // values e.g. -1, 999999
          if (keycode == KeyEvent.VK_UNDEFINED) {
<span class="line-new-header">--- 365,11 ---</span>
          checkKeycodeArgument(keycode);
          peer.keyRelease(keycode);
          afterEvent();
      }
  
<span class="line-modified">!     private static void checkKeycodeArgument(int keycode) {</span>
          // rather than build a big table or switch statement here, we&#39;ll
          // just check that the key isn&#39;t VK_UNDEFINED and assume that the
          // peer implementations will throw an exception for other bogus
          // values e.g. -1, 999999
          if (keycode == KeyEvent.VK_UNDEFINED) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 662,11 ***</span>
                  thread.interrupt(); // Preserve interrupt status
              }
          }
      }
  
<span class="line-modified">!     private void checkDelayArgument(int ms) {</span>
          if (ms &lt; 0 || ms &gt; MAX_DELAY) {
              throw new IllegalArgumentException(&quot;Delay must be to 0 to 60,000ms&quot;);
          }
      }
  
<span class="line-new-header">--- 670,11 ---</span>
                  thread.interrupt(); // Preserve interrupt status
              }
          }
      }
  
<span class="line-modified">!     private static void checkDelayArgument(int ms) {</span>
          if (ms &lt; 0 || ms &gt; MAX_DELAY) {
              throw new IllegalArgumentException(&quot;Delay must be to 0 to 60,000ms&quot;);
          }
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 678,11 ***</span>
          checkNotDispatchThread();
          SunToolkit.flushPendingEvents();
          ((SunToolkit) Toolkit.getDefaultToolkit()).realSync();
      }
  
<span class="line-modified">!     private void checkNotDispatchThread() {</span>
          if (EventQueue.isDispatchThread()) {
              throw new IllegalThreadStateException(&quot;Cannot call method from the event dispatcher thread&quot;);
          }
      }
  
<span class="line-new-header">--- 686,11 ---</span>
          checkNotDispatchThread();
          SunToolkit.flushPendingEvents();
          ((SunToolkit) Toolkit.getDefaultToolkit()).realSync();
      }
  
<span class="line-modified">!     private static void checkNotDispatchThread() {</span>
          if (EventQueue.isDispatchThread()) {
              throw new IllegalThreadStateException(&quot;Cannot call method from the event dispatcher thread&quot;);
          }
      }
  
</pre>
<center><a href="Rectangle.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../javax/swing/JList.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>