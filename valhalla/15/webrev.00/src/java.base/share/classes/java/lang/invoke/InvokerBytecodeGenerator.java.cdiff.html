<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/java/lang/invoke/InvokerBytecodeGenerator.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="ConstantGroup.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="MethodHandle.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/lang/invoke/InvokerBytecodeGenerator.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2012, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2012, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1150,29 ***</span>
  
          return invokeBasicName;  // return what&#39;s on stack
      }
  
      /**
<span class="line-modified">!       * Emit bytecode for the guardWithCatch idiom.</span>
<span class="line-modified">!       *</span>
<span class="line-modified">!       * The pattern looks like (Cf. MethodHandleImpl.makeGuardWithCatch):</span>
<span class="line-modified">!       * &lt;blockquote&gt;&lt;pre&gt;{@code</span>
<span class="line-modified">!       *  guardWithCatch=Lambda(a0:L,a1:L,a2:L,a3:L,a4:L,a5:L,a6:L,a7:L)=&gt;{</span>
<span class="line-modified">!       *    t8:L=MethodHandle.invokeBasic(a4:L,a6:L,a7:L);</span>
<span class="line-modified">!       *    t9:L=MethodHandleImpl.guardWithCatch(a1:L,a2:L,a3:L,t8:L);</span>
<span class="line-modified">!       *   t10:I=MethodHandle.invokeBasic(a5:L,t9:L);t10:I}</span>
<span class="line-modified">!       * }&lt;/pre&gt;&lt;/blockquote&gt;</span>
<span class="line-modified">!       *</span>
<span class="line-modified">!       * It is compiled into bytecode equivalent of the following code:</span>
<span class="line-modified">!       * &lt;blockquote&gt;&lt;pre&gt;{@code</span>
<span class="line-modified">!       *  try {</span>
<span class="line-modified">!       *      return a1.invokeBasic(a6, a7);</span>
<span class="line-modified">!       *  } catch (Throwable e) {</span>
<span class="line-modified">!       *      if (!a2.isInstance(e)) throw e;</span>
<span class="line-modified">!       *      return a3.invokeBasic(ex, a6, a7);</span>
<span class="line-modified">!       *  }}&lt;/pre&gt;&lt;/blockquote&gt;</span>
<span class="line-modified">!       */</span>
      private Name emitGuardWithCatch(int pos) {
          Name args    = lambdaForm.names[pos];
          Name invoker = lambdaForm.names[pos+1];
          Name result  = lambdaForm.names[pos+2];
  
<span class="line-new-header">--- 1150,29 ---</span>
  
          return invokeBasicName;  // return what&#39;s on stack
      }
  
      /**
<span class="line-modified">!      * Emit bytecode for the guardWithCatch idiom.</span>
<span class="line-modified">!      *</span>
<span class="line-modified">!      * The pattern looks like (Cf. MethodHandleImpl.makeGuardWithCatch):</span>
<span class="line-modified">!      * &lt;blockquote&gt;&lt;pre&gt;{@code</span>
<span class="line-modified">!      *  guardWithCatch=Lambda(a0:L,a1:L,a2:L,a3:L,a4:L,a5:L,a6:L,a7:L)=&gt;{</span>
<span class="line-modified">!      *    t8:L=MethodHandle.invokeBasic(a4:L,a6:L,a7:L);</span>
<span class="line-modified">!      *    t9:L=MethodHandleImpl.guardWithCatch(a1:L,a2:L,a3:L,t8:L);</span>
<span class="line-modified">!      *   t10:I=MethodHandle.invokeBasic(a5:L,t9:L);t10:I}</span>
<span class="line-modified">!      * }&lt;/pre&gt;&lt;/blockquote&gt;</span>
<span class="line-modified">!      *</span>
<span class="line-modified">!      * It is compiled into bytecode equivalent of the following code:</span>
<span class="line-modified">!      * &lt;blockquote&gt;&lt;pre&gt;{@code</span>
<span class="line-modified">!      *  try {</span>
<span class="line-modified">!      *      return a1.invokeBasic(a6, a7);</span>
<span class="line-modified">!      *  } catch (Throwable e) {</span>
<span class="line-modified">!      *      if (!a2.isInstance(e)) throw e;</span>
<span class="line-modified">!      *      return a3.invokeBasic(ex, a6, a7);</span>
<span class="line-modified">!      *  }}&lt;/pre&gt;&lt;/blockquote&gt;</span>
<span class="line-modified">!      */</span>
      private Name emitGuardWithCatch(int pos) {
          Name args    = lambdaForm.names[pos];
          Name invoker = lambdaForm.names[pos+1];
          Name result  = lambdaForm.names[pos+2];
  
</pre>
<center><a href="ConstantGroup.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="MethodHandle.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>