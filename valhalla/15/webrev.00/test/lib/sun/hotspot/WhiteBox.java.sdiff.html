<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/lib/sun/hotspot/WhiteBox.java</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../../jdk/test/lib/util/JarUtils.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../../make/autoconf/test.m4.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/lib/sun/hotspot/WhiteBox.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
408   // Memory
409   public native void readReservedMemory();
410   public native long allocateMetaspace(ClassLoader classLoader, long size);
411   public native void freeMetaspace(ClassLoader classLoader, long addr, long size);
412   public native long incMetaspaceCapacityUntilGC(long increment);
413   public native long metaspaceCapacityUntilGC();
414   public native long metaspaceReserveAlignment();
415 
416   // Don&#39;t use these methods directly
417   // Use sun.hotspot.gc.GC class instead.
418   public native boolean isGCSupported(int name);
419   public native boolean isGCSelected(int name);
420   public native boolean isGCSelectedErgonomically();
421 
422   // Force Young GC
423   public native void youngGC();
424 
425   // Force Full GC
426   public native void fullGC();
427 
<span class="line-modified">428   // Returns true if the current GC supports control of its concurrent</span>
<span class="line-modified">429   // phase via requestConcurrentGCPhase().  If false, a request will</span>
<span class="line-removed">430   // always fail.</span>
<span class="line-removed">431   public native boolean supportsConcurrentGCPhaseControl();</span>
432 
<span class="line-modified">433   // Attempt to put the collector into the indicated concurrent phase,</span>
<span class="line-modified">434   // and attempt to remain in that state until a new request is made.</span>
<span class="line-modified">435   //</span>
<span class="line-modified">436   // Returns immediately if already in the requested phase.</span>
<span class="line-modified">437   // Otherwise, waits until the phase is reached.</span>
<span class="line-modified">438   //</span>
<span class="line-modified">439   // Throws IllegalStateException if unsupported by the current collector.</span>
<span class="line-modified">440   // Throws NullPointerException if phase is null.</span>
<span class="line-modified">441   // Throws IllegalArgumentException if phase is not valid for the current collector.</span>
<span class="line-modified">442   public void requestConcurrentGCPhase(String phase) {</span>
<span class="line-modified">443     if (!supportsConcurrentGCPhaseControl()) {</span>
<span class="line-modified">444       throw new IllegalStateException(&quot;Concurrent GC phase control not supported&quot;);</span>
<span class="line-modified">445     } else if (phase == null) {</span>
<span class="line-modified">446       throw new NullPointerException(&quot;null phase&quot;);</span>
<span class="line-modified">447     } else if (!requestConcurrentGCPhase0(phase)) {</span>
<span class="line-removed">448       throw new IllegalArgumentException(&quot;Unknown concurrent GC phase: &quot; + phase);</span>
449     }
450   }
451 
<span class="line-modified">452   // Helper for requestConcurrentGCPhase().  Returns true if request</span>
<span class="line-modified">453   // succeeded, false if the phase is invalid.</span>
<span class="line-modified">454   private native boolean requestConcurrentGCPhase0(String phase);</span>















































455 
456   // Method tries to start concurrent mark cycle.
457   // It returns false if CM Thread is always in concurrent cycle.
458   public native boolean g1StartConcMarkCycle();
459 
460   // Tests on ReservedSpace/VirtualSpace classes
461   public native int stressVirtualSpaceResize(long reservedSpaceSize, long magnitude, long iterations);
462   public native void runMemoryUnitTests();
463   public native void readFromNoaccessArea();
464   public native long getThreadStackSize();
465   public native long getThreadRemainingStackSize();
466 
467   // CPU features
468   public native String getCPUFeatures();
469 
470   // VM flags
471   public native boolean isConstantVMFlag(String name);
472   public native boolean isLockedVMFlag(String name);
473   public native void    setBooleanVMFlag(String name, boolean value);
474   public native void    setIntVMFlag(String name, long value);
</pre>
<hr />
<pre>
548   public native boolean areSharedStringsIgnored();
549   public native boolean isCDSIncludedInVmBuild();
550   public native boolean isJFRIncludedInVmBuild();
551   public native boolean isJavaHeapArchiveSupported();
552   public native Object  getResolvedReferences(Class&lt;?&gt; c);
553   public native void    linkClass(Class&lt;?&gt; c);
554   public native boolean areOpenArchiveHeapObjectsMapped();
555 
556   // Compiler Directive
557   public native int addCompilerDirective(String compDirect);
558   public native void removeCompilerDirective(int count);
559 
560   // Handshakes
561   public native int handshakeWalkStack(Thread t, boolean all_threads);
562 
563   // Returns true on linux if library has the noexecstack flag set.
564   public native boolean checkLibSpecifiesNoexecstack(String libfilename);
565 
566   // Container testing
567   public native boolean isContainerized();



568   public native void printOsInfo();
569 
570   // Decoder
571   public native void disableElfSectionCache();
572 
573   // Resolved Method Table
574   public native long resolvedMethodItemsCount();
575 
576   // Protection Domain Table
577   public native int protectionDomainRemovedCount();
578 
579   // Number of loaded AOT libraries
580   public native int aotLibrariesCount();
581 
582   public native int getKlassMetadataSize(Class&lt;?&gt; c);
583 }
</pre>
</td>
<td>
<hr />
<pre>
408   // Memory
409   public native void readReservedMemory();
410   public native long allocateMetaspace(ClassLoader classLoader, long size);
411   public native void freeMetaspace(ClassLoader classLoader, long addr, long size);
412   public native long incMetaspaceCapacityUntilGC(long increment);
413   public native long metaspaceCapacityUntilGC();
414   public native long metaspaceReserveAlignment();
415 
416   // Don&#39;t use these methods directly
417   // Use sun.hotspot.gc.GC class instead.
418   public native boolean isGCSupported(int name);
419   public native boolean isGCSelected(int name);
420   public native boolean isGCSelectedErgonomically();
421 
422   // Force Young GC
423   public native void youngGC();
424 
425   // Force Full GC
426   public native void fullGC();
427 
<span class="line-modified">428   // Returns true if the current GC supports concurrent collection control.</span>
<span class="line-modified">429   public native boolean supportsConcurrentGCBreakpoints();</span>


430 
<span class="line-modified">431   private void checkConcurrentGCBreakpointsSupported() {</span>
<span class="line-modified">432     if (!supportsConcurrentGCBreakpoints()) {</span>
<span class="line-modified">433       throw new UnsupportedOperationException(&quot;Concurrent GC breakpoints not supported&quot;);</span>
<span class="line-modified">434     }</span>
<span class="line-modified">435   }</span>
<span class="line-modified">436 </span>
<span class="line-modified">437   private native void concurrentGCAcquireControl0();</span>
<span class="line-modified">438   private native void concurrentGCReleaseControl0();</span>
<span class="line-modified">439   private native void concurrentGCRunToIdle0();</span>
<span class="line-modified">440   private native boolean concurrentGCRunTo0(String breakpoint);</span>
<span class="line-modified">441 </span>
<span class="line-modified">442   private static boolean concurrentGCIsControlled = false;</span>
<span class="line-modified">443   private void checkConcurrentGCIsControlled() {</span>
<span class="line-modified">444     if (!concurrentGCIsControlled) {</span>
<span class="line-modified">445       throw new IllegalStateException(&quot;Not controlling concurrent GC&quot;);</span>

446     }
447   }
448 
<span class="line-modified">449   // All collectors supporting concurrent GC breakpoints are expected</span>
<span class="line-modified">450   // to provide at least the following breakpoints.</span>
<span class="line-modified">451   public final String AFTER_MARKING_STARTED = &quot;AFTER MARKING STARTED&quot;;</span>
<span class="line-added">452   public final String BEFORE_MARKING_COMPLETED = &quot;BEFORE MARKING COMPLETED&quot;;</span>
<span class="line-added">453 </span>
<span class="line-added">454   public void concurrentGCAcquireControl() {</span>
<span class="line-added">455     checkConcurrentGCBreakpointsSupported();</span>
<span class="line-added">456     if (concurrentGCIsControlled) {</span>
<span class="line-added">457       throw new IllegalStateException(&quot;Already controlling concurrent GC&quot;);</span>
<span class="line-added">458     }</span>
<span class="line-added">459     concurrentGCAcquireControl0();</span>
<span class="line-added">460     concurrentGCIsControlled = true;</span>
<span class="line-added">461   }</span>
<span class="line-added">462 </span>
<span class="line-added">463   public void concurrentGCReleaseControl() {</span>
<span class="line-added">464     checkConcurrentGCBreakpointsSupported();</span>
<span class="line-added">465     concurrentGCReleaseControl0();</span>
<span class="line-added">466     concurrentGCIsControlled = false;</span>
<span class="line-added">467   }</span>
<span class="line-added">468 </span>
<span class="line-added">469   // Keep concurrent GC idle.  Release from breakpoint.</span>
<span class="line-added">470   public void concurrentGCRunToIdle() {</span>
<span class="line-added">471     checkConcurrentGCBreakpointsSupported();</span>
<span class="line-added">472     checkConcurrentGCIsControlled();</span>
<span class="line-added">473     concurrentGCRunToIdle0();</span>
<span class="line-added">474   }</span>
<span class="line-added">475 </span>
<span class="line-added">476   // Allow concurrent GC to run to breakpoint.</span>
<span class="line-added">477   // Throws IllegalStateException if reached end of cycle first.</span>
<span class="line-added">478   public void concurrentGCRunTo(String breakpoint) {</span>
<span class="line-added">479     concurrentGCRunTo(breakpoint, true);</span>
<span class="line-added">480   }</span>
<span class="line-added">481 </span>
<span class="line-added">482   // Allow concurrent GC to run to breakpoint.</span>
<span class="line-added">483   // Returns true if reached breakpoint.  If reached end of cycle first,</span>
<span class="line-added">484   // then throws IllegalStateException if errorIfFail is true, returning</span>
<span class="line-added">485   // false otherwise.</span>
<span class="line-added">486   public boolean concurrentGCRunTo(String breakpoint, boolean errorIfFail) {</span>
<span class="line-added">487     checkConcurrentGCBreakpointsSupported();</span>
<span class="line-added">488     checkConcurrentGCIsControlled();</span>
<span class="line-added">489     if (breakpoint == null) {</span>
<span class="line-added">490       throw new NullPointerException(&quot;null breakpoint&quot;);</span>
<span class="line-added">491     } else if (concurrentGCRunTo0(breakpoint)) {</span>
<span class="line-added">492       return true;</span>
<span class="line-added">493     } else if (errorIfFail) {</span>
<span class="line-added">494       throw new IllegalStateException(&quot;Missed requested breakpoint \&quot;&quot; + breakpoint + &quot;\&quot;&quot;);</span>
<span class="line-added">495     } else {</span>
<span class="line-added">496       return false;</span>
<span class="line-added">497     }</span>
<span class="line-added">498   }</span>
499 
500   // Method tries to start concurrent mark cycle.
501   // It returns false if CM Thread is always in concurrent cycle.
502   public native boolean g1StartConcMarkCycle();
503 
504   // Tests on ReservedSpace/VirtualSpace classes
505   public native int stressVirtualSpaceResize(long reservedSpaceSize, long magnitude, long iterations);
506   public native void runMemoryUnitTests();
507   public native void readFromNoaccessArea();
508   public native long getThreadStackSize();
509   public native long getThreadRemainingStackSize();
510 
511   // CPU features
512   public native String getCPUFeatures();
513 
514   // VM flags
515   public native boolean isConstantVMFlag(String name);
516   public native boolean isLockedVMFlag(String name);
517   public native void    setBooleanVMFlag(String name, boolean value);
518   public native void    setIntVMFlag(String name, long value);
</pre>
<hr />
<pre>
592   public native boolean areSharedStringsIgnored();
593   public native boolean isCDSIncludedInVmBuild();
594   public native boolean isJFRIncludedInVmBuild();
595   public native boolean isJavaHeapArchiveSupported();
596   public native Object  getResolvedReferences(Class&lt;?&gt; c);
597   public native void    linkClass(Class&lt;?&gt; c);
598   public native boolean areOpenArchiveHeapObjectsMapped();
599 
600   // Compiler Directive
601   public native int addCompilerDirective(String compDirect);
602   public native void removeCompilerDirective(int count);
603 
604   // Handshakes
605   public native int handshakeWalkStack(Thread t, boolean all_threads);
606 
607   // Returns true on linux if library has the noexecstack flag set.
608   public native boolean checkLibSpecifiesNoexecstack(String libfilename);
609 
610   // Container testing
611   public native boolean isContainerized();
<span class="line-added">612   public native int validateCgroup(String procCgroups,</span>
<span class="line-added">613                                    String procSelfCgroup,</span>
<span class="line-added">614                                    String procSelfMountinfo);</span>
615   public native void printOsInfo();
616 
617   // Decoder
618   public native void disableElfSectionCache();
619 
620   // Resolved Method Table
621   public native long resolvedMethodItemsCount();
622 
623   // Protection Domain Table
624   public native int protectionDomainRemovedCount();
625 
626   // Number of loaded AOT libraries
627   public native int aotLibrariesCount();
628 
629   public native int getKlassMetadataSize(Class&lt;?&gt; c);
630 }
</pre>
</td>
</tr>
</table>
<center><a href="../../jdk/test/lib/util/JarUtils.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../../make/autoconf/test.m4.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>