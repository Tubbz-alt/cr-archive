<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New test/hotspot/jtreg/compiler/valhalla/valuetypes/TestNewAcmp.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
  <body>
    <pre>
   1 /*
   2  * Copyright (c) 2019, 2020, Oracle and/or its affiliates. All rights reserved.
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.
   8  *
   9  * This code is distributed in the hope that it will be useful, but WITHOUT
  10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  12  * version 2 for more details (a copy is included in the LICENSE file that
  13  * accompanied this code).
  14  *
  15  * You should have received a copy of the GNU General Public License version
  16  * 2 along with this work; if not, write to the Free Software Foundation,
  17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18  *
  19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20  * or visit www.oracle.com if you need additional information or have any
  21  * questions.
  22  */
  23 
  24 /**
  25  * @test TestNewAcmp
  26  * @summary Verifies correctness of the new acmp bytecode.
  27  * @library /testlibrary /test/lib /compiler/whitebox /
  28  * @compile TestNewAcmp.java
  29  * @run driver ClassFileInstaller sun.hotspot.WhiteBox
  30  * @run main/othervm/timeout=300 -Xbootclasspath/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI
  31  *                               compiler.valhalla.valuetypes.TestNewAcmp
  32  */
  33 
  34 package compiler.valhalla.valuetypes;
  35 
  36 import jdk.test.lib.Asserts;
  37 import jdk.test.lib.process.ProcessTools;
  38 import jdk.test.lib.process.OutputAnalyzer;
  39 import java.lang.annotation.Retention;
  40 import java.lang.annotation.RetentionPolicy;
  41 import java.lang.invoke.*;
  42 import java.lang.reflect.Method;
  43 import java.util.regex.Pattern;
  44 import java.util.regex.Matcher;
  45 import java.util.ArrayList;
  46 import java.util.Arrays;
  47 import java.util.List;
  48 import sun.hotspot.WhiteBox;
  49 
  50 
  51 interface MyInterface {
  52 
  53 }
  54 
  55 abstract class MyAbstract implements MyInterface {
  56 
  57 
  58 }
  59 
  60 inline class MyValue1 extends MyAbstract {
  61     final int x;
  62 
  63     MyValue1(int x) {
  64         this.x = x;
  65     }
  66 
  67     static MyValue1 createDefault() {
  68         return MyValue1.default;
  69     }
  70 
  71     static MyValue1 setX(MyValue1 v, int x) {
  72         return new MyValue1(x);
  73     }
  74 }
  75 
  76 inline class MyValue2 extends MyAbstract {
  77     final int x;
  78 
  79     MyValue2(int x) {
  80         this.x = x;
  81     }
  82 
  83     static MyValue2 createDefault() {
  84         return MyValue2.default;
  85     }
  86 
  87     static MyValue2 setX(MyValue2 v, int x) {
  88         return new MyValue2(x);
  89     }
  90 }
  91 
  92 class MyObject extends MyAbstract {
  93     int x;
  94 }
  95 
  96 // Mark test methods that return false if the argument is null
  97 @Retention(RetentionPolicy.RUNTIME)
  98 @interface FalseIfNull { }
  99 
 100 // Mark test methods that return true if the argument is null
 101 @Retention(RetentionPolicy.RUNTIME)
 102 @interface TrueIfNull { }
 103 
 104 public class TestNewAcmp {
 105 
 106     public boolean testEq01_1(Object u1, Object u2) {
 107         return get(u1) == u2; // new acmp
 108     }
 109 
 110     public boolean testEq01_2(Object u1, Object u2) {
 111         return u1 == get(u2); // new acmp
 112     }
 113 
 114     public boolean testEq01_3(Object u1, Object u2) {
 115         return get(u1) == get(u2); // new acmp
 116     }
 117 
 118     @FalseIfNull
 119     public boolean testEq01_4(Object u1, Object u2) {
 120         return getNotNull(u1) == u2; // new acmp without null check
 121     }
 122 
 123     @FalseIfNull
 124     public boolean testEq01_5(Object u1, Object u2) {
 125         return u1 == getNotNull(u2); // new acmp without null check
 126     }
 127 
 128     @FalseIfNull
 129     public boolean testEq01_6(Object u1, Object u2) {
 130         return getNotNull(u1) == getNotNull(u2); // new acmp without null check
 131     }
 132 
 133     public boolean testEq02_1(MyValue1 v1, MyValue1 v2) {
 134         return get(v1) == (Object)v2; // only true if both null
 135     }
 136 
 137     public boolean testEq02_2(MyValue1 v1, MyValue1 v2) {
 138         return (Object)v1 == get(v2); // only true if both null
 139     }
 140 
 141     public boolean testEq02_3(MyValue1 v1, MyValue1 v2) {
 142         return get(v1) == get(v2); // only true if both null
 143     }
 144 
 145     public boolean testEq03_1(MyValue1 v, Object u) {
 146         return get(v) == u; // only true if both null
 147     }
 148 
 149     public boolean testEq03_2(MyValue1 v, Object u) {
 150         return (Object)v == get(u); // only true if both null
 151     }
 152 
 153     public boolean testEq03_3(MyValue1 v, Object u) {
 154         return get(v) == get(u); // only true if both null
 155     }
 156 
 157     public boolean testEq04_1(Object u, MyValue1 v) {
 158         return get(u) == (Object)v; // only true if both null
 159     }
 160 
 161     public boolean testEq04_2(Object u, MyValue1 v) {
 162         return u == get(v); // only true if both null
 163     }
 164 
 165     public boolean testEq04_3(Object u, MyValue1 v) {
 166         return get(u) == get(v); // only true if both null
 167     }
 168 
 169     public boolean testEq05_1(MyObject o, MyValue1 v) {
 170         return get(o) == (Object)v; // only true if both null
 171     }
 172 
 173     public boolean testEq05_2(MyObject o, MyValue1 v) {
 174         return o == get(v); // only true if both null
 175     }
 176 
 177     public boolean testEq05_3(MyObject o, MyValue1 v) {
 178         return get(o) == get(v); // only true if both null
 179     }
 180 
 181     public boolean testEq06_1(MyValue1 v, MyObject o) {
 182         return get(v) == o; // only true if both null
 183     }
 184 
 185     public boolean testEq06_2(MyValue1 v, MyObject o) {
 186         return (Object)v == get(o); // only true if both null
 187     }
 188 
 189     public boolean testEq06_3(MyValue1 v, MyObject o) {
 190         return get(v) == get(o); // only true if both null
 191     }
 192 
 193     public boolean testEq07_1(MyValue1 v1, MyValue1 v2) {
 194         return getNotNull(v1) == (Object)v2; // false
 195     }
 196 
 197     public boolean testEq07_2(MyValue1 v1, MyValue1 v2) {
 198         return (Object)v1 == getNotNull(v2); // false
 199     }
 200 
 201     public boolean testEq07_3(MyValue1 v1, MyValue1 v2) {
 202         return getNotNull(v1) == getNotNull(v2); // false
 203     }
 204 
 205     public boolean testEq08_1(MyValue1 v, Object u) {
 206         return getNotNull(v) == u; // false
 207     }
 208 
 209     public boolean testEq08_2(MyValue1 v, Object u) {
 210         return (Object)v == getNotNull(u); // false
 211     }
 212 
 213     public boolean testEq08_3(MyValue1 v, Object u) {
 214         return getNotNull(v) == getNotNull(u); // false
 215     }
 216 
 217     public boolean testEq09_1(Object u, MyValue1 v) {
 218         return getNotNull(u) == (Object)v; // false
 219     }
 220 
 221     public boolean testEq09_2(Object u, MyValue1 v) {
 222         return u == getNotNull(v); // false
 223     }
 224 
 225     public boolean testEq09_3(Object u, MyValue1 v) {
 226         return getNotNull(u) == getNotNull(v); // false
 227     }
 228 
 229     public boolean testEq10_1(MyObject o, MyValue1 v) {
 230         return getNotNull(o) == (Object)v; // false
 231     }
 232 
 233     public boolean testEq10_2(MyObject o, MyValue1 v) {
 234         return o == getNotNull(v); // false
 235     }
 236 
 237     public boolean testEq10_3(MyObject o, MyValue1 v) {
 238         return getNotNull(o) == getNotNull(v); // false
 239     }
 240 
 241     public boolean testEq11_1(MyValue1 v, MyObject o) {
 242         return getNotNull(v) == o; // false
 243     }
 244 
 245     public boolean testEq11_2(MyValue1 v, MyObject o) {
 246         return (Object)v == getNotNull(o); // false
 247     }
 248 
 249     public boolean testEq11_3(MyValue1 v, MyObject o) {
 250         return getNotNull(v) == getNotNull(o); // false
 251     }
 252 
 253     public boolean testEq12_1(MyObject o1, MyObject o2) {
 254         return get(o1) == o2; // old acmp
 255     }
 256 
 257     public boolean testEq12_2(MyObject o1, MyObject o2) {
 258         return o1 == get(o2); // old acmp
 259     }
 260 
 261     public boolean testEq12_3(MyObject o1, MyObject o2) {
 262         return get(o1) == get(o2); // old acmp
 263     }
 264 
 265     public boolean testEq13_1(Object u, MyObject o) {
 266         return get(u) == o; // old acmp
 267     }
 268 
 269     public boolean testEq13_2(Object u, MyObject o) {
 270         return u == get(o); // old acmp
 271     }
 272 
 273     public boolean testEq13_3(Object u, MyObject o) {
 274         return get(u) == get(o); // old acmp
 275     }
 276 
 277     public boolean testEq14_1(MyObject o, Object u) {
 278         return get(o) == u; // old acmp
 279     }
 280 
 281     public boolean testEq14_2(MyObject o, Object u) {
 282         return o == get(u); // old acmp
 283     }
 284 
 285     public boolean testEq14_3(MyObject o, Object u) {
 286         return get(o) == get(u); // old acmp
 287     }
 288 
 289     public boolean testEq15_1(Object[] a, Object u) {
 290         return get(a) == u; // old acmp
 291     }
 292 
 293     public boolean testEq15_2(Object[] a, Object u) {
 294         return a == get(u); // old acmp
 295     }
 296 
 297     public boolean testEq15_3(Object[] a, Object u) {
 298         return get(a) == get(u); // old acmp
 299     }
 300 
 301     public boolean testEq16_1(Object u, Object[] a) {
 302         return get(u) == a; // old acmp
 303     }
 304 
 305     public boolean testEq16_2(Object u, Object[] a) {
 306         return u == get(a); // old acmp
 307     }
 308 
 309     public boolean testEq16_3(Object u, Object[] a) {
 310         return get(u) == get(a); // old acmp
 311     }
 312 
 313     public boolean testEq17_1(Object[] a, MyValue1 v) {
 314         return get(a) == (Object)v; // only true if both null
 315     }
 316 
 317     public boolean testEq17_2(Object[] a, MyValue1 v) {
 318         return a == get(v); // only true if both null
 319     }
 320 
 321     public boolean testEq17_3(Object[] a, MyValue1 v) {
 322         return get(a) == get(v); // only true if both null
 323     }
 324 
 325     public boolean testEq18_1(MyValue1 v, Object[] a) {
 326         return get(v) == a; // only true if both null
 327     }
 328 
 329     public boolean testEq18_2(MyValue1 v, Object[] a) {
 330         return (Object)v == get(a); // only true if both null
 331     }
 332 
 333     public boolean testEq18_3(MyValue1 v, Object[] a) {
 334         return get(v) == get(a); // only true if both null
 335     }
 336 
 337     public boolean testEq19_1(Object[] a, MyValue1 v) {
 338         return getNotNull(a) == (Object)v; // false
 339     }
 340 
 341     public boolean testEq19_2(Object[] a, MyValue1 v) {
 342         return a == getNotNull(v); // false
 343     }
 344 
 345     public boolean testEq19_3(Object[] a, MyValue1 v) {
 346         return getNotNull(a) == getNotNull(v); // false
 347     }
 348 
 349     public boolean testEq20_1(MyValue1 v, Object[] a) {
 350         return getNotNull(v) == a; // false
 351     }
 352 
 353     public boolean testEq20_2(MyValue1 v, Object[] a) {
 354         return (Object)v == getNotNull(a); // false
 355     }
 356 
 357     public boolean testEq20_3(MyValue1 v, Object[] a) {
 358         return getNotNull(v) == getNotNull(a); // false
 359     }
 360 
 361     public boolean testEq21_1(MyInterface u1, MyInterface u2) {
 362         return get(u1) == u2; // new acmp
 363     }
 364 
 365     public boolean testEq21_2(MyInterface u1, MyInterface u2) {
 366         return u1 == get(u2); // new acmp
 367     }
 368 
 369     public boolean testEq21_3(MyInterface u1, MyInterface u2) {
 370         return get(u1) == get(u2); // new acmp
 371     }
 372 
 373     @FalseIfNull
 374     public boolean testEq21_4(MyInterface u1, MyInterface u2) {
 375         return getNotNull(u1) == u2; // new acmp without null check
 376     }
 377 
 378     @FalseIfNull
 379     public boolean testEq21_5(MyInterface u1, MyInterface u2) {
 380         return u1 == getNotNull(u2); // new acmp without null check
 381     }
 382 
 383     @FalseIfNull
 384     public boolean testEq21_6(MyInterface u1, MyInterface u2) {
 385         return getNotNull(u1) == getNotNull(u2); // new acmp without null check
 386     }
 387 
 388     public boolean testEq21_7(MyAbstract u1, MyAbstract u2) {
 389         return get(u1) == u2; // new acmp
 390     }
 391 
 392     public boolean testEq21_8(MyAbstract u1, MyAbstract u2) {
 393         return u1 == get(u2); // new acmp
 394     }
 395 
 396     public boolean testEq21_9(MyAbstract u1, MyAbstract u2) {
 397         return get(u1) == get(u2); // new acmp
 398     }
 399 
 400     @FalseIfNull
 401     public boolean testEq21_10(MyAbstract u1, MyAbstract u2) {
 402         return getNotNull(u1) == u2; // new acmp without null check
 403     }
 404 
 405     @FalseIfNull
 406     public boolean testEq21_11(MyAbstract u1, MyAbstract u2) {
 407         return u1 == getNotNull(u2); // new acmp without null check
 408     }
 409 
 410     @FalseIfNull
 411     public boolean testEq21_12(MyAbstract u1, MyAbstract u2) {
 412         return getNotNull(u1) == getNotNull(u2); // new acmp without null check
 413     }
 414 
 415     public boolean testEq22_1(MyValue1 v, MyInterface u) {
 416         return get(v) == u; // only true if both null
 417     }
 418 
 419     public boolean testEq22_2(MyValue1 v, MyInterface u) {
 420         return (Object)v == get(u); // only true if both null
 421     }
 422 
 423     public boolean testEq22_3(MyValue1 v, MyInterface u) {
 424         return get(v) == get(u); // only true if both null
 425     }
 426 
 427     public boolean testEq22_4(MyValue1 v, MyAbstract u) {
 428         return get(v) == u; // only true if both null
 429     }
 430 
 431     public boolean testEq22_5(MyValue1 v, MyAbstract u) {
 432         return (Object)v == get(u); // only true if both null
 433     }
 434 
 435     public boolean testEq22_6(MyValue1 v, MyAbstract u) {
 436         return get(v) == get(u); // only true if both null
 437     }
 438 
 439     public boolean testEq23_1(MyInterface u, MyValue1 v) {
 440         return get(u) == (Object)v; // only true if both null
 441     }
 442 
 443     public boolean testEq23_2(MyInterface u, MyValue1 v) {
 444         return u == get(v); // only true if both null
 445     }
 446 
 447     public boolean testEq23_3(MyInterface u, MyValue1 v) {
 448         return get(u) == get(v); // only true if both null
 449     }
 450 
 451     public boolean testEq23_4(MyAbstract u, MyValue1 v) {
 452         return get(u) == (Object)v; // only true if both null
 453     }
 454 
 455     public boolean testEq23_5(MyAbstract u, MyValue1 v) {
 456         return u == get(v); // only true if both null
 457     }
 458 
 459     public boolean testEq23_6(MyAbstract u, MyValue1 v) {
 460         return get(u) == get(v); // only true if both null
 461     }
 462 
 463     public boolean testEq24_1(MyValue1 v, MyInterface u) {
 464         return getNotNull(v) == u; // false
 465     }
 466 
 467     public boolean testEq24_2(MyValue1 v, MyInterface u) {
 468         return (Object)v == getNotNull(u); // false
 469     }
 470 
 471     public boolean testEq24_3(MyValue1 v, MyInterface u) {
 472         return getNotNull(v) == getNotNull(u); // false
 473     }
 474 
 475     public boolean testEq24_4(MyValue1 v, MyAbstract u) {
 476         return getNotNull(v) == u; // false
 477     }
 478 
 479     public boolean testEq24_5(MyValue1 v, MyAbstract u) {
 480         return (Object)v == getNotNull(u); // false
 481     }
 482 
 483     public boolean testEq24_6(MyValue1 v, MyAbstract u) {
 484         return getNotNull(v) == getNotNull(u); // false
 485     }
 486 
 487     public boolean testEq25_1(MyInterface u, MyValue1 v) {
 488         return getNotNull(u) == (Object)v; // false
 489     }
 490 
 491     public boolean testEq25_2(MyInterface u, MyValue1 v) {
 492         return u == getNotNull(v); // false
 493     }
 494 
 495     public boolean testEq25_3(MyInterface u, MyValue1 v) {
 496         return getNotNull(u) == getNotNull(v); // false
 497     }
 498 
 499     public boolean testEq25_4(MyAbstract u, MyValue1 v) {
 500         return getNotNull(u) == (Object)v; // false
 501     }
 502 
 503     public boolean testEq25_5(MyAbstract u, MyValue1 v) {
 504         return u == getNotNull(v); // false
 505     }
 506 
 507     public boolean testEq25_6(MyAbstract u, MyValue1 v) {
 508         return getNotNull(u) == getNotNull(v); // false
 509     }
 510 
 511     public boolean testEq26_1(MyInterface u, MyObject o) {
 512         return get(u) == o; // old acmp
 513     }
 514 
 515     public boolean testEq26_2(MyInterface u, MyObject o) {
 516         return u == get(o); // old acmp
 517     }
 518 
 519     public boolean testEq26_3(MyInterface u, MyObject o) {
 520         return get(u) == get(o); // old acmp
 521     }
 522 
 523     public boolean testEq26_4(MyAbstract u, MyObject o) {
 524         return get(u) == o; // old acmp
 525     }
 526 
 527     public boolean testEq26_5(MyAbstract u, MyObject o) {
 528         return u == get(o); // old acmp
 529     }
 530 
 531     public boolean testEq26_6(MyAbstract u, MyObject o) {
 532         return get(u) == get(o); // old acmp
 533     }
 534 
 535     public boolean testEq27_1(MyObject o, MyInterface u) {
 536         return get(o) == u; // old acmp
 537     }
 538 
 539     public boolean testEq27_2(MyObject o, MyInterface u) {
 540         return o == get(u); // old acmp
 541     }
 542 
 543     public boolean testEq27_3(MyObject o, MyInterface u) {
 544         return get(o) == get(u); // old acmp
 545     }
 546 
 547     public boolean testEq27_4(MyObject o, MyAbstract u) {
 548         return get(o) == u; // old acmp
 549     }
 550 
 551     public boolean testEq27_5(MyObject o, MyAbstract u) {
 552         return o == get(u); // old acmp
 553     }
 554 
 555     public boolean testEq27_6(MyObject o, MyAbstract u) {
 556         return get(o) == get(u); // old acmp
 557     }
 558 
 559     public boolean testEq28_1(MyInterface[] a, MyInterface u) {
 560         return get(a) == u; // old acmp
 561     }
 562 
 563     public boolean testEq28_2(MyInterface[] a, MyInterface u) {
 564         return a == get(u); // old acmp
 565     }
 566 
 567     public boolean testEq28_3(MyInterface[] a, MyInterface u) {
 568         return get(a) == get(u); // old acmp
 569     }
 570 
 571     public boolean testEq28_4(MyAbstract[] a, MyAbstract u) {
 572         return get(a) == u; // old acmp
 573     }
 574 
 575     public boolean testEq28_5(MyAbstract[] a, MyAbstract u) {
 576         return a == get(u); // old acmp
 577     }
 578 
 579     public boolean testEq28_6(MyAbstract[] a, MyAbstract u) {
 580         return get(a) == get(u); // old acmp
 581     }
 582 
 583     public boolean testEq29_1(MyInterface u, MyInterface[] a) {
 584         return get(u) == a; // old acmp
 585     }
 586 
 587     public boolean testEq29_2(MyInterface u, MyInterface[] a) {
 588         return u == get(a); // old acmp
 589     }
 590 
 591     public boolean testEq29_3(MyInterface u, MyInterface[] a) {
 592         return get(u) == get(a); // old acmp
 593     }
 594 
 595     public boolean testEq29_4(MyAbstract u, MyAbstract[] a) {
 596         return get(u) == a; // old acmp
 597     }
 598 
 599     public boolean testEq29_5(MyAbstract u, MyAbstract[] a) {
 600         return u == get(a); // old acmp
 601     }
 602 
 603     public boolean testEq29_6(MyAbstract u, MyAbstract[] a) {
 604         return get(u) == get(a); // old acmp
 605     }
 606 
 607     public boolean testEq30_1(MyInterface[] a, MyValue1 v) {
 608         return get(a) == (Object)v; // only true if both null
 609     }
 610 
 611     public boolean testEq30_2(MyInterface[] a, MyValue1 v) {
 612         return a == get(v); // only true if both null
 613     }
 614 
 615     public boolean testEq30_3(MyInterface[] a, MyValue1 v) {
 616         return get(a) == get(v); // only true if both null
 617     }
 618 
 619     public boolean testEq30_4(MyAbstract[] a, MyValue1 v) {
 620         return get(a) == (Object)v; // only true if both null
 621     }
 622 
 623     public boolean testEq30_5(MyAbstract[] a, MyValue1 v) {
 624         return a == get(v); // only true if both null
 625     }
 626 
 627     public boolean testEq30_6(MyAbstract[] a, MyValue1 v) {
 628         return get(a) == get(v); // only true if both null
 629     }
 630 
 631     public boolean testEq31_1(MyValue1 v, MyInterface[] a) {
 632         return get(v) == a; // only true if both null
 633     }
 634 
 635     public boolean testEq31_2(MyValue1 v, MyInterface[] a) {
 636         return (Object)v == get(a); // only true if both null
 637     }
 638 
 639     public boolean testEq31_3(MyValue1 v, MyInterface[] a) {
 640         return get(v) == get(a); // only true if both null
 641     }
 642 
 643     public boolean testEq31_4(MyValue1 v, MyAbstract[] a) {
 644         return get(v) == a; // only true if both null
 645     }
 646 
 647     public boolean testEq31_5(MyValue1 v, MyAbstract[] a) {
 648         return (Object)v == get(a); // only true if both null
 649     }
 650 
 651     public boolean testEq31_6(MyValue1 v, MyAbstract[] a) {
 652         return get(v) == get(a); // only true if both null
 653     }
 654 
 655     public boolean testEq32_1(MyInterface[] a, MyValue1 v) {
 656         return getNotNull(a) == (Object)v; // false
 657     }
 658 
 659     public boolean testEq32_2(MyInterface[] a, MyValue1 v) {
 660         return a == getNotNull(v); // false
 661     }
 662 
 663     public boolean testEq32_3(MyInterface[] a, MyValue1 v) {
 664         return getNotNull(a) == getNotNull(v); // false
 665     }
 666 
 667     public boolean testEq32_4(MyAbstract[] a, MyValue1 v) {
 668         return getNotNull(a) == (Object)v; // false
 669     }
 670 
 671     public boolean testEq32_5(MyAbstract[] a, MyValue1 v) {
 672         return a == getNotNull(v); // false
 673     }
 674 
 675     public boolean testEq32_6(MyAbstract[] a, MyValue1 v) {
 676         return getNotNull(a) == getNotNull(v); // false
 677     }
 678 
 679     public boolean testEq33_1(MyValue1 v, MyInterface[] a) {
 680         return getNotNull(v) == a; // false
 681     }
 682 
 683     public boolean testEq33_2(MyValue1 v, MyInterface[] a) {
 684         return (Object)v == getNotNull(a); // false
 685     }
 686 
 687     public boolean testEq33_3(MyValue1 v, MyInterface[] a) {
 688         return getNotNull(v) == getNotNull(a); // false
 689     }
 690 
 691     public boolean testEq33_4(MyValue1 v, MyAbstract[] a) {
 692         return getNotNull(v) == a; // false
 693     }
 694 
 695     public boolean testEq33_5(MyValue1 v, MyAbstract[] a) {
 696         return (Object)v == getNotNull(a); // false
 697     }
 698 
 699     public boolean testEq33_6(MyValue1 v, MyAbstract[] a) {
 700         return getNotNull(v) == getNotNull(a); // false
 701     }
 702 
 703 
 704     // Null tests
 705 
 706     public boolean testNull01_1(MyValue1 v) {
 707         return (Object)v == null; // old acmp
 708     }
 709 
 710     public boolean testNull01_2(MyValue1 v) {
 711         return get(v) == null; // old acmp
 712     }
 713 
 714     public boolean testNull01_3(MyValue1 v) {
 715         return (Object)v == get((Object)null); // old acmp
 716     }
 717 
 718     public boolean testNull01_4(MyValue1 v) {
 719         return get(v) == get((Object)null); // old acmp
 720     }
 721 
 722     public boolean testNull02_1(MyValue1 v) {
 723         return null == (Object)v; // old acmp
 724     }
 725 
 726     public boolean testNull02_2(MyValue1 v) {
 727         return get((Object)null) == (Object)v; // old acmp
 728     }
 729 
 730     public boolean testNull02_3(MyValue1 v) {
 731         return null == get(v); // old acmp
 732     }
 733 
 734     public boolean testNull02_4(MyValue1 v) {
 735         return get((Object)null) == get(v); // old acmp
 736     }
 737 
 738     public boolean testNull03_1(Object u) {
 739         return u == null; // old acmp
 740     }
 741 
 742     public boolean testNull03_2(Object u) {
 743         return get(u) == null; // old acmp
 744     }
 745 
 746     public boolean testNull03_3(Object u) {
 747         return u == get((Object)null); // old acmp
 748     }
 749 
 750     public boolean testNull03_4(Object u) {
 751         return get(u) == get((Object)null); // old acmp
 752     }
 753 
 754     public boolean testNull04_1(Object u) {
 755         return null == u; // old acmp
 756     }
 757 
 758     public boolean testNull04_2(Object u) {
 759         return get((Object)null) == u; // old acmp
 760     }
 761 
 762     public boolean testNull04_3(Object u) {
 763         return null == get(u); // old acmp
 764     }
 765 
 766     public boolean testNull04_4(Object u) {
 767         return get((Object)null) == get(u); // old acmp
 768     }
 769 
 770     public boolean testNull05_1(MyObject o) {
 771         return o == null; // old acmp
 772     }
 773 
 774     public boolean testNull05_2(MyObject o) {
 775         return get(o) == null; // old acmp
 776     }
 777 
 778     public boolean testNull05_3(MyObject o) {
 779         return o == get((Object)null); // old acmp
 780     }
 781 
 782     public boolean testNull05_4(MyObject o) {
 783         return get(o) == get((Object)null); // old acmp
 784     }
 785 
 786     public boolean testNull06_1(MyObject o) {
 787         return null == o; // old acmp
 788     }
 789 
 790     public boolean testNull06_2(MyObject o) {
 791         return get((Object)null) == o; // old acmp
 792     }
 793 
 794     public boolean testNull06_3(MyObject o) {
 795         return null == get(o); // old acmp
 796     }
 797 
 798     public boolean testNull06_4(MyObject o) {
 799         return get((Object)null) == get(o); // old acmp
 800     }
 801 
 802     public boolean testNull07_1(MyInterface u) {
 803         return u == null; // old acmp
 804     }
 805 
 806     public boolean testNull07_2(MyInterface u) {
 807         return get(u) == null; // old acmp
 808     }
 809 
 810     public boolean testNull07_3(MyInterface u) {
 811         return u == get((Object)null); // old acmp
 812     }
 813 
 814     public boolean testNull07_4(MyInterface u) {
 815         return get(u) == get((Object)null); // old acmp
 816     }
 817 
 818     public boolean testNull07_5(MyAbstract u) {
 819         return u == null; // old acmp
 820     }
 821 
 822     public boolean testNull07_6(MyAbstract u) {
 823         return get(u) == null; // old acmp
 824     }
 825 
 826     public boolean testNull07_7(MyAbstract u) {
 827         return u == get((Object)null); // old acmp
 828     }
 829 
 830     public boolean testNull07_8(MyAbstract u) {
 831         return get(u) == get((Object)null); // old acmp
 832     }
 833 
 834     public boolean testNull08_1(MyInterface u) {
 835         return null == u; // old acmp
 836     }
 837 
 838     public boolean testNull08_2(MyInterface u) {
 839         return get((Object)null) == u; // old acmp
 840     }
 841 
 842     public boolean testNull08_3(MyInterface u) {
 843         return null == get(u); // old acmp
 844     }
 845 
 846     public boolean testNull08_4(MyInterface u) {
 847         return get((Object)null) == get(u); // old acmp
 848     }
 849 
 850     public boolean testNull08_5(MyAbstract u) {
 851         return null == u; // old acmp
 852     }
 853 
 854     public boolean testNull08_6(MyAbstract u) {
 855         return get((Object)null) == u; // old acmp
 856     }
 857 
 858     public boolean testNull08_7(MyAbstract u) {
 859         return null == get(u); // old acmp
 860     }
 861 
 862     public boolean testNull08_8(MyAbstract u) {
 863         return get((Object)null) == get(u); // old acmp
 864     }
 865 
 866     // Same tests as above but negated
 867 
 868     public boolean testNotEq01_1(Object u1, Object u2) {
 869         return get(u1) != u2; // new acmp
 870     }
 871 
 872     public boolean testNotEq01_2(Object u1, Object u2) {
 873         return u1 != get(u2); // new acmp
 874     }
 875 
 876     public boolean testNotEq01_3(Object u1, Object u2) {
 877         return get(u1) != get(u2); // new acmp
 878     }
 879 
 880     @TrueIfNull
 881     public boolean testNotEq01_4(Object u1, Object u2) {
 882         return getNotNull(u1) != u2; // new acmp without null check
 883     }
 884 
 885     @TrueIfNull
 886     public boolean testNotEq01_5(Object u1, Object u2) {
 887         return u1 != getNotNull(u2); // new acmp without null check
 888     }
 889 
 890     @TrueIfNull
 891     public boolean testNotEq01_6(Object u1, Object u2) {
 892         return getNotNull(u1) != getNotNull(u2); // new acmp without null check
 893     }
 894 
 895     public boolean testNotEq02_1(MyValue1 v1, MyValue1 v2) {
 896         return get(v1) != (Object)v2; // only false if both null
 897     }
 898 
 899     public boolean testNotEq02_2(MyValue1 v1, MyValue1 v2) {
 900         return (Object)v1 != get(v2); // only false if both null
 901     }
 902 
 903     public boolean testNotEq02_3(MyValue1 v1, MyValue1 v2) {
 904         return get(v1) != get(v2); // only false if both null
 905     }
 906 
 907     public boolean testNotEq03_1(MyValue1 v, Object u) {
 908         return get(v) != u; // only false if both null
 909     }
 910 
 911     public boolean testNotEq03_2(MyValue1 v, Object u) {
 912         return (Object)v != get(u); // only false if both null
 913     }
 914 
 915     public boolean testNotEq03_3(MyValue1 v, Object u) {
 916         return get(v) != get(u); // only false if both null
 917     }
 918 
 919     public boolean testNotEq04_1(Object u, MyValue1 v) {
 920         return get(u) != (Object)v; // only false if both null
 921     }
 922 
 923     public boolean testNotEq04_2(Object u, MyValue1 v) {
 924         return u != get(v); // only false if both null
 925     }
 926 
 927     public boolean testNotEq04_3(Object u, MyValue1 v) {
 928         return get(u) != get(v); // only false if both null
 929     }
 930 
 931     public boolean testNotEq05_1(MyObject o, MyValue1 v) {
 932         return get(o) != (Object)v; // only false if both null
 933     }
 934 
 935     public boolean testNotEq05_2(MyObject o, MyValue1 v) {
 936         return o != get(v); // only false if both null
 937     }
 938 
 939     public boolean testNotEq05_3(MyObject o, MyValue1 v) {
 940         return get(o) != get(v); // only false if both null
 941     }
 942 
 943     public boolean testNotEq06_1(MyValue1 v, MyObject o) {
 944         return get(v) != o; // only false if both null
 945     }
 946 
 947     public boolean testNotEq06_2(MyValue1 v, MyObject o) {
 948         return (Object)v != get(o); // only false if both null
 949     }
 950 
 951     public boolean testNotEq06_3(MyValue1 v, MyObject o) {
 952         return get(v) != get(o); // only false if both null
 953     }
 954 
 955     public boolean testNotEq07_1(MyValue1 v1, MyValue1 v2) {
 956         return getNotNull(v1) != (Object)v2; // true
 957     }
 958 
 959     public boolean testNotEq07_2(MyValue1 v1, MyValue1 v2) {
 960         return (Object)v1 != getNotNull(v2); // true
 961     }
 962 
 963     public boolean testNotEq07_3(MyValue1 v1, MyValue1 v2) {
 964         return getNotNull(v1) != getNotNull(v2); // true
 965     }
 966 
 967     public boolean testNotEq08_1(MyValue1 v, Object u) {
 968         return getNotNull(v) != u; // true
 969     }
 970 
 971     public boolean testNotEq08_2(MyValue1 v, Object u) {
 972         return (Object)v != getNotNull(u); // true
 973     }
 974 
 975     public boolean testNotEq08_3(MyValue1 v, Object u) {
 976         return getNotNull(v) != getNotNull(u); // true
 977     }
 978 
 979     public boolean testNotEq09_1(Object u, MyValue1 v) {
 980         return getNotNull(u) != (Object)v; // true
 981     }
 982 
 983     public boolean testNotEq09_2(Object u, MyValue1 v) {
 984         return u != getNotNull(v); // true
 985     }
 986 
 987     public boolean testNotEq09_3(Object u, MyValue1 v) {
 988         return getNotNull(u) != getNotNull(v); // true
 989     }
 990 
 991     public boolean testNotEq10_1(MyObject o, MyValue1 v) {
 992         return getNotNull(o) != (Object)v; // true
 993     }
 994 
 995     public boolean testNotEq10_2(MyObject o, MyValue1 v) {
 996         return o != getNotNull(v); // true
 997     }
 998 
 999     public boolean testNotEq10_3(MyObject o, MyValue1 v) {
1000         return getNotNull(o) != getNotNull(v); // true
1001     }
1002 
1003     public boolean testNotEq11_1(MyValue1 v, MyObject o) {
1004         return getNotNull(v) != o; // true
1005     }
1006 
1007     public boolean testNotEq11_2(MyValue1 v, MyObject o) {
1008         return (Object)v != getNotNull(o); // true
1009     }
1010 
1011     public boolean testNotEq11_3(MyValue1 v, MyObject o) {
1012         return getNotNull(v) != getNotNull(o); // true
1013     }
1014 
1015     public boolean testNotEq12_1(MyObject o1, MyObject o2) {
1016         return get(o1) != o2; // old acmp
1017     }
1018 
1019     public boolean testNotEq12_2(MyObject o1, MyObject o2) {
1020         return o1 != get(o2); // old acmp
1021     }
1022 
1023     public boolean testNotEq12_3(MyObject o1, MyObject o2) {
1024         return get(o1) != get(o2); // old acmp
1025     }
1026 
1027     public boolean testNotEq13_1(Object u, MyObject o) {
1028         return get(u) != o; // old acmp
1029     }
1030 
1031     public boolean testNotEq13_2(Object u, MyObject o) {
1032         return u != get(o); // old acmp
1033     }
1034 
1035     public boolean testNotEq13_3(Object u, MyObject o) {
1036         return get(u) != get(o); // old acmp
1037     }
1038 
1039     public boolean testNotEq14_1(MyObject o, Object u) {
1040         return get(o) != u; // old acmp
1041     }
1042 
1043     public boolean testNotEq14_2(MyObject o, Object u) {
1044         return o != get(u); // old acmp
1045     }
1046 
1047     public boolean testNotEq14_3(MyObject o, Object u) {
1048         return get(o) != get(u); // old acmp
1049     }
1050 
1051     public boolean testNotEq15_1(Object[] a, Object u) {
1052         return get(a) != u; // old acmp
1053     }
1054 
1055     public boolean testNotEq15_2(Object[] a, Object u) {
1056         return a != get(u); // old acmp
1057     }
1058 
1059     public boolean testNotEq15_3(Object[] a, Object u) {
1060         return get(a) != get(u); // old acmp
1061     }
1062 
1063     public boolean testNotEq16_1(Object u, Object[] a) {
1064         return get(u) != a; // old acmp
1065     }
1066 
1067     public boolean testNotEq16_2(Object u, Object[] a) {
1068         return u != get(a); // old acmp
1069     }
1070 
1071     public boolean testNotEq16_3(Object u, Object[] a) {
1072         return get(u) != get(a); // old acmp
1073     }
1074 
1075     public boolean testNotEq17_1(Object[] a, MyValue1 v) {
1076         return get(a) != (Object)v; // only false if both null
1077     }
1078 
1079     public boolean testNotEq17_2(Object[] a, MyValue1 v) {
1080         return a != get(v); // only false if both null
1081     }
1082 
1083     public boolean testNotEq17_3(Object[] a, MyValue1 v) {
1084         return get(a) != get(v); // only false if both null
1085     }
1086 
1087     public boolean testNotEq18_1(MyValue1 v, Object[] a) {
1088         return get(v) != a; // only false if both null
1089     }
1090 
1091     public boolean testNotEq18_2(MyValue1 v, Object[] a) {
1092         return (Object)v != get(a); // only false if both null
1093     }
1094 
1095     public boolean testNotEq18_3(MyValue1 v, Object[] a) {
1096         return get(v) != get(a); // only false if both null
1097     }
1098 
1099     public boolean testNotEq19_1(Object[] a, MyValue1 v) {
1100         return getNotNull(a) != (Object)v; // true
1101     }
1102 
1103     public boolean testNotEq19_2(Object[] a, MyValue1 v) {
1104         return a != getNotNull(v); // true
1105     }
1106 
1107     public boolean testNotEq19_3(Object[] a, MyValue1 v) {
1108         return getNotNull(a) != getNotNull(v); // true
1109     }
1110 
1111     public boolean testNotEq20_1(MyValue1 v, Object[] a) {
1112         return getNotNull(v) != a; // true
1113     }
1114 
1115     public boolean testNotEq20_2(MyValue1 v, Object[] a) {
1116         return (Object)v != getNotNull(a); // true
1117     }
1118 
1119     public boolean testNotEq20_3(MyValue1 v, Object[] a) {
1120         return getNotNull(v) != getNotNull(a); // true
1121     }
1122 
1123     public boolean testNotEq21_1(MyInterface u1, MyInterface u2) {
1124         return get(u1) != u2; // new acmp
1125     }
1126 
1127     public boolean testNotEq21_2(MyInterface u1, MyInterface u2) {
1128         return u1 != get(u2); // new acmp
1129     }
1130 
1131     public boolean testNotEq21_3(MyInterface u1, MyInterface u2) {
1132         return get(u1) != get(u2); // new acmp
1133     }
1134 
1135     @TrueIfNull
1136     public boolean testNotEq21_4(MyInterface u1, MyInterface u2) {
1137         return getNotNull(u1) != u2; // new acmp without null check
1138     }
1139 
1140     @TrueIfNull
1141     public boolean testNotEq21_5(MyInterface u1, MyInterface u2) {
1142         return u1 != getNotNull(u2); // new acmp without null check
1143     }
1144 
1145     @TrueIfNull
1146     public boolean testNotEq21_6(MyInterface u1, MyInterface u2) {
1147         return getNotNull(u1) != getNotNull(u2); // new acmp without null check
1148     }
1149 
1150     public boolean testNotEq21_7(MyAbstract u1, MyAbstract u2) {
1151         return get(u1) != u2; // new acmp
1152     }
1153 
1154     public boolean testNotEq21_8(MyAbstract u1, MyAbstract u2) {
1155         return u1 != get(u2); // new acmp
1156     }
1157 
1158     public boolean testNotEq21_9(MyAbstract u1, MyAbstract u2) {
1159         return get(u1) != get(u2); // new acmp
1160     }
1161 
1162     @TrueIfNull
1163     public boolean testNotEq21_10(MyAbstract u1, MyAbstract u2) {
1164         return getNotNull(u1) != u2; // new acmp without null check
1165     }
1166 
1167     @TrueIfNull
1168     public boolean testNotEq21_11(MyAbstract u1, MyAbstract u2) {
1169         return u1 != getNotNull(u2); // new acmp without null check
1170     }
1171 
1172     @TrueIfNull
1173     public boolean testNotEq21_12(MyAbstract u1, MyAbstract u2) {
1174         return getNotNull(u1) != getNotNull(u2); // new acmp without null check
1175     }
1176 
1177     public boolean testNotEq22_1(MyValue1 v, MyInterface u) {
1178         return get(v) != u; // only false if both null
1179     }
1180 
1181     public boolean testNotEq22_2(MyValue1 v, MyInterface u) {
1182         return (Object)v != get(u); // only false if both null
1183     }
1184 
1185     public boolean testNotEq22_3(MyValue1 v, MyInterface u) {
1186         return get(v) != get(u); // only false if both null
1187     }
1188 
1189     public boolean testNotEq22_4(MyValue1 v, MyAbstract u) {
1190         return get(v) != u; // only false if both null
1191     }
1192 
1193     public boolean testNotEq22_5(MyValue1 v, MyAbstract u) {
1194         return (Object)v != get(u); // only false if both null
1195     }
1196 
1197     public boolean testNotEq22_6(MyValue1 v, MyAbstract u) {
1198         return get(v) != get(u); // only false if both null
1199     }
1200 
1201     public boolean testNotEq23_1(MyInterface u, MyValue1 v) {
1202         return get(u) != (Object)v; // only false if both null
1203     }
1204 
1205     public boolean testNotEq23_2(MyInterface u, MyValue1 v) {
1206         return u != get(v); // only false if both null
1207     }
1208 
1209     public boolean testNotEq23_3(MyInterface u, MyValue1 v) {
1210         return get(u) != get(v); // only false if both null
1211     }
1212 
1213     public boolean testNotEq23_4(MyAbstract u, MyValue1 v) {
1214         return get(u) != (Object)v; // only false if both null
1215     }
1216 
1217     public boolean testNotEq23_5(MyAbstract u, MyValue1 v) {
1218         return u != get(v); // only false if both null
1219     }
1220 
1221     public boolean testNotEq23_6(MyAbstract u, MyValue1 v) {
1222         return get(u) != get(v); // only false if both null
1223     }
1224 
1225     public boolean testNotEq24_1(MyValue1 v, MyInterface u) {
1226         return getNotNull(v) != u; // true
1227     }
1228 
1229     public boolean testNotEq24_2(MyValue1 v, MyInterface u) {
1230         return (Object)v != getNotNull(u); // true
1231     }
1232 
1233     public boolean testNotEq24_3(MyValue1 v, MyInterface u) {
1234         return getNotNull(v) != getNotNull(u); // true
1235     }
1236 
1237     public boolean testNotEq24_4(MyValue1 v, MyAbstract u) {
1238         return getNotNull(v) != u; // true
1239     }
1240 
1241     public boolean testNotEq24_5(MyValue1 v, MyAbstract u) {
1242         return (Object)v != getNotNull(u); // true
1243     }
1244 
1245     public boolean testNotEq24_6(MyValue1 v, MyAbstract u) {
1246         return getNotNull(v) != getNotNull(u); // true
1247     }
1248 
1249     public boolean testNotEq25_1(MyInterface u, MyValue1 v) {
1250         return getNotNull(u) != (Object)v; // true
1251     }
1252 
1253     public boolean testNotEq25_2(MyInterface u, MyValue1 v) {
1254         return u != getNotNull(v); // true
1255     }
1256 
1257     public boolean testNotEq25_3(MyInterface u, MyValue1 v) {
1258         return getNotNull(u) != getNotNull(v); // true
1259     }
1260 
1261     public boolean testNotEq25_4(MyAbstract u, MyValue1 v) {
1262         return getNotNull(u) != (Object)v; // true
1263     }
1264 
1265     public boolean testNotEq25_5(MyAbstract u, MyValue1 v) {
1266         return u != getNotNull(v); // true
1267     }
1268 
1269     public boolean testNotEq25_6(MyAbstract u, MyValue1 v) {
1270         return getNotNull(u) != getNotNull(v); // true
1271     }
1272 
1273     public boolean testNotEq26_1(MyInterface u, MyObject o) {
1274         return get(u) != o; // old acmp
1275     }
1276 
1277     public boolean testNotEq26_2(MyInterface u, MyObject o) {
1278         return u != get(o); // old acmp
1279     }
1280 
1281     public boolean testNotEq26_3(MyInterface u, MyObject o) {
1282         return get(u) != get(o); // old acmp
1283     }
1284 
1285     public boolean testNotEq26_4(MyAbstract u, MyObject o) {
1286         return get(u) != o; // old acmp
1287     }
1288 
1289     public boolean testNotEq26_5(MyAbstract u, MyObject o) {
1290         return u != get(o); // old acmp
1291     }
1292 
1293     public boolean testNotEq26_6(MyAbstract u, MyObject o) {
1294         return get(u) != get(o); // old acmp
1295     }
1296 
1297     public boolean testNotEq27_1(MyObject o, MyInterface u) {
1298         return get(o) != u; // old acmp
1299     }
1300 
1301     public boolean testNotEq27_2(MyObject o, MyInterface u) {
1302         return o != get(u); // old acmp
1303     }
1304 
1305     public boolean testNotEq27_3(MyObject o, MyInterface u) {
1306         return get(o) != get(u); // old acmp
1307     }
1308 
1309     public boolean testNotEq27_4(MyObject o, MyAbstract u) {
1310         return get(o) != u; // old acmp
1311     }
1312 
1313     public boolean testNotEq27_5(MyObject o, MyAbstract u) {
1314         return o != get(u); // old acmp
1315     }
1316 
1317     public boolean testNotEq27_6(MyObject o, MyAbstract u) {
1318         return get(o) != get(u); // old acmp
1319     }
1320 
1321     public boolean testNotEq28_1(MyInterface[] a, MyInterface u) {
1322         return get(a) != u; // old acmp
1323     }
1324 
1325     public boolean testNotEq28_2(MyInterface[] a, MyInterface u) {
1326         return a != get(u); // old acmp
1327     }
1328 
1329     public boolean testNotEq28_3(MyInterface[] a, MyInterface u) {
1330         return get(a) != get(u); // old acmp
1331     }
1332 
1333     public boolean testNotEq28_4(MyAbstract[] a, MyAbstract u) {
1334         return get(a) != u; // old acmp
1335     }
1336 
1337     public boolean testNotEq28_5(MyAbstract[] a, MyAbstract u) {
1338         return a != get(u); // old acmp
1339     }
1340 
1341     public boolean testNotEq28_6(MyAbstract[] a, MyAbstract u) {
1342         return get(a) != get(u); // old acmp
1343     }
1344 
1345     public boolean testNotEq29_1(MyInterface u, MyInterface[] a) {
1346         return get(u) != a; // old acmp
1347     }
1348 
1349     public boolean testNotEq29_2(MyInterface u, MyInterface[] a) {
1350         return u != get(a); // old acmp
1351     }
1352 
1353     public boolean testNotEq29_3(MyInterface u, MyInterface[] a) {
1354         return get(u) != get(a); // old acmp
1355     }
1356 
1357     public boolean testNotEq29_4(MyAbstract u, MyAbstract[] a) {
1358         return get(u) != a; // old acmp
1359     }
1360 
1361     public boolean testNotEq29_5(MyAbstract u, MyAbstract[] a) {
1362         return u != get(a); // old acmp
1363     }
1364 
1365     public boolean testNotEq29_6(MyAbstract u, MyAbstract[] a) {
1366         return get(u) != get(a); // old acmp
1367     }
1368 
1369     public boolean testNotEq30_1(MyInterface[] a, MyValue1 v) {
1370         return get(a) != (Object)v; // only false if both null
1371     }
1372 
1373     public boolean testNotEq30_2(MyInterface[] a, MyValue1 v) {
1374         return a != get(v); // only false if both null
1375     }
1376 
1377     public boolean testNotEq30_3(MyInterface[] a, MyValue1 v) {
1378         return get(a) != get(v); // only false if both null
1379     }
1380 
1381     public boolean testNotEq30_4(MyAbstract[] a, MyValue1 v) {
1382         return get(a) != (Object)v; // only false if both null
1383     }
1384 
1385     public boolean testNotEq30_5(MyAbstract[] a, MyValue1 v) {
1386         return a != get(v); // only false if both null
1387     }
1388 
1389     public boolean testNotEq30_6(MyAbstract[] a, MyValue1 v) {
1390         return get(a) != get(v); // only false if both null
1391     }
1392 
1393     public boolean testNotEq31_1(MyValue1 v, MyInterface[] a) {
1394         return get(v) != a; // only false if both null
1395     }
1396 
1397     public boolean testNotEq31_2(MyValue1 v, MyInterface[] a) {
1398         return (Object)v != get(a); // only false if both null
1399     }
1400 
1401     public boolean testNotEq31_3(MyValue1 v, MyInterface[] a) {
1402         return get(v) != get(a); // only false if both null
1403     }
1404 
1405     public boolean testNotEq31_4(MyValue1 v, MyAbstract[] a) {
1406         return get(v) != a; // only false if both null
1407     }
1408 
1409     public boolean testNotEq31_5(MyValue1 v, MyAbstract[] a) {
1410         return (Object)v != get(a); // only false if both null
1411     }
1412 
1413     public boolean testNotEq31_6(MyValue1 v, MyAbstract[] a) {
1414         return get(v) != get(a); // only false if both null
1415     }
1416 
1417     public boolean testNotEq32_1(MyInterface[] a, MyValue1 v) {
1418         return getNotNull(a) != (Object)v; // true
1419     }
1420 
1421     public boolean testNotEq32_2(MyInterface[] a, MyValue1 v) {
1422         return a != getNotNull(v); // true
1423     }
1424 
1425     public boolean testNotEq32_3(MyInterface[] a, MyValue1 v) {
1426         return getNotNull(a) != getNotNull(v); // true
1427     }
1428 
1429     public boolean testNotEq32_4(MyAbstract[] a, MyValue1 v) {
1430         return getNotNull(a) != (Object)v; // true
1431     }
1432 
1433     public boolean testNotEq32_5(MyAbstract[] a, MyValue1 v) {
1434         return a != getNotNull(v); // true
1435     }
1436 
1437     public boolean testNotEq32_6(MyAbstract[] a, MyValue1 v) {
1438         return getNotNull(a) != getNotNull(v); // true
1439     }
1440 
1441     public boolean testNotEq33_1(MyValue1 v, MyInterface[] a) {
1442         return getNotNull(v) != a; // true
1443     }
1444 
1445     public boolean testNotEq33_2(MyValue1 v, MyInterface[] a) {
1446         return (Object)v != getNotNull(a); // true
1447     }
1448 
1449     public boolean testNotEq33_3(MyValue1 v, MyInterface[] a) {
1450         return getNotNull(v) != getNotNull(a); // true
1451     }
1452 
1453     public boolean testNotEq33_4(MyValue1 v, MyAbstract[] a) {
1454         return getNotNull(v) != a; // true
1455     }
1456 
1457     public boolean testNotEq33_5(MyValue1 v, MyAbstract[] a) {
1458         return (Object)v != getNotNull(a); // true
1459     }
1460 
1461     public boolean testNotEq33_6(MyValue1 v, MyAbstract[] a) {
1462         return getNotNull(v) != getNotNull(a); // true
1463     }
1464 
1465     // Null tests
1466 
1467     public boolean testNotNull01_1(MyValue1 v) {
1468         return (Object)v != null; // old acmp
1469     }
1470 
1471     public boolean testNotNull01_2(MyValue1 v) {
1472         return get(v) != null; // old acmp
1473     }
1474 
1475     public boolean testNotNull01_3(MyValue1 v) {
1476         return (Object)v != get((Object)null); // old acmp
1477     }
1478 
1479     public boolean testNotNull01_4(MyValue1 v) {
1480         return get(v) != get((Object)null); // old acmp
1481     }
1482 
1483     public boolean testNotNull02_1(MyValue1 v) {
1484         return null != (Object)v; // old acmp
1485     }
1486 
1487     public boolean testNotNull02_2(MyValue1 v) {
1488         return get((Object)null) != (Object)v; // old acmp
1489     }
1490 
1491     public boolean testNotNull02_3(MyValue1 v) {
1492         return null != get(v); // old acmp
1493     }
1494 
1495     public boolean testNotNull02_4(MyValue1 v) {
1496         return get((Object)null) != get(v); // old acmp
1497     }
1498 
1499     public boolean testNotNull03_1(Object u) {
1500         return u != null; // old acmp
1501     }
1502 
1503     public boolean testNotNull03_2(Object u) {
1504         return get(u) != null; // old acmp
1505     }
1506 
1507     public boolean testNotNull03_3(Object u) {
1508         return u != get((Object)null); // old acmp
1509     }
1510 
1511     public boolean testNotNull03_4(Object u) {
1512         return get(u) != get((Object)null); // old acmp
1513     }
1514 
1515     public boolean testNotNull04_1(Object u) {
1516         return null != u; // old acmp
1517     }
1518 
1519     public boolean testNotNull04_2(Object u) {
1520         return get((Object)null) != u; // old acmp
1521     }
1522 
1523     public boolean testNotNull04_3(Object u) {
1524         return null != get(u); // old acmp
1525     }
1526 
1527     public boolean testNotNull04_4(Object u) {
1528         return get((Object)null) != get(u); // old acmp
1529     }
1530 
1531     public boolean testNotNull05_1(MyObject o) {
1532         return o != null; // old acmp
1533     }
1534 
1535     public boolean testNotNull05_2(MyObject o) {
1536         return get(o) != null; // old acmp
1537     }
1538 
1539     public boolean testNotNull05_3(MyObject o) {
1540         return o != get((Object)null); // old acmp
1541     }
1542 
1543     public boolean testNotNull05_4(MyObject o) {
1544         return get(o) != get((Object)null); // old acmp
1545     }
1546 
1547     public boolean testNotNull06_1(MyObject o) {
1548         return null != o; // old acmp
1549     }
1550 
1551     public boolean testNotNull06_2(MyObject o) {
1552         return get((Object)null) != o; // old acmp
1553     }
1554 
1555     public boolean testNotNull06_3(MyObject o) {
1556         return null != get(o); // old acmp
1557     }
1558 
1559     public boolean testNotNull06_4(MyObject o) {
1560         return get((Object)null) != get(o); // old acmp
1561     }
1562 
1563     public boolean testNotNull07_1(MyInterface u) {
1564         return u != null; // old acmp
1565     }
1566 
1567     public boolean testNotNull07_2(MyInterface u) {
1568         return get(u) != null; // old acmp
1569     }
1570 
1571     public boolean testNotNull07_3(MyInterface u) {
1572         return u != get((Object)null); // old acmp
1573     }
1574 
1575     public boolean testNotNull07_4(MyInterface u) {
1576         return get(u) != get((Object)null); // old acmp
1577     }
1578 
1579     public boolean testNotNull07_5(MyAbstract u) {
1580         return u != null; // old acmp
1581     }
1582 
1583     public boolean testNotNull07_6(MyAbstract u) {
1584         return get(u) != null; // old acmp
1585     }
1586 
1587     public boolean testNotNull07_7(MyAbstract u) {
1588         return u != get((Object)null); // old acmp
1589     }
1590 
1591     public boolean testNotNull07_8(MyAbstract u) {
1592         return get(u) != get((Object)null); // old acmp
1593     }
1594 
1595     public boolean testNotNull08_1(MyInterface u) {
1596         return null != u; // old acmp
1597     }
1598 
1599     public boolean testNotNull08_2(MyInterface u) {
1600         return get((Object)null) != u; // old acmp
1601     }
1602 
1603     public boolean testNotNull08_3(MyInterface u) {
1604         return null != get(u); // old acmp
1605     }
1606 
1607     public boolean testNotNull08_4(MyInterface u) {
1608         return get((Object)null) != get(u); // old acmp
1609     }
1610 
1611     public boolean testNotNull08_5(MyAbstract u) {
1612         return null != u; // old acmp
1613     }
1614 
1615     public boolean testNotNull08_6(MyAbstract u) {
1616         return get((Object)null) != u; // old acmp
1617     }
1618 
1619     public boolean testNotNull08_7(MyAbstract u) {
1620         return null != get(u); // old acmp
1621     }
1622 
1623     public boolean testNotNull08_8(MyAbstract u) {
1624         return get((Object)null) != get(u); // old acmp
1625     }
1626 
1627     // The following methods are used with -XX:+AlwaysIncrementalInline to hide exact types during parsing
1628 
1629     public Object get(Object u) {
1630         return u;
1631     }
1632 
1633     public Object getNotNull(Object u) {
1634         return (u != null) ? u : new Object();
1635     }
1636 
1637     public Object get(MyValue1 v) {
1638         return v;
1639     }
1640 
1641     public Object getNotNull(MyValue1 v) {
1642         return ((Object)v != null) ? v : MyValue1.createDefault();
1643     }
1644 
1645     public Object get(MyObject o) {
1646         return o;
1647     }
1648 
1649     public Object getNotNull(MyObject o) {
1650         return (o != null) ? o : MyValue1.createDefault();
1651     }
1652 
1653     public Object get(Object[] a) {
1654         return a;
1655     }
1656 
1657     public Object getNotNull(Object[] a) {
1658         return (a != null) ? a : new Object[1];
1659     }
1660 
1661     public boolean trueIfNull(Method m) {
1662         return m.isAnnotationPresent(TrueIfNull.class);
1663     }
1664 
1665     public boolean falseIfNull(Method m) {
1666         return m.isAnnotationPresent(FalseIfNull.class);
1667     }
1668 
1669     public boolean isNegated(Method m) {
1670         return m.getName().startsWith(&quot;testNot&quot;);
1671     }
1672 
1673     // Tests with profiling
1674     public boolean cmpAlwaysEqual1(Object a, Object b) {
1675         return a == b;
1676     }
1677 
1678     public boolean cmpAlwaysEqual2(Object a, Object b) {
1679         return a != b;
1680     }
1681 
1682     public boolean cmpAlwaysEqual3(Object a) {
1683         return a == a;
1684     }
1685 
1686     public boolean cmpAlwaysEqual4(Object a) {
1687         return a != a;
1688     }
1689 
1690     public boolean cmpAlwaysUnEqual1(Object a, Object b) {
1691         return a == b;
1692     }
1693 
1694     public boolean cmpAlwaysUnEqual2(Object a, Object b) {
1695         return a != b;
1696     }
1697 
1698     public boolean cmpAlwaysUnEqual3(Object a) {
1699         return a == a;
1700     }
1701 
1702     public boolean cmpAlwaysUnEqual4(Object a) {
1703         return a != a;
1704     }
1705 
1706     public boolean cmpSometimesEqual1(Object a) {
1707         return a == a;
1708     }
1709 
1710     public boolean cmpSometimesEqual2(Object a) {
1711         return a != a;
1712     }
1713 
1714     static int get_full_opt_level() {
1715         int n = (int)TieredStopAtLevel;
1716         if (n &gt;= 4) {
1717             n = 4;
1718         }
1719         return n;
1720     }
1721     protected static final WhiteBox WHITE_BOX = WhiteBox.getWhiteBox();
1722     protected static final long TieredStopAtLevel = (Long)WHITE_BOX.getVMFlag(&quot;TieredStopAtLevel&quot;);
1723     protected static final int COMP_LEVEL_FULL_OPTIMIZATION = get_full_opt_level();
1724 
1725     public void runTest(Method m, Object[] args, int warmup, int nullMode, boolean[][] equalities) throws Exception {
1726         Class&lt;?&gt;[] parameterTypes = m.getParameterTypes();
1727         int parameterCount = parameterTypes.length;
1728         // Nullness mode for first argument
1729         // 0: default, 1: never null, 2: always null
1730         int start = (nullMode != 1) ? 0 : 1;
1731         int end = (nullMode != 2) ? args.length : 1;
1732         for (int i = start; i &lt; end; ++i) {
1733             if (args[i] != null &amp;&amp; !parameterTypes[0].isInstance(args[i])) {
1734                 continue;
1735             }
1736             if (args[i] == null &amp;&amp; parameterTypes[0] == MyValue1.class) {
1737                 continue;
1738             }
1739             if (parameterCount == 1) {
1740                 // Null checks
1741                 System.out.print(&quot;Testing &quot; + m.getName() + &quot;(&quot; + args[i] + &quot;)&quot;);
1742                 // Avoid acmp in the computation of the expected result!
1743                 boolean expected = isNegated(m) ? (i != 0) : (i == 0);
1744                 for (int run = 0; run &lt; warmup; ++run) {
1745                     Boolean result = (Boolean)m.invoke(this, args[i]);
1746                     if (result != expected &amp;&amp; WHITE_BOX.isMethodCompiled(m, false)) {
1747                         System.out.println(&quot; = &quot; + result);
1748                         throw new RuntimeException(&quot;Test failed: should return &quot; + expected);
1749                     }
1750                 }
1751                 System.out.println(&quot; = &quot; + expected);
1752             } else {
1753                 // Equality checks
1754                 for (int j = 0; j &lt; args.length; ++j) {
1755                     if (args[j] != null &amp;&amp; !parameterTypes[1].isInstance(args[j])) {
1756                         continue;
1757                     }
1758                     if (args[j] == null &amp;&amp; parameterTypes[1] == MyValue1.class) {
1759                         continue;
1760                     }
1761                     System.out.print(&quot;Testing &quot; + m.getName() + &quot;(&quot; + args[i] + &quot;, &quot; + args[j] + &quot;)&quot;);
1762                     // Avoid acmp in the computation of the expected result!
1763                     boolean equal = equalities[i][j];
1764                     equal = isNegated(m) ? !equal : equal;
1765                     boolean expected = ((i == 0 || j == 0) &amp;&amp; trueIfNull(m)) || (equal &amp;&amp; !(i == 0 &amp;&amp; falseIfNull(m)));
1766                     for (int run = 0; run &lt; warmup; ++run) {
1767                         Boolean result = (Boolean)m.invoke(this, args[i], args[j]);
1768                         if (result != expected &amp;&amp; WHITE_BOX.isMethodCompiled(m, false) &amp;&amp; warmup == 1) {
1769                             System.out.println(&quot; = &quot; + result);
1770                             throw new RuntimeException(&quot;Test failed: should return &quot; + expected);
1771                         }
1772                     }
1773                     System.out.println(&quot; = &quot; + expected);
1774                 }
1775             }
1776         }
1777     }
1778 
1779     public void run(int nullMode) throws Exception {
1780         // Prepare test arguments
1781         Object[] args =  { null,
1782                            new Object(),
1783                            new MyObject(),
1784                            MyValue1.setX(MyValue1.createDefault(), 42),
1785                            new Object[10],
1786                            new MyObject[10],
1787                            MyValue1.setX(MyValue1.createDefault(), 0x42),
1788                            MyValue1.setX(MyValue1.createDefault(), 42),
1789                            MyValue2.setX(MyValue2.createDefault(), 42), };
1790 
1791         boolean[][] equalities = { { true,  false, false, false, false, false, false, false, false },
1792                                    { false, true,  false, false, false, false, false, false, false },
1793                                    { false, false, true,  false, false, false, false, false, false },
1794                                    { false, false, false, true,  false, false, false, true,  false },
1795                                    { false, false, false, false, true,  false, false, false, false },
1796                                    { false, false, false, false, false, true,  false, false, false },
1797                                    { false, false, false, false, false, false, true,  false, false },
1798                                    { false, false, false, true,  false, false, false, true,  false },
1799                                    { false, false, false, false, false, false, false, false, true  } };
1800 
1801         // Run tests
1802         for (Method m : getClass().getMethods()) {
1803             if (m.getName().startsWith(&quot;test&quot;)) {
1804                 // Do some warmup runs
1805                 runTest(m, args, 1000, nullMode, equalities);
1806                 // Make sure method is compiled
1807                 ValueTypeTest.enqueueMethodForCompilation(m, COMP_LEVEL_FULL_OPTIMIZATION);
1808                 Asserts.assertTrue(WHITE_BOX.isMethodCompiled(m, false), m + &quot; not compiled&quot;);
1809                 // Run again to verify correctness of compiled code
1810                 runTest(m, args, 1, nullMode, equalities);
1811             }
1812         }
1813 
1814         Method cmpAlwaysUnEqual3_m = getClass().getMethod(&quot;cmpAlwaysUnEqual3&quot;, Object.class);
1815         Method cmpAlwaysUnEqual4_m = getClass().getMethod(&quot;cmpAlwaysUnEqual4&quot;, Object.class);
1816         Method cmpSometimesEqual1_m = getClass().getMethod(&quot;cmpSometimesEqual1&quot;, Object.class);
1817         Method cmpSometimesEqual2_m = getClass().getMethod(&quot;cmpSometimesEqual2&quot;, Object.class);
1818 
1819         for (int i = 0; i &lt; 20_000; ++i) {
1820             Asserts.assertTrue(cmpAlwaysEqual1(args[1], args[1]));
1821             Asserts.assertFalse(cmpAlwaysEqual2(args[1], args[1]));
1822             Asserts.assertTrue(cmpAlwaysEqual3(args[1]));
1823             Asserts.assertFalse(cmpAlwaysEqual4(args[1]));
1824 
1825             Asserts.assertFalse(cmpAlwaysUnEqual1(args[1], args[2]));
1826             Asserts.assertTrue(cmpAlwaysUnEqual2(args[1], args[2]));
1827             boolean res = cmpAlwaysUnEqual3(args[3]);
1828             Asserts.assertTrue(res);
1829             res = cmpAlwaysUnEqual4(args[3]);
1830             Asserts.assertFalse(res);
1831 
1832             int idx = i % args.length;
1833             res = cmpSometimesEqual1(args[idx]);
1834             Asserts.assertTrue(res);
1835             res = cmpSometimesEqual2(args[idx]);
1836             Asserts.assertFalse(res);
1837         }
1838     }
1839 
1840     public static void main(String[] args) throws Exception {
1841         if (args.length == 0) {
1842             enumerateVMOptions();
1843         } else {
1844             int nullMode = Integer.valueOf(args[0]);
1845             TestNewAcmp t = new TestNewAcmp();
1846             t.run(nullMode);
1847         }
1848     }
1849 
1850     private static String[] addOptions(String prefix[], String... extra) {
1851         ArrayList&lt;String&gt; list = new ArrayList&lt;String&gt;();
1852         if (prefix != null) {
1853             for (String s : prefix) {
1854                 list.add(s);
1855             }
1856         }
1857         if (extra != null) {
1858             for (String s : extra) {
1859                 System.out.println(&quot;    &quot; + s);
1860                 list.add(s);
1861             }
1862         }
1863 
1864         return list.toArray(new String[list.size()]);
1865     }
1866 
1867     private static void enumerateVMOptions() throws Exception {
1868         String[] baseOptions = {
1869             &quot;-Xbootclasspath/a:.&quot;,
1870             &quot;-XX:+UnlockDiagnosticVMOptions&quot;,
1871             &quot;-XX:+WhiteBoxAPI&quot;,
1872             &quot;-Xbatch&quot;,
1873             &quot;-XX:TypeProfileLevel=222&quot;,
1874             &quot;-XX:CompileCommand=dontinline,compiler.valhalla.valuetypes.TestNewAcmp::test*&quot;,
1875             &quot;-XX:CompileCommand=dontinline,compiler.valhalla.valuetypes.TestNewAcmp::cmp*&quot;};
1876 
1877         String SCENARIOS = System.getProperty(&quot;Scenarios&quot;, &quot;&quot;);
1878         List&lt;String&gt; scenarios = null;
1879         if (!SCENARIOS.isEmpty()) {
1880            scenarios = Arrays.asList(SCENARIOS.split(&quot;,&quot;));
1881         }
1882 
1883         int scenario = -1;
1884         for (int nullMode = 0; nullMode &lt;= 2; nullMode++) {          // null mode
1885             for (int incrInline = 0; incrInline &lt; 2; incrInline++) { // 0 = default, 1 = -XX:+AlwaysIncrementalInline
1886                 scenario++;
1887                 System.out.println(&quot;Scenario #&quot; + scenario + &quot; -------------------&quot;);
1888                 String[] cmds = baseOptions;
1889                 if (incrInline != 0) {
1890                     cmds = addOptions(cmds, &quot;-XX:+IgnoreUnrecognizedVMOptions&quot;, &quot;-XX:+AlwaysIncrementalInline&quot;);
1891                 }
1892 
1893                 cmds = addOptions(cmds, &quot;compiler.valhalla.valuetypes.TestNewAcmp&quot;);
1894                 cmds = addOptions(cmds, Integer.toString(nullMode));
1895 
1896                 if (scenarios != null &amp;&amp; !scenarios.contains(Integer.toString(scenario))) {
1897                     System.out.println(&quot;Scenario #&quot; + scenario + &quot; is skipped due to -Dscenarios=&quot; + SCENARIOS);
1898                     continue;
1899                 }
1900 
1901                 OutputAnalyzer oa = ProcessTools.executeTestJvm(cmds);
1902                 String output = oa.getOutput();
1903                 oa.shouldHaveExitValue(0);
1904                 System.out.println(output);
1905             }
1906         }
1907     }
1908 }
    </pre>
  </body>
</html>