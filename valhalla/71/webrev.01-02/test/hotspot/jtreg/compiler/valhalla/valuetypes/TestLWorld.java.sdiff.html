<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/hotspot/jtreg/compiler/valhalla/valuetypes/TestLWorld.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../src/hotspot/share/opto/valuetypenode.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../../../../micro/org/openjdk/bench/valhalla/lworld/escapeanalysis/TestBoxing.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/compiler/valhalla/valuetypes/TestLWorld.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
2892         MyValue2[] dst1 = new MyValue2[100];
2893         Object[] dst2 = new Object[100];
2894         Object o1 = new Object();
2895         rerun_and_recompile_for(&quot;TestLWorld::test108&quot;, 10,
2896                                 () -&gt; { test108(dst1, dst2, testValue2, o1);
2897                                         for (int i = 0; i &lt; dst1.length; i++) {
2898                                             Asserts.assertEquals(dst1[i], testValue2);
2899                                             Asserts.assertEquals(dst2[i], o1);
2900                                         }
2901                                         test108(dst2, dst1, o1, testValue2);
2902                                         for (int i = 0; i &lt; dst1.length; i++) {
2903                                             Asserts.assertEquals(dst1[i], testValue2);
2904                                             Asserts.assertEquals(dst2[i], o1);
2905                                         } });
2906     }
2907 
2908     // Escape analysis tests
2909 
2910     static interface WrapperInterface {
2911         long value();






2912     }
2913 
2914     static inline class LongWrapper implements WrapperInterface {
2915         final static LongWrapper ZERO = new LongWrapper(0);
<span class="line-modified">2916         long val;</span>
2917 
2918         LongWrapper(long val) {
2919             this.val = val;
2920         }
2921 
2922         static LongWrapper wrap(long val) {
<span class="line-modified">2923             return (val == 0L) ? LongWrapper.ZERO : new LongWrapper(val);</span>
2924         }
2925 
2926         public long value() {
2927             return val;
2928         }
2929     }
2930 
2931     static class InterfaceBox {
2932         WrapperInterface content;
2933 
<span class="line-modified">2934         InterfaceBox(long val) {</span>
<span class="line-modified">2935             this.content = LongWrapper.wrap(val);</span>




2936         }
2937 
2938         static InterfaceBox box(long val) {
<span class="line-modified">2939             return new InterfaceBox(val);</span>
2940         }
2941     }
2942 
2943     static class ObjectBox {
2944         Object content;
2945 
<span class="line-modified">2946         ObjectBox(long val) {</span>
<span class="line-modified">2947             this.content = LongWrapper.wrap(val);</span>




2948         }
2949 
2950         static ObjectBox box(long val) {
<span class="line-modified">2951             return new ObjectBox(val);</span>
2952         }
2953     }
2954 
2955     static class RefBox {
2956         LongWrapper.ref content;
2957 
<span class="line-modified">2958         RefBox(long val) {</span>
<span class="line-modified">2959             this.content = LongWrapper.wrap(val);</span>




2960         }
2961 
2962         static RefBox box(long val) {
<span class="line-modified">2963             return new RefBox(val);</span>
2964         }
2965     }
2966 
2967     static class InlineBox {
2968         LongWrapper content;
2969 
2970         InlineBox(long val) {
2971             this.content = LongWrapper.wrap(val);
2972         }
2973 
2974         static InlineBox box(long val) {
2975             return new InlineBox(val);
2976         }
2977     }
2978 
2979     static class GenericBox&lt;T&gt; {
2980         T content;
2981 
<span class="line-modified">2982         static GenericBox&lt;LongWrapper.ref&gt; box(long val) {</span>
2983             GenericBox&lt;LongWrapper.ref&gt; res = new GenericBox&lt;&gt;();
2984             res.content = LongWrapper.wrap(val);
2985             return res;
2986         }






2987     }
2988 
2989     long[] lArr = {0L, rL, 0L, rL, 0L, rL, 0L, rL, 0L, rL};
2990 
2991     // Test removal of allocations when inline type instance is wrapped into box object
<span class="line-modified">2992     @Warmup(10000) // Make sure value() call on WrapperInterface is inlined</span>
2993     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })
2994     public long test109() {
2995         long res = 0;
2996         for (int i = 0 ; i &lt; lArr.length; i++) {
2997             res += InterfaceBox.box(lArr[i]).content.value();
2998         }
2999         return res;
3000     }
3001 
3002     @DontCompile
3003     public void test109_verifier(boolean warmup) {
3004         long res = test109();
3005         Asserts.assertEquals(res, 5*rL);
3006     }
3007 
















3008     // Same as test109 but with ObjectBox
3009     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })
<span class="line-modified">3010     @Warmup(10000) // Make sure value() call on WrapperInterface is inlined</span>
<span class="line-modified">3011     public long test110(long[] arr) {</span>
3012         long res = 0;
<span class="line-modified">3013         for (int i = 0 ; i &lt; arr.length; i++) {</span>
3014             res += ((WrapperInterface)ObjectBox.box(lArr[i]).content).value();
3015         }
3016         return res;
3017     }
3018 
3019     @DontCompile
3020     public void test110_verifier(boolean warmup) {
<span class="line-modified">3021         long[] arr = {0L, rL, 0L, rL, 0L};</span>
<span class="line-modified">3022         long res = test110(arr);</span>
<span class="line-modified">3023         Asserts.assertEquals(res, 2*rL);</span>















3024     }
3025 
3026     // Same as test109 but with RefBox
3027     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })
<span class="line-modified">3028     public long test111(long[] arr) {</span>
3029         long res = 0;
<span class="line-modified">3030         for (int i = 0 ; i &lt; arr.length; i++) {</span>
3031             res += RefBox.box(lArr[i]).content.value();
3032         }
3033         return res;
3034     }
3035 
3036     @DontCompile
3037     public void test111_verifier(boolean warmup) {
<span class="line-modified">3038         long[] arr = {0L, rL, 0L, rL, 0L};</span>
<span class="line-modified">3039         long res = test111(arr);</span>
<span class="line-modified">3040         Asserts.assertEquals(res, 2*rL);</span>














3041     }
3042 
3043     // Same as test109 but with InlineBox
3044     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })
<span class="line-modified">3045     public long test112(long[] arr) {</span>
3046         long res = 0;
<span class="line-modified">3047         for (int i = 0 ; i &lt; arr.length; i++) {</span>
3048             res += InlineBox.box(lArr[i]).content.value();
3049         }
3050         return res;
3051     }
3052 
3053     @DontCompile
3054     public void test112_verifier(boolean warmup) {
<span class="line-modified">3055         long[] arr = {0L, rL, 0L, rL, 0L};</span>
<span class="line-modified">3056         long res = test112(arr);</span>
<span class="line-removed">3057         Asserts.assertEquals(res, 2*rL);</span>
3058     }
3059 
3060     // Same as test109 but with GenericBox
3061     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })
<span class="line-modified">3062     public long test113(long[] arr) {</span>

3063         long res = 0;
<span class="line-modified">3064         for (int i = 0 ; i &lt; arr.length; i++) {</span>
3065             res += GenericBox.box(lArr[i]).content.value();
3066         }
3067         return res;
3068     }
3069 
3070     @DontCompile
3071     public void test113_verifier(boolean warmup) {
<span class="line-modified">3072         long[] arr = {0L, rL, 0L, rL, 0L};</span>
<span class="line-modified">3073         long res = test113(arr);</span>
<span class="line-modified">3074         Asserts.assertEquals(res, 2*rL);</span>



































































































3075     }
3076 }
</pre>
</td>
<td>
<hr />
<pre>
2892         MyValue2[] dst1 = new MyValue2[100];
2893         Object[] dst2 = new Object[100];
2894         Object o1 = new Object();
2895         rerun_and_recompile_for(&quot;TestLWorld::test108&quot;, 10,
2896                                 () -&gt; { test108(dst1, dst2, testValue2, o1);
2897                                         for (int i = 0; i &lt; dst1.length; i++) {
2898                                             Asserts.assertEquals(dst1[i], testValue2);
2899                                             Asserts.assertEquals(dst2[i], o1);
2900                                         }
2901                                         test108(dst2, dst1, o1, testValue2);
2902                                         for (int i = 0; i &lt; dst1.length; i++) {
2903                                             Asserts.assertEquals(dst1[i], testValue2);
2904                                             Asserts.assertEquals(dst2[i], o1);
2905                                         } });
2906     }
2907 
2908     // Escape analysis tests
2909 
2910     static interface WrapperInterface {
2911         long value();
<span class="line-added">2912 </span>
<span class="line-added">2913         final static WrapperInterface ZERO = new LongWrapper(0);</span>
<span class="line-added">2914 </span>
<span class="line-added">2915         static WrapperInterface wrap(long val) {</span>
<span class="line-added">2916             return (val == 0L) ? ZERO : new LongWrapper(val);</span>
<span class="line-added">2917         }</span>
2918     }
2919 
2920     static inline class LongWrapper implements WrapperInterface {
2921         final static LongWrapper ZERO = new LongWrapper(0);
<span class="line-modified">2922         private long val;</span>
2923 
2924         LongWrapper(long val) {
2925             this.val = val;
2926         }
2927 
2928         static LongWrapper wrap(long val) {
<span class="line-modified">2929             return (val == 0L) ? ZERO : new LongWrapper(val);</span>
2930         }
2931 
2932         public long value() {
2933             return val;
2934         }
2935     }
2936 
2937     static class InterfaceBox {
2938         WrapperInterface content;
2939 
<span class="line-modified">2940         InterfaceBox(WrapperInterface content) {</span>
<span class="line-modified">2941             this.content = content;</span>
<span class="line-added">2942         }</span>
<span class="line-added">2943 </span>
<span class="line-added">2944         static InterfaceBox box_sharp(long val) {</span>
<span class="line-added">2945             return new InterfaceBox(LongWrapper.wrap(val));</span>
2946         }
2947 
2948         static InterfaceBox box(long val) {
<span class="line-modified">2949             return new InterfaceBox(WrapperInterface.wrap(val));</span>
2950         }
2951     }
2952 
2953     static class ObjectBox {
2954         Object content;
2955 
<span class="line-modified">2956         ObjectBox(Object content) {</span>
<span class="line-modified">2957             this.content = content;</span>
<span class="line-added">2958         }</span>
<span class="line-added">2959 </span>
<span class="line-added">2960         static ObjectBox box_sharp(long val) {</span>
<span class="line-added">2961             return new ObjectBox(LongWrapper.wrap(val));</span>
2962         }
2963 
2964         static ObjectBox box(long val) {
<span class="line-modified">2965             return new ObjectBox(WrapperInterface.wrap(val));</span>
2966         }
2967     }
2968 
2969     static class RefBox {
2970         LongWrapper.ref content;
2971 
<span class="line-modified">2972         RefBox(LongWrapper.ref content) {</span>
<span class="line-modified">2973             this.content = content;</span>
<span class="line-added">2974         }</span>
<span class="line-added">2975 </span>
<span class="line-added">2976         static RefBox box_sharp(long val) {</span>
<span class="line-added">2977             return new RefBox(LongWrapper.wrap(val));</span>
2978         }
2979 
2980         static RefBox box(long val) {
<span class="line-modified">2981             return new RefBox((LongWrapper.ref)WrapperInterface.wrap(val));</span>
2982         }
2983     }
2984 
2985     static class InlineBox {
2986         LongWrapper content;
2987 
2988         InlineBox(long val) {
2989             this.content = LongWrapper.wrap(val);
2990         }
2991 
2992         static InlineBox box(long val) {
2993             return new InlineBox(val);
2994         }
2995     }
2996 
2997     static class GenericBox&lt;T&gt; {
2998         T content;
2999 
<span class="line-modified">3000         static GenericBox&lt;LongWrapper.ref&gt; box_sharp(long val) {</span>
3001             GenericBox&lt;LongWrapper.ref&gt; res = new GenericBox&lt;&gt;();
3002             res.content = LongWrapper.wrap(val);
3003             return res;
3004         }
<span class="line-added">3005 </span>
<span class="line-added">3006         static GenericBox&lt;WrapperInterface&gt; box(long val) {</span>
<span class="line-added">3007             GenericBox&lt;WrapperInterface&gt; res = new GenericBox&lt;&gt;();</span>
<span class="line-added">3008             res.content = WrapperInterface.wrap(val);</span>
<span class="line-added">3009             return res;</span>
<span class="line-added">3010         }</span>
3011     }
3012 
3013     long[] lArr = {0L, rL, 0L, rL, 0L, rL, 0L, rL, 0L, rL};
3014 
3015     // Test removal of allocations when inline type instance is wrapped into box object
<span class="line-modified">3016     @Warmup(10000) // Make sure interface calls are inlined</span>
3017     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })
3018     public long test109() {
3019         long res = 0;
3020         for (int i = 0 ; i &lt; lArr.length; i++) {
3021             res += InterfaceBox.box(lArr[i]).content.value();
3022         }
3023         return res;
3024     }
3025 
3026     @DontCompile
3027     public void test109_verifier(boolean warmup) {
3028         long res = test109();
3029         Asserts.assertEquals(res, 5*rL);
3030     }
3031 
<span class="line-added">3032     @Warmup(10000) // Make sure interface calls are inlined</span>
<span class="line-added">3033     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })</span>
<span class="line-added">3034     public long test109_sharp() {</span>
<span class="line-added">3035         long res = 0;</span>
<span class="line-added">3036         for (int i = 0 ; i &lt; lArr.length; i++) {</span>
<span class="line-added">3037             res += InterfaceBox.box_sharp(lArr[i]).content.value();</span>
<span class="line-added">3038         }</span>
<span class="line-added">3039         return res;</span>
<span class="line-added">3040     }</span>
<span class="line-added">3041 </span>
<span class="line-added">3042     @DontCompile</span>
<span class="line-added">3043     public void test109_sharp_verifier(boolean warmup) {</span>
<span class="line-added">3044         long res = test109_sharp();</span>
<span class="line-added">3045         Asserts.assertEquals(res, 5*rL);</span>
<span class="line-added">3046     }</span>
<span class="line-added">3047 </span>
3048     // Same as test109 but with ObjectBox
3049     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })
<span class="line-modified">3050     @Warmup(10000) // Make sure interface calls are inlined</span>
<span class="line-modified">3051     public long test110() {</span>
3052         long res = 0;
<span class="line-modified">3053         for (int i = 0 ; i &lt; lArr.length; i++) {</span>
3054             res += ((WrapperInterface)ObjectBox.box(lArr[i]).content).value();
3055         }
3056         return res;
3057     }
3058 
3059     @DontCompile
3060     public void test110_verifier(boolean warmup) {
<span class="line-modified">3061         long res = test110();</span>
<span class="line-modified">3062         Asserts.assertEquals(res, 5*rL);</span>
<span class="line-modified">3063     }</span>
<span class="line-added">3064 </span>
<span class="line-added">3065     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })</span>
<span class="line-added">3066     @Warmup(10000) // Make sure interface calls are inlined</span>
<span class="line-added">3067     public long test110_sharp() {</span>
<span class="line-added">3068         long res = 0;</span>
<span class="line-added">3069         for (int i = 0 ; i &lt; lArr.length; i++) {</span>
<span class="line-added">3070             res += ((WrapperInterface)ObjectBox.box_sharp(lArr[i]).content).value();</span>
<span class="line-added">3071         }</span>
<span class="line-added">3072         return res;</span>
<span class="line-added">3073     }</span>
<span class="line-added">3074 </span>
<span class="line-added">3075     @DontCompile</span>
<span class="line-added">3076     public void test110_sharp_verifier(boolean warmup) {</span>
<span class="line-added">3077         long res = test110_sharp();</span>
<span class="line-added">3078         Asserts.assertEquals(res, 5*rL);</span>
3079     }
3080 
3081     // Same as test109 but with RefBox
3082     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })
<span class="line-modified">3083     public long test111() {</span>
3084         long res = 0;
<span class="line-modified">3085         for (int i = 0 ; i &lt; lArr.length; i++) {</span>
3086             res += RefBox.box(lArr[i]).content.value();
3087         }
3088         return res;
3089     }
3090 
3091     @DontCompile
3092     public void test111_verifier(boolean warmup) {
<span class="line-modified">3093         long res = test111();</span>
<span class="line-modified">3094         Asserts.assertEquals(res, 5*rL);</span>
<span class="line-modified">3095     }</span>
<span class="line-added">3096 </span>
<span class="line-added">3097     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })</span>
<span class="line-added">3098     public long test111_sharp() {</span>
<span class="line-added">3099         long res = 0;</span>
<span class="line-added">3100         for (int i = 0 ; i &lt; lArr.length; i++) {</span>
<span class="line-added">3101             res += RefBox.box_sharp(lArr[i]).content.value();</span>
<span class="line-added">3102         }</span>
<span class="line-added">3103         return res;</span>
<span class="line-added">3104     }</span>
<span class="line-added">3105 </span>
<span class="line-added">3106     @DontCompile</span>
<span class="line-added">3107     public void test111_sharp_verifier(boolean warmup) {</span>
<span class="line-added">3108         long res = test111_sharp();</span>
<span class="line-added">3109         Asserts.assertEquals(res, 5*rL);</span>
3110     }
3111 
3112     // Same as test109 but with InlineBox
3113     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })
<span class="line-modified">3114     public long test112() {</span>
3115         long res = 0;
<span class="line-modified">3116         for (int i = 0 ; i &lt; lArr.length; i++) {</span>
3117             res += InlineBox.box(lArr[i]).content.value();
3118         }
3119         return res;
3120     }
3121 
3122     @DontCompile
3123     public void test112_verifier(boolean warmup) {
<span class="line-modified">3124         long res = test112();</span>
<span class="line-modified">3125         Asserts.assertEquals(res, 5*rL);</span>

3126     }
3127 
3128     // Same as test109 but with GenericBox
3129     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })
<span class="line-modified">3130     @Warmup(10000) // Make sure interface calls are inlined</span>
<span class="line-added">3131     public long test113() {</span>
3132         long res = 0;
<span class="line-modified">3133         for (int i = 0 ; i &lt; lArr.length; i++) {</span>
3134             res += GenericBox.box(lArr[i]).content.value();
3135         }
3136         return res;
3137     }
3138 
3139     @DontCompile
3140     public void test113_verifier(boolean warmup) {
<span class="line-modified">3141         long res = test113();</span>
<span class="line-modified">3142         Asserts.assertEquals(res, 5*rL);</span>
<span class="line-modified">3143     }</span>
<span class="line-added">3144 </span>
<span class="line-added">3145     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })</span>
<span class="line-added">3146     @Warmup(10000) // Make sure interface calls are inlined</span>
<span class="line-added">3147     public long test113_sharp() {</span>
<span class="line-added">3148         long res = 0;</span>
<span class="line-added">3149         for (int i = 0 ; i &lt; lArr.length; i++) {</span>
<span class="line-added">3150             res += GenericBox.box_sharp(lArr[i]).content.value();</span>
<span class="line-added">3151         }</span>
<span class="line-added">3152         return res;</span>
<span class="line-added">3153     }</span>
<span class="line-added">3154 </span>
<span class="line-added">3155     @DontCompile</span>
<span class="line-added">3156     public void test113_sharp_verifier(boolean warmup) {</span>
<span class="line-added">3157         long res = test113_sharp();</span>
<span class="line-added">3158         Asserts.assertEquals(res, 5*rL);</span>
<span class="line-added">3159     }</span>
<span class="line-added">3160 </span>
<span class="line-added">3161     static interface WrapperInterface2 {</span>
<span class="line-added">3162         public long value();</span>
<span class="line-added">3163 </span>
<span class="line-added">3164         static final InlineWrapper.ref ZERO = new InlineWrapper(0);</span>
<span class="line-added">3165 </span>
<span class="line-added">3166         public static WrapperInterface2 wrap(long val) {</span>
<span class="line-added">3167             return (val == 0) ? ZERO.content : new LongWrapper2(val);</span>
<span class="line-added">3168         }</span>
<span class="line-added">3169 </span>
<span class="line-added">3170         public static WrapperInterface2 wrap_default(long val) {</span>
<span class="line-added">3171             return (val == 0) ? LongWrapper2.default : new LongWrapper2(val);</span>
<span class="line-added">3172         }</span>
<span class="line-added">3173     }</span>
<span class="line-added">3174 </span>
<span class="line-added">3175     static inline class LongWrapper2 implements WrapperInterface2 {</span>
<span class="line-added">3176         private long val;</span>
<span class="line-added">3177 </span>
<span class="line-added">3178         public LongWrapper2(long val) {</span>
<span class="line-added">3179             this.val = val;</span>
<span class="line-added">3180         }</span>
<span class="line-added">3181 </span>
<span class="line-added">3182         public long value() {</span>
<span class="line-added">3183             return val;</span>
<span class="line-added">3184         }</span>
<span class="line-added">3185     }</span>
<span class="line-added">3186 </span>
<span class="line-added">3187     static inline class InlineWrapper {</span>
<span class="line-added">3188         WrapperInterface2 content;</span>
<span class="line-added">3189 </span>
<span class="line-added">3190         public InlineWrapper(long val) {</span>
<span class="line-added">3191             content = new LongWrapper2(val);</span>
<span class="line-added">3192         }</span>
<span class="line-added">3193     }</span>
<span class="line-added">3194 </span>
<span class="line-added">3195     static class InterfaceBox2 {</span>
<span class="line-added">3196         WrapperInterface2 content;</span>
<span class="line-added">3197 </span>
<span class="line-added">3198         public InterfaceBox2(long val, boolean def) {</span>
<span class="line-added">3199             this.content = def ? WrapperInterface2.wrap_default(val) : WrapperInterface2.wrap(val);</span>
<span class="line-added">3200         }</span>
<span class="line-added">3201 </span>
<span class="line-added">3202         static InterfaceBox2 box(long val) {</span>
<span class="line-added">3203             return new InterfaceBox2(val, false);</span>
<span class="line-added">3204         }</span>
<span class="line-added">3205 </span>
<span class="line-added">3206         static InterfaceBox2 box_default(long val) {</span>
<span class="line-added">3207             return new InterfaceBox2(val, true);</span>
<span class="line-added">3208         }</span>
<span class="line-added">3209     }</span>
<span class="line-added">3210 </span>
<span class="line-added">3211     // Same as tests above but with ZERO hidden in field of another inline type</span>
<span class="line-added">3212     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })</span>
<span class="line-added">3213     @Warmup(10000)</span>
<span class="line-added">3214     public long test114() {</span>
<span class="line-added">3215         long res = 0;</span>
<span class="line-added">3216         for (int i = 0; i &lt; lArr.length; i++) {</span>
<span class="line-added">3217             res += InterfaceBox2.box(lArr[i]).content.value();</span>
<span class="line-added">3218         }</span>
<span class="line-added">3219         return res;</span>
<span class="line-added">3220     }</span>
<span class="line-added">3221 </span>
<span class="line-added">3222     @DontCompile</span>
<span class="line-added">3223     public void test114_verifier(boolean warmup) {</span>
<span class="line-added">3224         long res = test114();</span>
<span class="line-added">3225         Asserts.assertEquals(res, 5*rL);</span>
<span class="line-added">3226     }</span>
<span class="line-added">3227 </span>
<span class="line-added">3228     // Same as test114 but with .default instead of ZERO field</span>
<span class="line-added">3229     @Test(failOn = ALLOC_G + MEMBAR, match = { PREDICATE_TRAP }, matchCount = { 1 })</span>
<span class="line-added">3230     @Warmup(10000)</span>
<span class="line-added">3231     public long test115() {</span>
<span class="line-added">3232         long res = 0;</span>
<span class="line-added">3233         for (int i = 0; i &lt; lArr.length; i++) {</span>
<span class="line-added">3234             res += InterfaceBox2.box_default(lArr[i]).content.value();</span>
<span class="line-added">3235         }</span>
<span class="line-added">3236         return res;</span>
<span class="line-added">3237     }</span>
<span class="line-added">3238 </span>
<span class="line-added">3239     @DontCompile</span>
<span class="line-added">3240     public void test115_verifier(boolean warmup) {</span>
<span class="line-added">3241         long res = test115();</span>
<span class="line-added">3242         Asserts.assertEquals(res, 5*rL);</span>
3243     }
3244 }
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../src/hotspot/share/opto/valuetypenode.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../../../../micro/org/openjdk/bench/valhalla/lworld/escapeanalysis/TestBoxing.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>