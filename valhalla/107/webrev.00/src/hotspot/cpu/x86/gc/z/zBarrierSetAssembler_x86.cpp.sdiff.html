<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/cpu/x86/gc/z/zBarrierSetAssembler_x86.cpp</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../shared/barrierSetAssembler_x86.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../interp_masm_x86.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/x86/gc/z/zBarrierSetAssembler_x86.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
181   // Restore scratch register
182   if (tmp1 == noreg) {
183     __ pop(scratch);
184   }
185 
186   BLOCK_COMMENT(&quot;} ZBarrierSetAssembler::load_at&quot;);
187 }
188 
189 #ifdef ASSERT
190 
191 void ZBarrierSetAssembler::store_at(MacroAssembler* masm,
192                                     DecoratorSet decorators,
193                                     BasicType type,
194                                     Address dst,
195                                     Register src,
196                                     Register tmp1,
197                                     Register tmp2,
198                                     Register tmp3) {
199   BLOCK_COMMENT(&quot;ZBarrierSetAssembler::store_at {&quot;);
200 
<span class="line-modified">201   assert(type != T_VALUETYPE, &quot;Not supported yet&quot;);</span>
202   // Verify oop store
203   if (is_reference_type(type)) {
204     // Note that src could be noreg, which means we
205     // are storing null and can skip verification.
206     if (src != noreg) {
207       Label done;
208       __ testptr(src, address_bad_mask_from_thread(r15_thread));
209       __ jcc(Assembler::zero, done);
210       __ stop(&quot;Verify oop store failed&quot;);
211       __ should_not_reach_here();
212       __ bind(done);
213     }
214   }
215 
216   // Store value
217   BarrierSetAssembler::store_at(masm, decorators, type, dst, src, tmp1, tmp2, tmp3);
218 
219   BLOCK_COMMENT(&quot;} ZBarrierSetAssembler::store_at&quot;);
220 }
221 
</pre>
</td>
<td>
<hr />
<pre>
181   // Restore scratch register
182   if (tmp1 == noreg) {
183     __ pop(scratch);
184   }
185 
186   BLOCK_COMMENT(&quot;} ZBarrierSetAssembler::load_at&quot;);
187 }
188 
189 #ifdef ASSERT
190 
191 void ZBarrierSetAssembler::store_at(MacroAssembler* masm,
192                                     DecoratorSet decorators,
193                                     BasicType type,
194                                     Address dst,
195                                     Register src,
196                                     Register tmp1,
197                                     Register tmp2,
198                                     Register tmp3) {
199   BLOCK_COMMENT(&quot;ZBarrierSetAssembler::store_at {&quot;);
200 
<span class="line-modified">201   assert(type != T_INLINE_TYPE, &quot;Not supported yet&quot;);</span>
202   // Verify oop store
203   if (is_reference_type(type)) {
204     // Note that src could be noreg, which means we
205     // are storing null and can skip verification.
206     if (src != noreg) {
207       Label done;
208       __ testptr(src, address_bad_mask_from_thread(r15_thread));
209       __ jcc(Assembler::zero, done);
210       __ stop(&quot;Verify oop store failed&quot;);
211       __ should_not_reach_here();
212       __ bind(done);
213     }
214   }
215 
216   // Store value
217   BarrierSetAssembler::store_at(masm, decorators, type, dst, src, tmp1, tmp2, tmp3);
218 
219   BLOCK_COMMENT(&quot;} ZBarrierSetAssembler::store_at&quot;);
220 }
221 
</pre>
</td>
</tr>
</table>
<center><a href="../shared/barrierSetAssembler_x86.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../interp_masm_x86.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>