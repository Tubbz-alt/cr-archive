<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/runtime/arguments.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../prims/jvm.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="deoptimization.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/runtime/arguments.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
2142   status = CompilerConfig::check_args_consistency(status);
2143 #if INCLUDE_JVMCI
2144   if (status &amp;&amp; EnableJVMCI) {
2145     PropertyList_unique_add(&amp;_system_properties, &quot;jdk.internal.vm.ci.enabled&quot;, &quot;true&quot;,
2146         AddProperty, UnwriteableProperty, InternalProperty);
2147     if (!create_numbered_module_property(&quot;jdk.module.addmods&quot;, &quot;jdk.internal.vm.ci&quot;, addmods_count++)) {
2148       return false;
2149     }
2150   }
2151 #endif
2152 
2153 #ifndef SUPPORT_RESERVED_STACK_AREA
2154   if (StackReservedPages != 0) {
2155     FLAG_SET_CMDLINE(StackReservedPages, 0);
2156     warning(&quot;Reserved Stack Area not supported on this platform&quot;);
2157   }
2158 #endif
2159 
2160   status = status &amp;&amp; GCArguments::check_args_consistency();
2161 










2162   return status;
2163 }
2164 
2165 bool Arguments::is_bad_option(const JavaVMOption* option, jboolean ignore,
2166   const char* option_type) {
2167   if (ignore) return false;
2168 
2169   const char* spacer = &quot; &quot;;
2170   if (option_type == NULL) {
2171     option_type = ++spacer; // Set both to the empty string.
2172   }
2173 
2174   jio_fprintf(defaultStream::error_stream(),
2175               &quot;Unrecognized %s%soption: %s\n&quot;, option_type, spacer,
2176               option-&gt;optionString);
2177   return true;
2178 }
2179 
2180 static const char* user_assertion_options[] = {
2181   &quot;-da&quot;, &quot;-ea&quot;, &quot;-disableassertions&quot;, &quot;-enableassertions&quot;, 0
</pre>
<hr />
<pre>
3056 #endif // INCLUDE_JVMCI
3057 #if INCLUDE_JFR
3058     } else if (match_jfr_option(&amp;option)) {
3059       return JNI_EINVAL;
3060 #endif
3061     } else if (match_option(option, &quot;-XX:&quot;, &amp;tail)) { // -XX:xxxx
3062       // Skip -XX:Flags= and -XX:VMOptionsFile= since those cases have
3063       // already been handled
3064       if ((strncmp(tail, &quot;Flags=&quot;, strlen(&quot;Flags=&quot;)) != 0) &amp;&amp;
3065           (strncmp(tail, &quot;VMOptionsFile=&quot;, strlen(&quot;VMOptionsFile=&quot;)) != 0)) {
3066         if (!process_argument(tail, args-&gt;ignoreUnrecognized, origin)) {
3067           return JNI_EINVAL;
3068         }
3069       }
3070     // Unknown option
3071     } else if (is_bad_option(option, args-&gt;ignoreUnrecognized)) {
3072       return JNI_ERR;
3073     }
3074   }
3075 


















3076   // PrintSharedArchiveAndExit will turn on
3077   //   -Xshare:on
3078   //   -Xlog:class+path=info
3079   if (PrintSharedArchiveAndExit) {
3080     if (FLAG_SET_CMDLINE(UseSharedSpaces, true) != JVMFlag::SUCCESS) {
3081       return JNI_EINVAL;
3082     }
3083     if (FLAG_SET_CMDLINE(RequireSharedSpaces, true) != JVMFlag::SUCCESS) {
3084       return JNI_EINVAL;
3085     }
3086     LogConfiguration::configure_stdout(LogLevel::Info, true, LOG_TAGS(class, path));
3087   }
3088 
3089   fix_appclasspath();
3090 
3091   return JNI_OK;
3092 }
3093 
3094 void Arguments::add_patch_mod_prefix(const char* module_name, const char* path, bool* patch_mod_javabase) {
3095   // For java.base check for duplicate --patch-module options being specified on the command line.
</pre>
<hr />
<pre>
4150   FLAG_SET_DEFAULT(UseBiasedLocking, false);
4151   LP64_ONLY(FLAG_SET_DEFAULT(UseCompressedOops, false));
4152   LP64_ONLY(FLAG_SET_DEFAULT(UseCompressedClassPointers, false));
4153 #endif // CC_INTERP
4154 
4155   if (PrintAssembly &amp;&amp; FLAG_IS_DEFAULT(DebugNonSafepoints)) {
4156     warning(&quot;PrintAssembly is enabled; turning on DebugNonSafepoints to gain additional output&quot;);
4157     DebugNonSafepoints = true;
4158   }
4159 
4160   if (FLAG_IS_CMDLINE(CompressedClassSpaceSize) &amp;&amp; !UseCompressedClassPointers) {
4161     warning(&quot;Setting CompressedClassSpaceSize has no effect when compressed class pointers are not used&quot;);
4162   }
4163 
4164   // Treat the odd case where local verification is enabled but remote
4165   // verification is not as if both were enabled.
4166   if (BytecodeVerificationLocal &amp;&amp; !BytecodeVerificationRemote) {
4167     log_info(verification)(&quot;Turning on remote verification because local verification is on&quot;);
4168     FLAG_SET_DEFAULT(BytecodeVerificationRemote, true);
4169   }





4170 
4171 #ifndef PRODUCT
4172   if (!LogVMOutput &amp;&amp; FLAG_IS_DEFAULT(LogVMOutput)) {
4173     if (use_vm_log()) {
4174       LogVMOutput = true;
4175     }
4176   }
4177 #endif // PRODUCT
4178 
4179   if (PrintCommandLineFlags) {
4180     JVMFlag::printSetFlags(tty);
4181   }
4182 
4183   // Apply CPU specific policy for the BiasedLocking
4184   if (UseBiasedLocking) {
4185     if (!VM_Version::use_biased_locking() &amp;&amp;
4186         !(FLAG_IS_CMDLINE(UseBiasedLocking))) {
4187       UseBiasedLocking = false;
4188     }
4189   }
</pre>
</td>
<td>
<hr />
<pre>
2142   status = CompilerConfig::check_args_consistency(status);
2143 #if INCLUDE_JVMCI
2144   if (status &amp;&amp; EnableJVMCI) {
2145     PropertyList_unique_add(&amp;_system_properties, &quot;jdk.internal.vm.ci.enabled&quot;, &quot;true&quot;,
2146         AddProperty, UnwriteableProperty, InternalProperty);
2147     if (!create_numbered_module_property(&quot;jdk.module.addmods&quot;, &quot;jdk.internal.vm.ci&quot;, addmods_count++)) {
2148       return false;
2149     }
2150   }
2151 #endif
2152 
2153 #ifndef SUPPORT_RESERVED_STACK_AREA
2154   if (StackReservedPages != 0) {
2155     FLAG_SET_CMDLINE(StackReservedPages, 0);
2156     warning(&quot;Reserved Stack Area not supported on this platform&quot;);
2157   }
2158 #endif
2159 
2160   status = status &amp;&amp; GCArguments::check_args_consistency();
2161 
<span class="line-added">2162   if (AMD64_ONLY(false &amp;&amp;) !FLAG_IS_DEFAULT(InlineTypePassFieldsAsArgs)) {</span>
<span class="line-added">2163     FLAG_SET_CMDLINE(InlineTypePassFieldsAsArgs, false);</span>
<span class="line-added">2164     warning(&quot;InlineTypePassFieldsAsArgs is not supported on this platform&quot;);</span>
<span class="line-added">2165   }</span>
<span class="line-added">2166 </span>
<span class="line-added">2167   if (AMD64_ONLY(false &amp;&amp;) !FLAG_IS_DEFAULT(InlineTypeReturnedAsFields)) {</span>
<span class="line-added">2168     FLAG_SET_CMDLINE(InlineTypeReturnedAsFields, false);</span>
<span class="line-added">2169     warning(&quot;InlineTypeReturnedAsFields is not supported on this platform&quot;);</span>
<span class="line-added">2170   }</span>
<span class="line-added">2171 </span>
2172   return status;
2173 }
2174 
2175 bool Arguments::is_bad_option(const JavaVMOption* option, jboolean ignore,
2176   const char* option_type) {
2177   if (ignore) return false;
2178 
2179   const char* spacer = &quot; &quot;;
2180   if (option_type == NULL) {
2181     option_type = ++spacer; // Set both to the empty string.
2182   }
2183 
2184   jio_fprintf(defaultStream::error_stream(),
2185               &quot;Unrecognized %s%soption: %s\n&quot;, option_type, spacer,
2186               option-&gt;optionString);
2187   return true;
2188 }
2189 
2190 static const char* user_assertion_options[] = {
2191   &quot;-da&quot;, &quot;-ea&quot;, &quot;-disableassertions&quot;, &quot;-enableassertions&quot;, 0
</pre>
<hr />
<pre>
3066 #endif // INCLUDE_JVMCI
3067 #if INCLUDE_JFR
3068     } else if (match_jfr_option(&amp;option)) {
3069       return JNI_EINVAL;
3070 #endif
3071     } else if (match_option(option, &quot;-XX:&quot;, &amp;tail)) { // -XX:xxxx
3072       // Skip -XX:Flags= and -XX:VMOptionsFile= since those cases have
3073       // already been handled
3074       if ((strncmp(tail, &quot;Flags=&quot;, strlen(&quot;Flags=&quot;)) != 0) &amp;&amp;
3075           (strncmp(tail, &quot;VMOptionsFile=&quot;, strlen(&quot;VMOptionsFile=&quot;)) != 0)) {
3076         if (!process_argument(tail, args-&gt;ignoreUnrecognized, origin)) {
3077           return JNI_EINVAL;
3078         }
3079       }
3080     // Unknown option
3081     } else if (is_bad_option(option, args-&gt;ignoreUnrecognized)) {
3082       return JNI_ERR;
3083     }
3084   }
3085 
<span class="line-added">3086   if (EnableValhalla) {</span>
<span class="line-added">3087     // create_property(&quot;valhalla.enableValhalla&quot;, &quot;true&quot;, InternalProperty)</span>
<span class="line-added">3088     const char* prop_name = &quot;valhalla.enableValhalla&quot;;</span>
<span class="line-added">3089     const char* prop_value = &quot;true&quot;;</span>
<span class="line-added">3090     const size_t prop_len = strlen(prop_name) + strlen(prop_value) + 2;</span>
<span class="line-added">3091     char* property = AllocateHeap(prop_len, mtArguments);</span>
<span class="line-added">3092     int ret = jio_snprintf(property, prop_len, &quot;%s=%s&quot;, prop_name, prop_value);</span>
<span class="line-added">3093     if (ret &lt; 0 || ret &gt;= (int)prop_len) {</span>
<span class="line-added">3094       FreeHeap(property);</span>
<span class="line-added">3095       return JNI_ENOMEM;</span>
<span class="line-added">3096     }</span>
<span class="line-added">3097     bool added = add_property(property, UnwriteableProperty, InternalProperty);</span>
<span class="line-added">3098     FreeHeap(property);</span>
<span class="line-added">3099     if (!added) {</span>
<span class="line-added">3100       return JNI_ENOMEM;</span>
<span class="line-added">3101     }</span>
<span class="line-added">3102   }</span>
<span class="line-added">3103 </span>
3104   // PrintSharedArchiveAndExit will turn on
3105   //   -Xshare:on
3106   //   -Xlog:class+path=info
3107   if (PrintSharedArchiveAndExit) {
3108     if (FLAG_SET_CMDLINE(UseSharedSpaces, true) != JVMFlag::SUCCESS) {
3109       return JNI_EINVAL;
3110     }
3111     if (FLAG_SET_CMDLINE(RequireSharedSpaces, true) != JVMFlag::SUCCESS) {
3112       return JNI_EINVAL;
3113     }
3114     LogConfiguration::configure_stdout(LogLevel::Info, true, LOG_TAGS(class, path));
3115   }
3116 
3117   fix_appclasspath();
3118 
3119   return JNI_OK;
3120 }
3121 
3122 void Arguments::add_patch_mod_prefix(const char* module_name, const char* path, bool* patch_mod_javabase) {
3123   // For java.base check for duplicate --patch-module options being specified on the command line.
</pre>
<hr />
<pre>
4178   FLAG_SET_DEFAULT(UseBiasedLocking, false);
4179   LP64_ONLY(FLAG_SET_DEFAULT(UseCompressedOops, false));
4180   LP64_ONLY(FLAG_SET_DEFAULT(UseCompressedClassPointers, false));
4181 #endif // CC_INTERP
4182 
4183   if (PrintAssembly &amp;&amp; FLAG_IS_DEFAULT(DebugNonSafepoints)) {
4184     warning(&quot;PrintAssembly is enabled; turning on DebugNonSafepoints to gain additional output&quot;);
4185     DebugNonSafepoints = true;
4186   }
4187 
4188   if (FLAG_IS_CMDLINE(CompressedClassSpaceSize) &amp;&amp; !UseCompressedClassPointers) {
4189     warning(&quot;Setting CompressedClassSpaceSize has no effect when compressed class pointers are not used&quot;);
4190   }
4191 
4192   // Treat the odd case where local verification is enabled but remote
4193   // verification is not as if both were enabled.
4194   if (BytecodeVerificationLocal &amp;&amp; !BytecodeVerificationRemote) {
4195     log_info(verification)(&quot;Turning on remote verification because local verification is on&quot;);
4196     FLAG_SET_DEFAULT(BytecodeVerificationRemote, true);
4197   }
<span class="line-added">4198   if (!EnableValhalla || (is_interpreter_only() &amp;&amp; !is_dumping_archive())) {</span>
<span class="line-added">4199     // Disable calling convention optimizations if value types are not supported</span>
<span class="line-added">4200     InlineTypePassFieldsAsArgs = false;</span>
<span class="line-added">4201     InlineTypeReturnedAsFields = false;</span>
<span class="line-added">4202   }</span>
4203 
4204 #ifndef PRODUCT
4205   if (!LogVMOutput &amp;&amp; FLAG_IS_DEFAULT(LogVMOutput)) {
4206     if (use_vm_log()) {
4207       LogVMOutput = true;
4208     }
4209   }
4210 #endif // PRODUCT
4211 
4212   if (PrintCommandLineFlags) {
4213     JVMFlag::printSetFlags(tty);
4214   }
4215 
4216   // Apply CPU specific policy for the BiasedLocking
4217   if (UseBiasedLocking) {
4218     if (!VM_Version::use_biased_locking() &amp;&amp;
4219         !(FLAG_IS_CMDLINE(UseBiasedLocking))) {
4220       UseBiasedLocking = false;
4221     }
4222   }
</pre>
</td>
</tr>
</table>
<center><a href="../prims/jvm.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="deoptimization.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>