<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/c1/c1_Runtime1.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../asm/macroAssembler_common.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../ci/ciMethodType.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/c1/c1_Runtime1.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 405   Klass* elem_klass = ArrayKlass::cast(array_klass)-&gt;element_klass();
 406   objArrayOop obj = oopFactory::new_objArray(elem_klass, length, CHECK);
 407   thread-&gt;set_vm_result(obj);
 408   // This is pretty rare but this runtime patch is stressful to deoptimization
 409   // if we deoptimize here so force a deopt to stress the path.
 410   if (DeoptimizeALot) {
 411     deopt_caller();
 412   }
 413 JRT_END
 414 
 415 
 416 JRT_ENTRY(void, Runtime1::new_value_array(JavaThread* thread, Klass* array_klass, jint length))
 417   NOT_PRODUCT(_new_value_array_slowcase_cnt++;)
 418 
 419   // Note: no handle for klass needed since they are not used
 420   //       anymore after new_objArray() and no GC can happen before.
 421   //       (This may have to change if this code changes!)
 422   assert(array_klass-&gt;is_klass(), &quot;not a class&quot;);
 423   Handle holder(THREAD, array_klass-&gt;klass_holder()); // keep the klass alive
 424   Klass* elem_klass = ArrayKlass::cast(array_klass)-&gt;element_klass();
<span class="line-modified"> 425   assert(elem_klass-&gt;is_value(), &quot;must be&quot;);</span>
 426   // Logically creates elements, ensure klass init
 427   elem_klass-&gt;initialize(CHECK);
 428   arrayOop obj = oopFactory::new_valueArray(elem_klass, length, CHECK);
 429   thread-&gt;set_vm_result(obj);
 430   // This is pretty rare but this runtime patch is stressful to deoptimization
 431   // if we deoptimize here so force a deopt to stress the path.
 432   if (DeoptimizeALot) {
 433     deopt_caller();
 434   }
 435 JRT_END
 436 
 437 
 438 JRT_ENTRY(void, Runtime1::new_multi_array(JavaThread* thread, Klass* klass, int rank, jint* dims))
 439   NOT_PRODUCT(_new_multi_array_slowcase_cnt++;)
 440 
 441   assert(klass-&gt;is_klass(), &quot;not a class&quot;);
 442   assert(rank &gt;= 1, &quot;rank must be nonzero&quot;);
 443   Handle holder(THREAD, klass-&gt;klass_holder()); // keep the klass alive
 444   oop obj = ArrayKlass::cast(klass)-&gt;multi_allocate(rank, dims, CHECK);
 445   thread-&gt;set_vm_result(obj);
</pre>
</td>
<td>
<hr />
<pre>
 405   Klass* elem_klass = ArrayKlass::cast(array_klass)-&gt;element_klass();
 406   objArrayOop obj = oopFactory::new_objArray(elem_klass, length, CHECK);
 407   thread-&gt;set_vm_result(obj);
 408   // This is pretty rare but this runtime patch is stressful to deoptimization
 409   // if we deoptimize here so force a deopt to stress the path.
 410   if (DeoptimizeALot) {
 411     deopt_caller();
 412   }
 413 JRT_END
 414 
 415 
 416 JRT_ENTRY(void, Runtime1::new_value_array(JavaThread* thread, Klass* array_klass, jint length))
 417   NOT_PRODUCT(_new_value_array_slowcase_cnt++;)
 418 
 419   // Note: no handle for klass needed since they are not used
 420   //       anymore after new_objArray() and no GC can happen before.
 421   //       (This may have to change if this code changes!)
 422   assert(array_klass-&gt;is_klass(), &quot;not a class&quot;);
 423   Handle holder(THREAD, array_klass-&gt;klass_holder()); // keep the klass alive
 424   Klass* elem_klass = ArrayKlass::cast(array_klass)-&gt;element_klass();
<span class="line-modified"> 425   assert(elem_klass-&gt;is_inline_klass(), &quot;must be&quot;);</span>
 426   // Logically creates elements, ensure klass init
 427   elem_klass-&gt;initialize(CHECK);
 428   arrayOop obj = oopFactory::new_valueArray(elem_klass, length, CHECK);
 429   thread-&gt;set_vm_result(obj);
 430   // This is pretty rare but this runtime patch is stressful to deoptimization
 431   // if we deoptimize here so force a deopt to stress the path.
 432   if (DeoptimizeALot) {
 433     deopt_caller();
 434   }
 435 JRT_END
 436 
 437 
 438 JRT_ENTRY(void, Runtime1::new_multi_array(JavaThread* thread, Klass* klass, int rank, jint* dims))
 439   NOT_PRODUCT(_new_multi_array_slowcase_cnt++;)
 440 
 441   assert(klass-&gt;is_klass(), &quot;not a class&quot;);
 442   assert(rank &gt;= 1, &quot;rank must be nonzero&quot;);
 443   Handle holder(THREAD, klass-&gt;klass_holder()); // keep the klass alive
 444   oop obj = ArrayKlass::cast(klass)-&gt;multi_allocate(rank, dims, CHECK);
 445   thread-&gt;set_vm_result(obj);
</pre>
</td>
</tr>
</table>
<center><a href="../asm/macroAssembler_common.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../ci/ciMethodType.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>