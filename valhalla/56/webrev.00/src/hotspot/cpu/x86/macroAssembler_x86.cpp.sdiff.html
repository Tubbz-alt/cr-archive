<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/cpu/x86/macroAssembler_x86.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="c1_LIRAssembler_x86.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../share/gc/shared/memAllocator.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/x86/macroAssembler_x86.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
4600 void MacroAssembler::load_method_holder_cld(Register rresult, Register rmethod) {
4601   load_method_holder(rresult, rmethod);
4602   movptr(rresult, Address(rresult, InstanceKlass::class_loader_data_offset()));
4603 }
4604 
4605 void MacroAssembler::load_metadata(Register dst, Register src) {
4606   if (UseCompressedClassPointers) {
4607     movl(dst, Address(src, oopDesc::klass_offset_in_bytes()));
4608   } else {
4609     movptr(dst, Address(src, oopDesc::klass_offset_in_bytes()));
4610   }
4611 }
4612 
4613 void MacroAssembler::load_method_holder(Register holder, Register method) {
4614   movptr(holder, Address(method, Method::const_offset()));                      // ConstMethod*
4615   movptr(holder, Address(holder, ConstMethod::constants_offset()));             // ConstantPool*
4616   movptr(holder, Address(holder, ConstantPool::pool_holder_offset_in_bytes())); // InstanceKlass*
4617 }
4618 
4619 void MacroAssembler::load_klass(Register dst, Register src) {
<span class="line-removed">4620   load_metadata(dst, src);</span>
4621 #ifdef _LP64
4622   if (UseCompressedClassPointers) {
<span class="line-modified">4623     andl(dst, oopDesc::compressed_klass_mask());</span>
4624     decode_klass_not_null(dst);
4625   } else
4626 #endif
<span class="line-modified">4627   {</span>
<span class="line-removed">4628 #ifdef _LP64</span>
<span class="line-removed">4629     shlq(dst, oopDesc::storage_props_nof_bits);</span>
<span class="line-removed">4630     shrq(dst, oopDesc::storage_props_nof_bits);</span>
<span class="line-removed">4631 #else</span>
<span class="line-removed">4632     andl(dst, oopDesc::wide_klass_mask());</span>
<span class="line-removed">4633 #endif</span>
<span class="line-removed">4634   }</span>
4635 }
4636 
4637 void MacroAssembler::load_prototype_header(Register dst, Register src) {
4638   load_klass(dst, src);
4639   movptr(dst, Address(dst, Klass::prototype_header_offset()));
4640 }
4641 
4642 void MacroAssembler::store_klass(Register dst, Register src) {
4643 #ifdef _LP64
4644   if (UseCompressedClassPointers) {
4645     encode_klass_not_null(src);
4646     movl(Address(dst, oopDesc::klass_offset_in_bytes()), src);
4647   } else
4648 #endif
4649     movptr(Address(dst, oopDesc::klass_offset_in_bytes()), src);
4650 }
4651 
4652 void MacroAssembler::access_load_at(BasicType type, DecoratorSet decorators, Register dst, Address src,
4653                                     Register tmp1, Register thread_tmp) {
4654   BarrierSetAssembler* bs = BarrierSet::barrier_set()-&gt;barrier_set_assembler();
</pre>
</td>
<td>
<hr />
<pre>
4600 void MacroAssembler::load_method_holder_cld(Register rresult, Register rmethod) {
4601   load_method_holder(rresult, rmethod);
4602   movptr(rresult, Address(rresult, InstanceKlass::class_loader_data_offset()));
4603 }
4604 
4605 void MacroAssembler::load_metadata(Register dst, Register src) {
4606   if (UseCompressedClassPointers) {
4607     movl(dst, Address(src, oopDesc::klass_offset_in_bytes()));
4608   } else {
4609     movptr(dst, Address(src, oopDesc::klass_offset_in_bytes()));
4610   }
4611 }
4612 
4613 void MacroAssembler::load_method_holder(Register holder, Register method) {
4614   movptr(holder, Address(method, Method::const_offset()));                      // ConstMethod*
4615   movptr(holder, Address(holder, ConstMethod::constants_offset()));             // ConstantPool*
4616   movptr(holder, Address(holder, ConstantPool::pool_holder_offset_in_bytes())); // InstanceKlass*
4617 }
4618 
4619 void MacroAssembler::load_klass(Register dst, Register src) {

4620 #ifdef _LP64
4621   if (UseCompressedClassPointers) {
<span class="line-modified">4622     movl(dst, Address(src, oopDesc::klass_offset_in_bytes()));</span>
4623     decode_klass_not_null(dst);
4624   } else
4625 #endif
<span class="line-modified">4626   movptr(dst, Address(src, oopDesc::klass_offset_in_bytes()));</span>







4627 }
4628 
4629 void MacroAssembler::load_prototype_header(Register dst, Register src) {
4630   load_klass(dst, src);
4631   movptr(dst, Address(dst, Klass::prototype_header_offset()));
4632 }
4633 
4634 void MacroAssembler::store_klass(Register dst, Register src) {
4635 #ifdef _LP64
4636   if (UseCompressedClassPointers) {
4637     encode_klass_not_null(src);
4638     movl(Address(dst, oopDesc::klass_offset_in_bytes()), src);
4639   } else
4640 #endif
4641     movptr(Address(dst, oopDesc::klass_offset_in_bytes()), src);
4642 }
4643 
4644 void MacroAssembler::access_load_at(BasicType type, DecoratorSet decorators, Register dst, Address src,
4645                                     Register tmp1, Register thread_tmp) {
4646   BarrierSetAssembler* bs = BarrierSet::barrier_set()-&gt;barrier_set_assembler();
</pre>
</td>
</tr>
</table>
<center><a href="c1_LIRAssembler_x86.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../share/gc/shared/memAllocator.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>