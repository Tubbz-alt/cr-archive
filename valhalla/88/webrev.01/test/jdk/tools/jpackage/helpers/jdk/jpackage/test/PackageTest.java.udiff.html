<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/jdk/tools/jpackage/helpers/jdk/jpackage/test/PackageTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="LinuxHelper.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../share/AddLauncherTest.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/tools/jpackage/helpers/jdk/jpackage/test/PackageTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -237,10 +237,14 @@</span>
  
          // Setup test app to have valid jpackage command line before
          // running check of type of environment.
          addHelloAppInitializer(null);
  
<span class="udiff-line-added">+         forTypes(PackageType.LINUX, () -&gt; {</span>
<span class="udiff-line-added">+             LinuxHelper.addFileAssociationsVerifier(this, fa);</span>
<span class="udiff-line-added">+         });</span>
<span class="udiff-line-added">+ </span>
          String noActionMsg = &quot;Not running file associations test&quot;;
          if (GraphicsEnvironment.isHeadless()) {
              TKit.trace(String.format(
                      &quot;%s because running in headless environment&quot;, noActionMsg));
              return this;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -273,14 +277,10 @@</span>
                  HelloApp.verifyOutputFile(appOutput, expectedArgs,
                          Collections.emptyMap());
              });
          });
  
<span class="udiff-line-removed">-         forTypes(PackageType.LINUX, () -&gt; {</span>
<span class="udiff-line-removed">-             LinuxHelper.addFileAssociationsVerifier(this, fa);</span>
<span class="udiff-line-removed">-         });</span>
<span class="udiff-line-removed">- </span>
          return this;
      }
  
      public PackageTest forTypes(Collection&lt;PackageType&gt; types, Runnable action) {
          Set&lt;PackageType&gt; oldTypes = Set.of(currentTypes.toArray(
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -551,34 +551,18 @@</span>
              } else {
                  formatString = &quot;Verify installed: %s&quot;;
              }
              TKit.trace(String.format(formatString, cmd.getPrintableCommandLine()));
  
<span class="udiff-line-removed">-             TKit.assertDirectoryExists(cmd.appRuntimeDirectory());</span>
              if (!cmd.isRuntime()) {
<span class="udiff-line-removed">-                 TKit.assertExecutableFileExists(cmd.appLauncherPath());</span>
<span class="udiff-line-removed">- </span>
                  if (PackageType.WINDOWS.contains(cmd.packageType())
                          &amp;&amp; !cmd.isPackageUnpacked(
                                  &quot;Not verifying desktop integration&quot;)) {
                      new WindowsHelper.DesktopIntegrationVerifier(cmd);
                  }
              }
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-removed">-             if (cmd.isPackageUnpacked()) {</span>
<span class="udiff-line-removed">-                 final Path appImageFile = AppImageFile.getPathInAppImage(</span>
<span class="udiff-line-removed">-                         Path.of(&quot;&quot;));</span>
<span class="udiff-line-removed">-                 try (Stream&lt;Path&gt; walk = ThrowingSupplier.toSupplier(</span>
<span class="udiff-line-removed">-                         () -&gt; Files.walk(cmd.unpackedPackageDirectory())).get()) {</span>
<span class="udiff-line-removed">-                     walk.filter(path -&gt; path.getFileName().equals(appImageFile))</span>
<span class="udiff-line-removed">-                         .findFirst()</span>
<span class="udiff-line-removed">-                         .ifPresent(path -&gt; TKit.assertPathExists(path, false));</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             } else {</span>
<span class="udiff-line-removed">-                 TKit.assertPathExists(AppImageFile.getPathInAppImage(</span>
<span class="udiff-line-removed">-                         cmd.appInstallationDirectory()), false);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-modified-added">+             cmd.assertAppLayout();</span>
  
              installVerifiers.forEach(v -&gt; v.accept(cmd));
          }
  
          private void verifyPackageUninstalled(JPackageCommand cmd) {
</pre>
<center><a href="LinuxHelper.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../share/AddLauncherTest.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>