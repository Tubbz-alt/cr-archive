<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/java/lang/StringUTF16.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="StringLatin1.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="annotation/Annotation.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/lang/StringUTF16.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 644         pos[0] = i;
 645         i += targLen;
 646         while ((j = ((String.COMPACT_STRINGS &amp;&amp; valLat1)
 647                             ? StringLatin1.indexOf(value, valLen, targ, targLen, i) :
 648                      (String.COMPACT_STRINGS &amp;&amp; targLat1)
 649                             ? indexOfLatin1(value, valLen, targ, targLen, i)
 650                             : indexOf(value, valLen, targ, targLen, i))) &gt; 0)
 651         {
 652             if (++p == pos.length) {
 653                 pos = Arrays.copyOf(pos, ArraysSupport.newLength(p, 1, p &gt;&gt; 1));
 654             }
 655             pos[p] = j;
 656             i = j + targLen;
 657         }
 658 
 659         int resultLen;
 660         try {
 661             resultLen = Math.addExact(valLen,
 662                     Math.multiplyExact(++p, replLen - targLen));
 663         } catch (ArithmeticException ignored) {
<span class="line-modified"> 664             throw new OutOfMemoryError();</span>
 665         }
 666         if (resultLen == 0) {
 667             return &quot;&quot;;
 668         }
 669 
 670         byte[] result = newBytesFor(resultLen);
 671         int posFrom = 0, posTo = 0;
 672         for (int q = 0; q &lt; p; ++q) {
 673             int nextPos = pos[q];
 674             if (String.COMPACT_STRINGS &amp;&amp; valLat1) {
 675                 while (posFrom &lt; nextPos) {
 676                     char c = (char)(value[posFrom++] &amp; 0xff);
 677                     putChar(result, posTo++, c);
 678                 }
 679             } else {
 680                 while (posFrom &lt; nextPos) {
 681                     putChar(result, posTo++, getChar(value, posFrom++));
 682                 }
 683             }
 684             posFrom += targLen;
</pre>
</td>
<td>
<hr />
<pre>
 644         pos[0] = i;
 645         i += targLen;
 646         while ((j = ((String.COMPACT_STRINGS &amp;&amp; valLat1)
 647                             ? StringLatin1.indexOf(value, valLen, targ, targLen, i) :
 648                      (String.COMPACT_STRINGS &amp;&amp; targLat1)
 649                             ? indexOfLatin1(value, valLen, targ, targLen, i)
 650                             : indexOf(value, valLen, targ, targLen, i))) &gt; 0)
 651         {
 652             if (++p == pos.length) {
 653                 pos = Arrays.copyOf(pos, ArraysSupport.newLength(p, 1, p &gt;&gt; 1));
 654             }
 655             pos[p] = j;
 656             i = j + targLen;
 657         }
 658 
 659         int resultLen;
 660         try {
 661             resultLen = Math.addExact(valLen,
 662                     Math.multiplyExact(++p, replLen - targLen));
 663         } catch (ArithmeticException ignored) {
<span class="line-modified"> 664            throw new OutOfMemoryError(&quot;Required length exceeds implementation limit&quot;);</span>
 665         }
 666         if (resultLen == 0) {
 667             return &quot;&quot;;
 668         }
 669 
 670         byte[] result = newBytesFor(resultLen);
 671         int posFrom = 0, posTo = 0;
 672         for (int q = 0; q &lt; p; ++q) {
 673             int nextPos = pos[q];
 674             if (String.COMPACT_STRINGS &amp;&amp; valLat1) {
 675                 while (posFrom &lt; nextPos) {
 676                     char c = (char)(value[posFrom++] &amp; 0xff);
 677                     putChar(result, posTo++, c);
 678                 }
 679             } else {
 680                 while (posFrom &lt; nextPos) {
 681                     putChar(result, posTo++, getChar(value, posFrom++));
 682                 }
 683             }
 684             posFrom += targLen;
</pre>
</td>
</tr>
</table>
<center><a href="StringLatin1.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="annotation/Annotation.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>