<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.incubator.jpackage/macosx/classes/jdk/incubator/jpackage/internal/MacDmgBundler.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MacAppImageBuilder.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MacPkgBundler.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.incubator.jpackage/macosx/classes/jdk/incubator/jpackage/internal/MacDmgBundler.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
319                 hdiUtilVerbosityFlag,
320                 &quot;-srcfolder&quot;, srcFolder.getAbsolutePath(),
321                 &quot;-volname&quot;, APP_NAME.fetchFrom(params),
322                 &quot;-ov&quot;, protoDMG.getAbsolutePath(),
323                 &quot;-fs&quot;, &quot;HFS+&quot;,
324                 &quot;-format&quot;, &quot;UDRW&quot;);
325         IOUtils.exec(pb);
326 
327         // mount temp image
328         pb = new ProcessBuilder(
329                 hdiutil,
330                 &quot;attach&quot;,
331                 protoDMG.getAbsolutePath(),
332                 hdiUtilVerbosityFlag,
333                 &quot;-mountroot&quot;, imagesRoot.getAbsolutePath());
334         IOUtils.exec(pb, false, null, true);
335 
336         File mountedRoot = new File(imagesRoot.getAbsolutePath(),
337                     APP_NAME.fetchFrom(params));
338         try {
<span class="line-removed">339             Files.deleteIfExists(AppImageFile.getPathInAppImage(</span>
<span class="line-removed">340                     mountedRoot.toPath().resolve(APP_NAME.fetchFrom(params)</span>
<span class="line-removed">341                             + &quot;.app&quot;)));</span>
<span class="line-removed">342 </span>
343             // background image
344             File bgdir = new File(mountedRoot, BACKGROUND_IMAGE_FOLDER);
345             bgdir.mkdirs();
346             IOUtils.copyFile(getConfig_VolumeBackground(params),
347                     new File(bgdir, BACKGROUND_IMAGE));
348 
349             // We will not consider setting background image and creating link
350             // to install-dir in DMG as critical error, since it can fail in
351             // headless enviroment.
352             try {
353                 pb = new ProcessBuilder(&quot;osascript&quot;,
354                         getConfig_VolumeScript(params).getAbsolutePath());
355                 IOUtils.exec(pb);
356             } catch (IOException ex) {
357                 Log.verbose(ex);
358             }
359 
360             // volume icon
361             File volumeIconFile = new File(mountedRoot, &quot;.VolumeIcon.icns&quot;);
362             IOUtils.copyFile(getConfig_VolumeIcon(params),
</pre>
</td>
<td>
<hr />
<pre>
319                 hdiUtilVerbosityFlag,
320                 &quot;-srcfolder&quot;, srcFolder.getAbsolutePath(),
321                 &quot;-volname&quot;, APP_NAME.fetchFrom(params),
322                 &quot;-ov&quot;, protoDMG.getAbsolutePath(),
323                 &quot;-fs&quot;, &quot;HFS+&quot;,
324                 &quot;-format&quot;, &quot;UDRW&quot;);
325         IOUtils.exec(pb);
326 
327         // mount temp image
328         pb = new ProcessBuilder(
329                 hdiutil,
330                 &quot;attach&quot;,
331                 protoDMG.getAbsolutePath(),
332                 hdiUtilVerbosityFlag,
333                 &quot;-mountroot&quot;, imagesRoot.getAbsolutePath());
334         IOUtils.exec(pb, false, null, true);
335 
336         File mountedRoot = new File(imagesRoot.getAbsolutePath(),
337                     APP_NAME.fetchFrom(params));
338         try {




339             // background image
340             File bgdir = new File(mountedRoot, BACKGROUND_IMAGE_FOLDER);
341             bgdir.mkdirs();
342             IOUtils.copyFile(getConfig_VolumeBackground(params),
343                     new File(bgdir, BACKGROUND_IMAGE));
344 
345             // We will not consider setting background image and creating link
346             // to install-dir in DMG as critical error, since it can fail in
347             // headless enviroment.
348             try {
349                 pb = new ProcessBuilder(&quot;osascript&quot;,
350                         getConfig_VolumeScript(params).getAbsolutePath());
351                 IOUtils.exec(pb);
352             } catch (IOException ex) {
353                 Log.verbose(ex);
354             }
355 
356             // volume icon
357             File volumeIconFile = new File(mountedRoot, &quot;.VolumeIcon.icns&quot;);
358             IOUtils.copyFile(getConfig_VolumeIcon(params),
</pre>
</td>
</tr>
</table>
<center><a href="MacAppImageBuilder.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MacPkgBundler.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>