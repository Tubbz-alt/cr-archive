<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.incubator.jpackage/macosx/classes/jdk/incubator/jpackage/internal/MacPkgBundler.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MacDmgBundler.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../share/classes/jdk/incubator/jpackage/internal/AppImageFile.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.incubator.jpackage/macosx/classes/jdk/incubator/jpackage/internal/MacPkgBundler.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
390 
391         return newRoot.toString();
392     }
393 
394     private File createPKG(Map&lt;String, ? super Object&gt; params,
395             File outdir, File appLocation) {
396         // generic find attempt
397         try {
398             File appPKG = getPackages_AppPackage(params);
399 
400             String root = getRoot(params, appLocation);
401 
402             // Generate default CPL file
403             File cpl = new File(CONFIG_ROOT.fetchFrom(params).getAbsolutePath()
404                     + File.separator + &quot;cpl.plist&quot;);
405             ProcessBuilder pb = new ProcessBuilder(&quot;pkgbuild&quot;,
406                     &quot;--root&quot;,
407                     root,
408                     &quot;--install-location&quot;,
409                     getInstallDir(params),
<span class="line-removed">410                     &quot;--filter&quot;,</span>
<span class="line-removed">411                     AppImageFile.getPathInAppImage(Path.of(&quot;&quot;)).toString(),</span>
412                     &quot;--analyze&quot;,
413                     cpl.getAbsolutePath());
414 
415             IOUtils.exec(pb);
416 
417             patchCPLFile(cpl);
418 
419             preparePackageScripts(params);
420 
421             // build application package
422             pb = new ProcessBuilder(&quot;pkgbuild&quot;,
423                     &quot;--root&quot;,
424                     root,
425                     &quot;--install-location&quot;,
426                     getInstallDir(params),
<span class="line-removed">427                     &quot;--filter&quot;,</span>
<span class="line-removed">428                     AppImageFile.getPathInAppImage(Path.of(&quot;&quot;)).toString(),</span>
429                     &quot;--component-plist&quot;,
430                     cpl.getAbsolutePath(),
431                     &quot;--scripts&quot;,
432                     SCRIPTS_DIR.fetchFrom(params).getAbsolutePath(),
433                     &quot;--identifier&quot;,
434                      MAC_CF_BUNDLE_IDENTIFIER.fetchFrom(params),
435                     appPKG.getAbsolutePath());
436             IOUtils.exec(pb);
437 
438             // build final package
439             File finalPKG = new File(outdir, INSTALLER_NAME.fetchFrom(params)
440                     + INSTALLER_SUFFIX.fetchFrom(params)
441                     + &quot;.pkg&quot;);
442             outdir.mkdirs();
443 
444             List&lt;String&gt; commandLine = new ArrayList&lt;&gt;();
445             commandLine.add(&quot;productbuild&quot;);
446 
447             commandLine.add(&quot;--resources&quot;);
448             commandLine.add(CONFIG_ROOT.fetchFrom(params).getAbsolutePath());
</pre>
</td>
<td>
<hr />
<pre>
390 
391         return newRoot.toString();
392     }
393 
394     private File createPKG(Map&lt;String, ? super Object&gt; params,
395             File outdir, File appLocation) {
396         // generic find attempt
397         try {
398             File appPKG = getPackages_AppPackage(params);
399 
400             String root = getRoot(params, appLocation);
401 
402             // Generate default CPL file
403             File cpl = new File(CONFIG_ROOT.fetchFrom(params).getAbsolutePath()
404                     + File.separator + &quot;cpl.plist&quot;);
405             ProcessBuilder pb = new ProcessBuilder(&quot;pkgbuild&quot;,
406                     &quot;--root&quot;,
407                     root,
408                     &quot;--install-location&quot;,
409                     getInstallDir(params),


410                     &quot;--analyze&quot;,
411                     cpl.getAbsolutePath());
412 
413             IOUtils.exec(pb);
414 
415             patchCPLFile(cpl);
416 
417             preparePackageScripts(params);
418 
419             // build application package
420             pb = new ProcessBuilder(&quot;pkgbuild&quot;,
421                     &quot;--root&quot;,
422                     root,
423                     &quot;--install-location&quot;,
424                     getInstallDir(params),


425                     &quot;--component-plist&quot;,
426                     cpl.getAbsolutePath(),
427                     &quot;--scripts&quot;,
428                     SCRIPTS_DIR.fetchFrom(params).getAbsolutePath(),
429                     &quot;--identifier&quot;,
430                      MAC_CF_BUNDLE_IDENTIFIER.fetchFrom(params),
431                     appPKG.getAbsolutePath());
432             IOUtils.exec(pb);
433 
434             // build final package
435             File finalPKG = new File(outdir, INSTALLER_NAME.fetchFrom(params)
436                     + INSTALLER_SUFFIX.fetchFrom(params)
437                     + &quot;.pkg&quot;);
438             outdir.mkdirs();
439 
440             List&lt;String&gt; commandLine = new ArrayList&lt;&gt;();
441             commandLine.add(&quot;productbuild&quot;);
442 
443             commandLine.add(&quot;--resources&quot;);
444             commandLine.add(CONFIG_ROOT.fetchFrom(params).getAbsolutePath());
</pre>
</td>
</tr>
</table>
<center><a href="MacDmgBundler.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../share/classes/jdk/incubator/jpackage/internal/AppImageFile.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>