<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/runtime/arguments.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../prims/jvmtiRedefineClasses.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../../java.base/share/classes/java/lang/reflect/ProxyGenerator.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/runtime/arguments.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
2150   status = CompilerConfig::check_args_consistency(status);
2151 #if INCLUDE_JVMCI
2152   if (status &amp;&amp; EnableJVMCI) {
2153     PropertyList_unique_add(&amp;_system_properties, &quot;jdk.internal.vm.ci.enabled&quot;, &quot;true&quot;,
2154         AddProperty, UnwriteableProperty, InternalProperty);
2155     if (!create_numbered_module_property(&quot;jdk.module.addmods&quot;, &quot;jdk.internal.vm.ci&quot;, addmods_count++)) {
2156       return false;
2157     }
2158   }
2159 #endif
2160 
2161 #ifndef SUPPORT_RESERVED_STACK_AREA
2162   if (StackReservedPages != 0) {
2163     FLAG_SET_CMDLINE(StackReservedPages, 0);
2164     warning(&quot;Reserved Stack Area not supported on this platform&quot;);
2165   }
2166 #endif
2167 
2168   status = status &amp;&amp; GCArguments::check_args_consistency();
2169 










2170   return status;
2171 }
2172 
2173 bool Arguments::is_bad_option(const JavaVMOption* option, jboolean ignore,
2174   const char* option_type) {
2175   if (ignore) return false;
2176 
2177   const char* spacer = &quot; &quot;;
2178   if (option_type == NULL) {
2179     option_type = ++spacer; // Set both to the empty string.
2180   }
2181 
2182   jio_fprintf(defaultStream::error_stream(),
2183               &quot;Unrecognized %s%soption: %s\n&quot;, option_type, spacer,
2184               option-&gt;optionString);
2185   return true;
2186 }
2187 
2188 static const char* user_assertion_options[] = {
2189   &quot;-da&quot;, &quot;-ea&quot;, &quot;-disableassertions&quot;, &quot;-enableassertions&quot;, 0
</pre>
<hr />
<pre>
3070 #endif // INCLUDE_JVMCI
3071 #if INCLUDE_JFR
3072     } else if (match_jfr_option(&amp;option)) {
3073       return JNI_EINVAL;
3074 #endif
3075     } else if (match_option(option, &quot;-XX:&quot;, &amp;tail)) { // -XX:xxxx
3076       // Skip -XX:Flags= and -XX:VMOptionsFile= since those cases have
3077       // already been handled
3078       if ((strncmp(tail, &quot;Flags=&quot;, strlen(&quot;Flags=&quot;)) != 0) &amp;&amp;
3079           (strncmp(tail, &quot;VMOptionsFile=&quot;, strlen(&quot;VMOptionsFile=&quot;)) != 0)) {
3080         if (!process_argument(tail, args-&gt;ignoreUnrecognized, origin)) {
3081           return JNI_EINVAL;
3082         }
3083       }
3084     // Unknown option
3085     } else if (is_bad_option(option, args-&gt;ignoreUnrecognized)) {
3086       return JNI_ERR;
3087     }
3088   }
3089 


















3090   // PrintSharedArchiveAndExit will turn on
3091   //   -Xshare:on
3092   //   -Xlog:class+path=info
3093   if (PrintSharedArchiveAndExit) {
3094     if (FLAG_SET_CMDLINE(UseSharedSpaces, true) != JVMFlag::SUCCESS) {
3095       return JNI_EINVAL;
3096     }
3097     if (FLAG_SET_CMDLINE(RequireSharedSpaces, true) != JVMFlag::SUCCESS) {
3098       return JNI_EINVAL;
3099     }
3100     LogConfiguration::configure_stdout(LogLevel::Info, true, LOG_TAGS(class, path));
3101   }
3102 
3103   fix_appclasspath();
3104 
3105   return JNI_OK;
3106 }
3107 
3108 void Arguments::add_patch_mod_prefix(const char* module_name, const char* path, bool* patch_mod_javabase) {
3109   // For java.base check for duplicate --patch-module options being specified on the command line.
</pre>
<hr />
<pre>
4164   FLAG_SET_DEFAULT(UseBiasedLocking, false);
4165   LP64_ONLY(FLAG_SET_DEFAULT(UseCompressedOops, false));
4166   LP64_ONLY(FLAG_SET_DEFAULT(UseCompressedClassPointers, false));
4167 #endif // CC_INTERP
4168 
4169   if (PrintAssembly &amp;&amp; FLAG_IS_DEFAULT(DebugNonSafepoints)) {
4170     warning(&quot;PrintAssembly is enabled; turning on DebugNonSafepoints to gain additional output&quot;);
4171     DebugNonSafepoints = true;
4172   }
4173 
4174   if (FLAG_IS_CMDLINE(CompressedClassSpaceSize) &amp;&amp; !UseCompressedClassPointers) {
4175     warning(&quot;Setting CompressedClassSpaceSize has no effect when compressed class pointers are not used&quot;);
4176   }
4177 
4178   // Treat the odd case where local verification is enabled but remote
4179   // verification is not as if both were enabled.
4180   if (BytecodeVerificationLocal &amp;&amp; !BytecodeVerificationRemote) {
4181     log_info(verification)(&quot;Turning on remote verification because local verification is on&quot;);
4182     FLAG_SET_DEFAULT(BytecodeVerificationRemote, true);
4183   }





4184 
4185 #ifndef PRODUCT
4186   if (!LogVMOutput &amp;&amp; FLAG_IS_DEFAULT(LogVMOutput)) {
4187     if (use_vm_log()) {
4188       LogVMOutput = true;
4189     }
4190   }
4191 #endif // PRODUCT
4192 
4193   if (PrintCommandLineFlags) {
4194     JVMFlag::printSetFlags(tty);
4195   }
4196 
4197   // Apply CPU specific policy for the BiasedLocking
4198   if (UseBiasedLocking) {
4199     if (!VM_Version::use_biased_locking() &amp;&amp;
4200         !(FLAG_IS_CMDLINE(UseBiasedLocking))) {
4201       UseBiasedLocking = false;
4202     }
4203   }
</pre>
</td>
<td>
<hr />
<pre>
2150   status = CompilerConfig::check_args_consistency(status);
2151 #if INCLUDE_JVMCI
2152   if (status &amp;&amp; EnableJVMCI) {
2153     PropertyList_unique_add(&amp;_system_properties, &quot;jdk.internal.vm.ci.enabled&quot;, &quot;true&quot;,
2154         AddProperty, UnwriteableProperty, InternalProperty);
2155     if (!create_numbered_module_property(&quot;jdk.module.addmods&quot;, &quot;jdk.internal.vm.ci&quot;, addmods_count++)) {
2156       return false;
2157     }
2158   }
2159 #endif
2160 
2161 #ifndef SUPPORT_RESERVED_STACK_AREA
2162   if (StackReservedPages != 0) {
2163     FLAG_SET_CMDLINE(StackReservedPages, 0);
2164     warning(&quot;Reserved Stack Area not supported on this platform&quot;);
2165   }
2166 #endif
2167 
2168   status = status &amp;&amp; GCArguments::check_args_consistency();
2169 
<span class="line-added">2170   if (AMD64_ONLY(false &amp;&amp;) !FLAG_IS_DEFAULT(InlineTypePassFieldsAsArgs)) {</span>
<span class="line-added">2171     FLAG_SET_CMDLINE(InlineTypePassFieldsAsArgs, false);</span>
<span class="line-added">2172     warning(&quot;InlineTypePassFieldsAsArgs is not supported on this platform&quot;);</span>
<span class="line-added">2173   }</span>
<span class="line-added">2174 </span>
<span class="line-added">2175   if (AMD64_ONLY(false &amp;&amp;) !FLAG_IS_DEFAULT(InlineTypeReturnedAsFields)) {</span>
<span class="line-added">2176     FLAG_SET_CMDLINE(InlineTypeReturnedAsFields, false);</span>
<span class="line-added">2177     warning(&quot;InlineTypeReturnedAsFields is not supported on this platform&quot;);</span>
<span class="line-added">2178   }</span>
<span class="line-added">2179 </span>
2180   return status;
2181 }
2182 
2183 bool Arguments::is_bad_option(const JavaVMOption* option, jboolean ignore,
2184   const char* option_type) {
2185   if (ignore) return false;
2186 
2187   const char* spacer = &quot; &quot;;
2188   if (option_type == NULL) {
2189     option_type = ++spacer; // Set both to the empty string.
2190   }
2191 
2192   jio_fprintf(defaultStream::error_stream(),
2193               &quot;Unrecognized %s%soption: %s\n&quot;, option_type, spacer,
2194               option-&gt;optionString);
2195   return true;
2196 }
2197 
2198 static const char* user_assertion_options[] = {
2199   &quot;-da&quot;, &quot;-ea&quot;, &quot;-disableassertions&quot;, &quot;-enableassertions&quot;, 0
</pre>
<hr />
<pre>
3080 #endif // INCLUDE_JVMCI
3081 #if INCLUDE_JFR
3082     } else if (match_jfr_option(&amp;option)) {
3083       return JNI_EINVAL;
3084 #endif
3085     } else if (match_option(option, &quot;-XX:&quot;, &amp;tail)) { // -XX:xxxx
3086       // Skip -XX:Flags= and -XX:VMOptionsFile= since those cases have
3087       // already been handled
3088       if ((strncmp(tail, &quot;Flags=&quot;, strlen(&quot;Flags=&quot;)) != 0) &amp;&amp;
3089           (strncmp(tail, &quot;VMOptionsFile=&quot;, strlen(&quot;VMOptionsFile=&quot;)) != 0)) {
3090         if (!process_argument(tail, args-&gt;ignoreUnrecognized, origin)) {
3091           return JNI_EINVAL;
3092         }
3093       }
3094     // Unknown option
3095     } else if (is_bad_option(option, args-&gt;ignoreUnrecognized)) {
3096       return JNI_ERR;
3097     }
3098   }
3099 
<span class="line-added">3100   if (EnableValhalla) {</span>
<span class="line-added">3101     // create_property(&quot;valhalla.enableValhalla&quot;, &quot;true&quot;, InternalProperty)</span>
<span class="line-added">3102     const char* prop_name = &quot;valhalla.enableValhalla&quot;;</span>
<span class="line-added">3103     const char* prop_value = &quot;true&quot;;</span>
<span class="line-added">3104     const size_t prop_len = strlen(prop_name) + strlen(prop_value) + 2;</span>
<span class="line-added">3105     char* property = AllocateHeap(prop_len, mtArguments);</span>
<span class="line-added">3106     int ret = jio_snprintf(property, prop_len, &quot;%s=%s&quot;, prop_name, prop_value);</span>
<span class="line-added">3107     if (ret &lt; 0 || ret &gt;= (int)prop_len) {</span>
<span class="line-added">3108       FreeHeap(property);</span>
<span class="line-added">3109       return JNI_ENOMEM;</span>
<span class="line-added">3110     }</span>
<span class="line-added">3111     bool added = add_property(property, UnwriteableProperty, InternalProperty);</span>
<span class="line-added">3112     FreeHeap(property);</span>
<span class="line-added">3113     if (!added) {</span>
<span class="line-added">3114       return JNI_ENOMEM;</span>
<span class="line-added">3115     }</span>
<span class="line-added">3116   }</span>
<span class="line-added">3117 </span>
3118   // PrintSharedArchiveAndExit will turn on
3119   //   -Xshare:on
3120   //   -Xlog:class+path=info
3121   if (PrintSharedArchiveAndExit) {
3122     if (FLAG_SET_CMDLINE(UseSharedSpaces, true) != JVMFlag::SUCCESS) {
3123       return JNI_EINVAL;
3124     }
3125     if (FLAG_SET_CMDLINE(RequireSharedSpaces, true) != JVMFlag::SUCCESS) {
3126       return JNI_EINVAL;
3127     }
3128     LogConfiguration::configure_stdout(LogLevel::Info, true, LOG_TAGS(class, path));
3129   }
3130 
3131   fix_appclasspath();
3132 
3133   return JNI_OK;
3134 }
3135 
3136 void Arguments::add_patch_mod_prefix(const char* module_name, const char* path, bool* patch_mod_javabase) {
3137   // For java.base check for duplicate --patch-module options being specified on the command line.
</pre>
<hr />
<pre>
4192   FLAG_SET_DEFAULT(UseBiasedLocking, false);
4193   LP64_ONLY(FLAG_SET_DEFAULT(UseCompressedOops, false));
4194   LP64_ONLY(FLAG_SET_DEFAULT(UseCompressedClassPointers, false));
4195 #endif // CC_INTERP
4196 
4197   if (PrintAssembly &amp;&amp; FLAG_IS_DEFAULT(DebugNonSafepoints)) {
4198     warning(&quot;PrintAssembly is enabled; turning on DebugNonSafepoints to gain additional output&quot;);
4199     DebugNonSafepoints = true;
4200   }
4201 
4202   if (FLAG_IS_CMDLINE(CompressedClassSpaceSize) &amp;&amp; !UseCompressedClassPointers) {
4203     warning(&quot;Setting CompressedClassSpaceSize has no effect when compressed class pointers are not used&quot;);
4204   }
4205 
4206   // Treat the odd case where local verification is enabled but remote
4207   // verification is not as if both were enabled.
4208   if (BytecodeVerificationLocal &amp;&amp; !BytecodeVerificationRemote) {
4209     log_info(verification)(&quot;Turning on remote verification because local verification is on&quot;);
4210     FLAG_SET_DEFAULT(BytecodeVerificationRemote, true);
4211   }
<span class="line-added">4212   if (!EnableValhalla || (is_interpreter_only() &amp;&amp; !is_dumping_archive())) {</span>
<span class="line-added">4213     // Disable calling convention optimizations if inline types are not supported</span>
<span class="line-added">4214     InlineTypePassFieldsAsArgs = false;</span>
<span class="line-added">4215     InlineTypeReturnedAsFields = false;</span>
<span class="line-added">4216   }</span>
4217 
4218 #ifndef PRODUCT
4219   if (!LogVMOutput &amp;&amp; FLAG_IS_DEFAULT(LogVMOutput)) {
4220     if (use_vm_log()) {
4221       LogVMOutput = true;
4222     }
4223   }
4224 #endif // PRODUCT
4225 
4226   if (PrintCommandLineFlags) {
4227     JVMFlag::printSetFlags(tty);
4228   }
4229 
4230   // Apply CPU specific policy for the BiasedLocking
4231   if (UseBiasedLocking) {
4232     if (!VM_Version::use_biased_locking() &amp;&amp;
4233         !(FLAG_IS_CMDLINE(UseBiasedLocking))) {
4234       UseBiasedLocking = false;
4235     }
4236   }
</pre>
</td>
</tr>
</table>
<center><a href="../prims/jvmtiRedefineClasses.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../../java.base/share/classes/java/lang/reflect/ProxyGenerator.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>