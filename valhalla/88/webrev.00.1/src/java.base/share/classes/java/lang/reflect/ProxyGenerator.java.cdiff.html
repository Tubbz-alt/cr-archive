<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/java/lang/reflect/ProxyGenerator.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../hotspot/share/runtime/arguments.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../jdk/internal/misc/Unsafe.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/lang/reflect/ProxyGenerator.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 444,11 ***</span>
      /**
       * Generate a class file for the proxy class.  This method drives the
       * class file generation process.
       */
      private byte[] generateClassFile() {
<span class="line-modified">!         visit(V14, accessFlags, dotToSlash(className), null,</span>
                  JLR_PROXY, typeNames(interfaces));
  
          /*
           * Add proxy methods for the hashCode, equals,
           * and toString methods of java.lang.Object.  This is done before
<span class="line-new-header">--- 444,11 ---</span>
      /**
       * Generate a class file for the proxy class.  This method drives the
       * class file generation process.
       */
      private byte[] generateClassFile() {
<span class="line-modified">!         visit(V16, accessFlags, dotToSlash(className), null,</span>
                  JLR_PROXY, typeNames(interfaces));
  
          /*
           * Add proxy methods for the hashCode, equals,
           * and toString methods of java.lang.Object.  This is done before
</pre>
<hr />
<pre>
<span class="line-old-header">*** 811,11 ***</span>
                      mv.visitInsn(DRETURN);
                  } else {
                      throw new AssertionError();
                  }
              } else {
<span class="line-modified">!                 mv.visitTypeInsn(CHECKCAST, dotToSlash(type.getName()));</span>
                  mv.visitInsn(ARETURN);
              }
          }
  
          /**
<span class="line-new-header">--- 811,15 ---</span>
                      mv.visitInsn(DRETURN);
                  } else {
                      throw new AssertionError();
                  }
              } else {
<span class="line-modified">!                 String internalName = dotToSlash(type.getName());</span>
<span class="line-added">+                 if (type.isInlineClass()) {</span>
<span class="line-added">+                     internalName = &#39;Q&#39; + internalName + &quot;;&quot;;</span>
<span class="line-added">+                 }</span>
<span class="line-added">+                 mv.visitTypeInsn(CHECKCAST, internalName);</span>
                  mv.visitInsn(ARETURN);
              }
          }
  
          /**
</pre>
<hr />
<pre>
<span class="line-old-header">*** 862,13 ***</span>
           * =============== Code Generation Utility Methods ===============
           */
  
          /**
           * Generate code to invoke the Class.forName with the name of the given
<span class="line-modified">!          * class to get its Class object at runtime.  The code is written to</span>
<span class="line-modified">!          * the supplied stream.  Note that the code generated by this method</span>
<span class="line-modified">!          * may cause the checked ClassNotFoundException to be thrown.</span>
           */
          private void codeClassForName(MethodVisitor mv, Class&lt;?&gt; cl) {
              mv.visitLdcInsn(cl.getName());
              mv.visitMethodInsn(INVOKESTATIC,
                      JL_CLASS,
<span class="line-new-header">--- 866,15 ---</span>
           * =============== Code Generation Utility Methods ===============
           */
  
          /**
           * Generate code to invoke the Class.forName with the name of the given
<span class="line-modified">!          * class to get its Class object at runtime.  And also generate code</span>
<span class="line-modified">!          * to invoke Class.asPrimaryType if the class is regular value type.</span>
<span class="line-modified">!          *</span>
<span class="line-added">+          * The code is written to the supplied stream.  Note that the code generated</span>
<span class="line-added">+          * by this method may caused the checked ClassNotFoundException to be thrown.</span>
           */
          private void codeClassForName(MethodVisitor mv, Class&lt;?&gt; cl) {
              mv.visitLdcInsn(cl.getName());
              mv.visitMethodInsn(INVOKESTATIC,
                      JL_CLASS,
</pre>
<center><a href="../../../../../../hotspot/share/runtime/arguments.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../jdk/internal/misc/Unsafe.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>