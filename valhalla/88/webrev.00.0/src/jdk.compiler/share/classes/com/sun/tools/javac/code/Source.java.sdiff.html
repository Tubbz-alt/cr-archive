<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.compiler/share/classes/com/sun/tools/javac/code/Source.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../doclint/Checker.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../jvm/ClassFile.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.compiler/share/classes/com/sun/tools/javac/code/Source.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 83 
 84     /** 1.11 local-variable syntax for lambda parameters */
 85     JDK11(&quot;11&quot;),
 86 
 87     /** 12, no language features; switch expression in preview */
 88     JDK12(&quot;12&quot;),
 89 
 90     /**
 91      * 13, no language features; text blocks and revised switch
 92      * expressions in preview
 93      */
 94     JDK13(&quot;13&quot;),
 95 
 96     /**
 97      * 14, switch expressions; pattern matching, records, and revised
 98      * text blocks in preview
 99      */
100     JDK14(&quot;14&quot;),
101 
102     /**
<span class="line-modified">103       * 15, tbd</span>
104       */
<span class="line-modified">105     JDK15(&quot;15&quot;);</span>





106 
107     private static final Context.Key&lt;Source&gt; sourceKey = new Context.Key&lt;&gt;();
108 
109     public static Source instance(Context context) {
110         Source instance = context.get(sourceKey);
111         if (instance == null) {
112             Options options = Options.instance(context);
113             String sourceString = options.get(SOURCE);
114             if (sourceString != null) instance = lookup(sourceString);
115             if (instance == null) instance = DEFAULT;
116             context.put(sourceKey, instance);
117         }
118         return instance;
119     }
120 
121     public final String name;
122 
123     private static final Map&lt;String,Source&gt; tab = new HashMap&lt;&gt;();
124     static {
125         for (Source s : values()) {
</pre>
<hr />
<pre>
136 
137     private Source(String name) {
138         this.name = name;
139     }
140 
141     public static final Source MIN = Source.JDK7;
142 
143     private static final Source MAX = values()[values().length - 1];
144 
145     public static final Source DEFAULT = MAX;
146 
147     public static Source lookup(String name) {
148         return tab.get(name);
149     }
150 
151     public boolean isSupported() {
152         return this.compareTo(MIN) &gt;= 0;
153     }
154 
155     public Target requiredTarget() {
<span class="line-modified">156         if (this.compareTo(JDK15) &gt;= 0) return Target.JDK1_15;</span>
<span class="line-modified">157         if (this.compareTo(JDK14) &gt;= 0) return Target.JDK1_14;</span>
<span class="line-modified">158         if (this.compareTo(JDK13) &gt;= 0) return Target.JDK1_13;</span>
<span class="line-modified">159         if (this.compareTo(JDK12) &gt;= 0) return Target.JDK1_12;</span>
<span class="line-modified">160         if (this.compareTo(JDK11) &gt;= 0) return Target.JDK1_11;</span>
<span class="line-modified">161         if (this.compareTo(JDK10) &gt;= 0) return Target.JDK1_10;</span>
<span class="line-modified">162         if (this.compareTo(JDK9) &gt;= 0) return Target.JDK1_9;</span>
<span class="line-modified">163         if (this.compareTo(JDK8) &gt;= 0) return Target.JDK1_8;</span>
<span class="line-modified">164         if (this.compareTo(JDK7) &gt;= 0) return Target.JDK1_7;</span>
<span class="line-modified">165         if (this.compareTo(JDK6) &gt;= 0) return Target.JDK1_6;</span>
<span class="line-modified">166         if (this.compareTo(JDK5) &gt;= 0) return Target.JDK1_5;</span>
<span class="line-modified">167         if (this.compareTo(JDK1_4) &gt;= 0) return Target.JDK1_4;</span>
<span class="line-modified">168         return Target.JDK1_1;</span>



169     }
170 
171     /**
172      * Models a feature of the Java programming language. Each feature can be associated with a
173      * minimum source level, a maximum source level and a diagnostic fragment describing the feature,
174      * which is used to generate error messages of the kind {@code feature XYZ not supported in source N}.
175      */
176     public enum Feature {
177 
178         DIAMOND(JDK7, Fragments.FeatureDiamond, DiagKind.NORMAL),
179         MODULES(JDK9, Fragments.FeatureModules, DiagKind.PLURAL),
180         EFFECTIVELY_FINAL_VARIABLES_IN_TRY_WITH_RESOURCES(JDK9, Fragments.FeatureVarInTryWithResources, DiagKind.PLURAL),
181         DEPRECATION_ON_IMPORT(MIN, JDK8),
182         POLY(JDK8),
183         LAMBDA(JDK8, Fragments.FeatureLambda, DiagKind.PLURAL),
184         METHOD_REFERENCES(JDK8, Fragments.FeatureMethodReferences, DiagKind.PLURAL),
185         DEFAULT_METHODS(JDK8, Fragments.FeatureDefaultMethods, DiagKind.PLURAL),
186         STATIC_INTERFACE_METHODS(JDK8, Fragments.FeatureStaticIntfMethods, DiagKind.PLURAL),
187         STATIC_INTERFACE_METHODS_INVOKE(JDK8, Fragments.FeatureStaticIntfMethodInvoke, DiagKind.PLURAL),
188         STRICT_METHOD_CLASH_CHECK(JDK8),
189         EFFECTIVELY_FINAL_IN_INNER_CLASSES(JDK8),
190         TYPE_ANNOTATIONS(JDK8, Fragments.FeatureTypeAnnotations, DiagKind.PLURAL),
191         ANNOTATIONS_AFTER_TYPE_PARAMS(JDK8, Fragments.FeatureAnnotationsAfterTypeParams, DiagKind.PLURAL),
192         REPEATED_ANNOTATIONS(JDK8, Fragments.FeatureRepeatableAnnotations, DiagKind.PLURAL),
193         INTERSECTION_TYPES_IN_CAST(JDK8, Fragments.FeatureIntersectionTypesInCast, DiagKind.PLURAL),
194         GRAPH_INFERENCE(JDK8),
195         FUNCTIONAL_INTERFACE_MOST_SPECIFIC(JDK8),
196         POST_APPLICABILITY_VARARGS_ACCESS_CHECK(JDK8),
197         MAP_CAPTURES_TO_BOUNDS(MIN, JDK7),
198         PRIVATE_SAFE_VARARGS(JDK9),
199         DIAMOND_WITH_ANONYMOUS_CLASS_CREATION(JDK9, Fragments.FeatureDiamondAndAnonClass, DiagKind.NORMAL),
200         UNDERSCORE_IDENTIFIER(MIN, JDK8),
201         PRIVATE_INTERFACE_METHODS(JDK9, Fragments.FeaturePrivateIntfMethods, DiagKind.PLURAL),
202         LOCAL_VARIABLE_TYPE_INFERENCE(JDK10),
203         VAR_SYNTAX_IMPLICIT_LAMBDAS(JDK11, Fragments.FeatureVarSyntaxInImplicitLambda, DiagKind.PLURAL),
204         IMPORT_ON_DEMAND_OBSERVABLE_PACKAGES(JDK1_2, JDK8),
205         SWITCH_MULTIPLE_CASE_LABELS(JDK14, Fragments.FeatureMultipleCaseLabels, DiagKind.PLURAL),
206         SWITCH_RULE(JDK14, Fragments.FeatureSwitchRules, DiagKind.PLURAL),
207         SWITCH_EXPRESSION(JDK14, Fragments.FeatureSwitchExpressions, DiagKind.PLURAL),
208         TEXT_BLOCKS(JDK15, Fragments.FeatureTextBlocks, DiagKind.PLURAL),
<span class="line-modified">209         PATTERN_MATCHING_IN_INSTANCEOF(JDK15, Fragments.FeaturePatternMatchingInstanceof, DiagKind.NORMAL),</span>
<span class="line-modified">210         REIFIABLE_TYPES_INSTANCEOF(JDK15, Fragments.FeatureReifiableTypesInstanceof, DiagKind.PLURAL),</span>
<span class="line-modified">211         RECORDS(JDK15, Fragments.FeatureRecords, DiagKind.PLURAL),</span>
<span class="line-modified">212         INLINE_TYPES(JDK15, Fragments.FeatureInlineType, DiagKind.NORMAL),</span>
<span class="line-modified">213         SEALED_CLASSES(JDK15, Fragments.FeatureSealedClasses, DiagKind.PLURAL),</span>
214         ;
215 
216         enum DiagKind {
217             NORMAL,
218             PLURAL;
219         }
220 
221         private final Source minLevel;
222         private final Source maxLevel;
223         private final Fragment optFragment;
224         private final DiagKind optKind;
225 
226         Feature(Source minLevel) {
227             this(minLevel, null, null);
228         }
229 
230         Feature(Source minLevel, Fragment optFragment, DiagKind optKind) {
231             this(minLevel, MAX, optFragment, optKind);
232         }
233 
</pre>
<hr />
<pre>
256             Assert.checkNonNull(optFragment);
257             return optFragment;
258         }
259 
260         public Fragment fragment(String sourceName) {
261             Assert.checkNonNull(optFragment);
262             return optKind == DiagKind.NORMAL ?
263                     Fragments.FeatureNotSupportedInSource(optFragment, sourceName, minLevel.name) :
264                     Fragments.FeatureNotSupportedInSourcePlural(optFragment, sourceName, minLevel.name);
265         }
266 
267         public Error error(String sourceName) {
268             Assert.checkNonNull(optFragment);
269             return optKind == DiagKind.NORMAL ?
270                     Errors.FeatureNotSupportedInSource(optFragment, sourceName, minLevel.name) :
271                     Errors.FeatureNotSupportedInSourcePlural(optFragment, sourceName, minLevel.name);
272         }
273     }
274 
275     public static SourceVersion toSourceVersion(Source source) {
<span class="line-modified">276         switch(source) {</span>
<span class="line-modified">277         case JDK1_2:</span>
<span class="line-modified">278             return RELEASE_2;</span>
<span class="line-modified">279         case JDK1_3:</span>
<span class="line-modified">280             return RELEASE_3;</span>
<span class="line-modified">281         case JDK1_4:</span>
<span class="line-modified">282             return RELEASE_4;</span>
<span class="line-modified">283         case JDK5:</span>
<span class="line-modified">284             return RELEASE_5;</span>
<span class="line-modified">285         case JDK6:</span>
<span class="line-modified">286             return RELEASE_6;</span>
<span class="line-modified">287         case JDK7:</span>
<span class="line-modified">288             return RELEASE_7;</span>
<span class="line-modified">289         case JDK8:</span>
<span class="line-modified">290             return RELEASE_8;</span>
<span class="line-modified">291         case JDK9:</span>
<span class="line-modified">292             return RELEASE_9;</span>
<span class="line-modified">293         case JDK10:</span>
<span class="line-removed">294             return RELEASE_10;</span>
<span class="line-removed">295         case JDK11:</span>
<span class="line-removed">296             return RELEASE_11;</span>
<span class="line-removed">297         case JDK12:</span>
<span class="line-removed">298             return RELEASE_12;</span>
<span class="line-removed">299         case JDK13:</span>
<span class="line-removed">300             return RELEASE_13;</span>
<span class="line-removed">301         case JDK14:</span>
<span class="line-removed">302             return RELEASE_14;</span>
<span class="line-removed">303         case JDK15:</span>
<span class="line-removed">304             return RELEASE_15;</span>
<span class="line-removed">305         default:</span>
<span class="line-removed">306             return null;</span>
<span class="line-removed">307         }</span>
308     }
309 }
</pre>
</td>
<td>
<hr />
<pre>
 83 
 84     /** 1.11 local-variable syntax for lambda parameters */
 85     JDK11(&quot;11&quot;),
 86 
 87     /** 12, no language features; switch expression in preview */
 88     JDK12(&quot;12&quot;),
 89 
 90     /**
 91      * 13, no language features; text blocks and revised switch
 92      * expressions in preview
 93      */
 94     JDK13(&quot;13&quot;),
 95 
 96     /**
 97      * 14, switch expressions; pattern matching, records, and revised
 98      * text blocks in preview
 99      */
100     JDK14(&quot;14&quot;),
101 
102     /**
<span class="line-modified">103       * 15, text blocks</span>
104       */
<span class="line-modified">105     JDK15(&quot;15&quot;),</span>
<span class="line-added">106 </span>
<span class="line-added">107     /**</span>
<span class="line-added">108       * 16, tbd</span>
<span class="line-added">109       */</span>
<span class="line-added">110     JDK16(&quot;16&quot;);</span>
111 
112     private static final Context.Key&lt;Source&gt; sourceKey = new Context.Key&lt;&gt;();
113 
114     public static Source instance(Context context) {
115         Source instance = context.get(sourceKey);
116         if (instance == null) {
117             Options options = Options.instance(context);
118             String sourceString = options.get(SOURCE);
119             if (sourceString != null) instance = lookup(sourceString);
120             if (instance == null) instance = DEFAULT;
121             context.put(sourceKey, instance);
122         }
123         return instance;
124     }
125 
126     public final String name;
127 
128     private static final Map&lt;String,Source&gt; tab = new HashMap&lt;&gt;();
129     static {
130         for (Source s : values()) {
</pre>
<hr />
<pre>
141 
142     private Source(String name) {
143         this.name = name;
144     }
145 
146     public static final Source MIN = Source.JDK7;
147 
148     private static final Source MAX = values()[values().length - 1];
149 
150     public static final Source DEFAULT = MAX;
151 
152     public static Source lookup(String name) {
153         return tab.get(name);
154     }
155 
156     public boolean isSupported() {
157         return this.compareTo(MIN) &gt;= 0;
158     }
159 
160     public Target requiredTarget() {
<span class="line-modified">161         return switch(this) {</span>
<span class="line-modified">162         case JDK16  -&gt; Target.JDK1_16;</span>
<span class="line-modified">163         case JDK15  -&gt; Target.JDK1_15;</span>
<span class="line-modified">164         case JDK14  -&gt; Target.JDK1_14;</span>
<span class="line-modified">165         case JDK13  -&gt; Target.JDK1_13;</span>
<span class="line-modified">166         case JDK12  -&gt; Target.JDK1_12;</span>
<span class="line-modified">167         case JDK11  -&gt; Target.JDK1_11;</span>
<span class="line-modified">168         case JDK10  -&gt; Target.JDK1_10;</span>
<span class="line-modified">169         case JDK9   -&gt; Target.JDK1_9;</span>
<span class="line-modified">170         case JDK8   -&gt; Target.JDK1_8;</span>
<span class="line-modified">171         case JDK7   -&gt; Target.JDK1_7;</span>
<span class="line-modified">172         case JDK6   -&gt; Target.JDK1_6;</span>
<span class="line-modified">173         case JDK5   -&gt; Target.JDK1_5;</span>
<span class="line-added">174         case JDK1_4 -&gt; Target.JDK1_4;</span>
<span class="line-added">175         default     -&gt; Target.JDK1_1;</span>
<span class="line-added">176         };</span>
177     }
178 
179     /**
180      * Models a feature of the Java programming language. Each feature can be associated with a
181      * minimum source level, a maximum source level and a diagnostic fragment describing the feature,
182      * which is used to generate error messages of the kind {@code feature XYZ not supported in source N}.
183      */
184     public enum Feature {
185 
186         DIAMOND(JDK7, Fragments.FeatureDiamond, DiagKind.NORMAL),
187         MODULES(JDK9, Fragments.FeatureModules, DiagKind.PLURAL),
188         EFFECTIVELY_FINAL_VARIABLES_IN_TRY_WITH_RESOURCES(JDK9, Fragments.FeatureVarInTryWithResources, DiagKind.PLURAL),
189         DEPRECATION_ON_IMPORT(MIN, JDK8),
190         POLY(JDK8),
191         LAMBDA(JDK8, Fragments.FeatureLambda, DiagKind.PLURAL),
192         METHOD_REFERENCES(JDK8, Fragments.FeatureMethodReferences, DiagKind.PLURAL),
193         DEFAULT_METHODS(JDK8, Fragments.FeatureDefaultMethods, DiagKind.PLURAL),
194         STATIC_INTERFACE_METHODS(JDK8, Fragments.FeatureStaticIntfMethods, DiagKind.PLURAL),
195         STATIC_INTERFACE_METHODS_INVOKE(JDK8, Fragments.FeatureStaticIntfMethodInvoke, DiagKind.PLURAL),
196         STRICT_METHOD_CLASH_CHECK(JDK8),
197         EFFECTIVELY_FINAL_IN_INNER_CLASSES(JDK8),
198         TYPE_ANNOTATIONS(JDK8, Fragments.FeatureTypeAnnotations, DiagKind.PLURAL),
199         ANNOTATIONS_AFTER_TYPE_PARAMS(JDK8, Fragments.FeatureAnnotationsAfterTypeParams, DiagKind.PLURAL),
200         REPEATED_ANNOTATIONS(JDK8, Fragments.FeatureRepeatableAnnotations, DiagKind.PLURAL),
201         INTERSECTION_TYPES_IN_CAST(JDK8, Fragments.FeatureIntersectionTypesInCast, DiagKind.PLURAL),
202         GRAPH_INFERENCE(JDK8),
203         FUNCTIONAL_INTERFACE_MOST_SPECIFIC(JDK8),
204         POST_APPLICABILITY_VARARGS_ACCESS_CHECK(JDK8),
205         MAP_CAPTURES_TO_BOUNDS(MIN, JDK7),
206         PRIVATE_SAFE_VARARGS(JDK9),
207         DIAMOND_WITH_ANONYMOUS_CLASS_CREATION(JDK9, Fragments.FeatureDiamondAndAnonClass, DiagKind.NORMAL),
208         UNDERSCORE_IDENTIFIER(MIN, JDK8),
209         PRIVATE_INTERFACE_METHODS(JDK9, Fragments.FeaturePrivateIntfMethods, DiagKind.PLURAL),
210         LOCAL_VARIABLE_TYPE_INFERENCE(JDK10),
211         VAR_SYNTAX_IMPLICIT_LAMBDAS(JDK11, Fragments.FeatureVarSyntaxInImplicitLambda, DiagKind.PLURAL),
212         IMPORT_ON_DEMAND_OBSERVABLE_PACKAGES(JDK1_2, JDK8),
213         SWITCH_MULTIPLE_CASE_LABELS(JDK14, Fragments.FeatureMultipleCaseLabels, DiagKind.PLURAL),
214         SWITCH_RULE(JDK14, Fragments.FeatureSwitchRules, DiagKind.PLURAL),
215         SWITCH_EXPRESSION(JDK14, Fragments.FeatureSwitchExpressions, DiagKind.PLURAL),
216         TEXT_BLOCKS(JDK15, Fragments.FeatureTextBlocks, DiagKind.PLURAL),
<span class="line-modified">217         PATTERN_MATCHING_IN_INSTANCEOF(JDK16, Fragments.FeaturePatternMatchingInstanceof, DiagKind.NORMAL),</span>
<span class="line-modified">218         REIFIABLE_TYPES_INSTANCEOF(JDK16, Fragments.FeatureReifiableTypesInstanceof, DiagKind.PLURAL),</span>
<span class="line-modified">219         RECORDS(JDK16, Fragments.FeatureRecords, DiagKind.PLURAL),</span>
<span class="line-modified">220         INLINE_TYPES(JDK16, Fragments.FeatureInlineType, DiagKind.NORMAL),</span>
<span class="line-modified">221         SEALED_CLASSES(JDK16, Fragments.FeatureSealedClasses, DiagKind.PLURAL),</span>
222         ;
223 
224         enum DiagKind {
225             NORMAL,
226             PLURAL;
227         }
228 
229         private final Source minLevel;
230         private final Source maxLevel;
231         private final Fragment optFragment;
232         private final DiagKind optKind;
233 
234         Feature(Source minLevel) {
235             this(minLevel, null, null);
236         }
237 
238         Feature(Source minLevel, Fragment optFragment, DiagKind optKind) {
239             this(minLevel, MAX, optFragment, optKind);
240         }
241 
</pre>
<hr />
<pre>
264             Assert.checkNonNull(optFragment);
265             return optFragment;
266         }
267 
268         public Fragment fragment(String sourceName) {
269             Assert.checkNonNull(optFragment);
270             return optKind == DiagKind.NORMAL ?
271                     Fragments.FeatureNotSupportedInSource(optFragment, sourceName, minLevel.name) :
272                     Fragments.FeatureNotSupportedInSourcePlural(optFragment, sourceName, minLevel.name);
273         }
274 
275         public Error error(String sourceName) {
276             Assert.checkNonNull(optFragment);
277             return optKind == DiagKind.NORMAL ?
278                     Errors.FeatureNotSupportedInSource(optFragment, sourceName, minLevel.name) :
279                     Errors.FeatureNotSupportedInSourcePlural(optFragment, sourceName, minLevel.name);
280         }
281     }
282 
283     public static SourceVersion toSourceVersion(Source source) {
<span class="line-modified">284         return switch(source) {</span>
<span class="line-modified">285         case JDK1_2 -&gt; RELEASE_2;</span>
<span class="line-modified">286         case JDK1_3 -&gt; RELEASE_3;</span>
<span class="line-modified">287         case JDK1_4 -&gt; RELEASE_4;</span>
<span class="line-modified">288         case JDK5   -&gt; RELEASE_5;</span>
<span class="line-modified">289         case JDK6   -&gt; RELEASE_6;</span>
<span class="line-modified">290         case JDK7   -&gt; RELEASE_7;</span>
<span class="line-modified">291         case JDK8   -&gt; RELEASE_8;</span>
<span class="line-modified">292         case JDK9   -&gt; RELEASE_9;</span>
<span class="line-modified">293         case JDK10  -&gt; RELEASE_10;</span>
<span class="line-modified">294         case JDK11  -&gt; RELEASE_11;</span>
<span class="line-modified">295         case JDK12  -&gt; RELEASE_12;</span>
<span class="line-modified">296         case JDK13  -&gt; RELEASE_13;</span>
<span class="line-modified">297         case JDK14  -&gt; RELEASE_14;</span>
<span class="line-modified">298         case JDK15  -&gt; RELEASE_15;</span>
<span class="line-modified">299         case JDK16  -&gt; RELEASE_16;</span>
<span class="line-modified">300         default     -&gt; null;</span>
<span class="line-modified">301         };</span>














302     }
303 }
</pre>
</td>
</tr>
</table>
<center><a href="../../doclint/Checker.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../jvm/ClassFile.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>