<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/compiler/compileBroker.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../code/compiledMethod.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../gc/parallel/psParallelCompact.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/compiler/compileBroker.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
1163     // We now know that this compilation is not pending, complete,
1164     // or prohibited.  Assign a compile_id to this compilation
1165     // and check to see if it is in our [Start..Stop) range.
1166     int compile_id = assign_compile_id(method, osr_bci);
1167     if (compile_id == 0) {
1168       // The compilation falls outside the allowed range.
1169       return;
1170     }
1171 
1172 #if INCLUDE_JVMCI
1173     if (UseJVMCICompiler &amp;&amp; blocking) {
1174       // Don&#39;t allow blocking compiles for requests triggered by JVMCI.
1175       if (thread-&gt;is_Compiler_thread()) {
1176         blocking = false;
1177       }
1178 
1179       if (!UseJVMCINativeLibrary) {
1180         // Don&#39;t allow blocking compiles if inside a class initializer or while performing class loading
1181         vframeStream vfst((JavaThread*) thread);
1182         for (; !vfst.at_end(); vfst.next()) {
<span class="line-modified">1183           if (vfst.method()-&gt;is_static_initializer() ||</span>
1184               (vfst.method()-&gt;method_holder()-&gt;is_subclass_of(SystemDictionary::ClassLoader_klass()) &amp;&amp;
1185                   vfst.method()-&gt;name() == vmSymbols::loadClass_name())) {
1186             blocking = false;
1187             break;
1188           }
1189         }
1190       }
1191 
1192       // Don&#39;t allow blocking compilation requests to JVMCI
1193       // if JVMCI itself is not yet initialized
1194       if (!JVMCI::is_compiler_initialized() &amp;&amp; compiler(comp_level)-&gt;is_jvmci()) {
1195         blocking = false;
1196       }
1197 
1198       // Don&#39;t allow blocking compilation requests if we are in JVMCIRuntime::shutdown
1199       // to avoid deadlock between compiler thread(s) and threads run at shutdown
1200       // such as the DestroyJavaVM thread.
1201       if (JVMCI::shutdown_called()) {
1202         blocking = false;
1203       }
</pre>
</td>
<td>
<hr />
<pre>
1163     // We now know that this compilation is not pending, complete,
1164     // or prohibited.  Assign a compile_id to this compilation
1165     // and check to see if it is in our [Start..Stop) range.
1166     int compile_id = assign_compile_id(method, osr_bci);
1167     if (compile_id == 0) {
1168       // The compilation falls outside the allowed range.
1169       return;
1170     }
1171 
1172 #if INCLUDE_JVMCI
1173     if (UseJVMCICompiler &amp;&amp; blocking) {
1174       // Don&#39;t allow blocking compiles for requests triggered by JVMCI.
1175       if (thread-&gt;is_Compiler_thread()) {
1176         blocking = false;
1177       }
1178 
1179       if (!UseJVMCINativeLibrary) {
1180         // Don&#39;t allow blocking compiles if inside a class initializer or while performing class loading
1181         vframeStream vfst((JavaThread*) thread);
1182         for (; !vfst.at_end(); vfst.next()) {
<span class="line-modified">1183         if (vfst.method()-&gt;is_class_initializer() ||</span>
1184               (vfst.method()-&gt;method_holder()-&gt;is_subclass_of(SystemDictionary::ClassLoader_klass()) &amp;&amp;
1185                   vfst.method()-&gt;name() == vmSymbols::loadClass_name())) {
1186             blocking = false;
1187             break;
1188           }
1189         }
1190       }
1191 
1192       // Don&#39;t allow blocking compilation requests to JVMCI
1193       // if JVMCI itself is not yet initialized
1194       if (!JVMCI::is_compiler_initialized() &amp;&amp; compiler(comp_level)-&gt;is_jvmci()) {
1195         blocking = false;
1196       }
1197 
1198       // Don&#39;t allow blocking compilation requests if we are in JVMCIRuntime::shutdown
1199       // to avoid deadlock between compiler thread(s) and threads run at shutdown
1200       // such as the DestroyJavaVM thread.
1201       if (JVMCI::shutdown_called()) {
1202         blocking = false;
1203       }
</pre>
</td>
</tr>
</table>
<center><a href="../code/compiledMethod.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../gc/parallel/psParallelCompact.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>