<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames test/lib/jdk/test/lib/Convert.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
    <script type="text/javascript" src="../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 2018, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.
  8  *
  9  * This code is distributed in the hope that it will be useful, but WITHOUT
 10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 12  * version 2 for more details (a copy is included in the LICENSE file that
 13  * accompanied this code).
 14  *
 15  * You should have received a copy of the GNU General Public License version
 16  * 2 along with this work; if not, write to the Free Software Foundation,
 17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 18  *
 19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 20  * or visit www.oracle.com if you need additional information or have any
 21  * questions.
 22  */
 23 
 24 package jdk.test.lib;
 25 
 26 import java.math.BigInteger;
<a name="2" id="anc2"></a><span class="line-added"> 27 import java.security.spec.EdECPoint;</span>
 28 
 29 /**
<a name="3" id="anc3"></a><span class="line-modified"> 30  * Utility class containing conversions between strings, arrays, numeric</span>
<span class="line-modified"> 31  * values, and other types.</span>
 32  */
 33 
 34 public class Convert {
 35 
 36     // Convert from a byte array to a hexadecimal representation as a string.
 37     public static String byteArrayToHexString(byte[] arr) {
 38         StringBuilder result = new StringBuilder();
 39         for (int i = 0; i &lt; arr.length; ++i) {
 40             byte curVal = arr[i];
 41             result.append(Character.forDigit(curVal &gt;&gt; 4 &amp; 0xF, 16));
 42             result.append(Character.forDigit(curVal &amp; 0xF, 16));
 43         }
 44         return result.toString();
 45     }
 46 
 47     // Expand a single byte to a byte array
 48     public static byte[] byteToByteArray(byte v, int length) {
 49         byte[] result = new byte[length];
 50         result[0] = v;
 51         return result;
 52     }
 53 
 54     // Convert a hexadecimal string to a byte array
 55     public static byte[] hexStringToByteArray(String str) {
 56         byte[] result = new byte[str.length() / 2];
 57         for (int i = 0; i &lt; result.length; i++) {
 58             result[i] = (byte) Character.digit(str.charAt(2 * i), 16);
 59             result[i] &lt;&lt;= 4;
 60             result[i] += Character.digit(str.charAt(2 * i + 1), 16);
 61         }
 62         return result;
 63     }
 64 
 65     /*
 66      * Convert a hexadecimal string to the corresponding little-ending number
 67      * as a BigInteger. The clearHighBit argument determines whether the most
 68      * significant bit of the highest byte should be set to 0 in the result.
 69      */
 70     public static
 71     BigInteger hexStringToBigInteger(boolean clearHighBit, String str) {
 72         BigInteger result = BigInteger.ZERO;
 73         for (int i = 0; i &lt; str.length() / 2; i++) {
 74             int curVal = Character.digit(str.charAt(2 * i), 16);
 75             curVal &lt;&lt;= 4;
 76             curVal += Character.digit(str.charAt(2 * i + 1), 16);
 77             if (clearHighBit &amp;&amp; i == str.length() / 2 - 1) {
 78                 curVal &amp;= 0x7F;
 79             }
 80             result = result.add(BigInteger.valueOf(curVal).shiftLeft(8 * i));
 81         }
 82         return result;
 83     }
<a name="4" id="anc4"></a><span class="line-added"> 84 </span>
<span class="line-added"> 85     private static EdECPoint byteArrayToEdPoint(byte[] arr) {</span>
<span class="line-added"> 86         byte msb = arr[arr.length - 1];</span>
<span class="line-added"> 87         boolean xOdd = (msb &amp; 0x80) != 0;</span>
<span class="line-added"> 88         arr[arr.length - 1] &amp;= (byte) 0x7F;</span>
<span class="line-added"> 89         reverse(arr);</span>
<span class="line-added"> 90         BigInteger y = new BigInteger(1, arr);</span>
<span class="line-added"> 91         return new EdECPoint(xOdd, y);</span>
<span class="line-added"> 92     }</span>
<span class="line-added"> 93 </span>
<span class="line-added"> 94     public static EdECPoint hexStringToEdPoint(String str) {</span>
<span class="line-added"> 95         return byteArrayToEdPoint(hexStringToByteArray(str));</span>
<span class="line-added"> 96     }</span>
<span class="line-added"> 97 </span>
<span class="line-added"> 98     private static void swap(byte[] arr, int i, int j) {</span>
<span class="line-added"> 99         byte tmp = arr[i];</span>
<span class="line-added">100         arr[i] = arr[j];</span>
<span class="line-added">101         arr[j] = tmp;</span>
<span class="line-added">102     }</span>
<span class="line-added">103 </span>
<span class="line-added">104     private static void reverse(byte [] arr) {</span>
<span class="line-added">105         int i = 0;</span>
<span class="line-added">106         int j = arr.length - 1;</span>
<span class="line-added">107 </span>
<span class="line-added">108         while (i &lt; j) {</span>
<span class="line-added">109             swap(arr, i, j);</span>
<span class="line-added">110             i++;</span>
<span class="line-added">111             j--;</span>
<span class="line-added">112         }</span>
<span class="line-added">113     }</span>
114 }
115 
116 
<a name="5" id="anc5"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="5" type="hidden" />
</body>
</html>