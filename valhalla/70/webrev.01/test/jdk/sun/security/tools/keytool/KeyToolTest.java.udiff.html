<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/jdk/sun/security/tools/keytool/KeyToolTest.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../jarsigner/TimestampCheck.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../util/Oid/OidEquals.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/sun/security/tools/keytool/KeyToolTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2005, 2019, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2005, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -21,11 +21,11 @@</span>
   * questions.
   */
  
  /*
   * @test
<span class="udiff-line-modified-removed">-  * @bug 6251120 8231950</span>
<span class="udiff-line-modified-added">+  * @bug 6251120 8231950 8242151</span>
   * @summary Testing keytool
   *
   * Run through autotest.sh and manualtest.sh
   *
   * Testing non-PKCS11 keystores:
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1600,22 +1600,22 @@</span>
              void check(KeyStore ks, String alias, String oid, byte[] value)
                      throws Exception {
                  int pos = 0;
                  System.err.print(&quot;x&quot;);
                  Extension ex = ((X509CertImpl)ks.getCertificate(alias))
<span class="udiff-line-modified-removed">-                         .getExtension(new ObjectIdentifier(oid));</span>
<span class="udiff-line-modified-added">+                         .getExtension(ObjectIdentifier.of(oid));</span>
                  if (!Arrays.equals(value, ex.getValue())) {
                      throw new RuntimeException(&quot;Not same content in &quot; +
                              alias + &quot; for &quot; + oid);
                  }
              }
          }
          CheckOid coid = new CheckOid();
          assertTrue(((X509CertImpl)ks.getCertificate(&quot;oid1&quot;))
<span class="udiff-line-modified-removed">-                 .getExtension(new ObjectIdentifier(&quot;1.2.3&quot;)).isCritical());</span>
<span class="udiff-line-modified-added">+                 .getExtension(ObjectIdentifier.of(&quot;1.2.3&quot;)).isCritical());</span>
          assertTrue(!((X509CertImpl)ks.getCertificate(&quot;oid2&quot;))
<span class="udiff-line-modified-removed">-                 .getExtension(new ObjectIdentifier(&quot;1.2.3&quot;)).isCritical());</span>
<span class="udiff-line-modified-added">+                 .getExtension(ObjectIdentifier.of(&quot;1.2.3&quot;)).isCritical());</span>
          coid.check(ks, &quot;oid1&quot;, &quot;1.2.3&quot;, new byte[]{1,2});
          coid.check(ks, &quot;oid2&quot;, &quot;1.2.3&quot;, new byte[]{});
          coid.check(ks, &quot;oid12&quot;, &quot;1.2.3&quot;, new byte[]{});
          coid.check(ks, &quot;oid12&quot;, &quot;1.2.4&quot;, new byte[]{1,2,3});
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1641,29 +1641,29 @@</span>
          ks = loadStore(&quot;x.jks&quot;, &quot;changeit&quot;, &quot;JKS&quot;);
          X509CertImpl a = (X509CertImpl)ks.getCertificate(&quot;a&quot;);
          assertTrue(a.getAuthorityKeyIdentifierExtension() != null);
          assertTrue(a.getSubjectKeyIdentifierExtension() != null);
          assertTrue(a.getKeyUsage() == null);
<span class="udiff-line-modified-removed">-         assertTrue(a.getExtension(new ObjectIdentifier(&quot;1.2.3&quot;)).isCritical());</span>
<span class="udiff-line-modified-removed">-         assertTrue(!a.getExtension(new ObjectIdentifier(&quot;1.2.4&quot;)).isCritical());</span>
<span class="udiff-line-modified-removed">-         assertTrue(!a.getExtension(new ObjectIdentifier(&quot;1.2.5&quot;)).isCritical());</span>
<span class="udiff-line-modified-added">+         assertTrue(a.getExtension(ObjectIdentifier.of(&quot;1.2.3&quot;)).isCritical());</span>
<span class="udiff-line-modified-added">+         assertTrue(!a.getExtension(ObjectIdentifier.of(&quot;1.2.4&quot;)).isCritical());</span>
<span class="udiff-line-modified-added">+         assertTrue(!a.getExtension(ObjectIdentifier.of(&quot;1.2.5&quot;)).isCritical());</span>
          assertTrue(a.getExtensionValue(&quot;1.2.3&quot;).length == 3);
          assertTrue(a.getExtensionValue(&quot;1.2.4&quot;).length == 4);
          assertTrue(a.getExtensionValue(&quot;1.2.5&quot;).length == 5);
          assertTrue(a.getBasicConstraints() == 2);
<span class="udiff-line-modified-removed">-         assertTrue(!a.getExtension(new ObjectIdentifier(&quot;2.3.4&quot;)).isCritical());</span>
<span class="udiff-line-modified-added">+         assertTrue(!a.getExtension(ObjectIdentifier.of(&quot;2.3.4&quot;)).isCritical());</span>
          assertTrue(a.getExtensionValue(&quot;2.3.4&quot;).length == 6);
  
          // 8073181: keytool -ext honored not working correctly
          testOK(&quot;&quot;, simple+&quot;-gencert -alias ca -infile test.req -ext &quot; +
                  &quot;honored=1.2.3,KU,1.2.4:critical &quot; +
                  &quot;-debug -rfc -outfile test2.cert&quot;);
          testOK(&quot;&quot;, simple+&quot;-importcert -file test2.cert -alias b&quot;);
          ks = loadStore(&quot;x.jks&quot;, &quot;changeit&quot;, &quot;JKS&quot;);
          X509CertImpl b = (X509CertImpl)ks.getCertificate(&quot;b&quot;);
<span class="udiff-line-modified-removed">-         assertTrue(!b.getExtension(new ObjectIdentifier(&quot;1.2.3&quot;)).isCritical());</span>
<span class="udiff-line-modified-removed">-         assertTrue(b.getExtension(new ObjectIdentifier(&quot;1.2.4&quot;)).isCritical());</span>
<span class="udiff-line-modified-added">+         assertTrue(!b.getExtension(ObjectIdentifier.of(&quot;1.2.3&quot;)).isCritical());</span>
<span class="udiff-line-modified-added">+         assertTrue(b.getExtension(ObjectIdentifier.of(&quot;1.2.4&quot;)).isCritical());</span>
  
          // 8073182: keytool may generate duplicate extensions
          testOK(&quot;&quot;, pre+&quot;dup -ext bc=2 -ext 2.5.29.19=30030101FF -ext bc=3&quot;);
          ks = loadStore(&quot;x.jks&quot;, &quot;changeit&quot;, &quot;JKS&quot;);
          X509CertImpl dup = (X509CertImpl)ks.getCertificate(&quot;dup&quot;);
</pre>
<center><a href="../jarsigner/TimestampCheck.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../../util/Oid/OidEquals.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>