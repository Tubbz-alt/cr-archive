diff a/test/jdk/java/net/MulticastSocket/UnreferencedMulticastSockets.java b/test/jdk/java/net/MulticastSocket/UnreferencedMulticastSockets.java
--- a/test/jdk/java/net/MulticastSocket/UnreferencedMulticastSockets.java
+++ b/test/jdk/java/net/MulticastSocket/UnreferencedMulticastSockets.java
@@ -1,7 +1,7 @@
 /*
- * Copyright (c) 2018, 2019, Oracle and/or its affiliates. All rights reserved.
+ * Copyright (c) 2018, 2020, Oracle and/or its affiliates. All rights reserved.
  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  *
  * This code is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License version 2 only, as
  * published by the Free Software Foundation.
@@ -23,11 +23,13 @@
 
 /**
  * @test
  * @library /test/lib
  * @modules java.management java.base/java.io:+open java.base/java.net:+open
+ *          java.base/sun.net
  * @run main/othervm -Djava.net.preferIPv4Stack=true UnreferencedMulticastSockets
+ * @run main/othervm -Djdk.net.usePlainDatagramSocketImpl UnreferencedMulticastSockets
  * @run main/othervm UnreferencedMulticastSockets
  * @summary Check that unreferenced multicast sockets are closed
  */
 
 import java.io.FileDescriptor;
@@ -35,29 +37,34 @@
 import java.lang.management.OperatingSystemMXBean;
 import java.lang.ref.ReferenceQueue;
 import java.lang.ref.WeakReference;
 import java.lang.reflect.Field;
 import java.io.IOException;
+import java.lang.reflect.Method;
 import java.net.DatagramPacket;
 import java.net.DatagramSocket;
 import java.net.DatagramSocketImpl;
 import java.net.InetAddress;
 import java.net.InetSocketAddress;
 import java.net.MulticastSocket;
 import java.net.UnknownHostException;
+import java.nio.channels.DatagramChannel;
 import java.nio.file.Files;
 import java.nio.file.Path;
 import java.nio.file.Paths;
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.util.ArrayDeque;
 import java.util.List;
 import java.util.Optional;
 import java.util.concurrent.Phaser;
 import java.util.concurrent.TimeUnit;
 
 import jdk.test.lib.net.IPSupport;
 
 import com.sun.management.UnixOperatingSystemMXBean;
+import sun.net.NetProperties;
 
 public class UnreferencedMulticastSockets {
 
     /**
      * The set of sockets we have to check up on.
@@ -221,36 +228,66 @@
         return (mxBean instanceof UnixOperatingSystemMXBean)
                 ? ((UnixOperatingSystemMXBean) mxBean).getOpenFileDescriptorCount()
                 : -1L;
     }
 
-    // Reflect to find references in the socket implementation that will be gc'd
-    private static void extractRefs(MulticastSocket s, String name) {
+    private static boolean usePlainDatagramSocketImpl() {
+        PrivilegedAction<String> pa = () -> NetProperties.get("jdk.net.usePlainDatagramSocketImpl");
+        String s = AccessController.doPrivileged(pa);
+        return (s != null) && (s.isEmpty() || s.equalsIgnoreCase("true"));
+    }
+
+    // Reflect to find references in the datagram implementation that will be gc'd
+    private static void extractRefs(DatagramSocket s, String name) {
+
         try {
+            Field datagramSocketField = DatagramSocket.class.getDeclaredField("delegate");
+            datagramSocketField.setAccessible(true);
+
+            if (!usePlainDatagramSocketImpl()) {
+                // MulticastSocket using DatagramSocketAdaptor
+                Object MulticastSocket = datagramSocketField.get(s);
 
-            Field socketImplField = DatagramSocket.class.getDeclaredField("impl");
-            socketImplField.setAccessible(true);
-            Object socketImpl = socketImplField.get(s);
+                Method m = DatagramSocket.class.getDeclaredMethod("getChannel");
+                m.setAccessible(true);
+                DatagramChannel datagramChannel = (DatagramChannel) m.invoke(MulticastSocket);
 
-            Field fileDescriptorField = DatagramSocketImpl.class.getDeclaredField("fd");
-            fileDescriptorField.setAccessible(true);
-            FileDescriptor fileDescriptor = (FileDescriptor) fileDescriptorField.get(socketImpl);
-            extractRefs(fileDescriptor, name);
+                assert datagramChannel.getClass() == Class.forName("sun.nio.ch.DatagramChannelImpl");
 
-            Class<?> socketImplClass = socketImpl.getClass();
-            System.out.printf("socketImplClass: %s%n", socketImplClass);
-            if (socketImplClass.getName().equals("java.net.TwoStacksPlainDatagramSocketImpl")) {
-                Field fileDescriptor1Field = socketImplClass.getDeclaredField("fd1");
-                fileDescriptor1Field.setAccessible(true);
-                FileDescriptor fileDescriptor1 = (FileDescriptor) fileDescriptor1Field.get(socketImpl);
-                extractRefs(fileDescriptor1, name + "::twoStacksFd1");
+                Field fileDescriptorField = datagramChannel.getClass().getDeclaredField("fd");
+                fileDescriptorField.setAccessible(true);
+                FileDescriptor fileDescriptor = (FileDescriptor) fileDescriptorField.get(datagramChannel);
+                extractRefs(fileDescriptor, name);
 
             } else {
-                System.out.printf("socketImpl class name not matched: %s != %s%n",
-                        socketImplClass.getName(), "java.net.TwoStacksPlainDatagramSocketImpl");
+                // MulticastSocket using PlainDatagramSocketImpl
+                Object MulticastSocket = datagramSocketField.get(s);
+                assert MulticastSocket.getClass() == Class.forName("java.net.NetMulticastSocket");
+
+                Method m = MulticastSocket.getClass().getDeclaredMethod("getImpl");
+                m.setAccessible(true);
+                DatagramSocketImpl datagramSocketImpl = (DatagramSocketImpl) m.invoke(MulticastSocket);
+
+                Field fileDescriptorField = DatagramSocketImpl.class.getDeclaredField("fd");
+                fileDescriptorField.setAccessible(true);
+                FileDescriptor fileDescriptor = (FileDescriptor) fileDescriptorField.get(datagramSocketImpl);
+                extractRefs(fileDescriptor, name);
+
+                Class<?> socketImplClass = datagramSocketImpl.getClass();
+                System.out.printf("socketImplClass: %s%n", socketImplClass);
+                if (socketImplClass.getName().equals("java.net.TwoStacksPlainDatagramSocketImpl")) {
+                    Field fileDescriptor1Field = socketImplClass.getDeclaredField("fd1");
+                    fileDescriptor1Field.setAccessible(true);
+                    FileDescriptor fileDescriptor1 = (FileDescriptor) fileDescriptor1Field.get(datagramSocketImpl);
+                    extractRefs(fileDescriptor1, name + "::twoStacksFd1");
+
+                } else {
+                    System.out.printf("socketImpl class name not matched: %s != %s%n",
+                            socketImplClass.getName(), "java.net.TwoStacksPlainDatagramSocketImpl");
+                }
             }
-        } catch (NoSuchFieldException | IllegalAccessException ex) {
+        } catch (Exception ex) {
             ex.printStackTrace();
             throw new AssertionError("missing field", ex);
         }
     }
 
