diff a/make/Main.gmk b/make/Main.gmk
--- a/make/Main.gmk
+++ b/make/Main.gmk
@@ -150,22 +150,21 @@
 $(eval $(call DeclareRecipesForPhase, GENDATA, \
     TARGET_SUFFIX := gendata, \
     FILE_PREFIX := Gendata, \
     MAKE_SUBDIR := gendata, \
     CHECK_MODULES := $(ALL_MODULES), \
-    USE_WRAPPER := true))
+))
 
 ALL_TARGETS += $(GENDATA_TARGETS)
 
 ################################################################################
 # Copy files targets
 $(eval $(call DeclareRecipesForPhase, COPY, \
     TARGET_SUFFIX := copy, \
     FILE_PREFIX := Copy, \
     MAKE_SUBDIR := copy, \
     CHECK_MODULES := $(ALL_MODULES), \
-    USE_WRAPPER := true, \
 ))
 
 ALL_COPY_MODULES += $(COPY_MODULES)
 ALL_COPY_TARGETS += $(COPY_TARGETS)
 
@@ -204,11 +203,11 @@
 $(eval $(call DeclareRecipesForPhase, LIBS, \
     TARGET_SUFFIX := libs, \
     FILE_PREFIX := Lib, \
     MAKE_SUBDIR := lib, \
     CHECK_MODULES := $(ALL_MODULES), \
-    USE_WRAPPER := true))
+))
 
 ALL_TARGETS += $(LIBS_TARGETS)
 
 ################################################################################
 # Targets for compiling static versions of certain native libraries. These do
@@ -217,11 +216,10 @@
 $(eval $(call DeclareRecipesForPhase, STATIC_LIBS, \
     TARGET_SUFFIX := static-libs, \
     FILE_PREFIX := Lib, \
     MAKE_SUBDIR := lib, \
     CHECK_MODULES := $(STATIC_LIBS_MODULES), \
-    USE_WRAPPER := true, \
     EXTRA_ARGS := STATIC_LIBS=true, \
 ))
 
 ALL_TARGETS += $(STATIC_LIBS_TARGETS)
 
@@ -230,11 +228,11 @@
 $(eval $(call DeclareRecipesForPhase, LAUNCHER, \
     TARGET_SUFFIX := launchers, \
     FILE_PREFIX := Launcher, \
     MAKE_SUBDIR := launcher, \
     CHECK_MODULES := $(ALL_MODULES), \
-    USE_WRAPPER := true))
+))
 
 ALL_TARGETS += $(LAUNCHER_TARGETS)
 
 ################################################################################
 # Build hotspot target
@@ -259,12 +257,13 @@
 endef
 
 $(foreach v, $(JVM_VARIANTS), $(eval $(call DeclareHotspotLibsRecipe,$v)))
 
 $(eval $(call SetupTarget, hotspot-ide-project, \
-    MAKEFILE := ide/CreateVSProject, \
+    MAKEFILE := ide/visualstudio/hotspot/CreateVSProject, \
     DEPS := hotspot exploded-image, \
+    ARGS := -I$(TOPDIR)/make/hotspot, \
 ))
 
 ALL_TARGETS += $(HOTSPOT_VARIANT_TARGETS) $(HOTSPOT_VARIANT_GENSRC_TARGETS) \
     $(HOTSPOT_VARIANT_LIBS_TARGETS)
 
@@ -299,29 +298,29 @@
 
 ################################################################################
 # VS Code projects
 
 $(eval $(call SetupTarget, vscode-project, \
-    MAKEFILE := CreateVSCodeProject, \
+    MAKEFILE := ide/vscode/hotspot/CreateVSCodeProject, \
     ARGS := VSCODE_INDEXER=cpptools, \
     DEPS := compile-commands, \
 ))
 
 $(eval $(call SetupTarget, vscode-project-clangd, \
-    MAKEFILE := CreateVSCodeProject, \
+    MAKEFILE := ide/vscode/hotspot/CreateVSCodeProject, \
     ARGS := VSCODE_INDEXER=clangd, \
     DEPS := compile-commands, \
 ))
 
 $(eval $(call SetupTarget, vscode-project-rtags, \
-    MAKEFILE := CreateVSCodeProject, \
+    MAKEFILE := ide/vscode/hotspot/CreateVSCodeProject, \
     ARGS := VSCODE_INDEXER=rtags, \
     DEPS := compile-commands, \
 ))
 
 $(eval $(call SetupTarget, vscode-project-ccls, \
-    MAKEFILE := CreateVSCodeProject, \
+    MAKEFILE := ide/vscode/hotspot/CreateVSCodeProject, \
     ARGS := VSCODE_INDEXER=ccls, \
     DEPS := compile-commands, \
 ))
 
 ################################################################################
@@ -1099,20 +1098,27 @@
 endif
 
 # This target builds the documentation image
 docs-image: docs-jdk
 
-# If not already set, set the JVM specific targets to build the test image
-JVM_TEST_IMAGE_TARGETS ?= test-image-hotspot-jtreg-native test-image-hotspot-gtest
+# This target builds the test image
+test-image: prepare-test-image test-image-jdk-jtreg-native test-image-demos-jdk
 
-ifeq ($(INCLUDE_GRAAL), true)
-  JVM_TEST_IMAGE_TARGETS += test-image-hotspot-jtreg-graal
-endif
+ifneq ($(JVM_TEST_IMAGE_TARGETS), )
+  # If JVM_TEST_IMAGE_TARGETS is externally defined, use it instead of the
+  # standard hotspot set of tests.
+  test-image: $(JVM_TEST_IMAGE_TARGETS)
+else
+  test-image: test-image-hotspot-jtreg-native
+  ifeq ($(BUILD_GTEST), true)
+    test-image: test-image-hotspot-gtest
+  endif
 
-# This target builds the test image
-test-image: prepare-test-image test-image-jdk-jtreg-native \
-    test-image-demos-jdk $(JVM_TEST_IMAGE_TARGETS)
+  ifeq ($(INCLUDE_GRAAL), true)
+    test-image: test-image-hotspot-jtreg-graal
+  endif
+endif
 
 ifeq ($(BUILD_FAILURE_HANDLER), true)
   test-image: test-image-failure-handler
 endif
 
