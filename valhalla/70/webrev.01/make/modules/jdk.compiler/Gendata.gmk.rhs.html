<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames make/modules/jdk.compiler/Gendata.gmk</title>
    <link rel="stylesheet" href="../../../style.css" />
    <script type="text/javascript" src="../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 #
  2 # Copyright (c) 2015, 2020, Oracle and/or its affiliates. All rights reserved.
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
 23 # questions.
 24 #
 25 
 26 include JarArchive.gmk
 27 include JavaCompilation.gmk
 28 include Modules.gmk
 29 
 30 ################################################################################
 31 
 32 # Hook to include the corresponding custom file, if present.
 33 $(eval $(call IncludeCustomExtension, modules/jdk.compiler/Gendata.gmk))
 34 
 35 # This is needed to properly setup DOCS_MODULES.
 36 $(eval $(call ReadImportMetaData))
 37 
 38 # Modules that should be visible for 9 - the documented modules:
 39 CT_MODULES := $(DOCS_MODULES)
 40 
 41 # Get the complete module source path:
 42 CT_MODULESOURCEPATH := $(call GetModuleSrcPath)
 43 
 44 CT_DATA_DESCRIPTION += $(TOPDIR)/make/data/symbols/symbols
 45 
 46 COMPILECREATESYMBOLS_ADD_EXPORTS := \
 47     --add-exports java.base/jdk.internal=java.compiler.interim,jdk.compiler.interim \
 48     --add-exports jdk.compiler.interim/com.sun.tools.javac.api=ALL-UNNAMED \
 49     --add-exports jdk.compiler.interim/com.sun.tools.javac.code=ALL-UNNAMED \
 50     --add-exports jdk.compiler.interim/com.sun.tools.javac.util=ALL-UNNAMED \
 51     --add-exports jdk.compiler.interim/com.sun.tools.javac.jvm=ALL-UNNAMED \
 52     #
 53 
 54 $(eval $(call SetupJavaCompilation, COMPILE_CREATE_SYMBOLS, \
 55     TARGET_RELEASE := $(TARGET_RELEASE_BOOTJDK), \
 56     SRC := $(TOPDIR)/make/langtools/src/classes \
 57         $(TOPDIR)/src/jdk.jdeps/share/classes, \
 58     INCLUDES := build/tools/symbolgenerator com/sun/tools/classfile, \
 59     BIN := $(BUILDTOOLS_OUTPUTDIR)/create_symbols, \
 60     DISABLED_WARNINGS := options, \
 61     JAVAC_FLAGS := \
 62         $(INTERIM_LANGTOOLS_ARGS) \
 63         --patch-module java.base=$(BUILDTOOLS_OUTPUTDIR)/gensrc/java.base.interim \
 64         $(COMPILECREATESYMBOLS_ADD_EXPORTS), \
 65 ))
 66 
<a name="1" id="anc1"></a><span class="line-modified"> 67 $(SUPPORT_OUTPUTDIR)/symbols/ct.sym: \</span>
 68     $(COMPILE_CREATE_SYMBOLS) \
 69     $(wildcard $(TOPDIR)/make/data/symbols/*) \
 70     $(MODULE_INFOS)
 71 	$(RM) -r $(@D)
 72 	$(MKDIR) -p $(@D)
 73 	$(ECHO) Creating ct.sym classes
<a name="2" id="anc2"></a>






 74 	$(JAVA_SMALL) $(INTERIM_LANGTOOLS_ARGS) \
 75 	    $(COMPILECREATESYMBOLS_ADD_EXPORTS) \
 76 	    -classpath $(BUILDTOOLS_OUTPUTDIR)/create_symbols \
 77 	    build.tools.symbolgenerator.TransitiveDependencies \
<a name="3" id="anc3"></a><span class="line-modified"> 78 	    $(@D)/system-modules \</span>
 79 	    $(CT_MODULESOURCEPATH) \
 80 	    $(CT_MODULES)
<a name="4" id="anc4"></a><span class="line-added"> 81 	$(JAVA_SMALL) $(INTERIM_LANGTOOLS_ARGS) \</span>
<span class="line-added"> 82 	    $(COMPILECREATESYMBOLS_ADD_EXPORTS) \</span>
<span class="line-added"> 83 	    -classpath $(BUILDTOOLS_OUTPUTDIR)/create_symbols \</span>
<span class="line-added"> 84 	    build.tools.symbolgenerator.CreateSymbols \</span>
<span class="line-added"> 85 	    build-ctsym \</span>
<span class="line-added"> 86 	    $(CT_DATA_DESCRIPTION) \</span>
<span class="line-added"> 87 	    $(@D)/ct.sym \</span>
<span class="line-added"> 88 	    $(SOURCE_DATE_EPOCH) \</span>
<span class="line-added"> 89 	    $(JDK_SOURCE_TARGET_VERSION) \</span>
<span class="line-added"> 90 	    $(@D)/system-modules</span>
 91 	$(TOUCH) $@
 92 
<a name="5" id="anc5"></a>








 93 # Copy ct.sym to the modules libs dir
 94 $(eval $(call SetupCopyFiles, COPY_TO_LIBS, \
 95     FILES := $(SUPPORT_OUTPUTDIR)/symbols/ct.sym, \
 96     DEST := $(SUPPORT_OUTPUTDIR)/modules_libs/jdk.compiler, \
 97 ))
 98 
<a name="6" id="anc6"></a><span class="line-modified"> 99 TARGETS += $(COPY_TO_LIBS)</span>
100 
101 ################################################################################
<a name="7" id="anc7"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="7" type="hidden" />
</body>
</html>