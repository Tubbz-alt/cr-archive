<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff make/Main.gmk</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
<body>
<center><a href="Images.gmk.cdiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="MainSupport.gmk.cdiff.html" target="_top">next &gt;</a></center>    <h2>make/Main.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 150,22 ***</span>
  $(eval $(call DeclareRecipesForPhase, GENDATA, \
      TARGET_SUFFIX := gendata, \
      FILE_PREFIX := Gendata, \
      MAKE_SUBDIR := gendata, \
      CHECK_MODULES := $(ALL_MODULES), \
<span class="line-modified">!     USE_WRAPPER := true))</span>
  
  ALL_TARGETS += $(GENDATA_TARGETS)
  
  ################################################################################
  # Copy files targets
  $(eval $(call DeclareRecipesForPhase, COPY, \
      TARGET_SUFFIX := copy, \
      FILE_PREFIX := Copy, \
      MAKE_SUBDIR := copy, \
      CHECK_MODULES := $(ALL_MODULES), \
<span class="line-removed">-     USE_WRAPPER := true, \</span>
  ))
  
  ALL_COPY_MODULES += $(COPY_MODULES)
  ALL_COPY_TARGETS += $(COPY_TARGETS)
  
<span class="line-new-header">--- 150,21 ---</span>
  $(eval $(call DeclareRecipesForPhase, GENDATA, \
      TARGET_SUFFIX := gendata, \
      FILE_PREFIX := Gendata, \
      MAKE_SUBDIR := gendata, \
      CHECK_MODULES := $(ALL_MODULES), \
<span class="line-modified">! ))</span>
  
  ALL_TARGETS += $(GENDATA_TARGETS)
  
  ################################################################################
  # Copy files targets
  $(eval $(call DeclareRecipesForPhase, COPY, \
      TARGET_SUFFIX := copy, \
      FILE_PREFIX := Copy, \
      MAKE_SUBDIR := copy, \
      CHECK_MODULES := $(ALL_MODULES), \
  ))
  
  ALL_COPY_MODULES += $(COPY_MODULES)
  ALL_COPY_TARGETS += $(COPY_TARGETS)
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 204,11 ***</span>
  $(eval $(call DeclareRecipesForPhase, LIBS, \
      TARGET_SUFFIX := libs, \
      FILE_PREFIX := Lib, \
      MAKE_SUBDIR := lib, \
      CHECK_MODULES := $(ALL_MODULES), \
<span class="line-modified">!     USE_WRAPPER := true))</span>
  
  ALL_TARGETS += $(LIBS_TARGETS)
  
  ################################################################################
  # Targets for compiling static versions of certain native libraries. These do
<span class="line-new-header">--- 203,11 ---</span>
  $(eval $(call DeclareRecipesForPhase, LIBS, \
      TARGET_SUFFIX := libs, \
      FILE_PREFIX := Lib, \
      MAKE_SUBDIR := lib, \
      CHECK_MODULES := $(ALL_MODULES), \
<span class="line-modified">! ))</span>
  
  ALL_TARGETS += $(LIBS_TARGETS)
  
  ################################################################################
  # Targets for compiling static versions of certain native libraries. These do
</pre>
<hr />
<pre>
<span class="line-old-header">*** 217,11 ***</span>
  $(eval $(call DeclareRecipesForPhase, STATIC_LIBS, \
      TARGET_SUFFIX := static-libs, \
      FILE_PREFIX := Lib, \
      MAKE_SUBDIR := lib, \
      CHECK_MODULES := $(STATIC_LIBS_MODULES), \
<span class="line-removed">-     USE_WRAPPER := true, \</span>
      EXTRA_ARGS := STATIC_LIBS=true, \
  ))
  
  ALL_TARGETS += $(STATIC_LIBS_TARGETS)
  
<span class="line-new-header">--- 216,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 230,11 ***</span>
  $(eval $(call DeclareRecipesForPhase, LAUNCHER, \
      TARGET_SUFFIX := launchers, \
      FILE_PREFIX := Launcher, \
      MAKE_SUBDIR := launcher, \
      CHECK_MODULES := $(ALL_MODULES), \
<span class="line-modified">!     USE_WRAPPER := true))</span>
  
  ALL_TARGETS += $(LAUNCHER_TARGETS)
  
  ################################################################################
  # Build hotspot target
<span class="line-new-header">--- 228,11 ---</span>
  $(eval $(call DeclareRecipesForPhase, LAUNCHER, \
      TARGET_SUFFIX := launchers, \
      FILE_PREFIX := Launcher, \
      MAKE_SUBDIR := launcher, \
      CHECK_MODULES := $(ALL_MODULES), \
<span class="line-modified">! ))</span>
  
  ALL_TARGETS += $(LAUNCHER_TARGETS)
  
  ################################################################################
  # Build hotspot target
</pre>
<hr />
<pre>
<span class="line-old-header">*** 259,12 ***</span>
  endef
  
  $(foreach v, $(JVM_VARIANTS), $(eval $(call DeclareHotspotLibsRecipe,$v)))
  
  $(eval $(call SetupTarget, hotspot-ide-project, \
<span class="line-modified">!     MAKEFILE := ide/CreateVSProject, \</span>
      DEPS := hotspot exploded-image, \
  ))
  
  ALL_TARGETS += $(HOTSPOT_VARIANT_TARGETS) $(HOTSPOT_VARIANT_GENSRC_TARGETS) \
      $(HOTSPOT_VARIANT_LIBS_TARGETS)
  
<span class="line-new-header">--- 257,13 ---</span>
  endef
  
  $(foreach v, $(JVM_VARIANTS), $(eval $(call DeclareHotspotLibsRecipe,$v)))
  
  $(eval $(call SetupTarget, hotspot-ide-project, \
<span class="line-modified">!     MAKEFILE := ide/visualstudio/hotspot/CreateVSProject, \</span>
      DEPS := hotspot exploded-image, \
<span class="line-added">+     ARGS := -I$(TOPDIR)/make/hotspot, \</span>
  ))
  
  ALL_TARGETS += $(HOTSPOT_VARIANT_TARGETS) $(HOTSPOT_VARIANT_GENSRC_TARGETS) \
      $(HOTSPOT_VARIANT_LIBS_TARGETS)
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 299,29 ***</span>
  
  ################################################################################
  # VS Code projects
  
  $(eval $(call SetupTarget, vscode-project, \
<span class="line-modified">!     MAKEFILE := CreateVSCodeProject, \</span>
      ARGS := VSCODE_INDEXER=cpptools, \
      DEPS := compile-commands, \
  ))
  
  $(eval $(call SetupTarget, vscode-project-clangd, \
<span class="line-modified">!     MAKEFILE := CreateVSCodeProject, \</span>
      ARGS := VSCODE_INDEXER=clangd, \
      DEPS := compile-commands, \
  ))
  
  $(eval $(call SetupTarget, vscode-project-rtags, \
<span class="line-modified">!     MAKEFILE := CreateVSCodeProject, \</span>
      ARGS := VSCODE_INDEXER=rtags, \
      DEPS := compile-commands, \
  ))
  
  $(eval $(call SetupTarget, vscode-project-ccls, \
<span class="line-modified">!     MAKEFILE := CreateVSCodeProject, \</span>
      ARGS := VSCODE_INDEXER=ccls, \
      DEPS := compile-commands, \
  ))
  
  ################################################################################
<span class="line-new-header">--- 298,29 ---</span>
  
  ################################################################################
  # VS Code projects
  
  $(eval $(call SetupTarget, vscode-project, \
<span class="line-modified">!     MAKEFILE := ide/vscode/hotspot/CreateVSCodeProject, \</span>
      ARGS := VSCODE_INDEXER=cpptools, \
      DEPS := compile-commands, \
  ))
  
  $(eval $(call SetupTarget, vscode-project-clangd, \
<span class="line-modified">!     MAKEFILE := ide/vscode/hotspot/CreateVSCodeProject, \</span>
      ARGS := VSCODE_INDEXER=clangd, \
      DEPS := compile-commands, \
  ))
  
  $(eval $(call SetupTarget, vscode-project-rtags, \
<span class="line-modified">!     MAKEFILE := ide/vscode/hotspot/CreateVSCodeProject, \</span>
      ARGS := VSCODE_INDEXER=rtags, \
      DEPS := compile-commands, \
  ))
  
  $(eval $(call SetupTarget, vscode-project-ccls, \
<span class="line-modified">!     MAKEFILE := ide/vscode/hotspot/CreateVSCodeProject, \</span>
      ARGS := VSCODE_INDEXER=ccls, \
      DEPS := compile-commands, \
  ))
  
  ################################################################################
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1099,20 ***</span>
  endif
  
  # This target builds the documentation image
  docs-image: docs-jdk
  
<span class="line-modified">! # If not already set, set the JVM specific targets to build the test image</span>
<span class="line-modified">! JVM_TEST_IMAGE_TARGETS ?= test-image-hotspot-jtreg-native test-image-hotspot-gtest</span>
  
<span class="line-modified">! ifeq ($(INCLUDE_GRAAL), true)</span>
<span class="line-modified">!   JVM_TEST_IMAGE_TARGETS += test-image-hotspot-jtreg-graal</span>
<span class="line-modified">! endif</span>
  
<span class="line-modified">! # This target builds the test image</span>
<span class="line-modified">! test-image: prepare-test-image test-image-jdk-jtreg-native \</span>
<span class="line-modified">!     test-image-demos-jdk $(JVM_TEST_IMAGE_TARGETS)</span>
  
  ifeq ($(BUILD_FAILURE_HANDLER), true)
    test-image: test-image-failure-handler
  endif
  
<span class="line-new-header">--- 1098,27 ---</span>
  endif
  
  # This target builds the documentation image
  docs-image: docs-jdk
  
<span class="line-modified">! # This target builds the test image</span>
<span class="line-modified">! test-image: prepare-test-image test-image-jdk-jtreg-native test-image-demos-jdk</span>
  
<span class="line-modified">! ifneq ($(JVM_TEST_IMAGE_TARGETS), )</span>
<span class="line-modified">!   # If JVM_TEST_IMAGE_TARGETS is externally defined, use it instead of the</span>
<span class="line-modified">!   # standard hotspot set of tests.</span>
<span class="line-added">+   test-image: $(JVM_TEST_IMAGE_TARGETS)</span>
<span class="line-added">+ else</span>
<span class="line-added">+   test-image: test-image-hotspot-jtreg-native</span>
<span class="line-added">+   ifeq ($(BUILD_GTEST), true)</span>
<span class="line-added">+     test-image: test-image-hotspot-gtest</span>
<span class="line-added">+   endif</span>
  
<span class="line-modified">!   ifeq ($(INCLUDE_GRAAL), true)</span>
<span class="line-modified">!     test-image: test-image-hotspot-jtreg-graal</span>
<span class="line-modified">!   endif</span>
<span class="line-added">+ endif</span>
  
  ifeq ($(BUILD_FAILURE_HANDLER), true)
    test-image: test-image-failure-handler
  endif
  
</pre>
<center><a href="Images.gmk.cdiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="MainSupport.gmk.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>