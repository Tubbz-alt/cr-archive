<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff make/autoconf/basic_windows.m4</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="basic_tools.m4.udiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="boot-jdk.m4.udiff.html" target="_top">next &gt;</a></center>    <h2>make/autoconf/basic_windows.m4</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -29,22 +29,34 @@</span>
    SRC_ROOT_LENGTH=`$THEPWDCMD -L|$WC -m`
    if test $SRC_ROOT_LENGTH -gt 100; then
      AC_MSG_ERROR([Your base path is too long. It is $SRC_ROOT_LENGTH characters long, but only 100 is supported])
    fi
  
<span class="udiff-line-added">+   AC_MSG_CHECKING([Windows version])</span>
<span class="udiff-line-added">+   # Additional [] needed to keep m4 from mangling shell constructs.</span>
<span class="udiff-line-added">+   [ WINDOWS_VERSION=`$CMD /c ver.exe | $EGREP -o &#39;([0-9]+\.)+[0-9]+&#39;` ]</span>
<span class="udiff-line-added">+   AC_MSG_RESULT([$WINDOWS_VERSION])</span>
<span class="udiff-line-added">+ </span>
    if test &quot;x$OPENJDK_BUILD_OS_ENV&quot; = &quot;xwindows.cygwin&quot;; then
      AC_MSG_CHECKING([cygwin release])
<span class="udiff-line-modified-removed">-     CYGWIN_VERSION=`$UNAME -r`</span>
<span class="udiff-line-modified-added">+     CYGWIN_RELEASE=`$UNAME -r`</span>
<span class="udiff-line-added">+     AC_MSG_RESULT([$CYGWIN_RELEASE])</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     AC_MSG_CHECKING([cygwin version])</span>
<span class="udiff-line-added">+     CYGWIN_VERSION=`$UNAME -v`</span>
      AC_MSG_RESULT([$CYGWIN_VERSION])
<span class="udiff-line-removed">-     WINDOWS_ENV_VENDOR=&#39;cygwin&#39;</span>
<span class="udiff-line-removed">-     WINDOWS_ENV_VERSION=&quot;$CYGWIN_VERSION&quot;</span>
  
<span class="udiff-line-modified-removed">-     CYGWIN_VERSION_OLD=`$ECHO $CYGWIN_VERSION | $GREP -e &#39;^1\.[0-6]&#39;`</span>
<span class="udiff-line-modified-added">+     # Additional [] needed to keep m4 from mangling shell constructs.</span>
<span class="udiff-line-added">+     [ CYGWIN_VERSION_OLD=`$ECHO $CYGWIN_RELEASE | $GREP -e &#39;^1\.[0-6]&#39;` ]</span>
      if test &quot;x$CYGWIN_VERSION_OLD&quot; != x; then
<span class="udiff-line-modified-removed">-       AC_MSG_NOTICE([Your cygwin is too old. You are running $CYGWIN_VERSION, but at least cygwin 1.7 is required. Please upgrade.])</span>
<span class="udiff-line-modified-added">+       AC_MSG_NOTICE([Your cygwin is too old. You are running $CYGWIN_RELEASE, but at least cygwin 1.7 is required. Please upgrade.])</span>
        AC_MSG_ERROR([Cannot continue])
      fi
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     WINDOWS_ENV_VENDOR=&#39;cygwin&#39;</span>
<span class="udiff-line-added">+     WINDOWS_ENV_VERSION=&quot;$CYGWIN_RELEASE, $CYGWIN_VERSION&quot;</span>
<span class="udiff-line-added">+ </span>
      if test &quot;x$CYGPATH&quot; = x; then
        AC_MSG_ERROR([Something is wrong with your cygwin installation since I cannot find cygpath.exe in your path])
      fi
      AC_MSG_CHECKING([cygwin root directory as unix-style path])
      # The cmd output ends with Windows line endings (CR/LF)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -57,27 +69,27 @@</span>
      if test &quot;x$test_cygdrive_prefix&quot; = x; then
        AC_MSG_ERROR([Your cygdrive prefix is not /cygdrive. This is currently not supported. Change with mount -c.])
      fi
    elif test &quot;x$OPENJDK_BUILD_OS_ENV&quot; = &quot;xwindows.msys&quot;; then
      AC_MSG_CHECKING([msys release])
<span class="udiff-line-modified-removed">-     MSYS_VERSION=`$UNAME -r`</span>
<span class="udiff-line-modified-added">+     MSYS_RELEASE=`$UNAME -r`</span>
<span class="udiff-line-added">+     AC_MSG_RESULT([$MSYS_RELEASE])</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     AC_MSG_CHECKING([msys version])</span>
<span class="udiff-line-added">+     MSYS_VERSION=`$UNAME -v`</span>
      AC_MSG_RESULT([$MSYS_VERSION])
  
      WINDOWS_ENV_VENDOR=&#39;msys&#39;
<span class="udiff-line-modified-removed">-     WINDOWS_ENV_VERSION=&quot;$MSYS_VERSION&quot;</span>
<span class="udiff-line-modified-added">+     WINDOWS_ENV_VERSION=&quot;$MSYS_RELEASE, $MSYS_VERSION&quot;</span>
  
      AC_MSG_CHECKING([msys root directory as unix-style path])
      # The cmd output ends with Windows line endings (CR/LF), the grep command will strip that away
      MSYS_ROOT_PATH=`cd / ; cmd /c cd | $GREP &quot;.*&quot;`
      UTIL_REWRITE_AS_UNIX_PATH(MSYS_ROOT_PATH)
      AC_MSG_RESULT([$MSYS_ROOT_PATH])
      WINDOWS_ENV_ROOT_PATH=&quot;$MSYS_ROOT_PATH&quot;
    elif test &quot;x$OPENJDK_BUILD_OS_ENV&quot; = &quot;xwindows.wsl&quot;; then
<span class="udiff-line-removed">-     AC_MSG_CHECKING([Windows version])</span>
<span class="udiff-line-removed">-     # m4 replaces [ and ] so we use @&lt;:@ and @:&gt;@ instead</span>
<span class="udiff-line-removed">-     WINDOWS_VERSION=`$CMD /c ver.exe | $EGREP -o &#39;(@&lt;:@0-9@:&gt;@+\.)+@&lt;:@0-9@:&gt;@+&#39;`</span>
<span class="udiff-line-removed">-     AC_MSG_RESULT([$WINDOWS_VERSION])</span>
  
      AC_MSG_CHECKING([WSL kernel version])
      WSL_KERNEL_VERSION=`$UNAME -v`
      AC_MSG_RESULT([$WSL_KERNEL_VERSION])
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -87,12 +99,12 @@</span>
  
      AC_MSG_CHECKING([WSL distribution])
      WSL_DISTRIBUTION=`$LSB_RELEASE -d | sed &#39;s/Description:\t//&#39;`
      AC_MSG_RESULT([$WSL_DISTRIBUTION])
  
<span class="udiff-line-modified-removed">-     WINDOWS_ENV_VENDOR=&#39;WSL&#39;</span>
<span class="udiff-line-modified-removed">-     WINDOWS_ENV_VERSION=&quot;$WSL_DISTRIBUTION $WSL_KERNEL_VERSION $WSL_KERNEL_RELEASE (on Windows build $WINDOWS_VERSION)&quot;</span>
<span class="udiff-line-modified-added">+     WINDOWS_ENV_VENDOR=&#39;wsl&#39;</span>
<span class="udiff-line-modified-added">+     WINDOWS_ENV_VERSION=&quot;$WSL_KERNEL_RELEASE, $WSL_KERNEL_VERSION ($WSL_DISTRIBUTION)&quot;</span>
    else
      AC_MSG_ERROR([Unknown Windows environment. Neither cygwin, msys, nor wsl was detected.])
    fi
  
    # Test if windows or unix (cygwin/msys) find is first in path.
</pre>
<center><a href="basic_tools.m4.udiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="boot-jdk.m4.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>