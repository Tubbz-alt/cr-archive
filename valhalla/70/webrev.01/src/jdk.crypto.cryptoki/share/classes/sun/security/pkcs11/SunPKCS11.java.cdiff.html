<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/jdk.crypto.cryptoki/share/classes/sun/security/pkcs11/SunPKCS11.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../jdk.compiler/share/classes/com/sun/tools/sjavac/options/OptionHelper.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../jdk.crypto.ec/share/classes/sun/security/ec/SunEC.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.crypto.cryptoki/share/classes/sun/security/pkcs11/SunPKCS11.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 43,10 ***</span>
<span class="line-new-header">--- 43,11 ---</span>
  import javax.security.auth.callback.TextOutputCallback;
  
  import sun.security.util.Debug;
  import sun.security.util.ResourcesMgr;
  import static sun.security.util.SecurityConstants.PROVIDER_VER;
<span class="line-added">+ import static sun.security.util.SecurityProviderConstants.getAliases;</span>
  
  import sun.security.pkcs11.Secmod.*;
  
  import sun.security.pkcs11.wrapper.*;
  import static sun.security.pkcs11.wrapper.PKCS11Constants.*;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 403,23 ***</span>
  
      public int hashCode() {
          return System.identityHashCode(this);
      }
  
<span class="line-removed">-     private static String[] s(String ...aliases) {</span>
<span class="line-removed">-         return aliases;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      private static final class Descriptor {
          final String type;
          final String algorithm;
          final String className;
<span class="line-modified">!         final String[] aliases;</span>
          final int[] mechanisms;
  
          private Descriptor(String type, String algorithm, String className,
<span class="line-modified">!                 String[] aliases, int[] mechanisms) {</span>
              this.type = type;
              this.algorithm = algorithm;
              this.className = className;
              this.aliases = aliases;
              this.mechanisms = mechanisms;
<span class="line-new-header">--- 404,19 ---</span>
  
      public int hashCode() {
          return System.identityHashCode(this);
      }
  
      private static final class Descriptor {
          final String type;
          final String algorithm;
          final String className;
<span class="line-modified">!         final List&lt;String&gt; aliases;</span>
          final int[] mechanisms;
  
          private Descriptor(String type, String algorithm, String className,
<span class="line-modified">!                 List&lt;String&gt; aliases, int[] mechanisms) {</span>
              this.type = type;
              this.algorithm = algorithm;
              this.className = className;
              this.aliases = aliases;
              this.mechanisms = mechanisms;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 458,14 ***</span>
              int[] m) {
          register(new Descriptor(type, algorithm, className, null, m));
      }
  
      private static void d(String type, String algorithm, String className,
<span class="line-modified">!             String[] aliases, int[] m) {</span>
          register(new Descriptor(type, algorithm, className, aliases, m));
      }
  
      private static void register(Descriptor d) {
          for (int i = 0; i &lt; d.mechanisms.length; i++) {
              int m = d.mechanisms[i];
              Integer key = Integer.valueOf(m);
              List&lt;Descriptor&gt; list = descriptors.get(key);
<span class="line-new-header">--- 455,20 ---</span>
              int[] m) {
          register(new Descriptor(type, algorithm, className, null, m));
      }
  
      private static void d(String type, String algorithm, String className,
<span class="line-modified">!             List&lt;String&gt; aliases, int[] m) {</span>
          register(new Descriptor(type, algorithm, className, aliases, m));
      }
  
<span class="line-added">+     private static void dA(String type, String algorithm, String className,</span>
<span class="line-added">+             int[] m) {</span>
<span class="line-added">+         register(new Descriptor(type, algorithm, className,</span>
<span class="line-added">+                 getAliases(algorithm), m));</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      private static void register(Descriptor d) {
          for (int i = 0; i &lt; d.mechanisms.length; i++) {
              int m = d.mechanisms[i];
              Integer key = Integer.valueOf(m);
              List&lt;Descriptor&gt; list = descriptors.get(key);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 523,75 ***</span>
  
          d(MD, &quot;MD2&quot;,            P11Digest,
                  m(CKM_MD2));
          d(MD, &quot;MD5&quot;,            P11Digest,
                  m(CKM_MD5));
<span class="line-modified">!         d(MD, &quot;SHA1&quot;,           P11Digest,</span>
<span class="line-removed">-                 s(&quot;SHA&quot;, &quot;SHA-1&quot;, &quot;1.3.14.3.2.26&quot;, &quot;OID.1.3.14.3.2.26&quot;),</span>
                  m(CKM_SHA_1));
  
<span class="line-modified">!         d(MD, &quot;SHA-224&quot;,        P11Digest,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.2.4&quot;, &quot;OID.2.16.840.1.101.3.4.2.4&quot;),</span>
                  m(CKM_SHA224));
<span class="line-modified">!         d(MD, &quot;SHA-256&quot;,        P11Digest,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.2.1&quot;, &quot;OID.2.16.840.1.101.3.4.2.1&quot;),</span>
                  m(CKM_SHA256));
<span class="line-modified">!         d(MD, &quot;SHA-384&quot;,        P11Digest,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.2.2&quot;, &quot;OID.2.16.840.1.101.3.4.2.2&quot;),</span>
                  m(CKM_SHA384));
<span class="line-modified">!         d(MD, &quot;SHA-512&quot;,        P11Digest,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.2.3&quot;, &quot;OID.2.16.840.1.101.3.4.2.3&quot;),</span>
                  m(CKM_SHA512));
<span class="line-modified">!         d(MD, &quot;SHA-512/224&quot;,        P11Digest,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.2.5&quot;, &quot;OID.2.16.840.1.101.3.4.2.5&quot;),</span>
                  m(CKM_SHA512_224));
<span class="line-modified">!         d(MD, &quot;SHA-512/256&quot;,        P11Digest,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.2.6&quot;, &quot;OID.2.16.840.1.101.3.4.2.6&quot;),</span>
                  m(CKM_SHA512_256));
  
          d(MAC, &quot;HmacMD5&quot;,       P11MAC,
                  m(CKM_MD5_HMAC));
<span class="line-modified">!         d(MAC, &quot;HmacSHA1&quot;,      P11MAC,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.2.7&quot;, &quot;OID.1.2.840.113549.2.7&quot;),</span>
                  m(CKM_SHA_1_HMAC));
<span class="line-modified">!         d(MAC, &quot;HmacSHA224&quot;,    P11MAC,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.2.8&quot;, &quot;OID.1.2.840.113549.2.8&quot;),</span>
                  m(CKM_SHA224_HMAC));
<span class="line-modified">!         d(MAC, &quot;HmacSHA256&quot;,    P11MAC,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.2.9&quot;, &quot;OID.1.2.840.113549.2.9&quot;),</span>
                  m(CKM_SHA256_HMAC));
<span class="line-modified">!         d(MAC, &quot;HmacSHA384&quot;,    P11MAC,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.2.10&quot;, &quot;OID.1.2.840.113549.2.10&quot;),</span>
                  m(CKM_SHA384_HMAC));
<span class="line-modified">!         d(MAC, &quot;HmacSHA512&quot;,    P11MAC,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.2.11&quot;, &quot;OID.1.2.840.113549.2.11&quot;),</span>
                  m(CKM_SHA512_HMAC));
<span class="line-modified">!         d(MAC, &quot;HmacSHA512/224&quot;,    P11MAC,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.2.12&quot;, &quot;OID.1.2.840.113549.2.12&quot;),</span>
                  m(CKM_SHA512_224_HMAC));
<span class="line-modified">!         d(MAC, &quot;HmacSHA512/256&quot;,    P11MAC,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.2.13&quot;, &quot;OID.1.2.840.113549.2.13&quot;),</span>
                  m(CKM_SHA512_256_HMAC));
  
          d(MAC, &quot;SslMacMD5&quot;,     P11MAC,
                  m(CKM_SSL3_MD5_MAC));
          d(MAC, &quot;SslMacSHA1&quot;,    P11MAC,
                  m(CKM_SSL3_SHA1_MAC));
  
          d(KPG, &quot;RSA&quot;,           P11KeyPairGenerator,
<span class="line-modified">!                 s(&quot;1.2.840.113549.1.1&quot;, &quot;OID.1.2.840.113549.1.1&quot;),</span>
                  m(CKM_RSA_PKCS_KEY_PAIR_GEN));
  
<span class="line-modified">!         d(KPG, &quot;DSA&quot;,           P11KeyPairGenerator,</span>
<span class="line-modified">!                 s(&quot;1.3.14.3.2.12&quot;, &quot;1.2.840.10040.4.1&quot;, &quot;OID.1.2.840.10040.4.1&quot;),</span>
                  m(CKM_DSA_KEY_PAIR_GEN));
<span class="line-modified">!         d(KPG, &quot;DH&quot;,            P11KeyPairGenerator,    s(&quot;DiffieHellman&quot;),</span>
                  m(CKM_DH_PKCS_KEY_PAIR_GEN));
          d(KPG, &quot;EC&quot;,            P11KeyPairGenerator,
                  m(CKM_EC_KEY_PAIR_GEN));
  
<span class="line-modified">!         d(KG,  &quot;ARCFOUR&quot;,       P11KeyGenerator,        s(&quot;RC4&quot;),</span>
                  m(CKM_RC4_KEY_GEN));
          d(KG,  &quot;DES&quot;,           P11KeyGenerator,
                  m(CKM_DES_KEY_GEN));
          d(KG,  &quot;DESede&quot;,        P11KeyGenerator,
                  m(CKM_DES3_KEY_GEN, CKM_DES2_KEY_GEN));
<span class="line-new-header">--- 526,63 ---</span>
  
          d(MD, &quot;MD2&quot;,            P11Digest,
                  m(CKM_MD2));
          d(MD, &quot;MD5&quot;,            P11Digest,
                  m(CKM_MD5));
<span class="line-modified">!         dA(MD, &quot;SHA-1&quot;,           P11Digest,</span>
                  m(CKM_SHA_1));
  
<span class="line-modified">!         dA(MD, &quot;SHA-224&quot;,        P11Digest,</span>
                  m(CKM_SHA224));
<span class="line-modified">!         dA(MD, &quot;SHA-256&quot;,        P11Digest,</span>
                  m(CKM_SHA256));
<span class="line-modified">!         dA(MD, &quot;SHA-384&quot;,        P11Digest,</span>
                  m(CKM_SHA384));
<span class="line-modified">!         dA(MD, &quot;SHA-512&quot;,        P11Digest,</span>
                  m(CKM_SHA512));
<span class="line-modified">!         dA(MD, &quot;SHA-512/224&quot;,        P11Digest,</span>
                  m(CKM_SHA512_224));
<span class="line-modified">!         dA(MD, &quot;SHA-512/256&quot;,        P11Digest,</span>
                  m(CKM_SHA512_256));
  
          d(MAC, &quot;HmacMD5&quot;,       P11MAC,
                  m(CKM_MD5_HMAC));
<span class="line-modified">!         dA(MAC, &quot;HmacSHA1&quot;,      P11MAC,</span>
                  m(CKM_SHA_1_HMAC));
<span class="line-modified">!         dA(MAC, &quot;HmacSHA224&quot;,    P11MAC,</span>
                  m(CKM_SHA224_HMAC));
<span class="line-modified">!         dA(MAC, &quot;HmacSHA256&quot;,    P11MAC,</span>
                  m(CKM_SHA256_HMAC));
<span class="line-modified">!         dA(MAC, &quot;HmacSHA384&quot;,    P11MAC,</span>
                  m(CKM_SHA384_HMAC));
<span class="line-modified">!         dA(MAC, &quot;HmacSHA512&quot;,    P11MAC,</span>
                  m(CKM_SHA512_HMAC));
<span class="line-modified">!         dA(MAC, &quot;HmacSHA512/224&quot;,    P11MAC,</span>
                  m(CKM_SHA512_224_HMAC));
<span class="line-modified">!         dA(MAC, &quot;HmacSHA512/256&quot;,    P11MAC,</span>
                  m(CKM_SHA512_256_HMAC));
  
          d(MAC, &quot;SslMacMD5&quot;,     P11MAC,
                  m(CKM_SSL3_MD5_MAC));
          d(MAC, &quot;SslMacSHA1&quot;,    P11MAC,
                  m(CKM_SSL3_SHA1_MAC));
  
          d(KPG, &quot;RSA&quot;,           P11KeyPairGenerator,
<span class="line-modified">!                 getAliases(&quot;PKCS1&quot;),</span>
                  m(CKM_RSA_PKCS_KEY_PAIR_GEN));
  
<span class="line-modified">!         List&lt;String&gt; dhAlias = List.of(&quot;DiffieHellman&quot;);</span>
<span class="line-modified">! </span>
<span class="line-added">+         dA(KPG, &quot;DSA&quot;,           P11KeyPairGenerator,</span>
                  m(CKM_DSA_KEY_PAIR_GEN));
<span class="line-modified">!         d(KPG, &quot;DH&quot;,            P11KeyPairGenerator,</span>
<span class="line-added">+                 dhAlias,</span>
                  m(CKM_DH_PKCS_KEY_PAIR_GEN));
          d(KPG, &quot;EC&quot;,            P11KeyPairGenerator,
                  m(CKM_EC_KEY_PAIR_GEN));
  
<span class="line-modified">!         dA(KG,  &quot;ARCFOUR&quot;,       P11KeyGenerator,</span>
                  m(CKM_RC4_KEY_GEN));
          d(KG,  &quot;DES&quot;,           P11KeyGenerator,
                  m(CKM_DES_KEY_GEN));
          d(KG,  &quot;DESede&quot;,        P11KeyGenerator,
                  m(CKM_DES3_KEY_GEN, CKM_DES2_KEY_GEN));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 601,161 ***</span>
                  m(CKM_BLOWFISH_KEY_GEN));
  
          // register (Secret)KeyFactories if there are any mechanisms
          // for a particular algorithm that we support
          d(KF, &quot;RSA&quot;,            P11RSAKeyFactory,
<span class="line-modified">!                 s(&quot;1.2.840.113549.1.1&quot;, &quot;OID.1.2.840.113549.1.1&quot;),</span>
                  m(CKM_RSA_PKCS_KEY_PAIR_GEN, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         d(KF, &quot;DSA&quot;,            P11DSAKeyFactory,</span>
<span class="line-removed">-                 s(&quot;1.3.14.3.2.12&quot;, &quot;1.2.840.10040.4.1&quot;, &quot;OID.1.2.840.10040.4.1&quot;),</span>
                  m(CKM_DSA_KEY_PAIR_GEN, CKM_DSA, CKM_DSA_SHA1));
<span class="line-modified">!         d(KF, &quot;DH&quot;,             P11DHKeyFactory,        s(&quot;DiffieHellman&quot;),</span>
                  m(CKM_DH_PKCS_KEY_PAIR_GEN, CKM_DH_PKCS_DERIVE));
          d(KF, &quot;EC&quot;,             P11DHKeyFactory,
                  m(CKM_EC_KEY_PAIR_GEN, CKM_ECDH1_DERIVE,
                      CKM_ECDSA, CKM_ECDSA_SHA1));
  
          // AlgorithmParameters for EC.
          // Only needed until we have an EC implementation in the SUN provider.
<span class="line-modified">!         d(AGP, &quot;EC&quot;,            &quot;sun.security.util.ECParameters&quot;,</span>
<span class="line-removed">-                 s(&quot;1.2.840.10045.2.1&quot;),</span>
                  m(CKM_EC_KEY_PAIR_GEN, CKM_ECDH1_DERIVE,
                      CKM_ECDSA, CKM_ECDSA_SHA1));
  
  
          d(AGP, &quot;GCM&quot;,            &quot;sun.security.util.GCMParameters&quot;,
                  m(CKM_AES_GCM));
  
<span class="line-modified">!         d(KA, &quot;DH&quot;,             P11KeyAgreement,        s(&quot;DiffieHellman&quot;),</span>
                  m(CKM_DH_PKCS_DERIVE));
          d(KA, &quot;ECDH&quot;,           &quot;sun.security.pkcs11.P11ECDHKeyAgreement&quot;,
                  m(CKM_ECDH1_DERIVE));
  
<span class="line-modified">!         d(SKF, &quot;ARCFOUR&quot;,       P11SecretKeyFactory,    s(&quot;RC4&quot;),</span>
                  m(CKM_RC4));
          d(SKF, &quot;DES&quot;,           P11SecretKeyFactory,
                  m(CKM_DES_CBC));
          d(SKF, &quot;DESede&quot;,        P11SecretKeyFactory,
                  m(CKM_DES3_CBC));
<span class="line-modified">!         d(SKF, &quot;AES&quot;,           P11SecretKeyFactory,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.1&quot;, &quot;OID.2.16.840.1.101.3.4.1&quot;),</span>
                  m(CKM_AES_CBC));
          d(SKF, &quot;Blowfish&quot;,      P11SecretKeyFactory,
                  m(CKM_BLOWFISH_CBC));
  
          // XXX attributes for Ciphers (supported modes, padding)
<span class="line-modified">!         d(CIP, &quot;ARCFOUR&quot;,                       P11Cipher,      s(&quot;RC4&quot;),</span>
                  m(CKM_RC4));
          d(CIP, &quot;DES/CBC/NoPadding&quot;,             P11Cipher,
                  m(CKM_DES_CBC));
          d(CIP, &quot;DES/CBC/PKCS5Padding&quot;,          P11Cipher,
                  m(CKM_DES_CBC_PAD, CKM_DES_CBC));
          d(CIP, &quot;DES/ECB/NoPadding&quot;,             P11Cipher,
                  m(CKM_DES_ECB));
<span class="line-modified">!         d(CIP, &quot;DES/ECB/PKCS5Padding&quot;,          P11Cipher,      s(&quot;DES&quot;),</span>
                  m(CKM_DES_ECB));
  
          d(CIP, &quot;DESede/CBC/NoPadding&quot;,          P11Cipher,
                  m(CKM_DES3_CBC));
          d(CIP, &quot;DESede/CBC/PKCS5Padding&quot;,       P11Cipher,
                  m(CKM_DES3_CBC_PAD, CKM_DES3_CBC));
          d(CIP, &quot;DESede/ECB/NoPadding&quot;,          P11Cipher,
                  m(CKM_DES3_ECB));
<span class="line-modified">!         d(CIP, &quot;DESede/ECB/PKCS5Padding&quot;,       P11Cipher,      s(&quot;DESede&quot;),</span>
                  m(CKM_DES3_ECB));
          d(CIP, &quot;AES/CBC/NoPadding&quot;,             P11Cipher,
                  m(CKM_AES_CBC));
<span class="line-modified">!         d(CIP, &quot;AES_128/CBC/NoPadding&quot;,          P11Cipher,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.1.2&quot;, &quot;OID.2.16.840.1.101.3.4.1.2&quot;),</span>
                  m(CKM_AES_CBC));
<span class="line-modified">!         d(CIP, &quot;AES_192/CBC/NoPadding&quot;,          P11Cipher,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.1.22&quot;, &quot;OID.2.16.840.1.101.3.4.1.22&quot;),</span>
                  m(CKM_AES_CBC));
<span class="line-modified">!         d(CIP, &quot;AES_256/CBC/NoPadding&quot;,          P11Cipher,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.1.42&quot;, &quot;OID.2.16.840.1.101.3.4.1.42&quot;),</span>
                  m(CKM_AES_CBC));
          d(CIP, &quot;AES/CBC/PKCS5Padding&quot;,          P11Cipher,
                  m(CKM_AES_CBC_PAD, CKM_AES_CBC));
          d(CIP, &quot;AES/ECB/NoPadding&quot;,             P11Cipher,
                  m(CKM_AES_ECB));
<span class="line-modified">!         d(CIP, &quot;AES_128/ECB/NoPadding&quot;,          P11Cipher,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.1.1&quot;, &quot;OID.2.16.840.1.101.3.4.1.1&quot;),</span>
                  m(CKM_AES_ECB));
<span class="line-modified">!         d(CIP, &quot;AES_192/ECB/NoPadding&quot;,          P11Cipher,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.1.21&quot;, &quot;OID.2.16.840.1.101.3.4.1.21&quot;),</span>
                  m(CKM_AES_ECB));
<span class="line-modified">!         d(CIP, &quot;AES_256/ECB/NoPadding&quot;,          P11Cipher,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.1.41&quot;, &quot;OID.2.16.840.1.101.3.4.1.41&quot;),</span>
                  m(CKM_AES_ECB));
<span class="line-modified">!         d(CIP, &quot;AES/ECB/PKCS5Padding&quot;,          P11Cipher,      s(&quot;AES&quot;),</span>
                  m(CKM_AES_ECB));
          d(CIP, &quot;AES/CTR/NoPadding&quot;,             P11Cipher,
                  m(CKM_AES_CTR));
  
          d(CIP, &quot;AES/GCM/NoPadding&quot;,             P11AEADCipher,
                  m(CKM_AES_GCM));
<span class="line-modified">!         d(CIP, &quot;AES_128/GCM/NoPadding&quot;,          P11AEADCipher,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.1.6&quot;, &quot;OID.2.16.840.1.101.3.4.1.6&quot;),</span>
                  m(CKM_AES_GCM));
<span class="line-modified">!         d(CIP, &quot;AES_192/GCM/NoPadding&quot;,          P11AEADCipher,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.1.26&quot;, &quot;OID.2.16.840.1.101.3.4.1.26&quot;),</span>
                  m(CKM_AES_GCM));
<span class="line-modified">!         d(CIP, &quot;AES_256/GCM/NoPadding&quot;,          P11AEADCipher,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.1.46&quot;, &quot;OID.2.16.840.1.101.3.4.1.46&quot;),</span>
                  m(CKM_AES_GCM));
  
          d(CIP, &quot;Blowfish/CBC/NoPadding&quot;,        P11Cipher,
                  m(CKM_BLOWFISH_CBC));
          d(CIP, &quot;Blowfish/CBC/PKCS5Padding&quot;,     P11Cipher,
                  m(CKM_BLOWFISH_CBC));
  
<span class="line-modified">!         d(CIP, &quot;RSA/ECB/PKCS1Padding&quot;,          P11RSACipher,   s(&quot;RSA&quot;),</span>
                  m(CKM_RSA_PKCS));
          d(CIP, &quot;RSA/ECB/NoPadding&quot;,             P11RSACipher,
                  m(CKM_RSA_X_509));
  
<span class="line-modified">!         d(SIG, &quot;RawDSA&quot;,        P11Signature,   s(&quot;NONEwithDSA&quot;),</span>
                  m(CKM_DSA));
<span class="line-modified">!         d(SIG, &quot;DSA&quot;,           P11Signature,</span>
<span class="line-removed">-                 s(&quot;SHA1withDSA&quot;, &quot;1.3.14.3.2.13&quot;, &quot;1.3.14.3.2.27&quot;,</span>
<span class="line-removed">-                   &quot;1.2.840.10040.4.3&quot;, &quot;OID.1.2.840.10040.4.3&quot;),</span>
                  m(CKM_DSA_SHA1, CKM_DSA));
<span class="line-modified">!         d(SIG, &quot;SHA224withDSA&quot;, P11Signature,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.3.1&quot;, &quot;OID.2.16.840.1.101.3.4.3.1&quot;),</span>
                  m(CKM_DSA_SHA224));
<span class="line-modified">!         d(SIG, &quot;SHA256withDSA&quot;, P11Signature,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.3.2&quot;, &quot;OID.2.16.840.1.101.3.4.3.2&quot;),</span>
                  m(CKM_DSA_SHA256));
<span class="line-modified">!         d(SIG, &quot;SHA384withDSA&quot;, P11Signature,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.3.3&quot;, &quot;OID.2.16.840.1.101.3.4.3.3&quot;),</span>
                  m(CKM_DSA_SHA384));
<span class="line-modified">!         d(SIG, &quot;SHA512withDSA&quot;, P11Signature,</span>
<span class="line-removed">-                 s(&quot;2.16.840.1.101.3.4.3.4&quot;, &quot;OID.2.16.840.1.101.3.4.3.4&quot;),</span>
                  m(CKM_DSA_SHA512));
          d(SIG, &quot;RawDSAinP1363Format&quot;,   P11Signature,
<span class="line-modified">!                 s(&quot;NONEwithDSAinP1363Format&quot;),</span>
                  m(CKM_DSA));
          d(SIG, &quot;DSAinP1363Format&quot;,      P11Signature,
<span class="line-modified">!                 s(&quot;SHA1withDSAinP1363Format&quot;),</span>
                  m(CKM_DSA_SHA1, CKM_DSA));
  
          d(SIG, &quot;NONEwithECDSA&quot;, P11Signature,
                  m(CKM_ECDSA));
<span class="line-modified">!         d(SIG, &quot;SHA1withECDSA&quot;, P11Signature,</span>
<span class="line-removed">-                 s(&quot;ECDSA&quot;, &quot;1.2.840.10045.4.1&quot;, &quot;OID.1.2.840.10045.4.1&quot;),</span>
                  m(CKM_ECDSA_SHA1, CKM_ECDSA));
<span class="line-modified">!         d(SIG, &quot;SHA224withECDSA&quot;,       P11Signature,</span>
<span class="line-removed">-                 s(&quot;1.2.840.10045.4.3.1&quot;, &quot;OID.1.2.840.10045.4.3.1&quot;),</span>
                  m(CKM_ECDSA));
<span class="line-modified">!         d(SIG, &quot;SHA256withECDSA&quot;,       P11Signature,</span>
<span class="line-removed">-                 s(&quot;1.2.840.10045.4.3.2&quot;, &quot;OID.1.2.840.10045.4.3.2&quot;),</span>
                  m(CKM_ECDSA));
<span class="line-modified">!         d(SIG, &quot;SHA384withECDSA&quot;,       P11Signature,</span>
<span class="line-removed">-                 s(&quot;1.2.840.10045.4.3.3&quot;, &quot;OID.1.2.840.10045.4.3.3&quot;),</span>
                  m(CKM_ECDSA));
<span class="line-modified">!         d(SIG, &quot;SHA512withECDSA&quot;,       P11Signature,</span>
<span class="line-removed">-                 s(&quot;1.2.840.10045.4.3.4&quot;, &quot;OID.1.2.840.10045.4.3.4&quot;),</span>
                  m(CKM_ECDSA));
          d(SIG, &quot;NONEwithECDSAinP1363Format&quot;,   P11Signature,
                  m(CKM_ECDSA));
          d(SIG, &quot;SHA1withECDSAinP1363Format&quot;,   P11Signature,
                  m(CKM_ECDSA_SHA1, CKM_ECDSA));
<span class="line-new-header">--- 592,145 ---</span>
                  m(CKM_BLOWFISH_KEY_GEN));
  
          // register (Secret)KeyFactories if there are any mechanisms
          // for a particular algorithm that we support
          d(KF, &quot;RSA&quot;,            P11RSAKeyFactory,
<span class="line-modified">!                 getAliases(&quot;PKCS1&quot;),</span>
                  m(CKM_RSA_PKCS_KEY_PAIR_GEN, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         dA(KF, &quot;DSA&quot;,            P11DSAKeyFactory,</span>
                  m(CKM_DSA_KEY_PAIR_GEN, CKM_DSA, CKM_DSA_SHA1));
<span class="line-modified">!         d(KF, &quot;DH&quot;,             P11DHKeyFactory,</span>
<span class="line-added">+                 dhAlias,</span>
                  m(CKM_DH_PKCS_KEY_PAIR_GEN, CKM_DH_PKCS_DERIVE));
          d(KF, &quot;EC&quot;,             P11DHKeyFactory,
                  m(CKM_EC_KEY_PAIR_GEN, CKM_ECDH1_DERIVE,
                      CKM_ECDSA, CKM_ECDSA_SHA1));
  
          // AlgorithmParameters for EC.
          // Only needed until we have an EC implementation in the SUN provider.
<span class="line-modified">!         dA(AGP, &quot;EC&quot;,            &quot;sun.security.util.ECParameters&quot;,</span>
                  m(CKM_EC_KEY_PAIR_GEN, CKM_ECDH1_DERIVE,
                      CKM_ECDSA, CKM_ECDSA_SHA1));
  
  
          d(AGP, &quot;GCM&quot;,            &quot;sun.security.util.GCMParameters&quot;,
                  m(CKM_AES_GCM));
  
<span class="line-modified">!         d(KA, &quot;DH&quot;,             P11KeyAgreement,</span>
<span class="line-added">+                 dhAlias,</span>
                  m(CKM_DH_PKCS_DERIVE));
          d(KA, &quot;ECDH&quot;,           &quot;sun.security.pkcs11.P11ECDHKeyAgreement&quot;,
                  m(CKM_ECDH1_DERIVE));
  
<span class="line-modified">!         dA(SKF, &quot;ARCFOUR&quot;,       P11SecretKeyFactory,</span>
                  m(CKM_RC4));
          d(SKF, &quot;DES&quot;,           P11SecretKeyFactory,
                  m(CKM_DES_CBC));
          d(SKF, &quot;DESede&quot;,        P11SecretKeyFactory,
                  m(CKM_DES3_CBC));
<span class="line-modified">!         dA(SKF, &quot;AES&quot;,           P11SecretKeyFactory,</span>
                  m(CKM_AES_CBC));
          d(SKF, &quot;Blowfish&quot;,      P11SecretKeyFactory,
                  m(CKM_BLOWFISH_CBC));
  
          // XXX attributes for Ciphers (supported modes, padding)
<span class="line-modified">!         dA(CIP, &quot;ARCFOUR&quot;,                      P11Cipher,</span>
                  m(CKM_RC4));
          d(CIP, &quot;DES/CBC/NoPadding&quot;,             P11Cipher,
                  m(CKM_DES_CBC));
          d(CIP, &quot;DES/CBC/PKCS5Padding&quot;,          P11Cipher,
                  m(CKM_DES_CBC_PAD, CKM_DES_CBC));
          d(CIP, &quot;DES/ECB/NoPadding&quot;,             P11Cipher,
                  m(CKM_DES_ECB));
<span class="line-modified">!         d(CIP, &quot;DES/ECB/PKCS5Padding&quot;,          P11Cipher,</span>
<span class="line-added">+                 List.of(&quot;DES&quot;),</span>
                  m(CKM_DES_ECB));
  
          d(CIP, &quot;DESede/CBC/NoPadding&quot;,          P11Cipher,
                  m(CKM_DES3_CBC));
          d(CIP, &quot;DESede/CBC/PKCS5Padding&quot;,       P11Cipher,
                  m(CKM_DES3_CBC_PAD, CKM_DES3_CBC));
          d(CIP, &quot;DESede/ECB/NoPadding&quot;,          P11Cipher,
                  m(CKM_DES3_ECB));
<span class="line-modified">!         d(CIP, &quot;DESede/ECB/PKCS5Padding&quot;,       P11Cipher,</span>
<span class="line-added">+                 List.of(&quot;DESede&quot;),</span>
                  m(CKM_DES3_ECB));
          d(CIP, &quot;AES/CBC/NoPadding&quot;,             P11Cipher,
                  m(CKM_AES_CBC));
<span class="line-modified">!         dA(CIP, &quot;AES_128/CBC/NoPadding&quot;,          P11Cipher,</span>
                  m(CKM_AES_CBC));
<span class="line-modified">!         dA(CIP, &quot;AES_192/CBC/NoPadding&quot;,          P11Cipher,</span>
                  m(CKM_AES_CBC));
<span class="line-modified">!         dA(CIP, &quot;AES_256/CBC/NoPadding&quot;,          P11Cipher,</span>
                  m(CKM_AES_CBC));
          d(CIP, &quot;AES/CBC/PKCS5Padding&quot;,          P11Cipher,
                  m(CKM_AES_CBC_PAD, CKM_AES_CBC));
          d(CIP, &quot;AES/ECB/NoPadding&quot;,             P11Cipher,
                  m(CKM_AES_ECB));
<span class="line-modified">!         dA(CIP, &quot;AES_128/ECB/NoPadding&quot;,          P11Cipher,</span>
                  m(CKM_AES_ECB));
<span class="line-modified">!         dA(CIP, &quot;AES_192/ECB/NoPadding&quot;,          P11Cipher,</span>
                  m(CKM_AES_ECB));
<span class="line-modified">!         dA(CIP, &quot;AES_256/ECB/NoPadding&quot;,          P11Cipher,</span>
                  m(CKM_AES_ECB));
<span class="line-modified">!         d(CIP, &quot;AES/ECB/PKCS5Padding&quot;,          P11Cipher,</span>
<span class="line-added">+                 List.of(&quot;AES&quot;),</span>
                  m(CKM_AES_ECB));
          d(CIP, &quot;AES/CTR/NoPadding&quot;,             P11Cipher,
                  m(CKM_AES_CTR));
  
          d(CIP, &quot;AES/GCM/NoPadding&quot;,             P11AEADCipher,
                  m(CKM_AES_GCM));
<span class="line-modified">!         dA(CIP, &quot;AES_128/GCM/NoPadding&quot;,          P11AEADCipher,</span>
                  m(CKM_AES_GCM));
<span class="line-modified">!         dA(CIP, &quot;AES_192/GCM/NoPadding&quot;,          P11AEADCipher,</span>
                  m(CKM_AES_GCM));
<span class="line-modified">!         dA(CIP, &quot;AES_256/GCM/NoPadding&quot;,          P11AEADCipher,</span>
                  m(CKM_AES_GCM));
  
          d(CIP, &quot;Blowfish/CBC/NoPadding&quot;,        P11Cipher,
                  m(CKM_BLOWFISH_CBC));
          d(CIP, &quot;Blowfish/CBC/PKCS5Padding&quot;,     P11Cipher,
                  m(CKM_BLOWFISH_CBC));
  
<span class="line-modified">!         d(CIP, &quot;RSA/ECB/PKCS1Padding&quot;,          P11RSACipher,</span>
<span class="line-added">+                 List.of(&quot;RSA&quot;),</span>
                  m(CKM_RSA_PKCS));
          d(CIP, &quot;RSA/ECB/NoPadding&quot;,             P11RSACipher,
                  m(CKM_RSA_X_509));
  
<span class="line-modified">!         d(SIG, &quot;RawDSA&quot;,        P11Signature,</span>
<span class="line-added">+                 List.of(&quot;NONEwithDSA&quot;),</span>
                  m(CKM_DSA));
<span class="line-modified">!         dA(SIG, &quot;SHA1withDSA&quot;,           P11Signature,</span>
                  m(CKM_DSA_SHA1, CKM_DSA));
<span class="line-modified">!         dA(SIG, &quot;SHA224withDSA&quot;, P11Signature,</span>
                  m(CKM_DSA_SHA224));
<span class="line-modified">!         dA(SIG, &quot;SHA256withDSA&quot;, P11Signature,</span>
                  m(CKM_DSA_SHA256));
<span class="line-modified">!         dA(SIG, &quot;SHA384withDSA&quot;, P11Signature,</span>
                  m(CKM_DSA_SHA384));
<span class="line-modified">!         dA(SIG, &quot;SHA512withDSA&quot;, P11Signature,</span>
                  m(CKM_DSA_SHA512));
          d(SIG, &quot;RawDSAinP1363Format&quot;,   P11Signature,
<span class="line-modified">!                 List.of(&quot;NONEwithDSAinP1363Format&quot;),</span>
                  m(CKM_DSA));
          d(SIG, &quot;DSAinP1363Format&quot;,      P11Signature,
<span class="line-modified">!                 List.of(&quot;SHA1withDSAinP1363Format&quot;),</span>
                  m(CKM_DSA_SHA1, CKM_DSA));
  
          d(SIG, &quot;NONEwithECDSA&quot;, P11Signature,
                  m(CKM_ECDSA));
<span class="line-modified">!         dA(SIG, &quot;SHA1withECDSA&quot;, P11Signature,</span>
                  m(CKM_ECDSA_SHA1, CKM_ECDSA));
<span class="line-modified">!         dA(SIG, &quot;SHA224withECDSA&quot;,       P11Signature,</span>
                  m(CKM_ECDSA));
<span class="line-modified">!         dA(SIG, &quot;SHA256withECDSA&quot;,       P11Signature,</span>
                  m(CKM_ECDSA));
<span class="line-modified">!         dA(SIG, &quot;SHA384withECDSA&quot;,       P11Signature,</span>
                  m(CKM_ECDSA));
<span class="line-modified">!         dA(SIG, &quot;SHA512withECDSA&quot;,       P11Signature,</span>
                  m(CKM_ECDSA));
          d(SIG, &quot;NONEwithECDSAinP1363Format&quot;,   P11Signature,
                  m(CKM_ECDSA));
          d(SIG, &quot;SHA1withECDSAinP1363Format&quot;,   P11Signature,
                  m(CKM_ECDSA_SHA1, CKM_ECDSA));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 765,34 ***</span>
                  m(CKM_ECDSA));
          d(SIG, &quot;SHA384withECDSAinP1363Format&quot;, P11Signature,
                  m(CKM_ECDSA));
          d(SIG, &quot;SHA512withECDSAinP1363Format&quot;, P11Signature,
                  m(CKM_ECDSA));
<span class="line-modified">!         d(SIG, &quot;MD2withRSA&quot;,    P11Signature,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.1.1.2&quot;, &quot;OID.1.2.840.113549.1.1.2&quot;),</span>
                  m(CKM_MD2_RSA_PKCS, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         d(SIG, &quot;MD5withRSA&quot;,    P11Signature,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.1.1.4&quot;, &quot;OID.1.2.840.113549.1.1.4&quot;),</span>
                  m(CKM_MD5_RSA_PKCS, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         d(SIG, &quot;SHA1withRSA&quot;,   P11Signature,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.1.1.5&quot;, &quot;OID.1.2.840.113549.1.1.5&quot;,</span>
<span class="line-removed">-                   &quot;1.3.14.3.2.29&quot;),</span>
                  m(CKM_SHA1_RSA_PKCS, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         d(SIG, &quot;SHA224withRSA&quot;, P11Signature,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.1.1.14&quot;, &quot;OID.1.2.840.113549.1.1.14&quot;),</span>
                  m(CKM_SHA224_RSA_PKCS, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         d(SIG, &quot;SHA256withRSA&quot;, P11Signature,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.1.1.11&quot;, &quot;OID.1.2.840.113549.1.1.11&quot;),</span>
                  m(CKM_SHA256_RSA_PKCS, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         d(SIG, &quot;SHA384withRSA&quot;, P11Signature,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.1.1.12&quot;, &quot;OID.1.2.840.113549.1.1.12&quot;),</span>
                  m(CKM_SHA384_RSA_PKCS, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         d(SIG, &quot;SHA512withRSA&quot;, P11Signature,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.1.1.13&quot;, &quot;OID.1.2.840.113549.1.1.13&quot;),</span>
                  m(CKM_SHA512_RSA_PKCS, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         d(SIG, &quot;RSASSA-PSS&quot;, P11PSSSignature,</span>
<span class="line-removed">-                 s(&quot;1.2.840.113549.1.1.10&quot;, &quot;OID.1.2.840.113549.1.1.10&quot;),</span>
                  m(CKM_RSA_PKCS_PSS));
          d(SIG, &quot;SHA1withRSASSA-PSS&quot;, P11PSSSignature,
                  m(CKM_SHA1_RSA_PKCS_PSS));
          d(SIG, &quot;SHA224withRSASSA-PSS&quot;, P11PSSSignature,
                  m(CKM_SHA224_RSA_PKCS_PSS));
<span class="line-new-header">--- 740,25 ---</span>
                  m(CKM_ECDSA));
          d(SIG, &quot;SHA384withECDSAinP1363Format&quot;, P11Signature,
                  m(CKM_ECDSA));
          d(SIG, &quot;SHA512withECDSAinP1363Format&quot;, P11Signature,
                  m(CKM_ECDSA));
<span class="line-modified">!         dA(SIG, &quot;MD2withRSA&quot;,    P11Signature,</span>
                  m(CKM_MD2_RSA_PKCS, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         dA(SIG, &quot;MD5withRSA&quot;,    P11Signature,</span>
                  m(CKM_MD5_RSA_PKCS, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         dA(SIG, &quot;SHA1withRSA&quot;,   P11Signature,</span>
                  m(CKM_SHA1_RSA_PKCS, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         dA(SIG, &quot;SHA224withRSA&quot;, P11Signature,</span>
                  m(CKM_SHA224_RSA_PKCS, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         dA(SIG, &quot;SHA256withRSA&quot;, P11Signature,</span>
                  m(CKM_SHA256_RSA_PKCS, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         dA(SIG, &quot;SHA384withRSA&quot;, P11Signature,</span>
                  m(CKM_SHA384_RSA_PKCS, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         dA(SIG, &quot;SHA512withRSA&quot;, P11Signature,</span>
                  m(CKM_SHA512_RSA_PKCS, CKM_RSA_PKCS, CKM_RSA_X_509));
<span class="line-modified">!         dA(SIG, &quot;RSASSA-PSS&quot;, P11PSSSignature,</span>
                  m(CKM_RSA_PKCS_PSS));
          d(SIG, &quot;SHA1withRSASSA-PSS&quot;, P11PSSSignature,
                  m(CKM_SHA1_RSA_PKCS_PSS));
          d(SIG, &quot;SHA224withRSASSA-PSS&quot;, P11PSSSignature,
                  m(CKM_SHA224_RSA_PKCS_PSS));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 803,11 ***</span>
          d(SIG, &quot;SHA512withRSASSA-PSS&quot;, P11PSSSignature,
                  m(CKM_SHA512_RSA_PKCS_PSS));
  
          d(KG, &quot;SunTlsRsaPremasterSecret&quot;,
                      &quot;sun.security.pkcs11.P11TlsRsaPremasterSecretGenerator&quot;,
<span class="line-modified">!                     s(&quot;SunTls12RsaPremasterSecret&quot;),</span>
                  m(CKM_SSL3_PRE_MASTER_KEY_GEN, CKM_TLS_PRE_MASTER_KEY_GEN));
          d(KG, &quot;SunTlsMasterSecret&quot;,
                      &quot;sun.security.pkcs11.P11TlsMasterSecretGenerator&quot;,
                  m(CKM_SSL3_MASTER_KEY_DERIVE, CKM_TLS_MASTER_KEY_DERIVE,
                      CKM_SSL3_MASTER_KEY_DERIVE_DH,
<span class="line-new-header">--- 769,11 ---</span>
          d(SIG, &quot;SHA512withRSASSA-PSS&quot;, P11PSSSignature,
                  m(CKM_SHA512_RSA_PKCS_PSS));
  
          d(KG, &quot;SunTlsRsaPremasterSecret&quot;,
                      &quot;sun.security.pkcs11.P11TlsRsaPremasterSecretGenerator&quot;,
<span class="line-modified">!                 List.of(&quot;SunTls12RsaPremasterSecret&quot;),</span>
                  m(CKM_SSL3_PRE_MASTER_KEY_GEN, CKM_TLS_PRE_MASTER_KEY_GEN));
          d(KG, &quot;SunTlsMasterSecret&quot;,
                      &quot;sun.security.pkcs11.P11TlsMasterSecretGenerator&quot;,
                  m(CKM_SSL3_MASTER_KEY_DERIVE, CKM_TLS_MASTER_KEY_DERIVE,
                      CKM_SSL3_MASTER_KEY_DERIVE_DH,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1046,11 ***</span>
                          PCKM_SECURERANDOM));
                  }
                  if (config.isEnabled(PCKM_KEYSTORE)) {
                      putService(new P11Service(token, KS, &quot;PKCS11&quot;,
                          &quot;sun.security.pkcs11.P11KeyStore&quot;,
<span class="line-modified">!                         s(&quot;PKCS11-&quot; + config.getName()),</span>
                          PCKM_KEYSTORE));
                  }
                  return null;
              }
          });
<span class="line-new-header">--- 1012,11 ---</span>
                          PCKM_SECURERANDOM));
                  }
                  if (config.isEnabled(PCKM_KEYSTORE)) {
                      putService(new P11Service(token, KS, &quot;PKCS11&quot;,
                          &quot;sun.security.pkcs11.P11KeyStore&quot;,
<span class="line-modified">!                         List.of(&quot;PKCS11-&quot; + config.getName()),</span>
                          PCKM_KEYSTORE));
                  }
                  return null;
              }
          });
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1063,21 ***</span>
          private final Token token;
  
          private final long mechanism;
  
          P11Service(Token token, String type, String algorithm,
<span class="line-modified">!                 String className, String[] al, long mechanism) {</span>
<span class="line-modified">!             super(token.provider, type, algorithm, className, toList(al),</span>
                      type.equals(SR) ? Map.of(&quot;ThreadSafe&quot;, &quot;true&quot;) : null);
              this.token = token;
              this.mechanism = mechanism &amp; 0xFFFFFFFFL;
          }
  
<span class="line-removed">-         private static List&lt;String&gt; toList(String[] aliases) {</span>
<span class="line-removed">-             return (aliases == null) ? null : Arrays.asList(aliases);</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
          public Object newInstance(Object param)
                  throws NoSuchAlgorithmException {
              if (token.isValid() == false) {
                  throw new NoSuchAlgorithmException(&quot;Token has been removed&quot;);
              }
<span class="line-new-header">--- 1029,17 ---</span>
          private final Token token;
  
          private final long mechanism;
  
          P11Service(Token token, String type, String algorithm,
<span class="line-modified">!                 String className, List&lt;String&gt; al, long mechanism) {</span>
<span class="line-modified">!             super(token.provider, type, algorithm, className, al,</span>
                      type.equals(SR) ? Map.of(&quot;ThreadSafe&quot;, &quot;true&quot;) : null);
              this.token = token;
              this.mechanism = mechanism &amp; 0xFFFFFFFFL;
          }
  
          public Object newInstance(Object param)
                  throws NoSuchAlgorithmException {
              if (token.isValid() == false) {
                  throw new NoSuchAlgorithmException(&quot;Token has been removed&quot;);
              }
</pre>
<center><a href="../../../../../../jdk.compiler/share/classes/com/sun/tools/sjavac/options/OptionHelper.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../jdk.crypto.ec/share/classes/sun/security/ec/SunEC.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>