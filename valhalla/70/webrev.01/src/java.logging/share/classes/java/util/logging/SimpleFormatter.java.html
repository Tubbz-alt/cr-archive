<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/java.logging/share/classes/java/util/logging/SimpleFormatter.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 
 27 package java.util.logging;
 28 
 29 import java.io.*;
 30 import java.time.ZoneId;
 31 import java.time.ZonedDateTime;
 32 import jdk.internal.logger.SurrogateLogger;
 33 
 34 /**
 35  * Print a brief summary of the {@code LogRecord} in a human readable
 36  * format.  The summary will typically be 1 or 2 lines.
 37  *
 38  * &lt;p&gt;
 39  * &lt;a id=&quot;formatting&quot;&gt;
 40  * &lt;b&gt;Configuration:&lt;/b&gt;&lt;/a&gt;
 41  * The {@code SimpleFormatter} is initialized with the format string
 42  * specified in the {@systemProperty java.util.logging.SimpleFormatter.format}
 43  * property to {@linkplain #format(LogRecord) format} the log messages.
 44  * This property can be defined
 45  * in the {@linkplain LogManager#getProperty logging properties}
 46  * configuration file
 47  * or as a system property.  If this property is set in both
 48  * the logging properties and system properties,
 49  * the format string specified in the system property will be used.
 50  * If this property is not defined or the given format string
 51  * is {@linkplain java.util.IllegalFormatException illegal},
 52  * the default format is implementation-specific.
 53  *
 54  * @since 1.4
 55  * @see java.util.Formatter
 56  */
 57 
 58 public class SimpleFormatter extends Formatter {
 59 
 60     // format string for printing the log record
 61     static String getLoggingProperty(String name) {
 62         return LogManager.getLogManager().getProperty(name);
 63     }
 64 
 65     private final String format =
 66         SurrogateLogger.getSimpleFormat(SimpleFormatter::getLoggingProperty);
 67 
 68     /**
 69      * Format the given LogRecord.
 70      * &lt;p&gt;
 71      * The formatting can be customized by specifying the format string
 72      * in the &lt;a href=&quot;#formatting&quot;&gt;
 73      * {@code java.util.logging.SimpleFormatter.format}&lt;/a&gt; property.
 74      * The given {@code LogRecord} will be formatted as if by calling:
 75      * &lt;pre&gt;
 76      *    {@link String#format String.format}(format, date, source, logger, level, message, thrown);
 77      * &lt;/pre&gt;
 78      * where the arguments are:&lt;br&gt;
 79      * &lt;ol&gt;
 80      * &lt;li&gt;{@code format} - the {@link java.util.Formatter
 81      *     java.util.Formatter} format string specified in the
 82      *     {@code java.util.logging.SimpleFormatter.format} property
 83      *     or the default format.&lt;/li&gt;
 84      * &lt;li&gt;{@code date} - a {@link ZonedDateTime} object representing
 85      *     {@linkplain LogRecord#getInstant() event time} of the log record
 86      *      in the {@link ZoneId#systemDefault()} system time zone.&lt;/li&gt;
 87      * &lt;li&gt;{@code source} - a string representing the caller, if available;
 88      *     otherwise, the logger&#39;s name.&lt;/li&gt;
 89      * &lt;li&gt;{@code logger} - the logger&#39;s name.&lt;/li&gt;
 90      * &lt;li&gt;{@code level} - the {@linkplain Level#getLocalizedName
 91      *     log level}.&lt;/li&gt;
 92      * &lt;li&gt;{@code message} - the formatted log message
 93      *     returned from the {@link Formatter#formatMessage(LogRecord)}
 94      *     method.  It uses {@link java.text.MessageFormat java.text}
 95      *     formatting and does not use the {@code java.util.Formatter
 96      *     format} argument.&lt;/li&gt;
 97      * &lt;li&gt;{@code thrown} - a string representing
 98      *     the {@linkplain LogRecord#getThrown throwable}
 99      *     associated with the log record and its backtrace
100      *     beginning with a newline character, if any;
101      *     otherwise, an empty string.&lt;/li&gt;
102      * &lt;/ol&gt;
103      *
104      * &lt;p&gt;Some example formats:&lt;br&gt;
105      * &lt;ul&gt;
106      * &lt;li&gt; {@code java.util.logging.SimpleFormatter.format=&quot;%4$s: %5$s [%1$tc]%n&quot;}
107      *     &lt;p&gt;This prints 1 line with the log level ({@code 4$}),
108      *     the log message ({@code 5$}) and the timestamp ({@code 1$}) in
109      *     a square bracket.
110      *     &lt;pre&gt;
111      *     WARNING: warning message [Tue Mar 22 13:11:31 PDT 2011]
112      *     &lt;/pre&gt;&lt;/li&gt;
113      * &lt;li&gt; {@code java.util.logging.SimpleFormatter.format=&quot;%1$tc %2$s%n%4$s: %5$s%6$s%n&quot;}
114      *     &lt;p&gt;This prints 2 lines where the first line includes
115      *     the timestamp ({@code 1$}) and the source ({@code 2$});
116      *     the second line includes the log level ({@code 4$}) and
117      *     the log message ({@code 5$}) followed by the throwable
118      *     and its backtrace ({@code 6$}), if any:
119      *     &lt;pre&gt;
120      *     Tue Mar 22 13:11:31 PDT 2011 MyClass fatal
121      *     SEVERE: several message with an exception
122      *     java.lang.IllegalArgumentException: invalid argument
123      *             at MyClass.mash(MyClass.java:9)
124      *             at MyClass.crunch(MyClass.java:6)
125      *             at MyClass.main(MyClass.java:3)
126      *     &lt;/pre&gt;&lt;/li&gt;
127      * &lt;li&gt; {@code java.util.logging.SimpleFormatter.format=&quot;%1$tb %1$td, %1$tY %1$tl:%1$tM:%1$tS %1$Tp %2$s%n%4$s: %5$s%n&quot;}
128      *      &lt;p&gt;This prints 2 lines similar to the example above
129      *         with a different date/time formatting and does not print
130      *         the throwable and its backtrace:
131      *     &lt;pre&gt;
132      *     Mar 22, 2011 1:11:31 PM MyClass fatal
133      *     SEVERE: several message with an exception
134      *     &lt;/pre&gt;&lt;/li&gt;
135      * &lt;li&gt; {@code java.util.logging.SimpleFormatter.format=&quot;%1$tb %1$td, %1$tY %1$tl:%1$tM:%1$tS.%1$tN %1$Tp %2$s%n%4$s: %5$s%6$s%n&quot;}
136      *      &lt;p&gt;Since JDK 9, {@code java.util.logging} uses {@link
137      *         java.time.Clock#systemUTC() java.time} to create more precise time
138      *         stamps.
139      *         The format above can be used to add a {@code .%1$tN} to the
140      *         date/time formatting so that nanoseconds will also be printed:
141      *     &lt;pre&gt;
142      *     Feb 06, 2015 5:33:10.279216000 PM example.Main main
143      *     INFO: This is a test
144      *     &lt;/pre&gt;&lt;/li&gt;
145      * &lt;/ul&gt;
146      * &lt;p&gt;This method can also be overridden in a subclass.
147      * It is recommended to use the {@link Formatter#formatMessage}
148      * convenience method to localize and format the message field.
149      *
150      * @param record the log record to be formatted.
151      * @return a formatted log record
152      */
153     @Override
154     public String format(LogRecord record) {
155         ZonedDateTime zdt = ZonedDateTime.ofInstant(
156                 record.getInstant(), ZoneId.systemDefault());
157         String source;
158         if (record.getSourceClassName() != null) {
159             source = record.getSourceClassName();
160             if (record.getSourceMethodName() != null) {
161                source += &quot; &quot; + record.getSourceMethodName();
162             }
163         } else {
164             source = record.getLoggerName();
165         }
166         String message = formatMessage(record);
167         String throwable = &quot;&quot;;
168         if (record.getThrown() != null) {
169             StringWriter sw = new StringWriter();
170             PrintWriter pw = new PrintWriter(sw);
171             pw.println();
172             record.getThrown().printStackTrace(pw);
173             pw.close();
174             throwable = sw.toString();
175         }
176         return String.format(format,
177                              zdt,
178                              source,
179                              record.getLoggerName(),
180                              record.getLevel().getLocalizedLevelName(),
181                              message,
182                              throwable);
183     }
184 }
    </pre>
  </body>
</html>