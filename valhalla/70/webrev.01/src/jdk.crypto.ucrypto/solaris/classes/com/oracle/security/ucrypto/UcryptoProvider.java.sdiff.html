<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.crypto.ucrypto/solaris/classes/com/oracle/security/ucrypto/UcryptoProvider.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="UcryptoMech.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../jdk.incubator.jpackage/macosx/classes/jdk/incubator/jpackage/internal/MacBaseInstallerBundler.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.crypto.ucrypto/solaris/classes/com/oracle/security/ucrypto/UcryptoProvider.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2014, 2016, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package com.oracle.security.ucrypto;
 27 
 28 import java.io.IOException;
 29 import java.io.File;
 30 import java.lang.reflect.Constructor;
 31 import java.util.*;
 32 import java.security.*;
 33 import static sun.security.util.SecurityConstants.PROVIDER_VER;
 34 
<span class="line-removed"> 35 </span>
 36 /**
 37  * OracleUcrypto provider main class.
 38  *
 39  * @since 9
 40  */
 41 public final class UcryptoProvider extends Provider {
 42 
 43     private static final long serialVersionUID = 351251234302833L;
 44 
 45     private static boolean DEBUG = false;
 46     private static HashMap&lt;String, ServiceDesc&gt; provProp = null;
 47     private static String defConfigName = &quot;&quot;;
 48 
 49     static {
 50         try {
 51             // cannot use LoadLibraryAction because that would make the native
 52             // library available to the bootclassloader, but we run in the
 53             // platform classloader.
 54             provProp = AccessController.doPrivileged
 55                 (new PrivilegedAction&lt;&gt;() {
</pre>
<hr />
<pre>
117                         for (LibMDMech m : LibMDMech.values()) {
118                             ServiceDesc[] services = m.getServiceDescriptions();
119                             for (ServiceDesc entry : services) {
120                                 String sKey = entry.getType() + &quot;.&quot; + entry.getAlgorithm();
121                                 //  only register if none has been registered
122                                 provProp.putIfAbsent(sKey, entry);
123                             }
124                         }
125                     };
126                 } else {
127                     debug(&quot;Prov: unexpected ucrypto library loading error, got &quot; + result.length);
128                 }
129             }
130         } catch (AccessControlException ace) {
131             if (DEBUG) ace.printStackTrace();
132             // disable Ucrypto provider
133             provProp = null;
134         }
135     }
136 
<span class="line-modified">137     private static ServiceDesc sd(String type, String algo, String cn,</span>
<span class="line-modified">138         String... aliases) {</span>
<span class="line-removed">139         return new ServiceDesc(type, algo, cn, aliases);</span>
140     }
141 
142     private static final class ProviderService extends Provider.Service {
143         ProviderService(Provider p, ServiceDesc sd) {
144             super(p, sd.getType(), sd.getAlgorithm(), sd.getClassName(),
145                   sd.getAliases(), null);
146         }
147 
148         @SuppressWarnings(&quot;deprecation&quot;)
149         @Override
150         public Object newInstance(Object ctrParamObj)
151             throws NoSuchAlgorithmException {
152             String type = getType();
153             if (ctrParamObj != null) {
154                 throw new InvalidParameterException
155                     (&quot;constructorParameter not used with &quot; + type + &quot; engines&quot;);
156             }
157             String algo = getAlgorithm();
158             try {
159                 if (type.equals(&quot;Cipher&quot;)) {
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2014, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package com.oracle.security.ucrypto;
 27 
 28 import java.io.IOException;
 29 import java.io.File;
 30 import java.lang.reflect.Constructor;
 31 import java.util.*;
 32 import java.security.*;
 33 import static sun.security.util.SecurityConstants.PROVIDER_VER;
 34 

 35 /**
 36  * OracleUcrypto provider main class.
 37  *
 38  * @since 9
 39  */
 40 public final class UcryptoProvider extends Provider {
 41 
 42     private static final long serialVersionUID = 351251234302833L;
 43 
 44     private static boolean DEBUG = false;
 45     private static HashMap&lt;String, ServiceDesc&gt; provProp = null;
 46     private static String defConfigName = &quot;&quot;;
 47 
 48     static {
 49         try {
 50             // cannot use LoadLibraryAction because that would make the native
 51             // library available to the bootclassloader, but we run in the
 52             // platform classloader.
 53             provProp = AccessController.doPrivileged
 54                 (new PrivilegedAction&lt;&gt;() {
</pre>
<hr />
<pre>
116                         for (LibMDMech m : LibMDMech.values()) {
117                             ServiceDesc[] services = m.getServiceDescriptions();
118                             for (ServiceDesc entry : services) {
119                                 String sKey = entry.getType() + &quot;.&quot; + entry.getAlgorithm();
120                                 //  only register if none has been registered
121                                 provProp.putIfAbsent(sKey, entry);
122                             }
123                         }
124                     };
125                 } else {
126                     debug(&quot;Prov: unexpected ucrypto library loading error, got &quot; + result.length);
127                 }
128             }
129         } catch (AccessControlException ace) {
130             if (DEBUG) ace.printStackTrace();
131             // disable Ucrypto provider
132             provProp = null;
133         }
134     }
135 
<span class="line-modified">136     private static ServiceDesc sd(String type, String algo, String cn) {</span>
<span class="line-modified">137         return new ServiceDesc(type, algo, cn, null);</span>

138     }
139 
140     private static final class ProviderService extends Provider.Service {
141         ProviderService(Provider p, ServiceDesc sd) {
142             super(p, sd.getType(), sd.getAlgorithm(), sd.getClassName(),
143                   sd.getAliases(), null);
144         }
145 
146         @SuppressWarnings(&quot;deprecation&quot;)
147         @Override
148         public Object newInstance(Object ctrParamObj)
149             throws NoSuchAlgorithmException {
150             String type = getType();
151             if (ctrParamObj != null) {
152                 throw new InvalidParameterException
153                     (&quot;constructorParameter not used with &quot; + type + &quot; engines&quot;);
154             }
155             String algo = getAlgorithm();
156             try {
157                 if (type.equals(&quot;Cipher&quot;)) {
</pre>
</td>
</tr>
</table>
<center><a href="UcryptoMech.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../jdk.incubator.jpackage/macosx/classes/jdk/incubator/jpackage/internal/MacBaseInstallerBundler.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>