<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.crypto.mscapi/windows/classes/sun/security/mscapi/SunMSCAPI.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../jdk.crypto.ec/share/classes/sun/security/ec/point/ProjectivePoint.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../jdk.crypto.ucrypto/solaris/classes/com/oracle/security/ucrypto/LibMDMech.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.crypto.mscapi/windows/classes/sun/security/mscapi/SunMSCAPI.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2005, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package sun.security.mscapi;
 27 
 28 import java.security.AccessController;
 29 import java.security.PrivilegedAction;
 30 import java.security.Provider;
 31 import java.security.NoSuchAlgorithmException;
 32 import java.security.InvalidParameterException;
 33 import java.security.ProviderException;
 34 import java.util.HashMap;
<span class="line-modified"> 35 import java.util.Arrays;</span>
 36 
 37 import static sun.security.util.SecurityConstants.PROVIDER_VER;

 38 
 39 /**
 40  * A Cryptographic Service Provider for the Microsoft Crypto API.
 41  *
 42  * @since 1.6
 43  */
 44 
 45 public final class SunMSCAPI extends Provider {
 46 
 47     private static final long serialVersionUID = 8622598936488630849L; //TODO
 48 
 49     private static final String INFO = &quot;Sun&#39;s Microsoft Crypto API provider&quot;;
 50 
 51     static {
 52         AccessController.doPrivileged(new PrivilegedAction&lt;Void&gt;() {
 53             public Void run() {
 54                 System.loadLibrary(&quot;sunmscapi&quot;);
 55                 return null;
 56             }
 57         });
 58     }






 59 
<span class="line-modified"> 60     private static final class ProviderService extends Provider.Service {</span>
 61         ProviderService(Provider p, String type, String algo, String cn) {
 62             super(p, type, algo, cn, null, null);
 63         }
 64 
 65         ProviderService(Provider p, String type, String algo, String cn,
<span class="line-modified"> 66             String[] aliases, HashMap&lt;String, String&gt; attrs) {</span>
<span class="line-modified"> 67             super(p, type, algo, cn,</span>
<span class="line-removed"> 68                   (aliases == null? null : Arrays.asList(aliases)), attrs);</span>
 69         }
 70 
 71         @Override
 72         public Object newInstance(Object ctrParamObj)
 73             throws NoSuchAlgorithmException {
 74             String type = getType();
 75             if (ctrParamObj != null) {
 76                 throw new InvalidParameterException
 77                     (&quot;constructorParameter not used with &quot; + type +
 78                      &quot; engines&quot;);
 79             }
 80             String algo = getAlgorithm();
 81             try {
 82                 if (type.equals(&quot;SecureRandom&quot;)) {
 83                     if (algo.equals(&quot;Windows-PRNG&quot;)) {
 84                         return new PRNG();
 85                     }
 86                 } else if (type.equals(&quot;KeyStore&quot;)) {
 87                     if (algo.equals(&quot;Windows-MY&quot;)) {
 88                         return new CKeyStore.MY();
</pre>
<hr />
<pre>
159                            &quot;Windows-MY&quot;, &quot;sun.security.mscapi.CKeyStore$MY&quot;));
160                 putService(new ProviderService(p, &quot;KeyStore&quot;,
161                            &quot;Windows-ROOT&quot;, &quot;sun.security.mscapi.CKeyStore$ROOT&quot;));
162 
163                 /*
164                  * Signature engines
165                  */
166                 HashMap&lt;String, String&gt; attrs = new HashMap&lt;&gt;(1);
167                 attrs.put(&quot;SupportedKeyClasses&quot;, &quot;sun.security.mscapi.CKey&quot;);
168 
169                 // NONEwithRSA must be supplied with a pre-computed message digest.
170                 // Only the following digest algorithms are supported: MD5, SHA-1,
171                 // SHA-256, SHA-384, SHA-512 and a special-purpose digest
172                 // algorithm which is a concatenation of SHA-1 and MD5 digests.
173                 putService(new ProviderService(p, &quot;Signature&quot;,
174                            &quot;NONEwithRSA&quot;, &quot;sun.security.mscapi.CSignature$NONEwithRSA&quot;,
175                            null, attrs));
176                 putService(new ProviderService(p, &quot;Signature&quot;,
177                            &quot;SHA1withRSA&quot;, &quot;sun.security.mscapi.CSignature$SHA1withRSA&quot;,
178                            null, attrs));
<span class="line-modified">179                 putService(new ProviderService(p, &quot;Signature&quot;,</span>
<span class="line-modified">180                            &quot;SHA256withRSA&quot;, &quot;sun.security.mscapi.CSignature$SHA256withRSA&quot;,</span>
<span class="line-modified">181                            new String[] { &quot;1.2.840.113549.1.1.11&quot;, &quot;OID.1.2.840.113549.1.1.11&quot; },</span>
182                            attrs));
<span class="line-modified">183                 putService(new ProviderService(p, &quot;Signature&quot;,</span>
<span class="line-modified">184                            &quot;SHA384withRSA&quot;, &quot;sun.security.mscapi.CSignature$SHA384withRSA&quot;,</span>
<span class="line-modified">185                            new String[] { &quot;1.2.840.113549.1.1.12&quot;, &quot;OID.1.2.840.113549.1.1.12&quot; },</span>
186                            attrs));
<span class="line-modified">187                 putService(new ProviderService(p, &quot;Signature&quot;,</span>
<span class="line-modified">188                            &quot;SHA512withRSA&quot;, &quot;sun.security.mscapi.CSignature$SHA512withRSA&quot;,</span>
<span class="line-modified">189                            new String[] { &quot;1.2.840.113549.1.1.13&quot;, &quot;OID.1.2.840.113549.1.1.13&quot; },</span>



190                            attrs));
<span class="line-removed">191                 putService(new ProviderService(p, &quot;Signature&quot;,</span>
<span class="line-removed">192                         &quot;RSASSA-PSS&quot;, &quot;sun.security.mscapi.CSignature$PSS&quot;,</span>
<span class="line-removed">193                         new String[] { &quot;1.2.840.113549.1.1.10&quot;, &quot;OID.1.2.840.113549.1.1.10&quot; },</span>
<span class="line-removed">194                         attrs));</span>
195                 putService(new ProviderService(p, &quot;Signature&quot;,
196                            &quot;MD5withRSA&quot;, &quot;sun.security.mscapi.CSignature$MD5withRSA&quot;,
197                            null, attrs));
198                 putService(new ProviderService(p, &quot;Signature&quot;,
199                            &quot;MD2withRSA&quot;, &quot;sun.security.mscapi.CSignature$MD2withRSA&quot;,
200                            null, attrs));
<span class="line-modified">201                 putService(new ProviderService(p, &quot;Signature&quot;,</span>
<span class="line-modified">202                         &quot;SHA1withECDSA&quot;, &quot;sun.security.mscapi.CSignature$SHA1withECDSA&quot;,</span>
<span class="line-modified">203                         new String[] { &quot;1.2.840.10045.4.1&quot;, &quot;OID.1.2.840.10045.4.1&quot; },</span>
<span class="line-modified">204                         attrs));</span>
<span class="line-modified">205                 putService(new ProviderService(p, &quot;Signature&quot;,</span>
<span class="line-modified">206                         &quot;SHA224withECDSA&quot;, &quot;sun.security.mscapi.CSignature$SHA224withECDSA&quot;,</span>
<span class="line-modified">207                         new String[] { &quot;1.2.840.10045.4.3.1&quot;, &quot;OID.1.2.840.10045.4.3.1&quot;},</span>
<span class="line-modified">208                         attrs));</span>
<span class="line-modified">209                 putService(new ProviderService(p, &quot;Signature&quot;,</span>
<span class="line-modified">210                         &quot;SHA256withECDSA&quot;, &quot;sun.security.mscapi.CSignature$SHA256withECDSA&quot;,</span>
<span class="line-modified">211                         new String[] { &quot;1.2.840.10045.4.3.2&quot;, &quot;OID.1.2.840.10045.4.3.2&quot;},</span>
<span class="line-modified">212                         attrs));</span>
<span class="line-modified">213                 putService(new ProviderService(p, &quot;Signature&quot;,</span>
<span class="line-modified">214                         &quot;SHA384withECDSA&quot;, &quot;sun.security.mscapi.CSignature$SHA384withECDSA&quot;,</span>
<span class="line-modified">215                         new String[] { &quot;1.2.840.10045.4.3.3&quot;, &quot;OID.1.2.840.10045.4.3.3&quot;},</span>
<span class="line-modified">216                         attrs));</span>
<span class="line-modified">217                 putService(new ProviderService(p, &quot;Signature&quot;,</span>
<span class="line-modified">218                         &quot;SHA512withECDSA&quot;, &quot;sun.security.mscapi.CSignature$SHA512withECDSA&quot;,</span>
<span class="line-modified">219                         new String[] { &quot;1.2.840.10045.4.3.4&quot;, &quot;OID.1.2.840.10045.4.3.4&quot;},</span>
<span class="line-modified">220                         attrs));</span>
221                 /*
222                  * Key Pair Generator engines
223                  */
224                 attrs.clear();
225                 attrs.put(&quot;KeySize&quot;, &quot;16384&quot;);
226                 putService(new ProviderService(p, &quot;KeyPairGenerator&quot;,
227                            &quot;RSA&quot;, &quot;sun.security.mscapi.CKeyPairGenerator$RSA&quot;,
228                            null, attrs));
229 
230                 /*
231                  * Cipher engines
232                  */
233                 attrs.clear();
234                 attrs.put(&quot;SupportedModes&quot;, &quot;ECB&quot;);
235                 attrs.put(&quot;SupportedPaddings&quot;, &quot;PKCS1PADDING&quot;);
236                 attrs.put(&quot;SupportedKeyClasses&quot;, &quot;sun.security.mscapi.CKey&quot;);
237                 putService(new ProviderService(p, &quot;Cipher&quot;,
238                            &quot;RSA&quot;, &quot;sun.security.mscapi.CRSACipher&quot;,
239                            null, attrs));
240                 putService(new ProviderService(p, &quot;Cipher&quot;,
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2005, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package sun.security.mscapi;
 27 
 28 import java.security.AccessController;
 29 import java.security.PrivilegedAction;
 30 import java.security.Provider;
 31 import java.security.NoSuchAlgorithmException;
 32 import java.security.InvalidParameterException;
 33 import java.security.ProviderException;
 34 import java.util.HashMap;
<span class="line-modified"> 35 import java.util.List;</span>
 36 
 37 import static sun.security.util.SecurityConstants.PROVIDER_VER;
<span class="line-added"> 38 import static sun.security.util.SecurityProviderConstants.getAliases;</span>
 39 
 40 /**
 41  * A Cryptographic Service Provider for the Microsoft Crypto API.
 42  *
 43  * @since 1.6
 44  */
 45 
 46 public final class SunMSCAPI extends Provider {
 47 
 48     private static final long serialVersionUID = 8622598936488630849L; //TODO
 49 
 50     private static final String INFO = &quot;Sun&#39;s Microsoft Crypto API provider&quot;;
 51 
 52     static {
 53         AccessController.doPrivileged(new PrivilegedAction&lt;Void&gt;() {
 54             public Void run() {
 55                 System.loadLibrary(&quot;sunmscapi&quot;);
 56                 return null;
 57             }
 58         });
 59     }
<span class="line-added"> 60     private static class ProviderServiceA extends ProviderService {</span>
<span class="line-added"> 61         ProviderServiceA(Provider p, String type, String algo, String cn,</span>
<span class="line-added"> 62                 HashMap&lt;String, String&gt; attrs) {</span>
<span class="line-added"> 63             super(p, type, algo, cn, getAliases(algo), attrs);</span>
<span class="line-added"> 64         }</span>
<span class="line-added"> 65     }</span>
 66 
<span class="line-modified"> 67     private static class ProviderService extends Provider.Service {</span>
 68         ProviderService(Provider p, String type, String algo, String cn) {
 69             super(p, type, algo, cn, null, null);
 70         }
 71 
 72         ProviderService(Provider p, String type, String algo, String cn,
<span class="line-modified"> 73             List&lt;String&gt; aliases, HashMap&lt;String, String&gt; attrs) {</span>
<span class="line-modified"> 74             super(p, type, algo, cn, aliases, attrs);</span>

 75         }
 76 
 77         @Override
 78         public Object newInstance(Object ctrParamObj)
 79             throws NoSuchAlgorithmException {
 80             String type = getType();
 81             if (ctrParamObj != null) {
 82                 throw new InvalidParameterException
 83                     (&quot;constructorParameter not used with &quot; + type +
 84                      &quot; engines&quot;);
 85             }
 86             String algo = getAlgorithm();
 87             try {
 88                 if (type.equals(&quot;SecureRandom&quot;)) {
 89                     if (algo.equals(&quot;Windows-PRNG&quot;)) {
 90                         return new PRNG();
 91                     }
 92                 } else if (type.equals(&quot;KeyStore&quot;)) {
 93                     if (algo.equals(&quot;Windows-MY&quot;)) {
 94                         return new CKeyStore.MY();
</pre>
<hr />
<pre>
165                            &quot;Windows-MY&quot;, &quot;sun.security.mscapi.CKeyStore$MY&quot;));
166                 putService(new ProviderService(p, &quot;KeyStore&quot;,
167                            &quot;Windows-ROOT&quot;, &quot;sun.security.mscapi.CKeyStore$ROOT&quot;));
168 
169                 /*
170                  * Signature engines
171                  */
172                 HashMap&lt;String, String&gt; attrs = new HashMap&lt;&gt;(1);
173                 attrs.put(&quot;SupportedKeyClasses&quot;, &quot;sun.security.mscapi.CKey&quot;);
174 
175                 // NONEwithRSA must be supplied with a pre-computed message digest.
176                 // Only the following digest algorithms are supported: MD5, SHA-1,
177                 // SHA-256, SHA-384, SHA-512 and a special-purpose digest
178                 // algorithm which is a concatenation of SHA-1 and MD5 digests.
179                 putService(new ProviderService(p, &quot;Signature&quot;,
180                            &quot;NONEwithRSA&quot;, &quot;sun.security.mscapi.CSignature$NONEwithRSA&quot;,
181                            null, attrs));
182                 putService(new ProviderService(p, &quot;Signature&quot;,
183                            &quot;SHA1withRSA&quot;, &quot;sun.security.mscapi.CSignature$SHA1withRSA&quot;,
184                            null, attrs));
<span class="line-modified">185                 putService(new ProviderServiceA(p, &quot;Signature&quot;,</span>
<span class="line-modified">186                            &quot;SHA256withRSA&quot;,</span>
<span class="line-modified">187                            &quot;sun.security.mscapi.CSignature$SHA256withRSA&quot;,</span>
188                            attrs));
<span class="line-modified">189                 putService(new ProviderServiceA(p, &quot;Signature&quot;,</span>
<span class="line-modified">190                            &quot;SHA384withRSA&quot;,</span>
<span class="line-modified">191                            &quot;sun.security.mscapi.CSignature$SHA384withRSA&quot;,</span>
192                            attrs));
<span class="line-modified">193                 putService(new ProviderServiceA(p, &quot;Signature&quot;,</span>
<span class="line-modified">194                            &quot;SHA512withRSA&quot;,</span>
<span class="line-modified">195                            &quot;sun.security.mscapi.CSignature$SHA512withRSA&quot;,</span>
<span class="line-added">196                            attrs));</span>
<span class="line-added">197                 putService(new ProviderServiceA(p, &quot;Signature&quot;,</span>
<span class="line-added">198                            &quot;RSASSA-PSS&quot;, &quot;sun.security.mscapi.CSignature$PSS&quot;,</span>
199                            attrs));




200                 putService(new ProviderService(p, &quot;Signature&quot;,
201                            &quot;MD5withRSA&quot;, &quot;sun.security.mscapi.CSignature$MD5withRSA&quot;,
202                            null, attrs));
203                 putService(new ProviderService(p, &quot;Signature&quot;,
204                            &quot;MD2withRSA&quot;, &quot;sun.security.mscapi.CSignature$MD2withRSA&quot;,
205                            null, attrs));
<span class="line-modified">206                 putService(new ProviderServiceA(p, &quot;Signature&quot;,</span>
<span class="line-modified">207                            &quot;SHA1withECDSA&quot;,</span>
<span class="line-modified">208                            &quot;sun.security.mscapi.CSignature$SHA1withECDSA&quot;,</span>
<span class="line-modified">209                            attrs));</span>
<span class="line-modified">210                 putService(new ProviderServiceA(p, &quot;Signature&quot;,</span>
<span class="line-modified">211                            &quot;SHA224withECDSA&quot;,</span>
<span class="line-modified">212                            &quot;sun.security.mscapi.CSignature$SHA224withECDSA&quot;,</span>
<span class="line-modified">213                            attrs));</span>
<span class="line-modified">214                 putService(new ProviderServiceA(p, &quot;Signature&quot;,</span>
<span class="line-modified">215                            &quot;SHA256withECDSA&quot;,</span>
<span class="line-modified">216                            &quot;sun.security.mscapi.CSignature$SHA256withECDSA&quot;,</span>
<span class="line-modified">217                            attrs));</span>
<span class="line-modified">218                 putService(new ProviderServiceA(p, &quot;Signature&quot;,</span>
<span class="line-modified">219                            &quot;SHA384withECDSA&quot;,</span>
<span class="line-modified">220                            &quot;sun.security.mscapi.CSignature$SHA384withECDSA&quot;,</span>
<span class="line-modified">221                            attrs));</span>
<span class="line-modified">222                 putService(new ProviderServiceA(p, &quot;Signature&quot;,</span>
<span class="line-modified">223                            &quot;SHA512withECDSA&quot;,</span>
<span class="line-modified">224                            &quot;sun.security.mscapi.CSignature$SHA512withECDSA&quot;,</span>
<span class="line-modified">225                            attrs));</span>
226                 /*
227                  * Key Pair Generator engines
228                  */
229                 attrs.clear();
230                 attrs.put(&quot;KeySize&quot;, &quot;16384&quot;);
231                 putService(new ProviderService(p, &quot;KeyPairGenerator&quot;,
232                            &quot;RSA&quot;, &quot;sun.security.mscapi.CKeyPairGenerator$RSA&quot;,
233                            null, attrs));
234 
235                 /*
236                  * Cipher engines
237                  */
238                 attrs.clear();
239                 attrs.put(&quot;SupportedModes&quot;, &quot;ECB&quot;);
240                 attrs.put(&quot;SupportedPaddings&quot;, &quot;PKCS1PADDING&quot;);
241                 attrs.put(&quot;SupportedKeyClasses&quot;, &quot;sun.security.mscapi.CKey&quot;);
242                 putService(new ProviderService(p, &quot;Cipher&quot;,
243                            &quot;RSA&quot;, &quot;sun.security.mscapi.CRSACipher&quot;,
244                            null, attrs));
245                 putService(new ProviderService(p, &quot;Cipher&quot;,
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../jdk.crypto.ec/share/classes/sun/security/ec/point/ProjectivePoint.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../jdk.crypto.ucrypto/solaris/classes/com/oracle/security/ucrypto/LibMDMech.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>