<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/sun/security/x509/X509CRLEntryImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="X500Name.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="X509CRLImpl.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/x509/X509CRLEntryImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
235      * This method is the overridden implementation of the getRevocationReason
236      * method in X509CRLEntry. It is better performance-wise since it returns
237      * cached values.
238      */
239     @Override
240     public CRLReason getRevocationReason() {
241         Extension ext = getExtension(PKIXExtensions.ReasonCode_Id);
242         if (ext == null) {
243             return null;
244         }
245         CRLReasonCodeExtension rcExt = (CRLReasonCodeExtension) ext;
246         return rcExt.getReasonCode();
247     }
248 
249     /**
250      * This static method is the default implementation of the
251      * getRevocationReason method in X509CRLEntry.
252      */
253     public static CRLReason getRevocationReason(X509CRLEntry crlEntry) {
254         try {
<span class="line-modified">255             byte[] ext = crlEntry.getExtensionValue(&quot;2.5.29.21&quot;);</span>

256             if (ext == null) {
257                 return null;
258             }
259             DerValue val = new DerValue(ext);
260             byte[] data = val.getOctetString();
261 
262             CRLReasonCodeExtension rcExt =
263                 new CRLReasonCodeExtension(Boolean.FALSE, data);
264             return rcExt.getReasonCode();
265         } catch (IOException ioe) {
266             return null;
267         }
268     }
269 
270     /**
271      * get Reason Code from CRL entry.
272      *
273      * @return Integer or null, if no such extension
274      * @throws IOException on error
275      */
</pre>
<hr />
<pre>
385         }
386         return extSet;
387     }
388 
389     /**
390      * Gets the DER encoded OCTET string for the extension value
391      * (&lt;em&gt;extnValue&lt;/em&gt;) identified by the passed in oid String.
392      * The &lt;code&gt;oid&lt;/code&gt; string is
393      * represented by a set of positive whole number separated
394      * by &quot;.&quot;, that means,&lt;br&gt;
395      * &amp;lt;positive whole number&amp;gt;.&amp;lt;positive whole number&amp;gt;.&amp;lt;positive
396      * whole number&amp;gt;.&amp;lt;...&amp;gt;
397      *
398      * @param oid the Object Identifier value for the extension.
399      * @return the DER encoded octet string of the extension value.
400      */
401     public byte[] getExtensionValue(String oid) {
402         if (extensions == null)
403             return null;
404         try {
<span class="line-modified">405             String extAlias = OIDMap.getName(new ObjectIdentifier(oid));</span>
406             Extension crlExt = null;
407 
408             if (extAlias == null) { // may be unknown
<span class="line-modified">409                 ObjectIdentifier findOID = new ObjectIdentifier(oid);</span>
410                 Extension ex = null;
411                 ObjectIdentifier inCertOID;
412                 for (Enumeration&lt;Extension&gt; e = extensions.getElements();
413                                                  e.hasMoreElements();) {
414                     ex = e.nextElement();
415                     inCertOID = ex.getExtensionId();
416                     if (inCertOID.equals(findOID)) {
417                         crlExt = ex;
418                         break;
419                     }
420                 }
421             } else
422                 crlExt = extensions.get(extAlias);
423             if (crlExt == null)
424                 return null;
425             byte[] extData = crlExt.getExtensionValue();
426             if (extData == null)
427                 return null;
428 
429             DerOutputStream out = new DerOutputStream();
</pre>
</td>
<td>
<hr />
<pre>
235      * This method is the overridden implementation of the getRevocationReason
236      * method in X509CRLEntry. It is better performance-wise since it returns
237      * cached values.
238      */
239     @Override
240     public CRLReason getRevocationReason() {
241         Extension ext = getExtension(PKIXExtensions.ReasonCode_Id);
242         if (ext == null) {
243             return null;
244         }
245         CRLReasonCodeExtension rcExt = (CRLReasonCodeExtension) ext;
246         return rcExt.getReasonCode();
247     }
248 
249     /**
250      * This static method is the default implementation of the
251      * getRevocationReason method in X509CRLEntry.
252      */
253     public static CRLReason getRevocationReason(X509CRLEntry crlEntry) {
254         try {
<span class="line-modified">255             byte[] ext = crlEntry.getExtensionValue</span>
<span class="line-added">256                     (KnownOIDs.ReasonCode.value());</span>
257             if (ext == null) {
258                 return null;
259             }
260             DerValue val = new DerValue(ext);
261             byte[] data = val.getOctetString();
262 
263             CRLReasonCodeExtension rcExt =
264                 new CRLReasonCodeExtension(Boolean.FALSE, data);
265             return rcExt.getReasonCode();
266         } catch (IOException ioe) {
267             return null;
268         }
269     }
270 
271     /**
272      * get Reason Code from CRL entry.
273      *
274      * @return Integer or null, if no such extension
275      * @throws IOException on error
276      */
</pre>
<hr />
<pre>
386         }
387         return extSet;
388     }
389 
390     /**
391      * Gets the DER encoded OCTET string for the extension value
392      * (&lt;em&gt;extnValue&lt;/em&gt;) identified by the passed in oid String.
393      * The &lt;code&gt;oid&lt;/code&gt; string is
394      * represented by a set of positive whole number separated
395      * by &quot;.&quot;, that means,&lt;br&gt;
396      * &amp;lt;positive whole number&amp;gt;.&amp;lt;positive whole number&amp;gt;.&amp;lt;positive
397      * whole number&amp;gt;.&amp;lt;...&amp;gt;
398      *
399      * @param oid the Object Identifier value for the extension.
400      * @return the DER encoded octet string of the extension value.
401      */
402     public byte[] getExtensionValue(String oid) {
403         if (extensions == null)
404             return null;
405         try {
<span class="line-modified">406             String extAlias = OIDMap.getName(ObjectIdentifier.of(oid));</span>
407             Extension crlExt = null;
408 
409             if (extAlias == null) { // may be unknown
<span class="line-modified">410                 ObjectIdentifier findOID = ObjectIdentifier.of(oid);</span>
411                 Extension ex = null;
412                 ObjectIdentifier inCertOID;
413                 for (Enumeration&lt;Extension&gt; e = extensions.getElements();
414                                                  e.hasMoreElements();) {
415                     ex = e.nextElement();
416                     inCertOID = ex.getExtensionId();
417                     if (inCertOID.equals(findOID)) {
418                         crlExt = ex;
419                         break;
420                     }
421                 }
422             } else
423                 crlExt = extensions.get(extAlias);
424             if (crlExt == null)
425                 return null;
426             byte[] extData = crlExt.getExtensionValue();
427             if (extData == null)
428                 return null;
429 
430             DerOutputStream out = new DerOutputStream();
</pre>
</td>
</tr>
</table>
<center><a href="X500Name.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="X509CRLImpl.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>