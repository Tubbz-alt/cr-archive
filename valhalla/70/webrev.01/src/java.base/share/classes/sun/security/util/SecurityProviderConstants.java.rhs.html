<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.base/share/classes/sun/security/util/SecurityProviderConstants.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 2017, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package sun.security.util;
 27 
<a name="2" id="anc2"></a><span class="line-added"> 28 import java.util.*;</span>
<span class="line-added"> 29 import java.util.concurrent.ConcurrentHashMap;</span>
 30 import java.util.regex.PatternSyntaxException;
 31 import java.security.InvalidParameterException;
<a name="3" id="anc3"></a><span class="line-added"> 32 import java.security.ProviderException;</span>
 33 import sun.security.action.GetPropertyAction;
 34 
 35 /**
 36  * Various constants such as version number, default key length, used by
 37  * the JDK security/crypto providers.
 38  */
 39 public final class SecurityProviderConstants {
<a name="4" id="anc4"></a><span class="line-added"> 40     // Cannot create one of these</span>
<span class="line-added"> 41     private SecurityProviderConstants () {}</span>
<span class="line-added"> 42 </span>
 43     private static final Debug debug =
 44         Debug.getInstance(&quot;jca&quot;, &quot;ProviderConfig&quot;);
 45 
<a name="5" id="anc5"></a><span class="line-modified"> 46     // cache for provider aliases; key is the standard algorithm name</span>
<span class="line-modified"> 47     // value is the associated aliases List</span>
<span class="line-added"> 48     private static final ConcurrentHashMap&lt;String, List&lt;String&gt;&gt; aliasesMap;</span>
<span class="line-added"> 49 </span>
<span class="line-added"> 50     // utility method for generating aliases list using the supplied</span>
<span class="line-added"> 51     // &#39;oid&#39; and &#39;extraAliases&#39;, then store into &quot;aliasesMap&quot; cache under the</span>
<span class="line-added"> 52     // key &#39;stdName&#39;</span>
<span class="line-added"> 53     private static List&lt;String&gt; store(String stdName, KnownOIDs oid,</span>
<span class="line-added"> 54             String ... extraAliases) {</span>
<span class="line-added"> 55         List&lt;String&gt; value;</span>
<span class="line-added"> 56         if (oid == null &amp;&amp; extraAliases.length != 0) {</span>
<span class="line-added"> 57             value = List.of(extraAliases);</span>
<span class="line-added"> 58         } else {</span>
<span class="line-added"> 59             value = new ArrayList&lt;&gt;();</span>
<span class="line-added"> 60             if (oid != null) {</span>
<span class="line-added"> 61                 value.add(&quot;OID.&quot; + oid.value());</span>
<span class="line-added"> 62                 value.add(oid.value());</span>
<span class="line-added"> 63                 String[] knownAliases = oid.aliases();</span>
<span class="line-added"> 64                 if (knownAliases != null) {</span>
<span class="line-added"> 65                     for (String ka : knownAliases) {</span>
<span class="line-added"> 66                         value.add(ka);</span>
<span class="line-added"> 67                     }</span>
<span class="line-added"> 68                 }</span>
<span class="line-added"> 69             }</span>
<span class="line-added"> 70             for (String ea : extraAliases) {</span>
<span class="line-added"> 71                 value.add(ea);</span>
<span class="line-added"> 72             }</span>
<span class="line-added"> 73         }</span>
<span class="line-added"> 74         aliasesMap.put(stdName, value);</span>
<span class="line-added"> 75         return value;</span>
<span class="line-added"> 76     }</span>
<span class="line-added"> 77 </span>
<span class="line-added"> 78     // returns an aliases List for the specified algorithm name o</span>
<span class="line-added"> 79     // NOTE: exception is thrown if no aliases nor oid found, so</span>
<span class="line-added"> 80     // only call this method if aliases are expected</span>
<span class="line-added"> 81     public static List&lt;String&gt; getAliases(String o) {</span>
<span class="line-added"> 82         List&lt;String&gt; res = aliasesMap.get(o);</span>
<span class="line-added"> 83         if (res == null) {</span>
<span class="line-added"> 84             KnownOIDs e = KnownOIDs.findMatch(o);</span>
<span class="line-added"> 85             if (e != null) {</span>
<span class="line-added"> 86                 return store(o, e);</span>
<span class="line-added"> 87             }</span>
<span class="line-added"> 88             ProviderException pe =</span>
<span class="line-added"> 89                     new ProviderException(&quot;Cannot find aliases for &quot; + o);</span>
<span class="line-added"> 90             throw pe;</span>
<span class="line-added"> 91         }</span>
<span class="line-added"> 92         return res;</span>
 93     }
 94 
 95     public static final int getDefDSASubprimeSize(int primeSize) {
 96         if (primeSize &lt;= 1024) {
 97             return 160;
 98         } else if (primeSize == 2048) {
 99             return 224;
100         } else if (primeSize == 3072) {
101             return 256;
102         } else {
103             throw new InvalidParameterException(&quot;Invalid DSA Prime Size: &quot; +
104                 primeSize);
105         }
106     }
107 
108     public static final int DEF_DSA_KEY_SIZE;
109     public static final int DEF_RSA_KEY_SIZE;
110     public static final int DEF_RSASSA_PSS_KEY_SIZE;
111     public static final int DEF_DH_KEY_SIZE;
112     public static final int DEF_EC_KEY_SIZE;
<a name="6" id="anc6"></a><span class="line-added">113     public static final int DEF_ED_KEY_SIZE;</span>
114 
115     private static final String KEY_LENGTH_PROP =
116         &quot;jdk.security.defaultKeySize&quot;;
<a name="7" id="anc7"></a><span class="line-added">117 </span>
118     static {
119         String keyLengthStr = GetPropertyAction.privilegedGetProperty
120             (KEY_LENGTH_PROP);
121         int dsaKeySize = 2048;
122         int rsaKeySize = 2048;
123         int rsaSsaPssKeySize = rsaKeySize; // default to same value as RSA
124         int dhKeySize = 2048;
125         int ecKeySize = 256;
<a name="8" id="anc8"></a><span class="line-added">126         int edKeySize = 255;</span>
127 
128         if (keyLengthStr != null) {
129             try {
130                 String[] pairs = keyLengthStr.split(&quot;,&quot;);
131                 for (String p : pairs) {
132                     String[] algoAndValue = p.split(&quot;:&quot;);
133                     if (algoAndValue.length != 2) {
134                         // invalid pair, skip to next pair
135                         if (debug != null) {
136                             debug.println(&quot;Ignoring invalid pair in &quot; +
137                                 KEY_LENGTH_PROP + &quot; property: &quot; + p);
138                         }
139                         continue;
140                     }
141                     String algoName = algoAndValue[0].trim().toUpperCase();
142                     int value = -1;
143                     try {
144                         value = Integer.parseInt(algoAndValue[1].trim());
145                     } catch (NumberFormatException nfe) {
146                         // invalid value, skip to next pair
147                         if (debug != null) {
148                             debug.println(&quot;Ignoring invalid value in &quot; +
149                                 KEY_LENGTH_PROP + &quot; property: &quot; + p);
150                         }
151                         continue;
152                     }
153                     if (algoName.equals(&quot;DSA&quot;)) {
154                         dsaKeySize = value;
155                     } else if (algoName.equals(&quot;RSA&quot;)) {
156                         rsaKeySize = value;
157                     } else if (algoName.equals(&quot;RSASSA-PSS&quot;)) {
158                         rsaSsaPssKeySize = value;
159                     } else if (algoName.equals(&quot;DH&quot;)) {
160                         dhKeySize = value;
161                     } else if (algoName.equals(&quot;EC&quot;)) {
162                         ecKeySize = value;
<a name="9" id="anc9"></a><span class="line-added">163                     } else if (algoName.equalsIgnoreCase(&quot;EdDSA&quot;)) {</span>
<span class="line-added">164                         edKeySize = value;</span>
165                     } else {
166                         if (debug != null) {
167                             debug.println(&quot;Ignoring unsupported algo in &quot; +
168                                 KEY_LENGTH_PROP + &quot; property: &quot; + p);
169                         }
170                         continue;
171                     }
172                     if (debug != null) {
173                         debug.println(&quot;Overriding default &quot; + algoName +
174                             &quot; keysize with value from &quot; +
175                             KEY_LENGTH_PROP + &quot; property: &quot; + value);
176                     }
177                 }
178             } catch (PatternSyntaxException pse) {
179                 // if property syntax is not followed correctly
180                 if (debug != null) {
181                     debug.println(&quot;Unexpected exception while parsing &quot; +
182                         KEY_LENGTH_PROP + &quot; property: &quot; + pse);
183                 }
184             }
185         }
186         DEF_DSA_KEY_SIZE = dsaKeySize;
187         DEF_RSA_KEY_SIZE = rsaKeySize;
188         DEF_RSASSA_PSS_KEY_SIZE = rsaSsaPssKeySize;
189         DEF_DH_KEY_SIZE = dhKeySize;
190         DEF_EC_KEY_SIZE = ecKeySize;
<a name="10" id="anc10"></a><span class="line-added">191         DEF_ED_KEY_SIZE = edKeySize;</span>
<span class="line-added">192 </span>
<span class="line-added">193         // Set up aliases with default mappings</span>
<span class="line-added">194         // This is needed when the mapping contains non-oid</span>
<span class="line-added">195         // aliases</span>
<span class="line-added">196         aliasesMap = new ConcurrentHashMap&lt;&gt;();</span>
<span class="line-added">197 </span>
<span class="line-added">198         store(&quot;SHA1withDSA&quot;, KnownOIDs.SHA1withDSA,</span>
<span class="line-added">199                 KnownOIDs.OIW_JDK_SHA1withDSA.value(),</span>
<span class="line-added">200                 KnownOIDs.OIW_SHA1withDSA.value(),</span>
<span class="line-added">201                 &quot;DSA&quot;, &quot;SHA/DSA&quot;, &quot;SHA-1/DSA&quot;,</span>
<span class="line-added">202                 &quot;SHA1/DSA&quot;, &quot;SHAwithDSA&quot;, &quot;DSAWithSHA1&quot;);</span>
<span class="line-added">203 </span>
<span class="line-added">204         store(&quot;DSA&quot;, KnownOIDs.DSA, KnownOIDs.OIW_DSA.value());</span>
<span class="line-added">205 </span>
<span class="line-added">206         store(&quot;SHA1withRSA&quot;, KnownOIDs.SHA1withRSA,</span>
<span class="line-added">207                 KnownOIDs.OIW_SHA1withRSA.value());</span>
<span class="line-added">208 </span>
<span class="line-added">209         store(&quot;SHA-1&quot;, KnownOIDs.SHA_1);</span>
<span class="line-added">210 </span>
<span class="line-added">211         store(&quot;PBEWithMD5AndDES&quot;, KnownOIDs.PBEWithMD5AndDES, &quot;PBE&quot;);</span>
<span class="line-added">212 </span>
<span class="line-added">213         store(&quot;DiffieHellman&quot;, KnownOIDs.DiffieHellman);</span>
<span class="line-added">214 </span>
<span class="line-added">215         store(&quot;AES&quot;, KnownOIDs.AES, &quot;Rijndael&quot;);</span>
<span class="line-added">216 </span>
<span class="line-added">217         store(&quot;EC&quot;, KnownOIDs.EC, &quot;EllipticCurve&quot;);</span>
<span class="line-added">218 </span>
<span class="line-added">219         store(&quot;X.509&quot;, null, &quot;X509&quot;);</span>
<span class="line-added">220         store(&quot;NONEwithDSA&quot;, null, &quot;RawDSA&quot;);</span>
<span class="line-added">221         store(&quot;DESede&quot;, null, &quot;TripleDES&quot;);</span>
<span class="line-added">222         store(&quot;ARCFOUR&quot;, KnownOIDs.ARCFOUR);</span>
<span class="line-added">223         // For backward compatility, refer to PKCS1 mapping for RSA</span>
<span class="line-added">224         // KeyPairGenerator and KeyFactory</span>
<span class="line-added">225         store(&quot;PKCS1&quot;, KnownOIDs.PKCS1, KnownOIDs.RSA.value());</span>
226     }
227 }
<a name="11" id="anc11"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="11" type="hidden" />
</body>
</html>