<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/sun/security/provider/certpath/OCSPResponse.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../SunEntries.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="RevocationChecker.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/provider/certpath/OCSPResponse.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 133,22 ***</span>
      private static final ResponseStatus[] rsvalues = ResponseStatus.values();
  
      private static final Debug debug = Debug.getInstance(&quot;certpath&quot;);
      private static final boolean dump = debug != null &amp;&amp; Debug.isOn(&quot;ocsp&quot;);
      private static final ObjectIdentifier OCSP_BASIC_RESPONSE_OID =
<span class="line-modified">!         ObjectIdentifier.of(&quot;1.3.6.1.5.5.7.48.1.1&quot;);</span>
      private static final int CERT_STATUS_GOOD = 0;
      private static final int CERT_STATUS_REVOKED = 1;
      private static final int CERT_STATUS_UNKNOWN = 2;
  
      // ResponderID CHOICE tags
      private static final int NAME_TAG = 1;
      private static final int KEY_TAG = 2;
  
<span class="line-removed">-     // Object identifier for the OCSPSigning key purpose</span>
<span class="line-removed">-     private static final String KP_OCSP_SIGNING_OID = &quot;1.3.6.1.5.5.7.3.9&quot;;</span>
<span class="line-removed">- </span>
      // Default maximum clock skew in milliseconds (15 minutes)
      // allowed when checking validity of OCSP responses
      private static final int DEFAULT_MAX_CLOCK_SKEW = 900000;
  
      /**
<span class="line-new-header">--- 133,19 ---</span>
      private static final ResponseStatus[] rsvalues = ResponseStatus.values();
  
      private static final Debug debug = Debug.getInstance(&quot;certpath&quot;);
      private static final boolean dump = debug != null &amp;&amp; Debug.isOn(&quot;ocsp&quot;);
      private static final ObjectIdentifier OCSP_BASIC_RESPONSE_OID =
<span class="line-modified">!         ObjectIdentifier.of(KnownOIDs.OCSPBasicResponse);</span>
      private static final int CERT_STATUS_GOOD = 0;
      private static final int CERT_STATUS_REVOKED = 1;
      private static final int CERT_STATUS_UNKNOWN = 2;
  
      // ResponderID CHOICE tags
      private static final int NAME_TAG = 1;
      private static final int KEY_TAG = 2;
  
      // Default maximum clock skew in milliseconds (15 minutes)
      // allowed when checking validity of OCSP responses
      private static final int DEFAULT_MAX_CLOCK_SKEW = 900000;
  
      /**
</pre>
<hr />
<pre>
<span class="line-old-header">*** 491,11 ***</span>
  
                  // Check for the OCSPSigning key purpose
                  try {
                      List&lt;String&gt; keyPurposes = signerCert.getExtendedKeyUsage();
                      if (keyPurposes == null ||
<span class="line-modified">!                         !keyPurposes.contains(KP_OCSP_SIGNING_OID)) {</span>
                          throw new CertPathValidatorException(
                              &quot;Responder&#39;s certificate not valid for signing &quot; +
                              &quot;OCSP responses&quot;);
                      }
                  } catch (CertificateParsingException cpe) {
<span class="line-new-header">--- 488,11 ---</span>
  
                  // Check for the OCSPSigning key purpose
                  try {
                      List&lt;String&gt; keyPurposes = signerCert.getExtendedKeyUsage();
                      if (keyPurposes == null ||
<span class="line-modified">!                         !keyPurposes.contains(KnownOIDs.OCSPSigning.value())) {</span>
                          throw new CertPathValidatorException(
                              &quot;Responder&#39;s certificate not valid for signing &quot; +
                              &quot;OCSP responses&quot;);
                      }
                  } catch (CertificateParsingException cpe) {
</pre>
<center><a href="../SunEntries.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="RevocationChecker.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>