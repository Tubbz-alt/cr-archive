<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/sun/security/provider/SunEntries.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="SHA3.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="certpath/OCSPResponse.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/provider/SunEntries.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package sun.security.provider;
 27 
 28 import java.io.*;
 29 import java.net.*;
 30 import java.util.*;
 31 import java.security.*;
 32 
 33 import jdk.internal.util.StaticProperty;
 34 import sun.security.action.GetPropertyAction;


 35 
 36 /**
 37  * Defines the entries of the SUN provider.
 38  *
 39  * Algorithms supported, and their names:
 40  *
 41  * - SHA is the message digest scheme described in FIPS 180-1.
 42  *   Aliases for SHA are SHA-1 and SHA1.
 43  *
 44  * - SHA1withDSA is the signature scheme described in FIPS 186.
 45  *   (SHA used in DSA is SHA-1: FIPS 186 with Change No 1.)
 46  *   Aliases for SHA1withDSA are DSA, DSS, SHA/DSA, SHA-1/DSA, SHA1/DSA,
 47  *   SHAwithDSA, DSAWithSHA1, and the object
 48  *   identifier strings &quot;OID.1.3.14.3.2.13&quot;, &quot;OID.1.3.14.3.2.27&quot; and
 49  *   &quot;OID.1.2.840.10040.4.3&quot;.
 50  *
 51  * - SHA-2 is a set of message digest schemes described in FIPS 180-2.
 52  *   SHA-2 family of hash functions includes SHA-224, SHA-256, SHA-384,
 53  *   and SHA-512.
 54  *
</pre>
<hr />
<pre>
 63  * - MD5 is the message digest scheme described in RFC 1321.
 64  *   There are no aliases for MD5.
 65  *
 66  * - X.509 is the certificate factory type for X.509 certificates
 67  *   and CRLs. Aliases for X.509 are X509.
 68  *
 69  * - PKIX is the certification path validation algorithm described
 70  *   in RFC 5280. The ValidationAlgorithm attribute notes the
 71  *   specification that this provider implements.
 72  *
 73  * - JavaPolicy is the default file-based Policy type.
 74  *
 75  * - JavaLoginConfig is the default file-based LoginModule Configuration type.
 76  */
 77 
 78 public final class SunEntries {
 79 
 80     // the default algo used by SecureRandom class for new SecureRandom() calls
 81     public static final String DEF_SECURE_RANDOM_ALGO;
 82 
<span class="line-removed"> 83     // create an aliases List from the specified aliases</span>
<span class="line-removed"> 84     public static List&lt;String&gt; createAliases(String ... aliases) {</span>
<span class="line-removed"> 85         return Arrays.asList(aliases);</span>
<span class="line-removed"> 86     }</span>
<span class="line-removed"> 87 </span>
<span class="line-removed"> 88     // create an aliases List from the specified oid followed by other aliases</span>
<span class="line-removed"> 89     public static List&lt;String&gt; createAliasesWithOid(String ... oids) {</span>
<span class="line-removed"> 90         String[] result = Arrays.copyOf(oids, oids.length + 1);</span>
<span class="line-removed"> 91         result[result.length - 1] = &quot;OID.&quot; + oids[0];</span>
<span class="line-removed"> 92         return Arrays.asList(result);</span>
<span class="line-removed"> 93     }</span>
<span class="line-removed"> 94 </span>
 95     SunEntries(Provider p) {
 96         services = new LinkedHashSet&lt;&gt;(50, 0.9f);
 97 
 98         // start populating content using the specified provider
 99 
100         // common attribute map
101         HashMap&lt;String, String&gt; attrs = new HashMap&lt;&gt;(3);
102 
103         /*
104          * SecureRandom engines
105          */
106         attrs.put(&quot;ThreadSafe&quot;, &quot;true&quot;);
107         if (NativePRNG.isAvailable()) {
108             add(p, &quot;SecureRandom&quot;, &quot;NativePRNG&quot;,
<span class="line-modified">109                     &quot;sun.security.provider.NativePRNG&quot;,</span>
<span class="line-removed">110                     null, attrs);</span>
111         }
112         if (NativePRNG.Blocking.isAvailable()) {
113             add(p, &quot;SecureRandom&quot;, &quot;NativePRNGBlocking&quot;,
<span class="line-modified">114                     &quot;sun.security.provider.NativePRNG$Blocking&quot;, null, attrs);</span>
115         }
116         if (NativePRNG.NonBlocking.isAvailable()) {
117             add(p, &quot;SecureRandom&quot;, &quot;NativePRNGNonBlocking&quot;,
<span class="line-modified">118                     &quot;sun.security.provider.NativePRNG$NonBlocking&quot;, null, attrs);</span>
119         }
120         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);
<span class="line-modified">121         add(p, &quot;SecureRandom&quot;, &quot;DRBG&quot;, &quot;sun.security.provider.DRBG&quot;,</span>
<span class="line-removed">122                null, attrs);</span>
123         add(p, &quot;SecureRandom&quot;, &quot;SHA1PRNG&quot;,
<span class="line-modified">124                 &quot;sun.security.provider.SecureRandom&quot;, null, attrs);</span>
125 
126         /*
127          * Signature engines
128          */
129         attrs.clear();
130         String dsaKeyClasses = &quot;java.security.interfaces.DSAPublicKey&quot; +
131                 &quot;|java.security.interfaces.DSAPrivateKey&quot;;
132         attrs.put(&quot;SupportedKeyClasses&quot;, dsaKeyClasses);
133         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);
134 
135         attrs.put(&quot;KeySize&quot;, &quot;1024&quot;); // for NONE and SHA1 DSA signatures
136 
<span class="line-modified">137         add(p, &quot;Signature&quot;, &quot;SHA1withDSA&quot;,</span>
<span class="line-modified">138                 &quot;sun.security.provider.DSA$SHA1withDSA&quot;,</span>
<span class="line-modified">139                 createAliasesWithOid(&quot;1.2.840.10040.4.3&quot;, &quot;DSA&quot;, &quot;DSS&quot;,</span>
<span class="line-modified">140                     &quot;SHA/DSA&quot;, &quot;SHA-1/DSA&quot;, &quot;SHA1/DSA&quot;, &quot;SHAwithDSA&quot;,</span>
<span class="line-removed">141                     &quot;DSAWithSHA1&quot;, &quot;1.3.14.3.2.13&quot;, &quot;1.3.14.3.2.27&quot;), attrs);</span>
<span class="line-removed">142         add(p, &quot;Signature&quot;, &quot;NONEwithDSA&quot;, &quot;sun.security.provider.DSA$RawDSA&quot;,</span>
<span class="line-removed">143                 createAliases(&quot;RawDSA&quot;), attrs);</span>
144 
145         attrs.put(&quot;KeySize&quot;, &quot;2048&quot;); // for SHA224 and SHA256 DSA signatures
146 
<span class="line-modified">147         add(p, &quot;Signature&quot;, &quot;SHA224withDSA&quot;,</span>
<span class="line-modified">148                 &quot;sun.security.provider.DSA$SHA224withDSA&quot;,</span>
<span class="line-modified">149                 createAliasesWithOid(&quot;2.16.840.1.101.3.4.3.1&quot;), attrs);</span>
<span class="line-modified">150         add(p, &quot;Signature&quot;, &quot;SHA256withDSA&quot;,</span>
<span class="line-removed">151                 &quot;sun.security.provider.DSA$SHA256withDSA&quot;,</span>
<span class="line-removed">152                 createAliasesWithOid(&quot;2.16.840.1.101.3.4.3.2&quot;), attrs);</span>
153 
154         attrs.remove(&quot;KeySize&quot;);
155 
156         add(p, &quot;Signature&quot;, &quot;SHA1withDSAinP1363Format&quot;,
<span class="line-modified">157                 &quot;sun.security.provider.DSA$SHA1withDSAinP1363Format&quot;,</span>
<span class="line-removed">158                 null, null);</span>
159         add(p, &quot;Signature&quot;, &quot;NONEwithDSAinP1363Format&quot;,
<span class="line-modified">160                 &quot;sun.security.provider.DSA$RawDSAinP1363Format&quot;,</span>
<span class="line-removed">161                 null, null);</span>
162         add(p, &quot;Signature&quot;, &quot;SHA224withDSAinP1363Format&quot;,
<span class="line-modified">163                 &quot;sun.security.provider.DSA$SHA224withDSAinP1363Format&quot;,</span>
<span class="line-removed">164                 null, null);</span>
165         add(p, &quot;Signature&quot;, &quot;SHA256withDSAinP1363Format&quot;,
<span class="line-modified">166                 &quot;sun.security.provider.DSA$SHA256withDSAinP1363Format&quot;,</span>
<span class="line-removed">167                 null, null);</span>
168 
169         /*
170          *  Key Pair Generator engines
171          */
172         attrs.clear();
173         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);
174         attrs.put(&quot;KeySize&quot;, &quot;2048&quot;); // for DSA KPG and APG only
175 
<span class="line-removed">176         String dsaOid = &quot;1.2.840.10040.4.1&quot;;</span>
<span class="line-removed">177         List&lt;String&gt; dsaAliases = createAliasesWithOid(dsaOid, &quot;1.3.14.3.2.12&quot;);</span>
178         String dsaKPGImplClass = &quot;sun.security.provider.DSAKeyPairGenerator$&quot;;
179         dsaKPGImplClass += (useLegacyDSA? &quot;Legacy&quot; : &quot;Current&quot;);
<span class="line-modified">180         add(p, &quot;KeyPairGenerator&quot;, &quot;DSA&quot;, dsaKPGImplClass, dsaAliases, attrs);</span>
181 
182         /*
183          * Algorithm Parameter Generator engines
184          */
<span class="line-modified">185         add(p, &quot;AlgorithmParameterGenerator&quot;, &quot;DSA&quot;,</span>
<span class="line-modified">186                 &quot;sun.security.provider.DSAParameterGenerator&quot;, dsaAliases,</span>
<span class="line-removed">187                 attrs);</span>
188         attrs.remove(&quot;KeySize&quot;);
189 
190         /*
191          * Algorithm Parameter engines
192          */
<span class="line-modified">193         add(p, &quot;AlgorithmParameters&quot;, &quot;DSA&quot;,</span>
<span class="line-modified">194                 &quot;sun.security.provider.DSAParameters&quot;, dsaAliases, attrs);</span>
195 
196         /*
197          * Key factories
198          */
<span class="line-modified">199         add(p, &quot;KeyFactory&quot;, &quot;DSA&quot;, &quot;sun.security.provider.DSAKeyFactory&quot;,</span>
<span class="line-modified">200                 dsaAliases, attrs);</span>
201 
202         /*
203          * Digest engines
204          */
<span class="line-modified">205         add(p, &quot;MessageDigest&quot;, &quot;MD2&quot;, &quot;sun.security.provider.MD2&quot;, null, attrs);</span>
<span class="line-modified">206         add(p, &quot;MessageDigest&quot;, &quot;MD5&quot;, &quot;sun.security.provider.MD5&quot;, null, attrs);</span>
<span class="line-modified">207         add(p, &quot;MessageDigest&quot;, &quot;SHA&quot;, &quot;sun.security.provider.SHA&quot;,</span>
<span class="line-modified">208                 createAliasesWithOid(&quot;1.3.14.3.2.26&quot;, &quot;SHA-1&quot;, &quot;SHA1&quot;), attrs);</span>
<span class="line-modified">209 </span>
<span class="line-modified">210         String sha2BaseOid = &quot;2.16.840.1.101.3.4.2&quot;;</span>
<span class="line-modified">211         add(p, &quot;MessageDigest&quot;, &quot;SHA-224&quot;, &quot;sun.security.provider.SHA2$SHA224&quot;,</span>
<span class="line-modified">212                 createAliasesWithOid(sha2BaseOid + &quot;.4&quot;), attrs);</span>
<span class="line-modified">213         add(p, &quot;MessageDigest&quot;, &quot;SHA-256&quot;, &quot;sun.security.provider.SHA2$SHA256&quot;,</span>
<span class="line-modified">214                 createAliasesWithOid(sha2BaseOid + &quot;.1&quot;), attrs);</span>
<span class="line-modified">215         add(p, &quot;MessageDigest&quot;, &quot;SHA-384&quot;, &quot;sun.security.provider.SHA5$SHA384&quot;,</span>
<span class="line-modified">216                 createAliasesWithOid(sha2BaseOid + &quot;.2&quot;), attrs);</span>
<span class="line-modified">217         add(p, &quot;MessageDigest&quot;, &quot;SHA-512&quot;, &quot;sun.security.provider.SHA5$SHA512&quot;,</span>
<span class="line-modified">218                 createAliasesWithOid(sha2BaseOid + &quot;.3&quot;), attrs);</span>
<span class="line-modified">219         add(p, &quot;MessageDigest&quot;, &quot;SHA-512/224&quot;,</span>
<span class="line-modified">220                 &quot;sun.security.provider.SHA5$SHA512_224&quot;,</span>
<span class="line-modified">221                 createAliasesWithOid(sha2BaseOid + &quot;.5&quot;), attrs);</span>
<span class="line-modified">222         add(p, &quot;MessageDigest&quot;, &quot;SHA-512/256&quot;,</span>
<span class="line-modified">223                 &quot;sun.security.provider.SHA5$SHA512_256&quot;,</span>
<span class="line-modified">224                 createAliasesWithOid(sha2BaseOid + &quot;.6&quot;), attrs);</span>
<span class="line-modified">225         add(p, &quot;MessageDigest&quot;, &quot;SHA3-224&quot;, &quot;sun.security.provider.SHA3$SHA224&quot;,</span>
<span class="line-modified">226                 createAliasesWithOid(sha2BaseOid + &quot;.7&quot;), attrs);</span>
<span class="line-modified">227         add(p, &quot;MessageDigest&quot;, &quot;SHA3-256&quot;, &quot;sun.security.provider.SHA3$SHA256&quot;,</span>
<span class="line-modified">228                 createAliasesWithOid(sha2BaseOid + &quot;.8&quot;), attrs);</span>
<span class="line-modified">229         add(p, &quot;MessageDigest&quot;, &quot;SHA3-384&quot;, &quot;sun.security.provider.SHA3$SHA384&quot;,</span>
<span class="line-removed">230                 createAliasesWithOid(sha2BaseOid + &quot;.9&quot;), attrs);</span>
<span class="line-removed">231         add(p, &quot;MessageDigest&quot;, &quot;SHA3-512&quot;, &quot;sun.security.provider.SHA3$SHA512&quot;,</span>
<span class="line-removed">232                 createAliasesWithOid(sha2BaseOid + &quot;.10&quot;), attrs);</span>
233 
234         /*
235          * Certificates
236          */
<span class="line-modified">237         add(p, &quot;CertificateFactory&quot;, &quot;X.509&quot;,</span>
<span class="line-modified">238                 &quot;sun.security.provider.X509Factory&quot;,</span>
<span class="line-removed">239                 createAliases(&quot;X509&quot;), attrs);</span>
240 
241         /*
242          * KeyStore
243          */
244         add(p, &quot;KeyStore&quot;, &quot;PKCS12&quot;,
<span class="line-modified">245                 &quot;sun.security.pkcs12.PKCS12KeyStore$DualFormatPKCS12&quot;,</span>
<span class="line-removed">246                 null, null);</span>
247         add(p, &quot;KeyStore&quot;, &quot;JKS&quot;,
<span class="line-modified">248                 &quot;sun.security.provider.JavaKeyStore$DualFormatJKS&quot;,</span>
<span class="line-removed">249                 null, attrs);</span>
250         add(p, &quot;KeyStore&quot;, &quot;CaseExactJKS&quot;,
<span class="line-modified">251                 &quot;sun.security.provider.JavaKeyStore$CaseExactJKS&quot;,</span>
<span class="line-removed">252                 null, attrs);</span>
253         add(p, &quot;KeyStore&quot;, &quot;DKS&quot;, &quot;sun.security.provider.DomainKeyStore$DKS&quot;,
<span class="line-modified">254                 null, attrs);</span>
255 
256 
257         /*
258          * CertStores
259          */
260         add(p, &quot;CertStore&quot;, &quot;Collection&quot;,
261                 &quot;sun.security.provider.certpath.CollectionCertStore&quot;,
<span class="line-modified">262                 null, attrs);</span>
263         add(p, &quot;CertStore&quot;, &quot;com.sun.security.IndexedCollection&quot;,
264                 &quot;sun.security.provider.certpath.IndexedCollectionCertStore&quot;,
<span class="line-modified">265                 null, attrs);</span>
266 
267         /*
268          * Policy
269          */
<span class="line-modified">270         add(p, &quot;Policy&quot;, &quot;JavaPolicy&quot;, &quot;sun.security.provider.PolicySpiFile&quot;,</span>
<span class="line-removed">271                 null, null);</span>
272 
273         /*
274          * Configuration
275          */
276         add(p, &quot;Configuration&quot;, &quot;JavaLoginConfig&quot;,
<span class="line-modified">277                 &quot;sun.security.provider.ConfigFile$Spi&quot;, null, null);</span>
278 
279         /*
280          * CertPathBuilder and CertPathValidator
281          */
282         attrs.clear();
283         attrs.put(&quot;ValidationAlgorithm&quot;, &quot;RFC5280&quot;);
284         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);
285 
286         add(p, &quot;CertPathBuilder&quot;, &quot;PKIX&quot;,
287                 &quot;sun.security.provider.certpath.SunCertPathBuilder&quot;,
<span class="line-modified">288                 null, attrs);</span>
289         add(p, &quot;CertPathValidator&quot;, &quot;PKIX&quot;,
290                 &quot;sun.security.provider.certpath.PKIXCertPathValidator&quot;,
<span class="line-modified">291                 null, attrs);</span>
292     }
293 
294     Iterator&lt;Provider.Service&gt; iterator() {
295         return services.iterator();
296     }
297 




298     private void add(Provider p, String type, String algo, String cn,
<span class="line-modified">299             List&lt;String&gt; aliases, HashMap&lt;String, String&gt; attrs) {</span>
<span class="line-modified">300         services.add(new Provider.Service(p, type, algo, cn, aliases, attrs));</span>






301     }
302 
303     private LinkedHashSet&lt;Provider.Service&gt; services;
304 
305     // name of the *System* property, takes precedence over PROP_RNDSOURCE
306     private static final String PROP_EGD = &quot;java.security.egd&quot;;
307     // name of the *Security* property
308     private static final String PROP_RNDSOURCE = &quot;securerandom.source&quot;;
309 
310     private static final boolean useLegacyDSA =
311         Boolean.parseBoolean(GetPropertyAction.privilegedGetProperty
312             (&quot;jdk.security.legacyDSAKeyPairGenerator&quot;));
313 
314     static final String URL_DEV_RANDOM = &quot;file:/dev/random&quot;;
315     static final String URL_DEV_URANDOM = &quot;file:/dev/urandom&quot;;
316 
317     private static final String seedSource;
318 
319     static {
320         seedSource = AccessController.doPrivileged(
</pre>
</td>
<td>
<hr />
<pre>
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package sun.security.provider;
 27 
 28 import java.io.*;
 29 import java.net.*;
 30 import java.util.*;
 31 import java.security.*;
 32 
 33 import jdk.internal.util.StaticProperty;
 34 import sun.security.action.GetPropertyAction;
<span class="line-added"> 35 import sun.security.util.SecurityProviderConstants;</span>
<span class="line-added"> 36 import static sun.security.util.SecurityProviderConstants.getAliases;</span>
 37 
 38 /**
 39  * Defines the entries of the SUN provider.
 40  *
 41  * Algorithms supported, and their names:
 42  *
 43  * - SHA is the message digest scheme described in FIPS 180-1.
 44  *   Aliases for SHA are SHA-1 and SHA1.
 45  *
 46  * - SHA1withDSA is the signature scheme described in FIPS 186.
 47  *   (SHA used in DSA is SHA-1: FIPS 186 with Change No 1.)
 48  *   Aliases for SHA1withDSA are DSA, DSS, SHA/DSA, SHA-1/DSA, SHA1/DSA,
 49  *   SHAwithDSA, DSAWithSHA1, and the object
 50  *   identifier strings &quot;OID.1.3.14.3.2.13&quot;, &quot;OID.1.3.14.3.2.27&quot; and
 51  *   &quot;OID.1.2.840.10040.4.3&quot;.
 52  *
 53  * - SHA-2 is a set of message digest schemes described in FIPS 180-2.
 54  *   SHA-2 family of hash functions includes SHA-224, SHA-256, SHA-384,
 55  *   and SHA-512.
 56  *
</pre>
<hr />
<pre>
 65  * - MD5 is the message digest scheme described in RFC 1321.
 66  *   There are no aliases for MD5.
 67  *
 68  * - X.509 is the certificate factory type for X.509 certificates
 69  *   and CRLs. Aliases for X.509 are X509.
 70  *
 71  * - PKIX is the certification path validation algorithm described
 72  *   in RFC 5280. The ValidationAlgorithm attribute notes the
 73  *   specification that this provider implements.
 74  *
 75  * - JavaPolicy is the default file-based Policy type.
 76  *
 77  * - JavaLoginConfig is the default file-based LoginModule Configuration type.
 78  */
 79 
 80 public final class SunEntries {
 81 
 82     // the default algo used by SecureRandom class for new SecureRandom() calls
 83     public static final String DEF_SECURE_RANDOM_ALGO;
 84 












 85     SunEntries(Provider p) {
 86         services = new LinkedHashSet&lt;&gt;(50, 0.9f);
 87 
 88         // start populating content using the specified provider
 89 
 90         // common attribute map
 91         HashMap&lt;String, String&gt; attrs = new HashMap&lt;&gt;(3);
 92 
 93         /*
 94          * SecureRandom engines
 95          */
 96         attrs.put(&quot;ThreadSafe&quot;, &quot;true&quot;);
 97         if (NativePRNG.isAvailable()) {
 98             add(p, &quot;SecureRandom&quot;, &quot;NativePRNG&quot;,
<span class="line-modified"> 99                     &quot;sun.security.provider.NativePRNG&quot;, attrs);</span>

100         }
101         if (NativePRNG.Blocking.isAvailable()) {
102             add(p, &quot;SecureRandom&quot;, &quot;NativePRNGBlocking&quot;,
<span class="line-modified">103                     &quot;sun.security.provider.NativePRNG$Blocking&quot;, attrs);</span>
104         }
105         if (NativePRNG.NonBlocking.isAvailable()) {
106             add(p, &quot;SecureRandom&quot;, &quot;NativePRNGNonBlocking&quot;,
<span class="line-modified">107                     &quot;sun.security.provider.NativePRNG$NonBlocking&quot;, attrs);</span>
108         }
109         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);
<span class="line-modified">110         add(p, &quot;SecureRandom&quot;, &quot;DRBG&quot;, &quot;sun.security.provider.DRBG&quot;, attrs);</span>

111         add(p, &quot;SecureRandom&quot;, &quot;SHA1PRNG&quot;,
<span class="line-modified">112                 &quot;sun.security.provider.SecureRandom&quot;, attrs);</span>
113 
114         /*
115          * Signature engines
116          */
117         attrs.clear();
118         String dsaKeyClasses = &quot;java.security.interfaces.DSAPublicKey&quot; +
119                 &quot;|java.security.interfaces.DSAPrivateKey&quot;;
120         attrs.put(&quot;SupportedKeyClasses&quot;, dsaKeyClasses);
121         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);
122 
123         attrs.put(&quot;KeySize&quot;, &quot;1024&quot;); // for NONE and SHA1 DSA signatures
124 
<span class="line-modified">125         addWithAlias(p, &quot;Signature&quot;, &quot;SHA1withDSA&quot;,</span>
<span class="line-modified">126                 &quot;sun.security.provider.DSA$SHA1withDSA&quot;, attrs);</span>
<span class="line-modified">127         addWithAlias(p, &quot;Signature&quot;, &quot;NONEwithDSA&quot;,</span>
<span class="line-modified">128                 &quot;sun.security.provider.DSA$RawDSA&quot;, attrs);</span>



129 
130         attrs.put(&quot;KeySize&quot;, &quot;2048&quot;); // for SHA224 and SHA256 DSA signatures
131 
<span class="line-modified">132         addWithAlias(p, &quot;Signature&quot;, &quot;SHA224withDSA&quot;,</span>
<span class="line-modified">133                 &quot;sun.security.provider.DSA$SHA224withDSA&quot;, attrs);</span>
<span class="line-modified">134         addWithAlias(p, &quot;Signature&quot;, &quot;SHA256withDSA&quot;,</span>
<span class="line-modified">135                 &quot;sun.security.provider.DSA$SHA256withDSA&quot;, attrs);</span>


136 
137         attrs.remove(&quot;KeySize&quot;);
138 
139         add(p, &quot;Signature&quot;, &quot;SHA1withDSAinP1363Format&quot;,
<span class="line-modified">140                 &quot;sun.security.provider.DSA$SHA1withDSAinP1363Format&quot;);</span>

141         add(p, &quot;Signature&quot;, &quot;NONEwithDSAinP1363Format&quot;,
<span class="line-modified">142                 &quot;sun.security.provider.DSA$RawDSAinP1363Format&quot;);</span>

143         add(p, &quot;Signature&quot;, &quot;SHA224withDSAinP1363Format&quot;,
<span class="line-modified">144                 &quot;sun.security.provider.DSA$SHA224withDSAinP1363Format&quot;);</span>

145         add(p, &quot;Signature&quot;, &quot;SHA256withDSAinP1363Format&quot;,
<span class="line-modified">146                 &quot;sun.security.provider.DSA$SHA256withDSAinP1363Format&quot;);</span>

147 
148         /*
149          *  Key Pair Generator engines
150          */
151         attrs.clear();
152         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);
153         attrs.put(&quot;KeySize&quot;, &quot;2048&quot;); // for DSA KPG and APG only
154 


155         String dsaKPGImplClass = &quot;sun.security.provider.DSAKeyPairGenerator$&quot;;
156         dsaKPGImplClass += (useLegacyDSA? &quot;Legacy&quot; : &quot;Current&quot;);
<span class="line-modified">157         addWithAlias(p, &quot;KeyPairGenerator&quot;, &quot;DSA&quot;, dsaKPGImplClass, attrs);</span>
158 
159         /*
160          * Algorithm Parameter Generator engines
161          */
<span class="line-modified">162         addWithAlias(p, &quot;AlgorithmParameterGenerator&quot;, &quot;DSA&quot;,</span>
<span class="line-modified">163                 &quot;sun.security.provider.DSAParameterGenerator&quot;, attrs);</span>

164         attrs.remove(&quot;KeySize&quot;);
165 
166         /*
167          * Algorithm Parameter engines
168          */
<span class="line-modified">169         addWithAlias(p, &quot;AlgorithmParameters&quot;, &quot;DSA&quot;,</span>
<span class="line-modified">170                 &quot;sun.security.provider.DSAParameters&quot;, attrs);</span>
171 
172         /*
173          * Key factories
174          */
<span class="line-modified">175         addWithAlias(p, &quot;KeyFactory&quot;, &quot;DSA&quot;,</span>
<span class="line-modified">176                 &quot;sun.security.provider.DSAKeyFactory&quot;, attrs);</span>
177 
178         /*
179          * Digest engines
180          */
<span class="line-modified">181         add(p, &quot;MessageDigest&quot;, &quot;MD2&quot;, &quot;sun.security.provider.MD2&quot;, attrs);</span>
<span class="line-modified">182         add(p, &quot;MessageDigest&quot;, &quot;MD5&quot;, &quot;sun.security.provider.MD5&quot;, attrs);</span>
<span class="line-modified">183         addWithAlias(p, &quot;MessageDigest&quot;, &quot;SHA-1&quot;, &quot;sun.security.provider.SHA&quot;,</span>
<span class="line-modified">184                 attrs);</span>
<span class="line-modified">185 </span>
<span class="line-modified">186         addWithAlias(p, &quot;MessageDigest&quot;, &quot;SHA-224&quot;,</span>
<span class="line-modified">187                 &quot;sun.security.provider.SHA2$SHA224&quot;, attrs);</span>
<span class="line-modified">188         addWithAlias(p, &quot;MessageDigest&quot;, &quot;SHA-256&quot;,</span>
<span class="line-modified">189                 &quot;sun.security.provider.SHA2$SHA256&quot;, attrs);</span>
<span class="line-modified">190         addWithAlias(p, &quot;MessageDigest&quot;, &quot;SHA-384&quot;,</span>
<span class="line-modified">191                 &quot;sun.security.provider.SHA5$SHA384&quot;, attrs);</span>
<span class="line-modified">192         addWithAlias(p, &quot;MessageDigest&quot;, &quot;SHA-512&quot;,</span>
<span class="line-modified">193                 &quot;sun.security.provider.SHA5$SHA512&quot;, attrs);</span>
<span class="line-modified">194         addWithAlias(p, &quot;MessageDigest&quot;, &quot;SHA-512/224&quot;,</span>
<span class="line-modified">195                 &quot;sun.security.provider.SHA5$SHA512_224&quot;, attrs);</span>
<span class="line-modified">196         addWithAlias(p, &quot;MessageDigest&quot;, &quot;SHA-512/256&quot;,</span>
<span class="line-modified">197                 &quot;sun.security.provider.SHA5$SHA512_256&quot;, attrs);</span>
<span class="line-modified">198         addWithAlias(p, &quot;MessageDigest&quot;, &quot;SHA3-224&quot;,</span>
<span class="line-modified">199                 &quot;sun.security.provider.SHA3$SHA224&quot;, attrs);</span>
<span class="line-modified">200         addWithAlias(p, &quot;MessageDigest&quot;, &quot;SHA3-256&quot;,</span>
<span class="line-modified">201                 &quot;sun.security.provider.SHA3$SHA256&quot;, attrs);</span>
<span class="line-modified">202         addWithAlias(p, &quot;MessageDigest&quot;, &quot;SHA3-384&quot;,</span>
<span class="line-modified">203                 &quot;sun.security.provider.SHA3$SHA384&quot;, attrs);</span>
<span class="line-modified">204         addWithAlias(p, &quot;MessageDigest&quot;, &quot;SHA3-512&quot;,</span>
<span class="line-modified">205                 &quot;sun.security.provider.SHA3$SHA512&quot;, attrs);</span>



206 
207         /*
208          * Certificates
209          */
<span class="line-modified">210         addWithAlias(p, &quot;CertificateFactory&quot;, &quot;X.509&quot;,</span>
<span class="line-modified">211                 &quot;sun.security.provider.X509Factory&quot;, attrs);</span>

212 
213         /*
214          * KeyStore
215          */
216         add(p, &quot;KeyStore&quot;, &quot;PKCS12&quot;,
<span class="line-modified">217                 &quot;sun.security.pkcs12.PKCS12KeyStore$DualFormatPKCS12&quot;);</span>

218         add(p, &quot;KeyStore&quot;, &quot;JKS&quot;,
<span class="line-modified">219                 &quot;sun.security.provider.JavaKeyStore$DualFormatJKS&quot;, attrs);</span>

220         add(p, &quot;KeyStore&quot;, &quot;CaseExactJKS&quot;,
<span class="line-modified">221                 &quot;sun.security.provider.JavaKeyStore$CaseExactJKS&quot;, attrs);</span>

222         add(p, &quot;KeyStore&quot;, &quot;DKS&quot;, &quot;sun.security.provider.DomainKeyStore$DKS&quot;,
<span class="line-modified">223                 attrs);</span>
224 
225 
226         /*
227          * CertStores
228          */
229         add(p, &quot;CertStore&quot;, &quot;Collection&quot;,
230                 &quot;sun.security.provider.certpath.CollectionCertStore&quot;,
<span class="line-modified">231                 attrs);</span>
232         add(p, &quot;CertStore&quot;, &quot;com.sun.security.IndexedCollection&quot;,
233                 &quot;sun.security.provider.certpath.IndexedCollectionCertStore&quot;,
<span class="line-modified">234                 attrs);</span>
235 
236         /*
237          * Policy
238          */
<span class="line-modified">239         add(p, &quot;Policy&quot;, &quot;JavaPolicy&quot;, &quot;sun.security.provider.PolicySpiFile&quot;);</span>

240 
241         /*
242          * Configuration
243          */
244         add(p, &quot;Configuration&quot;, &quot;JavaLoginConfig&quot;,
<span class="line-modified">245                 &quot;sun.security.provider.ConfigFile$Spi&quot;);</span>
246 
247         /*
248          * CertPathBuilder and CertPathValidator
249          */
250         attrs.clear();
251         attrs.put(&quot;ValidationAlgorithm&quot;, &quot;RFC5280&quot;);
252         attrs.put(&quot;ImplementedIn&quot;, &quot;Software&quot;);
253 
254         add(p, &quot;CertPathBuilder&quot;, &quot;PKIX&quot;,
255                 &quot;sun.security.provider.certpath.SunCertPathBuilder&quot;,
<span class="line-modified">256                 attrs);</span>
257         add(p, &quot;CertPathValidator&quot;, &quot;PKIX&quot;,
258                 &quot;sun.security.provider.certpath.PKIXCertPathValidator&quot;,
<span class="line-modified">259                 attrs);</span>
260     }
261 
262     Iterator&lt;Provider.Service&gt; iterator() {
263         return services.iterator();
264     }
265 
<span class="line-added">266     private void add(Provider p, String type, String algo, String cn) {</span>
<span class="line-added">267         services.add(new Provider.Service(p, type, algo, cn, null, null));</span>
<span class="line-added">268     }</span>
<span class="line-added">269 </span>
270     private void add(Provider p, String type, String algo, String cn,
<span class="line-modified">271             HashMap&lt;String, String&gt; attrs) {</span>
<span class="line-modified">272         services.add(new Provider.Service(p, type, algo, cn, null, attrs));</span>
<span class="line-added">273     }</span>
<span class="line-added">274 </span>
<span class="line-added">275     private void addWithAlias(Provider p, String type, String algo, String cn,</span>
<span class="line-added">276             HashMap&lt;String, String&gt; attrs) {</span>
<span class="line-added">277         services.add(new Provider.Service(p, type, algo, cn,</span>
<span class="line-added">278             getAliases(algo), attrs));</span>
279     }
280 
281     private LinkedHashSet&lt;Provider.Service&gt; services;
282 
283     // name of the *System* property, takes precedence over PROP_RNDSOURCE
284     private static final String PROP_EGD = &quot;java.security.egd&quot;;
285     // name of the *Security* property
286     private static final String PROP_RNDSOURCE = &quot;securerandom.source&quot;;
287 
288     private static final boolean useLegacyDSA =
289         Boolean.parseBoolean(GetPropertyAction.privilegedGetProperty
290             (&quot;jdk.security.legacyDSAKeyPairGenerator&quot;));
291 
292     static final String URL_DEV_RANDOM = &quot;file:/dev/random&quot;;
293     static final String URL_DEV_URANDOM = &quot;file:/dev/urandom&quot;;
294 
295     private static final String seedSource;
296 
297     static {
298         seedSource = AccessController.doPrivileged(
</pre>
</td>
</tr>
</table>
<center><a href="SHA3.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="certpath/OCSPResponse.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>