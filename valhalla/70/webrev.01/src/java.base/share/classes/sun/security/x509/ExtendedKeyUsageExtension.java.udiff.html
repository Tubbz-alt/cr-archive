<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.base/share/classes/sun/security/x509/ExtendedKeyUsageExtension.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="AlgorithmId.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="InhibitAnyPolicyExtension.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/x509/ExtendedKeyUsageExtension.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -32,13 +32,11 @@</span>
  import java.util.HashMap;
  import java.util.List;
  import java.util.Map;
  import java.util.Vector;
  
<span class="udiff-line-modified-removed">- import sun.security.util.DerValue;</span>
<span class="udiff-line-removed">- import sun.security.util.DerOutputStream;</span>
<span class="udiff-line-removed">- import sun.security.util.ObjectIdentifier;</span>
<span class="udiff-line-modified-added">+ import sun.security.util.*;</span>
  
  /**
   * This class defines the Extended Key Usage Extension, which
   * indicates one or more purposes for which the certified public key
   * may be used, in addition to or in place of the basic purposes
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -92,28 +90,10 @@</span>
       * Attribute names.
       */
      public static final String NAME = &quot;ExtendedKeyUsage&quot;;
      public static final String USAGES = &quot;usages&quot;;
  
<span class="udiff-line-removed">-     // OID defined in RFC 5280 Sections 4.2.1.12</span>
<span class="udiff-line-removed">-     // more from http://www.alvestrand.no/objectid/1.3.6.1.5.5.7.3.html</span>
<span class="udiff-line-removed">-     private static final Map &lt;ObjectIdentifier, String&gt; map =</span>
<span class="udiff-line-removed">-             new HashMap&lt;ObjectIdentifier, String&gt;();</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     static {</span>
<span class="udiff-line-removed">-         map.put(ObjectIdentifier.of(&quot;2.5.29.37.0&quot;), &quot;anyExtendedKeyUsage&quot;);</span>
<span class="udiff-line-removed">-         map.put(ObjectIdentifier.of(&quot;1.3.6.1.5.5.7.3.1&quot;), &quot;serverAuth&quot;);</span>
<span class="udiff-line-removed">-         map.put(ObjectIdentifier.of(&quot;1.3.6.1.5.5.7.3.2&quot;), &quot;clientAuth&quot;);</span>
<span class="udiff-line-removed">-         map.put(ObjectIdentifier.of(&quot;1.3.6.1.5.5.7.3.3&quot;), &quot;codeSigning&quot;);</span>
<span class="udiff-line-removed">-         map.put(ObjectIdentifier.of(&quot;1.3.6.1.5.5.7.3.4&quot;), &quot;emailProtection&quot;);</span>
<span class="udiff-line-removed">-         map.put(ObjectIdentifier.of(&quot;1.3.6.1.5.5.7.3.5&quot;), &quot;ipsecEndSystem&quot;);</span>
<span class="udiff-line-removed">-         map.put(ObjectIdentifier.of(&quot;1.3.6.1.5.5.7.3.6&quot;), &quot;ipsecTunnel&quot;);</span>
<span class="udiff-line-removed">-         map.put(ObjectIdentifier.of(&quot;1.3.6.1.5.5.7.3.7&quot;), &quot;ipsecUser&quot;);</span>
<span class="udiff-line-removed">-         map.put(ObjectIdentifier.of(&quot;1.3.6.1.5.5.7.3.8&quot;), &quot;timeStamping&quot;);</span>
<span class="udiff-line-removed">-         map.put(ObjectIdentifier.of(&quot;1.3.6.1.5.5.7.3.9&quot;), &quot;OCSPSigning&quot;);</span>
<span class="udiff-line-removed">-     };</span>
<span class="udiff-line-removed">- </span>
      /**
       * Vector of KeyUsages for this object.
       */
      private Vector&lt;ObjectIdentifier&gt; keyUsages;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -196,15 +176,16 @@</span>
          for (ObjectIdentifier oid: keyUsages) {
              if(!first) {
                  usage += &quot;\n  &quot;;
              }
  
<span class="udiff-line-modified-removed">-             String result = map.get(oid);</span>
<span class="udiff-line-modified-removed">-             if (result != null) {</span>
<span class="udiff-line-modified-removed">-                 usage += result;</span>
<span class="udiff-line-modified-added">+             String res = oid.toString();</span>
<span class="udiff-line-modified-added">+             KnownOIDs os = KnownOIDs.findMatch(res);</span>
<span class="udiff-line-modified-added">+             if (os != null) {</span>
<span class="udiff-line-added">+                 usage += os.stdName();</span>
              } else {
<span class="udiff-line-modified-removed">-                 usage += oid.toString();</span>
<span class="udiff-line-modified-added">+                 usage += res;</span>
              }
              first = false;
          }
          return super.toString() + &quot;ExtendedKeyUsages [\n&quot;
                 + usage + &quot;\n]\n&quot;;
</pre>
<center><a href="AlgorithmId.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="InhibitAnyPolicyExtension.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>