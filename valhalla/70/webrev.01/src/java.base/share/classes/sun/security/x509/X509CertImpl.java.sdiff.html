<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/sun/security/x509/X509CertImpl.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="X509CRLImpl.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../legal/icu.md.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/x509/X509CertImpl.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 111     public static final String VERSION = NAME + DOT + INFO + DOT +
 112                                X509CertInfo.VERSION + DOT +
 113                                CertificateVersion.VERSION;
 114 
 115     // x509.algorithm
 116     public static final String SIG_ALG = NAME + DOT + ALG_ID;
 117 
 118     // x509.signature
 119     public static final String SIG = NAME + DOT + SIGNATURE;
 120 
 121     // when we sign and decode we set this to true
 122     // this is our means to make certificates immutable
 123     private boolean readOnly = false;
 124 
 125     // Certificate data, and its envelope
 126     private byte[]              signedCert = null;
 127     protected X509CertInfo      info = null;
 128     protected AlgorithmId       algId = null;
 129     protected byte[]            signature = null;
 130 
<span class="line-removed"> 131     // recognized extension OIDS</span>
<span class="line-removed"> 132     private static final String KEY_USAGE_OID = &quot;2.5.29.15&quot;;</span>
<span class="line-removed"> 133     private static final String EXTENDED_KEY_USAGE_OID = &quot;2.5.29.37&quot;;</span>
<span class="line-removed"> 134     private static final String BASIC_CONSTRAINT_OID = &quot;2.5.29.19&quot;;</span>
<span class="line-removed"> 135     private static final String SUBJECT_ALT_NAME_OID = &quot;2.5.29.17&quot;;</span>
<span class="line-removed"> 136     private static final String ISSUER_ALT_NAME_OID = &quot;2.5.29.18&quot;;</span>
<span class="line-removed"> 137     private static final String AUTH_INFO_ACCESS_OID = &quot;1.3.6.1.5.5.7.1.1&quot;;</span>
<span class="line-removed"> 138 </span>
 139     // number of standard key usage bits.
 140     private static final int NUM_STANDARD_KEY_USAGE = 9;
 141 
 142     // SubjectAlterntativeNames cache
 143     private Collection&lt;List&lt;?&gt;&gt; subjectAlternativeNames;
 144 
 145     // IssuerAlternativeNames cache
 146     private Collection&lt;List&lt;?&gt;&gt; issuerAlternativeNames;
 147 
 148     // ExtendedKeyUsage cache
 149     private List&lt;String&gt; extKeyUsage;
 150 
 151     // AuthorityInformationAccess cache
 152     private Set&lt;AccessDescription&gt; authInfoAccess;
 153 
 154     /**
 155      * PublicKey that has previously been used to verify
 156      * the signature of this certificate. Null if the certificate has not
 157      * yet been verified.
 158      */
</pre>
<hr />
<pre>
1406                 return null;
1407             }
1408             if (extensions == null) {
1409                 return null;
1410             } else {
1411                 return extensions.getUnparseableExtensions().get(oid.toString());
1412             }
1413         } catch (IOException ioe) {
1414             return null;
1415         }
1416     }
1417 
1418     /**
1419      * Gets the DER encoded extension identified by the given
1420      * oid String.
1421      *
1422      * @param oid the Object Identifier value for the extension.
1423      */
1424     public byte[] getExtensionValue(String oid) {
1425         try {
<span class="line-modified">1426             ObjectIdentifier findOID = new ObjectIdentifier(oid);</span>
1427             String extAlias = OIDMap.getName(findOID);
1428             Extension certExt = null;
1429             CertificateExtensions exts = (CertificateExtensions)info.get(
1430                                      CertificateExtensions.NAME);
1431 
1432             if (extAlias == null) { // may be unknown
1433                 // get the extensions, search thru&#39; for this oid
1434                 if (exts == null) {
1435                     return null;
1436                 }
1437 
1438                 for (Extension ex : exts.getAllExtensions()) {
1439                     ObjectIdentifier inCertOID = ex.getExtensionId();
1440                     if (inCertOID.equals(findOID)) {
1441                         certExt = ex;
1442                         break;
1443                     }
1444                 }
1445             } else { // there&#39;s sub-class that can handle this extension
1446                 try {
</pre>
<hr />
<pre>
1509         } else {
1510             ExtendedKeyUsageExtension ext = getExtendedKeyUsageExtension();
1511             if (ext == null) {
1512                 return null;
1513             }
1514             extKeyUsage =
1515                 Collections.unmodifiableList(ext.getExtendedKeyUsage());
1516             return extKeyUsage;
1517         }
1518     }
1519 
1520     /**
1521      * This static method is the default implementation of the
1522      * getExtendedKeyUsage method in X509Certificate. A
1523      * X509Certificate provider generally should overwrite this to
1524      * provide among other things caching for better performance.
1525      */
1526     public static List&lt;String&gt; getExtendedKeyUsage(X509Certificate cert)
1527         throws CertificateParsingException {
1528         try {
<span class="line-modified">1529             byte[] ext = cert.getExtensionValue(EXTENDED_KEY_USAGE_OID);</span>

1530             if (ext == null)
1531                 return null;
1532             DerValue val = new DerValue(ext);
1533             byte[] data = val.getOctetString();
1534 
1535             ExtendedKeyUsageExtension ekuExt =
1536                 new ExtendedKeyUsageExtension(Boolean.FALSE, data);
1537             return Collections.unmodifiableList(ekuExt.getExtendedKeyUsage());
1538         } catch (IOException ioe) {
1539             throw new CertificateParsingException(ioe);
1540         }
1541     }
1542 
1543     /**
1544      * Get the certificate constraints path length from
1545      * the critical BasicConstraints extension, (oid = 2.5.29.19).
1546      * @return the length of the constraint.
1547      */
1548     public int getBasicConstraints() {
1549         try {
</pre>
<hr />
<pre>
1679         try {
1680             names = subjectAltNameExt.get(
1681                     SubjectAlternativeNameExtension.SUBJECT_NAME);
1682         } catch (IOException ioe) {
1683             // should not occur
1684             return Collections.&lt;List&lt;?&gt;&gt;emptySet();
1685         }
1686         subjectAlternativeNames = makeAltNames(names);
1687         return subjectAlternativeNames;
1688     }
1689 
1690     /**
1691      * This static method is the default implementation of the
1692      * getSubjectAlternaitveNames method in X509Certificate. A
1693      * X509Certificate provider generally should overwrite this to
1694      * provide among other things caching for better performance.
1695      */
1696     public static Collection&lt;List&lt;?&gt;&gt; getSubjectAlternativeNames(X509Certificate cert)
1697         throws CertificateParsingException {
1698         try {
<span class="line-modified">1699             byte[] ext = cert.getExtensionValue(SUBJECT_ALT_NAME_OID);</span>

1700             if (ext == null) {
1701                 return null;
1702             }
1703             DerValue val = new DerValue(ext);
1704             byte[] data = val.getOctetString();
1705 
1706             SubjectAlternativeNameExtension subjectAltNameExt =
1707                 new SubjectAlternativeNameExtension(Boolean.FALSE,
1708                                                     data);
1709 
1710             GeneralNames names;
1711             try {
1712                 names = subjectAltNameExt.get(
1713                         SubjectAlternativeNameExtension.SUBJECT_NAME);
1714             }  catch (IOException ioe) {
1715                 // should not occur
1716                 return Collections.&lt;List&lt;?&gt;&gt;emptySet();
1717             }
1718             return makeAltNames(names);
1719         } catch (IOException ioe) {
</pre>
<hr />
<pre>
1742         try {
1743             names = issuerAltNameExt.get(
1744                     IssuerAlternativeNameExtension.ISSUER_NAME);
1745         } catch (IOException ioe) {
1746             // should not occur
1747             return Collections.&lt;List&lt;?&gt;&gt;emptySet();
1748         }
1749         issuerAlternativeNames = makeAltNames(names);
1750         return issuerAlternativeNames;
1751     }
1752 
1753     /**
1754      * This static method is the default implementation of the
1755      * getIssuerAlternaitveNames method in X509Certificate. A
1756      * X509Certificate provider generally should overwrite this to
1757      * provide among other things caching for better performance.
1758      */
1759     public static Collection&lt;List&lt;?&gt;&gt; getIssuerAlternativeNames(X509Certificate cert)
1760         throws CertificateParsingException {
1761         try {
<span class="line-modified">1762             byte[] ext = cert.getExtensionValue(ISSUER_ALT_NAME_OID);</span>

1763             if (ext == null) {
1764                 return null;
1765             }
1766 
1767             DerValue val = new DerValue(ext);
1768             byte[] data = val.getOctetString();
1769 
1770             IssuerAlternativeNameExtension issuerAltNameExt =
1771                 new IssuerAlternativeNameExtension(Boolean.FALSE,
1772                                                     data);
1773             GeneralNames names;
1774             try {
1775                 names = issuerAltNameExt.get(
1776                         IssuerAlternativeNameExtension.ISSUER_NAME);
1777             }  catch (IOException ioe) {
1778                 // should not occur
1779                 return Collections.&lt;List&lt;?&gt;&gt;emptySet();
1780             }
1781             return makeAltNames(names);
1782         } catch (IOException ioe) {
</pre>
</td>
<td>
<hr />
<pre>
 111     public static final String VERSION = NAME + DOT + INFO + DOT +
 112                                X509CertInfo.VERSION + DOT +
 113                                CertificateVersion.VERSION;
 114 
 115     // x509.algorithm
 116     public static final String SIG_ALG = NAME + DOT + ALG_ID;
 117 
 118     // x509.signature
 119     public static final String SIG = NAME + DOT + SIGNATURE;
 120 
 121     // when we sign and decode we set this to true
 122     // this is our means to make certificates immutable
 123     private boolean readOnly = false;
 124 
 125     // Certificate data, and its envelope
 126     private byte[]              signedCert = null;
 127     protected X509CertInfo      info = null;
 128     protected AlgorithmId       algId = null;
 129     protected byte[]            signature = null;
 130 








 131     // number of standard key usage bits.
 132     private static final int NUM_STANDARD_KEY_USAGE = 9;
 133 
 134     // SubjectAlterntativeNames cache
 135     private Collection&lt;List&lt;?&gt;&gt; subjectAlternativeNames;
 136 
 137     // IssuerAlternativeNames cache
 138     private Collection&lt;List&lt;?&gt;&gt; issuerAlternativeNames;
 139 
 140     // ExtendedKeyUsage cache
 141     private List&lt;String&gt; extKeyUsage;
 142 
 143     // AuthorityInformationAccess cache
 144     private Set&lt;AccessDescription&gt; authInfoAccess;
 145 
 146     /**
 147      * PublicKey that has previously been used to verify
 148      * the signature of this certificate. Null if the certificate has not
 149      * yet been verified.
 150      */
</pre>
<hr />
<pre>
1398                 return null;
1399             }
1400             if (extensions == null) {
1401                 return null;
1402             } else {
1403                 return extensions.getUnparseableExtensions().get(oid.toString());
1404             }
1405         } catch (IOException ioe) {
1406             return null;
1407         }
1408     }
1409 
1410     /**
1411      * Gets the DER encoded extension identified by the given
1412      * oid String.
1413      *
1414      * @param oid the Object Identifier value for the extension.
1415      */
1416     public byte[] getExtensionValue(String oid) {
1417         try {
<span class="line-modified">1418             ObjectIdentifier findOID = ObjectIdentifier.of(oid);</span>
1419             String extAlias = OIDMap.getName(findOID);
1420             Extension certExt = null;
1421             CertificateExtensions exts = (CertificateExtensions)info.get(
1422                                      CertificateExtensions.NAME);
1423 
1424             if (extAlias == null) { // may be unknown
1425                 // get the extensions, search thru&#39; for this oid
1426                 if (exts == null) {
1427                     return null;
1428                 }
1429 
1430                 for (Extension ex : exts.getAllExtensions()) {
1431                     ObjectIdentifier inCertOID = ex.getExtensionId();
1432                     if (inCertOID.equals(findOID)) {
1433                         certExt = ex;
1434                         break;
1435                     }
1436                 }
1437             } else { // there&#39;s sub-class that can handle this extension
1438                 try {
</pre>
<hr />
<pre>
1501         } else {
1502             ExtendedKeyUsageExtension ext = getExtendedKeyUsageExtension();
1503             if (ext == null) {
1504                 return null;
1505             }
1506             extKeyUsage =
1507                 Collections.unmodifiableList(ext.getExtendedKeyUsage());
1508             return extKeyUsage;
1509         }
1510     }
1511 
1512     /**
1513      * This static method is the default implementation of the
1514      * getExtendedKeyUsage method in X509Certificate. A
1515      * X509Certificate provider generally should overwrite this to
1516      * provide among other things caching for better performance.
1517      */
1518     public static List&lt;String&gt; getExtendedKeyUsage(X509Certificate cert)
1519         throws CertificateParsingException {
1520         try {
<span class="line-modified">1521             byte[] ext = cert.getExtensionValue</span>
<span class="line-added">1522                     (KnownOIDs.extendedKeyUsage.value());</span>
1523             if (ext == null)
1524                 return null;
1525             DerValue val = new DerValue(ext);
1526             byte[] data = val.getOctetString();
1527 
1528             ExtendedKeyUsageExtension ekuExt =
1529                 new ExtendedKeyUsageExtension(Boolean.FALSE, data);
1530             return Collections.unmodifiableList(ekuExt.getExtendedKeyUsage());
1531         } catch (IOException ioe) {
1532             throw new CertificateParsingException(ioe);
1533         }
1534     }
1535 
1536     /**
1537      * Get the certificate constraints path length from
1538      * the critical BasicConstraints extension, (oid = 2.5.29.19).
1539      * @return the length of the constraint.
1540      */
1541     public int getBasicConstraints() {
1542         try {
</pre>
<hr />
<pre>
1672         try {
1673             names = subjectAltNameExt.get(
1674                     SubjectAlternativeNameExtension.SUBJECT_NAME);
1675         } catch (IOException ioe) {
1676             // should not occur
1677             return Collections.&lt;List&lt;?&gt;&gt;emptySet();
1678         }
1679         subjectAlternativeNames = makeAltNames(names);
1680         return subjectAlternativeNames;
1681     }
1682 
1683     /**
1684      * This static method is the default implementation of the
1685      * getSubjectAlternaitveNames method in X509Certificate. A
1686      * X509Certificate provider generally should overwrite this to
1687      * provide among other things caching for better performance.
1688      */
1689     public static Collection&lt;List&lt;?&gt;&gt; getSubjectAlternativeNames(X509Certificate cert)
1690         throws CertificateParsingException {
1691         try {
<span class="line-modified">1692             byte[] ext = cert.getExtensionValue</span>
<span class="line-added">1693                     (KnownOIDs.SubjectAlternativeName.value());</span>
1694             if (ext == null) {
1695                 return null;
1696             }
1697             DerValue val = new DerValue(ext);
1698             byte[] data = val.getOctetString();
1699 
1700             SubjectAlternativeNameExtension subjectAltNameExt =
1701                 new SubjectAlternativeNameExtension(Boolean.FALSE,
1702                                                     data);
1703 
1704             GeneralNames names;
1705             try {
1706                 names = subjectAltNameExt.get(
1707                         SubjectAlternativeNameExtension.SUBJECT_NAME);
1708             }  catch (IOException ioe) {
1709                 // should not occur
1710                 return Collections.&lt;List&lt;?&gt;&gt;emptySet();
1711             }
1712             return makeAltNames(names);
1713         } catch (IOException ioe) {
</pre>
<hr />
<pre>
1736         try {
1737             names = issuerAltNameExt.get(
1738                     IssuerAlternativeNameExtension.ISSUER_NAME);
1739         } catch (IOException ioe) {
1740             // should not occur
1741             return Collections.&lt;List&lt;?&gt;&gt;emptySet();
1742         }
1743         issuerAlternativeNames = makeAltNames(names);
1744         return issuerAlternativeNames;
1745     }
1746 
1747     /**
1748      * This static method is the default implementation of the
1749      * getIssuerAlternaitveNames method in X509Certificate. A
1750      * X509Certificate provider generally should overwrite this to
1751      * provide among other things caching for better performance.
1752      */
1753     public static Collection&lt;List&lt;?&gt;&gt; getIssuerAlternativeNames(X509Certificate cert)
1754         throws CertificateParsingException {
1755         try {
<span class="line-modified">1756             byte[] ext = cert.getExtensionValue</span>
<span class="line-added">1757                     (KnownOIDs.IssuerAlternativeName.value());</span>
1758             if (ext == null) {
1759                 return null;
1760             }
1761 
1762             DerValue val = new DerValue(ext);
1763             byte[] data = val.getOctetString();
1764 
1765             IssuerAlternativeNameExtension issuerAltNameExt =
1766                 new IssuerAlternativeNameExtension(Boolean.FALSE,
1767                                                     data);
1768             GeneralNames names;
1769             try {
1770                 names = issuerAltNameExt.get(
1771                         IssuerAlternativeNameExtension.ISSUER_NAME);
1772             }  catch (IOException ioe) {
1773                 // should not occur
1774                 return Collections.&lt;List&lt;?&gt;&gt;emptySet();
1775             }
1776             return makeAltNames(names);
1777         } catch (IOException ioe) {
</pre>
</td>
</tr>
</table>
<center><a href="X509CRLImpl.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../legal/icu.md.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>