<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/sun/nio/ch/DatagramSocketAdaptor.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../module-info.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="Net.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/nio/ch/DatagramSocketAdaptor.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 57 import static java.util.concurrent.TimeUnit.MILLISECONDS;
 58 
 59 /**
 60  * A multicast datagram socket based on a datagram channel.
 61  *
 62  * This class overrides every public method defined by java.net.DatagramSocket
 63  * and java.net.MulticastSocket. The methods in this class are defined in exactly
 64  * the same order as in java.net.DatagramSocket and java.net.MulticastSocket so
 65  * as to simplify tracking changes.
 66  */
 67 public class DatagramSocketAdaptor
 68     extends MulticastSocket
 69 {
 70     // The channel being adapted
 71     private final DatagramChannelImpl dc;
 72 
 73     // Timeout &quot;option&quot; value for receives
 74     private volatile int timeout;
 75 
 76     private DatagramSocketAdaptor(DatagramChannelImpl dc) throws IOException {
<span class="line-modified"> 77         super(/*SocketAddress*/null);</span>
 78         this.dc = dc;
 79     }
 80 
 81     static DatagramSocket create(DatagramChannelImpl dc) {
 82         try {
 83             return new DatagramSocketAdaptor(dc);
 84         } catch (IOException e) {
 85             throw new Error(e);
 86         }
 87     }
 88 
 89     private void connectInternal(SocketAddress remote) throws SocketException {
 90         try {
 91             dc.connect(remote, false); // skips check for already connected
 92         } catch (ClosedChannelException e) {
 93             // ignore
 94         } catch (Exception x) {
 95             Net.translateToSocketException(x);
 96         }
 97     }
</pre>
<hr />
<pre>
752          */
753         static NetworkInterface getDefault() {
754             try {
755                 return (NetworkInterface) GET_DEFAULT.invokeExact();
756             } catch (Throwable e) {
757                 throw new InternalError(e);
758             }
759         }
760 
761         /**
762          * Creates a NetworkInterface with the given name index and addresses.
763          */
764         static NetworkInterface newNetworkInterface(String name, int index, InetAddress[] addrs) {
765             try {
766                 return (NetworkInterface) CONSTRUCTOR.invoke(name, index, addrs);
767             } catch (Throwable e) {
768                 throw new InternalError(e);
769             }
770         }
771     }




















772 }
</pre>
</td>
<td>
<hr />
<pre>
 57 import static java.util.concurrent.TimeUnit.MILLISECONDS;
 58 
 59 /**
 60  * A multicast datagram socket based on a datagram channel.
 61  *
 62  * This class overrides every public method defined by java.net.DatagramSocket
 63  * and java.net.MulticastSocket. The methods in this class are defined in exactly
 64  * the same order as in java.net.DatagramSocket and java.net.MulticastSocket so
 65  * as to simplify tracking changes.
 66  */
 67 public class DatagramSocketAdaptor
 68     extends MulticastSocket
 69 {
 70     // The channel being adapted
 71     private final DatagramChannelImpl dc;
 72 
 73     // Timeout &quot;option&quot; value for receives
 74     private volatile int timeout;
 75 
 76     private DatagramSocketAdaptor(DatagramChannelImpl dc) throws IOException {
<span class="line-modified"> 77         super(/*SocketAddress*/ DatagramSockets.NO_DELEGATE);</span>
 78         this.dc = dc;
 79     }
 80 
 81     static DatagramSocket create(DatagramChannelImpl dc) {
 82         try {
 83             return new DatagramSocketAdaptor(dc);
 84         } catch (IOException e) {
 85             throw new Error(e);
 86         }
 87     }
 88 
 89     private void connectInternal(SocketAddress remote) throws SocketException {
 90         try {
 91             dc.connect(remote, false); // skips check for already connected
 92         } catch (ClosedChannelException e) {
 93             // ignore
 94         } catch (Exception x) {
 95             Net.translateToSocketException(x);
 96         }
 97     }
</pre>
<hr />
<pre>
752          */
753         static NetworkInterface getDefault() {
754             try {
755                 return (NetworkInterface) GET_DEFAULT.invokeExact();
756             } catch (Throwable e) {
757                 throw new InternalError(e);
758             }
759         }
760 
761         /**
762          * Creates a NetworkInterface with the given name index and addresses.
763          */
764         static NetworkInterface newNetworkInterface(String name, int index, InetAddress[] addrs) {
765             try {
766                 return (NetworkInterface) CONSTRUCTOR.invoke(name, index, addrs);
767             } catch (Throwable e) {
768                 throw new InternalError(e);
769             }
770         }
771     }
<span class="line-added">772 </span>
<span class="line-added">773     /**</span>
<span class="line-added">774      * Provides access to the value of the private static DatagramSocket.NO_DELEGATE</span>
<span class="line-added">775      */</span>
<span class="line-added">776     private static class DatagramSockets {</span>
<span class="line-added">777         private static final SocketAddress NO_DELEGATE;</span>
<span class="line-added">778 </span>
<span class="line-added">779         static {</span>
<span class="line-added">780             try {</span>
<span class="line-added">781                 PrivilegedExceptionAction&lt;Lookup&gt; pa = () -&gt;</span>
<span class="line-added">782                         MethodHandles.privateLookupIn(DatagramSocket.class, MethodHandles.lookup());</span>
<span class="line-added">783                 MethodHandles.Lookup l = AccessController.doPrivileged(pa);</span>
<span class="line-added">784                 NO_DELEGATE = (SocketAddress)</span>
<span class="line-added">785                         l.findStaticVarHandle(DatagramSocket.class, &quot;NO_DELEGATE&quot;,</span>
<span class="line-added">786                                 SocketAddress.class).get();</span>
<span class="line-added">787             } catch (Exception e) {</span>
<span class="line-added">788                 throw new ExceptionInInitializerError(e);</span>
<span class="line-added">789             }</span>
<span class="line-added">790         }</span>
<span class="line-added">791     }</span>
792 }
</pre>
</td>
</tr>
</table>
<center><a href="../../../module-info.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="Net.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>