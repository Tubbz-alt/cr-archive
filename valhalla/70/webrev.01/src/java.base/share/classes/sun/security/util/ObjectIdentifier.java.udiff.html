<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.base/share/classes/sun/security/util/ObjectIdentifier.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="NamedCurve.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="SecurityProviderConstants.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/util/ObjectIdentifier.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -26,10 +26,11 @@</span>
  package sun.security.util;
  
  import java.io.*;
  import java.math.BigInteger;
  import java.util.Arrays;
<span class="udiff-line-added">+ import java.util.concurrent.ConcurrentHashMap;</span>
  
  /**
   * Represent an ISO Object Identifier.
   *
   * &lt;P&gt;Object Identifiers are arbitrary length hierarchical identifiers.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -146,11 +147,11 @@</span>
  
      /**
       * Constructs, from a string.  This string should be of the form 1.23.56.
       * Validity check included.
       */
<span class="udiff-line-modified-removed">-     public ObjectIdentifier(String oid) throws IOException {</span>
<span class="udiff-line-modified-added">+     private ObjectIdentifier(String oid) throws IOException {</span>
          int ch = &#39;.&#39;;
          int start = 0;
          int end = 0;
  
          int pos = 0;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -288,22 +289,46 @@</span>
          }
          encoding = new byte[pos];
          System.arraycopy(tmp, 0, encoding, 0, pos);
      }
  
<span class="udiff-line-added">+     // oid cache index&#39;ed by the oid string</span>
<span class="udiff-line-added">+     private static ConcurrentHashMap&lt;String,ObjectIdentifier&gt; oidTable =</span>
<span class="udiff-line-added">+             new ConcurrentHashMap&lt;&gt;();</span>
<span class="udiff-line-added">+ </span>
      /**
<span class="udiff-line-modified-removed">-      * Returns an ObjectIdentifier instance for the specific string OID.</span>
<span class="udiff-line-modified-added">+      * Returns an ObjectIdentifier instance for the specific String.</span>
       *
<span class="udiff-line-modified-removed">-      * Note: Please use legal string OID only.  Otherwise, a RuntimeException</span>
<span class="udiff-line-removed">-      * is thrown.</span>
<span class="udiff-line-modified-added">+      * If the String is not a valid OID string, an IOException is thrown.</span>
       */
<span class="udiff-line-modified-removed">-     public static ObjectIdentifier of(String oid) {</span>
<span class="udiff-line-modified-removed">-         try {</span>
<span class="udiff-line-modified-removed">-             return new ObjectIdentifier(oid);</span>
<span class="udiff-line-modified-removed">-         } catch (IOException ioe) {</span>
<span class="udiff-line-modified-removed">-             throw new RuntimeException(ioe);</span>
<span class="udiff-line-modified-added">+     public static ObjectIdentifier of(String oidStr) throws IOException {</span>
<span class="udiff-line-modified-added">+         // check cache first</span>
<span class="udiff-line-modified-added">+         ObjectIdentifier oid = oidTable.get(oidStr);</span>
<span class="udiff-line-modified-added">+         if (oid == null) {</span>
<span class="udiff-line-modified-added">+             oid = new ObjectIdentifier(oidStr);</span>
<span class="udiff-line-added">+             oidTable.put(oidStr, oid);</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+         return oid;</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     /**</span>
<span class="udiff-line-added">+      * Returns an ObjectIdentifier instance for the specific KnownOIDs.</span>
<span class="udiff-line-added">+      */</span>
<span class="udiff-line-added">+     public static ObjectIdentifier of(KnownOIDs o) {</span>
<span class="udiff-line-added">+         // check cache first</span>
<span class="udiff-line-added">+         String oidStr = o.value();</span>
<span class="udiff-line-added">+         ObjectIdentifier oid = oidTable.get(oidStr);</span>
<span class="udiff-line-added">+         if (oid == null) {</span>
<span class="udiff-line-added">+             try {</span>
<span class="udiff-line-added">+                 oid = new ObjectIdentifier(oidStr);</span>
<span class="udiff-line-added">+             } catch (IOException ioe) {</span>
<span class="udiff-line-added">+                 // should not happen as oid string for KnownOIDs is internal</span>
<span class="udiff-line-added">+                 throw new RuntimeException(ioe);</span>
<span class="udiff-line-added">+             }</span>
<span class="udiff-line-added">+             oidTable.put(oidStr, oid);</span>
          }
<span class="udiff-line-added">+         return oid;</span>
      }
  
      /*
       * n.b. the only public interface is DerOutputStream.putOID()
       */
</pre>
<center><a href="NamedCurve.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="SecurityProviderConstants.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>