<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames src/java.base/share/classes/sun/security/util/SecurityProviderConstants.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 2017, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package sun.security.util;
 27 
<a name="2" id="anc2"></a>

 28 import java.util.regex.PatternSyntaxException;
 29 import java.security.InvalidParameterException;
<a name="3" id="anc3"></a>
 30 import sun.security.action.GetPropertyAction;
 31 
 32 /**
 33  * Various constants such as version number, default key length, used by
 34  * the JDK security/crypto providers.
 35  */
 36 public final class SecurityProviderConstants {
<a name="4" id="anc4"></a>


 37     private static final Debug debug =
 38         Debug.getInstance(&quot;jca&quot;, &quot;ProviderConfig&quot;);
 39 
<a name="5" id="anc5"></a><span class="line-modified"> 40     // Cannot create one of these</span>
<span class="line-modified"> 41     private SecurityProviderConstants () {</span>













































 42     }
 43 
 44     public static final int getDefDSASubprimeSize(int primeSize) {
 45         if (primeSize &lt;= 1024) {
 46             return 160;
 47         } else if (primeSize == 2048) {
 48             return 224;
 49         } else if (primeSize == 3072) {
 50             return 256;
 51         } else {
 52             throw new InvalidParameterException(&quot;Invalid DSA Prime Size: &quot; +
 53                 primeSize);
 54         }
 55     }
 56 
 57     public static final int DEF_DSA_KEY_SIZE;
 58     public static final int DEF_RSA_KEY_SIZE;
 59     public static final int DEF_RSASSA_PSS_KEY_SIZE;
 60     public static final int DEF_DH_KEY_SIZE;
 61     public static final int DEF_EC_KEY_SIZE;
<a name="6" id="anc6"></a>
 62 
 63     private static final String KEY_LENGTH_PROP =
 64         &quot;jdk.security.defaultKeySize&quot;;
<a name="7" id="anc7"></a>
 65     static {
 66         String keyLengthStr = GetPropertyAction.privilegedGetProperty
 67             (KEY_LENGTH_PROP);
 68         int dsaKeySize = 2048;
 69         int rsaKeySize = 2048;
 70         int rsaSsaPssKeySize = rsaKeySize; // default to same value as RSA
 71         int dhKeySize = 2048;
 72         int ecKeySize = 256;
<a name="8" id="anc8"></a>
 73 
 74         if (keyLengthStr != null) {
 75             try {
 76                 String[] pairs = keyLengthStr.split(&quot;,&quot;);
 77                 for (String p : pairs) {
 78                     String[] algoAndValue = p.split(&quot;:&quot;);
 79                     if (algoAndValue.length != 2) {
 80                         // invalid pair, skip to next pair
 81                         if (debug != null) {
 82                             debug.println(&quot;Ignoring invalid pair in &quot; +
 83                                 KEY_LENGTH_PROP + &quot; property: &quot; + p);
 84                         }
 85                         continue;
 86                     }
 87                     String algoName = algoAndValue[0].trim().toUpperCase();
 88                     int value = -1;
 89                     try {
 90                         value = Integer.parseInt(algoAndValue[1].trim());
 91                     } catch (NumberFormatException nfe) {
 92                         // invalid value, skip to next pair
 93                         if (debug != null) {
 94                             debug.println(&quot;Ignoring invalid value in &quot; +
 95                                 KEY_LENGTH_PROP + &quot; property: &quot; + p);
 96                         }
 97                         continue;
 98                     }
 99                     if (algoName.equals(&quot;DSA&quot;)) {
100                         dsaKeySize = value;
101                     } else if (algoName.equals(&quot;RSA&quot;)) {
102                         rsaKeySize = value;
103                     } else if (algoName.equals(&quot;RSASSA-PSS&quot;)) {
104                         rsaSsaPssKeySize = value;
105                     } else if (algoName.equals(&quot;DH&quot;)) {
106                         dhKeySize = value;
107                     } else if (algoName.equals(&quot;EC&quot;)) {
108                         ecKeySize = value;
<a name="9" id="anc9"></a>

109                     } else {
110                         if (debug != null) {
111                             debug.println(&quot;Ignoring unsupported algo in &quot; +
112                                 KEY_LENGTH_PROP + &quot; property: &quot; + p);
113                         }
114                         continue;
115                     }
116                     if (debug != null) {
117                         debug.println(&quot;Overriding default &quot; + algoName +
118                             &quot; keysize with value from &quot; +
119                             KEY_LENGTH_PROP + &quot; property: &quot; + value);
120                     }
121                 }
122             } catch (PatternSyntaxException pse) {
123                 // if property syntax is not followed correctly
124                 if (debug != null) {
125                     debug.println(&quot;Unexpected exception while parsing &quot; +
126                         KEY_LENGTH_PROP + &quot; property: &quot; + pse);
127                 }
128             }
129         }
130         DEF_DSA_KEY_SIZE = dsaKeySize;
131         DEF_RSA_KEY_SIZE = rsaKeySize;
132         DEF_RSASSA_PSS_KEY_SIZE = rsaSsaPssKeySize;
133         DEF_DH_KEY_SIZE = dhKeySize;
134         DEF_EC_KEY_SIZE = ecKeySize;
<a name="10" id="anc10"></a>


































135     }
136 }
<a name="11" id="anc11"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="11" type="hidden" />
</body>
</html>