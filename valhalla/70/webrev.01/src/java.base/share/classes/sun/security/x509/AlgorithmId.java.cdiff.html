<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/sun/security/x509/AlgorithmId.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="AccessDescription.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ExtendedKeyUsageExtension.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/x509/AlgorithmId.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 26,15 ***</span>
<span class="line-new-header">--- 26,18 ---</span>
  package sun.security.x509;
  
  import java.io.*;
  import java.security.interfaces.RSAKey;
  import java.security.spec.AlgorithmParameterSpec;
<span class="line-added">+ import java.security.spec.EdDSAParameterSpec;</span>
  import java.security.spec.InvalidParameterSpecException;
  import java.security.spec.MGF1ParameterSpec;
  import java.security.spec.PSSParameterSpec;
  import java.util.*;
<span class="line-added">+ import java.util.concurrent.ConcurrentHashMap;</span>
  import java.security.*;
<span class="line-added">+ import java.security.interfaces.*;</span>
  
  import sun.security.rsa.PSSParameters;
  import sun.security.util.*;
  
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 197,11 ***</span>
                  algid.equals((Object)sha1WithDSA_oid)) {
                  ; // no parameter part encoded
              } else {
                  bytes.putNull();
              }*/
<span class="line-modified">!             if (algid.equals(RSASSA_PSS_oid)) {</span>
                  // RFC 4055 3.3: when an RSASSA-PSS key does not require
                  // parameter validation, field is absent.
              } else {
                  bytes.putNull();
              }
<span class="line-new-header">--- 200,12 ---</span>
                  algid.equals((Object)sha1WithDSA_oid)) {
                  ; // no parameter part encoded
              } else {
                  bytes.putNull();
              }*/
<span class="line-modified">!             if (algid.equals(RSASSA_PSS_oid) || algid.equals(ed448_oid)</span>
<span class="line-added">+                     || algid.equals(ed25519_oid)) {</span>
                  // RFC 4055 3.3: when an RSASSA-PSS key does not require
                  // parameter validation, field is absent.
              } else {
                  bytes.putNull();
              }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 243,25 ***</span>
       *
       * Note: for ecdsa-with-SHA2 plus hash algorithm (Ex: SHA-256), this method
       * returns the &quot;full&quot; signature algorithm (Ex: SHA256withECDSA) directly.
       */
      public String getName() {
<span class="line-modified">!         String algName = nameTable.get(algid);</span>
<span class="line-modified">!         if (algName != null) {</span>
<span class="line-modified">!             return algName;</span>
<span class="line-modified">!         }</span>
<span class="line-modified">!         if ((params != null) &amp;&amp; algid.equals((Object)specifiedWithECDSA_oid)) {</span>
<span class="line-modified">!             try {</span>
<span class="line-modified">!                 AlgorithmId paramsId =</span>
                          AlgorithmId.parse(new DerValue(params.toByteArray()));
<span class="line-modified">!                 String paramsName = paramsId.getName();</span>
<span class="line-modified">!                 algName = makeSigAlg(paramsName, &quot;EC&quot;);</span>
<span class="line-modified">!             } catch (IOException e) {</span>
<span class="line-modified">!                 // ignore</span>
              }
          }
<span class="line-removed">-         return (algName == null) ? algid.toString() : algName;</span>
      }
  
      public AlgorithmParameters getParameters() {
          return algParams;
      }
<span class="line-new-header">--- 247,35 ---</span>
       *
       * Note: for ecdsa-with-SHA2 plus hash algorithm (Ex: SHA-256), this method
       * returns the &quot;full&quot; signature algorithm (Ex: SHA256withECDSA) directly.
       */
      public String getName() {
<span class="line-modified">!         String oidStr = algid.toString();</span>
<span class="line-modified">!         // first check the list of support oids</span>
<span class="line-modified">!         KnownOIDs o = KnownOIDs.findMatch(oidStr);</span>
<span class="line-modified">!         if (o == KnownOIDs.SpecifiedSHA2withECDSA) {</span>
<span class="line-modified">!             if (params != null) {</span>
<span class="line-modified">!                 try {</span>
<span class="line-modified">!                     AlgorithmId paramsId =</span>
                          AlgorithmId.parse(new DerValue(params.toByteArray()));
<span class="line-modified">!                     String paramsName = paramsId.getName();</span>
<span class="line-modified">!                     return makeSigAlg(paramsName, &quot;EC&quot;);</span>
<span class="line-modified">!                 } catch (IOException e) {</span>
<span class="line-modified">!                     // ignore</span>
<span class="line-added">+                 }</span>
<span class="line-added">+             }</span>
<span class="line-added">+         }</span>
<span class="line-added">+         if (o != null) {</span>
<span class="line-added">+             return o.stdName();</span>
<span class="line-added">+         } else {</span>
<span class="line-added">+             String n = aliasOidsTable().get(oidStr);</span>
<span class="line-added">+             if (n != null) {</span>
<span class="line-added">+                 return n;</span>
<span class="line-added">+             } else {</span>
<span class="line-added">+                 return algid.toString();</span>
              }
          }
      }
  
      public AlgorithmParameters getParameters() {
          return algParams;
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 275,11 ***</span>
       * signature algorithm (Ex: SHA256withECDSA).
       *
       * @return DER encoded parameters, or null not present.
       */
      public byte[] getEncodedParams() throws IOException {
<span class="line-modified">!         return (params == null || algid.equals(specifiedWithECDSA_oid))</span>
                  ? null
                  : params.toByteArray();
      }
  
      /**
<span class="line-new-header">--- 289,12 ---</span>
       * signature algorithm (Ex: SHA256withECDSA).
       *
       * @return DER encoded parameters, or null not present.
       */
      public byte[] getEncodedParams() throws IOException {
<span class="line-modified">!         return (params == null ||</span>
<span class="line-added">+             algid.toString().equals(KnownOIDs.SpecifiedSHA2withECDSA.value()))</span>
                  ? null
                  : params.toByteArray();
      }
  
      /**
</pre>
<hr />
<pre>
<span class="line-old-header">*** 469,496 ***</span>
       * scope of the algorithm name to it, e.g., the algorithm name &quot;DSA&quot;
       * may have a different OID when used as a &quot;Signature&quot; algorithm than when
       * used as a &quot;KeyPairGenerator&quot; algorithm.
       */
      private static ObjectIdentifier algOID(String name) throws IOException {
<span class="line-modified">!         // See if algname is in printable OID (&quot;dot-dot&quot;) notation</span>
<span class="line-modified">!         if (name.indexOf(&#39;.&#39;) != -1) {</span>
<span class="line-removed">-             if (name.startsWith(&quot;OID.&quot;)) {</span>
<span class="line-removed">-                 return new ObjectIdentifier(name.substring(&quot;OID.&quot;.length()));</span>
<span class="line-removed">-             } else {</span>
<span class="line-removed">-                 return new ObjectIdentifier(name);</span>
<span class="line-removed">-             }</span>
          }
  
<span class="line-modified">!         // Digesting algorithms</span>
<span class="line-modified">!         if (name.equalsIgnoreCase(&quot;MD5&quot;)) {</span>
<span class="line-modified">!             return AlgorithmId.MD5_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;MD2&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.MD2_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA&quot;) || name.equalsIgnoreCase(&quot;SHA1&quot;)</span>
<span class="line-removed">-             || name.equalsIgnoreCase(&quot;SHA-1&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.SHA_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA-256&quot;) ||</span>
<span class="line-removed">-             name.equalsIgnoreCase(&quot;SHA256&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.SHA256_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA-384&quot;) ||</span>
<span class="line-removed">-             name.equalsIgnoreCase(&quot;SHA384&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.SHA384_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA-512&quot;) ||</span>
<span class="line-removed">-             name.equalsIgnoreCase(&quot;SHA512&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.SHA512_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA-224&quot;) ||</span>
<span class="line-removed">-             name.equalsIgnoreCase(&quot;SHA224&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.SHA224_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA-512/224&quot;) ||</span>
<span class="line-removed">-             name.equalsIgnoreCase(&quot;SHA512/224&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.SHA512_224_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA-512/256&quot;) ||</span>
<span class="line-removed">-             name.equalsIgnoreCase(&quot;SHA512/256&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.SHA512_256_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         // Various public key algorithms</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;RSA&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.RSAEncryption_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;RSASSA-PSS&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.RSASSA_PSS_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;RSAES-OAEP&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.RSAES_OAEP_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;Diffie-Hellman&quot;)</span>
<span class="line-removed">-             || name.equalsIgnoreCase(&quot;DH&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.DH_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;DSA&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.DSA_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;EC&quot;)) {</span>
<span class="line-removed">-             return EC_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;ECDH&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.ECDH_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         // Secret key algorithms</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;AES&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.AES_oid;</span>
          }
  
<span class="line-modified">!         // Common signature types</span>
<span class="line-modified">!         if (name.equalsIgnoreCase(&quot;MD5withRSA&quot;)</span>
<span class="line-modified">!             || name.equalsIgnoreCase(&quot;MD5/RSA&quot;)) {</span>
<span class="line-modified">!             return AlgorithmId.md5WithRSAEncryption_oid;</span>
<span class="line-modified">!         }</span>
<span class="line-modified">!         if (name.equalsIgnoreCase(&quot;MD2withRSA&quot;)</span>
<span class="line-modified">!             || name.equalsIgnoreCase(&quot;MD2/RSA&quot;)) {</span>
<span class="line-modified">!             return AlgorithmId.md2WithRSAEncryption_oid;</span>
<span class="line-modified">!         }</span>
<span class="line-modified">!         if (name.equalsIgnoreCase(&quot;SHAwithDSA&quot;)</span>
<span class="line-modified">!             || name.equalsIgnoreCase(&quot;SHA1withDSA&quot;)</span>
<span class="line-removed">-             || name.equalsIgnoreCase(&quot;SHA/DSA&quot;)</span>
<span class="line-removed">-             || name.equalsIgnoreCase(&quot;SHA1/DSA&quot;)</span>
<span class="line-removed">-             || name.equalsIgnoreCase(&quot;DSAWithSHA1&quot;)</span>
<span class="line-removed">-             || name.equalsIgnoreCase(&quot;DSS&quot;)</span>
<span class="line-removed">-             || name.equalsIgnoreCase(&quot;SHA-1/DSA&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.sha1WithDSA_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA224WithDSA&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.sha224WithDSA_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA256WithDSA&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.sha256WithDSA_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA1WithRSA&quot;)</span>
<span class="line-removed">-             || name.equalsIgnoreCase(&quot;SHA1/RSA&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.sha1WithRSAEncryption_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA1withECDSA&quot;)</span>
<span class="line-removed">-                 || name.equalsIgnoreCase(&quot;ECDSA&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.sha1WithECDSA_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA224withECDSA&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.sha224WithECDSA_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA256withECDSA&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.sha256WithECDSA_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA384withECDSA&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.sha384WithECDSA_oid;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         if (name.equalsIgnoreCase(&quot;SHA512withECDSA&quot;)) {</span>
<span class="line-removed">-             return AlgorithmId.sha512WithECDSA_oid;</span>
          }
<span class="line-removed">- </span>
<span class="line-removed">-         return oidTable().get(name.toUpperCase(Locale.ENGLISH));</span>
      }
  
<span class="line-modified">!     private static volatile Map&lt;String,ObjectIdentifier&gt; oidTable;</span>
<span class="line-modified">!     private static final Map&lt;ObjectIdentifier,String&gt; nameTable;</span>
  
<span class="line-modified">!     /** Returns the oidTable, lazily initializing it on first access. */</span>
<span class="line-modified">!     private static Map&lt;String,ObjectIdentifier&gt; oidTable()</span>
<span class="line-modified">!         throws IOException {</span>
<span class="line-modified">!         // Double checked locking; safe because oidTable is volatile</span>
<span class="line-modified">!         Map&lt;String,ObjectIdentifier&gt; tab;</span>
<span class="line-removed">-         if ((tab = oidTable) == null) {</span>
              synchronized (AlgorithmId.class) {
<span class="line-modified">!                 if ((tab = oidTable) == null)</span>
<span class="line-modified">!                     oidTable = tab = computeOidTable();</span>
              }
          }
          return tab;
      }
  
<span class="line-modified">!     /** Collects the algorithm names from the installed providers. */</span>
<span class="line-modified">!     private static HashMap&lt;String,ObjectIdentifier&gt; computeOidTable()</span>
<span class="line-modified">!         throws IOException {</span>
<span class="line-modified">!         HashMap&lt;String,ObjectIdentifier&gt; tab = new HashMap&lt;&gt;();</span>
          for (Provider provider : Security.getProviders()) {
              for (Object key : provider.keySet()) {
                  String alias = (String)key;
                  String upperCaseAlias = alias.toUpperCase(Locale.ENGLISH);
                  int index;
                  if (upperCaseAlias.startsWith(&quot;ALG.ALIAS&quot;) &amp;&amp;
<span class="line-modified">!                     (index=upperCaseAlias.indexOf(&quot;OID.&quot;, 0)) != -1) {</span>
                      index += &quot;OID.&quot;.length();
                      if (index == alias.length()) {
                          // invalid alias entry
                          break;
                      }
<span class="line-modified">!                     String oidString = alias.substring(index);</span>
                      String stdAlgName = provider.getProperty(alias);
                      if (stdAlgName != null) {
                          stdAlgName = stdAlgName.toUpperCase(Locale.ENGLISH);
                      }
<span class="line-modified">!                     if (stdAlgName != null &amp;&amp;</span>
<span class="line-modified">!                         tab.get(stdAlgName) == null) {</span>
<span class="line-modified">!                         tab.put(stdAlgName, new ObjectIdentifier(oidString));</span>
                      }
                  }
              }
          }
<span class="line-modified">!         return tab;</span>
      }
  
<span class="line-removed">-     /*****************************************************************/</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /*</span>
<span class="line-removed">-      * HASHING ALGORITHMS</span>
<span class="line-removed">-      */</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Algorithm ID for the MD2 Message Digest Algorthm, from RFC 1319.</span>
<span class="line-removed">-      * OID = 1.2.840.113549.2.2</span>
<span class="line-removed">-      */</span>
      public static final ObjectIdentifier MD2_oid =
<span class="line-modified">!         ObjectIdentifier.of(&quot;1.2.840.113549.2.2&quot;);</span>
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Algorithm ID for the MD5 Message Digest Algorthm, from RFC 1321.</span>
<span class="line-removed">-      * OID = 1.2.840.113549.2.5</span>
<span class="line-removed">-      */</span>
      public static final ObjectIdentifier MD5_oid =
<span class="line-modified">!         ObjectIdentifier.of(&quot;1.2.840.113549.2.5&quot;);</span>
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Algorithm ID for the SHA1 Message Digest Algorithm, from FIPS 180-1.</span>
<span class="line-removed">-      * This is sometimes called &quot;SHA&quot;, though that is often confusing since</span>
<span class="line-removed">-      * many people refer to FIPS 180 (which has an error) as defining SHA.</span>
<span class="line-removed">-      * OID = 1.3.14.3.2.26. Old SHA-0 OID: 1.3.14.3.2.18.</span>
<span class="line-removed">-      */</span>
      public static final ObjectIdentifier SHA_oid =
<span class="line-modified">!         ObjectIdentifier.of(&quot;1.3.14.3.2.26&quot;);</span>
  
      public static final ObjectIdentifier SHA224_oid =
<span class="line-modified">!         ObjectIdentifier.of(&quot;2.16.840.1.101.3.4.2.4&quot;);</span>
  
      public static final ObjectIdentifier SHA256_oid =
<span class="line-modified">!         ObjectIdentifier.of(&quot;2.16.840.1.101.3.4.2.1&quot;);</span>
  
      public static final ObjectIdentifier SHA384_oid =
<span class="line-modified">!         ObjectIdentifier.of(&quot;2.16.840.1.101.3.4.2.2&quot;);</span>
  
      public static final ObjectIdentifier SHA512_oid =
<span class="line-modified">!         ObjectIdentifier.of(&quot;2.16.840.1.101.3.4.2.3&quot;);</span>
  
      public static final ObjectIdentifier SHA512_224_oid =
<span class="line-modified">!         ObjectIdentifier.of(&quot;2.16.840.1.101.3.4.2.5&quot;);</span>
  
      public static final ObjectIdentifier SHA512_256_oid =
<span class="line-modified">!         ObjectIdentifier.of(&quot;2.16.840.1.101.3.4.2.6&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /*</span>
<span class="line-removed">-      * COMMON PUBLIC KEY TYPES</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     /*</span>
<span class="line-removed">-      * Note the preferred OIDs are named simply with no &quot;OIW&quot; or</span>
<span class="line-removed">-      * &quot;PKIX&quot; in them, even though they may point to data from these</span>
<span class="line-removed">-      * specs; e.g. SHA_oid, DH_oid, DSA_oid, SHA1WithDSA_oid...</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Algorithm ID for Diffie Hellman Key agreement, from PKCS #3.</span>
<span class="line-removed">-      * Parameters include public values P and G, and may optionally specify</span>
<span class="line-removed">-      * the length of the private key X.  Alternatively, algorithm parameters</span>
<span class="line-removed">-      * may be derived from another source such as a Certificate Authority&#39;s</span>
<span class="line-removed">-      * certificate.</span>
<span class="line-removed">-      * OID = 1.2.840.113549.1.3.1</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier DH_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.3.1&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Algorithm ID for the Diffie Hellman Key Agreement (DH), from RFC 3279.</span>
<span class="line-removed">-      * Parameters may include public values P and G.</span>
<span class="line-removed">-      * OID = 1.2.840.10046.2.1</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier DH_PKIX_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.10046.2.1&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Algorithm ID for the Digital Signing Algorithm (DSA), from the</span>
<span class="line-removed">-      * NIST OIW Stable Agreements part 12.</span>
<span class="line-removed">-      * Parameters may include public values P, Q, and G; or these may be</span>
<span class="line-removed">-      * derived from</span>
<span class="line-removed">-      * another source such as a Certificate Authority&#39;s certificate.</span>
<span class="line-removed">-      * OID = 1.3.14.3.2.12</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier DSA_OIW_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.3.14.3.2.12&quot;);</span>
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Algorithm ID for the Digital Signing Algorithm (DSA), from RFC 3279.</span>
<span class="line-removed">-      * Parameters may include public values P, Q, and G; or these may be</span>
<span class="line-removed">-      * derived from another source such as a Certificate Authority&#39;s</span>
<span class="line-removed">-      * certificate.</span>
<span class="line-removed">-      * OID = 1.2.840.10040.4.1</span>
<span class="line-removed">-      */</span>
      public static final ObjectIdentifier DSA_oid =
<span class="line-modified">!             ObjectIdentifier.of(&quot;1.2.840.10040.4.1&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Algorithm ID for RSA keys used for any purpose, as defined in X.509.</span>
<span class="line-removed">-      * The algorithm parameter is a single value, the number of bits in the</span>
<span class="line-removed">-      * public modulus.</span>
<span class="line-removed">-      * OID = 2.5.8.1.1</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier RSA_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;2.5.8.1.1&quot;);</span>
  
      public static final ObjectIdentifier EC_oid =
<span class="line-modified">!             ObjectIdentifier.of(&quot;1.2.840.10045.2.1&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier ECDH_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.3.132.1.12&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier RSAEncryption_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.1.1&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier RSAES_OAEP_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.1.7&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier mgf1_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.1.8&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier RSASSA_PSS_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.1.10&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /*</span>
<span class="line-removed">-      * COMMON SECRET KEY TYPES</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier AES_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;2.16.840.1.101.3.4.1&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /*</span>
<span class="line-removed">-      * COMMON SIGNATURE ALGORITHMS</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Identifies a signing algorithm where an MD2 digest is encrypted</span>
<span class="line-removed">-      * using an RSA private key; defined in PKCS #1.  Use of this</span>
<span class="line-removed">-      * signing algorithm is discouraged due to MD2 vulnerabilities.</span>
<span class="line-removed">-      * OID = 1.2.840.113549.1.1.2</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier md2WithRSAEncryption_oid =</span>
<span class="line-removed">-         ObjectIdentifier.of(&quot;1.2.840.113549.1.1.2&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Identifies a signing algorithm where an MD5 digest is</span>
<span class="line-removed">-      * encrypted using an RSA private key; defined in PKCS #1.</span>
<span class="line-removed">-      * OID = 1.2.840.113549.1.1.4</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier md5WithRSAEncryption_oid =</span>
<span class="line-removed">-         ObjectIdentifier.of(&quot;1.2.840.113549.1.1.4&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Identifies a signing algorithm where a SHA1 digest is</span>
<span class="line-removed">-      * encrypted using an RSA private key; defined by RSA DSI.</span>
<span class="line-removed">-      * OID = 1.2.840.113549.1.1.5</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier sha1WithRSAEncryption_oid =</span>
<span class="line-removed">-         ObjectIdentifier.of(&quot;1.2.840.113549.1.1.5&quot;);</span>
  
<span class="line-modified">!     /**</span>
<span class="line-modified">!      * Identifies a signing algorithm where a SHA1 digest is</span>
<span class="line-removed">-      * encrypted using an RSA private key; defined in NIST OIW.</span>
<span class="line-removed">-      * OID = 1.3.14.3.2.29</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier sha1WithRSAEncryption_OIW_oid =</span>
<span class="line-removed">-         ObjectIdentifier.of(&quot;1.3.14.3.2.29&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Identifies a signing algorithm where a SHA224 digest is</span>
<span class="line-removed">-      * encrypted using an RSA private key; defined by PKCS #1.</span>
<span class="line-removed">-      * OID = 1.2.840.113549.1.1.14</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier sha224WithRSAEncryption_oid =</span>
<span class="line-removed">-         ObjectIdentifier.of(&quot;1.2.840.113549.1.1.14&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Identifies a signing algorithm where a SHA256 digest is</span>
<span class="line-removed">-      * encrypted using an RSA private key; defined by PKCS #1.</span>
<span class="line-removed">-      * OID = 1.2.840.113549.1.1.11</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier sha256WithRSAEncryption_oid =</span>
<span class="line-removed">-         ObjectIdentifier.of(&quot;1.2.840.113549.1.1.11&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Identifies a signing algorithm where a SHA384 digest is</span>
<span class="line-removed">-      * encrypted using an RSA private key; defined by PKCS #1.</span>
<span class="line-removed">-      * OID = 1.2.840.113549.1.1.12</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier sha384WithRSAEncryption_oid =</span>
<span class="line-removed">-         ObjectIdentifier.of(&quot;1.2.840.113549.1.1.12&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Identifies a signing algorithm where a SHA512 digest is</span>
<span class="line-removed">-      * encrypted using an RSA private key; defined by PKCS #1.</span>
<span class="line-removed">-      * OID = 1.2.840.113549.1.1.13</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier sha512WithRSAEncryption_oid =</span>
<span class="line-removed">-         ObjectIdentifier.of(&quot;1.2.840.113549.1.1.13&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Identifies the FIPS 186 &quot;Digital Signature Standard&quot; (DSS), where a</span>
<span class="line-removed">-      * SHA digest is signed using the Digital Signing Algorithm (DSA).</span>
<span class="line-removed">-      * This should not be used.</span>
<span class="line-removed">-      * OID = 1.3.14.3.2.13</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier shaWithDSA_OIW_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.3.14.3.2.13&quot;);</span>
  
<span class="line-modified">!     /**</span>
<span class="line-modified">!      * Identifies the FIPS 186 &quot;Digital Signature Standard&quot; (DSS), where a</span>
<span class="line-removed">-      * SHA1 digest is signed using the Digital Signing Algorithm (DSA).</span>
<span class="line-removed">-      * OID = 1.3.14.3.2.27</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier sha1WithDSA_OIW_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.3.14.3.2.27&quot;);</span>
  
<span class="line-modified">!     /**</span>
<span class="line-modified">!      * Identifies the FIPS 186 &quot;Digital Signature Standard&quot; (DSS), where a</span>
<span class="line-removed">-      * SHA1 digest is signed using the Digital Signing Algorithm (DSA).</span>
<span class="line-removed">-      * OID = 1.2.840.10040.4.3</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     public static final ObjectIdentifier sha1WithDSA_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.10040.4.3&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     public static final ObjectIdentifier sha512_224WithRSAEncryption_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.1.15&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier sha512_256WithRSAEncryption_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.1.16&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     public static final ObjectIdentifier sha224WithDSA_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;2.16.840.1.101.3.4.3.1&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier sha256WithDSA_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;2.16.840.1.101.3.4.3.2&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     public static final ObjectIdentifier sha1WithECDSA_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.10045.4.1&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier sha224WithECDSA_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.10045.4.3.1&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier sha256WithECDSA_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.10045.4.3.2&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier sha384WithECDSA_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.10045.4.3.3&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier sha512WithECDSA_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.10045.4.3.4&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier specifiedWithECDSA_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.10045.4.3&quot;);</span>
  
<span class="line-modified">!     /**</span>
<span class="line-modified">!      * Algorithm ID for the PBE encryption algorithms from PKCS#5 and</span>
<span class="line-modified">!      * PKCS#12.</span>
<span class="line-modified">!      */</span>
<span class="line-removed">-     public static final ObjectIdentifier pbeWithMD5AndDES_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.5.3&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier pbeWithMD5AndRC2_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.5.6&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier pbeWithSHA1AndDES_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.5.10&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier pbeWithSHA1AndRC2_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.5.11&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier pbeWithSHA1AndRC4_128_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.12.1.1&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier pbeWithSHA1AndRC4_40_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.12.1.2&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier pbeWithSHA1AndDESede_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.12.1.3&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier pbeWithSHA1AndRC2_128_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.12.1.5&quot;);</span>
<span class="line-removed">-     public static final ObjectIdentifier pbeWithSHA1AndRC2_40_oid =</span>
<span class="line-removed">-             ObjectIdentifier.of(&quot;1.2.840.113549.1.12.1.6&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     static {</span>
<span class="line-removed">-         nameTable = new HashMap&lt;&gt;();</span>
<span class="line-removed">-         nameTable.put(MD5_oid, &quot;MD5&quot;);</span>
<span class="line-removed">-         nameTable.put(MD2_oid, &quot;MD2&quot;);</span>
<span class="line-removed">-         nameTable.put(SHA_oid, &quot;SHA-1&quot;);</span>
<span class="line-removed">-         nameTable.put(SHA224_oid, &quot;SHA-224&quot;);</span>
<span class="line-removed">-         nameTable.put(SHA256_oid, &quot;SHA-256&quot;);</span>
<span class="line-removed">-         nameTable.put(SHA384_oid, &quot;SHA-384&quot;);</span>
<span class="line-removed">-         nameTable.put(SHA512_oid, &quot;SHA-512&quot;);</span>
<span class="line-removed">-         nameTable.put(SHA512_224_oid, &quot;SHA-512/224&quot;);</span>
<span class="line-removed">-         nameTable.put(SHA512_256_oid, &quot;SHA-512/256&quot;);</span>
<span class="line-removed">-         nameTable.put(RSAEncryption_oid, &quot;RSA&quot;);</span>
<span class="line-removed">-         nameTable.put(RSA_oid, &quot;RSA&quot;);</span>
<span class="line-removed">-         nameTable.put(DH_oid, &quot;Diffie-Hellman&quot;);</span>
<span class="line-removed">-         nameTable.put(DH_PKIX_oid, &quot;Diffie-Hellman&quot;);</span>
<span class="line-removed">-         nameTable.put(DSA_oid, &quot;DSA&quot;);</span>
<span class="line-removed">-         nameTable.put(DSA_OIW_oid, &quot;DSA&quot;);</span>
<span class="line-removed">-         nameTable.put(EC_oid, &quot;EC&quot;);</span>
<span class="line-removed">-         nameTable.put(ECDH_oid, &quot;ECDH&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-         nameTable.put(AES_oid, &quot;AES&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-         nameTable.put(sha1WithECDSA_oid, &quot;SHA1withECDSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha224WithECDSA_oid, &quot;SHA224withECDSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha256WithECDSA_oid, &quot;SHA256withECDSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha384WithECDSA_oid, &quot;SHA384withECDSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha512WithECDSA_oid, &quot;SHA512withECDSA&quot;);</span>
<span class="line-removed">-         nameTable.put(md5WithRSAEncryption_oid, &quot;MD5withRSA&quot;);</span>
<span class="line-removed">-         nameTable.put(md2WithRSAEncryption_oid, &quot;MD2withRSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha1WithDSA_oid, &quot;SHA1withDSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha1WithDSA_OIW_oid, &quot;SHA1withDSA&quot;);</span>
<span class="line-removed">-         nameTable.put(shaWithDSA_OIW_oid, &quot;SHA1withDSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha224WithDSA_oid, &quot;SHA224withDSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha256WithDSA_oid, &quot;SHA256withDSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha1WithRSAEncryption_oid, &quot;SHA1withRSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha1WithRSAEncryption_OIW_oid, &quot;SHA1withRSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha224WithRSAEncryption_oid, &quot;SHA224withRSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha256WithRSAEncryption_oid, &quot;SHA256withRSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha384WithRSAEncryption_oid, &quot;SHA384withRSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha512WithRSAEncryption_oid, &quot;SHA512withRSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha512_224WithRSAEncryption_oid, &quot;SHA512/224withRSA&quot;);</span>
<span class="line-removed">-         nameTable.put(sha512_256WithRSAEncryption_oid, &quot;SHA512/256withRSA&quot;);</span>
<span class="line-removed">-         nameTable.put(RSASSA_PSS_oid, &quot;RSASSA-PSS&quot;);</span>
<span class="line-removed">-         nameTable.put(RSAES_OAEP_oid, &quot;RSAES-OAEP&quot;);</span>
<span class="line-removed">- </span>
<span class="line-removed">-         nameTable.put(pbeWithMD5AndDES_oid, &quot;PBEWithMD5AndDES&quot;);</span>
<span class="line-removed">-         nameTable.put(pbeWithMD5AndRC2_oid, &quot;PBEWithMD5AndRC2&quot;);</span>
<span class="line-removed">-         nameTable.put(pbeWithSHA1AndDES_oid, &quot;PBEWithSHA1AndDES&quot;);</span>
<span class="line-removed">-         nameTable.put(pbeWithSHA1AndRC2_oid, &quot;PBEWithSHA1AndRC2&quot;);</span>
<span class="line-removed">-         nameTable.put(pbeWithSHA1AndRC4_128_oid, &quot;PBEWithSHA1AndRC4_128&quot;);</span>
<span class="line-removed">-         nameTable.put(pbeWithSHA1AndRC4_40_oid, &quot;PBEWithSHA1AndRC4_40&quot;);</span>
<span class="line-removed">-         nameTable.put(pbeWithSHA1AndDESede_oid, &quot;PBEWithSHA1AndDESede&quot;);</span>
<span class="line-removed">-         nameTable.put(pbeWithSHA1AndRC2_128_oid, &quot;PBEWithSHA1AndRC2_128&quot;);</span>
<span class="line-removed">-         nameTable.put(pbeWithSHA1AndRC2_40_oid, &quot;PBEWithSHA1AndRC2_40&quot;);</span>
<span class="line-removed">-     }</span>
  
      /**
       * Creates a signature algorithm name from a digest algorithm
       * name and a encryption algorithm name.
       */
<span class="line-new-header">--- 484,151 ---</span>
       * scope of the algorithm name to it, e.g., the algorithm name &quot;DSA&quot;
       * may have a different OID when used as a &quot;Signature&quot; algorithm than when
       * used as a &quot;KeyPairGenerator&quot; algorithm.
       */
      private static ObjectIdentifier algOID(String name) throws IOException {
<span class="line-modified">!         if (name.startsWith(&quot;OID.&quot;)) {</span>
<span class="line-modified">!             name = name.substring(&quot;OID.&quot;.length());</span>
          }
  
<span class="line-modified">!         KnownOIDs k = KnownOIDs.findMatch(name);</span>
<span class="line-modified">!         if (k != null) {</span>
<span class="line-modified">!             return ObjectIdentifier.of(k);</span>
          }
  
<span class="line-modified">!         // unknown algorithm oids</span>
<span class="line-modified">!         if (name.indexOf(&quot;.&quot;) == -1) {</span>
<span class="line-modified">!             // see if there is a matching oid string alias mapping from</span>
<span class="line-modified">!             // 3rd party providers</span>
<span class="line-modified">!             name = name.toUpperCase(Locale.ENGLISH);</span>
<span class="line-modified">!             String oidStr = aliasOidsTable().get(name);</span>
<span class="line-modified">!             if (oidStr != null) {</span>
<span class="line-modified">!                 return ObjectIdentifier.of(oidStr);</span>
<span class="line-modified">!             } return null;</span>
<span class="line-modified">!         } else {</span>
<span class="line-modified">!             return ObjectIdentifier.of(name);</span>
          }
      }
  
<span class="line-modified">!     // oid string cache index&#39;ed by algorithm name and oid strings</span>
<span class="line-modified">!     private static volatile Map&lt;String,String&gt; aliasOidsTable;</span>
  
<span class="line-modified">!     // returns the aliasOidsTable, lazily initializing it on first access.</span>
<span class="line-modified">!     private static Map&lt;String,String&gt; aliasOidsTable() {</span>
<span class="line-modified">!         // Double checked locking; safe because aliasOidsTable is volatile</span>
<span class="line-modified">!         Map&lt;String,String&gt; tab = aliasOidsTable;</span>
<span class="line-modified">!         if (tab == null) {</span>
              synchronized (AlgorithmId.class) {
<span class="line-modified">!                 if ((tab = aliasOidsTable) == null) {</span>
<span class="line-modified">!                     aliasOidsTable = tab = collectOIDAliases();</span>
<span class="line-added">+                 }</span>
              }
          }
          return tab;
      }
  
<span class="line-modified">!     private static boolean isKnownProvider(Provider p) {</span>
<span class="line-modified">!         String pn = p.getName();</span>
<span class="line-modified">!         String mn = p.getClass().getModule().getName();</span>
<span class="line-modified">!         if (pn != null &amp;&amp; mn != null) {</span>
<span class="line-added">+             return ((mn.equals(&quot;java.base&quot;) &amp;&amp;</span>
<span class="line-added">+                     (pn.equals(&quot;SUN&quot;) || pn.equals(&quot;SunRsaSign&quot;) ||</span>
<span class="line-added">+                     pn.equals(&quot;SunJCE&quot;) || pn.equals(&quot;SunJSSE&quot;))) ||</span>
<span class="line-added">+                 (mn.equals(&quot;jdk.crypto.ec&quot;) &amp;&amp; pn.equals(&quot;SunEC&quot;)) ||</span>
<span class="line-added">+                 (mn.equals(&quot;jdk.crypto.mscapi&quot;) &amp;&amp; pn.equals(&quot;SunMSCAPI&quot;)) ||</span>
<span class="line-added">+                 (mn.equals(&quot;jdk.crypto.cryptoki&quot;) &amp;&amp;</span>
<span class="line-added">+                     pn.startsWith(&quot;SunPKCS11&quot;)));</span>
<span class="line-added">+         } else {</span>
<span class="line-added">+             return false;</span>
<span class="line-added">+         }</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
<span class="line-added">+     private static ConcurrentHashMap&lt;String, String&gt; collectOIDAliases() {</span>
<span class="line-added">+         ConcurrentHashMap&lt;String, String&gt; t = new ConcurrentHashMap&lt;&gt;();</span>
          for (Provider provider : Security.getProviders()) {
<span class="line-added">+             // skip providers which are already using SecurityProviderConstants</span>
<span class="line-added">+             // and KnownOIDs</span>
<span class="line-added">+             if (isKnownProvider(provider)) {</span>
<span class="line-added">+                 continue;</span>
<span class="line-added">+             }</span>
              for (Object key : provider.keySet()) {
                  String alias = (String)key;
                  String upperCaseAlias = alias.toUpperCase(Locale.ENGLISH);
                  int index;
                  if (upperCaseAlias.startsWith(&quot;ALG.ALIAS&quot;) &amp;&amp;
<span class="line-modified">!                     (index = upperCaseAlias.indexOf(&quot;OID.&quot;, 0)) != -1) {</span>
                      index += &quot;OID.&quot;.length();
                      if (index == alias.length()) {
                          // invalid alias entry
                          break;
                      }
<span class="line-modified">!                     String ostr = alias.substring(index);</span>
                      String stdAlgName = provider.getProperty(alias);
                      if (stdAlgName != null) {
                          stdAlgName = stdAlgName.toUpperCase(Locale.ENGLISH);
                      }
<span class="line-modified">!                     // add the name-&gt;oid and oid-&gt;name mappings if none exists</span>
<span class="line-modified">!                     if (KnownOIDs.findMatch(stdAlgName) == null) {</span>
<span class="line-modified">!                         // not override earlier entries if it exists</span>
<span class="line-added">+                         t.putIfAbsent(stdAlgName, ostr);</span>
<span class="line-added">+                     }</span>
<span class="line-added">+                     if (KnownOIDs.findMatch(ostr) == null) {</span>
<span class="line-added">+                         // not override earlier entries if it exists</span>
<span class="line-added">+                         t.putIfAbsent(ostr, stdAlgName);</span>
                      }
                  }
              }
          }
<span class="line-modified">!         return t;</span>
      }
  
      public static final ObjectIdentifier MD2_oid =
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.MD2);</span>
  
      public static final ObjectIdentifier MD5_oid =
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.MD5);</span>
  
      public static final ObjectIdentifier SHA_oid =
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.SHA_1);</span>
  
      public static final ObjectIdentifier SHA224_oid =
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.SHA_224);</span>
  
      public static final ObjectIdentifier SHA256_oid =
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.SHA_256);</span>
  
      public static final ObjectIdentifier SHA384_oid =
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.SHA_384);</span>
  
      public static final ObjectIdentifier SHA512_oid =
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.SHA_512);</span>
  
      public static final ObjectIdentifier SHA512_224_oid =
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.SHA_512$224);</span>
  
      public static final ObjectIdentifier SHA512_256_oid =
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.SHA_512$256);</span>
  
      public static final ObjectIdentifier DSA_oid =
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.DSA);</span>
  
      public static final ObjectIdentifier EC_oid =
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.EC);</span>
  
<span class="line-modified">!     public static final ObjectIdentifier RSAEncryption_oid =</span>
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.RSA);</span>
  
<span class="line-modified">!     public static final ObjectIdentifier RSASSA_PSS_oid =</span>
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.RSASSA_PSS);</span>
  
<span class="line-modified">!     public static final ObjectIdentifier MGF1_oid =</span>
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.MGF1);</span>
  
<span class="line-modified">!     public static final ObjectIdentifier ed25519_oid =</span>
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.Ed25519);</span>
<span class="line-modified">!     public static final ObjectIdentifier ed448_oid =</span>
<span class="line-modified">!             ObjectIdentifier.of(KnownOIDs.Ed448);</span>
  
      /**
       * Creates a signature algorithm name from a digest algorithm
       * name and a encryption algorithm name.
       */
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1042,10 ***</span>
<span class="line-new-header">--- 712,12 ---</span>
              case &quot;RSA&quot;:
                  return ifcFfcStrength(KeyUtil.getKeySize(k))
                      + &quot;withRSA&quot;;
              case &quot;RSASSA-PSS&quot;:
                  return &quot;RSASSA-PSS&quot;;
<span class="line-added">+             case &quot;EDDSA&quot;:</span>
<span class="line-added">+                 return edAlgFromKey(k);</span>
              default:
                  return null;
          }
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1092,10 ***</span>
<span class="line-new-header">--- 764,12 ---</span>
              return PSSParamsHolder.PSS_256_ID;
          } else if (spec == PSSParamsHolder.PSS_384_SPEC) {
              return PSSParamsHolder.PSS_384_ID;
          } else if (spec == PSSParamsHolder.PSS_512_SPEC) {
              return PSSParamsHolder.PSS_512_ID;
<span class="line-added">+         } else if (spec instanceof EdDSAParameterSpec) {</span>
<span class="line-added">+             return AlgorithmId.get(algName);</span>
          } else {
              try {
                  AlgorithmParameters result =
                          AlgorithmParameters.getInstance(algName);
                  result.init(spec);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1128,10 ***</span>
<span class="line-new-header">--- 802,18 ---</span>
          } else {
              return null;
          }
      }
  
<span class="line-added">+     private static String edAlgFromKey(PrivateKey k) {</span>
<span class="line-added">+         if (k instanceof EdECPrivateKey) {</span>
<span class="line-added">+             EdECPrivateKey edKey = (EdECPrivateKey) k;</span>
<span class="line-added">+             return edKey.getParams().getName();</span>
<span class="line-added">+         }</span>
<span class="line-added">+         return &quot;EdDSA&quot;;</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      // Values from SP800-57 part 1 rev 4 tables 2 and 3
      private static String ecStrength (int bitLength) {
          if (bitLength &gt;= 512) { // 256 bits of strength
              return &quot;SHA512&quot;;
          } else if (bitLength &gt;= 384) {  // 192 bits of strength
</pre>
<center><a href="AccessDescription.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="ExtendedKeyUsageExtension.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>