<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/java.base/share/classes/sun/security/rsa/SunRsaSignEntries.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="PSSParameters.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../ssl/SunJSSE.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/rsa/SunRsaSignEntries.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2003, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2003, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -25,89 +25,76 @@</span>
  
  package sun.security.rsa;
  
  import java.util.*;
  import java.security.Provider;
<span class="udiff-line-modified-removed">- import static sun.security.provider.SunEntries.createAliasesWithOid;</span>
<span class="udiff-line-modified-added">+ import static sun.security.util.SecurityProviderConstants.getAliases;</span>
  
  /**
   * Defines the entries of the SunRsaSign provider.
   *
   * @author  Andreas Sterbenz
   */
  public final class SunRsaSignEntries {
  
      private void add(Provider p, String type, String algo, String cn,
               List&lt;String&gt; aliases, HashMap&lt;String, String&gt; attrs) {
<span class="udiff-line-modified-removed">-          services.add(new Provider.Service(p, type, algo, cn, aliases, attrs));</span>
<span class="udiff-line-modified-added">+          services.add(new Provider.Service(p, type, algo, cn,</span>
<span class="udiff-line-added">+              aliases, attrs));</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     private void addA(Provider p, String type, String algo, String cn,</span>
<span class="udiff-line-added">+              HashMap&lt;String, String&gt; attrs) {</span>
<span class="udiff-line-added">+          services.add(new Provider.Service(p, type, algo, cn,</span>
<span class="udiff-line-added">+              getAliases(algo), attrs));</span>
      }
  
      // extend LinkedHashSet for consistency with SunEntries
      // used by sun.security.provider.VerificationProvider
      public SunRsaSignEntries(Provider p) {
          services = new LinkedHashSet&lt;&gt;(20, 0.9f);
  
          // start populating content using the specified provider
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-         // common oids</span>
<span class="udiff-line-removed">-         String rsaOid = &quot;1.2.840.113549.1.1&quot;;</span>
<span class="udiff-line-removed">-         List&lt;String&gt; rsaAliases = createAliasesWithOid(rsaOid);</span>
<span class="udiff-line-removed">-         List&lt;String&gt; rsapssAliases = createAliasesWithOid(rsaOid + &quot;.10&quot;);</span>
<span class="udiff-line-removed">-         String sha1withRSAOid2 = &quot;1.3.14.3.2.29&quot;;</span>
<span class="udiff-line-removed">- </span>
          // common attribute map
          HashMap&lt;String, String&gt; attrs = new HashMap&lt;&gt;(3);
          attrs.put(&quot;SupportedKeyClasses&quot;,
                  &quot;java.security.interfaces.RSAPublicKey&quot; +
                  &quot;|java.security.interfaces.RSAPrivateKey&quot;);
  
          add(p, &quot;KeyFactory&quot;, &quot;RSA&quot;,
                  &quot;sun.security.rsa.RSAKeyFactory$Legacy&quot;,
<span class="udiff-line-modified-removed">-                 rsaAliases, null);</span>
<span class="udiff-line-modified-added">+                 getAliases(&quot;PKCS1&quot;), null);</span>
          add(p, &quot;KeyPairGenerator&quot;, &quot;RSA&quot;,
                  &quot;sun.security.rsa.RSAKeyPairGenerator$Legacy&quot;,
<span class="udiff-line-modified-removed">-                 rsaAliases, null);</span>
<span class="udiff-line-modified-removed">-         add(p, &quot;Signature&quot;, &quot;MD2withRSA&quot;,</span>
<span class="udiff-line-modified-removed">-                 &quot;sun.security.rsa.RSASignature$MD2withRSA&quot;,</span>
<span class="udiff-line-modified-removed">-                 createAliasesWithOid(rsaOid + &quot;.2&quot;), attrs);</span>
<span class="udiff-line-modified-removed">-         add(p, &quot;Signature&quot;, &quot;MD5withRSA&quot;,</span>
<span class="udiff-line-modified-removed">-                 &quot;sun.security.rsa.RSASignature$MD5withRSA&quot;,</span>
<span class="udiff-line-modified-removed">-                 createAliasesWithOid(rsaOid + &quot;.4&quot;), attrs);</span>
<span class="udiff-line-modified-removed">-         add(p, &quot;Signature&quot;, &quot;SHA1withRSA&quot;,</span>
<span class="udiff-line-modified-removed">-                 &quot;sun.security.rsa.RSASignature$SHA1withRSA&quot;,</span>
<span class="udiff-line-modified-removed">-                 createAliasesWithOid(rsaOid + &quot;.5&quot;, sha1withRSAOid2), attrs);</span>
<span class="udiff-line-modified-removed">-         add(p, &quot;Signature&quot;, &quot;SHA224withRSA&quot;,</span>
<span class="udiff-line-modified-removed">-                 &quot;sun.security.rsa.RSASignature$SHA224withRSA&quot;,</span>
<span class="udiff-line-modified-removed">-                 createAliasesWithOid(rsaOid + &quot;.14&quot;), attrs);</span>
<span class="udiff-line-modified-removed">-         add(p, &quot;Signature&quot;, &quot;SHA256withRSA&quot;,</span>
<span class="udiff-line-modified-removed">-                 &quot;sun.security.rsa.RSASignature$SHA256withRSA&quot;,</span>
<span class="udiff-line-modified-removed">-                 createAliasesWithOid(rsaOid + &quot;.11&quot;), attrs);</span>
<span class="udiff-line-modified-removed">-         add(p, &quot;Signature&quot;, &quot;SHA384withRSA&quot;,</span>
<span class="udiff-line-modified-removed">-                 &quot;sun.security.rsa.RSASignature$SHA384withRSA&quot;,</span>
<span class="udiff-line-modified-removed">-                 createAliasesWithOid(rsaOid + &quot;.12&quot;), attrs);</span>
<span class="udiff-line-removed">-         add(p, &quot;Signature&quot;, &quot;SHA512withRSA&quot;,</span>
<span class="udiff-line-removed">-                 &quot;sun.security.rsa.RSASignature$SHA512withRSA&quot;,</span>
<span class="udiff-line-removed">-                 createAliasesWithOid(rsaOid + &quot;.13&quot;), attrs);</span>
<span class="udiff-line-removed">-         add(p, &quot;Signature&quot;, &quot;SHA512/224withRSA&quot;,</span>
<span class="udiff-line-removed">-                 &quot;sun.security.rsa.RSASignature$SHA512_224withRSA&quot;,</span>
<span class="udiff-line-removed">-                 createAliasesWithOid(rsaOid + &quot;.15&quot;), attrs);</span>
<span class="udiff-line-removed">-         add(p, &quot;Signature&quot;, &quot;SHA512/256withRSA&quot;,</span>
<span class="udiff-line-removed">-                 &quot;sun.security.rsa.RSASignature$SHA512_256withRSA&quot;,</span>
<span class="udiff-line-removed">-                 createAliasesWithOid(rsaOid + &quot;.16&quot;), attrs);</span>
<span class="udiff-line-modified-added">+                 getAliases(&quot;PKCS1&quot;), null);</span>
<span class="udiff-line-modified-added">+         addA(p, &quot;Signature&quot;, &quot;MD2withRSA&quot;,</span>
<span class="udiff-line-modified-added">+                 &quot;sun.security.rsa.RSASignature$MD2withRSA&quot;, attrs);</span>
<span class="udiff-line-modified-added">+         addA(p, &quot;Signature&quot;, &quot;MD5withRSA&quot;,</span>
<span class="udiff-line-modified-added">+                 &quot;sun.security.rsa.RSASignature$MD5withRSA&quot;, attrs);</span>
<span class="udiff-line-modified-added">+         addA(p, &quot;Signature&quot;, &quot;SHA1withRSA&quot;,</span>
<span class="udiff-line-modified-added">+                 &quot;sun.security.rsa.RSASignature$SHA1withRSA&quot;, attrs);</span>
<span class="udiff-line-modified-added">+         addA(p, &quot;Signature&quot;, &quot;SHA224withRSA&quot;,</span>
<span class="udiff-line-modified-added">+                 &quot;sun.security.rsa.RSASignature$SHA224withRSA&quot;, attrs);</span>
<span class="udiff-line-modified-added">+         addA(p, &quot;Signature&quot;, &quot;SHA256withRSA&quot;,</span>
<span class="udiff-line-modified-added">+                 &quot;sun.security.rsa.RSASignature$SHA256withRSA&quot;, attrs);</span>
<span class="udiff-line-modified-added">+         addA(p, &quot;Signature&quot;, &quot;SHA384withRSA&quot;,</span>
<span class="udiff-line-modified-added">+                 &quot;sun.security.rsa.RSASignature$SHA384withRSA&quot;, attrs);</span>
<span class="udiff-line-modified-added">+         addA(p, &quot;Signature&quot;, &quot;SHA512withRSA&quot;,</span>
<span class="udiff-line-modified-added">+                 &quot;sun.security.rsa.RSASignature$SHA512withRSA&quot;, attrs);</span>
<span class="udiff-line-modified-added">+         addA(p, &quot;Signature&quot;, &quot;SHA512/224withRSA&quot;,</span>
<span class="udiff-line-modified-added">+                 &quot;sun.security.rsa.RSASignature$SHA512_224withRSA&quot;, attrs);</span>
<span class="udiff-line-modified-added">+         addA(p, &quot;Signature&quot;, &quot;SHA512/256withRSA&quot;,</span>
<span class="udiff-line-modified-added">+                 &quot;sun.security.rsa.RSASignature$SHA512_256withRSA&quot;, attrs);</span>
  
<span class="udiff-line-modified-removed">-         add(p, &quot;KeyFactory&quot;, &quot;RSASSA-PSS&quot;,</span>
<span class="udiff-line-modified-removed">-                 &quot;sun.security.rsa.RSAKeyFactory$PSS&quot;,</span>
<span class="udiff-line-modified-removed">-                 rsapssAliases, null);</span>
<span class="udiff-line-modified-removed">-         add(p, &quot;KeyPairGenerator&quot;, &quot;RSASSA-PSS&quot;,</span>
<span class="udiff-line-modified-removed">-                 &quot;sun.security.rsa.RSAKeyPairGenerator$PSS&quot;,</span>
<span class="udiff-line-modified-removed">-                 rsapssAliases, null);</span>
<span class="udiff-line-modified-removed">-         add(p, &quot;Signature&quot;, &quot;RSASSA-PSS&quot;,</span>
<span class="udiff-line-modified-removed">-                 &quot;sun.security.rsa.RSAPSSSignature&quot;,</span>
<span class="udiff-line-removed">-                 rsapssAliases, attrs);</span>
<span class="udiff-line-removed">-         add(p, &quot;AlgorithmParameters&quot;, &quot;RSASSA-PSS&quot;,</span>
<span class="udiff-line-removed">-                 &quot;sun.security.rsa.PSSParameters&quot;,</span>
<span class="udiff-line-removed">-                 rsapssAliases, null);</span>
<span class="udiff-line-modified-added">+         addA(p, &quot;KeyFactory&quot;, &quot;RSASSA-PSS&quot;,</span>
<span class="udiff-line-modified-added">+                 &quot;sun.security.rsa.RSAKeyFactory$PSS&quot;, attrs);</span>
<span class="udiff-line-modified-added">+         addA(p, &quot;KeyPairGenerator&quot;, &quot;RSASSA-PSS&quot;,</span>
<span class="udiff-line-modified-added">+                 &quot;sun.security.rsa.RSAKeyPairGenerator$PSS&quot;, attrs);</span>
<span class="udiff-line-modified-added">+         addA(p, &quot;Signature&quot;, &quot;RSASSA-PSS&quot;,</span>
<span class="udiff-line-modified-added">+                 &quot;sun.security.rsa.RSAPSSSignature&quot;, attrs);</span>
<span class="udiff-line-modified-added">+         addA(p, &quot;AlgorithmParameters&quot;, &quot;RSASSA-PSS&quot;,</span>
<span class="udiff-line-modified-added">+                 &quot;sun.security.rsa.PSSParameters&quot;, attrs);</span>
      }
  
      public Iterator&lt;Provider.Service&gt; iterator() {
          return services.iterator();
      }
</pre>
<center><a href="PSSParameters.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../ssl/SunJSSE.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>