<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.base/share/classes/sun/security/util/SecurityProviderConstants.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="ObjectIdentifier.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="math/intpoly/IntegerPolynomial.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/sun/security/util/SecurityProviderConstants.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2017, 2018, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2017, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 23,24 ***</span>
   * questions.
   */
  
  package sun.security.util;
  
  import java.util.regex.PatternSyntaxException;
  import java.security.InvalidParameterException;
  import sun.security.action.GetPropertyAction;
  
  /**
   * Various constants such as version number, default key length, used by
   * the JDK security/crypto providers.
   */
  public final class SecurityProviderConstants {
      private static final Debug debug =
          Debug.getInstance(&quot;jca&quot;, &quot;ProviderConfig&quot;);
  
<span class="line-modified">!     // Cannot create one of these</span>
<span class="line-modified">!     private SecurityProviderConstants () {</span>
      }
  
      public static final int getDefDSASubprimeSize(int primeSize) {
          if (primeSize &lt;= 1024) {
              return 160;
<span class="line-new-header">--- 23,75 ---</span>
   * questions.
   */
  
  package sun.security.util;
  
<span class="line-added">+ import java.util.*;</span>
<span class="line-added">+ import java.util.concurrent.ConcurrentHashMap;</span>
  import java.util.regex.PatternSyntaxException;
  import java.security.InvalidParameterException;
<span class="line-added">+ import java.security.ProviderException;</span>
  import sun.security.action.GetPropertyAction;
  
  /**
   * Various constants such as version number, default key length, used by
   * the JDK security/crypto providers.
   */
  public final class SecurityProviderConstants {
<span class="line-added">+     // Cannot create one of these</span>
<span class="line-added">+     private SecurityProviderConstants () {}</span>
<span class="line-added">+ </span>
      private static final Debug debug =
          Debug.getInstance(&quot;jca&quot;, &quot;ProviderConfig&quot;);
  
<span class="line-modified">!     // cache for provider aliases; key is the standard algorithm name</span>
<span class="line-modified">!     // value is the associated aliases List</span>
<span class="line-added">+     private static final ConcurrentHashMap&lt;String, List&lt;String&gt;&gt; aliasesMap;</span>
<span class="line-added">+ </span>
<span class="line-added">+     // utility method for generating aliases list using the supplied</span>
<span class="line-added">+     // &#39;oid&#39; and &#39;extraAliases&#39;, then store into &quot;aliasesMap&quot; cache under the</span>
<span class="line-added">+     // key &#39;stdName&#39;</span>
<span class="line-added">+     private static List&lt;String&gt; store(String stdName, KnownOIDs oid,</span>
<span class="line-added">+             String ... extraAliases) {</span>
<span class="line-added">+         List&lt;String&gt; value;</span>
<span class="line-added">+         if (oid == null &amp;&amp; extraAliases.length != 0) {</span>
<span class="line-added">+             value = List.of(extraAliases);</span>
<span class="line-added">+         } else {</span>
<span class="line-added">+             value = new ArrayList&lt;&gt;();</span>
<span class="line-added">+             if (oid != null) {</span>
<span class="line-added">+                 value.add(&quot;OID.&quot; + oid.value());</span>
<span class="line-added">+                 value.add(oid.value());</span>
<span class="line-added">+                 String[] knownAliases = oid.aliases();</span>
<span class="line-added">+                 if (knownAliases != null) {</span>
<span class="line-added">+                     for (String ka : knownAliases) {</span>
<span class="line-added">+                         value.add(ka);</span>
<span class="line-added">+                     }</span>
<span class="line-added">+                 }</span>
<span class="line-added">+             }</span>
<span class="line-added">+             for (String ea : extraAliases) {</span>
<span class="line-added">+                 value.add(ea);</span>
<span class="line-added">+             }</span>
<span class="line-added">+         }</span>
<span class="line-added">+         aliasesMap.put(stdName, value);</span>
<span class="line-added">+         return value;</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
<span class="line-added">+     // returns an aliases List for the specified algorithm name o</span>
<span class="line-added">+     // NOTE: exception is thrown if no aliases nor oid found, so</span>
<span class="line-added">+     // only call this method if aliases are expected</span>
<span class="line-added">+     public static List&lt;String&gt; getAliases(String o) {</span>
<span class="line-added">+         List&lt;String&gt; res = aliasesMap.get(o);</span>
<span class="line-added">+         if (res == null) {</span>
<span class="line-added">+             KnownOIDs e = KnownOIDs.findMatch(o);</span>
<span class="line-added">+             if (e != null) {</span>
<span class="line-added">+                 return store(o, e);</span>
<span class="line-added">+             }</span>
<span class="line-added">+             ProviderException pe =</span>
<span class="line-added">+                     new ProviderException(&quot;Cannot find aliases for &quot; + o);</span>
<span class="line-added">+             throw pe;</span>
<span class="line-added">+         }</span>
<span class="line-added">+         return res;</span>
      }
  
      public static final int getDefDSASubprimeSize(int primeSize) {
          if (primeSize &lt;= 1024) {
              return 160;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 57,21 ***</span>
<span class="line-new-header">--- 108,24 ---</span>
      public static final int DEF_DSA_KEY_SIZE;
      public static final int DEF_RSA_KEY_SIZE;
      public static final int DEF_RSASSA_PSS_KEY_SIZE;
      public static final int DEF_DH_KEY_SIZE;
      public static final int DEF_EC_KEY_SIZE;
<span class="line-added">+     public static final int DEF_ED_KEY_SIZE;</span>
  
      private static final String KEY_LENGTH_PROP =
          &quot;jdk.security.defaultKeySize&quot;;
<span class="line-added">+ </span>
      static {
          String keyLengthStr = GetPropertyAction.privilegedGetProperty
              (KEY_LENGTH_PROP);
          int dsaKeySize = 2048;
          int rsaKeySize = 2048;
          int rsaSsaPssKeySize = rsaKeySize; // default to same value as RSA
          int dhKeySize = 2048;
          int ecKeySize = 256;
<span class="line-added">+         int edKeySize = 255;</span>
  
          if (keyLengthStr != null) {
              try {
                  String[] pairs = keyLengthStr.split(&quot;,&quot;);
                  for (String p : pairs) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 104,10 ***</span>
<span class="line-new-header">--- 158,12 ---</span>
                          rsaSsaPssKeySize = value;
                      } else if (algoName.equals(&quot;DH&quot;)) {
                          dhKeySize = value;
                      } else if (algoName.equals(&quot;EC&quot;)) {
                          ecKeySize = value;
<span class="line-added">+                     } else if (algoName.equalsIgnoreCase(&quot;EdDSA&quot;)) {</span>
<span class="line-added">+                         edKeySize = value;</span>
                      } else {
                          if (debug != null) {
                              debug.println(&quot;Ignoring unsupported algo in &quot; +
                                  KEY_LENGTH_PROP + &quot; property: &quot; + p);
                          }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 130,7 ***</span>
<span class="line-new-header">--- 186,42 ---</span>
          DEF_DSA_KEY_SIZE = dsaKeySize;
          DEF_RSA_KEY_SIZE = rsaKeySize;
          DEF_RSASSA_PSS_KEY_SIZE = rsaSsaPssKeySize;
          DEF_DH_KEY_SIZE = dhKeySize;
          DEF_EC_KEY_SIZE = ecKeySize;
<span class="line-added">+         DEF_ED_KEY_SIZE = edKeySize;</span>
<span class="line-added">+ </span>
<span class="line-added">+         // Set up aliases with default mappings</span>
<span class="line-added">+         // This is needed when the mapping contains non-oid</span>
<span class="line-added">+         // aliases</span>
<span class="line-added">+         aliasesMap = new ConcurrentHashMap&lt;&gt;();</span>
<span class="line-added">+ </span>
<span class="line-added">+         store(&quot;SHA1withDSA&quot;, KnownOIDs.SHA1withDSA,</span>
<span class="line-added">+                 KnownOIDs.OIW_JDK_SHA1withDSA.value(),</span>
<span class="line-added">+                 KnownOIDs.OIW_SHA1withDSA.value(),</span>
<span class="line-added">+                 &quot;DSA&quot;, &quot;SHA/DSA&quot;, &quot;SHA-1/DSA&quot;,</span>
<span class="line-added">+                 &quot;SHA1/DSA&quot;, &quot;SHAwithDSA&quot;, &quot;DSAWithSHA1&quot;);</span>
<span class="line-added">+ </span>
<span class="line-added">+         store(&quot;DSA&quot;, KnownOIDs.DSA, KnownOIDs.OIW_DSA.value());</span>
<span class="line-added">+ </span>
<span class="line-added">+         store(&quot;SHA1withRSA&quot;, KnownOIDs.SHA1withRSA,</span>
<span class="line-added">+                 KnownOIDs.OIW_SHA1withRSA.value());</span>
<span class="line-added">+ </span>
<span class="line-added">+         store(&quot;SHA-1&quot;, KnownOIDs.SHA_1);</span>
<span class="line-added">+ </span>
<span class="line-added">+         store(&quot;PBEWithMD5AndDES&quot;, KnownOIDs.PBEWithMD5AndDES, &quot;PBE&quot;);</span>
<span class="line-added">+ </span>
<span class="line-added">+         store(&quot;DiffieHellman&quot;, KnownOIDs.DiffieHellman);</span>
<span class="line-added">+ </span>
<span class="line-added">+         store(&quot;AES&quot;, KnownOIDs.AES, &quot;Rijndael&quot;);</span>
<span class="line-added">+ </span>
<span class="line-added">+         store(&quot;EC&quot;, KnownOIDs.EC, &quot;EllipticCurve&quot;);</span>
<span class="line-added">+ </span>
<span class="line-added">+         store(&quot;X.509&quot;, null, &quot;X509&quot;);</span>
<span class="line-added">+         store(&quot;NONEwithDSA&quot;, null, &quot;RawDSA&quot;);</span>
<span class="line-added">+         store(&quot;DESede&quot;, null, &quot;TripleDES&quot;);</span>
<span class="line-added">+         store(&quot;ARCFOUR&quot;, KnownOIDs.ARCFOUR);</span>
<span class="line-added">+         // For backward compatility, refer to PKCS1 mapping for RSA</span>
<span class="line-added">+         // KeyPairGenerator and KeyFactory</span>
<span class="line-added">+         store(&quot;PKCS1&quot;, KnownOIDs.PKCS1, KnownOIDs.RSA.value());</span>
      }
  }
</pre>
<center><a href="ObjectIdentifier.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="math/intpoly/IntegerPolynomial.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>