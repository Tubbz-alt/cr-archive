<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/cpu/x86/assembler_x86.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../sparc/stubGenerator_sparc.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="c1_globals_x86.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/x86/assembler_x86.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
8772   memcpy(end, src, src_len);
8773   code_section-&gt;set_end(end + src_len);
8774 }
8775 
8776 void Assembler::popa() { // 64bit
8777   emit_copy(code_section(), popa_code, popa_len);
8778 }
8779 
8780 void Assembler::popa_uncached() { // 64bit
8781   movq(r15, Address(rsp, 0));
8782   movq(r14, Address(rsp, wordSize));
8783   movq(r13, Address(rsp, 2 * wordSize));
8784   movq(r12, Address(rsp, 3 * wordSize));
8785   movq(r11, Address(rsp, 4 * wordSize));
8786   movq(r10, Address(rsp, 5 * wordSize));
8787   movq(r9,  Address(rsp, 6 * wordSize));
8788   movq(r8,  Address(rsp, 7 * wordSize));
8789   movq(rdi, Address(rsp, 8 * wordSize));
8790   movq(rsi, Address(rsp, 9 * wordSize));
8791   movq(rbp, Address(rsp, 10 * wordSize));
<span class="line-modified">8792   // skip rsp</span>

8793   movq(rbx, Address(rsp, 12 * wordSize));
8794   movq(rdx, Address(rsp, 13 * wordSize));
8795   movq(rcx, Address(rsp, 14 * wordSize));
8796   movq(rax, Address(rsp, 15 * wordSize));
8797 
8798   addq(rsp, 16 * wordSize);
8799 }
8800 


8801 void Assembler::pusha() { // 64bit
8802   emit_copy(code_section(), pusha_code, pusha_len);
8803 }
8804 


8805 void Assembler::pusha_uncached() { // 64bit
<span class="line-removed">8806   // we have to store original rsp.  ABI says that 128 bytes</span>
<span class="line-removed">8807   // below rsp are local scratch.</span>
<span class="line-removed">8808   movq(Address(rsp, -5 * wordSize), rsp);</span>
<span class="line-removed">8809 </span>
8810   subq(rsp, 16 * wordSize);
8811 
8812   movq(Address(rsp, 15 * wordSize), rax);
8813   movq(Address(rsp, 14 * wordSize), rcx);
8814   movq(Address(rsp, 13 * wordSize), rdx);
8815   movq(Address(rsp, 12 * wordSize), rbx);
<span class="line-modified">8816   // skip rsp</span>


8817   movq(Address(rsp, 10 * wordSize), rbp);
8818   movq(Address(rsp, 9 * wordSize), rsi);
8819   movq(Address(rsp, 8 * wordSize), rdi);
8820   movq(Address(rsp, 7 * wordSize), r8);
8821   movq(Address(rsp, 6 * wordSize), r9);
8822   movq(Address(rsp, 5 * wordSize), r10);
8823   movq(Address(rsp, 4 * wordSize), r11);
8824   movq(Address(rsp, 3 * wordSize), r12);
8825   movq(Address(rsp, 2 * wordSize), r13);
8826   movq(Address(rsp, wordSize), r14);
8827   movq(Address(rsp, 0), r15);
8828 }
8829 
8830 void Assembler::vzeroupper() {
8831   emit_copy(code_section(), vzup_code, vzup_len);
8832 }
8833 
8834 void Assembler::pushq(Address src) {
8835   InstructionMark im(this);
8836   emit_int16(get_prefixq(src), (unsigned char)0xFF);
</pre>
</td>
<td>
<hr />
<pre>
8772   memcpy(end, src, src_len);
8773   code_section-&gt;set_end(end + src_len);
8774 }
8775 
8776 void Assembler::popa() { // 64bit
8777   emit_copy(code_section(), popa_code, popa_len);
8778 }
8779 
8780 void Assembler::popa_uncached() { // 64bit
8781   movq(r15, Address(rsp, 0));
8782   movq(r14, Address(rsp, wordSize));
8783   movq(r13, Address(rsp, 2 * wordSize));
8784   movq(r12, Address(rsp, 3 * wordSize));
8785   movq(r11, Address(rsp, 4 * wordSize));
8786   movq(r10, Address(rsp, 5 * wordSize));
8787   movq(r9,  Address(rsp, 6 * wordSize));
8788   movq(r8,  Address(rsp, 7 * wordSize));
8789   movq(rdi, Address(rsp, 8 * wordSize));
8790   movq(rsi, Address(rsp, 9 * wordSize));
8791   movq(rbp, Address(rsp, 10 * wordSize));
<span class="line-modified">8792   // Skip rsp as it is restored automatically to the value</span>
<span class="line-added">8793   // before the corresponding pusha when popa is done.</span>
8794   movq(rbx, Address(rsp, 12 * wordSize));
8795   movq(rdx, Address(rsp, 13 * wordSize));
8796   movq(rcx, Address(rsp, 14 * wordSize));
8797   movq(rax, Address(rsp, 15 * wordSize));
8798 
8799   addq(rsp, 16 * wordSize);
8800 }
8801 
<span class="line-added">8802 // Does not actually store the value of rsp on the stack.</span>
<span class="line-added">8803 // The slot for rsp just contains an arbitrary value.</span>
8804 void Assembler::pusha() { // 64bit
8805   emit_copy(code_section(), pusha_code, pusha_len);
8806 }
8807 
<span class="line-added">8808 // Does not actually store the value of rsp on the stack.</span>
<span class="line-added">8809 // The slot for rsp just contains an arbitrary value.</span>
8810 void Assembler::pusha_uncached() { // 64bit




8811   subq(rsp, 16 * wordSize);
8812 
8813   movq(Address(rsp, 15 * wordSize), rax);
8814   movq(Address(rsp, 14 * wordSize), rcx);
8815   movq(Address(rsp, 13 * wordSize), rdx);
8816   movq(Address(rsp, 12 * wordSize), rbx);
<span class="line-modified">8817   // Skip rsp as the value is normally not used. There are a few places where</span>
<span class="line-added">8818   // the original value of rsp needs to be known but that can be computed</span>
<span class="line-added">8819   // from the value of rsp immediately after pusha (rsp + 16 * wordSize).</span>
8820   movq(Address(rsp, 10 * wordSize), rbp);
8821   movq(Address(rsp, 9 * wordSize), rsi);
8822   movq(Address(rsp, 8 * wordSize), rdi);
8823   movq(Address(rsp, 7 * wordSize), r8);
8824   movq(Address(rsp, 6 * wordSize), r9);
8825   movq(Address(rsp, 5 * wordSize), r10);
8826   movq(Address(rsp, 4 * wordSize), r11);
8827   movq(Address(rsp, 3 * wordSize), r12);
8828   movq(Address(rsp, 2 * wordSize), r13);
8829   movq(Address(rsp, wordSize), r14);
8830   movq(Address(rsp, 0), r15);
8831 }
8832 
8833 void Assembler::vzeroupper() {
8834   emit_copy(code_section(), vzup_code, vzup_len);
8835 }
8836 
8837 void Assembler::pushq(Address src) {
8838   InstructionMark im(this);
8839   emit_int16(get_prefixq(src), (unsigned char)0xFF);
</pre>
</td>
</tr>
</table>
<center><a href="../sparc/stubGenerator_sparc.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="c1_globals_x86.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>