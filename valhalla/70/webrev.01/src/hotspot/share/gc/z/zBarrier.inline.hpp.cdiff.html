<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/gc/z/zBarrier.inline.hpp</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="zArguments.hpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="zPhysicalMemory.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/gc/z/zBarrier.inline.hpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 226,11 ***</span>
  inline oop ZBarrier::load_barrier_on_oop(oop o) {
    return load_barrier_on_oop_field_preloaded((oop*)NULL, o);
  }
  
  inline oop ZBarrier::load_barrier_on_oop_field(volatile oop* p) {
<span class="line-modified">!   const oop o = *p;</span>
    return load_barrier_on_oop_field_preloaded(p, o);
  }
  
  inline oop ZBarrier::load_barrier_on_oop_field_preloaded(volatile oop* p, oop o) {
    return barrier&lt;is_good_or_null_fast_path, load_barrier_on_oop_slow_path&gt;(p, o);
<span class="line-new-header">--- 226,11 ---</span>
  inline oop ZBarrier::load_barrier_on_oop(oop o) {
    return load_barrier_on_oop_field_preloaded((oop*)NULL, o);
  }
  
  inline oop ZBarrier::load_barrier_on_oop_field(volatile oop* p) {
<span class="line-modified">!   const oop o = Atomic::load(p);</span>
    return load_barrier_on_oop_field_preloaded(p, o);
  }
  
  inline oop ZBarrier::load_barrier_on_oop_field_preloaded(volatile oop* p, oop o) {
    return barrier&lt;is_good_or_null_fast_path, load_barrier_on_oop_slow_path&gt;(p, o);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 280,11 ***</span>
  //
  // Weak load barrier
  //
  inline oop ZBarrier::weak_load_barrier_on_oop_field(volatile oop* p) {
    assert(!ZResurrection::is_blocked(), &quot;Should not be called during resurrection blocked phase&quot;);
<span class="line-modified">!   const oop o = *p;</span>
    return weak_load_barrier_on_oop_field_preloaded(p, o);
  }
  
  inline oop ZBarrier::weak_load_barrier_on_oop_field_preloaded(volatile oop* p, oop o) {
    return weak_barrier&lt;is_weak_good_or_null_fast_path, weak_load_barrier_on_oop_slow_path&gt;(p, o);
<span class="line-new-header">--- 280,11 ---</span>
  //
  // Weak load barrier
  //
  inline oop ZBarrier::weak_load_barrier_on_oop_field(volatile oop* p) {
    assert(!ZResurrection::is_blocked(), &quot;Should not be called during resurrection blocked phase&quot;);
<span class="line-modified">!   const oop o = Atomic::load(p);</span>
    return weak_load_barrier_on_oop_field_preloaded(p, o);
  }
  
  inline oop ZBarrier::weak_load_barrier_on_oop_field_preloaded(volatile oop* p, oop o) {
    return weak_barrier&lt;is_weak_good_or_null_fast_path, weak_load_barrier_on_oop_slow_path&gt;(p, o);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 293,11 ***</span>
  inline oop ZBarrier::weak_load_barrier_on_weak_oop(oop o) {
    return weak_load_barrier_on_weak_oop_field_preloaded((oop*)NULL, o);
  }
  
  inline oop ZBarrier::weak_load_barrier_on_weak_oop_field(volatile oop* p) {
<span class="line-modified">!   const oop o = *p;</span>
    return weak_load_barrier_on_weak_oop_field_preloaded(p, o);
  }
  
  inline oop ZBarrier::weak_load_barrier_on_weak_oop_field_preloaded(volatile oop* p, oop o) {
    verify_on_weak(p);
<span class="line-new-header">--- 293,11 ---</span>
  inline oop ZBarrier::weak_load_barrier_on_weak_oop(oop o) {
    return weak_load_barrier_on_weak_oop_field_preloaded((oop*)NULL, o);
  }
  
  inline oop ZBarrier::weak_load_barrier_on_weak_oop_field(volatile oop* p) {
<span class="line-modified">!   const oop o = Atomic::load(p);</span>
    return weak_load_barrier_on_weak_oop_field_preloaded(p, o);
  }
  
  inline oop ZBarrier::weak_load_barrier_on_weak_oop_field_preloaded(volatile oop* p, oop o) {
    verify_on_weak(p);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 312,11 ***</span>
  inline oop ZBarrier::weak_load_barrier_on_phantom_oop(oop o) {
    return weak_load_barrier_on_phantom_oop_field_preloaded((oop*)NULL, o);
  }
  
  inline oop ZBarrier::weak_load_barrier_on_phantom_oop_field(volatile oop* p) {
<span class="line-modified">!   const oop o = *p;</span>
    return weak_load_barrier_on_phantom_oop_field_preloaded(p, o);
  }
  
  inline oop ZBarrier::weak_load_barrier_on_phantom_oop_field_preloaded(volatile oop* p, oop o) {
    if (ZResurrection::is_blocked()) {
<span class="line-new-header">--- 312,11 ---</span>
  inline oop ZBarrier::weak_load_barrier_on_phantom_oop(oop o) {
    return weak_load_barrier_on_phantom_oop_field_preloaded((oop*)NULL, o);
  }
  
  inline oop ZBarrier::weak_load_barrier_on_phantom_oop_field(volatile oop* p) {
<span class="line-modified">!   const oop o = Atomic::load(p);</span>
    return weak_load_barrier_on_phantom_oop_field_preloaded(p, o);
  }
  
  inline oop ZBarrier::weak_load_barrier_on_phantom_oop_field_preloaded(volatile oop* p, oop o) {
    if (ZResurrection::is_blocked()) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 347,18 ***</span>
  // Keep alive barrier
  //
  inline void ZBarrier::keep_alive_barrier_on_weak_oop_field(volatile oop* p) {
    // This operation is only valid when resurrection is blocked.
    assert(ZResurrection::is_blocked(), &quot;Invalid phase&quot;);
<span class="line-modified">!   const oop o = *p;</span>
    barrier&lt;is_good_or_null_fast_path, keep_alive_barrier_on_weak_oop_slow_path&gt;(p, o);
  }
  
  inline void ZBarrier::keep_alive_barrier_on_phantom_oop_field(volatile oop* p) {
    // This operation is only valid when resurrection is blocked.
    assert(ZResurrection::is_blocked(), &quot;Invalid phase&quot;);
<span class="line-modified">!   const oop o = *p;</span>
    barrier&lt;is_good_or_null_fast_path, keep_alive_barrier_on_phantom_oop_slow_path&gt;(p, o);
  }
  
  inline void ZBarrier::keep_alive_barrier_on_phantom_root_oop_field(oop* p) {
    // This operation is only valid when resurrection is blocked.
<span class="line-new-header">--- 347,18 ---</span>
  // Keep alive barrier
  //
  inline void ZBarrier::keep_alive_barrier_on_weak_oop_field(volatile oop* p) {
    // This operation is only valid when resurrection is blocked.
    assert(ZResurrection::is_blocked(), &quot;Invalid phase&quot;);
<span class="line-modified">!   const oop o = Atomic::load(p);</span>
    barrier&lt;is_good_or_null_fast_path, keep_alive_barrier_on_weak_oop_slow_path&gt;(p, o);
  }
  
  inline void ZBarrier::keep_alive_barrier_on_phantom_oop_field(volatile oop* p) {
    // This operation is only valid when resurrection is blocked.
    assert(ZResurrection::is_blocked(), &quot;Invalid phase&quot;);
<span class="line-modified">!   const oop o = Atomic::load(p);</span>
    barrier&lt;is_good_or_null_fast_path, keep_alive_barrier_on_phantom_oop_slow_path&gt;(p, o);
  }
  
  inline void ZBarrier::keep_alive_barrier_on_phantom_root_oop_field(oop* p) {
    // This operation is only valid when resurrection is blocked.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 378,11 ***</span>
  
  //
  // Mark barrier
  //
  inline void ZBarrier::mark_barrier_on_oop_field(volatile oop* p, bool finalizable) {
<span class="line-modified">!   const oop o = *p;</span>
  
    if (finalizable) {
      barrier&lt;is_marked_or_null_fast_path, mark_barrier_on_finalizable_oop_slow_path&gt;(p, o);
    } else {
      const uintptr_t addr = ZOop::to_address(o);
<span class="line-new-header">--- 378,11 ---</span>
  
  //
  // Mark barrier
  //
  inline void ZBarrier::mark_barrier_on_oop_field(volatile oop* p, bool finalizable) {
<span class="line-modified">!   const oop o = Atomic::load(p);</span>
  
    if (finalizable) {
      barrier&lt;is_marked_or_null_fast_path, mark_barrier_on_finalizable_oop_slow_path&gt;(p, o);
    } else {
      const uintptr_t addr = ZOop::to_address(o);
</pre>
<center><a href="zArguments.hpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="zPhysicalMemory.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>