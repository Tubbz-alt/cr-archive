<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/runtime/arguments.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../prims/whitebox.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="arguments.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/runtime/arguments.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 508 // This table ensures that the handling of options will update automatically when the JDK
 509 // version is incremented, but the source code needs to be cleanup up manually:
 510 // - As &quot;deprecated&quot; options age into &quot;obsolete&quot; or &quot;expired&quot; options, the associated &quot;globals&quot;
 511 //   variable should be removed, as well as users of the variable.
 512 // - As &quot;deprecated&quot; options age into &quot;obsolete&quot; options, move the entry into the
 513 //   &quot;Obsolete Flags&quot; section of the table.
 514 // - All expired options should be removed from the table.
 515 static SpecialFlag const special_jvm_flags[] = {
 516   // -------------- Deprecated Flags --------------
 517   // --- Non-alias flags - sorted by obsolete_in then expired_in:
 518   { &quot;MaxGCMinorPauseMillis&quot;,        JDK_Version::jdk(8), JDK_Version::undefined(), JDK_Version::undefined() },
 519   { &quot;MaxRAMFraction&quot;,               JDK_Version::jdk(10),  JDK_Version::undefined(), JDK_Version::undefined() },
 520   { &quot;MinRAMFraction&quot;,               JDK_Version::jdk(10),  JDK_Version::undefined(), JDK_Version::undefined() },
 521   { &quot;InitialRAMFraction&quot;,           JDK_Version::jdk(10),  JDK_Version::undefined(), JDK_Version::undefined() },
 522   { &quot;UseMembar&quot;,                    JDK_Version::jdk(10), JDK_Version::jdk(12), JDK_Version::undefined() },
 523   { &quot;AllowRedefinitionToAddDeleteMethods&quot;, JDK_Version::jdk(13), JDK_Version::undefined(), JDK_Version::undefined() },
 524   { &quot;FlightRecorder&quot;,               JDK_Version::jdk(13), JDK_Version::undefined(), JDK_Version::undefined() },
 525   { &quot;PrintVMQWaitTime&quot;,             JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },
 526   { &quot;UseNewFieldLayout&quot;,            JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },
 527   { &quot;ForceNUMA&quot;,                    JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },










 528 
 529   // --- Deprecated alias flags (see also aliased_jvm_flags) - sorted by obsolete_in then expired_in:
 530   { &quot;DefaultMaxRAMFraction&quot;,        JDK_Version::jdk(8),  JDK_Version::undefined(), JDK_Version::undefined() },
 531   { &quot;CreateMinidumpOnCrash&quot;,        JDK_Version::jdk(9),  JDK_Version::undefined(), JDK_Version::undefined() },
 532   { &quot;TLABStats&quot;,                    JDK_Version::jdk(12), JDK_Version::undefined(), JDK_Version::undefined() },
 533 
 534   // -------------- Obsolete Flags - sorted by expired_in --------------
 535   { &quot;PermSize&quot;,                      JDK_Version::undefined(), JDK_Version::jdk(8),  JDK_Version::undefined() },
 536   { &quot;MaxPermSize&quot;,                   JDK_Version::undefined(), JDK_Version::jdk(8),  JDK_Version::undefined() },
 537   { &quot;SharedReadWriteSize&quot;,           JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 538   { &quot;SharedReadOnlySize&quot;,            JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 539   { &quot;SharedMiscDataSize&quot;,            JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 540   { &quot;SharedMiscCodeSize&quot;,            JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 541   { &quot;BindGCTaskThreadsToCPUs&quot;,       JDK_Version::undefined(), JDK_Version::jdk(14), JDK_Version::jdk(16) },
 542   { &quot;UseGCTaskAffinity&quot;,             JDK_Version::undefined(), JDK_Version::jdk(14), JDK_Version::jdk(16) },
 543   { &quot;GCTaskTimeStampEntries&quot;,        JDK_Version::undefined(), JDK_Version::jdk(14), JDK_Version::jdk(16) },
 544   { &quot;G1RSetScanBlockSize&quot;,           JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 545   { &quot;UseParallelOldGC&quot;,              JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 546   { &quot;CompactFields&quot;,                 JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 547   { &quot;FieldsAllocationStyle&quot;,         JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 548 #ifndef X86
 549   { &quot;UseSSE&quot;,                        JDK_Version::undefined(), JDK_Version::jdk(15), JDK_Version::jdk(16) },
 550 #endif // !X86
 551   { &quot;UseAdaptiveGCBoundary&quot;,         JDK_Version::undefined(), JDK_Version::jdk(15), JDK_Version::jdk(16) },
 552   { &quot;MonitorBound&quot;,                  JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 553 
 554 #ifdef TEST_VERIFY_SPECIAL_JVM_FLAGS
 555   // These entries will generate build errors.  Their purpose is to test the macros.
 556   { &quot;dep &gt; obs&quot;,                    JDK_Version::jdk(9), JDK_Version::jdk(8), JDK_Version::undefined() },
 557   { &quot;dep &gt; exp &quot;,                   JDK_Version::jdk(9), JDK_Version::undefined(), JDK_Version::jdk(8) },
 558   { &quot;obs &gt; exp &quot;,                   JDK_Version::undefined(), JDK_Version::jdk(9), JDK_Version::jdk(8) },
 559   { &quot;obs &gt; exp&quot;,                    JDK_Version::jdk(8), JDK_Version::undefined(), JDK_Version::jdk(10) },
 560   { &quot;not deprecated or obsolete&quot;,   JDK_Version::undefined(), JDK_Version::undefined(), JDK_Version::jdk(9) },
 561   { &quot;dup option&quot;,                   JDK_Version::jdk(9), JDK_Version::undefined(), JDK_Version::undefined() },
 562   { &quot;dup option&quot;,                   JDK_Version::jdk(9), JDK_Version::undefined(), JDK_Version::undefined() },
 563 #endif
 564 










 565   { NULL, JDK_Version(0), JDK_Version(0) }
 566 };
 567 
 568 // Flags that are aliases for other flags.
 569 typedef struct {
 570   const char* alias_name;
 571   const char* real_name;
 572 } AliasedFlag;
 573 
 574 static AliasedFlag const aliased_jvm_flags[] = {
 575   { &quot;DefaultMaxRAMFraction&quot;,    &quot;MaxRAMFraction&quot;    },
 576   { &quot;CreateMinidumpOnCrash&quot;,    &quot;CreateCoredumpOnCrash&quot; },
 577   { NULL, NULL}
 578 };
 579 
 580 // NOTE: A compatibility request will be necessary for each alias to be removed.
 581 static AliasedLoggingFlag const aliased_logging_flags[] = {
 582   { &quot;PrintCompressedOopsMode&quot;,   LogLevel::Info,  true,  LOG_TAGS(gc, heap, coops) },
 583   { &quot;PrintSharedSpaces&quot;,         LogLevel::Info,  true,  LOG_TAGS(cds) },
 584   { &quot;TraceBiasedLocking&quot;,        LogLevel::Info,  true,  LOG_TAGS(biasedlocking) },
</pre>
<hr />
<pre>
3510     // steal a white space character and set it to NULL
3511     *wrt++ = &#39;\0&#39;;
3512     // We now have a complete token
3513 
3514     JavaVMOption option;
3515     option.optionString = opt_hd;
3516     option.extraInfo = NULL;
3517 
3518     options-&gt;append(option);                // Fill in option
3519 
3520     rd++;  // Advance to next character
3521   }
3522 
3523   // Fill out JavaVMInitArgs structure.
3524   jint status = vm_args-&gt;set_args(options);
3525 
3526   delete options;
3527   return status;
3528 }
3529 
<span class="line-modified">3530 void Arguments::set_shared_spaces_flags() {</span>
3531   if (DumpSharedSpaces) {
3532     if (RequireSharedSpaces) {
3533       warning(&quot;Cannot dump shared archive while using shared archive&quot;);
3534     }
3535     UseSharedSpaces = false;
3536   }








3537 }
3538 
3539 #if INCLUDE_CDS
3540 // Sharing support
3541 // Construct the path to the archive
3542 char* Arguments::get_default_shared_archive_path() {
3543   char *default_archive_path;
3544   char jvm_path[JVM_MAXPATHLEN];
3545   os::jvm_path(jvm_path, sizeof(jvm_path));
3546   char *end = strrchr(jvm_path, *os::file_separator());
3547   if (end != NULL) *end = &#39;\0&#39;;
3548   size_t jvm_path_len = strlen(jvm_path);
3549   size_t file_sep_len = strlen(os::file_separator());
3550   const size_t len = jvm_path_len + file_sep_len + 20;
3551   default_archive_path = NEW_C_HEAP_ARRAY(char, len, mtArguments);
<span class="line-modified">3552   jio_snprintf(default_archive_path, len, &quot;%s%sclasses.jsa&quot;,</span>

3553                jvm_path, os::file_separator());
3554   return default_archive_path;
3555 }
3556 
3557 int Arguments::num_archives(const char* archive_path) {
3558   if (archive_path == NULL) {
3559     return 0;
3560   }
3561   int npaths = 1;
3562   char* p = (char*)archive_path;
3563   while (*p != &#39;\0&#39;) {
3564     if (*p == os::path_separator()[0]) {
3565       npaths++;
3566     }
3567     p++;
3568   }
3569   return npaths;
3570 }
3571 
3572 void Arguments::extract_shared_archive_paths(const char* archive_path,
</pre>
<hr />
<pre>
3977     }
3978 #endif
3979   }
3980 
3981   if (PrintVMOptions) {
3982     print_options(cur_java_tool_options_args);
3983     print_options(cur_cmd_args);
3984     print_options(cur_java_options_args);
3985   }
3986 
3987   // Parse JavaVMInitArgs structure passed in, as well as JAVA_TOOL_OPTIONS and _JAVA_OPTIONS
3988   jint result = parse_vm_init_args(cur_vm_options_args,
3989                                    cur_java_tool_options_args,
3990                                    cur_java_options_args,
3991                                    cur_cmd_args);
3992 
3993   if (result != JNI_OK) {
3994     return result;
3995   }
3996 
<span class="line-removed">3997 #if INCLUDE_CDS</span>
<span class="line-removed">3998   // Initialize shared archive paths which could include both base and dynamic archive paths</span>
<span class="line-removed">3999   if (!init_shared_archive_paths()) {</span>
<span class="line-removed">4000     return JNI_ENOMEM;</span>
<span class="line-removed">4001   }</span>
<span class="line-removed">4002 #endif</span>
<span class="line-removed">4003 </span>
4004   // Delay warning until here so that we&#39;ve had a chance to process
4005   // the -XX:-PrintWarnings flag
4006   if (needs_hotspotrc_warning) {
4007     warning(&quot;%s file is present but has been ignored.  &quot;
4008             &quot;Run with -XX:Flags=%s to load the file.&quot;,
4009             hotspotrc, hotspotrc);
4010   }
4011 
4012   if (needs_module_property_warning) {
4013     warning(&quot;Ignoring system property options whose names match the &#39;-Djdk.module.*&#39;.&quot;
4014             &quot; names that are reserved for internal use.&quot;);
4015   }
4016 
4017 #if defined(_ALLBSD_SOURCE) || defined(AIX)  // UseLargePages is not yet supported on BSD and AIX.
4018   UNSUPPORTED_OPTION(UseLargePages);
4019 #endif
4020 
4021 #if defined(AIX)
4022   UNSUPPORTED_OPTION_NULL(AllocateHeapAt);
4023   UNSUPPORTED_OPTION_NULL(AllocateOldGenAt);
</pre>
<hr />
<pre>
4071 
4072 #ifndef TIERED
4073   if (FLAG_IS_CMDLINE(CompilationMode)) {
4074     warning(&quot;CompilationMode has no effect in non-tiered VMs&quot;);
4075   }
4076 #endif
4077 
4078   return JNI_OK;
4079 }
4080 
4081 jint Arguments::apply_ergo() {
4082   // Set flags based on ergonomics.
4083   jint result = set_ergonomics_flags();
4084   if (result != JNI_OK) return result;
4085 
4086   // Set heap size based on available physical memory
4087   set_heap_size();
4088 
4089   GCConfig::arguments()-&gt;initialize();
4090 
<span class="line-modified">4091   set_shared_spaces_flags();</span>

4092 
4093   // Initialize Metaspace flags and alignments
4094   Metaspace::ergo_initialize();
4095 
4096   // Set compiler flags after GC is selected and GC specific
4097   // flags (LoopStripMiningIter) are set.
4098   CompilerConfig::ergo_initialize();
4099 
4100   // Set bytecode rewriting flags
4101   set_bytecode_flags();
4102 
4103   // Set flags if aggressive optimization flags are enabled
4104   jint code = set_aggressive_opts_flags();
4105   if (code != JNI_OK) {
4106     return code;
4107   }
4108 
4109   // Turn off biased locking for locking debug mode flags,
4110   // which are subtly different from each other but neither works with
4111   // biased locking
</pre>
</td>
<td>
<hr />
<pre>
 508 // This table ensures that the handling of options will update automatically when the JDK
 509 // version is incremented, but the source code needs to be cleanup up manually:
 510 // - As &quot;deprecated&quot; options age into &quot;obsolete&quot; or &quot;expired&quot; options, the associated &quot;globals&quot;
 511 //   variable should be removed, as well as users of the variable.
 512 // - As &quot;deprecated&quot; options age into &quot;obsolete&quot; options, move the entry into the
 513 //   &quot;Obsolete Flags&quot; section of the table.
 514 // - All expired options should be removed from the table.
 515 static SpecialFlag const special_jvm_flags[] = {
 516   // -------------- Deprecated Flags --------------
 517   // --- Non-alias flags - sorted by obsolete_in then expired_in:
 518   { &quot;MaxGCMinorPauseMillis&quot;,        JDK_Version::jdk(8), JDK_Version::undefined(), JDK_Version::undefined() },
 519   { &quot;MaxRAMFraction&quot;,               JDK_Version::jdk(10),  JDK_Version::undefined(), JDK_Version::undefined() },
 520   { &quot;MinRAMFraction&quot;,               JDK_Version::jdk(10),  JDK_Version::undefined(), JDK_Version::undefined() },
 521   { &quot;InitialRAMFraction&quot;,           JDK_Version::jdk(10),  JDK_Version::undefined(), JDK_Version::undefined() },
 522   { &quot;UseMembar&quot;,                    JDK_Version::jdk(10), JDK_Version::jdk(12), JDK_Version::undefined() },
 523   { &quot;AllowRedefinitionToAddDeleteMethods&quot;, JDK_Version::jdk(13), JDK_Version::undefined(), JDK_Version::undefined() },
 524   { &quot;FlightRecorder&quot;,               JDK_Version::jdk(13), JDK_Version::undefined(), JDK_Version::undefined() },
 525   { &quot;PrintVMQWaitTime&quot;,             JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },
 526   { &quot;UseNewFieldLayout&quot;,            JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },
 527   { &quot;ForceNUMA&quot;,                    JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },
<span class="line-added"> 528   { &quot;UseBiasedLocking&quot;,             JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },</span>
<span class="line-added"> 529   { &quot;BiasedLockingStartupDelay&quot;,    JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },</span>
<span class="line-added"> 530   { &quot;PrintBiasedLockingStatistics&quot;, JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },</span>
<span class="line-added"> 531   { &quot;BiasedLockingBulkRebiasThreshold&quot;,    JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },</span>
<span class="line-added"> 532   { &quot;BiasedLockingBulkRevokeThreshold&quot;,    JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },</span>
<span class="line-added"> 533   { &quot;BiasedLockingDecayTime&quot;,              JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },</span>
<span class="line-added"> 534   { &quot;UseOptoBiasInlining&quot;,                 JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },</span>
<span class="line-added"> 535   { &quot;PrintPreciseBiasedLockingStatistics&quot;, JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },</span>
<span class="line-added"> 536   { &quot;InitialBootClassLoaderMetaspaceSize&quot;, JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },</span>
<span class="line-added"> 537   { &quot;UseLargePagesInMetaspace&quot;,            JDK_Version::jdk(15), JDK_Version::jdk(16), JDK_Version::jdk(17) },</span>
 538 
 539   // --- Deprecated alias flags (see also aliased_jvm_flags) - sorted by obsolete_in then expired_in:
 540   { &quot;DefaultMaxRAMFraction&quot;,        JDK_Version::jdk(8),  JDK_Version::undefined(), JDK_Version::undefined() },
 541   { &quot;CreateMinidumpOnCrash&quot;,        JDK_Version::jdk(9),  JDK_Version::undefined(), JDK_Version::undefined() },
 542   { &quot;TLABStats&quot;,                    JDK_Version::jdk(12), JDK_Version::undefined(), JDK_Version::undefined() },
 543 
 544   // -------------- Obsolete Flags - sorted by expired_in --------------
 545   { &quot;PermSize&quot;,                      JDK_Version::undefined(), JDK_Version::jdk(8),  JDK_Version::undefined() },
 546   { &quot;MaxPermSize&quot;,                   JDK_Version::undefined(), JDK_Version::jdk(8),  JDK_Version::undefined() },
 547   { &quot;SharedReadWriteSize&quot;,           JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 548   { &quot;SharedReadOnlySize&quot;,            JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 549   { &quot;SharedMiscDataSize&quot;,            JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 550   { &quot;SharedMiscCodeSize&quot;,            JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 551   { &quot;BindGCTaskThreadsToCPUs&quot;,       JDK_Version::undefined(), JDK_Version::jdk(14), JDK_Version::jdk(16) },
 552   { &quot;UseGCTaskAffinity&quot;,             JDK_Version::undefined(), JDK_Version::jdk(14), JDK_Version::jdk(16) },
 553   { &quot;GCTaskTimeStampEntries&quot;,        JDK_Version::undefined(), JDK_Version::jdk(14), JDK_Version::jdk(16) },
 554   { &quot;G1RSetScanBlockSize&quot;,           JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 555   { &quot;UseParallelOldGC&quot;,              JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 556   { &quot;CompactFields&quot;,                 JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 557   { &quot;FieldsAllocationStyle&quot;,         JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 558 #ifndef X86
 559   { &quot;UseSSE&quot;,                        JDK_Version::undefined(), JDK_Version::jdk(15), JDK_Version::jdk(16) },
 560 #endif // !X86
 561   { &quot;UseAdaptiveGCBoundary&quot;,         JDK_Version::undefined(), JDK_Version::jdk(15), JDK_Version::jdk(16) },
 562   { &quot;MonitorBound&quot;,                  JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 563 
 564 #ifdef TEST_VERIFY_SPECIAL_JVM_FLAGS
 565   // These entries will generate build errors.  Their purpose is to test the macros.
 566   { &quot;dep &gt; obs&quot;,                    JDK_Version::jdk(9), JDK_Version::jdk(8), JDK_Version::undefined() },
 567   { &quot;dep &gt; exp &quot;,                   JDK_Version::jdk(9), JDK_Version::undefined(), JDK_Version::jdk(8) },
 568   { &quot;obs &gt; exp &quot;,                   JDK_Version::undefined(), JDK_Version::jdk(9), JDK_Version::jdk(8) },
 569   { &quot;obs &gt; exp&quot;,                    JDK_Version::jdk(8), JDK_Version::undefined(), JDK_Version::jdk(10) },
 570   { &quot;not deprecated or obsolete&quot;,   JDK_Version::undefined(), JDK_Version::undefined(), JDK_Version::jdk(9) },
 571   { &quot;dup option&quot;,                   JDK_Version::jdk(9), JDK_Version::undefined(), JDK_Version::undefined() },
 572   { &quot;dup option&quot;,                   JDK_Version::jdk(9), JDK_Version::undefined(), JDK_Version::undefined() },
 573 #endif
 574 
<span class="line-added"> 575 #ifndef COMPILER2</span>
<span class="line-added"> 576   // These flags were generally available, but are C2 only, now.</span>
<span class="line-added"> 577   { &quot;MaxInlineLevel&quot;,               JDK_Version::undefined(), JDK_Version::jdk(15), JDK_Version::jdk(16) },</span>
<span class="line-added"> 578   { &quot;MaxRecursiveInlineLevel&quot;,      JDK_Version::undefined(), JDK_Version::jdk(15), JDK_Version::jdk(16) },</span>
<span class="line-added"> 579   { &quot;InlineSmallCode&quot;,              JDK_Version::undefined(), JDK_Version::jdk(15), JDK_Version::jdk(16) },</span>
<span class="line-added"> 580   { &quot;MaxInlineSize&quot;,                JDK_Version::undefined(), JDK_Version::jdk(15), JDK_Version::jdk(16) },</span>
<span class="line-added"> 581   { &quot;FreqInlineSize&quot;,               JDK_Version::undefined(), JDK_Version::jdk(15), JDK_Version::jdk(16) },</span>
<span class="line-added"> 582   { &quot;MaxTrivialSize&quot;,               JDK_Version::undefined(), JDK_Version::jdk(15), JDK_Version::jdk(16) },</span>
<span class="line-added"> 583 #endif</span>
<span class="line-added"> 584 </span>
 585   { NULL, JDK_Version(0), JDK_Version(0) }
 586 };
 587 
 588 // Flags that are aliases for other flags.
 589 typedef struct {
 590   const char* alias_name;
 591   const char* real_name;
 592 } AliasedFlag;
 593 
 594 static AliasedFlag const aliased_jvm_flags[] = {
 595   { &quot;DefaultMaxRAMFraction&quot;,    &quot;MaxRAMFraction&quot;    },
 596   { &quot;CreateMinidumpOnCrash&quot;,    &quot;CreateCoredumpOnCrash&quot; },
 597   { NULL, NULL}
 598 };
 599 
 600 // NOTE: A compatibility request will be necessary for each alias to be removed.
 601 static AliasedLoggingFlag const aliased_logging_flags[] = {
 602   { &quot;PrintCompressedOopsMode&quot;,   LogLevel::Info,  true,  LOG_TAGS(gc, heap, coops) },
 603   { &quot;PrintSharedSpaces&quot;,         LogLevel::Info,  true,  LOG_TAGS(cds) },
 604   { &quot;TraceBiasedLocking&quot;,        LogLevel::Info,  true,  LOG_TAGS(biasedlocking) },
</pre>
<hr />
<pre>
3530     // steal a white space character and set it to NULL
3531     *wrt++ = &#39;\0&#39;;
3532     // We now have a complete token
3533 
3534     JavaVMOption option;
3535     option.optionString = opt_hd;
3536     option.extraInfo = NULL;
3537 
3538     options-&gt;append(option);                // Fill in option
3539 
3540     rd++;  // Advance to next character
3541   }
3542 
3543   // Fill out JavaVMInitArgs structure.
3544   jint status = vm_args-&gt;set_args(options);
3545 
3546   delete options;
3547   return status;
3548 }
3549 
<span class="line-modified">3550 jint Arguments::set_shared_spaces_flags_and_archive_paths() {</span>
3551   if (DumpSharedSpaces) {
3552     if (RequireSharedSpaces) {
3553       warning(&quot;Cannot dump shared archive while using shared archive&quot;);
3554     }
3555     UseSharedSpaces = false;
3556   }
<span class="line-added">3557 #if INCLUDE_CDS</span>
<span class="line-added">3558   // Initialize shared archive paths which could include both base and dynamic archive paths</span>
<span class="line-added">3559   // This must be after set_ergonomics_flags() called so flag UseCompressedOops is set properly.</span>
<span class="line-added">3560   if (!init_shared_archive_paths()) {</span>
<span class="line-added">3561     return JNI_ENOMEM;</span>
<span class="line-added">3562   }</span>
<span class="line-added">3563 #endif  // INCLUDE_CDS</span>
<span class="line-added">3564   return JNI_OK;</span>
3565 }
3566 
3567 #if INCLUDE_CDS
3568 // Sharing support
3569 // Construct the path to the archive
3570 char* Arguments::get_default_shared_archive_path() {
3571   char *default_archive_path;
3572   char jvm_path[JVM_MAXPATHLEN];
3573   os::jvm_path(jvm_path, sizeof(jvm_path));
3574   char *end = strrchr(jvm_path, *os::file_separator());
3575   if (end != NULL) *end = &#39;\0&#39;;
3576   size_t jvm_path_len = strlen(jvm_path);
3577   size_t file_sep_len = strlen(os::file_separator());
3578   const size_t len = jvm_path_len + file_sep_len + 20;
3579   default_archive_path = NEW_C_HEAP_ARRAY(char, len, mtArguments);
<span class="line-modified">3580   jio_snprintf(default_archive_path, len,</span>
<span class="line-added">3581                UseCompressedOops ? &quot;%s%sclasses.jsa&quot;: &quot;%s%sclasses_nocoops.jsa&quot;,</span>
3582                jvm_path, os::file_separator());
3583   return default_archive_path;
3584 }
3585 
3586 int Arguments::num_archives(const char* archive_path) {
3587   if (archive_path == NULL) {
3588     return 0;
3589   }
3590   int npaths = 1;
3591   char* p = (char*)archive_path;
3592   while (*p != &#39;\0&#39;) {
3593     if (*p == os::path_separator()[0]) {
3594       npaths++;
3595     }
3596     p++;
3597   }
3598   return npaths;
3599 }
3600 
3601 void Arguments::extract_shared_archive_paths(const char* archive_path,
</pre>
<hr />
<pre>
4006     }
4007 #endif
4008   }
4009 
4010   if (PrintVMOptions) {
4011     print_options(cur_java_tool_options_args);
4012     print_options(cur_cmd_args);
4013     print_options(cur_java_options_args);
4014   }
4015 
4016   // Parse JavaVMInitArgs structure passed in, as well as JAVA_TOOL_OPTIONS and _JAVA_OPTIONS
4017   jint result = parse_vm_init_args(cur_vm_options_args,
4018                                    cur_java_tool_options_args,
4019                                    cur_java_options_args,
4020                                    cur_cmd_args);
4021 
4022   if (result != JNI_OK) {
4023     return result;
4024   }
4025 







4026   // Delay warning until here so that we&#39;ve had a chance to process
4027   // the -XX:-PrintWarnings flag
4028   if (needs_hotspotrc_warning) {
4029     warning(&quot;%s file is present but has been ignored.  &quot;
4030             &quot;Run with -XX:Flags=%s to load the file.&quot;,
4031             hotspotrc, hotspotrc);
4032   }
4033 
4034   if (needs_module_property_warning) {
4035     warning(&quot;Ignoring system property options whose names match the &#39;-Djdk.module.*&#39;.&quot;
4036             &quot; names that are reserved for internal use.&quot;);
4037   }
4038 
4039 #if defined(_ALLBSD_SOURCE) || defined(AIX)  // UseLargePages is not yet supported on BSD and AIX.
4040   UNSUPPORTED_OPTION(UseLargePages);
4041 #endif
4042 
4043 #if defined(AIX)
4044   UNSUPPORTED_OPTION_NULL(AllocateHeapAt);
4045   UNSUPPORTED_OPTION_NULL(AllocateOldGenAt);
</pre>
<hr />
<pre>
4093 
4094 #ifndef TIERED
4095   if (FLAG_IS_CMDLINE(CompilationMode)) {
4096     warning(&quot;CompilationMode has no effect in non-tiered VMs&quot;);
4097   }
4098 #endif
4099 
4100   return JNI_OK;
4101 }
4102 
4103 jint Arguments::apply_ergo() {
4104   // Set flags based on ergonomics.
4105   jint result = set_ergonomics_flags();
4106   if (result != JNI_OK) return result;
4107 
4108   // Set heap size based on available physical memory
4109   set_heap_size();
4110 
4111   GCConfig::arguments()-&gt;initialize();
4112 
<span class="line-modified">4113   result = set_shared_spaces_flags_and_archive_paths();</span>
<span class="line-added">4114   if (result != JNI_OK) return result;</span>
4115 
4116   // Initialize Metaspace flags and alignments
4117   Metaspace::ergo_initialize();
4118 
4119   // Set compiler flags after GC is selected and GC specific
4120   // flags (LoopStripMiningIter) are set.
4121   CompilerConfig::ergo_initialize();
4122 
4123   // Set bytecode rewriting flags
4124   set_bytecode_flags();
4125 
4126   // Set flags if aggressive optimization flags are enabled
4127   jint code = set_aggressive_opts_flags();
4128   if (code != JNI_OK) {
4129     return code;
4130   }
4131 
4132   // Turn off biased locking for locking debug mode flags,
4133   // which are subtly different from each other but neither works with
4134   // biased locking
</pre>
</td>
</tr>
</table>
<center><a href="../prims/whitebox.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="arguments.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>