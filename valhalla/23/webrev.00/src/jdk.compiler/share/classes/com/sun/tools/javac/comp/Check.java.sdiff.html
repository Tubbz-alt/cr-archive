<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.compiler/share/classes/com/sun/tools/javac/comp/Check.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Attr.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="TypeEnter.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.compiler/share/classes/com/sun/tools/javac/comp/Check.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 726     /** Check that type is a class or interface type.
 727      *  @param pos           Position to be used for error reporting.
 728      *  @param t             The type to be checked.
 729      */
 730     Type checkClassType(DiagnosticPosition pos, Type t) {
 731         if (!t.hasTag(CLASS) &amp;&amp; !t.hasTag(ERROR)) {
 732             return typeTagError(pos,
 733                                 diags.fragment(Fragments.TypeReqClass),
 734                                 asTypeParam(t));
 735         } else {
 736             return t;
 737         }
 738     }
 739     //where
 740         private Object asTypeParam(Type t) {
 741             return (t.hasTag(TYPEVAR))
 742                                     ? diags.fragment(Fragments.TypeParameter(t))
 743                                     : t;
 744         }
 745 












































 746     /** Check that type is a valid qualifier for a constructor reference expression
 747      */
 748     Type checkConstructorRefType(DiagnosticPosition pos, Type t) {
 749         t = checkClassOrArrayType(pos, t);
 750         if (t.hasTag(CLASS)) {
 751             if ((t.tsym.flags() &amp; (ABSTRACT | INTERFACE)) != 0) {
 752                 log.error(pos, Errors.AbstractCantBeInstantiated(t.tsym));
 753                 t = types.createErrorType(t);
 754             } else if ((t.tsym.flags() &amp; ENUM) != 0) {
 755                 log.error(pos, Errors.EnumCantBeInstantiated);
 756                 t = types.createErrorType(t);
 757             } else {
 758                 t = checkClassType(pos, t, true);
 759             }
 760         } else if (t.hasTag(ARRAY)) {
 761             if (!types.isReifiable(((ArrayType)t).elemtype)) {
 762                 log.error(pos, Errors.GenericArrayCreation);
 763                 t = types.createErrorType(t);
 764             }
 765         }
</pre>
</td>
<td>
<hr />
<pre>
 726     /** Check that type is a class or interface type.
 727      *  @param pos           Position to be used for error reporting.
 728      *  @param t             The type to be checked.
 729      */
 730     Type checkClassType(DiagnosticPosition pos, Type t) {
 731         if (!t.hasTag(CLASS) &amp;&amp; !t.hasTag(ERROR)) {
 732             return typeTagError(pos,
 733                                 diags.fragment(Fragments.TypeReqClass),
 734                                 asTypeParam(t));
 735         } else {
 736             return t;
 737         }
 738     }
 739     //where
 740         private Object asTypeParam(Type t) {
 741             return (t.hasTag(TYPEVAR))
 742                                     ? diags.fragment(Fragments.TypeParameter(t))
 743                                     : t;
 744         }
 745 
<span class="line-added"> 746     void checkConstraintsOfInlineSuper(DiagnosticPosition pos, ClassSymbol c) {</span>
<span class="line-added"> 747         boolean indirectSuper = false;</span>
<span class="line-added"> 748         for(Type st = types.supertype(c.type); st != Type.noType; indirectSuper = true, st = types.supertype(st)) {</span>
<span class="line-added"> 749             if (st == null || st.tsym == null || st.tsym.kind == ERR)</span>
<span class="line-added"> 750                 return;</span>
<span class="line-added"> 751             if  (indirectSuper &amp;&amp; st.tsym == syms.objectType.tsym)</span>
<span class="line-added"> 752                 return;</span>
<span class="line-added"> 753             if (!st.tsym.isAbstract()) {</span>
<span class="line-added"> 754                 log.error(pos, Errors.ConcreteSupertypeForInlineClass(c, st));</span>
<span class="line-added"> 755             }</span>
<span class="line-added"> 756             if ((st.tsym.flags() &amp; HASINITBLOCK) != 0) {</span>
<span class="line-added"> 757                 log.error(pos, Errors.SuperClassDeclaresInitBlock(c, st));</span>
<span class="line-added"> 758             }</span>
<span class="line-added"> 759             // No instance fields and no arged constructors both mean inner classes cannot be inline supers.</span>
<span class="line-added"> 760             Type encl = st.getEnclosingType();</span>
<span class="line-added"> 761             if (encl != null &amp;&amp; encl.hasTag(CLASS)) {</span>
<span class="line-added"> 762                 log.error(pos, Errors.SuperClassCannotBeInner(c, st));</span>
<span class="line-added"> 763             }</span>
<span class="line-added"> 764             for (Symbol s : st.tsym.members().getSymbols(NON_RECURSIVE)) {</span>
<span class="line-added"> 765                 switch (s.kind) {</span>
<span class="line-added"> 766                 case VAR:</span>
<span class="line-added"> 767                     if ((s.flags() &amp; STATIC) == 0) {</span>
<span class="line-added"> 768                         log.error(pos, Errors.SuperFieldNotAllowed(s, c, st));</span>
<span class="line-added"> 769                     }</span>
<span class="line-added"> 770                     break;</span>
<span class="line-added"> 771                 case MTH:</span>
<span class="line-added"> 772                     if ((s.flags() &amp; SYNCHRONIZED) != 0) {</span>
<span class="line-added"> 773                         log.error(pos, Errors.SuperMethodCannotBeSynchronized(s, c, st));</span>
<span class="line-added"> 774                     } else if (s.isConstructor()) {</span>
<span class="line-added"> 775                         MethodSymbol m = (MethodSymbol)s;</span>
<span class="line-added"> 776                         if (m.getParameters().size() &gt; 0) {</span>
<span class="line-added"> 777                             log.error(pos, Errors.SuperConstructorCannotTakeArguments(m, c, st));</span>
<span class="line-added"> 778                         } else {</span>
<span class="line-added"> 779                             if ((m.flags() &amp; (GENERATEDCONSTR | EMPTYNOARGCONSTR)) == 0) {</span>
<span class="line-added"> 780                                 log.error(pos, Errors.SuperNoArgConstructorMustBeEmpty(m, c, st));</span>
<span class="line-added"> 781                             }</span>
<span class="line-added"> 782                         }</span>
<span class="line-added"> 783                     }</span>
<span class="line-added"> 784                     break;</span>
<span class="line-added"> 785                 }</span>
<span class="line-added"> 786             }</span>
<span class="line-added"> 787         }</span>
<span class="line-added"> 788     }</span>
<span class="line-added"> 789 </span>
 790     /** Check that type is a valid qualifier for a constructor reference expression
 791      */
 792     Type checkConstructorRefType(DiagnosticPosition pos, Type t) {
 793         t = checkClassOrArrayType(pos, t);
 794         if (t.hasTag(CLASS)) {
 795             if ((t.tsym.flags() &amp; (ABSTRACT | INTERFACE)) != 0) {
 796                 log.error(pos, Errors.AbstractCantBeInstantiated(t.tsym));
 797                 t = types.createErrorType(t);
 798             } else if ((t.tsym.flags() &amp; ENUM) != 0) {
 799                 log.error(pos, Errors.EnumCantBeInstantiated);
 800                 t = types.createErrorType(t);
 801             } else {
 802                 t = checkClassType(pos, t, true);
 803             }
 804         } else if (t.hasTag(ARRAY)) {
 805             if (!types.isReifiable(((ArrayType)t).elemtype)) {
 806                 log.error(pos, Errors.GenericArrayCreation);
 807                 t = types.createErrorType(t);
 808             }
 809         }
</pre>
</td>
</tr>
</table>
<center><a href="Attr.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="TypeEnter.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>