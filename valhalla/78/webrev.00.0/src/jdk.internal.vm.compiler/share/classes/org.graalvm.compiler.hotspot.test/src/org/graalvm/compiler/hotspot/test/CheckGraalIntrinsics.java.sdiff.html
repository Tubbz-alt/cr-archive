<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.hotspot.test/src/org/graalvm/compiler/hotspot/test/CheckGraalIntrinsics.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../../../../../jdk.compiler/share/classes/com/sun/tools/javac/parser/JavacParser.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../../../jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/util/Utils.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.internal.vm.compiler/share/classes/org.graalvm.compiler.hotspot.test/src/org/graalvm/compiler/hotspot/test/CheckGraalIntrinsics.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
260                         // Can share most implementation parts with with
261                         // Unsafe.allocateUninitializedArray0
262                         &quot;java/lang/reflect/Array.newArray(Ljava/lang/Class;I)Ljava/lang/Object;&quot;,
263                         // HotSpot MacroAssembler-based intrinsic
264                         &quot;sun/nio/cs/ISO_8859_1$Encoder.encodeISOArray([CI[BII)I&quot;,
265                         // We have implemented implCompressMultiBlock0 on JDK9+. Does it worth
266                         // backporting as corresponding HotSpot stubs are only generated on SPARC?
267                         &quot;sun/security/provider/DigestBase.implCompressMultiBlock([BII)I&quot;);
268 
269         // See JDK-8207146.
270         String oopName = isJDK12OrHigher() ? &quot;Reference&quot; : &quot;Object&quot;;
271 
272         if (isJDK9OrHigher()) {
273             // Relevant for Java flight recorder
274             add(toBeInvestigated,
275                             &quot;jdk/jfr/internal/JVM.counterTime()J&quot;,
276                             &quot;jdk/jfr/internal/JVM.getBufferWriter()Ljava/lang/Object;&quot;,
277                             &quot;jdk/jfr/internal/JVM.getClassId(Ljava/lang/Class;)J&quot;);
278 
279             add(toBeInvestigated,
<span class="line-removed">280                             // Just check if the argument is a compile time constant</span>
<span class="line-removed">281                             &quot;java/lang/invoke/MethodHandleImpl.isCompileConstant(Ljava/lang/Object;)Z&quot;,</span>
282                             // Only used as a marker for vectorization?
283                             &quot;java/util/stream/Streams$RangeIntSpliterator.forEachRemaining(Ljava/util/function/IntConsumer;)V&quot;,
284                             // Only implemented on non-AMD64 platforms (some logic and runtime call)
285                             &quot;java/util/zip/Adler32.updateByteBuffer(IJII)I&quot;,
286                             // Only implemented on non-AMD64 platforms (some logic and runtime call)
287                             &quot;java/util/zip/Adler32.updateBytes(I[BII)I&quot;,
288                             // Emits a slow and a fast path and some dispatching logic
289                             &quot;jdk/internal/misc/Unsafe.allocateUninitializedArray0(Ljava/lang/Class;I)Ljava/lang/Object;&quot;,
290 
291                             // Control flow, deopts, and a cast
292                             &quot;jdk/internal/util/Preconditions.checkIndex(IILjava/util/function/BiFunction;)I&quot;,
293                             // HotSpot MacroAssembler-based intrinsic
294                             &quot;sun/nio/cs/ISO_8859_1$Encoder.implEncodeISOArray([CI[BII)I&quot;);
295 
296             /*
297              * Per default, all these operations are mapped to some generic method for which we
298              * already have compiler intrinsics. Performance-wise it would be better to support them
299              * explicitly as the more generic method might be more restrictive and therefore slower
300              * than necessary.
301              */
</pre>
<hr />
<pre>
355 
356                             // handled by an intrinsic for StringUTF16.indexOfCharUnsafe
357                             &quot;java/lang/StringUTF16.indexOfChar([BIII)I&quot;,
358 
359                             // handled by an intrinsic for StringUTF16.indexOfLatin1Unsafe
360                             &quot;java/lang/StringUTF16.indexOfLatin1([BI[BII)I&quot;,
361                             &quot;java/lang/StringUTF16.indexOfLatin1([B[B)I&quot;);
362 
363             if (!config.useAESCTRIntrinsics) {
364                 add(ignore,
365                                 &quot;com/sun/crypto/provider/CounterMode.implCrypt([BII[BI)I&quot;);
366             }
367             if (!config.useGHASHIntrinsics()) {
368                 add(ignore,
369                                 &quot;com/sun/crypto/provider/GHASH.processBlocks([BII[J[J)V&quot;);
370             }
371             if (!config.useFMAIntrinsics) {
372                 add(ignore,
373                                 &quot;java/lang/Math.fma(DDD)D&quot;,
374                                 &quot;java/lang/Math.fma(FFF)F&quot;);




375             }
376         }
377 
378         if (isJDK10OrHigher()) {
379             add(toBeInvestigated,
380                             &quot;java/lang/Math.multiplyHigh(JJ)J&quot;);
381         }
382 
383         if (isJDK11OrHigher()) {
384             // Relevant for Java flight recorder
385             add(toBeInvestigated,
386                             &quot;java/lang/CharacterDataLatin1.isDigit(I)Z&quot;,
387                             &quot;java/lang/CharacterDataLatin1.isLowerCase(I)Z&quot;,
388                             &quot;java/lang/CharacterDataLatin1.isUpperCase(I)Z&quot;,
389                             &quot;java/lang/CharacterDataLatin1.isWhitespace(I)Z&quot;,
390                             &quot;jdk/jfr/internal/JVM.getEventWriter()Ljava/lang/Object;&quot;);
391             if (!config.useBase64Intrinsics()) {
392                 add(ignore,
393                                 &quot;java/util/Base64$Encoder.encodeBlock([BII[BIZ)V&quot;);
394             }
</pre>
</td>
<td>
<hr />
<pre>
260                         // Can share most implementation parts with with
261                         // Unsafe.allocateUninitializedArray0
262                         &quot;java/lang/reflect/Array.newArray(Ljava/lang/Class;I)Ljava/lang/Object;&quot;,
263                         // HotSpot MacroAssembler-based intrinsic
264                         &quot;sun/nio/cs/ISO_8859_1$Encoder.encodeISOArray([CI[BII)I&quot;,
265                         // We have implemented implCompressMultiBlock0 on JDK9+. Does it worth
266                         // backporting as corresponding HotSpot stubs are only generated on SPARC?
267                         &quot;sun/security/provider/DigestBase.implCompressMultiBlock([BII)I&quot;);
268 
269         // See JDK-8207146.
270         String oopName = isJDK12OrHigher() ? &quot;Reference&quot; : &quot;Object&quot;;
271 
272         if (isJDK9OrHigher()) {
273             // Relevant for Java flight recorder
274             add(toBeInvestigated,
275                             &quot;jdk/jfr/internal/JVM.counterTime()J&quot;,
276                             &quot;jdk/jfr/internal/JVM.getBufferWriter()Ljava/lang/Object;&quot;,
277                             &quot;jdk/jfr/internal/JVM.getClassId(Ljava/lang/Class;)J&quot;);
278 
279             add(toBeInvestigated,


280                             // Only used as a marker for vectorization?
281                             &quot;java/util/stream/Streams$RangeIntSpliterator.forEachRemaining(Ljava/util/function/IntConsumer;)V&quot;,
282                             // Only implemented on non-AMD64 platforms (some logic and runtime call)
283                             &quot;java/util/zip/Adler32.updateByteBuffer(IJII)I&quot;,
284                             // Only implemented on non-AMD64 platforms (some logic and runtime call)
285                             &quot;java/util/zip/Adler32.updateBytes(I[BII)I&quot;,
286                             // Emits a slow and a fast path and some dispatching logic
287                             &quot;jdk/internal/misc/Unsafe.allocateUninitializedArray0(Ljava/lang/Class;I)Ljava/lang/Object;&quot;,
288 
289                             // Control flow, deopts, and a cast
290                             &quot;jdk/internal/util/Preconditions.checkIndex(IILjava/util/function/BiFunction;)I&quot;,
291                             // HotSpot MacroAssembler-based intrinsic
292                             &quot;sun/nio/cs/ISO_8859_1$Encoder.implEncodeISOArray([CI[BII)I&quot;);
293 
294             /*
295              * Per default, all these operations are mapped to some generic method for which we
296              * already have compiler intrinsics. Performance-wise it would be better to support them
297              * explicitly as the more generic method might be more restrictive and therefore slower
298              * than necessary.
299              */
</pre>
<hr />
<pre>
353 
354                             // handled by an intrinsic for StringUTF16.indexOfCharUnsafe
355                             &quot;java/lang/StringUTF16.indexOfChar([BIII)I&quot;,
356 
357                             // handled by an intrinsic for StringUTF16.indexOfLatin1Unsafe
358                             &quot;java/lang/StringUTF16.indexOfLatin1([BI[BII)I&quot;,
359                             &quot;java/lang/StringUTF16.indexOfLatin1([B[B)I&quot;);
360 
361             if (!config.useAESCTRIntrinsics) {
362                 add(ignore,
363                                 &quot;com/sun/crypto/provider/CounterMode.implCrypt([BII[BI)I&quot;);
364             }
365             if (!config.useGHASHIntrinsics()) {
366                 add(ignore,
367                                 &quot;com/sun/crypto/provider/GHASH.processBlocks([BII[J[J)V&quot;);
368             }
369             if (!config.useFMAIntrinsics) {
370                 add(ignore,
371                                 &quot;java/lang/Math.fma(DDD)D&quot;,
372                                 &quot;java/lang/Math.fma(FFF)F&quot;);
<span class="line-added">373             } else if (isSPARC(arch)) {</span>
<span class="line-added">374                 add(toBeInvestigated,</span>
<span class="line-added">375                                 &quot;java/lang/Math.fma(DDD)D&quot;,</span>
<span class="line-added">376                                 &quot;java/lang/Math.fma(FFF)F&quot;);</span>
377             }
378         }
379 
380         if (isJDK10OrHigher()) {
381             add(toBeInvestigated,
382                             &quot;java/lang/Math.multiplyHigh(JJ)J&quot;);
383         }
384 
385         if (isJDK11OrHigher()) {
386             // Relevant for Java flight recorder
387             add(toBeInvestigated,
388                             &quot;java/lang/CharacterDataLatin1.isDigit(I)Z&quot;,
389                             &quot;java/lang/CharacterDataLatin1.isLowerCase(I)Z&quot;,
390                             &quot;java/lang/CharacterDataLatin1.isUpperCase(I)Z&quot;,
391                             &quot;java/lang/CharacterDataLatin1.isWhitespace(I)Z&quot;,
392                             &quot;jdk/jfr/internal/JVM.getEventWriter()Ljava/lang/Object;&quot;);
393             if (!config.useBase64Intrinsics()) {
394                 add(ignore,
395                                 &quot;java/util/Base64$Encoder.encodeBlock([BII[BIZ)V&quot;);
396             }
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../../../../../jdk.compiler/share/classes/com/sun/tools/javac/parser/JavacParser.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../../../jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/toolkit/util/Utils.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>