<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/services/diagnosticCommand.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../runtime/vmStructs.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="diagnosticCommand.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/services/diagnosticCommand.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  78   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VersionDCmd&gt;(full_export, true, false));
  79   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CommandLineDCmd&gt;(full_export, true, false));
  80   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;PrintSystemPropertiesDCmd&gt;(full_export, true, false));
  81   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;PrintVMFlagsDCmd&gt;(full_export, true, false));
  82   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SetVMFlagDCmd&gt;(full_export, true, false));
  83   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VMDynamicLibrariesDCmd&gt;(full_export, true, false));
  84   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VMUptimeDCmd&gt;(full_export, true, false));
  85   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VMInfoDCmd&gt;(full_export, true, false));
  86   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SystemGCDCmd&gt;(full_export, true, false));
  87   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;RunFinalizationDCmd&gt;(full_export, true, false));
  88   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;HeapInfoDCmd&gt;(full_export, true, false));
  89   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;FinalizerInfoDCmd&gt;(full_export, true, false));
  90 #if INCLUDE_SERVICES
  91   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;HeapDumpDCmd&gt;(DCmd_Source_Internal | DCmd_Source_AttachAPI, true, false));
  92   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassHistogramDCmd&gt;(full_export, true, false));
  93   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SystemDictionaryDCmd&gt;(full_export, true, false));
  94   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassHierarchyDCmd&gt;(full_export, true, false));
  95   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SymboltableDCmd&gt;(full_export, true, false));
  96   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;StringtableDCmd&gt;(full_export, true, false));
  97   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;metaspace::MetaspaceDCmd&gt;(full_export, true, false));

  98   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;EventLogDCmd&gt;(full_export, true, false));
  99 #if INCLUDE_JVMTI // Both JVMTI and SERVICES have to be enabled to have this dcmd
 100   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JVMTIAgentLoadDCmd&gt;(full_export, true, false));
 101 #endif // INCLUDE_JVMTI
 102 #endif // INCLUDE_SERVICES
 103 #if INCLUDE_JVMTI
 104   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JVMTIDataDumpDCmd&gt;(full_export, true, false));
 105 #endif // INCLUDE_JVMTI
 106   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ThreadDumpDCmd&gt;(full_export, true, false));
 107   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassLoaderStatsDCmd&gt;(full_export, true, false));
 108   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassLoaderHierarchyDCmd&gt;(full_export, true, false));
 109   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompileQueueDCmd&gt;(full_export, true, false));
 110   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CodeListDCmd&gt;(full_export, true, false));
 111   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CodeCacheDCmd&gt;(full_export, true, false));
 112   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;TouchedMethodsDCmd&gt;(full_export, true, false));
 113   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CodeHeapAnalyticsDCmd&gt;(full_export, true, false));
 114 
 115   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesPrintDCmd&gt;(full_export, true, false));
 116   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesAddDCmd&gt;(full_export, true, false));
 117   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesRemoveDCmd&gt;(full_export, true, false));
 118   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesClearDCmd&gt;(full_export, true, false));
 119 
 120   // Enhanced JMX Agent Support
 121   // These commands won&#39;t be exported via the DiagnosticCommandMBean until an
 122   // appropriate permission is created for them
 123   uint32_t jmx_agent_export_flags = DCmd_Source_Internal | DCmd_Source_AttachAPI;
 124   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStartRemoteDCmd&gt;(jmx_agent_export_flags, true,false));
 125   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStartLocalDCmd&gt;(jmx_agent_export_flags, true,false));
 126   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStopRemoteDCmd&gt;(jmx_agent_export_flags, true,false));
 127   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStatusDCmd&gt;(jmx_agent_export_flags, true,false));
<span class="line-removed"> 128 </span>
 129   // Debug on cmd (only makes sense with JVMTI since the agentlib needs it).
 130 #if INCLUDE_JVMTI
 131   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;DebugOnCmdStartDCmd&gt;(full_export, true, true));
 132 #endif // INCLUDE_JVMTI
 133 
 134 }
 135 
 136 #ifndef HAVE_EXTRA_DCMD
 137 void DCmdRegistrant::register_dcmds_ext(){
 138    // Do nothing here
 139 }
 140 #endif
 141 
 142 
 143 HelpDCmd::HelpDCmd(outputStream* output, bool heap) : DCmdWithParser(output, heap),
 144   _all(&quot;-all&quot;, &quot;Show help for all commands&quot;, &quot;BOOLEAN&quot;, false, &quot;false&quot;),
 145   _cmd(&quot;command name&quot;, &quot;The name of the command for which we want help&quot;,
 146         &quot;STRING&quot;, false) {
 147   _dcmdparser.add_dcmd_option(&amp;_all);
 148   _dcmdparser.add_dcmd_argument(&amp;_cmd);
</pre>
<hr />
<pre>
1011 
1012 void ClassHierarchyDCmd::execute(DCmdSource source, TRAPS) {
1013   VM_PrintClassHierarchy printClassHierarchyOp(output(), _print_interfaces.value(),
1014                                                _print_subclasses.value(), _classname.value());
1015   VMThread::execute(&amp;printClassHierarchyOp);
1016 }
1017 
1018 int ClassHierarchyDCmd::num_arguments() {
1019   ResourceMark rm;
1020   ClassHierarchyDCmd* dcmd = new ClassHierarchyDCmd(NULL, false);
1021   if (dcmd != NULL) {
1022     DCmdMark mark(dcmd);
1023     return dcmd-&gt;_dcmdparser.num_arguments();
1024   } else {
1025     return 0;
1026   }
1027 }
1028 
1029 #endif
1030 























1031 class VM_DumpTouchedMethods : public VM_Operation {
1032 private:
1033   outputStream* _out;
1034 public:
1035   VM_DumpTouchedMethods(outputStream* out) {
1036     _out = out;
1037   }
1038 
1039   virtual VMOp_Type type() const { return VMOp_DumpTouchedMethods; }
1040 
1041   virtual void doit() {
1042     Method::print_touched_methods(_out);
1043   }
1044 };
1045 
1046 TouchedMethodsDCmd::TouchedMethodsDCmd(outputStream* output, bool heap) :
1047                                        DCmdWithParser(output, heap)
1048 {}
1049 
1050 void TouchedMethodsDCmd::execute(DCmdSource source, TRAPS) {
</pre>
</td>
<td>
<hr />
<pre>
  78   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VersionDCmd&gt;(full_export, true, false));
  79   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CommandLineDCmd&gt;(full_export, true, false));
  80   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;PrintSystemPropertiesDCmd&gt;(full_export, true, false));
  81   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;PrintVMFlagsDCmd&gt;(full_export, true, false));
  82   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SetVMFlagDCmd&gt;(full_export, true, false));
  83   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VMDynamicLibrariesDCmd&gt;(full_export, true, false));
  84   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VMUptimeDCmd&gt;(full_export, true, false));
  85   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VMInfoDCmd&gt;(full_export, true, false));
  86   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SystemGCDCmd&gt;(full_export, true, false));
  87   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;RunFinalizationDCmd&gt;(full_export, true, false));
  88   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;HeapInfoDCmd&gt;(full_export, true, false));
  89   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;FinalizerInfoDCmd&gt;(full_export, true, false));
  90 #if INCLUDE_SERVICES
  91   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;HeapDumpDCmd&gt;(DCmd_Source_Internal | DCmd_Source_AttachAPI, true, false));
  92   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassHistogramDCmd&gt;(full_export, true, false));
  93   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SystemDictionaryDCmd&gt;(full_export, true, false));
  94   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassHierarchyDCmd&gt;(full_export, true, false));
  95   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SymboltableDCmd&gt;(full_export, true, false));
  96   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;StringtableDCmd&gt;(full_export, true, false));
  97   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;metaspace::MetaspaceDCmd&gt;(full_export, true, false));
<span class="line-added">  98   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;PrintClassLayoutDCmd&gt;(full_export, true, false));</span>
  99   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;EventLogDCmd&gt;(full_export, true, false));
 100 #if INCLUDE_JVMTI // Both JVMTI and SERVICES have to be enabled to have this dcmd
 101   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JVMTIAgentLoadDCmd&gt;(full_export, true, false));
 102 #endif // INCLUDE_JVMTI
 103 #endif // INCLUDE_SERVICES
 104 #if INCLUDE_JVMTI
 105   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JVMTIDataDumpDCmd&gt;(full_export, true, false));
 106 #endif // INCLUDE_JVMTI
 107   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ThreadDumpDCmd&gt;(full_export, true, false));
 108   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassLoaderStatsDCmd&gt;(full_export, true, false));
 109   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassLoaderHierarchyDCmd&gt;(full_export, true, false));
 110   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompileQueueDCmd&gt;(full_export, true, false));
 111   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CodeListDCmd&gt;(full_export, true, false));
 112   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CodeCacheDCmd&gt;(full_export, true, false));
 113   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;TouchedMethodsDCmd&gt;(full_export, true, false));
 114   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CodeHeapAnalyticsDCmd&gt;(full_export, true, false));
 115 
 116   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesPrintDCmd&gt;(full_export, true, false));
 117   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesAddDCmd&gt;(full_export, true, false));
 118   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesRemoveDCmd&gt;(full_export, true, false));
 119   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesClearDCmd&gt;(full_export, true, false));
 120 
 121   // Enhanced JMX Agent Support
 122   // These commands won&#39;t be exported via the DiagnosticCommandMBean until an
 123   // appropriate permission is created for them
 124   uint32_t jmx_agent_export_flags = DCmd_Source_Internal | DCmd_Source_AttachAPI;
 125   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStartRemoteDCmd&gt;(jmx_agent_export_flags, true,false));
 126   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStartLocalDCmd&gt;(jmx_agent_export_flags, true,false));
 127   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStopRemoteDCmd&gt;(jmx_agent_export_flags, true,false));
 128   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStatusDCmd&gt;(jmx_agent_export_flags, true,false));

 129   // Debug on cmd (only makes sense with JVMTI since the agentlib needs it).
 130 #if INCLUDE_JVMTI
 131   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;DebugOnCmdStartDCmd&gt;(full_export, true, true));
 132 #endif // INCLUDE_JVMTI
 133 
 134 }
 135 
 136 #ifndef HAVE_EXTRA_DCMD
 137 void DCmdRegistrant::register_dcmds_ext(){
 138    // Do nothing here
 139 }
 140 #endif
 141 
 142 
 143 HelpDCmd::HelpDCmd(outputStream* output, bool heap) : DCmdWithParser(output, heap),
 144   _all(&quot;-all&quot;, &quot;Show help for all commands&quot;, &quot;BOOLEAN&quot;, false, &quot;false&quot;),
 145   _cmd(&quot;command name&quot;, &quot;The name of the command for which we want help&quot;,
 146         &quot;STRING&quot;, false) {
 147   _dcmdparser.add_dcmd_option(&amp;_all);
 148   _dcmdparser.add_dcmd_argument(&amp;_cmd);
</pre>
<hr />
<pre>
1011 
1012 void ClassHierarchyDCmd::execute(DCmdSource source, TRAPS) {
1013   VM_PrintClassHierarchy printClassHierarchyOp(output(), _print_interfaces.value(),
1014                                                _print_subclasses.value(), _classname.value());
1015   VMThread::execute(&amp;printClassHierarchyOp);
1016 }
1017 
1018 int ClassHierarchyDCmd::num_arguments() {
1019   ResourceMark rm;
1020   ClassHierarchyDCmd* dcmd = new ClassHierarchyDCmd(NULL, false);
1021   if (dcmd != NULL) {
1022     DCmdMark mark(dcmd);
1023     return dcmd-&gt;_dcmdparser.num_arguments();
1024   } else {
1025     return 0;
1026   }
1027 }
1028 
1029 #endif
1030 
<span class="line-added">1031 PrintClassLayoutDCmd::PrintClassLayoutDCmd(outputStream* output, bool heap) :</span>
<span class="line-added">1032                                        DCmdWithParser(output, heap),</span>
<span class="line-added">1033   _classname(&quot;classname&quot;, &quot;Name of class whose layout should be printed. &quot;,</span>
<span class="line-added">1034              &quot;STRING&quot;, true) {</span>
<span class="line-added">1035   _dcmdparser.add_dcmd_argument(&amp;_classname);</span>
<span class="line-added">1036 }</span>
<span class="line-added">1037 </span>
<span class="line-added">1038 void PrintClassLayoutDCmd::execute(DCmdSource source, TRAPS) {</span>
<span class="line-added">1039   VM_PrintClassLayout printClassLayoutOp(output(), _classname.value());</span>
<span class="line-added">1040   VMThread::execute(&amp;printClassLayoutOp);</span>
<span class="line-added">1041 }</span>
<span class="line-added">1042 </span>
<span class="line-added">1043 int PrintClassLayoutDCmd::num_arguments() {</span>
<span class="line-added">1044   ResourceMark rm;</span>
<span class="line-added">1045   PrintClassLayoutDCmd* dcmd = new PrintClassLayoutDCmd(NULL, false);</span>
<span class="line-added">1046   if (dcmd != NULL) {</span>
<span class="line-added">1047     DCmdMark mark(dcmd);</span>
<span class="line-added">1048     return dcmd-&gt;_dcmdparser.num_arguments();</span>
<span class="line-added">1049   } else {</span>
<span class="line-added">1050     return 0;</span>
<span class="line-added">1051   }</span>
<span class="line-added">1052 }</span>
<span class="line-added">1053 </span>
1054 class VM_DumpTouchedMethods : public VM_Operation {
1055 private:
1056   outputStream* _out;
1057 public:
1058   VM_DumpTouchedMethods(outputStream* out) {
1059     _out = out;
1060   }
1061 
1062   virtual VMOp_Type type() const { return VMOp_DumpTouchedMethods; }
1063 
1064   virtual void doit() {
1065     Method::print_touched_methods(_out);
1066   }
1067 };
1068 
1069 TouchedMethodsDCmd::TouchedMethodsDCmd(outputStream* output, bool heap) :
1070                                        DCmdWithParser(output, heap)
1071 {}
1072 
1073 void TouchedMethodsDCmd::execute(DCmdSource source, TRAPS) {
</pre>
</td>
</tr>
</table>
<center><a href="../runtime/vmStructs.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="diagnosticCommand.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>