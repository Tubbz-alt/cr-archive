<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.compiler/share/classes/com/sun/tools/javac/comp/TypeEnter.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="TransTypes.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../jvm/ClassReader.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.compiler/share/classes/com/sun/tools/javac/comp/TypeEnter.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 729                     interfaces.append(it);
 730                     if (all_interfaces != null) all_interfaces.append(it);
 731                 } else {
 732                     if (all_interfaces == null)
 733                         all_interfaces = new ListBuffer&lt;Type&gt;().appendList(interfaces);
 734                     all_interfaces.append(modelMissingTypes(baseEnv, it, iface, true));
 735                 }
 736             }
 737 
 738             if ((sym.flags_field &amp; ANNOTATION) != 0) {
 739                 ct.interfaces_field = List.of(syms.annotationType);
 740                 ct.all_interfaces_field = ct.interfaces_field;
 741             }  else {
 742                 if (interfaceToInject != Type.noType) {
 743                     interfaces.append(interfaceToInject);
 744                 }
 745                 ct.interfaces_field = interfaces.toList();
 746                 ct.all_interfaces_field = (all_interfaces == null)
 747                         ? ct.interfaces_field : all_interfaces.toList();
 748             }









 749         }
 750             //where:
 751             protected JCExpression clearTypeParams(JCExpression superType) {
 752                 return superType;
 753             }
 754     }
 755 
 756     private final class HierarchyPhase extends AbstractHeaderPhase implements Completer {
 757 
 758         public HierarchyPhase() {
 759             super(CompletionCause.HIERARCHY_PHASE, new HeaderPhase());
 760         }
 761 
 762         @Override
 763         protected void doCompleteEnvs(List&lt;Env&lt;AttrContext&gt;&gt; envs) {
 764             //The ClassSymbols in the envs list may not be in the dependency order.
 765             //To get proper results, for every class or interface C, the supertypes of
 766             //C must be processed by the HierarchyPhase phase before C.
 767             //To achieve that, the HierarchyPhase is registered as the Completer for
 768             //all the classes first, and then all the classes are completed.
</pre>
</td>
<td>
<hr />
<pre>
 729                     interfaces.append(it);
 730                     if (all_interfaces != null) all_interfaces.append(it);
 731                 } else {
 732                     if (all_interfaces == null)
 733                         all_interfaces = new ListBuffer&lt;Type&gt;().appendList(interfaces);
 734                     all_interfaces.append(modelMissingTypes(baseEnv, it, iface, true));
 735                 }
 736             }
 737 
 738             if ((sym.flags_field &amp; ANNOTATION) != 0) {
 739                 ct.interfaces_field = List.of(syms.annotationType);
 740                 ct.all_interfaces_field = ct.interfaces_field;
 741             }  else {
 742                 if (interfaceToInject != Type.noType) {
 743                     interfaces.append(interfaceToInject);
 744                 }
 745                 ct.interfaces_field = interfaces.toList();
 746                 ct.all_interfaces_field = (all_interfaces == null)
 747                         ? ct.interfaces_field : all_interfaces.toList();
 748             }
<span class="line-added"> 749             if (ct.isValue()) {</span>
<span class="line-added"> 750                 ClassSymbol cSym = (ClassSymbol) ct.tsym;</span>
<span class="line-added"> 751                 if (cSym.projection != null) {</span>
<span class="line-added"> 752                     ClassType projectedType = (ClassType) cSym.projection.type;</span>
<span class="line-added"> 753                     projectedType.supertype_field = ct.supertype_field;</span>
<span class="line-added"> 754                     projectedType.interfaces_field = ct.interfaces_field;</span>
<span class="line-added"> 755                     projectedType.all_interfaces_field = ct.all_interfaces_field;</span>
<span class="line-added"> 756                 }</span>
<span class="line-added"> 757             }</span>
 758         }
 759             //where:
 760             protected JCExpression clearTypeParams(JCExpression superType) {
 761                 return superType;
 762             }
 763     }
 764 
 765     private final class HierarchyPhase extends AbstractHeaderPhase implements Completer {
 766 
 767         public HierarchyPhase() {
 768             super(CompletionCause.HIERARCHY_PHASE, new HeaderPhase());
 769         }
 770 
 771         @Override
 772         protected void doCompleteEnvs(List&lt;Env&lt;AttrContext&gt;&gt; envs) {
 773             //The ClassSymbols in the envs list may not be in the dependency order.
 774             //To get proper results, for every class or interface C, the supertypes of
 775             //C must be processed by the HierarchyPhase phase before C.
 776             //To achieve that, the HierarchyPhase is registered as the Completer for
 777             //all the classes first, and then all the classes are completed.
</pre>
</td>
</tr>
</table>
<center><a href="TransTypes.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../jvm/ClassReader.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>