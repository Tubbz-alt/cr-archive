<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/hotspot/jtreg/runtime/valhalla/valuetypes/ValueTypesTest.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="ValueTypeCreation.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>test/hotspot/jtreg/runtime/valhalla/valuetypes/ValueTypesTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -144,11 +144,11 @@</span>
      static void testExecutionStackToFields(Class&lt;?&gt; inlineClass, Class&lt;?&gt; containerClass) throws Throwable {
          final int ITERATIONS = Platform.isDebugBuild() ? 3 : 512;
          String sig = &quot;()Q&quot; + inlineClass.getName() + &quot;;&quot;;
          final String methodSignature = sig.replace(&#39;.&#39;, &#39;/&#39;);
          final String fieldQSignature = &quot;Q&quot; + inlineClass.getName().replace(&#39;.&#39;, &#39;/&#39;) + &quot;;&quot;;
<span class="udiff-line-modified-removed">-         final String fieldLSignature = &quot;L&quot; + inlineClass.getName().replace(&#39;.&#39;, &#39;/&#39;) + &quot;;&quot;;</span>
<span class="udiff-line-modified-added">+         final String fieldLSignature = &quot;L&quot; + inlineClass.getName().replace(&#39;.&#39;, &#39;/&#39;) + &quot;$ref;&quot;;</span>
          System.out.println(methodSignature);
          MethodHandle fromExecStackToFields = MethodHandleBuilder.loadCode(
                  LOOKUP,
                  &quot;execStackToFields&quot;,
                  MethodType.methodType(boolean.class),
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -185,17 +185,19 @@</span>
                      .ifcmp(TypeTag.I, CondKind.NE, &quot;failed&quot;)
                      .invokestatic(inlineClass, &quot;getInstance&quot;, methodSignature, false)
                      .putstatic(containerClass, &quot;staticValueField&quot;, fieldLSignature)
                      .invokestatic(System.class, &quot;gc&quot;, &quot;()V&quot;, false)
                      .getstatic(containerClass, &quot;staticValueField&quot;, fieldLSignature)
<span class="udiff-line-added">+                     .checkcast(inlineClass)</span>
                      .invokevirtual(inlineClass, &quot;verify&quot;, &quot;()Z&quot;, false)
                      .iconst_1()
                      .ifcmp(TypeTag.I, CondKind.NE, &quot;failed&quot;)
                      .invokestatic(inlineClass, &quot;getNonBufferedInstance&quot;, methodSignature, false)
                      .putstatic(containerClass, &quot;staticValueField&quot;, fieldLSignature)
                      .invokestatic(System.class, &quot;gc&quot;, &quot;()V&quot;, false)
                      .getstatic(containerClass, &quot;staticValueField&quot;, fieldLSignature)
<span class="udiff-line-added">+                     .checkcast(inlineClass)</span>
                      .invokevirtual(inlineClass, &quot;verify&quot;, &quot;()Z&quot;, false)
                      .iconst_1()
                      .ifcmp(TypeTag.I, CondKind.NE, &quot;failed&quot;)
                      .iinc(2, 1)
                      .goto_(&quot;loop&quot;)
</pre>
<center><a href="ValueTypeCreation.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>