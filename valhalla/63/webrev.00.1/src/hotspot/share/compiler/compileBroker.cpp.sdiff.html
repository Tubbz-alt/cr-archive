<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/compiler/compileBroker.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../classfile/vmSymbols.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../gc/parallel/psParallelCompact.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/compiler/compileBroker.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
1162     // We now know that this compilation is not pending, complete,
1163     // or prohibited.  Assign a compile_id to this compilation
1164     // and check to see if it is in our [Start..Stop) range.
1165     int compile_id = assign_compile_id(method, osr_bci);
1166     if (compile_id == 0) {
1167       // The compilation falls outside the allowed range.
1168       return;
1169     }
1170 
1171 #if INCLUDE_JVMCI
1172     if (UseJVMCICompiler &amp;&amp; blocking) {
1173       // Don&#39;t allow blocking compiles for requests triggered by JVMCI.
1174       if (thread-&gt;is_Compiler_thread()) {
1175         blocking = false;
1176       }
1177 
1178       if (!UseJVMCINativeLibrary) {
1179         // Don&#39;t allow blocking compiles if inside a class initializer or while performing class loading
1180         vframeStream vfst((JavaThread*) thread);
1181         for (; !vfst.at_end(); vfst.next()) {
<span class="line-modified">1182           if (vfst.method()-&gt;is_static_initializer() ||</span>
1183               (vfst.method()-&gt;method_holder()-&gt;is_subclass_of(SystemDictionary::ClassLoader_klass()) &amp;&amp;
1184                   vfst.method()-&gt;name() == vmSymbols::loadClass_name())) {
1185             blocking = false;
1186             break;
1187           }
1188         }
1189       }
1190 
1191       // Don&#39;t allow blocking compilation requests to JVMCI
1192       // if JVMCI itself is not yet initialized
1193       if (!JVMCI::is_compiler_initialized() &amp;&amp; compiler(comp_level)-&gt;is_jvmci()) {
1194         blocking = false;
1195       }
1196 
1197       // Don&#39;t allow blocking compilation requests if we are in JVMCIRuntime::shutdown
1198       // to avoid deadlock between compiler thread(s) and threads run at shutdown
1199       // such as the DestroyJavaVM thread.
1200       if (JVMCI::shutdown_called()) {
1201         blocking = false;
1202       }
</pre>
</td>
<td>
<hr />
<pre>
1162     // We now know that this compilation is not pending, complete,
1163     // or prohibited.  Assign a compile_id to this compilation
1164     // and check to see if it is in our [Start..Stop) range.
1165     int compile_id = assign_compile_id(method, osr_bci);
1166     if (compile_id == 0) {
1167       // The compilation falls outside the allowed range.
1168       return;
1169     }
1170 
1171 #if INCLUDE_JVMCI
1172     if (UseJVMCICompiler &amp;&amp; blocking) {
1173       // Don&#39;t allow blocking compiles for requests triggered by JVMCI.
1174       if (thread-&gt;is_Compiler_thread()) {
1175         blocking = false;
1176       }
1177 
1178       if (!UseJVMCINativeLibrary) {
1179         // Don&#39;t allow blocking compiles if inside a class initializer or while performing class loading
1180         vframeStream vfst((JavaThread*) thread);
1181         for (; !vfst.at_end(); vfst.next()) {
<span class="line-modified">1182         if (vfst.method()-&gt;is_class_initializer() ||</span>
1183               (vfst.method()-&gt;method_holder()-&gt;is_subclass_of(SystemDictionary::ClassLoader_klass()) &amp;&amp;
1184                   vfst.method()-&gt;name() == vmSymbols::loadClass_name())) {
1185             blocking = false;
1186             break;
1187           }
1188         }
1189       }
1190 
1191       // Don&#39;t allow blocking compilation requests to JVMCI
1192       // if JVMCI itself is not yet initialized
1193       if (!JVMCI::is_compiler_initialized() &amp;&amp; compiler(comp_level)-&gt;is_jvmci()) {
1194         blocking = false;
1195       }
1196 
1197       // Don&#39;t allow blocking compilation requests if we are in JVMCIRuntime::shutdown
1198       // to avoid deadlock between compiler thread(s) and threads run at shutdown
1199       // such as the DestroyJavaVM thread.
1200       if (JVMCI::shutdown_called()) {
1201         blocking = false;
1202       }
</pre>
</td>
</tr>
</table>
<center><a href="../classfile/vmSymbols.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../gc/parallel/psParallelCompact.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>