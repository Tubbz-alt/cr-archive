<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/share/opto/castnode.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="c2compiler.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="castnode.hpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/opto/castnode.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 25,14 ***</span>
<span class="line-new-header">--- 25,17 ---</span>
  #include &quot;precompiled.hpp&quot;
  #include &quot;opto/addnode.hpp&quot;
  #include &quot;opto/callnode.hpp&quot;
  #include &quot;opto/castnode.hpp&quot;
  #include &quot;opto/connode.hpp&quot;
<span class="line-added">+ #include &quot;opto/graphKit.hpp&quot;</span>
  #include &quot;opto/matcher.hpp&quot;
  #include &quot;opto/phaseX.hpp&quot;
<span class="line-added">+ #include &quot;opto/rootnode.hpp&quot;</span>
  #include &quot;opto/subnode.hpp&quot;
  #include &quot;opto/type.hpp&quot;
<span class="line-added">+ #include &quot;opto/valuetypenode.hpp&quot;</span>
  
  //=============================================================================
  // If input is already higher or equal to cast type, then this is an identity.
  Node* ConstraintCastNode::Identity(PhaseGVN* phase) {
    Node* dom = dominating_cast(phase, phase);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 281,10 ***</span>
<span class="line-new-header">--- 284,13 ---</span>
  
  //=============================================================================
  //------------------------------Identity---------------------------------------
  // If input is already higher or equal to cast type, then this is an identity.
  Node* CheckCastPPNode::Identity(PhaseGVN* phase) {
<span class="line-added">+   if (in(1)-&gt;is_ValueTypeBase() &amp;&amp; _type-&gt;isa_oopptr() &amp;&amp; phase-&gt;type(in(1))-&gt;value_klass()-&gt;is_subtype_of(_type-&gt;is_oopptr()-&gt;klass())) {</span>
<span class="line-added">+     return in(1);</span>
<span class="line-added">+   }</span>
    Node* dom = dominating_cast(phase, phase);
    if (dom != NULL) {
      return dom;
    }
    if (_carry_dependency) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 460,10 ***</span>
<span class="line-new-header">--- 466,26 ---</span>
    if (t == Type::TOP) return Type::TOP;
    if (t-&gt;base() == Type::RawPtr &amp;&amp; t-&gt;singleton()) {
      uintptr_t bits = (uintptr_t) t-&gt;is_rawptr()-&gt;get_con();
      return TypeX::make(bits);
    }
<span class="line-added">+ </span>
<span class="line-added">+   if (t-&gt;is_zero_type() || !t-&gt;maybe_null()) {</span>
<span class="line-added">+     for (DUIterator_Fast imax, i = fast_outs(imax); i &lt; imax; i++) {</span>
<span class="line-added">+       Node* u = fast_out(i);</span>
<span class="line-added">+       if (u-&gt;Opcode() == Op_OrL) {</span>
<span class="line-added">+         for (DUIterator_Fast jmax, j = u-&gt;fast_outs(jmax); j &lt; jmax; j++) {</span>
<span class="line-added">+           Node* cmp = u-&gt;fast_out(j);</span>
<span class="line-added">+           if (cmp-&gt;Opcode() == Op_CmpL) {</span>
<span class="line-added">+             // Give CmpL a chance to get optimized</span>
<span class="line-added">+             phase-&gt;record_for_igvn(cmp);</span>
<span class="line-added">+           }</span>
<span class="line-added">+         }</span>
<span class="line-added">+       }</span>
<span class="line-added">+     }</span>
<span class="line-added">+   }</span>
<span class="line-added">+ </span>
    return CastP2XNode::bottom_type();
  }
  
  Node *CastP2XNode::Ideal(PhaseGVN *phase, bool can_reshape) {
    return (in(0) &amp;&amp; remove_dead_region(phase, can_reshape)) ? this : NULL;
</pre>
<center><a href="c2compiler.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="castnode.hpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>