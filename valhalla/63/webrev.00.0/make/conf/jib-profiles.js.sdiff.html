<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/conf/jib-profiles.js</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="../../.hgtags.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="../data/jdwp/jdwp.spec.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/conf/jib-profiles.js</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 364                     local: &quot;bundles/\\(jdk.*bin-debug-symbols.tar.gz\\)&quot;,
 365                     remote: [
 366                         &quot;bundles/&quot; + pf + &quot;/jdk-&quot; + data.version + &quot;_&quot; + pf + &quot;_bin-debug-symbols.tar.gz&quot;,
 367                         &quot;bundles/&quot; + pf + &quot;/\\1&quot;
 368                     ],
 369                     subdir: jdk_subdir,
 370                     exploded: &quot;images/jdk&quot;
 371                 },
 372                 static_libs: {
 373                     local: &quot;bundles/\\(jdk.*bin-static-libs-debug.tar.gz\\)&quot;,
 374                     remote: [
 375                         &quot;bundles/&quot; + pf + &quot;/jdk-&quot; + data.version + &quot;_&quot; + pf + &quot;_bin-static-libs-debug.tar.gz&quot;,
 376                         &quot;bundles/&quot; + pf + &quot;/\\1&quot;
 377                     ],
 378                     subdir: jdk_subdir,
 379                 },
 380             }
 381         };
 382     };
 383 
<span class="line-modified"> 384     common.boot_jdk_version = &quot;13&quot;;</span>
<span class="line-modified"> 385     common.boot_jdk_build_number = &quot;33&quot;;</span>
 386     common.boot_jdk_home = input.get(&quot;boot_jdk&quot;, &quot;install_path&quot;) + &quot;/jdk-&quot;
 387         + common.boot_jdk_version
 388         + (input.build_os == &quot;macosx&quot; ? &quot;.jdk/Contents/Home&quot; : &quot;&quot;);
 389 
 390     return common;
 391 };
 392 
 393 /**
 394  * Generates the profiles part of the configuration.
 395  *
 396  * @param input External data to use for generating the configuration
 397  * @param common The common values
 398  * @returns {{}} Profiles part of the configuration
 399  */
 400 var getJibProfilesProfiles = function (input, common, data) {
 401     // Main SE profiles
 402     var profiles = {
 403 
 404         &quot;linux-x64&quot;: {
 405             target_os: &quot;linux&quot;,
</pre>
<hr />
<pre>
 598         profiles[name] = concatObjects(common.debug_profile_base, profiles[name]);
 599         // Override default make target with hotspot as that&#39;s the only part of
 600         // the build using precompiled headers.
 601         profiles[name].default_make_targets = [&quot;hotspot&quot;];
 602     });
 603 
 604     // Bootcycle profiles runs the build with itself as the boot jdk. This can
 605     // be done in two ways. Either using the builtin bootcycle target in the
 606     // build system. Or by supplying the main jdk build as bootjdk to configure.
 607     [ &quot;linux-x64&quot;, &quot;macosx-x64&quot;, &quot;solaris-sparcv9&quot;, &quot;windows-x64&quot;]
 608         .forEach(function (name) {
 609             var bootcycleName = name + &quot;-bootcycle&quot;;
 610             var bootcyclePrebuiltName = name + &quot;-bootcycle-prebuilt&quot;;
 611             // The base bootcycle profile just changes the default target
 612             // compared to the base profile
 613             profiles[bootcycleName] = clone(profiles[name]);
 614             profiles[bootcycleName].default_make_targets = [ &quot;bootcycle-images&quot; ];
 615             // The prebuilt bootcycle variant modifies the boot jdk argument
 616             var bootcyclePrebuiltBase = {
 617                 dependencies: [ name + &quot;.jdk&quot; ],
<span class="line-modified"> 618                 configure_args: &quot;--with-boot-jdk=&quot; + input.get(name + &quot;.jdk&quot;, &quot;home_path&quot;),</span>






 619             }
 620             profiles[bootcyclePrebuiltName] = concatObjects(profiles[name],
 621                 bootcyclePrebuiltBase);
 622             var bootJdkIndex = profiles[bootcyclePrebuiltName].dependencies.indexOf(&quot;boot_jdk&quot;);
 623             delete profiles[bootcyclePrebuiltName].dependencies[bootJdkIndex];
 624             profiles[bootcyclePrebuiltName].default_make_targets = [ &quot;product-images&quot; ];
 625         });
 626 
 627     // JCov profiles build JCov-instrumented JDK image based on images provided through dependencies.
 628     [ &quot;linux-aarch64&quot;, &quot;linux-x64&quot;, &quot;macosx-x64&quot;, &quot;solaris-sparcv9&quot;, &quot;windows-x64&quot;]
 629         .forEach(function (name) {
 630             var jcovName = name + &quot;-jcov&quot;;
 631             profiles[jcovName] = clone(common.main_profile_base);
 632             profiles[jcovName].target_os = profiles[name].target_os
 633             profiles[jcovName].target_cpu = profiles[name].target_cpu
 634             profiles[jcovName].default_make_targets = [ &quot;jcov-bundles&quot; ];
 635             profiles[jcovName].dependencies = concat(profiles[jcovName].dependencies,
 636                 [ name + &quot;.jdk&quot;, &quot;devkit&quot; ]);
 637             profiles[jcovName].configure_args = concat(profiles[jcovName].configure_args,
 638                 [&quot;--with-jcov-input-jdk=&quot; + input.get(name + &quot;.jdk&quot;, &quot;home_path&quot;)]);
</pre>
<hr />
<pre>
 992     if (input.build_platform != input.target_platform
 993        &amp;&amp; input.build_platform != devkit_platform) {
 994         devkit_cross_prefix = input.build_platform + &quot;-to-&quot;;
 995     }
 996 
 997     var boot_jdk_platform = (input.build_os == &quot;macosx&quot; ? &quot;osx&quot; : input.build_os)
 998         + &quot;-&quot; + input.build_cpu;
 999     var boot_jdk_ext = (input.build_os == &quot;windows&quot; ? &quot;.zip&quot; : &quot;.tar.gz&quot;)
1000     // If running in WSL and building for Windows, it will look like Linux,
1001     // but we need a Windows boot JDK.
1002     if (isWsl(input) &amp;&amp; input.target_os == &quot;windows&quot;) {
1003         boot_jdk_platform = &quot;windows-&quot; + input.build_cpu;
1004         boot_jdk_ext = &quot;.zip&quot;;
1005     }
1006 
1007     var makeBinDir = (input.build_os == &quot;windows&quot;
1008         ? input.get(&quot;gnumake&quot;, &quot;install_path&quot;) + &quot;/cygwin/bin&quot;
1009         : input.get(&quot;gnumake&quot;, &quot;install_path&quot;) + &quot;/bin&quot;);
1010 
1011     if (input.build_cpu == &#39;aarch64&#39;) {
<span class="line-modified">1012 	boot_jdk = {</span>
1013             organization: common.organization,
1014             ext: &quot;tar.gz&quot;,
1015             module: &quot;jdk-linux_aarch64&quot;,
1016             revision: &quot;13+1.0&quot;,
1017             configure_args: &quot;--with-boot-jdk=&quot; + common.boot_jdk_home,
1018             environment_path: common.boot_jdk_home + &quot;/bin&quot;
<span class="line-modified">1019 	}</span>
1020     } else {
<span class="line-modified">1021 	boot_jdk = {</span>
1022             server: &quot;jpg&quot;,
1023             product: &quot;jdk&quot;,
1024             version: common.boot_jdk_version,
1025             build_number: common.boot_jdk_build_number,
1026             file: &quot;bundles/&quot; + boot_jdk_platform + &quot;/jdk-&quot; + common.boot_jdk_version + &quot;_&quot;
1027                 + boot_jdk_platform + &quot;_bin&quot; + boot_jdk_ext,
1028             configure_args: &quot;--with-boot-jdk=&quot; + common.boot_jdk_home,
1029             environment_path: common.boot_jdk_home + &quot;/bin&quot;
<span class="line-modified">1030 	}</span>





1031     }
1032 
1033     var dependencies = {
1034         boot_jdk: boot_jdk,
1035 
1036         devkit: {
1037             organization: common.organization,
1038             ext: &quot;tar.gz&quot;,
1039             module: &quot;devkit-&quot; + devkit_cross_prefix + devkit_platform,
1040             revision: devkit_platform_revisions[devkit_platform],
1041             environment: {
1042                 &quot;DEVKIT_HOME&quot;: input.get(&quot;devkit&quot;, &quot;home_path&quot;),
1043             }
1044         },
1045 
1046         build_devkit: {
1047             organization: common.organization,
1048             ext: &quot;tar.gz&quot;,
1049             module: &quot;devkit-&quot; + input.build_platform,
1050             revision: devkit_platform_revisions[input.build_platform]
</pre>
</td>
<td>
<hr />
<pre>
 364                     local: &quot;bundles/\\(jdk.*bin-debug-symbols.tar.gz\\)&quot;,
 365                     remote: [
 366                         &quot;bundles/&quot; + pf + &quot;/jdk-&quot; + data.version + &quot;_&quot; + pf + &quot;_bin-debug-symbols.tar.gz&quot;,
 367                         &quot;bundles/&quot; + pf + &quot;/\\1&quot;
 368                     ],
 369                     subdir: jdk_subdir,
 370                     exploded: &quot;images/jdk&quot;
 371                 },
 372                 static_libs: {
 373                     local: &quot;bundles/\\(jdk.*bin-static-libs-debug.tar.gz\\)&quot;,
 374                     remote: [
 375                         &quot;bundles/&quot; + pf + &quot;/jdk-&quot; + data.version + &quot;_&quot; + pf + &quot;_bin-static-libs-debug.tar.gz&quot;,
 376                         &quot;bundles/&quot; + pf + &quot;/\\1&quot;
 377                     ],
 378                     subdir: jdk_subdir,
 379                 },
 380             }
 381         };
 382     };
 383 
<span class="line-modified"> 384     common.boot_jdk_version = &quot;14&quot;;</span>
<span class="line-modified"> 385     common.boot_jdk_build_number = &quot;36&quot;;</span>
 386     common.boot_jdk_home = input.get(&quot;boot_jdk&quot;, &quot;install_path&quot;) + &quot;/jdk-&quot;
 387         + common.boot_jdk_version
 388         + (input.build_os == &quot;macosx&quot; ? &quot;.jdk/Contents/Home&quot; : &quot;&quot;);
 389 
 390     return common;
 391 };
 392 
 393 /**
 394  * Generates the profiles part of the configuration.
 395  *
 396  * @param input External data to use for generating the configuration
 397  * @param common The common values
 398  * @returns {{}} Profiles part of the configuration
 399  */
 400 var getJibProfilesProfiles = function (input, common, data) {
 401     // Main SE profiles
 402     var profiles = {
 403 
 404         &quot;linux-x64&quot;: {
 405             target_os: &quot;linux&quot;,
</pre>
<hr />
<pre>
 598         profiles[name] = concatObjects(common.debug_profile_base, profiles[name]);
 599         // Override default make target with hotspot as that&#39;s the only part of
 600         // the build using precompiled headers.
 601         profiles[name].default_make_targets = [&quot;hotspot&quot;];
 602     });
 603 
 604     // Bootcycle profiles runs the build with itself as the boot jdk. This can
 605     // be done in two ways. Either using the builtin bootcycle target in the
 606     // build system. Or by supplying the main jdk build as bootjdk to configure.
 607     [ &quot;linux-x64&quot;, &quot;macosx-x64&quot;, &quot;solaris-sparcv9&quot;, &quot;windows-x64&quot;]
 608         .forEach(function (name) {
 609             var bootcycleName = name + &quot;-bootcycle&quot;;
 610             var bootcyclePrebuiltName = name + &quot;-bootcycle-prebuilt&quot;;
 611             // The base bootcycle profile just changes the default target
 612             // compared to the base profile
 613             profiles[bootcycleName] = clone(profiles[name]);
 614             profiles[bootcycleName].default_make_targets = [ &quot;bootcycle-images&quot; ];
 615             // The prebuilt bootcycle variant modifies the boot jdk argument
 616             var bootcyclePrebuiltBase = {
 617                 dependencies: [ name + &quot;.jdk&quot; ],
<span class="line-modified"> 618                 configure_args: [</span>
<span class="line-added"> 619                     &quot;--with-boot-jdk=&quot; + input.get(name + &quot;.jdk&quot;, &quot;home_path&quot;),</span>
<span class="line-added"> 620                     // Full docs do not currently work with bootcycle build</span>
<span class="line-added"> 621                     // since Nashorn was removed. This negates the</span>
<span class="line-added"> 622                     // --enable-full-docs from the main profile.</span>
<span class="line-added"> 623                     &quot;--enable-full-docs=auto&quot;,</span>
<span class="line-added"> 624                 ]</span>
 625             }
 626             profiles[bootcyclePrebuiltName] = concatObjects(profiles[name],
 627                 bootcyclePrebuiltBase);
 628             var bootJdkIndex = profiles[bootcyclePrebuiltName].dependencies.indexOf(&quot;boot_jdk&quot;);
 629             delete profiles[bootcyclePrebuiltName].dependencies[bootJdkIndex];
 630             profiles[bootcyclePrebuiltName].default_make_targets = [ &quot;product-images&quot; ];
 631         });
 632 
 633     // JCov profiles build JCov-instrumented JDK image based on images provided through dependencies.
 634     [ &quot;linux-aarch64&quot;, &quot;linux-x64&quot;, &quot;macosx-x64&quot;, &quot;solaris-sparcv9&quot;, &quot;windows-x64&quot;]
 635         .forEach(function (name) {
 636             var jcovName = name + &quot;-jcov&quot;;
 637             profiles[jcovName] = clone(common.main_profile_base);
 638             profiles[jcovName].target_os = profiles[name].target_os
 639             profiles[jcovName].target_cpu = profiles[name].target_cpu
 640             profiles[jcovName].default_make_targets = [ &quot;jcov-bundles&quot; ];
 641             profiles[jcovName].dependencies = concat(profiles[jcovName].dependencies,
 642                 [ name + &quot;.jdk&quot;, &quot;devkit&quot; ]);
 643             profiles[jcovName].configure_args = concat(profiles[jcovName].configure_args,
 644                 [&quot;--with-jcov-input-jdk=&quot; + input.get(name + &quot;.jdk&quot;, &quot;home_path&quot;)]);
</pre>
<hr />
<pre>
 998     if (input.build_platform != input.target_platform
 999        &amp;&amp; input.build_platform != devkit_platform) {
1000         devkit_cross_prefix = input.build_platform + &quot;-to-&quot;;
1001     }
1002 
1003     var boot_jdk_platform = (input.build_os == &quot;macosx&quot; ? &quot;osx&quot; : input.build_os)
1004         + &quot;-&quot; + input.build_cpu;
1005     var boot_jdk_ext = (input.build_os == &quot;windows&quot; ? &quot;.zip&quot; : &quot;.tar.gz&quot;)
1006     // If running in WSL and building for Windows, it will look like Linux,
1007     // but we need a Windows boot JDK.
1008     if (isWsl(input) &amp;&amp; input.target_os == &quot;windows&quot;) {
1009         boot_jdk_platform = &quot;windows-&quot; + input.build_cpu;
1010         boot_jdk_ext = &quot;.zip&quot;;
1011     }
1012 
1013     var makeBinDir = (input.build_os == &quot;windows&quot;
1014         ? input.get(&quot;gnumake&quot;, &quot;install_path&quot;) + &quot;/cygwin/bin&quot;
1015         : input.get(&quot;gnumake&quot;, &quot;install_path&quot;) + &quot;/bin&quot;);
1016 
1017     if (input.build_cpu == &#39;aarch64&#39;) {
<span class="line-modified">1018         boot_jdk = {</span>
1019             organization: common.organization,
1020             ext: &quot;tar.gz&quot;,
1021             module: &quot;jdk-linux_aarch64&quot;,
1022             revision: &quot;13+1.0&quot;,
1023             configure_args: &quot;--with-boot-jdk=&quot; + common.boot_jdk_home,
1024             environment_path: common.boot_jdk_home + &quot;/bin&quot;
<span class="line-modified">1025         }</span>
1026     } else {
<span class="line-modified">1027         boot_jdk = {</span>
1028             server: &quot;jpg&quot;,
1029             product: &quot;jdk&quot;,
1030             version: common.boot_jdk_version,
1031             build_number: common.boot_jdk_build_number,
1032             file: &quot;bundles/&quot; + boot_jdk_platform + &quot;/jdk-&quot; + common.boot_jdk_version + &quot;_&quot;
1033                 + boot_jdk_platform + &quot;_bin&quot; + boot_jdk_ext,
1034             configure_args: &quot;--with-boot-jdk=&quot; + common.boot_jdk_home,
1035             environment_path: common.boot_jdk_home + &quot;/bin&quot;
<span class="line-modified">1036         }</span>
<span class="line-added">1037     }</span>
<span class="line-added">1038     if (input.build_cpu == &#39;sparcv9&#39;) {</span>
<span class="line-added">1039         boot_jdk.file = &quot;bundles/openjdk/GPL/&quot; + boot_jdk_platform</span>
<span class="line-added">1040             + &quot;/openjdk-&quot; + common.boot_jdk_version + &quot;_&quot;</span>
<span class="line-added">1041             + boot_jdk_platform + &quot;_bin&quot; + boot_jdk_ext;</span>
1042     }
1043 
1044     var dependencies = {
1045         boot_jdk: boot_jdk,
1046 
1047         devkit: {
1048             organization: common.organization,
1049             ext: &quot;tar.gz&quot;,
1050             module: &quot;devkit-&quot; + devkit_cross_prefix + devkit_platform,
1051             revision: devkit_platform_revisions[devkit_platform],
1052             environment: {
1053                 &quot;DEVKIT_HOME&quot;: input.get(&quot;devkit&quot;, &quot;home_path&quot;),
1054             }
1055         },
1056 
1057         build_devkit: {
1058             organization: common.organization,
1059             ext: &quot;tar.gz&quot;,
1060             module: &quot;devkit-&quot; + input.build_platform,
1061             revision: devkit_platform_revisions[input.build_platform]
</pre>
</td>
</tr>
</table>
<center><a href="../../.hgtags.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="../data/jdwp/jdwp.spec.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>