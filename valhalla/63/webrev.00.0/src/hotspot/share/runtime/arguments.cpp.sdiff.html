<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/runtime/arguments.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../prims/whitebox.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="deoptimization.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/runtime/arguments.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 531   { &quot;CreateMinidumpOnCrash&quot;,        JDK_Version::jdk(9),  JDK_Version::undefined(), JDK_Version::undefined() },
 532   { &quot;TLABStats&quot;,                    JDK_Version::jdk(12), JDK_Version::undefined(), JDK_Version::undefined() },
 533 
 534   // -------------- Obsolete Flags - sorted by expired_in --------------
 535   { &quot;PermSize&quot;,                      JDK_Version::undefined(), JDK_Version::jdk(8),  JDK_Version::undefined() },
 536   { &quot;MaxPermSize&quot;,                   JDK_Version::undefined(), JDK_Version::jdk(8),  JDK_Version::undefined() },
 537   { &quot;SharedReadWriteSize&quot;,           JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 538   { &quot;SharedReadOnlySize&quot;,            JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 539   { &quot;SharedMiscDataSize&quot;,            JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 540   { &quot;SharedMiscCodeSize&quot;,            JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 541   { &quot;BindGCTaskThreadsToCPUs&quot;,       JDK_Version::undefined(), JDK_Version::jdk(14), JDK_Version::jdk(16) },
 542   { &quot;UseGCTaskAffinity&quot;,             JDK_Version::undefined(), JDK_Version::jdk(14), JDK_Version::jdk(16) },
 543   { &quot;GCTaskTimeStampEntries&quot;,        JDK_Version::undefined(), JDK_Version::jdk(14), JDK_Version::jdk(16) },
 544   { &quot;G1RSetScanBlockSize&quot;,           JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 545   { &quot;UseParallelOldGC&quot;,              JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 546   { &quot;CompactFields&quot;,                 JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 547   { &quot;FieldsAllocationStyle&quot;,         JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 548 #ifndef X86
 549   { &quot;UseSSE&quot;,                        JDK_Version::undefined(), JDK_Version::jdk(15), JDK_Version::jdk(16) },
 550 #endif // !X86

 551 
 552 #ifdef TEST_VERIFY_SPECIAL_JVM_FLAGS
 553   // These entries will generate build errors.  Their purpose is to test the macros.
 554   { &quot;dep &gt; obs&quot;,                    JDK_Version::jdk(9), JDK_Version::jdk(8), JDK_Version::undefined() },
 555   { &quot;dep &gt; exp &quot;,                   JDK_Version::jdk(9), JDK_Version::undefined(), JDK_Version::jdk(8) },
 556   { &quot;obs &gt; exp &quot;,                   JDK_Version::undefined(), JDK_Version::jdk(9), JDK_Version::jdk(8) },
 557   { &quot;obs &gt; exp&quot;,                    JDK_Version::jdk(8), JDK_Version::undefined(), JDK_Version::jdk(10) },
 558   { &quot;not deprecated or obsolete&quot;,   JDK_Version::undefined(), JDK_Version::undefined(), JDK_Version::jdk(9) },
 559   { &quot;dup option&quot;,                   JDK_Version::jdk(9), JDK_Version::undefined(), JDK_Version::undefined() },
 560   { &quot;dup option&quot;,                   JDK_Version::jdk(9), JDK_Version::undefined(), JDK_Version::undefined() },
 561 #endif
 562 
 563   { NULL, JDK_Version(0), JDK_Version(0) }
 564 };
 565 
 566 // Flags that are aliases for other flags.
 567 typedef struct {
 568   const char* alias_name;
 569   const char* real_name;
 570 } AliasedFlag;
 571 
 572 static AliasedFlag const aliased_jvm_flags[] = {
 573   { &quot;DefaultMaxRAMFraction&quot;,    &quot;MaxRAMFraction&quot;    },
 574   { &quot;CreateMinidumpOnCrash&quot;,    &quot;CreateCoredumpOnCrash&quot; },
 575   { NULL, NULL}
 576 };
 577 
 578 // NOTE: A compatibility request will be necessary for each alias to be removed.
 579 static AliasedLoggingFlag const aliased_logging_flags[] = {
 580   { &quot;PrintCompressedOopsMode&quot;,   LogLevel::Info,  true,  LOG_TAGS(gc, heap, coops) },
 581   { &quot;PrintSharedSpaces&quot;,         LogLevel::Info,  true,  LOG_TAGS(cds) },
 582   { &quot;TraceBiasedLocking&quot;,        LogLevel::Info,  true,  LOG_TAGS(biasedlocking) },
 583   { &quot;TraceClassLoading&quot;,         LogLevel::Info,  true,  LOG_TAGS(class, load) },
 584   { &quot;TraceClassLoadingPreorder&quot;, LogLevel::Debug, true,  LOG_TAGS(class, preorder) },
 585   { &quot;TraceClassPaths&quot;,           LogLevel::Info,  true,  LOG_TAGS(class, path) },
 586   { &quot;TraceClassResolution&quot;,      LogLevel::Debug, true,  LOG_TAGS(class, resolve) },
 587   { &quot;TraceClassUnloading&quot;,       LogLevel::Info,  true,  LOG_TAGS(class, unload) },
 588   { &quot;TraceExceptions&quot;,           LogLevel::Info,  true,  LOG_TAGS(exceptions) },

 589   { &quot;TraceLoaderConstraints&quot;,    LogLevel::Info,  true,  LOG_TAGS(class, loader, constraints) },

 590   { &quot;TraceMonitorInflation&quot;,     LogLevel::Trace, true,  LOG_TAGS(monitorinflation) },
 591   { &quot;TraceSafepointCleanupTime&quot;, LogLevel::Info,  true,  LOG_TAGS(safepoint, cleanup) },
 592   { &quot;TraceJVMTIObjectTagging&quot;,   LogLevel::Debug, true,  LOG_TAGS(jvmti, objecttagging) },
 593   { &quot;TraceRedefineClasses&quot;,      LogLevel::Info,  false, LOG_TAGS(redefine, class) },
 594   { &quot;PrintJNIResolving&quot;,         LogLevel::Debug, true,  LOG_TAGS(jni, resolve) },
 595   { NULL,                        LogLevel::Off,   false, LOG_TAGS(_NO_TAG) }
 596 };
 597 
 598 #ifndef PRODUCT
 599 // These options are removed in jdk9. Remove this code for jdk10.
 600 static AliasedFlag const removed_develop_logging_flags[] = {
 601   { &quot;TraceClassInitialization&quot;,   &quot;-Xlog:class+init&quot; },
 602   { &quot;TraceClassLoaderData&quot;,       &quot;-Xlog:class+loader+data&quot; },
 603   { &quot;TraceDefaultMethods&quot;,        &quot;-Xlog:defaultmethods=debug&quot; },
 604   { &quot;TraceItables&quot;,               &quot;-Xlog:itables=debug&quot; },
 605   { &quot;TraceMonitorMismatch&quot;,       &quot;-Xlog:monitormismatch=info&quot; },
 606   { &quot;TraceSafepoint&quot;,             &quot;-Xlog:safepoint=debug&quot; },
 607   { &quot;TraceStartupTime&quot;,           &quot;-Xlog:startuptime&quot; },
 608   { &quot;TraceVMOperation&quot;,           &quot;-Xlog:vmoperation=debug&quot; },
 609   { &quot;PrintVtables&quot;,               &quot;-Xlog:vtables=debug&quot; },
</pre>
<hr />
<pre>
 701 static bool lookup_special_flag(const char *flag_name, size_t skip_index) {
 702   for (size_t i = 0; special_jvm_flags[i].name != NULL; i++) {
 703     if ((i != skip_index) &amp;&amp; (strcmp(special_jvm_flags[i].name, flag_name) == 0)) {
 704       return true;
 705     }
 706   }
 707   return false;
 708 }
 709 
 710 // Verifies the correctness of the entries in the special_jvm_flags table.
 711 // If there is a semantic error (i.e. a bug in the table) such as the obsoletion
 712 // version being earlier than the deprecation version, then a warning is issued
 713 // and verification fails - by returning false. If it is detected that the table
 714 // is out of date, with respect to the current version, then ideally a warning is
 715 // issued but verification does not fail. This allows the VM to operate when the
 716 // version is first updated, without needing to update all the impacted flags at
 717 // the same time. In practice we can&#39;t issue the warning immediately when the version
 718 // is updated as it occurs for every test and some tests are not prepared to handle
 719 // unexpected output - see 8196739. Instead we only check if the table is up-to-date
 720 // if the check_globals flag is true, and in addition allow a grace period and only
<span class="line-modified"> 721 // check for stale flags when we hit build 20 (which is far enough into the 6 month</span>
 722 // release cycle that all flag updates should have been processed, whilst still
 723 // leaving time to make the change before RDP2).
 724 // We use a gtest to call this, passing true, so that we can detect stale flags before
 725 // the end of the release cycle.
 726 
<span class="line-modified"> 727 static const int SPECIAL_FLAG_VALIDATION_BUILD = 20;</span>
 728 
 729 bool Arguments::verify_special_jvm_flags(bool check_globals) {
 730   bool success = true;
 731   for (size_t i = 0; special_jvm_flags[i].name != NULL; i++) {
 732     const SpecialFlag&amp; flag = special_jvm_flags[i];
 733     if (lookup_special_flag(flag.name, i)) {
 734       warning(&quot;Duplicate special flag declaration \&quot;%s\&quot;&quot;, flag.name);
 735       success = false;
 736     }
 737     if (flag.deprecated_in.is_undefined() &amp;&amp;
 738         flag.obsolete_in.is_undefined()) {
 739       warning(&quot;Special flag entry \&quot;%s\&quot; must declare version deprecated and/or obsoleted in.&quot;, flag.name);
 740       success = false;
 741     }
 742 
 743     if (!flag.deprecated_in.is_undefined()) {
 744       if (!version_less_than(flag.deprecated_in, flag.obsolete_in)) {
 745         warning(&quot;Special flag entry \&quot;%s\&quot; must be deprecated before obsoleted.&quot;, flag.name);
 746         success = false;
 747       }
</pre>
</td>
<td>
<hr />
<pre>
 531   { &quot;CreateMinidumpOnCrash&quot;,        JDK_Version::jdk(9),  JDK_Version::undefined(), JDK_Version::undefined() },
 532   { &quot;TLABStats&quot;,                    JDK_Version::jdk(12), JDK_Version::undefined(), JDK_Version::undefined() },
 533 
 534   // -------------- Obsolete Flags - sorted by expired_in --------------
 535   { &quot;PermSize&quot;,                      JDK_Version::undefined(), JDK_Version::jdk(8),  JDK_Version::undefined() },
 536   { &quot;MaxPermSize&quot;,                   JDK_Version::undefined(), JDK_Version::jdk(8),  JDK_Version::undefined() },
 537   { &quot;SharedReadWriteSize&quot;,           JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 538   { &quot;SharedReadOnlySize&quot;,            JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 539   { &quot;SharedMiscDataSize&quot;,            JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 540   { &quot;SharedMiscCodeSize&quot;,            JDK_Version::undefined(), JDK_Version::jdk(10), JDK_Version::undefined() },
 541   { &quot;BindGCTaskThreadsToCPUs&quot;,       JDK_Version::undefined(), JDK_Version::jdk(14), JDK_Version::jdk(16) },
 542   { &quot;UseGCTaskAffinity&quot;,             JDK_Version::undefined(), JDK_Version::jdk(14), JDK_Version::jdk(16) },
 543   { &quot;GCTaskTimeStampEntries&quot;,        JDK_Version::undefined(), JDK_Version::jdk(14), JDK_Version::jdk(16) },
 544   { &quot;G1RSetScanBlockSize&quot;,           JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 545   { &quot;UseParallelOldGC&quot;,              JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 546   { &quot;CompactFields&quot;,                 JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 547   { &quot;FieldsAllocationStyle&quot;,         JDK_Version::jdk(14),     JDK_Version::jdk(15), JDK_Version::jdk(16) },
 548 #ifndef X86
 549   { &quot;UseSSE&quot;,                        JDK_Version::undefined(), JDK_Version::jdk(15), JDK_Version::jdk(16) },
 550 #endif // !X86
<span class="line-added"> 551   { &quot;UseAdaptiveGCBoundary&quot;,         JDK_Version::undefined(), JDK_Version::jdk(15), JDK_Version::jdk(16) },</span>
 552 
 553 #ifdef TEST_VERIFY_SPECIAL_JVM_FLAGS
 554   // These entries will generate build errors.  Their purpose is to test the macros.
 555   { &quot;dep &gt; obs&quot;,                    JDK_Version::jdk(9), JDK_Version::jdk(8), JDK_Version::undefined() },
 556   { &quot;dep &gt; exp &quot;,                   JDK_Version::jdk(9), JDK_Version::undefined(), JDK_Version::jdk(8) },
 557   { &quot;obs &gt; exp &quot;,                   JDK_Version::undefined(), JDK_Version::jdk(9), JDK_Version::jdk(8) },
 558   { &quot;obs &gt; exp&quot;,                    JDK_Version::jdk(8), JDK_Version::undefined(), JDK_Version::jdk(10) },
 559   { &quot;not deprecated or obsolete&quot;,   JDK_Version::undefined(), JDK_Version::undefined(), JDK_Version::jdk(9) },
 560   { &quot;dup option&quot;,                   JDK_Version::jdk(9), JDK_Version::undefined(), JDK_Version::undefined() },
 561   { &quot;dup option&quot;,                   JDK_Version::jdk(9), JDK_Version::undefined(), JDK_Version::undefined() },
 562 #endif
 563 
 564   { NULL, JDK_Version(0), JDK_Version(0) }
 565 };
 566 
 567 // Flags that are aliases for other flags.
 568 typedef struct {
 569   const char* alias_name;
 570   const char* real_name;
 571 } AliasedFlag;
 572 
 573 static AliasedFlag const aliased_jvm_flags[] = {
 574   { &quot;DefaultMaxRAMFraction&quot;,    &quot;MaxRAMFraction&quot;    },
 575   { &quot;CreateMinidumpOnCrash&quot;,    &quot;CreateCoredumpOnCrash&quot; },
 576   { NULL, NULL}
 577 };
 578 
 579 // NOTE: A compatibility request will be necessary for each alias to be removed.
 580 static AliasedLoggingFlag const aliased_logging_flags[] = {
 581   { &quot;PrintCompressedOopsMode&quot;,   LogLevel::Info,  true,  LOG_TAGS(gc, heap, coops) },
 582   { &quot;PrintSharedSpaces&quot;,         LogLevel::Info,  true,  LOG_TAGS(cds) },
 583   { &quot;TraceBiasedLocking&quot;,        LogLevel::Info,  true,  LOG_TAGS(biasedlocking) },
 584   { &quot;TraceClassLoading&quot;,         LogLevel::Info,  true,  LOG_TAGS(class, load) },
 585   { &quot;TraceClassLoadingPreorder&quot;, LogLevel::Debug, true,  LOG_TAGS(class, preorder) },
 586   { &quot;TraceClassPaths&quot;,           LogLevel::Info,  true,  LOG_TAGS(class, path) },
 587   { &quot;TraceClassResolution&quot;,      LogLevel::Debug, true,  LOG_TAGS(class, resolve) },
 588   { &quot;TraceClassUnloading&quot;,       LogLevel::Info,  true,  LOG_TAGS(class, unload) },
 589   { &quot;TraceExceptions&quot;,           LogLevel::Info,  true,  LOG_TAGS(exceptions) },
<span class="line-added"> 590   { &quot;TraceInvokeDynamic&quot;,        LogLevel::Debug, true,  LOG_TAGS(methodhandles, indy) },</span>
 591   { &quot;TraceLoaderConstraints&quot;,    LogLevel::Info,  true,  LOG_TAGS(class, loader, constraints) },
<span class="line-added"> 592   { &quot;TraceMethodHandles&quot;,        LogLevel::Info,  true,  LOG_TAGS(methodhandles) },</span>
 593   { &quot;TraceMonitorInflation&quot;,     LogLevel::Trace, true,  LOG_TAGS(monitorinflation) },
 594   { &quot;TraceSafepointCleanupTime&quot;, LogLevel::Info,  true,  LOG_TAGS(safepoint, cleanup) },
 595   { &quot;TraceJVMTIObjectTagging&quot;,   LogLevel::Debug, true,  LOG_TAGS(jvmti, objecttagging) },
 596   { &quot;TraceRedefineClasses&quot;,      LogLevel::Info,  false, LOG_TAGS(redefine, class) },
 597   { &quot;PrintJNIResolving&quot;,         LogLevel::Debug, true,  LOG_TAGS(jni, resolve) },
 598   { NULL,                        LogLevel::Off,   false, LOG_TAGS(_NO_TAG) }
 599 };
 600 
 601 #ifndef PRODUCT
 602 // These options are removed in jdk9. Remove this code for jdk10.
 603 static AliasedFlag const removed_develop_logging_flags[] = {
 604   { &quot;TraceClassInitialization&quot;,   &quot;-Xlog:class+init&quot; },
 605   { &quot;TraceClassLoaderData&quot;,       &quot;-Xlog:class+loader+data&quot; },
 606   { &quot;TraceDefaultMethods&quot;,        &quot;-Xlog:defaultmethods=debug&quot; },
 607   { &quot;TraceItables&quot;,               &quot;-Xlog:itables=debug&quot; },
 608   { &quot;TraceMonitorMismatch&quot;,       &quot;-Xlog:monitormismatch=info&quot; },
 609   { &quot;TraceSafepoint&quot;,             &quot;-Xlog:safepoint=debug&quot; },
 610   { &quot;TraceStartupTime&quot;,           &quot;-Xlog:startuptime&quot; },
 611   { &quot;TraceVMOperation&quot;,           &quot;-Xlog:vmoperation=debug&quot; },
 612   { &quot;PrintVtables&quot;,               &quot;-Xlog:vtables=debug&quot; },
</pre>
<hr />
<pre>
 704 static bool lookup_special_flag(const char *flag_name, size_t skip_index) {
 705   for (size_t i = 0; special_jvm_flags[i].name != NULL; i++) {
 706     if ((i != skip_index) &amp;&amp; (strcmp(special_jvm_flags[i].name, flag_name) == 0)) {
 707       return true;
 708     }
 709   }
 710   return false;
 711 }
 712 
 713 // Verifies the correctness of the entries in the special_jvm_flags table.
 714 // If there is a semantic error (i.e. a bug in the table) such as the obsoletion
 715 // version being earlier than the deprecation version, then a warning is issued
 716 // and verification fails - by returning false. If it is detected that the table
 717 // is out of date, with respect to the current version, then ideally a warning is
 718 // issued but verification does not fail. This allows the VM to operate when the
 719 // version is first updated, without needing to update all the impacted flags at
 720 // the same time. In practice we can&#39;t issue the warning immediately when the version
 721 // is updated as it occurs for every test and some tests are not prepared to handle
 722 // unexpected output - see 8196739. Instead we only check if the table is up-to-date
 723 // if the check_globals flag is true, and in addition allow a grace period and only
<span class="line-modified"> 724 // check for stale flags when we hit build 25 (which is far enough into the 6 month</span>
 725 // release cycle that all flag updates should have been processed, whilst still
 726 // leaving time to make the change before RDP2).
 727 // We use a gtest to call this, passing true, so that we can detect stale flags before
 728 // the end of the release cycle.
 729 
<span class="line-modified"> 730 static const int SPECIAL_FLAG_VALIDATION_BUILD = 25;</span>
 731 
 732 bool Arguments::verify_special_jvm_flags(bool check_globals) {
 733   bool success = true;
 734   for (size_t i = 0; special_jvm_flags[i].name != NULL; i++) {
 735     const SpecialFlag&amp; flag = special_jvm_flags[i];
 736     if (lookup_special_flag(flag.name, i)) {
 737       warning(&quot;Duplicate special flag declaration \&quot;%s\&quot;&quot;, flag.name);
 738       success = false;
 739     }
 740     if (flag.deprecated_in.is_undefined() &amp;&amp;
 741         flag.obsolete_in.is_undefined()) {
 742       warning(&quot;Special flag entry \&quot;%s\&quot; must declare version deprecated and/or obsoleted in.&quot;, flag.name);
 743       success = false;
 744     }
 745 
 746     if (!flag.deprecated_in.is_undefined()) {
 747       if (!version_less_than(flag.deprecated_in, flag.obsolete_in)) {
 748         warning(&quot;Special flag entry \&quot;%s\&quot; must be deprecated before obsoleted.&quot;, flag.name);
 749         success = false;
 750       }
</pre>
</td>
</tr>
</table>
<center><a href="../prims/whitebox.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="deoptimization.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>