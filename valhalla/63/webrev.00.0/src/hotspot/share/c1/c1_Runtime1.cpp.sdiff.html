<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/c1/c1_Runtime1.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="c1_LinearScan.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../ci/bcEscapeAnalyzer.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/c1/c1_Runtime1.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 797     thread, object-&gt;klass());
 798   SharedRuntime::throw_and_post_jvmti_exception(
 799     thread, vmSymbols::java_lang_ClassCastException(), message);
 800 JRT_END
 801 
 802 
 803 JRT_ENTRY(void, Runtime1::throw_incompatible_class_change_error(JavaThread* thread))
 804   NOT_PRODUCT(_throw_incompatible_class_change_error_count++;)
 805   ResourceMark rm(thread);
 806   SharedRuntime::throw_and_post_jvmti_exception(thread, vmSymbols::java_lang_IncompatibleClassChangeError());
 807 JRT_END
 808 
 809 
 810 JRT_ENTRY(void, Runtime1::throw_illegal_monitor_state_exception(JavaThread* thread))
 811   NOT_PRODUCT(_throw_illegal_monitor_state_exception_count++;)
 812   ResourceMark rm(thread);
 813   SharedRuntime::throw_and_post_jvmti_exception(thread, vmSymbols::java_lang_IllegalMonitorStateException());
 814 JRT_END
 815 
 816 
<span class="line-modified"> 817 JRT_ENTRY_NO_ASYNC(void, Runtime1::monitorenter(JavaThread* thread, oopDesc* obj, BasicObjectLock* lock))</span>
 818   NOT_PRODUCT(_monitorenter_slowcase_cnt++;)
<span class="line-removed"> 819   if (PrintBiasedLockingStatistics) {</span>
<span class="line-removed"> 820     Atomic::inc(BiasedLocking::slow_path_entry_count_addr());</span>
<span class="line-removed"> 821   }</span>
<span class="line-removed"> 822   Handle h_obj(thread, obj);</span>
 823   if (!UseFastLocking) {
 824     lock-&gt;set_obj(obj);
 825   }
 826   assert(obj == lock-&gt;obj(), &quot;must match&quot;);
<span class="line-modified"> 827   ObjectSynchronizer::enter(h_obj, lock-&gt;lock(), THREAD);</span>
 828 JRT_END
 829 
 830 
 831 JRT_LEAF(void, Runtime1::monitorexit(JavaThread* thread, BasicObjectLock* lock))
 832   NOT_PRODUCT(_monitorexit_slowcase_cnt++;)
<span class="line-removed"> 833   assert(thread == JavaThread::current(), &quot;threads must correspond&quot;);</span>
<span class="line-removed"> 834   assert(thread-&gt;last_Java_sp(), &quot;last_Java_sp must be set&quot;);</span>
<span class="line-removed"> 835   // monitorexit is non-blocking (leaf routine) =&gt; no exceptions can be thrown</span>
<span class="line-removed"> 836   EXCEPTION_MARK;</span>
 837 
 838   oop obj = lock-&gt;obj();
 839   assert(oopDesc::is_oop(obj), &quot;must be NULL or an object&quot;);
<span class="line-modified"> 840   ObjectSynchronizer::exit(obj, lock-&gt;lock(), THREAD);</span>
 841 JRT_END
 842 
 843 // Cf. OptoRuntime::deoptimize_caller_frame
 844 JRT_ENTRY(void, Runtime1::deoptimize(JavaThread* thread, jint trap_request))
 845   // Called from within the owner thread, so no need for safepoint
 846   RegisterMap reg_map(thread, false);
 847   frame stub_frame = thread-&gt;last_frame();
 848   assert(stub_frame.is_runtime_frame(), &quot;Sanity check&quot;);
 849   frame caller_frame = stub_frame.sender(&amp;reg_map);
 850   nmethod* nm = caller_frame.cb()-&gt;as_nmethod_or_null();
 851   assert(nm != NULL, &quot;Sanity check&quot;);
 852   methodHandle method(thread, nm-&gt;method());
 853   assert(nm == CodeCache::find_nmethod(caller_frame.pc()), &quot;Should be the same&quot;);
 854   Deoptimization::DeoptAction action = Deoptimization::trap_request_action(trap_request);
 855   Deoptimization::DeoptReason reason = Deoptimization::trap_request_reason(trap_request);
 856 
 857   if (action == Deoptimization::Action_make_not_entrant) {
 858     if (nm-&gt;make_not_entrant()) {
 859       if (reason == Deoptimization::Reason_tenured) {
 860         MethodData* trap_mdo = Deoptimization::get_method_data(thread, method, true /*create_if_missing*/);
</pre>
</td>
<td>
<hr />
<pre>
 797     thread, object-&gt;klass());
 798   SharedRuntime::throw_and_post_jvmti_exception(
 799     thread, vmSymbols::java_lang_ClassCastException(), message);
 800 JRT_END
 801 
 802 
 803 JRT_ENTRY(void, Runtime1::throw_incompatible_class_change_error(JavaThread* thread))
 804   NOT_PRODUCT(_throw_incompatible_class_change_error_count++;)
 805   ResourceMark rm(thread);
 806   SharedRuntime::throw_and_post_jvmti_exception(thread, vmSymbols::java_lang_IncompatibleClassChangeError());
 807 JRT_END
 808 
 809 
 810 JRT_ENTRY(void, Runtime1::throw_illegal_monitor_state_exception(JavaThread* thread))
 811   NOT_PRODUCT(_throw_illegal_monitor_state_exception_count++;)
 812   ResourceMark rm(thread);
 813   SharedRuntime::throw_and_post_jvmti_exception(thread, vmSymbols::java_lang_IllegalMonitorStateException());
 814 JRT_END
 815 
 816 
<span class="line-modified"> 817 JRT_BLOCK_ENTRY(void, Runtime1::monitorenter(JavaThread* thread, oopDesc* obj, BasicObjectLock* lock))</span>
 818   NOT_PRODUCT(_monitorenter_slowcase_cnt++;)




 819   if (!UseFastLocking) {
 820     lock-&gt;set_obj(obj);
 821   }
 822   assert(obj == lock-&gt;obj(), &quot;must match&quot;);
<span class="line-modified"> 823   SharedRuntime::monitor_enter_helper(obj, lock-&gt;lock(), thread);</span>
 824 JRT_END
 825 
 826 
 827 JRT_LEAF(void, Runtime1::monitorexit(JavaThread* thread, BasicObjectLock* lock))
 828   NOT_PRODUCT(_monitorexit_slowcase_cnt++;)




 829   assert(thread-&gt;last_Java_sp(), &quot;last_Java_sp must be set&quot;);
 830   oop obj = lock-&gt;obj();
 831   assert(oopDesc::is_oop(obj), &quot;must be NULL or an object&quot;);
<span class="line-modified"> 832   SharedRuntime::monitor_exit_helper(obj, lock-&gt;lock(), thread);</span>
 833 JRT_END
 834 
 835 // Cf. OptoRuntime::deoptimize_caller_frame
 836 JRT_ENTRY(void, Runtime1::deoptimize(JavaThread* thread, jint trap_request))
 837   // Called from within the owner thread, so no need for safepoint
 838   RegisterMap reg_map(thread, false);
 839   frame stub_frame = thread-&gt;last_frame();
 840   assert(stub_frame.is_runtime_frame(), &quot;Sanity check&quot;);
 841   frame caller_frame = stub_frame.sender(&amp;reg_map);
 842   nmethod* nm = caller_frame.cb()-&gt;as_nmethod_or_null();
 843   assert(nm != NULL, &quot;Sanity check&quot;);
 844   methodHandle method(thread, nm-&gt;method());
 845   assert(nm == CodeCache::find_nmethod(caller_frame.pc()), &quot;Should be the same&quot;);
 846   Deoptimization::DeoptAction action = Deoptimization::trap_request_action(trap_request);
 847   Deoptimization::DeoptReason reason = Deoptimization::trap_request_reason(trap_request);
 848 
 849   if (action == Deoptimization::Action_make_not_entrant) {
 850     if (nm-&gt;make_not_entrant()) {
 851       if (reason == Deoptimization::Reason_tenured) {
 852         MethodData* trap_mdo = Deoptimization::get_method_data(thread, method, true /*create_if_missing*/);
</pre>
</td>
</tr>
</table>
<center><a href="c1_LinearScan.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../ci/bcEscapeAnalyzer.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>