<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/opto/macro.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="graphKit.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="macroArrayCopy.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/opto/macro.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
2847   assert(bol-&gt;is_Bool() &amp;&amp; bol-&gt;as_Bool()-&gt;_test._test == BoolTest::ne, &quot;unexpected bool node&quot;);
2848 
2849   for (DUIterator_Last imin, i = bol-&gt;last_outs(imin); i &gt;= imin; --i) {
2850     Node* iff = bol-&gt;last_out(i);
2851     assert(iff-&gt;is_If(), &quot;where&#39;s the if?&quot;);
2852 
2853     if (iff-&gt;in(0)-&gt;is_top()) {
2854       _igvn.replace_input_of(iff, 1, C-&gt;top());
2855       continue;
2856     }
2857 
2858     Node* iftrue = iff-&gt;as_If()-&gt;proj_out(1);
2859     Node* iffalse = iff-&gt;as_If()-&gt;proj_out(0);
2860     Node* ctrl = iff-&gt;in(0);
2861 
2862     Node* subklass = NULL;
2863     if (_igvn.type(obj_or_subklass)-&gt;isa_klassptr()) {
2864       subklass = obj_or_subklass;
2865     } else {
2866       Node* k_adr = basic_plus_adr(obj_or_subklass, oopDesc::klass_offset_in_bytes());
<span class="line-modified">2867       subklass = _igvn.transform(LoadKlassNode::make(_igvn, NULL, C-&gt;immutable_memory(), k_adr, TypeInstPtr::KLASS, TypeKlassPtr::OBJECT, true));</span>
2868     }
2869 
2870     Node* not_subtype_ctrl = Phase::gen_subtype_check(subklass, superklass, &amp;ctrl, NULL, _igvn);
2871 
2872     _igvn.replace_input_of(iff, 0, C-&gt;top());
2873     _igvn.replace_node(iftrue, not_subtype_ctrl);
2874     _igvn.replace_node(iffalse, ctrl);
2875   }
2876   _igvn.replace_node(check, C-&gt;top());
2877 }
2878 
2879 //---------------------------eliminate_macro_nodes----------------------
2880 // Eliminate scalar replaced allocations and associated locks.
2881 void PhaseMacroExpand::eliminate_macro_nodes() {
2882   if (C-&gt;macro_count() == 0)
2883     return;
2884 
2885   // First, attempt to eliminate locks
2886   int cnt = C-&gt;macro_count();
2887   for (int i=0; i &lt; cnt; i++) {
</pre>
</td>
<td>
<hr />
<pre>
2847   assert(bol-&gt;is_Bool() &amp;&amp; bol-&gt;as_Bool()-&gt;_test._test == BoolTest::ne, &quot;unexpected bool node&quot;);
2848 
2849   for (DUIterator_Last imin, i = bol-&gt;last_outs(imin); i &gt;= imin; --i) {
2850     Node* iff = bol-&gt;last_out(i);
2851     assert(iff-&gt;is_If(), &quot;where&#39;s the if?&quot;);
2852 
2853     if (iff-&gt;in(0)-&gt;is_top()) {
2854       _igvn.replace_input_of(iff, 1, C-&gt;top());
2855       continue;
2856     }
2857 
2858     Node* iftrue = iff-&gt;as_If()-&gt;proj_out(1);
2859     Node* iffalse = iff-&gt;as_If()-&gt;proj_out(0);
2860     Node* ctrl = iff-&gt;in(0);
2861 
2862     Node* subklass = NULL;
2863     if (_igvn.type(obj_or_subklass)-&gt;isa_klassptr()) {
2864       subklass = obj_or_subklass;
2865     } else {
2866       Node* k_adr = basic_plus_adr(obj_or_subklass, oopDesc::klass_offset_in_bytes());
<span class="line-modified">2867       subklass = _igvn.transform(LoadKlassNode::make(_igvn, NULL, C-&gt;immutable_memory(), k_adr, TypeInstPtr::KLASS, TypeKlassPtr::OBJECT));</span>
2868     }
2869 
2870     Node* not_subtype_ctrl = Phase::gen_subtype_check(subklass, superklass, &amp;ctrl, NULL, _igvn);
2871 
2872     _igvn.replace_input_of(iff, 0, C-&gt;top());
2873     _igvn.replace_node(iftrue, not_subtype_ctrl);
2874     _igvn.replace_node(iffalse, ctrl);
2875   }
2876   _igvn.replace_node(check, C-&gt;top());
2877 }
2878 
2879 //---------------------------eliminate_macro_nodes----------------------
2880 // Eliminate scalar replaced allocations and associated locks.
2881 void PhaseMacroExpand::eliminate_macro_nodes() {
2882   if (C-&gt;macro_count() == 0)
2883     return;
2884 
2885   // First, attempt to eliminate locks
2886   int cnt = C-&gt;macro_count();
2887   for (int i=0; i &lt; cnt; i++) {
</pre>
</td>
</tr>
</table>
<center><a href="graphKit.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="macroArrayCopy.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>