<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.controls/src/main/java/javafx/scene/control/skin/ListViewSkin.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ComboBoxListViewSkin.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../test/java/test/javafx/scene/control/ComboBoxTest.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.controls/src/main/java/javafx/scene/control/skin/ListViewSkin.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
188      * well as the necessary input mappings for handling key, mouse, etc events.
189      *
190      * @param control The control that this skin should be installed onto.
191      */
192     public ListViewSkin(final ListView&lt;T&gt; control) {
193         super(control);
194 
195         // install default input map for the ListView control
196         behavior = new ListViewBehavior&lt;&gt;(control);
197 //        control.setInputMap(behavior.getInputMap());
198 
199         // init the behavior &#39;closures&#39;
200         behavior.setOnFocusPreviousRow(() -&gt; onFocusPreviousCell());
201         behavior.setOnFocusNextRow(() -&gt; onFocusNextCell());
202         behavior.setOnMoveToFirstCell(() -&gt; onMoveToFirstCell());
203         behavior.setOnMoveToLastCell(() -&gt; onMoveToLastCell());
204         behavior.setOnSelectPreviousRow(() -&gt; onSelectPreviousCell());
205         behavior.setOnSelectNextRow(() -&gt; onSelectNextCell());
206         behavior.setOnScrollPageDown(this::onScrollPageDown);
207         behavior.setOnScrollPageUp(this::onScrollPageUp);




208 
209         updateListViewItems();
210 
211         // init the VirtualFlow
212         flow = getVirtualFlow();
213         flow.setId(&quot;virtual-flow&quot;);
214         flow.setPannable(IS_PANNABLE);
215         flow.setVertical(control.getOrientation() == Orientation.VERTICAL);
216         flow.setCellFactory(flow -&gt; createCell());
217         flow.setFixedCellSize(control.getFixedCellSize());
218         getChildren().add(flow);
219 
220         ml = event -&gt; {
221             // RT-15127: cancel editing on scroll. This is a bit extreme
222             // (we are cancelling editing on touching the scrollbars).
223             // This can be improved at a later date.
224             if (control.getEditingIndex() &gt; -1) {
225                 control.edit(-1);
226             }
227 
</pre>
<hr />
<pre>
245         properties.remove(Properties.RECREATE);
246         properties.addListener(weakPropertiesMapListener);
247 
248         // Register listeners
249         registerChangeListener(control.itemsProperty(), o -&gt; updateListViewItems());
250         registerChangeListener(control.orientationProperty(), o -&gt;
251             flow.setVertical(control.getOrientation() == Orientation.VERTICAL)
252         );
253         registerChangeListener(control.cellFactoryProperty(), o -&gt; flow.recreateCells());
254         registerChangeListener(control.parentProperty(), o -&gt; {
255             if (control.getParent() != null &amp;&amp; control.isVisible()) {
256                 control.requestLayout();
257             }
258         });
259         registerChangeListener(control.placeholderProperty(), o -&gt; updatePlaceholderRegionVisibility());
260         registerChangeListener(control.fixedCellSizeProperty(), o -&gt;
261             flow.setFixedCellSize(control.getFixedCellSize())
262         );
263     }
264 
<span class="line-removed">265 </span>
<span class="line-removed">266 </span>
267     /***************************************************************************
268      *                                                                         *
269      * Public API                                                              *
270      *                                                                         *
271      **************************************************************************/
272 
273     /** {@inheritDoc} */
274     @Override public void dispose() {
275         if (getSkinnable() == null) return;
276         // listener cleanup fixes side-effects (NPE on refresh, setItems, modifyItems)
277         getSkinnable().getProperties().removeListener(weakPropertiesMapListener);
278         getSkinnable().itemsProperty().removeListener(weakItemsChangeListener);
279         if (listViewItems != null) {
280             listViewItems.removeListener(weakListViewItemsListener);
281             listViewItems = null;
282         }
283         // flow related cleanup
284         // leaking without nulling factory
285         flow.setCellFactory(null);
286         // for completeness - but no effect with/out?
</pre>
</td>
<td>
<hr />
<pre>
188      * well as the necessary input mappings for handling key, mouse, etc events.
189      *
190      * @param control The control that this skin should be installed onto.
191      */
192     public ListViewSkin(final ListView&lt;T&gt; control) {
193         super(control);
194 
195         // install default input map for the ListView control
196         behavior = new ListViewBehavior&lt;&gt;(control);
197 //        control.setInputMap(behavior.getInputMap());
198 
199         // init the behavior &#39;closures&#39;
200         behavior.setOnFocusPreviousRow(() -&gt; onFocusPreviousCell());
201         behavior.setOnFocusNextRow(() -&gt; onFocusNextCell());
202         behavior.setOnMoveToFirstCell(() -&gt; onMoveToFirstCell());
203         behavior.setOnMoveToLastCell(() -&gt; onMoveToLastCell());
204         behavior.setOnSelectPreviousRow(() -&gt; onSelectPreviousCell());
205         behavior.setOnSelectNextRow(() -&gt; onSelectNextCell());
206         behavior.setOnScrollPageDown(this::onScrollPageDown);
207         behavior.setOnScrollPageUp(this::onScrollPageUp);
<span class="line-added">208         Boolean isRemoveKeyMappings = (Boolean) control.getProperties().get(&quot;removeKeyMappingsForComboBoxEditor&quot;);</span>
<span class="line-added">209         if (isRemoveKeyMappings != null &amp;&amp; isRemoveKeyMappings) {</span>
<span class="line-added">210             behavior.removeKeyMappingsForComboBoxEditor();</span>
<span class="line-added">211         }</span>
212 
213         updateListViewItems();
214 
215         // init the VirtualFlow
216         flow = getVirtualFlow();
217         flow.setId(&quot;virtual-flow&quot;);
218         flow.setPannable(IS_PANNABLE);
219         flow.setVertical(control.getOrientation() == Orientation.VERTICAL);
220         flow.setCellFactory(flow -&gt; createCell());
221         flow.setFixedCellSize(control.getFixedCellSize());
222         getChildren().add(flow);
223 
224         ml = event -&gt; {
225             // RT-15127: cancel editing on scroll. This is a bit extreme
226             // (we are cancelling editing on touching the scrollbars).
227             // This can be improved at a later date.
228             if (control.getEditingIndex() &gt; -1) {
229                 control.edit(-1);
230             }
231 
</pre>
<hr />
<pre>
249         properties.remove(Properties.RECREATE);
250         properties.addListener(weakPropertiesMapListener);
251 
252         // Register listeners
253         registerChangeListener(control.itemsProperty(), o -&gt; updateListViewItems());
254         registerChangeListener(control.orientationProperty(), o -&gt;
255             flow.setVertical(control.getOrientation() == Orientation.VERTICAL)
256         );
257         registerChangeListener(control.cellFactoryProperty(), o -&gt; flow.recreateCells());
258         registerChangeListener(control.parentProperty(), o -&gt; {
259             if (control.getParent() != null &amp;&amp; control.isVisible()) {
260                 control.requestLayout();
261             }
262         });
263         registerChangeListener(control.placeholderProperty(), o -&gt; updatePlaceholderRegionVisibility());
264         registerChangeListener(control.fixedCellSizeProperty(), o -&gt;
265             flow.setFixedCellSize(control.getFixedCellSize())
266         );
267     }
268 


269     /***************************************************************************
270      *                                                                         *
271      * Public API                                                              *
272      *                                                                         *
273      **************************************************************************/
274 
275     /** {@inheritDoc} */
276     @Override public void dispose() {
277         if (getSkinnable() == null) return;
278         // listener cleanup fixes side-effects (NPE on refresh, setItems, modifyItems)
279         getSkinnable().getProperties().removeListener(weakPropertiesMapListener);
280         getSkinnable().itemsProperty().removeListener(weakItemsChangeListener);
281         if (listViewItems != null) {
282             listViewItems.removeListener(weakListViewItemsListener);
283             listViewItems = null;
284         }
285         // flow related cleanup
286         // leaking without nulling factory
287         flow.setCellFactory(null);
288         // for completeness - but no effect with/out?
</pre>
</td>
</tr>
</table>
<center><a href="ComboBoxListViewSkin.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../test/java/test/javafx/scene/control/ComboBoxTest.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>