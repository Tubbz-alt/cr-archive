<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.fxml/src/main/java/javafx/fxml/FXMLLoader.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../docs/javafx/fxml/doc-files/introduction_to_fxml.html.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../tests/system/src/testscriptapp2/java/mymod/myapp2/FXMLScriptDeployment2Compile_Fail_Compilation.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.fxml/src/main/java/javafx/fxml/FXMLLoader.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1570,13 ***</span>
                          StringBuilder sb = new StringBuilder();
                          final int bufSize = 4096;
                          char[] charBuffer = new char[bufSize];
                          int n;
                          do {
<span class="line-modified">!                           n = scriptReader.read(charBuffer,0,bufSize);</span>
<span class="line-modified">!                           if (n &gt; 0) {</span>
<span class="line-modified">!                               sb.append(new String(charBuffer,0,n));</span>
                            }
                          } while (n &gt; -1);
                          script = sb.toString();
                      } catch (IOException exception) {
                          throw constructLoadException(exception);
<span class="line-new-header">--- 1570,13 ---</span>
                          StringBuilder sb = new StringBuilder();
                          final int bufSize = 4096;
                          char[] charBuffer = new char[bufSize];
                          int n;
                          do {
<span class="line-modified">!                             n = scriptReader.read(charBuffer,0,bufSize);</span>
<span class="line-modified">!                             if (n &gt; 0) {</span>
<span class="line-modified">!                                 sb.append(new String(charBuffer,0,n));</span>
                            }
                          } while (n &gt; -1);
                          script = sb.toString();
                      } catch (IOException exception) {
                          throw constructLoadException(exception);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1589,22 ***</span>
                          if (engine instanceof Compilable &amp;&amp; compileScript) {
                              CompiledScript compiledScript = null;
                              try {
                                  compiledScript=((Compilable) engine).compile(script);
                              } catch (ScriptException compileExc) {
<span class="line-modified">!                                Logging.getJavaFXLogger().warning(filename+&quot;: compiling caused \&quot;&quot;+compileExc+&quot;\&quot;, falling back to evaluating script in uncompiled mode&quot;);</span>
                              }
                              if (compiledScript != null) {
<span class="line-modified">!                                compiledScript.eval();</span>
                              } else { // fallback to uncompiled mode
<span class="line-modified">!                                engine.eval(script);</span>
                              }
                          } else {
<span class="line-modified">!                            engine.eval(script);</span>
                          }
                      } catch (ScriptException exception) {
<span class="line-modified">!                         System.err.println(filename+&quot;: caused ScriptException&quot;);</span>
                          exception.printStackTrace();
                      }
                  }
                  catch (IOException exception) {
                    throw constructLoadException(exception);
<span class="line-new-header">--- 1589,23 ---</span>
                          if (engine instanceof Compilable &amp;&amp; compileScript) {
                              CompiledScript compiledScript = null;
                              try {
                                  compiledScript=((Compilable) engine).compile(script);
                              } catch (ScriptException compileExc) {
<span class="line-modified">!                                 Logging.getJavaFXLogger().warning(filename + &quot;: compiling caused \&quot;&quot; + compileExc +</span>
<span class="line-added">+                                     &quot;\&quot;, falling back to evaluating script in uncompiled mode&quot;);</span>
                              }
                              if (compiledScript != null) {
<span class="line-modified">!                                 compiledScript.eval();</span>
                              } else { // fallback to uncompiled mode
<span class="line-modified">!                                 engine.eval(script);</span>
                              }
                          } else {
<span class="line-modified">!                             engine.eval(script);</span>
                          }
                      } catch (ScriptException exception) {
<span class="line-modified">!                         System.err.println(filename + &quot;: caused ScriptException&quot;);</span>
                          exception.printStackTrace();
                      }
                  }
                  catch (IOException exception) {
                    throw constructLoadException(exception);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1628,22 ***</span>
                      if (scriptEngine instanceof Compilable &amp;&amp; compileScript) {
                          CompiledScript compiledScript = null;
                          try {
                              compiledScript=((Compilable) scriptEngine).compile(script);
                          } catch (ScriptException compileExc) {
<span class="line-modified">!                             Logging.getJavaFXLogger().warning(filename+&quot;: compiling caused \&quot;&quot;+compileExc+&quot;\&quot;, falling back to evaluating script in uncompiled mode&quot;);</span>
                          }
                          if (compiledScript != null) {
<span class="line-modified">!                            compiledScript.eval();</span>
                          } else { // fallback to uncompiled mode
<span class="line-modified">!                            scriptEngine.eval(script);</span>
                          }
                      } else {
<span class="line-modified">!                        scriptEngine.eval(script);</span>
                      }
                  } catch (ScriptException exception) {
<span class="line-modified">!                     System.err.println(filename+&quot;: caused ScriptException\n&quot;+exception.getMessage());</span>
                  }
              }
          }
  
          @Override
<span class="line-new-header">--- 1629,23 ---</span>
                      if (scriptEngine instanceof Compilable &amp;&amp; compileScript) {
                          CompiledScript compiledScript = null;
                          try {
                              compiledScript=((Compilable) scriptEngine).compile(script);
                          } catch (ScriptException compileExc) {
<span class="line-modified">!                             Logging.getJavaFXLogger().warning(filename + &quot;: compiling caused \&quot;&quot; + compileExc +</span>
<span class="line-added">+                                 &quot;\&quot;, falling back to evaluating script in uncompiled mode&quot;);</span>
                          }
                          if (compiledScript != null) {
<span class="line-modified">!                             compiledScript.eval();</span>
                          } else { // fallback to uncompiled mode
<span class="line-modified">!                             scriptEngine.eval(script);</span>
                          }
                      } else {
<span class="line-modified">!                         scriptEngine.eval(script);</span>
                      }
                  } catch (ScriptException exception) {
<span class="line-modified">!                     System.err.println(filename + &quot;: caused ScriptException\n&quot; + exception.getMessage());</span>
                  }
              }
          }
  
          @Override
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1739,18 ***</span>
          public ScriptEventHandler(String script, ScriptEngine scriptEngine, String filename) {
              this.script = script;
              this.scriptEngine = scriptEngine;
              this.filename = filename;
              if (scriptEngine instanceof Compilable  &amp;&amp; compileScript) {
<span class="line-modified">!                try {</span>
<span class="line-modified">!                   // supply the filename to the scriptEngine engine scope Bindings in case it is needed for compilation</span>
<span class="line-modified">!                   scriptEngine.getBindings(ScriptContext.ENGINE_SCOPE).put(scriptEngine.FILENAME, filename);</span>
<span class="line-modified">!                   this.compiledScript = ((Compilable) scriptEngine).compile(script);</span>
<span class="line-modified">!                   this.isCompiled = true;</span>
<span class="line-modified">!                } catch (ScriptException compileExc){</span>
<span class="line-modified">!                     Logging.getJavaFXLogger().warning(filename+&quot;: compiling caused \&quot;&quot;+compileExc+&quot;\&quot;, falling back to evaluating script in uncompiled mode&quot;);</span>
<span class="line-modified">!                }</span>
              }
          }
  
          @Override
          public void handle(Event event) {
<span class="line-new-header">--- 1741,19 ---</span>
          public ScriptEventHandler(String script, ScriptEngine scriptEngine, String filename) {
              this.script = script;
              this.scriptEngine = scriptEngine;
              this.filename = filename;
              if (scriptEngine instanceof Compilable  &amp;&amp; compileScript) {
<span class="line-modified">!                 try {</span>
<span class="line-modified">!                     // supply the filename to the scriptEngine engine scope Bindings in case it is needed for compilation</span>
<span class="line-modified">!                     scriptEngine.getBindings(ScriptContext.ENGINE_SCOPE).put(scriptEngine.FILENAME, filename);</span>
<span class="line-modified">!                     this.compiledScript = ((Compilable) scriptEngine).compile(script);</span>
<span class="line-modified">!                     this.isCompiled = true;</span>
<span class="line-modified">!                 } catch (ScriptException compileExc) {</span>
<span class="line-modified">!                     Logging.getJavaFXLogger().warning(filename + &quot;: compiling caused \&quot;&quot; + compileExc +</span>
<span class="line-modified">!                         &quot;\&quot;, falling back to evaluating script in uncompiled mode&quot;);</span>
<span class="line-added">+                 }</span>
              }
          }
  
          @Override
          public void handle(Event event) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1766,12 ***</span>
                  if (isCompiled) {
                     compiledScript.eval(localBindings);
                  } else {
                     scriptEngine.eval(script, localBindings);
                  }
<span class="line-modified">!             } catch (ScriptException exception){</span>
<span class="line-modified">!                 throw new RuntimeException(filename+&quot;: caused ScriptException&quot;, exception);</span>
              }
          }
      }
  
      // Observable list change listener
<span class="line-new-header">--- 1769,12 ---</span>
                  if (isCompiled) {
                     compiledScript.eval(localBindings);
                  } else {
                     scriptEngine.eval(script, localBindings);
                  }
<span class="line-modified">!             } catch (ScriptException exception) {</span>
<span class="line-modified">!                 throw new RuntimeException(filename + &quot;: caused ScriptException&quot;, exception);</span>
              }
          }
      }
  
      // Observable list change listener
</pre>
<hr />
<pre>
<span class="line-old-header">*** 3632,7 ***</span>
                      return PACKAGE;
              }
          }
      }
  }
<span class="line-removed">- </span>
<span class="line-removed">- </span>
<span class="line-new-header">--- 3635,5 ---</span>
</pre>
<center><a href="../../../docs/javafx/fxml/doc-files/introduction_to_fxml.html.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../tests/system/src/testscriptapp2/java/mymod/myapp2/FXMLScriptDeployment2Compile_Fail_Compilation.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>