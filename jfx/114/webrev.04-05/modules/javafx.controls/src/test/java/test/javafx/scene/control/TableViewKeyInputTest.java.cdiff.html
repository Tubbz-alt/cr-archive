<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.controls/src/test/java/test/javafx/scene/control/TableViewKeyInputTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="TableViewHorizontalArrowsTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>modules/javafx.controls/src/test/java/test/javafx/scene/control/TableViewKeyInputTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2011, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2011, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-old-header">*** 33,12 ***</span>
  import javafx.scene.Group;
  import javafx.scene.control.Button;
  import javafx.scene.input.KeyCode;
  import javafx.scene.layout.HBox;
  
<span class="line-removed">- import java.util.Arrays;</span>
<span class="line-removed">- import java.util.Collection;</span>
  import java.util.List;
  import java.util.function.Function;
  
  import com.sun.javafx.PlatformUtil;
  import com.sun.javafx.util.Utils;
<span class="line-new-header">--- 33,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 57,35 ***</span>
  import javafx.scene.control.TableColumn;
  import javafx.scene.control.TableFocusModel;
  import javafx.scene.control.TablePosition;
  import javafx.scene.control.TableSelectionModel;
  import javafx.scene.control.TableView;
<span class="line-removed">- import javafx.geometry.NodeOrientation;</span>
  import org.junit.After;
  import org.junit.Before;
  import org.junit.Ignore;
  import org.junit.Test;
<span class="line-removed">- import org.junit.runner.RunWith;</span>
<span class="line-removed">- import org.junit.runners.Parameterized;</span>
<span class="line-removed">- </span>
  import static org.junit.Assert.assertEquals;
  import static org.junit.Assert.assertFalse;
  import static org.junit.Assert.assertNotSame;
  import static org.junit.Assert.assertNull;
  import static org.junit.Assert.assertTrue;
<span class="line-removed">- </span>
  import static org.junit.Assert.fail;
  
<span class="line-removed">- @RunWith(Parameterized.class)</span>
  public class TableViewKeyInputTest {
<span class="line-removed">-     @Parameterized.Parameters public static Collection implementations() {</span>
<span class="line-removed">-         return Arrays.asList(new Object[][]{</span>
<span class="line-removed">-                 {NodeOrientation.LEFT_TO_RIGHT},</span>
<span class="line-removed">-                 {NodeOrientation.RIGHT_TO_LEFT}</span>
<span class="line-removed">-         });</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      private TableView&lt;String&gt; tableView;
  //    private TableSelectionModel&lt;String&gt; sm;
      private TableView.TableViewSelectionModel&lt;String&gt; sm;
      private TableView.TableViewFocusModel&lt;String&gt; fm;
  
<span class="line-new-header">--- 55,22 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 97,19 ***</span>
      private TableColumn&lt;String, String&gt; col1;
      private TableColumn&lt;String, String&gt; col2;
      private TableColumn&lt;String, String&gt; col3;
      private TableColumn&lt;String, String&gt; col4;
  
<span class="line-removed">-     private NodeOrientation orientation;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     public TableViewKeyInputTest(NodeOrientation val) {</span>
<span class="line-removed">-         orientation = val;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      @Before public void setup() {
          tableView = new TableView&lt;String&gt;();
<span class="line-removed">-         tableView.setNodeOrientation(orientation);</span>
          sm = tableView.getSelectionModel();
          fm = tableView.getFocusModel();
  
          sm.setSelectionMode(SelectionMode.MULTIPLE);
          sm.setCellSelectionEnabled(false);
<span class="line-new-header">--- 82,12 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1129,32 ***</span>
      // Test 1
      @Test public void test_rt18591_cell_1() {
          sm.setSelectionMode(SelectionMode.MULTIPLE);
          sm.setCellSelectionEnabled(true);
          sm.select(0, col0);
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         }</span>
          keyboard.doKeyPress(KeyCode.SPACE,
                  KeyModifier.getShortcutKey(),
                  (Utils.isMac()  ? KeyModifier.CTRL : null));
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(isAnchor(0,2));
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         }</span>
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(sm.isSelected(0,col3));
          assertTrue(sm.isSelected(0,col4));
          assertTrue(isAnchor(0,2));
<span class="line-new-header">--- 1107,21 ---</span>
      // Test 1
      @Test public void test_rt18591_cell_1() {
          sm.setSelectionMode(SelectionMode.MULTIPLE);
          sm.setCellSelectionEnabled(true);
          sm.select(0, col0);
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
          keyboard.doKeyPress(KeyCode.SPACE,
                  KeyModifier.getShortcutKey(),
                  (Utils.isMac()  ? KeyModifier.CTRL : null));
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(isAnchor(0,2));
  
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(sm.isSelected(0,col3));
          assertTrue(sm.isSelected(0,col4));
          assertTrue(isAnchor(0,2));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1163,31 ***</span>
      // Test 2
      @Test public void test_rt18591_cell_2() {
          sm.setSelectionMode(SelectionMode.MULTIPLE);
          sm.setCellSelectionEnabled(true);
          sm.select(0, col4);
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         }</span>
          keyboard.doKeyPress(KeyCode.SPACE,
                  KeyModifier.getShortcutKey(),
                  (Utils.isMac()  ? KeyModifier.CTRL : null));
          assertTrue(sm.isSelected(0,col4));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(isAnchor(0,2));
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         }</span>
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col1));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(sm.isSelected(0,col4));
          assertTrue(isAnchor(0,2));
<span class="line-new-header">--- 1130,21 ---</span>
      // Test 2
      @Test public void test_rt18591_cell_2() {
          sm.setSelectionMode(SelectionMode.MULTIPLE);
          sm.setCellSelectionEnabled(true);
          sm.select(0, col4);
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
          keyboard.doKeyPress(KeyCode.SPACE,
                  KeyModifier.getShortcutKey(),
                  (Utils.isMac()  ? KeyModifier.CTRL : null));
          assertTrue(sm.isSelected(0,col4));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(isAnchor(0,2));
  
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col1));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(sm.isSelected(0,col4));
          assertTrue(isAnchor(0,2));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1196,46 ***</span>
      // Test 3
      @Test public void test_rt18591_cell_3() {
          sm.setSelectionMode(SelectionMode.MULTIPLE);
          sm.setCellSelectionEnabled(true);
          sm.select(0, col0);
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         }</span>
          keyboard.doKeyPress(KeyCode.SPACE,
                  KeyModifier.getShortcutKey(),
                  (Utils.isMac()  ? KeyModifier.CTRL : null));
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(isAnchor(0,2));
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         }</span>
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(sm.isSelected(0,col3));
          assertTrue(sm.isSelected(0,col4));
          assertTrue(isAnchor(0,2));
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-modified">!             keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         }</span>
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col1));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(sm.isSelected(0,col3));
          assertTrue(sm.isSelected(0,col4));
<span class="line-new-header">--- 1153,30 ---</span>
      // Test 3
      @Test public void test_rt18591_cell_3() {
          sm.setSelectionMode(SelectionMode.MULTIPLE);
          sm.setCellSelectionEnabled(true);
          sm.select(0, col0);
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
          keyboard.doKeyPress(KeyCode.SPACE,
                  KeyModifier.getShortcutKey(),
                  (Utils.isMac()  ? KeyModifier.CTRL : null));
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(isAnchor(0,2));
  
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(sm.isSelected(0,col3));
          assertTrue(sm.isSelected(0,col4));
          assertTrue(isAnchor(0,2));
  
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col1));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(sm.isSelected(0,col3));
          assertTrue(sm.isSelected(0,col4));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1245,47 ***</span>
      // Test 4
      @Test public void test_rt18591_cell_4() {
          sm.setSelectionMode(SelectionMode.MULTIPLE);
          sm.setCellSelectionEnabled(true);
          sm.select(0, col4);
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         }</span>
          keyboard.doKeyPress(KeyCode.SPACE,
                  KeyModifier.getShortcutKey(),
                  (Utils.isMac()  ? KeyModifier.CTRL : null));
          assertTrue(sm.isSelected(0,col4));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(isAnchor(0,2));
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         }</span>
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col1));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(sm.isSelected(0,col4));
          assertTrue(isAnchor(0,2));
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-modified">!             keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-removed">-         }</span>
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col1));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(sm.isSelected(0,col3));
          assertTrue(sm.isSelected(0,col4));
<span class="line-new-header">--- 1186,30 ---</span>
      // Test 4
      @Test public void test_rt18591_cell_4() {
          sm.setSelectionMode(SelectionMode.MULTIPLE);
          sm.setCellSelectionEnabled(true);
          sm.select(0, col4);
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
          keyboard.doKeyPress(KeyCode.SPACE,
                  KeyModifier.getShortcutKey(),
                  (Utils.isMac()  ? KeyModifier.CTRL : null));
          assertTrue(sm.isSelected(0,col4));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(isAnchor(0,2));
  
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col1));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(sm.isSelected(0,col4));
          assertTrue(isAnchor(0,2));
  
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.SHIFT, KeyModifier.getShortcutKey());</span>
          assertTrue(sm.isSelected(0,col0));
          assertTrue(sm.isSelected(0,col1));
          assertTrue(sm.isSelected(0,col2));
          assertTrue(sm.isSelected(0,col3));
          assertTrue(sm.isSelected(0,col4));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1557,77 ***</span>
  
          keyboard.doLeftArrowPress(KeyModifier.SHIFT);   // select (1, col4)
          keyboard.doLeftArrowPress(KeyModifier.SHIFT);   // select (1, col3)
          keyboard.doLeftArrowPress(KeyModifier.SHIFT);   // select (1, col2)
          keyboard.doLeftArrowPress(KeyModifier.SHIFT);   // select (1, col1)
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col3));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col4));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col3));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col0));</span>
<span class="line-removed">-         }</span>
  
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // deselect (1, col1)
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col3));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertTrue(debug(), sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col0));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col4));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col3));</span>
<span class="line-removed">-         }</span>
      }
  
      @Test public void test_rt18488_selectToRight() {
          sm.setCellSelectionEnabled(true);
          sm.clearAndSelect(1, col0);
  
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // select (1, col2)
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // select (1, col3)
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // select (1, col4)
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // select (1, col5)
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col3));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col4));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col3));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-         }</span>
  
          keyboard.doLeftArrowPress(KeyModifier.SHIFT);   // deselect (1, col5)
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             assertFalse(sm.isSelected(1, col4));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col3));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col4));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col3));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-         }</span>
      }
  
      @Test public void test_rt18488_comment1() {
          sm.setCellSelectionEnabled(true);
          sm.clearAndSelect(1, col0);
<span class="line-new-header">--- 1481,44 ---</span>
  
          keyboard.doLeftArrowPress(KeyModifier.SHIFT);   // select (1, col4)
          keyboard.doLeftArrowPress(KeyModifier.SHIFT);   // select (1, col3)
          keyboard.doLeftArrowPress(KeyModifier.SHIFT);   // select (1, col2)
          keyboard.doLeftArrowPress(KeyModifier.SHIFT);   // select (1, col1)
<span class="line-modified">!         assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col3));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col2));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col0));</span>
  
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // deselect (1, col1)
<span class="line-modified">!         assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col3));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col2));</span>
<span class="line-modified">!         assertTrue(debug(), sm.isSelected(1, col1));</span>
<span class="line-modified">!         assertFalse(sm.isSelected(1, col0));</span>
      }
  
      @Test public void test_rt18488_selectToRight() {
          sm.setCellSelectionEnabled(true);
          sm.clearAndSelect(1, col0);
  
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // select (1, col2)
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // select (1, col3)
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // select (1, col4)
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // select (1, col5)
<span class="line-modified">!         assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col3));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col2));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col0));</span>
  
          keyboard.doLeftArrowPress(KeyModifier.SHIFT);   // deselect (1, col5)
<span class="line-modified">!         assertFalse(sm.isSelected(1, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col3));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col2));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col0));</span>
      }
  
      @Test public void test_rt18488_comment1() {
          sm.setCellSelectionEnabled(true);
          sm.clearAndSelect(1, col0);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1636,128 ***</span>
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // select (1, col3)
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // select (1, col4)
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // select (1, col5)
          keyboard.doDownArrowPress(KeyModifier.SHIFT);    // select (2, col5)
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             assertTrue(sm.isSelected(2, col4));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col3));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col2));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT)  {</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col4));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col3));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col0));</span>
<span class="line-removed">-         }</span>
  
          keyboard.doUpArrowPress(KeyModifier.SHIFT);     // deselect (2, col5)
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             assertFalse(sm.isSelected(2, col4));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col3));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT)  {</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col4));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col3));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(2, col0));</span>
<span class="line-removed">-         }</span>
      }
  
      @Test public void test_rt18536_positive_horizontal() {
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             // Test shift selection when focus is elsewhere (so as to select a range)</span>
<span class="line-modified">!             sm.setCellSelectionEnabled(true);</span>
<span class="line-modified">!             sm.clearAndSelect(1, col0);</span>
<span class="line-modified">! </span>
<span class="line-modified">!             // move focus by holding down ctrl button</span>
<span class="line-modified">!             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col2)</span>
<span class="line-modified">!             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col3)</span>
<span class="line-modified">!             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col4)</span>
<span class="line-modified">!             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col5)</span>
<span class="line-modified">!             assertTrue(fm.isFocused(1, col4));</span>
<span class="line-modified">! </span>
<span class="line-modified">!             // press shift + space to select all cells between (1, col1) and (1, col5)</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.SPACE, KeyModifier.SHIFT);</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!             assertTrue(debug(), sm.isSelected(1, col3));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col2));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             // Test shift selection when focus is elsewhere (so as to select a range)</span>
<span class="line-removed">-             sm.setCellSelectionEnabled(true);</span>
<span class="line-removed">-             sm.clearAndSelect(1, col4);</span>
<span class="line-removed">- </span>
<span class="line-removed">-             // move focus by holding down ctrl button</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col3)</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col2)</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col1)</span>
<span class="line-removed">-             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col0)</span>
<span class="line-removed">-             assertTrue(fm.isFocused(1, col0));</span>
<span class="line-removed">- </span>
<span class="line-removed">-             // press shift + space to select all cells between (1, col1) and (1, col5)</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.SPACE, KeyModifier.SHIFT);</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-             assertTrue(debug(), sm.isSelected(1, col3));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-         }</span>
      }
  
      @Test public void test_rt18536_negative_horizontal() {
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             // Test shift selection when focus is elsewhere (so as to select a range)</span>
<span class="line-modified">!             sm.setCellSelectionEnabled(true);</span>
<span class="line-modified">!             sm.clearAndSelect(1, col4);</span>
<span class="line-modified">! </span>
<span class="line-modified">!             // move focus by holding down ctrl button</span>
<span class="line-modified">!             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col4)</span>
<span class="line-modified">!             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col3)</span>
<span class="line-modified">!             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col2)</span>
<span class="line-modified">!             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col1)</span>
<span class="line-modified">!             assertTrue(fm.isFocused(1, col0));</span>
<span class="line-modified">! </span>
<span class="line-modified">!             // press shift + space to select all cells between (1, col1) and (1, col5)</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.SPACE, KeyModifier.SHIFT);</span>
<span class="line-removed">-             assertTrue(debug(), sm.isSelected(1, col4));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col3));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             // Test shift selection when focus is elsewhere (so as to select a range)</span>
<span class="line-removed">-             sm.setCellSelectionEnabled(true);</span>
<span class="line-removed">-             sm.clearAndSelect(1, col0);</span>
<span class="line-removed">- </span>
<span class="line-removed">-             // move focus by holding down ctrl button</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col1)</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col2)</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col3)</span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col4)</span>
<span class="line-removed">-             assertTrue(fm.isFocused(1, col4));</span>
<span class="line-removed">- </span>
<span class="line-removed">-             // press shift + space to select all cells between (1, col1) and (1, col5)</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.SPACE, KeyModifier.SHIFT);</span>
<span class="line-removed">-             assertTrue(debug(), sm.isSelected(1, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col3));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-         }</span>
      }
  
      //
      @Test public void test_rt18536_positive_vertical() {
          // Test shift selection when focus is elsewhere (so as to select a range)
<span class="line-new-header">--- 1527,66 ---</span>
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // select (1, col3)
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // select (1, col4)
          keyboard.doRightArrowPress(KeyModifier.SHIFT);   // select (1, col5)
          keyboard.doDownArrowPress(KeyModifier.SHIFT);    // select (2, col5)
  
<span class="line-modified">!         assertTrue(sm.isSelected(2, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col3));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col2));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col0));</span>
  
          keyboard.doUpArrowPress(KeyModifier.SHIFT);     // deselect (2, col5)
<span class="line-modified">!         assertFalse(sm.isSelected(2, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col3));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col2));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col0));</span>
      }
  
      @Test public void test_rt18536_positive_horizontal() {
<span class="line-modified">!         // Test shift selection when focus is elsewhere (so as to select a range)</span>
<span class="line-modified">!         sm.setCellSelectionEnabled(true);</span>
<span class="line-modified">!         sm.clearAndSelect(1, col0);</span>
<span class="line-modified">! </span>
<span class="line-modified">!         // move focus by holding down ctrl button</span>
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col2)</span>
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col3)</span>
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col4)</span>
<span class="line-modified">!         keyboard.doRightArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col5)</span>
<span class="line-modified">!         assertTrue(fm.isFocused(1, col4));</span>
<span class="line-modified">! </span>
<span class="line-modified">!         // press shift + space to select all cells between (1, col1) and (1, col5)</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.SPACE, KeyModifier.SHIFT);</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!         assertTrue(debug(), sm.isSelected(1, col3));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col2));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col0));</span>
      }
  
      @Test public void test_rt18536_negative_horizontal() {
<span class="line-added">+         // Test shift selection when focus is elsewhere (so as to select a range)</span>
<span class="line-added">+         sm.setCellSelectionEnabled(true);</span>
<span class="line-added">+         sm.clearAndSelect(1, col4);</span>
  
<span class="line-modified">!         // move focus by holding down ctrl button</span>
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col4)</span>
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col3)</span>
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col2)</span>
<span class="line-modified">!         keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());   // move focus to (1, col1)</span>
<span class="line-modified">!         assertTrue(fm.isFocused(1, col0));</span>
<span class="line-modified">! </span>
<span class="line-modified">!         // press shift + space to select all cells between (1, col1) and (1, col5)</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.SPACE, KeyModifier.SHIFT);</span>
<span class="line-modified">!         assertTrue(debug(), sm.isSelected(1, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col3));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col2));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col0));</span>
      }
  
      //
      @Test public void test_rt18536_positive_vertical() {
          // Test shift selection when focus is elsewhere (so as to select a range)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2801,48 ***</span>
              tableView.getItems().add(&quot;Row &quot; + i);
          }
  
          sm.setCellSelectionEnabled(true);
  
<span class="line-modified">!         sm.clearAndSelect(6, col1);</span>
          assertEquals(6, getAnchor().getRow());
<span class="line-modified">!         assertEquals(1, getAnchor().getColumn());</span>
<span class="line-modified">!         assertTrue(fm.isFocused(6, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(6, col1));</span>
  
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.getShortcutKey());
          Toolkit.getToolkit().firePulse();
          assertEquals(6, getAnchor().getRow());
<span class="line-modified">!         assertEquals(1, getAnchor().getColumn());</span>
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             assertTrue(fm.isFocused(3, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(6, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(3, col2));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             assertTrue(fm.isFocused(3, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(6, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(3, col0));</span>
<span class="line-removed">-         }</span>
  
          keyboard.doKeyPress(KeyCode.SPACE, KeyModifier.SHIFT);
          Toolkit.getToolkit().firePulse();
          assertEquals(6, getAnchor().getRow());
<span class="line-modified">!         assertEquals(1, getAnchor().getColumn());</span>
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             assertTrue(fm.isFocused(3, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(3, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(6, col1));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             assertTrue(fm.isFocused(3, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(3, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(6, col1));</span>
<span class="line-removed">-         }</span>
      }
  
      @Test public void test_rt33613_up_multipleColumn_left() {
          final int items = 10;
          tableView.getItems().clear();
<span class="line-new-header">--- 2630,34 ---</span>
              tableView.getItems().add(&quot;Row &quot; + i);
          }
  
          sm.setCellSelectionEnabled(true);
  
<span class="line-modified">!         sm.clearAndSelect(6, col0);</span>
          assertEquals(6, getAnchor().getRow());
<span class="line-modified">!         assertEquals(0, getAnchor().getColumn());</span>
<span class="line-modified">!         assertTrue(fm.isFocused(6, col0));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(6, col0));</span>
  
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.getShortcutKey());
          Toolkit.getToolkit().firePulse();
          assertEquals(6, getAnchor().getRow());
<span class="line-modified">!         assertEquals(0, getAnchor().getColumn());</span>
<span class="line-modified">!         assertTrue(fm.isFocused(3, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(6, col0));</span>
<span class="line-modified">!         assertFalse(sm.isSelected(3, col1));</span>
  
          keyboard.doKeyPress(KeyCode.SPACE, KeyModifier.SHIFT);
          Toolkit.getToolkit().firePulse();
          assertEquals(6, getAnchor().getRow());
<span class="line-modified">!         assertEquals(0, getAnchor().getColumn());</span>
<span class="line-modified">!         assertTrue(fm.isFocused(3, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(3, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(6, col0));</span>
      }
  
      @Test public void test_rt33613_up_multipleColumn_left() {
          final int items = 10;
          tableView.getItems().clear();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2863,35 ***</span>
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.getShortcutKey());
          Toolkit.getToolkit().firePulse();
          assertEquals(6, getAnchor().getRow());
          assertEquals(1, getAnchor().getColumn());
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             assertTrue(fm.isFocused(3, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(6, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(3, col0));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             assertTrue(fm.isFocused(3, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(6, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(3, col2));</span>
<span class="line-removed">-         }</span>
  
          keyboard.doKeyPress(KeyCode.SPACE, KeyModifier.SHIFT);
          Toolkit.getToolkit().firePulse();
          assertEquals(6, getAnchor().getRow());
          assertEquals(1, getAnchor().getColumn());
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             assertTrue(fm.isFocused(3, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(3, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(6, col1));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             assertTrue(fm.isFocused(3, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(3, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(6, col1));</span>
<span class="line-removed">-         }</span>
      }
  
      @Test public void test_rt33613_down_oneColumn() {
          final int items = 10;
          tableView.getItems().clear();
<span class="line-new-header">--- 2678,21 ---</span>
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.getShortcutKey());
          Toolkit.getToolkit().firePulse();
          assertEquals(6, getAnchor().getRow());
          assertEquals(1, getAnchor().getColumn());
<span class="line-modified">!         assertTrue(fm.isFocused(3, col0));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(6, col1));</span>
<span class="line-modified">!         assertFalse(sm.isSelected(3, col0));</span>
  
          keyboard.doKeyPress(KeyCode.SPACE, KeyModifier.SHIFT);
          Toolkit.getToolkit().firePulse();
          assertEquals(6, getAnchor().getRow());
          assertEquals(1, getAnchor().getColumn());
<span class="line-modified">!         assertTrue(fm.isFocused(3, col0));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(3, col0));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(6, col1));</span>
      }
  
      @Test public void test_rt33613_down_oneColumn() {
          final int items = 10;
          tableView.getItems().clear();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2931,48 ***</span>
              tableView.getItems().add(&quot;Row &quot; + i);
          }
  
          sm.setCellSelectionEnabled(true);
  
<span class="line-modified">!         sm.clearAndSelect(3, col1);</span>
          assertEquals(3, getAnchor().getRow());
<span class="line-modified">!         assertEquals(1, getAnchor().getColumn());</span>
<span class="line-modified">!         assertTrue(fm.isFocused(3, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(3, col1));</span>
  
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.getShortcutKey());
          Toolkit.getToolkit().firePulse();
          assertEquals(3, getAnchor().getRow());
<span class="line-modified">!         assertEquals(1, getAnchor().getColumn());</span>
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             assertTrue(fm.isFocused(6, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(3, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(6, col2));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             assertTrue(fm.isFocused(6, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(3, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(6, col0));</span>
<span class="line-removed">-         }</span>
  
          keyboard.doKeyPress(KeyCode.SPACE, KeyModifier.SHIFT);
          Toolkit.getToolkit().firePulse();
          assertEquals(3, getAnchor().getRow());
<span class="line-modified">!         assertEquals(1, getAnchor().getColumn());</span>
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             assertTrue(fm.isFocused(6, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(6, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(3, col1));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             assertTrue(fm.isFocused(6, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(6, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(3, col1));</span>
<span class="line-removed">-         }</span>
      }
  
      @Test public void test_rt33613_down_multipleColumn_left() {
          final int items = 10;
          tableView.getItems().clear();
<span class="line-new-header">--- 2732,34 ---</span>
              tableView.getItems().add(&quot;Row &quot; + i);
          }
  
          sm.setCellSelectionEnabled(true);
  
<span class="line-modified">!         sm.clearAndSelect(3, col0);</span>
          assertEquals(3, getAnchor().getRow());
<span class="line-modified">!         assertEquals(0, getAnchor().getColumn());</span>
<span class="line-modified">!         assertTrue(fm.isFocused(3, col0));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(3, col0));</span>
  
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.getShortcutKey());
          Toolkit.getToolkit().firePulse();
          assertEquals(3, getAnchor().getRow());
<span class="line-modified">!         assertEquals(0, getAnchor().getColumn());</span>
<span class="line-modified">!         assertTrue(fm.isFocused(6, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(3, col0));</span>
<span class="line-modified">!         assertFalse(sm.isSelected(6, col1));</span>
  
          keyboard.doKeyPress(KeyCode.SPACE, KeyModifier.SHIFT);
          Toolkit.getToolkit().firePulse();
          assertEquals(3, getAnchor().getRow());
<span class="line-modified">!         assertEquals(0, getAnchor().getColumn());</span>
<span class="line-modified">!         assertTrue(fm.isFocused(6, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(6, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(3, col0));</span>
      }
  
      @Test public void test_rt33613_down_multipleColumn_left() {
          final int items = 10;
          tableView.getItems().clear();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2992,179 ***</span>
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.getShortcutKey());
          assertEquals(3, getAnchor().getRow());
          assertEquals(1, getAnchor().getColumn());
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             assertTrue(fm.isFocused(6, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(3, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(6, col0));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             assertTrue(fm.isFocused(6, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(3, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(6, col2));</span>
<span class="line-removed">-         }</span>
  
          keyboard.doKeyPress(KeyCode.SPACE, KeyModifier.SHIFT);
          assertEquals(3, getAnchor().getRow());
          assertEquals(1, getAnchor().getColumn());
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             assertTrue(fm.isFocused(6, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(6, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(3, col1));</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             assertTrue(fm.isFocused(6, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(6, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(3, col1));</span>
<span class="line-removed">-         }</span>
      }
  
      @Test public void test_rt18439() {
<span class="line-removed">- </span>
          final int items = 10;
          tableView.getItems().clear();
          for (int i = 0; i &lt; items; i++) {
              tableView.getItems().add(&quot;Row &quot; + i);
          }
  
          sm.setCellSelectionEnabled(true);
          sm.setSelectionMode(SelectionMode.MULTIPLE);
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-removed">-             sm.clearAndSelect(0, col0);</span>
  
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 1</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 3</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 4</span>
<span class="line-modified">!             assertEquals(0, getAnchor().getRow());</span>
<span class="line-modified">!             assertEquals(0, getAnchor().getColumn());              // anchor does not move</span>
<span class="line-modified">!             assertTrue(fm.isFocused(0, col4));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col0));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col1));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col2));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col3));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col4));</span>
<span class="line-removed">- </span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 1</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 2</span>
<span class="line-removed">-             assertEquals(0, getAnchor().getRow());</span>
<span class="line-removed">-             assertEquals(0, getAnchor().getColumn());             // anchor does not move</span>
<span class="line-removed">-             assertTrue(fm.isFocused(2, col4));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col3));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col4));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col4));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col4));</span>
<span class="line-removed">- </span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 3</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 2</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 1</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 0</span>
<span class="line-removed">-             assertEquals(0, getAnchor().getRow());</span>
<span class="line-removed">-             assertEquals(0, getAnchor().getColumn());             // anchor does not move</span>
<span class="line-removed">-             assertTrue(fm.isFocused(2, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col3));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col4));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col4));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col4));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col3));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col0));</span>
<span class="line-removed">- </span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 1</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 0</span>
<span class="line-removed">-             assertEquals(0, getAnchor().getRow());</span>
<span class="line-removed">-             assertEquals(0, getAnchor().getColumn());           // anchor does not move</span>
<span class="line-removed">-             assertTrue(fm.isFocused(0, col0));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(0, col0));                // we&#39;ve gone right around - this cell is now unselected</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col3));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col4));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col4));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col4));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col3));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             sm.clearAndSelect(0, col4);</span>
  
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 3</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 1</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 0</span>
<span class="line-modified">!             assertEquals(0, getAnchor().getRow());</span>
<span class="line-modified">!             assertEquals(4, getAnchor().getColumn());              // anchor does not move</span>
<span class="line-modified">!             assertTrue(fm.isFocused(0, col0));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col4));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col3));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col2));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col1));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col0));</span>
<span class="line-modified">! </span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 1</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 2</span>
<span class="line-modified">!             assertEquals(0, getAnchor().getRow());</span>
<span class="line-modified">!             assertEquals(4, getAnchor().getColumn());             // anchor does not move</span>
<span class="line-modified">!             assertTrue(fm.isFocused(2, col0));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col4));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col3));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col2));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col1));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col0));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(2, col0));</span>
<span class="line-modified">! </span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 0</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 1</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 3</span>
<span class="line-modified">!             assertEquals(0, getAnchor().getRow());</span>
<span class="line-modified">!             assertEquals(4, getAnchor().getColumn());             // anchor does not move</span>
<span class="line-modified">!             assertTrue(fm.isFocused(2, col4));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col0));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col1));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col2));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col3));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(0, col4));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(2, col4));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(2, col3));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(2, col2));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(2, col1));</span>
<span class="line-modified">!             assertTrue(sm.isSelected(2, col0));</span>
<span class="line-modified">! </span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 0</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 1</span>
<span class="line-modified">!             assertEquals(0, getAnchor().getRow());</span>
<span class="line-modified">!             assertEquals(4, getAnchor().getColumn());           // anchor does not move</span>
<span class="line-removed">-             assertTrue(fm.isFocused(0, col4));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(0, col4));                // we&#39;ve gone right around - this cell is now unselected</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col3));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(0, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col4));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col4));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col3));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col1));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(2, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-         }</span>
      }
  
      // this is an extension of the previous test, where we had a bug where going up resulted in all cells between the
      // anchor (at (0,0)) and the first selected cell in column 0 were being selected. This wasn&#39;t visible in the previous
      // test as we only went down two rows, so when we went up everything looked as expected
<span class="line-new-header">--- 2779,96 ---</span>
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.getShortcutKey());
          keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.getShortcutKey());
          assertEquals(3, getAnchor().getRow());
          assertEquals(1, getAnchor().getColumn());
<span class="line-modified">!         assertTrue(fm.isFocused(6, col0));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(3, col1));</span>
<span class="line-modified">!         assertFalse(sm.isSelected(6, col0));</span>
  
          keyboard.doKeyPress(KeyCode.SPACE, KeyModifier.SHIFT);
          assertEquals(3, getAnchor().getRow());
          assertEquals(1, getAnchor().getColumn());
<span class="line-modified">!         assertTrue(fm.isFocused(6, col0));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(6, col0));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(3, col1));</span>
      }
  
      @Test public void test_rt18439() {
          final int items = 10;
          tableView.getItems().clear();
          for (int i = 0; i &lt; items; i++) {
              tableView.getItems().add(&quot;Row &quot; + i);
          }
  
          sm.setCellSelectionEnabled(true);
          sm.setSelectionMode(SelectionMode.MULTIPLE);
  
<span class="line-modified">!         sm.clearAndSelect(0, col0);</span>
  
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 1</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 3</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 4</span>
<span class="line-modified">!         assertEquals(0, getAnchor().getRow());</span>
<span class="line-modified">!         assertEquals(0, getAnchor().getColumn());              // anchor does not move</span>
<span class="line-modified">!         assertTrue(fm.isFocused(0, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col0));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col2));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col3));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col4));</span>
  
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 1</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 2</span>
<span class="line-modified">!         assertEquals(0, getAnchor().getRow());</span>
<span class="line-modified">!         assertEquals(0, getAnchor().getColumn());             // anchor does not move</span>
<span class="line-modified">!         assertTrue(fm.isFocused(2, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col0));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col2));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col3));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(2, col4));</span>
<span class="line-modified">! </span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 3</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 1</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 0</span>
<span class="line-modified">!         assertEquals(0, getAnchor().getRow());</span>
<span class="line-modified">!         assertEquals(0, getAnchor().getColumn());             // anchor does not move</span>
<span class="line-modified">!         assertTrue(fm.isFocused(2, col0));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col0));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col2));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col3));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(2, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(2, col3));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(2, col2));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(2, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(2, col0));</span>
<span class="line-modified">! </span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 1</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 0</span>
<span class="line-modified">!         assertEquals(0, getAnchor().getRow());</span>
<span class="line-modified">!         assertEquals(0, getAnchor().getColumn());           // anchor does not move</span>
<span class="line-modified">!         assertTrue(fm.isFocused(0, col0));</span>
<span class="line-modified">!         assertFalse(sm.isSelected(0, col0));                // we&#39;ve gone right around - this cell is now unselected</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col2));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col3));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(0, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(2, col4));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(2, col3));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(2, col2));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(2, col1));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(2, col0));</span>
<span class="line-modified">!         assertTrue(sm.isSelected(1, col0));</span>
      }
  
      // this is an extension of the previous test, where we had a bug where going up resulted in all cells between the
      // anchor (at (0,0)) and the first selected cell in column 0 were being selected. This wasn&#39;t visible in the previous
      // test as we only went down two rows, so when we went up everything looked as expected
</pre>
<hr />
<pre>
<span class="line-old-header">*** 3178,38 ***</span>
          sm.setCellSelectionEnabled(true);
          sm.setSelectionMode(SelectionMode.MULTIPLE);
  
          sm.clearAndSelect(0, col0);
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 1</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 3</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 4</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 1</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 2</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 3</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 4</span>
<span class="line-removed">-         }</span>
  
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 1
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 2
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 3
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 4
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 3</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 1</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 0</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 1</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 2</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 3</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 4</span>
<span class="line-removed">-         }</span>
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 3
          assertEquals(0, getAnchor().getRow());
          assertEquals(0, getAnchor().getColumn());           // anchor does not move
          assertTrue(fm.isFocused(3, col0));
          assertTrue(sm.isSelected(0, col0));
<span class="line-new-header">--- 2882,25 ---</span>
          sm.setCellSelectionEnabled(true);
          sm.setSelectionMode(SelectionMode.MULTIPLE);
  
          sm.clearAndSelect(0, col0);
  
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 1</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 3</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 4</span>
  
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 1
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 2
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 3
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 4
  
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 3</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 1</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 0</span>
<span class="line-modified">! </span>
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 3
          assertEquals(0, getAnchor().getRow());
          assertEquals(0, getAnchor().getColumn());           // anchor does not move
          assertTrue(fm.isFocused(3, col0));
          assertTrue(sm.isSelected(0, col0));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 3247,32 ***</span>
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 1
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 2
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 3
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 4
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 3</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 1</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 0</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 3</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 2</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 1</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 0</span>
<span class="line-removed">-         }</span>
  
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 3
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 2
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 1
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 0
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 1</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 1</span>
<span class="line-removed">-         }</span>
          assertEquals(0, getAnchor().getRow());
          assertEquals(4, getAnchor().getColumn());           // anchor does not move
          assertTrue(fm.isFocused(0, col1));
          assertTrue(sm.isSelected(0, col4));
          assertTrue(sm.isSelected(1, col4));
<span class="line-new-header">--- 2938,21 ---</span>
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 1
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 2
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 3
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 4
  
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 3</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 1</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 0</span>
  
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 3
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 2
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 1
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 0
  
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 1</span>
          assertEquals(0, getAnchor().getRow());
          assertEquals(4, getAnchor().getColumn());           // anchor does not move
          assertTrue(fm.isFocused(0, col1));
          assertTrue(sm.isSelected(0, col4));
          assertTrue(sm.isSelected(1, col4));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 3304,38 ***</span>
          sm.setCellSelectionEnabled(true);
          sm.setSelectionMode(SelectionMode.MULTIPLE);
  
          sm.clearAndSelect(4, col4);
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 3</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 1</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 0</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 3</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 2</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 1</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 0</span>
<span class="line-removed">-         }</span>
  
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 3
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 2
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 1
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 0
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 1</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 3</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 4</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 1</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 2</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 3</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 4</span>
<span class="line-removed">-         }</span>
  
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 1
          assertEquals(4, getAnchor().getRow());
          assertEquals(4, getAnchor().getColumn());           // anchor does not move
          assertTrue(fm.isFocused(1, col4));
<span class="line-new-header">--- 2984,24 ---</span>
          sm.setCellSelectionEnabled(true);
          sm.setSelectionMode(SelectionMode.MULTIPLE);
  
          sm.clearAndSelect(4, col4);
  
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 3</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 1</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 0</span>
  
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 3
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 2
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 1
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT);   // row 0
  
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 1</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 2</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 3</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 4</span>
  
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 1
          assertEquals(4, getAnchor().getRow());
          assertEquals(4, getAnchor().getColumn());           // anchor does not move
          assertTrue(fm.isFocused(1, col4));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 3374,32 ***</span>
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 3
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 2
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 1
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 0
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT);   // col 1</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT);   // col 2</span>
<span class="line-modified">!             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT);   // col 3</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT);   // col 4</span>
<span class="line-removed">-         } if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT);   // col 1</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT);   // col 2</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT);   // col 3</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT);   // col 4</span>
<span class="line-removed">-         }</span>
  
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 1
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 2
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 3
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 4
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 3</span>
<span class="line-removed">-         } if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT); // col 3</span>
<span class="line-removed">-         }</span>
          assertEquals(4, getAnchor().getRow());
          assertEquals(0, getAnchor().getColumn());           // anchor does not move
          assertTrue(fm.isFocused(4, col3));
          assertTrue(sm.isSelected(4, col0));
          assertTrue(sm.isSelected(3, col0));
<span class="line-new-header">--- 3040,21 ---</span>
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 3
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 2
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 1
          keyboard.doKeyPress(KeyCode.UP, KeyModifier.SHIFT); // row 0
  
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT);   // col 1</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT);   // col 2</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT);   // col 3</span>
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.RIGHT, KeyModifier.SHIFT);   // col 4</span>
  
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 1
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 2
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 3
          keyboard.doKeyPress(KeyCode.DOWN, KeyModifier.SHIFT); // row 4
  
<span class="line-modified">!         keyboard.doKeyPress(KeyCode.LEFT, KeyModifier.SHIFT); // col 3</span>
          assertEquals(4, getAnchor().getRow());
          assertEquals(0, getAnchor().getColumn());           // anchor does not move
          assertTrue(fm.isFocused(4, col3));
          assertTrue(sm.isSelected(4, col0));
          assertTrue(sm.isSelected(3, col0));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 4361,63 ***</span>
  
          sl.dispose();
      }
  
      @Test public void test_rt_18440_goLeft() {
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             test_rt_18440(KeyCode.LEFT, 3, false, colIndex -&gt; {</span>
<span class="line-modified">!                 keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-modified">!                 return colIndex - 1;</span>
<span class="line-removed">-             });</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             test_rt_18440(KeyCode.LEFT, 0, false, colIndex -&gt; {</span>
<span class="line-removed">-                 keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-                 return colIndex + 1;</span>
<span class="line-removed">-             });</span>
<span class="line-removed">-         }</span>
      }
  
      @Test public void test_rt_18440_goLeft_toEnd() {
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             test_rt_18440(KeyCode.LEFT, 3, true, colIndex -&gt; {</span>
<span class="line-modified">!                 keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-modified">!                 return colIndex - 1;</span>
<span class="line-removed">-             });</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             test_rt_18440(KeyCode.LEFT, 0, true, colIndex -&gt; {</span>
<span class="line-removed">-                 keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-                 return colIndex + 1;</span>
<span class="line-removed">-             });</span>
<span class="line-removed">-         }</span>
      }
  
      @Test public void test_rt_18440_goRight() {
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             test_rt_18440(KeyCode.RIGHT, 0, false, colIndex -&gt; {</span>
<span class="line-modified">!                 keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-modified">!                 return colIndex + 1;</span>
<span class="line-removed">-             });</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             test_rt_18440(KeyCode.RIGHT, 3, false, colIndex -&gt; {</span>
<span class="line-removed">-                 keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-                 return colIndex - 1;</span>
<span class="line-removed">-             });</span>
<span class="line-removed">-         }</span>
      }
  
      @Test public void test_rt_18440_goRight_toEnd() {
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             test_rt_18440(KeyCode.RIGHT, 0, true, colIndex -&gt; {</span>
<span class="line-modified">!                 keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-modified">!                 return colIndex + 1;</span>
<span class="line-removed">-             });</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             test_rt_18440(KeyCode.RIGHT, 3, true, colIndex -&gt; {</span>
<span class="line-removed">-                 keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-removed">-                 return colIndex - 1;</span>
<span class="line-removed">-             });</span>
<span class="line-removed">-         }</span>
      }
  
      private void test_rt_18440(KeyCode direction, int startColumn, boolean goToEnd, Function&lt;Integer, Integer&gt; r) {
          ObservableList&lt;String&gt; itemsList = FXCollections.observableArrayList();
          for (int i = 0; i &lt; 10; i++) {
<span class="line-new-header">--- 4016,35 ---</span>
  
          sl.dispose();
      }
  
      @Test public void test_rt_18440_goLeft() {
<span class="line-modified">!         test_rt_18440(KeyCode.LEFT, 3, false, colIndex -&gt; {</span>
<span class="line-modified">!             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-modified">!             return colIndex - 1;</span>
<span class="line-modified">!         });</span>
      }
  
      @Test public void test_rt_18440_goLeft_toEnd() {
<span class="line-modified">!         test_rt_18440(KeyCode.LEFT, 3, true, colIndex -&gt; {</span>
<span class="line-modified">!             keyboard.doLeftArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-modified">!             return colIndex - 1;</span>
<span class="line-modified">!         });</span>
      }
  
      @Test public void test_rt_18440_goRight() {
<span class="line-modified">!         test_rt_18440(KeyCode.RIGHT, 0, false, colIndex -&gt; {</span>
<span class="line-modified">!             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-modified">!             return colIndex + 1;</span>
<span class="line-modified">!         });</span>
      }
  
      @Test public void test_rt_18440_goRight_toEnd() {
<span class="line-modified">!         test_rt_18440(KeyCode.RIGHT, 0, true, colIndex -&gt; {</span>
<span class="line-modified">!             keyboard.doRightArrowPress(KeyModifier.getShortcutKey());</span>
<span class="line-modified">!             return colIndex + 1;</span>
<span class="line-modified">!         });</span>
      }
  
      private void test_rt_18440(KeyCode direction, int startColumn, boolean goToEnd, Function&lt;Integer, Integer&gt; r) {
          ObservableList&lt;String&gt; itemsList = FXCollections.observableArrayList();
          for (int i = 0; i &lt; 10; i++) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 4470,25 ***</span>
              assertEquals(tableView.getColumns().get(startColumn), sm.getSelectedCells().get(0).getTableColumn());
              assertEquals(0, fm.getFocusedIndex());
              assertEquals(tableView.getColumns().get(expectedColumn), fm.getFocusedCell().getTableColumn());
          }
  
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             expectedColumn = direction == KeyCode.RIGHT ? 3 : 0;</span>
<span class="line-modified">!             keyboard.doKeyPress(direction, KeyModifier.SHIFT);</span>
<span class="line-modified">!             assertEquals(0, sm.getSelectedIndex());</span>
<span class="line-modified">!             assertEquals(debug(), 4, sm.getSelectedCells().size());</span>
<span class="line-modified">!             assertEquals(0, fm.getFocusedIndex());</span>
<span class="line-modified">!             assertEquals(tableView.getColumns().get(expectedColumn), fm.getFocusedCell().getTableColumn());</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             expectedColumn = direction == KeyCode.LEFT ? 3 : 0;</span>
<span class="line-removed">-             keyboard.doKeyPress(direction, KeyModifier.SHIFT);</span>
<span class="line-removed">-             assertEquals(0, sm.getSelectedIndex());</span>
<span class="line-removed">-             assertEquals(debug(), 4, sm.getSelectedCells().size());</span>
<span class="line-removed">-             assertEquals(0, fm.getFocusedIndex());</span>
<span class="line-removed">-             assertEquals(tableView.getColumns().get(expectedColumn), fm.getFocusedCell().getTableColumn());</span>
<span class="line-removed">-         }</span>
          sl.dispose();
      }
  
      @Test public void test_rt_24865_moveDownwards() {
          tableView.getItems().clear();
<span class="line-new-header">--- 4097,17 ---</span>
              assertEquals(tableView.getColumns().get(startColumn), sm.getSelectedCells().get(0).getTableColumn());
              assertEquals(0, fm.getFocusedIndex());
              assertEquals(tableView.getColumns().get(expectedColumn), fm.getFocusedCell().getTableColumn());
          }
  
<span class="line-modified">!         expectedColumn = direction == KeyCode.RIGHT ? 3 : 0;</span>
<span class="line-modified">!         keyboard.doKeyPress(direction, KeyModifier.SHIFT);</span>
<span class="line-modified">!         assertEquals(0, sm.getSelectedIndex());</span>
<span class="line-modified">!         assertEquals(debug(), 4, sm.getSelectedCells().size());</span>
<span class="line-modified">!         assertEquals(0, fm.getFocusedIndex());</span>
<span class="line-modified">!         assertEquals(tableView.getColumns().get(expectedColumn), fm.getFocusedCell().getTableColumn());</span>
<span class="line-modified">! </span>
          sl.dispose();
      }
  
      @Test public void test_rt_24865_moveDownwards() {
          tableView.getItems().clear();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 4597,37 ***</span>
          assertTrue(fm.isFocused(50 - newSelectedRowCount + 1));
          assertEquals(50, ((TablePosition)TableCellBehavior.getAnchor(tableView, null)).getRow());
      }
  
      @Test public void test_rt_39792_goLeft_goPastEnd() {
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             test_rt_39792(3, colIndex -&gt; {</span>
<span class="line-modified">!                 keyboard.doLeftArrowPress(KeyModifier.SHIFT);</span>
<span class="line-removed">-                 return colIndex - 1;</span>
<span class="line-removed">-             });</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             test_rt_39792(0, colIndex -&gt; {</span>
<span class="line-removed">-                 keyboard.doLeftArrowPress(KeyModifier.SHIFT);</span>
<span class="line-removed">-                 return colIndex + 1;</span>
<span class="line-removed">-             });</span>
<span class="line-removed">-         }</span>
      }
  
      @Test public void test_rt_39792_goRight_goPastEnd() {
<span class="line-modified">! </span>
<span class="line-modified">!         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-modified">!             test_rt_39792(0, colIndex -&gt; {</span>
<span class="line-modified">!                 keyboard.doRightArrowPress(KeyModifier.SHIFT);</span>
<span class="line-removed">-                 return colIndex + 1;</span>
<span class="line-removed">-             });</span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             test_rt_39792(3, colIndex -&gt; {</span>
<span class="line-removed">-                 keyboard.doRightArrowPress(KeyModifier.SHIFT);</span>
<span class="line-removed">-                 return colIndex - 1;</span>
<span class="line-removed">-             });</span>
<span class="line-removed">-         }</span>
      }
  
      private void test_rt_39792(int startColumn, Function&lt;Integer, Integer&gt; r) {
          ObservableList&lt;String&gt; itemsList = FXCollections.observableArrayList();
          for (int i = 0; i &lt; 10; i++) {
<span class="line-new-header">--- 4216,21 ---</span>
          assertTrue(fm.isFocused(50 - newSelectedRowCount + 1));
          assertEquals(50, ((TablePosition)TableCellBehavior.getAnchor(tableView, null)).getRow());
      }
  
      @Test public void test_rt_39792_goLeft_goPastEnd() {
<span class="line-modified">!         test_rt_39792(3, colIndex -&gt; {</span>
<span class="line-modified">!             keyboard.doLeftArrowPress(KeyModifier.SHIFT);</span>
<span class="line-modified">!             return colIndex - 1;</span>
<span class="line-modified">!         });</span>
      }
  
      @Test public void test_rt_39792_goRight_goPastEnd() {
<span class="line-modified">!         test_rt_39792(0, colIndex -&gt; {</span>
<span class="line-modified">!             keyboard.doRightArrowPress(KeyModifier.SHIFT);</span>
<span class="line-modified">!             return colIndex + 1;</span>
<span class="line-modified">!         });</span>
      }
  
      private void test_rt_39792(int startColumn, Function&lt;Integer, Integer&gt; r) {
          ObservableList&lt;String&gt; itemsList = FXCollections.observableArrayList();
          for (int i = 0; i &lt; 10; i++) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 4709,68 ***</span>
          tableView.getFocusModel().focus(0);
          keyboard.doUpArrowPress();
  
          assertEquals(0, tableView.getSelectionModel().getSelectedIndex());
      }
<span class="line-removed">- </span>
<span class="line-removed">-     @Test public void test_dynamic_NodeOrientation_change() {</span>
<span class="line-removed">- </span>
<span class="line-removed">-         sm.setCellSelectionEnabled(true);</span>
<span class="line-removed">-         sm.clearAndSelect(1, col2);</span>
<span class="line-removed">- </span>
<span class="line-removed">-         keyboard.doLeftArrowPress();</span>
<span class="line-removed">- </span>
<span class="line-removed">-         if (orientation == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col3));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col4));</span>
<span class="line-removed">- </span>
<span class="line-removed">-             tableView.setNodeOrientation(NodeOrientation.RIGHT_TO_LEFT);</span>
<span class="line-removed">-             orientation = NodeOrientation.RIGHT_TO_LEFT;</span>
<span class="line-removed">- </span>
<span class="line-removed">-         } else if (orientation == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col0));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col3));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col4));</span>
<span class="line-removed">- </span>
<span class="line-removed">-             tableView.setNodeOrientation(NodeOrientation.LEFT_TO_RIGHT);</span>
<span class="line-removed">-             orientation = NodeOrientation.LEFT_TO_RIGHT;</span>
<span class="line-removed">-          }</span>
<span class="line-removed">- </span>
<span class="line-removed">-         keyboard.doRightArrowPress();</span>
<span class="line-removed">- </span>
<span class="line-removed">-         if (tableView.getNodeOrientation() == NodeOrientation.LEFT_TO_RIGHT) {</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col0));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col3));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col4));</span>
<span class="line-removed">- </span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.SHIFT);</span>
<span class="line-removed">- </span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col0));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col3));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col4));</span>
<span class="line-removed">- </span>
<span class="line-removed">-         } else if (tableView.getNodeOrientation() == NodeOrientation.RIGHT_TO_LEFT) {</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col3));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col4));</span>
<span class="line-removed">- </span>
<span class="line-removed">-             keyboard.doLeftArrowPress(KeyModifier.SHIFT);</span>
<span class="line-removed">- </span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col0));</span>
<span class="line-removed">-             assertTrue(sm.isSelected(1, col1));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col2));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col3));</span>
<span class="line-removed">-             assertFalse(sm.isSelected(1, col4));</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-     }</span>
  }
<span class="line-new-header">--- 4312,6 ---</span>
</pre>
<center><a href="TableViewHorizontalArrowsTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>