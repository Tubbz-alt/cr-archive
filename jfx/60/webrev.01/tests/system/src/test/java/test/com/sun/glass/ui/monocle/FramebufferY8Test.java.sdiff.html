<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff tests/system/src/test/java/test/com/sun/glass/ui/monocle/FramebufferY8Test.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="EPDSettingsTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>tests/system/src/test/java/test/com/sun/glass/ui/monocle/FramebufferY8Test.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
173      *
174      * @param bitsPerPixel the number of bits per pixel in the output stream
175      * @throws IOException if an error occurs writing to the output stream
176      */
177     private void writeTest(int bitsPerPixel) throws IOException {
178         ByteArrayOutputStream oldStream = writeOld(bitsPerPixel);
179         ByteArrayOutputStream newStream = writeNew(bitsPerPixel);
180         Assert.assertArrayEquals(oldStream.toByteArray(), newStream.toByteArray());
181     }
182 
183     /**
184      * Prints the duration of a performance test.
185      *
186      * @param source the object containing the tested method
187      * @param method the name of the tested method
188      * @param duration the duration of the performance test
189      */
190     private void printTime(Object source, String method, long duration) {
191         float msPerFrame = (float) duration / ITERATIONS;
192         System.out.println(String.format(
<span class="line-modified">193                 &quot;Converted %,d frames of %,d Ã— %,d px to RGB565 in %,d ms (%,.0f ms/frame): %s.%s&quot;,</span>
194                 ITERATIONS, WIDTH, HEIGHT, duration, msPerFrame,
195                 source.getClass().getSuperclass().getSimpleName(), method));
196     }
197 
198     /**
199      * Measures the time for the original implementation to copy the test image
200      * to a 16-bit buffer in RGB565 format {@value #ITERATIONS} times.
201      */
202     private long timeOldCopyTo16() {
203         int bitsPerPixel = Short.SIZE;
204         int bytesPerPixel = bitsPerPixel &gt;&gt;&gt; BITS_TO_BYTES;
205         var source = new FramebufferY8SuperShim(bb, WIDTH, HEIGHT, bitsPerPixel, true);
206         var target = ByteBuffer.allocate(WIDTH * HEIGHT * bytesPerPixel);
207         long begin = System.currentTimeMillis();
208         for (int i = 0; i &lt; ITERATIONS; i++) {
209             source.copyToBuffer(target);
210             target.flip();
211         }
212         long end = System.currentTimeMillis();
213         long duration = end - begin;
</pre>
</td>
<td>
<hr />
<pre>
173      *
174      * @param bitsPerPixel the number of bits per pixel in the output stream
175      * @throws IOException if an error occurs writing to the output stream
176      */
177     private void writeTest(int bitsPerPixel) throws IOException {
178         ByteArrayOutputStream oldStream = writeOld(bitsPerPixel);
179         ByteArrayOutputStream newStream = writeNew(bitsPerPixel);
180         Assert.assertArrayEquals(oldStream.toByteArray(), newStream.toByteArray());
181     }
182 
183     /**
184      * Prints the duration of a performance test.
185      *
186      * @param source the object containing the tested method
187      * @param method the name of the tested method
188      * @param duration the duration of the performance test
189      */
190     private void printTime(Object source, String method, long duration) {
191         float msPerFrame = (float) duration / ITERATIONS;
192         System.out.println(String.format(
<span class="line-modified">193                 &quot;Converted %,d frames of %,d x %,d px to RGB565 in %,d ms (%,.0f ms/frame): %s.%s&quot;,</span>
194                 ITERATIONS, WIDTH, HEIGHT, duration, msPerFrame,
195                 source.getClass().getSuperclass().getSimpleName(), method));
196     }
197 
198     /**
199      * Measures the time for the original implementation to copy the test image
200      * to a 16-bit buffer in RGB565 format {@value #ITERATIONS} times.
201      */
202     private long timeOldCopyTo16() {
203         int bitsPerPixel = Short.SIZE;
204         int bytesPerPixel = bitsPerPixel &gt;&gt;&gt; BITS_TO_BYTES;
205         var source = new FramebufferY8SuperShim(bb, WIDTH, HEIGHT, bitsPerPixel, true);
206         var target = ByteBuffer.allocate(WIDTH * HEIGHT * bytesPerPixel);
207         long begin = System.currentTimeMillis();
208         for (int i = 0; i &lt; ITERATIONS; i++) {
209             source.copyToBuffer(target);
210             target.flip();
211         }
212         long end = System.currentTimeMillis();
213         long duration = end - begin;
</pre>
</td>
</tr>
</table>
<center><a href="EPDSettingsTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>