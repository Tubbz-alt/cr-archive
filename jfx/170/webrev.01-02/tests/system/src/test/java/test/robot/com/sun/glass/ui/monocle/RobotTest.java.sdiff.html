<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff tests/system/src/test/java/test/robot/com/sun/glass/ui/monocle/RobotTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>tests/system/src/test/java/test/robot/com/sun/glass/ui/monocle/RobotTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 44 
 45 import java.util.ArrayList;
 46 import java.util.List;
 47 import java.util.function.Consumer;
 48 import java.util.stream.Collectors;
 49 
 50 /**
 51  * This is a generic test for Glass robot. It is in the monocle.input package
 52  * because it uses the same test infrastructure as the Monocle input tests.
 53  */
 54 public class RobotTest {
 55 
 56     @Rule public TestName name = new TestName();
 57 
 58     @Before
 59     public void setUpScreen() throws Exception {
 60         TestLogShim.reset();
 61         TestLogShim.log(name.getMethodName());
 62         TestApplication.showFullScreenScene();
 63     }
<span class="line-modified"> 64     </span>
 65     @Test
 66     public void clickKeyModifierTest() throws Exception {
<span class="line-modified"> 67     	runWithKeyPress(KeyCode.CONTROL, MouseButton.PRIMARY, &quot;Clicked at 300, 400 with modifier &#39;CTRL&#39;&quot;, evt -&gt; {</span>
 68             assertTrue(&quot;Ctrl should be down&quot;,evt.isControlDown());
 69         });
 70         runWithKeyPress(KeyCode.SHIFT, MouseButton.PRIMARY, &quot;Clicked at 300, 400 with modifier &#39;SHIFT&#39;&quot;, evt -&gt; {
 71             assertTrue(&quot;Shift should be down&quot;,evt.isShiftDown());
 72         });
 73         runWithKeyPress(KeyCode.ALT, MouseButton.PRIMARY, &quot;Clicked at 300, 400 with modifier &#39;ALT&#39;&quot;, evt -&gt; {
 74             assertTrue(&quot;Alt should be down&quot;,evt.isAltDown());
 75         });
 76     }
<span class="line-modified"> 77     </span>
 78     private void runWithKeyPress(KeyCode code, MouseButton button, String message, Consumer&lt;MouseEvent&gt; test) throws Exception {
 79         TestApplication.getStage().getScene().setOnMouseClicked(
 80                 (e) -&gt; {
<span class="line-modified"> 81                 	test.accept(e);</span>
<span class="line-modified"> 82                 	TestLogShim.format(&quot;Clicked at %.0f, %.0f with modifier &#39;%s&#39;&quot;, e.getScreenX(), e.getScreenY(), modifierString(e));</span>
 83                 }
 84         );
<span class="line-modified"> 85     	</span>
<span class="line-modified"> 86     	Platform.runLater(() -&gt; {</span>
 87             Robot robot = new Robot();
 88             robot.mouseMove(300, 400);
 89             robot.keyPress(code);
 90             robot.mousePress(button);
 91             robot.mouseRelease(button);
 92             robot.keyRelease(code);
 93         });
<span class="line-modified"> 94     	TestLogShim.waitForLog(message);</span>
 95     }
<span class="line-modified"> 96     </span>
 97     private static String modifierString(MouseEvent evt) {
 98     	List&lt;String&gt; modifiers = new ArrayList&lt;&gt;();
 99     	if(evt.isAltDown()) {
100     		modifiers.add(&quot;ALT&quot;);
101     	}
102     	if(evt.isControlDown()) {
103     		modifiers.add(&quot;CTRL&quot;);
104     	}
105     	if(evt.isShiftDown()) {
106     		modifiers.add(&quot;SHIFT&quot;);
107     	}
108     	return modifiers.stream().collect(Collectors.joining(&quot;, &quot;));
109     }
110 
111     @Test
112     public void clickTest() throws Exception {
113         TestApplication.getStage().getScene().setOnMouseClicked(
114                 (e) -&gt; TestLogShim.format(&quot;Clicked at %.0f, %.0f&quot;,
115                                       e.getScreenX(), e.getScreenY()));
116         Platform.runLater(() -&gt; {
</pre>
</td>
<td>
<hr />
<pre>
 44 
 45 import java.util.ArrayList;
 46 import java.util.List;
 47 import java.util.function.Consumer;
 48 import java.util.stream.Collectors;
 49 
 50 /**
 51  * This is a generic test for Glass robot. It is in the monocle.input package
 52  * because it uses the same test infrastructure as the Monocle input tests.
 53  */
 54 public class RobotTest {
 55 
 56     @Rule public TestName name = new TestName();
 57 
 58     @Before
 59     public void setUpScreen() throws Exception {
 60         TestLogShim.reset();
 61         TestLogShim.log(name.getMethodName());
 62         TestApplication.showFullScreenScene();
 63     }
<span class="line-modified"> 64 </span>
 65     @Test
 66     public void clickKeyModifierTest() throws Exception {
<span class="line-modified"> 67         runWithKeyPress(KeyCode.CONTROL, MouseButton.PRIMARY, &quot;Clicked at 300, 400 with modifier &#39;CTRL&#39;&quot;, evt -&gt; {</span>
 68             assertTrue(&quot;Ctrl should be down&quot;,evt.isControlDown());
 69         });
 70         runWithKeyPress(KeyCode.SHIFT, MouseButton.PRIMARY, &quot;Clicked at 300, 400 with modifier &#39;SHIFT&#39;&quot;, evt -&gt; {
 71             assertTrue(&quot;Shift should be down&quot;,evt.isShiftDown());
 72         });
 73         runWithKeyPress(KeyCode.ALT, MouseButton.PRIMARY, &quot;Clicked at 300, 400 with modifier &#39;ALT&#39;&quot;, evt -&gt; {
 74             assertTrue(&quot;Alt should be down&quot;,evt.isAltDown());
 75         });
 76     }
<span class="line-modified"> 77 </span>
 78     private void runWithKeyPress(KeyCode code, MouseButton button, String message, Consumer&lt;MouseEvent&gt; test) throws Exception {
 79         TestApplication.getStage().getScene().setOnMouseClicked(
 80                 (e) -&gt; {
<span class="line-modified"> 81                     test.accept(e);</span>
<span class="line-modified"> 82                     TestLogShim.format(&quot;Clicked at %.0f, %.0f with modifier &#39;%s&#39;&quot;, e.getScreenX(), e.getScreenY(), modifierString(e));</span>
 83                 }
 84         );
<span class="line-modified"> 85 </span>
<span class="line-modified"> 86         Platform.runLater(() -&gt; {</span>
 87             Robot robot = new Robot();
 88             robot.mouseMove(300, 400);
 89             robot.keyPress(code);
 90             robot.mousePress(button);
 91             robot.mouseRelease(button);
 92             robot.keyRelease(code);
 93         });
<span class="line-modified"> 94         TestLogShim.waitForLog(message);</span>
 95     }
<span class="line-modified"> 96 </span>
 97     private static String modifierString(MouseEvent evt) {
 98     	List&lt;String&gt; modifiers = new ArrayList&lt;&gt;();
 99     	if(evt.isAltDown()) {
100     		modifiers.add(&quot;ALT&quot;);
101     	}
102     	if(evt.isControlDown()) {
103     		modifiers.add(&quot;CTRL&quot;);
104     	}
105     	if(evt.isShiftDown()) {
106     		modifiers.add(&quot;SHIFT&quot;);
107     	}
108     	return modifiers.stream().collect(Collectors.joining(&quot;, &quot;));
109     }
110 
111     @Test
112     public void clickTest() throws Exception {
113         TestApplication.getStage().getScene().setOnMouseClicked(
114                 (e) -&gt; TestLogShim.format(&quot;Clicked at %.0f, %.0f&quot;,
115                                       e.getScreenX(), e.getScreenY()));
116         Platform.runLater(() -&gt; {
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>