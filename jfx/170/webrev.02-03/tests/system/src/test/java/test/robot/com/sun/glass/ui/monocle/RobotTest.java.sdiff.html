<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff tests/system/src/test/java/test/robot/com/sun/glass/ui/monocle/RobotTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>tests/system/src/test/java/test/robot/com/sun/glass/ui/monocle/RobotTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 78     private void runWithKeyPress(KeyCode code, MouseButton button, String message, Consumer&lt;MouseEvent&gt; test) throws Exception {
 79         TestApplication.getStage().getScene().setOnMouseClicked(
 80                 (e) -&gt; {
 81                     test.accept(e);
 82                     TestLogShim.format(&quot;Clicked at %.0f, %.0f with modifier &#39;%s&#39;&quot;, e.getScreenX(), e.getScreenY(), modifierString(e));
 83                 }
 84         );
 85 
 86         Platform.runLater(() -&gt; {
 87             Robot robot = new Robot();
 88             robot.mouseMove(300, 400);
 89             robot.keyPress(code);
 90             robot.mousePress(button);
 91             robot.mouseRelease(button);
 92             robot.keyRelease(code);
 93         });
 94         TestLogShim.waitForLog(message);
 95     }
 96 
 97     private static String modifierString(MouseEvent evt) {
<span class="line-modified"> 98     	List&lt;String&gt; modifiers = new ArrayList&lt;&gt;();</span>
<span class="line-modified"> 99     	if(evt.isAltDown()) {</span>
<span class="line-modified">100     		modifiers.add(&quot;ALT&quot;);</span>
<span class="line-modified">101     	}</span>
<span class="line-modified">102     	if(evt.isControlDown()) {</span>
<span class="line-modified">103     		modifiers.add(&quot;CTRL&quot;);</span>
<span class="line-modified">104     	}</span>
<span class="line-modified">105     	if(evt.isShiftDown()) {</span>
<span class="line-modified">106     		modifiers.add(&quot;SHIFT&quot;);</span>
<span class="line-modified">107     	}</span>
<span class="line-modified">108     	return modifiers.stream().collect(Collectors.joining(&quot;, &quot;));</span>
109     }
110 
111     @Test
112     public void clickTest() throws Exception {
113         TestApplication.getStage().getScene().setOnMouseClicked(
114                 (e) -&gt; TestLogShim.format(&quot;Clicked at %.0f, %.0f&quot;,
115                                       e.getScreenX(), e.getScreenY()));
116         Platform.runLater(() -&gt; {
117             Robot robot = new Robot();
118             robot.mouseMove(300, 400);
119             robot.mousePress(MouseButton.PRIMARY);
120             robot.mouseRelease(MouseButton.PRIMARY);
121             assertEquals(new Point2D(300, 400), robot.getMousePosition());
122             assertEquals(300, (int) robot.getMouseX());
123             assertEquals(400, (int) robot.getMouseY());
124         });
125         TestLogShim.waitForLog(&quot;Clicked at 300, 400&quot;);
126 
127         Platform.runLater(() -&gt; {
128             Robot robot = new Robot();
</pre>
</td>
<td>
<hr />
<pre>
 78     private void runWithKeyPress(KeyCode code, MouseButton button, String message, Consumer&lt;MouseEvent&gt; test) throws Exception {
 79         TestApplication.getStage().getScene().setOnMouseClicked(
 80                 (e) -&gt; {
 81                     test.accept(e);
 82                     TestLogShim.format(&quot;Clicked at %.0f, %.0f with modifier &#39;%s&#39;&quot;, e.getScreenX(), e.getScreenY(), modifierString(e));
 83                 }
 84         );
 85 
 86         Platform.runLater(() -&gt; {
 87             Robot robot = new Robot();
 88             robot.mouseMove(300, 400);
 89             robot.keyPress(code);
 90             robot.mousePress(button);
 91             robot.mouseRelease(button);
 92             robot.keyRelease(code);
 93         });
 94         TestLogShim.waitForLog(message);
 95     }
 96 
 97     private static String modifierString(MouseEvent evt) {
<span class="line-modified"> 98         List&lt;String&gt; modifiers = new ArrayList&lt;&gt;();</span>
<span class="line-modified"> 99         if(evt.isAltDown()) {</span>
<span class="line-modified">100             modifiers.add(&quot;ALT&quot;);</span>
<span class="line-modified">101         }</span>
<span class="line-modified">102         if(evt.isControlDown()) {</span>
<span class="line-modified">103             modifiers.add(&quot;CTRL&quot;);</span>
<span class="line-modified">104         }</span>
<span class="line-modified">105         if(evt.isShiftDown()) {</span>
<span class="line-modified">106             modifiers.add(&quot;SHIFT&quot;);</span>
<span class="line-modified">107         }</span>
<span class="line-modified">108         return modifiers.stream().collect(Collectors.joining(&quot;, &quot;));</span>
109     }
110 
111     @Test
112     public void clickTest() throws Exception {
113         TestApplication.getStage().getScene().setOnMouseClicked(
114                 (e) -&gt; TestLogShim.format(&quot;Clicked at %.0f, %.0f&quot;,
115                                       e.getScreenX(), e.getScreenY()));
116         Platform.runLater(() -&gt; {
117             Robot robot = new Robot();
118             robot.mouseMove(300, 400);
119             robot.mousePress(MouseButton.PRIMARY);
120             robot.mouseRelease(MouseButton.PRIMARY);
121             assertEquals(new Point2D(300, 400), robot.getMousePosition());
122             assertEquals(300, (int) robot.getMouseX());
123             assertEquals(400, (int) robot.getMouseY());
124         });
125         TestLogShim.waitForLog(&quot;Clicked at 300, 400&quot;);
126 
127         Platform.runLater(() -&gt; {
128             Robot robot = new Robot();
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>