<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.media/src/main/native/jfxmedia/platform/osx/avf/AVFAudioSpectrumUnit.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../gstreamer/gstreamer-lite/gst-plugins-good/gst/spectrum/gstspectrum.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>modules/javafx.media/src/main/native/jfxmedia/platform/osx/avf/AVFAudioSpectrumUnit.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
255 
256             delete [] magnitudes;
257             delete [] phases;
258         }
259     }
260 
261     gst_message_unref(message);
262 
263     return TRUE;
264 }
265 
266 void AVFAudioSpectrumUnit::SetupSpectralProcessor() {
267     ReleaseSpectralProcessor();
268 
269     lockBands();
270 
271     mSpectrumElement = gst_element_factory_make(&quot;spectrum&quot;, NULL);
272     mSpectrum = GST_SPECTRUM(mSpectrumElement);
273     mSpectrum-&gt;user_data = (void*)this;
274 
<span class="line-modified">275     // Set our own callback for post message</span>
<span class="line-modified">276     GstElementClass *klass;</span>
<span class="line-modified">277     klass = GST_ELEMENT_GET_CLASS(mSpectrumElement);</span>
<span class="line-modified">278     klass-&gt;post_message = PostMessageCallback;</span>
279 
280     // Configure spectrum element
281     // Do send magnitude and phase information, off by default
282     g_object_set(mSpectrumElement, &quot;post-messages&quot;, TRUE,
283                                    &quot;message-magnitude&quot;, TRUE,
284                                    &quot;message-phase&quot;, TRUE, NULL);
285 
286     g_object_set(mSpectrumElement, &quot;bands&quot;, mBandCount, NULL);
287 
288     mSamplesPerInterval = (UInt32)(mSampleRate * mUpdateInterval);
289     guint64 value = (guint64) (mUpdateInterval * GST_SECOND);
290     g_object_set(mSpectrumElement, &quot;interval&quot;, value, NULL);
291 
292     g_object_set(mSpectrumElement, &quot;threshold&quot;, (int) mThreshold, NULL);
293 
294     // Since we do not run spectrum element in pipeline and it will not get configured
295     // correctly, we need to set required information directly.
296     GST_AUDIO_FILTER_RATE(mSpectrum) = mSampleRate;
297     GST_AUDIO_FILTER_CHANNELS(mSpectrum) = 1; // Always 1 channel
298 
</pre>
</td>
<td>
<hr />
<pre>
255 
256             delete [] magnitudes;
257             delete [] phases;
258         }
259     }
260 
261     gst_message_unref(message);
262 
263     return TRUE;
264 }
265 
266 void AVFAudioSpectrumUnit::SetupSpectralProcessor() {
267     ReleaseSpectralProcessor();
268 
269     lockBands();
270 
271     mSpectrumElement = gst_element_factory_make(&quot;spectrum&quot;, NULL);
272     mSpectrum = GST_SPECTRUM(mSpectrumElement);
273     mSpectrum-&gt;user_data = (void*)this;
274 
<span class="line-modified">275     // Set our own callback for post message, do not use</span>
<span class="line-modified">276     // GST_ELEMENT_GET_CLASS(mSpectrumElement)-&gt;post_message, since it will change</span>
<span class="line-modified">277     // callback for all instances of spectrum element.</span>
<span class="line-modified">278     mSpectrum-&gt;post_message_callback = PostMessageCallback;</span>
279 
280     // Configure spectrum element
281     // Do send magnitude and phase information, off by default
282     g_object_set(mSpectrumElement, &quot;post-messages&quot;, TRUE,
283                                    &quot;message-magnitude&quot;, TRUE,
284                                    &quot;message-phase&quot;, TRUE, NULL);
285 
286     g_object_set(mSpectrumElement, &quot;bands&quot;, mBandCount, NULL);
287 
288     mSamplesPerInterval = (UInt32)(mSampleRate * mUpdateInterval);
289     guint64 value = (guint64) (mUpdateInterval * GST_SECOND);
290     g_object_set(mSpectrumElement, &quot;interval&quot;, value, NULL);
291 
292     g_object_set(mSpectrumElement, &quot;threshold&quot;, (int) mThreshold, NULL);
293 
294     // Since we do not run spectrum element in pipeline and it will not get configured
295     // correctly, we need to set required information directly.
296     GST_AUDIO_FILTER_RATE(mSpectrum) = mSampleRate;
297     GST_AUDIO_FILTER_CHANNELS(mSpectrum) = 1; // Always 1 channel
298 
</pre>
</td>
</tr>
</table>
<center><a href="../../../../gstreamer/gstreamer-lite/gst-plugins-good/gst/spectrum/gstspectrum.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>