<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/ThirdParty/libxml/src/Makefile.am</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>   1 ## Process this file with automake to produce Makefile.in
   2 
   3 ACLOCAL_AMFLAGS = -I m4
   4 
   5 SUBDIRS = include . doc example xstc $(PYTHON_SUBDIR)
   6 
   7 DIST_SUBDIRS = include . doc example python xstc
   8 
   9 AM_CPPFLAGS = -I$(top_builddir)/include -I$(srcdir)/include
  10 
  11 AM_CFLAGS = $(EXTRA_CFLAGS) $(THREAD_CFLAGS) $(Z_CFLAGS) $(LZMA_CFLAGS)
  12 
  13 check_PROGRAMS=testSchemas testRelax testSAX testHTML testXPath testURI \
  14                testThreads testC14N testAutomata testRegexp \
  15                testReader testapi testModule runtest runsuite testchar \
  16 	       testdict runxmlconf testrecurse testlimits
  17 
  18 bin_PROGRAMS = xmllint xmlcatalog
  19 
  20 bin_SCRIPTS=xml2-config
  21 
  22 lib_LTLIBRARIES = libxml2.la
  23 libxml2_la_LIBADD = $(ICU_LIBS) $(THREAD_LIBS) $(Z_LIBS) $(LZMA_LIBS) $(ICONV_LIBS) $(M_LIBS) $(WIN32_EXTRA_LIBADD)
  24 
  25 if USE_VERSION_SCRIPT
  26 LIBXML2_VERSION_SCRIPT = $(VERSION_SCRIPT_FLAGS)$(srcdir)/libxml2.syms
  27 else
  28 LIBXML2_VERSION_SCRIPT =
  29 endif
  30 
  31 libxml2_la_LDFLAGS = $(CYGWIN_EXTRA_LDFLAGS) $(WIN32_EXTRA_LDFLAGS) \
  32 		     $(LIBXML2_VERSION_SCRIPT) \
  33 		     -version-info $(LIBXML_VERSION_INFO) \
  34 		     $(MODULE_PLATFORM_LIBS)
  35 
  36 if WITH_SAX1_SOURCES
  37 docb_sources = DOCBparser.c
  38 else
  39 docb_sources =
  40 endif
  41 
  42 if WITH_TRIO_SOURCES
  43 trio_sources = triostr.c trio.c
  44 else
  45 trio_sources =
  46 endif
  47 
  48 libxml2_la_SOURCES = SAX.c entities.c encoding.c error.c parserInternals.c  \
  49 		parser.c tree.c hash.c list.c xmlIO.c xmlmemory.c uri.c  \
  50 		valid.c xlink.c HTMLparser.c HTMLtree.c debugXML.c xpath.c  \
  51 		xpointer.c xinclude.c nanohttp.c nanoftp.c \
  52 		$(docb_sources) \
  53 		catalog.c globals.c threads.c c14n.c xmlstring.c buf.c \
  54 		xmlregexp.c xmlschemas.c xmlschemastypes.c xmlunicode.c \
  55 		$(trio_sources) \
  56 		xmlreader.c relaxng.c dict.c SAX2.c \
  57 		xmlwriter.c legacy.c chvalid.c pattern.c xmlsave.c \
  58 		xmlmodule.c schematron.c xzlib.c
  59 
  60 DEPS = $(top_builddir)/libxml2.la
  61 LDADDS = $(STATIC_BINARIES) $(top_builddir)/libxml2.la $(THREAD_LIBS) $(Z_LIBS) $(LZMA_LIBS) $(ICONV_LIBS) $(M_LIBS) $(WIN32_EXTRA_LIBADD)
  62 
  63 
  64 man_MANS = xml2-config.1 libxml.3
  65 
  66 m4datadir = $(datadir)/aclocal
  67 m4data_DATA = libxml.m4
  68 
  69 runtest_SOURCES=runtest.c
  70 runtest_LDFLAGS = 
  71 runtest_DEPENDENCIES = $(DEPS)
  72 runtest_LDADD= $(BASE_THREAD_LIBS) $(RDL_LIBS) $(LDADDS)
  73 
  74 testrecurse_SOURCES=testrecurse.c
  75 testrecurse_LDFLAGS = 
  76 testrecurse_DEPENDENCIES = $(DEPS)
  77 testrecurse_LDADD= $(BASE_THREAD_LIBS) $(RDL_LIBS) $(LDADDS)
  78 
  79 testlimits_SOURCES=testlimits.c
  80 testlimits_LDFLAGS = 
  81 testlimits_DEPENDENCIES = $(DEPS)
  82 testlimits_LDADD= $(BASE_THREAD_LIBS) $(RDL_LIBS) $(LDADDS)
  83 
  84 testchar_SOURCES=testchar.c
  85 testchar_LDFLAGS = 
  86 testchar_DEPENDENCIES = $(DEPS)
  87 testchar_LDADD= $(RDL_LIBS) $(LDADDS)
  88 
  89 testdict_SOURCES=testdict.c
  90 testdict_LDFLAGS = 
  91 testdict_DEPENDENCIES = $(DEPS)
  92 testdict_LDADD= $(RDL_LIBS) $(LDADDS)
  93 
  94 runsuite_SOURCES=runsuite.c
  95 runsuite_LDFLAGS = 
  96 runsuite_DEPENDENCIES = $(DEPS)
  97 runsuite_LDADD= $(RDL_LIBS) $(LDADDS)
  98 
  99 xmllint_SOURCES=xmllint.c
 100 xmllint_LDFLAGS = 
 101 xmllint_DEPENDENCIES = $(DEPS)
 102 xmllint_LDADD=  $(RDL_LIBS) $(LDADDS)
 103 
 104 testSAX_SOURCES=testSAX.c
 105 testSAX_LDFLAGS = 
 106 testSAX_DEPENDENCIES = $(DEPS)
 107 testSAX_LDADD= $(LDADDS)
 108 
 109 testHTML_SOURCES=testHTML.c
 110 testHTML_LDFLAGS = 
 111 testHTML_DEPENDENCIES = $(DEPS)
 112 testHTML_LDADD= $(LDADDS)
 113 
 114 xmlcatalog_SOURCES=xmlcatalog.c
 115 xmlcatalog_LDFLAGS = 
 116 xmlcatalog_DEPENDENCIES = $(DEPS)
 117 xmlcatalog_LDADD = $(RDL_LIBS) $(LDADDS)
 118 
 119 testXPath_SOURCES=testXPath.c
 120 testXPath_LDFLAGS = 
 121 testXPath_DEPENDENCIES = $(DEPS)
 122 testXPath_LDADD= $(LDADDS)
 123 
 124 testC14N_SOURCES=testC14N.c
 125 testC14N_LDFLAGS = 
 126 testC14N_DEPENDENCIES = $(DEPS)
 127 testC14N_LDADD= $(LDADDS)
 128 
<a name="1" id="anc1"></a>


 129 testThreads_SOURCES = testThreads.c
<a name="2" id="anc2"></a>
 130 testThreads_LDFLAGS = 
 131 testThreads_DEPENDENCIES = $(DEPS)
 132 testThreads_LDADD= $(BASE_THREAD_LIBS) $(LDADDS)
 133 
 134 testURI_SOURCES=testURI.c
 135 testURI_LDFLAGS = 
 136 testURI_DEPENDENCIES = $(DEPS)
 137 testURI_LDADD= $(LDADDS)
 138 
 139 testRegexp_SOURCES=testRegexp.c
 140 testRegexp_LDFLAGS = 
 141 testRegexp_DEPENDENCIES = $(DEPS)
 142 testRegexp_LDADD= $(LDADDS)
 143 
 144 testAutomata_SOURCES=testAutomata.c
 145 testAutomata_LDFLAGS = 
 146 testAutomata_DEPENDENCIES = $(DEPS)
 147 testAutomata_LDADD= $(LDADDS)
 148 
 149 testSchemas_SOURCES=testSchemas.c
 150 testSchemas_LDFLAGS = 
 151 testSchemas_DEPENDENCIES = $(DEPS)
 152 testSchemas_LDADD= $(LDADDS)
 153 
 154 testRelax_SOURCES=testRelax.c
 155 testRelax_LDFLAGS = 
 156 testRelax_DEPENDENCIES = $(DEPS)
 157 testRelax_LDADD= $(LDADDS)
 158 
 159 testReader_SOURCES=testReader.c
 160 testReader_LDFLAGS = 
 161 testReader_DEPENDENCIES = $(DEPS)
 162 testReader_LDADD= $(LDADDS)
 163 
 164 testModule_SOURCES=testModule.c
 165 testModule_LDFLAGS = 
 166 testModule_DEPENDENCIES = $(DEPS)
 167 testModule_LDADD= $(LDADDS)
 168 
 169 noinst_LTLIBRARIES = testdso.la
 170 testdso_la_SOURCES = testdso.c
 171 testdso_la_LDFLAGS = -module -no-undefined -avoid-version -rpath $(libdir)
 172 
 173 # that one forces the rebuild when &quot;make rebuild&quot; is run on doc/
 174 rebuild_testapi:
 175 	-@(if [ &quot;$(PYTHON)&quot; != &quot;&quot; ] ; then \
 176 	    $(PYTHON) $(srcdir)/gentest.py $(srcdir) ; fi )
 177 
 178 # that one is just to make sure it is rebuilt if missing
 179 # but adding the dependances generate mess
 180 testapi.c: $(srcdir)/gentest.py
 181 	-@(if [ &quot;$(PYTHON)&quot; != &quot;&quot; ] ; then \
 182 	    $(PYTHON) $(srcdir)/gentest.py $(srcdir) ; fi )
 183 
 184 BUILT_SOURCES = testapi.c
 185 
 186 testapi_SOURCES=testapi.c
 187 testapi_LDFLAGS = 
 188 testapi_DEPENDENCIES = $(DEPS)
 189 testapi_LDADD= $(LDADDS)
 190 
 191 runxmlconf_SOURCES=runxmlconf.c
 192 runxmlconf_LDFLAGS = 
 193 runxmlconf_DEPENDENCIES = $(DEPS)
 194 runxmlconf_LDADD= $(LDADDS)
 195 
 196 #testOOM_SOURCES=testOOM.c testOOMlib.h testOOMlib.c
 197 #testOOM_LDFLAGS = 
 198 #testOOM_DEPENDENCIES = $(DEPS)
 199 #testOOM_LDADD= $(LDADDS)
 200 
 201 runtests: runtest$(EXEEXT) testrecurse$(EXEEXT) testapi$(EXEEXT) \
 202           testchar$(EXEEXT) testdict$(EXEEXT) runxmlconf$(EXEEXT)
 203 	[ -d test   ] || $(LN_S) $(srcdir)/test   .
 204 	[ -d result ] || $(LN_S) $(srcdir)/result .
 205 	$(CHECKER) ./runtest$(EXEEXT) &amp;&amp; \
 206 	    $(CHECKER) ./testrecurse$(EXEEXT) &amp;&amp; \
 207 	    ASAN_OPTIONS=&quot;$$ASAN_OPTIONS:detect_leaks=0&quot; $(CHECKER) ./testapi$(EXEEXT) &amp;&amp; \
 208 	    $(CHECKER) ./testchar$(EXEEXT) &amp;&amp; \
 209 	    $(CHECKER) ./testdict$(EXEEXT) &amp;&amp; \
 210 	    $(CHECKER) ./runxmlconf$(EXEEXT)
 211 	@(if [ &quot;$(PYTHON_SUBDIR)&quot; != &quot;&quot; ] ; then cd python ; \
 212 	    $(MAKE) tests ; fi)
 213 
 214 check: all runtests
 215 
 216 check-valgrind valgrind: all
 217 	@echo &#39;## Running the regression tests under Valgrind&#39;
 218 	@echo &#39;## Go get a cup of coffee it is gonna take a while ...&#39;
 219 	$(MAKE) CHECKER=&#39;valgrind -q&#39; runtests
 220 
 221 asan:
 222 	@echo &#39;## rebuilding for ASAN&#39;
 223 	./configure CFLAGS=&quot;-fsanitize=address,undefined -Wformat -Werror=format-security -Werror=array-bounds -g&quot; CXXFLAGS=&quot;-fsanitize=address,undefined -Wformat -Werror=format-security -Werror=array-bounds -g&quot; LDFLAGS=&quot;-fsanitize=address,undefined&quot; CC=&quot;clang&quot; CXX=&quot;clang++&quot; --disable-shared ; OptimOff  ; $(MAKE) clean ; $(MAKE)
 224 
 225 testall : tests SVGtests SAXtests
 226 
 227 tests: XMLtests XMLenttests NStests IDtests Errtests APItests $(READER_TEST) $(TEST_SAX) $(TEST_PUSH) $(TEST_HTML) $(TEST_PHTML) $(TEST_VALID) URItests $(TEST_PATTERN) $(TEST_XPATH) $(TEST_XPTR) $(TEST_XINCLUDE) $(TEST_C14N) $(TEST_DEBUG) $(TEST_CATALOG) $(TEST_REGEXPS) $(TEST_SCHEMAS) $(TEST_SCHEMATRON) $(TEST_THREADS) Timingtests $(TEST_VTIME) $(PYTHON_TESTS) $(TEST_MODULES)
 228 	@(if [ &quot;$(PYTHON_SUBDIR)&quot; != &quot;&quot; ] ; then cd python ; \
 229 	    $(MAKE) -s tests ; fi)
 230 	@(cd doc/examples ; $(MAKE) -s tests)
 231 
 232 APItests: testapi$(EXEEXT)
 233 	@echo &quot;## Running the API regression tests this may take a little while&quot;
 234 	-@(ASAN_OPTIONS=&quot;$$ASAN_OPTIONS:detect_leaks=0&quot; $(CHECKER) $(top_builddir)/testapi -q)
 235 
 236 HTMLtests : testHTML$(EXEEXT)
 237 	@(echo &gt; .memdump)
 238 	@echo &quot;## HTML regression tests&quot;
 239 	-@(for i in $(srcdir)/test/HTML/* ; do \
 240 	  name=`basename $$i`; \
 241 	  if [ ! -d $$i ] ; then \
 242 	  if [ ! -f $(srcdir)/result/HTML/$$name ] ; then \
 243 	      echo New test file $$name ; \
 244 	      $(CHECKER) $(top_builddir)/testHTML $$i &gt; $(srcdir)/result/HTML/$$name 2&gt;$(srcdir)/result/HTML/$$name.err ; \
 245 	  else \
 246 	      log=`$(CHECKER) $(top_builddir)/testHTML $$i &gt; result.$$name 2&gt; error.$$name ; \
 247 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 248 	      diff $(srcdir)/result/HTML/$$name result.$$name ; \
 249 	      diff -b $(srcdir)/result/HTML/$$name.err error.$$name ; \
 250 	      $(CHECKER) $(top_builddir)/testHTML result.$$name &gt; result2.$$name 2&gt;error.$$name ; \
 251 	      diff result.$$name result2.$$name` ; \
 252 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 253 	      rm result.$$name result2.$$name error.$$name ; \
 254 	  fi ; fi ; done)
 255 
 256 HTMLPushtests : testHTML$(EXEEXT)
 257 	@echo &quot;## Push HTML regression tests&quot;
 258 	-@(for i in $(srcdir)/test/HTML/* ; do \
 259 	  name=`basename $$i`; \
 260 	  if [ ! -d $$i ] ; then \
 261 	  if [ ! -f $(srcdir)/result/HTML/$$name ] ; then \
 262 	      echo New test file $$name ; \
 263 	      $(CHECKER) $(top_builddir)/testHTML --push $$i &gt; $(srcdir)/result/HTML/$$name 2&gt;$(srcdir)/result/HTML/$$name.err ; \
 264 	  else \
 265 	      log=`$(CHECKER) $(top_builddir)/testHTML --push $$i &gt; result.$$name 2&gt; error.$$name ; \
 266 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 267 	      diff $(srcdir)/result/HTML/$$name result.$$name ; \
 268 	      cut -b 1-15 $(srcdir)/result/HTML/$$name.err &gt; errorcut.$$name; \
 269 	      cut -b 1-15 error.$$name &gt; errorcut2.$$name; \
 270 	      diff -b errorcut.$$name errorcut2.$$name ; \
 271 	      $(CHECKER) $(top_builddir)/testHTML --push result.$$name &gt; result2.$$name 2&gt;error.$$name ; \
 272 	      diff result.$$name result2.$$name` ; \
 273 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 274 	      rm result.$$name result2.$$name error.$$name errorcut.$$name errorcut2.$$name ; \
 275 	  fi ; fi ; done)
 276 	@echo &quot;## HTML SAX regression tests&quot;
 277 	-@(for i in $(srcdir)/test/HTML/* ; do \
 278 	  name=`basename $$i`; \
 279 	  if [ ! -d $$i ] ; then \
 280 	  if [ ! -f $(srcdir)/result/HTML/$$name.sax ] ; then \
 281 	      echo New test file $$name ; \
 282 	      $(CHECKER) $(top_builddir)/testHTML --sax $$i &gt; $(srcdir)/result/HTML/$$name.sax ; \
 283 	  else \
 284 	      log=`$(CHECKER) $(top_builddir)/testHTML --sax $$i &gt; result.$$name.sax ; \
 285 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 286 	      diff $(srcdir)/result/HTML/$$name.sax result.$$name.sax` ; \
 287 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 288 	      rm result.$$name.sax ; \
 289 	  fi ; fi ; done)
 290 	@echo &quot;## Push HTML SAX regression tests&quot;
 291 	-@(for i in $(srcdir)/test/HTML/* ; do \
 292 	  name=`basename $$i`; \
 293 	  if [ ! -d $$i ] ; then \
 294 	  if [ ! -f $(srcdir)/result/HTML/$$name ] ; then \
 295 	      echo New test file $$name ; \
 296 	      $(CHECKER) $(top_builddir)/testHTML --push --sax $$i &gt; $(srcdir)/result/HTML/$$name.sax ; \
 297 	  else \
 298 	      log=`$(CHECKER) $(top_builddir)/testHTML --push --sax $$i 2&gt;&amp;1 &gt; result.$$name.sax ; \
 299 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 300 	      diff $(srcdir)/result/HTML/$$name.sax result.$$name.sax` ; \
 301 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 302 	      rm result.$$name.sax ; \
 303 	  fi ; fi ; done)
 304 
 305 XMLtests : xmllint$(EXEEXT)
 306 	@(echo &gt; .memdump)
 307 	@echo &quot;## XML regression tests&quot;
 308 	-@(for i in $(srcdir)/test/* ; do \
 309 	  name=`basename $$i`; \
 310 	  if [ ! -d $$i ] ; then \
 311 	  if [ ! -f $(srcdir)/result/$$name ] ; then \
 312 	      echo New test file $$name ; \
 313 	      $(CHECKER) $(top_builddir)/xmllint $$i &gt; $(srcdir)/result/$$name ; \
 314 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 315 	  else \
 316 	      log=`$(CHECKER) $(top_builddir)/xmllint $$i 2&gt;&amp;1 &gt; result.$$name ; \
 317 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 318 	      diff $(srcdir)/result/$$name result.$$name ; \
 319 	      $(CHECKER) $(top_builddir)/xmllint result.$$name 2&gt;&amp;1 &gt; result2.$$name | grep -v &#39;failed to load external entity&#39; ; \
 320 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 321 	      diff result.$$name result2.$$name` ;\
 322 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 323 	      rm result.$$name result2.$$name ; \
 324 	  fi ; fi ; done)
 325 	@echo &quot;## XML regression tests on memory&quot;
 326 	-@(for i in $(srcdir)/test/* ; do \
 327 	  name=`basename $$i`; \
 328 	  if [ ! -d $$i ] ; then \
 329 	  if [ ! -f $(srcdir)/result/$$name ] ; then \
 330 	      echo New test file $$name ; \
 331 	      $(CHECKER) $(top_builddir)/xmllint --memory $$i &gt; $(srcdir)/result/$$name ; \
 332 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 333 	  else \
 334 	      log=`$(CHECKER) $(top_builddir)/xmllint --memory $$i 2&gt;&amp;1 &gt; result.$$name ; \
 335 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 336 	      diff $(srcdir)/result/$$name result.$$name ; \
 337 	      $(CHECKER) $(top_builddir)/xmllint --memory result.$$name 2&gt;&amp;1 &gt; result2.$$name | grep -v &#39;failed to load external entity&#39; ; \
 338 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;`; \
 339 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 340 	      diff result.$$name result2.$$name ; \
 341 	      rm result.$$name result2.$$name ; \
 342 	  fi ; fi ; done)
 343 
 344 XMLPushtests: xmllint$(EXEEXT)
 345 	@(echo &gt; .memdump)
 346 	@echo &quot;## XML push regression tests&quot;
 347 	-@(for i in $(srcdir)/test/* ; do \
 348 	  name=`basename $$i`; \
 349 	  if [ ! -d $$i ] ; then \
 350 	  if [ ! -f $(srcdir)/result/$$name ] ; then \
 351 	      echo New test file $$name ; \
 352 	      $(CHECKER) $(top_builddir)/xmllint --push $$i &gt; $(srcdir)/result/$$name ; \
 353 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 354 	  else \
 355 	      log=`$(CHECKER) $(top_builddir)/xmllint --push $$i 2&gt;&amp;1 &gt; result.$$name ; \
 356 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 357 	      diff $(srcdir)/result/$$name result.$$name ; \
 358 	      $(CHECKER) $(top_builddir)/xmllint --push result.$$name 2&gt;&amp;1 &gt; result2.$$name | grep -v &#39;failed to load external entity&#39; ; \
 359 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 360 	      diff result.$$name result2.$$name` ; \
 361 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 362 	      rm result.$$name result2.$$name ; \
 363 	  fi ; fi ; done)
 364 
 365 NStests : xmllint$(EXEEXT)
 366 	@(echo &gt; .memdump)
 367 	@echo &quot;## XML Namespaces regression tests&quot;
 368 	-@(for i in $(srcdir)/test/namespaces/* ; do \
 369 	  name=`basename $$i`; \
 370 	  if [ ! -d $$i ] ; then \
 371 	  if [ ! -f $(srcdir)/result/namespaces/$$name ] ; then \
 372 	      echo New test file $$name ; \
 373 	      $(CHECKER) $(top_builddir)/xmllint $$i \
 374 	         2&gt; $(srcdir)/result/namespaces/$$name.err \
 375 		 &gt; $(srcdir)/result/namespaces/$$name ; \
 376 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 377 	  else \
 378 	      log=`$(CHECKER) $(top_builddir)/xmllint $$i 2&gt; error.$$name &gt; result.$$name ; \
 379 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 380 	      diff $(srcdir)/result/namespaces/$$name result.$$name ; \
 381 	      diff $(srcdir)/result/namespaces/$$name.err error.$$name`; \
 382 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 383 	      rm result.$$name error.$$name ; \
 384 	  fi ; fi ; done)
 385 
 386 IDtests : xmllint$(EXEEXT) testXPath$(EXEEXT)
 387 	@(echo &gt; .memdump)
 388 	@echo &quot;## xml:id regression tests&quot;
 389 	-@(for i in $(srcdir)/test/xmlid/id_*.xml ; do \
 390 	  name=`basename $$i`; \
 391 	  if [ ! -d $$i ] ; then \
 392 	  if [ ! -f $(srcdir)/result/xmlid/$$name ] ; then \
 393 	      echo New test file $$name ; \
 394 	      $(CHECKER) $(top_builddir)/testXPath -i $$i &quot;id(&#39;bar&#39;)&quot; \
 395 	         2&gt; $(srcdir)/result/xmlid/$$name.err \
 396 		 &gt; $(srcdir)/result/xmlid/$$name ; \
 397 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 398 	  else \
 399 	      log=`$(CHECKER) $(top_builddir)/testXPath -i $$i &quot;id(&#39;bar&#39;)&quot; 2&gt; error.$$name &gt; result.$$name ; \
 400 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 401 	      diff $(srcdir)/result/xmlid/$$name result.$$name ; \
 402 	      diff $(srcdir)/result/xmlid/$$name.err error.$$name` ; \
 403 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 404 	      rm result.$$name error.$$name ; \
 405 	  fi ; fi ; done)
 406 
 407 Errtests : xmllint$(EXEEXT)
 408 	@(echo &gt; .memdump)
 409 	@echo &quot;## Error cases regression tests&quot;
 410 	-@(for i in $(srcdir)/test/errors/*.xml ; do \
 411 	  name=`basename $$i`; \
 412 	  if [ ! -d $$i ] ; then \
 413 	  if [ ! -f $(srcdir)/result/errors/$$name ] ; then \
 414 	      echo New test file $$name ; \
 415 	      $(CHECKER) $(top_builddir)/xmllint $$i \
 416 	         2&gt; $(srcdir)/result/errors/$$name.err \
 417 		 &gt; $(srcdir)/result/errors/$$name ; \
 418 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 419 	  else \
 420 	      log=`$(CHECKER) $(top_builddir)/xmllint $$i 2&gt; error.$$name &gt; result.$$name ; \
 421 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 422 	      diff $(srcdir)/result/errors/$$name result.$$name ; \
 423 	      diff $(srcdir)/result/errors/$$name.err error.$$name` ; \
 424 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 425 	      rm result.$$name error.$$name ; \
 426 	  fi ; fi ; done)
 427 	@echo &quot;## Error cases regression tests (old 1.0)&quot;
 428 	-@(for i in $(srcdir)/test/errors10/*.xml ; do \
 429 	  name=`basename $$i`; \
 430 	  if [ ! -d $$i ] ; then \
 431 	  if [ ! -f $(srcdir)/result/errors10/$$name ] ; then \
 432 	      echo New test file $$name ; \
 433 	      $(CHECKER) $(top_builddir)/xmllint --oldxml10 $$i \
 434 	         2&gt; $(srcdir)/result/errors10/$$name.err \
 435 		 &gt; $(srcdir)/result/errors10/$$name ; \
 436 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 437 	  else \
 438 	      log=`$(CHECKER) $(top_builddir)/xmllint --oldxml10 $$i 2&gt; error.$$name &gt; result.$$name ; \
 439 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 440 	      diff $(srcdir)/result/errors10/$$name result.$$name ; \
 441 	      diff $(srcdir)/result/errors10/$$name.err error.$$name` ; \
 442 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 443 	      rm result.$$name error.$$name ; \
 444 	  fi ; fi ; done)
 445 	@echo &quot;## Error cases stream regression tests&quot;
 446 	-@(for i in $(srcdir)/test/errors/*.xml ; do \
 447 	  name=`basename $$i`; \
 448 	  if [ ! -d $$i ] ; then \
 449 	  if [ ! -f $(srcdir)/result/errors/$$name.str ] ; then \
 450 	      echo New test file $$name ; \
 451 	      $(CHECKER) $(top_builddir)/xmllint --stream $$i \
 452 	         2&gt; $(srcdir)/result/errors/$$name.str \
 453 		 &gt; /dev/null ; \
 454 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 455 	  else \
 456 	      log=`$(CHECKER) $(top_builddir)/xmllint --stream $$i 2&gt; error.$$name &gt; /dev/null ; \
 457 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 458 	      diff $(srcdir)/result/errors/$$name.str error.$$name` ; \
 459 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 460 	      rm error.$$name ; \
 461 	  fi ; fi ; done)
 462 
 463 Docbtests : xmllint$(EXEEXT)
 464 
 465 XMLenttests : xmllint$(EXEEXT)
 466 	@(echo &gt; .memdump)
 467 	@echo &quot;## XML entity subst regression tests&quot;
 468 	-@(for i in $(srcdir)/test/* ; do \
 469 	  name=`basename $$i`; \
 470 	  if [ ! -d $$i ] ; then \
 471 	  if [ ! -f $(srcdir)/result/noent/$$name ] ; then \
 472 	      echo New test file $$name ; \
 473 	      $(CHECKER) $(top_builddir)/xmllint --noent $$i &gt; $(srcdir)/result/noent/$$name ; \
 474 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 475 	  else \
 476 	      log=`$(CHECKER) $(top_builddir)/xmllint --noent $$i 2&gt;&amp;1 &gt; result.$$name ; \
 477 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 478 	      diff $(srcdir)/result/noent/$$name result.$$name ; \
 479 	      $(CHECKER) $(top_builddir)/xmllint --noent result.$$name 2&gt;&amp;1 &gt; result2.$$name ; \
 480 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 481 	      diff result.$$name result2.$$name` ; \
 482 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 483 	      rm result.$$name result2.$$name ; \
 484 	  fi ; fi ; done)
 485 
 486 URItests : testURI$(EXEEXT)
 487 	@(echo &gt; .memdump)
 488 	@echo &quot;## URI module regression tests&quot;
 489 	-@(for i in $(srcdir)/test/URI/*.data ; do \
 490 	  name=`basename $$i`; \
 491 	  if [ ! -d $$i ] ; then \
 492 	  if [ ! -f $(srcdir)/result/URI/$$name ] ; then \
 493 	      echo New test file $$name ; \
 494 	      $(CHECKER) $(top_builddir)/testURI -base &#39;http://foo.com/path/to/index.html?orig#help&#39; &lt; $$i &gt; $(srcdir)/result/URI/$$name ; \
 495 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 496 	  else \
 497 	      log=`$(CHECKER) $(top_builddir)/testURI -base &#39;http://foo.com/path/to/index.html?orig#help&#39; &lt; $$i 2&gt;&amp;1 &gt; result.$$name ; \
 498 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 499 	      diff $(srcdir)/result/URI/$$name result.$$name` ; \
 500 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 501 	      rm result.$$name ; \
 502 	  fi ; fi ; done)
 503 	-@(for i in $(srcdir)/test/URI/*.uri ; do \
 504 	  name=`basename $$i`; \
 505 	  if [ ! -d $$i ] ; then \
 506 	  if [ ! -f $(srcdir)/result/URI/$$name ] ; then \
 507 	      echo New test file $$name ; \
 508 	      $(CHECKER) $(top_builddir)/testURI &lt; $$i &gt; $(srcdir)/result/URI/$$name ; \
 509 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 510 	  else \
 511 	      log=`$(CHECKER) $(top_builddir)/testURI &lt; $$i 2&gt;&amp;1 &gt; result.$$name ; \
 512 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 513 	      diff $(srcdir)/result/URI/$$name result.$$name` ; \
 514 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 515 	      rm result.$$name ; \
 516 	  fi ; fi ; done)
 517 
 518 XPathtests : testXPath$(EXEEXT)
 519 	@(echo &gt; .memdump)
 520 	@echo &quot;## XPath regression tests&quot;
 521 	-@(if [ &quot;`$(top_builddir)/testXPath | grep &#39;support not compiled in&#39;`&quot; != &quot;&quot; ] ; \
 522 	  then echo Skipping debug not compiled in ; exit 0 ; fi ; \
 523 	  for i in $(srcdir)/test/XPath/expr/* ; do \
 524 	  name=`basename $$i`; \
 525 	  if [ ! -d $$i ] ; then \
 526 	  if [ ! -f $(srcdir)/result/XPath/expr/$$name ] ; then \
 527 	      echo New test file $$name ; \
 528 	      $(CHECKER) $(top_builddir)/testXPath -f --expr $$i &gt; $(srcdir)/result/XPath/expr/$$name 2&gt; /dev/null ; \
 529 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 530 	  else \
 531 	      log=`$(CHECKER) $(top_builddir)/testXPath -f --expr $$i &gt; result.$$name 2&gt; /dev/null ; \
 532 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 533 	      diff $(srcdir)/result/XPath/expr/$$name result.$$name` ; \
 534 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 535 	      rm result.$$name ; \
 536 	  fi ; fi ; done ; \
 537 	  for i in $(srcdir)/test/XPath/docs/* ; do \
 538 	  if [ ! -d $$i ] ; then \
 539 	  doc=`basename $$i`; \
 540 	  for j in $(srcdir)/test/XPath/tests/$$doc* ; do \
 541 	  if [ ! -f $$j ] ; then continue ; fi ; \
 542 	  name=`basename $$j`; \
 543 	  if [ ! -d $$j ] ; then \
 544 	  if [ ! -f $(srcdir)/result/XPath/tests/$$name ] ; then \
 545 	      echo New test file $$name ; \
 546 	      $(CHECKER) $(top_builddir)/testXPath -f -i $$i $$j &gt; $(srcdir)/result/XPath/tests/$$name ; \
 547 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 548 	  else \
 549 	      log=`$(CHECKER) $(top_builddir)/testXPath -f -i $$i $$j &gt; result.$$name ; \
 550 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 551 	      diff $(srcdir)/result/XPath/tests/$$name result.$$name` ; \
 552 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 553 	      rm result.$$name ; \
 554 	  fi ; fi ; done ; fi ; done)
 555 
 556 XPtrtests : testXPath$(EXEEXT)
 557 	@(echo &gt; .memdump)
 558 	@echo &quot;## XPointer regression tests&quot;
 559 	-@(if [ &quot;`$(top_builddir)/testXPath | grep &#39;support not compiled in&#39;`&quot; != &quot;&quot; ] ; \
 560 	  then echo Skipping debug not compiled in ; exit 0 ; fi ; \
 561 	  for i in $(srcdir)/test/XPath/docs/* ; do \
 562 	  if [ ! -d $$i ] ; then \
 563 	  doc=`basename $$i`; \
 564 	  for j in $(srcdir)/test/XPath/xptr/$$doc* ; do \
 565 	  if [ ! -f $$j ] ; then continue ; fi ; \
 566 	  name=`basename $$j`; \
 567 	  if [ ! -d $$j ] ; then \
 568 	  if [ ! -f $(srcdir)/result/XPath/xptr/$$name ] ; then \
 569 	      echo New test file $$name ; \
 570 	      $(CHECKER) $(top_builddir)/testXPath -xptr -f -i $$i $$j &gt; $(srcdir)/result/XPath/xptr/$$name 2&gt; /dev/null ; \
 571 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 572 	  else \
 573 	      log=`$(CHECKER) $(top_builddir)/testXPath -xptr -f -i $$i $$j &gt; result.$$name 2&gt; /dev/null ; \
 574 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 575 	      diff $(srcdir)/result/XPath/xptr/$$name result.$$name` ; \
 576 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 577 	      rm result.$$name ; \
 578 	  fi ; fi ; done ; fi ; done)
 579 
 580 XIncludetests : xmllint$(EXEEXT)
 581 	@(echo &gt; .memdump)
 582 	@echo &quot;## XInclude regression tests&quot;
 583 	-@(for i in $(srcdir)/test/XInclude/docs/* ; do \
 584 	  name=`basename $$i`; \
 585 	  if [ ! -d $$i ] ; then \
 586 	  if [ ! -f $(srcdir)/result/XInclude/$$name ] ; then \
 587 	      echo New test file $$name ; \
 588 	      $(CHECKER) $(top_builddir)/xmllint --nowarning --xinclude $$i &gt; $(srcdir)/result/XInclude/$$name 2&gt; $(srcdir)/result/XInclude/$$name.err ; \
 589 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 590 	  else \
 591 	      log=`$(CHECKER) $(top_builddir)/xmllint --nowarning --xinclude $$i &gt; result.$$name 2&gt;error.$$name ; \
 592 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 593 	      diff $(srcdir)/result/XInclude/$$name result.$$name ; \
 594 	      diff $(srcdir)/result/XInclude/$$name.err error.$$name` ; \
 595 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 596 	      rm result.$$name error.$$name ; \
 597 	  fi ; fi ; done)
 598 	-@(for i in $(srcdir)/test/XInclude/docs/* ; do \
 599 	  name=`basename $$i`; \
 600 	  if [ ! -d $$i ] ; then \
 601 	  if [ ! -f $(srcdir)/result/XInclude/$$name ] ; then \
 602 	      echo New test file $$name ; \
 603 	      $(CHECKER) $(top_builddir)/xmllint --nowarning --noxincludenode $$i &gt; $(srcdir)/result/XInclude/$$name 2&gt; $(srcdir)/result/XInclude/$$name.err ; \
 604 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 605 	  else \
 606 	      log=`$(CHECKER) $(top_builddir)/xmllint --nowarning --noxincludenode $$i &gt; result.$$name 2&gt;error.$$name ; \
 607 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 608 	      diff $(srcdir)/result/XInclude/$$name result.$$name ; \
 609 	      diff $(srcdir)/result/XInclude/$$name.err error.$$name` ; \
 610 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 611 	      rm result.$$name error.$$name ; \
 612 	  fi ; fi ; done)
 613 	@(echo &gt; .memdump)
 614 	@echo &quot;## XInclude xmlReader regression tests&quot;
 615 	-@(for i in $(srcdir)/test/XInclude/docs/* ; do \
 616 	  name=`basename $$i`; \
 617 	  if [ ! -d $$i ] ; then \
 618 	  if [ ! -f $(srcdir)/result/XInclude/$$name.rdr ] ; then \
 619 	      echo New test file $$name ; \
 620 	      $(CHECKER) $(top_builddir)/xmllint --nowarning --xinclude --stream --debug $$i &gt; $(srcdir)/result/XInclude/$$name.rdr ; \
 621 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 622 	  else \
 623 	      log=`$(CHECKER) $(top_builddir)/xmllint --nowarning --xinclude --stream --debug $$i &gt; result.$$name 2&gt;error.$$name ; \
 624 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 625 	      diff $(srcdir)/result/XInclude/$$name.err error.$$name ; \
 626 	      diff $(srcdir)/result/XInclude/$$name.rdr result.$$name` ; \
 627 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 628 	      rm result.$$name error.$$name ; \
 629 	  fi ; fi ; done)
 630 	-@(for i in $(srcdir)/test/XInclude/docs/* ; do \
 631 	  name=`basename $$i`; \
 632 	  if [ ! -d $$i ] ; then \
 633 	  if [ ! -f $(srcdir)/result/XInclude/$$name.rdr ] ; then \
 634 	      echo New test file $$name ; \
 635 	      $(CHECKER) $(top_builddir)/xmllint --nowarning --noxincludenode --stream --debug $$i &gt; $(srcdir)/result/XInclude/$$name.rdr ; \
 636 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 637 	  else \
 638 	      log=`$(CHECKER) $(top_builddir)/xmllint --nowarning --xinclude --stream --debug $$i &gt; result.$$name 2&gt;error.$$name ; \
 639 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 640 	      diff $(srcdir)/result/XInclude/$$name.err error.$$name ; \
 641 	      diff $(srcdir)/result/XInclude/$$name.rdr result.$$name` ; \
 642 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 643 	      rm result.$$name error.$$name ; \
 644 	  fi ; fi ; done)
 645 
 646 Scripttests : xmllint$(EXEEXT)
 647 	@(echo &gt; .memdump)
 648 	@echo &quot;## Scripts regression tests&quot;
 649 	@echo &quot;## Some of the base computations may be different if srcdir != .&quot;
 650 	-@(for i in $(srcdir)/test/scripts/*.script ; do \
 651 	  name=`basename $$i .script`; \
 652 	  xml=$(srcdir)/test/scripts/`basename $$i .script`.xml; \
 653 	  if [ -f $$xml ] ; then \
 654 	  if [ ! -f $(srcdir)/result/scripts/$$name ] ; then \
 655 	      echo New test file $$name ; \
 656 	      $(CHECKER) $(top_builddir)/xmllint --shell $$xml &lt; $$i &gt; $(srcdir)/result/scripts/$$name 2&gt; $(srcdir)/result/scripts/$$name.err ; \
 657 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 658 	  else \
 659 	      log=`$(CHECKER) $(top_builddir)/xmllint --shell $$xml &lt; $$i &gt; result.$$name 2&gt; result.$$name.err ; \
 660 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 661 	      diff $(srcdir)/result/scripts/$$name result.$$name ; \
 662 	      diff $(srcdir)/result/scripts/$$name.err result.$$name.err` ; \
 663 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 664 	      rm result.$$name result.$$name.err ; \
 665 	  fi ; fi ; done)
 666 
 667 Catatests : xmlcatalog$(EXEEXT)
 668 	@(echo &gt; .memdump)
 669 	@echo &quot;## Catalog regression tests&quot;
 670 	-@(for i in $(srcdir)/test/catalogs/*.script ; do \
 671 	  name=`basename $$i .script`; \
 672 	  xml=$(srcdir)/test/catalogs/`basename $$i .script`.xml; \
 673 	  if [ -f $$xml ] ; then \
 674 	  if [ ! -f $(srcdir)/result/catalogs/$$name ] ; then \
 675 	      echo New test file $$name ; \
 676 	      $(CHECKER) $(top_builddir)/xmlcatalog --shell $$xml &lt; $$i 2&gt;&amp;1 &gt; $(srcdir)/result/catalogs/$$name ; \
 677 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 678 	  else \
 679 	      log=`$(CHECKER) $(top_builddir)/xmlcatalog --shell $$xml &lt; $$i 2&gt;&amp;1 &gt; result.$$name ; \
 680 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 681 	      diff $(srcdir)/result/catalogs/$$name result.$$name` ; \
 682 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 683 	      rm result.$$name ; \
 684 	  fi ; fi ; done)
 685 	-@(for i in $(srcdir)/test/catalogs/*.script ; do \
 686 	  name=`basename $$i .script`; \
 687 	  sgml=$(srcdir)/test/catalogs/`basename $$i .script`.sgml; \
 688 	  if [ -f $$sgml ] ; then \
 689 	  if [ ! -f $(srcdir)/result/catalogs/$$name ] ; then \
 690 	      echo New test file $$name ; \
 691 	      $(CHECKER) $(top_builddir)/xmlcatalog --shell $$sgml &lt; $$i &gt; $(srcdir)/result/catalogs/$$name ; \
 692 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 693 	  else \
 694 	      log=`$(CHECKER) $(top_builddir)/xmlcatalog --shell $$sgml &lt; $$i &gt; result.$$name ; \
 695 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 696 	      diff $(srcdir)/result/catalogs/$$name result.$$name` ; \
 697 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 698 	      rm result.$$name ; \
 699 	  fi ; fi ; done)
 700 	@echo &quot;## Add and del operations on XML Catalogs&quot;
 701 	-@($(CHECKER) $(top_builddir)/xmlcatalog --create --noout $(srcdir)/result/catalogs/mycatalog; \
 702 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 703 	$(CHECKER) $(top_builddir)/xmlcatalog --noout --add public Pubid sysid $(srcdir)/result/catalogs/mycatalog; \
 704 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 705 	$(CHECKER) $(top_builddir)/xmlcatalog --noout --add public Pubid2 sysid2 $(srcdir)/result/catalogs/mycatalog; \
 706 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 707 	$(CHECKER) $(top_builddir)/xmlcatalog --noout --add public Pubid3 sysid3 $(srcdir)/result/catalogs/mycatalog; \
 708 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 709 	diff result/catalogs/mycatalog.full $(srcdir)/result/catalogs/mycatalog; \
 710 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 711 	$(CHECKER) $(top_builddir)/xmlcatalog --noout --del sysid $(srcdir)/result/catalogs/mycatalog; \
 712 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 713 	$(CHECKER) $(top_builddir)/xmlcatalog --noout --del sysid3 $(srcdir)/result/catalogs/mycatalog; \
 714 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 715 	$(CHECKER) $(top_builddir)/xmlcatalog --noout --del sysid2 $(srcdir)/result/catalogs/mycatalog; \
 716 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 717 	diff result/catalogs/mycatalog.empty $(srcdir)/result/catalogs/mycatalog; \
 718 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 719 	rm -f $(srcdir)/result/catalogs/mycatalog)
 720 
 721 SVGtests : xmllint$(EXEEXT)
 722 	@echo &quot;## SVG parsing regression tests&quot;
 723 	-@(for i in $(srcdir)/test/SVG/* ; do \
 724 	  name=`basename $$i`; \
 725 	  if [ ! -d $$i ] ; then \
 726 	  if [ ! -f $(srcdir)/result/SVG/$$name ] ; then \
 727 	      echo New test file $$name ; \
 728 	      $(CHECKER) $(top_builddir)/xmllint $$i &gt; $(srcdir)/result/SVG/$$name ; \
 729 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 730 	  else \
 731 	      echo Testing $$name ; \
 732 	      $(CHECKER) $(top_builddir)/xmllint $$i &gt; result.$$name ; \
 733 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 734 	      diff $(srcdir)/result/SVG/$$name result.$$name ; \
 735 	      $(CHECKER) $(top_builddir)/xmllint result.$$name &gt; result2.$$name ; \
 736 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 737 	      diff result.$$name result2.$$name ; \
 738 	      rm result.$$name result2.$$name ; \
 739 	  fi ; fi ; done)
 740 
 741 Threadtests : testThreads$(EXEEXT)
 742 	@echo &quot;## Threaded regression tests&quot;
 743 	-@($(CHECKER) $(top_builddir)/testThreads ; \
 744 	   grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 745 	   exit 0)
 746 
 747 Readertests : xmllint$(EXEEXT)
 748 	@(echo &gt; .memdump)
 749 	@echo &quot;## Reader regression tests&quot;
 750 	-@(for i in $(srcdir)/test/* ; do \
 751 	  name=`basename $$i`; \
 752 	  if [ ! -d $$i ] ; then \
 753 	  if [ ! -f $(srcdir)/result/$$name.rdr ] ; then \
 754 	      echo New test file $$name ; \
 755 	      $(CHECKER) $(top_builddir)/xmllint --nonet --debug --stream $$i &gt; $(srcdir)/result/$$name.rdr 2&gt;/dev/null ; \
 756 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 757 	  else \
 758 	      log=`$(CHECKER) $(top_builddir)/xmllint --nonet --debug --stream $$i &gt; result.$$name 2&gt;/dev/null ; \
 759 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 760 	      diff $(srcdir)/result/$$name.rdr result.$$name` ; \
 761 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 762 	      rm result.$$name ; \
 763 	  fi ; fi ; done)
 764 	@echo &quot;## Reader on memory regression tests&quot;
 765 	-@(for i in $(srcdir)/test/* ; do \
 766 	  name=`basename $$i`; \
 767 	  if [ ! -d $$i ] ; then \
 768 	  if [ ! -f $(srcdir)/result/$$name.rdr ] ; then \
 769 	      echo New test file $$name ; \
 770 	      $(CHECKER) $(top_builddir)/xmllint --memory --nonet --debug --stream $$i &gt; $(srcdir)/result/$$name.rdr 2&gt;/dev/null ; \
 771 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 772 	  else \
 773 	      log=`$(CHECKER) $(top_builddir)/xmllint --memory --nonet --debug --stream $$i &gt; result.$$name 2&gt;/dev/null ; \
 774 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 775 	      diff $(srcdir)/result/$$name.rdr result.$$name` ; \
 776 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 777 	      rm result.$$name ; \
 778 	  fi ; fi ; done)
 779 	@(echo &gt; .memdump)
 780 	@echo &quot;## Walker regression tests&quot;
 781 	-@(for i in $(srcdir)/test/* ; do \
 782 	  name=`basename $$i`; \
 783 	  if [ ! -d $$i ] ; then \
 784 	  if [ ! -f $(srcdir)/result/$$name.rdr ] ; then \
 785 	      echo New test file $$name ; \
 786 	      $(CHECKER) $(top_builddir)/xmllint --nonet --debug --walker $$i &gt; $(srcdir)/result/$$name.rdr 2&gt;/dev/null ; \
 787 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 788 	  else \
 789 	      log=`$(CHECKER) $(top_builddir)/xmllint --nonet --debug --walker $$i &gt; result.$$name 2&gt;/dev/null ; \
 790 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 791 	      diff $(srcdir)/result/$$name.rdr result.$$name` ; \
 792 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 793 	      rm result.$$name ; \
 794 	  fi ; fi ; done)
 795 	@echo &quot;## Reader entities substitution regression tests&quot;
 796 	-@(for i in $(srcdir)/test/* ; do \
 797 	  name=`basename $$i`; \
 798 	  if [ ! -d $$i ] ; then \
 799 	  if [ ! -f $(srcdir)/result/$$name.rde ] ; then \
 800 	      echo New test file $$name ; \
 801 	      $(CHECKER) $(top_builddir)/xmllint --noent --nonet --debug --stream $$i &gt; $(srcdir)/result/$$name.rde 2&gt;/dev/null ; \
 802 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 803 	  else \
 804 	      log=`$(CHECKER) $(top_builddir)/xmllint --noent --nonet --debug --stream $$i &gt; result.$$name 2&gt;/dev/null ; \
 805 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 806 	      diff $(srcdir)/result/$$name.rde result.$$name` ; \
 807 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 808 	      rm result.$$name ; \
 809 	  fi ; fi ; done)
 810 
 811 SAXtests : testSAX$(EXEEXT)
 812 	@(echo &gt; .memdump)
 813 	@echo &quot;## SAX1 callbacks regression tests&quot;
 814 	-@(for i in $(srcdir)/test/* ; do \
 815 	  name=`basename $$i`; \
 816 	  if [ ! -d $$i ] ; then \
 817 	  if [ ! -f $(srcdir)/result/$$name.sax ] ; then \
 818 	      echo New test file $$name ; \
 819 	      $(CHECKER) $(top_builddir)/testSAX $$i &gt; $(srcdir)/result/$$name.sax 2&gt; /dev/null ; \
 820 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 821 	  else \
 822 	      log=`$(CHECKER) $(top_builddir)/testSAX $$i &gt; result.$$name 2&gt; /dev/null ; \
 823 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 824 	      diff $(srcdir)/result/$$name.sax result.$$name` ; \
 825 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 826 	      rm result.$$name ; \
 827 	  fi ; fi ; done)
 828 	@echo &quot;## SAX2 callbacks regression tests&quot;
 829 	-@(for i in $(srcdir)/test/* ; do \
 830 	  name=`basename $$i`; \
 831 	  if [ ! -d $$i ] ; then \
 832 	  if [ ! -f $(srcdir)/result/$$name.sax2 ] ; then \
 833 	      echo New test file $$name ; \
 834 	      $(CHECKER) $(top_builddir)/testSAX --sax2 $$i &gt; $(srcdir)/result/$$name.sax2 2&gt; /dev/null ; \
 835 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 836 	  else \
 837 	      log=`$(CHECKER) $(top_builddir)/testSAX --sax2 $$i &gt; result.$$name 2&gt; /dev/null ; \
 838 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 839 	      diff $(srcdir)/result/$$name.sax2 result.$$name` ; \
 840 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 841 	      rm result.$$name ; \
 842 	  fi ; fi ; done)
 843 	@echo &quot;## SAX2 callbacks regression tests with entity substitution&quot;
 844 	-@(for i in $(srcdir)/test/* ; do \
 845 	  name=`basename $$i`; \
 846 	  if [ ! -d $$i ] ; then \
 847 	  if [ ! -f $(srcdir)/result/noent/$$name.sax2 ] ; then \
 848 	      echo New test file $$name ; \
 849 	      $(CHECKER) $(top_builddir)/testSAX --sax2 --noent $$i &gt; $(srcdir)/result/noent/$$name.sax2 2&gt; /dev/null ; \
 850 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 851 	  else \
 852 	      log=`$(CHECKER) $(top_builddir)/testSAX --sax2 --noent $$i &gt; result.$$name 2&gt; /dev/null ; \
 853 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 854 	      diff $(srcdir)/result/noent/$$name.sax2 result.$$name` ; \
 855 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 856 	      rm result.$$name ; \
 857 	  fi ; fi ; done)
 858 
 859 Validtests : xmllint$(EXEEXT)
 860 	@(echo &gt; .memdump)
 861 	@echo &quot;## Valid documents regression tests&quot;
 862 	-@(for i in $(srcdir)/test/VCM/* ; do \
 863 	  name=`basename $$i`; \
 864 	  if [ ! -d $$i ] ; then \
 865 	      log=`$(CHECKER) $(top_builddir)/xmllint --valid --noout --nowarning $$i ; \
 866 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;`;\
 867 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 868 	  fi ; done ; exit 0)
 869 	@echo &quot;## Validity checking regression tests&quot;
 870 	-@(for i in $(srcdir)/test/VC/* ; do \
 871 	  name=`basename $$i`; \
 872 	  if [ ! -d $$i ] ; then \
 873 	  if [ ! -f $(srcdir)/result/VC/$$name ] ; then \
 874 	      echo New test file $$name ; \
 875 	      $(CHECKER) $(top_builddir)/xmllint --noout --valid $$i 2&gt; $(srcdir)/result/VC/$$name ; \
 876 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 877 	  else \
 878 	      log=`$(CHECKER) $(top_builddir)/xmllint --noout --valid $$i 2&gt; result.$$name ; \
 879 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 880 	      diff $(srcdir)/result/VC/$$name result.$$name` ; \
 881 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 882 	      rm result.$$name ; \
 883 	  fi ; fi ; done)
 884 	@echo &quot;## General documents valid regression tests&quot;
 885 	-@(for i in $(srcdir)/test/valid/* ; do \
 886 	  name=`basename $$i`; \
 887 	  if [ ! -d $$i ] ; then \
 888 	  if [ ! -f $(srcdir)/result/valid/$$name ] ; then \
 889 	      echo New test file $$name ; \
 890 	      $(CHECKER) $(top_builddir)/xmllint --valid $$i &gt; $(srcdir)/result/valid/$$name 2&gt;$(srcdir)/result/valid/$$name.err ; \
 891 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 892 	  else \
 893 	      log=`$(CHECKER) $(top_builddir)/xmllint --valid $$i &gt; result.$$name 2&gt;error.$$name ; \
 894 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 895 	      diff $(srcdir)/result/valid/$$name result.$$name ; \
 896 	      diff $(srcdir)/result/valid/$$name.err error.$$name` ; \
 897 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 898 	      rm result.$$name error.$$name ; \
 899 	  fi ; fi ; done)
 900 
 901 Regexptests: testRegexp$(EXEEXT)
 902 	@(echo &gt; .memdump)
 903 	@echo &quot;## Regexp regression tests&quot;
 904 	-@(for i in $(srcdir)/test/regexp/* ; do \
 905 	  name=`basename $$i`; \
 906 	  if [ ! -d $$i ] ; then \
 907 	  if [ ! -f $(srcdir)/result/regexp/$$name ] ; then \
 908 	      echo New test file $$name ; \
 909 	      $(CHECKER) $(top_builddir)/testRegexp -i $$i &gt; $(srcdir)/result/regexp/$$name; \
 910 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 911 	  else \
 912 	      log=`$(CHECKER) $(top_builddir)/testRegexp -i $$i 2&gt;&amp;1 &gt; result.$$name ; \
 913 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 914 	      diff $(srcdir)/result/regexp/$$name result.$$name` ; \
 915 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 916 	      rm result.$$name ; \
 917 	  fi ; fi ; done)
<a name="3" id="anc3"></a><span class="line-added"> 918 </span>
<span class="line-added"> 919 # Disabled for now</span>
<span class="line-added"> 920 Exptests: testRegexp$(EXEEXT)</span>
 921 	@echo &quot;## Formal expresssions regression tests&quot;
 922 	-@(for i in $(srcdir)/test/expr/* ; do \
 923 	  name=`basename $$i`; \
 924 	  if [ ! -d $$i ] ; then \
 925 	  if [ ! -f $(srcdir)/result/expr/$$name ] ; then \
 926 	      echo New test file $$name ; \
 927 	      $(CHECKER) $(top_builddir)/testRegexp --expr -i $$i &gt; $(srcdir)/result/expr/$$name; \
 928 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 929 	  else \
 930 	      log=`$(CHECKER) $(top_builddir)/testRegexp --expr -i $$i 2&gt;&amp;1 &gt; result.$$name ; \
 931 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 932 	      diff $(srcdir)/result/expr/$$name result.$$name` ; \
 933 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 934 	      rm result.$$name ; \
 935 	  fi ; fi ; done)
 936 
 937 Automatatests: testAutomata$(EXEEXT)
 938 	@(echo &gt; .memdump)
 939 	@echo &quot;## Automata regression tests&quot;
 940 	-@(for i in $(srcdir)/test/automata/* ; do \
 941 	  name=`basename $$i`; \
 942 	  if [ ! -d $$i ] ; then \
 943 	  if [ ! -f $(srcdir)/result/automata/$$name ] ; then \
 944 	      echo New test file $$name ; \
 945 	      $(CHECKER) $(top_builddir)/testAutomata $$i &gt; $(srcdir)/result/automata/$$name; \
 946 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 947 	  else \
 948 	      log=`$(CHECKER) $(top_builddir)/testAutomata $$i 2&gt;&amp;1 &gt; result.$$name ; \
 949 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 950 	      diff $(srcdir)/result/automata/$$name result.$$name` ; \
 951 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 952 	      rm result.$$name ; \
 953 	  fi ; fi ; done)
 954 
 955 dba100000.xml: dbgenattr.pl
 956 	@echo &quot;## generating dba100000.xml&quot;
 957 	@($(PERL) $(top_srcdir)/dbgenattr.pl 100000 &gt; dba100000.xml)
 958 
 959 Timingtests: xmllint$(EXEEXT) dba100000.xml
 960 	@echo &quot;## Timing tests to try to detect performance&quot;
 961 	@echo &quot;## as well a memory usage breakage when streaming&quot;
 962 	@echo &quot;## 1/ using the file interface&quot;
 963 	@echo &quot;## 2/ using the memory interface&quot;
 964 	@echo &quot;## 3/ repeated DOM parsing&quot;
 965 	@echo &quot;## 4/ repeated DOM validation&quot;
 966 	-@($(top_builddir)/xmllint --stream --timing dba100000.xml; \
 967 	   MEM=`cat .memdump | grep &quot;MEMORY ALLOCATED&quot; | awk &#39;{ print $$7}&#39;`;\
 968 	   if [ &quot;$$MEM&quot; != &quot;&quot; ] ; then echo Using $$MEM bytes ; fi ; \
 969 	   grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 970 	   exit 0)
 971 	-@($(top_builddir)/xmllint --stream --timing --memory dba100000.xml; \
 972 	   MEM=`cat .memdump | grep &quot;MEMORY ALLOCATED&quot; | awk &#39;{ print $$7}&#39;`;\
 973 	   if [ &quot;$$MEM&quot; != &quot;&quot; ] ; then echo Using $$MEM bytes ; fi ; \
 974 	   grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 975 	   exit 0)
 976 	-@($(top_builddir)/xmllint --noout --timing --repeat $(srcdir)/test/valid/REC-xml-19980210.xml; \
 977 	   MEM=`cat .memdump | grep &quot;MEMORY ALLOCATED&quot; | awk &#39;{ print $$7}&#39;`;\
 978 	   if [ &quot;$$MEM&quot; != &quot;&quot; ] ; then echo Using $$MEM bytes ; fi ; \
 979 	   grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 980 	   exit 0)
 981 
 982 VTimingtests: xmllint$(EXEEXT)
 983 	-@($(top_builddir)/xmllint --noout --timing --valid --repeat $(srcdir)/test/valid/REC-xml-19980210.xml; \
 984 	   MEM=`cat .memdump | grep &quot;MEMORY ALLOCATED&quot; | awk &#39;{ print $$7}&#39;`;\
 985 	   if [ &quot;$$MEM&quot; != &quot;&quot; ] ; then echo Using $$MEM bytes ; fi ; \
 986 	   grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 987 	   exit 0)
 988 
 989 C14Ntests : testC14N$(EXEEXT)
 990 	@echo &quot;## C14N and XPath regression tests&quot;
 991 	-@(for m in with-comments without-comments 1-1-without-comments exc-without-comments ; do \
 992 	    for i in $(srcdir)/test/c14n/$$m/*.xml ; do  \
 993 		if [ ! -d $$i ] ; then \
 994 		    name=`basename $$i .xml`; \
 995 		    cmdline=&quot;$(CHECKER) $(top_builddir)/testC14N --$$m $$i&quot;; \
 996 		    if [ -f $(srcdir)/test/c14n/$$m/$$name.xpath ] ; then \
 997 			cmdline=&quot;$$cmdline $(srcdir)/test/c14n/$$m/$$name.xpath&quot;; \
 998 			if [ -f $(srcdir)/test/c14n/$$m/$$name.ns ] ; then \
 999 			    cmdline=&quot;$$cmdline &#39;`cat $(srcdir)/test/c14n/$$m/$$name.ns`&#39;&quot;; \
1000 			fi; \
1001 		    fi; \
1002 		    $$cmdline &gt; $(srcdir)/test/c14n/test.tmp 2&gt; /dev/null; \
1003 		    if [ $$? -eq 0 ]; then \
1004 			diff  $(srcdir)/result/c14n/$$m/$$name $(srcdir)/test/c14n/test.tmp; \
1005 			if [ $$? -ne 0 ]; then \
1006 			    echo &quot;Test $$m/$$name failed&quot;; \
1007 			    cat $(srcdir)/test/c14n/test.tmp; \
1008 			fi; \
1009 		    else \
1010 			echo &quot;C14N failed&quot;; \
1011 		    fi; \
1012 		    grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1013 		fi; \
1014 		rm -f $(srcdir)/test/c14n/test.tmp; \
1015 	    done; \
1016 	done)
1017 
1018 Schemastests: testSchemas$(EXEEXT)
1019 	@(echo &gt; .memdump)
1020 	@echo &quot;## Schemas regression tests&quot;
1021 	-@(for i in $(srcdir)/test/schemas/*_*.xsd ; do \
1022 	  name=`basename $$i | sed &#39;s+_.*++&#39;`; \
1023 	  sno=`basename $$i | sed &#39;s+.*_\(.*\).xsd+\1+&#39;`; \
1024 	  for j in $(srcdir)/test/schemas/&quot;$$name&quot;_*.xml ; do \
1025 	      if [ -f $$j ] ; then \
1026 	      xno=`basename $$j | sed &#39;s+.*_\(.*\).xml+\1+&#39;`; \
1027 	      if [ ! -f $(srcdir)/result/schemas/&quot;$$name&quot;_&quot;$$sno&quot;_&quot;$$xno&quot; ]; \
1028 	      then \
1029 		  echo New test file &quot;$$name&quot;_&quot;$$sno&quot;_&quot;$$xno&quot; ; \
1030 		  $(CHECKER) $(top_builddir)/testSchemas $$i $$j \
1031 		    &gt; $(srcdir)/result/schemas/&quot;$$name&quot;_&quot;$$sno&quot;_&quot;$$xno&quot; \
1032 		    2&gt; $(srcdir)/result/schemas/&quot;$$name&quot;_&quot;$$sno&quot;_&quot;$$xno&quot;.err; \
1033 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1034 	      else \
1035 	          log=`$(CHECKER) $(top_builddir)/testSchemas $$i $$j \
1036 		    &gt; res.$$name 2&gt; err.$$name;\
1037 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1038 	          diff $(srcdir)/result/schemas/&quot;$$name&quot;_&quot;$$sno&quot;_&quot;$$xno&quot; \
1039 		       res.$$name;\
1040 	          diff $(srcdir)/result/schemas/&quot;$$name&quot;_&quot;$$sno&quot;_&quot;$$xno&quot;.err \
1041 		       err.$$name;\
1042 		  grep Unimplemented err.$$name`; \
1043 	          if [ -n &quot;$$log&quot; ] ; then echo &quot;$$name&quot;_&quot;$$sno&quot;_&quot;$$xno&quot; result ; echo &quot;$$log&quot; ; fi ; \
1044 	          rm res.$$name err.$$name ; \
1045 	       fi ; fi ;\
1046 	  done; done)
1047 
1048 Relaxtests: xmllint$(EXEEXT)
1049 	@(echo &gt; .memdump)
1050 	@echo &quot;## Relax-NG regression tests&quot;
1051 	-@(for i in $(srcdir)/test/relaxng/*.rng ; do \
1052 	  name=`basename $$i | sed &#39;s+\.rng++&#39;`; \
1053 	  if [ ! -f $(srcdir)/result/relaxng/&quot;$$name&quot;_valid ] ; then \
1054 	      echo New schemas $$name ; \
1055 	      $(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --noout --relaxng $(srcdir)/test/relaxng/tutorA.rng $$i \
1056 		      &gt; $(srcdir)/result/relaxng/&quot;$$name&quot;_valid \
1057 		      2&gt; $(srcdir)/result/relaxng/&quot;$$name&quot;_err; \
1058 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1059 	  else \
1060 	      log=`$(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --noout --relaxng $(srcdir)/test/relaxng/tutorA.rng $$i \
1061 	      &gt; res.$$name 2&gt; err.$$name;\
1062 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1063 	      diff $(srcdir)/result/relaxng/&quot;$$name&quot;_valid \
1064 		   res.$$name;\
1065 	      diff $(srcdir)/result/relaxng/&quot;$$name&quot;_err \
1066 		   err.$$name | grep -v &quot;error detected at&quot;;\
1067 	      grep Unimplemented err.$$name`; \
1068 	      if [ -n &quot;$$log&quot; ] ; then echo schemas $$name result ; echo &quot;$$log&quot; ; fi ; \
1069 	      rm res.$$name err.$$name ; \
1070 	  fi; \
1071 	  for j in $(srcdir)/test/relaxng/&quot;$$name&quot;_*.xml ; do \
1072 	      if [ -f $$j ] ; then \
1073 	      xno=`basename $$j | sed &#39;s+.*_\(.*\).xml+\1+&#39;`; \
1074 	      if [ ! -f $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot; ]; \
1075 	      then \
1076 		  echo New test file &quot;$$name&quot;_&quot;$$xno&quot; ; \
1077 		  $(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --noout --relaxng $$i $$j \
1078 		    &gt; $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot; \
1079 		    2&gt; $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot;.err; \
1080 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1081 	      else \
1082 	          log=`$(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --noout --relaxng $$i $$j \
1083 		    &gt; res.$$name 2&gt; err.$$name;\
1084 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1085 	          diff $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot; \
1086 		       res.$$name;\
1087 	          diff $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot;.err \
1088 		       err.$$name | grep -v &quot;error detected at&quot;;\
1089 		  grep Unimplemented err.$$name`; \
1090 		  if [ -n &quot;$$log&quot; ] ; then echo &quot;$$name&quot;_&quot;$$xno&quot; result ; echo &quot;$$log&quot; ; fi ; \
1091 	          rm res.$$name err.$$name ; \
1092 	       fi ; fi ; \
1093 	  done; done)
1094 	@echo &quot;## Relax-NG streaming regression tests&quot;
1095 	-@(for i in $(srcdir)/test/relaxng/*.rng ; do \
1096 	  name=`basename $$i | sed &#39;s+\.rng++&#39;`; \
1097 	  for j in $(srcdir)/test/relaxng/&quot;$$name&quot;_*.xml ; do \
1098 	      if [ -f $$j ] ; then \
1099 	      xno=`basename $$j | sed &#39;s+.*_\(.*\).xml+\1+&#39;`; \
1100 	      if [ ! -f $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot; ]; \
1101 	      then \
1102 		  echo New test file &quot;$$name&quot;_&quot;$$xno&quot; ; \
1103 		  $(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --noout --relaxng $$i $$j \
1104 		    &gt; $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot; \
1105 		    2&gt; $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot;.err; \
1106 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1107 	      else \
1108 	          log=`$(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --noout --stream --relaxng $$i $$j \
1109 		    &gt; res.$$name 2&gt; err.$$name;\
1110 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1111 	          diff $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot; res.$$name;\
1112 		  if [ &quot;$$name&quot; != &quot;tutor10_1&quot; -a &quot;$$name&quot; != &quot;tutor10_2&quot; -a &quot;$$name&quot; != &quot;tutor3_2&quot; -a &quot;$$name&quot; != &quot;307377&quot; -a &quot;$$name&quot; != &quot;tutor8_2&quot; ] ; then \
1113 		      diff $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot;.err \
1114 			   err.$$name | grep -v &quot;error detected at&quot;;\
1115 		  fi ; grep Unimplemented err.$$name`; \
1116 	          if [ -n &quot;$$log&quot; ] ; then echo &quot;$$name&quot;_&quot;$$xno&quot; result ; echo &quot;$$log&quot; ; fi ; \
1117 	          rm res.$$name err.$$name ; \
1118 	       fi ; fi ; \
1119 	  done; done)
1120 
1121 Schematrontests: xmllint$(EXEEXT)
1122 	@(echo &gt; .memdump)
1123 	@echo &quot;## Schematron regression tests&quot;
1124 	-@(for i in $(srcdir)/test/schematron/*.sct ; do \
1125 	  name=`basename $$i | sed &#39;s+\.sct++&#39;`; \
1126 	  for j in $(srcdir)/test/schematron/&quot;$$name&quot;_*.xml ; do \
1127 	      if [ -f $$j ] ; then \
1128 	      xno=`basename $$j | sed &#39;s+.*_\(.*\).xml+\1+&#39;`; \
1129 	      if [ ! -f $(srcdir)/result/schematron/&quot;$$name&quot;_&quot;$$xno&quot; ]; \
1130 	      then \
1131 		  echo New test file &quot;$$name&quot;_&quot;$$xno&quot; ; \
1132 		  $(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --schematron $$i $$j \
1133 		    &gt; $(srcdir)/result/schematron/&quot;$$name&quot;_&quot;$$xno&quot; \
1134 		    2&gt; $(srcdir)/result/schematron/&quot;$$name&quot;_&quot;$$xno&quot;.err; \
1135 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1136 	      else \
1137 	          log=`$(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --schematron $$i $$j \
1138 		    &gt; res.$$name 2&gt; err.$$name;\
1139 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1140 	          diff $(srcdir)/result/schematron/&quot;$$name&quot;_&quot;$$xno&quot; \
1141 		       res.$$name;\
1142 	          diff $(srcdir)/result/schematron/&quot;$$name&quot;_&quot;$$xno&quot;.err \
1143 		       err.$$name | grep -v &quot;error detected at&quot;;\
1144 		  grep Unimplemented err.$$name`; \
1145 		  if [ -n &quot;$$log&quot; ] ; then echo &quot;$$name&quot;_&quot;$$xno&quot; result ; echo &quot;$$log&quot; ; fi ; \
1146 	          rm res.$$name err.$$name ; \
1147 	       fi ; fi ; \
1148 	  done; done)
1149 
1150 RelaxNGPythonTests:
1151 	@(if [ -x $(PYTHON) ] ; then \
1152 	    PYTHONPATH=$(top_builddir)/python:$(top_builddir)/python/.libs:$$PYTHONPATH ; \
1153 	    export PYTHONPATH; \
1154 	    LD_LIBRARY_PATH=&quot;$(top_builddir)/.libs:$$LD_LIBRARY_PATH&quot; ; \
1155 	    export LD_LIBRARY_PATH; \
1156 	    echo &quot;## Relax-NG Python based test suite 1&quot; ; \
1157 	    $(CHECKER) $(PYTHON) $(srcdir)/check-relaxng-test-suite.py ; \
1158 	    echo &quot;## Relax-NG Python based test suite 2&quot; ; \
1159 	    $(CHECKER) $(PYTHON) $(srcdir)/check-relaxng-test-suite2.py ; \
1160 	  fi)
1161 
1162 SchemasPythonTests:
1163 	@(if [ -x $(PYTHON) ] ; then \
1164 	    PYTHONPATH=$(top_builddir)/python:$(top_builddir)/python/.libs:$$PYTHONPATH; \
1165 	    export PYTHONPATH; \
1166 	    LD_LIBRARY_PATH=&quot;$(top_builddir)/.libs:$$LD_LIBRARY_PATH&quot; ; \
1167 	    export LD_LIBRARY_PATH; \
1168 	    echo &quot;## XML Schemas datatypes Python based test suite&quot; ; \
1169 	    echo &quot;## It is normal to see 11 errors reported&quot; ; \
1170 	    $(CHECKER) $(PYTHON) $(srcdir)/check-xsddata-test-suite.py ; \
1171 	  fi)
1172 	@(if [ -x $(PYTHON) -a -d xstc ] ; then cd xstc ; $(MAKE) CHECKER=&quot;$(CHECKER)&quot; pytests ; fi)
1173 
1174 Patterntests: xmllint$(EXEEXT)
1175 	@(echo &gt; .memdump)
1176 	@echo &quot;## Pattern regression tests&quot;
1177 	-@(for i in $(srcdir)/test/pattern/*.pat ; do \
1178 	  name=`basename $$i .pat`; \
1179 	  if [ -f $(srcdir)/test/pattern/$$name.xml ] ; then \
1180 	  if [ ! -f $(srcdir)/result/pattern/$$name ] ; then \
1181 	      rm -f result.$$name ; \
1182 	      echo New test file $$name ; \
1183 	      for pat in `cat $$i` ; do \
1184 	      $(CHECKER) $(top_builddir)/xmllint --walker --pattern $$pat $(srcdir)/test/pattern/$$name.xml &gt;&gt; $(srcdir)/result/pattern/$$name ; \
1185 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1186 	      done ;\
1187 	  else \
1188 	      rm -f result.$$name ; \
1189 	      lst=`cat $$i` ; \
1190 	      log=`for pat in $$lst ; do $(CHECKER) $(top_builddir)/xmllint --walker --pattern $$pat $(srcdir)/test/pattern/$$name.xml 2&gt;&amp;1 &gt;&gt; result.$$name ; \
1191 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1192 	      done ;\
1193 	      diff $(srcdir)/result/pattern/$$name result.$$name` ; \
1194 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
1195 	      rm result.$$name ; \
1196 	  fi ; fi ; done ;)
1197 
1198 ModuleTests: testModule$(EXEEXT) testdso.la
1199 	@echo &quot;## Module tests&quot;
1200 	@(./testModule$(EXEEXT))
1201 
1202 cleanup:
1203 	-@(find . -name .\#\* -exec rm {} \;)
1204 	-@(find . -name \*.gcda -o -name \*.gcno -exec rm -f {} \;)
1205 	-@(find . -name \*.orig -o -name \*.rej -o -name \*.old -exec rm -f {} \;)
1206 
1207 dist-hook: cleanup libxml2.spec
1208 	-cp libxml2.spec $(distdir)
1209 	(cd $(srcdir) ; tar -cf - --exclude CVS --exclude .svn --exclude .git win32 macos os400 vms VxWorks bakefile test result) | (cd $(distdir); tar xf -)
1210 
1211 dist-source: distdir
1212 	$(AMTAR) -chof - --exclude Tests --exclude test --exclude result $(distdir) | GZIP=$(GZIP_ENV) gzip -c &gt;`echo &quot;$(distdir)&quot; | sed &quot;s+libxml2+libxml2-sources+&quot;`.tar.gz
1213 
1214 dist-test: distdir
1215 	(mkdir -p $(distdir))
1216 	(cd $(srcdir) ; tar -cf - --exclude CVS --exclude .svn --exclude .git xstc/Tests) | (cd $(distdir); tar xf -)
1217 	tar -cf - $(distdir)/test $(distdir)/result $(distdir)/xstc/Tests  $(distdir)/Makefile.tests $(distdir)/README $(distdir)/README.tests $(distdir)/AUTHORS $(distdir)/testapi.c $(distdir)/runtest.c $(distdir)/runsuite.c | GZIP=$(GZIP_ENV) gzip -c &gt;`echo &quot;$(distdir)&quot; | sed &quot;s+libxml2+libxml2-tests+&quot;`.tar.gz
1218 	@(rm -rf $(distdir)/xstc/Test)
1219 
1220 cleantar:
1221 	@(rm -f libxml*.tar.gz COPYING.LIB)
1222 
1223 rpm: cleanup cleantar
1224 	@(unset CDPATH ; $(MAKE) dist-source dist &amp;&amp; rpmbuild -ta $(distdir).tar.gz)
1225 
1226 ## We create xml2Conf.sh here and not from configure because we want
1227 ## to get the paths expanded correctly.  Macros like srcdir are given
1228 ## the value NONE in configure if the user doesn&#39;t specify them (this
1229 ## is an autoconf feature, not a bug).
1230 
1231 xml2Conf.sh: xml2Conf.sh.in Makefile
1232 ## Use sed and then mv to avoid problems if the user interrupts.
1233 	sed -e &#39;s?\@XML_LIBDIR\@?$(XML_LIBDIR)?g&#39; \
1234 	    -e &#39;s?\@XML_INCLUDEDIR\@?$(XML_INCLUDEDIR)?g&#39; \
1235 	    -e &#39;s?\@VERSION\@?$(VERSION)?g&#39; \
1236 	    -e &#39;s?\@XML_LIBS\@?$(XML_LIBS)?g&#39; \
<a name="4" id="anc4"></a><span class="line-added">1237 	    -e &#39;s?\@XML_PRIVATE_LIBS\@?$(XML_PRIVATE_LIBS)?g&#39; \</span>
1238 	       &lt; $(srcdir)/xml2Conf.sh.in &gt; xml2Conf.tmp \
1239 	&amp;&amp; mv xml2Conf.tmp xml2Conf.sh
1240 
1241 CLEANFILES = runxmlconf.log test.out xml2Conf.sh *.gcda *.gcno *.res
1242 DISTCLEANFILES = COPYING missing.lst
1243 
1244 confexecdir=$(libdir)
1245 confexec_DATA = xml2Conf.sh
1246 CVS_EXTRA_DIST=
1247 EXTRA_DIST = xml2-config.in xml2Conf.sh.in libxml.spec.in libxml2.spec \
1248              libxml.m4 Copyright check-xml-test-suite.py gentest.py \
1249 	     check-relaxng-test-suite.py check-relaxng-test-suite2.py \
1250 	     check-xsddata-test-suite.py check-xinclude-test-suite.py \
1251              example/Makefile.am example/gjobread.c example/gjobs.xml \
1252 	     $(man_MANS) libxml-2.0.pc.in libxml-2.0-uninstalled.pc.in \
1253 	     libxml2-config.cmake.in autogen.sh \
1254 	     trionan.c trionan.h triostr.c triostr.h trio.c trio.h \
1255 	     triop.h triodef.h libxml.h elfgcchack.h xzlib.h buf.h \
<a name="5" id="anc5"></a><span class="line-modified">1256 	     enc.h save.h genUnicode.py TODO_SCHEMAS \</span>
1257 	     dbgen.pl dbgenattr.pl regressions.py regressions.xml \
1258 	     README.tests Makefile.tests libxml2.syms timsort.h \
1259 	     README.zOS \
1260 	     $(CVS_EXTRA_DIST)
1261 
1262 
1263 pkgconfigdir = $(libdir)/pkgconfig
1264 pkgconfig_DATA = libxml-2.0.pc
1265 
1266 cmakedir = $(libdir)/cmake/libxml2
1267 cmake_DATA = libxml2-config.cmake
1268 
1269 #
1270 # Install the tests program sources as examples 
1271 #
1272 BASE_DIR=$(datadir)/doc
1273 DOC_MODULE=libxml2-$(VERSION)
1274 EXAMPLES_DIR=$(BASE_DIR)/$(DOC_MODULE)/examples
1275 
1276 install-data-local: 
1277 	$(MKDIR_P) $(DESTDIR)$(BASE_DIR)/$(DOC_MODULE)
1278 	-$(INSTALL) -m 0644 $(srcdir)/Copyright $(DESTDIR)$(BASE_DIR)/$(DOC_MODULE)
1279 	$(MKDIR_P) $(DESTDIR)$(EXAMPLES_DIR)
1280 	-$(INSTALL) -m 0644 $(srcdir)/xmllint.c $(DESTDIR)$(EXAMPLES_DIR)
1281 	-$(INSTALL) -m 0644 $(srcdir)/testSAX.c $(DESTDIR)$(EXAMPLES_DIR)
1282 	-$(INSTALL) -m 0644 $(srcdir)/testHTML.c $(DESTDIR)$(EXAMPLES_DIR)
1283 	-$(INSTALL) -m 0644 $(srcdir)/testXPath.c $(DESTDIR)$(EXAMPLES_DIR)
1284 
1285 uninstall-local:
1286 	rm -f $(DESTDIR)$(EXAMPLES_DIR)/testXPath.c
1287 	rm -f $(DESTDIR)$(EXAMPLES_DIR)/testHTML.c
1288 	rm -f $(DESTDIR)$(EXAMPLES_DIR)/testSAX.c
1289 	rm -f $(DESTDIR)$(EXAMPLES_DIR)/xmllint.c
1290 	rm -rf $(DESTDIR)$(EXAMPLES_DIR)
1291 	rm -f $(DESTDIR)$(BASE_DIR)/$(DOC_MODULE)/Copyright
1292 	rm -rf $(DESTDIR)$(BASE_DIR)/$(DOC_MODULE)
1293 
1294 tst: tst.c
1295 	$(CC) $(CFLAGS) -Iinclude -o tst tst.c .libs/libxml2.a -lpthread -lm -lz -llzma
1296 
1297 sparse: clean
1298 	$(MAKE) CC=cgcc
1299 
1300 #
1301 # Coverage support, largely borrowed from libvirt
1302 # Both binaries comes from the lcov package in Fedora
1303 #
1304 LCOV = /usr/bin/lcov
1305 GENHTML = /usr/bin/genhtml
1306 
1307 cov: clean-cov
1308 	if [ &quot;`echo $(LDFLAGS) | grep coverage`&quot; = &quot;&quot; ] ; then \
1309 	    echo not configured with coverage; exit 1 ; fi
1310 	if [ ! -x $(LCOV) -o ! -x $(GENHTML) ] ; then \
1311 	    echo Need $(LCOV) and $(GENHTML) excecutables; exit 1 ; fi
1312 	-@($(MAKE) check)
1313 	-@(./runsuite$(EXEEXT))
1314 	mkdir $(top_builddir)/coverage
1315 	$(LCOV) -c -o $(top_builddir)/coverage/libxml2.info.tmp -d $(top_srcdir)
1316 	$(LCOV) -r $(top_builddir)/coverage/libxml2.info.tmp -o $(top_builddir)/coverage/libxml2.info *usr*
1317 	rm $(top_builddir)/coverage/libxml2.info.tmp
1318 	$(GENHTML) -s -t &quot;libxml2&quot; -o $(top_builddir)/coverage --legend $(top_builddir)/coverage/libxml2.info
1319 	echo &quot;Coverage report is in $(top_builddir)/coverage/index.html&quot;
1320 
1321 clean-cov:
1322 	rm -rf $(top_builddir)/coverage
1323 
<a name="6" id="anc6"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="6" type="hidden" />
</body>
</html>