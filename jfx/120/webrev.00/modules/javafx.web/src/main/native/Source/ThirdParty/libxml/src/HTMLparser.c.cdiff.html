<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/ThirdParty/libxml/src/HTMLparser.c</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ChangeLog.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="HTMLtree.c.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/ThirdParty/libxml/src/HTMLparser.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 315,11 ***</span>
  
  #define CURRENT ((int) (*ctxt-&gt;input-&gt;cur))
  
  #define SKIP_BLANKS htmlSkipBlankChars(ctxt)
  
<span class="line-modified">! /* Inported from XML */</span>
  
  /* #define CUR (ctxt-&gt;token ? ctxt-&gt;token : (int) (*ctxt-&gt;input-&gt;cur)) */
  #define CUR ((int) (*ctxt-&gt;input-&gt;cur))
  #define NEXT xmlNextChar(ctxt)
  
<span class="line-new-header">--- 315,11 ---</span>
  
  #define CURRENT ((int) (*ctxt-&gt;input-&gt;cur))
  
  #define SKIP_BLANKS htmlSkipBlankChars(ctxt)
  
<span class="line-modified">! /* Imported from XML */</span>
  
  /* #define CUR (ctxt-&gt;token ? ctxt-&gt;token : (int) (*ctxt-&gt;input-&gt;cur)) */
  #define CUR ((int) (*ctxt-&gt;input-&gt;cur))
  #define NEXT xmlNextChar(ctxt)
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 535,11 ***</span>
      return(xmlCurrentChar(ctxt, len));
  
  encoding_error:
      /*
       * If we detect an UTF8 error that probably mean that the
<span class="line-modified">!      * input encoding didn&#39;t get properly advertized in the</span>
       * declaration header. Report the error and switch the encoding
       * to ISO-Latin-1 (if you don&#39;t like this policy, just declare the
       * encoding !)
       */
      {
<span class="line-new-header">--- 535,11 ---</span>
      return(xmlCurrentChar(ctxt, len));
  
  encoding_error:
      /*
       * If we detect an UTF8 error that probably mean that the
<span class="line-modified">!      * input encoding didn&#39;t get properly advertised in the</span>
       * declaration header. Report the error and switch the encoding
       * to ISO-Latin-1 (if you don&#39;t like this policy, just declare the
       * encoding !)
       */
      {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 600,12 ***</span>
   *  The list of HTML elements and their properties      *
   *                                  *
   ************************************************************************/
  
  /*
<span class="line-modified">!  *  Start Tag: 1 means the start tag can be ommited</span>
<span class="line-modified">!  *  End Tag:   1 means the end tag can be ommited</span>
   *             2 means it&#39;s forbidden (empty elements)
   *             3 means the tag is stylistic and should be closed easily
   *  Depr:      this element is deprecated
   *  DTD:       1 means that this element is valid only in the Loose DTD
   *             2 means that this element is valid only in the Frameset DTD
<span class="line-new-header">--- 600,12 ---</span>
   *  The list of HTML elements and their properties      *
   *                                  *
   ************************************************************************/
  
  /*
<span class="line-modified">!  *  Start Tag: 1 means the start tag can be omitted</span>
<span class="line-modified">!  *  End Tag:   1 means the end tag can be omitted</span>
   *             2 means it&#39;s forbidden (empty elements)
   *             3 means the tag is stylistic and should be closed easily
   *  Depr:      this element is deprecated
   *  DTD:       1 means that this element is valid only in the Loose DTD
   *             2 means that this element is valid only in the Frameset DTD
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1340,11 ***</span>
      for (i = (ctxt-&gt;nameNr - 1); i &gt;= 0; i--) {
  
          if (xmlStrEqual(newtag, ctxt-&gt;nameTab[i]))
              break;
          /*
<span class="line-modified">!          * A missplaced endtag can only close elements with lower</span>
           * or equal priority, so if we find an element with higher
           * priority before we find an element with
           * matching name, we just ignore this endtag
           */
          if (htmlGetEndPriority(ctxt-&gt;nameTab[i]) &gt; priority)
<span class="line-new-header">--- 1340,11 ---</span>
      for (i = (ctxt-&gt;nameNr - 1); i &gt;= 0; i--) {
  
          if (xmlStrEqual(newtag, ctxt-&gt;nameTab[i]))
              break;
          /*
<span class="line-modified">!          * A misplaced endtag can only close elements with lower</span>
           * or equal priority, so if we find an element with higher
           * priority before we find an element with
           * matching name, we just ignore this endtag
           */
          if (htmlGetEndPriority(ctxt-&gt;nameTab[i]) &gt; priority)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2174,10 ***</span>
<span class="line-new-header">--- 2174,11 ---</span>
   *                                  *
   *      Commodity functions to handle streams           *
   *                                  *
   ************************************************************************/
  
<span class="line-added">+ #ifdef LIBXML_PUSH_ENABLED</span>
  /**
   * htmlNewInputStream:
   * @ctxt:  an HTML parser context
   *
   * Create a new input stream structure
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2205,22 ***</span>
      input-&gt;version = NULL;
      input-&gt;consumed = 0;
      input-&gt;length = 0;
      return(input);
  }
  
  
  /************************************************************************
   *                                  *
   *      Commodity functions, cleanup needed ?           *
   *                                  *
   ************************************************************************/
  /*
   * all tags allowing pc data from the html 4.01 loose dtd
<span class="line-modified">!  * NOTE: it might be more apropriate to integrate this information</span>
   * into the html40ElementTable array but I don&#39;t want to risk any
<span class="line-modified">!  * binary incomptibility</span>
   */
  static const char *allowPCData[] = {
      &quot;a&quot;, &quot;abbr&quot;, &quot;acronym&quot;, &quot;address&quot;, &quot;applet&quot;, &quot;b&quot;, &quot;bdo&quot;, &quot;big&quot;,
      &quot;blockquote&quot;, &quot;body&quot;, &quot;button&quot;, &quot;caption&quot;, &quot;center&quot;, &quot;cite&quot;, &quot;code&quot;,
      &quot;dd&quot;, &quot;del&quot;, &quot;dfn&quot;, &quot;div&quot;, &quot;dt&quot;, &quot;em&quot;, &quot;font&quot;, &quot;form&quot;, &quot;h1&quot;, &quot;h2&quot;,
<span class="line-new-header">--- 2206,23 ---</span>
      input-&gt;version = NULL;
      input-&gt;consumed = 0;
      input-&gt;length = 0;
      return(input);
  }
<span class="line-added">+ #endif</span>
  
  
  /************************************************************************
   *                                  *
   *      Commodity functions, cleanup needed ?           *
   *                                  *
   ************************************************************************/
  /*
   * all tags allowing pc data from the html 4.01 loose dtd
<span class="line-modified">!  * NOTE: it might be more appropriate to integrate this information</span>
   * into the html40ElementTable array but I don&#39;t want to risk any
<span class="line-modified">!  * binary incompatibility</span>
   */
  static const char *allowPCData[] = {
      &quot;a&quot;, &quot;abbr&quot;, &quot;acronym&quot;, &quot;address&quot;, &quot;applet&quot;, &quot;b&quot;, &quot;bdo&quot;, &quot;big&quot;,
      &quot;blockquote&quot;, &quot;body&quot;, &quot;button&quot;, &quot;caption&quot;, &quot;center&quot;, &quot;cite&quot;, &quot;code&quot;,
      &quot;dd&quot;, &quot;del&quot;, &quot;dfn&quot;, &quot;div&quot;, &quot;dt&quot;, &quot;em&quot;, &quot;font&quot;, &quot;form&quot;, &quot;h1&quot;, &quot;h2&quot;,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2957,10 ***</span>
<span class="line-new-header">--- 2959,11 ---</span>
                  }
              }
      }
      COPY_BUF(l,buf,nbchar,cur);
      if (nbchar &gt;= HTML_PARSER_BIG_BUFFER_SIZE) {
<span class="line-added">+             buf[nbchar] = 0;</span>
          if (ctxt-&gt;sax-&gt;cdataBlock!= NULL) {
          /*
           * Insert as CDATA, which is the same as HTML_PRESERVE_NODE
           */
          ctxt-&gt;sax-&gt;cdataBlock(ctxt-&gt;userData, buf, nbchar);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2981,10 ***</span>
<span class="line-new-header">--- 2984,11 ---</span>
              NEXT;
          }
      }
  
      if ((nbchar != 0) &amp;&amp; (ctxt-&gt;sax != NULL) &amp;&amp; (!ctxt-&gt;disableSAX)) {
<span class="line-added">+         buf[nbchar] = 0;</span>
      if (ctxt-&gt;sax-&gt;cdataBlock!= NULL) {
          /*
           * Insert as CDATA, which is the same as HTML_PRESERVE_NODE
           */
          ctxt-&gt;sax-&gt;cdataBlock(ctxt-&gt;userData, buf, nbchar);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 3026,10 ***</span>
<span class="line-new-header">--- 3030,12 ---</span>
                      &quot;Invalid char in CDATA 0x%X\n&quot;, cur);
      } else {
          COPY_BUF(l,buf,nbchar,cur);
      }
      if (nbchar &gt;= HTML_PARSER_BIG_BUFFER_SIZE) {
<span class="line-added">+             buf[nbchar] = 0;</span>
<span class="line-added">+ </span>
          /*
           * Ok the segment is to be consumed as chars.
           */
          if ((ctxt-&gt;sax != NULL) &amp;&amp; (!ctxt-&gt;disableSAX)) {
          if (areBlanks(ctxt, buf, nbchar)) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 5760,17 ***</span>
              &quot;HPP: entering CONTENT\n&quot;);
  #endif
                  break;
          }
              case XML_PARSER_CONTENT: {
          long cons;
                  /*
           * Handle preparsed entities and charRef
           */
          if (ctxt-&gt;token != 0) {
<span class="line-removed">-             xmlChar chr[2] = { 0 , 0 } ;</span>
<span class="line-removed">- </span>
              chr[0] = (xmlChar) ctxt-&gt;token;
              htmlCheckParagraph(ctxt);
              if ((ctxt-&gt;sax != NULL) &amp;&amp; (ctxt-&gt;sax-&gt;characters != NULL))
              ctxt-&gt;sax-&gt;characters(ctxt-&gt;userData, chr, 1);
              ctxt-&gt;token = 0;
<span class="line-new-header">--- 5766,17 ---</span>
              &quot;HPP: entering CONTENT\n&quot;);
  #endif
                  break;
          }
              case XML_PARSER_CONTENT: {
<span class="line-added">+         xmlChar chr[2] = { 0, 0 };</span>
          long cons;
<span class="line-added">+ </span>
                  /*
           * Handle preparsed entities and charRef
           */
          if (ctxt-&gt;token != 0) {
              chr[0] = (xmlChar) ctxt-&gt;token;
              htmlCheckParagraph(ctxt);
              if ((ctxt-&gt;sax != NULL) &amp;&amp; (ctxt-&gt;sax-&gt;characters != NULL))
              ctxt-&gt;sax-&gt;characters(ctxt-&gt;userData, chr, 1);
              ctxt-&gt;token = 0;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 5778,25 ***</span>
          }
          if ((avail == 1) &amp;&amp; (terminate)) {
              cur = in-&gt;cur[0];
              if ((cur != &#39;&lt;&#39;) &amp;&amp; (cur != &#39;&amp;&#39;)) {
              if (ctxt-&gt;sax != NULL) {
                  if (IS_BLANK_CH(cur)) {
                  if (ctxt-&gt;keepBlanks) {
                      if (ctxt-&gt;sax-&gt;characters != NULL)
                      ctxt-&gt;sax-&gt;characters(
<span class="line-modified">!                         ctxt-&gt;userData, &amp;in-&gt;cur[0], 1);</span>
                  } else {
                      if (ctxt-&gt;sax-&gt;ignorableWhitespace != NULL)
                      ctxt-&gt;sax-&gt;ignorableWhitespace(
<span class="line-modified">!                         ctxt-&gt;userData, &amp;in-&gt;cur[0], 1);</span>
                  }
                  } else {
                  htmlCheckParagraph(ctxt);
                  if (ctxt-&gt;sax-&gt;characters != NULL)
                      ctxt-&gt;sax-&gt;characters(
<span class="line-modified">!                         ctxt-&gt;userData, &amp;in-&gt;cur[0], 1);</span>
                  }
              }
              ctxt-&gt;token = 0;
              ctxt-&gt;checkIndex = 0;
              in-&gt;cur++;
<span class="line-new-header">--- 5784,26 ---</span>
          }
          if ((avail == 1) &amp;&amp; (terminate)) {
              cur = in-&gt;cur[0];
              if ((cur != &#39;&lt;&#39;) &amp;&amp; (cur != &#39;&amp;&#39;)) {
              if (ctxt-&gt;sax != NULL) {
<span class="line-added">+                             chr[0] = cur;</span>
                  if (IS_BLANK_CH(cur)) {
                  if (ctxt-&gt;keepBlanks) {
                      if (ctxt-&gt;sax-&gt;characters != NULL)
                      ctxt-&gt;sax-&gt;characters(
<span class="line-modified">!                         ctxt-&gt;userData, chr, 1);</span>
                  } else {
                      if (ctxt-&gt;sax-&gt;ignorableWhitespace != NULL)
                      ctxt-&gt;sax-&gt;ignorableWhitespace(
<span class="line-modified">!                         ctxt-&gt;userData, chr, 1);</span>
                  }
                  } else {
                  htmlCheckParagraph(ctxt);
                  if (ctxt-&gt;sax-&gt;characters != NULL)
                      ctxt-&gt;sax-&gt;characters(
<span class="line-modified">!                         ctxt-&gt;userData, chr, 1);</span>
                  }
              }
              ctxt-&gt;token = 0;
              ctxt-&gt;checkIndex = 0;
              in-&gt;cur++;
</pre>
<center><a href="ChangeLog.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="HTMLtree.c.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>