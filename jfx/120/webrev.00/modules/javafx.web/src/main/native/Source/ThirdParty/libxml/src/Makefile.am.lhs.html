<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/ThirdParty/libxml/src/Makefile.am</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>   1 ## Process this file with automake to produce Makefile.in
   2 
   3 ACLOCAL_AMFLAGS = -I m4
   4 
   5 SUBDIRS = include . doc example xstc $(PYTHON_SUBDIR)
   6 
   7 DIST_SUBDIRS = include . doc example python xstc
   8 
   9 AM_CPPFLAGS = -I$(top_builddir)/include -I$(srcdir)/include
  10 
  11 AM_CFLAGS = $(EXTRA_CFLAGS) $(THREAD_CFLAGS) $(Z_CFLAGS) $(LZMA_CFLAGS)
  12 
  13 check_PROGRAMS=testSchemas testRelax testSAX testHTML testXPath testURI \
  14                testThreads testC14N testAutomata testRegexp \
  15                testReader testapi testModule runtest runsuite testchar \
  16 	       testdict runxmlconf testrecurse testlimits
  17 
  18 bin_PROGRAMS = xmllint xmlcatalog
  19 
  20 bin_SCRIPTS=xml2-config
  21 
  22 lib_LTLIBRARIES = libxml2.la
  23 libxml2_la_LIBADD = $(ICU_LIBS) $(THREAD_LIBS) $(Z_LIBS) $(LZMA_LIBS) $(ICONV_LIBS) $(M_LIBS) $(WIN32_EXTRA_LIBADD)
  24 
  25 if USE_VERSION_SCRIPT
  26 LIBXML2_VERSION_SCRIPT = $(VERSION_SCRIPT_FLAGS)$(srcdir)/libxml2.syms
  27 else
  28 LIBXML2_VERSION_SCRIPT =
  29 endif
  30 
  31 libxml2_la_LDFLAGS = $(CYGWIN_EXTRA_LDFLAGS) $(WIN32_EXTRA_LDFLAGS) \
  32 		     $(LIBXML2_VERSION_SCRIPT) \
  33 		     -version-info $(LIBXML_VERSION_INFO) \
  34 		     $(MODULE_PLATFORM_LIBS)
  35 
  36 if WITH_SAX1_SOURCES
  37 docb_sources = DOCBparser.c
  38 else
  39 docb_sources =
  40 endif
  41 
  42 if WITH_TRIO_SOURCES
  43 trio_sources = triostr.c trio.c
  44 else
  45 trio_sources =
  46 endif
  47 
  48 libxml2_la_SOURCES = SAX.c entities.c encoding.c error.c parserInternals.c  \
  49 		parser.c tree.c hash.c list.c xmlIO.c xmlmemory.c uri.c  \
  50 		valid.c xlink.c HTMLparser.c HTMLtree.c debugXML.c xpath.c  \
  51 		xpointer.c xinclude.c nanohttp.c nanoftp.c \
  52 		$(docb_sources) \
  53 		catalog.c globals.c threads.c c14n.c xmlstring.c buf.c \
  54 		xmlregexp.c xmlschemas.c xmlschemastypes.c xmlunicode.c \
  55 		$(trio_sources) \
  56 		xmlreader.c relaxng.c dict.c SAX2.c \
  57 		xmlwriter.c legacy.c chvalid.c pattern.c xmlsave.c \
  58 		xmlmodule.c schematron.c xzlib.c
  59 
  60 DEPS = $(top_builddir)/libxml2.la
  61 LDADDS = $(STATIC_BINARIES) $(top_builddir)/libxml2.la $(THREAD_LIBS) $(Z_LIBS) $(LZMA_LIBS) $(ICONV_LIBS) $(M_LIBS) $(WIN32_EXTRA_LIBADD)
  62 
  63 
  64 man_MANS = xml2-config.1 libxml.3
  65 
  66 m4datadir = $(datadir)/aclocal
  67 m4data_DATA = libxml.m4
  68 
  69 runtest_SOURCES=runtest.c
  70 runtest_LDFLAGS = 
  71 runtest_DEPENDENCIES = $(DEPS)
  72 runtest_LDADD= $(BASE_THREAD_LIBS) $(RDL_LIBS) $(LDADDS)
  73 
  74 testrecurse_SOURCES=testrecurse.c
  75 testrecurse_LDFLAGS = 
  76 testrecurse_DEPENDENCIES = $(DEPS)
  77 testrecurse_LDADD= $(BASE_THREAD_LIBS) $(RDL_LIBS) $(LDADDS)
  78 
  79 testlimits_SOURCES=testlimits.c
  80 testlimits_LDFLAGS = 
  81 testlimits_DEPENDENCIES = $(DEPS)
  82 testlimits_LDADD= $(BASE_THREAD_LIBS) $(RDL_LIBS) $(LDADDS)
  83 
  84 testchar_SOURCES=testchar.c
  85 testchar_LDFLAGS = 
  86 testchar_DEPENDENCIES = $(DEPS)
  87 testchar_LDADD= $(RDL_LIBS) $(LDADDS)
  88 
  89 testdict_SOURCES=testdict.c
  90 testdict_LDFLAGS = 
  91 testdict_DEPENDENCIES = $(DEPS)
  92 testdict_LDADD= $(RDL_LIBS) $(LDADDS)
  93 
  94 runsuite_SOURCES=runsuite.c
  95 runsuite_LDFLAGS = 
  96 runsuite_DEPENDENCIES = $(DEPS)
  97 runsuite_LDADD= $(RDL_LIBS) $(LDADDS)
  98 
  99 xmllint_SOURCES=xmllint.c
 100 xmllint_LDFLAGS = 
 101 xmllint_DEPENDENCIES = $(DEPS)
 102 xmllint_LDADD=  $(RDL_LIBS) $(LDADDS)
 103 
 104 testSAX_SOURCES=testSAX.c
 105 testSAX_LDFLAGS = 
 106 testSAX_DEPENDENCIES = $(DEPS)
 107 testSAX_LDADD= $(LDADDS)
 108 
 109 testHTML_SOURCES=testHTML.c
 110 testHTML_LDFLAGS = 
 111 testHTML_DEPENDENCIES = $(DEPS)
 112 testHTML_LDADD= $(LDADDS)
 113 
 114 xmlcatalog_SOURCES=xmlcatalog.c
 115 xmlcatalog_LDFLAGS = 
 116 xmlcatalog_DEPENDENCIES = $(DEPS)
 117 xmlcatalog_LDADD = $(RDL_LIBS) $(LDADDS)
 118 
 119 testXPath_SOURCES=testXPath.c
 120 testXPath_LDFLAGS = 
 121 testXPath_DEPENDENCIES = $(DEPS)
 122 testXPath_LDADD= $(LDADDS)
 123 
 124 testC14N_SOURCES=testC14N.c
 125 testC14N_LDFLAGS = 
 126 testC14N_DEPENDENCIES = $(DEPS)
 127 testC14N_LDADD= $(LDADDS)
 128 
<a name="1" id="anc1"></a><span class="line-removed"> 129 if THREADS_W32</span>
<span class="line-removed"> 130 testThreads_SOURCES = testThreadsWin32.c</span>
<span class="line-removed"> 131 else</span>
 132 testThreads_SOURCES = testThreads.c
<a name="2" id="anc2"></a><span class="line-removed"> 133 endif</span>
 134 testThreads_LDFLAGS = 
 135 testThreads_DEPENDENCIES = $(DEPS)
 136 testThreads_LDADD= $(BASE_THREAD_LIBS) $(LDADDS)
 137 
 138 testURI_SOURCES=testURI.c
 139 testURI_LDFLAGS = 
 140 testURI_DEPENDENCIES = $(DEPS)
 141 testURI_LDADD= $(LDADDS)
 142 
 143 testRegexp_SOURCES=testRegexp.c
 144 testRegexp_LDFLAGS = 
 145 testRegexp_DEPENDENCIES = $(DEPS)
 146 testRegexp_LDADD= $(LDADDS)
 147 
 148 testAutomata_SOURCES=testAutomata.c
 149 testAutomata_LDFLAGS = 
 150 testAutomata_DEPENDENCIES = $(DEPS)
 151 testAutomata_LDADD= $(LDADDS)
 152 
 153 testSchemas_SOURCES=testSchemas.c
 154 testSchemas_LDFLAGS = 
 155 testSchemas_DEPENDENCIES = $(DEPS)
 156 testSchemas_LDADD= $(LDADDS)
 157 
 158 testRelax_SOURCES=testRelax.c
 159 testRelax_LDFLAGS = 
 160 testRelax_DEPENDENCIES = $(DEPS)
 161 testRelax_LDADD= $(LDADDS)
 162 
 163 testReader_SOURCES=testReader.c
 164 testReader_LDFLAGS = 
 165 testReader_DEPENDENCIES = $(DEPS)
 166 testReader_LDADD= $(LDADDS)
 167 
 168 testModule_SOURCES=testModule.c
 169 testModule_LDFLAGS = 
 170 testModule_DEPENDENCIES = $(DEPS)
 171 testModule_LDADD= $(LDADDS)
 172 
 173 noinst_LTLIBRARIES = testdso.la
 174 testdso_la_SOURCES = testdso.c
 175 testdso_la_LDFLAGS = -module -no-undefined -avoid-version -rpath $(libdir)
 176 
 177 # that one forces the rebuild when &quot;make rebuild&quot; is run on doc/
 178 rebuild_testapi:
 179 	-@(if [ &quot;$(PYTHON)&quot; != &quot;&quot; ] ; then \
 180 	    $(PYTHON) $(srcdir)/gentest.py $(srcdir) ; fi )
 181 
 182 # that one is just to make sure it is rebuilt if missing
 183 # but adding the dependances generate mess
 184 testapi.c: $(srcdir)/gentest.py
 185 	-@(if [ &quot;$(PYTHON)&quot; != &quot;&quot; ] ; then \
 186 	    $(PYTHON) $(srcdir)/gentest.py $(srcdir) ; fi )
 187 
 188 BUILT_SOURCES = testapi.c
 189 
 190 testapi_SOURCES=testapi.c
 191 testapi_LDFLAGS = 
 192 testapi_DEPENDENCIES = $(DEPS)
 193 testapi_LDADD= $(LDADDS)
 194 
 195 runxmlconf_SOURCES=runxmlconf.c
 196 runxmlconf_LDFLAGS = 
 197 runxmlconf_DEPENDENCIES = $(DEPS)
 198 runxmlconf_LDADD= $(LDADDS)
 199 
 200 #testOOM_SOURCES=testOOM.c testOOMlib.h testOOMlib.c
 201 #testOOM_LDFLAGS = 
 202 #testOOM_DEPENDENCIES = $(DEPS)
 203 #testOOM_LDADD= $(LDADDS)
 204 
 205 runtests: runtest$(EXEEXT) testrecurse$(EXEEXT) testapi$(EXEEXT) \
 206           testchar$(EXEEXT) testdict$(EXEEXT) runxmlconf$(EXEEXT)
 207 	[ -d test   ] || $(LN_S) $(srcdir)/test   .
 208 	[ -d result ] || $(LN_S) $(srcdir)/result .
 209 	$(CHECKER) ./runtest$(EXEEXT) &amp;&amp; \
 210 	    $(CHECKER) ./testrecurse$(EXEEXT) &amp;&amp; \
 211 	    ASAN_OPTIONS=&quot;$$ASAN_OPTIONS:detect_leaks=0&quot; $(CHECKER) ./testapi$(EXEEXT) &amp;&amp; \
 212 	    $(CHECKER) ./testchar$(EXEEXT) &amp;&amp; \
 213 	    $(CHECKER) ./testdict$(EXEEXT) &amp;&amp; \
 214 	    $(CHECKER) ./runxmlconf$(EXEEXT)
 215 	@(if [ &quot;$(PYTHON_SUBDIR)&quot; != &quot;&quot; ] ; then cd python ; \
 216 	    $(MAKE) tests ; fi)
 217 
 218 check: all runtests
 219 
 220 check-valgrind valgrind: all
 221 	@echo &#39;## Running the regression tests under Valgrind&#39;
 222 	@echo &#39;## Go get a cup of coffee it is gonna take a while ...&#39;
 223 	$(MAKE) CHECKER=&#39;valgrind -q&#39; runtests
 224 
 225 asan:
 226 	@echo &#39;## rebuilding for ASAN&#39;
 227 	./configure CFLAGS=&quot;-fsanitize=address,undefined -Wformat -Werror=format-security -Werror=array-bounds -g&quot; CXXFLAGS=&quot;-fsanitize=address,undefined -Wformat -Werror=format-security -Werror=array-bounds -g&quot; LDFLAGS=&quot;-fsanitize=address,undefined&quot; CC=&quot;clang&quot; CXX=&quot;clang++&quot; --disable-shared ; OptimOff  ; $(MAKE) clean ; $(MAKE)
 228 
 229 testall : tests SVGtests SAXtests
 230 
 231 tests: XMLtests XMLenttests NStests IDtests Errtests APItests $(READER_TEST) $(TEST_SAX) $(TEST_PUSH) $(TEST_HTML) $(TEST_PHTML) $(TEST_VALID) URItests $(TEST_PATTERN) $(TEST_XPATH) $(TEST_XPTR) $(TEST_XINCLUDE) $(TEST_C14N) $(TEST_DEBUG) $(TEST_CATALOG) $(TEST_REGEXPS) $(TEST_SCHEMAS) $(TEST_SCHEMATRON) $(TEST_THREADS) Timingtests $(TEST_VTIME) $(PYTHON_TESTS) $(TEST_MODULES)
 232 	@(if [ &quot;$(PYTHON_SUBDIR)&quot; != &quot;&quot; ] ; then cd python ; \
 233 	    $(MAKE) -s tests ; fi)
 234 	@(cd doc/examples ; $(MAKE) -s tests)
 235 
 236 APItests: testapi$(EXEEXT)
 237 	@echo &quot;## Running the API regression tests this may take a little while&quot;
 238 	-@(ASAN_OPTIONS=&quot;$$ASAN_OPTIONS:detect_leaks=0&quot; $(CHECKER) $(top_builddir)/testapi -q)
 239 
 240 HTMLtests : testHTML$(EXEEXT)
 241 	@(echo &gt; .memdump)
 242 	@echo &quot;## HTML regression tests&quot;
 243 	-@(for i in $(srcdir)/test/HTML/* ; do \
 244 	  name=`basename $$i`; \
 245 	  if [ ! -d $$i ] ; then \
 246 	  if [ ! -f $(srcdir)/result/HTML/$$name ] ; then \
 247 	      echo New test file $$name ; \
 248 	      $(CHECKER) $(top_builddir)/testHTML $$i &gt; $(srcdir)/result/HTML/$$name 2&gt;$(srcdir)/result/HTML/$$name.err ; \
 249 	  else \
 250 	      log=`$(CHECKER) $(top_builddir)/testHTML $$i &gt; result.$$name 2&gt; error.$$name ; \
 251 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 252 	      diff $(srcdir)/result/HTML/$$name result.$$name ; \
 253 	      diff -b $(srcdir)/result/HTML/$$name.err error.$$name ; \
 254 	      $(CHECKER) $(top_builddir)/testHTML result.$$name &gt; result2.$$name 2&gt;error.$$name ; \
 255 	      diff result.$$name result2.$$name` ; \
 256 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 257 	      rm result.$$name result2.$$name error.$$name ; \
 258 	  fi ; fi ; done)
 259 
 260 HTMLPushtests : testHTML$(EXEEXT)
 261 	@echo &quot;## Push HTML regression tests&quot;
 262 	-@(for i in $(srcdir)/test/HTML/* ; do \
 263 	  name=`basename $$i`; \
 264 	  if [ ! -d $$i ] ; then \
 265 	  if [ ! -f $(srcdir)/result/HTML/$$name ] ; then \
 266 	      echo New test file $$name ; \
 267 	      $(CHECKER) $(top_builddir)/testHTML --push $$i &gt; $(srcdir)/result/HTML/$$name 2&gt;$(srcdir)/result/HTML/$$name.err ; \
 268 	  else \
 269 	      log=`$(CHECKER) $(top_builddir)/testHTML --push $$i &gt; result.$$name 2&gt; error.$$name ; \
 270 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 271 	      diff $(srcdir)/result/HTML/$$name result.$$name ; \
 272 	      cut -b 1-15 $(srcdir)/result/HTML/$$name.err &gt; errorcut.$$name; \
 273 	      cut -b 1-15 error.$$name &gt; errorcut2.$$name; \
 274 	      diff -b errorcut.$$name errorcut2.$$name ; \
 275 	      $(CHECKER) $(top_builddir)/testHTML --push result.$$name &gt; result2.$$name 2&gt;error.$$name ; \
 276 	      diff result.$$name result2.$$name` ; \
 277 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 278 	      rm result.$$name result2.$$name error.$$name errorcut.$$name errorcut2.$$name ; \
 279 	  fi ; fi ; done)
 280 	@echo &quot;## HTML SAX regression tests&quot;
 281 	-@(for i in $(srcdir)/test/HTML/* ; do \
 282 	  name=`basename $$i`; \
 283 	  if [ ! -d $$i ] ; then \
 284 	  if [ ! -f $(srcdir)/result/HTML/$$name.sax ] ; then \
 285 	      echo New test file $$name ; \
 286 	      $(CHECKER) $(top_builddir)/testHTML --sax $$i &gt; $(srcdir)/result/HTML/$$name.sax ; \
 287 	  else \
 288 	      log=`$(CHECKER) $(top_builddir)/testHTML --sax $$i &gt; result.$$name.sax ; \
 289 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 290 	      diff $(srcdir)/result/HTML/$$name.sax result.$$name.sax` ; \
 291 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 292 	      rm result.$$name.sax ; \
 293 	  fi ; fi ; done)
 294 	@echo &quot;## Push HTML SAX regression tests&quot;
 295 	-@(for i in $(srcdir)/test/HTML/* ; do \
 296 	  name=`basename $$i`; \
 297 	  if [ ! -d $$i ] ; then \
 298 	  if [ ! -f $(srcdir)/result/HTML/$$name ] ; then \
 299 	      echo New test file $$name ; \
 300 	      $(CHECKER) $(top_builddir)/testHTML --push --sax $$i &gt; $(srcdir)/result/HTML/$$name.sax ; \
 301 	  else \
 302 	      log=`$(CHECKER) $(top_builddir)/testHTML --push --sax $$i 2&gt;&amp;1 &gt; result.$$name.sax ; \
 303 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 304 	      diff $(srcdir)/result/HTML/$$name.sax result.$$name.sax` ; \
 305 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 306 	      rm result.$$name.sax ; \
 307 	  fi ; fi ; done)
 308 
 309 XMLtests : xmllint$(EXEEXT)
 310 	@(echo &gt; .memdump)
 311 	@echo &quot;## XML regression tests&quot;
 312 	-@(for i in $(srcdir)/test/* ; do \
 313 	  name=`basename $$i`; \
 314 	  if [ ! -d $$i ] ; then \
 315 	  if [ ! -f $(srcdir)/result/$$name ] ; then \
 316 	      echo New test file $$name ; \
 317 	      $(CHECKER) $(top_builddir)/xmllint $$i &gt; $(srcdir)/result/$$name ; \
 318 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 319 	  else \
 320 	      log=`$(CHECKER) $(top_builddir)/xmllint $$i 2&gt;&amp;1 &gt; result.$$name ; \
 321 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 322 	      diff $(srcdir)/result/$$name result.$$name ; \
 323 	      $(CHECKER) $(top_builddir)/xmllint result.$$name 2&gt;&amp;1 &gt; result2.$$name | grep -v &#39;failed to load external entity&#39; ; \
 324 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 325 	      diff result.$$name result2.$$name` ;\
 326 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 327 	      rm result.$$name result2.$$name ; \
 328 	  fi ; fi ; done)
 329 	@echo &quot;## XML regression tests on memory&quot;
 330 	-@(for i in $(srcdir)/test/* ; do \
 331 	  name=`basename $$i`; \
 332 	  if [ ! -d $$i ] ; then \
 333 	  if [ ! -f $(srcdir)/result/$$name ] ; then \
 334 	      echo New test file $$name ; \
 335 	      $(CHECKER) $(top_builddir)/xmllint --memory $$i &gt; $(srcdir)/result/$$name ; \
 336 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 337 	  else \
 338 	      log=`$(CHECKER) $(top_builddir)/xmllint --memory $$i 2&gt;&amp;1 &gt; result.$$name ; \
 339 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 340 	      diff $(srcdir)/result/$$name result.$$name ; \
 341 	      $(CHECKER) $(top_builddir)/xmllint --memory result.$$name 2&gt;&amp;1 &gt; result2.$$name | grep -v &#39;failed to load external entity&#39; ; \
 342 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;`; \
 343 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 344 	      diff result.$$name result2.$$name ; \
 345 	      rm result.$$name result2.$$name ; \
 346 	  fi ; fi ; done)
 347 
 348 XMLPushtests: xmllint$(EXEEXT)
 349 	@(echo &gt; .memdump)
 350 	@echo &quot;## XML push regression tests&quot;
 351 	-@(for i in $(srcdir)/test/* ; do \
 352 	  name=`basename $$i`; \
 353 	  if [ ! -d $$i ] ; then \
 354 	  if [ ! -f $(srcdir)/result/$$name ] ; then \
 355 	      echo New test file $$name ; \
 356 	      $(CHECKER) $(top_builddir)/xmllint --push $$i &gt; $(srcdir)/result/$$name ; \
 357 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 358 	  else \
 359 	      log=`$(CHECKER) $(top_builddir)/xmllint --push $$i 2&gt;&amp;1 &gt; result.$$name ; \
 360 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 361 	      diff $(srcdir)/result/$$name result.$$name ; \
 362 	      $(CHECKER) $(top_builddir)/xmllint --push result.$$name 2&gt;&amp;1 &gt; result2.$$name | grep -v &#39;failed to load external entity&#39; ; \
 363 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 364 	      diff result.$$name result2.$$name` ; \
 365 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 366 	      rm result.$$name result2.$$name ; \
 367 	  fi ; fi ; done)
 368 
 369 NStests : xmllint$(EXEEXT)
 370 	@(echo &gt; .memdump)
 371 	@echo &quot;## XML Namespaces regression tests&quot;
 372 	-@(for i in $(srcdir)/test/namespaces/* ; do \
 373 	  name=`basename $$i`; \
 374 	  if [ ! -d $$i ] ; then \
 375 	  if [ ! -f $(srcdir)/result/namespaces/$$name ] ; then \
 376 	      echo New test file $$name ; \
 377 	      $(CHECKER) $(top_builddir)/xmllint $$i \
 378 	         2&gt; $(srcdir)/result/namespaces/$$name.err \
 379 		 &gt; $(srcdir)/result/namespaces/$$name ; \
 380 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 381 	  else \
 382 	      log=`$(CHECKER) $(top_builddir)/xmllint $$i 2&gt; error.$$name &gt; result.$$name ; \
 383 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 384 	      diff $(srcdir)/result/namespaces/$$name result.$$name ; \
 385 	      diff $(srcdir)/result/namespaces/$$name.err error.$$name`; \
 386 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 387 	      rm result.$$name error.$$name ; \
 388 	  fi ; fi ; done)
 389 
 390 IDtests : xmllint$(EXEEXT) testXPath$(EXEEXT)
 391 	@(echo &gt; .memdump)
 392 	@echo &quot;## xml:id regression tests&quot;
 393 	-@(for i in $(srcdir)/test/xmlid/id_*.xml ; do \
 394 	  name=`basename $$i`; \
 395 	  if [ ! -d $$i ] ; then \
 396 	  if [ ! -f $(srcdir)/result/xmlid/$$name ] ; then \
 397 	      echo New test file $$name ; \
 398 	      $(CHECKER) $(top_builddir)/testXPath -i $$i &quot;id(&#39;bar&#39;)&quot; \
 399 	         2&gt; $(srcdir)/result/xmlid/$$name.err \
 400 		 &gt; $(srcdir)/result/xmlid/$$name ; \
 401 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 402 	  else \
 403 	      log=`$(CHECKER) $(top_builddir)/testXPath -i $$i &quot;id(&#39;bar&#39;)&quot; 2&gt; error.$$name &gt; result.$$name ; \
 404 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 405 	      diff $(srcdir)/result/xmlid/$$name result.$$name ; \
 406 	      diff $(srcdir)/result/xmlid/$$name.err error.$$name` ; \
 407 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 408 	      rm result.$$name error.$$name ; \
 409 	  fi ; fi ; done)
 410 
 411 Errtests : xmllint$(EXEEXT)
 412 	@(echo &gt; .memdump)
 413 	@echo &quot;## Error cases regression tests&quot;
 414 	-@(for i in $(srcdir)/test/errors/*.xml ; do \
 415 	  name=`basename $$i`; \
 416 	  if [ ! -d $$i ] ; then \
 417 	  if [ ! -f $(srcdir)/result/errors/$$name ] ; then \
 418 	      echo New test file $$name ; \
 419 	      $(CHECKER) $(top_builddir)/xmllint $$i \
 420 	         2&gt; $(srcdir)/result/errors/$$name.err \
 421 		 &gt; $(srcdir)/result/errors/$$name ; \
 422 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 423 	  else \
 424 	      log=`$(CHECKER) $(top_builddir)/xmllint $$i 2&gt; error.$$name &gt; result.$$name ; \
 425 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 426 	      diff $(srcdir)/result/errors/$$name result.$$name ; \
 427 	      diff $(srcdir)/result/errors/$$name.err error.$$name` ; \
 428 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 429 	      rm result.$$name error.$$name ; \
 430 	  fi ; fi ; done)
 431 	@echo &quot;## Error cases regression tests (old 1.0)&quot;
 432 	-@(for i in $(srcdir)/test/errors10/*.xml ; do \
 433 	  name=`basename $$i`; \
 434 	  if [ ! -d $$i ] ; then \
 435 	  if [ ! -f $(srcdir)/result/errors10/$$name ] ; then \
 436 	      echo New test file $$name ; \
 437 	      $(CHECKER) $(top_builddir)/xmllint --oldxml10 $$i \
 438 	         2&gt; $(srcdir)/result/errors10/$$name.err \
 439 		 &gt; $(srcdir)/result/errors10/$$name ; \
 440 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 441 	  else \
 442 	      log=`$(CHECKER) $(top_builddir)/xmllint --oldxml10 $$i 2&gt; error.$$name &gt; result.$$name ; \
 443 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 444 	      diff $(srcdir)/result/errors10/$$name result.$$name ; \
 445 	      diff $(srcdir)/result/errors10/$$name.err error.$$name` ; \
 446 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 447 	      rm result.$$name error.$$name ; \
 448 	  fi ; fi ; done)
 449 	@echo &quot;## Error cases stream regression tests&quot;
 450 	-@(for i in $(srcdir)/test/errors/*.xml ; do \
 451 	  name=`basename $$i`; \
 452 	  if [ ! -d $$i ] ; then \
 453 	  if [ ! -f $(srcdir)/result/errors/$$name.str ] ; then \
 454 	      echo New test file $$name ; \
 455 	      $(CHECKER) $(top_builddir)/xmllint --stream $$i \
 456 	         2&gt; $(srcdir)/result/errors/$$name.str \
 457 		 &gt; /dev/null ; \
 458 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 459 	  else \
 460 	      log=`$(CHECKER) $(top_builddir)/xmllint --stream $$i 2&gt; error.$$name &gt; /dev/null ; \
 461 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 462 	      diff $(srcdir)/result/errors/$$name.str error.$$name` ; \
 463 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 464 	      rm error.$$name ; \
 465 	  fi ; fi ; done)
 466 
 467 Docbtests : xmllint$(EXEEXT)
 468 
 469 XMLenttests : xmllint$(EXEEXT)
 470 	@(echo &gt; .memdump)
 471 	@echo &quot;## XML entity subst regression tests&quot;
 472 	-@(for i in $(srcdir)/test/* ; do \
 473 	  name=`basename $$i`; \
 474 	  if [ ! -d $$i ] ; then \
 475 	  if [ ! -f $(srcdir)/result/noent/$$name ] ; then \
 476 	      echo New test file $$name ; \
 477 	      $(CHECKER) $(top_builddir)/xmllint --noent $$i &gt; $(srcdir)/result/noent/$$name ; \
 478 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 479 	  else \
 480 	      log=`$(CHECKER) $(top_builddir)/xmllint --noent $$i 2&gt;&amp;1 &gt; result.$$name ; \
 481 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 482 	      diff $(srcdir)/result/noent/$$name result.$$name ; \
 483 	      $(CHECKER) $(top_builddir)/xmllint --noent result.$$name 2&gt;&amp;1 &gt; result2.$$name ; \
 484 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 485 	      diff result.$$name result2.$$name` ; \
 486 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 487 	      rm result.$$name result2.$$name ; \
 488 	  fi ; fi ; done)
 489 
 490 URItests : testURI$(EXEEXT)
 491 	@(echo &gt; .memdump)
 492 	@echo &quot;## URI module regression tests&quot;
 493 	-@(for i in $(srcdir)/test/URI/*.data ; do \
 494 	  name=`basename $$i`; \
 495 	  if [ ! -d $$i ] ; then \
 496 	  if [ ! -f $(srcdir)/result/URI/$$name ] ; then \
 497 	      echo New test file $$name ; \
 498 	      $(CHECKER) $(top_builddir)/testURI -base &#39;http://foo.com/path/to/index.html?orig#help&#39; &lt; $$i &gt; $(srcdir)/result/URI/$$name ; \
 499 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 500 	  else \
 501 	      log=`$(CHECKER) $(top_builddir)/testURI -base &#39;http://foo.com/path/to/index.html?orig#help&#39; &lt; $$i 2&gt;&amp;1 &gt; result.$$name ; \
 502 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 503 	      diff $(srcdir)/result/URI/$$name result.$$name` ; \
 504 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 505 	      rm result.$$name ; \
 506 	  fi ; fi ; done)
 507 	-@(for i in $(srcdir)/test/URI/*.uri ; do \
 508 	  name=`basename $$i`; \
 509 	  if [ ! -d $$i ] ; then \
 510 	  if [ ! -f $(srcdir)/result/URI/$$name ] ; then \
 511 	      echo New test file $$name ; \
 512 	      $(CHECKER) $(top_builddir)/testURI &lt; $$i &gt; $(srcdir)/result/URI/$$name ; \
 513 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 514 	  else \
 515 	      log=`$(CHECKER) $(top_builddir)/testURI &lt; $$i 2&gt;&amp;1 &gt; result.$$name ; \
 516 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 517 	      diff $(srcdir)/result/URI/$$name result.$$name` ; \
 518 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 519 	      rm result.$$name ; \
 520 	  fi ; fi ; done)
 521 
 522 XPathtests : testXPath$(EXEEXT)
 523 	@(echo &gt; .memdump)
 524 	@echo &quot;## XPath regression tests&quot;
 525 	-@(if [ &quot;`$(top_builddir)/testXPath | grep &#39;support not compiled in&#39;`&quot; != &quot;&quot; ] ; \
 526 	  then echo Skipping debug not compiled in ; exit 0 ; fi ; \
 527 	  for i in $(srcdir)/test/XPath/expr/* ; do \
 528 	  name=`basename $$i`; \
 529 	  if [ ! -d $$i ] ; then \
 530 	  if [ ! -f $(srcdir)/result/XPath/expr/$$name ] ; then \
 531 	      echo New test file $$name ; \
 532 	      $(CHECKER) $(top_builddir)/testXPath -f --expr $$i &gt; $(srcdir)/result/XPath/expr/$$name 2&gt; /dev/null ; \
 533 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 534 	  else \
 535 	      log=`$(CHECKER) $(top_builddir)/testXPath -f --expr $$i &gt; result.$$name 2&gt; /dev/null ; \
 536 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 537 	      diff $(srcdir)/result/XPath/expr/$$name result.$$name` ; \
 538 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 539 	      rm result.$$name ; \
 540 	  fi ; fi ; done ; \
 541 	  for i in $(srcdir)/test/XPath/docs/* ; do \
 542 	  if [ ! -d $$i ] ; then \
 543 	  doc=`basename $$i`; \
 544 	  for j in $(srcdir)/test/XPath/tests/$$doc* ; do \
 545 	  if [ ! -f $$j ] ; then continue ; fi ; \
 546 	  name=`basename $$j`; \
 547 	  if [ ! -d $$j ] ; then \
 548 	  if [ ! -f $(srcdir)/result/XPath/tests/$$name ] ; then \
 549 	      echo New test file $$name ; \
 550 	      $(CHECKER) $(top_builddir)/testXPath -f -i $$i $$j &gt; $(srcdir)/result/XPath/tests/$$name ; \
 551 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 552 	  else \
 553 	      log=`$(CHECKER) $(top_builddir)/testXPath -f -i $$i $$j &gt; result.$$name ; \
 554 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 555 	      diff $(srcdir)/result/XPath/tests/$$name result.$$name` ; \
 556 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 557 	      rm result.$$name ; \
 558 	  fi ; fi ; done ; fi ; done)
 559 
 560 XPtrtests : testXPath$(EXEEXT)
 561 	@(echo &gt; .memdump)
 562 	@echo &quot;## XPointer regression tests&quot;
 563 	-@(if [ &quot;`$(top_builddir)/testXPath | grep &#39;support not compiled in&#39;`&quot; != &quot;&quot; ] ; \
 564 	  then echo Skipping debug not compiled in ; exit 0 ; fi ; \
 565 	  for i in $(srcdir)/test/XPath/docs/* ; do \
 566 	  if [ ! -d $$i ] ; then \
 567 	  doc=`basename $$i`; \
 568 	  for j in $(srcdir)/test/XPath/xptr/$$doc* ; do \
 569 	  if [ ! -f $$j ] ; then continue ; fi ; \
 570 	  name=`basename $$j`; \
 571 	  if [ ! -d $$j ] ; then \
 572 	  if [ ! -f $(srcdir)/result/XPath/xptr/$$name ] ; then \
 573 	      echo New test file $$name ; \
 574 	      $(CHECKER) $(top_builddir)/testXPath -xptr -f -i $$i $$j &gt; $(srcdir)/result/XPath/xptr/$$name 2&gt; /dev/null ; \
 575 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 576 	  else \
 577 	      log=`$(CHECKER) $(top_builddir)/testXPath -xptr -f -i $$i $$j &gt; result.$$name 2&gt; /dev/null ; \
 578 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 579 	      diff $(srcdir)/result/XPath/xptr/$$name result.$$name` ; \
 580 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 581 	      rm result.$$name ; \
 582 	  fi ; fi ; done ; fi ; done)
 583 
 584 XIncludetests : xmllint$(EXEEXT)
 585 	@(echo &gt; .memdump)
 586 	@echo &quot;## XInclude regression tests&quot;
 587 	-@(for i in $(srcdir)/test/XInclude/docs/* ; do \
 588 	  name=`basename $$i`; \
 589 	  if [ ! -d $$i ] ; then \
 590 	  if [ ! -f $(srcdir)/result/XInclude/$$name ] ; then \
 591 	      echo New test file $$name ; \
 592 	      $(CHECKER) $(top_builddir)/xmllint --nowarning --xinclude $$i &gt; $(srcdir)/result/XInclude/$$name 2&gt; $(srcdir)/result/XInclude/$$name.err ; \
 593 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 594 	  else \
 595 	      log=`$(CHECKER) $(top_builddir)/xmllint --nowarning --xinclude $$i &gt; result.$$name 2&gt;error.$$name ; \
 596 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 597 	      diff $(srcdir)/result/XInclude/$$name result.$$name ; \
 598 	      diff $(srcdir)/result/XInclude/$$name.err error.$$name` ; \
 599 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 600 	      rm result.$$name error.$$name ; \
 601 	  fi ; fi ; done)
 602 	-@(for i in $(srcdir)/test/XInclude/docs/* ; do \
 603 	  name=`basename $$i`; \
 604 	  if [ ! -d $$i ] ; then \
 605 	  if [ ! -f $(srcdir)/result/XInclude/$$name ] ; then \
 606 	      echo New test file $$name ; \
 607 	      $(CHECKER) $(top_builddir)/xmllint --nowarning --noxincludenode $$i &gt; $(srcdir)/result/XInclude/$$name 2&gt; $(srcdir)/result/XInclude/$$name.err ; \
 608 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 609 	  else \
 610 	      log=`$(CHECKER) $(top_builddir)/xmllint --nowarning --noxincludenode $$i &gt; result.$$name 2&gt;error.$$name ; \
 611 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 612 	      diff $(srcdir)/result/XInclude/$$name result.$$name ; \
 613 	      diff $(srcdir)/result/XInclude/$$name.err error.$$name` ; \
 614 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 615 	      rm result.$$name error.$$name ; \
 616 	  fi ; fi ; done)
 617 	@(echo &gt; .memdump)
 618 	@echo &quot;## XInclude xmlReader regression tests&quot;
 619 	-@(for i in $(srcdir)/test/XInclude/docs/* ; do \
 620 	  name=`basename $$i`; \
 621 	  if [ ! -d $$i ] ; then \
 622 	  if [ ! -f $(srcdir)/result/XInclude/$$name.rdr ] ; then \
 623 	      echo New test file $$name ; \
 624 	      $(CHECKER) $(top_builddir)/xmllint --nowarning --xinclude --stream --debug $$i &gt; $(srcdir)/result/XInclude/$$name.rdr ; \
 625 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 626 	  else \
 627 	      log=`$(CHECKER) $(top_builddir)/xmllint --nowarning --xinclude --stream --debug $$i &gt; result.$$name 2&gt;error.$$name ; \
 628 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 629 	      diff $(srcdir)/result/XInclude/$$name.err error.$$name ; \
 630 	      diff $(srcdir)/result/XInclude/$$name.rdr result.$$name` ; \
 631 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 632 	      rm result.$$name error.$$name ; \
 633 	  fi ; fi ; done)
 634 	-@(for i in $(srcdir)/test/XInclude/docs/* ; do \
 635 	  name=`basename $$i`; \
 636 	  if [ ! -d $$i ] ; then \
 637 	  if [ ! -f $(srcdir)/result/XInclude/$$name.rdr ] ; then \
 638 	      echo New test file $$name ; \
 639 	      $(CHECKER) $(top_builddir)/xmllint --nowarning --noxincludenode --stream --debug $$i &gt; $(srcdir)/result/XInclude/$$name.rdr ; \
 640 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 641 	  else \
 642 	      log=`$(CHECKER) $(top_builddir)/xmllint --nowarning --xinclude --stream --debug $$i &gt; result.$$name 2&gt;error.$$name ; \
 643 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 644 	      diff $(srcdir)/result/XInclude/$$name.err error.$$name ; \
 645 	      diff $(srcdir)/result/XInclude/$$name.rdr result.$$name` ; \
 646 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 647 	      rm result.$$name error.$$name ; \
 648 	  fi ; fi ; done)
 649 
 650 Scripttests : xmllint$(EXEEXT)
 651 	@(echo &gt; .memdump)
 652 	@echo &quot;## Scripts regression tests&quot;
 653 	@echo &quot;## Some of the base computations may be different if srcdir != .&quot;
 654 	-@(for i in $(srcdir)/test/scripts/*.script ; do \
 655 	  name=`basename $$i .script`; \
 656 	  xml=$(srcdir)/test/scripts/`basename $$i .script`.xml; \
 657 	  if [ -f $$xml ] ; then \
 658 	  if [ ! -f $(srcdir)/result/scripts/$$name ] ; then \
 659 	      echo New test file $$name ; \
 660 	      $(CHECKER) $(top_builddir)/xmllint --shell $$xml &lt; $$i &gt; $(srcdir)/result/scripts/$$name 2&gt; $(srcdir)/result/scripts/$$name.err ; \
 661 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 662 	  else \
 663 	      log=`$(CHECKER) $(top_builddir)/xmllint --shell $$xml &lt; $$i &gt; result.$$name 2&gt; result.$$name.err ; \
 664 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 665 	      diff $(srcdir)/result/scripts/$$name result.$$name ; \
 666 	      diff $(srcdir)/result/scripts/$$name.err result.$$name.err` ; \
 667 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 668 	      rm result.$$name result.$$name.err ; \
 669 	  fi ; fi ; done)
 670 
 671 Catatests : xmlcatalog$(EXEEXT)
 672 	@(echo &gt; .memdump)
 673 	@echo &quot;## Catalog regression tests&quot;
 674 	-@(for i in $(srcdir)/test/catalogs/*.script ; do \
 675 	  name=`basename $$i .script`; \
 676 	  xml=$(srcdir)/test/catalogs/`basename $$i .script`.xml; \
 677 	  if [ -f $$xml ] ; then \
 678 	  if [ ! -f $(srcdir)/result/catalogs/$$name ] ; then \
 679 	      echo New test file $$name ; \
 680 	      $(CHECKER) $(top_builddir)/xmlcatalog --shell $$xml &lt; $$i 2&gt;&amp;1 &gt; $(srcdir)/result/catalogs/$$name ; \
 681 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 682 	  else \
 683 	      log=`$(CHECKER) $(top_builddir)/xmlcatalog --shell $$xml &lt; $$i 2&gt;&amp;1 &gt; result.$$name ; \
 684 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 685 	      diff $(srcdir)/result/catalogs/$$name result.$$name` ; \
 686 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 687 	      rm result.$$name ; \
 688 	  fi ; fi ; done)
 689 	-@(for i in $(srcdir)/test/catalogs/*.script ; do \
 690 	  name=`basename $$i .script`; \
 691 	  sgml=$(srcdir)/test/catalogs/`basename $$i .script`.sgml; \
 692 	  if [ -f $$sgml ] ; then \
 693 	  if [ ! -f $(srcdir)/result/catalogs/$$name ] ; then \
 694 	      echo New test file $$name ; \
 695 	      $(CHECKER) $(top_builddir)/xmlcatalog --shell $$sgml &lt; $$i &gt; $(srcdir)/result/catalogs/$$name ; \
 696 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 697 	  else \
 698 	      log=`$(CHECKER) $(top_builddir)/xmlcatalog --shell $$sgml &lt; $$i &gt; result.$$name ; \
 699 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 700 	      diff $(srcdir)/result/catalogs/$$name result.$$name` ; \
 701 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 702 	      rm result.$$name ; \
 703 	  fi ; fi ; done)
 704 	@echo &quot;## Add and del operations on XML Catalogs&quot;
 705 	-@($(CHECKER) $(top_builddir)/xmlcatalog --create --noout $(srcdir)/result/catalogs/mycatalog; \
 706 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 707 	$(CHECKER) $(top_builddir)/xmlcatalog --noout --add public Pubid sysid $(srcdir)/result/catalogs/mycatalog; \
 708 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 709 	$(CHECKER) $(top_builddir)/xmlcatalog --noout --add public Pubid2 sysid2 $(srcdir)/result/catalogs/mycatalog; \
 710 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 711 	$(CHECKER) $(top_builddir)/xmlcatalog --noout --add public Pubid3 sysid3 $(srcdir)/result/catalogs/mycatalog; \
 712 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 713 	diff result/catalogs/mycatalog.full $(srcdir)/result/catalogs/mycatalog; \
 714 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 715 	$(CHECKER) $(top_builddir)/xmlcatalog --noout --del sysid $(srcdir)/result/catalogs/mycatalog; \
 716 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 717 	$(CHECKER) $(top_builddir)/xmlcatalog --noout --del sysid3 $(srcdir)/result/catalogs/mycatalog; \
 718 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 719 	$(CHECKER) $(top_builddir)/xmlcatalog --noout --del sysid2 $(srcdir)/result/catalogs/mycatalog; \
 720 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 721 	diff result/catalogs/mycatalog.empty $(srcdir)/result/catalogs/mycatalog; \
 722 	grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 723 	rm -f $(srcdir)/result/catalogs/mycatalog)
 724 
 725 SVGtests : xmllint$(EXEEXT)
 726 	@echo &quot;## SVG parsing regression tests&quot;
 727 	-@(for i in $(srcdir)/test/SVG/* ; do \
 728 	  name=`basename $$i`; \
 729 	  if [ ! -d $$i ] ; then \
 730 	  if [ ! -f $(srcdir)/result/SVG/$$name ] ; then \
 731 	      echo New test file $$name ; \
 732 	      $(CHECKER) $(top_builddir)/xmllint $$i &gt; $(srcdir)/result/SVG/$$name ; \
 733 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 734 	  else \
 735 	      echo Testing $$name ; \
 736 	      $(CHECKER) $(top_builddir)/xmllint $$i &gt; result.$$name ; \
 737 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 738 	      diff $(srcdir)/result/SVG/$$name result.$$name ; \
 739 	      $(CHECKER) $(top_builddir)/xmllint result.$$name &gt; result2.$$name ; \
 740 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 741 	      diff result.$$name result2.$$name ; \
 742 	      rm result.$$name result2.$$name ; \
 743 	  fi ; fi ; done)
 744 
 745 Threadtests : testThreads$(EXEEXT)
 746 	@echo &quot;## Threaded regression tests&quot;
 747 	-@($(CHECKER) $(top_builddir)/testThreads ; \
 748 	   grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;; \
 749 	   exit 0)
 750 
 751 Readertests : xmllint$(EXEEXT)
 752 	@(echo &gt; .memdump)
 753 	@echo &quot;## Reader regression tests&quot;
 754 	-@(for i in $(srcdir)/test/* ; do \
 755 	  name=`basename $$i`; \
 756 	  if [ ! -d $$i ] ; then \
 757 	  if [ ! -f $(srcdir)/result/$$name.rdr ] ; then \
 758 	      echo New test file $$name ; \
 759 	      $(CHECKER) $(top_builddir)/xmllint --nonet --debug --stream $$i &gt; $(srcdir)/result/$$name.rdr 2&gt;/dev/null ; \
 760 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 761 	  else \
 762 	      log=`$(CHECKER) $(top_builddir)/xmllint --nonet --debug --stream $$i &gt; result.$$name 2&gt;/dev/null ; \
 763 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 764 	      diff $(srcdir)/result/$$name.rdr result.$$name` ; \
 765 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 766 	      rm result.$$name ; \
 767 	  fi ; fi ; done)
 768 	@echo &quot;## Reader on memory regression tests&quot;
 769 	-@(for i in $(srcdir)/test/* ; do \
 770 	  name=`basename $$i`; \
 771 	  if [ ! -d $$i ] ; then \
 772 	  if [ ! -f $(srcdir)/result/$$name.rdr ] ; then \
 773 	      echo New test file $$name ; \
 774 	      $(CHECKER) $(top_builddir)/xmllint --memory --nonet --debug --stream $$i &gt; $(srcdir)/result/$$name.rdr 2&gt;/dev/null ; \
 775 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 776 	  else \
 777 	      log=`$(CHECKER) $(top_builddir)/xmllint --memory --nonet --debug --stream $$i &gt; result.$$name 2&gt;/dev/null ; \
 778 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 779 	      diff $(srcdir)/result/$$name.rdr result.$$name` ; \
 780 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 781 	      rm result.$$name ; \
 782 	  fi ; fi ; done)
 783 	@(echo &gt; .memdump)
 784 	@echo &quot;## Walker regression tests&quot;
 785 	-@(for i in $(srcdir)/test/* ; do \
 786 	  name=`basename $$i`; \
 787 	  if [ ! -d $$i ] ; then \
 788 	  if [ ! -f $(srcdir)/result/$$name.rdr ] ; then \
 789 	      echo New test file $$name ; \
 790 	      $(CHECKER) $(top_builddir)/xmllint --nonet --debug --walker $$i &gt; $(srcdir)/result/$$name.rdr 2&gt;/dev/null ; \
 791 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 792 	  else \
 793 	      log=`$(CHECKER) $(top_builddir)/xmllint --nonet --debug --walker $$i &gt; result.$$name 2&gt;/dev/null ; \
 794 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 795 	      diff $(srcdir)/result/$$name.rdr result.$$name` ; \
 796 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 797 	      rm result.$$name ; \
 798 	  fi ; fi ; done)
 799 	@echo &quot;## Reader entities substitution regression tests&quot;
 800 	-@(for i in $(srcdir)/test/* ; do \
 801 	  name=`basename $$i`; \
 802 	  if [ ! -d $$i ] ; then \
 803 	  if [ ! -f $(srcdir)/result/$$name.rde ] ; then \
 804 	      echo New test file $$name ; \
 805 	      $(CHECKER) $(top_builddir)/xmllint --noent --nonet --debug --stream $$i &gt; $(srcdir)/result/$$name.rde 2&gt;/dev/null ; \
 806 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 807 	  else \
 808 	      log=`$(CHECKER) $(top_builddir)/xmllint --noent --nonet --debug --stream $$i &gt; result.$$name 2&gt;/dev/null ; \
 809 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 810 	      diff $(srcdir)/result/$$name.rde result.$$name` ; \
 811 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 812 	      rm result.$$name ; \
 813 	  fi ; fi ; done)
 814 
 815 SAXtests : testSAX$(EXEEXT)
 816 	@(echo &gt; .memdump)
 817 	@echo &quot;## SAX1 callbacks regression tests&quot;
 818 	-@(for i in $(srcdir)/test/* ; do \
 819 	  name=`basename $$i`; \
 820 	  if [ ! -d $$i ] ; then \
 821 	  if [ ! -f $(srcdir)/result/$$name.sax ] ; then \
 822 	      echo New test file $$name ; \
 823 	      $(CHECKER) $(top_builddir)/testSAX $$i &gt; $(srcdir)/result/$$name.sax 2&gt; /dev/null ; \
 824 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 825 	  else \
 826 	      log=`$(CHECKER) $(top_builddir)/testSAX $$i &gt; result.$$name 2&gt; /dev/null ; \
 827 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 828 	      diff $(srcdir)/result/$$name.sax result.$$name` ; \
 829 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 830 	      rm result.$$name ; \
 831 	  fi ; fi ; done)
 832 	@echo &quot;## SAX2 callbacks regression tests&quot;
 833 	-@(for i in $(srcdir)/test/* ; do \
 834 	  name=`basename $$i`; \
 835 	  if [ ! -d $$i ] ; then \
 836 	  if [ ! -f $(srcdir)/result/$$name.sax2 ] ; then \
 837 	      echo New test file $$name ; \
 838 	      $(CHECKER) $(top_builddir)/testSAX --sax2 $$i &gt; $(srcdir)/result/$$name.sax2 2&gt; /dev/null ; \
 839 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 840 	  else \
 841 	      log=`$(CHECKER) $(top_builddir)/testSAX --sax2 $$i &gt; result.$$name 2&gt; /dev/null ; \
 842 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 843 	      diff $(srcdir)/result/$$name.sax2 result.$$name` ; \
 844 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 845 	      rm result.$$name ; \
 846 	  fi ; fi ; done)
 847 	@echo &quot;## SAX2 callbacks regression tests with entity substitution&quot;
 848 	-@(for i in $(srcdir)/test/* ; do \
 849 	  name=`basename $$i`; \
 850 	  if [ ! -d $$i ] ; then \
 851 	  if [ ! -f $(srcdir)/result/noent/$$name.sax2 ] ; then \
 852 	      echo New test file $$name ; \
 853 	      $(CHECKER) $(top_builddir)/testSAX --sax2 --noent $$i &gt; $(srcdir)/result/noent/$$name.sax2 2&gt; /dev/null ; \
 854 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 855 	  else \
 856 	      log=`$(CHECKER) $(top_builddir)/testSAX --sax2 --noent $$i &gt; result.$$name 2&gt; /dev/null ; \
 857 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 858 	      diff $(srcdir)/result/noent/$$name.sax2 result.$$name` ; \
 859 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 860 	      rm result.$$name ; \
 861 	  fi ; fi ; done)
 862 
 863 Validtests : xmllint$(EXEEXT)
 864 	@(echo &gt; .memdump)
 865 	@echo &quot;## Valid documents regression tests&quot;
 866 	-@(for i in $(srcdir)/test/VCM/* ; do \
 867 	  name=`basename $$i`; \
 868 	  if [ ! -d $$i ] ; then \
 869 	      log=`$(CHECKER) $(top_builddir)/xmllint --valid --noout --nowarning $$i ; \
 870 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;`;\
 871 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 872 	  fi ; done ; exit 0)
 873 	@echo &quot;## Validity checking regression tests&quot;
 874 	-@(for i in $(srcdir)/test/VC/* ; do \
 875 	  name=`basename $$i`; \
 876 	  if [ ! -d $$i ] ; then \
 877 	  if [ ! -f $(srcdir)/result/VC/$$name ] ; then \
 878 	      echo New test file $$name ; \
 879 	      $(CHECKER) $(top_builddir)/xmllint --noout --valid $$i 2&gt; $(srcdir)/result/VC/$$name ; \
 880 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 881 	  else \
 882 	      log=`$(CHECKER) $(top_builddir)/xmllint --noout --valid $$i 2&gt; result.$$name ; \
 883 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 884 	      diff $(srcdir)/result/VC/$$name result.$$name` ; \
 885 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 886 	      rm result.$$name ; \
 887 	  fi ; fi ; done)
 888 	@echo &quot;## General documents valid regression tests&quot;
 889 	-@(for i in $(srcdir)/test/valid/* ; do \
 890 	  name=`basename $$i`; \
 891 	  if [ ! -d $$i ] ; then \
 892 	  if [ ! -f $(srcdir)/result/valid/$$name ] ; then \
 893 	      echo New test file $$name ; \
 894 	      $(CHECKER) $(top_builddir)/xmllint --valid $$i &gt; $(srcdir)/result/valid/$$name 2&gt;$(srcdir)/result/valid/$$name.err ; \
 895 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 896 	  else \
 897 	      log=`$(CHECKER) $(top_builddir)/xmllint --valid $$i &gt; result.$$name 2&gt;error.$$name ; \
 898 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 899 	      diff $(srcdir)/result/valid/$$name result.$$name ; \
 900 	      diff $(srcdir)/result/valid/$$name.err error.$$name` ; \
 901 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 902 	      rm result.$$name error.$$name ; \
 903 	  fi ; fi ; done)
 904 
 905 Regexptests: testRegexp$(EXEEXT)
 906 	@(echo &gt; .memdump)
 907 	@echo &quot;## Regexp regression tests&quot;
 908 	-@(for i in $(srcdir)/test/regexp/* ; do \
 909 	  name=`basename $$i`; \
 910 	  if [ ! -d $$i ] ; then \
 911 	  if [ ! -f $(srcdir)/result/regexp/$$name ] ; then \
 912 	      echo New test file $$name ; \
 913 	      $(CHECKER) $(top_builddir)/testRegexp -i $$i &gt; $(srcdir)/result/regexp/$$name; \
 914 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 915 	  else \
 916 	      log=`$(CHECKER) $(top_builddir)/testRegexp -i $$i 2&gt;&amp;1 &gt; result.$$name ; \
 917 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 918 	      diff $(srcdir)/result/regexp/$$name result.$$name` ; \
 919 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 920 	      rm result.$$name ; \
 921 	  fi ; fi ; done)
<a name="3" id="anc3"></a>


 922 	@echo &quot;## Formal expresssions regression tests&quot;
 923 	-@(for i in $(srcdir)/test/expr/* ; do \
 924 	  name=`basename $$i`; \
 925 	  if [ ! -d $$i ] ; then \
 926 	  if [ ! -f $(srcdir)/result/expr/$$name ] ; then \
 927 	      echo New test file $$name ; \
 928 	      $(CHECKER) $(top_builddir)/testRegexp --expr -i $$i &gt; $(srcdir)/result/expr/$$name; \
 929 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 930 	  else \
 931 	      log=`$(CHECKER) $(top_builddir)/testRegexp --expr -i $$i 2&gt;&amp;1 &gt; result.$$name ; \
 932 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 933 	      diff $(srcdir)/result/expr/$$name result.$$name` ; \
 934 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 935 	      rm result.$$name ; \
 936 	  fi ; fi ; done)
 937 
 938 Automatatests: testAutomata$(EXEEXT)
 939 	@(echo &gt; .memdump)
 940 	@echo &quot;## Automata regression tests&quot;
 941 	-@(for i in $(srcdir)/test/automata/* ; do \
 942 	  name=`basename $$i`; \
 943 	  if [ ! -d $$i ] ; then \
 944 	  if [ ! -f $(srcdir)/result/automata/$$name ] ; then \
 945 	      echo New test file $$name ; \
 946 	      $(CHECKER) $(top_builddir)/testAutomata $$i &gt; $(srcdir)/result/automata/$$name; \
 947 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 948 	  else \
 949 	      log=`$(CHECKER) $(top_builddir)/testAutomata $$i 2&gt;&amp;1 &gt; result.$$name ; \
 950 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 951 	      diff $(srcdir)/result/automata/$$name result.$$name` ; \
 952 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
 953 	      rm result.$$name ; \
 954 	  fi ; fi ; done)
 955 
 956 dba100000.xml: dbgenattr.pl
 957 	@echo &quot;## generating dba100000.xml&quot;
 958 	@($(PERL) $(top_srcdir)/dbgenattr.pl 100000 &gt; dba100000.xml)
 959 
 960 Timingtests: xmllint$(EXEEXT) dba100000.xml
 961 	@echo &quot;## Timing tests to try to detect performance&quot;
 962 	@echo &quot;## as well a memory usage breakage when streaming&quot;
 963 	@echo &quot;## 1/ using the file interface&quot;
 964 	@echo &quot;## 2/ using the memory interface&quot;
 965 	@echo &quot;## 3/ repeated DOM parsing&quot;
 966 	@echo &quot;## 4/ repeated DOM validation&quot;
 967 	-@($(top_builddir)/xmllint --stream --timing dba100000.xml; \
 968 	   MEM=`cat .memdump | grep &quot;MEMORY ALLOCATED&quot; | awk &#39;{ print $$7}&#39;`;\
 969 	   if [ &quot;$$MEM&quot; != &quot;&quot; ] ; then echo Using $$MEM bytes ; fi ; \
 970 	   grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 971 	   exit 0)
 972 	-@($(top_builddir)/xmllint --stream --timing --memory dba100000.xml; \
 973 	   MEM=`cat .memdump | grep &quot;MEMORY ALLOCATED&quot; | awk &#39;{ print $$7}&#39;`;\
 974 	   if [ &quot;$$MEM&quot; != &quot;&quot; ] ; then echo Using $$MEM bytes ; fi ; \
 975 	   grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 976 	   exit 0)
 977 	-@($(top_builddir)/xmllint --noout --timing --repeat $(srcdir)/test/valid/REC-xml-19980210.xml; \
 978 	   MEM=`cat .memdump | grep &quot;MEMORY ALLOCATED&quot; | awk &#39;{ print $$7}&#39;`;\
 979 	   if [ &quot;$$MEM&quot; != &quot;&quot; ] ; then echo Using $$MEM bytes ; fi ; \
 980 	   grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 981 	   exit 0)
 982 
 983 VTimingtests: xmllint$(EXEEXT)
 984 	-@($(top_builddir)/xmllint --noout --timing --valid --repeat $(srcdir)/test/valid/REC-xml-19980210.xml; \
 985 	   MEM=`cat .memdump | grep &quot;MEMORY ALLOCATED&quot; | awk &#39;{ print $$7}&#39;`;\
 986 	   if [ &quot;$$MEM&quot; != &quot;&quot; ] ; then echo Using $$MEM bytes ; fi ; \
 987 	   grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
 988 	   exit 0)
 989 
 990 C14Ntests : testC14N$(EXEEXT)
 991 	@echo &quot;## C14N and XPath regression tests&quot;
 992 	-@(for m in with-comments without-comments 1-1-without-comments exc-without-comments ; do \
 993 	    for i in $(srcdir)/test/c14n/$$m/*.xml ; do  \
 994 		if [ ! -d $$i ] ; then \
 995 		    name=`basename $$i .xml`; \
 996 		    cmdline=&quot;$(CHECKER) $(top_builddir)/testC14N --$$m $$i&quot;; \
 997 		    if [ -f $(srcdir)/test/c14n/$$m/$$name.xpath ] ; then \
 998 			cmdline=&quot;$$cmdline $(srcdir)/test/c14n/$$m/$$name.xpath&quot;; \
 999 			if [ -f $(srcdir)/test/c14n/$$m/$$name.ns ] ; then \
1000 			    cmdline=&quot;$$cmdline &#39;`cat $(srcdir)/test/c14n/$$m/$$name.ns`&#39;&quot;; \
1001 			fi; \
1002 		    fi; \
1003 		    $$cmdline &gt; $(srcdir)/test/c14n/test.tmp 2&gt; /dev/null; \
1004 		    if [ $$? -eq 0 ]; then \
1005 			diff  $(srcdir)/result/c14n/$$m/$$name $(srcdir)/test/c14n/test.tmp; \
1006 			if [ $$? -ne 0 ]; then \
1007 			    echo &quot;Test $$m/$$name failed&quot;; \
1008 			    cat $(srcdir)/test/c14n/test.tmp; \
1009 			fi; \
1010 		    else \
1011 			echo &quot;C14N failed&quot;; \
1012 		    fi; \
1013 		    grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1014 		fi; \
1015 		rm -f $(srcdir)/test/c14n/test.tmp; \
1016 	    done; \
1017 	done)
1018 
1019 Schemastests: testSchemas$(EXEEXT)
1020 	@(echo &gt; .memdump)
1021 	@echo &quot;## Schemas regression tests&quot;
1022 	-@(for i in $(srcdir)/test/schemas/*_*.xsd ; do \
1023 	  name=`basename $$i | sed &#39;s+_.*++&#39;`; \
1024 	  sno=`basename $$i | sed &#39;s+.*_\(.*\).xsd+\1+&#39;`; \
1025 	  for j in $(srcdir)/test/schemas/&quot;$$name&quot;_*.xml ; do \
1026 	      if [ -f $$j ] ; then \
1027 	      xno=`basename $$j | sed &#39;s+.*_\(.*\).xml+\1+&#39;`; \
1028 	      if [ ! -f $(srcdir)/result/schemas/&quot;$$name&quot;_&quot;$$sno&quot;_&quot;$$xno&quot; ]; \
1029 	      then \
1030 		  echo New test file &quot;$$name&quot;_&quot;$$sno&quot;_&quot;$$xno&quot; ; \
1031 		  $(CHECKER) $(top_builddir)/testSchemas $$i $$j \
1032 		    &gt; $(srcdir)/result/schemas/&quot;$$name&quot;_&quot;$$sno&quot;_&quot;$$xno&quot; \
1033 		    2&gt; $(srcdir)/result/schemas/&quot;$$name&quot;_&quot;$$sno&quot;_&quot;$$xno&quot;.err; \
1034 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1035 	      else \
1036 	          log=`$(CHECKER) $(top_builddir)/testSchemas $$i $$j \
1037 		    &gt; res.$$name 2&gt; err.$$name;\
1038 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1039 	          diff $(srcdir)/result/schemas/&quot;$$name&quot;_&quot;$$sno&quot;_&quot;$$xno&quot; \
1040 		       res.$$name;\
1041 	          diff $(srcdir)/result/schemas/&quot;$$name&quot;_&quot;$$sno&quot;_&quot;$$xno&quot;.err \
1042 		       err.$$name;\
1043 		  grep Unimplemented err.$$name`; \
1044 	          if [ -n &quot;$$log&quot; ] ; then echo &quot;$$name&quot;_&quot;$$sno&quot;_&quot;$$xno&quot; result ; echo &quot;$$log&quot; ; fi ; \
1045 	          rm res.$$name err.$$name ; \
1046 	       fi ; fi ;\
1047 	  done; done)
1048 
1049 Relaxtests: xmllint$(EXEEXT)
1050 	@(echo &gt; .memdump)
1051 	@echo &quot;## Relax-NG regression tests&quot;
1052 	-@(for i in $(srcdir)/test/relaxng/*.rng ; do \
1053 	  name=`basename $$i | sed &#39;s+\.rng++&#39;`; \
1054 	  if [ ! -f $(srcdir)/result/relaxng/&quot;$$name&quot;_valid ] ; then \
1055 	      echo New schemas $$name ; \
1056 	      $(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --noout --relaxng $(srcdir)/test/relaxng/tutorA.rng $$i \
1057 		      &gt; $(srcdir)/result/relaxng/&quot;$$name&quot;_valid \
1058 		      2&gt; $(srcdir)/result/relaxng/&quot;$$name&quot;_err; \
1059 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1060 	  else \
1061 	      log=`$(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --noout --relaxng $(srcdir)/test/relaxng/tutorA.rng $$i \
1062 	      &gt; res.$$name 2&gt; err.$$name;\
1063 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1064 	      diff $(srcdir)/result/relaxng/&quot;$$name&quot;_valid \
1065 		   res.$$name;\
1066 	      diff $(srcdir)/result/relaxng/&quot;$$name&quot;_err \
1067 		   err.$$name | grep -v &quot;error detected at&quot;;\
1068 	      grep Unimplemented err.$$name`; \
1069 	      if [ -n &quot;$$log&quot; ] ; then echo schemas $$name result ; echo &quot;$$log&quot; ; fi ; \
1070 	      rm res.$$name err.$$name ; \
1071 	  fi; \
1072 	  for j in $(srcdir)/test/relaxng/&quot;$$name&quot;_*.xml ; do \
1073 	      if [ -f $$j ] ; then \
1074 	      xno=`basename $$j | sed &#39;s+.*_\(.*\).xml+\1+&#39;`; \
1075 	      if [ ! -f $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot; ]; \
1076 	      then \
1077 		  echo New test file &quot;$$name&quot;_&quot;$$xno&quot; ; \
1078 		  $(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --noout --relaxng $$i $$j \
1079 		    &gt; $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot; \
1080 		    2&gt; $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot;.err; \
1081 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1082 	      else \
1083 	          log=`$(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --noout --relaxng $$i $$j \
1084 		    &gt; res.$$name 2&gt; err.$$name;\
1085 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1086 	          diff $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot; \
1087 		       res.$$name;\
1088 	          diff $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot;.err \
1089 		       err.$$name | grep -v &quot;error detected at&quot;;\
1090 		  grep Unimplemented err.$$name`; \
1091 		  if [ -n &quot;$$log&quot; ] ; then echo &quot;$$name&quot;_&quot;$$xno&quot; result ; echo &quot;$$log&quot; ; fi ; \
1092 	          rm res.$$name err.$$name ; \
1093 	       fi ; fi ; \
1094 	  done; done)
1095 	@echo &quot;## Relax-NG streaming regression tests&quot;
1096 	-@(for i in $(srcdir)/test/relaxng/*.rng ; do \
1097 	  name=`basename $$i | sed &#39;s+\.rng++&#39;`; \
1098 	  for j in $(srcdir)/test/relaxng/&quot;$$name&quot;_*.xml ; do \
1099 	      if [ -f $$j ] ; then \
1100 	      xno=`basename $$j | sed &#39;s+.*_\(.*\).xml+\1+&#39;`; \
1101 	      if [ ! -f $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot; ]; \
1102 	      then \
1103 		  echo New test file &quot;$$name&quot;_&quot;$$xno&quot; ; \
1104 		  $(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --noout --relaxng $$i $$j \
1105 		    &gt; $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot; \
1106 		    2&gt; $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot;.err; \
1107 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1108 	      else \
1109 	          log=`$(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --noout --stream --relaxng $$i $$j \
1110 		    &gt; res.$$name 2&gt; err.$$name;\
1111 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1112 	          diff $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot; res.$$name;\
1113 		  if [ &quot;$$name&quot; != &quot;tutor10_1&quot; -a &quot;$$name&quot; != &quot;tutor10_2&quot; -a &quot;$$name&quot; != &quot;tutor3_2&quot; -a &quot;$$name&quot; != &quot;307377&quot; -a &quot;$$name&quot; != &quot;tutor8_2&quot; ] ; then \
1114 		      diff $(srcdir)/result/relaxng/&quot;$$name&quot;_&quot;$$xno&quot;.err \
1115 			   err.$$name | grep -v &quot;error detected at&quot;;\
1116 		  fi ; grep Unimplemented err.$$name`; \
1117 	          if [ -n &quot;$$log&quot; ] ; then echo &quot;$$name&quot;_&quot;$$xno&quot; result ; echo &quot;$$log&quot; ; fi ; \
1118 	          rm res.$$name err.$$name ; \
1119 	       fi ; fi ; \
1120 	  done; done)
1121 
1122 Schematrontests: xmllint$(EXEEXT)
1123 	@(echo &gt; .memdump)
1124 	@echo &quot;## Schematron regression tests&quot;
1125 	-@(for i in $(srcdir)/test/schematron/*.sct ; do \
1126 	  name=`basename $$i | sed &#39;s+\.sct++&#39;`; \
1127 	  for j in $(srcdir)/test/schematron/&quot;$$name&quot;_*.xml ; do \
1128 	      if [ -f $$j ] ; then \
1129 	      xno=`basename $$j | sed &#39;s+.*_\(.*\).xml+\1+&#39;`; \
1130 	      if [ ! -f $(srcdir)/result/schematron/&quot;$$name&quot;_&quot;$$xno&quot; ]; \
1131 	      then \
1132 		  echo New test file &quot;$$name&quot;_&quot;$$xno&quot; ; \
1133 		  $(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --schematron $$i $$j \
1134 		    &gt; $(srcdir)/result/schematron/&quot;$$name&quot;_&quot;$$xno&quot; \
1135 		    2&gt; $(srcdir)/result/schematron/&quot;$$name&quot;_&quot;$$xno&quot;.err; \
1136 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1137 	      else \
1138 	          log=`$(CHECKER) $(top_builddir)/xmllint$(EXEEXT) --schematron $$i $$j \
1139 		    &gt; res.$$name 2&gt; err.$$name;\
1140 	          grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1141 	          diff $(srcdir)/result/schematron/&quot;$$name&quot;_&quot;$$xno&quot; \
1142 		       res.$$name;\
1143 	          diff $(srcdir)/result/schematron/&quot;$$name&quot;_&quot;$$xno&quot;.err \
1144 		       err.$$name | grep -v &quot;error detected at&quot;;\
1145 		  grep Unimplemented err.$$name`; \
1146 		  if [ -n &quot;$$log&quot; ] ; then echo &quot;$$name&quot;_&quot;$$xno&quot; result ; echo &quot;$$log&quot; ; fi ; \
1147 	          rm res.$$name err.$$name ; \
1148 	       fi ; fi ; \
1149 	  done; done)
1150 
1151 RelaxNGPythonTests:
1152 	@(if [ -x $(PYTHON) ] ; then \
1153 	    PYTHONPATH=$(top_builddir)/python:$(top_builddir)/python/.libs:$$PYTHONPATH ; \
1154 	    export PYTHONPATH; \
1155 	    LD_LIBRARY_PATH=&quot;$(top_builddir)/.libs:$$LD_LIBRARY_PATH&quot; ; \
1156 	    export LD_LIBRARY_PATH; \
1157 	    echo &quot;## Relax-NG Python based test suite 1&quot; ; \
1158 	    $(CHECKER) $(PYTHON) $(srcdir)/check-relaxng-test-suite.py ; \
1159 	    echo &quot;## Relax-NG Python based test suite 2&quot; ; \
1160 	    $(CHECKER) $(PYTHON) $(srcdir)/check-relaxng-test-suite2.py ; \
1161 	  fi)
1162 
1163 SchemasPythonTests:
1164 	@(if [ -x $(PYTHON) ] ; then \
1165 	    PYTHONPATH=$(top_builddir)/python:$(top_builddir)/python/.libs:$$PYTHONPATH; \
1166 	    export PYTHONPATH; \
1167 	    LD_LIBRARY_PATH=&quot;$(top_builddir)/.libs:$$LD_LIBRARY_PATH&quot; ; \
1168 	    export LD_LIBRARY_PATH; \
1169 	    echo &quot;## XML Schemas datatypes Python based test suite&quot; ; \
1170 	    echo &quot;## It is normal to see 11 errors reported&quot; ; \
1171 	    $(CHECKER) $(PYTHON) $(srcdir)/check-xsddata-test-suite.py ; \
1172 	  fi)
1173 	@(if [ -x $(PYTHON) -a -d xstc ] ; then cd xstc ; $(MAKE) CHECKER=&quot;$(CHECKER)&quot; pytests ; fi)
1174 
1175 Patterntests: xmllint$(EXEEXT)
1176 	@(echo &gt; .memdump)
1177 	@echo &quot;## Pattern regression tests&quot;
1178 	-@(for i in $(srcdir)/test/pattern/*.pat ; do \
1179 	  name=`basename $$i .pat`; \
1180 	  if [ -f $(srcdir)/test/pattern/$$name.xml ] ; then \
1181 	  if [ ! -f $(srcdir)/result/pattern/$$name ] ; then \
1182 	      rm -f result.$$name ; \
1183 	      echo New test file $$name ; \
1184 	      for pat in `cat $$i` ; do \
1185 	      $(CHECKER) $(top_builddir)/xmllint --walker --pattern $$pat $(srcdir)/test/pattern/$$name.xml &gt;&gt; $(srcdir)/result/pattern/$$name ; \
1186 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1187 	      done ;\
1188 	  else \
1189 	      rm -f result.$$name ; \
1190 	      lst=`cat $$i` ; \
1191 	      log=`for pat in $$lst ; do $(CHECKER) $(top_builddir)/xmllint --walker --pattern $$pat $(srcdir)/test/pattern/$$name.xml 2&gt;&amp;1 &gt;&gt; result.$$name ; \
1192 	      grep &quot;MORY ALLO&quot; .memdump  | grep -v &quot;MEMORY ALLOCATED : 0&quot;;\
1193 	      done ;\
1194 	      diff $(srcdir)/result/pattern/$$name result.$$name` ; \
1195 	      if [ -n &quot;$$log&quot; ] ; then echo $$name result ; echo &quot;$$log&quot; ; fi ; \
1196 	      rm result.$$name ; \
1197 	  fi ; fi ; done ;)
1198 
1199 ModuleTests: testModule$(EXEEXT) testdso.la
1200 	@echo &quot;## Module tests&quot;
1201 	@(./testModule$(EXEEXT))
1202 
1203 cleanup:
1204 	-@(find . -name .\#\* -exec rm {} \;)
1205 	-@(find . -name \*.gcda -o -name \*.gcno -exec rm -f {} \;)
1206 	-@(find . -name \*.orig -o -name \*.rej -o -name \*.old -exec rm -f {} \;)
1207 
1208 dist-hook: cleanup libxml2.spec
1209 	-cp libxml2.spec $(distdir)
1210 	(cd $(srcdir) ; tar -cf - --exclude CVS --exclude .svn --exclude .git win32 macos os400 vms VxWorks bakefile test result) | (cd $(distdir); tar xf -)
1211 
1212 dist-source: distdir
1213 	$(AMTAR) -chof - --exclude Tests --exclude test --exclude result $(distdir) | GZIP=$(GZIP_ENV) gzip -c &gt;`echo &quot;$(distdir)&quot; | sed &quot;s+libxml2+libxml2-sources+&quot;`.tar.gz
1214 
1215 dist-test: distdir
1216 	(mkdir -p $(distdir))
1217 	(cd $(srcdir) ; tar -cf - --exclude CVS --exclude .svn --exclude .git xstc/Tests) | (cd $(distdir); tar xf -)
1218 	tar -cf - $(distdir)/test $(distdir)/result $(distdir)/xstc/Tests  $(distdir)/Makefile.tests $(distdir)/README $(distdir)/README.tests $(distdir)/AUTHORS $(distdir)/testapi.c $(distdir)/runtest.c $(distdir)/runsuite.c | GZIP=$(GZIP_ENV) gzip -c &gt;`echo &quot;$(distdir)&quot; | sed &quot;s+libxml2+libxml2-tests+&quot;`.tar.gz
1219 	@(rm -rf $(distdir)/xstc/Test)
1220 
1221 cleantar:
1222 	@(rm -f libxml*.tar.gz COPYING.LIB)
1223 
1224 rpm: cleanup cleantar
1225 	@(unset CDPATH ; $(MAKE) dist-source dist &amp;&amp; rpmbuild -ta $(distdir).tar.gz)
1226 
1227 ## We create xml2Conf.sh here and not from configure because we want
1228 ## to get the paths expanded correctly.  Macros like srcdir are given
1229 ## the value NONE in configure if the user doesn&#39;t specify them (this
1230 ## is an autoconf feature, not a bug).
1231 
1232 xml2Conf.sh: xml2Conf.sh.in Makefile
1233 ## Use sed and then mv to avoid problems if the user interrupts.
1234 	sed -e &#39;s?\@XML_LIBDIR\@?$(XML_LIBDIR)?g&#39; \
1235 	    -e &#39;s?\@XML_INCLUDEDIR\@?$(XML_INCLUDEDIR)?g&#39; \
1236 	    -e &#39;s?\@VERSION\@?$(VERSION)?g&#39; \
1237 	    -e &#39;s?\@XML_LIBS\@?$(XML_LIBS)?g&#39; \
<a name="4" id="anc4"></a>
1238 	       &lt; $(srcdir)/xml2Conf.sh.in &gt; xml2Conf.tmp \
1239 	&amp;&amp; mv xml2Conf.tmp xml2Conf.sh
1240 
1241 CLEANFILES = runxmlconf.log test.out xml2Conf.sh *.gcda *.gcno *.res
1242 DISTCLEANFILES = COPYING missing.lst
1243 
1244 confexecdir=$(libdir)
1245 confexec_DATA = xml2Conf.sh
1246 CVS_EXTRA_DIST=
1247 EXTRA_DIST = xml2-config.in xml2Conf.sh.in libxml.spec.in libxml2.spec \
1248              libxml.m4 Copyright check-xml-test-suite.py gentest.py \
1249 	     check-relaxng-test-suite.py check-relaxng-test-suite2.py \
1250 	     check-xsddata-test-suite.py check-xinclude-test-suite.py \
1251              example/Makefile.am example/gjobread.c example/gjobs.xml \
1252 	     $(man_MANS) libxml-2.0.pc.in libxml-2.0-uninstalled.pc.in \
1253 	     libxml2-config.cmake.in autogen.sh \
1254 	     trionan.c trionan.h triostr.c triostr.h trio.c trio.h \
1255 	     triop.h triodef.h libxml.h elfgcchack.h xzlib.h buf.h \
<a name="5" id="anc5"></a><span class="line-modified">1256 	     enc.h save.h testThreadsWin32.c genUnicode.py TODO_SCHEMAS \</span>
1257 	     dbgen.pl dbgenattr.pl regressions.py regressions.xml \
1258 	     README.tests Makefile.tests libxml2.syms timsort.h \
1259 	     README.zOS \
1260 	     $(CVS_EXTRA_DIST)
1261 
1262 
1263 pkgconfigdir = $(libdir)/pkgconfig
1264 pkgconfig_DATA = libxml-2.0.pc
1265 
1266 cmakedir = $(libdir)/cmake/libxml2
1267 cmake_DATA = libxml2-config.cmake
1268 
1269 #
1270 # Install the tests program sources as examples 
1271 #
1272 BASE_DIR=$(datadir)/doc
1273 DOC_MODULE=libxml2-$(VERSION)
1274 EXAMPLES_DIR=$(BASE_DIR)/$(DOC_MODULE)/examples
1275 
1276 install-data-local: 
1277 	$(MKDIR_P) $(DESTDIR)$(BASE_DIR)/$(DOC_MODULE)
1278 	-$(INSTALL) -m 0644 $(srcdir)/Copyright $(DESTDIR)$(BASE_DIR)/$(DOC_MODULE)
1279 	$(MKDIR_P) $(DESTDIR)$(EXAMPLES_DIR)
1280 	-$(INSTALL) -m 0644 $(srcdir)/xmllint.c $(DESTDIR)$(EXAMPLES_DIR)
1281 	-$(INSTALL) -m 0644 $(srcdir)/testSAX.c $(DESTDIR)$(EXAMPLES_DIR)
1282 	-$(INSTALL) -m 0644 $(srcdir)/testHTML.c $(DESTDIR)$(EXAMPLES_DIR)
1283 	-$(INSTALL) -m 0644 $(srcdir)/testXPath.c $(DESTDIR)$(EXAMPLES_DIR)
1284 
1285 uninstall-local:
1286 	rm -f $(DESTDIR)$(EXAMPLES_DIR)/testXPath.c
1287 	rm -f $(DESTDIR)$(EXAMPLES_DIR)/testHTML.c
1288 	rm -f $(DESTDIR)$(EXAMPLES_DIR)/testSAX.c
1289 	rm -f $(DESTDIR)$(EXAMPLES_DIR)/xmllint.c
1290 	rm -rf $(DESTDIR)$(EXAMPLES_DIR)
1291 	rm -f $(DESTDIR)$(BASE_DIR)/$(DOC_MODULE)/Copyright
1292 	rm -rf $(DESTDIR)$(BASE_DIR)/$(DOC_MODULE)
1293 
1294 tst: tst.c
1295 	$(CC) $(CFLAGS) -Iinclude -o tst tst.c .libs/libxml2.a -lpthread -lm -lz -llzma
1296 
1297 sparse: clean
1298 	$(MAKE) CC=cgcc
1299 
1300 #
1301 # Coverage support, largely borrowed from libvirt
1302 # Both binaries comes from the lcov package in Fedora
1303 #
1304 LCOV = /usr/bin/lcov
1305 GENHTML = /usr/bin/genhtml
1306 
1307 cov: clean-cov
1308 	if [ &quot;`echo $(LDFLAGS) | grep coverage`&quot; = &quot;&quot; ] ; then \
1309 	    echo not configured with coverage; exit 1 ; fi
1310 	if [ ! -x $(LCOV) -o ! -x $(GENHTML) ] ; then \
1311 	    echo Need $(LCOV) and $(GENHTML) excecutables; exit 1 ; fi
1312 	-@($(MAKE) check)
1313 	-@(./runsuite$(EXEEXT))
1314 	mkdir $(top_builddir)/coverage
1315 	$(LCOV) -c -o $(top_builddir)/coverage/libxml2.info.tmp -d $(top_srcdir)
1316 	$(LCOV) -r $(top_builddir)/coverage/libxml2.info.tmp -o $(top_builddir)/coverage/libxml2.info *usr*
1317 	rm $(top_builddir)/coverage/libxml2.info.tmp
1318 	$(GENHTML) -s -t &quot;libxml2&quot; -o $(top_builddir)/coverage --legend $(top_builddir)/coverage/libxml2.info
1319 	echo &quot;Coverage report is in $(top_builddir)/coverage/index.html&quot;
1320 
1321 clean-cov:
1322 	rm -rf $(top_builddir)/coverage
1323 
<a name="6" id="anc6"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="6" type="hidden" />
</body>
</html>