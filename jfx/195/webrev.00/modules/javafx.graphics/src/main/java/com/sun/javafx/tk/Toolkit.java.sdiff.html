<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.graphics/src/main/java/com/sun/javafx/tk/Toolkit.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../glass/ui/win/WinApplication.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>modules/javafx.graphics/src/main/java/com/sun/javafx/tk/Toolkit.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
136         &quot;api-ms-win-core-util-l1-1-0&quot;,
137         &quot;api-ms-win-crt-conio-l1-1-0&quot;,
138         &quot;api-ms-win-crt-convert-l1-1-0&quot;,
139         &quot;api-ms-win-crt-environment-l1-1-0&quot;,
140         &quot;api-ms-win-crt-filesystem-l1-1-0&quot;,
141         &quot;api-ms-win-crt-heap-l1-1-0&quot;,
142         &quot;api-ms-win-crt-locale-l1-1-0&quot;,
143         &quot;api-ms-win-crt-math-l1-1-0&quot;,
144         &quot;api-ms-win-crt-multibyte-l1-1-0&quot;,
145         &quot;api-ms-win-crt-private-l1-1-0&quot;,
146         &quot;api-ms-win-crt-process-l1-1-0&quot;,
147         &quot;api-ms-win-crt-runtime-l1-1-0&quot;,
148         &quot;api-ms-win-crt-stdio-l1-1-0&quot;,
149         &quot;api-ms-win-crt-string-l1-1-0&quot;,
150         &quot;api-ms-win-crt-time-l1-1-0&quot;,
151         &quot;api-ms-win-crt-utility-l1-1-0&quot;,
152         &quot;ucrtbase&quot;,
153 
154         // Finally load VS 2017 DLLs in the following order
155         &quot;vcruntime140&quot;,
<span class="line-modified">156         &quot;msvcp140&quot;,</span>
<span class="line-modified">157         &quot;concrt140&quot;</span>
158 };
159 
160     private static String lookupToolkitClass(String name) {
161         if (&quot;prism&quot;.equalsIgnoreCase(name)) {
162             return QUANTUM_TOOLKIT;
163         } else if (&quot;quantum&quot;.equalsIgnoreCase(name)) {
164             return QUANTUM_TOOLKIT;
165         }
166         return name;
167     }
168 
169     public static synchronized void loadMSWindowsLibraries() {
170         for (String libName : msLibNames) {
171             try {
172                 NativeLibLoader.loadLibrary(libName);
173             } catch (Throwable t) {
174                 if (verbose) {
175                     System.err.println(&quot;Error: failed to load &quot;
176                             + libName + &quot;.dll : &quot; + t);
177                 }
</pre>
<hr />
<pre>
190             return DEFAULT_TOOLKIT;
191         } else if (PlatformUtil.isAndroid()) {
192            return DEFAULT_TOOLKIT;
193         }
194 
195         throw new UnsupportedOperationException(System.getProperty(&quot;os.name&quot;) + &quot; is not supported&quot;);
196     }
197 
198     public static synchronized Toolkit getToolkit() {
199         if (TOOLKIT != null) {
200             return TOOLKIT;
201         }
202 
203         AccessController.doPrivileged((PrivilegedAction&lt;Object&gt;) () -&gt; {
204             // Get the javafx.version and javafx.runtime.version from a preconstructed
205             // java class, VersionInfo, created at build time.
206             VersionInfo.setupSystemProperties();
207             return null;
208         });
209 
<span class="line-modified">210         // This loading of msvcp140.dll and vcruntime140.dll (VS2017) is required on Windows platforms</span>
211         if (PlatformUtil.isWindows()) {
212             loadMSWindowsLibraries();
213         }
214 
215         boolean userSpecifiedToolkit = true;
216 
217         // Check a system property to see if there is a specific toolkit to use.
218         // This is not a doPriviledged check so that applets cannot use this.
219         String forcedToolkit = null;
220         try {
221             forcedToolkit = System.getProperty(&quot;javafx.toolkit&quot;);
222         } catch (SecurityException ex) {}
223 
224         if (forcedToolkit == null) {
225             forcedToolkit = tk;
226         }
227         if (forcedToolkit == null) {
228             userSpecifiedToolkit = false;
229             forcedToolkit = getDefaultToolkit();
230         }
</pre>
</td>
<td>
<hr />
<pre>
136         &quot;api-ms-win-core-util-l1-1-0&quot;,
137         &quot;api-ms-win-crt-conio-l1-1-0&quot;,
138         &quot;api-ms-win-crt-convert-l1-1-0&quot;,
139         &quot;api-ms-win-crt-environment-l1-1-0&quot;,
140         &quot;api-ms-win-crt-filesystem-l1-1-0&quot;,
141         &quot;api-ms-win-crt-heap-l1-1-0&quot;,
142         &quot;api-ms-win-crt-locale-l1-1-0&quot;,
143         &quot;api-ms-win-crt-math-l1-1-0&quot;,
144         &quot;api-ms-win-crt-multibyte-l1-1-0&quot;,
145         &quot;api-ms-win-crt-private-l1-1-0&quot;,
146         &quot;api-ms-win-crt-process-l1-1-0&quot;,
147         &quot;api-ms-win-crt-runtime-l1-1-0&quot;,
148         &quot;api-ms-win-crt-stdio-l1-1-0&quot;,
149         &quot;api-ms-win-crt-string-l1-1-0&quot;,
150         &quot;api-ms-win-crt-time-l1-1-0&quot;,
151         &quot;api-ms-win-crt-utility-l1-1-0&quot;,
152         &quot;ucrtbase&quot;,
153 
154         // Finally load VS 2017 DLLs in the following order
155         &quot;vcruntime140&quot;,
<span class="line-modified">156         &quot;vcruntime140_1&quot;,</span>
<span class="line-modified">157         &quot;msvcp140&quot;</span>
158 };
159 
160     private static String lookupToolkitClass(String name) {
161         if (&quot;prism&quot;.equalsIgnoreCase(name)) {
162             return QUANTUM_TOOLKIT;
163         } else if (&quot;quantum&quot;.equalsIgnoreCase(name)) {
164             return QUANTUM_TOOLKIT;
165         }
166         return name;
167     }
168 
169     public static synchronized void loadMSWindowsLibraries() {
170         for (String libName : msLibNames) {
171             try {
172                 NativeLibLoader.loadLibrary(libName);
173             } catch (Throwable t) {
174                 if (verbose) {
175                     System.err.println(&quot;Error: failed to load &quot;
176                             + libName + &quot;.dll : &quot; + t);
177                 }
</pre>
<hr />
<pre>
190             return DEFAULT_TOOLKIT;
191         } else if (PlatformUtil.isAndroid()) {
192            return DEFAULT_TOOLKIT;
193         }
194 
195         throw new UnsupportedOperationException(System.getProperty(&quot;os.name&quot;) + &quot; is not supported&quot;);
196     }
197 
198     public static synchronized Toolkit getToolkit() {
199         if (TOOLKIT != null) {
200             return TOOLKIT;
201         }
202 
203         AccessController.doPrivileged((PrivilegedAction&lt;Object&gt;) () -&gt; {
204             // Get the javafx.version and javafx.runtime.version from a preconstructed
205             // java class, VersionInfo, created at build time.
206             VersionInfo.setupSystemProperties();
207             return null;
208         });
209 
<span class="line-modified">210         // Load required Microsoft runtime DLLs on Windows platforms</span>
211         if (PlatformUtil.isWindows()) {
212             loadMSWindowsLibraries();
213         }
214 
215         boolean userSpecifiedToolkit = true;
216 
217         // Check a system property to see if there is a specific toolkit to use.
218         // This is not a doPriviledged check so that applets cannot use this.
219         String forcedToolkit = null;
220         try {
221             forcedToolkit = System.getProperty(&quot;javafx.toolkit&quot;);
222         } catch (SecurityException ex) {}
223 
224         if (forcedToolkit == null) {
225             forcedToolkit = tk;
226         }
227         if (forcedToolkit == null) {
228             userSpecifiedToolkit = false;
229             forcedToolkit = getDefaultToolkit();
230         }
</pre>
</td>
</tr>
</table>
<center><a href="../../glass/ui/win/WinApplication.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>