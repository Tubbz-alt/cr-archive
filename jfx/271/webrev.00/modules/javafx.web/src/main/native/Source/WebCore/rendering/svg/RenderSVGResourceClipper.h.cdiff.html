<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/rendering/svg/RenderSVGResourceClipper.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="RenderSVGResourceClipper.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="RenderSVGResourceContainer.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/rendering/svg/RenderSVGResourceClipper.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 28,12 ***</span>
  namespace WebCore {
  
  class GraphicsContext;
  class ImageBuffer;
  
<span class="line-removed">- typedef std::unique_ptr&lt;ImageBuffer&gt; ClipperMaskImage;</span>
<span class="line-removed">- </span>
  class RenderSVGResourceClipper final : public RenderSVGResourceContainer {
      WTF_MAKE_ISO_ALLOCATED(RenderSVGResourceClipper);
  public:
      RenderSVGResourceClipper(SVGClipPathElement&amp;, RenderStyle&amp;&amp;);
      virtual ~RenderSVGResourceClipper();
<span class="line-new-header">--- 28,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 45,11 ***</span>
  
      bool applyResource(RenderElement&amp;, const RenderStyle&amp;, GraphicsContext*&amp;, OptionSet&lt;RenderSVGResourceMode&gt;) override;
      // clipPath can be clipped too, but don&#39;t have a boundingBox or repaintRect. So we can&#39;t call
      // applyResource directly and use the rects from the object, since they are empty for RenderSVGResources
      // FIXME: We made applyClippingToContext public because we cannot call applyResource on HTML elements (it asserts on RenderObject::objectBoundingBox)
<span class="line-modified">!     bool applyClippingToContext(RenderElement&amp;, const FloatRect&amp;, const FloatRect&amp;, GraphicsContext&amp;);</span>
      FloatRect resourceBoundingBox(const RenderObject&amp;) override;
  
      RenderSVGResourceType resourceType() const override { return ClipperResourceType; }
  
      bool hitTestClipContent(const FloatRect&amp;, const FloatPoint&amp;);
<span class="line-new-header">--- 43,11 ---</span>
  
      bool applyResource(RenderElement&amp;, const RenderStyle&amp;, GraphicsContext*&amp;, OptionSet&lt;RenderSVGResourceMode&gt;) override;
      // clipPath can be clipped too, but don&#39;t have a boundingBox or repaintRect. So we can&#39;t call
      // applyResource directly and use the rects from the object, since they are empty for RenderSVGResources
      // FIXME: We made applyClippingToContext public because we cannot call applyResource on HTML elements (it asserts on RenderObject::objectBoundingBox)
<span class="line-modified">!     bool applyClippingToContext(RenderElement&amp;, const FloatRect&amp;, GraphicsContext&amp;);</span>
      FloatRect resourceBoundingBox(const RenderObject&amp;) override;
  
      RenderSVGResourceType resourceType() const override { return ClipperResourceType; }
  
      bool hitTestClipContent(const FloatRect&amp;, const FloatPoint&amp;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 58,22 ***</span>
  
  protected:
      bool selfNeedsClientInvalidation() const override { return (everHadLayout() || m_clipper.size()) &amp;&amp; selfNeedsLayout(); }
  
  private:
      void element() const = delete;
  
      const char* renderName() const override { return &quot;RenderSVGResourceClipper&quot;; }
      bool isSVGResourceClipper() const override { return true; }
  
      bool pathOnlyClipping(GraphicsContext&amp;, const AffineTransform&amp;, const FloatRect&amp;);
<span class="line-modified">!     bool drawContentIntoMaskImage(const ClipperMaskImage&amp;, const FloatRect&amp; objectBoundingBox);</span>
      void calculateClipContentRepaintRect();
<span class="line-modified">!     ClipperMaskImage&amp; addRendererToClipper(const RenderObject&amp;);</span>
  
      FloatRect m_clipBoundaries;
<span class="line-modified">!     HashMap&lt;const RenderObject*, ClipperMaskImage&gt; m_clipper;</span>
  };
  
  }
  
  SPECIALIZE_TYPE_TRAITS_BEGIN(WebCore::RenderSVGResourceClipper)
<span class="line-new-header">--- 56,41 ---</span>
  
  protected:
      bool selfNeedsClientInvalidation() const override { return (everHadLayout() || m_clipper.size()) &amp;&amp; selfNeedsLayout(); }
  
  private:
<span class="line-added">+     struct ClipperData {</span>
<span class="line-added">+         FloatRect objectBoundingBox;</span>
<span class="line-added">+         AffineTransform absoluteTransform;</span>
<span class="line-added">+         std::unique_ptr&lt;ImageBuffer&gt; imageBuffer;</span>
<span class="line-added">+ </span>
<span class="line-added">+         ClipperData() = default;</span>
<span class="line-added">+         ClipperData(std::unique_ptr&lt;ImageBuffer&gt;&amp;&amp; buffer, const FloatRect&amp; boundingBox, const AffineTransform&amp; transform)</span>
<span class="line-added">+             : objectBoundingBox(boundingBox)</span>
<span class="line-added">+             , absoluteTransform(transform)</span>
<span class="line-added">+             , imageBuffer(WTFMove(buffer))</span>
<span class="line-added">+         {</span>
<span class="line-added">+         }</span>
<span class="line-added">+ </span>
<span class="line-added">+         bool isValidForGeometry(const FloatRect&amp; boundingBox, const AffineTransform&amp; transform) const</span>
<span class="line-added">+         {</span>
<span class="line-added">+             return imageBuffer &amp;&amp; objectBoundingBox == boundingBox &amp;&amp; absoluteTransform == transform;</span>
<span class="line-added">+         }</span>
<span class="line-added">+     };</span>
<span class="line-added">+ </span>
      void element() const = delete;
  
      const char* renderName() const override { return &quot;RenderSVGResourceClipper&quot;; }
      bool isSVGResourceClipper() const override { return true; }
  
      bool pathOnlyClipping(GraphicsContext&amp;, const AffineTransform&amp;, const FloatRect&amp;);
<span class="line-modified">!     bool drawContentIntoMaskImage(ImageBuffer&amp;, const FloatRect&amp; objectBoundingBox);</span>
      void calculateClipContentRepaintRect();
<span class="line-modified">!     ClipperData&amp; addRendererToClipper(const RenderObject&amp;);</span>
  
      FloatRect m_clipBoundaries;
<span class="line-modified">!     HashMap&lt;const RenderObject*, ClipperData&gt; m_clipper;</span>
  };
  
  }
  
  SPECIALIZE_TYPE_TRAITS_BEGIN(WebCore::RenderSVGResourceClipper)
</pre>
<center><a href="RenderSVGResourceClipper.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="RenderSVGResourceContainer.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>