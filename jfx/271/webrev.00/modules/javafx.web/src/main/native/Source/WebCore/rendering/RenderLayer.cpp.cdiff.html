<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/rendering/RenderLayer.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="RenderBlock.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="RenderLayer.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/rendering/RenderLayer.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 4412,11 ***</span>
      return Path();
  }
  
  bool RenderLayer::setupClipPath(GraphicsContext&amp; context, const LayerPaintingInfo&amp; paintingInfo, const LayoutSize&amp; offsetFromRoot, LayoutRect&amp; rootRelativeBounds, bool&amp; rootRelativeBoundsComputed)
  {
<span class="line-modified">!     if (!renderer().hasClipPath() || context.paintingDisabled())</span>
          return false;
  
      if (!rootRelativeBoundsComputed) {
          rootRelativeBounds = calculateLayerBounds(paintingInfo.rootLayer, offsetFromRoot, { });
          rootRelativeBoundsComputed = true;
<span class="line-new-header">--- 4412,11 ---</span>
      return Path();
  }
  
  bool RenderLayer::setupClipPath(GraphicsContext&amp; context, const LayerPaintingInfo&amp; paintingInfo, const LayoutSize&amp; offsetFromRoot, LayoutRect&amp; rootRelativeBounds, bool&amp; rootRelativeBoundsComputed)
  {
<span class="line-modified">!     if (!renderer().hasClipPath() || context.paintingDisabled() || paintingInfo.paintDirtyRect.isEmpty())</span>
          return false;
  
      if (!rootRelativeBoundsComputed) {
          rootRelativeBounds = calculateLayerBounds(paintingInfo.rootLayer, offsetFromRoot, { });
          rootRelativeBoundsComputed = true;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 4440,17 ***</span>
      if (style.clipPath()-&gt;type() == ClipPathOperation::Reference) {
          ReferenceClipPathOperation* referenceClipPathOperation = static_cast&lt;ReferenceClipPathOperation*&gt;(style.clipPath());
          Element* element = renderer().document().getElementById(referenceClipPathOperation-&gt;fragment());
          if (element &amp;&amp; element-&gt;renderer() &amp;&amp; is&lt;RenderSVGResourceClipper&gt;(element-&gt;renderer())) {
              context.save();
<span class="line-modified">!             float deviceSaleFactor = renderer().document().deviceScaleFactor();</span>
<span class="line-modified">!             FloatRect referenceBox = snapRectToDevicePixels(computeReferenceBox(renderer(), CSSBoxType::ContentBox, paintingOffsetFromRoot, rootRelativeBounds), deviceSaleFactor);</span>
<span class="line-removed">-             FloatPoint offset {referenceBox.location()};</span>
              context.translate(offset);
<span class="line-modified">!             FloatRect svgReferenceBox {FloatPoint(), referenceBox.size()};</span>
<span class="line-modified">!             downcast&lt;RenderSVGResourceClipper&gt;(*element-&gt;renderer()).applyClippingToContext(renderer(), svgReferenceBox, paintingInfo.paintDirtyRect, context);</span>
<span class="line-modified">!             context.translate(FloatPoint(-offset.x(), -offset.y()));</span>
              return true;
          }
      }
  
      return false;
<span class="line-new-header">--- 4440,16 ---</span>
      if (style.clipPath()-&gt;type() == ClipPathOperation::Reference) {
          ReferenceClipPathOperation* referenceClipPathOperation = static_cast&lt;ReferenceClipPathOperation*&gt;(style.clipPath());
          Element* element = renderer().document().getElementById(referenceClipPathOperation-&gt;fragment());
          if (element &amp;&amp; element-&gt;renderer() &amp;&amp; is&lt;RenderSVGResourceClipper&gt;(element-&gt;renderer())) {
              context.save();
<span class="line-modified">!             auto referenceBox = snapRectToDevicePixels(rootRelativeBounds, renderer().document().deviceScaleFactor());</span>
<span class="line-modified">!             auto offset = referenceBox.location();</span>
              context.translate(offset);
<span class="line-modified">!             FloatRect svgReferenceBox { {}, referenceBox.size() };</span>
<span class="line-modified">!             downcast&lt;RenderSVGResourceClipper&gt;(*element-&gt;renderer()).applyClippingToContext(renderer(), svgReferenceBox, context);</span>
<span class="line-modified">!             context.translate(-offset);</span>
              return true;
          }
      }
  
      return false;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 6909,20 ***</span>
  
      ensureLayerFilters();
      m_filters-&gt;buildFilter(renderer(), page().deviceScaleFactor(), renderer().settings().acceleratedFiltersEnabled() ? RenderingMode::Accelerated : RenderingMode::Unaccelerated);
  }
  
<span class="line-removed">- void RenderLayer::filterNeedsRepaint()</span>
<span class="line-removed">- {</span>
<span class="line-removed">-     // We use the enclosing element so that we recalculate style for the ancestor of an anonymous object.</span>
<span class="line-removed">-     if (Element* element = enclosingElement()) {</span>
<span class="line-removed">-         // FIXME: This really shouldn&#39;t have to invalidate layer composition, but tests like css3/filters/effect-reference-delete.html fail if that doesn&#39;t happen.</span>
<span class="line-removed">-         element-&gt;invalidateStyleAndLayerComposition();</span>
<span class="line-removed">-     }</span>
<span class="line-removed">-     renderer().repaint();</span>
<span class="line-removed">- }</span>
<span class="line-removed">- </span>
  IntOutsets RenderLayer::filterOutsets() const
  {
      if (m_filters)
          return m_filters-&gt;filter() ? m_filters-&gt;filter()-&gt;outsets() : IntOutsets();
      return renderer().style().filterOutsets();
<span class="line-new-header">--- 6908,10 ---</span>
</pre>
<center><a href="RenderBlock.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="RenderLayer.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>