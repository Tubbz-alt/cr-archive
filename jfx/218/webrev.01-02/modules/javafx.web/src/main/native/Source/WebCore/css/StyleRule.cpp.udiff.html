<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/css/StyleRule.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="StyleProperties.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="StyleRule.h.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/css/StyleRule.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -43,10 +43,13 @@</span>
      unsigned bitfields : 5;
  };
  
  COMPILE_ASSERT(sizeof(StyleRuleBase) == sizeof(SameSizeAsStyleRuleBase), StyleRuleBase_should_stay_small);
  
<span class="udiff-line-added">+ DEFINE_ALLOCATOR_WITH_HEAP_IDENTIFIER(StyleRuleBase);</span>
<span class="udiff-line-added">+ DEFINE_ALLOCATOR_WITH_HEAP_IDENTIFIER(StyleRule);</span>
<span class="udiff-line-added">+ </span>
  Ref&lt;CSSRule&gt; StyleRuleBase::createCSSOMWrapper(CSSStyleSheet* parentSheet) const
  {
      return createCSSOMWrapper(parentSheet, nullptr);
  }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -56,120 +59,120 @@</span>
  }
  
  void StyleRuleBase::destroy()
  {
      switch (type()) {
<span class="udiff-line-modified-removed">-     case Style:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Style:</span>
          delete downcast&lt;StyleRule&gt;(this);
          return;
<span class="udiff-line-modified-removed">-     case Page:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Page:</span>
          delete downcast&lt;StyleRulePage&gt;(this);
          return;
<span class="udiff-line-modified-removed">-     case FontFace:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::FontFace:</span>
          delete downcast&lt;StyleRuleFontFace&gt;(this);
          return;
<span class="udiff-line-modified-removed">-     case Media:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Media:</span>
          delete downcast&lt;StyleRuleMedia&gt;(this);
          return;
<span class="udiff-line-modified-removed">-     case Supports:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Supports:</span>
          delete downcast&lt;StyleRuleSupports&gt;(this);
          return;
<span class="udiff-line-modified-removed">-     case Import:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Import:</span>
          delete downcast&lt;StyleRuleImport&gt;(this);
          return;
<span class="udiff-line-modified-removed">-     case Keyframes:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Keyframes:</span>
          delete downcast&lt;StyleRuleKeyframes&gt;(this);
          return;
  #if ENABLE(CSS_DEVICE_ADAPTATION)
<span class="udiff-line-modified-removed">-     case Viewport:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Viewport:</span>
          delete downcast&lt;StyleRuleViewport&gt;(this);
          return;
  #endif
<span class="udiff-line-modified-removed">-     case Namespace:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Namespace:</span>
          delete downcast&lt;StyleRuleNamespace&gt;(this);
          return;
<span class="udiff-line-modified-removed">-     case Keyframe:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Keyframe:</span>
          delete downcast&lt;StyleRuleKeyframe&gt;(this);
          return;
<span class="udiff-line-modified-removed">-     case Charset:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Charset:</span>
          delete downcast&lt;StyleRuleCharset&gt;(this);
          return;
<span class="udiff-line-modified-removed">-     case Unknown:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Unknown:</span>
          ASSERT_NOT_REACHED();
          return;
      }
      ASSERT_NOT_REACHED();
  }
  
  Ref&lt;StyleRuleBase&gt; StyleRuleBase::copy() const
  {
      switch (type()) {
<span class="udiff-line-modified-removed">-     case Style:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Style:</span>
          return downcast&lt;StyleRule&gt;(*this).copy();
<span class="udiff-line-modified-removed">-     case Page:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Page:</span>
          return downcast&lt;StyleRulePage&gt;(*this).copy();
<span class="udiff-line-modified-removed">-     case FontFace:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::FontFace:</span>
          return downcast&lt;StyleRuleFontFace&gt;(*this).copy();
<span class="udiff-line-modified-removed">-     case Media:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Media:</span>
          return downcast&lt;StyleRuleMedia&gt;(*this).copy();
<span class="udiff-line-modified-removed">-     case Supports:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Supports:</span>
          return downcast&lt;StyleRuleSupports&gt;(*this).copy();
<span class="udiff-line-modified-removed">-     case Keyframes:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Keyframes:</span>
          return downcast&lt;StyleRuleKeyframes&gt;(*this).copy();
  #if ENABLE(CSS_DEVICE_ADAPTATION)
<span class="udiff-line-modified-removed">-     case Viewport:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Viewport:</span>
          return downcast&lt;StyleRuleViewport&gt;(*this).copy();
  #endif
<span class="udiff-line-modified-removed">-     case Import:</span>
<span class="udiff-line-modified-removed">-     case Namespace:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Import:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Namespace:</span>
          // FIXME: Copy import and namespace rules.
          break;
<span class="udiff-line-modified-removed">-     case Unknown:</span>
<span class="udiff-line-modified-removed">-     case Charset:</span>
<span class="udiff-line-modified-removed">-     case Keyframe:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Unknown:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Charset:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Keyframe:</span>
          break;
      }
      CRASH();
  }
  
  Ref&lt;CSSRule&gt; StyleRuleBase::createCSSOMWrapper(CSSStyleSheet* parentSheet, CSSRule* parentRule) const
  {
      RefPtr&lt;CSSRule&gt; rule;
      StyleRuleBase&amp; self = const_cast&lt;StyleRuleBase&amp;&gt;(*this);
      switch (type()) {
<span class="udiff-line-modified-removed">-     case Style:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Style:</span>
          rule = CSSStyleRule::create(downcast&lt;StyleRule&gt;(self), parentSheet);
          break;
<span class="udiff-line-modified-removed">-     case Page:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Page:</span>
          rule = CSSPageRule::create(downcast&lt;StyleRulePage&gt;(self), parentSheet);
          break;
<span class="udiff-line-modified-removed">-     case FontFace:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::FontFace:</span>
          rule = CSSFontFaceRule::create(downcast&lt;StyleRuleFontFace&gt;(self), parentSheet);
          break;
<span class="udiff-line-modified-removed">-     case Media:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Media:</span>
          rule = CSSMediaRule::create(downcast&lt;StyleRuleMedia&gt;(self), parentSheet);
          break;
<span class="udiff-line-modified-removed">-     case Supports:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Supports:</span>
          rule = CSSSupportsRule::create(downcast&lt;StyleRuleSupports&gt;(self), parentSheet);
          break;
<span class="udiff-line-modified-removed">-     case Import:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Import:</span>
          rule = CSSImportRule::create(downcast&lt;StyleRuleImport&gt;(self), parentSheet);
          break;
<span class="udiff-line-modified-removed">-     case Keyframes:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Keyframes:</span>
          rule = CSSKeyframesRule::create(downcast&lt;StyleRuleKeyframes&gt;(self), parentSheet);
          break;
  #if ENABLE(CSS_DEVICE_ADAPTATION)
<span class="udiff-line-modified-removed">-     case Viewport:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Viewport:</span>
          rule = WebKitCSSViewportRule::create(downcast&lt;StyleRuleViewport&gt;(self), parentSheet);
          break;
  #endif
<span class="udiff-line-modified-removed">-     case Namespace:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Namespace:</span>
          rule = CSSNamespaceRule::create(downcast&lt;StyleRuleNamespace&gt;(self), parentSheet);
          break;
<span class="udiff-line-modified-removed">-     case Unknown:</span>
<span class="udiff-line-modified-removed">-     case Charset:</span>
<span class="udiff-line-modified-removed">-     case Keyframe:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Unknown:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Charset:</span>
<span class="udiff-line-modified-added">+     case StyleRuleType::Keyframe:</span>
          ASSERT_NOT_REACHED();
          break;
      }
      ASSERT(rule);
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -182,11 +185,11 @@</span>
  {
      return sizeof(StyleRule) + sizeof(CSSSelector) + StyleProperties::averageSizeInBytes();
  }
  
  StyleRule::StyleRule(Ref&lt;StylePropertiesBase&gt;&amp;&amp; properties, bool hasDocumentSecurityOrigin, CSSSelectorList&amp;&amp; selectors)
<span class="udiff-line-modified-removed">-     : StyleRuleBase(Style, hasDocumentSecurityOrigin)</span>
<span class="udiff-line-modified-added">+     : StyleRuleBase(StyleRuleType::Style, hasDocumentSecurityOrigin)</span>
      , m_properties(WTFMove(properties))
      , m_selectorList(WTFMove(selectors))
  {
  }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -248,11 +251,11 @@</span>
  
      return rules;
  }
  
  StyleRulePage::StyleRulePage(Ref&lt;StyleProperties&gt;&amp;&amp; properties, CSSSelectorList&amp;&amp; selectors)
<span class="udiff-line-modified-removed">-     : StyleRuleBase(Page)</span>
<span class="udiff-line-modified-added">+     : StyleRuleBase(StyleRuleType::Page)</span>
      , m_properties(WTFMove(properties))
      , m_selectorList(WTFMove(selectors))
  {
  }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -271,11 +274,11 @@</span>
          m_properties = m_properties-&gt;mutableCopy();
      return downcast&lt;MutableStyleProperties&gt;(m_properties.get());
  }
  
  StyleRuleFontFace::StyleRuleFontFace(Ref&lt;StyleProperties&gt;&amp;&amp; properties)
<span class="udiff-line-modified-removed">-     : StyleRuleBase(FontFace)</span>
<span class="udiff-line-modified-added">+     : StyleRuleBase(StyleRuleType::FontFace)</span>
      , m_properties(WTFMove(properties))
  {
  }
  
  StyleRuleFontFace::StyleRuleFontFace(const StyleRuleFontFace&amp; o)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -309,17 +312,17 @@</span>
  void DeferredStyleGroupRuleList::parseDeferredKeyframes(StyleRuleKeyframes&amp; keyframesRule)
  {
      m_parser-&gt;parseKeyframeList(m_tokens, keyframesRule);
  }
  
<span class="udiff-line-modified-removed">- StyleRuleGroup::StyleRuleGroup(Type type, Vector&lt;RefPtr&lt;StyleRuleBase&gt;&gt;&amp; adoptRule)</span>
<span class="udiff-line-modified-added">+ StyleRuleGroup::StyleRuleGroup(StyleRuleType type, Vector&lt;RefPtr&lt;StyleRuleBase&gt;&gt;&amp; adoptRule)</span>
      : StyleRuleBase(type)
  {
      m_childRules.swap(adoptRule);
  }
  
<span class="udiff-line-modified-removed">- StyleRuleGroup::StyleRuleGroup(Type type, std::unique_ptr&lt;DeferredStyleGroupRuleList&gt;&amp;&amp; deferredRules)</span>
<span class="udiff-line-modified-added">+ StyleRuleGroup::StyleRuleGroup(StyleRuleType type, std::unique_ptr&lt;DeferredStyleGroupRuleList&gt;&amp;&amp; deferredRules)</span>
      : StyleRuleBase(type)
      , m_deferredRules(WTFMove(deferredRules))
  {
  }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -357,17 +360,17 @@</span>
      m_deferredRules-&gt;parseDeferredRules(m_childRules);
      m_deferredRules = nullptr;
  }
  
  StyleRuleMedia::StyleRuleMedia(Ref&lt;MediaQuerySet&gt;&amp;&amp; media, Vector&lt;RefPtr&lt;StyleRuleBase&gt;&gt;&amp; adoptRules)
<span class="udiff-line-modified-removed">-     : StyleRuleGroup(Media, adoptRules)</span>
<span class="udiff-line-modified-added">+     : StyleRuleGroup(StyleRuleType::Media, adoptRules)</span>
      , m_mediaQueries(WTFMove(media))
  {
  }
  
  StyleRuleMedia::StyleRuleMedia(Ref&lt;MediaQuerySet&gt;&amp;&amp; media, std::unique_ptr&lt;DeferredStyleGroupRuleList&gt;&amp;&amp; deferredRules)
<span class="udiff-line-modified-removed">-     : StyleRuleGroup(Media, WTFMove(deferredRules))</span>
<span class="udiff-line-modified-added">+     : StyleRuleGroup(StyleRuleType::Media, WTFMove(deferredRules))</span>
      , m_mediaQueries(WTFMove(media))
  {
  }
  
  StyleRuleMedia::StyleRuleMedia(const StyleRuleMedia&amp; o)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -377,18 +380,18 @@</span>
          m_mediaQueries = o.m_mediaQueries-&gt;copy();
  }
  
  
  StyleRuleSupports::StyleRuleSupports(const String&amp; conditionText, bool conditionIsSupported, Vector&lt;RefPtr&lt;StyleRuleBase&gt;&gt;&amp; adoptRules)
<span class="udiff-line-modified-removed">-     : StyleRuleGroup(Supports, adoptRules)</span>
<span class="udiff-line-modified-added">+     : StyleRuleGroup(StyleRuleType::Supports, adoptRules)</span>
      , m_conditionText(conditionText)
      , m_conditionIsSupported(conditionIsSupported)
  {
  }
  
  StyleRuleSupports::StyleRuleSupports(const String&amp; conditionText, bool conditionIsSupported,  std::unique_ptr&lt;DeferredStyleGroupRuleList&gt;&amp;&amp; deferredRules)
<span class="udiff-line-modified-removed">-     : StyleRuleGroup(Supports, WTFMove(deferredRules))</span>
<span class="udiff-line-modified-added">+     : StyleRuleGroup(StyleRuleType::Supports, WTFMove(deferredRules))</span>
      , m_conditionText(conditionText)
      , m_conditionIsSupported(conditionIsSupported)
  {
  }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -399,11 +402,11 @@</span>
  {
  }
  
  #if ENABLE(CSS_DEVICE_ADAPTATION)
  StyleRuleViewport::StyleRuleViewport(Ref&lt;StyleProperties&gt;&amp;&amp; properties)
<span class="udiff-line-modified-removed">-     : StyleRuleBase(Viewport)</span>
<span class="udiff-line-modified-added">+     : StyleRuleBase(StyleRuleType::Viewport)</span>
      , m_properties(WTFMove(properties))
  {
  }
  
  StyleRuleViewport::StyleRuleViewport(const StyleRuleViewport&amp; o)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -421,11 +424,11 @@</span>
      return static_cast&lt;MutableStyleProperties&amp;&gt;(m_properties.get());
  }
  #endif // ENABLE(CSS_DEVICE_ADAPTATION)
  
  StyleRuleCharset::StyleRuleCharset()
<span class="udiff-line-modified-removed">-     : StyleRuleBase(Charset)</span>
<span class="udiff-line-modified-added">+     : StyleRuleBase(StyleRuleType::Charset)</span>
  {
  }
  
  StyleRuleCharset::StyleRuleCharset(const StyleRuleCharset&amp; o)
      : StyleRuleBase(o)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -433,11 +436,11 @@</span>
  }
  
  StyleRuleCharset::~StyleRuleCharset() = default;
  
  StyleRuleNamespace::StyleRuleNamespace(AtomString prefix, AtomString uri)
<span class="udiff-line-modified-removed">-     : StyleRuleBase(Namespace)</span>
<span class="udiff-line-modified-added">+     : StyleRuleBase(StyleRuleType::Namespace)</span>
      , m_prefix(prefix)
      , m_uri(uri)
  {
  }
  
</pre>
<center><a href="StyleProperties.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="StyleRule.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>