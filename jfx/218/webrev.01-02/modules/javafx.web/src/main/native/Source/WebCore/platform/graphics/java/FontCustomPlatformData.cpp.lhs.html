<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/java/FontCustomPlatformData.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (c) 2011, 2019, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 #include &quot;config.h&quot;
 27 
 28 #include &quot;FontCustomPlatformData.h&quot;
 29 
 30 #include &quot;SharedBuffer.h&quot;
 31 #include &quot;FontDescription.h&quot;
 32 #include &quot;FontPlatformData.h&quot;
 33 
 34 namespace WebCore {
 35 
 36 FontCustomPlatformData::FontCustomPlatformData(const JLObject&amp; data)
 37     : m_data(data)
 38 {
 39 }
 40 
 41 FontCustomPlatformData::~FontCustomPlatformData()
 42 {
 43 }
 44 
 45 FontPlatformData FontCustomPlatformData::fontPlatformData(
<a name="1" id="anc1"></a><span class="line-modified"> 46         const FontDescription&amp; fontDescription, bool bold, bool italic, const FontFeatureSettings&amp;, const FontVariantSettings&amp;, FontSelectionSpecifiedCapabilities)</span>
 47 {
 48     JNIEnv* env = WTF::GetJavaEnv();
 49 
 50     int size = fontDescription.computedPixelSize();
 51     static jmethodID mid = env-&gt;GetMethodID(
 52             PG_GetFontCustomPlatformDataClass(env),
 53             &quot;createFont&quot;,
 54             &quot;(IZZ)Lcom/sun/webkit/graphics/WCFont;&quot;);
 55     ASSERT(mid);
 56 
 57     JLObject font(env-&gt;CallObjectMethod(
 58             m_data,
 59             mid,
 60             size,
 61             bool_to_jbool(bold),
 62             bool_to_jbool(italic)));
 63     WTF::CheckAndClearException(env);
 64 
 65     return FontPlatformData(RQRef::create(font), size);
 66 }
 67 
 68 std::unique_ptr&lt;FontCustomPlatformData&gt; createFontCustomPlatformData(SharedBuffer&amp; buffer, const String&amp; /* index */)
 69 {
 70     JNIEnv* env = WTF::GetJavaEnv();
 71 
 72     static JGClass sharedBufferClass(env-&gt;FindClass(
 73             &quot;com/sun/webkit/SharedBuffer&quot;));
 74     ASSERT(sharedBufferClass);
 75 
 76     static jmethodID mid1 = env-&gt;GetStaticMethodID(
 77             sharedBufferClass,
 78             &quot;fwkCreate&quot;,
 79             &quot;(J)Lcom/sun/webkit/SharedBuffer;&quot;);
 80     ASSERT(mid1);
 81 
 82     JLObject sharedBuffer(env-&gt;CallStaticObjectMethod(
 83             sharedBufferClass,
 84             mid1,
 85             ptr_to_jlong(&amp;buffer)));
 86     WTF::CheckAndClearException(env);
 87 
 88     static jmethodID mid2 = env-&gt;GetMethodID(
 89             PG_GetGraphicsManagerClass(env),
 90             &quot;fwkCreateFontCustomPlatformData&quot;,
 91             &quot;(Lcom/sun/webkit/SharedBuffer;)&quot;
 92             &quot;Lcom/sun/webkit/graphics/WCFontCustomPlatformData;&quot;);
 93     ASSERT(mid2);
 94 
 95     JLObject data(env-&gt;CallObjectMethod(
 96             PL_GetGraphicsManager(env),
 97             mid2,
 98             (jobject) sharedBuffer));
 99     WTF::CheckAndClearException(env);
100 
101     return data ? std::make_unique&lt;FontCustomPlatformData&gt;(data) : nullptr;
102 }
103 
104 bool FontCustomPlatformData::supportsFormat(const String&amp; format)
105 {
106     return equalLettersIgnoringASCIICase(format, &quot;truetype&quot;)
107             || equalLettersIgnoringASCIICase(format, &quot;opentype&quot;)
108             || equalLettersIgnoringASCIICase(format, &quot;woff&quot;);
109 }
110 
111 }
<a name="2" id="anc2"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="2" type="hidden" />
</body>
</html>