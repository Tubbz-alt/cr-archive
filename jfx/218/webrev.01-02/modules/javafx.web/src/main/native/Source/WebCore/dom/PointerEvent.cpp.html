<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/WebCore/dom/PointerEvent.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (C) 2018 Apple Inc. All rights reserved.
  3  *
  4  * Redistribution and use in source and binary forms, with or without
  5  * modification, are permitted provided that the following conditions
  6  * are met:
  7  * 1. Redistributions of source code must retain the above copyright
  8  *    notice, this list of conditions and the following disclaimer.
  9  * 2. Redistributions in binary form must reproduce the above copyright
 10  *    notice, this list of conditions and the following disclaimer in the
 11  *    documentation and/or other materials provided with the distribution.
 12  *
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
 14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 15  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #include &quot;config.h&quot;
 27 #include &quot;PointerEvent.h&quot;
 28 
 29 #if ENABLE(POINTER_EVENTS)
 30 
 31 #include &quot;EventNames.h&quot;
 32 #include &lt;wtf/IsoMallocInlines.h&gt;
 33 
 34 namespace WebCore {
 35 
 36 WTF_MAKE_ISO_ALLOCATED_IMPL(PointerEvent);
 37 
 38 const String&amp; PointerEvent::mousePointerType()
 39 {
 40     static NeverDestroyed&lt;const String&gt; mouseType(MAKE_STATIC_STRING_IMPL(&quot;mouse&quot;));
 41     return mouseType;
 42 }
 43 
 44 const String&amp; PointerEvent::penPointerType()
 45 {
 46     static NeverDestroyed&lt;const String&gt; penType(MAKE_STATIC_STRING_IMPL(&quot;pen&quot;));
 47     return penType;
 48 }
 49 
 50 const String&amp; PointerEvent::touchPointerType()
 51 {
 52     static NeverDestroyed&lt;const String&gt; touchType(MAKE_STATIC_STRING_IMPL(&quot;touch&quot;));
 53     return touchType;
 54 }
 55 
 56 static AtomString pointerEventType(const AtomString&amp; mouseEventType)
 57 {
 58     auto&amp; names = eventNames();
 59     if (mouseEventType == names.mousedownEvent)
 60         return names.pointerdownEvent;
 61     if (mouseEventType == names.mouseoverEvent)
 62         return names.pointeroverEvent;
 63     if (mouseEventType == names.mouseenterEvent)
 64         return names.pointerenterEvent;
 65     if (mouseEventType == names.mousemoveEvent)
 66         return names.pointermoveEvent;
 67     if (mouseEventType == names.mouseleaveEvent)
 68         return names.pointerleaveEvent;
 69     if (mouseEventType == names.mouseoutEvent)
 70         return names.pointeroutEvent;
 71     if (mouseEventType == names.mouseupEvent)
 72         return names.pointerupEvent;
 73 
 74     return nullAtom();
 75 }
 76 
 77 RefPtr&lt;PointerEvent&gt; PointerEvent::create(short button, const MouseEvent&amp; mouseEvent)
 78 {
 79     auto type = pointerEventType(mouseEvent.type());
 80     if (type.isEmpty())
 81         return nullptr;
 82 
 83     return create(type, button, mouseEvent);
 84 }
 85 
 86 Ref&lt;PointerEvent&gt; PointerEvent::create(const String&amp; type, short button, const MouseEvent&amp; mouseEvent)
 87 {
 88     return adoptRef(*new PointerEvent(type, button, mouseEvent));
 89 }
 90 
 91 Ref&lt;PointerEvent&gt; PointerEvent::create(const String&amp; type, PointerID pointerId, const String&amp; pointerType, IsPrimary isPrimary)
 92 {
 93     return adoptRef(*new PointerEvent(type, pointerId, pointerType, isPrimary));
 94 }
 95 
 96 PointerEvent::PointerEvent() = default;
 97 
 98 PointerEvent::PointerEvent(const AtomString&amp; type, Init&amp;&amp; initializer)
 99     : MouseEvent(type, initializer)
100     , m_pointerId(initializer.pointerId)
101     , m_width(initializer.width)
102     , m_height(initializer.height)
103     , m_pressure(initializer.pressure)
104     , m_tangentialPressure(initializer.tangentialPressure)
105     , m_tiltX(initializer.tiltX)
106     , m_tiltY(initializer.tiltY)
107     , m_twist(initializer.twist)
108     , m_pointerType(initializer.pointerType)
109     , m_isPrimary(initializer.isPrimary)
110 {
111 }
112 
113 PointerEvent::PointerEvent(const AtomString&amp; type, short button, const MouseEvent&amp; mouseEvent)
114     : MouseEvent(type, typeCanBubble(type), typeIsCancelable(type), typeIsComposed(type), mouseEvent.view(), mouseEvent.detail(), mouseEvent.screenLocation(), { mouseEvent.clientX(), mouseEvent.clientY() }, mouseEvent.modifierKeys(), button, mouseEvent.buttons(), mouseEvent.syntheticClickType(), mouseEvent.relatedTarget())
115     , m_isPrimary(true)
116 {
117 }
118 
119 PointerEvent::PointerEvent(const AtomString&amp; type, PointerID pointerId, const String&amp; pointerType, IsPrimary isPrimary)
120     : MouseEvent(type, typeCanBubble(type), typeIsCancelable(type), typeIsComposed(type), nullptr, 0, { }, { }, { }, 0, 0, 0, nullptr)
121     , m_pointerId(pointerId)
122     , m_pointerType(pointerType)
123     , m_isPrimary(isPrimary == IsPrimary::Yes)
124 {
125 }
126 
127 PointerEvent::~PointerEvent() = default;
128 
129 EventInterface PointerEvent::eventInterface() const
130 {
131     return PointerEventInterfaceType;
132 }
133 
134 } // namespace WebCore
135 
136 #endif // ENABLE(POINTER_EVENTS)
    </pre>
  </body>
</html>