<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/Scripts/wkbuiltins/builtins_generate_combined_header.py</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../generate-js-builtins.py.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="builtins_generate_separate_header.py.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/Scripts/wkbuiltins/builtins_generate_combined_header.py</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 61         sections.append(Template(Templates.HeaderIncludeGuard).substitute(args))
 62         sections.append(self.generate_forward_declarations())
 63         sections.append(Template(Templates.NamespaceTop).substitute(args))
 64         sections.append(&quot;extern const char s_%(namespace)sCombinedCode[];&quot; % args);
 65         sections.append(&quot;extern const unsigned s_%(namespace)sCombinedCodeLength;&quot; % args);
 66         for object in self.model().objects:
 67             sections.append(self.generate_section_for_object(object))
 68         sections.append(self.generate_section_for_code_table_macro())
 69         sections.append(self.generate_section_for_code_name_macro())
 70         sections.append(self.generate_section_for_global_private_code_name_macro())
 71         sections.append(Template(Templates.CombinedHeaderStaticMacros).substitute(args))
 72         sections.append(Template(Templates.NamespaceBottom).substitute(args))
 73 
 74         return &quot;\n\n&quot;.join(sections)
 75 
 76     def generate_forward_declarations(self):
 77         return &quot;&quot;&quot;namespace JSC {
 78 class FunctionExecutable;
 79 class VM;
 80 
<span class="line-modified"> 81 enum class ConstructAbility : unsigned;</span>

 82 }&quot;&quot;&quot;
 83 
 84     def generate_section_for_object(self, object):
 85         lines = []
 86         lines.append(&#39;/* %s */&#39; % object.object_name)
 87         lines.extend(self.generate_externs_for_object(object))
 88         lines.append(&quot;&quot;)
 89         lines.extend(self.generate_macros_for_object(object))
 90         return &#39;\n&#39;.join(lines)
 91 
 92     def generate_externs_for_object(self, object):
 93         lines = []
 94 
 95         for function in object.functions:
 96             function_args = {
 97                 &#39;codeName&#39;: BuiltinsGenerator.mangledNameForFunction(function) + &#39;Code&#39;,
 98             }
 99 
100             lines.append(&quot;&quot;&quot;extern const char* const s_%(codeName)s;
101 extern const int s_%(codeName)sLength;
<span class="line-modified">102 extern const JSC::ConstructAbility s_%(codeName)sConstructAbility;&quot;&quot;&quot; % function_args)</span>

103 
104         return lines
105 
106     def generate_macros_for_object(self, object):
107         args = {
108             &#39;macroPrefix&#39;: self.model().framework.setting(&#39;macro_prefix&#39;),
109             &#39;objectMacro&#39;: object.object_name.replace(&#39;.&#39;, &#39;&#39;).upper(),
110         }
111 
112         lines = []
113         lines.append(&quot;#define %(macroPrefix)s_FOREACH_%(objectMacro)s_BUILTIN_DATA(macro) \\&quot; % args)
114         for function in object.functions:
115             function_args = {
116                 &#39;funcName&#39;: function.function_name,
117                 &#39;mangledName&#39;: BuiltinsGenerator.mangledNameForFunction(function),
118                 &#39;paramCount&#39;: len(function.parameters),
119             }
120 
121             lines.append(&quot;    macro(%(funcName)s, %(mangledName)s, %(paramCount)d) \\&quot; % function_args)
122         return lines
</pre>
<hr />
<pre>
153         unique_names.sort()
154         for function_name in unique_names:
155             function_args = {
156                 &#39;funcName&#39;: function_name,
157             }
158 
159             lines.append(&quot;    macro(%(funcName)s) \\&quot; % function_args)
160         return &#39;\n&#39;.join(lines)
161 
162     def generate_section_for_global_private_code_name_macro(self):
163         args = {
164             &#39;macroPrefix&#39;: self.model().framework.setting(&#39;macro_prefix&#39;),
165         }
166 
167         lines = []
168         lines.append(&quot;#define %(macroPrefix)s_FOREACH_BUILTIN_FUNCTION_PRIVATE_GLOBAL_NAME(macro) \\&quot; % args)
169         functions = [function for function in self.model().all_functions() if function.is_global_private]
170         functions.sort(key=lambda x: x.function_name)
171         for function in functions:
172             function_args = {
<span class="line-removed">173                 &#39;varName&#39;: get_var_name(function),</span>
174                 &#39;funcName&#39;: function.function_name,
175                 &#39;codeName&#39;: BuiltinsGenerator.mangledNameForFunction(function),
176             }
177 
<span class="line-modified">178             lines.append(&quot;    macro(%(varName)s, %(funcName)s, %(codeName)s) \\&quot; % function_args)</span>
179 
180         return &#39;\n&#39;.join(lines)
</pre>
</td>
<td>
<hr />
<pre>
 61         sections.append(Template(Templates.HeaderIncludeGuard).substitute(args))
 62         sections.append(self.generate_forward_declarations())
 63         sections.append(Template(Templates.NamespaceTop).substitute(args))
 64         sections.append(&quot;extern const char s_%(namespace)sCombinedCode[];&quot; % args);
 65         sections.append(&quot;extern const unsigned s_%(namespace)sCombinedCodeLength;&quot; % args);
 66         for object in self.model().objects:
 67             sections.append(self.generate_section_for_object(object))
 68         sections.append(self.generate_section_for_code_table_macro())
 69         sections.append(self.generate_section_for_code_name_macro())
 70         sections.append(self.generate_section_for_global_private_code_name_macro())
 71         sections.append(Template(Templates.CombinedHeaderStaticMacros).substitute(args))
 72         sections.append(Template(Templates.NamespaceBottom).substitute(args))
 73 
 74         return &quot;\n\n&quot;.join(sections)
 75 
 76     def generate_forward_declarations(self):
 77         return &quot;&quot;&quot;namespace JSC {
 78 class FunctionExecutable;
 79 class VM;
 80 
<span class="line-modified"> 81 enum class ConstructAbility : uint8_t;</span>
<span class="line-added"> 82 enum class ConstructorKind : uint8_t;</span>
 83 }&quot;&quot;&quot;
 84 
 85     def generate_section_for_object(self, object):
 86         lines = []
 87         lines.append(&#39;/* %s */&#39; % object.object_name)
 88         lines.extend(self.generate_externs_for_object(object))
 89         lines.append(&quot;&quot;)
 90         lines.extend(self.generate_macros_for_object(object))
 91         return &#39;\n&#39;.join(lines)
 92 
 93     def generate_externs_for_object(self, object):
 94         lines = []
 95 
 96         for function in object.functions:
 97             function_args = {
 98                 &#39;codeName&#39;: BuiltinsGenerator.mangledNameForFunction(function) + &#39;Code&#39;,
 99             }
100 
101             lines.append(&quot;&quot;&quot;extern const char* const s_%(codeName)s;
102 extern const int s_%(codeName)sLength;
<span class="line-modified">103 extern const JSC::ConstructAbility s_%(codeName)sConstructAbility;</span>
<span class="line-added">104 extern const JSC::ConstructorKind s_%(codeName)sConstructorKind;&quot;&quot;&quot; % function_args)</span>
105 
106         return lines
107 
108     def generate_macros_for_object(self, object):
109         args = {
110             &#39;macroPrefix&#39;: self.model().framework.setting(&#39;macro_prefix&#39;),
111             &#39;objectMacro&#39;: object.object_name.replace(&#39;.&#39;, &#39;&#39;).upper(),
112         }
113 
114         lines = []
115         lines.append(&quot;#define %(macroPrefix)s_FOREACH_%(objectMacro)s_BUILTIN_DATA(macro) \\&quot; % args)
116         for function in object.functions:
117             function_args = {
118                 &#39;funcName&#39;: function.function_name,
119                 &#39;mangledName&#39;: BuiltinsGenerator.mangledNameForFunction(function),
120                 &#39;paramCount&#39;: len(function.parameters),
121             }
122 
123             lines.append(&quot;    macro(%(funcName)s, %(mangledName)s, %(paramCount)d) \\&quot; % function_args)
124         return lines
</pre>
<hr />
<pre>
155         unique_names.sort()
156         for function_name in unique_names:
157             function_args = {
158                 &#39;funcName&#39;: function_name,
159             }
160 
161             lines.append(&quot;    macro(%(funcName)s) \\&quot; % function_args)
162         return &#39;\n&#39;.join(lines)
163 
164     def generate_section_for_global_private_code_name_macro(self):
165         args = {
166             &#39;macroPrefix&#39;: self.model().framework.setting(&#39;macro_prefix&#39;),
167         }
168 
169         lines = []
170         lines.append(&quot;#define %(macroPrefix)s_FOREACH_BUILTIN_FUNCTION_PRIVATE_GLOBAL_NAME(macro) \\&quot; % args)
171         functions = [function for function in self.model().all_functions() if function.is_global_private]
172         functions.sort(key=lambda x: x.function_name)
173         for function in functions:
174             function_args = {

175                 &#39;funcName&#39;: function.function_name,
176                 &#39;codeName&#39;: BuiltinsGenerator.mangledNameForFunction(function),
177             }
178 
<span class="line-modified">179             lines.append(&quot;    macro(%(funcName)s, %(codeName)s) \\&quot; % function_args)</span>
180 
181         return &#39;\n&#39;.join(lines)
</pre>
</td>
</tr>
</table>
<center><a href="../generate-js-builtins.py.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="builtins_generate_separate_header.py.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>