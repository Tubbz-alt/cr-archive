<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/loader/MixedContentChecker.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MediaResourceLoader.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MixedContentChecker.h.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/loader/MixedContentChecker.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -118,10 +118,32 @@</span>
      m_frame.document()-&gt;addConsoleMessage(MessageSource::Security, MessageLevel::Warning, message);
  
      client().didDisplayInsecureContent();
  }
  
<span class="udiff-line-added">+ Optional&lt;String&gt; MixedContentChecker::checkForMixedContentInFrameTree(const URL&amp; url)</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     auto* document = m_frame.document();</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     while (document) {</span>
<span class="udiff-line-added">+         RELEASE_ASSERT_WITH_MESSAGE(document-&gt;frame(), &quot;An unparented document tried to connect to a websocket with url: %s&quot;, url.string().utf8().data());</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         auto* frame = document-&gt;frame();</span>
<span class="udiff-line-added">+         if (isMixedContent(document-&gt;securityOrigin(), url))</span>
<span class="udiff-line-added">+             return makeString(&quot;The page at &quot;, document-&gt;url().stringCenterEllipsizedToLength(), &quot; was blocked from connecting insecurely to &quot;, url.stringCenterEllipsizedToLength(), &quot; either because the protocol is insecure or the page is embedded from an insecure page.&quot;);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         if (frame-&gt;isMainFrame())</span>
<span class="udiff-line-added">+             break;</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         frame = frame-&gt;tree().parent();</span>
<span class="udiff-line-added">+         RELEASE_ASSERT_WITH_MESSAGE(frame, &quot;Should never have a parentless non main frame&quot;);</span>
<span class="udiff-line-added">+         document = frame-&gt;document();</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     return WTF::nullopt;</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
  void MixedContentChecker::logWarning(bool allowed, const String&amp; action, const URL&amp; target) const
  {
      const char* errorString = allowed ? &quot; was allowed to &quot; : &quot; was not allowed to &quot;;
      String message = makeString((allowed ? String() : &quot;[blocked] &quot;), &quot;The page at &quot;, m_frame.document()-&gt;url().stringCenterEllipsizedToLength(), errorString, action, &quot; insecure content from &quot;, target.stringCenterEllipsizedToLength(), &quot;.\n&quot;);
      m_frame.document()-&gt;addConsoleMessage(MessageSource::Security, MessageLevel::Warning, message);
</pre>
<center><a href="MediaResourceLoader.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MixedContentChecker.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>