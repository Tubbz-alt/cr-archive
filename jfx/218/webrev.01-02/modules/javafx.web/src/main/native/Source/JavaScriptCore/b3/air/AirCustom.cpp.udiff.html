<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/JavaScriptCore/b3/air/AirCustom.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="AirCode.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="AirCustom.h.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/b3/air/AirCustom.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -29,10 +29,11 @@</span>
  #if ENABLE(B3_JIT)
  
  #include &quot;AirInstInlines.h&quot;
  #include &quot;B3CCallValue.h&quot;
  #include &quot;B3ValueInlines.h&quot;
<span class="udiff-line-added">+ #include &quot;CCallHelpers.h&quot;</span>
  
  namespace JSC { namespace B3 { namespace Air {
  
  bool PatchCustom::isValidForm(Inst&amp; inst)
  {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -94,15 +95,15 @@</span>
      }
  
      return true;
  }
  
<span class="udiff-line-modified-removed">- CCallHelpers::Jump CCallCustom::generate(Inst&amp; inst, CCallHelpers&amp;, GenerationContext&amp;)</span>
<span class="udiff-line-modified-added">+ MacroAssembler::Jump CCallCustom::generate(Inst&amp; inst, CCallHelpers&amp;, GenerationContext&amp;)</span>
  {
      dataLog(&quot;FATAL: Unlowered C call: &quot;, inst, &quot;\n&quot;);
      UNREACHABLE_FOR_PLATFORM();
<span class="udiff-line-modified-removed">-     return CCallHelpers::Jump();</span>
<span class="udiff-line-modified-added">+     return MacroAssembler::Jump();</span>
  }
  
  bool ShuffleCustom::isValidForm(Inst&amp; inst)
  {
      if (inst.args.size() % 3)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -169,15 +170,15 @@</span>
      }
  
      return true;
  }
  
<span class="udiff-line-modified-removed">- CCallHelpers::Jump ShuffleCustom::generate(Inst&amp; inst, CCallHelpers&amp;, GenerationContext&amp;)</span>
<span class="udiff-line-modified-added">+ MacroAssembler::Jump ShuffleCustom::generate(Inst&amp; inst, CCallHelpers&amp;, GenerationContext&amp;)</span>
  {
      dataLog(&quot;FATAL: Unlowered shuffle: &quot;, inst, &quot;\n&quot;);
      UNREACHABLE_FOR_PLATFORM();
<span class="udiff-line-modified-removed">-     return CCallHelpers::Jump();</span>
<span class="udiff-line-modified-added">+     return MacroAssembler::Jump();</span>
  }
  
  bool WasmBoundsCheckCustom::isValidForm(Inst&amp; inst)
  {
      if (inst.args.size() != 2)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -186,10 +187,32 @@</span>
          return false;
  
      return inst.args[1].isReg() || inst.args[1].isTmp() || inst.args[1].isSomeImm();
  }
  
<span class="udiff-line-added">+ MacroAssembler::Jump WasmBoundsCheckCustom::generate(Inst&amp; inst, CCallHelpers&amp; jit, GenerationContext&amp; context)</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     WasmBoundsCheckValue* value = inst.origin-&gt;as&lt;WasmBoundsCheckValue&gt;();</span>
<span class="udiff-line-added">+     MacroAssembler::Jump outOfBounds = Inst(Air::Branch64, value, Arg::relCond(MacroAssembler::AboveOrEqual), inst.args[0], inst.args[1]).generate(jit, context);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     context.latePaths.append(createSharedTask&lt;GenerationContext::LatePathFunction&gt;(</span>
<span class="udiff-line-added">+         [outOfBounds, value] (CCallHelpers&amp; jit, Air::GenerationContext&amp; context) {</span>
<span class="udiff-line-added">+             outOfBounds.link(&amp;jit);</span>
<span class="udiff-line-added">+             switch (value-&gt;boundsType()) {</span>
<span class="udiff-line-added">+             case WasmBoundsCheckValue::Type::Pinned:</span>
<span class="udiff-line-added">+                 context.code-&gt;wasmBoundsCheckGenerator()-&gt;run(jit, value-&gt;bounds().pinnedSize);</span>
<span class="udiff-line-added">+                 break;</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+             case WasmBoundsCheckValue::Type::Maximum:</span>
<span class="udiff-line-added">+                 context.code-&gt;wasmBoundsCheckGenerator()-&gt;run(jit, InvalidGPRReg);</span>
<span class="udiff-line-added">+                 break;</span>
<span class="udiff-line-added">+             }</span>
<span class="udiff-line-added">+         }));</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     // We said we were not a terminal.</span>
<span class="udiff-line-added">+     return MacroAssembler::Jump();</span>
<span class="udiff-line-added">+ }</span>
  
  } } } // namespace JSC::B3::Air
  
  #endif // ENABLE(B3_JIT)
  
</pre>
<center><a href="AirCode.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="AirCustom.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>