<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/heap/CodeBlockSet.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="CodeBlockSet.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CodeBlockSetInlines.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/heap/CodeBlockSet.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
39 class VM;
40 
41 // CodeBlockSet tracks all CodeBlocks. Every CodeBlock starts out with one
42 // reference coming in from GC. The GC is responsible for freeing CodeBlocks
43 // once they hasOneRef() and nobody is running code from that CodeBlock.
44 
45 class CodeBlockSet {
46     WTF_MAKE_FAST_ALLOCATED;
47     WTF_MAKE_NONCOPYABLE(CodeBlockSet);
48 public:
49     CodeBlockSet();
50     ~CodeBlockSet();
51 
52     void mark(const AbstractLocker&amp;, CodeBlock* candidateCodeBlock);
53 
54     void clearCurrentlyExecuting();
55 
56     bool contains(const AbstractLocker&amp;, void* candidateCodeBlock);
57     Lock&amp; getLock() { return m_lock; }
58 




59     // Visits each CodeBlock in the heap until the visitor function returns true
60     // to indicate that it is done iterating, or until every CodeBlock has been
61     // visited.
62     template&lt;typename Functor&gt; void iterate(const Functor&amp;);
63     template&lt;typename Functor&gt; void iterate(const AbstractLocker&amp;, const Functor&amp;);
64 
65     template&lt;typename Functor&gt; void iterateViaSubspaces(VM&amp;, const Functor&amp;);
66 
67     template&lt;typename Functor&gt; void iterateCurrentlyExecuting(const Functor&amp;);
68 
69     void dump(PrintStream&amp;) const;
70 
71     void add(CodeBlock*);
72     void remove(CodeBlock*);
73 
74 private:
75     HashSet&lt;CodeBlock*&gt; m_codeBlocks;
76     HashSet&lt;CodeBlock*&gt; m_currentlyExecuting;
77     Lock m_lock;
78 };
</pre>
</td>
<td>
<hr />
<pre>
39 class VM;
40 
41 // CodeBlockSet tracks all CodeBlocks. Every CodeBlock starts out with one
42 // reference coming in from GC. The GC is responsible for freeing CodeBlocks
43 // once they hasOneRef() and nobody is running code from that CodeBlock.
44 
45 class CodeBlockSet {
46     WTF_MAKE_FAST_ALLOCATED;
47     WTF_MAKE_NONCOPYABLE(CodeBlockSet);
48 public:
49     CodeBlockSet();
50     ~CodeBlockSet();
51 
52     void mark(const AbstractLocker&amp;, CodeBlock* candidateCodeBlock);
53 
54     void clearCurrentlyExecuting();
55 
56     bool contains(const AbstractLocker&amp;, void* candidateCodeBlock);
57     Lock&amp; getLock() { return m_lock; }
58 
<span class="line-added">59     // This is expected to run only when we&#39;re not adding to the set for now. If</span>
<span class="line-added">60     // this needs to run concurrently in the future, we&#39;ll need to lock around this.</span>
<span class="line-added">61     bool isCurrentlyExecuting(CodeBlock*);</span>
<span class="line-added">62 </span>
63     // Visits each CodeBlock in the heap until the visitor function returns true
64     // to indicate that it is done iterating, or until every CodeBlock has been
65     // visited.
66     template&lt;typename Functor&gt; void iterate(const Functor&amp;);
67     template&lt;typename Functor&gt; void iterate(const AbstractLocker&amp;, const Functor&amp;);
68 
69     template&lt;typename Functor&gt; void iterateViaSubspaces(VM&amp;, const Functor&amp;);
70 
71     template&lt;typename Functor&gt; void iterateCurrentlyExecuting(const Functor&amp;);
72 
73     void dump(PrintStream&amp;) const;
74 
75     void add(CodeBlock*);
76     void remove(CodeBlock*);
77 
78 private:
79     HashSet&lt;CodeBlock*&gt; m_codeBlocks;
80     HashSet&lt;CodeBlock*&gt; m_currentlyExecuting;
81     Lock m_lock;
82 };
</pre>
</td>
</tr>
</table>
<center><a href="CodeBlockSet.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CodeBlockSetInlines.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>