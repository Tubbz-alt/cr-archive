<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/page/csp/ContentSecurityPolicyResponseHeaders.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ContentSecurityPolicy.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../linux/ResourceUsageOverlayLinux.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/page/csp/ContentSecurityPolicyResponseHeaders.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 33 class ContentSecurityPolicy;
 34 class ResourceResponse;
 35 
 36 enum class ContentSecurityPolicyHeaderType {
 37     Report,
 38     Enforce,
 39     PrefixedReport,
 40     PrefixedEnforce,
 41 };
 42 
 43 class ContentSecurityPolicyResponseHeaders {
 44 public:
 45     ContentSecurityPolicyResponseHeaders() = default;
 46     WEBCORE_EXPORT explicit ContentSecurityPolicyResponseHeaders(const ResourceResponse&amp;);
 47 
 48     ContentSecurityPolicyResponseHeaders isolatedCopy() const;
 49 
 50     template &lt;class Encoder&gt; void encode(Encoder&amp;) const;
 51     template &lt;class Decoder&gt; static bool decode(Decoder&amp;, ContentSecurityPolicyResponseHeaders&amp;);
 52 













 53 private:
 54     friend class ContentSecurityPolicy;



 55 
 56     Vector&lt;std::pair&lt;String, ContentSecurityPolicyHeaderType&gt;&gt; m_headers;
 57     int m_httpStatusCode { 0 };

 58 };
 59 
 60 template &lt;class Encoder&gt;
 61 void ContentSecurityPolicyResponseHeaders::encode(Encoder&amp; encoder) const
 62 {
 63     encoder &lt;&lt; static_cast&lt;uint64_t&gt;(m_headers.size());
 64     for (auto&amp; pair : m_headers) {
 65         encoder &lt;&lt; pair.first;
 66         encoder.encodeEnum(pair.second);
 67     }
 68     encoder &lt;&lt; m_httpStatusCode;
 69 }
 70 
 71 template &lt;class Decoder&gt;
 72 bool ContentSecurityPolicyResponseHeaders::decode(Decoder&amp; decoder, ContentSecurityPolicyResponseHeaders&amp; headers)
 73 {
 74     uint64_t headersSize;
 75     if (!decoder.decode(headersSize))
 76         return false;
<span class="line-removed"> 77     headers.m_headers.reserveCapacity(static_cast&lt;size_t&gt;(headersSize));</span>
 78     for (size_t i = 0; i &lt; headersSize; ++i) {
 79         String header;
 80         if (!decoder.decode(header))
 81             return false;
 82         ContentSecurityPolicyHeaderType headerType;
 83         if (!decoder.decodeEnum(headerType))
 84             return false;
 85         headers.m_headers.append(std::make_pair(header, headerType));
 86     }

 87 
 88     if (!decoder.decode(headers.m_httpStatusCode))
 89         return false;
 90 
 91     return true;
 92 }
 93 
 94 } // namespace WebCore
</pre>
</td>
<td>
<hr />
<pre>
 33 class ContentSecurityPolicy;
 34 class ResourceResponse;
 35 
 36 enum class ContentSecurityPolicyHeaderType {
 37     Report,
 38     Enforce,
 39     PrefixedReport,
 40     PrefixedEnforce,
 41 };
 42 
 43 class ContentSecurityPolicyResponseHeaders {
 44 public:
 45     ContentSecurityPolicyResponseHeaders() = default;
 46     WEBCORE_EXPORT explicit ContentSecurityPolicyResponseHeaders(const ResourceResponse&amp;);
 47 
 48     ContentSecurityPolicyResponseHeaders isolatedCopy() const;
 49 
 50     template &lt;class Encoder&gt; void encode(Encoder&amp;) const;
 51     template &lt;class Decoder&gt; static bool decode(Decoder&amp;, ContentSecurityPolicyResponseHeaders&amp;);
 52 
<span class="line-added"> 53     enum EmptyTag { Empty };</span>
<span class="line-added"> 54     struct MarkableTraits {</span>
<span class="line-added"> 55         static bool isEmptyValue(const ContentSecurityPolicyResponseHeaders&amp; identifier)</span>
<span class="line-added"> 56         {</span>
<span class="line-added"> 57             return identifier.m_emptyForMarkable;</span>
<span class="line-added"> 58         }</span>
<span class="line-added"> 59 </span>
<span class="line-added"> 60         static ContentSecurityPolicyResponseHeaders emptyValue()</span>
<span class="line-added"> 61         {</span>
<span class="line-added"> 62             return ContentSecurityPolicyResponseHeaders(Empty);</span>
<span class="line-added"> 63         }</span>
<span class="line-added"> 64     };</span>
<span class="line-added"> 65 </span>
 66 private:
 67     friend class ContentSecurityPolicy;
<span class="line-added"> 68     ContentSecurityPolicyResponseHeaders(EmptyTag)</span>
<span class="line-added"> 69         : m_emptyForMarkable(true)</span>
<span class="line-added"> 70     { }</span>
 71 
 72     Vector&lt;std::pair&lt;String, ContentSecurityPolicyHeaderType&gt;&gt; m_headers;
 73     int m_httpStatusCode { 0 };
<span class="line-added"> 74     bool m_emptyForMarkable { false };</span>
 75 };
 76 
 77 template &lt;class Encoder&gt;
 78 void ContentSecurityPolicyResponseHeaders::encode(Encoder&amp; encoder) const
 79 {
 80     encoder &lt;&lt; static_cast&lt;uint64_t&gt;(m_headers.size());
 81     for (auto&amp; pair : m_headers) {
 82         encoder &lt;&lt; pair.first;
 83         encoder.encodeEnum(pair.second);
 84     }
 85     encoder &lt;&lt; m_httpStatusCode;
 86 }
 87 
 88 template &lt;class Decoder&gt;
 89 bool ContentSecurityPolicyResponseHeaders::decode(Decoder&amp; decoder, ContentSecurityPolicyResponseHeaders&amp; headers)
 90 {
 91     uint64_t headersSize;
 92     if (!decoder.decode(headersSize))
 93         return false;

 94     for (size_t i = 0; i &lt; headersSize; ++i) {
 95         String header;
 96         if (!decoder.decode(header))
 97             return false;
 98         ContentSecurityPolicyHeaderType headerType;
 99         if (!decoder.decodeEnum(headerType))
100             return false;
101         headers.m_headers.append(std::make_pair(header, headerType));
102     }
<span class="line-added">103     headers.m_headers.shrinkToFit();</span>
104 
105     if (!decoder.decode(headers.m_httpStatusCode))
106         return false;
107 
108     return true;
109 }
110 
111 } // namespace WebCore
</pre>
</td>
</tr>
</table>
<center><a href="ContentSecurityPolicy.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../linux/ResourceUsageOverlayLinux.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>