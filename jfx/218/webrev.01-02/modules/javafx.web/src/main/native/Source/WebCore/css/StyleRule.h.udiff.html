<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/css/StyleRule.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="StyleRule.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="StyleRuleImport.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/css/StyleRule.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -22,10 +22,11 @@</span>
  #pragma once
  
  #include &quot;CSSSelectorList.h&quot;
  #include &quot;CompiledSelector.h&quot;
  #include &quot;StyleProperties.h&quot;
<span class="udiff-line-added">+ #include &quot;StyleRuleType.h&quot;</span>
  #include &lt;wtf/RefPtr.h&gt;
  #include &lt;wtf/TypeCasts.h&gt;
  #include &lt;wtf/UniqueArray.h&gt;
  
  namespace WebCore {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -37,61 +38,45 @@</span>
  class MutableStyleProperties;
  class StyleRuleKeyframe;
  class StyleProperties;
  class StyleRuleKeyframes;
  
<span class="udiff-line-added">+ DECLARE_ALLOCATOR_WITH_HEAP_IDENTIFIER(StyleRuleBase);</span>
  class StyleRuleBase : public WTF::RefCountedBase {
<span class="udiff-line-modified-removed">-     WTF_MAKE_FAST_ALLOCATED;</span>
<span class="udiff-line-modified-added">+     WTF_MAKE_STRUCT_FAST_ALLOCATED_WITH_HEAP_IDENTIFIER(StyleRuleBase);</span>
  public:
<span class="udiff-line-modified-removed">-     enum Type {</span>
<span class="udiff-line-modified-removed">-         Unknown, // Not used.</span>
<span class="udiff-line-modified-removed">-         Style,</span>
<span class="udiff-line-modified-removed">-         Charset, // Not used. These are internally strings owned by the style sheet.</span>
<span class="udiff-line-modified-removed">-         Import,</span>
<span class="udiff-line-modified-removed">-         Media,</span>
<span class="udiff-line-modified-removed">-         FontFace,</span>
<span class="udiff-line-modified-removed">-         Page,</span>
<span class="udiff-line-modified-removed">-         Keyframes,</span>
<span class="udiff-line-modified-removed">-         Keyframe, // Not used. These are internally non-rule StyleRuleKeyframe objects.</span>
<span class="udiff-line-modified-removed">-         Namespace,</span>
<span class="udiff-line-removed">-         Supports = 12,</span>
<span class="udiff-line-removed">- #if ENABLE(CSS_DEVICE_ADAPTATION)</span>
<span class="udiff-line-removed">-         Viewport = 15,</span>
<span class="udiff-line-removed">- #endif</span>
<span class="udiff-line-removed">-     };</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     Type type() const { return static_cast&lt;Type&gt;(m_type); }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-     bool isCharsetRule() const { return type() == Charset; }</span>
<span class="udiff-line-removed">-     bool isFontFaceRule() const { return type() == FontFace; }</span>
<span class="udiff-line-removed">-     bool isKeyframesRule() const { return type() == Keyframes; }</span>
<span class="udiff-line-removed">-     bool isKeyframeRule() const { return type() == Keyframe; }</span>
<span class="udiff-line-removed">-     bool isNamespaceRule() const { return type() == Namespace; }</span>
<span class="udiff-line-removed">-     bool isMediaRule() const { return type() == Media; }</span>
<span class="udiff-line-removed">-     bool isPageRule() const { return type() == Page; }</span>
<span class="udiff-line-removed">-     bool isStyleRule() const { return type() == Style; }</span>
<span class="udiff-line-removed">-     bool isSupportsRule() const { return type() == Supports; }</span>
<span class="udiff-line-modified-added">+     StyleRuleType type() const { return static_cast&lt;StyleRuleType&gt;(m_type); }</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+     bool isCharsetRule() const { return type() == StyleRuleType::Charset; }</span>
<span class="udiff-line-modified-added">+     bool isFontFaceRule() const { return type() == StyleRuleType::FontFace; }</span>
<span class="udiff-line-modified-added">+     bool isKeyframesRule() const { return type() == StyleRuleType::Keyframes; }</span>
<span class="udiff-line-modified-added">+     bool isKeyframeRule() const { return type() == StyleRuleType::Keyframe; }</span>
<span class="udiff-line-modified-added">+     bool isNamespaceRule() const { return type() == StyleRuleType::Namespace; }</span>
<span class="udiff-line-modified-added">+     bool isMediaRule() const { return type() == StyleRuleType::Media; }</span>
<span class="udiff-line-modified-added">+     bool isPageRule() const { return type() == StyleRuleType::Page; }</span>
<span class="udiff-line-modified-added">+     bool isStyleRule() const { return type() == StyleRuleType::Style; }</span>
<span class="udiff-line-modified-added">+     bool isSupportsRule() const { return type() == StyleRuleType::Supports; }</span>
  #if ENABLE(CSS_DEVICE_ADAPTATION)
<span class="udiff-line-modified-removed">-     bool isViewportRule() const { return type() == Viewport; }</span>
<span class="udiff-line-modified-added">+     bool isViewportRule() const { return type() == StyleRuleType::Viewport; }</span>
  #endif
<span class="udiff-line-modified-removed">-     bool isImportRule() const { return type() == Import; }</span>
<span class="udiff-line-modified-added">+     bool isImportRule() const { return type() == StyleRuleType::Import; }</span>
  
      Ref&lt;StyleRuleBase&gt; copy() const;
  
<span class="udiff-line-modified-removed">-     void deref()</span>
<span class="udiff-line-modified-added">+     void deref() const</span>
      {
          if (derefBase())
<span class="udiff-line-modified-removed">-             destroy();</span>
<span class="udiff-line-modified-added">+             const_cast&lt;StyleRuleBase&amp;&gt;(*this).destroy();</span>
      }
  
      // FIXME: There shouldn&#39;t be any need for the null parent version.
      Ref&lt;CSSRule&gt; createCSSOMWrapper(CSSStyleSheet* parentSheet = nullptr) const;
      Ref&lt;CSSRule&gt; createCSSOMWrapper(CSSRule* parentRule) const;
  
  protected:
<span class="udiff-line-modified-removed">-     StyleRuleBase(Type type, bool hasDocumentSecurityOrigin = false)</span>
<span class="udiff-line-modified-removed">-         : m_type(type)</span>
<span class="udiff-line-modified-added">+     StyleRuleBase(StyleRuleType type, bool hasDocumentSecurityOrigin = false)</span>
<span class="udiff-line-modified-added">+         : m_type(static_cast&lt;unsigned&gt;(type))</span>
          , m_hasDocumentSecurityOrigin(hasDocumentSecurityOrigin)
      {
      }
  
      StyleRuleBase(const StyleRuleBase&amp; o)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -108,17 +93,18 @@</span>
  private:
      WEBCORE_EXPORT void destroy();
  
      Ref&lt;CSSRule&gt; createCSSOMWrapper(CSSStyleSheet* parentSheet, CSSRule* parentRule) const;
  
<span class="udiff-line-modified-removed">-     unsigned m_type : 5;</span>
<span class="udiff-line-modified-added">+     unsigned m_type : 5; // StyleRuleType</span>
      // This is only needed to support getMatchedCSSRules.
      unsigned m_hasDocumentSecurityOrigin : 1;
  };
  
<span class="udiff-line-added">+ DECLARE_ALLOCATOR_WITH_HEAP_IDENTIFIER(StyleRule);</span>
  class StyleRule final : public StyleRuleBase {
<span class="udiff-line-modified-removed">-     WTF_MAKE_FAST_ALLOCATED;</span>
<span class="udiff-line-modified-added">+     WTF_MAKE_STRUCT_FAST_ALLOCATED_WITH_HEAP_IDENTIFIER(StyleRule);</span>
  public:
      static Ref&lt;StyleRule&gt; create(Ref&lt;StylePropertiesBase&gt;&amp;&amp; properties, bool hasDocumentSecurityOrigin, CSSSelectorList&amp;&amp; selectors)
      {
          return adoptRef(*new StyleRule(WTFMove(properties), hasDocumentSecurityOrigin, WTFMove(selectors)));
      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -144,11 +130,11 @@</span>
      Ref&lt;StyleRule&gt; copy() const { return adoptRef(*new StyleRule(*this)); }
  
      Vector&lt;RefPtr&lt;StyleRule&gt;&gt; splitIntoMultipleRulesWithMaximumSelectorComponentCount(unsigned) const;
  
  #if ENABLE(CSS_SELECTOR_JIT)
<span class="udiff-line-modified-removed">-     CompiledSelector&amp; compiledSelectorForListIndex(unsigned index)</span>
<span class="udiff-line-modified-added">+     CompiledSelector&amp; compiledSelectorForListIndex(unsigned index) const</span>
      {
          if (!m_compiledSelectors)
              m_compiledSelectors = makeUniqueArray&lt;CompiledSelector&gt;(m_selectorList.listSize());
          return m_compiledSelectors[index];
      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -239,12 +225,12 @@</span>
  
      void wrapperInsertRule(unsigned, Ref&lt;StyleRuleBase&gt;&amp;&amp;);
      void wrapperRemoveRule(unsigned);
  
  protected:
<span class="udiff-line-modified-removed">-     StyleRuleGroup(Type, Vector&lt;RefPtr&lt;StyleRuleBase&gt;&gt;&amp;);</span>
<span class="udiff-line-modified-removed">-     StyleRuleGroup(Type, std::unique_ptr&lt;DeferredStyleGroupRuleList&gt;&amp;&amp;);</span>
<span class="udiff-line-modified-added">+     StyleRuleGroup(StyleRuleType, Vector&lt;RefPtr&lt;StyleRuleBase&gt;&gt;&amp;);</span>
<span class="udiff-line-modified-added">+     StyleRuleGroup(StyleRuleType, std::unique_ptr&lt;DeferredStyleGroupRuleList&gt;&amp;&amp;);</span>
      StyleRuleGroup(const StyleRuleGroup&amp;);
  
  private:
      void parseDeferredRulesIfNeeded() const;
  
</pre>
<center><a href="StyleRule.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="StyleRuleImport.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>