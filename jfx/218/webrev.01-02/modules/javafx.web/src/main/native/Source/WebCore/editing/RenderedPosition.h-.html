<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old modules/javafx.web/src/main/native/Source/WebCore/editing/RenderedPosition.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (C) 2011 Google Inc. All rights reserved.
  3  *
  4  * Redistribution and use in source and binary forms, with or without
  5  * modification, are permitted provided that the following conditions are
  6  * met:
  7  *
  8  *     * Redistributions of source code must retain the above copyright
  9  * notice, this list of conditions and the following disclaimer.
 10  *     * Redistributions in binary form must reproduce the above
 11  * copyright notice, this list of conditions and the following disclaimer
 12  * in the documentation and/or other materials provided with the
 13  * distribution.
 14  *     * Neither the name of Google Inc. nor the names of its
 15  * contributors may be used to endorse or promote products derived from
 16  * this software without specific prior written permission.
 17  *
 18  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 19  * &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 20  * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 21  * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 22  * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 23  * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 24  * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 25  * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 26  * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 27  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 28  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 29  */
 30 
 31 #pragma once
 32 
 33 #include &quot;InlineBox.h&quot;
 34 #include &quot;TextAffinity.h&quot;
 35 
 36 namespace WebCore {
 37 
 38 class LayoutUnit;
 39 class Position;
 40 class RenderObject;
 41 class VisiblePosition;
 42 
 43 class RenderedPosition {
 44 public:
 45     RenderedPosition();
 46     explicit RenderedPosition(const VisiblePosition&amp;);
 47     explicit RenderedPosition(const Position&amp;, EAffinity);
 48     bool isEquivalent(const RenderedPosition&amp;) const;
 49 
 50     bool isNull() const { return !m_renderer; }
 51     RootInlineBox* rootBox() { return m_inlineBox ? &amp;m_inlineBox-&gt;root() : 0; }
 52 
 53     unsigned char bidiLevelOnLeft() const;
 54     unsigned char bidiLevelOnRight() const;
 55     RenderedPosition leftBoundaryOfBidiRun(unsigned char bidiLevelOfRun);
 56     RenderedPosition rightBoundaryOfBidiRun(unsigned char bidiLevelOfRun);
 57 
 58     enum ShouldMatchBidiLevel { MatchBidiLevel, IgnoreBidiLevel };
 59     bool atLeftBoundaryOfBidiRun() const { return atLeftBoundaryOfBidiRun(IgnoreBidiLevel, 0); }
 60     bool atRightBoundaryOfBidiRun() const { return atRightBoundaryOfBidiRun(IgnoreBidiLevel, 0); }
 61     // The following two functions return true only if the current position is at the end of the bidi run
 62     // of the specified bidi embedding level.
 63     bool atLeftBoundaryOfBidiRun(unsigned char bidiLevelOfRun) const { return atLeftBoundaryOfBidiRun(MatchBidiLevel, bidiLevelOfRun); }
 64     bool atRightBoundaryOfBidiRun(unsigned char bidiLevelOfRun) const { return atRightBoundaryOfBidiRun(MatchBidiLevel, bidiLevelOfRun); }
 65 
 66     Position positionAtLeftBoundaryOfBiDiRun() const;
 67     Position positionAtRightBoundaryOfBiDiRun() const;
 68 
 69     IntRect absoluteRect(LayoutUnit* extraWidthToEndOfLine = nullptr) const;
 70 
 71 private:
 72     bool operator==(const RenderedPosition&amp;) const { return false; }
 73     explicit RenderedPosition(RenderObject*, InlineBox*, int offset);
 74 
 75     InlineBox* prevLeafChild() const;
 76     InlineBox* nextLeafChild() const;
 77     bool atLeftmostOffsetInBox() const { return m_inlineBox &amp;&amp; m_offset == m_inlineBox-&gt;caretLeftmostOffset(); }
 78     bool atRightmostOffsetInBox() const { return m_inlineBox &amp;&amp; m_offset == m_inlineBox-&gt;caretRightmostOffset(); }
 79     bool atLeftBoundaryOfBidiRun(ShouldMatchBidiLevel, unsigned char bidiLevelOfRun) const;
 80     bool atRightBoundaryOfBidiRun(ShouldMatchBidiLevel, unsigned char bidiLevelOfRun) const;
 81 
 82     RenderObject* m_renderer { nullptr };
 83     InlineBox* m_inlineBox { nullptr };
 84     int m_offset;
 85 
 86     static InlineBox* uncachedInlineBox() { return reinterpret_cast&lt;InlineBox*&gt;(1); }
 87     // Needs to be different form 0 so pick 1 because it&#39;s also on the null page.
 88 
 89     mutable InlineBox* m_prevLeafChild;
 90     mutable InlineBox* m_nextLeafChild;
 91 };
 92 
 93 inline RenderedPosition::RenderedPosition()
 94     : m_offset(0)
 95     , m_prevLeafChild(uncachedInlineBox())
 96     , m_nextLeafChild(uncachedInlineBox())
 97 {
 98 }
 99 
100 inline RenderedPosition::RenderedPosition(RenderObject* renderer, InlineBox* box, int offset)
101     : m_renderer(renderer)
102     , m_inlineBox(box)
103     , m_offset(offset)
104     , m_prevLeafChild(uncachedInlineBox())
105     , m_nextLeafChild(uncachedInlineBox())
106 {
107 }
108 
109 bool renderObjectContainsPosition(RenderObject*, const Position&amp;);
110 
111 } // namespace WebCore
    </pre>
  </body>
</html>