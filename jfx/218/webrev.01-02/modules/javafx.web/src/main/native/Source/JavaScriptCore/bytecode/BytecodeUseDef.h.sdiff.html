<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/bytecode/BytecodeUseDef.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="BytecodeRewriter.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CallLinkInfo.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/bytecode/BytecodeUseDef.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 15  * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS
 17  * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 18  * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 19  * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 20  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 21  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 22  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 23  * THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #include &quot;BytecodeStructs.h&quot;
 29 #include &quot;CodeBlock.h&quot;
 30 #include &quot;Instruction.h&quot;
 31 #include &lt;wtf/Forward.h&gt;
 32 
 33 namespace JSC {
 34 
<span class="line-modified"> 35 #define CALL_FUNCTOR(__arg) \</span>
<span class="line-modified"> 36     functor(__bytecode.m_##__arg);</span>
 37 
<span class="line-modified"> 38 #define USES_OR_DEFS(__opcode, ...) \</span>
<span class="line-modified"> 39     case __opcode::opcodeID: { \</span>
<span class="line-removed"> 40         auto __bytecode = instruction-&gt;as&lt;__opcode&gt;(); \</span>
<span class="line-removed"> 41         WTF_LAZY_FOR_EACH_TERM(CALL_FUNCTOR, __VA_ARGS__) \</span>
<span class="line-removed"> 42         return; \</span>
<span class="line-removed"> 43     }</span>
<span class="line-removed"> 44 </span>
<span class="line-removed"> 45 #define USES USES_OR_DEFS</span>
<span class="line-removed"> 46 #define DEFS USES_OR_DEFS</span>
<span class="line-removed"> 47 </span>
<span class="line-removed"> 48 template&lt;typename Block, typename Functor&gt;</span>
<span class="line-removed"> 49 void computeUsesForBytecodeOffset(Block* codeBlock, OpcodeID opcodeID, const Instruction* instruction, const Functor&amp; functor)</span>
 50 {

 51     if (opcodeID != op_enter &amp;&amp; (codeBlock-&gt;wasCompiledWithDebuggingOpcodes() || codeBlock-&gt;usesEval()) &amp;&amp; codeBlock-&gt;scopeRegister().isValid())
 52         functor(codeBlock-&gt;scopeRegister());
 53 
<span class="line-modified"> 54     auto handleNewArrayLike = [&amp;](auto op) {</span>
<span class="line-removed"> 55         int base = op.m_argv.offset();</span>
<span class="line-removed"> 56         for (int i = 0; i &lt; static_cast&lt;int&gt;(op.m_argc); i++)</span>
<span class="line-removed"> 57             functor(VirtualRegister { base - i });</span>
<span class="line-removed"> 58     };</span>
<span class="line-removed"> 59 </span>
<span class="line-removed"> 60     auto handleOpCallLike = [&amp;](auto op) {</span>
<span class="line-removed"> 61         functor(op.m_callee);</span>
<span class="line-removed"> 62         int lastArg = -static_cast&lt;int&gt;(op.m_argv) + CallFrame::thisArgumentOffset();</span>
<span class="line-removed"> 63         for (int i = 0; i &lt; static_cast&lt;int&gt;(op.m_argc); i++)</span>
<span class="line-removed"> 64             functor(VirtualRegister { lastArg + i });</span>
<span class="line-removed"> 65         if (opcodeID == op_call_eval)</span>
<span class="line-removed"> 66             functor(codeBlock-&gt;scopeRegister());</span>
<span class="line-removed"> 67         return;</span>
<span class="line-removed"> 68     };</span>
<span class="line-removed"> 69 </span>
<span class="line-removed"> 70     switch (opcodeID) {</span>
<span class="line-removed"> 71     case op_wide16:</span>
<span class="line-removed"> 72     case op_wide32:</span>
<span class="line-removed"> 73         RELEASE_ASSERT_NOT_REACHED();</span>
<span class="line-removed"> 74 </span>
<span class="line-removed"> 75     // No uses.</span>
<span class="line-removed"> 76     case op_new_regexp:</span>
<span class="line-removed"> 77     case op_debug:</span>
<span class="line-removed"> 78     case op_jneq_ptr:</span>
<span class="line-removed"> 79     case op_loop_hint:</span>
<span class="line-removed"> 80     case op_jmp:</span>
<span class="line-removed"> 81     case op_new_object:</span>
<span class="line-removed"> 82     case op_enter:</span>
<span class="line-removed"> 83     case op_argument_count:</span>
<span class="line-removed"> 84     case op_catch:</span>
<span class="line-removed"> 85     case op_profile_control_flow:</span>
<span class="line-removed"> 86     case op_create_direct_arguments:</span>
<span class="line-removed"> 87     case op_create_cloned_arguments:</span>
<span class="line-removed"> 88     case op_get_rest_length:</span>
<span class="line-removed"> 89     case op_get_argument:</span>
<span class="line-removed"> 90     case op_nop:</span>
<span class="line-removed"> 91     case op_unreachable:</span>
<span class="line-removed"> 92     case op_super_sampler_begin:</span>
<span class="line-removed"> 93     case op_super_sampler_end:</span>
<span class="line-removed"> 94         return;</span>
<span class="line-removed"> 95 </span>
<span class="line-removed"> 96     USES(OpGetScope, dst)</span>
<span class="line-removed"> 97     USES(OpToThis, srcDst)</span>
<span class="line-removed"> 98     USES(OpCheckTdz, targetVirtualRegister)</span>
<span class="line-removed"> 99     USES(OpIdentityWithProfile, srcDst)</span>
<span class="line-removed">100     USES(OpProfileType, targetVirtualRegister);</span>
<span class="line-removed">101     USES(OpThrow, value)</span>
<span class="line-removed">102     USES(OpThrowStaticError, message)</span>
<span class="line-removed">103     USES(OpEnd, value)</span>
<span class="line-removed">104     USES(OpRet, value)</span>
<span class="line-removed">105     USES(OpJtrue, condition)</span>
<span class="line-removed">106     USES(OpJfalse, condition)</span>
<span class="line-removed">107     USES(OpJeqNull, value)</span>
<span class="line-removed">108     USES(OpJneqNull, value)</span>
<span class="line-removed">109     USES(OpJundefinedOrNull, value)</span>
<span class="line-removed">110     USES(OpJnundefinedOrNull, value)</span>
<span class="line-removed">111     USES(OpDec, srcDst)</span>
<span class="line-removed">112     USES(OpInc, srcDst)</span>
<span class="line-removed">113     USES(OpLogShadowChickenPrologue, scope)</span>
<span class="line-removed">114 </span>
<span class="line-removed">115     USES(OpJless, lhs, rhs)</span>
<span class="line-removed">116     USES(OpJlesseq, lhs, rhs)</span>
<span class="line-removed">117     USES(OpJgreater, lhs, rhs)</span>
<span class="line-removed">118     USES(OpJgreatereq, lhs, rhs)</span>
<span class="line-removed">119     USES(OpJnless, lhs, rhs)</span>
<span class="line-removed">120     USES(OpJnlesseq, lhs, rhs)</span>
<span class="line-removed">121     USES(OpJngreater, lhs, rhs)</span>
<span class="line-removed">122     USES(OpJngreatereq, lhs, rhs)</span>
<span class="line-removed">123     USES(OpJeq, lhs, rhs)</span>
<span class="line-removed">124     USES(OpJneq, lhs, rhs)</span>
<span class="line-removed">125     USES(OpJstricteq, lhs, rhs)</span>
<span class="line-removed">126     USES(OpJnstricteq, lhs, rhs)</span>
<span class="line-removed">127     USES(OpJbelow, lhs, rhs)</span>
<span class="line-removed">128     USES(OpJbeloweq, lhs, rhs)</span>
<span class="line-removed">129     USES(OpSetFunctionName, function, name)</span>
<span class="line-removed">130     USES(OpLogShadowChickenTail, thisValue, scope)</span>
<span class="line-removed">131 </span>
<span class="line-removed">132     USES(OpPutByVal, base, property, value)</span>
<span class="line-removed">133     USES(OpPutByValDirect, base, property, value)</span>
<span class="line-removed">134 </span>
<span class="line-removed">135     USES(OpPutById, base, value)</span>
<span class="line-removed">136     USES(OpPutToScope, scope, value)</span>
<span class="line-removed">137     USES(OpPutToArguments, arguments, value)</span>
<span class="line-removed">138 </span>
<span class="line-removed">139     USES(OpPutByIdWithThis, base, thisValue, value)</span>
<span class="line-removed">140 </span>
<span class="line-removed">141     USES(OpPutByValWithThis, base, thisValue, property, value)</span>
<span class="line-removed">142 </span>
<span class="line-removed">143     USES(OpPutGetterById, base, accessor)</span>
<span class="line-removed">144     USES(OpPutSetterById, base, accessor)</span>
<span class="line-removed">145 </span>
<span class="line-removed">146     USES(OpPutGetterSetterById, base, getter, setter)</span>
<span class="line-removed">147 </span>
<span class="line-removed">148     USES(OpPutGetterByVal, base, property, accessor)</span>
<span class="line-removed">149     USES(OpPutSetterByVal, base, property, accessor)</span>
<span class="line-removed">150 </span>
<span class="line-removed">151     USES(OpDefineDataProperty, base, property, value, attributes)</span>
<span class="line-removed">152 </span>
<span class="line-removed">153     USES(OpDefineAccessorProperty, base, property, getter, setter, attributes)</span>
<span class="line-removed">154 </span>
<span class="line-removed">155     USES(OpSpread, argument)</span>
<span class="line-removed">156     USES(OpGetPropertyEnumerator, base)</span>
<span class="line-removed">157     USES(OpGetEnumerableLength, base)</span>
<span class="line-removed">158     USES(OpNewFuncExp, scope)</span>
<span class="line-removed">159     USES(OpNewGeneratorFuncExp, scope)</span>
<span class="line-removed">160     USES(OpNewAsyncFuncExp, scope)</span>
<span class="line-removed">161     USES(OpToIndexString, index)</span>
<span class="line-removed">162     USES(OpCreateLexicalEnvironment, scope, symbolTable, initialValue)</span>
<span class="line-removed">163     USES(OpCreateGeneratorFrameEnvironment, scope, symbolTable, initialValue)</span>
<span class="line-removed">164     USES(OpResolveScope, scope)</span>
<span class="line-removed">165     USES(OpResolveScopeForHoistingFuncDeclInEval, scope)</span>
<span class="line-removed">166     USES(OpGetFromScope, scope)</span>
<span class="line-removed">167     USES(OpToPrimitive, src)</span>
<span class="line-removed">168     USES(OpTryGetById, base)</span>
<span class="line-removed">169     USES(OpGetById, base)</span>
<span class="line-removed">170     USES(OpGetByIdDirect, base)</span>
<span class="line-removed">171     USES(OpInById, base)</span>
<span class="line-removed">172     USES(OpTypeof, value)</span>
<span class="line-removed">173     USES(OpIsEmpty, operand)</span>
<span class="line-removed">174     USES(OpIsUndefined, operand)</span>
<span class="line-removed">175     USES(OpIsUndefinedOrNull, operand)</span>
<span class="line-removed">176     USES(OpIsBoolean, operand)</span>
<span class="line-removed">177     USES(OpIsNumber, operand)</span>
<span class="line-removed">178     USES(OpIsObject, operand)</span>
<span class="line-removed">179     USES(OpIsObjectOrNull, operand)</span>
<span class="line-removed">180     USES(OpIsCellWithType, operand)</span>
<span class="line-removed">181     USES(OpIsFunction, operand)</span>
<span class="line-removed">182     USES(OpToNumber, operand)</span>
<span class="line-removed">183     USES(OpToString, operand)</span>
<span class="line-removed">184     USES(OpToObject, operand)</span>
<span class="line-removed">185     USES(OpNegate, operand)</span>
<span class="line-removed">186     USES(OpBitnot, operand)</span>
<span class="line-removed">187     USES(OpEqNull, operand)</span>
<span class="line-removed">188     USES(OpNeqNull, operand)</span>
<span class="line-removed">189     USES(OpNot, operand)</span>
<span class="line-removed">190     USES(OpUnsigned, operand)</span>
<span class="line-removed">191     USES(OpMov, src)</span>
<span class="line-removed">192     USES(OpNewArrayWithSize, length)</span>
<span class="line-removed">193     USES(OpCreateThis, callee)</span>
<span class="line-removed">194     USES(OpDelById, base)</span>
<span class="line-removed">195     USES(OpNewFunc, scope)</span>
<span class="line-removed">196     USES(OpNewAsyncGeneratorFunc, scope)</span>
<span class="line-removed">197     USES(OpNewAsyncGeneratorFuncExp, scope)</span>
<span class="line-removed">198     USES(OpNewGeneratorFunc, scope)</span>
<span class="line-removed">199     USES(OpNewAsyncFunc, scope)</span>
<span class="line-removed">200     USES(OpGetParentScope, scope)</span>
<span class="line-removed">201     USES(OpCreateScopedArguments, scope)</span>
<span class="line-removed">202     USES(OpCreateRest, arraySize)</span>
<span class="line-removed">203     USES(OpGetFromArguments, arguments)</span>
<span class="line-removed">204     USES(OpNewArrayBuffer, immutableButterfly)</span>
<span class="line-removed">205 </span>
<span class="line-removed">206     USES(OpHasGenericProperty, base, property)</span>
<span class="line-removed">207     USES(OpHasIndexedProperty, base, property)</span>
<span class="line-removed">208     USES(OpEnumeratorStructurePname, enumerator, index)</span>
<span class="line-removed">209     USES(OpEnumeratorGenericPname, enumerator, index)</span>
<span class="line-removed">210     USES(OpGetByVal, base, property)</span>
<span class="line-removed">211     USES(OpInByVal, base, property)</span>
<span class="line-removed">212     USES(OpOverridesHasInstance, constructor, hasInstanceValue)</span>
<span class="line-removed">213     USES(OpInstanceof, value, prototype)</span>
<span class="line-removed">214     USES(OpAdd, lhs, rhs)</span>
<span class="line-removed">215     USES(OpMul, lhs, rhs)</span>
<span class="line-removed">216     USES(OpDiv, lhs, rhs)</span>
<span class="line-removed">217     USES(OpMod, lhs, rhs)</span>
<span class="line-removed">218     USES(OpSub, lhs, rhs)</span>
<span class="line-removed">219     USES(OpPow, lhs, rhs)</span>
<span class="line-removed">220     USES(OpLshift, lhs, rhs)</span>
<span class="line-removed">221     USES(OpRshift, lhs, rhs)</span>
<span class="line-removed">222     USES(OpUrshift, lhs, rhs)</span>
<span class="line-removed">223     USES(OpBitand, lhs, rhs)</span>
<span class="line-removed">224     USES(OpBitxor, lhs, rhs)</span>
<span class="line-removed">225     USES(OpBitor, lhs, rhs)</span>
<span class="line-removed">226     USES(OpLess, lhs, rhs)</span>
<span class="line-removed">227     USES(OpLesseq, lhs, rhs)</span>
<span class="line-removed">228     USES(OpGreater, lhs, rhs)</span>
<span class="line-removed">229     USES(OpGreatereq, lhs, rhs)</span>
<span class="line-removed">230     USES(OpBelow, lhs, rhs)</span>
<span class="line-removed">231     USES(OpBeloweq, lhs, rhs)</span>
<span class="line-removed">232     USES(OpNstricteq, lhs, rhs)</span>
<span class="line-removed">233     USES(OpStricteq, lhs, rhs)</span>
<span class="line-removed">234     USES(OpNeq, lhs, rhs)</span>
<span class="line-removed">235     USES(OpEq, lhs, rhs)</span>
<span class="line-removed">236     USES(OpPushWithScope, currentScope, newScope)</span>
<span class="line-removed">237     USES(OpGetByIdWithThis, base, thisValue)</span>
<span class="line-removed">238     USES(OpDelByVal, base, property)</span>
<span class="line-removed">239     USES(OpTailCallForwardArguments, callee, thisValue)</span>
<span class="line-removed">240 </span>
<span class="line-removed">241     USES(OpGetByValWithThis, base, thisValue, property)</span>
<span class="line-removed">242     USES(OpInstanceofCustom, value, constructor, hasInstanceValue)</span>
<span class="line-removed">243     USES(OpHasStructureProperty, base, property, enumerator)</span>
<span class="line-removed">244     USES(OpConstructVarargs, callee, thisValue, arguments)</span>
<span class="line-removed">245     USES(OpCallVarargs, callee, thisValue, arguments)</span>
<span class="line-removed">246     USES(OpTailCallVarargs, callee, thisValue, arguments)</span>
<span class="line-removed">247 </span>
<span class="line-removed">248     USES(OpGetDirectPname, base, property, index, enumerator)</span>
<span class="line-removed">249 </span>
<span class="line-removed">250     USES(OpSwitchString, scrutinee)</span>
<span class="line-removed">251     USES(OpSwitchChar, scrutinee)</span>
<span class="line-removed">252     USES(OpSwitchImm, scrutinee)</span>
<span class="line-removed">253 </span>
<span class="line-removed">254     USES(OpYield, generator, argument)</span>
<span class="line-removed">255 </span>
<span class="line-removed">256     case op_new_array_with_spread:</span>
<span class="line-removed">257         handleNewArrayLike(instruction-&gt;as&lt;OpNewArrayWithSpread&gt;());</span>
<span class="line-removed">258         return;</span>
<span class="line-removed">259     case op_new_array:</span>
<span class="line-removed">260         handleNewArrayLike(instruction-&gt;as&lt;OpNewArray&gt;());</span>
<span class="line-removed">261         return;</span>
<span class="line-removed">262 </span>
<span class="line-removed">263     case op_strcat: {</span>
<span class="line-removed">264         auto bytecode = instruction-&gt;as&lt;OpStrcat&gt;();</span>
<span class="line-removed">265         int base = bytecode.m_src.offset();</span>
<span class="line-removed">266         for (int i = 0; i &lt; bytecode.m_count; i++)</span>
<span class="line-removed">267             functor(VirtualRegister { base - i });</span>
<span class="line-removed">268         return;</span>
<span class="line-removed">269     }</span>
<span class="line-removed">270 </span>
<span class="line-removed">271     case op_construct:</span>
<span class="line-removed">272         handleOpCallLike(instruction-&gt;as&lt;OpConstruct&gt;());</span>
<span class="line-removed">273         return;</span>
<span class="line-removed">274     case op_call_eval:</span>
<span class="line-removed">275         handleOpCallLike(instruction-&gt;as&lt;OpCallEval&gt;());</span>
<span class="line-removed">276         return;</span>
<span class="line-removed">277     case op_call:</span>
<span class="line-removed">278         handleOpCallLike(instruction-&gt;as&lt;OpCall&gt;());</span>
<span class="line-removed">279         return;</span>
<span class="line-removed">280     case op_tail_call:</span>
<span class="line-removed">281         handleOpCallLike(instruction-&gt;as&lt;OpTailCall&gt;());</span>
<span class="line-removed">282         return;</span>
<span class="line-removed">283 </span>
<span class="line-removed">284     default:</span>
<span class="line-removed">285         RELEASE_ASSERT_NOT_REACHED();</span>
<span class="line-removed">286         break;</span>
<span class="line-removed">287     }</span>
288 }
289 
<span class="line-modified">290 template&lt;typename Block, typename Functor&gt;</span>
<span class="line-modified">291 void computeDefsForBytecodeOffset(Block* codeBlock, OpcodeID opcodeID, const Instruction* instruction, const Functor&amp; functor)</span>
292 {
<span class="line-modified">293     switch (opcodeID) {</span>
<span class="line-removed">294     case op_wide16:</span>
<span class="line-removed">295     case op_wide32:</span>
<span class="line-removed">296         RELEASE_ASSERT_NOT_REACHED();</span>
<span class="line-removed">297 </span>
<span class="line-removed">298     // These don&#39;t define anything.</span>
<span class="line-removed">299     case op_put_to_scope:</span>
<span class="line-removed">300     case op_end:</span>
<span class="line-removed">301     case op_throw:</span>
<span class="line-removed">302     case op_throw_static_error:</span>
<span class="line-removed">303     case op_check_tdz:</span>
<span class="line-removed">304     case op_debug:</span>
<span class="line-removed">305     case op_ret:</span>
<span class="line-removed">306     case op_jmp:</span>
<span class="line-removed">307     case op_jtrue:</span>
<span class="line-removed">308     case op_jfalse:</span>
<span class="line-removed">309     case op_jeq_null:</span>
<span class="line-removed">310     case op_jneq_null:</span>
<span class="line-removed">311     case op_jundefined_or_null:</span>
<span class="line-removed">312     case op_jnundefined_or_null:</span>
<span class="line-removed">313     case op_jneq_ptr:</span>
<span class="line-removed">314     case op_jless:</span>
<span class="line-removed">315     case op_jlesseq:</span>
<span class="line-removed">316     case op_jgreater:</span>
<span class="line-removed">317     case op_jgreatereq:</span>
<span class="line-removed">318     case op_jnless:</span>
<span class="line-removed">319     case op_jnlesseq:</span>
<span class="line-removed">320     case op_jngreater:</span>
<span class="line-removed">321     case op_jngreatereq:</span>
<span class="line-removed">322     case op_jeq:</span>
<span class="line-removed">323     case op_jneq:</span>
<span class="line-removed">324     case op_jstricteq:</span>
<span class="line-removed">325     case op_jnstricteq:</span>
<span class="line-removed">326     case op_jbelow:</span>
<span class="line-removed">327     case op_jbeloweq:</span>
<span class="line-removed">328     case op_loop_hint:</span>
<span class="line-removed">329     case op_switch_imm:</span>
<span class="line-removed">330     case op_switch_char:</span>
<span class="line-removed">331     case op_switch_string:</span>
<span class="line-removed">332     case op_put_by_id:</span>
<span class="line-removed">333     case op_put_by_id_with_this:</span>
<span class="line-removed">334     case op_put_by_val_with_this:</span>
<span class="line-removed">335     case op_put_getter_by_id:</span>
<span class="line-removed">336     case op_put_setter_by_id:</span>
<span class="line-removed">337     case op_put_getter_setter_by_id:</span>
<span class="line-removed">338     case op_put_getter_by_val:</span>
<span class="line-removed">339     case op_put_setter_by_val:</span>
<span class="line-removed">340     case op_put_by_val:</span>
<span class="line-removed">341     case op_put_by_val_direct:</span>
<span class="line-removed">342     case op_define_data_property:</span>
<span class="line-removed">343     case op_define_accessor_property:</span>
<span class="line-removed">344     case op_profile_type:</span>
<span class="line-removed">345     case op_profile_control_flow:</span>
<span class="line-removed">346     case op_put_to_arguments:</span>
<span class="line-removed">347     case op_set_function_name:</span>
<span class="line-removed">348     case op_log_shadow_chicken_prologue:</span>
<span class="line-removed">349     case op_log_shadow_chicken_tail:</span>
<span class="line-removed">350     case op_yield:</span>
<span class="line-removed">351     case op_nop:</span>
<span class="line-removed">352     case op_unreachable:</span>
<span class="line-removed">353     case op_super_sampler_begin:</span>
<span class="line-removed">354     case op_super_sampler_end:</span>
<span class="line-removed">355 #define LLINT_HELPER_OPCODES(opcode, length) case opcode:</span>
<span class="line-removed">356         FOR_EACH_LLINT_OPCODE_EXTENSION(LLINT_HELPER_OPCODES);</span>
<span class="line-removed">357 #undef LLINT_HELPER_OPCODES</span>
<span class="line-removed">358         return;</span>
<span class="line-removed">359     // These all have a single destination for the first argument.</span>
<span class="line-removed">360     DEFS(OpArgumentCount, dst)</span>
<span class="line-removed">361     DEFS(OpToIndexString, dst)</span>
<span class="line-removed">362     DEFS(OpGetEnumerableLength, dst)</span>
<span class="line-removed">363     DEFS(OpHasIndexedProperty, dst)</span>
<span class="line-removed">364     DEFS(OpHasStructureProperty, dst)</span>
<span class="line-removed">365     DEFS(OpHasGenericProperty, dst)</span>
<span class="line-removed">366     DEFS(OpGetDirectPname, dst)</span>
<span class="line-removed">367     DEFS(OpGetPropertyEnumerator, dst)</span>
<span class="line-removed">368     DEFS(OpEnumeratorStructurePname, dst)</span>
<span class="line-removed">369     DEFS(OpEnumeratorGenericPname, dst)</span>
<span class="line-removed">370     DEFS(OpGetParentScope, dst)</span>
<span class="line-removed">371     DEFS(OpPushWithScope, dst)</span>
<span class="line-removed">372     DEFS(OpCreateLexicalEnvironment, dst)</span>
<span class="line-removed">373     DEFS(OpCreateGeneratorFrameEnvironment, dst)</span>
<span class="line-removed">374     DEFS(OpResolveScope, dst)</span>
<span class="line-removed">375     DEFS(OpResolveScopeForHoistingFuncDeclInEval, dst)</span>
<span class="line-removed">376     DEFS(OpStrcat, dst)</span>
<span class="line-removed">377     DEFS(OpToPrimitive, dst)</span>
<span class="line-removed">378     DEFS(OpCreateThis, dst)</span>
<span class="line-removed">379     DEFS(OpNewArray, dst)</span>
<span class="line-removed">380     DEFS(OpNewArrayWithSpread, dst)</span>
<span class="line-removed">381     DEFS(OpSpread, dst)</span>
<span class="line-removed">382     DEFS(OpNewArrayBuffer, dst)</span>
<span class="line-removed">383     DEFS(OpNewArrayWithSize, dst)</span>
<span class="line-removed">384     DEFS(OpNewRegexp, dst)</span>
<span class="line-removed">385     DEFS(OpNewFunc, dst)</span>
<span class="line-removed">386     DEFS(OpNewFuncExp, dst)</span>
<span class="line-removed">387     DEFS(OpNewGeneratorFunc, dst)</span>
<span class="line-removed">388     DEFS(OpNewGeneratorFuncExp, dst)</span>
<span class="line-removed">389     DEFS(OpNewAsyncGeneratorFunc, dst)</span>
<span class="line-removed">390     DEFS(OpNewAsyncGeneratorFuncExp, dst)</span>
<span class="line-removed">391     DEFS(OpNewAsyncFunc, dst)</span>
<span class="line-removed">392     DEFS(OpNewAsyncFuncExp, dst)</span>
<span class="line-removed">393     DEFS(OpCallVarargs, dst)</span>
<span class="line-removed">394     DEFS(OpTailCallVarargs, dst)</span>
<span class="line-removed">395     DEFS(OpTailCallForwardArguments, dst)</span>
<span class="line-removed">396     DEFS(OpConstructVarargs, dst)</span>
<span class="line-removed">397     DEFS(OpGetFromScope, dst)</span>
<span class="line-removed">398     DEFS(OpCall, dst)</span>
<span class="line-removed">399     DEFS(OpTailCall, dst)</span>
<span class="line-removed">400     DEFS(OpCallEval, dst)</span>
<span class="line-removed">401     DEFS(OpConstruct, dst)</span>
<span class="line-removed">402     DEFS(OpTryGetById, dst)</span>
<span class="line-removed">403     DEFS(OpGetById, dst)</span>
<span class="line-removed">404     DEFS(OpGetByIdDirect, dst)</span>
<span class="line-removed">405     DEFS(OpGetByIdWithThis, dst)</span>
<span class="line-removed">406     DEFS(OpGetByValWithThis, dst)</span>
<span class="line-removed">407     DEFS(OpOverridesHasInstance, dst)</span>
<span class="line-removed">408     DEFS(OpInstanceof, dst)</span>
<span class="line-removed">409     DEFS(OpInstanceofCustom, dst)</span>
<span class="line-removed">410     DEFS(OpGetByVal, dst)</span>
<span class="line-removed">411     DEFS(OpTypeof, dst)</span>
<span class="line-removed">412     DEFS(OpIdentityWithProfile, srcDst)</span>
<span class="line-removed">413     DEFS(OpIsEmpty, dst)</span>
<span class="line-removed">414     DEFS(OpIsUndefined, dst)</span>
<span class="line-removed">415     USES(OpIsUndefinedOrNull, dst)</span>
<span class="line-removed">416     DEFS(OpIsBoolean, dst)</span>
<span class="line-removed">417     DEFS(OpIsNumber, dst)</span>
<span class="line-removed">418     DEFS(OpIsObject, dst)</span>
<span class="line-removed">419     DEFS(OpIsObjectOrNull, dst)</span>
<span class="line-removed">420     DEFS(OpIsCellWithType, dst)</span>
<span class="line-removed">421     DEFS(OpIsFunction, dst)</span>
<span class="line-removed">422     DEFS(OpInById, dst)</span>
<span class="line-removed">423     DEFS(OpInByVal, dst)</span>
<span class="line-removed">424     DEFS(OpToNumber, dst)</span>
<span class="line-removed">425     DEFS(OpToString, dst)</span>
<span class="line-removed">426     DEFS(OpToObject, dst)</span>
<span class="line-removed">427     DEFS(OpNegate, dst)</span>
<span class="line-removed">428     DEFS(OpAdd, dst)</span>
<span class="line-removed">429     DEFS(OpMul, dst)</span>
<span class="line-removed">430     DEFS(OpDiv, dst)</span>
<span class="line-removed">431     DEFS(OpMod, dst)</span>
<span class="line-removed">432     DEFS(OpSub, dst)</span>
<span class="line-removed">433     DEFS(OpPow, dst)</span>
<span class="line-removed">434     DEFS(OpLshift, dst)</span>
<span class="line-removed">435     DEFS(OpRshift, dst)</span>
<span class="line-removed">436     DEFS(OpUrshift, dst)</span>
<span class="line-removed">437     DEFS(OpBitand, dst)</span>
<span class="line-removed">438     DEFS(OpBitxor, dst)</span>
<span class="line-removed">439     DEFS(OpBitor, dst)</span>
<span class="line-removed">440     DEFS(OpBitnot, dst)</span>
<span class="line-removed">441     DEFS(OpInc, srcDst)</span>
<span class="line-removed">442     DEFS(OpDec, srcDst)</span>
<span class="line-removed">443     DEFS(OpEq, dst)</span>
<span class="line-removed">444     DEFS(OpNeq, dst)</span>
<span class="line-removed">445     DEFS(OpStricteq, dst)</span>
<span class="line-removed">446     DEFS(OpNstricteq, dst)</span>
<span class="line-removed">447     DEFS(OpLess, dst)</span>
<span class="line-removed">448     DEFS(OpLesseq, dst)</span>
<span class="line-removed">449     DEFS(OpGreater, dst)</span>
<span class="line-removed">450     DEFS(OpGreatereq, dst)</span>
<span class="line-removed">451     DEFS(OpBelow, dst)</span>
<span class="line-removed">452     DEFS(OpBeloweq, dst)</span>
<span class="line-removed">453     DEFS(OpNeqNull, dst)</span>
<span class="line-removed">454     DEFS(OpEqNull, dst)</span>
<span class="line-removed">455     DEFS(OpNot, dst)</span>
<span class="line-removed">456     DEFS(OpMov, dst)</span>
<span class="line-removed">457     DEFS(OpNewObject, dst)</span>
<span class="line-removed">458     DEFS(OpToThis, srcDst)</span>
<span class="line-removed">459     DEFS(OpGetScope, dst)</span>
<span class="line-removed">460     DEFS(OpCreateDirectArguments, dst)</span>
<span class="line-removed">461     DEFS(OpCreateScopedArguments, dst)</span>
<span class="line-removed">462     DEFS(OpCreateClonedArguments, dst)</span>
<span class="line-removed">463     DEFS(OpDelById, dst)</span>
<span class="line-removed">464     DEFS(OpDelByVal, dst)</span>
<span class="line-removed">465     DEFS(OpUnsigned, dst)</span>
<span class="line-removed">466     DEFS(OpGetFromArguments, dst)</span>
<span class="line-removed">467     DEFS(OpGetArgument, dst)</span>
<span class="line-removed">468     DEFS(OpCreateRest, dst)</span>
<span class="line-removed">469     DEFS(OpGetRestLength, dst)</span>
<span class="line-removed">470 </span>
<span class="line-removed">471     DEFS(OpCatch, exception, thrownValue)</span>
<span class="line-removed">472 </span>
<span class="line-removed">473     case op_enter: {</span>
<span class="line-removed">474         for (unsigned i = codeBlock-&gt;numVars(); i--;)</span>
<span class="line-removed">475             functor(virtualRegisterForLocal(i));</span>
<span class="line-removed">476         return;</span>
<span class="line-removed">477     }</span>
<span class="line-removed">478     }</span>
479 }
480 
481 #undef CALL_FUNCTOR
482 #undef USES_OR_DEFS
483 #undef USES
484 #undef DEFS
485 } // namespace JSC
</pre>
</td>
<td>
<hr />
<pre>
 15  * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS
 17  * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 18  * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 19  * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 20  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 21  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 22  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 23  * THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #include &quot;BytecodeStructs.h&quot;
 29 #include &quot;CodeBlock.h&quot;
 30 #include &quot;Instruction.h&quot;
 31 #include &lt;wtf/Forward.h&gt;
 32 
 33 namespace JSC {
 34 
<span class="line-modified"> 35 void computeUsesForBytecodeIndexImpl(VirtualRegister, const Instruction*, const Function&lt;void(VirtualRegister)&gt;&amp;);</span>
<span class="line-modified"> 36 void computeDefsForBytecodeIndexImpl(unsigned, const Instruction*, const Function&lt;void(VirtualRegister)&gt;&amp;);</span>
 37 
<span class="line-modified"> 38 template&lt;typename Block&gt;</span>
<span class="line-modified"> 39 void computeUsesForBytecodeIndex(Block* codeBlock, const Instruction* instruction, const Function&lt;void(VirtualRegister)&gt;&amp; functor)</span>










 40 {
<span class="line-added"> 41     OpcodeID opcodeID = instruction-&gt;opcodeID();</span>
 42     if (opcodeID != op_enter &amp;&amp; (codeBlock-&gt;wasCompiledWithDebuggingOpcodes() || codeBlock-&gt;usesEval()) &amp;&amp; codeBlock-&gt;scopeRegister().isValid())
 43         functor(codeBlock-&gt;scopeRegister());
 44 
<span class="line-modified"> 45     computeUsesForBytecodeIndexImpl(codeBlock-&gt;scopeRegister(), instruction, functor);</span>









































































































































































































































 46 }
 47 
<span class="line-modified"> 48 template&lt;typename Block&gt;</span>
<span class="line-modified"> 49 void computeDefsForBytecodeIndex(Block* codeBlock, const Instruction* instruction, const Function&lt;void(VirtualRegister)&gt;&amp; functor)</span>
 50 {
<span class="line-modified"> 51     computeDefsForBytecodeIndexImpl(codeBlock-&gt;numVars(), instruction, functor);</span>

























































































































































































 52 }
 53 
 54 #undef CALL_FUNCTOR
 55 #undef USES_OR_DEFS
 56 #undef USES
 57 #undef DEFS
 58 } // namespace JSC
</pre>
</td>
</tr>
</table>
<center><a href="BytecodeRewriter.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CallLinkInfo.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>