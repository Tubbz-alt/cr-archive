<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/ObjectPrototype.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  *  Copyright (C) 1999-2000 Harri Porten (porten@kde.org)
  3  *  Copyright (C) 2008-2019 Apple Inc. All rights reserved.
  4  *
  5  *  This library is free software; you can redistribute it and/or
  6  *  modify it under the terms of the GNU Lesser General Public
  7  *  License as published by the Free Software Foundation; either
  8  *  version 2 of the License, or (at your option) any later version.
  9  *
 10  *  This library is distributed in the hope that it will be useful,
 11  *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 12  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 13  *  Lesser General Public License for more details.
 14  *
 15  *  You should have received a copy of the GNU Lesser General Public
 16  *  License along with this library; if not, write to the Free Software
 17  *  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 18  *
 19  */
 20 
 21 #include &quot;config.h&quot;
 22 #include &quot;ObjectPrototype.h&quot;
 23 
 24 #include &quot;Error.h&quot;
 25 #include &quot;GetterSetter.h&quot;
 26 #include &quot;HasOwnPropertyCache.h&quot;
 27 #include &quot;JSFunction.h&quot;
 28 #include &quot;JSString.h&quot;
 29 #include &quot;JSCInlines.h&quot;
 30 #include &quot;PropertySlot.h&quot;
 31 #include &quot;StructureInlines.h&quot;
 32 #include &quot;StructureRareDataInlines.h&quot;
 33 
 34 namespace JSC {
 35 
<a name="1" id="anc1"></a><span class="line-modified"> 36 static EncodedJSValue JSC_HOST_CALL objectProtoFuncValueOf(ExecState*);</span>
<span class="line-modified"> 37 static EncodedJSValue JSC_HOST_CALL objectProtoFuncHasOwnProperty(ExecState*);</span>
<span class="line-modified"> 38 static EncodedJSValue JSC_HOST_CALL objectProtoFuncIsPrototypeOf(ExecState*);</span>
<span class="line-modified"> 39 static EncodedJSValue JSC_HOST_CALL objectProtoFuncDefineGetter(ExecState*);</span>
<span class="line-modified"> 40 static EncodedJSValue JSC_HOST_CALL objectProtoFuncDefineSetter(ExecState*);</span>
<span class="line-modified"> 41 static EncodedJSValue JSC_HOST_CALL objectProtoFuncLookupGetter(ExecState*);</span>
<span class="line-modified"> 42 static EncodedJSValue JSC_HOST_CALL objectProtoFuncLookupSetter(ExecState*);</span>
<span class="line-modified"> 43 static EncodedJSValue JSC_HOST_CALL objectProtoFuncPropertyIsEnumerable(ExecState*);</span>
<span class="line-modified"> 44 static EncodedJSValue JSC_HOST_CALL objectProtoFuncToLocaleString(ExecState*);</span>
 45 
 46 STATIC_ASSERT_IS_TRIVIALLY_DESTRUCTIBLE(ObjectPrototype);
 47 
 48 const ClassInfo ObjectPrototype::s_info = { &quot;Object&quot;, &amp;JSNonFinalObject::s_info, nullptr, nullptr, CREATE_METHOD_TABLE(ObjectPrototype) };
 49 
 50 ObjectPrototype::ObjectPrototype(VM&amp; vm, Structure* stucture)
 51     : JSNonFinalObject(vm, stucture)
 52 {
 53 }
 54 
 55 void ObjectPrototype::finishCreation(VM&amp; vm, JSGlobalObject* globalObject)
 56 {
 57     Base::finishCreation(vm);
 58     ASSERT(inherits(vm, info()));
 59 
 60     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;toString, objectProtoFuncToString, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 0);
 61     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;toLocaleString, objectProtoFuncToLocaleString, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 0);
 62     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;valueOf, objectProtoFuncValueOf, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 0);
 63     JSC_NATIVE_INTRINSIC_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;hasOwnProperty, objectProtoFuncHasOwnProperty, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 1, HasOwnPropertyIntrinsic);
 64     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;propertyIsEnumerable, objectProtoFuncPropertyIsEnumerable, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 1);
 65     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;isPrototypeOf, objectProtoFuncIsPrototypeOf, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 1);
 66     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;__defineGetter__, objectProtoFuncDefineGetter, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 2);
 67     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;__defineSetter__, objectProtoFuncDefineSetter, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 2);
 68     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;__lookupGetter__, objectProtoFuncLookupGetter, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 1);
 69     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;__lookupSetter__, objectProtoFuncLookupSetter, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 1);
 70 }
 71 
 72 ObjectPrototype* ObjectPrototype::create(VM&amp; vm, JSGlobalObject* globalObject, Structure* structure)
 73 {
 74     ObjectPrototype* prototype = new (NotNull, allocateCell&lt;ObjectPrototype&gt;(vm.heap)) ObjectPrototype(vm, structure);
 75     prototype-&gt;finishCreation(vm, globalObject);
 76     return prototype;
 77 }
 78 
 79 // ------------------------------ Functions --------------------------------
 80 
<a name="2" id="anc2"></a><span class="line-modified"> 81 EncodedJSValue JSC_HOST_CALL objectProtoFuncValueOf(ExecState* exec)</span>
 82 {
<a name="3" id="anc3"></a><span class="line-modified"> 83     JSValue thisValue = exec-&gt;thisValue().toThis(exec, StrictMode);</span>
<span class="line-modified"> 84     JSObject* valueObj = thisValue.toObject(exec);</span>
 85     if (UNLIKELY(!valueObj))
 86         return encodedJSValue();
 87     return JSValue::encode(valueObj);
 88 }
 89 
<a name="4" id="anc4"></a><span class="line-modified"> 90 EncodedJSValue JSC_HOST_CALL objectProtoFuncHasOwnProperty(ExecState* exec)</span>
 91 {
<a name="5" id="anc5"></a><span class="line-modified"> 92     VM&amp; vm = exec-&gt;vm();</span>
 93     auto scope = DECLARE_THROW_SCOPE(vm);
 94 
<a name="6" id="anc6"></a><span class="line-modified"> 95     JSValue thisValue = exec-&gt;thisValue().toThis(exec, StrictMode);</span>
<span class="line-modified"> 96     auto propertyName = exec-&gt;argument(0).toPropertyKey(exec);</span>
 97     RETURN_IF_EXCEPTION(scope, encodedJSValue());
<a name="7" id="anc7"></a><span class="line-modified"> 98     JSObject* thisObject = thisValue.toObject(exec);</span>
 99     EXCEPTION_ASSERT(!!scope.exception() == !thisObject);
100     if (UNLIKELY(!thisObject))
101         return encodedJSValue();
102 
103     Structure* structure = thisObject-&gt;structure(vm);
104     HasOwnPropertyCache* hasOwnPropertyCache = vm.ensureHasOwnPropertyCache();
105     if (Optional&lt;bool&gt; result = hasOwnPropertyCache-&gt;get(structure, propertyName)) {
<a name="8" id="anc8"></a><span class="line-modified">106         ASSERT(*result == thisObject-&gt;hasOwnProperty(exec, propertyName));</span>
107         scope.assertNoException();
108         return JSValue::encode(jsBoolean(*result));
109     }
110 
111     PropertySlot slot(thisObject, PropertySlot::InternalMethodType::GetOwnProperty);
<a name="9" id="anc9"></a><span class="line-modified">112     bool result = thisObject-&gt;hasOwnProperty(exec, propertyName, slot);</span>
113     RETURN_IF_EXCEPTION(scope, encodedJSValue());
114 
115     hasOwnPropertyCache-&gt;tryAdd(vm, slot, thisObject, propertyName, result);
116     return JSValue::encode(jsBoolean(result));
117 }
118 
<a name="10" id="anc10"></a><span class="line-modified">119 EncodedJSValue JSC_HOST_CALL objectProtoFuncIsPrototypeOf(ExecState* exec)</span>
120 {
<a name="11" id="anc11"></a><span class="line-modified">121     VM&amp; vm = exec-&gt;vm();</span>
122     auto scope = DECLARE_THROW_SCOPE(vm);
123 
<a name="12" id="anc12"></a><span class="line-modified">124     JSValue thisValue = exec-&gt;thisValue().toThis(exec, StrictMode);</span>
<span class="line-modified">125     JSObject* thisObj = thisValue.toObject(exec);</span>



126     EXCEPTION_ASSERT(!!scope.exception() == !thisObj);
127     if (UNLIKELY(!thisObj))
128         return encodedJSValue();
129 
<a name="13" id="anc13"></a><span class="line-modified">130     if (!exec-&gt;argument(0).isObject())</span>
<span class="line-removed">131         return JSValue::encode(jsBoolean(false));</span>
<span class="line-removed">132 </span>
<span class="line-removed">133     JSValue v = asObject(exec-&gt;argument(0))-&gt;getPrototype(vm, exec);</span>
134     RETURN_IF_EXCEPTION(scope, encodedJSValue());
135 
136     while (true) {
137         if (!v.isObject())
138             return JSValue::encode(jsBoolean(false));
139         if (v == thisObj)
140             return JSValue::encode(jsBoolean(true));
<a name="14" id="anc14"></a><span class="line-modified">141         v = asObject(v)-&gt;getPrototype(vm, exec);</span>
142         RETURN_IF_EXCEPTION(scope, encodedJSValue());
143     }
144 }
145 
<a name="15" id="anc15"></a><span class="line-modified">146 EncodedJSValue JSC_HOST_CALL objectProtoFuncDefineGetter(ExecState* exec)</span>
147 {
<a name="16" id="anc16"></a><span class="line-modified">148     VM&amp; vm = exec-&gt;vm();</span>
149     auto scope = DECLARE_THROW_SCOPE(vm);
150 
<a name="17" id="anc17"></a><span class="line-modified">151     JSObject* thisObject = exec-&gt;thisValue().toThis(exec, StrictMode).toObject(exec);</span>
152     RETURN_IF_EXCEPTION(scope, encodedJSValue());
153 
<a name="18" id="anc18"></a><span class="line-modified">154     JSValue get = exec-&gt;argument(1);</span>
155     CallData callData;
156     if (getCallData(vm, get, callData) == CallType::None)
<a name="19" id="anc19"></a><span class="line-modified">157         return throwVMTypeError(exec, scope, &quot;invalid getter usage&quot;_s);</span>
158 
<a name="20" id="anc20"></a><span class="line-modified">159     auto propertyName = exec-&gt;argument(0).toPropertyKey(exec);</span>
160     RETURN_IF_EXCEPTION(scope, encodedJSValue());
161 
162     PropertyDescriptor descriptor;
163     descriptor.setGetter(get);
164     descriptor.setEnumerable(true);
165     descriptor.setConfigurable(true);
166 
167     bool shouldThrow = true;
168     scope.release();
<a name="21" id="anc21"></a><span class="line-modified">169     thisObject-&gt;methodTable(vm)-&gt;defineOwnProperty(thisObject, exec, propertyName, descriptor, shouldThrow);</span>
170 
171     return JSValue::encode(jsUndefined());
172 }
173 
<a name="22" id="anc22"></a><span class="line-modified">174 EncodedJSValue JSC_HOST_CALL objectProtoFuncDefineSetter(ExecState* exec)</span>
175 {
<a name="23" id="anc23"></a><span class="line-modified">176     VM&amp; vm = exec-&gt;vm();</span>
177     auto scope = DECLARE_THROW_SCOPE(vm);
178 
<a name="24" id="anc24"></a><span class="line-modified">179     JSObject* thisObject = exec-&gt;thisValue().toThis(exec, StrictMode).toObject(exec);</span>
180     RETURN_IF_EXCEPTION(scope, encodedJSValue());
181 
<a name="25" id="anc25"></a><span class="line-modified">182     JSValue set = exec-&gt;argument(1);</span>
183     CallData callData;
184     if (getCallData(vm, set, callData) == CallType::None)
<a name="26" id="anc26"></a><span class="line-modified">185         return throwVMTypeError(exec, scope, &quot;invalid setter usage&quot;_s);</span>
186 
<a name="27" id="anc27"></a><span class="line-modified">187     auto propertyName = exec-&gt;argument(0).toPropertyKey(exec);</span>
188     RETURN_IF_EXCEPTION(scope, encodedJSValue());
189 
190     PropertyDescriptor descriptor;
191     descriptor.setSetter(set);
192     descriptor.setEnumerable(true);
193     descriptor.setConfigurable(true);
194 
195     bool shouldThrow = true;
196     scope.release();
<a name="28" id="anc28"></a><span class="line-modified">197     thisObject-&gt;methodTable(vm)-&gt;defineOwnProperty(thisObject, exec, propertyName, descriptor, shouldThrow);</span>
198 
199     return JSValue::encode(jsUndefined());
200 }
201 
<a name="29" id="anc29"></a><span class="line-modified">202 EncodedJSValue JSC_HOST_CALL objectProtoFuncLookupGetter(ExecState* exec)</span>
203 {
<a name="30" id="anc30"></a><span class="line-modified">204     VM&amp; vm = exec-&gt;vm();</span>
205     auto scope = DECLARE_THROW_SCOPE(vm);
206 
<a name="31" id="anc31"></a><span class="line-modified">207     JSObject* thisObject = exec-&gt;thisValue().toThis(exec, StrictMode).toObject(exec);</span>
208     RETURN_IF_EXCEPTION(scope, encodedJSValue());
209 
<a name="32" id="anc32"></a><span class="line-modified">210     auto propertyName = exec-&gt;argument(0).toPropertyKey(exec);</span>
211     RETURN_IF_EXCEPTION(scope, encodedJSValue());
212 
213     PropertySlot slot(thisObject, PropertySlot::InternalMethodType::GetOwnProperty);
<a name="33" id="anc33"></a><span class="line-modified">214     bool hasProperty = thisObject-&gt;getPropertySlot(exec, propertyName, slot);</span>
215     EXCEPTION_ASSERT(!scope.exception() || !hasProperty);
216     if (hasProperty) {
217         if (slot.isAccessor()) {
218             GetterSetter* getterSetter = slot.getterSetter();
219             return getterSetter-&gt;isGetterNull() ? JSValue::encode(jsUndefined()) : JSValue::encode(getterSetter-&gt;getter());
220         }
221         if (slot.attributes() &amp; PropertyAttribute::CustomAccessor) {
222             PropertyDescriptor descriptor;
223             ASSERT(slot.slotBase());
<a name="34" id="anc34"></a><span class="line-modified">224             if (slot.slotBase()-&gt;getOwnPropertyDescriptor(exec, propertyName, descriptor))</span>
225                 return descriptor.getterPresent() ? JSValue::encode(descriptor.getter()) : JSValue::encode(jsUndefined());
226         }
227     }
228 
229     return JSValue::encode(jsUndefined());
230 }
231 
<a name="35" id="anc35"></a><span class="line-modified">232 EncodedJSValue JSC_HOST_CALL objectProtoFuncLookupSetter(ExecState* exec)</span>
233 {
<a name="36" id="anc36"></a><span class="line-modified">234     VM&amp; vm = exec-&gt;vm();</span>
235     auto scope = DECLARE_THROW_SCOPE(vm);
236 
<a name="37" id="anc37"></a><span class="line-modified">237     JSObject* thisObject = exec-&gt;thisValue().toThis(exec, StrictMode).toObject(exec);</span>
238     RETURN_IF_EXCEPTION(scope, encodedJSValue());
239 
<a name="38" id="anc38"></a><span class="line-modified">240     auto propertyName = exec-&gt;argument(0).toPropertyKey(exec);</span>
241     RETURN_IF_EXCEPTION(scope, encodedJSValue());
242 
243     PropertySlot slot(thisObject, PropertySlot::InternalMethodType::GetOwnProperty);
<a name="39" id="anc39"></a><span class="line-modified">244     bool hasProperty = thisObject-&gt;getPropertySlot(exec, propertyName, slot);</span>
245     EXCEPTION_ASSERT(!scope.exception() || !hasProperty);
246     if (hasProperty) {
247         if (slot.isAccessor()) {
248             GetterSetter* getterSetter = slot.getterSetter();
249             return getterSetter-&gt;isSetterNull() ? JSValue::encode(jsUndefined()) : JSValue::encode(getterSetter-&gt;setter());
250         }
251         if (slot.attributes() &amp; PropertyAttribute::CustomAccessor) {
252             PropertyDescriptor descriptor;
253             ASSERT(slot.slotBase());
<a name="40" id="anc40"></a><span class="line-modified">254             if (slot.slotBase()-&gt;getOwnPropertyDescriptor(exec, propertyName, descriptor))</span>
255                 return descriptor.setterPresent() ? JSValue::encode(descriptor.setter()) : JSValue::encode(jsUndefined());
256         }
257     }
258 
259     return JSValue::encode(jsUndefined());
260 }
261 
<a name="41" id="anc41"></a><span class="line-modified">262 EncodedJSValue JSC_HOST_CALL objectProtoFuncPropertyIsEnumerable(ExecState* exec)</span>
263 {
<a name="42" id="anc42"></a><span class="line-modified">264     VM&amp; vm = exec-&gt;vm();</span>
265     auto scope = DECLARE_THROW_SCOPE(vm);
266 
<a name="43" id="anc43"></a><span class="line-modified">267     auto propertyName = exec-&gt;argument(0).toPropertyKey(exec);</span>
268     RETURN_IF_EXCEPTION(scope, encodedJSValue());
269 
<a name="44" id="anc44"></a><span class="line-modified">270     JSObject* thisObject = exec-&gt;thisValue().toThis(exec, StrictMode).toObject(exec);</span>
271     RETURN_IF_EXCEPTION(scope, encodedJSValue());
272 
273     scope.release();
274     PropertyDescriptor descriptor;
<a name="45" id="anc45"></a><span class="line-modified">275     bool enumerable = thisObject-&gt;getOwnPropertyDescriptor(exec, propertyName, descriptor) &amp;&amp; descriptor.enumerable();</span>
276     return JSValue::encode(jsBoolean(enumerable));
277 }
278 
279 // 15.2.4.3 Object.prototype.toLocaleString()
<a name="46" id="anc46"></a><span class="line-modified">280 EncodedJSValue JSC_HOST_CALL objectProtoFuncToLocaleString(ExecState* exec)</span>
281 {
<a name="47" id="anc47"></a><span class="line-modified">282     VM&amp; vm = exec-&gt;vm();</span>
283     auto scope = DECLARE_THROW_SCOPE(vm);
284 
285     // 1. Let V be the this value.
<a name="48" id="anc48"></a><span class="line-modified">286     JSValue thisValue = exec-&gt;thisValue();</span>
287 
288     // 2. Invoke(V, &quot;toString&quot;)
289 
290     // Let O be the result of calling ToObject passing the this value as the argument.
<a name="49" id="anc49"></a><span class="line-modified">291     JSObject* object = thisValue.toThis(exec, StrictMode).toObject(exec);</span>
292     RETURN_IF_EXCEPTION(scope, encodedJSValue());
293 
294     // Let toString be the O.[[Get]](&quot;toString&quot;, V)
295     PropertySlot slot(thisValue, PropertySlot::InternalMethodType::Get);
<a name="50" id="anc50"></a><span class="line-modified">296     bool hasProperty = object-&gt;getPropertySlot(exec, vm.propertyNames-&gt;toString, slot);</span>
297     EXCEPTION_ASSERT(!scope.exception() || !hasProperty);
<a name="51" id="anc51"></a><span class="line-modified">298     JSValue toString = hasProperty ? slot.getValue(exec, vm.propertyNames-&gt;toString) : jsUndefined();</span>
299     RETURN_IF_EXCEPTION(scope, encodedJSValue());
300 
301     // If IsCallable(toString) is false, throw a TypeError exception.
302     CallData callData;
303     CallType callType = getCallData(vm, toString, callData);
304     if (callType == CallType::None)
<a name="52" id="anc52"></a><span class="line-modified">305         return throwVMTypeError(exec, scope);</span>
306 
307     // Return the result of calling the [[Call]] internal method of toString passing the this value and no arguments.
<a name="53" id="anc53"></a><span class="line-modified">308     RELEASE_AND_RETURN(scope, JSValue::encode(call(exec, toString, callType, callData, thisValue, *vm.emptyList)));</span>
309 }
310 
<a name="54" id="anc54"></a><span class="line-modified">311 EncodedJSValue JSC_HOST_CALL objectProtoFuncToString(ExecState* exec)</span>
312 {
<a name="55" id="anc55"></a><span class="line-modified">313     VM&amp; vm = exec-&gt;vm();</span>
314     auto scope = DECLARE_THROW_SCOPE(vm);
315 
<a name="56" id="anc56"></a><span class="line-modified">316     JSValue thisValue = exec-&gt;thisValue().toThis(exec, StrictMode);</span>
317     if (thisValue.isUndefinedOrNull())
318         return JSValue::encode(thisValue.isUndefined() ? vm.smallStrings.undefinedObjectString() : vm.smallStrings.nullObjectString());
<a name="57" id="anc57"></a><span class="line-modified">319     JSObject* thisObject = thisValue.toObject(exec);</span>
320     EXCEPTION_ASSERT(!!scope.exception() == !thisObject);
321     if (!thisObject)
322         return JSValue::encode(jsUndefined());
323 
324     auto result = thisObject-&gt;structure(vm)-&gt;objectToStringValue();
325     if (result)
326         return JSValue::encode(result);
327 
328     PropertyName toStringTagSymbol = vm.propertyNames-&gt;toStringTagSymbol;
<a name="58" id="anc58"></a><span class="line-modified">329     RELEASE_AND_RETURN(scope, JSValue::encode(thisObject-&gt;getPropertySlot(exec, toStringTagSymbol, [&amp;] (bool found, PropertySlot&amp; toStringTagSlot) -&gt; JSValue {</span>
330         if (found) {
<a name="59" id="anc59"></a><span class="line-modified">331             JSValue stringTag = toStringTagSlot.getValue(exec, toStringTagSymbol);</span>
332             RETURN_IF_EXCEPTION(scope, { });
333             if (stringTag.isString()) {
<a name="60" id="anc60"></a><span class="line-modified">334                 JSString* result = jsString(exec, vm.smallStrings.objectStringStart(), asString(stringTag), vm.smallStrings.singleCharacterString(&#39;]&#39;));</span>
335                 RETURN_IF_EXCEPTION(scope, { });
<a name="61" id="anc61"></a><span class="line-modified">336                 thisObject-&gt;structure(vm)-&gt;setObjectToStringValue(exec, vm, result, toStringTagSlot);</span>
337                 return result;
338             }
339         }
340 
<a name="62" id="anc62"></a><span class="line-modified">341         String tag = thisObject-&gt;methodTable(vm)-&gt;toStringName(thisObject, exec);</span>
342         RETURN_IF_EXCEPTION(scope, { });
343         String newString = tryMakeString(&quot;[object &quot;, WTFMove(tag), &quot;]&quot;);
344         if (!newString)
<a name="63" id="anc63"></a><span class="line-modified">345             return throwOutOfMemoryError(exec, scope);</span>
346 
347         auto result = jsNontrivialString(vm, newString);
<a name="64" id="anc64"></a><span class="line-modified">348         thisObject-&gt;structure(vm)-&gt;setObjectToStringValue(exec, vm, result, toStringTagSlot);</span>
349         return result;
350     })));
351 }
352 
353 } // namespace JSC
<a name="65" id="anc65"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="65" type="hidden" />
</body>
</html>