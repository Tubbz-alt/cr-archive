<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/loader/EmptyClients.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DocumentWriter.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="EmptyClients.h.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/loader/EmptyClients.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -48,13 +48,15 @@</span>
  #include &quot;Frame.h&quot;
  #include &quot;FrameLoaderClient.h&quot;
  #include &quot;FrameNetworkingContext.h&quot;
  #include &quot;HTMLFormElement.h&quot;
  #include &quot;HistoryItem.h&quot;
<span class="udiff-line-modified-removed">- #include &quot;InProcessIDBServer.h&quot;</span>
<span class="udiff-line-modified-added">+ #include &quot;IDBConnectionToServer.h&quot;</span>
  #include &quot;InspectorClient.h&quot;
  #include &quot;LibWebRTCProvider.h&quot;
<span class="udiff-line-added">+ #include &quot;MediaRecorderPrivate.h&quot;</span>
<span class="udiff-line-added">+ #include &quot;MediaRecorderProvider.h&quot;</span>
  #include &quot;NetworkStorageSession.h&quot;
  #include &quot;Page.h&quot;
  #include &quot;PageConfiguration.h&quot;
  #include &quot;PaymentCoordinatorClient.h&quot;
  #include &quot;PluginInfoProvider.h&quot;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -68,18 +70,19 @@</span>
  #include &quot;TextCheckerClient.h&quot;
  #include &quot;ThreadableWebSocketChannel.h&quot;
  #include &quot;UserContentProvider.h&quot;
  #include &quot;VisitedLinkStore.h&quot;
  #include &lt;JavaScriptCore/HeapInlines.h&gt;
<span class="udiff-line-added">+ #include &lt;pal/SessionID.h&gt;</span>
  #include &lt;wtf/NeverDestroyed.h&gt;
  
  #if ENABLE(CONTENT_EXTENSIONS)
  #include &quot;CompiledContentExtension.h&quot;
  #endif
  
  #if USE(QUICK_LOOK)
<span class="udiff-line-modified-removed">- #include &quot;PreviewLoaderClient.h&quot;</span>
<span class="udiff-line-modified-added">+ #include &quot;LegacyPreviewLoaderClient.h&quot;</span>
  #endif
  
  namespace WebCore {
  
  class UserMessageHandlerDescriptor;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -120,14 +123,46 @@</span>
  
  #endif // ENABLE(CONTEXT_MENUS)
  
  class EmptyDatabaseProvider final : public DatabaseProvider {
  #if ENABLE(INDEXED_DATABASE)
<span class="udiff-line-modified-removed">-     IDBClient::IDBConnectionToServer&amp; idbConnectionToServerForSession(const PAL::SessionID&amp; sessionID) final</span>
<span class="udiff-line-modified-added">+     struct EmptyIDBConnectionToServerDeletegate final : public IDBClient::IDBConnectionToServerDelegate {</span>
<span class="udiff-line-added">+         IDBConnectionIdentifier identifier() const final { return { }; }</span>
<span class="udiff-line-added">+         void deleteDatabase(const IDBRequestData&amp;) final { }</span>
<span class="udiff-line-added">+         void openDatabase(const IDBRequestData&amp;) final { }</span>
<span class="udiff-line-added">+         void abortTransaction(const IDBResourceIdentifier&amp;) final { }</span>
<span class="udiff-line-added">+         void commitTransaction(const IDBResourceIdentifier&amp;) final { }</span>
<span class="udiff-line-added">+         void didFinishHandlingVersionChangeTransaction(uint64_t, const IDBResourceIdentifier&amp;) final { }</span>
<span class="udiff-line-added">+         void createObjectStore(const IDBRequestData&amp;, const IDBObjectStoreInfo&amp;) final { }</span>
<span class="udiff-line-added">+         void deleteObjectStore(const IDBRequestData&amp;, const String&amp;) final { }</span>
<span class="udiff-line-added">+         void renameObjectStore(const IDBRequestData&amp;, uint64_t, const String&amp;) final { }</span>
<span class="udiff-line-added">+         void clearObjectStore(const IDBRequestData&amp;, uint64_t) final { }</span>
<span class="udiff-line-added">+         void createIndex(const IDBRequestData&amp;, const IDBIndexInfo&amp;) final { }</span>
<span class="udiff-line-added">+         void deleteIndex(const IDBRequestData&amp;, uint64_t, const String&amp;) final { }</span>
<span class="udiff-line-added">+         void renameIndex(const IDBRequestData&amp;, uint64_t, uint64_t, const String&amp;) final { }</span>
<span class="udiff-line-added">+         void putOrAdd(const IDBRequestData&amp;, const IDBKeyData&amp;, const IDBValue&amp;, const IndexedDB::ObjectStoreOverwriteMode) final { }</span>
<span class="udiff-line-added">+         void getRecord(const IDBRequestData&amp;, const IDBGetRecordData&amp;) final { }</span>
<span class="udiff-line-added">+         void getAllRecords(const IDBRequestData&amp;, const IDBGetAllRecordsData&amp;) final { }</span>
<span class="udiff-line-added">+         void getCount(const IDBRequestData&amp;, const IDBKeyRangeData&amp;) final { }</span>
<span class="udiff-line-added">+         void deleteRecord(const IDBRequestData&amp;, const IDBKeyRangeData&amp;) final { }</span>
<span class="udiff-line-added">+         void openCursor(const IDBRequestData&amp;, const IDBCursorInfo&amp;) final { }</span>
<span class="udiff-line-added">+         void iterateCursor(const IDBRequestData&amp;, const IDBIterateCursorData&amp;) final { }</span>
<span class="udiff-line-added">+         void establishTransaction(uint64_t, const IDBTransactionInfo&amp;) final { }</span>
<span class="udiff-line-added">+         void databaseConnectionPendingClose(uint64_t) final { }</span>
<span class="udiff-line-added">+         void databaseConnectionClosed(uint64_t) final { }</span>
<span class="udiff-line-added">+         void abortOpenAndUpgradeNeeded(uint64_t, const IDBResourceIdentifier&amp;) final { }</span>
<span class="udiff-line-added">+         void didFireVersionChangeEvent(uint64_t, const IDBResourceIdentifier&amp;, const IndexedDB::ConnectionClosedOnBehalfOfServer) final { }</span>
<span class="udiff-line-added">+         void openDBRequestCancelled(const IDBRequestData&amp;) final { }</span>
<span class="udiff-line-added">+         void getAllDatabaseNames(const SecurityOriginData&amp;, const SecurityOriginData&amp;, uint64_t) final { }</span>
<span class="udiff-line-added">+         ~EmptyIDBConnectionToServerDeletegate() { }</span>
<span class="udiff-line-added">+     };</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     IDBClient::IDBConnectionToServer&amp; idbConnectionToServerForSession(const PAL::SessionID&amp;) final</span>
      {
<span class="udiff-line-modified-removed">-         static auto&amp; sharedConnection = InProcessIDBServer::create(sessionID).leakRef();</span>
<span class="udiff-line-modified-removed">-         return sharedConnection.connectionToServer();</span>
<span class="udiff-line-modified-added">+         static NeverDestroyed&lt;EmptyIDBConnectionToServerDeletegate&gt; emptyDelegate;</span>
<span class="udiff-line-modified-added">+         static auto&amp; emptyConnection = IDBClient::IDBConnectionToServer::create(emptyDelegate.get()).leakRef();</span>
<span class="udiff-line-added">+         return emptyConnection;</span>
      }
  #endif
  };
  
  class EmptyDiagnosticLoggingClient final : public DiagnosticLoggingClient {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -143,11 +178,10 @@</span>
  class EmptyDragClient final : public DragClient {
      void willPerformDragDestinationAction(DragDestinationAction, const DragData&amp;) final { }
      void willPerformDragSourceAction(DragSourceAction, const IntPoint&amp;, DataTransfer&amp;) final { }
      DragSourceAction dragSourceActionMaskForPoint(const IntPoint&amp;) final { return DragSourceActionNone; }
      void startDrag(DragItem, DataTransfer&amp;, Frame&amp;) final { }
<span class="udiff-line-removed">-     void dragControllerDestroyed() final { }</span>
  };
  
  #endif // ENABLE(DRAG_SUPPORT)
  
  class EmptyEditorClient final : public EditorClient {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -213,10 +247,11 @@</span>
      void textDidChangeInTextField(Element*) final { }
      bool doTextFieldCommandFromEvent(Element*, KeyboardEvent*) final { return false; }
      void textWillBeDeletedInTextField(Element*) final { }
      void textDidChangeInTextArea(Element*) final { }
      void overflowScrollPositionChanged() final { }
<span class="udiff-line-added">+     void subFrameScrollPositionChanged() final { }</span>
  
  #if PLATFORM(IOS_FAMILY)
      void startDelayingAndCoalescingContentChangeNotifications() final { }
      void stopDelayingAndCoalescingContentChangeNotifications() final { }
      bool hasRichlyEditableSelection() final { return false; }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -264,11 +299,11 @@</span>
      void updateSpellingUIWithMisspelledWord(const String&amp;) final { }
      void showSpellingUI(bool) final { }
      bool spellingUIIsShowing() final { return false; }
  
      void willSetInputMethodState() final { }
<span class="udiff-line-modified-removed">-     void setInputMethodState(bool) final { }</span>
<span class="udiff-line-modified-added">+     void setInputMethodState(Element*) final { }</span>
  
      bool canShowFontPanel() const final { return false; }
  
      class EmptyTextCheckerClient final : public TextCheckerClient {
          bool shouldEraseMarkersAfterChangeSelection(TextCheckingType) const final { return true; }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -397,11 +432,11 @@</span>
              : m_sessionID(sessionID)
          {
          }
      private:
          Ref&lt;StorageArea&gt; storageArea(const SecurityOriginData&amp;) final { return adoptRef(*new EmptyStorageArea); }
<span class="udiff-line-modified-removed">-         Ref&lt;StorageNamespace&gt; copy(Page*) final { return adoptRef(*new EmptyStorageNamespace { m_sessionID }); }</span>
<span class="udiff-line-modified-added">+         Ref&lt;StorageNamespace&gt; copy(Page&amp;) final { return adoptRef(*new EmptyStorageNamespace { m_sessionID }); }</span>
          PAL::SessionID sessionID() const final { return m_sessionID; }
          void setSessionIDForTesting(PAL::SessionID sessionID) final { m_sessionID = sessionID; };
  
          PAL::SessionID m_sessionID;
      };
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -462,15 +497,10 @@</span>
  
  void EmptyChromeClient::showShareSheet(ShareDataWithParsedURL&amp;, CompletionHandler&lt;void(bool)&gt;&amp;&amp;)
  {
  }
  
<span class="udiff-line-removed">- PAL::SessionID EmptyFrameLoaderClient::sessionID() const</span>
<span class="udiff-line-removed">- {</span>
<span class="udiff-line-removed">-     return PAL::SessionID::defaultSessionID();</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
  void EmptyFrameLoaderClient::dispatchDecidePolicyForNewWindowAction(const NavigationAction&amp;, const ResourceRequest&amp;, FormState*, const String&amp;, PolicyCheckIdentifier, FramePolicyFunction&amp;&amp;)
  {
  }
  
  void EmptyFrameLoaderClient::dispatchDecidePolicyForNavigationAction(const NavigationAction&amp;, const ResourceRequest&amp;, const ResourceResponse&amp;, FormState*, PolicyDecisionMode, PolicyCheckIdentifier, FramePolicyFunction&amp;&amp;)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -541,23 +571,35 @@</span>
  Ref&lt;StorageNamespace&gt; EmptyStorageNamespaceProvider::createTransientLocalStorageNamespace(SecurityOrigin&amp;, unsigned, PAL::SessionID sessionID)
  {
      return adoptRef(*new EmptyStorageNamespace { sessionID });
  }
  
<span class="udiff-line-modified-removed">- class EmptyStorageSessionProvider : public StorageSessionProvider {</span>
<span class="udiff-line-modified-added">+ class EmptyStorageSessionProvider final : public StorageSessionProvider {</span>
      NetworkStorageSession* storageSession() const final { return nullptr; }
  };
  
<span class="udiff-line-modified-removed">- PageConfiguration pageConfigurationWithEmptyClients()</span>
<span class="udiff-line-modified-added">+ class EmptyMediaRecorderProvider final : public MediaRecorderProvider {</span>
<span class="udiff-line-added">+ public:</span>
<span class="udiff-line-added">+     EmptyMediaRecorderProvider() = default;</span>
<span class="udiff-line-added">+ private:</span>
<span class="udiff-line-added">+ #if ENABLE(MEDIA_STREAM) &amp;&amp; PLATFORM(COCOA)</span>
<span class="udiff-line-added">+     std::unique_ptr&lt;MediaRecorderPrivate&gt; createMediaRecorderPrivate(const MediaStreamPrivate&amp;) final { return nullptr; }</span>
<span class="udiff-line-added">+ #endif</span>
<span class="udiff-line-added">+ };</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ PageConfiguration pageConfigurationWithEmptyClients(PAL::SessionID sessionID)</span>
  {
      PageConfiguration pageConfiguration {
<span class="udiff-line-added">+         sessionID,</span>
          makeUniqueRef&lt;EmptyEditorClient&gt;(),
          SocketProvider::create(),
          LibWebRTCProvider::create(),
          CacheStorageProvider::create(),
          adoptRef(*new EmptyBackForwardClient),
<span class="udiff-line-modified-removed">-         CookieJar::create(adoptRef(*new EmptyStorageSessionProvider))</span>
<span class="udiff-line-modified-added">+         CookieJar::create(adoptRef(*new EmptyStorageSessionProvider)),</span>
<span class="udiff-line-added">+         makeUniqueRef&lt;EmptyProgressTrackerClient&gt;(),</span>
<span class="udiff-line-added">+         makeUniqueRef&lt;EmptyMediaRecorderProvider&gt;()</span>
      };
  
      static NeverDestroyed&lt;EmptyChromeClient&gt; dummyChromeClient;
      pageConfiguration.chromeClient = &amp;dummyChromeClient.get();
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -570,23 +612,19 @@</span>
      static NeverDestroyed&lt;EmptyContextMenuClient&gt; dummyContextMenuClient;
      pageConfiguration.contextMenuClient = &amp;dummyContextMenuClient.get();
  #endif
  
  #if ENABLE(DRAG_SUPPORT)
<span class="udiff-line-modified-removed">-     static NeverDestroyed&lt;EmptyDragClient&gt; dummyDragClient;</span>
<span class="udiff-line-removed">-     pageConfiguration.dragClient = &amp;dummyDragClient.get();</span>
<span class="udiff-line-modified-added">+     pageConfiguration.dragClient = makeUnique&lt;EmptyDragClient&gt;();</span>
  #endif
  
      static NeverDestroyed&lt;EmptyInspectorClient&gt; dummyInspectorClient;
      pageConfiguration.inspectorClient = &amp;dummyInspectorClient.get();
  
      static NeverDestroyed&lt;EmptyFrameLoaderClient&gt; dummyFrameLoaderClient;
      pageConfiguration.loaderClientForMainFrame = &amp;dummyFrameLoaderClient.get();
  
<span class="udiff-line-removed">-     static NeverDestroyed&lt;EmptyProgressTrackerClient&gt; dummyProgressTrackerClient;</span>
<span class="udiff-line-removed">-     pageConfiguration.progressTrackerClient = &amp;dummyProgressTrackerClient.get();</span>
<span class="udiff-line-removed">- </span>
      pageConfiguration.diagnosticLoggingClient = makeUnique&lt;EmptyDiagnosticLoggingClient&gt;();
  
      pageConfiguration.applicationCacheStorage = ApplicationCacheStorage::create({ }, { });
      pageConfiguration.databaseProvider = adoptRef(*new EmptyDatabaseProvider);
      pageConfiguration.pluginInfoProvider = adoptRef(*new EmptyPluginInfoProvider);
</pre>
<center><a href="DocumentWriter.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="EmptyClients.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>