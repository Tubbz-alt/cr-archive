<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/JavaScriptCore/generator/Options.rb</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 # Copyright (C) 2018 Apple Inc. All rights reserved.
  2 #
  3 # Redistribution and use in source and binary forms, with or without
  4 # modification, are permitted provided that the following conditions
  5 # are met:
  6 # 1. Redistributions of source code must retain the above copyright
  7 #    notice, this list of conditions and the following disclaimer.
  8 # 2. Redistributions in binary form must reproduce the above copyright
  9 #    notice, this list of conditions and the following disclaimer in the
 10 #    documentation and/or other materials provided with the distribution.
 11 #
 12 # THIS SOFTWARE IS PROVIDED BY APPLE INC. AND ITS CONTRIBUTORS ``AS IS&#39;&#39;
 13 # AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 14 # THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 15 # PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS
 16 # BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 17 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 18 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 19 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 20 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 21 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 22 # THE POSSIBILITY OF SUCH DAMAGE.
 23 
 24 require &#39;optparse&#39;
 25 
 26 $config = {
<a name="1" id="anc1"></a><span class="line-modified"> 27     bytecodes_filename: {</span>
 28         short: &quot;-b&quot;,
 29         long: &quot;--bytecodes_h FILE&quot;,
 30         desc: &quot;generate bytecodes macro .h FILE&quot;,
 31     },
<a name="2" id="anc2"></a><span class="line-modified"> 32     bytecode_structs_filename: {</span>
 33         short: &quot;-s&quot;,
 34         long: &quot;--bytecode_structs_h FILE&quot;,
 35         desc: &quot;generate bytecode structs .h FILE&quot;,
 36     },
<a name="3" id="anc3"></a><span class="line-modified"> 37     init_asm_filename: {</span>
 38         short: &quot;-a&quot;,
 39         long: &quot;--init_bytecodes_asm FILE&quot;,
 40         desc: &quot;generate ASM bytecodes init FILE&quot;,
 41     },
<a name="4" id="anc4"></a><span class="line-modified"> 42     bytecode_indices_filename: {</span>
 43         short: &quot;-i&quot;,
 44         long: &quot;--bytecode_indices_h FILE&quot;,
 45         desc: &quot;generate indices of bytecode structs .h FILE&quot;,
 46     },
<a name="5" id="anc5"></a><span class="line-added"> 47     wasm_json_filename: {</span>
<span class="line-added"> 48         long: &quot;--wasm_json FILE&quot;,</span>
<span class="line-added"> 49         desc: &quot;Path to JavaScriptCore&#39;s wasm.json file&quot;,</span>
<span class="line-added"> 50     },</span>
<span class="line-added"> 51     wasm_llint_generator_filename: {</span>
<span class="line-added"> 52         long: &quot;--wasm_llint_generator_h FILE&quot;,</span>
<span class="line-added"> 53         desc: &quot;Path to generate WasmLLIntGenerator entries from wasm.json file&quot;,</span>
<span class="line-added"> 54     },</span>
<span class="line-added"> 55     wasm_init_filename: {</span>
<span class="line-added"> 56         long: &quot;--init_wasm_llint FILE&quot;,</span>
<span class="line-added"> 57         desc: &quot;generate Wasm bytecodes init FILE&quot;,</span>
<span class="line-added"> 58     },</span>
<span class="line-added"> 59     bytecode_dumper_filename: {</span>
<span class="line-added"> 60         long: &quot;--bytecode_dumper FILE&quot;,</span>
<span class="line-added"> 61         desc: &quot;generate bytecode dumper FILE&quot;,</span>
<span class="line-added"> 62     },</span>
 63 };
 64 
 65 module Options
 66     def self.optparser(options)
 67         OptionParser.new do |opts|
 68             opts.banner = &quot;usage: #{opts.program_name} [options] &lt;bytecode-list-file&gt;&quot;
 69             $config.map do |key, option|
<a name="6" id="anc6"></a><span class="line-modified"> 70                 opts.on(*option.values) do |v|</span>
 71                     options[key] = v
 72                 end
 73             end
 74         end
 75     end
 76 
 77     def self.check(argv, options)
 78         missing = $config.keys.select{ |param| options[param].nil? }
 79         unless missing.empty?
 80             raise OptionParser::MissingArgument.new(missing.join(&#39;, &#39;))
 81         end
 82         unless argv.length == 1
 83             raise OptionParser::MissingArgument.new(&quot;&lt;bytecode-list-file&gt;&quot;)
 84         end
 85     end
 86 
 87     def self.parse(argv)
 88         options = {}
 89         parser = optparser(options)
 90 
 91         begin
 92             parser.parse!(argv)
 93             check(argv, options)
 94         rescue OptionParser::MissingArgument, OptionParser::InvalidOption
 95             puts $!.to_s
 96             puts parser
 97             exit 1
 98         end
 99 
<a name="7" id="anc7"></a><span class="line-modified">100         options[:bytecode_list] = argv[0]</span>
101         options
102     end
103 end
<a name="8" id="anc8"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="8" type="hidden" />
</body>
</html>