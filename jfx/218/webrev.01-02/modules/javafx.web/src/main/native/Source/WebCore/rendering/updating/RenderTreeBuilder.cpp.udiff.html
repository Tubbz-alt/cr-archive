<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/rendering/updating/RenderTreeBuilder.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../svg/SVGTextLayoutEngineSpacing.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="RenderTreeBuilderBlock.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/rendering/updating/RenderTreeBuilder.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -36,10 +36,11 @@</span>
  #include &quot;RenderGrid.h&quot;
  #include &quot;RenderLineBreak.h&quot;
  #include &quot;RenderMathMLFenced.h&quot;
  #include &quot;RenderMenuList.h&quot;
  #include &quot;RenderMultiColumnFlow.h&quot;
<span class="udiff-line-added">+ #include &quot;RenderMultiColumnSpannerPlaceholder.h&quot;</span>
  #include &quot;RenderRuby.h&quot;
  #include &quot;RenderRubyBase.h&quot;
  #include &quot;RenderRubyRun.h&quot;
  #include &quot;RenderSVGContainer.h&quot;
  #include &quot;RenderSVGInline.h&quot;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -61,10 +62,17 @@</span>
  #include &quot;RenderTreeBuilderMathML.h&quot;
  #include &quot;RenderTreeBuilderMultiColumn.h&quot;
  #include &quot;RenderTreeBuilderRuby.h&quot;
  #include &quot;RenderTreeBuilderSVG.h&quot;
  #include &quot;RenderTreeBuilderTable.h&quot;
<span class="udiff-line-added">+ #include &quot;RenderView.h&quot;</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ #if ENABLE(LAYOUT_FORMATTING_CONTEXT)</span>
<span class="udiff-line-added">+ #include &quot;FrameView.h&quot;</span>
<span class="udiff-line-added">+ #include &quot;FrameViewLayoutContext.h&quot;</span>
<span class="udiff-line-added">+ #include &quot;RuntimeEnabledFeatures.h&quot;</span>
<span class="udiff-line-added">+ #endif</span>
  
  namespace WebCore {
  
  RenderTreeBuilder* RenderTreeBuilder::s_current;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -183,10 +191,15 @@</span>
  
  void RenderTreeBuilder::attach(RenderElement&amp; parent, RenderPtr&lt;RenderObject&gt; child, RenderObject* beforeChild)
  {
      auto insertRecursiveIfNeeded = [&amp;](RenderElement&amp; parentCandidate) {
          if (&amp;parent == &amp;parentCandidate) {
<span class="udiff-line-added">+             // Parents inside multicols can&#39;t call internal attach directly.</span>
<span class="udiff-line-added">+             if (is&lt;RenderBlockFlow&gt;(parent) &amp;&amp; downcast&lt;RenderBlockFlow&gt;(parent).multiColumnFlow()) {</span>
<span class="udiff-line-added">+                 blockFlowBuilder().attach(downcast&lt;RenderBlockFlow&gt;(parent), WTFMove(child), beforeChild);</span>
<span class="udiff-line-added">+                 return;</span>
<span class="udiff-line-added">+             }</span>
              attachToRenderElement(parent, WTFMove(child), beforeChild);
              return;
          }
          attach(parentCandidate, WTFMove(child), beforeChild);
      };
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -194,10 +207,24 @@</span>
      ASSERT(&amp;parent.view() == &amp;m_view);
  
      if (is&lt;RenderText&gt;(beforeChild)) {
          if (auto* wrapperInline = downcast&lt;RenderText&gt;(*beforeChild).inlineWrapperForDisplayContents())
              beforeChild = wrapperInline;
<span class="udiff-line-added">+     } else if (is&lt;RenderBox&gt;(beforeChild)) {</span>
<span class="udiff-line-added">+         // Adjust the beforeChild if it happens to be a spanner and the its actual location is inside the fragmented flow.</span>
<span class="udiff-line-added">+         auto&amp; beforeChildBox = downcast&lt;RenderBox&gt;(*beforeChild);</span>
<span class="udiff-line-added">+         if (auto* enclosingFragmentedFlow = parent.enclosingFragmentedFlow()) {</span>
<span class="udiff-line-added">+             auto columnSpannerPlaceholderForBeforeChild = [&amp;]() -&gt; RenderMultiColumnSpannerPlaceholder* {</span>
<span class="udiff-line-added">+                 if (!is&lt;RenderMultiColumnFlow&gt;(enclosingFragmentedFlow))</span>
<span class="udiff-line-added">+                     return nullptr;</span>
<span class="udiff-line-added">+                 auto&amp; multiColumnFlow = downcast&lt;RenderMultiColumnFlow&gt;(*enclosingFragmentedFlow);</span>
<span class="udiff-line-added">+                 return multiColumnFlow.findColumnSpannerPlaceholder(&amp;beforeChildBox);</span>
<span class="udiff-line-added">+             };</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+             if (auto* spannerPlaceholder = columnSpannerPlaceholderForBeforeChild())</span>
<span class="udiff-line-added">+                 beforeChild = spannerPlaceholder;</span>
<span class="udiff-line-added">+         }</span>
      }
  
      if (is&lt;RenderTableRow&gt;(parent)) {
          auto&amp; parentCandidate = tableBuilder().findOrCreateParentForChild(downcast&lt;RenderTableRow&gt;(parent), *child, beforeChild);
          if (&amp;parentCandidate == &amp;parent) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -429,10 +456,17 @@</span>
          cache-&gt;childrenChanged(&amp;parent, newChild);
      if (is&lt;RenderBlockFlow&gt;(parent))
          downcast&lt;RenderBlockFlow&gt;(parent).invalidateLineLayoutPath();
      if (parent.hasOutlineAutoAncestor() || parent.outlineStyleForRepaint().outlineStyleIsAuto() == OutlineIsAuto::On)
          newChild-&gt;setHasOutlineAutoAncestor();
<span class="udiff-line-added">+ #if ENABLE(LAYOUT_FORMATTING_CONTEXT)</span>
<span class="udiff-line-added">+     if (RuntimeEnabledFeatures::sharedFeatures().layoutFormattingContextEnabled()) {</span>
<span class="udiff-line-added">+         if (parent.document().view())</span>
<span class="udiff-line-added">+             parent.document().view()-&gt;layoutContext().invalidateLayoutTreeContent();</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ #endif</span>
  }
  
  void RenderTreeBuilder::move(RenderBoxModelObject&amp; from, RenderBoxModelObject&amp; to, RenderObject&amp; child, RenderObject* beforeChild, NormalizeAfterInsertion normalizeAfterInsertion)
  {
      // We assume that callers have cleared their positioned objects list for child moves so the
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -658,10 +692,16 @@</span>
          // childBecameNonInline might have re-parented us.
          if (auto* newParent = child.parent()) {
              // We need to re-run the grid items placement if it had gained a new item.
              if (newParent != parent &amp;&amp; is&lt;RenderGrid&gt;(*newParent))
                  downcast&lt;RenderGrid&gt;(*newParent).dirtyGrid();
<span class="udiff-line-added">+             else if (auto* enclosingFragmentedFlow = newParent-&gt;enclosingFragmentedFlow()) {</span>
<span class="udiff-line-added">+                 if (is&lt;RenderMultiColumnFlow&gt;(*enclosingFragmentedFlow)) {</span>
<span class="udiff-line-added">+                     // Let the fragmented flow know that it has a new in-flow descendant.</span>
<span class="udiff-line-added">+                     multiColumnBuilder().multiColumnDescendantInserted(downcast&lt;RenderMultiColumnFlow&gt;(*enclosingFragmentedFlow), child);</span>
<span class="udiff-line-added">+                 }</span>
<span class="udiff-line-added">+             }</span>
          }
      } else {
          // An anonymous block must be made to wrap this inline.
          auto newBlock = downcast&lt;RenderBlock&gt;(*parent).createAnonymousBlock();
          auto&amp; block = *newBlock;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -846,11 +886,17 @@</span>
  
      if (!parent.renderTreeBeingDestroyed()) {
          if (AXObjectCache* cache = parent.document().existingAXObjectCache())
              cache-&gt;childrenChanged(&amp;parent);
      }
<span class="udiff-line-added">+ #if ENABLE(LAYOUT_FORMATTING_CONTEXT)</span>
<span class="udiff-line-added">+     if (RuntimeEnabledFeatures::sharedFeatures().layoutFormattingContextEnabled()) {</span>
<span class="udiff-line-added">+         if (parent.document().view())</span>
<span class="udiff-line-added">+             parent.document().view()-&gt;layoutContext().invalidateLayoutTreeContent();</span>
  
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ #endif</span>
      return childToTake;
  }
  
  void RenderTreeBuilder::attachToRenderGrid(RenderGrid&amp; parent, RenderPtr&lt;RenderObject&gt; child, RenderObject* beforeChild)
  {
</pre>
<center><a href="../svg/SVGTextLayoutEngineSpacing.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="RenderTreeBuilderBlock.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>