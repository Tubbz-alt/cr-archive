<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/WebCore/platform/text/TextFlags.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (C) 2003, 2006, 2017 Apple Inc.  All rights reserved.
  3  *
  4  * Redistribution and use in source and binary forms, with or without
  5  * modification, are permitted provided that the following conditions
  6  * are met:
  7  * 1. Redistributions of source code must retain the above copyright
  8  *    notice, this list of conditions and the following disclaimer.
  9  * 2. Redistributions in binary form must reproduce the above copyright
 10  *    notice, this list of conditions and the following disclaimer in the
 11  *    documentation and/or other materials provided with the distribution.
 12  *
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
 14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 15  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
<a name="1" id="anc1"></a><span class="line-added"> 28 #include &lt;wtf/EnumTraits.h&gt;</span>
<span class="line-added"> 29 #include &lt;wtf/Optional.h&gt;</span>
<span class="line-added"> 30 </span>
 31 namespace WebCore {
 32 
 33 enum class TextRenderingMode : uint8_t {
 34     AutoTextRendering,
 35     OptimizeSpeed,
 36     OptimizeLegibility,
 37     GeometricPrecision
 38 };
 39 
 40 enum class FontSmoothingMode : uint8_t {
 41     AutoSmoothing,
 42     NoSmoothing,
 43     Antialiased,
 44     SubpixelAntialiased
 45 };
 46 
 47 // This setting is used to provide ways of switching between multiple rendering modes that may have different
 48 // metrics. It is used to switch between CG and GDI text on Windows.
 49 enum class FontRenderingMode : uint8_t {
 50     Normal,
 51     Alternate
 52 };
 53 
 54 enum class FontOrientation : uint8_t {
 55     Horizontal,
 56     Vertical
 57 };
 58 
 59 enum class NonCJKGlyphOrientation : uint8_t {
 60     Mixed,
 61     Upright
 62 };
 63 
 64 // Here, &quot;Leading&quot; and &quot;Trailing&quot; are relevant after the line has been rearranged for bidi.
 65 // (&quot;Leading&quot; means &quot;left&quot; and &quot;Trailing&quot; means &quot;right.&quot;)
 66 enum ExpansionBehaviorFlags {
 67     ForbidTrailingExpansion = 0 &lt;&lt; 0,
 68     AllowTrailingExpansion = 1 &lt;&lt; 0,
 69     ForceTrailingExpansion = 2 &lt;&lt; 0,
 70     TrailingExpansionMask = 3 &lt;&lt; 0,
 71 
 72     ForbidLeadingExpansion = 0 &lt;&lt; 2,
 73     AllowLeadingExpansion = 1 &lt;&lt; 2,
 74     ForceLeadingExpansion = 2 &lt;&lt; 2,
 75     LeadingExpansionMask = 3 &lt;&lt; 2,
 76 
 77     DefaultExpansion = AllowTrailingExpansion | ForbidLeadingExpansion,
 78 };
 79 typedef unsigned ExpansionBehavior;
 80 
 81 enum FontSynthesisValues {
 82     FontSynthesisNone = 0x0,
 83     FontSynthesisWeight = 0x1,
 84     FontSynthesisStyle = 0x2,
 85     FontSynthesisSmallCaps = 0x4
 86 };
 87 typedef unsigned FontSynthesis;
 88 const unsigned FontSynthesisWidth = 3;
 89 
 90 enum class FontVariantLigatures : uint8_t {
 91     Normal,
 92     Yes,
 93     No
 94 };
 95 
 96 enum class FontVariantPosition : uint8_t {
 97     Normal,
 98     Subscript,
 99     Superscript
100 };
101 
102 enum class FontVariantCaps : uint8_t {
103     Normal,
104     Small,
105     AllSmall,
106     Petite,
107     AllPetite,
108     Unicase,
109     Titling
110 };
111 
112 enum class FontVariantNumericFigure : uint8_t {
113     Normal,
114     LiningNumbers,
115     OldStyleNumbers
116 };
117 
118 enum class FontVariantNumericSpacing : uint8_t {
119     Normal,
120     ProportionalNumbers,
121     TabularNumbers
122 };
123 
124 enum class FontVariantNumericFraction : uint8_t {
125     Normal,
126     DiagonalFractions,
127     StackedFractions
128 };
129 
130 enum class FontVariantNumericOrdinal : uint8_t {
131     Normal,
132     Yes
133 };
134 
135 enum class FontVariantNumericSlashedZero : uint8_t {
136     Normal,
137     Yes
138 };
139 
140 enum class FontVariantAlternates : uint8_t {
141     Normal,
142     HistoricalForms
143 };
144 
145 enum class FontVariantEastAsianVariant : uint8_t {
146     Normal,
147     Jis78,
148     Jis83,
149     Jis90,
150     Jis04,
151     Simplified,
152     Traditional
153 };
154 
155 enum class FontVariantEastAsianWidth : uint8_t {
156     Normal,
157     Full,
158     Proportional
159 };
160 
161 enum class FontVariantEastAsianRuby : uint8_t {
162     Normal,
163     Yes
164 };
165 
166 struct FontVariantSettings {
167     FontVariantSettings()
168         : commonLigatures(FontVariantLigatures::Normal)
169         , discretionaryLigatures(FontVariantLigatures::Normal)
170         , historicalLigatures(FontVariantLigatures::Normal)
171         , contextualAlternates(FontVariantLigatures::Normal)
172         , position(FontVariantPosition::Normal)
173         , caps(FontVariantCaps::Normal)
174         , numericFigure(FontVariantNumericFigure::Normal)
175         , numericSpacing(FontVariantNumericSpacing::Normal)
176         , numericFraction(FontVariantNumericFraction::Normal)
177         , numericOrdinal(FontVariantNumericOrdinal::Normal)
178         , numericSlashedZero(FontVariantNumericSlashedZero::Normal)
179         , alternates(FontVariantAlternates::Normal)
180         , eastAsianVariant(FontVariantEastAsianVariant::Normal)
181         , eastAsianWidth(FontVariantEastAsianWidth::Normal)
182         , eastAsianRuby(FontVariantEastAsianRuby::Normal)
183     {
184     }
185 
186     FontVariantSettings(
187         FontVariantLigatures commonLigatures,
188         FontVariantLigatures discretionaryLigatures,
189         FontVariantLigatures historicalLigatures,
190         FontVariantLigatures contextualAlternates,
191         FontVariantPosition position,
192         FontVariantCaps caps,
193         FontVariantNumericFigure numericFigure,
194         FontVariantNumericSpacing numericSpacing,
195         FontVariantNumericFraction numericFraction,
196         FontVariantNumericOrdinal numericOrdinal,
197         FontVariantNumericSlashedZero numericSlashedZero,
198         FontVariantAlternates alternates,
199         FontVariantEastAsianVariant eastAsianVariant,
200         FontVariantEastAsianWidth eastAsianWidth,
201         FontVariantEastAsianRuby eastAsianRuby)
202             : commonLigatures(commonLigatures)
203             , discretionaryLigatures(discretionaryLigatures)
204             , historicalLigatures(historicalLigatures)
205             , contextualAlternates(contextualAlternates)
206             , position(position)
207             , caps(caps)
208             , numericFigure(numericFigure)
209             , numericSpacing(numericSpacing)
210             , numericFraction(numericFraction)
211             , numericOrdinal(numericOrdinal)
212             , numericSlashedZero(numericSlashedZero)
213             , alternates(alternates)
214             , eastAsianVariant(eastAsianVariant)
215             , eastAsianWidth(eastAsianWidth)
216             , eastAsianRuby(eastAsianRuby)
217     {
218     }
219 
220     bool isAllNormal() const
221     {
222         return commonLigatures == FontVariantLigatures::Normal
223             &amp;&amp; discretionaryLigatures == FontVariantLigatures::Normal
224             &amp;&amp; historicalLigatures == FontVariantLigatures::Normal
225             &amp;&amp; contextualAlternates == FontVariantLigatures::Normal
226             &amp;&amp; position == FontVariantPosition::Normal
227             &amp;&amp; caps == FontVariantCaps::Normal
228             &amp;&amp; numericFigure == FontVariantNumericFigure::Normal
229             &amp;&amp; numericSpacing == FontVariantNumericSpacing::Normal
230             &amp;&amp; numericFraction == FontVariantNumericFraction::Normal
231             &amp;&amp; numericOrdinal == FontVariantNumericOrdinal::Normal
232             &amp;&amp; numericSlashedZero == FontVariantNumericSlashedZero::Normal
233             &amp;&amp; alternates == FontVariantAlternates::Normal
234             &amp;&amp; eastAsianVariant == FontVariantEastAsianVariant::Normal
235             &amp;&amp; eastAsianWidth == FontVariantEastAsianWidth::Normal
236             &amp;&amp; eastAsianRuby == FontVariantEastAsianRuby::Normal;
237     }
238 
239     bool operator==(const FontVariantSettings&amp; other) const
240     {
241         return commonLigatures == other.commonLigatures
242             &amp;&amp; discretionaryLigatures == other.discretionaryLigatures
243             &amp;&amp; historicalLigatures == other.historicalLigatures
244             &amp;&amp; contextualAlternates == other.contextualAlternates
245             &amp;&amp; position == other.position
246             &amp;&amp; caps == other.caps
247             &amp;&amp; numericFigure == other.numericFigure
248             &amp;&amp; numericSpacing == other.numericSpacing
249             &amp;&amp; numericFraction == other.numericFraction
250             &amp;&amp; numericOrdinal == other.numericOrdinal
251             &amp;&amp; numericSlashedZero == other.numericSlashedZero
252             &amp;&amp; alternates == other.alternates
253             &amp;&amp; eastAsianVariant == other.eastAsianVariant
254             &amp;&amp; eastAsianWidth == other.eastAsianWidth
255             &amp;&amp; eastAsianRuby == other.eastAsianRuby;
256     }
257 
258     bool operator!=(const FontVariantSettings&amp; other) const { return !(*this == other); }
259 
260     unsigned uniqueValue() const
261     {
262         return static_cast&lt;unsigned&gt;(commonLigatures) &lt;&lt; 26
263             | static_cast&lt;unsigned&gt;(discretionaryLigatures) &lt;&lt; 24
264             | static_cast&lt;unsigned&gt;(historicalLigatures) &lt;&lt; 22
265             | static_cast&lt;unsigned&gt;(contextualAlternates) &lt;&lt; 20
266             | static_cast&lt;unsigned&gt;(position) &lt;&lt; 18
267             | static_cast&lt;unsigned&gt;(caps) &lt;&lt; 15
268             | static_cast&lt;unsigned&gt;(numericFigure) &lt;&lt; 13
269             | static_cast&lt;unsigned&gt;(numericSpacing) &lt;&lt; 11
270             | static_cast&lt;unsigned&gt;(numericFraction) &lt;&lt; 9
271             | static_cast&lt;unsigned&gt;(numericOrdinal) &lt;&lt; 8
272             | static_cast&lt;unsigned&gt;(numericSlashedZero) &lt;&lt; 7
273             | static_cast&lt;unsigned&gt;(alternates) &lt;&lt; 6
274             | static_cast&lt;unsigned&gt;(eastAsianVariant) &lt;&lt; 3
275             | static_cast&lt;unsigned&gt;(eastAsianWidth) &lt;&lt; 1
276             | static_cast&lt;unsigned&gt;(eastAsianRuby) &lt;&lt; 0;
277     }
278 
<a name="2" id="anc2"></a><span class="line-added">279     template&lt;class Encoder&gt; void encode(Encoder&amp;) const;</span>
<span class="line-added">280     template&lt;class Decoder&gt; static Optional&lt;FontVariantSettings&gt; decode(Decoder&amp;);</span>
<span class="line-added">281 </span>
282     // FIXME: this would be much more compact with bitfields.
283     FontVariantLigatures commonLigatures;
284     FontVariantLigatures discretionaryLigatures;
285     FontVariantLigatures historicalLigatures;
286     FontVariantLigatures contextualAlternates;
287     FontVariantPosition position;
288     FontVariantCaps caps;
289     FontVariantNumericFigure numericFigure;
290     FontVariantNumericSpacing numericSpacing;
291     FontVariantNumericFraction numericFraction;
292     FontVariantNumericOrdinal numericOrdinal;
293     FontVariantNumericSlashedZero numericSlashedZero;
294     FontVariantAlternates alternates;
295     FontVariantEastAsianVariant eastAsianVariant;
296     FontVariantEastAsianWidth eastAsianWidth;
297     FontVariantEastAsianRuby eastAsianRuby;
298 };
299 
<a name="3" id="anc3"></a><span class="line-added">300 template&lt;class Encoder&gt;</span>
<span class="line-added">301 void FontVariantSettings::encode(Encoder&amp; encoder) const</span>
<span class="line-added">302 {</span>
<span class="line-added">303     encoder &lt;&lt; commonLigatures;</span>
<span class="line-added">304     encoder &lt;&lt; discretionaryLigatures;</span>
<span class="line-added">305     encoder &lt;&lt; historicalLigatures;</span>
<span class="line-added">306     encoder &lt;&lt; contextualAlternates;</span>
<span class="line-added">307     encoder &lt;&lt; position;</span>
<span class="line-added">308     encoder &lt;&lt; caps;</span>
<span class="line-added">309     encoder &lt;&lt; numericFigure;</span>
<span class="line-added">310     encoder &lt;&lt; numericSpacing;</span>
<span class="line-added">311     encoder &lt;&lt; numericFraction;</span>
<span class="line-added">312     encoder &lt;&lt; numericOrdinal;</span>
<span class="line-added">313     encoder &lt;&lt; numericSlashedZero;</span>
<span class="line-added">314     encoder &lt;&lt; alternates;</span>
<span class="line-added">315     encoder &lt;&lt; eastAsianVariant;</span>
<span class="line-added">316     encoder &lt;&lt; eastAsianWidth;</span>
<span class="line-added">317     encoder &lt;&lt; eastAsianRuby;</span>
<span class="line-added">318 }</span>
<span class="line-added">319 </span>
<span class="line-added">320 template&lt;class Decoder&gt;</span>
<span class="line-added">321 Optional&lt;FontVariantSettings&gt; FontVariantSettings::decode(Decoder&amp; decoder)</span>
<span class="line-added">322 {</span>
<span class="line-added">323     Optional&lt;FontVariantLigatures&gt; commonLigatures;</span>
<span class="line-added">324     decoder &gt;&gt; commonLigatures;</span>
<span class="line-added">325     if (!commonLigatures)</span>
<span class="line-added">326         return WTF::nullopt;</span>
<span class="line-added">327 </span>
<span class="line-added">328     Optional&lt;FontVariantLigatures&gt; discretionaryLigatures;</span>
<span class="line-added">329     decoder &gt;&gt; discretionaryLigatures;</span>
<span class="line-added">330     if (!discretionaryLigatures)</span>
<span class="line-added">331         return WTF::nullopt;</span>
<span class="line-added">332 </span>
<span class="line-added">333     Optional&lt;FontVariantLigatures&gt; historicalLigatures;</span>
<span class="line-added">334     decoder &gt;&gt; historicalLigatures;</span>
<span class="line-added">335     if (!historicalLigatures)</span>
<span class="line-added">336         return WTF::nullopt;</span>
<span class="line-added">337 </span>
<span class="line-added">338     Optional&lt;FontVariantLigatures&gt; contextualAlternates;</span>
<span class="line-added">339     decoder &gt;&gt; contextualAlternates;</span>
<span class="line-added">340     if (!contextualAlternates)</span>
<span class="line-added">341         return WTF::nullopt;</span>
<span class="line-added">342 </span>
<span class="line-added">343     Optional&lt;FontVariantPosition&gt; position;</span>
<span class="line-added">344     decoder &gt;&gt; position;</span>
<span class="line-added">345     if (!position)</span>
<span class="line-added">346         return WTF::nullopt;</span>
<span class="line-added">347 </span>
<span class="line-added">348     Optional&lt;FontVariantCaps&gt; caps;</span>
<span class="line-added">349     decoder &gt;&gt; caps;</span>
<span class="line-added">350     if (!caps)</span>
<span class="line-added">351         return WTF::nullopt;</span>
<span class="line-added">352 </span>
<span class="line-added">353     Optional&lt;FontVariantNumericFigure&gt; numericFigure;</span>
<span class="line-added">354     decoder &gt;&gt; numericFigure;</span>
<span class="line-added">355     if (!numericFigure)</span>
<span class="line-added">356         return WTF::nullopt;</span>
<span class="line-added">357 </span>
<span class="line-added">358     Optional&lt;FontVariantNumericSpacing&gt; numericSpacing;</span>
<span class="line-added">359     decoder &gt;&gt; numericSpacing;</span>
<span class="line-added">360     if (!numericSpacing)</span>
<span class="line-added">361         return WTF::nullopt;</span>
<span class="line-added">362 </span>
<span class="line-added">363     Optional&lt;FontVariantNumericFraction&gt; numericFraction;</span>
<span class="line-added">364     decoder &gt;&gt; numericFraction;</span>
<span class="line-added">365     if (!numericFraction)</span>
<span class="line-added">366         return WTF::nullopt;</span>
<span class="line-added">367 </span>
<span class="line-added">368     Optional&lt;FontVariantNumericOrdinal&gt; numericOrdinal;</span>
<span class="line-added">369     decoder &gt;&gt; numericOrdinal;</span>
<span class="line-added">370     if (!numericOrdinal)</span>
<span class="line-added">371         return WTF::nullopt;</span>
<span class="line-added">372 </span>
<span class="line-added">373     Optional&lt;FontVariantNumericSlashedZero&gt; numericSlashedZero;</span>
<span class="line-added">374     decoder &gt;&gt; numericSlashedZero;</span>
<span class="line-added">375     if (!numericSlashedZero)</span>
<span class="line-added">376         return WTF::nullopt;</span>
<span class="line-added">377 </span>
<span class="line-added">378     Optional&lt;FontVariantAlternates&gt; alternates;</span>
<span class="line-added">379     decoder &gt;&gt; alternates;</span>
<span class="line-added">380     if (!alternates)</span>
<span class="line-added">381         return WTF::nullopt;</span>
<span class="line-added">382 </span>
<span class="line-added">383     Optional&lt;FontVariantEastAsianVariant&gt; eastAsianVariant;</span>
<span class="line-added">384     decoder &gt;&gt; eastAsianVariant;</span>
<span class="line-added">385     if (!eastAsianVariant)</span>
<span class="line-added">386         return WTF::nullopt;</span>
<span class="line-added">387 </span>
<span class="line-added">388     Optional&lt;FontVariantEastAsianWidth&gt; eastAsianWidth;</span>
<span class="line-added">389     decoder &gt;&gt; eastAsianWidth;</span>
<span class="line-added">390     if (!eastAsianWidth)</span>
<span class="line-added">391         return WTF::nullopt;</span>
<span class="line-added">392 </span>
<span class="line-added">393     Optional&lt;FontVariantEastAsianRuby&gt; eastAsianRuby;</span>
<span class="line-added">394     decoder &gt;&gt; eastAsianRuby;</span>
<span class="line-added">395     if (!eastAsianRuby)</span>
<span class="line-added">396         return WTF::nullopt;</span>
<span class="line-added">397 </span>
<span class="line-added">398     return {{</span>
<span class="line-added">399         *commonLigatures,</span>
<span class="line-added">400         *discretionaryLigatures,</span>
<span class="line-added">401         *historicalLigatures,</span>
<span class="line-added">402         *contextualAlternates,</span>
<span class="line-added">403         *position,</span>
<span class="line-added">404         *caps,</span>
<span class="line-added">405         *numericFigure,</span>
<span class="line-added">406         *numericSpacing,</span>
<span class="line-added">407         *numericFraction,</span>
<span class="line-added">408         *numericOrdinal,</span>
<span class="line-added">409         *numericSlashedZero,</span>
<span class="line-added">410         *alternates,</span>
<span class="line-added">411         *eastAsianVariant,</span>
<span class="line-added">412         *eastAsianWidth,</span>
<span class="line-added">413         *eastAsianRuby</span>
<span class="line-added">414     }};</span>
<span class="line-added">415 }</span>
<span class="line-added">416 </span>
417 struct FontVariantLigaturesValues {
418     FontVariantLigaturesValues(
419         FontVariantLigatures commonLigatures,
420         FontVariantLigatures discretionaryLigatures,
421         FontVariantLigatures historicalLigatures,
422         FontVariantLigatures contextualAlternates)
423             : commonLigatures(commonLigatures)
424             , discretionaryLigatures(discretionaryLigatures)
425             , historicalLigatures(historicalLigatures)
426             , contextualAlternates(contextualAlternates)
427     {
428     }
429 
<a name="4" id="anc4"></a><span class="line-added">430     template&lt;class Encoder&gt; void encode(Encoder&amp;) const;</span>
<span class="line-added">431     template&lt;class Decoder&gt; static Optional&lt;FontVariantLigaturesValues&gt; decode(Decoder&amp;);</span>
<span class="line-added">432 </span>
433     FontVariantLigatures commonLigatures;
434     FontVariantLigatures discretionaryLigatures;
435     FontVariantLigatures historicalLigatures;
436     FontVariantLigatures contextualAlternates;
437 };
438 
<a name="5" id="anc5"></a><span class="line-added">439 template&lt;class Encoder&gt;</span>
<span class="line-added">440 void FontVariantLigaturesValues::encode(Encoder&amp; encoder) const</span>
<span class="line-added">441 {</span>
<span class="line-added">442     encoder &lt;&lt; commonLigatures;</span>
<span class="line-added">443     encoder &lt;&lt; discretionaryLigatures;</span>
<span class="line-added">444     encoder &lt;&lt; historicalLigatures;</span>
<span class="line-added">445     encoder &lt;&lt; contextualAlternates;</span>
<span class="line-added">446 }</span>
<span class="line-added">447 </span>
<span class="line-added">448 template&lt;class Decoder&gt;</span>
<span class="line-added">449 Optional&lt;FontVariantLigaturesValues&gt; FontVariantLigaturesValues::decode(Decoder&amp; decoder)</span>
<span class="line-added">450 {</span>
<span class="line-added">451     Optional&lt;FontVariantLigatures&gt; commonLigatures;</span>
<span class="line-added">452     decoder &gt;&gt; commonLigatures;</span>
<span class="line-added">453     if (!commonLigatures)</span>
<span class="line-added">454         return WTF::nullopt;</span>
<span class="line-added">455 </span>
<span class="line-added">456     Optional&lt;FontVariantLigatures&gt; discretionaryLigatures;</span>
<span class="line-added">457     decoder &gt;&gt; discretionaryLigatures;</span>
<span class="line-added">458     if (!discretionaryLigatures)</span>
<span class="line-added">459         return WTF::nullopt;</span>
<span class="line-added">460 </span>
<span class="line-added">461     Optional&lt;FontVariantLigatures&gt; historicalLigatures;</span>
<span class="line-added">462     decoder &gt;&gt; historicalLigatures;</span>
<span class="line-added">463     if (!historicalLigatures)</span>
<span class="line-added">464         return WTF::nullopt;</span>
<span class="line-added">465 </span>
<span class="line-added">466     Optional&lt;FontVariantLigatures&gt; contextualAlternates;</span>
<span class="line-added">467     decoder &gt;&gt; contextualAlternates;</span>
<span class="line-added">468     if (!contextualAlternates)</span>
<span class="line-added">469         return WTF::nullopt;</span>
<span class="line-added">470 </span>
<span class="line-added">471     return {{ *commonLigatures, *discretionaryLigatures, *historicalLigatures, *contextualAlternates }};</span>
<span class="line-added">472 }</span>
<span class="line-added">473 </span>
474 struct FontVariantNumericValues {
475     FontVariantNumericValues(
476         FontVariantNumericFigure figure,
477         FontVariantNumericSpacing spacing,
478         FontVariantNumericFraction fraction,
479         FontVariantNumericOrdinal ordinal,
480         FontVariantNumericSlashedZero slashedZero)
481             : figure(figure)
482             , spacing(spacing)
483             , fraction(fraction)
484             , ordinal(ordinal)
485             , slashedZero(slashedZero)
486     {
487     }
488 
<a name="6" id="anc6"></a><span class="line-added">489     template&lt;class Encoder&gt; void encode(Encoder&amp;) const;</span>
<span class="line-added">490     template&lt;class Decoder&gt; static Optional&lt;FontVariantNumericValues&gt; decode(Decoder&amp;);</span>
<span class="line-added">491 </span>
492     FontVariantNumericFigure figure;
493     FontVariantNumericSpacing spacing;
494     FontVariantNumericFraction fraction;
495     FontVariantNumericOrdinal ordinal;
496     FontVariantNumericSlashedZero slashedZero;
497 };
498 
<a name="7" id="anc7"></a><span class="line-added">499 template&lt;class Encoder&gt;</span>
<span class="line-added">500 void FontVariantNumericValues::encode(Encoder&amp; encoder) const</span>
<span class="line-added">501 {</span>
<span class="line-added">502     encoder &lt;&lt; figure;</span>
<span class="line-added">503     encoder &lt;&lt; spacing;</span>
<span class="line-added">504     encoder &lt;&lt; fraction;</span>
<span class="line-added">505     encoder &lt;&lt; ordinal;</span>
<span class="line-added">506     encoder &lt;&lt; slashedZero;</span>
<span class="line-added">507 }</span>
<span class="line-added">508 </span>
<span class="line-added">509 template&lt;class Decoder&gt;</span>
<span class="line-added">510 Optional&lt;FontVariantNumericValues&gt; FontVariantNumericValues::decode(Decoder&amp; decoder)</span>
<span class="line-added">511 {</span>
<span class="line-added">512     Optional&lt;FontVariantNumericFigure&gt; figure;</span>
<span class="line-added">513     decoder &gt;&gt; figure;</span>
<span class="line-added">514     if (!figure)</span>
<span class="line-added">515         return WTF::nullopt;</span>
<span class="line-added">516 </span>
<span class="line-added">517     Optional&lt;FontVariantNumericSpacing&gt; spacing;</span>
<span class="line-added">518     decoder &gt;&gt; spacing;</span>
<span class="line-added">519     if (!spacing)</span>
<span class="line-added">520         return WTF::nullopt;</span>
<span class="line-added">521 </span>
<span class="line-added">522     Optional&lt;FontVariantNumericFraction&gt; fraction;</span>
<span class="line-added">523     decoder &gt;&gt; fraction;</span>
<span class="line-added">524     if (!fraction)</span>
<span class="line-added">525         return WTF::nullopt;</span>
<span class="line-added">526 </span>
<span class="line-added">527     Optional&lt;FontVariantNumericOrdinal&gt; ordinal;</span>
<span class="line-added">528     decoder &gt;&gt; ordinal;</span>
<span class="line-added">529     if (!ordinal)</span>
<span class="line-added">530         return WTF::nullopt;</span>
<span class="line-added">531 </span>
<span class="line-added">532     Optional&lt;FontVariantNumericSlashedZero&gt; slashedZero;</span>
<span class="line-added">533     decoder &gt;&gt; slashedZero;</span>
<span class="line-added">534     if (!slashedZero)</span>
<span class="line-added">535         return WTF::nullopt;</span>
<span class="line-added">536 </span>
<span class="line-added">537     return {{ *figure, *spacing, *fraction, *ordinal, *slashedZero }};</span>
<span class="line-added">538 }</span>
<span class="line-added">539 </span>
540 struct FontVariantEastAsianValues {
541     FontVariantEastAsianValues(
542         FontVariantEastAsianVariant variant,
543         FontVariantEastAsianWidth width,
544         FontVariantEastAsianRuby ruby)
545             : variant(variant)
546             , width(width)
547             , ruby(ruby)
548     {
549     }
550 
<a name="8" id="anc8"></a><span class="line-added">551     template&lt;class Encoder&gt; void encode(Encoder&amp;) const;</span>
<span class="line-added">552     template&lt;class Decoder&gt; static Optional&lt;FontVariantEastAsianValues&gt; decode(Decoder&amp;);</span>
<span class="line-added">553 </span>
554     FontVariantEastAsianVariant variant;
555     FontVariantEastAsianWidth width;
556     FontVariantEastAsianRuby ruby;
557 };
558 
<a name="9" id="anc9"></a><span class="line-added">559 template&lt;class Encoder&gt;</span>
<span class="line-added">560 void FontVariantEastAsianValues::encode(Encoder&amp; encoder) const</span>
<span class="line-added">561 {</span>
<span class="line-added">562     encoder &lt;&lt; variant;</span>
<span class="line-added">563     encoder &lt;&lt; width;</span>
<span class="line-added">564     encoder &lt;&lt; ruby;</span>
<span class="line-added">565 }</span>
<span class="line-added">566 </span>
<span class="line-added">567 template&lt;class Decoder&gt;</span>
<span class="line-added">568 Optional&lt;FontVariantEastAsianValues&gt; FontVariantEastAsianValues::decode(Decoder&amp; decoder)</span>
<span class="line-added">569 {</span>
<span class="line-added">570     Optional&lt;FontVariantEastAsianVariant&gt; variant;</span>
<span class="line-added">571     decoder &gt;&gt; variant;</span>
<span class="line-added">572     if (!variant)</span>
<span class="line-added">573         return WTF::nullopt;</span>
<span class="line-added">574 </span>
<span class="line-added">575     Optional&lt;FontVariantEastAsianWidth&gt; width;</span>
<span class="line-added">576     decoder &gt;&gt; width;</span>
<span class="line-added">577     if (!width)</span>
<span class="line-added">578         return WTF::nullopt;</span>
<span class="line-added">579 </span>
<span class="line-added">580     Optional&lt;FontVariantEastAsianRuby&gt; ruby;</span>
<span class="line-added">581     decoder &gt;&gt; ruby;</span>
<span class="line-added">582     if (!ruby)</span>
<span class="line-added">583         return WTF::nullopt;</span>
<span class="line-added">584 </span>
<span class="line-added">585     return {{ *variant, *width, *ruby }};</span>
<span class="line-added">586 }</span>
<span class="line-added">587 </span>
588 enum class FontWidthVariant : uint8_t {
589     RegularWidth,
590     HalfWidth,
591     ThirdWidth,
592     QuarterWidth,
593     LastFontWidthVariant = QuarterWidth
594 };
595 
596 const unsigned FontWidthVariantWidth = 2;
597 
598 COMPILE_ASSERT(!(static_cast&lt;unsigned&gt;(FontWidthVariant::LastFontWidthVariant) &gt;&gt; FontWidthVariantWidth), FontWidthVariantWidth_is_correct);
599 
600 enum class FontSmallCaps : uint8_t {
601     Off = 0,
602     On = 1
603 };
604 
605 enum class Kerning : uint8_t {
606     Auto,
607     Normal,
608     NoShift
609 };
610 
611 enum class FontOpticalSizing : uint8_t {
612     Enabled,
613     Disabled
614 };
615 
616 // https://www.microsoft.com/typography/otspec/fvar.htm#VAT
617 enum class FontStyleAxis : uint8_t {
618     slnt,
619     ital
620 };
621 
622 enum class AllowUserInstalledFonts : uint8_t {
623     No,
624     Yes
625 };
626 
627 }
<a name="10" id="anc10"></a><span class="line-added">628 </span>
<span class="line-added">629 namespace WTF {</span>
<span class="line-added">630 </span>
<span class="line-added">631 template&lt;&gt; struct EnumTraits&lt;WebCore::TextRenderingMode&gt; {</span>
<span class="line-added">632     using values = EnumValues&lt;</span>
<span class="line-added">633     WebCore::TextRenderingMode,</span>
<span class="line-added">634     WebCore::TextRenderingMode::AutoTextRendering,</span>
<span class="line-added">635     WebCore::TextRenderingMode::OptimizeSpeed,</span>
<span class="line-added">636     WebCore::TextRenderingMode::OptimizeLegibility,</span>
<span class="line-added">637     WebCore::TextRenderingMode::GeometricPrecision</span>
<span class="line-added">638     &gt;;</span>
<span class="line-added">639 };</span>
<span class="line-added">640 </span>
<span class="line-added">641 template&lt;&gt; struct EnumTraits&lt;WebCore::FontSmoothingMode&gt; {</span>
<span class="line-added">642     using values = EnumValues&lt;</span>
<span class="line-added">643     WebCore::FontSmoothingMode,</span>
<span class="line-added">644     WebCore::FontSmoothingMode::AutoSmoothing,</span>
<span class="line-added">645     WebCore::FontSmoothingMode::NoSmoothing,</span>
<span class="line-added">646     WebCore::FontSmoothingMode::Antialiased,</span>
<span class="line-added">647     WebCore::FontSmoothingMode::SubpixelAntialiased,</span>
<span class="line-added">648     WebCore::FontSmoothingMode::AutoSmoothing</span>
<span class="line-added">649     &gt;;</span>
<span class="line-added">650 };</span>
<span class="line-added">651 </span>
<span class="line-added">652 template&lt;&gt; struct EnumTraits&lt;WebCore::FontRenderingMode&gt; {</span>
<span class="line-added">653     using values = EnumValues&lt;</span>
<span class="line-added">654     WebCore::FontRenderingMode,</span>
<span class="line-added">655     WebCore::FontRenderingMode::Normal,</span>
<span class="line-added">656     WebCore::FontRenderingMode::Alternate</span>
<span class="line-added">657     &gt;;</span>
<span class="line-added">658 };</span>
<span class="line-added">659 </span>
<span class="line-added">660 template&lt;&gt; struct EnumTraits&lt;WebCore::FontOrientation&gt; {</span>
<span class="line-added">661     using values = EnumValues&lt;</span>
<span class="line-added">662     WebCore::FontOrientation,</span>
<span class="line-added">663     WebCore::FontOrientation::Horizontal,</span>
<span class="line-added">664     WebCore::FontOrientation::Vertical</span>
<span class="line-added">665     &gt;;</span>
<span class="line-added">666 };</span>
<span class="line-added">667 </span>
<span class="line-added">668 template&lt;&gt; struct EnumTraits&lt;WebCore::NonCJKGlyphOrientation&gt; {</span>
<span class="line-added">669     using values = EnumValues&lt;</span>
<span class="line-added">670     WebCore::NonCJKGlyphOrientation,</span>
<span class="line-added">671     WebCore::NonCJKGlyphOrientation::Mixed,</span>
<span class="line-added">672     WebCore::NonCJKGlyphOrientation::Upright</span>
<span class="line-added">673     &gt;;</span>
<span class="line-added">674 };</span>
<span class="line-added">675 </span>
<span class="line-added">676 template&lt;&gt; struct EnumTraits&lt;WebCore::FontVariantLigatures&gt; {</span>
<span class="line-added">677     using values = EnumValues&lt;</span>
<span class="line-added">678     WebCore::FontVariantLigatures,</span>
<span class="line-added">679     WebCore::FontVariantLigatures::Normal,</span>
<span class="line-added">680     WebCore::FontVariantLigatures::Yes,</span>
<span class="line-added">681     WebCore::FontVariantLigatures::No</span>
<span class="line-added">682     &gt;;</span>
<span class="line-added">683 };</span>
<span class="line-added">684 </span>
<span class="line-added">685 template&lt;&gt; struct EnumTraits&lt;WebCore::FontVariantPosition&gt; {</span>
<span class="line-added">686     using values = EnumValues&lt;</span>
<span class="line-added">687     WebCore::FontVariantPosition,</span>
<span class="line-added">688     WebCore::FontVariantPosition::Normal,</span>
<span class="line-added">689     WebCore::FontVariantPosition::Subscript,</span>
<span class="line-added">690     WebCore::FontVariantPosition::Superscript</span>
<span class="line-added">691     &gt;;</span>
<span class="line-added">692 };</span>
<span class="line-added">693 </span>
<span class="line-added">694 template&lt;&gt; struct EnumTraits&lt;WebCore::FontVariantCaps&gt; {</span>
<span class="line-added">695     using values = EnumValues&lt;</span>
<span class="line-added">696     WebCore::FontVariantCaps,</span>
<span class="line-added">697     WebCore::FontVariantCaps::Normal,</span>
<span class="line-added">698     WebCore::FontVariantCaps::Small,</span>
<span class="line-added">699     WebCore::FontVariantCaps::AllSmall,</span>
<span class="line-added">700     WebCore::FontVariantCaps::Petite,</span>
<span class="line-added">701     WebCore::FontVariantCaps::AllPetite,</span>
<span class="line-added">702     WebCore::FontVariantCaps::Unicase,</span>
<span class="line-added">703     WebCore::FontVariantCaps::Titling</span>
<span class="line-added">704     &gt;;</span>
<span class="line-added">705 };</span>
<span class="line-added">706 </span>
<span class="line-added">707 template&lt;&gt; struct EnumTraits&lt;WebCore::FontVariantNumericFigure&gt; {</span>
<span class="line-added">708     using values = EnumValues&lt;</span>
<span class="line-added">709     WebCore::FontVariantNumericFigure,</span>
<span class="line-added">710     WebCore::FontVariantNumericFigure::Normal,</span>
<span class="line-added">711     WebCore::FontVariantNumericFigure::LiningNumbers,</span>
<span class="line-added">712     WebCore::FontVariantNumericFigure::OldStyleNumbers</span>
<span class="line-added">713     &gt;;</span>
<span class="line-added">714 };</span>
<span class="line-added">715 </span>
<span class="line-added">716 template&lt;&gt; struct EnumTraits&lt;WebCore::FontVariantNumericSpacing&gt; {</span>
<span class="line-added">717     using values = EnumValues&lt;</span>
<span class="line-added">718     WebCore::FontVariantNumericSpacing,</span>
<span class="line-added">719     WebCore::FontVariantNumericSpacing::Normal,</span>
<span class="line-added">720     WebCore::FontVariantNumericSpacing::ProportionalNumbers,</span>
<span class="line-added">721     WebCore::FontVariantNumericSpacing::TabularNumbers</span>
<span class="line-added">722     &gt;;</span>
<span class="line-added">723 };</span>
<span class="line-added">724 </span>
<span class="line-added">725 template&lt;&gt; struct EnumTraits&lt;WebCore::FontVariantNumericFraction&gt; {</span>
<span class="line-added">726     using values = EnumValues&lt;</span>
<span class="line-added">727     WebCore::FontVariantNumericFraction,</span>
<span class="line-added">728     WebCore::FontVariantNumericFraction::Normal,</span>
<span class="line-added">729     WebCore::FontVariantNumericFraction::DiagonalFractions,</span>
<span class="line-added">730     WebCore::FontVariantNumericFraction::StackedFractions</span>
<span class="line-added">731     &gt;;</span>
<span class="line-added">732 };</span>
<span class="line-added">733 </span>
<span class="line-added">734 template&lt;&gt; struct EnumTraits&lt;WebCore::FontVariantNumericOrdinal&gt; {</span>
<span class="line-added">735     using values = EnumValues&lt;</span>
<span class="line-added">736     WebCore::FontVariantNumericOrdinal,</span>
<span class="line-added">737     WebCore::FontVariantNumericOrdinal::Normal,</span>
<span class="line-added">738     WebCore::FontVariantNumericOrdinal::Yes</span>
<span class="line-added">739     &gt;;</span>
<span class="line-added">740 };</span>
<span class="line-added">741 </span>
<span class="line-added">742 template&lt;&gt; struct EnumTraits&lt;WebCore::FontVariantNumericSlashedZero&gt; {</span>
<span class="line-added">743     using values = EnumValues&lt;</span>
<span class="line-added">744     WebCore::FontVariantNumericSlashedZero,</span>
<span class="line-added">745     WebCore::FontVariantNumericSlashedZero::Normal,</span>
<span class="line-added">746     WebCore::FontVariantNumericSlashedZero::Yes</span>
<span class="line-added">747     &gt;;</span>
<span class="line-added">748 };</span>
<span class="line-added">749 </span>
<span class="line-added">750 template&lt;&gt; struct EnumTraits&lt;WebCore::FontVariantAlternates&gt; {</span>
<span class="line-added">751     using values = EnumValues&lt;</span>
<span class="line-added">752     WebCore::FontVariantAlternates,</span>
<span class="line-added">753     WebCore::FontVariantAlternates::Normal,</span>
<span class="line-added">754     WebCore::FontVariantAlternates::HistoricalForms</span>
<span class="line-added">755     &gt;;</span>
<span class="line-added">756 };</span>
<span class="line-added">757 </span>
<span class="line-added">758 template&lt;&gt; struct EnumTraits&lt;WebCore::FontVariantEastAsianVariant&gt; {</span>
<span class="line-added">759     using values = EnumValues&lt;</span>
<span class="line-added">760     WebCore::FontVariantEastAsianVariant,</span>
<span class="line-added">761     WebCore::FontVariantEastAsianVariant::Normal,</span>
<span class="line-added">762     WebCore::FontVariantEastAsianVariant::Jis78,</span>
<span class="line-added">763     WebCore::FontVariantEastAsianVariant::Jis83,</span>
<span class="line-added">764     WebCore::FontVariantEastAsianVariant::Jis90,</span>
<span class="line-added">765     WebCore::FontVariantEastAsianVariant::Jis04,</span>
<span class="line-added">766     WebCore::FontVariantEastAsianVariant::Simplified,</span>
<span class="line-added">767     WebCore::FontVariantEastAsianVariant::Traditional,</span>
<span class="line-added">768     WebCore::FontVariantEastAsianVariant::Normal</span>
<span class="line-added">769     &gt;;</span>
<span class="line-added">770 };</span>
<span class="line-added">771 </span>
<span class="line-added">772 template&lt;&gt; struct EnumTraits&lt;WebCore::FontVariantEastAsianWidth&gt; {</span>
<span class="line-added">773     using values = EnumValues&lt;</span>
<span class="line-added">774     WebCore::FontVariantEastAsianWidth,</span>
<span class="line-added">775     WebCore::FontVariantEastAsianWidth::Normal,</span>
<span class="line-added">776     WebCore::FontVariantEastAsianWidth::Full,</span>
<span class="line-added">777     WebCore::FontVariantEastAsianWidth::Proportional</span>
<span class="line-added">778     &gt;;</span>
<span class="line-added">779 };</span>
<span class="line-added">780 </span>
<span class="line-added">781 template&lt;&gt; struct EnumTraits&lt;WebCore::FontVariantEastAsianRuby&gt; {</span>
<span class="line-added">782     using values = EnumValues&lt;</span>
<span class="line-added">783     WebCore::FontVariantEastAsianRuby,</span>
<span class="line-added">784     WebCore::FontVariantEastAsianRuby::Normal,</span>
<span class="line-added">785     WebCore::FontVariantEastAsianRuby::Yes</span>
<span class="line-added">786     &gt;;</span>
<span class="line-added">787 };</span>
<span class="line-added">788 </span>
<span class="line-added">789 template&lt;&gt; struct EnumTraits&lt;WebCore::FontWidthVariant&gt; {</span>
<span class="line-added">790     using values = EnumValues&lt;</span>
<span class="line-added">791     WebCore::FontWidthVariant,</span>
<span class="line-added">792     WebCore::FontWidthVariant::RegularWidth,</span>
<span class="line-added">793     WebCore::FontWidthVariant::HalfWidth,</span>
<span class="line-added">794     WebCore::FontWidthVariant::ThirdWidth,</span>
<span class="line-added">795     WebCore::FontWidthVariant::QuarterWidth</span>
<span class="line-added">796     &gt;;</span>
<span class="line-added">797 };</span>
<span class="line-added">798 </span>
<span class="line-added">799 template&lt;&gt; struct EnumTraits&lt;WebCore::FontSmallCaps&gt; {</span>
<span class="line-added">800     using values = EnumValues&lt;</span>
<span class="line-added">801     WebCore::FontSmallCaps,</span>
<span class="line-added">802     WebCore::FontSmallCaps::Off,</span>
<span class="line-added">803     WebCore::FontSmallCaps::On</span>
<span class="line-added">804     &gt;;</span>
<span class="line-added">805 };</span>
<span class="line-added">806 </span>
<span class="line-added">807 template&lt;&gt; struct EnumTraits&lt;WebCore::Kerning&gt; {</span>
<span class="line-added">808     using values = EnumValues&lt;</span>
<span class="line-added">809     WebCore::Kerning,</span>
<span class="line-added">810     WebCore::Kerning::Auto,</span>
<span class="line-added">811     WebCore::Kerning::Normal,</span>
<span class="line-added">812     WebCore::Kerning::NoShift</span>
<span class="line-added">813     &gt;;</span>
<span class="line-added">814 };</span>
<span class="line-added">815 </span>
<span class="line-added">816 template&lt;&gt; struct EnumTraits&lt;WebCore::FontOpticalSizing&gt; {</span>
<span class="line-added">817     using values = EnumValues&lt;</span>
<span class="line-added">818     WebCore::FontOpticalSizing,</span>
<span class="line-added">819     WebCore::FontOpticalSizing::Enabled,</span>
<span class="line-added">820     WebCore::FontOpticalSizing::Disabled</span>
<span class="line-added">821     &gt;;</span>
<span class="line-added">822 };</span>
<span class="line-added">823 </span>
<span class="line-added">824 template&lt;&gt; struct EnumTraits&lt;WebCore::FontStyleAxis&gt; {</span>
<span class="line-added">825     using values = EnumValues&lt;</span>
<span class="line-added">826     WebCore::FontStyleAxis,</span>
<span class="line-added">827     WebCore::FontStyleAxis::slnt,</span>
<span class="line-added">828     WebCore::FontStyleAxis::ital</span>
<span class="line-added">829     &gt;;</span>
<span class="line-added">830 };</span>
<span class="line-added">831 </span>
<span class="line-added">832 template&lt;&gt; struct EnumTraits&lt;WebCore::AllowUserInstalledFonts&gt; {</span>
<span class="line-added">833     using values = EnumValues&lt;</span>
<span class="line-added">834     WebCore::AllowUserInstalledFonts,</span>
<span class="line-added">835     WebCore::AllowUserInstalledFonts::No,</span>
<span class="line-added">836     WebCore::AllowUserInstalledFonts::Yes</span>
<span class="line-added">837     &gt;;</span>
<span class="line-added">838 };</span>
<span class="line-added">839 </span>
<span class="line-added">840 } // namespace WTF</span>
<a name="11" id="anc11"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="11" type="hidden" />
</body>
</html>