<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/freetype/FontCacheFreeType.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../filters/SourceGraphic.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="FontCustomPlatformDataFreeType.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/freetype/FontCacheFreeType.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 270,11 ***</span>
  
      bool fixedWidth, syntheticBold, syntheticOblique;
      getFontPropertiesFromPattern(resultPattern.get(), description, fixedWidth, syntheticBold, syntheticOblique);
  
      RefPtr&lt;cairo_font_face_t&gt; fontFace = adoptRef(cairo_ft_font_face_create_for_pattern(resultPattern.get()));
<span class="line-modified">!     FontPlatformData alternateFontData(fontFace.get(), resultPattern.get(), description.computedPixelSize(), fixedWidth, syntheticBold, syntheticOblique, description.orientation());</span>
      return fontForPlatformData(alternateFontData);
  }
  
  void FontCache::platformPurgeInactiveFontData()
  {
<span class="line-new-header">--- 270,11 ---</span>
  
      bool fixedWidth, syntheticBold, syntheticOblique;
      getFontPropertiesFromPattern(resultPattern.get(), description, fixedWidth, syntheticBold, syntheticOblique);
  
      RefPtr&lt;cairo_font_face_t&gt; fontFace = adoptRef(cairo_ft_font_face_create_for_pattern(resultPattern.get()));
<span class="line-modified">!     FontPlatformData alternateFontData(fontFace.get(), WTFMove(resultPattern), description.computedPixelSize(), fixedWidth, syntheticBold, syntheticOblique, description.orientation());</span>
      return fontForPlatformData(alternateFontData);
  }
  
  void FontCache::platformPurgeInactiveFontData()
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 498,11 ***</span>
          || equalLettersIgnoringASCIICase(familyNameString, &quot;-webkit-system-ui&quot;)
  #endif
          || equalLettersIgnoringASCIICase(familyNameString, &quot;cursive&quot;);
  }
  
<span class="line-modified">! std::unique_ptr&lt;FontPlatformData&gt; FontCache::createFontPlatformData(const FontDescription&amp; fontDescription, const AtomString&amp; family, const FontFeatureSettings*, const FontVariantSettings*, FontSelectionSpecifiedCapabilities)</span>
  {
      // The CSS font matching algorithm (http://www.w3.org/TR/css3-fonts/#font-matching-algorithm)
      // says that we must find an exact match for font family, slant (italic or oblique can be used)
      // and font weight (we only match bold/non-bold here).
      RefPtr&lt;FcPattern&gt; pattern = adoptRef(FcPatternCreate());
<span class="line-new-header">--- 498,11 ---</span>
          || equalLettersIgnoringASCIICase(familyNameString, &quot;-webkit-system-ui&quot;)
  #endif
          || equalLettersIgnoringASCIICase(familyNameString, &quot;cursive&quot;);
  }
  
<span class="line-modified">! std::unique_ptr&lt;FontPlatformData&gt; FontCache::createFontPlatformData(const FontDescription&amp; fontDescription, const AtomString&amp; family, const FontFeatureSettings*, FontSelectionSpecifiedCapabilities)</span>
  {
      // The CSS font matching algorithm (http://www.w3.org/TR/css3-fonts/#font-matching-algorithm)
      // says that we must find an exact match for font family, slant (italic or oblique can be used)
      // and font weight (we only match bold/non-bold here).
      RefPtr&lt;FcPattern&gt; pattern = adoptRef(FcPatternCreate());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 577,11 ***</span>
          auto variants = buildVariationSettings(freeTypeFace, fontDescription);
          if (!variants.isEmpty())
              FcPatternAddString(resultPattern.get(), FC_FONT_VARIATIONS, reinterpret_cast&lt;const FcChar8*&gt;(variants.utf8().data()));
      }
  #endif
<span class="line-modified">!     auto platformData = makeUnique&lt;FontPlatformData&gt;(fontFace.get(), resultPattern.get(), fontDescription.computedPixelSize(), fixedWidth, syntheticBold, syntheticOblique, fontDescription.orientation());</span>
      // Verify that this font has an encoding compatible with Fontconfig. Fontconfig currently
      // supports three encodings in FcFreeTypeCharIndex: Unicode, Symbol and AppleRoman.
      // If this font doesn&#39;t have one of these three encodings, don&#39;t select it.
      if (!platformData-&gt;hasCompatibleCharmap())
          return nullptr;
<span class="line-new-header">--- 577,11 ---</span>
          auto variants = buildVariationSettings(freeTypeFace, fontDescription);
          if (!variants.isEmpty())
              FcPatternAddString(resultPattern.get(), FC_FONT_VARIATIONS, reinterpret_cast&lt;const FcChar8*&gt;(variants.utf8().data()));
      }
  #endif
<span class="line-modified">!     auto platformData = makeUnique&lt;FontPlatformData&gt;(fontFace.get(), WTFMove(resultPattern), fontDescription.computedPixelSize(), fixedWidth, syntheticBold, syntheticOblique, fontDescription.orientation());</span>
      // Verify that this font has an encoding compatible with Fontconfig. Fontconfig currently
      // supports three encodings in FcFreeTypeCharIndex: Unicode, Symbol and AppleRoman.
      // If this font doesn&#39;t have one of these three encodings, don&#39;t select it.
      if (!platformData-&gt;hasCompatibleCharmap())
          return nullptr;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 649,11 ***</span>
          builder.append(variation.key[0]);
          builder.append(variation.key[1]);
          builder.append(variation.key[2]);
          builder.append(variation.key[3]);
          builder.append(&#39;=&#39;);
<span class="line-modified">!         builder.appendFixedPrecisionNumber(variation.value);</span>
      }
      return builder.toString();
  }
  #endif // ENABLE(VARIATION_FONTS)
  
<span class="line-new-header">--- 649,11 ---</span>
          builder.append(variation.key[0]);
          builder.append(variation.key[1]);
          builder.append(variation.key[2]);
          builder.append(variation.key[3]);
          builder.append(&#39;=&#39;);
<span class="line-modified">!         builder.append(FormattedNumber::fixedPrecision(variation.value));</span>
      }
      return builder.toString();
  }
  #endif // ENABLE(VARIATION_FONTS)
  
</pre>
<center><a href="../filters/SourceGraphic.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="FontCustomPlatformDataFreeType.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>