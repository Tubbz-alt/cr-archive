<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/platform/mock/GeolocationClientMock.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../mediastream/libwebrtc/LibWebRTCProviderCocoa.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="GeolocationClientMock.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/platform/mock/GeolocationClientMock.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
103 }
104 
105 void GeolocationClientMock::asyncUpdatePermission()
106 {
107     ASSERT(m_permissionState != PermissionStateUnset);
108     if (!m_permissionTimer.isActive())
109         m_permissionTimer.startOneShot(0_s);
110 }
111 
112 void GeolocationClientMock::permissionTimerFired()
113 {
114     ASSERT(m_permissionState != PermissionStateUnset);
115     bool allowed = m_permissionState == PermissionStateAllowed;
116     GeolocationSet::iterator end = m_pendingPermission.end();
117 
118     // Once permission has been set (or denied) on a Geolocation object, there can be
119     // no further requests for permission to the mock. Consequently the callbacks
120     // which fire synchronously from Geolocation::setIsAllowed() cannot reentrantly modify
121     // m_pendingPermission.
122     for (GeolocationSet::iterator it = m_pendingPermission.begin(); it != end; ++it)
<span class="line-modified">123         (*it)-&gt;setIsAllowed(allowed);</span>
124     m_pendingPermission.clear();
125 }
126 
127 void GeolocationClientMock::reset()
128 {
129     m_lastPosition = WTF::nullopt;
130     clearError();
131     m_permissionState = PermissionStateUnset;
132 }
133 
134 void GeolocationClientMock::geolocationDestroyed()
135 {
136     ASSERT(!m_isActive);
137 }
138 
<span class="line-modified">139 void GeolocationClientMock::startUpdating()</span>
140 {
141     ASSERT(!m_isActive);

142     m_isActive = true;
143     asyncUpdateController();
144 }
145 
146 void GeolocationClientMock::stopUpdating()
147 {
148     ASSERT(m_isActive);
149     m_isActive = false;
150     m_controllerTimer.stop();
151 }
152 
153 void GeolocationClientMock::setEnableHighAccuracy(bool)
154 {
155     // FIXME: We need to add some tests regarding &quot;high accuracy&quot; mode.
156     // See https://bugs.webkit.org/show_bug.cgi?id=49438
157 }
158 
159 Optional&lt;GeolocationPositionData&gt; GeolocationClientMock::lastPosition()
160 {
161     return m_lastPosition;
</pre>
</td>
<td>
<hr />
<pre>
103 }
104 
105 void GeolocationClientMock::asyncUpdatePermission()
106 {
107     ASSERT(m_permissionState != PermissionStateUnset);
108     if (!m_permissionTimer.isActive())
109         m_permissionTimer.startOneShot(0_s);
110 }
111 
112 void GeolocationClientMock::permissionTimerFired()
113 {
114     ASSERT(m_permissionState != PermissionStateUnset);
115     bool allowed = m_permissionState == PermissionStateAllowed;
116     GeolocationSet::iterator end = m_pendingPermission.end();
117 
118     // Once permission has been set (or denied) on a Geolocation object, there can be
119     // no further requests for permission to the mock. Consequently the callbacks
120     // which fire synchronously from Geolocation::setIsAllowed() cannot reentrantly modify
121     // m_pendingPermission.
122     for (GeolocationSet::iterator it = m_pendingPermission.begin(); it != end; ++it)
<span class="line-modified">123         (*it)-&gt;setIsAllowed(allowed, { });</span>
124     m_pendingPermission.clear();
125 }
126 
127 void GeolocationClientMock::reset()
128 {
129     m_lastPosition = WTF::nullopt;
130     clearError();
131     m_permissionState = PermissionStateUnset;
132 }
133 
134 void GeolocationClientMock::geolocationDestroyed()
135 {
136     ASSERT(!m_isActive);
137 }
138 
<span class="line-modified">139 void GeolocationClientMock::startUpdating(const String&amp; authorizationToken)</span>
140 {
141     ASSERT(!m_isActive);
<span class="line-added">142     UNUSED_PARAM(authorizationToken);</span>
143     m_isActive = true;
144     asyncUpdateController();
145 }
146 
147 void GeolocationClientMock::stopUpdating()
148 {
149     ASSERT(m_isActive);
150     m_isActive = false;
151     m_controllerTimer.stop();
152 }
153 
154 void GeolocationClientMock::setEnableHighAccuracy(bool)
155 {
156     // FIXME: We need to add some tests regarding &quot;high accuracy&quot; mode.
157     // See https://bugs.webkit.org/show_bug.cgi?id=49438
158 }
159 
160 Optional&lt;GeolocationPositionData&gt; GeolocationClientMock::lastPosition()
161 {
162     return m_lastPosition;
</pre>
</td>
</tr>
</table>
<center><a href="../mediastream/libwebrtc/LibWebRTCProviderCocoa.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="GeolocationClientMock.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>