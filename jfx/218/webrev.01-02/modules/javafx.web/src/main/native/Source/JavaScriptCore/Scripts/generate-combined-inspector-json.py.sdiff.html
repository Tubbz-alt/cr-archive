<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/Scripts/generate-combined-inspector-json.py</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../PlatformJava.cmake.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="generate-js-builtins.py.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/Scripts/generate-combined-inspector-json.py</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 9 #    notice, this list of conditions and the following disclaimer.
10 # 2. Redistributions in binary form must reproduce the above copyright
11 #    notice, this list of conditions and the following disclaimer in the
12 #    documentation and/or other materials provided with the distribution.
13 #
14 # THIS SOFTWARE IS PROVIDED BY APPLE INC. AND ITS CONTRIBUTORS ``AS IS&#39;&#39;
15 # AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
16 # THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
17 # PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS
18 # BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
19 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
20 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
21 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
22 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
23 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
24 # THE POSSIBILITY OF SUCH DAMAGE.
25 
26 import glob
27 import json
28 import os

29 import sys
30 
31 if len(sys.argv) &lt; 2:
32     print(&quot;usage: %s [json files or directory of json files ...]&quot; % os.path.basename(sys.argv[0]))
33     sys.exit(1)
34 
35 files = []
36 for arg in sys.argv[1:]:
37     if not os.access(arg, os.F_OK):
38         raise Exception(&quot;File \&quot;%s\&quot; not found&quot; % arg)
39     elif os.path.isdir(arg):
40         files.extend(glob.glob(os.path.join(arg, &quot;*.json&quot;)))
41     else:
42         files.append(arg)
43 files.sort()
44 
45 # To keep as close to the original JSON formatting as possible, just
46 # dump each JSON input file unmodified into an array of &quot;domains&quot;.
47 # Validate each file is valid JSON and that there is a &quot;domain&quot; key.
48 
49 first = True
50 print(&quot;{\&quot;domains\&quot;:[&quot;)
51 for file in files:
52     if first:
53         first = False
54     else:
55         print(&quot;,&quot;)
56 
57     string = open(file).read()
58 
59     try:
<span class="line-modified">60         dictionary = json.loads(string)</span>

61         if not &quot;domain&quot; in dictionary:
62             raise Exception(&quot;File \&quot;%s\&quot; does not contains a \&quot;domain\&quot; key.&quot; % file)
63     except ValueError:
64         sys.stderr.write(&quot;File \&quot;%s\&quot; does not contain valid JSON:\n&quot; % file)
65         raise
66 
67     print(string.rstrip())
68 print(&quot;]}&quot;)
69 
</pre>
</td>
<td>
<hr />
<pre>
 9 #    notice, this list of conditions and the following disclaimer.
10 # 2. Redistributions in binary form must reproduce the above copyright
11 #    notice, this list of conditions and the following disclaimer in the
12 #    documentation and/or other materials provided with the distribution.
13 #
14 # THIS SOFTWARE IS PROVIDED BY APPLE INC. AND ITS CONTRIBUTORS ``AS IS&#39;&#39;
15 # AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
16 # THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
17 # PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS
18 # BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
19 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
20 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
21 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
22 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
23 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
24 # THE POSSIBILITY OF SUCH DAMAGE.
25 
26 import glob
27 import json
28 import os
<span class="line-added">29 import re</span>
30 import sys
31 
32 if len(sys.argv) &lt; 2:
33     print(&quot;usage: %s [json files or directory of json files ...]&quot; % os.path.basename(sys.argv[0]))
34     sys.exit(1)
35 
36 files = []
37 for arg in sys.argv[1:]:
38     if not os.access(arg, os.F_OK):
39         raise Exception(&quot;File \&quot;%s\&quot; not found&quot; % arg)
40     elif os.path.isdir(arg):
41         files.extend(glob.glob(os.path.join(arg, &quot;*.json&quot;)))
42     else:
43         files.append(arg)
44 files.sort()
45 
46 # To keep as close to the original JSON formatting as possible, just
47 # dump each JSON input file unmodified into an array of &quot;domains&quot;.
48 # Validate each file is valid JSON and that there is a &quot;domain&quot; key.
49 
50 first = True
51 print(&quot;{\&quot;domains\&quot;:[&quot;)
52 for file in files:
53     if first:
54         first = False
55     else:
56         print(&quot;,&quot;)
57 
58     string = open(file).read()
59 
60     try:
<span class="line-modified">61         regex = re.compile(r&quot;\/\*.*?\*\/&quot;, re.DOTALL)</span>
<span class="line-added">62         dictionary = json.loads(re.sub(regex, &quot;&quot;, string))</span>
63         if not &quot;domain&quot; in dictionary:
64             raise Exception(&quot;File \&quot;%s\&quot; does not contains a \&quot;domain\&quot; key.&quot; % file)
65     except ValueError:
66         sys.stderr.write(&quot;File \&quot;%s\&quot; does not contain valid JSON:\n&quot; % file)
67         raise
68 
69     print(string.rstrip())
70 print(&quot;]}&quot;)
71 
</pre>
</td>
</tr>
</table>
<center><a href="../PlatformJava.cmake.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="generate-js-builtins.py.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>