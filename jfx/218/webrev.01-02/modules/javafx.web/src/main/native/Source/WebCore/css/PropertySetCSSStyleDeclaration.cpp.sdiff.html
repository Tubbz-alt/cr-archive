<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/css/PropertySetCSSStyleDeclaration.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MediaQueryMatcher.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SVGCSSComputedStyleDeclaration.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/css/PropertySetCSSStyleDeclaration.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
235 
236     CSSPropertyID propertyID = cssPropertyID(propertyName);
237     if (isCustomPropertyName(propertyName))
238         propertyID = CSSPropertyCustom;
239     if (!propertyID)
240         return { };
241 
242     if (!willMutate())
243         return { };
244 
245     bool important = equalIgnoringASCIICase(priority, &quot;important&quot;);
246     if (!important &amp;&amp; !priority.isEmpty())
247         return { };
248 
249     bool changed;
250     if (UNLIKELY(propertyID == CSSPropertyCustom)) {
251         Document* document = nullptr;
252 
253         if (parentElement())
254             document = &amp;parentElement()-&gt;document();
<span class="line-modified">255         else</span>
256             document = parentStyleSheet()-&gt;ownerDocument();
257 
258         changed = m_propertySet-&gt;setCustomProperty(document, propertyName, value, important, cssParserContext());
259     } else
260         changed = m_propertySet-&gt;setProperty(propertyID, value, important, cssParserContext());
261 
262     didMutate(changed ? PropertyChanged : NoChanges);
263 
264     if (changed) {
265         // CSS DOM requires raising SyntaxError of parsing failed, but this is too dangerous for compatibility,
266         // see &lt;http://bugs.webkit.org/show_bug.cgi?id=7296&gt;.
267         mutationScope.enqueueMutationRecord();
268     }
269 
270     return { };
271 }
272 
273 ExceptionOr&lt;String&gt; PropertySetCSSStyleDeclaration::removeProperty(const String&amp; propertyName)
274 {
275     StyleAttributeMutationScope mutationScope(this);
</pre>
<hr />
<pre>
395     ASSERT(m_parentRule-&gt;parentStyleSheet());
396 
397     if (type == PropertyChanged)
398         m_cssomValueWrappers = nullptr;
399 
400     // Style sheet mutation needs to be signaled even if the change failed. willMutate*/didMutate* must pair.
401     m_parentRule-&gt;parentStyleSheet()-&gt;didMutateRuleFromCSSStyleDeclaration();
402 }
403 
404 CSSStyleSheet* StyleRuleCSSStyleDeclaration::parentStyleSheet() const
405 {
406     return m_parentRule ? m_parentRule-&gt;parentStyleSheet() : nullptr;
407 }
408 
409 CSSParserContext StyleRuleCSSStyleDeclaration::cssParserContext() const
410 {
411     auto* styleSheet = contextStyleSheet();
412     if (!styleSheet)
413         return PropertySetCSSStyleDeclaration::cssParserContext();
414 
<span class="line-modified">415     return styleSheet-&gt;parserContext();</span>




416 }
417 
418 void StyleRuleCSSStyleDeclaration::reattach(MutableStyleProperties&amp; propertySet)
419 {
420     m_propertySet-&gt;deref();
421     m_propertySet = &amp;propertySet;
422     m_propertySet-&gt;ref();
423 }
424 
425 bool InlineCSSStyleDeclaration::willMutate()
426 {
427     if (m_parentElement)
428         InspectorInstrumentation::willInvalidateStyleAttr(*m_parentElement);
429     return true;
430 }
431 
432 void InlineCSSStyleDeclaration::didMutate(MutationType type)
433 {
434     if (type == NoChanges)
435         return;
</pre>
</td>
<td>
<hr />
<pre>
235 
236     CSSPropertyID propertyID = cssPropertyID(propertyName);
237     if (isCustomPropertyName(propertyName))
238         propertyID = CSSPropertyCustom;
239     if (!propertyID)
240         return { };
241 
242     if (!willMutate())
243         return { };
244 
245     bool important = equalIgnoringASCIICase(priority, &quot;important&quot;);
246     if (!important &amp;&amp; !priority.isEmpty())
247         return { };
248 
249     bool changed;
250     if (UNLIKELY(propertyID == CSSPropertyCustom)) {
251         Document* document = nullptr;
252 
253         if (parentElement())
254             document = &amp;parentElement()-&gt;document();
<span class="line-modified">255         else if (parentStyleSheet())</span>
256             document = parentStyleSheet()-&gt;ownerDocument();
257 
258         changed = m_propertySet-&gt;setCustomProperty(document, propertyName, value, important, cssParserContext());
259     } else
260         changed = m_propertySet-&gt;setProperty(propertyID, value, important, cssParserContext());
261 
262     didMutate(changed ? PropertyChanged : NoChanges);
263 
264     if (changed) {
265         // CSS DOM requires raising SyntaxError of parsing failed, but this is too dangerous for compatibility,
266         // see &lt;http://bugs.webkit.org/show_bug.cgi?id=7296&gt;.
267         mutationScope.enqueueMutationRecord();
268     }
269 
270     return { };
271 }
272 
273 ExceptionOr&lt;String&gt; PropertySetCSSStyleDeclaration::removeProperty(const String&amp; propertyName)
274 {
275     StyleAttributeMutationScope mutationScope(this);
</pre>
<hr />
<pre>
395     ASSERT(m_parentRule-&gt;parentStyleSheet());
396 
397     if (type == PropertyChanged)
398         m_cssomValueWrappers = nullptr;
399 
400     // Style sheet mutation needs to be signaled even if the change failed. willMutate*/didMutate* must pair.
401     m_parentRule-&gt;parentStyleSheet()-&gt;didMutateRuleFromCSSStyleDeclaration();
402 }
403 
404 CSSStyleSheet* StyleRuleCSSStyleDeclaration::parentStyleSheet() const
405 {
406     return m_parentRule ? m_parentRule-&gt;parentStyleSheet() : nullptr;
407 }
408 
409 CSSParserContext StyleRuleCSSStyleDeclaration::cssParserContext() const
410 {
411     auto* styleSheet = contextStyleSheet();
412     if (!styleSheet)
413         return PropertySetCSSStyleDeclaration::cssParserContext();
414 
<span class="line-modified">415     auto context = styleSheet-&gt;parserContext();</span>
<span class="line-added">416     if (m_parentRule)</span>
<span class="line-added">417         context.enclosingRuleType = static_cast&lt;StyleRuleType&gt;(m_parentRule-&gt;type());</span>
<span class="line-added">418 </span>
<span class="line-added">419     return context;</span>
420 }
421 
422 void StyleRuleCSSStyleDeclaration::reattach(MutableStyleProperties&amp; propertySet)
423 {
424     m_propertySet-&gt;deref();
425     m_propertySet = &amp;propertySet;
426     m_propertySet-&gt;ref();
427 }
428 
429 bool InlineCSSStyleDeclaration::willMutate()
430 {
431     if (m_parentElement)
432         InspectorInstrumentation::willInvalidateStyleAttr(*m_parentElement);
433     return true;
434 }
435 
436 void InlineCSSStyleDeclaration::didMutate(MutationType type)
437 {
438     if (type == NoChanges)
439         return;
</pre>
</td>
</tr>
</table>
<center><a href="MediaQueryMatcher.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SVGCSSComputedStyleDeclaration.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>