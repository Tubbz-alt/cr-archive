<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/testing/Internals.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Internals.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="Internals.idl.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/testing/Internals.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 14  *
 15  * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS &quot;AS IS&quot; AND ANY
 16  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 17  * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 18  * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
 19  * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 20  * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 21  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 22  * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 23  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 24  * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 25  */
 26 
 27 #pragma once
 28 
 29 #include &quot;CSSComputedStyleDeclaration.h&quot;
 30 #include &quot;ContextDestructionObserver.h&quot;
 31 #include &quot;Cookie.h&quot;
 32 #include &quot;ExceptionOr.h&quot;
 33 #include &quot;HEVCUtilities.h&quot;
<span class="line-modified"> 34 #include &quot;JSDOMPromiseDeferred.h&quot;</span>
 35 #include &quot;OrientationNotifier.h&quot;
 36 #include &quot;PageConsoleClient.h&quot;
 37 #include &quot;RealtimeMediaSource.h&quot;
 38 #include &quot;TextIndicator.h&quot;
 39 #include &lt;JavaScriptCore/Float32Array.h&gt;
 40 #include &lt;wtf/Optional.h&gt;
 41 
 42 #if ENABLE(MEDIA_SESSION)
 43 #include &quot;MediaSessionInterruptionProvider.h&quot;
 44 #endif
 45 
 46 #if ENABLE(VIDEO)
 47 #include &quot;MediaElementSession.h&quot;
 48 #endif
 49 
 50 namespace WebCore {
 51 
 52 class AnimationTimeline;
 53 class AudioContext;
 54 class CacheStorageConnection;
 55 class DOMRect;
 56 class DOMRectList;
 57 class DOMRectReadOnly;
 58 class DOMURL;
 59 class DOMWindow;
 60 class Document;
 61 class Element;
 62 class EventListener;
 63 class ExtendableEvent;
 64 class FetchResponse;
 65 class File;
 66 class Frame;
 67 class GCObservation;
 68 class HTMLAnchorElement;
 69 class HTMLImageElement;
 70 class HTMLInputElement;
 71 class HTMLLinkElement;
 72 class HTMLMediaElement;
 73 class HTMLPictureElement;
 74 class HTMLSelectElement;

 75 class ImageData;
 76 class InspectorStubFrontend;

 77 class InternalSettings;


 78 class MallocStatistics;
 79 class MediaSession;
 80 class MediaStream;
 81 class MediaStreamTrack;
 82 class MemoryInfo;
 83 class MockCDMFactory;
 84 class MockContentFilterSettings;
 85 class MockPageOverlay;
 86 class MockPaymentCoordinator;
 87 class NodeList;
 88 class Page;
 89 class RTCPeerConnection;
 90 class Range;
 91 class RenderedDocumentMarker;
 92 class SVGSVGElement;
 93 class SerializedScriptValue;
 94 class SourceBuffer;
 95 class StringCallback;
 96 class StyleSheet;
 97 class TimeRanges;
 98 class TypeConversions;

 99 class VoidCallback;
100 class WebGLRenderingContext;

101 class XMLHttpRequest;
102 
103 #if ENABLE(VIDEO_TRACK)
104 class TextTrackCueGeneric;
105 #endif
106 
107 #if ENABLE(SERVICE_WORKER)
108 class ServiceWorker;
109 #endif
110 




111 class Internals final : public RefCounted&lt;Internals&gt;, private ContextDestructionObserver
112 #if ENABLE(MEDIA_STREAM)
113     , private RealtimeMediaSource::Observer
114 #endif
115     {
116 public:
117     static Ref&lt;Internals&gt; create(Document&amp;);
118     virtual ~Internals();
119 
120     static void resetToConsistentState(Page&amp;);
121 
122     ExceptionOr&lt;String&gt; elementRenderTreeAsText(Element&amp;);
123     bool hasPausedImageAnimations(Element&amp;);
124 
125     bool isPaintingFrequently(Element&amp;);
126     void incrementFrequentPaintCounter(Element&amp;);
127 
128     String address(Node&amp;);
129     bool nodeNeedsStyleRecalc(Node&amp;);
130     String styleChangeType(Node&amp;);
</pre>
<hr />
<pre>
146     void clearMemoryCache();
147     void pruneMemoryCacheToSize(unsigned size);
148     void destroyDecodedDataForAllImages();
149     unsigned memoryCacheSize() const;
150 
151     unsigned imageFrameIndex(HTMLImageElement&amp;);
152     unsigned imageFrameCount(HTMLImageElement&amp;);
153     float imageFrameDurationAtIndex(HTMLImageElement&amp;, unsigned index);
154     void setImageFrameDecodingDuration(HTMLImageElement&amp;, float duration);
155     void resetImageAnimation(HTMLImageElement&amp;);
156     bool isImageAnimating(HTMLImageElement&amp;);
157     unsigned imagePendingDecodePromisesCountForTesting(HTMLImageElement&amp;);
158     void setClearDecoderAfterAsyncFrameRequestForTesting(HTMLImageElement&amp;, bool enabled);
159     unsigned imageDecodeCount(HTMLImageElement&amp;);
160     unsigned pdfDocumentCachingCount(HTMLImageElement&amp;);
161     void setLargeImageAsyncDecodingEnabledForTesting(HTMLImageElement&amp;, bool enabled);
162     void setForceUpdateImageDataEnabledForTesting(HTMLImageElement&amp;, bool enabled);
163 
164     void setGridMaxTracksLimit(unsigned);
165 
<span class="line-modified">166     void clearPageCache();</span>
<span class="line-modified">167     unsigned pageCacheSize() const;</span>

168 
169     void disableTileSizeUpdateDelay();
170 
171     void setSpeculativeTilingDelayDisabledForTesting(bool);
172 
173     Ref&lt;CSSComputedStyleDeclaration&gt; computedStyleIncludingVisitedInfo(Element&amp;) const;
174 
175     Node* ensureUserAgentShadowRoot(Element&amp; host);
176     Node* shadowRoot(Element&amp; host);
177     ExceptionOr&lt;String&gt; shadowRootType(const Node&amp;) const;
178     String shadowPseudoId(Element&amp;);
179     void setShadowPseudoId(Element&amp;, const String&amp;);
180 
181     // CSS Deferred Parsing Testing
182     unsigned deferredStyleRulesCount(StyleSheet&amp;);
183     unsigned deferredGroupRulesCount(StyleSheet&amp;);
184     unsigned deferredKeyframesRulesCount(StyleSheet&amp;);
185 
186     // DOMTimers throttling testing.
187     ExceptionOr&lt;bool&gt; isTimerThrottled(int timeoutId);
</pre>
<hr />
<pre>
208 
209     // CSS Transition testing.
210     ExceptionOr&lt;bool&gt; pauseTransitionAtTimeOnElement(const String&amp; propertyName, double pauseTime, Element&amp;);
211     ExceptionOr&lt;bool&gt; pauseTransitionAtTimeOnPseudoElement(const String&amp; property, double pauseTime, Element&amp;, const String&amp; pseudoId);
212 
213     // Web Animations testing.
214     struct AcceleratedAnimation {
215         String property;
216         double speed;
217     };
218     Vector&lt;AcceleratedAnimation&gt; acceleratedAnimationsForElement(Element&amp;);
219     unsigned numberOfAnimationTimelineInvalidations() const;
220 
221     // For animations testing, we need a way to get at pseudo elements.
222     ExceptionOr&lt;RefPtr&lt;Element&gt;&gt; pseudoElement(Element&amp;, const String&amp;);
223 
224     Node* treeScopeRootNode(Node&amp;);
225     Node* parentTreeScope(Node&amp;);
226 
227     String visiblePlaceholder(Element&amp;);


228     void selectColorInColorChooser(HTMLInputElement&amp;, const String&amp; colorValue);
229     ExceptionOr&lt;Vector&lt;String&gt;&gt; formControlStateOfPreviousHistoryItem();
230     ExceptionOr&lt;void&gt; setFormControlStateOfPreviousHistoryItem(const Vector&lt;String&gt;&amp;);
231 
232     ExceptionOr&lt;Ref&lt;DOMRect&gt;&gt; absoluteCaretBounds();
233     ExceptionOr&lt;bool&gt; isCaretBlinkingSuspended();
234 
235     Ref&lt;DOMRect&gt; boundingBox(Element&amp;);
236 
237     ExceptionOr&lt;Ref&lt;DOMRectList&gt;&gt; inspectorHighlightRects();
238 
239     ExceptionOr&lt;unsigned&gt; markerCountForNode(Node&amp;, const String&amp;);
240     ExceptionOr&lt;RefPtr&lt;Range&gt;&gt; markerRangeForNode(Node&amp;, const String&amp; markerType, unsigned index);
241     ExceptionOr&lt;String&gt; markerDescriptionForNode(Node&amp;, const String&amp; markerType, unsigned index);
242     ExceptionOr&lt;String&gt; dumpMarkerRects(const String&amp; markerType);
243     void addTextMatchMarker(const Range&amp;, bool isActive);
244     ExceptionOr&lt;void&gt; setMarkedTextMatchesAreHighlighted(bool);
245 
246     void invalidateFontCache();
247     void setFontSmoothingEnabled(bool);
</pre>
<hr />
<pre>
280     RefPtr&lt;Range&gt; rangeFromLocationAndLength(Element&amp; scope, int rangeLocation, int rangeLength);
281     unsigned locationFromRange(Element&amp; scope, const Range&amp;);
282     unsigned lengthFromRange(Element&amp; scope, const Range&amp;);
283     String rangeAsText(const Range&amp;);
284     String rangeAsTextUsingBackwardsTextIterator(const Range&amp;);
285     Ref&lt;Range&gt; subrange(Range&amp;, int rangeLocation, int rangeLength);
286     ExceptionOr&lt;RefPtr&lt;Range&gt;&gt; rangeForDictionaryLookupAtLocation(int x, int y);
287     RefPtr&lt;Range&gt; rangeOfStringNearLocation(const Range&amp;, const String&amp;, unsigned);
288 
289     ExceptionOr&lt;void&gt; setDelegatesScrolling(bool enabled);
290 
291     ExceptionOr&lt;int&gt; lastSpellCheckRequestSequence();
292     ExceptionOr&lt;int&gt; lastSpellCheckProcessedSequence();
293 
294     Vector&lt;String&gt; userPreferredLanguages() const;
295     void setUserPreferredLanguages(const Vector&lt;String&gt;&amp;);
296 
297     Vector&lt;String&gt; userPreferredAudioCharacteristics() const;
298     void setUserPreferredAudioCharacteristic(const String&amp;);
299 


300     ExceptionOr&lt;unsigned&gt; wheelEventHandlerCount();
301     ExceptionOr&lt;unsigned&gt; touchEventHandlerCount();
302 
303     ExceptionOr&lt;Ref&lt;DOMRectList&gt;&gt; touchEventRectsForEvent(const String&amp;);
304     ExceptionOr&lt;Ref&lt;DOMRectList&gt;&gt; passiveTouchEventListenerRects();
305 
306     ExceptionOr&lt;RefPtr&lt;NodeList&gt;&gt; nodesFromRect(Document&amp;, int x, int y, unsigned topPadding, unsigned rightPadding, unsigned bottomPadding, unsigned leftPadding, bool ignoreClipping, bool allowUserAgentShadowContent, bool allowChildFrameContent) const;
307 
308     String parserMetaData(JSC::JSValue = JSC::JSValue::JSUndefined);
309 
310     void updateEditorUINowIfScheduled();
311 
312     bool sentenceRetroCorrectionEnabled() const
313     {
314 #if PLATFORM(MAC) &amp;&amp; __MAC_OS_X_VERSION_MIN_REQUIRED &gt;= 101400
315         return true;
316 #else
317         return false;
318 #endif
319     }
</pre>
<hr />
<pre>
345 
346     static const char* internalsId;
347 
348     InternalSettings* settings() const;
349     unsigned workerThreadCount() const;
350     ExceptionOr&lt;bool&gt; areSVGAnimationsPaused() const;
351     ExceptionOr&lt;double&gt; svgAnimationsInterval(SVGSVGElement&amp;) const;
352 
353     enum {
354         // Values need to be kept in sync with Internals.idl.
355         LAYER_TREE_INCLUDES_VISIBLE_RECTS = 1,
356         LAYER_TREE_INCLUDES_TILE_CACHES = 2,
357         LAYER_TREE_INCLUDES_REPAINT_RECTS = 4,
358         LAYER_TREE_INCLUDES_PAINTING_PHASES = 8,
359         LAYER_TREE_INCLUDES_CONTENT_LAYERS = 16,
360         LAYER_TREE_INCLUDES_ACCELERATES_DRAWING = 32,
361         LAYER_TREE_INCLUDES_CLIPPING = 64,
362         LAYER_TREE_INCLUDES_BACKING_STORE_ATTACHED = 128,
363         LAYER_TREE_INCLUDES_ROOT_LAYER_PROPERTIES = 256,
364         LAYER_TREE_INCLUDES_EVENT_REGION = 512,

365     };
366     ExceptionOr&lt;String&gt; layerTreeAsText(Document&amp;, unsigned short flags) const;
367     ExceptionOr&lt;uint64_t&gt; layerIDForElement(Element&amp;);
368     ExceptionOr&lt;String&gt; repaintRectsAsText() const;
369 
370     ExceptionOr&lt;String&gt; scrollbarOverlayStyle(Node*) const;
371     ExceptionOr&lt;bool&gt; scrollbarUsingDarkAppearance(Node*) const;
372 
373     ExceptionOr&lt;String&gt; scrollingStateTreeAsText() const;
374     ExceptionOr&lt;String&gt; mainThreadScrollingReasons() const;
375     ExceptionOr&lt;Ref&lt;DOMRectList&gt;&gt; nonFastScrollableRects() const;
376 
377     ExceptionOr&lt;void&gt; setElementUsesDisplayListDrawing(Element&amp;, bool usesDisplayListDrawing);
378     ExceptionOr&lt;void&gt; setElementTracksDisplayListReplay(Element&amp;, bool isTrackingReplay);
379 
380     enum {
381         // Values need to be kept in sync with Internals.idl.
382         DISPLAY_LIST_INCLUDES_PLATFORM_OPERATIONS = 1,
383     };
384     ExceptionOr&lt;String&gt; displayListForElement(Element&amp;, unsigned short flags);
</pre>
<hr />
<pre>
391     bool isUnderMemoryPressure();
392 
393     ExceptionOr&lt;void&gt; insertAuthorCSS(const String&amp;) const;
394     ExceptionOr&lt;void&gt; insertUserCSS(const String&amp;) const;
395 
396 #if ENABLE(INDEXED_DATABASE)
397     unsigned numberOfIDBTransactions() const;
398 #endif
399 
400     unsigned numberOfLiveNodes() const;
401     unsigned numberOfLiveDocuments() const;
402     unsigned referencingNodeCount(const Document&amp;) const;
403 
404 #if ENABLE(INTERSECTION_OBSERVER)
405     unsigned numberOfIntersectionObservers(const Document&amp;) const;
406 #endif
407 
408     uint64_t documentIdentifier(const Document&amp;) const;
409     bool isDocumentAlive(uint64_t documentIdentifier) const;
410 






411     bool isAnyWorkletGlobalScopeAlive() const;
412 
413     String serviceWorkerClientIdentifier(const Document&amp;) const;
414 
415     RefPtr&lt;WindowProxy&gt; openDummyInspectorFrontend(const String&amp; url);
416     void closeDummyInspectorFrontend();
417     ExceptionOr&lt;void&gt; setInspectorIsUnderTest(bool);
418 
419     String counterValue(Element&amp;);
420 
421     int pageNumber(Element&amp;, float pageWidth = 800, float pageHeight = 600);
422     Vector&lt;String&gt; shortcutIconURLs() const;
423 
424     int numberOfPages(float pageWidthInPixels = 800, float pageHeightInPixels = 600);
425     ExceptionOr&lt;String&gt; pageProperty(const String&amp; propertyName, int pageNumber) const;
426     ExceptionOr&lt;String&gt; pageSizeAndMarginsInPixels(int pageNumber, int width, int height, int marginTop, int marginRight, int marginBottom, int marginLeft) const;
427 
428     ExceptionOr&lt;float&gt; pageScaleFactor() const;
429 
430     ExceptionOr&lt;void&gt; setPageScaleFactor(float scaleFactor, int x, int y);
</pre>
<hr />
<pre>
479     ExceptionOr&lt;unsigned&gt; layerFlushCount();
480 
481     ExceptionOr&lt;void&gt; startTrackingStyleRecalcs();
482     ExceptionOr&lt;unsigned&gt; styleRecalcCount();
483     unsigned lastStyleUpdateSize() const;
484 
485     ExceptionOr&lt;void&gt; startTrackingCompositingUpdates();
486     ExceptionOr&lt;unsigned&gt; compositingUpdateCount();
487 
488     enum CompositingPolicy { Normal, Conservative };
489     ExceptionOr&lt;void&gt; setCompositingPolicyOverride(Optional&lt;CompositingPolicy&gt;);
490     ExceptionOr&lt;Optional&lt;CompositingPolicy&gt;&gt; compositingPolicyOverride() const;
491 
492     ExceptionOr&lt;void&gt; updateLayoutIgnorePendingStylesheetsAndRunPostLayoutTasks(Node*);
493     unsigned layoutCount() const;
494 
495     Ref&lt;ArrayBuffer&gt; serializeObject(const RefPtr&lt;SerializedScriptValue&gt;&amp;) const;
496     Ref&lt;SerializedScriptValue&gt; deserializeBuffer(ArrayBuffer&amp;) const;
497 
498     bool isFromCurrentWorld(JSC::JSValue) const;

499 
500     void setUsesOverlayScrollbars(bool);
501     void setUsesMockScrollAnimator(bool);
502 
503     ExceptionOr&lt;String&gt; getCurrentCursorInfo();
504 
505     String markerTextForListItem(Element&amp;);
506 
507     String toolTipFromElement(Element&amp;) const;
508 
509     void forceReload(bool endToEnd);
510     void reloadExpiredOnly();
511 
512     void enableAutoSizeMode(bool enabled, int width, int height);
513 
514 #if ENABLE(LEGACY_ENCRYPTED_MEDIA)
515     void initializeMockCDM();
516 #endif
517 
518 #if ENABLE(ENCRYPTED_MEDIA)
519     Ref&lt;MockCDMFactory&gt; registerMockCDM();
520 #endif
521 
522     void enableMockMediaCapabilities();
523 
524 #if ENABLE(SPEECH_SYNTHESIS)
525     void enableMockSpeechSynthesizer();
526 #endif
527 
528 #if ENABLE(MEDIA_STREAM)
529     void setShouldInterruptAudioOnPageVisibilityChange(bool);
<span class="line-removed">530     void setMockMediaCaptureDevicesEnabled(bool);</span>
531     void setMediaCaptureRequiresSecureConnection(bool);
532     void setCustomPrivateRecorderCreator();
533 #endif
534 
535 #if ENABLE(WEB_RTC)
536     void emulateRTCPeerConnectionPlatformEvent(RTCPeerConnection&amp;, const String&amp; action);
537     void useMockRTCPeerConnectionFactory(const String&amp;);
538     void setICECandidateFiltering(bool);
539     void setEnumeratingAllNetworkInterfacesEnabled(bool);
540     void stopPeerConnection(RTCPeerConnection&amp;);
541     void clearPeerConnectionFactory();
542     void applyRotationForOutgoingVideoSources(RTCPeerConnection&amp;);
543     void setEnableWebRTCEncryption(bool);


544 #endif
545 
546     String getImageSourceURL(Element&amp;);
547 
548 #if ENABLE(VIDEO)
549     Vector&lt;String&gt; mediaResponseSources(HTMLMediaElement&amp;);
550     Vector&lt;String&gt; mediaResponseContentRanges(HTMLMediaElement&amp;);
551     void simulateAudioInterruption(HTMLMediaElement&amp;);
552     ExceptionOr&lt;bool&gt; mediaElementHasCharacteristic(HTMLMediaElement&amp;, const String&amp;);
553     void beginSimulatedHDCPError(HTMLMediaElement&amp;);
554     void endSimulatedHDCPError(HTMLMediaElement&amp;);
555 
556     bool elementShouldBufferData(HTMLMediaElement&amp;);
557     String elementBufferingPolicy(HTMLMediaElement&amp;);
558     double privatePlayerVolume(const HTMLMediaElement&amp;);
559 #endif
560 
561     bool isSelectPopupVisible(HTMLSelectElement&amp;);
562 
563     ExceptionOr&lt;String&gt; captionsStyleSheetOverride();
</pre>
<hr />
<pre>
599     void applicationDidEnterBackground(bool suspendedUnderLock) const;
600     ExceptionOr&lt;void&gt; setMediaSessionRestrictions(const String&amp; mediaType, StringView restrictionsString);
601     ExceptionOr&lt;String&gt; mediaSessionRestrictions(const String&amp; mediaType) const;
602     void setMediaElementRestrictions(HTMLMediaElement&amp;, StringView restrictionsString);
603     ExceptionOr&lt;void&gt; postRemoteControlCommand(const String&amp;, float argument);
604     bool elementIsBlockingDisplaySleep(HTMLMediaElement&amp;) const;
605 #endif
606 
607 #if ENABLE(MEDIA_SESSION)
608     void sendMediaSessionStartOfInterruptionNotification(MediaSessionInterruptingCategory);
609     void sendMediaSessionEndOfInterruptionNotification(MediaSessionInterruptingCategory);
610     String mediaSessionCurrentState(MediaSession&amp;) const;
611     double mediaElementPlayerVolume(HTMLMediaElement&amp;) const;
612     enum class MediaControlEvent { PlayPause, NextTrack, PreviousTrack };
613     void sendMediaControlEvent(MediaControlEvent);
614 #endif
615 
616 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
617     void setMockMediaPlaybackTargetPickerEnabled(bool);
618     ExceptionOr&lt;void&gt; setMockMediaPlaybackTargetPickerState(const String&amp; deviceName, const String&amp; deviceState);

619 #endif
620 
621 #if ENABLE(WEB_AUDIO)
622     void setAudioContextRestrictions(AudioContext&amp;, StringView restrictionsString);

623 #endif
624 
625     void simulateSystemSleep() const;
626     void simulateSystemWake() const;
627 
628     enum class PageOverlayType { View, Document };
629     ExceptionOr&lt;Ref&lt;MockPageOverlay&gt;&gt; installMockPageOverlay(PageOverlayType);
630     ExceptionOr&lt;String&gt; pageOverlayLayerTreeAsText(unsigned short flags) const;
631 
632     void setPageMuted(StringView);
633     String pageMediaState();
634 
635     void setPageDefersLoading(bool);
636     ExceptionOr&lt;bool&gt; pageDefersLoading();
637 
638     RefPtr&lt;File&gt; createFile(const String&amp;);
639     void queueMicroTask(int);
640     bool testPreloaderSettingViewport();
641 
642 #if ENABLE(CONTENT_FILTERING)
643     MockContentFilterSettings&amp; mockContentFilterSettings();
644 #endif
645 
646 #if ENABLE(CSS_SCROLL_SNAP)
647     ExceptionOr&lt;String&gt; scrollSnapOffsets(Element&amp;);
648     void setPlatformMomentumScrollingPredictionEnabled(bool);
649 #endif
650 
651     ExceptionOr&lt;String&gt; pathStringWithShrinkWrappedRects(const Vector&lt;double&gt;&amp; rectComponents, double radius);
652 
653     String getCurrentMediaControlsStatusForElement(HTMLMediaElement&amp;);
654 
655     String userVisibleString(const DOMURL&amp;);
656     void setShowAllPlugins(bool);
657 
658     String resourceLoadStatisticsForURL(const DOMURL&amp;);
659     void setResourceLoadStatisticsEnabled(bool);
660 
661 #if ENABLE(STREAMS_API)
<span class="line-modified">662     bool isReadableStreamDisturbed(JSC::ExecState&amp;, JSC::JSValue);</span>
<span class="line-modified">663     JSC::JSValue cloneArrayBuffer(JSC::ExecState&amp;, JSC::JSValue, JSC::JSValue, JSC::JSValue);</span>
664 #endif
665 
666     String composedTreeAsText(Node&amp;);
667 
668     bool isProcessingUserGesture();
669     double lastHandledUserGestureTimestamp();
670 
671     void withUserGesture(RefPtr&lt;VoidCallback&gt;&amp;&amp;);
672 
673     bool userIsInteracting();
674 
675     RefPtr&lt;GCObservation&gt; observeGC(JSC::JSValue);
676 
677     enum class UserInterfaceLayoutDirection : uint8_t { LTR, RTL };
678     void setUserInterfaceLayoutDirection(UserInterfaceLayoutDirection);
679 
680     bool userPrefersReducedMotion() const;
681 
682     void reportBacktrace();
683 
</pre>
<hr />
<pre>
709 
710 
711 #if ENABLE(WEB_RTC)
712     void setH264HardwareEncoderAllowed(bool allowed);
713 #endif
714 
715 #if ENABLE(MEDIA_STREAM)
716     void setMockAudioTrackChannelNumber(MediaStreamTrack&amp;, unsigned short);
717     void setCameraMediaStreamTrackOrientation(MediaStreamTrack&amp;, int orientation);
718     unsigned long trackAudioSampleCount() const { return m_trackAudioSampleCount; }
719     unsigned long trackVideoSampleCount() const { return m_trackVideoSampleCount; }
720     void observeMediaStreamTrack(MediaStreamTrack&amp;);
721     using TrackFramePromise = DOMPromiseDeferred&lt;IDLInterface&lt;ImageData&gt;&gt;;
722     void grabNextMediaStreamTrackFrame(TrackFramePromise&amp;&amp;);
723     void delayMediaStreamTrackSamples(MediaStreamTrack&amp;, float);
724     void setMediaStreamTrackMuted(MediaStreamTrack&amp;, bool);
725     void removeMediaStreamTrack(MediaStream&amp;, MediaStreamTrack&amp;);
726     void simulateMediaStreamTrackCaptureSourceFailure(MediaStreamTrack&amp;);
727     void setMediaStreamTrackIdentifier(MediaStreamTrack&amp;, String&amp;&amp; id);
728     void setMediaStreamSourceInterrupted(MediaStreamTrack&amp;, bool);
<span class="line-modified">729     void setDisableGetDisplayMediaUserGestureConstraint(bool);</span>
730 #endif
731 

732     String audioSessionCategory() const;
733     double preferredAudioBufferSize() const;
734     bool audioSessionActive() const;
735 
736     void storeRegistrationsOnDisk(DOMPromiseDeferred&lt;void&gt;&amp;&amp;);
737 
738     void clearCacheStorageMemoryRepresentation(DOMPromiseDeferred&lt;void&gt;&amp;&amp;);
739     void cacheStorageEngineRepresentation(DOMPromiseDeferred&lt;IDLDOMString&gt;&amp;&amp;);
740     void setResponseSizeWithPadding(FetchResponse&amp;, uint64_t size);
741     uint64_t responseSizeWithPadding(FetchResponse&amp;) const;
742 
743     void updateQuotaBasedOnSpaceUsage();
744 
745     void setConsoleMessageListener(RefPtr&lt;StringCallback&gt;&amp;&amp;);
746 
747 #if ENABLE(SERVICE_WORKER)
748     using HasRegistrationPromise = DOMPromiseDeferred&lt;IDLBoolean&gt;;
749     void hasServiceWorkerRegistration(const String&amp; clientURL, HasRegistrationPromise&amp;&amp;);
750     void terminateServiceWorker(ServiceWorker&amp;);
<span class="line-modified">751     bool hasServiceWorkerConnection();</span>
752 #endif
753 
754 #if ENABLE(APPLE_PAY)
755     MockPaymentCoordinator&amp; mockPaymentCoordinator(Document&amp;);
756 #endif
757 
758     bool isSystemPreviewLink(Element&amp;) const;
759     bool isSystemPreviewImage(Element&amp;) const;
760 
761     void postTask(RefPtr&lt;VoidCallback&gt;&amp;&amp;);




762     void markContextAsInsecure();
763 
764     bool usingAppleInternalSDK() const;
765 
766     struct NowPlayingState {
767         String title;
768         double duration;
769         double elapsedTime;
770         uint64_t uniqueIdentifier;
771         bool hasActiveSession;
772         bool registeredAsNowPlayingApplication;
773     };
774     ExceptionOr&lt;NowPlayingState&gt; nowPlayingState() const;
775 
776 #if ENABLE(VIDEO)
777     using PlaybackControlsPurpose = MediaElementSession::PlaybackControlsPurpose;
778     RefPtr&lt;HTMLMediaElement&gt; bestMediaElementForShowingPlaybackControlsManager(PlaybackControlsPurpose);
779 
780     using MediaSessionState = PlatformMediaSession::State;
781     MediaSessionState mediaSessionState(HTMLMediaElement&amp;);
</pre>
<hr />
<pre>
784     void setCaptureExtraNetworkLoadMetricsEnabled(bool);
785     String ongoingLoadsDescriptions() const;
786 
787     void reloadWithoutContentExtensions();
788 
789     void setUseSystemAppearance(bool);
790 
791     size_t pluginCount();
792 
793     void notifyResourceLoadObserver();
794 
795     unsigned primaryScreenDisplayID();
796 
797     bool capsLockIsOn();
798 
799     bool supportsVCPEncoder();
800 
801     using HEVCParameterSet = WebCore::HEVCParameterSet;
802     Optional&lt;HEVCParameterSet&gt; parseHEVCCodecParameters(const String&amp; codecString);
803 



804     struct CookieData {
805         String name;
806         String value;
807         String domain;
808         // Expiration dates are expressed as milliseconds since the UNIX epoch.
809         double expires { 0 };
810         bool isHttpOnly { false };
811         bool isSecure { false };
812         bool isSession { false };
813         bool isSameSiteLax { false };
814         bool isSameSiteStrict { false };
815 
816         CookieData(Cookie cookie)
817             : name(cookie.name)
818             , value(cookie.value)
819             , domain(cookie.domain)
820             , expires(cookie.expires)
821             , isHttpOnly(cookie.httpOnly)
822             , isSecure(cookie.secure)
823             , isSession(cookie.session)
824             , isSameSiteLax(cookie.sameSite == Cookie::SameSitePolicy::Lax)
825             , isSameSiteStrict(cookie.sameSite == Cookie::SameSitePolicy::Strict)
826         {
827             ASSERT(!(isSameSiteLax &amp;&amp; isSameSiteStrict));
828         }
829 
830         CookieData()
831         {
832         }
833     };
834     Vector&lt;CookieData&gt; getCookies() const;
835 
836     void setAlwaysAllowLocalWebarchive(bool);
837     void processWillSuspend();
838     void processDidResume();
839 
840     void testDictionaryLogging();
841 
842     void setXHRMaximumIntervalForUserGestureForwarding(XMLHttpRequest&amp;, double);

843 
844     void setIsPlayingToAutomotiveHeadUnit(bool);
845 
846     struct TextIndicatorInfo {
847         RefPtr&lt;DOMRectReadOnly&gt; textBoundingRectInRootViewCoordinates;
848         RefPtr&lt;DOMRectList&gt; textRectsInBoundingRectCoordinates;
849 
850         TextIndicatorInfo();
851         TextIndicatorInfo(const WebCore::TextIndicatorData&amp;);
852         ~TextIndicatorInfo();
853     };
854 
855     struct TextIndicatorOptions {
856         bool useBoundingRectAndPaintAllContentForComplexRanges { false };
857         bool computeEstimatedBackgroundColor { false };
858         bool respectTextColor { false };
859 
860         WebCore::TextIndicatorOptions core()
861         {
862             WebCore::TextIndicatorOptions options = 0;
863             if (useBoundingRectAndPaintAllContentForComplexRanges)
864                 options = options | TextIndicatorOptionUseBoundingRectAndPaintAllContentForComplexRanges;
865             if (computeEstimatedBackgroundColor)
866                 options = options | TextIndicatorOptionComputeEstimatedBackgroundColor;
867             if (respectTextColor)
868                 options = options | TextIndicatorOptionRespectTextColor;
869             return options;
870         }
871     };
872 
873     TextIndicatorInfo textIndicatorForRange(const Range&amp;, TextIndicatorOptions);
874 
875     void addPrefetchLoadEventListener(HTMLLinkElement&amp;, RefPtr&lt;EventListener&gt;&amp;&amp;);
876 




























877 private:
878     explicit Internals(Document&amp;);
879     Document* contextDocument() const;
880     Frame* frame() const;
881 
882     ExceptionOr&lt;RenderedDocumentMarker*&gt; markerAt(Node&amp;, const String&amp; markerType, unsigned index);
883 
884     // RealtimeMediaSource::Observer API
885 #if ENABLE(MEDIA_STREAM)
886     void videoSampleAvailable(MediaSample&amp;) final;
887     void audioSamplesAvailable(const MediaTime&amp;, const PlatformAudioData&amp;, const AudioStreamDescription&amp;, size_t) final { m_trackAudioSampleCount++; }
888 
889     OrientationNotifier m_orientationNotifier;
890     unsigned long m_trackVideoSampleCount { 0 };
891     unsigned long m_trackAudioSampleCount { 0 };
892     RefPtr&lt;MediaStreamTrack&gt; m_track;
<span class="line-modified">893     Optional&lt;TrackFramePromise&gt; m_nextTrackFramePromise;</span>
894 #endif
895 
896     std::unique_ptr&lt;InspectorStubFrontend&gt; m_inspectorFrontend;
897     RefPtr&lt;CacheStorageConnection&gt; m_cacheStorageConnection;
898 };
899 
900 } // namespace WebCore
</pre>
</td>
<td>
<hr />
<pre>
 14  *
 15  * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS &quot;AS IS&quot; AND ANY
 16  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 17  * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 18  * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
 19  * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 20  * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 21  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 22  * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 23  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 24  * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 25  */
 26 
 27 #pragma once
 28 
 29 #include &quot;CSSComputedStyleDeclaration.h&quot;
 30 #include &quot;ContextDestructionObserver.h&quot;
 31 #include &quot;Cookie.h&quot;
 32 #include &quot;ExceptionOr.h&quot;
 33 #include &quot;HEVCUtilities.h&quot;
<span class="line-modified"> 34 #include &quot;IDLTypes.h&quot;</span>
 35 #include &quot;OrientationNotifier.h&quot;
 36 #include &quot;PageConsoleClient.h&quot;
 37 #include &quot;RealtimeMediaSource.h&quot;
 38 #include &quot;TextIndicator.h&quot;
 39 #include &lt;JavaScriptCore/Float32Array.h&gt;
 40 #include &lt;wtf/Optional.h&gt;
 41 
 42 #if ENABLE(MEDIA_SESSION)
 43 #include &quot;MediaSessionInterruptionProvider.h&quot;
 44 #endif
 45 
 46 #if ENABLE(VIDEO)
 47 #include &quot;MediaElementSession.h&quot;
 48 #endif
 49 
 50 namespace WebCore {
 51 
 52 class AnimationTimeline;
 53 class AudioContext;
 54 class CacheStorageConnection;
 55 class DOMRect;
 56 class DOMRectList;
 57 class DOMRectReadOnly;
 58 class DOMURL;
 59 class DOMWindow;
 60 class Document;
 61 class Element;
 62 class EventListener;
 63 class ExtendableEvent;
 64 class FetchResponse;
 65 class File;
 66 class Frame;
 67 class GCObservation;
 68 class HTMLAnchorElement;
 69 class HTMLImageElement;
 70 class HTMLInputElement;
 71 class HTMLLinkElement;
 72 class HTMLMediaElement;
 73 class HTMLPictureElement;
 74 class HTMLSelectElement;
<span class="line-added"> 75 class HTMLVideoElement;</span>
 76 class ImageData;
 77 class InspectorStubFrontend;
<span class="line-added"> 78 class InternalsMapLike;</span>
 79 class InternalSettings;
<span class="line-added"> 80 class InternalsSetLike;</span>
<span class="line-added"> 81 class Location;</span>
 82 class MallocStatistics;
 83 class MediaSession;
 84 class MediaStream;
 85 class MediaStreamTrack;
 86 class MemoryInfo;
 87 class MockCDMFactory;
 88 class MockContentFilterSettings;
 89 class MockPageOverlay;
 90 class MockPaymentCoordinator;
 91 class NodeList;
 92 class Page;
 93 class RTCPeerConnection;
 94 class Range;
 95 class RenderedDocumentMarker;
 96 class SVGSVGElement;
 97 class SerializedScriptValue;
 98 class SourceBuffer;
 99 class StringCallback;
100 class StyleSheet;
101 class TimeRanges;
102 class TypeConversions;
<span class="line-added">103 class UnsuspendableActiveDOMObject;</span>
104 class VoidCallback;
105 class WebGLRenderingContext;
<span class="line-added">106 class WindowProxy;</span>
107 class XMLHttpRequest;
108 
109 #if ENABLE(VIDEO_TRACK)
110 class TextTrackCueGeneric;
111 #endif
112 
113 #if ENABLE(SERVICE_WORKER)
114 class ServiceWorker;
115 #endif
116 
<span class="line-added">117 template&lt;typename IDLType&gt; class DOMPromiseDeferred;</span>
<span class="line-added">118 </span>
<span class="line-added">119 struct MockWebAuthenticationConfiguration;</span>
<span class="line-added">120 </span>
121 class Internals final : public RefCounted&lt;Internals&gt;, private ContextDestructionObserver
122 #if ENABLE(MEDIA_STREAM)
123     , private RealtimeMediaSource::Observer
124 #endif
125     {
126 public:
127     static Ref&lt;Internals&gt; create(Document&amp;);
128     virtual ~Internals();
129 
130     static void resetToConsistentState(Page&amp;);
131 
132     ExceptionOr&lt;String&gt; elementRenderTreeAsText(Element&amp;);
133     bool hasPausedImageAnimations(Element&amp;);
134 
135     bool isPaintingFrequently(Element&amp;);
136     void incrementFrequentPaintCounter(Element&amp;);
137 
138     String address(Node&amp;);
139     bool nodeNeedsStyleRecalc(Node&amp;);
140     String styleChangeType(Node&amp;);
</pre>
<hr />
<pre>
156     void clearMemoryCache();
157     void pruneMemoryCacheToSize(unsigned size);
158     void destroyDecodedDataForAllImages();
159     unsigned memoryCacheSize() const;
160 
161     unsigned imageFrameIndex(HTMLImageElement&amp;);
162     unsigned imageFrameCount(HTMLImageElement&amp;);
163     float imageFrameDurationAtIndex(HTMLImageElement&amp;, unsigned index);
164     void setImageFrameDecodingDuration(HTMLImageElement&amp;, float duration);
165     void resetImageAnimation(HTMLImageElement&amp;);
166     bool isImageAnimating(HTMLImageElement&amp;);
167     unsigned imagePendingDecodePromisesCountForTesting(HTMLImageElement&amp;);
168     void setClearDecoderAfterAsyncFrameRequestForTesting(HTMLImageElement&amp;, bool enabled);
169     unsigned imageDecodeCount(HTMLImageElement&amp;);
170     unsigned pdfDocumentCachingCount(HTMLImageElement&amp;);
171     void setLargeImageAsyncDecodingEnabledForTesting(HTMLImageElement&amp;, bool enabled);
172     void setForceUpdateImageDataEnabledForTesting(HTMLImageElement&amp;, bool enabled);
173 
174     void setGridMaxTracksLimit(unsigned);
175 
<span class="line-modified">176     void clearBackForwardCache();</span>
<span class="line-modified">177     unsigned backForwardCacheSize() const;</span>
<span class="line-added">178     void preventDocumentFromEnteringBackForwardCache();</span>
179 
180     void disableTileSizeUpdateDelay();
181 
182     void setSpeculativeTilingDelayDisabledForTesting(bool);
183 
184     Ref&lt;CSSComputedStyleDeclaration&gt; computedStyleIncludingVisitedInfo(Element&amp;) const;
185 
186     Node* ensureUserAgentShadowRoot(Element&amp; host);
187     Node* shadowRoot(Element&amp; host);
188     ExceptionOr&lt;String&gt; shadowRootType(const Node&amp;) const;
189     String shadowPseudoId(Element&amp;);
190     void setShadowPseudoId(Element&amp;, const String&amp;);
191 
192     // CSS Deferred Parsing Testing
193     unsigned deferredStyleRulesCount(StyleSheet&amp;);
194     unsigned deferredGroupRulesCount(StyleSheet&amp;);
195     unsigned deferredKeyframesRulesCount(StyleSheet&amp;);
196 
197     // DOMTimers throttling testing.
198     ExceptionOr&lt;bool&gt; isTimerThrottled(int timeoutId);
</pre>
<hr />
<pre>
219 
220     // CSS Transition testing.
221     ExceptionOr&lt;bool&gt; pauseTransitionAtTimeOnElement(const String&amp; propertyName, double pauseTime, Element&amp;);
222     ExceptionOr&lt;bool&gt; pauseTransitionAtTimeOnPseudoElement(const String&amp; property, double pauseTime, Element&amp;, const String&amp; pseudoId);
223 
224     // Web Animations testing.
225     struct AcceleratedAnimation {
226         String property;
227         double speed;
228     };
229     Vector&lt;AcceleratedAnimation&gt; acceleratedAnimationsForElement(Element&amp;);
230     unsigned numberOfAnimationTimelineInvalidations() const;
231 
232     // For animations testing, we need a way to get at pseudo elements.
233     ExceptionOr&lt;RefPtr&lt;Element&gt;&gt; pseudoElement(Element&amp;, const String&amp;);
234 
235     Node* treeScopeRootNode(Node&amp;);
236     Node* parentTreeScope(Node&amp;);
237 
238     String visiblePlaceholder(Element&amp;);
<span class="line-added">239     void setCanShowPlaceholder(Element&amp;, bool);</span>
<span class="line-added">240 </span>
241     void selectColorInColorChooser(HTMLInputElement&amp;, const String&amp; colorValue);
242     ExceptionOr&lt;Vector&lt;String&gt;&gt; formControlStateOfPreviousHistoryItem();
243     ExceptionOr&lt;void&gt; setFormControlStateOfPreviousHistoryItem(const Vector&lt;String&gt;&amp;);
244 
245     ExceptionOr&lt;Ref&lt;DOMRect&gt;&gt; absoluteCaretBounds();
246     ExceptionOr&lt;bool&gt; isCaretBlinkingSuspended();
247 
248     Ref&lt;DOMRect&gt; boundingBox(Element&amp;);
249 
250     ExceptionOr&lt;Ref&lt;DOMRectList&gt;&gt; inspectorHighlightRects();
251 
252     ExceptionOr&lt;unsigned&gt; markerCountForNode(Node&amp;, const String&amp;);
253     ExceptionOr&lt;RefPtr&lt;Range&gt;&gt; markerRangeForNode(Node&amp;, const String&amp; markerType, unsigned index);
254     ExceptionOr&lt;String&gt; markerDescriptionForNode(Node&amp;, const String&amp; markerType, unsigned index);
255     ExceptionOr&lt;String&gt; dumpMarkerRects(const String&amp; markerType);
256     void addTextMatchMarker(const Range&amp;, bool isActive);
257     ExceptionOr&lt;void&gt; setMarkedTextMatchesAreHighlighted(bool);
258 
259     void invalidateFontCache();
260     void setFontSmoothingEnabled(bool);
</pre>
<hr />
<pre>
293     RefPtr&lt;Range&gt; rangeFromLocationAndLength(Element&amp; scope, int rangeLocation, int rangeLength);
294     unsigned locationFromRange(Element&amp; scope, const Range&amp;);
295     unsigned lengthFromRange(Element&amp; scope, const Range&amp;);
296     String rangeAsText(const Range&amp;);
297     String rangeAsTextUsingBackwardsTextIterator(const Range&amp;);
298     Ref&lt;Range&gt; subrange(Range&amp;, int rangeLocation, int rangeLength);
299     ExceptionOr&lt;RefPtr&lt;Range&gt;&gt; rangeForDictionaryLookupAtLocation(int x, int y);
300     RefPtr&lt;Range&gt; rangeOfStringNearLocation(const Range&amp;, const String&amp;, unsigned);
301 
302     ExceptionOr&lt;void&gt; setDelegatesScrolling(bool enabled);
303 
304     ExceptionOr&lt;int&gt; lastSpellCheckRequestSequence();
305     ExceptionOr&lt;int&gt; lastSpellCheckProcessedSequence();
306 
307     Vector&lt;String&gt; userPreferredLanguages() const;
308     void setUserPreferredLanguages(const Vector&lt;String&gt;&amp;);
309 
310     Vector&lt;String&gt; userPreferredAudioCharacteristics() const;
311     void setUserPreferredAudioCharacteristic(const String&amp;);
312 
<span class="line-added">313     void setMaxCanvasPixelMemory(unsigned);</span>
<span class="line-added">314 </span>
315     ExceptionOr&lt;unsigned&gt; wheelEventHandlerCount();
316     ExceptionOr&lt;unsigned&gt; touchEventHandlerCount();
317 
318     ExceptionOr&lt;Ref&lt;DOMRectList&gt;&gt; touchEventRectsForEvent(const String&amp;);
319     ExceptionOr&lt;Ref&lt;DOMRectList&gt;&gt; passiveTouchEventListenerRects();
320 
321     ExceptionOr&lt;RefPtr&lt;NodeList&gt;&gt; nodesFromRect(Document&amp;, int x, int y, unsigned topPadding, unsigned rightPadding, unsigned bottomPadding, unsigned leftPadding, bool ignoreClipping, bool allowUserAgentShadowContent, bool allowChildFrameContent) const;
322 
323     String parserMetaData(JSC::JSValue = JSC::JSValue::JSUndefined);
324 
325     void updateEditorUINowIfScheduled();
326 
327     bool sentenceRetroCorrectionEnabled() const
328     {
329 #if PLATFORM(MAC) &amp;&amp; __MAC_OS_X_VERSION_MIN_REQUIRED &gt;= 101400
330         return true;
331 #else
332         return false;
333 #endif
334     }
</pre>
<hr />
<pre>
360 
361     static const char* internalsId;
362 
363     InternalSettings* settings() const;
364     unsigned workerThreadCount() const;
365     ExceptionOr&lt;bool&gt; areSVGAnimationsPaused() const;
366     ExceptionOr&lt;double&gt; svgAnimationsInterval(SVGSVGElement&amp;) const;
367 
368     enum {
369         // Values need to be kept in sync with Internals.idl.
370         LAYER_TREE_INCLUDES_VISIBLE_RECTS = 1,
371         LAYER_TREE_INCLUDES_TILE_CACHES = 2,
372         LAYER_TREE_INCLUDES_REPAINT_RECTS = 4,
373         LAYER_TREE_INCLUDES_PAINTING_PHASES = 8,
374         LAYER_TREE_INCLUDES_CONTENT_LAYERS = 16,
375         LAYER_TREE_INCLUDES_ACCELERATES_DRAWING = 32,
376         LAYER_TREE_INCLUDES_CLIPPING = 64,
377         LAYER_TREE_INCLUDES_BACKING_STORE_ATTACHED = 128,
378         LAYER_TREE_INCLUDES_ROOT_LAYER_PROPERTIES = 256,
379         LAYER_TREE_INCLUDES_EVENT_REGION = 512,
<span class="line-added">380         LAYER_TREE_INCLUDES_DEEP_COLOR = 1024,</span>
381     };
382     ExceptionOr&lt;String&gt; layerTreeAsText(Document&amp;, unsigned short flags) const;
383     ExceptionOr&lt;uint64_t&gt; layerIDForElement(Element&amp;);
384     ExceptionOr&lt;String&gt; repaintRectsAsText() const;
385 
386     ExceptionOr&lt;String&gt; scrollbarOverlayStyle(Node*) const;
387     ExceptionOr&lt;bool&gt; scrollbarUsingDarkAppearance(Node*) const;
388 
389     ExceptionOr&lt;String&gt; scrollingStateTreeAsText() const;
390     ExceptionOr&lt;String&gt; mainThreadScrollingReasons() const;
391     ExceptionOr&lt;Ref&lt;DOMRectList&gt;&gt; nonFastScrollableRects() const;
392 
393     ExceptionOr&lt;void&gt; setElementUsesDisplayListDrawing(Element&amp;, bool usesDisplayListDrawing);
394     ExceptionOr&lt;void&gt; setElementTracksDisplayListReplay(Element&amp;, bool isTrackingReplay);
395 
396     enum {
397         // Values need to be kept in sync with Internals.idl.
398         DISPLAY_LIST_INCLUDES_PLATFORM_OPERATIONS = 1,
399     };
400     ExceptionOr&lt;String&gt; displayListForElement(Element&amp;, unsigned short flags);
</pre>
<hr />
<pre>
407     bool isUnderMemoryPressure();
408 
409     ExceptionOr&lt;void&gt; insertAuthorCSS(const String&amp;) const;
410     ExceptionOr&lt;void&gt; insertUserCSS(const String&amp;) const;
411 
412 #if ENABLE(INDEXED_DATABASE)
413     unsigned numberOfIDBTransactions() const;
414 #endif
415 
416     unsigned numberOfLiveNodes() const;
417     unsigned numberOfLiveDocuments() const;
418     unsigned referencingNodeCount(const Document&amp;) const;
419 
420 #if ENABLE(INTERSECTION_OBSERVER)
421     unsigned numberOfIntersectionObservers(const Document&amp;) const;
422 #endif
423 
424     uint64_t documentIdentifier(const Document&amp;) const;
425     bool isDocumentAlive(uint64_t documentIdentifier) const;
426 
<span class="line-added">427     uint64_t storageAreaMapCount() const;</span>
<span class="line-added">428 </span>
<span class="line-added">429     uint64_t elementIdentifier(Element&amp;) const;</span>
<span class="line-added">430     uint64_t frameIdentifier(const Document&amp;) const;</span>
<span class="line-added">431     uint64_t pageIdentifier(const Document&amp;) const;</span>
<span class="line-added">432 </span>
433     bool isAnyWorkletGlobalScopeAlive() const;
434 
435     String serviceWorkerClientIdentifier(const Document&amp;) const;
436 
437     RefPtr&lt;WindowProxy&gt; openDummyInspectorFrontend(const String&amp; url);
438     void closeDummyInspectorFrontend();
439     ExceptionOr&lt;void&gt; setInspectorIsUnderTest(bool);
440 
441     String counterValue(Element&amp;);
442 
443     int pageNumber(Element&amp;, float pageWidth = 800, float pageHeight = 600);
444     Vector&lt;String&gt; shortcutIconURLs() const;
445 
446     int numberOfPages(float pageWidthInPixels = 800, float pageHeightInPixels = 600);
447     ExceptionOr&lt;String&gt; pageProperty(const String&amp; propertyName, int pageNumber) const;
448     ExceptionOr&lt;String&gt; pageSizeAndMarginsInPixels(int pageNumber, int width, int height, int marginTop, int marginRight, int marginBottom, int marginLeft) const;
449 
450     ExceptionOr&lt;float&gt; pageScaleFactor() const;
451 
452     ExceptionOr&lt;void&gt; setPageScaleFactor(float scaleFactor, int x, int y);
</pre>
<hr />
<pre>
501     ExceptionOr&lt;unsigned&gt; layerFlushCount();
502 
503     ExceptionOr&lt;void&gt; startTrackingStyleRecalcs();
504     ExceptionOr&lt;unsigned&gt; styleRecalcCount();
505     unsigned lastStyleUpdateSize() const;
506 
507     ExceptionOr&lt;void&gt; startTrackingCompositingUpdates();
508     ExceptionOr&lt;unsigned&gt; compositingUpdateCount();
509 
510     enum CompositingPolicy { Normal, Conservative };
511     ExceptionOr&lt;void&gt; setCompositingPolicyOverride(Optional&lt;CompositingPolicy&gt;);
512     ExceptionOr&lt;Optional&lt;CompositingPolicy&gt;&gt; compositingPolicyOverride() const;
513 
514     ExceptionOr&lt;void&gt; updateLayoutIgnorePendingStylesheetsAndRunPostLayoutTasks(Node*);
515     unsigned layoutCount() const;
516 
517     Ref&lt;ArrayBuffer&gt; serializeObject(const RefPtr&lt;SerializedScriptValue&gt;&amp;) const;
518     Ref&lt;SerializedScriptValue&gt; deserializeBuffer(ArrayBuffer&amp;) const;
519 
520     bool isFromCurrentWorld(JSC::JSValue) const;
<span class="line-added">521     JSC::JSValue evaluateInWorldIgnoringException(const String&amp; name, const String&amp; source);</span>
522 
523     void setUsesOverlayScrollbars(bool);
524     void setUsesMockScrollAnimator(bool);
525 
526     ExceptionOr&lt;String&gt; getCurrentCursorInfo();
527 
528     String markerTextForListItem(Element&amp;);
529 
530     String toolTipFromElement(Element&amp;) const;
531 
532     void forceReload(bool endToEnd);
533     void reloadExpiredOnly();
534 
535     void enableAutoSizeMode(bool enabled, int width, int height);
536 
537 #if ENABLE(LEGACY_ENCRYPTED_MEDIA)
538     void initializeMockCDM();
539 #endif
540 
541 #if ENABLE(ENCRYPTED_MEDIA)
542     Ref&lt;MockCDMFactory&gt; registerMockCDM();
543 #endif
544 
545     void enableMockMediaCapabilities();
546 
547 #if ENABLE(SPEECH_SYNTHESIS)
548     void enableMockSpeechSynthesizer();
549 #endif
550 
551 #if ENABLE(MEDIA_STREAM)
552     void setShouldInterruptAudioOnPageVisibilityChange(bool);

553     void setMediaCaptureRequiresSecureConnection(bool);
554     void setCustomPrivateRecorderCreator();
555 #endif
556 
557 #if ENABLE(WEB_RTC)
558     void emulateRTCPeerConnectionPlatformEvent(RTCPeerConnection&amp;, const String&amp; action);
559     void useMockRTCPeerConnectionFactory(const String&amp;);
560     void setICECandidateFiltering(bool);
561     void setEnumeratingAllNetworkInterfacesEnabled(bool);
562     void stopPeerConnection(RTCPeerConnection&amp;);
563     void clearPeerConnectionFactory();
564     void applyRotationForOutgoingVideoSources(RTCPeerConnection&amp;);
565     void setEnableWebRTCEncryption(bool);
<span class="line-added">566     void setUseDTLS10(bool);</span>
<span class="line-added">567     void setUseGPUProcessForWebRTC(bool);</span>
568 #endif
569 
570     String getImageSourceURL(Element&amp;);
571 
572 #if ENABLE(VIDEO)
573     Vector&lt;String&gt; mediaResponseSources(HTMLMediaElement&amp;);
574     Vector&lt;String&gt; mediaResponseContentRanges(HTMLMediaElement&amp;);
575     void simulateAudioInterruption(HTMLMediaElement&amp;);
576     ExceptionOr&lt;bool&gt; mediaElementHasCharacteristic(HTMLMediaElement&amp;, const String&amp;);
577     void beginSimulatedHDCPError(HTMLMediaElement&amp;);
578     void endSimulatedHDCPError(HTMLMediaElement&amp;);
579 
580     bool elementShouldBufferData(HTMLMediaElement&amp;);
581     String elementBufferingPolicy(HTMLMediaElement&amp;);
582     double privatePlayerVolume(const HTMLMediaElement&amp;);
583 #endif
584 
585     bool isSelectPopupVisible(HTMLSelectElement&amp;);
586 
587     ExceptionOr&lt;String&gt; captionsStyleSheetOverride();
</pre>
<hr />
<pre>
623     void applicationDidEnterBackground(bool suspendedUnderLock) const;
624     ExceptionOr&lt;void&gt; setMediaSessionRestrictions(const String&amp; mediaType, StringView restrictionsString);
625     ExceptionOr&lt;String&gt; mediaSessionRestrictions(const String&amp; mediaType) const;
626     void setMediaElementRestrictions(HTMLMediaElement&amp;, StringView restrictionsString);
627     ExceptionOr&lt;void&gt; postRemoteControlCommand(const String&amp;, float argument);
628     bool elementIsBlockingDisplaySleep(HTMLMediaElement&amp;) const;
629 #endif
630 
631 #if ENABLE(MEDIA_SESSION)
632     void sendMediaSessionStartOfInterruptionNotification(MediaSessionInterruptingCategory);
633     void sendMediaSessionEndOfInterruptionNotification(MediaSessionInterruptingCategory);
634     String mediaSessionCurrentState(MediaSession&amp;) const;
635     double mediaElementPlayerVolume(HTMLMediaElement&amp;) const;
636     enum class MediaControlEvent { PlayPause, NextTrack, PreviousTrack };
637     void sendMediaControlEvent(MediaControlEvent);
638 #endif
639 
640 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
641     void setMockMediaPlaybackTargetPickerEnabled(bool);
642     ExceptionOr&lt;void&gt; setMockMediaPlaybackTargetPickerState(const String&amp; deviceName, const String&amp; deviceState);
<span class="line-added">643     void mockMediaPlaybackTargetPickerDismissPopup();</span>
644 #endif
645 
646 #if ENABLE(WEB_AUDIO)
647     void setAudioContextRestrictions(AudioContext&amp;, StringView restrictionsString);
<span class="line-added">648     void useMockAudioDestinationCocoa();</span>
649 #endif
650 
651     void simulateSystemSleep() const;
652     void simulateSystemWake() const;
653 
654     enum class PageOverlayType { View, Document };
655     ExceptionOr&lt;Ref&lt;MockPageOverlay&gt;&gt; installMockPageOverlay(PageOverlayType);
656     ExceptionOr&lt;String&gt; pageOverlayLayerTreeAsText(unsigned short flags) const;
657 
658     void setPageMuted(StringView);
659     String pageMediaState();
660 
661     void setPageDefersLoading(bool);
662     ExceptionOr&lt;bool&gt; pageDefersLoading();
663 
664     RefPtr&lt;File&gt; createFile(const String&amp;);
665     void queueMicroTask(int);
666     bool testPreloaderSettingViewport();
667 
668 #if ENABLE(CONTENT_FILTERING)
669     MockContentFilterSettings&amp; mockContentFilterSettings();
670 #endif
671 
672 #if ENABLE(CSS_SCROLL_SNAP)
673     ExceptionOr&lt;String&gt; scrollSnapOffsets(Element&amp;);
674     void setPlatformMomentumScrollingPredictionEnabled(bool);
675 #endif
676 
677     ExceptionOr&lt;String&gt; pathStringWithShrinkWrappedRects(const Vector&lt;double&gt;&amp; rectComponents, double radius);
678 
679     String getCurrentMediaControlsStatusForElement(HTMLMediaElement&amp;);
680 
681     String userVisibleString(const DOMURL&amp;);
682     void setShowAllPlugins(bool);
683 
684     String resourceLoadStatisticsForURL(const DOMURL&amp;);
685     void setResourceLoadStatisticsEnabled(bool);
686 
687 #if ENABLE(STREAMS_API)
<span class="line-modified">688     bool isReadableStreamDisturbed(JSC::JSGlobalObject&amp;, JSC::JSValue);</span>
<span class="line-modified">689     JSC::JSValue cloneArrayBuffer(JSC::JSGlobalObject&amp;, JSC::JSValue, JSC::JSValue, JSC::JSValue);</span>
690 #endif
691 
692     String composedTreeAsText(Node&amp;);
693 
694     bool isProcessingUserGesture();
695     double lastHandledUserGestureTimestamp();
696 
697     void withUserGesture(RefPtr&lt;VoidCallback&gt;&amp;&amp;);
698 
699     bool userIsInteracting();
700 
701     RefPtr&lt;GCObservation&gt; observeGC(JSC::JSValue);
702 
703     enum class UserInterfaceLayoutDirection : uint8_t { LTR, RTL };
704     void setUserInterfaceLayoutDirection(UserInterfaceLayoutDirection);
705 
706     bool userPrefersReducedMotion() const;
707 
708     void reportBacktrace();
709 
</pre>
<hr />
<pre>
735 
736 
737 #if ENABLE(WEB_RTC)
738     void setH264HardwareEncoderAllowed(bool allowed);
739 #endif
740 
741 #if ENABLE(MEDIA_STREAM)
742     void setMockAudioTrackChannelNumber(MediaStreamTrack&amp;, unsigned short);
743     void setCameraMediaStreamTrackOrientation(MediaStreamTrack&amp;, int orientation);
744     unsigned long trackAudioSampleCount() const { return m_trackAudioSampleCount; }
745     unsigned long trackVideoSampleCount() const { return m_trackVideoSampleCount; }
746     void observeMediaStreamTrack(MediaStreamTrack&amp;);
747     using TrackFramePromise = DOMPromiseDeferred&lt;IDLInterface&lt;ImageData&gt;&gt;;
748     void grabNextMediaStreamTrackFrame(TrackFramePromise&amp;&amp;);
749     void delayMediaStreamTrackSamples(MediaStreamTrack&amp;, float);
750     void setMediaStreamTrackMuted(MediaStreamTrack&amp;, bool);
751     void removeMediaStreamTrack(MediaStream&amp;, MediaStreamTrack&amp;);
752     void simulateMediaStreamTrackCaptureSourceFailure(MediaStreamTrack&amp;);
753     void setMediaStreamTrackIdentifier(MediaStreamTrack&amp;, String&amp;&amp; id);
754     void setMediaStreamSourceInterrupted(MediaStreamTrack&amp;, bool);
<span class="line-modified">755     bool isMockRealtimeMediaSourceCenterEnabled();</span>
756 #endif
757 
<span class="line-added">758     bool supportsAudioSession() const;</span>
759     String audioSessionCategory() const;
760     double preferredAudioBufferSize() const;
761     bool audioSessionActive() const;
762 
763     void storeRegistrationsOnDisk(DOMPromiseDeferred&lt;void&gt;&amp;&amp;);
764 
765     void clearCacheStorageMemoryRepresentation(DOMPromiseDeferred&lt;void&gt;&amp;&amp;);
766     void cacheStorageEngineRepresentation(DOMPromiseDeferred&lt;IDLDOMString&gt;&amp;&amp;);
767     void setResponseSizeWithPadding(FetchResponse&amp;, uint64_t size);
768     uint64_t responseSizeWithPadding(FetchResponse&amp;) const;
769 
770     void updateQuotaBasedOnSpaceUsage();
771 
772     void setConsoleMessageListener(RefPtr&lt;StringCallback&gt;&amp;&amp;);
773 
774 #if ENABLE(SERVICE_WORKER)
775     using HasRegistrationPromise = DOMPromiseDeferred&lt;IDLBoolean&gt;;
776     void hasServiceWorkerRegistration(const String&amp; clientURL, HasRegistrationPromise&amp;&amp;);
777     void terminateServiceWorker(ServiceWorker&amp;);
<span class="line-modified">778     void isServiceWorkerRunning(ServiceWorker&amp;, DOMPromiseDeferred&lt;IDLBoolean&gt;&amp;&amp;);</span>
779 #endif
780 
781 #if ENABLE(APPLE_PAY)
782     MockPaymentCoordinator&amp; mockPaymentCoordinator(Document&amp;);
783 #endif
784 
785     bool isSystemPreviewLink(Element&amp;) const;
786     bool isSystemPreviewImage(Element&amp;) const;
787 
788     void postTask(RefPtr&lt;VoidCallback&gt;&amp;&amp;);
<span class="line-added">789     ExceptionOr&lt;void&gt; queueTask(ScriptExecutionContext&amp;, const String&amp; source, RefPtr&lt;VoidCallback&gt;&amp;&amp;);</span>
<span class="line-added">790     ExceptionOr&lt;void&gt; queueTaskToQueueMicrotask(Document&amp;, const String&amp; source, RefPtr&lt;VoidCallback&gt;&amp;&amp;);</span>
<span class="line-added">791     ExceptionOr&lt;bool&gt; hasSameEventLoopAs(WindowProxy&amp;);</span>
<span class="line-added">792 </span>
793     void markContextAsInsecure();
794 
795     bool usingAppleInternalSDK() const;
796 
797     struct NowPlayingState {
798         String title;
799         double duration;
800         double elapsedTime;
801         uint64_t uniqueIdentifier;
802         bool hasActiveSession;
803         bool registeredAsNowPlayingApplication;
804     };
805     ExceptionOr&lt;NowPlayingState&gt; nowPlayingState() const;
806 
807 #if ENABLE(VIDEO)
808     using PlaybackControlsPurpose = MediaElementSession::PlaybackControlsPurpose;
809     RefPtr&lt;HTMLMediaElement&gt; bestMediaElementForShowingPlaybackControlsManager(PlaybackControlsPurpose);
810 
811     using MediaSessionState = PlatformMediaSession::State;
812     MediaSessionState mediaSessionState(HTMLMediaElement&amp;);
</pre>
<hr />
<pre>
815     void setCaptureExtraNetworkLoadMetricsEnabled(bool);
816     String ongoingLoadsDescriptions() const;
817 
818     void reloadWithoutContentExtensions();
819 
820     void setUseSystemAppearance(bool);
821 
822     size_t pluginCount();
823 
824     void notifyResourceLoadObserver();
825 
826     unsigned primaryScreenDisplayID();
827 
828     bool capsLockIsOn();
829 
830     bool supportsVCPEncoder();
831 
832     using HEVCParameterSet = WebCore::HEVCParameterSet;
833     Optional&lt;HEVCParameterSet&gt; parseHEVCCodecParameters(const String&amp; codecString);
834 
<span class="line-added">835     using DoViParameterSet = WebCore::DoViParameterSet;</span>
<span class="line-added">836     Optional&lt;DoViParameterSet&gt; parseDoViCodecParameters(const String&amp; codecString);</span>
<span class="line-added">837 </span>
838     struct CookieData {
839         String name;
840         String value;
841         String domain;
842         // Expiration dates are expressed as milliseconds since the UNIX epoch.
843         double expires { 0 };
844         bool isHttpOnly { false };
845         bool isSecure { false };
846         bool isSession { false };
847         bool isSameSiteLax { false };
848         bool isSameSiteStrict { false };
849 
850         CookieData(Cookie cookie)
851             : name(cookie.name)
852             , value(cookie.value)
853             , domain(cookie.domain)
854             , expires(cookie.expires)
855             , isHttpOnly(cookie.httpOnly)
856             , isSecure(cookie.secure)
857             , isSession(cookie.session)
858             , isSameSiteLax(cookie.sameSite == Cookie::SameSitePolicy::Lax)
859             , isSameSiteStrict(cookie.sameSite == Cookie::SameSitePolicy::Strict)
860         {
861             ASSERT(!(isSameSiteLax &amp;&amp; isSameSiteStrict));
862         }
863 
864         CookieData()
865         {
866         }
867     };
868     Vector&lt;CookieData&gt; getCookies() const;
869 
870     void setAlwaysAllowLocalWebarchive(bool);
871     void processWillSuspend();
872     void processDidResume();
873 
874     void testDictionaryLogging();
875 
876     void setXHRMaximumIntervalForUserGestureForwarding(XMLHttpRequest&amp;, double);
<span class="line-added">877     void setTransientActivationDuration(double seconds);</span>
878 
879     void setIsPlayingToAutomotiveHeadUnit(bool);
880 
881     struct TextIndicatorInfo {
882         RefPtr&lt;DOMRectReadOnly&gt; textBoundingRectInRootViewCoordinates;
883         RefPtr&lt;DOMRectList&gt; textRectsInBoundingRectCoordinates;
884 
885         TextIndicatorInfo();
886         TextIndicatorInfo(const WebCore::TextIndicatorData&amp;);
887         ~TextIndicatorInfo();
888     };
889 
890     struct TextIndicatorOptions {
891         bool useBoundingRectAndPaintAllContentForComplexRanges { false };
892         bool computeEstimatedBackgroundColor { false };
893         bool respectTextColor { false };
894 
895         WebCore::TextIndicatorOptions core()
896         {
897             WebCore::TextIndicatorOptions options = 0;
898             if (useBoundingRectAndPaintAllContentForComplexRanges)
899                 options = options | TextIndicatorOptionUseBoundingRectAndPaintAllContentForComplexRanges;
900             if (computeEstimatedBackgroundColor)
901                 options = options | TextIndicatorOptionComputeEstimatedBackgroundColor;
902             if (respectTextColor)
903                 options = options | TextIndicatorOptionRespectTextColor;
904             return options;
905         }
906     };
907 
908     TextIndicatorInfo textIndicatorForRange(const Range&amp;, TextIndicatorOptions);
909 
910     void addPrefetchLoadEventListener(HTMLLinkElement&amp;, RefPtr&lt;EventListener&gt;&amp;&amp;);
911 
<span class="line-added">912 #if ENABLE(WEB_AUTHN)</span>
<span class="line-added">913     void setMockWebAuthenticationConfiguration(const MockWebAuthenticationConfiguration&amp;);</span>
<span class="line-added">914 #endif</span>
<span class="line-added">915 </span>
<span class="line-added">916 #if ENABLE(PICTURE_IN_PICTURE_API)</span>
<span class="line-added">917     void setPictureInPictureAPITestEnabled(HTMLVideoElement&amp;, bool);</span>
<span class="line-added">918 #endif</span>
<span class="line-added">919 </span>
<span class="line-added">920     int processIdentifier() const;</span>
<span class="line-added">921 </span>
<span class="line-added">922     Ref&lt;InternalsSetLike&gt; createInternalsSetLike();</span>
<span class="line-added">923     Ref&lt;InternalsMapLike&gt; createInternalsMapLike();</span>
<span class="line-added">924 </span>
<span class="line-added">925     bool hasSandboxMachLookupAccessToGlobalName(const String&amp; process, const String&amp; service);</span>
<span class="line-added">926     bool hasSandboxMachLookupAccessToXPCServiceName(const String&amp; process, const String&amp; service);</span>
<span class="line-added">927 </span>
<span class="line-added">928     String highlightPseudoElementColor(const String&amp; highlightName, Element&amp;);</span>
<span class="line-added">929 </span>
<span class="line-added">930     String windowLocationHost(DOMWindow&amp;);</span>
<span class="line-added">931 </span>
<span class="line-added">932     String systemColorForCSSValue(const String&amp; cssValue, bool useDarkModeAppearance, bool useElevatedUserInterfaceLevel);</span>
<span class="line-added">933 </span>
<span class="line-added">934     bool systemHasBattery() const;</span>
<span class="line-added">935 </span>
<span class="line-added">936     String mediaMIMETypeForExtension(const String&amp; extension);</span>
<span class="line-added">937 </span>
<span class="line-added">938     String focusRingColor();</span>
<span class="line-added">939 </span>
940 private:
941     explicit Internals(Document&amp;);
942     Document* contextDocument() const;
943     Frame* frame() const;
944 
945     ExceptionOr&lt;RenderedDocumentMarker*&gt; markerAt(Node&amp;, const String&amp; markerType, unsigned index);
946 
947     // RealtimeMediaSource::Observer API
948 #if ENABLE(MEDIA_STREAM)
949     void videoSampleAvailable(MediaSample&amp;) final;
950     void audioSamplesAvailable(const MediaTime&amp;, const PlatformAudioData&amp;, const AudioStreamDescription&amp;, size_t) final { m_trackAudioSampleCount++; }
951 
952     OrientationNotifier m_orientationNotifier;
953     unsigned long m_trackVideoSampleCount { 0 };
954     unsigned long m_trackAudioSampleCount { 0 };
955     RefPtr&lt;MediaStreamTrack&gt; m_track;
<span class="line-modified">956     std::unique_ptr&lt;TrackFramePromise&gt; m_nextTrackFramePromise;</span>
957 #endif
958 
959     std::unique_ptr&lt;InspectorStubFrontend&gt; m_inspectorFrontend;
960     RefPtr&lt;CacheStorageConnection&gt; m_cacheStorageConnection;
961 };
962 
963 } // namespace WebCore
</pre>
</td>
</tr>
</table>
<center><a href="Internals.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="Internals.idl.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>