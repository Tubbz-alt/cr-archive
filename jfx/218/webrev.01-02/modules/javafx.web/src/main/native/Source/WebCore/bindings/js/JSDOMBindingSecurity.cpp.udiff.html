<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/bindings/js/JSDOMBindingSecurity.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="JSDOMBindingInternals.js.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="JSDOMBindingSecurity.h.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/bindings/js/JSDOMBindingSecurity.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -40,29 +40,29 @@</span>
      if (!frame)
          return;
      frame-&gt;document()-&gt;domWindow()-&gt;printErrorMessage(message);
  }
  
<span class="udiff-line-modified-removed">- static inline bool canAccessDocument(JSC::ExecState* state, Document* targetDocument, SecurityReportingOption reportingOption)</span>
<span class="udiff-line-modified-added">+ static inline bool canAccessDocument(JSC::JSGlobalObject* lexicalGlobalObject, Document* targetDocument, SecurityReportingOption reportingOption)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = state-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = lexicalGlobalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
  
      if (!targetDocument)
          return false;
  
      if (auto* templateHost = targetDocument-&gt;templateDocumentHost())
          targetDocument = templateHost;
  
<span class="udiff-line-modified-removed">-     DOMWindow&amp; active = activeDOMWindow(*state);</span>
<span class="udiff-line-modified-added">+     DOMWindow&amp; active = activeDOMWindow(*lexicalGlobalObject);</span>
  
      if (active.document()-&gt;securityOrigin().canAccess(targetDocument-&gt;securityOrigin()))
          return true;
  
      switch (reportingOption) {
      case ThrowSecurityError:
<span class="udiff-line-modified-removed">-         throwSecurityError(*state, scope, targetDocument-&gt;domWindow()-&gt;crossDomainAccessErrorMessage(active, IncludeTargetOrigin::No));</span>
<span class="udiff-line-modified-added">+         throwSecurityError(*lexicalGlobalObject, scope, targetDocument-&gt;domWindow()-&gt;crossDomainAccessErrorMessage(active, IncludeTargetOrigin::No));</span>
          break;
      case LogSecurityError:
          printErrorMessageForFrame(targetDocument-&gt;frame(), targetDocument-&gt;domWindow()-&gt;crossDomainAccessErrorMessage(active, IncludeTargetOrigin::Yes));
          break;
      case DoNotReportSecurityError:
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -70,47 +70,47 @@</span>
      }
  
      return false;
  }
  
<span class="udiff-line-modified-removed">- bool BindingSecurity::shouldAllowAccessToFrame(ExecState&amp; state, Frame&amp; frame, String&amp; message)</span>
<span class="udiff-line-modified-added">+ bool BindingSecurity::shouldAllowAccessToFrame(JSGlobalObject&amp; lexicalGlobalObject, Frame&amp; frame, String&amp; message)</span>
  {
<span class="udiff-line-modified-removed">-     if (BindingSecurity::shouldAllowAccessToFrame(&amp;state, &amp;frame, DoNotReportSecurityError))</span>
<span class="udiff-line-modified-added">+     if (BindingSecurity::shouldAllowAccessToFrame(&amp;lexicalGlobalObject, &amp;frame, DoNotReportSecurityError))</span>
          return true;
<span class="udiff-line-modified-removed">-     message = frame.document()-&gt;domWindow()-&gt;crossDomainAccessErrorMessage(activeDOMWindow(state), IncludeTargetOrigin::No);</span>
<span class="udiff-line-modified-added">+     message = frame.document()-&gt;domWindow()-&gt;crossDomainAccessErrorMessage(activeDOMWindow(lexicalGlobalObject), IncludeTargetOrigin::No);</span>
      return false;
  }
  
<span class="udiff-line-modified-removed">- bool BindingSecurity::shouldAllowAccessToDOMWindow(ExecState&amp; state, DOMWindow* globalObject, String&amp; message)</span>
<span class="udiff-line-modified-added">+ bool BindingSecurity::shouldAllowAccessToDOMWindow(JSGlobalObject&amp; lexicalGlobalObject, DOMWindow* globalObject, String&amp; message)</span>
  {
<span class="udiff-line-modified-removed">-     return globalObject &amp;&amp; shouldAllowAccessToDOMWindow(state, *globalObject, message);</span>
<span class="udiff-line-modified-added">+     return globalObject &amp;&amp; shouldAllowAccessToDOMWindow(lexicalGlobalObject, *globalObject, message);</span>
  }
  
<span class="udiff-line-modified-removed">- bool BindingSecurity::shouldAllowAccessToDOMWindow(ExecState&amp; state, DOMWindow&amp; globalObject, String&amp; message)</span>
<span class="udiff-line-modified-added">+ bool BindingSecurity::shouldAllowAccessToDOMWindow(JSGlobalObject&amp; lexicalGlobalObject, DOMWindow&amp; globalObject, String&amp; message)</span>
  {
<span class="udiff-line-modified-removed">-     if (BindingSecurity::shouldAllowAccessToDOMWindow(&amp;state, globalObject, DoNotReportSecurityError))</span>
<span class="udiff-line-modified-added">+     if (BindingSecurity::shouldAllowAccessToDOMWindow(&amp;lexicalGlobalObject, globalObject, DoNotReportSecurityError))</span>
          return true;
<span class="udiff-line-modified-removed">-     message = globalObject.crossDomainAccessErrorMessage(activeDOMWindow(state), IncludeTargetOrigin::No);</span>
<span class="udiff-line-modified-added">+     message = globalObject.crossDomainAccessErrorMessage(activeDOMWindow(lexicalGlobalObject), IncludeTargetOrigin::No);</span>
      return false;
  }
  
<span class="udiff-line-modified-removed">- bool BindingSecurity::shouldAllowAccessToDOMWindow(JSC::ExecState* state, DOMWindow&amp; target, SecurityReportingOption reportingOption)</span>
<span class="udiff-line-modified-added">+ bool BindingSecurity::shouldAllowAccessToDOMWindow(JSC::JSGlobalObject* lexicalGlobalObject, DOMWindow&amp; target, SecurityReportingOption reportingOption)</span>
  {
<span class="udiff-line-modified-removed">-     return canAccessDocument(state, target.document(), reportingOption);</span>
<span class="udiff-line-modified-added">+     return canAccessDocument(lexicalGlobalObject, target.document(), reportingOption);</span>
  }
  
<span class="udiff-line-modified-removed">- bool BindingSecurity::shouldAllowAccessToDOMWindow(JSC::ExecState* state, DOMWindow* target, SecurityReportingOption reportingOption)</span>
<span class="udiff-line-modified-added">+ bool BindingSecurity::shouldAllowAccessToDOMWindow(JSC::JSGlobalObject* lexicalGlobalObject, DOMWindow* target, SecurityReportingOption reportingOption)</span>
  {
<span class="udiff-line-modified-removed">-     return target &amp;&amp; shouldAllowAccessToDOMWindow(state, *target, reportingOption);</span>
<span class="udiff-line-modified-added">+     return target &amp;&amp; shouldAllowAccessToDOMWindow(lexicalGlobalObject, *target, reportingOption);</span>
  }
  
<span class="udiff-line-modified-removed">- bool BindingSecurity::shouldAllowAccessToFrame(JSC::ExecState* state, Frame* target, SecurityReportingOption reportingOption)</span>
<span class="udiff-line-modified-added">+ bool BindingSecurity::shouldAllowAccessToFrame(JSC::JSGlobalObject* lexicalGlobalObject, Frame* target, SecurityReportingOption reportingOption)</span>
  {
<span class="udiff-line-modified-removed">-     return target &amp;&amp; canAccessDocument(state, target-&gt;document(), reportingOption);</span>
<span class="udiff-line-modified-added">+     return target &amp;&amp; canAccessDocument(lexicalGlobalObject, target-&gt;document(), reportingOption);</span>
  }
  
<span class="udiff-line-modified-removed">- bool BindingSecurity::shouldAllowAccessToNode(JSC::ExecState&amp; state, Node* target)</span>
<span class="udiff-line-modified-added">+ bool BindingSecurity::shouldAllowAccessToNode(JSC::JSGlobalObject&amp; lexicalGlobalObject, Node* target)</span>
  {
<span class="udiff-line-modified-removed">-     return !target || canAccessDocument(&amp;state, &amp;target-&gt;document(), LogSecurityError);</span>
<span class="udiff-line-modified-added">+     return !target || canAccessDocument(&amp;lexicalGlobalObject, &amp;target-&gt;document(), LogSecurityError);</span>
  }
  
  } // namespace WebCore
</pre>
<center><a href="JSDOMBindingInternals.js.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="JSDOMBindingSecurity.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>