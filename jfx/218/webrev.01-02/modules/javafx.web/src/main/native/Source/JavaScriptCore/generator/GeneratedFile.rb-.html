<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old modules/javafx.web/src/main/native/Source/JavaScriptCore/generator/GeneratedFile.rb</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 # Copyright (C) 2018 Apple Inc. All rights reserved.
  2 #
  3 # Redistribution and use in source and binary forms, with or without
  4 # modification, are permitted provided that the following conditions
  5 # are met:
  6 # 1. Redistributions of source code must retain the above copyright
  7 #    notice, this list of conditions and the following disclaimer.
  8 # 2. Redistributions in binary form must reproduce the above copyright
  9 #    notice, this list of conditions and the following disclaimer in the
 10 #    documentation and/or other materials provided with the distribution.
 11 #
 12 # THIS SOFTWARE IS PROVIDED BY APPLE INC. AND ITS CONTRIBUTORS ``AS IS&#39;&#39;
 13 # AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 14 # THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 15 # PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS
 16 # BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 17 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 18 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 19 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 20 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 21 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 22 # THE POSSIBILITY OF SUCH DAMAGE.
 23 
 24 require &#39;date&#39;
 25 require &#39;digest&#39;
 26 
 27 $LICENSE = &lt;&lt;-EOF
 28 Copyright (C) #{Date.today.year} Apple Inc. All rights reserved.
 29 
 30 Redistribution and use in source and binary forms, with or without
 31 modification, are permitted provided that the following conditions
 32 are met:
 33 
 34 1.  Redistributions of source code must retain the above copyright
 35     notice, this list of conditions and the following disclaimer.
 36 2.  Redistributions in binary form must reproduce the above copyright
 37     notice, this list of conditions and the following disclaimer in the
 38     documentation and/or other materials provided with the distribution.
 39 
 40 THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS &quot;AS IS&quot; AND ANY
 41 EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 42 WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 43 DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
 44 DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 45 (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 46 LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 47 ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 48 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 49 THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 50 EOF
 51 
 52 module GeneratedFile
 53     class Template &lt; Struct.new(:multiline_comment, :line_comment, :prefix, :suffix, :body)
 54         def initialize
 55             super([&quot;/*&quot;, &quot; *&quot;, &quot;*/&quot;], &quot;// &quot;, nil, nil, nil)
 56         end
 57     end
 58 
 59     def self.create(filename, dependency)
 60         template = Template.new
 61         yield template
 62 
 63         file = File.open(filename, &quot;w&quot;)
 64         self.sha1(file, template, dependency)
 65         self.license(file, template, dependency)
 66 
 67         unless template.prefix.nil?
 68             write(file, template.prefix.to_s, &quot;\n&quot;)
 69         end
 70         unless template.body.nil?
 71             write(file, template.body.to_s, &quot;\n&quot;)
 72         end
 73         unless template.suffix.nil?
 74             write(file, template.suffix.to_s, &quot;\n&quot;)
 75         end
 76     end
 77 
 78     def self.sha1(file, template, dependency)
 79         write(file, template.line_comment, &quot; SHA1Hash: &quot;, Digest::SHA1.hexdigest(dependency.read), &quot;\n&quot;)
 80     end
 81 
 82     def self.license(file, template, dependency)
 83         unless template.multiline_comment.nil?
 84             write(file, template.multiline_comment[0], &quot;\n&quot;)
 85         end
 86 
 87         comment = if template.multiline_comment.nil? then template.line_comment else template.multiline_comment[1] end
 88         write(file, $LICENSE.strip.split(&quot;\n&quot;).map { |line| &quot;#{comment} #{line}&quot; }.join(&quot;\n&quot;), &quot;\n\n&quot;)
 89         write(file, comment, &quot; Autogenerated from &quot;, dependency.path, &quot;, do not modify.\n&quot;)
 90 
 91         unless template.multiline_comment.nil?
 92             write(file, template.multiline_comment[2], &quot;\n&quot;)
 93         end
 94 
 95         write(file, &quot;\n&quot;)
 96     end
 97 
 98     def self.write(file, *strings)
 99         file.write(strings.map(&amp;:to_s).join)
100     end
101 end
102 
    </pre>
  </body>
</html>