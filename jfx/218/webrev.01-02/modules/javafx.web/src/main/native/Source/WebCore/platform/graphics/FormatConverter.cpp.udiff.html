<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/FormatConverter.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="FontTaggedSettings.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="FormatConverter.h.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/FormatConverter.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -25,16 +25,16 @@</span>
   * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
   */
  
  #include &quot;config.h&quot;
  
<span class="udiff-line-modified-removed">- #if ENABLE(GRAPHICS_CONTEXT_3D)</span>
<span class="udiff-line-modified-added">+ #if ENABLE(GRAPHICS_CONTEXT_GL)</span>
  
  #include &quot;FormatConverter.h&quot;
  
  #if HAVE(ARM_NEON_INTRINSICS)
<span class="udiff-line-modified-removed">- #include &quot;GraphicsContext3DNEON.h&quot;</span>
<span class="udiff-line-modified-added">+ #include &quot;GraphicsContextGLNEON.h&quot;</span>
  #endif
  
  #if USE(ACCELERATE)
  #include &lt;Accelerate/Accelerate.h&gt;
  #endif
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -171,17 +171,17 @@</span>
  // Explicit template specializations correspond to the cases that would occur.
  // Some code are merged back from Mozilla code in http://mxr.mozilla.org/mozilla-central/source/content/canvas/src/WebGLTexelConversions.h
  
  //----------------------------------------------------------------------
  // Pixel unpacking routines.
<span class="udiff-line-modified-removed">- template&lt;int format, typename SourceType, typename DstType&gt;</span>
<span class="udiff-line-modified-added">+ template&lt;GraphicsContextGL::DataFormat format, typename SourceType, typename DstType&gt;</span>
  ALWAYS_INLINE void unpack(const SourceType*, DstType*, unsigned)
  {
      ASSERT_NOT_REACHED();
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatRGB8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::RGB8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[0];
          destination[1] = source[1];
          destination[2] = source[2];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -189,11 +189,11 @@</span>
          source += 3;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatBGR8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::BGR8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[2];
          destination[1] = source[1];
          destination[2] = source[0];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -201,11 +201,11 @@</span>
          source += 3;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatARGB8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::ARGB8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[1];
          destination[1] = source[2];
          destination[2] = source[3];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -213,11 +213,11 @@</span>
          source += 4;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatABGR8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::ABGR8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[3];
          destination[1] = source[2];
          destination[2] = source[1];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -225,11 +225,11 @@</span>
          source += 4;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatBGRA8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::BGRA8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      const uint32_t* source32 = reinterpret_cast_ptr&lt;const uint32_t*&gt;(source);
      uint32_t* destination32 = reinterpret_cast_ptr&lt;uint32_t*&gt;(destination);
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          uint32_t bgra = source32[i];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -243,11 +243,11 @@</span>
          uint32_t rgba = (((bgra &gt;&gt; 16) | (bgra &lt;&lt; 16)) &amp; brMask) | (bgra &amp; gaMask);
          destination32[i] = rgba;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatRGBA5551, uint16_t, uint8_t&gt;(const uint16_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::RGBA5551, uint16_t, uint8_t&gt;(const uint16_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
  #if HAVE(ARM_NEON_INTRINSICS)
      SIMD::unpackOneRowOfRGBA5551ToRGBA8(source, destination, pixelsPerRow);
  #endif
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -262,11 +262,11 @@</span>
          source += 1;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatRGBA4444, uint16_t, uint8_t&gt;(const uint16_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::RGBA4444, uint16_t, uint8_t&gt;(const uint16_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
  #if HAVE(ARM_NEON_INTRINSICS)
      SIMD::unpackOneRowOfRGBA4444ToRGBA8(source, destination, pixelsPerRow);
  #endif
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -282,11 +282,11 @@</span>
          source += 1;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatRGB565, uint16_t, uint8_t&gt;(const uint16_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::RGB565, uint16_t, uint8_t&gt;(const uint16_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
  #if HAVE(ARM_NEON_INTRINSICS)
      SIMD::unpackOneRowOfRGB565ToRGBA8(source, destination, pixelsPerRow);
  #endif
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -301,11 +301,11 @@</span>
          source += 1;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatR8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::R8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[0];
          destination[1] = source[0];
          destination[2] = source[0];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -313,11 +313,11 @@</span>
          source += 1;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatRA8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::RA8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[0];
          destination[1] = source[0];
          destination[2] = source[0];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -325,11 +325,11 @@</span>
          source += 2;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatAR8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::AR8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[1];
          destination[1] = source[1];
          destination[2] = source[1];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -337,11 +337,11 @@</span>
          source += 2;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatA8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::A8, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = 0x0;
          destination[1] = 0x0;
          destination[2] = 0x0;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -349,11 +349,11 @@</span>
          source += 1;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatRGBA8, uint8_t, float&gt;(const uint8_t* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::RGBA8, uint8_t, float&gt;(const uint8_t* source, float* destination, unsigned pixelsPerRow)</span>
  {
      const float scaleFactor = 1.0f / 255.0f;
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[0] * scaleFactor;
          destination[1] = source[1] * scaleFactor;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -362,11 +362,11 @@</span>
          source += 4;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatBGRA8, uint8_t, float&gt;(const uint8_t* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::BGRA8, uint8_t, float&gt;(const uint8_t* source, float* destination, unsigned pixelsPerRow)</span>
  {
      const float scaleFactor = 1.0f / 255.0f;
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[2] * scaleFactor;
          destination[1] = source[1] * scaleFactor;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -375,11 +375,11 @@</span>
          source += 4;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatABGR8, uint8_t, float&gt;(const uint8_t* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::ABGR8, uint8_t, float&gt;(const uint8_t* source, float* destination, unsigned pixelsPerRow)</span>
  {
      const float scaleFactor = 1.0f / 255.0f;
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[3] * scaleFactor;
          destination[1] = source[2] * scaleFactor;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -388,11 +388,11 @@</span>
          source += 4;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatARGB8, uint8_t, float&gt;(const uint8_t* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::ARGB8, uint8_t, float&gt;(const uint8_t* source, float* destination, unsigned pixelsPerRow)</span>
  {
      const float scaleFactor = 1.0f / 255.0f;
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[1] * scaleFactor;
          destination[1] = source[2] * scaleFactor;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -401,11 +401,11 @@</span>
          source += 4;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatRGB8, uint8_t, float&gt;(const uint8_t* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::RGB8, uint8_t, float&gt;(const uint8_t* source, float* destination, unsigned pixelsPerRow)</span>
  {
      const float scaleFactor = 1.0f / 255.0f;
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[0] * scaleFactor;
          destination[1] = source[1] * scaleFactor;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -414,11 +414,11 @@</span>
          source += 3;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatBGR8, uint8_t, float&gt;(const uint8_t* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::BGR8, uint8_t, float&gt;(const uint8_t* source, float* destination, unsigned pixelsPerRow)</span>
  {
      const float scaleFactor = 1.0f / 255.0f;
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[2] * scaleFactor;
          destination[1] = source[1] * scaleFactor;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -427,11 +427,11 @@</span>
          source += 3;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatRGB32F, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::RGB32F, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[0];
          destination[1] = source[1];
          destination[2] = source[2];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -439,11 +439,11 @@</span>
          source += 3;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatR32F, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::R32F, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[0];
          destination[1] = source[0];
          destination[2] = source[0];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -451,11 +451,11 @@</span>
          source += 1;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatRA32F, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::RA32F, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[0];
          destination[1] = source[0];
          destination[2] = source[0];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -463,11 +463,11 @@</span>
          source += 2;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContext3D::DataFormatA32F, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void unpack&lt;GraphicsContextGL::DataFormat::A32F, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = 0;
          destination[1] = 0;
          destination[2] = 0;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -479,35 +479,35 @@</span>
  
  //----------------------------------------------------------------------
  // Pixel packing routines.
  //
  
<span class="udiff-line-modified-removed">- template&lt;int format, int alphaOp, typename SourceType, typename DstType&gt;</span>
<span class="udiff-line-modified-added">+ template&lt;GraphicsContextGL::DataFormat format, int alphaOp, typename SourceType, typename DstType&gt;</span>
  ALWAYS_INLINE void pack(const SourceType*, DstType*, unsigned)
  {
      ASSERT_NOT_REACHED();
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatA8, GraphicsContext3D::AlphaDoNothing, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::A8, GraphicsContextGL::AlphaOp::DoNothing, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[3];
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatR8, GraphicsContext3D::AlphaDoNothing, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::R8, GraphicsContextGL::AlphaOp::DoNothing, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[0];
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatR8, GraphicsContext3D::AlphaDoPremultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::R8, GraphicsContextGL::AlphaOp::DoPremultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] / 255.0f;
          uint8_t sourceR = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[0]) * scaleFactor);
          destination[0] = sourceR;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -515,32 +515,32 @@</span>
          destination += 1;
      }
  }
  
  // FIXME: this routine is lossy and must be removed.
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatR8, GraphicsContext3D::AlphaDoUnmultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::R8, GraphicsContextGL::AlphaOp::DoUnmultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 255.0f / source[3] : 1.0f;
          uint8_t sourceR = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[0]) * scaleFactor);
          destination[0] = sourceR;
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRA8, GraphicsContext3D::AlphaDoNothing, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RA8, GraphicsContextGL::AlphaOp::DoNothing, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[0];
          destination[1] = source[3];
          source += 4;
          destination += 2;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRA8, GraphicsContext3D::AlphaDoPremultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RA8, GraphicsContextGL::AlphaOp::DoPremultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] / 255.0f;
          uint8_t sourceR = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[0]) * scaleFactor);
          destination[0] = sourceR;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -549,11 +549,11 @@</span>
          destination += 2;
      }
  }
  
  // FIXME: this routine is lossy and must be removed.
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRA8, GraphicsContext3D::AlphaDoUnmultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RA8, GraphicsContextGL::AlphaOp::DoUnmultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 255.0f / source[3] : 1.0f;
          uint8_t sourceR = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[0]) * scaleFactor);
          destination[0] = sourceR;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -561,22 +561,22 @@</span>
          source += 4;
          destination += 2;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGB8, GraphicsContext3D::AlphaDoNothing, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGB8, GraphicsContextGL::AlphaOp::DoNothing, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[0];
          destination[1] = source[1];
          destination[2] = source[2];
          source += 4;
          destination += 3;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGB8, GraphicsContext3D::AlphaDoPremultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGB8, GraphicsContextGL::AlphaOp::DoPremultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] / 255.0f;
          uint8_t sourceR = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[0]) * scaleFactor);
          uint8_t sourceG = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[1]) * scaleFactor);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -588,11 +588,11 @@</span>
          destination += 3;
      }
  }
  
  // FIXME: this routine is lossy and must be removed.
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGB8, GraphicsContext3D::AlphaDoUnmultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGB8, GraphicsContextGL::AlphaOp::DoUnmultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 255.0f / source[3] : 1.0f;
          uint8_t sourceR = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[0]) * scaleFactor);
          uint8_t sourceG = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[1]) * scaleFactor);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -604,16 +604,16 @@</span>
          destination += 3;
      }
  }
  
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA8, GraphicsContext3D::AlphaDoNothing, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA8, GraphicsContextGL::AlphaOp::DoNothing, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      memcpy(destination, source, pixelsPerRow * 4);
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA8, GraphicsContext3D::AlphaDoPremultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA8, GraphicsContextGL::AlphaOp::DoPremultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] / 255.0f;
          uint8_t sourceR = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[0]) * scaleFactor);
          uint8_t sourceG = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[1]) * scaleFactor);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -626,11 +626,11 @@</span>
          destination += 4;
      }
  }
  
  // FIXME: this routine is lossy and must be removed.
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA8, GraphicsContext3D::AlphaDoUnmultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA8, GraphicsContextGL::AlphaOp::DoUnmultiply, uint8_t, uint8_t&gt;(const uint8_t* source, uint8_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 255.0f / source[3] : 1.0f;
          uint8_t sourceR = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[0]) * scaleFactor);
          uint8_t sourceG = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[1]) * scaleFactor);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -642,11 +642,11 @@</span>
          source += 4;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA4444, GraphicsContext3D::AlphaDoNothing, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA4444, GraphicsContextGL::AlphaOp::DoNothing, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
  #if HAVE(ARM_NEON_INTRINSICS)
      SIMD::packOneRowOfRGBA8ToUnsignedShort4444(source, destination, pixelsPerRow);
  #endif
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -657,11 +657,11 @@</span>
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA4444, GraphicsContext3D::AlphaDoPremultiply, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA4444, GraphicsContextGL::AlphaOp::DoPremultiply, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] / 255.0f;
          uint8_t sourceR = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[0]) * scaleFactor);
          uint8_t sourceG = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[1]) * scaleFactor);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -674,11 +674,11 @@</span>
          destination += 1;
      }
  }
  
  // FIXME: this routine is lossy and must be removed.
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA4444, GraphicsContext3D::AlphaDoUnmultiply, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA4444, GraphicsContextGL::AlphaOp::DoUnmultiply, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 255.0f / source[3] : 1.0f;
          uint8_t sourceR = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[0]) * scaleFactor);
          uint8_t sourceG = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[1]) * scaleFactor);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -690,11 +690,11 @@</span>
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA5551, GraphicsContext3D::AlphaDoNothing, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA5551, GraphicsContextGL::AlphaOp::DoNothing, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
  #if HAVE(ARM_NEON_INTRINSICS)
      SIMD::packOneRowOfRGBA8ToUnsignedShort5551(source, destination, pixelsPerRow);
  #endif
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -705,11 +705,11 @@</span>
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA5551, GraphicsContext3D::AlphaDoPremultiply, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA5551, GraphicsContextGL::AlphaOp::DoPremultiply, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] / 255.0f;
          uint8_t sourceR = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[0]) * scaleFactor);
          uint8_t sourceG = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[1]) * scaleFactor);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -722,11 +722,11 @@</span>
          destination += 1;
      }
  }
  
  // FIXME: this routine is lossy and must be removed.
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA5551, GraphicsContext3D::AlphaDoUnmultiply, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA5551, GraphicsContextGL::AlphaOp::DoUnmultiply, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 255.0f / source[3] : 1.0f;
          uint8_t sourceR = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[0]) * scaleFactor);
          uint8_t sourceG = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[1]) * scaleFactor);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -738,11 +738,11 @@</span>
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGB565, GraphicsContext3D::AlphaDoNothing, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGB565, GraphicsContextGL::AlphaOp::DoNothing, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
  #if HAVE(ARM_NEON_INTRINSICS)
      SIMD::packOneRowOfRGBA8ToUnsignedShort565(source, destination, pixelsPerRow);
  #endif
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -752,11 +752,11 @@</span>
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGB565, GraphicsContext3D::AlphaDoPremultiply, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGB565, GraphicsContextGL::AlphaOp::DoPremultiply, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] / 255.0f;
          uint8_t sourceR = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[0]) * scaleFactor);
          uint8_t sourceG = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[1]) * scaleFactor);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -768,11 +768,11 @@</span>
          destination += 1;
      }
  }
  
  // FIXME: this routine is lossy and must be removed.
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGB565, GraphicsContext3D::AlphaDoUnmultiply, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGB565, GraphicsContextGL::AlphaOp::DoUnmultiply, uint8_t, uint16_t&gt;(const uint8_t* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 255.0f / source[3] : 1.0f;
          uint8_t sourceR = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[0]) * scaleFactor);
          uint8_t sourceG = static_cast&lt;uint8_t&gt;(static_cast&lt;float&gt;(source[1]) * scaleFactor);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -783,22 +783,22 @@</span>
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGB32F, GraphicsContext3D::AlphaDoNothing, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGB32F, GraphicsContextGL::AlphaOp::DoNothing, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[0];
          destination[1] = source[1];
          destination[2] = source[2];
          source += 4;
          destination += 3;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGB32F, GraphicsContext3D::AlphaDoPremultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGB32F, GraphicsContextGL::AlphaOp::DoPremultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3];
          destination[0] = source[0] * scaleFactor;
          destination[1] = source[1] * scaleFactor;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -806,11 +806,11 @@</span>
          source += 4;
          destination += 3;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGB32F, GraphicsContext3D::AlphaDoUnmultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGB32F, GraphicsContextGL::AlphaOp::DoUnmultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 1.0f / source[3] : 1.0f;
          destination[0] = source[0] * scaleFactor;
          destination[1] = source[1] * scaleFactor;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -819,16 +819,16 @@</span>
          destination += 3;
      }
  }
  
  // Used only during RGBA8 or BGRA8 -&gt; floating-point uploads.
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA32F, GraphicsContext3D::AlphaDoNothing, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA32F, GraphicsContextGL::AlphaOp::DoNothing, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      memcpy(destination, source, pixelsPerRow * 4 * sizeof(float));
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA32F, GraphicsContext3D::AlphaDoPremultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA32F, GraphicsContextGL::AlphaOp::DoPremultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3];
          destination[0] = source[0] * scaleFactor;
          destination[1] = source[1] * scaleFactor;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -837,11 +837,11 @@</span>
          source += 4;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA32F, GraphicsContext3D::AlphaDoUnmultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA32F, GraphicsContextGL::AlphaOp::DoUnmultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 1.0f / source[3] : 1.0f;
          destination[0] = source[0] * scaleFactor;
          destination[1] = source[1] * scaleFactor;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -850,81 +850,81 @@</span>
          source += 4;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatA32F, GraphicsContext3D::AlphaDoNothing, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::A32F, GraphicsContextGL::AlphaOp::DoNothing, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[3];
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatR32F, GraphicsContext3D::AlphaDoNothing, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::R32F, GraphicsContextGL::AlphaOp::DoNothing, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[0];
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatR32F, GraphicsContext3D::AlphaDoPremultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::R32F, GraphicsContextGL::AlphaOp::DoPremultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3];
          destination[0] = source[0] * scaleFactor;
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatR32F, GraphicsContext3D::AlphaDoUnmultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::R32F, GraphicsContextGL::AlphaOp::DoUnmultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 1.0f / source[3] : 1.0f;
          destination[0] = source[0] * scaleFactor;
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRA32F, GraphicsContext3D::AlphaDoNothing, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RA32F, GraphicsContextGL::AlphaOp::DoNothing, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = source[0];
          destination[1] = source[3];
          source += 4;
          destination += 2;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRA32F, GraphicsContext3D::AlphaDoPremultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RA32F, GraphicsContextGL::AlphaOp::DoPremultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3];
          destination[0] = source[0] * scaleFactor;
          destination[1] = source[3];
          source += 4;
          destination += 2;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRA32F, GraphicsContext3D::AlphaDoUnmultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RA32F, GraphicsContextGL::AlphaOp::DoUnmultiply, float, float&gt;(const float* source, float* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned int i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 1.0f / source[3] : 1.0f;
          destination[0] = source[0] * scaleFactor;
          destination[1] = source[3];
          source += 4;
          destination += 2;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA16F, GraphicsContext3D::AlphaDoNothing, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA16F, GraphicsContextGL::AlphaOp::DoNothing, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = convertFloatToHalfFloat(source[0]);
          destination[1] = convertFloatToHalfFloat(source[1]);
          destination[2] = convertFloatToHalfFloat(source[2]);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -932,11 +932,11 @@</span>
          source += 4;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA16F, GraphicsContext3D::AlphaDoPremultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA16F, GraphicsContextGL::AlphaOp::DoPremultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3];
          destination[0] = convertFloatToHalfFloat(source[0] * scaleFactor);
          destination[1] = convertFloatToHalfFloat(source[1] * scaleFactor);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -945,11 +945,11 @@</span>
          source += 4;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGBA16F, GraphicsContext3D::AlphaDoUnmultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGBA16F, GraphicsContextGL::AlphaOp::DoUnmultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 1.0f / source[3] : 1.0f;
          destination[0] = convertFloatToHalfFloat(source[0] * scaleFactor);
          destination[1] = convertFloatToHalfFloat(source[1] * scaleFactor);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -958,22 +958,22 @@</span>
          source += 4;
          destination += 4;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGB16F, GraphicsContext3D::AlphaDoNothing, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGB16F, GraphicsContextGL::AlphaOp::DoNothing, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = convertFloatToHalfFloat(source[0]);
          destination[1] = convertFloatToHalfFloat(source[1]);
          destination[2] = convertFloatToHalfFloat(source[2]);
          source += 4;
          destination += 3;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGB16F, GraphicsContext3D::AlphaDoPremultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGB16F, GraphicsContextGL::AlphaOp::DoPremultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3];
          destination[0] = convertFloatToHalfFloat(source[0] * scaleFactor);
          destination[1] = convertFloatToHalfFloat(source[1] * scaleFactor);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -981,11 +981,11 @@</span>
          source += 4;
          destination += 3;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRGB16F, GraphicsContext3D::AlphaDoUnmultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RGB16F, GraphicsContextGL::AlphaOp::DoUnmultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 1.0f / source[3] : 1.0f;
          destination[0] = convertFloatToHalfFloat(source[0] * scaleFactor);
          destination[1] = convertFloatToHalfFloat(source[1] * scaleFactor);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -993,256 +993,256 @@</span>
          source += 4;
          destination += 3;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRA16F, GraphicsContext3D::AlphaDoNothing, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RA16F, GraphicsContextGL::AlphaOp::DoNothing, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = convertFloatToHalfFloat(source[0]);
          destination[1] = convertFloatToHalfFloat(source[3]);
          source += 4;
          destination += 2;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRA16F, GraphicsContext3D::AlphaDoPremultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RA16F, GraphicsContextGL::AlphaOp::DoPremultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3];
          destination[0] = convertFloatToHalfFloat(source[0] * scaleFactor);
          destination[1] = convertFloatToHalfFloat(source[3]);
          source += 4;
          destination += 2;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatRA16F, GraphicsContext3D::AlphaDoUnmultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::RA16F, GraphicsContextGL::AlphaOp::DoUnmultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 1.0f / source[3] : 1.0f;
          destination[0] = convertFloatToHalfFloat(source[0] * scaleFactor);
          destination[1] = convertFloatToHalfFloat(source[3]);
          source += 4;
          destination += 2;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatR16F, GraphicsContext3D::AlphaDoNothing, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::R16F, GraphicsContextGL::AlphaOp::DoNothing, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = convertFloatToHalfFloat(source[0]);
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatR16F, GraphicsContext3D::AlphaDoPremultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::R16F, GraphicsContextGL::AlphaOp::DoPremultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3];
          destination[0] = convertFloatToHalfFloat(source[0] * scaleFactor);
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatR16F, GraphicsContext3D::AlphaDoUnmultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::R16F, GraphicsContextGL::AlphaOp::DoUnmultiply, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          float scaleFactor = source[3] ? 1.0f / source[3] : 1.0f;
          destination[0] = convertFloatToHalfFloat(source[0] * scaleFactor);
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContext3D::DataFormatA16F, GraphicsContext3D::AlphaDoNothing, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; ALWAYS_INLINE void pack&lt;GraphicsContextGL::DataFormat::A16F, GraphicsContextGL::AlphaOp::DoNothing, float, uint16_t&gt;(const float* source, uint16_t* destination, unsigned pixelsPerRow)</span>
  {
      for (unsigned i = 0; i &lt; pixelsPerRow; ++i) {
          destination[0] = convertFloatToHalfFloat(source[3]);
          source += 4;
          destination += 1;
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;int Format&gt;</span>
<span class="udiff-line-modified-added">+ template&lt;GraphicsContextGL::DataFormat Format&gt;</span>
  struct IsFloatFormat {
      static const bool Value =
<span class="udiff-line-modified-removed">-         Format == GraphicsContext3D::DataFormatRGBA32F</span>
<span class="udiff-line-modified-removed">-         || Format == GraphicsContext3D::DataFormatRGB32F</span>
<span class="udiff-line-modified-removed">-         || Format == GraphicsContext3D::DataFormatRA32F</span>
<span class="udiff-line-modified-removed">-         || Format == GraphicsContext3D::DataFormatR32F</span>
<span class="udiff-line-modified-removed">-         || Format == GraphicsContext3D::DataFormatA32F;</span>
<span class="udiff-line-modified-added">+         Format == GraphicsContextGL::DataFormat::RGBA32F</span>
<span class="udiff-line-modified-added">+         || Format == GraphicsContextGL::DataFormat::RGB32F</span>
<span class="udiff-line-modified-added">+         || Format == GraphicsContextGL::DataFormat::RA32F</span>
<span class="udiff-line-modified-added">+         || Format == GraphicsContextGL::DataFormat::R32F</span>
<span class="udiff-line-modified-added">+         || Format == GraphicsContextGL::DataFormat::A32F;</span>
  };
  
<span class="udiff-line-modified-removed">- template&lt;int Format&gt;</span>
<span class="udiff-line-modified-added">+ template&lt;GraphicsContextGL::DataFormat Format&gt;</span>
  struct IsHalfFloatFormat {
      static const bool Value =
<span class="udiff-line-modified-removed">-         Format == GraphicsContext3D::DataFormatRGBA16F</span>
<span class="udiff-line-modified-removed">-         || Format == GraphicsContext3D::DataFormatRGB16F</span>
<span class="udiff-line-modified-removed">-         || Format == GraphicsContext3D::DataFormatRA16F</span>
<span class="udiff-line-modified-removed">-         || Format == GraphicsContext3D::DataFormatR16F</span>
<span class="udiff-line-modified-removed">-         || Format == GraphicsContext3D::DataFormatA16F;</span>
<span class="udiff-line-modified-added">+         Format == GraphicsContextGL::DataFormat::RGBA16F</span>
<span class="udiff-line-modified-added">+         || Format == GraphicsContextGL::DataFormat::RGB16F</span>
<span class="udiff-line-modified-added">+         || Format == GraphicsContextGL::DataFormat::RA16F</span>
<span class="udiff-line-modified-added">+         || Format == GraphicsContextGL::DataFormat::R16F</span>
<span class="udiff-line-modified-added">+         || Format == GraphicsContextGL::DataFormat::A16F;</span>
  };
  
<span class="udiff-line-modified-removed">- template&lt;int Format&gt;</span>
<span class="udiff-line-modified-added">+ template&lt;GraphicsContextGL::DataFormat Format&gt;</span>
  struct Is16bppFormat {
      static const bool Value =
<span class="udiff-line-modified-removed">-         Format == GraphicsContext3D::DataFormatRGBA5551</span>
<span class="udiff-line-modified-removed">-         || Format == GraphicsContext3D::DataFormatRGBA4444</span>
<span class="udiff-line-modified-removed">-         || Format == GraphicsContext3D::DataFormatRGB565;</span>
<span class="udiff-line-modified-added">+         Format == GraphicsContextGL::DataFormat::RGBA5551</span>
<span class="udiff-line-modified-added">+         || Format == GraphicsContextGL::DataFormat::RGBA4444</span>
<span class="udiff-line-modified-added">+         || Format == GraphicsContextGL::DataFormat::RGB565;</span>
  };
  
<span class="udiff-line-modified-removed">- template&lt;int Format, bool IsFloat = IsFloatFormat&lt;Format&gt;::Value, bool IsHalfFloat = IsHalfFloatFormat&lt;Format&gt;::Value, bool Is16bpp = Is16bppFormat&lt;Format&gt;::Value&gt;</span>
<span class="udiff-line-modified-added">+ template&lt;GraphicsContextGL::DataFormat Format, bool IsFloat = IsFloatFormat&lt;Format&gt;::Value, bool IsHalfFloat = IsHalfFloatFormat&lt;Format&gt;::Value, bool Is16bpp = Is16bppFormat&lt;Format&gt;::Value&gt;</span>
  struct DataTypeForFormat {
      typedef uint8_t Type;
  };
  
<span class="udiff-line-modified-removed">- template&lt;int Format&gt;</span>
<span class="udiff-line-modified-added">+ template&lt;GraphicsContextGL::DataFormat Format&gt;</span>
  struct DataTypeForFormat&lt;Format, true, false, false&gt; {
      typedef float Type;
  };
  
<span class="udiff-line-modified-removed">- template&lt;int Format&gt;</span>
<span class="udiff-line-modified-added">+ template&lt;GraphicsContextGL::DataFormat Format&gt;</span>
  struct DataTypeForFormat&lt;Format, false, true, false&gt; {
      typedef uint16_t Type;
  };
  
<span class="udiff-line-modified-removed">- template&lt;int Format&gt;</span>
<span class="udiff-line-modified-added">+ template&lt;GraphicsContextGL::DataFormat Format&gt;</span>
  struct DataTypeForFormat&lt;Format, false, false, true&gt; {
      typedef uint16_t Type;
  };
  
<span class="udiff-line-modified-removed">- template&lt;int Format&gt;</span>
<span class="udiff-line-modified-added">+ template&lt;GraphicsContextGL::DataFormat Format&gt;</span>
  struct IntermediateFormat {
<span class="udiff-line-modified-removed">-     static const int Value = (IsFloatFormat&lt;Format&gt;::Value || IsHalfFloatFormat&lt;Format&gt;::Value) ? GraphicsContext3D::DataFormatRGBA32F : GraphicsContext3D::DataFormatRGBA8;</span>
<span class="udiff-line-modified-added">+     static const GraphicsContextGL::DataFormat Value = (IsFloatFormat&lt;Format&gt;::Value || IsHalfFloatFormat&lt;Format&gt;::Value) ? GraphicsContextGL::DataFormat::RGBA32F : GraphicsContextGL::DataFormat::RGBA8;</span>
  };
  
  
  /* END CODE SHARED WITH MOZILLA FIREFOX */
  
<span class="udiff-line-modified-removed">- void FormatConverter::convert(GraphicsContext3D::DataFormat srcFormat, GraphicsContext3D::DataFormat dstFormat, GraphicsContext3D::AlphaOp alphaOp)</span>
<span class="udiff-line-modified-added">+ void FormatConverter::convert(GraphicsContextGL::DataFormat srcFormat, GraphicsContextGL::DataFormat dstFormat, GraphicsContextGL::AlphaOp alphaOp)</span>
  {
  #define FORMATCONVERTER_CASE_SRCFORMAT(SrcFormat) \
      case SrcFormat: \
          return convert&lt;SrcFormat&gt;(dstFormat, alphaOp);
  
          switch (srcFormat) {
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatR8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatA8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatR32F)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatA32F)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatRA8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatRA32F)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatRGB8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatBGR8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatRGB565)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatRGB32F)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatRGBA8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatARGB8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatABGR8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatAR8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatBGRA8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatRGBA5551)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatRGBA4444)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContext3D::DataFormatRGBA32F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::R8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::A8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::R32F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::A32F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::RA8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::RA32F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::RGB8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::BGR8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::RGB565)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::RGB32F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::RGBA8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::ARGB8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::ABGR8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::AR8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::BGRA8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::RGBA5551)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::RGBA4444)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_SRCFORMAT(GraphicsContextGL::DataFormat::RGBA32F)</span>
          default:
              ASSERT_NOT_REACHED();
          }
  #undef FORMATCONVERTER_CASE_SRCFORMAT
  }
  
<span class="udiff-line-modified-removed">- template&lt;GraphicsContext3D::DataFormat SrcFormat&gt;</span>
<span class="udiff-line-modified-removed">- ALWAYS_INLINE void FormatConverter::convert(GraphicsContext3D::DataFormat dstFormat, GraphicsContext3D::AlphaOp alphaOp)</span>
<span class="udiff-line-modified-added">+ template&lt;GraphicsContextGL::DataFormat SrcFormat&gt;</span>
<span class="udiff-line-modified-added">+ ALWAYS_INLINE void FormatConverter::convert(GraphicsContextGL::DataFormat dstFormat, GraphicsContextGL::AlphaOp alphaOp)</span>
  {
  #define FORMATCONVERTER_CASE_DSTFORMAT(DstFormat) \
      case DstFormat: \
          return convert&lt;SrcFormat, DstFormat&gt;(alphaOp);
  
          switch (dstFormat) {
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatR8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatR16F)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatR32F)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatA8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatA16F)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatA32F)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatRA8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatRA16F)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatRA32F)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatRGB8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatRGB565)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatRGB16F)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatRGB32F)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatRGBA8)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatRGBA5551)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatRGBA4444)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatRGBA16F)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContext3D::DataFormatRGBA32F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::R8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::R16F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::R32F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::A8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::A16F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::A32F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::RA8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::RA16F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::RA32F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::RGB8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::RGB565)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::RGB16F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::RGB32F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::RGBA8)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::RGBA5551)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::RGBA4444)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::RGBA16F)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_DSTFORMAT(GraphicsContextGL::DataFormat::RGBA32F)</span>
          default:
              ASSERT_NOT_REACHED();
          }
  
  #undef FORMATCONVERTER_CASE_DSTFORMAT
  }
  
<span class="udiff-line-modified-removed">- template&lt;GraphicsContext3D::DataFormat SrcFormat, GraphicsContext3D::DataFormat DstFormat&gt;</span>
<span class="udiff-line-modified-removed">- ALWAYS_INLINE void FormatConverter::convert(GraphicsContext3D::AlphaOp alphaOp)</span>
<span class="udiff-line-modified-added">+ template&lt;GraphicsContextGL::DataFormat SrcFormat, GraphicsContextGL::DataFormat DstFormat&gt;</span>
<span class="udiff-line-modified-added">+ ALWAYS_INLINE void FormatConverter::convert(GraphicsContextGL::AlphaOp alphaOp)</span>
  {
  #define FORMATCONVERTER_CASE_ALPHAOP(alphaOp) \
      case alphaOp: \
          return convert&lt;SrcFormat, DstFormat, alphaOp&gt;();
  
          switch (alphaOp) {
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_ALPHAOP(GraphicsContext3D::AlphaDoNothing)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_ALPHAOP(GraphicsContext3D::AlphaDoPremultiply)</span>
<span class="udiff-line-modified-removed">-             FORMATCONVERTER_CASE_ALPHAOP(GraphicsContext3D::AlphaDoUnmultiply)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_ALPHAOP(GraphicsContextGL::AlphaOp::DoNothing)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_ALPHAOP(GraphicsContextGL::AlphaOp::DoPremultiply)</span>
<span class="udiff-line-modified-added">+             FORMATCONVERTER_CASE_ALPHAOP(GraphicsContextGL::AlphaOp::DoUnmultiply)</span>
          default:
              ASSERT_NOT_REACHED();
          }
  #undef FORMATCONVERTER_CASE_ALPHAOP
  }
  
  // Visual Studio crashes with a C1063 Fatal Error if everything is inlined.
<span class="udiff-line-modified-removed">- template&lt;GraphicsContext3D::DataFormat SrcFormat, GraphicsContext3D::DataFormat DstFormat, GraphicsContext3D::AlphaOp alphaOp&gt;</span>
<span class="udiff-line-modified-added">+ template&lt;GraphicsContextGL::DataFormat SrcFormat, GraphicsContextGL::DataFormat DstFormat, GraphicsContextGL::AlphaOp alphaOp&gt;</span>
  ALWAYS_INLINE_EXCEPT_MSVC void FormatConverter::convert()
  {
      // Many instantiations of this template function will never be entered, so we try
      // to return immediately in these cases to avoid the compiler to generate useless code.
<span class="udiff-line-modified-removed">-     if (SrcFormat == DstFormat &amp;&amp; alphaOp == GraphicsContext3D::AlphaDoNothing) {</span>
<span class="udiff-line-modified-added">+     if (SrcFormat == DstFormat &amp;&amp; alphaOp == GraphicsContextGL::AlphaOp::DoNothing) {</span>
          ASSERT_NOT_REACHED();
          return;
      }
      if (!IsFloatFormat&lt;DstFormat&gt;::Value &amp;&amp; IsFloatFormat&lt;SrcFormat&gt;::Value) {
          ASSERT_NOT_REACHED();
          return;
      }
  
      // Only textures uploaded from DOM elements or ImageData can allow DstFormat != SrcFormat.
<span class="udiff-line-modified-removed">-     const bool srcFormatComesFromDOMElementOrImageData = GraphicsContext3D::srcFormatComesFromDOMElementOrImageData(SrcFormat);</span>
<span class="udiff-line-modified-added">+     const bool srcFormatComesFromDOMElementOrImageData = GraphicsContextGLOpenGL::srcFormatComesFromDOMElementOrImageData(SrcFormat);</span>
      if (!srcFormatComesFromDOMElementOrImageData &amp;&amp; SrcFormat != DstFormat) {
          ASSERT_NOT_REACHED();
          return;
      }
      // Likewise, only textures uploaded from DOM elements or ImageData can possibly have to be unpremultiplied.
<span class="udiff-line-modified-removed">-     if (!srcFormatComesFromDOMElementOrImageData &amp;&amp; alphaOp == GraphicsContext3D::AlphaDoUnmultiply) {</span>
<span class="udiff-line-modified-added">+     if (!srcFormatComesFromDOMElementOrImageData &amp;&amp; alphaOp == GraphicsContextGL::AlphaOp::DoUnmultiply) {</span>
          ASSERT_NOT_REACHED();
          return;
      }
<span class="udiff-line-modified-removed">-     if ((!GraphicsContext3D::hasAlpha(SrcFormat) || !GraphicsContext3D::hasColor(SrcFormat) || !GraphicsContext3D::hasColor(DstFormat)) &amp;&amp; alphaOp != GraphicsContext3D::AlphaDoNothing) {</span>
<span class="udiff-line-modified-added">+     if ((!GraphicsContextGLOpenGL::hasAlpha(SrcFormat) || !GraphicsContextGLOpenGL::hasColor(SrcFormat) || !GraphicsContextGLOpenGL::hasColor(DstFormat)) &amp;&amp; alphaOp != GraphicsContextGL::AlphaOp::DoNothing) {</span>
          ASSERT_NOT_REACHED();
          return;
      }
  
      typedef typename DataTypeForFormat&lt;SrcFormat&gt;::Type SrcType;
      typedef typename DataTypeForFormat&lt;DstFormat&gt;::Type DstType;
<span class="udiff-line-modified-removed">-     const int IntermediateSrcFormat = IntermediateFormat&lt;DstFormat&gt;::Value;</span>
<span class="udiff-line-modified-added">+     const GraphicsContextGL::DataFormat IntermediateSrcFormat = IntermediateFormat&lt;DstFormat&gt;::Value;</span>
      typedef typename DataTypeForFormat&lt;IntermediateSrcFormat&gt;::Type IntermediateSrcType;
      const ptrdiff_t srcStrideInElements = m_srcStride / sizeof(SrcType);
      const ptrdiff_t dstStrideInElements = m_dstStride / sizeof(DstType);
<span class="udiff-line-modified-removed">-     const bool trivialUnpack = (SrcFormat == GraphicsContext3D::DataFormatRGBA8 &amp;&amp; !IsFloatFormat&lt;DstFormat&gt;::Value &amp;&amp; !IsHalfFloatFormat&lt;DstFormat&gt;::Value) || SrcFormat == GraphicsContext3D::DataFormatRGBA32F;</span>
<span class="udiff-line-modified-removed">-     const bool trivialPack = (DstFormat == GraphicsContext3D::DataFormatRGBA8 || DstFormat == GraphicsContext3D::DataFormatRGBA32F) &amp;&amp; alphaOp == GraphicsContext3D::AlphaDoNothing &amp;&amp; m_dstStride &gt; 0;</span>
<span class="udiff-line-modified-added">+     const bool trivialUnpack = (SrcFormat == GraphicsContextGL::DataFormat::RGBA8 &amp;&amp; !IsFloatFormat&lt;DstFormat&gt;::Value &amp;&amp; !IsHalfFloatFormat&lt;DstFormat&gt;::Value) || SrcFormat == GraphicsContextGL::DataFormat::RGBA32F;</span>
<span class="udiff-line-modified-added">+     const bool trivialPack = (DstFormat == GraphicsContextGL::DataFormat::RGBA8 || DstFormat == GraphicsContextGL::DataFormat::RGBA32F) &amp;&amp; alphaOp == GraphicsContextGL::AlphaOp::DoNothing &amp;&amp; m_dstStride &gt; 0;</span>
      ASSERT(!trivialUnpack || !trivialPack);
  
      const SrcType *srcRowStart = static_cast&lt;const SrcType*&gt;(m_srcStart);
      DstType* dstRowStart = static_cast&lt;DstType*&gt;(m_dstStart);
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1261,13 +1261,13 @@</span>
              srcRowStart += srcStrideInElements;
              dstRowStart += dstStrideInElements;
          }
      } else {
  #if USE(ACCELERATE)
<span class="udiff-line-modified-removed">-         if (SrcFormat == GraphicsContext3D::DataFormatRGBA8</span>
<span class="udiff-line-modified-removed">-             &amp;&amp; DstFormat == GraphicsContext3D::DataFormatRGBA8</span>
<span class="udiff-line-modified-removed">-             &amp;&amp; alphaOp == GraphicsContext3D::AlphaDoUnmultiply) {</span>
<span class="udiff-line-modified-added">+         if (SrcFormat == GraphicsContextGL::DataFormat::RGBA8</span>
<span class="udiff-line-modified-added">+             &amp;&amp; DstFormat == GraphicsContextGL::DataFormat::RGBA8</span>
<span class="udiff-line-modified-added">+             &amp;&amp; alphaOp == GraphicsContextGL::AlphaOp::DoUnmultiply) {</span>
              vImage_Buffer src;
              src.width = m_width;
              src.height = m_height;
              src.rowBytes = m_srcStride;
              src.data = const_cast&lt;void*&gt;(m_srcStart);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1291,6 +1291,6 @@</span>
      }
  }
  
  } // namespace WebCore
  
<span class="udiff-line-modified-removed">- #endif // ENABLE(GRAPHICS_CONTEXT_3D)</span>
<span class="udiff-line-modified-added">+ #endif // ENABLE(GRAPHICS_CONTEXT_GL)</span>
</pre>
<center><a href="FontTaggedSettings.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="FormatConverter.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>