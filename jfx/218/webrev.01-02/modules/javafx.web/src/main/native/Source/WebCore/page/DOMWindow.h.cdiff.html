<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/page/DOMWindow.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DOMWindow.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="DOMWindow.idl.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/page/DOMWindow.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 31,23 ***</span>
  #include &quot;ContextDestructionObserver.h&quot;
  #include &quot;ExceptionOr.h&quot;
  #include &quot;Frame.h&quot;
  #include &quot;FrameDestructionObserver.h&quot;
  #include &quot;ImageBitmap.h&quot;
  #include &quot;ScrollToOptions.h&quot;
  #include &quot;ScrollTypes.h&quot;
  #include &quot;Supplementable.h&quot;
  #include &lt;JavaScriptCore/HandleTypes.h&gt;
  #include &lt;wtf/Function.h&gt;
  #include &lt;wtf/HashSet.h&gt;
  #include &lt;wtf/WeakPtr.h&gt;
  
  namespace JSC {
<span class="line-modified">! class ExecState;</span>
  class JSObject;
  class JSValue;
<span class="line-removed">- template&lt;typename&gt; class Strong;</span>
  }
  
  namespace WebCore {
  
  class BarProp;
<span class="line-new-header">--- 31,25 ---</span>
  #include &quot;ContextDestructionObserver.h&quot;
  #include &quot;ExceptionOr.h&quot;
  #include &quot;Frame.h&quot;
  #include &quot;FrameDestructionObserver.h&quot;
  #include &quot;ImageBitmap.h&quot;
<span class="line-added">+ #include &quot;PostMessageOptions.h&quot;</span>
  #include &quot;ScrollToOptions.h&quot;
  #include &quot;ScrollTypes.h&quot;
  #include &quot;Supplementable.h&quot;
  #include &lt;JavaScriptCore/HandleTypes.h&gt;
<span class="line-added">+ #include &lt;JavaScriptCore/Strong.h&gt;</span>
  #include &lt;wtf/Function.h&gt;
  #include &lt;wtf/HashSet.h&gt;
<span class="line-added">+ #include &lt;wtf/MonotonicTime.h&gt;</span>
  #include &lt;wtf/WeakPtr.h&gt;
  
  namespace JSC {
<span class="line-modified">! class CallFrame;</span>
  class JSObject;
  class JSValue;
  }
  
  namespace WebCore {
  
  class BarProp;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 62,20 ***</span>
<span class="line-new-header">--- 64,22 ---</span>
  class Document;
  class Element;
  class EventListener;
  class FloatRect;
  class History;
<span class="line-added">+ class IdleRequestCallback;</span>
  class Location;
  class MediaQueryList;
  class Navigator;
  class Node;
  class NodeList;
  class Page;
  class PageConsoleClient;
  class Performance;
  class PostMessageTimer;
  class RequestAnimationFrameCallback;
<span class="line-added">+ class RequestIdleCallback;</span>
  class ScheduledAction;
  class Screen;
  class Storage;
  class StyleMedia;
  class VisualViewport;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 85,16 ***</span>
<span class="line-new-header">--- 89,27 ---</span>
  #if ENABLE(DEVICE_ORIENTATION)
  class DeviceMotionController;
  class DeviceOrientationController;
  #endif
  
<span class="line-added">+ struct IdleRequestOptions;</span>
  struct ImageBitmapOptions;
  struct WindowFeatures;
  
  enum SetLocationLocking { LockHistoryBasedOnGestureState, LockHistoryAndBackForwardList };
  enum class IncludeTargetOrigin { No, Yes };
  
<span class="line-added">+ struct WindowPostMessageOptions : public PostMessageOptions {</span>
<span class="line-added">+     WindowPostMessageOptions() = default;</span>
<span class="line-added">+     WindowPostMessageOptions(String&amp;&amp; targetOrigin, Vector&lt;JSC::Strong&lt;JSC::JSObject&gt;&gt;&amp;&amp; transfer)</span>
<span class="line-added">+         : PostMessageOptions(WTFMove(transfer))</span>
<span class="line-added">+         , targetOrigin(WTFMove(targetOrigin))</span>
<span class="line-added">+     { }</span>
<span class="line-added">+ </span>
<span class="line-added">+     String targetOrigin { &quot;/&quot;_s };</span>
<span class="line-added">+ };</span>
<span class="line-added">+ </span>
  // FIXME: Rename DOMWindow to LocalWindow and AbstractDOMWindow to DOMWindow.
  class DOMWindow final
      : public AbstractDOMWindow
      , public CanMakeWeakPtr&lt;DOMWindow&gt;
      , public ContextDestructionObserver
</pre>
<hr />
<pre>
<span class="line-old-header">*** 117,23 ***</span>
  
      class Observer {
      public:
          virtual ~Observer() { }
  
<span class="line-modified">!         virtual void suspendForPageCache() { }</span>
<span class="line-modified">!         virtual void resumeFromPageCache() { }</span>
          virtual void willDestroyGlobalObjectInCachedFrame() { }
          virtual void willDestroyGlobalObjectInFrame() { }
          virtual void willDetachGlobalObjectFromFrame() { }
      };
  
      void registerObserver(Observer&amp;);
      void unregisterObserver(Observer&amp;);
  
      void resetUnlessSuspendedForDocumentSuspension();
<span class="line-modified">!     void suspendForPageCache();</span>
<span class="line-modified">!     void resumeFromPageCache();</span>
  
      WEBCORE_EXPORT Frame* frame() const final;
  
      RefPtr&lt;MediaQueryList&gt; matchMedia(const String&amp;);
  
<span class="line-new-header">--- 132,23 ---</span>
  
      class Observer {
      public:
          virtual ~Observer() { }
  
<span class="line-modified">!         virtual void suspendForBackForwardCache() { }</span>
<span class="line-modified">!         virtual void resumeFromBackForwardCache() { }</span>
          virtual void willDestroyGlobalObjectInCachedFrame() { }
          virtual void willDestroyGlobalObjectInFrame() { }
          virtual void willDetachGlobalObjectFromFrame() { }
      };
  
      void registerObserver(Observer&amp;);
      void unregisterObserver(Observer&amp;);
  
      void resetUnlessSuspendedForDocumentSuspension();
<span class="line-modified">!     void suspendForBackForwardCache();</span>
<span class="line-modified">!     void resumeFromBackForwardCache();</span>
  
      WEBCORE_EXPORT Frame* frame() const final;
  
      RefPtr&lt;MediaQueryList&gt; matchMedia(const String&amp;);
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 160,11 ***</span>
      BarProp&amp; toolbar();
      WEBCORE_EXPORT Navigator&amp; navigator();
      Navigator* optionalNavigator() const { return m_navigator.get(); }
      Navigator&amp; clientInformation() { return navigator(); }
  
<span class="line-modified">!     Location&amp; location();</span>
      void setLocation(DOMWindow&amp; activeWindow, const URL&amp; completedURL, SetLocationLocking = LockHistoryBasedOnGestureState);
  
      DOMSelection* getSelection();
  
      Element* frameElement() const;
<span class="line-new-header">--- 175,18 ---</span>
      BarProp&amp; toolbar();
      WEBCORE_EXPORT Navigator&amp; navigator();
      Navigator* optionalNavigator() const { return m_navigator.get(); }
      Navigator&amp; clientInformation() { return navigator(); }
  
<span class="line-modified">!     WEBCORE_EXPORT static void overrideTransientActivationDurationForTesting(Optional&lt;Seconds&gt;&amp;&amp;);</span>
<span class="line-added">+     void setLastActivationTimestamp(MonotonicTime lastActivationTimestamp) { m_lastActivationTimestamp = lastActivationTimestamp; }</span>
<span class="line-added">+     MonotonicTime lastActivationTimestamp() const { return m_lastActivationTimestamp; }</span>
<span class="line-added">+     void notifyActivated(MonotonicTime);</span>
<span class="line-added">+     bool hasTransientActivation() const;</span>
<span class="line-added">+     bool consumeTransientActivation();</span>
<span class="line-added">+ </span>
<span class="line-added">+     WEBCORE_EXPORT Location&amp; location();</span>
      void setLocation(DOMWindow&amp; activeWindow, const URL&amp; completedURL, SetLocationLocking = LockHistoryBasedOnGestureState);
  
      DOMSelection* getSelection();
  
      Element* frameElement() const;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 182,11 ***</span>
      void showModalDialog(const String&amp; urlString, const String&amp; dialogFeaturesString, DOMWindow&amp; activeWindow, DOMWindow&amp; firstWindow, const WTF::Function&lt;void(DOMWindow&amp;)&gt;&amp; prepareDialogFunction);
  
      void prewarmLocalStorageIfNecessary();
  
      void alert(const String&amp; message = emptyString());
<span class="line-modified">!     bool confirm(const String&amp; message);</span>
      String prompt(const String&amp; message, const String&amp; defaultValue);
  
      bool find(const String&amp;, bool caseSensitive, bool backwards, bool wrap, bool wholeWord, bool searchInFrames, bool showDialog) const;
  
      bool offscreenBuffering() const;
<span class="line-new-header">--- 204,11 ---</span>
      void showModalDialog(const String&amp; urlString, const String&amp; dialogFeaturesString, DOMWindow&amp; activeWindow, DOMWindow&amp; firstWindow, const WTF::Function&lt;void(DOMWindow&amp;)&gt;&amp; prepareDialogFunction);
  
      void prewarmLocalStorageIfNecessary();
  
      void alert(const String&amp; message = emptyString());
<span class="line-modified">!     bool confirmForBindings(const String&amp; message);</span>
      String prompt(const String&amp; message, const String&amp; defaultValue);
  
      bool find(const String&amp;, bool caseSensitive, bool backwards, bool wrap, bool wholeWord, bool searchInFrames, bool showDialog) const;
  
      bool offscreenBuffering() const;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 218,10 ***</span>
<span class="line-new-header">--- 240,11 ---</span>
      void disownOpener();
      WindowProxy* parent() const;
      WindowProxy* top() const;
  
      String origin() const;
<span class="line-added">+     SecurityOrigin* securityOrigin() const;</span>
  
      // DOM Level 2 AbstractView Interface
  
      WEBCORE_EXPORT Document* document() const;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 241,15 ***</span>
      RefPtr&lt;WebKitPoint&gt; webkitConvertPointFromPageToNode(Node*, const WebKitPoint*) const;
      RefPtr&lt;WebKitPoint&gt; webkitConvertPointFromNodeToPage(Node*, const WebKitPoint*) const;
  
      PageConsoleClient* console() const;
  
<span class="line-modified">!     void printErrorMessage(const String&amp;);</span>
  
      String crossDomainAccessErrorMessage(const DOMWindow&amp; activeWindow, IncludeTargetOrigin);
  
<span class="line-modified">!     ExceptionOr&lt;void&gt; postMessage(JSC::ExecState&amp;, DOMWindow&amp; incumbentWindow, JSC::JSValue message, const String&amp; targetOrigin, Vector&lt;JSC::Strong&lt;JSC::JSObject&gt;&gt;&amp;&amp;);</span>
      void postMessageTimerFired(PostMessageTimer&amp;);
  
      void languagesChanged();
  
      void scrollBy(const ScrollToOptions&amp;) const;
<span class="line-new-header">--- 264,20 ---</span>
      RefPtr&lt;WebKitPoint&gt; webkitConvertPointFromPageToNode(Node*, const WebKitPoint*) const;
      RefPtr&lt;WebKitPoint&gt; webkitConvertPointFromNodeToPage(Node*, const WebKitPoint*) const;
  
      PageConsoleClient* console() const;
  
<span class="line-modified">!     void printErrorMessage(const String&amp;) const;</span>
  
      String crossDomainAccessErrorMessage(const DOMWindow&amp; activeWindow, IncludeTargetOrigin);
  
<span class="line-modified">!     ExceptionOr&lt;void&gt; postMessage(JSC::JSGlobalObject&amp;, DOMWindow&amp; incumbentWindow, JSC::JSValue message, WindowPostMessageOptions&amp;&amp;);</span>
<span class="line-added">+     ExceptionOr&lt;void&gt; postMessage(JSC::JSGlobalObject&amp; globalObject, DOMWindow&amp; incumbentWindow, JSC::JSValue message, String&amp;&amp; targetOrigin, Vector&lt;JSC::Strong&lt;JSC::JSObject&gt;&gt;&amp;&amp; transfer)</span>
<span class="line-added">+     {</span>
<span class="line-added">+         return postMessage(globalObject, incumbentWindow, message, WindowPostMessageOptions { WTFMove(targetOrigin), WTFMove(transfer) });</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      void postMessageTimerFired(PostMessageTimer&amp;);
  
      void languagesChanged();
  
      void scrollBy(const ScrollToOptions&amp;) const;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 264,19 ***</span>
      void resizeTo(float width, float height) const;
  
      VisualViewport&amp; visualViewport();
  
      // Timers
<span class="line-modified">!     ExceptionOr&lt;int&gt; setTimeout(JSC::ExecState&amp;, std::unique_ptr&lt;ScheduledAction&gt;, int timeout, Vector&lt;JSC::Strong&lt;JSC::Unknown&gt;&gt;&amp;&amp; arguments);</span>
      void clearTimeout(int timeoutId);
<span class="line-modified">!     ExceptionOr&lt;int&gt; setInterval(JSC::ExecState&amp;, std::unique_ptr&lt;ScheduledAction&gt;, int timeout, Vector&lt;JSC::Strong&lt;JSC::Unknown&gt;&gt;&amp;&amp; arguments);</span>
      void clearInterval(int timeoutId);
  
      int requestAnimationFrame(Ref&lt;RequestAnimationFrameCallback&gt;&amp;&amp;);
      int webkitRequestAnimationFrame(Ref&lt;RequestAnimationFrameCallback&gt;&amp;&amp;);
      void cancelAnimationFrame(int id);
  
      // ImageBitmap
      void createImageBitmap(ImageBitmap::Source&amp;&amp;, ImageBitmapOptions&amp;&amp;, ImageBitmap::Promise&amp;&amp;);
      void createImageBitmap(ImageBitmap::Source&amp;&amp;, int sx, int sy, int sw, int sh, ImageBitmapOptions&amp;&amp;, ImageBitmap::Promise&amp;&amp;);
  
      // Secure Contexts
<span class="line-new-header">--- 292,22 ---</span>
      void resizeTo(float width, float height) const;
  
      VisualViewport&amp; visualViewport();
  
      // Timers
<span class="line-modified">!     ExceptionOr&lt;int&gt; setTimeout(JSC::JSGlobalObject&amp;, std::unique_ptr&lt;ScheduledAction&gt;, int timeout, Vector&lt;JSC::Strong&lt;JSC::Unknown&gt;&gt;&amp;&amp; arguments);</span>
      void clearTimeout(int timeoutId);
<span class="line-modified">!     ExceptionOr&lt;int&gt; setInterval(JSC::JSGlobalObject&amp;, std::unique_ptr&lt;ScheduledAction&gt;, int timeout, Vector&lt;JSC::Strong&lt;JSC::Unknown&gt;&gt;&amp;&amp; arguments);</span>
      void clearInterval(int timeoutId);
  
      int requestAnimationFrame(Ref&lt;RequestAnimationFrameCallback&gt;&amp;&amp;);
      int webkitRequestAnimationFrame(Ref&lt;RequestAnimationFrameCallback&gt;&amp;&amp;);
      void cancelAnimationFrame(int id);
  
<span class="line-added">+     int requestIdleCallback(Ref&lt;IdleRequestCallback&gt;&amp;&amp;, const IdleRequestOptions&amp;);</span>
<span class="line-added">+     void cancelIdleCallback(int id);</span>
<span class="line-added">+ </span>
      // ImageBitmap
      void createImageBitmap(ImageBitmap::Source&amp;&amp;, ImageBitmapOptions&amp;&amp;, ImageBitmap::Promise&amp;&amp;);
      void createImageBitmap(ImageBitmap::Source&amp;&amp;, int sx, int sy, int sw, int sh, ImageBitmapOptions&amp;&amp;, ImageBitmap::Promise&amp;&amp;);
  
      // Secure Contexts
</pre>
<hr />
<pre>
<span class="line-old-header">*** 439,10 ***</span>
<span class="line-new-header">--- 470,16 ---</span>
  
      RefPtr&lt;CustomElementRegistry&gt; m_customElementRegistry;
  
      mutable RefPtr&lt;Performance&gt; m_performance;
  
<span class="line-added">+     // For the purpose of tracking user activation, each Window W has a last activation timestamp. This is a number indicating the last time W got</span>
<span class="line-added">+     // an activation notification. It corresponds to a DOMHighResTimeStamp value except for two cases: positive infinity indicates that W has never</span>
<span class="line-added">+     // been activated, while negative infinity indicates that a user activation-gated API has consumed the last user activation of W. The initial</span>
<span class="line-added">+     // value is positive infinity.</span>
<span class="line-added">+     MonotonicTime m_lastActivationTimestamp { MonotonicTime::infinity() };</span>
<span class="line-added">+ </span>
  #if ENABLE(USER_MESSAGE_HANDLERS)
      mutable RefPtr&lt;WebKitNamespace&gt; m_webkitNamespace;
  #endif
  };
  
</pre>
<center><a href="DOMWindow.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="DOMWindow.idl.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>