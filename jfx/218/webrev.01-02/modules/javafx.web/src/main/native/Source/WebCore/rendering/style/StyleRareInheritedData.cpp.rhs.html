<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/WebCore/rendering/style/StyleRareInheritedData.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (C) 1999 Antti Koivisto (koivisto@kde.org)
  3  * Copyright (C) 2004, 2005, 2006, 2007, 2008, 2009, 2010 Apple Inc. All rights reserved.
  4  *
  5  * This library is free software; you can redistribute it and/or
  6  * modify it under the terms of the GNU Library General Public
  7  * License as published by the Free Software Foundation; either
  8  * version 2 of the License, or (at your option) any later version.
  9  *
 10  * This library is distributed in the hope that it will be useful,
 11  * but WITHOUT ANY WARRANTY; without even the implied warranty of
 12  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 13  * Library General Public License for more details.
 14  *
 15  * You should have received a copy of the GNU Library General Public License
 16  * along with this library; see the file COPYING.LIB.  If not, write to
 17  * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
 18  * Boston, MA 02110-1301, USA.
 19  *
 20  */
 21 
 22 #include &quot;config.h&quot;
 23 #include &quot;StyleRareInheritedData.h&quot;
 24 
 25 #include &quot;CursorList.h&quot;
 26 #include &quot;DataRef.h&quot;
 27 #include &quot;QuotesData.h&quot;
 28 #include &quot;RenderStyle.h&quot;
 29 #include &quot;RenderStyleConstants.h&quot;
 30 #include &quot;ShadowData.h&quot;
 31 #include &quot;StyleColorScheme.h&quot;
 32 #include &quot;StyleCustomPropertyData.h&quot;
 33 #include &quot;StyleFilterData.h&quot;
 34 #include &quot;StyleImage.h&quot;
 35 #include &lt;wtf/PointerComparison.h&gt;
 36 
 37 namespace WebCore {
 38 
 39 struct GreaterThanOrSameSizeAsStyleRareInheritedData : public RefCounted&lt;GreaterThanOrSameSizeAsStyleRareInheritedData&gt; {
 40     void* styleImage;
 41     Color firstColor;
 42     float firstFloat;
 43     Color colors[9];
 44     void* ownPtrs[1];
 45     AtomString atomStrings[5];
 46     void* refPtrs[3];
 47     Length lengths[2];
 48     float secondFloat;
 49     TextUnderlineOffset offset;
 50     TextDecorationThickness thickness;
 51     void* customPropertyDataRefs[1];
 52     unsigned bitfields[4];
 53     short pagedMediaShorts[2];
 54     TabSize tabSize;
 55     short hyphenationShorts[3];
 56 
 57 #if ENABLE(TEXT_AUTOSIZING)
 58     TextSizeAdjustment textSizeAdjust;
 59 #endif
 60 
 61 #if ENABLE(CSS_IMAGE_RESOLUTION)
 62     float imageResolutionFloats;
 63 #endif
 64 
 65 #if ENABLE(TOUCH_EVENTS)
 66     Color tapHighlightColor;
 67 #endif
 68 
 69 #if ENABLE(DARK_MODE_CSS)
 70     StyleColorScheme colorScheme;
 71 #endif
 72 };
 73 
 74 COMPILE_ASSERT(sizeof(StyleRareInheritedData) &lt;= sizeof(GreaterThanOrSameSizeAsStyleRareInheritedData), StyleRareInheritedData_should_bit_pack);
 75 
<a name="1" id="anc1"></a><span class="line-added"> 76 DEFINE_ALLOCATOR_WITH_HEAP_IDENTIFIER(StyleRareInheritedData);</span>
<span class="line-added"> 77 </span>
 78 StyleRareInheritedData::StyleRareInheritedData()
 79     : listStyleImage(RenderStyle::initialListStyleImage())
 80     , textStrokeWidth(RenderStyle::initialTextStrokeWidth())
 81     , indent(RenderStyle::initialTextIndent())
 82     , effectiveZoom(RenderStyle::initialZoom())
 83     , textUnderlineOffset(RenderStyle::initialTextUnderlineOffset())
 84     , textDecorationThickness(RenderStyle::initialTextDecorationThickness())
 85     , customProperties(StyleCustomPropertyData::create())
 86     , widows(RenderStyle::initialWidows())
 87     , orphans(RenderStyle::initialOrphans())
 88     , hasAutoWidows(true)
 89     , hasAutoOrphans(true)
 90     , textSecurity(static_cast&lt;unsigned&gt;(RenderStyle::initialTextSecurity()))
 91     , userModify(static_cast&lt;unsigned&gt;(UserModify::ReadOnly))
 92     , wordBreak(static_cast&lt;unsigned&gt;(RenderStyle::initialWordBreak()))
 93     , overflowWrap(static_cast&lt;unsigned&gt;(RenderStyle::initialOverflowWrap()))
 94     , nbspMode(static_cast&lt;unsigned&gt;(NBSPMode::Normal))
 95     , lineBreak(static_cast&lt;unsigned&gt;(LineBreak::Auto))
 96     , userSelect(static_cast&lt;unsigned&gt;(RenderStyle::initialUserSelect()))
 97     , speakAs(RenderStyle::initialSpeakAs().toRaw())
 98     , hyphens(static_cast&lt;unsigned&gt;(Hyphens::Manual))
 99     , textEmphasisFill(static_cast&lt;unsigned&gt;(TextEmphasisFill::Filled))
100     , textEmphasisMark(static_cast&lt;unsigned&gt;(TextEmphasisMark::None))
101     , textEmphasisPosition(static_cast&lt;unsigned&gt;(RenderStyle::initialTextEmphasisPosition().toRaw()))
102     , textOrientation(static_cast&lt;unsigned&gt;(TextOrientation::Mixed))
103 #if ENABLE(CSS3_TEXT)
104     , textIndentLine(RenderStyle::initialTextIndentLine())
105     , textIndentType(RenderStyle::initialTextIndentType())
106 #endif
<a name="2" id="anc2"></a><span class="line-modified">107     , lineBoxContain(static_cast&lt;unsigned&gt;(RenderStyle::initialLineBoxContain().toRaw()))</span>

108     , imageOrientation(RenderStyle::initialImageOrientation())
<a name="3" id="anc3"></a>
109     , imageRendering(static_cast&lt;unsigned&gt;(RenderStyle::initialImageRendering()))
110     , lineSnap(static_cast&lt;unsigned&gt;(RenderStyle::initialLineSnap()))
111     , lineAlign(static_cast&lt;unsigned&gt;(RenderStyle::initialLineAlign()))
112 #if ENABLE(OVERFLOW_SCROLLING_TOUCH)
113     , useTouchOverflowScrolling(RenderStyle::initialUseTouchOverflowScrolling())
114 #endif
115 #if ENABLE(CSS_IMAGE_RESOLUTION)
116     , imageResolutionSource(RenderStyle::initialImageResolutionSource())
117     , imageResolutionSnap(RenderStyle::initialImageResolutionSnap())
118 #endif
119 #if ENABLE(CSS3_TEXT)
120     , textAlignLast(RenderStyle::initialTextAlignLast())
121     , textJustify(RenderStyle::initialTextJustify())
122 #endif
123     , textDecorationSkip(RenderStyle::initialTextDecorationSkip().toRaw())
124     , textUnderlinePosition(static_cast&lt;unsigned&gt;(RenderStyle::initialTextUnderlinePosition()))
125     , rubyPosition(static_cast&lt;unsigned&gt;(RenderStyle::initialRubyPosition()))
126     , textZoom(static_cast&lt;unsigned&gt;(RenderStyle::initialTextZoom()))
127 #if PLATFORM(IOS_FAMILY)
128     , touchCalloutEnabled(RenderStyle::initialTouchCalloutEnabled())
129 #endif
130     , hangingPunctuation(RenderStyle::initialHangingPunctuation().toRaw())
131     , paintOrder(static_cast&lt;unsigned&gt;(RenderStyle::initialPaintOrder()))
132     , capStyle(RenderStyle::initialCapStyle())
133     , joinStyle(RenderStyle::initialJoinStyle())
134     , hasSetStrokeWidth(false)
135     , hasSetStrokeColor(false)
136 #if ENABLE(POINTER_EVENTS)
137     , effectiveTouchActions(static_cast&lt;unsigned&gt;(RenderStyle::initialTouchActions()))
138 #endif
139     , strokeWidth(RenderStyle::initialStrokeWidth())
140     , strokeColor(RenderStyle::initialStrokeColor())
141     , miterLimit(RenderStyle::initialStrokeMiterLimit())
142     , hyphenationLimitBefore(-1)
143     , hyphenationLimitAfter(-1)
144     , hyphenationLimitLines(-1)
145     , appleColorFilter(StyleFilterData::create())
146     , lineGrid(RenderStyle::initialLineGrid())
147     , tabSize(RenderStyle::initialTabSize())
148 #if ENABLE(TEXT_AUTOSIZING)
149     , textSizeAdjust(RenderStyle::initialTextSizeAdjust())
150 #endif
151 #if ENABLE(CSS_IMAGE_RESOLUTION)
152     , imageResolution(RenderStyle::initialImageResolution())
153 #endif
154 #if ENABLE(TOUCH_EVENTS)
155     , tapHighlightColor(RenderStyle::initialTapHighlightColor())
156 #endif
157 #if ENABLE(DARK_MODE_CSS)
158     , colorScheme(RenderStyle::initialColorScheme())
159 #endif
160 {
161 }
162 
163 inline StyleRareInheritedData::StyleRareInheritedData(const StyleRareInheritedData&amp; o)
164     : RefCounted&lt;StyleRareInheritedData&gt;()
165     , listStyleImage(o.listStyleImage)
166     , textStrokeColor(o.textStrokeColor)
167     , textStrokeWidth(o.textStrokeWidth)
168     , textFillColor(o.textFillColor)
169     , textEmphasisColor(o.textEmphasisColor)
170     , visitedLinkTextStrokeColor(o.visitedLinkTextStrokeColor)
171     , visitedLinkTextFillColor(o.visitedLinkTextFillColor)
172     , visitedLinkTextEmphasisColor(o.visitedLinkTextEmphasisColor)
173     , caretColor(o.caretColor)
174     , visitedLinkCaretColor(o.visitedLinkCaretColor)
175     , textShadow(o.textShadow ? makeUnique&lt;ShadowData&gt;(*o.textShadow) : nullptr)
176     , cursorData(o.cursorData)
177     , indent(o.indent)
178     , effectiveZoom(o.effectiveZoom)
179     , textUnderlineOffset(o.textUnderlineOffset)
180     , textDecorationThickness(o.textDecorationThickness)
181     , customProperties(o.customProperties)
182     , widows(o.widows)
183     , orphans(o.orphans)
184     , hasAutoWidows(o.hasAutoWidows)
185     , hasAutoOrphans(o.hasAutoOrphans)
186     , textSecurity(o.textSecurity)
187     , userModify(o.userModify)
188     , wordBreak(o.wordBreak)
189     , overflowWrap(o.overflowWrap)
190     , nbspMode(o.nbspMode)
191     , lineBreak(o.lineBreak)
192     , userSelect(o.userSelect)
193     , speakAs(o.speakAs)
194     , hyphens(o.hyphens)
195     , textEmphasisFill(o.textEmphasisFill)
196     , textEmphasisMark(o.textEmphasisMark)
197     , textEmphasisPosition(o.textEmphasisPosition)
198     , textOrientation(o.textOrientation)
199 #if ENABLE(CSS3_TEXT)
200     , textIndentLine(o.textIndentLine)
201     , textIndentType(o.textIndentType)
202 #endif
203     , lineBoxContain(o.lineBoxContain)
<a name="4" id="anc4"></a>
204     , imageOrientation(o.imageOrientation)
<a name="5" id="anc5"></a>
205     , imageRendering(o.imageRendering)
206     , lineSnap(o.lineSnap)
207     , lineAlign(o.lineAlign)
208 #if ENABLE(OVERFLOW_SCROLLING_TOUCH)
209     , useTouchOverflowScrolling(o.useTouchOverflowScrolling)
210 #endif
211 #if ENABLE(CSS_IMAGE_RESOLUTION)
212     , imageResolutionSource(o.imageResolutionSource)
213     , imageResolutionSnap(o.imageResolutionSnap)
214 #endif
215 #if ENABLE(CSS3_TEXT)
216     , textAlignLast(o.textAlignLast)
217     , textJustify(o.textJustify)
218 #endif
219     , textDecorationSkip(o.textDecorationSkip)
220     , textUnderlinePosition(o.textUnderlinePosition)
221     , rubyPosition(o.rubyPosition)
222     , textZoom(o.textZoom)
223 #if PLATFORM(IOS_FAMILY)
224     , touchCalloutEnabled(o.touchCalloutEnabled)
225 #endif
226     , hangingPunctuation(o.hangingPunctuation)
227     , paintOrder(o.paintOrder)
228     , capStyle(o.capStyle)
229     , joinStyle(o.joinStyle)
230     , hasSetStrokeWidth(o.hasSetStrokeWidth)
231     , hasSetStrokeColor(o.hasSetStrokeColor)
232 #if ENABLE(POINTER_EVENTS)
233     , effectiveTouchActions(o.effectiveTouchActions)
234 #endif
235     , strokeWidth(o.strokeWidth)
236     , strokeColor(o.strokeColor)
237     , visitedLinkStrokeColor(o.visitedLinkStrokeColor)
238     , miterLimit(o.miterLimit)
239     , hyphenationString(o.hyphenationString)
240     , hyphenationLimitBefore(o.hyphenationLimitBefore)
241     , hyphenationLimitAfter(o.hyphenationLimitAfter)
242     , hyphenationLimitLines(o.hyphenationLimitLines)
243     , textEmphasisCustomMark(o.textEmphasisCustomMark)
244     , appleColorFilter(o.appleColorFilter)
245     , lineGrid(o.lineGrid)
246     , tabSize(o.tabSize)
247 #if ENABLE(TEXT_AUTOSIZING)
248     , textSizeAdjust(o.textSizeAdjust)
249 #endif
250 #if ENABLE(CSS_IMAGE_RESOLUTION)
251     , imageResolution(o.imageResolution)
252 #endif
253 #if ENABLE(TOUCH_EVENTS)
254     , tapHighlightColor(o.tapHighlightColor)
255 #endif
256 #if ENABLE(DARK_MODE_CSS)
257     , colorScheme(o.colorScheme)
258 #endif
259 {
260 }
261 
262 Ref&lt;StyleRareInheritedData&gt; StyleRareInheritedData::copy() const
263 {
264     return adoptRef(*new StyleRareInheritedData(*this));
265 }
266 
267 StyleRareInheritedData::~StyleRareInheritedData() = default;
268 
269 bool StyleRareInheritedData::operator==(const StyleRareInheritedData&amp; o) const
270 {
271     return textStrokeColor == o.textStrokeColor
272         &amp;&amp; textStrokeWidth == o.textStrokeWidth
273         &amp;&amp; textFillColor == o.textFillColor
274         &amp;&amp; textEmphasisColor == o.textEmphasisColor
275         &amp;&amp; visitedLinkTextStrokeColor == o.visitedLinkTextStrokeColor
276         &amp;&amp; visitedLinkTextFillColor == o.visitedLinkTextFillColor
277         &amp;&amp; visitedLinkTextEmphasisColor == o.visitedLinkTextEmphasisColor
278         &amp;&amp; caretColor == o.caretColor
279         &amp;&amp; visitedLinkCaretColor == o.visitedLinkCaretColor
280 #if ENABLE(TOUCH_EVENTS)
281         &amp;&amp; tapHighlightColor == o.tapHighlightColor
282 #endif
283         &amp;&amp; arePointingToEqualData(textShadow, o.textShadow)
284         &amp;&amp; arePointingToEqualData(cursorData, o.cursorData)
285         &amp;&amp; indent == o.indent
286         &amp;&amp; effectiveZoom == o.effectiveZoom
287         &amp;&amp; textUnderlineOffset == o.textUnderlineOffset
288         &amp;&amp; textDecorationThickness == o.textDecorationThickness
289         &amp;&amp; widows == o.widows
290         &amp;&amp; orphans == o.orphans
291         &amp;&amp; hasAutoWidows == o.hasAutoWidows
292         &amp;&amp; hasAutoOrphans == o.hasAutoOrphans
293         &amp;&amp; textSecurity == o.textSecurity
294         &amp;&amp; userModify == o.userModify
295         &amp;&amp; wordBreak == o.wordBreak
296         &amp;&amp; overflowWrap == o.overflowWrap
297         &amp;&amp; nbspMode == o.nbspMode
298         &amp;&amp; lineBreak == o.lineBreak
299 #if ENABLE(OVERFLOW_SCROLLING_TOUCH)
300         &amp;&amp; useTouchOverflowScrolling == o.useTouchOverflowScrolling
301 #endif
302 #if ENABLE(TEXT_AUTOSIZING)
303         &amp;&amp; textSizeAdjust == o.textSizeAdjust
304 #endif
305 #if ENABLE(DARK_MODE_CSS)
306         &amp;&amp; colorScheme == o.colorScheme
307 #endif
308         &amp;&amp; userSelect == o.userSelect
309         &amp;&amp; speakAs == o.speakAs
310         &amp;&amp; hyphens == o.hyphens
311         &amp;&amp; hyphenationLimitBefore == o.hyphenationLimitBefore
312         &amp;&amp; hyphenationLimitAfter == o.hyphenationLimitAfter
313         &amp;&amp; hyphenationLimitLines == o.hyphenationLimitLines
314         &amp;&amp; textEmphasisFill == o.textEmphasisFill
315         &amp;&amp; textEmphasisMark == o.textEmphasisMark
316         &amp;&amp; textEmphasisPosition == o.textEmphasisPosition
317         &amp;&amp; textOrientation == o.textOrientation
318 #if ENABLE(CSS3_TEXT)
319         &amp;&amp; textIndentLine == o.textIndentLine
320         &amp;&amp; textIndentType == o.textIndentType
321 #endif
322         &amp;&amp; lineBoxContain == o.lineBoxContain
323 #if PLATFORM(IOS_FAMILY)
324         &amp;&amp; touchCalloutEnabled == o.touchCalloutEnabled
325 #endif
326         &amp;&amp; hyphenationString == o.hyphenationString
327         &amp;&amp; textEmphasisCustomMark == o.textEmphasisCustomMark
328         &amp;&amp; arePointingToEqualData(quotes, o.quotes)
329         &amp;&amp; appleColorFilter == o.appleColorFilter
330         &amp;&amp; tabSize == o.tabSize
331         &amp;&amp; lineGrid == o.lineGrid
<a name="6" id="anc6"></a>
332         &amp;&amp; imageOrientation == o.imageOrientation
<a name="7" id="anc7"></a>
333         &amp;&amp; imageRendering == o.imageRendering
334 #if ENABLE(CSS_IMAGE_RESOLUTION)
335         &amp;&amp; imageResolutionSource == o.imageResolutionSource
336         &amp;&amp; imageResolutionSnap == o.imageResolutionSnap
337         &amp;&amp; imageResolution == o.imageResolution
338 #endif
339 #if ENABLE(CSS3_TEXT)
340         &amp;&amp; textAlignLast == o.textAlignLast
341         &amp;&amp; textJustify == o.textJustify
342 #endif // CSS3_TEXT
343         &amp;&amp; textDecorationSkip == o.textDecorationSkip
344         &amp;&amp; textUnderlinePosition == o.textUnderlinePosition
345         &amp;&amp; rubyPosition == o.rubyPosition
346         &amp;&amp; textZoom == o.textZoom
347         &amp;&amp; lineSnap == o.lineSnap
348         &amp;&amp; lineAlign == o.lineAlign
349         &amp;&amp; hangingPunctuation == o.hangingPunctuation
350         &amp;&amp; paintOrder == o.paintOrder
351         &amp;&amp; capStyle == o.capStyle
352         &amp;&amp; joinStyle == o.joinStyle
353         &amp;&amp; hasSetStrokeWidth == o.hasSetStrokeWidth
354         &amp;&amp; hasSetStrokeColor == o.hasSetStrokeColor
355 #if ENABLE(POINTER_EVENTS)
356         &amp;&amp; effectiveTouchActions == o.effectiveTouchActions
357 #endif
358         &amp;&amp; strokeWidth == o.strokeWidth
359         &amp;&amp; strokeColor == o.strokeColor
360         &amp;&amp; visitedLinkStrokeColor == o.visitedLinkStrokeColor
361         &amp;&amp; miterLimit == o.miterLimit
362         &amp;&amp; customProperties == o.customProperties
363         &amp;&amp; arePointingToEqualData(listStyleImage, o.listStyleImage);
364 }
365 
366 bool StyleRareInheritedData::hasColorFilters() const
367 {
368     return !appleColorFilter-&gt;operations.isEmpty();
369 }
370 
371 } // namespace WebCore
<a name="8" id="anc8"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="8" type="hidden" />
</body>
</html>