<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/Modules/webdatabase/DatabaseTask.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DatabaseManager.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="DatabaseTask.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/Modules/webdatabase/DatabaseTask.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 63 
 64 DatabaseTask::~DatabaseTask()
 65 {
 66     ASSERT(m_complete || !m_synchronizer);
 67 }
 68 
 69 void DatabaseTask::performTask()
 70 {
 71     // Database tasks are meant to be used only once, so make sure this one hasn&#39;t been performed before.
 72     ASSERT(!m_complete);
 73 
 74     LOG(StorageAPI, &quot;Performing %s %p\n&quot;, debugTaskName(), this);
 75 
 76     m_database.resetAuthorizer();
 77 
 78     doPerformTask();
 79 
 80     if (m_synchronizer)
 81         m_synchronizer-&gt;taskCompleted();
 82 
<span class="line-modified"> 83 #if !ASSERT_DISABLED</span>
 84     m_complete = true;
 85 #endif
 86 }
 87 
 88 // *** DatabaseOpenTask ***
 89 // Opens the database file and verifies the version matches the expected version.
 90 
 91 DatabaseOpenTask::DatabaseOpenTask(Database&amp; database, bool setVersionInNewDatabase, DatabaseTaskSynchronizer&amp; synchronizer, ExceptionOr&lt;void&gt;&amp; result)
 92     : DatabaseTask(database, &amp;synchronizer)
 93     , m_setVersionInNewDatabase(setVersionInNewDatabase)
 94     , m_result(result)
 95 {
 96 }
 97 
 98 void DatabaseOpenTask::doPerformTask()
 99 {
100     m_result = isolatedCopy(database().performOpenAndVerify(m_setVersionInNewDatabase));
101 }
102 
103 #if !LOG_DISABLED
</pre>
</td>
<td>
<hr />
<pre>
 63 
 64 DatabaseTask::~DatabaseTask()
 65 {
 66     ASSERT(m_complete || !m_synchronizer);
 67 }
 68 
 69 void DatabaseTask::performTask()
 70 {
 71     // Database tasks are meant to be used only once, so make sure this one hasn&#39;t been performed before.
 72     ASSERT(!m_complete);
 73 
 74     LOG(StorageAPI, &quot;Performing %s %p\n&quot;, debugTaskName(), this);
 75 
 76     m_database.resetAuthorizer();
 77 
 78     doPerformTask();
 79 
 80     if (m_synchronizer)
 81         m_synchronizer-&gt;taskCompleted();
 82 
<span class="line-modified"> 83 #if ASSERT_ENABLED</span>
 84     m_complete = true;
 85 #endif
 86 }
 87 
 88 // *** DatabaseOpenTask ***
 89 // Opens the database file and verifies the version matches the expected version.
 90 
 91 DatabaseOpenTask::DatabaseOpenTask(Database&amp; database, bool setVersionInNewDatabase, DatabaseTaskSynchronizer&amp; synchronizer, ExceptionOr&lt;void&gt;&amp; result)
 92     : DatabaseTask(database, &amp;synchronizer)
 93     , m_setVersionInNewDatabase(setVersionInNewDatabase)
 94     , m_result(result)
 95 {
 96 }
 97 
 98 void DatabaseOpenTask::doPerformTask()
 99 {
100     m_result = isolatedCopy(database().performOpenAndVerify(m_setVersionInNewDatabase));
101 }
102 
103 #if !LOG_DISABLED
</pre>
</td>
</tr>
</table>
<center><a href="DatabaseManager.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="DatabaseTask.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>