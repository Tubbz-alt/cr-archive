<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/bytecode/SpeculatedType.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="SpeculatedType.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="StructureStubClearingWatchpoint.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/bytecode/SpeculatedType.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (C) 2011-2017 Apple Inc. All rights reserved.</span>
   *
   * Redistribution and use in source and binary forms, with or without
   * modification, are permitted provided that the following conditions
   * are met:
   *
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (C) 2011-2019 Apple Inc. All rights reserved.</span>
   *
   * Redistribution and use in source and binary forms, with or without
   * modification, are permitted provided that the following conditions
   * are met:
   *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 36,81 ***</span>
  namespace JSC {
  
  class Structure;
  
  typedef uint64_t SpeculatedType;
<span class="line-modified">! static const SpeculatedType SpecNone                              = 0; // We don&#39;t know anything yet.</span>
<span class="line-modified">! static const SpeculatedType SpecFinalObject                       = 1ull &lt;&lt; 0; // It&#39;s definitely a JSFinalObject.</span>
<span class="line-modified">! static const SpeculatedType SpecArray                             = 1ull &lt;&lt; 1; // It&#39;s definitely a JSArray.</span>
<span class="line-modified">! static const SpeculatedType SpecFunctionWithDefaultHasInstance    = 1ull &lt;&lt; 2; // It&#39;s definitely a JSFunction that has its ImplementsDefaultHasInstance type info flags bit set.</span>
<span class="line-modified">! static const SpeculatedType SpecFunctionWithNonDefaultHasInstance = 1ull &lt;&lt; 3; // It&#39;s definitely a JSFunction that does not have its ImplementsDefaultHasInstance type info flags bit set.</span>
<span class="line-modified">! static const SpeculatedType SpecFunction                          = SpecFunctionWithDefaultHasInstance | SpecFunctionWithNonDefaultHasInstance; // It&#39;s definitely a JSFunction.</span>
<span class="line-modified">! static const SpeculatedType SpecInt8Array                         = 1ull &lt;&lt; 4; // It&#39;s definitely an Int8Array or one of its subclasses.</span>
<span class="line-modified">! static const SpeculatedType SpecInt16Array                        = 1ull &lt;&lt; 5; // It&#39;s definitely an Int16Array or one of its subclasses.</span>
<span class="line-modified">! static const SpeculatedType SpecInt32Array                        = 1ull &lt;&lt; 6; // It&#39;s definitely an Int32Array or one of its subclasses.</span>
<span class="line-modified">! static const SpeculatedType SpecUint8Array                        = 1ull &lt;&lt; 7; // It&#39;s definitely an Uint8Array or one of its subclasses.</span>
<span class="line-modified">! static const SpeculatedType SpecUint8ClampedArray                 = 1ull &lt;&lt; 8; // It&#39;s definitely an Uint8ClampedArray or one of its subclasses.</span>
<span class="line-modified">! static const SpeculatedType SpecUint16Array                       = 1ull &lt;&lt; 9; // It&#39;s definitely an Uint16Array or one of its subclasses.</span>
<span class="line-modified">! static const SpeculatedType SpecUint32Array                       = 1ull &lt;&lt; 10; // It&#39;s definitely an Uint32Array or one of its subclasses.</span>
<span class="line-modified">! static const SpeculatedType SpecFloat32Array                      = 1ull &lt;&lt; 11; // It&#39;s definitely an Uint16Array or one of its subclasses.</span>
<span class="line-modified">! static const SpeculatedType SpecFloat64Array                      = 1ull &lt;&lt; 12; // It&#39;s definitely an Uint16Array or one of its subclasses.</span>
<span class="line-modified">! static const SpeculatedType SpecTypedArrayView                    = SpecInt8Array | SpecInt16Array | SpecInt32Array | SpecUint8Array | SpecUint8ClampedArray | SpecUint16Array | SpecUint32Array | SpecFloat32Array | SpecFloat64Array;</span>
<span class="line-modified">! static const SpeculatedType SpecDirectArguments                   = 1ull &lt;&lt; 13; // It&#39;s definitely a DirectArguments object.</span>
<span class="line-modified">! static const SpeculatedType SpecScopedArguments                   = 1ull &lt;&lt; 14; // It&#39;s definitely a ScopedArguments object.</span>
<span class="line-modified">! static const SpeculatedType SpecStringObject                      = 1ull &lt;&lt; 15; // It&#39;s definitely a StringObject.</span>
<span class="line-modified">! static const SpeculatedType SpecRegExpObject                      = 1ull &lt;&lt; 16; // It&#39;s definitely a RegExpObject (and not any subclass of RegExpObject).</span>
<span class="line-modified">! static const SpeculatedType SpecMapObject                         = 1ull &lt;&lt; 17; // It&#39;s definitely a Map object or one of its subclasses.</span>
<span class="line-modified">! static const SpeculatedType SpecSetObject                         = 1ull &lt;&lt; 18; // It&#39;s definitely a Set object or one of its subclasses.</span>
<span class="line-modified">! static const SpeculatedType SpecWeakMapObject                     = 1ull &lt;&lt; 19; // It&#39;s definitely a WeakMap object or one of its subclasses.</span>
<span class="line-modified">! static const SpeculatedType SpecWeakSetObject                     = 1ull &lt;&lt; 20; // It&#39;s definitely a WeakSet object or one of its subclasses.</span>
<span class="line-modified">! static const SpeculatedType SpecProxyObject                       = 1ull &lt;&lt; 21; // It&#39;s definitely a Proxy object or one of its subclasses.</span>
<span class="line-modified">! static const SpeculatedType SpecDerivedArray                      = 1ull &lt;&lt; 22; // It&#39;s definitely a DerivedArray object.</span>
<span class="line-modified">! static const SpeculatedType SpecObjectOther                       = 1ull &lt;&lt; 23; // It&#39;s definitely an object but not JSFinalObject, JSArray, or JSFunction.</span>
<span class="line-modified">! static const SpeculatedType SpecStringIdent                       = 1ull &lt;&lt; 24; // It&#39;s definitely a JSString, and it&#39;s an identifier.</span>
<span class="line-modified">! static const SpeculatedType SpecStringVar                         = 1ull &lt;&lt; 25; // It&#39;s definitely a JSString, and it&#39;s not an identifier.</span>
<span class="line-modified">! static const SpeculatedType SpecString                            = SpecStringIdent | SpecStringVar; // It&#39;s definitely a JSString.</span>
<span class="line-modified">! static const SpeculatedType SpecSymbol                            = 1ull &lt;&lt; 26; // It&#39;s definitely a Symbol.</span>
<span class="line-modified">! static const SpeculatedType SpecCellOther                         = 1ull &lt;&lt; 27; // It&#39;s definitely a JSCell but not a subclass of JSObject and definitely not a JSString, BigInt, or Symbol.</span>
<span class="line-modified">! static const SpeculatedType SpecBoolInt32                         = 1ull &lt;&lt; 28; // It&#39;s definitely an Int32 with value 0 or 1.</span>
<span class="line-modified">! static const SpeculatedType SpecNonBoolInt32                      = 1ull &lt;&lt; 29; // It&#39;s definitely an Int32 with value other than 0 or 1.</span>
<span class="line-modified">! static const SpeculatedType SpecInt32Only                         = SpecBoolInt32 | SpecNonBoolInt32; // It&#39;s definitely an Int32.</span>
<span class="line-modified">! </span>
<span class="line-modified">! static const SpeculatedType SpecInt32AsInt52                      = 1ull &lt;&lt; 30; // It&#39;s an Int52 and it can fit in an int32.</span>
<span class="line-modified">! static const SpeculatedType SpecNonInt32AsInt52                   = 1ull &lt;&lt; 31; // It&#39;s an Int52 and it can&#39;t fit in an int32.</span>
<span class="line-modified">! static const SpeculatedType SpecInt52Any                          = SpecInt32AsInt52 | SpecNonInt32AsInt52; // It&#39;s any kind of Int52.</span>
<span class="line-modified">! </span>
<span class="line-modified">! static const SpeculatedType SpecAnyIntAsDouble                    = 1ull &lt;&lt; 32; // It&#39;s definitely an Int52 and it&#39;s inside a double.</span>
<span class="line-modified">! static const SpeculatedType SpecNonIntAsDouble                    = 1ull &lt;&lt; 33; // It&#39;s definitely not an Int52 but it&#39;s a real number and it&#39;s a double.</span>
<span class="line-modified">! static const SpeculatedType SpecDoubleReal                        = SpecNonIntAsDouble | SpecAnyIntAsDouble; // It&#39;s definitely a non-NaN double.</span>
<span class="line-modified">! static const SpeculatedType SpecDoublePureNaN                     = 1ull &lt;&lt; 34; // It&#39;s definitely a NaN that is safe to tag (i.e. pure).</span>
<span class="line-modified">! static const SpeculatedType SpecDoubleImpureNaN                   = 1ull &lt;&lt; 35; // It&#39;s definitely a NaN that is unsafe to tag (i.e. impure).</span>
<span class="line-modified">! static const SpeculatedType SpecDoubleNaN                         = SpecDoublePureNaN | SpecDoubleImpureNaN; // It&#39;s definitely some kind of NaN.</span>
<span class="line-modified">! static const SpeculatedType SpecBytecodeDouble                    = SpecDoubleReal | SpecDoublePureNaN; // It&#39;s either a non-NaN or a NaN double, but it&#39;s definitely not impure NaN.</span>
<span class="line-modified">! static const SpeculatedType SpecFullDouble                        = SpecDoubleReal | SpecDoubleNaN; // It&#39;s either a non-NaN or a NaN double.</span>
<span class="line-modified">! static const SpeculatedType SpecBytecodeRealNumber                = SpecInt32Only | SpecDoubleReal; // It&#39;s either an Int32 or a DoubleReal.</span>
<span class="line-modified">! static const SpeculatedType SpecFullRealNumber                    = SpecInt32Only | SpecInt52Any | SpecDoubleReal; // It&#39;s either an Int32 or a DoubleReal, or an Int52.</span>
<span class="line-modified">! static const SpeculatedType SpecBytecodeNumber                    = SpecInt32Only | SpecBytecodeDouble; // It&#39;s either an Int32 or a Double, and the Double cannot be an impure NaN.</span>
<span class="line-modified">! static const SpeculatedType SpecIntAnyFormat                      = SpecInt52Any | SpecInt32Only | SpecAnyIntAsDouble;</span>
<span class="line-modified">! </span>
<span class="line-modified">! static const SpeculatedType SpecFullNumber                        = SpecIntAnyFormat | SpecFullDouble; // It&#39;s either an Int32, Int52, or a Double, and the Double can be impure NaN.</span>
<span class="line-modified">! static const SpeculatedType SpecBoolean                           = 1ull &lt;&lt; 36; // It&#39;s definitely a Boolean.</span>
<span class="line-modified">! static const SpeculatedType SpecOther                             = 1ull &lt;&lt; 37; // It&#39;s definitely either Null or Undefined.</span>
<span class="line-modified">! static const SpeculatedType SpecMisc                              = SpecBoolean | SpecOther; // It&#39;s definitely either a boolean, Null, or Undefined.</span>
<span class="line-modified">! static const SpeculatedType SpecEmpty                             = 1ull &lt;&lt; 38; // It&#39;s definitely an empty value marker.</span>
<span class="line-modified">! static const SpeculatedType SpecBigInt                            = 1ull &lt;&lt; 39; // It&#39;s definitely a BigInt.</span>
<span class="line-modified">! static const SpeculatedType SpecDataViewObject                    = 1ull &lt;&lt; 40; // It&#39;s definitely a JSDataView.</span>
<span class="line-modified">! static const SpeculatedType SpecPrimitive                         = SpecString | SpecSymbol | SpecBytecodeNumber | SpecMisc | SpecBigInt; // It&#39;s any non-Object JSValue.</span>
<span class="line-modified">! static const SpeculatedType SpecObject                            = SpecFinalObject | SpecArray | SpecFunction | SpecTypedArrayView | SpecDirectArguments | SpecScopedArguments | SpecStringObject | SpecRegExpObject | SpecMapObject | SpecSetObject | SpecWeakMapObject | SpecWeakSetObject | SpecProxyObject | SpecDerivedArray | SpecObjectOther | SpecDataViewObject; // Bitmask used for testing for any kind of object prediction.</span>
<span class="line-modified">! static const SpeculatedType SpecCell                              = SpecObject | SpecString | SpecSymbol | SpecCellOther | SpecBigInt; // It&#39;s definitely a JSCell.</span>
<span class="line-modified">! static const SpeculatedType SpecHeapTop                           = SpecCell | SpecBytecodeNumber | SpecMisc; // It can be any of the above, except for SpecInt52Only and SpecDoubleImpureNaN.</span>
<span class="line-modified">! static const SpeculatedType SpecBytecodeTop                       = SpecHeapTop | SpecEmpty; // It can be any of the above, except for SpecInt52Only and SpecDoubleImpureNaN. Corresponds to what could be found in a bytecode local.</span>
<span class="line-modified">! static const SpeculatedType SpecFullTop                           = SpecBytecodeTop | SpecFullNumber; // It can be anything that bytecode could see plus exotic encodings of numbers.</span>
  
  // SpecCellCheck is the type set representing the values that can flow through a cell check.
  // On 64-bit platforms, the empty value passes a cell check. Also, ~SpecCellCheck is the type
  // set that representing the values that flow through when testing that something is not a cell.
<span class="line-modified">! static const SpeculatedType SpecCellCheck          = is64Bit() ? (SpecCell | SpecEmpty) : SpecCell;</span>
  
  typedef bool (*SpeculatedTypeChecker)(SpeculatedType);
  
  // Dummy prediction checker, only useful if someone insists on requiring a prediction checker.
  inline bool isAnySpeculation(SpeculatedType)
<span class="line-new-header">--- 36,83 ---</span>
  namespace JSC {
  
  class Structure;
  
  typedef uint64_t SpeculatedType;
<span class="line-modified">! static constexpr SpeculatedType SpecNone                              = 0; // We don&#39;t know anything yet.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecFinalObject                       = 1ull &lt;&lt; 0; // It&#39;s definitely a JSFinalObject.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecArray                             = 1ull &lt;&lt; 1; // It&#39;s definitely a JSArray.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecFunctionWithDefaultHasInstance    = 1ull &lt;&lt; 2; // It&#39;s definitely a JSFunction that has its ImplementsDefaultHasInstance type info flags bit set.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecFunctionWithNonDefaultHasInstance = 1ull &lt;&lt; 3; // It&#39;s definitely a JSFunction that does not have its ImplementsDefaultHasInstance type info flags bit set.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecFunction                          = SpecFunctionWithDefaultHasInstance | SpecFunctionWithNonDefaultHasInstance; // It&#39;s definitely a JSFunction.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecInt8Array                         = 1ull &lt;&lt; 4; // It&#39;s definitely an Int8Array or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecInt16Array                        = 1ull &lt;&lt; 5; // It&#39;s definitely an Int16Array or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecInt32Array                        = 1ull &lt;&lt; 6; // It&#39;s definitely an Int32Array or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecUint8Array                        = 1ull &lt;&lt; 7; // It&#39;s definitely an Uint8Array or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecUint8ClampedArray                 = 1ull &lt;&lt; 8; // It&#39;s definitely an Uint8ClampedArray or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecUint16Array                       = 1ull &lt;&lt; 9; // It&#39;s definitely an Uint16Array or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecUint32Array                       = 1ull &lt;&lt; 10; // It&#39;s definitely an Uint32Array or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecFloat32Array                      = 1ull &lt;&lt; 11; // It&#39;s definitely an Uint16Array or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecFloat64Array                      = 1ull &lt;&lt; 12; // It&#39;s definitely an Uint16Array or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecTypedArrayView                    = SpecInt8Array | SpecInt16Array | SpecInt32Array | SpecUint8Array | SpecUint8ClampedArray | SpecUint16Array | SpecUint32Array | SpecFloat32Array | SpecFloat64Array;</span>
<span class="line-modified">! static constexpr SpeculatedType SpecDirectArguments                   = 1ull &lt;&lt; 13; // It&#39;s definitely a DirectArguments object.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecScopedArguments                   = 1ull &lt;&lt; 14; // It&#39;s definitely a ScopedArguments object.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecStringObject                      = 1ull &lt;&lt; 15; // It&#39;s definitely a StringObject.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecRegExpObject                      = 1ull &lt;&lt; 16; // It&#39;s definitely a RegExpObject (and not any subclass of RegExpObject).</span>
<span class="line-modified">! static constexpr SpeculatedType SpecDateObject                        = 1ull &lt;&lt; 17; // It&#39;s definitely a Date object or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecPromiseObject                     = 1ull &lt;&lt; 18; // It&#39;s definitely a Promise object or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecMapObject                         = 1ull &lt;&lt; 19; // It&#39;s definitely a Map object or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecSetObject                         = 1ull &lt;&lt; 20; // It&#39;s definitely a Set object or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecWeakMapObject                     = 1ull &lt;&lt; 21; // It&#39;s definitely a WeakMap object or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecWeakSetObject                     = 1ull &lt;&lt; 22; // It&#39;s definitely a WeakSet object or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecProxyObject                       = 1ull &lt;&lt; 23; // It&#39;s definitely a Proxy object or one of its subclasses.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecDerivedArray                      = 1ull &lt;&lt; 24; // It&#39;s definitely a DerivedArray object.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecObjectOther                       = 1ull &lt;&lt; 25; // It&#39;s definitely an object but not JSFinalObject, JSArray, or JSFunction.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecStringIdent                       = 1ull &lt;&lt; 26; // It&#39;s definitely a JSString, and it&#39;s an identifier.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecStringVar                         = 1ull &lt;&lt; 27; // It&#39;s definitely a JSString, and it&#39;s not an identifier.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecString                            = SpecStringIdent | SpecStringVar; // It&#39;s definitely a JSString.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecSymbol                            = 1ull &lt;&lt; 28; // It&#39;s definitely a Symbol.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecCellOther                         = 1ull &lt;&lt; 29; // It&#39;s definitely a JSCell but not a subclass of JSObject and definitely not a JSString, BigInt, or Symbol.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecBoolInt32                         = 1ull &lt;&lt; 30; // It&#39;s definitely an Int32 with value 0 or 1.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecNonBoolInt32                      = 1ull &lt;&lt; 31; // It&#39;s definitely an Int32 with value other than 0 or 1.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecInt32Only                         = SpecBoolInt32 | SpecNonBoolInt32; // It&#39;s definitely an Int32.</span>
<span class="line-modified">! </span>
<span class="line-modified">! static constexpr SpeculatedType SpecInt32AsInt52                      = 1ull &lt;&lt; 32; // It&#39;s an Int52 and it can fit in an int32.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecNonInt32AsInt52                   = 1ull &lt;&lt; 33; // It&#39;s an Int52 and it can&#39;t fit in an int32.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecInt52Any                          = SpecInt32AsInt52 | SpecNonInt32AsInt52; // It&#39;s any kind of Int52.</span>
<span class="line-modified">! </span>
<span class="line-modified">! static constexpr SpeculatedType SpecAnyIntAsDouble                    = 1ull &lt;&lt; 34; // It&#39;s definitely an Int52 and it&#39;s inside a double.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecNonIntAsDouble                    = 1ull &lt;&lt; 35; // It&#39;s definitely not an Int52 but it&#39;s a real number and it&#39;s a double.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecDoubleReal                        = SpecNonIntAsDouble | SpecAnyIntAsDouble; // It&#39;s definitely a non-NaN double.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecDoublePureNaN                     = 1ull &lt;&lt; 36; // It&#39;s definitely a NaN that is safe to tag (i.e. pure).</span>
<span class="line-modified">! static constexpr SpeculatedType SpecDoubleImpureNaN                   = 1ull &lt;&lt; 37; // It&#39;s definitely a NaN that is unsafe to tag (i.e. impure).</span>
<span class="line-modified">! static constexpr SpeculatedType SpecDoubleNaN                         = SpecDoublePureNaN | SpecDoubleImpureNaN; // It&#39;s definitely some kind of NaN.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecBytecodeDouble                    = SpecDoubleReal | SpecDoublePureNaN; // It&#39;s either a non-NaN or a NaN double, but it&#39;s definitely not impure NaN.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecFullDouble                        = SpecDoubleReal | SpecDoubleNaN; // It&#39;s either a non-NaN or a NaN double.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecBytecodeRealNumber                = SpecInt32Only | SpecDoubleReal; // It&#39;s either an Int32 or a DoubleReal.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecFullRealNumber                    = SpecInt32Only | SpecInt52Any | SpecDoubleReal; // It&#39;s either an Int32 or a DoubleReal, or an Int52.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecBytecodeNumber                    = SpecInt32Only | SpecBytecodeDouble; // It&#39;s either an Int32 or a Double, and the Double cannot be an impure NaN.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecIntAnyFormat                      = SpecInt52Any | SpecInt32Only | SpecAnyIntAsDouble;</span>
<span class="line-modified">! </span>
<span class="line-modified">! static constexpr SpeculatedType SpecFullNumber                        = SpecIntAnyFormat | SpecFullDouble; // It&#39;s either an Int32, Int52, or a Double, and the Double can be impure NaN.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecBoolean                           = 1ull &lt;&lt; 38; // It&#39;s definitely a Boolean.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecOther                             = 1ull &lt;&lt; 39; // It&#39;s definitely either Null or Undefined.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecMisc                              = SpecBoolean | SpecOther; // It&#39;s definitely either a boolean, Null, or Undefined.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecEmpty                             = 1ull &lt;&lt; 40; // It&#39;s definitely an empty value marker.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecBigInt                            = 1ull &lt;&lt; 41; // It&#39;s definitely a BigInt.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecDataViewObject                    = 1ull &lt;&lt; 42; // It&#39;s definitely a JSDataView.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecPrimitive                         = SpecString | SpecSymbol | SpecBytecodeNumber | SpecMisc | SpecBigInt; // It&#39;s any non-Object JSValue.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecObject                            = SpecFinalObject | SpecArray | SpecFunction | SpecTypedArrayView | SpecDirectArguments | SpecScopedArguments | SpecStringObject | SpecRegExpObject | SpecDateObject | SpecPromiseObject | SpecMapObject | SpecSetObject | SpecWeakMapObject | SpecWeakSetObject | SpecProxyObject | SpecDerivedArray | SpecObjectOther | SpecDataViewObject; // Bitmask used for testing for any kind of object prediction.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecCell                              = SpecObject | SpecString | SpecSymbol | SpecCellOther | SpecBigInt; // It&#39;s definitely a JSCell.</span>
<span class="line-modified">! static constexpr SpeculatedType SpecHeapTop                           = SpecCell | SpecBytecodeNumber | SpecMisc; // It can be any of the above, except for SpecInt52Only and SpecDoubleImpureNaN.</span>
<span class="line-added">+ static constexpr SpeculatedType SpecBytecodeTop                       = SpecHeapTop | SpecEmpty; // It can be any of the above, except for SpecInt52Only and SpecDoubleImpureNaN. Corresponds to what could be found in a bytecode local.</span>
<span class="line-added">+ static constexpr SpeculatedType SpecFullTop                           = SpecBytecodeTop | SpecFullNumber; // It can be anything that bytecode could see plus exotic encodings of numbers.</span>
  
  // SpecCellCheck is the type set representing the values that can flow through a cell check.
  // On 64-bit platforms, the empty value passes a cell check. Also, ~SpecCellCheck is the type
  // set that representing the values that flow through when testing that something is not a cell.
<span class="line-modified">! static constexpr SpeculatedType SpecCellCheck          = is64Bit() ? (SpecCell | SpecEmpty) : SpecCell;</span>
  
  typedef bool (*SpeculatedTypeChecker)(SpeculatedType);
  
  // Dummy prediction checker, only useful if someone insists on requiring a prediction checker.
  inline bool isAnySpeculation(SpeculatedType)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 340,16 ***</span>
      return value &amp;&amp; !(value &amp; ~(SpecBoolean | SpecInt32Only));
  }
  
  inline bool isInt32SpeculationForArithmetic(SpeculatedType value)
  {
<span class="line-modified">!     return !(value &amp; (SpecFullDouble | SpecNonInt32AsInt52));</span>
  }
  
  inline bool isInt32OrBooleanSpeculationForArithmetic(SpeculatedType value)
  {
<span class="line-modified">!     return !(value &amp; (SpecFullDouble | SpecNonInt32AsInt52));</span>
  }
  
  inline bool isInt32OrBooleanSpeculationExpectingDefined(SpeculatedType value)
  {
      return isInt32OrBooleanSpeculation(value &amp; ~SpecOther);
<span class="line-new-header">--- 342,16 ---</span>
      return value &amp;&amp; !(value &amp; ~(SpecBoolean | SpecInt32Only));
  }
  
  inline bool isInt32SpeculationForArithmetic(SpeculatedType value)
  {
<span class="line-modified">!     return !(value &amp; (SpecFullDouble | SpecNonInt32AsInt52 | SpecBigInt));</span>
  }
  
  inline bool isInt32OrBooleanSpeculationForArithmetic(SpeculatedType value)
  {
<span class="line-modified">!     return !(value &amp; (SpecFullDouble | SpecNonInt32AsInt52 | SpecBigInt));</span>
  }
  
  inline bool isInt32OrBooleanSpeculationExpectingDefined(SpeculatedType value)
  {
      return isInt32OrBooleanSpeculation(value &amp; ~SpecOther);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 494,11 ***</span>
  SpeculatedType speculationFromCell(JSCell*);
  JS_EXPORT_PRIVATE SpeculatedType speculationFromValue(JSValue);
  // If it&#39;s an anyInt(), it&#39;ll return speculated types from the Int52 lattice.
  // Otherwise, it&#39;ll return types from the JSValue lattice.
  JS_EXPORT_PRIVATE SpeculatedType int52AwareSpeculationFromValue(JSValue);
<span class="line-modified">! SpeculatedType speculationFromJSType(JSType);</span>
  
  SpeculatedType speculationFromTypedArrayType(TypedArrayType); // only valid for typed views.
  TypedArrayType typedArrayTypeFromSpeculation(SpeculatedType);
  
  SpeculatedType leastUpperBoundOfStrictlyEquivalentSpeculations(SpeculatedType);
<span class="line-new-header">--- 496,11 ---</span>
  SpeculatedType speculationFromCell(JSCell*);
  JS_EXPORT_PRIVATE SpeculatedType speculationFromValue(JSValue);
  // If it&#39;s an anyInt(), it&#39;ll return speculated types from the Int52 lattice.
  // Otherwise, it&#39;ll return types from the JSValue lattice.
  JS_EXPORT_PRIVATE SpeculatedType int52AwareSpeculationFromValue(JSValue);
<span class="line-modified">! Optional&lt;SpeculatedType&gt; speculationFromJSType(JSType);</span>
  
  SpeculatedType speculationFromTypedArrayType(TypedArrayType); // only valid for typed views.
  TypedArrayType typedArrayTypeFromSpeculation(SpeculatedType);
  
  SpeculatedType leastUpperBoundOfStrictlyEquivalentSpeculations(SpeculatedType);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 508,10 ***</span>
<span class="line-new-header">--- 510,11 ---</span>
  // Precise computation of the type of the result of a double computation after we
  // already know that the inputs are doubles and that the result must be a double. Use
  // the closest one of these that applies.
  SpeculatedType typeOfDoubleSum(SpeculatedType, SpeculatedType);
  SpeculatedType typeOfDoubleDifference(SpeculatedType, SpeculatedType);
<span class="line-added">+ SpeculatedType typeOfDoubleIncOrDec(SpeculatedType);</span>
  SpeculatedType typeOfDoubleProduct(SpeculatedType, SpeculatedType);
  SpeculatedType typeOfDoubleQuotient(SpeculatedType, SpeculatedType);
  SpeculatedType typeOfDoubleMinMax(SpeculatedType, SpeculatedType);
  SpeculatedType typeOfDoubleNegation(SpeculatedType);
  SpeculatedType typeOfDoubleAbs(SpeculatedType);
</pre>
<center><a href="SpeculatedType.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="StructureStubClearingWatchpoint.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>