<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/JavaScriptCore/inspector/scripts/codegen/generate_js_backend_commands.py</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="generate_cpp_protocol_types_implementation.py.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="generate_objc_backend_dispatcher_implementation.py.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/inspector/scripts/codegen/generate_js_backend_commands.py</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -63,93 +63,101 @@</span>
          sections.extend(list(map(self.generate_domain, self.domains_to_generate())))
          return &quot;\n\n&quot;.join(sections)
  
      def generate_domain(self, domain):
          lines = []
<span class="udiff-line-removed">-         args = {</span>
<span class="udiff-line-removed">-             &#39;domain&#39;: domain.domain_name</span>
<span class="udiff-line-removed">-         }</span>
  
<span class="udiff-line-modified-removed">-         lines.append(&#39;// %(domain)s.&#39; % args)</span>
<span class="udiff-line-modified-added">+         comment_args = {</span>
<span class="udiff-line-added">+             &#39;domainName&#39;: domain.domain_name,</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+         lines.append(&#39;// %(domainName)s&#39; % comment_args)</span>
  
          version = self.version_for_domain(domain)
          type_declarations = self.type_declarations_for_domain(domain)
          commands = self.commands_for_domain(domain)
          events = self.events_for_domain(domain)
  
<span class="udiff-line-modified-removed">-         has_async_commands = any([command.is_async for command in commands])</span>
<span class="udiff-line-modified-removed">-         if len(events) &gt; 0 or has_async_commands:</span>
<span class="udiff-line-modified-removed">-             lines.append(&#39;InspectorBackend.register%(domain)sDispatcher = InspectorBackend.registerDomainDispatcher.bind(InspectorBackend, &quot;%(domain)s&quot;);&#39; % args)</span>
<span class="udiff-line-modified-added">+         domain_args = {</span>
<span class="udiff-line-modified-added">+             &#39;domainName&#39;: domain.domain_name,</span>
<span class="udiff-line-modified-added">+             &#39;targetTypes&#39;: json.dumps(domain.target_types),</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+         lines.append(&#39;InspectorBackend.registerDomain(&quot;%(domainName)s&quot;, %(targetTypes)s);&#39; % domain_args)</span>
  
          if isinstance(version, int):
              version_args = {
<span class="udiff-line-modified-removed">-                 &#39;domain&#39;: domain.domain_name,</span>
<span class="udiff-line-modified-added">+                 &#39;domainName&#39;: domain.domain_name,</span>
                  &#39;version&#39;: version
              }
<span class="udiff-line-modified-removed">-             lines.append(&#39;InspectorBackend.registerVersion(&quot;%(domain)s&quot;, %(version)s);&#39; % version_args)</span>
<span class="udiff-line-modified-added">+             lines.append(&#39;InspectorBackend.registerVersion(&quot;%(domainName)s&quot;, %(version)s);&#39; % version_args)</span>
  
          for declaration in type_declarations:
              if declaration.type.is_enum():
                  enum_args = {
<span class="udiff-line-modified-removed">-                     &#39;domain&#39;: domain.domain_name,</span>
<span class="udiff-line-modified-added">+                     &#39;domainName&#39;: domain.domain_name,</span>
                      &#39;enumName&#39;: declaration.type_name,
                      &#39;enumMap&#39;: &quot;, &quot;.join([&#39;%s: &quot;%s&quot;&#39; % (Generator.stylized_name_for_enum_value(enum_value), enum_value) for enum_value in declaration.type.enum_values()])
                  }
<span class="udiff-line-modified-removed">-                 lines.append(&#39;InspectorBackend.registerEnum(&quot;%(domain)s.%(enumName)s&quot;, {%(enumMap)s});&#39; % enum_args)</span>
<span class="udiff-line-modified-added">+                 lines.append(&#39;InspectorBackend.registerEnum(&quot;%(domainName)s.%(enumName)s&quot;, {%(enumMap)s});&#39; % enum_args)</span>
  
              def is_anonymous_enum_member(type_member):
                  return isinstance(type_member.type, EnumType) and type_member.type.is_anonymous
  
              for _member in filter(is_anonymous_enum_member, declaration.type_members):
                  enum_args = {
<span class="udiff-line-modified-removed">-                     &#39;domain&#39;: domain.domain_name,</span>
<span class="udiff-line-modified-added">+                     &#39;domainName&#39;: domain.domain_name,</span>
                      &#39;enumName&#39;: &#39;%s%s&#39; % (declaration.type_name, ucfirst(_member.member_name)),
                      &#39;enumMap&#39;: &quot;, &quot;.join([&#39;%s: &quot;%s&quot;&#39; % (Generator.stylized_name_for_enum_value(enum_value), enum_value) for enum_value in _member.type.enum_values()])
                  }
<span class="udiff-line-modified-removed">-                 lines.append(&#39;InspectorBackend.registerEnum(&quot;%(domain)s.%(enumName)s&quot;, {%(enumMap)s});&#39; % enum_args)</span>
<span class="udiff-line-modified-added">+                 lines.append(&#39;InspectorBackend.registerEnum(&quot;%(domainName)s.%(enumName)s&quot;, {%(enumMap)s});&#39; % enum_args)</span>
  
          def is_anonymous_enum_param(param):
              return isinstance(param.type, EnumType) and param.type.is_anonymous
  
<span class="udiff-line-removed">-         for event in events:</span>
<span class="udiff-line-removed">-             for param in filter(is_anonymous_enum_param, event.event_parameters):</span>
<span class="udiff-line-removed">-                 enum_args = {</span>
<span class="udiff-line-removed">-                     &#39;domain&#39;: domain.domain_name,</span>
<span class="udiff-line-removed">-                     &#39;enumName&#39;: &#39;%s%s&#39; % (ucfirst(event.event_name), ucfirst(param.parameter_name)),</span>
<span class="udiff-line-removed">-                     &#39;enumMap&#39;: &quot;, &quot;.join([&#39;%s: &quot;%s&quot;&#39; % (Generator.stylized_name_for_enum_value(enum_value), enum_value) for enum_value in param.type.enum_values()])</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-                 lines.append(&#39;InspectorBackend.registerEnum(&quot;%(domain)s.%(enumName)s&quot;, {%(enumMap)s});&#39; % enum_args)</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             event_args = {</span>
<span class="udiff-line-removed">-                 &#39;domain&#39;: domain.domain_name,</span>
<span class="udiff-line-removed">-                 &#39;eventName&#39;: event.event_name,</span>
<span class="udiff-line-removed">-                 &#39;params&#39;: &quot;, &quot;.join([&#39;&quot;%s&quot;&#39; % parameter.parameter_name for parameter in event.event_parameters])</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-             lines.append(&#39;InspectorBackend.registerEvent(&quot;%(domain)s.%(eventName)s&quot;, [%(params)s]);&#39; % event_args)</span>
<span class="udiff-line-removed">- </span>
          for command in commands:
              def generate_parameter_object(parameter):
<span class="udiff-line-removed">-                 optional_string = &quot;true&quot; if parameter.is_optional else &quot;false&quot;</span>
                  pairs = []
                  pairs.append(&#39;&quot;name&quot;: &quot;%s&quot;&#39; % parameter.parameter_name)
                  pairs.append(&#39;&quot;type&quot;: &quot;%s&quot;&#39; % Generator.js_name_for_parameter_type(parameter.type))
<span class="udiff-line-modified-removed">-                 pairs.append(&#39;&quot;optional&quot;: %s&#39; % optional_string)</span>
<span class="udiff-line-modified-added">+                 if parameter.is_optional:</span>
<span class="udiff-line-added">+                     pairs.append(&#39;&quot;optional&quot;: true&#39;)</span>
                  return &quot;{%s}&quot; % &quot;, &quot;.join(pairs)
  
              command_args = {
<span class="udiff-line-modified-removed">-                 &#39;domain&#39;: domain.domain_name,</span>
<span class="udiff-line-modified-added">+                 &#39;domainName&#39;: domain.domain_name,</span>
                  &#39;commandName&#39;: command.command_name,
<span class="udiff-line-added">+                 &#39;targetTypes&#39;: json.dumps(command.target_types),</span>
                  &#39;callParams&#39;: &quot;, &quot;.join([generate_parameter_object(parameter) for parameter in command.call_parameters]),
                  &#39;returnParams&#39;: &quot;, &quot;.join([&#39;&quot;%s&quot;&#39; % parameter.parameter_name for parameter in command.return_parameters]),
              }
<span class="udiff-line-modified-removed">-             lines.append(&#39;InspectorBackend.registerCommand(&quot;%(domain)s.%(commandName)s&quot;, [%(callParams)s], [%(returnParams)s]);&#39; % command_args)</span>
<span class="udiff-line-modified-added">+             lines.append(&#39;InspectorBackend.registerCommand(&quot;%(domainName)s.%(commandName)s&quot;, %(targetTypes)s, [%(callParams)s], [%(returnParams)s]);&#39; % command_args)</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         for event in events:</span>
<span class="udiff-line-added">+             for param in filter(is_anonymous_enum_param, event.event_parameters):</span>
<span class="udiff-line-added">+                 enum_args = {</span>
<span class="udiff-line-added">+                     &#39;domainName&#39;: domain.domain_name,</span>
<span class="udiff-line-added">+                     &#39;enumName&#39;: &#39;%s%s&#39; % (ucfirst(event.event_name), ucfirst(param.parameter_name)),</span>
<span class="udiff-line-added">+                     &#39;enumMap&#39;: &quot;, &quot;.join([&#39;%s: &quot;%s&quot;&#39; % (Generator.stylized_name_for_enum_value(enum_value), enum_value) for enum_value in param.type.enum_values()]),</span>
<span class="udiff-line-added">+                 }</span>
<span class="udiff-line-added">+                 lines.append(&#39;InspectorBackend.registerEnum(&quot;%(domainName)s.%(enumName)s&quot;, {%(enumMap)s});&#39; % enum_args)</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+             event_args = {</span>
<span class="udiff-line-added">+                 &#39;domainName&#39;: domain.domain_name,</span>
<span class="udiff-line-added">+                 &#39;eventName&#39;: event.event_name,</span>
<span class="udiff-line-added">+                 &#39;targetTypes&#39;: json.dumps(event.target_types),</span>
<span class="udiff-line-added">+                 &#39;params&#39;: &quot;, &quot;.join([&#39;&quot;%s&quot;&#39; % parameter.parameter_name for parameter in event.event_parameters]),</span>
<span class="udiff-line-added">+             }</span>
<span class="udiff-line-added">+             lines.append(&#39;InspectorBackend.registerEvent(&quot;%(domainName)s.%(eventName)s&quot;, %(targetTypes)s, [%(params)s]);&#39; % event_args)</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         has_async_commands = any([command.is_async for command in commands])</span>
<span class="udiff-line-added">+         if len(events) &gt; 0 or has_async_commands:</span>
<span class="udiff-line-added">+             dispatcher_args = {</span>
<span class="udiff-line-added">+                 &#39;domainName&#39;: domain.domain_name,</span>
<span class="udiff-line-added">+             }</span>
<span class="udiff-line-added">+             lines.append(&#39;InspectorBackend.register%(domainName)sDispatcher = InspectorBackend.registerDispatcher.bind(InspectorBackend, &quot;%(domainName)s&quot;);&#39; % dispatcher_args)</span>
  
          activate_args = {
<span class="udiff-line-modified-removed">-             &#39;domain&#39;: domain.domain_name,</span>
<span class="udiff-line-modified-removed">-             &#39;availability&#39;: json.dumps(domain.availability) if domain.availability else &#39;&#39;,</span>
<span class="udiff-line-modified-added">+             &#39;domainName&#39;: domain.domain_name,</span>
<span class="udiff-line-modified-added">+             &#39;debuggableTypes&#39;: json.dumps(domain.debuggable_types),</span>
          }
<span class="udiff-line-modified-removed">-         if domain.availability:</span>
<span class="udiff-line-removed">-             lines.append(&#39;InspectorBackend.activateDomain(&quot;%(domain)s&quot;, %(availability)s);&#39; % activate_args)</span>
<span class="udiff-line-removed">-         else:</span>
<span class="udiff-line-removed">-             lines.append(&#39;InspectorBackend.activateDomain(&quot;%(domain)s&quot;);&#39; % activate_args)</span>
<span class="udiff-line-modified-added">+         lines.append(&#39;InspectorBackend.activateDomain(&quot;%(domainName)s&quot;, %(debuggableTypes)s);&#39; % activate_args)</span>
  
          return &quot;\n&quot;.join(lines)
</pre>
<center><a href="generate_cpp_protocol_types_implementation.py.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="generate_objc_backend_dispatcher_implementation.py.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>