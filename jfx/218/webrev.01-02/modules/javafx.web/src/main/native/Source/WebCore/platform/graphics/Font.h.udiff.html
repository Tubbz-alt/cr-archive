<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/Font.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Font.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="FontCache.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/Font.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -33,25 +33,23 @@</span>
  #include &quot;OpenTypeMathData.h&quot;
  #if ENABLE(OPENTYPE_VERTICAL)
  #include &quot;OpenTypeVerticalData.h&quot;
  #endif
  #include &lt;wtf/BitVector.h&gt;
<span class="udiff-line-added">+ #include &lt;wtf/Hasher.h&gt;</span>
  #include &lt;wtf/Optional.h&gt;
  #include &lt;wtf/text/StringHash.h&gt;
  
  #if PLATFORM(COCOA)
<span class="udiff-line-added">+ #include &lt;CoreFoundation/CoreFoundation.h&gt;</span>
  #include &lt;wtf/RetainPtr.h&gt;
  #endif
  
  #if PLATFORM(WIN)
  #include &lt;usp10.h&gt;
  #endif
  
<span class="udiff-line-removed">- #if USE(CG)</span>
<span class="udiff-line-removed">- #include &lt;pal/spi/cg/CoreGraphicsSPI.h&gt;</span>
<span class="udiff-line-removed">- #endif</span>
<span class="udiff-line-removed">- </span>
  #if USE(DIRECT2D)
  interface IDWriteFactory5;
  interface IDWriteGdiInterop;
  #endif
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -65,11 +63,13 @@</span>
  
  enum FontVariant { AutoVariant, NormalVariant, SmallCapsVariant, EmphasisMarkVariant, BrokenIdeographVariant };
  enum Pitch { UnknownPitch, FixedPitch, VariablePitch };
  enum class IsForPlatformFont : uint8_t { No, Yes };
  
<span class="udiff-line-added">+ DECLARE_ALLOCATOR_WITH_HEAP_IDENTIFIER(Font);</span>
  class Font : public RefCounted&lt;Font&gt; {
<span class="udiff-line-added">+     WTF_MAKE_FAST_ALLOCATED_WITH_HEAP_IDENTIFIER(Font);</span>
  public:
      // Used to create platform fonts.
      enum class Origin : uint8_t {
          Remote,
          Local
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -185,21 +185,22 @@</span>
      Pitch pitch() const { return m_treatAsFixedPitch ? FixedPitch : VariablePitch; }
  
      Origin origin() const { return m_origin; }
      bool isInterstitial() const { return m_isInterstitial; }
      Visibility visibility() const { return m_visibility; }
<span class="udiff-line-added">+     bool allowsAntialiasing() const { return m_allowsAntialiasing; }</span>
  
  #if !LOG_DISABLED
      String description() const;
  #endif
  
  #if PLATFORM(IOS_FAMILY)
      bool shouldNotBeUsedForArabic() const { return m_shouldNotBeUsedForArabic; };
  #endif
  #if PLATFORM(COCOA)
      CTFontRef getCTFont() const { return m_platformData.font(); }
<span class="udiff-line-modified-removed">-     CFDictionaryRef getCFStringAttributes(bool enableKerning, FontOrientation) const;</span>
<span class="udiff-line-modified-added">+     RetainPtr&lt;CFDictionaryRef&gt; getCFStringAttributes(bool enableKerning, FontOrientation, const AtomString&amp; locale) const;</span>
      const BitVector&amp; glyphsSupportedBySmallCaps() const;
      const BitVector&amp; glyphsSupportedByAllSmallCaps() const;
      const BitVector&amp; glyphsSupportedByPetiteCaps() const;
      const BitVector&amp; glyphsSupportedByAllPetiteCaps() const;
  #endif
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -207,22 +208,25 @@</span>
  #if HAVE(DISALLOWABLE_USER_INSTALLED_FONTS)
      bool isUserInstalledFont() const;
  #endif
  
      bool canRenderCombiningCharacterSequence(const UChar*, size_t) const;
<span class="udiff-line-modified-removed">-     bool applyTransforms(GlyphBufferGlyph*, GlyphBufferAdvance*, size_t glyphCount, bool enableKerning, bool requiresShaping) const;</span>
<span class="udiff-line-modified-added">+     void applyTransforms(GlyphBuffer&amp;, unsigned beginningIndex, bool enableKerning, bool requiresShaping, const AtomString&amp; locale) const;</span>
  
  #if PLATFORM(WIN)
      SCRIPT_FONTPROPERTIES* scriptFontProperties() const;
      SCRIPT_CACHE* scriptCache() const { return &amp;m_scriptCache; }
      static void setShouldApplyMacAscentHack(bool);
      static bool shouldApplyMacAscentHack();
      static float ascentConsideringMacAscentHack(const WCHAR*, float ascent, float descent);
  #endif
  
<span class="udiff-line-added">+     SharedBuffer* fontFaceData() const { return m_fontFaceData.get(); }</span>
<span class="udiff-line-added">+     void setFontFaceData(RefPtr&lt;SharedBuffer&gt;&amp;&amp;);</span>
<span class="udiff-line-added">+ </span>
  private:
<span class="udiff-line-modified-removed">-     Font(const FontPlatformData&amp;, Origin, Interstitial, Visibility, OrientationFallback);</span>
<span class="udiff-line-modified-added">+     WEBCORE_EXPORT Font(const FontPlatformData&amp;, Origin, Interstitial, Visibility, OrientationFallback);</span>
  
      void platformInit();
      void platformGlyphInit();
      void platformCharWidthInit();
      void platformDestroy();
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -277,12 +281,10 @@</span>
      };
  
      mutable std::unique_ptr&lt;DerivedFonts&gt; m_derivedFontData;
  
  #if PLATFORM(COCOA)
<span class="udiff-line-removed">-     mutable RetainPtr&lt;CFMutableDictionaryRef&gt; m_nonKernedCFStringAttributes;</span>
<span class="udiff-line-removed">-     mutable RetainPtr&lt;CFMutableDictionaryRef&gt; m_kernedCFStringAttributes;</span>
      mutable Optional&lt;BitVector&gt; m_glyphsSupportedBySmallCaps;
      mutable Optional&lt;BitVector&gt; m_glyphsSupportedByAllSmallCaps;
      mutable Optional&lt;BitVector&gt; m_glyphsSupportedByPetiteCaps;
      mutable Optional&lt;BitVector&gt; m_glyphsSupportedByAllPetiteCaps;
  #endif
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -290,10 +292,12 @@</span>
  #if PLATFORM(WIN)
      mutable SCRIPT_CACHE m_scriptCache;
      mutable SCRIPT_FONTPROPERTIES* m_scriptFontProperties;
  #endif
  
<span class="udiff-line-added">+     RefPtr&lt;SharedBuffer&gt; m_fontFaceData;</span>
<span class="udiff-line-added">+ </span>
      Glyph m_spaceGlyph { 0 };
      Glyph m_zeroGlyph { 0 };
      Glyph m_zeroWidthSpaceGlyph { 0 };
  
      Origin m_origin; // Whether or not we are custom font loaded via @font-face
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -313,15 +317,25 @@</span>
      unsigned m_isBrokenIdeographFallback : 1;
      unsigned m_hasVerticalGlyphs : 1;
  
      unsigned m_isUsedInSystemFallbackCache : 1;
  
<span class="udiff-line-added">+     unsigned m_allowsAntialiasing : 1;</span>
<span class="udiff-line-added">+ </span>
  #if PLATFORM(IOS_FAMILY)
      unsigned m_shouldNotBeUsedForArabic : 1;
  #endif
  };
  
<span class="udiff-line-added">+ class FontHandle {</span>
<span class="udiff-line-added">+ public:</span>
<span class="udiff-line-added">+     FontHandle() = default;</span>
<span class="udiff-line-added">+     WEBCORE_EXPORT FontHandle(Ref&lt;SharedBuffer&gt;&amp;&amp; fontFaceData, Font::Origin, float fontSize, bool syntheticBold, bool syntheticItalic);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     RefPtr&lt;Font&gt; font;</span>
<span class="udiff-line-added">+ };</span>
<span class="udiff-line-added">+ </span>
  #if PLATFORM(IOS_FAMILY)
  bool fontFamilyShouldNotBeUsedForArabic(CFStringRef);
  #endif
  
  ALWAYS_INLINE FloatRect Font::boundsForGlyph(Glyph glyph) const
</pre>
<center><a href="Font.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="FontCache.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>