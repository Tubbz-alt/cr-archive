<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/Modules/entriesapi/DOMFileSystem.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../encryptedmedia/legacy/WebKitMediaKeySession.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="DOMFileSystem.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/Modules/entriesapi/DOMFileSystem.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
316         callOnMainThread([this, context = WTFMove(context), resolvedVirtualPath = crossThreadCopy(resolvedVirtualPath), entryType, completionCallback = WTFMove(completionCallback)]() mutable {
317             if (!entryType) {
318                 completionCallback(Exception { NotFoundError, &quot;Cannot find entry at given path&quot;_s });
319                 return;
320             }
321             switch (entryType.value()) {
322             case FileMetadata::Type::Directory:
323                 completionCallback(Ref&lt;FileSystemEntry&gt; { FileSystemDirectoryEntry::create(context, *this, resolvedVirtualPath) });
324                 break;
325             case FileMetadata::Type::File:
326                 completionCallback(Ref&lt;FileSystemEntry&gt; { FileSystemFileEntry::create(context, *this, resolvedVirtualPath) });
327                 break;
328             default:
329                 completionCallback(Exception { NotFoundError, &quot;Cannot find entry at given path&quot;_s });
330                 break;
331             }
332         });
333     });
334 }
335 
<span class="line-modified">336 void DOMFileSystem::getFile(ScriptExecutionContext&amp; context, FileSystemFileEntry&amp; fileEntry, GetFileCallback&amp;&amp; completionCallback)</span>
337 {
338     auto virtualPath = fileEntry.virtualPath();
339     auto fullPath = evaluatePath(virtualPath);
<span class="line-modified">340     m_workQueue-&gt;dispatch([context = makeRef(context), fullPath = crossThreadCopy(fullPath), virtualPath = crossThreadCopy(virtualPath), completionCallback = WTFMove(completionCallback)]() mutable {</span>
341         auto validatedVirtualPath = validatePathIsExpectedType(fullPath, WTFMove(virtualPath), FileMetadata::Type::File);
<span class="line-modified">342         callOnMainThread([context = WTFMove(context), fullPath = crossThreadCopy(fullPath), validatedVirtualPath = crossThreadCopy(validatedVirtualPath), completionCallback = WTFMove(completionCallback)]() mutable {</span>
343             if (validatedVirtualPath.hasException())
344                 completionCallback(validatedVirtualPath.releaseException());
345             else
<span class="line-modified">346                 completionCallback(File::create(context-&gt;sessionID(), fullPath));</span>
347         });
348     });
349 }
350 
351 } // namespace WebCore
</pre>
</td>
<td>
<hr />
<pre>
316         callOnMainThread([this, context = WTFMove(context), resolvedVirtualPath = crossThreadCopy(resolvedVirtualPath), entryType, completionCallback = WTFMove(completionCallback)]() mutable {
317             if (!entryType) {
318                 completionCallback(Exception { NotFoundError, &quot;Cannot find entry at given path&quot;_s });
319                 return;
320             }
321             switch (entryType.value()) {
322             case FileMetadata::Type::Directory:
323                 completionCallback(Ref&lt;FileSystemEntry&gt; { FileSystemDirectoryEntry::create(context, *this, resolvedVirtualPath) });
324                 break;
325             case FileMetadata::Type::File:
326                 completionCallback(Ref&lt;FileSystemEntry&gt; { FileSystemFileEntry::create(context, *this, resolvedVirtualPath) });
327                 break;
328             default:
329                 completionCallback(Exception { NotFoundError, &quot;Cannot find entry at given path&quot;_s });
330                 break;
331             }
332         });
333     });
334 }
335 
<span class="line-modified">336 void DOMFileSystem::getFile(FileSystemFileEntry&amp; fileEntry, GetFileCallback&amp;&amp; completionCallback)</span>
337 {
338     auto virtualPath = fileEntry.virtualPath();
339     auto fullPath = evaluatePath(virtualPath);
<span class="line-modified">340     m_workQueue-&gt;dispatch([fullPath = crossThreadCopy(fullPath), virtualPath = crossThreadCopy(virtualPath), completionCallback = WTFMove(completionCallback)]() mutable {</span>
341         auto validatedVirtualPath = validatePathIsExpectedType(fullPath, WTFMove(virtualPath), FileMetadata::Type::File);
<span class="line-modified">342         callOnMainThread([fullPath = crossThreadCopy(fullPath), validatedVirtualPath = crossThreadCopy(validatedVirtualPath), completionCallback = WTFMove(completionCallback)]() mutable {</span>
343             if (validatedVirtualPath.hasException())
344                 completionCallback(validatedVirtualPath.releaseException());
345             else
<span class="line-modified">346                 completionCallback(File::create(fullPath));</span>
347         });
348     });
349 }
350 
351 } // namespace WebCore
</pre>
</td>
</tr>
</table>
<center><a href="../encryptedmedia/legacy/WebKitMediaKeySession.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="DOMFileSystem.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>