<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/Modules/indexeddb/shared/IDBDatabaseInfo.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="IDBCursorRecord.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="IDBDatabaseInfo.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/Modules/indexeddb/shared/IDBDatabaseInfo.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 19  * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 20  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 21  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 22  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 23  * THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #include &quot;config.h&quot;
 27 #include &quot;IDBDatabaseInfo.h&quot;
 28 
 29 #include &lt;wtf/text/StringBuilder.h&gt;
 30 
 31 #if ENABLE(INDEXED_DATABASE)
 32 
 33 namespace WebCore {
 34 
 35 IDBDatabaseInfo::IDBDatabaseInfo()
 36 {
 37 }
 38 
<span class="line-modified"> 39 IDBDatabaseInfo::IDBDatabaseInfo(const String&amp; name, uint64_t version)</span>
 40     : m_name(name)
 41     , m_version(version)

 42 {
 43 }
 44 
 45 IDBDatabaseInfo::IDBDatabaseInfo(const IDBDatabaseInfo&amp; other, IsolatedCopyTag)
 46     : m_name(other.m_name.isolatedCopy())
 47     , m_version(other.m_version)
 48     , m_maxObjectStoreID(other.m_maxObjectStoreID)

 49 {
 50     for (const auto&amp; entry : other.m_objectStoreMap)
 51         m_objectStoreMap.set(entry.key, entry.value.isolatedCopy());
 52 }
 53 
 54 IDBDatabaseInfo IDBDatabaseInfo::isolatedCopy() const
 55 {
 56     return { *this, IDBDatabaseInfo::IsolatedCopy };
 57 }
 58 
 59 bool IDBDatabaseInfo::hasObjectStore(const String&amp; name) const
 60 {
 61     for (auto&amp; objectStore : m_objectStoreMap.values()) {
 62         if (objectStore.name() == name)
 63             return true;
 64     }
 65 
 66     return false;
 67 }
 68 
</pre>
<hr />
<pre>
151 }
152 
153 void IDBDatabaseInfo::deleteObjectStore(uint64_t objectStoreIdentifier)
154 {
155     m_objectStoreMap.remove(objectStoreIdentifier);
156 }
157 
158 #if !LOG_DISABLED
159 
160 String IDBDatabaseInfo::loggingString() const
161 {
162     StringBuilder builder;
163     builder.append(&quot;Database:&quot;, m_name, &quot; version &quot;, m_version, &#39;\n&#39;);
164     for (auto&amp; objectStore : m_objectStoreMap.values())
165         builder.append(objectStore.loggingString(1), &#39;\n&#39;);
166     return builder.toString();
167 }
168 
169 #endif
170 






171 } // namespace WebCore
172 
173 #endif // ENABLE(INDEXED_DATABASE)
</pre>
</td>
<td>
<hr />
<pre>
 19  * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 20  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 21  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 22  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 23  * THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #include &quot;config.h&quot;
 27 #include &quot;IDBDatabaseInfo.h&quot;
 28 
 29 #include &lt;wtf/text/StringBuilder.h&gt;
 30 
 31 #if ENABLE(INDEXED_DATABASE)
 32 
 33 namespace WebCore {
 34 
 35 IDBDatabaseInfo::IDBDatabaseInfo()
 36 {
 37 }
 38 
<span class="line-modified"> 39 IDBDatabaseInfo::IDBDatabaseInfo(const String&amp; name, uint64_t version, uint64_t maxIndexID)</span>
 40     : m_name(name)
 41     , m_version(version)
<span class="line-added"> 42     , m_maxIndexID(maxIndexID)</span>
 43 {
 44 }
 45 
 46 IDBDatabaseInfo::IDBDatabaseInfo(const IDBDatabaseInfo&amp; other, IsolatedCopyTag)
 47     : m_name(other.m_name.isolatedCopy())
 48     , m_version(other.m_version)
 49     , m_maxObjectStoreID(other.m_maxObjectStoreID)
<span class="line-added"> 50     , m_maxIndexID(other.m_maxIndexID)</span>
 51 {
 52     for (const auto&amp; entry : other.m_objectStoreMap)
 53         m_objectStoreMap.set(entry.key, entry.value.isolatedCopy());
 54 }
 55 
 56 IDBDatabaseInfo IDBDatabaseInfo::isolatedCopy() const
 57 {
 58     return { *this, IDBDatabaseInfo::IsolatedCopy };
 59 }
 60 
 61 bool IDBDatabaseInfo::hasObjectStore(const String&amp; name) const
 62 {
 63     for (auto&amp; objectStore : m_objectStoreMap.values()) {
 64         if (objectStore.name() == name)
 65             return true;
 66     }
 67 
 68     return false;
 69 }
 70 
</pre>
<hr />
<pre>
153 }
154 
155 void IDBDatabaseInfo::deleteObjectStore(uint64_t objectStoreIdentifier)
156 {
157     m_objectStoreMap.remove(objectStoreIdentifier);
158 }
159 
160 #if !LOG_DISABLED
161 
162 String IDBDatabaseInfo::loggingString() const
163 {
164     StringBuilder builder;
165     builder.append(&quot;Database:&quot;, m_name, &quot; version &quot;, m_version, &#39;\n&#39;);
166     for (auto&amp; objectStore : m_objectStoreMap.values())
167         builder.append(objectStore.loggingString(1), &#39;\n&#39;);
168     return builder.toString();
169 }
170 
171 #endif
172 
<span class="line-added">173 void IDBDatabaseInfo::setMaxIndexID(uint64_t maxIndexID)</span>
<span class="line-added">174 {</span>
<span class="line-added">175     ASSERT(maxIndexID &gt; m_maxIndexID || (!maxIndexID &amp;&amp; !m_maxIndexID));</span>
<span class="line-added">176     m_maxIndexID = maxIndexID;</span>
<span class="line-added">177 }</span>
<span class="line-added">178 </span>
179 } // namespace WebCore
180 
181 #endif // ENABLE(INDEXED_DATABASE)
</pre>
</td>
</tr>
</table>
<center><a href="IDBCursorRecord.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="IDBDatabaseInfo.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>