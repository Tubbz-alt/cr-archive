<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/WebCore/html/LinkRelAttribute.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (C) 2011 Google Inc. All rights reserved.
  3  *
  4  * Redistribution and use in source and binary forms, with or without
  5  * modification, are permitted provided that the following conditions are
  6  * met:
  7  *
  8  *     * Redistributions of source code must retain the above copyright
  9  * notice, this list of conditions and the following disclaimer.
 10  *     * Redistributions in binary form must reproduce the above
 11  * copyright notice, this list of conditions and the following disclaimer
 12  * in the documentation and/or other materials provided with the
 13  * distribution.
 14  *     * Neither the name of Google Inc. nor the names of its
 15  * contributors may be used to endorse or promote products derived from
 16  * this software without specific prior written permission.
 17  *
 18  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 19  * &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 20  * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 21  * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 22  * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 23  * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 24  * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 25  * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 26  * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 27  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 28  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 29  *
 30  */
 31 
 32 #include &quot;config.h&quot;
 33 #include &quot;LinkRelAttribute.h&quot;
 34 
 35 #include &quot;Document.h&quot;
 36 #include &quot;LinkIconType.h&quot;
 37 #include &quot;RuntimeEnabledFeatures.h&quot;
 38 #include &quot;Settings.h&quot;
 39 #include &lt;wtf/text/StringView.h&gt;
 40 #include &lt;wtf/text/WTFString.h&gt;
 41 
 42 namespace WebCore {
 43 
 44 LinkRelAttribute::LinkRelAttribute()
<a name="1" id="anc1"></a><span class="line-added"> 45     : iconType()</span>
<span class="line-added"> 46     , isStyleSheet(false)</span>
<span class="line-added"> 47     , isAlternate(false)</span>
<span class="line-added"> 48     , isDNSPrefetch(false)</span>
<span class="line-added"> 49     , isLinkPreload(false)</span>
<span class="line-added"> 50     , isLinkPreconnect(false)</span>
<span class="line-added"> 51     , isLinkPrefetch(false)</span>
<span class="line-added"> 52 #if ENABLE(APPLICATION_MANIFEST)</span>
<span class="line-added"> 53     , isApplicationManifest(false)</span>
<span class="line-added"> 54 #endif</span>
 55 {
 56 }
 57 
 58 // Keep LinkRelAttribute::isSupported() in sync when updating this constructor.
 59 LinkRelAttribute::LinkRelAttribute(Document&amp; document, const String&amp; rel)
<a name="2" id="anc2"></a><span class="line-added"> 60     : LinkRelAttribute()</span>
 61 {
 62     if (equalLettersIgnoringASCIICase(rel, &quot;stylesheet&quot;))
 63         isStyleSheet = true;
 64     else if (equalLettersIgnoringASCIICase(rel, &quot;icon&quot;) || equalLettersIgnoringASCIICase(rel, &quot;shortcut icon&quot;))
 65         iconType = LinkIconType::Favicon;
 66     else if (equalLettersIgnoringASCIICase(rel, &quot;apple-touch-icon&quot;))
 67         iconType = LinkIconType::TouchIcon;
 68     else if (equalLettersIgnoringASCIICase(rel, &quot;apple-touch-icon-precomposed&quot;))
 69         iconType = LinkIconType::TouchPrecomposedIcon;
 70     else if (equalLettersIgnoringASCIICase(rel, &quot;dns-prefetch&quot;))
 71         isDNSPrefetch = true;
 72     else if (document.settings().linkPreconnectEnabled() &amp;&amp; equalLettersIgnoringASCIICase(rel, &quot;preconnect&quot;))
 73         isLinkPreconnect = true;
 74     else if (RuntimeEnabledFeatures::sharedFeatures().linkPreloadEnabled() &amp;&amp; equalLettersIgnoringASCIICase(rel, &quot;preload&quot;))
 75         isLinkPreload = true;
 76     else if (RuntimeEnabledFeatures::sharedFeatures().linkPrefetchEnabled() &amp;&amp; equalLettersIgnoringASCIICase(rel, &quot;prefetch&quot;))
 77         isLinkPrefetch = true;
 78     else if (equalLettersIgnoringASCIICase(rel, &quot;alternate stylesheet&quot;) || equalLettersIgnoringASCIICase(rel, &quot;stylesheet alternate&quot;)) {
 79         isStyleSheet = true;
 80         isAlternate = true;
 81 #if ENABLE(APPLICATION_MANIFEST)
 82     } else if (equalLettersIgnoringASCIICase(rel, &quot;manifest&quot;)) {
 83         isApplicationManifest = true;
 84 #endif
 85     } else {
 86         // Tokenize the rel attribute and set bits based on specific keywords that we find.
 87         String relCopy = rel;
 88         relCopy.replace(&#39;\n&#39;, &#39; &#39;);
 89         for (auto word : StringView(relCopy).split(&#39; &#39;)) {
 90             if (equalLettersIgnoringASCIICase(word, &quot;stylesheet&quot;))
 91                 isStyleSheet = true;
 92             else if (equalLettersIgnoringASCIICase(word, &quot;alternate&quot;))
 93                 isAlternate = true;
 94             else if (equalLettersIgnoringASCIICase(word, &quot;icon&quot;))
 95                 iconType = LinkIconType::Favicon;
 96             else if (equalLettersIgnoringASCIICase(word, &quot;apple-touch-icon&quot;))
 97                 iconType = LinkIconType::TouchIcon;
 98             else if (equalLettersIgnoringASCIICase(word, &quot;apple-touch-icon-precomposed&quot;))
 99                 iconType = LinkIconType::TouchPrecomposedIcon;
100         }
101     }
102 }
103 
104 // https://html.spec.whatwg.org/#linkTypes
105 bool LinkRelAttribute::isSupported(Document&amp; document, StringView attribute)
106 {
107     static const char* const supportedAttributes[] = {
108         &quot;alternate&quot;, &quot;dns-prefetch&quot;, &quot;icon&quot;, &quot;stylesheet&quot;, &quot;apple-touch-icon&quot;, &quot;apple-touch-icon-precomposed&quot;,
109 #if ENABLE(APPLICATION_MANIFEST)
110         &quot;manifest&quot;,
111 #endif
112     };
113 
114     for (auto* supportedAttribute : supportedAttributes) {
115         if (equalIgnoringASCIICase(attribute, supportedAttribute))
116             return true;
117     }
118 
119     if (document.settings().linkPreconnectEnabled() &amp;&amp; equalIgnoringASCIICase(attribute, &quot;preconnect&quot;))
120         return true;
121 
122     if (RuntimeEnabledFeatures::sharedFeatures().linkPreloadEnabled() &amp;&amp; equalIgnoringASCIICase(attribute, &quot;preload&quot;))
123         return true;
124 
125     if (RuntimeEnabledFeatures::sharedFeatures().linkPrefetchEnabled() &amp;&amp; equalIgnoringASCIICase(attribute, &quot;prefetch&quot;))
126         return true;
127 
128     return false;
129 }
130 
131 }
<a name="3" id="anc3"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="3" type="hidden" />
</body>
</html>