<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/FontMetrics.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (C) Research In Motion Limited 2010-2011. All rights reserved.
  3  *
  4  * This library is free software; you can redistribute it and/or
  5  * modify it under the terms of the GNU Library General Public
  6  * License as published by the Free Software Foundation; either
  7  * version 2 of the License, or (at your option) any later version.
  8  *
  9  * This library is distributed in the hope that it will be useful,
 10  * but WITHOUT ANY WARRANTY; without even the implied warranty of
 11  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 12  * Library General Public License for more details.
 13  *
 14  * You should have received a copy of the GNU Library General Public License
 15  * along with this library; see the file COPYING.LIB.  If not, write to
 16  * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
 17  * Boston, MA 02110-1301, USA.
 18  */
 19 
 20 #ifndef FontMetrics_h
 21 #define FontMetrics_h
 22 
 23 #include &quot;FontBaseline.h&quot;
 24 #include &lt;wtf/MathExtras.h&gt;
 25 
 26 namespace WebCore {
 27 
 28 class FontMetrics {
 29 public:
 30     static const unsigned defaultUnitsPerEm = 1000;
 31 
 32     unsigned unitsPerEm() const { return m_unitsPerEm; }
 33     void setUnitsPerEm(unsigned unitsPerEm) { m_unitsPerEm = unitsPerEm; }
 34 
 35     float floatAscent(FontBaseline baselineType = AlphabeticBaseline) const
 36     {
 37         if (baselineType == AlphabeticBaseline)
<a name="1" id="anc1"></a><span class="line-modified"> 38             return m_floatAscent;</span>
 39         return floatHeight() / 2;
 40     }
 41 
<a name="2" id="anc2"></a><span class="line-modified"> 42     void setAscent(float ascent)</span>
<span class="line-added"> 43     {</span>
<span class="line-added"> 44         m_floatAscent = ascent;</span>
<span class="line-added"> 45         m_intAscent = lroundf(ascent);</span>
<span class="line-added"> 46     }</span>
 47 
 48     float floatDescent(FontBaseline baselineType = AlphabeticBaseline) const
 49     {
 50         if (baselineType == AlphabeticBaseline)
<a name="3" id="anc3"></a><span class="line-modified"> 51             return m_floatDescent;</span>
 52         return floatHeight() / 2;
 53     }
 54 
<a name="4" id="anc4"></a><span class="line-modified"> 55     void setDescent(float descent)</span>
<span class="line-added"> 56     {</span>
<span class="line-added"> 57         m_floatDescent = descent;</span>
<span class="line-added"> 58         m_intDescent = lroundf(descent);</span>
<span class="line-added"> 59     }</span>
 60 
 61     float floatHeight(FontBaseline baselineType = AlphabeticBaseline) const
 62     {
 63         return floatAscent(baselineType) + floatDescent(baselineType);
 64     }
 65 
<a name="5" id="anc5"></a><span class="line-modified"> 66     float floatLineGap() const { return m_floatLineGap; }</span>
<span class="line-modified"> 67     void setLineGap(float lineGap)</span>
<span class="line-added"> 68     {</span>
<span class="line-added"> 69         m_floatLineGap = lineGap;</span>
<span class="line-added"> 70         m_intLineGap = lroundf(lineGap);</span>
<span class="line-added"> 71     }</span>
 72 
<a name="6" id="anc6"></a><span class="line-modified"> 73     float floatLineSpacing() const { return m_floatLineSpacing; }</span>
<span class="line-modified"> 74     void setLineSpacing(float lineSpacing)</span>
<span class="line-added"> 75     {</span>
<span class="line-added"> 76         m_floatLineSpacing = lineSpacing;</span>
<span class="line-added"> 77         m_intLineSpacing = lroundf(lineSpacing);</span>
<span class="line-added"> 78     }</span>
 79 
 80     float xHeight() const { return m_xHeight; }
 81     void setXHeight(float xHeight) { m_xHeight = xHeight; }
 82     bool hasXHeight() const { return m_xHeight &gt; 0; }
 83 
<a name="7" id="anc7"></a><span class="line-modified"> 84     bool hasCapHeight() const { return m_floatCapHeight &gt; 0; }</span>
<span class="line-modified"> 85     float floatCapHeight() const { return m_floatCapHeight; }</span>
<span class="line-modified"> 86     void setCapHeight(float capHeight)</span>
<span class="line-added"> 87     {</span>
<span class="line-added"> 88         m_floatCapHeight = capHeight;</span>
<span class="line-added"> 89         m_intCapHeight = lroundf(capHeight);</span>
<span class="line-added"> 90     }</span>
 91 
 92     // Integer variants of certain metrics, used for HTML rendering.
 93     int ascent(FontBaseline baselineType = AlphabeticBaseline) const
 94     {
 95         if (baselineType == AlphabeticBaseline)
<a name="8" id="anc8"></a><span class="line-modified"> 96             return m_intAscent;</span>
 97         return height() - height() / 2;
 98     }
 99 
100     int descent(FontBaseline baselineType = AlphabeticBaseline) const
101     {
102         if (baselineType == AlphabeticBaseline)
<a name="9" id="anc9"></a><span class="line-modified">103             return m_intDescent;</span>
104         return height() / 2;
105     }
106 
107     int height(FontBaseline baselineType = AlphabeticBaseline) const
108     {
109         return ascent(baselineType) + descent(baselineType);
110     }
111 
<a name="10" id="anc10"></a><span class="line-modified">112     int lineGap() const { return m_intLineGap; }</span>
<span class="line-modified">113     int lineSpacing() const { return m_intLineSpacing; }</span>
114 
<a name="11" id="anc11"></a><span class="line-modified">115     int capHeight() const { return m_intCapHeight; }</span>
116 
117     bool hasIdenticalAscentDescentAndLineGap(const FontMetrics&amp; other) const
118     {
119         return ascent() == other.ascent() &amp;&amp; descent() == other.descent() &amp;&amp; lineGap() == other.lineGap();
120     }
121 
122     float zeroWidth() const { return m_zeroWidth; }
123     void setZeroWidth(float zeroWidth) { m_zeroWidth = zeroWidth; }
124 
125     float underlinePosition() const { return m_underlinePosition; }
126     void setUnderlinePosition(float underlinePosition) { m_underlinePosition = underlinePosition; }
127 
128     float underlineThickness() const { return m_underlineThickness; }
129     void setUnderlineThickness(float underlineThickness) { m_underlineThickness = underlineThickness; }
130 
131 private:
132     friend class Font;
133 
134     void reset()
135     {
136         m_unitsPerEm = defaultUnitsPerEm;
<a name="12" id="anc12"></a><span class="line-modified">137         m_floatAscent = 0;</span>
<span class="line-modified">138         m_floatDescent = 0;</span>
<span class="line-modified">139         m_floatLineGap = 0;</span>
<span class="line-modified">140         m_floatLineSpacing = 0;</span>
<span class="line-added">141         m_floatCapHeight = 0;</span>
<span class="line-added">142         m_intAscent = 0;</span>
<span class="line-added">143         m_intDescent = 0;</span>
<span class="line-added">144         m_intLineGap = 0;</span>
<span class="line-added">145         m_intLineSpacing = 0;</span>
<span class="line-added">146         m_intCapHeight = 0;</span>
147         m_xHeight = 0;
<a name="13" id="anc13"></a>
148         m_zeroWidth = 0;
<a name="14" id="anc14"></a><span class="line-added">149         m_underlinePosition = 0;</span>
<span class="line-added">150         m_underlineThickness = 0;</span>
151     }
152 
153     unsigned m_unitsPerEm { defaultUnitsPerEm };
<a name="15" id="anc15"></a><span class="line-modified">154 </span>
<span class="line-modified">155     float m_floatAscent { 0 };</span>
<span class="line-modified">156     float m_floatDescent { 0 };</span>
<span class="line-modified">157     float m_floatLineGap { 0 };</span>
<span class="line-added">158     float m_floatLineSpacing { 0 };</span>
<span class="line-added">159     float m_floatCapHeight { 0 };</span>
<span class="line-added">160 </span>
<span class="line-added">161     // Also cached as integers for performance.</span>
<span class="line-added">162     int m_intAscent { 0 };</span>
<span class="line-added">163     int m_intDescent { 0 };</span>
<span class="line-added">164     int m_intLineGap { 0 };</span>
<span class="line-added">165     int m_intLineSpacing { 0 };</span>
<span class="line-added">166     int m_intCapHeight { 0 };</span>
<span class="line-added">167 </span>
168     float m_zeroWidth { 0 };
169     float m_xHeight { 0 };
<a name="16" id="anc16"></a>
170     float m_underlinePosition { 0 };
171     float m_underlineThickness { 0 };
172 };
173 
174 static inline float scaleEmToUnits(float x, unsigned unitsPerEm)
175 {
176     return unitsPerEm ? x / unitsPerEm : x;
177 }
178 
179 } // namespace WebCore
180 
181 #endif // FontMetrics_h
<a name="17" id="anc17"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="17" type="hidden" />
</body>
</html>