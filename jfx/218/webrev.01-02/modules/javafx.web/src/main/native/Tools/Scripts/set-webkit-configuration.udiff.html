<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Tools/Scripts/set-webkit-configuration</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="build-webkit.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="webkitdirs.pm.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Tools/Scripts/set-webkit-configuration</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,8 +1,8 @@</span>
  #!/usr/bin/env perl
  
<span class="udiff-line-modified-removed">- # Copyright (C) 2005 Apple Inc.  All rights reserved.</span>
<span class="udiff-line-modified-added">+ # Copyright (C) 2005-2019 Apple Inc.  All rights reserved.</span>
  #
  # Redistribution and use in source and binary forms, with or without
  # modification, are permitted provided that the following conditions
  # are met:
  #
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -33,27 +33,36 @@</span>
  use webkitdirs;
  
  my $programName = basename($0);
  my $usage = &lt;&lt;EOF;
  Usage: $programName [options]
<span class="udiff-line-modified-removed">-   --32-bit                Set the default architecture to 32-bit</span>
<span class="udiff-line-modified-removed">-   --64-bit                Set the default architecture to 64-bit</span>
<span class="udiff-line-modified-removed">-   --[no-]asan             Enable or disable clang address sanitizer</span>
<span class="udiff-line-modified-removed">-   --lto-mode=&lt;mode&gt;       Set LTO mode: full, thin, or none</span>
<span class="udiff-line-modified-removed">-   --debug                 Set the default configuration to debug</span>
<span class="udiff-line-modified-removed">-   --release               Set the default configuration to release</span>
<span class="udiff-line-modified-removed">-   --reset                 Reset configurations</span>
<span class="udiff-line-modified-added">+   --32-bit                           Set the default architecture to 32-bit</span>
<span class="udiff-line-modified-added">+   --64-bit                           Set the default architecture to 64-bit</span>
<span class="udiff-line-modified-added">+   --[no-]asan                        Enable or disable clang address sanitizer</span>
<span class="udiff-line-modified-added">+   --[no-]coverage                    Enable or disable LLVM Source-based Code Coverage</span>
<span class="udiff-line-modified-added">+   --force-optimization-level=&lt;level&gt; Optimization level: O3, O2, O1, O0, Os, Ofast, Og, or none</span>
<span class="udiff-line-modified-added">+   --lto-mode=&lt;mode&gt;                  Set LTO mode: full, thin, or none</span>
<span class="udiff-line-modified-added">+   --debug                            Set the default configuration to debug</span>
<span class="udiff-line-added">+   --release                          Set the default configuration to release</span>
<span class="udiff-line-added">+   --reset                            Reset configurations</span>
  EOF
  
  my $configuration = passedConfiguration();
  my $architecture = passedArchitecture();
  my $enableASAN = checkForArgumentAndRemoveFromARGV(&quot;--asan&quot;);
  my $disableASAN = checkForArgumentAndRemoveFromARGV(&quot;--no-asan&quot;);
<span class="udiff-line-added">+ my $enableCoverage = checkForArgumentAndRemoveFromARGV(&quot;--coverage&quot;);</span>
<span class="udiff-line-added">+ my $disableCoverage = checkForArgumentAndRemoveFromARGV(&quot;--no-coverage&quot;);</span>
  my $ltoMode;
  if (!checkForArgumentAndRemoveFromARGVGettingValue(&quot;--lto-mode&quot;, \$ltoMode)) {
      $ltoMode=&quot;&quot;;
  }
<span class="udiff-line-added">+ my $forceOptimizationLevel;</span>
<span class="udiff-line-added">+ if (!checkForArgumentAndRemoveFromARGVGettingValue(&quot;--force-optimization-level&quot;, \$forceOptimizationLevel)</span>
<span class="udiff-line-added">+     &amp;&amp; !checkForArgumentAndRemoveFromARGVGettingValue(&quot;--force-opt&quot;, \$forceOptimizationLevel)) {</span>
<span class="udiff-line-added">+     $forceOptimizationLevel=&quot;&quot;;</span>
<span class="udiff-line-added">+ }</span>
  
  if (!$architecture) {
      # Handle --64-bit explicitly here, as we don&#39;t want our other scripts to accept it
      for my $i (0 .. $#ARGV) {
          my $opt = $ARGV[$i];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -69,24 +78,41 @@</span>
  
  if (checkForArgumentAndRemoveFromARGV(&quot;--reset&quot;)) {
      unlink &quot;$baseProductDir/Configuration&quot;;
      unlink &quot;$baseProductDir/Architecture&quot;;
      unlink &quot;$baseProductDir/ASan&quot;;
<span class="udiff-line-added">+     unlink &quot;$baseProductDir/ForceOptimizationLevel&quot;;</span>
<span class="udiff-line-added">+     unlink &quot;$baseProductDir/Coverage&quot;;</span>
      unlink &quot;$baseProductDir/LTO&quot;;
      exit 0;
  }
  
<span class="udiff-line-modified-removed">- if ((!$configuration &amp;&amp; !$architecture &amp;&amp; !$enableASAN &amp;&amp; !$disableASAN &amp;&amp; !$ltoMode) || ($enableASAN &amp;&amp; $disableASAN)) {</span>
<span class="udiff-line-modified-added">+ if ((!$configuration &amp;&amp; !$architecture &amp;&amp; !$enableASAN &amp;&amp; !$disableASAN &amp;&amp; !$enableCoverage &amp;&amp; !$disableCoverage &amp;&amp; !$ltoMode &amp;&amp; !$forceOptimizationLevel)</span>
<span class="udiff-line-added">+     || ($enableASAN &amp;&amp; $disableASAN)</span>
<span class="udiff-line-added">+     || ($enableCoverage &amp;&amp; $disableCoverage)) {</span>
      print STDERR $usage;
      exit 1;
  }
  
  if ($ltoMode &amp;&amp; $ltoMode ne &quot;full&quot; &amp;&amp; $ltoMode ne &quot;thin&quot; &amp;&amp; $ltoMode ne &quot;none&quot;) {
      print STDERR $usage;
      exit 1;
  }
  
<span class="udiff-line-added">+ if ($forceOptimizationLevel</span>
<span class="udiff-line-added">+     &amp;&amp; $forceOptimizationLevel ne &quot;none&quot;</span>
<span class="udiff-line-added">+     &amp;&amp; $forceOptimizationLevel ne &quot;O0&quot;</span>
<span class="udiff-line-added">+     &amp;&amp; $forceOptimizationLevel ne &quot;O1&quot;</span>
<span class="udiff-line-added">+     &amp;&amp; $forceOptimizationLevel ne &quot;O2&quot;</span>
<span class="udiff-line-added">+     &amp;&amp; $forceOptimizationLevel ne &quot;O3&quot;</span>
<span class="udiff-line-added">+     &amp;&amp; $forceOptimizationLevel ne &quot;Os&quot;</span>
<span class="udiff-line-added">+     &amp;&amp; $forceOptimizationLevel ne &quot;Ofast&quot;</span>
<span class="udiff-line-added">+     &amp;&amp; $forceOptimizationLevel ne &quot;Og&quot;) {</span>
<span class="udiff-line-added">+     print STDERR $usage;</span>
<span class="udiff-line-added">+     exit 1;</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
  if ($configuration) {
      open CONFIGURATION, &quot;&gt;&quot;, &quot;$baseProductDir/Configuration&quot; or die;
      print CONFIGURATION $configuration;
      close CONFIGURATION;
  }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -107,10 +133,26 @@</span>
      close ASAN;
  } elsif ($disableASAN) {
      unlink &quot;$baseProductDir/ASan&quot;;
  }
  
<span class="udiff-line-added">+ if ($enableCoverage) {</span>
<span class="udiff-line-added">+     open Coverage, &quot;&gt;&quot;, &quot;$baseProductDir/Coverage&quot; or die;</span>
<span class="udiff-line-added">+     print Coverage &quot;YES&quot;;</span>
<span class="udiff-line-added">+     close Coverage;</span>
<span class="udiff-line-added">+ } elsif ($disableCoverage) {</span>
<span class="udiff-line-added">+     unlink &quot;$baseProductDir/Coverage&quot;;</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ if ($forceOptimizationLevel &amp;&amp; $forceOptimizationLevel eq &quot;none&quot;) {</span>
<span class="udiff-line-added">+     unlink &quot;$baseProductDir/ForceOptimizationLevel&quot;;</span>
<span class="udiff-line-added">+ } elsif ($forceOptimizationLevel) {</span>
<span class="udiff-line-added">+     open ForceOptimizationLevel, &quot;&gt;&quot;, &quot;$baseProductDir/ForceOptimizationLevel&quot; or die;</span>
<span class="udiff-line-added">+     print ForceOptimizationLevel substr($forceOptimizationLevel, 1) . &quot;\n&quot;;</span>
<span class="udiff-line-added">+     close ForceOptimizationLevel;</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
  if ($ltoMode) {
      open LTO, &quot;&gt;&quot;, &quot;$baseProductDir/LTO&quot; or die;
      print LTO &quot;$ltoMode&quot;;
      close LTO;
  }
</pre>
<center><a href="build-webkit.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="webkitdirs.pm.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>