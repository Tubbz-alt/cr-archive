<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/FloatPoint.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (C) 2004-2016 Apple Inc.  All rights reserved.
  3  * Copyright (C) 2005 Nokia.  All rights reserved.
  4  *
  5  * Redistribution and use in source and binary forms, with or without
  6  * modification, are permitted provided that the following conditions
  7  * are met:
  8  * 1. Redistributions of source code must retain the above copyright
  9  *    notice, this list of conditions and the following disclaimer.
 10  * 2. Redistributions in binary form must reproduce the above copyright
 11  *    notice, this list of conditions and the following disclaimer in the
 12  *    documentation and/or other materials provided with the distribution.
 13  *
 14  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
 15  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 16  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 17  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 18  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 19  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 20  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 21  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 22  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 23  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 24  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 25  */
 26 
 27 #pragma once
 28 
 29 #include &quot;FloatSize.h&quot;
 30 #include &quot;IntPoint.h&quot;
 31 #include &lt;wtf/MathExtras.h&gt;
 32 
 33 #if PLATFORM(MAC) &amp;&amp; defined __OBJC__
 34 #import &lt;Foundation/NSGeometry.h&gt;
 35 #endif
 36 
 37 #if USE(CG)
 38 typedef struct CGPoint CGPoint;
 39 #endif
 40 
 41 #if PLATFORM(MAC)
 42 #ifdef NSGEOMETRY_TYPES_SAME_AS_CGGEOMETRY_TYPES
 43 typedef struct CGPoint NSPoint;
 44 #else
 45 typedef struct _NSPoint NSPoint;
 46 #endif
 47 #endif // PLATFORM(MAC)
 48 
 49 #if PLATFORM(WIN)
 50 struct D2D_POINT_2F;
 51 typedef D2D_POINT_2F D2D1_POINT_2F;
 52 #endif
 53 
 54 namespace WTF {
 55 class TextStream;
 56 }
 57 
 58 namespace WebCore {
 59 
 60 class AffineTransform;
 61 class TransformationMatrix;
 62 class IntPoint;
 63 class IntSize;
 64 
 65 class FloatPoint {
 66     WTF_MAKE_FAST_ALLOCATED;
 67 public:
 68     FloatPoint() { }
 69     FloatPoint(float x, float y) : m_x(x), m_y(y) { }
 70     WEBCORE_EXPORT FloatPoint(const IntPoint&amp;);
 71     explicit FloatPoint(const FloatSize&amp; size) : m_x(size.width()), m_y(size.height()) { }
 72 
 73     static FloatPoint zero() { return FloatPoint(); }
 74     bool isZero() const { return !m_x &amp;&amp; !m_y; }
 75 
 76     WEBCORE_EXPORT static FloatPoint narrowPrecision(double x, double y);
 77 
 78     float x() const { return m_x; }
 79     float y() const { return m_y; }
 80 
 81     void setX(float x) { m_x = x; }
 82     void setY(float y) { m_y = y; }
 83 
 84     void set(float x, float y)
 85     {
 86         m_x = x;
 87         m_y = y;
 88     }
 89 
 90     void move(float dx, float dy)
 91     {
 92         m_x += dx;
 93         m_y += dy;
 94     }
 95 
 96     void move(const IntSize&amp; a)
 97     {
 98         m_x += a.width();
 99         m_y += a.height();
100     }
101 
102     void move(const FloatSize&amp; a)
103     {
104         m_x += a.width();
105         m_y += a.height();
106     }
107 
108     void moveBy(const IntPoint&amp; a)
109     {
110         m_x += a.x();
111         m_y += a.y();
112     }
113 
114     void moveBy(const FloatPoint&amp; a)
115     {
116         m_x += a.x();
117         m_y += a.y();
118     }
119 
120     void scale(float scale)
121     {
122         m_x *= scale;
123         m_y *= scale;
124     }
125 
126     void scale(float scaleX, float scaleY)
127     {
128         m_x *= scaleX;
129         m_y *= scaleY;
130     }
131 
132     FloatPoint scaled(float scale) const
133     {
134         return { m_x * scale, m_y * scale };
135     }
136 
137     FloatPoint scaled(float scaleX, float scaleY) const
138     {
139         return { m_x * scaleX, m_y * scaleY };
140     }
141 
142     WEBCORE_EXPORT void normalize();
143 
144     float dot(const FloatPoint&amp; a) const
145     {
146         return m_x * a.x() + m_y * a.y();
147     }
148 
149     float slopeAngleRadians() const;
150 
151     float length() const
152     {
153         return std::hypot(m_x, m_y);
154     }
155 
156     float lengthSquared() const
157     {
158         return m_x * m_x + m_y * m_y;
159     }
160 
161     WEBCORE_EXPORT FloatPoint constrainedBetween(const FloatPoint&amp; min, const FloatPoint&amp; max) const;
162 
163     FloatPoint shrunkTo(const FloatPoint&amp; other) const
164     {
165         return { std::min(m_x, other.m_x), std::min(m_y, other.m_y) };
166     }
167 
168     FloatPoint expandedTo(const FloatPoint&amp; other) const
169     {
170         return { std::max(m_x, other.m_x), std::max(m_y, other.m_y) };
171     }
172 
173     FloatPoint transposedPoint() const
174     {
175         return { m_y, m_x };
176     }
177 
178 #if USE(CG)
179     WEBCORE_EXPORT FloatPoint(const CGPoint&amp;);
180     WEBCORE_EXPORT operator CGPoint() const;
181 #endif
182 
183 #if PLATFORM(MAC) &amp;&amp; !defined(NSGEOMETRY_TYPES_SAME_AS_CGGEOMETRY_TYPES)
184     WEBCORE_EXPORT FloatPoint(const NSPoint&amp;);
185     WEBCORE_EXPORT operator NSPoint() const;
186 #endif
187 
188 #if PLATFORM(WIN)
189     WEBCORE_EXPORT FloatPoint(const D2D1_POINT_2F&amp;);
190     WEBCORE_EXPORT operator D2D1_POINT_2F() const;
191 #endif
192 
193     WEBCORE_EXPORT FloatPoint matrixTransform(const TransformationMatrix&amp;) const;
194     WEBCORE_EXPORT FloatPoint matrixTransform(const AffineTransform&amp;) const;
195 
196 private:
197     float m_x { 0 };
198     float m_y { 0 };
199 };
200 
201 
202 inline FloatPoint&amp; operator+=(FloatPoint&amp; a, const FloatSize&amp; b)
203 {
204     a.move(b.width(), b.height());
205     return a;
206 }
207 
208 inline FloatPoint&amp; operator+=(FloatPoint&amp; a, const FloatPoint&amp; b)
209 {
210     a.move(b.x(), b.y());
211     return a;
212 }
213 
214 inline FloatPoint&amp; operator-=(FloatPoint&amp; a, const FloatSize&amp; b)
215 {
216     a.move(-b.width(), -b.height());
217     return a;
218 }
219 
220 inline FloatPoint operator+(const FloatPoint&amp; a, const FloatSize&amp; b)
221 {
222     return FloatPoint(a.x() + b.width(), a.y() + b.height());
223 }
224 
225 inline FloatPoint operator+(const FloatPoint&amp; a, const FloatPoint&amp; b)
226 {
227     return FloatPoint(a.x() + b.x(), a.y() + b.y());
228 }
229 
230 inline FloatSize operator-(const FloatPoint&amp; a, const FloatPoint&amp; b)
231 {
232     return FloatSize(a.x() - b.x(), a.y() - b.y());
233 }
234 
235 inline FloatPoint operator-(const FloatPoint&amp; a, const FloatSize&amp; b)
236 {
237     return FloatPoint(a.x() - b.width(), a.y() - b.height());
238 }
239 
240 inline FloatPoint operator-(const FloatPoint&amp; a)
241 {
242     return FloatPoint(-a.x(), -a.y());
243 }
244 
245 inline bool operator==(const FloatPoint&amp; a, const FloatPoint&amp; b)
246 {
247     return a.x() == b.x() &amp;&amp; a.y() == b.y();
248 }
249 
250 inline bool operator!=(const FloatPoint&amp; a, const FloatPoint&amp; b)
251 {
252     return a.x() != b.x() || a.y() != b.y();
253 }
254 
255 inline float operator*(const FloatPoint&amp; a, const FloatPoint&amp; b)
256 {
257     // dot product
258     return a.dot(b);
259 }
260 
261 inline IntSize flooredIntSize(const FloatPoint&amp; p)
262 {
263     return IntSize(clampToInteger(floorf(p.x())), clampToInteger(floorf(p.y())));
264 }
265 
266 inline IntPoint roundedIntPoint(const FloatPoint&amp; p)
267 {
268     return IntPoint(clampToInteger(roundf(p.x())), clampToInteger(roundf(p.y())));
269 }
270 
271 inline IntPoint flooredIntPoint(const FloatPoint&amp; p)
272 {
273     return IntPoint(clampToInteger(floorf(p.x())), clampToInteger(floorf(p.y())));
274 }
275 
276 inline IntPoint ceiledIntPoint(const FloatPoint&amp; p)
277 {
278     return IntPoint(clampToInteger(ceilf(p.x())), clampToInteger(ceilf(p.y())));
279 }
280 
281 inline FloatPoint floorPointToDevicePixels(const FloatPoint&amp; p, float deviceScaleFactor)
282 {
283     return FloatPoint(floorf(p.x() * deviceScaleFactor)  / deviceScaleFactor, floorf(p.y() * deviceScaleFactor)  / deviceScaleFactor);
284 }
285 
286 inline FloatPoint ceilPointToDevicePixels(const FloatPoint&amp; p, float deviceScaleFactor)
287 {
288     return FloatPoint(ceilf(p.x() * deviceScaleFactor)  / deviceScaleFactor, ceilf(p.y() * deviceScaleFactor)  / deviceScaleFactor);
289 }
290 
291 inline FloatSize toFloatSize(const FloatPoint&amp; a)
292 {
293     return FloatSize(a.x(), a.y());
294 }
295 
296 inline FloatPoint toFloatPoint(const FloatSize&amp; a)
297 {
298     return FloatPoint(a.width(), a.height());
299 }
300 
301 inline bool areEssentiallyEqual(const FloatPoint&amp; a, const FloatPoint&amp; b)
302 {
303     return WTF::areEssentiallyEqual(a.x(), b.x()) &amp;&amp; WTF::areEssentiallyEqual(a.y(), b.y());
304 }
305 
306 WEBCORE_EXPORT WTF::TextStream&amp; operator&lt;&lt;(WTF::TextStream&amp;, const FloatPoint&amp;);
307 
308 }
309 
    </pre>
  </body>
</html>