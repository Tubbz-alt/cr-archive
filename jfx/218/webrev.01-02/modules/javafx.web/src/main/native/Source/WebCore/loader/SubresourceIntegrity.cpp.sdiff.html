<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/loader/SubresourceIntegrity.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="SinkDocument.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SubresourceIntegrity.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/loader/SubresourceIntegrity.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
191 
192     // 6. For each item in metadata:
193     for (auto&amp; item : metadata) {
194         // 1. Let algorithm be the alg component of item.
195         auto algorithm = item.algorithm;
196 
197         // 2. Let expectedValue be the val component of item.
198         auto expectedValue = decodeEncodedResourceCryptographicDigest(item);
199 
200         // 3. Let actualValue be the result of applying algorithm to response.
201         auto actualValue = cryptographicDigestForBytes(algorithm, sharedBuffer ? sharedBuffer-&gt;data() : nullptr, sharedBuffer ? sharedBuffer-&gt;size() : 0);
202 
203         // 4. If actualValue is a case-sensitive match for expectedValue, return true.
204         if (expectedValue &amp;&amp; actualValue.value == expectedValue-&gt;value)
205             return true;
206     }
207 
208     return false;
209 }
210 



















211 }
</pre>
</td>
<td>
<hr />
<pre>
191 
192     // 6. For each item in metadata:
193     for (auto&amp; item : metadata) {
194         // 1. Let algorithm be the alg component of item.
195         auto algorithm = item.algorithm;
196 
197         // 2. Let expectedValue be the val component of item.
198         auto expectedValue = decodeEncodedResourceCryptographicDigest(item);
199 
200         // 3. Let actualValue be the result of applying algorithm to response.
201         auto actualValue = cryptographicDigestForBytes(algorithm, sharedBuffer ? sharedBuffer-&gt;data() : nullptr, sharedBuffer ? sharedBuffer-&gt;size() : 0);
202 
203         // 4. If actualValue is a case-sensitive match for expectedValue, return true.
204         if (expectedValue &amp;&amp; actualValue.value == expectedValue-&gt;value)
205             return true;
206     }
207 
208     return false;
209 }
210 
<span class="line-added">211 String integrityMismatchDescription(const CachedResource&amp; resource, const String&amp; integrityMetadata)</span>
<span class="line-added">212 {</span>
<span class="line-added">213     StringBuilder builder;</span>
<span class="line-added">214 </span>
<span class="line-added">215     builder.append(resource.url().stringCenterEllipsizedToLength());</span>
<span class="line-added">216     builder.append(&quot;. Failed integrity metadata check. &quot;);</span>
<span class="line-added">217     builder.append(&quot;Content length: &quot;);</span>
<span class="line-added">218     if (auto* resourceBuffer = resource.resourceBuffer())</span>
<span class="line-added">219         builder.appendNumber(resourceBuffer-&gt;size());</span>
<span class="line-added">220     else</span>
<span class="line-added">221         builder.append(&quot;(no content)&quot;);</span>
<span class="line-added">222     builder.append(&quot;, Expected content length: &quot;);</span>
<span class="line-added">223     builder.appendNumber(resource.response().expectedContentLength());</span>
<span class="line-added">224     builder.append(&quot;, Expected metadata: &quot;);</span>
<span class="line-added">225     builder.append(integrityMetadata);</span>
<span class="line-added">226 </span>
<span class="line-added">227     return builder.toString();</span>
<span class="line-added">228 }</span>
<span class="line-added">229 </span>
230 }
</pre>
</td>
</tr>
</table>
<center><a href="SinkDocument.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SubresourceIntegrity.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>