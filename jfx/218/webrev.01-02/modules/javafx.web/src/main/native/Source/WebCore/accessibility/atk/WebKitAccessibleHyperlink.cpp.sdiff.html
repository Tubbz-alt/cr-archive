<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/accessibility/atk/WebKitAccessibleHyperlink.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="WebKitAccessible.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="WebKitAccessibleInterfaceAction.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/accessibility/atk/WebKitAccessibleHyperlink.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 81 
 82 static const gchar* webkitAccessibleHyperlinkActionGetDescription(AtkAction* action, gint)
 83 {
 84     auto* accessibleHyperlink = WEBKIT_ACCESSIBLE_HYPERLINK(action);
 85     returnValIfWebKitAccessibleIsInvalid(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl, nullptr);
 86 
 87     // TODO: Need a way to provide/localize action descriptions.
 88     notImplemented();
 89     return &quot;&quot;;
 90 }
 91 
 92 static const gchar* webkitAccessibleHyperlinkActionGetKeybinding(AtkAction* action, gint)
 93 {
 94     auto* accessibleHyperlink = WEBKIT_ACCESSIBLE_HYPERLINK(action);
 95     returnValIfWebKitAccessibleIsInvalid(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl, nullptr);
 96 
 97     if (!ATK_IS_ACTION(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl))
 98         return nullptr;
 99 
100     auto&amp; coreObject = webkitAccessibleGetAccessibilityObject(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl);
<span class="line-modified">101     accessibleHyperlink-&gt;priv-&gt;actionKeyBinding = coreObject.accessKey().string().utf8();</span>
102     return accessibleHyperlink-&gt;priv-&gt;actionKeyBinding.data();
103 }
104 
105 static const gchar* webkitAccessibleHyperlinkActionGetName(AtkAction* action, gint)
106 {
107     auto* accessibleHyperlink = WEBKIT_ACCESSIBLE_HYPERLINK(action);
108     returnValIfWebKitAccessibleIsInvalid(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl, nullptr);
109 
110     if (!ATK_IS_ACTION(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl))
111         return nullptr;
112 
113     auto&amp; coreObject = webkitAccessibleGetAccessibilityObject(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl);
114     accessibleHyperlink-&gt;priv-&gt;actionName = coreObject.actionVerb().utf8();
115     return accessibleHyperlink-&gt;priv-&gt;actionName.data();
116 }
117 
118 static void webkit_accessible_hyperlink_atk_action_interface_init(AtkActionIface* iface)
119 {
120     iface-&gt;do_action = webkitAccessibleHyperlinkActionDoAction;
121     iface-&gt;get_n_actions = webkitAccessibleHyperlinkActionGetNActions;
</pre>
<hr />
<pre>
141 static AtkObject* webkitAccessibleHyperlinkGetObject(AtkHyperlink* link, gint index)
142 {
143     // FIXME: Do NOT support more than one instance of an AtkObject
144     // implementing AtkHyperlinkImpl in every instance of AtkHyperLink
145     if (index)
146         return nullptr;
147 
148     auto* accessibleHyperlink = WEBKIT_ACCESSIBLE_HYPERLINK(link);
149     returnValIfWebKitAccessibleIsInvalid(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl, 0);
150 
151     return ATK_OBJECT(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl);
152 }
153 
154 static gint rangeLengthForObject(AccessibilityObject&amp; obj, Range* range)
155 {
156     // This is going to be the actual length in most of the cases
157     int baseLength = TextIterator::rangeLength(range, true);
158 
159     // Check whether the current hyperlink belongs to a list item.
160     // If so, we need to consider the length of the item&#39;s marker
<span class="line-modified">161     AccessibilityObject* parent = obj.parentObjectUnignored();</span>
162     if (!parent || !parent-&gt;isAccessibilityRenderObject() || !parent-&gt;isListItem())
163         return baseLength;
164 
165     // Even if we don&#39;t expose list markers to Assistive
166     // Technologies, we need to have a way to measure their length
167     // for those cases when it&#39;s needed to take it into account
168     // separately (as in getAccessibilityObjectForOffset)
<span class="line-modified">169     AccessibilityObject* markerObj = parent-&gt;firstChild();</span>
170     if (!markerObj)
171         return baseLength;
172 
173     RenderObject* renderer = markerObj-&gt;renderer();
174     if (!is&lt;RenderListMarker&gt;(renderer))
175         return baseLength;
176 
177     auto&amp; marker = downcast&lt;RenderListMarker&gt;(*renderer);
178     return baseLength + marker.text().length() + marker.suffix().length();
179 }
180 
181 static gint webkitAccessibleHyperlinkGetStartIndex(AtkHyperlink* link)
182 {
183     auto* accessibleHyperlink = WEBKIT_ACCESSIBLE_HYPERLINK(link);
184     returnValIfWebKitAccessibleIsInvalid(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl, 0);
185 
186     auto&amp; coreObject = webkitAccessibleGetAccessibilityObject(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl);
<span class="line-modified">187     AccessibilityObject* parentUnignored = coreObject.parentObjectUnignored();</span>
188     if (!parentUnignored)
189         return 0;
190 
191     Node* node = coreObject.node();
192     if (!node)
193         return 0;
194 
195     Node* parentNode = parentUnignored-&gt;node();
196     if (!parentNode)
197         return 0;
198 
199     auto range = Range::create(node-&gt;document(), firstPositionInOrBeforeNode(parentNode), firstPositionInOrBeforeNode(node));
200     return rangeLengthForObject(coreObject, range.ptr());
201 }
202 
203 static gint webkitAccessibleHyperlinkGetEndIndex(AtkHyperlink* link)
204 {
205     auto* accessibleHyperlink = WEBKIT_ACCESSIBLE_HYPERLINK(link);
206     returnValIfWebKitAccessibleIsInvalid(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl, 0);
207 
208     auto&amp; coreObject = webkitAccessibleGetAccessibilityObject(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl);
<span class="line-modified">209     AccessibilityObject* parentUnignored = coreObject.parentObjectUnignored();</span>
210     if (!parentUnignored)
211         return 0;
212 
213     Node* node = coreObject.node();
214     if (!node)
215         return 0;
216 
217     Node* parentNode = parentUnignored-&gt;node();
218     if (!parentNode)
219         return 0;
220 
221     auto range = Range::create(node-&gt;document(), firstPositionInOrBeforeNode(parentNode), lastPositionInOrAfterNode(node));
222     return rangeLengthForObject(coreObject, range.ptr());
223 }
224 
225 static gboolean webkitAccessibleHyperlinkIsValid(AtkHyperlink* link)
226 {
227     auto* accessibleHyperlink = WEBKIT_ACCESSIBLE_HYPERLINK(link);
228     returnValIfWebKitAccessibleIsInvalid(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl, FALSE);
229 
</pre>
</td>
<td>
<hr />
<pre>
 81 
 82 static const gchar* webkitAccessibleHyperlinkActionGetDescription(AtkAction* action, gint)
 83 {
 84     auto* accessibleHyperlink = WEBKIT_ACCESSIBLE_HYPERLINK(action);
 85     returnValIfWebKitAccessibleIsInvalid(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl, nullptr);
 86 
 87     // TODO: Need a way to provide/localize action descriptions.
 88     notImplemented();
 89     return &quot;&quot;;
 90 }
 91 
 92 static const gchar* webkitAccessibleHyperlinkActionGetKeybinding(AtkAction* action, gint)
 93 {
 94     auto* accessibleHyperlink = WEBKIT_ACCESSIBLE_HYPERLINK(action);
 95     returnValIfWebKitAccessibleIsInvalid(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl, nullptr);
 96 
 97     if (!ATK_IS_ACTION(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl))
 98         return nullptr;
 99 
100     auto&amp; coreObject = webkitAccessibleGetAccessibilityObject(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl);
<span class="line-modified">101     accessibleHyperlink-&gt;priv-&gt;actionKeyBinding = coreObject.accessKey().utf8();</span>
102     return accessibleHyperlink-&gt;priv-&gt;actionKeyBinding.data();
103 }
104 
105 static const gchar* webkitAccessibleHyperlinkActionGetName(AtkAction* action, gint)
106 {
107     auto* accessibleHyperlink = WEBKIT_ACCESSIBLE_HYPERLINK(action);
108     returnValIfWebKitAccessibleIsInvalid(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl, nullptr);
109 
110     if (!ATK_IS_ACTION(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl))
111         return nullptr;
112 
113     auto&amp; coreObject = webkitAccessibleGetAccessibilityObject(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl);
114     accessibleHyperlink-&gt;priv-&gt;actionName = coreObject.actionVerb().utf8();
115     return accessibleHyperlink-&gt;priv-&gt;actionName.data();
116 }
117 
118 static void webkit_accessible_hyperlink_atk_action_interface_init(AtkActionIface* iface)
119 {
120     iface-&gt;do_action = webkitAccessibleHyperlinkActionDoAction;
121     iface-&gt;get_n_actions = webkitAccessibleHyperlinkActionGetNActions;
</pre>
<hr />
<pre>
141 static AtkObject* webkitAccessibleHyperlinkGetObject(AtkHyperlink* link, gint index)
142 {
143     // FIXME: Do NOT support more than one instance of an AtkObject
144     // implementing AtkHyperlinkImpl in every instance of AtkHyperLink
145     if (index)
146         return nullptr;
147 
148     auto* accessibleHyperlink = WEBKIT_ACCESSIBLE_HYPERLINK(link);
149     returnValIfWebKitAccessibleIsInvalid(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl, 0);
150 
151     return ATK_OBJECT(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl);
152 }
153 
154 static gint rangeLengthForObject(AccessibilityObject&amp; obj, Range* range)
155 {
156     // This is going to be the actual length in most of the cases
157     int baseLength = TextIterator::rangeLength(range, true);
158 
159     // Check whether the current hyperlink belongs to a list item.
160     // If so, we need to consider the length of the item&#39;s marker
<span class="line-modified">161     AXCoreObject* parent = obj.parentObjectUnignored();</span>
162     if (!parent || !parent-&gt;isAccessibilityRenderObject() || !parent-&gt;isListItem())
163         return baseLength;
164 
165     // Even if we don&#39;t expose list markers to Assistive
166     // Technologies, we need to have a way to measure their length
167     // for those cases when it&#39;s needed to take it into account
168     // separately (as in getAccessibilityObjectForOffset)
<span class="line-modified">169     AXCoreObject* markerObj = parent-&gt;firstChild();</span>
170     if (!markerObj)
171         return baseLength;
172 
173     RenderObject* renderer = markerObj-&gt;renderer();
174     if (!is&lt;RenderListMarker&gt;(renderer))
175         return baseLength;
176 
177     auto&amp; marker = downcast&lt;RenderListMarker&gt;(*renderer);
178     return baseLength + marker.text().length() + marker.suffix().length();
179 }
180 
181 static gint webkitAccessibleHyperlinkGetStartIndex(AtkHyperlink* link)
182 {
183     auto* accessibleHyperlink = WEBKIT_ACCESSIBLE_HYPERLINK(link);
184     returnValIfWebKitAccessibleIsInvalid(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl, 0);
185 
186     auto&amp; coreObject = webkitAccessibleGetAccessibilityObject(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl);
<span class="line-modified">187     AXCoreObject* parentUnignored = coreObject.parentObjectUnignored();</span>
188     if (!parentUnignored)
189         return 0;
190 
191     Node* node = coreObject.node();
192     if (!node)
193         return 0;
194 
195     Node* parentNode = parentUnignored-&gt;node();
196     if (!parentNode)
197         return 0;
198 
199     auto range = Range::create(node-&gt;document(), firstPositionInOrBeforeNode(parentNode), firstPositionInOrBeforeNode(node));
200     return rangeLengthForObject(coreObject, range.ptr());
201 }
202 
203 static gint webkitAccessibleHyperlinkGetEndIndex(AtkHyperlink* link)
204 {
205     auto* accessibleHyperlink = WEBKIT_ACCESSIBLE_HYPERLINK(link);
206     returnValIfWebKitAccessibleIsInvalid(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl, 0);
207 
208     auto&amp; coreObject = webkitAccessibleGetAccessibilityObject(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl);
<span class="line-modified">209     AXCoreObject* parentUnignored = coreObject.parentObjectUnignored();</span>
210     if (!parentUnignored)
211         return 0;
212 
213     Node* node = coreObject.node();
214     if (!node)
215         return 0;
216 
217     Node* parentNode = parentUnignored-&gt;node();
218     if (!parentNode)
219         return 0;
220 
221     auto range = Range::create(node-&gt;document(), firstPositionInOrBeforeNode(parentNode), lastPositionInOrAfterNode(node));
222     return rangeLengthForObject(coreObject, range.ptr());
223 }
224 
225 static gboolean webkitAccessibleHyperlinkIsValid(AtkHyperlink* link)
226 {
227     auto* accessibleHyperlink = WEBKIT_ACCESSIBLE_HYPERLINK(link);
228     returnValIfWebKitAccessibleIsInvalid(accessibleHyperlink-&gt;priv-&gt;hyperlinkImpl, FALSE);
229 
</pre>
</td>
</tr>
</table>
<center><a href="WebKitAccessible.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="WebKitAccessibleInterfaceAction.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>