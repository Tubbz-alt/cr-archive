<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/bindings/js/JSDOMWrapper.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="JSDOMWrapper.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="JSDOMWrapperCache.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/bindings/js/JSDOMWrapper.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 27,31 ***</span>
  
  namespace WebCore {
  
  class ScriptExecutionContext;
  
<span class="line-modified">! // JSC allows us to extend JSType. If the highest bit is set, we can add any Object types and they are</span>
  // recognized as OtherObj in JSC. And we encode Node type into JSType if the given JSType is subclass of Node.
<span class="line-modified">! // offset | 7 | 6 | 5   4 | 3   2   1   0  |</span>
<span class="line-modified">! // value  | 1 | 0 |  Non-node DOM types    |</span>
  // If the given JSType is a subclass of Node, the format is the following.
<span class="line-modified">! // offset | 7 | 6 | 5   4 | 3   2   1   0  |</span>
<span class="line-modified">! // value  | 1 | 1 |  Kind |       NodeType |</span>
<span class="line-removed">- static const uint8_t JSNodeTypeMask                  = 0b00001111;</span>
  
<span class="line-modified">! static const uint8_t JSDOMWrapperType                = 0b10000000;</span>
<span class="line-modified">! static const uint8_t JSEventType                     = 0b10000001;</span>
<span class="line-modified">! static const uint8_t JSNodeType                      = 0b11000000;</span>
  static const uint8_t JSTextNodeType                  = JSNodeType | NodeConstants::TEXT_NODE;
  static const uint8_t JSProcessingInstructionNodeType = JSNodeType | NodeConstants::PROCESSING_INSTRUCTION_NODE;
  static const uint8_t JSDocumentTypeNodeType          = JSNodeType | NodeConstants::DOCUMENT_TYPE_NODE;
  static const uint8_t JSDocumentFragmentNodeType      = JSNodeType | NodeConstants::DOCUMENT_FRAGMENT_NODE;
  static const uint8_t JSDocumentWrapperType           = JSNodeType | NodeConstants::DOCUMENT_NODE;
  static const uint8_t JSCommentNodeType               = JSNodeType | NodeConstants::COMMENT_NODE;
  static const uint8_t JSCDATASectionNodeType          = JSNodeType | NodeConstants::CDATA_SECTION_NODE;
  static const uint8_t JSAttrNodeType                  = JSNodeType | NodeConstants::ATTRIBUTE_NODE;
<span class="line-modified">! static const uint8_t JSElementType                   = 0b11010000 | NodeConstants::ELEMENT_NODE;</span>
  
  static_assert(JSDOMWrapperType &gt; JSC::LastJSCObjectType, &quot;JSC::JSType offers the highest bit.&quot;);
  static_assert(NodeConstants::LastNodeType &lt;= JSNodeTypeMask, &quot;NodeType should be represented in 4bit.&quot;);
  
  class JSDOMObject : public JSC::JSDestructibleObject {
<span class="line-new-header">--- 27,31 ---</span>
  
  namespace WebCore {
  
  class ScriptExecutionContext;
  
<span class="line-modified">! // JSC allows us to extend JSType. If the highest 3 bits are set, we can add any Object types and they are</span>
  // recognized as OtherObj in JSC. And we encode Node type into JSType if the given JSType is subclass of Node.
<span class="line-modified">! // offset | 7 | 6 | 5 | 4   3   2   1   0  |</span>
<span class="line-modified">! // value  | 1 | 1 | 1 | Non-node DOM types |</span>
  // If the given JSType is a subclass of Node, the format is the following.
<span class="line-modified">! // offset | 7 | 6 | 5 | 4 | 3   2   1   0  |</span>
<span class="line-modified">! // value  | 1 | 1 | 1 | 1 |    NodeType    |</span>
  
<span class="line-modified">! static const uint8_t JSDOMWrapperType                = 0b11101110;</span>
<span class="line-modified">! static const uint8_t JSEventType                     = 0b11101111;</span>
<span class="line-modified">! static const uint8_t JSNodeType                      = 0b11110000;</span>
<span class="line-added">+ static const uint8_t JSNodeTypeMask                  = 0b00001111;</span>
  static const uint8_t JSTextNodeType                  = JSNodeType | NodeConstants::TEXT_NODE;
  static const uint8_t JSProcessingInstructionNodeType = JSNodeType | NodeConstants::PROCESSING_INSTRUCTION_NODE;
  static const uint8_t JSDocumentTypeNodeType          = JSNodeType | NodeConstants::DOCUMENT_TYPE_NODE;
  static const uint8_t JSDocumentFragmentNodeType      = JSNodeType | NodeConstants::DOCUMENT_FRAGMENT_NODE;
  static const uint8_t JSDocumentWrapperType           = JSNodeType | NodeConstants::DOCUMENT_NODE;
  static const uint8_t JSCommentNodeType               = JSNodeType | NodeConstants::COMMENT_NODE;
  static const uint8_t JSCDATASectionNodeType          = JSNodeType | NodeConstants::CDATA_SECTION_NODE;
  static const uint8_t JSAttrNodeType                  = JSNodeType | NodeConstants::ATTRIBUTE_NODE;
<span class="line-modified">! static const uint8_t JSElementType                   = 0b11110000 | NodeConstants::ELEMENT_NODE;</span>
  
  static_assert(JSDOMWrapperType &gt; JSC::LastJSCObjectType, &quot;JSC::JSType offers the highest bit.&quot;);
  static_assert(NodeConstants::LastNodeType &lt;= JSNodeTypeMask, &quot;NodeType should be represented in 4bit.&quot;);
  
  class JSDOMObject : public JSC::JSDestructibleObject {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 65,11 ***</span>
  protected:
      WEBCORE_EXPORT JSDOMObject(JSC::Structure*, JSC::JSGlobalObject&amp;);
  };
  
  WEBCORE_EXPORT JSC::CompleteSubspace* outputConstraintSubspaceFor(JSC::VM&amp;);
<span class="line-removed">- WEBCORE_EXPORT JSC::CompleteSubspace* globalObjectOutputConstraintSubspaceFor(JSC::VM&amp;);</span>
  
  template&lt;typename ImplementationClass&gt; class JSDOMWrapper : public JSDOMObject {
  public:
      typedef JSDOMObject Base;
      typedef ImplementationClass DOMWrapped;
<span class="line-new-header">--- 65,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 107,8 ***</span>
      static constexpr bool isSimpleWrapper = test&lt;typename JSClass::DOMWrapped&gt;(0);
      static constexpr bool isComplexWrapper = !isSimpleWrapper;
      static constexpr bool isBuiltin = false;
  };
  
<span class="line-modified">! JSC::JSValue cloneAcrossWorlds(JSC::ExecState&amp;, const JSDOMObject&amp; owner, JSC::JSValue);</span>
  
  } // namespace WebCore
<span class="line-new-header">--- 106,8 ---</span>
      static constexpr bool isSimpleWrapper = test&lt;typename JSClass::DOMWrapped&gt;(0);
      static constexpr bool isComplexWrapper = !isSimpleWrapper;
      static constexpr bool isBuiltin = false;
  };
  
<span class="line-modified">! JSC::JSValue cloneAcrossWorlds(JSC::JSGlobalObject&amp;, const JSDOMObject&amp; owner, JSC::JSValue);</span>
  
  } // namespace WebCore
</pre>
<center><a href="JSDOMWrapper.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="JSDOMWrapperCache.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>