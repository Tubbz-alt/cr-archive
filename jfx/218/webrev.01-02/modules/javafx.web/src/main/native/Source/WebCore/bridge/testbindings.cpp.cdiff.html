<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/bridge/testbindings.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="runtime_object.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../contentextensions/ContentExtensionCompiler.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/bridge/testbindings.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 374,42 ***</span>
  
          // create interpreter w/ global object
          Object global(new GlobalImp());
          Interpreter interp;
          interp.setGlobalObject(global);
<span class="line-modified">!         ExecState *exec = interp.globalExec();</span>
  
          MyObject *myObject = (MyObject *)NPN_CreateObject (myFunctionPtrs);
  
<span class="line-modified">!         global.put(exec, Identifier::fromString(exec, &quot;myInterface&quot;), Instance::createRuntimeObject(Instance::CLanguage, (void *)myObject));</span>
  
          for (int i = 1; i &lt; argc; i++) {
              const char *code = readJavaScriptFromFile(argv[i]);
  
              if (code) {
                  // run
                  Completion comp(interp.evaluate(code));
  
                  if (comp.complType() == Throw) {
                      Value exVal = comp.value();
<span class="line-modified">!                     String message = exVal.toWTFString(exec);</span>
                      auto cstring = msg.ascii();
                      const char* msg = cstring.data();
                      int lineno = -1;
                      if (exVal.type() == ObjectType) {
<span class="line-modified">!                         Value lineVal = Object::dynamicCast(exVal).get(exec, Identifier::fromString(exec, &quot;line&quot;));</span>
                          if (lineVal.type() == NumberType)
<span class="line-modified">!                             lineno = int(lineVal.toNumber(exec));</span>
                      }
                      if (lineno != -1)
                          fprintf(stderr,&quot;Exception, line %d: %s\n&quot;,lineno,msg);
                      else
                          fprintf(stderr,&quot;Exception: %s\n&quot;,msg);
                      ret = false;
                  }
                  else if (comp.complType() == ReturnValue) {
<span class="line-modified">!                     char *msg = comp.value().toString(interp.globalExec()).ascii();</span>
                      fprintf(stderr,&quot;Return value: %s\n&quot;,msg);
                  }
              }
          }
  
<span class="line-new-header">--- 374,42 ---</span>
  
          // create interpreter w/ global object
          Object global(new GlobalImp());
          Interpreter interp;
          interp.setGlobalObject(global);
<span class="line-modified">!         JSGlobalObject* lexicalGlobalObject = interp.globalObject();</span>
  
          MyObject *myObject = (MyObject *)NPN_CreateObject (myFunctionPtrs);
  
<span class="line-modified">!         global.put(lexicalGlobalObject, Identifier::fromString(lexicalGlobalObject, &quot;myInterface&quot;), Instance::createRuntimeObject(Instance::CLanguage, (void *)myObject));</span>
  
          for (int i = 1; i &lt; argc; i++) {
              const char *code = readJavaScriptFromFile(argv[i]);
  
              if (code) {
                  // run
                  Completion comp(interp.evaluate(code));
  
                  if (comp.complType() == Throw) {
                      Value exVal = comp.value();
<span class="line-modified">!                     String message = exVal.toWTFString(lexicalGlobalObject);</span>
                      auto cstring = msg.ascii();
                      const char* msg = cstring.data();
                      int lineno = -1;
                      if (exVal.type() == ObjectType) {
<span class="line-modified">!                         Value lineVal = Object::dynamicCast(exVal).get(lexicalGlobalObject, Identifier::fromString(lexicalGlobalObject, &quot;line&quot;));</span>
                          if (lineVal.type() == NumberType)
<span class="line-modified">!                             lineno = int(lineVal.toNumber(lexicalGlobalObject));</span>
                      }
                      if (lineno != -1)
                          fprintf(stderr,&quot;Exception, line %d: %s\n&quot;,lineno,msg);
                      else
                          fprintf(stderr,&quot;Exception: %s\n&quot;,msg);
                      ret = false;
                  }
                  else if (comp.complType() == ReturnValue) {
<span class="line-modified">!                     char *msg = comp.value().toString(interp.globalObject()).ascii();</span>
                      fprintf(stderr,&quot;Return value: %s\n&quot;,msg);
                  }
              }
          }
  
</pre>
<center><a href="runtime_object.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../contentextensions/ContentExtensionCompiler.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>