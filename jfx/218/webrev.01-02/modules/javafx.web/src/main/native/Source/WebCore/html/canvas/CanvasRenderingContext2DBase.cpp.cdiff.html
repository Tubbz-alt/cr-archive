<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/html/canvas/CanvasRenderingContext2DBase.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="CanvasRenderingContext2D.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="CanvasRenderingContext2DBase.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/html/canvas/CanvasRenderingContext2DBase.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 158,11 ***</span>
      }
  }
  
  CanvasRenderingContext2DBase::~CanvasRenderingContext2DBase()
  {
<span class="line-modified">! #if !ASSERT_DISABLED</span>
      unwindStateStack();
  #endif
  
      if (UNLIKELY(tracksDisplayListReplay()))
          contextDisplayListMap().remove(this);
<span class="line-new-header">--- 158,11 ---</span>
      }
  }
  
  CanvasRenderingContext2DBase::~CanvasRenderingContext2DBase()
  {
<span class="line-modified">! #if ASSERT_ENABLED</span>
      unwindStateStack();
  #endif
  
      if (UNLIKELY(tracksDisplayListReplay()))
          contextDisplayListMap().remove(this);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 197,11 ***</span>
      , lineJoin(MiterJoin)
      , miterLimit(10)
      , shadowBlur(0)
      , shadowColor(Color::transparent)
      , globalAlpha(1)
<span class="line-modified">!     , globalComposite(CompositeSourceOver)</span>
      , globalBlend(BlendMode::Normal)
      , hasInvertibleTransform(true)
      , lineDashOffset(0)
      , imageSmoothingEnabled(true)
      , imageSmoothingQuality(defaultSmoothingQuality)
<span class="line-new-header">--- 197,11 ---</span>
      , lineJoin(MiterJoin)
      , miterLimit(10)
      , shadowBlur(0)
      , shadowColor(Color::transparent)
      , globalAlpha(1)
<span class="line-modified">!     , globalComposite(CompositeOperator::SourceOver)</span>
      , globalBlend(BlendMode::Normal)
      , hasInvertibleTransform(true)
      , lineDashOffset(0)
      , imageSmoothingEnabled(true)
      , imageSmoothingQuality(defaultSmoothingQuality)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 400,18 ***</span>
          return;
  
      if (state().strokeStyle.isValid() &amp;&amp; state().strokeStyle.isEquivalentColor(style))
          return;
  
<span class="line-modified">!     if (style.isCurrentColor() &amp;&amp; is&lt;HTMLCanvasElement&gt;(canvasBase())) {</span>
<span class="line-removed">-         auto&amp; canvas = downcast&lt;HTMLCanvasElement&gt;(canvasBase());</span>
<span class="line-removed">- </span>
          if (style.hasOverrideAlpha()) {
              // FIXME: Should not use RGBA32 here.
<span class="line-modified">!             style = CanvasStyle(colorWithOverrideAlpha(currentColor(&amp;canvas).rgb(), style.overrideAlpha()));</span>
          } else
<span class="line-modified">!             style = CanvasStyle(currentColor(&amp;canvas));</span>
      } else
          checkOrigin(style.canvasPattern().get());
  
      realizeSaves();
      State&amp; state = modifiableState();
<span class="line-new-header">--- 400,16 ---</span>
          return;
  
      if (state().strokeStyle.isValid() &amp;&amp; state().strokeStyle.isEquivalentColor(style))
          return;
  
<span class="line-modified">!     if (style.isCurrentColor()) {</span>
          if (style.hasOverrideAlpha()) {
              // FIXME: Should not use RGBA32 here.
<span class="line-modified">!             style = CanvasStyle(colorWithOverrideAlpha(currentColor(canvasBase()).rgb(), style.overrideAlpha()));</span>
          } else
<span class="line-modified">!             style = CanvasStyle(currentColor(canvasBase()));</span>
      } else
          checkOrigin(style.canvasPattern().get());
  
      realizeSaves();
      State&amp; state = modifiableState();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 429,18 ***</span>
          return;
  
      if (state().fillStyle.isValid() &amp;&amp; state().fillStyle.isEquivalentColor(style))
          return;
  
<span class="line-modified">!     if (style.isCurrentColor() &amp;&amp; is&lt;HTMLCanvasElement&gt;(canvasBase())) {</span>
<span class="line-removed">-         auto&amp; canvas = downcast&lt;HTMLCanvasElement&gt;(canvasBase());</span>
<span class="line-removed">- </span>
          if (style.hasOverrideAlpha()) {
              // FIXME: Should not use RGBA32 here.
<span class="line-modified">!             style = CanvasStyle(colorWithOverrideAlpha(currentColor(&amp;canvas).rgb(), style.overrideAlpha()));</span>
          } else
<span class="line-modified">!             style = CanvasStyle(currentColor(&amp;canvas));</span>
      } else
          checkOrigin(style.canvasPattern().get());
  
      realizeSaves();
      State&amp; state = modifiableState();
<span class="line-new-header">--- 427,16 ---</span>
          return;
  
      if (state().fillStyle.isValid() &amp;&amp; state().fillStyle.isEquivalentColor(style))
          return;
  
<span class="line-modified">!     if (style.isCurrentColor()) {</span>
          if (style.hasOverrideAlpha()) {
              // FIXME: Should not use RGBA32 here.
<span class="line-modified">!             style = CanvasStyle(colorWithOverrideAlpha(currentColor(canvasBase()).rgb(), style.overrideAlpha()));</span>
          } else
<span class="line-modified">!             style = CanvasStyle(currentColor(canvasBase()));</span>
      } else
          checkOrigin(style.canvasPattern().get());
  
      realizeSaves();
      State&amp; state = modifiableState();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 669,12 ***</span>
      return Color(state().shadowColor).serialized();
  }
  
  void CanvasRenderingContext2DBase::setShadowColor(const String&amp; colorString)
  {
<span class="line-modified">!     auto&amp; canvas = downcast&lt;HTMLCanvasElement&gt;(canvasBase());</span>
<span class="line-removed">-     Color color = parseColorOrCurrentColor(colorString, &amp;canvas);</span>
      if (!color.isValid())
          return;
      if (state().shadowColor == color)
          return;
      realizeSaves();
<span class="line-new-header">--- 665,11 ---</span>
      return Color(state().shadowColor).serialized();
  }
  
  void CanvasRenderingContext2DBase::setShadowColor(const String&amp; colorString)
  {
<span class="line-modified">!     Color color = parseColorOrCurrentColor(colorString, canvasBase());</span>
      if (!color.isValid())
          return;
      if (state().shadowColor == color)
          return;
      realizeSaves();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 772,11 ***</span>
      return compositeOperatorName(state().globalComposite, state().globalBlend);
  }
  
  void CanvasRenderingContext2DBase::setGlobalCompositeOperation(const String&amp; operation)
  {
<span class="line-modified">!     CompositeOperator op = CompositeSourceOver;</span>
      BlendMode blendMode = BlendMode::Normal;
      if (!parseCompositeAndBlendOperator(operation, op, blendMode))
          return;
      if ((state().globalComposite == op) &amp;&amp; (state().globalBlend == blendMode))
          return;
<span class="line-new-header">--- 767,11 ---</span>
      return compositeOperatorName(state().globalComposite, state().globalBlend);
  }
  
  void CanvasRenderingContext2DBase::setGlobalCompositeOperation(const String&amp; operation)
  {
<span class="line-modified">!     CompositeOperator op = CompositeOperator::SourceOver;</span>
      BlendMode blendMode = BlendMode::Normal;
      if (!parseCompositeAndBlendOperator(operation, op, blendMode))
          return;
      if ((state().globalComposite == op) &amp;&amp; (state().globalBlend == blendMode))
          return;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 939,19 ***</span>
  }
  
  void CanvasRenderingContext2DBase::setStrokeColor(const String&amp; color, Optional&lt;float&gt; alpha)
  {
      if (alpha) {
<span class="line-modified">!         setStrokeStyle(CanvasStyle::createFromStringWithOverrideAlpha(color, alpha.value()));</span>
          return;
      }
  
      if (color == state().unparsedStrokeColor)
          return;
  
      realizeSaves();
<span class="line-modified">!     setStrokeStyle(CanvasStyle::createFromString(color));</span>
      modifiableState().unparsedStrokeColor = color;
  }
  
  void CanvasRenderingContext2DBase::setStrokeColor(float grayLevel, float alpha)
  {
<span class="line-new-header">--- 934,19 ---</span>
  }
  
  void CanvasRenderingContext2DBase::setStrokeColor(const String&amp; color, Optional&lt;float&gt; alpha)
  {
      if (alpha) {
<span class="line-modified">!         setStrokeStyle(CanvasStyle::createFromStringWithOverrideAlpha(color, alpha.value(), canvasBase()));</span>
          return;
      }
  
      if (color == state().unparsedStrokeColor)
          return;
  
      realizeSaves();
<span class="line-modified">!     setStrokeStyle(CanvasStyle::createFromString(color, canvasBase()));</span>
      modifiableState().unparsedStrokeColor = color;
  }
  
  void CanvasRenderingContext2DBase::setStrokeColor(float grayLevel, float alpha)
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 975,19 ***</span>
  }
  
  void CanvasRenderingContext2DBase::setFillColor(const String&amp; color, Optional&lt;float&gt; alpha)
  {
      if (alpha) {
<span class="line-modified">!         setFillStyle(CanvasStyle::createFromStringWithOverrideAlpha(color, alpha.value()));</span>
          return;
      }
  
      if (color == state().unparsedFillColor)
          return;
  
      realizeSaves();
<span class="line-modified">!     setFillStyle(CanvasStyle::createFromString(color));</span>
      modifiableState().unparsedFillColor = color;
  }
  
  void CanvasRenderingContext2DBase::setFillColor(float grayLevel, float alpha)
  {
<span class="line-new-header">--- 970,19 ---</span>
  }
  
  void CanvasRenderingContext2DBase::setFillColor(const String&amp; color, Optional&lt;float&gt; alpha)
  {
      if (alpha) {
<span class="line-modified">!         setFillStyle(CanvasStyle::createFromStringWithOverrideAlpha(color, alpha.value(), canvasBase()));</span>
          return;
      }
  
      if (color == state().unparsedFillColor)
          return;
  
      realizeSaves();
<span class="line-modified">!     setFillStyle(CanvasStyle::createFromString(color, canvasBase()));</span>
      modifiableState().unparsedFillColor = color;
  }
  
  void CanvasRenderingContext2DBase::setFillColor(float grayLevel, float alpha)
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1037,13 ***</span>
  }
  
  bool CanvasRenderingContext2DBase::isFullCanvasCompositeMode(CompositeOperator op)
  {
      // See 4.8.11.1.3 Compositing
<span class="line-modified">!     // CompositeSourceAtop and CompositeDestinationOut are not listed here as the platforms already</span>
      // implement the specification&#39;s behavior.
<span class="line-modified">!     return op == CompositeSourceIn || op == CompositeSourceOut || op == CompositeDestinationIn || op == CompositeDestinationAtop;</span>
  }
  
  static WindRule toWindRule(CanvasFillRule rule)
  {
      return rule == CanvasFillRule::Nonzero ? WindRule::NonZero : WindRule::EvenOdd;
<span class="line-new-header">--- 1032,13 ---</span>
  }
  
  bool CanvasRenderingContext2DBase::isFullCanvasCompositeMode(CompositeOperator op)
  {
      // See 4.8.11.1.3 Compositing
<span class="line-modified">!     // CompositeOperator::SourceAtop and CompositeOperator::DestinationOut are not listed here as the platforms already</span>
      // implement the specification&#39;s behavior.
<span class="line-modified">!     return op == CompositeOperator::SourceIn || op == CompositeOperator::SourceOut || op == CompositeOperator::DestinationIn || op == CompositeOperator::DestinationAtop;</span>
  }
  
  static WindRule toWindRule(CanvasFillRule rule)
  {
      return rule == CanvasFillRule::Nonzero ? WindRule::NonZero : WindRule::EvenOdd;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1099,11 ***</span>
          if (isFullCanvasCompositeMode(state().globalComposite)) {
              beginCompositeLayer();
              c-&gt;fillPath(path);
              endCompositeLayer();
              didDrawEntireCanvas();
<span class="line-modified">!         } else if (state().globalComposite == CompositeCopy) {</span>
              clearCanvas();
              c-&gt;fillPath(path);
              didDrawEntireCanvas();
          } else {
              c-&gt;fillPath(path);
<span class="line-new-header">--- 1094,11 ---</span>
          if (isFullCanvasCompositeMode(state().globalComposite)) {
              beginCompositeLayer();
              c-&gt;fillPath(path);
              endCompositeLayer();
              didDrawEntireCanvas();
<span class="line-modified">!         } else if (state().globalComposite == CompositeOperator::Copy) {</span>
              clearCanvas();
              c-&gt;fillPath(path);
              didDrawEntireCanvas();
          } else {
              c-&gt;fillPath(path);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1131,11 ***</span>
          if (isFullCanvasCompositeMode(state().globalComposite)) {
              beginCompositeLayer();
              c-&gt;strokePath(path);
              endCompositeLayer();
              didDrawEntireCanvas();
<span class="line-modified">!         } else if (state().globalComposite == CompositeCopy) {</span>
              clearCanvas();
              c-&gt;strokePath(path);
              didDrawEntireCanvas();
          } else {
              FloatRect dirtyRect = path.fastBoundingRect();
<span class="line-new-header">--- 1126,11 ---</span>
          if (isFullCanvasCompositeMode(state().globalComposite)) {
              beginCompositeLayer();
              c-&gt;strokePath(path);
              endCompositeLayer();
              didDrawEntireCanvas();
<span class="line-modified">!         } else if (state().globalComposite == CompositeOperator::Copy) {</span>
              clearCanvas();
              c-&gt;strokePath(path);
              didDrawEntireCanvas();
          } else {
              FloatRect dirtyRect = path.fastBoundingRect();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1219,11 ***</span>
      auto transformedPoint = state().transform.inverse().valueOr(AffineTransform()).mapPoint(FloatPoint(x, y));
      if (!std::isfinite(transformedPoint.x()) || !std::isfinite(transformedPoint.y()))
          return false;
  
      CanvasStrokeStyleApplier applier(this);
<span class="line-modified">!     return path.strokeContains(&amp;applier, transformedPoint);</span>
  }
  
  void CanvasRenderingContext2DBase::clearRect(float x, float y, float width, float height)
  {
      if (!validateRectForCanvas(x, y, width, height))
<span class="line-new-header">--- 1214,11 ---</span>
      auto transformedPoint = state().transform.inverse().valueOr(AffineTransform()).mapPoint(FloatPoint(x, y));
      if (!std::isfinite(transformedPoint.x()) || !std::isfinite(transformedPoint.y()))
          return false;
  
      CanvasStrokeStyleApplier applier(this);
<span class="line-modified">!     return path.strokeContains(applier, transformedPoint);</span>
  }
  
  void CanvasRenderingContext2DBase::clearRect(float x, float y, float width, float height)
  {
      if (!validateRectForCanvas(x, y, width, height))
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1246,16 ***</span>
              context-&gt;save();
              saved = true;
          }
          context-&gt;setAlpha(1);
      }
<span class="line-modified">!     if (state().globalComposite != CompositeSourceOver) {</span>
          if (!saved) {
              context-&gt;save();
              saved = true;
          }
<span class="line-modified">!         context-&gt;setCompositeOperation(CompositeSourceOver);</span>
      }
      context-&gt;clearRect(rect);
      if (saved)
          context-&gt;restore();
      didDraw(rect);
<span class="line-new-header">--- 1241,16 ---</span>
              context-&gt;save();
              saved = true;
          }
          context-&gt;setAlpha(1);
      }
<span class="line-modified">!     if (state().globalComposite != CompositeOperator::SourceOver) {</span>
          if (!saved) {
              context-&gt;save();
              saved = true;
          }
<span class="line-modified">!         context-&gt;setCompositeOperation(CompositeOperator::SourceOver);</span>
      }
      context-&gt;clearRect(rect);
      if (saved)
          context-&gt;restore();
      didDraw(rect);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1287,11 ***</span>
      } else if (isFullCanvasCompositeMode(state().globalComposite)) {
          beginCompositeLayer();
          c-&gt;fillRect(rect);
          endCompositeLayer();
          didDrawEntireCanvas();
<span class="line-modified">!     } else if (state().globalComposite == CompositeCopy) {</span>
          clearCanvas();
          c-&gt;fillRect(rect);
          didDrawEntireCanvas();
      } else {
          c-&gt;fillRect(rect);
<span class="line-new-header">--- 1282,11 ---</span>
      } else if (isFullCanvasCompositeMode(state().globalComposite)) {
          beginCompositeLayer();
          c-&gt;fillRect(rect);
          endCompositeLayer();
          didDrawEntireCanvas();
<span class="line-modified">!     } else if (state().globalComposite == CompositeOperator::Copy) {</span>
          clearCanvas();
          c-&gt;fillRect(rect);
          didDrawEntireCanvas();
      } else {
          c-&gt;fillRect(rect);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1321,11 ***</span>
      if (isFullCanvasCompositeMode(state().globalComposite)) {
          beginCompositeLayer();
          c-&gt;strokeRect(rect, state().lineWidth);
          endCompositeLayer();
          didDrawEntireCanvas();
<span class="line-modified">!     } else if (state().globalComposite == CompositeCopy) {</span>
          clearCanvas();
          c-&gt;strokeRect(rect, state().lineWidth);
          didDrawEntireCanvas();
      } else {
          FloatRect boundingRect = rect;
<span class="line-new-header">--- 1316,11 ---</span>
      if (isFullCanvasCompositeMode(state().globalComposite)) {
          beginCompositeLayer();
          c-&gt;strokeRect(rect, state().lineWidth);
          endCompositeLayer();
          didDrawEntireCanvas();
<span class="line-modified">!     } else if (state().globalComposite == CompositeOperator::Copy) {</span>
          clearCanvas();
          c-&gt;strokeRect(rect, state().lineWidth);
          didDrawEntireCanvas();
      } else {
          FloatRect boundingRect = rect;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1337,12 ***</span>
  
  void CanvasRenderingContext2DBase::setShadow(float width, float height, float blur, const String&amp; colorString, Optional&lt;float&gt; alpha)
  {
      Color color = Color::transparent;
      if (!colorString.isNull()) {
<span class="line-modified">!         auto&amp; canvas = downcast&lt;HTMLCanvasElement&gt;(canvasBase());</span>
<span class="line-removed">-         color = parseColorOrCurrentColor(colorString, &amp;canvas);</span>
          if (!color.isValid())
              return;
      }
      // FIXME: Should not use RGBA32 here.
      setShadow(FloatSize(width, height), blur, colorWithOverrideAlpha(color.rgb(), alpha));
<span class="line-new-header">--- 1332,11 ---</span>
  
  void CanvasRenderingContext2DBase::setShadow(float width, float height, float blur, const String&amp; colorString, Optional&lt;float&gt; alpha)
  {
      Color color = Color::transparent;
      if (!colorString.isNull()) {
<span class="line-modified">!         color = parseColorOrCurrentColor(colorString, canvasBase());</span>
          if (!color.isValid())
              return;
      }
      // FIXME: Should not use RGBA32 here.
      setShadow(FloatSize(width, height), blur, colorWithOverrideAlpha(color.rgb(), alpha));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1411,13 ***</span>
              size.scale(downcast&lt;RenderImage&gt;(*element.renderer()).imageDevicePixelRatio());
      }
      return size;
  }
  
<span class="line-modified">! static inline FloatSize size(HTMLCanvasElement&amp; canvasElement)</span>
  {
<span class="line-modified">!     return canvasElement.size();</span>
  }
  
  static inline FloatSize size(ImageBitmap&amp; imageBitmap)
  {
      return FloatSize { static_cast&lt;float&gt;(imageBitmap.width()), static_cast&lt;float&gt;(imageBitmap.height()) };
<span class="line-new-header">--- 1405,13 ---</span>
              size.scale(downcast&lt;RenderImage&gt;(*element.renderer()).imageDevicePixelRatio());
      }
      return size;
  }
  
<span class="line-modified">! static inline FloatSize size(CanvasBase&amp; canvas)</span>
  {
<span class="line-modified">!     return canvas.size();</span>
  }
  
  static inline FloatSize size(ImageBitmap&amp; imageBitmap)
  {
      return FloatSize { static_cast&lt;float&gt;(imageBitmap.width()), static_cast&lt;float&gt;(imageBitmap.height()) };
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1576,32 ***</span>
          if (image-&gt;isAnimated() &amp;&amp; !document.settings().animatedImageDebugCanvasDrawingEnabled())
              image = BitmapImage::create(image-&gt;nativeImage());
          downcast&lt;BitmapImage&gt;(*image).updateFromSettings(document.settings());
      }
  
      if (rectContainsCanvas(normalizedDstRect)) {
<span class="line-modified">!         c-&gt;drawImage(*image, normalizedDstRect, normalizedSrcRect, { op, blendMode });</span>
          didDrawEntireCanvas();
      } else if (isFullCanvasCompositeMode(op)) {
          fullCanvasCompositedDrawImage(*image, normalizedDstRect, normalizedSrcRect, op);
          didDrawEntireCanvas();
<span class="line-modified">!     } else if (op == CompositeCopy) {</span>
          clearCanvas();
<span class="line-modified">!         c-&gt;drawImage(*image, normalizedDstRect, normalizedSrcRect, { op, blendMode });</span>
          didDrawEntireCanvas();
      } else {
<span class="line-modified">!         c-&gt;drawImage(*image, normalizedDstRect, normalizedSrcRect, { op, blendMode });</span>
          didDraw(normalizedDstRect);
      }
  
      if (image-&gt;isSVGImage())
          image-&gt;setImageObserver(observer);
  
      return { };
  }
  
<span class="line-modified">! ExceptionOr&lt;void&gt; CanvasRenderingContext2DBase::drawImage(HTMLCanvasElement&amp; sourceCanvas, const FloatRect&amp; srcRect, const FloatRect&amp; dstRect)</span>
  {
      FloatRect srcCanvasRect = FloatRect(FloatPoint(), sourceCanvas.size());
  
      if (!srcCanvasRect.width() || !srcCanvasRect.height())
          return Exception { InvalidStateError };
<span class="line-new-header">--- 1570,34 ---</span>
          if (image-&gt;isAnimated() &amp;&amp; !document.settings().animatedImageDebugCanvasDrawingEnabled())
              image = BitmapImage::create(image-&gt;nativeImage());
          downcast&lt;BitmapImage&gt;(*image).updateFromSettings(document.settings());
      }
  
<span class="line-added">+     ImagePaintingOptions options = { op, blendMode, ImageOrientation::FromImage };</span>
<span class="line-added">+ </span>
      if (rectContainsCanvas(normalizedDstRect)) {
<span class="line-modified">!         c-&gt;drawImage(*image, normalizedDstRect, normalizedSrcRect, options);</span>
          didDrawEntireCanvas();
      } else if (isFullCanvasCompositeMode(op)) {
          fullCanvasCompositedDrawImage(*image, normalizedDstRect, normalizedSrcRect, op);
          didDrawEntireCanvas();
<span class="line-modified">!     } else if (op == CompositeOperator::Copy) {</span>
          clearCanvas();
<span class="line-modified">!         c-&gt;drawImage(*image, normalizedDstRect, normalizedSrcRect, options);</span>
          didDrawEntireCanvas();
      } else {
<span class="line-modified">!         c-&gt;drawImage(*image, normalizedDstRect, normalizedSrcRect, options);</span>
          didDraw(normalizedDstRect);
      }
  
      if (image-&gt;isSVGImage())
          image-&gt;setImageObserver(observer);
  
      return { };
  }
  
<span class="line-modified">! ExceptionOr&lt;void&gt; CanvasRenderingContext2DBase::drawImage(CanvasBase&amp; sourceCanvas, const FloatRect&amp; srcRect, const FloatRect&amp; dstRect)</span>
  {
      FloatRect srcCanvasRect = FloatRect(FloatPoint(), sourceCanvas.size());
  
      if (!srcCanvasRect.width() || !srcCanvasRect.height())
          return Exception { InvalidStateError };
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1640,13 ***</span>
          c-&gt;drawImageBuffer(*buffer, dstRect, srcRect, { state().globalComposite, state().globalBlend });
          didDrawEntireCanvas();
      } else if (isFullCanvasCompositeMode(state().globalComposite)) {
          fullCanvasCompositedDrawImage(*buffer, dstRect, srcRect, state().globalComposite);
          didDrawEntireCanvas();
<span class="line-modified">!     } else if (state().globalComposite == CompositeCopy) {</span>
          if (&amp;sourceCanvas == &amp;canvasBase()) {
<span class="line-modified">!             if (auto copy = buffer-&gt;copyRectToBuffer(srcRect, ColorSpaceSRGB, *c)) {</span>
                  clearCanvas();
                  c-&gt;drawImageBuffer(*copy, dstRect, { { }, srcRect.size() }, { state().globalComposite, state().globalBlend });
              }
          } else {
              clearCanvas();
<span class="line-new-header">--- 1636,13 ---</span>
          c-&gt;drawImageBuffer(*buffer, dstRect, srcRect, { state().globalComposite, state().globalBlend });
          didDrawEntireCanvas();
      } else if (isFullCanvasCompositeMode(state().globalComposite)) {
          fullCanvasCompositedDrawImage(*buffer, dstRect, srcRect, state().globalComposite);
          didDrawEntireCanvas();
<span class="line-modified">!     } else if (state().globalComposite == CompositeOperator::Copy) {</span>
          if (&amp;sourceCanvas == &amp;canvasBase()) {
<span class="line-modified">!             if (auto copy = buffer-&gt;copyRectToBuffer(srcRect, ColorSpace::SRGB, *c)) {</span>
                  clearCanvas();
                  c-&gt;drawImageBuffer(*copy, dstRect, { { }, srcRect.size() }, { state().globalComposite, state().globalBlend });
              }
          } else {
              clearCanvas();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1738,11 ***</span>
          c-&gt;drawImageBuffer(*buffer, dstRect, srcRect, { state().globalComposite, state().globalBlend });
          didDrawEntireCanvas();
      } else if (isFullCanvasCompositeMode(state().globalComposite)) {
          fullCanvasCompositedDrawImage(*buffer, dstRect, srcRect, state().globalComposite);
          didDrawEntireCanvas();
<span class="line-modified">!     } else if (state().globalComposite == CompositeCopy) {</span>
          clearCanvas();
          c-&gt;drawImageBuffer(*buffer, dstRect, srcRect, { state().globalComposite, state().globalBlend });
          didDrawEntireCanvas();
      } else {
          c-&gt;drawImageBuffer(*buffer, dstRect, srcRect, { state().globalComposite, state().globalBlend });
<span class="line-new-header">--- 1734,11 ---</span>
          c-&gt;drawImageBuffer(*buffer, dstRect, srcRect, { state().globalComposite, state().globalBlend });
          didDrawEntireCanvas();
      } else if (isFullCanvasCompositeMode(state().globalComposite)) {
          fullCanvasCompositedDrawImage(*buffer, dstRect, srcRect, state().globalComposite);
          didDrawEntireCanvas();
<span class="line-modified">!     } else if (state().globalComposite == CompositeOperator::Copy) {</span>
          clearCanvas();
          c-&gt;drawImageBuffer(*buffer, dstRect, srcRect, { state().globalComposite, state().globalBlend });
          didDrawEntireCanvas();
      } else {
          c-&gt;drawImageBuffer(*buffer, dstRect, srcRect, { state().globalComposite, state().globalBlend });
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1755,11 ***</span>
  void CanvasRenderingContext2DBase::drawImageFromRect(HTMLImageElement&amp; imageElement, float sx, float sy, float sw, float sh, float dx, float dy, float dw, float dh, const String&amp; compositeOperation)
  {
      CompositeOperator op;
      auto blendOp = BlendMode::Normal;
      if (!parseCompositeAndBlendOperator(compositeOperation, op, blendOp) || blendOp != BlendMode::Normal)
<span class="line-modified">!         op = CompositeSourceOver;</span>
      drawImage(imageElement, FloatRect { sx, sy, sw, sh }, FloatRect { dx, dy, dw, dh }, op, BlendMode::Normal);
  }
  
  void CanvasRenderingContext2DBase::clearCanvas()
  {
<span class="line-new-header">--- 1751,11 ---</span>
  void CanvasRenderingContext2DBase::drawImageFromRect(HTMLImageElement&amp; imageElement, float sx, float sy, float sw, float sh, float dx, float dy, float dw, float dh, const String&amp; compositeOperation)
  {
      CompositeOperator op;
      auto blendOp = BlendMode::Normal;
      if (!parseCompositeAndBlendOperator(compositeOperation, op, blendOp) || blendOp != BlendMode::Normal)
<span class="line-modified">!         op = CompositeOperator::SourceOver;</span>
      drawImage(imageElement, FloatRect { sx, sy, sw, sh }, FloatRect { dx, dy, dw, dh }, op, BlendMode::Normal);
  }
  
  void CanvasRenderingContext2DBase::clearCanvas()
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1808,11 ***</span>
      return bufferRect;
  }
  
  std::unique_ptr&lt;ImageBuffer&gt; CanvasRenderingContext2DBase::createCompositingBuffer(const IntRect&amp; bufferRect)
  {
<span class="line-modified">!     return ImageBuffer::create(bufferRect.size(), isAccelerated() ? Accelerated : Unaccelerated);</span>
  }
  
  void CanvasRenderingContext2DBase::compositeBuffer(ImageBuffer&amp; buffer, const IntRect&amp; bufferRect, CompositeOperator op)
  {
      IntRect canvasRect(0, 0, canvasBase().width(), canvasBase().height());
<span class="line-new-header">--- 1804,11 ---</span>
      return bufferRect;
  }
  
  std::unique_ptr&lt;ImageBuffer&gt; CanvasRenderingContext2DBase::createCompositingBuffer(const IntRect&amp; bufferRect)
  {
<span class="line-modified">!     return ImageBuffer::create(bufferRect.size(), isAccelerated() ? RenderingMode::Accelerated : RenderingMode::Unaccelerated);</span>
  }
  
  void CanvasRenderingContext2DBase::compositeBuffer(ImageBuffer&amp; buffer, const IntRect&amp; bufferRect, CompositeOperator op)
  {
      IntRect canvasRect(0, 0, canvasBase().width(), canvasBase().height());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1868,44 ***</span>
      AffineTransform effectiveTransform = c-&gt;getCTM();
      IntRect transformedAdjustedRect = enclosingIntRect(effectiveTransform.mapRect(adjustedDest));
      buffer-&gt;context().translate(-transformedAdjustedRect.location());
      buffer-&gt;context().translate(croppedOffset);
      buffer-&gt;context().concatCTM(effectiveTransform);
<span class="line-modified">!     drawImageToContext(image, buffer-&gt;context(), adjustedDest, src, { CompositeSourceOver });</span>
  
      compositeBuffer(*buffer, bufferRect, op);
  }
  
<span class="line-modified">! static CanvasRenderingContext2DBase::Style toStyle(const CanvasStyle&amp; style)</span>
  {
      if (auto gradient = style.canvasGradient())
          return gradient;
      if (auto pattern = style.canvasPattern())
          return pattern;
      return style.color();
  }
  
<span class="line-modified">! CanvasRenderingContext2DBase::Style CanvasRenderingContext2DBase::strokeStyle() const</span>
  {
<span class="line-modified">!     return toStyle(state().strokeStyle);</span>
  }
  
<span class="line-modified">! void CanvasRenderingContext2DBase::setStrokeStyle(CanvasRenderingContext2DBase::Style&amp;&amp; style)</span>
  {
      WTF::switchOn(style,
          [this] (const String&amp; string) { this-&gt;setStrokeColor(string); },
          [this] (const RefPtr&lt;CanvasGradient&gt;&amp; gradient) { this-&gt;setStrokeStyle(CanvasStyle(*gradient)); },
          [this] (const RefPtr&lt;CanvasPattern&gt;&amp; pattern) { this-&gt;setStrokeStyle(CanvasStyle(*pattern)); }
      );
  }
  
<span class="line-modified">! CanvasRenderingContext2DBase::Style CanvasRenderingContext2DBase::fillStyle() const</span>
  {
<span class="line-modified">!     return toStyle(state().fillStyle);</span>
  }
  
<span class="line-modified">! void CanvasRenderingContext2DBase::setFillStyle(CanvasRenderingContext2DBase::Style&amp;&amp; style)</span>
  {
      WTF::switchOn(style,
          [this] (const String&amp; string) { this-&gt;setFillColor(string); },
          [this] (const RefPtr&lt;CanvasGradient&gt;&amp; gradient) { this-&gt;setFillStyle(CanvasStyle(*gradient)); },
          [this] (const RefPtr&lt;CanvasPattern&gt;&amp; pattern) { this-&gt;setFillStyle(CanvasStyle(*pattern)); }
<span class="line-new-header">--- 1864,44 ---</span>
      AffineTransform effectiveTransform = c-&gt;getCTM();
      IntRect transformedAdjustedRect = enclosingIntRect(effectiveTransform.mapRect(adjustedDest));
      buffer-&gt;context().translate(-transformedAdjustedRect.location());
      buffer-&gt;context().translate(croppedOffset);
      buffer-&gt;context().concatCTM(effectiveTransform);
<span class="line-modified">!     drawImageToContext(image, buffer-&gt;context(), adjustedDest, src, { CompositeOperator::SourceOver });</span>
  
      compositeBuffer(*buffer, bufferRect, op);
  }
  
<span class="line-modified">! static CanvasRenderingContext2DBase::StyleVariant toStyleVariant(const CanvasStyle&amp; style)</span>
  {
      if (auto gradient = style.canvasGradient())
          return gradient;
      if (auto pattern = style.canvasPattern())
          return pattern;
      return style.color();
  }
  
<span class="line-modified">! CanvasRenderingContext2DBase::StyleVariant CanvasRenderingContext2DBase::strokeStyle() const</span>
  {
<span class="line-modified">!     return toStyleVariant(state().strokeStyle);</span>
  }
  
<span class="line-modified">! void CanvasRenderingContext2DBase::setStrokeStyle(CanvasRenderingContext2DBase::StyleVariant&amp;&amp; style)</span>
  {
      WTF::switchOn(style,
          [this] (const String&amp; string) { this-&gt;setStrokeColor(string); },
          [this] (const RefPtr&lt;CanvasGradient&gt;&amp; gradient) { this-&gt;setStrokeStyle(CanvasStyle(*gradient)); },
          [this] (const RefPtr&lt;CanvasPattern&gt;&amp; pattern) { this-&gt;setStrokeStyle(CanvasStyle(*pattern)); }
      );
  }
  
<span class="line-modified">! CanvasRenderingContext2DBase::StyleVariant CanvasRenderingContext2DBase::fillStyle() const</span>
  {
<span class="line-modified">!     return toStyleVariant(state().fillStyle);</span>
  }
  
<span class="line-modified">! void CanvasRenderingContext2DBase::setFillStyle(CanvasRenderingContext2DBase::StyleVariant&amp;&amp; style)</span>
  {
      WTF::switchOn(style,
          [this] (const String&amp; string) { this-&gt;setFillColor(string); },
          [this] (const RefPtr&lt;CanvasGradient&gt;&amp; gradient) { this-&gt;setFillStyle(CanvasStyle(*gradient)); },
          [this] (const RefPtr&lt;CanvasPattern&gt;&amp; pattern) { this-&gt;setFillStyle(CanvasStyle(*pattern)); }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1915,22 ***</span>
  ExceptionOr&lt;Ref&lt;CanvasGradient&gt;&gt; CanvasRenderingContext2DBase::createLinearGradient(float x0, float y0, float x1, float y1)
  {
      if (!std::isfinite(x0) || !std::isfinite(y0) || !std::isfinite(x1) || !std::isfinite(y1))
          return Exception { NotSupportedError };
  
<span class="line-modified">!     return CanvasGradient::create(FloatPoint(x0, y0), FloatPoint(x1, y1));</span>
  }
  
  ExceptionOr&lt;Ref&lt;CanvasGradient&gt;&gt; CanvasRenderingContext2DBase::createRadialGradient(float x0, float y0, float r0, float x1, float y1, float r1)
  {
      if (!std::isfinite(x0) || !std::isfinite(y0) || !std::isfinite(r0) || !std::isfinite(x1) || !std::isfinite(y1) || !std::isfinite(r1))
          return Exception { NotSupportedError };
  
      if (r0 &lt; 0 || r1 &lt; 0)
          return Exception { IndexSizeError };
  
<span class="line-modified">!     return CanvasGradient::create(FloatPoint(x0, y0), r0, FloatPoint(x1, y1), r1);</span>
  }
  
  ExceptionOr&lt;RefPtr&lt;CanvasPattern&gt;&gt; CanvasRenderingContext2DBase::createPattern(CanvasImageSource&amp;&amp; image, const String&amp; repetition)
  {
      bool repeatX, repeatY;
<span class="line-new-header">--- 1911,22 ---</span>
  ExceptionOr&lt;Ref&lt;CanvasGradient&gt;&gt; CanvasRenderingContext2DBase::createLinearGradient(float x0, float y0, float x1, float y1)
  {
      if (!std::isfinite(x0) || !std::isfinite(y0) || !std::isfinite(x1) || !std::isfinite(y1))
          return Exception { NotSupportedError };
  
<span class="line-modified">!     return CanvasGradient::create(FloatPoint(x0, y0), FloatPoint(x1, y1), canvasBase());</span>
  }
  
  ExceptionOr&lt;Ref&lt;CanvasGradient&gt;&gt; CanvasRenderingContext2DBase::createRadialGradient(float x0, float y0, float r0, float x1, float y1, float r1)
  {
      if (!std::isfinite(x0) || !std::isfinite(y0) || !std::isfinite(r0) || !std::isfinite(x1) || !std::isfinite(y1) || !std::isfinite(r1))
          return Exception { NotSupportedError };
  
      if (r0 &lt; 0 || r1 &lt; 0)
          return Exception { IndexSizeError };
  
<span class="line-modified">!     return CanvasGradient::create(FloatPoint(x0, y0), r0, FloatPoint(x1, y1), r1, canvasBase());</span>
  }
  
  ExceptionOr&lt;RefPtr&lt;CanvasPattern&gt;&gt; CanvasRenderingContext2DBase::createPattern(CanvasImageSource&amp;&amp; image, const String&amp; repetition)
  {
      bool repeatX, repeatY;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1992,11 ***</span>
  #if USE(CG) || (ENABLE(ACCELERATED_2D_CANVAS) &amp;&amp; USE(GSTREAMER_GL) &amp;&amp; USE(CAIRO))
      if (auto nativeImage = videoElement.nativeImageForCurrentTime())
          return RefPtr&lt;CanvasPattern&gt; { CanvasPattern::create(BitmapImage::create(WTFMove(nativeImage)), repeatX, repeatY, originClean) };
  #endif
  
<span class="line-modified">!     auto imageBuffer = ImageBuffer::create(size(videoElement), drawingContext() ? drawingContext()-&gt;renderingMode() : Accelerated);</span>
      if (!imageBuffer)
          return nullptr;
  
      videoElement.paintCurrentFrameInContext(imageBuffer-&gt;context(), FloatRect(FloatPoint(), size(videoElement)));
  
<span class="line-new-header">--- 1988,11 ---</span>
  #if USE(CG) || (ENABLE(ACCELERATED_2D_CANVAS) &amp;&amp; USE(GSTREAMER_GL) &amp;&amp; USE(CAIRO))
      if (auto nativeImage = videoElement.nativeImageForCurrentTime())
          return RefPtr&lt;CanvasPattern&gt; { CanvasPattern::create(BitmapImage::create(WTFMove(nativeImage)), repeatX, repeatY, originClean) };
  #endif
  
<span class="line-modified">!     auto imageBuffer = ImageBuffer::create(size(videoElement), drawingContext() ? drawingContext()-&gt;renderingMode() : RenderingMode::Accelerated);</span>
      if (!imageBuffer)
          return nullptr;
  
      videoElement.paintCurrentFrameInContext(imageBuffer-&gt;context(), FloatRect(FloatPoint(), size(videoElement)));
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2032,11 ***</span>
      if (!state().hasInvertibleTransform)
          return;
  
  #if ENABLE(ACCELERATED_2D_CANVAS)
      // If we are drawing to hardware and we have a composited layer, just call contentChanged().
<span class="line-modified">!     if (isAccelerated()) {</span>
          auto&amp; canvas = downcast&lt;HTMLCanvasElement&gt;(canvasBase());
          RenderBox* renderBox = canvas.renderBox();
          if (renderBox &amp;&amp; renderBox-&gt;hasAcceleratedCompositing()) {
              renderBox-&gt;contentChanged(CanvasPixelsChanged);
              canvas.clearCopiedImage();
<span class="line-new-header">--- 2028,11 ---</span>
      if (!state().hasInvertibleTransform)
          return;
  
  #if ENABLE(ACCELERATED_2D_CANVAS)
      // If we are drawing to hardware and we have a composited layer, just call contentChanged().
<span class="line-modified">!     if (isAccelerated() &amp;&amp; is&lt;HTMLCanvasElement&gt;(canvasBase())) {</span>
          auto&amp; canvas = downcast&lt;HTMLCanvasElement&gt;(canvasBase());
          RenderBox* renderBox = canvas.renderBox();
          if (renderBox &amp;&amp; renderBox-&gt;hasAcceleratedCompositing()) {
              renderBox-&gt;contentChanged(CanvasPixelsChanged);
              canvas.clearCopiedImage();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2193,13 ***</span>
          logicalRect.setHeight(1);
      if (!logicalRect.isExpressibleAsIntRect())
          return nullptr;
  
      IntRect imageDataRect = enclosingIntRect(logicalRect);
<span class="line-removed">-     auto&amp; canvas = downcast&lt;HTMLCanvasElement&gt;(canvasBase());</span>
  
<span class="line-modified">!     ImageBuffer* buffer = canvas.buffer();</span>
      if (!buffer)
          return createEmptyImageData(imageDataRect.size());
  
      auto byteArray = buffer-&gt;getUnmultipliedImageData(imageDataRect, nullptr, coordinateSystem);
      if (!byteArray) {
<span class="line-new-header">--- 2189,12 ---</span>
          logicalRect.setHeight(1);
      if (!logicalRect.isExpressibleAsIntRect())
          return nullptr;
  
      IntRect imageDataRect = enclosingIntRect(logicalRect);
  
<span class="line-modified">!     ImageBuffer* buffer = canvasBase().buffer();</span>
      if (!buffer)
          return createEmptyImageData(imageDataRect.size());
  
      auto byteArray = buffer-&gt;getUnmultipliedImageData(imageDataRect, nullptr, coordinateSystem);
      if (!byteArray) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2226,13 ***</span>
      putImageData(data, ImageBuffer::LogicalCoordinateSystem, dx, dy, dirtyX, dirtyY, dirtyWidth, dirtyHeight);
  }
  
  void CanvasRenderingContext2DBase::putImageData(ImageData&amp; data, ImageBuffer::CoordinateSystem coordinateSystem, float dx, float dy, float dirtyX, float dirtyY, float dirtyWidth, float dirtyHeight)
  {
<span class="line-modified">!     auto&amp; canvas = downcast&lt;HTMLCanvasElement&gt;(canvasBase());</span>
<span class="line-removed">- </span>
<span class="line-removed">-     ImageBuffer* buffer = canvas.buffer();</span>
      if (!buffer)
          return;
  
      if (!data.data())
          return;
<span class="line-new-header">--- 2221,11 ---</span>
      putImageData(data, ImageBuffer::LogicalCoordinateSystem, dx, dy, dirtyX, dirtyY, dirtyWidth, dirtyHeight);
  }
  
  void CanvasRenderingContext2DBase::putImageData(ImageData&amp; data, ImageBuffer::CoordinateSystem coordinateSystem, float dx, float dy, float dirtyX, float dirtyY, float dirtyWidth, float dirtyHeight)
  {
<span class="line-modified">!     ImageBuffer* buffer = canvasBase().buffer();</span>
      if (!buffer)
          return;
  
      if (!data.data())
          return;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2281,30 ***</span>
  
  #if ENABLE(ACCELERATED_2D_CANVAS)
  
  PlatformLayer* CanvasRenderingContext2DBase::platformLayer() const
  {
<span class="line-modified">!     auto&amp; canvas = downcast&lt;HTMLCanvasElement&gt;(canvasBase());</span>
  
<span class="line-modified">!     return canvas.buffer() ? canvas.buffer()-&gt;platformLayer() : nullptr;</span>
  }
  
  #endif
  
  static inline InterpolationQuality smoothingToInterpolationQuality(ImageSmoothingQuality quality)
  {
      switch (quality) {
      case ImageSmoothingQuality::Low:
<span class="line-modified">!         return InterpolationLow;</span>
      case ImageSmoothingQuality::Medium:
<span class="line-modified">!         return InterpolationMedium;</span>
      case ImageSmoothingQuality::High:
<span class="line-modified">!         return InterpolationHigh;</span>
      }
  
      ASSERT_NOT_REACHED();
<span class="line-modified">!     return InterpolationLow;</span>
  };
  
  auto CanvasRenderingContext2DBase::imageSmoothingQuality() const -&gt; ImageSmoothingQuality
  {
      return state().imageSmoothingQuality;
<span class="line-new-header">--- 2274,31 ---</span>
  
  #if ENABLE(ACCELERATED_2D_CANVAS)
  
  PlatformLayer* CanvasRenderingContext2DBase::platformLayer() const
  {
<span class="line-modified">!     if (auto* buffer = canvasBase().buffer())</span>
<span class="line-added">+         return buffer-&gt;platformLayer();</span>
  
<span class="line-modified">!     return nullptr;</span>
  }
  
  #endif
  
  static inline InterpolationQuality smoothingToInterpolationQuality(ImageSmoothingQuality quality)
  {
      switch (quality) {
      case ImageSmoothingQuality::Low:
<span class="line-modified">!         return InterpolationQuality::Low;</span>
      case ImageSmoothingQuality::Medium:
<span class="line-modified">!         return InterpolationQuality::Medium;</span>
      case ImageSmoothingQuality::High:
<span class="line-modified">!         return InterpolationQuality::High;</span>
      }
  
      ASSERT_NOT_REACHED();
<span class="line-modified">!     return InterpolationQuality::Low;</span>
  };
  
  auto CanvasRenderingContext2DBase::imageSmoothingQuality() const -&gt; ImageSmoothingQuality
  {
      return state().imageSmoothingQuality;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2337,11 ***</span>
  
      realizeSaves();
      modifiableState().imageSmoothingEnabled = enabled;
      auto* c = drawingContext();
      if (c)
<span class="line-modified">!         c-&gt;setImageInterpolationQuality(enabled ? smoothingToInterpolationQuality(state().imageSmoothingQuality) : InterpolationNone);</span>
  }
  
  void CanvasRenderingContext2DBase::setPath(Path2D&amp; path)
  {
      m_path = path.path();
<span class="line-new-header">--- 2331,11 ---</span>
  
      realizeSaves();
      modifiableState().imageSmoothingEnabled = enabled;
      auto* c = drawingContext();
      if (c)
<span class="line-modified">!         c-&gt;setImageInterpolationQuality(enabled ? smoothingToInterpolationQuality(state().imageSmoothingQuality) : InterpolationQuality::DoNotInterpolate);</span>
  }
  
  void CanvasRenderingContext2DBase::setPath(Path2D&amp; path)
  {
      m_path = path.path();
</pre>
<center><a href="CanvasRenderingContext2D.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="CanvasRenderingContext2DBase.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>