<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/page/SuspendableTimer.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="SettingsBase.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SuspendableTimer.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/page/SuspendableTimer.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 29,23 ***</span>
  
  #include &quot;ScriptExecutionContext.h&quot;
  
  namespace WebCore {
  
<span class="line-modified">! SuspendableTimer::SuspendableTimer(ScriptExecutionContext&amp; context)</span>
<span class="line-modified">!     : ActiveDOMObject(&amp;context)</span>
  {
  }
  
<span class="line-modified">! SuspendableTimer::~SuspendableTimer() = default;</span>
  
<span class="line-modified">! bool SuspendableTimer::hasPendingActivity() const</span>
  {
      return isActive();
  }
  
<span class="line-modified">! void SuspendableTimer::stop()</span>
  {
      if (!m_suspended)
          TimerBase::stop();
  
      // Make it less likely that SuspendableTimer is accidentally revived and fires after being stopped.
<span class="line-new-header">--- 29,23 ---</span>
  
  #include &quot;ScriptExecutionContext.h&quot;
  
  namespace WebCore {
  
<span class="line-modified">! SuspendableTimerBase::SuspendableTimerBase(ScriptExecutionContext* context)</span>
<span class="line-modified">!     : ActiveDOMObject(context)</span>
  {
  }
  
<span class="line-modified">! SuspendableTimerBase::~SuspendableTimerBase() = default;</span>
  
<span class="line-modified">! bool SuspendableTimerBase::hasPendingActivity() const</span>
  {
      return isActive();
  }
  
<span class="line-modified">! void SuspendableTimerBase::stop()</span>
  {
      if (!m_suspended)
          TimerBase::stop();
  
      // Make it less likely that SuspendableTimer is accidentally revived and fires after being stopped.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 54,11 ***</span>
      m_savedIsActive = false;
  
      didStop();
  }
  
<span class="line-modified">! void SuspendableTimer::suspend(ReasonForSuspension)</span>
  {
      ASSERT(!m_suspended);
      m_suspended = true;
  
      m_savedIsActive = TimerBase::isActive();
<span class="line-new-header">--- 54,11 ---</span>
      m_savedIsActive = false;
  
      didStop();
  }
  
<span class="line-modified">! void SuspendableTimerBase::suspend(ReasonForSuspension)</span>
  {
      ASSERT(!m_suspended);
      m_suspended = true;
  
      m_savedIsActive = TimerBase::isActive();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 67,68 ***</span>
          m_savedRepeatInterval = TimerBase::repeatInterval();
          TimerBase::stop();
      }
  }
  
<span class="line-modified">! void SuspendableTimer::resume()</span>
  {
      ASSERT(m_suspended);
      m_suspended = false;
  
      if (m_savedIsActive)
          start(m_savedNextFireInterval, m_savedRepeatInterval);
  }
  
<span class="line-modified">! bool SuspendableTimer::canSuspendForDocumentSuspension() const</span>
  {
<span class="line-removed">-     return true;</span>
  }
  
<span class="line-modified">! void SuspendableTimer::didStop()</span>
<span class="line-removed">- {</span>
<span class="line-removed">- }</span>
<span class="line-removed">- </span>
<span class="line-removed">- void SuspendableTimer::cancel()</span>
  {
      if (!m_suspended)
          TimerBase::stop();
      else
          m_suspended = false;
  }
  
<span class="line-modified">! void SuspendableTimer::startRepeating(Seconds repeatInterval)</span>
  {
      if (!m_suspended)
          TimerBase::startRepeating(repeatInterval);
      else {
          m_savedIsActive = true;
          m_savedNextFireInterval = repeatInterval;
          m_savedRepeatInterval = repeatInterval;
      }
  }
  
<span class="line-modified">! void SuspendableTimer::startOneShot(Seconds interval)</span>
  {
      if (!m_suspended)
          TimerBase::startOneShot(interval);
      else {
          m_savedIsActive = true;
          m_savedNextFireInterval = interval;
          m_savedRepeatInterval = 0_s;
      }
  }
  
<span class="line-modified">! Seconds SuspendableTimer::repeatInterval() const</span>
  {
      if (!m_suspended)
          return TimerBase::repeatInterval();
      if (m_savedIsActive)
          return m_savedRepeatInterval;
      return 0_s;
  }
  
<span class="line-modified">! void SuspendableTimer::augmentFireInterval(Seconds delta)</span>
  {
      if (!m_suspended)
          TimerBase::augmentFireInterval(delta);
      else if (m_savedIsActive) {
          m_savedNextFireInterval += delta;
<span class="line-new-header">--- 67,63 ---</span>
          m_savedRepeatInterval = TimerBase::repeatInterval();
          TimerBase::stop();
      }
  }
  
<span class="line-modified">! void SuspendableTimerBase::resume()</span>
  {
      ASSERT(m_suspended);
      m_suspended = false;
  
      if (m_savedIsActive)
          start(m_savedNextFireInterval, m_savedRepeatInterval);
  }
  
<span class="line-modified">! void SuspendableTimerBase::didStop()</span>
  {
  }
  
<span class="line-modified">! void SuspendableTimerBase::cancel()</span>
  {
      if (!m_suspended)
          TimerBase::stop();
      else
          m_suspended = false;
  }
  
<span class="line-modified">! void SuspendableTimerBase::startRepeating(Seconds repeatInterval)</span>
  {
      if (!m_suspended)
          TimerBase::startRepeating(repeatInterval);
      else {
          m_savedIsActive = true;
          m_savedNextFireInterval = repeatInterval;
          m_savedRepeatInterval = repeatInterval;
      }
  }
  
<span class="line-modified">! void SuspendableTimerBase::startOneShot(Seconds interval)</span>
  {
      if (!m_suspended)
          TimerBase::startOneShot(interval);
      else {
          m_savedIsActive = true;
          m_savedNextFireInterval = interval;
          m_savedRepeatInterval = 0_s;
      }
  }
  
<span class="line-modified">! Seconds SuspendableTimerBase::repeatInterval() const</span>
  {
      if (!m_suspended)
          return TimerBase::repeatInterval();
      if (m_savedIsActive)
          return m_savedRepeatInterval;
      return 0_s;
  }
  
<span class="line-modified">! void SuspendableTimerBase::augmentFireInterval(Seconds delta)</span>
  {
      if (!m_suspended)
          TimerBase::augmentFireInterval(delta);
      else if (m_savedIsActive) {
          m_savedNextFireInterval += delta;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 137,11 ***</span>
          m_savedNextFireInterval = delta;
          m_savedRepeatInterval = 0_s;
      }
  }
  
<span class="line-modified">! void SuspendableTimer::augmentRepeatInterval(Seconds delta)</span>
  {
      if (!m_suspended)
          TimerBase::augmentRepeatInterval(delta);
      else if (m_savedIsActive) {
          m_savedNextFireInterval += delta;
<span class="line-new-header">--- 132,11 ---</span>
          m_savedNextFireInterval = delta;
          m_savedRepeatInterval = 0_s;
      }
  }
  
<span class="line-modified">! void SuspendableTimerBase::augmentRepeatInterval(Seconds delta)</span>
  {
      if (!m_suspended)
          TimerBase::augmentRepeatInterval(delta);
      else if (m_savedIsActive) {
          m_savedNextFireInterval += delta;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 151,6 ***</span>
<span class="line-new-header">--- 146,11 ---</span>
          m_savedNextFireInterval = delta;
          m_savedRepeatInterval = delta;
      }
  }
  
<span class="line-added">+ const char* SuspendableTimer::activeDOMObjectName() const</span>
<span class="line-added">+ {</span>
<span class="line-added">+     return &quot;SuspendableTimer&quot;;</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  } // namespace WebCore
</pre>
<center><a href="SettingsBase.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SuspendableTimer.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>