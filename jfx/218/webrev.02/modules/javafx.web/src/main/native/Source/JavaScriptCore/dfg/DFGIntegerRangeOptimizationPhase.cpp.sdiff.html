<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/dfg/DFGIntegerRangeOptimizationPhase.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DFGIntegerCheckCombiningPhase.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="DFGInvalidationPointInjectionPhase.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/dfg/DFGIntegerRangeOptimizationPhase.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (C) 2015-2016 Apple Inc. All rights reserved.</span>
   3  *
   4  * Redistribution and use in source and binary forms, with or without
   5  * modification, are permitted provided that the following conditions
   6  * are met:
   7  * 1. Redistributions of source code must retain the above copyright
   8  *    notice, this list of conditions and the following disclaimer.
   9  * 2. Redistributions in binary form must reproduce the above copyright
  10  *    notice, this list of conditions and the following disclaimer in the
  11  *    documentation and/or other materials provided with the distribution.
  12  *
  13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
  14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  15  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  16  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
  17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
  21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
</pre>
<hr />
<pre>
  26 #include &quot;config.h&quot;
  27 #include &quot;DFGIntegerRangeOptimizationPhase.h&quot;
  28 
  29 #if ENABLE(DFG_JIT)
  30 
  31 #include &quot;DFGBlockMapInlines.h&quot;
  32 #include &quot;DFGBlockSet.h&quot;
  33 #include &quot;DFGGraph.h&quot;
  34 #include &quot;DFGInsertionSet.h&quot;
  35 #include &quot;DFGNodeFlowProjection.h&quot;
  36 #include &quot;DFGPhase.h&quot;
  37 #include &quot;DFGPredictionPropagationPhase.h&quot;
  38 #include &quot;DFGVariableAccessDataDump.h&quot;
  39 #include &quot;JSCInlines.h&quot;
  40 
  41 namespace JSC { namespace DFG {
  42 
  43 namespace {
  44 
  45 namespace DFGIntegerRangeOptimizationPhaseInternal {
<span class="line-modified">  46 static const bool verbose = false;</span>
  47 }
  48 const unsigned giveUpThreshold = 50;
  49 
  50 int64_t clampedSumImpl() { return 0; }
  51 
  52 template&lt;typename... Args&gt;
  53 int64_t clampedSumImpl(int left, Args... args)
  54 {
  55     return static_cast&lt;int64_t&gt;(left) + clampedSumImpl(args...);
  56 }
  57 
  58 template&lt;typename... Args&gt;
  59 int clampedSum(Args... args)
  60 {
  61     int64_t result = clampedSumImpl(args...);
  62     return static_cast&lt;int&gt;(std::min(
  63         static_cast&lt;int64_t&gt;(std::numeric_limits&lt;int&gt;::max()),
  64         std::max(
  65             static_cast&lt;int64_t&gt;(std::numeric_limits&lt;int&gt;::min()),
  66             result)));
</pre>
<hr />
<pre>
  80         GreaterThan
  81     };
  82 
  83     // Some relationships provide more information than others. When a relationship provides more
  84     // information, it is less vague.
  85     static unsigned vagueness(Kind kind)
  86     {
  87         switch (kind) {
  88         case Equal:
  89             return 0;
  90         case LessThan:
  91         case GreaterThan:
  92             return 1;
  93         case NotEqual:
  94             return 2;
  95         }
  96         RELEASE_ASSERT_NOT_REACHED();
  97         return 0;
  98     }
  99 
<span class="line-modified"> 100     static const unsigned minVagueness = 0;</span>
<span class="line-modified"> 101     static const unsigned maxVagueness = 2;</span>
 102 
 103     static Kind flipped(Kind kind)
 104     {
 105         switch (kind) {
 106         case LessThan:
 107             return GreaterThan;
 108         case Equal:
 109             return Equal;
 110         case NotEqual:
 111             return NotEqual;
 112         case GreaterThan:
 113             return LessThan;
 114         }
 115         RELEASE_ASSERT_NOT_REACHED();
 116         return kind;
 117     }
 118 
 119     Relationship()
 120         : m_left(nullptr)
 121         , m_right(nullptr)
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (C) 2015-2019 Apple Inc. All rights reserved.</span>
   3  *
   4  * Redistribution and use in source and binary forms, with or without
   5  * modification, are permitted provided that the following conditions
   6  * are met:
   7  * 1. Redistributions of source code must retain the above copyright
   8  *    notice, this list of conditions and the following disclaimer.
   9  * 2. Redistributions in binary form must reproduce the above copyright
  10  *    notice, this list of conditions and the following disclaimer in the
  11  *    documentation and/or other materials provided with the distribution.
  12  *
  13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
  14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  15  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  16  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
  17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
  21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
</pre>
<hr />
<pre>
  26 #include &quot;config.h&quot;
  27 #include &quot;DFGIntegerRangeOptimizationPhase.h&quot;
  28 
  29 #if ENABLE(DFG_JIT)
  30 
  31 #include &quot;DFGBlockMapInlines.h&quot;
  32 #include &quot;DFGBlockSet.h&quot;
  33 #include &quot;DFGGraph.h&quot;
  34 #include &quot;DFGInsertionSet.h&quot;
  35 #include &quot;DFGNodeFlowProjection.h&quot;
  36 #include &quot;DFGPhase.h&quot;
  37 #include &quot;DFGPredictionPropagationPhase.h&quot;
  38 #include &quot;DFGVariableAccessDataDump.h&quot;
  39 #include &quot;JSCInlines.h&quot;
  40 
  41 namespace JSC { namespace DFG {
  42 
  43 namespace {
  44 
  45 namespace DFGIntegerRangeOptimizationPhaseInternal {
<span class="line-modified">  46 static constexpr bool verbose = false;</span>
  47 }
  48 const unsigned giveUpThreshold = 50;
  49 
  50 int64_t clampedSumImpl() { return 0; }
  51 
  52 template&lt;typename... Args&gt;
  53 int64_t clampedSumImpl(int left, Args... args)
  54 {
  55     return static_cast&lt;int64_t&gt;(left) + clampedSumImpl(args...);
  56 }
  57 
  58 template&lt;typename... Args&gt;
  59 int clampedSum(Args... args)
  60 {
  61     int64_t result = clampedSumImpl(args...);
  62     return static_cast&lt;int&gt;(std::min(
  63         static_cast&lt;int64_t&gt;(std::numeric_limits&lt;int&gt;::max()),
  64         std::max(
  65             static_cast&lt;int64_t&gt;(std::numeric_limits&lt;int&gt;::min()),
  66             result)));
</pre>
<hr />
<pre>
  80         GreaterThan
  81     };
  82 
  83     // Some relationships provide more information than others. When a relationship provides more
  84     // information, it is less vague.
  85     static unsigned vagueness(Kind kind)
  86     {
  87         switch (kind) {
  88         case Equal:
  89             return 0;
  90         case LessThan:
  91         case GreaterThan:
  92             return 1;
  93         case NotEqual:
  94             return 2;
  95         }
  96         RELEASE_ASSERT_NOT_REACHED();
  97         return 0;
  98     }
  99 
<span class="line-modified"> 100     static constexpr unsigned minVagueness = 0;</span>
<span class="line-modified"> 101     static constexpr unsigned maxVagueness = 2;</span>
 102 
 103     static Kind flipped(Kind kind)
 104     {
 105         switch (kind) {
 106         case LessThan:
 107             return GreaterThan;
 108         case Equal:
 109             return Equal;
 110         case NotEqual:
 111             return NotEqual;
 112         case GreaterThan:
 113             return LessThan;
 114         }
 115         RELEASE_ASSERT_NOT_REACHED();
 116         return kind;
 117     }
 118 
 119     Relationship()
 120         : m_left(nullptr)
 121         , m_right(nullptr)
</pre>
</td>
</tr>
</table>
<center><a href="DFGIntegerCheckCombiningPhase.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="DFGInvalidationPointInjectionPhase.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>