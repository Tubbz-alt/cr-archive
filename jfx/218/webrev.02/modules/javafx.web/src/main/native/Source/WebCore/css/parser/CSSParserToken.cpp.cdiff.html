<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/css/parser/CSSParserToken.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="CSSParserSelector.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="CSSParserToken.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/css/parser/CSSParserToken.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 38,106 ***</span>
  #include &lt;wtf/text/StringBuilder.h&gt;
  
  namespace WebCore {
  
  template&lt;typename CharacterType&gt;
<span class="line-modified">! CSSPrimitiveValue::UnitType cssPrimitiveValueUnitFromTrie(const CharacterType* data, unsigned length)</span>
  {
      ASSERT(data);
      ASSERT(length);
      switch (length) {
      case 1:
          switch (toASCIILower(data[0])) {
          case &#39;s&#39;:
<span class="line-modified">!             return CSSPrimitiveValue::UnitType::CSS_S;</span>
          }
          break;
      case 2:
          switch (toASCIILower(data[0])) {
          case &#39;c&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;h&#39;:
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_CHS;</span>
              case &#39;m&#39;:
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_CM;</span>
              }
              break;
          case &#39;e&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;m&#39;:
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_EMS;</span>
              case &#39;x&#39;:
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_EXS;</span>
              }
              break;
          case &#39;f&#39;:
              if (toASCIILower(data[1]) == &#39;r&#39;)
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_FR;</span>
              break;
          case &#39;h&#39;:
              if (toASCIILower(data[1]) == &#39;z&#39;)
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_HZ;</span>
              break;
          case &#39;i&#39;:
              if (toASCIILower(data[1]) == &#39;n&#39;)
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_IN;</span>
              break;
          case &#39;m&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;m&#39;:
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_MM;</span>
              case &#39;s&#39;:
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_MS;</span>
              }
              break;
          case &#39;p&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;c&#39;:
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_PC;</span>
              case &#39;t&#39;:
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_PT;</span>
              case &#39;x&#39;:
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_PX;</span>
              }
              break;
          case &#39;v&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;h&#39;:
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_VH;</span>
              case &#39;w&#39;:
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_VW;</span>
              }
              break;
          }
          break;
      case 3:
          switch (toASCIILower(data[0])) {
          case &#39;d&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;e&#39;:
                  if (toASCIILower(data[2]) == &#39;g&#39;)
<span class="line-modified">!                     return CSSPrimitiveValue::UnitType::CSS_DEG;</span>
                  break;
              case &#39;p&#39;:
                  if (toASCIILower(data[2]) == &#39;i&#39;)
<span class="line-modified">!                     return CSSPrimitiveValue::UnitType::CSS_DPI;</span>
                  break;
              }
          break;
          case &#39;k&#39;:
              if (toASCIILower(data[1]) == &#39;h&#39; &amp;&amp; toASCIILower(data[2]) == &#39;z&#39;)
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_KHZ;</span>
              break;
          case &#39;r&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;a&#39;:
                  if (toASCIILower(data[2]) == &#39;d&#39;)
<span class="line-modified">!                     return CSSPrimitiveValue::UnitType::CSS_RAD;</span>
                  break;
              case &#39;e&#39;:
                  if (toASCIILower(data[2]) == &#39;m&#39;)
<span class="line-modified">!                     return CSSPrimitiveValue::UnitType::CSS_REMS;</span>
                  break;
              }
          break;
      }
      break;
<span class="line-new-header">--- 38,108 ---</span>
  #include &lt;wtf/text/StringBuilder.h&gt;
  
  namespace WebCore {
  
  template&lt;typename CharacterType&gt;
<span class="line-modified">! CSSUnitType cssPrimitiveValueUnitFromTrie(const CharacterType* data, unsigned length)</span>
  {
      ASSERT(data);
      ASSERT(length);
      switch (length) {
      case 1:
          switch (toASCIILower(data[0])) {
<span class="line-added">+         case &#39;q&#39;:</span>
<span class="line-added">+             return CSSUnitType::CSS_Q;</span>
          case &#39;s&#39;:
<span class="line-modified">!             return CSSUnitType::CSS_S;</span>
          }
          break;
      case 2:
          switch (toASCIILower(data[0])) {
          case &#39;c&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;h&#39;:
<span class="line-modified">!                 return CSSUnitType::CSS_CHS;</span>
              case &#39;m&#39;:
<span class="line-modified">!                 return CSSUnitType::CSS_CM;</span>
              }
              break;
          case &#39;e&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;m&#39;:
<span class="line-modified">!                 return CSSUnitType::CSS_EMS;</span>
              case &#39;x&#39;:
<span class="line-modified">!                 return CSSUnitType::CSS_EXS;</span>
              }
              break;
          case &#39;f&#39;:
              if (toASCIILower(data[1]) == &#39;r&#39;)
<span class="line-modified">!                 return CSSUnitType::CSS_FR;</span>
              break;
          case &#39;h&#39;:
              if (toASCIILower(data[1]) == &#39;z&#39;)
<span class="line-modified">!                 return CSSUnitType::CSS_HZ;</span>
              break;
          case &#39;i&#39;:
              if (toASCIILower(data[1]) == &#39;n&#39;)
<span class="line-modified">!                 return CSSUnitType::CSS_IN;</span>
              break;
          case &#39;m&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;m&#39;:
<span class="line-modified">!                 return CSSUnitType::CSS_MM;</span>
              case &#39;s&#39;:
<span class="line-modified">!                 return CSSUnitType::CSS_MS;</span>
              }
              break;
          case &#39;p&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;c&#39;:
<span class="line-modified">!                 return CSSUnitType::CSS_PC;</span>
              case &#39;t&#39;:
<span class="line-modified">!                 return CSSUnitType::CSS_PT;</span>
              case &#39;x&#39;:
<span class="line-modified">!                 return CSSUnitType::CSS_PX;</span>
              }
              break;
          case &#39;v&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;h&#39;:
<span class="line-modified">!                 return CSSUnitType::CSS_VH;</span>
              case &#39;w&#39;:
<span class="line-modified">!                 return CSSUnitType::CSS_VW;</span>
              }
              break;
          }
          break;
      case 3:
          switch (toASCIILower(data[0])) {
          case &#39;d&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;e&#39;:
                  if (toASCIILower(data[2]) == &#39;g&#39;)
<span class="line-modified">!                     return CSSUnitType::CSS_DEG;</span>
                  break;
              case &#39;p&#39;:
                  if (toASCIILower(data[2]) == &#39;i&#39;)
<span class="line-modified">!                     return CSSUnitType::CSS_DPI;</span>
                  break;
              }
          break;
          case &#39;k&#39;:
              if (toASCIILower(data[1]) == &#39;h&#39; &amp;&amp; toASCIILower(data[2]) == &#39;z&#39;)
<span class="line-modified">!                 return CSSUnitType::CSS_KHZ;</span>
              break;
          case &#39;r&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;a&#39;:
                  if (toASCIILower(data[2]) == &#39;d&#39;)
<span class="line-modified">!                     return CSSUnitType::CSS_RAD;</span>
                  break;
              case &#39;e&#39;:
                  if (toASCIILower(data[2]) == &#39;m&#39;)
<span class="line-modified">!                     return CSSUnitType::CSS_REMS;</span>
                  break;
              }
          break;
      }
      break;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 147,39 ***</span>
              switch (toASCIILower(data[1])) {
              case &#39;p&#39;:
                  switch (toASCIILower(data[2])) {
                  case &#39;c&#39;:
                      if (toASCIILower(data[3]) == &#39;m&#39;)
<span class="line-modified">!                         return CSSPrimitiveValue::UnitType::CSS_DPCM;</span>
                      break;
                  case &#39;p&#39;:
                      if (toASCIILower(data[3]) == &#39;x&#39;)
<span class="line-modified">!                         return CSSPrimitiveValue::UnitType::CSS_DPPX;</span>
                      break;
                  }
              break;
          }
          break;
          case &#39;g&#39;:
              if (toASCIILower(data[1]) == &#39;r&#39; &amp;&amp; toASCIILower(data[2]) == &#39;a&#39; &amp;&amp; toASCIILower(data[3]) == &#39;d&#39;)
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_GRAD;</span>
              break;
          case &#39;t&#39;:
              if (toASCIILower(data[1]) == &#39;u&#39; &amp;&amp; toASCIILower(data[2]) == &#39;r&#39; &amp;&amp; toASCIILower(data[3]) == &#39;n&#39;)
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_TURN;</span>
              break;
          case &#39;v&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;m&#39;:
                  switch (toASCIILower(data[2])) {
                  case &#39;a&#39;:
                      if (toASCIILower(data[3]) == &#39;x&#39;)
<span class="line-modified">!                         return CSSPrimitiveValue::UnitType::CSS_VMAX;</span>
                      break;
                  case &#39;i&#39;:
                      if (toASCIILower(data[3]) == &#39;n&#39;)
<span class="line-modified">!                         return CSSPrimitiveValue::UnitType::CSS_VMIN;</span>
                      break;
                  }
                  break;
              }
              break;
<span class="line-new-header">--- 149,39 ---</span>
              switch (toASCIILower(data[1])) {
              case &#39;p&#39;:
                  switch (toASCIILower(data[2])) {
                  case &#39;c&#39;:
                      if (toASCIILower(data[3]) == &#39;m&#39;)
<span class="line-modified">!                         return CSSUnitType::CSS_DPCM;</span>
                      break;
                  case &#39;p&#39;:
                      if (toASCIILower(data[3]) == &#39;x&#39;)
<span class="line-modified">!                         return CSSUnitType::CSS_DPPX;</span>
                      break;
                  }
              break;
          }
          break;
          case &#39;g&#39;:
              if (toASCIILower(data[1]) == &#39;r&#39; &amp;&amp; toASCIILower(data[2]) == &#39;a&#39; &amp;&amp; toASCIILower(data[3]) == &#39;d&#39;)
<span class="line-modified">!                 return CSSUnitType::CSS_GRAD;</span>
              break;
          case &#39;t&#39;:
              if (toASCIILower(data[1]) == &#39;u&#39; &amp;&amp; toASCIILower(data[2]) == &#39;r&#39; &amp;&amp; toASCIILower(data[3]) == &#39;n&#39;)
<span class="line-modified">!                 return CSSUnitType::CSS_TURN;</span>
              break;
          case &#39;v&#39;:
              switch (toASCIILower(data[1])) {
              case &#39;m&#39;:
                  switch (toASCIILower(data[2])) {
                  case &#39;a&#39;:
                      if (toASCIILower(data[3]) == &#39;x&#39;)
<span class="line-modified">!                         return CSSUnitType::CSS_VMAX;</span>
                      break;
                  case &#39;i&#39;:
                      if (toASCIILower(data[3]) == &#39;n&#39;)
<span class="line-modified">!                         return CSSUnitType::CSS_VMIN;</span>
                      break;
                  }
                  break;
              }
              break;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 187,19 ***</span>
          break;
      case 5:
          switch (toASCIILower(data[0])) {
          case &#39;_&#39;:
              if (toASCIILower(data[1]) == &#39;_&#39; &amp;&amp; toASCIILower(data[2]) == &#39;q&#39; &amp;&amp; toASCIILower(data[3]) == &#39;e&#39; &amp;&amp; toASCIILower(data[4]) == &#39;m&#39;)
<span class="line-modified">!                 return CSSPrimitiveValue::UnitType::CSS_QUIRKY_EMS;</span>
              break;
          }
          break;
      }
<span class="line-modified">!     return CSSPrimitiveValue::UnitType::CSS_UNKNOWN;</span>
  }
  
<span class="line-modified">! static CSSPrimitiveValue::UnitType stringToUnitType(StringView stringView)</span>
  {
      if (stringView.is8Bit())
          return cssPrimitiveValueUnitFromTrie(stringView.characters8(), stringView.length());
      return cssPrimitiveValueUnitFromTrie(stringView.characters16(), stringView.length());
  }
<span class="line-new-header">--- 189,19 ---</span>
          break;
      case 5:
          switch (toASCIILower(data[0])) {
          case &#39;_&#39;:
              if (toASCIILower(data[1]) == &#39;_&#39; &amp;&amp; toASCIILower(data[2]) == &#39;q&#39; &amp;&amp; toASCIILower(data[3]) == &#39;e&#39; &amp;&amp; toASCIILower(data[4]) == &#39;m&#39;)
<span class="line-modified">!                 return CSSUnitType::CSS_QUIRKY_EMS;</span>
              break;
          }
          break;
      }
<span class="line-modified">!     return CSSUnitType::CSS_UNKNOWN;</span>
  }
  
<span class="line-modified">! static CSSUnitType stringToUnitType(StringView stringView)</span>
  {
      if (stringView.is8Bit())
          return cssPrimitiveValueUnitFromTrie(stringView.characters8(), stringView.length());
      return cssPrimitiveValueUnitFromTrie(stringView.characters16(), stringView.length());
  }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 230,11 ***</span>
  CSSParserToken::CSSParserToken(CSSParserTokenType type, double numericValue, NumericValueType numericValueType, NumericSign sign)
      : m_type(type)
      , m_blockType(NotBlock)
      , m_numericValueType(numericValueType)
      , m_numericSign(sign)
<span class="line-modified">!     , m_unit(static_cast&lt;unsigned&gt;(CSSPrimitiveValue::UnitType::CSS_NUMBER))</span>
  {
      ASSERT(type == NumberToken);
      m_numericValue = numericValue;
  }
  
<span class="line-new-header">--- 232,11 ---</span>
  CSSParserToken::CSSParserToken(CSSParserTokenType type, double numericValue, NumericValueType numericValueType, NumericSign sign)
      : m_type(type)
      , m_blockType(NotBlock)
      , m_numericValueType(numericValueType)
      , m_numericSign(sign)
<span class="line-modified">!     , m_unit(static_cast&lt;unsigned&gt;(CSSUnitType::CSS_NUMBER))</span>
  {
      ASSERT(type == NumberToken);
      m_numericValue = numericValue;
  }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 265,11 ***</span>
  
  void CSSParserToken::convertToPercentage()
  {
      ASSERT(m_type == NumberToken);
      m_type = PercentageToken;
<span class="line-modified">!     m_unit = static_cast&lt;unsigned&gt;(CSSPrimitiveValue::UnitType::CSS_PERCENTAGE);</span>
  }
  
  UChar CSSParserToken::delimiter() const
  {
      ASSERT(m_type == DelimiterToken);
<span class="line-new-header">--- 267,11 ---</span>
  
  void CSSParserToken::convertToPercentage()
  {
      ASSERT(m_type == NumberToken);
      m_type = PercentageToken;
<span class="line-modified">!     m_unit = static_cast&lt;unsigned&gt;(CSSUnitType::CSS_PERCENTAGE);</span>
  }
  
  UChar CSSParserToken::delimiter() const
  {
      ASSERT(m_type == DelimiterToken);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 417,26 ***</span>
          break;
      case NumberToken:
          // These won&#39;t properly preserve the NumericValueType flag
          if (m_numericSign == PlusSign)
              builder.append(&#39;+&#39;);
<span class="line-modified">!         builder.appendFixedPrecisionNumber(numericValue());</span>
          break;
      case PercentageToken:
<span class="line-modified">!         builder.appendFixedPrecisionNumber(numericValue());</span>
<span class="line-removed">-         builder.append(&#39;%&#39;);</span>
          break;
      case DimensionToken:
          // This will incorrectly serialize e.g. 4e3e2 as 4000e2
<span class="line-modified">!         builder.appendFixedPrecisionNumber(numericValue());</span>
          serializeIdentifier(value().toString(), builder);
          break;
      case UnicodeRangeToken:
          builder.appendLiteral(&quot;U+&quot;);
<span class="line-modified">!         appendUnsignedAsHex(unicodeRangeStart(), builder);</span>
          builder.append(&#39;-&#39;);
<span class="line-modified">!         appendUnsignedAsHex(unicodeRangeEnd(), builder);</span>
          break;
      case StringToken:
          serializeString(value().toString(), builder);
          break;
  
<span class="line-new-header">--- 419,25 ---</span>
          break;
      case NumberToken:
          // These won&#39;t properly preserve the NumericValueType flag
          if (m_numericSign == PlusSign)
              builder.append(&#39;+&#39;);
<span class="line-modified">!         builder.append(numericValue());</span>
          break;
      case PercentageToken:
<span class="line-modified">!         builder.append(numericValue(), &#39;%&#39;);</span>
          break;
      case DimensionToken:
          // This will incorrectly serialize e.g. 4e3e2 as 4000e2
<span class="line-modified">!         builder.append(numericValue());</span>
          serializeIdentifier(value().toString(), builder);
          break;
      case UnicodeRangeToken:
          builder.appendLiteral(&quot;U+&quot;);
<span class="line-modified">!         builder.append(hex(unicodeRangeStart()));</span>
          builder.append(&#39;-&#39;);
<span class="line-modified">!         builder.append(hex(unicodeRangeEnd()));</span>
          break;
      case StringToken:
          serializeString(value().toString(), builder);
          break;
  
</pre>
<center><a href="CSSParserSelector.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="CSSParserToken.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>