<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/WebCore/platform/Cursor.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (C) 2010 Apple Inc. All rights reserved.
  3  *
  4  * Redistribution and use in source and binary forms, with or without
  5  * modification, are permitted provided that the following conditions
  6  * are met:
  7  * 1. Redistributions of source code must retain the above copyright
  8  *    notice, this list of conditions and the following disclaimer.
  9  * 2. Redistributions in binary form must reproduce the above copyright
 10  *    notice, this list of conditions and the following disclaimer in the
 11  *    documentation and/or other materials provided with the distribution.
 12  *
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
 14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 15  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #include &quot;config.h&quot;
 27 #include &quot;Cursor.h&quot;
 28 
 29 #include &quot;Image.h&quot;
 30 #include &quot;IntRect.h&quot;
 31 #include &quot;NotImplemented.h&quot;
 32 #include &lt;wtf/Assertions.h&gt;
 33 #include &lt;wtf/NeverDestroyed.h&gt;
 34 
 35 namespace WebCore {
 36 
 37 IntPoint determineHotSpot(Image* image, const IntPoint&amp; specifiedHotSpot)
 38 {
 39     if (image-&gt;isNull())
 40         return IntPoint();
 41 
 42     // Hot spot must be inside cursor rectangle.
 43     IntRect imageRect = IntRect(image-&gt;rect());
 44     if (imageRect.contains(specifiedHotSpot))
 45         return specifiedHotSpot;
 46 
 47     // If hot spot is not specified externally, it can be extracted from some image formats (e.g. .cur).
 48     if (auto intrinsicHotSpot = image-&gt;hotSpot()) {
 49         if (imageRect.contains(intrinsicHotSpot.value()))
 50             return intrinsicHotSpot.value();
 51     }
 52 
 53     return IntPoint();
 54 }
 55 
 56 const Cursor&amp; Cursor::fromType(Cursor::Type type)
 57 {
 58     switch (type) {
 59     case Cursor::Pointer:
 60         return pointerCursor();
 61     case Cursor::Cross:
 62         return crossCursor();
 63     case Cursor::Hand:
 64         return handCursor();
 65     case Cursor::IBeam:
 66         return iBeamCursor();
 67     case Cursor::Wait:
 68         return waitCursor();
 69     case Cursor::Help:
 70         return helpCursor();
 71     case Cursor::EastResize:
 72         return eastResizeCursor();
 73     case Cursor::NorthResize:
 74         return northResizeCursor();
 75     case Cursor::NorthEastResize:
 76         return northEastResizeCursor();
 77     case Cursor::NorthWestResize:
 78         return northWestResizeCursor();
 79     case Cursor::SouthResize:
 80         return southResizeCursor();
 81     case Cursor::SouthEastResize:
 82         return southEastResizeCursor();
 83     case Cursor::SouthWestResize:
 84         return southWestResizeCursor();
 85     case Cursor::WestResize:
 86         return westResizeCursor();
 87     case Cursor::NorthSouthResize:
 88         return northSouthResizeCursor();
 89     case Cursor::EastWestResize:
 90         return eastWestResizeCursor();
 91     case Cursor::NorthEastSouthWestResize:
 92         return northEastSouthWestResizeCursor();
 93     case Cursor::NorthWestSouthEastResize:
 94         return northWestSouthEastResizeCursor();
 95     case Cursor::ColumnResize:
 96         return columnResizeCursor();
 97     case Cursor::RowResize:
 98         return rowResizeCursor();
 99     case Cursor::MiddlePanning:
100         return middlePanningCursor();
101     case Cursor::EastPanning:
102         return eastPanningCursor();
103     case Cursor::NorthPanning:
104         return northPanningCursor();
105     case Cursor::NorthEastPanning:
106         return northEastPanningCursor();
107     case Cursor::NorthWestPanning:
108         return northWestPanningCursor();
109     case Cursor::SouthPanning:
110         return southPanningCursor();
111     case Cursor::SouthEastPanning:
112         return southEastPanningCursor();
113     case Cursor::SouthWestPanning:
114         return southWestPanningCursor();
115     case Cursor::WestPanning:
116         return westPanningCursor();
117     case Cursor::Move:
118         return moveCursor();
119     case Cursor::VerticalText:
120         return verticalTextCursor();
121     case Cursor::Cell:
122         return cellCursor();
123     case Cursor::ContextMenu:
124         return contextMenuCursor();
125     case Cursor::Alias:
126         return aliasCursor();
127     case Cursor::Progress:
128         return progressCursor();
129     case Cursor::NoDrop:
130         return noDropCursor();
131     case Cursor::Copy:
132         return copyCursor();
133     case Cursor::None:
134         return noneCursor();
135     case Cursor::NotAllowed:
136         return notAllowedCursor();
137     case Cursor::ZoomIn:
138         return zoomInCursor();
139     case Cursor::ZoomOut:
140         return zoomOutCursor();
141     case Cursor::Grab:
142         return grabCursor();
143     case Cursor::Grabbing:
144         return grabbingCursor();
145     case Cursor::Custom:
146         ASSERT_NOT_REACHED();
147     }
148     return pointerCursor();
149 }
150 
151 #if !PLATFORM(JAVA)
152 Cursor::Cursor(Image* image, const IntPoint&amp; hotSpot)
153     : m_type(Custom)
154     , m_image(image)
155     , m_hotSpot(determineHotSpot(image, hotSpot))
156 #if ENABLE(MOUSE_CURSOR_SCALE)
157     , m_imageScaleFactor(1)
158 #endif
159     , m_platformCursor(0)
160 {
161 }
162 #endif
163 
164 #if ENABLE(MOUSE_CURSOR_SCALE)
165 Cursor::Cursor(Image* image, const IntPoint&amp; hotSpot, float scale)
166     : m_type(Custom)
167     , m_image(image)
168     , m_hotSpot(determineHotSpot(image, hotSpot))
169     , m_imageScaleFactor(scale)
170     , m_platformCursor(0)
171 {
172 }
173 #endif
174 
175 Cursor::Cursor(Type type)
176     : m_type(type)
177 #if ENABLE(MOUSE_CURSOR_SCALE)
178     , m_imageScaleFactor(1)
179 #endif
180     , m_platformCursor(0)
181 {
182 }
183 
184 #if !HAVE(NSCURSOR)
185 
186 PlatformCursor Cursor::platformCursor() const
187 {
188     ensurePlatformCursor();
189     return m_platformCursor;
190 }
191 
192 #endif
193 
194 #if !PLATFORM(JAVA)
195 
196 const Cursor&amp; pointerCursor()
197 {
198     static NeverDestroyed&lt;Cursor&gt; c(Cursor::Pointer);
199     return c;
200 }
201 
202 const Cursor&amp; crossCursor()
203 {
204     static NeverDestroyed&lt;Cursor&gt; c(Cursor::Cross);
205     return c;
206 }
207 
208 const Cursor&amp; handCursor()
209 {
210     static NeverDestroyed&lt;Cursor&gt; c(Cursor::Hand);
211     return c;
212 }
213 
214 const Cursor&amp; moveCursor()
215 {
216     static NeverDestroyed&lt;Cursor&gt; c(Cursor::Move);
217     return c;
218 }
219 
220 const Cursor&amp; verticalTextCursor()
221 {
222     static NeverDestroyed&lt;Cursor&gt; c(Cursor::VerticalText);
223     return c;
224 }
225 
226 const Cursor&amp; cellCursor()
227 {
228     static NeverDestroyed&lt;Cursor&gt; c(Cursor::Cell);
229     return c;
230 }
231 
232 const Cursor&amp; contextMenuCursor()
233 {
234     static NeverDestroyed&lt;Cursor&gt; c(Cursor::ContextMenu);
235     return c;
236 }
237 
238 const Cursor&amp; aliasCursor()
239 {
240     static NeverDestroyed&lt;Cursor&gt; c(Cursor::Alias);
241     return c;
242 }
243 
244 const Cursor&amp; zoomInCursor()
245 {
246     static NeverDestroyed&lt;Cursor&gt; c(Cursor::ZoomIn);
247     return c;
248 }
249 
250 const Cursor&amp; zoomOutCursor()
251 {
252     static NeverDestroyed&lt;Cursor&gt; c(Cursor::ZoomOut);
253     return c;
254 }
255 
256 const Cursor&amp; copyCursor()
257 {
258     static NeverDestroyed&lt;Cursor&gt; c(Cursor::Copy);
259     return c;
260 }
261 
262 const Cursor&amp; noneCursor()
263 {
264     static NeverDestroyed&lt;Cursor&gt; c(Cursor::None);
265     return c;
266 }
267 
268 const Cursor&amp; progressCursor()
269 {
270     static NeverDestroyed&lt;Cursor&gt; c(Cursor::Progress);
271     return c;
272 }
273 
274 const Cursor&amp; noDropCursor()
275 {
276     static NeverDestroyed&lt;Cursor&gt; c(Cursor::NoDrop);
277     return c;
278 }
279 
280 const Cursor&amp; notAllowedCursor()
281 {
282     static NeverDestroyed&lt;Cursor&gt; c(Cursor::NotAllowed);
283     return c;
284 }
285 
286 const Cursor&amp; iBeamCursor()
287 {
288     static NeverDestroyed&lt;Cursor&gt; c(Cursor::IBeam);
289     return c;
290 }
291 
292 const Cursor&amp; waitCursor()
293 {
294     static NeverDestroyed&lt;Cursor&gt; c(Cursor::Wait);
295     return c;
296 }
297 
298 const Cursor&amp; helpCursor()
299 {
300     static NeverDestroyed&lt;Cursor&gt; c(Cursor::Help);
301     return c;
302 }
303 
304 const Cursor&amp; eastResizeCursor()
305 {
306     static NeverDestroyed&lt;Cursor&gt; c(Cursor::EastResize);
307     return c;
308 }
309 
310 const Cursor&amp; northResizeCursor()
311 {
312     static NeverDestroyed&lt;Cursor&gt; c(Cursor::NorthResize);
313     return c;
314 }
315 
316 const Cursor&amp; northEastResizeCursor()
317 {
318     static NeverDestroyed&lt;Cursor&gt; c(Cursor::NorthEastResize);
319     return c;
320 }
321 
322 const Cursor&amp; northWestResizeCursor()
323 {
324     static NeverDestroyed&lt;Cursor&gt; c(Cursor::NorthWestResize);
325     return c;
326 }
327 
328 const Cursor&amp; southResizeCursor()
329 {
330     static NeverDestroyed&lt;Cursor&gt; c(Cursor::SouthResize);
331     return c;
332 }
333 
334 const Cursor&amp; southEastResizeCursor()
335 {
336     static NeverDestroyed&lt;Cursor&gt; c(Cursor::SouthEastResize);
337     return c;
338 }
339 
340 const Cursor&amp; southWestResizeCursor()
341 {
342     static NeverDestroyed&lt;Cursor&gt; c(Cursor::SouthWestResize);
343     return c;
344 }
345 
346 const Cursor&amp; westResizeCursor()
347 {
348     static NeverDestroyed&lt;Cursor&gt; c(Cursor::WestResize);
349     return c;
350 }
351 
352 const Cursor&amp; northSouthResizeCursor()
353 {
354     static NeverDestroyed&lt;Cursor&gt; c(Cursor::NorthSouthResize);
355     return c;
356 }
357 
358 const Cursor&amp; eastWestResizeCursor()
359 {
360     static NeverDestroyed&lt;Cursor&gt; c(Cursor::EastWestResize);
361     return c;
362 }
363 
364 const Cursor&amp; northEastSouthWestResizeCursor()
365 {
366     static NeverDestroyed&lt;Cursor&gt; c(Cursor::NorthEastSouthWestResize);
367     return c;
368 }
369 
370 const Cursor&amp; northWestSouthEastResizeCursor()
371 {
372     static NeverDestroyed&lt;Cursor&gt; c(Cursor::NorthWestSouthEastResize);
373     return c;
374 }
375 
376 const Cursor&amp; columnResizeCursor()
377 {
378     static NeverDestroyed&lt;Cursor&gt; c(Cursor::ColumnResize);
379     return c;
380 }
381 
382 const Cursor&amp; rowResizeCursor()
383 {
384     static NeverDestroyed&lt;Cursor&gt; c(Cursor::RowResize);
385     return c;
386 }
387 
388 const Cursor&amp; middlePanningCursor()
389 {
390     static NeverDestroyed&lt;Cursor&gt; c(Cursor::MiddlePanning);
391     return c;
392 }
393 
394 const Cursor&amp; eastPanningCursor()
395 {
396     static NeverDestroyed&lt;Cursor&gt; c(Cursor::EastPanning);
397     return c;
398 }
399 
400 const Cursor&amp; northPanningCursor()
401 {
402     static NeverDestroyed&lt;Cursor&gt; c(Cursor::NorthPanning);
403     return c;
404 }
405 
406 const Cursor&amp; northEastPanningCursor()
407 {
408     static NeverDestroyed&lt;Cursor&gt; c(Cursor::NorthEastPanning);
409     return c;
410 }
411 
412 const Cursor&amp; northWestPanningCursor()
413 {
414     static NeverDestroyed&lt;Cursor&gt; c(Cursor::NorthWestPanning);
415     return c;
416 }
417 
418 const Cursor&amp; southPanningCursor()
419 {
420     static NeverDestroyed&lt;Cursor&gt; c(Cursor::SouthPanning);
421     return c;
422 }
423 
424 const Cursor&amp; southEastPanningCursor()
425 {
426     static NeverDestroyed&lt;Cursor&gt; c(Cursor::SouthEastPanning);
427     return c;
428 }
429 
430 const Cursor&amp; southWestPanningCursor()
431 {
432     static NeverDestroyed&lt;Cursor&gt; c(Cursor::SouthWestPanning);
433     return c;
434 }
435 
436 const Cursor&amp; westPanningCursor()
437 {
438     static NeverDestroyed&lt;Cursor&gt; c(Cursor::WestPanning);
439     return c;
440 }
441 
442 const Cursor&amp; grabCursor()
443 {
444     static NeverDestroyed&lt;Cursor&gt; c(Cursor::Grab);
445     return c;
446 }
447 
448 const Cursor&amp; grabbingCursor()
449 {
450     static NeverDestroyed&lt;Cursor&gt; c(Cursor::Grabbing);
451     return c;
452 }
453 
454 #if !HAVE(NSCURSOR) &amp;&amp; !PLATFORM(GTK) &amp;&amp; !PLATFORM(WIN)
455 void Cursor::ensurePlatformCursor() const
456 {
457     notImplemented();
458 }
459 #endif
460 
461 #endif
462 
463 #if !HAVE(NSCURSOR)
464 void Cursor::setAsPlatformCursor() const
465 {
466     notImplemented();
467 }
468 #endif
469 
470 } // namespace WebCore
    </pre>
  </body>
</html>