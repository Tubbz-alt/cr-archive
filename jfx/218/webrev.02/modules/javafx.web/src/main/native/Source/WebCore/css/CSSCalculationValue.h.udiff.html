<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/css/CSSCalculationValue.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="CSSCalculationValue.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CSSCanvasValue.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/css/CSSCalculationValue.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -32,86 +32,95 @@</span>
  
  #include &quot;CSSPrimitiveValue.h&quot;
  #include &quot;CSSPropertyNames.h&quot;
  #include &quot;CalculationValue.h&quot;
  
<span class="udiff-line-added">+ namespace WTF {</span>
<span class="udiff-line-added">+ class TextStream;</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
  namespace WebCore {
  
  class CSSParserTokenRange;
  class CSSToLengthConversionData;
  class RenderStyle;
  
<span class="udiff-line-added">+ // FIXME: Unify with CSSPrimitiveValue::UnitCategory.</span>
  enum class CalculationCategory : uint8_t {
      Number = 0,
      Length,
      Percent,
      PercentNumber,
      PercentLength,
      Angle,
      Time,
      Frequency,
<span class="udiff-line-added">+     // TODO:</span>
<span class="udiff-line-added">+     // Flex,</span>
<span class="udiff-line-added">+     // Resolution</span>
      Other
  };
  
  class CSSCalcExpressionNode : public RefCounted&lt;CSSCalcExpressionNode&gt; {
  public:
      enum Type {
          CssCalcPrimitiveValue = 1,
<span class="udiff-line-modified-removed">-         CssCalcOperation</span>
<span class="udiff-line-modified-added">+         CssCalcOperation,</span>
<span class="udiff-line-added">+         CssCalcNegate,</span>
<span class="udiff-line-added">+         CssCalcInvert,</span>
      };
  
      virtual ~CSSCalcExpressionNode() = default;
      virtual bool isZero() const = 0;
      virtual std::unique_ptr&lt;CalcExpressionNode&gt; createCalcExpression(const CSSToLengthConversionData&amp;) const = 0;
<span class="udiff-line-modified-removed">-     virtual double doubleValue() const = 0;</span>
<span class="udiff-line-modified-added">+     virtual double doubleValue(CSSUnitType) const = 0;</span>
      virtual double computeLengthPx(const CSSToLengthConversionData&amp;) const = 0;
<span class="udiff-line-modified-removed">-     virtual String customCSSText() const = 0;</span>
<span class="udiff-line-removed">-     virtual bool equals(const CSSCalcExpressionNode&amp; other) const { return m_category == other.m_category &amp;&amp; m_isInteger == other.m_isInteger; }</span>
<span class="udiff-line-modified-added">+     virtual bool equals(const CSSCalcExpressionNode&amp; other) const { return m_category == other.m_category; }</span>
      virtual Type type() const = 0;
<span class="udiff-line-modified-removed">-     virtual CSSPrimitiveValue::UnitType primitiveType() const = 0;</span>
<span class="udiff-line-modified-added">+     virtual CSSUnitType primitiveType() const = 0;</span>
  
      virtual void collectDirectComputationalDependencies(HashSet&lt;CSSPropertyID&gt;&amp;) const = 0;
      virtual void collectDirectRootComputationalDependencies(HashSet&lt;CSSPropertyID&gt;&amp;) const = 0;
  
      CalculationCategory category() const { return m_category; }
<span class="udiff-line-modified-removed">-     bool isInteger() const { return m_isInteger; }</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-added">+     virtual void dump(TextStream&amp;) const = 0;</span>
  
  protected:
<span class="udiff-line-modified-removed">-     CSSCalcExpressionNode(CalculationCategory category, bool isInteger)</span>
<span class="udiff-line-modified-added">+     CSSCalcExpressionNode(CalculationCategory category)</span>
          : m_category(category)
<span class="udiff-line-removed">-         , m_isInteger(isInteger)</span>
      {
      }
  
  private:
      CalculationCategory m_category;
<span class="udiff-line-removed">-     bool m_isInteger;</span>
  };
  
  class CSSCalcValue final : public CSSValue {
  public:
      static RefPtr&lt;CSSCalcValue&gt; create(CSSValueID function, const CSSParserTokenRange&amp;, CalculationCategory destinationCategory, ValueRange);
  
      static RefPtr&lt;CSSCalcValue&gt; create(const CalculationValue&amp;, const RenderStyle&amp;);
  
      CalculationCategory category() const { return m_expression-&gt;category(); }
<span class="udiff-line-removed">-     bool isInt() const { return m_expression-&gt;isInteger(); }</span>
      double doubleValue() const;
<span class="udiff-line-removed">-     bool isPositive() const { return m_expression-&gt;doubleValue() &gt; 0; }</span>
<span class="udiff-line-removed">-     bool isNegative() const { return m_expression-&gt;doubleValue() &lt; 0; }</span>
      double computeLengthPx(const CSSToLengthConversionData&amp;) const;
<span class="udiff-line-modified-removed">-     unsigned short primitiveType() const { return m_expression-&gt;primitiveType(); }</span>
<span class="udiff-line-modified-added">+     CSSUnitType primitiveType() const { return m_expression-&gt;primitiveType(); }</span>
  
      Ref&lt;CalculationValue&gt; createCalculationValue(const CSSToLengthConversionData&amp;) const;
      void setPermittedValueRange(ValueRange);
  
      void collectDirectComputationalDependencies(HashSet&lt;CSSPropertyID&gt;&amp;) const;
      void collectDirectRootComputationalDependencies(HashSet&lt;CSSPropertyID&gt;&amp;) const;
  
      String customCSSText() const;
      bool equals(const CSSCalcValue&amp;) const;
  
<span class="udiff-line-added">+     static bool isCalcFunction(CSSValueID);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     void dump(TextStream&amp;) const;</span>
<span class="udiff-line-added">+ </span>
  private:
      CSSCalcValue(Ref&lt;CSSCalcExpressionNode&gt;&amp;&amp;, bool shouldClampToNonNegative);
  
      double clampToPermittedRange(double) const;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -145,8 +154,16 @@</span>
  inline void CSSCalcValue::collectDirectRootComputationalDependencies(HashSet&lt;CSSPropertyID&gt;&amp; values) const
  {
      m_expression-&gt;collectDirectRootComputationalDependencies(values);
  }
  
<span class="udiff-line-added">+ WTF::TextStream&amp; operator&lt;&lt;(WTF::TextStream&amp;, CalculationCategory);</span>
<span class="udiff-line-added">+ WTF::TextStream&amp; operator&lt;&lt;(WTF::TextStream&amp;, const CSSCalcValue&amp;);</span>
<span class="udiff-line-added">+ </span>
  } // namespace WebCore
  
  SPECIALIZE_TYPE_TRAITS_CSS_VALUE(CSSCalcValue, isCalcValue())
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ #define SPECIALIZE_TYPE_TRAITS_CSSCALCEXPRESSION_NODE(ToValueTypeName, predicate) \</span>
<span class="udiff-line-added">+ SPECIALIZE_TYPE_TRAITS_BEGIN(WebCore::ToValueTypeName) \</span>
<span class="udiff-line-added">+     static bool isType(const WebCore::CSSCalcExpressionNode&amp; node) { return node.predicate; } \</span>
<span class="udiff-line-added">+ SPECIALIZE_TYPE_TRAITS_END()</span>
</pre>
<center><a href="CSSCalculationValue.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CSSCanvasValue.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>