<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/dom/LoadableClassicScript.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="KeyboardEvent.idl.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MessageChannel.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/dom/LoadableClassicScript.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 93                 MessageLevel::Error,
 94                 makeString(&quot;Refused to execute &quot;, m_cachedScript-&gt;url().stringCenterEllipsizedToLength(), &quot; as script because \&quot;X-Content-Type: nosniff\&quot; was given and its Content-Type is not a script MIME type.&quot;)
 95             }
 96         };
 97     }
 98 
 99     if (!m_error &amp;&amp; shouldBlockResponseDueToMIMEType(m_cachedScript-&gt;response(), m_cachedScript-&gt;options().destination)) {
100         m_error = Error {
101             ErrorType::MIMEType,
102             ConsoleMessage {
103                 MessageSource::Security,
104                 MessageLevel::Error,
105                 makeString(&quot;Refused to execute &quot;, m_cachedScript-&gt;url().stringCenterEllipsizedToLength(), &quot; as script because &quot;, m_cachedScript-&gt;response().mimeType(), &quot; is not a script MIME type.&quot;)
106             }
107         };
108     }
109 
110     if (!m_error &amp;&amp; !resource.errorOccurred() &amp;&amp; !matchIntegrityMetadata(resource, m_integrity)) {
111         m_error = Error {
112             ErrorType::FailedIntegrityCheck,
<span class="line-modified">113             ConsoleMessage { MessageSource::Security, MessageLevel::Error, makeString(&quot;Cannot load script &quot;, m_cachedScript-&gt;url().stringCenterEllipsizedToLength(), &quot;. Failed integrity metadata check.&quot;) }</span>
114         };
115     }
116 
117     notifyClientFinished();
118 }
119 
120 void LoadableClassicScript::execute(ScriptElement&amp; scriptElement)
121 {
122     ASSERT(!error());
123     scriptElement.executeClassicScript(ScriptSourceCode(m_cachedScript.get(), JSC::SourceProviderSourceType::Program, *this));
124 }
125 
126 bool LoadableClassicScript::load(Document&amp; document, const URL&amp; sourceURL)
127 {
128     ASSERT(!m_cachedScript);
129     m_cachedScript = requestScriptWithCache(document, sourceURL, crossOriginMode(), String { m_integrity });
130     if (!m_cachedScript)
131         return false;
132     m_cachedScript-&gt;addClient(*this);
133     return true;
</pre>
</td>
<td>
<hr />
<pre>
 93                 MessageLevel::Error,
 94                 makeString(&quot;Refused to execute &quot;, m_cachedScript-&gt;url().stringCenterEllipsizedToLength(), &quot; as script because \&quot;X-Content-Type: nosniff\&quot; was given and its Content-Type is not a script MIME type.&quot;)
 95             }
 96         };
 97     }
 98 
 99     if (!m_error &amp;&amp; shouldBlockResponseDueToMIMEType(m_cachedScript-&gt;response(), m_cachedScript-&gt;options().destination)) {
100         m_error = Error {
101             ErrorType::MIMEType,
102             ConsoleMessage {
103                 MessageSource::Security,
104                 MessageLevel::Error,
105                 makeString(&quot;Refused to execute &quot;, m_cachedScript-&gt;url().stringCenterEllipsizedToLength(), &quot; as script because &quot;, m_cachedScript-&gt;response().mimeType(), &quot; is not a script MIME type.&quot;)
106             }
107         };
108     }
109 
110     if (!m_error &amp;&amp; !resource.errorOccurred() &amp;&amp; !matchIntegrityMetadata(resource, m_integrity)) {
111         m_error = Error {
112             ErrorType::FailedIntegrityCheck,
<span class="line-modified">113             ConsoleMessage { MessageSource::Security, MessageLevel::Error, makeString(&quot;Cannot load script &quot;, integrityMismatchDescription(resource, m_integrity)) }</span>
114         };
115     }
116 
117     notifyClientFinished();
118 }
119 
120 void LoadableClassicScript::execute(ScriptElement&amp; scriptElement)
121 {
122     ASSERT(!error());
123     scriptElement.executeClassicScript(ScriptSourceCode(m_cachedScript.get(), JSC::SourceProviderSourceType::Program, *this));
124 }
125 
126 bool LoadableClassicScript::load(Document&amp; document, const URL&amp; sourceURL)
127 {
128     ASSERT(!m_cachedScript);
129     m_cachedScript = requestScriptWithCache(document, sourceURL, crossOriginMode(), String { m_integrity });
130     if (!m_cachedScript)
131         return false;
132     m_cachedScript-&gt;addClient(*this);
133     return true;
</pre>
</td>
</tr>
</table>
<center><a href="KeyboardEvent.idl.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MessageChannel.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>