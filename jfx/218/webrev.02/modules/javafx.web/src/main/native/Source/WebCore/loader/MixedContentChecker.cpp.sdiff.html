<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/loader/MixedContentChecker.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MediaResourceLoader.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MixedContentChecker.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/loader/MixedContentChecker.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
103 
104     return allowed;
105 }
106 
107 void MixedContentChecker::checkFormForMixedContent(SecurityOrigin&amp; securityOrigin, const URL&amp; url) const
108 {
109     // Unconditionally allow javascript: URLs as form actions as some pages do this and it does not introduce
110     // a mixed content issue.
111     if (WTF::protocolIsJavaScript(url))
112         return;
113 
114     if (!isMixedContent(securityOrigin, url))
115         return;
116 
117     String message = makeString(&quot;The page at &quot;, m_frame.document()-&gt;url().stringCenterEllipsizedToLength(), &quot; contains a form which targets an insecure URL &quot;, url.stringCenterEllipsizedToLength(), &quot;.\n&quot;);
118     m_frame.document()-&gt;addConsoleMessage(MessageSource::Security, MessageLevel::Warning, message);
119 
120     client().didDisplayInsecureContent();
121 }
122 






















123 void MixedContentChecker::logWarning(bool allowed, const String&amp; action, const URL&amp; target) const
124 {
125     const char* errorString = allowed ? &quot; was allowed to &quot; : &quot; was not allowed to &quot;;
126     String message = makeString((allowed ? String() : &quot;[blocked] &quot;), &quot;The page at &quot;, m_frame.document()-&gt;url().stringCenterEllipsizedToLength(), errorString, action, &quot; insecure content from &quot;, target.stringCenterEllipsizedToLength(), &quot;.\n&quot;);
127     m_frame.document()-&gt;addConsoleMessage(MessageSource::Security, MessageLevel::Warning, message);
128 }
129 
130 } // namespace WebCore
</pre>
</td>
<td>
<hr />
<pre>
103 
104     return allowed;
105 }
106 
107 void MixedContentChecker::checkFormForMixedContent(SecurityOrigin&amp; securityOrigin, const URL&amp; url) const
108 {
109     // Unconditionally allow javascript: URLs as form actions as some pages do this and it does not introduce
110     // a mixed content issue.
111     if (WTF::protocolIsJavaScript(url))
112         return;
113 
114     if (!isMixedContent(securityOrigin, url))
115         return;
116 
117     String message = makeString(&quot;The page at &quot;, m_frame.document()-&gt;url().stringCenterEllipsizedToLength(), &quot; contains a form which targets an insecure URL &quot;, url.stringCenterEllipsizedToLength(), &quot;.\n&quot;);
118     m_frame.document()-&gt;addConsoleMessage(MessageSource::Security, MessageLevel::Warning, message);
119 
120     client().didDisplayInsecureContent();
121 }
122 
<span class="line-added">123 Optional&lt;String&gt; MixedContentChecker::checkForMixedContentInFrameTree(const URL&amp; url)</span>
<span class="line-added">124 {</span>
<span class="line-added">125     auto* document = m_frame.document();</span>
<span class="line-added">126 </span>
<span class="line-added">127     while (document) {</span>
<span class="line-added">128         RELEASE_ASSERT_WITH_MESSAGE(document-&gt;frame(), &quot;An unparented document tried to connect to a websocket with url: %s&quot;, url.string().utf8().data());</span>
<span class="line-added">129 </span>
<span class="line-added">130         auto* frame = document-&gt;frame();</span>
<span class="line-added">131         if (isMixedContent(document-&gt;securityOrigin(), url))</span>
<span class="line-added">132             return makeString(&quot;The page at &quot;, document-&gt;url().stringCenterEllipsizedToLength(), &quot; was blocked from connecting insecurely to &quot;, url.stringCenterEllipsizedToLength(), &quot; either because the protocol is insecure or the page is embedded from an insecure page.&quot;);</span>
<span class="line-added">133 </span>
<span class="line-added">134         if (frame-&gt;isMainFrame())</span>
<span class="line-added">135             break;</span>
<span class="line-added">136 </span>
<span class="line-added">137         frame = frame-&gt;tree().parent();</span>
<span class="line-added">138         RELEASE_ASSERT_WITH_MESSAGE(frame, &quot;Should never have a parentless non main frame&quot;);</span>
<span class="line-added">139         document = frame-&gt;document();</span>
<span class="line-added">140     }</span>
<span class="line-added">141 </span>
<span class="line-added">142     return WTF::nullopt;</span>
<span class="line-added">143 }</span>
<span class="line-added">144 </span>
145 void MixedContentChecker::logWarning(bool allowed, const String&amp; action, const URL&amp; target) const
146 {
147     const char* errorString = allowed ? &quot; was allowed to &quot; : &quot; was not allowed to &quot;;
148     String message = makeString((allowed ? String() : &quot;[blocked] &quot;), &quot;The page at &quot;, m_frame.document()-&gt;url().stringCenterEllipsizedToLength(), errorString, action, &quot; insecure content from &quot;, target.stringCenterEllipsizedToLength(), &quot;.\n&quot;);
149     m_frame.document()-&gt;addConsoleMessage(MessageSource::Security, MessageLevel::Warning, message);
150 }
151 
152 } // namespace WebCore
</pre>
</td>
</tr>
</table>
<center><a href="MediaResourceLoader.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MixedContentChecker.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>