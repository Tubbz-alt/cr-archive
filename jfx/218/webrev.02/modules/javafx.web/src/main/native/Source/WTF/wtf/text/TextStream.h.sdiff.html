<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WTF/wtf/text/TextStream.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="TextStream.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="UniquedStringImpl.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WTF/wtf/text/TextStream.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  9  * 2. Redistributions in binary form must reproduce the above copyright
 10  *    notice, this list of conditions and the following disclaimer in the
 11  *    documentation and/or other materials provided with the distribution.
 12  *
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
 14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 15  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #include &lt;wtf/Forward.h&gt;


 29 #include &lt;wtf/text/StringBuilder.h&gt;
 30 
 31 namespace WTF {
 32 
 33 class TextStream {
 34     WTF_MAKE_FAST_ALLOCATED;
 35 public:
 36     struct FormatNumberRespectingIntegers {
 37         WTF_MAKE_STRUCT_FAST_ALLOCATED;
 38         FormatNumberRespectingIntegers(double number)
 39             : value(number) { }
 40 
 41         double value;
 42     };
 43 
 44     enum Formatting {
 45         SVGStyleRect                = 1 &lt;&lt; 0, // &quot;at (0,0) size 10x10&quot;
 46         NumberRespectingIntegers    = 1 &lt;&lt; 1,
 47         LayoutUnitsAsIntegers       = 1 &lt;&lt; 2,
 48     };
 49 
 50     using FormattingFlags = unsigned;
 51 
 52     enum class LineMode { SingleLine, MultipleLine };
 53     TextStream(LineMode lineMode = LineMode::MultipleLine, FormattingFlags formattingFlags = 0)
 54         : m_formattingFlags(formattingFlags)
 55         , m_multiLineMode(lineMode == LineMode::MultipleLine)
 56     {
 57     }
 58 
 59     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(bool);

 60     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(int);
 61     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(unsigned);
 62     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(long);
 63     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(unsigned long);
 64     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(long long);
 65 
 66     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(unsigned long long);
 67     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(float);
 68     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(double);
 69     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(const char*);
 70     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(const void*);
 71     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(const String&amp;);
 72     // Deprecated. Use the NumberRespectingIntegers FormattingFlag instead.
 73     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(const FormatNumberRespectingIntegers&amp;);
 74 
 75 #ifdef __OBJC__
 76     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(id&lt;NSObject&gt;);
 77 #endif
 78 
 79     FormattingFlags formattingFlags() const { return m_formattingFlags; }
</pre>
<hr />
<pre>
156             m_stream.endGroup();
157         }
158 
159     private:
160         TextStream&amp; m_stream;
161     };
162 
163 private:
164     StringBuilder m_text;
165     FormattingFlags m_formattingFlags { 0 };
166     int m_indent { 0 };
167     bool m_multiLineMode { true };
168 };
169 
170 inline TextStream&amp; indent(TextStream&amp; ts)
171 {
172     ts.writeIndent();
173     return ts;
174 }
175 


















176 template&lt;typename Item&gt;
177 TextStream&amp; operator&lt;&lt;(TextStream&amp; ts, const Vector&lt;Item&gt;&amp; vector)
178 {
179     ts &lt;&lt; &quot;[&quot;;
180 
181     unsigned size = vector.size();
182     for (unsigned i = 0; i &lt; size; ++i) {
183         ts &lt;&lt; vector[i];
184         if (i &lt; size - 1)
185             ts &lt;&lt; &quot;, &quot;;
186     }
187 
188     return ts &lt;&lt; &quot;]&quot;;
189 }
190 
































191 template&lt;typename Option&gt;
192 TextStream&amp; operator&lt;&lt;(TextStream&amp; ts, const OptionSet&lt;Option&gt;&amp; options)
193 {
194     ts &lt;&lt; &quot;[&quot;;
195     bool needComma = false;
196     for (auto option : options) {
197         if (needComma)
198             ts &lt;&lt; &quot;, &quot;;
199         needComma = true;
200         ts &lt;&lt; option;
201     }
202     return ts &lt;&lt; &quot;]&quot;;
203 }
204 
205 // Deprecated. Use TextStream::writeIndent() instead.
206 WTF_EXPORT_PRIVATE void writeIndent(TextStream&amp;, int indent);
207 
208 } // namespace WTF
209 
210 using WTF::TextStream;
</pre>
</td>
<td>
<hr />
<pre>
  9  * 2. Redistributions in binary form must reproduce the above copyright
 10  *    notice, this list of conditions and the following disclaimer in the
 11  *    documentation and/or other materials provided with the distribution.
 12  *
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
 14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 15  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #include &lt;wtf/Forward.h&gt;
<span class="line-added"> 29 #include &lt;wtf/Markable.h&gt;</span>
<span class="line-added"> 30 #include &lt;wtf/Optional.h&gt;</span>
 31 #include &lt;wtf/text/StringBuilder.h&gt;
 32 
 33 namespace WTF {
 34 
 35 class TextStream {
 36     WTF_MAKE_FAST_ALLOCATED;
 37 public:
 38     struct FormatNumberRespectingIntegers {
 39         WTF_MAKE_STRUCT_FAST_ALLOCATED;
 40         FormatNumberRespectingIntegers(double number)
 41             : value(number) { }
 42 
 43         double value;
 44     };
 45 
 46     enum Formatting {
 47         SVGStyleRect                = 1 &lt;&lt; 0, // &quot;at (0,0) size 10x10&quot;
 48         NumberRespectingIntegers    = 1 &lt;&lt; 1,
 49         LayoutUnitsAsIntegers       = 1 &lt;&lt; 2,
 50     };
 51 
 52     using FormattingFlags = unsigned;
 53 
 54     enum class LineMode { SingleLine, MultipleLine };
 55     TextStream(LineMode lineMode = LineMode::MultipleLine, FormattingFlags formattingFlags = 0)
 56         : m_formattingFlags(formattingFlags)
 57         , m_multiLineMode(lineMode == LineMode::MultipleLine)
 58     {
 59     }
 60 
 61     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(bool);
<span class="line-added"> 62     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(char);</span>
 63     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(int);
 64     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(unsigned);
 65     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(long);
 66     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(unsigned long);
 67     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(long long);
 68 
 69     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(unsigned long long);
 70     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(float);
 71     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(double);
 72     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(const char*);
 73     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(const void*);
 74     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(const String&amp;);
 75     // Deprecated. Use the NumberRespectingIntegers FormattingFlag instead.
 76     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(const FormatNumberRespectingIntegers&amp;);
 77 
 78 #ifdef __OBJC__
 79     WTF_EXPORT_PRIVATE TextStream&amp; operator&lt;&lt;(id&lt;NSObject&gt;);
 80 #endif
 81 
 82     FormattingFlags formattingFlags() const { return m_formattingFlags; }
</pre>
<hr />
<pre>
159             m_stream.endGroup();
160         }
161 
162     private:
163         TextStream&amp; m_stream;
164     };
165 
166 private:
167     StringBuilder m_text;
168     FormattingFlags m_formattingFlags { 0 };
169     int m_indent { 0 };
170     bool m_multiLineMode { true };
171 };
172 
173 inline TextStream&amp; indent(TextStream&amp; ts)
174 {
175     ts.writeIndent();
176     return ts;
177 }
178 
<span class="line-added">179 template&lt;typename Item&gt;</span>
<span class="line-added">180 TextStream&amp; operator&lt;&lt;(TextStream&amp; ts, const Optional&lt;Item&gt;&amp; item)</span>
<span class="line-added">181 {</span>
<span class="line-added">182     if (item)</span>
<span class="line-added">183         return ts &lt;&lt; item.value();</span>
<span class="line-added">184 </span>
<span class="line-added">185     return ts &lt;&lt; &quot;nullopt&quot;;</span>
<span class="line-added">186 }</span>
<span class="line-added">187 </span>
<span class="line-added">188 template&lt;typename T, typename Traits&gt;</span>
<span class="line-added">189 TextStream&amp; operator&lt;&lt;(TextStream&amp; ts, const Markable&lt;T, Traits&gt;&amp; item)</span>
<span class="line-added">190 {</span>
<span class="line-added">191     if (item)</span>
<span class="line-added">192         return ts &lt;&lt; item.value();</span>
<span class="line-added">193 </span>
<span class="line-added">194     return ts &lt;&lt; &quot;unset&quot;;</span>
<span class="line-added">195 }</span>
<span class="line-added">196 </span>
197 template&lt;typename Item&gt;
198 TextStream&amp; operator&lt;&lt;(TextStream&amp; ts, const Vector&lt;Item&gt;&amp; vector)
199 {
200     ts &lt;&lt; &quot;[&quot;;
201 
202     unsigned size = vector.size();
203     for (unsigned i = 0; i &lt; size; ++i) {
204         ts &lt;&lt; vector[i];
205         if (i &lt; size - 1)
206             ts &lt;&lt; &quot;, &quot;;
207     }
208 
209     return ts &lt;&lt; &quot;]&quot;;
210 }
211 
<span class="line-added">212 template&lt;typename KeyArg, typename MappedArg, typename HashArg, typename KeyTraitsArg, typename MappedTraitsArg&gt;</span>
<span class="line-added">213 TextStream&amp; operator&lt;&lt;(TextStream&amp; ts, const HashMap&lt;KeyArg, MappedArg, HashArg, KeyTraitsArg, MappedTraitsArg&gt;&amp; map)</span>
<span class="line-added">214 {</span>
<span class="line-added">215     ts &lt;&lt; &quot;{&quot;;</span>
<span class="line-added">216 </span>
<span class="line-added">217     bool first = true;</span>
<span class="line-added">218     for (const auto&amp; keyValuePair : map) {</span>
<span class="line-added">219         ts &lt;&lt; keyValuePair.key &lt;&lt; &quot;: &quot; &lt;&lt; keyValuePair.value;</span>
<span class="line-added">220         if (!first)</span>
<span class="line-added">221             ts &lt;&lt; &quot;, &quot;;</span>
<span class="line-added">222         first = false;</span>
<span class="line-added">223     }</span>
<span class="line-added">224 </span>
<span class="line-added">225     return ts &lt;&lt; &quot;}&quot;;</span>
<span class="line-added">226 }</span>
<span class="line-added">227 </span>
<span class="line-added">228 template&lt;typename ValueArg, typename HashArg, typename TraitsArg&gt;</span>
<span class="line-added">229 TextStream&amp; operator&lt;&lt;(TextStream&amp; ts, const HashSet&lt;ValueArg, HashArg, TraitsArg&gt;&amp; set)</span>
<span class="line-added">230 {</span>
<span class="line-added">231     ts &lt;&lt; &quot;[&quot;;</span>
<span class="line-added">232 </span>
<span class="line-added">233     bool first = true;</span>
<span class="line-added">234     for (const auto&amp; item : set) {</span>
<span class="line-added">235         ts &lt;&lt; item;</span>
<span class="line-added">236         if (!first)</span>
<span class="line-added">237             ts &lt;&lt; &quot;, &quot;;</span>
<span class="line-added">238         first = false;</span>
<span class="line-added">239     }</span>
<span class="line-added">240 </span>
<span class="line-added">241     return ts &lt;&lt; &quot;]&quot;;</span>
<span class="line-added">242 }</span>
<span class="line-added">243 </span>
244 template&lt;typename Option&gt;
245 TextStream&amp; operator&lt;&lt;(TextStream&amp; ts, const OptionSet&lt;Option&gt;&amp; options)
246 {
247     ts &lt;&lt; &quot;[&quot;;
248     bool needComma = false;
249     for (auto option : options) {
250         if (needComma)
251             ts &lt;&lt; &quot;, &quot;;
252         needComma = true;
253         ts &lt;&lt; option;
254     }
255     return ts &lt;&lt; &quot;]&quot;;
256 }
257 
258 // Deprecated. Use TextStream::writeIndent() instead.
259 WTF_EXPORT_PRIVATE void writeIndent(TextStream&amp;, int indent);
260 
261 } // namespace WTF
262 
263 using WTF::TextStream;
</pre>
</td>
</tr>
</table>
<center><a href="TextStream.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="UniquedStringImpl.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>