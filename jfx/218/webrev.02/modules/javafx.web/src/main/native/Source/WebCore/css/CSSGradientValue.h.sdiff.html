<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/css/CSSGradientValue.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="CSSGradientValue.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CSSImageGeneratorValue.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/css/CSSGradientValue.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #include &quot;CSSImageGeneratorValue.h&quot;
 29 #include &quot;CSSPrimitiveValue.h&quot;
 30 #include &quot;Gradient.h&quot;
 31 #include &lt;wtf/Vector.h&gt;
 32 
 33 namespace WebCore {
 34 
 35 class FloatPoint;
 36 class StyleResolver;
 37 




 38 enum CSSGradientType {
 39     CSSDeprecatedLinearGradient,
 40     CSSDeprecatedRadialGradient,
 41     CSSPrefixedLinearGradient,
 42     CSSPrefixedRadialGradient,
 43     CSSLinearGradient,
 44     CSSRadialGradient,
 45     CSSConicGradient
 46 };
 47 enum CSSGradientRepeat { NonRepeating, Repeating };
 48 
 49 struct CSSGradientColorStop {
 50     RefPtr&lt;CSSPrimitiveValue&gt; m_position; // percentage or length
 51     RefPtr&lt;CSSPrimitiveValue&gt; m_color;
 52     Color m_resolvedColor;
 53     bool m_colorIsDerivedFromElement = false;
 54     bool isMidpoint = false;
 55     bool operator==(const CSSGradientColorStop&amp; other) const
 56     {
 57         return compareCSSValuePtr(m_color, other.m_color)
</pre>
<hr />
<pre>
 69     void setSecondY(RefPtr&lt;CSSPrimitiveValue&gt;&amp;&amp; val) { m_secondY = WTFMove(val); }
 70 
 71     void addStop(const CSSGradientColorStop&amp; stop) { m_stops.append(stop); }
 72     void doneAddingStops() { m_stops.shrinkToFit(); }
 73 
 74     unsigned stopCount() const { return m_stops.size(); }
 75 
 76     void sortStopsIfNeeded();
 77 
 78     bool isRepeating() const { return m_repeating; }
 79 
 80     CSSGradientType gradientType() const { return m_gradientType; }
 81 
 82     bool isFixedSize() const { return false; }
 83     FloatSize fixedSize(const RenderElement&amp;) const { return FloatSize(); }
 84 
 85     bool isPending() const { return false; }
 86     bool knownToBeOpaque(const RenderElement&amp;) const;
 87 
 88     void loadSubimages(CachedResourceLoader&amp;, const ResourceLoaderOptions&amp;) { }
<span class="line-modified"> 89     Ref&lt;CSSGradientValue&gt; gradientWithStylesResolved(const StyleResolver&amp;);</span>

 90 
 91 protected:
 92     CSSGradientValue(ClassType classType, CSSGradientRepeat repeat, CSSGradientType gradientType)
 93         : CSSImageGeneratorValue(classType)
<span class="line-removed"> 94         , m_stopsSorted(false)</span>
 95         , m_gradientType(gradientType)
 96         , m_repeating(repeat == Repeating)
 97     {
 98     }
 99 
100     CSSGradientValue(const CSSGradientValue&amp; other, ClassType classType, CSSGradientType gradientType)
101         : CSSImageGeneratorValue(classType)
102         , m_firstX(other.m_firstX)
103         , m_firstY(other.m_firstY)
104         , m_secondX(other.m_secondX)
105         , m_secondY(other.m_secondY)
106         , m_stops(other.m_stops)
107         , m_stopsSorted(other.m_stopsSorted)
108         , m_gradientType(gradientType)
<span class="line-modified">109         , m_repeating(other.isRepeating() ? Repeating : NonRepeating)</span>
110     {
111     }
112 
113     template&lt;typename GradientAdapter&gt;
114     Gradient::ColorStopVector computeStops(GradientAdapter&amp;, const CSSToLengthConversionData&amp;, const RenderStyle&amp;, float maxLengthForRepeat);
115 
116     // Resolve points/radii to front end values.
117     FloatPoint computeEndPoint(CSSPrimitiveValue*, CSSPrimitiveValue*, const CSSToLengthConversionData&amp;, const FloatSize&amp;);
118 
119     bool isCacheable() const;
120 


121     // Points. Some of these may be null.
122     RefPtr&lt;CSSPrimitiveValue&gt; m_firstX;
123     RefPtr&lt;CSSPrimitiveValue&gt; m_firstY;
124 
125     RefPtr&lt;CSSPrimitiveValue&gt; m_secondX;
126     RefPtr&lt;CSSPrimitiveValue&gt; m_secondY;
127 
128     // Stops
129     Vector&lt;CSSGradientColorStop, 2&gt; m_stops;
<span class="line-modified">130     bool m_stopsSorted;</span>
131     CSSGradientType m_gradientType;
<span class="line-modified">132     bool m_repeating;</span>
133 };
134 
135 class CSSLinearGradientValue final : public CSSGradientValue {
136 public:
137     static Ref&lt;CSSLinearGradientValue&gt; create(CSSGradientRepeat repeat, CSSGradientType gradientType = CSSLinearGradient)
138     {
139         return adoptRef(*new CSSLinearGradientValue(repeat, gradientType));
140     }
141 
142     void setAngle(Ref&lt;CSSPrimitiveValue&gt;&amp;&amp; val) { m_angle = WTFMove(val); }
143 
144     String customCSSText() const;
145 
146     // Create the gradient for a given size.
147     Ref&lt;Gradient&gt; createGradient(RenderElement&amp;, const FloatSize&amp;);
148 
149     Ref&lt;CSSLinearGradientValue&gt; clone() const
150     {
151         return adoptRef(*new CSSLinearGradientValue(*this));
152     }
</pre>
</td>
<td>
<hr />
<pre>
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #include &quot;CSSImageGeneratorValue.h&quot;
 29 #include &quot;CSSPrimitiveValue.h&quot;
 30 #include &quot;Gradient.h&quot;
 31 #include &lt;wtf/Vector.h&gt;
 32 
 33 namespace WebCore {
 34 
 35 class FloatPoint;
 36 class StyleResolver;
 37 
<span class="line-added"> 38 namespace Style {</span>
<span class="line-added"> 39 class BuilderState;</span>
<span class="line-added"> 40 }</span>
<span class="line-added"> 41 </span>
 42 enum CSSGradientType {
 43     CSSDeprecatedLinearGradient,
 44     CSSDeprecatedRadialGradient,
 45     CSSPrefixedLinearGradient,
 46     CSSPrefixedRadialGradient,
 47     CSSLinearGradient,
 48     CSSRadialGradient,
 49     CSSConicGradient
 50 };
 51 enum CSSGradientRepeat { NonRepeating, Repeating };
 52 
 53 struct CSSGradientColorStop {
 54     RefPtr&lt;CSSPrimitiveValue&gt; m_position; // percentage or length
 55     RefPtr&lt;CSSPrimitiveValue&gt; m_color;
 56     Color m_resolvedColor;
 57     bool m_colorIsDerivedFromElement = false;
 58     bool isMidpoint = false;
 59     bool operator==(const CSSGradientColorStop&amp; other) const
 60     {
 61         return compareCSSValuePtr(m_color, other.m_color)
</pre>
<hr />
<pre>
 73     void setSecondY(RefPtr&lt;CSSPrimitiveValue&gt;&amp;&amp; val) { m_secondY = WTFMove(val); }
 74 
 75     void addStop(const CSSGradientColorStop&amp; stop) { m_stops.append(stop); }
 76     void doneAddingStops() { m_stops.shrinkToFit(); }
 77 
 78     unsigned stopCount() const { return m_stops.size(); }
 79 
 80     void sortStopsIfNeeded();
 81 
 82     bool isRepeating() const { return m_repeating; }
 83 
 84     CSSGradientType gradientType() const { return m_gradientType; }
 85 
 86     bool isFixedSize() const { return false; }
 87     FloatSize fixedSize(const RenderElement&amp;) const { return FloatSize(); }
 88 
 89     bool isPending() const { return false; }
 90     bool knownToBeOpaque(const RenderElement&amp;) const;
 91 
 92     void loadSubimages(CachedResourceLoader&amp;, const ResourceLoaderOptions&amp;) { }
<span class="line-modified"> 93     Ref&lt;CSSGradientValue&gt; gradientWithStylesResolved(Style::BuilderState&amp;);</span>
<span class="line-added"> 94     void resolveRGBColors();</span>
 95 
 96 protected:
 97     CSSGradientValue(ClassType classType, CSSGradientRepeat repeat, CSSGradientType gradientType)
 98         : CSSImageGeneratorValue(classType)

 99         , m_gradientType(gradientType)
100         , m_repeating(repeat == Repeating)
101     {
102     }
103 
104     CSSGradientValue(const CSSGradientValue&amp; other, ClassType classType, CSSGradientType gradientType)
105         : CSSImageGeneratorValue(classType)
106         , m_firstX(other.m_firstX)
107         , m_firstY(other.m_firstY)
108         , m_secondX(other.m_secondX)
109         , m_secondY(other.m_secondY)
110         , m_stops(other.m_stops)
111         , m_stopsSorted(other.m_stopsSorted)
112         , m_gradientType(gradientType)
<span class="line-modified">113         , m_repeating(other.m_repeating)</span>
114     {
115     }
116 
117     template&lt;typename GradientAdapter&gt;
118     Gradient::ColorStopVector computeStops(GradientAdapter&amp;, const CSSToLengthConversionData&amp;, const RenderStyle&amp;, float maxLengthForRepeat);
119 
120     // Resolve points/radii to front end values.
121     FloatPoint computeEndPoint(CSSPrimitiveValue*, CSSPrimitiveValue*, const CSSToLengthConversionData&amp;, const FloatSize&amp;);
122 
123     bool isCacheable() const;
124 
<span class="line-added">125     void writeColorStop(StringBuilder&amp;, const CSSGradientColorStop&amp;) const;</span>
<span class="line-added">126 </span>
127     // Points. Some of these may be null.
128     RefPtr&lt;CSSPrimitiveValue&gt; m_firstX;
129     RefPtr&lt;CSSPrimitiveValue&gt; m_firstY;
130 
131     RefPtr&lt;CSSPrimitiveValue&gt; m_secondX;
132     RefPtr&lt;CSSPrimitiveValue&gt; m_secondY;
133 
134     // Stops
135     Vector&lt;CSSGradientColorStop, 2&gt; m_stops;
<span class="line-modified">136     bool m_stopsSorted { false };</span>
137     CSSGradientType m_gradientType;
<span class="line-modified">138     bool m_repeating { false };</span>
139 };
140 
141 class CSSLinearGradientValue final : public CSSGradientValue {
142 public:
143     static Ref&lt;CSSLinearGradientValue&gt; create(CSSGradientRepeat repeat, CSSGradientType gradientType = CSSLinearGradient)
144     {
145         return adoptRef(*new CSSLinearGradientValue(repeat, gradientType));
146     }
147 
148     void setAngle(Ref&lt;CSSPrimitiveValue&gt;&amp;&amp; val) { m_angle = WTFMove(val); }
149 
150     String customCSSText() const;
151 
152     // Create the gradient for a given size.
153     Ref&lt;Gradient&gt; createGradient(RenderElement&amp;, const FloatSize&amp;);
154 
155     Ref&lt;CSSLinearGradientValue&gt; clone() const
156     {
157         return adoptRef(*new CSSLinearGradientValue(*this));
158     }
</pre>
</td>
</tr>
</table>
<center><a href="CSSGradientValue.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CSSImageGeneratorValue.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>