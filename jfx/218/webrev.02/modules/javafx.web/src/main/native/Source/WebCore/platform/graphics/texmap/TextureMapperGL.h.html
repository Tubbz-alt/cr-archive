<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/texmap/TextureMapperGL.h</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  Copyright (C) 2010 Nokia Corporation and/or its subsidiary(-ies)
  3  Copyright (C) 2015 Igalia S.L.
  4 
  5  This library is free software; you can redistribute it and/or
  6  modify it under the terms of the GNU Library General Public
  7  License as published by the Free Software Foundation; either
  8  version 2 of the License, or (at your option) any later version.
  9 
 10  This library is distributed in the hope that it will be useful,
 11  but WITHOUT ANY WARRANTY; without even the implied warranty of
 12  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 13  Library General Public License for more details.
 14 
 15  You should have received a copy of the GNU Library General Public License
 16  along with this library; see the file COPYING.LIB.  If not, write to
 17  the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
 18  Boston, MA 02110-1301, USA.
 19  */
 20 
 21 #ifndef TextureMapperGL_h
 22 #define TextureMapperGL_h
 23 
 24 #if USE(TEXTURE_MAPPER_GL)
 25 
 26 #include &quot;ClipStack.h&quot;
 27 #include &quot;FilterOperation.h&quot;
 28 #include &quot;IntSize.h&quot;
 29 #include &quot;TextureMapper.h&quot;
 30 #include &quot;TextureMapperContextAttributes.h&quot;
 31 #include &quot;TextureMapperGLHeaders.h&quot;
 32 #include &quot;TransformationMatrix.h&quot;
 33 #include &lt;array&gt;
 34 #include &lt;wtf/Vector.h&gt;
 35 
 36 namespace WebCore {
 37 
 38 class TextureMapperGLData;
 39 class TextureMapperShaderProgram;
 40 class FilterOperation;
 41 
 42 // An OpenGL-ES2 implementation of TextureMapper.
 43 class TextureMapperGL : public TextureMapper {
 44 public:
 45     TextureMapperGL();
 46     virtual ~TextureMapperGL();
 47 
 48     enum Flag {
 49         NoFlag = 0x00,
 50         ShouldBlend = 0x01,
 51         ShouldFlipTexture = 0x02,
 52         ShouldUseARBTextureRect = 0x04,
 53         ShouldAntialias = 0x08,
 54         ShouldRotateTexture90 = 0x10,
 55         ShouldRotateTexture180 = 0x20,
 56         ShouldRotateTexture270 = 0x40,
 57         ShouldConvertTextureBGRAToRGBA = 0x80,
 58         ShouldConvertTextureARGBToRGBA = 0x100,
 59         ShouldNotBlend = 0x200,
 60         ShouldUseExternalOESTextureRect = 0x400
 61     };
 62 
 63     typedef int Flags;
 64 
 65     // TextureMapper implementation
 66     void drawBorder(const Color&amp;, float borderWidth, const FloatRect&amp;, const TransformationMatrix&amp;) override;
 67     void drawNumber(int number, const Color&amp;, const FloatPoint&amp;, const TransformationMatrix&amp;) override;
 68     void drawTexture(const BitmapTexture&amp;, const FloatRect&amp;, const TransformationMatrix&amp;, float opacity, unsigned exposedEdges) override;
 69     virtual void drawTexture(GLuint texture, Flags, const IntSize&amp; textureSize, const FloatRect&amp; targetRect, const TransformationMatrix&amp; modelViewMatrix, float opacity, unsigned exposedEdges = AllEdges);
 70     void drawTexturePlanarYUV(const std::array&lt;GLuint, 3&gt;&amp; textures, const std::array&lt;GLfloat, 9&gt;&amp; yuvToRgbMatrix, Flags, const IntSize&amp; textureSize, const FloatRect&amp; targetRect, const TransformationMatrix&amp; modelViewMatrix, float opacity, unsigned exposedEdges = AllEdges);
 71     void drawTextureSemiPlanarYUV(const std::array&lt;GLuint, 2&gt;&amp; textures, bool uvReversed, const std::array&lt;GLfloat, 9&gt;&amp; yuvToRgbMatrix, Flags, const IntSize&amp; textureSize, const FloatRect&amp; targetRect, const TransformationMatrix&amp; modelViewMatrix, float opacity, unsigned exposedEdges = AllEdges);
 72     void drawTexturePackedYUV(GLuint texture, const std::array&lt;GLfloat, 9&gt;&amp; yuvToRgbMatrix, Flags, const IntSize&amp; textureSize, const FloatRect&amp; targetRect, const TransformationMatrix&amp; modelViewMatrix, float opacity, unsigned exposedEdges = AllEdges);
 73     void drawSolidColor(const FloatRect&amp;, const TransformationMatrix&amp;, const Color&amp;, bool) override;
 74     void clearColor(const Color&amp;) override;
 75 
 76     void bindSurface(BitmapTexture* surface) override;
 77     BitmapTexture* currentSurface();
 78     void beginClip(const TransformationMatrix&amp;, const FloatRect&amp;) override;
 79     void beginPainting(PaintFlags = 0) override;
 80     void endPainting() override;
 81     void endClip() override;
 82     IntRect clipBounds() override;
 83     IntSize maxTextureSize() const override { return IntSize(2000, 2000); }
 84     Ref&lt;BitmapTexture&gt; createTexture() override { return createTexture(GL_DONT_CARE); }
 85     Ref&lt;BitmapTexture&gt; createTexture(GLint internalFormat) override;
 86 
 87     void drawFiltered(const BitmapTexture&amp; sourceTexture, const BitmapTexture* contentTexture, const FilterOperation&amp;, int pass);
 88 
 89     void setEnableEdgeDistanceAntialiasing(bool enabled) { m_enableEdgeDistanceAntialiasing = enabled; }
 90     void drawTextureExternalOES(GLuint texture, Flags, const IntSize&amp;, const FloatRect&amp;, const TransformationMatrix&amp; modelViewMatrix, float opacity);
 91 
 92 private:
 93     void drawTexturedQuadWithProgram(TextureMapperShaderProgram&amp;, uint32_t texture, Flags, const IntSize&amp;, const FloatRect&amp;, const TransformationMatrix&amp; modelViewMatrix, float opacity);
 94     void drawTexturedQuadWithProgram(TextureMapperShaderProgram&amp;, const Vector&lt;std::pair&lt;GLuint, GLuint&gt; &gt;&amp; texturesAndSamplers, Flags, const IntSize&amp;, const FloatRect&amp;, const TransformationMatrix&amp; modelViewMatrix, float opacity);
 95     void draw(const FloatRect&amp;, const TransformationMatrix&amp; modelViewMatrix, TextureMapperShaderProgram&amp;, GLenum drawingMode, Flags);
 96 
 97     void drawUnitRect(TextureMapperShaderProgram&amp;, GLenum drawingMode);
 98     void drawEdgeTriangles(TextureMapperShaderProgram&amp;);
 99 
100     bool beginScissorClip(const TransformationMatrix&amp;, const FloatRect&amp;);
101     void bindDefaultSurface();
102     ClipStack&amp; clipStack();
103     inline TextureMapperGLData&amp; data() { return *m_data; }
104 
105     TextureMapperContextAttributes m_contextAttributes;
106     TextureMapperGLData* m_data;
107     ClipStack m_clipStack;
108     bool m_enableEdgeDistanceAntialiasing;
109 };
110 
111 } // namespace WebCore
112 
113 #endif // USE(TEXTURE_MAPPER_GL)
114 
115 #endif // TextureMapperGL_h
    </pre>
  </body>
</html>