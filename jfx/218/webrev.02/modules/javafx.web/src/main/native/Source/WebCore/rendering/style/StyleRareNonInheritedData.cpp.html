<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/WebCore/rendering/style/StyleRareNonInheritedData.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (C) 1999 Antti Koivisto (koivisto@kde.org)
  3  * Copyright (C) 2004-2017 Apple Inc. All rights reserved.
  4  *
  5  * This library is free software; you can redistribute it and/or
  6  * modify it under the terms of the GNU Library General Public
  7  * License as published by the Free Software Foundation; either
  8  * version 2 of the License, or (at your option) any later version.
  9  *
 10  * This library is distributed in the hope that it will be useful,
 11  * but WITHOUT ANY WARRANTY; without even the implied warranty of
 12  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 13  * Library General Public License for more details.
 14  *
 15  * You should have received a copy of the GNU Library General Public License
 16  * along with this library; see the file COPYING.LIB.  If not, write to
 17  * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
 18  * Boston, MA 02110-1301, USA.
 19  *
 20  */
 21 
 22 #include &quot;config.h&quot;
 23 #include &quot;StyleRareNonInheritedData.h&quot;
 24 
 25 #include &quot;ContentData.h&quot;
 26 #include &quot;RenderCounter.h&quot;
 27 #include &quot;RenderStyle.h&quot;
 28 #include &quot;ShadowData.h&quot;
 29 #include &quot;StyleCustomPropertyData.h&quot;
 30 #include &quot;StyleFilterData.h&quot;
 31 #include &quot;StyleTransformData.h&quot;
 32 #include &quot;StyleImage.h&quot;
 33 #include &quot;StyleResolver.h&quot;
 34 #include &quot;StyleScrollSnapPoints.h&quot;
 35 #include &lt;wtf/PointerComparison.h&gt;
 36 #include &lt;wtf/RefPtr.h&gt;
 37 #include &lt;wtf/text/TextStream.h&gt;
 38 
 39 namespace WebCore {
 40 
 41 DEFINE_ALLOCATOR_WITH_HEAP_IDENTIFIER(StyleRareNonInheritedData);
 42 
 43 StyleRareNonInheritedData::StyleRareNonInheritedData()
 44     : opacity(RenderStyle::initialOpacity())
 45     , aspectRatioDenominator(RenderStyle::initialAspectRatioDenominator())
 46     , aspectRatioNumerator(RenderStyle::initialAspectRatioNumerator())
 47     , perspective(RenderStyle::initialPerspective())
 48     , perspectiveOriginX(RenderStyle::initialPerspectiveOriginX())
 49     , perspectiveOriginY(RenderStyle::initialPerspectiveOriginY())
 50     , lineClamp(RenderStyle::initialLineClamp())
 51     , initialLetter(RenderStyle::initialInitialLetter())
 52     , deprecatedFlexibleBox(StyleDeprecatedFlexibleBoxData::create())
 53     , flexibleBox(StyleFlexibleBoxData::create())
 54     , marquee(StyleMarqueeData::create())
 55     , multiCol(StyleMultiColData::create())
 56     , transform(StyleTransformData::create())
 57     , filter(StyleFilterData::create())
 58 #if ENABLE(FILTERS_LEVEL_2)
 59     , backdropFilter(StyleFilterData::create())
 60 #endif
 61     , grid(StyleGridData::create())
 62     , gridItem(StyleGridItemData::create())
 63 #if ENABLE(CSS_SCROLL_SNAP)
 64     , scrollSnapPort(StyleScrollSnapPort::create())
 65     , scrollSnapArea(StyleScrollSnapArea::create())
 66 #endif
 67     , willChange(RenderStyle::initialWillChange())
 68     , mask(FillLayerType::Mask)
 69     , maskBoxImage(NinePieceImage::Type::Mask)
 70     , objectPosition(RenderStyle::initialObjectPosition())
 71     , shapeOutside(RenderStyle::initialShapeOutside())
 72     , shapeMargin(RenderStyle::initialShapeMargin())
 73     , shapeImageThreshold(RenderStyle::initialShapeImageThreshold())
 74     , clipPath(RenderStyle::initialClipPath())
 75     , visitedLinkBackgroundColor(RenderStyle::initialBackgroundColor())
 76     , order(RenderStyle::initialOrder())
 77     , alignContent(RenderStyle::initialContentAlignment())
 78     , alignItems(RenderStyle::initialDefaultAlignment())
 79     , alignSelf(RenderStyle::initialSelfAlignment())
 80     , justifyContent(RenderStyle::initialContentAlignment())
 81     , justifyItems(RenderStyle::initialJustifyItems())
 82     , justifySelf(RenderStyle::initialSelfAlignment())
 83     , customProperties(StyleCustomPropertyData::create())
 84 #if ENABLE(POINTER_EVENTS)
 85     , touchActions(static_cast&lt;unsigned&gt;(RenderStyle::initialTouchActions()))
 86 #endif
 87     , pageSizeType(PAGE_SIZE_AUTO)
 88     , transformStyle3D(static_cast&lt;unsigned&gt;(RenderStyle::initialTransformStyle3D()))
 89     , backfaceVisibility(static_cast&lt;unsigned&gt;(RenderStyle::initialBackfaceVisibility()))
 90     , userDrag(static_cast&lt;unsigned&gt;(RenderStyle::initialUserDrag()))
 91     , textOverflow(static_cast&lt;unsigned&gt;(RenderStyle::initialTextOverflow()))
 92     , useSmoothScrolling(static_cast&lt;unsigned&gt;(RenderStyle::initialUseSmoothScrolling()))
 93     , marginBeforeCollapse(static_cast&lt;unsigned&gt;(MarginCollapse::Collapse))
 94     , marginAfterCollapse(static_cast&lt;unsigned&gt;(MarginCollapse::Collapse))
 95     , appearance(static_cast&lt;unsigned&gt;(RenderStyle::initialAppearance()))
 96     , borderFit(static_cast&lt;unsigned&gt;(RenderStyle::initialBorderFit()))
 97     , textCombine(static_cast&lt;unsigned&gt;(RenderStyle::initialTextCombine()))
 98     , textDecorationStyle(static_cast&lt;unsigned&gt;(RenderStyle::initialTextDecorationStyle()))
 99     , aspectRatioType(static_cast&lt;unsigned&gt;(RenderStyle::initialAspectRatioType()))
100 #if ENABLE(CSS_COMPOSITING)
101     , effectiveBlendMode(static_cast&lt;unsigned&gt;(RenderStyle::initialBlendMode()))
102     , isolation(static_cast&lt;unsigned&gt;(RenderStyle::initialIsolation()))
103 #endif
104 #if ENABLE(APPLE_PAY)
105     , applePayButtonStyle(static_cast&lt;unsigned&gt;(RenderStyle::initialApplePayButtonStyle()))
106     , applePayButtonType(static_cast&lt;unsigned&gt;(RenderStyle::initialApplePayButtonType()))
107 #endif
108     , objectFit(static_cast&lt;unsigned&gt;(RenderStyle::initialObjectFit()))
109     , breakBefore(static_cast&lt;unsigned&gt;(RenderStyle::initialBreakBetween()))
110     , breakAfter(static_cast&lt;unsigned&gt;(RenderStyle::initialBreakBetween()))
111     , breakInside(static_cast&lt;unsigned&gt;(RenderStyle::initialBreakInside()))
112     , resize(static_cast&lt;unsigned&gt;(RenderStyle::initialResize()))
113     , hasAttrContent(false)
114     , isNotFinal(false)
115     , columnGap(RenderStyle::initialColumnGap())
116     , rowGap(RenderStyle::initialRowGap())
117 {
118 }
119 
120 inline StyleRareNonInheritedData::StyleRareNonInheritedData(const StyleRareNonInheritedData&amp; o)
121     : RefCounted&lt;StyleRareNonInheritedData&gt;()
122     , opacity(o.opacity)
123     , aspectRatioDenominator(o.aspectRatioDenominator)
124     , aspectRatioNumerator(o.aspectRatioNumerator)
125     , perspective(o.perspective)
126     , perspectiveOriginX(o.perspectiveOriginX)
127     , perspectiveOriginY(o.perspectiveOriginY)
128     , lineClamp(o.lineClamp)
129     , initialLetter(o.initialLetter)
130     , deprecatedFlexibleBox(o.deprecatedFlexibleBox)
131     , flexibleBox(o.flexibleBox)
132     , marquee(o.marquee)
133     , multiCol(o.multiCol)
134     , transform(o.transform)
135     , filter(o.filter)
136 #if ENABLE(FILTERS_LEVEL_2)
137     , backdropFilter(o.backdropFilter)
138 #endif
139     , grid(o.grid)
140     , gridItem(o.gridItem)
141 #if ENABLE(CSS_SCROLL_SNAP)
142     , scrollSnapPort(o.scrollSnapPort)
143     , scrollSnapArea(o.scrollSnapArea)
144 #endif
145     , content(o.content ? o.content-&gt;clone() : nullptr)
146     , counterDirectives(o.counterDirectives ? makeUnique&lt;CounterDirectiveMap&gt;(*o.counterDirectives) : nullptr)
147     , altText(o.altText)
148     , boxShadow(o.boxShadow ? makeUnique&lt;ShadowData&gt;(*o.boxShadow) : nullptr)
149     , willChange(o.willChange)
150     , boxReflect(o.boxReflect)
151     , animations(o.animations ? o.animations-&gt;copy() : o.animations)
152     , transitions(o.transitions ? o.transitions-&gt;copy() : o.transitions)
153     , mask(o.mask)
154     , maskBoxImage(o.maskBoxImage)
155     , pageSize(o.pageSize)
156     , objectPosition(o.objectPosition)
157     , shapeOutside(o.shapeOutside)
158     , shapeMargin(o.shapeMargin)
159     , shapeImageThreshold(o.shapeImageThreshold)
160     , clipPath(o.clipPath)
161     , textDecorationColor(o.textDecorationColor)
162     , visitedLinkTextDecorationColor(o.visitedLinkTextDecorationColor)
163     , visitedLinkBackgroundColor(o.visitedLinkBackgroundColor)
164     , visitedLinkOutlineColor(o.visitedLinkOutlineColor)
165     , visitedLinkBorderLeftColor(o.visitedLinkBorderLeftColor)
166     , visitedLinkBorderRightColor(o.visitedLinkBorderRightColor)
167     , visitedLinkBorderTopColor(o.visitedLinkBorderTopColor)
168     , visitedLinkBorderBottomColor(o.visitedLinkBorderBottomColor)
169     , order(o.order)
170     , alignContent(o.alignContent)
171     , alignItems(o.alignItems)
172     , alignSelf(o.alignSelf)
173     , justifyContent(o.justifyContent)
174     , justifyItems(o.justifyItems)
175     , justifySelf(o.justifySelf)
176     , customProperties(o.customProperties)
177     , customPaintWatchedProperties(o.customPaintWatchedProperties ? makeUnique&lt;HashSet&lt;String&gt;&gt;(*o.customPaintWatchedProperties) : nullptr)
178 #if ENABLE(POINTER_EVENTS)
179     , touchActions(o.touchActions)
180 #endif
181     , pageSizeType(o.pageSizeType)
182     , transformStyle3D(o.transformStyle3D)
183     , backfaceVisibility(o.backfaceVisibility)
184     , userDrag(o.userDrag)
185     , textOverflow(o.textOverflow)
186     , useSmoothScrolling(o.useSmoothScrolling)
187     , marginBeforeCollapse(o.marginBeforeCollapse)
188     , marginAfterCollapse(o.marginAfterCollapse)
189     , appearance(o.appearance)
190     , borderFit(o.borderFit)
191     , textCombine(o.textCombine)
192     , textDecorationStyle(o.textDecorationStyle)
193     , aspectRatioType(o.aspectRatioType)
194 #if ENABLE(CSS_COMPOSITING)
195     , effectiveBlendMode(o.effectiveBlendMode)
196     , isolation(o.isolation)
197 #endif
198 #if ENABLE(APPLE_PAY)
199     , applePayButtonStyle(o.applePayButtonStyle)
200     , applePayButtonType(o.applePayButtonType)
201 #endif
202     , objectFit(o.objectFit)
203     , breakBefore(o.breakBefore)
204     , breakAfter(o.breakAfter)
205     , breakInside(o.breakInside)
206     , resize(o.resize)
207     , hasAttrContent(o.hasAttrContent)
208     , isNotFinal(o.isNotFinal)
209     , columnGap(o.columnGap)
210     , rowGap(o.rowGap)
211 {
212 }
213 
214 Ref&lt;StyleRareNonInheritedData&gt; StyleRareNonInheritedData::copy() const
215 {
216     return adoptRef(*new StyleRareNonInheritedData(*this));
217 }
218 
219 StyleRareNonInheritedData::~StyleRareNonInheritedData() = default;
220 
221 bool StyleRareNonInheritedData::operator==(const StyleRareNonInheritedData&amp; o) const
222 {
223     return opacity == o.opacity
224         &amp;&amp; aspectRatioDenominator == o.aspectRatioDenominator
225         &amp;&amp; aspectRatioNumerator == o.aspectRatioNumerator
226         &amp;&amp; perspective == o.perspective
227         &amp;&amp; perspectiveOriginX == o.perspectiveOriginX
228         &amp;&amp; perspectiveOriginY == o.perspectiveOriginY
229         &amp;&amp; lineClamp == o.lineClamp
230         &amp;&amp; initialLetter == o.initialLetter
231         &amp;&amp; deprecatedFlexibleBox == o.deprecatedFlexibleBox
232         &amp;&amp; flexibleBox == o.flexibleBox
233         &amp;&amp; marquee == o.marquee
234         &amp;&amp; multiCol == o.multiCol
235         &amp;&amp; transform == o.transform
236         &amp;&amp; filter == o.filter
237 #if ENABLE(FILTERS_LEVEL_2)
238         &amp;&amp; backdropFilter == o.backdropFilter
239 #endif
240         &amp;&amp; grid == o.grid
241         &amp;&amp; gridItem == o.gridItem
242 #if ENABLE(CSS_SCROLL_SNAP)
243         &amp;&amp; scrollSnapPort == o.scrollSnapPort
244         &amp;&amp; scrollSnapArea == o.scrollSnapArea
245 #endif
246         &amp;&amp; contentDataEquivalent(o)
247         &amp;&amp; arePointingToEqualData(counterDirectives, o.counterDirectives)
248         &amp;&amp; altText == o.altText
249         &amp;&amp; arePointingToEqualData(boxShadow, o.boxShadow)
250         &amp;&amp; arePointingToEqualData(willChange, o.willChange)
251         &amp;&amp; arePointingToEqualData(boxReflect, o.boxReflect)
252         &amp;&amp; arePointingToEqualData(animations, o.animations)
253         &amp;&amp; arePointingToEqualData(transitions, o.transitions)
254         &amp;&amp; mask == o.mask
255         &amp;&amp; maskBoxImage == o.maskBoxImage
256         &amp;&amp; pageSize == o.pageSize
257         &amp;&amp; objectPosition == o.objectPosition
258         &amp;&amp; arePointingToEqualData(shapeOutside, o.shapeOutside)
259         &amp;&amp; shapeMargin == o.shapeMargin
260         &amp;&amp; shapeImageThreshold == o.shapeImageThreshold
261         &amp;&amp; arePointingToEqualData(clipPath, o.clipPath)
262         &amp;&amp; textDecorationColor == o.textDecorationColor
263         &amp;&amp; visitedLinkTextDecorationColor == o.visitedLinkTextDecorationColor
264         &amp;&amp; visitedLinkBackgroundColor == o.visitedLinkBackgroundColor
265         &amp;&amp; visitedLinkOutlineColor == o.visitedLinkOutlineColor
266         &amp;&amp; visitedLinkBorderLeftColor == o.visitedLinkBorderLeftColor
267         &amp;&amp; visitedLinkBorderRightColor == o.visitedLinkBorderRightColor
268         &amp;&amp; visitedLinkBorderTopColor == o.visitedLinkBorderTopColor
269         &amp;&amp; visitedLinkBorderBottomColor == o.visitedLinkBorderBottomColor
270         &amp;&amp; order == o.order
271         &amp;&amp; alignContent == o.alignContent
272         &amp;&amp; alignItems == o.alignItems
273         &amp;&amp; alignSelf == o.alignSelf
274         &amp;&amp; justifyContent == o.justifyContent
275         &amp;&amp; justifyItems == o.justifyItems
276         &amp;&amp; justifySelf == o.justifySelf
277         &amp;&amp; customProperties == o.customProperties
278         &amp;&amp; ((customPaintWatchedProperties &amp;&amp; o.customPaintWatchedProperties &amp;&amp; *customPaintWatchedProperties == *o.customPaintWatchedProperties)
279             || (!customPaintWatchedProperties &amp;&amp; !o.customPaintWatchedProperties))
280         &amp;&amp; pageSizeType == o.pageSizeType
281         &amp;&amp; transformStyle3D == o.transformStyle3D
282         &amp;&amp; backfaceVisibility == o.backfaceVisibility
283         &amp;&amp; userDrag == o.userDrag
284         &amp;&amp; textOverflow == o.textOverflow
285         &amp;&amp; useSmoothScrolling == o.useSmoothScrolling
286         &amp;&amp; marginBeforeCollapse == o.marginBeforeCollapse
287         &amp;&amp; marginAfterCollapse == o.marginAfterCollapse
288         &amp;&amp; appearance == o.appearance
289         &amp;&amp; borderFit == o.borderFit
290         &amp;&amp; textCombine == o.textCombine
291         &amp;&amp; textDecorationStyle == o.textDecorationStyle
292 #if ENABLE(POINTER_EVENTS)
293         &amp;&amp; touchActions == o.touchActions
294 #endif
295 #if ENABLE(CSS_COMPOSITING)
296         &amp;&amp; effectiveBlendMode == o.effectiveBlendMode
297         &amp;&amp; isolation == o.isolation
298 #endif
299 #if ENABLE(APPLE_PAY)
300         &amp;&amp; applePayButtonStyle == o.applePayButtonStyle
301         &amp;&amp; applePayButtonType == o.applePayButtonType
302 #endif
303         &amp;&amp; aspectRatioType == o.aspectRatioType
304         &amp;&amp; objectFit == o.objectFit
305         &amp;&amp; breakAfter == o.breakAfter
306         &amp;&amp; breakBefore == o.breakBefore
307         &amp;&amp; breakInside == o.breakInside
308         &amp;&amp; resize == o.resize
309         &amp;&amp; hasAttrContent == o.hasAttrContent
310         &amp;&amp; isNotFinal == o.isNotFinal
311         &amp;&amp; columnGap == o.columnGap
312         &amp;&amp; rowGap == o.rowGap;
313 }
314 
315 bool StyleRareNonInheritedData::contentDataEquivalent(const StyleRareNonInheritedData&amp; other) const
316 {
317     auto* a = content.get();
318     auto* b = other.content.get();
319     while (a &amp;&amp; b &amp;&amp; *a == *b) {
320         a = a-&gt;next();
321         b = b-&gt;next();
322     }
323     return !a &amp;&amp; !b;
324 }
325 
326 bool StyleRareNonInheritedData::hasFilters() const
327 {
328     return !filter-&gt;operations.isEmpty();
329 }
330 
331 #if ENABLE(FILTERS_LEVEL_2)
332 
333 bool StyleRareNonInheritedData::hasBackdropFilters() const
334 {
335     return !backdropFilter-&gt;operations.isEmpty();
336 }
337 
338 #endif
339 
340 } // namespace WebCore
    </pre>
  </body>
</html>