<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/inspector/agents/InspectorCSSAgent.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="InspectorCPUProfilerAgent.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="InspectorCSSAgent.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/inspector/agents/InspectorCSSAgent.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 440,10 ***</span>
<span class="line-new-header">--- 440,12 ---</span>
          return Inspector::Protocol::CSS::PseudoId::Before;
      case PseudoId::After:
          return Inspector::Protocol::CSS::PseudoId::After;
      case PseudoId::Selection:
          return Inspector::Protocol::CSS::PseudoId::Selection;
<span class="line-added">+     case PseudoId::Highlight:</span>
<span class="line-added">+         return Inspector::Protocol::CSS::PseudoId::Highlight;</span>
      case PseudoId::Scrollbar:
          return Inspector::Protocol::CSS::PseudoId::Scrollbar;
      case PseudoId::ScrollbarThumb:
          return Inspector::Protocol::CSS::PseudoId::ScrollbarThumb;
      case PseudoId::ScrollbarButton:
</pre>
<hr />
<pre>
<span class="line-old-header">*** 478,21 ***</span>
              return;
          }
      }
  
      // Matched rules.
<span class="line-modified">!     StyleResolver&amp; styleResolver = element-&gt;styleResolver();</span>
<span class="line-modified">!     auto matchedRules = styleResolver.pseudoStyleRulesForElement(element, elementPseudoId, StyleResolver::AllCSSRules);</span>
      matchedCSSRules = buildArrayForMatchedRuleList(matchedRules, styleResolver, *element, elementPseudoId);
  
      if (!originalElement-&gt;isPseudoElement()) {
          // Pseudo elements.
          if (!includePseudo || *includePseudo) {
              auto pseudoElements = JSON::ArrayOf&lt;Inspector::Protocol::CSS::PseudoIdMatches&gt;::create();
              for (PseudoId pseudoId = PseudoId::FirstPublicPseudoId; pseudoId &lt; PseudoId::AfterLastInternalPseudoId; pseudoId = static_cast&lt;PseudoId&gt;(static_cast&lt;unsigned&gt;(pseudoId) + 1)) {
                  if (auto protocolPseudoId = protocolValueForPseudoId(pseudoId)) {
<span class="line-modified">!                     auto matchedRules = styleResolver.pseudoStyleRulesForElement(element, pseudoId, StyleResolver::AllCSSRules);</span>
                      if (!matchedRules.isEmpty()) {
                          auto matches = Inspector::Protocol::CSS::PseudoIdMatches::create()
                              .setPseudoId(protocolPseudoId.value())
                              .setMatches(buildArrayForMatchedRuleList(matchedRules, styleResolver, *element, pseudoId))
                              .release();
<span class="line-new-header">--- 480,21 ---</span>
              return;
          }
      }
  
      // Matched rules.
<span class="line-modified">!     auto&amp; styleResolver = element-&gt;styleResolver();</span>
<span class="line-modified">!     auto matchedRules = styleResolver.pseudoStyleRulesForElement(element, elementPseudoId, Style::Resolver::AllCSSRules);</span>
      matchedCSSRules = buildArrayForMatchedRuleList(matchedRules, styleResolver, *element, elementPseudoId);
  
      if (!originalElement-&gt;isPseudoElement()) {
          // Pseudo elements.
          if (!includePseudo || *includePseudo) {
              auto pseudoElements = JSON::ArrayOf&lt;Inspector::Protocol::CSS::PseudoIdMatches&gt;::create();
              for (PseudoId pseudoId = PseudoId::FirstPublicPseudoId; pseudoId &lt; PseudoId::AfterLastInternalPseudoId; pseudoId = static_cast&lt;PseudoId&gt;(static_cast&lt;unsigned&gt;(pseudoId) + 1)) {
                  if (auto protocolPseudoId = protocolValueForPseudoId(pseudoId)) {
<span class="line-modified">!                     auto matchedRules = styleResolver.pseudoStyleRulesForElement(element, pseudoId, Style::Resolver::AllCSSRules);</span>
                      if (!matchedRules.isEmpty()) {
                          auto matches = Inspector::Protocol::CSS::PseudoIdMatches::create()
                              .setPseudoId(protocolPseudoId.value())
                              .setMatches(buildArrayForMatchedRuleList(matchedRules, styleResolver, *element, pseudoId))
                              .release();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 507,12 ***</span>
          // Inherited styles.
          if (!includeInherited || *includeInherited) {
              auto entries = JSON::ArrayOf&lt;Inspector::Protocol::CSS::InheritedStyleEntry&gt;::create();
              Element* parentElement = element-&gt;parentElement();
              while (parentElement) {
<span class="line-modified">!                 StyleResolver&amp; parentStyleResolver = parentElement-&gt;styleResolver();</span>
<span class="line-modified">!                 auto parentMatchedRules = parentStyleResolver.styleRulesForElement(parentElement, StyleResolver::AllCSSRules);</span>
                  auto entry = Inspector::Protocol::CSS::InheritedStyleEntry::create()
                      .setMatchedCSSRules(buildArrayForMatchedRuleList(parentMatchedRules, styleResolver, *parentElement, PseudoId::None))
                      .release();
                  if (is&lt;StyledElement&gt;(*parentElement) &amp;&amp; downcast&lt;StyledElement&gt;(*parentElement).cssomStyle().length()) {
                      auto&amp; styleSheet = asInspectorStyleSheet(downcast&lt;StyledElement&gt;(*parentElement));
<span class="line-new-header">--- 509,12 ---</span>
          // Inherited styles.
          if (!includeInherited || *includeInherited) {
              auto entries = JSON::ArrayOf&lt;Inspector::Protocol::CSS::InheritedStyleEntry&gt;::create();
              Element* parentElement = element-&gt;parentElement();
              while (parentElement) {
<span class="line-modified">!                 auto&amp; parentStyleResolver = parentElement-&gt;styleResolver();</span>
<span class="line-modified">!                 auto parentMatchedRules = parentStyleResolver.styleRulesForElement(parentElement, Style::Resolver::AllCSSRules);</span>
                  auto entry = Inspector::Protocol::CSS::InheritedStyleEntry::create()
                      .setMatchedCSSRules(buildArrayForMatchedRuleList(parentMatchedRules, styleResolver, *parentElement, PseudoId::None))
                      .release();
                  if (is&lt;StyledElement&gt;(*parentElement) &amp;&amp; downcast&lt;StyledElement&gt;(*parentElement).cssomStyle().length()) {
                      auto&amp; styleSheet = asInspectorStyleSheet(downcast&lt;StyledElement&gt;(*parentElement));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 942,16 ***</span>
      }
  
      return Inspector::Protocol::CSS::StyleSheetOrigin::Regular;
  }
  
<span class="line-modified">! RefPtr&lt;Inspector::Protocol::CSS::CSSRule&gt; InspectorCSSAgent::buildObjectForRule(StyleRule* styleRule, StyleResolver&amp; styleResolver, Element&amp; element)</span>
  {
      if (!styleRule)
          return nullptr;
  
<span class="line-modified">!     // StyleRules returned by StyleResolver::styleRulesForElement lack parent pointers since that infomation is not cheaply available.</span>
      // Since the inspector wants to walk the parent chain, we construct the full wrappers here.
      styleResolver.inspectorCSSOMWrappers().collectDocumentWrappers(styleResolver.document().extensionStyleSheets());
      styleResolver.inspectorCSSOMWrappers().collectScopeWrappers(Style::Scope::forNode(element));
  
      // Possiblity of :host styles if this element has a shadow root.
<span class="line-new-header">--- 944,16 ---</span>
      }
  
      return Inspector::Protocol::CSS::StyleSheetOrigin::Regular;
  }
  
<span class="line-modified">! RefPtr&lt;Inspector::Protocol::CSS::CSSRule&gt; InspectorCSSAgent::buildObjectForRule(const StyleRule* styleRule, Style::Resolver&amp; styleResolver, Element&amp; element)</span>
  {
      if (!styleRule)
          return nullptr;
  
<span class="line-modified">!     // StyleRules returned by Style::Resolver::styleRulesForElement lack parent pointers since that infomation is not cheaply available.</span>
      // Since the inspector wants to walk the parent chain, we construct the full wrappers here.
      styleResolver.inspectorCSSOMWrappers().collectDocumentWrappers(styleResolver.document().extensionStyleSheets());
      styleResolver.inspectorCSSOMWrappers().collectScopeWrappers(Style::Scope::forNode(element));
  
      // Possiblity of :host styles if this element has a shadow root.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 974,11 ***</span>
      ASSERT(rule-&gt;parentStyleSheet());
      InspectorStyleSheet* inspectorStyleSheet = bindStyleSheet(rule-&gt;parentStyleSheet());
      return inspectorStyleSheet ? inspectorStyleSheet-&gt;buildObjectForRule(rule, nullptr) : nullptr;
  }
  
<span class="line-modified">! RefPtr&lt;JSON::ArrayOf&lt;Inspector::Protocol::CSS::RuleMatch&gt;&gt; InspectorCSSAgent::buildArrayForMatchedRuleList(const Vector&lt;RefPtr&lt;StyleRule&gt;&gt;&amp; matchedRules, StyleResolver&amp; styleResolver, Element&amp; element, PseudoId pseudoId)</span>
  {
      auto result = JSON::ArrayOf&lt;Inspector::Protocol::CSS::RuleMatch&gt;::create();
  
      SelectorChecker::CheckingContext context(SelectorChecker::Mode::CollectingRules);
      context.pseudoId = pseudoId != PseudoId::None ? pseudoId : element.pseudoId();
<span class="line-new-header">--- 976,11 ---</span>
      ASSERT(rule-&gt;parentStyleSheet());
      InspectorStyleSheet* inspectorStyleSheet = bindStyleSheet(rule-&gt;parentStyleSheet());
      return inspectorStyleSheet ? inspectorStyleSheet-&gt;buildObjectForRule(rule, nullptr) : nullptr;
  }
  
<span class="line-modified">! RefPtr&lt;JSON::ArrayOf&lt;Inspector::Protocol::CSS::RuleMatch&gt;&gt; InspectorCSSAgent::buildArrayForMatchedRuleList(const Vector&lt;RefPtr&lt;const StyleRule&gt;&gt;&amp; matchedRules, Style::Resolver&amp; styleResolver, Element&amp; element, PseudoId pseudoId)</span>
  {
      auto result = JSON::ArrayOf&lt;Inspector::Protocol::CSS::RuleMatch&gt;::create();
  
      SelectorChecker::CheckingContext context(SelectorChecker::Mode::CollectingRules);
      context.pseudoId = pseudoId != PseudoId::None ? pseudoId : element.pseudoId();
</pre>
<center><a href="InspectorCPUProfilerAgent.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="InspectorCSSAgent.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>