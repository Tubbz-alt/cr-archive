<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/rendering/RenderThemeWin.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="RenderThemeMac.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="RenderThemeWin.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/rendering/RenderThemeWin.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 665             if (o.style().appearance() == DefaultButtonPart) {
 666                 HBRUSH brush = ::GetSysColorBrush(COLOR_3DDKSHADOW);
 667                 ::FrameRect(hdc, &amp;widgetRect, brush);
 668                 ::InflateRect(&amp;widgetRect, -1, -1);
 669                 ::DrawEdge(hdc, &amp;widgetRect, BDR_RAISEDOUTER, BF_RECT | BF_MIDDLE);
 670             }
 671             ::DrawFrameControl(hdc, &amp;widgetRect, themeData.m_part, themeData.m_state);
 672         }
 673     }
 674 
 675     if (!alphaBlend &amp;&amp; !context.isInTransparencyLayer())
 676         DIBPixelData::setRGBABitmapAlpha(windowsContext.hdc(), r, 255);
 677 }
 678 
 679 bool RenderThemeWin::paintButton(const RenderObject&amp; o, const PaintInfo&amp; i, const IntRect&amp; r)
 680 {
 681     drawControl(i.context(),  o, buttonTheme(), getThemeData(o), r);
 682     return false;
 683 }
 684 
<span class="line-modified"> 685 void RenderThemeWin::adjustInnerSpinButtonStyle(StyleResolver&amp; styleResolver, RenderStyle&amp; style, const Element*) const</span>
 686 {
 687     int width = ::GetSystemMetrics(SM_CXVSCROLL);
 688     if (width &lt;= 0)
 689         width = 17; // Vista&#39;s default.
 690     style.setWidth(Length(width, Fixed));
 691     style.setMinWidth(Length(width, Fixed));
 692 }
 693 
 694 bool RenderThemeWin::paintInnerSpinButton(const RenderObject&amp; o, const PaintInfo&amp; i, const IntRect&amp; r)
 695 {
 696     // We split the specified rectangle into two vertically. We can&#39;t draw a
 697     // spin button of which height is less than 2px.
 698     if (r.height() &lt; 2)
 699         return false;
 700     IntRect upRect(r);
 701     upRect.setHeight(r.height() / 2);
 702     IntRect downRect(r);
 703     downRect.setY(upRect.maxY());
 704     downRect.setHeight(r.height() - upRect.height());
 705     drawControl(i.context(), o, spinButtonTheme(), getThemeData(o, SpinButtonUp), upRect);
</pre>
<hr />
<pre>
 729     return false;
 730 }
 731 
 732 bool RenderThemeWin::paintMenuList(const RenderObject&amp; renderer, const PaintInfo&amp; paintInfo, const FloatRect&amp; rect)
 733 {
 734     HANDLE theme;
 735     int part;
 736     if (haveTheme &amp;&amp; (windowsVersion() &gt;= WindowsVista)) {
 737         theme = menuListTheme();
 738         part = CP_READONLY;
 739     } else {
 740         theme = textFieldTheme();
 741         part = TFP_TEXTFIELD;
 742     }
 743 
 744     drawControl(paintInfo.context(), renderer, theme, ThemeData(part, determineState(renderer)), IntRect(rect));
 745 
 746     return paintMenuListButtonDecorations(downcast&lt;RenderBox&gt;(renderer), paintInfo, FloatRect(rect));
 747 }
 748 
<span class="line-modified"> 749 void RenderThemeWin::adjustMenuListStyle(StyleResolver&amp; styleResolver, RenderStyle&amp; style, const Element* e) const</span>
 750 {
 751     style.resetBorder();
<span class="line-modified"> 752     adjustMenuListButtonStyle(styleResolver, style, e);</span>
 753 }
 754 
<span class="line-modified"> 755 void RenderThemeWin::adjustMenuListButtonStyle(StyleResolver&amp; styleResolver, RenderStyle&amp; style, const Element*) const</span>
 756 {
 757     // These are the paddings needed to place the text correctly in the &lt;select&gt; box
 758     const int dropDownBoxPaddingTop    = 2;
 759     const int dropDownBoxPaddingRight  = style.direction() == TextDirection::LTR ? 4 + dropDownButtonWidth : 4;
 760     const int dropDownBoxPaddingBottom = 2;
 761     const int dropDownBoxPaddingLeft   = style.direction() == TextDirection::LTR ? 4 : 4 + dropDownButtonWidth;
 762     // The &lt;select&gt; box must be at least 12px high for the button to render nicely on Windows
 763     const int dropDownBoxMinHeight = 12;
 764 
 765     // Position the text correctly within the select box and make the box wide enough to fit the dropdown button
 766     style.setPaddingTop(Length(dropDownBoxPaddingTop, Fixed));
 767     style.setPaddingRight(Length(dropDownBoxPaddingRight, Fixed));
 768     style.setPaddingBottom(Length(dropDownBoxPaddingBottom, Fixed));
 769     style.setPaddingLeft(Length(dropDownBoxPaddingLeft, Fixed));
 770 
 771     // Height is locked to auto
 772     style.setHeight(Length(Auto));
 773 
 774     // Calculate our min-height
 775     int minHeight = style.fontMetrics().height();
</pre>
<hr />
<pre>
 839 {
 840     ControlPart part = style.appearance();
 841     if (part == SliderThumbVerticalPart) {
 842         style.setWidth(Length(sliderThumbHeight, Fixed));
 843         style.setHeight(Length(sliderThumbWidth, Fixed));
 844     } else if (part == SliderThumbHorizontalPart) {
 845         style.setWidth(Length(sliderThumbWidth, Fixed));
 846         style.setHeight(Length(sliderThumbHeight, Fixed));
 847     }
 848 #if ENABLE(VIDEO) &amp;&amp; USE(CG)
 849     else if (part == MediaSliderThumbPart || part == MediaVolumeSliderThumbPart)
 850         RenderMediaControls::adjustMediaSliderThumbSize(style);
 851 #endif
 852 }
 853 
 854 bool RenderThemeWin::paintSearchField(const RenderObject&amp; o, const PaintInfo&amp; i, const IntRect&amp; r)
 855 {
 856     return paintTextField(o, i, r);
 857 }
 858 
<span class="line-modified"> 859 void RenderThemeWin::adjustSearchFieldStyle(StyleResolver&amp; styleResolver, RenderStyle&amp; style, const Element* e) const</span>
 860 {
 861     // Override paddingSize to match AppKit text positioning.
 862     const int padding = 1;
 863     style.setPaddingLeft(Length(padding, Fixed));
 864     style.setPaddingRight(Length(padding, Fixed));
 865     style.setPaddingTop(Length(padding, Fixed));
 866     style.setPaddingBottom(Length(padding, Fixed));
 867     if (e &amp;&amp; e-&gt;focused() &amp;&amp; e-&gt;document().frame()-&gt;selection().isFocusedAndActive())
 868         style.setOutlineOffset(-2);
 869 }
 870 
 871 bool RenderThemeWin::paintSearchFieldCancelButton(const RenderBox&amp; o, const PaintInfo&amp; paintInfo, const IntRect&amp; r)
 872 {
 873     IntRect bounds = r;
 874     ASSERT(o.parent());
 875     if (!is&lt;RenderBox&gt;(o.parent()))
 876         return false;
 877 
 878     IntRect parentBox = downcast&lt;RenderBox&gt;(*o.parent()).absoluteContentBox();
 879 
 880     // Make sure the scaled button stays square and will fit in its parent&#39;s box
 881     bounds.setHeight(std::min(parentBox.width(), std::min(parentBox.height(), bounds.height())));
 882     bounds.setWidth(bounds.height());
 883 
 884     // Center the button vertically.  Round up though, so if it has to be one pixel off-center, it will
 885     // be one pixel closer to the bottom of the field.  This tends to look better with the text.
 886     bounds.setY(parentBox.y() + (parentBox.height() - bounds.height() + 1) / 2);
 887 
 888     static Image&amp; cancelImage = Image::loadPlatformResource(&quot;searchCancel&quot;).leakRef();
 889     static Image&amp; cancelPressedImage = Image::loadPlatformResource(&quot;searchCancelPressed&quot;).leakRef();
 890     paintInfo.context().drawImage(isPressed(o) ? cancelPressedImage : cancelImage, bounds);
 891     return false;
 892 }
 893 
<span class="line-modified"> 894 void RenderThemeWin::adjustSearchFieldCancelButtonStyle(StyleResolver&amp;, RenderStyle&amp; style, const Element*) const</span>
 895 {
 896     // Scale the button size based on the font size
 897     float fontScale = style.computedFontPixelSize() / defaultControlFontPixelSize;
 898     int cancelButtonSize = lroundf(std::min(std::max(minCancelButtonSize, defaultCancelButtonSize * fontScale), maxCancelButtonSize));
 899     style.setWidth(Length(cancelButtonSize, Fixed));
 900     style.setHeight(Length(cancelButtonSize, Fixed));
 901 }
 902 
<span class="line-modified"> 903 void RenderThemeWin::adjustSearchFieldDecorationPartStyle(StyleResolver&amp;, RenderStyle&amp; style, const Element*) const</span>
 904 {
 905     IntSize emptySize(1, 11);
 906     style.setWidth(Length(emptySize.width(), Fixed));
 907     style.setHeight(Length(emptySize.height(), Fixed));
 908 }
 909 
<span class="line-modified"> 910 void RenderThemeWin::adjustSearchFieldResultsDecorationPartStyle(StyleResolver&amp;, RenderStyle&amp; style, const Element*) const</span>
 911 {
 912     // Scale the decoration size based on the font size
 913     float fontScale = style.computedFontPixelSize() / defaultControlFontPixelSize;
 914     int magnifierSize = lroundf(std::min(std::max(minSearchFieldResultsDecorationSize, defaultSearchFieldResultsDecorationSize * fontScale),
 915                                      maxSearchFieldResultsDecorationSize));
 916     style.setWidth(Length(magnifierSize, Fixed));
 917     style.setHeight(Length(magnifierSize, Fixed));
 918 }
 919 
 920 bool RenderThemeWin::paintSearchFieldResultsDecorationPart(const RenderBox&amp; o, const PaintInfo&amp; paintInfo, const IntRect&amp; r)
 921 {
 922     IntRect bounds = r;
 923     ASSERT(o.parent());
 924     if (!is&lt;RenderBox&gt;(o.parent()))
 925         return false;
 926 
 927     IntRect parentBox = downcast&lt;RenderBox&gt;(*o.parent()).absoluteContentBox();
 928 
 929     // Make sure the scaled decoration stays square and will fit in its parent&#39;s box
 930     bounds.setHeight(std::min(parentBox.width(), std::min(parentBox.height(), bounds.height())));
 931     bounds.setWidth(bounds.height());
 932 
 933     // Center the decoration vertically.  Round up though, so if it has to be one pixel off-center, it will
 934     // be one pixel closer to the bottom of the field.  This tends to look better with the text.
 935     bounds.setY(parentBox.y() + (parentBox.height() - bounds.height() + 1) / 2);
 936 
 937     static Image&amp; magnifierImage = Image::loadPlatformResource(&quot;searchMagnifier&quot;).leakRef();
 938     paintInfo.context().drawImage(magnifierImage, bounds);
 939     return false;
 940 }
 941 
<span class="line-modified"> 942 void RenderThemeWin::adjustSearchFieldResultsButtonStyle(StyleResolver&amp;, RenderStyle&amp; style, const Element*) const</span>
 943 {
 944     // Scale the button size based on the font size
 945     float fontScale = style.computedFontPixelSize() / defaultControlFontPixelSize;
 946     int magnifierHeight = lroundf(std::min(std::max(minSearchFieldResultsDecorationSize, defaultSearchFieldResultsDecorationSize * fontScale),
 947                                    maxSearchFieldResultsDecorationSize));
 948     int magnifierWidth = lroundf(magnifierHeight * defaultSearchFieldResultsButtonWidth / defaultSearchFieldResultsDecorationSize);
 949     style.setWidth(Length(magnifierWidth, Fixed));
 950     style.setHeight(Length(magnifierHeight, Fixed));
 951 }
 952 
 953 bool RenderThemeWin::paintSearchFieldResultsButton(const RenderBox&amp; o, const PaintInfo&amp; paintInfo, const IntRect&amp; r)
 954 {
 955     IntRect bounds = r;
 956     ASSERT(o.parent());
 957     if (!o.parent())
 958         return false;
 959     if (!is&lt;RenderBox&gt;(o.parent()))
 960         return false;
 961 
 962     IntRect parentBox = downcast&lt;RenderBox&gt;(*o.parent()).absoluteContentBox();
</pre>
<hr />
<pre>
1087 #endif
1088 }
1089 
1090 String RenderThemeWin::mediaControlsScript()
1091 {
1092 #if ENABLE(MEDIA_CONTROLS_SCRIPT)
1093     if (m_mediaControlsScript.isEmpty()) {
1094         StringBuilder scriptBuilder;
1095         scriptBuilder.append(stringWithContentsOfFile(&quot;mediaControlsLocalizedStrings&quot;_s, &quot;js&quot;_s));
1096         scriptBuilder.append(stringWithContentsOfFile(&quot;mediaControlsApple&quot;_s, &quot;js&quot;_s));
1097         m_mediaControlsScript = scriptBuilder.toString();
1098     }
1099     return m_mediaControlsScript;
1100 #else
1101     return emptyString();
1102 #endif
1103 }
1104 #endif
1105 
1106 #if ENABLE(METER_ELEMENT)
<span class="line-modified">1107 void RenderThemeWin::adjustMeterStyle(StyleResolver&amp;, RenderStyle&amp; style, const Element*) const</span>
1108 {
1109     style.setBoxShadow(nullptr);
1110 }
1111 
1112 bool RenderThemeWin::supportsMeter(ControlPart part) const
1113 {
1114     switch (part) {
1115     case MeterPart:
1116         return true;
1117     default:
1118         return false;
1119     }
1120 }
1121 
1122 IntSize RenderThemeWin::meterSizeForBounds(const RenderMeter&amp;, const IntRect&amp; bounds) const
1123 {
1124     return bounds.size();
1125 }
1126 
1127 bool RenderThemeWin::paintMeter(const RenderObject&amp; renderObject, const PaintInfo&amp; paintInfo, const IntRect&amp; rect)
</pre>
</td>
<td>
<hr />
<pre>
 665             if (o.style().appearance() == DefaultButtonPart) {
 666                 HBRUSH brush = ::GetSysColorBrush(COLOR_3DDKSHADOW);
 667                 ::FrameRect(hdc, &amp;widgetRect, brush);
 668                 ::InflateRect(&amp;widgetRect, -1, -1);
 669                 ::DrawEdge(hdc, &amp;widgetRect, BDR_RAISEDOUTER, BF_RECT | BF_MIDDLE);
 670             }
 671             ::DrawFrameControl(hdc, &amp;widgetRect, themeData.m_part, themeData.m_state);
 672         }
 673     }
 674 
 675     if (!alphaBlend &amp;&amp; !context.isInTransparencyLayer())
 676         DIBPixelData::setRGBABitmapAlpha(windowsContext.hdc(), r, 255);
 677 }
 678 
 679 bool RenderThemeWin::paintButton(const RenderObject&amp; o, const PaintInfo&amp; i, const IntRect&amp; r)
 680 {
 681     drawControl(i.context(),  o, buttonTheme(), getThemeData(o), r);
 682     return false;
 683 }
 684 
<span class="line-modified"> 685 void RenderThemeWin::adjustInnerSpinButtonStyle(RenderStyle&amp; style, const Element*) const</span>
 686 {
 687     int width = ::GetSystemMetrics(SM_CXVSCROLL);
 688     if (width &lt;= 0)
 689         width = 17; // Vista&#39;s default.
 690     style.setWidth(Length(width, Fixed));
 691     style.setMinWidth(Length(width, Fixed));
 692 }
 693 
 694 bool RenderThemeWin::paintInnerSpinButton(const RenderObject&amp; o, const PaintInfo&amp; i, const IntRect&amp; r)
 695 {
 696     // We split the specified rectangle into two vertically. We can&#39;t draw a
 697     // spin button of which height is less than 2px.
 698     if (r.height() &lt; 2)
 699         return false;
 700     IntRect upRect(r);
 701     upRect.setHeight(r.height() / 2);
 702     IntRect downRect(r);
 703     downRect.setY(upRect.maxY());
 704     downRect.setHeight(r.height() - upRect.height());
 705     drawControl(i.context(), o, spinButtonTheme(), getThemeData(o, SpinButtonUp), upRect);
</pre>
<hr />
<pre>
 729     return false;
 730 }
 731 
 732 bool RenderThemeWin::paintMenuList(const RenderObject&amp; renderer, const PaintInfo&amp; paintInfo, const FloatRect&amp; rect)
 733 {
 734     HANDLE theme;
 735     int part;
 736     if (haveTheme &amp;&amp; (windowsVersion() &gt;= WindowsVista)) {
 737         theme = menuListTheme();
 738         part = CP_READONLY;
 739     } else {
 740         theme = textFieldTheme();
 741         part = TFP_TEXTFIELD;
 742     }
 743 
 744     drawControl(paintInfo.context(), renderer, theme, ThemeData(part, determineState(renderer)), IntRect(rect));
 745 
 746     return paintMenuListButtonDecorations(downcast&lt;RenderBox&gt;(renderer), paintInfo, FloatRect(rect));
 747 }
 748 
<span class="line-modified"> 749 void RenderThemeWin::adjustMenuListStyle(RenderStyle&amp; style, const Element* e) const</span>
 750 {
 751     style.resetBorder();
<span class="line-modified"> 752     adjustMenuListButtonStyle(style, e);</span>
 753 }
 754 
<span class="line-modified"> 755 void RenderThemeWin::adjustMenuListButtonStyle(RenderStyle&amp; style, const Element*) const</span>
 756 {
 757     // These are the paddings needed to place the text correctly in the &lt;select&gt; box
 758     const int dropDownBoxPaddingTop    = 2;
 759     const int dropDownBoxPaddingRight  = style.direction() == TextDirection::LTR ? 4 + dropDownButtonWidth : 4;
 760     const int dropDownBoxPaddingBottom = 2;
 761     const int dropDownBoxPaddingLeft   = style.direction() == TextDirection::LTR ? 4 : 4 + dropDownButtonWidth;
 762     // The &lt;select&gt; box must be at least 12px high for the button to render nicely on Windows
 763     const int dropDownBoxMinHeight = 12;
 764 
 765     // Position the text correctly within the select box and make the box wide enough to fit the dropdown button
 766     style.setPaddingTop(Length(dropDownBoxPaddingTop, Fixed));
 767     style.setPaddingRight(Length(dropDownBoxPaddingRight, Fixed));
 768     style.setPaddingBottom(Length(dropDownBoxPaddingBottom, Fixed));
 769     style.setPaddingLeft(Length(dropDownBoxPaddingLeft, Fixed));
 770 
 771     // Height is locked to auto
 772     style.setHeight(Length(Auto));
 773 
 774     // Calculate our min-height
 775     int minHeight = style.fontMetrics().height();
</pre>
<hr />
<pre>
 839 {
 840     ControlPart part = style.appearance();
 841     if (part == SliderThumbVerticalPart) {
 842         style.setWidth(Length(sliderThumbHeight, Fixed));
 843         style.setHeight(Length(sliderThumbWidth, Fixed));
 844     } else if (part == SliderThumbHorizontalPart) {
 845         style.setWidth(Length(sliderThumbWidth, Fixed));
 846         style.setHeight(Length(sliderThumbHeight, Fixed));
 847     }
 848 #if ENABLE(VIDEO) &amp;&amp; USE(CG)
 849     else if (part == MediaSliderThumbPart || part == MediaVolumeSliderThumbPart)
 850         RenderMediaControls::adjustMediaSliderThumbSize(style);
 851 #endif
 852 }
 853 
 854 bool RenderThemeWin::paintSearchField(const RenderObject&amp; o, const PaintInfo&amp; i, const IntRect&amp; r)
 855 {
 856     return paintTextField(o, i, r);
 857 }
 858 
<span class="line-modified"> 859 void RenderThemeWin::adjustSearchFieldStyle(RenderStyle&amp; style, const Element* e) const</span>
 860 {
 861     // Override paddingSize to match AppKit text positioning.
 862     const int padding = 1;
 863     style.setPaddingLeft(Length(padding, Fixed));
 864     style.setPaddingRight(Length(padding, Fixed));
 865     style.setPaddingTop(Length(padding, Fixed));
 866     style.setPaddingBottom(Length(padding, Fixed));
 867     if (e &amp;&amp; e-&gt;focused() &amp;&amp; e-&gt;document().frame()-&gt;selection().isFocusedAndActive())
 868         style.setOutlineOffset(-2);
 869 }
 870 
 871 bool RenderThemeWin::paintSearchFieldCancelButton(const RenderBox&amp; o, const PaintInfo&amp; paintInfo, const IntRect&amp; r)
 872 {
 873     IntRect bounds = r;
 874     ASSERT(o.parent());
 875     if (!is&lt;RenderBox&gt;(o.parent()))
 876         return false;
 877 
 878     IntRect parentBox = downcast&lt;RenderBox&gt;(*o.parent()).absoluteContentBox();
 879 
 880     // Make sure the scaled button stays square and will fit in its parent&#39;s box
 881     bounds.setHeight(std::min(parentBox.width(), std::min(parentBox.height(), bounds.height())));
 882     bounds.setWidth(bounds.height());
 883 
 884     // Center the button vertically.  Round up though, so if it has to be one pixel off-center, it will
 885     // be one pixel closer to the bottom of the field.  This tends to look better with the text.
 886     bounds.setY(parentBox.y() + (parentBox.height() - bounds.height() + 1) / 2);
 887 
 888     static Image&amp; cancelImage = Image::loadPlatformResource(&quot;searchCancel&quot;).leakRef();
 889     static Image&amp; cancelPressedImage = Image::loadPlatformResource(&quot;searchCancelPressed&quot;).leakRef();
 890     paintInfo.context().drawImage(isPressed(o) ? cancelPressedImage : cancelImage, bounds);
 891     return false;
 892 }
 893 
<span class="line-modified"> 894 void RenderThemeWin::adjustSearchFieldCancelButtonStyle(RenderStyle&amp; style, const Element*) const</span>
 895 {
 896     // Scale the button size based on the font size
 897     float fontScale = style.computedFontPixelSize() / defaultControlFontPixelSize;
 898     int cancelButtonSize = lroundf(std::min(std::max(minCancelButtonSize, defaultCancelButtonSize * fontScale), maxCancelButtonSize));
 899     style.setWidth(Length(cancelButtonSize, Fixed));
 900     style.setHeight(Length(cancelButtonSize, Fixed));
 901 }
 902 
<span class="line-modified"> 903 void RenderThemeWin::adjustSearchFieldDecorationPartStyle(RenderStyle&amp; style, const Element*) const</span>
 904 {
 905     IntSize emptySize(1, 11);
 906     style.setWidth(Length(emptySize.width(), Fixed));
 907     style.setHeight(Length(emptySize.height(), Fixed));
 908 }
 909 
<span class="line-modified"> 910 void RenderThemeWin::adjustSearchFieldResultsDecorationPartStyle(RenderStyle&amp; style, const Element*) const</span>
 911 {
 912     // Scale the decoration size based on the font size
 913     float fontScale = style.computedFontPixelSize() / defaultControlFontPixelSize;
 914     int magnifierSize = lroundf(std::min(std::max(minSearchFieldResultsDecorationSize, defaultSearchFieldResultsDecorationSize * fontScale),
 915                                      maxSearchFieldResultsDecorationSize));
 916     style.setWidth(Length(magnifierSize, Fixed));
 917     style.setHeight(Length(magnifierSize, Fixed));
 918 }
 919 
 920 bool RenderThemeWin::paintSearchFieldResultsDecorationPart(const RenderBox&amp; o, const PaintInfo&amp; paintInfo, const IntRect&amp; r)
 921 {
 922     IntRect bounds = r;
 923     ASSERT(o.parent());
 924     if (!is&lt;RenderBox&gt;(o.parent()))
 925         return false;
 926 
 927     IntRect parentBox = downcast&lt;RenderBox&gt;(*o.parent()).absoluteContentBox();
 928 
 929     // Make sure the scaled decoration stays square and will fit in its parent&#39;s box
 930     bounds.setHeight(std::min(parentBox.width(), std::min(parentBox.height(), bounds.height())));
 931     bounds.setWidth(bounds.height());
 932 
 933     // Center the decoration vertically.  Round up though, so if it has to be one pixel off-center, it will
 934     // be one pixel closer to the bottom of the field.  This tends to look better with the text.
 935     bounds.setY(parentBox.y() + (parentBox.height() - bounds.height() + 1) / 2);
 936 
 937     static Image&amp; magnifierImage = Image::loadPlatformResource(&quot;searchMagnifier&quot;).leakRef();
 938     paintInfo.context().drawImage(magnifierImage, bounds);
 939     return false;
 940 }
 941 
<span class="line-modified"> 942 void RenderThemeWin::adjustSearchFieldResultsButtonStyle(RenderStyle&amp; style, const Element*) const</span>
 943 {
 944     // Scale the button size based on the font size
 945     float fontScale = style.computedFontPixelSize() / defaultControlFontPixelSize;
 946     int magnifierHeight = lroundf(std::min(std::max(minSearchFieldResultsDecorationSize, defaultSearchFieldResultsDecorationSize * fontScale),
 947                                    maxSearchFieldResultsDecorationSize));
 948     int magnifierWidth = lroundf(magnifierHeight * defaultSearchFieldResultsButtonWidth / defaultSearchFieldResultsDecorationSize);
 949     style.setWidth(Length(magnifierWidth, Fixed));
 950     style.setHeight(Length(magnifierHeight, Fixed));
 951 }
 952 
 953 bool RenderThemeWin::paintSearchFieldResultsButton(const RenderBox&amp; o, const PaintInfo&amp; paintInfo, const IntRect&amp; r)
 954 {
 955     IntRect bounds = r;
 956     ASSERT(o.parent());
 957     if (!o.parent())
 958         return false;
 959     if (!is&lt;RenderBox&gt;(o.parent()))
 960         return false;
 961 
 962     IntRect parentBox = downcast&lt;RenderBox&gt;(*o.parent()).absoluteContentBox();
</pre>
<hr />
<pre>
1087 #endif
1088 }
1089 
1090 String RenderThemeWin::mediaControlsScript()
1091 {
1092 #if ENABLE(MEDIA_CONTROLS_SCRIPT)
1093     if (m_mediaControlsScript.isEmpty()) {
1094         StringBuilder scriptBuilder;
1095         scriptBuilder.append(stringWithContentsOfFile(&quot;mediaControlsLocalizedStrings&quot;_s, &quot;js&quot;_s));
1096         scriptBuilder.append(stringWithContentsOfFile(&quot;mediaControlsApple&quot;_s, &quot;js&quot;_s));
1097         m_mediaControlsScript = scriptBuilder.toString();
1098     }
1099     return m_mediaControlsScript;
1100 #else
1101     return emptyString();
1102 #endif
1103 }
1104 #endif
1105 
1106 #if ENABLE(METER_ELEMENT)
<span class="line-modified">1107 void RenderThemeWin::adjustMeterStyle(RenderStyle&amp; style, const Element*) const</span>
1108 {
1109     style.setBoxShadow(nullptr);
1110 }
1111 
1112 bool RenderThemeWin::supportsMeter(ControlPart part) const
1113 {
1114     switch (part) {
1115     case MeterPart:
1116         return true;
1117     default:
1118         return false;
1119     }
1120 }
1121 
1122 IntSize RenderThemeWin::meterSizeForBounds(const RenderMeter&amp;, const IntRect&amp; bounds) const
1123 {
1124     return bounds.size();
1125 }
1126 
1127 bool RenderThemeWin::paintMeter(const RenderObject&amp; renderObject, const PaintInfo&amp; paintInfo, const IntRect&amp; rect)
</pre>
</td>
</tr>
</table>
<center><a href="RenderThemeMac.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="RenderThemeWin.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>