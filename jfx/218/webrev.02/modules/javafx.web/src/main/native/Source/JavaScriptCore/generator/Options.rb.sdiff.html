<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/generator/Options.rb</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Opcode.rb.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="Section.rb.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/generator/Options.rb</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  7 #    notice, this list of conditions and the following disclaimer.
  8 # 2. Redistributions in binary form must reproduce the above copyright
  9 #    notice, this list of conditions and the following disclaimer in the
 10 #    documentation and/or other materials provided with the distribution.
 11 #
 12 # THIS SOFTWARE IS PROVIDED BY APPLE INC. AND ITS CONTRIBUTORS ``AS IS&#39;&#39;
 13 # AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 14 # THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 15 # PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS
 16 # BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 17 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 18 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 19 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 20 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 21 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 22 # THE POSSIBILITY OF SUCH DAMAGE.
 23 
 24 require &#39;optparse&#39;
 25 
 26 $config = {
<span class="line-modified"> 27     bytecodesFilename: {</span>
 28         short: &quot;-b&quot;,
 29         long: &quot;--bytecodes_h FILE&quot;,
 30         desc: &quot;generate bytecodes macro .h FILE&quot;,
 31     },
<span class="line-modified"> 32     bytecodeStructsFilename: {</span>
 33         short: &quot;-s&quot;,
 34         long: &quot;--bytecode_structs_h FILE&quot;,
 35         desc: &quot;generate bytecode structs .h FILE&quot;,
 36     },
<span class="line-modified"> 37     initAsmFilename: {</span>
 38         short: &quot;-a&quot;,
 39         long: &quot;--init_bytecodes_asm FILE&quot;,
 40         desc: &quot;generate ASM bytecodes init FILE&quot;,
 41     },
<span class="line-modified"> 42     bytecodeIndicesFilename: {</span>
 43         short: &quot;-i&quot;,
 44         long: &quot;--bytecode_indices_h FILE&quot;,
 45         desc: &quot;generate indices of bytecode structs .h FILE&quot;,
 46     },
















 47 };
 48 
 49 module Options
 50     def self.optparser(options)
 51         OptionParser.new do |opts|
 52             opts.banner = &quot;usage: #{opts.program_name} [options] &lt;bytecode-list-file&gt;&quot;
 53             $config.map do |key, option|
<span class="line-modified"> 54                 opts.on(option[:short], option[:long], option[:desc]) do |v|</span>
 55                     options[key] = v
 56                 end
 57             end
 58         end
 59     end
 60 
 61     def self.check(argv, options)
 62         missing = $config.keys.select{ |param| options[param].nil? }
 63         unless missing.empty?
 64             raise OptionParser::MissingArgument.new(missing.join(&#39;, &#39;))
 65         end
 66         unless argv.length == 1
 67             raise OptionParser::MissingArgument.new(&quot;&lt;bytecode-list-file&gt;&quot;)
 68         end
 69     end
 70 
 71     def self.parse(argv)
 72         options = {}
 73         parser = optparser(options)
 74 
 75         begin
 76             parser.parse!(argv)
 77             check(argv, options)
 78         rescue OptionParser::MissingArgument, OptionParser::InvalidOption
 79             puts $!.to_s
 80             puts parser
 81             exit 1
 82         end
 83 
<span class="line-modified"> 84         options[:bytecodeList] = argv[0]</span>
 85         options
 86     end
 87 end
</pre>
</td>
<td>
<hr />
<pre>
  7 #    notice, this list of conditions and the following disclaimer.
  8 # 2. Redistributions in binary form must reproduce the above copyright
  9 #    notice, this list of conditions and the following disclaimer in the
 10 #    documentation and/or other materials provided with the distribution.
 11 #
 12 # THIS SOFTWARE IS PROVIDED BY APPLE INC. AND ITS CONTRIBUTORS ``AS IS&#39;&#39;
 13 # AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 14 # THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 15 # PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS
 16 # BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 17 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 18 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 19 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 20 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 21 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 22 # THE POSSIBILITY OF SUCH DAMAGE.
 23 
 24 require &#39;optparse&#39;
 25 
 26 $config = {
<span class="line-modified"> 27     bytecodes_filename: {</span>
 28         short: &quot;-b&quot;,
 29         long: &quot;--bytecodes_h FILE&quot;,
 30         desc: &quot;generate bytecodes macro .h FILE&quot;,
 31     },
<span class="line-modified"> 32     bytecode_structs_filename: {</span>
 33         short: &quot;-s&quot;,
 34         long: &quot;--bytecode_structs_h FILE&quot;,
 35         desc: &quot;generate bytecode structs .h FILE&quot;,
 36     },
<span class="line-modified"> 37     init_asm_filename: {</span>
 38         short: &quot;-a&quot;,
 39         long: &quot;--init_bytecodes_asm FILE&quot;,
 40         desc: &quot;generate ASM bytecodes init FILE&quot;,
 41     },
<span class="line-modified"> 42     bytecode_indices_filename: {</span>
 43         short: &quot;-i&quot;,
 44         long: &quot;--bytecode_indices_h FILE&quot;,
 45         desc: &quot;generate indices of bytecode structs .h FILE&quot;,
 46     },
<span class="line-added"> 47     wasm_json_filename: {</span>
<span class="line-added"> 48         long: &quot;--wasm_json FILE&quot;,</span>
<span class="line-added"> 49         desc: &quot;Path to JavaScriptCore&#39;s wasm.json file&quot;,</span>
<span class="line-added"> 50     },</span>
<span class="line-added"> 51     wasm_llint_generator_filename: {</span>
<span class="line-added"> 52         long: &quot;--wasm_llint_generator_h FILE&quot;,</span>
<span class="line-added"> 53         desc: &quot;Path to generate WasmLLIntGenerator entries from wasm.json file&quot;,</span>
<span class="line-added"> 54     },</span>
<span class="line-added"> 55     wasm_init_filename: {</span>
<span class="line-added"> 56         long: &quot;--init_wasm_llint FILE&quot;,</span>
<span class="line-added"> 57         desc: &quot;generate Wasm bytecodes init FILE&quot;,</span>
<span class="line-added"> 58     },</span>
<span class="line-added"> 59     bytecode_dumper_filename: {</span>
<span class="line-added"> 60         long: &quot;--bytecode_dumper FILE&quot;,</span>
<span class="line-added"> 61         desc: &quot;generate bytecode dumper FILE&quot;,</span>
<span class="line-added"> 62     },</span>
 63 };
 64 
 65 module Options
 66     def self.optparser(options)
 67         OptionParser.new do |opts|
 68             opts.banner = &quot;usage: #{opts.program_name} [options] &lt;bytecode-list-file&gt;&quot;
 69             $config.map do |key, option|
<span class="line-modified"> 70                 opts.on(*option.values) do |v|</span>
 71                     options[key] = v
 72                 end
 73             end
 74         end
 75     end
 76 
 77     def self.check(argv, options)
 78         missing = $config.keys.select{ |param| options[param].nil? }
 79         unless missing.empty?
 80             raise OptionParser::MissingArgument.new(missing.join(&#39;, &#39;))
 81         end
 82         unless argv.length == 1
 83             raise OptionParser::MissingArgument.new(&quot;&lt;bytecode-list-file&gt;&quot;)
 84         end
 85     end
 86 
 87     def self.parse(argv)
 88         options = {}
 89         parser = optparser(options)
 90 
 91         begin
 92             parser.parse!(argv)
 93             check(argv, options)
 94         rescue OptionParser::MissingArgument, OptionParser::InvalidOption
 95             puts $!.to_s
 96             puts parser
 97             exit 1
 98         end
 99 
<span class="line-modified">100         options[:bytecode_list] = argv[0]</span>
101         options
102     end
103 end
</pre>
</td>
</tr>
</table>
<center><a href="Opcode.rb.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="Section.rb.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>