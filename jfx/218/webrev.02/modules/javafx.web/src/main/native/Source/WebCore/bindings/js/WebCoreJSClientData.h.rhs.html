<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/WebCore/bindings/js/WebCoreJSClientData.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  *  Copyright (C) 1999-2001 Harri Porten (porten@kde.org)
  3  *  Copyright (C) 2003-2017 Apple Inc. All rights reserved.
  4  *  Copyright (C) 2007 Samuel Weinig &lt;sam@webkit.org&gt;
  5  *  Copyright (C) 2009 Google, Inc. All rights reserved.
  6  *
  7  *  This library is free software; you can redistribute it and/or
  8  *  modify it under the terms of the GNU Lesser General Public
  9  *  License as published by the Free Software Foundation; either
 10  *  version 2 of the License, or (at your option) any later version.
 11  *
 12  *  This library is distributed in the hope that it will be useful,
 13  *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 14  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 15  *  Lesser General Public License for more details.
 16  *
 17  *  You should have received a copy of the GNU Lesser General Public
 18  *  License along with this library; if not, write to the Free Software
 19  *  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 20  */
 21 
 22 #pragma once
 23 
 24 #include &quot;DOMWrapperWorld.h&quot;
 25 #include &quot;WebCoreBuiltinNames.h&quot;
 26 #include &quot;WebCoreJSBuiltins.h&quot;
 27 #include &lt;wtf/HashSet.h&gt;
 28 #include &lt;wtf/RefPtr.h&gt;
 29 
 30 namespace WebCore {
 31 
 32 class JSVMClientData : public JSC::VM::ClientData {
 33     WTF_MAKE_NONCOPYABLE(JSVMClientData); WTF_MAKE_FAST_ALLOCATED;
 34     friend class VMWorldIterator;
 35 
 36 public:
 37     explicit JSVMClientData(JSC::VM&amp;);
 38 
 39     virtual ~JSVMClientData();
 40 
 41     WEBCORE_EXPORT static void initNormalWorld(JSC::VM*);
 42 
 43     DOMWrapperWorld&amp; normalWorld() { return *m_normalWorld; }
 44 
 45     void getAllWorlds(Vector&lt;Ref&lt;DOMWrapperWorld&gt;&gt;&amp;);
 46 
 47     void rememberWorld(DOMWrapperWorld&amp; world)
 48     {
 49         ASSERT(!m_worldSet.contains(&amp;world));
 50         m_worldSet.add(&amp;world);
 51     }
 52 
 53     void forgetWorld(DOMWrapperWorld&amp; world)
 54     {
 55         ASSERT(m_worldSet.contains(&amp;world));
 56         m_worldSet.remove(&amp;world);
 57     }
 58 
 59     WebCoreBuiltinNames&amp; builtinNames() { return m_builtinNames; }
 60     JSBuiltinFunctions&amp; builtinFunctions() { return m_builtinFunctions; }
 61 
<a name="1" id="anc1"></a><span class="line-added"> 62     JSC::IsoSubspace&amp; domBuiltinConstructorSpace() { return m_domBuiltinConstructorSpace; }</span>
<span class="line-added"> 63     JSC::IsoSubspace&amp; domConstructorSpace() { return m_domConstructorSpace; }</span>
<span class="line-added"> 64     JSC::IsoSubspace&amp; domWindowPropertiesSpace() { return m_domWindowPropertiesSpace; }</span>
<span class="line-added"> 65     JSC::IsoSubspace&amp; runtimeArraySpace() { return m_runtimeArraySpace; }</span>
 66     JSC::IsoSubspace&amp; runtimeMethodSpace() { return m_runtimeMethodSpace; }
<a name="2" id="anc2"></a><span class="line-added"> 67     JSC::IsoSubspace&amp; runtimeObjectSpace() { return m_runtimeObjectSpace; }</span>
<span class="line-added"> 68     JSC::IsoSubspace&amp; windowProxySpace() { return m_windowProxySpace; }</span>
 69 
 70     JSC::CompleteSubspace&amp; outputConstraintSpace() { return m_outputConstraintSpace; }
<a name="3" id="anc3"></a><span class="line-modified"> 71 </span>
<span class="line-added"> 72     JSC::IsoSubspace&amp; subspaceForJSDOMWindow() { return m_subspaceForJSDOMWindow; }</span>
<span class="line-added"> 73     JSC::IsoSubspace&amp; subspaceForJSDedicatedWorkerGlobalScope() { return m_subspaceForJSDedicatedWorkerGlobalScope; }</span>
<span class="line-added"> 74     JSC::IsoSubspace&amp; subspaceForJSRemoteDOMWindow() { return m_subspaceForJSRemoteDOMWindow; }</span>
<span class="line-added"> 75     JSC::IsoSubspace&amp; subspaceForJSWorkerGlobalScope() { return m_subspaceForJSWorkerGlobalScope; }</span>
<span class="line-added"> 76 #if ENABLE(SERVICE_WORKER)</span>
<span class="line-added"> 77     JSC::IsoSubspace&amp; subspaceForJSServiceWorkerGlobalScope() { return m_subspaceForJSServiceWorkerGlobalScope; }</span>
<span class="line-added"> 78 #endif</span>
<span class="line-added"> 79 #if ENABLE(CSS_PAINTING_API)</span>
<span class="line-added"> 80     JSC::IsoSubspace&amp; subspaceForJSPaintWorkletGlobalScope() { return m_subspaceForJSPaintWorkletGlobalScope; }</span>
<span class="line-added"> 81     JSC::IsoSubspace&amp; subspaceForJSWorkletGlobalScope() { return m_subspaceForJSWorkletGlobalScope; }</span>
<span class="line-added"> 82 #endif</span>
 83 
 84     template&lt;typename Func&gt;
 85     void forEachOutputConstraintSpace(const Func&amp; func)
 86     {
 87         func(m_outputConstraintSpace);
<a name="4" id="anc4"></a><span class="line-modified"> 88         func(m_subspaceForJSDOMWindow);</span>
<span class="line-added"> 89         func(m_subspaceForJSDedicatedWorkerGlobalScope);</span>
<span class="line-added"> 90         func(m_subspaceForJSRemoteDOMWindow);</span>
<span class="line-added"> 91         func(m_subspaceForJSWorkerGlobalScope);</span>
<span class="line-added"> 92 #if ENABLE(SERVICE_WORKER)</span>
<span class="line-added"> 93         func(m_subspaceForJSServiceWorkerGlobalScope);</span>
<span class="line-added"> 94 #endif</span>
<span class="line-added"> 95 #if ENABLE(CSS_PAINTING_API)</span>
<span class="line-added"> 96         func(m_subspaceForJSPaintWorkletGlobalScope);</span>
<span class="line-added"> 97         func(m_subspaceForJSWorkletGlobalScope);</span>
<span class="line-added"> 98 #endif</span>
 99     }
100 
101 private:
102     HashSet&lt;DOMWrapperWorld*&gt; m_worldSet;
103     RefPtr&lt;DOMWrapperWorld&gt; m_normalWorld;
104 
105     JSBuiltinFunctions m_builtinFunctions;
106     WebCoreBuiltinNames m_builtinNames;
107 
<a name="5" id="anc5"></a><span class="line-added">108     std::unique_ptr&lt;JSC::HeapCellType&gt; m_runtimeArrayHeapCellType;</span>
<span class="line-added">109     std::unique_ptr&lt;JSC::HeapCellType&gt; m_runtimeObjectHeapCellType;</span>
<span class="line-added">110     std::unique_ptr&lt;JSC::HeapCellType&gt; m_windowProxyHeapCellType;</span>
<span class="line-added">111 </span>
<span class="line-added">112     std::unique_ptr&lt;JSC::HeapCellType&gt; m_heapCellTypeForJSDOMWindow;</span>
<span class="line-added">113     std::unique_ptr&lt;JSC::HeapCellType&gt; m_heapCellTypeForJSDedicatedWorkerGlobalScope;</span>
<span class="line-added">114     std::unique_ptr&lt;JSC::HeapCellType&gt; m_heapCellTypeForJSRemoteDOMWindow;</span>
<span class="line-added">115     std::unique_ptr&lt;JSC::HeapCellType&gt; m_heapCellTypeForJSWorkerGlobalScope;</span>
<span class="line-added">116 #if ENABLE(SERVICE_WORKER)</span>
<span class="line-added">117     std::unique_ptr&lt;JSC::HeapCellType&gt; m_heapCellTypeForJSServiceWorkerGlobalScope;</span>
<span class="line-added">118 #endif</span>
<span class="line-added">119 #if ENABLE(CSS_PAINTING_API)</span>
<span class="line-added">120     std::unique_ptr&lt;JSC::HeapCellType&gt; m_heapCellTypeForJSPaintWorkletGlobalScope;</span>
<span class="line-added">121     std::unique_ptr&lt;JSC::HeapCellType&gt; m_heapCellTypeForJSWorkletGlobalScope;</span>
<span class="line-added">122 #endif</span>
<span class="line-added">123 </span>
<span class="line-added">124     JSC::IsoSubspace m_domBuiltinConstructorSpace;</span>
<span class="line-added">125     JSC::IsoSubspace m_domConstructorSpace;</span>
<span class="line-added">126     JSC::IsoSubspace m_domWindowPropertiesSpace;</span>
<span class="line-added">127     JSC::IsoSubspace m_runtimeArraySpace;</span>
128     JSC::IsoSubspace m_runtimeMethodSpace;
<a name="6" id="anc6"></a><span class="line-added">129     JSC::IsoSubspace m_runtimeObjectSpace;</span>
<span class="line-added">130     JSC::IsoSubspace m_windowProxySpace;</span>
<span class="line-added">131 </span>
<span class="line-added">132     JSC::IsoSubspace m_subspaceForJSDOMWindow;</span>
<span class="line-added">133     JSC::IsoSubspace m_subspaceForJSDedicatedWorkerGlobalScope;</span>
<span class="line-added">134     JSC::IsoSubspace m_subspaceForJSRemoteDOMWindow;</span>
<span class="line-added">135     JSC::IsoSubspace m_subspaceForJSWorkerGlobalScope;</span>
<span class="line-added">136 #if ENABLE(SERVICE_WORKER)</span>
<span class="line-added">137     JSC::IsoSubspace m_subspaceForJSServiceWorkerGlobalScope;</span>
<span class="line-added">138 #endif</span>
<span class="line-added">139 #if ENABLE(CSS_PAINTING_API)</span>
<span class="line-added">140     JSC::IsoSubspace m_subspaceForJSPaintWorkletGlobalScope;</span>
<span class="line-added">141     JSC::IsoSubspace m_subspaceForJSWorkletGlobalScope;</span>
<span class="line-added">142 #endif</span>
143 
144     JSC::CompleteSubspace m_outputConstraintSpace;
<a name="7" id="anc7"></a>
145 };
146 
147 } // namespace WebCore
<a name="8" id="anc8"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="8" type="hidden" />
</body>
</html>