<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/JSTypedArrayViewPrototype.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="JSTypedArrayViewConstructor.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="JSTypedArrayViewPrototype.h.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/JSTypedArrayViewPrototype.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -27,255 +27,286 @@</span>
  #include &quot;JSTypedArrayViewPrototype.h&quot;
  
  #include &quot;BuiltinNames.h&quot;
  #include &quot;CallFrame.h&quot;
  #include &quot;GetterSetter.h&quot;
<span class="udiff-line-added">+ #include &quot;JSArrayIterator.h&quot;</span>
  #include &quot;JSCInlines.h&quot;
  #include &quot;JSFunction.h&quot;
  #include &quot;JSGenericTypedArrayViewPrototypeFunctions.h&quot;
  #include &quot;JSObjectInlines.h&quot;
  #include &quot;TypedArrayAdaptors.h&quot;
  
  namespace JSC {
  
  #define CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(functionName) do {                           \
<span class="udiff-line-modified-removed">-     switch (thisValue.getObject()-&gt;classInfo(vm)-&gt;typedArrayStorageType) {                        \</span>
<span class="udiff-line-modified-added">+     switch (thisValue.getObject()-&gt;classInfo(vm)-&gt;typedArrayStorageType) {                      \</span>
      case TypeUint8Clamped:                                                                      \
<span class="udiff-line-modified-removed">-         return functionName&lt;JSUint8ClampedArray&gt;(vm, exec);                                     \</span>
<span class="udiff-line-modified-added">+         return functionName&lt;JSUint8ClampedArray&gt;(vm, globalObject, callFrame);                  \</span>
      case TypeInt32:                                                                             \
<span class="udiff-line-modified-removed">-         return functionName&lt;JSInt32Array&gt;(vm, exec);                                            \</span>
<span class="udiff-line-modified-added">+         return functionName&lt;JSInt32Array&gt;(vm, globalObject, callFrame);                         \</span>
      case TypeUint32:                                                                            \
<span class="udiff-line-modified-removed">-         return functionName&lt;JSUint32Array&gt;(vm, exec);                                           \</span>
<span class="udiff-line-modified-added">+         return functionName&lt;JSUint32Array&gt;(vm, globalObject, callFrame);                        \</span>
      case TypeFloat64:                                                                           \
<span class="udiff-line-modified-removed">-         return functionName&lt;JSFloat64Array&gt;(vm, exec);                                          \</span>
<span class="udiff-line-modified-added">+         return functionName&lt;JSFloat64Array&gt;(vm, globalObject, callFrame);                       \</span>
      case TypeFloat32:                                                                           \
<span class="udiff-line-modified-removed">-         return functionName&lt;JSFloat32Array&gt;(vm, exec);                                          \</span>
<span class="udiff-line-modified-added">+         return functionName&lt;JSFloat32Array&gt;(vm, globalObject, callFrame);                       \</span>
      case TypeInt8:                                                                              \
<span class="udiff-line-modified-removed">-         return functionName&lt;JSInt8Array&gt;(vm, exec);                                             \</span>
<span class="udiff-line-modified-added">+         return functionName&lt;JSInt8Array&gt;(vm, globalObject, callFrame);                          \</span>
      case TypeUint8:                                                                             \
<span class="udiff-line-modified-removed">-         return functionName&lt;JSUint8Array&gt;(vm, exec);                                            \</span>
<span class="udiff-line-modified-added">+         return functionName&lt;JSUint8Array&gt;(vm, globalObject, callFrame);                         \</span>
      case TypeInt16:                                                                             \
<span class="udiff-line-modified-removed">-         return functionName&lt;JSInt16Array&gt;(vm, exec);                                            \</span>
<span class="udiff-line-modified-added">+         return functionName&lt;JSInt16Array&gt;(vm, globalObject, callFrame);                         \</span>
      case TypeUint16:                                                                            \
<span class="udiff-line-modified-removed">-         return functionName&lt;JSUint16Array&gt;(vm, exec);                                           \</span>
<span class="udiff-line-modified-added">+         return functionName&lt;JSUint16Array&gt;(vm, globalObject, callFrame);                        \</span>
      case NotTypedArray:                                                                         \
      case TypeDataView:                                                                          \
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope,                                                    \</span>
<span class="udiff-line-modified-removed">-             &quot;Receiver should be a typed array view&quot;_s);                             \</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope,                                            \</span>
<span class="udiff-line-modified-added">+             &quot;Receiver should be a typed array view&quot;_s);                                         \</span>
      }                                                                                           \
      RELEASE_ASSERT_NOT_REACHED();                                                               \
  } while (false)
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncIsTypedArrayView(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncIsTypedArrayView(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     JSValue value = exec-&gt;uncheckedArgument(0);</span>
<span class="udiff-line-modified-removed">-     return JSValue::encode(jsBoolean(value.isCell() &amp;&amp; isTypedView(value.asCell()-&gt;classInfo(exec-&gt;vm())-&gt;typedArrayStorageType)));</span>
<span class="udiff-line-modified-added">+     JSValue value = callFrame-&gt;uncheckedArgument(0);</span>
<span class="udiff-line-modified-added">+     return JSValue::encode(jsBoolean(value.isCell() &amp;&amp; isTypedView(value.asCell()-&gt;classInfo(globalObject-&gt;vm())-&gt;typedArrayStorageType)));</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncLength(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncLength(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue argument = exec-&gt;argument(0);</span>
<span class="udiff-line-modified-added">+     JSValue argument = callFrame-&gt;argument(0);</span>
      if (!argument.isCell() || !isTypedView(argument.asCell()-&gt;classInfo(vm)-&gt;typedArrayStorageType))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Receiver should be a typed array view&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view&quot;_s);</span>
  
      JSArrayBufferView* thisObject = jsCast&lt;JSArrayBufferView*&gt;(argument);
  
      if (thisObject-&gt;isNeutered())
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Underlying ArrayBuffer has been detached from the view&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Underlying ArrayBuffer has been detached from the view&quot;_s);</span>
  
      return JSValue::encode(jsNumber(thisObject-&gt;length()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncGetOriginalConstructor(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncGetOriginalConstructor(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-removed">-     JSGlobalObject* globalObject = exec-&gt;lexicalGlobalObject();</span>
<span class="udiff-line-removed">-     TypedArrayType type = exec-&gt;uncheckedArgument(0).getObject()-&gt;classInfo(vm)-&gt;typedArrayStorageType;</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
<span class="udiff-line-modified-added">+     TypedArrayType type = callFrame-&gt;uncheckedArgument(0).getObject()-&gt;classInfo(vm)-&gt;typedArrayStorageType;</span>
      ASSERT(isTypedView(type));
      return JSValue::encode(globalObject-&gt;typedArrayConstructor(type));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncSort(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ inline EncodedJSValue createTypedArrayIteratorObject(JSGlobalObject* globalObject, CallFrame* callFrame, IterationKind kind)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;argument(0);</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-added">+     if (!callFrame-&gt;thisValue().isCell() || !isTypedArrayType(callFrame-&gt;thisValue().asCell()-&gt;type()))</span>
<span class="udiff-line-added">+         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view&quot;_s);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     JSArrayBufferView* thisObject = jsCast&lt;JSArrayBufferView*&gt;(callFrame-&gt;thisValue());</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     if (thisObject-&gt;isNeutered())</span>
<span class="udiff-line-added">+         return throwVMTypeError(globalObject, scope, &quot;Underlying ArrayBuffer has been detached from the view&quot;_s);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     return JSValue::encode(JSArrayIterator::create(vm, globalObject-&gt;arrayIteratorStructure(), thisObject, jsNumber(static_cast&lt;unsigned&gt;(kind))));</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncValues(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     return createTypedArrayIteratorObject(globalObject, callFrame, IterationKind::Values);</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayProtoViewFuncEntries(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     return createTypedArrayIteratorObject(globalObject, callFrame, IterationKind::Entries);</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncKeys(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     return createTypedArrayIteratorObject(globalObject, callFrame, IterationKind::Keys);</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncSort(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
<span class="udiff-line-added">+     auto scope = DECLARE_THROW_SCOPE(vm);</span>
<span class="udiff-line-added">+     JSValue thisValue = callFrame-&gt;argument(0);</span>
      scope.release();
      CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewPrivateFuncSort);
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncSet(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncSet(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (UNLIKELY(!thisValue.isObject()))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
      scope.release();
      CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncSet);
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncCopyWithin(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncCopyWithin(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (!thisValue.isObject())
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
      scope.release();
      CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncCopyWithin);
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncIncludes(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncIncludes(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (!thisValue.isObject())
<span class="udiff-line-modified-removed">-         return throwVMError(exec, scope, createTypeError(exec, &quot;Receiver should be a typed array view but was not an object&quot;));</span>
<span class="udiff-line-modified-added">+         return throwVMError(globalObject, scope, createTypeError(globalObject, &quot;Receiver should be a typed array view but was not an object&quot;));</span>
      scope.release();
      CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncIncludes);
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncLastIndexOf(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncLastIndexOf(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (!thisValue.isObject())
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
      scope.release();
      CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncLastIndexOf);
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncIndexOf(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncIndexOf(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (!thisValue.isObject())
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
      scope.release();
      CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncIndexOf);
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncJoin(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncJoin(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (!thisValue.isObject())
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
      scope.release();
      CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncJoin);
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncBuffer(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncBuffer(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (!thisValue.isObject())
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
      scope.release();
      CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoGetterFuncBuffer);
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncLength(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncLength(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (!thisValue.isObject())
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
      scope.release();
      CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoGetterFuncLength);
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncByteLength(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncByteLength(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (!thisValue.isObject())
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
      scope.release();
      CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoGetterFuncByteLength);
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncByteOffset(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncByteOffset(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (!thisValue.isObject())
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
      scope.release();
      CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoGetterFuncByteOffset);
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncReverse(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncReverse(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (!thisValue.isObject())
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
      scope.release();
      CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncReverse);
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncSubarrayCreate(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncSubarrayCreate(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (!thisValue.isObject())
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
      scope.release();
      CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewPrivateFuncSubarrayCreate);
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncSlice(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncSlice(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (!thisValue.isObject())
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);</span>
      scope.release();
      CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncSlice);
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncToStringTag(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncToStringTag(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (!thisValue.isObject())
          return JSValue::encode(jsUndefined());
  
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      switch (thisValue.getObject()-&gt;classInfo(vm)-&gt;typedArrayStorageType) {
      case TypeUint8Clamped:
<span class="udiff-line-modified-removed">-         return JSValue::encode(jsString(vm, &quot;Uint8ClampedArray&quot;));</span>
<span class="udiff-line-modified-added">+         return JSValue::encode(jsNontrivialString(vm, &quot;Uint8ClampedArray&quot;_s));</span>
      case TypeInt32:
<span class="udiff-line-modified-removed">-         return JSValue::encode(jsString(vm, &quot;Int32Array&quot;));</span>
<span class="udiff-line-modified-added">+         return JSValue::encode(jsNontrivialString(vm, &quot;Int32Array&quot;_s));</span>
      case TypeUint32:
<span class="udiff-line-modified-removed">-         return JSValue::encode(jsString(vm, &quot;Uint32Array&quot;));</span>
<span class="udiff-line-modified-added">+         return JSValue::encode(jsNontrivialString(vm, &quot;Uint32Array&quot;_s));</span>
      case TypeFloat64:
<span class="udiff-line-modified-removed">-         return JSValue::encode(jsString(vm, &quot;Float64Array&quot;));</span>
<span class="udiff-line-modified-added">+         return JSValue::encode(jsNontrivialString(vm, &quot;Float64Array&quot;_s));</span>
      case TypeFloat32:
<span class="udiff-line-modified-removed">-         return JSValue::encode(jsString(vm, &quot;Float32Array&quot;));</span>
<span class="udiff-line-modified-added">+         return JSValue::encode(jsNontrivialString(vm, &quot;Float32Array&quot;_s));</span>
      case TypeInt8:
<span class="udiff-line-modified-removed">-         return JSValue::encode(jsString(vm, &quot;Int8Array&quot;));</span>
<span class="udiff-line-modified-added">+         return JSValue::encode(jsNontrivialString(vm, &quot;Int8Array&quot;_s));</span>
      case TypeUint8:
<span class="udiff-line-modified-removed">-         return JSValue::encode(jsString(vm, &quot;Uint8Array&quot;));</span>
<span class="udiff-line-modified-added">+         return JSValue::encode(jsNontrivialString(vm, &quot;Uint8Array&quot;_s));</span>
      case TypeInt16:
<span class="udiff-line-modified-removed">-         return JSValue::encode(jsString(vm, &quot;Int16Array&quot;));</span>
<span class="udiff-line-modified-added">+         return JSValue::encode(jsNontrivialString(vm, &quot;Int16Array&quot;_s));</span>
      case TypeUint16:
<span class="udiff-line-modified-removed">-         return JSValue::encode(jsString(vm, &quot;Uint16Array&quot;));</span>
<span class="udiff-line-modified-added">+         return JSValue::encode(jsNontrivialString(vm, &quot;Uint16Array&quot;_s));</span>
      case NotTypedArray:
      case TypeDataView:
          return JSValue::encode(jsUndefined());
      }
      RELEASE_ASSERT_NOT_REACHED();
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -302,19 +333,19 @@</span>
      JSC_NATIVE_INTRINSIC_GETTER_WITHOUT_TRANSITION(vm.propertyNames-&gt;byteOffset, typedArrayViewProtoGetterFuncByteOffset, PropertyAttribute::DontEnum | PropertyAttribute::ReadOnly, TypedArrayByteOffsetIntrinsic);
      JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;copyWithin&quot;, typedArrayViewProtoFuncCopyWithin, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 2);
      JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;every&quot;, typedArrayPrototypeEveryCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
      JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;filter&quot;, typedArrayPrototypeFilterCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
      JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;sort&quot;, typedArrayPrototypeSortCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
<span class="udiff-line-modified-removed">-     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;builtinNames().entriesPublicName(), typedArrayPrototypeEntriesCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));</span>
<span class="udiff-line-modified-added">+     JSC_NATIVE_INTRINSIC_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;entries, typedArrayProtoViewFuncEntries, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 0, TypedArrayEntriesIntrinsic);</span>
      JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;includes&quot;, typedArrayViewProtoFuncIncludes, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 1);
      JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;fill&quot;, typedArrayPrototypeFillCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
      JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;find&quot;, typedArrayPrototypeFindCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
      JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;findIndex&quot;, typedArrayPrototypeFindIndexCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
      JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;forEach, typedArrayPrototypeForEachCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
      JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;indexOf&quot;, typedArrayViewProtoFuncIndexOf, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 1);
      JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;join, typedArrayViewProtoFuncJoin, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 1);
<span class="udiff-line-modified-removed">-     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;builtinNames().keysPublicName(), typedArrayPrototypeKeysCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));</span>
<span class="udiff-line-modified-added">+     JSC_NATIVE_INTRINSIC_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;keys, typedArrayViewProtoFuncKeys, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 0, TypedArrayKeysIntrinsic);</span>
      JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;lastIndexOf&quot;, typedArrayViewProtoFuncLastIndexOf, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 1);
      JSC_NATIVE_INTRINSIC_GETTER_WITHOUT_TRANSITION(vm.propertyNames-&gt;length, typedArrayViewProtoGetterFuncLength, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum) | PropertyAttribute::ReadOnly, TypedArrayLengthIntrinsic);
      JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;map&quot;, typedArrayPrototypeMapCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
      JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;reduce&quot;, typedArrayPrototypeReduceCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
      JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;reduceRight&quot;, typedArrayPrototypeReduceRightCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -327,11 +358,11 @@</span>
  
      JSFunction* toStringTagFunction = JSFunction::create(vm, globalObject, 0, &quot;get [Symbol.toStringTag]&quot;_s, typedArrayViewProtoGetterFuncToStringTag, NoIntrinsic);
      GetterSetter* toStringTagAccessor = GetterSetter::create(vm, globalObject, toStringTagFunction, nullptr);
      putDirectNonIndexAccessorWithoutTransition(vm, vm.propertyNames-&gt;toStringTagSymbol, toStringTagAccessor, PropertyAttribute::DontEnum | PropertyAttribute::ReadOnly | PropertyAttribute::Accessor);
  
<span class="udiff-line-modified-removed">-     JSFunction* valuesFunction = JSFunction::create(vm, typedArrayPrototypeValuesCodeGenerator(vm), globalObject);</span>
<span class="udiff-line-modified-added">+     JSFunction* valuesFunction = JSFunction::create(vm, globalObject, 0, vm.propertyNames-&gt;values.string(), typedArrayViewProtoFuncValues, TypedArrayValuesIntrinsic);</span>
  
      putDirectWithoutTransition(vm, vm.propertyNames-&gt;builtinNames().valuesPublicName(), valuesFunction, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
      putDirectWithoutTransition(vm, vm.propertyNames-&gt;iteratorSymbol, valuesFunction, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
  
  }
</pre>
<center><a href="JSTypedArrayViewConstructor.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="JSTypedArrayViewPrototype.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>