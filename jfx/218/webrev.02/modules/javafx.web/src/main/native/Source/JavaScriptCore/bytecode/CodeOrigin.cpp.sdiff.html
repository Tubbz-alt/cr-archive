<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/bytecode/CodeOrigin.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="CodeBlockHash.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CodeOrigin.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/bytecode/CodeOrigin.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 74             return true;
 75 
 76         if (aInlineCallFrame-&gt;baselineCodeBlock.get() != bInlineCallFrame-&gt;baselineCodeBlock.get())
 77             return false;
 78 
 79         a = aInlineCallFrame-&gt;directCaller;
 80         b = bInlineCallFrame-&gt;directCaller;
 81     }
 82 }
 83 
 84 unsigned CodeOrigin::approximateHash(InlineCallFrame* terminal) const
 85 {
 86     if (!isSet())
 87         return 0;
 88     if (isHashTableDeletedValue())
 89         return 1;
 90 
 91     unsigned result = 2;
 92     CodeOrigin codeOrigin = *this;
 93     for (;;) {
<span class="line-modified"> 94         result += codeOrigin.bytecodeIndex();</span>
 95 
 96         auto* inlineCallFrame = codeOrigin.inlineCallFrame();
 97 
 98         if (!inlineCallFrame)
 99             return result;
100 
101         if (inlineCallFrame == terminal)
102             return result;
103 
104         result += WTF::PtrHash&lt;JSCell*&gt;::hash(inlineCallFrame-&gt;baselineCodeBlock.get());
105 
106         codeOrigin = inlineCallFrame-&gt;directCaller;
107     }
108 }
109 
110 Vector&lt;CodeOrigin&gt; CodeOrigin::inlineStack() const
111 {
112     Vector&lt;CodeOrigin&gt; result(inlineDepth());
113     result.last() = *this;
114     unsigned index = result.size() - 2;
</pre>
<hr />
<pre>
135 }
136 
137 void CodeOrigin::dump(PrintStream&amp; out) const
138 {
139     if (!isSet()) {
140         out.print(&quot;&lt;none&gt;&quot;);
141         return;
142     }
143 
144     Vector&lt;CodeOrigin&gt; stack = inlineStack();
145     for (unsigned i = 0; i &lt; stack.size(); ++i) {
146         if (i)
147             out.print(&quot; --&gt; &quot;);
148 
149         if (InlineCallFrame* frame = stack[i].inlineCallFrame()) {
150             out.print(frame-&gt;briefFunctionInformation(), &quot;:&lt;&quot;, RawPointer(frame-&gt;baselineCodeBlock.get()), &quot;&gt; &quot;);
151             if (frame-&gt;isClosureCall)
152                 out.print(&quot;(closure) &quot;);
153         }
154 
<span class="line-modified">155         out.print(&quot;bc#&quot;, stack[i].bytecodeIndex());</span>
156     }
157 }
158 
159 void CodeOrigin::dumpInContext(PrintStream&amp; out, DumpContext*) const
160 {
161     dump(out);
162 }
163 
164 } // namespace JSC
</pre>
</td>
<td>
<hr />
<pre>
 74             return true;
 75 
 76         if (aInlineCallFrame-&gt;baselineCodeBlock.get() != bInlineCallFrame-&gt;baselineCodeBlock.get())
 77             return false;
 78 
 79         a = aInlineCallFrame-&gt;directCaller;
 80         b = bInlineCallFrame-&gt;directCaller;
 81     }
 82 }
 83 
 84 unsigned CodeOrigin::approximateHash(InlineCallFrame* terminal) const
 85 {
 86     if (!isSet())
 87         return 0;
 88     if (isHashTableDeletedValue())
 89         return 1;
 90 
 91     unsigned result = 2;
 92     CodeOrigin codeOrigin = *this;
 93     for (;;) {
<span class="line-modified"> 94         result += codeOrigin.bytecodeIndex().asBits();</span>
 95 
 96         auto* inlineCallFrame = codeOrigin.inlineCallFrame();
 97 
 98         if (!inlineCallFrame)
 99             return result;
100 
101         if (inlineCallFrame == terminal)
102             return result;
103 
104         result += WTF::PtrHash&lt;JSCell*&gt;::hash(inlineCallFrame-&gt;baselineCodeBlock.get());
105 
106         codeOrigin = inlineCallFrame-&gt;directCaller;
107     }
108 }
109 
110 Vector&lt;CodeOrigin&gt; CodeOrigin::inlineStack() const
111 {
112     Vector&lt;CodeOrigin&gt; result(inlineDepth());
113     result.last() = *this;
114     unsigned index = result.size() - 2;
</pre>
<hr />
<pre>
135 }
136 
137 void CodeOrigin::dump(PrintStream&amp; out) const
138 {
139     if (!isSet()) {
140         out.print(&quot;&lt;none&gt;&quot;);
141         return;
142     }
143 
144     Vector&lt;CodeOrigin&gt; stack = inlineStack();
145     for (unsigned i = 0; i &lt; stack.size(); ++i) {
146         if (i)
147             out.print(&quot; --&gt; &quot;);
148 
149         if (InlineCallFrame* frame = stack[i].inlineCallFrame()) {
150             out.print(frame-&gt;briefFunctionInformation(), &quot;:&lt;&quot;, RawPointer(frame-&gt;baselineCodeBlock.get()), &quot;&gt; &quot;);
151             if (frame-&gt;isClosureCall)
152                 out.print(&quot;(closure) &quot;);
153         }
154 
<span class="line-modified">155         out.print(stack[i].bytecodeIndex());</span>
156     }
157 }
158 
159 void CodeOrigin::dumpInContext(PrintStream&amp; out, DumpContext*) const
160 {
161     dump(out);
162 }
163 
164 } // namespace JSC
</pre>
</td>
</tr>
</table>
<center><a href="CodeBlockHash.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CodeOrigin.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>