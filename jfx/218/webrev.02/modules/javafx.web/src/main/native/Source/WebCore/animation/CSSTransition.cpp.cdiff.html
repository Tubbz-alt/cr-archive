<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/animation/CSSTransition.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="CSSPropertyBlendingClient.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CSSTransition.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/animation/CSSTransition.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 26,30 ***</span>
  #include &quot;config.h&quot;
  #include &quot;CSSTransition.h&quot;
  
  #include &quot;Animation.h&quot;
  #include &quot;Element.h&quot;
  #include &quot;KeyframeEffect.h&quot;
  #include &lt;wtf/IsoMallocInlines.h&gt;
  
  namespace WebCore {
  
  WTF_MAKE_ISO_ALLOCATED_IMPL(CSSTransition);
  
  Ref&lt;CSSTransition&gt; CSSTransition::create(Element&amp; owningElement, CSSPropertyID property, MonotonicTime generationTime, const Animation&amp; backingAnimation, const RenderStyle* oldStyle, const RenderStyle&amp; newStyle, Seconds delay, Seconds duration, const RenderStyle&amp; reversingAdjustedStartStyle, double reversingShorteningFactor)
  {
<span class="line-modified">!     auto result = adoptRef(*new CSSTransition(owningElement, property, generationTime, backingAnimation, newStyle, reversingAdjustedStartStyle, reversingShorteningFactor));</span>
      result-&gt;initialize(oldStyle, newStyle);
      result-&gt;setTimingProperties(delay, duration);
      return result;
  }
  
<span class="line-modified">! CSSTransition::CSSTransition(Element&amp; element, CSSPropertyID property, MonotonicTime generationTime, const Animation&amp; backingAnimation, const RenderStyle&amp; targetStyle, const RenderStyle&amp; reversingAdjustedStartStyle, double reversingShorteningFactor)</span>
      : DeclarativeAnimation(element, backingAnimation)
      , m_property(property)
      , m_generationTime(generationTime)
      , m_targetStyle(RenderStyle::clonePtr(targetStyle))
      , m_reversingAdjustedStartStyle(RenderStyle::clonePtr(reversingAdjustedStartStyle))
      , m_reversingShorteningFactor(reversingShorteningFactor)
  {
  }
  
<span class="line-new-header">--- 26,37 ---</span>
  #include &quot;config.h&quot;
  #include &quot;CSSTransition.h&quot;
  
  #include &quot;Animation.h&quot;
  #include &quot;Element.h&quot;
<span class="line-added">+ #include &quot;InspectorInstrumentation.h&quot;</span>
  #include &quot;KeyframeEffect.h&quot;
<span class="line-added">+ #include &quot;TransitionEvent.h&quot;</span>
  #include &lt;wtf/IsoMallocInlines.h&gt;
  
  namespace WebCore {
  
  WTF_MAKE_ISO_ALLOCATED_IMPL(CSSTransition);
  
  Ref&lt;CSSTransition&gt; CSSTransition::create(Element&amp; owningElement, CSSPropertyID property, MonotonicTime generationTime, const Animation&amp; backingAnimation, const RenderStyle* oldStyle, const RenderStyle&amp; newStyle, Seconds delay, Seconds duration, const RenderStyle&amp; reversingAdjustedStartStyle, double reversingShorteningFactor)
  {
<span class="line-modified">!     ASSERT(oldStyle);</span>
<span class="line-added">+     auto result = adoptRef(*new CSSTransition(owningElement, property, generationTime, backingAnimation, *oldStyle, newStyle, reversingAdjustedStartStyle, reversingShorteningFactor));</span>
      result-&gt;initialize(oldStyle, newStyle);
      result-&gt;setTimingProperties(delay, duration);
<span class="line-added">+ </span>
<span class="line-added">+     InspectorInstrumentation::didCreateWebAnimation(result.get());</span>
<span class="line-added">+ </span>
      return result;
  }
  
<span class="line-modified">! CSSTransition::CSSTransition(Element&amp; element, CSSPropertyID property, MonotonicTime generationTime, const Animation&amp; backingAnimation, const RenderStyle&amp; oldStyle, const RenderStyle&amp; targetStyle, const RenderStyle&amp; reversingAdjustedStartStyle, double reversingShorteningFactor)</span>
      : DeclarativeAnimation(element, backingAnimation)
      , m_property(property)
      , m_generationTime(generationTime)
      , m_targetStyle(RenderStyle::clonePtr(targetStyle))
<span class="line-added">+     , m_currentStyle(RenderStyle::clonePtr(oldStyle))</span>
      , m_reversingAdjustedStartStyle(RenderStyle::clonePtr(reversingAdjustedStartStyle))
      , m_reversingShorteningFactor(reversingShorteningFactor)
  {
  }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 70,10 ***</span>
<span class="line-new-header">--- 77,18 ---</span>
      // In order for CSS Transitions to be seeked backwards, they need to have their fill mode set to backwards
      // such that the original CSS value applied prior to the transition is used for a negative current time.
      animationEffect-&gt;setFill(FillMode::Backwards);
      animationEffect-&gt;setDelay(delay);
      animationEffect-&gt;setIterationDuration(duration);
<span class="line-added">+     animationEffect-&gt;setTimingFunction(backingAnimation().timingFunction());</span>
<span class="line-added">+     animationEffect-&gt;updateStaticTimingProperties();</span>
<span class="line-added">+     effectTimingDidChange();</span>
  
      unsuspendEffectInvalidation();
  }
  
<span class="line-added">+ Ref&lt;AnimationEventBase&gt; CSSTransition::createEvent(const AtomString&amp; eventType, double elapsedTime, const String&amp; pseudoId, Optional&lt;Seconds&gt; timelineTime)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     return TransitionEvent::create(eventType, getPropertyNameString(m_property), elapsedTime, pseudoId, timelineTime, this);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  } // namespace WebCore
</pre>
<center><a href="CSSPropertyBlendingClient.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CSSTransition.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>