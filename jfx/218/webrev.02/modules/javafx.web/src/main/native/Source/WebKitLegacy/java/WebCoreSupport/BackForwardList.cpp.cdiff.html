<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebKitLegacy/java/WebCoreSupport/BackForwardList.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../DOM/JavaXPathExpression.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="ChromeClientJava.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebKitLegacy/java/WebCoreSupport/BackForwardList.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 24,18 ***</span>
   * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
   */
  
  #include &quot;BackForwardList.h&quot;
  
  #include &lt;WebCore/BackForwardController.h&gt;
  #include &lt;WebCore/Frame.h&gt;
  #include &lt;WebCore/FrameLoader.h&gt;
  #include &lt;WebCore/FrameLoaderClient.h&gt;
  #include &lt;WebCore/HistoryItem.h&gt;
  #include &lt;WebCore/Logging.h&gt;
  #include &lt;WebCore/Page.h&gt;
<span class="line-removed">- #include &lt;WebCore/PageCache.h&gt;</span>
  #include &lt;WebCore/SerializedScriptValue.h&gt;
  
  #include &quot;BackForwardList.h&quot;
  #include &quot;WebPage.h&quot;
  #include &quot;PlatformJavaClasses.h&quot;
<span class="line-new-header">--- 24,18 ---</span>
   * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
   */
  
  #include &quot;BackForwardList.h&quot;
  
<span class="line-added">+ #include &lt;WebCore/BackForwardCache.h&gt;</span>
  #include &lt;WebCore/BackForwardController.h&gt;
  #include &lt;WebCore/Frame.h&gt;
  #include &lt;WebCore/FrameLoader.h&gt;
  #include &lt;WebCore/FrameLoaderClient.h&gt;
  #include &lt;WebCore/HistoryItem.h&gt;
  #include &lt;WebCore/Logging.h&gt;
  #include &lt;WebCore/Page.h&gt;
  #include &lt;WebCore/SerializedScriptValue.h&gt;
  
  #include &quot;BackForwardList.h&quot;
  #include &quot;WebPage.h&quot;
  #include &quot;PlatformJavaClasses.h&quot;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 371,21 ***</span>
      if (m_current != NoCurrentItemIndex) {
          unsigned targetSize = m_current + 1;
          while (m_entries.size() &gt; targetSize) {
              Ref&lt;HistoryItem&gt; item = m_entries.takeLast();
              m_entryHash.remove(item.ptr());
<span class="line-modified">!             PageCache::singleton().remove(item);</span>
          }
      }
  
      // Toss the first item if the list is getting too big, as long as we&#39;re not using it
      // (or even if we are, if we only want 1 entry).
      if (m_entries.size() == m_capacity &amp;&amp; (m_current || m_capacity == 1)) {
          Ref&lt;HistoryItem&gt; item = WTFMove(m_entries[0]);
          m_entries.remove(0);
          m_entryHash.remove(item.ptr());
<span class="line-modified">!         PageCache::singleton().remove(item);</span>
          --m_current;
      }
  
      m_entryHash.add(newItem.ptr());
      m_entries.insert(m_current + 1, WTFMove(newItem));
<span class="line-new-header">--- 371,21 ---</span>
      if (m_current != NoCurrentItemIndex) {
          unsigned targetSize = m_current + 1;
          while (m_entries.size() &gt; targetSize) {
              Ref&lt;HistoryItem&gt; item = m_entries.takeLast();
              m_entryHash.remove(item.ptr());
<span class="line-modified">!             BackForwardCache::singleton().remove(item);</span>
          }
      }
  
      // Toss the first item if the list is getting too big, as long as we&#39;re not using it
      // (or even if we are, if we only want 1 entry).
      if (m_entries.size() == m_capacity &amp;&amp; (m_current || m_capacity == 1)) {
          Ref&lt;HistoryItem&gt; item = WTFMove(m_entries[0]);
          m_entries.remove(0);
          m_entryHash.remove(item.ptr());
<span class="line-modified">!         BackForwardCache::singleton().remove(item);</span>
          --m_current;
      }
  
      m_entryHash.add(newItem.ptr());
      m_entries.insert(m_current + 1, WTFMove(newItem));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 481,11 ***</span>
  void BackForwardList::setCapacity(int size)
  {
      while (size &lt; static_cast&lt;int&gt;(m_entries.size())) {
          Ref&lt;HistoryItem&gt; item = m_entries.takeLast();
          m_entryHash.remove(item.ptr());
<span class="line-modified">!         PageCache::singleton().remove(item);</span>
      }
  
      if (!size)
          m_current = NoCurrentItemIndex;
      else if (m_current &gt; m_entries.size() - 1) {
<span class="line-new-header">--- 481,11 ---</span>
  void BackForwardList::setCapacity(int size)
  {
      while (size &lt; static_cast&lt;int&gt;(m_entries.size())) {
          Ref&lt;HistoryItem&gt; item = m_entries.takeLast();
          m_entryHash.remove(item.ptr());
<span class="line-modified">!         BackForwardCache::singleton().remove(item);</span>
      }
  
      if (!size)
          m_current = NoCurrentItemIndex;
      else if (m_current &gt; m_entries.size() - 1) {
</pre>
<center><a href="../DOM/JavaXPathExpression.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="ChromeClientJava.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>