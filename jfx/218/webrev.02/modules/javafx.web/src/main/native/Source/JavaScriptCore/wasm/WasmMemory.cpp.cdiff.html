<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/wasm/WasmMemory.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="WasmInstance.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="WasmMemory.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/wasm/WasmMemory.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 118,12 ***</span>
              return MemoryResult(
                  result,
                  m_fastMemories.size() &gt;= m_maxFastMemoryCount / 2 ? MemoryResult::SuccessAndNotifyMemoryPressure : MemoryResult::Success);
          }();
  
<span class="line-modified">!         if (Options::logWebAssemblyMemory())</span>
<span class="line-removed">-             dataLog(&quot;Allocated virtual: &quot;, result, &quot;; state: &quot;, *this, &quot;\n&quot;);</span>
  
          return result;
      }
  
      void freeFastMemory(void* basePtr)
<span class="line-new-header">--- 118,11 ---</span>
              return MemoryResult(
                  result,
                  m_fastMemories.size() &gt;= m_maxFastMemoryCount / 2 ? MemoryResult::SuccessAndNotifyMemoryPressure : MemoryResult::Success);
          }();
  
<span class="line-modified">!         dataLogLnIf(Options::logWebAssemblyMemory(), &quot;Allocated virtual: &quot;, result, &quot;; state: &quot;, *this);</span>
  
          return result;
      }
  
      void freeFastMemory(void* basePtr)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 132,12 ***</span>
              auto holder = holdLock(m_lock);
              Gigacage::freeVirtualPages(Gigacage::Primitive, basePtr, Memory::fastMappedBytes());
              m_fastMemories.removeFirst(basePtr);
          }
  
<span class="line-modified">!         if (Options::logWebAssemblyMemory())</span>
<span class="line-removed">-             dataLog(&quot;Freed virtual; state: &quot;, *this, &quot;\n&quot;);</span>
      }
  
      bool isAddressInFastMemory(void* address)
      {
          // NOTE: This can be called from a signal handler, but only after we proved that we&#39;re in JIT code.
<span class="line-new-header">--- 131,11 ---</span>
              auto holder = holdLock(m_lock);
              Gigacage::freeVirtualPages(Gigacage::Primitive, basePtr, Memory::fastMappedBytes());
              m_fastMemories.removeFirst(basePtr);
          }
  
<span class="line-modified">!         dataLogLnIf(Options::logWebAssemblyMemory(), &quot;Freed virtual; state: &quot;, *this);</span>
      }
  
      bool isAddressInFastMemory(void* address)
      {
          // NOTE: This can be called from a signal handler, but only after we proved that we&#39;re in JIT code.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 170,12 ***</span>
                  return MemoryResult::SuccessAndNotifyMemoryPressure;
  
              return MemoryResult::Success;
          }();
  
<span class="line-modified">!         if (Options::logWebAssemblyMemory())</span>
<span class="line-removed">-             dataLog(&quot;Allocated physical: &quot;, bytes, &quot;, &quot;, MemoryResult::toString(result), &quot;; state: &quot;, *this, &quot;\n&quot;);</span>
  
          return result;
      }
  
      void freePhysicalBytes(size_t bytes)
<span class="line-new-header">--- 168,11 ---</span>
                  return MemoryResult::SuccessAndNotifyMemoryPressure;
  
              return MemoryResult::Success;
          }();
  
<span class="line-modified">!         dataLogLnIf(Options::logWebAssemblyMemory(), &quot;Allocated physical: &quot;, bytes, &quot;, &quot;, MemoryResult::toString(result), &quot;; state: &quot;, *this);</span>
  
          return result;
      }
  
      void freePhysicalBytes(size_t bytes)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 183,12 ***</span>
          {
              auto holder = holdLock(m_lock);
              m_physicalBytes -= bytes;
          }
  
<span class="line-modified">!         if (Options::logWebAssemblyMemory())</span>
<span class="line-removed">-             dataLog(&quot;Freed physical: &quot;, bytes, &quot;; state: &quot;, *this, &quot;\n&quot;);</span>
      }
  
      void dump(PrintStream&amp; out) const
      {
          out.print(&quot;fast memories =  &quot;, m_fastMemories.size(), &quot;/&quot;, m_maxFastMemoryCount, &quot;, bytes = &quot;, m_physicalBytes, &quot;/&quot;, memoryLimit());
<span class="line-new-header">--- 180,11 ---</span>
          {
              auto holder = holdLock(m_lock);
              m_physicalBytes -= bytes;
          }
  
<span class="line-modified">!         dataLogLnIf(Options::logWebAssemblyMemory(), &quot;Freed physical: &quot;, bytes, &quot;; state: &quot;, *this);</span>
      }
  
      void dump(PrintStream&amp; out) const
      {
          out.print(&quot;fast memories =  &quot;, m_fastMemories.size(), &quot;/&quot;, m_maxFastMemoryCount, &quot;, bytes = &quot;, m_physicalBytes, &quot;/&quot;, memoryLimit());
</pre>
<center><a href="WasmInstance.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="WasmMemory.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>