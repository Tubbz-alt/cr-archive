<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/JavaScriptCore/heap/IsoSubspaceInlines.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="IsoSubspace.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="IsoSubspacePerVM.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/heap/IsoSubspaceInlines.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -25,15 +25,34 @@</span>
  
  #pragma once
  
  namespace JSC {
  
<span class="udiff-line-modified-removed">- ALWAYS_INLINE void* IsoSubspace::allocateNonVirtual(VM&amp;, size_t size, GCDeferralContext* deferralContext, AllocationFailureMode failureMode)</span>
<span class="udiff-line-modified-added">+ ALWAYS_INLINE void* IsoSubspace::allocateNonVirtual(VM&amp; vm, size_t size, GCDeferralContext* deferralContext, AllocationFailureMode failureMode)</span>
  {
<span class="udiff-line-modified-removed">-     RELEASE_ASSERT(size == this-&gt;size());</span>
<span class="udiff-line-modified-added">+     RELEASE_ASSERT(WTF::roundUpToMultipleOf&lt;MarkedBlock::atomSize&gt;(size) == cellSize());</span>
      Allocator allocator = allocatorForNonVirtual(size, AllocatorForMode::MustAlreadyHaveAllocator);
<span class="udiff-line-modified-removed">-     void* result = allocator.allocate(deferralContext, failureMode);</span>
<span class="udiff-line-modified-added">+     void* result = allocator.allocate(vm.heap, deferralContext, failureMode);</span>
      return result;
  }
  
<span class="udiff-line-added">+ inline void IsoSubspace::clearIsoCellSetBit(PreciseAllocation* preciseAllocation)</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     unsigned lowerTierIndex = preciseAllocation-&gt;lowerTierIndex();</span>
<span class="udiff-line-added">+     m_cellSets.forEach(</span>
<span class="udiff-line-added">+         [&amp;](IsoCellSet* set) {</span>
<span class="udiff-line-added">+             set-&gt;clearLowerTierCell(lowerTierIndex);</span>
<span class="udiff-line-added">+         });</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ inline void IsoSubspace::sweep()</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     Subspace::sweepBlocks();</span>
<span class="udiff-line-added">+     // We sweep precise-allocations eagerly, but we do not free it immediately.</span>
<span class="udiff-line-added">+     // This part should be done by MarkedSpace::sweepPreciseAllocations.</span>
<span class="udiff-line-added">+     m_preciseAllocations.forEach([&amp;](PreciseAllocation* allocation) {</span>
<span class="udiff-line-added">+         allocation-&gt;sweep();</span>
<span class="udiff-line-added">+     });</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
  } // namespace JSC
  
</pre>
<center><a href="IsoSubspace.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="IsoSubspacePerVM.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>