<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/rendering/style/RenderStyle.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="NinePieceImage.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="RenderStyle.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/rendering/style/RenderStyle.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 36,11 ***</span>
  #include &quot;InlineTextBoxStyle.h&quot;
  #include &quot;Pagination.h&quot;
  #include &quot;QuotesData.h&quot;
  #include &quot;RenderObject.h&quot;
  #include &quot;RenderTheme.h&quot;
<span class="line-removed">- #include &quot;RuntimeEnabledFeatures.h&quot;</span>
  #include &quot;ScaleTransformOperation.h&quot;
  #include &quot;ShadowData.h&quot;
  #include &quot;StyleBuilderConverter.h&quot;
  #include &quot;StyleImage.h&quot;
  #include &quot;StyleInheritedData.h&quot;
<span class="line-new-header">--- 36,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 77,17 ***</span>
      } m_inheritedFlags;
  
      struct NonInheritedFlags {
          unsigned m_bitfields[2];
      } m_nonInheritedFlags;
<span class="line-modified">! #if !ASSERT_DISABLED || ENABLE(SECURITY_ASSERTIONS)</span>
      bool deletionCheck;
  #endif
  };
  
  static_assert(sizeof(RenderStyle) == sizeof(SameSizeAsRenderStyle), &quot;RenderStyle should stay small&quot;);
  
  RenderStyle&amp; RenderStyle::defaultStyle()
  {
      static NeverDestroyed&lt;RenderStyle&gt; style { CreateDefaultStyle };
      return style;
  }
<span class="line-new-header">--- 76,19 ---</span>
      } m_inheritedFlags;
  
      struct NonInheritedFlags {
          unsigned m_bitfields[2];
      } m_nonInheritedFlags;
<span class="line-modified">! #if ASSERT_ENABLED || ENABLE(SECURITY_ASSERTIONS)</span>
      bool deletionCheck;
  #endif
  };
  
  static_assert(sizeof(RenderStyle) == sizeof(SameSizeAsRenderStyle), &quot;RenderStyle should stay small&quot;);
  
<span class="line-added">+ DEFINE_ALLOCATOR_WITH_HEAP_IDENTIFIER(RenderStyle);</span>
<span class="line-added">+ </span>
  RenderStyle&amp; RenderStyle::defaultStyle()
  {
      static NeverDestroyed&lt;RenderStyle&gt; style { CreateDefaultStyle };
      return style;
  }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 228,11 ***</span>
  {
  }
  
  RenderStyle::~RenderStyle()
  {
<span class="line-modified">! #if !ASSERT_DISABLED || ENABLE(SECURITY_ASSERTIONS)</span>
      ASSERT_WITH_SECURITY_IMPLICATION(!m_deletionHasBegun);
      m_deletionHasBegun = true;
  #endif
  }
  
<span class="line-new-header">--- 229,11 ---</span>
  {
  }
  
  RenderStyle::~RenderStyle()
  {
<span class="line-modified">! #if ASSERT_ENABLED || ENABLE(SECURITY_ASSERTIONS)</span>
      ASSERT_WITH_SECURITY_IMPLICATION(!m_deletionHasBegun);
      m_deletionHasBegun = true;
  #endif
  }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 427,16 ***</span>
              return;
          }
      }
  }
  
<span class="line-modified">! bool RenderStyle::inheritedNotEqual(const RenderStyle* other) const</span>
  {
<span class="line-modified">!     return m_inheritedFlags != other-&gt;m_inheritedFlags</span>
<span class="line-modified">!         || m_inheritedData != other-&gt;m_inheritedData</span>
<span class="line-modified">!         || m_svgStyle-&gt;inheritedNotEqual(other-&gt;m_svgStyle)</span>
<span class="line-modified">!         || m_rareInheritedData != other-&gt;m_rareInheritedData;</span>
  }
  
  #if ENABLE(TEXT_AUTOSIZING)
  
  static inline unsigned computeFontHash(const FontCascade&amp; font)
<span class="line-new-header">--- 428,25 ---</span>
              return;
          }
      }
  }
  
<span class="line-modified">! bool RenderStyle::inheritedEqual(const RenderStyle&amp; other) const</span>
<span class="line-added">+ {</span>
<span class="line-added">+     return m_inheritedFlags == other.m_inheritedFlags</span>
<span class="line-added">+         &amp;&amp; m_inheritedData == other.m_inheritedData</span>
<span class="line-added">+         &amp;&amp; (m_svgStyle.ptr() == other.m_svgStyle.ptr() || m_svgStyle-&gt;inheritedEqual(other.m_svgStyle))</span>
<span class="line-added">+         &amp;&amp; m_rareInheritedData == other.m_rareInheritedData;</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ bool RenderStyle::descendantAffectingNonInheritedPropertiesEqual(const RenderStyle&amp; other) const</span>
  {
<span class="line-modified">!     if (m_rareNonInheritedData.ptr() == other.m_rareNonInheritedData.ptr())</span>
<span class="line-modified">!         return true;</span>
<span class="line-modified">! </span>
<span class="line-modified">!     return m_rareNonInheritedData-&gt;alignItems == other.m_rareNonInheritedData-&gt;alignItems</span>
<span class="line-added">+         &amp;&amp; m_rareNonInheritedData-&gt;justifyItems == other.m_rareNonInheritedData-&gt;justifyItems;</span>
  }
  
  #if ENABLE(TEXT_AUTOSIZING)
  
  static inline unsigned computeFontHash(const FontCascade&amp; font)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 580,19 ***</span>
      m_inheritedFlags.autosizeStatus = autosizeStatus.fields().toRaw();
  }
  
  #endif // ENABLE(TEXT_AUTOSIZING)
  
<span class="line-removed">- bool RenderStyle::inheritedDataShared(const RenderStyle* other) const</span>
<span class="line-removed">- {</span>
<span class="line-removed">-     // This is a fast check that only looks if the data structures are shared.</span>
<span class="line-removed">-     return m_inheritedFlags == other-&gt;m_inheritedFlags</span>
<span class="line-removed">-         &amp;&amp; m_inheritedData.ptr() == other-&gt;m_inheritedData.ptr()</span>
<span class="line-removed">-         &amp;&amp; m_svgStyle.ptr() == other-&gt;m_svgStyle.ptr()</span>
<span class="line-removed">-         &amp;&amp; m_rareInheritedData.ptr() == other-&gt;m_rareInheritedData.ptr();</span>
<span class="line-removed">- }</span>
<span class="line-removed">- </span>
  static bool positionChangeIsMovementOnly(const LengthBox&amp; a, const LengthBox&amp; b, const Length&amp; width)
  {
      // If any unit types are different, then we can&#39;t guarantee
      // that this was just a movement.
      if (a.left().type() != b.left().type()
<span class="line-new-header">--- 590,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 764,13 ***</span>
          || first.textEmphasisCustomMark != second.textEmphasisCustomMark
          || first.textOrientation != second.textOrientation
          || first.tabSize != second.tabSize
          || first.lineBoxContain != second.lineBoxContain
          || first.lineGrid != second.lineGrid
<span class="line-removed">- #if ENABLE(CSS_IMAGE_ORIENTATION)</span>
          || first.imageOrientation != second.imageOrientation
<span class="line-removed">- #endif</span>
  #if ENABLE(CSS_IMAGE_RESOLUTION)
          || first.imageResolutionSource != second.imageResolutionSource
          || first.imageResolutionSnap != second.imageResolutionSnap
          || first.imageResolution != second.imageResolution
  #endif
<span class="line-new-header">--- 765,11 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 989,12 ***</span>
      return false;
  }
  
  bool RenderStyle::changeRequiresLayerRepaint(const RenderStyle&amp; other, OptionSet&lt;StyleDifferenceContextSensitiveProperty&gt;&amp; changedContextSensitiveProperties) const
  {
<span class="line-modified">!     // StyleResolver has ensured that zIndex is non-auto only if it&#39;s applicable.</span>
<span class="line-modified">!     if (m_boxData-&gt;zIndex() != other.m_boxData-&gt;zIndex() || m_boxData-&gt;hasAutoZIndex() != other.m_boxData-&gt;hasAutoZIndex())</span>
          return true;
  
      if (position() != PositionType::Static) {
          if (m_visualData-&gt;clip != other.m_visualData-&gt;clip || m_visualData-&gt;hasClip != other.m_visualData-&gt;hasClip) {
              changedContextSensitiveProperties.add(StyleDifferenceContextSensitiveProperty::ClipRect);
<span class="line-new-header">--- 988,12 ---</span>
      return false;
  }
  
  bool RenderStyle::changeRequiresLayerRepaint(const RenderStyle&amp; other, OptionSet&lt;StyleDifferenceContextSensitiveProperty&gt;&amp; changedContextSensitiveProperties) const
  {
<span class="line-modified">!     // Style::Resolver has ensured that zIndex is non-auto only if it&#39;s applicable.</span>
<span class="line-modified">!     if (m_boxData-&gt;usedZIndex() != other.m_boxData-&gt;usedZIndex() || m_boxData-&gt;hasAutoUsedZIndex() != other.m_boxData-&gt;hasAutoUsedZIndex())</span>
          return true;
  
      if (position() != PositionType::Static) {
          if (m_visualData-&gt;clip != other.m_visualData-&gt;clip || m_visualData-&gt;hasClip != other.m_visualData-&gt;hasClip) {
              changedContextSensitiveProperties.add(StyleDifferenceContextSensitiveProperty::ClipRect);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1407,11 ***</span>
      setTransformOriginY(Length(0, Fixed));
  }
  
  void RenderStyle::setTextShadow(std::unique_ptr&lt;ShadowData&gt; shadowData, bool add)
  {
<span class="line-modified">!     ASSERT(!shadowData || (!shadowData-&gt;spread() &amp;&amp; shadowData-&gt;style() == Normal));</span>
  
      auto&amp; rareData = m_rareInheritedData.access();
      if (!add) {
          rareData.textShadow = WTFMove(shadowData);
          return;
<span class="line-new-header">--- 1406,11 ---</span>
      setTransformOriginY(Length(0, Fixed));
  }
  
  void RenderStyle::setTextShadow(std::unique_ptr&lt;ShadowData&gt; shadowData, bool add)
  {
<span class="line-modified">!     ASSERT(!shadowData || (!shadowData-&gt;spread() &amp;&amp; shadowData-&gt;style() == ShadowStyle::Normal));</span>
  
      auto&amp; rareData = m_rareInheritedData.access();
      if (!add) {
          rareData.textShadow = WTFMove(shadowData);
          return;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1434,14 ***</span>
  }
  
  static RoundedRect::Radii calcRadiiFor(const BorderData&amp; border, const LayoutSize&amp; size)
  {
      return {
<span class="line-modified">!         sizeForLengthSize(border.topLeft(), size),</span>
<span class="line-modified">!         sizeForLengthSize(border.topRight(), size),</span>
<span class="line-modified">!         sizeForLengthSize(border.bottomLeft(), size),</span>
<span class="line-modified">!         sizeForLengthSize(border.bottomRight(), size)</span>
      };
  }
  
  StyleImage* RenderStyle::listStyleImage() const
  {
<span class="line-new-header">--- 1433,14 ---</span>
  }
  
  static RoundedRect::Radii calcRadiiFor(const BorderData&amp; border, const LayoutSize&amp; size)
  {
      return {
<span class="line-modified">!         sizeForLengthSize(border.topLeftRadius(), size),</span>
<span class="line-modified">!         sizeForLengthSize(border.topRightRadius(), size),</span>
<span class="line-modified">!         sizeForLengthSize(border.bottomLeftRadius(), size),</span>
<span class="line-modified">!         sizeForLengthSize(border.bottomRightRadius(), size)</span>
      };
  }
  
  StyleImage* RenderStyle::listStyleImage() const
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1669,18 ***</span>
  }
  
  AnimationList&amp; RenderStyle::ensureAnimations()
  {
      if (!m_rareNonInheritedData.access().animations)
<span class="line-modified">!         m_rareNonInheritedData.access().animations = makeUnique&lt;AnimationList&gt;();</span>
      return *m_rareNonInheritedData-&gt;animations;
  }
  
  AnimationList&amp; RenderStyle::ensureTransitions()
  {
      if (!m_rareNonInheritedData.access().transitions)
<span class="line-modified">!         m_rareNonInheritedData.access().transitions = makeUnique&lt;AnimationList&gt;();</span>
      return *m_rareNonInheritedData-&gt;transitions;
  }
  
  const Animation* RenderStyle::transitionForProperty(CSSPropertyID property) const
  {
<span class="line-new-header">--- 1668,18 ---</span>
  }
  
  AnimationList&amp; RenderStyle::ensureAnimations()
  {
      if (!m_rareNonInheritedData.access().animations)
<span class="line-modified">!         m_rareNonInheritedData.access().animations = AnimationList::create();</span>
      return *m_rareNonInheritedData-&gt;animations;
  }
  
  AnimationList&amp; RenderStyle::ensureTransitions()
  {
      if (!m_rareNonInheritedData.access().transitions)
<span class="line-modified">!         m_rareNonInheritedData.access().transitions = AnimationList::create();</span>
      return *m_rareNonInheritedData-&gt;transitions;
  }
  
  const Animation* RenderStyle::transitionForProperty(CSSPropertyID property) const
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1881,14 ***</span>
      right = 0;
      bottom = 0;
      left = 0;
  
      for ( ; shadow; shadow = shadow-&gt;next()) {
<span class="line-modified">!         if (shadow-&gt;style() == Inset)</span>
              continue;
  
<span class="line-modified">!         int extentAndSpread = shadow-&gt;paintingExtent() + shadow-&gt;spread();</span>
          top = std::min&lt;LayoutUnit&gt;(top, shadow-&gt;y() - extentAndSpread);
          right = std::max&lt;LayoutUnit&gt;(right, shadow-&gt;x() + extentAndSpread);
          bottom = std::max&lt;LayoutUnit&gt;(bottom, shadow-&gt;y() + extentAndSpread);
          left = std::min&lt;LayoutUnit&gt;(left, shadow-&gt;x() - extentAndSpread);
      }
<span class="line-new-header">--- 1880,14 ---</span>
      right = 0;
      bottom = 0;
      left = 0;
  
      for ( ; shadow; shadow = shadow-&gt;next()) {
<span class="line-modified">!         if (shadow-&gt;style() == ShadowStyle::Inset)</span>
              continue;
  
<span class="line-modified">!         auto extentAndSpread = shadow-&gt;paintingExtent() + shadow-&gt;spread();</span>
          top = std::min&lt;LayoutUnit&gt;(top, shadow-&gt;y() - extentAndSpread);
          right = std::max&lt;LayoutUnit&gt;(right, shadow-&gt;x() + extentAndSpread);
          bottom = std::max&lt;LayoutUnit&gt;(bottom, shadow-&gt;y() + extentAndSpread);
          left = std::min&lt;LayoutUnit&gt;(left, shadow-&gt;x() - extentAndSpread);
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1900,14 ***</span>
      LayoutUnit right;
      LayoutUnit bottom;
      LayoutUnit left;
  
      for ( ; shadow; shadow = shadow-&gt;next()) {
<span class="line-modified">!         if (shadow-&gt;style() == Normal)</span>
              continue;
  
<span class="line-modified">!         int extentAndSpread = shadow-&gt;paintingExtent() + shadow-&gt;spread();</span>
          top = std::max&lt;LayoutUnit&gt;(top, shadow-&gt;y() + extentAndSpread);
          right = std::min&lt;LayoutUnit&gt;(right, shadow-&gt;x() - extentAndSpread);
          bottom = std::min&lt;LayoutUnit&gt;(bottom, shadow-&gt;y() - extentAndSpread);
          left = std::max&lt;LayoutUnit&gt;(left, shadow-&gt;x() + extentAndSpread);
      }
<span class="line-new-header">--- 1899,14 ---</span>
      LayoutUnit right;
      LayoutUnit bottom;
      LayoutUnit left;
  
      for ( ; shadow; shadow = shadow-&gt;next()) {
<span class="line-modified">!         if (shadow-&gt;style() == ShadowStyle::Normal)</span>
              continue;
  
<span class="line-modified">!         auto extentAndSpread = shadow-&gt;paintingExtent() + shadow-&gt;spread();</span>
          top = std::max&lt;LayoutUnit&gt;(top, shadow-&gt;y() + extentAndSpread);
          right = std::min&lt;LayoutUnit&gt;(right, shadow-&gt;x() - extentAndSpread);
          bottom = std::min&lt;LayoutUnit&gt;(bottom, shadow-&gt;y() - extentAndSpread);
          left = std::max&lt;LayoutUnit&gt;(left, shadow-&gt;x() + extentAndSpread);
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1919,14 ***</span>
  {
      left = 0;
      right = 0;
  
      for ( ; shadow; shadow = shadow-&gt;next()) {
<span class="line-modified">!         if (shadow-&gt;style() == Inset)</span>
              continue;
  
<span class="line-modified">!         int extentAndSpread = shadow-&gt;paintingExtent() + shadow-&gt;spread();</span>
          left = std::min&lt;LayoutUnit&gt;(left, shadow-&gt;x() - extentAndSpread);
          right = std::max&lt;LayoutUnit&gt;(right, shadow-&gt;x() + extentAndSpread);
      }
  }
  
<span class="line-new-header">--- 1918,14 ---</span>
  {
      left = 0;
      right = 0;
  
      for ( ; shadow; shadow = shadow-&gt;next()) {
<span class="line-modified">!         if (shadow-&gt;style() == ShadowStyle::Inset)</span>
              continue;
  
<span class="line-modified">!         auto extentAndSpread = shadow-&gt;paintingExtent() + shadow-&gt;spread();</span>
          left = std::min&lt;LayoutUnit&gt;(left, shadow-&gt;x() - extentAndSpread);
          right = std::max&lt;LayoutUnit&gt;(right, shadow-&gt;x() + extentAndSpread);
      }
  }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1934,14 ***</span>
  {
      top = 0;
      bottom = 0;
  
      for ( ; shadow; shadow = shadow-&gt;next()) {
<span class="line-modified">!         if (shadow-&gt;style() == Inset)</span>
              continue;
  
<span class="line-modified">!         int extentAndSpread = shadow-&gt;paintingExtent() + shadow-&gt;spread();</span>
          top = std::min&lt;LayoutUnit&gt;(top, shadow-&gt;y() - extentAndSpread);
          bottom = std::max&lt;LayoutUnit&gt;(bottom, shadow-&gt;y() + extentAndSpread);
      }
  }
  
<span class="line-new-header">--- 1933,14 ---</span>
  {
      top = 0;
      bottom = 0;
  
      for ( ; shadow; shadow = shadow-&gt;next()) {
<span class="line-modified">!         if (shadow-&gt;style() == ShadowStyle::Inset)</span>
              continue;
  
<span class="line-modified">!         auto extentAndSpread = shadow-&gt;paintingExtent() + shadow-&gt;spread();</span>
          top = std::min&lt;LayoutUnit&gt;(top, shadow-&gt;y() - extentAndSpread);
          bottom = std::max&lt;LayoutUnit&gt;(bottom, shadow-&gt;y() + extentAndSpread);
      }
  }
  
</pre>
<center><a href="NinePieceImage.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="RenderStyle.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>