<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/accessibility/AXObjectCache.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="AXObjectCache.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="AccessibilityARIAGrid.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/accessibility/AXObjectCache.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -23,13 +23,10 @@</span>
   * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
   */
  
  #pragma once
  
<span class="udiff-line-removed">- #if ENABLE(ACCESSIBILITY_ISOLATED_TREE)</span>
<span class="udiff-line-removed">- #include &quot;AXIsolatedTree.h&quot;</span>
<span class="udiff-line-removed">- #endif</span>
  #include &quot;AXTextStateChangeIntent.h&quot;
  #include &quot;AccessibilityObject.h&quot;
  #include &quot;Range.h&quot;
  #include &quot;Timer.h&quot;
  #include &quot;VisibleUnits.h&quot;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -45,11 +42,12 @@</span>
  #endif
  
  namespace WebCore {
  
  #if ENABLE(ACCESSIBILITY_ISOLATED_TREE)
<span class="udiff-line-modified-removed">- class AXIsolatedTreeNode;</span>
<span class="udiff-line-modified-added">+ class AXIsolatedObject;</span>
<span class="udiff-line-added">+ class AXIsolatedTree;</span>
  #endif
  class Document;
  class HTMLAreaElement;
  class HTMLTextFormControlElement;
  class Node;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -146,14 +144,14 @@</span>
      WTF_MAKE_NONCOPYABLE(AXObjectCache); WTF_MAKE_FAST_ALLOCATED;
  public:
      explicit AXObjectCache(Document&amp;);
      ~AXObjectCache();
  
<span class="udiff-line-modified-removed">-     WEBCORE_EXPORT static AccessibilityObject* focusedUIElementForPage(const Page*);</span>
<span class="udiff-line-modified-added">+     WEBCORE_EXPORT static AXCoreObject* focusedUIElementForPage(const Page*);</span>
  
      // Returns the root object for the entire document.
<span class="udiff-line-modified-removed">-     WEBCORE_EXPORT AccessibilityObject* rootObject();</span>
<span class="udiff-line-modified-added">+     WEBCORE_EXPORT AXCoreObject* rootObject();</span>
      // Returns the root object for a specific frame.
      WEBCORE_EXPORT AccessibilityObject* rootObjectForFrame(Frame*);
  
      // For AX objects with elements that back them.
      AccessibilityObject* getOrCreate(RenderObject*);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -171,15 +169,25 @@</span>
      void remove(RenderObject*);
      void remove(Node&amp;);
      void remove(Widget*);
      void remove(AXID);
  
<span class="udiff-line-modified-removed">-     void detachWrapper(AccessibilityObject*, AccessibilityDetachmentType);</span>
<span class="udiff-line-modified-removed">-     void attachWrapper(AccessibilityObject*);</span>
<span class="udiff-line-modified-added">+ #if !PLATFORM(COCOA)</span>
<span class="udiff-line-modified-added">+     void detachWrapper(AXCoreObject*, AccessibilityDetachmentType);</span>
<span class="udiff-line-added">+ #endif</span>
<span class="udiff-line-added">+ private:</span>
<span class="udiff-line-added">+     using DOMObjectVariant = Variant&lt;std::nullptr_t, RenderObject*, Node*, Widget*&gt;;</span>
<span class="udiff-line-added">+     void cacheAndInitializeWrapper(AccessibilityObject*, DOMObjectVariant = nullptr);</span>
<span class="udiff-line-added">+     void attachWrapper(AXCoreObject*);</span>
<span class="udiff-line-added">+ #if ENABLE(ACCESSIBILITY_ISOLATED_TREE)</span>
<span class="udiff-line-added">+     void attachWrapper(AXIsolatedObject*, WebAccessibilityObjectWrapper*);</span>
<span class="udiff-line-added">+ #endif</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ public:</span>
      void childrenChanged(Node*, Node* newChild = nullptr);
      void childrenChanged(RenderObject*, RenderObject* newChild = nullptr);
<span class="udiff-line-modified-removed">-     void childrenChanged(AccessibilityObject*);</span>
<span class="udiff-line-modified-added">+     void childrenChanged(AXCoreObject*);</span>
      void checkedStateChanged(Node*);
      // Called when a node has just been attached, so we can make sure we have the right subclass of AccessibilityObject.
      void updateCacheAfterNodeIsAttached(Node*);
  
      void deferFocusedUIElementChangeIfNeeded(Node* oldFocusedNode, Node* newFocusedNode);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -190,16 +198,22 @@</span>
  
      void deferAttributeChangeIfNeeded(const QualifiedName&amp;, Element*);
      void recomputeIsIgnored(RenderObject* renderer);
  
  #if ENABLE(ACCESSIBILITY_ISOLATED_TREE)
<span class="udiff-line-modified-removed">-     WEBCORE_EXPORT Ref&lt;AXIsolatedTree&gt; generateIsolatedAccessibilityTree();</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-     void associateIsolatedTreeNode(AccessibilityObject&amp;, AXIsolatedTreeNode&amp;, AXIsolatedTreeID);</span>
<span class="udiff-line-modified-removed">-     Ref&lt;AXIsolatedTreeNode&gt; createIsolatedAccessibilityTreeHierarchy(AccessibilityObject&amp;, AXID, AXIsolatedTree&amp;, Vector&lt;Ref&lt;AXIsolatedTreeNode&gt;&gt;&amp;);</span>
<span class="udiff-line-modified-added">+     WEBCORE_EXPORT static bool clientSupportsIsolatedTree();</span>
<span class="udiff-line-modified-added">+ private:</span>
<span class="udiff-line-modified-added">+     AXCoreObject* isolatedTreeRootObject();</span>
<span class="udiff-line-modified-added">+     static AXCoreObject* isolatedTreeFocusedObject(Document&amp;);</span>
<span class="udiff-line-added">+     void setIsolatedTreeFocusedObject(Node*);</span>
<span class="udiff-line-added">+     static Ref&lt;AXIsolatedTree&gt; generateIsolatedTree(PageIdentifier, Document&amp;);</span>
<span class="udiff-line-added">+     static Ref&lt;AXIsolatedObject&gt; createIsolatedTreeHierarchy(AXCoreObject&amp;, AXID, AXObjectCache*, AXIsolatedTree&amp;, Vector&lt;Ref&lt;AXIsolatedObject&gt;&gt;&amp;, bool isRoot);</span>
  #endif
  
<span class="udiff-line-added">+ public:</span>
<span class="udiff-line-added">+     WEBCORE_EXPORT bool canUseSecondaryAXThread();</span>
<span class="udiff-line-added">+ </span>
  #if ENABLE(ACCESSIBILITY)
      WEBCORE_EXPORT static void enableAccessibility();
      WEBCORE_EXPORT static void disableAccessibility();
  
      // Enhanced user interface accessibility can be toggled by the assistive technology.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -255,20 +269,20 @@</span>
      RefPtr&lt;Range&gt; sentenceForCharacterOffset(const CharacterOffset&amp;);
      CharacterOffset nextSentenceEndCharacterOffset(const CharacterOffset&amp;);
      CharacterOffset previousSentenceStartCharacterOffset(const CharacterOffset&amp;);
  
      // Bounds
<span class="udiff-line-modified-removed">-     CharacterOffset characterOffsetForPoint(const IntPoint&amp;, AccessibilityObject*);</span>
<span class="udiff-line-modified-added">+     CharacterOffset characterOffsetForPoint(const IntPoint&amp;, AXCoreObject*);</span>
      IntRect absoluteCaretBoundsForCharacterOffset(const CharacterOffset&amp;);
      CharacterOffset characterOffsetForBounds(const IntRect&amp;, bool);
  
      // Lines
      CharacterOffset endCharacterOffsetOfLine(const CharacterOffset&amp;);
      CharacterOffset startCharacterOffsetOfLine(const CharacterOffset&amp;);
  
      // Index
<span class="udiff-line-modified-removed">-     CharacterOffset characterOffsetForIndex(int, const AccessibilityObject*);</span>
<span class="udiff-line-modified-added">+     CharacterOffset characterOffsetForIndex(int, const AXCoreObject*);</span>
      int indexForCharacterOffset(const CharacterOffset&amp;, AccessibilityObject*);
  
      enum AXNotification {
          AXActiveDescendantChanged,
          AXAutocorrectionOccured,
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -305,11 +319,11 @@</span>
          AXElementBusyChanged
      };
  
      void postNotification(RenderObject*, AXNotification, PostTarget = TargetElement, PostType = PostAsynchronously);
      void postNotification(Node*, AXNotification, PostTarget = TargetElement, PostType = PostAsynchronously);
<span class="udiff-line-modified-removed">-     void postNotification(AccessibilityObject*, Document*, AXNotification, PostTarget = TargetElement, PostType = PostAsynchronously);</span>
<span class="udiff-line-modified-added">+     void postNotification(AXCoreObject*, Document*, AXNotification, PostTarget = TargetElement, PostType = PostAsynchronously);</span>
  
  #ifndef NDEBUG
      void showIntent(const AXTextStateChangeIntent&amp;);
  #endif
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -354,11 +368,11 @@</span>
  
      RefPtr&lt;Range&gt; rangeMatchesTextNearRange(RefPtr&lt;Range&gt;, const String&amp;);
  
  
  protected:
<span class="udiff-line-modified-removed">-     void postPlatformNotification(AccessibilityObject*, AXNotification);</span>
<span class="udiff-line-modified-added">+     void postPlatformNotification(AXCoreObject*, AXNotification);</span>
      void platformHandleFocusedUIElementChanged(Node* oldFocusedNode, Node* newFocusedNode);
  
      void platformPerformDeferredCacheUpdate();
  
  #if PLATFORM(COCOA)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -407,10 +421,11 @@</span>
  
  private:
      AccessibilityObject* rootWebArea();
  
      static AccessibilityObject* focusedImageMapUIElement(HTMLAreaElement*);
<span class="udiff-line-added">+     static AXCoreObject* focusedObject(Document&amp;);</span>
  
      AXID getAXID(AccessibilityObject*);
  
      void notificationPostTimerFired();
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -444,10 +459,11 @@</span>
      void updateCurrentModalNode();
      bool isNodeVisible(Node*) const;
      void handleModalChange(Node*);
  
      Document&amp; m_document;
<span class="udiff-line-added">+     const Optional&lt;PageIdentifier&gt; m_pageID; // constant for object&#39;s lifetime.</span>
      HashMap&lt;AXID, RefPtr&lt;AccessibilityObject&gt;&gt; m_objects;
      HashMap&lt;RenderObject*, AXID&gt; m_renderObjectMapping;
      HashMap&lt;Widget*, AXID&gt; m_widgetObjectMapping;
      HashMap&lt;Node*, AXID&gt; m_nodeObjectMapping;
      ListHashSet&lt;Node*&gt; m_textMarkerNodes;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -456,11 +472,11 @@</span>
      WEBCORE_EXPORT static bool gAccessibilityEnhancedUserInterfaceEnabled;
  
      HashSet&lt;AXID&gt; m_idsInUse;
  
      Timer m_notificationPostTimer;
<span class="udiff-line-modified-removed">-     Vector&lt;std::pair&lt;RefPtr&lt;AccessibilityObject&gt;, AXNotification&gt;&gt; m_notificationsToPost;</span>
<span class="udiff-line-modified-added">+     Vector&lt;std::pair&lt;RefPtr&lt;AXCoreObject&gt;, AXNotification&gt;&gt; m_notificationsToPost;</span>
  
      Timer m_passwordNotificationPostTimer;
  
      ListHashSet&lt;RefPtr&lt;AccessibilityObject&gt;&gt; m_passwordNotificationsToPost;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -475,11 +491,11 @@</span>
  
      AXTextStateChangeIntent m_textSelectionIntent;
      ListHashSet&lt;Element*&gt; m_deferredRecomputeIsIgnoredList;
      ListHashSet&lt;Node*&gt; m_deferredTextChangedList;
      ListHashSet&lt;Element*&gt; m_deferredSelectedChildredChangedList;
<span class="udiff-line-modified-removed">-     ListHashSet&lt;RefPtr&lt;AccessibilityObject&gt;&gt; m_deferredChildredChangedList;</span>
<span class="udiff-line-modified-added">+     ListHashSet&lt;RefPtr&lt;AXCoreObject&gt;&gt; m_deferredChildrenChangedList;</span>
      ListHashSet&lt;Node*&gt; m_deferredChildrenChangedNodeList;
      HashMap&lt;Element*, String&gt; m_deferredTextFormControlValue;
      HashMap&lt;Element*, QualifiedName&gt; m_deferredAttributeChange;
      Vector&lt;std::pair&lt;Node*, Node*&gt;&gt; m_deferredFocusedNodeChange;
      bool m_isSynchronizingSelection { false };
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -512,38 +528,40 @@</span>
  inline AccessibilityReplacedText::AccessibilityReplacedText(const VisibleSelection&amp;) { }
  inline void AccessibilityReplacedText::postTextStateChangeNotification(AXObjectCache*, AXTextEditType, const String&amp;, const VisibleSelection&amp;) { }
  inline void AXComputedObjectAttributeCache::setIgnored(AXID, AccessibilityObjectInclusion) { }
  inline AXObjectCache::AXObjectCache(Document&amp; document) : m_document(document), m_notificationPostTimer(*this, &amp;AXObjectCache::notificationPostTimerFired), m_passwordNotificationPostTimer(*this, &amp;AXObjectCache::passwordNotificationPostTimerFired), m_liveRegionChangedPostTimer(*this, &amp;AXObjectCache::liveRegionChangedNotificationPostTimerFired), m_focusModalNodeTimer(*this, &amp;AXObjectCache::focusModalNodeTimerFired), m_performCacheUpdateTimer(*this, &amp;AXObjectCache::performCacheUpdateTimerFired) { }
  inline AXObjectCache::~AXObjectCache() { }
<span class="udiff-line-modified-removed">- inline AccessibilityObject* AXObjectCache::focusedUIElementForPage(const Page*) { return nullptr; }</span>
<span class="udiff-line-modified-added">+ inline AXCoreObject* AXObjectCache::focusedUIElementForPage(const Page*) { return nullptr; }</span>
  inline AccessibilityObject* AXObjectCache::get(RenderObject*) { return nullptr; }
  inline AccessibilityObject* AXObjectCache::get(Node*) { return nullptr; }
  inline AccessibilityObject* AXObjectCache::get(Widget*) { return nullptr; }
  inline AccessibilityObject* AXObjectCache::getOrCreate(RenderObject*) { return nullptr; }
  inline AccessibilityObject* AXObjectCache::getOrCreate(AccessibilityRole) { return nullptr; }
  inline AccessibilityObject* AXObjectCache::getOrCreate(Node*) { return nullptr; }
  inline AccessibilityObject* AXObjectCache::getOrCreate(Widget*) { return nullptr; }
<span class="udiff-line-modified-removed">- inline AccessibilityObject* AXObjectCache::rootObject() { return nullptr; }</span>
<span class="udiff-line-modified-added">+ inline AXCoreObject* AXObjectCache::rootObject() { return nullptr; }</span>
  inline AccessibilityObject* AXObjectCache::rootObjectForFrame(Frame*) { return nullptr; }
  inline bool nodeHasRole(Node*, const String&amp;) { return false; }
  inline void AXObjectCache::startCachingComputedObjectAttributesUntilTreeMutates() { }
  inline void AXObjectCache::stopCachingComputedObjectAttributes() { }
  inline bool isNodeAriaVisible(Node*) { return true; }
  inline const Element* AXObjectCache::rootAXEditableElement(const Node*) { return nullptr; }
  inline Node* AXObjectCache::modalNode() { return nullptr; }
<span class="udiff-line-modified-removed">- inline void AXObjectCache::attachWrapper(AccessibilityObject*) { }</span>
<span class="udiff-line-modified-added">+ inline void AXObjectCache::attachWrapper(AXCoreObject*) { }</span>
  inline void AXObjectCache::checkedStateChanged(Node*) { }
<span class="udiff-line-modified-removed">- inline void AXObjectCache::childrenChanged(AccessibilityObject*) { }</span>
<span class="udiff-line-modified-added">+ inline void AXObjectCache::childrenChanged(AXCoreObject*) { }</span>
  inline void AXObjectCache::childrenChanged(Node*, Node*) { }
  inline void AXObjectCache::childrenChanged(RenderObject*, RenderObject*) { }
  inline void AXObjectCache::deferFocusedUIElementChangeIfNeeded(Node*, Node*) { }
  inline void AXObjectCache::deferRecomputeIsIgnoredIfNeeded(Element*) { }
  inline void AXObjectCache::deferRecomputeIsIgnored(Element*) { }
  inline void AXObjectCache::deferTextChangedIfNeeded(Node*) { }
  inline void AXObjectCache::deferSelectedChildrenChangedIfNeeded(Element&amp;) { }
  inline void AXObjectCache::deferTextReplacementNotificationForTextControl(HTMLTextFormControlElement&amp;, const String&amp;) { }
<span class="udiff-line-modified-removed">- inline void AXObjectCache::detachWrapper(AccessibilityObject*, AccessibilityDetachmentType) { }</span>
<span class="udiff-line-modified-added">+ #if !PLATFORM(COCOA)</span>
<span class="udiff-line-added">+ inline void AXObjectCache::detachWrapper(AXCoreObject*, AccessibilityDetachmentType) { }</span>
<span class="udiff-line-added">+ #endif</span>
  inline void AXObjectCache::focusModalNodeTimerFired() { }
  inline void AXObjectCache::performCacheUpdateTimerFired() { }
  inline void AXObjectCache::frameLoadingEventNotification(Frame*, AXLoadingEvent) { }
  inline void AXObjectCache::frameLoadingEventPlatformNotification(AccessibilityObject*, AXLoadingEvent) { }
  inline void AXObjectCache::handleActiveDescendantChanged(Node*) { }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -559,14 +577,14 @@</span>
  inline void AXObjectCache::liveRegionChangedNotificationPostTimerFired() { }
  inline void AXObjectCache::notificationPostTimerFired() { }
  inline void AXObjectCache::passwordNotificationPostTimerFired() { }
  inline void AXObjectCache::performDeferredCacheUpdate() { }
  inline void AXObjectCache::postLiveRegionChangeNotification(AccessibilityObject*) { }
<span class="udiff-line-modified-removed">- inline void AXObjectCache::postNotification(AccessibilityObject*, Document*, AXNotification, PostTarget, PostType) { }</span>
<span class="udiff-line-modified-added">+ inline void AXObjectCache::postNotification(AXCoreObject*, Document*, AXNotification, PostTarget, PostType) { }</span>
  inline void AXObjectCache::postNotification(Node*, AXNotification, PostTarget, PostType) { }
  inline void AXObjectCache::postNotification(RenderObject*, AXNotification, PostTarget, PostType) { }
<span class="udiff-line-modified-removed">- inline void AXObjectCache::postPlatformNotification(AccessibilityObject*, AXNotification) { }</span>
<span class="udiff-line-modified-added">+ inline void AXObjectCache::postPlatformNotification(AXCoreObject*, AXNotification) { }</span>
  inline void AXObjectCache::postTextReplacementNotification(Node*, AXTextEditType, const String&amp;, AXTextEditType, const String&amp;, const VisiblePosition&amp;) { }
  inline void AXObjectCache::postTextReplacementNotificationForTextControl(HTMLTextFormControlElement&amp;, const String&amp;, const String&amp;) { }
  inline void AXObjectCache::postTextStateChangeNotification(Node*, AXTextEditType, const String&amp;, const VisiblePosition&amp;) { }
  inline void AXObjectCache::postTextStateChangeNotification(Node*, const AXTextStateChangeIntent&amp;, const VisibleSelection&amp;) { }
  inline void AXObjectCache::recomputeIsIgnored(RenderObject*) { }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -582,11 +600,11 @@</span>
  inline void AXObjectCache::selectedChildrenChanged(Node*) { }
  inline void AXObjectCache::setIsSynchronizingSelection(bool) { }
  inline void AXObjectCache::setTextSelectionIntent(const AXTextStateChangeIntent&amp;) { }
  inline RefPtr&lt;Range&gt; AXObjectCache::rangeForUnorderedCharacterOffsets(const CharacterOffset&amp;, const CharacterOffset&amp;) { return nullptr; }
  inline IntRect AXObjectCache::absoluteCaretBoundsForCharacterOffset(const CharacterOffset&amp;) { return IntRect(); }
<span class="udiff-line-modified-removed">- inline CharacterOffset AXObjectCache::characterOffsetForIndex(int, const AccessibilityObject*) { return CharacterOffset(); }</span>
<span class="udiff-line-modified-added">+ inline CharacterOffset AXObjectCache::characterOffsetForIndex(int, const AXCoreObject*) { return CharacterOffset(); }</span>
  inline CharacterOffset AXObjectCache::startOrEndCharacterOffsetForRange(RefPtr&lt;Range&gt;, bool, bool) { return CharacterOffset(); }
  inline CharacterOffset AXObjectCache::endCharacterOffsetOfLine(const CharacterOffset&amp;) { return CharacterOffset(); }
  inline CharacterOffset AXObjectCache::nextCharacterOffset(const CharacterOffset&amp;, bool) { return CharacterOffset(); }
  inline CharacterOffset AXObjectCache::previousCharacterOffset(const CharacterOffset&amp;, bool) { return CharacterOffset(); }
  #if PLATFORM(COCOA)
</pre>
<center><a href="AXObjectCache.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="AccessibilityARIAGrid.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>