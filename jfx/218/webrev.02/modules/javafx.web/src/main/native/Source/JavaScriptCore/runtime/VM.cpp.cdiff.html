<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/VM.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="TypedArrayController.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="VM.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/VM.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (C) 2008-2019 Apple Inc. All rights reserved.</span>
   *
   * Redistribution and use in source and binary forms, with or without
   * modification, are permitted provided that the following conditions
   * are met:
   *
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (C) 2008-2020 Apple Inc. All rights reserved.</span>
   *
   * Redistribution and use in source and binary forms, with or without
   * modification, are permitted provided that the following conditions
   * are met:
   *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 28,19 ***</span>
  
  #include &quot;config.h&quot;
  #include &quot;VM.h&quot;
  
  #include &quot;ArgList.h&quot;
<span class="line-modified">! #include &quot;ArrayBufferNeuteringWatchpointSet.h&quot;</span>
  #include &quot;BuiltinExecutables.h&quot;
  #include &quot;BytecodeIntrinsicRegistry.h&quot;
  #include &quot;CodeBlock.h&quot;
  #include &quot;CodeCache.h&quot;
  #include &quot;CommonIdentifiers.h&quot;
  #include &quot;CommonSlowPaths.h&quot;
  #include &quot;CustomGetterSetter.h&quot;
  #include &quot;DFGWorklist.h&quot;
  #include &quot;DirectEvalExecutable.h&quot;
  #include &quot;Disassembler.h&quot;
  #include &quot;DoublePredictionFuzzerAgent.h&quot;
  #include &quot;Error.h&quot;
  #include &quot;ErrorConstructor.h&quot;
<span class="line-new-header">--- 28,25 ---</span>
  
  #include &quot;config.h&quot;
  #include &quot;VM.h&quot;
  
  #include &quot;ArgList.h&quot;
<span class="line-modified">! #include &quot;BigIntObject.h&quot;</span>
<span class="line-added">+ #include &quot;BooleanObject.h&quot;</span>
  #include &quot;BuiltinExecutables.h&quot;
  #include &quot;BytecodeIntrinsicRegistry.h&quot;
<span class="line-added">+ #include &quot;CheckpointOSRExitSideState.h&quot;</span>
<span class="line-added">+ #include &quot;ClonedArguments.h&quot;</span>
  #include &quot;CodeBlock.h&quot;
  #include &quot;CodeCache.h&quot;
  #include &quot;CommonIdentifiers.h&quot;
  #include &quot;CommonSlowPaths.h&quot;
  #include &quot;CustomGetterSetter.h&quot;
  #include &quot;DFGWorklist.h&quot;
<span class="line-added">+ #include &quot;DOMAttributeGetterSetter.h&quot;</span>
<span class="line-added">+ #include &quot;DateInstance.h&quot;</span>
<span class="line-added">+ #include &quot;DebuggerScope.h&quot;</span>
  #include &quot;DirectEvalExecutable.h&quot;
  #include &quot;Disassembler.h&quot;
  #include &quot;DoublePredictionFuzzerAgent.h&quot;
  #include &quot;Error.h&quot;
  #include &quot;ErrorConstructor.h&quot;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 48,10 ***</span>
<span class="line-new-header">--- 54,11 ---</span>
  #include &quot;EvalCodeBlock.h&quot;
  #include &quot;Exception.h&quot;
  #include &quot;ExecutableToCodeBlockEdge.h&quot;
  #include &quot;FTLThunks.h&quot;
  #include &quot;FastMallocAlignedMemoryAllocator.h&quot;
<span class="line-added">+ #include &quot;FileBasedFuzzerAgent.h&quot;</span>
  #include &quot;FunctionCodeBlock.h&quot;
  #include &quot;FunctionConstructor.h&quot;
  #include &quot;FunctionExecutable.h&quot;
  #include &quot;GCActivityCallback.h&quot;
  #include &quot;GetterSetter.h&quot;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 67,77 ***</span>
  #include &quot;Interpreter.h&quot;
  #include &quot;IntlCollatorConstructor.h&quot;
  #include &quot;IntlDateTimeFormatConstructor.h&quot;
  #include &quot;IntlNumberFormatConstructor.h&quot;
  #include &quot;IntlPluralRulesConstructor.h&quot;
  #include &quot;JITCode.h&quot;
  #include &quot;JITWorklist.h&quot;
  #include &quot;JSAPIValueWrapper.h&quot;
  #include &quot;JSArray.h&quot;
  #include &quot;JSArrayBufferConstructor.h&quot;
  #include &quot;JSAsyncFunction.h&quot;
  #include &quot;JSBigInt.h&quot;
  #include &quot;JSBoundFunction.h&quot;
  #include &quot;JSCInlines.h&quot;
  #include &quot;JSCallbackFunction.h&quot;
  #include &quot;JSCustomGetterSetterFunction.h&quot;
  #include &quot;JSDestructibleObjectHeapCellType.h&quot;
<span class="line-removed">- #include &quot;JSFixedArray.h&quot;</span>
  #include &quot;JSFunction.h&quot;
  #include &quot;JSGlobalObjectFunctions.h&quot;
  #include &quot;JSImmutableButterfly.h&quot;
<span class="line-modified">! #include &quot;JSInternalPromiseDeferred.h&quot;</span>
  #include &quot;JSLock.h&quot;
  #include &quot;JSMap.h&quot;
  #include &quot;JSMapIterator.h&quot;
<span class="line-modified">! #include &quot;JSPromiseDeferred.h&quot;</span>
  #include &quot;JSPropertyNameEnumerator.h&quot;
  #include &quot;JSScriptFetchParameters.h&quot;
  #include &quot;JSScriptFetcher.h&quot;
  #include &quot;JSSet.h&quot;
  #include &quot;JSSetIterator.h&quot;
  #include &quot;JSSourceCode.h&quot;
<span class="line-modified">! #include &quot;JSStringHeapCellType.h&quot;</span>
  #include &quot;JSTemplateObjectDescriptor.h&quot;
  #include &quot;JSWeakMap.h&quot;
  #include &quot;JSWeakObjectRef.h&quot;
  #include &quot;JSWeakSet.h&quot;
  #include &quot;JSWebAssembly.h&quot;
  #include &quot;JSWebAssemblyCodeBlock.h&quot;
<span class="line-modified">! #include &quot;JSWebAssemblyCodeBlockHeapCellType.h&quot;</span>
  #include &quot;JSWithScope.h&quot;
  #include &quot;LLIntData.h&quot;
  #include &quot;Lexer.h&quot;
  #include &quot;Lookup.h&quot;
  #include &quot;MinimumReservedZoneSize.h&quot;
  #include &quot;ModuleProgramCodeBlock.h&quot;
  #include &quot;ModuleProgramExecutable.h&quot;
  #include &quot;NativeErrorConstructor.h&quot;
  #include &quot;NativeExecutable.h&quot;
<span class="line-removed">- #include &quot;NativeStdFunctionCell.h&quot;</span>
  #include &quot;Nodes.h&quot;
<span class="line-modified">! #include &quot;ObjCCallbackFunction.h&quot;</span>
  #include &quot;Parser.h&quot;
  #include &quot;ProfilerDatabase.h&quot;
  #include &quot;ProgramCodeBlock.h&quot;
  #include &quot;ProgramExecutable.h&quot;
<span class="line-modified">! #include &quot;PromiseDeferredTimer.h&quot;</span>
  #include &quot;PropertyMapHashTable.h&quot;
  #include &quot;ProxyRevoke.h&quot;
  #include &quot;RandomizingFuzzerAgent.h&quot;
  #include &quot;RegExpCache.h&quot;
  #include &quot;RegExpObject.h&quot;
  #include &quot;RegisterAtOffsetList.h&quot;
  #include &quot;RuntimeType.h&quot;
  #include &quot;SamplingProfiler.h&quot;
  #include &quot;ShadowChicken.h&quot;
  #include &quot;SimpleTypedArrayController.h&quot;
  #include &quot;SourceProviderCache.h&quot;
  #include &quot;StackVisitor.h&quot;
  #include &quot;StrictEvalActivation.h&quot;
  #include &quot;StrongInlines.h&quot;
  #include &quot;StructureInlines.h&quot;
  #include &quot;TestRunnerUtils.h&quot;
  #include &quot;ThunkGenerators.h&quot;
  #include &quot;TypeProfiler.h&quot;
  #include &quot;TypeProfilerLog.h&quot;
  #include &quot;UnlinkedCodeBlock.h&quot;
<span class="line-new-header">--- 74,103 ---</span>
  #include &quot;Interpreter.h&quot;
  #include &quot;IntlCollatorConstructor.h&quot;
  #include &quot;IntlDateTimeFormatConstructor.h&quot;
  #include &quot;IntlNumberFormatConstructor.h&quot;
  #include &quot;IntlPluralRulesConstructor.h&quot;
<span class="line-added">+ #include &quot;IsoHeapCellType.h&quot;</span>
<span class="line-added">+ #include &quot;IsoInlinedHeapCellType.h&quot;</span>
  #include &quot;JITCode.h&quot;
  #include &quot;JITWorklist.h&quot;
<span class="line-added">+ #include &quot;JSAPIGlobalObject.h&quot;</span>
  #include &quot;JSAPIValueWrapper.h&quot;
<span class="line-added">+ #include &quot;JSAPIWrapperObject.h&quot;</span>
  #include &quot;JSArray.h&quot;
<span class="line-added">+ #include &quot;JSArrayBuffer.h&quot;</span>
  #include &quot;JSArrayBufferConstructor.h&quot;
<span class="line-added">+ #include &quot;JSArrayIterator.h&quot;</span>
  #include &quot;JSAsyncFunction.h&quot;
<span class="line-added">+ #include &quot;JSAsyncGenerator.h&quot;</span>
  #include &quot;JSBigInt.h&quot;
  #include &quot;JSBoundFunction.h&quot;
  #include &quot;JSCInlines.h&quot;
<span class="line-added">+ #include &quot;JSCallbackConstructor.h&quot;</span>
  #include &quot;JSCallbackFunction.h&quot;
<span class="line-added">+ #include &quot;JSCallbackObject.h&quot;</span>
<span class="line-added">+ #include &quot;JSCallee.h&quot;</span>
  #include &quot;JSCustomGetterSetterFunction.h&quot;
  #include &quot;JSDestructibleObjectHeapCellType.h&quot;
  #include &quot;JSFunction.h&quot;
<span class="line-added">+ #include &quot;JSGlobalLexicalEnvironment.h&quot;</span>
<span class="line-added">+ #include &quot;JSGlobalObject.h&quot;</span>
  #include &quot;JSGlobalObjectFunctions.h&quot;
  #include &quot;JSImmutableButterfly.h&quot;
<span class="line-modified">! #include &quot;JSInternalPromise.h&quot;</span>
  #include &quot;JSLock.h&quot;
  #include &quot;JSMap.h&quot;
  #include &quot;JSMapIterator.h&quot;
<span class="line-modified">! #include &quot;JSModuleNamespaceObject.h&quot;</span>
<span class="line-added">+ #include &quot;JSModuleRecord.h&quot;</span>
<span class="line-added">+ #include &quot;JSNativeStdFunction.h&quot;</span>
<span class="line-added">+ #include &quot;JSPromise.h&quot;</span>
  #include &quot;JSPropertyNameEnumerator.h&quot;
<span class="line-added">+ #include &quot;JSProxy.h&quot;</span>
  #include &quot;JSScriptFetchParameters.h&quot;
  #include &quot;JSScriptFetcher.h&quot;
  #include &quot;JSSet.h&quot;
  #include &quot;JSSetIterator.h&quot;
  #include &quot;JSSourceCode.h&quot;
<span class="line-modified">! #include &quot;JSStringIterator.h&quot;</span>
  #include &quot;JSTemplateObjectDescriptor.h&quot;
<span class="line-added">+ #include &quot;JSToWasmICCallee.h&quot;</span>
<span class="line-added">+ #include &quot;JSTypedArrays.h&quot;</span>
  #include &quot;JSWeakMap.h&quot;
  #include &quot;JSWeakObjectRef.h&quot;
  #include &quot;JSWeakSet.h&quot;
  #include &quot;JSWebAssembly.h&quot;
  #include &quot;JSWebAssemblyCodeBlock.h&quot;
<span class="line-modified">! #include &quot;JSWebAssemblyGlobal.h&quot;</span>
<span class="line-added">+ #include &quot;JSWebAssemblyInstance.h&quot;</span>
<span class="line-added">+ #include &quot;JSWebAssemblyMemory.h&quot;</span>
<span class="line-added">+ #include &quot;JSWebAssemblyModule.h&quot;</span>
<span class="line-added">+ #include &quot;JSWebAssemblyTable.h&quot;</span>
  #include &quot;JSWithScope.h&quot;
  #include &quot;LLIntData.h&quot;
  #include &quot;Lexer.h&quot;
  #include &quot;Lookup.h&quot;
  #include &quot;MinimumReservedZoneSize.h&quot;
  #include &quot;ModuleProgramCodeBlock.h&quot;
  #include &quot;ModuleProgramExecutable.h&quot;
<span class="line-added">+ #include &quot;NarrowingNumberPredictionFuzzerAgent.h&quot;</span>
  #include &quot;NativeErrorConstructor.h&quot;
  #include &quot;NativeExecutable.h&quot;
  #include &quot;Nodes.h&quot;
<span class="line-modified">! #include &quot;NumberObject.h&quot;</span>
  #include &quot;Parser.h&quot;
<span class="line-added">+ #include &quot;PredictionFileCreatingFuzzerAgent.h&quot;</span>
  #include &quot;ProfilerDatabase.h&quot;
  #include &quot;ProgramCodeBlock.h&quot;
  #include &quot;ProgramExecutable.h&quot;
<span class="line-modified">! #include &quot;PromiseTimer.h&quot;</span>
  #include &quot;PropertyMapHashTable.h&quot;
  #include &quot;ProxyRevoke.h&quot;
  #include &quot;RandomizingFuzzerAgent.h&quot;
  #include &quot;RegExpCache.h&quot;
  #include &quot;RegExpObject.h&quot;
  #include &quot;RegisterAtOffsetList.h&quot;
  #include &quot;RuntimeType.h&quot;
  #include &quot;SamplingProfiler.h&quot;
<span class="line-added">+ #include &quot;ScopedArguments.h&quot;</span>
  #include &quot;ShadowChicken.h&quot;
  #include &quot;SimpleTypedArrayController.h&quot;
  #include &quot;SourceProviderCache.h&quot;
  #include &quot;StackVisitor.h&quot;
  #include &quot;StrictEvalActivation.h&quot;
<span class="line-added">+ #include &quot;StringObject.h&quot;</span>
  #include &quot;StrongInlines.h&quot;
<span class="line-added">+ #include &quot;StructureChain.h&quot;</span>
  #include &quot;StructureInlines.h&quot;
<span class="line-added">+ #include &quot;SymbolObject.h&quot;</span>
  #include &quot;TestRunnerUtils.h&quot;
  #include &quot;ThunkGenerators.h&quot;
  #include &quot;TypeProfiler.h&quot;
  #include &quot;TypeProfilerLog.h&quot;
  #include &quot;UnlinkedCodeBlock.h&quot;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 147,12 ***</span>
  #include &quot;VariableEnvironment.h&quot;
  #include &quot;WasmWorklist.h&quot;
  #include &quot;Watchdog.h&quot;
  #include &quot;WeakGCMapInlines.h&quot;
  #include &quot;WebAssemblyFunction.h&quot;
<span class="line-modified">! #include &quot;WebAssemblyFunctionHeapCellType.h&quot;</span>
  #include &quot;WebAssemblyWrapperFunction.h&quot;
  #include &lt;wtf/ProcessID.h&gt;
  #include &lt;wtf/ReadWriteLock.h&gt;
  #include &lt;wtf/SimpleStats.h&gt;
  #include &lt;wtf/StringPrintStream.h&gt;
  #include &lt;wtf/Threading.h&gt;
<span class="line-new-header">--- 180,13 ---</span>
  #include &quot;VariableEnvironment.h&quot;
  #include &quot;WasmWorklist.h&quot;
  #include &quot;Watchdog.h&quot;
  #include &quot;WeakGCMapInlines.h&quot;
  #include &quot;WebAssemblyFunction.h&quot;
<span class="line-modified">! #include &quot;WebAssemblyModuleRecord.h&quot;</span>
  #include &quot;WebAssemblyWrapperFunction.h&quot;
<span class="line-added">+ #include &quot;WideningNumberPredictionFuzzerAgent.h&quot;</span>
  #include &lt;wtf/ProcessID.h&gt;
  #include &lt;wtf/ReadWriteLock.h&gt;
  #include &lt;wtf/SimpleStats.h&gt;
  #include &lt;wtf/StringPrintStream.h&gt;
  #include &lt;wtf/Threading.h&gt;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 170,21 ***</span>
  
  #if ENABLE(REGEXP_TRACING)
  #include &quot;RegExp.h&quot;
  #endif
  
  namespace JSC {
  
  #if ENABLE(JIT)
<span class="line-modified">! #if !ASSERT_DISABLED</span>
  bool VM::s_canUseJITIsSet = false;
  #endif
  bool VM::s_canUseJIT = false;
  #endif
  
  Atomic&lt;unsigned&gt; VM::s_numberOfIDs;
  
  // Note: Platform.h will enforce that ENABLE(ASSEMBLER) is true if either
  // ENABLE(JIT) or ENABLE(YARR_JIT) or both are enabled. The code below
  // just checks for ENABLE(JIT) or ENABLE(YARR_JIT) with this premise in mind.
  
  #if ENABLE(ASSEMBLER)
<span class="line-new-header">--- 204,39 ---</span>
  
  #if ENABLE(REGEXP_TRACING)
  #include &quot;RegExp.h&quot;
  #endif
  
<span class="line-added">+ #if JSC_OBJC_API_ENABLED</span>
<span class="line-added">+ #include &quot;ObjCCallbackFunction.h&quot;</span>
<span class="line-added">+ #endif</span>
<span class="line-added">+ </span>
<span class="line-added">+ #ifdef JSC_GLIB_API_ENABLED</span>
<span class="line-added">+ #include &quot;JSAPIWrapperGlobalObject.h&quot;</span>
<span class="line-added">+ #include &quot;JSCCallbackFunction.h&quot;</span>
<span class="line-added">+ #endif</span>
<span class="line-added">+ </span>
<span class="line-added">+ #if ENABLE(INTL)</span>
<span class="line-added">+ #include &quot;IntlCollator.h&quot;</span>
<span class="line-added">+ #include &quot;IntlDateTimeFormat.h&quot;</span>
<span class="line-added">+ #include &quot;IntlNumberFormat.h&quot;</span>
<span class="line-added">+ #include &quot;IntlPluralRules.h&quot;</span>
<span class="line-added">+ #endif</span>
<span class="line-added">+ </span>
  namespace JSC {
  
  #if ENABLE(JIT)
<span class="line-modified">! #if ASSERT_ENABLED</span>
  bool VM::s_canUseJITIsSet = false;
  #endif
  bool VM::s_canUseJIT = false;
  #endif
  
  Atomic&lt;unsigned&gt; VM::s_numberOfIDs;
  
<span class="line-added">+ DEFINE_ALLOCATOR_WITH_HEAP_IDENTIFIER(VM);</span>
<span class="line-added">+ </span>
  // Note: Platform.h will enforce that ENABLE(ASSEMBLER) is true if either
  // ENABLE(JIT) or ENABLE(YARR_JIT) or both are enabled. The code below
  // just checks for ENABLE(JIT) or ENABLE(YARR_JIT) with this premise in mind.
  
  #if ENABLE(ASSEMBLER)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 223,11 ***</span>
  }
  
  void VM::computeCanUseJIT()
  {
  #if ENABLE(JIT)
<span class="line-modified">! #if !ASSERT_DISABLED</span>
      RELEASE_ASSERT(!s_canUseJITIsSet);
      s_canUseJITIsSet = true;
  #endif
      s_canUseJIT = VM::canUseAssembler() &amp;&amp; Options::useJIT();
  #endif
<span class="line-new-header">--- 275,11 ---</span>
  }
  
  void VM::computeCanUseJIT()
  {
  #if ENABLE(JIT)
<span class="line-modified">! #if ASSERT_ENABLED</span>
      RELEASE_ASSERT(!s_canUseJITIsSet);
      s_canUseJITIsSet = true;
  #endif
      s_canUseJIT = VM::canUseAssembler() &amp;&amp; Options::useJIT();
  #endif
</pre>
<hr />
<pre>
<span class="line-old-header">*** 249,38 ***</span>
      : m_id(nextID())
      , m_apiLock(adoptRef(new JSLock(this)))
  #if USE(CF)
      , m_runLoop(CFRunLoopGetCurrent())
  #endif // USE(CF)
      , heap(*this, heapType)
      , fastMallocAllocator(makeUnique&lt;FastMallocAlignedMemoryAllocator&gt;())
      , primitiveGigacageAllocator(makeUnique&lt;GigacageAlignedMemoryAllocator&gt;(Gigacage::Primitive))
      , jsValueGigacageAllocator(makeUnique&lt;GigacageAlignedMemoryAllocator&gt;(Gigacage::JSValue))
      , auxiliaryHeapCellType(makeUnique&lt;HeapCellType&gt;(CellAttributes(DoesNotNeedDestruction, HeapCell::Auxiliary)))
      , immutableButterflyHeapCellType(makeUnique&lt;HeapCellType&gt;(CellAttributes(DoesNotNeedDestruction, HeapCell::JSCellWithInteriorPointers)))
      , cellHeapCellType(makeUnique&lt;HeapCellType&gt;(CellAttributes(DoesNotNeedDestruction, HeapCell::JSCell)))
      , destructibleCellHeapCellType(makeUnique&lt;HeapCellType&gt;(CellAttributes(NeedsDestruction, HeapCell::JSCell)))
<span class="line-modified">!     , stringHeapCellType(makeUnique&lt;JSStringHeapCellType&gt;())</span>
      , destructibleObjectHeapCellType(makeUnique&lt;JSDestructibleObjectHeapCellType&gt;())
  #if ENABLE(WEBASSEMBLY)
<span class="line-modified">!     , webAssemblyCodeBlockHeapCellType(makeUnique&lt;JSWebAssemblyCodeBlockHeapCellType&gt;())</span>
<span class="line-modified">!     , webAssemblyFunctionHeapCellType(makeUnique&lt;WebAssemblyFunctionHeapCellType&gt;())</span>
  #endif
      , primitiveGigacageAuxiliarySpace(&quot;Primitive Gigacage Auxiliary&quot;, heap, auxiliaryHeapCellType.get(), primitiveGigacageAllocator.get()) // Hash:0x3e7cd762
      , jsValueGigacageAuxiliarySpace(&quot;JSValue Gigacage Auxiliary&quot;, heap, auxiliaryHeapCellType.get(), jsValueGigacageAllocator.get()) // Hash:0x241e946
      , immutableButterflyJSValueGigacageAuxiliarySpace(&quot;ImmutableButterfly Gigacage JSCellWithInteriorPointers&quot;, heap, immutableButterflyHeapCellType.get(), jsValueGigacageAllocator.get()) // Hash:0x7a945300
      , cellSpace(&quot;JSCell&quot;, heap, cellHeapCellType.get(), fastMallocAllocator.get()) // Hash:0xadfb5a79
<span class="line-modified">!     , jsValueGigacageCellSpace(&quot;JSValue Gigacage JSCell&quot;, heap, cellHeapCellType.get(), jsValueGigacageAllocator.get()) // Hash:0x2f5b102b</span>
<span class="line-removed">-     , destructibleCellSpace(&quot;Destructible JSCell&quot;, heap, destructibleCellHeapCellType.get(), fastMallocAllocator.get()) // Hash:0xbfff3d73</span>
<span class="line-removed">-     , stringSpace(&quot;JSString&quot;, heap, stringHeapCellType.get(), fastMallocAllocator.get()) // Hash:0x90cf758f</span>
      , destructibleObjectSpace(&quot;JSDestructibleObject&quot;, heap, destructibleObjectHeapCellType.get(), fastMallocAllocator.get()) // Hash:0x4f5ed7a9
<span class="line-modified">!     , eagerlySweptDestructibleObjectSpace(&quot;Eagerly Swept JSDestructibleObject&quot;, heap, destructibleObjectHeapCellType.get(), fastMallocAllocator.get()) // Hash:0x6ebf28e2</span>
      , executableToCodeBlockEdgeSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), ExecutableToCodeBlockEdge) // Hash:0x7b730b20
      , functionSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), JSFunction) // Hash:0x800fca72
<span class="line-modified">!     , internalFunctionSpace ISO_SUBSPACE_INIT(heap, destructibleObjectHeapCellType.get(), InternalFunction) // Hash:0xf845c464</span>
      , nativeExecutableSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), NativeExecutable) // Hash:0x67567f95
      , propertyTableSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), PropertyTable) // Hash:0xc6bc9f12
      , structureRareDataSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), StructureRareData) // Hash:0xaca4e62d
      , structureSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), Structure) // Hash:0x1f1bcdca
      , symbolTableSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), SymbolTable) // Hash:0xc5215afd
      , executableToCodeBlockEdgesWithConstraints(executableToCodeBlockEdgeSpace)
      , executableToCodeBlockEdgesWithFinalizers(executableToCodeBlockEdgeSpace)
<span class="line-new-header">--- 301,92 ---</span>
      : m_id(nextID())
      , m_apiLock(adoptRef(new JSLock(this)))
  #if USE(CF)
      , m_runLoop(CFRunLoopGetCurrent())
  #endif // USE(CF)
<span class="line-added">+     , m_random(Options::seedOfVMRandomForFuzzer() ? Options::seedOfVMRandomForFuzzer() : cryptographicallyRandomNumber())</span>
<span class="line-added">+     , m_integrityRandom(*this)</span>
      , heap(*this, heapType)
      , fastMallocAllocator(makeUnique&lt;FastMallocAlignedMemoryAllocator&gt;())
      , primitiveGigacageAllocator(makeUnique&lt;GigacageAlignedMemoryAllocator&gt;(Gigacage::Primitive))
      , jsValueGigacageAllocator(makeUnique&lt;GigacageAlignedMemoryAllocator&gt;(Gigacage::JSValue))
      , auxiliaryHeapCellType(makeUnique&lt;HeapCellType&gt;(CellAttributes(DoesNotNeedDestruction, HeapCell::Auxiliary)))
      , immutableButterflyHeapCellType(makeUnique&lt;HeapCellType&gt;(CellAttributes(DoesNotNeedDestruction, HeapCell::JSCellWithInteriorPointers)))
      , cellHeapCellType(makeUnique&lt;HeapCellType&gt;(CellAttributes(DoesNotNeedDestruction, HeapCell::JSCell)))
      , destructibleCellHeapCellType(makeUnique&lt;HeapCellType&gt;(CellAttributes(NeedsDestruction, HeapCell::JSCell)))
<span class="line-modified">!     , apiGlobalObjectHeapCellType(IsoHeapCellType::create&lt;JSAPIGlobalObject&gt;())</span>
<span class="line-added">+     , callbackConstructorHeapCellType(IsoHeapCellType::create&lt;JSCallbackConstructor&gt;())</span>
<span class="line-added">+     , callbackGlobalObjectHeapCellType(IsoHeapCellType::create&lt;JSCallbackObject&lt;JSGlobalObject&gt;&gt;())</span>
<span class="line-added">+     , callbackObjectHeapCellType(IsoHeapCellType::create&lt;JSCallbackObject&lt;JSNonFinalObject&gt;&gt;())</span>
<span class="line-added">+     , dateInstanceHeapCellType(IsoHeapCellType::create&lt;DateInstance&gt;())</span>
<span class="line-added">+     , errorInstanceHeapCellType(IsoHeapCellType::create&lt;ErrorInstance&gt;())</span>
<span class="line-added">+     , globalLexicalEnvironmentHeapCellType(IsoHeapCellType::create&lt;JSGlobalLexicalEnvironment&gt;())</span>
<span class="line-added">+     , globalObjectHeapCellType(IsoHeapCellType::create&lt;JSGlobalObject&gt;())</span>
<span class="line-added">+     , jsModuleRecordHeapCellType(IsoHeapCellType::create&lt;JSModuleRecord&gt;())</span>
<span class="line-added">+     , moduleNamespaceObjectHeapCellType(IsoHeapCellType::create&lt;JSModuleNamespaceObject&gt;())</span>
<span class="line-added">+     , nativeStdFunctionHeapCellType(IsoHeapCellType::create&lt;JSNativeStdFunction&gt;())</span>
<span class="line-added">+     , stringHeapCellType(makeUnique&lt;IsoInlinedHeapCellType&lt;JSString&gt;&gt;())</span>
<span class="line-added">+     , weakMapHeapCellType(IsoHeapCellType::create&lt;JSWeakMap&gt;())</span>
<span class="line-added">+     , weakSetHeapCellType(IsoHeapCellType::create&lt;JSWeakSet&gt;())</span>
      , destructibleObjectHeapCellType(makeUnique&lt;JSDestructibleObjectHeapCellType&gt;())
<span class="line-added">+ #if JSC_OBJC_API_ENABLED</span>
<span class="line-added">+     , apiWrapperObjectHeapCellType(IsoHeapCellType::create&lt;JSCallbackObject&lt;JSAPIWrapperObject&gt;&gt;())</span>
<span class="line-added">+     , objCCallbackFunctionHeapCellType(IsoHeapCellType::create&lt;ObjCCallbackFunction&gt;())</span>
<span class="line-added">+ #endif</span>
<span class="line-added">+ #ifdef JSC_GLIB_API_ENABLED</span>
<span class="line-added">+     , apiWrapperObjectHeapCellType(IsoHeapCellType::create&lt;JSCallbackObject&lt;JSAPIWrapperObject&gt;&gt;())</span>
<span class="line-added">+     , callbackAPIWrapperGlobalObjectHeapCellType(IsoHeapCellType::create&lt;JSCallbackObject&lt;JSAPIWrapperGlobalObject&gt;&gt;())</span>
<span class="line-added">+     , jscCallbackFunctionHeapCellType(IsoHeapCellType::create&lt;JSCCallbackFunction&gt;())</span>
<span class="line-added">+ #endif</span>
<span class="line-added">+ #if ENABLE(INTL)</span>
<span class="line-added">+     , intlCollatorHeapCellType(IsoHeapCellType::create&lt;IntlCollator&gt;())</span>
<span class="line-added">+     , intlDateTimeFormatHeapCellType(IsoHeapCellType::create&lt;IntlDateTimeFormat&gt;())</span>
<span class="line-added">+     , intlNumberFormatHeapCellType(IsoHeapCellType::create&lt;IntlNumberFormat&gt;())</span>
<span class="line-added">+     , intlPluralRulesHeapCellType(IsoHeapCellType::create&lt;IntlPluralRules&gt;())</span>
<span class="line-added">+ #endif</span>
  #if ENABLE(WEBASSEMBLY)
<span class="line-modified">!     , webAssemblyCodeBlockHeapCellType(IsoHeapCellType::create&lt;JSWebAssemblyCodeBlock&gt;())</span>
<span class="line-modified">!     , webAssemblyFunctionHeapCellType(IsoHeapCellType::create&lt;WebAssemblyFunction&gt;())</span>
<span class="line-added">+     , webAssemblyGlobalHeapCellType(IsoHeapCellType::create&lt;JSWebAssemblyGlobal&gt;())</span>
<span class="line-added">+     , webAssemblyInstanceHeapCellType(IsoHeapCellType::create&lt;JSWebAssemblyInstance&gt;())</span>
<span class="line-added">+     , webAssemblyMemoryHeapCellType(IsoHeapCellType::create&lt;JSWebAssemblyMemory&gt;())</span>
<span class="line-added">+     , webAssemblyModuleHeapCellType(IsoHeapCellType::create&lt;JSWebAssemblyModule&gt;())</span>
<span class="line-added">+     , webAssemblyModuleRecordHeapCellType(IsoHeapCellType::create&lt;WebAssemblyModuleRecord&gt;())</span>
<span class="line-added">+     , webAssemblyTableHeapCellType(IsoHeapCellType::create&lt;JSWebAssemblyTable&gt;())</span>
  #endif
      , primitiveGigacageAuxiliarySpace(&quot;Primitive Gigacage Auxiliary&quot;, heap, auxiliaryHeapCellType.get(), primitiveGigacageAllocator.get()) // Hash:0x3e7cd762
      , jsValueGigacageAuxiliarySpace(&quot;JSValue Gigacage Auxiliary&quot;, heap, auxiliaryHeapCellType.get(), jsValueGigacageAllocator.get()) // Hash:0x241e946
      , immutableButterflyJSValueGigacageAuxiliarySpace(&quot;ImmutableButterfly Gigacage JSCellWithInteriorPointers&quot;, heap, immutableButterflyHeapCellType.get(), jsValueGigacageAllocator.get()) // Hash:0x7a945300
      , cellSpace(&quot;JSCell&quot;, heap, cellHeapCellType.get(), fastMallocAllocator.get()) // Hash:0xadfb5a79
<span class="line-modified">!     , variableSizedCellSpace(&quot;Variable Sized JSCell&quot;, heap, cellHeapCellType.get(), fastMallocAllocator.get()) // Hash:0xbcd769cc</span>
      , destructibleObjectSpace(&quot;JSDestructibleObject&quot;, heap, destructibleObjectHeapCellType.get(), fastMallocAllocator.get()) // Hash:0x4f5ed7a9
<span class="line-modified">!     , bigIntSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), JSBigInt)</span>
<span class="line-added">+     , calleeSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), JSCallee)</span>
<span class="line-added">+     , clonedArgumentsSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), ClonedArguments)</span>
<span class="line-added">+     , customGetterSetterSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), CustomGetterSetter)</span>
<span class="line-added">+     , dateInstanceSpace ISO_SUBSPACE_INIT(heap, dateInstanceHeapCellType.get(), DateInstance)</span>
<span class="line-added">+     , domAttributeGetterSetterSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), DOMAttributeGetterSetter)</span>
<span class="line-added">+     , exceptionSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), Exception)</span>
      , executableToCodeBlockEdgeSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), ExecutableToCodeBlockEdge) // Hash:0x7b730b20
      , functionSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), JSFunction) // Hash:0x800fca72
<span class="line-modified">!     , getterSetterSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), GetterSetter)</span>
<span class="line-added">+     , globalLexicalEnvironmentSpace ISO_SUBSPACE_INIT(heap, globalLexicalEnvironmentHeapCellType.get(), JSGlobalLexicalEnvironment)</span>
<span class="line-added">+     , internalFunctionSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), InternalFunction) // Hash:0xf845c464</span>
<span class="line-added">+     , jsProxySpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), JSProxy)</span>
      , nativeExecutableSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), NativeExecutable) // Hash:0x67567f95
<span class="line-added">+     , numberObjectSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), NumberObject)</span>
<span class="line-added">+     , promiseSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), JSPromise)</span>
<span class="line-added">+     , propertyNameEnumeratorSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), JSPropertyNameEnumerator)</span>
      , propertyTableSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), PropertyTable) // Hash:0xc6bc9f12
<span class="line-added">+     , regExpSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), RegExp)</span>
<span class="line-added">+     , regExpObjectSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), RegExpObject)</span>
<span class="line-added">+     , ropeStringSpace ISO_SUBSPACE_INIT(heap, stringHeapCellType.get(), JSRopeString)</span>
<span class="line-added">+     , scopedArgumentsSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), ScopedArguments)</span>
<span class="line-added">+     , sparseArrayValueMapSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), SparseArrayValueMap)</span>
<span class="line-added">+     , stringSpace ISO_SUBSPACE_INIT(heap, stringHeapCellType.get(), JSString) // Hash:0x90cf758f</span>
<span class="line-added">+     , stringObjectSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), StringObject)</span>
<span class="line-added">+     , structureChainSpace ISO_SUBSPACE_INIT(heap, cellHeapCellType.get(), StructureChain)</span>
      , structureRareDataSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), StructureRareData) // Hash:0xaca4e62d
      , structureSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), Structure) // Hash:0x1f1bcdca
      , symbolTableSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), SymbolTable) // Hash:0xc5215afd
      , executableToCodeBlockEdgesWithConstraints(executableToCodeBlockEdgeSpace)
      , executableToCodeBlockEdgesWithFinalizers(executableToCodeBlockEdgeSpace)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 290,11 ***</span>
      , unlinkedFunctionExecutableSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), UnlinkedFunctionExecutable) // Hash:0xf6b828d9
      , vmType(vmType)
      , clientData(0)
      , topEntryFrame(nullptr)
      , topCallFrame(CallFrame::noCaller())
<span class="line-modified">!     , promiseDeferredTimer(PromiseDeferredTimer::create(*this))</span>
      , m_atomStringTable(vmType == Default ? Thread::current().atomStringTable() : new AtomStringTable)
      , propertyNames(nullptr)
      , emptyList(new ArgList)
      , machineCodeBytesPerBytecodeWordForBaselineJIT(makeUnique&lt;SimpleStats&gt;())
      , customGetterSetterFunctionMap(*this)
<span class="line-new-header">--- 396,11 ---</span>
      , unlinkedFunctionExecutableSpace ISO_SUBSPACE_INIT(heap, destructibleCellHeapCellType.get(), UnlinkedFunctionExecutable) // Hash:0xf6b828d9
      , vmType(vmType)
      , clientData(0)
      , topEntryFrame(nullptr)
      , topCallFrame(CallFrame::noCaller())
<span class="line-modified">!     , promiseTimer(PromiseTimer::create(*this))</span>
      , m_atomStringTable(vmType == Default ? Thread::current().atomStringTable() : new AtomStringTable)
      , propertyNames(nullptr)
      , emptyList(new ArgList)
      , machineCodeBytesPerBytecodeWordForBaselineJIT(makeUnique&lt;SimpleStats&gt;())
      , customGetterSetterFunctionMap(*this)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 338,10 ***</span>
<span class="line-new-header">--- 444,11 ---</span>
      smallStrings.initializeCommonStrings(*this);
  
      propertyNames = new CommonIdentifiers(*this);
      terminatedExecutionErrorStructure.set(*this, TerminatedExecutionError::createStructure(*this, 0, jsNull()));
      propertyNameEnumeratorStructure.set(*this, JSPropertyNameEnumerator::createStructure(*this, 0, jsNull()));
<span class="line-added">+     getterSetterStructure.set(*this, GetterSetter::createStructure(*this, 0, jsNull()));</span>
      customGetterSetterStructure.set(*this, CustomGetterSetter::createStructure(*this, 0, jsNull()));
      domAttributeGetterSetterStructure.set(*this, DOMAttributeGetterSetter::createStructure(*this, 0, jsNull()));
      scopedArgumentsTableStructure.set(*this, ScopedArgumentsTable::createStructure(*this, 0, jsNull()));
      apiWrapperStructure.set(*this, JSAPIValueWrapper::createStructure(*this, 0, jsNull()));
      nativeExecutableStructure.set(*this, NativeExecutable::createStructure(*this, 0, jsNull()));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 353,11 ***</span>
  #endif
      moduleProgramExecutableStructure.set(*this, ModuleProgramExecutable::createStructure(*this, 0, jsNull()));
      regExpStructure.set(*this, RegExp::createStructure(*this, 0, jsNull()));
      symbolStructure.set(*this, Symbol::createStructure(*this, 0, jsNull()));
      symbolTableStructure.set(*this, SymbolTable::createStructure(*this, 0, jsNull()));
<span class="line-removed">-     fixedArrayStructure.set(*this, JSFixedArray::createStructure(*this, 0, jsNull()));</span>
  
      immutableButterflyStructures[arrayIndexFromIndexingType(CopyOnWriteArrayWithInt32) - NumberOfIndexingShapes].set(*this, JSImmutableButterfly::createStructure(*this, 0, jsNull(), CopyOnWriteArrayWithInt32));
      immutableButterflyStructures[arrayIndexFromIndexingType(CopyOnWriteArrayWithDouble) - NumberOfIndexingShapes].set(*this, JSImmutableButterfly::createStructure(*this, 0, jsNull(), CopyOnWriteArrayWithDouble));
      immutableButterflyStructures[arrayIndexFromIndexingType(CopyOnWriteArrayWithContiguous) - NumberOfIndexingShapes].set(*this, JSImmutableButterfly::createStructure(*this, 0, jsNull(), CopyOnWriteArrayWithContiguous));
  
<span class="line-new-header">--- 460,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 365,22 ***</span>
      scriptFetcherStructure.set(*this, JSScriptFetcher::createStructure(*this, 0, jsNull()));
      scriptFetchParametersStructure.set(*this, JSScriptFetchParameters::createStructure(*this, 0, jsNull()));
      structureChainStructure.set(*this, StructureChain::createStructure(*this, 0, jsNull()));
      sparseArrayValueMapStructure.set(*this, SparseArrayValueMap::createStructure(*this, 0, jsNull()));
      templateObjectDescriptorStructure.set(*this, JSTemplateObjectDescriptor::createStructure(*this, 0, jsNull()));
<span class="line-removed">-     arrayBufferNeuteringWatchpointStructure.set(*this, ArrayBufferNeuteringWatchpointSet::createStructure(*this));</span>
      unlinkedFunctionExecutableStructure.set(*this, UnlinkedFunctionExecutable::createStructure(*this, 0, jsNull()));
      unlinkedProgramCodeBlockStructure.set(*this, UnlinkedProgramCodeBlock::createStructure(*this, 0, jsNull()));
      unlinkedEvalCodeBlockStructure.set(*this, UnlinkedEvalCodeBlock::createStructure(*this, 0, jsNull()));
      unlinkedFunctionCodeBlockStructure.set(*this, UnlinkedFunctionCodeBlock::createStructure(*this, 0, jsNull()));
      unlinkedModuleProgramCodeBlockStructure.set(*this, UnlinkedModuleProgramCodeBlock::createStructure(*this, 0, jsNull()));
      propertyTableStructure.set(*this, PropertyTable::createStructure(*this, 0, jsNull()));
      functionRareDataStructure.set(*this, FunctionRareData::createStructure(*this, 0, jsNull()));
      exceptionStructure.set(*this, Exception::createStructure(*this, 0, jsNull()));
<span class="line-removed">-     promiseDeferredStructure.set(*this, JSPromiseDeferred::createStructure(*this, 0, jsNull()));</span>
<span class="line-removed">-     internalPromiseDeferredStructure.set(*this, JSInternalPromiseDeferred::createStructure(*this, 0, jsNull()));</span>
<span class="line-removed">-     nativeStdFunctionCellStructure.set(*this, NativeStdFunctionCell::createStructure(*this, 0, jsNull()));</span>
      programCodeBlockStructure.set(*this, ProgramCodeBlock::createStructure(*this, 0, jsNull()));
      moduleProgramCodeBlockStructure.set(*this, ModuleProgramCodeBlock::createStructure(*this, 0, jsNull()));
      evalCodeBlockStructure.set(*this, EvalCodeBlock::createStructure(*this, 0, jsNull()));
      functionCodeBlockStructure.set(*this, FunctionCodeBlock::createStructure(*this, 0, jsNull()));
      hashMapBucketSetStructure.set(*this, HashMapBucket&lt;HashMapBucketDataKey&gt;::createStructure(*this, 0, jsNull()));
<span class="line-new-header">--- 471,18 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 391,10 ***</span>
<span class="line-new-header">--- 493,11 ---</span>
      // Eagerly initialize constant cells since the concurrent compiler can access them.
      if (canUseJIT()) {
          sentinelMapBucket();
          sentinelSetBucket();
      }
<span class="line-added">+     bigIntConstantOne.set(*this, JSBigInt::createFrom(*this, 1));</span>
  
      Thread::current().setCurrentAtomStringTable(existingEntryAtomStringTable);
  
  #if !ENABLE(C_LOOP)
      initializeHostCallReturnValue(); // This is needed to convince the linker not to drop host call return support.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 441,12 ***</span>
      }
  #endif // ENABLE(SAMPLING_PROFILER)
  
      if (Options::useRandomizingFuzzerAgent())
          setFuzzerAgent(makeUnique&lt;RandomizingFuzzerAgent&gt;(*this));
<span class="line-modified">!     else if (Options::useDoublePredictionFuzzerAgent())</span>
          setFuzzerAgent(makeUnique&lt;DoublePredictionFuzzerAgent&gt;(*this));
  
      if (Options::alwaysGeneratePCToCodeOriginMap())
          setShouldBuildPCToCodeOriginMapping();
  
      if (Options::watchdog()) {
<span class="line-new-header">--- 544,20 ---</span>
      }
  #endif // ENABLE(SAMPLING_PROFILER)
  
      if (Options::useRandomizingFuzzerAgent())
          setFuzzerAgent(makeUnique&lt;RandomizingFuzzerAgent&gt;(*this));
<span class="line-modified">!     if (Options::useDoublePredictionFuzzerAgent())</span>
          setFuzzerAgent(makeUnique&lt;DoublePredictionFuzzerAgent&gt;(*this));
<span class="line-added">+     if (Options::useFileBasedFuzzerAgent())</span>
<span class="line-added">+         setFuzzerAgent(makeUnique&lt;FileBasedFuzzerAgent&gt;(*this));</span>
<span class="line-added">+     if (Options::usePredictionFileCreatingFuzzerAgent())</span>
<span class="line-added">+         setFuzzerAgent(makeUnique&lt;PredictionFileCreatingFuzzerAgent&gt;(*this));</span>
<span class="line-added">+     if (Options::useNarrowingNumberPredictionFuzzerAgent())</span>
<span class="line-added">+         setFuzzerAgent(makeUnique&lt;NarrowingNumberPredictionFuzzerAgent&gt;(*this));</span>
<span class="line-added">+     if (Options::useWideningNumberPredictionFuzzerAgent())</span>
<span class="line-added">+         setFuzzerAgent(makeUnique&lt;WideningNumberPredictionFuzzerAgent&gt;(*this));</span>
  
      if (Options::alwaysGeneratePCToCodeOriginMap())
          setShouldBuildPCToCodeOriginMapping();
  
      if (Options::watchdog()) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 468,10 ***</span>
<span class="line-new-header">--- 579,13 ---</span>
  
      if (Options::forceDebuggerBytecodeGeneration() || Options::alwaysUseShadowChicken())
          ensureShadowChicken();
  
      VMInspector::instance().add(this);
<span class="line-added">+ </span>
<span class="line-added">+     if (!g_jscConfig.disabledFreezingForTesting)</span>
<span class="line-added">+         Config::permanentlyFreeze();</span>
  }
  
  static ReadWriteLock s_destructionLock;
  
  void waitForVMDestruction()
</pre>
<hr />
<pre>
<span class="line-old-header">*** 482,11 ***</span>
  VM::~VM()
  {
      auto destructionLocker = holdLock(s_destructionLock.read());
  
      Gigacage::removePrimitiveDisableCallback(primitiveGigacageDisabledCallback, this);
<span class="line-modified">!     promiseDeferredTimer-&gt;stopRunningTasks();</span>
  #if ENABLE(WEBASSEMBLY)
      if (Wasm::Worklist* worklist = Wasm::existingWorklistOrNull())
          worklist-&gt;stopAllPlansForContext(wasmContext);
  #endif
      if (UNLIKELY(m_watchdog))
<span class="line-new-header">--- 596,11 ---</span>
  VM::~VM()
  {
      auto destructionLocker = holdLock(s_destructionLock.read());
  
      Gigacage::removePrimitiveDisableCallback(primitiveGigacageDisabledCallback, this);
<span class="line-modified">!     promiseTimer-&gt;stopRunningTasks();</span>
  #if ENABLE(WEBASSEMBLY)
      if (Wasm::Worklist* worklist = Wasm::existingWorklistOrNull())
          worklist-&gt;stopAllPlansForContext(wasmContext);
  #endif
      if (UNLIKELY(m_watchdog))
</pre>
<hr />
<pre>
<span class="line-old-header">*** 551,11 ***</span>
      delete m_rtTraceList;
  #endif
  
  #if ENABLE(DFG_JIT)
      for (unsigned i = 0; i &lt; m_scratchBuffers.size(); ++i)
<span class="line-modified">!         fastFree(m_scratchBuffers[i]);</span>
  #endif
  }
  
  void VM::primitiveGigacageDisabledCallback(void* argument)
  {
<span class="line-new-header">--- 665,11 ---</span>
      delete m_rtTraceList;
  #endif
  
  #if ENABLE(DFG_JIT)
      for (unsigned i = 0; i &lt; m_scratchBuffers.size(); ++i)
<span class="line-modified">!         VMMalloc::free(m_scratchBuffers[i]);</span>
  #endif
  }
  
  void VM::primitiveGigacageDisabledCallback(void* argument)
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 638,10 ***</span>
<span class="line-new-header">--- 752,12 ---</span>
      switch (intrinsic) {
      case CharCodeAtIntrinsic:
          return charCodeAtThunkGenerator;
      case CharAtIntrinsic:
          return charAtThunkGenerator;
<span class="line-added">+     case StringPrototypeCodePointAtIntrinsic:</span>
<span class="line-added">+         return stringPrototypeCodePointAtThunkGenerator;</span>
      case Clz32Intrinsic:
          return clz32ThunkGenerator;
      case FromCharCodeIntrinsic:
          return fromCharCodeThunkGenerator;
      case SqrtIntrinsic:
</pre>
<hr />
<pre>
<span class="line-old-header">*** 662,12 ***</span>
          return logThunkGenerator;
      case IMulIntrinsic:
          return imulThunkGenerator;
      case RandomIntrinsic:
          return randomThunkGenerator;
<span class="line-modified">!     case BoundThisNoArgsFunctionCallIntrinsic:</span>
<span class="line-modified">!         return boundThisNoArgsFunctionCallGenerator;</span>
      default:
          return nullptr;
      }
  }
  
<span class="line-new-header">--- 778,12 ---</span>
          return logThunkGenerator;
      case IMulIntrinsic:
          return imulThunkGenerator;
      case RandomIntrinsic:
          return randomThunkGenerator;
<span class="line-modified">!     case BoundFunctionCallIntrinsic:</span>
<span class="line-modified">!         return boundFunctionCallGenerator;</span>
      default:
          return nullptr;
      }
  }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 711,10 ***</span>
<span class="line-new-header">--- 827,35 ---</span>
      UNUSED_PARAM(intrinsic);
      UNUSED_PARAM(signature);
      return NativeExecutable::create(*this, jitCodeForCallTrampoline(), function, jitCodeForConstructTrampoline(), constructor, name);
  }
  
<span class="line-added">+ NativeExecutable* VM::getBoundFunction(bool isJSFunction, bool canConstruct)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     bool slowCase = !isJSFunction;</span>
<span class="line-added">+ </span>
<span class="line-added">+     auto getOrCreate = [&amp;] (Weak&lt;NativeExecutable&gt;&amp; slot) -&gt; NativeExecutable* {</span>
<span class="line-added">+         if (auto* cached = slot.get())</span>
<span class="line-added">+             return cached;</span>
<span class="line-added">+         NativeExecutable* result = getHostFunction(</span>
<span class="line-added">+             slowCase ? boundFunctionCall : boundThisNoArgsFunctionCall,</span>
<span class="line-added">+             slowCase ? NoIntrinsic : BoundFunctionCallIntrinsic,</span>
<span class="line-added">+             canConstruct ? (slowCase ? boundFunctionConstruct : boundThisNoArgsFunctionConstruct) : callHostFunctionAsConstructor, nullptr, String());</span>
<span class="line-added">+         slot = Weak&lt;NativeExecutable&gt;(result);</span>
<span class="line-added">+         return result;</span>
<span class="line-added">+     };</span>
<span class="line-added">+ </span>
<span class="line-added">+     if (slowCase) {</span>
<span class="line-added">+         if (canConstruct)</span>
<span class="line-added">+             return getOrCreate(m_slowCanConstructBoundExecutable);</span>
<span class="line-added">+         return getOrCreate(m_slowBoundExecutable);</span>
<span class="line-added">+     }</span>
<span class="line-added">+     if (canConstruct)</span>
<span class="line-added">+         return getOrCreate(m_fastCanConstructBoundExecutable);</span>
<span class="line-added">+     return getOrCreate(m_fastBoundExecutable);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  MacroAssemblerCodePtr&lt;JSEntryPtrTag&gt; VM::getCTIInternalFunctionTrampolineFor(CodeSpecializationKind kind)
  {
  #if ENABLE(JIT)
      if (canUseJIT()) {
          if (kind == CodeForCall)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 791,45 ***</span>
  void VM::clearSourceProviderCaches()
  {
      sourceProviderCacheMap.clear();
  }
  
<span class="line-modified">! Exception* VM::throwException(ExecState* exec, Exception* exception)</span>
  {
<span class="line-modified">!     ASSERT(exec == topCallFrame || exec-&gt;isGlobalExec() || exec == exec-&gt;lexicalGlobalObject()-&gt;callFrameAtDebuggerEntry());</span>
<span class="line-modified">!     CallFrame* throwOriginFrame = exec-&gt;isGlobalExec() ? exec : topJSCallFrame();</span>
  
<span class="line-modified">!     if (Options::breakOnThrow()) {</span>
          CodeBlock* codeBlock = throwOriginFrame ? throwOriginFrame-&gt;codeBlock() : nullptr;
          dataLog(&quot;Throwing exception in call frame &quot;, RawPointer(throwOriginFrame), &quot; for code block &quot;, codeBlock, &quot;\n&quot;);
          CRASH();
      }
  
<span class="line-modified">!     interpreter-&gt;notifyDebuggerOfExceptionToBeThrown(*this, throwOriginFrame, exception);</span>
  
      setException(exception);
  
  #if ENABLE(EXCEPTION_SCOPE_VERIFICATION)
      m_nativeStackTraceOfLastThrow = StackTrace::captureStackTrace(Options::unexpectedExceptionStackTraceLimit());
      m_throwingThread = &amp;Thread::current();
  #endif
      return exception;
  }
  
<span class="line-modified">! Exception* VM::throwException(ExecState* exec, JSValue thrownValue)</span>
  {
      VM&amp; vm = *this;
      Exception* exception = jsDynamicCast&lt;Exception*&gt;(vm, thrownValue);
      if (!exception)
          exception = Exception::create(*this, thrownValue);
  
<span class="line-modified">!     return throwException(exec, exception);</span>
  }
  
<span class="line-modified">! Exception* VM::throwException(ExecState* exec, JSObject* error)</span>
  {
<span class="line-modified">!     return throwException(exec, JSValue(error));</span>
  }
  
  void VM::setStackPointerAtVMEntry(void* sp)
  {
      m_stackPointerAtVMEntry = sp;
<span class="line-new-header">--- 932,46 ---</span>
  void VM::clearSourceProviderCaches()
  {
      sourceProviderCacheMap.clear();
  }
  
<span class="line-modified">! Exception* VM::throwException(JSGlobalObject* globalObject, Exception* exception)</span>
  {
<span class="line-modified">!     CallFrame* throwOriginFrame = topJSCallFrame();</span>
<span class="line-modified">!     if (!throwOriginFrame)</span>
<span class="line-added">+         throwOriginFrame = globalObject-&gt;deprecatedCallFrameForDebugger();</span>
  
<span class="line-modified">!     if (UNLIKELY(Options::breakOnThrow())) {</span>
          CodeBlock* codeBlock = throwOriginFrame ? throwOriginFrame-&gt;codeBlock() : nullptr;
          dataLog(&quot;Throwing exception in call frame &quot;, RawPointer(throwOriginFrame), &quot; for code block &quot;, codeBlock, &quot;\n&quot;);
          CRASH();
      }
  
<span class="line-modified">!     interpreter-&gt;notifyDebuggerOfExceptionToBeThrown(*this, globalObject, throwOriginFrame, exception);</span>
  
      setException(exception);
  
  #if ENABLE(EXCEPTION_SCOPE_VERIFICATION)
      m_nativeStackTraceOfLastThrow = StackTrace::captureStackTrace(Options::unexpectedExceptionStackTraceLimit());
      m_throwingThread = &amp;Thread::current();
  #endif
      return exception;
  }
  
<span class="line-modified">! Exception* VM::throwException(JSGlobalObject* globalObject, JSValue thrownValue)</span>
  {
      VM&amp; vm = *this;
      Exception* exception = jsDynamicCast&lt;Exception*&gt;(vm, thrownValue);
      if (!exception)
          exception = Exception::create(*this, thrownValue);
  
<span class="line-modified">!     return throwException(globalObject, exception);</span>
  }
  
<span class="line-modified">! Exception* VM::throwException(JSGlobalObject* globalObject, JSObject* error)</span>
  {
<span class="line-modified">!     return throwException(globalObject, JSValue(error));</span>
  }
  
  void VM::setStackPointerAtVMEntry(void* sp)
  {
      m_stackPointerAtVMEntry = sp;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 872,11 ***</span>
          *p = ch;
      }
  }
  #endif
  
<span class="line-modified">! inline void VM::updateStackLimits()</span>
  {
  #if OS(WINDOWS)
      void* lastSoftStackLimit = m_softStackLimit;
  #endif
  
<span class="line-new-header">--- 1014,11 ---</span>
          *p = ch;
      }
  }
  #endif
  
<span class="line-modified">! void VM::updateStackLimits()</span>
  {
  #if OS(WINDOWS)
      void* lastSoftStackLimit = m_softStackLimit;
  #endif
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 887,11 ***</span>
      // We don&#39;t have the ability to assert here that it hasn&#39;t changed, but we can at least assert
      // that the value is sane.
      RELEASE_ASSERT(reservedZoneSize &gt;= minimumReservedZoneSize);
  
      if (m_stackPointerAtVMEntry) {
<span class="line-removed">-         ASSERT(stack.isGrowingDownward());</span>
          char* startOfStack = reinterpret_cast&lt;char*&gt;(m_stackPointerAtVMEntry);
          m_softStackLimit = stack.recursionLimit(startOfStack, Options::maxPerThreadStackUsage(), m_currentSoftReservedZoneSize);
          m_stackLimit = stack.recursionLimit(startOfStack, Options::maxPerThreadStackUsage(), reservedZoneSize);
      } else {
          m_softStackLimit = stack.recursionLimit(m_currentSoftReservedZoneSize);
<span class="line-new-header">--- 1029,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 921,12 ***</span>
<span class="line-new-header">--- 1062,35 ---</span>
              void* bufferStart = scratchBuffer-&gt;dataBuffer();
              conservativeRoots.add(bufferStart, static_cast&lt;void*&gt;(static_cast&lt;char*&gt;(bufferStart) + scratchBuffer-&gt;activeLength()));
          }
      }
  }
<span class="line-added">+ </span>
<span class="line-added">+ void VM::scanSideState(ConservativeRoots&amp; roots) const</span>
<span class="line-added">+ {</span>
<span class="line-added">+     ASSERT(heap.worldIsStopped());</span>
<span class="line-added">+     for (const auto&amp; iter : m_checkpointSideState) {</span>
<span class="line-added">+         static_assert(sizeof(iter.value-&gt;tmps) / sizeof(JSValue) == maxNumCheckpointTmps);</span>
<span class="line-added">+         roots.add(iter.value-&gt;tmps, iter.value-&gt;tmps + maxNumCheckpointTmps);</span>
<span class="line-added">+     }</span>
<span class="line-added">+ }</span>
  #endif
  
<span class="line-added">+ void VM::addCheckpointOSRSideState(CallFrame* callFrame, std::unique_ptr&lt;CheckpointOSRExitSideState&gt;&amp;&amp; payload)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     ASSERT(currentThreadIsHoldingAPILock());</span>
<span class="line-added">+     auto addResult = m_checkpointSideState.add(callFrame, WTFMove(payload));</span>
<span class="line-added">+     ASSERT_UNUSED(addResult, addResult.isNewEntry);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ std::unique_ptr&lt;CheckpointOSRExitSideState&gt; VM::findCheckpointOSRSideState(CallFrame* callFrame)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     ASSERT(currentThreadIsHoldingAPILock());</span>
<span class="line-added">+     auto sideState = m_checkpointSideState.take(callFrame);</span>
<span class="line-added">+     return sideState;</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  void logSanitizeStack(VM&amp; vm)
  {
      if (Options::verboseSanitizeStack() &amp;&amp; vm.topCallFrame) {
          int dummy;
          auto&amp; stackBounds = Thread::current().stack();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 990,24 ***</span>
  void VM::dumpRegExpTrace()
  {
  }
  #endif
  
<span class="line-modified">! WatchpointSet* VM::ensureWatchpointSetForImpureProperty(const Identifier&amp; propertyName)</span>
  {
<span class="line-modified">!     auto result = m_impurePropertyWatchpointSets.add(propertyName.string(), nullptr);</span>
      if (result.isNewEntry)
          result.iterator-&gt;value = adoptRef(new WatchpointSet(IsWatched));
      return result.iterator-&gt;value.get();
  }
  
<span class="line-modified">! void VM::registerWatchpointForImpureProperty(const Identifier&amp; propertyName, Watchpoint* watchpoint)</span>
<span class="line-removed">- {</span>
<span class="line-removed">-     ensureWatchpointSetForImpureProperty(propertyName)-&gt;add(watchpoint);</span>
<span class="line-removed">- }</span>
<span class="line-removed">- </span>
<span class="line-removed">- void VM::addImpureProperty(const String&amp; propertyName)</span>
  {
      if (RefPtr&lt;WatchpointSet&gt; watchpointSet = m_impurePropertyWatchpointSets.take(propertyName))
          watchpointSet-&gt;fireAll(*this, &quot;Impure property added&quot;);
  }
  
<span class="line-new-header">--- 1154,19 ---</span>
  void VM::dumpRegExpTrace()
  {
  }
  #endif
  
<span class="line-modified">! WatchpointSet* VM::ensureWatchpointSetForImpureProperty(UniquedStringImpl* propertyName)</span>
  {
<span class="line-modified">!     auto result = m_impurePropertyWatchpointSets.add(propertyName, nullptr);</span>
      if (result.isNewEntry)
          result.iterator-&gt;value = adoptRef(new WatchpointSet(IsWatched));
      return result.iterator-&gt;value.get();
  }
  
<span class="line-modified">! void VM::addImpureProperty(UniquedStringImpl* propertyName)</span>
  {
      if (RefPtr&lt;WatchpointSet&gt; watchpointSet = m_impurePropertyWatchpointSets.take(propertyName))
          watchpointSet-&gt;fireAll(*this, &quot;Impure property added&quot;);
  }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1103,11 ***</span>
      ASSERT(callType != CallType::None);
  
      MarkedArgumentBuffer args;
      args.append(promise.get());
      args.append(promise-&gt;result(*this));
<span class="line-modified">!     call(promise-&gt;globalObject()-&gt;globalExec(), callback, callType, callData, jsNull(), args);</span>
      scope.clearException();
  }
  
  void VM::didExhaustMicrotaskQueue()
  {
<span class="line-new-header">--- 1262,11 ---</span>
      ASSERT(callType != CallType::None);
  
      MarkedArgumentBuffer args;
      args.append(promise.get());
      args.append(promise-&gt;result(*this));
<span class="line-modified">!     call(promise-&gt;globalObject(), callback, callType, callData, jsNull(), args);</span>
      scope.clearException();
  }
  
  void VM::didExhaustMicrotaskQueue()
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1138,11 ***</span>
      finalizeSynchronousJSExecution();
  }
  
  void QueuedTask::run()
  {
<span class="line-modified">!     m_microtask-&gt;run(m_globalObject-&gt;globalExec());</span>
  }
  
  void sanitizeStackForVM(VM&amp; vm)
  {
      logSanitizeStack(vm);
<span class="line-new-header">--- 1297,11 ---</span>
      finalizeSynchronousJSExecution();
  }
  
  void QueuedTask::run()
  {
<span class="line-modified">!     m_microtask-&gt;run(m_globalObject.get());</span>
  }
  
  void sanitizeStackForVM(VM&amp; vm)
  {
      logSanitizeStack(vm);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1161,11 ***</span>
  size_t VM::committedStackByteCount()
  {
  #if !ENABLE(C_LOOP)
      // When using the C stack, we don&#39;t know how many stack pages are actually
      // committed. So, we use the current stack usage as an estimate.
<span class="line-removed">-     ASSERT(Thread::current().stack().isGrowingDownward());</span>
      uint8_t* current = bitwise_cast&lt;uint8_t*&gt;(currentStackPointer());
      uint8_t* high = bitwise_cast&lt;uint8_t*&gt;(Thread::current().stack().origin());
      return high - current;
  #else
      return CLoopStack::committedByteCount();
<span class="line-new-header">--- 1320,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1280,25 ***</span>
          m_##name = WTFMove(space); \
          return m_##name.get(); \
      }
  
  
  DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(boundFunctionSpace, cellHeapCellType.get(), JSBoundFunction) // Hash:0xd7916d41
<span class="line-modified">! DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(callbackFunctionSpace, destructibleObjectHeapCellType.get(), JSCallbackFunction) // Hash:0xe7648ebc</span>
  DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(customGetterSetterFunctionSpace, cellHeapCellType.get(), JSCustomGetterSetterFunction) // Hash:0x18091000
<span class="line-modified">! DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(errorInstanceSpace, destructibleObjectHeapCellType.get(), ErrorInstance) // Hash:0x3f40d4a</span>
<span class="line-modified">! DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(nativeStdFunctionSpace, cellHeapCellType.get(), JSNativeStdFunction) // Hash:0x70ed61e4</span>
<span class="line-modified">! DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(proxyRevokeSpace, destructibleObjectHeapCellType.get(), ProxyRevoke) // Hash:0xb506a939</span>
<span class="line-modified">! DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(weakMapSpace, destructibleObjectHeapCellType.get(), JSWeakMap) // Hash:0x662b12a3</span>
<span class="line-modified">! DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(weakSetSpace, destructibleObjectHeapCellType.get(), JSWeakSet) // Hash:0x4c781b30</span>
  DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(weakObjectRefSpace, cellHeapCellType.get(), JSWeakObjectRef) // Hash:0x8ec68f1f
  #if JSC_OBJC_API_ENABLED
<span class="line-modified">! DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(objCCallbackFunctionSpace, destructibleObjectHeapCellType.get(), ObjCCallbackFunction) // Hash:0x10f610b8</span>
  #endif
  #if ENABLE(WEBASSEMBLY)
  DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(webAssemblyCodeBlockSpace, webAssemblyCodeBlockHeapCellType.get(), JSWebAssemblyCodeBlock) // Hash:0x9ad995cd
  DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(webAssemblyFunctionSpace, webAssemblyFunctionHeapCellType.get(), WebAssemblyFunction) // Hash:0x8b7c32db
  DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(webAssemblyWrapperFunctionSpace, cellHeapCellType.get(), WebAssemblyWrapperFunction) // Hash:0xd4a5ff01
  #endif
  
  #undef DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW
  
<span class="line-new-header">--- 1438,91 ---</span>
          m_##name = WTFMove(space); \
          return m_##name.get(); \
      }
  
  
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(apiGlobalObjectSpace, apiGlobalObjectHeapCellType.get(), JSAPIGlobalObject)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(apiValueWrapperSpace, cellHeapCellType.get(), JSAPIValueWrapper)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(arrayBufferSpace, cellHeapCellType.get(), JSArrayBuffer)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(arrayIteratorSpace, cellHeapCellType.get(), JSArrayIterator)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(asyncGeneratorSpace, cellHeapCellType.get(), JSAsyncGenerator)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(bigIntObjectSpace, cellHeapCellType.get(), BigIntObject)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(booleanObjectSpace, cellHeapCellType.get(), BooleanObject)</span>
  DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(boundFunctionSpace, cellHeapCellType.get(), JSBoundFunction) // Hash:0xd7916d41
<span class="line-modified">! DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(callbackConstructorSpace, callbackConstructorHeapCellType.get(), JSCallbackConstructor)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(callbackGlobalObjectSpace, callbackGlobalObjectHeapCellType.get(), JSCallbackObject&lt;JSGlobalObject&gt;)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(callbackFunctionSpace, cellHeapCellType.get(), JSCallbackFunction) // Hash:0xe7648ebc</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(callbackObjectSpace, callbackObjectHeapCellType.get(), JSCallbackObject&lt;JSNonFinalObject&gt;)</span>
  DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(customGetterSetterFunctionSpace, cellHeapCellType.get(), JSCustomGetterSetterFunction) // Hash:0x18091000
<span class="line-modified">! DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(dataViewSpace, cellHeapCellType.get(), JSDataView)</span>
<span class="line-modified">! DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(debuggerScopeSpace, cellHeapCellType.get(), DebuggerScope)</span>
<span class="line-modified">! DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(errorInstanceSpace, errorInstanceHeapCellType.get(), ErrorInstance) // Hash:0x3f40d4a</span>
<span class="line-modified">! DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(float32ArraySpace, cellHeapCellType.get(), JSFloat32Array)</span>
<span class="line-modified">! DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(float64ArraySpace, cellHeapCellType.get(), JSFloat64Array)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(functionRareDataSpace, destructibleCellHeapCellType.get(), FunctionRareData)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(generatorSpace, cellHeapCellType.get(), JSGenerator)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(globalObjectSpace, globalObjectHeapCellType.get(), JSGlobalObject)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(jsModuleRecordSpace, jsModuleRecordHeapCellType.get(), JSModuleRecord)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(int8ArraySpace, cellHeapCellType.get(), JSInt8Array)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(int16ArraySpace, cellHeapCellType.get(), JSInt16Array)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(int32ArraySpace, cellHeapCellType.get(), JSInt32Array)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(mapBucketSpace, cellHeapCellType.get(), JSMap::BucketType)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(mapIteratorSpace, cellHeapCellType.get(), JSMapIterator)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(mapSpace, cellHeapCellType.get(), JSMap)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(moduleNamespaceObjectSpace, moduleNamespaceObjectHeapCellType.get(), JSModuleNamespaceObject)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(nativeStdFunctionSpace, nativeStdFunctionHeapCellType.get(), JSNativeStdFunction) // Hash:0x70ed61e4</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(proxyObjectSpace, cellHeapCellType.get(), ProxyObject)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(proxyRevokeSpace, cellHeapCellType.get(), ProxyRevoke) // Hash:0xb506a939</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(scopedArgumentsTableSpace, destructibleCellHeapCellType.get(), ScopedArgumentsTable)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(scriptFetchParametersSpace, destructibleCellHeapCellType.get(), JSScriptFetchParameters)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(scriptFetcherSpace, destructibleCellHeapCellType.get(), JSScriptFetcher)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(setBucketSpace, cellHeapCellType.get(), JSSet::BucketType)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(setIteratorSpace, cellHeapCellType.get(), JSSetIterator)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(setSpace, cellHeapCellType.get(), JSSet)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(strictEvalActivationSpace, cellHeapCellType.get(), StrictEvalActivation)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(stringIteratorSpace, cellHeapCellType.get(), JSStringIterator)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(sourceCodeSpace, destructibleCellHeapCellType.get(), JSSourceCode)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(symbolSpace, destructibleCellHeapCellType.get(), Symbol)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(symbolObjectSpace, cellHeapCellType.get(), SymbolObject)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(templateObjectDescriptorSpace, destructibleCellHeapCellType.get(), JSTemplateObjectDescriptor)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(uint8ArraySpace, cellHeapCellType.get(), JSUint8Array)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(uint8ClampedArraySpace, cellHeapCellType.get(), JSUint8ClampedArray)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(uint16ArraySpace, cellHeapCellType.get(), JSUint16Array)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(uint32ArraySpace, cellHeapCellType.get(), JSUint32Array)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(unlinkedEvalCodeBlockSpace, destructibleCellHeapCellType.get(), UnlinkedEvalCodeBlock)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(unlinkedFunctionCodeBlockSpace, destructibleCellHeapCellType.get(), UnlinkedFunctionCodeBlock)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(unlinkedModuleProgramCodeBlockSpace, destructibleCellHeapCellType.get(), UnlinkedModuleProgramCodeBlock)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(unlinkedProgramCodeBlockSpace, destructibleCellHeapCellType.get(), UnlinkedProgramCodeBlock)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(weakMapSpace, weakMapHeapCellType.get(), JSWeakMap) // Hash:0x662b12a3</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(weakSetSpace, weakSetHeapCellType.get(), JSWeakSet) // Hash:0x4c781b30</span>
  DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(weakObjectRefSpace, cellHeapCellType.get(), JSWeakObjectRef) // Hash:0x8ec68f1f
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(withScopeSpace, cellHeapCellType.get(), JSWithScope)</span>
  #if JSC_OBJC_API_ENABLED
<span class="line-modified">! DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(apiWrapperObjectSpace, apiWrapperObjectHeapCellType.get(), JSCallbackObject&lt;JSAPIWrapperObject&gt;)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(objCCallbackFunctionSpace, objCCallbackFunctionHeapCellType.get(), ObjCCallbackFunction) // Hash:0x10f610b8</span>
<span class="line-added">+ #endif</span>
<span class="line-added">+ #ifdef JSC_GLIB_API_ENABLED</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(apiWrapperObjectSpace, apiWrapperObjectHeapCellType.get(), JSCallbackObject&lt;JSAPIWrapperObject&gt;)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(jscCallbackFunctionSpace, jscCallbackFunctionHeapCellType.get(), JSCCallbackFunction)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(callbackAPIWrapperGlobalObjectSpace, callbackAPIWrapperGlobalObjectHeapCellType.get(), JSCallbackObject&lt;JSAPIWrapperGlobalObject&gt;)</span>
<span class="line-added">+ #endif</span>
<span class="line-added">+ #if ENABLE(INTL)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(intlCollatorSpace, intlCollatorHeapCellType.get(), IntlCollator)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(intlDateTimeFormatSpace, intlDateTimeFormatHeapCellType.get(), IntlDateTimeFormat)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(intlNumberFormatSpace, intlNumberFormatHeapCellType.get(), IntlNumberFormat)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(intlPluralRulesSpace, intlPluralRulesHeapCellType.get(), IntlPluralRules)</span>
  #endif
  #if ENABLE(WEBASSEMBLY)
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(jsToWasmICCalleeSpace, cellHeapCellType.get(), JSToWasmICCallee)</span>
  DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(webAssemblyCodeBlockSpace, webAssemblyCodeBlockHeapCellType.get(), JSWebAssemblyCodeBlock) // Hash:0x9ad995cd
  DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(webAssemblyFunctionSpace, webAssemblyFunctionHeapCellType.get(), WebAssemblyFunction) // Hash:0x8b7c32db
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(webAssemblyGlobalSpace, webAssemblyGlobalHeapCellType.get(), JSWebAssemblyGlobal)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(webAssemblyInstanceSpace, webAssemblyInstanceHeapCellType.get(), JSWebAssemblyInstance)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(webAssemblyMemorySpace, webAssemblyMemoryHeapCellType.get(), JSWebAssemblyMemory)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(webAssemblyModuleSpace, webAssemblyModuleHeapCellType.get(), JSWebAssemblyModule)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(webAssemblyModuleRecordSpace, webAssemblyModuleRecordHeapCellType.get(), WebAssemblyModuleRecord)</span>
<span class="line-added">+ DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(webAssemblyTableSpace, webAssemblyTableHeapCellType.get(), JSWebAssemblyTable)</span>
  DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW(webAssemblyWrapperFunctionSpace, cellHeapCellType.get(), WebAssemblyWrapperFunction) // Hash:0xd4a5ff01
  #endif
  
  #undef DYNAMIC_ISO_SUBSPACE_DEFINE_MEMBER_SLOW
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1354,19 ***</span>
      auto* enumerator = JSPropertyNameEnumerator::create(*this, nullptr, 0, 0, WTFMove(propertyNames));
      m_emptyPropertyNameEnumerator.set(*this, enumerator);
      return enumerator;
  }
  
<span class="line-modified">! JSGlobalObject* VM::vmEntryGlobalObject(const CallFrame* callFrame) const</span>
  {
<span class="line-modified">!     if (callFrame &amp;&amp; callFrame-&gt;isGlobalExec()) {</span>
<span class="line-modified">!         ASSERT(callFrame-&gt;callee().isCell() &amp;&amp; callFrame-&gt;callee().asCell()-&gt;isObject());</span>
<span class="line-modified">!         ASSERT(callFrame == callFrame-&gt;lexicalGlobalObject()-&gt;globalExec());</span>
<span class="line-removed">-         return callFrame-&gt;lexicalGlobalObject();</span>
<span class="line-removed">-     }</span>
<span class="line-removed">-     ASSERT(entryScope);</span>
<span class="line-removed">-     return entryScope-&gt;globalObject();</span>
  }
  
  void VM::setCrashOnVMCreation(bool shouldCrash)
  {
      vmCreationShouldCrash = shouldCrash;
<span class="line-new-header">--- 1578,15 ---</span>
      auto* enumerator = JSPropertyNameEnumerator::create(*this, nullptr, 0, 0, WTFMove(propertyNames));
      m_emptyPropertyNameEnumerator.set(*this, enumerator);
      return enumerator;
  }
  
<span class="line-modified">! JSGlobalObject* VM::deprecatedVMEntryGlobalObject(JSGlobalObject* globalObject) const</span>
  {
<span class="line-modified">!     if (entryScope)</span>
<span class="line-modified">!         return entryScope-&gt;globalObject();</span>
<span class="line-modified">!     return globalObject;</span>
  }
  
  void VM::setCrashOnVMCreation(bool shouldCrash)
  {
      vmCreationShouldCrash = shouldCrash;
</pre>
<center><a href="TypedArrayController.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="VM.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>