<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/ConsoleObject.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (C) 2014-2016 Apple Inc. All rights reserved.
  3  *
  4  * Redistribution and use in source and binary forms, with or without
  5  * modification, are permitted provided that the following conditions
  6  * are met:
  7  * 1. Redistributions of source code must retain the above copyright
  8  *    notice, this list of conditions and the following disclaimer.
  9  * 2. Redistributions in binary form must reproduce the above copyright
 10  *    notice, this list of conditions and the following disclaimer in the
 11  *    documentation and/or other materials provided with the distribution.
 12  *
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
 14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 15  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #include &quot;config.h&quot;
 27 #include &quot;ConsoleObject.h&quot;
 28 
 29 #include &quot;ConsoleClient.h&quot;
 30 #include &quot;Error.h&quot;
 31 #include &quot;JSCInlines.h&quot;
 32 #include &quot;ScriptArguments.h&quot;
 33 #include &quot;ScriptCallStackFactory.h&quot;
 34 
 35 namespace JSC {
 36 
<a name="1" id="anc1"></a><span class="line-modified"> 37 static String valueOrDefaultLabelString(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
 38 {
<a name="2" id="anc2"></a><span class="line-modified"> 39     if (callFrame-&gt;argumentCount() &lt; 1)</span>
 40         return &quot;default&quot;_s;
 41 
<a name="3" id="anc3"></a><span class="line-modified"> 42     auto value = callFrame-&gt;argument(0);</span>
 43     if (value.isUndefined())
 44         return &quot;default&quot;_s;
 45 
<a name="4" id="anc4"></a><span class="line-modified"> 46     return value.toWTFString(globalObject);</span>
 47 }
 48 
 49 STATIC_ASSERT_IS_TRIVIALLY_DESTRUCTIBLE(ConsoleObject);
 50 
<a name="5" id="anc5"></a><span class="line-modified"> 51 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDebug(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 52 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncError(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 53 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncLog(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 54 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncInfo(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 55 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncWarn(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 56 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncClear(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 57 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDir(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 58 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDirXML(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 59 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTable(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 60 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTrace(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 61 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncAssert(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 62 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncCount(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 63 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncCountReset(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 64 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncProfile(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 65 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncProfileEnd(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 66 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTakeHeapSnapshot(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 67 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTime(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 68 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeLog(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 69 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeEnd(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 70 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeStamp(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 71 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroup(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 72 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroupCollapsed(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 73 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroupEnd(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 74 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncRecord(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 75 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncRecordEnd(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 76 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncScreenshot(JSGlobalObject*, CallFrame*);</span>
 77 
 78 const ClassInfo ConsoleObject::s_info = { &quot;Console&quot;, &amp;Base::s_info, nullptr, nullptr, CREATE_METHOD_TABLE(ConsoleObject) };
 79 
 80 ConsoleObject::ConsoleObject(VM&amp; vm, Structure* structure)
 81     : JSNonFinalObject(vm, structure)
 82 {
 83 }
 84 
 85 void ConsoleObject::finishCreation(VM&amp; vm, JSGlobalObject* globalObject)
 86 {
 87     Base::finishCreation(vm);
 88     ASSERT(inherits(vm, info()));
 89 
 90     // For legacy reasons, console properties are enumerable, writable, deleteable,
 91     // and all have a length of 0. This may change if Console is standardized.
 92 
 93     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;debug&quot;, consoleProtoFuncDebug, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
 94     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;error&quot;, consoleProtoFuncError, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
 95     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;log&quot;, consoleProtoFuncLog, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
 96     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;info&quot;, consoleProtoFuncInfo, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
 97     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;warn&quot;, consoleProtoFuncWarn, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
 98 
 99     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;clear, consoleProtoFuncClear, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
100     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;dir&quot;, consoleProtoFuncDir, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
101     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;dirxml&quot;, consoleProtoFuncDirXML, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
102     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;table&quot;, consoleProtoFuncTable, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
103     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;trace&quot;, consoleProtoFuncTrace, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
104     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;assert&quot;, consoleProtoFuncAssert, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
105     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;count, consoleProtoFuncCount, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
106     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;countReset&quot;, consoleProtoFuncCountReset, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
107     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;profile&quot;, consoleProtoFuncProfile, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
108     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;profileEnd&quot;, consoleProtoFuncProfileEnd, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
109     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;time&quot;, consoleProtoFuncTime, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
110     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;timeLog&quot;, consoleProtoFuncTimeLog, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
111     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;timeEnd&quot;, consoleProtoFuncTimeEnd, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
112     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;timeStamp&quot;, consoleProtoFuncTimeStamp, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
113     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;takeHeapSnapshot&quot;, consoleProtoFuncTakeHeapSnapshot, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
114     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;group&quot;, consoleProtoFuncGroup, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
115     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;groupCollapsed&quot;, consoleProtoFuncGroupCollapsed, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
116     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;groupEnd&quot;, consoleProtoFuncGroupEnd, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
117     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;record&quot;, consoleProtoFuncRecord, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
118     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;recordEnd&quot;, consoleProtoFuncRecordEnd, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
119     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;screenshot&quot;, consoleProtoFuncScreenshot, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
120 }
121 
<a name="6" id="anc6"></a><span class="line-modified">122 static String valueToStringWithUndefinedOrNullCheck(JSGlobalObject* globalObject, JSValue value)</span>
123 {
124     if (value.isUndefinedOrNull())
125         return String();
<a name="7" id="anc7"></a><span class="line-modified">126     return value.toWTFString(globalObject);</span>
127 }
128 
<a name="8" id="anc8"></a><span class="line-modified">129 static EncodedJSValue consoleLogWithLevel(JSGlobalObject* globalObject, CallFrame* callFrame, MessageLevel level)</span>
130 {
<a name="9" id="anc9"></a><span class="line-modified">131     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
132     if (!client)
133         return JSValue::encode(jsUndefined());
134 
<a name="10" id="anc10"></a><span class="line-modified">135     client-&gt;logWithLevel(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0), level);</span>
136     return JSValue::encode(jsUndefined());
137 }
138 
<a name="11" id="anc11"></a><span class="line-modified">139 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDebug(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
140 {
<a name="12" id="anc12"></a><span class="line-modified">141     return consoleLogWithLevel(globalObject, callFrame, MessageLevel::Debug);</span>
142 }
143 
<a name="13" id="anc13"></a><span class="line-modified">144 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncError(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
145 {
<a name="14" id="anc14"></a><span class="line-modified">146     return consoleLogWithLevel(globalObject, callFrame, MessageLevel::Error);</span>
147 }
148 
<a name="15" id="anc15"></a><span class="line-modified">149 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncLog(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
150 {
<a name="16" id="anc16"></a><span class="line-modified">151     return consoleLogWithLevel(globalObject, callFrame, MessageLevel::Log);</span>
152 }
153 
<a name="17" id="anc17"></a><span class="line-modified">154 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncInfo(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
155 {
<a name="18" id="anc18"></a><span class="line-modified">156     return consoleLogWithLevel(globalObject, callFrame, MessageLevel::Info);</span>
157 }
158 
<a name="19" id="anc19"></a><span class="line-modified">159 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncWarn(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
160 {
<a name="20" id="anc20"></a><span class="line-modified">161     return consoleLogWithLevel(globalObject, callFrame, MessageLevel::Warning);</span>
162 }
163 
<a name="21" id="anc21"></a><span class="line-modified">164 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncClear(JSGlobalObject* globalObject, CallFrame*)</span>
165 {
<a name="22" id="anc22"></a><span class="line-modified">166     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
167     if (!client)
168         return JSValue::encode(jsUndefined());
169 
<a name="23" id="anc23"></a><span class="line-modified">170     client-&gt;clear(globalObject);</span>
171     return JSValue::encode(jsUndefined());
172 }
173 
<a name="24" id="anc24"></a><span class="line-modified">174 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDir(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
175 {
<a name="25" id="anc25"></a><span class="line-modified">176     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
177     if (!client)
178         return JSValue::encode(jsUndefined());
179 
<a name="26" id="anc26"></a><span class="line-modified">180     client-&gt;dir(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
181     return JSValue::encode(jsUndefined());
182 }
183 
<a name="27" id="anc27"></a><span class="line-modified">184 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDirXML(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
185 {
<a name="28" id="anc28"></a><span class="line-modified">186     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
187     if (!client)
188         return JSValue::encode(jsUndefined());
189 
<a name="29" id="anc29"></a><span class="line-modified">190     client-&gt;dirXML(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
191     return JSValue::encode(jsUndefined());
192 }
193 
<a name="30" id="anc30"></a><span class="line-modified">194 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTable(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
195 {
<a name="31" id="anc31"></a><span class="line-modified">196     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
197     if (!client)
198         return JSValue::encode(jsUndefined());
199 
<a name="32" id="anc32"></a><span class="line-modified">200     client-&gt;table(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
201     return JSValue::encode(jsUndefined());
202 }
203 
<a name="33" id="anc33"></a><span class="line-modified">204 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTrace(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
205 {
<a name="34" id="anc34"></a><span class="line-modified">206     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
207     if (!client)
208         return JSValue::encode(jsUndefined());
209 
<a name="35" id="anc35"></a><span class="line-modified">210     client-&gt;trace(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
211     return JSValue::encode(jsUndefined());
212 }
213 
<a name="36" id="anc36"></a><span class="line-modified">214 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncAssert(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
215 {
<a name="37" id="anc37"></a><span class="line-modified">216     VM&amp; vm = globalObject-&gt;vm();</span>
217     auto scope = DECLARE_THROW_SCOPE(vm);
<a name="38" id="anc38"></a><span class="line-modified">218     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
219     if (!client)
220         return JSValue::encode(jsUndefined());
221 
<a name="39" id="anc39"></a><span class="line-modified">222     bool condition = callFrame-&gt;argument(0).toBoolean(globalObject);</span>
223     RETURN_IF_EXCEPTION(scope, encodedJSValue());
224 
225     if (condition)
226         return JSValue::encode(jsUndefined());
227 
<a name="40" id="anc40"></a><span class="line-modified">228     client-&gt;assertion(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 1));</span>
229     return JSValue::encode(jsUndefined());
230 }
231 
<a name="41" id="anc41"></a><span class="line-modified">232 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncCount(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
233 {
<a name="42" id="anc42"></a><span class="line-modified">234     auto scope = DECLARE_THROW_SCOPE(globalObject-&gt;vm());</span>
<span class="line-modified">235     auto* client = globalObject-&gt;consoleClient();</span>
236     if (!client)
237         return JSValue::encode(jsUndefined());
238 
<a name="43" id="anc43"></a><span class="line-modified">239     auto label = valueOrDefaultLabelString(globalObject, callFrame);</span>
240     RETURN_IF_EXCEPTION(scope, encodedJSValue());
241 
<a name="44" id="anc44"></a><span class="line-modified">242     client-&gt;count(globalObject, label);</span>
243     return JSValue::encode(jsUndefined());
244 }
245 
<a name="45" id="anc45"></a><span class="line-modified">246 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncCountReset(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
247 {
<a name="46" id="anc46"></a><span class="line-modified">248     auto scope = DECLARE_THROW_SCOPE(globalObject-&gt;vm());</span>
<span class="line-modified">249     auto* client = globalObject-&gt;consoleClient();</span>
250     if (!client)
251         return JSValue::encode(jsUndefined());
252 
<a name="47" id="anc47"></a><span class="line-modified">253     auto label = valueOrDefaultLabelString(globalObject, callFrame);</span>
254     RETURN_IF_EXCEPTION(scope, encodedJSValue());
255 
<a name="48" id="anc48"></a><span class="line-modified">256     client-&gt;countReset(globalObject, label);</span>
257     return JSValue::encode(jsUndefined());
258 }
259 
<a name="49" id="anc49"></a><span class="line-modified">260 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncProfile(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
261 {
<a name="50" id="anc50"></a><span class="line-modified">262     VM&amp; vm = globalObject-&gt;vm();</span>
263     auto scope = DECLARE_THROW_SCOPE(vm);
<a name="51" id="anc51"></a><span class="line-modified">264     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
265     if (!client)
266         return JSValue::encode(jsUndefined());
267 
<a name="52" id="anc52"></a><span class="line-modified">268     size_t argsCount = callFrame-&gt;argumentCount();</span>
269     if (!argsCount) {
<a name="53" id="anc53"></a><span class="line-modified">270         client-&gt;profile(globalObject, String());</span>
271         return JSValue::encode(jsUndefined());
272     }
273 
<a name="54" id="anc54"></a><span class="line-modified">274     const String&amp; title(valueToStringWithUndefinedOrNullCheck(globalObject, callFrame-&gt;argument(0)));</span>
275     RETURN_IF_EXCEPTION(scope, encodedJSValue());
276 
<a name="55" id="anc55"></a><span class="line-modified">277     client-&gt;profile(globalObject, title);</span>
278     return JSValue::encode(jsUndefined());
279 }
280 
<a name="56" id="anc56"></a><span class="line-modified">281 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncProfileEnd(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
282 {
<a name="57" id="anc57"></a><span class="line-modified">283     VM&amp; vm = globalObject-&gt;vm();</span>
284     auto scope = DECLARE_THROW_SCOPE(vm);
<a name="58" id="anc58"></a><span class="line-modified">285     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
286     if (!client)
287         return JSValue::encode(jsUndefined());
288 
<a name="59" id="anc59"></a><span class="line-modified">289     size_t argsCount = callFrame-&gt;argumentCount();</span>
290     if (!argsCount) {
<a name="60" id="anc60"></a><span class="line-modified">291         client-&gt;profileEnd(globalObject, String());</span>
292         return JSValue::encode(jsUndefined());
293     }
294 
<a name="61" id="anc61"></a><span class="line-modified">295     const String&amp; title(valueToStringWithUndefinedOrNullCheck(globalObject, callFrame-&gt;argument(0)));</span>
296     RETURN_IF_EXCEPTION(scope, encodedJSValue());
297 
<a name="62" id="anc62"></a><span class="line-modified">298     client-&gt;profileEnd(globalObject, title);</span>
299     return JSValue::encode(jsUndefined());
300 }
301 
<a name="63" id="anc63"></a><span class="line-modified">302 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTakeHeapSnapshot(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
303 {
<a name="64" id="anc64"></a><span class="line-modified">304     VM&amp; vm = globalObject-&gt;vm();</span>
305     auto scope = DECLARE_THROW_SCOPE(vm);
<a name="65" id="anc65"></a><span class="line-modified">306     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
307     if (!client)
308         return JSValue::encode(jsUndefined());
309 
<a name="66" id="anc66"></a><span class="line-modified">310     size_t argsCount = callFrame-&gt;argumentCount();</span>
311     if (!argsCount) {
<a name="67" id="anc67"></a><span class="line-modified">312         client-&gt;takeHeapSnapshot(globalObject, String());</span>
313         return JSValue::encode(jsUndefined());
314     }
315 
<a name="68" id="anc68"></a><span class="line-modified">316     const String&amp; title(valueToStringWithUndefinedOrNullCheck(globalObject, callFrame-&gt;argument(0)));</span>
317     RETURN_IF_EXCEPTION(scope, encodedJSValue());
318 
<a name="69" id="anc69"></a><span class="line-modified">319     client-&gt;takeHeapSnapshot(globalObject, title);</span>
320     return JSValue::encode(jsUndefined());
321 }
322 
<a name="70" id="anc70"></a><span class="line-modified">323 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTime(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
324 {
<a name="71" id="anc71"></a><span class="line-modified">325     auto scope = DECLARE_THROW_SCOPE(globalObject-&gt;vm());</span>
<span class="line-modified">326     auto* client = globalObject-&gt;consoleClient();</span>
327     if (!client)
328         return JSValue::encode(jsUndefined());
329 
<a name="72" id="anc72"></a><span class="line-modified">330     auto label = valueOrDefaultLabelString(globalObject, callFrame);</span>
331     RETURN_IF_EXCEPTION(scope, encodedJSValue());
332 
<a name="73" id="anc73"></a><span class="line-modified">333     client-&gt;time(globalObject, label);</span>
334     return JSValue::encode(jsUndefined());
335 }
336 
<a name="74" id="anc74"></a><span class="line-modified">337 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeLog(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
338 {
<a name="75" id="anc75"></a><span class="line-modified">339     auto scope = DECLARE_THROW_SCOPE(globalObject-&gt;vm());</span>
<span class="line-modified">340     auto* client = globalObject-&gt;consoleClient();</span>
341     if (!client)
342         return JSValue::encode(jsUndefined());
343 
<a name="76" id="anc76"></a><span class="line-modified">344     auto label = valueOrDefaultLabelString(globalObject, callFrame);</span>
345     RETURN_IF_EXCEPTION(scope, encodedJSValue());
346 
<a name="77" id="anc77"></a><span class="line-modified">347     client-&gt;timeLog(globalObject, label, Inspector::createScriptArguments(globalObject, callFrame, 1));</span>
348     return JSValue::encode(jsUndefined());
349 }
350 
<a name="78" id="anc78"></a><span class="line-modified">351 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeEnd(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
352 {
<a name="79" id="anc79"></a><span class="line-modified">353     auto scope = DECLARE_THROW_SCOPE(globalObject-&gt;vm());</span>
<span class="line-modified">354     auto* client = globalObject-&gt;consoleClient();</span>
355     if (!client)
356         return JSValue::encode(jsUndefined());
357 
<a name="80" id="anc80"></a><span class="line-modified">358     auto label = valueOrDefaultLabelString(globalObject, callFrame);</span>
359     RETURN_IF_EXCEPTION(scope, encodedJSValue());
360 
<a name="81" id="anc81"></a><span class="line-modified">361     client-&gt;timeEnd(globalObject, label);</span>
362     return JSValue::encode(jsUndefined());
363 }
364 
<a name="82" id="anc82"></a><span class="line-modified">365 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeStamp(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
366 {
<a name="83" id="anc83"></a><span class="line-modified">367     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
368     if (!client)
369         return JSValue::encode(jsUndefined());
370 
<a name="84" id="anc84"></a><span class="line-modified">371     client-&gt;timeStamp(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
372     return JSValue::encode(jsUndefined());
373 }
374 
<a name="85" id="anc85"></a><span class="line-modified">375 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroup(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
376 {
<a name="86" id="anc86"></a><span class="line-modified">377     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
378     if (!client)
379         return JSValue::encode(jsUndefined());
380 
<a name="87" id="anc87"></a><span class="line-modified">381     client-&gt;group(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
382     return JSValue::encode(jsUndefined());
383 }
384 
<a name="88" id="anc88"></a><span class="line-modified">385 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroupCollapsed(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
386 {
<a name="89" id="anc89"></a><span class="line-modified">387     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
388     if (!client)
389         return JSValue::encode(jsUndefined());
390 
<a name="90" id="anc90"></a><span class="line-modified">391     client-&gt;groupCollapsed(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
392     return JSValue::encode(jsUndefined());
393 }
394 
<a name="91" id="anc91"></a><span class="line-modified">395 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroupEnd(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
396 {
<a name="92" id="anc92"></a><span class="line-modified">397     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
398     if (!client)
399         return JSValue::encode(jsUndefined());
400 
<a name="93" id="anc93"></a><span class="line-modified">401     client-&gt;groupEnd(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
402     return JSValue::encode(jsUndefined());
403 }
404 
<a name="94" id="anc94"></a><span class="line-modified">405 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncRecord(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
406 {
<a name="95" id="anc95"></a><span class="line-modified">407     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
408     if (!client)
409         return JSValue::encode(jsUndefined());
410 
<a name="96" id="anc96"></a><span class="line-modified">411     client-&gt;record(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
412     return JSValue::encode(jsUndefined());
413 }
414 
<a name="97" id="anc97"></a><span class="line-modified">415 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncRecordEnd(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
416 {
<a name="98" id="anc98"></a><span class="line-modified">417     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
418     if (!client)
419         return JSValue::encode(jsUndefined());
420 
<a name="99" id="anc99"></a><span class="line-modified">421     client-&gt;recordEnd(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
422     return JSValue::encode(jsUndefined());
423 }
424 
<a name="100" id="anc100"></a><span class="line-modified">425 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncScreenshot(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
426 {
<a name="101" id="anc101"></a><span class="line-modified">427     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
428     if (!client)
429         return JSValue::encode(jsUndefined());
430 
<a name="102" id="anc102"></a><span class="line-modified">431     client-&gt;screenshot(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
432     return JSValue::encode(jsUndefined());
433 }
434 
435 } // namespace JSC
<a name="103" id="anc103"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="103" type="hidden" />
</body>
</html>