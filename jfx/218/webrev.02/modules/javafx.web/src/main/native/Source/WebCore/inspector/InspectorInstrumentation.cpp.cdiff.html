<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/inspector/InspectorInstrumentation.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="InspectorFrontendHost.idl.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="InspectorInstrumentation.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/inspector/InspectorInstrumentation.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 31,19 ***</span>
<span class="line-new-header">--- 31,22 ---</span>
  
  #include &quot;config.h&quot;
  #include &quot;InspectorInstrumentation.h&quot;
  
  #include &quot;CachedResource.h&quot;
<span class="line-added">+ #include &quot;ComputedEffectTiming.h&quot;</span>
  #include &quot;CustomHeaderFields.h&quot;
  #include &quot;DOMWindow.h&quot;
  #include &quot;DOMWrapperWorld.h&quot;
  #include &quot;DocumentLoader.h&quot;
  #include &quot;Event.h&quot;
  #include &quot;Frame.h&quot;
<span class="line-added">+ #include &quot;InspectorAnimationAgent.h&quot;</span>
  #include &quot;InspectorApplicationCacheAgent.h&quot;
  #include &quot;InspectorCSSAgent.h&quot;
  #include &quot;InspectorCanvasAgent.h&quot;
<span class="line-added">+ #include &quot;InspectorController.h&quot;</span>
  #include &quot;InspectorDOMAgent.h&quot;
  #include &quot;InspectorDOMDebuggerAgent.h&quot;
  #include &quot;InspectorDOMStorageAgent.h&quot;
  #include &quot;InspectorDatabaseAgent.h&quot;
  #include &quot;InspectorLayerTreeAgent.h&quot;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 51,39 ***</span>
  #include &quot;InspectorNetworkAgent.h&quot;
  #include &quot;InspectorPageAgent.h&quot;
  #include &quot;InspectorTimelineAgent.h&quot;
  #include &quot;InspectorWorkerAgent.h&quot;
  #include &quot;InstrumentingAgents.h&quot;
  #include &quot;LoaderStrategy.h&quot;
  #include &quot;PageDebuggerAgent.h&quot;
  #include &quot;PageHeapAgent.h&quot;
  #include &quot;PageRuntimeAgent.h&quot;
  #include &quot;PlatformStrategies.h&quot;
  #include &quot;RenderObject.h&quot;
  #include &quot;RenderView.h&quot;
  #include &quot;ScriptController.h&quot;
  #include &quot;ScriptExecutionContext.h&quot;
  #include &quot;WebConsoleAgent.h&quot;
  #include &quot;WebGLRenderingContextBase.h&quot;
  #include &quot;WebSocketFrame.h&quot;
  #include &lt;JavaScriptCore/ConsoleMessage.h&gt;
  #include &lt;JavaScriptCore/ConsoleTypes.h&gt;
  #include &lt;JavaScriptCore/InspectorDebuggerAgent.h&gt;
  #include &lt;JavaScriptCore/ScriptArguments.h&gt;
  #include &lt;JavaScriptCore/ScriptCallStack.h&gt;
  #include &lt;wtf/StdLibExtras.h&gt;
  
  namespace WebCore {
  
  using namespace Inspector;
  
  namespace {
  static HashSet&lt;InstrumentingAgents*&gt;* s_instrumentingAgentsSet = nullptr;
  }
  
<span class="line-removed">- int InspectorInstrumentation::s_frontendCounter = 0;</span>
<span class="line-removed">- </span>
  void InspectorInstrumentation::firstFrontendCreated()
  {
      platformStrategies()-&gt;loaderStrategy()-&gt;setCaptureExtraNetworkLoadMetricsEnabled(true);
  }
  
<span class="line-new-header">--- 54,47 ---</span>
  #include &quot;InspectorNetworkAgent.h&quot;
  #include &quot;InspectorPageAgent.h&quot;
  #include &quot;InspectorTimelineAgent.h&quot;
  #include &quot;InspectorWorkerAgent.h&quot;
  #include &quot;InstrumentingAgents.h&quot;
<span class="line-added">+ #include &quot;KeyframeEffect.h&quot;</span>
  #include &quot;LoaderStrategy.h&quot;
<span class="line-added">+ #include &quot;PageDOMDebuggerAgent.h&quot;</span>
  #include &quot;PageDebuggerAgent.h&quot;
  #include &quot;PageHeapAgent.h&quot;
  #include &quot;PageRuntimeAgent.h&quot;
  #include &quot;PlatformStrategies.h&quot;
  #include &quot;RenderObject.h&quot;
  #include &quot;RenderView.h&quot;
  #include &quot;ScriptController.h&quot;
  #include &quot;ScriptExecutionContext.h&quot;
  #include &quot;WebConsoleAgent.h&quot;
<span class="line-added">+ #include &quot;WebDebuggerAgent.h&quot;</span>
  #include &quot;WebGLRenderingContextBase.h&quot;
<span class="line-added">+ #include &quot;WebGPUDevice.h&quot;</span>
  #include &quot;WebSocketFrame.h&quot;
<span class="line-added">+ #include &quot;WorkerGlobalScope.h&quot;</span>
<span class="line-added">+ #include &quot;WorkerInspectorController.h&quot;</span>
  #include &lt;JavaScriptCore/ConsoleMessage.h&gt;
  #include &lt;JavaScriptCore/ConsoleTypes.h&gt;
  #include &lt;JavaScriptCore/InspectorDebuggerAgent.h&gt;
  #include &lt;JavaScriptCore/ScriptArguments.h&gt;
  #include &lt;JavaScriptCore/ScriptCallStack.h&gt;
  #include &lt;wtf/StdLibExtras.h&gt;
  
<span class="line-added">+ #if ENABLE(WEBGPU)</span>
<span class="line-added">+ #include &quot;WebGPUSwapChain.h&quot;</span>
<span class="line-added">+ #endif</span>
<span class="line-added">+ </span>
  namespace WebCore {
  
  using namespace Inspector;
  
  namespace {
  static HashSet&lt;InstrumentingAgents*&gt;* s_instrumentingAgentsSet = nullptr;
  }
  
  void InspectorInstrumentation::firstFrontendCreated()
  {
      platformStrategies()-&gt;loaderStrategy()-&gt;setCaptureExtraNetworkLoadMetricsEnabled(true);
  }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 108,25 ***</span>
      return frame;
  }
  
  void InspectorInstrumentation::didClearWindowObjectInWorldImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame, DOMWrapperWorld&amp; world)
  {
<span class="line-modified">!     if (PageDebuggerAgent* debuggerAgent = instrumentingAgents.pageDebuggerAgent()) {</span>
<span class="line-modified">!         if (&amp;world == &amp;mainThreadNormalWorld() &amp;&amp; frame.isMainFrame())</span>
<span class="line-removed">-             debuggerAgent-&gt;didClearMainFrameWindowObject();</span>
<span class="line-removed">-     }</span>
  
<span class="line-modified">!     if (PageRuntimeAgent* pageRuntimeAgent = instrumentingAgents.pageRuntimeAgent()) {</span>
<span class="line-modified">!         if (&amp;world == &amp;mainThreadNormalWorld())</span>
<span class="line-modified">!             pageRuntimeAgent-&gt;didCreateMainWorldContext(frame);</span>
<span class="line-modified">!     }</span>
  }
  
  bool InspectorInstrumentation::isDebuggerPausedImpl(InstrumentingAgents&amp; instrumentingAgents)
  {
<span class="line-modified">!     if (InspectorDebuggerAgent* debuggerAgent = instrumentingAgents.inspectorDebuggerAgent())</span>
<span class="line-modified">!         return debuggerAgent-&gt;isPaused();</span>
      return false;
  }
  
  int InspectorInstrumentation::identifierForNodeImpl(InstrumentingAgents&amp; instrumentingAgents, Node&amp; node)
  {
<span class="line-new-header">--- 119,24 ---</span>
      return frame;
  }
  
  void InspectorInstrumentation::didClearWindowObjectInWorldImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame, DOMWrapperWorld&amp; world)
  {
<span class="line-modified">!     if (auto* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
<span class="line-modified">!         pageDebuggerAgent-&gt;didClearWindowObjectInWorld(frame, world);</span>
  
<span class="line-modified">!     if (auto* pageRuntimeAgent = instrumentingAgents.pageRuntimeAgent())</span>
<span class="line-modified">!         pageRuntimeAgent-&gt;didClearWindowObjectInWorld(frame, world);</span>
<span class="line-modified">! </span>
<span class="line-modified">!     if (auto* pageAgent = instrumentingAgents.inspectorPageAgent())</span>
<span class="line-added">+         pageAgent-&gt;didClearWindowObjectInWorld(frame, world);</span>
  }
  
  bool InspectorInstrumentation::isDebuggerPausedImpl(InstrumentingAgents&amp; instrumentingAgents)
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         return webDebuggerAgent-&gt;isPaused();</span>
      return false;
  }
  
  int InspectorInstrumentation::identifierForNodeImpl(InstrumentingAgents&amp; instrumentingAgents, Node&amp; node)
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 141,40 ***</span>
          domAgent-&gt;addEventListenersToNode(node);
  }
  
  void InspectorInstrumentation::willInsertDOMNodeImpl(InstrumentingAgents&amp; instrumentingAgents, Node&amp; parent)
  {
<span class="line-modified">!     if (InspectorDOMDebuggerAgent* domDebuggerAgent = instrumentingAgents.inspectorDOMDebuggerAgent())</span>
<span class="line-modified">!         domDebuggerAgent-&gt;willInsertDOMNode(parent);</span>
  }
  
  void InspectorInstrumentation::didInsertDOMNodeImpl(InstrumentingAgents&amp; instrumentingAgents, Node&amp; node)
  {
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;didInsertDOMNode(node);
<span class="line-modified">!     if (InspectorDOMDebuggerAgent* domDebuggerAgent = instrumentingAgents.inspectorDOMDebuggerAgent())</span>
<span class="line-modified">!         domDebuggerAgent-&gt;didInsertDOMNode(node);</span>
  }
  
  void InspectorInstrumentation::willRemoveDOMNodeImpl(InstrumentingAgents&amp; instrumentingAgents, Node&amp; node)
  {
<span class="line-modified">!     if (InspectorDOMDebuggerAgent* domDebuggerAgent = instrumentingAgents.inspectorDOMDebuggerAgent())</span>
<span class="line-modified">!         domDebuggerAgent-&gt;willRemoveDOMNode(node);</span>
  }
  
  void InspectorInstrumentation::didRemoveDOMNodeImpl(InstrumentingAgents&amp; instrumentingAgents, Node&amp; node)
  {
<span class="line-modified">!     if (InspectorDOMDebuggerAgent* domDebuggerAgent = instrumentingAgents.inspectorDOMDebuggerAgent())</span>
<span class="line-modified">!         domDebuggerAgent-&gt;didRemoveDOMNode(node);</span>
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;didRemoveDOMNode(node);
  }
  
  void InspectorInstrumentation::willModifyDOMAttrImpl(InstrumentingAgents&amp; instrumentingAgents, Element&amp; element, const AtomString&amp; oldValue, const AtomString&amp; newValue)
  {
<span class="line-modified">!     if (InspectorDOMDebuggerAgent* domDebuggerAgent = instrumentingAgents.inspectorDOMDebuggerAgent())</span>
<span class="line-modified">!         domDebuggerAgent-&gt;willModifyDOMAttr(element);</span>
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;willModifyDOMAttr(element, oldValue, newValue);
  }
  
  void InspectorInstrumentation::didModifyDOMAttrImpl(InstrumentingAgents&amp; instrumentingAgents, Element&amp; element, const AtomString&amp; name, const AtomString&amp; value)
<span class="line-new-header">--- 151,40 ---</span>
          domAgent-&gt;addEventListenersToNode(node);
  }
  
  void InspectorInstrumentation::willInsertDOMNodeImpl(InstrumentingAgents&amp; instrumentingAgents, Node&amp; parent)
  {
<span class="line-modified">!     if (auto* pageDOMDebuggerAgent = instrumentingAgents.pageDOMDebuggerAgent())</span>
<span class="line-modified">!         pageDOMDebuggerAgent-&gt;willInsertDOMNode(parent);</span>
  }
  
  void InspectorInstrumentation::didInsertDOMNodeImpl(InstrumentingAgents&amp; instrumentingAgents, Node&amp; node)
  {
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;didInsertDOMNode(node);
<span class="line-modified">!     if (auto* pageDOMDebuggerAgent = instrumentingAgents.pageDOMDebuggerAgent())</span>
<span class="line-modified">!         pageDOMDebuggerAgent-&gt;didInsertDOMNode(node);</span>
  }
  
  void InspectorInstrumentation::willRemoveDOMNodeImpl(InstrumentingAgents&amp; instrumentingAgents, Node&amp; node)
  {
<span class="line-modified">!     if (auto* pageDOMDebuggerAgent = instrumentingAgents.pageDOMDebuggerAgent())</span>
<span class="line-modified">!         pageDOMDebuggerAgent-&gt;willRemoveDOMNode(node);</span>
  }
  
  void InspectorInstrumentation::didRemoveDOMNodeImpl(InstrumentingAgents&amp; instrumentingAgents, Node&amp; node)
  {
<span class="line-modified">!     if (auto* pageDOMDebuggerAgent = instrumentingAgents.pageDOMDebuggerAgent())</span>
<span class="line-modified">!         pageDOMDebuggerAgent-&gt;didRemoveDOMNode(node);</span>
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;didRemoveDOMNode(node);
  }
  
  void InspectorInstrumentation::willModifyDOMAttrImpl(InstrumentingAgents&amp; instrumentingAgents, Element&amp; element, const AtomString&amp; oldValue, const AtomString&amp; newValue)
  {
<span class="line-modified">!     if (auto* pageDOMDebuggerAgent = instrumentingAgents.pageDOMDebuggerAgent())</span>
<span class="line-modified">!         pageDOMDebuggerAgent-&gt;willModifyDOMAttr(element);</span>
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;willModifyDOMAttr(element, oldValue, newValue);
  }
  
  void InspectorInstrumentation::didModifyDOMAttrImpl(InstrumentingAgents&amp; instrumentingAgents, Element&amp; element, const AtomString&amp; name, const AtomString&amp; value)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 189,12 ***</span>
          domAgent-&gt;didRemoveDOMAttr(element, name);
  }
  
  void InspectorInstrumentation::willInvalidateStyleAttrImpl(InstrumentingAgents&amp; instrumentingAgents, Element&amp; element)
  {
<span class="line-modified">!     if (auto* domDebuggerAgent = instrumentingAgents.inspectorDOMDebuggerAgent())</span>
<span class="line-modified">!         domDebuggerAgent-&gt;willInvalidateStyleAttr(element);</span>
  }
  
  void InspectorInstrumentation::didInvalidateStyleAttrImpl(InstrumentingAgents&amp; instrumentingAgents, Element&amp; element)
  {
      if (auto* domAgent = instrumentingAgents.inspectorDOMAgent())
<span class="line-new-header">--- 199,12 ---</span>
          domAgent-&gt;didRemoveDOMAttr(element, name);
  }
  
  void InspectorInstrumentation::willInvalidateStyleAttrImpl(InstrumentingAgents&amp; instrumentingAgents, Element&amp; element)
  {
<span class="line-modified">!     if (auto* pageDOMDebuggerAgent = instrumentingAgents.pageDOMDebuggerAgent())</span>
<span class="line-modified">!         pageDOMDebuggerAgent-&gt;willInvalidateStyleAttr(element);</span>
  }
  
  void InspectorInstrumentation::didInvalidateStyleAttrImpl(InstrumentingAgents&amp; instrumentingAgents, Element&amp; element)
  {
      if (auto* domAgent = instrumentingAgents.inspectorDOMAgent())
</pre>
<hr />
<pre>
<span class="line-old-header">*** 207,11 ***</span>
          cssAgent-&gt;documentDetached(document);
  }
  
  void InspectorInstrumentation::frameWindowDiscardedImpl(InstrumentingAgents&amp; instrumentingAgents, DOMWindow* window)
  {
<span class="line-modified">!     if (!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled())</span>
          return;
  
      if (WebConsoleAgent* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;frameWindowDiscarded(window);
  }
<span class="line-new-header">--- 217,11 ---</span>
          cssAgent-&gt;documentDetached(document);
  }
  
  void InspectorInstrumentation::frameWindowDiscardedImpl(InstrumentingAgents&amp; instrumentingAgents, DOMWindow* window)
  {
<span class="line-modified">!     if (LIKELY(!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled()))</span>
          return;
  
      if (WebConsoleAgent* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;frameWindowDiscarded(window);
  }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 311,37 ***</span>
          domDebuggerAgent-&gt;willFetch(url);
  }
  
  void InspectorInstrumentation::didInstallTimerImpl(InstrumentingAgents&amp; instrumentingAgents, int timerId, Seconds timeout, bool singleShot, ScriptExecutionContext&amp; context)
  {
<span class="line-modified">!     if (InspectorDebuggerAgent* debuggerAgent = instrumentingAgents.inspectorDebuggerAgent())</span>
<span class="line-modified">!         debuggerAgent-&gt;didScheduleAsyncCall(context.execState(), InspectorDebuggerAgent::AsyncCallType::DOMTimer, timerId, singleShot);</span>
  
      if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())
          timelineAgent-&gt;didInstallTimer(timerId, timeout, singleShot, frameForScriptExecutionContext(context));
  }
  
  void InspectorInstrumentation::didRemoveTimerImpl(InstrumentingAgents&amp; instrumentingAgents, int timerId, ScriptExecutionContext&amp; context)
  {
<span class="line-modified">!     if (InspectorDebuggerAgent* debuggerAgent = instrumentingAgents.inspectorDebuggerAgent())</span>
<span class="line-modified">!         debuggerAgent-&gt;didCancelAsyncCall(InspectorDebuggerAgent::AsyncCallType::DOMTimer, timerId);</span>
      if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())
          timelineAgent-&gt;didRemoveTimer(timerId, frameForScriptExecutionContext(context));
  }
  
  void InspectorInstrumentation::didAddEventListenerImpl(InstrumentingAgents&amp; instrumentingAgents, EventTarget&amp; target, const AtomString&amp; eventType, EventListener&amp; listener, bool capture)
  {
<span class="line-modified">!     if (PageDebuggerAgent* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
<span class="line-modified">!         pageDebuggerAgent-&gt;didAddEventListener(target, eventType, listener, capture);</span>
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;didAddEventListener(target);
  }
  
  void InspectorInstrumentation::willRemoveEventListenerImpl(InstrumentingAgents&amp; instrumentingAgents, EventTarget&amp; target, const AtomString&amp; eventType, EventListener&amp; listener, bool capture)
  {
<span class="line-modified">!     if (PageDebuggerAgent* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
<span class="line-modified">!         pageDebuggerAgent-&gt;willRemoveEventListener(target, eventType, listener, capture);</span>
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;willRemoveEventListener(target, eventType, listener, capture);
  }
  
  bool InspectorInstrumentation::isEventListenerDisabledImpl(InstrumentingAgents&amp; instrumentingAgents, EventTarget&amp; target, const AtomString&amp; eventType, EventListener&amp; listener, bool capture)
<span class="line-new-header">--- 321,37 ---</span>
          domDebuggerAgent-&gt;willFetch(url);
  }
  
  void InspectorInstrumentation::didInstallTimerImpl(InstrumentingAgents&amp; instrumentingAgents, int timerId, Seconds timeout, bool singleShot, ScriptExecutionContext&amp; context)
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         webDebuggerAgent-&gt;didScheduleAsyncCall(context.execState(), InspectorDebuggerAgent::AsyncCallType::DOMTimer, timerId, singleShot);</span>
  
      if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())
          timelineAgent-&gt;didInstallTimer(timerId, timeout, singleShot, frameForScriptExecutionContext(context));
  }
  
  void InspectorInstrumentation::didRemoveTimerImpl(InstrumentingAgents&amp; instrumentingAgents, int timerId, ScriptExecutionContext&amp; context)
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         webDebuggerAgent-&gt;didCancelAsyncCall(InspectorDebuggerAgent::AsyncCallType::DOMTimer, timerId);</span>
      if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())
          timelineAgent-&gt;didRemoveTimer(timerId, frameForScriptExecutionContext(context));
  }
  
  void InspectorInstrumentation::didAddEventListenerImpl(InstrumentingAgents&amp; instrumentingAgents, EventTarget&amp; target, const AtomString&amp; eventType, EventListener&amp; listener, bool capture)
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         webDebuggerAgent-&gt;didAddEventListener(target, eventType, listener, capture);</span>
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;didAddEventListener(target);
  }
  
  void InspectorInstrumentation::willRemoveEventListenerImpl(InstrumentingAgents&amp; instrumentingAgents, EventTarget&amp; target, const AtomString&amp; eventType, EventListener&amp; listener, bool capture)
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         webDebuggerAgent-&gt;willRemoveEventListener(target, eventType, listener, capture);</span>
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;willRemoveEventListener(target, eventType, listener, capture);
  }
  
  bool InspectorInstrumentation::isEventListenerDisabledImpl(InstrumentingAgents&amp; instrumentingAgents, EventTarget&amp; target, const AtomString&amp; eventType, EventListener&amp; listener, bool capture)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 349,172 ***</span>
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          return domAgent-&gt;isEventListenerDisabled(target, eventType, listener, capture);
      return false;
  }
  
<span class="line-modified">! void InspectorInstrumentation::didPostMessageImpl(InstrumentingAgents&amp; instrumentingAgents, const TimerBase&amp; timer, JSC::ExecState&amp; state)</span>
  {
<span class="line-modified">!     if (PageDebuggerAgent* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
<span class="line-modified">!         pageDebuggerAgent-&gt;didPostMessage(timer, state);</span>
  }
  
  void InspectorInstrumentation::didFailPostMessageImpl(InstrumentingAgents&amp; instrumentingAgents, const TimerBase&amp; timer)
  {
<span class="line-modified">!     if (PageDebuggerAgent* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
<span class="line-modified">!         pageDebuggerAgent-&gt;didFailPostMessage(timer);</span>
  }
  
  void InspectorInstrumentation::willDispatchPostMessageImpl(InstrumentingAgents&amp; instrumentingAgents, const TimerBase&amp; timer)
  {
<span class="line-modified">!     if (PageDebuggerAgent* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
<span class="line-modified">!         pageDebuggerAgent-&gt;willDispatchPostMessage(timer);</span>
  }
  
  void InspectorInstrumentation::didDispatchPostMessageImpl(InstrumentingAgents&amp; instrumentingAgents, const TimerBase&amp; timer)
  {
<span class="line-modified">!     if (PageDebuggerAgent* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
<span class="line-modified">!         pageDebuggerAgent-&gt;didDispatchPostMessage(timer);</span>
  }
  
<span class="line-modified">! InspectorInstrumentationCookie InspectorInstrumentation::willCallFunctionImpl(InstrumentingAgents&amp; instrumentingAgents, const String&amp; scriptName, int scriptLine, int scriptColumn, ScriptExecutionContext* context)</span>
  {
<span class="line-modified">!     int timelineAgentId = 0;</span>
<span class="line-removed">-     if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent()) {</span>
          timelineAgent-&gt;willCallFunction(scriptName, scriptLine, scriptColumn, frameForScriptExecutionContext(context));
<span class="line-removed">-         timelineAgentId = timelineAgent-&gt;id();</span>
<span class="line-removed">-     }</span>
<span class="line-removed">-     return InspectorInstrumentationCookie(instrumentingAgents, timelineAgentId);</span>
  }
  
<span class="line-modified">! void InspectorInstrumentation::didCallFunctionImpl(const InspectorInstrumentationCookie&amp; cookie, ScriptExecutionContext* context)</span>
  {
<span class="line-modified">!     if (InspectorTimelineAgent* timelineAgent = retrieveTimelineAgent(cookie))</span>
          timelineAgent-&gt;didCallFunction(frameForScriptExecutionContext(context));
  }
  
<span class="line-modified">! InspectorInstrumentationCookie InspectorInstrumentation::willDispatchEventImpl(InstrumentingAgents&amp; instrumentingAgents, Document&amp; document, const Event&amp; event, bool hasEventListeners)</span>
  {
<span class="line-modified">!     int timelineAgentId = 0;</span>
<span class="line-removed">-     InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent();</span>
<span class="line-removed">-     if (timelineAgent &amp;&amp; hasEventListeners) {</span>
          timelineAgent-&gt;willDispatchEvent(event, document.frame());
<span class="line-removed">-         timelineAgentId = timelineAgent-&gt;id();</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     return InspectorInstrumentationCookie(instrumentingAgents, timelineAgentId);</span>
  }
  
  void InspectorInstrumentation::willHandleEventImpl(InstrumentingAgents&amp; instrumentingAgents, Event&amp; event, const RegisteredEventListener&amp; listener)
  {
<span class="line-modified">!     if (PageDebuggerAgent* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
<span class="line-modified">!         pageDebuggerAgent-&gt;willHandleEvent(listener);</span>
  
      if (InspectorDOMDebuggerAgent* domDebuggerAgent = instrumentingAgents.inspectorDOMDebuggerAgent())
          domDebuggerAgent-&gt;willHandleEvent(event, listener);
  }
  
  void InspectorInstrumentation::didHandleEventImpl(InstrumentingAgents&amp; instrumentingAgents)
  {
<span class="line-modified">!     if (InspectorDebuggerAgent* debuggerAgent = instrumentingAgents.inspectorDebuggerAgent())</span>
<span class="line-modified">!         debuggerAgent-&gt;didDispatchAsyncCall();</span>
  
      if (InspectorDOMDebuggerAgent* domDebuggerAgent = instrumentingAgents.inspectorDOMDebuggerAgent())
          domDebuggerAgent-&gt;didHandleEvent();
  }
  
<span class="line-modified">! void InspectorInstrumentation::didDispatchEventImpl(const InspectorInstrumentationCookie&amp; cookie, bool defaultPrevented)</span>
  {
<span class="line-modified">!     if (InspectorTimelineAgent* timelineAgent = retrieveTimelineAgent(cookie))</span>
<span class="line-modified">!         timelineAgent-&gt;didDispatchEvent(defaultPrevented);</span>
  }
  
<span class="line-modified">! InspectorInstrumentationCookie InspectorInstrumentation::willDispatchEventOnWindowImpl(InstrumentingAgents&amp; instrumentingAgents, const Event&amp; event, DOMWindow&amp; window)</span>
  {
<span class="line-modified">!     int timelineAgentId = 0;</span>
<span class="line-removed">-     InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent();</span>
<span class="line-removed">-     if (timelineAgent &amp;&amp; window.hasEventListeners(event.type())) {</span>
          timelineAgent-&gt;willDispatchEvent(event, window.frame());
<span class="line-removed">-         timelineAgentId = timelineAgent-&gt;id();</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     return InspectorInstrumentationCookie(instrumentingAgents, timelineAgentId);</span>
  }
  
<span class="line-modified">! void InspectorInstrumentation::didDispatchEventOnWindowImpl(const InspectorInstrumentationCookie&amp; cookie, bool defaultPrevented)</span>
  {
<span class="line-modified">!     if (InspectorTimelineAgent* timelineAgent = retrieveTimelineAgent(cookie))</span>
<span class="line-modified">!         timelineAgent-&gt;didDispatchEvent(defaultPrevented);</span>
  }
  
  void InspectorInstrumentation::eventDidResetAfterDispatchImpl(InstrumentingAgents&amp; instrumentingAgents, const Event&amp; event)
  {
      if (auto* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;eventDidResetAfterDispatch(event);
  }
  
<span class="line-modified">! InspectorInstrumentationCookie InspectorInstrumentation::willEvaluateScriptImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame, const String&amp; url, int lineNumber, int columnNumber)</span>
  {
<span class="line-modified">!     int timelineAgentId = 0;</span>
<span class="line-removed">-     if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent()) {</span>
          timelineAgent-&gt;willEvaluateScript(url, lineNumber, columnNumber, frame);
<span class="line-removed">-         timelineAgentId = timelineAgent-&gt;id();</span>
<span class="line-removed">-     }</span>
<span class="line-removed">-     return InspectorInstrumentationCookie(instrumentingAgents, timelineAgentId);</span>
  }
  
<span class="line-modified">! void InspectorInstrumentation::didEvaluateScriptImpl(const InspectorInstrumentationCookie&amp; cookie, Frame&amp; frame)</span>
  {
<span class="line-modified">!     if (InspectorTimelineAgent* timelineAgent = retrieveTimelineAgent(cookie))</span>
          timelineAgent-&gt;didEvaluateScript(frame);
  }
  
<span class="line-modified">! InspectorInstrumentationCookie InspectorInstrumentation::willFireTimerImpl(InstrumentingAgents&amp; instrumentingAgents, int timerId, bool oneShot, ScriptExecutionContext&amp; context)</span>
  {
<span class="line-modified">!     if (InspectorDebuggerAgent* debuggerAgent = instrumentingAgents.inspectorDebuggerAgent())</span>
<span class="line-modified">!         debuggerAgent-&gt;willDispatchAsyncCall(InspectorDebuggerAgent::AsyncCallType::DOMTimer, timerId);</span>
<span class="line-modified">! </span>
<span class="line-removed">-     if (InspectorDOMDebuggerAgent* domDebuggerAgent = instrumentingAgents.inspectorDOMDebuggerAgent())</span>
          domDebuggerAgent-&gt;willFireTimer(oneShot);
<span class="line-modified">! </span>
<span class="line-removed">-     int timelineAgentId = 0;</span>
<span class="line-removed">-     if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent()) {</span>
          timelineAgent-&gt;willFireTimer(timerId, frameForScriptExecutionContext(context));
<span class="line-removed">-         timelineAgentId = timelineAgent-&gt;id();</span>
<span class="line-removed">-     }</span>
<span class="line-removed">-     return InspectorInstrumentationCookie(instrumentingAgents, timelineAgentId);</span>
  }
  
<span class="line-modified">! void InspectorInstrumentation::didFireTimerImpl(const InspectorInstrumentationCookie&amp; cookie)</span>
  {
<span class="line-modified">!     if (InspectorDebuggerAgent* debuggerAgent = cookie.instrumentingAgents()-&gt;inspectorDebuggerAgent())</span>
<span class="line-modified">!         debuggerAgent-&gt;didDispatchAsyncCall();</span>
<span class="line-modified">!     if (InspectorTimelineAgent* timelineAgent = retrieveTimelineAgent(cookie))</span>
          timelineAgent-&gt;didFireTimer();
  }
  
  void InspectorInstrumentation::didInvalidateLayoutImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame)
  {
      if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())
          timelineAgent-&gt;didInvalidateLayout(frame);
  }
  
<span class="line-modified">! InspectorInstrumentationCookie InspectorInstrumentation::willLayoutImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame)</span>
  {
<span class="line-modified">!     int timelineAgentId = 0;</span>
<span class="line-removed">-     if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent()) {</span>
          timelineAgent-&gt;willLayout(frame);
<span class="line-removed">-         timelineAgentId = timelineAgent-&gt;id();</span>
<span class="line-removed">-     }</span>
<span class="line-removed">-     return InspectorInstrumentationCookie(instrumentingAgents, timelineAgentId);</span>
  }
  
<span class="line-modified">! void InspectorInstrumentation::didLayoutImpl(const InspectorInstrumentationCookie&amp; cookie, RenderObject&amp; root)</span>
  {
<span class="line-modified">!     if (InspectorTimelineAgent* timelineAgent = retrieveTimelineAgent(cookie))</span>
          timelineAgent-&gt;didLayout(root);
<span class="line-modified">! </span>
<span class="line-removed">-     if (InspectorPageAgent* pageAgent = cookie.instrumentingAgents()-&gt;inspectorPageAgent())</span>
          pageAgent-&gt;didLayout();
  }
  
  void InspectorInstrumentation::willCompositeImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame)
  {
<span class="line-new-header">--- 359,141 ---</span>
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          return domAgent-&gt;isEventListenerDisabled(target, eventType, listener, capture);
      return false;
  }
  
<span class="line-modified">! void InspectorInstrumentation::didPostMessageImpl(InstrumentingAgents&amp; instrumentingAgents, const TimerBase&amp; timer, JSC::JSGlobalObject&amp; state)</span>
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         webDebuggerAgent-&gt;didPostMessage(timer, state);</span>
  }
  
  void InspectorInstrumentation::didFailPostMessageImpl(InstrumentingAgents&amp; instrumentingAgents, const TimerBase&amp; timer)
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         webDebuggerAgent-&gt;didFailPostMessage(timer);</span>
  }
  
  void InspectorInstrumentation::willDispatchPostMessageImpl(InstrumentingAgents&amp; instrumentingAgents, const TimerBase&amp; timer)
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         webDebuggerAgent-&gt;willDispatchPostMessage(timer);</span>
  }
  
  void InspectorInstrumentation::didDispatchPostMessageImpl(InstrumentingAgents&amp; instrumentingAgents, const TimerBase&amp; timer)
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         webDebuggerAgent-&gt;didDispatchPostMessage(timer);</span>
  }
  
<span class="line-modified">! void InspectorInstrumentation::willCallFunctionImpl(InstrumentingAgents&amp; instrumentingAgents, const String&amp; scriptName, int scriptLine, int scriptColumn, ScriptExecutionContext* context)</span>
  {
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;willCallFunction(scriptName, scriptLine, scriptColumn, frameForScriptExecutionContext(context));
  }
  
<span class="line-modified">! void InspectorInstrumentation::didCallFunctionImpl(InstrumentingAgents&amp; instrumentingAgents, ScriptExecutionContext* context)</span>
  {
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;didCallFunction(frameForScriptExecutionContext(context));
  }
  
<span class="line-modified">! void InspectorInstrumentation::willDispatchEventImpl(InstrumentingAgents&amp; instrumentingAgents, Document&amp; document, const Event&amp; event)</span>
  {
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;willDispatchEvent(event, document.frame());
  }
  
  void InspectorInstrumentation::willHandleEventImpl(InstrumentingAgents&amp; instrumentingAgents, Event&amp; event, const RegisteredEventListener&amp; listener)
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         webDebuggerAgent-&gt;willHandleEvent(listener);</span>
  
      if (InspectorDOMDebuggerAgent* domDebuggerAgent = instrumentingAgents.inspectorDOMDebuggerAgent())
          domDebuggerAgent-&gt;willHandleEvent(event, listener);
  }
  
  void InspectorInstrumentation::didHandleEventImpl(InstrumentingAgents&amp; instrumentingAgents)
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         webDebuggerAgent-&gt;didDispatchAsyncCall();</span>
  
      if (InspectorDOMDebuggerAgent* domDebuggerAgent = instrumentingAgents.inspectorDOMDebuggerAgent())
          domDebuggerAgent-&gt;didHandleEvent();
  }
  
<span class="line-modified">! void InspectorInstrumentation::didDispatchEventImpl(InstrumentingAgents&amp; instrumentingAgents, const Event&amp; event)</span>
  {
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
<span class="line-modified">!         timelineAgent-&gt;didDispatchEvent(event.defaultPrevented());</span>
  }
  
<span class="line-modified">! void InspectorInstrumentation::willDispatchEventOnWindowImpl(InstrumentingAgents&amp; instrumentingAgents, const Event&amp; event, DOMWindow&amp; window)</span>
  {
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;willDispatchEvent(event, window.frame());
  }
  
<span class="line-modified">! void InspectorInstrumentation::didDispatchEventOnWindowImpl(InstrumentingAgents&amp; instrumentingAgents, const Event&amp; event)</span>
  {
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
<span class="line-modified">!         timelineAgent-&gt;didDispatchEvent(event.defaultPrevented());</span>
  }
  
  void InspectorInstrumentation::eventDidResetAfterDispatchImpl(InstrumentingAgents&amp; instrumentingAgents, const Event&amp; event)
  {
      if (auto* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;eventDidResetAfterDispatch(event);
  }
  
<span class="line-modified">! void InspectorInstrumentation::willEvaluateScriptImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame, const String&amp; url, int lineNumber, int columnNumber)</span>
  {
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;willEvaluateScript(url, lineNumber, columnNumber, frame);
  }
  
<span class="line-modified">! void InspectorInstrumentation::didEvaluateScriptImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame)</span>
  {
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;didEvaluateScript(frame);
  }
  
<span class="line-modified">! void InspectorInstrumentation::willFireTimerImpl(InstrumentingAgents&amp; instrumentingAgents, int timerId, bool oneShot, ScriptExecutionContext&amp; context)</span>
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         webDebuggerAgent-&gt;willDispatchAsyncCall(InspectorDebuggerAgent::AsyncCallType::DOMTimer, timerId);</span>
<span class="line-modified">!     if (auto* domDebuggerAgent = instrumentingAgents.inspectorDOMDebuggerAgent())</span>
          domDebuggerAgent-&gt;willFireTimer(oneShot);
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;willFireTimer(timerId, frameForScriptExecutionContext(context));
  }
  
<span class="line-modified">! void InspectorInstrumentation::didFireTimerImpl(InstrumentingAgents&amp; instrumentingAgents)</span>
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         webDebuggerAgent-&gt;didDispatchAsyncCall();</span>
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;didFireTimer();
  }
  
  void InspectorInstrumentation::didInvalidateLayoutImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame)
  {
      if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())
          timelineAgent-&gt;didInvalidateLayout(frame);
  }
  
<span class="line-modified">! void InspectorInstrumentation::willLayoutImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame)</span>
  {
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;willLayout(frame);
  }
  
<span class="line-modified">! void InspectorInstrumentation::didLayoutImpl(InstrumentingAgents&amp; instrumentingAgents, RenderObject&amp; root)</span>
  {
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;didLayout(root);
<span class="line-modified">!     if (auto* pageAgent = instrumentingAgents.inspectorPageAgent())</span>
          pageAgent-&gt;didLayout();
  }
  
  void InspectorInstrumentation::willCompositeImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame)
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 541,30 ***</span>
  
      if (InspectorPageAgent* pageAgent = instrumentingAgents.inspectorPageAgent())
          pageAgent-&gt;didPaint(renderer, rect);
  }
  
<span class="line-modified">! InspectorInstrumentationCookie InspectorInstrumentation::willRecalculateStyleImpl(InstrumentingAgents&amp; instrumentingAgents, Document&amp; document)</span>
  {
<span class="line-modified">!     int timelineAgentId = 0;</span>
<span class="line-removed">-     if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent()) {</span>
          timelineAgent-&gt;willRecalculateStyle(document.frame());
<span class="line-removed">-         timelineAgentId = timelineAgent-&gt;id();</span>
<span class="line-removed">-     }</span>
      if (InspectorNetworkAgent* networkAgent = instrumentingAgents.inspectorNetworkAgent())
          networkAgent-&gt;willRecalculateStyle();
<span class="line-removed">-     return InspectorInstrumentationCookie(instrumentingAgents, timelineAgentId);</span>
  }
  
<span class="line-modified">! void InspectorInstrumentation::didRecalculateStyleImpl(const InspectorInstrumentationCookie&amp; cookie)</span>
  {
<span class="line-modified">!     if (!cookie.isValid())</span>
<span class="line-removed">-         return;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     InstrumentingAgents&amp; instrumentingAgents = *cookie.instrumentingAgents();</span>
<span class="line-removed">- </span>
<span class="line-removed">-     if (InspectorTimelineAgent* timelineAgent = retrieveTimelineAgent(cookie))</span>
          timelineAgent-&gt;didRecalculateStyle();
      if (InspectorNetworkAgent* networkAgent = instrumentingAgents.inspectorNetworkAgent())
          networkAgent-&gt;didRecalculateStyle();
      if (InspectorPageAgent* pageAgent = instrumentingAgents.inspectorPageAgent())
          pageAgent-&gt;didRecalculateStyle();
<span class="line-new-header">--- 520,21 ---</span>
  
      if (InspectorPageAgent* pageAgent = instrumentingAgents.inspectorPageAgent())
          pageAgent-&gt;didPaint(renderer, rect);
  }
  
<span class="line-modified">! void InspectorInstrumentation::willRecalculateStyleImpl(InstrumentingAgents&amp; instrumentingAgents, Document&amp; document)</span>
  {
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;willRecalculateStyle(document.frame());
      if (InspectorNetworkAgent* networkAgent = instrumentingAgents.inspectorNetworkAgent())
          networkAgent-&gt;willRecalculateStyle();
  }
  
<span class="line-modified">! void InspectorInstrumentation::didRecalculateStyleImpl(InstrumentingAgents&amp; instrumentingAgents)</span>
  {
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;didRecalculateStyle();
      if (InspectorNetworkAgent* networkAgent = instrumentingAgents.inspectorNetworkAgent())
          networkAgent-&gt;didRecalculateStyle();
      if (InspectorPageAgent* pageAgent = instrumentingAgents.inspectorPageAgent())
          pageAgent-&gt;didRecalculateStyle();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 611,11 ***</span>
          networkAgent-&gt;didLoadResourceFromMemoryCache(loader, *cachedResource);
  }
  
  void InspectorInstrumentation::didReceiveResourceResponseImpl(InstrumentingAgents&amp; instrumentingAgents, unsigned long identifier, DocumentLoader* loader, const ResourceResponse&amp; response, ResourceLoader* resourceLoader)
  {
<span class="line-modified">!     if (!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled())</span>
          return;
  
      if (InspectorNetworkAgent* networkAgent = instrumentingAgents.inspectorNetworkAgent())
          networkAgent-&gt;didReceiveResponse(identifier, loader, response, resourceLoader);
      if (WebConsoleAgent* consoleAgent = instrumentingAgents.webConsoleAgent())
<span class="line-new-header">--- 581,11 ---</span>
          networkAgent-&gt;didLoadResourceFromMemoryCache(loader, *cachedResource);
  }
  
  void InspectorInstrumentation::didReceiveResourceResponseImpl(InstrumentingAgents&amp; instrumentingAgents, unsigned long identifier, DocumentLoader* loader, const ResourceResponse&amp; response, ResourceLoader* resourceLoader)
  {
<span class="line-modified">!     if (LIKELY(!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled()))</span>
          return;
  
      if (InspectorNetworkAgent* networkAgent = instrumentingAgents.inspectorNetworkAgent())
          networkAgent-&gt;didReceiveResponse(identifier, loader, response, resourceLoader);
      if (WebConsoleAgent* consoleAgent = instrumentingAgents.webConsoleAgent())
</pre>
<hr />
<pre>
<span class="line-old-header">*** 640,11 ***</span>
          networkAgent-&gt;didFinishLoading(identifier, loader, networkLoadMetrics, resourceLoader);
  }
  
  void InspectorInstrumentation::didFailLoadingImpl(InstrumentingAgents&amp; instrumentingAgents, unsigned long identifier, DocumentLoader* loader, const ResourceError&amp; error)
  {
<span class="line-modified">!     if (!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled())</span>
          return;
  
      if (InspectorNetworkAgent* networkAgent = instrumentingAgents.inspectorNetworkAgent())
          networkAgent-&gt;didFailLoading(identifier, loader, error);
      if (WebConsoleAgent* consoleAgent = instrumentingAgents.webConsoleAgent())
<span class="line-new-header">--- 610,11 ---</span>
          networkAgent-&gt;didFinishLoading(identifier, loader, networkLoadMetrics, resourceLoader);
  }
  
  void InspectorInstrumentation::didFailLoadingImpl(InstrumentingAgents&amp; instrumentingAgents, unsigned long identifier, DocumentLoader* loader, const ResourceError&amp; error)
  {
<span class="line-modified">!     if (LIKELY(!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled()))</span>
          return;
  
      if (InspectorNetworkAgent* networkAgent = instrumentingAgents.inspectorNetworkAgent())
          networkAgent-&gt;didFailLoading(identifier, loader, error);
      if (WebConsoleAgent* consoleAgent = instrumentingAgents.webConsoleAgent())
</pre>
<hr />
<pre>
<span class="line-old-header">*** 669,12 ***</span>
          networkAgent-&gt;setInitialScriptContent(identifier, sourceString);
  }
  
  void InspectorInstrumentation::scriptExecutionBlockedByCSPImpl(InstrumentingAgents&amp; instrumentingAgents, const String&amp; directiveText)
  {
<span class="line-modified">!     if (InspectorDebuggerAgent* debuggerAgent = instrumentingAgents.inspectorDebuggerAgent())</span>
<span class="line-modified">!         debuggerAgent-&gt;scriptExecutionBlockedByCSP(directiveText);</span>
  }
  
  void InspectorInstrumentation::didReceiveScriptResponseImpl(InstrumentingAgents&amp; instrumentingAgents, unsigned long identifier)
  {
      if (InspectorNetworkAgent* networkAgent = instrumentingAgents.inspectorNetworkAgent())
<span class="line-new-header">--- 639,12 ---</span>
          networkAgent-&gt;setInitialScriptContent(identifier, sourceString);
  }
  
  void InspectorInstrumentation::scriptExecutionBlockedByCSPImpl(InstrumentingAgents&amp; instrumentingAgents, const String&amp; directiveText)
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         webDebuggerAgent-&gt;scriptExecutionBlockedByCSP(directiveText);</span>
  }
  
  void InspectorInstrumentation::didReceiveScriptResponseImpl(InstrumentingAgents&amp; instrumentingAgents, unsigned long identifier)
  {
      if (InspectorNetworkAgent* networkAgent = instrumentingAgents.inspectorNetworkAgent())
</pre>
<hr />
<pre>
<span class="line-old-header">*** 705,11 ***</span>
          pageAgent-&gt;frameDetached(frame);
  }
  
  void InspectorInstrumentation::didCommitLoadImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame, DocumentLoader* loader)
  {
<span class="line-modified">!     if (!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled())</span>
          return;
  
      if (!frame.page())
          return;
  
<span class="line-new-header">--- 675,11 ---</span>
          pageAgent-&gt;frameDetached(frame);
  }
  
  void InspectorInstrumentation::didCommitLoadImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame, DocumentLoader* loader)
  {
<span class="line-modified">!     if (LIKELY(!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled()))</span>
          return;
  
      if (!frame.page())
          return;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 735,20 ***</span>
              domAgent-&gt;setDocument(frame.document());
  
          if (InspectorLayerTreeAgent* layerTreeAgent = instrumentingAgents.inspectorLayerTreeAgent())
              layerTreeAgent-&gt;reset();
  
<span class="line-modified">!         if (PageDebuggerAgent* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
              pageDebuggerAgent-&gt;mainFrameNavigated();
  
          if (PageHeapAgent* pageHeapAgent = instrumentingAgents.pageHeapAgent())
              pageHeapAgent-&gt;mainFrameNavigated();
      }
  
      if (InspectorCanvasAgent* canvasAgent = instrumentingAgents.inspectorCanvasAgent())
          canvasAgent-&gt;frameNavigated(frame);
  
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;didCommitLoad(frame.document());
  
      if (InspectorPageAgent* pageAgent = instrumentingAgents.inspectorPageAgent())
          pageAgent-&gt;frameNavigated(frame);
<span class="line-new-header">--- 705,26 ---</span>
              domAgent-&gt;setDocument(frame.document());
  
          if (InspectorLayerTreeAgent* layerTreeAgent = instrumentingAgents.inspectorLayerTreeAgent())
              layerTreeAgent-&gt;reset();
  
<span class="line-modified">!         if (auto* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
              pageDebuggerAgent-&gt;mainFrameNavigated();
  
          if (PageHeapAgent* pageHeapAgent = instrumentingAgents.pageHeapAgent())
              pageHeapAgent-&gt;mainFrameNavigated();
      }
  
<span class="line-added">+     if (auto* pageRuntimeAgent = instrumentingAgents.pageRuntimeAgent())</span>
<span class="line-added">+         pageRuntimeAgent-&gt;frameNavigated(frame);</span>
<span class="line-added">+ </span>
      if (InspectorCanvasAgent* canvasAgent = instrumentingAgents.inspectorCanvasAgent())
          canvasAgent-&gt;frameNavigated(frame);
  
<span class="line-added">+     if (auto* animationAgent = instrumentingAgents.enabledInspectorAnimationAgent())</span>
<span class="line-added">+         animationAgent-&gt;frameNavigated(frame);</span>
<span class="line-added">+ </span>
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;didCommitLoad(frame.document());
  
      if (InspectorPageAgent* pageAgent = instrumentingAgents.inspectorPageAgent())
          pageAgent-&gt;frameNavigated(frame);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 762,12 ***</span>
  void InspectorInstrumentation::frameDocumentUpdatedImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame)
  {
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;frameDocumentUpdated(frame);
  
<span class="line-modified">!     if (InspectorDOMDebuggerAgent* domDebuggerAgent = instrumentingAgents.inspectorDOMDebuggerAgent())</span>
<span class="line-modified">!         domDebuggerAgent-&gt;frameDocumentUpdated(frame);</span>
  }
  
  void InspectorInstrumentation::loaderDetachedFromFrameImpl(InstrumentingAgents&amp; instrumentingAgents, DocumentLoader&amp; loader)
  {
      if (InspectorPageAgent* inspectorPageAgent = instrumentingAgents.inspectorPageAgent())
<span class="line-new-header">--- 738,12 ---</span>
  void InspectorInstrumentation::frameDocumentUpdatedImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame)
  {
      if (InspectorDOMAgent* domAgent = instrumentingAgents.inspectorDOMAgent())
          domAgent-&gt;frameDocumentUpdated(frame);
  
<span class="line-modified">!     if (auto* pageDOMDebuggerAgent = instrumentingAgents.pageDOMDebuggerAgent())</span>
<span class="line-modified">!         pageDOMDebuggerAgent-&gt;frameDocumentUpdated(frame);</span>
  }
  
  void InspectorInstrumentation::loaderDetachedFromFrameImpl(InstrumentingAgents&amp; instrumentingAgents, DocumentLoader&amp; loader)
  {
      if (InspectorPageAgent* inspectorPageAgent = instrumentingAgents.inspectorPageAgent())
</pre>
<hr />
<pre>
<span class="line-old-header">*** 775,11 ***</span>
  }
  
  void InspectorInstrumentation::frameStartedLoadingImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame)
  {
      if (frame.isMainFrame()) {
<span class="line-modified">!         if (PageDebuggerAgent* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
              pageDebuggerAgent-&gt;mainFrameStartedLoading();
          if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.inspectorTimelineAgent())
              timelineAgent-&gt;mainFrameStartedLoading();
      }
  
<span class="line-new-header">--- 751,11 ---</span>
  }
  
  void InspectorInstrumentation::frameStartedLoadingImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame)
  {
      if (frame.isMainFrame()) {
<span class="line-modified">!         if (auto* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
              pageDebuggerAgent-&gt;mainFrameStartedLoading();
          if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.inspectorTimelineAgent())
              timelineAgent-&gt;mainFrameStartedLoading();
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 788,11 ***</span>
  }
  
  void InspectorInstrumentation::frameStoppedLoadingImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame)
  {
      if (frame.isMainFrame()) {
<span class="line-modified">!         if (PageDebuggerAgent* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
              pageDebuggerAgent-&gt;mainFrameStoppedLoading();
      }
  
      if (InspectorPageAgent* inspectorPageAgent = instrumentingAgents.inspectorPageAgent())
          inspectorPageAgent-&gt;frameStoppedLoading(frame);
<span class="line-new-header">--- 764,11 ---</span>
  }
  
  void InspectorInstrumentation::frameStoppedLoadingImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame)
  {
      if (frame.isMainFrame()) {
<span class="line-modified">!         if (auto* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
              pageDebuggerAgent-&gt;mainFrameStoppedLoading();
      }
  
      if (InspectorPageAgent* inspectorPageAgent = instrumentingAgents.inspectorPageAgent())
          inspectorPageAgent-&gt;frameStoppedLoading(frame);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 825,95 ***</span>
          if (InspectorNetworkAgent* inspectorNetworkAgent = instrumentingAgent-&gt;inspectorNetworkAgent())
              inspectorNetworkAgent-&gt;willDestroyCachedResource(cachedResource);
      }
  }
  
  // JavaScriptCore InspectorDebuggerAgent should know Console MessageTypes.
  static bool isConsoleAssertMessage(MessageSource source, MessageType type)
  {
      return source == MessageSource::ConsoleAPI &amp;&amp; type == MessageType::Assert;
  }
  
  void InspectorInstrumentation::addMessageToConsoleImpl(InstrumentingAgents&amp; instrumentingAgents, std::unique_ptr&lt;ConsoleMessage&gt; message)
  {
<span class="line-modified">!     if (!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled())</span>
          return;
  
      MessageSource source = message-&gt;source();
      MessageType type = message-&gt;type();
      String messageText = message-&gt;message();
  
      if (WebConsoleAgent* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;addMessageToConsole(WTFMove(message));
      // FIXME: This should just pass the message on to the debugger agent. JavaScriptCore InspectorDebuggerAgent should know Console MessageTypes.
<span class="line-modified">!     if (InspectorDebuggerAgent* debuggerAgent = instrumentingAgents.inspectorDebuggerAgent()) {</span>
          if (isConsoleAssertMessage(source, type))
<span class="line-modified">!             debuggerAgent-&gt;handleConsoleAssert(messageText);</span>
      }
  }
  
<span class="line-modified">! void InspectorInstrumentation::consoleCountImpl(InstrumentingAgents&amp; instrumentingAgents, JSC::ExecState* state, const String&amp; label)</span>
  {
      if (auto* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;count(state, label);
  }
  
<span class="line-modified">! void InspectorInstrumentation::consoleCountResetImpl(InstrumentingAgents&amp; instrumentingAgents, JSC::ExecState* state, const String&amp; label)</span>
  {
      if (auto* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;countReset(state, label);
  }
  
  void InspectorInstrumentation::takeHeapSnapshotImpl(InstrumentingAgents&amp; instrumentingAgents, const String&amp; title)
  {
      if (WebConsoleAgent* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;takeHeapSnapshot(title);
  }
  
<span class="line-modified">! void InspectorInstrumentation::startConsoleTimingImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame, JSC::ExecState* exec, const String&amp; label)</span>
  {
<span class="line-modified">!     if (!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled())</span>
          return;
  
      if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())
          timelineAgent-&gt;time(frame, label);
      if (auto* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;startTiming(exec, label);
  }
  
<span class="line-modified">! void InspectorInstrumentation::startConsoleTimingImpl(InstrumentingAgents&amp; instrumentingAgents, JSC::ExecState* exec, const String&amp; label)</span>
  {
<span class="line-modified">!     if (!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled())</span>
          return;
  
      if (auto* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;startTiming(exec, label);
  }
  
<span class="line-modified">! void InspectorInstrumentation::logConsoleTimingImpl(InstrumentingAgents&amp; instrumentingAgents, JSC::ExecState* exec, const String&amp; label, Ref&lt;Inspector::ScriptArguments&gt;&amp;&amp; arguments)</span>
  {
<span class="line-modified">!     if (!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled())</span>
          return;
  
      if (auto* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;logTiming(exec, label, WTFMove(arguments));
  }
  
<span class="line-modified">! void InspectorInstrumentation::stopConsoleTimingImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame, JSC::ExecState* exec, const String&amp; label)</span>
  {
<span class="line-modified">!     if (!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled())</span>
          return;
  
      if (auto* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;stopTiming(exec, label);
      if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())
          timelineAgent-&gt;timeEnd(frame, label);
  }
  
<span class="line-modified">! void InspectorInstrumentation::stopConsoleTimingImpl(InstrumentingAgents&amp; instrumentingAgents, JSC::ExecState* exec, const String&amp; label)</span>
  {
<span class="line-modified">!     if (!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled())</span>
          return;
  
      if (auto* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;stopTiming(exec, label);
  }
<span class="line-new-header">--- 801,121 ---</span>
          if (InspectorNetworkAgent* inspectorNetworkAgent = instrumentingAgent-&gt;inspectorNetworkAgent())
              inspectorNetworkAgent-&gt;willDestroyCachedResource(cachedResource);
      }
  }
  
<span class="line-added">+ bool InspectorInstrumentation::willInterceptRequestImpl(InstrumentingAgents&amp; instrumentingAgents, const ResourceRequest&amp; request)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* networkAgent = instrumentingAgents.inspectorNetworkAgent())</span>
<span class="line-added">+         return networkAgent-&gt;willInterceptRequest(request);</span>
<span class="line-added">+     return false;</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ bool InspectorInstrumentation::shouldInterceptResponseImpl(InstrumentingAgents&amp; instrumentingAgents, const ResourceResponse&amp; response)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* networkAgent = instrumentingAgents.inspectorNetworkAgent())</span>
<span class="line-added">+         return networkAgent-&gt;shouldInterceptResponse(response);</span>
<span class="line-added">+     return false;</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ void InspectorInstrumentation::interceptResponseImpl(InstrumentingAgents&amp; instrumentingAgents, const ResourceResponse&amp; response, unsigned long identifier, CompletionHandler&lt;void(const ResourceResponse&amp;, RefPtr&lt;SharedBuffer&gt;)&gt;&amp;&amp; handler)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* networkAgent = instrumentingAgents.inspectorNetworkAgent())</span>
<span class="line-added">+         networkAgent-&gt;interceptResponse(response, identifier, WTFMove(handler));</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  // JavaScriptCore InspectorDebuggerAgent should know Console MessageTypes.
  static bool isConsoleAssertMessage(MessageSource source, MessageType type)
  {
      return source == MessageSource::ConsoleAPI &amp;&amp; type == MessageType::Assert;
  }
  
  void InspectorInstrumentation::addMessageToConsoleImpl(InstrumentingAgents&amp; instrumentingAgents, std::unique_ptr&lt;ConsoleMessage&gt; message)
  {
<span class="line-modified">!     if (LIKELY(!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled()))</span>
          return;
  
      MessageSource source = message-&gt;source();
      MessageType type = message-&gt;type();
      String messageText = message-&gt;message();
  
      if (WebConsoleAgent* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;addMessageToConsole(WTFMove(message));
      // FIXME: This should just pass the message on to the debugger agent. JavaScriptCore InspectorDebuggerAgent should know Console MessageTypes.
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent()) {</span>
          if (isConsoleAssertMessage(source, type))
<span class="line-modified">!             webDebuggerAgent-&gt;handleConsoleAssert(messageText);</span>
      }
  }
  
<span class="line-modified">! void InspectorInstrumentation::consoleCountImpl(InstrumentingAgents&amp; instrumentingAgents, JSC::JSGlobalObject* state, const String&amp; label)</span>
  {
<span class="line-added">+     if (LIKELY(!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled()))</span>
<span class="line-added">+         return;</span>
<span class="line-added">+ </span>
      if (auto* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;count(state, label);
  }
  
<span class="line-modified">! void InspectorInstrumentation::consoleCountResetImpl(InstrumentingAgents&amp; instrumentingAgents, JSC::JSGlobalObject* state, const String&amp; label)</span>
  {
<span class="line-added">+     if (LIKELY(!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled()))</span>
<span class="line-added">+         return;</span>
<span class="line-added">+ </span>
      if (auto* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;countReset(state, label);
  }
  
  void InspectorInstrumentation::takeHeapSnapshotImpl(InstrumentingAgents&amp; instrumentingAgents, const String&amp; title)
  {
      if (WebConsoleAgent* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;takeHeapSnapshot(title);
  }
  
<span class="line-modified">! void InspectorInstrumentation::startConsoleTimingImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame, JSC::JSGlobalObject* exec, const String&amp; label)</span>
  {
<span class="line-modified">!     if (LIKELY(!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled()))</span>
          return;
  
      if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())
          timelineAgent-&gt;time(frame, label);
      if (auto* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;startTiming(exec, label);
  }
  
<span class="line-modified">! void InspectorInstrumentation::startConsoleTimingImpl(InstrumentingAgents&amp; instrumentingAgents, JSC::JSGlobalObject* exec, const String&amp; label)</span>
  {
<span class="line-modified">!     if (LIKELY(!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled()))</span>
          return;
  
      if (auto* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;startTiming(exec, label);
  }
  
<span class="line-modified">! void InspectorInstrumentation::logConsoleTimingImpl(InstrumentingAgents&amp; instrumentingAgents, JSC::JSGlobalObject* exec, const String&amp; label, Ref&lt;Inspector::ScriptArguments&gt;&amp;&amp; arguments)</span>
  {
<span class="line-modified">!     if (LIKELY(!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled()))</span>
          return;
  
      if (auto* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;logTiming(exec, label, WTFMove(arguments));
  }
  
<span class="line-modified">! void InspectorInstrumentation::stopConsoleTimingImpl(InstrumentingAgents&amp; instrumentingAgents, Frame&amp; frame, JSC::JSGlobalObject* exec, const String&amp; label)</span>
  {
<span class="line-modified">!     if (LIKELY(!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled()))</span>
          return;
  
      if (auto* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;stopTiming(exec, label);
      if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())
          timelineAgent-&gt;timeEnd(frame, label);
  }
  
<span class="line-modified">! void InspectorInstrumentation::stopConsoleTimingImpl(InstrumentingAgents&amp; instrumentingAgents, JSC::JSGlobalObject* exec, const String&amp; label)</span>
  {
<span class="line-modified">!     if (LIKELY(!instrumentingAgents.inspectorEnvironment().developerExtrasEnabled()))</span>
          return;
  
      if (auto* consoleAgent = instrumentingAgents.webConsoleAgent())
          consoleAgent-&gt;stopTiming(exec, label);
  }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 925,28 ***</span>
          arguments-&gt;getFirstArgumentAsString(message);
          timelineAgent-&gt;didTimeStamp(frame, message);
       }
  }
  
<span class="line-modified">! void InspectorInstrumentation::startProfilingImpl(InstrumentingAgents&amp; instrumentingAgents, JSC::ExecState* exec, const String&amp; title)</span>
  {
      if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.inspectorTimelineAgent())
          timelineAgent-&gt;startFromConsole(exec, title);
  }
  
<span class="line-modified">! void InspectorInstrumentation::stopProfilingImpl(InstrumentingAgents&amp; instrumentingAgents, JSC::ExecState* exec, const String&amp; title)</span>
  {
      if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.inspectorTimelineAgent())
          timelineAgent-&gt;stopFromConsole(exec, title);
  }
  
<span class="line-modified">! void InspectorInstrumentation::consoleStartRecordingCanvasImpl(InstrumentingAgents&amp; instrumentingAgents, CanvasRenderingContext&amp; context, JSC::ExecState&amp; exec, JSC::JSObject* options)</span>
  {
      if (InspectorCanvasAgent* canvasAgent = instrumentingAgents.inspectorCanvasAgent())
          canvasAgent-&gt;consoleStartRecordingCanvas(context, exec, options);
  }
  
  void InspectorInstrumentation::didOpenDatabaseImpl(InstrumentingAgents&amp; instrumentingAgents, Database&amp; database)
  {
      if (auto* databaseAgent = instrumentingAgents.inspectorDatabaseAgent())
          databaseAgent-&gt;didOpenDatabase(database);
  }
<span class="line-new-header">--- 927,34 ---</span>
          arguments-&gt;getFirstArgumentAsString(message);
          timelineAgent-&gt;didTimeStamp(frame, message);
       }
  }
  
<span class="line-modified">! void InspectorInstrumentation::startProfilingImpl(InstrumentingAgents&amp; instrumentingAgents, JSC::JSGlobalObject* exec, const String&amp; title)</span>
  {
      if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.inspectorTimelineAgent())
          timelineAgent-&gt;startFromConsole(exec, title);
  }
  
<span class="line-modified">! void InspectorInstrumentation::stopProfilingImpl(InstrumentingAgents&amp; instrumentingAgents, JSC::JSGlobalObject* exec, const String&amp; title)</span>
  {
      if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.inspectorTimelineAgent())
          timelineAgent-&gt;stopFromConsole(exec, title);
  }
  
<span class="line-modified">! void InspectorInstrumentation::consoleStartRecordingCanvasImpl(InstrumentingAgents&amp; instrumentingAgents, CanvasRenderingContext&amp; context, JSC::JSGlobalObject&amp; exec, JSC::JSObject* options)</span>
  {
      if (InspectorCanvasAgent* canvasAgent = instrumentingAgents.inspectorCanvasAgent())
          canvasAgent-&gt;consoleStartRecordingCanvas(context, exec, options);
  }
  
<span class="line-added">+ void InspectorInstrumentation::consoleStopRecordingCanvasImpl(InstrumentingAgents&amp; instrumentingAgents, CanvasRenderingContext&amp; context)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* canvasAgent = instrumentingAgents.inspectorCanvasAgent())</span>
<span class="line-added">+         canvasAgent-&gt;consoleStopRecordingCanvas(context);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  void InspectorInstrumentation::didOpenDatabaseImpl(InstrumentingAgents&amp; instrumentingAgents, Database&amp; database)
  {
      if (auto* databaseAgent = instrumentingAgents.inspectorDatabaseAgent())
          databaseAgent-&gt;didOpenDatabase(database);
  }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1053,37 ***</span>
  {
      if (InspectorCanvasAgent* canvasAgent = instrumentingAgents.inspectorCanvasAgent())
          canvasAgent-&gt;didEnableExtension(contextWebGLBase, extension);
  }
  
<span class="line-modified">! void InspectorInstrumentation::didCreateProgramImpl(InstrumentingAgents&amp; instrumentingAgents, WebGLRenderingContextBase&amp; contextWebGLBase, WebGLProgram&amp; program)</span>
  {
      if (InspectorCanvasAgent* canvasAgent = instrumentingAgents.inspectorCanvasAgent())
<span class="line-modified">!         canvasAgent-&gt;didCreateProgram(contextWebGLBase, program);</span>
  }
  
<span class="line-modified">! void InspectorInstrumentation::willDeleteProgramImpl(InstrumentingAgents&amp; instrumentingAgents, WebGLProgram&amp; program)</span>
  {
      if (InspectorCanvasAgent* canvasAgent = instrumentingAgents.inspectorCanvasAgent())
<span class="line-modified">!         canvasAgent-&gt;willDeleteProgram(program);</span>
  }
  
<span class="line-modified">! bool InspectorInstrumentation::isShaderProgramDisabledImpl(InstrumentingAgents&amp; instrumentingAgents, WebGLProgram&amp; program)</span>
  {
      if (InspectorCanvasAgent* canvasAgent = instrumentingAgents.inspectorCanvasAgent())
<span class="line-modified">!         return canvasAgent-&gt;isShaderProgramDisabled(program);</span>
      return false;
  }
  
<span class="line-modified">! bool InspectorInstrumentation::isShaderProgramHighlightedImpl(InstrumentingAgents&amp; instrumentingAgents, WebGLProgram&amp; program)</span>
  {
      if (InspectorCanvasAgent* canvasAgent = instrumentingAgents.inspectorCanvasAgent())
<span class="line-modified">!         return canvasAgent-&gt;isShaderProgramHighlighted(program);</span>
      return false;
  }
  #endif
  
  #if ENABLE(RESOURCE_USAGE)
  void InspectorInstrumentation::didHandleMemoryPressureImpl(InstrumentingAgents&amp; instrumentingAgents, Critical critical)
  {
      if (InspectorMemoryAgent* memoryAgent = instrumentingAgents.inspectorMemoryAgent())
          memoryAgent-&gt;didHandleMemoryPressure(critical);
<span class="line-new-header">--- 1061,114 ---</span>
  {
      if (InspectorCanvasAgent* canvasAgent = instrumentingAgents.inspectorCanvasAgent())
          canvasAgent-&gt;didEnableExtension(contextWebGLBase, extension);
  }
  
<span class="line-modified">! void InspectorInstrumentation::didCreateWebGLProgramImpl(InstrumentingAgents&amp; instrumentingAgents, WebGLRenderingContextBase&amp; contextWebGLBase, WebGLProgram&amp; program)</span>
  {
      if (InspectorCanvasAgent* canvasAgent = instrumentingAgents.inspectorCanvasAgent())
<span class="line-modified">!         canvasAgent-&gt;didCreateWebGLProgram(contextWebGLBase, program);</span>
  }
  
<span class="line-modified">! void InspectorInstrumentation::willDestroyWebGLProgramImpl(InstrumentingAgents&amp; instrumentingAgents, WebGLProgram&amp; program)</span>
  {
      if (InspectorCanvasAgent* canvasAgent = instrumentingAgents.inspectorCanvasAgent())
<span class="line-modified">!         canvasAgent-&gt;willDestroyWebGLProgram(program);</span>
  }
  
<span class="line-modified">! bool InspectorInstrumentation::isWebGLProgramDisabledImpl(InstrumentingAgents&amp; instrumentingAgents, WebGLProgram&amp; program)</span>
  {
      if (InspectorCanvasAgent* canvasAgent = instrumentingAgents.inspectorCanvasAgent())
<span class="line-modified">!         return canvasAgent-&gt;isWebGLProgramDisabled(program);</span>
      return false;
  }
  
<span class="line-modified">! bool InspectorInstrumentation::isWebGLProgramHighlightedImpl(InstrumentingAgents&amp; instrumentingAgents, WebGLProgram&amp; program)</span>
  {
      if (InspectorCanvasAgent* canvasAgent = instrumentingAgents.inspectorCanvasAgent())
<span class="line-modified">!         return canvasAgent-&gt;isWebGLProgramHighlighted(program);</span>
      return false;
  }
  #endif
  
<span class="line-added">+ #if ENABLE(WEBGPU)</span>
<span class="line-added">+ void InspectorInstrumentation::didCreateWebGPUDeviceImpl(InstrumentingAgents&amp; instrumentingAgents, WebGPUDevice&amp; device)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* canvasAgent = instrumentingAgents.inspectorCanvasAgent())</span>
<span class="line-added">+         canvasAgent-&gt;didCreateWebGPUDevice(device);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ void InspectorInstrumentation::willDestroyWebGPUDeviceImpl(InstrumentingAgents&amp; instrumentingAgents, WebGPUDevice&amp; device)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* canvasAgent = instrumentingAgents.inspectorCanvasAgent())</span>
<span class="line-added">+         canvasAgent-&gt;willDestroyWebGPUDevice(device);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ void InspectorInstrumentation::willConfigureSwapChainImpl(InstrumentingAgents&amp; instrumentingAgents, GPUCanvasContext&amp; contextGPU, WebGPUSwapChain&amp; newSwapChain)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* canvasAgent = instrumentingAgents.inspectorCanvasAgent())</span>
<span class="line-added">+         canvasAgent-&gt;willConfigureSwapChain(contextGPU, newSwapChain);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ void InspectorInstrumentation::didCreateWebGPUPipelineImpl(InstrumentingAgents&amp; instrumentingAgents, WebGPUDevice&amp; device, WebGPUPipeline&amp; pipeline)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* canvasAgent = instrumentingAgents.inspectorCanvasAgent())</span>
<span class="line-added">+         canvasAgent-&gt;didCreateWebGPUPipeline(device, pipeline);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ void InspectorInstrumentation::willDestroyWebGPUPipelineImpl(InstrumentingAgents&amp; instrumentingAgents, WebGPUPipeline&amp; pipeline)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* canvasAgent = instrumentingAgents.inspectorCanvasAgent())</span>
<span class="line-added">+         canvasAgent-&gt;willDestroyWebGPUPipeline(pipeline);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ InstrumentingAgents* InspectorInstrumentation::instrumentingAgentsForWebGPUDevice(WebGPUDevice&amp; device)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     return instrumentingAgentsForContext(device.scriptExecutionContext());</span>
<span class="line-added">+ }</span>
<span class="line-added">+ #endif</span>
<span class="line-added">+ </span>
<span class="line-added">+ void InspectorInstrumentation::willApplyKeyframeEffectImpl(InstrumentingAgents&amp; instrumentingAgents, Element&amp; target, KeyframeEffect&amp; effect, ComputedEffectTiming computedTiming)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* animationAgent = instrumentingAgents.trackingInspectorAnimationAgent())</span>
<span class="line-added">+         animationAgent-&gt;willApplyKeyframeEffect(target, effect, computedTiming);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ void InspectorInstrumentation::didSetWebAnimationEffectImpl(InstrumentingAgents&amp; instrumentingAgents, WebAnimation&amp; animation)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* animationAgent = instrumentingAgents.enabledInspectorAnimationAgent())</span>
<span class="line-added">+         animationAgent-&gt;didSetWebAnimationEffect(animation);</span>
<span class="line-added">+     else if (auto* animationAgent = instrumentingAgents.trackingInspectorAnimationAgent())</span>
<span class="line-added">+         animationAgent-&gt;didSetWebAnimationEffect(animation);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ void InspectorInstrumentation::didChangeWebAnimationEffectTimingImpl(InstrumentingAgents&amp; instrumentingAgents, WebAnimation&amp; animation)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* animationAgent = instrumentingAgents.enabledInspectorAnimationAgent())</span>
<span class="line-added">+         animationAgent-&gt;didChangeWebAnimationEffectTiming(animation);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ void InspectorInstrumentation::didChangeWebAnimationEffectTargetImpl(InstrumentingAgents&amp; instrumentingAgents, WebAnimation&amp; animation)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* animationAgent = instrumentingAgents.enabledInspectorAnimationAgent())</span>
<span class="line-added">+         animationAgent-&gt;didChangeWebAnimationEffectTarget(animation);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ void InspectorInstrumentation::didCreateWebAnimationImpl(InstrumentingAgents&amp; instrumentingAgents, WebAnimation&amp; animation)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* animationAgent = instrumentingAgents.enabledInspectorAnimationAgent())</span>
<span class="line-added">+         animationAgent-&gt;didCreateWebAnimation(animation);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ void InspectorInstrumentation::willDestroyWebAnimationImpl(InstrumentingAgents&amp; instrumentingAgents, WebAnimation&amp; animation)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (auto* animationAgent = instrumentingAgents.enabledInspectorAnimationAgent())</span>
<span class="line-added">+         animationAgent-&gt;willDestroyWebAnimation(animation);</span>
<span class="line-added">+     else if (auto* animationAgent = instrumentingAgents.trackingInspectorAnimationAgent())</span>
<span class="line-added">+         animationAgent-&gt;willDestroyWebAnimation(animation);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  #if ENABLE(RESOURCE_USAGE)
  void InspectorInstrumentation::didHandleMemoryPressureImpl(InstrumentingAgents&amp; instrumentingAgents, Critical critical)
  {
      if (InspectorMemoryAgent* memoryAgent = instrumentingAgents.inspectorMemoryAgent())
          memoryAgent-&gt;didHandleMemoryPressure(critical);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1120,61 ***</span>
      return false;
  }
  
  void InspectorInstrumentation::didRequestAnimationFrameImpl(InstrumentingAgents&amp; instrumentingAgents, int callbackId, Document&amp; document)
  {
<span class="line-modified">!     if (PageDebuggerAgent* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
          pageDebuggerAgent-&gt;didRequestAnimationFrame(callbackId, document);
      if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())
          timelineAgent-&gt;didRequestAnimationFrame(callbackId, document.frame());
  }
  
  void InspectorInstrumentation::didCancelAnimationFrameImpl(InstrumentingAgents&amp; instrumentingAgents, int callbackId, Document&amp; document)
  {
<span class="line-modified">!     if (PageDebuggerAgent* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
          pageDebuggerAgent-&gt;didCancelAnimationFrame(callbackId);
      if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())
          timelineAgent-&gt;didCancelAnimationFrame(callbackId, document.frame());
  }
  
<span class="line-modified">! InspectorInstrumentationCookie InspectorInstrumentation::willFireAnimationFrameImpl(InstrumentingAgents&amp; instrumentingAgents, int callbackId, Document&amp; document)</span>
  {
<span class="line-modified">!     if (PageDebuggerAgent* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
          pageDebuggerAgent-&gt;willFireAnimationFrame(callbackId);
<span class="line-modified">! </span>
<span class="line-modified">!     if (InspectorDOMDebuggerAgent* domDebuggerAgent = instrumentingAgents.inspectorDOMDebuggerAgent())</span>
<span class="line-modified">!         domDebuggerAgent-&gt;willFireAnimationFrame();</span>
<span class="line-removed">- </span>
<span class="line-removed">-     int timelineAgentId = 0;</span>
<span class="line-removed">-     if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent()) {</span>
          timelineAgent-&gt;willFireAnimationFrame(callbackId, document.frame());
<span class="line-removed">-         timelineAgentId = timelineAgent-&gt;id();</span>
<span class="line-removed">-     }</span>
<span class="line-removed">-     return InspectorInstrumentationCookie(instrumentingAgents, timelineAgentId);</span>
  }
  
<span class="line-modified">! void InspectorInstrumentation::didFireAnimationFrameImpl(const InspectorInstrumentationCookie&amp; cookie)</span>
  {
<span class="line-modified">!     if (InspectorDebuggerAgent* debuggerAgent = cookie.instrumentingAgents()-&gt;inspectorDebuggerAgent())</span>
<span class="line-modified">!         debuggerAgent-&gt;didDispatchAsyncCall();</span>
<span class="line-modified">!     if (InspectorTimelineAgent* timelineAgent = retrieveTimelineAgent(cookie))</span>
          timelineAgent-&gt;didFireAnimationFrame();
  }
  
<span class="line-modified">! InspectorInstrumentationCookie InspectorInstrumentation::willFireObserverCallbackImpl(InstrumentingAgents&amp; instrumentingAgents, const String&amp; callbackType, ScriptExecutionContext&amp; context)</span>
  {
<span class="line-modified">!     int timelineAgentId = 0;</span>
<span class="line-removed">-     if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent()) {</span>
          timelineAgent-&gt;willFireObserverCallback(callbackType, frameForScriptExecutionContext(&amp;context));
<span class="line-removed">-         timelineAgentId = timelineAgent-&gt;id();</span>
<span class="line-removed">-     }</span>
<span class="line-removed">-     return InspectorInstrumentationCookie(instrumentingAgents, timelineAgentId);</span>
  }
  
<span class="line-modified">! void InspectorInstrumentation::didFireObserverCallbackImpl(const InspectorInstrumentationCookie&amp; cookie)</span>
  {
<span class="line-modified">!     if (InspectorTimelineAgent* timelineAgent = retrieveTimelineAgent(cookie))</span>
          timelineAgent-&gt;didFireObserverCallback();
  }
  
  void InspectorInstrumentation::registerInstrumentingAgents(InstrumentingAgents&amp; instrumentingAgents)
  {
<span class="line-new-header">--- 1205,51 ---</span>
      return false;
  }
  
  void InspectorInstrumentation::didRequestAnimationFrameImpl(InstrumentingAgents&amp; instrumentingAgents, int callbackId, Document&amp; document)
  {
<span class="line-modified">!     if (auto* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
          pageDebuggerAgent-&gt;didRequestAnimationFrame(callbackId, document);
      if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())
          timelineAgent-&gt;didRequestAnimationFrame(callbackId, document.frame());
  }
  
  void InspectorInstrumentation::didCancelAnimationFrameImpl(InstrumentingAgents&amp; instrumentingAgents, int callbackId, Document&amp; document)
  {
<span class="line-modified">!     if (auto* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
          pageDebuggerAgent-&gt;didCancelAnimationFrame(callbackId);
      if (InspectorTimelineAgent* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())
          timelineAgent-&gt;didCancelAnimationFrame(callbackId, document.frame());
  }
  
<span class="line-modified">! void InspectorInstrumentation::willFireAnimationFrameImpl(InstrumentingAgents&amp; instrumentingAgents, int callbackId, Document&amp; document)</span>
  {
<span class="line-modified">!     if (auto* pageDebuggerAgent = instrumentingAgents.pageDebuggerAgent())</span>
          pageDebuggerAgent-&gt;willFireAnimationFrame(callbackId);
<span class="line-modified">!     if (auto* pageDOMDebuggerAgent = instrumentingAgents.pageDOMDebuggerAgent())</span>
<span class="line-modified">!         pageDOMDebuggerAgent-&gt;willFireAnimationFrame();</span>
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;willFireAnimationFrame(callbackId, document.frame());
  }
  
<span class="line-modified">! void InspectorInstrumentation::didFireAnimationFrameImpl(InstrumentingAgents&amp; instrumentingAgents)</span>
  {
<span class="line-modified">!     if (auto* webDebuggerAgent = instrumentingAgents.webDebuggerAgent())</span>
<span class="line-modified">!         webDebuggerAgent-&gt;didDispatchAsyncCall();</span>
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;didFireAnimationFrame();
  }
  
<span class="line-modified">! void InspectorInstrumentation::willFireObserverCallbackImpl(InstrumentingAgents&amp; instrumentingAgents, const String&amp; callbackType, ScriptExecutionContext&amp; context)</span>
  {
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;willFireObserverCallback(callbackType, frameForScriptExecutionContext(&amp;context));
  }
  
<span class="line-modified">! void InspectorInstrumentation::didFireObserverCallbackImpl(InstrumentingAgents&amp; instrumentingAgents)</span>
  {
<span class="line-modified">!     if (auto* timelineAgent = instrumentingAgents.trackingInspectorTimelineAgent())</span>
          timelineAgent-&gt;didFireObserverCallback();
  }
  
  void InspectorInstrumentation::registerInstrumentingAgents(InstrumentingAgents&amp; instrumentingAgents)
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1194,21 ***</span>
          delete s_instrumentingAgentsSet;
          s_instrumentingAgentsSet = nullptr;
      }
  }
  
<span class="line-removed">- InspectorTimelineAgent* InspectorInstrumentation::retrieveTimelineAgent(const InspectorInstrumentationCookie&amp; cookie)</span>
<span class="line-removed">- {</span>
<span class="line-removed">-     if (!cookie.isValid())</span>
<span class="line-removed">-         return nullptr;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     InspectorTimelineAgent* timelineAgent = cookie.instrumentingAgents()-&gt;trackingInspectorTimelineAgent();</span>
<span class="line-removed">-     if (timelineAgent &amp;&amp; cookie.hasMatchingTimelineAgentId(timelineAgent-&gt;id()))</span>
<span class="line-removed">-         return timelineAgent;</span>
<span class="line-removed">-     return nullptr;</span>
<span class="line-removed">- }</span>
<span class="line-removed">- </span>
  InstrumentingAgents* InspectorInstrumentation::instrumentingAgentsForRenderer(RenderObject&amp; renderer)
  {
      return instrumentingAgentsForFrame(renderer.frame());
  }
  
<span class="line-new-header">--- 1269,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1222,6 ***</span>
<span class="line-new-header">--- 1286,26 ---</span>
  {
      if (InspectorLayerTreeAgent* layerTreeAgent = instrumentingAgents.inspectorLayerTreeAgent())
          layerTreeAgent-&gt;renderLayerDestroyed(renderLayer);
  }
  
<span class="line-added">+ InstrumentingAgents&amp; InspectorInstrumentation::instrumentingAgentsForWorkerGlobalScope(WorkerGlobalScope&amp; workerGlobalScope)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     return workerGlobalScope.inspectorController().m_instrumentingAgents;</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ InstrumentingAgents&amp; InspectorInstrumentation::instrumentingAgentsForPage(Page&amp; page)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     ASSERT(isMainThread());</span>
<span class="line-added">+     return page.inspectorController().m_instrumentingAgents.get();</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ InstrumentingAgents* InspectorInstrumentation::instrumentingAgentsForContext(ScriptExecutionContext&amp; context)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     if (is&lt;Document&gt;(context))</span>
<span class="line-added">+         return instrumentingAgentsForPage(downcast&lt;Document&gt;(context).page());</span>
<span class="line-added">+     if (is&lt;WorkerGlobalScope&gt;(context))</span>
<span class="line-added">+         return &amp;instrumentingAgentsForWorkerGlobalScope(downcast&lt;WorkerGlobalScope&gt;(context));</span>
<span class="line-added">+     return nullptr;</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  } // namespace WebCore
</pre>
<center><a href="InspectorFrontendHost.idl.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="InspectorInstrumentation.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>