<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/inspector/agents/InspectorDOMAgent.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="InspectorDOMAgent.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="InspectorDOMDebuggerAgent.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/inspector/agents/InspectorDOMAgent.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 44,17 ***</span>
  namespace Inspector {
  class InjectedScriptManager;
  }
  
  namespace JSC {
<span class="line-modified">! class ExecState;</span>
  class JSValue;
  }
  
  namespace WebCore {
  
<span class="line-modified">! class AccessibilityObject;</span>
  class CharacterData;
  class DOMEditor;
  class Document;
  class Element;
  class Event;
<span class="line-new-header">--- 44,17 ---</span>
  namespace Inspector {
  class InjectedScriptManager;
  }
  
  namespace JSC {
<span class="line-modified">! class CallFrame;</span>
  class JSValue;
  }
  
  namespace WebCore {
  
<span class="line-modified">! class AXCoreObject;</span>
  class CharacterData;
  class DOMEditor;
  class Document;
  class Element;
  class Event;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 80,11 ***</span>
  class InspectorDOMAgent final : public InspectorAgentBase, public Inspector::DOMBackendDispatcherHandler {
      WTF_MAKE_NONCOPYABLE(InspectorDOMAgent);
      WTF_MAKE_FAST_ALLOCATED;
  public:
      InspectorDOMAgent(PageAgentContext&amp;, InspectorOverlay*);
<span class="line-modified">!     virtual ~InspectorDOMAgent();</span>
  
      static String toErrorString(ExceptionCode);
      static String toErrorString(Exception&amp;&amp;);
  
      static String documentURLString(Document*);
<span class="line-new-header">--- 80,11 ---</span>
  class InspectorDOMAgent final : public InspectorAgentBase, public Inspector::DOMBackendDispatcherHandler {
      WTF_MAKE_NONCOPYABLE(InspectorDOMAgent);
      WTF_MAKE_FAST_ALLOCATED;
  public:
      InspectorDOMAgent(PageAgentContext&amp;, InspectorOverlay*);
<span class="line-modified">!     ~InspectorDOMAgent() override;</span>
  
      static String toErrorString(ExceptionCode);
      static String toErrorString(Exception&amp;&amp;);
  
      static String documentURLString(Document*);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 96,59 ***</span>
      static Node* innerPreviousSibling(Node*);
      static unsigned innerChildNodeCount(Node*);
      static Node* innerParentNode(Node*);
  
      static Node* scriptValueAsNode(JSC::JSValue);
<span class="line-modified">!     static JSC::JSValue nodeAsScriptValue(JSC::ExecState&amp;, Node*);</span>
  
      // InspectorAgentBase
<span class="line-modified">!     void didCreateFrontendAndBackend(Inspector::FrontendRouter*, Inspector::BackendDispatcher*);</span>
<span class="line-modified">!     void willDestroyFrontendAndBackend(Inspector::DisconnectReason);</span>
  
      // DOMBackendDispatcherHandler
<span class="line-modified">!     void querySelector(ErrorString&amp;, int nodeId, const String&amp; selectors, int* elementId);</span>
<span class="line-modified">!     void querySelectorAll(ErrorString&amp;, int nodeId, const String&amp; selectors, RefPtr&lt;JSON::ArrayOf&lt;int&gt;&gt;&amp; result);</span>
<span class="line-modified">!     void getDocument(ErrorString&amp;, RefPtr&lt;Inspector::Protocol::DOM::Node&gt;&amp; root);</span>
<span class="line-modified">!     void requestChildNodes(ErrorString&amp;, int nodeId, const int* depth);</span>
<span class="line-modified">!     void setAttributeValue(ErrorString&amp;, int elementId, const String&amp; name, const String&amp; value);</span>
<span class="line-modified">!     void setAttributesAsText(ErrorString&amp;, int elementId, const String&amp; text, const String* name);</span>
<span class="line-modified">!     void removeAttribute(ErrorString&amp;, int elementId, const String&amp; name);</span>
<span class="line-modified">!     void removeNode(ErrorString&amp;, int nodeId);</span>
<span class="line-modified">!     void setNodeName(ErrorString&amp;, int nodeId, const String&amp; name, int* newId);</span>
<span class="line-modified">!     void getOuterHTML(ErrorString&amp;, int nodeId, WTF::String* outerHTML);</span>
<span class="line-modified">!     void setOuterHTML(ErrorString&amp;, int nodeId, const String&amp; outerHTML);</span>
<span class="line-modified">!     void insertAdjacentHTML(ErrorString&amp;, int nodeId, const String&amp; position, const String&amp; html);</span>
<span class="line-modified">!     void setNodeValue(ErrorString&amp;, int nodeId, const String&amp; value);</span>
<span class="line-modified">!     void getSupportedEventNames(ErrorString&amp;, RefPtr&lt;JSON::ArrayOf&lt;String&gt;&gt;&amp; eventNames);</span>
<span class="line-modified">!     void getDataBindingsForNode(ErrorString&amp;, int nodeId, RefPtr&lt;JSON::ArrayOf&lt;Inspector::Protocol::DOM::DataBinding&gt;&gt;&amp; dataArray);</span>
<span class="line-modified">!     void getAssociatedDataForNode(ErrorString&amp;, int nodeId, Optional&lt;String&gt;&amp; associatedData);</span>
<span class="line-modified">!     void getEventListenersForNode(ErrorString&amp;, int nodeId, RefPtr&lt;JSON::ArrayOf&lt;Inspector::Protocol::DOM::EventListener&gt;&gt;&amp; listenersArray);</span>
<span class="line-modified">!     void setEventListenerDisabled(ErrorString&amp;, int eventListenerId, bool disabled);</span>
<span class="line-modified">!     void setBreakpointForEventListener(ErrorString&amp;, int eventListenerId);</span>
<span class="line-modified">!     void removeBreakpointForEventListener(ErrorString&amp;, int eventListenerId);</span>
<span class="line-modified">!     void getAccessibilityPropertiesForNode(ErrorString&amp;, int nodeId, RefPtr&lt;Inspector::Protocol::DOM::AccessibilityProperties&gt;&amp; axProperties);</span>
<span class="line-modified">!     void performSearch(ErrorString&amp;, const String&amp; query, const JSON::Array* nodeIds, const bool* caseSensitive, String* searchId, int* resultCount);</span>
<span class="line-modified">!     void getSearchResults(ErrorString&amp;, const String&amp; searchId, int fromIndex, int toIndex, RefPtr&lt;JSON::ArrayOf&lt;int&gt;&gt;&amp;);</span>
<span class="line-modified">!     void discardSearchResults(ErrorString&amp;, const String&amp; searchId);</span>
<span class="line-modified">!     void resolveNode(ErrorString&amp;, int nodeId, const String* objectGroup, RefPtr&lt;Inspector::Protocol::Runtime::RemoteObject&gt;&amp; result);</span>
<span class="line-modified">!     void getAttributes(ErrorString&amp;, int nodeId, RefPtr&lt;JSON::ArrayOf&lt;String&gt;&gt;&amp; result);</span>
<span class="line-modified">!     void setInspectModeEnabled(ErrorString&amp;, bool enabled, const JSON::Object* highlightConfig, const bool* showRulers);</span>
<span class="line-modified">!     void requestNode(ErrorString&amp;, const String&amp; objectId, int* nodeId);</span>
<span class="line-modified">!     void pushNodeByPathToFrontend(ErrorString&amp;, const String&amp; path, int* nodeId);</span>
<span class="line-modified">!     void hideHighlight(ErrorString&amp;);</span>
<span class="line-modified">!     void highlightRect(ErrorString&amp;, int x, int y, int width, int height, const JSON::Object* color, const JSON::Object* outlineColor, const bool* usePageCoordinates);</span>
<span class="line-modified">!     void highlightQuad(ErrorString&amp;, const JSON::Array&amp; quad, const JSON::Object* color, const JSON::Object* outlineColor, const bool* usePageCoordinates);</span>
<span class="line-modified">!     void highlightSelector(ErrorString&amp;, const JSON::Object&amp; highlightConfig, const String&amp; selectorString, const String* frameId);</span>
<span class="line-modified">!     void highlightNode(ErrorString&amp;, const JSON::Object&amp; highlightConfig, const int* nodeId, const String* objectId);</span>
<span class="line-modified">!     void highlightNodeList(ErrorString&amp;, const JSON::Array&amp; nodeIds, const JSON::Object&amp; highlightConfig);</span>
<span class="line-modified">!     void highlightFrame(ErrorString&amp;, const String&amp; frameId, const JSON::Object* color, const JSON::Object* outlineColor);</span>
<span class="line-modified">!     void moveTo(ErrorString&amp;, int nodeId, int targetNodeId, const int* anchorNodeId, int* newNodeId);</span>
<span class="line-modified">!     void undo(ErrorString&amp;);</span>
<span class="line-modified">!     void redo(ErrorString&amp;);</span>
<span class="line-modified">!     void markUndoableState(ErrorString&amp;);</span>
<span class="line-modified">!     void focus(ErrorString&amp;, int nodeId);</span>
<span class="line-modified">!     void setInspectedNode(ErrorString&amp;, int nodeId);</span>
  
      // InspectorInstrumentation
      int identifierForNode(Node&amp;);
      void addEventListenersToNode(Node&amp;);
      void didInsertDOMNode(Node&amp;);
<span class="line-new-header">--- 96,60 ---</span>
      static Node* innerPreviousSibling(Node*);
      static unsigned innerChildNodeCount(Node*);
      static Node* innerParentNode(Node*);
  
      static Node* scriptValueAsNode(JSC::JSValue);
<span class="line-modified">!     static JSC::JSValue nodeAsScriptValue(JSC::JSGlobalObject&amp;, Node*);</span>
  
      // InspectorAgentBase
<span class="line-modified">!     void didCreateFrontendAndBackend(Inspector::FrontendRouter*, Inspector::BackendDispatcher*) override;</span>
<span class="line-modified">!     void willDestroyFrontendAndBackend(Inspector::DisconnectReason) override;</span>
  
      // DOMBackendDispatcherHandler
<span class="line-modified">!     void querySelector(ErrorString&amp;, int nodeId, const String&amp; selectors, int* elementId) override;</span>
<span class="line-modified">!     void querySelectorAll(ErrorString&amp;, int nodeId, const String&amp; selectors, RefPtr&lt;JSON::ArrayOf&lt;int&gt;&gt;&amp; result) override;</span>
<span class="line-modified">!     void getDocument(ErrorString&amp;, RefPtr&lt;Inspector::Protocol::DOM::Node&gt;&amp; root) override;</span>
<span class="line-modified">!     void requestChildNodes(ErrorString&amp;, int nodeId, const int* depth) override;</span>
<span class="line-modified">!     void setAttributeValue(ErrorString&amp;, int elementId, const String&amp; name, const String&amp; value) override;</span>
<span class="line-modified">!     void setAttributesAsText(ErrorString&amp;, int elementId, const String&amp; text, const String* name) override;</span>
<span class="line-modified">!     void removeAttribute(ErrorString&amp;, int elementId, const String&amp; name) override;</span>
<span class="line-modified">!     void removeNode(ErrorString&amp;, int nodeId) override;</span>
<span class="line-modified">!     void setNodeName(ErrorString&amp;, int nodeId, const String&amp; name, int* newId) override;</span>
<span class="line-modified">!     void getOuterHTML(ErrorString&amp;, int nodeId, WTF::String* outerHTML) override;</span>
<span class="line-modified">!     void setOuterHTML(ErrorString&amp;, int nodeId, const String&amp; outerHTML) override;</span>
<span class="line-modified">!     void insertAdjacentHTML(ErrorString&amp;, int nodeId, const String&amp; position, const String&amp; html) override;</span>
<span class="line-modified">!     void setNodeValue(ErrorString&amp;, int nodeId, const String&amp; value) override;</span>
<span class="line-modified">!     void getSupportedEventNames(ErrorString&amp;, RefPtr&lt;JSON::ArrayOf&lt;String&gt;&gt;&amp; eventNames) override;</span>
<span class="line-modified">!     void getDataBindingsForNode(ErrorString&amp;, int nodeId, RefPtr&lt;JSON::ArrayOf&lt;Inspector::Protocol::DOM::DataBinding&gt;&gt;&amp; dataArray) override;</span>
<span class="line-modified">!     void getAssociatedDataForNode(ErrorString&amp;, int nodeId, Optional&lt;String&gt;&amp; associatedData) override;</span>
<span class="line-modified">!     void getEventListenersForNode(ErrorString&amp;, int nodeId, RefPtr&lt;JSON::ArrayOf&lt;Inspector::Protocol::DOM::EventListener&gt;&gt;&amp; listenersArray) override;</span>
<span class="line-modified">!     void setEventListenerDisabled(ErrorString&amp;, int eventListenerId, bool disabled) override;</span>
<span class="line-modified">!     void setBreakpointForEventListener(ErrorString&amp;, int eventListenerId) override;</span>
<span class="line-modified">!     void removeBreakpointForEventListener(ErrorString&amp;, int eventListenerId) override;</span>
<span class="line-modified">!     void getAccessibilityPropertiesForNode(ErrorString&amp;, int nodeId, RefPtr&lt;Inspector::Protocol::DOM::AccessibilityProperties&gt;&amp; axProperties) override;</span>
<span class="line-modified">!     void performSearch(ErrorString&amp;, const String&amp; query, const JSON::Array* nodeIds, const bool* caseSensitive, String* searchId, int* resultCount) override;</span>
<span class="line-modified">!     void getSearchResults(ErrorString&amp;, const String&amp; searchId, int fromIndex, int toIndex, RefPtr&lt;JSON::ArrayOf&lt;int&gt;&gt;&amp;) override;</span>
<span class="line-modified">!     void discardSearchResults(ErrorString&amp;, const String&amp; searchId) override;</span>
<span class="line-modified">!     void resolveNode(ErrorString&amp;, int nodeId, const String* objectGroup, RefPtr&lt;Inspector::Protocol::Runtime::RemoteObject&gt;&amp; result) override;</span>
<span class="line-modified">!     void getAttributes(ErrorString&amp;, int nodeId, RefPtr&lt;JSON::ArrayOf&lt;String&gt;&gt;&amp; result) override;</span>
<span class="line-modified">!     void setInspectModeEnabled(ErrorString&amp;, bool enabled, const JSON::Object* highlightConfig, const bool* showRulers) override;</span>
<span class="line-modified">!     void requestNode(ErrorString&amp;, const String&amp; objectId, int* nodeId) override;</span>
<span class="line-modified">!     void pushNodeByPathToFrontend(ErrorString&amp;, const String&amp; path, int* nodeId) override;</span>
<span class="line-modified">!     void hideHighlight(ErrorString&amp;) override;</span>
<span class="line-modified">!     void highlightRect(ErrorString&amp;, int x, int y, int width, int height, const JSON::Object* color, const JSON::Object* outlineColor, const bool* usePageCoordinates) override;</span>
<span class="line-modified">!     void highlightQuad(ErrorString&amp;, const JSON::Array&amp; quad, const JSON::Object* color, const JSON::Object* outlineColor, const bool* usePageCoordinates) override;</span>
<span class="line-modified">!     void highlightSelector(ErrorString&amp;, const JSON::Object&amp; highlightConfig, const String&amp; selectorString, const String* frameId) override;</span>
<span class="line-modified">!     void highlightNode(ErrorString&amp;, const JSON::Object&amp; highlightConfig, const int* nodeId, const String* objectId) override;</span>
<span class="line-modified">!     void highlightNodeList(ErrorString&amp;, const JSON::Array&amp; nodeIds, const JSON::Object&amp; highlightConfig) override;</span>
<span class="line-modified">!     void highlightFrame(ErrorString&amp;, const String&amp; frameId, const JSON::Object* color, const JSON::Object* outlineColor) override;</span>
<span class="line-modified">!     void moveTo(ErrorString&amp;, int nodeId, int targetNodeId, const int* anchorNodeId, int* newNodeId) override;</span>
<span class="line-modified">!     void undo(ErrorString&amp;) override;</span>
<span class="line-modified">!     void redo(ErrorString&amp;) override;</span>
<span class="line-modified">!     void markUndoableState(ErrorString&amp;) override;</span>
<span class="line-modified">!     void focus(ErrorString&amp;, int nodeId) override;</span>
<span class="line-modified">!     void setInspectedNode(ErrorString&amp;, int nodeId) override;</span>
<span class="line-added">+     void setAllowEditingUserAgentShadowTrees(ErrorString&amp;, bool allow) final;</span>
  
      // InspectorInstrumentation
      int identifierForNode(Node&amp;);
      void addEventListenersToNode(Node&amp;);
      void didInsertDOMNode(Node&amp;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 175,11 ***</span>
<span class="line-new-header">--- 176,14 ---</span>
      void setDocument(Document*);
      void releaseDanglingNodes();
  
      void styleAttributeInvalidated(const Vector&lt;Element*&gt;&amp; elements);
  
<span class="line-added">+     int pushNodeToFrontend(Node*);</span>
      int pushNodeToFrontend(ErrorString&amp;, int documentNodeId, Node*);
<span class="line-added">+     int pushNodePathToFrontend(Node*);</span>
<span class="line-added">+     int pushNodePathToFrontend(ErrorString, Node*);</span>
      Node* nodeForId(int nodeId);
      int boundNodeId(const Node*);
  
      RefPtr&lt;Inspector::Protocol::Runtime::RemoteObject&gt; resolveNode(Node*, const String&amp; objectGroup);
      bool handleMousePress();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 213,20 ***</span>
      void unbind(Node*, NodeToIdMap*);
  
      Node* assertEditableNode(ErrorString&amp;, int nodeId);
      Element* assertEditableElement(ErrorString&amp;, int nodeId);
  
<span class="line-removed">-     int pushNodePathToFrontend(Node*);</span>
      void pushChildNodesToFrontend(int nodeId, int depth = 1);
  
      Ref&lt;Inspector::Protocol::DOM::Node&gt; buildObjectForNode(Node*, int depth, NodeToIdMap*);
      Ref&lt;JSON::ArrayOf&lt;String&gt;&gt; buildArrayForElementAttributes(Element*);
      Ref&lt;JSON::ArrayOf&lt;Inspector::Protocol::DOM::Node&gt;&gt; buildArrayForContainerChildren(Node* container, int depth, NodeToIdMap* nodesMap);
      RefPtr&lt;JSON::ArrayOf&lt;Inspector::Protocol::DOM::Node&gt;&gt; buildArrayForPseudoElements(const Element&amp;, NodeToIdMap* nodesMap);
      Ref&lt;Inspector::Protocol::DOM::EventListener&gt; buildObjectForEventListener(const RegisteredEventListener&amp;, int identifier, EventTarget&amp;, const AtomString&amp; eventType, bool disabled, bool hasBreakpoint);
      RefPtr&lt;Inspector::Protocol::DOM::AccessibilityProperties&gt; buildObjectForAccessibilityProperties(Node*);
<span class="line-modified">!     void processAccessibilityChildren(AccessibilityObject&amp;, JSON::ArrayOf&lt;int&gt;&amp;);</span>
  
      Node* nodeForPath(const String&amp; path);
      Node* nodeForObjectId(const String&amp; objectId);
  
      void discardBindings();
<span class="line-new-header">--- 217,19 ---</span>
      void unbind(Node*, NodeToIdMap*);
  
      Node* assertEditableNode(ErrorString&amp;, int nodeId);
      Element* assertEditableElement(ErrorString&amp;, int nodeId);
  
      void pushChildNodesToFrontend(int nodeId, int depth = 1);
  
      Ref&lt;Inspector::Protocol::DOM::Node&gt; buildObjectForNode(Node*, int depth, NodeToIdMap*);
      Ref&lt;JSON::ArrayOf&lt;String&gt;&gt; buildArrayForElementAttributes(Element*);
      Ref&lt;JSON::ArrayOf&lt;Inspector::Protocol::DOM::Node&gt;&gt; buildArrayForContainerChildren(Node* container, int depth, NodeToIdMap* nodesMap);
      RefPtr&lt;JSON::ArrayOf&lt;Inspector::Protocol::DOM::Node&gt;&gt; buildArrayForPseudoElements(const Element&amp;, NodeToIdMap* nodesMap);
      Ref&lt;Inspector::Protocol::DOM::EventListener&gt; buildObjectForEventListener(const RegisteredEventListener&amp;, int identifier, EventTarget&amp;, const AtomString&amp; eventType, bool disabled, bool hasBreakpoint);
      RefPtr&lt;Inspector::Protocol::DOM::AccessibilityProperties&gt; buildObjectForAccessibilityProperties(Node*);
<span class="line-modified">!     void processAccessibilityChildren(AXCoreObject&amp;, JSON::ArrayOf&lt;int&gt;&amp;);</span>
  
      Node* nodeForPath(const String&amp; path);
      Node* nodeForObjectId(const String&amp; objectId);
  
      void discardBindings();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 253,14 ***</span>
      RefPtr&lt;Node&gt; m_mousedOverNode;
      RefPtr&lt;Node&gt; m_inspectedNode;
      std::unique_ptr&lt;HighlightConfig&gt; m_inspectModeHighlightConfig;
      std::unique_ptr&lt;InspectorHistory&gt; m_history;
      std::unique_ptr&lt;DOMEditor&gt; m_domEditor;
<span class="line-removed">-     bool m_searchingForNode { false };</span>
<span class="line-removed">-     bool m_suppressAttributeModifiedEvent { false };</span>
<span class="line-removed">-     bool m_suppressEventListenerChangedEvent { false };</span>
<span class="line-removed">-     bool m_documentRequested { false };</span>
  
  #if ENABLE(VIDEO)
      Timer m_mediaMetricsTimer;
      struct MediaMetrics {
          unsigned displayCompositedFrames { 0 };
<span class="line-new-header">--- 256,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 315,8 ***</span>
<span class="line-new-header">--- 314,14 ---</span>
      friend class EventFiredCallback;
  
      HashSet&lt;const Event*&gt; m_dispatchedEvents;
      HashMap&lt;int, InspectorEventListener&gt; m_eventListenerEntries;
      int m_lastEventListenerId { 1 };
<span class="line-added">+ </span>
<span class="line-added">+     bool m_searchingForNode { false };</span>
<span class="line-added">+     bool m_suppressAttributeModifiedEvent { false };</span>
<span class="line-added">+     bool m_suppressEventListenerChangedEvent { false };</span>
<span class="line-added">+     bool m_documentRequested { false };</span>
<span class="line-added">+     bool m_allowEditingUserAgentShadowTrees { false };</span>
  };
  
  } // namespace WebCore
</pre>
<center><a href="InspectorDOMAgent.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="InspectorDOMDebuggerAgent.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>