<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/bytecode/UnlinkedModuleProgramCodeBlock.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="UnlinkedMetadataTableInlines.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="UnlinkedProgramCodeBlock.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/bytecode/UnlinkedModuleProgramCodeBlock.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #include &quot;UnlinkedGlobalCodeBlock.h&quot;
 29 
 30 namespace JSC {
 31 
 32 class Decoder;
 33 class CachedModuleCodeBlock;
 34 
 35 class UnlinkedModuleProgramCodeBlock final : public UnlinkedGlobalCodeBlock {
 36 public:
 37     typedef UnlinkedGlobalCodeBlock Base;
<span class="line-modified"> 38     static const unsigned StructureFlags = Base::StructureFlags | StructureIsImmortal;</span>






 39 
 40     static UnlinkedModuleProgramCodeBlock* create(VM&amp; vm, const ExecutableInfo&amp; info, OptionSet&lt;CodeGenerationMode&gt; codeGenerationMode)
 41     {
 42         UnlinkedModuleProgramCodeBlock* instance = new (NotNull, allocateCell&lt;UnlinkedModuleProgramCodeBlock&gt;(vm.heap)) UnlinkedModuleProgramCodeBlock(vm, vm.unlinkedModuleProgramCodeBlockStructure.get(), info, codeGenerationMode);
 43         instance-&gt;finishCreation(vm);
 44         return instance;
 45     }
 46 
 47     static void destroy(JSCell*);
 48 
 49     // This offset represents the constant register offset to the stored symbol table that represents the layout of the
 50     // module environment. This symbol table is created by the byte code generator since the module environment includes
 51     // the top-most lexical captured variables inside the module code. This means that, once the module environment is
 52     // allocated and instantiated from this symbol table, it is titely coupled with the specific unlinked module program
 53     // code block and the stored symbol table. So before executing the module code, we should not clear the unlinked module
 54     // program code block in the module executable. This requirement is met because the garbage collector only clears
 55     // unlinked code in (1) unmarked executables and (2) function executables.
 56     //
 57     // Since the function code may be executed repeatedly and the environment of each function execution is different,
 58     // the function code need to allocate and instantiate the environment in the prologue of the function code. On the
</pre>
</td>
<td>
<hr />
<pre>
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #include &quot;UnlinkedGlobalCodeBlock.h&quot;
 29 
 30 namespace JSC {
 31 
 32 class Decoder;
 33 class CachedModuleCodeBlock;
 34 
 35 class UnlinkedModuleProgramCodeBlock final : public UnlinkedGlobalCodeBlock {
 36 public:
 37     typedef UnlinkedGlobalCodeBlock Base;
<span class="line-modified"> 38     static constexpr unsigned StructureFlags = Base::StructureFlags | StructureIsImmortal;</span>
<span class="line-added"> 39 </span>
<span class="line-added"> 40     template&lt;typename CellType, SubspaceAccess mode&gt;</span>
<span class="line-added"> 41     static IsoSubspace* subspaceFor(VM&amp; vm)</span>
<span class="line-added"> 42     {</span>
<span class="line-added"> 43         return vm.unlinkedModuleProgramCodeBlockSpace&lt;mode&gt;();</span>
<span class="line-added"> 44     }</span>
 45 
 46     static UnlinkedModuleProgramCodeBlock* create(VM&amp; vm, const ExecutableInfo&amp; info, OptionSet&lt;CodeGenerationMode&gt; codeGenerationMode)
 47     {
 48         UnlinkedModuleProgramCodeBlock* instance = new (NotNull, allocateCell&lt;UnlinkedModuleProgramCodeBlock&gt;(vm.heap)) UnlinkedModuleProgramCodeBlock(vm, vm.unlinkedModuleProgramCodeBlockStructure.get(), info, codeGenerationMode);
 49         instance-&gt;finishCreation(vm);
 50         return instance;
 51     }
 52 
 53     static void destroy(JSCell*);
 54 
 55     // This offset represents the constant register offset to the stored symbol table that represents the layout of the
 56     // module environment. This symbol table is created by the byte code generator since the module environment includes
 57     // the top-most lexical captured variables inside the module code. This means that, once the module environment is
 58     // allocated and instantiated from this symbol table, it is titely coupled with the specific unlinked module program
 59     // code block and the stored symbol table. So before executing the module code, we should not clear the unlinked module
 60     // program code block in the module executable. This requirement is met because the garbage collector only clears
 61     // unlinked code in (1) unmarked executables and (2) function executables.
 62     //
 63     // Since the function code may be executed repeatedly and the environment of each function execution is different,
 64     // the function code need to allocate and instantiate the environment in the prologue of the function code. On the
</pre>
</td>
</tr>
</table>
<center><a href="UnlinkedMetadataTableInlines.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="UnlinkedProgramCodeBlock.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>