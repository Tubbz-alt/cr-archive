<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/b3/B3Procedure.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="B3PatchpointSpecial.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="B3Procedure.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/b3/B3Procedure.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (C) 2015-2019 Apple Inc. All rights reserved.</span>
  3  *
  4  * Redistribution and use in source and binary forms, with or without
  5  * modification, are permitted provided that the following conditions
  6  * are met:
  7  * 1. Redistributions of source code must retain the above copyright
  8  *    notice, this list of conditions and the following disclaimer.
  9  * 2. Redistributions in binary form must reproduce the above copyright
 10  *    notice, this list of conditions and the following disclaimer in the
 11  *    documentation and/or other materials provided with the distribution.
 12  *
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
 14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 15  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
</pre>
<hr />
<pre>
222 {
223     m_dominators = nullptr;
224     m_naturalLoops = nullptr;
225     m_backwardsCFG = nullptr;
226     m_backwardsDominators = nullptr;
227 }
228 
229 void Procedure::dump(PrintStream&amp; out) const
230 {
231     IndexSet&lt;Value*&gt; valuesInBlocks;
232     for (BasicBlock* block : *this) {
233         out.print(deepDump(*this, block));
234         valuesInBlocks.addAll(*block);
235     }
236     bool didPrint = false;
237     for (Value* value : values()) {
238         if (valuesInBlocks.contains(value))
239             continue;
240 
241         if (!didPrint) {
<span class="line-modified">242             dataLog(&quot;Orphaned values:\n&quot;);</span>
243             didPrint = true;
244         }
<span class="line-modified">245         dataLog(&quot;    &quot;, deepDump(*this, value), &quot;\n&quot;);</span>
246     }
247     if (hasQuirks())
<span class="line-modified">248         out.print(&quot;Has Quirks: True\n&quot;);</span>
249     if (variables().size()) {
<span class="line-modified">250         out.print(&quot;Variables:\n&quot;);</span>
251         for (Variable* variable : variables())
<span class="line-modified">252             out.print(&quot;    &quot;, deepDump(variable), &quot;\n&quot;);</span>
253     }
254     if (stackSlots().size()) {
<span class="line-modified">255         out.print(&quot;Stack slots:\n&quot;);</span>
256         for (StackSlot* slot : stackSlots())
<span class="line-modified">257             out.print(&quot;    &quot;, pointerDump(slot), &quot;: &quot;, deepDump(slot), &quot;\n&quot;);</span>
258     }
259     if (m_byproducts-&gt;count())
260         out.print(*m_byproducts);
261 }
262 
263 Vector&lt;BasicBlock*&gt; Procedure::blocksInPreOrder()
264 {
265     return B3::blocksInPreOrder(at(0));
266 }
267 
268 Vector&lt;BasicBlock*&gt; Procedure::blocksInPostOrder()
269 {
270     return B3::blocksInPostOrder(at(0));
271 }
272 
273 void Procedure::deleteStackSlot(StackSlot* stackSlot)
274 {
275     m_stackSlots.remove(stackSlot);
276 }
277 
</pre>
<hr />
<pre>
332 BackwardsDominators&amp; Procedure::backwardsDominators()
333 {
334     if (!m_backwardsDominators)
335         m_backwardsDominators = makeUnique&lt;BackwardsDominators&gt;(*this);
336     return *m_backwardsDominators;
337 }
338 
339 void Procedure::addFastConstant(const ValueKey&amp; constant)
340 {
341     RELEASE_ASSERT(constant.isConstant());
342     m_fastConstants.add(constant);
343 }
344 
345 bool Procedure::isFastConstant(const ValueKey&amp; constant)
346 {
347     if (!constant)
348         return false;
349     return m_fastConstants.contains(constant);
350 }
351 
<span class="line-removed">352 CCallHelpers::Label Procedure::entrypointLabel(unsigned index) const</span>
<span class="line-removed">353 {</span>
<span class="line-removed">354     return m_code-&gt;entrypointLabel(index);</span>
<span class="line-removed">355 }</span>
<span class="line-removed">356 </span>
357 void* Procedure::addDataSection(size_t size)
358 {
359     if (!size)
360         return nullptr;
361     std::unique_ptr&lt;DataSection&gt; dataSection = makeUnique&lt;DataSection&gt;(size);
362     void* result = dataSection-&gt;data();
363     m_byproducts-&gt;add(WTFMove(dataSection));
364     return result;
365 }
366 
367 unsigned Procedure::callArgAreaSizeInBytes() const
368 {
369     return code().callArgAreaSizeInBytes();
370 }
371 
372 void Procedure::requestCallArgAreaSizeInBytes(unsigned size)
373 {
374     code().requestCallArgAreaSizeInBytes(size);
375 }
376 
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (C) 2015-2020 Apple Inc. All rights reserved.</span>
  3  *
  4  * Redistribution and use in source and binary forms, with or without
  5  * modification, are permitted provided that the following conditions
  6  * are met:
  7  * 1. Redistributions of source code must retain the above copyright
  8  *    notice, this list of conditions and the following disclaimer.
  9  * 2. Redistributions in binary form must reproduce the above copyright
 10  *    notice, this list of conditions and the following disclaimer in the
 11  *    documentation and/or other materials provided with the distribution.
 12  *
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
 14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 15  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
</pre>
<hr />
<pre>
222 {
223     m_dominators = nullptr;
224     m_naturalLoops = nullptr;
225     m_backwardsCFG = nullptr;
226     m_backwardsDominators = nullptr;
227 }
228 
229 void Procedure::dump(PrintStream&amp; out) const
230 {
231     IndexSet&lt;Value*&gt; valuesInBlocks;
232     for (BasicBlock* block : *this) {
233         out.print(deepDump(*this, block));
234         valuesInBlocks.addAll(*block);
235     }
236     bool didPrint = false;
237     for (Value* value : values()) {
238         if (valuesInBlocks.contains(value))
239             continue;
240 
241         if (!didPrint) {
<span class="line-modified">242             dataLog(tierName, &quot;Orphaned values:\n&quot;);</span>
243             didPrint = true;
244         }
<span class="line-modified">245         dataLog(tierName, &quot;    &quot;, deepDump(*this, value), &quot;\n&quot;);</span>
246     }
247     if (hasQuirks())
<span class="line-modified">248         out.print(tierName, &quot;Has Quirks: True\n&quot;);</span>
249     if (variables().size()) {
<span class="line-modified">250         out.print(tierName, &quot;Variables:\n&quot;);</span>
251         for (Variable* variable : variables())
<span class="line-modified">252             out.print(tierName, &quot;    &quot;, deepDump(variable), &quot;\n&quot;);</span>
253     }
254     if (stackSlots().size()) {
<span class="line-modified">255         out.print(tierName, &quot;Stack slots:\n&quot;);</span>
256         for (StackSlot* slot : stackSlots())
<span class="line-modified">257             out.print(tierName, &quot;    &quot;, pointerDump(slot), &quot;: &quot;, deepDump(slot), &quot;\n&quot;);</span>
258     }
259     if (m_byproducts-&gt;count())
260         out.print(*m_byproducts);
261 }
262 
263 Vector&lt;BasicBlock*&gt; Procedure::blocksInPreOrder()
264 {
265     return B3::blocksInPreOrder(at(0));
266 }
267 
268 Vector&lt;BasicBlock*&gt; Procedure::blocksInPostOrder()
269 {
270     return B3::blocksInPostOrder(at(0));
271 }
272 
273 void Procedure::deleteStackSlot(StackSlot* stackSlot)
274 {
275     m_stackSlots.remove(stackSlot);
276 }
277 
</pre>
<hr />
<pre>
332 BackwardsDominators&amp; Procedure::backwardsDominators()
333 {
334     if (!m_backwardsDominators)
335         m_backwardsDominators = makeUnique&lt;BackwardsDominators&gt;(*this);
336     return *m_backwardsDominators;
337 }
338 
339 void Procedure::addFastConstant(const ValueKey&amp; constant)
340 {
341     RELEASE_ASSERT(constant.isConstant());
342     m_fastConstants.add(constant);
343 }
344 
345 bool Procedure::isFastConstant(const ValueKey&amp; constant)
346 {
347     if (!constant)
348         return false;
349     return m_fastConstants.contains(constant);
350 }
351 





352 void* Procedure::addDataSection(size_t size)
353 {
354     if (!size)
355         return nullptr;
356     std::unique_ptr&lt;DataSection&gt; dataSection = makeUnique&lt;DataSection&gt;(size);
357     void* result = dataSection-&gt;data();
358     m_byproducts-&gt;add(WTFMove(dataSection));
359     return result;
360 }
361 
362 unsigned Procedure::callArgAreaSizeInBytes() const
363 {
364     return code().callArgAreaSizeInBytes();
365 }
366 
367 void Procedure::requestCallArgAreaSizeInBytes(unsigned size)
368 {
369     code().requestCallArgAreaSizeInBytes(size);
370 }
371 
</pre>
</td>
</tr>
</table>
<center><a href="B3PatchpointSpecial.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="B3Procedure.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>