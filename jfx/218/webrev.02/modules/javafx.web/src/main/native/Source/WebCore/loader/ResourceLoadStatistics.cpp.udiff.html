<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/loader/ResourceLoadStatistics.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ResourceLoadObserver.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="ResourceLoadStatistics.h.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/loader/ResourceLoadStatistics.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -93,10 +93,11 @@</span>
      // Top frame stats
      encodeHashSet(encoder, &quot;topFrameUniqueRedirectsTo&quot;_s, &quot;domain&quot;_s, topFrameUniqueRedirectsTo);
      encodeHashSet(encoder, &quot;topFrameUniqueRedirectsFrom&quot;_s, &quot;domain&quot;_s, topFrameUniqueRedirectsFrom);
      encodeHashSet(encoder, &quot;topFrameLinkDecorationsFrom&quot;_s, &quot;domain&quot;, topFrameLinkDecorationsFrom);
      encoder.encodeBool(&quot;gotLinkDecorationFromPrevalentResource&quot;_s, gotLinkDecorationFromPrevalentResource);
<span class="udiff-line-added">+     encodeHashSet(encoder, &quot;topFrameLoadedThirdPartyScripts&quot;_s, &quot;domain&quot;, topFrameLoadedThirdPartyScripts);</span>
  
      // Subframe stats
      encodeHashSet(encoder, &quot;subframeUnderTopFrameDomains&quot;_s, &quot;domain&quot;_s, subframeUnderTopFrameDomains);
  
      // Subresource stats
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -223,10 +224,17 @@</span>
          decodeHashSet(decoder, &quot;topFrameLinkDecorationsFrom&quot;, &quot;domain&quot;, topFrameLinkDecorationsFrom);
          if (!decoder.decodeBool(&quot;gotLinkDecorationFromPrevalentResource&quot;, gotLinkDecorationFromPrevalentResource))
              return false;
      }
  
<span class="udiff-line-added">+     if (modelVersion &gt;= 17) {</span>
<span class="udiff-line-added">+         HashCountedSet&lt;RegistrableDomain&gt; topFrameLoadedThirdPartyScriptsCounted;</span>
<span class="udiff-line-added">+         decodeHashCountedSet(decoder, &quot;topFrameLoadedThirdPartyScripts&quot;, topFrameLoadedThirdPartyScriptsCounted);</span>
<span class="udiff-line-added">+         for (auto&amp; domain : topFrameLoadedThirdPartyScriptsCounted.values())</span>
<span class="udiff-line-added">+             topFrameLoadedThirdPartyScripts.add(domain);</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+ </span>
      // Subframe stats
      if (modelVersion &gt;= 15)
          decodeHashSet(decoder, &quot;subframeUnderTopFrameDomains&quot;, &quot;domain&quot;, subframeUnderTopFrameDomains);
      else if (modelVersion &gt;= 14) {
          HashCountedSet&lt;RegistrableDomain&gt; subframeUnderTopFrameDomainsCounted;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -403,25 +411,30 @@</span>
          builder.append(&#39;\n&#39;);
      }
  }
  #endif
  
<span class="udiff-line-added">+ static bool hasHadRecentUserInteraction(WTF::Seconds interactionTimeSeconds)</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     return interactionTimeSeconds &gt; Seconds(0) &amp;&amp; WallTime::now().secondsSinceEpoch() - interactionTimeSeconds &lt; 24_h;</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
  String ResourceLoadStatistics::toString() const
  {
      StringBuilder builder;
      builder.appendLiteral(&quot;Registrable domain: &quot;);
      builder.append(registrableDomain.string());
      builder.append(&#39;\n&#39;);
<span class="udiff-line-removed">-     builder.appendLiteral(&quot;    lastSeen: &quot;);</span>
<span class="udiff-line-removed">-     builder.appendFixedPrecisionNumber(lastSeen.secondsSinceEpoch().value());</span>
<span class="udiff-line-removed">-     builder.append(&#39;\n&#39;);</span>
  
      // User interaction
      appendBoolean(builder, &quot;hadUserInteraction&quot;, hadUserInteraction);
      builder.append(&#39;\n&#39;);
      builder.appendLiteral(&quot;    mostRecentUserInteraction: &quot;);
<span class="udiff-line-modified-removed">-     builder.appendFixedPrecisionNumber(mostRecentUserInteractionTime.secondsSinceEpoch().value());</span>
<span class="udiff-line-modified-added">+     if (hasHadRecentUserInteraction(mostRecentUserInteractionTime.secondsSinceEpoch()))</span>
<span class="udiff-line-added">+         builder.appendLiteral(&quot;within 24 hours&quot;);</span>
<span class="udiff-line-added">+     else</span>
<span class="udiff-line-added">+         builder.appendLiteral(&quot;-1&quot;);</span>
      builder.append(&#39;\n&#39;);
      appendBoolean(builder, &quot;grandfathered&quot;, grandfathered);
      builder.append(&#39;\n&#39;);
  
      // Storage access
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -430,10 +443,12 @@</span>
      // Top frame stats
      appendHashSet(builder, &quot;topFrameUniqueRedirectsTo&quot;, topFrameUniqueRedirectsTo);
      appendHashSet(builder, &quot;topFrameUniqueRedirectsFrom&quot;, topFrameUniqueRedirectsFrom);
      appendHashSet(builder, &quot;topFrameLinkDecorationsFrom&quot;, topFrameLinkDecorationsFrom);
      appendBoolean(builder, &quot;gotLinkDecorationFromPrevalentResource&quot;, gotLinkDecorationFromPrevalentResource);
<span class="udiff-line-added">+     builder.append(&#39;\n&#39;);</span>
<span class="udiff-line-added">+     appendHashSet(builder, &quot;topFrameLoadedThirdPartyScripts&quot;, topFrameLoadedThirdPartyScripts);</span>
  
      // Subframe stats
      appendHashSet(builder, &quot;subframeUnderTopFrameDomains&quot;, subframeUnderTopFrameDomains);
  
      // Subresource stats
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -506,10 +521,11 @@</span>
      // Top frame stats
      mergeHashSet(topFrameUniqueRedirectsTo, other.topFrameUniqueRedirectsTo);
      mergeHashSet(topFrameUniqueRedirectsFrom, other.topFrameUniqueRedirectsFrom);
      mergeHashSet(topFrameLinkDecorationsFrom, other.topFrameLinkDecorationsFrom);
      gotLinkDecorationFromPrevalentResource |= other.gotLinkDecorationFromPrevalentResource;
<span class="udiff-line-added">+     mergeHashSet(topFrameLoadedThirdPartyScripts, other.topFrameLoadedThirdPartyScripts);</span>
  
      // Subframe stats
      mergeHashSet(subframeUnderTopFrameDomains, other.subframeUnderTopFrameDomains);
  
      // Subresource stats
</pre>
<center><a href="ResourceLoadObserver.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="ResourceLoadStatistics.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>