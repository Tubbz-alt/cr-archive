<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old modules/javafx.web/src/main/native/Source/WebCore/html/LinkRelAttribute.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (C) 2011 Google Inc. All rights reserved.
  3  *
  4  * Redistribution and use in source and binary forms, with or without
  5  * modification, are permitted provided that the following conditions are
  6  * met:
  7  *
  8  *     * Redistributions of source code must retain the above copyright
  9  * notice, this list of conditions and the following disclaimer.
 10  *     * Redistributions in binary form must reproduce the above
 11  * copyright notice, this list of conditions and the following disclaimer
 12  * in the documentation and/or other materials provided with the
 13  * distribution.
 14  *     * Neither the name of Google Inc. nor the names of its
 15  * contributors may be used to endorse or promote products derived from
 16  * this software without specific prior written permission.
 17  *
 18  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 19  * &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 20  * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 21  * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 22  * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 23  * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 24  * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 25  * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 26  * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 27  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 28  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 29  *
 30  */
 31 
 32 #include &quot;config.h&quot;
 33 #include &quot;LinkRelAttribute.h&quot;
 34 
 35 #include &quot;Document.h&quot;
 36 #include &quot;LinkIconType.h&quot;
 37 #include &quot;RuntimeEnabledFeatures.h&quot;
 38 #include &quot;Settings.h&quot;
 39 #include &lt;wtf/text/StringView.h&gt;
 40 #include &lt;wtf/text/WTFString.h&gt;
 41 
 42 namespace WebCore {
 43 
 44 LinkRelAttribute::LinkRelAttribute()
 45 {
 46 }
 47 
 48 // Keep LinkRelAttribute::isSupported() in sync when updating this constructor.
 49 LinkRelAttribute::LinkRelAttribute(Document&amp; document, const String&amp; rel)
 50 {
 51     if (equalLettersIgnoringASCIICase(rel, &quot;stylesheet&quot;))
 52         isStyleSheet = true;
 53     else if (equalLettersIgnoringASCIICase(rel, &quot;icon&quot;) || equalLettersIgnoringASCIICase(rel, &quot;shortcut icon&quot;))
 54         iconType = LinkIconType::Favicon;
 55     else if (equalLettersIgnoringASCIICase(rel, &quot;apple-touch-icon&quot;))
 56         iconType = LinkIconType::TouchIcon;
 57     else if (equalLettersIgnoringASCIICase(rel, &quot;apple-touch-icon-precomposed&quot;))
 58         iconType = LinkIconType::TouchPrecomposedIcon;
 59     else if (equalLettersIgnoringASCIICase(rel, &quot;dns-prefetch&quot;))
 60         isDNSPrefetch = true;
 61     else if (document.settings().linkPreconnectEnabled() &amp;&amp; equalLettersIgnoringASCIICase(rel, &quot;preconnect&quot;))
 62         isLinkPreconnect = true;
 63     else if (RuntimeEnabledFeatures::sharedFeatures().linkPreloadEnabled() &amp;&amp; equalLettersIgnoringASCIICase(rel, &quot;preload&quot;))
 64         isLinkPreload = true;
 65     else if (RuntimeEnabledFeatures::sharedFeatures().linkPrefetchEnabled() &amp;&amp; equalLettersIgnoringASCIICase(rel, &quot;prefetch&quot;))
 66         isLinkPrefetch = true;
 67     else if (equalLettersIgnoringASCIICase(rel, &quot;alternate stylesheet&quot;) || equalLettersIgnoringASCIICase(rel, &quot;stylesheet alternate&quot;)) {
 68         isStyleSheet = true;
 69         isAlternate = true;
 70 #if ENABLE(APPLICATION_MANIFEST)
 71     } else if (equalLettersIgnoringASCIICase(rel, &quot;manifest&quot;)) {
 72         isApplicationManifest = true;
 73 #endif
 74     } else {
 75         // Tokenize the rel attribute and set bits based on specific keywords that we find.
 76         String relCopy = rel;
 77         relCopy.replace(&#39;\n&#39;, &#39; &#39;);
 78         for (auto word : StringView(relCopy).split(&#39; &#39;)) {
 79             if (equalLettersIgnoringASCIICase(word, &quot;stylesheet&quot;))
 80                 isStyleSheet = true;
 81             else if (equalLettersIgnoringASCIICase(word, &quot;alternate&quot;))
 82                 isAlternate = true;
 83             else if (equalLettersIgnoringASCIICase(word, &quot;icon&quot;))
 84                 iconType = LinkIconType::Favicon;
 85             else if (equalLettersIgnoringASCIICase(word, &quot;apple-touch-icon&quot;))
 86                 iconType = LinkIconType::TouchIcon;
 87             else if (equalLettersIgnoringASCIICase(word, &quot;apple-touch-icon-precomposed&quot;))
 88                 iconType = LinkIconType::TouchPrecomposedIcon;
 89         }
 90     }
 91 }
 92 
 93 // https://html.spec.whatwg.org/#linkTypes
 94 bool LinkRelAttribute::isSupported(Document&amp; document, StringView attribute)
 95 {
 96     static const char* const supportedAttributes[] = {
 97         &quot;alternate&quot;, &quot;dns-prefetch&quot;, &quot;icon&quot;, &quot;stylesheet&quot;, &quot;apple-touch-icon&quot;, &quot;apple-touch-icon-precomposed&quot;,
 98 #if ENABLE(APPLICATION_MANIFEST)
 99         &quot;manifest&quot;,
100 #endif
101     };
102 
103     for (auto* supportedAttribute : supportedAttributes) {
104         if (equalIgnoringASCIICase(attribute, supportedAttribute))
105             return true;
106     }
107 
108     if (document.settings().linkPreconnectEnabled() &amp;&amp; equalIgnoringASCIICase(attribute, &quot;preconnect&quot;))
109         return true;
110 
111     if (RuntimeEnabledFeatures::sharedFeatures().linkPreloadEnabled() &amp;&amp; equalIgnoringASCIICase(attribute, &quot;preload&quot;))
112         return true;
113 
114     if (RuntimeEnabledFeatures::sharedFeatures().linkPrefetchEnabled() &amp;&amp; equalIgnoringASCIICase(attribute, &quot;prefetch&quot;))
115         return true;
116 
117     return false;
118 }
119 
120 }
    </pre>
  </body>
</html>