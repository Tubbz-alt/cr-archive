<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/JavaScriptCore/ftl/FTLAbstractHeapRepository.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (C) 2013-2018 Apple Inc. All rights reserved.
  3  *
  4  * Redistribution and use in source and binary forms, with or without
  5  * modification, are permitted provided that the following conditions
  6  * are met:
  7  * 1. Redistributions of source code must retain the above copyright
  8  *    notice, this list of conditions and the following disclaimer.
  9  * 2. Redistributions in binary form must reproduce the above copyright
 10  *    notice, this list of conditions and the following disclaimer in the
 11  *    documentation and/or other materials provided with the distribution.
 12  *
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
 14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 15  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #if ENABLE(FTL_JIT)
 29 
 30 #include &quot;B3Value.h&quot;
 31 #include &quot;DFGArrayMode.h&quot;
 32 #include &quot;FTLAbstractHeap.h&quot;
 33 #include &quot;HasOwnPropertyCache.h&quot;
 34 #include &quot;IndexingType.h&quot;
<a name="1" id="anc1"></a>
 35 #include &quot;JSGlobalObject.h&quot;
 36 #include &quot;JSMap.h&quot;
 37 #include &quot;JSSet.h&quot;
 38 #include &quot;JSWeakMap.h&quot;
 39 #include &quot;Symbol.h&quot;
 40 
 41 namespace JSC { namespace FTL {
 42 
 43 #define FOR_EACH_ABSTRACT_HEAP(macro) \
 44     macro(typedArrayProperties)
 45 
 46 #define FOR_EACH_ABSTRACT_FIELD(macro) \
 47     macro(ArrayBuffer_data, ArrayBuffer::offsetOfData()) \
 48     macro(ArrayStorage_numValuesInVector, ArrayStorage::numValuesInVectorOffset()) \
 49     macro(Butterfly_arrayBuffer, Butterfly::offsetOfArrayBuffer()) \
 50     macro(Butterfly_publicLength, Butterfly::offsetOfPublicLength()) \
 51     macro(Butterfly_vectorLength, Butterfly::offsetOfVectorLength()) \
 52     macro(CallFrame_callerFrame, CallFrame::callerFrameOffset()) \
 53     macro(ClassInfo_parentClass, ClassInfo::offsetOfParentClass()) \
<a name="2" id="anc2"></a><span class="line-added"> 54     macro(DateInstance_internalNumber, DateInstance::offsetOfInternalNumber()) \</span>
<span class="line-added"> 55     macro(DateInstance_data, DateInstance::offsetOfData()) \</span>
<span class="line-added"> 56     macro(DateInstanceData_gregorianDateTimeCachedForMS, DateInstanceData::offsetOfGregorianDateTimeCachedForMS()) \</span>
<span class="line-added"> 57     macro(DateInstanceData_gregorianDateTimeUTCCachedForMS, DateInstanceData::offsetOfGregorianDateTimeUTCCachedForMS()) \</span>
<span class="line-added"> 58     macro(DateInstanceData_cachedGregorianDateTime_year, DateInstanceData::offsetOfCachedGregorianDateTime() + GregorianDateTime::offsetOfYear()) \</span>
<span class="line-added"> 59     macro(DateInstanceData_cachedGregorianDateTimeUTC_year, DateInstanceData::offsetOfCachedGregorianDateTimeUTC() + GregorianDateTime::offsetOfYear()) \</span>
<span class="line-added"> 60     macro(DateInstanceData_cachedGregorianDateTime_month, DateInstanceData::offsetOfCachedGregorianDateTime() + GregorianDateTime::offsetOfMonth()) \</span>
<span class="line-added"> 61     macro(DateInstanceData_cachedGregorianDateTimeUTC_month, DateInstanceData::offsetOfCachedGregorianDateTimeUTC() + GregorianDateTime::offsetOfMonth()) \</span>
<span class="line-added"> 62     macro(DateInstanceData_cachedGregorianDateTime_monthDay, DateInstanceData::offsetOfCachedGregorianDateTime() + GregorianDateTime::offsetOfMonthDay()) \</span>
<span class="line-added"> 63     macro(DateInstanceData_cachedGregorianDateTimeUTC_monthDay, DateInstanceData::offsetOfCachedGregorianDateTimeUTC() + GregorianDateTime::offsetOfMonthDay()) \</span>
<span class="line-added"> 64     macro(DateInstanceData_cachedGregorianDateTime_weekDay, DateInstanceData::offsetOfCachedGregorianDateTime() + GregorianDateTime::offsetOfWeekDay()) \</span>
<span class="line-added"> 65     macro(DateInstanceData_cachedGregorianDateTimeUTC_weekDay, DateInstanceData::offsetOfCachedGregorianDateTimeUTC() + GregorianDateTime::offsetOfWeekDay()) \</span>
<span class="line-added"> 66     macro(DateInstanceData_cachedGregorianDateTime_hour, DateInstanceData::offsetOfCachedGregorianDateTime() + GregorianDateTime::offsetOfHour()) \</span>
<span class="line-added"> 67     macro(DateInstanceData_cachedGregorianDateTimeUTC_hour, DateInstanceData::offsetOfCachedGregorianDateTimeUTC() + GregorianDateTime::offsetOfHour()) \</span>
<span class="line-added"> 68     macro(DateInstanceData_cachedGregorianDateTime_minute, DateInstanceData::offsetOfCachedGregorianDateTime() + GregorianDateTime::offsetOfMinute()) \</span>
<span class="line-added"> 69     macro(DateInstanceData_cachedGregorianDateTimeUTC_minute, DateInstanceData::offsetOfCachedGregorianDateTimeUTC() + GregorianDateTime::offsetOfMinute()) \</span>
<span class="line-added"> 70     macro(DateInstanceData_cachedGregorianDateTime_second, DateInstanceData::offsetOfCachedGregorianDateTime() + GregorianDateTime::offsetOfSecond()) \</span>
<span class="line-added"> 71     macro(DateInstanceData_cachedGregorianDateTimeUTC_second, DateInstanceData::offsetOfCachedGregorianDateTimeUTC() + GregorianDateTime::offsetOfSecond()) \</span>
<span class="line-added"> 72     macro(DateInstanceData_cachedGregorianDateTime_utcOffsetInMinute, DateInstanceData::offsetOfCachedGregorianDateTime() + GregorianDateTime::offsetOfUTCOffsetInMinute()) \</span>
<span class="line-added"> 73     macro(DateInstanceData_cachedGregorianDateTimeUTC_utcOffsetInMinute, DateInstanceData::offsetOfCachedGregorianDateTimeUTC() + GregorianDateTime::offsetOfUTCOffsetInMinute()) \</span>
 74     macro(DirectArguments_callee, DirectArguments::offsetOfCallee()) \
 75     macro(DirectArguments_length, DirectArguments::offsetOfLength()) \
 76     macro(DirectArguments_minCapacity, DirectArguments::offsetOfMinCapacity()) \
 77     macro(DirectArguments_mappedArguments, DirectArguments::offsetOfMappedArguments()) \
 78     macro(DirectArguments_modifiedArgumentsDescriptor, DirectArguments::offsetOfModifiedArgumentsDescriptor()) \
 79     macro(FunctionRareData_allocator, FunctionRareData::offsetOfObjectAllocationProfile() + ObjectAllocationProfileWithPrototype::offsetOfAllocator()) \
 80     macro(FunctionRareData_structure, FunctionRareData::offsetOfObjectAllocationProfile() + ObjectAllocationProfileWithPrototype::offsetOfStructure()) \
 81     macro(FunctionRareData_prototype, FunctionRareData::offsetOfObjectAllocationProfile() + ObjectAllocationProfileWithPrototype::offsetOfPrototype()) \
<a name="3" id="anc3"></a><span class="line-modified"> 82     macro(FunctionRareData_allocationProfileWatchpointSet, FunctionRareData::offsetOfAllocationProfileWatchpointSet()) \</span>
<span class="line-added"> 83     macro(FunctionRareData_executable, FunctionRareData::offsetOfExecutable()) \</span>
 84     macro(FunctionRareData_internalFunctionAllocationProfile_structure, FunctionRareData::offsetOfInternalFunctionAllocationProfile() + InternalFunctionAllocationProfile::offsetOfStructure()) \
 85     macro(FunctionRareData_boundFunctionStructure, FunctionRareData::offsetOfBoundFunctionStructure()) \
 86     macro(FunctionRareData_allocationProfileClearingWatchpoint, FunctionRareData::offsetOfAllocationProfileClearingWatchpoint()) \
<a name="4" id="anc4"></a>

 87     macro(GetterSetter_getter, GetterSetter::offsetOfGetter()) \
 88     macro(GetterSetter_setter, GetterSetter::offsetOfSetter()) \
 89     macro(JSArrayBufferView_length, JSArrayBufferView::offsetOfLength()) \
 90     macro(JSArrayBufferView_mode, JSArrayBufferView::offsetOfMode()) \
 91     macro(JSArrayBufferView_vector, JSArrayBufferView::offsetOfVector()) \
 92     macro(JSBigInt_length, JSBigInt::offsetOfLength()) \
 93     macro(JSCell_cellState, JSCell::cellStateOffset()) \
 94     macro(JSCell_header, 0) \
 95     macro(JSCell_indexingTypeAndMisc, JSCell::indexingTypeAndMiscOffset()) \
 96     macro(JSCell_structureID, JSCell::structureIDOffset()) \
 97     macro(JSCell_typeInfoFlags, JSCell::typeInfoFlagsOffset()) \
 98     macro(JSCell_typeInfoType, JSCell::typeInfoTypeOffset()) \
 99     macro(JSCell_usefulBytes, JSCell::indexingTypeAndMiscOffset()) \
100     macro(JSDestructibleObject_classInfo, JSDestructibleObject::classInfoOffset()) \
<a name="5" id="anc5"></a><span class="line-modified">101     macro(JSFunction_executableOrRareData, JSFunction::offsetOfExecutableOrRareData()) \</span>
102     macro(JSFunction_scope, JSFunction::offsetOfScopeChain()) \
<a name="6" id="anc6"></a>
103     macro(JSGlobalObject_regExpGlobalData_cachedResult_lastRegExp, JSGlobalObject::regExpGlobalDataOffset() + RegExpGlobalData::offsetOfCachedResult() + RegExpCachedResult::offsetOfLastRegExp()) \
104     macro(JSGlobalObject_regExpGlobalData_cachedResult_lastInput, JSGlobalObject::regExpGlobalDataOffset() + RegExpGlobalData::offsetOfCachedResult() + RegExpCachedResult::offsetOfLastInput()) \
105     macro(JSGlobalObject_regExpGlobalData_cachedResult_result_start, JSGlobalObject::regExpGlobalDataOffset() + RegExpGlobalData::offsetOfCachedResult() + RegExpCachedResult::offsetOfResult() + OBJECT_OFFSETOF(MatchResult, start)) \
106     macro(JSGlobalObject_regExpGlobalData_cachedResult_result_end, JSGlobalObject::regExpGlobalDataOffset() + RegExpGlobalData::offsetOfCachedResult() + RegExpCachedResult::offsetOfResult() + OBJECT_OFFSETOF(MatchResult, end)) \
107     macro(JSGlobalObject_regExpGlobalData_cachedResult_reified, JSGlobalObject::regExpGlobalDataOffset() + RegExpGlobalData::offsetOfCachedResult() + RegExpCachedResult::offsetOfReified()) \
108     macro(JSObject_butterfly, JSObject::butterflyOffset()) \
109     macro(JSPropertyNameEnumerator_cachedInlineCapacity, JSPropertyNameEnumerator::cachedInlineCapacityOffset()) \
110     macro(JSPropertyNameEnumerator_cachedPropertyNamesVector, JSPropertyNameEnumerator::cachedPropertyNamesVectorOffset()) \
111     macro(JSPropertyNameEnumerator_cachedStructureID, JSPropertyNameEnumerator::cachedStructureIDOffset()) \
112     macro(JSPropertyNameEnumerator_endGenericPropertyIndex, JSPropertyNameEnumerator::endGenericPropertyIndexOffset()) \
113     macro(JSPropertyNameEnumerator_endStructurePropertyIndex, JSPropertyNameEnumerator::endStructurePropertyIndexOffset()) \
114     macro(JSPropertyNameEnumerator_indexLength, JSPropertyNameEnumerator::indexedLengthOffset()) \
115     macro(JSRopeString_flags, JSRopeString::offsetOfFlags()) \
116     macro(JSRopeString_length, JSRopeString::offsetOfLength()) \
117     macro(JSRopeString_fiber0, JSRopeString::offsetOfFiber0()) \
118     macro(JSRopeString_fiber1, JSRopeString::offsetOfFiber1()) \
119     macro(JSRopeString_fiber2, JSRopeString::offsetOfFiber2()) \
120     macro(JSScope_next, JSScope::offsetOfNext()) \
121     macro(JSSymbolTableObject_symbolTable, JSSymbolTableObject::offsetOfSymbolTable()) \
122     macro(JSWrapperObject_internalValue, JSWrapperObject::internalValueOffset()) \
123     macro(RegExpObject_regExpAndLastIndexIsNotWritableFlag, RegExpObject::offsetOfRegExpAndLastIndexIsNotWritableFlag()) \
124     macro(RegExpObject_lastIndex, RegExpObject::offsetOfLastIndex()) \
125     macro(ShadowChicken_Packet_callee, OBJECT_OFFSETOF(ShadowChicken::Packet, callee)) \
126     macro(ShadowChicken_Packet_frame, OBJECT_OFFSETOF(ShadowChicken::Packet, frame)) \
127     macro(ShadowChicken_Packet_callerFrame, OBJECT_OFFSETOF(ShadowChicken::Packet, callerFrame)) \
128     macro(ShadowChicken_Packet_thisValue, OBJECT_OFFSETOF(ShadowChicken::Packet, thisValue)) \
129     macro(ShadowChicken_Packet_scope, OBJECT_OFFSETOF(ShadowChicken::Packet, scope)) \
130     macro(ShadowChicken_Packet_codeBlock, OBJECT_OFFSETOF(ShadowChicken::Packet, codeBlock)) \
131     macro(ShadowChicken_Packet_callSiteIndex, OBJECT_OFFSETOF(ShadowChicken::Packet, callSiteIndex)) \
<a name="7" id="anc7"></a><span class="line-modified">132     macro(ScopedArguments_overrodeThings, ScopedArguments::offsetOfOverrodeThings()) \</span>


133     macro(ScopedArguments_scope, ScopedArguments::offsetOfScope()) \
<a name="8" id="anc8"></a><span class="line-added">134     macro(ScopedArguments_storage, ScopedArguments::offsetOfStorage()) \</span>
135     macro(ScopedArguments_table, ScopedArguments::offsetOfTable()) \
<a name="9" id="anc9"></a><span class="line-added">136     macro(ScopedArguments_totalLength, ScopedArguments::offsetOfTotalLength()) \</span>
137     macro(ScopedArgumentsTable_arguments, ScopedArgumentsTable::offsetOfArguments()) \
138     macro(ScopedArgumentsTable_length, ScopedArgumentsTable::offsetOfLength()) \
139     macro(StringImpl_data, StringImpl::dataOffset()) \
140     macro(StringImpl_hashAndFlags, StringImpl::flagsOffset()) \
141     macro(StringImpl_length, StringImpl::lengthMemoryOffset()) \
142     macro(Structure_classInfo, Structure::classInfoOffset()) \
143     macro(Structure_globalObject, Structure::globalObjectOffset()) \
144     macro(Structure_indexingModeIncludingHistory, Structure::indexingModeIncludingHistoryOffset()) \
145     macro(Structure_inlineCapacity, Structure::inlineCapacityOffset()) \
146     macro(Structure_previousOrRareData, Structure::previousOrRareDataOffset()) \
147     macro(Structure_prototype, Structure::prototypeOffset()) \
148     macro(Structure_structureID, Structure::structureIDOffset()) \
149     macro(StructureRareData_cachedOwnKeys, StructureRareData::offsetOfCachedOwnKeys()) \
150     macro(HashMapImpl_capacity, HashMapImpl&lt;HashMapBucket&lt;HashMapBucketDataKey&gt;&gt;::offsetOfCapacity()) \
151     macro(HashMapImpl_buffer,  HashMapImpl&lt;HashMapBucket&lt;HashMapBucketDataKey&gt;&gt;::offsetOfBuffer()) \
152     macro(HashMapImpl_head,  HashMapImpl&lt;HashMapBucket&lt;HashMapBucketDataKey&gt;&gt;::offsetOfHead()) \
153     macro(HashMapBucket_value, HashMapBucket&lt;HashMapBucketDataKeyValue&gt;::offsetOfValue()) \
154     macro(HashMapBucket_key, HashMapBucket&lt;HashMapBucketDataKeyValue&gt;::offsetOfKey()) \
155     macro(HashMapBucket_next, HashMapBucket&lt;HashMapBucketDataKeyValue&gt;::offsetOfNext()) \
156     macro(WeakMapImpl_capacity, WeakMapImpl&lt;WeakMapBucket&lt;WeakMapBucketDataKey&gt;&gt;::offsetOfCapacity()) \
157     macro(WeakMapImpl_buffer,  WeakMapImpl&lt;WeakMapBucket&lt;WeakMapBucketDataKey&gt;&gt;::offsetOfBuffer()) \
158     macro(WeakMapBucket_value, WeakMapBucket&lt;WeakMapBucketDataKeyValue&gt;::offsetOfValue()) \
159     macro(WeakMapBucket_key, WeakMapBucket&lt;WeakMapBucketDataKeyValue&gt;::offsetOfKey()) \
160     macro(Symbol_symbolImpl, Symbol::offsetOfSymbolImpl()) \
<a name="10" id="anc10"></a>
161 
162 #define FOR_EACH_INDEXED_ABSTRACT_HEAP(macro) \
163     macro(ArrayStorage_vector, ArrayStorage::vectorOffset(), sizeof(WriteBarrier&lt;Unknown&gt;)) \
164     macro(CompleteSubspace_allocatorForSizeStep, CompleteSubspace::offsetOfAllocatorForSizeStep(), sizeof(Allocator)) \
165     macro(DirectArguments_storage, DirectArguments::storageOffset(), sizeof(EncodedJSValue)) \
166     macro(JSLexicalEnvironment_variables, JSLexicalEnvironment::offsetOfVariables(), sizeof(EncodedJSValue)) \
167     macro(JSPropertyNameEnumerator_cachedPropertyNamesVectorContents, 0, sizeof(WriteBarrier&lt;JSString&gt;)) \
<a name="11" id="anc11"></a><span class="line-added">168     macro(JSInternalFieldObjectImpl_internalFields, JSInternalFieldObjectImpl&lt;&gt;::offsetOfInternalFields(), sizeof(WriteBarrier&lt;Unknown&gt;)) \</span>
169     macro(ScopedArguments_Storage_storage, 0, sizeof(EncodedJSValue)) \
170     macro(WriteBarrierBuffer_bufferContents, 0, sizeof(JSCell*)) \
171     macro(characters8, 0, sizeof(LChar)) \
172     macro(characters16, 0, sizeof(UChar)) \
173     macro(indexedInt32Properties, 0, sizeof(EncodedJSValue)) \
174     macro(indexedDoubleProperties, 0, sizeof(double)) \
175     macro(indexedContiguousProperties, 0, sizeof(EncodedJSValue)) \
176     macro(scopedArgumentsTableArguments, 0, sizeof(int32_t)) \
177     macro(singleCharacterStrings, 0, sizeof(JSString*)) \
178     macro(structureTable, 0, sizeof(Structure*)) \
179     macro(variables, 0, sizeof(Register)) \
180     macro(HasOwnPropertyCache, 0, sizeof(HasOwnPropertyCache::Entry)) \
<a name="12" id="anc12"></a>
181 
182 #define FOR_EACH_NUMBERED_ABSTRACT_HEAP(macro) \
183     macro(properties)
184 
185 // This class is meant to be cacheable between compilations, but it doesn&#39;t have to be.
186 // Doing so saves on creation of nodes. But clearing it will save memory.
187 
188 class AbstractHeapRepository {
189     WTF_MAKE_NONCOPYABLE(AbstractHeapRepository);
190 public:
191     AbstractHeapRepository();
192     ~AbstractHeapRepository();
193 
194     AbstractHeap root;
195 
196 #define ABSTRACT_HEAP_DECLARATION(name) AbstractHeap name;
197     FOR_EACH_ABSTRACT_HEAP(ABSTRACT_HEAP_DECLARATION)
198 #undef ABSTRACT_HEAP_DECLARATION
199 
200 #define ABSTRACT_FIELD_DECLARATION(name, offset) AbstractHeap name;
201     FOR_EACH_ABSTRACT_FIELD(ABSTRACT_FIELD_DECLARATION)
202 #undef ABSTRACT_FIELD_DECLARATION
203 
204     AbstractHeap&amp; JSCell_freeListNext;
205     AbstractHeap&amp; ArrayStorage_publicLength;
206     AbstractHeap&amp; ArrayStorage_vectorLength;
207 
208 #define INDEXED_ABSTRACT_HEAP_DECLARATION(name, offset, size) IndexedAbstractHeap name;
209     FOR_EACH_INDEXED_ABSTRACT_HEAP(INDEXED_ABSTRACT_HEAP_DECLARATION)
210 #undef INDEXED_ABSTRACT_HEAP_DECLARATION
211 
212 #define NUMBERED_ABSTRACT_HEAP_DECLARATION(name) NumberedAbstractHeap name;
213     FOR_EACH_NUMBERED_ABSTRACT_HEAP(NUMBERED_ABSTRACT_HEAP_DECLARATION)
214 #undef NUMBERED_ABSTRACT_HEAP_DECLARATION
215 
216     AbstractHeap&amp; JSString_value;
217 
218     AbsoluteAbstractHeap absolute;
219 
220     IndexedAbstractHeap* forIndexingType(IndexingType indexingType)
221     {
222         switch (indexingType) {
223         case ALL_BLANK_INDEXING_TYPES:
224         case ALL_UNDECIDED_INDEXING_TYPES:
225             return 0;
226 
227         case ALL_INT32_INDEXING_TYPES:
228             return &amp;indexedInt32Properties;
229 
230         case ALL_DOUBLE_INDEXING_TYPES:
231             return &amp;indexedDoubleProperties;
232 
233         case ALL_CONTIGUOUS_INDEXING_TYPES:
234             return &amp;indexedContiguousProperties;
235 
236         case ALL_ARRAY_STORAGE_INDEXING_TYPES:
237             return &amp;ArrayStorage_vector;
238 
239         default:
240             RELEASE_ASSERT_NOT_REACHED();
241             return 0;
242         }
243     }
244 
245     IndexedAbstractHeap&amp; forArrayType(DFG::Array::Type type)
246     {
247         switch (type) {
248         case DFG::Array::Int32:
249             return indexedInt32Properties;
250         case DFG::Array::Double:
251             return indexedDoubleProperties;
252         case DFG::Array::Contiguous:
253             return indexedContiguousProperties;
254         case DFG::Array::ArrayStorage:
255         case DFG::Array::SlowPutArrayStorage:
256             return ArrayStorage_vector;
257         default:
258             RELEASE_ASSERT_NOT_REACHED();
259             return indexedInt32Properties;
260         }
261     }
262 
263     void decorateMemory(const AbstractHeap*, B3::Value*);
264     void decorateCCallRead(const AbstractHeap*, B3::Value*);
265     void decorateCCallWrite(const AbstractHeap*, B3::Value*);
266     void decoratePatchpointRead(const AbstractHeap*, B3::Value*);
267     void decoratePatchpointWrite(const AbstractHeap*, B3::Value*);
268     void decorateFenceRead(const AbstractHeap*, B3::Value*);
269     void decorateFenceWrite(const AbstractHeap*, B3::Value*);
270     void decorateFencedAccess(const AbstractHeap*, B3::Value*);
271 
272     void computeRangesAndDecorateInstructions();
273 
274 private:
275 
276     struct HeapForValue {
277         HeapForValue()
278         {
279         }
280 
281         HeapForValue(const AbstractHeap* heap, B3::Value* value)
282             : heap(heap)
283             , value(value)
284         {
285         }
286 
287         const AbstractHeap* heap { nullptr };
288         B3::Value* value { nullptr };
289     };
290 
291     Vector&lt;HeapForValue&gt; m_heapForMemory;
292     Vector&lt;HeapForValue&gt; m_heapForCCallRead;
293     Vector&lt;HeapForValue&gt; m_heapForCCallWrite;
294     Vector&lt;HeapForValue&gt; m_heapForPatchpointRead;
295     Vector&lt;HeapForValue&gt; m_heapForPatchpointWrite;
296     Vector&lt;HeapForValue&gt; m_heapForFenceRead;
297     Vector&lt;HeapForValue&gt; m_heapForFenceWrite;
298     Vector&lt;HeapForValue&gt; m_heapForFencedAccess;
299 };
300 
301 } } // namespace JSC::FTL
302 
303 #endif // ENABLE(FTL_JIT)
<a name="13" id="anc13"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="13" type="hidden" />
</body>
</html>