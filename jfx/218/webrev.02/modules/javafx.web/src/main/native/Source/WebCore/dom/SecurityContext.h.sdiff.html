<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/dom/SecurityContext.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="SecurityContext.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SecurityPolicyViolationEvent.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/dom/SecurityContext.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 60 
 61 typedef int SandboxFlags;
 62 
 63 class SecurityContext {
 64 public:
 65     SandboxFlags sandboxFlags() const { return m_sandboxFlags; }
 66     ContentSecurityPolicy* contentSecurityPolicy() { return m_contentSecurityPolicy.get(); }
 67 
 68     bool isSecureTransitionTo(const URL&amp;) const;
 69 
 70     void enforceSandboxFlags(SandboxFlags mask);
 71     bool isSandboxed(SandboxFlags mask) const { return m_sandboxFlags &amp; mask; }
 72 
 73     SecurityOriginPolicy* securityOriginPolicy() const { return m_securityOriginPolicy.get(); }
 74 
 75     // Explicitly override the security origin for this security context.
 76     // Note: It is dangerous to change the security origin of a script context
 77     //       that already contains content.
 78     void setSecurityOriginPolicy(RefPtr&lt;SecurityOriginPolicy&gt;&amp;&amp;);
 79 





 80     WEBCORE_EXPORT SecurityOrigin* securityOrigin() const;
 81 
 82     static SandboxFlags parseSandboxPolicy(const String&amp; policy, String&amp; invalidTokensErrorMessage);
 83     static bool isSupportedSandboxPolicy(StringView);
 84 
 85     enum MixedContentType {
 86         Inactive = 1 &lt;&lt; 0,
 87         Active = 1 &lt;&lt; 1,
 88     };
 89 
 90     const OptionSet&lt;MixedContentType&gt;&amp; foundMixedContent() const { return m_mixedContentTypes; }
 91     void setFoundMixedContent(MixedContentType type) { m_mixedContentTypes.add(type); }
 92     bool geolocationAccessed() const { return m_geolocationAccessed; }
 93     void setGeolocationAccessed() { m_geolocationAccessed = true; }
 94     bool secureCookiesAccessed() const { return m_secureCookiesAccessed; }
 95     void setSecureCookiesAccessed() { m_secureCookiesAccessed = true; }
 96 
 97     bool isStrictMixedContentMode() const { return m_isStrictMixedContentMode; }
 98     void setStrictMixedContentMode(bool strictMixedContentMode) { m_isStrictMixedContentMode = strictMixedContentMode; }
 99 
100     // This method implements the &quot;Is the environment settings object settings a secure context?&quot; algorithm from
101     // the Secure Context spec: https://w3c.github.io/webappsec-secure-contexts/#settings-object (Editor&#39;s Draft, 17 November 2016)
102     virtual bool isSecureContext() const = 0;
103 
104 protected:
105     SecurityContext();
106     virtual ~SecurityContext();
107 
<span class="line-removed">108     void setContentSecurityPolicy(std::unique_ptr&lt;ContentSecurityPolicy&gt;);</span>
<span class="line-removed">109 </span>
110     // It&#39;s only appropriate to call this during security context initialization; it&#39;s needed for
111     // flags that can&#39;t be disabled with allow-* attributes, such as SandboxNavigation.
112     void disableSandboxFlags(SandboxFlags mask) { m_sandboxFlags &amp;= ~mask; }
113 
114     void didFailToInitializeSecurityOrigin() { m_haveInitializedSecurityOrigin = false; }
115     bool haveInitializedSecurityOrigin() const { return m_haveInitializedSecurityOrigin; }
116 
117 private:
118     RefPtr&lt;SecurityOriginPolicy&gt; m_securityOriginPolicy;
119     std::unique_ptr&lt;ContentSecurityPolicy&gt; m_contentSecurityPolicy;
120     SandboxFlags m_sandboxFlags { SandboxNone };
121     OptionSet&lt;MixedContentType&gt; m_mixedContentTypes;
122     bool m_haveInitializedSecurityOrigin { false };
123     bool m_geolocationAccessed { false };
124     bool m_secureCookiesAccessed { false };
125     bool m_isStrictMixedContentMode { false };
126 };
127 
128 } // namespace WebCore
</pre>
</td>
<td>
<hr />
<pre>
 60 
 61 typedef int SandboxFlags;
 62 
 63 class SecurityContext {
 64 public:
 65     SandboxFlags sandboxFlags() const { return m_sandboxFlags; }
 66     ContentSecurityPolicy* contentSecurityPolicy() { return m_contentSecurityPolicy.get(); }
 67 
 68     bool isSecureTransitionTo(const URL&amp;) const;
 69 
 70     void enforceSandboxFlags(SandboxFlags mask);
 71     bool isSandboxed(SandboxFlags mask) const { return m_sandboxFlags &amp; mask; }
 72 
 73     SecurityOriginPolicy* securityOriginPolicy() const { return m_securityOriginPolicy.get(); }
 74 
 75     // Explicitly override the security origin for this security context.
 76     // Note: It is dangerous to change the security origin of a script context
 77     //       that already contains content.
 78     void setSecurityOriginPolicy(RefPtr&lt;SecurityOriginPolicy&gt;&amp;&amp;);
 79 
<span class="line-added"> 80     // Explicitly override the content security policy for this security context.</span>
<span class="line-added"> 81     // Note: It is dangerous to change the content security policy of a script</span>
<span class="line-added"> 82     //       context that already contains content.</span>
<span class="line-added"> 83     void setContentSecurityPolicy(std::unique_ptr&lt;ContentSecurityPolicy&gt;&amp;&amp;);</span>
<span class="line-added"> 84 </span>
 85     WEBCORE_EXPORT SecurityOrigin* securityOrigin() const;
 86 
 87     static SandboxFlags parseSandboxPolicy(const String&amp; policy, String&amp; invalidTokensErrorMessage);
 88     static bool isSupportedSandboxPolicy(StringView);
 89 
 90     enum MixedContentType {
 91         Inactive = 1 &lt;&lt; 0,
 92         Active = 1 &lt;&lt; 1,
 93     };
 94 
 95     const OptionSet&lt;MixedContentType&gt;&amp; foundMixedContent() const { return m_mixedContentTypes; }
 96     void setFoundMixedContent(MixedContentType type) { m_mixedContentTypes.add(type); }
 97     bool geolocationAccessed() const { return m_geolocationAccessed; }
 98     void setGeolocationAccessed() { m_geolocationAccessed = true; }
 99     bool secureCookiesAccessed() const { return m_secureCookiesAccessed; }
100     void setSecureCookiesAccessed() { m_secureCookiesAccessed = true; }
101 
102     bool isStrictMixedContentMode() const { return m_isStrictMixedContentMode; }
103     void setStrictMixedContentMode(bool strictMixedContentMode) { m_isStrictMixedContentMode = strictMixedContentMode; }
104 
105     // This method implements the &quot;Is the environment settings object settings a secure context?&quot; algorithm from
106     // the Secure Context spec: https://w3c.github.io/webappsec-secure-contexts/#settings-object (Editor&#39;s Draft, 17 November 2016)
107     virtual bool isSecureContext() const = 0;
108 
109 protected:
110     SecurityContext();
111     virtual ~SecurityContext();
112 


113     // It&#39;s only appropriate to call this during security context initialization; it&#39;s needed for
114     // flags that can&#39;t be disabled with allow-* attributes, such as SandboxNavigation.
115     void disableSandboxFlags(SandboxFlags mask) { m_sandboxFlags &amp;= ~mask; }
116 
117     void didFailToInitializeSecurityOrigin() { m_haveInitializedSecurityOrigin = false; }
118     bool haveInitializedSecurityOrigin() const { return m_haveInitializedSecurityOrigin; }
119 
120 private:
121     RefPtr&lt;SecurityOriginPolicy&gt; m_securityOriginPolicy;
122     std::unique_ptr&lt;ContentSecurityPolicy&gt; m_contentSecurityPolicy;
123     SandboxFlags m_sandboxFlags { SandboxNone };
124     OptionSet&lt;MixedContentType&gt; m_mixedContentTypes;
125     bool m_haveInitializedSecurityOrigin { false };
126     bool m_geolocationAccessed { false };
127     bool m_secureCookiesAccessed { false };
128     bool m_isStrictMixedContentMode { false };
129 };
130 
131 } // namespace WebCore
</pre>
</td>
</tr>
</table>
<center><a href="SecurityContext.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SecurityPolicyViolationEvent.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>