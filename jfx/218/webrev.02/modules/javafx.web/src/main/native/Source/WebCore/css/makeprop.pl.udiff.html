<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/css/makeprop.pl</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="html.css.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="parser/CSSParser.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/css/makeprop.pl</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -64,11 +64,11 @@</span>
  my $numPredefinedProperties = 2;
  my %nameIsInherited;
  my %nameIsHighPriority;
  my %propertiesWithStyleBuilderOptions;
  my %styleBuilderOptions = (
<span class="udiff-line-modified-removed">-     &quot;animatable&quot; =&gt; 1, # Defined in Source/WebCore/css/StyleBuilderConverter.h</span>
<span class="udiff-line-modified-added">+     &quot;animatable&quot; =&gt; 1, # Defined in Source/WebCore/style/StyleBuilderConverter.h</span>
      &quot;auto-functions&quot; =&gt; 1,
      &quot;conditional-converter&quot; =&gt; 1,
      &quot;converter&quot; =&gt; 1,
      &quot;custom&quot; =&gt; 1,
      &quot;fill-layer-property&quot; =&gt; 1,
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -478,11 +478,52 @@</span>
  print HEADER &quot;};\n\n&quot;;
  print HEADER &quot;const int firstCSSProperty = $first;\n&quot;;
  print HEADER &quot;const int numCSSProperties = $num;\n&quot;;
  print HEADER &quot;const int lastCSSProperty = $last;\n&quot;;
  print HEADER &quot;const size_t maxCSSPropertyNameLength = $maxLen;\n&quot;;
<span class="udiff-line-modified-removed">- print HEADER &quot;const CSSPropertyID lastHighPriorityProperty = CSSProperty&quot; . $nameToId{$lastHighPriorityPropertyName} . &quot;;\n&quot;;</span>
<span class="udiff-line-modified-added">+ print HEADER &quot;const CSSPropertyID lastHighPriorityProperty = CSSProperty&quot; . $nameToId{$lastHighPriorityPropertyName} . &quot;;\n\n&quot;;</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ print HEADER &quot;static const CSSPropertyID computedPropertyIDs[] = {\n&quot;;</span>
<span class="udiff-line-added">+ my $numComputedPropertyIDs = 0;</span>
<span class="udiff-line-added">+ sub sortWithPrefixedPropertiesLast</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     my $aStartsWithPrefix = substr($a, 0, 1) eq &quot;-&quot;;</span>
<span class="udiff-line-added">+     my $bStartsWithPrefix = substr($b, 0, 1) eq &quot;-&quot;;</span>
<span class="udiff-line-added">+     if ($aStartsWithPrefix &amp;&amp; !$bStartsWithPrefix) {</span>
<span class="udiff-line-added">+         return 1;</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+     if (!$aStartsWithPrefix &amp;&amp; $bStartsWithPrefix) {</span>
<span class="udiff-line-added">+         return -1;</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+     return $a cmp $b;</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ foreach my $name (sort sortWithPrefixedPropertiesLast @names) {</span>
<span class="udiff-line-added">+   next if (exists($propertiesWithStyleBuilderOptions{$name}{&quot;skip-builder&quot;}));</span>
<span class="udiff-line-added">+   next if (grep { $_ eq $name } @internalProprerties);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   # Skip properties if they have a non-internal longhand property.</span>
<span class="udiff-line-added">+   if (exists($propertiesWithStyleBuilderOptions{$name}{&quot;longhands&quot;})) {</span>
<span class="udiff-line-added">+     my @longhands = @{$propertiesWithStyleBuilderOptions{$name}{&quot;longhands&quot;}};</span>
<span class="udiff-line-added">+     if (scalar @longhands != 1) {</span>
<span class="udiff-line-added">+       my $hasNonInternalLonghand = 0;</span>
<span class="udiff-line-added">+       foreach my $longhand (@longhands) {</span>
<span class="udiff-line-added">+         if (!exists($propertiesWithStyleBuilderOptions{$longhand}{&quot;skip-builder&quot;}) &amp;&amp; !grep { $_ eq $longhand } @internalProprerties) {</span>
<span class="udiff-line-added">+           $hasNonInternalLonghand = 1;</span>
<span class="udiff-line-added">+           last;</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+       }</span>
<span class="udiff-line-added">+       if ($hasNonInternalLonghand) {</span>
<span class="udiff-line-added">+         next;</span>
<span class="udiff-line-added">+       }</span>
<span class="udiff-line-added">+     }</span>
<span class="udiff-line-added">+   }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   print HEADER &quot;    CSSProperty&quot; . $nameToId{$name} . &quot;,\n&quot;;</span>
<span class="udiff-line-added">+   $numComputedPropertyIDs += 1;</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ print HEADER &quot;};\n&quot;;</span>
<span class="udiff-line-added">+ print HEADER &quot;const size_t numComputedPropertyIDs = $numComputedPropertyIDs;\n&quot;;</span>
  
  print HEADER &lt;&lt; &quot;EOF&quot;;
  
  bool isInternalCSSProperty(const CSSPropertyID);
  bool isEnabledCSSProperty(const CSSPropertyID);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -511,18 +552,18 @@</span>
  EOF
  
  close HEADER;
  
  #
<span class="udiff-line-modified-removed">- # StyleBuilder.cpp generator.</span>
<span class="udiff-line-modified-added">+ # StyleBuilderGenerated.cpp generator.</span>
  #
  
  sub getScopeForFunction {
    my $name = shift;
    my $builderFunction = shift;
  
<span class="udiff-line-modified-removed">-   return $propertiesWithStyleBuilderOptions{$name}{&quot;custom&quot;}{$builderFunction} ? &quot;StyleBuilderCustom&quot; : &quot;StyleBuilderFunctions&quot;;</span>
<span class="udiff-line-modified-added">+   return $propertiesWithStyleBuilderOptions{$name}{&quot;custom&quot;}{$builderFunction} ? &quot;BuilderCustom&quot; : &quot;BuilderFunctions&quot;;</span>
  }
  
  sub getNameForMethods {
    my $name = shift;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -536,25 +577,25 @@</span>
  
  sub getAutoGetter {
    my $name = shift;
    my $renderStyle = shift;
  
<span class="udiff-line-modified-removed">-   return $renderStyle . &quot;-&gt;hasAuto&quot; . getNameForMethods($name) . &quot;()&quot;;</span>
<span class="udiff-line-modified-added">+   return $renderStyle . &quot;.hasAuto&quot; . getNameForMethods($name) . &quot;()&quot;;</span>
  }
  
  sub getAutoSetter {
    my $name = shift;
    my $renderStyle = shift;
  
<span class="udiff-line-modified-removed">-   return $renderStyle . &quot;-&gt;setHasAuto&quot; . getNameForMethods($name) . &quot;()&quot;;</span>
<span class="udiff-line-modified-added">+   return $renderStyle . &quot;.setHasAuto&quot; . getNameForMethods($name) . &quot;()&quot;;</span>
  }
  
  sub getVisitedLinkSetter {
    my $name = shift;
    my $renderStyle = shift;
  
<span class="udiff-line-modified-removed">-   return $renderStyle . &quot;-&gt;setVisitedLink&quot; . getNameForMethods($name);</span>
<span class="udiff-line-modified-added">+   return $renderStyle . &quot;.setVisitedLink&quot; . getNameForMethods($name);</span>
  }
  
  sub getClearFunction {
    my $name = shift;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -656,11 +697,11 @@</span>
  
  sub colorFromPrimitiveValue {
    my $primitiveValue = shift;
    my $forVisitedLink = @_ ? shift : NOT_FOR_VISITED_LINK;
  
<span class="udiff-line-modified-removed">-   return &quot;styleResolver.colorFromPrimitiveValue(&quot; . $primitiveValue . &quot;, /* forVisitedLink */ &quot; . ($forVisitedLink ? &quot;true&quot; : &quot;false&quot;) . &quot;)&quot;;</span>
<span class="udiff-line-modified-added">+   return &quot;builderState.colorFromPrimitiveValue(&quot; . $primitiveValue . &quot;, /* forVisitedLink */ &quot; . ($forVisitedLink ? &quot;true&quot; : &quot;false&quot;) . &quot;)&quot;;</span>
  }
  
  use constant {
    VALUE_IS_COLOR =&gt; 0,
    VALUE_IS_PRIMITIVE =&gt; 1,
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -670,16 +711,16 @@</span>
    my $name = shift;
    my $value = shift;
    my $indent = shift;
    my $valueIsPrimitive = @_ ? shift : VALUE_IS_COLOR;
  
<span class="udiff-line-modified-removed">-   my $style = &quot;styleResolver.style()&quot;;</span>
<span class="udiff-line-modified-removed">-   my $setterContent .= $indent . &quot;if (styleResolver.applyPropertyToRegularStyle())\n&quot;;</span>
<span class="udiff-line-modified-removed">-   my $setValue = $style . &quot;-&gt;&quot; . $propertiesWithStyleBuilderOptions{$name}{&quot;setter&quot;};</span>
<span class="udiff-line-modified-added">+   my $style = &quot;builderState.style()&quot;;</span>
<span class="udiff-line-modified-added">+   my $setterContent .= $indent . &quot;if (builderState.applyPropertyToRegularStyle())\n&quot;;</span>
<span class="udiff-line-modified-added">+   my $setValue = $style . &quot;.&quot; . $propertiesWithStyleBuilderOptions{$name}{&quot;setter&quot;};</span>
    my $color = $valueIsPrimitive ? colorFromPrimitiveValue($value) : $value;
    $setterContent .= $indent . &quot;    &quot; . $setValue . &quot;(&quot; . $color . &quot;);\n&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;if (styleResolver.applyPropertyToVisitedLinkStyle())\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;if (builderState.applyPropertyToVisitedLinkStyle())\n&quot;;</span>
    $color = $valueIsPrimitive ? colorFromPrimitiveValue($value, FOR_VISITED_LINK) : $value;
    $setterContent .= $indent . &quot;    &quot; . getVisitedLinkSetter($name, $style) . &quot;(&quot; . $color . &quot;);\n&quot;;
  
    return $setterContent;
  }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -688,22 +729,22 @@</span>
    my $name = shift;
    my $primitiveValue = shift;
    my $indent = shift;
  
    my $code = $indent . &quot;if (&quot; . $primitiveValue . &quot;.valueID() == CSSValueCurrentcolor) {\n&quot;;
<span class="udiff-line-modified-removed">-   $code .= $indent . &quot;    applyInherit&quot; . $nameToId{$name} . &quot;(styleResolver);\n&quot;;</span>
<span class="udiff-line-modified-added">+   $code .= $indent . &quot;    applyInherit&quot; . $nameToId{$name} . &quot;(builderState);\n&quot;;</span>
    $code .= $indent . &quot;    return;\n&quot;;
    $code .= $indent . &quot;}\n&quot;;
    return $code;
  }
  
  sub generateAnimationPropertyInitialValueSetter {
    my $name = shift;
    my $indent = shift;
  
    my $setterContent = &quot;&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;AnimationList&amp; list = styleResolver.style()-&gt;&quot; . getEnsureAnimationsOrTransitionsMethod($name) . &quot;();\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;AnimationList&amp; list = builderState.style().&quot; . getEnsureAnimationsOrTransitionsMethod($name) . &quot;();\n&quot;;</span>
    $setterContent .= $indent . &quot;if (list.isEmpty())\n&quot;;
    $setterContent .= $indent . &quot;    list.append(Animation::create());\n&quot;;
    my $setter = $propertiesWithStyleBuilderOptions{$name}{&quot;setter&quot;};
    my $initial = $propertiesWithStyleBuilderOptions{$name}{&quot;initial&quot;};
    $setterContent .= $indent . &quot;list.animation(0).&quot; . $setter . &quot;(Animation::&quot; . $initial . &quot;());\n&quot;;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -719,12 +760,12 @@</span>
  sub generateAnimationPropertyInheritValueSetter {
    my $name = shift;
    my $indent = shift;
  
    my $setterContent = &quot;&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;auto&amp; list = styleResolver.style()-&gt;&quot; . getEnsureAnimationsOrTransitionsMethod($name) . &quot;();\n&quot;;</span>
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;auto* parentList = styleResolver.parentStyle()-&gt;&quot; . getAnimationsOrTransitionsMethod($name) . &quot;();\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;auto&amp; list = builderState.style().&quot; . getEnsureAnimationsOrTransitionsMethod($name) . &quot;();\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;auto* parentList = builderState.parentStyle().&quot; . getAnimationsOrTransitionsMethod($name) . &quot;();\n&quot;;</span>
    $setterContent .= $indent . &quot;size_t i = 0, parentSize = parentList ? parentList-&gt;size() : 0;\n&quot;;
    $setterContent .= $indent . &quot;for ( ; i &lt; parentSize &amp;&amp; parentList-&gt;animation(i).&quot; . getTestFunction($name) . &quot;(); ++i) {\n&quot;;
    $setterContent .= $indent . &quot;    if (list.size() &lt;= i)\n&quot;;
    $setterContent .= $indent . &quot;        list.append(Animation::create());\n&quot;;
    my $getter = $propertiesWithStyleBuilderOptions{$name}{&quot;getter&quot;};
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -743,24 +784,24 @@</span>
  sub generateAnimationPropertyValueSetter {
    my $name = shift;
    my $indent = shift;
  
    my $setterContent = &quot;&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;AnimationList&amp; list = styleResolver.style()-&gt;&quot; . getEnsureAnimationsOrTransitionsMethod($name) . &quot;();\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;AnimationList&amp; list = builderState.style().&quot; . getEnsureAnimationsOrTransitionsMethod($name) . &quot;();\n&quot;;</span>
    $setterContent .= $indent . &quot;size_t childIndex = 0;\n&quot;;
    $setterContent .= $indent . &quot;if (is&lt;CSSValueList&gt;(value)) {\n&quot;;
    $setterContent .= $indent . &quot;    /* Walk each value and put it into an animation, creating new animations as needed. */\n&quot;;
    $setterContent .= $indent . &quot;    for (auto&amp; currentValue : downcast&lt;CSSValueList&gt;(value)) {\n&quot;;
    $setterContent .= $indent . &quot;        if (childIndex &lt;= list.size())\n&quot;;
    $setterContent .= $indent . &quot;            list.append(Animation::create());\n&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;        styleResolver.styleMap()-&gt;&quot; . getAnimationMapfunction($name) . &quot;(list.animation(childIndex), currentValue);\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;        builderState.styleMap().&quot; . getAnimationMapfunction($name) . &quot;(list.animation(childIndex), currentValue);\n&quot;;</span>
    $setterContent .= $indent . &quot;        ++childIndex;\n&quot;;
    $setterContent .= $indent . &quot;    }\n&quot;;
    $setterContent .= $indent . &quot;} else {\n&quot;;
    $setterContent .= $indent . &quot;    if (list.isEmpty())\n&quot;;
    $setterContent .= $indent . &quot;        list.append(Animation::create());\n&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;    styleResolver.styleMap()-&gt;&quot; . getAnimationMapfunction($name) . &quot;(list.animation(childIndex), value);\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;    builderState.styleMap().&quot; . getAnimationMapfunction($name) . &quot;(list.animation(childIndex), value);\n&quot;;</span>
    $setterContent .= $indent . &quot;    childIndex = 1;\n&quot;;
    $setterContent .= $indent . &quot;}\n&quot;;
    $setterContent .= $indent . &quot;for ( ; childIndex &lt; list.size(); ++childIndex) {\n&quot;;
    $setterContent .= $indent . &quot;    /* Reset all remaining animations to not have the property set. */\n&quot;;
    $setterContent .= $indent . &quot;    list.animation(childIndex).&quot; . getClearFunction($name) . &quot;();\n&quot;;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -779,15 +820,15 @@</span>
    my $testFunction = getTestFunction($name);
    my $initial = &quot;FillLayer::&quot; . $propertiesWithStyleBuilderOptions{$name}{&quot;initial&quot;} . &quot;(&quot; . getFillLayerType($name) . &quot;)&quot;;
  
    my $setterContent = &quot;&quot;;
    $setterContent .= $indent . &quot;// Check for (single-layer) no-op before clearing anything.\n&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;auto&amp; layers = styleResolver.style()-&gt;&quot; . getLayersFunction($name) . &quot;();\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;auto&amp; layers = builderState.style().&quot; . getLayersFunction($name) . &quot;();\n&quot;;</span>
    $setterContent .= $indent . &quot;if (!layers.next() &amp;&amp; (!layers.&quot; . $testFunction . &quot;() || layers.&quot; . $getter . &quot;() == $initial))\n&quot;;
    $setterContent .= $indent . &quot;    return;\n&quot;;
    $setterContent .= &quot;\n&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;auto* child = &amp;styleResolver.style()-&gt;&quot; . getLayersAccessorFunction($name) . &quot;();\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;auto* child = &amp;builderState.style().&quot; . getLayersAccessorFunction($name) . &quot;();\n&quot;;</span>
    $setterContent .= $indent . &quot;child-&gt;&quot; . $setter . &quot;(&quot; . $initial . &quot;);\n&quot;;
    $setterContent .= $indent . &quot;for (child = child-&gt;next(); child; child = child-&gt;next())\n&quot;;
    $setterContent .= $indent . &quot;    child-&gt;&quot; . $clearFunction . &quot;();\n&quot;;
  
    return $setterContent;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -802,16 +843,16 @@</span>
    my $clearFunction = getClearFunction($name);
    my $testFunction = getTestFunction($name);
  
    my $setterContent = &quot;&quot;;
    $setterContent .= $indent . &quot;// Check for no-op before copying anything.\n&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;if (styleResolver.parentStyle()-&gt;&quot; . getLayersFunction($name) .&quot;() == styleResolver.style()-&gt;&quot; . getLayersFunction($name) . &quot;())\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;if (builderState.parentStyle().&quot; . getLayersFunction($name) .&quot;() == builderState.style().&quot; . getLayersFunction($name) . &quot;())\n&quot;;</span>
    $setterContent .= $indent . &quot;    return;\n&quot;;
    $setterContent .= &quot;\n&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;auto* child = &amp;styleResolver.style()-&gt;&quot; . getLayersAccessorFunction($name) . &quot;();\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;auto* child = &amp;builderState.style().&quot; . getLayersAccessorFunction($name) . &quot;();\n&quot;;</span>
    $setterContent .= $indent . &quot;FillLayer* previousChild = nullptr;\n&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;for (auto* parent = &amp;styleResolver.parentStyle()-&gt;&quot; . getLayersFunction($name) . &quot;(); parent &amp;&amp; parent-&gt;&quot; . $testFunction . &quot;(); parent = parent-&gt;next()) {\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;for (auto* parent = &amp;builderState.parentStyle().&quot; . getLayersFunction($name) . &quot;(); parent &amp;&amp; parent-&gt;&quot; . $testFunction . &quot;(); parent = parent-&gt;next()) {\n&quot;;</span>
    $setterContent .= $indent . &quot;    if (!child) {\n&quot;;
    $setterContent .= $indent . &quot;        previousChild-&gt;setNext(makeUnique&lt;FillLayer&gt;(&quot; . getFillLayerType($name) . &quot;));\n&quot;;
    $setterContent .= $indent . &quot;        child = previousChild-&gt;next();\n&quot;;
    $setterContent .= $indent . &quot;    }\n&quot;;
    $setterContent .= $indent . &quot;    child-&gt;&quot; . $setter . &quot;(parent-&gt;&quot; . $getter . &quot;());\n&quot;;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -829,25 +870,25 @@</span>
    my $indent = shift;
  
    my $CSSPropertyId = &quot;CSSProperty&quot; . $nameToId{$name};
  
    my $setterContent = &quot;&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;auto* child = &amp;styleResolver.style()-&gt;&quot; . getLayersAccessorFunction($name) . &quot;();\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;auto* child = &amp;builderState.style().&quot; . getLayersAccessorFunction($name) . &quot;();\n&quot;;</span>
    $setterContent .= $indent . &quot;FillLayer* previousChild = nullptr;\n&quot;;
    $setterContent .= $indent . &quot;if (is&lt;CSSValueList&gt;(value) &amp;&amp; !is&lt;CSSImageSetValue&gt;(value)) {\n&quot;;
    $setterContent .= $indent . &quot;    // Walk each value and put it into a layer, creating new layers as needed.\n&quot;;
    $setterContent .= $indent . &quot;    for (auto&amp; item : downcast&lt;CSSValueList&gt;(value)) {\n&quot;;
    $setterContent .= $indent . &quot;        if (!child) {\n&quot;;
    $setterContent .= $indent . &quot;            previousChild-&gt;setNext(makeUnique&lt;FillLayer&gt;(&quot; . getFillLayerType($name) . &quot;));\n&quot;;
    $setterContent .= $indent . &quot;            child = previousChild-&gt;next();\n&quot;;
    $setterContent .= $indent . &quot;        }\n&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;        styleResolver.styleMap()-&gt;&quot; . getFillLayerMapfunction($name) . &quot;(&quot; . $CSSPropertyId . &quot;, *child, item);\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;        builderState.styleMap().&quot; . getFillLayerMapfunction($name) . &quot;(&quot; . $CSSPropertyId . &quot;, *child, item);\n&quot;;</span>
    $setterContent .= $indent . &quot;        previousChild = child;\n&quot;;
    $setterContent .= $indent . &quot;        child = child-&gt;next();\n&quot;;
    $setterContent .= $indent . &quot;    }\n&quot;;
    $setterContent .= $indent . &quot;} else {\n&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;    styleResolver.styleMap()-&gt;&quot; . getFillLayerMapfunction($name) . &quot;(&quot; . $CSSPropertyId . &quot;, *child, value);\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;    builderState.styleMap().&quot; . getFillLayerMapfunction($name) . &quot;(&quot; . $CSSPropertyId . &quot;, *child, value);\n&quot;;</span>
    $setterContent .= $indent . &quot;    child = child-&gt;next();\n&quot;;
    $setterContent .= $indent . &quot;}\n&quot;;
    $setterContent .= $indent . &quot;for (; child; child = child-&gt;next())\n&quot;;
    $setterContent .= $indent . &quot;    child-&gt;&quot; . getClearFunction($name) . &quot;();\n&quot;;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -859,35 +900,35 @@</span>
    my $name = shift;
    my $value = shift;
  
    my $isSVG = exists $propertiesWithStyleBuilderOptions{$name}{&quot;svg&quot;};
    my $setter = $propertiesWithStyleBuilderOptions{$name}{&quot;setter&quot;};
<span class="udiff-line-modified-removed">-   return &quot;styleResolver.style()-&gt;&quot; .  ($isSVG ? &quot;accessSVGStyle().&quot; : &quot;&quot;) . $setter . &quot;(&quot; . $value . &quot;)&quot;;</span>
<span class="udiff-line-modified-added">+   return &quot;builderState.style().&quot; .  ($isSVG ? &quot;accessSVGStyle().&quot; : &quot;&quot;) . $setter . &quot;(&quot; . $value . &quot;)&quot;;</span>
  }
  
  sub generateInitialValueSetter {
    my $name = shift;
    my $indent = shift;
  
    my $setter = $propertiesWithStyleBuilderOptions{$name}{&quot;setter&quot;};
    my $initial = $propertiesWithStyleBuilderOptions{$name}{&quot;initial&quot;};
    my $isSVG = exists $propertiesWithStyleBuilderOptions{$name}{&quot;svg&quot;};
    my $setterContent = &quot;&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;static void applyInitial&quot; . $nameToId{$name} . &quot;(StyleResolver&amp; styleResolver)\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;static void applyInitial&quot; . $nameToId{$name} . &quot;(BuilderState&amp; builderState)\n&quot;;</span>
    $setterContent .= $indent . &quot;{\n&quot;;
<span class="udiff-line-modified-removed">-   my $style = &quot;styleResolver.style()&quot;;</span>
<span class="udiff-line-modified-added">+   my $style = &quot;builderState.style()&quot;;</span>
    if (exists $propertiesWithStyleBuilderOptions{$name}{&quot;auto-functions&quot;}) {
      $setterContent .= $indent . &quot;    &quot; . getAutoSetter($name, $style) . &quot;;\n&quot;;
    } elsif (exists $propertiesWithStyleBuilderOptions{$name}{&quot;visited-link-color-support&quot;}) {
        my $initialColor = &quot;RenderStyle::&quot; . $initial . &quot;()&quot;;
        $setterContent .= generateColorValueSetter($name, $initialColor, $indent . &quot;    &quot;);
    } elsif (exists $propertiesWithStyleBuilderOptions{$name}{&quot;animatable&quot;}) {
      $setterContent .= generateAnimationPropertyInitialValueSetter($name, $indent . &quot;    &quot;);
    } elsif (exists $propertiesWithStyleBuilderOptions{$name}{&quot;font-property&quot;}) {
<span class="udiff-line-modified-removed">-     $setterContent .= $indent . &quot;    auto fontDescription = styleResolver.fontDescription();\n&quot;;</span>
<span class="udiff-line-modified-added">+     $setterContent .= $indent . &quot;    auto fontDescription = builderState.fontDescription();\n&quot;;</span>
      $setterContent .= $indent . &quot;    fontDescription.&quot; . $setter . &quot;(FontCascadeDescription::&quot; . $initial . &quot;());\n&quot;;
<span class="udiff-line-modified-removed">-     $setterContent .= $indent . &quot;    styleResolver.setFontDescription(WTFMove(fontDescription));\n&quot;;</span>
<span class="udiff-line-modified-added">+     $setterContent .= $indent . &quot;    builderState.setFontDescription(WTFMove(fontDescription));\n&quot;;</span>
    } elsif (exists $propertiesWithStyleBuilderOptions{$name}{&quot;fill-layer-property&quot;}) {
      $setterContent .= generateFillLayerPropertyInitialValueSetter($name, $indent . &quot;    &quot;);
    } else {
      my $initialValue = ($isSVG ? &quot;SVGRenderStyle&quot; : &quot;RenderStyle&quot;) . &quot;::&quot; . $initial . &quot;()&quot;;
      $setterContent .= $indent . &quot;    &quot; . generateSetValueStatement($name, $initialValue) . &quot;;\n&quot;;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -900,45 +941,45 @@</span>
  sub generateInheritValueSetter {
    my $name = shift;
    my $indent = shift;
  
    my $setterContent = &quot;&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;static void applyInherit&quot; . $nameToId{$name} . &quot;(StyleResolver&amp; styleResolver)\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;static void applyInherit&quot; . $nameToId{$name} . &quot;(BuilderState&amp; builderState)\n&quot;;</span>
    $setterContent .= $indent . &quot;{\n&quot;;
    my $isSVG = exists $propertiesWithStyleBuilderOptions{$name}{&quot;svg&quot;};
<span class="udiff-line-modified-removed">-   my $parentStyle = &quot;styleResolver.parentStyle()&quot;;</span>
<span class="udiff-line-modified-removed">-   my $style = &quot;styleResolver.style()&quot;;</span>
<span class="udiff-line-modified-added">+   my $parentStyle = &quot;builderState.parentStyle()&quot;;</span>
<span class="udiff-line-modified-added">+   my $style = &quot;builderState.style()&quot;;</span>
    my $getter = $propertiesWithStyleBuilderOptions{$name}{&quot;getter&quot;};
    my $setter = $propertiesWithStyleBuilderOptions{$name}{&quot;setter&quot;};
    my $didCallSetValue = 0;
    if (exists $propertiesWithStyleBuilderOptions{$name}{&quot;auto-functions&quot;}) {
      $setterContent .= $indent . &quot;    if (&quot; . getAutoGetter($name, $parentStyle) . &quot;) {\n&quot;;
      $setterContent .= $indent . &quot;        &quot; . getAutoSetter($name, $style) . &quot;;\n&quot;;
      $setterContent .= $indent . &quot;        return;\n&quot;;
      $setterContent .= $indent . &quot;    }\n&quot;;
    } elsif (exists $propertiesWithStyleBuilderOptions{$name}{&quot;visited-link-color-support&quot;}) {
<span class="udiff-line-modified-removed">-     $setterContent .= $indent . &quot;    Color color = &quot; . $parentStyle . &quot;-&gt;&quot; . $getter . &quot;();\n&quot;;</span>
<span class="udiff-line-modified-added">+     $setterContent .= $indent . &quot;    Color color = &quot; . $parentStyle . &quot;.&quot; . $getter . &quot;();\n&quot;;</span>
      if (!exists($propertiesWithStyleBuilderOptions{$name}{&quot;no-default-color&quot;})) {
        $setterContent .= $indent . &quot;    if (!color.isValid())\n&quot;;
<span class="udiff-line-modified-removed">-       $setterContent .= $indent . &quot;        color = &quot; . $parentStyle . &quot;-&gt;color();\n&quot;;</span>
<span class="udiff-line-modified-added">+       $setterContent .= $indent . &quot;        color = &quot; . $parentStyle . &quot;.color();\n&quot;;</span>
      }
      $setterContent .= generateColorValueSetter($name, &quot;color&quot;, $indent . &quot;    &quot;);
      $didCallSetValue = 1;
    } elsif (exists $propertiesWithStyleBuilderOptions{$name}{&quot;animatable&quot;}) {
      $setterContent .= generateAnimationPropertyInheritValueSetter($name, $indent . &quot;    &quot;);
      $didCallSetValue = 1;
    } elsif (exists $propertiesWithStyleBuilderOptions{$name}{&quot;font-property&quot;}) {
<span class="udiff-line-modified-removed">-     $setterContent .= $indent . &quot;    auto fontDescription = styleResolver.fontDescription();\n&quot;;</span>
<span class="udiff-line-modified-removed">-     $setterContent .= $indent . &quot;    fontDescription.&quot; . $setter . &quot;(styleResolver.parentFontDescription().&quot; . $getter . &quot;());\n&quot;;</span>
<span class="udiff-line-modified-removed">-     $setterContent .= $indent . &quot;    styleResolver.setFontDescription(WTFMove(fontDescription));\n&quot;;</span>
<span class="udiff-line-modified-added">+     $setterContent .= $indent . &quot;    auto fontDescription = builderState.fontDescription();\n&quot;;</span>
<span class="udiff-line-modified-added">+     $setterContent .= $indent . &quot;    fontDescription.&quot; . $setter . &quot;(builderState.parentFontDescription().&quot; . $getter . &quot;());\n&quot;;</span>
<span class="udiff-line-modified-added">+     $setterContent .= $indent . &quot;    builderState.setFontDescription(WTFMove(fontDescription));\n&quot;;</span>
      $didCallSetValue = 1;
    } elsif (exists $propertiesWithStyleBuilderOptions{$name}{&quot;fill-layer-property&quot;}) {
      $setterContent .= generateFillLayerPropertyInheritValueSetter($name, $indent . &quot;    &quot;);
      $didCallSetValue = 1;
    }
    if (!$didCallSetValue) {
<span class="udiff-line-modified-removed">-     my $inheritedValue = $parentStyle . &quot;-&gt;&quot; . ($isSVG ? &quot;svgStyle().&quot; : &quot;&quot;) .  $getter . &quot;()&quot;;</span>
<span class="udiff-line-modified-added">+     my $inheritedValue = $parentStyle . &quot;.&quot; . ($isSVG ? &quot;svgStyle().&quot; : &quot;&quot;) .  $getter . &quot;()&quot;;</span>
      $setterContent .= $indent . &quot;    &quot; . generateSetValueStatement($name, &quot;forwardInheritedValue(&quot; . $inheritedValue . &quot;)&quot;) . &quot;;\n&quot;;
    }
    $setterContent .= $indent . &quot;}\n&quot;;
  
    return $setterContent;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -947,24 +988,24 @@</span>
  sub generateValueSetter {
    my $name = shift;
    my $indent = shift;
  
    my $setterContent = &quot;&quot;;
<span class="udiff-line-modified-removed">-   $setterContent .= $indent . &quot;static void applyValue&quot; . $nameToId{$name} . &quot;(StyleResolver&amp; styleResolver, CSSValue&amp; value)\n&quot;;</span>
<span class="udiff-line-modified-added">+   $setterContent .= $indent . &quot;static void applyValue&quot; . $nameToId{$name} . &quot;(BuilderState&amp; builderState, CSSValue&amp; value)\n&quot;;</span>
    $setterContent .= $indent . &quot;{\n&quot;;
    my $convertedValue;
    if (exists($propertiesWithStyleBuilderOptions{$name}{&quot;converter&quot;})) {
<span class="udiff-line-modified-removed">-     $convertedValue = &quot;StyleBuilderConverter::convert&quot; . $propertiesWithStyleBuilderOptions{$name}{&quot;converter&quot;} . &quot;(styleResolver, value)&quot;;</span>
<span class="udiff-line-modified-added">+     $convertedValue = &quot;BuilderConverter::convert&quot; . $propertiesWithStyleBuilderOptions{$name}{&quot;converter&quot;} . &quot;(builderState, value)&quot;;</span>
    } elsif (exists($propertiesWithStyleBuilderOptions{$name}{&quot;conditional-converter&quot;})) {
<span class="udiff-line-modified-removed">-     $setterContent .= $indent . &quot;    auto convertedValue = StyleBuilderConverter::convert&quot; . $propertiesWithStyleBuilderOptions{$name}{&quot;conditional-converter&quot;} . &quot;(styleResolver, value);\n&quot;;</span>
<span class="udiff-line-modified-added">+     $setterContent .= $indent . &quot;    auto convertedValue = BuilderConverter::convert&quot; . $propertiesWithStyleBuilderOptions{$name}{&quot;conditional-converter&quot;} . &quot;(builderState, value);\n&quot;;</span>
      $convertedValue = &quot;WTFMove(convertedValue.value())&quot;;
    } else {
      $convertedValue = &quot;downcast&lt;CSSPrimitiveValue&gt;(value)&quot;;
    }
  
    my $setter = $propertiesWithStyleBuilderOptions{$name}{&quot;setter&quot;};
<span class="udiff-line-modified-removed">-   my $style = &quot;styleResolver.style()&quot;;</span>
<span class="udiff-line-modified-added">+   my $style = &quot;builderState.style()&quot;;</span>
    my $didCallSetValue = 0;
    if (exists $propertiesWithStyleBuilderOptions{$name}{&quot;auto-functions&quot;}) {
      $setterContent .= $indent . &quot;    if (downcast&lt;CSSPrimitiveValue&gt;(value).valueID() == CSSValueAuto) {\n&quot;;
      $setterContent .= $indent . &quot;        &quot;. getAutoSetter($name, $style) . &quot;;\n&quot;;
      $setterContent .= $indent . &quot;        return;\n&quot;;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -979,13 +1020,13 @@</span>
      $didCallSetValue = 1;
    } elsif (exists $propertiesWithStyleBuilderOptions{$name}{&quot;animatable&quot;}) {
      $setterContent .= generateAnimationPropertyValueSetter($name, $indent . &quot;    &quot;);
      $didCallSetValue = 1;
    } elsif (exists $propertiesWithStyleBuilderOptions{$name}{&quot;font-property&quot;}) {
<span class="udiff-line-modified-removed">-     $setterContent .= $indent . &quot;    auto fontDescription = styleResolver.fontDescription();\n&quot;;</span>
<span class="udiff-line-modified-added">+     $setterContent .= $indent . &quot;    auto fontDescription = builderState.fontDescription();\n&quot;;</span>
      $setterContent .= $indent . &quot;    fontDescription.&quot; . $setter . &quot;(&quot; . $convertedValue . &quot;);\n&quot;;
<span class="udiff-line-modified-removed">-     $setterContent .= $indent . &quot;    styleResolver.setFontDescription(WTFMove(fontDescription));\n&quot;;</span>
<span class="udiff-line-modified-added">+     $setterContent .= $indent . &quot;    builderState.setFontDescription(WTFMove(fontDescription));\n&quot;;</span>
      $didCallSetValue = 1;
    } elsif (exists $propertiesWithStyleBuilderOptions{$name}{&quot;fill-layer-property&quot;}) {
      $setterContent .= generateFillLayerPropertyValueSetter($name, $indent . &quot;    &quot;);
      $didCallSetValue = 1;
    }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -999,28 +1040,29 @@</span>
    $setterContent .= $indent . &quot;}\n&quot;;
  
    return $setterContent;
  }
  
<span class="udiff-line-modified-removed">- open STYLEBUILDER, &quot;&gt;StyleBuilder.cpp&quot; || die &quot;Could not open StyleBuilder.cpp for writing&quot;;</span>
<span class="udiff-line-modified-added">+ open STYLEBUILDER, &quot;&gt;StyleBuilderGenerated.cpp&quot; || die &quot;Could not open StyleBuilderGenerated.cpp for writing&quot;;</span>
  print STYLEBUILDER &lt;&lt; &quot;EOF&quot;;
  /* This file is automatically generated from $inputFile by makeprop, do not edit */
  
  #include &quot;config.h&quot;
<span class="udiff-line-modified-removed">- #include &quot;StyleBuilder.h&quot;</span>
<span class="udiff-line-modified-added">+ #include &quot;StyleBuilderGenerated.h&quot;</span>
  
  #include &quot;CSSPrimitiveValueMappings.h&quot;
  #include &quot;CSSProperty.h&quot;
  #include &quot;RenderStyle.h&quot;
<span class="udiff-line-added">+ #include &quot;StyleBuilderState.h&quot;</span>
  #include &quot;StyleBuilderConverter.h&quot;
  #include &quot;StyleBuilderCustom.h&quot;
  #include &quot;StylePropertyShorthand.h&quot;
<span class="udiff-line-removed">- #include &quot;StyleResolver.h&quot;</span>
  
  namespace WebCore {
<span class="udiff-line-added">+ namespace Style {</span>
  
<span class="udiff-line-modified-removed">- class StyleBuilderFunctions {</span>
<span class="udiff-line-modified-added">+ class BuilderFunctions {</span>
  public:
  EOF
  
  foreach my $name (@names) {
    # Skip Shorthand properties and properties that do not use the StyleBuilder.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1040,23 +1082,23 @@</span>
  }
  
  print STYLEBUILDER &lt;&lt; &quot;EOF&quot;;
  };
  
<span class="udiff-line-modified-removed">- void StyleBuilder::applyProperty(CSSPropertyID property, StyleResolver&amp; styleResolver, CSSValue&amp; value, bool isInitial, bool isInherit, const CSSRegisteredCustomProperty* registered)</span>
<span class="udiff-line-modified-added">+ void BuilderGenerated::applyProperty(CSSPropertyID property, BuilderState&amp; builderState, CSSValue&amp; value, bool isInitial, bool isInherit, const CSSRegisteredCustomProperty* registered)</span>
  {
      switch (property) {
      case CSSPropertyInvalid:
          break;
      case CSSPropertyCustom: {
          auto&amp; customProperty = downcast&lt;CSSCustomPropertyValue&gt;(value);
          if (isInitial)
<span class="udiff-line-modified-removed">-             StyleBuilderCustom::applyInitialCustomProperty(styleResolver, registered, customProperty.name());</span>
<span class="udiff-line-modified-added">+             BuilderCustom::applyInitialCustomProperty(builderState, registered, customProperty.name());</span>
          else if (isInherit)
<span class="udiff-line-modified-removed">-             StyleBuilderCustom::applyInheritCustomProperty(styleResolver, registered, customProperty.name());</span>
<span class="udiff-line-modified-added">+             BuilderCustom::applyInheritCustomProperty(builderState, registered, customProperty.name());</span>
          else
<span class="udiff-line-modified-removed">-             StyleBuilderCustom::applyValueCustomProperty(styleResolver, registered, customProperty);</span>
<span class="udiff-line-modified-added">+             BuilderCustom::applyValueCustomProperty(builderState, registered, customProperty);</span>
          break;
      }
  EOF
  
  foreach my $name (@names) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1064,23 +1106,24 @@</span>
    if (exists $propertiesWithStyleBuilderOptions{$name}{&quot;longhands&quot;}) {
      print STYLEBUILDER &quot;        ASSERT(isShorthandCSSProperty(property));\n&quot;;
      print STYLEBUILDER &quot;        ASSERT_NOT_REACHED();\n&quot;;
    } elsif (!exists $propertiesWithStyleBuilderOptions{$name}{&quot;skip-builder&quot;}) {
      print STYLEBUILDER &quot;        if (isInitial)\n&quot;;
<span class="udiff-line-modified-removed">-     print STYLEBUILDER &quot;            &quot; . getScopeForFunction($name, &quot;Initial&quot;) . &quot;::applyInitial&quot; . $nameToId{$name} . &quot;(styleResolver);\n&quot;;</span>
<span class="udiff-line-modified-added">+     print STYLEBUILDER &quot;            &quot; . getScopeForFunction($name, &quot;Initial&quot;) . &quot;::applyInitial&quot; . $nameToId{$name} . &quot;(builderState);\n&quot;;</span>
      print STYLEBUILDER &quot;        else if (isInherit)\n&quot;;
<span class="udiff-line-modified-removed">-     print STYLEBUILDER &quot;            &quot; . getScopeForFunction($name, &quot;Inherit&quot;) . &quot;::applyInherit&quot; . $nameToId{$name} . &quot;(styleResolver);\n&quot;;</span>
<span class="udiff-line-modified-added">+     print STYLEBUILDER &quot;            &quot; . getScopeForFunction($name, &quot;Inherit&quot;) . &quot;::applyInherit&quot; . $nameToId{$name} . &quot;(builderState);\n&quot;;</span>
      print STYLEBUILDER &quot;        else\n&quot;;
<span class="udiff-line-modified-removed">-     print STYLEBUILDER &quot;            &quot; . getScopeForFunction($name, &quot;Value&quot;) . &quot;::applyValue&quot; . $nameToId{$name} . &quot;(styleResolver, value);\n&quot;;</span>
<span class="udiff-line-modified-added">+     print STYLEBUILDER &quot;            &quot; . getScopeForFunction($name, &quot;Value&quot;) . &quot;::applyValue&quot; . $nameToId{$name} . &quot;(builderState, value);\n&quot;;</span>
    }
    print STYLEBUILDER &quot;        break;\n&quot;;
  }
  
  print STYLEBUILDER &lt;&lt; &quot;EOF&quot;;
      };
  }
  
<span class="udiff-line-added">+ } // namespace Style</span>
  } // namespace WebCore
  EOF
  
  close STYLEBUILDER;
  
</pre>
<center><a href="html.css.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="parser/CSSParser.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>