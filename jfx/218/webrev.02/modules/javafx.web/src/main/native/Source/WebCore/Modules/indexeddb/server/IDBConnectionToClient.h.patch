diff a/modules/javafx.web/src/main/native/Source/WebCore/Modules/indexeddb/server/IDBConnectionToClient.h b/modules/javafx.web/src/main/native/Source/WebCore/Modules/indexeddb/server/IDBConnectionToClient.h
--- a/modules/javafx.web/src/main/native/Source/WebCore/Modules/indexeddb/server/IDBConnectionToClient.h
+++ b/modules/javafx.web/src/main/native/Source/WebCore/Modules/indexeddb/server/IDBConnectionToClient.h
@@ -45,11 +45,11 @@
 
 class IDBConnectionToClient : public RefCounted<IDBConnectionToClient> {
 public:
     WEBCORE_EXPORT static Ref<IDBConnectionToClient> create(IDBConnectionToClientDelegate&);
 
-    uint64_t identifier() const;
+    IDBConnectionIdentifier identifier() const;
 
     void didDeleteDatabase(const IDBResultData&);
     void didOpenDatabase(const IDBResultData&);
     void didAbortTransaction(const IDBResourceIdentifier& transactionIdentifier, const IDBError&);
     void didCommitTransaction(const IDBResourceIdentifier& transactionIdentifier, const IDBError&);
@@ -78,14 +78,16 @@
 
     void registerDatabaseConnection(UniqueIDBDatabaseConnection&);
     void unregisterDatabaseConnection(UniqueIDBDatabaseConnection&);
     void connectionToClientClosed();
     bool isClosed() { return m_isClosed; }
+    void clearDelegate() { m_delegate = nullptr; }
+
 private:
     IDBConnectionToClient(IDBConnectionToClientDelegate&);
 
-    WeakPtr<IDBConnectionToClientDelegate> m_delegate;
+    IDBConnectionToClientDelegate* m_delegate;
     HashSet<UniqueIDBDatabaseConnection*> m_databaseConnections;
     bool m_isClosed { false };
 };
 
 } // namespace IDBServer
