<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/WebCore/dom/PseudoElement.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (C) 2012 Google Inc. All rights reserved.
  3  * Copyright (C) 2017 Apple Inc. All rights reserved.
  4  *
  5  * Redistribution and use in source and binary forms, with or without
  6  * modification, are permitted provided that the following conditions are
  7  * met:
  8  *
  9  *     * Redistributions of source code must retain the above copyright
 10  * notice, this list of conditions and the following disclaimer.
 11  *     * Neither the name of Google Inc. nor the names of its
 12  * contributors may be used to endorse or promote products derived from
 13  * this software without specific prior written permission.
 14  *
 15  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 16  * &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 17  * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 18  * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 19  * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 20  * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 21  * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 22  * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 23  * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 24  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 25  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 26  */
 27 
 28 #include &quot;config.h&quot;
 29 #include &quot;PseudoElement.h&quot;
 30 
 31 #include &quot;CSSAnimationController.h&quot;
 32 #include &quot;ContentData.h&quot;
 33 #include &quot;DocumentTimeline.h&quot;
 34 #include &quot;InspectorInstrumentation.h&quot;
 35 #include &quot;RenderElement.h&quot;
 36 #include &quot;RenderImage.h&quot;
 37 #include &quot;RenderQuote.h&quot;
 38 #include &quot;StyleResolver.h&quot;
 39 #include &lt;wtf/IsoMallocInlines.h&gt;
 40 
 41 namespace WebCore {
 42 
 43 WTF_MAKE_ISO_ALLOCATED_IMPL(PseudoElement);
 44 
 45 const QualifiedName&amp; pseudoElementTagName()
 46 {
 47     static NeverDestroyed&lt;QualifiedName&gt; name(nullAtom(), &quot;&lt;pseudo&gt;&quot;, nullAtom());
 48     return name;
 49 }
 50 
 51 String PseudoElement::pseudoElementNameForEvents(PseudoId pseudoId)
 52 {
 53     static NeverDestroyed&lt;const String&gt; after(MAKE_STATIC_STRING_IMPL(&quot;::after&quot;));
 54     static NeverDestroyed&lt;const String&gt; before(MAKE_STATIC_STRING_IMPL(&quot;::before&quot;));
 55     switch (pseudoId) {
 56     case PseudoId::After:
 57         return after;
 58     case PseudoId::Before:
 59         return before;
 60     default:
 61         return emptyString();
 62     }
 63 }
 64 
 65 PseudoElement::PseudoElement(Element&amp; host, PseudoId pseudoId)
 66     : Element(pseudoElementTagName(), host.document(), CreatePseudoElement)
 67     , m_hostElement(&amp;host)
 68     , m_pseudoId(pseudoId)
 69 {
 70     ASSERT(pseudoId == PseudoId::Before || pseudoId == PseudoId::After);
 71     setHasCustomStyleResolveCallbacks();
 72 }
 73 
 74 PseudoElement::~PseudoElement()
 75 {
 76     ASSERT(!m_hostElement);
 77 }
 78 
 79 Ref&lt;PseudoElement&gt; PseudoElement::create(Element&amp; host, PseudoId pseudoId)
 80 {
 81     auto pseudoElement = adoptRef(*new PseudoElement(host, pseudoId));
 82 
 83     InspectorInstrumentation::pseudoElementCreated(host.document().page(), pseudoElement.get());
 84 
 85     return pseudoElement;
 86 }
 87 
 88 void PseudoElement::clearHostElement()
 89 {
 90     InspectorInstrumentation::pseudoElementDestroyed(document().page(), *this);
 91 
 92     if (auto* timeline = document().existingTimeline())
 93         timeline-&gt;elementWasRemoved(*this);
 94 
 95     if (auto* frame = document().frame())
 96         frame-&gt;animation().cancelAnimations(*this);
 97 
 98     m_hostElement = nullptr;
 99 }
100 
101 bool PseudoElement::rendererIsNeeded(const RenderStyle&amp; style)
102 {
103     return pseudoElementRendererIsNeeded(&amp;style);
104 }
105 
106 } // namespace
    </pre>
  </body>
</html>