<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/Lookup.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="LiteralParser.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MachineContext.h.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/Lookup.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -42,11 +42,11 @@</span>
      const int16_t value;
      const int16_t next;
  };
  
  // FIXME: There is no reason this get function can&#39;t be simpler.
<span class="udiff-line-modified-removed">- // ie. typedef JSValue (*GetFunction)(ExecState*, JSObject* baseObject)</span>
<span class="udiff-line-modified-added">+ // ie. typedef JSValue (*GetFunction)(JSGlobalObject*, JSObject* baseObject)</span>
  typedef PropertySlot::GetValueFunc GetFunction;
  typedef PutPropertySlot::PutValueFunc PutFunction;
  typedef FunctionExecutable* (*BuiltinGenerator)(VM&amp;);
  typedef JSValue (*LazyPropertyCallback)(VM&amp;, JSObject*);
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -264,28 +264,28 @@</span>
  }
  
  // &#39;base&#39; means the object holding the property (possibly in the prototype chain of the object put was called on).
  // &#39;thisValue&#39; is the object that put is being applied to (in the case of a proxy, the proxy target).
  // &#39;slot.thisValue()&#39; is the object the put was originally performed on (in the case of a proxy, the proxy itself).
<span class="udiff-line-modified-removed">- inline bool putEntry(ExecState* exec, const ClassInfo*, const HashTableValue* entry, JSObject* base, JSObject* thisValue, PropertyName propertyName, JSValue value, PutPropertySlot&amp; slot)</span>
<span class="udiff-line-modified-added">+ inline bool putEntry(JSGlobalObject* globalObject, const ClassInfo*, const HashTableValue* entry, JSObject* base, JSObject* thisValue, PropertyName propertyName, JSValue value, PutPropertySlot&amp; slot)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = getVM(globalObject);</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
  
      if (entry-&gt;attributes() &amp; PropertyAttribute::BuiltinOrFunctionOrLazyProperty) {
          if (!(entry-&gt;attributes() &amp; PropertyAttribute::ReadOnly)) {
              // If this is a function or lazy property put then we just do the put because
              // logically the object already had the property, so this is just a replace.
              if (JSObject* thisObject = jsDynamicCast&lt;JSObject*&gt;(vm, thisValue))
                  thisObject-&gt;putDirect(vm, propertyName, value);
              return true;
          }
<span class="udiff-line-modified-removed">-         return typeError(exec, scope, slot.isStrictMode(), ReadonlyPropertyWriteError);</span>
<span class="udiff-line-modified-added">+         return typeError(globalObject, scope, slot.isStrictMode(), ReadonlyPropertyWriteError);</span>
      }
  
      if (entry-&gt;attributes() &amp; PropertyAttribute::Accessor)
<span class="udiff-line-modified-removed">-         return typeError(exec, scope, slot.isStrictMode(), ReadonlyPropertyWriteError);</span>
<span class="udiff-line-modified-added">+         return typeError(globalObject, scope, slot.isStrictMode(), ReadonlyPropertyWriteError);</span>
  
      if (!(entry-&gt;attributes() &amp; PropertyAttribute::ReadOnly)) {
          ASSERT_WITH_MESSAGE(!(entry-&gt;attributes() &amp; PropertyAttribute::DOMJITAttribute), &quot;DOMJITAttribute supports readonly attributes currently.&quot;);
          bool isAccessor = entry-&gt;attributes() &amp; PropertyAttribute::CustomAccessor;
          JSValue updateThisValue = entry-&gt;attributes() &amp; PropertyAttribute::CustomAccessor ? slot.thisValue() : JSValue(base);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -293,31 +293,31 @@</span>
          if (isAccessor)
              slot.setCustomAccessor(base, entry-&gt;propertyPutter());
          else
              slot.setCustomValue(base, entry-&gt;propertyPutter());
  
<span class="udiff-line-modified-removed">-         bool result = callCustomSetter(exec, entry-&gt;propertyPutter(), isAccessor, updateThisValue, value);</span>
<span class="udiff-line-modified-added">+         bool result = callCustomSetter(globalObject, entry-&gt;propertyPutter(), isAccessor, updateThisValue, value);</span>
          RETURN_IF_EXCEPTION(scope, false);
          return result;
      }
  
<span class="udiff-line-modified-removed">-     return typeError(exec, scope, slot.isStrictMode(), ReadonlyPropertyWriteError);</span>
<span class="udiff-line-modified-added">+     return typeError(globalObject, scope, slot.isStrictMode(), ReadonlyPropertyWriteError);</span>
  }
  
  /**
   * This one is for &quot;put&quot;.
   * It looks up a hash entry for the property to be set.  If an entry
   * is found it sets the value and returns true, else it returns false.
   */
<span class="udiff-line-modified-removed">- inline bool lookupPut(ExecState* exec, PropertyName propertyName, JSObject* base, JSValue value, const HashTable&amp; table, PutPropertySlot&amp; slot, bool&amp; putResult)</span>
<span class="udiff-line-modified-added">+ inline bool lookupPut(JSGlobalObject* globalObject, PropertyName propertyName, JSObject* base, JSValue value, const HashTable&amp; table, PutPropertySlot&amp; slot, bool&amp; putResult)</span>
  {
      const HashTableValue* entry = table.entry(propertyName);
  
      if (!entry)
          return false;
  
<span class="udiff-line-modified-removed">-     putResult = putEntry(exec, table.classForThis, entry, base, base, propertyName, value, slot);</span>
<span class="udiff-line-modified-added">+     putResult = putEntry(globalObject, table.classForThis, entry, base, base, propertyName, value, slot);</span>
      return true;
  }
  
  inline void reifyStaticProperty(VM&amp; vm, const ClassInfo* classInfo, const PropertyName&amp; propertyName, const HashTableValue&amp; value, JSObject&amp; thisObj)
  {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -359,13 +359,14 @@</span>
          thisObj.putDirect(vm, propertyName, result, attributesForStructure(value.attributes()));
          return;
      }
  
      if (value.attributes() &amp; PropertyAttribute::ClassStructure) {
<span class="udiff-line-modified-removed">-         LazyClassStructure* structure = bitwise_cast&lt;LazyClassStructure*&gt;(</span>
<span class="udiff-line-modified-added">+         LazyClassStructure* lazyStructure = bitwise_cast&lt;LazyClassStructure*&gt;(</span>
              bitwise_cast&lt;char*&gt;(&amp;thisObj) + value.lazyClassStructureOffset());
<span class="udiff-line-modified-removed">-         structure-&gt;get(jsCast&lt;JSGlobalObject*&gt;(&amp;thisObj));</span>
<span class="udiff-line-modified-added">+         JSObject* constructor = lazyStructure-&gt;constructor(jsCast&lt;JSGlobalObject*&gt;(&amp;thisObj));</span>
<span class="udiff-line-added">+         thisObj.putDirect(vm, propertyName, constructor, attributesForStructure(value.attributes()));</span>
          return;
      }
  
      if (value.attributes() &amp; PropertyAttribute::PropertyCallback) {
          JSValue result = value.lazyPropertyCallback()(vm, &amp;thisObj);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -402,11 +403,11 @@</span>
          auto key = Identifier::fromString(vm, reinterpret_cast&lt;const LChar*&gt;(value.m_key), strlen(value.m_key));
          reifyStaticProperty(vm, classInfo, key, value, thisObj);
      }
  }
  
<span class="udiff-line-modified-removed">- template&lt;RawNativeFunction nativeFunction, int length&gt; EncodedJSValue nonCachingStaticFunctionGetter(ExecState* state, EncodedJSValue, PropertyName propertyName)</span>
<span class="udiff-line-modified-added">+ template&lt;RawNativeFunction nativeFunction, int length&gt; EncodedJSValue nonCachingStaticFunctionGetter(JSGlobalObject* globalObject, EncodedJSValue, PropertyName propertyName)</span>
  {
<span class="udiff-line-modified-removed">-     return JSValue::encode(JSFunction::create(state-&gt;vm(), state-&gt;lexicalGlobalObject(), length, propertyName.publicName(), nativeFunction));</span>
<span class="udiff-line-modified-added">+     return JSValue::encode(JSFunction::create(globalObject-&gt;vm(), globalObject, length, propertyName.publicName(), nativeFunction));</span>
  }
  
  } // namespace JSC
</pre>
<center><a href="LiteralParser.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MachineContext.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>