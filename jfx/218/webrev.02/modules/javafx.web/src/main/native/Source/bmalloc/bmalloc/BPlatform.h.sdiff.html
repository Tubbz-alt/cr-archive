<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/bmalloc/bmalloc/BPlatform.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="AvailableMemory.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="BumpAllocator.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/bmalloc/bmalloc/BPlatform.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #include &quot;BCompiler.h&quot;
 29 
 30 #ifdef __APPLE__
 31 #include &lt;Availability.h&gt;
 32 #include &lt;AvailabilityMacros.h&gt;
 33 #include &lt;TargetConditionals.h&gt;
 34 #endif
 35 
 36 #define BPLATFORM(PLATFORM) (defined BPLATFORM_##PLATFORM &amp;&amp; BPLATFORM_##PLATFORM)
 37 #define BOS(OS) (defined BOS_##OS &amp;&amp; BOS_##OS)
 38 
 39 #ifdef __APPLE__
 40 #define BOS_DARWIN 1
 41 #endif
 42 
<span class="line-modified"> 43 #ifdef __unix</span>
 44 #define BOS_UNIX 1
 45 #endif
 46 
 47 #ifdef __linux__
 48 #define BOS_LINUX 1
 49 #endif
 50 
 51 #if defined(__FreeBSD__) || defined(__DragonFly__) || defined(__FreeBSD_kernel__)
 52 #define BOS_FREEBSD 1
 53 #endif
 54 
 55 #if defined(WIN32) || defined(_WIN32)
 56 #define BOS_WINDOWS 1
 57 #endif
 58 
 59 #if BOS(DARWIN) &amp;&amp; !defined(BUILDING_WITH_CMAKE)
 60 #if TARGET_OS_IOS

 61 #define BPLATFORM_IOS 1
 62 #if TARGET_OS_SIMULATOR
 63 #define BPLATFORM_IOS_SIMULATOR 1
 64 #endif
 65 #endif
 66 #if TARGET_OS_IPHONE
 67 #define BPLATFORM_IOS_FAMILY 1
 68 #if TARGET_OS_SIMULATOR
 69 #define BPLATFORM_IOS_FAMILY_SIMULATOR 1
 70 #endif
 71 #elif TARGET_OS_MAC

 72 #define BPLATFORM_MAC 1
 73 #endif
 74 #endif
 75 
 76 #if BPLATFORM(MAC) || BPLATFORM(IOS_FAMILY)
 77 #define BPLATFORM_COCOA 1
 78 #endif
 79 
 80 #if defined(TARGET_OS_WATCH) &amp;&amp; TARGET_OS_WATCH

 81 #define BPLATFORM_WATCHOS 1
 82 #endif
 83 
 84 #if defined(TARGET_OS_TV) &amp;&amp; TARGET_OS_TV

 85 #define BPLATFORM_APPLETV 1
 86 #endif
 87 
 88 /* ==== Policy decision macros: these define policy choices for a particular port. ==== */
 89 
 90 /* BUSE() - use a particular third-party library or optional OS service */
 91 #define BUSE(FEATURE) (defined BUSE_##FEATURE &amp;&amp; BUSE_##FEATURE)
 92 
 93 /* ==== Compiler adaptation macros: these describe the capabilities of the compiler. ==== */
 94 
 95 /* BCOMPILER_SUPPORTS() - check for a compiler feature */
 96 #define BCOMPILER_SUPPORTS(FEATURE) (defined BCOMPILER_SUPPORTS_##FEATURE &amp;&amp; BCOMPILER_SUPPORTS_##FEATURE)
 97 
 98 /* ==== Platform adaptation macros: these describe properties of the target environment. ==== */
 99 
100 /* BCPU() - the target CPU architecture */
101 #define BCPU(_FEATURE) (defined BCPU_##_FEATURE  &amp;&amp; BCPU_##_FEATURE)
102 
103 /* BCPU(X86) - i386 / x86 32-bit */
104 #if defined(__i386__) \
</pre>
<hr />
<pre>
213 /* BCPU(ARM_TRADITIONAL) - Thumb2 is not available, only traditional ARM (v4 or greater) */
214 /* BCPU(ARM_THUMB2) - Thumb2 instruction set is available */
215 /* Only one of these will be defined. */
216 #if !defined(BCPU_ARM_TRADITIONAL) &amp;&amp; !defined(BCPU_ARM_THUMB2)
217 #  if defined(thumb2) || defined(__thumb2__) \
218 || ((defined(__thumb) || defined(__thumb__)) &amp;&amp; BTHUMB_ARCH_VERSION == 4)
219 #    define BCPU_ARM_TRADITIONAL 0
220 #    define BCPU_ARM_THUMB2 1
221 #  elif BARM_ARCH_AT_LEAST(4)
222 #    define BCPU_ARM_TRADITIONAL 1
223 #    define BCPU_ARM_THUMB2 0
224 #  else
225 #    error &quot;Not supported ARM architecture&quot;
226 #  endif
227 #elif BCPU(ARM_TRADITIONAL) &amp;&amp; BCPU(ARM_THUMB2) /* Sanity Check */
228 #  error &quot;Cannot use both of BCPU_ARM_TRADITIONAL and BCPU_ARM_THUMB2 platforms&quot;
229 #endif /* !defined(BCPU_ARM_TRADITIONAL) &amp;&amp; !defined(BCPU_ARM_THUMB2) */
230 
231 #endif /* ARM */
232 







































233 #define BATTRIBUTE_PRINTF(formatStringArgument, extraArguments) __attribute__((__format__(printf, formatStringArgument, extraArguments)))
234 
235 #if BPLATFORM(MAC) || BPLATFORM(IOS_FAMILY)
236 #define BUSE_OS_LOG 1
237 #endif
238 
239 #if !defined(BUSE_EXPORT_MACROS) &amp;&amp; (BPLATFORM(MAC) || BPLATFORM(IOS_FAMILY))
240 #define BUSE_EXPORT_MACROS 1
241 #endif
242 
243 /* BUNUSED_PARAM */
244 #if !defined(BUNUSED_PARAM)
245 #define BUNUSED_PARAM(variable) (void)variable
246 #endif
247 



248 /* This is used for debugging when hacking on how bmalloc calculates its physical footprint. */
249 #define ENABLE_PHYSICAL_PAGE_MAP 0
250 
251 #if BPLATFORM(IOS_FAMILY) &amp;&amp; (BCPU(ARM64) || BCPU(ARM))
252 #define BUSE_CHECK_NANO_MALLOC 1
253 #else
254 #define BUSE_CHECK_NANO_MALLOC 0
255 #endif
256 













</pre>
</td>
<td>
<hr />
<pre>
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #include &quot;BCompiler.h&quot;
 29 
 30 #ifdef __APPLE__
 31 #include &lt;Availability.h&gt;
 32 #include &lt;AvailabilityMacros.h&gt;
 33 #include &lt;TargetConditionals.h&gt;
 34 #endif
 35 
 36 #define BPLATFORM(PLATFORM) (defined BPLATFORM_##PLATFORM &amp;&amp; BPLATFORM_##PLATFORM)
 37 #define BOS(OS) (defined BOS_##OS &amp;&amp; BOS_##OS)
 38 
 39 #ifdef __APPLE__
 40 #define BOS_DARWIN 1
 41 #endif
 42 
<span class="line-modified"> 43 #if defined(__unix) || defined(__unix__)</span>
 44 #define BOS_UNIX 1
 45 #endif
 46 
 47 #ifdef __linux__
 48 #define BOS_LINUX 1
 49 #endif
 50 
 51 #if defined(__FreeBSD__) || defined(__DragonFly__) || defined(__FreeBSD_kernel__)
 52 #define BOS_FREEBSD 1
 53 #endif
 54 
 55 #if defined(WIN32) || defined(_WIN32)
 56 #define BOS_WINDOWS 1
 57 #endif
 58 
 59 #if BOS(DARWIN) &amp;&amp; !defined(BUILDING_WITH_CMAKE)
 60 #if TARGET_OS_IOS
<span class="line-added"> 61 #define BOS_IOS 1</span>
 62 #define BPLATFORM_IOS 1
 63 #if TARGET_OS_SIMULATOR
 64 #define BPLATFORM_IOS_SIMULATOR 1
 65 #endif
 66 #endif
 67 #if TARGET_OS_IPHONE
 68 #define BPLATFORM_IOS_FAMILY 1
 69 #if TARGET_OS_SIMULATOR
 70 #define BPLATFORM_IOS_FAMILY_SIMULATOR 1
 71 #endif
 72 #elif TARGET_OS_MAC
<span class="line-added"> 73 #define BOS_MAC 1</span>
 74 #define BPLATFORM_MAC 1
 75 #endif
 76 #endif
 77 
 78 #if BPLATFORM(MAC) || BPLATFORM(IOS_FAMILY)
 79 #define BPLATFORM_COCOA 1
 80 #endif
 81 
 82 #if defined(TARGET_OS_WATCH) &amp;&amp; TARGET_OS_WATCH
<span class="line-added"> 83 #define BOS_WATCHOS 1</span>
 84 #define BPLATFORM_WATCHOS 1
 85 #endif
 86 
 87 #if defined(TARGET_OS_TV) &amp;&amp; TARGET_OS_TV
<span class="line-added"> 88 #define BOS_APPLETV 1</span>
 89 #define BPLATFORM_APPLETV 1
 90 #endif
 91 
 92 /* ==== Policy decision macros: these define policy choices for a particular port. ==== */
 93 
 94 /* BUSE() - use a particular third-party library or optional OS service */
 95 #define BUSE(FEATURE) (defined BUSE_##FEATURE &amp;&amp; BUSE_##FEATURE)
 96 
 97 /* ==== Compiler adaptation macros: these describe the capabilities of the compiler. ==== */
 98 
 99 /* BCOMPILER_SUPPORTS() - check for a compiler feature */
100 #define BCOMPILER_SUPPORTS(FEATURE) (defined BCOMPILER_SUPPORTS_##FEATURE &amp;&amp; BCOMPILER_SUPPORTS_##FEATURE)
101 
102 /* ==== Platform adaptation macros: these describe properties of the target environment. ==== */
103 
104 /* BCPU() - the target CPU architecture */
105 #define BCPU(_FEATURE) (defined BCPU_##_FEATURE  &amp;&amp; BCPU_##_FEATURE)
106 
107 /* BCPU(X86) - i386 / x86 32-bit */
108 #if defined(__i386__) \
</pre>
<hr />
<pre>
217 /* BCPU(ARM_TRADITIONAL) - Thumb2 is not available, only traditional ARM (v4 or greater) */
218 /* BCPU(ARM_THUMB2) - Thumb2 instruction set is available */
219 /* Only one of these will be defined. */
220 #if !defined(BCPU_ARM_TRADITIONAL) &amp;&amp; !defined(BCPU_ARM_THUMB2)
221 #  if defined(thumb2) || defined(__thumb2__) \
222 || ((defined(__thumb) || defined(__thumb__)) &amp;&amp; BTHUMB_ARCH_VERSION == 4)
223 #    define BCPU_ARM_TRADITIONAL 0
224 #    define BCPU_ARM_THUMB2 1
225 #  elif BARM_ARCH_AT_LEAST(4)
226 #    define BCPU_ARM_TRADITIONAL 1
227 #    define BCPU_ARM_THUMB2 0
228 #  else
229 #    error &quot;Not supported ARM architecture&quot;
230 #  endif
231 #elif BCPU(ARM_TRADITIONAL) &amp;&amp; BCPU(ARM_THUMB2) /* Sanity Check */
232 #  error &quot;Cannot use both of BCPU_ARM_TRADITIONAL and BCPU_ARM_THUMB2 platforms&quot;
233 #endif /* !defined(BCPU_ARM_TRADITIONAL) &amp;&amp; !defined(BCPU_ARM_THUMB2) */
234 
235 #endif /* ARM */
236 
<span class="line-added">237 </span>
<span class="line-added">238 #if BCOMPILER(GCC_COMPATIBLE)</span>
<span class="line-added">239 /* __LP64__ is not defined on 64bit Windows since it uses LLP64. Using __SIZEOF_POINTER__ is simpler. */</span>
<span class="line-added">240 #if __SIZEOF_POINTER__ == 8</span>
<span class="line-added">241 #define BCPU_ADDRESS64 1</span>
<span class="line-added">242 #elif __SIZEOF_POINTER__ == 4</span>
<span class="line-added">243 #define BCPU_ADDRESS32 1</span>
<span class="line-added">244 #else</span>
<span class="line-added">245 #error &quot;Unsupported pointer width&quot;</span>
<span class="line-added">246 #endif</span>
<span class="line-added">247 #else</span>
<span class="line-added">248 #error &quot;Unsupported compiler for bmalloc&quot;</span>
<span class="line-added">249 #endif</span>
<span class="line-added">250 </span>
<span class="line-added">251 #if BCOMPILER(GCC_COMPATIBLE)</span>
<span class="line-added">252 #if __BYTE_ORDER__ == __ORDER_BIG_ENDIAN__</span>
<span class="line-added">253 #define BCPU_BIG_ENDIAN 1</span>
<span class="line-added">254 #elif __BYTE_ORDER__ == __ORDER_LITTLE_ENDIAN__</span>
<span class="line-added">255 #define BCPU_LITTLE_ENDIAN 1</span>
<span class="line-added">256 #elif __BYTE_ORDER__ == __ORDER_PDP_ENDIAN__</span>
<span class="line-added">257 #define BCPU_MIDDLE_ENDIAN 1</span>
<span class="line-added">258 #else</span>
<span class="line-added">259 #error &quot;Unknown endian&quot;</span>
<span class="line-added">260 #endif</span>
<span class="line-added">261 #else</span>
<span class="line-added">262 #error &quot;Unsupported compiler for bmalloc&quot;</span>
<span class="line-added">263 #endif</span>
<span class="line-added">264 </span>
<span class="line-added">265 #if BCPU(ADDRESS64)</span>
<span class="line-added">266 #if (BOS(IOS) || BOS(TVOS) || BOS(WATCHOS)) &amp;&amp; BCPU(ARM64)</span>
<span class="line-added">267 #define BOS_EFFECTIVE_ADDRESS_WIDTH 36</span>
<span class="line-added">268 #else</span>
<span class="line-added">269 /* We strongly assume that effective address width is &lt;= 48 in 64bit architectures (e.g. NaN boxing). */</span>
<span class="line-added">270 #define BOS_EFFECTIVE_ADDRESS_WIDTH 48</span>
<span class="line-added">271 #endif</span>
<span class="line-added">272 #else</span>
<span class="line-added">273 #define BOS_EFFECTIVE_ADDRESS_WIDTH 32</span>
<span class="line-added">274 #endif</span>
<span class="line-added">275 </span>
276 #define BATTRIBUTE_PRINTF(formatStringArgument, extraArguments) __attribute__((__format__(printf, formatStringArgument, extraArguments)))
277 
278 #if BPLATFORM(MAC) || BPLATFORM(IOS_FAMILY)
279 #define BUSE_OS_LOG 1
280 #endif
281 
282 #if !defined(BUSE_EXPORT_MACROS) &amp;&amp; (BPLATFORM(MAC) || BPLATFORM(IOS_FAMILY))
283 #define BUSE_EXPORT_MACROS 1
284 #endif
285 
286 /* BUNUSED_PARAM */
287 #if !defined(BUNUSED_PARAM)
288 #define BUNUSED_PARAM(variable) (void)variable
289 #endif
290 
<span class="line-added">291 /* Enable this to put each IsoHeap and other allocation categories into their own malloc heaps, so that tools like vmmap can show how big each heap is. */</span>
<span class="line-added">292 #define BENABLE_MALLOC_HEAP_BREAKDOWN 0</span>
<span class="line-added">293 </span>
294 /* This is used for debugging when hacking on how bmalloc calculates its physical footprint. */
295 #define ENABLE_PHYSICAL_PAGE_MAP 0
296 
297 #if BPLATFORM(IOS_FAMILY) &amp;&amp; (BCPU(ARM64) || BCPU(ARM))
298 #define BUSE_CHECK_NANO_MALLOC 1
299 #else
300 #define BUSE_CHECK_NANO_MALLOC 0
301 #endif
302 
<span class="line-added">303 #if BPLATFORM(MAC)</span>
<span class="line-added">304 #define BUSE_PARTIAL_SCAVENGE 1</span>
<span class="line-added">305 #else</span>
<span class="line-added">306 #define BUSE_PARTIAL_SCAVENGE 0</span>
<span class="line-added">307 #endif</span>
<span class="line-added">308 </span>
<span class="line-added">309 #if !defined(BUSE_PRECOMPUTED_CONSTANTS_VMPAGE4K)</span>
<span class="line-added">310 #define BUSE_PRECOMPUTED_CONSTANTS_VMPAGE4K 1</span>
<span class="line-added">311 #endif</span>
<span class="line-added">312 </span>
<span class="line-added">313 #if !defined(BUSE_PRECOMPUTED_CONSTANTS_VMPAGE16K)</span>
<span class="line-added">314 #define BUSE_PRECOMPUTED_CONSTANTS_VMPAGE16K 1</span>
<span class="line-added">315 #endif</span>
</pre>
</td>
</tr>
</table>
<center><a href="AvailableMemory.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="BumpAllocator.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>