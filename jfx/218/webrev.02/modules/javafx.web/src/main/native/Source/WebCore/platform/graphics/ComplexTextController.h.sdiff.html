<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/ComplexTextController.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ComplexTextController.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="CrossfadeGeneratedImage.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/ComplexTextController.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 53 enum GlyphIterationStyle { IncludePartialGlyphs, ByWholeGlyphs };
 54 
 55 // See https://trac.webkit.org/wiki/ComplexTextController for more information about ComplexTextController.
 56 class ComplexTextController {
 57     WTF_MAKE_FAST_ALLOCATED;
 58 public:
 59     ComplexTextController(const FontCascade&amp;, const TextRun&amp;, bool mayUseNaturalWritingDirection = false, HashSet&lt;const Font*&gt;* fallbackFonts = 0, bool forTextEmphasis = false);
 60 
 61     class ComplexTextRun;
 62     WEBCORE_EXPORT ComplexTextController(const FontCascade&amp;, const TextRun&amp;, Vector&lt;Ref&lt;ComplexTextRun&gt;&gt;&amp;);
 63 
 64     // Advance and emit glyphs up to the specified character.
 65     WEBCORE_EXPORT void advance(unsigned to, GlyphBuffer* = nullptr, GlyphIterationStyle = IncludePartialGlyphs, HashSet&lt;const Font*&gt;* fallbackFonts = nullptr);
 66 
 67     // Compute the character offset for a given x coordinate.
 68     unsigned offsetForPosition(float x, bool includePartialGlyphs);
 69 
 70     // Returns the width of everything we&#39;ve consumed so far.
 71     float runWidthSoFar() const { return m_runWidthSoFar; }
 72 
<span class="line-modified"> 73     float totalWidth() const { return m_totalWidth; }</span>
 74 
 75     float minGlyphBoundingBoxX() const { return m_minGlyphBoundingBoxX; }
 76     float maxGlyphBoundingBoxX() const { return m_maxGlyphBoundingBoxX; }
 77     float minGlyphBoundingBoxY() const { return m_minGlyphBoundingBoxY; }
 78     float maxGlyphBoundingBoxY() const { return m_maxGlyphBoundingBoxY; }
 79 
 80     class ComplexTextRun : public RefCounted&lt;ComplexTextRun&gt; {
 81     public:
 82         static Ref&lt;ComplexTextRun&gt; create(CTRunRef ctRun, const Font&amp; font, const UChar* characters, unsigned stringLocation, unsigned stringLength, unsigned indexBegin, unsigned indexEnd)
 83         {
 84             return adoptRef(*new ComplexTextRun(ctRun, font, characters, stringLocation, stringLength, indexBegin, indexEnd));
 85         }
 86 
 87         static Ref&lt;ComplexTextRun&gt; create(hb_buffer_t* buffer, const Font&amp; font, const UChar* characters, unsigned stringLocation, unsigned stringLength, unsigned indexBegin, unsigned indexEnd)
 88         {
 89             return adoptRef(*new ComplexTextRun(buffer, font, characters, stringLocation, stringLength, indexBegin, indexEnd));
 90         }
 91 
 92 #if PLATFORM(JAVA)
 93         static Ref&lt;ComplexTextRun&gt; create(JLObject jRun, const Font&amp; font, const UChar* characters, unsigned stringLocation, unsigned stringLength)
</pre>
<hr />
<pre>
213 
214     // The initial capacity of these vectors was selected as being the smallest power of two greater than
215     // the average (3.5) plus one standard deviation (7.5) of nonzero sizes used on Arabic Wikipedia.
216     Vector&lt;unsigned, 16&gt; m_runIndices;
217     Vector&lt;unsigned, 16&gt; m_glyphCountFromStartToIndex;
218 
219 #if PLATFORM(COCOA)
220     Vector&lt;RetainPtr&lt;CTLineRef&gt;&gt; m_coreTextLines;
221 #endif
222 
223     Vector&lt;String&gt; m_stringsFor8BitRuns;
224 
225     HashSet&lt;const Font*&gt;* m_fallbackFonts { nullptr };
226 
227     const FontCascade&amp; m_font;
228     const TextRun&amp; m_run;
229 
230     unsigned m_currentCharacter { 0 };
231     unsigned m_end { 0 };
232 
<span class="line-modified">233     float m_totalWidth { 0 };</span>
234     float m_runWidthSoFar { 0 };
235     unsigned m_numGlyphsSoFar { 0 };
236     unsigned m_currentRun { 0 };
237     unsigned m_glyphInCurrentRun { 0 };
238     unsigned m_characterInCurrentGlyph { 0 };
239     float m_expansion { 0 };
240     float m_expansionPerOpportunity { 0 };
241 
242     float m_minGlyphBoundingBoxX { std::numeric_limits&lt;float&gt;::max() };
243     float m_maxGlyphBoundingBoxX { std::numeric_limits&lt;float&gt;::min() };
244     float m_minGlyphBoundingBoxY { std::numeric_limits&lt;float&gt;::max() };
245     float m_maxGlyphBoundingBoxY { std::numeric_limits&lt;float&gt;::min() };
246 
247     bool m_isLTROnly { true };
248     bool m_mayUseNaturalWritingDirection { false };
249     bool m_forTextEmphasis { false };
250 };
251 
252 } // namespace WebCore
</pre>
</td>
<td>
<hr />
<pre>
 53 enum GlyphIterationStyle { IncludePartialGlyphs, ByWholeGlyphs };
 54 
 55 // See https://trac.webkit.org/wiki/ComplexTextController for more information about ComplexTextController.
 56 class ComplexTextController {
 57     WTF_MAKE_FAST_ALLOCATED;
 58 public:
 59     ComplexTextController(const FontCascade&amp;, const TextRun&amp;, bool mayUseNaturalWritingDirection = false, HashSet&lt;const Font*&gt;* fallbackFonts = 0, bool forTextEmphasis = false);
 60 
 61     class ComplexTextRun;
 62     WEBCORE_EXPORT ComplexTextController(const FontCascade&amp;, const TextRun&amp;, Vector&lt;Ref&lt;ComplexTextRun&gt;&gt;&amp;);
 63 
 64     // Advance and emit glyphs up to the specified character.
 65     WEBCORE_EXPORT void advance(unsigned to, GlyphBuffer* = nullptr, GlyphIterationStyle = IncludePartialGlyphs, HashSet&lt;const Font*&gt;* fallbackFonts = nullptr);
 66 
 67     // Compute the character offset for a given x coordinate.
 68     unsigned offsetForPosition(float x, bool includePartialGlyphs);
 69 
 70     // Returns the width of everything we&#39;ve consumed so far.
 71     float runWidthSoFar() const { return m_runWidthSoFar; }
 72 
<span class="line-modified"> 73     FloatSize totalAdvance() const { return m_totalAdvance; }</span>
 74 
 75     float minGlyphBoundingBoxX() const { return m_minGlyphBoundingBoxX; }
 76     float maxGlyphBoundingBoxX() const { return m_maxGlyphBoundingBoxX; }
 77     float minGlyphBoundingBoxY() const { return m_minGlyphBoundingBoxY; }
 78     float maxGlyphBoundingBoxY() const { return m_maxGlyphBoundingBoxY; }
 79 
 80     class ComplexTextRun : public RefCounted&lt;ComplexTextRun&gt; {
 81     public:
 82         static Ref&lt;ComplexTextRun&gt; create(CTRunRef ctRun, const Font&amp; font, const UChar* characters, unsigned stringLocation, unsigned stringLength, unsigned indexBegin, unsigned indexEnd)
 83         {
 84             return adoptRef(*new ComplexTextRun(ctRun, font, characters, stringLocation, stringLength, indexBegin, indexEnd));
 85         }
 86 
 87         static Ref&lt;ComplexTextRun&gt; create(hb_buffer_t* buffer, const Font&amp; font, const UChar* characters, unsigned stringLocation, unsigned stringLength, unsigned indexBegin, unsigned indexEnd)
 88         {
 89             return adoptRef(*new ComplexTextRun(buffer, font, characters, stringLocation, stringLength, indexBegin, indexEnd));
 90         }
 91 
 92 #if PLATFORM(JAVA)
 93         static Ref&lt;ComplexTextRun&gt; create(JLObject jRun, const Font&amp; font, const UChar* characters, unsigned stringLocation, unsigned stringLength)
</pre>
<hr />
<pre>
213 
214     // The initial capacity of these vectors was selected as being the smallest power of two greater than
215     // the average (3.5) plus one standard deviation (7.5) of nonzero sizes used on Arabic Wikipedia.
216     Vector&lt;unsigned, 16&gt; m_runIndices;
217     Vector&lt;unsigned, 16&gt; m_glyphCountFromStartToIndex;
218 
219 #if PLATFORM(COCOA)
220     Vector&lt;RetainPtr&lt;CTLineRef&gt;&gt; m_coreTextLines;
221 #endif
222 
223     Vector&lt;String&gt; m_stringsFor8BitRuns;
224 
225     HashSet&lt;const Font*&gt;* m_fallbackFonts { nullptr };
226 
227     const FontCascade&amp; m_font;
228     const TextRun&amp; m_run;
229 
230     unsigned m_currentCharacter { 0 };
231     unsigned m_end { 0 };
232 
<span class="line-modified">233     FloatSize m_totalAdvance;</span>
234     float m_runWidthSoFar { 0 };
235     unsigned m_numGlyphsSoFar { 0 };
236     unsigned m_currentRun { 0 };
237     unsigned m_glyphInCurrentRun { 0 };
238     unsigned m_characterInCurrentGlyph { 0 };
239     float m_expansion { 0 };
240     float m_expansionPerOpportunity { 0 };
241 
242     float m_minGlyphBoundingBoxX { std::numeric_limits&lt;float&gt;::max() };
243     float m_maxGlyphBoundingBoxX { std::numeric_limits&lt;float&gt;::min() };
244     float m_minGlyphBoundingBoxY { std::numeric_limits&lt;float&gt;::max() };
245     float m_maxGlyphBoundingBoxY { std::numeric_limits&lt;float&gt;::min() };
246 
247     bool m_isLTROnly { true };
248     bool m_mayUseNaturalWritingDirection { false };
249     bool m_forTextEmphasis { false };
250 };
251 
252 } // namespace WebCore
</pre>
</td>
</tr>
</table>
<center><a href="ComplexTextController.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="CrossfadeGeneratedImage.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>