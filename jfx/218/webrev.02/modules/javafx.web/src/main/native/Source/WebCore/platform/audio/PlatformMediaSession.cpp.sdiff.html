<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/platform/audio/PlatformMediaSession.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MultiChannelResampler.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="PlatformMediaSession.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/platform/audio/PlatformMediaSession.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
207     setState(Autoplaying);
208 }
209 
210 bool PlatformMediaSession::clientWillBeginPlayback()
211 {
212     if (m_notifyingClient)
213         return true;
214 
215     INFO_LOG(LOGIDENTIFIER, &quot;state = &quot;, m_state);
216 
217     if (!PlatformMediaSessionManager::sharedManager().sessionWillBeginPlayback(*this)) {
218         if (state() == Interrupted)
219             m_stateToRestore = Playing;
220         return false;
221     }
222 
223     setState(Playing);
224     return true;
225 }
226 
<span class="line-modified">227 bool PlatformMediaSession::clientWillPausePlayback()</span>
228 {
229     if (m_notifyingClient)
230         return true;
231 
232     INFO_LOG(LOGIDENTIFIER, &quot;state = &quot;, m_state);
233     if (state() == Interrupted) {
234         m_stateToRestore = Paused;
235         INFO_LOG(LOGIDENTIFIER, &quot;      setting stateToRestore to \&quot;Paused\&quot;&quot;);
236         return false;
237     }
238 
239     setState(Paused);
<span class="line-modified">240     PlatformMediaSessionManager::sharedManager().sessionWillEndPlayback(*this);</span>
241     return true;
242 }
243 










244 void PlatformMediaSession::pauseSession()
245 {
246     INFO_LOG(LOGIDENTIFIER);
247     m_client.suspendPlayback();
248 }
249 
250 void PlatformMediaSession::stopSession()
251 {
252     INFO_LOG(LOGIDENTIFIER);
253     m_client.suspendPlayback();
254     PlatformMediaSessionManager::sharedManager().removeSession(*this);
255 }
256 
257 PlatformMediaSession::MediaType PlatformMediaSession::mediaType() const
258 {
259     return m_client.mediaType();
260 }
261 
262 PlatformMediaSession::MediaType PlatformMediaSession::presentationType() const
263 {
</pre>
<hr />
<pre>
341 {
342     return m_client.displayType();
343 }
344 
345 bool PlatformMediaSession::activeAudioSessionRequired() const
346 {
347     if (mediaType() == PlatformMediaSession::None)
348         return false;
349     if (state() != PlatformMediaSession::State::Playing)
350         return false;
351     return canProduceAudio();
352 }
353 
354 bool PlatformMediaSession::canProduceAudio() const
355 {
356     return m_client.canProduceAudio();
357 }
358 
359 void PlatformMediaSession::canProduceAudioChanged()
360 {
<span class="line-modified">361     PlatformMediaSessionManager::sharedManager().sessionCanProduceAudioChanged(*this);</span>
362 }
363 
364 #if ENABLE(VIDEO)
365 uint64_t PlatformMediaSessionClient::mediaSessionUniqueIdentifier() const
366 {
367     return 0;
368 }
369 
370 String PlatformMediaSessionClient::mediaSessionTitle() const
371 {
372     return String();
373 }
374 
375 double PlatformMediaSessionClient::mediaSessionDuration() const
376 {
377     return MediaPlayer::invalidTime();
378 }
379 
380 double PlatformMediaSessionClient::mediaSessionCurrentTime() const
381 {
</pre>
</td>
<td>
<hr />
<pre>
207     setState(Autoplaying);
208 }
209 
210 bool PlatformMediaSession::clientWillBeginPlayback()
211 {
212     if (m_notifyingClient)
213         return true;
214 
215     INFO_LOG(LOGIDENTIFIER, &quot;state = &quot;, m_state);
216 
217     if (!PlatformMediaSessionManager::sharedManager().sessionWillBeginPlayback(*this)) {
218         if (state() == Interrupted)
219             m_stateToRestore = Playing;
220         return false;
221     }
222 
223     setState(Playing);
224     return true;
225 }
226 
<span class="line-modified">227 bool PlatformMediaSession::processClientWillPausePlayback(DelayCallingUpdateNowPlaying shouldDelayCallingUpdateNowPlaying)</span>
228 {
229     if (m_notifyingClient)
230         return true;
231 
232     INFO_LOG(LOGIDENTIFIER, &quot;state = &quot;, m_state);
233     if (state() == Interrupted) {
234         m_stateToRestore = Paused;
235         INFO_LOG(LOGIDENTIFIER, &quot;      setting stateToRestore to \&quot;Paused\&quot;&quot;);
236         return false;
237     }
238 
239     setState(Paused);
<span class="line-modified">240     PlatformMediaSessionManager::sharedManager().sessionWillEndPlayback(*this, shouldDelayCallingUpdateNowPlaying);</span>
241     return true;
242 }
243 
<span class="line-added">244 bool PlatformMediaSession::clientWillPausePlayback()</span>
<span class="line-added">245 {</span>
<span class="line-added">246     return processClientWillPausePlayback(DelayCallingUpdateNowPlaying::No);</span>
<span class="line-added">247 }</span>
<span class="line-added">248 </span>
<span class="line-added">249 void PlatformMediaSession::clientWillBeDOMSuspended()</span>
<span class="line-added">250 {</span>
<span class="line-added">251     processClientWillPausePlayback(DelayCallingUpdateNowPlaying::Yes);</span>
<span class="line-added">252 }</span>
<span class="line-added">253 </span>
254 void PlatformMediaSession::pauseSession()
255 {
256     INFO_LOG(LOGIDENTIFIER);
257     m_client.suspendPlayback();
258 }
259 
260 void PlatformMediaSession::stopSession()
261 {
262     INFO_LOG(LOGIDENTIFIER);
263     m_client.suspendPlayback();
264     PlatformMediaSessionManager::sharedManager().removeSession(*this);
265 }
266 
267 PlatformMediaSession::MediaType PlatformMediaSession::mediaType() const
268 {
269     return m_client.mediaType();
270 }
271 
272 PlatformMediaSession::MediaType PlatformMediaSession::presentationType() const
273 {
</pre>
<hr />
<pre>
351 {
352     return m_client.displayType();
353 }
354 
355 bool PlatformMediaSession::activeAudioSessionRequired() const
356 {
357     if (mediaType() == PlatformMediaSession::None)
358         return false;
359     if (state() != PlatformMediaSession::State::Playing)
360         return false;
361     return canProduceAudio();
362 }
363 
364 bool PlatformMediaSession::canProduceAudio() const
365 {
366     return m_client.canProduceAudio();
367 }
368 
369 void PlatformMediaSession::canProduceAudioChanged()
370 {
<span class="line-modified">371     PlatformMediaSessionManager::sharedManager().sessionCanProduceAudioChanged();</span>
372 }
373 
374 #if ENABLE(VIDEO)
375 uint64_t PlatformMediaSessionClient::mediaSessionUniqueIdentifier() const
376 {
377     return 0;
378 }
379 
380 String PlatformMediaSessionClient::mediaSessionTitle() const
381 {
382     return String();
383 }
384 
385 double PlatformMediaSessionClient::mediaSessionDuration() const
386 {
387     return MediaPlayer::invalidTime();
388 }
389 
390 double PlatformMediaSessionClient::mediaSessionCurrentTime() const
391 {
</pre>
</td>
</tr>
</table>
<center><a href="MultiChannelResampler.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="PlatformMediaSession.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>