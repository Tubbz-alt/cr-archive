<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/html/HTMLInputElement.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="HTMLImageElement.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="HTMLInputElement.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/html/HTMLInputElement.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 60,11 ***</span>
  #include &quot;RenderTextControlSingleLine.h&quot;
  #include &quot;RenderTheme.h&quot;
  #include &quot;ScopedEventQueue.h&quot;
  #include &quot;SearchInputType.h&quot;
  #include &quot;Settings.h&quot;
<span class="line-modified">! #include &quot;StyleResolver.h&quot;</span>
  #include &quot;TextControlInnerElements.h&quot;
  #include &lt;wtf/IsoMallocInlines.h&gt;
  #include &lt;wtf/Language.h&gt;
  #include &lt;wtf/MathExtras.h&gt;
  #include &lt;wtf/Ref.h&gt;
<span class="line-new-header">--- 60,11 ---</span>
  #include &quot;RenderTextControlSingleLine.h&quot;
  #include &quot;RenderTheme.h&quot;
  #include &quot;ScopedEventQueue.h&quot;
  #include &quot;SearchInputType.h&quot;
  #include &quot;Settings.h&quot;
<span class="line-modified">! #include &quot;StyleGeneratedImage.h&quot;</span>
  #include &quot;TextControlInnerElements.h&quot;
  #include &lt;wtf/IsoMallocInlines.h&gt;
  #include &lt;wtf/Language.h&gt;
  #include &lt;wtf/MathExtras.h&gt;
  #include &lt;wtf/Ref.h&gt;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 171,11 ***</span>
      // This is needed for a radio button that was not in a form, and also for
      // a radio button that was in a form. The call to setForm(nullptr) above
      // actually adds the button to the document groups in the latter case.
      // That is inelegant, but harmless since we remove it here.
      if (isRadioButton())
<span class="line-modified">!         document().formController().radioButtonGroups().removeButton(*this);</span>
  
  #if ENABLE(TOUCH_EVENTS)
      if (m_hasTouchEventHandler)
          document().didRemoveEventTargetNode(*this);
  #endif
<span class="line-new-header">--- 171,11 ---</span>
      // This is needed for a radio button that was not in a form, and also for
      // a radio button that was in a form. The call to setForm(nullptr) above
      // actually adds the button to the document groups in the latter case.
      // That is inelegant, but harmless since we remove it here.
      if (isRadioButton())
<span class="line-modified">!         treeScope().radioButtonGroups().removeButton(*this);</span>
  
  #if ENABLE(TOUCH_EVENTS)
      if (m_hasTouchEventHandler)
          document().didRemoveEventTargetNode(*this);
  #endif
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1548,16 ***</span>
  }
  
  void HTMLInputElement::didFinishInsertingNode()
  {
      HTMLTextFormControlElement::didFinishInsertingNode();
<span class="line-modified">!     if (isConnected() &amp;&amp; !form())</span>
          addToRadioButtonGroup();
  }
  
  void HTMLInputElement::removedFromAncestor(RemovalType removalType, ContainerNode&amp; oldParentOfRemovedTree)
  {
      if (removalType.disconnectedFromDocument &amp;&amp; !form())
          removeFromRadioButtonGroup();
      HTMLTextFormControlElement::removedFromAncestor(removalType, oldParentOfRemovedTree);
      ASSERT(!isConnected());
  #if ENABLE(DATALIST_ELEMENT)
<span class="line-new-header">--- 1548,18 ---</span>
  }
  
  void HTMLInputElement::didFinishInsertingNode()
  {
      HTMLTextFormControlElement::didFinishInsertingNode();
<span class="line-modified">!     if (isInTreeScope() &amp;&amp; !form())</span>
          addToRadioButtonGroup();
  }
  
  void HTMLInputElement::removedFromAncestor(RemovalType removalType, ContainerNode&amp; oldParentOfRemovedTree)
  {
<span class="line-added">+     if (removalType.treeScopeChanged &amp;&amp; isRadioButton())</span>
<span class="line-added">+         oldParentOfRemovedTree.treeScope().radioButtonGroups().removeButton(*this);</span>
      if (removalType.disconnectedFromDocument &amp;&amp; !form())
          removeFromRadioButtonGroup();
      HTMLTextFormControlElement::removedFromAncestor(removalType, oldParentOfRemovedTree);
      ASSERT(!isConnected());
  #if ENABLE(DATALIST_ELEMENT)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1574,15 ***</span>
      if (needsSuspensionCallback()) {
          oldDocument.unregisterForDocumentSuspensionCallbacks(*this);
          newDocument.registerForDocumentSuspensionCallbacks(*this);
      }
  
<span class="line-removed">-     // We call this even for radio buttons in forms; it&#39;s harmless because the</span>
<span class="line-removed">-     // removeButton function is written to be safe for buttons not in any group.</span>
<span class="line-removed">-     if (isRadioButton())</span>
<span class="line-removed">-         oldDocument.formController().radioButtonGroups().removeButton(*this);</span>
<span class="line-removed">- </span>
  #if ENABLE(TOUCH_EVENTS)
      if (m_hasTouchEventHandler) {
          oldDocument.didRemoveEventTargetNode(*this);
          newDocument.didAddTouchEventHandler(*this);
      }
<span class="line-new-header">--- 1576,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1899,19 ***</span>
      if (RadioButtonGroups* buttons = radioButtonGroups())
          return buttons-&gt;isInRequiredGroup(*this);
      return false;
  }
  
<span class="line-modified">! Vector&lt;HTMLInputElement*&gt; HTMLInputElement::radioButtonGroup() const</span>
  {
      RadioButtonGroups* buttons = radioButtonGroups();
      if (!buttons)
          return { };
      return buttons-&gt;groupMembers(*this);
  }
  
<span class="line-modified">! HTMLInputElement* HTMLInputElement::checkedRadioButtonForGroup() const</span>
  {
      if (RadioButtonGroups* buttons = radioButtonGroups())
          return buttons-&gt;checkedButtonForGroup(name());
      return nullptr;
  }
<span class="line-new-header">--- 1896,19 ---</span>
      if (RadioButtonGroups* buttons = radioButtonGroups())
          return buttons-&gt;isInRequiredGroup(*this);
      return false;
  }
  
<span class="line-modified">! Vector&lt;Ref&lt;HTMLInputElement&gt;&gt; HTMLInputElement::radioButtonGroup() const</span>
  {
      RadioButtonGroups* buttons = radioButtonGroups();
      if (!buttons)
          return { };
      return buttons-&gt;groupMembers(*this);
  }
  
<span class="line-modified">! RefPtr&lt;HTMLInputElement&gt; HTMLInputElement::checkedRadioButtonForGroup() const</span>
  {
      if (RadioButtonGroups* buttons = radioButtonGroups())
          return buttons-&gt;checkedButtonForGroup(name());
      return nullptr;
  }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1920,12 ***</span>
  {
      if (!isRadioButton())
          return nullptr;
      if (auto* formElement = form())
          return &amp;formElement-&gt;radioButtonGroups();
<span class="line-modified">!     if (isConnected())</span>
<span class="line-modified">!         return &amp;document().formController().radioButtonGroups();</span>
      return nullptr;
  }
  
  inline void HTMLInputElement::addToRadioButtonGroup()
  {
<span class="line-new-header">--- 1917,12 ---</span>
  {
      if (!isRadioButton())
          return nullptr;
      if (auto* formElement = form())
          return &amp;formElement-&gt;radioButtonGroups();
<span class="line-modified">!     if (isInTreeScope())</span>
<span class="line-modified">!         return &amp;treeScope().radioButtonGroups();</span>
      return nullptr;
  }
  
  inline void HTMLInputElement::addToRadioButtonGroup()
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2057,20 ***</span>
  
  static Ref&lt;CSSLinearGradientValue&gt; autoFillStrongPasswordMaskImage()
  {
      CSSGradientColorStop firstStop;
      firstStop.m_color = CSSValuePool::singleton().createColorValue(Color::black);
<span class="line-modified">!     firstStop.m_position = CSSValuePool::singleton().createValue(50, CSSPrimitiveValue::UnitType::CSS_PERCENTAGE);</span>
  
      CSSGradientColorStop secondStop;
      secondStop.m_color = CSSValuePool::singleton().createColorValue(Color::transparent);
<span class="line-modified">!     secondStop.m_position = CSSValuePool::singleton().createValue(100, CSSPrimitiveValue::UnitType::CSS_PERCENTAGE);</span>
  
      auto gradient = CSSLinearGradientValue::create(CSSGradientRepeat::NonRepeating, CSSGradientType::CSSLinearGradient);
<span class="line-modified">!     gradient-&gt;setAngle(CSSValuePool::singleton().createValue(90, CSSPrimitiveValue::UnitType::CSS_DEG));</span>
      gradient-&gt;addStop(firstStop);
      gradient-&gt;addStop(secondStop);
      return gradient;
  }
  
  RenderStyle HTMLInputElement::createInnerTextStyle(const RenderStyle&amp; style)
  {
<span class="line-new-header">--- 2054,22 ---</span>
  
  static Ref&lt;CSSLinearGradientValue&gt; autoFillStrongPasswordMaskImage()
  {
      CSSGradientColorStop firstStop;
      firstStop.m_color = CSSValuePool::singleton().createColorValue(Color::black);
<span class="line-modified">!     firstStop.m_position = CSSValuePool::singleton().createValue(50, CSSUnitType::CSS_PERCENTAGE);</span>
  
      CSSGradientColorStop secondStop;
      secondStop.m_color = CSSValuePool::singleton().createColorValue(Color::transparent);
<span class="line-modified">!     secondStop.m_position = CSSValuePool::singleton().createValue(100, CSSUnitType::CSS_PERCENTAGE);</span>
  
      auto gradient = CSSLinearGradientValue::create(CSSGradientRepeat::NonRepeating, CSSGradientType::CSSLinearGradient);
<span class="line-modified">!     gradient-&gt;setAngle(CSSValuePool::singleton().createValue(90, CSSUnitType::CSS_DEG));</span>
      gradient-&gt;addStop(firstStop);
      gradient-&gt;addStop(secondStop);
<span class="line-added">+     gradient-&gt;resolveRGBColors();</span>
<span class="line-added">+ </span>
      return gradient;
  }
  
  RenderStyle HTMLInputElement::createInnerTextStyle(const RenderStyle&amp; style)
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2089,14 ***</span>
      if (hasAutoFillStrongPasswordButton() &amp;&amp; !isDisabledOrReadOnly()) {
          textBlockStyle.setDisplay(DisplayType::InlineBlock);
          textBlockStyle.setMaxWidth(Length { 100, Percent });
          textBlockStyle.setColor({ 0.0f, 0.0f, 0.0f, 0.6f });
          textBlockStyle.setTextOverflow(TextOverflow::Clip);
<span class="line-modified">!         textBlockStyle.setMaskImage(styleResolver().styleImage(autoFillStrongPasswordMaskImage()));</span>
          // A stacking context is needed for the mask.
<span class="line-modified">!         if (textBlockStyle.hasAutoZIndex())</span>
<span class="line-modified">!             textBlockStyle.setZIndex(0);</span>
      }
  
      // Do not allow line-height to be smaller than our default.
      if (textBlockStyle.fontMetrics().lineSpacing() &gt; style.computedLineHeight())
          textBlockStyle.setLineHeight(RenderStyle::initialLineHeight());
<span class="line-new-header">--- 2088,14 ---</span>
      if (hasAutoFillStrongPasswordButton() &amp;&amp; !isDisabledOrReadOnly()) {
          textBlockStyle.setDisplay(DisplayType::InlineBlock);
          textBlockStyle.setMaxWidth(Length { 100, Percent });
          textBlockStyle.setColor({ 0.0f, 0.0f, 0.0f, 0.6f });
          textBlockStyle.setTextOverflow(TextOverflow::Clip);
<span class="line-modified">!         textBlockStyle.setMaskImage(StyleGeneratedImage::create(autoFillStrongPasswordMaskImage()));</span>
          // A stacking context is needed for the mask.
<span class="line-modified">!         if (textBlockStyle.hasAutoUsedZIndex())</span>
<span class="line-modified">!             textBlockStyle.setUsedZIndex(0);</span>
      }
  
      // Do not allow line-height to be smaller than our default.
      if (textBlockStyle.fontMetrics().lineSpacing() &gt; style.computedLineHeight())
          textBlockStyle.setLineHeight(RenderStyle::initialLineHeight());
</pre>
<center><a href="HTMLImageElement.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="HTMLInputElement.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>