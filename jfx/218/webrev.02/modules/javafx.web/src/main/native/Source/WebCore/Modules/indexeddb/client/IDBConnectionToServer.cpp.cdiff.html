<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/Modules/indexeddb/client/IDBConnectionToServer.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="IDBConnectionProxy.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="IDBConnectionToServer.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/Modules/indexeddb/client/IDBConnectionToServer.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 52,11 ***</span>
      : m_delegate(makeWeakPtr(delegate))
      , m_proxy(makeUnique&lt;IDBConnectionProxy&gt;(*this))
  {
  }
  
<span class="line-modified">! uint64_t IDBConnectionToServer::identifier() const</span>
  {
      return m_delegate-&gt;identifier();
  }
  
  IDBConnectionProxy&amp; IDBConnectionToServer::proxy()
<span class="line-new-header">--- 52,11 ---</span>
      : m_delegate(makeWeakPtr(delegate))
      , m_proxy(makeUnique&lt;IDBConnectionProxy&gt;(*this))
  {
  }
  
<span class="line-modified">! IDBConnectionIdentifier IDBConnectionToServer::identifier() const</span>
  {
      return m_delegate-&gt;identifier();
  }
  
  IDBConnectionProxy&amp; IDBConnectionToServer::proxy()
</pre>
<hr />
<pre>
<span class="line-old-header">*** 72,11 ***</span>
      });
  }
  
  void IDBConnectionToServer::deleteDatabase(const IDBRequestData&amp; request)
  {
<span class="line-modified">!     LOG(IndexedDB, &quot;IDBConnectionToServer::deleteDatabase - %s&quot;, request.databaseIdentifier().debugString().utf8().data());</span>
  
      if (m_serverConnectionIsValid)
          m_delegate-&gt;deleteDatabase(request);
      else
          callResultFunctionWithErrorLater(&amp;IDBConnectionToServer::didDeleteDatabase, request.requestIdentifier());
<span class="line-new-header">--- 72,11 ---</span>
      });
  }
  
  void IDBConnectionToServer::deleteDatabase(const IDBRequestData&amp; request)
  {
<span class="line-modified">!     LOG(IndexedDB, &quot;IDBConnectionToServer::deleteDatabase - %s&quot;, request.databaseIdentifier().loggingString().utf8().data());</span>
  
      if (m_serverConnectionIsValid)
          m_delegate-&gt;deleteDatabase(request);
      else
          callResultFunctionWithErrorLater(&amp;IDBConnectionToServer::didDeleteDatabase, request.requestIdentifier());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 88,11 ***</span>
      m_proxy-&gt;didDeleteDatabase(resultData);
  }
  
  void IDBConnectionToServer::openDatabase(const IDBRequestData&amp; request)
  {
<span class="line-modified">!     LOG(IndexedDB, &quot;IDBConnectionToServer::openDatabase - %s (%s) (%&quot; PRIu64 &quot;)&quot;, request.databaseIdentifier().debugString().utf8().data(), request.requestIdentifier().loggingString().utf8().data(), request.requestedVersion());</span>
  
      if (m_serverConnectionIsValid)
          m_delegate-&gt;openDatabase(request);
      else
          callResultFunctionWithErrorLater(&amp;IDBConnectionToServer::didOpenDatabase, request.requestIdentifier());
<span class="line-new-header">--- 88,11 ---</span>
      m_proxy-&gt;didDeleteDatabase(resultData);
  }
  
  void IDBConnectionToServer::openDatabase(const IDBRequestData&amp; request)
  {
<span class="line-modified">!     LOG(IndexedDB, &quot;IDBConnectionToServer::openDatabase - %s (%s) (%&quot; PRIu64 &quot;)&quot;, request.databaseIdentifier().loggingString().utf8().data(), request.requestIdentifier().loggingString().utf8().data(), request.requestedVersion());</span>
  
      if (m_serverConnectionIsValid)
          m_delegate-&gt;openDatabase(request);
      else
          callResultFunctionWithErrorLater(&amp;IDBConnectionToServer::didOpenDatabase, request.requestIdentifier());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 413,17 ***</span>
      ASSERT(isMainThread());
  
      m_proxy-&gt;fireVersionChangeEvent(databaseConnectionIdentifier, requestIdentifier, requestedVersion);
  }
  
<span class="line-modified">! void IDBConnectionToServer::didFireVersionChangeEvent(uint64_t databaseConnectionIdentifier, const IDBResourceIdentifier&amp; requestIdentifier)</span>
  {
      LOG(IndexedDB, &quot;IDBConnectionToServer::didFireVersionChangeEvent&quot;);
      ASSERT(isMainThread());
  
      if (m_serverConnectionIsValid)
<span class="line-modified">!         m_delegate-&gt;didFireVersionChangeEvent(databaseConnectionIdentifier, requestIdentifier);</span>
  }
  
  void IDBConnectionToServer::didStartTransaction(const IDBResourceIdentifier&amp; transactionIdentifier, const IDBError&amp; error)
  {
      LOG(IndexedDB, &quot;IDBConnectionToServer::didStartTransaction&quot;);
<span class="line-new-header">--- 413,17 ---</span>
      ASSERT(isMainThread());
  
      m_proxy-&gt;fireVersionChangeEvent(databaseConnectionIdentifier, requestIdentifier, requestedVersion);
  }
  
<span class="line-modified">! void IDBConnectionToServer::didFireVersionChangeEvent(uint64_t databaseConnectionIdentifier, const IDBResourceIdentifier&amp; requestIdentifier, const IndexedDB::ConnectionClosedOnBehalfOfServer connectionClosed)</span>
  {
      LOG(IndexedDB, &quot;IDBConnectionToServer::didFireVersionChangeEvent&quot;);
      ASSERT(isMainThread());
  
      if (m_serverConnectionIsValid)
<span class="line-modified">!         m_delegate-&gt;didFireVersionChangeEvent(databaseConnectionIdentifier, requestIdentifier, connectionClosed);</span>
  }
  
  void IDBConnectionToServer::didStartTransaction(const IDBResourceIdentifier&amp; transactionIdentifier, const IDBError&amp; error)
  {
      LOG(IndexedDB, &quot;IDBConnectionToServer::didStartTransaction&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 438,19 ***</span>
      ASSERT(isMainThread());
  
      m_proxy-&gt;didCloseFromServer(databaseConnectionIdentifier, error);
  }
  
<span class="line-removed">- void IDBConnectionToServer::confirmDidCloseFromServer(uint64_t databaseConnectionIdentifier)</span>
<span class="line-removed">- {</span>
<span class="line-removed">-     LOG(IndexedDB, &quot;IDBConnectionToServer::confirmDidCloseFromServer&quot;);</span>
<span class="line-removed">-     ASSERT(isMainThread());</span>
<span class="line-removed">- </span>
<span class="line-removed">-     if (m_serverConnectionIsValid)</span>
<span class="line-removed">-         m_delegate-&gt;confirmDidCloseFromServer(databaseConnectionIdentifier);</span>
<span class="line-removed">- }</span>
<span class="line-removed">- </span>
  void IDBConnectionToServer::connectionToServerLost(const IDBError&amp; error)
  {
      LOG(IndexedDB, &quot;IDBConnectionToServer::connectionToServerLost&quot;);
      ASSERT(isMainThread());
      ASSERT(m_serverConnectionIsValid);
<span class="line-new-header">--- 438,10 ---</span>
</pre>
<center><a href="IDBConnectionProxy.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="IDBConnectionToServer.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>