<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/dfg/DFGOSREntrypointCreationPhase.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DFGOSREntry.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="DFGOSRExit.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/dfg/DFGOSREntrypointCreationPhase.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 48,13 ***</span>
      bool run()
      {
          RELEASE_ASSERT(m_graph.m_plan.mode() == FTLForOSREntryMode);
          RELEASE_ASSERT(m_graph.m_form == ThreadedCPS);
  
<span class="line-modified">!         unsigned bytecodeIndex = m_graph.m_plan.osrEntryBytecodeIndex();</span>
          RELEASE_ASSERT(bytecodeIndex);
<span class="line-modified">!         RELEASE_ASSERT(bytecodeIndex != UINT_MAX);</span>
  
          // Needed by createPreHeader().
          m_graph.ensureCPSDominators();
  
          CodeBlock* baseline = m_graph.m_profiledBlock;
<span class="line-new-header">--- 48,13 ---</span>
      bool run()
      {
          RELEASE_ASSERT(m_graph.m_plan.mode() == FTLForOSREntryMode);
          RELEASE_ASSERT(m_graph.m_form == ThreadedCPS);
  
<span class="line-modified">!         BytecodeIndex bytecodeIndex = m_graph.m_plan.osrEntryBytecodeIndex();</span>
          RELEASE_ASSERT(bytecodeIndex);
<span class="line-modified">!         RELEASE_ASSERT(bytecodeIndex.offset());</span>
  
          // Needed by createPreHeader().
          m_graph.ensureCPSDominators();
  
          CodeBlock* baseline = m_graph.m_profiledBlock;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 90,24 ***</span>
          // executionCount to use best judgement - but that seems unnecessary since we know for
          // sure what the executionCount should be in this case.
          BasicBlock* newRoot = insertionSet.insert(0, 1);
  
          // We&#39;d really like to use an unset origin, but ThreadedCPS won&#39;t allow that.
<span class="line-modified">!         NodeOrigin origin = NodeOrigin(CodeOrigin(0), CodeOrigin(0), false);</span>
  
          Vector&lt;Node*&gt; locals(baseline-&gt;numCalleeLocals());
          for (int local = 0; local &lt; baseline-&gt;numCalleeLocals(); ++local) {
              Node* previousHead = target-&gt;variablesAtHead.local(local);
              if (!previousHead)
                  continue;
              VariableAccessData* variable = previousHead-&gt;variableAccessData();
              locals[local] = newRoot-&gt;appendNode(
                  m_graph, variable-&gt;prediction(), ExtractOSREntryLocal, origin,
<span class="line-modified">!                 OpInfo(variable-&gt;local().offset()));</span>
  
              newRoot-&gt;appendNode(
<span class="line-modified">!                 m_graph, SpecNone, MovHint, origin, OpInfo(variable-&gt;local().offset()),</span>
                  Edge(locals[local]));
          }
  
          // Now use the origin of the target, since it&#39;s not OK to exit, and we will probably hoist
          // type checks to here.
<span class="line-new-header">--- 90,24 ---</span>
          // executionCount to use best judgement - but that seems unnecessary since we know for
          // sure what the executionCount should be in this case.
          BasicBlock* newRoot = insertionSet.insert(0, 1);
  
          // We&#39;d really like to use an unset origin, but ThreadedCPS won&#39;t allow that.
<span class="line-modified">!         NodeOrigin origin = NodeOrigin(CodeOrigin(BytecodeIndex(0)), CodeOrigin(BytecodeIndex(0)), false);</span>
  
          Vector&lt;Node*&gt; locals(baseline-&gt;numCalleeLocals());
          for (int local = 0; local &lt; baseline-&gt;numCalleeLocals(); ++local) {
              Node* previousHead = target-&gt;variablesAtHead.local(local);
              if (!previousHead)
                  continue;
              VariableAccessData* variable = previousHead-&gt;variableAccessData();
              locals[local] = newRoot-&gt;appendNode(
                  m_graph, variable-&gt;prediction(), ExtractOSREntryLocal, origin,
<span class="line-modified">!                 OpInfo(variable-&gt;operand().virtualRegister()));</span>
  
              newRoot-&gt;appendNode(
<span class="line-modified">!                 m_graph, SpecNone, MovHint, origin, OpInfo(variable-&gt;operand().virtualRegister()),</span>
                  Edge(locals[local]));
          }
  
          // Now use the origin of the target, since it&#39;s not OK to exit, and we will probably hoist
          // type checks to here.
</pre>
<center><a href="DFGOSREntry.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="DFGOSRExit.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>