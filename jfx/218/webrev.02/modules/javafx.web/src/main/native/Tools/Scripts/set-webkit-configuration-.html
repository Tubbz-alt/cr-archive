<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old modules/javafx.web/src/main/native/Tools/Scripts/set-webkit-configuration</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 #!/usr/bin/env perl
  2 
  3 # Copyright (C) 2005 Apple Inc.  All rights reserved.
  4 #
  5 # Redistribution and use in source and binary forms, with or without
  6 # modification, are permitted provided that the following conditions
  7 # are met:
  8 #
  9 # 1.  Redistributions of source code must retain the above copyright
 10 #     notice, this list of conditions and the following disclaimer. 
 11 # 2.  Redistributions in binary form must reproduce the above copyright
 12 #     notice, this list of conditions and the following disclaimer in the
 13 #     documentation and/or other materials provided with the distribution. 
 14 # 3.  Neither the name of Apple Inc. (&quot;Apple&quot;) nor the names of
 15 #     its contributors may be used to endorse or promote products derived
 16 #     from this software without specific prior written permission. 
 17 #
 18 # THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS &quot;AS IS&quot; AND ANY
 19 # EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 20 # WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 21 # DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
 22 # DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 23 # (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 24 # LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 25 # ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 26 # (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 27 # THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 28 
 29 use strict;
 30 use warnings;
 31 use FindBin;
 32 use lib $FindBin::Bin;
 33 use webkitdirs;
 34 
 35 my $programName = basename($0);
 36 my $usage = &lt;&lt;EOF;
 37 Usage: $programName [options]
 38   --32-bit                Set the default architecture to 32-bit
 39   --64-bit                Set the default architecture to 64-bit
 40   --[no-]asan             Enable or disable clang address sanitizer
 41   --lto-mode=&lt;mode&gt;       Set LTO mode: full, thin, or none
 42   --debug                 Set the default configuration to debug
 43   --release               Set the default configuration to release
 44   --reset                 Reset configurations
 45 EOF
 46 
 47 my $configuration = passedConfiguration();
 48 my $architecture = passedArchitecture();
 49 my $enableASAN = checkForArgumentAndRemoveFromARGV(&quot;--asan&quot;);
 50 my $disableASAN = checkForArgumentAndRemoveFromARGV(&quot;--no-asan&quot;);
 51 my $ltoMode;
 52 if (!checkForArgumentAndRemoveFromARGVGettingValue(&quot;--lto-mode&quot;, \$ltoMode)) {
 53     $ltoMode=&quot;&quot;;
 54 }
 55 
 56 if (!$architecture) {
 57     # Handle --64-bit explicitly here, as we don&#39;t want our other scripts to accept it
 58     for my $i (0 .. $#ARGV) {
 59         my $opt = $ARGV[$i];
 60         if ($opt =~ /^--64-bit$/i) {
 61             splice(@ARGV, $i, 1);
 62             $architecture = &#39;x86_64&#39;;
 63         }
 64     }
 65 }
 66 
 67 my $baseProductDir = baseProductDir();
 68 system &quot;mkdir&quot;, &quot;-p&quot;, &quot;$baseProductDir&quot;;
 69 
 70 if (checkForArgumentAndRemoveFromARGV(&quot;--reset&quot;)) {
 71     unlink &quot;$baseProductDir/Configuration&quot;;
 72     unlink &quot;$baseProductDir/Architecture&quot;;
 73     unlink &quot;$baseProductDir/ASan&quot;;
 74     unlink &quot;$baseProductDir/LTO&quot;;
 75     exit 0;
 76 }
 77 
 78 if ((!$configuration &amp;&amp; !$architecture &amp;&amp; !$enableASAN &amp;&amp; !$disableASAN &amp;&amp; !$ltoMode) || ($enableASAN &amp;&amp; $disableASAN)) {
 79     print STDERR $usage;
 80     exit 1;
 81 }
 82 
 83 if ($ltoMode &amp;&amp; $ltoMode ne &quot;full&quot; &amp;&amp; $ltoMode ne &quot;thin&quot; &amp;&amp; $ltoMode ne &quot;none&quot;) {
 84     print STDERR $usage;
 85     exit 1;
 86 }
 87 
 88 if ($configuration) {
 89     open CONFIGURATION, &quot;&gt;&quot;, &quot;$baseProductDir/Configuration&quot; or die;
 90     print CONFIGURATION $configuration;
 91     close CONFIGURATION;
 92 }
 93 
 94 if ($architecture) {
 95     if ($architecture ne &quot;x86_64&quot;) {
 96         open ARCHITECTURE, &quot;&gt;&quot;, &quot;$baseProductDir/Architecture&quot; or die;
 97         print ARCHITECTURE $architecture;
 98         close ARCHITECTURE;
 99     } else {
100         unlink &quot;$baseProductDir/Architecture&quot;;
101     }
102 }
103 
104 if ($enableASAN) {
105     open ASAN, &quot;&gt;&quot;, &quot;$baseProductDir/ASan&quot; or die;
106     print ASAN &quot;YES&quot;;
107     close ASAN;
108 } elsif ($disableASAN) {
109     unlink &quot;$baseProductDir/ASan&quot;;
110 }
111 
112 if ($ltoMode) {
113     open LTO, &quot;&gt;&quot;, &quot;$baseProductDir/LTO&quot; or die;
114     print LTO &quot;$ltoMode&quot;;
115     close LTO;
116 }
    </pre>
  </body>
</html>