<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebKitLegacy/java/WebCoreSupport/WebPage.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="VisitedLinkStoreJava.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="WebPage.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebKitLegacy/java/WebCoreSupport/WebPage.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 55,10 ***</span>
<span class="line-new-header">--- 55,11 ---</span>
  #include &lt;JavaScriptCore/Options.h&gt;
  #include &lt;WebCore/BackForwardController.h&gt;
  #include &lt;WebCore/BridgeUtils.h&gt;
  #include &lt;WebCore/CharacterData.h&gt;
  #include &lt;WebCore/Chrome.h&gt;
<span class="line-added">+ #include &lt;WebCore/CompositionHighlight.h&gt;</span>
  #include &lt;WebCore/ContextMenu.h&gt;
  #include &lt;WebCore/ContextMenuController.h&gt;
  #include &lt;WebCore/CookieJar.h&gt;
  #include &lt;WebCore/DeprecatedGlobalSettings.h&gt;
  #include &lt;WebCore/Document.h&gt;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 246,11 ***</span>
  {
      if (m_rootLayer) {
          return;
      }
  
<span class="line-modified">!     DBG_CHECKPOINTEX(&quot;twkUpdateContent&quot;, 15, 100);</span>
  
      RefPtr&lt;Frame&gt; mainFrame((Frame*)&amp;m_page-&gt;mainFrame());
      RefPtr&lt;FrameView&gt; frameView(mainFrame-&gt;view());
      if (!frameView) {
          return;
<span class="line-new-header">--- 247,11 ---</span>
  {
      if (m_rootLayer) {
          return;
      }
  
<span class="line-modified">!     // DBG_CHECKPOINTEX(&quot;twkUpdateContent&quot;, 15, 100);</span>
  
      RefPtr&lt;Frame&gt; mainFrame((Frame*)&amp;m_page-&gt;mainFrame());
      RefPtr&lt;FrameView&gt; frameView(mainFrame-&gt;view());
      if (!frameView) {
          return;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 259,11 ***</span>
      // Will be deleted by GraphicsContext destructor
      PlatformContextJava* ppgc = new PlatformContextJava(rq, jRenderTheme());
      GraphicsContext gc(ppgc);
  
      // TODO: Following JS synchronization is not necessary for single thread model
<span class="line-modified">!     JSGlobalContextRef globalContext = toGlobalRef(mainFrame-&gt;script().globalObject(mainThreadNormalWorld())-&gt;globalExec());</span>
      JSC::JSLockHolder sw(toJS(globalContext)); // TODO-java: was JSC::APIEntryShim sw( toJS(globalContext) );
  
      frameView-&gt;paint(gc, IntRect(x, y, w, h));
      if (m_page-&gt;settings().showDebugBorders()) {
          drawDebugLed(gc, IntRect(x, y, w, h), Color(0, 0, 255, 128));
<span class="line-new-header">--- 260,11 ---</span>
      // Will be deleted by GraphicsContext destructor
      PlatformContextJava* ppgc = new PlatformContextJava(rq, jRenderTheme());
      GraphicsContext gc(ppgc);
  
      // TODO: Following JS synchronization is not necessary for single thread model
<span class="line-modified">!     JSGlobalContextRef globalContext = toGlobalRef(mainFrame-&gt;script().globalObject(mainThreadNormalWorld()));</span>
      JSC::JSLockHolder sw(toJS(globalContext)); // TODO-java: was JSC::APIEntryShim sw( toJS(globalContext) );
  
      frameView-&gt;paint(gc, IntRect(x, y, w, h));
      if (m_page-&gt;settings().showDebugBorders()) {
          drawDebugLed(gc, IntRect(x, y, w, h), Color(0, 0, 255, 128));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 451,15 ***</span>
  void WebPage::notifyFlushRequired(const GraphicsLayer*)
  {
      markForSync();
  }
  
<span class="line-modified">! void WebPage::paintContents(const GraphicsLayer*,</span>
<span class="line-removed">-                    GraphicsContext&amp; context,</span>
<span class="line-removed">-                    OptionSet&lt;GraphicsLayerPaintingPhase&gt;,</span>
<span class="line-removed">-                    const FloatRect&amp; inClip,</span>
<span class="line-removed">-                    GraphicsLayerPaintBehavior)</span>
  {
      context.save();
      context.clip(inClip);
      m_page-&gt;mainFrame().view()-&gt;paint(context, enclosingIntRect(inClip));
      if (m_page-&gt;settings().showDebugBorders()) {
<span class="line-new-header">--- 452,11 ---</span>
  void WebPage::notifyFlushRequired(const GraphicsLayer*)
  {
      markForSync();
  }
  
<span class="line-modified">! void WebPage::paintContents(const GraphicsLayer*, GraphicsContext&amp; context, const FloatRect&amp; inClip, GraphicsLayerPaintBehavior)</span>
  {
      context.save();
      context.clip(inClip);
      m_page-&gt;mainFrame().view()-&gt;paint(context, enclosingIntRect(inClip));
      if (m_page-&gt;settings().showDebugBorders()) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 868,24 ***</span>
  
      JLObject jlself(self, true);
  
      //utaTODO: history agent implementation
  
<span class="line-modified">!     auto pc = pageConfigurationWithEmptyClients();</span>
      auto pageStorageSessionProvider = PageStorageSessionProvider::create();
      pc.cookieJar = CookieJar::create(pageStorageSessionProvider.copyRef());
      pc.chromeClient = new ChromeClientJava(jlself);
      pc.contextMenuClient = new ContextMenuClientJava(jlself);
      pc.editorClient = makeUniqueRef&lt;EditorClientJava&gt;(jlself);
<span class="line-modified">!     pc.dragClient = new DragClientJava(jlself);</span>
      pc.inspectorClient = new InspectorClientJava(jlself);
      pc.databaseProvider = &amp;WebDatabaseProvider::singleton();
      pc.storageNamespaceProvider = adoptRef(new WebStorageNamespaceProviderJava());
      pc.visitedLinkStore = VisitedLinkStoreJava::create();
  
      pc.loaderClientForMainFrame = new FrameLoaderClientJava(jlself);
<span class="line-modified">!     pc.progressTrackerClient = new ProgressTrackerClientJava(jlself);</span>
  
      pc.backForwardClient = BackForwardList::create();
      auto page = std::make_unique&lt;Page&gt;(WTFMove(pc));
      // Associate PageSupplementJava instance which has WebPage java object.
      page-&gt;provideSupplement(PageSupplementJava::supplementName(), std::make_unique&lt;PageSupplementJava&gt;(self));
<span class="line-new-header">--- 865,24 ---</span>
  
      JLObject jlself(self, true);
  
      //utaTODO: history agent implementation
  
<span class="line-modified">!     auto pc = pageConfigurationWithEmptyClients(PAL::SessionID::defaultSessionID());</span>
      auto pageStorageSessionProvider = PageStorageSessionProvider::create();
      pc.cookieJar = CookieJar::create(pageStorageSessionProvider.copyRef());
      pc.chromeClient = new ChromeClientJava(jlself);
      pc.contextMenuClient = new ContextMenuClientJava(jlself);
      pc.editorClient = makeUniqueRef&lt;EditorClientJava&gt;(jlself);
<span class="line-modified">!     pc.dragClient = makeUnique&lt;DragClientJava&gt;(jlself);</span>
      pc.inspectorClient = new InspectorClientJava(jlself);
      pc.databaseProvider = &amp;WebDatabaseProvider::singleton();
      pc.storageNamespaceProvider = adoptRef(new WebStorageNamespaceProviderJava());
      pc.visitedLinkStore = VisitedLinkStoreJava::create();
  
      pc.loaderClientForMainFrame = new FrameLoaderClientJava(jlself);
<span class="line-modified">!     pc.progressTrackerClient = makeUniqueRef&lt;ProgressTrackerClientJava&gt;(jlself);</span>
  
      pc.backForwardClient = BackForwardList::create();
      auto page = std::make_unique&lt;Page&gt;(WTFMove(pc));
      // Associate PageSupplementJava instance which has WebPage java object.
      page-&gt;provideSupplement(PageSupplementJava::supplementName(), std::make_unique&lt;PageSupplementJava&gt;(self));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1112,15 ***</span>
          return;
      }
  
      static const URL emptyParent;
  
<span class="line-modified">!     frame-&gt;loader().load(FrameLoadRequest(</span>
          *frame,
          ResourceRequest(URL(emptyParent, String(env, url))),
          ShouldOpenExternalURLsPolicy::ShouldNotAllow // TODO-java: recheck policy value
<span class="line-modified">!     ));</span>
  }
  
  JNIEXPORT void JNICALL Java_com_sun_webkit_WebPage_twkLoad
      (JNIEnv* env, jobject self, jlong pFrame, jstring text, jstring contentType)
  {
<span class="line-new-header">--- 1109,17 ---</span>
          return;
      }
  
      static const URL emptyParent;
  
<span class="line-modified">!     FrameLoadRequest frameLoadRequest(</span>
          *frame,
          ResourceRequest(URL(emptyParent, String(env, url))),
          ShouldOpenExternalURLsPolicy::ShouldNotAllow // TODO-java: recheck policy value
<span class="line-modified">!     );</span>
<span class="line-added">+     frameLoadRequest.setIsRequestFromClientOrUserInput();</span>
<span class="line-added">+     frame-&gt;loader().load(WTFMove(frameLoadRequest));</span>
  }
  
  JNIEXPORT void JNICALL Java_com_sun_webkit_WebPage_twkLoad
      (JNIEnv* env, jobject self, jlong pFrame, jstring text, jstring contentType)
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1133,20 ***</span>
      size_t stringLen = (size_t)env-&gt;GetStringUTFLength(text);
      RefPtr&lt;SharedBuffer&gt; buffer = SharedBuffer::create(stringChars, (int)stringLen);
  
      static const URL emptyUrl({ }, &quot;&quot;);
      ResourceResponse response(URL(), String(env, contentType), stringLen, &quot;UTF-8&quot;);
<span class="line-modified">!     frame-&gt;loader().load(FrameLoadRequest(</span>
          *frame,
          ResourceRequest(emptyUrl),
          ShouldOpenExternalURLsPolicy::ShouldNotAllow, // TODO-java: recheck policy value
          SubstituteData(
              WTFMove(buffer),
              URL(),
              response,
              SubstituteData::SessionHistoryVisibility::Visible) // TODO-java: or Hidden?
<span class="line-modified">!     ));</span>
  
      env-&gt;ReleaseStringUTFChars(text, stringChars);
  }
  
  JNIEXPORT jboolean JNICALL Java_com_sun_webkit_WebPage_twkIsLoading
<span class="line-new-header">--- 1132,22 ---</span>
      size_t stringLen = (size_t)env-&gt;GetStringUTFLength(text);
      RefPtr&lt;SharedBuffer&gt; buffer = SharedBuffer::create(stringChars, (int)stringLen);
  
      static const URL emptyUrl({ }, &quot;&quot;);
      ResourceResponse response(URL(), String(env, contentType), stringLen, &quot;UTF-8&quot;);
<span class="line-modified">!     FrameLoadRequest frameLoadRequest(</span>
          *frame,
          ResourceRequest(emptyUrl),
          ShouldOpenExternalURLsPolicy::ShouldNotAllow, // TODO-java: recheck policy value
          SubstituteData(
              WTFMove(buffer),
              URL(),
              response,
              SubstituteData::SessionHistoryVisibility::Visible) // TODO-java: or Hidden?
<span class="line-modified">!     );</span>
<span class="line-added">+     frameLoadRequest.setIsRequestFromClientOrUserInput();</span>
<span class="line-added">+     frame-&gt;loader().load(WTFMove(frameLoadRequest));</span>
  
      env-&gt;ReleaseStringUTFChars(text, stringChars);
  }
  
  JNIEXPORT jboolean JNICALL Java_com_sun_webkit_WebPage_twkIsLoading
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1305,30 ***</span>
          settings.setSansSerifFontFamily(nativePropertyValue);
      } else if (nativePropertyName == &quot;WebKitFixedFontFamily&quot;) {
          settings.setFixedFontFamily(nativePropertyValue);
      } else if (nativePropertyName == &quot;WebKitShowsURLsInToolTips&quot;) {
          settings.setShowsURLsInToolTips(nativePropertyValue.toInt());
<span class="line-removed">-     } else if (nativePropertyName == &quot;WebKitUsesPageCachePreferenceKey&quot;) {</span>
<span class="line-removed">-         settings.setUsesPageCache(nativePropertyValue.toInt() != 0);</span>
      } else if (nativePropertyName == &quot;WebKitJavaScriptCanAccessClipboardPreferenceKey&quot;) {
          settings.setJavaScriptCanAccessClipboard(nativePropertyValue.toInt() != 0);
      } else if (nativePropertyName == &quot;enableColorFilter&quot;) {
          settings.setColorFilterEnabled(nativePropertyValue == &quot;true&quot;);
      } else if (nativePropertyName == &quot;enableKeygenElement&quot;) {
          // removed from Chrome, Firefox, and the HTML specification in 2017.
          // https://trac.webkit.org/changeset/248960/webkit
          RuntimeEnabledFeatures::sharedFeatures().setKeygenElementEnabled(nativePropertyValue == &quot;true&quot;);
      } else if (nativePropertyName == &quot;experimental:WebAnimationsCSSIntegrationEnabled&quot;) {
          RuntimeEnabledFeatures::sharedFeatures().setWebAnimationsCSSIntegrationEnabled(nativePropertyValue == &quot;true&quot;);
      } else if (nativePropertyName == &quot;enableIntersectionObserver&quot;) {
  #if ENABLE(INTERSECTION_OBSERVER)
          RuntimeEnabledFeatures::sharedFeatures().setIntersectionObserverEnabled(nativePropertyValue == &quot;true&quot;);
  #endif
<span class="line-modified">!     } else if(nativePropertyName == &quot;jscOptions&quot; &amp;&amp; !nativePropertyValue.isEmpty()) {</span>
          JSC::Options::setOptions(nativePropertyValue.utf8().data());
<span class="line-removed">-     } else if(nativePropertyName == &quot;experimental:CSSCustomPropertiesAndValuesEnabled&quot;) {</span>
<span class="line-removed">-         RuntimeEnabledFeatures::sharedFeatures().setCSSCustomPropertiesAndValuesEnabled(nativePropertyValue == &quot;true&quot;);</span>
      }
  }
  
  JNIEXPORT void JNICALL Java_com_sun_webkit_WebPage_twkResetToConsistentStateBeforeTesting
      (JNIEnv* env, jobject self, jlong pPage)
<span class="line-new-header">--- 1306,34 ---</span>
          settings.setSansSerifFontFamily(nativePropertyValue);
      } else if (nativePropertyName == &quot;WebKitFixedFontFamily&quot;) {
          settings.setFixedFontFamily(nativePropertyValue);
      } else if (nativePropertyName == &quot;WebKitShowsURLsInToolTips&quot;) {
          settings.setShowsURLsInToolTips(nativePropertyValue.toInt());
      } else if (nativePropertyName == &quot;WebKitJavaScriptCanAccessClipboardPreferenceKey&quot;) {
          settings.setJavaScriptCanAccessClipboard(nativePropertyValue.toInt() != 0);
<span class="line-added">+     } else if (nativePropertyName == &quot;allowTopNavigationToDataURLs&quot;) {</span>
<span class="line-added">+         settings.setAllowTopNavigationToDataURLs(nativePropertyValue == &quot;true&quot;);</span>
<span class="line-added">+     } else if (nativePropertyName == &quot;enableBackForwardCache&quot;) {</span>
<span class="line-added">+         settings.setUsesBackForwardCache(nativePropertyValue == &quot;true&quot;);</span>
      } else if (nativePropertyName == &quot;enableColorFilter&quot;) {
          settings.setColorFilterEnabled(nativePropertyValue == &quot;true&quot;);
      } else if (nativePropertyName == &quot;enableKeygenElement&quot;) {
          // removed from Chrome, Firefox, and the HTML specification in 2017.
          // https://trac.webkit.org/changeset/248960/webkit
          RuntimeEnabledFeatures::sharedFeatures().setKeygenElementEnabled(nativePropertyValue == &quot;true&quot;);
      } else if (nativePropertyName == &quot;experimental:WebAnimationsCSSIntegrationEnabled&quot;) {
          RuntimeEnabledFeatures::sharedFeatures().setWebAnimationsCSSIntegrationEnabled(nativePropertyValue == &quot;true&quot;);
<span class="line-added">+     } else if (nativePropertyName == &quot;experimental:CSSCustomPropertiesAndValuesEnabled&quot;) {</span>
<span class="line-added">+         RuntimeEnabledFeatures::sharedFeatures().setCSSCustomPropertiesAndValuesEnabled(nativePropertyValue == &quot;true&quot;);</span>
      } else if (nativePropertyName == &quot;enableIntersectionObserver&quot;) {
  #if ENABLE(INTERSECTION_OBSERVER)
          RuntimeEnabledFeatures::sharedFeatures().setIntersectionObserverEnabled(nativePropertyValue == &quot;true&quot;);
  #endif
<span class="line-modified">!     } else if (nativePropertyName == &quot;experimental:RequestIdleCallbackEnabled&quot;) {</span>
<span class="line-added">+         settings.setRequestIdleCallbackEnabled(nativePropertyValue == &quot;true&quot;);</span>
<span class="line-added">+     } else if (nativePropertyName == &quot;jscOptions&quot; &amp;&amp; !nativePropertyValue.isEmpty()) {</span>
          JSC::Options::setOptions(nativePropertyValue.utf8().data());
      }
  }
  
  JNIEXPORT void JNICALL Java_com_sun_webkit_WebPage_twkResetToConsistentStateBeforeTesting
      (JNIEnv* env, jobject self, jlong pPage)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1363,14 ***</span>
      // settings.setCacheModel(WebCacheModelDocumentBrowser);
      settings.setXSSAuditorEnabled(false);
      settings.setExperimentalNotificationsEnabled(false);
      settings.setPluginsEnabled(true);
      settings.setTextAreasAreResizable(true);
<span class="line-modified">!     settings.setUsesPageCache(false);</span>
      settings.setCSSOMViewScrollingAPIEnabled(true);
  
      // settings.setPrivateBrowsingEnabled(false);
      settings.setAuthorAndUserStylesEnabled(true);
      // Shrinks standalone images to fit: YES
      settings.setJavaScriptCanOpenWindowsAutomatically(true);
      settings.setJavaScriptCanAccessClipboard(true);
      settings.setOfflineWebApplicationCacheEnabled(true);
<span class="line-new-header">--- 1368,16 ---</span>
      // settings.setCacheModel(WebCacheModelDocumentBrowser);
      settings.setXSSAuditorEnabled(false);
      settings.setExperimentalNotificationsEnabled(false);
      settings.setPluginsEnabled(true);
      settings.setTextAreasAreResizable(true);
<span class="line-modified">!     settings.setUsesBackForwardCache(false);</span>
      settings.setCSSOMViewScrollingAPIEnabled(true);
<span class="line-added">+     settings.setRequestIdleCallbackEnabled(true);</span>
  
      // settings.setPrivateBrowsingEnabled(false);
<span class="line-added">+     settings.setAllowTopNavigationToDataURLs(true);</span>
      settings.setAuthorAndUserStylesEnabled(true);
      // Shrinks standalone images to fit: YES
      settings.setJavaScriptCanOpenWindowsAutomatically(true);
      settings.setJavaScriptCanAccessClipboard(true);
      settings.setOfflineWebApplicationCacheEnabled(true);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1389,11 ***</span>
      // settings.setCSSRegionsEnabled(true);
      // Set uses HTML5 parser quirks: NO
      // Async spellcheck: NO
      DeprecatedGlobalSettings::setMockScrollbarsEnabled(true);
  
<span class="line-modified">! </span>
      RuntimeEnabledFeatures::sharedFeatures().setFetchAPIEnabled(true);
      RuntimeEnabledFeatures::sharedFeatures().setShadowDOMEnabled(true);
      RuntimeEnabledFeatures::sharedFeatures().setCustomElementsEnabled(true);
      RuntimeEnabledFeatures::sharedFeatures().setModernMediaControlsEnabled(false);
      RuntimeEnabledFeatures::sharedFeatures().setResourceTimingEnabled(true);
<span class="line-new-header">--- 1396,11 ---</span>
      // settings.setCSSRegionsEnabled(true);
      // Set uses HTML5 parser quirks: NO
      // Async spellcheck: NO
      DeprecatedGlobalSettings::setMockScrollbarsEnabled(true);
  
<span class="line-modified">!     RuntimeEnabledFeatures::sharedFeatures().setHighlightAPIEnabled(true);</span>
      RuntimeEnabledFeatures::sharedFeatures().setFetchAPIEnabled(true);
      RuntimeEnabledFeatures::sharedFeatures().setShadowDOMEnabled(true);
      RuntimeEnabledFeatures::sharedFeatures().setCustomElementsEnabled(true);
      RuntimeEnabledFeatures::sharedFeatures().setModernMediaControlsEnabled(false);
      RuntimeEnabledFeatures::sharedFeatures().setResourceTimingEnabled(true);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1402,11 ***</span>
      RuntimeEnabledFeatures::sharedFeatures().setInspectorAdditionsEnabled(true);
      RuntimeEnabledFeatures::sharedFeatures().setWebAnimationsEnabled(true);
      // RuntimeEnabledFeatures::sharedFeatures().clearNetworkLoaderSession();
  
      Frame&amp; coreFrame = page-&gt;mainFrame();
<span class="line-modified">!     auto globalContext = toGlobalRef(coreFrame.script().globalObject(mainThreadNormalWorld())-&gt;globalExec());</span>
      WebCoreTestSupport::resetInternalsObject(globalContext);
  }
  
  JNIEXPORT jfloat JNICALL Java_com_sun_webkit_WebPage_twkGetZoomFactor
      (JNIEnv* env, jobject self, jlong pFrame, jboolean textOnly)
<span class="line-new-header">--- 1409,11 ---</span>
      RuntimeEnabledFeatures::sharedFeatures().setInspectorAdditionsEnabled(true);
      RuntimeEnabledFeatures::sharedFeatures().setWebAnimationsEnabled(true);
      // RuntimeEnabledFeatures::sharedFeatures().clearNetworkLoaderSession();
  
      Frame&amp; coreFrame = page-&gt;mainFrame();
<span class="line-modified">!     auto globalContext = toGlobalRef(coreFrame.script().globalObject(mainThreadNormalWorld()));</span>
      WebCoreTestSupport::resetInternalsObject(globalContext);
  }
  
  JNIEXPORT jfloat JNICALL Java_com_sun_webkit_WebPage_twkGetZoomFactor
      (JNIEnv* env, jobject self, jlong pFrame, jboolean textOnly)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1635,10 ***</span>
<span class="line-new-header">--- 1642,16 ---</span>
      (JNIEnv* env, jobject self, jlong pPage, jobject rq, jint x, jint y, jint w, jint h)
  {
      WebPage::webPageFromJLong(pPage)-&gt;paint(rq, x, y, w, h);
  }
  
<span class="line-added">+ JNIEXPORT void JNICALL Java_com_sun_webkit_WebPage_twkUpdateRendering</span>
<span class="line-added">+     (JNIEnv*, jobject, jlong pPage)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     WebPage::pageFromJLong(pPage)-&gt;updateRendering();</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  JNIEXPORT void JNICALL Java_com_sun_webkit_WebPage_twkPostPaint
    (JNIEnv*, jobject, jlong pPage, jobject rq, jint x, jint y, jint w, jint h)
  {
      WebPage::webPageFromJLong(pPage)-&gt;postPaint(rq, x, y, w, h);
  }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1870,11 ***</span>
                  underlines[x].color = Color(0, 0, 0);
              }
              env-&gt;ReleaseIntArrayElements(jattributes, attrs, JNI_ABORT);
          }
          String composed = String(env, jcomposed);
<span class="line-modified">!         frame-&gt;editor().setComposition(composed, underlines, caretPosition, 0);</span>
      }
      return JNI_TRUE;
  }
  
  JNIEXPORT jboolean JNICALL Java_com_sun_webkit_WebPage_twkProcessCaretPositionChange
<span class="line-new-header">--- 1883,11 ---</span>
                  underlines[x].color = Color(0, 0, 0);
              }
              env-&gt;ReleaseIntArrayElements(jattributes, attrs, JNI_ABORT);
          }
          String composed = String(env, jcomposed);
<span class="line-modified">!         frame-&gt;editor().setComposition(composed, underlines, { }, caretPosition, 0);</span>
      }
      return JNI_TRUE;
  }
  
  JNIEXPORT jboolean JNICALL Java_com_sun_webkit_WebPage_twkProcessCaretPositionChange
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2275,20 ***</span>
      (JNIEnv*, jobject, jlong pPage)
  {
      ASSERT(pPage);
      Page* page = WebPage::pageFromJLong(pPage);
      ASSERT(page);
<span class="line-modified">!     return bool_to_jbool(page-&gt;settings().usesPageCache());</span>
  }
  
  JNIEXPORT void JNICALL Java_com_sun_webkit_WebPage_twkSetUsePageCache
      (JNIEnv*, jobject, jlong pPage, jboolean usePageCache)
  {
      ASSERT(pPage);
      Page* page = WebPage::pageFromJLong(pPage);
      ASSERT(page);
<span class="line-modified">!     page-&gt;settings().setUsesPageCache(jbool_to_bool(usePageCache));</span>
  }
  
  JNIEXPORT jboolean JNICALL Java_com_sun_webkit_WebPage_twkIsJavaScriptEnabled
      (JNIEnv*, jobject, jlong pPage)
  {
<span class="line-new-header">--- 2288,20 ---</span>
      (JNIEnv*, jobject, jlong pPage)
  {
      ASSERT(pPage);
      Page* page = WebPage::pageFromJLong(pPage);
      ASSERT(page);
<span class="line-modified">!     return bool_to_jbool(page-&gt;settings().usesBackForwardCache());</span>
  }
  
  JNIEXPORT void JNICALL Java_com_sun_webkit_WebPage_twkSetUsePageCache
      (JNIEnv*, jobject, jlong pPage, jboolean usePageCache)
  {
      ASSERT(pPage);
      Page* page = WebPage::pageFromJLong(pPage);
      ASSERT(page);
<span class="line-modified">!     page-&gt;settings().setUsesBackForwardCache(jbool_to_bool(usePageCache));</span>
  }
  
  JNIEXPORT jboolean JNICALL Java_com_sun_webkit_WebPage_twkIsJavaScriptEnabled
      (JNIEnv*, jobject, jlong pPage)
  {
</pre>
<center><a href="VisitedLinkStoreJava.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="WebPage.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>