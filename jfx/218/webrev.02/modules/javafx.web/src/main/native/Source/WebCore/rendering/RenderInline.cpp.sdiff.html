<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/rendering/RenderInline.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="RenderImageResourceStyleImage.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="RenderInline.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/rendering/RenderInline.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  52 #include &lt;wtf/SetForScope.h&gt;
  53 
  54 namespace WebCore {
  55 
  56 WTF_MAKE_ISO_ALLOCATED_IMPL(RenderInline);
  57 
  58 RenderInline::RenderInline(Element&amp; element, RenderStyle&amp;&amp; style)
  59     : RenderBoxModelObject(element, WTFMove(style), RenderInlineFlag)
  60 {
  61     setChildrenInline(true);
  62 }
  63 
  64 RenderInline::RenderInline(Document&amp; document, RenderStyle&amp;&amp; style)
  65     : RenderBoxModelObject(document, WTFMove(style), RenderInlineFlag)
  66 {
  67     setChildrenInline(true);
  68 }
  69 
  70 void RenderInline::willBeDestroyed()
  71 {
<span class="line-modified">  72 #if !ASSERT_DISABLED</span>
  73     // Make sure we do not retain &quot;this&quot; in the continuation outline table map of our containing blocks.
  74     if (parent() &amp;&amp; style().visibility() == Visibility::Visible &amp;&amp; hasOutline()) {
  75         bool containingBlockPaintsContinuationOutline = continuation() || isContinuation();
  76         if (containingBlockPaintsContinuationOutline) {
  77             if (RenderBlock* cb = containingBlock()) {
  78                 if (RenderBlock* cbCb = cb-&gt;containingBlock())
  79                     ASSERT(!cbCb-&gt;paintsContinuationOutline(this));
  80             }
  81         }
  82     }
<span class="line-modified">  83 #endif</span>
  84 
  85     if (!renderTreeBeingDestroyed()) {
  86         if (firstLineBox()) {
  87             // We can&#39;t wait for RenderBoxModelObject::destroy to clear the selection,
  88             // because by then we will have nuked the line boxes.
  89             if (isSelectionBorder())
  90                 frame().selection().setNeedsSelectionUpdate();
  91 
  92             // If line boxes are contained inside a root, that means we&#39;re an inline.
  93             // In that case, we need to remove all the line boxes so that the parent
  94             // lines aren&#39;t pointing to deleted children. If the first line box does
  95             // not have a parent that means they are either already disconnected or
  96             // root lines that can just be destroyed without disconnecting.
  97             if (firstLineBox()-&gt;parent()) {
  98                 for (auto* box = firstLineBox(); box; box = box-&gt;nextLineBox())
  99                     box-&gt;removeFromParent();
 100             }
 101         } else if (parent())
 102             parent()-&gt;dirtyLinesFromChangedChild(*this);
 103     }
</pre>
<hr />
<pre>
 394 public:
 395     AbsoluteQuadsGeneratorContext(const RenderInline* renderer, Vector&lt;FloatQuad&gt;&amp; quads)
 396         : m_quads(quads)
 397         , m_geometryMap()
 398     {
 399         m_geometryMap.pushMappingsToAncestor(renderer, nullptr);
 400     }
 401 
 402     void addRect(const FloatRect&amp; rect)
 403     {
 404         m_quads.append(m_geometryMap.absoluteRect(rect));
 405     }
 406 private:
 407     Vector&lt;FloatQuad&gt;&amp; m_quads;
 408     RenderGeometryMap m_geometryMap;
 409 };
 410 
 411 } // unnamed namespace
 412 
 413 void RenderInline::absoluteQuads(Vector&lt;FloatQuad&gt;&amp; quads, bool* wasFixed) const







 414 {
 415     AbsoluteQuadsGeneratorContext context(this, quads);
 416     generateLineBoxRects(context);
<span class="line-removed"> 417 </span>
<span class="line-removed"> 418     if (RenderBoxModelObject* continuation = this-&gt;continuation())</span>
<span class="line-removed"> 419         continuation-&gt;absoluteQuads(quads, wasFixed);</span>
 420 }
 421 
 422 #if PLATFORM(IOS_FAMILY)
 423 void RenderInline::absoluteQuadsForSelection(Vector&lt;FloatQuad&gt;&amp; quads) const
 424 {
 425     AbsoluteQuadsGeneratorContext context(this, quads);
 426     generateLineBoxRects(context);
 427 }
 428 #endif
 429 
 430 LayoutUnit RenderInline::offsetLeft() const
 431 {
 432     LayoutPoint topLeft;
 433     if (InlineBox* firstBox = firstLineBoxIncludingCulling())
 434         topLeft = flooredLayoutPoint(firstBox-&gt;topLeft());
 435     return adjustedPositionRelativeToOffsetParent(topLeft).x();
 436 }
 437 
 438 LayoutUnit RenderInline::offsetTop() const
 439 {
</pre>
</td>
<td>
<hr />
<pre>
  52 #include &lt;wtf/SetForScope.h&gt;
  53 
  54 namespace WebCore {
  55 
  56 WTF_MAKE_ISO_ALLOCATED_IMPL(RenderInline);
  57 
  58 RenderInline::RenderInline(Element&amp; element, RenderStyle&amp;&amp; style)
  59     : RenderBoxModelObject(element, WTFMove(style), RenderInlineFlag)
  60 {
  61     setChildrenInline(true);
  62 }
  63 
  64 RenderInline::RenderInline(Document&amp; document, RenderStyle&amp;&amp; style)
  65     : RenderBoxModelObject(document, WTFMove(style), RenderInlineFlag)
  66 {
  67     setChildrenInline(true);
  68 }
  69 
  70 void RenderInline::willBeDestroyed()
  71 {
<span class="line-modified">  72 #if ASSERT_ENABLED</span>
  73     // Make sure we do not retain &quot;this&quot; in the continuation outline table map of our containing blocks.
  74     if (parent() &amp;&amp; style().visibility() == Visibility::Visible &amp;&amp; hasOutline()) {
  75         bool containingBlockPaintsContinuationOutline = continuation() || isContinuation();
  76         if (containingBlockPaintsContinuationOutline) {
  77             if (RenderBlock* cb = containingBlock()) {
  78                 if (RenderBlock* cbCb = cb-&gt;containingBlock())
  79                     ASSERT(!cbCb-&gt;paintsContinuationOutline(this));
  80             }
  81         }
  82     }
<span class="line-modified">  83 #endif // ASSERT_ENABLED</span>
  84 
  85     if (!renderTreeBeingDestroyed()) {
  86         if (firstLineBox()) {
  87             // We can&#39;t wait for RenderBoxModelObject::destroy to clear the selection,
  88             // because by then we will have nuked the line boxes.
  89             if (isSelectionBorder())
  90                 frame().selection().setNeedsSelectionUpdate();
  91 
  92             // If line boxes are contained inside a root, that means we&#39;re an inline.
  93             // In that case, we need to remove all the line boxes so that the parent
  94             // lines aren&#39;t pointing to deleted children. If the first line box does
  95             // not have a parent that means they are either already disconnected or
  96             // root lines that can just be destroyed without disconnecting.
  97             if (firstLineBox()-&gt;parent()) {
  98                 for (auto* box = firstLineBox(); box; box = box-&gt;nextLineBox())
  99                     box-&gt;removeFromParent();
 100             }
 101         } else if (parent())
 102             parent()-&gt;dirtyLinesFromChangedChild(*this);
 103     }
</pre>
<hr />
<pre>
 394 public:
 395     AbsoluteQuadsGeneratorContext(const RenderInline* renderer, Vector&lt;FloatQuad&gt;&amp; quads)
 396         : m_quads(quads)
 397         , m_geometryMap()
 398     {
 399         m_geometryMap.pushMappingsToAncestor(renderer, nullptr);
 400     }
 401 
 402     void addRect(const FloatRect&amp; rect)
 403     {
 404         m_quads.append(m_geometryMap.absoluteRect(rect));
 405     }
 406 private:
 407     Vector&lt;FloatQuad&gt;&amp; m_quads;
 408     RenderGeometryMap m_geometryMap;
 409 };
 410 
 411 } // unnamed namespace
 412 
 413 void RenderInline::absoluteQuads(Vector&lt;FloatQuad&gt;&amp; quads, bool* wasFixed) const
<span class="line-added"> 414 {</span>
<span class="line-added"> 415     absoluteQuadsIgnoringContinuation({ }, quads, wasFixed);</span>
<span class="line-added"> 416     if (continuation())</span>
<span class="line-added"> 417         collectAbsoluteQuadsForContinuation(quads, wasFixed);</span>
<span class="line-added"> 418 }</span>
<span class="line-added"> 419 </span>
<span class="line-added"> 420 void RenderInline::absoluteQuadsIgnoringContinuation(const FloatRect&amp;, Vector&lt;FloatQuad&gt;&amp; quads, bool*) const</span>
 421 {
 422     AbsoluteQuadsGeneratorContext context(this, quads);
 423     generateLineBoxRects(context);



 424 }
 425 
 426 #if PLATFORM(IOS_FAMILY)
 427 void RenderInline::absoluteQuadsForSelection(Vector&lt;FloatQuad&gt;&amp; quads) const
 428 {
 429     AbsoluteQuadsGeneratorContext context(this, quads);
 430     generateLineBoxRects(context);
 431 }
 432 #endif
 433 
 434 LayoutUnit RenderInline::offsetLeft() const
 435 {
 436     LayoutPoint topLeft;
 437     if (InlineBox* firstBox = firstLineBoxIncludingCulling())
 438         topLeft = flooredLayoutPoint(firstBox-&gt;topLeft());
 439     return adjustedPositionRelativeToOffsetParent(topLeft).x();
 440 }
 441 
 442 LayoutUnit RenderInline::offsetTop() const
 443 {
</pre>
</td>
</tr>
</table>
<center><a href="RenderImageResourceStyleImage.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="RenderInline.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>