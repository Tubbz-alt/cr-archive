<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/loader/archive/mhtml/MHTMLArchive.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../appcache/ApplicationCacheStorage.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../../cache/CachedCSSStyleSheet.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/loader/archive/mhtml/MHTMLArchive.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 34,16 ***</span>
  
  #include &quot;MHTMLArchive.h&quot;
  
  #include &quot;Document.h&quot;
  #include &quot;Frame.h&quot;
  #include &quot;MHTMLParser.h&quot;
  #include &quot;MIMETypeRegistry.h&quot;
  #include &quot;Page.h&quot;
  #include &quot;PageSerializer.h&quot;
  #include &quot;QuotedPrintable.h&quot;
<span class="line-removed">- #include &quot;SchemeRegistry.h&quot;</span>
  #include &quot;SharedBuffer.h&quot;
  #include &lt;time.h&gt;
  #include &lt;wtf/CryptographicallyRandomNumber.h&gt;
  #include &lt;wtf/DateMath.h&gt;
  #include &lt;wtf/GregorianDateTime.h&gt;
<span class="line-new-header">--- 34,16 ---</span>
  
  #include &quot;MHTMLArchive.h&quot;
  
  #include &quot;Document.h&quot;
  #include &quot;Frame.h&quot;
<span class="line-added">+ #include &quot;LegacySchemeRegistry.h&quot;</span>
  #include &quot;MHTMLParser.h&quot;
  #include &quot;MIMETypeRegistry.h&quot;
  #include &quot;Page.h&quot;
  #include &quot;PageSerializer.h&quot;
  #include &quot;QuotedPrintable.h&quot;
  #include &quot;SharedBuffer.h&quot;
  #include &lt;time.h&gt;
  #include &lt;wtf/CryptographicallyRandomNumber.h&gt;
  #include &lt;wtf/DateMath.h&gt;
  #include &lt;wtf/GregorianDateTime.h&gt;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 107,11 ***</span>
  }
  
  RefPtr&lt;MHTMLArchive&gt; MHTMLArchive::create(const URL&amp; url, SharedBuffer&amp; data)
  {
      // For security reasons we only load MHTML pages from local URLs.
<span class="line-modified">!     if (!SchemeRegistry::shouldTreatURLSchemeAsLocal(url.protocol().toString()))</span>
          return nullptr;
  
      MHTMLParser parser(&amp;data);
      RefPtr&lt;MHTMLArchive&gt; mainArchive = parser.parseArchive();
      if (!mainArchive)
<span class="line-new-header">--- 107,11 ---</span>
  }
  
  RefPtr&lt;MHTMLArchive&gt; MHTMLArchive::create(const URL&amp; url, SharedBuffer&amp; data)
  {
      // For security reasons we only load MHTML pages from local URLs.
<span class="line-modified">!     if (!LegacySchemeRegistry::shouldTreatURLSchemeAsLocal(url.protocol().toString()))</span>
          return nullptr;
  
      MHTMLParser parser(&amp;data);
      RefPtr&lt;MHTMLArchive&gt; mainArchive = parser.parseArchive();
      if (!mainArchive)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 139,11 ***</span>
      String boundary = generateRandomBoundary();
      String endOfResourceBoundary = makeString(&quot;--&quot;, boundary, &quot;\r\n&quot;);
  
      GregorianDateTime now;
      now.setToCurrentLocalTime();
<span class="line-modified">!     String dateString = makeRFC2822DateString(now.weekDay(), now.monthDay(), now.month(), now.year(), now.hour(), now.minute(), now.second(), now.utcOffset() / 60);</span>
  
      StringBuilder stringBuilder;
      stringBuilder.append(&quot;From: &lt;Saved by WebKit&gt;\r\n&quot;);
      stringBuilder.append(&quot;Subject: &quot;);
      // We replace non ASCII characters with &#39;?&#39; characters to match IE&#39;s behavior.
<span class="line-new-header">--- 139,11 ---</span>
      String boundary = generateRandomBoundary();
      String endOfResourceBoundary = makeString(&quot;--&quot;, boundary, &quot;\r\n&quot;);
  
      GregorianDateTime now;
      now.setToCurrentLocalTime();
<span class="line-modified">!     String dateString = makeRFC2822DateString(now.weekDay(), now.monthDay(), now.month(), now.year(), now.hour(), now.minute(), now.second(), now.utcOffsetInMinute());</span>
  
      StringBuilder stringBuilder;
      stringBuilder.append(&quot;From: &lt;Saved by WebKit&gt;\r\n&quot;);
      stringBuilder.append(&quot;Subject: &quot;);
      // We replace non ASCII characters with &#39;?&#39; characters to match IE&#39;s behavior.
</pre>
<center><a href="../../appcache/ApplicationCacheStorage.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../../cache/CachedCSSStyleSheet.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>